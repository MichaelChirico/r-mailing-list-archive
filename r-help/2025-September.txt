From ro||turner @end|ng |rom po@teo@net  Mon Sep  1 00:25:35 2025
From: ro||turner @end|ng |rom po@teo@net (Rolf Turner)
Date: Sun, 31 Aug 2025 22:25:35 +0000
Subject: [R] The "**" exponentiation operator.
In-Reply-To: <CABcYAdKsrjz+f5TTFJsfrPQsrBkK56gnwztJ-uANUV3oM_LqCA@mail.gmail.com>
References: <20250826173543.66fbc3da@new-hp>
 <797998820.1378581.1756192870671@mail.yahoo.com>
 <CABcYAdKsrjz+f5TTFJsfrPQsrBkK56gnwztJ-uANUV3oM_LqCA@mail.gmail.com>
Message-ID: <20250901102526.75ecf832@new-hp>


I think it is well past time to terminate this thread.  I think the
appropriate bottom line is:

  LET'S NOT MUCK AROUND WITH R SYNTAX ANY MORE

(Richard O'Keefe).

I.e. "**" should be allowed to continue to act as a synonym for "^".
I will just have to live with my propensity for fumble-fingering.

Richard O'Keefe also suggested using lint scripts.  I will need to
learn how to do this.

cheers,

Rolf Turner

-- 
Honorary Research Fellow
Department of Statistics
University of Auckland
Stats. Dep't. (secretaries) phone:
         +64-9-373-7599 ext. 89622
Home phone: +64-9-480-4619


From |eo@m@d@ @end|ng |rom @yon|c@eu  Mon Sep  1 20:32:54 2025
From: |eo@m@d@ @end|ng |rom @yon|c@eu (Leo Mada)
Date: Mon, 1 Sep 2025 18:32:54 +0000
Subject: [R] 
 Connecting a midpoint of a segment at a 90 degree angle to the
 next nearest point of a neighboring segment
Message-ID: <DBAP192MB0956FE103D64144FB0F8F1DB8407A@DBAP192MB0956.EURP192.PROD.OUTLOOK.COM>

Dear David,

I am replying to your question with a little delay. I hope though that you can find the following hints useful.

If I understand the task correctly:
You want to draw an orthogonal line to another line and find out where this line intersects a 3rd line.

You can decompose your problem into 2 separate tasks:
1. "Draw" a line orthogonal to the first line; (a physical drawing is not needed)
2. Compute the intersection of this new line with the desired line;

Task 1 is equivalent to translating a point orthogonally to a given line. I think you want to do it with the midpoint.

Have a look at the functions shiftLine and shift.ortho on GitHub:
https://github.com/discoleo/BioShapes/blob/main/R/Graphic.Helper.R

You can shift the point for a given distance, e.g. 1 unit - and thus have a new line segment.

### Shift Point or Line
# Shifts a point orthogonal to a given line;
# d = distance to shift (translate);
# simplify = TRUE: if(length(d) == 1) return a simple list(x, y);
#    otherwise return a data.frame;
# Note: direction of shift is not normalized with respect to quadrant;
[...]

Note:
- the "scale" argument can be used to plot on a non-square coordinate system and let the 2 lines *look*"prthogonal" on this non-square grid;
- if you do not need such functionality, you can set scale = 1 and simplify the formulas;

2. Intersection of segments
See function intersect.lines in the same file on GitHub.

The function returns the relative positions relative to the 2 line segments where they intersect, i.e.:
- Parameter t1 = Fraction of 1st line segment;
- Parameter t2 = Fraction of 2nd line segment;
Real intersection: 0 <= t <= 1;

You may also need the function slope() (in the same file). The functions in this file reference only other functions in this file (although I do not think there are any other calls).

Hope you can work it out.

Sincerely,

Leonard



	[[alternative HTML version deleted]]


From p@z @end|ng |rom @c@@e@org  Mon Sep  1 16:09:56 2025
From: p@z @end|ng |rom @c@@e@org (Paul Zachos)
Date: Mon, 1 Sep 2025 10:09:56 -0400
Subject: [R] Extracting portions of one vector to create others
Message-ID: <0605C441-8908-453B-B026-ED1C928BA756@acase.org>

Dear Colleagues,

I have a vector which indicates membership of subjects in one of 5 Classes

Beth$CLASS
 [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
[37] 2 2 2 2 2 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 7 7 7 7 7 7 7 7 7 7 7
[73] 7 7 7 7 7 7 7 7 7 9 9 9 9 9 9 9 9 9 9 9 9 9 9 1

For purposes of an analysis (using linear models based on Ward and Jennings) I would like to create 5 new vectors

The values in vector CLASS1 will be ?1? if the corresponding value in Beth$CLASS is equal to ?1?; ?0? otherwise

The values in vector CLASS2 will be ?1? if the corresponding value in Beth$CLASS is equal to ?2?; ?0? otherwise

The values in vector CLASS4 will be ?1? if the corresponding value in Beth$CLASS is equal to ?4?; ?0? otherwise

The values in vector CLASS7 will be ?1? if the corresponding value in Beth$CLASS is equal to ?7?; ?0? otherwise

The values in vector CLASS9 will be ?1? if the corresponding value in Beth$CLASS is equal to ?9?; ?0? otherwise

How would I go about this using R

Thank you
_________________
Paul Zachos, PhD
Director, Research and Evaluation
Association for the Cooperative Advancement of Science and Education (ACASE)
110 Spring Street  Saratoga Springs, NY 12866  |  
paz at acase.org  |  www.acase.org





	[[alternative HTML version deleted]]


From j3||d|ck @end|ng |rom gm@||@com  Tue Sep  2 09:07:20 2025
From: j3||d|ck @end|ng |rom gm@||@com (Jeffrey Dick)
Date: Tue, 2 Sep 2025 15:07:20 +0800
Subject: [R] Extracting portions of one vector to create others
In-Reply-To: <0605C441-8908-453B-B026-ED1C928BA756@acase.org>
References: <0605C441-8908-453B-B026-ED1C928BA756@acase.org>
Message-ID: <CANBtttYvwc6CvT4Z02p2nsPQu5C9VxVB8FmaO6iJd36PcQiM5Q@mail.gmail.com>

Hi Paul,

Here's a way that creates new vectors as elements of a list.

Beth <- list(
 CLASS = c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
   2, 2, 2, 2, 2, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
4, 4, 4, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
   7, 7, 7, 7, 7, 7, 7, 7, 7, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 1
 )
)

classes <- unique(Beth$CLASS)

# Loop over `classes` to operate on a single `class` in each iteration
result <- lapply(classes, function(class) {
  # Create a vector with 1 if Beth$CLASS is in class, 0 if not
  as.numeric(Beth$CLASS == class)
})

names(result) <- paste0("CLASS", classes)

with the result:

> result
$CLASS1
[1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0
0
[83] 0 0 0 0 0 0 0 0 0 0 0 0 0 1

$CLASS2
[1] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 1 1 1 1 1 1 1 1 1 1 1
1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0
0
[83] 0 0 0 0 0 0 0 0 0 0 0 0 0 0

[list truncated ...]

Regards,
Jeff

On Tue, Sep 2, 2025 at 2:44?PM Paul Zachos <paz at acase.org> wrote:
>
> Dear Colleagues,
>
> I have a vector which indicates membership of subjects in one of 5 Classes
>
> Beth$CLASS
>  [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
> [37] 2 2 2 2 2 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 7 7 7 7 7 7 7 7 7 7 7
> [73] 7 7 7 7 7 7 7 7 7 9 9 9 9 9 9 9 9 9 9 9 9 9 9 1
>
> For purposes of an analysis (using linear models based on Ward and Jennings) I would like to create 5 new vectors
>
> The values in vector CLASS1 will be ?1? if the corresponding value in Beth$CLASS is equal to ?1?; ?0? otherwise
>
> The values in vector CLASS2 will be ?1? if the corresponding value in Beth$CLASS is equal to ?2?; ?0? otherwise
>
> The values in vector CLASS4 will be ?1? if the corresponding value in Beth$CLASS is equal to ?4?; ?0? otherwise
>
> The values in vector CLASS7 will be ?1? if the corresponding value in Beth$CLASS is equal to ?7?; ?0? otherwise
>
> The values in vector CLASS9 will be ?1? if the corresponding value in Beth$CLASS is equal to ?9?; ?0? otherwise
>
> How would I go about this using R
>
> Thank you
> _________________
> Paul Zachos, PhD
> Director, Research and Evaluation
> Association for the Cooperative Advancement of Science and Education (ACASE)
> 110 Spring Street  Saratoga Springs, NY 12866  |
> paz at acase.org  |  www.acase.org
>
>
>
>
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide https://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Tue Sep  2 09:38:18 2025
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Tue, 2 Sep 2025 08:38:18 +0100
Subject: [R] Extracting portions of one vector to create others
In-Reply-To: <0605C441-8908-453B-B026-ED1C928BA756@acase.org>
References: <0605C441-8908-453B-B026-ED1C928BA756@acase.org>
Message-ID: <f62be1a0-bc3c-49a0-807c-603ac0f27cfb@sapo.pt>

On 9/1/2025 3:09 PM, Paul Zachos wrote:
> Dear Colleagues,
> 
> I have a vector which indicates membership of subjects in one of 5 Classes
> 
> Beth$CLASS
>   [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
> [37] 2 2 2 2 2 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 7 7 7 7 7 7 7 7 7 7 7
> [73] 7 7 7 7 7 7 7 7 7 9 9 9 9 9 9 9 9 9 9 9 9 9 9 1
> 
> For purposes of an analysis (using linear models based on Ward and Jennings) I would like to create 5 new vectors
> 
> The values in vector CLASS1 will be ?1? if the corresponding value in Beth$CLASS is equal to ?1?; ?0? otherwise
> 
> The values in vector CLASS2 will be ?1? if the corresponding value in Beth$CLASS is equal to ?2?; ?0? otherwise
> 
> The values in vector CLASS4 will be ?1? if the corresponding value in Beth$CLASS is equal to ?4?; ?0? otherwise
> 
> The values in vector CLASS7 will be ?1? if the corresponding value in Beth$CLASS is equal to ?7?; ?0? otherwise
> 
> The values in vector CLASS9 will be ?1? if the corresponding value in Beth$CLASS is equal to ?9?; ?0? otherwise
> 
> How would I go about this using R
> 
> Thank you
> _________________
> Paul Zachos, PhD
> Director, Research and Evaluation
> Association for the Cooperative Advancement of Science and Education (ACASE)
> 110 Spring Street  Saratoga Springs, NY 12866  |
> paz at acase.org  |  www.acase.org
> 
> 
> 
> 
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide https://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
Hello,

Here is a way. This creates a matrix with the vectors you ask for.
But it doesn't create 5 different vectors, it keeps them in one object 
only, a matrix.



CLASS <-
   c(1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L,
     1L, 1L, 1L, 1L, 1L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L,
     2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 4L, 4L, 4L, 4L, 4L, 4L,
     4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 7L, 7L,
     7L, 7L, 7L, 7L, 7L, 7L, 7L, 7L, 7L, 7L, 7L, 7L, 7L, 7L, 7L, 7L,
     7L, 7L, 9L, 9L, 9L, 9L, 9L, 9L, 9L, 9L, 9L, 9L, 9L, 9L, 9L, 9L, 1L)
Beth <- data.frame(CLASS)

eq <- c(1, 2, 4, 7, 9)
res <- sapply(eq, \(x) as.integer(x == Beth$CLASS))
colnames(res) <- paste0("CLASS", eq)
head(res)
#>      CLASS1 CLASS2 CLASS4 CLASS7 CLASS9
#> [1,]      1      0      0      0      0
#> [2,]      1      0      0      0      0
#> [3,]      1      0      0      0      0
#> [4,]      1      0      0      0      0
#> [5,]      1      0      0      0      0
#> [6,]      1      0      0      0      0


If you really want 5 different objects in the global environment, you 
can use ?list2env.
This is not a good practice, you will have related, loose objects in the 
globalenv, making your code harder to debug. Keep it simple.


as.data.frame(res) |>
   list2env(envir = .GlobalEnv)
#> <environment: R_GlobalEnv>

CLASS1
#>  [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 0 0 0
#> [39] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 0 0 0
#> [77] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1
CLASS2
#>  [1] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 1 1 1 1 1 1 1 1 1 1 
1 1 1 1 1 1
#> [39] 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 0 0 0
#> [77] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0


Hope this helps,

Rui Barradas


From er|cjberger @end|ng |rom gm@||@com  Tue Sep  2 09:38:21 2025
From: er|cjberger @end|ng |rom gm@||@com (Eric Berger)
Date: Tue, 2 Sep 2025 10:38:21 +0300
Subject: [R] Extracting portions of one vector to create others
In-Reply-To: <CANBtttYvwc6CvT4Z02p2nsPQu5C9VxVB8FmaO6iJd36PcQiM5Q@mail.gmail.com>
References: <0605C441-8908-453B-B026-ED1C928BA756@acase.org>
 <CANBtttYvwc6CvT4Z02p2nsPQu5C9VxVB8FmaO6iJd36PcQiM5Q@mail.gmail.com>
Message-ID: <CAGgJW74aLChAP3ss0vu_-3ZCZLhfR2ogqwimpO4VY0EMJQ4KjA@mail.gmail.com>

Your request is equivalent to "how to do one-hot encoding in R". You can do
this search yourself.

Just for fun, I did that search and the following is a short solution:

A <- model.matrix(  ~ as.character(Beth$CLASS) - 1 )
colnames(A) <- paste0("CLASS", c(1,2,4,7,9))

A is now a matrix whose columns are the vectors that you want. To see this:

head(A)

  CLASS1 CLASS2 CLASS4 CLASS7 CLASS9
1           1             0              0             0           0
2           1             0              0             0           0
3           1             0              0             0           0
4           1             0              0             0           0
5           1             0              0             0           0
6           1             0              0             0           0

On Tue, Sep 2, 2025 at 10:07?AM Jeffrey Dick <j3ffdick at gmail.com> wrote:

> Hi Paul,
>
> Here's a way that creates new vectors as elements of a list.
>
> Beth <- list(
>  CLASS = c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
> 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
>    2, 2, 2, 2, 2, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
> 4, 4, 4, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
>    7, 7, 7, 7, 7, 7, 7, 7, 7, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 1
>  )
> )
>
> classes <- unique(Beth$CLASS)
>
> # Loop over `classes` to operate on a single `class` in each iteration
> result <- lapply(classes, function(class) {
>   # Create a vector with 1 if Beth$CLASS is in class, 0 if not
>   as.numeric(Beth$CLASS == class)
> })
>
> names(result) <- paste0("CLASS", classes)
>
> with the result:
>
> > result
> $CLASS1
> [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0
> 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
> 0 0 0 0 0 0 0 0 0 0 0 0 0
> 0
> [83] 0 0 0 0 0 0 0 0 0 0 0 0 0 1
>
> $CLASS2
> [1] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 1 1 1 1 1 1 1 1 1 1 1
> 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
> 0 0 0 0 0 0 0 0 0 0 0 0 0
> 0
> [83] 0 0 0 0 0 0 0 0 0 0 0 0 0 0
>
> [list truncated ...]
>
> Regards,
> Jeff
>
> On Tue, Sep 2, 2025 at 2:44?PM Paul Zachos <paz at acase.org> wrote:
> >
> > Dear Colleagues,
> >
> > I have a vector which indicates membership of subjects in one of 5
> Classes
> >
> > Beth$CLASS
> >  [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2 2 2 2 2 2 2
> 2 2
> > [37] 2 2 2 2 2 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 7 7 7 7 7 7 7 7 7
> 7 7
> > [73] 7 7 7 7 7 7 7 7 7 9 9 9 9 9 9 9 9 9 9 9 9 9 9 1
> >
> > For purposes of an analysis (using linear models based on Ward and
> Jennings) I would like to create 5 new vectors
> >
> > The values in vector CLASS1 will be ?1? if the corresponding value in
> Beth$CLASS is equal to ?1?; ?0? otherwise
> >
> > The values in vector CLASS2 will be ?1? if the corresponding value in
> Beth$CLASS is equal to ?2?; ?0? otherwise
> >
> > The values in vector CLASS4 will be ?1? if the corresponding value in
> Beth$CLASS is equal to ?4?; ?0? otherwise
> >
> > The values in vector CLASS7 will be ?1? if the corresponding value in
> Beth$CLASS is equal to ?7?; ?0? otherwise
> >
> > The values in vector CLASS9 will be ?1? if the corresponding value in
> Beth$CLASS is equal to ?9?; ?0? otherwise
> >
> > How would I go about this using R
> >
> > Thank you
> > _________________
> > Paul Zachos, PhD
> > Director, Research and Evaluation
> > Association for the Cooperative Advancement of Science and Education
> (ACASE)
> > 110 Spring Street  Saratoga Springs, NY 12866  |
> > paz at acase.org  |  www.acase.org
> >
> >
> >
> >
> >
> >         [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide
> https://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> https://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Tue Sep  2 09:50:53 2025
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Tue, 2 Sep 2025 08:50:53 +0100
Subject: [R] Extracting portions of one vector to create others
In-Reply-To: <f62be1a0-bc3c-49a0-807c-603ac0f27cfb@sapo.pt>
References: <0605C441-8908-453B-B026-ED1C928BA756@acase.org>
 <f62be1a0-bc3c-49a0-807c-603ac0f27cfb@sapo.pt>
Message-ID: <14a92891-d12c-4025-b8d1-c0a4cf9829eb@sapo.pt>

On 9/2/2025 8:38 AM, Rui Barradas wrote:
> On 9/1/2025 3:09 PM, Paul Zachos wrote:
>> Dear Colleagues,
>>
>> I have a vector which indicates membership of subjects in one of 5 
>> Classes
>>
>> Beth$CLASS
>> ? [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2 2 2 2 2 
>> 2 2 2 2
>> [37] 2 2 2 2 2 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 7 7 7 7 7 7 7 7 
>> 7 7 7
>> [73] 7 7 7 7 7 7 7 7 7 9 9 9 9 9 9 9 9 9 9 9 9 9 9 1
>>
>> For purposes of an analysis (using linear models based on Ward and 
>> Jennings) I would like to create 5 new vectors
>>
>> The values in vector CLASS1 will be ?1? if the corresponding value in 
>> Beth$CLASS is equal to ?1?; ?0? otherwise
>>
>> The values in vector CLASS2 will be ?1? if the corresponding value in 
>> Beth$CLASS is equal to ?2?; ?0? otherwise
>>
>> The values in vector CLASS4 will be ?1? if the corresponding value in 
>> Beth$CLASS is equal to ?4?; ?0? otherwise
>>
>> The values in vector CLASS7 will be ?1? if the corresponding value in 
>> Beth$CLASS is equal to ?7?; ?0? otherwise
>>
>> The values in vector CLASS9 will be ?1? if the corresponding value in 
>> Beth$CLASS is equal to ?9?; ?0? otherwise
>>
>> How would I go about this using R
>>
>> Thank you
>> _________________
>> Paul Zachos, PhD
>> Director, Research and Evaluation
>> Association for the Cooperative Advancement of Science and Education 
>> (ACASE)
>> 110 Spring Street? Saratoga Springs, NY 12866? |
>> paz at acase.org? |? www.acase.org
>>
>>
>>
>>
>>
>> ????[[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide https://www.R-project.org/posting- 
>> guide.html
>> and provide commented, minimal, self-contained, reproducible code.
> Hello,
> 
> Here is a way. This creates a matrix with the vectors you ask for.
> But it doesn't create 5 different vectors, it keeps them in one object 
> only, a matrix.
> 
> 
> 
> CLASS <-
>  ? c(1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L,
>  ??? 1L, 1L, 1L, 1L, 1L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L,
>  ??? 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 4L, 4L, 4L, 4L, 4L, 4L,
>  ??? 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 7L, 7L,
>  ??? 7L, 7L, 7L, 7L, 7L, 7L, 7L, 7L, 7L, 7L, 7L, 7L, 7L, 7L, 7L, 7L,
>  ??? 7L, 7L, 9L, 9L, 9L, 9L, 9L, 9L, 9L, 9L, 9L, 9L, 9L, 9L, 9L, 9L, 1L)
> Beth <- data.frame(CLASS)
> 
> eq <- c(1, 2, 4, 7, 9)
> res <- sapply(eq, \(x) as.integer(x == Beth$CLASS))
> colnames(res) <- paste0("CLASS", eq)
> head(res)
> #>????? CLASS1 CLASS2 CLASS4 CLASS7 CLASS9
> #> [1,]????? 1????? 0????? 0????? 0????? 0
> #> [2,]????? 1????? 0????? 0????? 0????? 0
> #> [3,]????? 1????? 0????? 0????? 0????? 0
> #> [4,]????? 1????? 0????? 0????? 0????? 0
> #> [5,]????? 1????? 0????? 0????? 0????? 0
> #> [6,]????? 1????? 0????? 0????? 0????? 0
> 
> 
> If you really want 5 different objects in the global environment, you 
> can use ?list2env.
> This is not a good practice, you will have related, loose objects in the 
> globalenv, making your code harder to debug. Keep it simple.
> 
> 
> as.data.frame(res) |>
>  ? list2env(envir = .GlobalEnv)
> #> <environment: R_GlobalEnv>
> 
> CLASS1
> #>? [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 
> 0 0 0 0 0 0
> #> [39] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
> 0 0 0 0 0 0
> #> [77] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1
> CLASS2
> #>? [1] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 1 1 1 1 1 1 1 1 1 1 
> 1 1 1 1 1 1
> #> [39] 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
> 0 0 0 0 0 0
> #> [77] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
> 
> 
> Hope this helps,
> 
> Rui Barradas
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide https://www.R-project.org/posting- 
> guide.html
> and provide commented, minimal, self-contained, reproducible code.
Hello,

Here is another way with ?model.matrix.


res2 <- model.matrix(~ 0 + factor(CLASS), data = Beth)
colnames(res2) <- sub("factor\\((.*)\\)", "\\1", colnames(res2))



This will create matrix res2 with other attributes, not just dimnames. 
To get rid of those you can run


attr(res2, "assign") <- NULL
attr(res2, "contrasts") <- NULL
attributes(res2)


Hope this helps,

Rui Barradas


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Tue Sep  2 10:16:19 2025
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Tue, 02 Sep 2025 01:16:19 -0700
Subject: [R] Extracting portions of one vector to create others
In-Reply-To: <0605C441-8908-453B-B026-ED1C928BA756@acase.org>
References: <0605C441-8908-453B-B026-ED1C928BA756@acase.org>
Message-ID: <8C8347B5-68F7-4490-9262-19FCB1AF509A@dcn.davis.ca.us>

This is an extremely common transformation in regression, and it has a dedicated function (model.matrix) for accomplishing it in R. It does presume you have a bit of familiarity with the formula literal type in R... which is created using the tilde character (e.g. ~ CLASS). Also, since including an intercept term in a regression is the default, if you only want the columns you described then you need to inform the function that you want to leave the intercept out (~ CLASS - 1). It doesn't apply this discrete transformation unless the referenced variable is a factor variable, so I convert it from integer type in the short example below.

Beth <- data.frame(

??CLASS = c(
????1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2
????, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 4, 4, 4, 4, 4, 4, 4, 4
????, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7
????, 7, 7, 7, 7, 7, 7, 7, 7, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 1))
Beth$CLASS <- as.character(Beth$CLASS)
result <- model.matrix( ~ CLASS - 1, Beth)
result

Note that the result is a matrix, not a data frame so you will have to use brackets and a blank for the row spec if you want to access one column at a time: 

result[, "CLASS1"]

Refer to the help page for more on this function:
?model.matrix



On September 1, 2025 7:09:56 AM PDT, Paul Zachos <paz at acase.org> wrote:
>Dear Colleagues,
>
>I have a vector which indicates membership of subjects in one of 5 Classes
>
>Beth$CLASS
> [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
>[37] 2 2 2 2 2 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 7 7 7 7 7 7 7 7 7 7 7
>[73] 7 7 7 7 7 7 7 7 7 9 9 9 9 9 9 9 9 9 9 9 9 9 9 1
>
>For purposes of an analysis (using linear models based on Ward and Jennings) I would like to create 5 new vectors
>
>The values in vector CLASS1 will be ?1? if the corresponding value in Beth$CLASS is equal to ?1?; ?0? otherwise
>
>The values in vector CLASS2 will be ?1? if the corresponding value in Beth$CLASS is equal to ?2?; ?0? otherwise
>
>The values in vector CLASS4 will be ?1? if the corresponding value in Beth$CLASS is equal to ?4?; ?0? otherwise
>
>The values in vector CLASS7 will be ?1? if the corresponding value in Beth$CLASS is equal to ?7?; ?0? otherwise
>
>The values in vector CLASS9 will be ?1? if the corresponding value in Beth$CLASS is equal to ?9?; ?0? otherwise
>
>How would I go about this using R
>
>Thank you
>_________________
>Paul Zachos, PhD
>Director, Research and Evaluation
>Association for the Cooperative Advancement of Science and Education (ACASE)
>110 Spring Street  Saratoga Springs, NY 12866  |  
>paz at acase.org  |  www.acase.org
>
>
>
>
>
>	[[alternative HTML version deleted]]
>
>______________________________________________
>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>https://stat.ethz.ch/mailman/listinfo/r-help
>PLEASE do read the posting guide https://www.R-project.org/posting-guide.html
>and provide commented, minimal, self-contained, reproducible code.

-- 
Sent from my phone. Please excuse my brevity.


From @vi@e@gross m@iii@g oii gm@ii@com  Tue Sep  2 15:27:17 2025
From: @vi@e@gross m@iii@g oii gm@ii@com (@vi@e@gross m@iii@g oii gm@ii@com)
Date: Tue, 2 Sep 2025 09:27:17 -0400
Subject: [R] Extracting portions of one vector to create others
In-Reply-To: <8C8347B5-68F7-4490-9262-19FCB1AF509A@dcn.davis.ca.us>
References: <0605C441-8908-453B-B026-ED1C928BA756@acase.org>
 <8C8347B5-68F7-4490-9262-19FCB1AF509A@dcn.davis.ca.us>
Message-ID: <006701dc1c0d$4e0475e0$ea0d61a0$@gmail.com>

The solutions offered are fine but perhaps not quite directly what was asked for.

A careful reading seems to suggest they simply want a way to index the data.frame multiple ways by creating a set of vectors containing zero or one. He seems to want a solution for a specific case. This seems like it can be solved fairly easily with ifelse() as in:

CLASS1 <- ifelse(Beth$CLASS==1, 1, 0)
CLASS2 <- ifelse(Beth$CLASS==2, 1, 0)
CLASS4 <- ifelse(Beth$CLASS==4, 1, 0)
CLASS7 <- ifelse(Beth$CLASS==7, 1, 0)
CLASS9 <- ifelse(Beth$CLASS==9, 1, 0)

Of course a more general solution could consider arbitrary factors and create either custom names for resulting vectors or create a list of such vectors or other data structures like the matrix one being provided.

And, of course, sometimes you do not choose this way of having a "Boolean vector" to be used as an index but can use standard R (or packages like dplyr) to select the rows needed with a query.

-----Original Message-----
From: R-help <r-help-bounces at r-project.org> On Behalf Of Jeff Newmiller via R-help
Sent: Tuesday, September 2, 2025 4:16 AM
To: r-help at r-project.org
Subject: Re: [R] Extracting portions of one vector to create others

This is an extremely common transformation in regression, and it has a dedicated function (model.matrix) for accomplishing it in R. It does presume you have a bit of familiarity with the formula literal type in R... which is created using the tilde character (e.g. ~ CLASS). Also, since including an intercept term in a regression is the default, if you only want the columns you described then you need to inform the function that you want to leave the intercept out (~ CLASS - 1). It doesn't apply this discrete transformation unless the referenced variable is a factor variable, so I convert it from integer type in the short example below.

Beth <- data.frame(

  CLASS = c(
    1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2
    , 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 4, 4, 4, 4, 4, 4, 4, 4
    , 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7
    , 7, 7, 7, 7, 7, 7, 7, 7, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 1))
Beth$CLASS <- as.character(Beth$CLASS)
result <- model.matrix( ~ CLASS - 1, Beth)
result

Note that the result is a matrix, not a data frame so you will have to use brackets and a blank for the row spec if you want to access one column at a time: 

result[, "CLASS1"]

Refer to the help page for more on this function:
?model.matrix



On September 1, 2025 7:09:56 AM PDT, Paul Zachos <paz at acase.org> wrote:
>Dear Colleagues,
>
>I have a vector which indicates membership of subjects in one of 5 Classes
>
>Beth$CLASS
> [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
>[37] 2 2 2 2 2 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 7 7 7 7 7 7 7 7 7 7 7
>[73] 7 7 7 7 7 7 7 7 7 9 9 9 9 9 9 9 9 9 9 9 9 9 9 1
>
>For purposes of an analysis (using linear models based on Ward and Jennings) I would like to create 5 new vectors
>
>The values in vector CLASS1 will be ?1? if the corresponding value in Beth$CLASS is equal to ?1?; ?0? otherwise
>
>The values in vector CLASS2 will be ?1? if the corresponding value in Beth$CLASS is equal to ?2?; ?0? otherwise
>
>The values in vector CLASS4 will be ?1? if the corresponding value in Beth$CLASS is equal to ?4?; ?0? otherwise
>
>The values in vector CLASS7 will be ?1? if the corresponding value in Beth$CLASS is equal to ?7?; ?0? otherwise
>
>The values in vector CLASS9 will be ?1? if the corresponding value in Beth$CLASS is equal to ?9?; ?0? otherwise
>
>How would I go about this using R
>
>Thank you
>_________________
>Paul Zachos, PhD
>Director, Research and Evaluation
>Association for the Cooperative Advancement of Science and Education (ACASE)
>110 Spring Street  Saratoga Springs, NY 12866  |  
>paz at acase.org  |  www.acase.org
>
>
>
>
>
>	[[alternative HTML version deleted]]
>
>______________________________________________
>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>https://stat.ethz.ch/mailman/listinfo/r-help
>PLEASE do read the posting guide https://www.R-project.org/posting-guide.html
>and provide commented, minimal, self-contained, reproducible code.

-- 
Sent from my phone. Please excuse my brevity.

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
https://stat.ethz.ch/mailman/listinfo/r-help
PLEASE do read the posting guide https://www.R-project.org/posting-guide.html
and provide commented, minimal, self-contained, reproducible code.


From r@oknz @end|ng |rom gm@||@com  Wed Sep  3 04:00:10 2025
From: r@oknz @end|ng |rom gm@||@com (Richard O'Keefe)
Date: Wed, 3 Sep 2025 14:00:10 +1200
Subject: [R] Extracting portions of one vector to create others
In-Reply-To: <0605C441-8908-453B-B026-ED1C928BA756@acase.org>
References: <0605C441-8908-453B-B026-ED1C928BA756@acase.org>
Message-ID: <CABcYAdJ5VW1pWV4B0b7g-xwUgjD1tzp2Qdyg=V3sbMVkRtbCGg@mail.gmail.com>

To do exactly what you asked for,
CLASS1 <- rep('0', len=length(Beth$CLASS))
because there is NO element in Beth$CLASS that is '1'.
Assuming that you did not mean ANY of the single quotes to be taken seriously,
CLASS1 <- as.integer(Beth$CLASS == 1)
Beth$CLASS == 1 will give you TRUE where Beth$CLASS has 1, FALSE elsewhere.
as.integer(Beth$CLASS == 1) will convert TRUE to 1 and FALSE to 0.
If you really want those 1s and 0x to be '1's and '0's,
as.character(as.integer(Beth$CLASS == 1))
will do the trick.  What you might find to be clearer is
CLASS2 <- ifelse(Beth$CLASS == 2, '1', '0')

For linear modelling, you are probably interested in factors rather
than strings.
To avoid confusion, you might want to avoid using '0' and '1'

On Tue, 2 Sept 2025 at 18:44, Paul Zachos <paz at acase.org> wrote:
>
> Dear Colleagues,
>
> I have a vector which indicates membership of subjects in one of 5 Classes
>
> Beth$CLASS
>  [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
> [37] 2 2 2 2 2 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 7 7 7 7 7 7 7 7 7 7 7
> [73] 7 7 7 7 7 7 7 7 7 9 9 9 9 9 9 9 9 9 9 9 9 9 9 1
>
> For purposes of an analysis (using linear models based on Ward and Jennings) I would like to create 5 new vectors
>
> The values in vector CLASS1 will be ?1? if the corresponding value in Beth$CLASS is equal to ?1?; ?0? otherwise
>
> The values in vector CLASS2 will be ?1? if the corresponding value in Beth$CLASS is equal to ?2?; ?0? otherwise
>
> The values in vector CLASS4 will be ?1? if the corresponding value in Beth$CLASS is equal to ?4?; ?0? otherwise
>
> The values in vector CLASS7 will be ?1? if the corresponding value in Beth$CLASS is equal to ?7?; ?0? otherwise
>
> The values in vector CLASS9 will be ?1? if the corresponding value in Beth$CLASS is equal to ?9?; ?0? otherwise
>
> How would I go about this using R
>
> Thank you
> _________________
> Paul Zachos, PhD
> Director, Research and Evaluation
> Association for the Cooperative Advancement of Science and Education (ACASE)
> 110 Spring Street  Saratoga Springs, NY 12866  |
> paz at acase.org  |  www.acase.org
>
>
>
>
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide https://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From @gr @end|ng |rom @|um@m|t@edu  Thu Sep  4 23:16:15 2025
From: @gr @end|ng |rom @|um@m|t@edu (Steve Rowley)
Date: Thu, 4 Sep 2025 17:16:15 -0400
Subject: [R] Processing repeated images and memory recovery by GC
Message-ID: <CAMCTF-er2CPOB+_6NQFbbWU-SG7yfYqUQHWiiH__z-v7LvOVeg@mail.gmail.com>

I have a question about repeated image processing and recovering memory via
garbage collection.

A couple images are displayed simultaneously for analysis, using
split.screen().  I'm looping over a large collection of images, using
jpeg/readJPEG(), png/readPNG(), and caTools/read.gif() to load an image
into memory from a file.  Then I use erase.screen() to erase the previous
image, use plot() to set up a plotting area, and display the image with
rasterImage().  Then the user elects some processing, and we move on to the
next image(s).

I'm very carefully not holding references to any of the previous images.
GC is indeed happening, but memory quickly fills up.  It certainly *looks*
as though the image memory is not being released: printing out trace info
using mem_used()[[1]] says memory use increases with each image, by about
the image size.  Forcing periodic GC's, measuring memory used before and
after, shows that no memory is recovered.

Some questions:

(1) Is it known that processing images in this way will lead to allocating
memory that is not recovered by GC?

(2) Are there any tools you'd recommend to see exactly *what* is filling up
memory, just in case it's not previous images, but some other problem?

This is R 4.4.2 (for now).  Running MacOS on an ARM processor.
___________
Steve Rowley <sgr at alum.mit.edu> Zoom: 839 529 4589
<https://us04web.zoom.us/j/8395294589?pwd=dlQ4MUFHK1NFOCtoZFpUNFRtZ2lSQT09>
It is very dark & after 2000.  If you continue, you are likely to be eaten
by a bleen.

	[[alternative HTML version deleted]]


From bgunter@4567 @end|ng |rom gm@||@com  Fri Sep  5 00:01:08 2025
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Thu, 4 Sep 2025 15:01:08 -0700
Subject: [R] Processing repeated images and memory recovery by GC
In-Reply-To: <CAMCTF-er2CPOB+_6NQFbbWU-SG7yfYqUQHWiiH__z-v7LvOVeg@mail.gmail.com>
References: <CAMCTF-er2CPOB+_6NQFbbWU-SG7yfYqUQHWiiH__z-v7LvOVeg@mail.gmail.com>
Message-ID: <CAGxFJbSUU6rk1duPbibCVwsTo6V-wGbZFO578=KBNtxndTGqJw@mail.gmail.com>

As I understand it and you, this kind of specialized technical question is
usually not a good fit to this list about general issues in R programming,
though someone may respond here of course. Alternatively, you may find it
useful to post on one (or some?) of the R SIGS (Special Interest Groups)
listed at https://www.r-project.org/mail.html  to see if one of them might
be a better fit. (Though some listed there may be inactive). Note also that
some R packages dealing with image processing have their own dedicated
lists.

Happy hunting.

Cheers,
Bert

On Thu, Sep 4, 2025 at 2:17?PM Steve Rowley via R-help <r-help at r-project.org>
wrote:

> I have a question about repeated image processing and recovering memory via
> garbage collection.
>
> A couple images are displayed simultaneously for analysis, using
> split.screen().  I'm looping over a large collection of images, using
> jpeg/readJPEG(), png/readPNG(), and caTools/read.gif() to load an image
> into memory from a file.  Then I use erase.screen() to erase the previous
> image, use plot() to set up a plotting area, and display the image with
> rasterImage().  Then the user elects some processing, and we move on to the
> next image(s).
>
> I'm very carefully not holding references to any of the previous images.
> GC is indeed happening, but memory quickly fills up.  It certainly *looks*
> as though the image memory is not being released: printing out trace info
> using mem_used()[[1]] says memory use increases with each image, by about
> the image size.  Forcing periodic GC's, measuring memory used before and
> after, shows that no memory is recovered.
>
> Some questions:
>
> (1) Is it known that processing images in this way will lead to allocating
> memory that is not recovered by GC?
>
> (2) Are there any tools you'd recommend to see exactly *what* is filling up
> memory, just in case it's not previous images, but some other problem?
>
> This is R 4.4.2 (for now).  Running MacOS on an ARM processor.
> ___________
> Steve Rowley <sgr at alum.mit.edu> Zoom: 839 529 4589
> <https://us04web.zoom.us/j/8395294589?pwd=dlQ4MUFHK1NFOCtoZFpUNFRtZ2lSQT09
> >
> It is very dark & after 2000.  If you continue, you are likely to be eaten
> by a bleen.
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> https://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Fri Sep  5 01:24:56 2025
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Thu, 04 Sep 2025 16:24:56 -0700
Subject: [R] Processing repeated images and memory recovery by GC
In-Reply-To: <CAGxFJbSUU6rk1duPbibCVwsTo6V-wGbZFO578=KBNtxndTGqJw@mail.gmail.com>
References: <CAMCTF-er2CPOB+_6NQFbbWU-SG7yfYqUQHWiiH__z-v7LvOVeg@mail.gmail.com>
 <CAGxFJbSUU6rk1duPbibCVwsTo6V-wGbZFO578=KBNtxndTGqJw@mail.gmail.com>
Message-ID: <E3A1A1AA-FCEE-4D0A-BC1D-9187FE9E614F@dcn.davis.ca.us>

To expand on Bert's response, I see two directions for this to go: either OP is unaware of some R object references that are in fact still being referenced somewhere, or the specialized contributed packages being used have memory leaks (not unheard of... C can require considerable effort to avoid failing to release resources). (It is also possible but maybe not likely that in the right forum there will be someone who immediately recognizes this issue... but probably not what you should be betting on.)

Both of these possibilities will likely require detailed knowledge (likely maintainer-level, or at least someone with experience debugging memory leaks) of the specific packages involved. In order for such a person to dig into this they will need a reproducible (hopefully short and with small data file requirements) example that they can run over and over as they troubleshoot. 

I recommend that you try to start building this example sooner rather than later ... maybe include a link to it or paste it into your next request (email to maintainer? a last gasp post here?) to give whoever has that very narrow set of abilities an incentive to look at it. Not having such an example can make it easier to just skip your request as being too vague and time-consuming to investigate.

Note that sending your email in plain text (a setting in your email software) rather than the HTML that this was sent in will help avoid us receiving frustrating glitches in your sample code.

Google "cran reprex" and read the vignette for further help on making an example.

On September 4, 2025 3:01:08 PM PDT, Bert Gunter <bgunter.4567 at gmail.com> wrote:
>As I understand it and you, this kind of specialized technical question is
>usually not a good fit to this list about general issues in R programming,
>though someone may respond here of course. Alternatively, you may find it
>useful to post on one (or some?) of the R SIGS (Special Interest Groups)
>listed at https://www.r-project.org/mail.html  to see if one of them might
>be a better fit. (Though some listed there may be inactive). Note also that
>some R packages dealing with image processing have their own dedicated
>lists.
>
>Happy hunting.
>
>Cheers,
>Bert
>
>On Thu, Sep 4, 2025 at 2:17?PM Steve Rowley via R-help <r-help at r-project.org>
>wrote:
>
>> I have a question about repeated image processing and recovering memory via
>> garbage collection.
>>
>> A couple images are displayed simultaneously for analysis, using
>> split.screen().  I'm looping over a large collection of images, using
>> jpeg/readJPEG(), png/readPNG(), and caTools/read.gif() to load an image
>> into memory from a file.  Then I use erase.screen() to erase the previous
>> image, use plot() to set up a plotting area, and display the image with
>> rasterImage().  Then the user elects some processing, and we move on to the
>> next image(s).
>>
>> I'm very carefully not holding references to any of the previous images.
>> GC is indeed happening, but memory quickly fills up.  It certainly *looks*
>> as though the image memory is not being released: printing out trace info
>> using mem_used()[[1]] says memory use increases with each image, by about
>> the image size.  Forcing periodic GC's, measuring memory used before and
>> after, shows that no memory is recovered.
>>
>> Some questions:
>>
>> (1) Is it known that processing images in this way will lead to allocating
>> memory that is not recovered by GC?
>>
>> (2) Are there any tools you'd recommend to see exactly *what* is filling up
>> memory, just in case it's not previous images, but some other problem?
>>
>> This is R 4.4.2 (for now).  Running MacOS on an ARM processor.
>> ___________
>> Steve Rowley <sgr at alum.mit.edu> Zoom: 839 529 4589
>> <https://us04web.zoom.us/j/8395294589?pwd=dlQ4MUFHK1NFOCtoZFpUNFRtZ2lSQT09
>> >
>> It is very dark & after 2000.  If you continue, you are likely to be eaten
>> by a bleen.
>>
>>         [[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide
>> https://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>>
>
>	[[alternative HTML version deleted]]
>
>______________________________________________
>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>https://stat.ethz.ch/mailman/listinfo/r-help
>PLEASE do read the posting guide https://www.R-project.org/posting-guide.html
>and provide commented, minimal, self-contained, reproducible code.

-- 
Sent from my phone. Please excuse my brevity.


From rhe|p @end|ng |rom eoo@@dd@@n|  Fri Sep  5 10:21:04 2025
From: rhe|p @end|ng |rom eoo@@dd@@n| (Jan van der Laan)
Date: Fri, 5 Sep 2025 10:21:04 +0200
Subject: [R] Processing repeated images and memory recovery by GC
In-Reply-To: <E3A1A1AA-FCEE-4D0A-BC1D-9187FE9E614F@dcn.davis.ca.us>
References: <CAMCTF-er2CPOB+_6NQFbbWU-SG7yfYqUQHWiiH__z-v7LvOVeg@mail.gmail.com>
 <CAGxFJbSUU6rk1duPbibCVwsTo6V-wGbZFO578=KBNtxndTGqJw@mail.gmail.com>
 <E3A1A1AA-FCEE-4D0A-BC1D-9187FE9E614F@dcn.davis.ca.us>
Message-ID: <1a16e1c4-e550-4e7c-bda7-7e3275adb6a5@eoos.dds.nl>



On 05-09-2025 01:24, Jeff Newmiller via R-help wrote:

> 
> I recommend that you try to start building this example sooner rather than later ... maybe include a link to it or paste it into your next request (email to maintainer? a last gasp post here?) to give whoever has that very narrow set of abilities an incentive to look at it. Not having such an example can make it easier to just skip your request as being too vague and time-consuming to investigate.

And often writing such a minimal example helps in pinpointing the issue 
quite often leading to a solution.

You could start by stripping down your current code. Remove all plotting 
commands: does the problem still exist then it is probably in reading or 
cleaning up the image rasters. Is it just for png's or for all image 
formats? Etc. Another way is 'bottom up': write a script that reads 
images and does nothing with them; does the problem happen there? Then 
start adding stuff until the issue occurs again.

Could it be that you keep opening up new graphics devices without 
closing them? Also split.screen creates a kind of devices that should be 
closed.

HTHT,
Jan





> 
> Note that sending your email in plain text (a setting in your email software) rather than the HTML that this was sent in will help avoid us receiving frustrating glitches in your sample code.
> 
> Google "cran reprex" and read the vignette for further help on making an example.
> 
> On September 4, 2025 3:01:08 PM PDT, Bert Gunter <bgunter.4567 at gmail.com> wrote:
>> As I understand it and you, this kind of specialized technical question is
>> usually not a good fit to this list about general issues in R programming,
>> though someone may respond here of course. Alternatively, you may find it
>> useful to post on one (or some?) of the R SIGS (Special Interest Groups)
>> listed at https://www.r-project.org/mail.html  to see if one of them might
>> be a better fit. (Though some listed there may be inactive). Note also that
>> some R packages dealing with image processing have their own dedicated
>> lists.
>>
>> Happy hunting.
>>
>> Cheers,
>> Bert
>>
>> On Thu, Sep 4, 2025 at 2:17?PM Steve Rowley via R-help <r-help at r-project.org>
>> wrote:
>>
>>> I have a question about repeated image processing and recovering memory via
>>> garbage collection.
>>>
>>> A couple images are displayed simultaneously for analysis, using
>>> split.screen().  I'm looping over a large collection of images, using
>>> jpeg/readJPEG(), png/readPNG(), and caTools/read.gif() to load an image
>>> into memory from a file.  Then I use erase.screen() to erase the previous
>>> image, use plot() to set up a plotting area, and display the image with
>>> rasterImage().  Then the user elects some processing, and we move on to the
>>> next image(s).
>>>
>>> I'm very carefully not holding references to any of the previous images.
>>> GC is indeed happening, but memory quickly fills up.  It certainly *looks*
>>> as though the image memory is not being released: printing out trace info
>>> using mem_used()[[1]] says memory use increases with each image, by about
>>> the image size.  Forcing periodic GC's, measuring memory used before and
>>> after, shows that no memory is recovered.
>>>
>>> Some questions:
>>>
>>> (1) Is it known that processing images in this way will lead to allocating
>>> memory that is not recovered by GC?
>>>
>>> (2) Are there any tools you'd recommend to see exactly *what* is filling up
>>> memory, just in case it's not previous images, but some other problem?
>>>
>>> This is R 4.4.2 (for now).  Running MacOS on an ARM processor.
>>> ___________
>>> Steve Rowley <sgr at alum.mit.edu> Zoom: 839 529 4589
>>> <https://us04web.zoom.us/j/8395294589?pwd=dlQ4MUFHK1NFOCtoZFpUNFRtZ2lSQT09
>>>>
>>> It is very dark & after 2000.  If you continue, you are likely to be eaten
>>> by a bleen.
>>>
>>>          [[alternative HTML version deleted]]
>>>
>>> ______________________________________________
>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>> PLEASE do read the posting guide
>>> https://www.R-project.org/posting-guide.html
>>> and provide commented, minimal, self-contained, reproducible code.
>>>
>>
>> 	[[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide https://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>


From |kry|ov @end|ng |rom d|@root@org  Fri Sep  5 11:52:08 2025
From: |kry|ov @end|ng |rom d|@root@org (Ivan Krylov)
Date: Fri, 5 Sep 2025 12:52:08 +0300
Subject: [R] Processing repeated images and memory recovery by GC
In-Reply-To: <CAMCTF-er2CPOB+_6NQFbbWU-SG7yfYqUQHWiiH__z-v7LvOVeg@mail.gmail.com>
References: <CAMCTF-er2CPOB+_6NQFbbWU-SG7yfYqUQHWiiH__z-v7LvOVeg@mail.gmail.com>
Message-ID: <20250905125208.1540e379@arachnoid>

? Thu, 4 Sep 2025 17:16:15 -0400
Steve Rowley via R-help <r-help at r-project.org> ?????:

> Then I use erase.screen() to erase the previous
> image, use plot() to set up a plotting area, and display the image
> with rasterImage().  

erase.screen() works by drawing a background-coloured rectangle over
the plot, so the previous images remain in the display list despite
being completely over-painted:

dev.new(bg='white')
split.screen(c(1,2))
# [1] 1 2
recordPlot() |> object.size()
# 57584 bytes
for (i in 1:2) {
 screen(i, FALSE)
 plot(0:1, 0:1, type = 'n')
 rasterImage(as.raster(matrix(runif(2^20), 2^10)), 0, 0, 1, 1)
}
recordPlot() |> object.size() |> print(units = 'Mb')
# 16.2 Mb
for (i in 1:2) {
 erase.screen(i)
 screen(i, FALSE)
 plot(0:1, 0:1, type = 'n')
 rasterImage(as.raster(matrix(runif(2^20), 2^10)), 0, 0, 1, 1)
}
recordPlot() |> object.size() |> print(units = 'Mb')
# 32.3 Mb

How much slower would it be to maintain your own "display list" of
images and redraw the plot from scratch (e.g. using layout()) every
time you change it?

-- 
Best regards,
Ivan


From rmdor@z|o @end|ng |rom gm@||@com  Fri Sep  5 16:34:06 2025
From: rmdor@z|o @end|ng |rom gm@||@com (Robert Dorazio)
Date: Fri, 5 Sep 2025 07:34:06 -0700
Subject: [R] julia-setup not working with R 4.5.1 and Julia 1.11.6
Message-ID: <CAMVm2Gb+EfWK7=dj_oWzgAOrGTzacid-T30j3JraXDNgwYAZjQ@mail.gmail.com>

My operating system is Ubuntu 24.04.

To ensure I had the most recent version of the R package ?JuliaCall?, I
installed ?JuliaCall? from github as follows:

devtools::install_github(?JuliaInterop/JuliaCall?)

The problem is that running julia_setup() produces a segmentation fault.
For example:

library(JuliaCall)
julia_setup(rebuild=TRUE)
Julia version 1.11.6 at location
/home/robert/.julia/juliaup/julia-1.11.6+0.x64.linux.gnu/bin will be used.
Loading setup script for JuliaCall?
Finish loading setup script for JuliaCall.
Segmentation fault (core dumped)

Any help is much appreciated.

Previously, I had installed R package "JuliaCall" from the CRAN repository,
but I obtained the same segmentation fault error.

	[[alternative HTML version deleted]]


From bgunter@4567 @end|ng |rom gm@||@com  Sat Sep  6 16:35:40 2025
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Sat, 6 Sep 2025 07:35:40 -0700
Subject: [R] julia-setup not working with R 4.5.1 and Julia 1.11.6
In-Reply-To: <CAMVm2Gb+EfWK7=dj_oWzgAOrGTzacid-T30j3JraXDNgwYAZjQ@mail.gmail.com>
References: <CAMVm2Gb+EfWK7=dj_oWzgAOrGTzacid-T30j3JraXDNgwYAZjQ@mail.gmail.com>
Message-ID: <CAGxFJbQvgcD3qt2VpthDUNMnBQzthKQN0Gcz4SCh006CNAxrNQ@mail.gmail.com>

I think you should contact the package maintainer and/or check any package
support lists that may exist for this sort of issue.

Cheers,
Bert

On Sat, Sep 6, 2025 at 1:16?AM Robert Dorazio <rmdorazio at gmail.com> wrote:

> My operating system is Ubuntu 24.04.
>
> To ensure I had the most recent version of the R package ?JuliaCall?, I
> installed ?JuliaCall? from github as follows:
>
> devtools::install_github(?JuliaInterop/JuliaCall?)
>
> The problem is that running julia_setup() produces a segmentation fault.
> For example:
>
> library(JuliaCall)
> julia_setup(rebuild=TRUE)
> Julia version 1.11.6 at location
> /home/robert/.julia/juliaup/julia-1.11.6+0.x64.linux.gnu/bin will be used.
> Loading setup script for JuliaCall?
> Finish loading setup script for JuliaCall.
> Segmentation fault (core dumped)
>
> Any help is much appreciated.
>
> Previously, I had installed R package "JuliaCall" from the CRAN repository,
> but I obtained the same segmentation fault error.
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> https://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From @gr @end|ng |rom @|um@m|t@edu  Mon Sep  8 00:44:41 2025
From: @gr @end|ng |rom @|um@m|t@edu (Steve Rowley)
Date: Sun, 7 Sep 2025 18:44:41 -0400
Subject: [R] Processing repeated images and memory recovery by GC
In-Reply-To: <20250905125208.1540e379@arachnoid>
References: <CAMCTF-er2CPOB+_6NQFbbWU-SG7yfYqUQHWiiH__z-v7LvOVeg@mail.gmail.com>
 <20250905125208.1540e379@arachnoid>
Message-ID: <CAMCTF-c8E1KsvLhjXJRv+MEwRNsWTckoXZtNfT3_32FyvfwgUg@mail.gmail.com>

On Fri, Sep 5, 2025 at 5:52?AM Ivan Krylov <ikrylov at disroot.org> wrote:

> ? Thu, 4 Sep 2025 17:16:15 -0400
> Steve Rowley via R-help <r-help at r-project.org> ?????:
>
> > Then I use erase.screen() to erase the previous
> > image, use plot() to set up a plotting area, and display the image
> > with rasterImage().
>
> erase.screen() works by drawing a background-coloured rectangle over
> the plot, so the previous images remain in the display list despite
> being completely over-painted:
>

Thank you very much!

This was indeed the issue.  Like most bugs, it is in retrospect obvious,
but as Kierkegaard (approximately) said, we don't live in retrospect. :-)

I used dev.control(displaylist = "inhibit") on the screens created by
split.screen().  This leads to some redisplay problems if the window is
resized, but other than that everything seems to work and I'm happy to live
with that little problem.  (Possibly MacOS is doing some redisplay work
here in the background.)

Reporting memory size after each iteration shows it operates in
approximately constant memory now.  ("Approximately" means that it does
expand a bit for larger images, but GC works to retrieve the memory, so
that's ok.)

Thanks to all who offered an opinion.  (Or even thought about it, that sort
of kindness counts too!).

And especial thanks to Ivan for nailing the problem exactly, just from my
vague description.  I'm really, really impressed with your debugging
prowess.
___________
Steve Rowley <sgr at alum.mit.edu> Zoom: 839 529 4589
<https://us04web.zoom.us/j/8395294589?pwd=dlQ4MUFHK1NFOCtoZFpUNFRtZ2lSQT09>
It is very dark & after 2000.  If you continue, you are likely to be eaten
by a bleen.

	[[alternative HTML version deleted]]


From |eo@m@d@ @end|ng |rom @yon|c@eu  Sat Sep 13 21:24:35 2025
From: |eo@m@d@ @end|ng |rom @yon|c@eu (Leo Mada)
Date: Sat, 13 Sep 2025 19:24:35 +0000
Subject: [R] Branch Ratios & other Indexes for Trees/Dendrograms
In-Reply-To: <DBAP192MB0956AA5B5E9ED5B486743FA6843FA@DBAP192MB0956.EURP192.PROD.OUTLOOK.COM>
References: <DBAP192MB0956AA5B5E9ED5B486743FA6843FA@DBAP192MB0956.EURP192.PROD.OUTLOOK.COM>
Message-ID: <DBAP192MB09568F87A1B1B47F4B15758B840BA@DBAP192MB0956.EURP192.PROD.OUTLOOK.COM>

Dear R Users,

This is a follow-up to one of my older messages. Although I did not receive useful suggestions back then, I did some research on my own and found an R package and some references in the literature. I hope that this information is useful to others as well.

### Tree Balance

The problem can be solved using indexes that measure the tree balance. Package mdendro implements 2 such indexes (chaining coefficient and a tree balance coefficient, which is actually the entropy of the tree structure).
https://cran.r-project.org/web/packages/mdendro/index.html

The paper referenced by mdendro is in the meantime published as well (it was not accessible a few days ago):
Fern?ndez, A., & G?mez, S. (2025). mdendro: An R Package for Extended Agglomerative Hierarchical Clustering. Journal of Statistical Software, 114(2), 1?26. https://doi.org/10.18637/jss.v114.i02


The other reference is much older (and I do not have access to it):
Williams W, Lambert J, Lance G (1966). ?Multivariate Methods in Plant Ecology: V.
Similarity Analyses and Information-Analysis.? Journal of Ecology, 54(2), 427?445. doi:
10.2307/2257960.
[it may be possible to read online, but not download the article; I have not fully checked]

I have included some functions in my own R code on GitHub, like index.chaining and index.entropy:
https://github.com/discoleo/PeptideClassifier/blob/main/R/Helper.Tree.Analysis.R

I hope this info is useful to others as well.

Sincerely,

Leonard

Initial Message:
https://stat.ethz.ch/pipermail/r-help/2025-August/481164.html

________________________________
From: Leo Mada <leo.mada at syonic.eu>
Sent: Monday, August 25, 2025 12:28 AM
To: Leo Mada via R-help <r-help at r-project.org>
Subject: Branch Ratios & other Indexes for Trees/Dendrograms

Dear R-Users,

I have another question regarding trees (dendrograms).

After exploring the various hierarchical clustering methods, it seems that some of the methods (average, single, median) add sequentially very small clusters (even 1 leaf) to an increasingly larger branch.

I would like to quantify this more rigorously. I do not think that banner plots fully capture this fact, as they are limited to height of the node where a leaf binds.

I came up with 2 alternative measures:
- Ratio of leaves on 1 branch (larger branch) vs the other branch (see function branch.ratios);
- Size of other branch of the node where 1 leaf binds;

The latter resembles the bannerplot; and is also limited only to nodes with leaves.

Can anyone point me to such indexes in the literature and/or in other R packages?

I am not an expert in the field. Searching for cluster indexes will likely generate a huge number of false positive results (i.e. indexes for number of clusters).

An example of this functionality is given below:

# Pre-computed Trees:
x1 = readRDS("Tree.Full.M_ward.D.rds")
x2 = readRDS("Tree.Full.M_average.rds")

br1 = branch.ratios(x1)
br2 = branch.ratios(x2)
# Alternative: size.leafBranch(x1);

par.old = par(mfrow = c(1,2))
hist(br1);
# Branch Ratio goes up to 1300!
hist(br2);
par(par.old)

# Note: Median & centroid are even more extreme!

The data sets and functions are on GitHub:
https://github.com/discoleo/PeptideClassifier/tree/main/inst/examples

Functions: branch.ratios, size.leafBranch, count.nodes;
https://github.com/discoleo/PeptideClassifier/blob/main/R/Helper.Tree.R

I have attached an image to this mail with all 8 histograms. The image is also available on GitHub:
https://github.com/discoleo/PeptideClassifier/blob/main/Trees.BranchRatios.png
Many thanks in advance,

Leonard


	[[alternative HTML version deleted]]


