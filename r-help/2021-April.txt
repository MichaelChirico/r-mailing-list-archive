From bgunter@4567 @end|ng |rom gm@||@com  Thu Apr  1 00:42:38 2021
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Wed, 31 Mar 2021 15:42:38 -0700
Subject: [R] FD package_dbFD error
In-Reply-To: <22acffee587bcf8377643dfd95ef2c5d@biol.pmf.hr>
References: <22acffee587bcf8377643dfd95ef2c5d@biol.pmf.hr>
Message-ID: <CAGxFJbSbt2qwyNNT5VnBsynDn572Ppbi2UHy_c8ERZk16+i9ug@mail.gmail.com>

I think you would more likely find the help you seek on the r-sig-ecology
list rather than here.

Also, do note per the posting guide linked below:

"For questions about functions in standard packages distributed with R (see
the FAQ Add-on packages in R
<https://cran.r-project.org/doc/FAQ/R-FAQ.html#Add-on-packages-in-R>), ask
questions on R-help.
If the question relates to a *contributed package* , e.g., one downloaded
from CRAN, try contacting the package maintainer first [who you can find
via ?maintainer]. You can also use find("functionname") and
packageDescription("packagename") to find this information. *Only* send
such questions to R-help or R-devel if you get no reply or need further
assistance. This applies to both requests for help and to bug reports."


Bert Gunter

"The trouble with having an open mind is that people keep coming along and
sticking things into it."
-- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )


On Wed, Mar 31, 2021 at 3:32 PM Vesna Gulin <vesna.gulin at biol.pmf.hr> wrote:

> Hi everyone,
>
> I am trying to conduct dbFD from the FD package, but it keeps giving me
> the same error:
>
> ex1 <- dbFD(sites, traits)
> Error in dbFD(sites, traits) :
>    Different number of species in 'x' and 'a'.
>
> Ab, bb, Ci.... are species names.
> I have tried rewriting the species names so many times and ways, but
> nothing seems to work. I also checked for blank space but can't seem to
> find one. Does anyone have and idea what am I doing wrong?
>
> My data consists of two data frames:
> sites
>
>    X Ab Bb Ci Cb Cbm Cdo Cm Cdi Dv Edi Ee Ede Es Eb Gc La Mm Op Oc Oh Or
> Pgr Ps Pgi Pf Pgri Po Pp Rr Ss Sl Ts Tv Tr
> 1 A  0  0  0  0   0   0  1   0  0   0  0   0  1  0  0  0  1  0  0  0  0
>   0  0   0  0    0  0  0  0  0  0  0  0  0
> 2 B  0  0  0  0   0   0  0   0  0   0  0   0  1  0  0  0  0  2  0  0  0
>   0  0   0  0    0  0  0  0  0  0  0  0  0
> 3 C  0  0  0  0   0   0  0   0  0   0  0   0  0  0  0  0  0  0  0  0  0
>   0  0   0  0    0  1  0  0  0  0  0  0  0
> 4 D  0  0  0  0   0   0  0   0  0   0  0   0  0  0  0  0  0  0  0  0  0
>   0  0   0  0    0  0  0  0  0  0  0  0  0
> 5 E  0  0  0  0   0   0  0   3  2   3  0   0  0  0  0  0  0  0  0  4  0
>   0  0   0  0    0  0  0  0  0  0  0  0  0
> 6 F  0  0  0  0   0   0  0   0  3   0  1   0  0  4  1  8  0  1  3  2  0
>   0  0   0  0    0  0  0  0  0  0  0  0  2
> 7 G  0  0  0  0   0   0  1   1  1   2  0   0  0  0  0  0  0  0  1  4  0
>   0  0   0  0    0  0  0  0  0  0  0  0  0
>
> traits
>
>       X body    ration  flight     feeding       lifestyle     moisture
> 1    Ab 29.5 0.6203390    none herbivorous geo-chortobiont  xerophilous
> 2    Bb 16.0 1.0625000 reduced  omnivorous     chortobiont  mesophilous
> 3    Ci 23.5 0.5829787    full  omnivorous geo-chortobiont  xerophilous
> 4    Cb 18.0 0.6000000    full herbivorous     chortobiont  mesophilous
> 5   Cbm 18.0 0.6000000    full herbivorous     chortobiont  mesophilous
> 6   Cdo 17.5 0.6342857 reduced herbivorous     chortobiont  mesophilous
> 7    Cm 17.5 0.5914286    full herbivorous     chortobiont  mesophilous
> 8   Cdi 21.5 0.5883721 reduced herbivorous     chortobiont hygrophilous
> 9    Dv 34.0 0.9044118 reduced carnivorous geo-chortobiont  mesophilous
> 10  Edi 27.0 0.7222222    none  omnivorous     thamnobiont  xerophilous
> 11   Ee 25.0 0.6400000    none  omnivorous     thamnobiont  mesophilous
> 12  Ede 20.5 0.5902439    none herbivorous     chortobiont  xerophilous
> 13   Es 25.5 0.9803922    none  omnivorous     thamnobiont  mesophilous
> 14   Eb 18.0 0.6416667 reduced herbivorous     chortobiont  mesophilous
> 15   Gc 22.5 0.4555556    none  omnivorous        geobiont  mesophilous
> 16   La 13.0 0.9807692    none herbivorous     chortobiont  mesophilous
> 17   Mm 18.0 1.0972222    none  omnivorous geo-chortobiont  xerophilous
> 18   Op 12.0 0.6666667    full  omnivorous     thamnobiont  xerophilous
> 19   Oc 21.0 0.5690476    full herbivorous        geobiont  xerophilous
> 20   Oh 15.5 0.5967742 reduced herbivorous     chortobiont  mesophilous
> 21   Or 15.5 0.7193548 reduced herbivorous     chortobiont  mesophilous
> 22  Pgr 17.0 1.0588235    none  omnivorous     thamnobiont  mesophilous
> 23   Ps 21.5 1.0465116    none  omnivorous     thamnobiont  mesophilous
> 24  Pgi 14.0 0.5500000    none herbivorous     chortobiont  mesophilous
> 25   Pf 26.5 0.9622642    none  omnivorous     thamnobiont  mesophilous
> 26 Pgri 17.5 1.0428571    none  omnivorous     thamnobiont  mesophilous
> 27   Po 17.0 0.8970588    none herbivorous     chortobiont  mesophilous
> 28   Pp 17.5 0.6542857 reduced herbivorous     chortobiont  mesophilous
> 29   Rr 17.5 0.8857143 reduced  omnivorous     chortobiont  mesophilous
> 30   Ss 22.5 0.5733333    full herbivorous     chortobiont  mesophilous
> 31   Sl 20.5 0.6268293 reduced herbivorous     chortobiont  mesophilous
> 32   Ts 12.5 0.4720000 reduced herbivorous        geobiont hygrophilous
> 33   Tv 33.0 0.7803030    full carnivorous     thamnobiont  mesophilous
> 34   Tr 20.0 0.9000000    none  omnivorous        geobiont hygrophilous
>
>
> Thank you in advance and kind regards,
> Vesna
>
>
> --
> Vesna Gulin,  Research and Teaching Assistant
> Department of Biology
> Faculty of Science
> University of Zagreb
> Rooseveltov trg 6, 10000 Zagreb, Croatia
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From m@hmood@n@der@n @end|ng |rom ugent@be  Thu Apr  1 00:49:40 2021
From: m@hmood@n@der@n @end|ng |rom ugent@be (Mahmood Naderan-Tahan)
Date: Wed, 31 Mar 2021 22:49:40 +0000
Subject: [R] Controling the presentation of violin plot
Message-ID: <62007f9b632d49c1bfa8c12dbb1b44a5@ugent.be>

Hi,

With the following command, I get a messy violin plot which can be seen at https://pasteboard.co/JVdZKNz.jpg


p <- ggplot(mydata, aes(x=BE, y=INT)) + geom_violin(trim=FALSE)
p + geom_dotplot(binaxis='y', stackdir='center', dotsize=1)


It seems that the y-axis has a large scale and that causes the points to be shown with bad sizes.

Any way to fix that?



Regards,
Mahmood

	[[alternative HTML version deleted]]


From @@r@h@go@|ee @end|ng |rom gm@||@com  Thu Apr  1 00:58:09 2021
From: @@r@h@go@|ee @end|ng |rom gm@||@com (Sarah Goslee)
Date: Wed, 31 Mar 2021 18:58:09 -0400
Subject: [R] FD package_dbFD error
In-Reply-To: <22acffee587bcf8377643dfd95ef2c5d@biol.pmf.hr>
References: <22acffee587bcf8377643dfd95ef2c5d@biol.pmf.hr>
Message-ID: <CAM_vjunW6m274kKvEfs1gnVxwuuUktCBZptyd7RjoDNii60VeA@mail.gmail.com>

Hi,

While Bert is right that this would be a good question for
r-sig-ecology, I think you might have made a very simple-to-fix
mistake:

According to https://www.rdocumentation.org/packages/FD/versions/1.0-12/topics/dbFD
if you don't name the arguments, traits should come BEFORE sites.

If that doesn't help, take a look at the site and trait data frames
used in the examples and see if you can figure out where you went
wrong. If you can't, then try r-sig-ecology.

Sarah

On Wed, Mar 31, 2021 at 6:33 PM Vesna Gulin <vesna.gulin at biol.pmf.hr> wrote:
>
> Hi everyone,
>
> I am trying to conduct dbFD from the FD package, but it keeps giving me
> the same error:
>
> ex1 <- dbFD(sites, traits)
> Error in dbFD(sites, traits) :
>    Different number of species in 'x' and 'a'.
>
> Ab, bb, Ci.... are species names.
> I have tried rewriting the species names so many times and ways, but
> nothing seems to work. I also checked for blank space but can't seem to
> find one. Does anyone have and idea what am I doing wrong?
>
> My data consists of two data frames:
> sites
>
>    X Ab Bb Ci Cb Cbm Cdo Cm Cdi Dv Edi Ee Ede Es Eb Gc La Mm Op Oc Oh Or
> Pgr Ps Pgi Pf Pgri Po Pp Rr Ss Sl Ts Tv Tr
> 1 A  0  0  0  0   0   0  1   0  0   0  0   0  1  0  0  0  1  0  0  0  0
>   0  0   0  0    0  0  0  0  0  0  0  0  0
> 2 B  0  0  0  0   0   0  0   0  0   0  0   0  1  0  0  0  0  2  0  0  0
>   0  0   0  0    0  0  0  0  0  0  0  0  0
> 3 C  0  0  0  0   0   0  0   0  0   0  0   0  0  0  0  0  0  0  0  0  0
>   0  0   0  0    0  1  0  0  0  0  0  0  0
> 4 D  0  0  0  0   0   0  0   0  0   0  0   0  0  0  0  0  0  0  0  0  0
>   0  0   0  0    0  0  0  0  0  0  0  0  0
> 5 E  0  0  0  0   0   0  0   3  2   3  0   0  0  0  0  0  0  0  0  4  0
>   0  0   0  0    0  0  0  0  0  0  0  0  0
> 6 F  0  0  0  0   0   0  0   0  3   0  1   0  0  4  1  8  0  1  3  2  0
>   0  0   0  0    0  0  0  0  0  0  0  0  2
> 7 G  0  0  0  0   0   0  1   1  1   2  0   0  0  0  0  0  0  0  1  4  0
>   0  0   0  0    0  0  0  0  0  0  0  0  0
>
> traits
>
>       X body    ration  flight     feeding       lifestyle     moisture
> 1    Ab 29.5 0.6203390    none herbivorous geo-chortobiont  xerophilous
> 2    Bb 16.0 1.0625000 reduced  omnivorous     chortobiont  mesophilous
> 3    Ci 23.5 0.5829787    full  omnivorous geo-chortobiont  xerophilous
> 4    Cb 18.0 0.6000000    full herbivorous     chortobiont  mesophilous
> 5   Cbm 18.0 0.6000000    full herbivorous     chortobiont  mesophilous
> 6   Cdo 17.5 0.6342857 reduced herbivorous     chortobiont  mesophilous
> 7    Cm 17.5 0.5914286    full herbivorous     chortobiont  mesophilous
> 8   Cdi 21.5 0.5883721 reduced herbivorous     chortobiont hygrophilous
> 9    Dv 34.0 0.9044118 reduced carnivorous geo-chortobiont  mesophilous
> 10  Edi 27.0 0.7222222    none  omnivorous     thamnobiont  xerophilous
> 11   Ee 25.0 0.6400000    none  omnivorous     thamnobiont  mesophilous
> 12  Ede 20.5 0.5902439    none herbivorous     chortobiont  xerophilous
> 13   Es 25.5 0.9803922    none  omnivorous     thamnobiont  mesophilous
> 14   Eb 18.0 0.6416667 reduced herbivorous     chortobiont  mesophilous
> 15   Gc 22.5 0.4555556    none  omnivorous        geobiont  mesophilous
> 16   La 13.0 0.9807692    none herbivorous     chortobiont  mesophilous
> 17   Mm 18.0 1.0972222    none  omnivorous geo-chortobiont  xerophilous
> 18   Op 12.0 0.6666667    full  omnivorous     thamnobiont  xerophilous
> 19   Oc 21.0 0.5690476    full herbivorous        geobiont  xerophilous
> 20   Oh 15.5 0.5967742 reduced herbivorous     chortobiont  mesophilous
> 21   Or 15.5 0.7193548 reduced herbivorous     chortobiont  mesophilous
> 22  Pgr 17.0 1.0588235    none  omnivorous     thamnobiont  mesophilous
> 23   Ps 21.5 1.0465116    none  omnivorous     thamnobiont  mesophilous
> 24  Pgi 14.0 0.5500000    none herbivorous     chortobiont  mesophilous
> 25   Pf 26.5 0.9622642    none  omnivorous     thamnobiont  mesophilous
> 26 Pgri 17.5 1.0428571    none  omnivorous     thamnobiont  mesophilous
> 27   Po 17.0 0.8970588    none herbivorous     chortobiont  mesophilous
> 28   Pp 17.5 0.6542857 reduced herbivorous     chortobiont  mesophilous
> 29   Rr 17.5 0.8857143 reduced  omnivorous     chortobiont  mesophilous
> 30   Ss 22.5 0.5733333    full herbivorous     chortobiont  mesophilous
> 31   Sl 20.5 0.6268293 reduced herbivorous     chortobiont  mesophilous
> 32   Ts 12.5 0.4720000 reduced herbivorous        geobiont hygrophilous
> 33   Tv 33.0 0.7803030    full carnivorous     thamnobiont  mesophilous
> 34   Tr 20.0 0.9000000    none  omnivorous        geobiont hygrophilous
>
>
> Thank you in advance and kind regards,
> Vesna
>
>
> --
> Vesna Gulin,  Research and Teaching Assistant
> Department of Biology
> Faculty of Science
> University of Zagreb
> Rooseveltov trg 6, 10000 Zagreb, Croatia
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.



-- 
Sarah Goslee (she/her)
http://www.numberwright.com


From chettyvk @end|ng |rom gm@||@com  Thu Apr  1 02:10:29 2021
From: chettyvk @end|ng |rom gm@||@com (Veerappa Chetty)
Date: Wed, 31 Mar 2021 20:10:29 -0400
Subject: [R] using MAP and PURR to compute characteristic roots
Message-ID: <CAFpsATYpxa8PvT0y7j8qOc+gGrkov=2sCaOU9VW0D6dwPiysHw@mail.gmail.com>

I have to compute characteristic roots for 100s of U.S.counties.  I got
help using " lapply". I prefer using MAP and PURR if that is possible. I am
using them to compute linear regressions.
Here is my test problem and the output. I would appreciate any help.
Thanks
V.K.Chetty
____
test.dat<- tibble(ID=c(1,2),a=c(1,1),b=c(1,1),c=c(2,2),d=c(4,3))
test.out<-test.dat %>% nest(-ID) %>% mutate(fit = purrr::map(data,~
function(x) eigen(data.matrix(x)), data=.))

I get this output:
> test.out$fit
[[1]]
function(x) eigen(data.matrix(x))
<environment: 0x0000017d35f00518>

[[2]]
function(x) eigen(data.matrix(x))
<environment: 0x0000017d35ef73d0>

	[[alternative HTML version deleted]]


From dw|n@em|u@ @end|ng |rom comc@@t@net  Thu Apr  1 02:42:11 2021
From: dw|n@em|u@ @end|ng |rom comc@@t@net (David Winsemius)
Date: Wed, 31 Mar 2021 17:42:11 -0700
Subject: [R] using MAP and PURR to compute characteristic roots
In-Reply-To: <CAFpsATYpxa8PvT0y7j8qOc+gGrkov=2sCaOU9VW0D6dwPiysHw@mail.gmail.com>
References: <CAFpsATYpxa8PvT0y7j8qOc+gGrkov=2sCaOU9VW0D6dwPiysHw@mail.gmail.com>
Message-ID: <51e75345-b8fe-d1ff-d600-3554bfb18dd9@comcast.net>


On 3/31/21 5:10 PM, Veerappa Chetty wrote:
> I have to compute characteristic roots for 100s of U.S.counties.  I got
> help using " lapply". I prefer using MAP and PURR if that is possible. I am
> using them to compute linear regressions.
> Here is my test problem and the output. I would appreciate any help.
> Thanks
> V.K.Chetty
> ____
> test.dat<- tibble(ID=c(1,2),a=c(1,1),b=c(1,1),c=c(2,2),d=c(4,3))
> test.out<-test.dat %>% nest(-ID) %>% mutate(fit = purrr::map(data,~
> function(x) eigen(data.matrix(x)), data=.))


I think you will find that there is a bias on R-help toward using "base" 
R functions where it seems "natural". The venue where "tidyverse" 
solutions are typically returned is StackOverflow.)

It wasn't stated? clearly what you wanted from this. The `eigen` 
function returns a list object so the apply function neatly handles row 
based operations:


 > apply( test.dat[-1], 1, function(x){eigen(matrix(x,2))})
[[1]]
eigen() decomposition
$values
[1] 4.5615528 0.4384472

$vectors
 ?????????? [,1]?????? [,2]
[1,] -0.4896337 -0.9627697
[2,] -0.8719282? 0.2703230


[[2]]
eigen() decomposition
$values
[1] 3.7320508 0.2679492

$vectors
 ?????????? [,1]?????? [,2]
[1,] -0.5906905 -0.9390708
[2,] -0.8068982? 0.3437238


If you instead wanted only the eigenvalues you might have chosen to 
extract them at the time of the `eigen` call:


 ?apply( test.dat[-1], 1, function(x){eigen(matrix(x,2))$values})
 ????????? [,1]????? [,2]
[1,] 4.5615528 3.7320508
[2,] 0.4384472 0.2679492

Do note that the values are returned column-wise.

(I see that you noted in an earlier (duplicate) rhelp posting that you 
were expecting "younger" respondents. Since I'm in my eighth decade, I 
probably don't qualify.)


-- 

David Winsemius, MD


>
> I get this output:
>> test.out$fit
> [[1]]
> function(x) eigen(data.matrix(x))
> <environment: 0x0000017d35f00518>
>
> [[2]]
> function(x) eigen(data.matrix(x))
> <environment: 0x0000017d35ef73d0>
>
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Thu Apr  1 02:46:26 2021
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Wed, 31 Mar 2021 17:46:26 -0700
Subject: [R] using MAP and PURR to compute characteristic roots
In-Reply-To: <CAFpsATYpxa8PvT0y7j8qOc+gGrkov=2sCaOU9VW0D6dwPiysHw@mail.gmail.com>
References: <CAFpsATYpxa8PvT0y7j8qOc+gGrkov=2sCaOU9VW0D6dwPiysHw@mail.gmail.com>
Message-ID: <528D658C-C7B8-4D48-9432-67DBB1B5B862@dcn.davis.ca.us>

Since purrr:map() is functionally identical to lapply, it is not at all clear to me what you are having trouble with. What output did you want?

On March 31, 2021 5:10:29 PM PDT, Veerappa Chetty <chettyvk at gmail.com> wrote:
>I have to compute characteristic roots for 100s of U.S.counties.  I got
>help using " lapply". I prefer using MAP and PURR if that is possible.
>I am
>using them to compute linear regressions.
>Here is my test problem and the output. I would appreciate any help.
>Thanks
>V.K.Chetty
>____
>test.dat<- tibble(ID=c(1,2),a=c(1,1),b=c(1,1),c=c(2,2),d=c(4,3))
>test.out<-test.dat %>% nest(-ID) %>% mutate(fit = purrr::map(data,~
>function(x) eigen(data.matrix(x)), data=.))
>
>I get this output:
>> test.out$fit
>[[1]]
>function(x) eigen(data.matrix(x))
><environment: 0x0000017d35f00518>
>
>[[2]]
>function(x) eigen(data.matrix(x))
><environment: 0x0000017d35ef73d0>
>
>	[[alternative HTML version deleted]]
>
>______________________________________________
>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>https://stat.ethz.ch/mailman/listinfo/r-help
>PLEASE do read the posting guide
>http://www.R-project.org/posting-guide.html
>and provide commented, minimal, self-contained, reproducible code.

-- 
Sent from my phone. Please excuse my brevity.


From drj|m|emon @end|ng |rom gm@||@com  Thu Apr  1 03:46:07 2021
From: drj|m|emon @end|ng |rom gm@||@com (Jim Lemon)
Date: Thu, 1 Apr 2021 12:46:07 +1100
Subject: [R] Controling the presentation of violin plot
In-Reply-To: <62007f9b632d49c1bfa8c12dbb1b44a5@ugent.be>
References: <62007f9b632d49c1bfa8c12dbb1b44a5@ugent.be>
Message-ID: <CA+8X3fVQ_BaYHxaLD_By70CG8YaGsu6nJr-NcFhy3MKkbd2R+g@mail.gmail.com>

Hi Mahmood,
As I don't know what "mydata" is, I'll have to fake it. Do you want
something like this?

yourdata<-data.frame(x1=c(1250,600,rep(200,9)),
 x2=c(7000,2300,800,rep(100,8)),
 x3=c(8900,950,300,rep(0,8)),
 x4=c(1400,1000,rep(600,4),rep(200,5)))
library(plotrix)
violin_plot(yourdata)

Jim

On Thu, Apr 1, 2021 at 9:53 AM Mahmood Naderan-Tahan
<mahmood.naderan at ugent.be> wrote:
>
> Hi,
>
> With the following command, I get a messy violin plot which can be seen at https://pasteboard.co/JVdZKNz.jpg
>
>
> p <- ggplot(mydata, aes(x=BE, y=INT)) + geom_violin(trim=FALSE)
> p + geom_dotplot(binaxis='y', stackdir='center', dotsize=1)
>
>
> It seems that the y-axis has a large scale and that causes the points to be shown with bad sizes.
>
> Any way to fix that?
>
>
>
> Regards,
> Mahmood
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Thu Apr  1 05:09:20 2021
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Thu, 1 Apr 2021 04:09:20 +0100
Subject: [R] Controling the presentation of violin plot
In-Reply-To: <62007f9b632d49c1bfa8c12dbb1b44a5@ugent.be>
References: <62007f9b632d49c1bfa8c12dbb1b44a5@ugent.be>
Message-ID: <314abe3b-936f-5638-1726-697cb78db54c@sapo.pt>

Hello,

If the problem is the dots sizes, why not reduce it?
Below I have dotsize=0.5, half of yours.


p + geom_dotplot(binaxis='y', stackdir='center', dotsize=0.5)


Alternatively, plot the y axis in a log scale. Since there are zeros in 
the data, scales::pseudo_log_trans, will be used.

p + geom_dotplot(binaxis='y', stackdir='center', dotsize=1) +
   scale_y_continuous(
     trans = scales::pseudo_log_trans(base = exp(1))
   )


Hope this helps,

Rui Barradas

?s 23:49 de 31/03/21, Mahmood Naderan-Tahan escreveu:
> Hi,
> 
> With the following command, I get a messy violin plot which can be seen at https://pasteboard.co/JVdZKNz.jpg
> 
> 
> p <- ggplot(mydata, aes(x=BE, y=INT)) + geom_violin(trim=FALSE)
> p + geom_dotplot(binaxis='y', stackdir='center', dotsize=1)
> 
> 
> It seems that the y-axis has a large scale and that causes the points to be shown with bad sizes.
> 
> Any way to fix that?
> 
> 
> 
> Regards,
> Mahmood
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>


From m@hmood@n@der@n @end|ng |rom ugent@be  Thu Apr  1 07:52:38 2021
From: m@hmood@n@der@n @end|ng |rom ugent@be (Mahmood Naderan-Tahan)
Date: Thu, 1 Apr 2021 05:52:38 +0000
Subject: [R] Controling the presentation of violin plot
In-Reply-To: <314abe3b-936f-5638-1726-697cb78db54c@sapo.pt>
References: <62007f9b632d49c1bfa8c12dbb1b44a5@ugent.be>,
 <314abe3b-936f-5638-1726-697cb78db54c@sapo.pt>
Message-ID: <655283520c5743639f8d0ac319e18199@ugent.be>

>Alternatively, plot the y axis in a log scale. Since there are zeros in
>the data, scales::pseudo_log_trans, will be used.
>
>p + geom_dotplot(binaxis='y', stackdir='center', dotsize=1) +
>   scale_y_continuous(
>     trans = scales::pseudo_log_trans(base = exp(1))
>   )



Yes that is a good hint. Thanks.


Regards,
Mahmood

________________________________
From: Rui Barradas <ruipbarradas at sapo.pt>
Sent: Thursday, April 1, 2021 5:09:20 AM
To: Mahmood Naderan-Tahan; r-help at r-project.org
Subject: Re: [R] Controling the presentation of violin plot

Hello,

If the problem is the dots sizes, why not reduce it?
Below I have dotsize=0.5, half of yours.


p + geom_dotplot(binaxis='y', stackdir='center', dotsize=0.5)


Alternatively, plot the y axis in a log scale. Since there are zeros in
the data, scales::pseudo_log_trans, will be used.

p + geom_dotplot(binaxis='y', stackdir='center', dotsize=1) +
   scale_y_continuous(
     trans = scales::pseudo_log_trans(base = exp(1))
   )


Hope this helps,

Rui Barradas

?s 23:49 de 31/03/21, Mahmood Naderan-Tahan escreveu:
> Hi,
>
> With the following command, I get a messy violin plot which can be seen at https://pasteboard.co/JVdZKNz.jpg
>
>
> p <- ggplot(mydata, aes(x=BE, y=INT)) + geom_violin(trim=FALSE)
> p + geom_dotplot(binaxis='y', stackdir='center', dotsize=1)
>
>
> It seems that the y-axis has a large scale and that causes the points to be shown with bad sizes.
>
> Any way to fix that?
>
>
>
> Regards,
> Mahmood
>
>        [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From m@hmood@n@der@n @end|ng |rom ugent@be  Thu Apr  1 08:00:37 2021
From: m@hmood@n@der@n @end|ng |rom ugent@be (Mahmood Naderan-Tahan)
Date: Thu, 1 Apr 2021 06:00:37 +0000
Subject: [R] Violin plot with mean_sdl
Message-ID: <315326e2411e4436aa5f64c171c4b1c7@ugent.be>

Hi,

I followed the example described at [1] but I don't know why I get the following warning


> library(ggplot2)
> library(Hmisc)
> mydata <- read.csv('test.csv', header=T,row.names=1)
> mydata
     V1  V2   V3 V4
P1 73.6 0.7 74.6  R
P2 75.2 0.7 75.8  R
P3  6.5 0.0  7.3  R
P4 41.4 0.3 39.2  C
P5  5.4 0.1 18.2  C
P6 18.8 0.3 30.3  C
> p <- ggplot(mydata, aes(x=V4, y=V1)) + geom_violin(trim=FALSE)
> p + stat_summary(fun.data="mean_sdl", mult=1,
+                  geom="crossbar", width=0.2 )
Warning message:
Ignoring unknown parameters: mult


How can I fix that?



[1] http://www.sthda.com/english/wiki/ggplot2-violin-plot-quick-start-guide-r-software-and-data-visualization


Regards,
Mahmood

	[[alternative HTML version deleted]]


From r_goertz @end|ng |rom web@de  Thu Apr  1 10:05:04 2021
From: r_goertz @end|ng |rom web@de (Ralf Goertz)
Date: Thu, 1 Apr 2021 10:05:04 +0200
Subject: [R] How can certain variables be automatically excluded from being
 saved?
Message-ID: <20210401100504.0a77696e@delli.fritz.box>

Hi,

after having read here about the "seed problem" I wonder if there is a
way to automatically exclude certain variables from being saved when the
workspace image is saved at the end of an interactive session. I have
been using .First() and .Last() for ages but apparently they are of no
help as .First() gets called before loading the workspace and .Last()
after it has been saved. At least the line

if (".Random.seed" %in% ls(all.names=T)) rm(.Random.seed, pos=1)

in either of those functions doesn't have the desired effect.


From drj|m|emon @end|ng |rom gm@||@com  Thu Apr  1 12:20:24 2021
From: drj|m|emon @end|ng |rom gm@||@com (Jim Lemon)
Date: Thu, 1 Apr 2021 21:20:24 +1100
Subject: [R] 
 How can certain variables be automatically excluded from being
 saved?
In-Reply-To: <20210401100504.0a77696e@delli.fritz.box>
References: <20210401100504.0a77696e@delli.fritz.box>
Message-ID: <CA+8X3fVEVHhhRTbQa8vGMF58S=qrwfsDx3-zDib8LoSz_zHk1w@mail.gmail.com>

Hi Ralph,
I suppose you could write a wrapper for q():

byebye<-function(drop=".Random.seed",save = "default", status = 0,
runLast = TRUE) {
 if(drop %in% ls(all.names=TRUE)) rm(drop,pos=1)
 q(save=save,status=status,runLast=runLast)
)

warning: untested

Jim

On Thu, Apr 1, 2021 at 7:05 PM Ralf Goertz <r_goertz at web.de> wrote:
>
> Hi,
>
> after having read here about the "seed problem" I wonder if there is a
> way to automatically exclude certain variables from being saved when the
> workspace image is saved at the end of an interactive session. I have
> been using .First() and .Last() for ages but apparently they are of no
> help as .First() gets called before loading the workspace and .Last()
> after it has been saved. At least the line
>
> if (".Random.seed" %in% ls(all.names=T)) rm(.Random.seed, pos=1)
>
> in either of those functions doesn't have the desired effect.
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From murdoch@dunc@n @end|ng |rom gm@||@com  Thu Apr  1 14:39:45 2021
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Thu, 1 Apr 2021 08:39:45 -0400
Subject: [R] 
 How can certain variables be automatically excluded from being
 saved?
In-Reply-To: <20210401100504.0a77696e@delli.fritz.box>
References: <20210401100504.0a77696e@delli.fritz.box>
Message-ID: <c17e87e7-ee5a-6936-95ae-88af59d74ed9@gmail.com>

On 01/04/2021 4:05 a.m., Ralf Goertz wrote:
> Hi,
> 
> after having read here about the "seed problem" I wonder if there is a
> way to automatically exclude certain variables from being saved when the
> workspace image is saved at the end of an interactive session. I have
> been using .First() and .Last() for ages but apparently they are of no
> help as .First() gets called before loading the workspace and .Last()
> after it has been saved. At least the line
> 
> if (".Random.seed" %in% ls(all.names=T)) rm(.Random.seed, pos=1)
> 
> in either of those functions doesn't have the desired effect.

Jim suggested a way to do that, but I don't think it's really a good 
idea:  it just fixes one aspect of the problem, it doesn't solve the 
whole thing.

The real problem is saving the workspace occasionally, but always 
loading it.  The "always loading" part is automatic, so I think the real 
solution should address the "occasionally saving" part.

If you always save the workspace, things are fine.  You'll save the seed 
at the end of one session, and load it at the beginning of the next.

If you never save the workspace, things are also fine.  You'll always 
generate a new seed in each session that needs one.

Personally, I believe in the "never save it" workflow.  I think it has 
lots of benefits besides the random seed issue:  you won't get a 
more-and-more cluttered workspace over time, you end up with more 
reproducible results, etc.  However, I can understand that some people 
use a different workflow, so "always save it" is sometimes a reasonable 
choice.

So the real problem is the "sometimes save it" workflow, which is 
**encouraged** by the default q(save = "default") option, which asks 
when interactive.  Changing the default to act like q(save = "no") would 
be my preference (and that's how I configure things), but changing it to 
act like q(save = "yes") would be an improvement over the current choice.

Duncan Murdoch


From r_goertz @end|ng |rom web@de  Thu Apr  1 15:27:03 2021
From: r_goertz @end|ng |rom web@de (Ralf Goertz)
Date: Thu, 1 Apr 2021 15:27:03 +0200
Subject: [R] 
 How can certain variables be automatically excluded from being
 saved?
In-Reply-To: <c17e87e7-ee5a-6936-95ae-88af59d74ed9@gmail.com>
References: <20210401100504.0a77696e@delli.fritz.box>
 <c17e87e7-ee5a-6936-95ae-88af59d74ed9@gmail.com>
Message-ID: <20210401152703.50bb308e@delli.fritz.box>

Am Thu, 1 Apr 2021 08:39:45 -0400
schrieb Duncan Murdoch <murdoch.duncan at gmail.com>:

> On 01/04/2021 4:05 a.m., Ralf Goertz wrote:
> > Hi,
> >
> > after having read here about the "seed problem" I wonder if there
> > is a way to automatically exclude certain variables from being
> > saved when the workspace image is saved at the end of an
> > interactive session. I have been using .First() and .Last() for
> > ages but apparently they are of no help as .First() gets called
> > before loading the workspace and .Last() after it has been saved.
> > At least the line
> >
> > if (".Random.seed" %in% ls(all.names=T)) rm(.Random.seed, pos=1)
> >
> > in either of those functions doesn't have the desired effect.
>
> Jim suggested a way to do that, but I don't think it's really a good
> idea:  it just fixes one aspect of the problem, it doesn't solve the
> whole thing.
>
> The real problem is saving the workspace occasionally, but always
> loading it.  The "always loading" part is automatic, so I think the
> real solution should address the "occasionally saving" part.

Yes, that is exactly what I quite often do. I have to work in different
projects and I usually start R in the project directory. When I do
serious stuff I save afterwards. But quite often I want to check
something quickly and then I don't want to clutter up my workspace.

> If you always save the workspace, things are fine.  You'll save the
> seed at the end of one session, and load it at the beginning of the
> next.
>
> If you never save the workspace, things are also fine.  You'll always
> generate a new seed in each session that needs one.
>
> Personally, I believe in the "never save it" workflow.  I think it
> has lots of benefits besides the random seed issue:  you won't get a
> more-and-more cluttered workspace over time, you end up with more
> reproducible results, etc.  However, I can understand that some
> people use a different workflow, so "always save it" is sometimes a
> reasonable choice.
>
> So the real problem is the "sometimes save it" workflow, which is
> **encouraged** by the default q(save = "default") option, which asks
> when interactive.  Changing the default to act like q(save = "no")
> would be my preference (and that's how I configure things), but
> changing it to act like q(save = "yes") would be an improvement over
> the current choice.

I would prefer to be able to only save the history since that is where
the work is done. Usually, my data is easily restored using commands
from the history. I could probably accomplish that by linking .RData to
/dev/null or making it an empty readonly file. However, I would have to
do that in every directory I happen to use R in.


From ve@n@@gu||n @end|ng |rom b|o|@pm|@hr  Thu Apr  1 10:33:00 2021
From: ve@n@@gu||n @end|ng |rom b|o|@pm|@hr (Vesna Gulin)
Date: Thu, 01 Apr 2021 10:33:00 +0200
Subject: [R] FD package_dbFD error
In-Reply-To: <CAM_vjunW6m274kKvEfs1gnVxwuuUktCBZptyd7RjoDNii60VeA@mail.gmail.com>
References: <22acffee587bcf8377643dfd95ef2c5d@biol.pmf.hr>
 <CAM_vjunW6m274kKvEfs1gnVxwuuUktCBZptyd7RjoDNii60VeA@mail.gmail.com>
Message-ID: <e52d188288b67e7669a69ac435efe42e@biol.pmf.hr>

Hi Sara,

Thank you for your advice and apologies for spamming.

I will try to reorganise the arguments and if it doesn't work, will try 
r-sig-ecology.

Kind regards,
Vesna

On 2021-04-01 0:58, Sarah Goslee wrote:
> Hi,
> 
> While Bert is right that this would be a good question for
> r-sig-ecology, I think you might have made a very simple-to-fix
> mistake:
> 
> According to
> https://www.rdocumentation.org/packages/FD/versions/1.0-12/topics/dbFD
> if you don't name the arguments, traits should come BEFORE sites.
> 
> If that doesn't help, take a look at the site and trait data frames
> used in the examples and see if you can figure out where you went
> wrong. If you can't, then try r-sig-ecology.
> 
> Sarah
> 
> On Wed, Mar 31, 2021 at 6:33 PM Vesna Gulin <vesna.gulin at biol.pmf.hr> 
> wrote:
>> 
>> Hi everyone,
>> 
>> I am trying to conduct dbFD from the FD package, but it keeps giving 
>> me
>> the same error:
>> 
>> ex1 <- dbFD(sites, traits)
>> Error in dbFD(sites, traits) :
>>    Different number of species in 'x' and 'a'.
>> 
>> Ab, bb, Ci.... are species names.
>> I have tried rewriting the species names so many times and ways, but
>> nothing seems to work. I also checked for blank space but can't seem 
>> to
>> find one. Does anyone have and idea what am I doing wrong?
>> 
>> My data consists of two data frames:
>> sites
>> 
>>    X Ab Bb Ci Cb Cbm Cdo Cm Cdi Dv Edi Ee Ede Es Eb Gc La Mm Op Oc Oh 
>> Or
>> Pgr Ps Pgi Pf Pgri Po Pp Rr Ss Sl Ts Tv Tr
>> 1 A  0  0  0  0   0   0  1   0  0   0  0   0  1  0  0  0  1  0  0  0  
>> 0
>>   0  0   0  0    0  0  0  0  0  0  0  0  0
>> 2 B  0  0  0  0   0   0  0   0  0   0  0   0  1  0  0  0  0  2  0  0  
>> 0
>>   0  0   0  0    0  0  0  0  0  0  0  0  0
>> 3 C  0  0  0  0   0   0  0   0  0   0  0   0  0  0  0  0  0  0  0  0  
>> 0
>>   0  0   0  0    0  1  0  0  0  0  0  0  0
>> 4 D  0  0  0  0   0   0  0   0  0   0  0   0  0  0  0  0  0  0  0  0  
>> 0
>>   0  0   0  0    0  0  0  0  0  0  0  0  0
>> 5 E  0  0  0  0   0   0  0   3  2   3  0   0  0  0  0  0  0  0  0  4  
>> 0
>>   0  0   0  0    0  0  0  0  0  0  0  0  0
>> 6 F  0  0  0  0   0   0  0   0  3   0  1   0  0  4  1  8  0  1  3  2  
>> 0
>>   0  0   0  0    0  0  0  0  0  0  0  0  2
>> 7 G  0  0  0  0   0   0  1   1  1   2  0   0  0  0  0  0  0  0  1  4  
>> 0
>>   0  0   0  0    0  0  0  0  0  0  0  0  0
>> 
>> traits
>> 
>>       X body    ration  flight     feeding       lifestyle     
>> moisture
>> 1    Ab 29.5 0.6203390    none herbivorous geo-chortobiont  
>> xerophilous
>> 2    Bb 16.0 1.0625000 reduced  omnivorous     chortobiont  
>> mesophilous
>> 3    Ci 23.5 0.5829787    full  omnivorous geo-chortobiont  
>> xerophilous
>> 4    Cb 18.0 0.6000000    full herbivorous     chortobiont  
>> mesophilous
>> 5   Cbm 18.0 0.6000000    full herbivorous     chortobiont  
>> mesophilous
>> 6   Cdo 17.5 0.6342857 reduced herbivorous     chortobiont  
>> mesophilous
>> 7    Cm 17.5 0.5914286    full herbivorous     chortobiont  
>> mesophilous
>> 8   Cdi 21.5 0.5883721 reduced herbivorous     chortobiont 
>> hygrophilous
>> 9    Dv 34.0 0.9044118 reduced carnivorous geo-chortobiont  
>> mesophilous
>> 10  Edi 27.0 0.7222222    none  omnivorous     thamnobiont  
>> xerophilous
>> 11   Ee 25.0 0.6400000    none  omnivorous     thamnobiont  
>> mesophilous
>> 12  Ede 20.5 0.5902439    none herbivorous     chortobiont  
>> xerophilous
>> 13   Es 25.5 0.9803922    none  omnivorous     thamnobiont  
>> mesophilous
>> 14   Eb 18.0 0.6416667 reduced herbivorous     chortobiont  
>> mesophilous
>> 15   Gc 22.5 0.4555556    none  omnivorous        geobiont  
>> mesophilous
>> 16   La 13.0 0.9807692    none herbivorous     chortobiont  
>> mesophilous
>> 17   Mm 18.0 1.0972222    none  omnivorous geo-chortobiont  
>> xerophilous
>> 18   Op 12.0 0.6666667    full  omnivorous     thamnobiont  
>> xerophilous
>> 19   Oc 21.0 0.5690476    full herbivorous        geobiont  
>> xerophilous
>> 20   Oh 15.5 0.5967742 reduced herbivorous     chortobiont  
>> mesophilous
>> 21   Or 15.5 0.7193548 reduced herbivorous     chortobiont  
>> mesophilous
>> 22  Pgr 17.0 1.0588235    none  omnivorous     thamnobiont  
>> mesophilous
>> 23   Ps 21.5 1.0465116    none  omnivorous     thamnobiont  
>> mesophilous
>> 24  Pgi 14.0 0.5500000    none herbivorous     chortobiont  
>> mesophilous
>> 25   Pf 26.5 0.9622642    none  omnivorous     thamnobiont  
>> mesophilous
>> 26 Pgri 17.5 1.0428571    none  omnivorous     thamnobiont  
>> mesophilous
>> 27   Po 17.0 0.8970588    none herbivorous     chortobiont  
>> mesophilous
>> 28   Pp 17.5 0.6542857 reduced herbivorous     chortobiont  
>> mesophilous
>> 29   Rr 17.5 0.8857143 reduced  omnivorous     chortobiont  
>> mesophilous
>> 30   Ss 22.5 0.5733333    full herbivorous     chortobiont  
>> mesophilous
>> 31   Sl 20.5 0.6268293 reduced herbivorous     chortobiont  
>> mesophilous
>> 32   Ts 12.5 0.4720000 reduced herbivorous        geobiont 
>> hygrophilous
>> 33   Tv 33.0 0.7803030    full carnivorous     thamnobiont  
>> mesophilous
>> 34   Tr 20.0 0.9000000    none  omnivorous        geobiont 
>> hygrophilous
>> 
>> 
>> Thank you in advance and kind regards,
>> Vesna
>> 
>> 
>> --
>> Vesna Gulin,  Research and Teaching Assistant
>> Department of Biology
>> Faculty of Science
>> University of Zagreb
>> Rooseveltov trg 6, 10000 Zagreb, Croatia
>> 
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide 
>> http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.


From w|@e_co|em@n @end|ng |rom y@hoo@com  Thu Apr  1 13:23:37 2021
From: w|@e_co|em@n @end|ng |rom y@hoo@com (Collins Boahen)
Date: Thu, 1 Apr 2021 11:23:37 +0000 (UTC)
Subject: [R] pie3D.labels
In-Reply-To: <CA+8X3fWDw39DrC5UughXNY2N+G2mHby2iFmYgGxU7EuW2QA_Fg@mail.gmail.com>
References: <279211430.1963047.1617108166917.ref@mail.yahoo.com>
 <279211430.1963047.1617108166917@mail.yahoo.com>
 <CA+8X3fWDw39DrC5UughXNY2N+G2mHby2iFmYgGxU7EuW2QA_Fg@mail.gmail.com>
Message-ID: <2032838816.2977186.1617276217366@mail.yahoo.com>

 Dear Dr. Lemon,
Thank you for the rapid response and suggestions as well.
BestCollins
    On Tuesday, March 30, 2021, 11:46:08 PM GMT+2, Jim Lemon <drjimlemon at gmail.com> wrote:  
 
 Hi Collins,
pie3D draws a pseudo-3D pie and then places 2D labels around it. If
you put the labels on top of the pie, it is not going to look right.
The labels will be displayed with an orthogonal viewing angle, while
the pie will be tilted. pie3D is one of those functions that I wrote
for those who might otherwise think that if R can't produce 3D pie
charts, then R is no good. You can do fulsomely decorative plots in R,
and if your boss demands a 3D pie chart, you can do it. If you really
want to create a 3D pie chart with 3D labels, do it with a 3D
rendering program like POVray. I'm afraid that I don't have the time
to provide you with an example right now.

Jim

On Tue, Mar 30, 2021 at 11:42 PM Collins Boahen <wise_coleman at yahoo.com> wrote:
>
> Dear Dr. Lemon,
>
> Thank you for developing such a fantastic package.
>
> I would like to find out if there is a way to insert the labels inside the pie and? manipulate the labels for fit perfectly.
>
> Please any tips or suggestions will be appreciated.
>
> Thank you
>
> Best
> Collins
>
  
	[[alternative HTML version deleted]]


From bend|x@c@r@ten@en @end|ng |rom reg|onh@dk  Thu Apr  1 15:00:21 2021
From: bend|x@c@r@ten@en @end|ng |rom reg|onh@dk (Bendix Carstensen)
Date: Thu, 1 Apr 2021 13:00:21 +0000
Subject: [R] cox.zph
Message-ID: <AM4PR08MB2674993040E72279B6216E3C9D7B9@AM4PR08MB2674.eurprd08.prod.outlook.com>

Further to John Sorkin's post on the cox.zph:
You get test(s) of whether there is an interaction between a variable, say, sex, and time.

Suppose it is significant. You will have no clue whether the M/W hazard ratio is increasing or decreasing by time.

Suppose it is not significant. You will have no clue whether the (non-significant) M/W hazrad ratio exhibits a pattern that is worth looking further into or not.

In this sense the cox.zph is a perfect tool to allow you to write 'we checked for non proportionality' instead of 'we have no clue of how the M/W ratio varies by time'.

If you label it what it is, namely a test of interaction, you might realize that you should ESTIMATE the shape and size of the interaction before deriving a test, either ad-hoc by the Shoenfeld residuals or by proper modeling.

See for example pp 202 ff. in 'Epidemiology with R' by (surprise, surprise) me, published by OUP a few months ago.

b.r.
Bendix Carstensen
Senior Statistician
Steno Diabetes Center Copenhagen
Clinical Epidemiology
Niels Steensens Vej 2-4
DK-2820 Gentofte
Denmark
tel: +45 30 91 29 61
b at bxc.dk
bendix.carstensen at regionh.dk
http://BendixCarstensen.com


________________________________


Region Hovedstaden anvender de personoplysninger, du giver os i forbindelse med din henvendelse. Du kan l?se mere om form?let med anvendelsen samt dine rettigheder p? vores hjemmeside: www.regionh.dk/persondatapolitik


From m@015k3113 @end|ng |rom b|ueyonder@co@uk  Thu Apr  1 17:10:13 2021
From: m@015k3113 @end|ng |rom b|ueyonder@co@uk (e-mail ma015k3113)
Date: Thu, 1 Apr 2021 16:10:13 +0100 (BST)
Subject: [R] 
 [EXT] Calculating the total change in shareprice over a time periond
In-Reply-To: <5c173bf0-3a48-ebb4-a8a6-5b2d99410ee6@usu.edu>
References: <63365987.939790.1617210292526@mail2.virginmedia.com>
 <5c173bf0-3a48-ebb4-a8a6-5b2d99410ee6@usu.edu>
Message-ID: <2120722153.1003459.1617289813954@mail2.virginmedia.com>

Dear David, thanks so much for your time and suggestion. It has worked now.

Kind regards

Ahson
> On 31 March 2021 at 19:17 David K Stevens <david.stevens at usu.edu> wrote:
> 
> 
> Mr. Blueyonder,
> 
> There are a number of problems with this.
> 
> 1) is the data below really in a data frame? I coerced your table into a 
> data frame, guessing at the structure and when I print out the 1st three 
> rows I get an alignment into proper columns
> 
> COMPANY_NUMBER COMPANY_NAME??????????????? CITY YEAR_END_DATE 
> CLOSE_SHARE_PRICE
> 1?????????? 22705? CARDIFF PROPERTY PUBLIC LIMITED COMPANY????????? 
> (THE)Egham??? 30/09/2005??????????????? NA
> 2?????????? 22705? CARDIFF PROPERTY PUBLIC LIMITED COMPANY????????? 
> (THE)Egham??? 30/09/2006??????????????? NA
> 3?????????? 22705? CARDIFF PROPERTY PUBLIC LIMITED COMPANY????????? 
> (THE)Egham??? 30/09/2007????????????? 9.65
> 
> I'd guess that your PLC is actually a 1 column data frame based on how 
> you present it. Because what you gave is so small, I just added commas 
> where they seemed suitable and used
> 
> PLC <- read.csv(file='clipboard',header=T,stringsAsFactors = T)
> 
> to create the data frame above. It's likely that your actual problem is 
> much larger so I'd export the data as a CSV file, and read it into R in 
> a similar way using
> 
> PLC <- read.csv(file='myfile.csv',header=T,stringsAsFactors = T)
> 
> 2) Your code is incorrect as is for two reasons. a) for your approach to 
> work, you'll need to create an empty column CH_SH_PRICE before running 
> the loop, because your loop is trying to place data into a non-existent 
> column b) the code PLC$CH_SH_PRICE(i+1) has to use square brackets, 
> otherwise R thinks PCL$CH_SH_PRICE is a function rather than a reference 
> to column element i+1 as in PLC$CH_SH_PRICE[i+1]
> 
> Also, the functionisTRUE is actually the following
> 
> function (x)
> is.logical(x) && length(x) == 1L && !is.na(x) && x
> 
> Is this really what you want to do, rather than just checking the 
> company number, as inPLC[i,1] == PLC[i+1,1]?
> 
> Assuming (tentatively) I guessed right, here's what I got
> 
> COMPANY_NUMBER??????????????????????????? COMPANY_NAME CITY 
> YEAR_END_DATE CLOSE_SHARE_PRICE CH_SH_PRICE
> 1????????? 22705 CARDIFF PROPERTY PUBLIC LIMITED COMPANY (THE)Egham??? 
> 30/09/2005??????????????? NA????????? NA
> 2????????? 22705 CARDIFF PROPERTY PUBLIC LIMITED COMPANY (THE)Egham??? 
> 30/09/2006??????????????? NA????????? NA
> 3????????? 22705 CARDIFF PROPERTY PUBLIC LIMITED COMPANY (THE)Egham??? 
> 30/09/2007????????????? 9.65????????? NA
> 4????????? 22705 CARDIFF PROPERTY PUBLIC LIMITED COMPANY (THE)Egham??? 
> 30/09/2008????????????? 6.55?????? -3.10
> 
> Good luck.
> 
> David Stevens
> 
> On 3/31/2021 11:04 AM, e-mail ma015k3113 via R-help wrote:
> > Dear All, I have a data frame which is structured as follows:
> >
> >
> > COMPANY_NUMBER  COMPANY_NAME    CITY    YEAR_END_DATE   CLOSE_SHARE_PRICE
> > 22705   CARDIFF PROPERTY PUBLIC LIMITED COMPANY         (THE)Egham      30/09/2005      NA
> > 22705   CARDIFF PROPERTY PUBLIC LIMITED COMPANY         (THE)Egham      30/09/2006      NA
> > 22705   CARDIFF PROPERTY PUBLIC LIMITED COMPANY         (THE)Egham      30/09/2007      9.65
> > 22705   CARDIFF PROPERTY PUBLIC LIMITED COMPANY         (THE)Egham      30/09/2008      6.55
> > 22705   CARDIFF PROPERTY PUBLIC LIMITED COMPANY         (THE)Egham      30/09/2009      6.55
> > 22705   CARDIFF PROPERTY PUBLIC LIMITED COMPANY         (THE)Egham      30/09/2010      7.5
> > 10395804        TOC PROPERTY BACKED LENDING TRUST PLC   Newcastle Upon Tyne     30/11/2016      NA
> > 10395804        TOC PROPERTY BACKED LENDING TRUST PLC   Newcastle Upon Tyne     30/11/2017      1.04
> > 10395804        TOC PROPERTY BACKED LENDING TRUST PLC   Newcastle Upon Tyne     30/11/2018      1.04
> > SC192761        MARTIN CURRIE GLOBAL PORTFOLIO TRUST PLC        Edinburgh       31/01/2000      NA
> > SC192761        MARTIN CURRIE GLOBAL PORTFOLIO TRUST PLC        Edinburgh       31/01/2001      NA
> > SC192761        MARTIN CURRIE GLOBAL PORTFOLIO TRUST PLC        Edinburgh       31/01/2003      NA
> > SC192761        MARTIN CURRIE GLOBAL PORTFOLIO TRUST PLC        Edinburgh       31/01/2004      NA
> > SC192761        MARTIN CURRIE GLOBAL PORTFOLIO TRUST PLC        Edinburgh       31/01/2005      NA
> > SC192761        MARTIN CURRIE GLOBAL PORTFOLIO TRUST PLC        Edinburgh       31/01/2006      1.09
> > SC192761        MARTIN CURRIE GLOBAL PORTFOLIO TRUST PLC        Edinburgh       31/01/2007      1.17
> > SC192761        MARTIN CURRIE GLOBAL PORTFOLIO TRUST PLC        Edinburgh       31/01/2008      1.24
> > SC192761        MARTIN CURRIE GLOBAL PORTFOLIO TRUST PLC        Edinburgh       31/01/2009      0.9
> > SC192761        MARTIN CURRIE GLOBAL PORTFOLIO TRUST PLC        Edinburgh       31/01/2010      1.14
> >
> >
> >
> > I am trying to calculate the total change in share price like for CARDIFF PROPERTY PUBLIC LIMITED COMPANY the total change
> >
> > between 2005 and 2006 is NA and for 2006 and 2007 it is NA for 2007 and 2008 it is -3.1 and 2008 and 2009 it is 0 and 2009 and 2010 it is +.95.
> >
> >
> > I am trying to achieve this via he following code:
> >
> > for (i in 1:(nrow(PLC)-1))
> > if (isTRUE (PLC[i, 1] == PLC[i + 1, 1]))
> > {
> > PLC$CH_SH_PRICE(i+1) = (PLC$CLOSE_SHARE_PRICE[i+1] -
> > PLC$CLOSE_SHARE_PRICE[i])
> > }
> >
> >
> > I get the following error
> >
> >
> > Error in 1:(nrow(PLC) - 1) : argument of length 0
> >
> >
> > Can you kindly suggest any solution to this issue?
> >
> >
> > Thanks in advance.
> >          [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.
> > CAUTION: This email originated from outside of USU. If this appears to be a USU employee, beware of impersonators. Do not click links, reply, download images, or open attachments unless you verify the sender?s identity and know the content is safe.
> >
> -- 
> David K Stevens, P.E., Ph.D.
> Professor, Environmental Engineering
> Civil and Environmental Engineering
> Utah Water Research Laboratory
> 8200 Old Main Hill
> Logan, UT  84322-8200
> 435 797 3229 - voice
> 435 797 1363 - fax
> david.stevens at usu.edu
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From w||||@mwdun|@p @end|ng |rom gm@||@com  Thu Apr  1 17:16:31 2021
From: w||||@mwdun|@p @end|ng |rom gm@||@com (Bill Dunlap)
Date: Thu, 1 Apr 2021 08:16:31 -0700
Subject: [R] Violin plot with mean_sdl
In-Reply-To: <315326e2411e4436aa5f64c171c4b1c7@ugent.be>
References: <315326e2411e4436aa5f64c171c4b1c7@ugent.be>
Message-ID: <CAHqSRuR+a7K=T5JhEsmRpDVCvh+FWuSx56UQtca=Qi6tY8CV4w@mail.gmail.com>

help(stat_summary) suggests you use the fun.args=list(...) argument to
pass arguments to the fun.* functions.   Try replacing mult=1 by
fun.args=list(mult=1).

It is possible that ggplot2::stat_summary changed its behavior since
that web page was written or that the web page was always wrong.

-Bill

On Wed, Mar 31, 2021 at 11:03 PM Mahmood Naderan-Tahan
<mahmood.naderan at ugent.be> wrote:
>
> Hi,
>
> I followed the example described at [1] but I don't know why I get the following warning
>
>
> > library(ggplot2)
> > library(Hmisc)
> > mydata <- read.csv('test.csv', header=T,row.names=1)
> > mydata
>      V1  V2   V3 V4
> P1 73.6 0.7 74.6  R
> P2 75.2 0.7 75.8  R
> P3  6.5 0.0  7.3  R
> P4 41.4 0.3 39.2  C
> P5  5.4 0.1 18.2  C
> P6 18.8 0.3 30.3  C
> > p <- ggplot(mydata, aes(x=V4, y=V1)) + geom_violin(trim=FALSE)
> > p + stat_summary(fun.data="mean_sdl", mult=1,
> +                  geom="crossbar", width=0.2 )
> Warning message:
> Ignoring unknown parameters: mult
>
>
> How can I fix that?
>
>
>
> [1] http://www.sthda.com/english/wiki/ggplot2-violin-plot-quick-start-guide-r-software-and-data-visualization
>
>
> Regards,
> Mahmood
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From kev|n@thorpe @end|ng |rom utoronto@c@  Thu Apr  1 17:46:35 2021
From: kev|n@thorpe @end|ng |rom utoronto@c@ (Kevin Thorpe)
Date: Thu, 1 Apr 2021 15:46:35 +0000
Subject: [R] cox.zph
In-Reply-To: <AM4PR08MB2674993040E72279B6216E3C9D7B9@AM4PR08MB2674.eurprd08.prod.outlook.com>
References: <AM4PR08MB2674993040E72279B6216E3C9D7B9@AM4PR08MB2674.eurprd08.prod.outlook.com>
Message-ID: <202F3418-9344-43F9-B84B-2D083E871C5D@utoronto.ca>

While the statements below about cox.zph are true, plotting the cox.zph result does tell you what the HR is doing. I never use one without the other.

-- 
Kevin E. Thorpe
Head of Biostatistics,  Applied Health Research Centre (AHRC)
Li Ka Shing Knowledge Institute of St. Michael's
Assistant Professor, Dalla Lana School of Public Health
University of Toronto
email: kevin.thorpe at utoronto.ca  Tel: 416.864.5776  Fax: 416.864.3016

> On Apr 1, 2021, at 9:00 AM, Bendix Carstensen <bendix.carstensen at regionh.dk> wrote:
> 
> EXTERNAL EMAIL:
> 
> Further to John Sorkin's post on the cox.zph:
> You get test(s) of whether there is an interaction between a variable, say, sex, and time.
> 
> Suppose it is significant. You will have no clue whether the M/W hazard ratio is increasing or decreasing by time.
> 
> Suppose it is not significant. You will have no clue whether the (non-significant) M/W hazrad ratio exhibits a pattern that is worth looking further into or not.
> 
> In this sense the cox.zph is a perfect tool to allow you to write 'we checked for non proportionality' instead of 'we have no clue of how the M/W ratio varies by time'.
> 
> If you label it what it is, namely a test of interaction, you might realize that you should ESTIMATE the shape and size of the interaction before deriving a test, either ad-hoc by the Shoenfeld residuals or by proper modeling.
> 
> See for example pp 202 ff. in 'Epidemiology with R' by (surprise, surprise) me, published by OUP a few months ago.
> 
> b.r.
> Bendix Carstensen
> Senior Statistician
> Steno Diabetes Center Copenhagen
> Clinical Epidemiology
> Niels Steensens Vej 2-4
> DK-2820 Gentofte
> Denmark
> tel: +45 30 91 29 61
> b at bxc.dk
> bendix.carstensen at regionh.dk
> http://BendixCarstensen.com
> 
> 
> ________________________________
> 
> 
> Region Hovedstaden anvender de personoplysninger, du giver os i forbindelse med din henvendelse. Du kan l?se mere om form?let med anvendelsen samt dine rettigheder p? vores hjemmeside: www.regionh.dk/persondatapolitik
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From giusepp@cei@iu m@iii@g oii gm@ii@com  Thu Apr  1 18:32:04 2021
From: giusepp@cei@iu m@iii@g oii gm@ii@com (giusepp@cei@iu m@iii@g oii gm@ii@com)
Date: Thu, 1 Apr 2021 12:32:04 -0400
Subject: [R] File corruption?
Message-ID: <000801d72714$8d5cd720$a8168560$@gmail.com>

Hello,

I would like to know if anyone has encounter this problem before and what
they have done to solve the problem.  I am not sure if the problem has to do
with R itself or with RStudio.  The problem is the following: sometimes when
I am developing code in R, using R studio -script inside a Shiny
application- at one point my code does not work in the application.  I works
outside the application as a separate script, but it stops working inside
the application with the rest of the functions. So far, what I have done is
to start an entire new script and rewrite the entire code and this will
solve the problem, the code will work fine again.  I wonder if files/script
get corrupted sometimes and need to be refreshed.  

 

Thank you


	[[alternative HTML version deleted]]


From er|cjberger @end|ng |rom gm@||@com  Thu Apr  1 21:52:40 2021
From: er|cjberger @end|ng |rom gm@||@com (Eric Berger)
Date: Thu, 1 Apr 2021 22:52:40 +0300
Subject: [R] File corruption?
In-Reply-To: <000801d72714$8d5cd720$a8168560$@gmail.com>
References: <000801d72714$8d5cd720$a8168560$@gmail.com>
Message-ID: <CAGgJW74sxMx8CApardV4dsUsZ546k-Z10EE0A93Fu_gXt38C0Q@mail.gmail.com>

If your workflow involves debugging and rerunning the code, you may
experience differences between starting from a clean RStudio session and
simply restarting your application. This can be caused by your environment
having variables, shared objects etc defined. It is generally quite quick
to close and open a new RStudio session, so ... when in doubt it's probably
best to do that.

You should be able to organize your workflow so that stopping and starting
RStudio does not require you to rewrite any scripts. (e.g. save your
scripts as you go along)

HTH,
Eric


On Thu, Apr 1, 2021 at 9:45 PM <giuseppacefalu at gmail.com> wrote:

> Hello,
>
> I would like to know if anyone has encounter this problem before and what
> they have done to solve the problem.  I am not sure if the problem has to
> do
> with R itself or with RStudio.  The problem is the following: sometimes
> when
> I am developing code in R, using R studio -script inside a Shiny
> application- at one point my code does not work in the application.  I
> works
> outside the application as a separate script, but it stops working inside
> the application with the rest of the functions. So far, what I have done is
> to start an entire new script and rewrite the entire code and this will
> solve the problem, the code will work fine again.  I wonder if files/script
> get corrupted sometimes and need to be refreshed.
>
>
>
> Thank you
>
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From m@rn@@w@g|ey @end|ng |rom gm@||@com  Fri Apr  2 16:14:40 2021
From: m@rn@@w@g|ey @end|ng |rom gm@||@com (Marna Wagley)
Date: Fri, 2 Apr 2021 07:14:40 -0700
Subject: [R] extraction of last observation date from many observations in
 each row/column
Message-ID: <CAMwU6B09eA5S_yfnUtroTfG=O2P=9gYSaQKUHPBKT6dUd8jDdA@mail.gmail.com>

Dear R-Users,
I have a dataset containing more than two observation dates in some of the
columns and sites  but I wanted to extract only the last date of the
observation.
Is there any easiest way to get that last observation in each column/row?

Here is the example data:
daT<-structure(list(ID = c("M3", "M5", "M1"), Site1 =
c("12/20/2018,12/28/2018",
"12/17/18", ""), Site2 = c("", "", "1/19/2019"), Site3 = c("9/25/2019", "",
"1/10/2019, 1/11/2019, 1/17/2019")), class = "data.frame", row.names =
c(NA,-3L))

#I wanted to make the table like this:
output<-structure(list(ID = c("M3", "M5", "M1"), Site1 = c("12/28/2018",
"12/7/2018", ""), Site2 = c("", "", "1/19/2019"), Site3 = c("9/25/2019",
 "", "1/17/2019")), class = "data.frame", row.names = c(NA, -3L))

Thank you for your help.
Sincerely,
MW

	[[alternative HTML version deleted]]


From @@r@h@go@|ee @end|ng |rom gm@||@com  Fri Apr  2 16:31:51 2021
From: @@r@h@go@|ee @end|ng |rom gm@||@com (Sarah Goslee)
Date: Fri, 2 Apr 2021 10:31:51 -0400
Subject: [R] 
 extraction of last observation date from many observations in
 each row/column
In-Reply-To: <CAMwU6B09eA5S_yfnUtroTfG=O2P=9gYSaQKUHPBKT6dUd8jDdA@mail.gmail.com>
References: <CAMwU6B09eA5S_yfnUtroTfG=O2P=9gYSaQKUHPBKT6dUd8jDdA@mail.gmail.com>
Message-ID: <CAM_vju=hQRYQC+=qaq0UFi8-cM60CDZzj=o_avRwkk7HDnVONg@mail.gmail.com>

Hi Marna,

This very short function deletes everything before the last , if there
is a comma. Some of your entries have comma-space and some just have
comma, so it deletes the optional space as well.

lastdate <- function(x) {
  sub("^.*, *", "", x)
 }

data.frame(apply(daT, 2, lastdate))

Sarah

On Fri, Apr 2, 2021 at 10:15 AM Marna Wagley <marna.wagley at gmail.com> wrote:
>
> Dear R-Users,
> I have a dataset containing more than two observation dates in some of the
> columns and sites  but I wanted to extract only the last date of the
> observation.
> Is there any easiest way to get that last observation in each column/row?
>
> Here is the example data:
> daT<-structure(list(ID = c("M3", "M5", "M1"), Site1 =
> c("12/20/2018,12/28/2018",
> "12/17/18", ""), Site2 = c("", "", "1/19/2019"), Site3 = c("9/25/2019", "",
> "1/10/2019, 1/11/2019, 1/17/2019")), class = "data.frame", row.names =
> c(NA,-3L))
>
> #I wanted to make the table like this:
> output<-structure(list(ID = c("M3", "M5", "M1"), Site1 = c("12/28/2018",
> "12/7/2018", ""), Site2 = c("", "", "1/19/2019"), Site3 = c("9/25/2019",
>  "", "1/17/2019")), class = "data.frame", row.names = c(NA, -3L))
>
> Thank you for your help.
> Sincerely,
> MW
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.



-- 
Sarah Goslee (she/her)
http://www.numberwright.com


From m@@@|mo@bre@@@n @end|ng |rom @rp@@veneto@|t  Sat Apr  3 11:13:46 2021
From: m@@@|mo@bre@@@n @end|ng |rom @rp@@veneto@|t (massimo bressan)
Date: Sat, 3 Apr 2021 11:13:46 +0200
Subject: [R] overlay geom_contour to ggmap
Message-ID: <CAFZj84_RMyFKga_=_pcs+2oL41dFBX_DVqpdfPCODm8mL2d8bA@mail.gmail.com>

consider this reproducible example

# set the origin of the grid # in cartesian coordinates (epsg 32632)
xmin<-742966
ymin<-5037923
# set x and y axis
x<-seq(xmin, xmin+25*39, by=25)
y<-seq(ymin, ymin+25*39, by =25)
# define a 40 x 40 grid
mygrid<-expand.grid(x = x, y = y)
# set the z value to be interpolated by the contour
set.seed(123)
mygrid$z<- rnorm(nrow(mygrid))

library(tidyverse)
# plot of contour is fine
ggplot(data=mygrid, aes(x=x,y=y,z=z))+
  geom_contour()

library(ggspatial)
# transform coordinates to wgs84 4326# (one of the possible many other
ways to do it)
mygrid_4326<-xy_transform(mygrid$x, mygrid$y, from = 32632, to = 4326)
# create new grid with lon and lat # (geographical coordinates espg 4326)
mygrid_4326<-mygrid_4326%>%
  mutate(z=mygrid$z)
# define the bounding box
my_bb<-c(min(mygrid_4326$x), min(mygrid_4326$y),
         max(mygrid_4326$x),
max(mygrid_4326$y))names(my_bb)<-c('left', 'bottom', 'right', 'top')

library(ggmap)
# get the background map (by a free provider)
mymap<-get_stamenmap(bbox = c(left = my_bb[['left']],
                              bottom = my_bb[['bottom']],
                              right = my_bb[['right']],
                              top = my_bb[['top']]),
                     zoom = 15,
                     maptype = 'toner-lite')
# plot of the map is fine
mymap%>%
  ggmap()
# overlay the contour of z is failing
mymap%>%
  ggmap()+
  #geom_contour(data=mygrid_4326, mapping=aes(x = x, y = y, z = z))
  stat_contour(data=mygrid_4326, mapping=aes(x = x, y = y, z = z))

Warning messages:1: stat_contour(): Zero contours were generated 2: In
min(x) : no non-missing arguments to min; returning Inf3: In max(x) :
no non-missing arguments to max; returning -Inf



the problem here is the overlay of the contour plot made with ggplot to a
base map made with ggmap

any help?

thanks

	[[alternative HTML version deleted]]


From j@ork|n @end|ng |rom @om@um@ry|@nd@edu  Mon Apr  5 03:34:42 2021
From: j@ork|n @end|ng |rom @om@um@ry|@nd@edu (Sorkin, John)
Date: Mon, 5 Apr 2021 01:34:42 +0000
Subject: [R] Plotting adjusted KM curve
Message-ID: <MN2PR03MB5167831095C7DEFEFAF23E76E2779@MN2PR03MB5167.namprd03.prod.outlook.com>

Colleagues,
I am using the coxph to model survival time. How do I plot an adjusted Kaplan Meir plot resulting from coxph? The code I would like to run would start with:

# run cox model
fit1Cox <- coxph(surv_object ~age+sex,data=mydata)

I have no idea what would follow.

I would like to plot adjusted KM curves for men vs. women at age 65.

Thank you,
John


	[[alternative HTML version deleted]]


From j|ox @end|ng |rom mcm@@ter@c@  Mon Apr  5 04:45:41 2021
From: j|ox @end|ng |rom mcm@@ter@c@ (John Fox)
Date: Sun, 4 Apr 2021 22:45:41 -0400
Subject: [R] Plotting adjusted KM curve
In-Reply-To: <31181_1617586517_1351ZHCt005276_MN2PR03MB5167831095C7DEFEFAF23E76E2779@MN2PR03MB5167.namprd03.prod.outlook.com>
References: <31181_1617586517_1351ZHCt005276_MN2PR03MB5167831095C7DEFEFAF23E76E2779@MN2PR03MB5167.namprd03.prod.outlook.com>
Message-ID: <bd421645-0754-9c59-9499-e312b44a783e@mcmaster.ca>

Dear John,

I think that what you're looking for is

plot(survfit(fit1Cox, newdata=data.frame(age=rep(65, 2), 
sex=factor("female", "male"))))

assuming, of course, that sex is a factor with levels "female" and "male".

I hope this helps,
  John

John Fox, Professor Emeritus
McMaster University
Hamilton, Ontario, Canada
web: https://socialsciences.mcmaster.ca/jfox/

On 2021-04-04 9:34 p.m., Sorkin, John wrote:
> Colleagues,
> I am using the coxph to model survival time. How do I plot an adjusted Kaplan Meir plot resulting from coxph? The code I would like to run would start with:
> 
> # run cox model
> fit1Cox <- coxph(surv_object ~age+sex,data=mydata)
> 
> I have no idea what would follow.
> 
> I would like to plot adjusted KM curves for men vs. women at age 65.
> 
> Thank you,
> John
> 
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>


From j|ox @end|ng |rom mcm@@ter@c@  Mon Apr  5 04:58:23 2021
From: j|ox @end|ng |rom mcm@@ter@c@ (John Fox)
Date: Sun, 4 Apr 2021 22:58:23 -0400
Subject: [R] Plotting adjusted KM curve
In-Reply-To: <15682_1617590758_1352jwRV026176_bd421645-0754-9c59-9499-e312b44a783e@mcmaster.ca>
References: <31181_1617586517_1351ZHCt005276_MN2PR03MB5167831095C7DEFEFAF23E76E2779@MN2PR03MB5167.namprd03.prod.outlook.com>
 <15682_1617590758_1352jwRV026176_bd421645-0754-9c59-9499-e312b44a783e@mcmaster.ca>
Message-ID: <0b6849c4-9fa7-733a-a92c-371a8a80703c@mcmaster.ca>

On 2021-04-04 10:45 p.m., John Fox wrote:
> Dear John,
> 
> I think that what you're looking for is
> 
> plot(survfit(fit1Cox, newdata=data.frame(age=rep(65, 2), 
> sex=factor("female", "male"))))

Whoops, that should be

plot(survfit(fit1Cox, newdata=data.frame(age=rep(65, 2), 
sex=factor(c("female", "male")))))

John


> 
> assuming, of course, that sex is a factor with levels "female" and "male".
> 
> I hope this helps,
> John
> 
> John Fox, Professor Emeritus
> McMaster University
> Hamilton, Ontario, Canada
> web: https://socialsciences.mcmaster.ca/jfox/
> 
> On 2021-04-04 9:34 p.m., Sorkin, John wrote:
>> Colleagues,
>> I am using the coxph to model survival time. How do I plot an adjusted 
>> Kaplan Meir plot resulting from coxph? The code I would like to run 
>> would start with:
>>
>> # run cox model
>> fit1Cox <- coxph(surv_object ~age+sex,data=mydata)
>>
>> I have no idea what would follow.
>>
>> I would like to plot adjusted KM curves for men vs. women at age 65.
>>
>> Thank you,
>> John
>>
>>
>> ????[[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide 
>> http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>>
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide 
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From grond @end|ng |rom number|@nd@de  Mon Apr  5 09:54:07 2021
From: grond @end|ng |rom number|@nd@de (Wolfgang Grond)
Date: Mon, 5 Apr 2021 09:54:07 +0200
Subject: [R] Identifying tidygraph subgraphs
Message-ID: <db5e2e32-32ad-3f22-86d2-613c1306270d@numberland.de>

Dear all,

imagine the following situation:

I want to create a tidygraph consisting of several subgraphs like in 
this example:

gr1  <-  create_notable 
<https://rdrr.io/cran/tidygraph/man/create_graphs.html>('bull')  %>%
   activate <https://rdrr.io/cran/tidygraph/man/activate.html>(nodes)  %>%
   mutate <https://rdrr.io/cran/tidygraph/man/reexports.html>(name 
<https://rdrr.io/r/base/name.html>  =  letters <https://rdrr.io/r/base/Constants.html>[1:5])
gr2  <-  create_ring <https://rdrr.io/cran/tidygraph/man/create_graphs.html>(10)  %>%
   activate <https://rdrr.io/cran/tidygraph/man/activate.html>(nodes)  %>%
   mutate <https://rdrr.io/cran/tidygraph/man/reexports.html>(name 
<https://rdrr.io/r/base/name.html>  =  letters <https://rdrr.io/r/base/Constants.html>[4:13])

gr1  %>%  graph_join <https://rdrr.io/cran/tidygraph/man/graph_join.html>(gr2) 
when the merged graph is plotted with ggraph afterwards, I would like to 
identify the former graphs gr1 and gr2 by their node color, so that it 
is possible to see which node originates from which source. The result 
will be as follows: nodes a, b, c have i. e. color blue as they 
originate from gr1, nodes f, g, h, i, j, k, l, m have i. e. color red as 
they originate from gr2, nodes d, e either have color blue or color red 
(depending in which sequence the graphs are joined), or nodes d. e have 
a third color, i. e. green as the belong to both graphs How can this be 
done? Thanks in advance. Wolfgang Grond


	[[alternative HTML version deleted]]


From erodo|||| @end|ng |rom u||@edu  Mon Apr  5 21:46:14 2021
From: erodo|||| @end|ng |rom u||@edu (Rodofili, Esteban Nicolas)
Date: Mon, 5 Apr 2021 19:46:14 +0000
Subject: [R] Geolocating image frames automatically from an already
 georeferenced image
Message-ID: <BN6PR22MB0132FE03A080F1EDFA3B7FACA6779@BN6PR22MB0132.namprd22.prod.outlook.com>

Hi! I have drone footage on a still position I want to analyze as separate image frames in Google Earth Engine. Nothing was geolocated. I georeferenced an image frame with ground control points in Global Mapper. I am wondering if in R I could take the remaining image frames and automatically geolocate them using the georeferenced frame, without going one by one or using ground control points. The video is always still in the same position so what I need is to give the remaining image frames the same geolocation as the one I georeferenced with the ground control points. If not possible in R, I welcome other suggestions. Thanks.

Esteban N. Rodofili
Ph.D. Student - Interdisciplinary Ecology Program, SNRE
Lic. in Biology - Mgtr. in Public Policy
Marine Geomatics Lab
University of Florida
UF Climate Action Plan - Transportation Working Group
352-284-6828
erodofili at ufl.edu
https://www.thelecourslab.org/

I stand in solidarity with Graduate Assistants United and demand the University of Florida:
1.      Follow through with its agreement to pay certain fees on behalf of GAs as outlined in Article 10.6 of our Collective Bargaining Agreement.
2.      Discontinue all business relationships with Aramark due to their use of prison labor, and directly consult with the Food Justice League, Gator NAACP, Dream Defenders, and allied groups on the upcoming food service vendor contract to ensure racial equity.
3.      Immediately reverse its plan to demolish the Maguire and UVS Graduate Family Housing complexes.
4.      Immediately revoke its new furlough policy.



	[[alternative HTML version deleted]]


From bgunter@4567 @end|ng |rom gm@||@com  Mon Apr  5 23:25:03 2021
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Mon, 5 Apr 2021 14:25:03 -0700
Subject: [R] Geolocating image frames automatically from an already
 georeferenced image
In-Reply-To: <BN6PR22MB0132FE03A080F1EDFA3B7FACA6779@BN6PR22MB0132.namprd22.prod.outlook.com>
References: <BN6PR22MB0132FE03A080F1EDFA3B7FACA6779@BN6PR22MB0132.namprd22.prod.outlook.com>
Message-ID: <CAGxFJbRfdEofZecK3cbgG2tAzmzAOgq6SQNo9U14cM=tCeruWA@mail.gmail.com>

Your query is basically off topic on this list -- see the posting guide
linked below for what is on topic.

R has several "SIGs" where your query is more likely to fit. See here
https://www.r-project.org/mail.html for a list. I think either
r-sig-ecology  or r-sig-geo might be appropriate, but you decide. Post on
only one at a time and wait several days for a response before posting on
another (R netiquette).

Cheers,

Bert Gunter

"The trouble with having an open mind is that people keep coming along and
sticking things into it."
-- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )


On Mon, Apr 5, 2021 at 1:20 PM Rodofili, Esteban Nicolas <erodofili at ufl.edu>
wrote:

> Hi! I have drone footage on a still position I want to analyze as separate
> image frames in Google Earth Engine. Nothing was geolocated. I
> georeferenced an image frame with ground control points in Global Mapper. I
> am wondering if in R I could take the remaining image frames and
> automatically geolocate them using the georeferenced frame, without going
> one by one or using ground control points. The video is always still in the
> same position so what I need is to give the remaining image frames the same
> geolocation as the one I georeferenced with the ground control points. If
> not possible in R, I welcome other suggestions. Thanks.
>
> Esteban N. Rodofili
> Ph.D. Student - Interdisciplinary Ecology Program, SNRE
> Lic. in Biology - Mgtr. in Public Policy
> Marine Geomatics Lab
> University of Florida
> UF Climate Action Plan - Transportation Working Group
> 352-284-6828
> erodofili at ufl.edu
> https://www.thelecourslab.org/
>
> I stand in solidarity with Graduate Assistants United and demand the
> University of Florida:
> 1.      Follow through with its agreement to pay certain fees on behalf of
> GAs as outlined in Article 10.6 of our Collective Bargaining Agreement.
> 2.      Discontinue all business relationships with Aramark due to their
> use of prison labor, and directly consult with the Food Justice League,
> Gator NAACP, Dream Defenders, and allied groups on the upcoming food
> service vendor contract to ensure racial equity.
> 3.      Immediately reverse its plan to demolish the Maguire and UVS
> Graduate Family Housing complexes.
> 4.      Immediately revoke its new furlough policy.
>
>
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From j@ork|n @end|ng |rom @om@um@ry|@nd@edu  Tue Apr  6 05:28:29 2021
From: j@ork|n @end|ng |rom @om@um@ry|@nd@edu (Sorkin, John)
Date: Tue, 6 Apr 2021 03:28:29 +0000
Subject: [R] Contrasts in coxph
Message-ID: <MN2PR03MB51678A76DFF4A1CA8D7D8A03E2769@MN2PR03MB5167.namprd03.prod.outlook.com>

I would like to define contrasts on the output of a coxph function. It appears that the contrast function from the contrast library does not have a method defined that will allow computation of contrasts on a coxph object.

How does one define and evaluate contrasts for a cox model?

Thank you,
John

John David Sorkin M.D., Ph.D.
Professor of Medicine
Chief, Biostatistics and Informatics
University of Maryland School of Medicine Division of Gerontology and Geriatric Medicine
Baltimore VA Medical Center
10 North Greene Street
GRECC (BT/18/GR)
Baltimore, MD 21201-1524
(Phone) 410-605-7119
(Fax) 410-605-7913 (Please call phone number above prior to faxing)



From |r@|nj @end|ng |rom gm@||@com  Tue Apr  6 15:42:28 2021
From: |r@|nj @end|ng |rom gm@||@com (John C Frain)
Date: Tue, 6 Apr 2021 14:42:28 +0100
Subject: [R] Probit model- endogeneity issue
In-Reply-To: <PR2PR09MB316189FAAD84903158C44A69E9639@PR2PR09MB3161.eurprd09.prod.outlook.com>
References: <PR2PR09MB316189FAAD84903158C44A69E9639@PR2PR09MB3161.eurprd09.prod.outlook.com>
Message-ID: <CAHrK5149W8Dg7PqxaNGKdyN_g3HBDOW8HOGP4_J+1F5cGyY2AQ@mail.gmail.com>

On Wed 24 Mar 2021 at 07:54, hannelore nelissen <
hannelore.nelissen at outlook.be> wrote:

> Dear all,
> I am having some issues with using the IV strategy for an endogeneity
> problem in terms of a probit model.  In particular, I want to follow a
> two-stage procedure where I estimate a probit on the decision to peg the
> exchange rate, and then use the predicted values in the second stage
> regression. So, I need to get a probability that the country has a peg
> (estimated based on the Z variables). So, in the second stage, I have to
> include this estimated probability of the first stage (and exclude the Z
> variables that showed a significant effect). However, I do not know how to
> get this estimated probability of the first stage which I can then include
> in my second stage?
> Can somebody help me with the command I should use?
>
>
> I would really appreciate it, thanks Dear all,
>
>
> I find it a bit difficult to follow your question.  You might find

Lee (1981), Simultaneous Equation Models with discrete and censored
dependent variables, in Mansfield and McFadden (Ed?s), 346-364, MIT,
helpful in suggesting ways to proceed.

 Chapter 19 of Wooldridge :(2010), Econometric Analysis of Cross Section
and Panel Data, Princeton, may also be useful.

You might look at the r packages ivprobit and ivporbit






>
> Verzonden vanuit Mail<https://go.microsoft.com/fwlink/?LinkId=550986>
> voor Windows 10
>
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>
-- 
John C Frain
3 Aranleigh Park
Rathfarnham
Dublin 14
Ireland
www.tcd.ie/Economics/staff/frainj/home.html
mailto:frainj at tcd.ie
mailto:frainj at gmail.com

	[[alternative HTML version deleted]]


From gor@n@bro@trom @end|ng |rom umu@@e  Tue Apr  6 16:47:27 2021
From: gor@n@bro@trom @end|ng |rom umu@@e (=?UTF-8?Q?G=c3=b6ran_Brostr=c3=b6m?=)
Date: Tue, 6 Apr 2021 16:47:27 +0200
Subject: [R] Contrasts in coxph
In-Reply-To: <MN2PR03MB51678A76DFF4A1CA8D7D8A03E2769@MN2PR03MB5167.namprd03.prod.outlook.com>
References: <MN2PR03MB51678A76DFF4A1CA8D7D8A03E2769@MN2PR03MB5167.namprd03.prod.outlook.com>
Message-ID: <1413a992-f092-fc01-e450-94c03ac9e8cf@umu.se>

Dear John,

I googled "contrasts Cox regression" and found

https://stats.stackexchange.com/questions/15603/performing-contrasts-among-treatment-levels-in-survival-analysis

where Frank Harrell reports how to do what you want with his rms 
package. At least I think so, haven't tried it myself.

Best, G?ran

On 2021-04-06 05:28, Sorkin, John wrote:
> I would like to define contrasts on the output of a coxph function.
> It appears that the contrast function from the contrast library does
> not have a method defined that will allow computation of contrasts on
> a coxph object.
> 
> How does one define and evaluate contrasts for a cox model?
> 
> Thank you, John
> 
> John David Sorkin M.D., Ph.D. Professor of Medicine Chief,
> Biostatistics and Informatics University of Maryland School of
> Medicine Division of Gerontology and Geriatric Medicine Baltimore VA
> Medical Center 10 North Greene Street GRECC (BT/18/GR) Baltimore, MD
> 21201-1524 (Phone) 410-605-7119 (Fax) 410-605-7913 (Please call phone
> number above prior to faxing)
> 
> 
> ______________________________________________ R-help at r-project.org
> mailing list -- To UNSUBSCRIBE and more, see 
> https://stat.ethz.ch/mailman/listinfo/r-help PLEASE do read the
> posting guide http://www.R-project.org/posting-guide.html and provide
> commented, minimal, self-contained, reproducible code.
>


From j|ox @end|ng |rom mcm@@ter@c@  Tue Apr  6 19:13:24 2021
From: j|ox @end|ng |rom mcm@@ter@c@ (John Fox)
Date: Tue, 6 Apr 2021 13:13:24 -0400
Subject: [R] Contrasts in coxph
In-Reply-To: <24118_1617679737_1363Suiw018542_MN2PR03MB51678A76DFF4A1CA8D7D8A03E2769@MN2PR03MB5167.namprd03.prod.outlook.com>
References: <24118_1617679737_1363Suiw018542_MN2PR03MB51678A76DFF4A1CA8D7D8A03E2769@MN2PR03MB5167.namprd03.prod.outlook.com>
Message-ID: <04ed429b-e395-adb8-b643-de6df730d614@mcmaster.ca>

Dear John,

It's not clear to me exactly what you have in mind, but 
car::linearHypothesis(), multcomp::glht(), and the emmeans package work 
with Cox models. I expect there are functions in other packages that 
will work too.

Here's an example, surely simpler than what you have in mind, but you 
can probably adapt it:

------------------ snip -----------------

 > library("survival")
 > library("car")
Loading required package: carData
 > mod.allison <- coxph(Surv(week, arrest) ~
+                        fin + age + race + wexp + mar + paro + prio,
+                      data=Rossi)
 > mod.allison
Call:
coxph(formula = Surv(week, arrest) ~ fin + age + race + wexp +
     mar + paro + prio, data = Rossi)

                    coef exp(coef) se(coef)      z       p
finyes         -0.37942   0.68426  0.19138 -1.983 0.04742
age            -0.05744   0.94418  0.02200 -2.611 0.00903
raceother      -0.31390   0.73059  0.30799 -1.019 0.30812
wexpyes        -0.14980   0.86088  0.21222 -0.706 0.48029
marnot married  0.43370   1.54296  0.38187  1.136 0.25606
paroyes        -0.08487   0.91863  0.19576 -0.434 0.66461
prio            0.09150   1.09581  0.02865  3.194 0.00140

Likelihood ratio test=33.27  on 7 df, p=2.362e-05
n= 432, number of events= 114
 >
 > linearHypothesis(mod.allison, "finyes")
Linear hypothesis test

Hypothesis:
finyes = 0

Model 1: restricted model
Model 2: Surv(week, arrest) ~ fin + age + race + wexp + mar + paro + prio

   Res.Df Df  Chisq Pr(>Chisq)
1    426
2    425  1 3.9306    0.04742 *
---
Signif. codes:  0 ?***? 0.001 ?**? 0.01 ?*? 0.05 ?.? 0.1 ? ? 1
 >
 > library("multcomp")
Loading required package: mvtnorm
Loading required package: TH.data
Loading required package: MASS

Attaching package: ?TH.data?

The following object is masked from ?package:MASS?:

     geyser

 > summary(glht(mod.allison, "finyes=0"))

	 Simultaneous Tests for General Linear Hypotheses

Fit: coxph(formula = Surv(week, arrest) ~ fin + age + race + wexp +
     mar + paro + prio, data = Rossi)

Linear Hypotheses:
             Estimate Std. Error z value Pr(>|z|)
finyes == 0  -0.3794     0.1914  -1.983   0.0474 *
---
Signif. codes:  0 ?***? 0.001 ?**? 0.01 ?*? 0.05 ?.? 0.1 ? ? 1
(Adjusted p values reported -- single-step method)

 >
 > library(emmeans)
 > pairs(emmeans(mod.allison, ~ fin))
  contrast estimate    SE  df z.ratio p.value
  no - yes    0.379 0.191 Inf 1.983   0.0474

------------------ snip -----------------

Results are averaged over the levels of: race, wexp, mar, paro
Results are given on the log (not the response) scale.

John Fox, Professor Emeritus
McMaster University
Hamilton, Ontario, Canada
web: https://socialsciences.mcmaster.ca/jfox/

On 2021-04-05 11:28 p.m., Sorkin, John wrote:
> I would like to define contrasts on the output of a coxph function. It appears that the contrast function from the contrast library does not have a method defined that will allow computation of contrasts on a coxph object.
> 
> How does one define and evaluate contrasts for a cox model?
> 
> Thank you,
> John
> 
> John David Sorkin M.D., Ph.D.
> Professor of Medicine
> Chief, Biostatistics and Informatics
> University of Maryland School of Medicine Division of Gerontology and Geriatric Medicine
> Baltimore VA Medical Center
> 10 North Greene Street
> GRECC (BT/18/GR)
> Baltimore, MD 21201-1524
> (Phone) 410-605-7119
> (Fax) 410-605-7913 (Please call phone number above prior to faxing)
> 
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>


From dw|n@em|u@ @end|ng |rom comc@@t@net  Wed Apr  7 03:01:07 2021
From: dw|n@em|u@ @end|ng |rom comc@@t@net (David Winsemius)
Date: Tue, 6 Apr 2021 18:01:07 -0700
Subject: [R] Contrasts in coxph
In-Reply-To: <MN2PR03MB51678A76DFF4A1CA8D7D8A03E2769@MN2PR03MB5167.namprd03.prod.outlook.com>
References: <MN2PR03MB51678A76DFF4A1CA8D7D8A03E2769@MN2PR03MB5167.namprd03.prod.outlook.com>
Message-ID: <3676aa83-4230-cd1d-d5c7-05e09c43ef66@comcast.net>


On 4/5/21 8:28 PM, Sorkin, John wrote:
> I would like to define contrasts on the output of a coxph function. It appears that the contrast function from the contrast library does not have a method defined that will allow computation of contrasts on a coxph object.
>
> How does one define and evaluate contrasts for a cox model?


I suspect that you are hoping for post-hoc pairwise contrasts. If that's 
the case, then the multcomp package's glht is generally very capable. It 
has three examples in its vignette the involve survivla models. The last 
one constructs a categorical variable for age. That's not a procedure 
that I endorse, but it may have been done for illustration of a method 
and would therefore be free of sin.


library(multcomp)? # console output follows

 > if (require("survival") && require("MASS")) {
+???? ### construct 4 classes of age
+???? Melanoma$Cage <- factor(sapply(Melanoma$age, function(x){if( x <= 
25 ) return(1)
+???????? if( x > 25 & x <= 50 ) return(2)
+???????? if( x > 50 & x <= 75 ) return(3)
+???????? if( x > 75 & x <= 100) return(4) }
+???? ))
+ }
 > summary(Melanoma)
 ????? time????????? status????????? sex age???????????? year??????? 
thickness
 ?Min.?? :? 10?? Min.?? :1.00?? Min.?? :0.0000?? Min.?? : 4.00 Min.?? 
:1962?? Min.?? : 0.10
 ?1st Qu.:1525?? 1st Qu.:1.00?? 1st Qu.:0.0000?? 1st Qu.:42.00 1st 
Qu.:1968?? 1st Qu.: 0.97
 ?Median :2005?? Median :2.00?? Median :0.0000?? Median :54.00 Median 
:1970?? Median : 1.94
 ?Mean?? :2153?? Mean?? :1.79?? Mean?? :0.3854?? Mean?? :52.46 Mean?? 
:1970?? Mean?? : 2.92
 ?3rd Qu.:3042?? 3rd Qu.:2.00?? 3rd Qu.:1.0000?? 3rd Qu.:65.00 3rd 
Qu.:1972?? 3rd Qu.: 3.56
 ?Max.?? :5565?? Max.?? :3.00?? Max.?? :1.0000?? Max.?? :95.00 Max.?? 
:1977?? Max.?? :17.42
 ???? ulcer?????? Cage
 ?Min.?? :0.000?? 1: 14
 ?1st Qu.:0.000?? 2: 73
 ?Median :0.000?? 3:104
 ?Mean?? :0.439?? 4: 14
 ?3rd Qu.:1.000
 ?Max.?? :1.000
 > cm <- coxph(Surv(time, status == 1) ~ Cage, data = Melanoma)
 > ### specify all pair-wise comparisons among levels of "Cage"
 > cm.glht <- glht(cm, mcp(Cage = "Tukey"))
 > cm.glht

 ??? ?General Linear Hypotheses

Multiple Comparisons of Means: Tukey Contrasts


Linear Hypotheses:
 ?????????? Estimate
2 - 1 == 0? -0.2889
3 - 1 == 0?? 0.1910
4 - 1 == 0?? 1.0742
3 - 2 == 0?? 0.4800
4 - 2 == 0?? 1.3631
4 - 3 == 0?? 0.8832


-- 

David.

>
> Thank you,
> John
>
> John David Sorkin M.D., Ph.D.
> Professor of Medicine
> Chief, Biostatistics and Informatics
> University of Maryland School of Medicine Division of Gerontology and Geriatric Medicine
> Baltimore VA Medical Center
> 10 North Greene Street
> GRECC (BT/18/GR)
> Baltimore, MD 21201-1524
> (Phone) 410-605-7119
> (Fax) 410-605-7913 (Please call phone number above prior to faxing)
>
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From @@h|mk@poor @end|ng |rom gm@||@com  Wed Apr  7 07:05:14 2021
From: @@h|mk@poor @end|ng |rom gm@||@com (Ashim Kapoor)
Date: Wed, 7 Apr 2021 10:35:14 +0530
Subject: [R] R does not start from (Debian) linux command line - error with
 doWithOneRestart() - segmentation fault
Message-ID: <CAC8=1eoxsgbi7fc=hPXEp+HsfPwWYvMPdV9CNT+bxyb+wPAruQ@mail.gmail.com>

Dear R experts,

Here is my problem :

R startup FAILS with an error message. The error message is more
meaningful when I do invoke R via sudo OR as root. I attach the
startup messages when I invoke R as :

1. as non root user
2. with sudo
3. as Root user.

The error messages ( mentioned in snippets below ) are more meaningful
to me in the above mentioned order.

When I google around for the error message, it looks like there is an
.xlsx file which has non english characters which is messing with
Java.

I do not know how to fix this. I tried :-

R --vanilla

so that it would not use any startup scripts but that also does not work.

----------------- snip
----------------------------------------------------------------------------------------------------------------------------

When I try to start R from the command line :

~$ R

 *** caught segfault ***
address (nil), cause 'unknown'

Traceback:
 1: NextMethod(.Generic)
 2: Ops.numeric_version(R_version_built_under, "3.0.0")
 3: testRversion(pkgInfo, package, pkgpath)
 4: library(package, lib.loc = lib.loc, character.only = TRUE,
logical.return = TRUE,     warn.conflicts = warn.conflicts, quietly =
quietly, mask.ok = mask.ok,     exclude = exclude, include.only =
include.only, attach.required = attach.required)
 5: doTryCatch(return(expr), name, parentenv, handler)
 6: tryCatchOne(expr, names, parentenv, handlers[[1L]])
 7: tryCatchList(expr, classes, parentenv, handlers)
 8: tryCatch(library(package, lib.loc = lib.loc, character.only =
TRUE,     logical.return = TRUE, warn.conflicts = warn.conflicts,
quietly = quietly,     mask.ok = mask.ok, exclude = exclude,
include.only = include.only,     attach.required = attach.required),
error = function(e) e)
 9: require(pkg, quietly = TRUE, warn.conflicts = FALSE, character.only = TRUE)
10: .OptRequireMethods()

Possible actions:
1: abort (with core dump, if enabled)
2: normal R exit
3: exit R without saving workspace
4: exit R saving workspace
Selection: Segmentation fault

----------------- snip
----------------------------------------------------------------------------------------------------------------------------
When I try to start R with sudo it gives a more clear message :-

~$ sudo R

 *** caught segfault ***
address (nil), cause 'unknown'

Traceback:
 1: NextMethod(.Generic)
 2: Ops.numeric_version(R_version_built_under, "3.0.0")
 3: testRversion(pkgInfo, package, pkgpath)
 4: library(package, lib.loc = lib.loc, character.only = TRUE,
logical.return = TRUE,     warn.conflicts = warn.conflicts, quietly =
quietly, mask.ok = mask.ok,     exclude = exclude, include.only =
include.only, attach.required = attach.required)
 5: doTryCatch(return(expr), name, parentenv, handler)
 6: tryCatchOne(expr, names, parentenv, handlers[[1L]])
 7: tryCatchList(expr, classes, parentenv, handlers)
 8: tryCatch(library(package, lib.loc = lib.loc, character.only =
TRUE,     logical.return = TRUE, warn.conflicts = warn.conflicts,
quietly = quietly,     mask.ok = mask.ok, exclude = exclude,
include.only = include.only,     attach.required = attach.required),
error = function(e) e)
 9: require(pkg, quietly = TRUE, warn.conflicts = FALSE, character.only = TRUE)
10: .OptRequireMethods()

Possible actions:
1: abort (with core dump, if enabled)
2: normal R exit
3: exit R without saving workspace
4: exit R saving workspace
Selection: Error in doWithOneRestart(return(` \\x82\\x0ccPV`), restart) :
  not a proper file name

R version 3.6.3 (2020-02-29) -- "Holding the Windsock"
Copyright (C) 2020 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

Error: not a proper file name
Error in doWithOneRestart(return(` \\x82\\x0ccPV`), restart) :
  promise already under evaluation: recursive default argument
reference or earlier problems?
Segmentation fault

----------------- snip
----------------------------------------------------------------------------------------------------------------------------

Invoking R as a root user :-

$ sudo -i
root at crayshrimp ~ # R

 *** caught segfault ***
address (nil), cause 'unknown'

Traceback:
 1: NextMethod(.Generic)
 2: Ops.numeric_version(R_version_built_under, "3.0.0")
 3: testRversion(pkgInfo, package, pkgpath)
 4: library(package, lib.loc = lib.loc, character.only = TRUE,
logical.return = TRUE,     warn.conflicts = warn.conflicts, quietly =
quietly, mask.ok = mask.ok,     exclude = exclude, include.only =
include.only, attach.required = attach.required)
 5: doTryCatch(return(expr), name, parentenv, handler)
 6: tryCatchOne(expr, names, parentenv, handlers[[1L]])
 7: tryCatchList(expr, classes, parentenv, handlers)
 8: tryCatch(library(package, lib.loc = lib.loc, character.only =
TRUE,     logical.return = TRUE, warn.conflicts = warn.conflicts,
quietly = quietly,     mask.ok = mask.ok, exclude = exclude,
include.only = include.only,     attach.required = attach.required),
error = function(e) e)
 9: require(pkg, quietly = TRUE, warn.conflicts = FALSE, character.only = TRUE)
10: .OptRequireMethods()

Possible actions:
1: abort (with core dump, if enabled)
2: normal R exit
3: exit R without saving workspace
4: exit R saving workspace
Selection: Error in doWithOneRestart(return(), restart) : not a proper file name

R version 3.6.3 (2020-02-29) -- "Holding the Windsock"
Copyright (C) 2020 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

Error: not a proper file name
Error in doWithOneRestart(return(), restart) :
  promise already under evaluation: recursive default argument
reference or earlier problems?
Error in tryCatchOne(, names, parentenv, handlers[[1L]]) :
  promise already under evaluation: recursive default argument
reference or earlier problems?
Error: not a proper file name
Fatal error: unable to initialize the JIT

----------------- snip
----------------------------------------------------------------------------------------------------------------------------

Thank you,
Ashim


From m@ech|er @end|ng |rom @t@t@m@th@ethz@ch  Wed Apr  7 09:21:37 2021
From: m@ech|er @end|ng |rom @t@t@m@th@ethz@ch (Martin Maechler)
Date: Wed, 7 Apr 2021 09:21:37 +0200
Subject: [R] 
 R does not start from (Debian) linux command line - error with
 doWithOneRestart() - segmentation fault
In-Reply-To: <CAC8=1eoxsgbi7fc=hPXEp+HsfPwWYvMPdV9CNT+bxyb+wPAruQ@mail.gmail.com>
References: <CAC8=1eoxsgbi7fc=hPXEp+HsfPwWYvMPdV9CNT+bxyb+wPAruQ@mail.gmail.com>
Message-ID: <24685.23937.706650.276577@stat.math.ethz.ch>

>>>>> Ashim Kapoor 
>>>>>     on Wed, 7 Apr 2021 10:35:14 +0530 writes:

    > Dear R experts,

    > Here is my problem :

    > R startup FAILS with an error message. The error message
    > is more meaningful when I do invoke R via sudo OR as
    > root. I attach the startup messages when I invoke R as :

    > 1. as non root user 2. with sudo 3. as Root user.

    > The error messages ( mentioned in snippets below ) are
    > more meaningful to me in the above mentioned order.

Thank you, Ashim.

Yes, the messages point to something really bad.

OTOH ("On the other hand"), what we *can* see is that you try to
start R version 3.6.3.

While that is not extremely old, it may well be older than
several other pieces of software (or even hardware) that you are
running with.

I very very  *strongly* recommend to use an R version 4.0.x ... and why not
use the latest  4.0.5 ?

Then, it may also be caused by a mismatch of system libraries
and your oldish version of R. ... but there I'd strongly
recommend consulting with other Debian users, notably as there
is a dedicated  mailing list  R-SIG-Debian --> do subscribe
there, and ask -- with more details on how you got your R: Is it
the default R on your Debian, which version of Debian,  etc.

Last but not least, Dirk Eddelbuettel, the maintainer of the
official R Debian package maintains a nice web page -- part of
the official CRAN web pages, but unfortunately a bit hidden
nowadays, (not the least because CRAN still uses frames (w?rg!!)):

  https://cloud.r-project.org/bin/linux/debian/

A very nice and useful page,  much underrated and underused,
probably.

Best regards,

Martin Maechler
ETH Zurich  and  R Core Team


    > When I google around for the error message, it looks like
    > there is an .xlsx file which has non english characters
    > which is messing with Java.

    > I do not know how to fix this. I tried :-

    > R --vanilla

    > so that it would not use any startup scripts but that also
    > does not work.

    > ----------------- snip
    > ----------------------------------------------------------------------------------------------------------------------------

    > When I try to start R from the command line :

    > ~$ R

    >  *** caught segfault *** address (nil), cause 'unknown'

    > Traceback: 1: NextMethod(.Generic) 2:
    > Ops.numeric_version(R_version_built_under, "3.0.0") 3:
    > testRversion(pkgInfo, package, pkgpath) 4:
    > library(package, lib.loc = lib.loc, character.only = TRUE,
    > logical.return = TRUE, warn.conflicts = warn.conflicts,
    > quietly = quietly, mask.ok = mask.ok, exclude = exclude,
    > include.only = include.only, attach.required =
    > attach.required) 5: doTryCatch(return(expr), name,
    > parentenv, handler) 6: tryCatchOne(expr, names, parentenv,
    > handlers[[1L]]) 7: tryCatchList(expr, classes, parentenv,
    > handlers) 8: tryCatch(library(package, lib.loc = lib.loc,
    > character.only = TRUE, logical.return = TRUE,
    > warn.conflicts = warn.conflicts, quietly = quietly,
    > mask.ok = mask.ok, exclude = exclude, include.only =
    > include.only, attach.required = attach.required), error =
    > function(e) e) 9: require(pkg, quietly = TRUE,
    > warn.conflicts = FALSE, character.only = TRUE) 10:
    > .OptRequireMethods()

    > Possible actions: 1: abort (with core dump, if enabled) 2:
    > normal R exit 3: exit R without saving workspace 4: exit R
    > saving workspace Selection: Segmentation fault

    > ----------------- snip
    > ----------------------------------------------------------------------------------------------------------------------------
    > When I try to start R with sudo it gives a more clear
    > message :-

    > ~$ sudo R

    >  *** caught segfault *** address (nil), cause 'unknown'

    > Traceback: 1: NextMethod(.Generic) 2:
    > Ops.numeric_version(R_version_built_under, "3.0.0") 3:
    > testRversion(pkgInfo, package, pkgpath) 4:
    > library(package, lib.loc = lib.loc, character.only = TRUE,
    > logical.return = TRUE, warn.conflicts = warn.conflicts,
    > quietly = quietly, mask.ok = mask.ok, exclude = exclude,
    > include.only = include.only, attach.required =
    > attach.required) 5: doTryCatch(return(expr), name,
    > parentenv, handler) 6: tryCatchOne(expr, names, parentenv,
    > handlers[[1L]]) 7: tryCatchList(expr, classes, parentenv,
    > handlers) 8: tryCatch(library(package, lib.loc = lib.loc,
    > character.only = TRUE, logical.return = TRUE,
    > warn.conflicts = warn.conflicts, quietly = quietly,
    > mask.ok = mask.ok, exclude = exclude, include.only =
    > include.only, attach.required = attach.required), error =
    > function(e) e) 9: require(pkg, quietly = TRUE,
    > warn.conflicts = FALSE, character.only = TRUE) 10:
    > .OptRequireMethods()

    > Possible actions: 1: abort (with core dump, if enabled) 2:
    > normal R exit 3: exit R without saving workspace 4: exit R
    > saving workspace Selection: Error in
    > doWithOneRestart(return(` \\x82\\x0ccPV`), restart) : not
    > a proper file name

    > R version 3.6.3 (2020-02-29) -- "Holding the Windsock"
    > Copyright (C) 2020 The R Foundation for Statistical
    > Computing Platform: x86_64-pc-linux-gnu (64-bit)

    > R is free software and comes with ABSOLUTELY NO WARRANTY.
    > You are welcome to redistribute it under certain
    > conditions.  Type 'license()' or 'licence()' for
    > distribution details.

    >   Natural language support but running in an English
    > locale

    > R is a collaborative project with many contributors.  Type
    > 'contributors()' for more information and 'citation()' on
    > how to cite R or R packages in publications.

    > Type 'demo()' for some demos, 'help()' for on-line help,
    > or 'help.start()' for an HTML browser interface to help.
    > Type 'q()' to quit R.

    > Error: not a proper file name Error in
    > doWithOneRestart(return(` \\x82\\x0ccPV`), restart) :
    > promise already under evaluation: recursive default
    > argument reference or earlier problems?  Segmentation
    > fault

    > ----------------- snip
    > ----------------------------------------------------------------------------------------------------------------------------

    > Invoking R as a root user :-

    > $ sudo -i root at crayshrimp ~ # R

    >  *** caught segfault *** address (nil), cause 'unknown'

    > Traceback: 1: NextMethod(.Generic) 2:
    > Ops.numeric_version(R_version_built_under, "3.0.0") 3:
    > testRversion(pkgInfo, package, pkgpath) 4:
    > library(package, lib.loc = lib.loc, character.only = TRUE,
    > logical.return = TRUE, warn.conflicts = warn.conflicts,
    > quietly = quietly, mask.ok = mask.ok, exclude = exclude,
    > include.only = include.only, attach.required =
    > attach.required) 5: doTryCatch(return(expr), name,
    > parentenv, handler) 6: tryCatchOne(expr, names, parentenv,
    > handlers[[1L]]) 7: tryCatchList(expr, classes, parentenv,
    > handlers) 8: tryCatch(library(package, lib.loc = lib.loc,
    > character.only = TRUE, logical.return = TRUE,
    > warn.conflicts = warn.conflicts, quietly = quietly,
    > mask.ok = mask.ok, exclude = exclude, include.only =
    > include.only, attach.required = attach.required), error =
    > function(e) e) 9: require(pkg, quietly = TRUE,
    > warn.conflicts = FALSE, character.only = TRUE) 10:
    > .OptRequireMethods()

    > Possible actions: 1: abort (with core dump, if enabled) 2:
    > normal R exit 3: exit R without saving workspace 4: exit R
    > saving workspace Selection: Error in
    > doWithOneRestart(return(), restart) : not a proper file
    > name

    > R version 3.6.3 (2020-02-29) -- "Holding the Windsock"
    > Copyright (C) 2020 The R Foundation for Statistical
    > Computing Platform: x86_64-pc-linux-gnu (64-bit)

    > R is free software and comes with ABSOLUTELY NO WARRANTY.
    > You are welcome to redistribute it under certain
    > conditions.  Type 'license()' or 'licence()' for
    > distribution details.

    >   Natural language support but running in an English
    > locale

    > R is a collaborative project with many contributors.  Type
    > 'contributors()' for more information and 'citation()' on
    > how to cite R or R packages in publications.

    > Type 'demo()' for some demos, 'help()' for on-line help,
    > or 'help.start()' for an HTML browser interface to help.
    > Type 'q()' to quit R.

    > Error: not a proper file name Error in
    > doWithOneRestart(return(), restart) : promise already
    > under evaluation: recursive default argument reference or
    > earlier problems?  Error in tryCatchOne(, names,
    > parentenv, handlers[[1L]]) : promise already under
    > evaluation: recursive default argument reference or
    > earlier problems?  Error: not a proper file name Fatal
    > error: unable to initialize the JIT

    > ----------------- snip
    > ----------------------------------------------------------------------------------------------------------------------------

    > Thank you, Ashim

    > ______________________________________________
    > R-help at r-project.org mailing list -- To UNSUBSCRIBE and
    > more, see https://stat.ethz.ch/mailman/listinfo/r-help
    > PLEASE do read the posting guide
    > http://www.R-project.org/posting-guide.html and provide
    > commented, minimal, self-contained, reproducible code.


From @@h|mk@poor @end|ng |rom gm@||@com  Wed Apr  7 10:16:46 2021
From: @@h|mk@poor @end|ng |rom gm@||@com (Ashim Kapoor)
Date: Wed, 7 Apr 2021 13:46:46 +0530
Subject: [R] 
 R does not start from (Debian) linux command line - error with
 doWithOneRestart() - segmentation fault
In-Reply-To: <24685.23937.706650.276577@stat.math.ethz.ch>
References: <CAC8=1eoxsgbi7fc=hPXEp+HsfPwWYvMPdV9CNT+bxyb+wPAruQ@mail.gmail.com>
 <24685.23937.706650.276577@stat.math.ethz.ch>
Message-ID: <CAC8=1eqGH_edCisjEF6Me_h9EvMnriEihWUoYkaAcORy+oLJRw@mail.gmail.com>

On Wed, Apr 7, 2021 at 12:51 PM Martin Maechler
<maechler at stat.math.ethz.ch> wrote:
>
> >>>>> Ashim Kapoor
> >>>>>     on Wed, 7 Apr 2021 10:35:14 +0530 writes:
>
>     > Dear R experts,
>
>     > Here is my problem :
>
>     > R startup FAILS with an error message. The error message
>     > is more meaningful when I do invoke R via sudo OR as
>     > root. I attach the startup messages when I invoke R as :
>
>     > 1. as non root user 2. with sudo 3. as Root user.
>
>     > The error messages ( mentioned in snippets below ) are
>     > more meaningful to me in the above mentioned order.
>
> Thank you, Ashim.
>
> Yes, the messages point to something really bad.
>
> OTOH ("On the other hand"), what we *can* see is that you try to
> start R version 3.6.3.
>

My apologies for not being clear.

I would like to clarify :

1. The error message from the incantation `R` is not very informative.

2. The error message from the incantation `sudo R` says (among other
things which don't seem significant to me):
Error in doWithOneRestart(return(` \\x82\\x0ccPV`), restart) :
  not a proper file name

3. The error message from invoking R as a root user says:

Error: not a proper file name
Fatal error: unable to initialize the JIT

I found this on the internet :
https://stackoverflow.com/questions/19512165/error-in-dowithonerestart

The error messages and the above link point to issues with JAVA, but
it does not say how to fix them.

That is why I thought : there is an .xlsx file which has non english
characters which is messing with
Java.

Query : is there a way to do JAVA garbage collection when R is not starting ?

> While that is not extremely old, it may well be older than
> several other pieces of software (or even hardware) that you are
> running with.
>
> I very very  *strongly* recommend to use an R version 4.0.x ... and why not
> use the latest  4.0.5 ?
>

We upgraded to 4.0.5 but it did not make a difference. We restarted
the computer and that fixed the error.
I think the JAVA garbage collection kicked in when we reset the
computer and that is why it was fixed on rebooting. Not sure though.

> Then, it may also be caused by a mismatch of system libraries
> and your oldish version of R. ... but there I'd strongly
> recommend consulting with other Debian users, notably as there
> is a dedicated  mailing list  R-SIG-Debian --> do subscribe
> there, and ask -- with more details on how you got your R: Is it
> the default R on your Debian, which version of Debian,  etc.
>
> Last but not least, Dirk Eddelbuettel, the maintainer of the
> official R Debian package maintains a nice web page -- part of
> the official CRAN web pages, but unfortunately a bit hidden
> nowadays, (not the least because CRAN still uses frames (w?rg!!)):
>
>   https://cloud.r-project.org/bin/linux/debian/
>
> A very nice and useful page,  much underrated and underused,
> probably.
>

Thank you for this.

> Best regards,
>
> Martin Maechler
> ETH Zurich  and  R Core Team
>
>
>     > When I google around for the error message, it looks like
>     > there is an .xlsx file which has non english characters
>     > which is messing with Java.
>
>     > I do not know how to fix this. I tried :-
>
>     > R --vanilla
>
>     > so that it would not use any startup scripts but that also
>     > does not work.
>
>     > ----------------- snip
>     > ----------------------------------------------------------------------------------------------------------------------------
>
>     > When I try to start R from the command line :
>
>     > ~$ R
>
>     >  *** caught segfault *** address (nil), cause 'unknown'
>
>     > Traceback: 1: NextMethod(.Generic) 2:
>     > Ops.numeric_version(R_version_built_under, "3.0.0") 3:
>     > testRversion(pkgInfo, package, pkgpath) 4:
>     > library(package, lib.loc = lib.loc, character.only = TRUE,
>     > logical.return = TRUE, warn.conflicts = warn.conflicts,
>     > quietly = quietly, mask.ok = mask.ok, exclude = exclude,
>     > include.only = include.only, attach.required =
>     > attach.required) 5: doTryCatch(return(expr), name,
>     > parentenv, handler) 6: tryCatchOne(expr, names, parentenv,
>     > handlers[[1L]]) 7: tryCatchList(expr, classes, parentenv,
>     > handlers) 8: tryCatch(library(package, lib.loc = lib.loc,
>     > character.only = TRUE, logical.return = TRUE,
>     > warn.conflicts = warn.conflicts, quietly = quietly,
>     > mask.ok = mask.ok, exclude = exclude, include.only =
>     > include.only, attach.required = attach.required), error =
>     > function(e) e) 9: require(pkg, quietly = TRUE,
>     > warn.conflicts = FALSE, character.only = TRUE) 10:
>     > .OptRequireMethods()
>
>     > Possible actions: 1: abort (with core dump, if enabled) 2:
>     > normal R exit 3: exit R without saving workspace 4: exit R
>     > saving workspace Selection: Segmentation fault
>
>     > ----------------- snip
>     > ----------------------------------------------------------------------------------------------------------------------------
>     > When I try to start R with sudo it gives a more clear
>     > message :-
>
>     > ~$ sudo R
>
>     >  *** caught segfault *** address (nil), cause 'unknown'
>
>     > Traceback: 1: NextMethod(.Generic) 2:
>     > Ops.numeric_version(R_version_built_under, "3.0.0") 3:
>     > testRversion(pkgInfo, package, pkgpath) 4:
>     > library(package, lib.loc = lib.loc, character.only = TRUE,
>     > logical.return = TRUE, warn.conflicts = warn.conflicts,
>     > quietly = quietly, mask.ok = mask.ok, exclude = exclude,
>     > include.only = include.only, attach.required =
>     > attach.required) 5: doTryCatch(return(expr), name,
>     > parentenv, handler) 6: tryCatchOne(expr, names, parentenv,
>     > handlers[[1L]]) 7: tryCatchList(expr, classes, parentenv,
>     > handlers) 8: tryCatch(library(package, lib.loc = lib.loc,
>     > character.only = TRUE, logical.return = TRUE,
>     > warn.conflicts = warn.conflicts, quietly = quietly,
>     > mask.ok = mask.ok, exclude = exclude, include.only =
>     > include.only, attach.required = attach.required), error =
>     > function(e) e) 9: require(pkg, quietly = TRUE,
>     > warn.conflicts = FALSE, character.only = TRUE) 10:
>     > .OptRequireMethods()
>
>     > Possible actions: 1: abort (with core dump, if enabled) 2:
>     > normal R exit 3: exit R without saving workspace 4: exit R
>     > saving workspace Selection: Error in
>     > doWithOneRestart(return(` \\x82\\x0ccPV`), restart) : not
>     > a proper file name
>
>     > R version 3.6.3 (2020-02-29) -- "Holding the Windsock"
>     > Copyright (C) 2020 The R Foundation for Statistical
>     > Computing Platform: x86_64-pc-linux-gnu (64-bit)
>
>     > R is free software and comes with ABSOLUTELY NO WARRANTY.
>     > You are welcome to redistribute it under certain
>     > conditions.  Type 'license()' or 'licence()' for
>     > distribution details.
>
>     >   Natural language support but running in an English
>     > locale
>
>     > R is a collaborative project with many contributors.  Type
>     > 'contributors()' for more information and 'citation()' on
>     > how to cite R or R packages in publications.
>
>     > Type 'demo()' for some demos, 'help()' for on-line help,
>     > or 'help.start()' for an HTML browser interface to help.
>     > Type 'q()' to quit R.
>
>     > Error: not a proper file name Error in
>     > doWithOneRestart(return(` \\x82\\x0ccPV`), restart) :
>     > promise already under evaluation: recursive default
>     > argument reference or earlier problems?  Segmentation
>     > fault
>
>     > ----------------- snip
>     > ----------------------------------------------------------------------------------------------------------------------------
>
>     > Invoking R as a root user :-
>
>     > $ sudo -i root at crayshrimp ~ # R
>
>     >  *** caught segfault *** address (nil), cause 'unknown'
>
>     > Traceback: 1: NextMethod(.Generic) 2:
>     > Ops.numeric_version(R_version_built_under, "3.0.0") 3:
>     > testRversion(pkgInfo, package, pkgpath) 4:
>     > library(package, lib.loc = lib.loc, character.only = TRUE,
>     > logical.return = TRUE, warn.conflicts = warn.conflicts,
>     > quietly = quietly, mask.ok = mask.ok, exclude = exclude,
>     > include.only = include.only, attach.required =
>     > attach.required) 5: doTryCatch(return(expr), name,
>     > parentenv, handler) 6: tryCatchOne(expr, names, parentenv,
>     > handlers[[1L]]) 7: tryCatchList(expr, classes, parentenv,
>     > handlers) 8: tryCatch(library(package, lib.loc = lib.loc,
>     > character.only = TRUE, logical.return = TRUE,
>     > warn.conflicts = warn.conflicts, quietly = quietly,
>     > mask.ok = mask.ok, exclude = exclude, include.only =
>     > include.only, attach.required = attach.required), error =
>     > function(e) e) 9: require(pkg, quietly = TRUE,
>     > warn.conflicts = FALSE, character.only = TRUE) 10:
>     > .OptRequireMethods()
>
>     > Possible actions: 1: abort (with core dump, if enabled) 2:
>     > normal R exit 3: exit R without saving workspace 4: exit R
>     > saving workspace Selection: Error in
>     > doWithOneRestart(return(), restart) : not a proper file
>     > name
>
>     > R version 3.6.3 (2020-02-29) -- "Holding the Windsock"
>     > Copyright (C) 2020 The R Foundation for Statistical
>     > Computing Platform: x86_64-pc-linux-gnu (64-bit)
>
>     > R is free software and comes with ABSOLUTELY NO WARRANTY.
>     > You are welcome to redistribute it under certain
>     > conditions.  Type 'license()' or 'licence()' for
>     > distribution details.
>
>     >   Natural language support but running in an English
>     > locale
>
>     > R is a collaborative project with many contributors.  Type
>     > 'contributors()' for more information and 'citation()' on
>     > how to cite R or R packages in publications.
>
>     > Type 'demo()' for some demos, 'help()' for on-line help,
>     > or 'help.start()' for an HTML browser interface to help.
>     > Type 'q()' to quit R.
>
>     > Error: not a proper file name Error in
>     > doWithOneRestart(return(), restart) : promise already
>     > under evaluation: recursive default argument reference or
>     > earlier problems?  Error in tryCatchOne(, names,
>     > parentenv, handlers[[1L]]) : promise already under
>     > evaluation: recursive default argument reference or
>     > earlier problems?  Error: not a proper file name Fatal
>     > error: unable to initialize the JIT
>
>     > ----------------- snip
>     > ----------------------------------------------------------------------------------------------------------------------------
>
>     > Thank you, Ashim
>
>     > ______________________________________________
>     > R-help at r-project.org mailing list -- To UNSUBSCRIBE and
>     > more, see https://stat.ethz.ch/mailman/listinfo/r-help
>     > PLEASE do read the posting guide
>     > http://www.R-project.org/posting-guide.html and provide
>     > commented, minimal, self-contained, reproducible code.


From tmreg@06 @end|ng |rom gm@||@com  Wed Apr  7 20:49:38 2021
From: tmreg@06 @end|ng |rom gm@||@com (Tammy Regalado)
Date: Wed, 7 Apr 2021 14:49:38 -0400
Subject: [R] R Language on Windows 2019
Message-ID: <F75E6CD0-F610-4B24-BC3F-9F194148EF29@gmail.com>


What versions of Windows can R Language be installed on?  Specifically, is Windows Server 2019 a supported platform?

From g|eyne@ @end|ng |rom gm@||@com  Wed Apr  7 21:40:04 2021
From: g|eyne@ @end|ng |rom gm@||@com (Gene Leynes)
Date: Wed, 7 Apr 2021 14:40:04 -0500
Subject: [R] /usr/local/lib/R/site-library is not writable
Message-ID: <CAOBARVhbjxO04FEyZ16sEZVCixyRGmjwNWATUvsaSpn9UaHDnQ@mail.gmail.com>

Hello R Community,

I've been using R for a long time, and this is a question that still makes
me think twice every single time I install R, which is more and more often .

The first search hit is this StackOverflow question:
https://stackoverflow.com/questions/32540919/library-is-not-writable

The warning message hasn't changed over the years:

install.packages("randomForest")
Installing package into ?/usr/local/lib/R/site-library?
(as ?lib? is unspecified)
Warning in install.packages :
  'lib = "/usr/local/lib/R/site-library"' is not writable

In this question they suggest using the personal library, which is what I
end up doing as well, but some people suggest changing your group.  This
actually seems like the right answer to me, but others say they had
problems when they changed groups, which also sounds about right.

Can someone please tell me (or tell StackOverflow) the real best practice?

I've gotten into some very thorny issues with installations that can't find
any library when I deploy jobs using cron or other users, and it's hard to
remember / figure out how to install (if missing) libraries in the script
because it's hard to remember the mirror syntax.

I know there's a packrat  package, and I've invented some workarounds, but
I normally just need two or three stable packages for a particular project.
I'd bet that .libPaths would be implemented differently today, but maybe
with the right library path none of that would be necessary to understand?

My final simplified questions are:

   1. What is the best practice to install libraries so that the current
   user (Linux) can always find them?
   2. Why is the default library path not writable by default, should we
   change that?

Hope everyone's doing well out there, and I hope to see some of you at
conferences when things get back to normal.

Thank you,

Gene

	[[alternative HTML version deleted]]


From drj|m|emon @end|ng |rom gm@||@com  Thu Apr  8 00:34:25 2021
From: drj|m|emon @end|ng |rom gm@||@com (Jim Lemon)
Date: Thu, 8 Apr 2021 08:34:25 +1000
Subject: [R] /usr/local/lib/R/site-library is not writable
In-Reply-To: <CAOBARVhbjxO04FEyZ16sEZVCixyRGmjwNWATUvsaSpn9UaHDnQ@mail.gmail.com>
References: <CAOBARVhbjxO04FEyZ16sEZVCixyRGmjwNWATUvsaSpn9UaHDnQ@mail.gmail.com>
Message-ID: <CA+8X3fUPrfcbtDEw0xi18DMaJfpwqC9V8mB4EdaZy09G1z9VTw@mail.gmail.com>

Hi Gene,
This is probably not best practice, but I install packages as root,
which allows me to write into the default library. The restriction on
non-root users being blocked from making changes to appications is
pretty standard.

Jim

On Thu, Apr 8, 2021 at 8:18 AM Gene Leynes <gleynes at gmail.com> wrote:
>
> Hello R Community,
>
> I've been using R for a long time, and this is a question that still makes
> me think twice every single time I install R, which is more and more often .
>
> The first search hit is this StackOverflow question:
> https://stackoverflow.com/questions/32540919/library-is-not-writable
>
> The warning message hasn't changed over the years:
>
> install.packages("randomForest")
> Installing package into ?/usr/local/lib/R/site-library?
> (as ?lib? is unspecified)
> Warning in install.packages :
>   'lib = "/usr/local/lib/R/site-library"' is not writable
>
> In this question they suggest using the personal library, which is what I
> end up doing as well, but some people suggest changing your group.  This
> actually seems like the right answer to me, but others say they had
> problems when they changed groups, which also sounds about right.
>
> Can someone please tell me (or tell StackOverflow) the real best practice?
>
> I've gotten into some very thorny issues with installations that can't find
> any library when I deploy jobs using cron or other users, and it's hard to
> remember / figure out how to install (if missing) libraries in the script
> because it's hard to remember the mirror syntax.
>
> I know there's a packrat  package, and I've invented some workarounds, but
> I normally just need two or three stable packages for a particular project.
> I'd bet that .libPaths would be implemented differently today, but maybe
> with the right library path none of that would be necessary to understand?
>
> My final simplified questions are:
>
>    1. What is the best practice to install libraries so that the current
>    user (Linux) can always find them?
>    2. Why is the default library path not writable by default, should we
>    change that?
>
> Hope everyone's doing well out there, and I hope to see some of you at
> conferences when things get back to normal.
>
> Thank you,
>
> Gene
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Thu Apr  8 00:32:32 2021
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Wed, 7 Apr 2021 23:32:32 +0100
Subject: [R] R Language on Windows 2019
In-Reply-To: <F75E6CD0-F610-4B24-BC3F-9F194148EF29@gmail.com>
References: <F75E6CD0-F610-4B24-BC3F-9F194148EF29@gmail.com>
Message-ID: <4350e3a4-a399-5dee-0863-a9a7585fee92@sapo.pt>

Hello,

Yes, it is.
I have worked with R on Windows Server for many years with no problems 
except for the usual ones, users make something wrong, configurations, 
tool chains needing upgrading, etc. But nothing unsolvable.
Give it a try and I'm sure that you will be find it that R is great 
software with no real Windows Server 2019 compatibility problems.

Hope this helps,

Rui Barradas

?s 19:49 de 07/04/21, Tammy Regalado escreveu:
> 
> What versions of Windows can R Language be installed on?  Specifically, is Windows Server 2019 a supported platform?
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Thu Apr  8 00:45:31 2021
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Wed, 07 Apr 2021 15:45:31 -0700
Subject: [R] /usr/local/lib/R/site-library is not writable
In-Reply-To: <CAOBARVhbjxO04FEyZ16sEZVCixyRGmjwNWATUvsaSpn9UaHDnQ@mail.gmail.com>
References: <CAOBARVhbjxO04FEyZ16sEZVCixyRGmjwNWATUvsaSpn9UaHDnQ@mail.gmail.com>
Message-ID: <B7187B67-77A3-4306-831A-2EB3704C40E6@dcn.davis.ca.us>

1. Use a personal library. Mucking with the default library puts you at risk of changing file permissions on your personal files inadvertently and making them unusable by your normal user. Even if you did alter your user permissions so you could mess with it without elevating privileges, POSIX is designed as a multi-user system and the other users will generally not like having shared packages changed without their knowledge.

2. The default library is where R goes looking if you don't have the desired package in your personal package. It is normally updated only when the R software is updated.

On April 7, 2021 12:40:04 PM PDT, Gene Leynes <gleynes at gmail.com> wrote:
>Hello R Community,
>
>I've been using R for a long time, and this is a question that still
>makes
>me think twice every single time I install R, which is more and more
>often .
>
>The first search hit is this StackOverflow question:
>https://stackoverflow.com/questions/32540919/library-is-not-writable
>
>The warning message hasn't changed over the years:
>
>install.packages("randomForest")
>Installing package into ?/usr/local/lib/R/site-library?
>(as ?lib? is unspecified)
>Warning in install.packages :
>  'lib = "/usr/local/lib/R/site-library"' is not writable
>
>In this question they suggest using the personal library, which is what
>I
>end up doing as well, but some people suggest changing your group. 
>This
>actually seems like the right answer to me, but others say they had
>problems when they changed groups, which also sounds about right.
>
>Can someone please tell me (or tell StackOverflow) the real best
>practice?
>
>I've gotten into some very thorny issues with installations that can't
>find
>any library when I deploy jobs using cron or other users, and it's hard
>to
>remember / figure out how to install (if missing) libraries in the
>script
>because it's hard to remember the mirror syntax.
>
>I know there's a packrat  package, and I've invented some workarounds,
>but
>I normally just need two or three stable packages for a particular
>project.
>I'd bet that .libPaths would be implemented differently today, but
>maybe
>with the right library path none of that would be necessary to
>understand?
>
>My final simplified questions are:
>
>  1. What is the best practice to install libraries so that the current
>   user (Linux) can always find them?
>  2. Why is the default library path not writable by default, should we
>   change that?
>
>Hope everyone's doing well out there, and I hope to see some of you at
>conferences when things get back to normal.
>
>Thank you,
>
>Gene
>
>	[[alternative HTML version deleted]]
>
>______________________________________________
>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>https://stat.ethz.ch/mailman/listinfo/r-help
>PLEASE do read the posting guide
>http://www.R-project.org/posting-guide.html
>and provide commented, minimal, self-contained, reproducible code.

-- 
Sent from my phone. Please excuse my brevity.


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Thu Apr  8 00:55:56 2021
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Wed, 07 Apr 2021 15:55:56 -0700
Subject: [R] R Language on Windows 2019
In-Reply-To: <F75E6CD0-F610-4B24-BC3F-9F194148EF29@gmail.com>
References: <F75E6CD0-F610-4B24-BC3F-9F194148EF29@gmail.com>
Message-ID: <AED99293-D7E8-44CD-B569-23505E01F2EB@dcn.davis.ca.us>

There is one volunteer-supported installer for all Windows versions, and it is not built as a Windows Service. I highly doubt that any of those volunteer developers have access to Windows Server 2019... if it doesn't work there interactively then you may need to enable some level of compatibility using OS configuration tools.

On April 7, 2021 11:49:38 AM PDT, Tammy Regalado <tmrega06 at gmail.com> wrote:
>
>What versions of Windows can R Language be installed on?  Specifically,
>is Windows Server 2019 a supported platform?
>______________________________________________
>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>https://stat.ethz.ch/mailman/listinfo/r-help
>PLEASE do read the posting guide
>http://www.R-project.org/posting-guide.html
>and provide commented, minimal, self-contained, reproducible code.

-- 
Sent from my phone. Please excuse my brevity.


From edd @end|ng |rom deb|@n@org  Thu Apr  8 02:58:10 2021
From: edd @end|ng |rom deb|@n@org (Dirk Eddelbuettel)
Date: Wed, 7 Apr 2021 19:58:10 -0500
Subject: [R] /usr/local/lib/R/site-library is not writable
In-Reply-To: <B7187B67-77A3-4306-831A-2EB3704C40E6@dcn.davis.ca.us>
References: <CAOBARVhbjxO04FEyZ16sEZVCixyRGmjwNWATUvsaSpn9UaHDnQ@mail.gmail.com>
 <B7187B67-77A3-4306-831A-2EB3704C40E6@dcn.davis.ca.us>
Message-ID: <24686.21794.390884.122283@rob.eddelbuettel.com>


Hi Gene,

"It's complicated". (Not really, but listen for a sec...)

We need to ship a default policy that makes sense for all / most
situations.  So

- users cannot write into /usr/local/lib/R/site-library -- unless they are
  set up to, but adding them to the 'group' that owns that directory

- root can (but ideally one should not run as root as one generally does not
  now what code you might get slipped in a tar.gz); but root can enable users

- so we recommend letting (some or all) users write there by explicitly
  adding them to an appropriate group.

Personally, I do not think personal libraries are a good idea on shared
machines because you can end up with a different set of package (versions)
than your colleague on the same machine.  And or you running shiny from $HOME
have different packages than shiny running as server. And on and on. Other
people differ, and that is fine. If one wants personal libraries one can.

I must have explained the reasoning and fixes a dozen times each on
r-sig-debian (where you could have asked this too) and StackOverflow. At
least the latter can be searched so look at this set:
https://stackoverflow.com/search?q=user%3Ame+is%3Aanser+%2Fusr%2Flocal%2Flib%2FR%2Fsite-library

Happy to take it offline too, and who knows, we even get to meet for a coffee
one of these days.

Hope this helps, Dirk

-- 
https://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From rhe|p @end|ng |rom eoo@@dd@@n|  Thu Apr  8 15:18:38 2021
From: rhe|p @end|ng |rom eoo@@dd@@n| (Jan van der Laan)
Date: Thu, 8 Apr 2021 15:18:38 +0200
Subject: [R] /usr/local/lib/R/site-library is not writable
In-Reply-To: <24686.21794.390884.122283@rob.eddelbuettel.com>
References: <CAOBARVhbjxO04FEyZ16sEZVCixyRGmjwNWATUvsaSpn9UaHDnQ@mail.gmail.com>
 <B7187B67-77A3-4306-831A-2EB3704C40E6@dcn.davis.ca.us>
 <24686.21794.390884.122283@rob.eddelbuettel.com>
Message-ID: <fcda6668-bf89-f68c-25a5-de6401449bd1@eoos.dds.nl>


I would actually go a step in the other direction: per project 
libraries. For example by adding a .Rprofile file to your project 
directory. This ensures that everybody working on a project uses the 
same version of the packages (even on different machines e.g. on shared 
folders).

This can give issues when a new version of R arrives, but that is 
usually easy to solve. Either hard code the path to the old R-version or 
decide to update all packages in a project to the new R-version (and 
test that everything is still working ok).

We have the most often used packages installed centrally on the 
server/network, so I actually usually end up with a mixture of central, 
personal and project libraries. Theory vs practice.

HTH,
Jan



On 08-04-2021 02:58, Dirk Eddelbuettel wrote:
> Hi Gene,
> 
> "It's complicated". (Not really, but listen for a sec...)
> 
> We need to ship a default policy that makes sense for all / most
> situations.  So
> 
> - users cannot write into /usr/local/lib/R/site-library -- unless they are
>    set up to, but adding them to the 'group' that owns that directory
> 
> - root can (but ideally one should not run as root as one generally does not
>    now what code you might get slipped in a tar.gz); but root can enable users
> 
> - so we recommend letting (some or all) users write there by explicitly
>    adding them to an appropriate group.
> 
> Personally, I do not think personal libraries are a good idea on shared
> machines because you can end up with a different set of package (versions)
> than your colleague on the same machine.  And or you running shiny from $HOME
> have different packages than shiny running as server. And on and on. Other
> people differ, and that is fine. If one wants personal libraries one can.
> 
> I must have explained the reasoning and fixes a dozen times each on
> r-sig-debian (where you could have asked this too) and StackOverflow. At
> least the latter can be searched so look at this set:
> https://stackoverflow.com/search?q=user%3Ame+is%3Aanser+%2Fusr%2Flocal%2Flib%2FR%2Fsite-library
> 
> Happy to take it offline too, and who knows, we even get to meet for a coffee
> one of these days.
> 
> Hope this helps, Dirk
>


From thebudget72 m@iii@g oii gm@ii@com  Thu Apr  8 18:10:16 2021
From: thebudget72 m@iii@g oii gm@ii@com (thebudget72 m@iii@g oii gm@ii@com)
Date: Thu, 8 Apr 2021 18:10:16 +0200
Subject: [R] Variance of the sample mean by bootstrapping
Message-ID: <966b0a1f-7cde-d69c-3727-f2281df01679@gmail.com>

Hello,

I'm studying bootstrapping.

I devised a code that draw a sample of heights, and then compute the 
sample mean of those heights.

I want to compute the variance of the sample mean by bootstrapping.

I am comparing this with the "real" variance of the sample meanand with 
an "estimated" variance of the sample mean.

Is my code correct? The results looks very similar in all three cases.

I just want to be sure that I made everything right.

Thanks in advance!

#!/usr/bin/env R

its <- 10000
mean <- 180
sd <- 50
N <- 10000

heights <- rnorm(N, mean, sd)

sample.mean <- mean(heights)

print(paste0("Real mean: ", mean))
print(paste0("Sample mean: ", sample.mean))

# unbiased sample variance
# the var() function already uses the unbiased estimator
#sample.var <- (N/(N-1))*var(heights)
sample.var <- var(heights)

mean.var.real <- (sd^2)/N
print(paste0("Actual variance of the sample mean: ", mean.var.real))

mean.var.sample <- sample.var/N
print(paste0("Estimated variance of the sample mean: ", mean.var.sample))

# Compute variance by bootstrap
boot.means <- rep(NA, its)
for(it in 1:its) {
 ? boot.h <- sample(heights, N, replace=T)
 ? boot.means[it] <- mean(boot.h)
}

mean.var.boot <- var(boot.means)
print(paste0("Bootstrapped variance of the sample mean: ", mean.var.boot))


	[[alternative HTML version deleted]]


From henr|k@bengt@@on @end|ng |rom gm@||@com  Thu Apr  8 18:28:49 2021
From: henr|k@bengt@@on @end|ng |rom gm@||@com (Henrik Bengtsson)
Date: Thu, 8 Apr 2021 09:28:49 -0700
Subject: [R] 
 R does not start from (Debian) linux command line - error with
 doWithOneRestart() - segmentation fault
In-Reply-To: <CAC8=1eqGH_edCisjEF6Me_h9EvMnriEihWUoYkaAcORy+oLJRw@mail.gmail.com>
References: <CAC8=1eoxsgbi7fc=hPXEp+HsfPwWYvMPdV9CNT+bxyb+wPAruQ@mail.gmail.com>
 <24685.23937.706650.276577@stat.math.ethz.ch>
 <CAC8=1eqGH_edCisjEF6Me_h9EvMnriEihWUoYkaAcORy+oLJRw@mail.gmail.com>
Message-ID: <CAFDcVCSLf1=kg0MnXp0QHOutVzrxOOfDrH+v3DMDuM3Sie84gQ@mail.gmail.com>

Ashim, as Martin says, there's something really weird going on with
your core R installation.  This is definitely not expected, and I
don't know think if I've every seen this reported before.  Here are
some questions/comments that might help you move forward and for
others to pitch in:

1. How did you install R?

2. What happens if you call:

$ Rscript --vanilla -e "1+2"

3. What happens if you call:

$ Rscript --vanilla --default-packages=base -e "1+2"

4. What happens if you call:

$ Rscript --vanilla --default-packages=base,methods -e "1+2"

If any of 2-4 gives a different result, that's a first clue.

/Henrik

On Wed, Apr 7, 2021 at 1:17 AM Ashim Kapoor <ashimkapoor at gmail.com> wrote:
>
> On Wed, Apr 7, 2021 at 12:51 PM Martin Maechler
> <maechler at stat.math.ethz.ch> wrote:
> >
> > >>>>> Ashim Kapoor
> > >>>>>     on Wed, 7 Apr 2021 10:35:14 +0530 writes:
> >
> >     > Dear R experts,
> >
> >     > Here is my problem :
> >
> >     > R startup FAILS with an error message. The error message
> >     > is more meaningful when I do invoke R via sudo OR as
> >     > root. I attach the startup messages when I invoke R as :
> >
> >     > 1. as non root user 2. with sudo 3. as Root user.
> >
> >     > The error messages ( mentioned in snippets below ) are
> >     > more meaningful to me in the above mentioned order.
> >
> > Thank you, Ashim.
> >
> > Yes, the messages point to something really bad.
> >
> > OTOH ("On the other hand"), what we *can* see is that you try to
> > start R version 3.6.3.
> >
>
> My apologies for not being clear.
>
> I would like to clarify :
>
> 1. The error message from the incantation `R` is not very informative.
>
> 2. The error message from the incantation `sudo R` says (among other
> things which don't seem significant to me):
> Error in doWithOneRestart(return(` \\x82\\x0ccPV`), restart) :
>   not a proper file name
>
> 3. The error message from invoking R as a root user says:
>
> Error: not a proper file name
> Fatal error: unable to initialize the JIT
>
> I found this on the internet :
> https://stackoverflow.com/questions/19512165/error-in-dowithonerestart
>
> The error messages and the above link point to issues with JAVA, but
> it does not say how to fix them.
>
> That is why I thought : there is an .xlsx file which has non english
> characters which is messing with
> Java.
>
> Query : is there a way to do JAVA garbage collection when R is not starting ?
>
> > While that is not extremely old, it may well be older than
> > several other pieces of software (or even hardware) that you are
> > running with.
> >
> > I very very  *strongly* recommend to use an R version 4.0.x ... and why not
> > use the latest  4.0.5 ?
> >
>
> We upgraded to 4.0.5 but it did not make a difference. We restarted
> the computer and that fixed the error.
> I think the JAVA garbage collection kicked in when we reset the
> computer and that is why it was fixed on rebooting. Not sure though.
>
> > Then, it may also be caused by a mismatch of system libraries
> > and your oldish version of R. ... but there I'd strongly
> > recommend consulting with other Debian users, notably as there
> > is a dedicated  mailing list  R-SIG-Debian --> do subscribe
> > there, and ask -- with more details on how you got your R: Is it
> > the default R on your Debian, which version of Debian,  etc.
> >
> > Last but not least, Dirk Eddelbuettel, the maintainer of the
> > official R Debian package maintains a nice web page -- part of
> > the official CRAN web pages, but unfortunately a bit hidden
> > nowadays, (not the least because CRAN still uses frames (w?rg!!)):
> >
> >   https://cloud.r-project.org/bin/linux/debian/
> >
> > A very nice and useful page,  much underrated and underused,
> > probably.
> >
>
> Thank you for this.
>
> > Best regards,
> >
> > Martin Maechler
> > ETH Zurich  and  R Core Team
> >
> >
> >     > When I google around for the error message, it looks like
> >     > there is an .xlsx file which has non english characters
> >     > which is messing with Java.
> >
> >     > I do not know how to fix this. I tried :-
> >
> >     > R --vanilla
> >
> >     > so that it would not use any startup scripts but that also
> >     > does not work.
> >
> >     > ----------------- snip
> >     > ----------------------------------------------------------------------------------------------------------------------------
> >
> >     > When I try to start R from the command line :
> >
> >     > ~$ R
> >
> >     >  *** caught segfault *** address (nil), cause 'unknown'
> >
> >     > Traceback: 1: NextMethod(.Generic) 2:
> >     > Ops.numeric_version(R_version_built_under, "3.0.0") 3:
> >     > testRversion(pkgInfo, package, pkgpath) 4:
> >     > library(package, lib.loc = lib.loc, character.only = TRUE,
> >     > logical.return = TRUE, warn.conflicts = warn.conflicts,
> >     > quietly = quietly, mask.ok = mask.ok, exclude = exclude,
> >     > include.only = include.only, attach.required =
> >     > attach.required) 5: doTryCatch(return(expr), name,
> >     > parentenv, handler) 6: tryCatchOne(expr, names, parentenv,
> >     > handlers[[1L]]) 7: tryCatchList(expr, classes, parentenv,
> >     > handlers) 8: tryCatch(library(package, lib.loc = lib.loc,
> >     > character.only = TRUE, logical.return = TRUE,
> >     > warn.conflicts = warn.conflicts, quietly = quietly,
> >     > mask.ok = mask.ok, exclude = exclude, include.only =
> >     > include.only, attach.required = attach.required), error =
> >     > function(e) e) 9: require(pkg, quietly = TRUE,
> >     > warn.conflicts = FALSE, character.only = TRUE) 10:
> >     > .OptRequireMethods()
> >
> >     > Possible actions: 1: abort (with core dump, if enabled) 2:
> >     > normal R exit 3: exit R without saving workspace 4: exit R
> >     > saving workspace Selection: Segmentation fault
> >
> >     > ----------------- snip
> >     > ----------------------------------------------------------------------------------------------------------------------------
> >     > When I try to start R with sudo it gives a more clear
> >     > message :-
> >
> >     > ~$ sudo R
> >
> >     >  *** caught segfault *** address (nil), cause 'unknown'
> >
> >     > Traceback: 1: NextMethod(.Generic) 2:
> >     > Ops.numeric_version(R_version_built_under, "3.0.0") 3:
> >     > testRversion(pkgInfo, package, pkgpath) 4:
> >     > library(package, lib.loc = lib.loc, character.only = TRUE,
> >     > logical.return = TRUE, warn.conflicts = warn.conflicts,
> >     > quietly = quietly, mask.ok = mask.ok, exclude = exclude,
> >     > include.only = include.only, attach.required =
> >     > attach.required) 5: doTryCatch(return(expr), name,
> >     > parentenv, handler) 6: tryCatchOne(expr, names, parentenv,
> >     > handlers[[1L]]) 7: tryCatchList(expr, classes, parentenv,
> >     > handlers) 8: tryCatch(library(package, lib.loc = lib.loc,
> >     > character.only = TRUE, logical.return = TRUE,
> >     > warn.conflicts = warn.conflicts, quietly = quietly,
> >     > mask.ok = mask.ok, exclude = exclude, include.only =
> >     > include.only, attach.required = attach.required), error =
> >     > function(e) e) 9: require(pkg, quietly = TRUE,
> >     > warn.conflicts = FALSE, character.only = TRUE) 10:
> >     > .OptRequireMethods()
> >
> >     > Possible actions: 1: abort (with core dump, if enabled) 2:
> >     > normal R exit 3: exit R without saving workspace 4: exit R
> >     > saving workspace Selection: Error in
> >     > doWithOneRestart(return(` \\x82\\x0ccPV`), restart) : not
> >     > a proper file name
> >
> >     > R version 3.6.3 (2020-02-29) -- "Holding the Windsock"
> >     > Copyright (C) 2020 The R Foundation for Statistical
> >     > Computing Platform: x86_64-pc-linux-gnu (64-bit)
> >
> >     > R is free software and comes with ABSOLUTELY NO WARRANTY.
> >     > You are welcome to redistribute it under certain
> >     > conditions.  Type 'license()' or 'licence()' for
> >     > distribution details.
> >
> >     >   Natural language support but running in an English
> >     > locale
> >
> >     > R is a collaborative project with many contributors.  Type
> >     > 'contributors()' for more information and 'citation()' on
> >     > how to cite R or R packages in publications.
> >
> >     > Type 'demo()' for some demos, 'help()' for on-line help,
> >     > or 'help.start()' for an HTML browser interface to help.
> >     > Type 'q()' to quit R.
> >
> >     > Error: not a proper file name Error in
> >     > doWithOneRestart(return(` \\x82\\x0ccPV`), restart) :
> >     > promise already under evaluation: recursive default
> >     > argument reference or earlier problems?  Segmentation
> >     > fault
> >
> >     > ----------------- snip
> >     > ----------------------------------------------------------------------------------------------------------------------------
> >
> >     > Invoking R as a root user :-
> >
> >     > $ sudo -i root at crayshrimp ~ # R
> >
> >     >  *** caught segfault *** address (nil), cause 'unknown'
> >
> >     > Traceback: 1: NextMethod(.Generic) 2:
> >     > Ops.numeric_version(R_version_built_under, "3.0.0") 3:
> >     > testRversion(pkgInfo, package, pkgpath) 4:
> >     > library(package, lib.loc = lib.loc, character.only = TRUE,
> >     > logical.return = TRUE, warn.conflicts = warn.conflicts,
> >     > quietly = quietly, mask.ok = mask.ok, exclude = exclude,
> >     > include.only = include.only, attach.required =
> >     > attach.required) 5: doTryCatch(return(expr), name,
> >     > parentenv, handler) 6: tryCatchOne(expr, names, parentenv,
> >     > handlers[[1L]]) 7: tryCatchList(expr, classes, parentenv,
> >     > handlers) 8: tryCatch(library(package, lib.loc = lib.loc,
> >     > character.only = TRUE, logical.return = TRUE,
> >     > warn.conflicts = warn.conflicts, quietly = quietly,
> >     > mask.ok = mask.ok, exclude = exclude, include.only =
> >     > include.only, attach.required = attach.required), error =
> >     > function(e) e) 9: require(pkg, quietly = TRUE,
> >     > warn.conflicts = FALSE, character.only = TRUE) 10:
> >     > .OptRequireMethods()
> >
> >     > Possible actions: 1: abort (with core dump, if enabled) 2:
> >     > normal R exit 3: exit R without saving workspace 4: exit R
> >     > saving workspace Selection: Error in
> >     > doWithOneRestart(return(), restart) : not a proper file
> >     > name
> >
> >     > R version 3.6.3 (2020-02-29) -- "Holding the Windsock"
> >     > Copyright (C) 2020 The R Foundation for Statistical
> >     > Computing Platform: x86_64-pc-linux-gnu (64-bit)
> >
> >     > R is free software and comes with ABSOLUTELY NO WARRANTY.
> >     > You are welcome to redistribute it under certain
> >     > conditions.  Type 'license()' or 'licence()' for
> >     > distribution details.
> >
> >     >   Natural language support but running in an English
> >     > locale
> >
> >     > R is a collaborative project with many contributors.  Type
> >     > 'contributors()' for more information and 'citation()' on
> >     > how to cite R or R packages in publications.
> >
> >     > Type 'demo()' for some demos, 'help()' for on-line help,
> >     > or 'help.start()' for an HTML browser interface to help.
> >     > Type 'q()' to quit R.
> >
> >     > Error: not a proper file name Error in
> >     > doWithOneRestart(return(), restart) : promise already
> >     > under evaluation: recursive default argument reference or
> >     > earlier problems?  Error in tryCatchOne(, names,
> >     > parentenv, handlers[[1L]]) : promise already under
> >     > evaluation: recursive default argument reference or
> >     > earlier problems?  Error: not a proper file name Fatal
> >     > error: unable to initialize the JIT
> >
> >     > ----------------- snip
> >     > ----------------------------------------------------------------------------------------------------------------------------
> >
> >     > Thank you, Ashim
> >
> >     > ______________________________________________
> >     > R-help at r-project.org mailing list -- To UNSUBSCRIBE and
> >     > more, see https://stat.ethz.ch/mailman/listinfo/r-help
> >     > PLEASE do read the posting guide
> >     > http://www.R-project.org/posting-guide.html and provide
> >     > commented, minimal, self-contained, reproducible code.
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From pj@|nh@07 @end|ng |rom gm@||@com  Thu Apr  8 23:30:31 2021
From: pj@|nh@07 @end|ng |rom gm@||@com (pooja sinha)
Date: Thu, 8 Apr 2021 17:30:31 -0400
Subject: [R] Unable to extract gene list from chromosome
Message-ID: <CAGjf1cM=UhmZPbRLVwg0S6+KJ1P0CnZcH5O9f8Ozc3=vMj-uCg@mail.gmail.com>

Hi All,

I am trying to extract gene list from chromosome number and position, for
that I am using biomaRt in R but I am getting error messages as shown
below. Also below is the code I am using for extraction.

library("biomaRt")
listMarts()
ensembl <- useMart("ensembl")
datasets <- listDatasets(ensembl)
ensembl = useDataset("rnorvegicus_gene_ensembl",mart=ensembl)
AT_AC_Gene <- read.csv("AT-AC-methylkit_biomart-4-7-21.csv",header=T)
attributes <-
c("external_gene_name","ensembl_gene_id","start_position","end_position","rgd_symbol","chromosome_name")
filters <- c("chromosome_name","start","end")
values <- list(AT_AC_Gene$chr,AT_AC_Gene$start,AT_AC_Gene$end)
final_1 <- getBM(attributes=attributes, filters=filters, values=values,
mart=ensembl)

The code runs well without any error but the final1 output has 0
observations of 6 variables. Why?

Can anyone help me with this?


Thanks,

Puja

	[[alternative HTML version deleted]]


From dw|n@em|u@ @end|ng |rom comc@@t@net  Fri Apr  9 00:01:05 2021
From: dw|n@em|u@ @end|ng |rom comc@@t@net (David Winsemius)
Date: Thu, 8 Apr 2021 15:01:05 -0700
Subject: [R] Unable to extract gene list from chromosome
In-Reply-To: <CAGjf1cM=UhmZPbRLVwg0S6+KJ1P0CnZcH5O9f8Ozc3=vMj-uCg@mail.gmail.com>
References: <CAGjf1cM=UhmZPbRLVwg0S6+KJ1P0CnZcH5O9f8Ozc3=vMj-uCg@mail.gmail.com>
Message-ID: <040e6438-0744-33d7-33a8-f0ffd9c18e16@comcast.net>


On 4/8/21 2:30 PM, pooja sinha wrote:
> Hi All,
>
> I am trying to extract gene list from chromosome number and position, for
> that I am using biomaRt in R but I am getting error messages as shown
> below. Also below is the code I am using for extraction.
>
> library("biomaRt")
> listMarts()
> ensembl <- useMart("ensembl")
> datasets <- listDatasets(ensembl)
> ensembl = useDataset("rnorvegicus_gene_ensembl",mart=ensembl)
> AT_AC_Gene <- read.csv("AT-AC-methylkit_biomart-4-7-21.csv",header=T)


#--- a this point I get

Error in file(file, "rt") : cannot open the connection
In addition: Warning message:
In file(file, "rt") :
 ? cannot open file 'AT-AC-methylkit_biomart-4-7-21.csv': No such file 
or directory

> attributes <-
> c("external_gene_name","ensembl_gene_id","start_position","end_position","rgd_symbol","chromosome_name")
> filters <- c("chromosome_name","start","end")
> values <- list(AT_AC_Gene$chr,AT_AC_Gene$start,AT_AC_Gene$end)
> final_1 <- getBM(attributes=attributes, filters=filters, values=values,
> mart=ensembl)
>
> The code runs well without any error but the final1 output has 0
> observations of 6 variables. Why?
>
> Can anyone help me with this?


You are more likely to get a useful response on the BioC mailing list. 
It appears you have a dependenciy of a csv file that you have not told 
us about.


-- 

David

>
>
> Thanks,
>
> Puja
>
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From dw|n@em|u@ @end|ng |rom comc@@t@net  Fri Apr  9 01:28:14 2021
From: dw|n@em|u@ @end|ng |rom comc@@t@net (David Winsemius)
Date: Thu, 8 Apr 2021 16:28:14 -0700
Subject: [R] Unable to extract gene list from chromosome
In-Reply-To: <CAGjf1cN267Yfu8ucboLKEndDWUUyCVqYUH8vS1qBb8Xqjt6SgA@mail.gmail.com>
References: <CAGjf1cM=UhmZPbRLVwg0S6+KJ1P0CnZcH5O9f8Ozc3=vMj-uCg@mail.gmail.com>
 <040e6438-0744-33d7-33a8-f0ffd9c18e16@comcast.net>
 <CAGjf1cN267Yfu8ucboLKEndDWUUyCVqYUH8vS1qBb8Xqjt6SgA@mail.gmail.com>
Message-ID: <83a9badc-9461-61c7-c8e9-17074eb8475b@comcast.net>


On 4/8/21 3:42 PM, pooja sinha wrote:
> Hi David,
>
> Sorry I forgot to attach the file. Now it's attached.


Now when I go back and check the values of the setup variables after 
seeing an error on the last call,

Error in .processResults(postRes, mart = mart, sep = sep, fullXmlQuery = 
fullXmlQuery,? :
 ? Query ERROR: caught BioMart::Exception::Database: Error during query 
execution: You have an error in your SQL syntax; check the manual that 
corresponds to your MySQL server version for the right syntax to use 
near 'AND (main.seq_region_end_1020 >= '15108600' OR 
main.seq_region_end_1020 >= '9115' at line 1

I now notice:


AT_AC_Gene$chr

#NULL

Changing that to AT_AC_Gene$Chromosome_number gets at least a startup 
message from the server:

Batch submitting query 
[==>-------------------------------------------------------------------] 
5% eta:? 1m

Error in .processResults(postRes, mart = mart, sep = sep, fullXmlQuery = 
fullXmlQuery,? :
 ? Query ERROR: caught BioMart::Exception::Database: Error during query 
execution: You have an error in your SQL syntax; check the manual that 
corresponds to your MySQL server version for the right syntax to use 
near 'AND (main.seq_region_end_1020 >= '15108600' OR 
main.seq_region_end_1020 >= '9115' at line 1

But then I get the same error before about SQL syntax error.


Then I ran it with only complete cases and now get no error but again 
see no hits:

str(final_1)
'data.frame':??? 0 obs. of? 6 variables:
 ?$ external_gene_name: logi
 ?$ ensembl_gene_id?? : logi
 ?$ start_position??? : logi
 ?$ end_position????? : logi
 ?$ rgd_symbol??????? : logi
 ?$ chromosome_name?? : logi


I also see a lot of NA's in that dataset and when I just send the first 
10 rows of the request, I get no error (but also no matches.)


So you clearly are not giving us all the data or all the code, but I'm 
finally wondering if you just don't have an data that matches teh 
external datasets in your chosen "biomart". Can you offer a smaller 
dataset that you know with certainty should produce a match?


Alternatively, you might want to post this instead at the BioConductor 
mailing list. They are the people who have a better chance of spotting 
obvious errors. I've found two likely code-related errors but I'm not a 
computational biostatistician.

David

>
>
> Thanks,
> Puja
>
> On Thu, Apr 8, 2021 at 6:01 PM David Winsemius <dwinsemius at comcast.net 
> <mailto:dwinsemius at comcast.net>> wrote:
>
>
>     On 4/8/21 2:30 PM, pooja sinha wrote:
>     > Hi All,
>     >
>     > I am trying to extract gene list from chromosome number and
>     position, for
>     > that I am using biomaRt in R but I am getting error messages as
>     shown
>     > below. Also below is the code I am using for extraction.
>     >
>     > library("biomaRt")
>     > listMarts()
>     > ensembl <- useMart("ensembl")
>     > datasets <- listDatasets(ensembl)
>     > ensembl = useDataset("rnorvegicus_gene_ensembl",mart=ensembl)
>     > AT_AC_Gene <-
>     read.csv("AT-AC-methylkit_biomart-4-7-21.csv",header=T)
>
>
>     #--- a this point I get
>
>     Error in file(file, "rt") : cannot open the connection
>     In addition: Warning message:
>     In file(file, "rt") :
>     ?? cannot open file 'AT-AC-methylkit_biomart-4-7-21.csv': No such
>     file
>     or directory
>
>     > attributes <-
>     >
>     c("external_gene_name","ensembl_gene_id","start_position","end_position","rgd_symbol","chromosome_name")
>     > filters <- c("chromosome_name","start","end")
>     > values <- list(AT_AC_Gene$chr,AT_AC_Gene$start,AT_AC_Gene$end)
>     > final_1 <- getBM(attributes=attributes, filters=filters,
>     values=values,
>     > mart=ensembl)
>     >
>     > The code runs well without any error but the final1 output has 0
>     > observations of 6 variables. Why?
>     >
>     > Can anyone help me with this?
>
>
>     You are more likely to get a useful response on the BioC mailing
>     list.
>     It appears you have a dependenciy of a csv file that you have not
>     told
>     us about.
>
>
>     -- 
>
>     David
>
>     >
>     >
>     > Thanks,
>     >
>     > Puja
>     >
>     >? ? ? ?[[alternative HTML version deleted]]
>     >
>     > ______________________________________________
>     > R-help at r-project.org <mailto:R-help at r-project.org> mailing list
>     -- To UNSUBSCRIBE and more, see
>     > https://stat.ethz.ch/mailman/listinfo/r-help
>     > PLEASE do read the posting guide
>     http://www.R-project.org/posting-guide.html
>     > and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From @@h|mk@poor @end|ng |rom gm@||@com  Fri Apr  9 06:27:58 2021
From: @@h|mk@poor @end|ng |rom gm@||@com (Ashim Kapoor)
Date: Fri, 9 Apr 2021 09:57:58 +0530
Subject: [R] 
 R does not start from (Debian) linux command line - error with
 doWithOneRestart() - segmentation fault
In-Reply-To: <CAFDcVCSLf1=kg0MnXp0QHOutVzrxOOfDrH+v3DMDuM3Sie84gQ@mail.gmail.com>
References: <CAC8=1eoxsgbi7fc=hPXEp+HsfPwWYvMPdV9CNT+bxyb+wPAruQ@mail.gmail.com>
 <24685.23937.706650.276577@stat.math.ethz.ch>
 <CAC8=1eqGH_edCisjEF6Me_h9EvMnriEihWUoYkaAcORy+oLJRw@mail.gmail.com>
 <CAFDcVCSLf1=kg0MnXp0QHOutVzrxOOfDrH+v3DMDuM3Sie84gQ@mail.gmail.com>
Message-ID: <CAC8=1erP7aZss-=sbru0zmKM7G+kF6vQeJ8_PO3WjrvMmNe_qg@mail.gmail.com>

Dear Henrik,

We upgraded R and rebooted the computer and the error went away. Hence
I do not think we will get any strange results anymore.

Still, I could be mistaken and I am still curious as to what happened
to my R installation. Please find the answers inline below.

On Thu, Apr 8, 2021 at 9:59 PM Henrik Bengtsson
<henrik.bengtsson at gmail.com> wrote:
>
> Ashim, as Martin says, there's something really weird going on with
> your core R installation.  This is definitely not expected, and I
> don't know think if I've every seen this reported before.  Here are
> some questions/comments that might help you move forward and for
> others to pitch in:
>
> 1. How did you install R?
>

IIRC I installed R by doing:

apt-get install r-base r-base-dev

( following the instructions on this page :
https://cloud.r-project.org/ ) I went to this page and clicked on
"Download R for Linux" and then clicked on  "debian". I think, since
the page uses frames, the url does not change when I do those 2 steps.

> 2. What happens if you call:
>
> $ Rscript --vanilla -e "1+2"
>

$ Rscript --vanilla -e "1+2"
[1] 3


> 3. What happens if you call:
>
> $ Rscript --vanilla --default-packages=base -e "1+2"
>

$ Rscript --vanilla --default-packages=base -e "1+2"
[1] 3

> 4. What happens if you call:
>
> $ Rscript --vanilla --default-packages=base,methods -e "1+2"
>
$ Rscript --vanilla --default-packages=base,methods -e "1+2"
[1] 3

> If any of 2-4 gives a different result, that's a first clue.
>
> /Henrik
>

Many thanks for your help,
Best Regards,
Ashim

> On Wed, Apr 7, 2021 at 1:17 AM Ashim Kapoor <ashimkapoor at gmail.com> wrote:
> >
> > On Wed, Apr 7, 2021 at 12:51 PM Martin Maechler
> > <maechler at stat.math.ethz.ch> wrote:
> > >
> > > >>>>> Ashim Kapoor
> > > >>>>>     on Wed, 7 Apr 2021 10:35:14 +0530 writes:
> > >
> > >     > Dear R experts,
> > >
> > >     > Here is my problem :
> > >
> > >     > R startup FAILS with an error message. The error message
> > >     > is more meaningful when I do invoke R via sudo OR as
> > >     > root. I attach the startup messages when I invoke R as :
> > >
> > >     > 1. as non root user 2. with sudo 3. as Root user.
> > >
> > >     > The error messages ( mentioned in snippets below ) are
> > >     > more meaningful to me in the above mentioned order.
> > >
> > > Thank you, Ashim.
> > >
> > > Yes, the messages point to something really bad.
> > >
> > > OTOH ("On the other hand"), what we *can* see is that you try to
> > > start R version 3.6.3.
> > >
> >
> > My apologies for not being clear.
> >
> > I would like to clarify :
> >
> > 1. The error message from the incantation `R` is not very informative.
> >
> > 2. The error message from the incantation `sudo R` says (among other
> > things which don't seem significant to me):
> > Error in doWithOneRestart(return(` \\x82\\x0ccPV`), restart) :
> >   not a proper file name
> >
> > 3. The error message from invoking R as a root user says:
> >
> > Error: not a proper file name
> > Fatal error: unable to initialize the JIT
> >
> > I found this on the internet :
> > https://stackoverflow.com/questions/19512165/error-in-dowithonerestart
> >
> > The error messages and the above link point to issues with JAVA, but
> > it does not say how to fix them.
> >
> > That is why I thought : there is an .xlsx file which has non english
> > characters which is messing with
> > Java.
> >
> > Query : is there a way to do JAVA garbage collection when R is not starting ?
> >
> > > While that is not extremely old, it may well be older than
> > > several other pieces of software (or even hardware) that you are
> > > running with.
> > >
> > > I very very  *strongly* recommend to use an R version 4.0.x ... and why not
> > > use the latest  4.0.5 ?
> > >
> >
> > We upgraded to 4.0.5 but it did not make a difference. We restarted
> > the computer and that fixed the error.
> > I think the JAVA garbage collection kicked in when we reset the
> > computer and that is why it was fixed on rebooting. Not sure though.
> >
> > > Then, it may also be caused by a mismatch of system libraries
> > > and your oldish version of R. ... but there I'd strongly
> > > recommend consulting with other Debian users, notably as there
> > > is a dedicated  mailing list  R-SIG-Debian --> do subscribe
> > > there, and ask -- with more details on how you got your R: Is it
> > > the default R on your Debian, which version of Debian,  etc.
> > >
> > > Last but not least, Dirk Eddelbuettel, the maintainer of the
> > > official R Debian package maintains a nice web page -- part of
> > > the official CRAN web pages, but unfortunately a bit hidden
> > > nowadays, (not the least because CRAN still uses frames (w?rg!!)):
> > >
> > >   https://cloud.r-project.org/bin/linux/debian/
> > >
> > > A very nice and useful page,  much underrated and underused,
> > > probably.
> > >
> >
> > Thank you for this.
> >
> > > Best regards,
> > >
> > > Martin Maechler
> > > ETH Zurich  and  R Core Team
> > >
> > >
> > >     > When I google around for the error message, it looks like
> > >     > there is an .xlsx file which has non english characters
> > >     > which is messing with Java.
> > >
> > >     > I do not know how to fix this. I tried :-
> > >
> > >     > R --vanilla
> > >
> > >     > so that it would not use any startup scripts but that also
> > >     > does not work.
> > >
> > >     > ----------------- snip
> > >     > ----------------------------------------------------------------------------------------------------------------------------
> > >
> > >     > When I try to start R from the command line :
> > >
> > >     > ~$ R
> > >
> > >     >  *** caught segfault *** address (nil), cause 'unknown'
> > >
> > >     > Traceback: 1: NextMethod(.Generic) 2:
> > >     > Ops.numeric_version(R_version_built_under, "3.0.0") 3:
> > >     > testRversion(pkgInfo, package, pkgpath) 4:
> > >     > library(package, lib.loc = lib.loc, character.only = TRUE,
> > >     > logical.return = TRUE, warn.conflicts = warn.conflicts,
> > >     > quietly = quietly, mask.ok = mask.ok, exclude = exclude,
> > >     > include.only = include.only, attach.required =
> > >     > attach.required) 5: doTryCatch(return(expr), name,
> > >     > parentenv, handler) 6: tryCatchOne(expr, names, parentenv,
> > >     > handlers[[1L]]) 7: tryCatchList(expr, classes, parentenv,
> > >     > handlers) 8: tryCatch(library(package, lib.loc = lib.loc,
> > >     > character.only = TRUE, logical.return = TRUE,
> > >     > warn.conflicts = warn.conflicts, quietly = quietly,
> > >     > mask.ok = mask.ok, exclude = exclude, include.only =
> > >     > include.only, attach.required = attach.required), error =
> > >     > function(e) e) 9: require(pkg, quietly = TRUE,
> > >     > warn.conflicts = FALSE, character.only = TRUE) 10:
> > >     > .OptRequireMethods()
> > >
> > >     > Possible actions: 1: abort (with core dump, if enabled) 2:
> > >     > normal R exit 3: exit R without saving workspace 4: exit R
> > >     > saving workspace Selection: Segmentation fault
> > >
> > >     > ----------------- snip
> > >     > ----------------------------------------------------------------------------------------------------------------------------
> > >     > When I try to start R with sudo it gives a more clear
> > >     > message :-
> > >
> > >     > ~$ sudo R
> > >
> > >     >  *** caught segfault *** address (nil), cause 'unknown'
> > >
> > >     > Traceback: 1: NextMethod(.Generic) 2:
> > >     > Ops.numeric_version(R_version_built_under, "3.0.0") 3:
> > >     > testRversion(pkgInfo, package, pkgpath) 4:
> > >     > library(package, lib.loc = lib.loc, character.only = TRUE,
> > >     > logical.return = TRUE, warn.conflicts = warn.conflicts,
> > >     > quietly = quietly, mask.ok = mask.ok, exclude = exclude,
> > >     > include.only = include.only, attach.required =
> > >     > attach.required) 5: doTryCatch(return(expr), name,
> > >     > parentenv, handler) 6: tryCatchOne(expr, names, parentenv,
> > >     > handlers[[1L]]) 7: tryCatchList(expr, classes, parentenv,
> > >     > handlers) 8: tryCatch(library(package, lib.loc = lib.loc,
> > >     > character.only = TRUE, logical.return = TRUE,
> > >     > warn.conflicts = warn.conflicts, quietly = quietly,
> > >     > mask.ok = mask.ok, exclude = exclude, include.only =
> > >     > include.only, attach.required = attach.required), error =
> > >     > function(e) e) 9: require(pkg, quietly = TRUE,
> > >     > warn.conflicts = FALSE, character.only = TRUE) 10:
> > >     > .OptRequireMethods()
> > >
> > >     > Possible actions: 1: abort (with core dump, if enabled) 2:
> > >     > normal R exit 3: exit R without saving workspace 4: exit R
> > >     > saving workspace Selection: Error in
> > >     > doWithOneRestart(return(` \\x82\\x0ccPV`), restart) : not
> > >     > a proper file name
> > >
> > >     > R version 3.6.3 (2020-02-29) -- "Holding the Windsock"
> > >     > Copyright (C) 2020 The R Foundation for Statistical
> > >     > Computing Platform: x86_64-pc-linux-gnu (64-bit)
> > >
> > >     > R is free software and comes with ABSOLUTELY NO WARRANTY.
> > >     > You are welcome to redistribute it under certain
> > >     > conditions.  Type 'license()' or 'licence()' for
> > >     > distribution details.
> > >
> > >     >   Natural language support but running in an English
> > >     > locale
> > >
> > >     > R is a collaborative project with many contributors.  Type
> > >     > 'contributors()' for more information and 'citation()' on
> > >     > how to cite R or R packages in publications.
> > >
> > >     > Type 'demo()' for some demos, 'help()' for on-line help,
> > >     > or 'help.start()' for an HTML browser interface to help.
> > >     > Type 'q()' to quit R.
> > >
> > >     > Error: not a proper file name Error in
> > >     > doWithOneRestart(return(` \\x82\\x0ccPV`), restart) :
> > >     > promise already under evaluation: recursive default
> > >     > argument reference or earlier problems?  Segmentation
> > >     > fault
> > >
> > >     > ----------------- snip
> > >     > ----------------------------------------------------------------------------------------------------------------------------
> > >
> > >     > Invoking R as a root user :-
> > >
> > >     > $ sudo -i root at crayshrimp ~ # R
> > >
> > >     >  *** caught segfault *** address (nil), cause 'unknown'
> > >
> > >     > Traceback: 1: NextMethod(.Generic) 2:
> > >     > Ops.numeric_version(R_version_built_under, "3.0.0") 3:
> > >     > testRversion(pkgInfo, package, pkgpath) 4:
> > >     > library(package, lib.loc = lib.loc, character.only = TRUE,
> > >     > logical.return = TRUE, warn.conflicts = warn.conflicts,
> > >     > quietly = quietly, mask.ok = mask.ok, exclude = exclude,
> > >     > include.only = include.only, attach.required =
> > >     > attach.required) 5: doTryCatch(return(expr), name,
> > >     > parentenv, handler) 6: tryCatchOne(expr, names, parentenv,
> > >     > handlers[[1L]]) 7: tryCatchList(expr, classes, parentenv,
> > >     > handlers) 8: tryCatch(library(package, lib.loc = lib.loc,
> > >     > character.only = TRUE, logical.return = TRUE,
> > >     > warn.conflicts = warn.conflicts, quietly = quietly,
> > >     > mask.ok = mask.ok, exclude = exclude, include.only =
> > >     > include.only, attach.required = attach.required), error =
> > >     > function(e) e) 9: require(pkg, quietly = TRUE,
> > >     > warn.conflicts = FALSE, character.only = TRUE) 10:
> > >     > .OptRequireMethods()
> > >
> > >     > Possible actions: 1: abort (with core dump, if enabled) 2:
> > >     > normal R exit 3: exit R without saving workspace 4: exit R
> > >     > saving workspace Selection: Error in
> > >     > doWithOneRestart(return(), restart) : not a proper file
> > >     > name
> > >
> > >     > R version 3.6.3 (2020-02-29) -- "Holding the Windsock"
> > >     > Copyright (C) 2020 The R Foundation for Statistical
> > >     > Computing Platform: x86_64-pc-linux-gnu (64-bit)
> > >
> > >     > R is free software and comes with ABSOLUTELY NO WARRANTY.
> > >     > You are welcome to redistribute it under certain
> > >     > conditions.  Type 'license()' or 'licence()' for
> > >     > distribution details.
> > >
> > >     >   Natural language support but running in an English
> > >     > locale
> > >
> > >     > R is a collaborative project with many contributors.  Type
> > >     > 'contributors()' for more information and 'citation()' on
> > >     > how to cite R or R packages in publications.
> > >
> > >     > Type 'demo()' for some demos, 'help()' for on-line help,
> > >     > or 'help.start()' for an HTML browser interface to help.
> > >     > Type 'q()' to quit R.
> > >
> > >     > Error: not a proper file name Error in
> > >     > doWithOneRestart(return(), restart) : promise already
> > >     > under evaluation: recursive default argument reference or
> > >     > earlier problems?  Error in tryCatchOne(, names,
> > >     > parentenv, handlers[[1L]]) : promise already under
> > >     > evaluation: recursive default argument reference or
> > >     > earlier problems?  Error: not a proper file name Fatal
> > >     > error: unable to initialize the JIT
> > >
> > >     > ----------------- snip
> > >     > ----------------------------------------------------------------------------------------------------------------------------
> > >
> > >     > Thank you, Ashim
> > >
> > >     > ______________________________________________
> > >     > R-help at r-project.org mailing list -- To UNSUBSCRIBE and
> > >     > more, see https://stat.ethz.ch/mailman/listinfo/r-help
> > >     > PLEASE do read the posting guide
> > >     > http://www.R-project.org/posting-guide.html and provide
> > >     > commented, minimal, self-contained, reproducible code.
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.


From petr@p|k@| @end|ng |rom prechez@@cz  Fri Apr  9 11:29:31 2021
From: petr@p|k@| @end|ng |rom prechez@@cz (PIKAL Petr)
Date: Fri, 9 Apr 2021 09:29:31 +0000
Subject: [R] Plotting adjusted KM curve
In-Reply-To: <MN2PR03MB5167831095C7DEFEFAF23E76E2779@MN2PR03MB5167.namprd03.prod.outlook.com>
References: <MN2PR03MB5167831095C7DEFEFAF23E76E2779@MN2PR03MB5167.namprd03.prod.outlook.com>
Message-ID: <23cdd4bece7341848889f9422e9386b3@SRVEXCHCM1302.precheza.cz>

Hi

Google answered

https://rdrr.io/bioc/survcomp/man/km.coxph.plot.html

Is it what do you want?

Cheers
Petr

> -----Original Message-----
> From: R-help <r-help-bounces at r-project.org> On Behalf Of Sorkin, John
> Sent: Monday, April 5, 2021 3:35 AM
> To: r-help at r-project.org (r-help at r-project.org) <r-help at r-project.org>
> Subject: [R] Plotting adjusted KM curve
> 
> Colleagues,
> I am using the coxph to model survival time. How do I plot an adjusted
Kaplan
> Meir plot resulting from coxph? The code I would like to run would start
with:
> 
> # run cox model
> fit1Cox <- coxph(surv_object ~age+sex,data=mydata)
> 
> I have no idea what would follow.
> 
> I would like to plot adjusted KM curves for men vs. women at age 65.
> 
> Thank you,
> John
> 
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-
> guide.html
> and provide commented, minimal, self-contained, reproducible code.

From grond @end|ng |rom number|@nd@de  Fri Apr  9 11:48:55 2021
From: grond @end|ng |rom number|@nd@de (Wolfgang Grond)
Date: Fri, 9 Apr 2021 11:48:55 +0200
Subject: [R] Assigning several lists to variables whose names are contained
 in other variables
Message-ID: <557f5c83-003f-4406-a717-c8a2c3f160ff@numberland.de>

Dear all,

I'm creating a list (which is a tbl_graph) by a function, and assign the 
result to a variable:

subnet_MYSUBNET <- my_function(MYSUBNET)

# MYSUBNET: a tbl_graph

Because there are multiple subnets to create, I can get the names of the 
subnets (MYSUBNET1, MYSUBNET2, MYSUBNET3, etc.) from a row in a 
dataframe column.

subnet_MYSUBNET <- my_function(datatable$column[i])

Because I know how many subnets to create - nrow(dataframe) I want to 
assign the subnets to variables whose names contain the name of the subnet

For this to work I have to assign a variable name which is contained in 
an other variable name:

#################

for(i in 1:nrow(datatable)) {

val <- datatable$column[i]

result <- assign(paste("subnet_",? val, sep = "")

result <- my_function(val)

}

this works in bash, but seems not to work in R - I don't succeed at least.

Am I wrong?

Where is my mistake?

Many thanks in advance for any hint.

Wolfgang



	[[alternative HTML version deleted]]


From petr@p|k@| @end|ng |rom prechez@@cz  Fri Apr  9 12:28:58 2021
From: petr@p|k@| @end|ng |rom prechez@@cz (PIKAL Petr)
Date: Fri, 9 Apr 2021 10:28:58 +0000
Subject: [R] 
 Assigning several lists to variables whose names are contained
 in other variables
In-Reply-To: <557f5c83-003f-4406-a717-c8a2c3f160ff@numberland.de>
References: <557f5c83-003f-4406-a717-c8a2c3f160ff@numberland.de>
Message-ID: <dd7b2f2acaa24a819c9a6909638ec79a@SRVEXCHCM1302.precheza.cz>

Hi


I may be wrong but

> result <- assign(paste("subnet_",  val, sep = "")
here you miss the right parentheses
maybe you intended
assign(result, paste("subnet_",  val, sep = ""))

> result <- my_function(val)
but here you change (rewrite) the result variable to my_function result

So your overall cycle gives you only one result variable containing last value 
computed by my_function.

Cheers
Petr

> -----Original Message-----
> From: R-help <r-help-bounces at r-project.org> On Behalf Of Wolfgang Grond
> Sent: Friday, April 9, 2021 11:49 AM
> To: mailman, r-help <r-help at r-project.org>
> Subject: [R] Assigning several lists to variables whose names are contained 
> in
> other variables
>
> Dear all,
>
> I'm creating a list (which is a tbl_graph) by a function, and assign the 
> result to
> a variable:
>
> subnet_MYSUBNET <- my_function(MYSUBNET)
>
> # MYSUBNET: a tbl_graph
>
> Because there are multiple subnets to create, I can get the names of the
> subnets (MYSUBNET1, MYSUBNET2, MYSUBNET3, etc.) from a row in a
> dataframe column.
>
> subnet_MYSUBNET <- my_function(datatable$column[i])
>
> Because I know how many subnets to create - nrow(dataframe) I want to
> assign the subnets to variables whose names contain the name of the subnet
>
> For this to work I have to assign a variable name which is contained in an
> other variable name:
>
> #################
>
> for(i in 1:nrow(datatable)) {
>
> val <- datatable$column[i]
>
> result <- assign(paste("subnet_",  val, sep = "")
>
> result <- my_function(val)
>
> }
>
> this works in bash, but seems not to work in R - I don't succeed at least.
>
> Am I wrong?
>
> Where is my mistake?
>
> Many thanks in advance for any hint.
>
> Wolfgang
>
>
>
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-
> guide.html
> and provide commented, minimal, self-contained, reproducible code.

From m|n@h@|| @end|ng |rom um|ch@edu  Fri Apr  9 12:35:40 2021
From: m|n@h@|| @end|ng |rom um|ch@edu (Greg Minshall)
Date: Fri, 09 Apr 2021 13:35:40 +0300
Subject: [R] 
 Assigning several lists to variables whose names are contained
 in other variables
In-Reply-To: Your message of "Fri, 09 Apr 2021 11:48:55 +0200."
 <557f5c83-003f-4406-a717-c8a2c3f160ff@numberland.de>
Message-ID: <1154678.1617964540@apollo2.minshall.org>

Wolfgang,

> result <- assign(paste("subnet_",? val, sep = "")
> 
> result <- my_function(val)

i don't understand why you are twice assigning to =result=.  also, the
first assignment doesn't seem well formatted (t's missing a value?).

did you mean something like

: assign(paste("subnet_",? val, sep = ""), my_function(val))

(which i would think should work)?

cheers, Greg


From gor@n@bro@trom @end|ng |rom umu@@e  Fri Apr  9 13:13:00 2021
From: gor@n@bro@trom @end|ng |rom umu@@e (=?UTF-8?Q?G=c3=b6ran_Brostr=c3=b6m?=)
Date: Fri, 9 Apr 2021 13:13:00 +0200
Subject: [R] Plotting adjusted KM curve
In-Reply-To: <MN2PR03MB5167831095C7DEFEFAF23E76E2779@MN2PR03MB5167.namprd03.prod.outlook.com>
References: <MN2PR03MB5167831095C7DEFEFAF23E76E2779@MN2PR03MB5167.namprd03.prod.outlook.com>
Message-ID: <fee46fac-89ef-9bb4-303d-b8c7a7ba8f99@umu.se>



On 2021-04-05 03:34, Sorkin, John wrote:
> Colleagues,
> I am using the coxph to model survival time. How do I plot an adjusted Kaplan Meir plot resulting from coxph? The code I would like to run would start with:
> 
> # run cox model
> fit1Cox <- coxph(surv_object ~age+sex,data=mydata)
> 
> I have no idea what would follow.

You should look at

?survfit.coxph

in the survival package, especially the 'newdata' argument.
> 
> I would like to plot adjusted KM curves for men vs. women at age 65.

Then I guess that you should stratify on sex:

fit <- coxph(surv_object ~ age + strata(sex), data = mydata)

sfit <- survfit(fit, newdata = data.frame(age = 65))
plot(sfit)

HTW, G?ran

> 
> Thank you,
> John
> 
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>


From kry|ov@r00t @end|ng |rom gm@||@com  Fri Apr  9 13:43:57 2021
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Fri, 9 Apr 2021 14:43:57 +0300
Subject: [R] 
 Assigning several lists to variables whose names are contained
 in other variables
In-Reply-To: <557f5c83-003f-4406-a717-c8a2c3f160ff@numberland.de>
References: <557f5c83-003f-4406-a717-c8a2c3f160ff@numberland.de>
Message-ID: <20210409144357.06211e46@arachnoid>

Dear Wolfgang,

On Fri, 9 Apr 2021 11:48:55 +0200
Wolfgang Grond <grond at numberland.de> wrote:

> I want to assign the subnets to variables whose names contain the
> name of the subnet

Apologies if this sounds too opinionated, but creating variable names
from variable values is a FAQ in a different dynamic language:

https://perldoc.perl.org/perlfaq7#How-can-I-use-a-variable-as-a-variable-name?

Most of the explanation doesn't apply to R, of course, but the main
idea here is to use data structures instead of causing (potential,
unlikely, but still) conflicts in the variable namespace. What if you
create a list of function values instead of just a bunch of variables?

results <- list()
for(i in 1:nrow(datatable)) {
	val <- datatable$column[i]
	results[[as.character(val)]] <- my_function(val)
}

Or even

results <- lapply(setNames(nm = datatable$column), my_function)

Wouldn't that be more convenient?

-- 
Best regards,
Ivan


From pj@|nh@07 @end|ng |rom gm@||@com  Fri Apr  9 00:42:05 2021
From: pj@|nh@07 @end|ng |rom gm@||@com (pooja sinha)
Date: Thu, 8 Apr 2021 18:42:05 -0400
Subject: [R] Unable to extract gene list from chromosome
In-Reply-To: <040e6438-0744-33d7-33a8-f0ffd9c18e16@comcast.net>
References: <CAGjf1cM=UhmZPbRLVwg0S6+KJ1P0CnZcH5O9f8Ozc3=vMj-uCg@mail.gmail.com>
 <040e6438-0744-33d7-33a8-f0ffd9c18e16@comcast.net>
Message-ID: <CAGjf1cN267Yfu8ucboLKEndDWUUyCVqYUH8vS1qBb8Xqjt6SgA@mail.gmail.com>

Hi David,

Sorry I forgot to attach the file. Now it's attached.


Thanks,
Puja

On Thu, Apr 8, 2021 at 6:01 PM David Winsemius <dwinsemius at comcast.net>
wrote:

>
> On 4/8/21 2:30 PM, pooja sinha wrote:
> > Hi All,
> >
> > I am trying to extract gene list from chromosome number and position, for
> > that I am using biomaRt in R but I am getting error messages as shown
> > below. Also below is the code I am using for extraction.
> >
> > library("biomaRt")
> > listMarts()
> > ensembl <- useMart("ensembl")
> > datasets <- listDatasets(ensembl)
> > ensembl = useDataset("rnorvegicus_gene_ensembl",mart=ensembl)
> > AT_AC_Gene <- read.csv("AT-AC-methylkit_biomart-4-7-21.csv",header=T)
>
>
> #--- a this point I get
>
> Error in file(file, "rt") : cannot open the connection
> In addition: Warning message:
> In file(file, "rt") :
>    cannot open file 'AT-AC-methylkit_biomart-4-7-21.csv': No such file
> or directory
>
> > attributes <-
> >
> c("external_gene_name","ensembl_gene_id","start_position","end_position","rgd_symbol","chromosome_name")
> > filters <- c("chromosome_name","start","end")
> > values <- list(AT_AC_Gene$chr,AT_AC_Gene$start,AT_AC_Gene$end)
> > final_1 <- getBM(attributes=attributes, filters=filters, values=values,
> > mart=ensembl)
> >
> > The code runs well without any error but the final1 output has 0
> > observations of 6 variables. Why?
> >
> > Can anyone help me with this?
>
>
> You are more likely to get a useful response on the BioC mailing list.
> It appears you have a dependenciy of a csv file that you have not told
> us about.
>
>
> --
>
> David
>
> >
> >
> > Thanks,
> >
> > Puja
> >
> >       [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.
>

From wgrond @end|ng |rom wgrond@de  Fri Apr  9 14:14:47 2021
From: wgrond @end|ng |rom wgrond@de (Wolfgang Grond)
Date: Fri, 09 Apr 2021 14:14:47 +0200
Subject: [R] 
 Assigning several lists to variables whose names are contained
 in other variables
In-Reply-To: <20210409144357.06211e46@arachnoid>
References: <557f5c83-003f-4406-a717-c8a2c3f160ff@numberland.de>
 <20210409144357.06211e46@arachnoid>
Message-ID: <04B79467-3219-4DDF-810C-35667463970A@wgrond.de>

Dear Ivan,

when I try your solution with lapply as below I get the following error message:

Error in eval ... : object 'function' not found ( I think anything about my_function is meant).

Am 9. April 2021 13:43:57 MESZ schrieb Ivan Krylov <krylov.r00t at gmail.com>:
>Dear Wolfgang,
>
>On Fri, 9 Apr 2021 11:48:55 +0200
>Wolfgang Grond <grond at numberland.de> wrote:
>
>> I want to assign the subnets to variables whose names contain the
>> name of the subnet
>
>Apologies if this sounds too opinionated, but creating variable names
>from variable values is a FAQ in a different dynamic language:
>
>https://perldoc.perl.org/perlfaq7#How-can-I-use-a-variable-as-a-variable-name?
>
>Most of the explanation doesn't apply to R, of course, but the main
>idea here is to use data structures instead of causing (potential,
>unlikely, but still) conflicts in the variable namespace. What if you
>create a list of function values instead of just a bunch of variables?
>
>results <- list()
>for(i in 1:nrow(datatable)) {
>	val <- datatable$column[i]
>	results[[as.character(val)]] <- my_function(val)
>}
>
>Or even
>
>results <- lapply(setNames(nm = datatable$column), my_function)
>
>Wouldn't that be more convenient?
>
>-- 
>Best regards,
>Ivan
>
>______________________________________________
>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>https://stat.ethz.ch/mailman/listinfo/r-help
>PLEASE do read the posting guide
>http://www.R-project.org/posting-guide.html
>and provide commented, minimal, self-contained, reproducible code.

	[[alternative HTML version deleted]]


From wgrond @end|ng |rom wgrond@de  Fri Apr  9 14:17:24 2021
From: wgrond @end|ng |rom wgrond@de (Wolfgang Grond)
Date: Fri, 09 Apr 2021 14:17:24 +0200
Subject: [R] 
 Assigning several lists to variables whose names are contained
 in other variables
In-Reply-To: <20210409144357.06211e46@arachnoid>
References: <557f5c83-003f-4406-a717-c8a2c3f160ff@numberland.de>
 <20210409144357.06211e46@arachnoid>
Message-ID: <5FBE1A74-2C54-4E51-AAB5-4FD2FAE5D82E@wgrond.de>

Ivan,

same situation when I try your list() solution:

Error in eval ... : object 'function' not found ( I think anything about my_function is meant).


Am 9. April 2021 13:43:57 MESZ schrieb Ivan Krylov <krylov.r00t at gmail.com>:
>Dear Wolfgang,
>
>On Fri, 9 Apr 2021 11:48:55 +0200
>Wolfgang Grond <grond at numberland.de> wrote:
>
>> I want to assign the subnets to variables whose names contain the
>> name of the subnet
>
>Apologies if this sounds too opinionated, but creating variable names
>from variable values is a FAQ in a different dynamic language:
>
>https://perldoc.perl.org/perlfaq7#How-can-I-use-a-variable-as-a-variable-name?
>
>Most of the explanation doesn't apply to R, of course, but the main
>idea here is to use data structures instead of causing (potential,
>unlikely, but still) conflicts in the variable namespace. What if you
>create a list of function values instead of just a bunch of variables?
>
>results <- list()
>for(i in 1:nrow(datatable)) {
>	val <- datatable$column[i]
>	results[[as.character(val)]] <- my_function(val)
>}
>
>Or even
>
>results <- lapply(setNames(nm = datatable$column), my_function)
>
>Wouldn't that be more convenient?
>
>-- 
>Best regards,
>Ivan
>
>______________________________________________
>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>https://stat.ethz.ch/mailman/listinfo/r-help
>PLEASE do read the posting guide
>http://www.R-project.org/posting-guide.html
>and provide commented, minimal, self-contained, reproducible code.


-
Numberland - Dr. Wolfgang Grond
Diplomphysiker, TQM-Assessor (EFQM)
Six Sigma Green Belt
Ingenieurb?ro / Engineering Consultancy
Lohfeld 20, DE-95326 Kulmbach, Germany
Phone: +49 9221 6919131
Fax: +49 9221 6919156
Mail: grond at numberland.com
URL: http://www.numberland.com
	[[alternative HTML version deleted]]


From wgrond @end|ng |rom wgrond@de  Fri Apr  9 14:21:13 2021
From: wgrond @end|ng |rom wgrond@de (Wolfgang Grond)
Date: Fri, 09 Apr 2021 14:21:13 +0200
Subject: [R] 
 Assigning several lists to variables whose names are contained
 in other variables
In-Reply-To: <1154678.1617964540@apollo2.minshall.org>
References: <1154678.1617964540@apollo2.minshall.org>
Message-ID: <5AA55174-62A5-4428-AC52-F6ABD3F7021E@wgrond.de>

Greg,

here I get the error message:

Error my_function(val) :

cannot find function my_function.

Am 9. April 2021 12:35:40 MESZ schrieb Greg Minshall <minshall at umich.edu>:
>Wolfgang,
>
>> result <- assign(paste("subnet_",? val, sep = "")
>> 
>> result <- my_function(val)
>
>i don't understand why you are twice assigning to =result=.  also, the
>first assignment doesn't seem well formatted (t's missing a value?).
>
>did you mean something like
>
>: assign(paste("subnet_",? val, sep = ""), my_function(val))
>
>(which i would think should work)?
>
>cheers, Greg
>
>______________________________________________
>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>https://stat.ethz.ch/mailman/listinfo/r-help
>PLEASE do read the posting guide
>http://www.R-project.org/posting-guide.html
>and provide commented, minimal, self-contained, reproducible code.


-
Numberland - Dr. Wolfgang Grond
Diplomphysiker, TQM-Assessor (EFQM)
Six Sigma Green Belt
Ingenieurb?ro / Engineering Consultancy
Lohfeld 20, DE-95326 Kulmbach, Germany
Phone: +49 9221 6919131
Fax: +49 9221 6919156
Mail: grond at numberland.com
URL: http://www.numberland.com
	[[alternative HTML version deleted]]


From pj@|nh@07 @end|ng |rom gm@||@com  Fri Apr  9 15:34:08 2021
From: pj@|nh@07 @end|ng |rom gm@||@com (pooja sinha)
Date: Fri, 9 Apr 2021 09:34:08 -0400
Subject: [R] Unable to extract gene list from chromosome
In-Reply-To: <83a9badc-9461-61c7-c8e9-17074eb8475b@comcast.net>
References: <CAGjf1cM=UhmZPbRLVwg0S6+KJ1P0CnZcH5O9f8Ozc3=vMj-uCg@mail.gmail.com>
 <040e6438-0744-33d7-33a8-f0ffd9c18e16@comcast.net>
 <CAGjf1cN267Yfu8ucboLKEndDWUUyCVqYUH8vS1qBb8Xqjt6SgA@mail.gmail.com>
 <83a9badc-9461-61c7-c8e9-17074eb8475b@comcast.net>
Message-ID: <CAGjf1cMe+fkzJmFmdLj0JVWaTmWpooUQ0NdDPvXrXRhmyK-NZA@mail.gmail.com>

Hi David,

That's the only file I have for analysis and I am also getting the final_1
as 0 obs. of  6 variables. My problem is that I am not getting any output.
It seems like I am missing something in the* values* code but I don't know
what. Just for your hint I googled and some people have suggested using
values as vectors which I do not understand. Also when I pick one row of
the start column and do it on the interactive phase it's giving the result
but it's not possible to do one by one due to the large no. of rows. I
posted my problem in biostars but am still waiting for someone to reply.

Thanks,
Puja

On Thu, Apr 8, 2021 at 7:28 PM David Winsemius <dwinsemius at comcast.net>
wrote:

>
> On 4/8/21 3:42 PM, pooja sinha wrote:
>
> Hi David,
>
> Sorry I forgot to attach the file. Now it's attached.
>
>
> Now when I go back and check the values of the setup variables after
> seeing an error on the last call,
>
> Error in .processResults(postRes, mart = mart, sep = sep, fullXmlQuery =
> fullXmlQuery,  :
>   Query ERROR: caught BioMart::Exception::Database: Error during query
> execution: You have an error in your SQL syntax; check the manual that
> corresponds to your MySQL server version for the right syntax to use near
> 'AND (main.seq_region_end_1020 >= '15108600' OR main.seq_region_end_1020 >=
> '9115' at line 1
>
> I now notice:
>
>
> AT_AC_Gene$chr
>
> #NULL
>
> Changing that to AT_AC_Gene$Chromosome_number gets at least a startup
> message from the server:
>
> Batch submitting query
> [==>-------------------------------------------------------------------]
> 5% eta:  1m
>
> Error in .processResults(postRes, mart = mart, sep = sep, fullXmlQuery =
> fullXmlQuery,  :
>   Query ERROR: caught BioMart::Exception::Database: Error during query
> execution: You have an error in your SQL syntax; check the manual that
> corresponds to your MySQL server version for the right syntax to use near
> 'AND (main.seq_region_end_1020 >= '15108600' OR main.seq_region_end_1020 >=
> '9115' at line 1
>
> But then I get the same error before about SQL syntax error.
>
>
> Then I ran it with only complete cases and now get no error but again see
> no hits:
>
> str(final_1)
> 'data.frame':    0 obs. of  6 variables:
>  $ external_gene_name: logi
>  $ ensembl_gene_id   : logi
>  $ start_position    : logi
>  $ end_position      : logi
>  $ rgd_symbol        : logi
>  $ chromosome_name   : logi
>
>
> I also see a lot of NA's in that dataset and when I just send the first 10
> rows of the request, I get no error (but also no matches.)
>
>
> So you clearly are not giving us all the data or all the code, but I'm
> finally wondering if you just don't have an data that matches teh external
> datasets in your chosen "biomart". Can you offer a smaller dataset that you
> know with certainty should produce a match?
>
>
> Alternatively, you might want to post this instead at the BioConductor
> mailing list. They are the people who have a better chance of spotting
> obvious errors. I've found two likely code-related errors but I'm not a
> computational biostatistician.
>
> David
>
>
>
> Thanks,
> Puja
>
> On Thu, Apr 8, 2021 at 6:01 PM David Winsemius <dwinsemius at comcast.net>
> wrote:
>
>>
>> On 4/8/21 2:30 PM, pooja sinha wrote:
>> > Hi All,
>> >
>> > I am trying to extract gene list from chromosome number and position,
>> for
>> > that I am using biomaRt in R but I am getting error messages as shown
>> > below. Also below is the code I am using for extraction.
>> >
>> > library("biomaRt")
>> > listMarts()
>> > ensembl <- useMart("ensembl")
>> > datasets <- listDatasets(ensembl)
>> > ensembl = useDataset("rnorvegicus_gene_ensembl",mart=ensembl)
>> > AT_AC_Gene <- read.csv("AT-AC-methylkit_biomart-4-7-21.csv",header=T)
>>
>>
>> #--- a this point I get
>>
>> Error in file(file, "rt") : cannot open the connection
>> In addition: Warning message:
>> In file(file, "rt") :
>>    cannot open file 'AT-AC-methylkit_biomart-4-7-21.csv': No such file
>> or directory
>>
>> > attributes <-
>> >
>> c("external_gene_name","ensembl_gene_id","start_position","end_position","rgd_symbol","chromosome_name")
>> > filters <- c("chromosome_name","start","end")
>> > values <- list(AT_AC_Gene$chr,AT_AC_Gene$start,AT_AC_Gene$end)
>> > final_1 <- getBM(attributes=attributes, filters=filters, values=values,
>> > mart=ensembl)
>> >
>> > The code runs well without any error but the final1 output has 0
>> > observations of 6 variables. Why?
>> >
>> > Can anyone help me with this?
>>
>>
>> You are more likely to get a useful response on the BioC mailing list.
>> It appears you have a dependenciy of a csv file that you have not told
>> us about.
>>
>>
>> --
>>
>> David
>>
>> >
>> >
>> > Thanks,
>> >
>> > Puja
>> >
>> >       [[alternative HTML version deleted]]
>> >
>> > ______________________________________________
>> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> > https://stat.ethz.ch/mailman/listinfo/r-help
>> > PLEASE do read the posting guide
>> http://www.R-project.org/posting-guide.html
>> > and provide commented, minimal, self-contained, reproducible code.
>>
>

	[[alternative HTML version deleted]]


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Fri Apr  9 15:43:27 2021
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Fri, 9 Apr 2021 14:43:27 +0100
Subject: [R] 
 Assigning several lists to variables whose names are contained
 in other variables
In-Reply-To: <5AA55174-62A5-4428-AC52-F6ABD3F7021E@wgrond.de>
References: <1154678.1617964540@apollo2.minshall.org>
 <5AA55174-62A5-4428-AC52-F6ABD3F7021E@wgrond.de>
Message-ID: <2c0c6ceb-6ec9-f881-f4d5-5a93e3959d8c@sapo.pt>

Hello,

my_function seems to be a function you have defined somewhere in your code.
In your original post you mention it 3 times, this is the first one:


subnet_MYSUBNET <- my_function(MYSUBNET)


So Ivan's and Greg's code should work, they use a function you haven't 
posted but is assumed to exist.

Note: if you are more comfortable with for loops than with *apply, I 
would rewrite Ivan's for loop solution as


results <- vector("list", length = nrow(datatable))
for(val in datatable$column) {
	results[[as.character(val)]] <- my_function(val)
}


To keep extending a vector or list object in a loop is inefficient, this 
creates the list with the right length beforehand.


Hope this helps,

Rui Barradas

?s 13:21 de 09/04/21, Wolfgang Grond escreveu:
> Greg,
> 
> here I get the error message:
> 
> Error my_function(val) :
> 
> cannot find function my_function.
> 
> Am 9. April 2021 12:35:40 MESZ schrieb Greg Minshall <minshall at umich.edu>:
>> Wolfgang,
>>
>>> result <- assign(paste("subnet_",? val, sep = "")
>>>
>>> result <- my_function(val)
>>
>> i don't understand why you are twice assigning to =result=.  also, the
>> first assignment doesn't seem well formatted (t's missing a value?).
>>
>> did you mean something like
>>
>> : assign(paste("subnet_",? val, sep = ""), my_function(val))
>>
>> (which i would think should work)?
>>
>> cheers, Greg
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide
>> http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
> 
> 
> -
> Numberland - Dr. Wolfgang Grond
> Diplomphysiker, TQM-Assessor (EFQM)
> Six Sigma Green Belt
> Ingenieurb?ro / Engineering Consultancy
> Lohfeld 20, DE-95326 Kulmbach, Germany
> Phone: +49 9221 6919131
> Fax: +49 9221 6919156
> Mail: grond at numberland.com
> URL: http://www.numberland.com
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>


From dw|n@em|u@ @end|ng |rom comc@@t@net  Fri Apr  9 17:22:05 2021
From: dw|n@em|u@ @end|ng |rom comc@@t@net (David Winsemius)
Date: Fri, 9 Apr 2021 08:22:05 -0700
Subject: [R] 
 Assigning several lists to variables whose names are contained
 in other variables
In-Reply-To: <5AA55174-62A5-4428-AC52-F6ABD3F7021E@wgrond.de>
References: <1154678.1617964540@apollo2.minshall.org>
 <5AA55174-62A5-4428-AC52-F6ABD3F7021E@wgrond.de>
Message-ID: <2e9d9627-cc60-d053-5c7e-64ff5175bd52@comcast.net>


On 4/9/21 5:21 AM, Wolfgang Grond wrote:
> Greg,
>
> here I get the error message:
>
> Error my_function(val) :
>
> cannot find function my_function.

I'm guessing that you are following someone else's blog and have failed 
one of two things:

- understand that what was meant by the author was that you were assumed 
to have a function in mind to use for a programming strategy being 
illustrated

- or you were copying and pasting only part of a blog and failed to 
paste in the code from above where there was earlier code defining 
`my_function`

>
> Am 9. April 2021 12:35:40 MESZ schrieb Greg Minshall <minshall at umich.edu>:
>> Wolfgang,
>>
>>> result <- assign(paste("subnet_",? val, sep = "")
>>>
>>> result <- my_function(val)
>> i don't understand why you are twice assigning to =result=.  also, the
>> first assignment doesn't seem well formatted (t's missing a value?).
>>
>> did you mean something like
>>
>> : assign(paste("subnet_",? val, sep = ""), my_function(val))
>>
>> (which i would think should work)?
>>
>> cheers, Greg
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide
>> http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>
> -
> Numberland - Dr. Wolfgang Grond
> Diplomphysiker, TQM-Assessor (EFQM)
> Six Sigma Green Belt
> Ingenieurb?ro / Engineering Consultancy
> Lohfeld 20, DE-95326 Kulmbach, Germany
> Phone: +49 9221 6919131
> Fax: +49 9221 6919156
> Mail: grond at numberland.com
> URL: http://www.numberland.com
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From wgrond @end|ng |rom wgrond@de  Fri Apr  9 17:12:18 2021
From: wgrond @end|ng |rom wgrond@de (Wolfgang Grond)
Date: Fri, 09 Apr 2021 17:12:18 +0200
Subject: [R] 
 Assigning several lists to variables whose names are contained
 in other variables
In-Reply-To: <2c0c6ceb-6ec9-f881-f4d5-5a93e3959d8c@sapo.pt>
References: <1154678.1617964540@apollo2.minshall.org>
 <5AA55174-62A5-4428-AC52-F6ABD3F7021E@wgrond.de>
 <2c0c6ceb-6ec9-f881-f4d5-5a93e3959d8c@sapo.pt>
Message-ID: <96D5907A-C2ED-4755-B699-1B962ED80A0C@wgrond.de>

Folks,

first of all - thanks a lot for your hints!

I will try each again and think about, why I get error messages.

But to resume: if I understand you right:

there is no way to do something like this:

$name = $result?

Regards

Wolfgang

Am 9. April 2021 15:43:27 MESZ schrieb Rui Barradas <ruipbarradas at sapo.pt>:
>Hello,
>
>my_function seems to be a function you have defined somewhere in your
>code.
>In your original post you mention it 3 times, this is the first one:
>
>
>subnet_MYSUBNET <- my_function(MYSUBNET)
>
>
>So Ivan's and Greg's code should work, they use a function you haven't 
>posted but is assumed to exist.
>
>Note: if you are more comfortable with for loops than with *apply, I 
>would rewrite Ivan's for loop solution as
>
>
>results <- vector("list", length = nrow(datatable))
>for(val in datatable$column) {
>	results[[as.character(val)]] <- my_function(val)
>}
>
>
>To keep extending a vector or list object in a loop is inefficient,
>this 
>creates the list with the right length beforehand.
>
>
>Hope this helps,
>
>Rui Barradas
>
>?s 13:21 de 09/04/21, Wolfgang Grond escreveu:
>> Greg,
>> 
>> here I get the error message:
>> 
>> Error my_function(val) :
>> 
>> cannot find function my_function.
>> 
>> Am 9. April 2021 12:35:40 MESZ schrieb Greg Minshall
><minshall at umich.edu>:
>>> Wolfgang,
>>>
>>>> result <- assign(paste("subnet_",? val, sep = "")
>>>>
>>>> result <- my_function(val)
>>>
>>> i don't understand why you are twice assigning to =result=.  also,
>the
>>> first assignment doesn't seem well formatted (t's missing a value?).
>>>
>>> did you mean something like
>>>
>>> : assign(paste("subnet_",? val, sep = ""), my_function(val))
>>>
>>> (which i would think should work)?
>>>
>>> cheers, Greg
>>>
>>> ______________________________________________
>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>> PLEASE do read the posting guide
>>> http://www.R-project.org/posting-guide.html
>>> and provide commented, minimal, self-contained, reproducible code.
>> 
>> 
>> -
>> Numberland - Dr. Wolfgang Grond
>> Diplomphysiker, TQM-Assessor (EFQM)
>> Six Sigma Green Belt
>> Ingenieurb?ro / Engineering Consultancy
>> Lohfeld 20, DE-95326 Kulmbach, Germany
>> Phone: +49 9221 6919131
>> Fax: +49 9221 6919156
>> Mail: grond at numberland.com
>> URL: http://www.numberland.com
>> 	[[alternative HTML version deleted]]
>> 
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide
>http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>>
>
>______________________________________________
>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>https://stat.ethz.ch/mailman/listinfo/r-help
>PLEASE do read the posting guide
>http://www.R-project.org/posting-guide.html
>and provide commented, minimal, self-contained, reproducible code.

	[[alternative HTML version deleted]]


From wgrond @end|ng |rom wgrond@de  Fri Apr  9 17:26:28 2021
From: wgrond @end|ng |rom wgrond@de (Wolfgang Grond)
Date: Fri, 09 Apr 2021 17:26:28 +0200
Subject: [R] 
 Assigning several lists to variables whose names are contained
 in other variables
In-Reply-To: <2e9d9627-cc60-d053-5c7e-64ff5175bd52@comcast.net>
References: <1154678.1617964540@apollo2.minshall.org>
 <5AA55174-62A5-4428-AC52-F6ABD3F7021E@wgrond.de>
 <2e9d9627-cc60-d053-5c7e-64ff5175bd52@comcast.net>
Message-ID: <06DADD35-A2B3-4293-AE45-CCE9CBE7BB37@wgrond.de>

David,

I don't think that this is the case.

When I do the calculation like this

subnet_MYSUBNET <- my_function(MYSUBNET),

i.e. assigning a variable by hand to each function result, all is fine.



Am 9. April 2021 17:22:05 MESZ schrieb David Winsemius <dwinsemius at comcast.net>:
>
>On 4/9/21 5:21 AM, Wolfgang Grond wrote:
>> Greg,
>>
>> here I get the error message:
>>
>> Error my_function(val) :
>>
>> cannot find function my_function.
>
>I'm guessing that you are following someone else's blog and have failed
>
>one of two things:
>
>- understand that what was meant by the author was that you were
>assumed 
>to have a function in mind to use for a programming strategy being 
>illustrated
>
>- or you were copying and pasting only part of a blog and failed to 
>paste in the code from above where there was earlier code defining 
>`my_function`
>
>>
>> Am 9. April 2021 12:35:40 MESZ schrieb Greg Minshall
><minshall at umich.edu>:
>>> Wolfgang,
>>>
>>>> result <- assign(paste("subnet_",? val, sep = "")
>>>>
>>>> result <- my_function(val)
>>> i don't understand why you are twice assigning to =result=.  also,
>the
>>> first assignment doesn't seem well formatted (t's missing a value?).
>>>
>>> did you mean something like
>>>
>>> : assign(paste("subnet_",? val, sep = ""), my_function(val))
>>>
>>> (which i would think should work)?
>>>
>>> cheers, Greg
>>>
>>> ______________________________________________
>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>> PLEASE do read the posting guide
>>> http://www.R-project.org/posting-guide.html
>>> and provide commented, minimal, self-contained, reproducible code.
>>
>> -
>> Numberland - Dr. Wolfgang Grond
>> Diplomphysiker, TQM-Assessor (EFQM)
>> Six Sigma Green Belt
>> Ingenieurb?ro / Engineering Consultancy
>> Lohfeld 20, DE-95326 Kulmbach, Germany
>> Phone: +49 9221 6919131
>> Fax: +49 9221 6919156
>> Mail: grond at numberland.com
>> URL: http://www.numberland.com
>> 	[[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide
>http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>
>______________________________________________
>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>https://stat.ethz.ch/mailman/listinfo/r-help
>PLEASE do read the posting guide
>http://www.R-project.org/posting-guide.html
>and provide commented, minimal, self-contained, reproducible code.

	[[alternative HTML version deleted]]


From wgrond @end|ng |rom wgrond@de  Fri Apr  9 18:23:57 2021
From: wgrond @end|ng |rom wgrond@de (Wolfgang Grond)
Date: Fri, 09 Apr 2021 18:23:57 +0200
Subject: [R] 
 Assigning several lists to variables whose names are contained
 in other variables
In-Reply-To: <2e9d9627-cc60-d053-5c7e-64ff5175bd52@comcast.net>
References: <1154678.1617964540@apollo2.minshall.org>
 <5AA55174-62A5-4428-AC52-F6ABD3F7021E@wgrond.de>
 <2e9d9627-cc60-d053-5c7e-64ff5175bd52@comcast.net>
Message-ID: <6389EB6E-5D31-48C2-A657-1E885586E212@wgrond.de>

As I wrote before, I calculate tbl_graph objects, which will be joined afterwards. Not too much, the number of graphs to calculate is in the range between 5 to 20.

Further steps are not automated, because they depend on how the single graphs look like, and which of them will be joined.

For this reason I thought it would be nice to have the single tbl_ graph objects stored in variables having the name of the graph.

For this reason I tried to find a better solution instead of assigning each graph by hand:

subnet_MYSUBNET <- my_function(MYSUBNET)

To my understanding it is therefore neccessary to assign the result of the function to a variable whose name consists of a fixed string and the content of a further variable.

That was the intention for me to ask.

Am 9. April 2021 17:22:05 MESZ schrieb David Winsemius <dwinsemius at comcast.net>:
>
>On 4/9/21 5:21 AM, Wolfgang Grond wrote:
>> Greg,
>>
>> here I get the error message:
>>
>> Error my_function(val) :
>>
>> cannot find function my_function.
>
>I'm guessing that you are following someone else's blog and have failed
>
>one of two things:
>
>- understand that what was meant by the author was that you were
>assumed 
>to have a function in mind to use for a programming strategy being 
>illustrated
>
>- or you were copying and pasting only part of a blog and failed to 
>paste in the code from above where there was earlier code defining 
>`my_function`
>
>>
>> Am 9. April 2021 12:35:40 MESZ schrieb Greg Minshall
><minshall at umich.edu>:
>>> Wolfgang,
>>>
>>>> result <- assign(paste("subnet_",? val, sep = "")
>>>>
>>>> result <- my_function(val)
>>> i don't understand why you are twice assigning to =result=.  also,
>the
>>> first assignment doesn't seem well formatted (t's missing a value?).
>>>
>>> did you mean something like
>>>
>>> : assign(paste("subnet_",? val, sep = ""), my_function(val))
>>>
>>> (which i would think should work)?
>>>
>>> cheers, Greg
>>>
>>> ______________________________________________
>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>> PLEASE do read the posting guide
>>> http://www.R-project.org/posting-guide.html
>>> and provide commented, minimal, self-contained, reproducible code.
>>
>> -
>> Numberland - Dr. Wolfgang Grond
>> Diplomphysiker, TQM-Assessor (EFQM)
>> Six Sigma Green Belt
>> Ingenieurb?ro / Engineering Consultancy
>> Lohfeld 20, DE-95326 Kulmbach, Germany
>> Phone: +49 9221 6919131
>> Fax: +49 9221 6919156
>> Mail: grond at numberland.com
>> URL: http://www.numberland.com
>> 	[[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide
>http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>
>______________________________________________
>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>https://stat.ethz.ch/mailman/listinfo/r-help
>PLEASE do read the posting guide
>http://www.R-project.org/posting-guide.html
>and provide commented, minimal, self-contained, reproducible code.

	[[alternative HTML version deleted]]


From @tyen @end|ng |rom ntu@edu@tw  Sat Apr 10 05:25:36 2021
From: @tyen @end|ng |rom ntu@edu@tw (Steven Yen)
Date: Sat, 10 Apr 2021 11:25:36 +0800
Subject: [R] Identifying column type
Message-ID: <e302e97f-1425-a1c5-c597-d2bcb299875e@ntu.edu.tw>

I have data of mixed types in a data frame - date and numeric, as shown 
in summary below. How do I identify the column(s) that is/are not 
numeric, in this case, the first. All I want is to identify the 
column(s) and so that I can remove it/them from the data frame Thanks.

> summary(mydata)

Date Spot Futures Min. :1997-09-01 00:00:00 Min. : 735.1 Min. : 734.2 
1st Qu.:2002-10-16 12:00:00 1st Qu.:1120.7 1st Qu.:1122.6 Median 
:2007-12-01 00:00:00 Median :1301.8 Median :1303.2 Mean :2007-12-01 
06:01:27 Mean :1423.1 Mean :1423.6 3rd Qu.:2013-01-16 12:00:00 3rd 
Qu.:1540.0 3rd Qu.:1546.5 Max. :2018-03-01 00:00:00 Max. :2823.8 Max. 
:2825.8


	[[alternative HTML version deleted]]


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Sat Apr 10 05:33:47 2021
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Fri, 09 Apr 2021 20:33:47 -0700
Subject: [R] Identifying column type
In-Reply-To: <e302e97f-1425-a1c5-c597-d2bcb299875e@ntu.edu.tw>
References: <e302e97f-1425-a1c5-c597-d2bcb299875e@ntu.edu.tw>
Message-ID: <2644DE71-15B5-417C-98D0-6D967E313C73@dcn.davis.ca.us>

Does

sapply( mydata, inherits, what = "POSIXt" )

give you any ideas?

On April 9, 2021 8:25:36 PM PDT, Steven Yen <styen at ntu.edu.tw> wrote:
>I have data of mixed types in a data frame - date and numeric, as shown
>
>in summary below. How do I identify the column(s) that is/are not 
>numeric, in this case, the first. All I want is to identify the 
>column(s) and so that I can remove it/them from the data frame Thanks.
>
>> summary(mydata)
>
>Date Spot Futures Min. :1997-09-01 00:00:00 Min. : 735.1 Min. : 734.2 
>1st Qu.:2002-10-16 12:00:00 1st Qu.:1120.7 1st Qu.:1122.6 Median 
>:2007-12-01 00:00:00 Median :1301.8 Median :1303.2 Mean :2007-12-01 
>06:01:27 Mean :1423.1 Mean :1423.6 3rd Qu.:2013-01-16 12:00:00 3rd 
>Qu.:1540.0 3rd Qu.:1546.5 Max. :2018-03-01 00:00:00 Max. :2823.8 Max. 
>:2825.8
>
>
>	[[alternative HTML version deleted]]
>
>______________________________________________
>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>https://stat.ethz.ch/mailman/listinfo/r-help
>PLEASE do read the posting guide
>http://www.R-project.org/posting-guide.html
>and provide commented, minimal, self-contained, reproducible code.

-- 
Sent from my phone. Please excuse my brevity.


From @tyen @end|ng |rom ntu@edu@tw  Sat Apr 10 05:54:56 2021
From: @tyen @end|ng |rom ntu@edu@tw (Steven Yen)
Date: Sat, 10 Apr 2021 11:54:56 +0800
Subject: [R] Identifying column type
In-Reply-To: <2644DE71-15B5-417C-98D0-6D967E313C73@dcn.davis.ca.us>
References: <e302e97f-1425-a1c5-c597-d2bcb299875e@ntu.edu.tw>
 <2644DE71-15B5-417C-98D0-6D967E313C73@dcn.davis.ca.us>
Message-ID: <f97f56c1-f54a-65ce-bbbb-657126a6834e@ntu.edu.tw>

Thanks much! Yes it does. I will read.

On 2021/4/10 ?? 11:33, Jeff Newmiller wrote:
> Does
>
> sapply( mydata, inherits, what = "POSIXt" )
>
> give you any ideas?
>
> On April 9, 2021 8:25:36 PM PDT, Steven Yen <styen at ntu.edu.tw> wrote:
>> I have data of mixed types in a data frame - date and numeric, as shown
>>
>> in summary below. How do I identify the column(s) that is/are not
>> numeric, in this case, the first. All I want is to identify the
>> column(s) and so that I can remove it/them from the data frame Thanks.
>>
>>> summary(mydata)
>> Date Spot Futures Min. :1997-09-01 00:00:00 Min. : 735.1 Min. : 734.2
>> 1st Qu.:2002-10-16 12:00:00 1st Qu.:1120.7 1st Qu.:1122.6 Median
>> :2007-12-01 00:00:00 Median :1301.8 Median :1303.2 Mean :2007-12-01
>> 06:01:27 Mean :1423.1 Mean :1423.6 3rd Qu.:2013-01-16 12:00:00 3rd
>> Qu.:1540.0 3rd Qu.:1546.5 Max. :2018-03-01 00:00:00 Max. :2823.8 Max.
>> :2825.8
>>
>>
>> 	[[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide
>> http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.


From bgunter@4567 @end|ng |rom gm@||@com  Sat Apr 10 06:32:36 2021
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Fri, 9 Apr 2021 21:32:36 -0700
Subject: [R] 
 Assigning several lists to variables whose names are contained
 in other variables
In-Reply-To: <6389EB6E-5D31-48C2-A657-1E885586E212@wgrond.de>
References: <1154678.1617964540@apollo2.minshall.org>
 <5AA55174-62A5-4428-AC52-F6ABD3F7021E@wgrond.de>
 <2e9d9627-cc60-d053-5c7e-64ff5175bd52@comcast.net>
 <6389EB6E-5D31-48C2-A657-1E885586E212@wgrond.de>
Message-ID: <CAGxFJbRtVEkB+VrPQMUvCtFK7HEcGq3YeNSbnYmXWZMp5K+Bag@mail.gmail.com>

I freely admit that I do not understand what you mean. But it sounds like
you are trying to make things more complicated than necessary.

Perhaps this little example may help clarify the issues:


> a <- 1; b <- 2; d <- c(3,5)
> stuff <- lapply(list(a,b,d),function(x)x^2)
> stuff
[[1]]
[1] 1

[[2]]
[1] 4

[[3]]
[1]  9 25

> stuff[[3]]
[1]  9 25

Note that one may apply (almost) any function that returns objects (and
doesn't have nasty side effects, I suppose), including graphical objects,
and store them in the list that is returned. These objects can then be
accessed as usual and manipulated/displayed/assigned ... whatever.

If this misunderstands your query and is irrelevant, do not bother to
explain. Or reply. Won't be the first time I did not get it.

If OTOH this is a complete mystery to you, then you need to spend some time
learning about R lists and how. to use them.

Cheers,
Bert



Bert Gunter

"The trouble with having an open mind is that people keep coming along and
sticking things into it."
-- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )


On Fri, Apr 9, 2021 at 7:22 PM Wolfgang Grond <wgrond at wgrond.de> wrote:

> As I wrote before, I calculate tbl_graph objects, which will be joined
> afterwards. Not too much, the number of graphs to calculate is in the range
> between 5 to 20.
>
> Further steps are not automated, because they depend on how the single
> graphs look like, and which of them will be joined.
>
> For this reason I thought it would be nice to have the single tbl_ graph
> objects stored in variables having the name of the graph.
>
> For this reason I tried to find a better solution instead of assigning
> each graph by hand:
>
> subnet_MYSUBNET <- my_function(MYSUBNET)
>
> To my understanding it is therefore neccessary to assign the result of the
> function to a variable whose name consists of a fixed string and the
> content of a further variable.
>
> That was the intention for me to ask.
>
> Am 9. April 2021 17:22:05 MESZ schrieb David Winsemius <
> dwinsemius at comcast.net>:
> >
> >On 4/9/21 5:21 AM, Wolfgang Grond wrote:
> >> Greg,
> >>
> >> here I get the error message:
> >>
> >> Error my_function(val) :
> >>
> >> cannot find function my_function.
> >
> >I'm guessing that you are following someone else's blog and have failed
> >
> >one of two things:
> >
> >- understand that what was meant by the author was that you were
> >assumed
> >to have a function in mind to use for a programming strategy being
> >illustrated
> >
> >- or you were copying and pasting only part of a blog and failed to
> >paste in the code from above where there was earlier code defining
> >`my_function`
> >
> >>
> >> Am 9. April 2021 12:35:40 MESZ schrieb Greg Minshall
> ><minshall at umich.edu>:
> >>> Wolfgang,
> >>>
> >>>> result <- assign(paste("subnet_",  val, sep = "")
> >>>>
> >>>> result <- my_function(val)
> >>> i don't understand why you are twice assigning to =result=.  also,
> >the
> >>> first assignment doesn't seem well formatted (t's missing a value?).
> >>>
> >>> did you mean something like
> >>>
> >>> : assign(paste("subnet_",  val, sep = ""), my_function(val))
> >>>
> >>> (which i would think should work)?
> >>>
> >>> cheers, Greg
> >>>
> >>> ______________________________________________
> >>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> >>> https://stat.ethz.ch/mailman/listinfo/r-help
> >>> PLEASE do read the posting guide
> >>> http://www.R-project.org/posting-guide.html
> >>> and provide commented, minimal, self-contained, reproducible code.
> >>
> >> -
> >> Numberland - Dr. Wolfgang Grond
> >> Diplomphysiker, TQM-Assessor (EFQM)
> >> Six Sigma Green Belt
> >> Ingenieurb?ro / Engineering Consultancy
> >> Lohfeld 20, DE-95326 Kulmbach, Germany
> >> Phone: +49 9221 6919131
> >> Fax: +49 9221 6919156
> >> Mail: grond at numberland.com
> >> URL: http://www.numberland.com
> >>      [[alternative HTML version deleted]]
> >>
> >> ______________________________________________
> >> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> >> https://stat.ethz.ch/mailman/listinfo/r-help
> >> PLEASE do read the posting guide
> >http://www.R-project.org/posting-guide.html
> >> and provide commented, minimal, self-contained, reproducible code.
> >
> >______________________________________________
> >R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> >https://stat.ethz.ch/mailman/listinfo/r-help
> >PLEASE do read the posting guide
> >http://www.R-project.org/posting-guide.html
> >and provide commented, minimal, self-contained, reproducible code.
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Sat Apr 10 07:37:42 2021
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Sat, 10 Apr 2021 06:37:42 +0100
Subject: [R] Identifying column type
In-Reply-To: <e302e97f-1425-a1c5-c597-d2bcb299875e@ntu.edu.tw>
References: <e302e97f-1425-a1c5-c597-d2bcb299875e@ntu.edu.tw>
Message-ID: <e9d0a692-a431-db36-6d50-1cee04c7d3a2@sapo.pt>

Hello,

Maybe something like


ok <- sapply(mydata, is.numeric)
mydata <- mydata[ok]


to keep the numeric columns only.


Hope this helps,

Rui Barradas

?s 04:25 de 10/04/21, Steven Yen escreveu:
> I have data of mixed types in a data frame - date and numeric, as shown
> in summary below. How do I identify the column(s) that is/are not
> numeric, in this case, the first. All I want is to identify the
> column(s) and so that I can remove it/them from the data frame Thanks.
> 
>> summary(mydata)
> 
> Date Spot Futures Min. :1997-09-01 00:00:00 Min. : 735.1 Min. : 734.2
> 1st Qu.:2002-10-16 12:00:00 1st Qu.:1120.7 1st Qu.:1122.6 Median
> :2007-12-01 00:00:00 Median :1301.8 Median :1303.2 Mean :2007-12-01
> 06:01:27 Mean :1423.1 Mean :1423.6 3rd Qu.:2013-01-16 12:00:00 3rd
> Qu.:1540.0 3rd Qu.:1546.5 Max. :2018-03-01 00:00:00 Max. :2823.8 Max.
> :2825.8
> 
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Sat Apr 10 09:01:43 2021
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Sat, 10 Apr 2021 08:01:43 +0100
Subject: [R] 
 Assigning several lists to variables whose names are contained
 in other variables
In-Reply-To: <6389EB6E-5D31-48C2-A657-1E885586E212@wgrond.de>
References: <1154678.1617964540@apollo2.minshall.org>
 <5AA55174-62A5-4428-AC52-F6ABD3F7021E@wgrond.de>
 <2e9d9627-cc60-d053-5c7e-64ff5175bd52@comcast.net>
 <6389EB6E-5D31-48C2-A657-1E885586E212@wgrond.de>
Message-ID: <da4a6d27-95ef-ebb9-070b-5a752c948487@sapo.pt>

Hello,

I believe that the point we are missing is that datatable$column stores 
the *names* of the graphs, not the graph objects themselves. So in the 
loop the objects must be retrieved with mget() or get().

First create a reproducible example.



library(tidygraph)

my_function <- function(g){
   stopifnot(inherits(g, "igraph"))
   g %>% mutate(centrality = centrality_pagerank())
}

MYSUBNET1 <- create_notable('bull')
iris_clust <- hclust(dist(iris[1:4]))
MYSUBNET2 <- as_tbl_graph(iris_clust)
MYSUBNET3 <- play_smallworld(1, 100, 3, 0.05)

datatable <- data.frame(column = paste0("MYSUBNET", 1:3))



Now apply the function above to each of the "tbl_graph" objects.

1. Get all objects and apply the function in one instruction. Then 
assign the new names.


result <- lapply(mget(datatable$column, envir = .GlobalEnv), my_function)
names(result) <- paste("subnet", datatable$column, sep = "_")


2. Loop through the column with lapply, getting one object and applying 
the function one at a time. Then assign the new names.



result2 <- lapply(datatable$column, function(net_name){
   NET <- get(net_name, envir = .GlobalEnv)
   my_function(NET)
})
names(result2) <- paste("subnet", datatable$column, sep = "_")



3. Loop through the column with a for loop, getting one object and 
applying the function one at a time. Then assign the new names.



result3 <- vector("list", length = nrow(datatable))
for(i in seq_along(datatable$column)){
   net_name <- datatable$column[i]
   NET <- get(net_name, envir = .GlobalEnv)
   result3[[i]] <- my_function(NET)
}
names(result3) <- paste("subnet", datatable$column, sep = "_")



4. Now check that all 3 solutions give the same result.


identical(result, result2)
#[1] TRUE
identical(result, result3)
#[1] TRUE


Is this it?

Rui Barradas


?s 17:23 de 09/04/21, Wolfgang Grond escreveu:
> As I wrote before, I calculate tbl_graph objects, which will be joined afterwards. Not too much, the number of graphs to calculate is in the range between 5 to 20.
> 
> Further steps are not automated, because they depend on how the single graphs look like, and which of them will be joined.
> 
> For this reason I thought it would be nice to have the single tbl_ graph objects stored in variables having the name of the graph.
> 
> For this reason I tried to find a better solution instead of assigning each graph by hand:
> 
> subnet_MYSUBNET <- my_function(MYSUBNET)
> 
> To my understanding it is therefore neccessary to assign the result of the function to a variable whose name consists of a fixed string and the content of a further variable.
> 
> That was the intention for me to ask.
> 
> Am 9. April 2021 17:22:05 MESZ schrieb David Winsemius <dwinsemius at comcast.net>:
>>
>> On 4/9/21 5:21 AM, Wolfgang Grond wrote:
>>> Greg,
>>>
>>> here I get the error message:
>>>
>>> Error my_function(val) :
>>>
>>> cannot find function my_function.
>>
>> I'm guessing that you are following someone else's blog and have failed
>>
>> one of two things:
>>
>> - understand that what was meant by the author was that you were
>> assumed
>> to have a function in mind to use for a programming strategy being
>> illustrated
>>
>> - or you were copying and pasting only part of a blog and failed to
>> paste in the code from above where there was earlier code defining
>> `my_function`
>>
>>>
>>> Am 9. April 2021 12:35:40 MESZ schrieb Greg Minshall
>> <minshall at umich.edu>:
>>>> Wolfgang,
>>>>
>>>>> result <- assign(paste("subnet_",? val, sep = "")
>>>>>
>>>>> result <- my_function(val)
>>>> i don't understand why you are twice assigning to =result=.  also,
>> the
>>>> first assignment doesn't seem well formatted (t's missing a value?).
>>>>
>>>> did you mean something like
>>>>
>>>> : assign(paste("subnet_",? val, sep = ""), my_function(val))
>>>>
>>>> (which i would think should work)?
>>>>
>>>> cheers, Greg
>>>>
>>>> ______________________________________________
>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>>> PLEASE do read the posting guide
>>>> http://www.R-project.org/posting-guide.html
>>>> and provide commented, minimal, self-contained, reproducible code.
>>>
>>> -
>>> Numberland - Dr. Wolfgang Grond
>>> Diplomphysiker, TQM-Assessor (EFQM)
>>> Six Sigma Green Belt
>>> Ingenieurb?ro / Engineering Consultancy
>>> Lohfeld 20, DE-95326 Kulmbach, Germany
>>> Phone: +49 9221 6919131
>>> Fax: +49 9221 6919156
>>> Mail: grond at numberland.com
>>> URL: http://www.numberland.com
>>> 	[[alternative HTML version deleted]]
>>>
>>> ______________________________________________
>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>> PLEASE do read the posting guide
>> http://www.R-project.org/posting-guide.html
>>> and provide commented, minimal, self-contained, reproducible code.
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide
>> http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>


From rkoenker @end|ng |rom ||||no|@@edu  Sat Apr 10 11:26:07 2021
From: rkoenker @end|ng |rom ||||no|@@edu (Koenker, Roger W)
Date: Sat, 10 Apr 2021 09:26:07 +0000
Subject: [R] Stata/Rstudio evil attributes
Message-ID: <DC13D3BA-857E-45BC-A472-90E9B3CDCEDE@illinois.edu>

As shown in the reproducible example below, I used the RStudio function haven() to read a Stata .dta file, and then tried to do some fitting with the resulting data.frame.  This produced an error from my fitting function rqss() in the package quantreg.  After a bit of frustrated cursing, I converted the data.frame, D, to a matrix A, and thence back to a data.frame B, and tried again, which worked as expected.  The conversion removed the attributes of D.  My question is:  why were the attributes inhibiting the fitting?

In accordance with the usual R-help etiquette I first tried to contact the maintainer of the haven package, i.e. RStudio, which elicited the response: "since the error is occurring outside RStudio we?re not responsible, so try Stack Overflow".  This is pretty much what I would have expected from the capitalist running dogs they are.  Admittedly, the error is probably due to some unforeseen infelicity in my rqss() coding, but it does seem odd that attributes could have such a drastic  effect.  I would be most grateful for any insight the R commune might offer.

#require(haven) # for reading dta file
#Ddta <- read_dta(?foo.dta")
#D <- with(Ddta, data.frame(y = access_merg, x = meannets_allhh, z = meanhh))
#save(D, file = "D.Rda")
con <- url("http://www.econ.uiuc.edu/~roger/research/data/D.Rda")
load(con)

# If I purge the Stata attributes in D:
A <- as.matrix(D)
B <- as.data.frame(A)

# This works:
with(D,plot(x, y, cex = .5, col = "grey"))
taus <- 1:4/5
require(quantreg)
for(i in 1:length(taus)){
    f <- rqss(y ~ qss(x, constraint = "I", lambda = 1), tau = taus[i], data = B)
    plot(f, add = TRUE, col = i)
}
# However, the same code with data = D, does not.  Why?

From wo||g@ng@v|echtb@uer @end|ng |rom m@@@tr|chtun|ver@|ty@n|  Sat Apr 10 12:59:34 2021
From: wo||g@ng@v|echtb@uer @end|ng |rom m@@@tr|chtun|ver@|ty@n| (Viechtbauer, Wolfgang (SP))
Date: Sat, 10 Apr 2021 10:59:34 +0000
Subject: [R] Stata/Rstudio evil attributes
In-Reply-To: <DC13D3BA-857E-45BC-A472-90E9B3CDCEDE@illinois.edu>
References: <DC13D3BA-857E-45BC-A472-90E9B3CDCEDE@illinois.edu>
Message-ID: <ee2a475c7d7244fbaaf8d2854006e64f@UM-MAIL3214.unimaas.nl>

Dear Roger,

The problem is this. qss() looks like this:

if (is.matrix(x)) {
   [...]
}
if (is.vector(x)) {
   [...]
}
qss

Now let's check these if() statements:
is.vector(B$x) # TRUE
is.vector(D$x) # FALSE
is.matrix(B$x) # FALSE
is.matrix(D$x) # FALSE

is.vector(D$x) being FALSE may be surprising, but see ?is.vector: "is.vector returns TRUE if x is a vector of the specified mode having no attributes other than names. It returns FALSE otherwise." And as D$x shows, this vector has additional attributes.

So, with 'D', qss() returns the qss function (c.f., qss(B$x) and qss(D$x)) which makes no sense. So, the internal logic in qss() needs to be fixed.

>In accordance with the usual R-help etiquette I first tried to contact the
>maintainer of the haven package, i.e. RStudio, which elicited the response: "since
>the error is occurring outside RStudio we?re not responsible, so try Stack
>Overflow".  This is pretty much what I would have expected from the capitalist
>running dogs they are.  Admittedly, the error is probably due to some unforeseen

This kind of bashing is really silly. Can you tell us again how much you paid for the use of the haven package?

Best,
Wolfgang

>-----Original Message-----
>From: R-help [mailto:r-help-bounces at r-project.org] On Behalf Of Koenker, Roger W
>Sent: Saturday, 10 April, 2021 11:26
>To: r-help
>Subject: [R] Stata/Rstudio evil attributes
>
>As shown in the reproducible example below, I used the RStudio function haven() to
>read a Stata .dta file, and then tried to do some fitting with the resulting
>data.frame.  This produced an error from my fitting function rqss() in the package
>quantreg.  After a bit of frustrated cursing, I converted the data.frame, D, to a
>matrix A, and thence back to a data.frame B, and tried again, which worked as
>expected.  The conversion removed the attributes of D.  My question is:  why were
>the attributes inhibiting the fitting?
>
>In accordance with the usual R-help etiquette I first tried to contact the
>maintainer of the haven package, i.e. RStudio, which elicited the response: "since
>the error is occurring outside RStudio we?re not responsible, so try Stack
>Overflow".  This is pretty much what I would have expected from the capitalist
>running dogs they are.  Admittedly, the error is probably due to some unforeseen
>infelicity in my rqss() coding, but it does seem odd that attributes could have
>such a drastic  effect.  I would be most grateful for any insight the R commune
>might offer.
>
>#require(haven) # for reading dta file
>#Ddta <- read_dta(?foo.dta")
>#D <- with(Ddta, data.frame(y = access_merg, x = meannets_allhh, z = meanhh))
>#save(D, file = "D.Rda")
>con <- url("http://www.econ.uiuc.edu/~roger/research/data/D.Rda")
>load(con)
>
># If I purge the Stata attributes in D:
>A <- as.matrix(D)
>B <- as.data.frame(A)
>
># This works:
>with(D,plot(x, y, cex = .5, col = "grey"))
>taus <- 1:4/5
>require(quantreg)
>for(i in 1:length(taus)){
>    f <- rqss(y ~ qss(x, constraint = "I", lambda = 1), tau = taus[i], data = B)
>    plot(f, add = TRUE, col = i)
>}
># However, the same code with data = D, does not.  Why?

From ku|upp @end|ng |rom on||ne@de  Sat Apr 10 13:06:15 2021
From: ku|upp @end|ng |rom on||ne@de (Kulupp)
Date: Sat, 10 Apr 2021 13:06:15 +0200
Subject: [R] Comparing dates in two large data frames
Message-ID: <ff086c31-1feb-ec24-e16d-0ba2e5c50b9c@online.de>

Dear all,

I have two data frames (df1 and df2) and for each timepoint in df1 I 
want to know: is it whithin any of the timespans in df2? The result 
(e.g. "no" or "yes" or 0 and 1) should be shown in a new column of df1

Here is the code to create the two data frames (the size of the two data 
frames is approx. the same as in my original data frames):

# create data frame df1
ti1 <- seq.POSIXt(from=as.POSIXct("2020/01/01", tz="UTC"), 
to=as.POSIXct("2020/06/01", tz="UTC"), by="10 min")
df1 <- data.frame(Time=ti1)

# create data frame df2 with random timespans, i.e. start and end dates
start <- sort(sample(seq(as.POSIXct("2020/01/01", tz="UTC"), 
as.POSIXct("2020/06/01", tz="UTC"), by="1 mins"), 5000))
end?? <- start + 120
df2 <- data.frame(start=start, end=end)

Everything I tried (ifelse combined with sapply or for loops) has been 
very very very slow. Thus, I am looking for a reasonably fast solution.

Thanks a lot for any hint in advance !

Cheers,

Thomas


From rkoenker @end|ng |rom ||||no|@@edu  Sat Apr 10 13:12:25 2021
From: rkoenker @end|ng |rom ||||no|@@edu (Koenker, Roger W)
Date: Sat, 10 Apr 2021 11:12:25 +0000
Subject: [R] Stata/Rstudio evil attributes
In-Reply-To: <ee2a475c7d7244fbaaf8d2854006e64f@UM-MAIL3214.unimaas.nl>
References: <DC13D3BA-857E-45BC-A472-90E9B3CDCEDE@illinois.edu>
 <ee2a475c7d7244fbaaf8d2854006e64f@UM-MAIL3214.unimaas.nl>
Message-ID: <09546B8E-084D-4AED-8919-67E3FF43092C@illinois.edu>

Wolfgang,

Thanks, this is _extremely_ helpful.

Roger

> On Apr 10, 2021, at 11:59 AM, Viechtbauer, Wolfgang (SP) <wolfgang.viechtbauer at maastrichtuniversity.nl> wrote:
> 
> Dear Roger,
> 
> The problem is this. qss() looks like this:
> 
> if (is.matrix(x)) {
>   [...]
> }
> if (is.vector(x)) {
>   [...]
> }
> qss
> 
> Now let's check these if() statements:
> is.vector(B$x) # TRUE
> is.vector(D$x) # FALSE
> is.matrix(B$x) # FALSE
> is.matrix(D$x) # FALSE
> 
> is.vector(D$x) being FALSE may be surprising, but see ?is.vector: "is.vector returns TRUE if x is a vector of the specified mode having no attributes other than names. It returns FALSE otherwise." And as D$x shows, this vector has additional attributes.
> 
> So, with 'D', qss() returns the qss function (c.f., qss(B$x) and qss(D$x)) which makes no sense. So, the internal logic in qss() needs to be fixed.
> 
>> In accordance with the usual R-help etiquette I first tried to contact the
>> maintainer of the haven package, i.e. RStudio, which elicited the response: "since
>> the error is occurring outside RStudio we?re not responsible, so try Stack
>> Overflow".  This is pretty much what I would have expected from the capitalist
>> running dogs they are.  Admittedly, the error is probably due to some unforeseen
> 
> This kind of bashing is really silly. Can you tell us again how much you paid for the use of the haven package?
> 
> Best,
> Wolfgang
> 
>> -----Original Message-----
>> From: R-help [mailto:r-help-bounces at r-project.org] On Behalf Of Koenker, Roger W
>> Sent: Saturday, 10 April, 2021 11:26
>> To: r-help
>> Subject: [R] Stata/Rstudio evil attributes
>> 
>> As shown in the reproducible example below, I used the RStudio function haven() to
>> read a Stata .dta file, and then tried to do some fitting with the resulting
>> data.frame.  This produced an error from my fitting function rqss() in the package
>> quantreg.  After a bit of frustrated cursing, I converted the data.frame, D, to a
>> matrix A, and thence back to a data.frame B, and tried again, which worked as
>> expected.  The conversion removed the attributes of D.  My question is:  why were
>> the attributes inhibiting the fitting?
>> 
>> In accordance with the usual R-help etiquette I first tried to contact the
>> maintainer of the haven package, i.e. RStudio, which elicited the response: "since
>> the error is occurring outside RStudio we?re not responsible, so try Stack
>> Overflow".  This is pretty much what I would have expected from the capitalist
>> running dogs they are.  Admittedly, the error is probably due to some unforeseen
>> infelicity in my rqss() coding, but it does seem odd that attributes could have
>> such a drastic  effect.  I would be most grateful for any insight the R commune
>> might offer.
>> 
>> #require(haven) # for reading dta file
>> #Ddta <- read_dta(?foo.dta")
>> #D <- with(Ddta, data.frame(y = access_merg, x = meannets_allhh, z = meanhh))
>> #save(D, file = "D.Rda")
>> con <- url("http://www.econ.uiuc.edu/~roger/research/data/D.Rda")
>> load(con)
>> 
>> # If I purge the Stata attributes in D:
>> A <- as.matrix(D)
>> B <- as.data.frame(A)
>> 
>> # This works:
>> with(D,plot(x, y, cex = .5, col = "grey"))
>> taus <- 1:4/5
>> require(quantreg)
>> for(i in 1:length(taus)){
>>   f <- rqss(y ~ qss(x, constraint = "I", lambda = 1), tau = taus[i], data = B)
>>   plot(f, add = TRUE, col = i)
>> }
>> # However, the same code with data = D, does not.  Why?


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Sat Apr 10 14:47:01 2021
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Sat, 10 Apr 2021 13:47:01 +0100
Subject: [R] Comparing dates in two large data frames
In-Reply-To: <ff086c31-1feb-ec24-e16d-0ba2e5c50b9c@online.de>
References: <ff086c31-1feb-ec24-e16d-0ba2e5c50b9c@online.de>
Message-ID: <9b32be4c-ba64-d774-346b-a89f512df398@sapo.pt>

Hello,

The following solution seems to work and is fast, like findInterval is.
It first determines where in df2$start is each value of df1$Time. Then 
uses that index to see if those Times are not greater than the 
corresponding df$end.
I checked against a small subset of df1 and the results were right.


result <- logical(nrow(df1))
inx <- findInterval(df1$Time, df2$start)
not_zero <- inx != 0
result[not_zero] <- df1$Time[not_zero] <= df2$end[ inx[not_zero] ]


Hope this helps,

Rui Barradas


?s 12:06 de 10/04/21, Kulupp escreveu:
> Dear all,
> 
> I have two data frames (df1 and df2) and for each timepoint in df1 I 
> want to know: is it whithin any of the timespans in df2? The result 
> (e.g. "no" or "yes" or 0 and 1) should be shown in a new column of df1
> 
> Here is the code to create the two data frames (the size of the two data 
> frames is approx. the same as in my original data frames):
> 
> # create data frame df1
> ti1 <- seq.POSIXt(from=as.POSIXct("2020/01/01", tz="UTC"), 
> to=as.POSIXct("2020/06/01", tz="UTC"), by="10 min")
> df1 <- data.frame(Time=ti1)
> 
> # create data frame df2 with random timespans, i.e. start and end dates
> start <- sort(sample(seq(as.POSIXct("2020/01/01", tz="UTC"), 
> as.POSIXct("2020/06/01", tz="UTC"), by="1 mins"), 5000))
> end?? <- start + 120
> df2 <- data.frame(start=start, end=end)
> 
> Everything I tried (ifelse combined with sapply or for loops) has been 
> very very very slow. Thus, I am looking for a reasonably fast solution.
> 
> Thanks a lot for any hint in advance !
> 
> Cheers,
> 
> Thomas
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide 
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From wjm1 @end|ng |rom c@@@co|umb|@@edu  Sat Apr 10 18:20:11 2021
From: wjm1 @end|ng |rom c@@@co|umb|@@edu (William Michels)
Date: Sat, 10 Apr 2021 09:20:11 -0700
Subject: [R] Stata/Rstudio evil attributes
In-Reply-To: <09546B8E-084D-4AED-8919-67E3FF43092C@illinois.edu>
References: <DC13D3BA-857E-45BC-A472-90E9B3CDCEDE@illinois.edu>
 <ee2a475c7d7244fbaaf8d2854006e64f@UM-MAIL3214.unimaas.nl>
 <09546B8E-084D-4AED-8919-67E3FF43092C@illinois.edu>
Message-ID: <CAA99HCxRhQYWyEJZr0MAAT_Z5x33hd5wi1Bb3WvDBD72W376uQ@mail.gmail.com>

Hi Roger,

You could look at the attributes() function in base-R. See:

> ?attributes

>From the help-page:

> ## strip an object's attributes:
> attributes(x) <- NULL

HTH, Bill.

W. Michels, Ph.D.



On Sat, Apr 10, 2021 at 4:20 AM Koenker, Roger W <rkoenker at illinois.edu> wrote:
>
> Wolfgang,
>
> Thanks, this is _extremely_ helpful.
>
> Roger
>
> > On Apr 10, 2021, at 11:59 AM, Viechtbauer, Wolfgang (SP) <wolfgang.viechtbauer at maastrichtuniversity.nl> wrote:
> >
> > Dear Roger,
> >
> > The problem is this. qss() looks like this:
> >
> > if (is.matrix(x)) {
> >   [...]
> > }
> > if (is.vector(x)) {
> >   [...]
> > }
> > qss
> >
> > Now let's check these if() statements:
> > is.vector(B$x) # TRUE
> > is.vector(D$x) # FALSE
> > is.matrix(B$x) # FALSE
> > is.matrix(D$x) # FALSE
> >
> > is.vector(D$x) being FALSE may be surprising, but see ?is.vector: "is.vector returns TRUE if x is a vector of the specified mode having no attributes other than names. It returns FALSE otherwise." And as D$x shows, this vector has additional attributes.
> >
> > So, with 'D', qss() returns the qss function (c.f., qss(B$x) and qss(D$x)) which makes no sense. So, the internal logic in qss() needs to be fixed.
> >
> >> In accordance with the usual R-help etiquette I first tried to contact the
> >> maintainer of the haven package, i.e. RStudio, which elicited the response: "since
> >> the error is occurring outside RStudio we?re not responsible, so try Stack
> >> Overflow".  This is pretty much what I would have expected from the capitalist
> >> running dogs they are.  Admittedly, the error is probably due to some unforeseen
> >
> > This kind of bashing is really silly. Can you tell us again how much you paid for the use of the haven package?
> >
> > Best,
> > Wolfgang
> >
> >> -----Original Message-----
> >> From: R-help [mailto:r-help-bounces at r-project.org] On Behalf Of Koenker, Roger W
> >> Sent: Saturday, 10 April, 2021 11:26
> >> To: r-help
> >> Subject: [R] Stata/Rstudio evil attributes
> >>
> >> As shown in the reproducible example below, I used the RStudio function haven() to
> >> read a Stata .dta file, and then tried to do some fitting with the resulting
> >> data.frame.  This produced an error from my fitting function rqss() in the package
> >> quantreg.  After a bit of frustrated cursing, I converted the data.frame, D, to a
> >> matrix A, and thence back to a data.frame B, and tried again, which worked as
> >> expected.  The conversion removed the attributes of D.  My question is:  why were
> >> the attributes inhibiting the fitting?
> >>
> >> In accordance with the usual R-help etiquette I first tried to contact the
> >> maintainer of the haven package, i.e. RStudio, which elicited the response: "since
> >> the error is occurring outside RStudio we?re not responsible, so try Stack
> >> Overflow".  This is pretty much what I would have expected from the capitalist
> >> running dogs they are.  Admittedly, the error is probably due to some unforeseen
> >> infelicity in my rqss() coding, but it does seem odd that attributes could have
> >> such a drastic  effect.  I would be most grateful for any insight the R commune
> >> might offer.
> >>
> >> #require(haven) # for reading dta file
> >> #Ddta <- read_dta(?foo.dta")
> >> #D <- with(Ddta, data.frame(y = access_merg, x = meannets_allhh, z = meanhh))
> >> #save(D, file = "D.Rda")
> >> con <- url("http://www.econ.uiuc.edu/~roger/research/data/D.Rda")
> >> load(con)
> >>
> >> # If I purge the Stata attributes in D:
> >> A <- as.matrix(D)
> >> B <- as.data.frame(A)
> >>
> >> # This works:
> >> with(D,plot(x, y, cex = .5, col = "grey"))
> >> taus <- 1:4/5
> >> require(quantreg)
> >> for(i in 1:length(taus)){
> >>   f <- rqss(y ~ qss(x, constraint = "I", lambda = 1), tau = taus[i], data = B)
> >>   plot(f, add = TRUE, col = i)
> >> }
> >> # However, the same code with data = D, does not.  Why?
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From thebudget72 m@iii@g oii gm@ii@com  Sun Apr 11 05:48:46 2021
From: thebudget72 m@iii@g oii gm@ii@com (thebudget72 m@iii@g oii gm@ii@com)
Date: Sun, 11 Apr 2021 05:48:46 +0200
Subject: [R] Random Forest: OOB performance = test set performance?
Message-ID: <e570a236-641d-a218-e8d1-99487975586a@gmail.com>

Hi ML,

For random forest, I thought that the out-of-bag performance should be 
the same (or at least very similar) to the performance calculated on a 
separated test set.

But this does not seem to be the case.

In the following code, the accuracy computed on out-of-bag sample is 
77.81%, while the one computed on a separated test set is 81%.

Can you please check what I am doing wrong?

Thanks in advance and best regards.

library(randomForest)
library(ISLR)

Carseats$High <- ifelse(Carseats$Sales<=8,"No","Yes")
Carseats$High <- as.factor(Carseats$High)

train = sample(1:nrow(Carseats), 200)

rf = randomForest(High~.-Sales,
 ????????????????? data=Carseats,
 ????????????????? subset=train,
 ????????????????? mtry=6,
 ????????????????? importance=T)

acc <- (rf$confusion[1,1] + rf$confusion[2,2]) / sum(rf$confusion)
print(paste0("Accuracy OOB: ", round(acc*100,2), "%"))

yhat <- predict(rf, newdata=Carseats[-train,])
y <- Carseats[-train,]$High
conftest <- table(y, yhat)
acctest <- (conftest[1,1] + conftest[2,2]) / sum(conftest)
print(paste0("Accuracy test set: ", round(acctest*100,2), "%"))


From peter@|@ng|e|der @end|ng |rom gm@||@com  Sun Apr 11 06:34:40 2021
From: peter@|@ng|e|der @end|ng |rom gm@||@com (Peter Langfelder)
Date: Sat, 10 Apr 2021 21:34:40 -0700
Subject: [R] Random Forest: OOB performance = test set performance?
In-Reply-To: <e570a236-641d-a218-e8d1-99487975586a@gmail.com>
References: <e570a236-641d-a218-e8d1-99487975586a@gmail.com>
Message-ID: <CA+hbrhXU7rafkS42c08ic==+WPwf86W9Birs+r0WKA-2dk681A@mail.gmail.com>

I think the only thing you are doing wrong is not setting the random
seed (set.seed()) so your results are not reproducible. Depending on
the random sample used to select the training and test sets, you get
slightly varying accuracy for both, sometimes one is better and
sometimes the other.

HTH,

Peter

On Sat, Apr 10, 2021 at 8:49 PM <thebudget72 at gmail.com> wrote:
>
> Hi ML,
>
> For random forest, I thought that the out-of-bag performance should be
> the same (or at least very similar) to the performance calculated on a
> separated test set.
>
> But this does not seem to be the case.
>
> In the following code, the accuracy computed on out-of-bag sample is
> 77.81%, while the one computed on a separated test set is 81%.
>
> Can you please check what I am doing wrong?
>
> Thanks in advance and best regards.
>
> library(randomForest)
> library(ISLR)
>
> Carseats$High <- ifelse(Carseats$Sales<=8,"No","Yes")
> Carseats$High <- as.factor(Carseats$High)
>
> train = sample(1:nrow(Carseats), 200)
>
> rf = randomForest(High~.-Sales,
>                    data=Carseats,
>                    subset=train,
>                    mtry=6,
>                    importance=T)
>
> acc <- (rf$confusion[1,1] + rf$confusion[2,2]) / sum(rf$confusion)
> print(paste0("Accuracy OOB: ", round(acc*100,2), "%"))
>
> yhat <- predict(rf, newdata=Carseats[-train,])
> y <- Carseats[-train,]$High
> conftest <- table(y, yhat)
> acctest <- (conftest[1,1] + conftest[2,2]) / sum(conftest)
> print(paste0("Accuracy test set: ", round(acctest*100,2), "%"))
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From @tyen @end|ng |rom ntu@edu@tw  Sun Apr 11 12:00:58 2021
From: @tyen @end|ng |rom ntu@edu@tw (Steven Yen)
Date: Sun, 11 Apr 2021 18:00:58 +0800
Subject: [R] Identifying column type
In-Reply-To: <e9d0a692-a431-db36-6d50-1cee04c7d3a2@sapo.pt>
References: <e9d0a692-a431-db36-6d50-1cee04c7d3a2@sapo.pt>
Message-ID: <966320B1-E776-4EC3-AA8D-5A5B0A7A02F2@ntu.edu.tw>

Thanks. Great idea!

Sent from my iPhone
Beware: My autocorrect is crazy

> On Apr 10, 2021, at 1:37 PM, Rui Barradas <ruipbarradas at sapo.pt> wrote:
> 
> ?Hello,
> 
> Maybe something like
> 
> 
> ok <- sapply(mydata, is.numeric)
> mydata <- mydata[ok]
> 
> 
> to keep the numeric columns only.
> 
> 
> Hope this helps,
> 
> Rui Barradas
> 
> ?s 04:25 de 10/04/21, Steven Yen escreveu:
>> I have data of mixed types in a data frame - date and numeric, as shown
>> in summary below. How do I identify the column(s) that is/are not
>> numeric, in this case, the first. All I want is to identify the
>> column(s) and so that I can remove it/them from the data frame Thanks.
>>> summary(mydata)
>> Date Spot Futures Min. :1997-09-01 00:00:00 Min. : 735.1 Min. : 734.2
>> 1st Qu.:2002-10-16 12:00:00 1st Qu.:1120.7 1st Qu.:1122.6 Median
>> :2007-12-01 00:00:00 Median :1301.8 Median :1303.2 Mean :2007-12-01
>> 06:01:27 Mean :1423.1 Mean :1423.6 3rd Qu.:2013-01-16 12:00:00 3rd
>> Qu.:1540.0 3rd Qu.:1546.5 Max. :2018-03-01 00:00:00 Max. :2823.8 Max.
>> :2825.8
>>    [[alternative HTML version deleted]]
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.


From therne@u @end|ng |rom m@yo@edu  Sat Apr 10 16:12:10 2021
From: therne@u @end|ng |rom m@yo@edu (Therneau, Terry M., Ph.D.)
Date: Sat, 10 Apr 2021 09:12:10 -0500
Subject: [R] evil attributes
Message-ID: <9b53cf$fog2pq@ironport10.mayo.edu>

I wrote: "I confess to being puzzled WHY the R core has decided on this definition..."
After just a little more thought let me answer my own question.

a. The as.vector() function is designed to strip off everything extraneous and leave just 
the core.?? (I have a mental image of Jack Webb saying "Just the facts ma'am"). ? I myself 
use it freqently in the test suite for survival, in cases where I'm checking the corrent 
numeric result and don't care about any attached names.

 ?b. is.vector(x) essentially answers the question "does x look like a result of as.vector?"

Nevertheless I understand Roger's confusion.

-- 
Terry M Therneau, PhD
Department of Quantitative Health Sciences
Mayo Clinic
therneau at mayo.edu

"TERR-ree THUR-noh"


	[[alternative HTML version deleted]]


From r@hep@rd @end|ng |rom @pp|-eco@y@@com  Sun Apr 11 18:09:39 2021
From: r@hep@rd @end|ng |rom @pp|-eco@y@@com (Rich Shepard)
Date: Sun, 11 Apr 2021 09:09:39 -0700 (PDT)
Subject: [R] updating OpenMx failed
Message-ID: <alpine.LNX.2.20.2104110907110.5793@salmo.appl-ecosys.com>

I'm running Slackware-14.2/x86_64 and R-4.0.2-x86_64-1_SBo.

Updating OpenMx failed:
omxState.cpp:1230:82:   required from here
omxState.cpp:1229:17: error: cannot call member function ?void ConstraintVec::eval(FitContext*, double*, double*)? without object
                  eval(fc2, result.data(), 0);
                  ^
/usr/lib64/R/etc/Makeconf:174: recipe for target 'omxState.o' failed
make: *** [omxState.o] Error 1
ERROR: compilation failed for package ?OpenMx?
* removing ?/usr/lib64/R/library/OpenMx?
* restoring previous ?/usr/lib64/R/library/OpenMx?

The downloaded source packages are in
 	?/tmp/Rtmp9jMe61/downloaded_packages?
Updating HTML index of packages in '.Library'
Making 'packages.html' ... done
Warning message:
In install.packages("OpenMx") :
   installation of package ?OpenMx? had non-zero exit status

Please advise,

Rich


From wo||g@ng@v|echtb@uer @end|ng |rom m@@@tr|chtun|ver@|ty@n|  Sun Apr 11 20:46:02 2021
From: wo||g@ng@v|echtb@uer @end|ng |rom m@@@tr|chtun|ver@|ty@n| (Viechtbauer, Wolfgang (SP))
Date: Sun, 11 Apr 2021 18:46:02 +0000
Subject: [R] evil attributes
In-Reply-To: <9b53cf$fog2pq@ironport10.mayo.edu>
References: <9b53cf$fog2pq@ironport10.mayo.edu>
Message-ID: <5f9a76951df14574ac610967c586b477@UM-MAIL3214.unimaas.nl>

The is.vector() thing has also bitten me in the behind on a few occasions. When I want to check if something is a vector, allow for it to possibly have some additional attributes (besides names) that would make is.vector() evaluate to FALSE, but evaluate to FALSE for lists (since is.vector(list(a=1, b=2)) is TRUE -- which also wasn't what I had initially expected before reading the documentation), I use:

.is.vector <- function(x)
   is.atomic(x) && !is.matrix(x) && !is.null(x)

This might also work:

.is.vector <- function(x)
   is(x, "vector") && !is.list(x)

I am sure there are all kinds of edge (and probably also not so edge) cases where these also fail to work properly. Kinda curious if there are better approaches out there.

Best,
Wolfgang

>-----Original Message-----
>From: R-help [mailto:r-help-bounces at r-project.org] On Behalf Of Therneau, Terry
>M., Ph.D. via R-help
>Sent: Saturday, 10 April, 2021 16:12
>To: R-help
>Subject: Re: [R] evil attributes
>
>I wrote: "I confess to being puzzled WHY the R core has decided on this
>definition..."
>After just a little more thought let me answer my own question.
>
>a. The as.vector() function is designed to strip off everything extraneous and
>leave just
>the core.?? (I have a mental image of Jack Webb saying "Just the facts
>ma'am"). ? I myself
>use it freqently in the test suite for survival, in cases where I'm checking the
>corrent
>numeric result and don't care about any attached names.
>
> ?b. is.vector(x) essentially answers the question "does x look like a result of
>as.vector?"
>
>Nevertheless I understand Roger's confusion.
>
>--
>Terry M Therneau, PhD
>Department of Quantitative Health Sciences
>Mayo Clinic
>therneau at mayo.edu
>
>"TERR-ree THUR-noh"

From dw|n@em|u@ @end|ng |rom comc@@t@net  Sun Apr 11 23:06:42 2021
From: dw|n@em|u@ @end|ng |rom comc@@t@net (David Winsemius)
Date: Sun, 11 Apr 2021 14:06:42 -0700
Subject: [R] evil attributes
In-Reply-To: <5f9a76951df14574ac610967c586b477@UM-MAIL3214.unimaas.nl>
References: <9b53cf$fog2pq@ironport10.mayo.edu>
 <5f9a76951df14574ac610967c586b477@UM-MAIL3214.unimaas.nl>
Message-ID: <936407c3-4a56-9827-c0d9-2f88e7986f8b@comcast.net>


On 4/11/21 11:46 AM, Viechtbauer, Wolfgang (SP) wrote:
> The is.vector() thing has also bitten me in the behind on a few occasions. When I want to check if something is a vector, allow for it to possibly have some additional attributes (besides names) that would make is.vector() evaluate to FALSE, but evaluate to FALSE for lists (since is.vector(list(a=1, b=2)) is TRUE -- which also wasn't what I had initially expected before reading the documentation), I use:
>
> .is.vector <- function(x)
>     is.atomic(x) && !is.matrix(x) && !is.null(x)
>
> This might also work:
>
> .is.vector <- function(x)
>     is(x, "vector") && !is.list(x)

That will allow expression vectors to return TRUE, but they are not 
atomic so they would be excluded by your current version.

-- 

David.

>
> I am sure there are all kinds of edge (and probably also not so edge) cases where these also fail to work properly. Kinda curious if there are better approaches out there.


You might want to exclude expression vectors as well.



> Best,
> Wolfgang
>
>> -----Original Message-----
>> From: R-help [mailto:r-help-bounces at r-project.org] On Behalf Of Therneau, Terry
>> M., Ph.D. via R-help
>> Sent: Saturday, 10 April, 2021 16:12
>> To: R-help
>> Subject: Re: [R] evil attributes
>>
>> I wrote: "I confess to being puzzled WHY the R core has decided on this
>> definition..."
>> After just a little more thought let me answer my own question.
>>
>> a. The as.vector() function is designed to strip off everything extraneous and
>> leave just
>> the core.?? (I have a mental image of Jack Webb saying "Just the facts
>> ma'am"). ? I myself
>> use it freqently in the test suite for survival, in cases where I'm checking the
>> corrent
>> numeric result and don't care about any attached names.
>>
>>  ?b. is.vector(x) essentially answers the question "does x look like a result of
>> as.vector?"
>>
>> Nevertheless I understand Roger's confusion.
>>
>> --
>> Terry M Therneau, PhD
>> Department of Quantitative Health Sciences
>> Mayo Clinic
>> therneau at mayo.edu
>>
>> "TERR-ree THUR-noh"
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From tr@xp|@yer @end|ng |rom gm@||@com  Sun Apr 11 23:55:12 2021
From: tr@xp|@yer @end|ng |rom gm@||@com (=?UTF-8?Q?Martin_M=C3=B8ller_Skarbiniks_Pedersen?=)
Date: Sun, 11 Apr 2021 23:55:12 +0200
Subject: [R] updating OpenMx failed
In-Reply-To: <alpine.LNX.2.20.2104110907110.5793@salmo.appl-ecosys.com>
References: <alpine.LNX.2.20.2104110907110.5793@salmo.appl-ecosys.com>
Message-ID: <CAGAA5bdP+dMP0cEr=_GdcDbAtsvrHx1XMi1EmNx=WYc-z04XCA@mail.gmail.com>

On Sun, 11 Apr 2021 at 18:10, Rich Shepard <rshepard at appl-ecosys.com> wrote:
>
> I'm running Slackware-14.2/x86_64 and R-4.0.2-x86_64-1_SBo.
>
> Updating OpenMx failed:
> omxState.cpp:1230:82:   required from here
> omxState.cpp:1229:17: error: cannot call member function ?void
ConstraintVec::eval(FitContext*, double*, double*)? without object
>                   eval(fc2, result.data(), 0);
>                   ^

[...]

> Please advise,

You should contact the maintainers of the package.
According to this page:
https://cran.r-project.org/web/packages/OpenMx/index.html
you can get help from http://openmx.ssri.psu.edu/forums

Regards
Martin

	[[alternative HTML version deleted]]


From r@hep@rd @end|ng |rom @pp|-eco@y@@com  Mon Apr 12 00:30:50 2021
From: r@hep@rd @end|ng |rom @pp|-eco@y@@com (Rich Shepard)
Date: Sun, 11 Apr 2021 15:30:50 -0700 (PDT)
Subject: [R] updating OpenMx failed
In-Reply-To: <CAGAA5bdP+dMP0cEr=_GdcDbAtsvrHx1XMi1EmNx=WYc-z04XCA@mail.gmail.com>
References: <alpine.LNX.2.20.2104110907110.5793@salmo.appl-ecosys.com>
 <CAGAA5bdP+dMP0cEr=_GdcDbAtsvrHx1XMi1EmNx=WYc-z04XCA@mail.gmail.com>
Message-ID: <alpine.LNX.2.20.2104111529560.5793@salmo.appl-ecosys.com>

On Sun, 11 Apr 2021, Martin M?ller Skarbiniks Pedersen wrote:

> You should contact the maintainers of the package.
> According to this page:
> https://cran.r-project.org/web/packages/OpenMx/index.html
> you can get help from http://openmx.ssri.psu.edu/forums

Martin,

You're correct. I should have looked up the maintainer and directly
contacted them. I'll do so.

Regards,

Rich


From murdoch@dunc@n @end|ng |rom gm@||@com  Mon Apr 12 01:57:53 2021
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Sun, 11 Apr 2021 19:57:53 -0400
Subject: [R] evil attributes
In-Reply-To: <5f9a76951df14574ac610967c586b477@UM-MAIL3214.unimaas.nl>
References: <9b53cf$fog2pq@ironport10.mayo.edu>
 <5f9a76951df14574ac610967c586b477@UM-MAIL3214.unimaas.nl>
Message-ID: <32a40d2c-2472-eaf8-2542-3d57295500ea@gmail.com>

On 11/04/2021 2:46 p.m., Viechtbauer, Wolfgang (SP) wrote:
> The is.vector() thing has also bitten me in the behind on a few occasions. When I want to check if something is a vector, allow for it to possibly have some additional attributes (besides names) that would make is.vector() evaluate to FALSE, but evaluate to FALSE for lists (since is.vector(list(a=1, b=2)) is TRUE -- which also wasn't what I had initially expected before reading the documentation), I use:
> 
> .is.vector <- function(x)
>     is.atomic(x) && !is.matrix(x) && !is.null(x)
> 
> This might also work:
> 
> .is.vector <- function(x)
>     is(x, "vector") && !is.list(x)
> 
> I am sure there are all kinds of edge (and probably also not so edge) cases where these also fail to work properly. Kinda curious if there are better approaches out there.

Sorry, but nobody has said what "properly" would be here.  How can an 
approach be better at something if you don't say what you want it to do?

The base::is.vector() definition looks fairly useless, and I can't 
remember ever using that function.  But at least it's quite well 
documented what it is supposed to do.  What claims are you making about 
your .is.vector() definitions?

Duncan Murdoch


From w||||@mwdun|@p @end|ng |rom gm@||@com  Mon Apr 12 02:44:47 2021
From: w||||@mwdun|@p @end|ng |rom gm@||@com (Bill Dunlap)
Date: Sun, 11 Apr 2021 17:44:47 -0700
Subject: [R] evil attributes
In-Reply-To: <9b53cf$fog2pq@ironport10.mayo.edu>
References: <9b53cf$fog2pq@ironport10.mayo.edu>
Message-ID: <CAHqSRuQzVkd1H9ZUW1bTYTGmuxOS3jpVk5eAuS0yd4rxyPBo4g@mail.gmail.com>

Terry wrote
           I confess to being puzzled WHY the R core has decided on this
definition [of vector] ...
I believe that "R core" followed S's definition of "vector".  From the
beginning (at least when I first saw it in 1981) an S vector was the basic
unit of an S object - it had a type and a length and no more.  This has
little to do with the mathematician's or physicist's notion of a vector.
It is more like what Technopedia (
https://www.techopedia.com/definition/22817/vector-programming) says is a
programmer's notion of a vector:

What Does Vector Mean?
A vector, in programming, is a type of array that is one dimensional.
Vectors are a logical element in programming languages that are used for
storing data. Vectors are similar to arrays but their actual implementation
and operation differs.
Techopedia Explains Vector
Vectors are primarily used within the programming context of most
programming languages and serve as data structure containers. Being a data
structure, vectors are used for storing objects and collections of objects
in an organized structure.
The major difference between and array and a vector is that, unlike typical
arrays, the container size of a vector can be easily increased and
decreased to complement different data storage types. Vectors have a
dynamic structure and provide the ability to assign container size up front
and enable allocation of memory space quickly. Vectors can be thought of as
dynamic arrays.

-Bill


On Sun, Apr 11, 2021 at 8:04 AM Therneau, Terry M., Ph.D. via R-help <
r-help at r-project.org> wrote:

> I wrote: "I confess to being puzzled WHY the R core has decided on this
> definition..."
> After just a little more thought let me answer my own question.
>
> a. The as.vector() function is designed to strip off everything extraneous
> and leave just
> the core.   (I have a mental image of Jack Webb saying "Just the facts
> ma'am").   I myself
> use it freqently in the test suite for survival, in cases where I'm
> checking the corrent
> numeric result and don't care about any attached names.
>
>   b. is.vector(x) essentially answers the question "does x look like a
> result of as.vector?"
>
> Nevertheless I understand Roger's confusion.
>
> --
> Terry M Therneau, PhD
> Department of Quantitative Health Sciences
> Mayo Clinic
> therneau at mayo.edu
>
> "TERR-ree THUR-noh"
>
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From thebudget72 m@iii@g oii gm@ii@com  Mon Apr 12 02:49:53 2021
From: thebudget72 m@iii@g oii gm@ii@com (thebudget72 m@iii@g oii gm@ii@com)
Date: Mon, 12 Apr 2021 02:49:53 +0200
Subject: [R] Random Forest: OOB performance = test set performance?
In-Reply-To: <CA+hbrhXU7rafkS42c08ic==+WPwf86W9Birs+r0WKA-2dk681A@mail.gmail.com>
References: <e570a236-641d-a218-e8d1-99487975586a@gmail.com>
 <CA+hbrhXU7rafkS42c08ic==+WPwf86W9Birs+r0WKA-2dk681A@mail.gmail.com>
Message-ID: <ad2e37ca-8cd8-cf13-5c45-0d7e41cdde1b@gmail.com>

Thanks Peter.

Indeed by setting a seed the two results are similar.

I am self-studying and wanted to make sure I understood the concept of 
OOB samples and how much "reliable" were performance metrics calculated 
on them.

It seems I did got it. That's good :)

On 4/11/21 6:34 AM, Peter Langfelder wrote:
> I think the only thing you are doing wrong is not setting the random
> seed (set.seed()) so your results are not reproducible. Depending on
> the random sample used to select the training and test sets, you get
> slightly varying accuracy for both, sometimes one is better and
> sometimes the other.
>
> HTH,
>
> Peter
>
> On Sat, Apr 10, 2021 at 8:49 PM<thebudget72 at gmail.com>  wrote:
>> Hi ML,
>>
>> For random forest, I thought that the out-of-bag performance should be
>> the same (or at least very similar) to the performance calculated on a
>> separated test set.
>>
>> But this does not seem to be the case.
>>
>> In the following code, the accuracy computed on out-of-bag sample is
>> 77.81%, while the one computed on a separated test set is 81%.
>>
>> Can you please check what I am doing wrong?
>>
>> Thanks in advance and best regards.
>>
>> library(randomForest)
>> library(ISLR)
>>
>> Carseats$High <- ifelse(Carseats$Sales<=8,"No","Yes")
>> Carseats$High <- as.factor(Carseats$High)
>>
>> train = sample(1:nrow(Carseats), 200)
>>
>> rf = randomForest(High~.-Sales,
>>                     data=Carseats,
>>                     subset=train,
>>                     mtry=6,
>>                     importance=T)
>>
>> acc <- (rf$confusion[1,1] + rf$confusion[2,2]) / sum(rf$confusion)
>> print(paste0("Accuracy OOB: ", round(acc*100,2), "%"))
>>
>> yhat <- predict(rf, newdata=Carseats[-train,])
>> y <- Carseats[-train,]$High
>> conftest <- table(y, yhat)
>> acctest <- (conftest[1,1] + conftest[2,2]) / sum(conftest)
>> print(paste0("Accuracy test set: ", round(acctest*100,2), "%"))
>>
>> ______________________________________________
>> R-help at r-project.org  mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guidehttp://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.


From tr@xp|@yer @end|ng |rom gm@||@com  Mon Apr 12 11:17:50 2021
From: tr@xp|@yer @end|ng |rom gm@||@com (=?UTF-8?Q?Martin_M=C3=B8ller_Skarbiniks_Pedersen?=)
Date: Mon, 12 Apr 2021 11:17:50 +0200
Subject: [R] updating OpenMx failed
In-Reply-To: <alpine.LNX.2.20.2104111529560.5793@salmo.appl-ecosys.com>
References: <alpine.LNX.2.20.2104110907110.5793@salmo.appl-ecosys.com>
 <CAGAA5bdP+dMP0cEr=_GdcDbAtsvrHx1XMi1EmNx=WYc-z04XCA@mail.gmail.com>
 <alpine.LNX.2.20.2104111529560.5793@salmo.appl-ecosys.com>
Message-ID: <CAGAA5bcR51Y2mX7RWtsOBpm5Az2eLfEf1s5e61K_ru=kLExPMA@mail.gmail.com>

btw. I installed without problems OpenMx on a xubuntu 20.10 running R 4.0.5.

Are your gcc toolchain up to date?


On Mon, Apr 12, 2021, 00:31 Rich Shepard <rshepard at appl-ecosys.com> wrote:

> On Sun, 11 Apr 2021, Martin M?ller Skarbiniks Pedersen wrote:
>
> > You should contact the maintainers of the package.
> > According to this page:
> > https://cran.r-project.org/web/packages/OpenMx/index.html
> > you can get help from http://openmx.ssri.psu.edu/forums
>
> Martin,
>
> You're correct. I should have looked up the maintainer and directly
> contacted them. I'll do so.
>
> Regards,
>
> Rich

	[[alternative HTML version deleted]]


From wo||g@ng@v|echtb@uer @end|ng |rom m@@@tr|chtun|ver@|ty@n|  Mon Apr 12 14:09:13 2021
From: wo||g@ng@v|echtb@uer @end|ng |rom m@@@tr|chtun|ver@|ty@n| (Viechtbauer, Wolfgang (SP))
Date: Mon, 12 Apr 2021 12:09:13 +0000
Subject: [R] evil attributes
In-Reply-To: <32a40d2c-2472-eaf8-2542-3d57295500ea@gmail.com>
References: <9b53cf$fog2pq@ironport10.mayo.edu>
 <5f9a76951df14574ac610967c586b477@UM-MAIL3214.unimaas.nl>
 <32a40d2c-2472-eaf8-2542-3d57295500ea@gmail.com>
Message-ID: <9e10b5eb0fbb4355b1dec348ab5f81e3@UM-MAIL3214.unimaas.nl>

>-----Original Message-----
>From: Duncan Murdoch [mailto:murdoch.duncan at gmail.com]
>Sent: Monday, 12 April, 2021 1:58
>To: Viechtbauer, Wolfgang (SP); R-help
>Subject: Re: [R] evil attributes
>
>On 11/04/2021 2:46 p.m., Viechtbauer, Wolfgang (SP) wrote:
>> The is.vector() thing has also bitten me in the behind on a few occasions. When
>I want to check if something is a vector, allow for it to possibly have some
>additional attributes (besides names) that would make is.vector() evaluate to
>FALSE, but evaluate to FALSE for lists (since is.vector(list(a=1, b=2)) is TRUE --
>which also wasn't what I had initially expected before reading the documentation),
>I use:
>>
>> .is.vector <- function(x)
>>     is.atomic(x) && !is.matrix(x) && !is.null(x)
>>
>> This might also work:
>>
>> .is.vector <- function(x)
>>     is(x, "vector") && !is.list(x)
>>
>> I am sure there are all kinds of edge (and probably also not so edge) cases
>where these also fail to work properly. Kinda curious if there are better
>approaches out there.
>
>Sorry, but nobody has said what "properly" would be here.  How can an
>approach be better at something if you don't say what you want it to do?
>
>The base::is.vector() definition looks fairly useless, and I can't
>remember ever using that function.  But at least it's quite well
>documented what it is supposed to do.  What claims are you making about
>your .is.vector() definitions?
>
>Duncan Murdoch

I only suggested a possible way of identifying vectors which is a bit more in line with the definition Bill described in his post (and which avoids the problem that Roger initially ran into that additional attributes make is.vector() evaluate to FALSE). It's not better than is.vector(), which is well documented as to what it does, and which has a different purpose. But I occasionally need to identify vectors (in the former sense) and was curious if there are other/better ways of doing so.

Best,
Wolfgang

From dr@@|@m@o|@ng| @end|ng |rom gm@||@com  Mon Apr 12 14:21:14 2021
From: dr@@|@m@o|@ng| @end|ng |rom gm@||@com (Shah Alam)
Date: Mon, 12 Apr 2021 14:21:14 +0200
Subject: [R] LHS random number generator
Message-ID: <CA+bivFg5WFxZis_aYgg+5+kZZZ7x+UgGvy94tDaK0QR8mVJfjw@mail.gmail.com>

Hello everyone,

I am using the LHS package to generate a combination of a
set of parameter values. However, I am not sure how to fix some parameter
values to 2 decimal points.
For example:

I want to make combinations in such a way that values for parameter
c("lmp", 0.40, 0.43) are taken as 0.40, 0.41, 0.42,0.43.

My codes are:

prior_lhs <- list(c("r_mu", 0.00299, 0.0032),
                  c("r_sd", 0.001, 0.002),
                  c("lmp", 0.40, 0.43),
                  c("gr_mu", 0.14, 0.16),
                  c("gr_sd", 0.01, 0.020),
                  c("alpha1", 0.0001, 0.0018),
                  c("alpha2", 0.0017, 0.0028),
                  c("alpha3", 0.005, 0.009),
                  c("beta", 0.69, 0.75)
)


### Simulation with priors from LHS ####
nb_simul <- 10000
nparam <- length(prior_lhs)
random_tab = randomLHS(nb_simul, nparam)
lhs_index = 1
param <- matrix(rep(0, nparam), nrow = 1, ncol = nparam)

for (i in 1:nb_simul) {
  temp_par <- matrix(rep(0, nparam), nrow = 1, ncol = nparam)
  for (j in 1:nparam) {
    temp_par[j] = as.numeric(prior_lhs[[j]][2]) +
      (as.numeric(prior_lhs[[j]][3]) - as.numeric(prior_lhs[[j]][2])) *
random_tab[lhs_index, j]
  }
  param <- rbind(param, temp_par)
  lhs_index <- lhs_index+1
}
param <- param[-1,]

Best regards,
Shah

	[[alternative HTML version deleted]]


From rmh @end|ng |rom temp|e@edu  Mon Apr 12 18:56:44 2021
From: rmh @end|ng |rom temp|e@edu (Richard M. Heiberger)
Date: Mon, 12 Apr 2021 16:56:44 +0000
Subject: [R] [External]  LHS random number generator
In-Reply-To: <CA+bivFg5WFxZis_aYgg+5+kZZZ7x+UgGvy94tDaK0QR8mVJfjw@mail.gmail.com>
References: <CA+bivFg5WFxZis_aYgg+5+kZZZ7x+UgGvy94tDaK0QR8mVJfjw@mail.gmail.com>
Message-ID: <F7B21031-41A4-46BF-AE6A-3B159AA05B52@temple.edu>

I don't know the LHS package.  I don't see it on CRAN as either LHS, or more likely, as lhs (lower case).
When you write back to the list, using plain text, not HTML, please state where the LHS package is located.

I do see several potential problems.

You use a function randomLHS without first loading the package with a call something like
library(LHS)


Your use of the c() function turns the numbers into characters.  There is no indication
that you want to increment in units of .01:
> c("lmp", 0.40, 0.43)
[1] "lmp"  "0.4"  "0.43"



Explicit use of seq doesn't get what you are looking for.  Numbers in R (and most computer
programs) are binary and the representation in only a few decimal places is rounded. Thus:
> print(seq(.40, .43, .01), digits=17)
[1] 0.40000000000000002 0.41000000000000003 0.42000000000000004
[4] 0.42999999999999999


see FAQ 7.31 for discussion of number representations.
https://cran.r-project.org/doc/FAQ/R-FAQ.html#Why-doesn_0027t-R-think-these-numbers-are-equal_003f



> On Apr 12, 2021, at 08:21, Shah Alam <dr.alamsolangi at gmail.com> wrote:
> 
> Hello everyone,
> 
> I am using the LHS package to generate a combination of a
> set of parameter values. However, I am not sure how to fix some parameter
> values to 2 decimal points.
> For example:
> 
> I want to make combinations in such a way that values for parameter
> c("lmp", 0.40, 0.43) are taken as 0.40, 0.41, 0.42,0.43.
> 
> My codes are:
> 
> prior_lhs <- list(c("r_mu", 0.00299, 0.0032),
>                  c("r_sd", 0.001, 0.002),
>                  c("lmp", 0.40, 0.43),
>                  c("gr_mu", 0.14, 0.16),
>                  c("gr_sd", 0.01, 0.020),
>                  c("alpha1", 0.0001, 0.0018),
>                  c("alpha2", 0.0017, 0.0028),
>                  c("alpha3", 0.005, 0.009),
>                  c("beta", 0.69, 0.75)
> )
> 
> 
> ### Simulation with priors from LHS ####
> nb_simul <- 10000
> nparam <- length(prior_lhs)
> random_tab = randomLHS(nb_simul, nparam)
> lhs_index = 1
> param <- matrix(rep(0, nparam), nrow = 1, ncol = nparam)
> 
> for (i in 1:nb_simul) {
>  temp_par <- matrix(rep(0, nparam), nrow = 1, ncol = nparam)
>  for (j in 1:nparam) {
>    temp_par[j] = as.numeric(prior_lhs[[j]][2]) +
>      (as.numeric(prior_lhs[[j]][3]) - as.numeric(prior_lhs[[j]][2])) *
> random_tab[lhs_index, j]
>  }
>  param <- rbind(param, temp_par)
>  lhs_index <- lhs_index+1
> }
> param <- param[-1,]
> 
> Best regards,
> Shah
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From m@hmood@n@der@n @end|ng |rom ugent@be  Mon Apr 12 22:01:18 2021
From: m@hmood@n@der@n @end|ng |rom ugent@be (Mahmood Naderan-Tahan)
Date: Mon, 12 Apr 2021 20:01:18 +0000
Subject: [R] Weighted violin chart
Message-ID: <d4cb0b32817c43c699baed56f71bc2ad@ugent.be>

Hi,

I would like to know if it is possible to plot a weighted violin chart with R. Currently, I have


> library(ggplot2)
> mydata <- read.csv('test.csv', header=T,row.names=1)
> mydata
     V1 V2 V3
P1 73.6 50  R
P2 75.2 20  R
P3  6.5  5  R
P4 41.4 10  C
P5  5.4 10  C
P6 18.8  5  C
> p <- ggplot(mydata, aes(x=V3, y=V1)) + geom_violin(trim=FALSE)
> p + geom_dotplot(binaxis='y', stackdir='center', dotsize=1)

I would like to use V2 as the weight vector. Any idea about that?



Regards,
Mahmood

	[[alternative HTML version deleted]]


From chr|@ho|d @end|ng |rom p@yctc@org  Tue Apr 13 08:32:55 2021
From: chr|@ho|d @end|ng |rom p@yctc@org (Chris Evans)
Date: Tue, 13 Apr 2021 07:32:55 +0100 (BST)
Subject: [R] Weighted violin chart
In-Reply-To: <d4cb0b32817c43c699baed56f71bc2ad@ugent.be>
References: <d4cb0b32817c43c699baed56f71bc2ad@ugent.be>
Message-ID: <1679959036.7318104.1618295575104.JavaMail.zimbra@psyctc.org>



----- Original Message -----
> From: "Mahmood Naderan-Tahan" <mahmood.naderan at ugent.be>
> To: r-help at r-project.org
> Sent: Monday, 12 April, 2021 21:01:18
> Subject: [R] Weighted violin chart

> Hi,
> 
> I would like to know if it is possible to plot a weighted violin chart with R.
> Currently, I have
> 
> 
>> library(ggplot2)
>> mydata <- read.csv('test.csv', header=T,row.names=1)
>> mydata
>     V1 V2 V3
> P1 73.6 50  R
> P2 75.2 20  R
> P3  6.5  5  R
> P4 41.4 10  C
> P5  5.4 10  C
> P6 18.8  5  C
>> p <- ggplot(mydata, aes(x=V3, y=V1)) + geom_violin(trim=FALSE)
>> p + geom_dotplot(binaxis='y', stackdir='center', dotsize=1)
> 
> I would like to use V2 as the weight vector. Any idea about that?
> 
> 
> 
> Regards,
> Mahmood

There are, of course, nice ways to do this using base R but I am trying to convert to using tidyverse. 
Here is one:

### use tribble to create a tibble rowwise
tribble(
  ~V1, ~V2, ~V3,
  73.6, 50, "R",
  75.2, 20, "R",
  6.5, 5, "R",
  41.4, 10, "C",
  5.4, 10, "C",
  18.8, 5, "C") -> myData

### use tidyr::uncount() to get to the data you want
myData %>%
  uncount(V2) -> tibWtdMyData

### plot it 
ggplot(tibWtdMyData, 
       aes(x=V3, y=V1)) + 
  geom_violin(trim=FALSE) +
  geom_dotplot(binaxis='y', stackdir='center', dotsize=1)

Of course, with so many identical values, I'm not sure a violin plot makes sense but perhaps you 
were showing us a small subset of your data.

I have a nasty feeling there is a way of weighting things within ggplot.  If so, I am sure someone
will tell us.

For future, it's much easier for us to reply if you put small bits of data like your myData into
your Email using dput.  The output from dput doesn't look terribly human friendly but unless it 
is mangled by HTML Emailing, it is wonderfully human friendly to use!

Very best (all),

Chris


-- 
Chris Evans (he/him) <chris at psyctc.org> Visiting Professor, University of Sheffield <chris.evans at sheffield.ac.uk>
I do some consultation work for the University of Roehampton <chris.evans at roehampton.ac.uk> and other places
but <chris at psyctc.org> remains my main Email address.  I have a work web site at:
   https://www.psyctc.org/psyctc/
and a site I manage for CORE and CORE system trust at:
   http://www.coresystemtrust.org.uk/
I have "semigrated" to France, see: 
   https://www.psyctc.org/pelerinage2016/semigrating-to-france/ 
   https://www.psyctc.org/pelerinage2016/register-to-get-updates-from-pelerinage2016/

If you want an Emeeting, I am trying to keep them to Thursdays and my diary is at:
   https://www.psyctc.org/pelerinage2016/ceworkdiary/
Beware: French time, generally an hour ahead of UK.


From drj|m|emon @end|ng |rom gm@||@com  Tue Apr 13 09:02:10 2021
From: drj|m|emon @end|ng |rom gm@||@com (Jim Lemon)
Date: Tue, 13 Apr 2021 17:02:10 +1000
Subject: [R] LHS random number generator
In-Reply-To: <CA+bivFg5WFxZis_aYgg+5+kZZZ7x+UgGvy94tDaK0QR8mVJfjw@mail.gmail.com>
References: <CA+bivFg5WFxZis_aYgg+5+kZZZ7x+UgGvy94tDaK0QR8mVJfjw@mail.gmail.com>
Message-ID: <CA+8X3fWM6quxADfvy+g=s36V+r7EvKDwsPbhHsZJTmGyZx4a6A@mail.gmail.com>

Hi Shah,
I think what you are struggling toward is this:

prior_lhs <- list(r_mu=c( 0.00299, 0.0032),
                  r_sd=c( 0.001, 0.002),
                  lmp=c( 0.40, 0.43),
                  gr_mu=c( 0.14, 0.16),
                  gr_s=c( 0.01, 0.020),
                  alpha1=c( 0.0001, 0.0018),
                  alpha2=c(0.0017, 0.0028),
                  alpha3=c( 0.005, 0.009),
                  beta=c(0.69, 0.75))
for(i in 1:length(prior_lhs))
 prior_lhs[[i]]<-seq(prior_lhs[[i]][1],prior_lhs[[i]][2],length.out=4)

This gives you the "quartiles" you need for randomLHS function in the
"lhs" package if I read the help page correctly.

Jim

On Mon, Apr 12, 2021 at 10:21 PM Shah Alam <dr.alamsolangi at gmail.com> wrote:
>
> Hello everyone,
>
> I am using the LHS package to generate a combination of a
> set of parameter values. However, I am not sure how to fix some parameter
> values to 2 decimal points.
> For example:
>
> I want to make combinations in such a way that values for parameter
> c("lmp", 0.40, 0.43) are taken as 0.40, 0.41, 0.42,0.43.
>
> My codes are:
>
> prior_lhs <- list(c("r_mu", 0.00299, 0.0032),
>                   c("r_sd", 0.001, 0.002),
>                   c("lmp", 0.40, 0.43),
>                   c("gr_mu", 0.14, 0.16),
>                   c("gr_sd", 0.01, 0.020),
>                   c("alpha1", 0.0001, 0.0018),
>                   c("alpha2", 0.0017, 0.0028),
>                   c("alpha3", 0.005, 0.009),
>                   c("beta", 0.69, 0.75)
> )
>
>
> ### Simulation with priors from LHS ####
> nb_simul <- 10000
> nparam <- length(prior_lhs)
> random_tab = randomLHS(nb_simul, nparam)
> lhs_index = 1
> param <- matrix(rep(0, nparam), nrow = 1, ncol = nparam)
>
> for (i in 1:nb_simul) {
>   temp_par <- matrix(rep(0, nparam), nrow = 1, ncol = nparam)
>   for (j in 1:nparam) {
>     temp_par[j] = as.numeric(prior_lhs[[j]][2]) +
>       (as.numeric(prior_lhs[[j]][3]) - as.numeric(prior_lhs[[j]][2])) *
> random_tab[lhs_index, j]
>   }
>   param <- rbind(param, temp_par)
>   lhs_index <- lhs_index+1
> }
> param <- param[-1,]
>
> Best regards,
> Shah
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From |eder|co@c@|bo|| @end|ng |rom ku|euven@be  Tue Apr 13 09:24:49 2021
From: |eder|co@c@|bo|| @end|ng |rom ku|euven@be (Federico Calboli)
Date: Tue, 13 Apr 2021 07:24:49 +0000
Subject: [R] install_github  does not work locally
Message-ID: <20DC4A21-BFC9-4C2F-B102-654F95EB83D1@kuleuven.be>

Hello,

I am trying to install a package from github, but my local installation fails (whereas doing the very same thing on a remote cluster works, and downloading the tarball by hand works).  I assume the issue is mine, but I have no idea how to solve it.  In any case, here is what I am doing and my session info.

Cheers

F

devtools::install_github("Syksy/curatedPCaData")
Downloading GitHub repo Syksy/curatedPCaData at HEAD
Error in utils::download.file(url, path, method = method, quiet = quiet,  : 
  download from 'https://api.github.com/repos/Syksy/curatedPCaData/tarball/HEAD? failed


> sessionInfo()
R version 4.0.4 (2021-02-15)
Platform: x86_64-apple-darwin17.0 (64-bit)
Running under: macOS Mojave 10.14.6

Matrix products: default
BLAS:   /Library/Frameworks/R.framework/Versions/4.0/Resources/lib/libRblas.dylib
LAPACK: /Library/Frameworks/R.framework/Versions/4.0/Resources/lib/libRlapack.dylib

locale:
[1] en_GB.UTF-8/en_GB.UTF-8/en_GB.UTF-8/C/en_GB.UTF-8/en_GB.UTF-8

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

loaded via a namespace (and not attached):
 [1] magrittr_2.0.1    usethis_2.0.1     devtools_2.4.0    pkgload_1.2.1     R6_2.5.0          rlang_0.4.10      fastmap_1.1.0     tools_4.0.4      
 [9] pkgbuild_1.2.0    sessioninfo_1.1.1 cli_2.4.0         withr_2.4.1       ellipsis_0.3.1    remotes_2.3.0     rprojroot_2.0.2   lifecycle_1.0.0  
[17] crayon_1.4.1      processx_3.5.1    purrr_0.3.4       callr_3.6.0       fs_1.5.0          ps_1.6.0          curl_4.3          testthat_3.0.2   
[25] memoise_2.0.0     glue_1.4.2        cachem_1.0.4      compiler_4.0.4    desc_1.3.0        prettyunits_1.1.1

--
Federico Calboli
LBEG - Laboratory of Biodiversity and Evolutionary Genomics
Charles Deberiotstraat 32 box 2439
3000 Leuven
+32 16 32 87 67






From dr@@|@m@o|@ng| @end|ng |rom gm@||@com  Tue Apr 13 11:16:22 2021
From: dr@@|@m@o|@ng| @end|ng |rom gm@||@com (Shah Alam)
Date: Tue, 13 Apr 2021 11:16:22 +0200
Subject: [R] LHS random number generator
In-Reply-To: <CA+8X3fWM6quxADfvy+g=s36V+r7EvKDwsPbhHsZJTmGyZx4a6A@mail.gmail.com>
References: <CA+bivFg5WFxZis_aYgg+5+kZZZ7x+UgGvy94tDaK0QR8mVJfjw@mail.gmail.com>
 <CA+8X3fWM6quxADfvy+g=s36V+r7EvKDwsPbhHsZJTmGyZx4a6A@mail.gmail.com>
Message-ID: <CA+bivFhNLOwsxLmMYmru4fAc5sNBPh-gXz8DEArXi40ppM2D+A@mail.gmail.com>

Hi Richard and Jim

Thanks for your response. Sorry for the confusion. This is lhs package
(small letters), and after loading the package, I used the function
randomLHS.

The problem remained the same. I am trying to fix the length.out=2 for
lmp=c(0.40, 0.43), and length.out = 4 for all other variables/inputs.

Best regards,
Shah








On Tue, 13 Apr 2021 at 09:02, Jim Lemon <drjimlemon at gmail.com> wrote:

> Hi Shah,
> I think what you are struggling toward is this:
>
> prior_lhs <- list(r_mu=c( 0.00299, 0.0032),
>                   r_sd=c( 0.001, 0.002),
>                   lmp=c( 0.40, 0.43),
>                   gr_mu=c( 0.14, 0.16),
>                   gr_s=c( 0.01, 0.020),
>                   alpha1=c( 0.0001, 0.0018),
>                   alpha2=c(0.0017, 0.0028),
>                   alpha3=c( 0.005, 0.009),
>                   beta=c(0.69, 0.75))
> for(i in 1:length(prior_lhs))
>  prior_lhs[[i]]<-seq(prior_lhs[[i]][1],prior_lhs[[i]][2],length.out=4)
>
> This gives you the "quartiles" you need for randomLHS function in the
> "lhs" package if I read the help page correctly.
>
> Jim
>
> On Mon, Apr 12, 2021 at 10:21 PM Shah Alam <dr.alamsolangi at gmail.com>
> wrote:
> >
> > Hello everyone,
> >
> > I am using the LHS package to generate a combination of a
> > set of parameter values. However, I am not sure how to fix some parameter
> > values to 2 decimal points.
> > For example:
> >
> > I want to make combinations in such a way that values for parameter
> > c("lmp", 0.40, 0.43) are taken as 0.40, 0.41, 0.42,0.43.
> >
> > My codes are:
> >
> > prior_lhs <- list(c("r_mu", 0.00299, 0.0032),
> >                   c("r_sd", 0.001, 0.002),
> >                   c("lmp", 0.40, 0.43),
> >                   c("gr_mu", 0.14, 0.16),
> >                   c("gr_sd", 0.01, 0.020),
> >                   c("alpha1", 0.0001, 0.0018),
> >                   c("alpha2", 0.0017, 0.0028),
> >                   c("alpha3", 0.005, 0.009),
> >                   c("beta", 0.69, 0.75)
> > )
> >
> >
> > ### Simulation with priors from LHS ####
> > nb_simul <- 10000
> > nparam <- length(prior_lhs)
> > random_tab = randomLHS(nb_simul, nparam)
> > lhs_index = 1
> > param <- matrix(rep(0, nparam), nrow = 1, ncol = nparam)
> >
> > for (i in 1:nb_simul) {
> >   temp_par <- matrix(rep(0, nparam), nrow = 1, ncol = nparam)
> >   for (j in 1:nparam) {
> >     temp_par[j] = as.numeric(prior_lhs[[j]][2]) +
> >       (as.numeric(prior_lhs[[j]][3]) - as.numeric(prior_lhs[[j]][2])) *
> > random_tab[lhs_index, j]
> >   }
> >   param <- rbind(param, temp_par)
> >   lhs_index <- lhs_index+1
> > }
> > param <- param[-1,]
> >
> > Best regards,
> > Shah
> >
> >         [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From ch@|@b|@e|@he @end|ng |rom y@hoo@de  Tue Apr 13 12:26:22 2021
From: ch@|@b|@e|@he @end|ng |rom y@hoo@de (Elahe chalabi)
Date: Tue, 13 Apr 2021 10:26:22 +0000 (UTC)
Subject: [R] Add a new row based on test set predicted values and time stamps
References: <568265892.2252019.1618309582985.ref@mail.yahoo.com>
Message-ID: <568265892.2252019.1618309582985@mail.yahoo.com>

Hi all,

I have the prediction for my test set which are forecasted Value for "4/1/2020" for each match of "id" and "Group". I would like to add a fourth row to each group by (Group,id) in my train set and the values for this row should come from test set :

my train set:?

? ? ?structure(list(Date = c("1/1/2020", "2/1/2020", "3/1/2020", "1/1/2020",?
? ? ?"2/1/2020", "3/1/2020", "1/1/2020", "2/1/2020", "3/1/2020", ""
? ? ?), Value = c(3.5, 2.7, 4, 2.5, 3.7, 0, 3, 0, 1, NA), Group = c("A",?
? ? "A", "A", "B", "B", "B", "C", "C", "C", ""), id = c(1L, 1L, 1L,?
? ? 101L, 101L, 101L, 100L, 100L, 100L, NA)), class = "data.frame", row.names = c(NA,?
? ? -10L))

test set:

? ? structure(list(Date = c("4/1/2020", "4/1/2020", "4/1/2020", ""
? ? ? ), Value = c(3.5, 2.5, 3, NA), Group = c("A", "B", "C", ""),?
? ? id = c(1L, 101L, 100L, NA), value = c(0.2, 0.7, 0.9, NA)), class = "data.frame", row.names = c(NA,?
? ? ?-4L))structure(list(Date = c("4/1/2020", "4/1/2020", "4/1/2020", ""
? ? ), Value = c(3.5, 2.5, 3, NA), Group = c("A", "B", "C", ""),?
? ? id = c(1L, 101L, 100L, NA)), class = "data.frame", row.names = c(NA,?
? ? -4L))

desired output:?

? ??structure(list(Date = c("1/1/2020", "2/1/2020", "3/1/2020", "4/1/2020",?
? ? "1/1/2020", "2/1/2020", "3/1/2020", "4/1/2020", "1/1/2020", "2/1/2020",?
? ? "3/1/2020", "4/1/2020"), Value = c(3.5, 2.7, 4, 0.2, 2.5, 3.7,?
? ? ?0, 0.7, 3, 0, 1, 0.9), Group = c("A", "A", "A", "A", "B", "B",?
? ? "B", "B", "C", "C", "C", "C"), id = c(1L, 1L, 1L, 1L, 101L, 101L,?
? ? 101L, 101L, 100L, 100L, 100L, 100L)), class = "data.frame", row.names = c(NA,?
? ?-12L))

Data is dummy and I have milions of records in original data set.?

Thanks for any help.
Elahe?
?


From m@015k3113 @end|ng |rom b|ueyonder@co@uk  Tue Apr 13 14:51:21 2021
From: m@015k3113 @end|ng |rom b|ueyonder@co@uk (e-mail ma015k3113)
Date: Tue, 13 Apr 2021 13:51:21 +0100 (BST)
Subject: [R] Looping through data error
Message-ID: <59634000.142366.1618318281941@mail2.virginmedia.com>

Dear All,I have a dataframe with 4 variables and I am trying to calculate how many shares can be purchased with ?100 in the first year when the company was listed

The data looks like:

COMPANY_NUMBER YEAR_END_DATE CLOSE_SHARE_PRICE  NUMBER_OF_SHARES
22705                                30/09/2002                          NA                                 0
22705                                30/09/2004                         NA                                  0
22705                                30/09/2005                        6.55                                 0
22705                                30/09/2006                        7.5                                   0
22705                                30/09/2007                        9.65                                 0
22705                                30/09/2008                        6.55                                 0
1091347                            31/01/2010                        8.14                                 0
1091347                             31/01/2011                      11.38                                 0
11356069                           30/06/2019                      1.09                                   0
SC192761                         31/01/2000                         NA                                   0
SC192761                         31/01/2001                         NA                                   0
SC192761                          31/01/2002                        NA                                   0
SC192761                         31/01/2004                         NA                                   0
SC192761                         31/01/2005                         NA                                   0
SC192761                          31/01/2006                      1.09                                   0
SC192761                          31/01/2008                      1.24                                   0
SC192761                          31/01/2009                       0.9                                    0
SC192761                          31/01/2010                     1.14                                    0
SC192761                           31/01/2011                    1.25                                    0
SC192761                          31/01/2012                     1.29                                    0


The code I have written is

i <- 0

for (i in 1:(nrow(PLC_Return)-1))
if (i == 1)
{
NUMBER_OF_SHARES[i] = 100/is.na(CLOSE_SHARE_PRICE[i])
} else if
(is.na(PLC_Return[i, 1]) == is.na(PLC_Return[i + 1, 1])
{
NUMBER_OF_SHARES[i]=0
} else
{
NUMBER_OF_SHARES[i] = 100/is.na(CLOSE_SHARE_PRICE[i])
}


The error I get is Error: unexpected 'else' in:

" NUMBER_OF_SHARES[i] = 0
} else"
> {NUMBER_OF_SHARES[i] = 100/is.na(CLOSE_SHARE_PRICE[i])}
>
> }
Error: unexpected '}' in "}"


Don't know how to fix it-any help will be appreciated.


Kind regards


Ahson
	[[alternative HTML version deleted]]


From jho|tm@n @end|ng |rom gm@||@com  Tue Apr 13 15:29:43 2021
From: jho|tm@n @end|ng |rom gm@||@com (jim holtman)
Date: Tue, 13 Apr 2021 06:29:43 -0700
Subject: [R] Looping through data error
In-Reply-To: <59634000.142366.1618318281941@mail2.virginmedia.com>
References: <59634000.142366.1618318281941@mail2.virginmedia.com>
Message-ID: <CAAxdm-58YhUa1f87Bm_ZGCAJGO_aAf44ujpUxD67YTPYzh25sg@mail.gmail.com>

Your code was formatted incorrectly.  There is always a problem with the
'else' statement after an 'if' since in R there is no semicolon to mark the
end of a line.  Here might be a better format for your code.  I would
recommend the liberal use of "{}"s when using 'if/else'



i <- 0

for (i in 1:(nrow(PLC_Return) - 1)) {
  if (i == 1) {
    NUMBER_OF_SHARES[i] = 100 / is.na(CLOSE_SHARE_PRICE[i])
  } else {
    if (is.na(PLC_Return[i, 1]) == is.na(PLC_Return[i + 1, 1]) {
      NUMBER_OF_SHARES[i] = 0
    } else {
      NUMBER_OF_SHARES[i] = 100 / is.na(CLOSE_SHARE_PRICE[i])
    }
  }
}


Jim Holtman
*Data Munger Guru*


*What is the problem that you are trying to solve?Tell me what you want to
do, not how you want to do it.*


On Tue, Apr 13, 2021 at 5:51 AM e-mail ma015k3113 via R-help <
r-help at r-project.org> wrote:

> Dear All,I have a dataframe with 4 variables and I am trying to calculate
> how many shares can be purchased with ?100 in the first year when the
> company was listed
>
> The data looks like:
>
> COMPANY_NUMBER YEAR_END_DATE CLOSE_SHARE_PRICE  NUMBER_OF_SHARES
> 22705                                30/09/2002
> NA                                 0
> 22705                                30/09/2004
>  NA                                  0
> 22705                                30/09/2005
> 6.55                                 0
> 22705                                30/09/2006
> 7.5                                   0
> 22705                                30/09/2007
> 9.65                                 0
> 22705                                30/09/2008
> 6.55                                 0
> 1091347                            31/01/2010                        8.14
>                                0
> 1091347                             31/01/2011                      11.38
>                                0
> 11356069                           30/06/2019                      1.09
>                                0
> SC192761                         31/01/2000                         NA
>                                0
> SC192761                         31/01/2001                         NA
>                                0
> SC192761                          31/01/2002                        NA
>                                0
> SC192761                         31/01/2004                         NA
>                                0
> SC192761                         31/01/2005                         NA
>                                0
> SC192761                          31/01/2006                      1.09
>                                0
> SC192761                          31/01/2008                      1.24
>                                0
> SC192761                          31/01/2009                       0.9
>                                 0
> SC192761                          31/01/2010                     1.14
>                               0
> SC192761                           31/01/2011                    1.25
>                               0
> SC192761                          31/01/2012                     1.29
>                               0
>
>
> The code I have written is
>
> i <- 0
>
> for (i in 1:(nrow(PLC_Return)-1))
> if (i == 1)
> {
> NUMBER_OF_SHARES[i] = 100/is.na(CLOSE_SHARE_PRICE[i])
> } else if
> (is.na(PLC_Return[i, 1]) == is.na(PLC_Return[i + 1, 1])
> {
> NUMBER_OF_SHARES[i]=0
> } else
> {
> NUMBER_OF_SHARES[i] = 100/is.na(CLOSE_SHARE_PRICE[i])
> }
>
>
> The error I get is Error: unexpected 'else' in:
>
> " NUMBER_OF_SHARES[i] = 0
> } else"
> > {NUMBER_OF_SHARES[i] = 100/is.na(CLOSE_SHARE_PRICE[i])}
> >
> > }
> Error: unexpected '}' in "}"
>
>
> Don't know how to fix it-any help will be appreciated.
>
>
> Kind regards
>
>
> Ahson
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Tue Apr 13 18:06:29 2021
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Tue, 13 Apr 2021 17:06:29 +0100
Subject: [R] Looping through data error
In-Reply-To: <59634000.142366.1618318281941@mail2.virginmedia.com>
References: <59634000.142366.1618318281941@mail2.virginmedia.com>
Message-ID: <b4cd892a-a4c6-8635-e1b3-7fb4bf90f0ae@sapo.pt>

Hello,

A close parenthesis is missing in the nd if.


for (i in 1:(nrow(PLC_Return)-1)){
   if (i == 1){
     NUMBER_OF_SHARES[i] = 100/is.na(CLOSE_SHARE_PRICE[i])
   } else if(is.na(PLC_Return[i, 1]) == is.na(PLC_Return[i + 1, 1])){
     NUMBER_OF_SHARES[i]=0
   } else {
     NUMBER_OF_SHARES[i] = 100/is.na(CLOSE_SHARE_PRICE[i])
   }
}


Hope this helps,

Rui Barradas

?s 13:51 de 13/04/21, e-mail ma015k3113 via R-help escreveu:
> Dear All,I have a dataframe with 4 variables and I am trying to calculate how many shares can be purchased with ?100 in the first year when the company was listed
> 
> The data looks like:
> 
> COMPANY_NUMBER YEAR_END_DATE CLOSE_SHARE_PRICE  NUMBER_OF_SHARES
> 22705                                30/09/2002                          NA                                 0
> 22705                                30/09/2004                         NA                                  0
> 22705                                30/09/2005                        6.55                                 0
> 22705                                30/09/2006                        7.5                                   0
> 22705                                30/09/2007                        9.65                                 0
> 22705                                30/09/2008                        6.55                                 0
> 1091347                            31/01/2010                        8.14                                 0
> 1091347                             31/01/2011                      11.38                                 0
> 11356069                           30/06/2019                      1.09                                   0
> SC192761                         31/01/2000                         NA                                   0
> SC192761                         31/01/2001                         NA                                   0
> SC192761                          31/01/2002                        NA                                   0
> SC192761                         31/01/2004                         NA                                   0
> SC192761                         31/01/2005                         NA                                   0
> SC192761                          31/01/2006                      1.09                                   0
> SC192761                          31/01/2008                      1.24                                   0
> SC192761                          31/01/2009                       0.9                                    0
> SC192761                          31/01/2010                     1.14                                    0
> SC192761                           31/01/2011                    1.25                                    0
> SC192761                          31/01/2012                     1.29                                    0
> 
> 
> The code I have written is
> 
> i <- 0
> 
> for (i in 1:(nrow(PLC_Return)-1))
> if (i == 1)
> {
> NUMBER_OF_SHARES[i] = 100/is.na(CLOSE_SHARE_PRICE[i])
> } else if
> (is.na(PLC_Return[i, 1]) == is.na(PLC_Return[i + 1, 1])
> {
> NUMBER_OF_SHARES[i]=0
> } else
> {
> NUMBER_OF_SHARES[i] = 100/is.na(CLOSE_SHARE_PRICE[i])
> }
> 
> 
> The error I get is Error: unexpected 'else' in:
> 
> " NUMBER_OF_SHARES[i] = 0
> } else"
>> {NUMBER_OF_SHARES[i] = 100/is.na(CLOSE_SHARE_PRICE[i])}
>>
>> }
> Error: unexpected '}' in "}"
> 
> 
> Don't know how to fix it-any help will be appreciated.
> 
> 
> Kind regards
> 
> 
> Ahson
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Tue Apr 13 18:09:04 2021
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Tue, 13 Apr 2021 17:09:04 +0100
Subject: [R] Looping through data error
In-Reply-To: <b4cd892a-a4c6-8635-e1b3-7fb4bf90f0ae@sapo.pt>
References: <59634000.142366.1618318281941@mail2.virginmedia.com>
 <b4cd892a-a4c6-8635-e1b3-7fb4bf90f0ae@sapo.pt>
Message-ID: <97b652ea-e214-8bc3-7ebe-b64db2bfa1c5@sapo.pt>

Hello,

Typo, inline.

?s 17:06 de 13/04/21, Rui Barradas escreveu:
> Hello,
> 
> A close parenthesis is missing in the nd if.

Should be "the 2nd if".

Rui Barradas

> 
> 
> for (i in 1:(nrow(PLC_Return)-1)){
>  ? if (i == 1){
>  ??? NUMBER_OF_SHARES[i] = 100/is.na(CLOSE_SHARE_PRICE[i])
>  ? } else if(is.na(PLC_Return[i, 1]) == is.na(PLC_Return[i + 1, 1])){
>  ??? NUMBER_OF_SHARES[i]=0
>  ? } else {
>  ??? NUMBER_OF_SHARES[i] = 100/is.na(CLOSE_SHARE_PRICE[i])
>  ? }
> }
> 
> 
> Hope this helps,
> 
> Rui Barradas
> 
> ?s 13:51 de 13/04/21, e-mail ma015k3113 via R-help escreveu:
>> Dear All,I have a dataframe with 4 variables and I am trying to 
>> calculate how many shares can be purchased with ?100 in the first year 
>> when the company was listed
>>
>> The data looks like:
>>
>> COMPANY_NUMBER YEAR_END_DATE CLOSE_SHARE_PRICE? NUMBER_OF_SHARES
>> 22705                                
>> 30/09/2002????????????????????????? NA???????????????????????????????? 0
>> 22705                                
>> 30/09/2004???????????????????????? NA????????????????????????????????? 0
>> 22705??????????????????????????????? 30/09/2005                        
>> 6.55???????????????????????????????? 0
>> 22705??????????????????????????????? 30/09/2006                        
>> 7.5?????????????????????????????????? 0
>> 22705??????????????????????????????? 30/09/2007                        
>> 9.65???????????????????????????????? 0
>> 22705??????????????????????????????? 30/09/2008                        
>> 6.55???????????????????????????????? 0
>> 1091347??????????????????????????? 31/01/2010                        
>> 8.14???????????????????????????????? 0
>> 1091347???????????????????????????? 31/01/2011                      
>> 11.38???????????????????????????????? 0
>> 11356069?????????????????????????? 30/06/2019                      
>> 1.09?????????????????????????????????? 0
>> SC192761???????????????????????? 31/01/2000                         
>> NA?????????????????????????????????? 0
>> SC192761???????????????????????? 31/01/2001                         
>> NA?????????????????????????????????? 0
>> SC192761????????????????????????? 31/01/2002                        
>> NA?????????????????????????????????? 0
>> SC192761???????????????????????? 31/01/2004                         
>> NA?????????????????????????????????? 0
>> SC192761???????????????????????? 31/01/2005                         
>> NA?????????????????????????????????? 0
>> SC192761????????????????????????? 31/01/2006                      
>> 1.09?????????????????????????????????? 0
>> SC192761????????????????????????? 31/01/2008                      
>> 1.24?????????????????????????????????? 0
>> SC192761????????????????????????? 31/01/2009                       
>> 0.9??????????????????????????????????? 0
>> SC192761????????????????????????? 31/01/2010                     
>> 1.14??????????????????????????????????? 0
>> SC192761?????????????????????????? 31/01/2011                    
>> 1.25??????????????????????????????????? 0
>> SC192761????????????????????????? 31/01/2012                     
>> 1.29??????????????????????????????????? 0
>>
>>
>> The code I have written is
>>
>> i <- 0
>>
>> for (i in 1:(nrow(PLC_Return)-1))
>> if (i == 1)
>> {
>> NUMBER_OF_SHARES[i] = 100/is.na(CLOSE_SHARE_PRICE[i])
>> } else if
>> (is.na(PLC_Return[i, 1]) == is.na(PLC_Return[i + 1, 1])
>> {
>> NUMBER_OF_SHARES[i]=0
>> } else
>> {
>> NUMBER_OF_SHARES[i] = 100/is.na(CLOSE_SHARE_PRICE[i])
>> }
>>
>>
>> The error I get is Error: unexpected 'else' in:
>>
>> " NUMBER_OF_SHARES[i] = 0
>> } else"
>>> {NUMBER_OF_SHARES[i] = 100/is.na(CLOSE_SHARE_PRICE[i])}
>>>
>>> }
>> Error: unexpected '}' in "}"
>>
>>
>> Don't know how to fix it-any help will be appreciated.
>>
>>
>> Kind regards
>>
>>
>> Ahson
>> ????[[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide 
>> http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>>
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide 
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From m@015k3113 @end|ng |rom b|ueyonder@co@uk  Tue Apr 13 18:11:21 2021
From: m@015k3113 @end|ng |rom b|ueyonder@co@uk (e-mail ma015k3113)
Date: Tue, 13 Apr 2021 17:11:21 +0100 (BST)
Subject: [R] Looping through data error
In-Reply-To: <CAAxdm-58YhUa1f87Bm_ZGCAJGO_aAf44ujpUxD67YTPYzh25sg@mail.gmail.com>
References: <59634000.142366.1618318281941@mail2.virginmedia.com>
 <CAAxdm-58YhUa1f87Bm_ZGCAJGO_aAf44ujpUxD67YTPYzh25sg@mail.gmail.com>
Message-ID: <995683180.149379.1618330281680@mail2.virginmedia.com>

Jim, thanks for taking the time to look into this. Yes, these if else statements are so confusing.

I tried your amended scode and it does not work. The error are as follows:


Error: unexpected '}' in " }"
> NUMBER_OF_SHARES[i] = 100 / is.na(CLOSE_SHARE_PRICE[i])
> }
Error: unexpected '}' in " }"
> }
Error: unexpected '}' in " }"
> }
Error: unexpected '}' in "}"
>

I have spent so much time on this-hopefully I will come to grips sooner or later. In the mean time any further suggestion?


Kind regards


Ahson

> On 13 April 2021 at 14:29 jim holtman <jholtman at gmail.com> wrote:
> 
>     Your code was formatted incorrectly.  There is always a problem with the 'else' statement after an 'if' since in R there is no semicolon to mark the end of a line.  Here might be a better format for your code.  I would recommend the liberal use of "{}"s when using 'if/else'
> 
> 
> 
>     i <- 0
> 
>     for (i in 1:(nrow(PLC_Return) - 1)) {
>       if (i == 1) {
>         NUMBER_OF_SHARES[i] = 100 /http://is.na (CLOSE_SHARE_PRICE[i])
>       } else {
>         if (http://is.na (PLC_Return[i, 1]) ==http://is.na (PLC_Return[i + 1, 1]) {
>           NUMBER_OF_SHARES[i] = 0
>         } else {
>           NUMBER_OF_SHARES[i] = 100 /http://is.na (CLOSE_SHARE_PRICE[i])
>         }
>       }
>     }  
> 
> 
>     Jim Holtman
>     Data Munger Guru
>      
>     What is the problem that you are trying to solve?
>     Tell me what you want to do, not how you want to do it.
> 
> 
>     On Tue, Apr 13, 2021 at 5:51 AM e-mail ma015k3113 via R-help < r-help at r-project.org mailto:r-help at r-project.org > wrote:
> 
>         > > Dear All,I have a dataframe with 4 variables and I am trying to calculate how many shares can be purchased with ?100 in the first year when the company was listed
> > 
> >         The data looks like:
> > 
> >         COMPANY_NUMBER YEAR_END_DATE CLOSE_SHARE_PRICE  NUMBER_OF_SHARES
> >         22705                                30/09/2002                          NA                                 0
> >         22705                                30/09/2004                         NA                                  0
> >         22705                                30/09/2005                        6.55                                 0
> >         22705                                30/09/2006                        7.5                                   0
> >         22705                                30/09/2007                        9.65                                 0
> >         22705                                30/09/2008                        6.55                                 0
> >         1091347                            31/01/2010                        8.14                                 0
> >         1091347                             31/01/2011                      11.38                                 0
> >         11356069                           30/06/2019                      1.09                                   0
> >         SC192761                         31/01/2000                         NA                                   0
> >         SC192761                         31/01/2001                         NA                                   0
> >         SC192761                          31/01/2002                        NA                                   0
> >         SC192761                         31/01/2004                         NA                                   0
> >         SC192761                         31/01/2005                         NA                                   0
> >         SC192761                          31/01/2006                      1.09                                   0
> >         SC192761                          31/01/2008                      1.24                                   0
> >         SC192761                          31/01/2009                       0.9                                    0
> >         SC192761                          31/01/2010                     1.14                                    0
> >         SC192761                           31/01/2011                    1.25                                    0
> >         SC192761                          31/01/2012                     1.29                                    0
> > 
> > 
> >         The code I have written is
> > 
> >         i <- 0
> > 
> >         for (i in 1:(nrow(PLC_Return)-1))
> >         if (i == 1)
> >         {
> >         NUMBER_OF_SHARES[i] = 100/http://is.na (CLOSE_SHARE_PRICE[i])
> >         } else if
> >         (http://is.na (PLC_Return[i, 1]) ==http://is.na (PLC_Return[i + 1, 1])
> >         {
> >         NUMBER_OF_SHARES[i]=0
> >         } else
> >         {
> >         NUMBER_OF_SHARES[i] = 100/http://is.na (CLOSE_SHARE_PRICE[i])
> >         }
> > 
> > 
> >         The error I get is Error: unexpected 'else' in:
> > 
> >         " NUMBER_OF_SHARES[i] = 0
> >         } else"
> >         > {NUMBER_OF_SHARES[i] = 100/http://is.na (CLOSE_SHARE_PRICE[i])}
> >         >
> >         > }
> >         Error: unexpected '}' in "}"
> > 
> > 
> >         Don't know how to fix it-any help will be appreciated.
> > 
> > 
> >         Kind regards
> > 
> > 
> >         Ahson
> >                 [[alternative HTML version deleted]]
> > 
> >         ______________________________________________
> >         R-help at r-project.org mailto:R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> >         https://stat.ethz.ch/mailman/listinfo/r-help
> >         PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> >         and provide commented, minimal, self-contained, reproducible code.
> > 
> >     > 

	[[alternative HTML version deleted]]


From cd@@ek m@iii@g oii posteo@de  Tue Apr 13 17:11:39 2021
From: cd@@ek m@iii@g oii posteo@de (cd@@ek m@iii@g oii posteo@de)
Date: Tue, 13 Apr 2021 17:11:39 +0200
Subject: [R] =?utf-8?q?graphics_useRaster_check=5Firregular_definition_fo?=
 =?utf-8?q?r_date_or_posix?=
Message-ID: <c5279327071e612bd17d1d69b8f16496@posteo.de>

 Hi

The function `check_irregular()` defined within
`graphics::image.default()` checks if the `useRaster` argument for
`graphics::image()` can be true or must be false. 

According to this function, the following example vector is irregular:
```
time <- seq(as.Date("2020-1-1"), as.Date("2020-12-31"), l=12)
 check_irregular(time, time)
# TRUE
```
In my view, this is not correct. 

In this case, the `all.equal`-call does not evaluate to true due to the
special class of `dx` (or `dy`). If I slightly rewrite the function as
```
my_check_irregular <- function (x, y)
{ 
 dx <- as.numeric(diff(x)) 
 dy <- as.numeric(diff(y)) 
 (length(dx) && !isTRUE(all.equal(dx, rep(dx[1], length(dx))))) || 
 (length(dy) && !isTRUE(all.equal(dy, rep(dy[1], length(dy))))) 
}
 ```
the correct answer is obtained (i.e. that the input vector is not
irregular based on the rational behind `all.equal`):
```
my_check_irregular(time, time) 
# FALSE
 ```

The same applies to POSIX* objects. I was wondering if this is intended
or not?

Thanks a lot for any answer,
Chris 
	[[alternative HTML version deleted]]


From bgunter@4567 @end|ng |rom gm@||@com  Tue Apr 13 19:47:36 2021
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Tue, 13 Apr 2021 10:47:36 -0700
Subject: [R] Add a new row based on test set predicted values and time
 stamps
In-Reply-To: <568265892.2252019.1618309582985@mail.yahoo.com>
References: <568265892.2252019.1618309582985.ref@mail.yahoo.com>
 <568265892.2252019.1618309582985@mail.yahoo.com>
Message-ID: <CAGxFJbSQUguSHwBBtRFFX74w+9gmr2hU82HXwBEY7DJzb_YwLA@mail.gmail.com>

It may not be necessary to insert the rows in that order -- R can identify
and use the information from the rows in in most cases without it.
So to combine the results as you described (the code you sent got garbled a
bit btw -- you should proofread more carefully in future), all you would
need to do is:

## with train and test your train and test data frames of course
out <- na.omit(rbind(train, cbind(test[,c(1,3,4)], Value = test[,"value"])))
## Note that the cbind() stuff is needed to create the correct "Value"
column for rbind(). See ?rbind for details

If you insist that you need the row ordering as you specified, then follow
this by:

out <- with(out, out[order(Group, id, as.POSIXct(Date,format = "%D%")), ])

What this does is to first convert your text data column to POSIXct ("See
?DateTimeClasses for details) which gives them the desired calendar
ordering. The order() function (see ?order for details) then gives the
permutation ordering them from early to late within groups and id's, which
are then used as the row subscripts to reorder the rows in the data frame.

DO NOTE: For this to work reliably, your Date column must be consistent and
correct in its formatting!

Other note: It probably makes more sense to convert your Date column to a
POSIXct or POSIXlt dates from the beginning, as this will make things like
plotting in date order straightforward. There are also date-time packages
(in the "tidyverse" suite, I think,  as well as others) that simplify such
things. I am pretty ignorant about date-time stuff, so I can't really be
more specific. https://cran.r-project.org/web/views/TimeSeries.html  will
have lots of info on this if you need it. As well as searching, of course.

HTH

Bert Gunter

"The trouble with having an open mind is that people keep coming along and
sticking things into it."
-- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )


On Tue, Apr 13, 2021 at 3:26 AM Elahe chalabi via R-help <
r-help at r-project.org> wrote:

> Hi all,
>
> I have the prediction for my test set which are forecasted Value for
> "4/1/2020" for each match of "id" and "Group". I would like to add a fourth
> row to each group by (Group,id) in my train set and the values for this row
> should come from test set :
>
> my train set:
>
>      structure(list(Date = c("1/1/2020", "2/1/2020", "3/1/2020",
> "1/1/2020",
>      "2/1/2020", "3/1/2020", "1/1/2020", "2/1/2020", "3/1/2020", ""
>      ), Value = c(3.5, 2.7, 4, 2.5, 3.7, 0, 3, 0, 1, NA), Group = c("A",
>     "A", "A", "B", "B", "B", "C", "C", "C", ""), id = c(1L, 1L, 1L,
>     101L, 101L, 101L, 100L, 100L, 100L, NA)), class = "data.frame",
> row.names = c(NA,
>     -10L))
>
> test set:
>
>     structure(list(Date = c("4/1/2020", "4/1/2020", "4/1/2020", ""
>       ), Value = c(3.5, 2.5, 3, NA), Group = c("A", "B", "C", ""),
>     id = c(1L, 101L, 100L, NA), value = c(0.2, 0.7, 0.9, NA)), class =
> "data.frame", row.names = c(NA,
>      -4L))structure(list(Date = c("4/1/2020", "4/1/2020", "4/1/2020", ""
>     ), Value = c(3.5, 2.5, 3, NA), Group = c("A", "B", "C", ""),
>     id = c(1L, 101L, 100L, NA)), class = "data.frame", row.names = c(NA,
>     -4L))
>
> desired output:
>
>     structure(list(Date = c("1/1/2020", "2/1/2020", "3/1/2020",
> "4/1/2020",
>     "1/1/2020", "2/1/2020", "3/1/2020", "4/1/2020", "1/1/2020",
> "2/1/2020",
>     "3/1/2020", "4/1/2020"), Value = c(3.5, 2.7, 4, 0.2, 2.5, 3.7,
>      0, 0.7, 3, 0, 1, 0.9), Group = c("A", "A", "A", "A", "B", "B",
>     "B", "B", "C", "C", "C", "C"), id = c(1L, 1L, 1L, 1L, 101L, 101L,
>     101L, 101L, 100L, 100L, 100L, 100L)), class = "data.frame", row.names
> = c(NA,
>    -12L))
>
> Data is dummy and I have milions of records in original data set.
>
> Thanks for any help.
> Elahe
>
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From bgunter@4567 @end|ng |rom gm@||@com  Tue Apr 13 19:55:04 2021
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Tue, 13 Apr 2021 10:55:04 -0700
Subject: [R] Add a new row based on test set predicted values and time
 stamps
In-Reply-To: <CAGxFJbSQUguSHwBBtRFFX74w+9gmr2hU82HXwBEY7DJzb_YwLA@mail.gmail.com>
References: <568265892.2252019.1618309582985.ref@mail.yahoo.com>
 <568265892.2252019.1618309582985@mail.yahoo.com>
 <CAGxFJbSQUguSHwBBtRFFX74w+9gmr2hU82HXwBEY7DJzb_YwLA@mail.gmail.com>
Message-ID: <CAGxFJbS_zyvbrMGvvXri6AeWX7V15S67Sge1jpftSpf50y1ysg@mail.gmail.com>

(Revealing my ignorance):

Simpler still than the as.POSIXct() idiom is just to use the as.Date
version:

out <- with(out, out [order(Group, id, as.Date(Date)),])

## all else the same...

Bert Gunter

"The trouble with having an open mind is that people keep coming along and
sticking things into it."
-- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )


On Tue, Apr 13, 2021 at 10:47 AM Bert Gunter <bgunter.4567 at gmail.com> wrote:

> It may not be necessary to insert the rows in that order -- R can identify
> and use the information from the rows in in most cases without it.
> So to combine the results as you described (the code you sent got garbled
> a bit btw -- you should proofread more carefully in future), all you would
> need to do is:
>
> ## with train and test your train and test data frames of course
> out <- na.omit(rbind(train, cbind(test[,c(1,3,4)], Value =
> test[,"value"])))
> ## Note that the cbind() stuff is needed to create the correct "Value"
> column for rbind(). See ?rbind for details
>
> If you insist that you need the row ordering as you specified, then follow
> this by:
>
> out <- with(out, out[order(Group, id, as.POSIXct(Date,format = "%D%")), ])
>
> What this does is to first convert your text data column to POSIXct ("See
> ?DateTimeClasses for details) which gives them the desired calendar
> ordering. The order() function (see ?order for details) then gives the
> permutation ordering them from early to late within groups and id's, which
> are then used as the row subscripts to reorder the rows in the data frame.
>
> DO NOTE: For this to work reliably, your Date column must be consistent
> and correct in its formatting!
>
> Other note: It probably makes more sense to convert your Date column to a
> POSIXct or POSIXlt dates from the beginning, as this will make things like
> plotting in date order straightforward. There are also date-time packages
> (in the "tidyverse" suite, I think,  as well as others) that simplify such
> things. I am pretty ignorant about date-time stuff, so I can't really be
> more specific. https://cran.r-project.org/web/views/TimeSeries.html  will
> have lots of info on this if you need it. As well as searching, of course.
>
> HTH
>
> Bert Gunter
>
> "The trouble with having an open mind is that people keep coming along and
> sticking things into it."
> -- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )
>
>
> On Tue, Apr 13, 2021 at 3:26 AM Elahe chalabi via R-help <
> r-help at r-project.org> wrote:
>
>> Hi all,
>>
>> I have the prediction for my test set which are forecasted Value for
>> "4/1/2020" for each match of "id" and "Group". I would like to add a fourth
>> row to each group by (Group,id) in my train set and the values for this row
>> should come from test set :
>>
>> my train set:
>>
>>      structure(list(Date = c("1/1/2020", "2/1/2020", "3/1/2020",
>> "1/1/2020",
>>      "2/1/2020", "3/1/2020", "1/1/2020", "2/1/2020", "3/1/2020", ""
>>      ), Value = c(3.5, 2.7, 4, 2.5, 3.7, 0, 3, 0, 1, NA), Group = c("A",
>>     "A", "A", "B", "B", "B", "C", "C", "C", ""), id = c(1L, 1L, 1L,
>>     101L, 101L, 101L, 100L, 100L, 100L, NA)), class = "data.frame",
>> row.names = c(NA,
>>     -10L))
>>
>> test set:
>>
>>     structure(list(Date = c("4/1/2020", "4/1/2020", "4/1/2020", ""
>>       ), Value = c(3.5, 2.5, 3, NA), Group = c("A", "B", "C", ""),
>>     id = c(1L, 101L, 100L, NA), value = c(0.2, 0.7, 0.9, NA)), class =
>> "data.frame", row.names = c(NA,
>>      -4L))structure(list(Date = c("4/1/2020", "4/1/2020", "4/1/2020", ""
>>     ), Value = c(3.5, 2.5, 3, NA), Group = c("A", "B", "C", ""),
>>     id = c(1L, 101L, 100L, NA)), class = "data.frame", row.names = c(NA,
>>     -4L))
>>
>> desired output:
>>
>>     structure(list(Date = c("1/1/2020", "2/1/2020", "3/1/2020",
>> "4/1/2020",
>>     "1/1/2020", "2/1/2020", "3/1/2020", "4/1/2020", "1/1/2020",
>> "2/1/2020",
>>     "3/1/2020", "4/1/2020"), Value = c(3.5, 2.7, 4, 0.2, 2.5, 3.7,
>>      0, 0.7, 3, 0, 1, 0.9), Group = c("A", "A", "A", "A", "B", "B",
>>     "B", "B", "C", "C", "C", "C"), id = c(1L, 1L, 1L, 1L, 101L, 101L,
>>     101L, 101L, 100L, 100L, 100L, 100L)), class = "data.frame", row.names
>> = c(NA,
>>    -12L))
>>
>> Data is dummy and I have milions of records in original data set.
>>
>> Thanks for any help.
>> Elahe
>>
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide
>> http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>>
>

	[[alternative HTML version deleted]]


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Tue Apr 13 20:23:38 2021
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Tue, 13 Apr 2021 11:23:38 -0700
Subject: [R] Add a new row based on test set predicted values and time
 stamps
In-Reply-To: <CAGxFJbS_zyvbrMGvvXri6AeWX7V15S67Sge1jpftSpf50y1ysg@mail.gmail.com>
References: <568265892.2252019.1618309582985.ref@mail.yahoo.com>
 <568265892.2252019.1618309582985@mail.yahoo.com>
 <CAGxFJbSQUguSHwBBtRFFX74w+9gmr2hU82HXwBEY7DJzb_YwLA@mail.gmail.com>
 <CAGxFJbS_zyvbrMGvvXri6AeWX7V15S67Sge1jpftSpf50y1ysg@mail.gmail.com>
Message-ID: <5DC03B26-FFA4-416D-9C8D-1DA3348FE4AB@dcn.davis.ca.us>

The date you get using as.Date on a POSIXct value depends on the timezone. That is, as.Date only pays attention to the underlying UTC seconds-since-epoch value, so it ignores the timezone which can be unexpected for most people. 

TL;DR as.Date is not the same as as.POSIXct( trunc( dtm, units="days" ) ) unless you are using GMT.

On April 13, 2021 10:55:04 AM PDT, Bert Gunter <bgunter.4567 at gmail.com> wrote:
>(Revealing my ignorance):
>
>Simpler still than the as.POSIXct() idiom is just to use the as.Date
>version:
>
>out <- with(out, out [order(Group, id, as.Date(Date)),])
>
>## all else the same...
>
>Bert Gunter
>
>"The trouble with having an open mind is that people keep coming along
>and
>sticking things into it."
>-- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )
>
>
>On Tue, Apr 13, 2021 at 10:47 AM Bert Gunter <bgunter.4567 at gmail.com>
>wrote:
>
>> It may not be necessary to insert the rows in that order -- R can
>identify
>> and use the information from the rows in in most cases without it.
>> So to combine the results as you described (the code you sent got
>garbled
>> a bit btw -- you should proofread more carefully in future), all you
>would
>> need to do is:
>>
>> ## with train and test your train and test data frames of course
>> out <- na.omit(rbind(train, cbind(test[,c(1,3,4)], Value =
>> test[,"value"])))
>> ## Note that the cbind() stuff is needed to create the correct
>"Value"
>> column for rbind(). See ?rbind for details
>>
>> If you insist that you need the row ordering as you specified, then
>follow
>> this by:
>>
>> out <- with(out, out[order(Group, id, as.POSIXct(Date,format =
>"%D%")), ])
>>
>> What this does is to first convert your text data column to POSIXct
>("See
>> ?DateTimeClasses for details) which gives them the desired calendar
>> ordering. The order() function (see ?order for details) then gives
>the
>> permutation ordering them from early to late within groups and id's,
>which
>> are then used as the row subscripts to reorder the rows in the data
>frame.
>>
>> DO NOTE: For this to work reliably, your Date column must be
>consistent
>> and correct in its formatting!
>>
>> Other note: It probably makes more sense to convert your Date column
>to a
>> POSIXct or POSIXlt dates from the beginning, as this will make things
>like
>> plotting in date order straightforward. There are also date-time
>packages
>> (in the "tidyverse" suite, I think,  as well as others) that simplify
>such
>> things. I am pretty ignorant about date-time stuff, so I can't really
>be
>> more specific. https://cran.r-project.org/web/views/TimeSeries.html 
>will
>> have lots of info on this if you need it. As well as searching, of
>course.
>>
>> HTH
>>
>> Bert Gunter
>>
>> "The trouble with having an open mind is that people keep coming
>along and
>> sticking things into it."
>> -- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )
>>
>>
>> On Tue, Apr 13, 2021 at 3:26 AM Elahe chalabi via R-help <
>> r-help at r-project.org> wrote:
>>
>>> Hi all,
>>>
>>> I have the prediction for my test set which are forecasted Value for
>>> "4/1/2020" for each match of "id" and "Group". I would like to add a
>fourth
>>> row to each group by (Group,id) in my train set and the values for
>this row
>>> should come from test set :
>>>
>>> my train set:
>>>
>>>      structure(list(Date = c("1/1/2020", "2/1/2020", "3/1/2020",
>>> "1/1/2020",
>>>      "2/1/2020", "3/1/2020", "1/1/2020", "2/1/2020", "3/1/2020", ""
>>>      ), Value = c(3.5, 2.7, 4, 2.5, 3.7, 0, 3, 0, 1, NA), Group =
>c("A",
>>>     "A", "A", "B", "B", "B", "C", "C", "C", ""), id = c(1L, 1L, 1L,
>>>     101L, 101L, 101L, 100L, 100L, 100L, NA)), class = "data.frame",
>>> row.names = c(NA,
>>>     -10L))
>>>
>>> test set:
>>>
>>>     structure(list(Date = c("4/1/2020", "4/1/2020", "4/1/2020", ""
>>>       ), Value = c(3.5, 2.5, 3, NA), Group = c("A", "B", "C", ""),
>>>     id = c(1L, 101L, 100L, NA), value = c(0.2, 0.7, 0.9, NA)), class
>=
>>> "data.frame", row.names = c(NA,
>>>      -4L))structure(list(Date = c("4/1/2020", "4/1/2020",
>"4/1/2020", ""
>>>     ), Value = c(3.5, 2.5, 3, NA), Group = c("A", "B", "C", ""),
>>>     id = c(1L, 101L, 100L, NA)), class = "data.frame", row.names =
>c(NA,
>>>     -4L))
>>>
>>> desired output:
>>>
>>>     structure(list(Date = c("1/1/2020", "2/1/2020", "3/1/2020",
>>> "4/1/2020",
>>>     "1/1/2020", "2/1/2020", "3/1/2020", "4/1/2020", "1/1/2020",
>>> "2/1/2020",
>>>     "3/1/2020", "4/1/2020"), Value = c(3.5, 2.7, 4, 0.2, 2.5, 3.7,
>>>      0, 0.7, 3, 0, 1, 0.9), Group = c("A", "A", "A", "A", "B", "B",
>>>     "B", "B", "C", "C", "C", "C"), id = c(1L, 1L, 1L, 1L, 101L,
>101L,
>>>     101L, 101L, 100L, 100L, 100L, 100L)), class = "data.frame",
>row.names
>>> = c(NA,
>>>    -12L))
>>>
>>> Data is dummy and I have milions of records in original data set.
>>>
>>> Thanks for any help.
>>> Elahe
>>>
>>>
>>> ______________________________________________
>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>> PLEASE do read the posting guide
>>> http://www.R-project.org/posting-guide.html
>>> and provide commented, minimal, self-contained, reproducible code.
>>>
>>
>
>	[[alternative HTML version deleted]]
>
>______________________________________________
>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>https://stat.ethz.ch/mailman/listinfo/r-help
>PLEASE do read the posting guide
>http://www.R-project.org/posting-guide.html
>and provide commented, minimal, self-contained, reproducible code.

-- 
Sent from my phone. Please excuse my brevity.


From m@015k3113 @end|ng |rom b|ueyonder@co@uk  Tue Apr 13 20:24:02 2021
From: m@015k3113 @end|ng |rom b|ueyonder@co@uk (e-mail ma015k3113)
Date: Tue, 13 Apr 2021 19:24:02 +0100 (BST)
Subject: [R] Looping through data error
In-Reply-To: <b4cd892a-a4c6-8635-e1b3-7fb4bf90f0ae@sapo.pt>
References: <59634000.142366.1618318281941@mail2.virginmedia.com>
 <b4cd892a-a4c6-8635-e1b3-7fb4bf90f0ae@sapo.pt>
Message-ID: <1129233458.153486.1618338243060@mail2.virginmedia.com>

Rui, excellent diagnosis and suggestion. It worked but my damn logic is still not delivering what I want-will spend more time on it tomorrow.


Kind regards

Ahson

> On 13 April 2021 at 17:06 Rui Barradas <ruipbarradas at sapo.pt> wrote:
> 
> 
> Hello,
> 
> A close parenthesis is missing in the nd if.
> 
> 
> for (i in 1:(nrow(PLC_Return)-1)){
>    if (i == 1){
>      NUMBER_OF_SHARES[i] = 100/is.na(CLOSE_SHARE_PRICE[i])
>    } else if(is.na(PLC_Return[i, 1]) == is.na(PLC_Return[i + 1, 1])){
>      NUMBER_OF_SHARES[i]=0
>    } else {
>      NUMBER_OF_SHARES[i] = 100/is.na(CLOSE_SHARE_PRICE[i])
>    }
> }
> 
> 
> Hope this helps,
> 
> Rui Barradas
> 
> ?s 13:51 de 13/04/21, e-mail ma015k3113 via R-help escreveu:
> > Dear All,I have a dataframe with 4 variables and I am trying to calculate how many shares can be purchased with ?100 in the first year when the company was listed
> > 
> > The data looks like:
> > 
> > COMPANY_NUMBER YEAR_END_DATE CLOSE_SHARE_PRICE  NUMBER_OF_SHARES
> > 22705                                30/09/2002                          NA                                 0
> > 22705                                30/09/2004                         NA                                  0
> > 22705                                30/09/2005                        6.55                                 0
> > 22705                                30/09/2006                        7.5                                   0
> > 22705                                30/09/2007                        9.65                                 0
> > 22705                                30/09/2008                        6.55                                 0
> > 1091347                            31/01/2010                        8.14                                 0
> > 1091347                             31/01/2011                      11.38                                 0
> > 11356069                           30/06/2019                      1.09                                   0
> > SC192761                         31/01/2000                         NA                                   0
> > SC192761                         31/01/2001                         NA                                   0
> > SC192761                          31/01/2002                        NA                                   0
> > SC192761                         31/01/2004                         NA                                   0
> > SC192761                         31/01/2005                         NA                                   0
> > SC192761                          31/01/2006                      1.09                                   0
> > SC192761                          31/01/2008                      1.24                                   0
> > SC192761                          31/01/2009                       0.9                                    0
> > SC192761                          31/01/2010                     1.14                                    0
> > SC192761                           31/01/2011                    1.25                                    0
> > SC192761                          31/01/2012                     1.29                                    0
> > 
> > 
> > The code I have written is
> > 
> > i <- 0
> > 
> > for (i in 1:(nrow(PLC_Return)-1))
> > if (i == 1)
> > {
> > NUMBER_OF_SHARES[i] = 100/is.na(CLOSE_SHARE_PRICE[i])
> > } else if
> > (is.na(PLC_Return[i, 1]) == is.na(PLC_Return[i + 1, 1])
> > {
> > NUMBER_OF_SHARES[i]=0
> > } else
> > {
> > NUMBER_OF_SHARES[i] = 100/is.na(CLOSE_SHARE_PRICE[i])
> > }
> > 
> > 
> > The error I get is Error: unexpected 'else' in:
> > 
> > " NUMBER_OF_SHARES[i] = 0
> > } else"
> >> {NUMBER_OF_SHARES[i] = 100/is.na(CLOSE_SHARE_PRICE[i])}
> >>
> >> }
> > Error: unexpected '}' in "}"
> > 
> > 
> > Don't know how to fix it-any help will be appreciated.
> > 
> > 
> > Kind regards
> > 
> > 
> > Ahson
> > 	[[alternative HTML version deleted]]
> > 
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.
> >


From bgunter@4567 @end|ng |rom gm@||@com  Tue Apr 13 22:33:26 2021
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Tue, 13 Apr 2021 13:33:26 -0700
Subject: [R] Looping through data error
In-Reply-To: <1129233458.153486.1618338243060@mail2.virginmedia.com>
References: <59634000.142366.1618318281941@mail2.virginmedia.com>
 <b4cd892a-a4c6-8635-e1b3-7fb4bf90f0ae@sapo.pt>
 <1129233458.153486.1618338243060@mail2.virginmedia.com>
Message-ID: <CAGxFJbQAYaUnEiyEYWQmqkBYAz3eAzvdV=_-=6Xcfpyf74egrQ@mail.gmail.com>

Well, if I understand your query, wouldn't the following simple approach
suffice -- it assumes that the results for each company are ordered by
year, as your example seems to show:

## test is your example data
## first remove NA's
test2 <- na.omit(test)

## Now just use tapply():
> out <-with(test2, tapply(CLOSE_SHARE_PRICE, COMPANY_NUMBER,
+                       FUN =function(x)100 /x[1]))
> out
 1091347 11356069    22705 SC192761
12.28501 91.74312 15.26718 91.74312
## essentially a labelled vector
##You can use  %/% if you only want the whole number of shares that can be
purchased

It's somewhat messier if the results are not ordered by date within company
-- you could use by() and POSIXct to order the dates within company to get
the right one.

Cheers,

Bert Gunter

"The trouble with having an open mind is that people keep coming along and
sticking things into it."
-- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )


On Tue, Apr 13, 2021 at 11:34 AM e-mail ma015k3113 via R-help <
r-help at r-project.org> wrote:

> Rui, excellent diagnosis and suggestion. It worked but my damn logic is
> still not delivering what I want-will spend more time on it tomorrow.
>
>
> Kind regards
>
> Ahson
>
> > On 13 April 2021 at 17:06 Rui Barradas <ruipbarradas at sapo.pt> wrote:
> >
> >
> > Hello,
> >
> > A close parenthesis is missing in the nd if.
> >
> >
> > for (i in 1:(nrow(PLC_Return)-1)){
> >    if (i == 1){
> >      NUMBER_OF_SHARES[i] = 100/is.na(CLOSE_SHARE_PRICE[i])
> >    } else if(is.na(PLC_Return[i, 1]) == is.na(PLC_Return[i + 1, 1])){
> >      NUMBER_OF_SHARES[i]=0
> >    } else {
> >      NUMBER_OF_SHARES[i] = 100/is.na(CLOSE_SHARE_PRICE[i])
> >    }
> > }
> >
> >
> > Hope this helps,
> >
> > Rui Barradas
> >
> > ?s 13:51 de 13/04/21, e-mail ma015k3113 via R-help escreveu:
> > > Dear All,I have a dataframe with 4 variables and I am trying to
> calculate how many shares can be purchased with ?100 in the first year when
> the company was listed
> > >
> > > The data looks like:
> > >
> > > COMPANY_NUMBER YEAR_END_DATE CLOSE_SHARE_PRICE  NUMBER_OF_SHARES
> > > 22705                                30/09/2002
>   NA                                 0
> > > 22705                                30/09/2004
>  NA                                  0
> > > 22705                                30/09/2005
> 6.55                                 0
> > > 22705                                30/09/2006
> 7.5                                   0
> > > 22705                                30/09/2007
> 9.65                                 0
> > > 22705                                30/09/2008
> 6.55                                 0
> > > 1091347                            31/01/2010
> 8.14                                 0
> > > 1091347                             31/01/2011
> 11.38                                 0
> > > 11356069                           30/06/2019
> 1.09                                   0
> > > SC192761                         31/01/2000
>  NA                                   0
> > > SC192761                         31/01/2001
>  NA                                   0
> > > SC192761                          31/01/2002
> NA                                   0
> > > SC192761                         31/01/2004
>  NA                                   0
> > > SC192761                         31/01/2005
>  NA                                   0
> > > SC192761                          31/01/2006
> 1.09                                   0
> > > SC192761                          31/01/2008
> 1.24                                   0
> > > SC192761                          31/01/2009
>  0.9                                    0
> > > SC192761                          31/01/2010                     1.14
>                                   0
> > > SC192761                           31/01/2011                    1.25
>                                   0
> > > SC192761                          31/01/2012                     1.29
>                                   0
> > >
> > >
> > > The code I have written is
> > >
> > > i <- 0
> > >
> > > for (i in 1:(nrow(PLC_Return)-1))
> > > if (i == 1)
> > > {
> > > NUMBER_OF_SHARES[i] = 100/is.na(CLOSE_SHARE_PRICE[i])
> > > } else if
> > > (is.na(PLC_Return[i, 1]) == is.na(PLC_Return[i + 1, 1])
> > > {
> > > NUMBER_OF_SHARES[i]=0
> > > } else
> > > {
> > > NUMBER_OF_SHARES[i] = 100/is.na(CLOSE_SHARE_PRICE[i])
> > > }
> > >
> > >
> > > The error I get is Error: unexpected 'else' in:
> > >
> > > " NUMBER_OF_SHARES[i] = 0
> > > } else"
> > >> {NUMBER_OF_SHARES[i] = 100/is.na(CLOSE_SHARE_PRICE[i])}
> > >>
> > >> }
> > > Error: unexpected '}' in "}"
> > >
> > >
> > > Don't know how to fix it-any help will be appreciated.
> > >
> > >
> > > Kind regards
> > >
> > >
> > > Ahson
> > >     [[alternative HTML version deleted]]
> > >
> > > ______________________________________________
> > > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > > https://stat.ethz.ch/mailman/listinfo/r-help
> > > PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> > > and provide commented, minimal, self-contained, reproducible code.
> > >
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From p@u| @end|ng |rom @t@t@@uck|@nd@@c@nz  Wed Apr 14 04:37:48 2021
From: p@u| @end|ng |rom @t@t@@uck|@nd@@c@nz (Paul Murrell)
Date: Wed, 14 Apr 2021 14:37:48 +1200
Subject: [R] 
 graphics useRaster check_irregular definition for date or posix
In-Reply-To: <c5279327071e612bd17d1d69b8f16496@posteo.de>
References: <c5279327071e612bd17d1d69b8f16496@posteo.de>
Message-ID: <5d3a892b-06b3-71fc-46bf-f2c8b90899f7@stat.auckland.ac.nz>

Hi

I doubt it is intended (to deliberately exclude "difftime" objects).

Can you please supply a full image() example (with 'x' and/or 'y' as 
Dates and a 'z') ?  So that I can see what ...

image(x, y, z, useRaster=FALSE)

... looks like, so I can see what you want ...

image(x, y, z, useRaster=TRUE)

... to look like.

I also wonder whether switching to ...

dx[1][rep(1, length(dx))]

... might be better than switching to ...

as.numeric(dx)

It produces the same result for "difftime" objects, and may have a 
better chance of working better with other objects (although I confess 
that not having thought of using a "difftime" for 'x' I am also failing 
to think of further possibilities for 'x').

Paul

On 14/04/21 3:11 am, cdanek at posteo.de wrote:
> Hi
> 
> The function `check_irregular()` defined within
> `graphics::image.default()` checks if the `useRaster` argument for
> `graphics::image()` can be true or must be false.
> 
> According to this function, the following example vector is irregular:
> ```
> time <- seq(as.Date("2020-1-1"), as.Date("2020-12-31"), l=12)
> check_irregular(time, time)
> # TRUE
> ```
> In my view, this is not correct.
> 
> In this case, the `all.equal`-call does not evaluate to true due to the
> special class of `dx` (or `dy`). If I slightly rewrite the function as
> ```
> my_check_irregular <- function (x, y)
> {
> dx <- as.numeric(diff(x))
> dy <- as.numeric(diff(y))
> (length(dx) && !isTRUE(all.equal(dx, rep(dx[1], length(dx))))) ||
> (length(dy) && !isTRUE(all.equal(dy, rep(dy[1], length(dy)))))
> }
> ```
> the correct answer is obtained (i.e. that the input vector is not
> irregular based on the rational behind `all.equal`):
> ```
> my_check_irregular(time, time)
> # FALSE
> ```
> 
> The same applies to POSIX* objects. I was wondering if this is intended
> or not?
> 
> Thanks a lot for any answer,
> Chris
> [[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help 
> <https://stat.ethz.ch/mailman/listinfo/r-help>
> PLEASE do read the posting guide 
> http://www.R-project.org/posting-guide.html 
> <http://www.R-project.org/posting-guide.html>
> and provide commented, minimal, self-contained, reproducible code.

-- 
Dr Paul Murrell
Department of Statistics
The University of Auckland
Private Bag 92019
Auckland
New Zealand
64 9 3737599 x85392
paul at stat.auckland.ac.nz
http://www.stat.auckland.ac.nz/~paul/


From mbrockw@y @end|ng |rom mtech@edu  Tue Apr 13 18:19:03 2021
From: mbrockw@y @end|ng |rom mtech@edu (Brockway, Molly)
Date: Tue, 13 Apr 2021 16:19:03 +0000
Subject: [R] How to force boundary conditions on discretized derivative in
 deSolve?
Message-ID: <CY4PR15MB12698FB5F66018F0AB4C5FDFA24F9@CY4PR15MB1269.namprd15.prod.outlook.com>

Hello,

I am using R package deSolve to solve a system of two differential equations for a one-dimensional spatial and time-based problem. There is one ODE and a second-order PDE. In order to solve with the function ode.1D, I've discretized the spatial derivative and put both equations in terms of the time derivative only. However, I'm now stuck with the problem of being unable to impose boundary conditions on the spatial derivative for flux at the edges of the system. How can I force a value for the discretized dE/dx part of my equations at x = 0 and x = 1?

The code I have been using is below. The ode.1D solver will run on it, but the solutions aren't correct for my system owing to the missing boundary conditions.

Thanks,

Molly C Brockway
Materials Science - PhD Candidate
Metallurgical and Materials Engineering - B.S.

Montana Technological University


```
BVmod1D <- function(time, state, parms, N, dx) {
? with(as.list(parms), {
? ? U <- state[1 : N]
? ? E <- state[(N + 1) : (2 * N)]
? ? 
? ? coef1 <- Sv * io / (Qox - Qred)
? ? coef2 <- Tau * io / Cd
? ? BV <- exp(aa * f * (E - 0.5 * (U) )) - exp(-ac * f * (E - 0.5 * (1 + U)))

? ? dEdx <- diff(c(E, E[N])) / dx # first spatial derivative of E
? ? ddEddx <- diff(c(dEdx, dEdx[N])) / dx # second spatial derivative of E
? 
? ? dU <- coef1 * BV   
? ? dE <- (ddEddx - (coef2 * BV)) / Tau 

? ? return(list(c(dU, dE)))
? })
}

pars <- c(Sv = 1.72e5, 
? ? ? ? ? io = 1.71e-6, 
? ? ? ? ? Qox = 1.56, 
? ? ? ? ? Qred = 0,
? ? ? ? ? Tau = 3.79e-6, 
? ? ? ? ? Cd = 7.42e-8, 
? ? ? ? ? aa = 0.7674, 
? ? ? ? ? ac = 0.2326, 
? ? ? ? ? ks = 0.042992, 
? ? ? ? ? sig = 1.67e-6, 
? ? ? ? ? f = 38.92237)

R <- 1
N <- 50
dx <- R / N
Vo <- 0.5

# Initial and Boundary Conditions
yini <- rep(0, (2 * N))
yini[ 1 : N ] <- 2 * Vo
yini[ (N + 1) : (2 * N)] <- 1 
times <- seq(0, 1 , by = 0.002 )

out <- ode.1D(
? y = yini,
? times = times,
? func = BVmod1D,
? parms = pars,
? nspec = 2,
? N = N,
? dx = dx
)
```



















From mcg@rvey@bern@rd @end|ng |rom comc@@t@net  Wed Apr 14 19:42:15 2021
From: mcg@rvey@bern@rd @end|ng |rom comc@@t@net (Bernard McGarvey)
Date: Wed, 14 Apr 2021 13:42:15 -0400 (EDT)
Subject: [R] Error loading "XLConnect" library
Message-ID: <635919934.197924.1618422135644@connect.xfinity.com>

I installed the "XLConnect" package which appears to be successful and then tried to load the "XLConnect" library and got an error as shown below. Any ideas as to where to look for the source of the error? The word "release" in the error message makes me think it is some issue with the version of "XLConnect" but that is just a guess.

I am running the latest version of R available on CRAN on Windows 10.

> install.packages("XLConnect")
Installing package into ?E:/Data/OneDrive/Documents/R/win-library/4.0?
(as ?lib? is unspecified)
trying URL 'https://cran.rstudio.com/bin/windows/contrib/4.0/XLConnect_1.0.3.zip'
Content type 'application/zip' length 29498979 bytes (28.1 MB)
downloaded 28.1 MB
package ?XLConnect? successfully unpacked and MD5 sums checked
The downloaded binary packages are in
C:\Users\User\AppData\Local\Temp\RtmpARt8Er\downloaded_packages

> library(XLConnect)
Error: package or namespace load failed for ?XLConnect?:
.onLoad failed in loadNamespace() for 'XLConnect', details:
call: system2("cat", c("/etc/*-release"), stdout = TRUE, stderr = TRUE)
error: '"cat"' not found

> library("XLConnect")
Error: package or namespace load failed for ?XLConnect?:
.onLoad failed in loadNamespace() for 'XLConnect', details:
call: system2("cat", c("/etc/*-release"), stdout = TRUE, stderr = TRUE)
error: '"cat"' not found



Thanks



Bernard McGarvey

Director, Fort Myers Beach Lions Foundation, Inc.

Retired (Lilly Engineering Fellow).




	[[alternative HTML version deleted]]


From bgunter@4567 @end|ng |rom gm@||@com  Wed Apr 14 19:59:30 2021
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Wed, 14 Apr 2021 10:59:30 -0700
Subject: [R] 
 How to force boundary conditions on discretized derivative in
 deSolve?
In-Reply-To: <CY4PR15MB12698FB5F66018F0AB4C5FDFA24F9@CY4PR15MB1269.namprd15.prod.outlook.com>
References: <CY4PR15MB12698FB5F66018F0AB4C5FDFA24F9@CY4PR15MB1269.namprd15.prod.outlook.com>
Message-ID: <CAGxFJbQ=e9VwieLqXAjDUYhLa7SELZhPAKmaK2O6ZBtBAezeWg@mail.gmail.com>

1. Your query is off topic. See the posting guide linked below for what is
appropriate. In particular, note:
"*Questions about statistics:* The R mailing lists are primarily intended
for questions and discussion about the R software. However, questions about
statistical methodology are sometimes posted. If the question is well-asked
and of interest to someone on the list, it *may* elicit an informative
up-to-date answer."

and

"For questions about functions in standard packages distributed with R (see
the FAQ Add-on packages in R
<https://cran.r-project.org/doc/FAQ/R-FAQ.html#Add-on-packages-in-R>), ask
questions on R-help.
If the question relates to a *contributed package* , e.g., one downloaded
from CRAN, try contacting the package maintainer first. You can also use
find("functionname") and packageDescription("packagename") to find this
information. *Only* send such questions to R-help or R-devel if you get no
reply or need further assistance. This applies to both requests for help
and to bug reports."

2. See https://cran.r-project.org/web/views/DifferentialEquations.html  .
Note especially the link to the dynamic models SIG therein, which I assume
might be helpful to you.

Cheers,
Bert

Bert Gunter

"The trouble with having an open mind is that people keep coming along and
sticking things into it."
-- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )


On Wed, Apr 14, 2021 at 7:05 AM Brockway, Molly <mbrockway at mtech.edu> wrote:

> Hello,
>
> I am using R package deSolve to solve a system of two differential
> equations for a one-dimensional spatial and time-based problem. There is
> one ODE and a second-order PDE. In order to solve with the function ode.1D,
> I've discretized the spatial derivative and put both equations in terms of
> the time derivative only. However, I'm now stuck with the problem of being
> unable to impose boundary conditions on the spatial derivative for flux at
> the edges of the system. How can I force a value for the discretized dE/dx
> part of my equations at x = 0 and x = 1?
>
> The code I have been using is below. The ode.1D solver will run on it, but
> the solutions aren't correct for my system owing to the missing boundary
> conditions.
>
> Thanks,
>
> Molly C Brockway
> Materials Science - PhD Candidate
> Metallurgical and Materials Engineering - B.S.
>
> Montana Technological University
>
>
> ```
> BVmod1D <- function(time, state, parms, N, dx) {
>   with(as.list(parms), {
>     U <- state[1 : N]
>     E <- state[(N + 1) : (2 * N)]
>
>     coef1 <- Sv * io / (Qox - Qred)
>     coef2 <- Tau * io / Cd
>     BV <- exp(aa * f * (E - 0.5 * (U) )) - exp(-ac * f * (E - 0.5 * (1 +
> U)))
>
>     dEdx <- diff(c(E, E[N])) / dx # first spatial derivative of E
>     ddEddx <- diff(c(dEdx, dEdx[N])) / dx # second spatial derivative of E
>
>     dU <- coef1 * BV
>     dE <- (ddEddx - (coef2 * BV)) / Tau
>
>     return(list(c(dU, dE)))
>   })
> }
>
> pars <- c(Sv = 1.72e5,
>           io = 1.71e-6,
>           Qox = 1.56,
>           Qred = 0,
>           Tau = 3.79e-6,
>           Cd = 7.42e-8,
>           aa = 0.7674,
>           ac = 0.2326,
>           ks = 0.042992,
>           sig = 1.67e-6,
>           f = 38.92237)
>
> R <- 1
> N <- 50
> dx <- R / N
> Vo <- 0.5
>
> # Initial and Boundary Conditions
> yini <- rep(0, (2 * N))
> yini[ 1 : N ] <- 2 * Vo
> yini[ (N + 1) : (2 * N)] <- 1
> times <- seq(0, 1 , by = 0.002 )
>
> out <- ode.1D(
>   y = yini,
>   times = times,
>   func = BVmod1D,
>   parms = pars,
>   nspec = 2,
>   N = N,
>   dx = dx
> )
> ```
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Wed Apr 14 20:19:25 2021
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Wed, 14 Apr 2021 19:19:25 +0100
Subject: [R] Error loading "XLConnect" library
In-Reply-To: <635919934.197924.1618422135644@connect.xfinity.com>
References: <635919934.197924.1618422135644@connect.xfinity.com>
Message-ID: <661a752b-dd22-c362-54b6-4d549ae2e30b@sapo.pt>

Hello,

That is a unix/linux command and you are on Windows. The cat command and 
other unix/linux commands can be installed when you install Rtools [1].

It is not well seen to cross post [2].

[1] https://cran.r-project.org/bin/windows/Rtools/
[2] 
https://stackoverflow.com/questions/67087299/error-package-or-namespace-load-failed-for-xlconnect

Hope this helps,

Rui Barradas


?s 18:42 de 14/04/21, Bernard McGarvey escreveu:
> I installed the "XLConnect" package which appears to be successful and then tried to load the "XLConnect" library and got an error as shown below. Any ideas as to where to look for the source of the error? The word "release" in the error message makes me think it is some issue with the version of "XLConnect" but that is just a guess.
> 
> I am running the latest version of R available on CRAN on Windows 10.
> 
>> install.packages("XLConnect")
> Installing package into ?E:/Data/OneDrive/Documents/R/win-library/4.0?
> (as ?lib? is unspecified)
> trying URL 'https://cran.rstudio.com/bin/windows/contrib/4.0/XLConnect_1.0.3.zip'
> Content type 'application/zip' length 29498979 bytes (28.1 MB)
> downloaded 28.1 MB
> package ?XLConnect? successfully unpacked and MD5 sums checked
> The downloaded binary packages are in
> C:\Users\User\AppData\Local\Temp\RtmpARt8Er\downloaded_packages
> 
>> library(XLConnect)
> Error: package or namespace load failed for ?XLConnect?:
> .onLoad failed in loadNamespace() for 'XLConnect', details:
> call: system2("cat", c("/etc/*-release"), stdout = TRUE, stderr = TRUE)
> error: '"cat"' not found
> 
>> library("XLConnect")
> Error: package or namespace load failed for ?XLConnect?:
> .onLoad failed in loadNamespace() for 'XLConnect', details:
> call: system2("cat", c("/etc/*-release"), stdout = TRUE, stderr = TRUE)
> error: '"cat"' not found
> 
> 
> 
> Thanks
> 
> 
> 
> Bernard McGarvey
> 
> Director, Fort Myers Beach Lions Foundation, Inc.
> 
> Retired (Lilly Engineering Fellow).
> 
> 
> 
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>


From m@rc_@chw@rtz @end|ng |rom me@com  Wed Apr 14 20:20:51 2021
From: m@rc_@chw@rtz @end|ng |rom me@com (Marc Schwartz)
Date: Wed, 14 Apr 2021 14:20:51 -0400
Subject: [R] Error loading "XLConnect" library
In-Reply-To: <635919934.197924.1618422135644@connect.xfinity.com>
References: <635919934.197924.1618422135644@connect.xfinity.com>
Message-ID: <d0ab8791-4633-7468-ca1e-dc1812abc7f7@me.com>

Hi,

When you experience errors with a third party package like that, one of 
the first steps to take is to review the results of CRAN testing on the 
package. That is available via the "CRAN checks:" link on the package page:

   https://cran.r-project.org/web/packages/XLConnect/index.html

That link takes you to:

   https://cran.r-project.org/web/checks/check_results_XLConnect.html

where you can see that there are NOTEs and ERRORs being reported across 
multiple platforms.

I would therefore contact the package maintainer and inquire as to the 
current status of the package, plans to resolve the outstanding issues, 
and a workaround in the mean time.

 From a review of the Issues page on the package's Github site, there 
appear to be a number of such reports already:

   https://github.com/miraisolutions/xlconnect/issues

So you may want to review those communications first.

Regards,

Marc Schwartz


Bernard McGarvey wrote on 4/14/21 1:42 PM:
> I installed the "XLConnect" package which appears to be successful and then tried to load the "XLConnect" library and got an error as shown below. Any ideas as to where to look for the source of the error? The word "release" in the error message makes me think it is some issue with the version of "XLConnect" but that is just a guess.
> 
> I am running the latest version of R available on CRAN on Windows 10.
> 
>> install.packages("XLConnect")
> Installing package into ?E:/Data/OneDrive/Documents/R/win-library/4.0?
> (as ?lib? is unspecified)
> trying URL 'https://cran.rstudio.com/bin/windows/contrib/4.0/XLConnect_1.0.3.zip'
> Content type 'application/zip' length 29498979 bytes (28.1 MB)
> downloaded 28.1 MB
> package ?XLConnect? successfully unpacked and MD5 sums checked
> The downloaded binary packages are in
> C:\Users\User\AppData\Local\Temp\RtmpARt8Er\downloaded_packages
> 
>> library(XLConnect)
> Error: package or namespace load failed for ?XLConnect?:
> .onLoad failed in loadNamespace() for 'XLConnect', details:
> call: system2("cat", c("/etc/*-release"), stdout = TRUE, stderr = TRUE)
> error: '"cat"' not found
> 
>> library("XLConnect")
> Error: package or namespace load failed for ?XLConnect?:
> .onLoad failed in loadNamespace() for 'XLConnect', details:
> call: system2("cat", c("/etc/*-release"), stdout = TRUE, stderr = TRUE)
> error: '"cat"' not found
> 
> 
> 
> Thanks
> 
> 
> 
> Bernard McGarvey
> 
> Director, Fort Myers Beach Lions Foundation, Inc.
> 
> Retired (Lilly Engineering Fellow).
> 
> 
> 
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>


From mcg@rvey@bern@rd @end|ng |rom comc@@t@net  Wed Apr 14 20:36:58 2021
From: mcg@rvey@bern@rd @end|ng |rom comc@@t@net (Bernard Comcast)
Date: Wed, 14 Apr 2021 14:36:58 -0400
Subject: [R] Error loading "XLConnect" library
In-Reply-To: <d0ab8791-4633-7468-ca1e-dc1812abc7f7@me.com>
References: <d0ab8791-4633-7468-ca1e-dc1812abc7f7@me.com>
Message-ID: <E25A696F-A96F-43BC-8029-D187B5F97198@comcast.net>

Thanks Marc

Bernard
Sent from my iPhone so please excuse the spelling!"

> On Apr 14, 2021, at 2:20 PM, Marc Schwartz <marc_schwartz at me.com> wrote:
> 
> ?Hi,
> 
> When you experience errors with a third party package like that, one of the first steps to take is to review the results of CRAN testing on the package. That is available via the "CRAN checks:" link on the package page:
> 
>  https://cran.r-project.org/web/packages/XLConnect/index.html
> 
> That link takes you to:
> 
>  https://cran.r-project.org/web/checks/check_results_XLConnect.html
> 
> where you can see that there are NOTEs and ERRORs being reported across multiple platforms.
> 
> I would therefore contact the package maintainer and inquire as to the current status of the package, plans to resolve the outstanding issues, and a workaround in the mean time.
> 
> From a review of the Issues page on the package's Github site, there appear to be a number of such reports already:
> 
>  https://github.com/miraisolutions/xlconnect/issues
> 
> So you may want to review those communications first.
> 
> Regards,
> 
> Marc Schwartz
> 
> 
> Bernard McGarvey wrote on 4/14/21 1:42 PM:
>> I installed the "XLConnect" package which appears to be successful and then tried to load the "XLConnect" library and got an error as shown below. Any ideas as to where to look for the source of the error? The word "release" in the error message makes me think it is some issue with the version of "XLConnect" but that is just a guess.
>> I am running the latest version of R available on CRAN on Windows 10.
>>> install.packages("XLConnect")
>> Installing package into ?E:/Data/OneDrive/Documents/R/win-library/4.0?
>> (as ?lib? is unspecified)
>> trying URL 'https://cran.rstudio.com/bin/windows/contrib/4.0/XLConnect_1.0.3.zip'
>> Content type 'application/zip' length 29498979 bytes (28.1 MB)
>> downloaded 28.1 MB
>> package ?XLConnect? successfully unpacked and MD5 sums checked
>> The downloaded binary packages are in
>> C:\Users\User\AppData\Local\Temp\RtmpARt8Er\downloaded_packages
>>> library(XLConnect)
>> Error: package or namespace load failed for ?XLConnect?:
>> .onLoad failed in loadNamespace() for 'XLConnect', details:
>> call: system2("cat", c("/etc/*-release"), stdout = TRUE, stderr = TRUE)
>> error: '"cat"' not found
>>> library("XLConnect")
>> Error: package or namespace load failed for ?XLConnect?:
>> .onLoad failed in loadNamespace() for 'XLConnect', details:
>> call: system2("cat", c("/etc/*-release"), stdout = TRUE, stderr = TRUE)
>> error: '"cat"' not found
>> Thanks
>> Bernard McGarvey
>> Director, Fort Myers Beach Lions Foundation, Inc.
>> Retired (Lilly Engineering Fellow).
>>    [[alternative HTML version deleted]]
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.


From bertc@rne|| @end|ng |rom gm@||@com  Wed Apr 14 23:34:11 2021
From: bertc@rne|| @end|ng |rom gm@||@com (Rob C)
Date: Wed, 14 Apr 2021 17:34:11 -0400
Subject: [R] LHS random number generator
Message-ID: <CAPtunJYnzUbPkStd_ZvdVeV-t_Zk+UO9XwUadS8suf_88WxWNQ@mail.gmail.com>

Shah,

I am the maintainer of the lhs package.  Please feel free to contact
package maintainers directly for help specific to their package.

If I understood your request, this is how I would construct the lhs...

prior_lhs <- data.frame(
  name = c("r_mu", "r_sd", "lmp", "gr_mu", "gr_sd", "alpha1",
"alpha2", "alpha3", "beta"),
  lower = c(0.00299, 0.001, 0.40, 0.14, 0.01, 0.0001, 0.0017, 0.005, 0.69),
  upper = c(0.00320, 0.002, 0.43, 0.16, 0.20, 0.0018, 0.0028, 0.009, 0.75),
  place = c(100000, 1000, 100, 100, 100, 10000, 10000, 1000, 100)
)
require(lhs)
nb_simul <- 10000
nparam <- nrow(prior_lhs)
random_tab <- randomLHS(nb_simul, nparam)
X <- random_tab
for (i in 1:nparam)
{
  X[,i] <- floor(qunif(random_tab[,i],
  prior_lhs$lower[i]*prior_lhs$place[i],
  prior_lhs$upper[i]*prior_lhs$place[i] + 1)) / prior_lhs$place[i]
}
apply(X, 2, range)


> On Apr 12, 2021, at 08:21, Shah Alam <dr.alamsolangi at gmail.com> wrote:
>
> Hello everyone,
>
> I am using the LHS package to generate a combination of a
> set of parameter values. However, I am not sure how to fix some parameter
> values to 2 decimal points.
> For example:
>
> I want to make combinations in such a way that values for parameter
> c("lmp", 0.40, 0.43) are taken as 0.40, 0.41, 0.42,0.43.
>
> My codes are:
>
> prior_lhs <- list(c("r_mu", 0.00299, 0.0032),
>                  c("r_sd", 0.001, 0.002),
>                  c("lmp", 0.40, 0.43),
>                  c("gr_mu", 0.14, 0.16),
>                  c("gr_sd", 0.01, 0.020),
>                  c("alpha1", 0.0001, 0.0018),
>                  c("alpha2", 0.0017, 0.0028),
>                  c("alpha3", 0.005, 0.009),
>                  c("beta", 0.69, 0.75)
> )
>
>
> ### Simulation with priors from LHS ####
> nb_simul <- 10000
> nparam <- length(prior_lhs)
> random_tab = randomLHS(nb_simul, nparam)
> lhs_index = 1
> param <- matrix(rep(0, nparam), nrow = 1, ncol = nparam)
>
> for (i in 1:nb_simul) {
>  temp_par <- matrix(rep(0, nparam), nrow = 1, ncol = nparam)
>  for (j in 1:nparam) {
>    temp_par[j] = as.numeric(prior_lhs[[j]][2]) +
>      (as.numeric(prior_lhs[[j]][3]) - as.numeric(prior_lhs[[j]][2])) *
> random_tab[lhs_index, j]
>  }
>  param <- rbind(param, temp_par)
>  lhs_index <- lhs_index+1
> }
> param <- param[-1,]
>
> Best regards,
> Shah
>
>       [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From ddey1 @end|ng |rom jhu@edu  Wed Apr 14 21:35:30 2021
From: ddey1 @end|ng |rom jhu@edu (Debangan Dey)
Date: Wed, 14 Apr 2021 19:35:30 +0000
Subject: [R] NLSR package newDeriv function
Message-ID: <BL0PR01MB49623F85F6B7A637A0404AC3FA4E9@BL0PR01MB4962.prod.exchangelabs.com>

Hi,

I am trying to solve a non-linear least square which has a function from R^3 -> R. Is it possible to define gradient using newDeriv for a 3-variate scalar function?

I am trying to use the genD function in numDeriv package to define numerical gradient and treat them as a function. So far, I have failed to do it for simple function as follows ?

f <- function(x,y){x+y}
grad.f <- function(x,y){z <- c(x,y)
  f2 <- function(z){f(z[1],z[2])}
  gd <- genD(f2,z)$D[,1:length(z)]
  return(gd)
}
newDeriv(f(x,y), grad.f(x,y))

This derivative definition is not working as the following error pops up ?

fd <- fnDeriv(~ f(x,y), c("x",?y?))
fd(c(1,2))
Error in .grad[, "x"] <- grad.f(x) :
  number of items to replace is not a multiple of replacement length


I know the above example would work if I just give expressions instead of using grad function in numDeriv but I am trying to use numDeriv::grad here to see if my toy example can be translated to the bigger function I would later use it on.

Thanks,
Debanga

--
Debangan Dey,
PhD Student in Biostatistics,
Johns Hopkins Bloomberg School of Public Health,
Baltimore, MD

	[[alternative HTML version deleted]]


From JH@rm@e @end|ng |rom roku@com  Wed Apr 14 23:36:58 2021
From: JH@rm@e @end|ng |rom roku@com (Jorgen Harmse)
Date: Wed, 14 Apr 2021 21:36:58 +0000
Subject: [R] Documentation of Trigonometric Functions.
Message-ID: <E0E46FFA-81F9-4C40-BAF1-4E138F186E01@roku.com>

Is correct but incomplete documentation considered a bug? The documentation of trigonometric functions goes into detail about branch cuts for asin etc., but does not discuss the discontinuities of atan2. (It also fails to explain the difference between asin(2) (NaN) and asin(2+0i) (pi/2-acosh(2)i).) Since atan2 accepts complex arguments, the discontinuities are not just on the half-axis with x<=0 and y=0.

I also think that documentation of trigonometric functions should link to hyperbolic functions and that documentation of hyperbolic functions should link to the exponential function.

Jorgen Harmse.




From mjherrer|@@t @end|ng |rom gm@||@com  Wed Apr 14 23:57:59 2021
From: mjherrer|@@t @end|ng |rom gm@||@com (maria jesus herrerias)
Date: Wed, 14 Apr 2021 23:57:59 +0200
Subject: [R] different dimensions in W and my data in moran and spatial model
Message-ID: <CAPvcma1VvHMvi49KROakn6GGaweE40AMD0EZsCkQxFTAhdJXBA@mail.gmail.com>

Hello everyone,

    I am writing my code in R to run the spatial models. I am learning this
at the moment.
    I have my data for 116 countries over the period 1990-2014,
    and I got the shapefile from the website below.
    The objective is to get the matrix to run the spatial models.
    In the code below, I can get the matrix for the world and also for the
subsample.
    But when I try to run the moran test or sar model I get an error.
    The error is related to the dimension of W (listw) and my dataset. So
any help,
    I would be grateful.

    Below my code just in case someone can help  here.

    # Load the required Packages.

    `library(spdep)          # Spatial Dependence: Weighting Schemes,
Statistics
    `library(rgdal)          # to read shapefiles

    #shapefiles (world map from diva-gis)

       # Read the panel data from stata format for the regression analysis
below.

    `library(foreign)

    `mydata <- read.dta("C:/Users/Usuario/Desktop/instituciones/revision
energy economics/
     spatial  panel in stata/countries_shp/neworiginal.dta")

    `fix(mydata)
    `attach(mydata)

    my data contains 116 countries from 1990 to 2014 in panel.

    # Prepare the dataset for panel data analysis in R.

    `library(plm)

    `mydata <- pdata.frame(mydata, index = c("id", "year"))


    # Read the shapefile and set up the working directory.

    `setwd("C:/Users/Usuario/Desktop/instituciones/revision energy
economics/spatial panel in stata/countries_shp")

    `worlddata <- readOGR("countries.shp")
    `names(worlddata)
    `summary(worlddata)

    # Get the centroids

    `coords <-coordinates(worlddata)

    A. Contiguity based relations

     1. First Order Queen Contiguity

    `queen.nb = poly2nb(worlddata, queen=TRUE)
    `summary(queen.nb)
    `plot(queen.nb,coords)


    # the numbers of neighbours of regions in the neighbours list.

    `cards <- card(queen.nb)

    # convert into a listw type based on contiguity row normalized

    `queen.listw <- nb2listw(queen.nb,style="W", zero.policy = TRUE)
    `summary(queen.listw,zero.policy=TRUE)

    #marginal effects
    `impacts(reg2, listw = listw1,zero.policy=TRUE)

    #marginal effects with p-values
    `summary(impacts(reg2, listw = listw1), R= 500, zstats =
TRUE,zero.policy=TRUE)

    `attributes(queen.listw)

     #Selection of a subset of countries to fit with mydataset (116
countries, the previous ones I did for all countries in the shapefile)


    `setwd("C:/Users/Usuario/Desktop/instituciones/revision energy
economics/spatial panel in stata/countries_shp")

    `worlddata <- readOGR("countries.shp")

    `queen.nb = poly2nb(worlddata, queen=TRUE)

    `coords <-coordinates(worlddata)

    `plot(queen.nb, coords)


    Following Roger Bivand example:

    `to.be.dropped <- c(1, 2, 5, 6, 8, 9, 10, 13, 14, 18, 20, 21, 23, 26,
28, 29, 31, 34, 36, 37, 39, 40, 41, 45, 46, 47, 48, 51, 52, 53, 55, 56, 58,
59, 62, 63, 64, 66, 68, 69, 74, 75, 77, 78, 79, 80, 81, 82, 85, 86, 87, 89,
90, 94, 95, 97, 98, 99, 100, 102, 103, 104, 105, 107, 109, 110, 118, 123,
124, 125, 127, 130, 131, 133, 134, 137, 138, 139, 140, 143, 145, 146, 148,
149, 151, 152, 153, 155, 157, 159, 161, 162, 166, 167, 170, 173, 175, 176,
177, 178, 181, 182, 183, 184, 186, 190, 193, 194, 195, 198, 199, 200, 201,
202, 203, 204, 205, 206, 207, 208, 211, 212, 213, 215, 216, 218, 219, 221,
222, 224, 226, 227, 228, 229, 232, 233, 237, 239, 240, 242, 246, 247, 248,
255, 258, 259, 260, 261, 265)
    sub.queen.nb <- subset(queen.nb,
      !(1:length(queen.nb) %in% to.be.dropped))
    which(!(attr(queen.nb, "region.id") %in%
      attr(sub.queen.nb, "region.id")))

    `sub.queen.listw <- nb2listw(sub.queen.nb,style="W", zero.policy = TRUE)

    so now, I have my 116 countries in the queen matrix.

    # My data and variables
    `y <- cbind(lei)
    `x <- cbind(lgdppcnew, lgdppcnew2, industryg, importsg, fdig)
    `xy <- cbind(mydata$x, mydata$y)
    `listw1 <- sub.queen.listw
    `coords <- coords

    #Define formula

    `reg.ols <- y ~ x


    # Autocorrelation test
    `lm.morantest(ols.eq1,listw1,zero.policy=TRUE)
    `plot.moran(ols.eq1,listw1)

    (here I get the error where it is said the objects have different
dimensions)

    `reg2 <- lagsarlm(ols.eq1, data = mydata, listw1, zero.policy=TRUE)
    `summary(reg2,correlation=TRUE, Nagelkerke=TRUE, Hausman=TRUE,
zero.policy=TRUE)

    (here I get the error where it is said the objects have different
dimensions)

     #marginal effects

    `impacts(reg2, listw = listw1,zero.policy=TRUE)

     #marginal effects with p-values

     `summary(impacts(reg2, listw = listw1), R= 500, zstats =
TRUE,zero.policy=TRUE)

     I don't know if it is for my panel data, the missing values or
something else.
     I tried also in Stata having similar issues.

     thanks in advance and my apologies if it is very naive question, but I
am stuck.

all the best
Maria Jesus

	[[alternative HTML version deleted]]


From bgunter@4567 @end|ng |rom gm@||@com  Thu Apr 15 00:42:02 2021
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Wed, 14 Apr 2021 15:42:02 -0700
Subject: [R] different dimensions in W and my data in moran and spatial
 model
In-Reply-To: <CAPvcma1VvHMvi49KROakn6GGaweE40AMD0EZsCkQxFTAhdJXBA@mail.gmail.com>
References: <CAPvcma1VvHMvi49KROakn6GGaweE40AMD0EZsCkQxFTAhdJXBA@mail.gmail.com>
Message-ID: <CAGxFJbSeBAXbqVvFviBW=NuGpppGm3r2uum8nH-mvYFgDbp8SQ@mail.gmail.com>

Almost certainly better posted on R-Sig-geo, not here.
See here for more info on R mailing lists:
https://www.r-project.org/mail.html

Bert Gunter

"The trouble with having an open mind is that people keep coming along and
sticking things into it."
-- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )


On Wed, Apr 14, 2021 at 3:32 PM maria jesus herrerias <
mjherreriast at gmail.com> wrote:

> Hello everyone,
>
>     I am writing my code in R to run the spatial models. I am learning this
> at the moment.
>     I have my data for 116 countries over the period 1990-2014,
>     and I got the shapefile from the website below.
>     The objective is to get the matrix to run the spatial models.
>     In the code below, I can get the matrix for the world and also for the
> subsample.
>     But when I try to run the moran test or sar model I get an error.
>     The error is related to the dimension of W (listw) and my dataset. So
> any help,
>     I would be grateful.
>
>     Below my code just in case someone can help  here.
>
>     # Load the required Packages.
>
>     `library(spdep)          # Spatial Dependence: Weighting Schemes,
> Statistics
>     `library(rgdal)          # to read shapefiles
>
>     #shapefiles (world map from diva-gis)
>
>        # Read the panel data from stata format for the regression analysis
> below.
>
>     `library(foreign)
>
>     `mydata <- read.dta("C:/Users/Usuario/Desktop/instituciones/revision
> energy economics/
>      spatial  panel in stata/countries_shp/neworiginal.dta")
>
>     `fix(mydata)
>     `attach(mydata)
>
>     my data contains 116 countries from 1990 to 2014 in panel.
>
>     # Prepare the dataset for panel data analysis in R.
>
>     `library(plm)
>
>     `mydata <- pdata.frame(mydata, index = c("id", "year"))
>
>
>     # Read the shapefile and set up the working directory.
>
>     `setwd("C:/Users/Usuario/Desktop/instituciones/revision energy
> economics/spatial panel in stata/countries_shp")
>
>     `worlddata <- readOGR("countries.shp")
>     `names(worlddata)
>     `summary(worlddata)
>
>     # Get the centroids
>
>     `coords <-coordinates(worlddata)
>
>     A. Contiguity based relations
>
>      1. First Order Queen Contiguity
>
>     `queen.nb = poly2nb(worlddata, queen=TRUE)
>     `summary(queen.nb)
>     `plot(queen.nb,coords)
>
>
>     # the numbers of neighbours of regions in the neighbours list.
>
>     `cards <- card(queen.nb)
>
>     # convert into a listw type based on contiguity row normalized
>
>     `queen.listw <- nb2listw(queen.nb,style="W", zero.policy = TRUE)
>     `summary(queen.listw,zero.policy=TRUE)
>
>     #marginal effects
>     `impacts(reg2, listw = listw1,zero.policy=TRUE)
>
>     #marginal effects with p-values
>     `summary(impacts(reg2, listw = listw1), R= 500, zstats =
> TRUE,zero.policy=TRUE)
>
>     `attributes(queen.listw)
>
>      #Selection of a subset of countries to fit with mydataset (116
> countries, the previous ones I did for all countries in the shapefile)
>
>
>     `setwd("C:/Users/Usuario/Desktop/instituciones/revision energy
> economics/spatial panel in stata/countries_shp")
>
>     `worlddata <- readOGR("countries.shp")
>
>     `queen.nb = poly2nb(worlddata, queen=TRUE)
>
>     `coords <-coordinates(worlddata)
>
>     `plot(queen.nb, coords)
>
>
>     Following Roger Bivand example:
>
>     `to.be.dropped <- c(1, 2, 5, 6, 8, 9, 10, 13, 14, 18, 20, 21, 23, 26,
> 28, 29, 31, 34, 36, 37, 39, 40, 41, 45, 46, 47, 48, 51, 52, 53, 55, 56, 58,
> 59, 62, 63, 64, 66, 68, 69, 74, 75, 77, 78, 79, 80, 81, 82, 85, 86, 87, 89,
> 90, 94, 95, 97, 98, 99, 100, 102, 103, 104, 105, 107, 109, 110, 118, 123,
> 124, 125, 127, 130, 131, 133, 134, 137, 138, 139, 140, 143, 145, 146, 148,
> 149, 151, 152, 153, 155, 157, 159, 161, 162, 166, 167, 170, 173, 175, 176,
> 177, 178, 181, 182, 183, 184, 186, 190, 193, 194, 195, 198, 199, 200, 201,
> 202, 203, 204, 205, 206, 207, 208, 211, 212, 213, 215, 216, 218, 219, 221,
> 222, 224, 226, 227, 228, 229, 232, 233, 237, 239, 240, 242, 246, 247, 248,
> 255, 258, 259, 260, 261, 265)
>     sub.queen.nb <- subset(queen.nb,
>       !(1:length(queen.nb) %in% to.be.dropped))
>     which(!(attr(queen.nb, "region.id") %in%
>       attr(sub.queen.nb, "region.id")))
>
>     `sub.queen.listw <- nb2listw(sub.queen.nb,style="W", zero.policy =
> TRUE)
>
>     so now, I have my 116 countries in the queen matrix.
>
>     # My data and variables
>     `y <- cbind(lei)
>     `x <- cbind(lgdppcnew, lgdppcnew2, industryg, importsg, fdig)
>     `xy <- cbind(mydata$x, mydata$y)
>     `listw1 <- sub.queen.listw
>     `coords <- coords
>
>     #Define formula
>
>     `reg.ols <- y ~ x
>
>
>     # Autocorrelation test
>     `lm.morantest(ols.eq1,listw1,zero.policy=TRUE)
>     `plot.moran(ols.eq1,listw1)
>
>     (here I get the error where it is said the objects have different
> dimensions)
>
>     `reg2 <- lagsarlm(ols.eq1, data = mydata, listw1, zero.policy=TRUE)
>     `summary(reg2,correlation=TRUE, Nagelkerke=TRUE, Hausman=TRUE,
> zero.policy=TRUE)
>
>     (here I get the error where it is said the objects have different
> dimensions)
>
>      #marginal effects
>
>     `impacts(reg2, listw = listw1,zero.policy=TRUE)
>
>      #marginal effects with p-values
>
>      `summary(impacts(reg2, listw = listw1), R= 500, zstats =
> TRUE,zero.policy=TRUE)
>
>      I don't know if it is for my panel data, the missing values or
> something else.
>      I tried also in Stata having similar issues.
>
>      thanks in advance and my apologies if it is very naive question, but I
> am stuck.
>
> all the best
> Maria Jesus
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From @orenh @end|ng |rom m@th@@@u@dk  Thu Apr 15 00:55:38 2021
From: @orenh @end|ng |rom m@th@@@u@dk (=?utf-8?B?U8O4cmVuIEjDuGpzZ2FhcmQ=?=)
Date: Wed, 14 Apr 2021 22:55:38 +0000
Subject: [R] NLSR package newDeriv function
In-Reply-To: <BL0PR01MB49623F85F6B7A637A0404AC3FA4E9@BL0PR01MB4962.prod.exchangelabs.com>
References: <BL0PR01MB49623F85F6B7A637A0404AC3FA4E9@BL0PR01MB4962.prod.exchangelabs.com>
Message-ID: <ce6a84a00699ab30beeb58ec4db9dd791de2db91.camel@math.aau.dk>

One approach is to compute things exact using the caracas package; see
below.

Best regards
S?ren

----

> library(caracas)
> f <- function(x,y){x+y}
> def_sym(x,y,z)
> f <- x+y^2+y*z^2
> f
[caracas]:      2      2
           x + y  + y?z
> 
> d1  <- der(f, c(x,y,z))
> d2 <- der2(f, c(x,y,z))
> 
> d1
[caracas]: ?          2       ?
           ?1  2?y + z   2?y?z?
> d2
[caracas]: ?0   0    0 ?
           ?           ?
           ?0   2   2?z?
           ?           ?
           ?0  2?z  2?y?
> 
> tex(d1)
[1] "\\left[\\begin{matrix}1 & 2 y + z^{2} & 2 y
z\\end{matrix}\\right]"
> tex(d2)
[1] "\\left[\\begin{matrix}0 & 0 & 0\\\\0 & 2 & 2 z\\\\0 & 2 z & 2
y\\end{matrix}\\right]"
> 
> as_expr(d1)
expression(cbind(1,  2*y + z^2,  2*y*z))
> as_expr(d2)
expression(rbind(cbind(0, 0, 0), cbind(0, 2, 2*z), cbind(0, 2*z, 2*y)))
> 



On Wed, 2021-04-14 at 19:35 +0000, Debangan Dey wrote:
> Hi,
> 
> I am trying to solve a non-linear least square which has a function
> from R^3 -> R. Is it possible to define gradient using newDeriv for a
> 3-variate scalar function?
> 
> I am trying to use the genD function in numDeriv package to define
> numerical gradient and treat them as a function. So far, I have
> failed to do it for simple function as follows ?
> 
> f <- function(x,y){x+y}
> grad.f <- function(x,y){z <- c(x,y)
>   f2 <- function(z){f(z[1],z[2])}
>   gd <- genD(f2,z)$D[,1:length(z)]
>   return(gd)
> }
> newDeriv(f(x,y), grad.f(x,y))
> 
> This derivative definition is not working as the following error pops
> up ?
> 
> fd <- fnDeriv(~ f(x,y), c("x",?y?))
> fd(c(1,2))
> Error in .grad[, "x"] <- grad.f(x) :
>   number of items to replace is not a multiple of replacement length
> 
> 
> I know the above example would work if I just give expressions
> instead of using grad function in numDeriv but I am trying to use
> numDeriv::grad here to see if my toy example can be translated to the
> bigger function I would later use it on.
> 
> Thanks,
> Debanga
> 
> --
> Debangan Dey,
> PhD Student in Biostatistics,
> Johns Hopkins Bloomberg School of Public Health,
> Baltimore, MD
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide 
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.

From ddey1 @end|ng |rom jhu@edu  Thu Apr 15 02:06:12 2021
From: ddey1 @end|ng |rom jhu@edu (Debangan Dey)
Date: Thu, 15 Apr 2021 00:06:12 +0000
Subject: [R] NLSR package newDeriv function
In-Reply-To: <ce6a84a00699ab30beeb58ec4db9dd791de2db91.camel@math.aau.dk>
References: <BL0PR01MB49623F85F6B7A637A0404AC3FA4E9@BL0PR01MB4962.prod.exchangelabs.com>,
 <ce6a84a00699ab30beeb58ec4db9dd791de2db91.camel@math.aau.dk>
Message-ID: <BL0PR01MB49626B6D6F1C660BE7887F52FA4D9@BL0PR01MB4962.prod.exchangelabs.com>

Hi Soren,

Thanks for the reply. The main reason I want to compute the derivative is to add it to the derivative table in R so that I can use it later in my optimization. And, my complicated function doesn?t have an analytical form of the derivative as it involves distribution function of a bivariate normal distribution.

Thanks,
Debangan

--
Debangan Dey,
PhD Student in Biostatistics,
Johns Hopkins Bloomberg School of Public Health,
Baltimore, MD

From: S?ren H?jsgaard <sorenh at math.aau.dk>
Date: Wednesday, April 14, 2021 at 6:56 PM
To: Debangan Dey <ddey1 at jhu.edu>, r-help at r-project.org <r-help at r-project.org>
Cc: Mikkel Meyer Andersen <mikl at math.aau.dk>
Subject: Re: [R] NLSR package newDeriv function

      External Email - Use Caution



One approach is to compute things exact using the caracas package; see
below.

Best regards
S?ren

----

> library(caracas)
> f <- function(x,y){x+y}
> def_sym(x,y,z)
> f <- x+y^2+y*z^2
> f
[caracas]:      2      2
           x + y  + y?z
>
> d1  <- der(f, c(x,y,z))
> d2 <- der2(f, c(x,y,z))
>
> d1
[caracas]: ?          2       ?
           ?1  2?y + z   2?y?z?
> d2
[caracas]: ?0   0    0 ?
           ?           ?
           ?0   2   2?z?
           ?           ?
           ?0  2?z  2?y?
>
> tex(d1)
[1] "\\left[\\begin{matrix}1 & 2 y + z^{2} & 2 y
z\\end{matrix}\\right]"
> tex(d2)
[1] "\\left[\\begin{matrix}0 & 0 & 0\\\\0 & 2 & 2 z\\\\0 & 2 z & 2
y\\end{matrix}\\right]"
>
> as_expr(d1)
expression(cbind(1,  2*y + z^2,  2*y*z))
> as_expr(d2)
expression(rbind(cbind(0, 0, 0), cbind(0, 2, 2*z), cbind(0, 2*z, 2*y)))
>



On Wed, 2021-04-14 at 19:35 +0000, Debangan Dey wrote:
> Hi,
>
> I am trying to solve a non-linear least square which has a function
> from R^3 -> R. Is it possible to define gradient using newDeriv for a
> 3-variate scalar function?
>
> I am trying to use the genD function in numDeriv package to define
> numerical gradient and treat them as a function. So far, I have
> failed to do it for simple function as follows ?
>
> f <- function(x,y){x+y}
> grad.f <- function(x,y){z <- c(x,y)
>   f2 <- function(z){f(z[1],z[2])}
>   gd <- genD(f2,z)$D[,1:length(z)]
>   return(gd)
> }
> newDeriv(f(x,y), grad.f(x,y))
>
> This derivative definition is not working as the following error pops
> up ?
>
> fd <- fnDeriv(~ f(x,y), c("x",?y?))
> fd(c(1,2))
> Error in .grad[, "x"] <- grad.f(x) :
>   number of items to replace is not a multiple of replacement length
>
>
> I know the above example would work if I just give expressions
> instead of using grad function in numDeriv but I am trying to use
> numDeriv::grad here to see if my toy example can be translated to the
> bigger function I would later use it on.
>
> Thanks,
> Debanga
>
> --
> Debangan Dey,
> PhD Student in Biostatistics,
> Johns Hopkins Bloomberg School of Public Health,
> Baltimore, MD
>
>       [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://nam02.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-help&amp;data=04%7C01%7Cddey1%40jhu.edu%7C24130e75316f4a4d701308d8ff98701f%7C9fa4f438b1e6473b803f86f8aedf0dec%7C0%7C0%7C637540377919364158%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&amp;sdata=Q26CwpHPCqViRwuZu4rCc7OyPlO0Kp4nr84JJ3Llcyk%3D&amp;reserved=0
> PLEASE do read the posting guide
> https://nam02.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.r-project.org%2Fposting-guide.html&amp;data=04%7C01%7Cddey1%40jhu.edu%7C24130e75316f4a4d701308d8ff98701f%7C9fa4f438b1e6473b803f86f8aedf0dec%7C0%7C0%7C637540377919364158%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&amp;sdata=R6SR3Eap%2FqHHm0jn%2BibWmM9hlLqkSzehU74ZCZJo3ok%3D&amp;reserved=0
> and provide commented, minimal, self-contained, reproducible code.

	[[alternative HTML version deleted]]


