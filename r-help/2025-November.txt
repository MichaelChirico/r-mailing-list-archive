From rb@er @end|ng |rom @t@u@edu  Tue Nov  4 18:22:57 2025
From: rb@er @end|ng |rom @t@u@edu (Robert Baer)
Date: Tue, 4 Nov 2025 11:22:57 -0600
Subject: [R] Did behavior of "paired" argument in t.test() change?
Message-ID: <63780f63-544e-4ea4-a136-b7772a782c3e@atsu.edu>

Hi all,

Did the behavior of base t.test() subtly change with respect to the 
paired argument?

I think this code used to work with long form data, but now it seems not 
to? work:

 ? ? # Example long format data
 ? ? data_long <- data.frame(
 ? ? ? value = c(10, 12, 15, 8, 9, 11),
 ? ? ? time = factor(rep(c("before", "after"), each = 3))
 ? ? )

 ? ? t.test(value ~ time, data = data_long, paired = TRUE)

# Errorin t.test.formula(value ~ time, data = data_long, paired = TRUE) 
: # cannot use 'paired' in formula method

A quick Google seems to suggest that the above code should still work. 
What am I missing?

-------------------------------

Less sure about this one ...

Also, I thought it had always been possible to use x = "difference 
scores" in t.test(..., paired = TRUE) as long as y = NULL. My memory 
about this is less secure than the behavior above.

Control = c(10, 12, 15) Treat = c(8, 9, 11) data_wide <- data.frame( 
Control, Treat, Diff = Treat - Control) t.test(data_wide$Diff, NULL, 
"two.sided", 0, paired = FALSE) # works but y = NULL, mu = 0 mostly 
implies difference scores

t.test(data_wide$Diff, NULL, "two.sided", 0, paired = TRUE) # fails but 
if y = NULL the value of paired should not matter should it?

For y, help says "y an optional (non-empty) numeric vector of data 
values". I take this to imply that x = compared to a population mean 
hypothesis whenever y = NULL. Why should the value of paired influence 
the outcome?

Just bad memory? on my part?

R.version _ platform x86_64-w64-mingw32 arch x86_64 os mingw32 crt ucrt 
system x86_64, mingw32 status major 4 minor 5.1 year 2025 month 06 day 
13 svn rev 88306 language R version.string R version 4.5.1 (2025-06-13 
ucrt) nickname Great Square Root


-- 
---
Robert W. Baer, Ph.D.
Professor of Physiology
Kirksville College of Osteopathic Medicine
A.T. Still Univerisity of Health Sciences
800 W. Jefferson St.
Kirksville, MO 63501

	[[alternative HTML version deleted]]


From |kry|ov @end|ng |rom d|@root@org  Tue Nov  4 18:40:21 2025
From: |kry|ov @end|ng |rom d|@root@org (Ivan Krylov)
Date: Tue, 4 Nov 2025 20:40:21 +0300
Subject: [R] Did behavior of "paired" argument in t.test() change?
In-Reply-To: <63780f63-544e-4ea4-a136-b7772a782c3e@atsu.edu>
References: <63780f63-544e-4ea4-a136-b7772a782c3e@atsu.edu>
Message-ID: <20251104204021.0e690228@Tarkus>

? Tue, 4 Nov 2025 11:22:57 -0600
Robert Baer via R-help <r-help at r-project.org> ?????:

> Errorin t.test.formula(value ~ time, data = data_long, paired =
> TRUE) :
> cannot use 'paired' in formula method

This was changed in R-4.4.0:
https://bugs.r-project.org/show_bug.cgi?id=14359

The news item (see news(grepl('paired', Text))) recommends the use of
Pair(x1, x2) ~ 1 instead of the 'paired' argument. A further fix is
currently in R-devel (but not R-patched): without it, Pair(x1, x2) does
not handle the 'subset' argument.

-- 
Best regards,
Ivan


From petr@p|k @end|ng |rom gm@||@com  Tue Nov  4 18:39:50 2025
From: petr@p|k @end|ng |rom gm@||@com (Petr Pikal)
Date: Tue, 4 Nov 2025 18:39:50 +0100
Subject: [R] Did behavior of "paired" argument in t.test() change?
In-Reply-To: <63780f63-544e-4ea4-a136-b7772a782c3e@atsu.edu>
References: <63780f63-544e-4ea4-a136-b7772a782c3e@atsu.edu>
Message-ID: <CAO8Egw_cObDHRMg5qxg61f3gkeq_5yPE4_EHqzZCfdqqwKrF6Q@mail.gmail.com>

Hallo

According to recent documentation this works for paired t.test.
t.test(Pair(value,time)~1, data=data_long)

It is the last example in help page.

And your second question seems to be also different from what help page
says:

If paired is TRUE then both x and y must be specified and they must be the
same length. Missing values are silently removed (in pairs if paired is TRUE
).

Cheers.
Petr


?t 4. 11. 2025 v 18:23 odes?latel Robert Baer via R-help <
r-help at r-project.org> napsal:

> Hi all,
>
> Did the behavior of base t.test() subtly change with respect to the
> paired argument?
>
> I think this code used to work with long form data, but now it seems not
> to  work:
>
>      # Example long format data
>      data_long <- data.frame(
>        value = c(10, 12, 15, 8, 9, 11),
>        time = factor(rep(c("before", "after"), each = 3))
>      )
>
>      t.test(value ~ time, data = data_long, paired = TRUE)
>
> # Errorin t.test.formula(value ~ time, data = data_long, paired = TRUE)
> : # cannot use 'paired' in formula method
>
> A quick Google seems to suggest that the above code should still work.
> What am I missing?
>
> -------------------------------
>
> Less sure about this one ...
>
> Also, I thought it had always been possible to use x = "difference
> scores" in t.test(..., paired = TRUE) as long as y = NULL. My memory
> about this is less secure than the behavior above.
>
> Control = c(10, 12, 15) Treat = c(8, 9, 11) data_wide <- data.frame(
> Control, Treat, Diff = Treat - Control) t.test(data_wide$Diff, NULL,
> "two.sided", 0, paired = FALSE) # works but y = NULL, mu = 0 mostly
> implies difference scores
>
> t.test(data_wide$Diff, NULL, "two.sided", 0, paired = TRUE) # fails but
> if y = NULL the value of paired should not matter should it?
>
> For y, help says "y an optional (non-empty) numeric vector of data
> values". I take this to imply that x = compared to a population mean
> hypothesis whenever y = NULL. Why should the value of paired influence
> the outcome?
>
> Just bad memory  on my part?
>
> R.version _ platform x86_64-w64-mingw32 arch x86_64 os mingw32 crt ucrt
> system x86_64, mingw32 status major 4 minor 5.1 year 2025 month 06 day
> 13 svn rev 88306 language R version.string R version 4.5.1 (2025-06-13
> ucrt) nickname Great Square Root
>
>
> --
> ---
> Robert W. Baer, Ph.D.
> Professor of Physiology
> Kirksville College of Osteopathic Medicine
> A.T. Still Univerisity of Health Sciences
> 800 W. Jefferson St.
> Kirksville, MO 63501
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> https://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From E@Vettor@zz| @end|ng |rom uke@de  Tue Nov  4 20:43:49 2025
From: E@Vettor@zz| @end|ng |rom uke@de (Eik Vettorazzi)
Date: Tue, 4 Nov 2025 20:43:49 +0100
Subject: [R] [EXT] Re:  A very small p-value
In-Reply-To: <CAO8Egw_AnEJpFEwp8P+uSBE0zJRdipn30NW8aB736y2HaOUSDg@mail.gmail.com>
References: <19B8367F-913D-4CF9-89F6-E6922EE61DA1@gmail.com>
 <CAO8Egw_AnEJpFEwp8P+uSBE0zJRdipn30NW8aB736y2HaOUSDg@mail.gmail.com>
Message-ID: <e810de9c-dbb2-4234-b592-5828ef29bc34@uke.de>

Hi,
Stepping briefly outside the R context, I noticed a statistical point in 
the text you linked that, in my opinion, isn't quite right. I believe 
there's a key misunderstanding here: The statement that the z-test does 
not depend on the number of cases is incorrect. The p-value of the 
z-test is ?just like other tests? very much dependent on the sample 
size, assuming the same mean difference and standard deviation.
The text you linked is actually calculating an Effect Size, which is 
(largely) independent of the sample size. Effect Size answers the 
question of how "relevant" or "large" the difference between groups is. 
This is fundamentally different from testing for "significant" differences.
Specifically, the crucial 1/\sqrt{n} term, which is necessary for 
calculating the standard error of the mean difference, seems to be 
missing from the presented formula for the z-score. I just wanted to 
quickly point this out.

Best regards

Am 27.10.2025 um 14:12 schrieb Petr Pikal:
> Hallo
> 
> The t test is probably not the best option in your case. With 95
> observations your data behave more like a population and you  may get
> better insight using z-test. See
> https://toxictruthblog.com/avoiding-little-known-problems-with-the-t-test/
> 
> Best regards.
> Petr
> 
> 
> <https://www.avast.com/sig-email?utm_medium=email&utm_source=link&utm_campaign=sig-email&utm_content=webmail>
> Neobsahuje
> ??dn? viry.www.avast.com
> <https://www.avast.com/sig-email?utm_medium=email&utm_source=link&utm_campaign=sig-email&utm_content=webmail>
> <#DAB4FAD8-2DD7-40BB-A1B8-4E2AA1F9FDF2>
> 
> so 25. 10. 2025 v 11:46 odes?latel Christophe Dutang <dutangc at gmail.com>
> napsal:
> 
>> Dear list,
>>
>> I'm computing a p-value for the Student test and discover some
>> inconsistencies with the cdf pt().
>>
>> The observed statistic is 11.23995 for 95 observations, so the p-value is
>> very small
>>
>>> t_score <- 11.23995
>>> n <- 95
>>> print(pt(t_score, df = n-2, lower=FALSE), digits=22)
>> [1] 2.539746620181247991746e-19
>>> print(integrate(dt, lower=t_score, upper=Inf, df=n-2)$value, digits = 22)
>> [1] 2.539746631161970791961e-19
>>
>> But if I compute with pt(lower=TRUE), I got 0
>>
>>> print(1-pt(t_score, df = n-2, lower=TRUE), digits=22)
>> [1] 0
>>
>> Indeed, the p-value is lower than the epsilon machine
>>
>>> pt(t_score, df = n-2, lower=FALSE) < .Machine$double.eps
>> [1] TRUE
>>
>> Using the square of t statistic which follows a Fisher distribution, I got
>> the same issue:
>>
>>> print(pf(z, 1, n-2, lower=FALSE), digits=22)
>> [1] 5.079493240362495983491e-19
>>> print(integrate(df, lower=z, upper=Inf, df1=1, df2=n-2)$value, digits =
>> 22)
>> [1] 5.079015231299358486828e-19
>>> print(1-pf(z, 1, n-2, lower=TRUE), digits=22)
>> [1] 0
>>
>> When using the t.test() function, the p-value is naturally printed :
>> p-value < 2.2e-16.
>>
>> Any comment is welcome.
>>
>> Christophe
>>
>>> R.version
>>                 _
>> platform       aarch64-apple-darwin20
>> arch           aarch64
>> os             darwin20
>> system         aarch64, darwin20
>> status
>> major          4
>> minor          5.1
>> year           2025
>> month          06
>> day            13
>> svn rev        88306
>> language       R
>> version.string R version 4.5.1 (2025-06-13)
>> nickname       Great Square Root
>> -------------------------------------------------
>> Christophe DUTANG
>> LJK, Ensimag, Grenoble INP, UGA, France
>> ILB research fellow
>> Web: http://dutangc.free.fr
>> -------------------------------------------------
>>
>>
>>          [[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide
>> https://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>>
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide https://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.

-- 
Eik Vettorazzi

Universit?tsklinikum Hamburg-Eppendorf
Institut f?r Medizinische Biometrie und Epidemiologie

Christoph-Probst-Weg 1
4. Obergeschoss, Raum 04.1.021.1

20246 Hamburg

Telefon: +49 (0) 40 7410 - 58243
Fax:     +49 (0) 40 7410 - 57790

Web: www.uke.de/imbe



--

_____________________________________________________________________

Universit?tsklinikum Hamburg-Eppendorf; K?rperschaft des ?ffentlichen Rechts; Gerichtsstand: Hamburg | www.uke.de
Vorstandsmitglieder: Prof. Dr. Christian Gerloff (Vorsitzender), Joachim Pr?l?, Prof. Dr. Blanche Schwappach-Pignataro, Corinna Wriedt
_____________________________________________________________________

From pd@|gd @end|ng |rom gm@||@com  Wed Nov  5 13:28:09 2025
From: pd@|gd @end|ng |rom gm@||@com (Peter Dalgaard)
Date: Wed, 5 Nov 2025 13:28:09 +0100
Subject: [R] Did behavior of "paired" argument in t.test() change?
In-Reply-To: <20251104204021.0e690228@Tarkus>
References: <63780f63-544e-4ea4-a136-b7772a782c3e@atsu.edu>
 <20251104204021.0e690228@Tarkus>
Message-ID: <EAB00474-274F-4AE9-ACAA-867623273AB5@gmail.com>

Yes. Of course, Pair() requires the data to be in wide format. It's been a while (although not so long ago as some of the other things I cannot remember...) but I think the reason was that the  ...y~g, paired=TRUE... format was considered too brittle with respect to sort order and subsetting.

-pd


> On 4 Nov 2025, at 18.40, Ivan Krylov via R-help <r-help at r-project.org> wrote:
> 
> ? Tue, 4 Nov 2025 11:22:57 -0600
> Robert Baer via R-help <r-help at r-project.org> ?????:
> 
>> Errorin t.test.formula(value ~ time, data = data_long, paired =
>> TRUE) :
>> cannot use 'paired' in formula method
> 
> This was changed in R-4.4.0:
> https://bugs.r-project.org/show_bug.cgi?id=14359
> 
> The news item (see news(grepl('paired', Text))) recommends the use of
> Pair(x1, x2) ~ 1 instead of the 'paired' argument. A further fix is
> currently in R-devel (but not R-patched): without it, Pair(x1, x2) does
> not handle the 'subset' argument.
> 
> -- 
> Best regards,
> Ivan
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide https://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.

-- 
Peter Dalgaard, Professor,
Center for Statistics, Copenhagen Business School
Solbjerg Plads 3, 2000 Frederiksberg, Denmark
Phone: (+45)38153501
Office: A 4.23
Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com


From pd@|gd @end|ng |rom gm@||@com  Wed Nov  5 13:36:35 2025
From: pd@|gd @end|ng |rom gm@||@com (Peter Dalgaard)
Date: Wed, 5 Nov 2025 13:36:35 +0100
Subject: [R] Did behavior of "paired" argument in t.test() change?
In-Reply-To: <CAO8Egw_cObDHRMg5qxg61f3gkeq_5yPE4_EHqzZCfdqqwKrF6Q@mail.gmail.com>
References: <63780f63-544e-4ea4-a136-b7772a782c3e@atsu.edu>
 <CAO8Egw_cObDHRMg5qxg61f3gkeq_5yPE4_EHqzZCfdqqwKrF6Q@mail.gmail.com>
Message-ID: <4D9D771F-CAF5-4998-94EB-47E66B5B8EE0@gmail.com>

No, that would look at the mean of value - time. You need to convert to wide format and use both of the resulting value columns (this _is_ wht the current example does). Or do the splitting explicitly, as in

> data_long <- data.frame(
+       value = c(10, 12, 15, 8, 9, 11),
+       time = factor(rep(c("before", "after"), each = 3))
+     )
> groups <- with(data_long, split(value, time))
> t.test(groups$before, groups$after, paired=TRUE)


> On 4 Nov 2025, at 18.39, Petr Pikal <petr.pik at gmail.com> wrote:
> 
> Hallo
> 
> According to recent documentation this works for paired t.test.
> t.test(Pair(value,time)~1, data=data_long)
> 
> It is the last example in help page.
> 
> And your second question seems to be also different from what help page
> says:
> 
> If paired is TRUE then both x and y must be specified and they must be the
> same length. Missing values are silently removed (in pairs if paired is TRUE
> ).
> 
> Cheers.
> Petr
> 
> 
> ?t 4. 11. 2025 v 18:23 odes?latel Robert Baer via R-help <
> r-help at r-project.org> napsal:
> 
>> Hi all,
>> 
>> Did the behavior of base t.test() subtly change with respect to the
>> paired argument?
>> 
>> I think this code used to work with long form data, but now it seems not
>> to  work:
>> 
>>     # Example long format data
>>     data_long <- data.frame(
>>       value = c(10, 12, 15, 8, 9, 11),
>>       time = factor(rep(c("before", "after"), each = 3))
>>     )
>> 
>>     t.test(value ~ time, data = data_long, paired = TRUE)
>> 
>> # Errorin t.test.formula(value ~ time, data = data_long, paired = TRUE)
>> : # cannot use 'paired' in formula method
>> 
>> A quick Google seems to suggest that the above code should still work.
>> What am I missing?
>> 
>> -------------------------------
>> 
>> Less sure about this one ...
>> 
>> Also, I thought it had always been possible to use x = "difference
>> scores" in t.test(..., paired = TRUE) as long as y = NULL. My memory
>> about this is less secure than the behavior above.
>> 
>> Control = c(10, 12, 15) Treat = c(8, 9, 11) data_wide <- data.frame(
>> Control, Treat, Diff = Treat - Control) t.test(data_wide$Diff, NULL,
>> "two.sided", 0, paired = FALSE) # works but y = NULL, mu = 0 mostly
>> implies difference scores
>> 
>> t.test(data_wide$Diff, NULL, "two.sided", 0, paired = TRUE) # fails but
>> if y = NULL the value of paired should not matter should it?
>> 
>> For y, help says "y an optional (non-empty) numeric vector of data
>> values". I take this to imply that x = compared to a population mean
>> hypothesis whenever y = NULL. Why should the value of paired influence
>> the outcome?
>> 
>> Just bad memory  on my part?
>> 
>> R.version _ platform x86_64-w64-mingw32 arch x86_64 os mingw32 crt ucrt
>> system x86_64, mingw32 status major 4 minor 5.1 year 2025 month 06 day
>> 13 svn rev 88306 language R version.string R version 4.5.1 (2025-06-13
>> ucrt) nickname Great Square Root
>> 
>> 
>> --
>> ---
>> Robert W. Baer, Ph.D.
>> Professor of Physiology
>> Kirksville College of Osteopathic Medicine
>> A.T. Still Univerisity of Health Sciences
>> 800 W. Jefferson St.
>> Kirksville, MO 63501
>> 
>>        [[alternative HTML version deleted]]
>> 
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide
>> https://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>> 
> 
> [[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide https://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.

-- 
Peter Dalgaard, Professor,
Center for Statistics, Copenhagen Business School
Solbjerg Plads 3, 2000 Frederiksberg, Denmark
Phone: (+45)38153501
Office: A 4.23
Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com


From wo||g@ng@v|echtb@uer @end|ng |rom m@@@tr|chtun|ver@|ty@n|  Wed Nov  5 15:04:28 2025
From: wo||g@ng@v|echtb@uer @end|ng |rom m@@@tr|chtun|ver@|ty@n| (Viechtbauer, Wolfgang (NP))
Date: Wed, 5 Nov 2025 14:04:28 +0000
Subject: [R] [EXT] Re:  A very small p-value
In-Reply-To: <e810de9c-dbb2-4234-b592-5828ef29bc34@uke.de>
References: <19B8367F-913D-4CF9-89F6-E6922EE61DA1@gmail.com>
 <CAO8Egw_AnEJpFEwp8P+uSBE0zJRdipn30NW8aB736y2HaOUSDg@mail.gmail.com>
 <e810de9c-dbb2-4234-b592-5828ef29bc34@uke.de>
Message-ID: <AS8PR08MB91937470A76108FA9B4025058BC5A@AS8PR08MB9193.eurprd08.prod.outlook.com>

Eik, thanks for posting this. I thought that the page was making the usual (just somewhat flawed) argument that once the dfs are sufficiently large, whether one does pnorm(...) or pt(..., df=<>) makes little difference (although far out in the tails it still does).

Your post made me look at the page and I hope nobody takes anything written there serious. The argument is so utterly wrong. I am absolutely flabbergasted how somebody could write so many pages of text based on such a flawed understanding of basic statistical concepts.

Just to give some examples:

"The next issue I have is that I can't see the underlying data. So I don't know what the actual shape of the distribution is, but it's probably fair to say it's normally distributed (assuming the Central Limit Theorem applies)." The CLT says nothing about the distribution of the raw data.

"As the sample size increases, samples will begin to operate and appear more and more like the population they are drawn from. This is the Law of Large Numbers." The law of large numbers has nothing to do with this.

And as Eik already pointed out, the 'z-test' the author is describing is not a test at all, but essentially just calculates the standardized mean difference (and computing a p-value from it makes no sense).

Best,
Wolfgang

> -----Original Message-----
> From: R-help <r-help-bounces at r-project.org> On Behalf Of Eik Vettorazzi via R-
> help
> Sent: Tuesday, November 4, 2025 20:44
> To: Petr Pikal <peprcon.asc at centrum.cz>; Christophe Dutang <dutangc at gmail.com>
> Cc: r-help at r-project.org
> Subject: Re: [R] [EXT] Re: A very small p-value
>
> Hi,
> Stepping briefly outside the R context, I noticed a statistical point in
> the text you linked that, in my opinion, isn't quite right. I believe
> there's a key misunderstanding here: The statement that the z-test does
> not depend on the number of cases is incorrect. The p-value of the
> z-test is ?just like other tests? very much dependent on the sample
> size, assuming the same mean difference and standard deviation.
> The text you linked is actually calculating an Effect Size, which is
> (largely) independent of the sample size. Effect Size answers the
> question of how "relevant" or "large" the difference between groups is.
> This is fundamentally different from testing for "significant" differences.
> Specifically, the crucial 1/\sqrt{n} term, which is necessary for
> calculating the standard error of the mean difference, seems to be
> missing from the presented formula for the z-score. I just wanted to
> quickly point this out.
>
> Best regards
>
> Am 27.10.2025 um 14:12 schrieb Petr Pikal:
> > Hallo
> >
> > The t test is probably not the best option in your case. With 95
> > observations your data behave more like a population and you  may get
> > better insight using z-test. See
> > https://toxictruthblog.com/avoiding-little-known-problems-with-the-t-test/
> >
> > Best regards.
> > Petr
> >
> > so 25. 10. 2025 v 11:46 odes?latel Christophe Dutang <dutangc at gmail.com>
> > napsal:
> >
> >> Dear list,
> >>
> >> I'm computing a p-value for the Student test and discover some
> >> inconsistencies with the cdf pt().
> >>
> >> The observed statistic is 11.23995 for 95 observations, so the p-value is
> >> very small
> >>
> >>> t_score <- 11.23995
> >>> n <- 95
> >>> print(pt(t_score, df = n-2, lower=FALSE), digits=22)
> >> [1] 2.539746620181247991746e-19
> >>> print(integrate(dt, lower=t_score, upper=Inf, df=n-2)$value, digits = 22)
> >> [1] 2.539746631161970791961e-19
> >>
> >> But if I compute with pt(lower=TRUE), I got 0
> >>
> >>> print(1-pt(t_score, df = n-2, lower=TRUE), digits=22)
> >> [1] 0
> >>
> >> Indeed, the p-value is lower than the epsilon machine
> >>
> >>> pt(t_score, df = n-2, lower=FALSE) < .Machine$double.eps
> >> [1] TRUE
> >>
> >> Using the square of t statistic which follows a Fisher distribution, I got
> >> the same issue:
> >>
> >>> print(pf(z, 1, n-2, lower=FALSE), digits=22)
> >> [1] 5.079493240362495983491e-19
> >>> print(integrate(df, lower=z, upper=Inf, df1=1, df2=n-2)$value, digits =
> >> 22)
> >> [1] 5.079015231299358486828e-19
> >>> print(1-pf(z, 1, n-2, lower=TRUE), digits=22)
> >> [1] 0
> >>
> >> When using the t.test() function, the p-value is naturally printed :
> >> p-value < 2.2e-16.
> >>
> >> Any comment is welcome.
> >>
> >> Christophe

From bobby@kn|ght @end|ng |rom gm@||@com  Wed Nov  5 18:25:48 2025
From: bobby@kn|ght @end|ng |rom gm@||@com (Robert Knight)
Date: Wed, 5 Nov 2025 12:25:48 -0500
Subject: [R] [EXT] Re: A very small p-value
In-Reply-To: <AS8PR08MB91937470A76108FA9B4025058BC5A@AS8PR08MB9193.eurprd08.prod.outlook.com>
References: <19B8367F-913D-4CF9-89F6-E6922EE61DA1@gmail.com>
 <CAO8Egw_AnEJpFEwp8P+uSBE0zJRdipn30NW8aB736y2HaOUSDg@mail.gmail.com>
 <e810de9c-dbb2-4234-b592-5828ef29bc34@uke.de>
 <AS8PR08MB91937470A76108FA9B4025058BC5A@AS8PR08MB9193.eurprd08.prod.outlook.com>
Message-ID: <CAKBFG3bWYbssw5tugq=7q=93YDcyLD2VBr1QPxyUpWBgNY6SWA@mail.gmail.com>

I have not reviewed the formulas presented, but you err in assertion of
wrong information om that site.  The Central Limit Theorem is about the raw
data and the law of large numbers applies to averages obtained from it.

T if n<30 was the metric I was trained to use.  If I recall correctly, z is
more reliable below 30 than t is above it.

Unless the math formulas are wrong, that site seems useful.  I wonder how
far t diverges from z, but do not have time to compare them exactly.




On Wed, Nov 5, 2025, 9:04?AM Viechtbauer, Wolfgang (NP) via R-help <
r-help at r-project.org> wrote:

> Eik, thanks for posting this. I thought that the page was making the usual
> (just somewhat flawed) argument that once the dfs are sufficiently large,
> whether one does pnorm(...) or pt(..., df=<>) makes little difference
> (although far out in the tails it still does).
>
> Your post made me look at the page and I hope nobody takes anything
> written there serious. The argument is so utterly wrong. I am absolutely
> flabbergasted how somebody could write so many pages of text based on such
> a flawed understanding of basic statistical concepts.
>
> Just to give some examples:
>
> "The next issue I have is that I can't see the underlying data. So I don't
> know what the actual shape of the distribution is, but it's probably fair
> to say it's normally distributed (assuming the Central Limit Theorem
> applies)." The CLT says nothing about the distribution of the raw data.
>
> "As the sample size increases, samples will begin to operate and appear
> more and more like the population they are drawn from. This is the Law of
> Large Numbers." The law of large numbers has nothing to do with this.
>
> And as Eik already pointed out, the 'z-test' the author is describing is
> not a test at all, but essentially just calculates the standardized mean
> difference (and computing a p-value from it makes no sense).
>
> Best,
> Wolfgang
>
> > -----Original Message-----
> > From: R-help <r-help-bounces at r-project.org> On Behalf Of Eik Vettorazzi
> via R-
> > help
> > Sent: Tuesday, November 4, 2025 20:44
> > To: Petr Pikal <peprcon.asc at centrum.cz>; Christophe Dutang <
> dutangc at gmail.com>
> > Cc: r-help at r-project.org
> > Subject: Re: [R] [EXT] Re: A very small p-value
> >
> > Hi,
> > Stepping briefly outside the R context, I noticed a statistical point in
> > the text you linked that, in my opinion, isn't quite right. I believe
> > there's a key misunderstanding here: The statement that the z-test does
> > not depend on the number of cases is incorrect. The p-value of the
> > z-test is ?just like other tests? very much dependent on the sample
> > size, assuming the same mean difference and standard deviation.
> > The text you linked is actually calculating an Effect Size, which is
> > (largely) independent of the sample size. Effect Size answers the
> > question of how "relevant" or "large" the difference between groups is.
> > This is fundamentally different from testing for "significant"
> differences.
> > Specifically, the crucial 1/\sqrt{n} term, which is necessary for
> > calculating the standard error of the mean difference, seems to be
> > missing from the presented formula for the z-score. I just wanted to
> > quickly point this out.
> >
> > Best regards
> >
> > Am 27.10.2025 um 14:12 schrieb Petr Pikal:
> > > Hallo
> > >
> > > The t test is probably not the best option in your case. With 95
> > > observations your data behave more like a population and you  may get
> > > better insight using z-test. See
> > >
> https://toxictruthblog.com/avoiding-little-known-problems-with-the-t-test/
> > >
> > > Best regards.
> > > Petr
> > >
> > > so 25. 10. 2025 v 11:46 odes?latel Christophe Dutang <
> dutangc at gmail.com>
> > > napsal:
> > >
> > >> Dear list,
> > >>
> > >> I'm computing a p-value for the Student test and discover some
> > >> inconsistencies with the cdf pt().
> > >>
> > >> The observed statistic is 11.23995 for 95 observations, so the
> p-value is
> > >> very small
> > >>
> > >>> t_score <- 11.23995
> > >>> n <- 95
> > >>> print(pt(t_score, df = n-2, lower=FALSE), digits=22)
> > >> [1] 2.539746620181247991746e-19
> > >>> print(integrate(dt, lower=t_score, upper=Inf, df=n-2)$value, digits
> = 22)
> > >> [1] 2.539746631161970791961e-19
> > >>
> > >> But if I compute with pt(lower=TRUE), I got 0
> > >>
> > >>> print(1-pt(t_score, df = n-2, lower=TRUE), digits=22)
> > >> [1] 0
> > >>
> > >> Indeed, the p-value is lower than the epsilon machine
> > >>
> > >>> pt(t_score, df = n-2, lower=FALSE) < .Machine$double.eps
> > >> [1] TRUE
> > >>
> > >> Using the square of t statistic which follows a Fisher distribution,
> I got
> > >> the same issue:
> > >>
> > >>> print(pf(z, 1, n-2, lower=FALSE), digits=22)
> > >> [1] 5.079493240362495983491e-19
> > >>> print(integrate(df, lower=z, upper=Inf, df1=1, df2=n-2)$value,
> digits =
> > >> 22)
> > >> [1] 5.079015231299358486828e-19
> > >>> print(1-pf(z, 1, n-2, lower=TRUE), digits=22)
> > >> [1] 0
> > >>
> > >> When using the t.test() function, the p-value is naturally printed :
> > >> p-value < 2.2e-16.
> > >>
> > >> Any comment is welcome.
> > >>
> > >> Christophe
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> https://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From bobby@kn|ght @end|ng |rom gm@||@com  Wed Nov  5 18:39:01 2025
From: bobby@kn|ght @end|ng |rom gm@||@com (Robert Knight)
Date: Wed, 5 Nov 2025 12:39:01 -0500
Subject: [R] [EXT] Re: A very small p-value
In-Reply-To: <AS8PR08MB91937470A76108FA9B4025058BC5A@AS8PR08MB9193.eurprd08.prod.outlook.com>
References: <19B8367F-913D-4CF9-89F6-E6922EE61DA1@gmail.com>
 <CAO8Egw_AnEJpFEwp8P+uSBE0zJRdipn30NW8aB736y2HaOUSDg@mail.gmail.com>
 <e810de9c-dbb2-4234-b592-5828ef29bc34@uke.de>
 <AS8PR08MB91937470A76108FA9B4025058BC5A@AS8PR08MB9193.eurprd08.prod.outlook.com>
Message-ID: <CAKBFG3YnjrQZWK_5s45kNSTw6hrahDCteVgn5iFuRebGYubeKg@mail.gmail.com>

The BMJ guide used to include Z scores.  They have removed that section on
their live website, but the math has not changed.  Z scores make incredible
sense to use.

Search up older versions of Statistics at square one.  I have an older one
saved with all the sections.  BMJ had in depth guides on them, and that may
be where that blog got the idea.

One reason to use it is because it is often easier to calculate using the
base software packages rand functions rather than needing to import
additional libraries.

Functional programming is easier with Z than t.

On Wed, Nov 5, 2025, 9:04?AM Viechtbauer, Wolfgang (NP) via R-help <
r-help at r-project.org> wrote:

> Eik, thanks for posting this. I thought that the page was making the usual
> (just somewhat flawed) argument that once the dfs are sufficiently large,
> whether one does pnorm(...) or pt(..., df=<>) makes little difference
> (although far out in the tails it still does).
>
> Your post made me look at the page and I hope nobody takes anything
> written there serious. The argument is so utterly wrong. I am absolutely
> flabbergasted how somebody could write so many pages of text based on such
> a flawed understanding of basic statistical concepts.
>
> Just to give some examples:
>
> "The next issue I have is that I can't see the underlying data. So I don't
> know what the actual shape of the distribution is, but it's probably fair
> to say it's normally distributed (assuming the Central Limit Theorem
> applies)." The CLT says nothing about the distribution of the raw data.
>
> "As the sample size increases, samples will begin to operate and appear
> more and more like the population they are drawn from. This is the Law of
> Large Numbers." The law of large numbers has nothing to do with this.
>
> And as Eik already pointed out, the 'z-test' the author is describing is
> not a test at all, but essentially just calculates the standardized mean
> difference (and computing a p-value from it makes no sense).
>
> Best,
> Wolfgang
>
> > -----Original Message-----
> > From: R-help <r-help-bounces at r-project.org> On Behalf Of Eik Vettorazzi
> via R-
> > help
> > Sent: Tuesday, November 4, 2025 20:44
> > To: Petr Pikal <peprcon.asc at centrum.cz>; Christophe Dutang <
> dutangc at gmail.com>
> > Cc: r-help at r-project.org
> > Subject: Re: [R] [EXT] Re: A very small p-value
> >
> > Hi,
> > Stepping briefly outside the R context, I noticed a statistical point in
> > the text you linked that, in my opinion, isn't quite right. I believe
> > there's a key misunderstanding here: The statement that the z-test does
> > not depend on the number of cases is incorrect. The p-value of the
> > z-test is ?just like other tests? very much dependent on the sample
> > size, assuming the same mean difference and standard deviation.
> > The text you linked is actually calculating an Effect Size, which is
> > (largely) independent of the sample size. Effect Size answers the
> > question of how "relevant" or "large" the difference between groups is.
> > This is fundamentally different from testing for "significant"
> differences.
> > Specifically, the crucial 1/\sqrt{n} term, which is necessary for
> > calculating the standard error of the mean difference, seems to be
> > missing from the presented formula for the z-score. I just wanted to
> > quickly point this out.
> >
> > Best regards
> >
> > Am 27.10.2025 um 14:12 schrieb Petr Pikal:
> > > Hallo
> > >
> > > The t test is probably not the best option in your case. With 95
> > > observations your data behave more like a population and you  may get
> > > better insight using z-test. See
> > >
> https://toxictruthblog.com/avoiding-little-known-problems-with-the-t-test/
> > >
> > > Best regards.
> > > Petr
> > >
> > > so 25. 10. 2025 v 11:46 odes?latel Christophe Dutang <
> dutangc at gmail.com>
> > > napsal:
> > >
> > >> Dear list,
> > >>
> > >> I'm computing a p-value for the Student test and discover some
> > >> inconsistencies with the cdf pt().
> > >>
> > >> The observed statistic is 11.23995 for 95 observations, so the
> p-value is
> > >> very small
> > >>
> > >>> t_score <- 11.23995
> > >>> n <- 95
> > >>> print(pt(t_score, df = n-2, lower=FALSE), digits=22)
> > >> [1] 2.539746620181247991746e-19
> > >>> print(integrate(dt, lower=t_score, upper=Inf, df=n-2)$value, digits
> = 22)
> > >> [1] 2.539746631161970791961e-19
> > >>
> > >> But if I compute with pt(lower=TRUE), I got 0
> > >>
> > >>> print(1-pt(t_score, df = n-2, lower=TRUE), digits=22)
> > >> [1] 0
> > >>
> > >> Indeed, the p-value is lower than the epsilon machine
> > >>
> > >>> pt(t_score, df = n-2, lower=FALSE) < .Machine$double.eps
> > >> [1] TRUE
> > >>
> > >> Using the square of t statistic which follows a Fisher distribution,
> I got
> > >> the same issue:
> > >>
> > >>> print(pf(z, 1, n-2, lower=FALSE), digits=22)
> > >> [1] 5.079493240362495983491e-19
> > >>> print(integrate(df, lower=z, upper=Inf, df1=1, df2=n-2)$value,
> digits =
> > >> 22)
> > >> [1] 5.079015231299358486828e-19
> > >>> print(1-pf(z, 1, n-2, lower=TRUE), digits=22)
> > >> [1] 0
> > >>
> > >> When using the t.test() function, the p-value is naturally printed :
> > >> p-value < 2.2e-16.
> > >>
> > >> Any comment is welcome.
> > >>
> > >> Christophe
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> https://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From bgunter@4567 @end|ng |rom gm@||@com  Wed Nov  5 18:40:41 2025
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Wed, 5 Nov 2025 09:40:41 -0800
Subject: [R] [EXT] Re: A very small p-value
In-Reply-To: <CAKBFG3bWYbssw5tugq=7q=93YDcyLD2VBr1QPxyUpWBgNY6SWA@mail.gmail.com>
References: <19B8367F-913D-4CF9-89F6-E6922EE61DA1@gmail.com>
 <CAO8Egw_AnEJpFEwp8P+uSBE0zJRdipn30NW8aB736y2HaOUSDg@mail.gmail.com>
 <e810de9c-dbb2-4234-b592-5828ef29bc34@uke.de>
 <AS8PR08MB91937470A76108FA9B4025058BC5A@AS8PR08MB9193.eurprd08.prod.outlook.com>
 <CAKBFG3bWYbssw5tugq=7q=93YDcyLD2VBr1QPxyUpWBgNY6SWA@mail.gmail.com>
Message-ID: <CAGxFJbSs1C9UjYJcw7LFn26aBtSm3KHhBeqckacskg4RNh7+1w@mail.gmail.com>

May I implore that those involved in this discussion/dispute take it off
R-Help, as it really seems like the sort of thing that we should avoid
here,, as well as being off topic.


On Wed, Nov 5, 2025 at 9:29?AM Robert Knight <bobby.knight at gmail.com> wrote:

> I have not reviewed the formulas presented, but you err in assertion of
> wrong information om that site.  The Central Limit Theorem is about the raw
> data and the law of large numbers applies to averages obtained from it.
>
> T if n<30 was the metric I was trained to use.  If I recall correctly, z is
> more reliable below 30 than t is above it.
>
> Unless the math formulas are wrong, that site seems useful.  I wonder how
> far t diverges from z, but do not have time to compare them exactly.
>
>
>
>
> On Wed, Nov 5, 2025, 9:04?AM Viechtbauer, Wolfgang (NP) via R-help <
> r-help at r-project.org> wrote:
>
> > Eik, thanks for posting this. I thought that the page was making the
> usual
> > (just somewhat flawed) argument that once the dfs are sufficiently large,
> > whether one does pnorm(...) or pt(..., df=<>) makes little difference
> > (although far out in the tails it still does).
> >
> > Your post made me look at the page and I hope nobody takes anything
> > written there serious. The argument is so utterly wrong. I am absolutely
> > flabbergasted how somebody could write so many pages of text based on
> such
> > a flawed understanding of basic statistical concepts.
> >
> > Just to give some examples:
> >
> > "The next issue I have is that I can't see the underlying data. So I
> don't
> > know what the actual shape of the distribution is, but it's probably fair
> > to say it's normally distributed (assuming the Central Limit Theorem
> > applies)." The CLT says nothing about the distribution of the raw data.
> >
> > "As the sample size increases, samples will begin to operate and appear
> > more and more like the population they are drawn from. This is the Law of
> > Large Numbers." The law of large numbers has nothing to do with this.
> >
> > And as Eik already pointed out, the 'z-test' the author is describing is
> > not a test at all, but essentially just calculates the standardized mean
> > difference (and computing a p-value from it makes no sense).
> >
> > Best,
> > Wolfgang
> >
> > > -----Original Message-----
> > > From: R-help <r-help-bounces at r-project.org> On Behalf Of Eik
> Vettorazzi
> > via R-
> > > help
> > > Sent: Tuesday, November 4, 2025 20:44
> > > To: Petr Pikal <peprcon.asc at centrum.cz>; Christophe Dutang <
> > dutangc at gmail.com>
> > > Cc: r-help at r-project.org
> > > Subject: Re: [R] [EXT] Re: A very small p-value
> > >
> > > Hi,
> > > Stepping briefly outside the R context, I noticed a statistical point
> in
> > > the text you linked that, in my opinion, isn't quite right. I believe
> > > there's a key misunderstanding here: The statement that the z-test does
> > > not depend on the number of cases is incorrect. The p-value of the
> > > z-test is ?just like other tests? very much dependent on the sample
> > > size, assuming the same mean difference and standard deviation.
> > > The text you linked is actually calculating an Effect Size, which is
> > > (largely) independent of the sample size. Effect Size answers the
> > > question of how "relevant" or "large" the difference between groups is.
> > > This is fundamentally different from testing for "significant"
> > differences.
> > > Specifically, the crucial 1/\sqrt{n} term, which is necessary for
> > > calculating the standard error of the mean difference, seems to be
> > > missing from the presented formula for the z-score. I just wanted to
> > > quickly point this out.
> > >
> > > Best regards
> > >
> > > Am 27.10.2025 um 14:12 schrieb Petr Pikal:
> > > > Hallo
> > > >
> > > > The t test is probably not the best option in your case. With 95
> > > > observations your data behave more like a population and you  may get
> > > > better insight using z-test. See
> > > >
> >
> https://toxictruthblog.com/avoiding-little-known-problems-with-the-t-test/
> > > >
> > > > Best regards.
> > > > Petr
> > > >
> > > > so 25. 10. 2025 v 11:46 odes?latel Christophe Dutang <
> > dutangc at gmail.com>
> > > > napsal:
> > > >
> > > >> Dear list,
> > > >>
> > > >> I'm computing a p-value for the Student test and discover some
> > > >> inconsistencies with the cdf pt().
> > > >>
> > > >> The observed statistic is 11.23995 for 95 observations, so the
> > p-value is
> > > >> very small
> > > >>
> > > >>> t_score <- 11.23995
> > > >>> n <- 95
> > > >>> print(pt(t_score, df = n-2, lower=FALSE), digits=22)
> > > >> [1] 2.539746620181247991746e-19
> > > >>> print(integrate(dt, lower=t_score, upper=Inf, df=n-2)$value, digits
> > = 22)
> > > >> [1] 2.539746631161970791961e-19
> > > >>
> > > >> But if I compute with pt(lower=TRUE), I got 0
> > > >>
> > > >>> print(1-pt(t_score, df = n-2, lower=TRUE), digits=22)
> > > >> [1] 0
> > > >>
> > > >> Indeed, the p-value is lower than the epsilon machine
> > > >>
> > > >>> pt(t_score, df = n-2, lower=FALSE) < .Machine$double.eps
> > > >> [1] TRUE
> > > >>
> > > >> Using the square of t statistic which follows a Fisher distribution,
> > I got
> > > >> the same issue:
> > > >>
> > > >>> print(pf(z, 1, n-2, lower=FALSE), digits=22)
> > > >> [1] 5.079493240362495983491e-19
> > > >>> print(integrate(df, lower=z, upper=Inf, df1=1, df2=n-2)$value,
> > digits =
> > > >> 22)
> > > >> [1] 5.079015231299358486828e-19
> > > >>> print(1-pf(z, 1, n-2, lower=TRUE), digits=22)
> > > >> [1] 0
> > > >>
> > > >> When using the t.test() function, the p-value is naturally printed :
> > > >> p-value < 2.2e-16.
> > > >>
> > > >> Any comment is welcome.
> > > >>
> > > >> Christophe
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide
> > https://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.
> >
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> https://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From rb@er @end|ng |rom @t@u@edu  Wed Nov  5 21:15:57 2025
From: rb@er @end|ng |rom @t@u@edu (Robert Baer)
Date: Wed, 5 Nov 2025 14:15:57 -0600
Subject: [R] Did behavior of "paired" argument in t.test() change?
In-Reply-To: <EAB00474-274F-4AE9-ACAA-867623273AB5@gmail.com>
References: <63780f63-544e-4ea4-a136-b7772a782c3e@atsu.edu>
 <20251104204021.0e690228@Tarkus>
 <EAB00474-274F-4AE9-ACAA-867623273AB5@gmail.com>
Message-ID: <0bf13a96-59af-4500-b377-c0247bcefce1@atsu.edu>

Thanks Ivan and Peter.

I had been extolling the virtues of long format to my students, and 
mentioning some its shortcomings with paired data like paired t.test. I 
then went off script (bad idea) to explain a workaround and fell down 
the rabbit hole. Thebug report 
<https://bugs.r-project.org/show_bug.cgi?id=14359>?14359 on this issue 
was first started in 2010 (several years after I had started using R), 
and finally resulted in a code change only in April 2024 - all of those 
years I was blissfully unaware and had developed some bad habits with 
regard to brittle order assumptions? ;-)

Even after rechecking ?t.test I was not certain that I was remembering 
the old behavior correctly, so it is good to know my memory is intact.? 
The help is accurate, but the various pieces are a little dissociated.? 
I think I learned I could trust the brittle ordering assumption 
(undocumented) by careful trial and error years ago.

Anyway, thanks for another great R learning experience -- It has been 
fun to see how thoughtfully and carefully the behavior of R base code is 
discussed before a change is made.? I wonder if 14 years of 
thinking/discussion is a record.

Also, I appreciate the suggestion to? use *split()* without having to 
completely ditch the use of the paired = TRUE argument, even if it still 
includes brittle order assumptions for pairs.? ?I must say that the 
Pair(x,y) ~ 1 formula syntax is not that easy for me to wrap my head 
around. I'll keep watching if there are further changes coming in R-devel

Rob

On 11/5/2025 6:28 AM, Peter Dalgaard wrote:

> Yes. Of course, Pair() requires the data to be in wide format. It's been a while (although not so long ago as some of the other things I cannot remember...) but I think the reason was that the  ...y~g, paired=TRUE... format was considered too brittle with respect to sort order and subsetting.
>
> -pd
>
>
>> On 4 Nov 2025, at 18.40, Ivan Krylov via R-help<r-help at r-project.org> wrote:
>>
>> ? Tue, 4 Nov 2025 11:22:57 -0600
>> Robert Baer via R-help<r-help at r-project.org> ?????:
>>
>>> Errorin t.test.formula(value ~ time, data = data_long, paired =
>>> TRUE) :
>>> cannot use 'paired' in formula method
>> This was changed in R-4.4.0:
>> https://bugs.r-project.org/show_bug.cgi?id=14359
>>
>> The news item (see news(grepl('paired', Text))) recommends the use of
>> Pair(x1, x2) ~ 1 instead of the 'paired' argument. A further fix is
>> currently in R-devel (but not R-patched): without it, Pair(x1, x2) does
>> not handle the 'subset' argument.
>>
>> -- 
>> Best regards,
>> Ivan
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guidehttps://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.

-- 
---
Robert W. Baer, Ph.D.
Professor of Physiology
Kirksville College of Osteopathic Medicine
A.T. Still Univerisity of Health Sciences
800 W. Jefferson St.
Kirksville, MO 63501

	[[alternative HTML version deleted]]


From rk @end|ng |rom rk@|y|  Wed Nov  5 17:32:00 2025
From: rk @end|ng |rom rk@|y| (Robert Knight)
Date: Wed, 5 Nov 2025 11:32:00 -0500 (EST)
Subject: [R] [EXT] Re:  A very small p-value
In-Reply-To: <d589708f-a202-4dac-8d4a-89b196ed3ee9@rk.fyi>
References: <19B8367F-913D-4CF9-89F6-E6922EE61DA1@gmail.com>
 <CAO8Egw_AnEJpFEwp8P+uSBE0zJRdipn30NW8aB736y2HaOUSDg@mail.gmail.com>
 <e810de9c-dbb2-4234-b592-5828ef29bc34@uke.de>
 <AS8PR08MB91937470A76108FA9B4025058BC5A@AS8PR08MB9193.eurprd08.prod.outlook.com>
 <d589708f-a202-4dac-8d4a-89b196ed3ee9@rk.fyi>
Message-ID: <7dc57fdd-9d54-49ec-be12-d868400752ed@rk.fyi>


Nov 5, 2025 11:29:18 AM Robert Knight <rk at rk.fyi>:

> "The CLT says nothing about the distribution of the raw data."
> 
> The central limit theorem is explicitly about the distribution of the raw data.(1)
> 
> You also said the law of large numbers did not apply, but does.? The law of large numbers is that as the sample size increases, the mean of the sample will approach the mean of the population.
> 
> Your two critiques seem out if place.
> 
> The BMJ has an excellent lesson calculating z scores.
> 
> https://www.geeksforgeeks.org/maths/central-limit-theorem/
> 
> Regards,
> 
> Economist Bob
> 
> Nov 5, 2025 9:04:57 AM Viechtbauer, Wolfgang (NP) via R-help <r-help at r-project.org>:
> 
>> Eik, thanks for posting this. I thought that the page was making the usual (just somewhat flawed) argument that once the dfs are sufficiently large, whether one does pnorm(...) or pt(..., df=<>) makes little difference (although far out in the tails it still does).
>> 
>> Your post made me look at the page and I hope nobody takes anything written there serious. The argument is so utterly wrong. I am absolutely flabbergasted how somebody could write so many pages of text based on such a flawed understanding of basic statistical concepts.
>> 
>> Just to give some examples:
>> 
>> "The next issue I have is that I can't see the underlying data. So I don't know what the actual shape of the distribution is, but it's probably fair to say it's normally distributed (assuming the Central Limit Theorem applies)." The CLT says nothing about the distribution of the raw data.
>> 
>> "As the sample size increases, samples will begin to operate and appear more and more like the population they are drawn from. This is the Law of Large Numbers." The law of large numbers has nothing to do with this.
>> 
>> And as Eik already pointed out, the 'z-test' the author is describing is not a test at all, but essentially just calculates the standardized mean difference (and computing a p-value from it makes no sense).
>> 
>> Best,
>> Wolfgang
>> 
>>> -----Original Message-----
>>> From: R-help <r-help-bounces at r-project.org> On Behalf Of Eik Vettorazzi via R-
>>> help
>>> Sent: Tuesday, November 4, 2025 20:44
>>> To: Petr Pikal <peprcon.asc at centrum.cz>; Christophe Dutang <dutangc at gmail.com>
>>> Cc: r-help at r-project.org
>>> Subject: Re: [R] [EXT] Re: A very small p-value
>>> 
>>> Hi,
>>> Stepping briefly outside the R context, I noticed a statistical point in
>>> the text you linked that, in my opinion, isn't quite right. I believe
>>> there's a key misunderstanding here: The statement that the z-test does
>>> not depend on the number of cases is incorrect. The p-value of the
>>> z-test is ?just like other tests? very much dependent on the sample
>>> size, assuming the same mean difference and standard deviation.
>>> The text you linked is actually calculating an Effect Size, which is
>>> (largely) independent of the sample size. Effect Size answers the
>>> question of how "relevant" or "large" the difference between groups is.
>>> This is fundamentally different from testing for "significant" differences.
>>> Specifically, the crucial 1/\sqrt{n} term, which is necessary for
>>> calculating the standard error of the mean difference, seems to be
>>> missing from the presented formula for the z-score. I just wanted to
>>> quickly point this out.
>>> 
>>> Best regards
>>> 
>>> Am 27.10.2025 um 14:12 schrieb Petr Pikal:
>>>> Hallo
>>>> 
>>>> The t test is probably not the best option in your case. With 95
>>>> observations your data behave more like a population and you? may get
>>>> better insight using z-test. See
>>>> https://toxictruthblog.com/avoiding-little-known-problems-with-the-t-test/
>>>> 
>>>> Best regards.
>>>> Petr
>>>> 
>>>> so 25. 10. 2025 v 11:46 odes?latel Christophe Dutang <dutangc at gmail.com>
>>>> napsal:
>>>> 
>>>>> Dear list,
>>>>> 
>>>>> I'm computing a p-value for the Student test and discover some
>>>>> inconsistencies with the cdf pt().
>>>>> 
>>>>> The observed statistic is 11.23995 for 95 observations, so the p-value is
>>>>> very small
>>>>> 
>>>>>> ?
>>>>> [1] 2.539746620181247991746e-19
>>>>>> ?
>>>>> [1] 2.539746631161970791961e-19
>>>>> 
>>>>> But if I compute with pt(lower=TRUE), I got 0
>>>>> 
>>>>>> ?
>>>>> [1] 0
>>>>> 
>>>>> Indeed, the p-value is lower than the epsilon machine
>>>>> 
>>>>>> ?
>>>>> [1] TRUE
>>>>> 
>>>>> Using the square of t statistic which follows a Fisher distribution, I got
>>>>> the same issue:
>>>>> 
>>>>>> ?
>>>>> [1] 5.079493240362495983491e-19
>>>>>> ?
>>>>> 22)
>>>>> [1] 5.079015231299358486828e-19
>>>>>> ?
>>>>> [1] 0
>>>>> 
>>>>> When using the t.test() function, the p-value is naturally printed :
>>>>> p-value < 2.2e-16.
>>>>> 
>>>>> Any comment is welcome.
>>>>> 
>>>>> Christophe
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide https://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.

	[[alternative HTML version deleted]]


From rk @end|ng |rom rk@|y|  Wed Nov  5 17:36:02 2025
From: rk @end|ng |rom rk@|y| (Robert Knight)
Date: Wed, 5 Nov 2025 11:36:02 -0500 (EST)
Subject: [R] [EXT] Re:  A very small p-value
In-Reply-To: <d589708f-a202-4dac-8d4a-89b196ed3ee9@rk.fyi>
References: <19B8367F-913D-4CF9-89F6-E6922EE61DA1@gmail.com>
 <CAO8Egw_AnEJpFEwp8P+uSBE0zJRdipn30NW8aB736y2HaOUSDg@mail.gmail.com>
 <e810de9c-dbb2-4234-b592-5828ef29bc34@uke.de>
 <AS8PR08MB91937470A76108FA9B4025058BC5A@AS8PR08MB9193.eurprd08.prod.outlook.com>
 <d589708f-a202-4dac-8d4a-89b196ed3ee9@rk.fyi>
Message-ID: <f9736136-74dd-4bf4-93f0-090979c283a8@rk.fyi>

Also, the central limit theory and kurtosis is why the economics associates fought against lockdown during covid.

Because of the central limit theorem, any position on the curve was itself a distribution, and since kurtosis would apply, any attempt to flatten a curve would increase the mean.?? Said folks were correct.

The two statements you identified as indicating incorrectness by the author are actually correct.

Nov 5, 2025 11:29:18 AM Robert Knight <rk at rk.fyi>:

> "The CLT says nothing about the distribution of the raw data."
> 
> The central limit theorem is explicitly about the distribution of the raw data.(1)
> 
> You also said the law of large numbers did not apply, but does.? The law of large numbers is that as the sample size increases, the mean of the sample will approach the mean of the population.
> 
> Your two critiques seem out if place.
> 
> The BMJ has an excellent lesson calculating z scores.
> 
> https://www.geeksforgeeks.org/maths/central-limit-theorem/
> 
> Regards,
> 
> Economist Bob
> 
> Nov 5, 2025 9:04:57 AM Viechtbauer, Wolfgang (NP) via R-help <r-help at r-project.org>:
> 
>> Eik, thanks for posting this. I thought that the page was making the usual (just somewhat flawed) argument that once the dfs are sufficiently large, whether one does pnorm(...) or pt(..., df=<>) makes little difference (although far out in the tails it still does).
>> 
>> Your post made me look at the page and I hope nobody takes anything written there serious. The argument is so utterly wrong. I am absolutely flabbergasted how somebody could write so many pages of text based on such a flawed understanding of basic statistical concepts.
>> 
>> Just to give some examples:
>> 
>> "The next issue I have is that I can't see the underlying data. So I don't know what the actual shape of the distribution is, but it's probably fair to say it's normally distributed (assuming the Central Limit Theorem applies)." The CLT says nothing about the distribution of the raw data.
>> 
>> "As the sample size increases, samples will begin to operate and appear more and more like the population they are drawn from. This is the Law of Large Numbers." The law of large numbers has nothing to do with this.
>> 
>> And as Eik already pointed out, the 'z-test' the author is describing is not a test at all, but essentially just calculates the standardized mean difference (and computing a p-value from it makes no sense).
>> 
>> Best,
>> Wolfgang
>> 
>>> -----Original Message-----
>>> From: R-help <r-help-bounces at r-project.org> On Behalf Of Eik Vettorazzi via R-
>>> help
>>> Sent: Tuesday, November 4, 2025 20:44
>>> To: Petr Pikal <peprcon.asc at centrum.cz>; Christophe Dutang <dutangc at gmail.com>
>>> Cc: r-help at r-project.org
>>> Subject: Re: [R] [EXT] Re: A very small p-value
>>> 
>>> Hi,
>>> Stepping briefly outside the R context, I noticed a statistical point in
>>> the text you linked that, in my opinion, isn't quite right. I believe
>>> there's a key misunderstanding here: The statement that the z-test does
>>> not depend on the number of cases is incorrect. The p-value of the
>>> z-test is ?just like other tests? very much dependent on the sample
>>> size, assuming the same mean difference and standard deviation.
>>> The text you linked is actually calculating an Effect Size, which is
>>> (largely) independent of the sample size. Effect Size answers the
>>> question of how "relevant" or "large" the difference between groups is.
>>> This is fundamentally different from testing for "significant" differences.
>>> Specifically, the crucial 1/\sqrt{n} term, which is necessary for
>>> calculating the standard error of the mean difference, seems to be
>>> missing from the presented formula for the z-score. I just wanted to
>>> quickly point this out.
>>> 
>>> Best regards
>>> 
>>> Am 27.10.2025 um 14:12 schrieb Petr Pikal:
>>>> Hallo
>>>> 
>>>> The t test is probably not the best option in your case. With 95
>>>> observations your data behave more like a population and you? may get
>>>> better insight using z-test. See
>>>> https://toxictruthblog.com/avoiding-little-known-problems-with-the-t-test/
>>>> 
>>>> Best regards.
>>>> Petr
>>>> 
>>>> so 25. 10. 2025 v 11:46 odes?latel Christophe Dutang <dutangc at gmail.com>
>>>> napsal:
>>>> 
>>>>> Dear list,
>>>>> 
>>>>> I'm computing a p-value for the Student test and discover some
>>>>> inconsistencies with the cdf pt().
>>>>> 
>>>>> The observed statistic is 11.23995 for 95 observations, so the p-value is
>>>>> very small
>>>>> 
>>>>>> ?
>>>>> [1] 2.539746620181247991746e-19
>>>>>> ?
>>>>> [1] 2.539746631161970791961e-19
>>>>> 
>>>>> But if I compute with pt(lower=TRUE), I got 0
>>>>> 
>>>>>> ?
>>>>> [1] 0
>>>>> 
>>>>> Indeed, the p-value is lower than the epsilon machine
>>>>> 
>>>>>> ?
>>>>> [1] TRUE
>>>>> 
>>>>> Using the square of t statistic which follows a Fisher distribution, I got
>>>>> the same issue:
>>>>> 
>>>>>> ?
>>>>> [1] 5.079493240362495983491e-19
>>>>>> ?
>>>>> 22)
>>>>> [1] 5.079015231299358486828e-19
>>>>>> ?
>>>>> [1] 0
>>>>> 
>>>>> When using the t.test() function, the p-value is naturally printed :
>>>>> p-value < 2.2e-16.
>>>>> 
>>>>> Any comment is welcome.
>>>>> 
>>>>> Christophe
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide https://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.

	[[alternative HTML version deleted]]


From vo|k@n@b@t|t @end|ng |rom @tudent@un|-@|egen@de  Sat Nov  8 12:33:32 2025
From: vo|k@n@b@t|t @end|ng |rom @tudent@un|-@|egen@de (Batit, Volkan)
Date: Sat, 8 Nov 2025 11:33:32 +0000
Subject: [R] Problem with R-File
Message-ID: <92d165bd9d38458aa17656a39592e204@student.uni-siegen.de>

Hello everyone,


I have an problem with loading my data in R.


When I wanted to continue working on my R-file today, I couldn't load it, even though I had saved it yesterday. Do you know how I can get the data set back?


[https://download.mail.uni-siegen.de/owa/volkan.batit at student.uni-siegen.de/service.svc/s/GetFileAttachment?id=AAMkADdkOGJhZTU1LTk5MjYtNGE0ZS1iN2FkLWQ5NzNlMjQwMzU3MABGAAAAAAAIpVyi%2F1rSQb9Ri%2FjR4bhABwAi5fasp1aORKiJzHuBnrJCAAAAAAEJAAAi5fasp1aORKiJzHuBnrJCAARdySHRAAABEgAQAEU6Ael00wlDig3aTfQM1UI%3D&X-OWA-CANARY=aOZAdcKiyUWSJljKbL7MvrBYKDK6Ht4IeSAhvwwjarIG4ux5lg6S6be1oYUbd2kmuxxoRr8XqHg.&token=eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6ImttV2ZOQVI1dlFWVmNtODd5QjNxaS1OQ0c4ZyJ9.eyJ2ZXIiOiJFeGNoYW5nZS5DYWxsYmFjay5WMSIsImFwcGN0eHNlbmRlciI6Ik93YURvd25sb2FkQHVuaS1zaWVnZW4uZGUiLCJhcHBjdHgiOiJ7XCJtc2V4Y2hwcm90XCI6XCJvd2FcIixcInByaW1hcnlzaWRcIjpcIlMtMS01LTIxLTMwNDIyMjM2MjYtNDIzNTczNzc2NS0zNjEzMzg1ODg2LTMyMjA0NVwiLFwicHVpZFwiOm51bGwsXCJvaWRcIjpcIlwiLFwic2NvcGVcIjpcIk93YURvd25sb2FkXCJ9IiwiaXNzIjoiMDAwMDAwMDItMDAwMC0wZmYxLWNlMDAtMDAwMDAwMDAwMDAwQHVuaS1zaWVnZW4uZGUiLCJhdWQiOiIwMDAwMDAwMi0wMDAwLTBmZjEtY2UwMC0wMDAwMDAwMDAwMDAvZG93bmxvYWQubWFpbC51bmktc2llZ2VuLmRlQHVuaS1zaWVnZW4uZGUiLCJleHAiOjE3NjI2MDE4OTksIm5iZiI6MTc2MjYwMTI5OX0.f7So41J2heLcTDsF9uYARQT6PwDs_oPHkhMEnpAJspi8DMSD3wO05pmvb2JD7_Lka3Fl9iyGG-wyz2Yv3_dvt4u6wmGoumwibHXXHKpZrv-ukl05HlAIXtHS_xmkrFCpWVWNUd6VcAU5i2rEa-MX3Nhv9kYvSO5a5qM4d38LLomkpxMEQVfNxMsJfRVAtNStRxiGG0TM6niZi98Y7khl3VE1BQ07D2U31Vdhie-38HqDZeQkuuwlcEwgTR-O4XjRYvqpm1zvYa1q4veY4cyC7IOzeBtRabeyhlfjLAk0vxFdLukRIKu7HmlMGUuOqTMTobOROcUgcyKGDCF0DkSwhg&owa=mail.uni-siegen.de&isImagePreview=True]


I hope you can help me with my problem.


Thanks and kind regards

Volkan


	[[alternative HTML version deleted]]


From cry@n @end|ng |rom b|ngh@mton@edu  Sat Nov  8 17:22:28 2025
From: cry@n @end|ng |rom b|ngh@mton@edu (Christopher W. Ryan)
Date: Sat, 8 Nov 2025 11:22:28 -0500
Subject: [R] Problem with R-File
In-Reply-To: <92d165bd9d38458aa17656a39592e204@student.uni-siegen.de>
References: <92d165bd9d38458aa17656a39592e204@student.uni-siegen.de>
Message-ID: <97f1ce8a-0fd1-adbd-86fb-ec700980af91@binghamton.edu>

This is pretty vague. What do you mean by "R-file?"  What do you mean by
"the data set?"  It would help folks to help you if you explained
exactly what you did to "continue working on my R-file," and exactly how
R responded. Post at least the part of your code that produced an error,
and post the error message.

--Chris Ryan

Batit, Volkan wrote:
> Hello everyone,
> 
> 
> I have an problem with loading my data in R.
> 
> 
> When I wanted to continue working on my R-file today, I couldn't load it, even though I had saved it yesterday. Do you know how I can get the data set back?
> 
> 
> [https://download.mail.uni-siegen.de/owa/volkan.batit at student.uni-siegen.de/service.svc/s/GetFileAttachment?id=AAMkADdkOGJhZTU1LTk5MjYtNGE0ZS1iN2FkLWQ5NzNlMjQwMzU3MABGAAAAAAAIpVyi%2F1rSQb9Ri%2FjR4bhABwAi5fasp1aORKiJzHuBnrJCAAAAAAEJAAAi5fasp1aORKiJzHuBnrJCAARdySHRAAABEgAQAEU6Ael00wlDig3aTfQM1UI%3D&X-OWA-CANARY=aOZAdcKiyUWSJljKbL7MvrBYKDK6Ht4IeSAhvwwjarIG4ux5lg6S6be1oYUbd2kmuxxoRr8XqHg.&token=eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6ImttV2ZOQVI1dlFWVmNtODd5QjNxaS1OQ0c4ZyJ9.eyJ2ZXIiOiJFeGNoYW5nZS5DYWxsYmFjay5WMSIsImFwcGN0eHNlbmRlciI6Ik93YURvd25sb2FkQHVuaS1zaWVnZW4uZGUiLCJhcHBjdHgiOiJ7XCJtc2V4Y2hwcm90XCI6XCJvd2FcIixcInByaW1hcnlzaWRcIjpcIlMtMS01LTIxLTMwNDIyMjM2MjYtNDIzNTczNzc2NS0zNjEzMzg1ODg2LTMyMjA0NVwiLFwicHVpZFwiOm51bGwsXCJvaWRcIjpcIlwiLFwic2NvcGVcIjpcIk93YURvd25sb2FkXCJ9IiwiaXNzIjoiMDAwMDAwMDItMDAwMC0wZmYxLWNlMDAtMDAwMDAwMDAwMDAwQHVuaS1zaWVnZW4uZGUiLCJhdWQiOiIwMDAwMDAwMi0wMDAwLTBmZjEtY2UwMC0wMDAwMDAwMDAwMDAvZG93bmxvYWQubWFpbC51bmktc2llZ2VuLmRlQHVuaS1zaWVnZW4uZGUiLCJleHAiOjE3NjI2MDE
>  4OTksIm5iZiI6MTc2MjYwMTI5OX0.f7So41J2heLcTDsF9uYARQT6PwDs_oPHkhMEnpAJspi8DMSD3wO05pmvb2JD7_Lka3Fl9iyGG-wyz2Yv3_dvt4u6wmGoumwibHXXHKpZrv-ukl05HlAIXtHS_xmkrFCpWVWNUd6VcAU5i2rEa-MX3Nhv9kYvSO5a5qM4d38LLomkpxMEQVfNxMsJfRVAtNStRxiGG0TM6niZi98Y7khl3VE1BQ07D2U31Vdhie-38HqDZeQkuuwlcEwgTR-O4XjRYvqpm1zvYa1q4veY4cyC7IOzeBtRabeyhlfjLAk0vxFdLukRIKu7HmlMGUuOqTMTobOROcUgcyKGDCF0DkSwhg&owa=mail.uni-siegen.de&isImagePreview=True]
> 
> 
> I hope you can help me with my problem.
> 
> 
> Thanks and kind regards
> 
> Volkan
> 
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide https://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
> 

From murdoch@dunc@n @end|ng |rom gm@||@com  Sun Nov  9 02:53:43 2025
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Sat, 8 Nov 2025 20:53:43 -0500
Subject: [R] rgl on MacOS Tahoe is not working
Message-ID: <bc4b1280-a48f-4ff6-b3ce-808ea9cd31d2@gmail.com>

To all rgl users on MacOS:

I've had several reports that rgl's X11 windows don't work on MacOS 
Tahoe.  From a limited amount of research, this looks like something 
that will not be easily fixed.  It will require changes to Tahoe or 
XQuartz, and neither of those look likely at this time.

You can still use the WebGL display, where your scenes are displayed by 
running rglwidget().  This can be set to happen automatically by setting 
the options

   options(rgl.useNULL = TRUE, rgl.printRglwidget = TRUE)

The rglwidget() display is not quite as friendly as the X11 display, but 
it's the best you will get for now at least.  If you have a choice, I'd 
suggest avoiding the update to MacOS Tahoe.

Right now I'm trying to see if I can reinstall Sequoia...

Duncan Murdoch


From dw|n@em|u@ @end|ng |rom comc@@t@net  Sun Nov  9 03:48:50 2025
From: dw|n@em|u@ @end|ng |rom comc@@t@net (David Winsemius)
Date: Sat, 8 Nov 2025 18:48:50 -0800
Subject: [R] rgl on MacOS Tahoe is not working
In-Reply-To: <bc4b1280-a48f-4ff6-b3ce-808ea9cd31d2@gmail.com>
References: <bc4b1280-a48f-4ff6-b3ce-808ea9cd31d2@gmail.com>
Message-ID: <ECF2F298-6D1E-4361-A397-167BDD2F2784@comcast.net>

Thanks for the heads up. I usually delay updating a bit unless I hear of a particularly nasty threat in the wild. 

? 
David
Sent from my iPhone

> On Nov 8, 2025, at 5:54?PM, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
> 
> ?To all rgl users on MacOS:
> 
> I've had several reports that rgl's X11 windows don't work on MacOS Tahoe.  From a limited amount of research, this looks like something that will not be easily fixed.  It will require changes to Tahoe or XQuartz, and neither of those look likely at this time.
> 
> You can still use the WebGL display, where your scenes are displayed by running rglwidget().  This can be set to happen automatically by setting the options
> 
>  options(rgl.useNULL = TRUE, rgl.printRglwidget = TRUE)
> 
> The rglwidget() display is not quite as friendly as the X11 display, but it's the best you will get for now at least.  If you have a choice, I'd suggest avoiding the update to MacOS Tahoe.
> 
> Right now I'm trying to see if I can reinstall Sequoia...
> 
> Duncan Murdoch
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide https://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From r-p@ck@ge@ @end|ng |rom r-project@org  Sat Nov  8 12:28:42 2025
From: r-p@ck@ge@ @end|ng |rom r-project@org (=?utf-8?q?Albert_Ses=C3=A9_via_R-packages?=)
Date: Sat, 8 Nov 2025 12:28:42 +0100
Subject: [R] [R-pkgs] MLwrap: An R package for simplifying Machine Learning
 Models
Message-ID: <20e36a82-665b-49eb-a035-f3922cc0ce46@id.uib.eu>

Dear R-packages community,

I am prof. Albert Ses? from the University of the Balearic Islands (UIB).

I am writing to announce MLwrap, an R package now available on CRAN.

MLwrap is designed to simplify machine learning implementation for 
educational and research contexts. It provides a step-by-step workflow 
that emphasizes reproducibility, transparency, and pedagogical clarity.

The package integrates four machine learning algorithms:

- Neural Networks (Multilayer Perceptron)
- Support Vector Machines
- Random Forests
- XGBoost

Key features:

- Unified pipeline for model building, optimization, and evaluation
- Explicit handling of random seeds for reproducibility
- Clear, accessible interface for learning
- Built-in sensitivity analysis for model interpretation

Resources:

CRAN package: https://cran.r-project.org/web/packages/MLwrap
Tutorial: https://osf.io/preprints/psyarxiv/j6m4z

Web page: https://areademetodologia.uib.es/MLwrap/MLwrap_website.html

MLwrap is particularly useful for teaching statistics and data science? 
courses to students and researchers new to machine learning.

Best regards,
Dr. Albert Ses?
University of the Balearic Islands (UIB)
Department of Psychology
albert.sese at uib.es

_______________________________________________
R-packages mailing list
R-packages at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-packages


From murdoch@dunc@n @end|ng |rom gm@||@com  Sun Nov  9 16:52:09 2025
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Sun, 9 Nov 2025 10:52:09 -0500
Subject: [R] rgl on MacOS Tahoe is not working
In-Reply-To: <ECF2F298-6D1E-4361-A397-167BDD2F2784@comcast.net>
References: <bc4b1280-a48f-4ff6-b3ce-808ea9cd31d2@gmail.com>
 <ECF2F298-6D1E-4361-A397-167BDD2F2784@comcast.net>
Message-ID: <80961dd8-e70c-4694-bfb2-6e40be12a1ff@gmail.com>

No problem.  BTW, advice for anyone who does want to update to Tahoe:

Do a Time Machine backup just before the update.  It is possible to 
revert the update, but it is slow and a little nerve wracking:  it 
involves reformatting your main disk to make it bootable in Sequoia, 
then restoring from the backup.

Duncan Murdoch

On 2025-11-08 9:48 p.m., David Winsemius wrote:
> Thanks for the heads up. I usually delay updating a bit unless I hear of a particularly nasty threat in the wild.
> 
> ?
> David
> Sent from my iPhone
> 
>> On Nov 8, 2025, at 5:54?PM, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
>>
>> ?To all rgl users on MacOS:
>>
>> I've had several reports that rgl's X11 windows don't work on MacOS Tahoe.  From a limited amount of research, this looks like something that will not be easily fixed.  It will require changes to Tahoe or XQuartz, and neither of those look likely at this time.
>>
>> You can still use the WebGL display, where your scenes are displayed by running rglwidget().  This can be set to happen automatically by setting the options
>>
>>   options(rgl.useNULL = TRUE, rgl.printRglwidget = TRUE)
>>
>> The rglwidget() display is not quite as friendly as the X11 display, but it's the best you will get for now at least.  If you have a choice, I'd suggest avoiding the update to MacOS Tahoe.
>>
>> Right now I'm trying to see if I can reinstall Sequoia...
>>
>> Duncan Murdoch
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide https://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>


From pb@r@t@ @end|ng |rom |n|o||nk@com@br  Tue Nov 11 19:27:46 2025
From: pb@r@t@ @end|ng |rom |n|o||nk@com@br (Paulo Barata)
Date: Tue, 11 Nov 2025 15:27:46 -0300
Subject: [R] package stats / prop.trend.test function
Message-ID: <7068cdda-ef75-4f69-a2c1-48427149aefb@infolink.com.br>

To the R-Help list,

About the prop.trend.test function, in the package stats.

What calculations exactly does that function perform? What test is actually carried out? May I have some reference for the calculations performed by that function?

I would like to suggest that some references (one or more) be included in the Help file for the function.

Thank you very much.

Paulo Barata

Rio de Janeiro - Brazil


From ||@t@ @end|ng |rom dewey@myzen@co@uk  Wed Nov 12 11:55:22 2025
From: ||@t@ @end|ng |rom dewey@myzen@co@uk (Michael Dewey)
Date: Wed, 12 Nov 2025 10:55:22 +0000
Subject: [R] package stats / prop.trend.test function
In-Reply-To: <7068cdda-ef75-4f69-a2c1-48427149aefb@infolink.com.br>
References: <7068cdda-ef75-4f69-a2c1-48427149aefb@infolink.com.br>
Message-ID: <7ab3b054-22e8-48f8-8ff5-b21c4cd59f9d@dewey.myzen.co.uk>

Dear Paulo

You did realise that if you type prop.trend.test you get

function (x, n, score = seq_along(x))
{
     method <- "Chi-squared Test for Trend in Proportions"
     dname <- paste(deparse1(substitute(x)), "out of", 
deparse1(substitute(n)),
         ",\n using scores:", paste(score, collapse = " "))
     x <- as.vector(x)
     n <- as.vector(n)
     p <- sum(x)/sum(n)
     w <- n/p/(1 - p)
     a <- anova(lm(freq ~ score, data = list(freq = x/n, score = 
as.vector(score)),
         weights = w))
     chisq <- c(`X-squared` = a["score", "Sum Sq"])
     structure(list(statistic = chisq, parameter = c(df = 1),
         p.value = pchisq(as.numeric(chisq), 1, lower.tail = FALSE),
         method = method, data.name = dname), class = "htest")
}
<bytecode: 0x0000021d81d4c850>
<environment: namespace:stats>

Does that help?

Michael

On 11/11/2025 18:27, Paulo Barata wrote:
> To the R-Help list,
> 
> About the prop.trend.test function, in the package stats.
> 
> What calculations exactly does that function perform? What test is 
> actually carried out? May I have some reference for the calculations 
> performed by that function?
> 
> I would like to suggest that some references (one or more) be included 
> in the Help file for the function.
> 
> Thank you very much.
> 
> Paulo Barata
> 
> Rio de Janeiro - Brazil
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide https://www.R-project.org/posting- 
> guide.html
> and provide commented, minimal, self-contained, reproducible code.

-- 
Michael Dewey


From pd@|gd @end|ng |rom gm@||@com  Wed Nov 12 13:49:57 2025
From: pd@|gd @end|ng |rom gm@||@com (Peter Dalgaard)
Date: Wed, 12 Nov 2025 13:49:57 +0100
Subject: [R] package stats / prop.trend.test function
In-Reply-To: <7ab3b054-22e8-48f8-8ff5-b21c4cd59f9d@dewey.myzen.co.uk>
References: <7068cdda-ef75-4f69-a2c1-48427149aefb@infolink.com.br>
 <7ab3b054-22e8-48f8-8ff5-b21c4cd59f9d@dewey.myzen.co.uk>
Message-ID: <AD936800-0821-4536-8BDA-8D4F416C430C@gmail.com>

There's a worked example of the procedure in Altman: Practical Statistics for Medical Research, also featured in help(ISwR::caesarean). 

(I have forgotten the origin of example(prop.trend.test), though. If I ever knew it. Apparently it is the same as in help(prop.test): Fleiss(1981), p.139, but I don't have that edition to hand and I don't see it in Fleiss(1973).)

-pd


> On 12 Nov 2025, at 11.55, Michael Dewey <lists at dewey.myzen.co.uk> wrote:
> 
> Dear Paulo
> 
> You did realise that if you type prop.trend.test you get
> 
> function (x, n, score = seq_along(x))
> {
>    method <- "Chi-squared Test for Trend in Proportions"
>    dname <- paste(deparse1(substitute(x)), "out of", deparse1(substitute(n)),
>        ",\n using scores:", paste(score, collapse = " "))
>    x <- as.vector(x)
>    n <- as.vector(n)
>    p <- sum(x)/sum(n)
>    w <- n/p/(1 - p)
>    a <- anova(lm(freq ~ score, data = list(freq = x/n, score = as.vector(score)),
>        weights = w))
>    chisq <- c(`X-squared` = a["score", "Sum Sq"])
>    structure(list(statistic = chisq, parameter = c(df = 1),
>        p.value = pchisq(as.numeric(chisq), 1, lower.tail = FALSE),
>        method = method, data.name = dname), class = "htest")
> }
> <bytecode: 0x0000021d81d4c850>
> <environment: namespace:stats>
> 
> Does that help?
> 
> Michael
> 
> On 11/11/2025 18:27, Paulo Barata wrote:
>> To the R-Help list,
>> About the prop.trend.test function, in the package stats.
>> What calculations exactly does that function perform? What test is actually carried out? May I have some reference for the calculations performed by that function?
>> I would like to suggest that some references (one or more) be included in the Help file for the function.
>> Thank you very much.
>> Paulo Barata
>> Rio de Janeiro - Brazil
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide https://www.R-project.org/posting- guide.html
>> and provide commented, minimal, self-contained, reproducible code.
> 
> -- 
> Michael Dewey
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide https://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.

-- 
Peter Dalgaard, Professor,
Center for Statistics, Copenhagen Business School
Solbjerg Plads 3, 2000 Frederiksberg, Denmark
Phone: (+45)38153501
Office: A 4.23
Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com


From pb@r@t@ @end|ng |rom |n|o||nk@com@br  Wed Nov 12 14:01:34 2025
From: pb@r@t@ @end|ng |rom |n|o||nk@com@br (Paulo Barata)
Date: Wed, 12 Nov 2025 10:01:34 -0300
Subject: [R] package stats / prop.trend.test function
In-Reply-To: <7ab3b054-22e8-48f8-8ff5-b21c4cd59f9d@dewey.myzen.co.uk>
References: <7068cdda-ef75-4f69-a2c1-48427149aefb@infolink.com.br>
 <7ab3b054-22e8-48f8-8ff5-b21c4cd59f9d@dewey.myzen.co.uk>
Message-ID: <8e60c3a4-1650-47e3-8f97-f2fe92e8cb95@infolink.com.br>

Dear Michael,

Yes, I forgot about that, just typing the function's name. My fault, I am sorry.

Thank you very much for your reply.

Best regards,

Paulo

-------------------------------------------------------

On 12-Nov-25 7:55, Michael Dewey wrote:
> Dear Paulo
> 
> You did realise that if you type prop.trend.test you get
> 
> function (x, n, score = seq_along(x))
> {
>  ??? method <- "Chi-squared Test for Trend in Proportions"
>  ??? dname <- paste(deparse1(substitute(x)), "out of", deparse1(substitute(n)),
>  ??????? ",\n using scores:", paste(score, collapse = " "))
>  ??? x <- as.vector(x)
>  ??? n <- as.vector(n)
>  ??? p <- sum(x)/sum(n)
>  ??? w <- n/p/(1 - p)
>  ??? a <- anova(lm(freq ~ score, data = list(freq = x/n, score = as.vector(score)),
>  ??????? weights = w))
>  ??? chisq <- c(`X-squared` = a["score", "Sum Sq"])
>  ??? structure(list(statistic = chisq, parameter = c(df = 1),
>  ??????? p.value = pchisq(as.numeric(chisq), 1, lower.tail = FALSE),
>  ??????? method = method, data.name = dname), class = "htest")
> }
> <bytecode: 0x0000021d81d4c850>
> <environment: namespace:stats>
> 
> Does that help?
> 
> Michael
> 
> On 11/11/2025 18:27, Paulo Barata wrote:
>> To the R-Help list,
>>
>> About the prop.trend.test function, in the package stats.
>>
>> What calculations exactly does that function perform? What test is actually carried out? May I have some reference for the calculations performed by that function?
>>
>> I would like to suggest that some references (one or more) be included in the Help file for the function.
>>
>> Thank you very much.
>>
>> Paulo Barata
>>
>> Rio de Janeiro - Brazil
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide https://www.R-project.org/posting- guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>


From br|@n@m|th199312 @end|ng |rom gm@||@com  Wed Nov 12 17:30:54 2025
From: br|@n@m|th199312 @end|ng |rom gm@||@com (Brian Smith)
Date: Wed, 12 Nov 2025 22:00:54 +0530
Subject: [R] Is this a valid syntax for lm()
Message-ID: <CAHUBDY_KMfT2mmv9+s3y-rf_j=Wub05Hdab6J4RetKfpUbbeXQ@mail.gmail.com>

Hi,

I have below code

ctl <- c(4.17,5.58,5.18,6.11,4.50,4.61,5.17,4.53,5.33,5.14)
trt <- c(4.81,4.17,4.41,3.59,5.87,3.83,6.03,4.89,4.32,4.69)
group <- gl(2, 10, 20, labels = c("Ctl","Trt"))
group1 <- head(gl(2, 10, 22, labels = c("Ctl1","Trt1")), 20)
weight <- c(ctl, trt)
dat = as.data.frame(cbind(weight, group, group1))
lm.D9 <- lm(weight ~ group * group1 - 1 - group1, dat)

I want to incorporate interaction between 2 variables group and
group1, however do not want to incorporate level-0 for group1 not the
intercept.

Therefore I used (-1 - group1) in the formula.

I would like to know if above is a valid syntax for the stated model.

Thanks and regards,


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Wed Nov 12 18:12:38 2025
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Wed, 12 Nov 2025 17:12:38 +0000
Subject: [R] Is this a valid syntax for lm()
In-Reply-To: <CAHUBDY_KMfT2mmv9+s3y-rf_j=Wub05Hdab6J4RetKfpUbbeXQ@mail.gmail.com>
References: <CAHUBDY_KMfT2mmv9+s3y-rf_j=Wub05Hdab6J4RetKfpUbbeXQ@mail.gmail.com>
Message-ID: <7c9385e0-0290-4c42-9d9e-80b79af7948a@sapo.pt>

?s 16:30 de 12/11/2025, Brian Smith escreveu:
> Hi,
> 
> I have below code
> 
> ctl <- c(4.17,5.58,5.18,6.11,4.50,4.61,5.17,4.53,5.33,5.14)
> trt <- c(4.81,4.17,4.41,3.59,5.87,3.83,6.03,4.89,4.32,4.69)
> group <- gl(2, 10, 20, labels = c("Ctl","Trt"))
> group1 <- head(gl(2, 10, 22, labels = c("Ctl1","Trt1")), 20)
> weight <- c(ctl, trt)
> dat = as.data.frame(cbind(weight, group, group1))
> lm.D9 <- lm(weight ~ group * group1 - 1 - group1, dat)
> 
> I want to incorporate interaction between 2 variables group and
> group1, however do not want to incorporate level-0 for group1 not the
> intercept.
> 
> Therefore I used (-1 - group1) in the formula.
> 
> I would like to know if above is a valid syntax for the stated model.
> 
> Thanks and regards,
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide https://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
Hello,

Yes, that syntax is valid. But isn't

lm.D9b <- lm(weight ~ 0 + group + group:group1, dat)


more readable?

You can check that the two models are the same with


summary(lm.D9)
summary(lm.D9b)


This will tell where the objects returned by those two calls to lm() are 
different, giving further arguments to prefer model lm.D9b.


all.equal(lm.D9, lm.D9b, check.attributes = FALSE)


Hope this helps,

Rui Barradas


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Wed Nov 12 18:32:07 2025
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Wed, 12 Nov 2025 17:32:07 +0000
Subject: [R] Is this a valid syntax for lm()
In-Reply-To: <7c9385e0-0290-4c42-9d9e-80b79af7948a@sapo.pt>
References: <CAHUBDY_KMfT2mmv9+s3y-rf_j=Wub05Hdab6J4RetKfpUbbeXQ@mail.gmail.com>
 <7c9385e0-0290-4c42-9d9e-80b79af7948a@sapo.pt>
Message-ID: <8e0c69b4-95a1-42f5-b860-62f04b5fcd2a@sapo.pt>

?s 17:12 de 12/11/2025, Rui Barradas escreveu:
> ?s 16:30 de 12/11/2025, Brian Smith escreveu:
>> Hi,
>>
>> I have below code
>>
>> ctl <- c(4.17,5.58,5.18,6.11,4.50,4.61,5.17,4.53,5.33,5.14)
>> trt <- c(4.81,4.17,4.41,3.59,5.87,3.83,6.03,4.89,4.32,4.69)
>> group <- gl(2, 10, 20, labels = c("Ctl","Trt"))
>> group1 <- head(gl(2, 10, 22, labels = c("Ctl1","Trt1")), 20)
>> weight <- c(ctl, trt)
>> dat = as.data.frame(cbind(weight, group, group1))
>> lm.D9 <- lm(weight ~ group * group1 - 1 - group1, dat)
>>
>> I want to incorporate interaction between 2 variables group and
>> group1, however do not want to incorporate level-0 for group1 not the
>> intercept.
>>
>> Therefore I used (-1 - group1) in the formula.
>>
>> I would like to know if above is a valid syntax for the stated model.
>>
>> Thanks and regards,
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide https://www.R-project.org/posting- 
>> guide.html
>> and provide commented, minimal, self-contained, reproducible code.
> Hello,
> 
> Yes, that syntax is valid. But isn't
> 
> lm.D9b <- lm(weight ~ 0 + group + group:group1, dat)
> 
> 
> more readable?
> 
> You can check that the two models are the same with
> 
> 
> summary(lm.D9)
> summary(lm.D9b)
> 
> 
> This will tell where the objects returned by those two calls to lm() are 
> different, giving further arguments to prefer model lm.D9b.
> 
> 
> all.equal(lm.D9, lm.D9b, check.attributes = FALSE)
> 
> 
> Hope this helps,
> 
> Rui Barradas
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide https://www.R-project.org/posting- 
> guide.html
> and provide commented, minimal, self-contained, reproducible code.
Hello,

Sorry for my hasty post, there is another problem with your code.
The dat creation code is wrong:


dat = as.data.frame(cbind(weights, group, group1))


first creates a matrix with cbind then coerces the matrix to data.frame. 
The error is in creating a matrix. Matrices can only have one data class 
so all variables become numeric and the factors group and group1 are no 
longer factors.

This error will impact everything that follows.

The correct way is to use data.frame(weights, group, group1). See the 
code below. The models coefficients, s.e's, etc are different. And so 
are the predictions from the models.


ctl <- c(4.17,5.58,5.18,6.11,4.50,4.61,5.17,4.53,5.33,5.14)
trt <- c(4.81,4.17,4.41,3.59,5.87,3.83,6.03,4.89,4.32,4.69)
group <- gl(2, 10, 20, labels = c("Ctl","Trt"))
group1 <- head(gl(2, 10, 22, labels = c("Ctl1","Trt1")), 20)
weight <- c(ctl, trt)

wrong_dat <- as.data.frame(cbind(weight, group, group1))
right_dat <- data.frame(weight, group, group1)
str(wrong_dat)
#> 'data.frame':    20 obs. of  3 variables:
#>  $ weight: num  4.17 5.58 5.18 6.11 4.5 4.61 5.17 4.53 5.33 5.14 ...
#>  $ group : num  1 1 1 1 1 1 1 1 1 1 ...
#>  $ group1: num  1 1 1 1 1 1 1 1 1 1 ...
str(right_dat)
#> 'data.frame':    20 obs. of  3 variables:
#>  $ weight: num  4.17 5.58 5.18 6.11 4.5 4.61 5.17 4.53 5.33 5.14 ...
#>  $ group : Factor w/ 2 levels "Ctl","Trt": 1 1 1 1 1 1 1 1 1 1 ...
#>  $ group1: Factor w/ 2 levels "Ctl1","Trt1": 1 1 1 1 1 1 1 1 1 1 ...

wrong_lm.D9 <- lm(weight ~ group * group1 - 1 - group1, wrong_dat)
right_lm.D9 <- lm(weight ~ group * group1 - 1 - group1, right_dat)
summary(wrong_lm.D9)
#>
#> Call:
#> lm(formula = weight ~ group * group1 - 1 - group1, data = wrong_dat)
#>
#> Residuals:
#>     Min      1Q  Median      3Q     Max
#> -1.0710 -0.4938  0.0685  0.2462  1.3690
#>
#> Coefficients:
#>              Estimate Std. Error t value Pr(>|t|)
#> group          7.7335     0.4540   17.04 1.51e-12 ***
#> group:group1  -2.7015     0.2462  -10.97 2.10e-09 ***
#> ---
#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
#>
#> Residual standard error: 0.6964 on 18 degrees of freedom
#> Multiple R-squared:  0.9818, Adjusted R-squared:  0.9798
#> F-statistic: 485.1 on 2 and 18 DF,  p-value: < 2.2e-16
summary(right_lm.D9)
#>
#> Call:
#> lm(formula = weight ~ group * group1 - 1 - group1, data = right_dat)
#>
#> Residuals:
#>     Min      1Q  Median      3Q     Max
#> -1.0710 -0.4938  0.0685  0.2462  1.3690
#>
#> Coefficients: (2 not defined because of singularities)
#>                     Estimate Std. Error t value Pr(>|t|)
#> groupCtl              5.0320     0.2202   22.85 9.55e-15 ***
#> groupTrt              4.6610     0.2202   21.16 3.62e-14 ***
#> groupCtl:group1Trt1       NA         NA      NA       NA
#> groupTrt:group1Trt1       NA         NA      NA       NA
#> ---
#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
#>
#> Residual standard error: 0.6964 on 18 degrees of freedom
#> Multiple R-squared:  0.9818, Adjusted R-squared:  0.9798
#> F-statistic: 485.1 on 2 and 18 DF,  p-value: < 2.2e-16

# generate data for predict()
g <- gl(2, 1, labels = c("Ctl","Trt"))
g1 <- gl(2, 1, labels = c("Ctl1","Trt1"))
# wrong_new must be coerced to numeric
wrong_new <- expand.grid(group = g, group1 = g1)
wrong_new[] <- lapply(wrong_new, as.numeric)
# keep right_new as factors
right_new <- expand.grid(group = g, group1 = g1)

predict(wrong_lm.D9, newdata = wrong_new)
#>       1       2       3       4
#>  5.0320 10.0640  2.3305  4.6610
predict(right_lm.D9, newdata = right_new)
#> Warning in predict.lm(right_lm.D9, newdata = right_new): prediction from
#> rank-deficient fit; attr(*, "non-estim") has doubtful cases
#>     1     2     3     4
#> 5.032 4.661 5.032 4.661
#> attr(,"non-estim")
#> 2 3
#> 2 3



Hope this helps,

Rui Barradas


From n@re@h_gurbux@n| @end|ng |rom hotm@||@com  Wed Nov 12 19:28:13 2025
From: n@re@h_gurbux@n| @end|ng |rom hotm@||@com (Naresh Gurbuxani)
Date: Wed, 12 Nov 2025 18:28:13 +0000
Subject: [R] Jump between figures in multifigure environment
Message-ID: <97DCDE5D-555C-4D6E-BF3A-63F325222F7A@hotmail.com>

After drawing multiple figures, I want to select an earlier figure to add some low level commands.  Using mfg parameter runs all commands in the most recent figure only.  How can an earlier figure be selected?

Thanks,
Naresh

par(mfrow = c(2, 2))
for (i in 1:4) plot(c(0, 1), c(0, 1), type = "n?)
for (i in 1:2) {for (j in 1:2) text(0.5, 0.5, labels = paste("(", i, ",", j, ")"), mfg = c(i, j, 2, 2))}
#All text is in bottom right figure only

From p@u| @end|ng |rom @t@t@@uck|@nd@@c@nz  Wed Nov 12 21:04:43 2025
From: p@u| @end|ng |rom @t@t@@uck|@nd@@c@nz (Paul Murrell)
Date: Thu, 13 Nov 2025 09:04:43 +1300
Subject: [R] Jump between figures in multifigure environment
In-Reply-To: <97DCDE5D-555C-4D6E-BF3A-63F325222F7A@hotmail.com>
References: <97DCDE5D-555C-4D6E-BF3A-63F325222F7A@hotmail.com>
Message-ID: <4b7ab1a4-e5e6-4ee6-9273-f3fc8078de1c@stat.auckland.ac.nz>

Hi

Base graphics is designed for drawing everything in a figure before 
moving on to the next figure.  Also, 'mfg' can only be set via par().
Are you looking for something like this ... ?


par(mfrow = c(2, 2))
for (i in 1:2) {
     for (j in 1:2) {
         par(mfg = c(i, j))
         plot(c(0, 1), c(0, 1), type = "n")
         text(0.5, 0.5, labels = paste("(", i, ",", j, ")"))
     }
}


If you really want to revisit previous figures, you might try 
split.screen(), but it is pretty fragile and, as the example below 
shows, still not designed for revisiting a previous *plot* (just a 
previous figure region) ...


split.screen(c(2, 2))
for (i in 1:4) {
     screen(i)
     plot(c(0, 1), c(0, 1), type = "n")
}
for (i in 1:2) {
     for (j in 1:2) {
         screen(2*(i - 1) + j)
         text(0.5, 0.5, labels = paste("(", i, ",", j, ")"))
     }
}


If you REALLY want to revisit previous drawing, you might need to look 
at {grid} viewports, which are designed to allow you to get back to the 
original drawing context ...


library(grid)
grid.newpage()
pushViewport(viewport(layout=grid.layout(2, 2)))
for (i in 1:2) {
     for (j in 1:2) {
         pushViewport(viewport(layout.pos.row=i, layout.pos.col=j,
                               name=paste0(i, j)))
         grid.rect(width=.8, height=.8)
         upViewport()
     }
}
for (i in 1:2) {
     for (j in 1:2) {
         downViewport(paste0(i, j))
         grid.text(paste("(", i, ",", j, ")"))
         upViewport()
     }
}


Paul


On 13/11/25 07:28, Naresh Gurbuxani wrote:
> After drawing multiple figures, I want to select an earlier figure to add some low level commands.  Using mfg parameter runs all commands in the most recent figure only.  How can an earlier figure be selected?
> 
> Thanks,
> Naresh
> 
> par(mfrow = c(2, 2))
> for (i in 1:4) plot(c(0, 1), c(0, 1), type = "n?)
> for (i in 1:2) {for (j in 1:2) text(0.5, 0.5, labels = paste("(", i, ",", j, ")"), mfg = c(i, j, 2, 2))}
> #All text is in bottom right figure only
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide https://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.

-- 
Dr Paul Murrell (he/him)
Te Kura Tatauranga | Department of Statistics
Waipapa Taumata Rau | The University of Auckland
Private Bag 92019, Auckland 1142, New Zealand
64 9 3737599 x85392
paul at stat.auckland.ac.nz
www.stat.auckland.ac.nz/~paul/


From pb @end|ng |rom |n|o||nk@com@br  Wed Nov 12 21:06:26 2025
From: pb @end|ng |rom |n|o||nk@com@br (Paulo Barata)
Date: Wed, 12 Nov 2025 17:06:26 -0300
Subject: [R] package stats / prop.trend.test function
In-Reply-To: <AD936800-0821-4536-8BDA-8D4F416C430C@gmail.com>
References: <7068cdda-ef75-4f69-a2c1-48427149aefb@infolink.com.br>
 <7ab3b054-22e8-48f8-8ff5-b21c4cd59f9d@dewey.myzen.co.uk>
 <AD936800-0821-4536-8BDA-8D4F416C430C@gmail.com>
Message-ID: <6b3df5e0-3838-4d41-8de2-47288b736042@infolink.com.br>

Professor Dalgaard,

Thank you for your reply. My question: shouldn't every statistical function in R, every statistical procedure, have some reference in the respective Help file?

Basic functions like sqrt, log, sort, sample, these are part of the base system in R, they generally have a clear purpose, a clear calculation to perform, and they are supposed to work well, no matter the exact details of their mathematical methods.

But higher level statistical functions, like prop.trend.test, or glm, they each perform some calculations according to a given method, but the method could possibly be somewhat different from the one implemented, with possible variations in the results.

Shouldn't the methods of statistical functions be always documented in the Help files, with references? Why there is just no information about the method of prop.trend.test?

Thank you once again for your attention.

Paulo Barata

Rio de Janeiro - Brazil

-------------------------------------------------------

On 12-Nov-25 9:49, Peter Dalgaard wrote:
> There's a worked example of the procedure in Altman: Practical Statistics for Medical Research, also featured in help(ISwR::caesarean).
> 
> (I have forgotten the origin of example(prop.trend.test), though. If I ever knew it. Apparently it is the same as in help(prop.test): Fleiss(1981), p.139, but I don't have that edition to hand and I don't see it in Fleiss(1973).)
> 
> -pd
> 
> 
>> On 12 Nov 2025, at 11.55, Michael Dewey <lists at dewey.myzen.co.uk> wrote:
>>
>> Dear Paulo
>>
>> You did realise that if you type prop.trend.test you get
>>
>> function (x, n, score = seq_along(x))
>> {
>>     method <- "Chi-squared Test for Trend in Proportions"
>>     dname <- paste(deparse1(substitute(x)), "out of", deparse1(substitute(n)),
>>         ",\n using scores:", paste(score, collapse = " "))
>>     x <- as.vector(x)
>>     n <- as.vector(n)
>>     p <- sum(x)/sum(n)
>>     w <- n/p/(1 - p)
>>     a <- anova(lm(freq ~ score, data = list(freq = x/n, score = as.vector(score)),
>>         weights = w))
>>     chisq <- c(`X-squared` = a["score", "Sum Sq"])
>>     structure(list(statistic = chisq, parameter = c(df = 1),
>>         p.value = pchisq(as.numeric(chisq), 1, lower.tail = FALSE),
>>         method = method, data.name = dname), class = "htest")
>> }
>> <bytecode: 0x0000021d81d4c850>
>> <environment: namespace:stats>
>>
>> Does that help?
>>
>> Michael
>>
>> On 11/11/2025 18:27, Paulo Barata wrote:
>>> To the R-Help list,
>>> About the prop.trend.test function, in the package stats.
>>> What calculations exactly does that function perform? What test is actually carried out? May I have some reference for the calculations performed by that function?
>>> I would like to suggest that some references (one or more) be included in the Help file for the function.
>>> Thank you very much.
>>> Paulo Barata
>>> Rio de Janeiro - Brazil
>>> ______________________________________________
>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>> PLEASE do read the posting guide https://www.R-project.org/posting- guide.html
>>> and provide commented, minimal, self-contained, reproducible code.
>>
>> -- 
>> Michael Dewey
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide https://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>


From n@re@h_gurbux@n| @end|ng |rom hotm@||@com  Wed Nov 12 22:25:57 2025
From: n@re@h_gurbux@n| @end|ng |rom hotm@||@com (Naresh Gurbuxani)
Date: Wed, 12 Nov 2025 21:25:57 +0000
Subject: [R] Jump between figures in multifigure environment
In-Reply-To: <4b7ab1a4-e5e6-4ee6-9273-f3fc8078de1c@stat.auckland.ac.nz>
References: <4b7ab1a4-e5e6-4ee6-9273-f3fc8078de1c@stat.auckland.ac.nz>
Message-ID: <DM3PPF9A5B544E08B4784B208A7FDB35808FACCA@DM3PPF9A5B544E0.NAMP223.PROD.OUTLOOK.COM>

Paul,

First solution works for me.  To change something in an earlier figure, I can start over and redraw all figures.  

In practice, how is mfg used?

Thanks,
Naresh

Sent from my iPhone

> On Nov 12, 2025, at 3:04?PM, Paul Murrell <paul at stat.auckland.ac.nz> wrote:
> 
> ?Hi
> 
> Base graphics is designed for drawing everything in a figure before moving on to the next figure.  Also, 'mfg' can only be set via par().
> Are you looking for something like this ... ?
> 
> 
> par(mfrow = c(2, 2))
> for (i in 1:2) {
>    for (j in 1:2) {
>        par(mfg = c(i, j))
>        plot(c(0, 1), c(0, 1), type = "n")
>        text(0.5, 0.5, labels = paste("(", i, ",", j, ")"))
>    }
> }
> 
> 
> If you really want to revisit previous figures, you might try split.screen(), but it is pretty fragile and, as the example below shows, still not designed for revisiting a previous *plot* (just a previous figure region) ...
> 
> 
> split.screen(c(2, 2))
> for (i in 1:4) {
>    screen(i)
>    plot(c(0, 1), c(0, 1), type = "n")
> }
> for (i in 1:2) {
>    for (j in 1:2) {
>        screen(2*(i - 1) + j)
>        text(0.5, 0.5, labels = paste("(", i, ",", j, ")"))
>    }
> }
> 
> 
> If you REALLY want to revisit previous drawing, you might need to look at {grid} viewports, which are designed to allow you to get back to the original drawing context ...
> 
> 
> library(grid)
> grid.newpage()
> pushViewport(viewport(layout=grid.layout(2, 2)))
> for (i in 1:2) {
>    for (j in 1:2) {
>        pushViewport(viewport(layout.pos.row=i, layout.pos.col=j,
>                              name=paste0(i, j)))
>        grid.rect(width=.8, height=.8)
>        upViewport()
>    }
> }
> for (i in 1:2) {
>    for (j in 1:2) {
>        downViewport(paste0(i, j))
>        grid.text(paste("(", i, ",", j, ")"))
>        upViewport()
>    }
> }
> 
> 
> Paul
> 
> 
>> On 13/11/25 07:28, Naresh Gurbuxani wrote:
>> After drawing multiple figures, I want to select an earlier figure to add some low level commands.  Using mfg parameter runs all commands in the most recent figure only.  How can an earlier figure be selected?
>> Thanks,
>> Naresh
>> par(mfrow = c(2, 2))
>> for (i in 1:4) plot(c(0, 1), c(0, 1), type = "n?)
>> for (i in 1:2) {for (j in 1:2) text(0.5, 0.5, labels = paste("(", i, ",", j, ")"), mfg = c(i, j, 2, 2))}
>> #All text is in bottom right figure only
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide https://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
> 
> --
> Dr Paul Murrell (he/him)
> Te Kura Tatauranga | Department of Statistics
> Waipapa Taumata Rau | The University of Auckland
> Private Bag 92019, Auckland 1142, New Zealand
> 64 9 3737599 x85392
> paul at stat.auckland.ac.nz
> www.stat.auckland.ac.nz/~paul/
> 

From p@u| @end|ng |rom @t@t@@uck|@nd@@c@nz  Wed Nov 12 22:29:30 2025
From: p@u| @end|ng |rom @t@t@@uck|@nd@@c@nz (Paul Murrell)
Date: Thu, 13 Nov 2025 10:29:30 +1300
Subject: [R] Jump between figures in multifigure environment
In-Reply-To: <DM3PPF9A5B544E08B4784B208A7FDB35808FACCA@DM3PPF9A5B544E0.NAMP223.PROD.OUTLOOK.COM>
References: <4b7ab1a4-e5e6-4ee6-9273-f3fc8078de1c@stat.auckland.ac.nz>
 <DM3PPF9A5B544E08B4784B208A7FDB35808FACCA@DM3PPF9A5B544E0.NAMP223.PROD.OUTLOOK.COM>
Message-ID: <8577d3b2-e641-4fe4-ac59-42fd64717753@stat.auckland.ac.nz>


In practice, I have never used 'mfg', but one thing it allows you to do 
is to use the figures defined by par(mfrow/mfcol) in whatever order you 
like (rather than just by row or by column).

Paul

On 13/11/25 10:25, Naresh Gurbuxani wrote:
> Paul,
> 
> First solution works for me.  To change something in an earlier figure, I can start over and redraw all figures.
> 
> In practice, how is mfg used?
> 
> Thanks,
> Naresh
> 
> Sent from my iPhone
> 
>> On Nov 12, 2025, at 3:04?PM, Paul Murrell <paul at stat.auckland.ac.nz> wrote:
>>
>> ?Hi
>>
>> Base graphics is designed for drawing everything in a figure before moving on to the next figure.  Also, 'mfg' can only be set via par().
>> Are you looking for something like this ... ?
>>
>>
>> par(mfrow = c(2, 2))
>> for (i in 1:2) {
>>     for (j in 1:2) {
>>         par(mfg = c(i, j))
>>         plot(c(0, 1), c(0, 1), type = "n")
>>         text(0.5, 0.5, labels = paste("(", i, ",", j, ")"))
>>     }
>> }
>>
>>
>> If you really want to revisit previous figures, you might try split.screen(), but it is pretty fragile and, as the example below shows, still not designed for revisiting a previous *plot* (just a previous figure region) ...
>>
>>
>> split.screen(c(2, 2))
>> for (i in 1:4) {
>>     screen(i)
>>     plot(c(0, 1), c(0, 1), type = "n")
>> }
>> for (i in 1:2) {
>>     for (j in 1:2) {
>>         screen(2*(i - 1) + j)
>>         text(0.5, 0.5, labels = paste("(", i, ",", j, ")"))
>>     }
>> }
>>
>>
>> If you REALLY want to revisit previous drawing, you might need to look at {grid} viewports, which are designed to allow you to get back to the original drawing context ...
>>
>>
>> library(grid)
>> grid.newpage()
>> pushViewport(viewport(layout=grid.layout(2, 2)))
>> for (i in 1:2) {
>>     for (j in 1:2) {
>>         pushViewport(viewport(layout.pos.row=i, layout.pos.col=j,
>>                               name=paste0(i, j)))
>>         grid.rect(width=.8, height=.8)
>>         upViewport()
>>     }
>> }
>> for (i in 1:2) {
>>     for (j in 1:2) {
>>         downViewport(paste0(i, j))
>>         grid.text(paste("(", i, ",", j, ")"))
>>         upViewport()
>>     }
>> }
>>
>>
>> Paul
>>
>>
>>> On 13/11/25 07:28, Naresh Gurbuxani wrote:
>>> After drawing multiple figures, I want to select an earlier figure to add some low level commands.  Using mfg parameter runs all commands in the most recent figure only.  How can an earlier figure be selected?
>>> Thanks,
>>> Naresh
>>> par(mfrow = c(2, 2))
>>> for (i in 1:4) plot(c(0, 1), c(0, 1), type = "n?)
>>> for (i in 1:2) {for (j in 1:2) text(0.5, 0.5, labels = paste("(", i, ",", j, ")"), mfg = c(i, j, 2, 2))}
>>> #All text is in bottom right figure only
>>> ______________________________________________
>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>> PLEASE do read the posting guide https://www.R-project.org/posting-guide.html
>>> and provide commented, minimal, self-contained, reproducible code.
>>
>> --
>> Dr Paul Murrell (he/him)
>> Te Kura Tatauranga | Department of Statistics
>> Waipapa Taumata Rau | The University of Auckland
>> Private Bag 92019, Auckland 1142, New Zealand
>> 64 9 3737599 x85392
>> paul at stat.auckland.ac.nz
>> www.stat.auckland.ac.nz/~paul/
>>

-- 
Dr Paul Murrell (he/him)
Te Kura Tatauranga | Department of Statistics
Waipapa Taumata Rau | The University of Auckland
Private Bag 92019, Auckland 1142, New Zealand
64 9 3737599 x85392
paul at stat.auckland.ac.nz
www.stat.auckland.ac.nz/~paul/


