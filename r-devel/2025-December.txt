From kev|nu@hey @end|ng |rom gm@||@com  Mon Dec  1 21:23:51 2025
From: kev|nu@hey @end|ng |rom gm@||@com (Kevin Ushey)
Date: Mon, 1 Dec 2025 12:23:51 -0800
Subject: [Rd] Feature suggestion: %!in%
In-Reply-To: <4e8e0040-430e-4503-9a8a-26a9698a6bac@gmail.com>
References: <CAGcsfB3dn88L3U8TmDEkwNfJkphnFtJ8CRK-TJhZ5yOFU7=uMQ@mail.gmail.com>
 <58bec605-9000-4f9e-9eb4-86950c4eb9e5@gmail.com>
 <CAGcsfB0s0U+zYYHW6eWx5kKzH_XdmVKm=8LsJDWxfn8Pe-Ga0Q@mail.gmail.com>
 <15fa876c-c0f3-4177-9045-ee6408fbcd16@gmail.com>
 <9226DB4F-E4DE-477C-835F-0580A8C0024A@R-project.org>
 <4e8e0040-430e-4503-9a8a-26a9698a6bac@gmail.com>
Message-ID: <CAJXgQP3rSaU4JN02pM8XrVELJC7A85DKW8sLFf8P6Fh6RGHGSA@mail.gmail.com>

Another useful data point: a large number of CRAN packages also define
their own %nin% / %notin% operators, e.g.

https://github.com/search?q=org%3Acran+%25nin%25&type=code
https://github.com/search?q=org%3Acran+%25notin%25&type=code

I think the broad usage of the operator, and the consensus over its
implementation, makes it a strong candidate for inclusion in R itself.

I imagine a similar justification was used when %||% was added to base
R as well (which I was very glad to see!)

Best,
Kevin

On Fri, Nov 28, 2025 at 3:12?AM Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
>
> On 2025-11-27 6:09 p.m., Simon Urbanek wrote:
> > Given that the args of tools:::%notin% don?t match %in% I'd say it was just a local use more than any deep thought about general use.
> >
> > Personally, I really like the idea of %notin% because it is very often that you start typing foo[foo %in% and then realise you want to invert it and the preceding negation is then cognitively sort of in the wrong place (reads like "not foo"). I also like %notin% better than %!in% because I think a salad of special characters makes things harder to read, but that may be just subjective.
>
> I agree with both points.  I generally use inefficient and unnecessary
> parens, i.e. `foo[!(foo %in% baz)]`.
>
> > And to your 'why bother' question - I do think it?s better to standardise common operators in core rather than have packages re-define it each time. And certainly just importing something that trivial from another package is a bad idea given the dependency implications.
>
> If someone is willing to put up with the fallout from the "masked"
> messages, then I'd also be in favour.  (And I'd choose %notin% rather
> than %!in% or %nin%, but whoever is willing to do the work should make
> that choice.)
>
>  > (On the flip side: if you start using it you need to depend on recent
> R which may not be feasible in some environments, but then if that was
> always the argument we?d never add anything new :P).
>
> Or depend on the backports package.
>
> Duncan Murdoch
> >
> > Cheers,
> > Simon
> >
> >
> >> On 28 Nov 2025, at 08:24, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
> >>
> >> On 2025-11-27 11:58 a.m., Marcelo Ventura Freire wrote:
> >>> If it is not a rhetorical question about a closed issue (if it is, tell me and I will shut up), this inclusion [1] would be useful (since it was exported and rewritten so many times by so many people and will keep being), [2] would create an uniformization (since it was and will be written under so many names before), [3] would not break stuff (since it is not altering the interface of any already existing function nor it is overwriting any symbol with a diverse use), [4] would not be neither a complex nor a tiringsome inclusion (even I myself could do it in a single 1-line pull request, hypothetically speaking) and [5] would benefit users all around.
> >>> I am not naive to the point of believing that an alteration to the R core would have few repercussions and surely there must be reasons why it was not done before.
> >>
> >> I don't know why it was added to tools but not exported, but here is my guess:
> >>
> >> - A member of R Core agrees with you that this operator is useful. This appears to have happened in 2016 based on the svn log.
> >> - It already existed in some contributed package, but base packages can't import anything from non-base packages, so it needed to be added.
> >> - It wasn't exported, because that would break some packages:
> >>     - the ones that export something with that name would now receive a check message about the conflict.
> >>     - if those packages stopped exporting it, then any package that imported from one of them would have to stop doing that, and import it from the base package instead.
> >> - It is very easy to write your own, or to import one of the existing ones, so a lot of work would have been generated for not very much benefit.
> >>
> >> R Core members try to be careful not to generate work for others unless there's enough of a net benefit to the community.  They are very busy, and many authors of contributed packages who might be affected by this change are busy too.
> >>
> >>
> >>> But, in the end, this inclusion would be just a seemingly unharmful syntax sugar that could be shared, like it was with "\" for the reserved word "function", but with waaaay less work to implement.
> >>
> >> The difference there is that it added new syntax, so as far as I know, it didn't affect any existing package.  Personally I don't see that it really offered much of a benefit (keystrokes are cheap), but lots of people are using it, so I guess some others would disagree.>
> >>> If it is not a dumb proposal, I can just include it in the wishlist of features in Bugzilla as prescribed in the contributor's page or I can do that PR myself (if you propose more work to others, the sensible thing to do is at least to offer yourself to do it, right?). In either case, I create more work to the dev team, perhaps to different people.
> >>
> >> It's hard for you to do the coordination work with all the existing packages that use a similar operator, so I don't think that's really feasible.
> >>
> >>> Thanks for taking your time to answer me.
> >>
> >> No problem.  I'm sitting in an airport waiting for a plane, so any distraction is a net benefit for me!
> >>
> >> Duncan Murdoch>
> >>> Marcelo Ventura Freire
> >>> Escola de Artes, Ci?ncias e Humanidades
> >>> Universidade de S?o Paulo
> >>> Av. Arlindo Bettio, 1000,
> >>> Sala Paulo Freire (Sala Coletiva 252), Pr?dio I1
> >>> Ermelino Matarazzo, S?o Paulo, SP, Brasil
> >>> CEP 03828-000
> >>> Tel.: (11) 3091-8894
> >>> Em qui., 27 de nov. de 2025 ?s 14:15, Duncan Murdoch <murdoch.duncan at gmail.com <mailto:murdoch.duncan at gmail.com>> escreveu:
> >>>     The R sources already contain an operator like that, though it is not
> >>>     exported.  tools:::`%notin%` is defined as
> >>>        function (x, y)
> >>>     is.na <http://is.na>(match(x, y))
> >>>     Several CRAN packages export a similar function, e.g. omnibus, mefa4,
> >>>     data.table, hutils, etc. So I think if it was exported by R that's a
> >>>     better name, but since it is easy to write yourself or import from some
> >>>     other package, why bother?
> >>>     Duncan Murdoch
> >>>     On 2025-11-27 9:19 a.m., Marcelo Ventura Freire via R-devel wrote:
> >>>      > Hello, dear R core developers
> >>>      >
> >>>      >
> >>>      > I have a feature suggestion and, following the orientations in
> >>>      > https://contributor.r-project.org/rdevguide/chapters/
> >>>     submitting_feature_requests.html <https://contributor.r-project.org/
> >>>     rdevguide/chapters/submitting_feature_requests.html>,
> >>>      > I have searched in Bugzilla to the best of my capabilities for
> >>>     suggestions
> >>>      > like the one I have in mind but found no results (however, I can
> >>>     be wrong).
> >>>      >
> >>>      > My idea is including this line
> >>>      >
> >>>      > `%!in%`  <- function(x, table) match(x, table, nomatch = 0L) == 0L
> >>>      >
> >>>      > between lines 39 and 40 of the file "src/library/base/R/match.R".
> >>>      >
> >>>      > My objective is to create a "not in" operator that would allow us
> >>>     to write
> >>>      > code like
> >>>      >>     value %!in% valuelist
> >>>      > instead of
> >>>      >>     ! value %in% valuelist
> >>>      > which is in line with writing
> >>>      >>     value1 != value2
> >>>      > instead of
> >>>      >>     ! value1 == value2
> >>>      >
> >>>      > I was not able to devise any reasonable way that such inclusion
> >>>     would break
> >>>      > any already existing heritage code unless that operator would be
> >>>     defined
> >>>      > otherwisely and it would improve (however marginally) the
> >>>     readability of
> >>>      > future code by its intuitive interpretation and by stitching
> >>>     together two
> >>>      > operators that currently stand apart each other.
> >>>      >
> >>>      > So, if this suggestion was not already proposed and if it is seen as
> >>>      > useful, I would like to include it in the wishlist in Bugzilla.
> >>>      >
> >>>      > I would appreciate any feedback, be it critic or support, and I
> >>>     hope I have
> >>>      > not crossed any communicational rule from the group.
> >>>      >
> >>>      > Many thanks!  ?
> >>>      >
> >>>      >
> >>>      >
> >>>      > Marcelo Ventura Freire
> >>>      > Escola de Artes, Ci?ncias e Humanidades
> >>>      > Universidade de S?o Paulo
> >>>      > Av. Arlindo Bettio, 1000,
> >>>      > Sala Paulo Freire (Sala Coletiva 252), Pr?dio I1
> >>>      > Ermelino Matarazzo, S?o Paulo, SP, Brasil
> >>>      > CEP 03828-000
> >>>      > Tel.: (11) 3091-8894
> >>>      >
> >>>      >       [[alternative HTML version deleted]]
> >>>      >
> >>>      > ______________________________________________
> >>>      > R-devel at r-project.org <mailto:R-devel at r-project.org> mailing list
> >>>      > https://stat.ethz.ch/mailman/listinfo/r-devel <https://
> >>>     stat.ethz.ch/mailman/listinfo/r-devel>
> >>>
> >>
> >> ______________________________________________
> >> R-devel at r-project.org mailing list
> >> https://stat.ethz.ch/mailman/listinfo/r-devel
> >>
> >
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From t@r@@@z@kh@rko @end|ng |rom uzh@ch  Tue Dec  2 11:13:11 2025
From: t@r@@@z@kh@rko @end|ng |rom uzh@ch (Taras Zakharko)
Date: Tue, 2 Dec 2025 10:13:11 +0000
Subject: [Rd] Feature suggestion: %!in%
In-Reply-To: <CAJXgQP3rSaU4JN02pM8XrVELJC7A85DKW8sLFf8P6Fh6RGHGSA@mail.gmail.com>
References: <CAGcsfB3dn88L3U8TmDEkwNfJkphnFtJ8CRK-TJhZ5yOFU7=uMQ@mail.gmail.com>
 <58bec605-9000-4f9e-9eb4-86950c4eb9e5@gmail.com>
 <CAGcsfB0s0U+zYYHW6eWx5kKzH_XdmVKm=8LsJDWxfn8Pe-Ga0Q@mail.gmail.com>
 <15fa876c-c0f3-4177-9045-ee6408fbcd16@gmail.com>
 <9226DB4F-E4DE-477C-835F-0580A8C0024A@R-project.org>
 <4e8e0040-430e-4503-9a8a-26a9698a6bac@gmail.com>
 <CAJXgQP3rSaU4JN02pM8XrVELJC7A85DKW8sLFf8P6Fh6RGHGSA@mail.gmail.com>
Message-ID: <EA47A69E-3B69-4F9E-B7F3-A721F1098D86@uzh.ch>

I wonder what would be the formal relationship between %in% and %notin%, which will be relevant if these operators are made generic in the future.  Is `%notin%` defined as a boolean negation of `%in%`, is it the other way around, or are they entirely independent definitions that just happen to have complementary semantics? 

I would be in favor of defining %notin% as a sugar for !x %in% y 

Best, 

Taras


> On 1 Dec 2025, at 21:23, Kevin Ushey <kevinushey at gmail.com> wrote:
> 
> Another useful data point: a large number of CRAN packages also define
> their own %nin% / %notin% operators, e.g.
> 
> https://github.com/search?q=org%3Acran+%25nin%25&type=code
> https://github.com/search?q=org%3Acran+%25notin%25&type=code
> 
> I think the broad usage of the operator, and the consensus over its
> implementation, makes it a strong candidate for inclusion in R itself.
> 
> I imagine a similar justification was used when %||% was added to base
> R as well (which I was very glad to see!)
> 
> Best,
> Kevin
> 
> On Fri, Nov 28, 2025 at 3:12?AM Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
>> 
>> On 2025-11-27 6:09 p.m., Simon Urbanek wrote:
>>> Given that the args of tools:::%notin% don?t match %in% I'd say it was just a local use more than any deep thought about general use.
>>> 
>>> Personally, I really like the idea of %notin% because it is very often that you start typing foo[foo %in% and then realise you want to invert it and the preceding negation is then cognitively sort of in the wrong place (reads like "not foo"). I also like %notin% better than %!in% because I think a salad of special characters makes things harder to read, but that may be just subjective.
>> 
>> I agree with both points.  I generally use inefficient and unnecessary
>> parens, i.e. `foo[!(foo %in% baz)]`.
>> 
>>> And to your 'why bother' question - I do think it?s better to standardise common operators in core rather than have packages re-define it each time. And certainly just importing something that trivial from another package is a bad idea given the dependency implications.
>> 
>> If someone is willing to put up with the fallout from the "masked"
>> messages, then I'd also be in favour.  (And I'd choose %notin% rather
>> than %!in% or %nin%, but whoever is willing to do the work should make
>> that choice.)
>> 
>>> (On the flip side: if you start using it you need to depend on recent
>> R which may not be feasible in some environments, but then if that was
>> always the argument we?d never add anything new :P).
>> 
>> Or depend on the backports package.
>> 
>> Duncan Murdoch
>>> 
>>> Cheers,
>>> Simon
>>> 
>>> 
>>>> On 28 Nov 2025, at 08:24, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
>>>> 
>>>> On 2025-11-27 11:58 a.m., Marcelo Ventura Freire wrote:
>>>>> If it is not a rhetorical question about a closed issue (if it is, tell me and I will shut up), this inclusion [1] would be useful (since it was exported and rewritten so many times by so many people and will keep being), [2] would create an uniformization (since it was and will be written under so many names before), [3] would not break stuff (since it is not altering the interface of any already existing function nor it is overwriting any symbol with a diverse use), [4] would not be neither a complex nor a tiringsome inclusion (even I myself could do it in a single 1-line pull request, hypothetically speaking) and [5] would benefit users all around.
>>>>> I am not naive to the point of believing that an alteration to the R core would have few repercussions and surely there must be reasons why it was not done before.
>>>> 
>>>> I don't know why it was added to tools but not exported, but here is my guess:
>>>> 
>>>> - A member of R Core agrees with you that this operator is useful. This appears to have happened in 2016 based on the svn log.
>>>> - It already existed in some contributed package, but base packages can't import anything from non-base packages, so it needed to be added.
>>>> - It wasn't exported, because that would break some packages:
>>>>    - the ones that export something with that name would now receive a check message about the conflict.
>>>>    - if those packages stopped exporting it, then any package that imported from one of them would have to stop doing that, and import it from the base package instead.
>>>> - It is very easy to write your own, or to import one of the existing ones, so a lot of work would have been generated for not very much benefit.
>>>> 
>>>> R Core members try to be careful not to generate work for others unless there's enough of a net benefit to the community.  They are very busy, and many authors of contributed packages who might be affected by this change are busy too.
>>>> 
>>>> 
>>>>> But, in the end, this inclusion would be just a seemingly unharmful syntax sugar that could be shared, like it was with "\" for the reserved word "function", but with waaaay less work to implement.
>>>> 
>>>> The difference there is that it added new syntax, so as far as I know, it didn't affect any existing package.  Personally I don't see that it really offered much of a benefit (keystrokes are cheap), but lots of people are using it, so I guess some others would disagree.>
>>>>> If it is not a dumb proposal, I can just include it in the wishlist of features in Bugzilla as prescribed in the contributor's page or I can do that PR myself (if you propose more work to others, the sensible thing to do is at least to offer yourself to do it, right?). In either case, I create more work to the dev team, perhaps to different people.
>>>> 
>>>> It's hard for you to do the coordination work with all the existing packages that use a similar operator, so I don't think that's really feasible.
>>>> 
>>>>> Thanks for taking your time to answer me.
>>>> 
>>>> No problem.  I'm sitting in an airport waiting for a plane, so any distraction is a net benefit for me!
>>>> 
>>>> Duncan Murdoch>
>>>>> Marcelo Ventura Freire
>>>>> Escola de Artes, Ci?ncias e Humanidades
>>>>> Universidade de S?o Paulo
>>>>> Av. Arlindo Bettio, 1000,
>>>>> Sala Paulo Freire (Sala Coletiva 252), Pr?dio I1
>>>>> Ermelino Matarazzo, S?o Paulo, SP, Brasil
>>>>> CEP 03828-000
>>>>> Tel.: (11) 3091-8894
>>>>> Em qui., 27 de nov. de 2025 ?s 14:15, Duncan Murdoch <murdoch.duncan at gmail.com <mailto:murdoch.duncan at gmail.com>> escreveu:
>>>>>    The R sources already contain an operator like that, though it is not
>>>>>    exported.  tools:::`%notin%` is defined as
>>>>>       function (x, y)
>>>>>    is.na <http://is.na>(match(x, y))
>>>>>    Several CRAN packages export a similar function, e.g. omnibus, mefa4,
>>>>>    data.table, hutils, etc. So I think if it was exported by R that's a
>>>>>    better name, but since it is easy to write yourself or import from some
>>>>>    other package, why bother?
>>>>>    Duncan Murdoch
>>>>>    On 2025-11-27 9:19 a.m., Marcelo Ventura Freire via R-devel wrote:
>>>>>> Hello, dear R core developers
>>>>>> 
>>>>>> 
>>>>>> I have a feature suggestion and, following the orientations in
>>>>>> https://contributor.r-project.org/rdevguide/chapters/
>>>>>    submitting_feature_requests.html <https://contributor.r-project.org/
>>>>>    rdevguide/chapters/submitting_feature_requests.html>,
>>>>>> I have searched in Bugzilla to the best of my capabilities for
>>>>>    suggestions
>>>>>> like the one I have in mind but found no results (however, I can
>>>>>    be wrong).
>>>>>> 
>>>>>> My idea is including this line
>>>>>> 
>>>>>> `%!in%`  <- function(x, table) match(x, table, nomatch = 0L) == 0L
>>>>>> 
>>>>>> between lines 39 and 40 of the file "src/library/base/R/match.R".
>>>>>> 
>>>>>> My objective is to create a "not in" operator that would allow us
>>>>>    to write
>>>>>> code like
>>>>>>>    value %!in% valuelist
>>>>>> instead of
>>>>>>>    ! value %in% valuelist
>>>>>> which is in line with writing
>>>>>>>    value1 != value2
>>>>>> instead of
>>>>>>>    ! value1 == value2
>>>>>> 
>>>>>> I was not able to devise any reasonable way that such inclusion
>>>>>    would break
>>>>>> any already existing heritage code unless that operator would be
>>>>>    defined
>>>>>> otherwisely and it would improve (however marginally) the
>>>>>    readability of
>>>>>> future code by its intuitive interpretation and by stitching
>>>>>    together two
>>>>>> operators that currently stand apart each other.
>>>>>> 
>>>>>> So, if this suggestion was not already proposed and if it is seen as
>>>>>> useful, I would like to include it in the wishlist in Bugzilla.
>>>>>> 
>>>>>> I would appreciate any feedback, be it critic or support, and I
>>>>>    hope I have
>>>>>> not crossed any communicational rule from the group.
>>>>>> 
>>>>>> Many thanks!  ?
>>>>>> 
>>>>>> 
>>>>>> 
>>>>>> Marcelo Ventura Freire
>>>>>> Escola de Artes, Ci?ncias e Humanidades
>>>>>> Universidade de S?o Paulo
>>>>>> Av. Arlindo Bettio, 1000,
>>>>>> Sala Paulo Freire (Sala Coletiva 252), Pr?dio I1
>>>>>> Ermelino Matarazzo, S?o Paulo, SP, Brasil
>>>>>> CEP 03828-000
>>>>>> Tel.: (11) 3091-8894
>>>>>> 
>>>>>>      [[alternative HTML version deleted]]
>>>>>> 
>>>>>> ______________________________________________
>>>>>> R-devel at r-project.org <mailto:R-devel at r-project.org> mailing list
>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel <https://
>>>>>    stat.ethz.ch/mailman/listinfo/r-devel>
>>>>> 
>>>> 
>>>> ______________________________________________
>>>> R-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>> 
>>> 
>> 
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From therne@u @end|ng |rom m@yo@edu  Tue Dec  2 13:41:47 2025
From: therne@u @end|ng |rom m@yo@edu (Therneau, Terry M., Ph.D.)
Date: Tue, 02 Dec 2025 12:41:47 +0000
Subject: [Rd] Speed question: passing arguments vs environment
Message-ID: <SJ0PR01MB815585DAF0A7777E538A2472AED8A@SJ0PR01MB8155.prod.exchangelabs.com>

I have a complex likelihood function f() to maximize, with lots of arguments (some of which set up indexes for derivatives, for instance).
When using something like optim(), one can pass these arguments through via its ? arg, or could make the likelihood function f() live in the same environment as the main routine so they are found directly.    Is there any advantage of one versus the other wrt speed?    At the end of the day, f() may get called thousands of times in a Hamiltonian MCMC.

Since R does not replicate arguments that are used in a read-only fashion, one might expect little to no penalty for having them on the call chain, unless the bookkeeping for copy-on-write is itself time consuming.

Terry T.


	[[alternative HTML version deleted]]


From er|cjberger @end|ng |rom gm@||@com  Tue Dec  2 13:48:14 2025
From: er|cjberger @end|ng |rom gm@||@com (Eric Berger)
Date: Tue, 2 Dec 2025 14:48:14 +0200
Subject: [Rd] Speed question: passing arguments vs environment
In-Reply-To: <SJ0PR01MB815585DAF0A7777E538A2472AED8A@SJ0PR01MB8155.prod.exchangelabs.com>
References: <SJ0PR01MB815585DAF0A7777E538A2472AED8A@SJ0PR01MB8155.prod.exchangelabs.com>
Message-ID: <CAGgJW75jf3maLVyUBtShrOCBMM9jmzvhDuWtmx7BWrMaHKtdWQ@mail.gmail.com>

While not directly answering your question, what about collecting all these
arguments into an env object? Then you are just passing one argument in the
... and it is passed by reference, which is fast.


On Tue, Dec 2, 2025 at 2:42?PM Therneau, Terry M., Ph.D. via R-devel <
r-devel at r-project.org> wrote:

> I have a complex likelihood function f() to maximize, with lots of
> arguments (some of which set up indexes for derivatives, for instance).
> When using something like optim(), one can pass these arguments through
> via its ? arg, or could make the likelihood function f() live in the same
> environment as the main routine so they are found directly.    Is there any
> advantage of one versus the other wrt speed?    At the end of the day, f()
> may get called thousands of times in a Hamiltonian MCMC.
>
> Since R does not replicate arguments that are used in a read-only fashion,
> one might expect little to no penalty for having them on the call chain,
> unless the bookkeeping for copy-on-write is itself time consuming.
>
> Terry T.
>
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

	[[alternative HTML version deleted]]


From murdoch@dunc@n @end|ng |rom gm@||@com  Tue Dec  2 14:41:03 2025
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Tue, 2 Dec 2025 08:41:03 -0500
Subject: [Rd] Speed question: passing arguments vs environment
In-Reply-To: <SJ0PR01MB815585DAF0A7777E538A2472AED8A@SJ0PR01MB8155.prod.exchangelabs.com>
References: <SJ0PR01MB815585DAF0A7777E538A2472AED8A@SJ0PR01MB8155.prod.exchangelabs.com>
Message-ID: <c0b7468f-7d78-428a-92ca-abd0a69ffbb6@gmail.com>

On 2025-12-02 7:41 a.m., Therneau, Terry M., Ph.D. via R-devel wrote:
> I have a complex likelihood function f() to maximize, with lots of arguments (some of which set up indexes for derivatives, for instance).
> When using something like optim(), one can pass these arguments through via its ? arg, or could make the likelihood function f() live in the same environment as the main routine so they are found directly.    Is there any advantage of one versus the other wrt speed?    At the end of the day, f() may get called thousands of times in a Hamiltonian MCMC.
> 
> Since R does not replicate arguments that are used in a read-only fashion, one might expect little to no penalty for having them on the call chain, unless the bookkeeping for copy-on-write is itself time consuming.
> 

I think there wouldn't be a big difference in timing, but I'd guess 
there'd be a slight advantage to having them in the environment of the 
objective function.  I'd recommend testing both ways if you want to be sure.

Here are the differences that might matter:

  - putting them as arguments has the overhead of constructing the 
argument list each time, and if the args are used, the overhead of 
resolving promises.

  - putting them in the environment of the function means lookups will 
take two steps:  the evaluation frame followed by its parent, instead of 
succeeding in the first lookup.

I suspect the overhead of arguments is bigger, but it's probably not 
very big.

Duncan Murdoch


From murdoch@dunc@n @end|ng |rom gm@||@com  Tue Dec  2 14:48:20 2025
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Tue, 2 Dec 2025 08:48:20 -0500
Subject: [Rd] Speed question: passing arguments vs environment
In-Reply-To: <SJ0PR01MB815585DAF0A7777E538A2472AED8A@SJ0PR01MB8155.prod.exchangelabs.com>
References: <SJ0PR01MB815585DAF0A7777E538A2472AED8A@SJ0PR01MB8155.prod.exchangelabs.com>
Message-ID: <93653436-0305-42c6-a544-b5dac62d7157@gmail.com>

On 2025-12-02 7:41 a.m., Therneau, Terry M., Ph.D. via R-devel wrote:
> I have a complex likelihood function f() to maximize, with lots of arguments (some of which set up indexes for derivatives, for instance).
> When using something like optim(), one can pass these arguments through via its ? arg, or could make the likelihood function f() live in the same environment as the main routine so they are found directly.    Is there any advantage of one versus the other wrt speed?    At the end of the day, f() may get called thousands of times in a Hamiltonian MCMC.
> 
> Since R does not replicate arguments that are used in a read-only fashion, one might expect little to no penalty for having them on the call chain, unless the bookkeeping for copy-on-write is itself time consuming.

By the way, a nice way to put the args in the environment of the 
objective function is to use local() or a builder, e.g.

objective <- local({
   arg1 <- 1
   arg2 <- 2
   arg3 <- 3
   function(x) {
   # objective code here that can see arg1, arg2, arg3
   }
})

or

makeObjective <- function(arg1, arg2, arg3) {
   force(arg1) # evaluate the promises
   force(arg2)
   force(arg3)

   function(x) {
     # objective code here that can see arg1, arg2, arg3
   }
}

objective <- makeObjective(1,2,3)

Duncan Murdoch


From pro|jcn@@h @end|ng |rom gm@||@com  Tue Dec  2 15:26:57 2025
From: pro|jcn@@h @end|ng |rom gm@||@com (J C Nash)
Date: Tue, 2 Dec 2025 09:26:57 -0500
Subject: [Rd] Speed question: passing arguments vs environment
In-Reply-To: <93653436-0305-42c6-a544-b5dac62d7157@gmail.com>
References: <SJ0PR01MB815585DAF0A7777E538A2472AED8A@SJ0PR01MB8155.prod.exchangelabs.com>
 <93653436-0305-42c6-a544-b5dac62d7157@gmail.com>
Message-ID: <e7b90a8f-b141-4da3-9a12-1a5fa4bf24c5@gmail.com>

Duncan's suggestion to time things is important -- and would make a very useful short communication or blog!
There are frequently differences of orders of magnitude in timing.

I'll also suggest that it is worth some crude timings of different solvers. There is sufficient variation
over problems that this won't decide definitively which solver is fastest, but you might eliminate one or
two that are poor for your situation. Depending on numbers of parameters, I'd guess ncg or its predecessor
Rcgmin will be relatively good. LBFGS variants can be good, but sometimes seem to toss up disasters. Most
of these can be accessed with optimx package to save coding. By removing some checks and safeguards in
optimx you could likely speed up things a bit too.

If full optimum is not needed, some attention to early stopping might be worthwhile, but I've seen lots
of silly mistakes made playing with tolerances, and if you go that route, choose a custom termination
rule that fits your particular problem or you'll get rubbish.

JN

On 2025-12-02 08:48, Duncan Murdoch wrote:
> On 2025-12-02 7:41 a.m., Therneau, Terry M., Ph.D. via R-devel wrote:
>> I have a complex likelihood function f() to maximize, with lots of arguments (some of which set up indexes for 
>> derivatives, for instance).
>> When using something like optim(), one can pass these arguments through via its ? arg, or could make the likelihood 
>> function f() live in the same environment as the main routine so they are found directly.??? Is there any advantage of 
>> one versus the other wrt speed???? At the end of the day, f() may get called thousands of times in a Hamiltonian MCMC.
>>
>> Since R does not replicate arguments that are used in a read-only fashion, one might expect little to no penalty for 
>> having them on the call chain, unless the bookkeeping for copy-on-write is itself time consuming.
> 
> By the way, a nice way to put the args in the environment of the objective function is to use local() or a builder, e.g.
> 
> objective <- local({
>  ? arg1 <- 1
>  ? arg2 <- 2
>  ? arg3 <- 3
>  ? function(x) {
>  ? # objective code here that can see arg1, arg2, arg3
>  ? }
> })
> 
> or
> 
> makeObjective <- function(arg1, arg2, arg3) {
>  ? force(arg1) # evaluate the promises
>  ? force(arg2)
>  ? force(arg3)
> 
>  ? function(x) {
>  ??? # objective code here that can see arg1, arg2, arg3
>  ? }
> }
> 
> objective <- makeObjective(1,2,3)
> 
> Duncan Murdoch
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From therne@u @end|ng |rom m@yo@edu  Tue Dec  2 16:15:30 2025
From: therne@u @end|ng |rom m@yo@edu (Therneau, Terry M., Ph.D.)
Date: Tue, 02 Dec 2025 09:15:30 -0600
Subject: [Rd] [EXTERNAL] Re: Speed question: passing arguments vs
 environment
In-Reply-To: <e7b90a8f-b141-4da3-9a12-1a5fa4bf24c5@gmail.com>
References: <SJ0PR01MB815585DAF0A7777E538A2472AED8A@SJ0PR01MB8155.prod.exchangelabs.com>
 <93653436-0305-42c6-a544-b5dac62d7157@gmail.com>
 <e7b90a8f-b141-4da3-9a12-1a5fa4bf24c5@gmail.com>
Message-ID: <e202ec0c-a371-4c2c-a8ad-c58f14763412@mayo.edu>

John,
 ? I purposefully narrowed my question to a single issue.? But since you brought it up, 
and FYI:? the optimal optimizer is indeed one of the most important aspects of the problem.
Your insight is right on target.

The underlying problem is multi-state hazard models for interval censored data, driven by 
real data in dementia research.?? The msm package deals with such problems, but uses optim 
behind the scenes and for our large and more complex problems, optim either takes forever 
(never finds the solution) or nearly forever too much of the time.?? Behind the scenes, 
the likelihood for each subject involves a product of? matrix exponentials, which are 
slow, so at the very bottom of the call chain are functions that evaluate the likelihood 
and first deriv for one subject (multiple rows of data over their observation time 
window),? invoked via mclapply.?? The first derivative is feasable? but not the second 
deriv.? Parallel computation across subjects was a big win wrt compute time.

 ? The two maximizers which seem to work well are Fisher scoring (use sum_i U_iU'_i to 
approximate the Hessian, where U_i = first derivative contribution of subject i) + 
Levenberg Marquart + trust region + constraints, or a full MCMC approach 
(doi.org/10.1080/01621459.2019.1594831).??? We may eventually update the MCMC to use 
Hamiltonian methods, but that is still far on the horizon.

In any case, this statisitical approach seems to be a winner, and we intend to apply it 
multiple times over the next several years.?? Which means that I need to take code that 
works but has the appearance of a Rube Goldberg invention, and which only I can use, and 
make available to others both inside and outside our group.?? The question involved one 
practical issue as I tackle this.

Terry


On 12/2/25 08:26, J C Nash wrote:
> Duncan's suggestion to time things is important -- and would make a very useful short 
> communication or blog!
> There are frequently differences of orders of magnitude in timing.
>
> I'll also suggest that it is worth some crude timings of different solvers. There is 
> sufficient variation
> over problems that this won't decide definitively which solver is fastest, but you might 
> eliminate one or
> two that are poor for your situation. Depending on numbers of parameters, I'd guess ncg 
> or its predecessor
> Rcgmin will be relatively good. LBFGS variants can be good, but sometimes seem to toss 
> up disasters. Most
> of these can be accessed with optimx package to save coding. By removing some checks and 
> safeguards in
> optimx you could likely speed up things a bit too.
>
> If full optimum is not needed, some attention to early stopping might be worthwhile, but 
> I've seen lots
> of silly mistakes made playing with tolerances, and if you go that route, choose a 
> custom termination
> rule that fits your particular problem or you'll get rubbish.
>
> JN

	[[alternative HTML version deleted]]


From @oko| @end|ng |rom |n@@-tou|ou@e@|r  Tue Dec  2 16:58:38 2025
From: @oko| @end|ng |rom |n@@-tou|ou@e@|r (Serguei Sokol)
Date: Tue, 2 Dec 2025 16:58:38 +0100
Subject: [Rd] Speed question: passing arguments vs environment
In-Reply-To: <SJ0PR01MB815585DAF0A7777E538A2472AED8A@SJ0PR01MB8155.prod.exchangelabs.com>
References: <SJ0PR01MB815585DAF0A7777E538A2472AED8A@SJ0PR01MB8155.prod.exchangelabs.com>
Message-ID: <694b335a-d77d-49a3-a407-403642f722c1@insa-toulouse.fr>

Do you have some publicly available code snippets where you compare 
different approaches?
It can be not exactly your problem but somewhat representative.

Best,
Serguei.

Le 02/12/2025 ? 13:41, Therneau, Terry M., Ph.D. via R-devel a ?crit?:
> I have a complex likelihood function f() to maximize, with lots of arguments (some of which set up indexes for derivatives, for instance).
> When using something like optim(), one can pass these arguments through via its ? arg, or could make the likelihood function f() live in the same environment as the main routine so they are found directly.    Is there any advantage of one versus the other wrt speed?    At the end of the day, f() may get called thousands of times in a Hamiltonian MCMC.
>
> Since R does not replicate arguments that are used in a read-only fashion, one might expect little to no penalty for having them on the call chain, unless the bookkeeping for copy-on-write is itself time consuming.
>
> Terry T.
>
>
> 	[[alternative HTML version deleted]]
>
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From jeroenoom@ @end|ng |rom gm@||@com  Tue Dec  2 22:33:05 2025
From: jeroenoom@ @end|ng |rom gm@||@com (Jeroen Ooms)
Date: Tue, 2 Dec 2025 22:33:05 +0100
Subject: [Rd] Remove http parameters from filename in download.packages()
Message-ID: <CABFfbXsT9H7eAmuSpiaQ4hoYUof2mhVBbBwMHhbPmY7NzWsN=Q@mail.gmail.com>

Currently `download.packages()` copies the full `File` field from the
URL in PACKAGES, including http parameters, as the local filename on
disk. So for example, if the `PACKAGES` file contains

   Package: jsonlite
   Version: 2.0.0
   File: jsonlite_2.0.0.tar.gz?auth=blabla123&hash=79fad1b6092c1d1cc71e096d02cbc7618837fda1f90b61443f09adc25caab095

Then the file is saved on disk not as  `jsonlite_2.0.0.tar.gz` but as
the full url including `?` and `=` and `&` characters which are not
supported and create corrupt files on some platforms.

To reproduce this I created a testing repo:

    available.packages(repos = 'https://jeroen.github.io/testrepo/')
    download.packages('jsonlite', '.', repos =
'https://jeroen.github.io/testrepo/')

The patch below makes the download behavior of R correspond to
browsers, which is to remove the http-query part from `destfile` when
downloading the package to disk.

  https://github.com/r-devel/r-svn/pull/215.diff

Thank you for considering.


From m@ech|er @end|ng |rom @t@t@m@th@ethz@ch  Wed Dec  3 11:55:06 2025
From: m@ech|er @end|ng |rom @t@t@m@th@ethz@ch (Martin Maechler)
Date: Wed, 3 Dec 2025 11:55:06 +0100
Subject: [Rd] 
 Remove http parameters from filename in download.packages()
In-Reply-To: <fake-VM-id.8268cb50716b62fc485165fd5a5fcf73@talos.iv>
References: <CABFfbXsT9H7eAmuSpiaQ4hoYUof2mhVBbBwMHhbPmY7NzWsN=Q@mail.gmail.com>
Message-ID: <26928.5898.208733.544206@stat.math.ethz.ch>

>>>>> Jeroen Ooms 
>>>>>     on Tue, 2 Dec 2025 22:33:05 +0100 writes:

    > Currently `download.packages()` copies the full `File`
    > field from the URL in PACKAGES, including http parameters,
    > as the local filename on disk. So for example, if the
    > `PACKAGES` file contains

    >    Package: jsonlite Version: 2.0.0 File:
    > jsonlite_2.0.0.tar.gz?auth=blabla123&hash=79fad1b6092c1d1cc71e096d02cbc7618837fda1f90b61443f09adc25caab095

    > Then the file is saved on disk not as
    > `jsonlite_2.0.0.tar.gz` but as the full url including `?`
    > and `=` and `&` characters which are not supported and
    > create corrupt files on some platforms.

Yes... but why should a "CRAN-like repository" use such file names ?

The help(download.packages)   *title*  is

   Download Packages from CRAN-like Repositories
   =============================================



    > To reproduce this I created a testing repo:

    >     available.packages(repos =
    > 'https://jeroen.github.io/testrepo/')
    > download.packages('jsonlite', '.', repos =
    > 'https://jeroen.github.io/testrepo/')

    > The patch below makes the download behavior of R
    > correspond to browsers, which is to remove the http-query
    > part from `destfile` when downloading the package to disk.

    >   https://github.com/r-devel/r-svn/pull/215.diff

    > Thank you for considering.

I am considering, but still not convinced why it is needed (see above).
Maybe I'm overlooking something ?
Also, I'd have it as a switch (argument) of download.packages() in
order to provide back compatibility [no need for a new patch, though !]

Martin


From jeroenoom@ @end|ng |rom gm@||@com  Wed Dec  3 12:34:21 2025
From: jeroenoom@ @end|ng |rom gm@||@com (Jeroen Ooms)
Date: Wed, 3 Dec 2025 12:34:21 +0100
Subject: [Rd] 
 Remove http parameters from filename in download.packages()
In-Reply-To: <26928.5898.208733.544206@stat.math.ethz.ch>
References: <CABFfbXsT9H7eAmuSpiaQ4hoYUof2mhVBbBwMHhbPmY7NzWsN=Q@mail.gmail.com>
 <fake-VM-id.8268cb50716b62fc485165fd5a5fcf73@talos.iv>
 <26928.5898.208733.544206@stat.math.ethz.ch>
Message-ID: <CABFfbXuxPcDuuXVkSs+9jsCNuoOmsgdKL5LkOPf06BnE=fiAtQ@mail.gmail.com>

On Wed, Dec 3, 2025 at 11:55?AM Martin Maechler
<maechler at stat.math.ethz.ch> wrote:
>
> >>>>> Jeroen Ooms
> >>>>>     on Tue, 2 Dec 2025 22:33:05 +0100 writes:
>
>     > Currently `download.packages()` copies the full `File`
>     > field from the URL in PACKAGES, including http parameters,
>     > as the local filename on disk. So for example, if the
>     > `PACKAGES` file contains
>
>     >    Package: jsonlite Version: 2.0.0 File:
>     > jsonlite_2.0.0.tar.gz?auth=blabla123&hash=79fad1b6092c1d1cc71e096d02cbc7618837fda1f90b61443f09adc25caab095
>
>     > Then the file is saved on disk not as
>     > `jsonlite_2.0.0.tar.gz` but as the full url including `?`
>     > and `=` and `&` characters which are not supported and
>     > create corrupt files on some platforms.
>
> Yes... but why should a "CRAN-like repository" use such file names ?

Such that we can host a "CRAN-like repository" on modern
infrastructure that may use this sort of URLs.

> I am considering, but still not convinced why it is needed (see above).
> Maybe I'm overlooking something ?
> Also, I'd have it as a switch (argument) of download.packages() in
> order to provide back compatibility [no need for a new patch, though !]

The patch should not break functionality; it only fixes an edge case
where R would otherwise write to an illegal filename on disk. I am
guessing nobody has used this yet so I am not sure what would be the
value of back compatibility to ensure R keeps doing this.

In either case the fix would only be useful if install.packages()
makes use of it.


From iuke-tier@ey m@iii@g oii uiow@@edu  Thu Dec  4 02:47:08 2025
From: iuke-tier@ey m@iii@g oii uiow@@edu (iuke-tier@ey m@iii@g oii uiow@@edu)
Date: Wed, 3 Dec 2025 19:47:08 -0600 (CST)
Subject: [Rd] non-API SETLENGTH and friends will be dropped soon
Message-ID: <d3ad2a6c-09e7-8ebd-105a-2938e6003cd4@uiowa.edu>

As part of clarifying and tightening the R API for packages the
non-API entry points SETLENGTH, TRUELENGTH, SET_TRUELENGTH, and
SET_GROWABLE_BIT will be removed from installed header files and,
where possible, hidden from package access. The first step will be to
turn current check NOTEs into WARNINGs; this will hopefully happen in
the next few weeks. Hopefully the process can be completed by early
January.

17 CRAN/BIOC packages currently make use of one or more of these entry
points. Most using SETLENGTH should transition to using xgetlength(),
which allocates a new vector, usually with a shorter length. There is
a small amount of overhead, and care is needed to protect the new
result, but this is a much safer option. R-devel does now include an
experimental API for creating resizable vectors, but it needs a great
deal of care to use safely. These options are described in a new
section "Resizing vectors" in the Writing R Extensions manual.

[If you are a maintainer of one of the 17 affected packages you should
receive a separate copy of this note.]

Best,

luke
~

-- 
Luke Tierney
Ralph E. Wareham Professor of Mathematical Sciences
University of Iowa                  Phone:             319-335-3386
Department of Statistics and        Fax:               319-335-3017
    Actuarial Science
241 Schaeffer Hall                  email:   luke-tierney at uiowa.edu
Iowa City, IA 52242                 WWW:  http://www.stat.uiowa.edu


From ||u|@@rev|||@ @end|ng |rom gm@||@com  Thu Dec  4 10:22:40 2025
From: ||u|@@rev|||@ @end|ng |rom gm@||@com (=?UTF-8?Q?Llu=C3=ADs_Revilla?=)
Date: Thu, 4 Dec 2025 10:22:40 +0100
Subject: [Rd] 
 Remove http parameters from filename in download.packages()
In-Reply-To: <CABFfbXuxPcDuuXVkSs+9jsCNuoOmsgdKL5LkOPf06BnE=fiAtQ@mail.gmail.com>
References: <CABFfbXsT9H7eAmuSpiaQ4hoYUof2mhVBbBwMHhbPmY7NzWsN=Q@mail.gmail.com>
 <fake-VM-id.8268cb50716b62fc485165fd5a5fcf73@talos.iv>
 <26928.5898.208733.544206@stat.math.ethz.ch>
 <CABFfbXuxPcDuuXVkSs+9jsCNuoOmsgdKL5LkOPf06BnE=fiAtQ@mail.gmail.com>
Message-ID: <CAN+W6_u+7LrrNq_chA_2v5NLzi2268kQHQr97eNqxw_EGEdJgw@mail.gmail.com>

Hi Jeroen and Martin (and other readers),

I like this suggestion Jeroen, but I am not sure of the implications
of enabling this beyond getting a valid file name locally on the
computer.
The File field is documented on tools::write_PACKAGES as "the
filenames be included ... in the ?PACKAGES? file." (which might need a
slight modification if this patch is implemented).

What would parameters do on CRAN-like repositories? How would they
alter the behaviour of the request of the package downloaded?
The only idea I could think of is to control which/how packages are
installed (as the name, version and file extension is still fixed on
this patch).
There are different methods used by CRAN-like repositories to control that:

- CRAN handles parameters at the web server level not on the PACKAGES file:
   You can get a specific package version with
https://CRAN.R-project.org/package=PKG&version=VER but doesn't install
dependencies as it is understood as a single package.
- https://bioconductor.org recommends using BiocManager to point to
the right CRAN-like repository.
- The CRAN-like repositories from https://r-universe.dev don't
redirect but use sha256 as File (as you are well aware).
- https://rpkgs.com redirects to appropriate binaries based on the
headers, installing a package and its dependencies for the right R
version and OS.
- https://r-multiverse.org/ has two repositories but doesn't redirect,
or use headers to control packages served.

CRAN's redirects work for a single package but the headers approach
works smoother for more than one at the cost of user/R admin
preparations.
I am not sure if some of these repositories (or new ones) could
benefit from this feature.
But I don't see a back compatibility problem as this couldn't be used
by repositories since it wasn't available.

Best wishes,


El dc., 3 de des. 2025, 12:34, Jeroen Ooms <jeroenooms at gmail.com> va escriure:

>
> On Wed, Dec 3, 2025 at 11:55?AM Martin Maechler
> <maechler at stat.math.ethz.ch> wrote:
> >
> > >>>>> Jeroen Ooms
> > >>>>>     on Tue, 2 Dec 2025 22:33:05 +0100 writes:
> >
> >     > Currently `download.packages()` copies the full `File`
> >     > field from the URL in PACKAGES, including http parameters,
> >     > as the local filename on disk. So for example, if the
> >     > `PACKAGES` file contains
> >
> >     >    Package: jsonlite Version: 2.0.0 File:
> >     > jsonlite_2.0.0.tar.gz?auth=blabla123&hash=79fad1b6092c1d1cc71e096d02cbc7618837fda1f90b61443f09adc25caab095
> >
> >     > Then the file is saved on disk not as
> >     > `jsonlite_2.0.0.tar.gz` but as the full url including `?`
> >     > and `=` and `&` characters which are not supported and
> >     > create corrupt files on some platforms.
> >
> > Yes... but why should a "CRAN-like repository" use such file names ?
>
> Such that we can host a "CRAN-like repository" on modern
> infrastructure that may use this sort of URLs.
>
> > I am considering, but still not convinced why it is needed (see above).
> > Maybe I'm overlooking something ?
> > Also, I'd have it as a switch (argument) of download.packages() in
> > order to provide back compatibility [no need for a new patch, though !]
>
> The patch should not break functionality; it only fixes an edge case
> where R would otherwise write to an illegal filename on disk. I am
> guessing nobody has used this yet so I am not sure what would be the
> value of back compatibility to ensure R keeps doing this.
>
> In either case the fix would only be useful if install.packages()
> makes use of it.
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From c|yde @end|ng |rom duke@edu  Thu Dec  4 16:40:11 2025
From: c|yde @end|ng |rom duke@edu (Merlise Clyde, Ph.D.)
Date: Thu, 4 Dec 2025 15:40:11 +0000
Subject: [Rd] non-API SETLENGTH and friends will be dropped soon
In-Reply-To: <d3ad2a6c-09e7-8ebd-105a-2938e6003cd4@uiowa.edu>
References: <d3ad2a6c-09e7-8ebd-105a-2938e6003cd4@uiowa.edu>
Message-ID: <CY8PR05MB1003417AC5E6405FCB5AAA1EBC8A6A@CY8PR05MB10034.namprd05.prod.outlook.com>

Dear Luke,

I have implemented changes knowing this was around the corner to address this and hopefully can finalize unit tests/comparisons in the next week (I also want to take a look at the new resizable option to see how that compares to what I did), but it looks like CRAN will be down for submissions from Dec 23 through Jan 7.   Hoping the grace period takes into account this down time in case early submissions fail on some of the CRAN machines despite all efforts to test ahead of time.

Best,
Merlise

From: luke-tierney at uiowa.edu <luke-tierney at uiowa.edu>
Date: Wednesday, December 3, 2025 at 8:47?PM
To: R-devel at r-project.org <R-devel at r-project.org>
Subject: non-API SETLENGTH and friends will be dropped soon

As part of clarifying and tightening the R API for packages the
non-API entry points SETLENGTH, TRUELENGTH, SET_TRUELENGTH, and
SET_GROWABLE_BIT will be removed from installed header files and,
where possible, hidden from package access. The first step will be to
turn current check NOTEs into WARNINGs; this will hopefully happen in
the next few weeks. Hopefully the process can be completed by early
January.

17 CRAN/BIOC packages currently make use of one or more of these entry
points. Most using SETLENGTH should transition to using xgetlength(),
which allocates a new vector, usually with a shorter length. There is
a small amount of overhead, and care is needed to protect the new
result, but this is a much safer option. R-devel does now include an
experimental API for creating resizable vectors, but it needs a great
deal of care to use safely. These options are described in a new
section "Resizing vectors" in the Writing R Extensions manual.

[If you are a maintainer of one of the 17 affected packages you should
receive a separate copy of this note.]

Best,

luke
~

--
Luke Tierney
Ralph E. Wareham Professor of Mathematical Sciences
University of Iowa                  Phone:             319-335-3386
Department of Statistics and        Fax:               319-335-3017
    Actuarial Science
241 Schaeffer Hall                  email:   luke-tierney at uiowa.edu
Iowa City, IA 52242                 WWW:  http://www.stat.uiowa.edu/<http://www.stat.uiowa.edu/>

	[[alternative HTML version deleted]]


From j@g@nmn2 @end|ng |rom gm@||@com  Fri Dec  5 07:30:56 2025
From: j@g@nmn2 @end|ng |rom gm@||@com (Mikael Jagan)
Date: Fri, 5 Dec 2025 01:30:56 -0500
Subject: [Rd] Feature suggestion: %!in%
In-Reply-To: <mailman.55112.5.1764673202.37075.r-devel@r-project.org>
References: <mailman.55112.5.1764673202.37075.r-devel@r-project.org>
Message-ID: <72753f82-83bc-4506-9600-209cde33ec49@gmail.com>

> Date: Tue, 2 Dec 2025 10:13:11 +0000
> From: Taras Zakharko<taras.zakharko at uzh.ch>
> 
> I wonder what would be the formal relationship between %in% and %notin%, which will be relevant if these operators are made generic in the future.  Is `%notin%` defined as a boolean negation of `%in%`, is it the other way around, or are they entirely independent definitions that just happen to have complementary semantics?
> 
> I would be in favor of defining %notin% as a sugar for !x %in% y
> 

'match' and transitively '%in%' are already generic-like, because 'match'
converts classed arguments using generic function 'mtfrm', for which anyone
can write methods if the default one does not suffice.  For that reason
(among others), I would not hold my breath for a generic base::`%in%`.

Or maybe you refer to generic functions named '%in%' defined in contributed
packages, masking base::`%in%`?  But then, due to namespacing, methods for
those generic functions would not be dispatched by base::`%notin%` defined
as you propose.

I might as well mention that since svn rev 89099 we have

     > dput(base::`%notin%`)
     function (x, table)
     match(x, table, nomatch = 0L) == 0L

Mikael

> Best,
> 
> Taras
> 
> 
>> On 1 Dec 2025, at 21:23, Kevin Ushey<kevinushey at gmail.com> wrote:
>>
>> Another useful data point: a large number of CRAN packages also define
>> their own %nin% / %notin% operators, e.g.
>>
>> https://github.com/search?q=org%3Acran+%25nin%25&type=code
>> https://github.com/search?q=org%3Acran+%25notin%25&type=code
>>
>> I think the broad usage of the operator, and the consensus over its
>> implementation, makes it a strong candidate for inclusion in R itself.
>>
>> I imagine a similar justification was used when %||% was added to base
>> R as well (which I was very glad to see!)
>>
>> Best,
>> Kevin
>>
>> On Fri, Nov 28, 2025 at 3:12?AM Duncan Murdoch<murdoch.duncan at gmail.com> wrote:
>>> On 2025-11-27 6:09 p.m., Simon Urbanek wrote:
>>>> Given that the args of tools:::%notin% don?t match %in% I'd say it was just a local use more than any deep thought about general use.
>>>>
>>>> Personally, I really like the idea of %notin% because it is very often that you start typing foo[foo %in% and then realise you want to invert it and the preceding negation is then cognitively sort of in the wrong place (reads like "not foo"). I also like %notin% better than %!in% because I think a salad of special characters makes things harder to read, but that may be just subjective.
>>> I agree with both points.  I generally use inefficient and unnecessary
>>> parens, i.e. `foo[!(foo %in% baz)]`.
>>>
>>>> And to your 'why bother' question - I do think it?s better to standardise common operators in core rather than have packages re-define it each time. And certainly just importing something that trivial from another package is a bad idea given the dependency implications.
>>> If someone is willing to put up with the fallout from the "masked"
>>> messages, then I'd also be in favour.  (And I'd choose %notin% rather
>>> than %!in% or %nin%, but whoever is willing to do the work should make
>>> that choice.)
>>>
>>>> (On the flip side: if you start using it you need to depend on recent
>>> R which may not be feasible in some environments, but then if that was
>>> always the argument we?d never add anything new :P).
>>>
>>> Or depend on the backports package.
>>>
>>> Duncan Murdoch
>>>> Cheers,
>>>> Simon
>>>>
>>>>
>>>>> On 28 Nov 2025, at 08:24, Duncan Murdoch<murdoch.duncan at gmail.com> wrote:
>>>>>
>>>>> On 2025-11-27 11:58 a.m., Marcelo Ventura Freire wrote:
>>>>>> If it is not a rhetorical question about a closed issue (if it is, tell me and I will shut up), this inclusion [1] would be useful (since it was exported and rewritten so many times by so many people and will keep being), [2] would create an uniformization (since it was and will be written under so many names before), [3] would not break stuff (since it is not altering the interface of any already existing function nor it is overwriting any symbol with a diverse use), [4] would not be neither a complex nor a tiringsome inclusion (even I myself could do it in a single 1-line pull request, hypothetically speaking) and [5] would benefit users all around.
>>>>>> I am not naive to the point of believing that an alteration to the R core would have few repercussions and surely there must be reasons why it was not done before.
>>>>> I don't know why it was added to tools but not exported, but here is my guess:
>>>>>
>>>>> - A member of R Core agrees with you that this operator is useful. This appears to have happened in 2016 based on the svn log.
>>>>> - It already existed in some contributed package, but base packages can't import anything from non-base packages, so it needed to be added.
>>>>> - It wasn't exported, because that would break some packages:
>>>>>     - the ones that export something with that name would now receive a check message about the conflict.
>>>>>     - if those packages stopped exporting it, then any package that imported from one of them would have to stop doing that, and import it from the base package instead.
>>>>> - It is very easy to write your own, or to import one of the existing ones, so a lot of work would have been generated for not very much benefit.
>>>>>
>>>>> R Core members try to be careful not to generate work for others unless there's enough of a net benefit to the community.  They are very busy, and many authors of contributed packages who might be affected by this change are busy too.
>>>>>
>>>>>
>>>>>> But, in the end, this inclusion would be just a seemingly unharmful syntax sugar that could be shared, like it was with "\" for the reserved word "function", but with waaaay less work to implement.
>>>>> The difference there is that it added new syntax, so as far as I know, it didn't affect any existing package.  Personally I don't see that it really offered much of a benefit (keystrokes are cheap), but lots of people are using it, so I guess some others would disagree.>
>>>>>> If it is not a dumb proposal, I can just include it in the wishlist of features in Bugzilla as prescribed in the contributor's page or I can do that PR myself (if you propose more work to others, the sensible thing to do is at least to offer yourself to do it, right?). In either case, I create more work to the dev team, perhaps to different people.
>>>>> It's hard for you to do the coordination work with all the existing packages that use a similar operator, so I don't think that's really feasible.
>>>>>
>>>>>> Thanks for taking your time to answer me.
>>>>> No problem.  I'm sitting in an airport waiting for a plane, so any distraction is a net benefit for me!
>>>>>
>>>>> Duncan Murdoch>
>>>>>> Marcelo Ventura Freire
>>>>>> Escola de Artes, Ci?ncias e Humanidades
>>>>>> Universidade de S?o Paulo
>>>>>> Av. Arlindo Bettio, 1000,
>>>>>> Sala Paulo Freire (Sala Coletiva 252), Pr?dio I1
>>>>>> Ermelino Matarazzo, S?o Paulo, SP, Brasil
>>>>>> CEP 03828-000
>>>>>> Tel.: (11) 3091-8894
>>>>>> Em qui., 27 de nov. de 2025 ?s 14:15, Duncan Murdoch <murdoch.duncan at gmail.com <mailto:murdoch.duncan at gmail.com>> escreveu:
>>>>>>     The R sources already contain an operator like that, though it is not
>>>>>>     exported.  tools:::`%notin%` is defined as
>>>>>>        function (x, y)
>>>>>>     is.na<http://is.na>(match(x, y))
>>>>>>     Several CRAN packages export a similar function, e.g. omnibus, mefa4,
>>>>>>     data.table, hutils, etc. So I think if it was exported by R that's a
>>>>>>     better name, but since it is easy to write yourself or import from some
>>>>>>     other package, why bother?
>>>>>>     Duncan Murdoch
>>>>>>     On 2025-11-27 9:19 a.m., Marcelo Ventura Freire via R-devel wrote:
>>>>>>> Hello, dear R core developers
>>>>>>>
>>>>>>>
>>>>>>> I have a feature suggestion and, following the orientations in
>>>>>>> https://contributor.r-project.org/rdevguide/chapters/
>>>>>>     submitting_feature_requests.html <https://contributor.r-project.org/
>>>>>>     rdevguide/chapters/submitting_feature_requests.html>,
>>>>>>> I have searched in Bugzilla to the best of my capabilities for
>>>>>>     suggestions
>>>>>>> like the one I have in mind but found no results (however, I can
>>>>>>     be wrong).
>>>>>>> My idea is including this line
>>>>>>>
>>>>>>> `%!in%`  <- function(x, table) match(x, table, nomatch = 0L) == 0L
>>>>>>>
>>>>>>> between lines 39 and 40 of the file "src/library/base/R/match.R".
>>>>>>>
>>>>>>> My objective is to create a "not in" operator that would allow us
>>>>>>     to write
>>>>>>> code like
>>>>>>>>     value %!in% valuelist
>>>>>>> instead of
>>>>>>>>     ! value %in% valuelist
>>>>>>> which is in line with writing
>>>>>>>>     value1 != value2
>>>>>>> instead of
>>>>>>>>     ! value1 == value2
>>>>>>> I was not able to devise any reasonable way that such inclusion
>>>>>>     would break
>>>>>>> any already existing heritage code unless that operator would be
>>>>>>     defined
>>>>>>> otherwisely and it would improve (however marginally) the
>>>>>>     readability of
>>>>>>> future code by its intuitive interpretation and by stitching
>>>>>>     together two
>>>>>>> operators that currently stand apart each other.
>>>>>>>
>>>>>>> So, if this suggestion was not already proposed and if it is seen as
>>>>>>> useful, I would like to include it in the wishlist in Bugzilla.
>>>>>>>
>>>>>>> I would appreciate any feedback, be it critic or support, and I
>>>>>>     hope I have
>>>>>>> not crossed any communicational rule from the group.
>>>>>>>
>>>>>>> Many thanks!  ?
>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>> Marcelo Ventura Freire
>>>>>>> Escola de Artes, Ci?ncias e Humanidades
>>>>>>> Universidade de S?o Paulo
>>>>>>> Av. Arlindo Bettio, 1000,
>>>>>>> Sala Paulo Freire (Sala Coletiva 252), Pr?dio I1
>>>>>>> Ermelino Matarazzo, S?o Paulo, SP, Brasil
>>>>>>> CEP 03828-000
>>>>>>> Tel.: (11) 3091-8894
>>>>>>>
>>>>>>>       [[alternative HTML version deleted]]
>>>>>>>
>>>>>>> ______________________________________________
>>>>>>> R-devel at r-project.org <mailto:R-devel at r-project.org> mailing list
>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel <https://
>>>>>>     stat.ethz.ch/mailman/listinfo/r-devel>
>>>>>>
>>>>> ______________________________________________
>>>>> R-devel at r-project.org mailing list
>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> 
> ------------------------------


From m@ech|er @end|ng |rom @t@t@m@th@ethz@ch  Fri Dec  5 10:01:03 2025
From: m@ech|er @end|ng |rom @t@t@m@th@ethz@ch (Martin Maechler)
Date: Fri, 5 Dec 2025 10:01:03 +0100
Subject: [Rd] 
 Remove http parameters from filename in download.packages()
In-Reply-To: <fake-VM-id.b5824c095875e26b82a865c6faa348c5@talos.iv>
References: <CABFfbXsT9H7eAmuSpiaQ4hoYUof2mhVBbBwMHhbPmY7NzWsN=Q@mail.gmail.com>
 <fake-VM-id.8268cb50716b62fc485165fd5a5fcf73@talos.iv>
 <26928.5898.208733.544206@stat.math.ethz.ch>
 <CABFfbXuxPcDuuXVkSs+9jsCNuoOmsgdKL5LkOPf06BnE=fiAtQ@mail.gmail.com>
 <CAN+W6_u+7LrrNq_chA_2v5NLzi2268kQHQr97eNqxw_EGEdJgw@mail.gmail.com>
Message-ID: <26930.40783.769167.946940@stat.math.ethz.ch>

>>>>> Llu?s Revilla 
>>>>>     on Thu, 4 Dec 2025 10:22:40 +0100 writes:

    > Hi Jeroen and Martin (and other readers),
    > I like this suggestion Jeroen, but I am not sure of the implications
    > of enabling this beyond getting a valid file name locally on the
    > computer.
    > The File field is documented on tools::write_PACKAGES as "the
    > filenames be included ... in the ?PACKAGES? file." (which might need a
    > slight modification if this patch is implemented).

    > What would parameters do on CRAN-like repositories? How would they
    > alter the behaviour of the request of the package downloaded?
    > The only idea I could think of is to control which/how packages are
    > installed (as the name, version and file extension is still fixed on
    > this patch).
    > There are different methods used by CRAN-like repositories to control that:

    > - CRAN handles parameters at the web server level not on the PACKAGES file:
    > You can get a specific package version with
    > https://CRAN.R-project.org/package=PKG&version=VER but doesn't install
    > dependencies as it is understood as a single package.

Interesting; I have not yet seen this documented;  how would it work?
(To me it looks that the  "?...." part is completely
 disregarded, at least when used in a web browser ...)

    > - https://bioconductor.org recommends using BiocManager to point to
    > the right CRAN-like repository.
    > - The CRAN-like repositories from https://r-universe.dev don't
    > redirect but use sha256 as File (as you are well aware).
    > - https://rpkgs.com redirects to appropriate binaries based on the
    > headers, installing a package and its dependencies for the right R
    > version and OS.
    > - https://r-multiverse.org/ has two repositories but doesn't redirect,
    > or use headers to control packages served.

    > CRAN's redirects work for a single package but the headers approach
    > works smoother for more than one at the cost of user/R admin
    > preparations.
    > I am not sure if some of these repositories (or new ones) could
    > benefit from this feature.
    
    > But I don't see a back compatibility problem as this couldn't be used
    > by repositories since it wasn't available.

Thank you,  Llu?s,  for the (partial) summary of what different
CRAN-like repositories do.

To "back compatibility":  We cannot know in how many different
ways install.packages() and update.packages() are used for,
e.g., site-internal (typically company internal) package
repositories.
It could well be that some of these also provide  'File' entries
with a "?"  (possibly even with a different meaning than "url parameters").
.. and their own setup code may rely on the long file names one
way or another.
On decent operating systems (e.g., Linux; possibly macOS)
filenames containing a `?` work without problems:

  $ touch foo?bar
  $ ls -lG  foo?bar
  -rw-r--r-- 1 maechler 0  5. Dec 09:38 'foo?bar'

Hence, unconditionally cutting such filenames (as in the
original proposal) will break such R code.

Hence, we want to allow back compatible behaviour, such that previous
"non-cutting" behaviour would still be possible; easy and
simple.  I'd tend to agree that the new behaviour would still be default
	

Lastly, to Jeroen's question: Yes, of course, update.packages() can use
all arguments of install.packages() via `...` (I'd be sure you'd
know..).
I've documented it explicitly in help(update.packages), yesterday.

Martin




    > El dc., 3 de des. 2025, 12:34, Jeroen Ooms <jeroenooms at gmail.com> va escriure:

    >> 
    >> On Wed, Dec 3, 2025 at 11:55?AM Martin Maechler
    >> <maechler at stat.math.ethz.ch> wrote:
    >> >
    >> > >>>>> Jeroen Ooms
    >> > >>>>>     on Tue, 2 Dec 2025 22:33:05 +0100 writes:
    >> >
    >> >     > Currently `download.packages()` copies the full `File`
    >> >     > field from the URL in PACKAGES, including http parameters,
    >> >     > as the local filename on disk. So for example, if the
    >> >     > `PACKAGES` file contains
    >> >
    >> >     >    Package: jsonlite Version: 2.0.0 File:
    >> >     > jsonlite_2.0.0.tar.gz?auth=blabla123&hash=79fad1b6092c1d1cc71e096d02cbc7618837fda1f90b61443f09adc25caab095
    >> >
    >> >     > Then the file is saved on disk not as
    >> >     > `jsonlite_2.0.0.tar.gz` but as the full url including `?`
    >> >     > and `=` and `&` characters which are not supported and
    >> >     > create corrupt files on some platforms.
    >> >
    >> > Yes... but why should a "CRAN-like repository" use such file names ?
    >> 
    >> Such that we can host a "CRAN-like repository" on modern
    >> infrastructure that may use this sort of URLs.


    >> > I am considering, but still not convinced why it is needed (see above).
    >> > Maybe I'm overlooking something ?
    >> > Also, I'd have it as a switch (argument) of download.packages() in
    >> > order to provide back compatibility [no need for a new patch, though !]
    >> 
    >> The patch should not break functionality; it only fixes an edge case
    >> where R would otherwise write to an illegal filename on disk. I am
    >> guessing nobody has used this yet so I am not sure what would be the
    >> value of back compatibility to ensure R keeps doing this.
    >> 
    >> In either case the fix would only be useful if install.packages()
    >> makes use of it.
    >> 
    >> ______________________________________________
    >> R-devel at r-project.org mailing list
    >> https://stat.ethz.ch/mailman/listinfo/r-devel


From Kurt@Horn|k @end|ng |rom wu@@c@@t  Fri Dec  5 10:42:44 2025
From: Kurt@Horn|k @end|ng |rom wu@@c@@t (Kurt Hornik)
Date: Fri, 5 Dec 2025 10:42:44 +0100
Subject: [Rd] 
 Remove http parameters from filename in download.packages()
In-Reply-To: <26930.40783.769167.946940@stat.math.ethz.ch>
References: <CABFfbXsT9H7eAmuSpiaQ4hoYUof2mhVBbBwMHhbPmY7NzWsN=Q@mail.gmail.com>
 <fake-VM-id.8268cb50716b62fc485165fd5a5fcf73@talos.iv>
 <26928.5898.208733.544206@stat.math.ethz.ch>
 <CABFfbXuxPcDuuXVkSs+9jsCNuoOmsgdKL5LkOPf06BnE=fiAtQ@mail.gmail.com>
 <CAN+W6_u+7LrrNq_chA_2v5NLzi2268kQHQr97eNqxw_EGEdJgw@mail.gmail.com>
 <26930.40783.769167.946940@stat.math.ethz.ch>
Message-ID: <26930.43284.471073.433855@hornik.net>

>>>>> Martin Maechler writes:

Friends, a few quick comments.

The package+version URL mechanism is documented in the CRAN mirror HOWTO
<https://cran.r-project.org/mirror-howto.html>.

I had initially thought that one should safely remove http parameters
when using a https? repo URL, but the repo does not know whether it is
accessed via https?:// or e.g. file://, the latter for a local mirror.

I think it is better to do redirections in the file system and use the
Path field in PACKAGES as necessary.  E.g., to access all
package_version.tar.gz source files for CRAN irrespective of whether in
current or archive one could create a pool area with symlinks to the
physical locations, and arrange to use the pool as the repo.

-k

>>>>> Llu?s Revilla 
>>>>>     on Thu, 4 Dec 2025 10:22:40 +0100 writes:

>> Hi Jeroen and Martin (and other readers),
>> I like this suggestion Jeroen, but I am not sure of the implications
>> of enabling this beyond getting a valid file name locally on the
>> computer.
>> The File field is documented on tools::write_PACKAGES as "the
>> filenames be included ... in the ?PACKAGES? file." (which might need a
>> slight modification if this patch is implemented).

>> What would parameters do on CRAN-like repositories? How would they
>> alter the behaviour of the request of the package downloaded?
>> The only idea I could think of is to control which/how packages are
>> installed (as the name, version and file extension is still fixed on
>> this patch).
>> There are different methods used by CRAN-like repositories to control that:

>> - CRAN handles parameters at the web server level not on the PACKAGES file:
>> You can get a specific package version with
>> https://CRAN.R-project.org/package=PKG&version=VER but doesn't install
>> dependencies as it is understood as a single package.

> Interesting; I have not yet seen this documented;  how would it work?
> (To me it looks that the  "?...." part is completely
>  disregarded, at least when used in a web browser ...)

>> - https://bioconductor.org recommends using BiocManager to point to
>> the right CRAN-like repository.
>> - The CRAN-like repositories from https://r-universe.dev don't
>> redirect but use sha256 as File (as you are well aware).
>> - https://rpkgs.com redirects to appropriate binaries based on the
>> headers, installing a package and its dependencies for the right R
>> version and OS.
>> - https://r-multiverse.org/ has two repositories but doesn't redirect,
>> or use headers to control packages served.

>> CRAN's redirects work for a single package but the headers approach
>> works smoother for more than one at the cost of user/R admin
>> preparations.
>> I am not sure if some of these repositories (or new ones) could
>> benefit from this feature.
    
>> But I don't see a back compatibility problem as this couldn't be used
>> by repositories since it wasn't available.

> Thank you,  Llu?s,  for the (partial) summary of what different
> CRAN-like repositories do.

> To "back compatibility":  We cannot know in how many different
> ways install.packages() and update.packages() are used for,
> e.g., site-internal (typically company internal) package
> repositories.
> It could well be that some of these also provide  'File' entries
> with a "?"  (possibly even with a different meaning than "url parameters").
> .. and their own setup code may rely on the long file names one
> way or another.
> On decent operating systems (e.g., Linux; possibly macOS)
> filenames containing a `?` work without problems:

>   $ touch foo?bar
>   $ ls -lG  foo?bar
>   -rw-r--r-- 1 maechler 0  5. Dec 09:38 'foo?bar'

> Hence, unconditionally cutting such filenames (as in the
> original proposal) will break such R code.

> Hence, we want to allow back compatible behaviour, such that previous
> "non-cutting" behaviour would still be possible; easy and
> simple.  I'd tend to agree that the new behaviour would still be default
	

> Lastly, to Jeroen's question: Yes, of course, update.packages() can use
> all arguments of install.packages() via `...` (I'd be sure you'd
> know..).
> I've documented it explicitly in help(update.packages), yesterday.

> Martin




>> El dc., 3 de des. 2025, 12:34, Jeroen Ooms <jeroenooms at gmail.com> va escriure:

>>> 
>>> On Wed, Dec 3, 2025 at 11:55?AM Martin Maechler
>>> <maechler at stat.math.ethz.ch> wrote:
>>> >
>>> > >>>>> Jeroen Ooms
>>> > >>>>>     on Tue, 2 Dec 2025 22:33:05 +0100 writes:
>>> >
>>> >     > Currently `download.packages()` copies the full `File`
>>> >     > field from the URL in PACKAGES, including http parameters,
>>> >     > as the local filename on disk. So for example, if the
>>> >     > `PACKAGES` file contains
>>> >
>>> >     >    Package: jsonlite Version: 2.0.0 File:
>>> >     > jsonlite_2.0.0.tar.gz?auth=blabla123&hash=79fad1b6092c1d1cc71e096d02cbc7618837fda1f90b61443f09adc25caab095
>>> >
>>> >     > Then the file is saved on disk not as
>>> >     > `jsonlite_2.0.0.tar.gz` but as the full url including `?`
>>> >     > and `=` and `&` characters which are not supported and
>>> >     > create corrupt files on some platforms.
>>> >
>>> > Yes... but why should a "CRAN-like repository" use such file names ?
>>> 
>>> Such that we can host a "CRAN-like repository" on modern
>>> infrastructure that may use this sort of URLs.


>>> > I am considering, but still not convinced why it is needed (see above).
>>> > Maybe I'm overlooking something ?
>>> > Also, I'd have it as a switch (argument) of download.packages() in
>>> > order to provide back compatibility [no need for a new patch, though !]
>>> 
>>> The patch should not break functionality; it only fixes an edge case
>>> where R would otherwise write to an illegal filename on disk. I am
>>> guessing nobody has used this yet so I am not sure what would be the
>>> value of back compatibility to ensure R keeps doing this.
>>> 
>>> In either case the fix would only be useful if install.packages()
>>> makes use of it.
>>> 
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel

> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From J@me@@Lemon @end|ng |rom ttu@edu  Fri Dec  5 18:07:48 2025
From: J@me@@Lemon @end|ng |rom ttu@edu (Lemon, James)
Date: Fri, 5 Dec 2025 17:07:48 +0000
Subject: [Rd] Possible VPAT for R?
Message-ID: <BYAPR06MB46624E0F4A9180723CF9128BEEA7A@BYAPR06MB4662.namprd06.prod.outlook.com>

Hello,

Our university administration, in accordance with State and Federal law, have begun collecting VPATs with WCAG 2.1/2.2 (https://www.itic.org/policy/accessibility/vpat, https://www.wcag.com/solutions/vpat-accessibility-documentation/) for the software we use in the Library (primarily public-use, but faculty as well), and will be mandatory by April 2026 to conform to Section 508 (https://www.section508.gov/).

We would like to continue including R in our public image, but without a VPAT we will have no choice but to remove it before April 2026. We are contacting you in hopes that this is something that your company could provide in the near future, as no doubt other educational and public institutions have or will soon have the same requirements for their software.

Here are some examples if they help:
https://www.adobe.com/accessibility/compliance.html
https://belonging.google/accessibility-conformance-reports/
https://sales.jetbrains.com/hc/en-gb/articles/115000637784-Do-you-have-Voluntary-Product-Accessibility-Templates-VPATs
https://www.microsoft.com/en-us/accessibility/conformance-reports
https://www.phpkb.com/vpat

Thanks,


James Lemon

Senior IT Support Technician

Library Technology Management Services

	[[alternative HTML version deleted]]


From |kry|ov @end|ng |rom d|@root@org  Fri Dec  5 21:03:34 2025
From: |kry|ov @end|ng |rom d|@root@org (Ivan Krylov)
Date: Fri, 5 Dec 2025 23:03:34 +0300
Subject: [Rd] Possible VPAT for R?
In-Reply-To: <BYAPR06MB46624E0F4A9180723CF9128BEEA7A@BYAPR06MB4662.namprd06.prod.outlook.com>
References: <BYAPR06MB46624E0F4A9180723CF9128BEEA7A@BYAPR06MB4662.namprd06.prod.outlook.com>
Message-ID: <20251205230334.74d67d16@Tarkus>

Dear James Lemon,

? Fri, 5 Dec 2025 17:07:48 +0000
"Lemon, James" <James.Lemon at ttu.edu> ?????:

> We would like to continue including R in our public image, but
> without a VPAT we will have no choice but to remove it before April
> 2026. 

Here are some responses from an earlier thread about a VPAT for R:

https://stat.ethz.ch/pipermail/r-help/2024-February/478906.html
https://stat.ethz.ch/pipermail/r-devel/2024-February/083209.html

If you find a vendor willing to provide a VPAT for a recent version of
R, please share your findings.

-- 
Best regards,
Ivan


From iuke-tier@ey m@iii@g oii uiow@@edu  Fri Dec  5 21:27:25 2025
From: iuke-tier@ey m@iii@g oii uiow@@edu (iuke-tier@ey m@iii@g oii uiow@@edu)
Date: Fri, 5 Dec 2025 14:27:25 -0600 (CST)
Subject: [Rd] 
 [External] Re: non-API SETLENGTH and friends will be dropped soon
In-Reply-To: <CY8PR05MB1003417AC5E6405FCB5AAA1EBC8A6A@CY8PR05MB10034.namprd05.prod.outlook.com>
References: <d3ad2a6c-09e7-8ebd-105a-2938e6003cd4@uiowa.edu>
 <CY8PR05MB1003417AC5E6405FCB5AAA1EBC8A6A@CY8PR05MB10034.namprd05.prod.outlook.com>
Message-ID: <aca47f87-e23d-908c-0b97-6c7a386efcc4@uiowa.edu>

Sounds good. Using xlengthgets is the way to go for your package, and
most others. I think I posted an outline on how I would do that a few
months ago. The resizable framework is mainly for data.table, who seem
convinced that they need it.

Best,

luke

On Thu, 4 Dec 2025, Merlise Clyde, Ph.D. wrote:

> Dear Luke,
> 
> I have implemented changes knowing this was around the corner to address
> this and hopefully can finalize unit tests/comparisons in the next week (I
> also want to take a look at the new resizable option to see how that
> compares to what I did), but it looks like CRAN will be down for submissions
> from Dec 23 through Jan 7. ? Hoping the grace period takes into account this
> down time in case early submissions fail on some of the CRAN machines
> despite all efforts to test ahead of time.
> 
> Best,
> Merlise
> 
> From: luke-tierney at uiowa.edu <luke-tierney at uiowa.edu>
> Date: Wednesday, December 3, 2025 at 8:47?PM
> To: R-devel at r-project.org <R-devel at r-project.org>
> Subject: non-API SETLENGTH and friends will be dropped soon
> 
> As part of clarifying and tightening the R API for packages the
> non-API entry points SETLENGTH, TRUELENGTH, SET_TRUELENGTH, and
> SET_GROWABLE_BIT will be removed from installed header files and,
> where possible, hidden from package access. The first step will be to
> turn current check NOTEs into WARNINGs; this will hopefully happen in
> the next few weeks. Hopefully the process can be completed by early
> January.
> 
> 17 CRAN/BIOC packages currently make use of one or more of these entry
> points. Most using SETLENGTH should transition to using xgetlength(),
> which allocates a new vector, usually with a shorter length. There is
> a small amount of overhead, and care is needed to protect the new
> result, but this is a much safer option. R-devel does now include an
> experimental API for creating resizable vectors, but it needs a great
> deal of care to use safely. These options are described in a new
> section "Resizing vectors" in the Writing R Extensions manual.
> 
> [If you are a maintainer of one of the 17 affected packages you should
> receive a separate copy of this note.]
> 
> Best,
> 
> luke
> ~
> 
> --
> Luke Tierney
> Ralph E. Wareham Professor of Mathematical Sciences
> University of Iowa????????????????? Phone:???????????? 319-335-3386
> Department of Statistics and??????? Fax:?????????????? 319-335-3017
> ??? Actuarial Science
> 241 Schaeffer Hall????????????????? email:?? luke-tierney at uiowa.edu
> Iowa City, IA 52242???????????????? WWW:?http://www.stat.u/
> iowa.edu%2F&data=05%7C02%7Cclyde%40duke.edu%7Cba7580378f9541643d8308de32d7
> 0ce1%7Ccb72c54e4a314d9eb14a1ea36dfac94c%7C0%7C0%7C639004096389160865%7CUnk
> nown%7CTWFpbGZsb3d8eyJFbXB0eU1hcGkiOnRydWUsIlYiOiIwLjAuMDAwMCIsIlAiOiJXaW4
> zMiIsIkFOIjoiTWFpbCIsIldUIjoyfQ%3D%3D%7C0%7C%7C%7C&sdata=ixyactGTcKZWRkHyy
> IAnIf0jV5u8OK2vPywlWRhNkfE%3D&reserved=0
> 
>

-- 
Luke Tierney
Ralph E. Wareham Professor of Mathematical Sciences
University of Iowa                  Phone:             319-335-3386
Department of Statistics and        Fax:               319-335-3017
    Actuarial Science
241 Schaeffer Hall                  email:   luke-tierney at uiowa.edu
Iowa City, IA 52242                 WWW:  http://www.stat.uiowa.edu/

From murdoch@dunc@n @end|ng |rom gm@||@com  Sat Dec  6 17:46:05 2025
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Sat, 6 Dec 2025 11:46:05 -0500
Subject: [Rd] Typos in language manual
Message-ID: <87bce255-2446-461c-95d8-14abef94b094@gmail.com>

In section "3.4.4 Subset assignment", the manual says this:

> Complex assignments in the enclosing environment (using <<-) are also permitted:
> 
> names(x)[3] <<- "Three"
> is equivalent to
> 
> `*tmp*` <<- get(x, envir=parent.env(), inherits=TRUE)
> names(`*tmp*`)[3] <- "Three"
> x <<- `*tmp*`
> rm(`*tmp*`)

I think there are two typos here in the first line.  I'm pretty sure 
that it should read

     `*tmp*` <- get("x", envir=parent.env(), inherits=TRUE)

i.e. regular assignment, and quoted variable name.

Duncan Murdoch


From Kurt@Horn|k @end|ng |rom wu@@c@@t  Mon Dec  8 20:00:25 2025
From: Kurt@Horn|k @end|ng |rom wu@@c@@t (Kurt Hornik)
Date: Mon, 8 Dec 2025 20:00:25 +0100
Subject: [Rd] Typos in language manual
In-Reply-To: <87bce255-2446-461c-95d8-14abef94b094@gmail.com>
References: <87bce255-2446-461c-95d8-14abef94b094@gmail.com>
Message-ID: <26935.8265.419756.902030@hornik.net>

>>>>> Duncan Murdoch writes:

Thanks, fixed now.

Best
-k

> In section "3.4.4 Subset assignment", the manual says this:
>> Complex assignments in the enclosing environment (using <<-) are also permitted:
>> 
>> names(x)[3] <<- "Three"
>> is equivalent to
>> 
>> `*tmp*` <<- get(x, envir=parent.env(), inherits=TRUE)
>> names(`*tmp*`)[3] <- "Three"
>> x <<- `*tmp*`
>> rm(`*tmp*`)

> I think there are two typos here in the first line.  I'm pretty sure 
> that it should read

>      `*tmp*` <- get("x", envir=parent.env(), inherits=TRUE)

> i.e. regular assignment, and quoted variable name.

> Duncan Murdoch

> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From Thom@@@SOEIRO @end|ng |rom @p-hm@|r  Wed Dec 10 20:09:44 2025
From: Thom@@@SOEIRO @end|ng |rom @p-hm@|r (SOEIRO Thomas)
Date: Wed, 10 Dec 2025 19:09:44 +0000
Subject: [Rd] ^C does not clear the command being typed immediately in
 Rterm.exe on Windows
Message-ID: <cd88897167e34f9cbd05e946b0fedcc4@ap-hm.fr>

Hello,

In Rterm.exe on Windows, pressing ^C (Ctrl+C) does not clear *the command being typed* immediately.
It does only after pressing ENTER.
However, it does terminate *the current process* immediately (i.e. without pressing ENTER).

I observe the same behavior in R running from cmd.exe (not sure if it is different from Rterm.exe).

Other escape sequences (e.g. ^U, ^K, ^R, ^D...) work as expected (i.e. as they do on Linux).

Is it expected? Should it be reported to R Bugzilla?

FWIW, the use case is to clear (potentially malformed) multiline input.
^U and ^K works for single line input.
Am I missing something?

Thanks,
Thomas


sessionInfo()
# R version 4.4.0 (2024-04-24 ucrt)
# Platform: x86_64-w64-mingw32/x64
# Running under: Windows 11 x64 (build 22631)
# 
# Matrix products: default
# 
# 
# locale:
# [1] LC_COLLATE=French_France.utf8  LC_CTYPE=French_France.utf8
# [3] LC_MONETARY=French_France.utf8 LC_NUMERIC=C
# [5] LC_TIME=French_France.utf8
# 
# time zone: Europe/Paris
# tzcode source: internal
# 
# attached base packages:
# [1] stats     graphics  grDevices utils     datasets  methods   base
# 
# loaded via a namespace (and not attached):
# [1] compiler_4.4.0


From therne@u @end|ng |rom m@yo@edu  Thu Dec 11 05:24:50 2025
From: therne@u @end|ng |rom m@yo@edu (Therneau, Terry M., Ph.D.)
Date: Thu, 11 Dec 2025 04:24:50 +0000
Subject: [Rd] Global options and survival
Message-ID: <SJ0PR01MB8155E9E3F2DB356251605D98AEA1A@SJ0PR01MB8155.prod.exchangelabs.com>

This is a design question for R-core and/or CRAN folks.  I think I know what the answer will be, but I thought I would ask.

The plot.survfit and lines.survfit functions have an "xmax" argument.  The result of this is to truncate curves at the given time value, something we often want to do.   The result of xmax is more pleasing than using xlim: since it truncates the data before plotting, lines do not 'run into' the right hand side of the bounding box. Plus one avoids any warning messages about data outside the limits.

When using plot then lines, it would be nice if an xmax argument from the plot call was remembered for the subsequent lines() call.  I added an experimental way to do this a few years ago and it seems to work, but never documented it.  I recently ran into it looking at the code and should do one or the other: document or remove.
What the code does is that plot.survfit sets a global "plot.survfit" option using options(), which contains this information, and lines.survfit uses that as a default if xmax is not specified.

Like I said, it works as intended, but leaving things on the global options list seems untidy, especially since it will persist until the end of the session (or next plot.survfit call).  On the other hand, I can't imagine any conflict with my chosen name.  At one time I thought there might be other things I want to persist (the plot.survfit option is itself a list), but nothing has come up in the 5 or so years since I created this.

Document or delete?

Terry

	[[alternative HTML version deleted]]


From henr|k@bengt@@on @end|ng |rom gm@||@com  Thu Dec 11 07:40:29 2025
From: henr|k@bengt@@on @end|ng |rom gm@||@com (Henrik Bengtsson)
Date: Wed, 10 Dec 2025 22:40:29 -0800
Subject: [Rd] rep(): Expecting an argument-is-missing error, but ...
Message-ID: <CAFDcVCTsn8yv0bKDO=EfaoCMsZtH0ApG_h_TQSyb5upns94c9w@mail.gmail.com>

What's going on here:

$ R --vanilla --quiet
> f <- function(n) rep("x", times = n)
> f()
[1] "x"

?

> getRversion()
[1] ?4.5.2?

/Henrik


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Thu Dec 11 08:40:04 2025
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Thu, 11 Dec 2025 07:40:04 +0000
Subject: [Rd] rep(): Expecting an argument-is-missing error, but ...
In-Reply-To: <CAFDcVCTsn8yv0bKDO=EfaoCMsZtH0ApG_h_TQSyb5upns94c9w@mail.gmail.com>
References: <CAFDcVCTsn8yv0bKDO=EfaoCMsZtH0ApG_h_TQSyb5upns94c9w@mail.gmail.com>
Message-ID: <e0c29f76-68ca-4162-bc31-897b66bfb9ea@sapo.pt>

?s 06:40 de 11/12/2025, Henrik Bengtsson escreveu:
> What's going on here:
> 
> $ R --vanilla --quiet
>> f <- function(n) rep("x", times = n)
>> f()
> [1] "x"
> 
> ?
> 
>> getRversion()
> [1] ?4.5.2?
> 
> /Henrik
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
Hello,

I can reproduce this on Windows.


Microsoft Windows [Version 10.0.22631.5039]
(c) Microsoft Corporation. Todos os direitos reservados.

C:\>R --vanilla --quiet
 > f <- function(n) rep("x", times = n)
 > f
function(n) rep("x", times = n)
 > f()
[1] "x"
 > getRversion()
[1] '4.5.2'
 > g <- function(n) rep(1, times = n)
 > g
function(n) rep(1, times = n)
 > g()
[1] 1
 > h <- function(n) rep(1, n)
 > h
function(n) rep(1, n)
 > h()
[1] 1
 > i <- function(n) rep(1, each = n)
 > i()
[1] 1
 > sessionInfo()
R version 4.5.2 (2025-10-31 ucrt)
Platform: x86_64-w64-mingw32/x64
Running under: Windows 11 x64 (build 22631)

Matrix products: default
   LAPACK version 3.12.1

locale:
[1] LC_COLLATE=Portuguese_Portugal.utf8  LC_CTYPE=Portuguese_Portugal.utf8
[3] LC_MONETARY=Portuguese_Portugal.utf8 LC_NUMERIC=C
[5] LC_TIME=Portuguese_Portugal.utf8

time zone: Europe/Lisbon
tzcode source: internal

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

loaded via a namespace (and not attached):
[1] compiler_4.5.2 tools_4.5.2
 > q()


Hope this helps,

Rui Barradas


From peter@|@ng|e|der @end|ng |rom gm@||@com  Thu Dec 11 09:21:01 2025
From: peter@|@ng|e|der @end|ng |rom gm@||@com (Peter Langfelder)
Date: Thu, 11 Dec 2025 16:21:01 +0800
Subject: [Rd] rep(): Expecting an argument-is-missing error, but ...
In-Reply-To: <CAFDcVCTsn8yv0bKDO=EfaoCMsZtH0ApG_h_TQSyb5upns94c9w@mail.gmail.com>
References: <CAFDcVCTsn8yv0bKDO=EfaoCMsZtH0ApG_h_TQSyb5upns94c9w@mail.gmail.com>
Message-ID: <CA+hbrhW_=DqapQNcyNuTaByQoc2qWBHtcjP66VmVi1rbtP1a-A@mail.gmail.com>

I think it's a bit of a quirk of rep:

> rep("x")
> [1] "x"

Help of 'rep' does state this:

The default behaviour is as if the call was

       rep(x, times = 1, length.out = NA, each = 1)

So it seems to even be documented.

Peter


Peter

On Thu, Dec 11, 2025 at 2:40?PM Henrik Bengtsson
<henrik.bengtsson at gmail.com> wrote:
>
> What's going on here:
>
> $ R --vanilla --quiet
> > f <- function(n) rep("x", times = n)
> > f()
> [1] "x"
>
> ?
>
> > getRversion()
> [1] ?4.5.2?
>
> /Henrik
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From @oko| @end|ng |rom |n@@-tou|ou@e@|r  Thu Dec 11 09:53:39 2025
From: @oko| @end|ng |rom |n@@-tou|ou@e@|r (Serguei Sokol)
Date: Thu, 11 Dec 2025 09:53:39 +0100
Subject: [Rd] rep(): Expecting an argument-is-missing error, but ...
In-Reply-To: <CA+hbrhW_=DqapQNcyNuTaByQoc2qWBHtcjP66VmVi1rbtP1a-A@mail.gmail.com>
References: <CAFDcVCTsn8yv0bKDO=EfaoCMsZtH0ApG_h_TQSyb5upns94c9w@mail.gmail.com>
 <CA+hbrhW_=DqapQNcyNuTaByQoc2qWBHtcjP66VmVi1rbtP1a-A@mail.gmail.com>
Message-ID: <e4c8f953-cb46-487e-94f2-067e739d1a9f@insa-toulouse.fr>

Le 11/12/2025 ? 09:21, Peter Langfelder a ?crit?:
> I think it's a bit of a quirk of rep:
>
>> rep("x")
>> [1] "x"
> Help of 'rep' does state this:
>
> The default behaviour is as if the call was
>
>         rep(x, times = 1, length.out = NA, each = 1)
>
> So it seems to even be documented.
Right. But I think the initial question was rather "why f() does not 
complain about missing n?"
It is because 'n' is not used in f() itself, it's just passed through in 
his quality of "missing".

If you define f() where 'n' is used in some way, e.g. as follows:

f=function(n) rep("x", times=n+0L)

then it complains:

f()
Error in f() (from #1) : argument "n" is missing, with no default

Serguei.

>
> Peter
>
>
> Peter
>
> On Thu, Dec 11, 2025 at 2:40?PM Henrik Bengtsson
> <henrik.bengtsson at gmail.com> wrote:
>> What's going on here:
>>
>> $ R --vanilla --quiet
>>> f <- function(n) rep("x", times = n)
>>> f()
>> [1] "x"
>>
>> ?
>>
>>> getRversion()
>> [1] ?4.5.2?
>>
>> /Henrik
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>
>
>


-- 
Serguei Sokol
Ingenieur de recherche INRAE

Cellule Math?matiques
TBI, INSA/INRAE UMR 792, INSA/CNRS UMR 5504
135 Avenue de Rangueil
31077 Toulouse Cedex 04

tel: +33 5 61 55 98 49
email: sokol at insa-toulouse.fr
https://www.toulouse-biotechnology-institute.fr/en/plateformes-plateaux/cellule-mathematiques/


From ru@@e||@g@@|mond @end|ng |rom gm@||@com  Thu Dec 11 23:10:28 2025
From: ru@@e||@g@@|mond @end|ng |rom gm@||@com (Russell Almond)
Date: Thu, 11 Dec 2025 17:10:28 -0500
Subject: [Rd] S4 generic functions don't respect S3 class hierarchies.
Message-ID: <093e0a80-0769-4def-88e1-0a4310fbc46f@gmail.com>

I noticed this problem while working with R6 objects, but I can 
reproduce it using S3 classes.

If I define a method on the S3 superclass, the subclass doesn't inherit it.

``` r
library(methods)

SuperClass <- function(n) {
 ? result <- list(n=n)
 ? class(result) <- "SuperClass"
 ? result
}

setOldClass("SuperClass")

setGeneric("sampleSize",function(x) {standardGeneric("sampleSize")})
#> [1] "sampleSize"

setMethod("sampleSize","SuperClass", function(x) {x$n})

SubClass <- function (n) {
 ? result <- SuperClass(n)
 ? class(result) <- c("SubClass",class(result))
 ? result
}

setOldClass("SubClass")

example <- SubClass(7)
class(example)
#> [1] "SubClass"?? "SuperClass"
is(example,"SuperClass")
#> [1] TRUE
methods("sampleSize")
#> [1] sampleSize,SuperClass-method
#> see '?methods' for accessing help and source code
sampleSize(example)
#> Error: unable to find an inherited method for function 'sampleSize' 
for signature 'x = "SubClass"'
```

<sup>Created on 2025-12-11 with [reprex 
v2.1.1](https://reprex.tidyverse.org)</sup>

I'm using R 4.5.2 and the same version of methods.

Is this a bug?

 ??? --Russell


-- 
Russell Almond
https://ralmond.net/

	[[alternative HTML version deleted]]


From |@rcego@p| @end|ng |rom gm@||@com  Fri Dec 12 12:40:56 2025
From: |@rcego@p| @end|ng |rom gm@||@com (Fer)
Date: Fri, 12 Dec 2025 12:40:56 +0100
Subject: [Rd] Feature suggestion: %!in%
In-Reply-To: <EA47A69E-3B69-4F9E-B7F3-A721F1098D86@uzh.ch>
References: <CAGcsfB3dn88L3U8TmDEkwNfJkphnFtJ8CRK-TJhZ5yOFU7=uMQ@mail.gmail.com>
 <58bec605-9000-4f9e-9eb4-86950c4eb9e5@gmail.com>
 <CAGcsfB0s0U+zYYHW6eWx5kKzH_XdmVKm=8LsJDWxfn8Pe-Ga0Q@mail.gmail.com>
 <15fa876c-c0f3-4177-9045-ee6408fbcd16@gmail.com>
 <9226DB4F-E4DE-477C-835F-0580A8C0024A@R-project.org>
 <4e8e0040-430e-4503-9a8a-26a9698a6bac@gmail.com>
 <CAJXgQP3rSaU4JN02pM8XrVELJC7A85DKW8sLFf8P6Fh6RGHGSA@mail.gmail.com>
 <EA47A69E-3B69-4F9E-B7F3-A721F1098D86@uzh.ch>
Message-ID: <c1b8ded4-3333-44da-abaa-fd7ae1545674@gmail.com>

I often have the bolean negation defined in many projects directly, i.e.

`%out%` <-Negate(`%in%`)

 > 4 %in% c(1,2,5)
[1] FALSE
 > 4 %out% c(1,2,5)
[1] TRUE

so I can check whether something is *in*side or *out*side a given 
object. I found it particularly useful btw.

best

Fer


On 12/2/25 11:13, Taras Zakharko wrote:
> I wonder what would be the formal relationship between %in% and %notin%, which will be relevant if these operators are made generic in the future.  Is `%notin%` defined as a boolean negation of `%in%`, is it the other way around, or are they entirely independent definitions that just happen to have complementary semantics?
>
> I would be in favor of defining %notin% as a sugar for !x %in% y
>
> Best,
>
> Taras
>
>
>> On 1 Dec 2025, at 21:23, Kevin Ushey<kevinushey at gmail.com> wrote:
>>
>> Another useful data point: a large number of CRAN packages also define
>> their own %nin% / %notin% operators, e.g.
>>
>> https://github.com/search?q=org%3Acran+%25nin%25&type=code
>> https://github.com/search?q=org%3Acran+%25notin%25&type=code
>>
>> I think the broad usage of the operator, and the consensus over its
>> implementation, makes it a strong candidate for inclusion in R itself.
>>
>> I imagine a similar justification was used when %||% was added to base
>> R as well (which I was very glad to see!)
>>
>> Best,
>> Kevin
>>
>> On Fri, Nov 28, 2025 at 3:12?AM Duncan Murdoch<murdoch.duncan at gmail.com> wrote:
>>> On 2025-11-27 6:09 p.m., Simon Urbanek wrote:
>>>> Given that the args of tools:::%notin% don?t match %in% I'd say it was just a local use more than any deep thought about general use.
>>>>
>>>> Personally, I really like the idea of %notin% because it is very often that you start typing foo[foo %in% and then realise you want to invert it and the preceding negation is then cognitively sort of in the wrong place (reads like "not foo"). I also like %notin% better than %!in% because I think a salad of special characters makes things harder to read, but that may be just subjective.
>>> I agree with both points.  I generally use inefficient and unnecessary
>>> parens, i.e. `foo[!(foo %in% baz)]`.
>>>
>>>> And to your 'why bother' question - I do think it?s better to standardise common operators in core rather than have packages re-define it each time. And certainly just importing something that trivial from another package is a bad idea given the dependency implications.
>>> If someone is willing to put up with the fallout from the "masked"
>>> messages, then I'd also be in favour.  (And I'd choose %notin% rather
>>> than %!in% or %nin%, but whoever is willing to do the work should make
>>> that choice.)
>>>
>>>> (On the flip side: if you start using it you need to depend on recent
>>> R which may not be feasible in some environments, but then if that was
>>> always the argument we?d never add anything new :P).
>>>
>>> Or depend on the backports package.
>>>
>>> Duncan Murdoch
>>>> Cheers,
>>>> Simon
>>>>
>>>>
>>>>> On 28 Nov 2025, at 08:24, Duncan Murdoch<murdoch.duncan at gmail.com> wrote:
>>>>>
>>>>> On 2025-11-27 11:58 a.m., Marcelo Ventura Freire wrote:
>>>>>> If it is not a rhetorical question about a closed issue (if it is, tell me and I will shut up), this inclusion [1] would be useful (since it was exported and rewritten so many times by so many people and will keep being), [2] would create an uniformization (since it was and will be written under so many names before), [3] would not break stuff (since it is not altering the interface of any already existing function nor it is overwriting any symbol with a diverse use), [4] would not be neither a complex nor a tiringsome inclusion (even I myself could do it in a single 1-line pull request, hypothetically speaking) and [5] would benefit users all around.
>>>>>> I am not naive to the point of believing that an alteration to the R core would have few repercussions and surely there must be reasons why it was not done before.
>>>>> I don't know why it was added to tools but not exported, but here is my guess:
>>>>>
>>>>> - A member of R Core agrees with you that this operator is useful. This appears to have happened in 2016 based on the svn log.
>>>>> - It already existed in some contributed package, but base packages can't import anything from non-base packages, so it needed to be added.
>>>>> - It wasn't exported, because that would break some packages:
>>>>>     - the ones that export something with that name would now receive a check message about the conflict.
>>>>>     - if those packages stopped exporting it, then any package that imported from one of them would have to stop doing that, and import it from the base package instead.
>>>>> - It is very easy to write your own, or to import one of the existing ones, so a lot of work would have been generated for not very much benefit.
>>>>>
>>>>> R Core members try to be careful not to generate work for others unless there's enough of a net benefit to the community.  They are very busy, and many authors of contributed packages who might be affected by this change are busy too.
>>>>>
>>>>>
>>>>>> But, in the end, this inclusion would be just a seemingly unharmful syntax sugar that could be shared, like it was with "\" for the reserved word "function", but with waaaay less work to implement.
>>>>> The difference there is that it added new syntax, so as far as I know, it didn't affect any existing package.  Personally I don't see that it really offered much of a benefit (keystrokes are cheap), but lots of people are using it, so I guess some others would disagree.>
>>>>>> If it is not a dumb proposal, I can just include it in the wishlist of features in Bugzilla as prescribed in the contributor's page or I can do that PR myself (if you propose more work to others, the sensible thing to do is at least to offer yourself to do it, right?). In either case, I create more work to the dev team, perhaps to different people.
>>>>> It's hard for you to do the coordination work with all the existing packages that use a similar operator, so I don't think that's really feasible.
>>>>>
>>>>>> Thanks for taking your time to answer me.
>>>>> No problem.  I'm sitting in an airport waiting for a plane, so any distraction is a net benefit for me!
>>>>>
>>>>> Duncan Murdoch>
>>>>>> Marcelo Ventura Freire
>>>>>> Escola de Artes, Ci?ncias e Humanidades
>>>>>> Universidade de S?o Paulo
>>>>>> Av. Arlindo Bettio, 1000,
>>>>>> Sala Paulo Freire (Sala Coletiva 252), Pr?dio I1
>>>>>> Ermelino Matarazzo, S?o Paulo, SP, Brasil
>>>>>> CEP 03828-000
>>>>>> Tel.: (11) 3091-8894
>>>>>> Em qui., 27 de nov. de 2025 ?s 14:15, Duncan Murdoch <murdoch.duncan at gmail.com <mailto:murdoch.duncan at gmail.com>> escreveu:
>>>>>>     The R sources already contain an operator like that, though it is not
>>>>>>     exported.  tools:::`%notin%` is defined as
>>>>>>        function (x, y)
>>>>>>     is.na<http://is.na>(match(x, y))
>>>>>>     Several CRAN packages export a similar function, e.g. omnibus, mefa4,
>>>>>>     data.table, hutils, etc. So I think if it was exported by R that's a
>>>>>>     better name, but since it is easy to write yourself or import from some
>>>>>>     other package, why bother?
>>>>>>     Duncan Murdoch
>>>>>>     On 2025-11-27 9:19 a.m., Marcelo Ventura Freire via R-devel wrote:
>>>>>>> Hello, dear R core developers
>>>>>>>
>>>>>>>
>>>>>>> I have a feature suggestion and, following the orientations in
>>>>>>> https://contributor.r-project.org/rdevguide/chapters/
>>>>>>     submitting_feature_requests.html<https://contributor.r-project.org/ 
>>>>>> rdevguide/chapters/submitting_feature_requests.html>,
>>>>>>> I have searched in Bugzilla to the best of my capabilities for
>>>>>>     suggestions
>>>>>>> like the one I have in mind but found no results (however, I can
>>>>>>     be wrong).
>>>>>>> My idea is including this line
>>>>>>>
>>>>>>> `%!in%`  <- function(x, table) match(x, table, nomatch = 0L) == 0L
>>>>>>>
>>>>>>> between lines 39 and 40 of the file "src/library/base/R/match.R".
>>>>>>>
>>>>>>> My objective is to create a "not in" operator that would allow us
>>>>>>     to write
>>>>>>> code like
>>>>>>>>     value %!in% valuelist
>>>>>>> instead of
>>>>>>>>     ! value %in% valuelist
>>>>>>> which is in line with writing
>>>>>>>>     value1 != value2
>>>>>>> instead of
>>>>>>>>     ! value1 == value2
>>>>>>> I was not able to devise any reasonable way that such inclusion
>>>>>>     would break
>>>>>>> any already existing heritage code unless that operator would be
>>>>>>     defined
>>>>>>> otherwisely and it would improve (however marginally) the
>>>>>>     readability of
>>>>>>> future code by its intuitive interpretation and by stitching
>>>>>>     together two
>>>>>>> operators that currently stand apart each other.
>>>>>>>
>>>>>>> So, if this suggestion was not already proposed and if it is seen as
>>>>>>> useful, I would like to include it in the wishlist in Bugzilla.
>>>>>>>
>>>>>>> I would appreciate any feedback, be it critic or support, and I
>>>>>>     hope I have
>>>>>>> not crossed any communicational rule from the group.
>>>>>>>
>>>>>>> Many thanks!  ?
>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>> Marcelo Ventura Freire
>>>>>>> Escola de Artes, Ci?ncias e Humanidades
>>>>>>> Universidade de S?o Paulo
>>>>>>> Av. Arlindo Bettio, 1000,
>>>>>>> Sala Paulo Freire (Sala Coletiva 252), Pr?dio I1
>>>>>>> Ermelino Matarazzo, S?o Paulo, SP, Brasil
>>>>>>> CEP 03828-000
>>>>>>> Tel.: (11) 3091-8894
>>>>>>>
>>>>>>>       [[alternative HTML version deleted]]
>>>>>>>
>>>>>>> ______________________________________________
>>>>>>> R-devel at r-project.org <mailto:R-devel at r-project.org> mailing list
>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel <https://
>>>>>>     stat.ethz.ch/mailman/listinfo/r-devel>
>>>>>>
>>>>> ______________________________________________
>>>>> R-devel at r-project.org mailing list
>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
	[[alternative HTML version deleted]]


From j@g@nmn2 @end|ng |rom gm@||@com  Fri Dec 12 14:49:20 2025
From: j@g@nmn2 @end|ng |rom gm@||@com (Mikael Jagan)
Date: Fri, 12 Dec 2025 08:49:20 -0500
Subject: [Rd] S4 generic functions don't respect S3 class hierarchies.
In-Reply-To: <mailman.55140.7.1765537201.52040.r-devel@r-project.org>
References: <mailman.55140.7.1765537201.52040.r-devel@r-project.org>
Message-ID: <df727324-d373-4a3b-8032-7e1acd21afa1@gmail.com>

S4 is "formal", so you need to declare inheritance:

     setOldClass(c("SubClass", "SuperClass"))

This usage (first argument of length greater than one) is documented by
help("setOldClass") including among the examples where analogously I see

     setOldClass(c("mlm", "lm"))

and there are more examples in the list of old classes defined by 'methods',
exported as '.OldClassesList'.

Mikael


> Date: Thu, 11 Dec 2025 17:10:28 -0500
> From: Russell Almond<russell.g.almond at gmail.com>
> 
> I noticed this problem while working with R6 objects, but I can
> reproduce it using S3 classes.
> 
> If I define a method on the S3 superclass, the subclass doesn't inherit it.
> 
> ``` r
> library(methods)
> 
> SuperClass <- function(n) {
>   ? result <- list(n=n)
>   ? class(result) <- "SuperClass"
>   ? result
> }
> 
> setOldClass("SuperClass")
> 
> setGeneric("sampleSize",function(x) {standardGeneric("sampleSize")})
> #> [1] "sampleSize"
> 
> setMethod("sampleSize","SuperClass", function(x) {x$n})
> 
> SubClass <- function (n) {
>   ? result <- SuperClass(n)
>   ? class(result) <- c("SubClass",class(result))
>   ? result
> }
> 
> setOldClass("SubClass")
> 
> example <- SubClass(7)
> class(example)
> #> [1] "SubClass"?? "SuperClass"
> is(example,"SuperClass")
> #> [1] TRUE
> methods("sampleSize")
> #> [1] sampleSize,SuperClass-method
> #> see '?methods' for accessing help and source code
> sampleSize(example)
> #> Error: unable to find an inherited method for function 'sampleSize'
> for signature 'x = "SubClass"'
> ```
> 
> <sup>Created on 2025-12-11 with [reprex
> v2.1.1](https://reprex.tidyverse.org)</sup>
> 
> I'm using R 4.5.2 and the same version of methods.
> 
> Is this a bug?
> 
>   ??? --Russell
> 
> 
> -- Russell Almond https://ralmond.net/ [[alternative HTML version deleted]]


From ru@@e||@g@@|mond @end|ng |rom gm@||@com  Fri Dec 12 17:06:57 2025
From: ru@@e||@g@@|mond @end|ng |rom gm@||@com (Russell Almond)
Date: Fri, 12 Dec 2025 11:06:57 -0500
Subject: [Rd] S4 generic functions don't respect S3 class hierarchies.
In-Reply-To: <df727324-d373-4a3b-8032-7e1acd21afa1@gmail.com>
References: <mailman.55140.7.1765537201.52040.r-devel@r-project.org>
 <df727324-d373-4a3b-8032-7e1acd21afa1@gmail.com>
Message-ID: <07db38da-5c8c-4864-bba1-429086a17bc5@gmail.com>

Thanks.? That's helpful.? It also works in my use case with R6 classes, 
even if I don't include the "R6Class" in the setOldClass definition.

 ??? --Russell


On 12/12/25 08:49, Mikael Jagan wrote:
> S4 is "formal", so you need to declare inheritance:
>
> ??? setOldClass(c("SubClass", "SuperClass"))
>
> This usage (first argument of length greater than one) is documented by
> help("setOldClass") including among the examples where analogously I see
>
> ??? setOldClass(c("mlm", "lm"))
>
> and there are more examples in the list of old classes defined by 
> 'methods',
> exported as '.OldClassesList'.
>
> Mikael
>
>
>> Date: Thu, 11 Dec 2025 17:10:28 -0500
>> From: Russell Almond<russell.g.almond at gmail.com>
>>
>> I noticed this problem while working with R6 objects, but I can
>> reproduce it using S3 classes.
>>
>> If I define a method on the S3 superclass, the subclass doesn't 
>> inherit it.
>>
>> ``` r
>> library(methods)
>>
>> SuperClass <- function(n) {
>> ? ? result <- list(n=n)
>> ? ? class(result) <- "SuperClass"
>> ? ? result
>> }
>>
>> setOldClass("SuperClass")
>>
>> setGeneric("sampleSize",function(x) {standardGeneric("sampleSize")})
>> #> [1] "sampleSize"
>>
>> setMethod("sampleSize","SuperClass", function(x) {x$n})
>>
>> SubClass <- function (n) {
>> ? ? result <- SuperClass(n)
>> ? ? class(result) <- c("SubClass",class(result))
>> ? ? result
>> }
>>
>> setOldClass("SubClass")
>>
>> example <- SubClass(7)
>> class(example)
>> #> [1] "SubClass"?? "SuperClass"
>> is(example,"SuperClass")
>> #> [1] TRUE
>> methods("sampleSize")
>> #> [1] sampleSize,SuperClass-method
>> #> see '?methods' for accessing help and source code
>> sampleSize(example)
>> #> Error: unable to find an inherited method for function 'sampleSize'
>> for signature 'x = "SubClass"'
>> ```
>>
>> <sup>Created on 2025-12-11 with [reprex
>> v2.1.1](https://reprex.tidyverse.org)</sup>
>>
>> I'm using R 4.5.2 and the same version of methods.
>>
>> Is this a bug?
>>
>> ? ??? --Russell
>>
>>
>> -- Russell Almond https://ralmond.net/ [[alternative HTML version 
>> deleted]]
>
-- 
Russell Almond
https://ralmond.net/

	[[alternative HTML version deleted]]


From reve||e @end|ng |rom northwe@tern@edu  Sat Dec 13 01:29:15 2025
From: reve||e @end|ng |rom northwe@tern@edu (William R Revelle)
Date: Sat, 13 Dec 2025 00:29:15 +0000
Subject: [Rd] help with revdepcheck
Message-ID: <02DD01EB-CF28-4B3E-96E3-21296BFE5732@northwestern.edu>

Dear fellow developers.

I am trying to submit the latest version of psych and need to check the 294 reverse dependencies.  Normally,  I just run revdep_check() to do this.

But today I am being told I do not have the necessary tools to compile C


Here is  the error message:

fn <- "/Users/WR/Dropbox/Software/psych/"
> revdep_check(fn,num_workers=8)
?? CHECK ???????????????????????????????????????????????????????????????????????? 294 packages ??
[0/294] 00:00:05 | ETA:  ?s | (8) agriutilities [I], AID [I], ANOPA [I], apa7 [I], aplms [...Error: Could not find tools necessary to compile a package
Call `pkgbuild::check_build_tools(debug = TRUE)` to diagnose the problem.
> pkgbuild::check_build_tools(debug = TRUE)
Trying to compile a simple C file
Error: Could not find tools necessary to compile a package
Call `pkgbuild::check_build_tools(debug = TRUE)` to diagnose the problem.
rror: Could not find tools necessary to compile a package

R version 4.5.2 (2025-10-31)
Platform: aarch64-apple-darwin20
Running under: macOS Sequoia 15.7.3


Any help to fix this would be appreciated.

I am trying to meet the Dec 22 deadline for submission to CRAN.

Bill



William Revelle            personality-project.org/revelle.html
Board of Visitors Professor (Emeritus)
Department of Psychology         www.wcas.northwestern.edu/psych/
Northwestern University            www.northwestern.edu/
Use R for psychology                 personality-project.org/r
It is 89 seconds to midnight    www.thebulletin.org



	[[alternative HTML version deleted]]


From |kry|ov @end|ng |rom d|@root@org  Sat Dec 13 11:08:24 2025
From: |kry|ov @end|ng |rom d|@root@org (Ivan Krylov)
Date: Sat, 13 Dec 2025 13:08:24 +0300
Subject: [Rd] help with revdepcheck
In-Reply-To: <02DD01EB-CF28-4B3E-96E3-21296BFE5732@northwestern.edu>
References: <02DD01EB-CF28-4B3E-96E3-21296BFE5732@northwestern.edu>
Message-ID: <20251213130824.7b88f59f@Tarkus>

Dear Prof. Revelle,

? Sat, 13 Dec 2025 00:29:15 +0000
William R Revelle <revelle at northwestern.edu> ?????:

> I am trying to submit the latest version of psych and need to check
> the 294 reverse dependencies.  Normally,  I just run revdep_check()
> to do this.
> 
> But today I am being told I do not have the necessary tools to
> compile C

Indeed, it seems that out of the strong recursive reverse dependencies
of the 'psych' package, 27 need compilation:

tools::package_dependencies(
 'psych', reverse=TRUE, which = 'strong', recursive=TRUE
) -> revd
tools::CRAN_package_db() -> db
db |> subset(Package %in% revd$psych) |> with(
 Package[NeedsCompilation == 'yes']
) |> length()
# [1] 27

In order to run R CMD check for them, you'll need a working compiler.
Have you got Xcode installed? Is it possible for you to install Xcode
14.3? If you don't get a better answer here and there's no answer at
<https://mac.r-project.org/>, try asking at R-SIG-Mac at r-project.org.

-- 
Best regards,
Ivan


From @uh@rto_@nggono @end|ng |rom y@hoo@com  Sat Dec 13 14:02:28 2025
From: @uh@rto_@nggono @end|ng |rom y@hoo@com (Suharto Anggono Suharto Anggono)
Date: Sat, 13 Dec 2025 13:02:28 +0000 (UTC)
Subject: [Rd] Setting of "balanced" attribute by 'length<-.POSIXlt'
References: <978608012.443653.1765630948338.ref@mail.yahoo.com>
Message-ID: <978608012.443653.1765630948338@mail.yahoo.com>

In R 4.5.2 (not before), `length<-.POSIXlt` sets "balanced" attribute of the result to TRUE only ifisTRUE(attr(x, "balanced")) && value <= length(x) .

For 'value' that is not a whole number, it is possible that value > length(x) and the length of the result is still length(x).
Instead ofvalue <= length(x) ,it is better to usevalue < length(x) + 1(not length(x) + 1L as length(x) may be .Machine$integer.max)orvalue - length(x) < 1Lortrunc(value) <= length(x)orlength(r) <= length(x)orlength(r$year) <= length(x)(or other component of 'r').
By the way, `length<-.POSIXlt` should also use unCfillPOSIXlt(x) instead of unclass(x). For example, when the maximum component length is 3 and a component has length 1 and 'value' (the assigned length) is 2.
If unCfillPOSIXlt(x) is used and is assigned to 'x', length of any component can be used.
	[[alternative HTML version deleted]]


From h@w|ckh@m @end|ng |rom gm@||@com  Sat Dec 13 16:22:16 2025
From: h@w|ckh@m @end|ng |rom gm@||@com (Hadley Wickham)
Date: Sat, 13 Dec 2025 09:22:16 -0600
Subject: [Rd] help with revdepcheck
In-Reply-To: <20251213130824.7b88f59f@Tarkus>
References: <02DD01EB-CF28-4B3E-96E3-21296BFE5732@northwestern.edu>
 <20251213130824.7b88f59f@Tarkus>
Message-ID: <CABdHhvG5xv_hqYRFi7M5UUPsZKda5egSggNRxKNa-rL+YVZkeQ@mail.gmail.com>

Hmmm, in general you shouldn't need to build the binaries when you can just
download them from CRAN. So I'd start by figuring out why that's not
happening? Is your version of R out of date? Or has one of your reverse
dependencies just been submitted to CRAN and thus doesn't have a binary yet?

Hadley

On Sat, Dec 13, 2025 at 4:08?AM Ivan Krylov via R-devel <
r-devel at r-project.org> wrote:

> Dear Prof. Revelle,
>
> ? Sat, 13 Dec 2025 00:29:15 +0000
> William R Revelle <revelle at northwestern.edu> ?????:
>
> > I am trying to submit the latest version of psych and need to check
> > the 294 reverse dependencies.  Normally,  I just run revdep_check()
> > to do this.
> >
> > But today I am being told I do not have the necessary tools to
> > compile C
>
> Indeed, it seems that out of the strong recursive reverse dependencies
> of the 'psych' package, 27 need compilation:
>
> tools::package_dependencies(
>  'psych', reverse=TRUE, which = 'strong', recursive=TRUE
> ) -> revd
> tools::CRAN_package_db() -> db
> db |> subset(Package %in% revd$psych) |> with(
>  Package[NeedsCompilation == 'yes']
> ) |> length()
> # [1] 27
>
> In order to run R CMD check for them, you'll need a working compiler.
> Have you got Xcode installed? Is it possible for you to install Xcode
> 14.3? If you don't get a better answer here and there's no answer at
> <https://mac.r-project.org/>, try asking at R-SIG-Mac at r-project.org.
>
> --
> Best regards,
> Ivan
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


-- 
http://hadley.nz

	[[alternative HTML version deleted]]


From reve||e @end|ng |rom northwe@tern@edu  Sun Dec 14 00:13:49 2025
From: reve||e @end|ng |rom northwe@tern@edu (William R Revelle)
Date: Sat, 13 Dec 2025 23:13:49 +0000
Subject: [Rd] help with revdepcheck
In-Reply-To: <CABdHhvG5xv_hqYRFi7M5UUPsZKda5egSggNRxKNa-rL+YVZkeQ@mail.gmail.com>
References: <02DD01EB-CF28-4B3E-96E3-21296BFE5732@northwestern.edu>
 <20251213130824.7b88f59f@Tarkus>
 <CABdHhvG5xv_hqYRFi7M5UUPsZKda5egSggNRxKNa-rL+YVZkeQ@mail.gmail.com>
Message-ID: <DM6PR05MB43000FDEB1DD399B3A5EFB1CC2AFA@DM6PR05MB4300.namprd05.prod.outlook.com>

Ivan and Hadley,  et al.

Historically, (that is to say in June)  revdep_check flags those 27 as failures (can not check) but doesn't stop working.  Now, it just stops working with that error message.

My version of R is up to date (4.5.2) and I have installed the latest version of Mac OS.

I will try installing X-code.  I did not want to cross post to the Mac-group until i tried the developer group first.

Thanks.

Bill

________________________________
From: R-devel <r-devel-bounces at r-project.org> on behalf of Hadley Wickham <h.wickham at gmail.com>
Sent: Saturday, December 13, 2025 9:22 AM
To: Ivan Krylov <ikrylov at disroot.org>
Cc: r-devel at r-project.org <r-devel at r-project.org>
Subject: Re: [Rd] help with revdepcheck

Hmmm, in general you shouldn't need to build the binaries when you can just
download them from CRAN. So I'd start by figuring out why that's not
happening? Is your version of R out of date? Or has one of your reverse
dependencies just been submitted to CRAN and thus doesn't have a binary yet?

Hadley

On Sat, Dec 13, 2025 at 4:08?AM Ivan Krylov via R-devel <
r-devel at r-project.org> wrote:

> Dear Prof. Revelle,
>
> ? Sat, 13 Dec 2025 00:29:15 +0000
> William R Revelle <revelle at northwestern.edu> ?????:
>
> > I am trying to submit the latest version of psych and need to check
> > the 294 reverse dependencies.  Normally,  I just run revdep_check()
> > to do this.
> >
> > But today I am being told I do not have the necessary tools to
> > compile C
>
> Indeed, it seems that out of the strong recursive reverse dependencies
> of the 'psych' package, 27 need compilation:
>
> tools::package_dependencies(
>  'psych', reverse=TRUE, which = 'strong', recursive=TRUE
> ) -> revd
> tools::CRAN_package_db() -> db
> db |> subset(Package %in% revd$psych) |> with(
>  Package[NeedsCompilation == 'yes']
> ) |> length()
> # [1] 27
>
> In order to run R CMD check for them, you'll need a working compiler.
> Have you got Xcode installed? Is it possible for you to install Xcode
> 14.3? If you don't get a better answer here and there's no answer at
> <https://urldefense.com/v3/__https://mac.r-project.org/__;!!Dq0X2DkFhyF93HkjWTBQKhk!QmPWFRE70ORstrSQsQH62FBt6MbTmNQnFeWkrB3XVg7Qsp0wGi1et-wfliKHW7cpjkQiP-PAQi6s7BvgpR9280E$ >, try asking at R-SIG-Mac at r-project.org.
>
> --
> Best regards,
> Ivan
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://urldefense.com/v3/__https://stat.ethz.ch/mailman/listinfo/r-devel__;!!Dq0X2DkFhyF93HkjWTBQKhk!QmPWFRE70ORstrSQsQH62FBt6MbTmNQnFeWkrB3XVg7Qsp0wGi1et-wfliKHW7cpjkQiP-PAQi6s7BvgN5JNdqY$
>


--
https://urldefense.com/v3/__http://hadley.nz__;!!Dq0X2DkFhyF93HkjWTBQKhk!QmPWFRE70ORstrSQsQH62FBt6MbTmNQnFeWkrB3XVg7Qsp0wGi1et-wfliKHW7cpjkQiP-PAQi6s7BvgCgStUgA$

        [[alternative HTML version deleted]]

______________________________________________
R-devel at r-project.org mailing list
https://urldefense.com/v3/__https://stat.ethz.ch/mailman/listinfo/r-devel__;!!Dq0X2DkFhyF93HkjWTBQKhk!QmPWFRE70ORstrSQsQH62FBt6MbTmNQnFeWkrB3XVg7Qsp0wGi1et-wfliKHW7cpjkQiP-PAQi6s7BvgN5JNdqY$

	[[alternative HTML version deleted]]


From reve||e @end|ng |rom northwe@tern@edu  Sun Dec 14 00:31:33 2025
From: reve||e @end|ng |rom northwe@tern@edu (William R Revelle)
Date: Sat, 13 Dec 2025 23:31:33 +0000
Subject: [Rd] help with revdepcheck
In-Reply-To: <DM6PR05MB43000FDEB1DD399B3A5EFB1CC2AFA@DM6PR05MB4300.namprd05.prod.outlook.com>
References: <02DD01EB-CF28-4B3E-96E3-21296BFE5732@northwestern.edu>
 <20251213130824.7b88f59f@Tarkus>
 <CABdHhvG5xv_hqYRFi7M5UUPsZKda5egSggNRxKNa-rL+YVZkeQ@mail.gmail.com>
 <DM6PR05MB43000FDEB1DD399B3A5EFB1CC2AFA@DM6PR05MB4300.namprd05.prod.outlook.com>
Message-ID: <C85BC509-900C-4861-B3F6-AFC6D989C639@northwestern.edu>

Updating my X code was the secret.  

Thanks.

Bill

> On Dec 13, 2025, at 17:13, William R Revelle <revelle at northwestern.edu> wrote:
> 
> Ivan and Hadley,  et al.
> 
> Historically, (that is to say in June)  revdep_check flags those 27 as failures (can not check) but doesn't stop working.  Now, it just stops working with that error message.  
> 
> My version of R is up to date (4.5.2) and I have installed the latest version of Mac OS.  
> 
> I will try installing X-code.  I did not want to cross post to the Mac-group until i tried the developer group first.  
> 
> Thanks.
> 
> Bill
> 
> From: R-devel <r-devel-bounces at r-project.org> on behalf of Hadley Wickham <h.wickham at gmail.com>
> Sent: Saturday, December 13, 2025 9:22 AM
> To: Ivan Krylov <ikrylov at disroot.org>
> Cc: r-devel at r-project.org <r-devel at r-project.org>
> Subject: Re: [Rd] help with revdepcheck
>  Hmmm, in general you shouldn't need to build the binaries when you can just
> download them from CRAN. So I'd start by figuring out why that's not
> happening? Is your version of R out of date? Or has one of your reverse
> dependencies just been submitted to CRAN and thus doesn't have a binary yet?
> 
> Hadley
> 
> On Sat, Dec 13, 2025 at 4:08?AM Ivan Krylov via R-devel <
> r-devel at r-project.org> wrote:
> 
> > Dear Prof. Revelle,
> >
> > ? Sat, 13 Dec 2025 00:29:15 +0000
> > William R Revelle <revelle at northwestern.edu> ?????:
> >
> > > I am trying to submit the latest version of psych and need to check
> > > the 294 reverse dependencies.  Normally,  I just run revdep_check()
> > > to do this.
> > >
> > > But today I am being told I do not have the necessary tools to
> > > compile C
> >
> > Indeed, it seems that out of the strong recursive reverse dependencies
> > of the 'psych' package, 27 need compilation:
> >
> > tools::package_dependencies(
> >  'psych', reverse=TRUE, which = 'strong', recursive=TRUE
> > ) -> revd
> > tools::CRAN_package_db() -> db
> > db |> subset(Package %in% revd$psych) |> with(
> >  Package[NeedsCompilation == 'yes']
> > ) |> length()
> > # [1] 27
> >
> > In order to run R CMD check for them, you'll need a working compiler.
> > Have you got Xcode installed? Is it possible for you to install Xcode
> > 14.3? If you don't get a better answer here and there's no answer at
> > <https://urldefense.com/v3/__https://mac.r-project.org/__;!!Dq0X2DkFhyF93HkjWTBQKhk!QmPWFRE70ORstrSQsQH62FBt6MbTmNQnFeWkrB3XVg7Qsp0wGi1et-wfliKHW7cpjkQiP-PAQi6s7BvgpR9280E$ >, try asking at R-SIG-Mac at r-project.org.
> >
> > --
> > Best regards,
> > Ivan
> >
> > ______________________________________________
> > R-devel at r-project.org mailing list
> > https://urldefense.com/v3/__https://stat.ethz.ch/mailman/listinfo/r-devel__;!!Dq0X2DkFhyF93HkjWTBQKhk!QmPWFRE70ORstrSQsQH62FBt6MbTmNQnFeWkrB3XVg7Qsp0wGi1et-wfliKHW7cpjkQiP-PAQi6s7BvgN5JNdqY$
> >
> 
> 
> -- 
> https://urldefense.com/v3/__http://hadley.nz__;!!Dq0X2DkFhyF93HkjWTBQKhk!QmPWFRE70ORstrSQsQH62FBt6MbTmNQnFeWkrB3XVg7Qsp0wGi1et-wfliKHW7cpjkQiP-PAQi6s7BvgCgStUgA$
> 
>         [[alternative HTML version deleted]]
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://urldefense.com/v3/__https://stat.ethz.ch/mailman/listinfo/r-devel__;!!Dq0X2DkFhyF93HkjWTBQKhk!QmPWFRE70ORstrSQsQH62FBt6MbTmNQnFeWkrB3XVg7Qsp0wGi1et-wfliKHW7cpjkQiP-PAQi6s7BvgN5JNdqY$


William Revelle            personality-project.org/revelle.html
Board of Visitors Professor (Emeritus)
Department of Psychology         www.wcas.northwestern.edu/psych/
Northwestern University            www.northwestern.edu/
Use R for psychology                 personality-project.org/r
It is 89 seconds to midnight    www.thebulletin.org



