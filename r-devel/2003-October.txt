From nikko at hailmail.net  Wed Oct  1 00:04:37 2003
From: nikko at hailmail.net (Nicholas Lewin-Koh)
Date: Tue Sep 30 17:04:59 2003
Subject: [Rd] Adding Tk extensions to R for windows
In-Reply-To: <ju3jnvcb00l3kdu7hhm30u9jaj7eatk7n7@4ax.com>
References: <8CBAA121CEB4D5118CB200508BB2BBEF0317E9C0@xmx8lonib.lonib.commerzbank.com>
	<ju3jnvcb00l3kdu7hhm30u9jaj7eatk7n7@4ax.com>
Message-ID: <20030930150437.5FC763D5FE@www.fastmail.fm>

Hi,
There would be no real difference that I could see. Msys is just a
modified version of the bash shell that uses cygwin.dll . The msys set of
tools is more convient to use than the cygwin becuse you don't have to
worry about mingw being first in the path and such. There are some small
differences but basically msys is cygwin lite but customized for the
mingw compiler and more amenable to natively compiled tools.

Nicholas

On Tue, 30 Sep 2003 10:27:35 -0400, "Duncan Murdoch" <dmurdoch@pair.com>
said:
> On Tue, 30 Sep 2003 14:42:34 +0100, "Marsland, John"
> <John.Marsland@CommerzbankIB.com> wrote :
> 
> >My understanding is that MSYS was designed to provide a Minimal SYStem to
> >complement the Minimal GNU tools. So you can run the ./configure on windows
> >just the same as any unix variant and make as normal. I understand it uses
> >native libraries rather then the cygwin.dll .. so should be faster??? 
> 
> Just to clarify:  currently R doesn't use cygwin.dll, just some of the
> tools in the toolset for building R do.  So I doubt if there would be
> a big speedup if any, but it might simplify things. You can currently
> run ./configure on Windows, it just doesn't produce a configuration
> that works :-(.  Fixing this is one of my projects for the next
> release.
> 
> >This would completely remove the need for separate windows project (except
> >for any platform specific devices eg graphics, GUIs etc ... MSYS provides
> >extensions for the win32 API also) - in exactly the same way and the new Mac
> >osX/fink build works. 
> 
> Essentially the main current need for separate windows code is the
> device support and the GUI. There is a bit more than that (e.g.
> separate makefiles), which are basically remnants of the days when the
> toolset was less capable.  There are also some things which can be
> handled by #ifdef's in the standard code (e.g. loading dynamic
> libraries).
> 
> I will take a look at Msys after the 1.8.0 release.
> 
> Duncan Murdoch
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://www.stat.math.ethz.ch/mailman/listinfo/r-devel

From ihaka at stat.auckland.ac.nz  Wed Oct  1 08:45:41 2003
From: ihaka at stat.auckland.ac.nz (Ross Ihaka)
Date: Tue Sep 30 21:45:14 2003
Subject: [Rd] another dump/source problem?
In-Reply-To: <Pine.LNX.4.44.0309301928430.1170-100000@kleigh.nl>
References: <Pine.LNX.4.44.0309301928430.1170-100000@kleigh.nl>
Message-ID: <3F79DD65.3050502@stat.auckland.ac.nz>

Peter Kleiweg wrote:

> Is this a bug?

Yes.  If you look inside the saved file it contains

	..., call = dist(x = USArrests), ...

When this is reread, an attempt is made to evaluate the call.
Some kind of quoting is needed.

> I do this:
> 
>     library(mva)
>     data(USArrests)
>     d <- dist(USArrests)
>     dump("d", "tst")
>     q()
> 
> I restart R and do this:
> 
>     source("tst")
> 
> And I get:
> 
>     Error in as.matrix(x) : Object "USArrests" not found



-- 
Ross Ihaka                         Email:  ihaka@stat.auckland.ac.nz
Department of Statistics           Phone:  (64-9) 373-7599 x 85054
University of Auckland             Fax:    (64-9) 373-7018
Private Bag 92019, Auckland
New Zealand

From Steve.Taylor at nz.towerlimited.com  Wed Oct  1 00:50:04 2003
From: Steve.Taylor at nz.towerlimited.com (Steve.Taylor@nz.towerlimited.com)
Date: Tue Sep 30 23:49:28 2003
Subject: [Rd] eigin of matrix of NaNs (PR#4366)
Message-ID: <200309302150.h8ULo40P023116@pubhealth.ku.dk>

Full_Name: Steve Taylor
Version: rw1071
OS: Windows NT 4
Submission from: (NULL) (203.98.50.22)


eigen(matrix(NaN,2,2)) causes R to lock up and stop responding

From maechler at stat.math.ethz.ch  Wed Oct  1 01:12:48 2003
From: maechler at stat.math.ethz.ch (maechler@stat.math.ethz.ch)
Date: Wed Oct  1 00:12:18 2003
Subject: [Rd] eigin of matrix of NaNs (PR#4366)
Message-ID: <200309302212.h8UMCm0P023196@pubhealth.ku.dk>

>>>>> "Steve" == Steve Taylor <Steve.Taylor@nz.towerlimited.com>
>>>>>     on Tue, 30 Sep 2003 23:50:04 +0200 (MET DST) writes:

    Steve> Full_Name: Steve Taylor Version: rw1071 OS: Windows
    Steve> NT 4 Submission from: (NULL) (203.98.50.22)


    Steve> eigen(matrix(NaN,2,2)) causes R to lock up and stop
    Steve> responding

Confirmed for R 1.7.1 on Linux.
The good news is that the bug seems to have been fixed
'inadvertently' already, as it is not showing in R-1.8.0beta
anymore. 

Thank you anyway for the report!

Martin Maechler <maechler@stat.math.ethz.ch>	http://stat.ethz.ch/~maechler/
Seminar fuer Statistik, ETH-Zentrum  LEO C16	Leonhardstr. 27
ETH (Federal Inst. Technology)	8092 Zurich	SWITZERLAND
phone: x-41-1-632-3408		fax: ...-1228			<><

From wettenhall at wehi.edu.au  Wed Oct  1 13:55:17 2003
From: wettenhall at wehi.edu.au (James Wettenhall)
Date: Wed Oct  1 04:54:46 2003
Subject: [Rd] Building R for windows (was Adding Tk Extensions...)
In-Reply-To: <8CBAA121CEB4D5118CB200508BB2BBEF0317E9BC@xmx8lonib.lonib.commerzbank.com>
Message-ID: <Pine.LNX.4.44.0310011242230.22303-100000@unix28.alpha.wehi.edu.au>

On Tue, 30 Sep 2003, Marsland, John wrote:
> Have you tried to make R under MSYS/MinGW, there would seem to be some
> obvious benefits to this over the current collection of Cygwin tools?

Yes I've tried, but the only way I've succeded in building R for 
Windows is by following Brian Ripley's instructions (i.e. using 
the collection you mentioned) :
http://www.stats.ox.ac.uk/pub/Rtools/

In MSYS, sh.exe and make.exe seem to behave differently from the 
Rtools versions, causing problems which I don't know how to solve.  

Regards,
James

From maechler at stat.math.ethz.ch  Wed Oct  1 11:24:17 2003
From: maechler at stat.math.ethz.ch (maechler@stat.math.ethz.ch)
Date: Wed Oct  1 10:23:39 2003
Subject: [Rd] colours in dotchart (PR#4343)
Message-ID: <200310010824.h918OH0P026696@pubhealth.ku.dk>

>>>>> "UweL" == Uwe Ligges <ligges@statistik.uni-dortmund.de>
>>>>>     on Mon, 29 Sep 2003 14:36:50 +0200 (MET DST) writes:

    >> i.wilson@maths.abdn.ac.uk wrote:
    >> 
    >> 
    >>> Problem:  neither fg or bg
    >>> nor color work properly in dotchart.
    >>> 
    >>> version:  R-1.7.1 for windows
    >>> 
    >>> code which shows the errors:
    >>> 
    >>> x <-
    >>> 
    >> 
    >> matrix(rnorm(16),ncol=2,dimnames=list(paste("a",1:8,sep=""),c("before","afte
    >> 
    >>> r")))
    >>> dotchart(x,fg="blue",bg="lightgrey")
    >> 
    >> 
    >> That's *not* a bug! It is not documented that *all* graphical parameters
    >> known from par() do work in dotchart() or any other high-level function
    >> (you won't find many!).
    >> 
    >> Instead, use
    >> 
    >> par(fg = "blue", bg = "lightgrey")
    >> dotchart(x)
    >> 
    >> 
    >> 
    >>> dotchart(x,color=c("red","blue"))
    >> 
    >> 
    >> That's *not* a bug! "color" is recycled, but in another way than you
    >> expected.
    >> 
    >> Instead, use
    >> 
    >> dotchart(x, color = rep(c("red", "blue"), each = nrow(x)))
    >> 
    >> 
    >> Please do submit bug reports if you are sure that's a bug. For questions
    >> use the mailinglist r-help, please.
    >> 
    >> 
    >> Uwe Ligges


    UweL> Thanks to Ian Wilson who pointed out in a private
    UweL> message that my first shot was wrong (Sorry!):

less wrong than you say here, excuse but
your first answer was better, Uwe, namely
  >> Instead, use
  >> 
  >> par(fg = "blue", bg = "lightgrey")
  >> dotchart(x)

    UweL> a) Indeed, it is documented that dotchart() supports
    UweL> an argument "bg".  Is it really meant as background
    UweL> colour of the whole plot? 

No! It's not!  It's meant (and used!) as  `bg' argument to
points -- see the lightblue inner color of points in
example(points).  
The only bug here is the `bg' argument documentation in
dotchart.Rd  {well, and the basic design "infelicity" of using
	      "bg" with two different meanings in R graphics ;-)}

    UweL> colour of the whole plot? I's propose to either remove
    UweL> that argument, or implement it to fill the whole
    UweL> background of the plot (as in the proposal below), or
    UweL> document it in a way that tells us it's only expected
    UweL> to fill emtpy plotting characters.

(proposal rejected, see above)


    UweL> b) The argument "color" works for the points, but not so for their 
    UweL> labels. The proposal (by Ian) is to remove the loops. Does that break 
    UweL> anything? At least, I cannot imagine any point right now.

I think you (Ian & Uwe) have a good point here.
This might (or may not) still go as a "trivial bug fix" for 1.8.0.
{If you want to help, please try to use "diff -u" (or "diff -c")
for a patch.. }
But I first need to get my grips on dendrogram buggyness.

Martin

From John.Marsland at CommerzbankIB.com  Wed Oct  1 11:32:58 2003
From: John.Marsland at CommerzbankIB.com (Marsland, John)
Date: Wed Oct  1 11:32:23 2003
Subject: [Rd] Adding Tk extensions to R for windows
Message-ID: <8CBAA121CEB4D5118CB200508BB2BBEF0317E9C4@xmx8lonib.lonib.commerzbank.com>

I'd be interested in the detail of what you linked to to get Rpvm working on
Windows. 

I've had a go at this using both the source and the binaries on windows. The
problem I had was I don't have rsh only Openssh which I managed to get
working on linux (client & server) in minutes with pvm. The attraction of
MSYS was partly that it includes ssh in the DTK, since I need a wholey
open-source solution.

> -----Original Message-----
> From: Simon Urbanek [mailto:simon.urbanek@math.uni-augsburg.de]
> Sent: 30 September 2003 18:43
> To: Marsland, John
> Cc: 'Duncan Murdoch'; r-devel@stat.math.ethz.ch
> Subject: Re: [Rd] Adding Tk extensions to R for windows
> 
> 
> On Tuesday, September 30, 2003, at 03:42 PM, Marsland, John wrote:
> 
> > necessary for win32 systems. I got more interested when I started 
> > thinking
> > about Rpvm and all the spare win32 boxes sitting around - 
> curently this
> > package only works for unix/linux systems. My guess is that 
> an awful 
> > lot
> > more of the R project could be made non-platform-specific if this 
> > route is
> > followed.
> 
> FYI: Rpvm itself is fairly platform-independent. I had a quick glance 
> at rpvm on Win32 quite recently. It compiled fine, the only serious 
> problem I had was at link-time due to the fact that PVM itself has no 
> shared library that could be easily used with MinGW (talking 
> about the 
> official binary version). Rpvm needed hardly any touchups. Presumably 
> compiling PVM with MinGW should solve the issue and rpvm should work 
> almost out of the box. Actually this shows that R makes it 
> possible for 
> developers to 'accidentally' produce packages that work on 
> Windows even 
> though they were developed for unix machines ;).
> 
> Cheers,
> Simon
> 


********************************************************************** 
This is a commercial communication from Commerzbank AG.\ \ T...{{dropped}}

From ligges at statistik.uni-dortmund.de  Wed Oct  1 12:33:40 2003
From: ligges at statistik.uni-dortmund.de (ligges@statistik.uni-dortmund.de)
Date: Wed Oct  1 11:33:00 2003
Subject: [Rd] colours in dotchart (PR#4343)
Message-ID: <200310010933.h919Xe0P028060@pubhealth.ku.dk>

Martin Maechler wrote:

>>>>>>"UweL" == Uwe Ligges <ligges@statistik.uni-dortmund.de>
>>>>>>    on Mon, 29 Sep 2003 14:36:50 +0200 (MET DST) writes:
> 
> 
>     >> i.wilson@maths.abdn.ac.uk wrote:
>     >> 
>     >> 
>     >>> Problem:  neither fg or bg
>     >>> nor color work properly in dotchart.
>     >>> 
>     >>> version:  R-1.7.1 for windows
>     >>> 
>     >>> code which shows the errors:
>     >>> 
>     >>> x <-
>     >>> 
>     >> 
>     >> matrix(rnorm(16),ncol=2,dimnames=list(paste("a",1:8,sep=""),c("before","afte
>     >> 
>     >>> r")))
>     >>> dotchart(x,fg="blue",bg="lightgrey")
>     >> 
>     >> 
>     >> That's *not* a bug! It is not documented that *all* graphical parameters
>     >> known from par() do work in dotchart() or any other high-level function
>     >> (you won't find many!).
>     >> 
>     >> Instead, use
>     >> 
>     >> par(fg = "blue", bg = "lightgrey")
>     >> dotchart(x)
>     >> 
>     >> 
>     >> 
>     >>> dotchart(x,color=c("red","blue"))
>     >> 
>     >> 
>     >> That's *not* a bug! "color" is recycled, but in another way than you
>     >> expected.
>     >> 
>     >> Instead, use
>     >> 
>     >> dotchart(x, color = rep(c("red", "blue"), each = nrow(x)))
>     >> 
>     >> 
>     >> Please do submit bug reports if you are sure that's a bug. For questions
>     >> use the mailinglist r-help, please.
>     >> 
>     >> 
>     >> Uwe Ligges
> 
> 
>     UweL> Thanks to Ian Wilson who pointed out in a private
>     UweL> message that my first shot was wrong (Sorry!):
> 
> less wrong than you say here, excuse but
> your first answer was better, Uwe, namely
>   >> Instead, use
>   >> 
>   >> par(fg = "blue", bg = "lightgrey")
>   >> dotchart(x)
> 
>     UweL> a) Indeed, it is documented that dotchart() supports
>     UweL> an argument "bg".  Is it really meant as background
>     UweL> colour of the whole plot? 
> 
> No! It's not!  It's meant (and used!) as  `bg' argument to
> points -- see the lightblue inner color of points in
> example(points).  
> The only bug here is the `bg' argument documentation in
> dotchart.Rd  {well, and the basic design "infelicity" of using
> 	      "bg" with two different meanings in R graphics ;-)}
> 
>     UweL> colour of the whole plot? I's propose to either remove
>     UweL> that argument, or implement it to fill the whole
>     UweL> background of the plot (as in the proposal below), or
>     UweL> document it in a way that tells us it's only expected
>     UweL> to fill emtpy plotting characters.
> 
> (proposal rejected, see above)
> 
> 
>     UweL> b) The argument "color" works for the points, but not so for their 
>     UweL> labels. The proposal (by Ian) is to remove the loops. Does that break 
>     UweL> anything? At least, I cannot imagine any point right now.
> 
> I think you (Ian & Uwe) have a good point here.
> This might (or may not) still go as a "trivial bug fix" for 1.8.0.
> {If you want to help, please try to use "diff -u" (or "diff -c")
> for a patch.. }
> But I first need to get my grips on dendrogram buggyness.
> 
> Martin


So here's a proposal for dotchart.R (Anyone who can imagine why the loop 
had been introduced? Are we breaking anything when rempoving the loop?):


@@ -67,9 +67,8 @@
      linch <- max(strwidth(labels, "inch"), na.rm = TRUE)
      loffset <- (linch + 0.1)/lheight
      labs <- labels[o]
-    for(i in 1:n)
-        mtext(labs[i], side = 2, line = loffset, at = y[i], adj = 0,
-          col = color, las = 2, cex = cex, ...)
+    mtext(labs, side = 2, line = loffset, at = y, adj = 0,
+        col = color, las = 2, cex = cex, ...)
      }
      abline(h = y, lty = "dotted", col = lcolor)
      points(x, y, pch = pch, col = color, bg = bg)
@@ -77,9 +76,8 @@
      gpos <- rev(cumsum(rev(tapply(groups, groups, length)) + 2) - 1)
      ginch <- max(strwidth(glabels, "inch"), na.rm = TRUE)
      goffset <- (max(linch+0.2, ginch, na.rm = TRUE) + 0.1)/lheight
-    for(i in 1:nlevels(groups))
-        mtext(glabels[i], side = 2, line = goffset, at = gpos[i],
-          adj = 0, col = gcolor, las = 2, cex = cex, ...)
+    mtext(glabels, side = 2, line = goffset, at = gpos,
+        adj = 0, col = gcolor, las = 2, cex = cex, ...)
      if (!is.null(gdata)) {
          abline(h = gpos, lty = "dotted")
          points(gdata, gpos, pch = gpch, col = gcolor, bg = bg, ...)



an one for dotchart.Rd:


@@ -31,7 +31,9 @@
    \item{pch}{the plotting character or symbol to be used.}
    \item{gpch}{the plotting character or symbol to be used for group
      values.}
-  \item{bg}{the background color to be used.}
+  \item{bg}{the background color of plotting characters or symbols to
+    be used; use \code{\link{par}} to set the background color of the
+    whole plot.}
    \item{color}{the color(s) to be used for points an labels.}
    \item{gcolor}{the single color to be used for group labels and
      values.}


Uwe Ligges

From nali at biostat.umn.edu  Wed Oct  1 11:56:20 2003
From: nali at biostat.umn.edu (Na Li)
Date: Wed Oct  1 17:55:30 2003
Subject: rpvm for win32 (was: Re: [Rd] Adding Tk extensions to R for windows)
In-Reply-To: <95E164E4-F36D-11D7-B2E8-000A959F327E@math.uni-augsburg.de> (Simon
	Urbanek's message of "Tue, 30 Sep 2003 19:43:22 +0200")
References: <95E164E4-F36D-11D7-B2E8-000A959F327E@math.uni-augsburg.de>
Message-ID: <7zoex1rly3.fsf@qiuranke.phony.umn.edu>

On 30 Sep 2003, Simon Urbanek told this:

>  On Tuesday, September 30, 2003, at 03:42 PM, Marsland, John wrote:
>  
> > necessary for win32 systems. I got more interested when I started
> > thinking about Rpvm and all the spare win32 boxes sitting around -
> > curently this package only works for unix/linux systems. My guess is that
> > an awful lot more of the R project could be made non-platform-specific if
> > this route is followed.
>
>  FYI: Rpvm itself is fairly platform-independent. I had a quick glance at
>  rpvm  on Win32 quite recently. It compiled fine, the only serious problem I
>  had  was  at link-time due to the fact that PVM itself has no shared library
>  that could  be easily used with MinGW (talking about the official binary
>  version). Rpvm  needed hardly any touchups. Presumably compiling PVM with
>  MinGW should solve  the issue and rpvm should work almost out of the
>  box.

It is unfortunately not that easy.  

It should be possible to link rpvm with the .dll from the official PVM win32
port.  (Lately Mingw gcc is said to be able to link directly with DLLs (pure C
library, that is) produced from VC++ out of the box.  At the very least, it is
possible to make a .dll.a import library.)

However, the official PVM-win32 uses rsh and this "feature" is built in. Two
"supported" rshd for win32 are shareware.

Naturally one wants to use (a free) ssh instead. Now after some hacking on the
PVM source to remove the built-in feature, one can:

1. compile PVM under cygwin, using OpenSSH for cygwin.  However this will
make the rpvm/R dependent upon cygwin.dll which is not desirable.

2. compile PVM under mingw, using OpenSSH for cygwin.  But the resulted pvmd
recognizes only Win32 path names whereas cygwin sshd and bash recognize POSIX
path names.  I have yet figured out a way of dealing this.  Are there "native"
(and free) sshd port for win32?  

(I don't have (easy) access to windoze boxes anymore (lucky me!) so I can't
investigate this further.)

Michael

From c.duering at threads.de  Wed Oct  1 23:48:24 2003
From: c.duering at threads.de (c.duering@threads.de)
Date: Wed Oct  1 22:48:48 2003
Subject: [Rd] wrong results in dist.binary (library ade4) (PR#4384)
Message-ID: <200310012048.h91KmO0P005559@pubhealth.ku.dk>

Full_Name: Christian Düring
Version: 1.6.2
OS: win32
Submission from: (NULL) (62.224.59.150)


Function dist.binary in add-on library ade4 yields wrong results due to wrong
association of method number and index formula. 
Examples: 
method=6 should be 5 (S7, Soerensen index)
method=7 should be 6 (S9 index)
Ochiai index is missing

Same in current version of ade4 (ade4_1.04.zip).

From gregory_r_warnes at groton.pfizer.com  Thu Oct  2 09:46:09 2003
From: gregory_r_warnes at groton.pfizer.com (gregory_r_warnes@groton.pfizer.com)
Date: Thu Oct  2 08:45:28 2003
Subject: [Rd] warnings() generates error if there never were any (PR#4389)
Message-ID: <200310020646.h926k90P008024@pubhealth.ku.dk>

This message is in MIME format. Since your mail reader does not understand
this format, some or all of this message may not be legible.

------_=_NextPart_000_01C388B0.D441A780
Content-Type: text/plain; charset="iso-8859-1"


In debugging a long-running function where I occasionally call warnings() to
write out any warnings that have occurred, I discovered that calling
warnings() before any warnings have ever been generated causes an error:

> warnings()
Error in warnings() : Object "last.warning" not found


The problem is that warnings() attemts to check the length of the variable
'last.warning' without first checking for its existance.  

This problem exists in R 1.7.1 as well as in the new 1.8.0 beta code.

A simple patch fixes the problem:

--- warnings.R.orig     2003-10-02 02:35:04.359451000 -0400
+++ warnings.R  2003-10-02 02:42:08.900717000 -0400
@@ -1,6 +1,6 @@
 warnings <- function(...)
 {
-    if(!(n <- length(last.warning)))
+    if(!exists("last.warning") || !(n <- length(last.warning)))
        return()
     names <- names(last.warning)
     cat("Warning message", if(n > 1)"s", ":\n", sep="")


-Greg



LEGAL NOTICE\ Unless expressly stated otherwise, this messag...{{dropped}}

From ligges at statistik.uni-dortmund.de  Thu Oct  2 10:05:55 2003
From: ligges at statistik.uni-dortmund.de (Uwe Ligges)
Date: Thu Oct  2 09:04:22 2003
Subject: [Rd] wrong results in dist.binary (library ade4) (PR#4384)
In-Reply-To: <200310012048.h91KmO0P005559@pubhealth.ku.dk>
References: <200310012048.h91KmO0P005559@pubhealth.ku.dk>
Message-ID: <3F7BCE53.30806@statistik.uni-dortmund.de>

c.duering@threads.de wrote:

> Full_Name: Christian D?ring
> Version: 1.6.2

[Outdated versions are not appropiate for bug reports - irrelevant here,
though.]

> OS: win32
> Submission from: (NULL) (62.224.59.150)
> 
> 
> Function dist.binary in add-on library ade4 yields wrong results due to wrong
> association of method number and index formula. 
> Examples: 
> method=6 should be 5 (S7, Soerensen index)
> method=7 should be 6 (S9 index)
> Ochiai index is missing
> 
> Same in current version of ade4 (ade4_1.04.zip).
> 

Please do report bugs of contributed packages to the package maintainer,
but *not* to R-Bugs.

Uwe Ligges

From maechler at stat.math.ethz.ch  Thu Oct  2 10:36:22 2003
From: maechler at stat.math.ethz.ch (maechler@stat.math.ethz.ch)
Date: Thu Oct  2 09:35:40 2003
Subject: [Rd] colours in dotchart (PR#4343)
Message-ID: <200310020736.h927aM0P008861@pubhealth.ku.dk>

>>>>> "UweL" == Uwe Ligges <ligges@statistik.uni-dortmund.de>
>>>>>     on Wed, 1 Oct 2003 11:33:40 +0200 (MET DST) writes:

   ...

    UweL> b) The argument "color" works for the points, but not so for their 
    UweL> labels. The proposal (by Ian) is to remove the loops. Does that break 
    UweL> anything? At least, I cannot imagine any point right now.
    >> 
    >> I think you (Ian & Uwe) have a good point here.
    >> This might (or may not) still go as a "trivial bug fix" for 1.8.0.
    >> {If you want to help, please try to use "diff -u" (or "diff -c")
    >> for a patch.. }
    >> But I first need to get my grips on dendrogram buggyness.
    >> 
    >> Martin

    UweL> So here's a proposal for dotchart.R

I have committed it just now as "simple bug fix" to "R
1.8.0beta".

    UweL> (Anyone who can imagine why the loop had been
    UweL> introduced? Are we breaking anything when rempoving
    UweL> the loop?):

dotchart() is a very old R function and has a peculiar history.
It was there in the very first R version I think I have ever
seen (Jul 1995, pre alpha, no version number) -- however with text() {and
no for()} there. Later it was renamed to dotplot() {I don't know
why} and in Apr 2001 was renamed *back* to dotchart() in order
not to resolve a naming conflict with the lattice dotplot()
function. 

Here is the revision text {for dotplot.R back then} where Ross
changed from   " text(....) "  to    " for(.....) mtext(....) "

>> Revision 1.3 , Tue May 5 08:39:30 1998 UTC (5 years, 4 months ago) by ihaka
>> Branch: MAIN
>> Changes since 1.2: +88 -79 lines
> 
>> Fixes to dotplot code.  Updates to mtext and text.

Now, the graphical argument recycling has been in R from early
on (as a clear improvement over S-plus!), too, but not as
consistently as it became around version 1.2 or so, and
particularly not with mtext().  Hence I assume , the change from
text() to mtext() needed to introduce the for() loop back then.

(so far the archeological/historical account from digging in old stuff ..)

Martin Maechler <maechler@stat.math.ethz.ch>	http://stat.ethz.ch/~maechler/
Seminar fuer Statistik, ETH-Zentrum  LEO C16	Leonhardstr. 27
ETH (Federal Inst. Technology)	8092 Zurich	SWITZERLAND
phone: x-41-1-632-3408		fax: ...-1228			<><

From maechler at stat.math.ethz.ch  Thu Oct  2 10:55:09 2003
From: maechler at stat.math.ethz.ch (maechler@stat.math.ethz.ch)
Date: Thu Oct  2 09:54:27 2003
Subject: [Rd] warnings() generates error if there never were any (PR#4389)
Message-ID: <200310020755.h927t90P009313@pubhealth.ku.dk>

>>>>> "Greg" == gregory r warnes <gregory_r_warnes@groton.pfizer.com>
>>>>>     on Thu, 2 Oct 2003 08:46:09 +0200 (MET DST) writes:

    Greg> This message is in MIME format. Since your mail reader does not understand
    Greg> this format, some or all of this message may not be legible.

    Greg> ------_=_NextPart_000_01C388B0.D441A780
    Greg> Content-Type: text/plain; charset="iso-8859-1"

[ please  *never*  attach anything for bug reports.
  The current bug-management system messes up the MIME ] 


    Greg> In debugging a long-running function where I
    Greg> occasionally call warnings() to write out any warnings
    Greg> that have occurred, I discovered that calling
    Greg> warnings() before any warnings have ever been
    Greg> generated causes an error:

    >> warnings()
    Greg> Error in warnings() : Object "last.warning" not found


    Greg> The problem is that warnings() attemts to check the
    Greg> length of the variable 'last.warning' without first
    Greg> checking for its existance.

    Greg> This problem exists in R 1.7.1 as well as in the new 1.8.0 beta code.

    Greg> A simple patch fixes the problem:

    Greg> --- warnings.R.orig     2003-10-02 02:35:04.359451000 -0400
    Greg> +++ warnings.R  2003-10-02 02:42:08.900717000 -0400
    Greg> @@ -1,6 +1,6 @@
    Greg> warnings <- function(...)
    Greg> {
    Greg> -    if(!(n <- length(last.warning)))
    Greg> +    if(!exists("last.warning") || !(n <- length(last.warning)))
    Greg> return()
    Greg> names <- names(last.warning)
    Greg> cat("Warning message", if(n > 1)"s", ":\n", sep="")

Thank you Greg!
Fortunately, this falls into the category of "trivial bug fix"
(it cannot break anything), and hence still goes into 1.8.0

Martin Maechler <maechler@stat.math.ethz.ch>	http://stat.ethz.ch/~maechler/
Seminar fuer Statistik, ETH-Zentrum  LEO C16	Leonhardstr. 27
ETH (Federal Inst. Technology)	8092 Zurich	SWITZERLAND
phone: x-41-1-632-3408		fax: ...-1228			<><

From e.pebesma at geog.uu.nl  Thu Oct  2 14:49:35 2003
From: e.pebesma at geog.uu.nl (Edzer J. Pebesma)
Date: Thu Oct  2 13:49:34 2003
Subject: [Rd] Are package maintainers responsible for name-mangling class
	names?
Message-ID: <3F7C10CF.6010406@geog.uu.nl>

The following came up when Roger Bivand and I discussed
R's name spaces and overlap in packages, in the bus to the
field trip during StatGIS, last Tuesday:

If two packages create the same class, say "variogram", and both
are loaded, then using a method for an object of class "variogram"
cannot discriminate between them and will call the method in the
package loaded last. See example below.

I know what is happening, but for average users this may be
extremely confusing, especially when loading the second package
does  not result in a warning that plot.variogram in the first
is masked (gstat uses name spaces and "exports" plot.variogram
through S3method(plot, variogram), geoR does not)

Shouldn't R know that objects created by functions in library x
prefer there methods to be picked from library x, rather than
the first in the search path? Isn't that one of the ideas behind
name spaces?

Shouldn't R give an error message when a loaded library
masks a method in another library, as it does when an object
is masked (such as it does when loading gstat after spatial)?

If we are not going to deal  with this, shouldn't CRAN
reject (for now?) packages that create new classes and
methods with names that are allready in other packages?
--
Edzer


Executing the following commands:

library(gstat)
data(meuse)
v = variogram(log(zinc)~1, ~x+y, meuse)
plot(v) # calls plot.variogram() in library gstat
library(geoR)
plot(v) # error: calls plot.variogram() in library geoR

gives the following output:

R> library(gstat)
Loading required package: lattice
Loading required package: grid

R> data(meuse)

R> v = variogram(log(zinc) ~ 1, ~x + y, meuse)

R> plot(v)

R> library(geoR)

-------------------------------------------------
geoR - functions for geostatistical data analysis
geoR version 1.3-16 (2003-09-17) is now loaded
-------------------------------------------------


R> plot(v)
Error in if (x$output.type == "bin") Ldots$type <- "p" :
        argument is of length zero
In addition: Warning message:
no finite arguments to max; returning -Inf

From tlumley at u.washington.edu  Thu Oct  2 07:56:46 2003
From: tlumley at u.washington.edu (Thomas Lumley)
Date: Thu Oct  2 15:56:19 2003
Subject: [Rd] Are package maintainers responsible for name-mangling class
	names?
In-Reply-To: <3F7C10CF.6010406@geog.uu.nl>
References: <3F7C10CF.6010406@geog.uu.nl>
Message-ID: <Pine.A41.4.58.0310020648540.71930@homer08.u.washington.edu>

On Thu, 2 Oct 2003, Edzer J. Pebesma wrote:

> The following came up when Roger Bivand and I discussed
> R's name spaces and overlap in packages, in the bus to the
> field trip during StatGIS, last Tuesday:
>
> If two packages create the same class, say "variogram", and both
> are loaded, then using a method for an object of class "variogram"
> cannot discriminate between them and will call the method in the
> package loaded last. See example below.
>
> I know what is happening, but for average users this may be
> extremely confusing, especially when loading the second package
> does  not result in a warning that plot.variogram in the first
> is masked (gstat uses name spaces and "exports" plot.variogram
> through S3method(plot, variogram), geoR does not)
>
> Shouldn't R know that objects created by functions in library x
> prefer there methods to be picked from library x, rather than
> the first in the search path? Isn't that one of the ideas behind
> name spaces?

I think this can only happen if method registration is compulsory (and if
you want S4 methods, you know where to find them).

> Shouldn't R give an error message when a loaded library
> masks a method in another library, as it does when an object
> is masked (such as it does when loading gstat after spatial)?
>

Yes.  I don't know whether this is an oversight or something that would be
nice but is too difficult.  I think it's unlikely to be fixed by next week
for 1.8.0, though.


> If we are not going to deal  with this, shouldn't CRAN
> reject (for now?) packages that create new classes and
> methods with names that are allready in other packages?

I hope not.  Note that it is probably not easy to come up with an
automated system that can distinguish a package that uses classes from other
packages from one that overrides classes from other packages.

	-thomas

Thomas Lumley			Assoc. Professor, Biostatistics
tlumley@u.washington.edu	University of Washington, Seattle

From andrew_zachary at yahoo.com  Wed Oct  1 22:24:01 2003
From: andrew_zachary at yahoo.com (andrew_zachary@yahoo.com)
Date: Thu Oct  2 17:53:44 2003
Subject: [Rd] Problem with console in Windows GUI (PR#4381)
Message-ID: <200310011924.h91JO00P005154@pubhealth.ku.dk>

Full_Name: Andrew Zachary
Version: 1.7.1
OS: XP Pro
Submission from: (NULL) (24.44.128.138)


The R-console window in the Windows GUI has a nice feature that lets you save
your preferences for font sizes and background and foreground colors. Unhappily,
there is no way to load these preferences back in when starting a new session.

Also, the scroll window for selecting colors is very small and awkward. If I
want to select a color which is towards the top or the bottom of the list, I
have to scrolls (slowly) through all the entries to get to it. Would make more
sense to have a color window with user-selectable colors.

Thanks!
Andrew Zachary

From andy_liaw at merck.com  Thu Oct  2 13:58:01 2003
From: andy_liaw at merck.com (Liaw, Andy)
Date: Thu Oct  2 18:57:33 2003
Subject: [Rd] Problem with console in Windows GUI (PR#4381)
Message-ID: <3A822319EB35174CA3714066D590DCD50205CC06@usrymx25.merck.com>

> From: andrew_zachary@yahoo.com [mailto:andrew_zachary@yahoo.com] 
> 
> Full_Name: Andrew Zachary
> Version: 1.7.1
> OS: XP Pro
> Submission from: (NULL) (24.44.128.138)
> 
> 
> The R-console window in the Windows GUI has a nice feature 
> that lets you save your preferences for font sizes and 
> background and foreground colors. Unhappily, there is no way 
> to load these preferences back in when starting a new session.

Have you not noticed the "Save" button?

Andy

 
> Also, the scroll window for selecting colors is very small 
> and awkward. If I want to select a color which is towards the 
> top or the bottom of the list, I have to scrolls (slowly) 
> through all the entries to get to it. Would make more sense 
> to have a color window with user-selectable colors.
> 
> Thanks!
> Andrew Zachary
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list 
> https://www.stat.math.ethz.ch/mailman/listinfo> /r-devel
>

From dmurdoch at pair.com  Thu Oct  2 21:39:58 2003
From: dmurdoch at pair.com (dmurdoch@pair.com)
Date: Thu Oct  2 20:39:16 2003
Subject: [Rd] Problem with console in Windows GUI (PR#4381)
Message-ID: <200310021839.h92Idw0P017880@pubhealth.ku.dk>

On Thu, 02 Oct 2003 12:58:01 -0400, "Liaw, Andy" <andy_liaw@merck.com>
wrote :

>> From: andrew_zachary@yahoo.com [mailto:andrew_zachary@yahoo.com] 

>> The R-console window in the Windows GUI has a nice feature 
>> that lets you save your preferences for font sizes and 
>> background and foreground colors. Unhappily, there is no way 
>> to load these preferences back in when starting a new session.
>
>Have you not noticed the "Save" button?

To expand on that:  by default, Save puts the preferences in a file
called Rconsole in the current directory; on startup, R looks for
Rconsole in the R_USER directory (which defaults to the current
directory), and if it doesn't find one there, in the R_HOME/etc
directory.

However, there's a bug in the current beta:  near the end it writes
out the lines

## Initial position of the graphics window
## (pixels, <0 values from opposite edge)
xgraphics = 
ygraphics = 

but it can't read those because of the missing values.  I'll try to
get that fixed for 1.8.0.
 
>> Also, the scroll window for selecting colors is very small 
>> and awkward. If I want to select a color which is towards the 
>> top or the bottom of the list, I have to scrolls (slowly) 
>> through all the entries to get to it. Would make more sense 
>> to have a color window with user-selectable colors.

That would make sense, but it's not likely to happen (and certainly
won't for 1.8.0):  we've more or less stopped adding features to the
current Rgui.  If I (or someone else) ever gets time, I intend to
replace it with an all new one.

Duncan Murdoch

From mittal at math.arizona.edu  Thu Oct  2 21:48:33 2003
From: mittal at math.arizona.edu (mittal@math.arizona.edu)
Date: Thu Oct  2 20:48:49 2003
Subject: [Rd] hist (PR#4395)
Message-ID: <200310021848.h92ImX0P017935@pubhealth.ku.dk>


It is not really a bug but a strange choice. When the option freq=F chosen, hist
should plot relative frequency. It plots proportional to relative frequency by
the factor of bin width. Is there a reason for this? A more normal choice seems
to be to have it independent of the bin width. 

Yash Mittal
University of Arizona


----------------------------------------------------------------
This message was sent using IMP, the Internet Messaging Program.

From zeileis at ci.tuwien.ac.at  Thu Oct  2 22:05:52 2003
From: zeileis at ci.tuwien.ac.at (Achim Zeileis)
Date: Thu Oct  2 21:05:29 2003
Subject: [Rd] hist (PR#4395)
In-Reply-To: <200310021848.h92ImX0P017935@pubhealth.ku.dk>
References: <200310021848.h92ImX0P017935@pubhealth.ku.dk>
Message-ID: <200310021905.h92J5ql8012250@thorin.ci.tuwien.ac.at>

On Thursday 02 October 2003 20:48, mittal@math.arizona.edu wrote:

> It is not really a bug but a strange choice.

So why do you file it as a bug?

> When the option freq=F
> chosen, hist should plot relative frequency. It plots proportional
> to relative frequency by the factor of bin width. Is there a reason
> for this?

Yes.

> A more normal choice seems to be to have it independent of the bin
> width.

No, because then the histogram could not be used as a "density 
estimate" which is possible if the relative frequencies are 
proportional to the are and not the height of the segments.
Z

From dmurdoch at pair.com  Thu Oct  2 17:08:38 2003
From: dmurdoch at pair.com (Duncan Murdoch)
Date: Thu Oct  2 22:08:07 2003
Subject: [Rd] hist (PR#4395)
In-Reply-To: <200310021848.h92ImX0P017935@pubhealth.ku.dk>
References: <200310021848.h92ImX0P017935@pubhealth.ku.dk>
Message-ID: <s41pnv4ji1bub6b9kkuhkqj4jfunlravhg@4ax.com>

On Thu, 2 Oct 2003 20:48:33 +0200 (MET DST), mittal@math.arizona.edu
wrote :

>
>It is not really a bug but a strange choice.

Please don't post discussion to r-bugs.  Each post to r-bugs ends up
in the bug repository, and requires manual handling.

> When the option freq=F chosen, hist
>should plot relative frequency. It plots proportional to relative frequency by
>the factor of bin width. Is there a reason for this? A more normal choice seems
>to be to have it independent of the bin width. 

No, that would result in misleading plots.  For example, if one bar is
twice as wide as another but they are the same height, then the
natural interpretation is that the wide bar represents twice as many
observations, or twice the probability.  This is the way densities
work, and is how histograms should work.  (However, since not everyone
interprets histograms this way, it's safest not to use variable width
bars.)

If you just want to plot some bars where the area of the bar has no
meaning, use barplot() instead of hist().

Duncan Murdoch

From ellis at stat.harvard.edu  Fri Oct  3 04:32:59 2003
From: ellis at stat.harvard.edu (ellis@stat.harvard.edu)
Date: Fri Oct  3 03:32:29 2003
Subject: [Rd] Leaving 'Package:' out of description deletes entire library
	(PR#4398)
Message-ID: <200310030133.h931Wx0P019681@pubhealth.ku.dk>

Full_Name: Byron Ellis
Version: R-devel (1.8.0)
OS: OS X
Submission from: (NULL) (209.150.60.78)


I recently left out the 'Package' field out of the DESCRIPTION file (yes, I know
about package.skeleton() ) only to discover that when you leave this out R CMD
INSTALL fails and _deletes the entire library_:

bash-2.05a$ R CMD INSTALL twclust
* Installing *source* package '' ...
Error in .installPackageDescription(".", "/Users/bellis/sandbox/R/library/") : 
        required fields missing from DESCRIPTION: Package
Execution halted
ERROR: installing package DESCRIPTION failed
** Removing '/Users/bellis/sandbox/R/library/'

From edd at debian.org  Fri Oct  3 15:17:31 2003
From: edd at debian.org (edd@debian.org)
Date: Fri Oct  3 14:16:43 2003
Subject: [Rd] Re: Bug#213857: r-base-core: xfig plot fails with invalid line
	type (PR#4401)
Message-ID: <200310031217.h93CHV0P026732@pubhealth.ku.dk>


Graham,

Confirmed. I will pass that along to the R team. As 1.8.0 is in code freeze,
this may not get addressed, unfortunately.

Regards, Dirk


On Fri, Oct 03, 2003 at 03:16:35PM +1000, Graham Williams wrote:
> Package: r-base-core
> Version: 1.7.1.cvs.20030927-1
> Severity: normal
> 
> 
> $ R
> 
> R : Copyright 2003, The R Development Core Team
> Version 1.8.0 beta (2003-09-27)
> 
> ...
> 
> > data(cars)
> > postscript("tmp.ps")
> > plot(cars)
> > xfig("tmp.fig", onefile=TRUE)
> > plot(cars)
> Error in plot.xy(xy, type, col = col, pch = pch, cex = cex, bg = bg, lty = lty,  : 
> 	invalid line type: must be length 2, 4, 6 or 8
> > 
> 
> No output is produced. 
> 
> Regards,
> Graham
> 
> -- System Information:
> Debian Release: testing/unstable
> Architecture: i386
> Kernel: Linux festiva.act.cmis.csiro.au 2.4.22-1-686 #4 Sun Sep 28 13:27:15 EST 2003 i686
> Locale: LANG=C, LC_CTYPE=C (ignored: LC_ALL set to C)
> 
> Versions of packages r-base-core depends on:
> ii  atlas2-base [atlas2]      3.2.1ln-11     Automatically Tuned Linear Algebra
> ii  libbz2-1.0                1.0.2-1        A high-quality block-sorting file 
> ii  libc6                     2.3.2-8        GNU C Library: Shared libraries an
> ii  libg2c0                   1:3.3.2-0pre4  Runtime library for GNU Fortran 77
> ii  libgcc1                   1:3.3.2-0pre4  GCC support library
> ii  libjpeg62                 6b-8           The Independent JPEG Group's JPEG 
> ii  libncurses5               5.3.20030719-2 Shared libraries for terminal hand
> ii  libpcre3                  4.3-3          Philip Hazel's Perl 5 Compatible R
> ii  libpng10-0                1.0.15-4       PNG library, older version - runti
> ii  libreadline4              4.3-5          GNU readline and history libraries
> ii  perl                      5.8.1-2        Larry Wall's Practical Extraction 
> ii  tcl8.4                    8.4.4-1        Tcl (the Tool Command Language) v8
> ii  tk8.4                     8.4.4-1        Tk toolkit for Tcl and X11, v8.4 -
> ii  xlibs                     4.2.1-11       X Window System client libraries
> ii  zlib-bin                  1:1.1.4-15     compression library - sample progr
> ii  zlib1g                    1:1.1.4-15     compression library - runtime
> 
> -- no debconf information
> 
> 
> 

-- 
Those are my principles, and if you don't like them... well, I have others.
                                                -- Groucho Marx

From bates at stat.wisc.edu  Fri Oct  3 14:28:40 2003
From: bates at stat.wisc.edu (Douglas Bates)
Date: Fri Oct  3 15:28:42 2003
Subject: [Rd] Re: Bug#213857: r-base-core: xfig plot fails with invalid
	line type (PR#4401)
In-Reply-To: <200310031217.h93CHV0P026732@pubhealth.ku.dk>
References: <200310031217.h93CHV0P026732@pubhealth.ku.dk>
Message-ID: <6rhe2q78lg.fsf@bates4.stat.wisc.edu>

edd@debian.org writes:

> Graham,
> 
> Confirmed. I will pass that along to the R team. As 1.8.0 is in code freeze,
> this may not get addressed, unfortunately.
> 
> Regards, Dirk

I believe Ross Ihaka has already detected and fixed this problem.  The
fix should be in today's beta version of R-1.8.0.  We hope it will
show up in the next Debian package Dirk makes for the unstable
(Debian) distribution.

> 
> 
> On Fri, Oct 03, 2003 at 03:16:35PM +1000, Graham Williams wrote:
> > Package: r-base-core
> > Version: 1.7.1.cvs.20030927-1
> > Severity: normal
> > 
> > 
> > $ R
> > 
> > R : Copyright 2003, The R Development Core Team
> > Version 1.8.0 beta (2003-09-27)
> > 
> > ...
> > 
> > > data(cars)
> > > postscript("tmp.ps")
> > > plot(cars)
> > > xfig("tmp.fig", onefile=TRUE)
> > > plot(cars)
> > Error in plot.xy(xy, type, col = col, pch = pch, cex = cex, bg = bg, lty = lty,  : 
> > 	invalid line type: must be length 2, 4, 6 or 8
> > > 
> > 
> > No output is produced. 
> > 
> > Regards,
> > Graham
> > 
> > -- System Information:
> > Debian Release: testing/unstable
> > Architecture: i386
> > Kernel: Linux festiva.act.cmis.csiro.au 2.4.22-1-686 #4 Sun Sep 28 13:27:15 EST 2003 i686
> > Locale: LANG=C, LC_CTYPE=C (ignored: LC_ALL set to C)
> > 
> > Versions of packages r-base-core depends on:
> > ii  atlas2-base [atlas2]      3.2.1ln-11     Automatically Tuned Linear Algebra
> > ii  libbz2-1.0                1.0.2-1        A high-quality block-sorting file 
> > ii  libc6                     2.3.2-8        GNU C Library: Shared libraries an
> > ii  libg2c0                   1:3.3.2-0pre4  Runtime library for GNU Fortran 77
> > ii  libgcc1                   1:3.3.2-0pre4  GCC support library
> > ii  libjpeg62                 6b-8           The Independent JPEG Group's JPEG 
> > ii  libncurses5               5.3.20030719-2 Shared libraries for terminal hand
> > ii  libpcre3                  4.3-3          Philip Hazel's Perl 5 Compatible R
> > ii  libpng10-0                1.0.15-4       PNG library, older version - runti
> > ii  libreadline4              4.3-5          GNU readline and history libraries
> > ii  perl                      5.8.1-2        Larry Wall's Practical Extraction 
> > ii  tcl8.4                    8.4.4-1        Tcl (the Tool Command Language) v8
> > ii  tk8.4                     8.4.4-1        Tk toolkit for Tcl and X11, v8.4 -
> > ii  xlibs                     4.2.1-11       X Window System client libraries
> > ii  zlib-bin                  1:1.1.4-15     compression library - sample progr
> > ii  zlib1g                    1:1.1.4-15     compression library - runtime
> > 
> > -- no debconf information
> > 
> > 
> > 
> 
> -- 
> Those are my principles, and if you don't like them... well, I have others.
>                                                 -- Groucho Marx
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://www.stat.math.ethz.ch/mailman/listinfo/r-devel

-- 
Douglas Bates                            bates@stat.wisc.edu
Statistics Department                    608/262-2598
University of Wisconsin - Madison        http://www.stat.wisc.edu/~bates/

From edd at debian.org  Fri Oct  3 10:21:29 2003
From: edd at debian.org (Dirk Eddelbuettel)
Date: Fri Oct  3 16:20:57 2003
Subject: [Rd] Re: Bug#213857: r-base-core: xfig plot fails with invalid
	line type (PR#4401)
In-Reply-To: <6rhe2q78lg.fsf@bates4.stat.wisc.edu>
References: <200310031217.h93CHV0P026732@pubhealth.ku.dk>
	<6rhe2q78lg.fsf@bates4.stat.wisc.edu>
Message-ID: <20031003142129.GA18244@sonny.eddelbuettel.com>

On Fri, Oct 03, 2003 at 08:29:31AM -0500, Douglas Bates wrote:
> edd@debian.org writes:
> 
> > Graham,
> > 
> > Confirmed. I will pass that along to the R team. As 1.8.0 is in code freeze,
> > this may not get addressed, unfortunately.
> > 
> > Regards, Dirk
> 
> I believe Ross Ihaka has already detected and fixed this problem.  The
> fix should be in today's beta version of R-1.8.0.  We hope it will
> show up in the next Debian package Dirk makes for the unstable
> (Debian) distribution.

Excellent news. I happened to have made releases on Saturday mornings for
the last five or six weeks, so I'll see how tomorrow's version behaves.

Thanks, Dirk

> 
> > 
> > 
> > On Fri, Oct 03, 2003 at 03:16:35PM +1000, Graham Williams wrote:
> > > Package: r-base-core
> > > Version: 1.7.1.cvs.20030927-1
> > > Severity: normal
> > > 
> > > 
> > > $ R
> > > 
> > > R : Copyright 2003, The R Development Core Team
> > > Version 1.8.0 beta (2003-09-27)
> > > 
> > > ...
> > > 
> > > > data(cars)
> > > > postscript("tmp.ps")
> > > > plot(cars)
> > > > xfig("tmp.fig", onefile=TRUE)
> > > > plot(cars)
> > > Error in plot.xy(xy, type, col = col, pch = pch, cex = cex, bg = bg, lty = lty,  : 
> > > 	invalid line type: must be length 2, 4, 6 or 8
> > > > 
> > > 
> > > No output is produced. 
> > > 
> > > Regards,
> > > Graham
> > > 
> > > -- System Information:
> > > Debian Release: testing/unstable
> > > Architecture: i386
> > > Kernel: Linux festiva.act.cmis.csiro.au 2.4.22-1-686 #4 Sun Sep 28 13:27:15 EST 2003 i686
> > > Locale: LANG=C, LC_CTYPE=C (ignored: LC_ALL set to C)
> > > 
> > > Versions of packages r-base-core depends on:
> > > ii  atlas2-base [atlas2]      3.2.1ln-11     Automatically Tuned Linear Algebra
> > > ii  libbz2-1.0                1.0.2-1        A high-quality block-sorting file 
> > > ii  libc6                     2.3.2-8        GNU C Library: Shared libraries an
> > > ii  libg2c0                   1:3.3.2-0pre4  Runtime library for GNU Fortran 77
> > > ii  libgcc1                   1:3.3.2-0pre4  GCC support library
> > > ii  libjpeg62                 6b-8           The Independent JPEG Group's JPEG 
> > > ii  libncurses5               5.3.20030719-2 Shared libraries for terminal hand
> > > ii  libpcre3                  4.3-3          Philip Hazel's Perl 5 Compatible R
> > > ii  libpng10-0                1.0.15-4       PNG library, older version - runti
> > > ii  libreadline4              4.3-5          GNU readline and history libraries
> > > ii  perl                      5.8.1-2        Larry Wall's Practical Extraction 
> > > ii  tcl8.4                    8.4.4-1        Tcl (the Tool Command Language) v8
> > > ii  tk8.4                     8.4.4-1        Tk toolkit for Tcl and X11, v8.4 -
> > > ii  xlibs                     4.2.1-11       X Window System client libraries
> > > ii  zlib-bin                  1:1.1.4-15     compression library - sample progr
> > > ii  zlib1g                    1:1.1.4-15     compression library - runtime
> > > 
> > > -- no debconf information
> > > 
> > > 
> > > 
> > 
> > -- 
> > Those are my principles, and if you don't like them... well, I have others.
> >                                                 -- Groucho Marx
> > 
> > ______________________________________________
> > R-devel@stat.math.ethz.ch mailing list
> > https://www.stat.math.ethz.ch/mailman/listinfo/r-devel
> 
> -- 
> Douglas Bates                            bates@stat.wisc.edu
> Statistics Department                    608/262-2598
> University of Wisconsin - Madison        http://www.stat.wisc.edu/~bates/
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://www.stat.math.ethz.ch/mailman/listinfo/r-devel
> 

-- 
Those are my principles, and if you don't like them... well, I have others.
                                                -- Groucho Marx

From edd at debian.org  Fri Oct  3 17:21:50 2003
From: edd at debian.org (edd@debian.org)
Date: Fri Oct  3 16:21:13 2003
Subject: [Rd] Re: Bug#213857: r-base-core: xfig plot fails with invalid
	line type (PR#4401)
Message-ID: <200310031421.h93ELo0P028607@pubhealth.ku.dk>

On Fri, Oct 03, 2003 at 08:29:31AM -0500, Douglas Bates wrote:
> edd@debian.org writes:
> 
> > Graham,
> > 
> > Confirmed. I will pass that along to the R team. As 1.8.0 is in code freeze,
> > this may not get addressed, unfortunately.
> > 
> > Regards, Dirk
> 
> I believe Ross Ihaka has already detected and fixed this problem.  The
> fix should be in today's beta version of R-1.8.0.  We hope it will
> show up in the next Debian package Dirk makes for the unstable
> (Debian) distribution.

Excellent news. I happened to have made releases on Saturday mornings for
the last five or six weeks, so I'll see how tomorrow's version behaves.

Thanks, Dirk

> 
> > 
> > 
> > On Fri, Oct 03, 2003 at 03:16:35PM +1000, Graham Williams wrote:
> > > Package: r-base-core
> > > Version: 1.7.1.cvs.20030927-1
> > > Severity: normal
> > > 
> > > 
> > > $ R
> > > 
> > > R : Copyright 2003, The R Development Core Team
> > > Version 1.8.0 beta (2003-09-27)
> > > 
> > > ...
> > > 
> > > > data(cars)
> > > > postscript("tmp.ps")
> > > > plot(cars)
> > > > xfig("tmp.fig", onefile=TRUE)
> > > > plot(cars)
> > > Error in plot.xy(xy, type, col = col, pch = pch, cex = cex, bg = bg, lty = lty,  : 
> > > 	invalid line type: must be length 2, 4, 6 or 8
> > > > 
> > > 
> > > No output is produced. 
> > > 
> > > Regards,
> > > Graham
> > > 
> > > -- System Information:
> > > Debian Release: testing/unstable
> > > Architecture: i386
> > > Kernel: Linux festiva.act.cmis.csiro.au 2.4.22-1-686 #4 Sun Sep 28 13:27:15 EST 2003 i686
> > > Locale: LANG=C, LC_CTYPE=C (ignored: LC_ALL set to C)
> > > 
> > > Versions of packages r-base-core depends on:
> > > ii  atlas2-base [atlas2]      3.2.1ln-11     Automatically Tuned Linear Algebra
> > > ii  libbz2-1.0                1.0.2-1        A high-quality block-sorting file 
> > > ii  libc6                     2.3.2-8        GNU C Library: Shared libraries an
> > > ii  libg2c0                   1:3.3.2-0pre4  Runtime library for GNU Fortran 77
> > > ii  libgcc1                   1:3.3.2-0pre4  GCC support library
> > > ii  libjpeg62                 6b-8           The Independent JPEG Group's JPEG 
> > > ii  libncurses5               5.3.20030719-2 Shared libraries for terminal hand
> > > ii  libpcre3                  4.3-3          Philip Hazel's Perl 5 Compatible R
> > > ii  libpng10-0                1.0.15-4       PNG library, older version - runti
> > > ii  libreadline4              4.3-5          GNU readline and history libraries
> > > ii  perl                      5.8.1-2        Larry Wall's Practical Extraction 
> > > ii  tcl8.4                    8.4.4-1        Tcl (the Tool Command Language) v8
> > > ii  tk8.4                     8.4.4-1        Tk toolkit for Tcl and X11, v8.4 -
> > > ii  xlibs                     4.2.1-11       X Window System client libraries
> > > ii  zlib-bin                  1:1.1.4-15     compression library - sample progr
> > > ii  zlib1g                    1:1.1.4-15     compression library - runtime
> > > 
> > > -- no debconf information
> > > 
> > > 
> > > 
> > 
> > -- 
> > Those are my principles, and if you don't like them... well, I have others.
> >                                                 -- Groucho Marx
> > 
> > ______________________________________________
> > R-devel@stat.math.ethz.ch mailing list
> > https://www.stat.math.ethz.ch/mailman/listinfo/r-devel
> 
> -- 
> Douglas Bates                            bates@stat.wisc.edu
> Statistics Department                    608/262-2598
> University of Wisconsin - Madison        http://www.stat.wisc.edu/~bates/
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://www.stat.math.ethz.ch/mailman/listinfo/r-devel
> 

-- 
Those are my principles, and if you don't like them... well, I have others.
                                                -- Groucho Marx

From cjwatson at debian.org  Fri Oct  3 16:35:57 2003
From: cjwatson at debian.org (Colin Watson)
Date: Fri Oct  3 16:35:12 2003
Subject: [Rd] Re: Bug#213857: r-base-core: xfig plot fails with invalid
	line type (PR#4401)
In-Reply-To: <20031003142129.GA18244@sonny.eddelbuettel.com>
References: <200310031217.h93CHV0P026732@pubhealth.ku.dk>
	<6rhe2q78lg.fsf@bates4.stat.wisc.edu>
	<20031003142129.GA18244@sonny.eddelbuettel.com>
Message-ID: <20031003143557.GB10126@riva.ucam.org>

On Fri, Oct 03, 2003 at 09:21:29AM -0500, Dirk Eddelbuettel wrote:
> On Fri, Oct 03, 2003 at 08:29:31AM -0500, Douglas Bates wrote:
> > edd@debian.org writes:
> > > Confirmed. I will pass that along to the R team. As 1.8.0 is in
> > > code freeze, this may not get addressed, unfortunately.
> > 
> > I believe Ross Ihaka has already detected and fixed this problem.  The
> > fix should be in today's beta version of R-1.8.0.  We hope it will
> > show up in the next Debian package Dirk makes for the unstable
> > (Debian) distribution.
> 
> Excellent news. I happened to have made releases on Saturday mornings for
> the last five or six weeks, so I'll see how tomorrow's version behaves.

Please take owner@bugs.debian.org off the Cc: list here, thanks. :)

I've bounced the last couple of mails to 213857@bugs.debian.org, where
they belong.

Cheers,

-- 
Colin Watson                                  [cjwatson@flatline.org.uk]

From cjwatson at debian.org  Fri Oct  3 17:36:07 2003
From: cjwatson at debian.org (cjwatson@debian.org)
Date: Fri Oct  3 16:35:41 2003
Subject: [Rd] Re: Bug#213857: r-base-core: xfig plot fails with invalid
	line type (PR#4401)
Message-ID: <200310031436.h93Ea70P028784@pubhealth.ku.dk>

On Fri, Oct 03, 2003 at 09:21:29AM -0500, Dirk Eddelbuettel wrote:
> On Fri, Oct 03, 2003 at 08:29:31AM -0500, Douglas Bates wrote:
> > edd@debian.org writes:
> > > Confirmed. I will pass that along to the R team. As 1.8.0 is in
> > > code freeze, this may not get addressed, unfortunately.
> > 
> > I believe Ross Ihaka has already detected and fixed this problem.  The
> > fix should be in today's beta version of R-1.8.0.  We hope it will
> > show up in the next Debian package Dirk makes for the unstable
> > (Debian) distribution.
> 
> Excellent news. I happened to have made releases on Saturday mornings for
> the last five or six weeks, so I'll see how tomorrow's version behaves.

Please take owner@bugs.debian.org off the Cc: list here, thanks. :)

I've bounced the last couple of mails to 213857@bugs.debian.org, where
they belong.

Cheers,

-- 
Colin Watson                                  [cjwatson@flatline.org.uk]

From jago at mclink.it  Fri Oct  3 18:02:20 2003
From: jago at mclink.it (Stefano Iacus)
Date: Fri Oct  3 17:01:45 2003
Subject: [Rd] tseries
Message-ID: <96718A16-F5B2-11D7-9492-003065CC4CB8@mclink.it>

Has anyone successfully check/build tseries for MacOSX?
It seems like there is the same problem with symbols duplications. The 
-m like option does not seem to help.

stefano

From deleeuw at stat.ucla.edu  Fri Oct  3 09:44:00 2003
From: deleeuw at stat.ucla.edu (Jan de Leeuw)
Date: Fri Oct  3 17:43:18 2003
Subject: [Rd] tseries
In-Reply-To: <96718A16-F5B2-11D7-9492-003065CC4CB8@mclink.it>
References: <96718A16-F5B2-11D7-9492-003065CC4CB8@mclink.it>
Message-ID: <684AE25C-F5B8-11D7-9B55-000A95A67E82@stat.ucla.edu>

I don't think its the multiple symbols, those are all warnings. But

ld: dsumsl.o has local relocation entries in non-writable section  
(__TEXT,__const)
make: *** [tseries.so] Error 1

breaks it.

On Oct 3, 2003, at 8:02 , Stefano Iacus wrote:

> Has anyone successfully check/build tseries for MacOSX?
> It seems like there is the same problem with symbols duplications. The  
> -m like option does not seem to help.
>
> stefano
>
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://www.stat.math.ethz.ch/mailman/listinfo/r-devel
>
>
===
Jan de Leeuw; Professor and Chair, UCLA Department of Statistics;
Editor: Journal of Multivariate Analysis, Journal of Statistical  
Software
US mail: 9432 Boelter Hall, Box 951554, Los Angeles, CA 90095-1554
phone (310)-825-9550;  fax (310)-206-5658;  email: deleeuw@stat.ucla.edu
homepage: http://gifi.stat.ucla.edu
   
------------------------------------------------------------------------ 
-------------------------
           No matter where you go, there you are. --- Buckaroo Banzai
                    http://gifi.stat.ucla.edu/sounds/nomatter.au

From deleeuw at stat.ucla.edu  Fri Oct  3 10:05:56 2003
From: deleeuw at stat.ucla.edu (Jan de Leeuw)
Date: Fri Oct  3 18:05:10 2003
Subject: [Rd] tseries
In-Reply-To: <96718A16-F5B2-11D7-9492-003065CC4CB8@mclink.it>
References: <96718A16-F5B2-11D7-9492-003065CC4CB8@mclink.it>
Message-ID: <78C2A74C-F5BB-11D7-9B55-000A95A67E82@stat.ucla.edu>

If I compile dsumsl.f with the IBM xlf compiler then tseries builds and  
installs -- of course
tseries.so does not load properly, because the rest of R is build with  
g77, but it suggests
the problem is with g77.

On Oct 3, 2003, at 8:02 , Stefano Iacus wrote:

> Has anyone successfully check/build tseries for MacOSX?
> It seems like there is the same problem with symbols duplications. The  
> -m like option does not seem to help.
>
> stefano
>
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://www.stat.math.ethz.ch/mailman/listinfo/r-devel
>
>
===
Jan de Leeuw; Professor and Chair, UCLA Department of Statistics;
Editor: Journal of Multivariate Analysis, Journal of Statistical  
Software
US mail: 9432 Boelter Hall, Box 951554, Los Angeles, CA 90095-1554
phone (310)-825-9550;  fax (310)-206-5658;  email: deleeuw@stat.ucla.edu
homepage: http://gifi.stat.ucla.edu
   
------------------------------------------------------------------------ 
-------------------------
           No matter where you go, there you are. --- Buckaroo Banzai
                    http://gifi.stat.ucla.edu/sounds/nomatter.au

From simon.urbanek at math.uni-augsburg.de  Fri Oct  3 19:08:15 2003
From: simon.urbanek at math.uni-augsburg.de (Simon Urbanek)
Date: Fri Oct  3 19:07:32 2003
Subject: [Rd] latest beta + MinGW 3.1.0-1 = minor fix needed
Message-ID: <3F7DACFF.9030306@math.uni-augsburg.de>

MinGW 3.1.0-1 is currently the latest official MinGW release, therefore 
I tried to compile the latest R beta (rsync today). There is one minor 
problem when trying that:

gcc  -O2 -Wall -pedantic -I../../include -I../../gnuwin32 
-DHAVE_CONFIG_H  -c internet.c -o internet.o
In file included from internet.c:880:
sock.h:23: conflicting types for `ssize_t'
n:/MinGW/include/sys/types.h:119: previous declaration of `ssize_t'
make[3]: *** [internet.o] Error 1

(This is in src/modules/internet)

Obviously ssize_t was added to the system types in MinGW. The 
corresponding files:

MinGW: sys/types.h:

#ifndef _SSIZE_T_
#define _SSIZE_T_
typedef long _ssize_t;

R: src/modules/internet/sock.h

#ifdef Win32
typedef int ssize_t;
#endif

There are two possible fixes for this:
1) make sock.h use long instead of int.
2) use something like:
#if defined Win32 && !defined _SSIZE_T_

I don't think either fix is "better" in any way, but personally I'd go 
for the "long" (for Win32 I don't see any difference, but for Win64 fix 
2) may be less safe?).

Configuration:
MinGW 3.1.0-1
w32api 2.4

Simon

From ligges at statistik.uni-dortmund.de  Fri Oct  3 20:34:39 2003
From: ligges at statistik.uni-dortmund.de (Uwe Ligges)
Date: Fri Oct  3 19:32:49 2003
Subject: [Rd] latest beta + MinGW 3.1.0-1 = minor fix needed
In-Reply-To: <3F7DACFF.9030306@math.uni-augsburg.de>
References: <3F7DACFF.9030306@math.uni-augsburg.de>
Message-ID: <3F7DB32F.4030701@statistik.uni-dortmund.de>

Simon Urbanek wrote:

> MinGW 3.1.0-1 is currently the latest official MinGW release, therefore 
> I tried to compile the latest R beta (rsync today). There is one minor 
> problem when trying that:
> 
> gcc  -O2 -Wall -pedantic -I../../include -I../../gnuwin32 
> -DHAVE_CONFIG_H  -c internet.c -o internet.o
> In file included from internet.c:880:
> sock.h:23: conflicting types for `ssize_t'
> n:/MinGW/include/sys/types.h:119: previous declaration of `ssize_t'
> make[3]: *** [internet.o] Error 1
> 
> (This is in src/modules/internet)
> 
> Obviously ssize_t was added to the system types in MinGW. The 
> corresponding files:
> 
> MinGW: sys/types.h:
> 
> #ifndef _SSIZE_T_
> #define _SSIZE_T_
> typedef long _ssize_t;
> 
> R: src/modules/internet/sock.h
> 
> #ifdef Win32
> typedef int ssize_t;
> #endif
> 
> There are two possible fixes for this:
> 1) make sock.h use long instead of int.
> 2) use something like:
> #if defined Win32 && !defined _SSIZE_T_
> 
> I don't think either fix is "better" in any way, but personally I'd go 
> for the "long" (for Win32 I don't see any difference, but for Win64 fix 
> 2) may be less safe?).
> 
> Configuration:
> MinGW 3.1.0-1
> w32api 2.4
> 
> Simon


Simon,

it does not happen with MinGW's gcc-3.3.1 candidate release we (Duncan 
and myself) use for compiling R base + packages.
The gcc-3.3.1 candidate is older (2003-08-07) than the official release 
(2003-09-14, gcc-3.2.?) you are using, though.

Some thoughts:
The first suggested fix seems to be forbidden during code freeze (might 
break other platforms, doesn't it?), the second one puts one more OS 
dependence into the sources.
Another solution is to hope for an official MinGW release of gcc-3.3.1 
with the change you are reporting reverted before the release of R-1.8.1 
(of course one should document not to use MinGW 3.1.0-1 as is).

Uwe

From paulluo at cs.cmu.edu  Fri Oct  3 23:17:28 2003
From: paulluo at cs.cmu.edu (paulluo@cs.cmu.edu)
Date: Fri Oct  3 22:16:38 2003
Subject: [Rd] misprint  in Leaps $size (PR#4403)
Message-ID: <200310032017.h93KHS0P000471@pubhealth.ku.dk>

Full_Name: Paul Li
Version: 1.6.2
OS: Windows NT
Submission from: (NULL) (128.2.203.251)


The $size does not start with the models with only one variable, it starts with
2, ie, instead of 1 2 3... it starts with 2 3 4... 

This isn't that big of a deal cept that everything else, like $which and $Cp
start with 1.

Minor detail, I apologize for nit picking.


$which
       1     2     3     4     5     6     7     8     9     A     B     C    
D
1  FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE FALSE FALSE FALSE
FALSE
1  FALSE FALSE FALSE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
FALSE
1  FALSE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE FALSE FALSE FALSE FALSE
FALSE
2   TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE FALSE FALSE FALSE
FALSE
2  FALSE FALSE  TRUE FALSE FALSE FALSE FALSE FALSE  TRUE FALSE FALSE FALSE
FALSE
2  FALSE FALSE FALSE  TRUE FALSE FALSE FALSE FALSE  TRUE FALSE FALSE FALSE
FALSE
3   TRUE FALSE FALSE  TRUE FALSE FALSE FALSE FALSE  TRUE FALSE FALSE FALSE
FALSE
...
$label
 [1] "(Intercept)" "1"           "2"           "3"           "4"          
 [6] "5"           "6"           "7"           "8"           "9"          
[11] "A"           "B"           "C"           "D"          

$size
 [1]  2  2  2  3  3  3  4  4  4  5  5  5  6  6  6  7  7  7  8  8  8  9  9  9 10
10 10
[28] 11 11 11 12 12 12 13 13 13 14

$Cp
 [1] 10.3556013 20.9834809 36.1314911  3.3146028  5.3535009  6.8232717 
0.2356971
 [8]

From simon.urbanek at math.uni-augsburg.de  Sat Oct  4 00:40:18 2003
From: simon.urbanek at math.uni-augsburg.de (Simon Urbanek)
Date: Fri Oct  3 23:39:56 2003
Subject: [Rd] latest beta + MinGW 3.1.0-1 = minor fix needed
In-Reply-To: <3F7DB32F.4030701@statistik.uni-dortmund.de>
Message-ID: <2E7D0CF4-F5EA-11D7-A217-000A959F327E@math.uni-augsburg.de>


On Friday, October 3, 2003, at 07:34 PM, Uwe Ligges wrote:

> Some thoughts:
> The first suggested fix seems to be forbidden during code freeze 
> (might break other platforms, doesn't it?), the second one puts one 
> more OS dependence into the sources.

The neither fix affects any platform except for Win32 - and that's the 
one we're fixing ;) - it's inside #ifdef Win32 - so I hope no other 
platform sets that define ;). On Win32 gcc int = long so in fact 
nothing should change - except for the error that would go away.

Simon

From xzhao at stat.wvu.edu  Sat Oct  4 05:56:27 2003
From: xzhao at stat.wvu.edu (xzhao@stat.wvu.edu)
Date: Sat Oct  4 04:55:36 2003
Subject: [Rd] a bug of function plot (PR#4405)
Message-ID: <200310040256.h942uR0P002193@pubhealth.ku.dk>

Full_Name: Ximing Zhao
Version: R 1.7.1
OS: MacOs X
Submission from: (NULL) (64.136.27.51)


When I used function plot in R 1.7.1, I found two bugs.
My whole function is this:
*****************
drawexp<-function(X,x,c,b){
exp<-function28(X,x,c,b)
if(max(exp)>=max(dexp(x,rate=1))){
plot(x,exp, type="l",main= paste("Exponential ,n=",length(X),"
c=",round(c,2),"b=",b),sub="X=exp(rate=1)")
lines(x,dexp(x,rate=1),col="red",type="l") 
lines(density(X,width="SJ-dpi",n=1000,from=0.1,to=4),lty=2,col="blue")
}
else{
plot(x,dexp(x,rate=1),col="red",type="l",main= paste("Exponential
,n=",length(X)," c=",round(c,2),"b=",b),sub="X=exp(rate=1)")
lines(x,exp, type="l")
lines(density(X,width="SJ-dpi",n=1000,from=0.1,to=4),lty=2,col="blue")
}
text(3,0.35,"-- theoretical",col="red",adj=c(0,0))
text(3,0.3,"-- moment type", adj=c(0,0))
text(3,0.25, "-- Kernel type", col="blue", adj=c(0,0))
}

function28<-function(X,x,c,b){
est<-function(X,x,alfa){
fx<-(1/gamma(alfa))*((alfa-1)/x)*(alfa*X/x)^(alfa-1)*exp(-alfa*X/x)
fx
}
n<-length(X)
result<-colSums(sapply(x,function(x){est(X,x,alfa=(n^c)*log(n)^b)}))/length(X)
result
}

X1<-rexp(100)

x1<-seq(0.1,4,length=100)

Run the function like this:

drawexp(X1,x1,0,0.5)

***************

For "lines(density(X,width="SJ-dpi",n=1000,from=0.1,to=4),lty=2,col="blue")",
only lty=1 works, lty=2 and others don't work. I tried the function in 1.6.2
before,
it was alright. So I am positive it's a bug. Please check.

Another thing is, if X11 window for the graph is not big enough, and the text,
like "-- moment type" in the function floats out, then X11 window doesn't show
the text at all. If you use the function in 1.6.2, it will show part of it but
not the characters beyond the graph size. I don't think it's reasonable to not
show anything. So it should be another bug.

I have a few suggestions, please keep the version which has been tested for a
long
time and with few bugs on the website(for different operating system), so
whenever people need some old good version they can still download from CRAN.
Also, please do not update the version of R in such a hurry way and let such
mistakes happen so easily. If you do update the version and want to introduce to
people, please mark it as "beta" so people will know. I understand this is a
free software and it's pretty hard to manage, but such efforts will be greatly
appreciated.

If you have any question w/ the bugs I described, please email me and I'd like
to 
help.

Thank you very much!

From andy_liaw at merck.com  Sat Oct  4 00:36:37 2003
From: andy_liaw at merck.com (Liaw, Andy)
Date: Sat Oct  4 05:36:03 2003
Subject: [Rd] a bug of function plot (PR#4405)
Message-ID: <3A822319EB35174CA3714066D590DCD50205CC1B@usrymx25.merck.com>

> From: xzhao@stat.wvu.edu [mailto:xzhao@stat.wvu.edu] 
> 
> Full_Name: Ximing Zhao
> Version: R 1.7.1
> OS: MacOs X
> Submission from: (NULL) (64.136.27.51)
> 
> 
> When I used function plot in R 1.7.1, I found two bugs.
> My whole function is this:
> *****************
> drawexp<-function(X,x,c,b){
> exp<-function28(X,x,c,b)
> if(max(exp)>=max(dexp(x,rate=1))){
> plot(x,exp, type="l",main= paste("Exponential ,n=",length(X),"
> c=",round(c,2),"b=",b),sub="X=exp(rate=1)")
> lines(x,dexp(x,rate=1),col="red",type="l") 
> lines(density(X,width="SJ-dpi",n=1000,from=0.1,to=4),lty=2,col="blue")
> }
> else{
> plot(x,dexp(x,rate=1),col="red",type="l",main= 
> paste("Exponential ,n=",length(X)," 
> c=",round(c,2),"b=",b),sub="X=exp(rate=1)")
> lines(x,exp, type="l")
> lines(density(X,width="SJ-dpi",n=1000,from=0.1,to=4),lty=2,col="blue")
> }
> text(3,0.35,"-- theoretical",col="red",adj=c(0,0))
> text(3,0.3,"-- moment type", adj=c(0,0))
> text(3,0.25, "-- Kernel type", col="blue", adj=c(0,0))
> }
> 
> function28<-function(X,x,c,b){
> est<-function(X,x,alfa){
> fx<-(1/gamma(alfa))*((alfa-1)/x)*(alfa*X/x)^(alfa-1)*exp(-alfa*X/x)
> fx
> }
> n<-length(X)
> result<-colSums(sapply(x,function(x){est(X,x,alfa=(n^c)*log(n)
> ^b)}))/length(X)
> result
> }
> 
> X1<-rexp(100)
> 
> x1<-seq(0.1,4,length=100)
> 
> Run the function like this:
> 
> drawexp(X1,x1,0,0.5)
> 
> ***************
> 
> For 
> "lines(density(X,width="SJ-dpi",n=1000,from=0.1,to=4),lty=2,co
> l="blue")",
> only lty=1 works, lty=2 and others don't work. I tried the 
> function in 1.6.2 before, it was alright. So I am positive 
> it's a bug. Please check.

Works fine for me on WinXPPro...
 
> Another thing is, if X11 window for the graph is not big 
> enough, and the text, like "-- moment type" in the function 
> floats out, then X11 window doesn't show the text at all. If 
> you use the function in 1.6.2, it will show part of it but 
> not the characters beyond the graph size. I don't think it's 
> reasonable to not show anything. So it should be another bug.

RTFM.  Specifically, ?text says it accept the argument "xpd".  To see how to
use it, see ?par.  Also see R FAQ Q9.1.
 
> I have a few suggestions, please keep the version which has 
> been tested for a long time and with few bugs on the 
> website(for different operating system), so whenever people 
> need some old good version they can still download from CRAN. 

This is utterly unreasonable, IMHO.  Try asking any commercial software
vendor to keep older versions of their software around for you to use.  It
is your (or your sys admin's) responsibility to keep what you think is more
stable version of the software around *on your system*.  If you think 1.7.1
is buggy and 1.6.2 is not, then don't erase 1.6.2.  What we sometimes do is
keep two versions around for a while, just in case.

> Also, please do not update the version of R in such a hurry 
> way and let such mistakes happen so easily. If you do update 
> the version and want to introduce to people, please mark it 
> as "beta" so people will know. I understand this is a free 
> software and it's pretty hard to manage, but such efforts 
> will be greatly appreciated.

1.8.0 is currently under beta.  Are you testing it?

Andy
 
> If you have any question w/ the bugs I described, please 
> email me and I'd like to 
> help.
> 
> Thank you very much!
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list 
> https://www.stat.math.ethz.ch/mailman/listinfo> /r-devel
>

From rpeng at jhsph.edu  Sat Oct  4 00:56:55 2003
From: rpeng at jhsph.edu (Roger D. Peng)
Date: Sat Oct  4 05:56:25 2003
Subject: [Rd] a bug of function plot (PR#4405)
In-Reply-To: <200310040256.h942uR0P002193@pubhealth.ku.dk>
References: <200310040256.h942uR0P002193@pubhealth.ku.dk>
Message-ID: <3F7E4507.5060809@jhsph.edu>

I cannot reproduce this bug on either Linux or Windows XP Home.  The 
given function plots the lines correctly.

Also, CRAN keeps all old versions of the sources, so if you wanted to 
run an older version of R you could probably build it from source.

-roger

xzhao@stat.wvu.edu wrote:
> Full_Name: Ximing Zhao
> Version: R 1.7.1
> OS: MacOs X
> Submission from: (NULL) (64.136.27.51)
> 
> 
> When I used function plot in R 1.7.1, I found two bugs.
> My whole function is this:
> *****************
> drawexp<-function(X,x,c,b){
> exp<-function28(X,x,c,b)
> if(max(exp)>=max(dexp(x,rate=1))){
> plot(x,exp, type="l",main= paste("Exponential ,n=",length(X),"
> c=",round(c,2),"b=",b),sub="X=exp(rate=1)")
> lines(x,dexp(x,rate=1),col="red",type="l") 
> lines(density(X,width="SJ-dpi",n=1000,from=0.1,to=4),lty=2,col="blue")
> }
> else{
> plot(x,dexp(x,rate=1),col="red",type="l",main= paste("Exponential
> ,n=",length(X)," c=",round(c,2),"b=",b),sub="X=exp(rate=1)")
> lines(x,exp, type="l")
> lines(density(X,width="SJ-dpi",n=1000,from=0.1,to=4),lty=2,col="blue")
> }
> text(3,0.35,"-- theoretical",col="red",adj=c(0,0))
> text(3,0.3,"-- moment type", adj=c(0,0))
> text(3,0.25, "-- Kernel type", col="blue", adj=c(0,0))
> }
> 
> function28<-function(X,x,c,b){
> est<-function(X,x,alfa){
> fx<-(1/gamma(alfa))*((alfa-1)/x)*(alfa*X/x)^(alfa-1)*exp(-alfa*X/x)
> fx
> }
> n<-length(X)
> result<-colSums(sapply(x,function(x){est(X,x,alfa=(n^c)*log(n)^b)}))/length(X)
> result
> }
> 
> X1<-rexp(100)
> 
> x1<-seq(0.1,4,length=100)
> 
> Run the function like this:
> 
> drawexp(X1,x1,0,0.5)
> 
> ***************
> 
> For "lines(density(X,width="SJ-dpi",n=1000,from=0.1,to=4),lty=2,col="blue")",
> only lty=1 works, lty=2 and others don't work. I tried the function in 1.6.2
> before,
> it was alright. So I am positive it's a bug. Please check.
> 
> Another thing is, if X11 window for the graph is not big enough, and the text,
> like "-- moment type" in the function floats out, then X11 window doesn't show
> the text at all. If you use the function in 1.6.2, it will show part of it but
> not the characters beyond the graph size. I don't think it's reasonable to not
> show anything. So it should be another bug.
> 
> I have a few suggestions, please keep the version which has been tested for a
> long
> time and with few bugs on the website(for different operating system), so
> whenever people need some old good version they can still download from CRAN.
> Also, please do not update the version of R in such a hurry way and let such
> mistakes happen so easily. If you do update the version and want to introduce to
> people, please mark it as "beta" so people will know. I understand this is a
> free software and it's pretty hard to manage, but such efforts will be greatly
> appreciated.
> 
> If you have any question w/ the bugs I described, please email me and I'd like
> to 
> help.
> 
> Thank you very much!
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://www.stat.math.ethz.ch/mailman/listinfo/r-devel
>

From jago at mclink.it  Sat Oct  4 12:30:34 2003
From: jago at mclink.it (Stefano Iacus)
Date: Sat Oct  4 11:29:51 2003
Subject: [Rd] a bug of function plot (PR#4405)
In-Reply-To: <200310040256.h942uR0P002193@pubhealth.ku.dk>
Message-ID: <67FCB5EE-F64D-11D7-ABBF-003065CC4CB8@mclink.it>


On Sabato, ott 4, 2003, at 04:56 Europe/Rome, xzhao@stat.wvu.edu wrote:

> Full_Name: Ximing Zhao
> Version: R 1.7.1
> OS: MacOs X
> Submission from: (NULL) (64.136.27.51)
>
>
> When I used function plot in R 1.7.1, I found two bugs.
> My whole function is this:
> *****************
> drawexp<-function(X,x,c,b){
> exp<-function28(X,x,c,b)
> if(max(exp)>=max(dexp(x,rate=1))){
> plot(x,exp, type="l",main= paste("Exponential ,n=",length(X),"
> c=",round(c,2),"b=",b),sub="X=exp(rate=1)")
> lines(x,dexp(x,rate=1),col="red",type="l")
> lines(density(X,width="SJ-dpi",n=1000,from=0.1,to=4),lty=2,col="blue")
> }
> else{
> plot(x,dexp(x,rate=1),col="red",type="l",main= paste("Exponential
> ,n=",length(X)," c=",round(c,2),"b=",b),sub="X=exp(rate=1)")
> lines(x,exp, type="l")
> lines(density(X,width="SJ-dpi",n=1000,from=0.1,to=4),lty=2,col="blue")
> }
> text(3,0.35,"-- theoretical",col="red",adj=c(0,0))
> text(3,0.3,"-- moment type", adj=c(0,0))
> text(3,0.25, "-- Kernel type", col="blue", adj=c(0,0))
> }
>
> function28<-function(X,x,c,b){
> est<-function(X,x,alfa){
> fx<-(1/gamma(alfa))*((alfa-1)/x)*(alfa*X/x)^(alfa-1)*exp(-alfa*X/x)
> fx
> }
> n<-length(X)
> result<-colSums(sapply(x,function(x){est(X,x,alfa=(n^c)*log(n)^b)}))/ 
> length(X)
> result
> }
>
> X1<-rexp(100)
>
> x1<-seq(0.1,4,length=100)
>
> Run the function like this:
>
> drawexp(X1,x1,0,0.5)
>
> ***************
>
> For  
> "lines(density(X,width="SJ- 
> dpi",n=1000,from=0.1,to=4),lty=2,col="blue")",
> only lty=1 works, lty=2 and others don't work. I tried the function in  
> 1.6.2
> before,
> it was alright. So I am positive it's a bug. Please check.

are you referring to which version of R for MacOSX. Till 1.7.1 there  
were two versions: darwin/X11 and Carbon port of R both running under  
OSX.

In darwin/X11 the quartz device has never worked correctly wrt to lty,  
symbol fonts and ISOLatin/MacRoman related display. All of this has  
been fixed and many new features has been implemented for the quartz  
device int he forthcoming release 1.8.0 of R.
If you were using Carbon R, than probably also using the macintosh()  
device. In this case lty was only partly working. In any case this  
device is no longer used by any port of R since 1.7.1 is the last  
release of Carbon R.
There is now a new darwin port of R which has an Aqua gui. This version  
is intended to replace the old Carbon R.
It is called RAqua and you'll find it on CRAN under the bin/macosx dir  
_after_ R-1.8.0 is relased.

If you where talking about X11, this lty problems seems not to be  
there. Have you also the latest X11 window manager from apple?

In any case, please be more precise on all the parts of your  
configurations that are relevant wrt to the claimed bug, otherwise we  
cannot be helpful to you and we hardly understand if and where there is  
a bug.

stefano



>
> Another thing is, if X11 window for the graph is not big enough, and  
> the text,
> like "-- moment type" in the function floats out, then X11 window  
> doesn't show
> the text at all. If you use the function in 1.6.2, it will show part  
> of it but
> not the characters beyond the graph size. I don't think it's  
> reasonable to not
> show anything. So it should be another bug.
>
> I have a few suggestions, please keep the version which has been  
> tested for a
> long
> time and with few bugs on the website(for different operating system),  
> so
> whenever people need some old good version they can still download  
> from CRAN.
> Also, please do not update the version of R in such a hurry way and  
> let such
> mistakes happen so easily. If you do update the version and want to  
> introduce to
> people, please mark it as "beta" so people will know. I understand  
> this is a
> free software and it's pretty hard to manage, but such efforts will be  
> greatly
> appreciated.
>
> If you have any question w/ the bugs I described, please email me and  
> I'd like
> to
> help.
>
> Thank you very much!
>
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://www.stat.math.ethz.ch/mailman/listinfo/r-devel
>

From p.dalgaard at biostat.ku.dk  Sat Oct  4 13:14:12 2003
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard BSA)
Date: Sat Oct  4 14:14:14 2003
Subject: [Rd] latest beta + MinGW 3.1.0-1 = minor fix needed
In-Reply-To: <3F7DB32F.4030701@statistik.uni-dortmund.de>
References: <3F7DACFF.9030306@math.uni-augsburg.de>
	<3F7DB32F.4030701@statistik.uni-dortmund.de>
Message-ID: <x2pthdtczk.fsf@biostat.ku.dk>

Uwe Ligges <ligges@statistik.uni-dortmund.de> writes:

> Simon Urbanek wrote:
> 
> > There are two possible fixes for this:
> > 1) make sock.h use long instead of int.
> > 2) use something like:
> > #if defined Win32 && !defined _SSIZE_T_

> Simon,
> 
> it does not happen with MinGW's gcc-3.3.1 candidate release we (Duncan
> and myself) use for compiling R base + packages.
> The gcc-3.3.1 candidate is older (2003-08-07) than the official
> release (2003-09-14, gcc-3.2.?) you are using, though.
> 
> Some thoughts:
> The first suggested fix seems to be forbidden during code freeze
> (might break other platforms, doesn't it?), the second one puts one
> more OS dependence into the sources.
> Another solution is to hope for an official MinGW release of gcc-3.3.1
> with the change you are reporting reverted before the release of
> R-1.8.1 (of course one should document not to use MinGW 3.1.0-1 as is).

Fixes that are NOPs on non-broken setups should be allowable...
Version 2) looks most correct to me: We want to use the system
definition wherever it is available, and it would obviously only
change anything on Win32.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From edd at debian.org  Sat Oct  4 09:56:07 2003
From: edd at debian.org (Dirk Eddelbuettel)
Date: Sat Oct  4 15:55:47 2003
Subject: [Rd] Re: Bug#213857: r-base-core: xfig plot fails with invalid
	line type (PR#4401)
In-Reply-To: <20031003142129.GA18244@sonny.eddelbuettel.com>
References: <200310031217.h93CHV0P026732@pubhealth.ku.dk>
	<6rhe2q78lg.fsf@bates4.stat.wisc.edu>
	<20031003142129.GA18244@sonny.eddelbuettel.com>
Message-ID: <20031004135607.GA28254@sonny.eddelbuettel.com>

On Fri, Oct 03, 2003 at 09:21:29AM -0500, Dirk Eddelbuettel wrote:
> On Fri, Oct 03, 2003 at 08:29:31AM -0500, Douglas Bates wrote:
> > edd@debian.org writes:
> > 
> > > Graham,
> > > 
> > > Confirmed. I will pass that along to the R team. As 1.8.0 is in code freeze,
> > > this may not get addressed, unfortunately.
> > > 
> > > Regards, Dirk
> > 
> > I believe Ross Ihaka has already detected and fixed this problem.  The
> > fix should be in today's beta version of R-1.8.0.  We hope it will
> > show up in the next Debian package Dirk makes for the unstable
> > (Debian) distribution.
> 
> Excellent news. I happened to have made releases on Saturday mornings for
> the last five or six weeks, so I'll see how tomorrow's version behaves.

Looks like it has been fixed (see below) in the 1.8.0beta of 2003-10-04
which is currently being uploaded. Hence, I'll close the bug report on the
Debian end.

Thanks, Dirk

edd@homebud:~/debian> R

R : Copyright 2003, The R Development Core Team
Version 1.8.0 beta (2003-10-04)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for a HTML browser interface to help.
Type 'q()' to quit R.

> data(cars)
> xfig("/tmp/cars.xfig") 
NULL
Warning message: 
xfig(/tmp/cars.xfig, onefile=FALSE) will only return the last plot 
> plot(cars)
> dev.off()
null device 
          1 
> q()
Save workspace image? [y/n/c]: n



> 
> Thanks, Dirk
> 
> > 
> > > 
> > > 
> > > On Fri, Oct 03, 2003 at 03:16:35PM +1000, Graham Williams wrote:
> > > > Package: r-base-core
> > > > Version: 1.7.1.cvs.20030927-1
> > > > Severity: normal
> > > > 
> > > > 
> > > > $ R
> > > > 
> > > > R : Copyright 2003, The R Development Core Team
> > > > Version 1.8.0 beta (2003-09-27)
> > > > 
> > > > ...
> > > > 
> > > > > data(cars)
> > > > > postscript("tmp.ps")
> > > > > plot(cars)
> > > > > xfig("tmp.fig", onefile=TRUE)
> > > > > plot(cars)
> > > > Error in plot.xy(xy, type, col = col, pch = pch, cex = cex, bg = bg, lty = lty,  : 
> > > > 	invalid line type: must be length 2, 4, 6 or 8
> > > > > 
> > > > 
> > > > No output is produced. 
> > > > 
> > > > Regards,
> > > > Graham
> > > > 
> > > > -- System Information:
> > > > Debian Release: testing/unstable
> > > > Architecture: i386
> > > > Kernel: Linux festiva.act.cmis.csiro.au 2.4.22-1-686 #4 Sun Sep 28 13:27:15 EST 2003 i686
> > > > Locale: LANG=C, LC_CTYPE=C (ignored: LC_ALL set to C)
> > > > 
> > > > Versions of packages r-base-core depends on:
> > > > ii  atlas2-base [atlas2]      3.2.1ln-11     Automatically Tuned Linear Algebra
> > > > ii  libbz2-1.0                1.0.2-1        A high-quality block-sorting file 
> > > > ii  libc6                     2.3.2-8        GNU C Library: Shared libraries an
> > > > ii  libg2c0                   1:3.3.2-0pre4  Runtime library for GNU Fortran 77
> > > > ii  libgcc1                   1:3.3.2-0pre4  GCC support library
> > > > ii  libjpeg62                 6b-8           The Independent JPEG Group's JPEG 
> > > > ii  libncurses5               5.3.20030719-2 Shared libraries for terminal hand
> > > > ii  libpcre3                  4.3-3          Philip Hazel's Perl 5 Compatible R
> > > > ii  libpng10-0                1.0.15-4       PNG library, older version - runti
> > > > ii  libreadline4              4.3-5          GNU readline and history libraries
> > > > ii  perl                      5.8.1-2        Larry Wall's Practical Extraction 
> > > > ii  tcl8.4                    8.4.4-1        Tcl (the Tool Command Language) v8
> > > > ii  tk8.4                     8.4.4-1        Tk toolkit for Tcl and X11, v8.4 -
> > > > ii  xlibs                     4.2.1-11       X Window System client libraries
> > > > ii  zlib-bin                  1:1.1.4-15     compression library - sample progr
> > > > ii  zlib1g                    1:1.1.4-15     compression library - runtime
> > > > 
> > > > -- no debconf information
> > > > 
> > > > 
> > > > 
> > > 
> > > -- 
> > > Those are my principles, and if you don't like them... well, I have others.
> > >                                                 -- Groucho Marx
> > > 
> > > ______________________________________________
> > > R-devel@stat.math.ethz.ch mailing list
> > > https://www.stat.math.ethz.ch/mailman/listinfo/r-devel
> > 
> > -- 
> > Douglas Bates                            bates@stat.wisc.edu
> > Statistics Department                    608/262-2598
> > University of Wisconsin - Madison        http://www.stat.wisc.edu/~bates/
> > 
> > ______________________________________________
> > R-devel@stat.math.ethz.ch mailing list
> > https://www.stat.math.ethz.ch/mailman/listinfo/r-devel
> > 
> 
> -- 
> Those are my principles, and if you don't like them... well, I have others.
>                                                 -- Groucho Marx

-- 
Those are my principles, and if you don't like them... well, I have others.
                                                -- Groucho Marx

From edd at debian.org  Sat Oct  4 16:56:44 2003
From: edd at debian.org (edd@debian.org)
Date: Sat Oct  4 15:56:05 2003
Subject: [Rd] Re: Bug#213857: r-base-core: xfig plot fails with invalid
	line type (PR#4401)
Message-ID: <200310041356.h94Dui0P004356@pubhealth.ku.dk>

On Fri, Oct 03, 2003 at 09:21:29AM -0500, Dirk Eddelbuettel wrote:
> On Fri, Oct 03, 2003 at 08:29:31AM -0500, Douglas Bates wrote:
> > edd@debian.org writes:
> > 
> > > Graham,
> > > 
> > > Confirmed. I will pass that along to the R team. As 1.8.0 is in code freeze,
> > > this may not get addressed, unfortunately.
> > > 
> > > Regards, Dirk
> > 
> > I believe Ross Ihaka has already detected and fixed this problem.  The
> > fix should be in today's beta version of R-1.8.0.  We hope it will
> > show up in the next Debian package Dirk makes for the unstable
> > (Debian) distribution.
> 
> Excellent news. I happened to have made releases on Saturday mornings for
> the last five or six weeks, so I'll see how tomorrow's version behaves.

Looks like it has been fixed (see below) in the 1.8.0beta of 2003-10-04
which is currently being uploaded. Hence, I'll close the bug report on the
Debian end.

Thanks, Dirk

edd@homebud:~/debian> R

R : Copyright 2003, The R Development Core Team
Version 1.8.0 beta (2003-10-04)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for a HTML browser interface to help.
Type 'q()' to quit R.

> data(cars)
> xfig("/tmp/cars.xfig") 
NULL
Warning message: 
xfig(/tmp/cars.xfig, onefile=FALSE) will only return the last plot 
> plot(cars)
> dev.off()
null device 
          1 
> q()
Save workspace image? [y/n/c]: n



> 
> Thanks, Dirk
> 
> > 
> > > 
> > > 
> > > On Fri, Oct 03, 2003 at 03:16:35PM +1000, Graham Williams wrote:
> > > > Package: r-base-core
> > > > Version: 1.7.1.cvs.20030927-1
> > > > Severity: normal
> > > > 
> > > > 
> > > > $ R
> > > > 
> > > > R : Copyright 2003, The R Development Core Team
> > > > Version 1.8.0 beta (2003-09-27)
> > > > 
> > > > ...
> > > > 
> > > > > data(cars)
> > > > > postscript("tmp.ps")
> > > > > plot(cars)
> > > > > xfig("tmp.fig", onefile=TRUE)
> > > > > plot(cars)
> > > > Error in plot.xy(xy, type, col = col, pch = pch, cex = cex, bg = bg, lty = lty,  : 
> > > > 	invalid line type: must be length 2, 4, 6 or 8
> > > > > 
> > > > 
> > > > No output is produced. 
> > > > 
> > > > Regards,
> > > > Graham
> > > > 
> > > > -- System Information:
> > > > Debian Release: testing/unstable
> > > > Architecture: i386
> > > > Kernel: Linux festiva.act.cmis.csiro.au 2.4.22-1-686 #4 Sun Sep 28 13:27:15 EST 2003 i686
> > > > Locale: LANG=C, LC_CTYPE=C (ignored: LC_ALL set to C)
> > > > 
> > > > Versions of packages r-base-core depends on:
> > > > ii  atlas2-base [atlas2]      3.2.1ln-11     Automatically Tuned Linear Algebra
> > > > ii  libbz2-1.0                1.0.2-1        A high-quality block-sorting file 
> > > > ii  libc6                     2.3.2-8        GNU C Library: Shared libraries an
> > > > ii  libg2c0                   1:3.3.2-0pre4  Runtime library for GNU Fortran 77
> > > > ii  libgcc1                   1:3.3.2-0pre4  GCC support library
> > > > ii  libjpeg62                 6b-8           The Independent JPEG Group's JPEG 
> > > > ii  libncurses5               5.3.20030719-2 Shared libraries for terminal hand
> > > > ii  libpcre3                  4.3-3          Philip Hazel's Perl 5 Compatible R
> > > > ii  libpng10-0                1.0.15-4       PNG library, older version - runti
> > > > ii  libreadline4              4.3-5          GNU readline and history libraries
> > > > ii  perl                      5.8.1-2        Larry Wall's Practical Extraction 
> > > > ii  tcl8.4                    8.4.4-1        Tcl (the Tool Command Language) v8
> > > > ii  tk8.4                     8.4.4-1        Tk toolkit for Tcl and X11, v8.4 -
> > > > ii  xlibs                     4.2.1-11       X Window System client libraries
> > > > ii  zlib-bin                  1:1.1.4-15     compression library - sample progr
> > > > ii  zlib1g                    1:1.1.4-15     compression library - runtime
> > > > 
> > > > -- no debconf information
> > > > 
> > > > 
> > > > 
> > > 
> > > -- 
> > > Those are my principles, and if you don't like them... well, I have others.
> > >                                                 -- Groucho Marx
> > > 
> > > ______________________________________________
> > > R-devel@stat.math.ethz.ch mailing list
> > > https://www.stat.math.ethz.ch/mailman/listinfo/r-devel
> > 
> > -- 
> > Douglas Bates                            bates@stat.wisc.edu
> > Statistics Department                    608/262-2598
> > University of Wisconsin - Madison        http://www.stat.wisc.edu/~bates/
> > 
> > ______________________________________________
> > R-devel@stat.math.ethz.ch mailing list
> > https://www.stat.math.ethz.ch/mailman/listinfo/r-devel
> > 
> 
> -- 
> Those are my principles, and if you don't like them... well, I have others.
>                                                 -- Groucho Marx

-- 
Those are my principles, and if you don't like them... well, I have others.
                                                -- Groucho Marx

From dmurdoch at pair.com  Sat Oct  4 11:05:52 2003
From: dmurdoch at pair.com (Duncan Murdoch)
Date: Sat Oct  4 16:04:58 2003
Subject: [Rd] latest beta + MinGW 3.1.0-1 = minor fix needed
In-Reply-To: <x2pthdtczk.fsf@biostat.ku.dk>
References: <3F7DACFF.9030306@math.uni-augsburg.de>
	<3F7DB32F.4030701@statistik.uni-dortmund.de>
	<x2pthdtczk.fsf@biostat.ku.dk>
Message-ID: <dfktnvoca4enj16f5a6hiomkhmc5be93r3@4ax.com>

On 04 Oct 2003 14:15:59 +0200, you wrote:

>Uwe Ligges <ligges@statistik.uni-dortmund.de> writes:
>
>> Simon Urbanek wrote:
>> 
>> > There are two possible fixes for this:
>> > 1) make sock.h use long instead of int.
>> > 2) use something like:
>> > #if defined Win32 && !defined _SSIZE_T_

>Fixes that are NOPs on non-broken setups should be allowable...
>Version 2) looks most correct to me: We want to use the system
>definition wherever it is available, and it would obviously only
>change anything on Win32.

It compiles fine in 3.3.1 with change 2).  I'll commit the change.  I
don't have 3.2.3 installed to test there, so could you try a build
soon Simon?

Duncan

From simon.urbanek at math.uni-augsburg.de  Sun Oct  5 01:05:25 2003
From: simon.urbanek at math.uni-augsburg.de (Simon Urbanek)
Date: Sun Oct  5 15:38:40 2003
Subject: [Rd] latest beta + MinGW 3.1.0-1 = minor fix needed
In-Reply-To: <dfktnvoca4enj16f5a6hiomkhmc5be93r3@4ax.com>
Message-ID: <DB1137B9-F6B6-11D7-AB30-000A959F327E@math.uni-augsburg.de>

On Saturday, October 4, 2003, at 04:05 PM, Duncan Murdoch wrote:

> It compiles fine in 3.3.1 with change 2).  I'll commit the change.  I
> don't have 3.2.3 installed to test there, so could you try a build
> soon Simon?

Thank you, Duncan, it compiles fine with MinGW 3.1.0-1 (@Peter: it uses 
[modified] gcc-3.2.3)

BTW: The "improved" sys/types.h is also contained in the 
mingw-runtime-3.1.tar.gz, so presumably you can use it with the gcc 
3.3.1 candidate as well.

Cheers,
Simon

From bates at stat.wisc.edu  Sun Oct  5 23:38:06 2003
From: bates at stat.wisc.edu (Douglas Bates)
Date: Mon Oct  6 00:38:08 2003
Subject: [Rd] Configuring R to use Goto's BLAS
Message-ID: <6r3ce7jomy.fsf@bates4.stat.wisc.edu>

Has anyone succeeded in getting the configure script for R to use
Goto's BLAS?  This library, usually configured to be -lgoto, is an
implementation of the BLAS that can be significantly faster than
atlas.  At present it is freely available for some architectures at
              http://www.cs.utexas.edu/users/flame/goto/
However, it is not open source.  You must install it yourself and
you cannot redistribute it.

I was able to compile a version of R using -lgoto by tweaking the
Makeconf file after it was generated by configure and before running
make.  On a naive test
 mm = matrix(rnorm(1e6), nc = 1e3)
 system.time(crossprod(mm))   
 # repeat the last call until the execution time stabilizes
I found that the execution time with -lgoto was about 80% of the
execution time for -lf77blas -latlas on this machine (Pentium 4, 512
KB L2 cache).  

One caveat, my version of atlas is somewhat out of date.

From skon at stats.snu.ac.kr  Mon Oct  6 13:22:36 2003
From: skon at stats.snu.ac.kr (skon@stats.snu.ac.kr)
Date: Mon Oct  6 12:21:44 2003
Subject: [Rd] rmultinom has a bug. (PR#4431)
Message-ID: <200310061022.h96AMa0P017688@pubhealth.ku.dk>

Full_Name: SungGON Yi.
Version: 1.7.1
OS: Windows 2000 pro
Submission from: (NULL) (147.46.24.107)


p <- runif(4)
rmultinom(1, 100, c(p, 0, 0, 0, 0))

That result are a wrong. For example,
     [,1]
[1,]   21
[2,]   59
[3,]    6
[4,]   NA
[5,]    0
[6,]    0
[7,]    0
[8,]    0

From maechler at stat.math.ethz.ch  Mon Oct  6 13:33:56 2003
From: maechler at stat.math.ethz.ch (maechler@stat.math.ethz.ch)
Date: Mon Oct  6 12:33:05 2003
Subject: [Rd] rmultinom has a bug. (PR#4431)
Message-ID: <200310061033.h96AXu0P017922@pubhealth.ku.dk>

>>>>> "skon" == skon  <skon@stats.snu.ac.kr>
>>>>>     on Mon, 6 Oct 2003 12:22:36 +0200 (MET DST) writes:

    skon> Full_Name: SungGON Yi.  Version: 1.7.1 OS: Windows
    skon> 2000 pro Submission from: (NULL) (147.46.24.107)

    skon> p <- runif(4) rmultinom(1, 100, c(p, 0, 0, 0, 0))

    skon> That result are a wrong. 

Confirmed for R 1.8.0 beta (on Linux).

Thank you for the report!
 
A slightly example is

  rmultinom(1,100, c(6, 8, 4, 0,0))

which has (almost?) always an  NA at the 3rd position.

I will investigate.

Martin Maechler <maechler@stat.math.ethz.ch>	http://stat.ethz.ch/~maechler/
Seminar fuer Statistik, ETH-Zentrum  LEO C16	Leonhardstr. 27
ETH (Federal Inst. Technology)	8092 Zurich	SWITZERLAND
phone: x-41-1-632-3408		fax: ...-1228			<><

From maechler at stat.math.ethz.ch  Mon Oct  6 16:05:11 2003
From: maechler at stat.math.ethz.ch (maechler@stat.math.ethz.ch)
Date: Mon Oct  6 15:04:20 2003
Subject: [Rd] rmultinom has a bug. (PR#4431)
Message-ID: <200310061305.h96D5B0P020753@pubhealth.ku.dk>

>>>>> "MM" == Martin Maechler <maechler@stat.math.ethz.ch>
>>>>>     on Mon, 6 Oct 2003 12:33:56 +0200 (MET DST) writes:

>>>>> "skon" == skon  <skon@stats.snu.ac.kr>
>>>>>     on Mon, 6 Oct 2003 12:22:36 +0200 (MET DST) writes:

    skon> Full_Name: SungGON Yi.  Version: 1.7.1 OS: Windows
    skon> 2000 pro Submission from: (NULL) (147.46.24.107)

    skon> p <- runif(4) rmultinom(1, 100, c(p, 0, 0, 0, 0))

    skon> That result are a wrong.

    MM> Confirmed for R 1.8.0 beta (on Linux).

    MM> Thank you for the report!
 
    MM> A slightly example is

    MM>   rmultinom(1,100, c(6, 8, 4, 0,0))

    MM> which has (almost?) always an NA at the 3rd position.

    MM> I will investigate.

and have now committed a bug fix (still in time for R 1.8.0).

The reason was that
    s := (a + b + c) - a - b  can be  >  c 
such that a call to rbinom(*, prob = s/c) gave NA, since s/c > 1

Martin Maechler <maechler@stat.math.ethz.ch>	http://stat.ethz.ch/~maechler/
Seminar fuer Statistik, ETH-Zentrum  LEO C16	Leonhardstr. 27
ETH (Federal Inst. Technology)	8092 Zurich	SWITZERLAND
phone: x-41-1-632-3408		fax: ...-1228			<><

From maechler at stat.math.ethz.ch  Mon Oct  6 19:18:14 2003
From: maechler at stat.math.ethz.ch (maechler@stat.math.ethz.ch)
Date: Mon Oct  6 18:18:06 2003
Subject: [Rd] getAnywhere (PR#4275)
Message-ID: <200310061618.h96GIE0P023037@pubhealth.ku.dk>

>>>>> "Mark" == Mark Bravington <Mark.Bravington@csiro.au>
>>>>>     on Wed, 24 Sep 2003 10:06:49 +0200 (MET DST) writes:

    Mark> 'getAnywhere' is not reporting methods when there are
    Mark> periods in the class name or the generic name (in R-devel).

    >> getAnywhere( 'predict.loess')
    Mark> A single object matching 'predict.loess' was found
    Mark> It was found in the following places
    Mark> registered S3 method for predict from namespace modreg
    Mark> namespace:modreg
    Mark> with value
    Mark> <<...>>

    >> getAnywhere( 'predict.smooth.spline.fit')
    Mark> A single object matching 'predict.smooth.spline.fit' was found
    Mark> It was found in the following places
    Mark> namespace:modreg
    Mark> with value
    Mark> <<...>>

    Mark> In the second case, the report doesn't state that
    Mark> 'predict.smooth.spline.fit' is a registered method.

    Mark> Also e.g.

    >> getAnywhere( 'as.dendrogram.hclust')

    Mark> doesn't report that this is a registered method.

    Mark> It looks like the two lines in 'getAnywhere' starting
    Mark> "gen <-" & "cl <- " might want to become:

    Mark> gen <- paste(parts[1:(i - 1)], collapse = ".")
    Mark> cl <- paste(parts[ i:length(parts)], collapse = ".")


Exactly!
Thank you, Mark, for the report and the proposed patch.

It is currently running the tests will most probably be
committed before tomorrows beta snapshot.

Martin Maechler

    Mark> Mark Bravington
    Mark> CSIRO (CMIS)
    Mark> PO Box 1538
    Mark> Castray Esplanade
    Mark> Hobart
    Mark> TAS 7001

    Mark> phone (61) 3 6232 5118
    Mark> fax (61) 3 6232 5012
    Mark> Mark.Bravington@csiro.au 

    Mark> --please do not edit the information below--

    Mark> Version:
    Mark> platform = i386-pc-mingw32
    Mark> arch = i386
    Mark> os = mingw32
    Mark> system = i386, mingw32
    Mark> status = alpha
    Mark> major = 1
    Mark> minor = 8.0
    Mark> year = 2003
    Mark> month = 09
    Mark> day = 22
    Mark> language = R

From jeff_hamann at hamanndonald.com  Mon Oct  6 11:17:38 2003
From: jeff_hamann at hamanndonald.com (Jeff D. Hamann)
Date: Mon Oct  6 19:17:06 2003
Subject: [Rd] getting names of p vector in nlm function...
Message-ID: <006901c38c2d$c161e0a0$0a00a8c0@rodan>

Dear R programming folks:

I'm trying to finish off a package for non-linear simultaneous system
estimation and I've been trying to figure out how to get the names of the
parameter vector variables when inside the function that nlm calls to return
the objective function value:

knls <- function( theta, eqns, data, fitmethod="OLS", instr=NULL, S=NULL )
  {

    ##     print( names( theta ) )              # returns NULL
    ## get the values of the parameters
    for( i in 1:length( theta ) )
      {
        val <- theta[i]
        storage.mode( val ) <-  "double"
        assign( names( theta )[i], val )          # gags here cause I can't
get the names...
      }

    ## resids = eval( lhs ) - eval( rhs )
    for( i in length( eqns ) )
      {
        lhs[[i]] <- eval( formula( eqns[[i]] )[2] )
        rhs[[i]] <- eval( formula( eqns[[i]] )[3] )
        residi[[i]] <- lhs[[i]] - rhs[[i]]
        r <- rbind( r, as.matrix( residi[[i]] ) )
      }

    ## blah, blah, blah....

    knls <- obj
}


print( "calling nlstest" )
demand2 <- q ~ d0 + d1 * p + d2 * d
supply2 <- q ~ s0 + s1 * p + s2 * f + s3 * a
system2 <- list( demand2, supply2 )
sv2 <- c(d0=3,d2=4,d1=4.234,s0=-2.123,s2=2.123,s3=4.234,s1=0.234)

### call the nlm function to get the estimates...
estnew <- nlm( knls, sv2, hessian=TRUE, print.level=1, eqns=system2,
data=kmenta, fitmethod="OLS" )

My question is why can't I simply call names on the vector (sv2) that is
passed into the nlm function to get the parameters? I was assuming that the
names, if available, are always present no matter where they get passed. Is
that not correct? Optim give the same results. Is it possible to "get"
nlm/optim to preserve the names without modifying the C code? I started
looking at the R and C code to examine where to change this and found the

SEXP do_nlm(SEXP call, SEXP op, SEXP args, SEXP rho)

function, but I'm not really sure how to modifiy yet to preserve the
variable names, if there are variable names when it gets to that function.
Plus I'd have to install lots of new and potentially conflicting tools on my
win32 machine and then debug to the code... so i think I'm going to have to
find another solution to my problem, which is a drag as the solution I
originally thought of (get the names from p vector) would be the best one so
far.



Thanks,
Jeff.


---
Jeff D. Hamann
Hamann, Donald and Associates, Inc.
PO Box 1421
Corvallis, Oregon USA 97339-1421
(office) 541-754-1428
(cell) 541-740-5988
jeff_hamann@hamanndonald.com
www.hamanndonald.com

From ripley at stats.ox.ac.uk  Mon Oct  6 20:20:17 2003
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Mon Oct  6 20:19:27 2003
Subject: [Rd] getting names of p vector in nlm function...
In-Reply-To: <006901c38c2d$c161e0a0$0a00a8c0@rodan>
Message-ID: <Pine.LNX.4.44.0310061914460.1563-100000@gannet.stats>

The names never change, so having nlm/optim preserve them is just a 
(considerable) waste of resources.  You can however pass them as a 
separate parameter via the ... argument of nlm/optim.

On Mon, 6 Oct 2003, Jeff D. Hamann wrote:

> Dear R programming folks:
> 
> I'm trying to finish off a package for non-linear simultaneous system
> estimation and I've been trying to figure out how to get the names of the
> parameter vector variables when inside the function that nlm calls to return
> the objective function value:
> 
> knls <- function( theta, eqns, data, fitmethod="OLS", instr=NULL, S=NULL )
>   {
> 
>     ##     print( names( theta ) )              # returns NULL
>     ## get the values of the parameters
>     for( i in 1:length( theta ) )
>       {
>         val <- theta[i]
>         storage.mode( val ) <-  "double"
>         assign( names( theta )[i], val )          # gags here cause I can't
> get the names...
>       }
> 
>     ## resids = eval( lhs ) - eval( rhs )
>     for( i in length( eqns ) )
>       {
>         lhs[[i]] <- eval( formula( eqns[[i]] )[2] )
>         rhs[[i]] <- eval( formula( eqns[[i]] )[3] )
>         residi[[i]] <- lhs[[i]] - rhs[[i]]
>         r <- rbind( r, as.matrix( residi[[i]] ) )
>       }
> 
>     ## blah, blah, blah....
> 
>     knls <- obj
> }
> 
> 
> print( "calling nlstest" )
> demand2 <- q ~ d0 + d1 * p + d2 * d
> supply2 <- q ~ s0 + s1 * p + s2 * f + s3 * a
> system2 <- list( demand2, supply2 )
> sv2 <- c(d0=3,d2=4,d1=4.234,s0=-2.123,s2=2.123,s3=4.234,s1=0.234)
> 
> ### call the nlm function to get the estimates...
> estnew <- nlm( knls, sv2, hessian=TRUE, print.level=1, eqns=system2,
> data=kmenta, fitmethod="OLS" )
> 
> My question is why can't I simply call names on the vector (sv2) that is
> passed into the nlm function to get the parameters? I was assuming that the
> names, if available, are always present no matter where they get passed. Is
> that not correct? Optim give the same results. Is it possible to "get"
> nlm/optim to preserve the names without modifying the C code? I started
> looking at the R and C code to examine where to change this and found the
> 
> SEXP do_nlm(SEXP call, SEXP op, SEXP args, SEXP rho)
> 
> function, but I'm not really sure how to modifiy yet to preserve the
> variable names, if there are variable names when it gets to that function.
> Plus I'd have to install lots of new and potentially conflicting tools on my
> win32 machine and then debug to the code... so i think I'm going to have to
> find another solution to my problem, which is a drag as the solution I
> originally thought of (get the names from p vector) would be the best one so
> far.
> 
> 
> 
> Thanks,
> Jeff.
> 
> 
> ---
> Jeff D. Hamann
> Hamann, Donald and Associates, Inc.
> PO Box 1421
> Corvallis, Oregon USA 97339-1421
> (office) 541-754-1428
> (cell) 541-740-5988
> jeff_hamann@hamanndonald.com
> www.hamanndonald.com
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://www.stat.math.ethz.ch/mailman/listinfo/r-devel
> 
> 

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From ripley at stats.ox.ac.uk  Tue Oct  7 10:01:25 2003
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue Oct  7 10:00:39 2003
Subject: [Rd] Building R forr Windows (was Adding Tk extensions to R for
	windows)
In-Reply-To: <8CBAA121CEB4D5118CB200508BB2BBEF0317E9BC@xmx8lonib.lonib.commerzbank.com>
Message-ID: <Pine.LNX.4.44.0310070853280.2798-100000@gannet.stats>

On Tue, 30 Sep 2003, Marsland, John wrote:

> Have you tried to make R under MSYS/MinGW, there would seem to be some
> obvious benefits to this over the current collection of Cygwin tools? In the
> end I don't think a separate windows install of R should be needed... in
> much the same way as the separate apple mac install has been discontinued in
> 1.8.0 now they have the osX/fink setup. I've had a play at configuring and
> making R with MSYS and I seem to be able to get quite a long way down the
> process, but I'd be interested in your views since you obviously have much
> more experience in this area.

MSYS is AFAIK based on a subset of Cygwin tools, similar to those we use.  
And we do use MinGW!  In the early days of MSYS its toolset was not
sufficient, and anyway we don't have the resources to replace working
methods. The `obvious benefits to this' are not obvious from your message!

There is a great deal of Windows-specific code in R.  One day we may 
attempt to use a common set of Makefiles generated by configure for the 
Windows port, but do be aware that it is only fairly recently that R's 
configure even ran under the Cygwin tools.

> 
> Regards,
> John Marsland
> 
> > -----Original Message-----
> > From: wettenhall@wehi.EDU.AU [mailto:wettenhall@wehi.EDU.AU]
> > Sent: 30 September 2003 08:42
> > To: r-devel@stat.math.ethz.ch
> > Subject: [Rd] Adding Tk extensions to R for windows
> > 
> > 
> > Hi,
> > 
> > I'm developing an R/TclTk application which uses the BWidget and
> > Tktable Tk extensions and I'm trying to make it easy to install.
> > For now, I'm focusing on Windows users who start with nothing.
> > 
> > I have built Tcl/Tk and Tktable for windows using Msys/MinGW.
> > (BWidget contains only Tcl scripts so does not need building.)
> > I have then copied Tktable and BWidget into the lib subdirectory
> > of the Tcl directory in R source, created by unzipping R_Tcl.zip
> > from Brian Ripley's webpage.  (I should also try creating the
> > entire R_Tcl.zip myself, rather than mixing and matching.)
> > Finally I have followed the instructions in src/gnuwin32/INSTALL
> > including "make distribution" which has built
> > an R installation wizard including the Tk extensions.
> > 
> > It seems to work fine and I don't think I've violated any
> > license agreements - it's my understanding that Tktable and
> > BWidget source (both on sourceforge) are under BSD, like the other
> > Tcl already included with R.
> > 
> > Of course some would say that you can build faster and smaller Tcl
> > libraries using Visual C++.  I didn't notice much difference with my
> > application running Tktable.  I did try buildling Tcl/Tk with the
> > free version of VC++.NET SDK but nmake -f makefile.vc in
> > Tcl_source/win/ complained that vcvars32.bat needed to be run.  The
> > latest version of the (free) VC++.NET SDK seems to only have 
> > sdkvars.bat,
> > which does something similar to vcvars32.bat (i.e. set PATH, INCLUDE,
> > LIB and NetSamplePath), but running it didn't seem to help so I turned
> > to Msys/MinGW.  Maybe I should buy the full Visual C++/Visual Studio?
> > 
> > I'm wondering whether anyone would like to point out any potential
> > problems (license or otherwise) with distributing a customized R
> > installation wizard.
> > 
> > Also, I would be happy to become involved in the maintenance/testing
> > of R_Tcl.zip for windows if I'm qualified, but I suppose this would
> > require buying the full Visual C++/Visual Studio, right?
> > 
> > If there is sufficient building/testing from volunteers, are 
> > the R core
> > developers considering bundling more Tcl/Tk packages with R, 
> > or does the
> > problem of HOW MANY packages/megabytes to add mean that there 
> > would always
> > have to be a separate "batteries included" installation wizard?
> > 
> > Regards,
> > James
> > 
> > ______________________________________________
> > R-devel@stat.math.ethz.ch mailing list
> > https://www.stat.math.ethz.ch/mailman/listinfo/r-devel
> > 
> 
> 
> ********************************************************************** 
> This is a commercial communication from Commerzbank AG.\ \ T...{{dropped}}
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://www.stat.math.ethz.ch/mailman/listinfo/r-devel
> 
> 

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From ripley at stats.ox.ac.uk  Tue Oct  7 13:00:48 2003
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue Oct  7 12:59:56 2003
Subject: [Rd] Problem with console in Windows GUI (PR#4381)
In-Reply-To: <200310011924.h91JO00P005154@pubhealth.ku.dk>
Message-ID: <Pine.LNX.4.44.0310071157540.3195-100000@gannet.stats>

On Wed, 1 Oct 2003 andrew_zachary@yahoo.com wrote:

> Full_Name: Andrew Zachary
> Version: 1.7.1
> OS: XP Pro
> Submission from: (NULL) (24.44.128.138)
> 
> 
> The R-console window in the Windows GUI has a nice feature that lets you save
> your preferences for font sizes and background and foreground colors. Unhappily,
> there is no way to load these preferences back in when starting a new session.

Yes, there is: it's described in the README(.rw1071) no less.  At Startup
the settings are read from a Rconsole file: see ?Rconsole.

> Also, the scroll window for selecting colors is very small and awkward. If I
> want to select a color which is towards the top or the bottom of the list, I
> have to scrolls (slowly) through all the entries to get to it. Would make more
> sense to have a color window with user-selectable colors.

You are welcome to supply code for that enhancement.  Some of us would 
just edit the Rconsole file in a text editor.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From R.P.P.P.Grasman at uva.nl  Tue Oct  7 18:06:37 2003
From: R.P.P.P.Grasman at uva.nl (R.P.P.P.Grasman@uva.nl)
Date: Tue Oct  7 17:05:43 2003
Subject: [Rd] (PR#4450)
Message-ID: <200310071506.h97F6b0P005877@pubhealth.ku.dk>

This is a multi-part message in MIME format.

------_=_NextPart_001_01C38CE4.8296F0E8
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable

Hello,

When I use det() and qr() on complex matrices the result is in some =
cases indeterministic. The documentation speaks of numeric matrices (and =
not of complex matrices) but det() uses qr() which should handle complex =
matrices correctly. I've also tried using only qr() with=20

similar results. det() returns a value that is not the determinant of =
the complex matrix (in accordance with documentations limitation to =
numeric matrices), whereas the product of the eigenvalues obtained with =
eigen() does evaluate to the determinant of the matrix.

To repeat the error in a simple as possible example I did the following:

I freshly started R without loading any previously stored image.

> m =3D matrix(complex(re=3Drnorm(9),im=3Drnorm(9)),3,3)     # multiple =
m's were tried
> m
                       [,1]                   [,2]                  [,3]
[1,] -0.56135706+0.9346292i  0.3626032+0.73012622i -0.6629864+0.9328771i
[2,] -0.05999599-0.6931185i -1.4558785+0.66410894i  0.8503606-1.0104882i
[3,] -1.29420594-1.0878549i  0.7834801+0.01872038i -0.6378357-0.6318547i

> y =3D sapply(1:10000,function(i) det(m)); plot.ts(y)   # may need =
repetition
> var(y)
[1] 3.940272

The plot shows that the sign of det alternates indeterministically (at =
least for some m generated this way, like the m attached in the m.RData =
file).

I note that a similar problem was reported in =
http://www.r-project.org/nocvs/mail/r-devel/2002/0139.html but I =
couldn't find a report of this particular problem.

I would suggest to make det compatible with complex matrices, or at =
least give a warning.

Regards,

Raoul

--please do not edit the information below--

Version:
 platform =3D i386-pc-mingw32
 arch =3D i386
 os =3D mingw32
 system =3D i386, mingw32
 status =3D=20
 major =3D 1
 minor =3D 6.2
 year =3D 2003
 month =3D 01
 day =3D 10
 language =3D R

Windows 2000 Professional (build 2195) Service Pack 4.0

Search Path:
 .GlobalEnv, package:ctest, Autoloads, package:base

=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D
Raoul Grasman=20
Dept. Psychology, University of Amsterdam,=20
Roetersstraat 15,=20
NL-1018WB Amsterdam,=20
the Netherlands=20

------_=_NextPart_001_01C38CE4.8296F0E8
Content-Type: application/octet-stream;
	name="m.RData"
Content-Transfer-Encoding: base64
Content-Description: m.RData
Content-Disposition: attachment;
	filename="m.RData"

UkRYMgpYCgAAAAIAAQYCAAEEAAAABAIAAAABAAAUCQAAAAFtAAAGDwAAAAm/4fajFV1ooD/t6HuU
QlCJv663y3lnKNW/5i4GxKJJfb/0tRFJVJHWv/Fn2oR6dZo/1zTj5yLpqz/nXTGnpxkHv/dLRzco
N1o/5UBhZata/j/pEkTh+iUSP5Mrb6S0Og6/5TcvVgz0Qj/t2iEFmcxnP+s2J4Vrlz2/8Cr1pNXk
t7/kaSZQc/rMv+Q4J2iz9qUAAAQCAAAAAQAAFAkAAAADZGltAAAEDQAAAAIAAAADAAAAAwAAAP4A
AAD+

------_=_NextPart_001_01C38CE4.8296F0E8--

From bates at stat.wisc.edu  Tue Oct  7 17:00:01 2003
From: bates at stat.wisc.edu (Douglas Bates)
Date: Tue Oct  7 18:00:05 2003
Subject: [Rd] (PR#4450)
In-Reply-To: <200310071506.h97F6b0P005877@pubhealth.ku.dk>
References: <200310071506.h97F6b0P005877@pubhealth.ku.dk>
Message-ID: <6r4qylxck7.fsf@bates4.stat.wisc.edu>

This is fixed (sort of) in R-1.8.0 which explicitly says that the det
function does not handle complex matrices.

> m = matrix(complex(re=rnorm(9),im=rnorm(9)),3,3)
> det(m)
Error in determinant.matrix(x, logarithm = TRUE, ...) : 
	determinant not currently defined for complex matrices

R.P.P.P.Grasman@uva.nl writes:

> This is a multi-part message in MIME format.
> 
> ------_=_NextPart_001_01C38CE4.8296F0E8
> Content-Type: text/plain;
> 	charset="iso-8859-1"
> Content-Transfer-Encoding: quoted-printable
> 
> Hello,
> 
> When I use det() and qr() on complex matrices the result is in some =
> cases indeterministic. The documentation speaks of numeric matrices (and =
> not of complex matrices) but det() uses qr() which should handle complex =
> matrices correctly. I've also tried using only qr() with=20
> 
> similar results. det() returns a value that is not the determinant of =
> the complex matrix (in accordance with documentations limitation to =
> numeric matrices), whereas the product of the eigenvalues obtained with =
> eigen() does evaluate to the determinant of the matrix.
> 
> To repeat the error in a simple as possible example I did the following:
> 
> I freshly started R without loading any previously stored image.
> 
> > m =3D matrix(complex(re=3Drnorm(9),im=3Drnorm(9)),3,3)     # multiple =
> m's were tried
> > m
>                        [,1]                   [,2]                  [,3]
> [1,] -0.56135706+0.9346292i  0.3626032+0.73012622i -0.6629864+0.9328771i
> [2,] -0.05999599-0.6931185i -1.4558785+0.66410894i  0.8503606-1.0104882i
> [3,] -1.29420594-1.0878549i  0.7834801+0.01872038i -0.6378357-0.6318547i
> 
> > y =3D sapply(1:10000,function(i) det(m)); plot.ts(y)   # may need =
> repetition
> > var(y)
> [1] 3.940272
> 
> The plot shows that the sign of det alternates indeterministically (at =
> least for some m generated this way, like the m attached in the m.RData =
> file).
> 
> I note that a similar problem was reported in =
> http://www.r-project.org/nocvs/mail/r-devel/2002/0139.html but I =
> couldn't find a report of this particular problem.
> 
> I would suggest to make det compatible with complex matrices, or at =
> least give a warning.
> 
> Regards,
> 
> Raoul
> 
> --please do not edit the information below--
> 
> Version:
>  platform =3D i386-pc-mingw32
>  arch =3D i386
>  os =3D mingw32
>  system =3D i386, mingw32
>  status =3D=20
>  major =3D 1
>  minor =3D 6.2
>  year =3D 2003
>  month =3D 01
>  day =3D 10
>  language =3D R
> 
> Windows 2000 Professional (build 2195) Service Pack 4.0
> 
> Search Path:
>  .GlobalEnv, package:ctest, Autoloads, package:base
> 
> =3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
> =3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
> =3D=3D=3D=3D=3D=3D=3D=3D
> Raoul Grasman=20
> Dept. Psychology, University of Amsterdam,=20
> Roetersstraat 15,=20
> NL-1018WB Amsterdam,=20
> the Netherlands=20
> 
> ------_=_NextPart_001_01C38CE4.8296F0E8
> Content-Type: application/octet-stream;
> 	name="m.RData"
> Content-Transfer-Encoding: base64
> Content-Description: m.RData
> Content-Disposition: attachment;
> 	filename="m.RData"
> 
> UkRYMgpYCgAAAAIAAQYCAAEEAAAABAIAAAABAAAUCQAAAAFtAAAGDwAAAAm/4fajFV1ooD/t6HuU
> QlCJv663y3lnKNW/5i4GxKJJfb/0tRFJVJHWv/Fn2oR6dZo/1zTj5yLpqz/nXTGnpxkHv/dLRzco
> N1o/5UBhZata/j/pEkTh+iUSP5Mrb6S0Og6/5TcvVgz0Qj/t2iEFmcxnP+s2J4Vrlz2/8Cr1pNXk
> t7/kaSZQc/rMv+Q4J2iz9qUAAAQCAAAAAQAAFAkAAAADZGltAAAEDQAAAAIAAAADAAAAAwAAAP4A
> AAD+
> 
> ------_=_NextPart_001_01C38CE4.8296F0E8--
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://www.stat.math.ethz.ch/mailman/listinfo/r-devel

-- 
Douglas Bates                            bates@stat.wisc.edu
Statistics Department                    608/262-2598
University of Wisconsin - Madison        http://www.stat.wisc.edu/~bates/

From p.murrell at auckland.ac.nz  Wed Oct  8 05:28:31 2003
From: p.murrell at auckland.ac.nz (p.murrell@auckland.ac.nz)
Date: Wed Oct  8 04:27:39 2003
Subject: [Rd] Redhat 7.2 gcc optimisation (PR#4459)
Message-ID: <200310080228.h982SV0P009528@pubhealth.ku.dk>

Hi

The the gcc on Redhat 7.2 with default C compiler configuration setting 
CFLAGS="-g -O2" produces some worrying differences in output compared to 
CFLAGS="-g -Wall -pedantic"

The following differences were seen in graphical output from running 
examples:

besselI
     DIFFERENCE in example 4
     DIFFERENCE in example 5
(1e+00 becomes 1e-00 in axis label)
--
co.intervals
     DIFFERENCE in example 8
(third y-value in lowess curve different)!!!
--
dnbinom
     DIFFERENCE in example 2
(contour line labels at different locations)
--
pbirthday
     DIFFERENCE in example 1
(1e+00 becomes 1e-00 in axis label)
--
persp
     DIFFERENCE in example 3
(order of drawing surface facets different)


####### Reproduction details

Differences were detected in graphics output using the graphicsQC 
package (see http://www.stat.auckland.ac.nz/~paul/index.html) and ...

model.graphics(package="base", device="postscript", format="pbm",
                model.loc="model", verbose=TRUE)

... to produce output for CFLAGS="-g -O2" and ...

test.graphics(package="base", device="postscript", format="pbm",
               model.loc="model", test.loc="test", verbose=TRUE)

... to produce output for CFLAGS="-g -Wall -pedantic"

Paul

--please do not edit the information below--

Version:
  platform = i686-pc-linux-gnu
  arch = i686
  os = linux-gnu
  system = i686, linux-gnu
  status = beta
  major = 1
  minor = 8.0
  year = 2003
  month = 10
  day = 07
  language = R

Search Path:
  .GlobalEnv, package:methods, package:ctest, package:mva, 
package:modreg, package:nls, package:ts, package:lattice, package:grid, 
package:graphicsQC, Autoloads, package:base

-- 
Dr Paul Murrell
Department of Statistics
The University of Auckland
Private Bag 92019
Auckland
New Zealand
64 9 3737599 x85392
paul@stat.auckland.ac.nz
http://www.stat.auckland.ac.nz/~paul/

From arnima at u.washington.edu  Wed Oct  8 06:01:51 2003
From: arnima at u.washington.edu (arnima@u.washington.edu)
Date: Wed Oct  8 05:00:59 2003
Subject: [Rd] Unpredictable EPS->PDF rotation (PR#4460)
Message-ID: <200310080301.h9831p0P009665@pubhealth.ku.dk>

Dear r-bugs,

When I create EPS files, they sometimes appear rotated in my LaTeX PDF
document and sometimes they don't. Two examples:

## x1.eps is not rotated in LaTeX
x <- seq(-1, 1, length=100)
postscript("c:/x1.eps", height=3, width=4,
           horizontal=FALSE, onefile=FALSE, paper="special")
plot(x, dnorm(x), type="l")
dev.off()

## x2.eps is not rotated in LaTeX
x <- seq(-2, 2, length=100)
postscript("c:/x2.eps", height=3, width=4,
           horizontal=FALSE, onefile=FALSE, paper="special")
plot(x, dnorm(x), type="l")
dev.off()

By LaTeX PDF, I am referring to the dvips->ghostscript pathway, but x2.eps
also rotates when distilled into PDF outside LaTeX. I have tried
ghostscript and acrobat, placed on a page or cropped, so the problem does
not seem to be confounded with particular PDF distillation software.

I'm aware of the pdf() device in R, but EPS files are a widely used format
to share scientific graphics, often winding up embedded in a PDF document
at a later point in the hands of an editor.

If at all possible, a more predictable postscript generator would be
appreciated, where EPS figures would not rotate when embedded in PDF
documents.

Regards,
Arni

OS:   Windows XP
R:    1.7.1

From p.dalgaard at biostat.ku.dk  Wed Oct  8 10:34:24 2003
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard BSA)
Date: Wed Oct  8 11:34:27 2003
Subject: [Rd] Unpredictable EPS->PDF rotation (PR#4460)
In-Reply-To: <200310080301.h9831p0P009665@pubhealth.ku.dk>
References: <200310080301.h9831p0P009665@pubhealth.ku.dk>
Message-ID: <x2oewsgjez.fsf@biostat.ku.dk>

arnima@u.washington.edu writes:

> Dear r-bugs,
> 
> When I create EPS files, they sometimes appear rotated in my LaTeX PDF
> document and sometimes they don't. Two examples:
> 
> ## x1.eps is not rotated in LaTeX
> x <- seq(-1, 1, length=100)
> postscript("c:/x1.eps", height=3, width=4,
>            horizontal=FALSE, onefile=FALSE, paper="special")
> plot(x, dnorm(x), type="l")
> dev.off()
> 
> ## x2.eps is not rotated in LaTeX
> x <- seq(-2, 2, length=100)
> postscript("c:/x2.eps", height=3, width=4,
>            horizontal=FALSE, onefile=FALSE, paper="special")
> plot(x, dnorm(x), type="l")
> dev.off()
> 
> By LaTeX PDF, I am referring to the dvips->ghostscript pathway, but x2.eps
> also rotates when distilled into PDF outside LaTeX. I have tried
> ghostscript and acrobat, placed on a page or cropped, so the problem does
> not seem to be confounded with particular PDF distillation software.
> 
> I'm aware of the pdf() device in R, but EPS files are a widely used format
> to share scientific graphics, often winding up embedded in a PDF document
> at a later point in the hands of an editor.
> 
> If at all possible, a more predictable postscript generator would be
> appreciated, where EPS figures would not rotate when embedded in PDF
> documents.

I can reproduce the effect on RedHat 8, but I'm at a loss as to
explain it. The headers and bounding boxes of the two .eps files are
identical and to the best of my eyesight they are also using the same
coordinate system.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From maechler at stat.math.ethz.ch  Wed Oct  8 13:09:17 2003
From: maechler at stat.math.ethz.ch (maechler@stat.math.ethz.ch)
Date: Wed Oct  8 12:08:26 2003
Subject: [Rd] Unpredictable EPS->PDF rotation (PR#4460)
Message-ID: <200310081009.h98A9H0P014475@pubhealth.ku.dk>

>>>>> "PD" == Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
>>>>>     on 08 Oct 2003 11:36:52 +0200 writes:

    PD> arnima@u.washington.edu writes:
    >> Dear r-bugs,
    >> 
    >> When I create EPS files, they sometimes appear rotated in my LaTeX PDF
    >> document and sometimes they don't. Two examples:
    >> 
    >> ## x1.eps is not rotated in LaTeX
    >> x <- seq(-1, 1, length=100)
    >> postscript("c:/x1.eps", height=3, width=4,
    >> horizontal=FALSE, onefile=FALSE, paper="special")
    >> plot(x, dnorm(x), type="l")
    >> dev.off()
    >> 
    >> ## x2.eps is not rotated in LaTeX
    >> x <- seq(-2, 2, length=100)
    >> postscript("c:/x2.eps", height=3, width=4,
    >> horizontal=FALSE, onefile=FALSE, paper="special")
    >> plot(x, dnorm(x), type="l")
    >> dev.off()
    >> 
    >> By LaTeX PDF, I am referring to the dvips->ghostscript pathway, but x2.eps
    >> also rotates when distilled into PDF outside LaTeX. I have tried
    >> ghostscript and acrobat, placed on a page or cropped, so the problem does
    >> not seem to be confounded with particular PDF distillation software.
    >> 
    >> I'm aware of the pdf() device in R, but EPS files are a widely used format
    >> to share scientific graphics, often winding up embedded in a PDF document
    >> at a later point in the hands of an editor.
    >> 
    >> If at all possible, a more predictable postscript generator would be
    >> appreciated, where EPS figures would not rotate when embedded in PDF
    >> documents.

    PD> I can reproduce the effect on RedHat 8, but I'm at a loss as to
    PD> explain it. The headers and bounding boxes of the two .eps files are
    PD> identical and to the best of my eyesight they are also using the same
    PD> coordinate system.

It's definitely unrelated to R.

The "bug" is in newer versions of gs (ghostscript) which does
rotate plots under some circumstances by default.

Of course, the authors of gs consider this a feature (called
"AutoRotatePages"), but IMO it's been a very bad design-decision.

Here, we have implemented a workaround by patching the
"epstopdf" (shell script) (we use the version from teTeX), by
the following:

--- epstopdf.~1~	2002-04-20 00:00:00.000000000 +0200
+++ epstopdf	2003-03-13 16:43:53.000000000 +0100
@@ -182,6 +182,8 @@
 ### open output file
 if ($::opt_gs) {
   my $pipe = "$GS -q -sDEVICE=pdfwrite $GSOPTS " .
+          "-dAutoRotatePages=/None " . ## MMä: <<<< This is the fix I found via google
+## http://lists.debian.org/debian-tetex-maint/2002/debian-tetex-maint-200202/msg00013.html
           "-sOutputFile=$OutputFilename - -c quit";
   debug "Ghostscript pipe:", $pipe;
   open(OUT,"|$pipe") or error "Cannot open Ghostscript for piped input";

-------------------

I'm interested to hear about more current workarounds /
"official" ways to deal with this ``cool gs feature'' ..

Martin Maechler <maechler@stat.math.ethz.ch>	http://stat.ethz.ch/~maechler/
Seminar fuer Statistik, ETH-Zentrum  LEO C16	Leonhardstr. 27
ETH (Federal Inst. Technology)	8092 Zurich	SWITZERLAND
phone: x-41-1-632-3408		fax: ...-1228			<><

From ripley at stats.ox.ac.uk  Wed Oct  8 12:30:51 2003
From: ripley at stats.ox.ac.uk (Prof Brian D Ripley)
Date: Wed Oct  8 12:30:05 2003
Subject: [Rd] Unpredictable EPS->PDF rotation (PR#4460)
In-Reply-To: <x2oewsgjez.fsf@biostat.ku.dk>
Message-ID: <Pine.WNT.4.44.0310081125030.3432-100000@gannet.stats.ox.ac.uk>

On 8 Oct 2003, Peter Dalgaard BSA wrote:

> arnima@u.washington.edu writes:
>
> > Dear r-bugs,
> >
> > When I create EPS files, they sometimes appear rotated in my LaTeX PDF
> > document and sometimes they don't. Two examples:
> >
> > ## x1.eps is not rotated in LaTeX
> > x <- seq(-1, 1, length=100)
> > postscript("c:/x1.eps", height=3, width=4,
> >            horizontal=FALSE, onefile=FALSE, paper="special")
> > plot(x, dnorm(x), type="l")
> > dev.off()
> >
> > ## x2.eps is not rotated in LaTeX
> > x <- seq(-2, 2, length=100)
> > postscript("c:/x2.eps", height=3, width=4,
> >            horizontal=FALSE, onefile=FALSE, paper="special")
> > plot(x, dnorm(x), type="l")
> > dev.off()
> >
> > By LaTeX PDF, I am referring to the dvips->ghostscript pathway, but x2.eps
> > also rotates when distilled into PDF outside LaTeX. I have tried
> > ghostscript and acrobat, placed on a page or cropped, so the problem does
> > not seem to be confounded with particular PDF distillation software.
> >
> > I'm aware of the pdf() device in R, but EPS files are a widely used format
> > to share scientific graphics, often winding up embedded in a PDF document
> > at a later point in the hands of an editor.
> >
> > If at all possible, a more predictable postscript generator would be
> > appreciated, where EPS figures would not rotate when embedded in PDF
> > documents.

I think this is nothing to do with R, which generates predictable
postscript for me.

> I can reproduce the effect on RedHat 8, but I'm at a loss as to

Perhaps you could tells us what the effect is (the original message says
neither is rotated!) and how exactly to reproduce it?

I found that x1.eps is not rotated by Distiller, but x2.eps is.  That's not
a bug but intentional: Distiller (on its default settings) does auto-rotate
individual pages of eps files.  My guess is that gs is doing something
similar on your setup -- it rotates for me under gs8.00 unless I set
AutoRotate to /None (I used Convert in GSView to do so).

> explain it. The headers and bounding boxes of the two .eps files are
> identical and to the best of my eyesight they are also using the same
> coordinate system.
>

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From ripley at stats.ox.ac.uk  Wed Oct  8 13:31:01 2003
From: ripley at stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Wed Oct  8 12:30:22 2003
Subject: [Rd] Unpredictable EPS->PDF rotation (PR#4460)
Message-ID: <200310081031.h98AV10P014923@pubhealth.ku.dk>

On 8 Oct 2003, Peter Dalgaard BSA wrote:

> arnima@u.washington.edu writes:
>
> > Dear r-bugs,
> >
> > When I create EPS files, they sometimes appear rotated in my LaTeX PDF
> > document and sometimes they don't. Two examples:
> >
> > ## x1.eps is not rotated in LaTeX
> > x <- seq(-1, 1, length=100)
> > postscript("c:/x1.eps", height=3, width=4,
> >            horizontal=FALSE, onefile=FALSE, paper="special")
> > plot(x, dnorm(x), type="l")
> > dev.off()
> >
> > ## x2.eps is not rotated in LaTeX
> > x <- seq(-2, 2, length=100)
> > postscript("c:/x2.eps", height=3, width=4,
> >            horizontal=FALSE, onefile=FALSE, paper="special")
> > plot(x, dnorm(x), type="l")
> > dev.off()
> >
> > By LaTeX PDF, I am referring to the dvips->ghostscript pathway, but x2.eps
> > also rotates when distilled into PDF outside LaTeX. I have tried
> > ghostscript and acrobat, placed on a page or cropped, so the problem does
> > not seem to be confounded with particular PDF distillation software.
> >
> > I'm aware of the pdf() device in R, but EPS files are a widely used format
> > to share scientific graphics, often winding up embedded in a PDF document
> > at a later point in the hands of an editor.
> >
> > If at all possible, a more predictable postscript generator would be
> > appreciated, where EPS figures would not rotate when embedded in PDF
> > documents.

I think this is nothing to do with R, which generates predictable
postscript for me.

> I can reproduce the effect on RedHat 8, but I'm at a loss as to

Perhaps you could tells us what the effect is (the original message says
neither is rotated!) and how exactly to reproduce it?

I found that x1.eps is not rotated by Distiller, but x2.eps is.  That's not
a bug but intentional: Distiller (on its default settings) does auto-rotate
individual pages of eps files.  My guess is that gs is doing something
similar on your setup -- it rotates for me under gs8.00 unless I set
AutoRotate to /None (I used Convert in GSView to do so).

> explain it. The headers and bounding boxes of the two .eps files are
> identical and to the best of my eyesight they are also using the same
> coordinate system.
>

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From ripley at stats.ox.ac.uk  Wed Oct  8 12:33:25 2003
From: ripley at stats.ox.ac.uk (Prof Brian D Ripley)
Date: Wed Oct  8 12:32:40 2003
Subject: [Rd] Unpredictable EPS->PDF rotation (PR#4460)
In-Reply-To: <200310081009.h98A9H0P014475@pubhealth.ku.dk>
Message-ID: <Pine.WNT.4.44.0310081131210.3432-100000@gannet.stats.ox.ac.uk>

On Wed, 8 Oct 2003 maechler@stat.math.ethz.ch wrote:

> >>>>> "PD" == Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
> >>>>>     on 08 Oct 2003 11:36:52 +0200 writes:
>
>     PD> arnima@u.washington.edu writes:
>     >> Dear r-bugs,
>     >>
>     >> When I create EPS files, they sometimes appear rotated in my LaTeX PDF
>     >> document and sometimes they don't. Two examples:
>     >>
>     >> ## x1.eps is not rotated in LaTeX
>     >> x <- seq(-1, 1, length=100)
>     >> postscript("c:/x1.eps", height=3, width=4,
>     >> horizontal=FALSE, onefile=FALSE, paper="special")
>     >> plot(x, dnorm(x), type="l")
>     >> dev.off()
>     >>
>     >> ## x2.eps is not rotated in LaTeX
>     >> x <- seq(-2, 2, length=100)
>     >> postscript("c:/x2.eps", height=3, width=4,
>     >> horizontal=FALSE, onefile=FALSE, paper="special")
>     >> plot(x, dnorm(x), type="l")
>     >> dev.off()
>     >>
>     >> By LaTeX PDF, I am referring to the dvips->ghostscript pathway, but x2.eps
>     >> also rotates when distilled into PDF outside LaTeX. I have tried
>     >> ghostscript and acrobat, placed on a page or cropped, so the problem does
>     >> not seem to be confounded with particular PDF distillation software.
>     >>
>     >> I'm aware of the pdf() device in R, but EPS files are a widely used format
>     >> to share scientific graphics, often winding up embedded in a PDF document
>     >> at a later point in the hands of an editor.
>     >>
>     >> If at all possible, a more predictable postscript generator would be
>     >> appreciated, where EPS figures would not rotate when embedded in PDF
>     >> documents.
>
>     PD> I can reproduce the effect on RedHat 8, but I'm at a loss as to
>     PD> explain it. The headers and bounding boxes of the two .eps files are
>     PD> identical and to the best of my eyesight they are also using the same
>     PD> coordinate system.
>
> It's definitely unrelated to R.
>
> The "bug" is in newer versions of gs (ghostscript) which does
> rotate plots under some circumstances by default.
>
> Of course, the authors of gs consider this a feature (called
> "AutoRotatePages"), but IMO it's been a very bad design-decision.

I agree, but it copies Distiller which has long done this.  Using
page-by-page as the default (as Distiller does) is particularly annoying.

> Here, we have implemented a workaround by patching the
> "epstopdf" (shell script) (we use the version from teTeX), by
> the following:
>
> --- epstopdf.~1~	2002-04-20 00:00:00.000000000 +0200
> +++ epstopdf	2003-03-13 16:43:53.000000000 +0100
> @@ -182,6 +182,8 @@
>  ### open output file
>  if ($::opt_gs) {
>    my $pipe = "$GS -q -sDEVICE=pdfwrite $GSOPTS " .
> +          "-dAutoRotatePages=/None " . ## MMä: <<<< This is the fix I found via google
> +## http://lists.debian.org/debian-tetex-maint/2002/debian-tetex-maint-200202/msg00013.html
>            "-sOutputFile=$OutputFilename - -c quit";
>    debug "Ghostscript pipe:", $pipe;
>    open(OUT,"|$pipe") or error "Cannot open Ghostscript for piped input";
>
> -------------------
>
> I'm interested to hear about more current workarounds /
> "official" ways to deal with this ``cool gs feature'' ..

That is the fix I know, but it can be set in GSView (Windows ...) from the
Properties.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From Ted.Harding at nessie.mcc.ac.uk  Wed Oct  8 13:04:58 2003
From: Ted.Harding at nessie.mcc.ac.uk ( (Ted Harding))
Date: Wed Oct  8 13:21:14 2003
Subject: [Rd] Unpredictable EPS->PDF rotation (PR#4460)
In-Reply-To: <200310080301.h9831p0P009665@pubhealth.ku.dk>
Message-ID: <XFMail.031008120346.Ted.Harding@nessie.mcc.ac.uk>

On 08-Oct-03 arnima@u.washington.edu wrote:
> When I create EPS files, they sometimes appear rotated in my LaTeX PDF
> document and sometimes they don't. Two examples:
> 
>## x1.eps is not rotated in LaTeX
> x <- seq(-1, 1, length=100)
> postscript("c:/x1.eps", height=3, width=4,
>            horizontal=FALSE, onefile=FALSE, paper="special")
> plot(x, dnorm(x), type="l")
> dev.off()
> 
>## x2.eps is not rotated in LaTeX
> x <- seq(-2, 2, length=100)
> postscript("c:/x2.eps", height=3, width=4,
>            horizontal=FALSE, onefile=FALSE, paper="special")
> plot(x, dnorm(x), type="l")
> dev.off()
> 
> By LaTeX PDF, I am referring to the dvips->ghostscript pathway, but
> x2.eps
> also rotates when distilled into PDF outside LaTeX. I have tried
> ghostscript and acrobat, placed on a page or cropped, so the problem
> does not seem to be confounded with particular PDF distillation
> software.

I've done an experiment or two (and I've read Peter Dalgaard's reply).

Using Red Hat 9, I imported the two files x1.eps and x2.eps as output
by R-1.7.1 into a groff document, both on one page and one above the
other, outputting the result as a PS file, temp.ps.

Using ghostview, the result displayed fine: right way up.

Then distilled this to PDF, using (a) ps2pdf from ghostscript 7.05,
then (b) epstopdf from TeX (though this too calls ghostscript).
In both cases, the entire page displayed in Acrobat Reader rotated
right through 90 degrees, i.e. the wrong way round.

Then I transferred the temp.ps file to two other machines.

[A] On one, SuSE Linux 5.2, I have an elderly copy of PStill (See Frank
Siegert's site http://www.pstill.com ) which actually is a better
distiller than ghostscript provides. The resulting PDF displayed right
way up using acroread 3.0. I then converted to PDF using ps2pdf
(ghostscript 5.10) and again it was the right way up.

[B] On the other, SuSE Linux 7.2, I converted using ps2pdf (ghostscript
5.50) and again it was the right way up when viewed with acroread 4.0.

Then I transferred both PDF files, from [A] and from [B], back to the
original Red Hat 9 machine and viewed each using aroread 5.0, and they
were still the right way up.

It would seem from this that the problem arises with the distillation
using ghostscript 7.05 (I don't have access to Acrobat Distiller).

BY THE WAY: I had a look at the PostScript code in the EPS files from R,
and noticed that the begin-page and end-page definitions use double
invocations of gsave and grestore:

  /bp  { gs gs } def
  % begin .ps.prolog
  /gs  { gsave } def
  /gr  { grestore } def
  /ep  { showpage gr gr } def

This doesn't strike me as necessary, so (in case it might have something
to do with it) I removed one of them in each case:

  /bp  { gs } def
  % begin .ps.prolog
  /gs  { gsave } def
  /gr  { grestore } def
  /ep  { showpage gr } def

to see if it made any difference (it didn't).

I hope this helps to advance the investigation!

Best wishes,
Ted.

From ripley at stats.ox.ac.uk  Wed Oct  8 14:19:17 2003
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed Oct  8 14:19:01 2003
Subject: [Rd] Unpredictable EPS->PDF rotation (PR#4460)
In-Reply-To: <XFMail.031008120346.Ted.Harding@nessie.mcc.ac.uk>
Message-ID: <Pine.LNX.4.44.0310081309120.1883-100000@gannet.stats>

For the record, gs 6.20 introduced

<p>
This fileset includes the first steps towards bringing the pdfwrite driver
closer to matching Acrobat Distiller 4.  Highlights:

<ul>

<li> Reimplementation of CIDFontType 0 support in C rather than 
PostScript;

<li> Parsing (but not functional implementation) of nearly all the Acrobat
Distiller 4 parameters;

<li> Implementation of AutoRotatePages and DCTEncode filtering in the PDF
writer;

<li> A PDF linearizer ("optimizer").

</ul>

and so all recent versions of gs work like Distiller, with the default for
the parameter AutoRotatePages=/PageByPage.

R's EPS used to specify portrait orientation, but at about the same time 
gs changed the interpretation of that from `don't rotate' to `width < 
height' and so would have rotated both examples, and we removed the DSC 
orientation line.

The reason the first is not rotated and the second is is that the x-axis
strings are longer in the first, and so the majority of the text on the
page is horizontal in the first but not the second (and the main
determinant for autorotation is the orientation of the text).


So, no mystery, just ghostscript working as documented.  And no R bug!


On Wed, 8 Oct 2003 Ted.Harding@nessie.mcc.ac.uk wrote:

> On 08-Oct-03 arnima@u.washington.edu wrote:
> > When I create EPS files, they sometimes appear rotated in my LaTeX PDF
> > document and sometimes they don't. Two examples:
> > 
> >## x1.eps is not rotated in LaTeX
> > x <- seq(-1, 1, length=100)
> > postscript("c:/x1.eps", height=3, width=4,
> >            horizontal=FALSE, onefile=FALSE, paper="special")
> > plot(x, dnorm(x), type="l")
> > dev.off()
> > 
> >## x2.eps is not rotated in LaTeX
> > x <- seq(-2, 2, length=100)
> > postscript("c:/x2.eps", height=3, width=4,
> >            horizontal=FALSE, onefile=FALSE, paper="special")
> > plot(x, dnorm(x), type="l")
> > dev.off()
> > 
> > By LaTeX PDF, I am referring to the dvips->ghostscript pathway, but
> > x2.eps
> > also rotates when distilled into PDF outside LaTeX. I have tried
> > ghostscript and acrobat, placed on a page or cropped, so the problem
> > does not seem to be confounded with particular PDF distillation
> > software.
> 
> I've done an experiment or two (and I've read Peter Dalgaard's reply).
> 
> Using Red Hat 9, I imported the two files x1.eps and x2.eps as output
> by R-1.7.1 into a groff document, both on one page and one above the
> other, outputting the result as a PS file, temp.ps.
> 
> Using ghostview, the result displayed fine: right way up.
> 
> Then distilled this to PDF, using (a) ps2pdf from ghostscript 7.05,
> then (b) epstopdf from TeX (though this too calls ghostscript).
> In both cases, the entire page displayed in Acrobat Reader rotated
> right through 90 degrees, i.e. the wrong way round.
> 
> Then I transferred the temp.ps file to two other machines.
> 
> [A] On one, SuSE Linux 5.2, I have an elderly copy of PStill (See Frank
> Siegert's site http://www.pstill.com ) which actually is a better
> distiller than ghostscript provides. The resulting PDF displayed right
> way up using acroread 3.0. I then converted to PDF using ps2pdf
> (ghostscript 5.10) and again it was the right way up.
> 
> [B] On the other, SuSE Linux 7.2, I converted using ps2pdf (ghostscript
> 5.50) and again it was the right way up when viewed with acroread 4.0.
> 
> Then I transferred both PDF files, from [A] and from [B], back to the
> original Red Hat 9 machine and viewed each using aroread 5.0, and they
> were still the right way up.
> 
> It would seem from this that the problem arises with the distillation
> using ghostscript 7.05 (I don't have access to Acrobat Distiller).
> 
> BY THE WAY: I had a look at the PostScript code in the EPS files from R,
> and noticed that the begin-page and end-page definitions use double
> invocations of gsave and grestore:
> 
>   /bp  { gs gs } def
>   % begin .ps.prolog
>   /gs  { gsave } def
>   /gr  { grestore } def
>   /ep  { showpage gr gr } def
> 
> This doesn't strike me as necessary, so (in case it might have something
> to do with it) I removed one of them in each case:
> 
>   /bp  { gs } def
>   % begin .ps.prolog
>   /gs  { gsave } def
>   /gr  { grestore } def
>   /ep  { showpage gr } def
> 
> to see if it made any difference (it didn't).
> 
> I hope this helps to advance the investigation!
> 
> Best wishes,
> Ted.
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://www.stat.math.ethz.ch/mailman/listinfo/r-devel
> 
> 

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From nali at biostat.umn.edu  Wed Oct  8 10:11:49 2003
From: nali at biostat.umn.edu (Na Li)
Date: Wed Oct  8 16:10:40 2003
Subject: [Rd] Unpredictable EPS->PDF rotation (PR#4460)
In-Reply-To: <200310081009.h98A9H0P014475@pubhealth.ku.dk>
	(maechler@stat.math.ethz.ch's
	message of "Wed, 8 Oct 2003 12:09:17 +0200 (MET DST)")
References: <200310081009.h98A9H0P014475@pubhealth.ku.dk>
Message-ID: <kczngbrf8a.fsf@qiuranke.phony.umn.edu>

On 8 Oct 2003, maechler@stat.math.ethz.ch uttered the following:

> > >  When I create EPS files, they sometimes appear rotated in my LaTeX PDF
> > >  document and sometimes they don't. Two examples:
> > >  
>  
>  It's definitely unrelated to R.
>  
>  The "bug" is in newer versions of gs (ghostscript) which does
>  rotate plots under some circumstances by default.
>  
>  Of course, the authors of gs consider this a feature (called
>  "AutoRotatePages"), but IMO it's been a very bad design-decision.
>  
>  Here, we have implemented a workaround by patching the
>  "epstopdf" (shell script) (we use the version from teTeX), by
>  the following:

Another, perhaps easier fix is to define 

export GS_OPTIONS="-dAutoRotatePages=/None"

(or its equivalent in tcsh).

Michael

From eriehl at email.unc.edu  Wed Oct  8 21:31:41 2003
From: eriehl at email.unc.edu (eriehl@email.unc.edu)
Date: Wed Oct  8 20:30:49 2003
Subject: [Rd] Memmory Bugs (PR#4474)
Message-ID: <200310081831.h98IVf0P021130@pubhealth.ku.dk>

  This message is in MIME format.  The first part should be readable text,
  while the remaining parts are likely unreadable without MIME-aware tools.
  Send mail to mime@docserver.cac.washington.edu for more info.

--43518230-584990211-1065637857=:31587
Content-Type: TEXT/PLAIN; charset=US-ASCII


I found (or rather the compiler I was using found) a few bugs in the 
R-1.7.1 sources.  I'm  not sure if they're fixed in the 1.8.0 sources
or not.

I've attached a diff file, where R-1.7.1a is the patches version.

Eric Riehl

--43518230-584990211-1065637857=:31587
Content-Type: TEXT/PLAIN; charset=US-ASCII; name=patch
Content-Transfer-Encoding: BASE64
Content-ID: <Pine.LNX.4.44.0310081430570.31587@testbox>
Content-Description: patches
Content-Disposition: attachment; filename=patch

U2VuZGVyOiBMU0YgU3lzdGVtIDxsc2ZhZG1pbkBiYW9iYWItbjMwLmlzaXMu
dW5jLmVkdT4NClN1YmplY3Q6IEpvYiAxODMyNzogPGRpZmYgLXIgUi0xLjcu
MS8gUi0xLjcuMWEvPiBFeGl0ZWQNCg0KSm9iIDxkaWZmIC1yIFItMS43LjEv
IFItMS43LjFhLz4gd2FzIHN1Ym1pdHRlZCBmcm9tIGhvc3QgPGJhb2JhYi1u
Ni5pc2lzLnVuYy5lZHU+IGJ5IHVzZXIgPGVyaWVobD4uDQpKb2Igd2FzIGV4
ZWN1dGVkIG9uIGhvc3QocykgPGJhb2JhYi1uMzAuaXNpcy51bmMuZWR1Piwg
aW4gcXVldWUgPGJhdGNoPiwgYXMgdXNlciA8ZXJpZWhsPi4NCjwvYWZzL2lz
aXMudW5jLmVkdS9ob21lL2Uvci9lcmllaGw+IHdhcyB1c2VkIGFzIHRoZSBo
b21lIGRpcmVjdG9yeS4NCjwvYWZzL2lzaXMudW5jLmVkdS9wa2cvci0xNzEv
LmJ1aWxkL3NyYz4gd2FzIHVzZWQgYXMgdGhlIHdvcmtpbmcgZGlyZWN0b3J5
Lg0KU3RhcnRlZCBhdCBXZWQgT2N0ICA4IDE0OjI0OjM0IDIwMDMNClJlc3Vs
dHMgcmVwb3J0ZWQgYXQgV2VkIE9jdCAgOCAxNDoyNDo1OSAyMDAzDQoNCllv
dXIgam9iIGxvb2tlZCBsaWtlOg0KDQotLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCiMgTFNC
QVRDSDogVXNlciBpbnB1dA0KZGlmZiAtciBSLTEuNy4xLyBSLTEuNy4xYS8N
Ci0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLQ0KDQpFeGl0ZWQgd2l0aCBleGl0IGNvZGUgMS4N
Cg0KUmVzb3VyY2UgdXNhZ2Ugc3VtbWFyeToNCg0KICAgIENQVSB0aW1lICAg
OiAgICAgIDIuMTggc2VjLg0KICAgIE1heCBNZW1vcnkgOiAgICAgICAgIDEg
TUINCiAgICBNYXggU3dhcCAgIDogICAgICAgICAzIE1CDQoNCiAgICBNYXgg
UHJvY2Vzc2VzICA6ICAgICAgICAgMQ0KDQpUaGUgb3V0cHV0IChpZiBhbnkp
IGZvbGxvd3M6DQoNCmRpZmYgLXIgUi0xLjcuMS9zcmMvbGlicmFyeS90Y2x0
ay9zcmMvdGNsdGsuYyBSLTEuNy4xYS9zcmMvbGlicmFyeS90Y2x0ay9zcmMv
dGNsdGsuYw0KNjQ0YzY0NA0KPCAJc3RybmNweShidWYsIFRjbF9HZXRTdHJp
bmdSZXN1bHQoUlRjbF9pbnRlcnApLCBsZW4pOw0KLS0tDQo+IAlzdHJuY3B5
KChjaGFyICopYnVmLCBUY2xfR2V0U3RyaW5nUmVzdWx0KFJUY2xfaW50ZXJw
KSwgbGVuKTsNCmRpZmYgLXIgUi0xLjcuMS9zcmMvbWFpbi9kb3Rjb2RlLmMg
Ui0xLjcuMWEvc3JjL21haW4vZG90Y29kZS5jDQoyNTFjMjUxDQo8IAkgICAg
YnVmWzI1Nl0gPSAnXDAnOw0KLS0tDQo+IAkgICAgYnVmWzI1NV0gPSAnXDAn
Ow0KZGlmZiAtciBSLTEuNy4xL3NyYy9tYWluL2Vycm9ycy5jIFItMS43LjFh
L3NyYy9tYWluL2Vycm9ycy5jDQo1OThjNTk4DQo8ICAgICBjb25zdCBSX1dB
Uk5JTkcgY29kZTsNCi0tLQ0KPiAgICAgY29uc3QgUl9FUlJPUiBjb2RlOw0K
ZGlmZiAtciBSLTEuNy4xL3NyYy9tYWluL2dyYXBoaWNzLmMgUi0xLjcuMWEv
c3JjL21haW4vZ3JhcGhpY3MuYw0KNTk1NSw1OTU2YzU5NTUsNTk1Ng0KPCAg
ICAgUmZfZHBwdHIoZGQpLT5maW5bMl0gPSBSZl9kcFNhdmVkcHRyKGRkKS0+
ZmluWzJdOw0KPCAgICAgUmZfZHBwdHIoZGQpLT5maW5bM10gPSBSZl9kcFNh
dmVkcHRyKGRkKS0+ZmluWzNdOw0KLS0tDQo+ICAgICAvKiAgICBSZl9kcHB0
cihkZCktPmZpblsyXSA9IFJmX2RwU2F2ZWRwdHIoZGQpLT5maW5bMl07ICov
DQo+ICAgICAvKiAgICBSZl9kcHB0cihkZCktPmZpblszXSA9IFJmX2RwU2F2
ZWRwdHIoZGQpLT5maW5bM107ICovDQo2MDA5LDYwMTBjNjAwOSw2MDEwDQo8
ICAgICBSZl9kcHB0cihkZCktPnBpblsyXSA9IFJmX2RwU2F2ZWRwdHIoZGQp
LT5waW5bMl07DQo8ICAgICBSZl9kcHB0cihkZCktPnBpblszXSA9IFJmX2Rw
U2F2ZWRwdHIoZGQpLT5waW5bM107DQotLS0NCj4gICAgIC8qICAgIFJmX2Rw
cHRyKGRkKS0+cGluWzJdID0gUmZfZHBTYXZlZHB0cihkZCktPnBpblsyXTsg
Ki8NCj4gICAgIC8qICAgIFJmX2RwcHRyKGRkKS0+cGluWzNdID0gUmZfZHBT
YXZlZHB0cihkZCktPnBpblszXTsgKi8NCmRpZmYgLXIgUi0xLjcuMS9zcmMv
bWFpbi9tYWluLmMgUi0xLjcuMWEvc3JjL21haW4vbWFpbi5jDQoyNzljMjc5
DQo8ICAgICBzdGF0ZS5idWZbMTAyNV0gPSAnXDAnOyAvKiBzdG9wZ2FwIG1l
YXN1cmUgaWYgbGluZSA+IDEwMjQgY2hhcnMgKi8NCi0tLQ0KPiAgICAgc3Rh
dGUuYnVmWzEwMjRdID0gJ1wwJzsgLyogc3RvcGdhcCBtZWFzdXJlIGlmIGxp
bmUgPiAxMDI0IGNoYXJzICovDQpkaWZmIC1yIFItMS43LjEvc3JjL3VuaXgv
c3lzLWNvbW1vbi5jIFItMS43LjFhL3NyYy91bml4L3N5cy1jb21tb24uYw0K
Njg2YzY4Ng0KPCAJc21bQlVGX1NJWkVdID0gJ1wwJzsNCi0tLQ0KPiAJc21b
QlVGX1NJWkUtMV0gPSAnXDAnOw0KT25seSBpbiBSLTEuNy4xYS9zcmMvdW5p
eDogc3lzLWNvbW1vbi5jfg0K
--43518230-584990211-1065637857=:31587--

From p.dalgaard at biostat.ku.dk  Wed Oct  8 21:07:25 2003
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard BSA)
Date: Wed Oct  8 22:07:28 2003
Subject: [Rd] Memmory Bugs (PR#4474)
In-Reply-To: <200310081831.h98IVf0P021130@pubhealth.ku.dk>
References: <200310081831.h98IVf0P021130@pubhealth.ku.dk>
Message-ID: <x2llrvjxt6.fsf@biostat.ku.dk>

eriehl@email.unc.edu writes:

>   This message is in MIME format.  The first part should be readable text,
>   while the remaining parts are likely unreadable without MIME-aware tools.
>   Send mail to mime@docserver.cac.washington.edu for more info.
> 
> --43518230-584990211-1065637857=:31587
> Content-Type: TEXT/PLAIN; charset=US-ASCII
> 
> 
> I found (or rather the compiler I was using found) a few bugs in the 
> R-1.7.1 sources.  I'm  not sure if they're fixed in the 1.8.0 sources
> or not.
> 
> I've attached a diff file, where R-1.7.1a is the patches version.
> 
> Eric Riehl
> 
> --43518230-584990211-1065637857=:31587
> Content-Type: TEXT/PLAIN; charset=US-ASCII; name=patch
> Content-Transfer-Encoding: BASE64
> Content-ID: <Pine.LNX.4.44.0310081430570.31587@testbox>
> Content-Description: patches
> Content-Disposition: attachment; filename=patch
> 
> U2VuZGVyOiBMU0YgU3lzdGVtIDxsc2ZhZG1pbkBiYW9iYWItbjMwLmlzaXMu
> dW5jLmVkdT4NClN1YmplY3Q6IEpvYiAxODMyNzogPGRpZmYgLXIgUi0xLjcu
> MS8gUi0xLjcuMWEvPiBFeGl0ZWQNCg0KSm9iIDxkaWZmIC1yIFItMS43LjEv

Please don't use attached files in r-bugs; they become quite a pain to
decipher. Most of the things you report have already been fixed in
1.8.0, except 

diff -r R-1.7.1/src/main/errors.c R-1.7.1a/src/main/errors.c
598c598
<     const R_WARNING code;
---
>     const R_ERROR code;


(This is now in line 750 -- a context diff would have been welcome).

The problem there is that we have

    749 static struct {
    750     const R_WARNING code;
    751     const char* const format;
    752 }
    753 const ErrorDB[] = {
    754     { ERROR_NUMARGS,            "invalid number of arguments"
        },
    755     { ERROR_ARGTYPE,            "invalid argument type"
        },

and the ERROR_* values are not in the R_WARNING enum type. Formally,
that is a bug, but I suspect that we generate the correct code
anyway....

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From sdavis2 at mail.nih.gov  Thu Oct  9 11:22:59 2003
From: sdavis2 at mail.nih.gov (Sean Davis)
Date: Thu Oct  9 16:22:04 2003
Subject: [Rd] building XML-0.95-1 on MacOS
Message-ID: <15443B9C-FA64-11D7-B761-000A95D7BA10@mail.nih.gov>

I am trying to build the XML package on MacOS.  I am using the fink 
installation of libxml-1.8.17.  The configuration information is:

Configuration information:

Libxml settings

libxml include directory: /sw/include/gnome-xml
libxml library directory: -L/sw/lib -lxml -lz -lz  -lxml
libxml 2:                 no

Compilation flags:         -I/sw/include/gnome-xml 
-I/sw/include/gnome-xml/libxml -DLIBXML -I/sw/include/gnome-xml
Link flags:               -L/sw/lib -lxml -lz -lz  -lxml



Compiling produced the following error:
gcc -bundle -flat_namespace -undefined suppress -L/sw/lib 
-L/usr/local/lib -o XML.so DocParse.o EventParse.o ExpatParse.o 
HTMLParse.o RSDTD.o RUtils.o Utils.o XMLEventParse.o XMLTree.o 
-L/sw/lib -lxml -lz -lz  -lxml -lcc_dynamic
ld: multiple definitions of symbol _xmlParserError
Utils.o definition of _xmlParserError in section (__TEXT,__text)
/sw/lib/libxml.dylib(error.lo) definition of _xmlParserError
make: *** [XML.so] Error 1
ERROR: compilation failed for package 'XML'

I saw that back in September there was a discussion about fixing this 
problem that involved passing -m to the linker.  My questions are (1) 
what do I need to modify (given that I am using R INSTALL to keep 
things simple for myself) to use the -Xlinker -m option when linking 
XML.so and (2) does this actually work despite the fact that there are 
then two definitions associated with the same symbol?  I guess a third 
question follows from the second--are there other fixes that I can use 
to build the package?

Thanks in advance,
Sean

From deleeuw at stat.ucla.edu  Thu Oct  9 08:42:09 2003
From: deleeuw at stat.ucla.edu (Jan de Leeuw)
Date: Thu Oct  9 16:41:25 2003
Subject: [Rd] building XML-0.95-1 on MacOS
In-Reply-To: <15443B9C-FA64-11D7-B761-000A95D7BA10@mail.nih.gov>
References: <15443B9C-FA64-11D7-B761-000A95D7BA10@mail.nih.gov>
Message-ID: <C2DFE083-FA66-11D7-A489-000A95A67E82@stat.ucla.edu>

1. Just download the package and unpack it.
2. Use R INSTALL until it breaks
3. Then go to the src directory and give the gcc command below with  
-Xlinker -m
4. Then use R INSTALL again

There are not two definitions associated with the same symbol after  
linking. This
unpleasant hack uses the definition in Utils.o, as intended.  This  
situation will
persist until either Duncan puts this fix into XML or until Stefano  
decides to go
with two-level namespaces for Darwin/Aqua R packages.

On Oct 9, 2003, at 7:22, Sean Davis wrote:

> I am trying to build the XML package on MacOS.  I am using the fink  
> installation of libxml-1.8.17.  The configuration information is:
>
> Configuration information:
>
> Libxml settings
>
> libxml include directory: /sw/include/gnome-xml
> libxml library directory: -L/sw/lib -lxml -lz -lz  -lxml
> libxml 2:                 no
>
> Compilation flags:         -I/sw/include/gnome-xml  
> -I/sw/include/gnome-xml/libxml -DLIBXML -I/sw/include/gnome-xml
> Link flags:               -L/sw/lib -lxml -lz -lz  -lxml
>
>
>
> Compiling produced the following error:
> gcc -bundle -flat_namespace -undefined suppress -L/sw/lib  
> -L/usr/local/lib -o XML.so DocParse.o EventParse.o ExpatParse.o  
> HTMLParse.o RSDTD.o RUtils.o Utils.o XMLEventParse.o XMLTree.o  
> -L/sw/lib -lxml -lz -lz  -lxml -lcc_dynamic
> ld: multiple definitions of symbol _xmlParserError
> Utils.o definition of _xmlParserError in section (__TEXT,__text)
> /sw/lib/libxml.dylib(error.lo) definition of _xmlParserError
> make: *** [XML.so] Error 1
> ERROR: compilation failed for package 'XML'
>
> I saw that back in September there was a discussion about fixing this  
> problem that involved passing -m to the linker.  My questions are (1)  
> what do I need to modify (given that I am using R INSTALL to keep  
> things simple for myself) to use the -Xlinker -m option when linking  
> XML.so and (2) does this actually work despite the fact that there are  
> then two definitions associated with the same symbol?  I guess a third  
> question follows from the second--are there other fixes that I can use  
> to build the package?
>
> Thanks in advance,
> Sean
>
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://www.stat.math.ethz.ch/mailman/listinfo/r-devel
>
>
===
Jan de Leeuw; Professor and Chair, UCLA Department of Statistics;
Editor: Journal of Multivariate Analysis, Journal of Statistical  
Software
US mail: 8130 Math Sciences Bldg, Box 951554, Los Angeles, CA 90095-1554
phone (310)-825-9550;  fax (310)-206-5658;  email: deleeuw@stat.ucla.edu
homepage: http://gifi.stat.ucla.edu
   
------------------------------------------------------------------------ 
-------------------------
           No matter where you go, there you are. --- Buckaroo Banzai
                    http://gifi.stat.ucla.edu/sounds/nomatter.au

From duncan at research.bell-labs.com  Thu Oct  9 11:48:22 2003
From: duncan at research.bell-labs.com (Duncan Temple Lang)
Date: Thu Oct  9 16:47:46 2003
Subject: [Rd] building XML-0.95-1 on MacOS
In-Reply-To: <15443B9C-FA64-11D7-B761-000A95D7BA10@mail.nih.gov>;
	from sdavis2@mail.nih.gov on Thu, Oct 09, 2003 at 10:22:59AM -0400
References: <15443B9C-FA64-11D7-B761-000A95D7BA10@mail.nih.gov>
Message-ID: <20031009104822.D21760@jessie.research.bell-labs.com>


Hi Sean.

  Two things. There is a new version of the XML package
now on the Omegahat web site:

  http://www.omegahat.org/RSXML/XML_0.95-3.tar.gz

That uses a different approach to dealing with errors and avoids
having to redefine the xmlParserError() routine.  As a result,
one should not need the -m flag.

Secondly, unless there are good reasons for using
libxml-1.8.*, it is preferrable to use the libxml2-2*
series. 

The configuration for this version of the XML package has been
"upgraded", but may require some assistance.  If it doesn't compile
out of the box, please set the environment variable XML_CONFIG to the
name of the xml-config or xml2-config script that provides the
relevant information. I'll fix this up in the next release.

 D.


Sean Davis wrote:
> I am trying to build the XML package on MacOS.  I am using the fink 
> installation of libxml-1.8.17.  The configuration information is:
> 
> Configuration information:
> 
> Libxml settings
> 
> libxml include directory: /sw/include/gnome-xml
> libxml library directory: -L/sw/lib -lxml -lz -lz  -lxml
> libxml 2:                 no
> 
> Compilation flags:         -I/sw/include/gnome-xml 
> -I/sw/include/gnome-xml/libxml -DLIBXML -I/sw/include/gnome-xml
> Link flags:               -L/sw/lib -lxml -lz -lz  -lxml
> 
> 
> 
> Compiling produced the following error:
> gcc -bundle -flat_namespace -undefined suppress -L/sw/lib 
> -L/usr/local/lib -o XML.so DocParse.o EventParse.o ExpatParse.o 
> HTMLParse.o RSDTD.o RUtils.o Utils.o XMLEventParse.o XMLTree.o 
> -L/sw/lib -lxml -lz -lz  -lxml -lcc_dynamic
> ld: multiple definitions of symbol _xmlParserError
> Utils.o definition of _xmlParserError in section (__TEXT,__text)
> /sw/lib/libxml.dylib(error.lo) definition of _xmlParserError
> make: *** [XML.so] Error 1
> ERROR: compilation failed for package 'XML'
> 
> I saw that back in September there was a discussion about fixing this 
> problem that involved passing -m to the linker.  My questions are (1) 
> what do I need to modify (given that I am using R INSTALL to keep 
> things simple for myself) to use the -Xlinker -m option when linking 
> XML.so and (2) does this actually work despite the fact that there are 
> then two definitions associated with the same symbol?  I guess a third 
> question follows from the second--are there other fixes that I can use 
> to build the package?
> 
> Thanks in advance,
> Sean
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://www.stat.math.ethz.ch/mailman/listinfo/r-devel

-- 
_______________________________________________________________

Duncan Temple Lang                duncan@research.bell-labs.com
Bell Labs, Lucent Technologies    office: (908)582-3217
700 Mountain Avenue, Room 2C-259  fax:    (908)582-3340
Murray Hill, NJ  07974-2070       
         http://cm.bell-labs.com/stat/duncan

From jago at mclink.it  Thu Oct  9 17:53:14 2003
From: jago at mclink.it (Stefano Iacus)
Date: Thu Oct  9 16:53:55 2003
Subject: [Rd] building XML-0.95-1 on MacOS
In-Reply-To: <C2DFE083-FA66-11D7-A489-000A95A67E82@stat.ucla.edu>
Message-ID: <4F53A078-FA68-11D7-82E4-003065CC4CB8@mclink.it>

Duncan is working on this at lower level in the xml package code.
As you see on cran with XML version 95-3 which is still not optimal.  
All will be fixed in few days when Duncan has finished travelling  
around :))

Btw, it preferable to use libxml2 which builds and configs fine without  
problems.

stefano


On Gioved?, ott 9, 2003, at 16:42 Europe/Rome, Jan de Leeuw wrote:

> 1. Just download the package and unpack it.
> 2. Use R INSTALL until it breaks
> 3. Then go to the src directory and give the gcc command below with  
> -Xlinker -m
> 4. Then use R INSTALL again
>
> There are not two definitions associated with the same symbol after  
> linking. This
> unpleasant hack uses the definition in Utils.o, as intended.  This  
> situation will
> persist until either Duncan puts this fix into XML or until Stefano  
> decides to go
> with two-level namespaces for Darwin/Aqua R packages.
>
> On Oct 9, 2003, at 7:22, Sean Davis wrote:
>
>> I am trying to build the XML package on MacOS.  I am using the fink  
>> installation of libxml-1.8.17.  The configuration information is:
>>
>> Configuration information:
>>
>> Libxml settings
>>
>> libxml include directory: /sw/include/gnome-xml
>> libxml library directory: -L/sw/lib -lxml -lz -lz  -lxml
>> libxml 2:                 no
>>
>> Compilation flags:         -I/sw/include/gnome-xml  
>> -I/sw/include/gnome-xml/libxml -DLIBXML -I/sw/include/gnome-xml
>> Link flags:               -L/sw/lib -lxml -lz -lz  -lxml
>>
>>
>>
>> Compiling produced the following error:
>> gcc -bundle -flat_namespace -undefined suppress -L/sw/lib  
>> -L/usr/local/lib -o XML.so DocParse.o EventParse.o ExpatParse.o  
>> HTMLParse.o RSDTD.o RUtils.o Utils.o XMLEventParse.o XMLTree.o  
>> -L/sw/lib -lxml -lz -lz  -lxml -lcc_dynamic
>> ld: multiple definitions of symbol _xmlParserError
>> Utils.o definition of _xmlParserError in section (__TEXT,__text)
>> /sw/lib/libxml.dylib(error.lo) definition of _xmlParserError
>> make: *** [XML.so] Error 1
>> ERROR: compilation failed for package 'XML'
>>
>> I saw that back in September there was a discussion about fixing this  
>> problem that involved passing -m to the linker.  My questions are (1)  
>> what do I need to modify (given that I am using R INSTALL to keep  
>> things simple for myself) to use the -Xlinker -m option when linking  
>> XML.so and (2) does this actually work despite the fact that there  
>> are then two definitions associated with the same symbol?  I guess a  
>> third question follows from the second--are there other fixes that I  
>> can use to build the package?
>>
>> Thanks in advance,
>> Sean
>>
>> ______________________________________________
>> R-devel@stat.math.ethz.ch mailing list
>> https://www.stat.math.ethz.ch/mailman/listinfo/r-devel
>>
>>
> ===
> Jan de Leeuw; Professor and Chair, UCLA Department of Statistics;
> Editor: Journal of Multivariate Analysis, Journal of Statistical  
> Software
> US mail: 8130 Math Sciences Bldg, Box 951554, Los Angeles, CA  
> 90095-1554
> phone (310)-825-9550;  fax (310)-206-5658;  email:  
> deleeuw@stat.ucla.edu
> homepage: http://gifi.stat.ucla.edu
>   
> ----------------------------------------------------------------------- 
> --------------------------
>           No matter where you go, there you are. --- Buckaroo Banzai
>                    http://gifi.stat.ucla.edu/sounds/nomatter.au
>
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://www.stat.math.ethz.ch/mailman/listinfo/r-devel
>

From pgilbert at bank-banque-canada.ca  Thu Oct  9 12:05:56 2003
From: pgilbert at bank-banque-canada.ca (Paul Gilbert)
Date: Thu Oct  9 17:01:19 2003
Subject: [Rd] exceeding memory causes crash on Linux
Message-ID: <3F857954.3020808@bankofcanada.ca>

I am having an unusual difficulty with R 1.8.0 on Mandrake 9.1 running a 
problem that takes a large amount of memory. With R 1.7.1  this ran on 
the machine I am using (barely), but now takes more memory than is 
available.  The first two times I tried with R 1.8.0, R exited after the 
program had run for some time, and gave no indication of anything, just 
returned to the shell command prompt. I ran under gdb to see if I could 
get a bettter indication of the problem, and this crashed Linux 
completely, or at least X, but I couldn't get another console either. (I 
haven't had anything crash Linux in a long time.) To confirm this I ran 
R under gdb again, and ran top to verify I was hitting memory 
constraints (which I was), but this time R did give a message "Error: 
cannot allocate a vector of size ..."

I'm not worried about running the problem, but I would like a more 
graceful exit. Might this be related to the change in error handling?

Paul Gilbert

From saikat at stat.wisc.edu  Thu Oct  9 18:18:16 2003
From: saikat at stat.wisc.edu (saikat@stat.wisc.edu)
Date: Thu Oct  9 17:17:20 2003
Subject: [Rd] S4 group generic Complex not working (PR#4483)
Message-ID: <200310091518.h99FIG0P006941@pubhealth.ku.dk>

The Complex group generic for S4 methods is not working:

 > setClass('foo', representation(z='complex'))
[1] "foo"
 > setMethod('Complex', 'foo', function(z) callGeneric(z@z))
[1] "Complex"
 > Arg(new('foo', z=1+0i))
Error in Arg(new("foo", z = 1 + (0+0i))) :
         non-numeric argument to function
 >

The fix is to add

     if (DispatchGroup("Complex", call, op, args, env, &x))
	return x;

near the beginning of do_cmathfuns in complex.c.

--please do not edit the information below--

Version:
  platform = i686-pc-linux-gnu
  arch = i686
  os = linux-gnu
  system = i686, linux-gnu
  status =
  major = 1
  minor = 8.0
  year = 2003
  month = 10
  day = 08
  language = R

Search Path:
  .GlobalEnv, package:methods, package:ctest, package:mva, 
package:modreg, package:nls, package:ts, Autoloads, package:base

From saikat at stat.wisc.edu  Thu Oct  9 12:41:01 2003
From: saikat at stat.wisc.edu (Saikat DebRoy)
Date: Thu Oct  9 17:39:11 2003
Subject: [Rd] An artifact of base being namespace
Message-ID: <FC2BADAC-FA6E-11D7-92F4-0003931A3C9E@stat.wisc.edu>

Function in the base library of R 1.8.0 seems to use a search path with 
base coming before the local environment. I think this is intentional 
and is related to base being a namespace.

 > log <- function(x, base) 200
 > log(1)
[1] 200
 > log10
function (x)
log(x, 10)
<environment: namespace:base>
 > log10(1)
[1] 0
 >

This is most problematic when you are creating a generic for an 
existing function in base (as you very well could for log). This often 
makes the ability to make new generics out of existing functions 
somewhat useless.

From pgilbert at bank-banque-canada.ca  Thu Oct  9 12:49:39 2003
From: pgilbert at bank-banque-canada.ca (Paul Gilbert)
Date: Thu Oct  9 17:44:43 2003
Subject: [Rd] exceeding memory causes crash on Linux
In-Reply-To: <3F857954.3020808@bankofcanada.ca>
References: <3F857954.3020808@bankofcanada.ca>
Message-ID: <3F858393.9000704@bankofcanada.ca>

Paul Gilbert wrote:

> I am having an unusual difficulty with R 1.8.0 on Mandrake 9.1 running 
> a problem that takes a large amount of memory. With R 1.7.1  this ran 
> on the machine I am using (barely), but now takes more memory than is 
> available.  The first two times I tried with R 1.8.0, R exited after 
> the program had run for some time, and gave no indication of anything, 
> just returned to the shell command prompt. I ran under gdb to see if I 
> could get a bettter indication of the problem, and this crashed Linux 
> completely, or at least X, but I couldn't get another console either. 
> (I haven't had anything crash Linux in a long time.) To confirm this I 
> ran R under gdb again, and ran top to verify I was hitting memory 
> constraints (which I was), but this time R did give a message "Error: 
> cannot allocate a vector of size ..." 

P.S. But there does not seem to be proper garbage collection after this. 
Top showed the memory still in use and subsequent attempts to run the 
program failed immediately trying to allocate a much smaller vector. 
When I did gc()  explicitely it did clean up and I could start the 
function again. The second time R exited back to the gdb prompt with a 
message "Program terminated with signal  SIGKILL, Killed. The program no 
longer exists."

> I'm not worried about running the problem, but I would like a more 
> graceful exit. Might this be related to the change in error handling?
>
> Paul Gilbert
>
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://www.stat.math.ethz.ch/mailman/listinfo/r-devel
>

From duncan at research.bell-labs.com  Thu Oct  9 13:02:32 2003
From: duncan at research.bell-labs.com (Duncan Temple Lang)
Date: Thu Oct  9 18:01:52 2003
Subject: [Rd] building XML-0.95-1 on MacOS
In-Reply-To: <20031009104822.D21760@jessie.research.bell-labs.com>;
	from duncan@research.bell-labs.com on Thu, Oct 09, 2003 at
	10:48:22AM -0400
References: <15443B9C-FA64-11D7-B761-000A95D7BA10@mail.nih.gov>
	<20031009104822.D21760@jessie.research.bell-labs.com>
Message-ID: <20031009120231.M21760@jessie.research.bell-labs.com>


Stefano asked me to post something along the following lines
about the XML package.

I have modified the configuration for the XML package so that it
looks for libxml2 if instructed, or alternatively looks for libxml 1
and, if that is not present, then libxml 2.

The new version:  XML_0.95-4.tar.gz is on the Omegahat
Web site:
   http://www.omegahat.org/RSXML

So one should not have to set any environment variables or specify
configuration arguments if you only have libxml2 on your machine. If
you have both libxml and libxml2, you will get libxml 1 by default.
Use --configure-args='--with-libxml2' or set the environment variable
XML_CONFIG to xml2-config.

At some point in the future, we will stop supporting
old versions of libxml with no xml-config script,
header files in odd places, ...  This is what
makes the configuration so complex.


 D.



Duncan Temple Lang wrote:
> 
> Hi Sean.
> 
>   Two things. There is a new version of the XML package
> now on the Omegahat web site:
> 
>   http://www.omegahat.org/RSXML/XML_0.95-3.tar.gz
> 
> That uses a different approach to dealing with errors and avoids
> having to redefine the xmlParserError() routine.  As a result,
> one should not need the -m flag.
> 
> Secondly, unless there are good reasons for using
> libxml-1.8.*, it is preferrable to use the libxml2-2*
> series. 
> 
> The configuration for this version of the XML package has been
> "upgraded", but may require some assistance.  If it doesn't compile
> out of the box, please set the environment variable XML_CONFIG to the
> name of the xml-config or xml2-config script that provides the
> relevant information. I'll fix this up in the next release.
> 
>  D.
> 
> 
> Sean Davis wrote:
> > I am trying to build the XML package on MacOS.  I am using the fink 
> > installation of libxml-1.8.17.  The configuration information is:
> > 
> > Configuration information:
> > 
> > Libxml settings
> > 
> > libxml include directory: /sw/include/gnome-xml
> > libxml library directory: -L/sw/lib -lxml -lz -lz  -lxml
> > libxml 2:                 no
> > 
> > Compilation flags:         -I/sw/include/gnome-xml 
> > -I/sw/include/gnome-xml/libxml -DLIBXML -I/sw/include/gnome-xml
> > Link flags:               -L/sw/lib -lxml -lz -lz  -lxml
> > 
> > 
> > 
> > Compiling produced the following error:
> > gcc -bundle -flat_namespace -undefined suppress -L/sw/lib 
> > -L/usr/local/lib -o XML.so DocParse.o EventParse.o ExpatParse.o 
> > HTMLParse.o RSDTD.o RUtils.o Utils.o XMLEventParse.o XMLTree.o 
> > -L/sw/lib -lxml -lz -lz  -lxml -lcc_dynamic
> > ld: multiple definitions of symbol _xmlParserError
> > Utils.o definition of _xmlParserError in section (__TEXT,__text)
> > /sw/lib/libxml.dylib(error.lo) definition of _xmlParserError
> > make: *** [XML.so] Error 1
> > ERROR: compilation failed for package 'XML'
> > 
> > I saw that back in September there was a discussion about fixing this 
> > problem that involved passing -m to the linker.  My questions are (1) 
> > what do I need to modify (given that I am using R INSTALL to keep 
> > things simple for myself) to use the -Xlinker -m option when linking 
> > XML.so and (2) does this actually work despite the fact that there are 
> > then two definitions associated with the same symbol?  I guess a third 
> > question follows from the second--are there other fixes that I can use 
> > to build the package?
> > 
> > Thanks in advance,
> > Sean
> > 
> > ______________________________________________
> > R-devel@stat.math.ethz.ch mailing list
> > https://www.stat.math.ethz.ch/mailman/listinfo/r-devel
> 
> -- 
> _______________________________________________________________
> 
> Duncan Temple Lang                duncan@research.bell-labs.com
> Bell Labs, Lucent Technologies    office: (908)582-3217
> 700 Mountain Avenue, Room 2C-259  fax:    (908)582-3340
> Murray Hill, NJ  07974-2070       
>          http://cm.bell-labs.com/stat/duncan
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://www.stat.math.ethz.ch/mailman/listinfo/r-devel

-- 
_______________________________________________________________

Duncan Temple Lang                duncan@research.bell-labs.com
Bell Labs, Lucent Technologies    office: (908)582-3217
700 Mountain Avenue, Room 2C-259  fax:    (908)582-3340
Murray Hill, NJ  07974-2070       
         http://cm.bell-labs.com/stat/duncan

From pgilbert at bank-banque-canada.ca  Thu Oct  9 13:09:02 2003
From: pgilbert at bank-banque-canada.ca (Paul Gilbert)
Date: Thu Oct  9 18:04:14 2003
Subject: [Rd] exceeding memory causes crash on Linux
In-Reply-To: <3F858393.9000704@bankofcanada.ca>
References: <3F857954.3020808@bankofcanada.ca>
	<3F858393.9000704@bankofcanada.ca>
Message-ID: <3F85881E.1060102@bankofcanada.ca>

Paul Gilbert wrote:

>> I am having an unusual difficulty with R 1.8.0 on Mandrake 9.1 
>> running a problem that takes a large amount of memory. With R 1.7.1  
>> this ran on the machine I am using (barely), but now takes more 
>> memory than is available.  The first two times I tried with R 1.8.0, 
>> R exited after the program had run for some time, and gave no 
>> indication of anything, just returned to the shell command prompt. I 
>> ran under gdb to see if I could get a bettter indication of the 
>> problem, and this crashed Linux completely, or at least X, but I 
>> couldn't get another console either. (I haven't had anything crash 
>> Linux in a long time.) To confirm this I ran R under gdb again, and 
>> ran top to verify I was hitting memory constraints (which I was), but 
>> this time R did give a message "Error: cannot allocate a vector of 
>> size ..." 
>
>
> P.S. But there does not seem to be proper garbage collection after 
> this. Top showed the memory still in use and subsequent attempts to 
> run the program failed immediately trying to allocate a much smaller 
> vector. When I did gc()  explicitely it did clean up and I could start 
> the function again. The second time R exited back to the gdb prompt 
> with a message "Program terminated with signal  SIGKILL, Killed. The 
> program no longer exists." 

P.P.S. I can reproduce this (at least the SIGKILL part) on a machine 
with 500MB memory and swap turned off simply with
    z <- rnorm(50000000)
(Turning off swap is simply to make the failure happen quickly rather 
than slowly on a bigger problem.)

>
>
>> I'm not worried about running the problem, but I would like a more 
>> graceful exit. Might this be related to the change in error handling?
>>
>> Paul Gilbert
>>
>> ______________________________________________
>> R-devel@stat.math.ethz.ch mailing list
>> https://www.stat.math.ethz.ch/mailman/listinfo/r-devel
>>
>

From luke at stat.uiowa.edu  Thu Oct  9 12:22:15 2003
From: luke at stat.uiowa.edu (Luke Tierney)
Date: Thu Oct  9 18:21:37 2003
Subject: [Rd] exceeding memory causes crash on Linux
In-Reply-To: <3F858393.9000704@bankofcanada.ca>
Message-ID: <Pine.LNX.4.44.0310091056190.16726-100000@itasca.stat.uiowa.edu>

On Thu, 9 Oct 2003, Paul Gilbert wrote:

> Paul Gilbert wrote:
> 
> > I am having an unusual difficulty with R 1.8.0 on Mandrake 9.1 running 
> > a problem that takes a large amount of memory. With R 1.7.1  this ran 
> > on the machine I am using (barely), but now takes more memory than is 
> > available.  The first two times I tried with R 1.8.0, R exited after 
> > the program had run for some time, and gave no indication of anything, 
> > just returned to the shell command prompt. I ran under gdb to see if I 
> > could get a bettter indication of the problem, and this crashed Linux 
> > completely, or at least X, but I couldn't get another console either. 
> > (I haven't had anything crash Linux in a long time.) To confirm this I 
> > ran R under gdb again, and ran top to verify I was hitting memory 
> > constraints (which I was), but this time R did give a message "Error: 
> > cannot allocate a vector of size ..." 
> 
> P.S. But there does not seem to be proper garbage collection after this. 
> Top showed the memory still in use and subsequent attempts to run the 
> program failed immediately trying to allocate a much smaller vector. 
> When I did gc()  explicitely it did clean up and I could start the 
> function again. The second time R exited back to the gdb prompt with a 
> message "Program terminated with signal  SIGKILL, Killed. The program no 
> longer exists."
> 
> > I'm not worried about running the problem, but I would like a more 
> > graceful exit. Might this be related to the change in error handling?

Possible but not likely.

When you really push memory for your R process to the limit you create
a situation where other programs may fail because there is no more
memory for them to get at.  At some point the kernel decides there is
a problem and starts doing things to bring the system into control by
the only means it really has: blowing away processes with a SIGKILL,
which cannot be caught so there is nothing R can do about it.  Or any
other process, say your X server, if that is the one that the kernel
decides to blow away.  I forget the actual rules the kernel uses to
handle these situations but that is the gist.

I don't think the kernel goes into this self-defense mode until it
gets close to running out of both physical memory and swap space.  One
thing you might try to do is check out how much swap space you have.
If you don't have enough you might try adding a swap file of several
gigabytes and see if that helps.

One thing to keep in mind when doing computations that produce huge
results is that R saves the last value of a successful top level
evaluation in .Last.value.  If that value is huge, gc can't do
anything about it until it is replaced by something smaller.  An
explicit call to gc() is not going to be able to release any more
things than an internal call made to satisfy an allocation, except to
the extent that some additional data will be reachable as part of the
computation that triggers the internal call.  Two successive top level
gc() calls may seem to do wonders compared to just one, just because
after the first one .Last.value has been replaced by the result
returned by gc().

The memory management system also does some of its releasing of
smaller sized allocations gradually to avoid thrashing in malloc in
most situations. This is why memory use as well as triggering
thresholds can go down gradually on successive gc calls until the
reach a steady state.  This is based on heuristics that work
reasonably well across a wide range of uses but might not be ideal for
really pushing the memory limit.  At some point we might make some of
the tuning parameters for these heuristics available at the user
level, but this isn't high priority as fiddling with them is probably
much more likely to make things worse than better.

Hope that helps,

luke


-- 
Luke Tierney
University of Iowa                  Phone:             319-335-3386
Department of Statistics and        Fax:               319-335-3017
   Actuarial Science
241 Schaeffer Hall                  email:      luke@stat.uiowa.edu
Iowa City, IA 52242                 WWW:  http://www.stat.uiowa.edu

From deleeuw at stat.ucla.edu  Thu Oct  9 10:23:35 2003
From: deleeuw at stat.ucla.edu (Jan de Leeuw)
Date: Thu Oct  9 18:22:54 2003
Subject: [Rd] building XML-0.95-1 on MacOS
In-Reply-To: <20031009120231.M21760@jessie.research.bell-labs.com>
References: <15443B9C-FA64-11D7-B761-000A95D7BA10@mail.nih.gov>
	<20031009104822.D21760@jessie.research.bell-labs.com>
	<20031009120231.M21760@jessie.research.bell-labs.com>
Message-ID: <EEA67E8A-FA74-11D7-A489-000A95A67E82@stat.ucla.edu>

This builds fine on Panther, using the libxml2 provided
by Apple in /usr/lib.

On Oct 9, 2003, at 9:02, Duncan Temple Lang wrote:

>
> Stefano asked me to post something along the following lines
> about the XML package.
>
> I have modified the configuration for the XML package so that it
> looks for libxml2 if instructed, or alternatively looks for libxml 1
> and, if that is not present, then libxml 2.
>
> The new version:  XML_0.95-4.tar.gz is on the Omegahat
> Web site:
>    http://www.omegahat.org/RSXML
>
> So one should not have to set any environment variables or specify
> configuration arguments if you only have libxml2 on your machine. If
> you have both libxml and libxml2, you will get libxml 1 by default.
> Use --configure-args='--with-libxml2' or set the environment variable
> XML_CONFIG to xml2-config.
>
> At some point in the future, we will stop supporting
> old versions of libxml with no xml-config script,
> header files in odd places, ...  This is what
> makes the configuration so complex.
>
>
>  D.
>
>
>
> Duncan Temple Lang wrote:
>>
>> Hi Sean.
>>
>>   Two things. There is a new version of the XML package
>> now on the Omegahat web site:
>>
>>   http://www.omegahat.org/RSXML/XML_0.95-3.tar.gz
>>
>> That uses a different approach to dealing with errors and avoids
>> having to redefine the xmlParserError() routine.  As a result,
>> one should not need the -m flag.
>>
>> Secondly, unless there are good reasons for using
>> libxml-1.8.*, it is preferrable to use the libxml2-2*
>> series.
>>
>> The configuration for this version of the XML package has been
>> "upgraded", but may require some assistance.  If it doesn't compile
>> out of the box, please set the environment variable XML_CONFIG to the
>> name of the xml-config or xml2-config script that provides the
>> relevant information. I'll fix this up in the next release.
>>
>>  D.
>>
>>
>> Sean Davis wrote:
>>> I am trying to build the XML package on MacOS.  I am using the fink
>>> installation of libxml-1.8.17.  The configuration information is:
>>>
>>> Configuration information:
>>>
>>> Libxml settings
>>>
>>> libxml include directory: /sw/include/gnome-xml
>>> libxml library directory: -L/sw/lib -lxml -lz -lz  -lxml
>>> libxml 2:                 no
>>>
>>> Compilation flags:         -I/sw/include/gnome-xml
>>> -I/sw/include/gnome-xml/libxml -DLIBXML -I/sw/include/gnome-xml
>>> Link flags:               -L/sw/lib -lxml -lz -lz  -lxml
>>>
>>>
>>>
>>> Compiling produced the following error:
>>> gcc -bundle -flat_namespace -undefined suppress -L/sw/lib
>>> -L/usr/local/lib -o XML.so DocParse.o EventParse.o ExpatParse.o
>>> HTMLParse.o RSDTD.o RUtils.o Utils.o XMLEventParse.o XMLTree.o
>>> -L/sw/lib -lxml -lz -lz  -lxml -lcc_dynamic
>>> ld: multiple definitions of symbol _xmlParserError
>>> Utils.o definition of _xmlParserError in section (__TEXT,__text)
>>> /sw/lib/libxml.dylib(error.lo) definition of _xmlParserError
>>> make: *** [XML.so] Error 1
>>> ERROR: compilation failed for package 'XML'
>>>
>>> I saw that back in September there was a discussion about fixing this
>>> problem that involved passing -m to the linker.  My questions are (1)
>>> what do I need to modify (given that I am using R INSTALL to keep
>>> things simple for myself) to use the -Xlinker -m option when linking
>>> XML.so and (2) does this actually work despite the fact that there  
>>> are
>>> then two definitions associated with the same symbol?  I guess a  
>>> third
>>> question follows from the second--are there other fixes that I can  
>>> use
>>> to build the package?
>>>
>>> Thanks in advance,
>>> Sean
>>>
>>> ______________________________________________
>>> R-devel@stat.math.ethz.ch mailing list
>>> https://www.stat.math.ethz.ch/mailman/listinfo/r-devel
>>
>> --  
>> _______________________________________________________________
>>
>> Duncan Temple Lang                duncan@research.bell-labs.com
>> Bell Labs, Lucent Technologies    office: (908)582-3217
>> 700 Mountain Avenue, Room 2C-259  fax:    (908)582-3340
>> Murray Hill, NJ  07974-2070
>>          http://cm.bell-labs.com/stat/duncan
>>
>> ______________________________________________
>> R-devel@stat.math.ethz.ch mailing list
>> https://www.stat.math.ethz.ch/mailman/listinfo/r-devel
>
> --  
> _______________________________________________________________
>
> Duncan Temple Lang                duncan@research.bell-labs.com
> Bell Labs, Lucent Technologies    office: (908)582-3217
> 700 Mountain Avenue, Room 2C-259  fax:    (908)582-3340
> Murray Hill, NJ  07974-2070
>          http://cm.bell-labs.com/stat/duncan
>
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://www.stat.math.ethz.ch/mailman/listinfo/r-devel
>
>
===
Jan de Leeuw; Professor and Chair, UCLA Department of Statistics;
Editor: Journal of Multivariate Analysis, Journal of Statistical  
Software
US mail: 8130 Math Sciences Bldg, Box 951554, Los Angeles, CA 90095-1554
phone (310)-825-9550;  fax (310)-206-5658;  email: deleeuw@stat.ucla.edu
homepage: http://gifi.stat.ucla.edu
   
------------------------------------------------------------------------ 
-------------------------
           No matter where you go, there you are. --- Buckaroo Banzai
                    http://gifi.stat.ucla.edu/sounds/nomatter.au

From ripley at stats.ox.ac.uk  Thu Oct  9 18:46:55 2003
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu Oct  9 18:46:02 2003
Subject: [Rd] S4 group generic Complex not working (PR#4483)
In-Reply-To: <200310091518.h99FIG0P006941@pubhealth.ku.dk>
Message-ID: <Pine.LNX.4.44.0310091725400.12863-100000@gannet.stats>

On Thu, 9 Oct 2003 saikat@stat.wisc.edu wrote:

> The Complex group generic for S4 methods is not working:
> 
>  > setClass('foo', representation(z='complex'))
> [1] "foo"
>  > setMethod('Complex', 'foo', function(z) callGeneric(z@z))
> [1] "Complex"
>  > Arg(new('foo', z=1+0i))
> Error in Arg(new("foo", z = 1 + (0+0i))) :
>          non-numeric argument to function
>  >

> The fix is to add
> 
>      if (DispatchGroup("Complex", call, op, args, env, &x))
> 	return x;
> 
> near the beginning of do_cmathfuns in complex.c.

I don't think that's right: that would set up an S3 group generic 
Complex, and there is no such thing.  That's not how S4 group generics are 
implemented, according to ?Complex.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From p.dalgaard at biostat.ku.dk  Thu Oct  9 17:49:12 2003
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard BSA)
Date: Thu Oct  9 18:49:14 2003
Subject: [Rd] exceeding memory causes crash on Linux
In-Reply-To: <3F85881E.1060102@bankofcanada.ca>
References: <3F857954.3020808@bankofcanada.ca>
	<3F858393.9000704@bankofcanada.ca> <3F85881E.1060102@bankofcanada.ca>
Message-ID: <x2smm21hj0.fsf@biostat.ku.dk>

Paul Gilbert <pgilbert@bank-banque-canada.ca> writes:

> Paul Gilbert wrote:
> 
> >> I am having an unusual difficulty with R 1.8.0 on Mandrake 9.1
> >> running a problem that takes a large amount of memory. With R 1.7.1
> >> this ran on the machine I am using (barely), but now takes more
> >> memory than is available.  The first two times I tried with R
> >> 1.8.0, R exited after the program had run for some time, and gave
> >> no indication of anything, just returned to the shell command
> >> prompt. I ran under gdb to see if I could get a bettter indication
> >> of the problem, and this crashed Linux completely, or at least X,
> >> but I couldn't get another console either. (I haven't had anything
> >> crash Linux in a long time.) To confirm this I ran R under gdb
> >> again, and ran top to verify I was hitting memory constraints
> >> (which I was), but this time R did give a message "Error: cannot
> >> allocate a vector of size ..."
> >
> >
> > P.S. But there does not seem to be proper garbage collection after
> > this. Top showed the memory still in use and subsequent attempts to
> > run the program failed immediately trying to allocate a much smaller
> > vector. When I did gc()  explicitely it did clean up and I could
> > start the function again. The second time R exited back to the gdb
> > prompt with a message "Program terminated with signal  SIGKILL,
> > Killed. The program no longer exists."
> 
> P.P.S. I can reproduce this (at least the SIGKILL part) on a machine
> with 500MB memory and swap turned off simply with
>     z <- rnorm(50000000)
> (Turning off swap is simply to make the failure happen quickly rather
> than slowly on a bigger problem.)
> 
> >
> >
> >> I'm not worried about running the problem, but I would like a more
> >> graceful exit. Might this be related to the change in error
> >> handling?

I believe this is in the operating system, not in R. When all system
memory has been used up, the kernel goes looking for a job to kill,
and that can be R, the X server, or whatever it feels like. It is
difficult for R to do anything about it since the out-of-memory
condition can arise after the memory was allocated.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From annis at biostat.wisc.edu  Thu Oct  9 20:42:13 2003
From: annis at biostat.wisc.edu (annis@biostat.wisc.edu)
Date: Thu Oct  9 19:41:22 2003
Subject: [Rd] R-1.8.0 on Sparc Solaris 8, gcc3.2.1,
	bus error and core dump (PR#4485)
Message-ID: <200310091742.h99HgD0P008094@pubhealth.ku.dk>


Example run and stack trace:


wazor /s/src/stat/R-1.8.0/tests/Examples $ ../../bin/R --no-save < base-Ex.R

R : Copyright 2003, The R Development Core Team
Version 1.8.0  (2003-10-08)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for a HTML browser interface to help.
Type 'q()' to quit R.

> ### * <HEADER>
> ###
> attach(NULL, name = "CheckExEnv")
> assign(".CheckExEnv", as.environment(2), pos = length(search())) # base
> ## This plot.new() patch has no effect yet for persp();
> ## layout() & filled.contour() are now ok
> assign("plot.new",
+        function() {
+ 	   .Internal(plot.new())
+ 	   pp <- par(c("mfg","mfcol","oma","mar"))
+ 	   if(all(pp$mfg[1:2] == c(1, pp$mfcol[2]))) {
+                outer <- (oma4 <- pp$oma[4]) > 0; mar4 <- pp$mar[4]
+                mtext(paste("help(", ..nameEx, ")"), side = 4,
+                      line = if(outer)max(1, oma4 - 1) else min(1, mar4 - 1),
+                      outer = outer, adj = 1, cex = .8, col = "orchid")
+ 	   }
+        },
+        env = environment(plot))
> assign("cleanEx",
+        function(env = .GlobalEnv) {
+ 	   rm(list = ls(envir = env, all.names = TRUE), envir = env)
+            RNGkind("Wichmann-Hill", "default")
+ 	   assign(".Random.seed", c(0, rep(7654, 3)), pos = 1)
+ 	   assign("T", delay(stop("T used instead of TRUE")),
+ 		  pos = .CheckExEnv)
+ 	   assign("F", delay(stop("F used instead of FALSE")),
+ 		  pos = .CheckExEnv)
+        },
+        env = .CheckExEnv)
> assign("..nameEx", "__{must remake R-ex/*.R}__", env = .CheckExEnv) # for now
> assign("ptime", proc.time(), env = .CheckExEnv)
> postscript("base-Examples.ps")
> assign("par.postscript", par(no.readonly = TRUE), env = .CheckExEnv)
> options(contrasts = c(unordered = "contr.treatment", ordered = "contr.poly"))
> cleanEx(); ..nameEx <- "AIC"
> 
> ### * AIC
> 
> ### Name: AIC
> ### Title: Akaike's An Information Criterion
> ### Aliases: AIC AIC.default AIC.logLik
> ### Keywords: models
> 
> ### ** Examples
> 
> data(swiss)
> lm1 <- lm(Fertility ~ . , data = swiss)
> AIC(lm1)
[1] 326.0716
> stopifnot(all.equal(AIC(lm1),
+                     AIC(logLik(lm1))))
> ## a version of BIC or Schwarz' BC :
> AIC(lm1, k = log(nrow(swiss)))
[1] 339.0226
> 
> 
> 
> cleanEx(); ..nameEx <- "Arithmetic"
> 
> ### * Arithmetic
> 
> ### Name: Arithmetic
> ### Title: Arithmetic Operators
> ### Aliases: + - * / ^ \%\% \%/\% Arithmetic
> ### Keywords: arith
> 
> ### ** Examples
> 
> x <- -1:12
> x + 1
 [1]  0  1  2  3  4  5  6  7  8  9 10 11 12 13
> 2 * x + 3
 [1]  1  3  5  7  9 11 13 15 17 19 21 23 25 27
> x %% 2 #-- is periodic
 [1] 1 0 1 0 1 0 1 0 1 0 1 0 1 0
> x %/% 5
 [1] -1  0  0  0  0  0  1  1  1  1  1  2  2  2
> 
> 
> 
> cleanEx(); ..nameEx <- "Bessel"
> 
> ### * Bessel
> 
> ### Name: Bessel
> ### Title: Bessel Functions
> ### Aliases: bessel Bessel besselI besselJ besselK besselY gammaCody
> ### Keywords: math
> 
> ### ** Examples
> 
> nus <- c(0:5,10,20)
> 
> x <- seq(0,4, len= 501)
> plot(x,x, ylim = c(0,6), ylab="",type='n', main = "Bessel Functions  I_nu(x)")
Bus Error(coredump)


wazor /s/src/stat/R-1.8.0/tests/Examples $ gdb ../../bin/R.bin core
GNU gdb 5.3
Copyright 2002 Free Software Foundation, Inc.
GDB is free software, covered by the GNU General Public License, and you are
welcome to change it and/or distribute copies of it under certain conditions.
Type "show copying" to see the conditions.
There is absolutely no warranty for GDB.  Type "show warranty" for details.
This GDB was configured as "sparc-sun-solaris2.8"...
Core was generated by `/s/src/stat/R-1.8.0/bin/R.bin --no-save'.
Program terminated with signal 10, Bus error.
Reading symbols from /usr/lib/libm.so.1...done.
Loaded symbols for /usr/lib/libm.so.1
Reading symbols from /usr/lib/libbz2.so.1...done.
Loaded symbols for /usr/lib/libbz2.so.1
Reading symbols from /usr/lib/libz.so...done.
Loaded symbols for /usr/lib/libz.so
Reading symbols from /usr/lib/libnsl.so.1...done.
Loaded symbols for /usr/lib/libnsl.so.1
Reading symbols from /usr/lib/libsocket.so.1...done.
Loaded symbols for /usr/lib/libsocket.so.1
Reading symbols from /usr/lib/libdl.so.1...done.
Loaded symbols for /usr/lib/libdl.so.1
Reading symbols from /usr/lib/libcurses.so.1...done.
Loaded symbols for /usr/lib/libcurses.so.1
Reading symbols from /usr/lib/libc.so.1...done.
Loaded symbols for /usr/lib/libc.so.1
Reading symbols from /usr/lib/libmp.so.2...done.
Loaded symbols for /usr/lib/libmp.so.2
Reading symbols from /usr/platform/SUNW,Ultra-5_10/lib/libc_psr.so.1...done.
Loaded symbols for /usr/platform/SUNW,Ultra-5_10/lib/libc_psr.so.1
Reading symbols from /usr/lib/locale/en_US.ISO8859-1/en_US.ISO8859-1.so.2...
done.
Loaded symbols for /usr/lib/locale/en_US.ISO8859-1/en_US.ISO8859-1.so.2
Reading symbols from /s/src/stat/R-1.8.0/library/ts/libs/ts.so...done.
Loaded symbols for /s/src/stat/R-1.8.0/library/ts/libs/ts.so
Reading symbols from /s/src/stat/R-1.8.0/library/nls/libs/nls.so...done.
Loaded symbols for /s/src/stat/R-1.8.0/library/nls/libs/nls.so
Reading symbols from /s/src/stat/R-1.8.0/library/modreg/libs/modreg.so...done.
Loaded symbols for /s/src/stat/R-1.8.0/library/modreg/libs/modreg.so
Reading symbols from /s/src/stat/R-1.8.0/library/mva/libs/mva.so...done.
Loaded symbols for /s/src/stat/R-1.8.0/library/mva/libs/mva.so
Reading symbols from /s/src/stat/R-1.8.0/library/ctest/libs/ctest.so...done.
Loaded symbols for /s/src/stat/R-1.8.0/library/ctest/libs/ctest.so
Reading symbols from /s/src/stat/R-1.8.0/library/methods/libs/methods.so...
done.
Loaded symbols for /s/src/stat/R-1.8.0/library/methods/libs/methods.so
Reading symbols from /s/src/stat/R-1.8.0/library/tools/libs/tools.so...done.
Loaded symbols for /s/src/stat/R-1.8.0/library/tools/libs/tools.so
Reading symbols from /usr/lib/nss_files.so.1...done.
Loaded symbols for /usr/lib/nss_files.so.1
Reading symbols from /usr/lib/nss_nis.so.1...done.
Loaded symbols for /usr/lib/nss_nis.so.1
#0  Rf_gpptr (dd=0xd) at base.c:162
162	    if (dd->newDevStruct) 
(gdb) bt
#0  Rf_gpptr (dd=0xd) at base.c:162
#1  0x00092ff4 in setClipRect (x1=0xffbed0e0, y1=0xffbed0d8, x2=0xffbed0d0, 
    y2=0xffbed0c8, coords=1298034561, dd=0xd) at graphics.c:2392
#2  0x0009524c in clipRectCode (x0=11.033191163604547, y0=6.0986887576552915, 
    x1=11.232635608048993, y1=5.3139879049022003e-315, coords=873873659, 
    dd=0xd) at graphics.c:3340
#3  0x00095dd8 in clipText (x=11.13291338582677, y=6.9477165354330692, 
    str=0xdb8f18 "help( Bessel )", rot=90, clipToDevice=1, hadj=1, 
    dd=0xd8e1a0) at graphics.c:3585
#4  0x00096240 in Rf_GText (x=11.13291338582677, y=6.9477165354330692, 
    coords=1, str=0x0, xc=1, yc=0, rot=90, dd=0xd8e1a0) at graphics.c:3740
#5  0x000988d0 in Rf_GMtext (str=0xb400e0 "help( Bessel )", side=4, line=1.8, 
    outer=0, at=1.04, las=0, dd=0xd8e1a0) at graphics.c:4366
#6  0x000c736c in do_mtext (call=0x80d818, op=0x224b90, args=0x0, env=0x1)
    at plot.c:2374
#7  0x000ac114 in do_internal (call=0x1bc688, op=0x1, args=0xec15a8, 
    env=0xec328c) at names.c:1046
#8  0x0007d6cc in Rf_eval (e=0x80d78c, rho=0xec328c) at eval.c:375
#9  0x0007ed28 in do_begin (call=0x80cc6c, op=0x2163b8, args=0x80d770, 
    rho=0xec328c) at eval.c:1034
#10 0x0007d6cc in Rf_eval (e=0x80cc6c, rho=0xec328c) at eval.c:375
#11 0x0007da54 in Rf_applyClosure (call=0xf6d5b4, op=0x80d690, 
    arglist=0xec2fec, rho=0xec5468, suppliedenv=0x1fb768) at eval.c:558
#12 0x0007d4f8 in Rf_eval (e=0xf6d5b4, rho=0xec5468) at eval.c:410
#13 0x0007ed28 in do_begin (call=0xf6cea0, op=0x2163b8, args=0xf6d598, 
    rho=0xec5468) at eval.c:1034
#14 0x0007d6cc in Rf_eval (e=0xf6cea0, rho=0xec5468) at eval.c:375
#15 0x0007d6cc in Rf_eval (e=0xf6d544, rho=0xec5468) at eval.c:375
#16 0x0007ed28 in do_begin (call=0xf6c834, op=0x2163b8, args=0xf6d528, 
    rho=0xec5468) at eval.c:1034
#17 0x0007d6cc in Rf_eval (e=0xf6c834, rho=0xec5468) at eval.c:375
#18 0x0007da54 in Rf_applyClosure (call=0x8d5db4, op=0xf6e0b8, 
    arglist=0x1fb768, rho=0xec9910, suppliedenv=0x1fb768) at eval.c:558
#19 0x0007d4f8 in Rf_eval (e=0x8d5db4, rho=0xec9910) at eval.c:410
#20 0x0007ed28 in do_begin (call=0x8d4760, op=0x2163b8, args=0x8d5d98, 
    rho=0xec9910) at eval.c:1034
#21 0x0007d6cc in Rf_eval (e=0x8d4760, rho=0xec9910) at eval.c:375
#22 0x0007da54 in Rf_applyClosure (call=0xec945c, op=0x8d7004, 
    arglist=0xeca770, rho=0xeca968, suppliedenv=0xec9424) at eval.c:558
#23 0x000ac484 in applyMethod (call=0xec945c, op=0x8d7004, args=0xeca770, 
    rho=0xeca968, newrho=0xec9424) at objects.c:119
#24 0x000acad8 in Rf_usemethod (generic=0x8cf918 "plot", obj=0x8d7004, 
    call=0xffbee300, args=0xec9424, rho=0xeca968, callrho=0x227480, 
    defrho=0x229388, ans=0xffbee57c) at objects.c:326
#25 0x000acf7c in do_usemethod (call=0x8d3bd8, op=0x2251a8, args=0x8d3bf4, 
    env=0xeca968) at objects.c:389
#26 0x0007d6cc in Rf_eval (e=0x8d3bd8, rho=0xeca968) at eval.c:375
#27 0x0007d6cc in Rf_eval (e=0x8d3b68, rho=0xeca968) at eval.c:375
#28 0x0007ed28 in do_begin (call=0x8d3b4c, op=0x2163b8, args=0x8d3b30, 
    rho=0xeca968) at eval.c:1034
#29 0x0007d6cc in Rf_eval (e=0x8d3b4c, rho=0xeca968) at eval.c:375
#30 0x0007da54 in Rf_applyClosure (call=0xeca71c, op=0x8d3a50, 
    arglist=0xeca770, rho=0x227480, suppliedenv=0x1fb768) at eval.c:558
#31 0x0007d4f8 in Rf_eval (e=0xeca71c, rho=0x227480) at eval.c:410
#32 0x0009e1ac in Rf_ReplIteration (rho=0x227480, savestack=0, browselevel=0, 
    state=0xffbeec08) at main.c:245
#33 0x0009e350 in R_ReplConsole (rho=0x227480, savestack=0, browselevel=0)
    at main.c:293
#34 0x0009ebdc in run_Rmainloop () at main.c:643
#35 0x0010bfac in main (ac=0, av=0xffbef174) at system.c:99
(gdb) q

-- 
William Annis  -   System Administrator  -  Biomedical Computing Group
"No man forgets his original trade: the rights of nations and of kings sink
into questions of grammar, if grammarians discuss them." Samuel Johnson

From saikat at stat.wisc.edu  Thu Oct  9 15:17:26 2003
From: saikat at stat.wisc.edu (Saikat DebRoy)
Date: Thu Oct  9 20:15:41 2003
Subject: [Rd] S4 group generic Complex not working (PR#4483)
In-Reply-To: <Pine.LNX.4.44.0310091725400.12863-100000@gannet.stats>
Message-ID: <D5E403C7-FA84-11D7-92F4-0003931A3C9E@stat.wisc.edu>

On Thursday, Oct 9, 2003, at 12:46 US/Eastern, Prof Brian Ripley wrote:

> On Thu, 9 Oct 2003 saikat@stat.wisc.edu wrote:
>
>> The Complex group generic for S4 methods is not working:
>>
>>> setClass('foo', representation(z='complex'))
>> [1] "foo"
>>> setMethod('Complex', 'foo', function(z) callGeneric(z@z))
>> [1] "Complex"
>>> Arg(new('foo', z=1+0i))
>> Error in Arg(new("foo", z = 1 + (0+0i))) :
>>          non-numeric argument to function
>>>
>
>> The fix is to add
>>
>>      if (DispatchGroup("Complex", call, op, args, env, &x))
>> 	return x;
>>
>> near the beginning of do_cmathfuns in complex.c.
>
> I don't think that's right: that would set up an S3 group generic
> Complex, and there is no such thing.  That's not how S4 group generics 
> are
> implemented, according to ?Complex.
>

The problem may be with setGroupGeneric. Here is one example where it 
is not working.

 > setGroupGeneric('Finite', function(x) NULL, c('is.finite', 
'is.infinite', +  'is.na', 'is.nan'))
[1] "Finite"
 > setClass('foo', representation(x='numeric'))
[1] "foo"
 > setMethod('Finite', 'foo', function(x) callGeneric(x@x))
[1] "Finite"
 > is.finite(1)
[1] TRUE
 > is.finite(new('foo', x=1))
logical(0)
 >

From ripley at stats.ox.ac.uk  Thu Oct  9 20:31:44 2003
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu Oct  9 20:31:01 2003
Subject: (PR#4485) Re: [Rd] R-1.8.0 on Sparc Solaris 8, gcc3.2.1, bus error
	and core dump (PR#4485)
In-Reply-To: <200310091742.h99HgD0P008094@pubhealth.ku.dk>
Message-ID: <Pine.LNX.4.44.0310091927260.13167-100000@gannet.stats>

That's an obselete and broken compiler, and the R-admin manual says

@command{gcc} 3.2.1 and 3.2.2 generate incorrect code on 32-bit Solaris
builds with optimization, but versions 3.1, 3.2, 3.2.3  and 3.3 work
correctly. 

Please do pay attention to the documentation, as the INSTALL file asks!
You probably haven't read that either, so please note it says:

The main source of information on installation is the `R Installation
and Administration Manual', an HTML copy of which is available as file
`doc/html/R-admin.html'.  Please read that before installing R.  But
if you are impatient, read on but please refer to the manual to
resolve any problems.



-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From jmc at research.bell-labs.com  Thu Oct  9 15:46:50 2003
From: jmc at research.bell-labs.com (John Chambers)
Date: Thu Oct  9 20:46:05 2003
Subject: [Rd] S4 group generic Complex not working (PR#4483)
References: <Pine.LNX.4.44.0310091725400.12863-100000@gannet.stats>
Message-ID: <3F85AD1A.5DB6B895@research.bell-labs.com>

Prof Brian Ripley wrote:
> 
> On Thu, 9 Oct 2003 saikat@stat.wisc.edu wrote:
> 
> > The Complex group generic for S4 methods is not working:
> >
> >  > setClass('foo', representation(z='complex'))
> > [1] "foo"
> >  > setMethod('Complex', 'foo', function(z) callGeneric(z@z))
> > [1] "Complex"
> >  > Arg(new('foo', z=1+0i))
> > Error in Arg(new("foo", z = 1 + (0+0i))) :
> >          non-numeric argument to function
> >  >
> 
> > The fix is to add
> >
> >      if (DispatchGroup("Complex", call, op, args, env, &x))
> >       return x;
> >
> > near the beginning of do_cmathfuns in complex.c.

For arguments that might have methods, DispatchGroup first tries to
dispatch an S4 method, then if none is found goes on to look for an S3
method.

The choice would seem to be:  (1) allow both S4 and S3 group methods for
Complex (& revise current documentation); or (2) special-case the code
in DispatchGroup to skip S3 methods when argument `group' matches
"Complex".

Preferences?

John

> 
> I don't think that's right: that would set up an S3 group generic
> Complex, and there is no such thing.  That's not how S4 group generics are
> implemented, according to ?Complex.
> 
> --
> Brian D. Ripley,                  ripley@stats.ox.ac.uk
> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> University of Oxford,             Tel:  +44 1865 272861 (self)
> 1 South Parks Road,                     +44 1865 272866 (PA)
> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://www.stat.math.ethz.ch/mailman/listinfo/r-devel

From p.dalgaard at biostat.ku.dk  Thu Oct  9 19:50:19 2003
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard BSA)
Date: Thu Oct  9 20:50:21 2003
Subject: [Rd] R-1.8.0 on Sparc Solaris 8, gcc3.2.1,
	bus error and core dump (PR#4485)
In-Reply-To: <200310091742.h99HgD0P008094@pubhealth.ku.dk>
References: <200310091742.h99HgD0P008094@pubhealth.ku.dk>
Message-ID: <x2y8vutf90.fsf@biostat.ku.dk>

annis@biostat.wisc.edu writes:

> Example run and stack trace:
...
> Bus Error(coredump)

Bug, but not in R.

See http://cran.r-project.org/doc/manuals/R-admin.pdf, sec. B.7.2

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From annis at biostat.wisc.edu  Thu Oct  9 15:02:23 2003
From: annis at biostat.wisc.edu (William Annis)
Date: Thu Oct  9 21:01:40 2003
Subject: (PR#4485) Re: [Rd] R-1.8.0 on Sparc Solaris 8, gcc3.2.1, bus error
	and core dump (PR#4485)
In-Reply-To: <Pine.LNX.4.44.0310091927260.13167-100000@gannet.stats> (message
	from Prof Brian Ripley on Thu, 9 Oct 2003 19:31:44 +0100 (BST))
References: <Pine.LNX.4.44.0310091927260.13167-100000@gannet.stats>
Message-ID: <200310091902.h99J2NSH009247@wazor.biostat.wisc.edu>


 >Please do pay attention to the documentation, as the INSTALL file asks!
 >You probably haven't read that either, so please note it says:

        Yikes.  Sorry.  R has been in the past one of the easiest
programs to install (and whoever thought up 'R INSTALL pkg.tar.gz'
should get an award) that I normally do no more than skim the INSTALL
file looking for peculiarities.

        I'll pay closer attention to that in future releases, and
sorry for the bother.

-- 
William Annis  -   System Administrator  -  Biomedical Computing Group
"No man forgets his original trade: the rights of nations and of kings sink
into questions of grammar, if grammarians discuss them." Samuel Johnson

From anaximander at gmx.de  Thu Oct  9 23:34:44 2003
From: anaximander at gmx.de (anaximander@gmx.de)
Date: Thu Oct  9 22:33:56 2003
Subject: [Rd] Recursive indexing can cause R-1.8.0 (and R-1.7.1) to segment
	fault (PR#4486)
Message-ID: <200310092034.h99KYi0P009409@pubhealth.ku.dk>

Recursive indexing can cause R-1.8.0 (and R-1.7.1) to segment fault

First of all, many thanks to the R team!!
R is really a software for everyday work.
Yes, I've found a fault, but I hope it's not just faultfinding ;-)

In the NEWS file of R-1.8.0, first printed in R NEWS 1.7.1,
there was given a promise: [ 1 ]
  o       Recursive indexing of lists is allowed, so x[[c(4,2)]] is
          shorthand for x[[4]][[2]] etc.  (Wishlist PR#1588)

That's not fulfilled in all cases, although there was already a
code correction in R-1.8.0: [ 2 ]
   o       Recursive indexing of lists had too little error-checking.
           (related to PR#3324)

Recursive indexing can cause R-1.8.0 / R-1.7.1 / R-1.7.0
(operating system: linux, compiler: gcc 3.3.1 or 2.95.3)
to produce a segment fault.

Suppose we have the following code:
(be aware: it crashes R!)
###################################################################
# R code from Volkmar Klatt, email: volkmar.klatt AT stud.uni-bayreuth.de
# just make a nested list: 
erzeugeTestListe <- function( laenge )
{ 
Liste <- list()
for (i in 1: laenge )
   {
   hilf <- round(runif(1)*20) +1 
   X <- runif( hilf )
   Y <- runif( hilf )^2
   summeX <- sum(X)
   summeY <- sum(Y)
   Liste <- c(Liste, list(list( summe=list(X=summeX, Y=summeY),
punkte=list(X=X, Y=Y))) )
   }
# make clean:
rm( hilf, summeX, summeY,  X,Y, i )
return( Liste )
} # end of erzeugeTestListe()
#
#
Liste <- erzeugeTestListe(25)            #0
#
# Now, e.g., we want to extract all X-und Y-elements of Nr. 7-12 and 18,20
# and to write them into a vector A:
A <- Liste[[ c(7:12,18,20) ]]$summe$X    #1 ...good bye!!
#
#
#    __
#   //##)
#  //  o  -  Wow, 
#   /  \       fantastic, that's really a short R-session ...
#
###################################################################
##
## We can achieve the same result with lapply:
# x <- c( 7:12, 18,20 )
# lapply(  Liste[[ c(x,1)  ]] , FUN=print ) #2 ...good bye!
#
#
# Remark:
# Very seldom, R-1.8.0 does not crash, but gives the following
# output:
# Error: recursive indexing failed at level 3
# You then should just make an other list Liste (line #0)
# and try line (#1) or (#2) again. 
###################################################################

Of coarse, R is not intended to be an ingenious data base program,
which should be able to handle, let's say, complicated requests 
like they are possible in SQL-language.

On the other side, lists are becoming more and more important in R,
so there *should* be a convenient way to deal with nested lists, shan't it?
Sure, all of us can avoid such lists in our own data, but we often
have to use data files from other people with *have* a nested structure.
(Thats the way I discovered this error.)

Perhaps we can find a fair compromise?

Have a nice day,
Volkmar Klatt
anaximander AT gmx.de
or
volkmar.klatt AT stud.uni-bayreuth.de

Bibliography:
[ 1 ] http://www.cran.r-project.org/src/base/NEWS , line 1116 f.
[ 2 ] ibidem, line 774 f.
###########################################################################




-- 
NEU FÜR ALLE - GMX MediaCenter - für Fotos, Musik, Dateien...
Fotoalbum, File Sharing, MMS, Multimedia-Gruß, GMX FotoService

Jetzt kostenlos anmelden unter http://www.gmx.net

+++ GMX - die erste Adresse für Mail, Message, More! +++

From carey at sdac.harvard.edu  Fri Oct 10 01:06:06 2003
From: carey at sdac.harvard.edu (Vincent Carey)
Date: Fri Oct 10 06:06:21 2003
Subject: [Rd] 1.9 contrib archive for win needed
Message-ID: <200310100406.h9A466B08496@sdac.harvard.edu>

in 1.9 for windows,
contrib.url(getOption("CRAN"))
names a non-existent resource; the
contrib/1.9 directory needs to be
made and populated on CRAN

this happened for 1.8 also.

i know it's early, just an fyi

From edd at debian.org  Fri Oct 10 00:17:33 2003
From: edd at debian.org (Dirk Eddelbuettel)
Date: Fri Oct 10 06:17:11 2003
Subject: [Rd] 1.9 contrib archive for win needed
In-Reply-To: <200310100406.h9A466B08496@sdac.harvard.edu>
References: <200310100406.h9A466B08496@sdac.harvard.edu>
Message-ID: <20031010041733.GA25600@sonny.eddelbuettel.com>

On Fri, Oct 10, 2003 at 12:06:06AM -0400, Vincent Carey wrote:
> in 1.9 for windows,
> contrib.url(getOption("CRAN"))
> names a non-existent resource; the
> contrib/1.9 directory needs to be
> made and populated on CRAN

Err -- Knowing no better way to see how $CRAN/src/contrib changes, I keep a
browser window on http://cran.us.r-project.org/src/contrib/?M=D -- and it
started to show it yesterday.  In effect this URL works just fine:
http://cran.us.r-project.org/src/contrib/1.9.0/ 

Were you pointing to a mirror that's lagging behind?

Dirk

-- 
Those are my principles, and if you don't like them... well, I have others.
                                                -- Groucho Marx

From ligges at statistik.uni-dortmund.de  Fri Oct 10 08:46:27 2003
From: ligges at statistik.uni-dortmund.de (Uwe Ligges)
Date: Fri Oct 10 08:46:58 2003
Subject: [Rd] 1.9 contrib archive for win needed
In-Reply-To: <20031010041733.GA25600@sonny.eddelbuettel.com>
References: <200310100406.h9A466B08496@sdac.harvard.edu>
	<20031010041733.GA25600@sonny.eddelbuettel.com>
Message-ID: <3F8655C3.5040309@statistik.uni-dortmund.de>

Dirk Eddelbuettel wrote:
> On Fri, Oct 10, 2003 at 12:06:06AM -0400, Vincent Carey wrote:
> 
>>in 1.9 for windows,
>>contrib.url(getOption("CRAN"))
>>names a non-existent resource; the
>>contrib/1.9 directory needs to be
>>made and populated on CRAN
> 
> 
> Err -- Knowing no better way to see how $CRAN/src/contrib changes, I keep a
> browser window on http://cran.us.r-project.org/src/contrib/?M=D -- and it
> started to show it yesterday.  In effect this URL works just fine:
> http://cran.us.r-project.org/src/contrib/1.9.0/ 

Vincent is talking about the directory for the binary packages for 
*Windows*. I have just linked 1.9 to 1.8 - it will show up on CRAN 
master tomorrow. Thanks for the reminder!

Uwe



> Were you pointing to a mirror that's lagging behind?
> 
> Dirk
>

From ripley at stats.ox.ac.uk  Fri Oct 10 09:42:29 2003
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri Oct 10 09:41:46 2003
Subject: [Rd] S4 group generic Complex not working (PR#4483)
In-Reply-To: <3F85AD1A.5DB6B895@research.bell-labs.com>
Message-ID: <Pine.LNX.4.44.0310100835520.16936-100000@gannet.stats>

On Thu, 9 Oct 2003, John Chambers wrote:

> Prof Brian Ripley wrote:
> > 
> > On Thu, 9 Oct 2003 saikat@stat.wisc.edu wrote:
> > 
> > > The Complex group generic for S4 methods is not working:
> > >
> > >  > setClass('foo', representation(z='complex'))
> > > [1] "foo"
> > >  > setMethod('Complex', 'foo', function(z) callGeneric(z@z))
> > > [1] "Complex"
> > >  > Arg(new('foo', z=1+0i))
> > > Error in Arg(new("foo", z = 1 + (0+0i))) :
> > >          non-numeric argument to function
> > >  >
> > 
> > > The fix is to add
> > >
> > >      if (DispatchGroup("Complex", call, op, args, env, &x))
> > >       return x;
> > >
> > > near the beginning of do_cmathfuns in complex.c.
> 
> For arguments that might have methods, DispatchGroup first tries to
> dispatch an S4 method, then if none is found goes on to look for an S3
> method.
> 
> The choice would seem to be:  (1) allow both S4 and S3 group methods for
> Complex (& revise current documentation); or (2) special-case the code
> in DispatchGroup to skip S3 methods when argument `group' matches
> "Complex".
> 
> Preferences?

It makes sense to introduce a S3 group for Complex, and although that 
would be a new feature I guess it would be acceptable in a patch release 
as a side-effect of a bug fix.

Is this all that is wrong though?  I failed to set a method for Arg 
directly, but am not sure I am awake enough to have done it right:

> setClass('foo', representation(z='complex'))
[1] "foo"
> setMethod("Arg", "foo", function(z) Arg(z@z))
[1] "Arg"
> Arg(new('foo', z=1+0i))
Error in Arg(new("foo", z = 1 + (0+0i))) : 
        non-numeric argument to function


> 
> John
> 
> > 
> > I don't think that's right: that would set up an S3 group generic
> > Complex, and there is no such thing.  That's not how S4 group generics are
> > implemented, according to ?Complex.
> > 
> > --
> > Brian D. Ripley,                  ripley@stats.ox.ac.uk
> > Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> > University of Oxford,             Tel:  +44 1865 272861 (self)
> > 1 South Parks Road,                     +44 1865 272866 (PA)
> > Oxford OX1 3TG, UK                Fax:  +44 1865 272595
> > 
> > ______________________________________________
> > R-devel@stat.math.ethz.ch mailing list
> > https://www.stat.math.ethz.ch/mailman/listinfo/r-devel
> 
> 

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From Bernhard.Pfaff at drkw.com  Fri Oct 10 12:09:50 2003
From: Bernhard.Pfaff at drkw.com (Pfaff, Bernhard)
Date: Fri Oct 10 12:09:02 2003
Subject: [Rd] R 1.8.0 Windows-source compilation-internet.Rout.save
Message-ID: <18D602BD42B7E24EB810D6454A58DB9004730648@ibfftce505.is.de.dresdnerkb.com>

Let me firstly thank the R Core Team for their tremendous efforts in
providing R 1.8.0. My following comment should therefore be understood as an
"fyi-only".

I source compiled R 1.8.0 for windows with ATLAS (source compiled, too).
Everything works fine and R is running flawlessly! However, running "make
check" stops during processing "internet.R". I checked the
"internet.Rout.Save" and found the following two temptative "culprits":

1)
> try(zz <- url("http://foo.bar", "r"))
unable to resolve 'foo.bar'.
Error in url("http://foo.bar", "r") : unable to open connection

and further down in the file:

2)
> try(finger("root"))  ## only works if your site provides a finger daemon
Error in make.socket(host, port) : Socket not established

which stopped the "make check". Everything else was exectuted correctly in
the "internet.R" file. Because R 1.8.0 is running fine and no other
obstacles occured during compilation (recommended packages and all docs, as
well) I ignored this error.

Thks again for your tremendous efforts and provision of this release!

Bernhard



Dr. Bernhard Pfaff
Global Debt Research - Index and Quantitative Strategy
Dresdner Kleinwort Wasserstein
Phone:	+49 (0)69 713 12273 
Mobile: 	na 
Fax:	+49 (0)69 713 19816

<http://www.drkwresearch.com>
Bloomberg: DRKW<GO>



--------------------------------------------------------------------------------
The information contained herein is confidential and is intended solely for the
addressee. Access by any other party is unauthorised without the express 
written permission of the sender. If you are not the intended recipient, please 
contact the sender either via the company switchboard on +44 (0)20 7623 8000, or
via e-mail return. If you have received this e-mail in error or wish to read our
e-mail disclaimer statement and monitoring policy, please refer to 
http://www.drkw.com/disc/email/ or contact the sender.

From maechler at stat.math.ethz.ch  Fri Oct 10 12:26:27 2003
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Fri Oct 10 12:25:32 2003
Subject: [Rd] 1.8.0 on Unix: interrupting huge print()s  ??
Message-ID: <16262.35155.835148.704877@gargle.gargle.HOWL>

NEWS for R 1.8.0 has

>>  USER-VISIBLE CHANGES
>> 
>>      <......>
>> 
>>      o	On Unix-like systems interrupt signals now set a flag that is
>> 	 checked periodically rather than calling longjmp from the
>> 	 signal handler.	 This is analogous to the behavior on Windows.
>> 	 This reduces responsiveness to interrupts but prevents bugs
>> 	 caused by interrupting computations in a way that leaves the
>> 	 system in an inconsistent state.  It also reduces the number
>> 	 of system calls, which can speed up computations on some
>> 	 platforms and make R more usable with systems like Mosix.

and this has already caused grief here
(actually it has several days ago, when I switched our users to
 R-1.8.0beta  __ BUT THEY DIDN'T TELL ANY R DEVELOPER __ )

for a user who does use *large* matrices.

When accidentally calling print() {implicitly}, we have been
used here to press CTRL+c (twice in Emacs ESS!) for stopping the
output.

This no longer works in R 1.8.0 at least on our unix platforms.
To reproduce, type

  cbind(1:1e6)

and try to cut it short (it only takes a minute or so,
whereas our user here had a matrix that needed more than 10
minutes of screen output !)

From hb at maths.lth.se  Fri Oct 10 12:48:04 2003
From: hb at maths.lth.se (Henrik Bengtsson)
Date: Fri Oct 10 12:48:20 2003
Subject: [Rd] 1.8.0 on Unix: interrupting huge print()s  ??
In-Reply-To: <16262.35155.835148.704877@gargle.gargle.HOWL>
Message-ID: <003a01c38f1b$fbb72a80$e502eb82@maths.lth.se>

> -----Original Message-----
> From: r-devel-bounces@stat.math.ethz.ch 
> [mailto:r-devel-bounces@stat.math.ethz.ch] On Behalf Of 
> Martin Maechler
> Sent: den 10 oktober 2003 12:26
> To: R-devel@stat.math.ethz.ch
> Subject: [Rd] 1.8.0 on Unix: interrupting huge print()s ??
> 

[snip]

> platforms. To reproduce, type
> 
>   cbind(1:1e6)
> 
> and try to cut it short (it only takes a minute or so,
> whereas our user here had a matrix that needed more than 10 
> minutes of screen output !)

Hi, just a comment that you may already know about. When I run into the
same problem (in any software) it normally help to minimize the terminal
window, which will then speed up the printing to standard output with
several orders of magnitude.

Henrik Bengtsson

From chris.jackson at imperial.ac.uk  Fri Oct 10 12:51:15 2003
From: chris.jackson at imperial.ac.uk (Chris Jackson)
Date: Fri Oct 10 12:50:19 2003
Subject: [Rd] Could the Windows installer edit PATH?
Message-ID: <004d01c38f1c$6dcc2ee0$0202a8c0@bumblebee>

I have just diligently upgraded my R installation for Windows XP Pro to
1.8.0.  As an ESS user and R package builder, part of this upgrade process
for me always involves editing the PATH environment variable by hand to
update the location of the R bin directory.

Would it be possible or desirable for the R for Windows
installer/uninstaller to optionally edit the PATH itself? (as, for example,
the Activestate Perl installer has an option to update the PATH with the
Perl bin directory).

Chris
-- 
Christopher Jackson <chris.jackson@imperial.ac.uk>, Research Associate,
Department of Epidemiology and Public Health, Imperial College
School of Medicine, Norfolk Place, London W2 1PG, tel. 020 759 43371

From ligges at statistik.uni-dortmund.de  Fri Oct 10 13:14:52 2003
From: ligges at statistik.uni-dortmund.de (Uwe Ligges)
Date: Fri Oct 10 13:12:52 2003
Subject: [Rd] R 1.8.0 Windows-source compilation-internet.Rout.save
In-Reply-To: <18D602BD42B7E24EB810D6454A58DB9004730648@ibfftce505.is.de.dresdnerkb.com>
References: <18D602BD42B7E24EB810D6454A58DB9004730648@ibfftce505.is.de.dresdnerkb.com>
Message-ID: <3F8694AC.7010304@statistik.uni-dortmund.de>

Pfaff, Bernhard wrote:

> Let me firstly thank the R Core Team for their tremendous efforts in
> providing R 1.8.0. My following comment should therefore be understood as an
> "fyi-only".
> 
> I source compiled R 1.8.0 for windows with ATLAS (source compiled, too).
> Everything works fine and R is running flawlessly! However, running "make
> check" stops during processing "internet.R". I checked the
> "internet.Rout.Save" and found the following two temptative "culprits":
> 
> 1)
> 
>>try(zz <- url("http://foo.bar", "r"))
> 
> unable to resolve 'foo.bar'.
> Error in url("http://foo.bar", "r") : unable to open connection
> 
> and further down in the file:
> 
> 2)
> 
>>try(finger("root"))  ## only works if your site provides a finger daemon
> 
> Error in make.socket(host, port) : Socket not established

That does not stop the ckecks. Both errors are expected (therefore the 
try() around the lines!).

Uwe Ligges


> which stopped the "make check". Everything else was exectuted correctly in
> the "internet.R" file. Because R 1.8.0 is running fine and no other
> obstacles occured during compilation (recommended packages and all docs, as
> well) I ignored this error.
> 
> Thks again for your tremendous efforts and provision of this release!
> 
> Bernhard
> 
> 
> 
> Dr. Bernhard Pfaff
> Global Debt Research - Index and Quantitative Strategy
> Dresdner Kleinwort Wasserstein
> Phone:	+49 (0)69 713 12273 
> Mobile: 	na 
> Fax:	+49 (0)69 713 19816
> 
> <http://www.drkwresearch.com>
> Bloomberg: DRKW<GO>
> 
> 
> 
> --------------------------------------------------------------------------------
> The information contained herein is confidential and is intended solely for the
> addressee. Access by any other party is unauthorised without the express 
> written permission of the sender. If you are not the intended recipient, please 
> contact the sender either via the company switchboard on +44 (0)20 7623 8000, or
> via e-mail return. If you have received this e-mail in error or wish to read our
> e-mail disclaimer statement and monitoring policy, please refer to 
> http://www.drkw.com/disc/email/ or contact the sender.
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://www.stat.math.ethz.ch/mailman/listinfo/r-devel

From Bernhard.Pfaff at drkw.com  Fri Oct 10 13:36:27 2003
From: Bernhard.Pfaff at drkw.com (Pfaff, Bernhard)
Date: Fri Oct 10 13:35:44 2003
Subject: [Rd] R 1.8.0 Windows-source compilation-internet.Rout.save
Message-ID: <18D602BD42B7E24EB810D6454A58DB900473064C@ibfftce505.is.de.dresdnerkb.com>


> Pfaff, Bernhard wrote:
> 
> > Let me firstly thank the R Core Team for their tremendous efforts in
> > providing R 1.8.0. My following comment should therefore be 
> understood as an
> > "fyi-only".
> > 
> > I source compiled R 1.8.0 for windows with ATLAS (source 
> compiled, too).
> > Everything works fine and R is running flawlessly! However, 
> running "make
> > check" stops during processing "internet.R". I checked the
> > "internet.Rout.Save" and found the following two temptative 
> "culprits":
> > 
> > 1)
> > 
> >>try(zz <- url("http://foo.bar", "r"))
> > 
> > unable to resolve 'foo.bar'.
> > Error in url("http://foo.bar", "r") : unable to open connection
> > 
> > and further down in the file:
> > 
> > 2)
> > 
> >>try(finger("root"))  ## only works if your site provides a 
> finger daemon
> > 
> > Error in make.socket(host, port) : Socket not established
> 
> That does not stop the ckecks. Both errors are expected 
> (therefore the 
> try() around the lines!).
> 
> Uwe Ligges
> 
Hello Uwe,

thks for your quick response. That is what I thought, too. I investigated
the "internet.Rout.fail":

.
.
.
> ## check graceful failure:
> try(zz <- url("http://foo.bar", "r"))
Error in url("http://foo.bar", "r") : unable to open connection
In addition: Warning message: 
cannot open: HTTP status was `500 Can't resolve DNS name' 
> 

the last two lines do differ from "internet.Rout.save"
.
.
.
and your are right about 2). It seems that the culprit rather is:

> read.table("ftp://ftp.stats.ox.ac.uk/pub/datasets/csb/ch11b.dat")
Error in file(file, "r") : unable to open connection
Execution halted

but, that's not an issue for R, rather an issue about Win NT setup, I guess.

Thks, again
Bernhard


> 
> > which stopped the "make check". Everything else was 
> exectuted correctly in
> > the "internet.R" file. Because R 1.8.0 is running fine and no other
> > obstacles occured during compilation (recommended packages 
> and all docs, as
> > well) I ignored this error.
> > 
> > Thks again for your tremendous efforts and provision of 
> this release!
> > 
> > Bernhard
> > 
> > 
> > 
> > Dr. Bernhard Pfaff
> > Global Debt Research - Index and Quantitative Strategy
> > Dresdner Kleinwort Wasserstein
> > Phone:	+49 (0)69 713 12273 
> > Mobile: 	na 
> > Fax:	+49 (0)69 713 19816
> > 
> > <http://www.drkwresearch.com>
> > Bloomberg: DRKW<GO>
> > 
> > 
> > 
> > 
> --------------------------------------------------------------
> ------------------
> > The information contained herein is confidential and is 
> intended solely for the
> > addressee. Access by any other party is unauthorised 
> without the express 
> > written permission of the sender. If you are not the 
> intended recipient, please 
> > contact the sender either via the company switchboard on 
> +44 (0)20 7623 8000, or
> > via e-mail return. If you have received this e-mail in 
> error or wish to read our
> > e-mail disclaimer statement and monitoring policy, please refer to 
> > http://www.drkw.com/disc/email/ or contact the sender.
> > 
> > ______________________________________________
> > R-devel@stat.math.ethz.ch mailing list
> > https://www.stat.math.ethz.ch/mailman/listinfo/r-devel
> 
> 


--------------------------------------------------------------------------------
The information contained herein is confidential and is intended solely for the
addressee. Access by any other party is unauthorised without the express
written permission of the sender. If you are not the intended recipient, please
contact the sender either via the company switchboard on +44 (0)20 7623 8000, or
via e-mail return. If you have received this e-mail in error or wish to read our
e-mail disclaimer statement and monitoring policy, please refer to 
http://www.drkw.com/disc/email/ or contact the sender.

From John.Marsland at CommerzbankIB.com  Fri Oct 10 13:51:48 2003
From: John.Marsland at CommerzbankIB.com (Marsland, John)
Date: Fri Oct 10 13:51:08 2003
Subject: [Rd] R1.8.0 : seq.POSIXt() problems
Message-ID: <8CBAA121CEB4D5118CB200508BB2BBEF0317E9DB@xmx8lonib.lonib.commerzbank.com>

I'm having problems with seq.POSIXt() under R 1.8.0 (Windows NT4).

Essentially the last date in my sequence is lost depending on whether the
sequence spans a daylight saving time change. 

This seems to apply regardless as to whether one uses by="DSTdays" or
by="days".

Try the following lines of code:

> seq.POSIXt(as.POSIXct("2003-09-01"),as.POSIXct("2003-10-09"),"DSTdays")
[1] "2003-09-01 GMT Daylight Time" "2003-09-02 GMT Daylight Time"
...
[39] "2003-10-09 GMT Daylight Time"

> seq.POSIXt(as.POSIXct("2003-03-01"),as.POSIXct("2003-10-09"),"DSTdays")
[1] "2003-03-01 GMT Standard Time" "2003-03-02 GMT Standard Time"
...
[221] "2003-10-07 GMT Daylight Time" "2003-10-08 GMT Daylight Time"

> seq.POSIXt(as.POSIXct("2002-10-01"),as.POSIXct("2003-10-09"),"DSTdays")
[1] "2002-10-01 GMT Daylight Time" "2002-10-02 GMT Daylight Time"
...
[373] "2003-10-08 GMT Daylight Time" "2003-10-09 GMT Daylight Time"

Any thoughts?

Regards,

John

> R.version
         _              
platform i386-pc-mingw32
arch     i386           
os       mingw32        
system   i386, mingw32  
status                  
major    1              
minor    8.0            
year     2003           
month    10             
day      08             
language R   


********************************************************************** 
This is a commercial communication from Commerzbank AG.\ \ T...{{dropped}}

From ripley at stats.ox.ac.uk  Fri Oct 10 14:10:33 2003
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri Oct 10 14:09:36 2003
Subject: [Rd] Could the Windows installer edit PATH?
In-Reply-To: <004d01c38f1c$6dcc2ee0$0202a8c0@bumblebee>
Message-ID: <Pine.LNX.4.44.0310101306300.5365-100000@gannet.stats>

Why do you need to edit PATH?  I never have the rw10xx/bin directory in my 
Desktop PATH.  I do set the PATH in a terminal window when working with R, 
but I do that via the shell startup options (.tcshrc in my case).

It is I believe possible to get the installer to do this, but it may well 
not be allowed: our students are not allowed to set it (denied by a 
Windows profile setting).

On Fri, 10 Oct 2003, Chris Jackson wrote:

> I have just diligently upgraded my R installation for Windows XP Pro to
> 1.8.0.  As an ESS user and R package builder, part of this upgrade process
> for me always involves editing the PATH environment variable by hand to
> update the location of the R bin directory.
> 
> Would it be possible or desirable for the R for Windows
> installer/uninstaller to optionally edit the PATH itself? (as, for example,
> the Activestate Perl installer has an option to update the PATH with the
> Perl bin directory).

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From polzehl at wias-berlin.de  Fri Oct 10 14:25:51 2003
From: polzehl at wias-berlin.de (polzehl@wias-berlin.de)
Date: Fri Oct 10 14:24:57 2003
Subject: [Rd] incorrect behaviour of formals (PR#4508)
Message-ID: <200310101225.h9ACPp0P024371@pubhealth.ku.dk>

Full_Name: Jörg Polzehl
Version: 1.8.0
OS: Windows XP
Submission from: (NULL) (62.141.176.1)


I encountered a problem when playing with the mle library and specifying
negative
starting values for the parameters. 
The reason seems to be an incorrect behaviour of  function formals:

 glike<-function(a=1,b=1,c=1) a
> formals(glike)
$a
[1] 1
$b
[1] 1
$c
[1] 1
> unlist(formals(glike))
a b c 
1 1 1 
>  glike<-function(a=1,b=1,c= -1) a
> formals(glike)
$a
[1] 1
$b
[1] 1
$c
-1
> unlist(formals(glike))
$a
[1] 1
$b
[1] 1
$c
-1


Regards,

Jörg Polzehl

PS: The same happens in version 1.7.1

From polzehl at wias-berlin.de  Fri Oct 10 14:27:27 2003
From: polzehl at wias-berlin.de (polzehl@wias-berlin.de)
Date: Fri Oct 10 14:26:31 2003
Subject: [Rd] incorrect behaviour of formals (PR#4510)
Message-ID: <200310101227.h9ACRR0P024423@pubhealth.ku.dk>

Full_Name: Jörg Polzehl
Version: 1.8.0
OS: Windows XP
Submission from: (NULL) (62.141.176.1)


I encountered a problem when playing with the mle library and specifying
negative
starting values for the parameters. 
The reason seems to be an incorrect behaviour of  function formals:

 glike<-function(a=1,b=1,c=1) a
> formals(glike)
$a
[1] 1
$b
[1] 1
$c
[1] 1
> unlist(formals(glike))
a b c 
1 1 1 
>  glike<-function(a=1,b=1,c= -1) a
> formals(glike)
$a
[1] 1
$b
[1] 1
$c
-1
> unlist(formals(glike))
$a
[1] 1
$b
[1] 1
$c
-1


Regards,

Jörg Polzehl

PS: The same happens in version 1.7.1

From polzehl at wias-berlin.de  Fri Oct 10 14:29:15 2003
From: polzehl at wias-berlin.de (polzehl@wias-berlin.de)
Date: Fri Oct 10 14:28:22 2003
Subject: [Rd] incorrect behaviour of formals (PR#4511)
Message-ID: <200310101229.h9ACTF0P024485@pubhealth.ku.dk>

Full_Name: Jörg Polzehl
Version: 1.8.0
OS: Windows XP
Submission from: (NULL) (62.141.176.1)


I encountered a problem when playing with the mle library and specifying
negative
starting values for the parameters. 
The reason seems to be an incorrect behaviour of  function formals:

 glike<-function(a=1,b=1,c=1) a
> formals(glike)
$a
[1] 1
$b
[1] 1
$c
[1] 1
> unlist(formals(glike))
a b c 
1 1 1 
>  glike<-function(a=1,b=1,c= -1) a
> formals(glike)
$a
[1] 1
$b
[1] 1
$c
-1
> unlist(formals(glike))
$a
[1] 1
$b
[1] 1
$c
-1


Regards,

Jörg Polzehl

PS: The same happens in version 1.7.1

From rpeng at jhsph.edu  Fri Oct 10 14:29:31 2003
From: rpeng at jhsph.edu (Roger D. Peng)
Date: Fri Oct 10 14:30:49 2003
Subject: [Rd] 1.8.0 on Unix: interrupting huge print()s  ??
In-Reply-To: <16262.35155.835148.704877@gargle.gargle.HOWL>
References: <16262.35155.835148.704877@gargle.gargle.HOWL>
Message-ID: <3F86A62B.5020801@jhsph.edu>

I've noticed this too (on Linux) and just considered it the price of 
doing business.  More than once I've hit Ctrl-Z and killed the process.  
Not exactly a solution, though :)

-roger

Martin Maechler wrote:

>NEWS for R 1.8.0 has
>
>  
>
>>> USER-VISIBLE CHANGES
>>>
>>>     <......>
>>>
>>>     o	On Unix-like systems interrupt signals now set a flag that is
>>>	 checked periodically rather than calling longjmp from the
>>>	 signal handler.	 This is analogous to the behavior on Windows.
>>>	 This reduces responsiveness to interrupts but prevents bugs
>>>	 caused by interrupting computations in a way that leaves the
>>>	 system in an inconsistent state.  It also reduces the number
>>>	 of system calls, which can speed up computations on some
>>>	 platforms and make R more usable with systems like Mosix.
>>>      
>>>
>
>and this has already caused grief here
>(actually it has several days ago, when I switched our users to
> R-1.8.0beta  __ BUT THEY DIDN'T TELL ANY R DEVELOPER __ )
>
>for a user who does use *large* matrices.
>
>When accidentally calling print() {implicitly}, we have been
>used here to press CTRL+c (twice in Emacs ESS!) for stopping the
>output.
>
>This no longer works in R 1.8.0 at least on our unix platforms.
>To reproduce, type
>
>  cbind(1:1e6)
>
>and try to cut it short (it only takes a minute or so,
>whereas our user here had a matrix that needed more than 10
>minutes of screen output !)
>
>______________________________________________
>R-devel@stat.math.ethz.ch mailing list
>https://www.stat.math.ethz.ch/mailman/listinfo/r-devel
>
>  
>

From maechler at stat.math.ethz.ch  Fri Oct 10 14:35:42 2003
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Fri Oct 10 14:34:52 2003
Subject: [Rd] An artifact of base being namespace
In-Reply-To: <FC2BADAC-FA6E-11D7-92F4-0003931A3C9E@stat.wisc.edu>
References: <FC2BADAC-FA6E-11D7-92F4-0003931A3C9E@stat.wisc.edu>
Message-ID: <16262.42910.138312.205452@gargle.gargle.HOWL>

>>>>> "Saikat" == Saikat DebRoy <saikat@stat.wisc.edu>
>>>>>     on Thu, 9 Oct 2003 11:41:01 -0400 writes:

    Saikat> Function in the base library of R 1.8.0 seems to use
    Saikat> a search path with base coming before the local
    Saikat> environment. I think this is intentional and is
    Saikat> related to base being a namespace.

yes (intended and because base is a namespace).

     > log <- function(x, base) 200
     > log(1)
    [1] 200
     > log10
    function (x)
    log(x, 10)
    <environment: namespace:base>
     > log10(1)
    [1] 0
     >

    Saikat> This is most problematic when you are creating a
    Saikat> generic for an existing function in base (as you
    Saikat> very well could for log). This often makes the
    Saikat> ability to make new generics out of existing
    Saikat> functions somewhat useless.

Assuming you're right, I'm much less sure that this consequence
has been intended in all situations.  But I'd need to see
concrete examples to understand your last sentence.

Martin

From chris.jackson at imperial.ac.uk  Fri Oct 10 14:38:09 2003
From: chris.jackson at imperial.ac.uk (Chris Jackson)
Date: Fri Oct 10 14:37:08 2003
Subject: [Rd] Could the Windows installer edit PATH?
References: <Pine.LNX.4.44.0310101306300.5365-100000@gannet.stats>
Message-ID: <00ce01c38f2b$5c8854b0$0202a8c0@bumblebee>

Prof Brian Ripley <ripley@stats.ox.ac.uk> wrote:
> Why do you need to edit PATH?  I never have the rw10xx/bin directory
> in my Desktop PATH.  I do set the PATH in a terminal window when
> working with R, but I do that via the shell startup options (.tcshrc
> in my case).

Emacs needs to know the location of Rterm.exe to run ESS.  I had also been
checking, building and installing packages from the standard Windows command
shell.  Using a decent shell instead as you suggest would indeed be a nicer
way of working.

> It is I believe possible to get the installer to do this, but it may
> well not be allowed: our students are not allowed to set it (denied
> by a
> Windows profile setting).

Fair enough.

Chris
-- 
Christopher Jackson <chris.jackson@imperial.ac.uk>, Research Associate,
Department of Epidemiology and Public Health, Imperial College
School of Medicine, Norfolk Place, London W2 1PG, tel. 020 759 43371

From luke at stat.uiowa.edu  Fri Oct 10 15:14:32 2003
From: luke at stat.uiowa.edu (Luke Tierney)
Date: Fri Oct 10 15:13:42 2003
Subject: [Rd] incorrect behaviour of formals (PR#4511)
In-Reply-To: <200310101229.h9ACTF0P024485@pubhealth.ku.dk>
Message-ID: <Pine.LNX.4.44.0310100743490.15282-100000@itasca2.stat.uiowa.edu>

On Fri, 10 Oct 2003 polzehl@wias-berlin.de wrote:

> Full_Name: J?rg Polzehl
> Version: 1.8.0
> OS: Windows XP
> Submission from: (NULL) (62.141.176.1)
> 
> 
> I encountered a problem when playing with the mle library and specifying
> negative
> starting values for the parameters. 
> The reason seems to be an incorrect behaviour of  function formals:
> 
>  glike<-function(a=1,b=1,c=1) a
> > formals(glike)
> $a
> [1] 1
> $b
> [1] 1
> $c
> [1] 1
> > unlist(formals(glike))
> a b c 
> 1 1 1 
> >  glike<-function(a=1,b=1,c= -1) a
> > formals(glike)
> $a
> [1] 1
> $b
> [1] 1
> $c
> -1
> > unlist(formals(glike))
> $a
> [1] 1
> $b
> [1] 1
> $c
> -1

formals is doing what it is supposed to do, returning the formal
argument list of the function specified.  The problem is using unlist,
which:

	Given a list structure 'x', 'unlist' simplifies it to produce a
	vector which contains all the atomic components which occur in
	'x'.

If all default argument expressions are atomic components of the same
mode then unlist can simplify. For

	> formals(function(x=g(2)) x)
	$x
	g(2)
	> unlist(formals(function(x=g(2)) x))
	$x
	g(2)

unlist cannot simplify, so it returns the original generic vector.
For your example the first two default argument expressions are
numeric values,

	> mode(formals(function(a=1,b=1,c= -1) a)$a)
	[1] "numeric"
	> mode(formals(function(a=1,b=1,c= -1) a)$b)
	[1] "numeric"

but the third is not:

	> mode(formals(function(a=1,b=1,c= -1) a)$c)
	[1] "call"
	> as.list(formals(function(a=1,b=1,c= -1) a)$c)
	[[1]]
	`-`
	
	[[2]]
	[1] 1

The entries in formals are the default argument expressions as
produced by the parser. Positive numbers are parsed to numeric
constants, but the expression -1 is parsed to a call of the unary
minus function applied to the positive value 1.

Bottom line: both formals and unlist are working as documented; code
that uses unlist(formals(...)) ans expects the result to be a numeric
vector needs to be changed.

Best,

luke

-- 
Luke Tierney
University of Iowa                  Phone:             319-335-3386
Department of Statistics and        Fax:               319-335-3017
   Actuarial Science
241 Schaeffer Hall                  email:      luke@stat.uiowa.edu
Iowa City, IA 52242                 WWW:  http://www.stat.uiowa.edu

From tlumley at u.washington.edu  Fri Oct 10 15:53:55 2003
From: tlumley at u.washington.edu (Thomas Lumley)
Date: Fri Oct 10 15:53:07 2003
Subject: [Rd] Could the Windows installer edit PATH?
In-Reply-To: <00ce01c38f2b$5c8854b0$0202a8c0@bumblebee>
References: <Pine.LNX.4.44.0310101306300.5365-100000@gannet.stats>
	<00ce01c38f2b$5c8854b0$0202a8c0@bumblebee>
Message-ID: <Pine.A41.4.58.0310100652400.126950@homer10.u.washington.edu>

On Fri, 10 Oct 2003, Chris Jackson wrote:

> Prof Brian Ripley <ripley@stats.ox.ac.uk> wrote:
> > Why do you need to edit PATH?  I never have the rw10xx/bin directory
> > in my Desktop PATH.  I do set the PATH in a terminal window when
> > working with R, but I do that via the shell startup options (.tcshrc
> > in my case).
>
> Emacs needs to know the location of Rterm.exe to run ESS.

Yes, but it can be told.
  (setq inferior-R-program-name "/path/to/R/bin/Rterm")
in a .emacs file

	-thomas

From edd at debian.org  Fri Oct 10 16:00:47 2003
From: edd at debian.org (Dirk Eddelbuettel)
Date: Fri Oct 10 15:59:54 2003
Subject: [Rd] Could the Windows installer edit PATH?
In-Reply-To: <Pine.A41.4.58.0310100652400.126950@homer10.u.washington.edu>
References: <Pine.LNX.4.44.0310101306300.5365-100000@gannet.stats>
	<00ce01c38f2b$5c8854b0$0202a8c0@bumblebee>
	<Pine.A41.4.58.0310100652400.126950@homer10.u.washington.edu>
Message-ID: <20031010140047.GA30675@sonny.eddelbuettel.com>

On Fri, Oct 10, 2003 at 06:53:55AM -0700, Thomas Lumley wrote:
> On Fri, 10 Oct 2003, Chris Jackson wrote:
> 
> > Prof Brian Ripley <ripley@stats.ox.ac.uk> wrote:
> > > Why do you need to edit PATH?  I never have the rw10xx/bin directory
> > > in my Desktop PATH.  I do set the PATH in a terminal window when
> > > working with R, but I do that via the shell startup options (.tcshrc
> > > in my case).
> >
> > Emacs needs to know the location of Rterm.exe to run ESS.
> 
> Yes, but it can be told.
>   (setq inferior-R-program-name "/path/to/R/bin/Rterm")
> in a .emacs file

Yes, and Chris point is that (parts of) /path/to/R/bin/Rterm change with
every release, requiring a change.

I sort-of solved for Cygwin and Xemacs/Cygwin that by soft-linking from
/usr/local/bin/, but I'd still prefer if R could install into a constant
directory (as an option, say).

Dirk

-- 
Those are my principles, and if you don't like them... well, I have others.
                                                -- Groucho Marx

From saikat at stat.wisc.edu  Fri Oct 10 18:00:51 2003
From: saikat at stat.wisc.edu (Saikat DebRoy)
Date: Fri Oct 10 17:59:04 2003
Subject: [Rd] An artifact of base being namespace
In-Reply-To: <16262.42910.138312.205452@gargle.gargle.HOWL>
Message-ID: <EBCCB760-FB3A-11D7-92F4-0003931A3C9E@stat.wisc.edu>

On Friday, Oct 10, 2003, at 08:35 US/Eastern, Martin Maechler wrote:

>>>>>> "Saikat" == Saikat DebRoy <saikat@stat.wisc.edu>
>>>>>>     on Thu, 9 Oct 2003 11:41:01 -0400 writes:
>
>     Saikat> This is most problematic when you are creating a
>     Saikat> generic for an existing function in base (as you
>     Saikat> very well could for log). This often makes the
>     Saikat> ability to make new generics out of existing
>     Saikat> functions somewhat useless.
>
> Assuming you're right, I'm much less sure that this consequence
> has been intended in all situations.  But I'd need to see
> concrete examples to understand your last sentence.
>

Here is an example of what I was saying.

 > setClass('foo', representation(x='numeric'))
[1] "foo"
 > setMethod('log', signature(x='foo', base="missing"),
+  function(x, base) callGeneric(x@x))
[1] "log"
 > setMethod('log', 'foo', function(x, base)
+  callGeneric(x@x, base))
[1] "log"
 > log(new('foo', x=100))
[1] 4.60517
 > log10(new('foo', x=100))
Error in log(x, base) : Non-numeric argument to mathematical function
 >

This means that if I create a generic for 'log', I should also create a 
generic for each function in base that makes a call to 'log'. That is 
not what I expected.

From saikat at stat.wisc.edu  Wed Oct  8 17:07:45 2003
From: saikat at stat.wisc.edu (Saikat DebRoy)
Date: Fri Oct 10 18:11:15 2003
Subject: [Rd] number of arguments in .Call function registration
Message-ID: <A4AF7CEC-FB3C-11D7-92F4-0003931A3C9E@stat.wisc.edu>

I initially sent this to the biocore mailing list - but it was 
suggested that r-devel would also find it interesting.

Many of us use a macro like

#define CALL_DEF(fname, nargs) { #fname, (DL_FUNC)&fname, nargs}

for use in function registration for use with .Call.

For example, using the example from R Extension manual,
if we want to register a C function myCall with three arguments, we 
will use

R_CallMethodDef callMethods[]  = {
   CALL_DEF(myCall, 3),
   {NULL, NULL, 0}
};

instead of using

R_CallMethodDef callMethods[]  = {
   {"myCall",  (DL_FUNC)&myCall, 3},
   {NULL, NULL, 0}
};

However, there is no way for the compiler to make sure that myCall is 
really a function taking three SEXP's and returning a SEXP. I have been 
using an alternate definition of the CALL_DEF macro which can do that.
I have only tested this on gcc but it may work with other compilers.
Here is the relevant snippet from my header file.

#if defined __GNUC__ && __GNUC__ >= 2
/*
  * These macros may work with other compilers. However, they are
  * just for compile time error checking for wrong .Call and
  * .External function registration and so, need not be used except
  * with gcc (which is used by the developers).
  */
#define TEST_CALL_DEF
#endif

#ifdef TEST_CALL_DEF

#define PREPROC_NULL_ARGS(fname, n) (fname)(PREPROC_SEQ_ARGS(n, 
R_NilValue))

#define PREPROC_SEQ_ARGS(n, v) PREPROC_SEQ_ ## n (v)

#define PREPROC_SEQ_0(v) /* nothing */
#define PREPROC_SEQ_1(v) (v)
#define PREPROC_SEQ_2(v) (v), (v)
#define PREPROC_SEQ_3(v) (v), (v), (v)
#define PREPROC_SEQ_4(v) PREPROC_SEQ_2(v), PREPROC_SEQ_2(v)
#define PREPROC_SEQ_5(v) PREPROC_SEQ_3(v), PREPROC_SEQ_2(v)
#define PREPROC_SEQ_6(v) PREPROC_SEQ_3(v), PREPROC_SEQ_3(v)
#define PREPROC_SEQ_7(v) PREPROC_SEQ_4(v), PREPROC_SEQ_3(v)
#define PREPROC_SEQ_8(v) PREPROC_SEQ_4(v), PREPROC_SEQ_4(v)
#define PREPROC_SEQ_9(v) PREPROC_SEQ_5(v), PREPROC_SEQ_4(v)
#define PREPROC_SEQ_10(v) PREPROC_SEQ_5(v), PREPROC_SEQ_5(v)
#define PREPROC_SEQ_11(v) PREPROC_SEQ_6(v), PREPROC_SEQ_5(v)
#define PREPROC_SEQ_12(v) PREPROC_SEQ_6(v), PREPROC_SEQ_6(v)
#define PREPROC_SEQ_13(v) PREPROC_SEQ_7(v), PREPROC_SEQ_6(v)
#define PREPROC_SEQ_14(v) PREPROC_SEQ_7(v), PREPROC_SEQ_7(v)
#define PREPROC_SEQ_15(v) PREPROC_SEQ_8(v), PREPROC_SEQ_7(v)
#define PREPROC_SEQ_16(v) PREPROC_SEQ_8(v), PREPROC_SEQ_8(v)
#define PREPROC_SEQ_17(v) PREPROC_SEQ_9(v), PREPROC_SEQ_8(v)
#define PREPROC_SEQ_18(v) PREPROC_SEQ_9(v), PREPROC_SEQ_9(v)
#define PREPROC_SEQ_19(v) PREPROC_SEQ_10(v), PREPROC_SEQ_9(v)
#define PREPROC_SEQ_20(v) PREPROC_SEQ_10(v), PREPROC_SEQ_10(v)
#define PREPROC_SEQ_21(v) PREPROC_SEQ_11(v), PREPROC_SEQ_10(v)
#define PREPROC_SEQ_22(v) PREPROC_SEQ_11(v), PREPROC_SEQ_11(v)
#define PREPROC_SEQ_23(v) PREPROC_SEQ_12(v), PREPROC_SEQ_11(v)
#define PREPROC_SEQ_24(v) PREPROC_SEQ_12(v), PREPROC_SEQ_12(v)
#define PREPROC_SEQ_25(v) PREPROC_SEQ_13(v), PREPROC_SEQ_12(v)
#define PREPROC_SEQ_26(v) PREPROC_SEQ_13(v), PREPROC_SEQ_13(v)
#define PREPROC_SEQ_27(v) PREPROC_SEQ_14(v), PREPROC_SEQ_13(v)
#define PREPROC_SEQ_28(v) PREPROC_SEQ_14(v), PREPROC_SEQ_14(v)
#define PREPROC_SEQ_29(v) PREPROC_SEQ_15(v), PREPROC_SEQ_14(v)
#define PREPROC_SEQ_30(v) PREPROC_SEQ_15(v), PREPROC_SEQ_15(v)
#define PREPROC_SEQ_31(v) PREPROC_SEQ_16(v), PREPROC_SEQ_15(v)
#define PREPROC_SEQ_32(v) PREPROC_SEQ_16(v), PREPROC_SEQ_16(v)
#define PREPROC_SEQ_33(v) PREPROC_SEQ_17(v), PREPROC_SEQ_16(v)
#define PREPROC_SEQ_34(v) PREPROC_SEQ_17(v), PREPROC_SEQ_17(v)
#define PREPROC_SEQ_35(v) PREPROC_SEQ_18(v), PREPROC_SEQ_17(v)
#define PREPROC_SEQ_36(v) PREPROC_SEQ_18(v), PREPROC_SEQ_18(v)
#define PREPROC_SEQ_37(v) PREPROC_SEQ_19(v), PREPROC_SEQ_18(v)
#define PREPROC_SEQ_38(v) PREPROC_SEQ_19(v), PREPROC_SEQ_19(v)
#define PREPROC_SEQ_39(v) PREPROC_SEQ_20(v), PREPROC_SEQ_19(v)
#define PREPROC_SEQ_40(v) PREPROC_SEQ_20(v), PREPROC_SEQ_20(v)
#define PREPROC_SEQ_41(v) PREPROC_SEQ_21(v), PREPROC_SEQ_20(v)
#define PREPROC_SEQ_42(v) PREPROC_SEQ_21(v), PREPROC_SEQ_21(v)
#define PREPROC_SEQ_43(v) PREPROC_SEQ_22(v), PREPROC_SEQ_21(v)
#define PREPROC_SEQ_44(v) PREPROC_SEQ_22(v), PREPROC_SEQ_22(v)
#define PREPROC_SEQ_45(v) PREPROC_SEQ_23(v), PREPROC_SEQ_22(v)
#define PREPROC_SEQ_46(v) PREPROC_SEQ_23(v), PREPROC_SEQ_23(v)
#define PREPROC_SEQ_47(v) PREPROC_SEQ_24(v), PREPROC_SEQ_23(v)
#define PREPROC_SEQ_48(v) PREPROC_SEQ_24(v), PREPROC_SEQ_24(v)
#define PREPROC_SEQ_49(v) PREPROC_SEQ_25(v), PREPROC_SEQ_24(v)
#define PREPROC_SEQ_50(v) PREPROC_SEQ_25(v), PREPROC_SEQ_25(v)
#define PREPROC_SEQ_51(v) PREPROC_SEQ_26(v), PREPROC_SEQ_25(v)
#define PREPROC_SEQ_52(v) PREPROC_SEQ_26(v), PREPROC_SEQ_26(v)
#define PREPROC_SEQ_53(v) PREPROC_SEQ_27(v), PREPROC_SEQ_26(v)
#define PREPROC_SEQ_54(v) PREPROC_SEQ_27(v), PREPROC_SEQ_27(v)
#define PREPROC_SEQ_55(v) PREPROC_SEQ_28(v), PREPROC_SEQ_27(v)
#define PREPROC_SEQ_56(v) PREPROC_SEQ_28(v), PREPROC_SEQ_28(v)
#define PREPROC_SEQ_57(v) PREPROC_SEQ_29(v), PREPROC_SEQ_28(v)
#define PREPROC_SEQ_58(v) PREPROC_SEQ_29(v), PREPROC_SEQ_29(v)
#define PREPROC_SEQ_59(v) PREPROC_SEQ_30(v), PREPROC_SEQ_29(v)
#define PREPROC_SEQ_60(v) PREPROC_SEQ_30(v), PREPROC_SEQ_30(v)
#define PREPROC_SEQ_61(v) PREPROC_SEQ_31(v), PREPROC_SEQ_30(v)
#define PREPROC_SEQ_62(v) PREPROC_SEQ_31(v), PREPROC_SEQ_31(v)
#define PREPROC_SEQ_63(v) PREPROC_SEQ_32(v), PREPROC_SEQ_31(v)
#define PREPROC_SEQ_64(v) PREPROC_SEQ_32(v), PREPROC_SEQ_32(v)
#define PREPROC_SEQ_65(v) PREPROC_SEQ_33(v), PREPROC_SEQ_32(v)


/*
  * Create the .Call registration definition and do a compile time
  * check to make sure fname is a function taking nargs SEXP's and
  * returning a SEXP as value. If there is a type mismatch, gcc will
  * produce a warning. If the number of arguments do not match, gcc
  * will produce an error.
  *
  * This only works if nargs is an integer >= 0 and <= 65. Currently
  * these are the only valid nargs values for R .Call functions.
  *
  * This depends on sizeof() returning a compile time constant without
  * evaluating its argument.
  *
  */
#define CALL_DEF(fname, nargs) \
     { #fname, (DL_FUNC)&(fname), \
       nargs+sizeof(TYPEOF(PREPROC_NULL_ARGS(fname, nargs)))- \
       sizeof(TYPEOF(R_NilValue)) }

#endif

#ifndef TEST_CALL_DEF
#define CALL_DEF(fname, nargs) { #fname, (DL_FUNC)&fname, nargs}
#endif

#define EXTERNAL_DEF(fname) CALL_DEF(fname, 1)

From duncan at research.bell-labs.com  Fri Oct 10 18:54:39 2003
From: duncan at research.bell-labs.com (Duncan Temple Lang)
Date: Fri Oct 10 18:54:04 2003
Subject: [Rd] number of arguments in .Call function registration
In-Reply-To: <A4AF7CEC-FB3C-11D7-92F4-0003931A3C9E@stat.wisc.edu>;
	from saikat@stat.wisc.edu on Wed, Oct 08, 2003 at 11:07:45AM -0400
References: <A4AF7CEC-FB3C-11D7-92F4-0003931A3C9E@stat.wisc.edu>
Message-ID: <20031010125438.A24137@jessie.research.bell-labs.com>

Hi Saikat.

Nice. The more help we can get from the compiler, the
better. Registration provides the first step, and your macro(s)
provide an additional level. So it is highly desirable to have that if
people are manually creating the registration information.

When we put the registration technique into R, the idea was that
people would not create the info. manually.  Instead, using something
like the Slcc package or the translation table generated from gcc/g++,
one can programmatically prepare this registration data. In that case,
the error handling is not done when the package code is compiled, but
when the package is distributed. 

I have some code to do this using gcc/g++ and Python.  (It is the same
basic mechanism that I am working on to automatically rewrite package
code to support multiple evaluators.)  I have to package it up a
little better and I never know when I will get a chance to do that.

If somebody wants to add your macros to Rdynload.h or somewhere
else, that would be great. I have a very slow connection 
at present, so doing significant checking on different
platforms is prohibitive. 

 D.




 

Saikat DebRoy wrote:
> I initially sent this to the biocore mailing list - but it was 
> suggested that r-devel would also find it interesting.
> 
> Many of us use a macro like
> 
> #define CALL_DEF(fname, nargs) { #fname, (DL_FUNC)&fname, nargs}
> 
> for use in function registration for use with .Call.
> 
> For example, using the example from R Extension manual,
> if we want to register a C function myCall with three arguments, we 
> will use
> 
> R_CallMethodDef callMethods[]  = {
>    CALL_DEF(myCall, 3),
>    {NULL, NULL, 0}
> };
> 
> instead of using
> 
> R_CallMethodDef callMethods[]  = {
>    {"myCall",  (DL_FUNC)&myCall, 3},
>    {NULL, NULL, 0}
> };
> 
> However, there is no way for the compiler to make sure that myCall is 
> really a function taking three SEXP's and returning a SEXP. I have been 
> using an alternate definition of the CALL_DEF macro which can do that.
> I have only tested this on gcc but it may work with other compilers.
> Here is the relevant snippet from my header file.
> 
> #if defined __GNUC__ && __GNUC__ >= 2
> /*
>   * These macros may work with other compilers. However, they are
>   * just for compile time error checking for wrong .Call and
>   * .External function registration and so, need not be used except
>   * with gcc (which is used by the developers).
>   */
> #define TEST_CALL_DEF
> #endif
> 
> #ifdef TEST_CALL_DEF
> 
> #define PREPROC_NULL_ARGS(fname, n) (fname)(PREPROC_SEQ_ARGS(n, 
> R_NilValue))
> 
> #define PREPROC_SEQ_ARGS(n, v) PREPROC_SEQ_ ## n (v)
> 
> #define PREPROC_SEQ_0(v) /* nothing */
> #define PREPROC_SEQ_1(v) (v)
> #define PREPROC_SEQ_2(v) (v), (v)
> #define PREPROC_SEQ_3(v) (v), (v), (v)
> #define PREPROC_SEQ_4(v) PREPROC_SEQ_2(v), PREPROC_SEQ_2(v)
> #define PREPROC_SEQ_5(v) PREPROC_SEQ_3(v), PREPROC_SEQ_2(v)
> #define PREPROC_SEQ_6(v) PREPROC_SEQ_3(v), PREPROC_SEQ_3(v)
> #define PREPROC_SEQ_7(v) PREPROC_SEQ_4(v), PREPROC_SEQ_3(v)
> #define PREPROC_SEQ_8(v) PREPROC_SEQ_4(v), PREPROC_SEQ_4(v)
> #define PREPROC_SEQ_9(v) PREPROC_SEQ_5(v), PREPROC_SEQ_4(v)
> #define PREPROC_SEQ_10(v) PREPROC_SEQ_5(v), PREPROC_SEQ_5(v)
> #define PREPROC_SEQ_11(v) PREPROC_SEQ_6(v), PREPROC_SEQ_5(v)
> #define PREPROC_SEQ_12(v) PREPROC_SEQ_6(v), PREPROC_SEQ_6(v)
> #define PREPROC_SEQ_13(v) PREPROC_SEQ_7(v), PREPROC_SEQ_6(v)
> #define PREPROC_SEQ_14(v) PREPROC_SEQ_7(v), PREPROC_SEQ_7(v)
> #define PREPROC_SEQ_15(v) PREPROC_SEQ_8(v), PREPROC_SEQ_7(v)
> #define PREPROC_SEQ_16(v) PREPROC_SEQ_8(v), PREPROC_SEQ_8(v)
> #define PREPROC_SEQ_17(v) PREPROC_SEQ_9(v), PREPROC_SEQ_8(v)
> #define PREPROC_SEQ_18(v) PREPROC_SEQ_9(v), PREPROC_SEQ_9(v)
> #define PREPROC_SEQ_19(v) PREPROC_SEQ_10(v), PREPROC_SEQ_9(v)
> #define PREPROC_SEQ_20(v) PREPROC_SEQ_10(v), PREPROC_SEQ_10(v)
> #define PREPROC_SEQ_21(v) PREPROC_SEQ_11(v), PREPROC_SEQ_10(v)
> #define PREPROC_SEQ_22(v) PREPROC_SEQ_11(v), PREPROC_SEQ_11(v)
> #define PREPROC_SEQ_23(v) PREPROC_SEQ_12(v), PREPROC_SEQ_11(v)
> #define PREPROC_SEQ_24(v) PREPROC_SEQ_12(v), PREPROC_SEQ_12(v)
> #define PREPROC_SEQ_25(v) PREPROC_SEQ_13(v), PREPROC_SEQ_12(v)
> #define PREPROC_SEQ_26(v) PREPROC_SEQ_13(v), PREPROC_SEQ_13(v)
> #define PREPROC_SEQ_27(v) PREPROC_SEQ_14(v), PREPROC_SEQ_13(v)
> #define PREPROC_SEQ_28(v) PREPROC_SEQ_14(v), PREPROC_SEQ_14(v)
> #define PREPROC_SEQ_29(v) PREPROC_SEQ_15(v), PREPROC_SEQ_14(v)
> #define PREPROC_SEQ_30(v) PREPROC_SEQ_15(v), PREPROC_SEQ_15(v)
> #define PREPROC_SEQ_31(v) PREPROC_SEQ_16(v), PREPROC_SEQ_15(v)
> #define PREPROC_SEQ_32(v) PREPROC_SEQ_16(v), PREPROC_SEQ_16(v)
> #define PREPROC_SEQ_33(v) PREPROC_SEQ_17(v), PREPROC_SEQ_16(v)
> #define PREPROC_SEQ_34(v) PREPROC_SEQ_17(v), PREPROC_SEQ_17(v)
> #define PREPROC_SEQ_35(v) PREPROC_SEQ_18(v), PREPROC_SEQ_17(v)
> #define PREPROC_SEQ_36(v) PREPROC_SEQ_18(v), PREPROC_SEQ_18(v)
> #define PREPROC_SEQ_37(v) PREPROC_SEQ_19(v), PREPROC_SEQ_18(v)
> #define PREPROC_SEQ_38(v) PREPROC_SEQ_19(v), PREPROC_SEQ_19(v)
> #define PREPROC_SEQ_39(v) PREPROC_SEQ_20(v), PREPROC_SEQ_19(v)
> #define PREPROC_SEQ_40(v) PREPROC_SEQ_20(v), PREPROC_SEQ_20(v)
> #define PREPROC_SEQ_41(v) PREPROC_SEQ_21(v), PREPROC_SEQ_20(v)
> #define PREPROC_SEQ_42(v) PREPROC_SEQ_21(v), PREPROC_SEQ_21(v)
> #define PREPROC_SEQ_43(v) PREPROC_SEQ_22(v), PREPROC_SEQ_21(v)
> #define PREPROC_SEQ_44(v) PREPROC_SEQ_22(v), PREPROC_SEQ_22(v)
> #define PREPROC_SEQ_45(v) PREPROC_SEQ_23(v), PREPROC_SEQ_22(v)
> #define PREPROC_SEQ_46(v) PREPROC_SEQ_23(v), PREPROC_SEQ_23(v)
> #define PREPROC_SEQ_47(v) PREPROC_SEQ_24(v), PREPROC_SEQ_23(v)
> #define PREPROC_SEQ_48(v) PREPROC_SEQ_24(v), PREPROC_SEQ_24(v)
> #define PREPROC_SEQ_49(v) PREPROC_SEQ_25(v), PREPROC_SEQ_24(v)
> #define PREPROC_SEQ_50(v) PREPROC_SEQ_25(v), PREPROC_SEQ_25(v)
> #define PREPROC_SEQ_51(v) PREPROC_SEQ_26(v), PREPROC_SEQ_25(v)
> #define PREPROC_SEQ_52(v) PREPROC_SEQ_26(v), PREPROC_SEQ_26(v)
> #define PREPROC_SEQ_53(v) PREPROC_SEQ_27(v), PREPROC_SEQ_26(v)
> #define PREPROC_SEQ_54(v) PREPROC_SEQ_27(v), PREPROC_SEQ_27(v)
> #define PREPROC_SEQ_55(v) PREPROC_SEQ_28(v), PREPROC_SEQ_27(v)
> #define PREPROC_SEQ_56(v) PREPROC_SEQ_28(v), PREPROC_SEQ_28(v)
> #define PREPROC_SEQ_57(v) PREPROC_SEQ_29(v), PREPROC_SEQ_28(v)
> #define PREPROC_SEQ_58(v) PREPROC_SEQ_29(v), PREPROC_SEQ_29(v)
> #define PREPROC_SEQ_59(v) PREPROC_SEQ_30(v), PREPROC_SEQ_29(v)
> #define PREPROC_SEQ_60(v) PREPROC_SEQ_30(v), PREPROC_SEQ_30(v)
> #define PREPROC_SEQ_61(v) PREPROC_SEQ_31(v), PREPROC_SEQ_30(v)
> #define PREPROC_SEQ_62(v) PREPROC_SEQ_31(v), PREPROC_SEQ_31(v)
> #define PREPROC_SEQ_63(v) PREPROC_SEQ_32(v), PREPROC_SEQ_31(v)
> #define PREPROC_SEQ_64(v) PREPROC_SEQ_32(v), PREPROC_SEQ_32(v)
> #define PREPROC_SEQ_65(v) PREPROC_SEQ_33(v), PREPROC_SEQ_32(v)
> 
> 
> /*
>   * Create the .Call registration definition and do a compile time
>   * check to make sure fname is a function taking nargs SEXP's and
>   * returning a SEXP as value. If there is a type mismatch, gcc will
>   * produce a warning. If the number of arguments do not match, gcc
>   * will produce an error.
>   *
>   * This only works if nargs is an integer >= 0 and <= 65. Currently
>   * these are the only valid nargs values for R .Call functions.
>   *
>   * This depends on sizeof() returning a compile time constant without
>   * evaluating its argument.
>   *
>   */
> #define CALL_DEF(fname, nargs) \
>      { #fname, (DL_FUNC)&(fname), \
>        nargs+sizeof(TYPEOF(PREPROC_NULL_ARGS(fname, nargs)))- \
>        sizeof(TYPEOF(R_NilValue)) }
> 
> #endif
> 
> #ifndef TEST_CALL_DEF
> #define CALL_DEF(fname, nargs) { #fname, (DL_FUNC)&fname, nargs}
> #endif
> 
> #define EXTERNAL_DEF(fname) CALL_DEF(fname, 1)
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://www.stat.math.ethz.ch/mailman/listinfo/r-devel

-- 
_______________________________________________________________

Duncan Temple Lang                duncan@research.bell-labs.com
Bell Labs, Lucent Technologies    office: (908)582-3217
700 Mountain Avenue, Room 2C-259  fax:    (908)582-3340
Murray Hill, NJ  07974-2070       
         http://cm.bell-labs.com/stat/duncan

From luke at stat.uiowa.edu  Fri Oct 10 21:58:31 2003
From: luke at stat.uiowa.edu (Luke Tierney)
Date: Fri Oct 10 21:57:41 2003
Subject: [Rd] 1.8.0 on Unix: interrupting huge print()s  ??
In-Reply-To: <16262.35155.835148.704877@gargle.gargle.HOWL>
Message-ID: <Pine.LNX.4.44.0310101452360.484-100000@itasca.stat.uiowa.edu>

Needs a call to R_CheckUserInterrupt at the appropriate place.  The
only platform that currently can interrupt a long print seems to be
Rgui on Windows because of an event poll in the console output
function.  One possibility is to put in a check every 100 calls, say,
to Rvprintf in printutils.c.  I'll check that out and commit to the
patches branch unless anyone sees a problem or a better place to
check.

luke

On Fri, 10 Oct 2003, Martin Maechler wrote:

> NEWS for R 1.8.0 has
> 
> >>  USER-VISIBLE CHANGES
> >> 
> >>      <......>
> >> 
> >>      o	On Unix-like systems interrupt signals now set a flag that is
> >> 	 checked periodically rather than calling longjmp from the
> >> 	 signal handler.	 This is analogous to the behavior on Windows.
> >> 	 This reduces responsiveness to interrupts but prevents bugs
> >> 	 caused by interrupting computations in a way that leaves the
> >> 	 system in an inconsistent state.  It also reduces the number
> >> 	 of system calls, which can speed up computations on some
> >> 	 platforms and make R more usable with systems like Mosix.
> 
> and this has already caused grief here
> (actually it has several days ago, when I switched our users to
>  R-1.8.0beta  __ BUT THEY DIDN'T TELL ANY R DEVELOPER __ )
> 
> for a user who does use *large* matrices.
> 
> When accidentally calling print() {implicitly}, we have been
> used here to press CTRL+c (twice in Emacs ESS!) for stopping the
> output.
> 
> This no longer works in R 1.8.0 at least on our unix platforms.
> To reproduce, type
> 
>   cbind(1:1e6)
> 
> and try to cut it short (it only takes a minute or so,
> whereas our user here had a matrix that needed more than 10
> minutes of screen output !)
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://www.stat.math.ethz.ch/mailman/listinfo/r-devel
> 

-- 
Luke Tierney
University of Iowa                  Phone:             319-335-3386
Department of Statistics and        Fax:               319-335-3017
   Actuarial Science
241 Schaeffer Hall                  email:      luke@stat.uiowa.edu
Iowa City, IA 52242                 WWW:  http://www.stat.uiowa.edu

From dmurdoch at pair.com  Sat Oct 11 01:12:50 2003
From: dmurdoch at pair.com (Duncan Murdoch)
Date: Sat Oct 11 01:20:22 2003
Subject: [Rd] An artifact of base being namespace
In-Reply-To: <16262.42910.138312.205452@gargle.gargle.HOWL>
References: <FC2BADAC-FA6E-11D7-92F4-0003931A3C9E@stat.wisc.edu>
	<16262.42910.138312.205452@gargle.gargle.HOWL>
Message-ID: <uteeov43hd0lg5bjd7k069kdku96oa00t0@4ax.com>

On Fri, 10 Oct 2003 14:35:42 +0200, you wrote:

>    Saikat> This is most problematic when you are creating a
>    Saikat> generic for an existing function in base (as you
>    Saikat> very well could for log). This often makes the
>    Saikat> ability to make new generics out of existing
>    Saikat> functions somewhat useless.
>
>Assuming you're right, I'm much less sure that this consequence
>has been intended in all situations.  But I'd need to see
>concrete examples to understand your last sentence.

I think this depends on whether we want all simple functions to act
like generics, or whether we want a distinction.  Does it ever matter
to a function in base like log10 whether log is a simple function or a
generic?

If so, then the current behaviour is right.  Whoever wrote those
functions back in the mists of time expected log to be a simple
function, so the namespace should guarantee that it stays as one until
explicitly changed within the namespace.

But if the distinction between generics and simple functions is only
for efficiency (dispatching a generic is slower), then I think the
generic should be created in the namespace where the simple function
was originally declared.  Then log10 would call the generic which
would dispatch to the newly created method for Saikat's data.

My feeling is that the latter is what we really want.

Duncan Murdoch

From luke at stat.uiowa.edu  Sat Oct 11 04:01:07 2003
From: luke at stat.uiowa.edu (Luke Tierney)
Date: Sat Oct 11 04:00:23 2003
Subject: [Rd] An artifact of base being namespace
In-Reply-To: <uteeov43hd0lg5bjd7k069kdku96oa00t0@4ax.com>
Message-ID: <Pine.LNX.4.44.0310102038040.20816-100000@itasca2.stat.uiowa.edu>

On Fri, 10 Oct 2003, Duncan Murdoch wrote:

> On Fri, 10 Oct 2003 14:35:42 +0200, you wrote:
> 
> >    Saikat> This is most problematic when you are creating a
> >    Saikat> generic for an existing function in base (as you
> >    Saikat> very well could for log). This often makes the
> >    Saikat> ability to make new generics out of existing
> >    Saikat> functions somewhat useless.
> >
> >Assuming you're right, I'm much less sure that this consequence
> >has been intended in all situations.  But I'd need to see
> >concrete examples to understand your last sentence.
> 
> I think this depends on whether we want all simple functions to act
> like generics, or whether we want a distinction.  Does it ever matter
> to a function in base like log10 whether log is a simple function or a
> generic?
> 
> If so, then the current behaviour is right.  Whoever wrote those
> functions back in the mists of time expected log to be a simple
> function, so the namespace should guarantee that it stays as one until
> explicitly changed within the namespace.
> 
> But if the distinction between generics and simple functions is only
> for efficiency (dispatching a generic is slower), then I think the
> generic should be created in the namespace where the simple function
> was originally declared.  Then log10 would call the generic which
> would dispatch to the newly created method for Saikat's data.
> 
> My feeling is that the latter is what we really want.

There are significant subtleties.  On the surface having all functions
be generics would make things simpler.

On the other hand, having lazy evaluation makes other things simpler:
there is no need for special operators, macros or other such stuff;
everything can be done with ordinary functions.  if, for, try,
on.exit, switch are just functions. Some of them happen to be
implemented internally for efficiency, but this isn't essential.

Unfortunately, you can't dispatch on the type of an argument value
without computing the argument value, so lazy evaluation of an
argument and dispatching on that argument are not compatible.

There are other arguments why making every function generic may not be
a good idea and why languages like dylan with a similar concept of
generic functions to the S4 style have not gone down that route.  log
and log10 provide one illustration: With the current definitions there
is a simple relationship between log10, the two argument log and the
single argument log.  Making the single argument log generic may well
make sense, but making the two argument version or log10 generic might
lead to a situation where the basic relation log10(x) == log(x,10) ==
log(x)/log(10) is no longer true and code that depends on that
relationship will fail.

But it would be a good idea, once the design of methods stabilizes a
bit more, to review functions in base and other packages to decide
which ones ought to be generic.

Best,

luke

-- 
Luke Tierney
University of Iowa                  Phone:             319-335-3386
Department of Statistics and        Fax:               319-335-3017
   Actuarial Science
241 Schaeffer Hall                  email:      luke@stat.uiowa.edu
Iowa City, IA 52242                 WWW:  http://www.stat.uiowa.edu

From dmurdoch at pair.com  Sat Oct 11 05:02:55 2003
From: dmurdoch at pair.com (Duncan Murdoch)
Date: Sat Oct 11 05:02:47 2003
Subject: [Rd] An artifact of base being namespace
In-Reply-To: <Pine.LNX.4.44.0310102038040.20816-100000@itasca2.stat.uiowa.edu>
References: <uteeov43hd0lg5bjd7k069kdku96oa00t0@4ax.com>
	<Pine.LNX.4.44.0310102038040.20816-100000@itasca2.stat.uiowa.edu>
Message-ID: <lmreov0m6tip41d0h9thbpb2r0qug6fgq5@4ax.com>

On Fri, 10 Oct 2003 21:01:07 -0500 (CDT), you wrote:
>On the other hand, having lazy evaluation makes other things simpler:
>there is no need for special operators, macros or other such stuff;
>everything can be done with ordinary functions.  if, for, try,
>on.exit, switch are just functions. Some of them happen to be
>implemented internally for efficiency, but this isn't essential.

I can think of two uses for lazy evaluation: what you say above, where
parameters are given but never evaluated, and cases where default
values are computed using variables that don't exist at the time of
the function call.  Are there others?

The first use is incompatible with generics, but I don't think the
second is, and I'd guess that the second use is the most common one.
So not all functions could be generics, but maybe most of them could
be?  Maybe we should register functions as not being compatible with
being a generic, but let everything else act like one by default?

>But it would be a good idea, once the design of methods stabilizes a
>bit more, to review functions in base and other packages to decide
>which ones ought to be generic.

That sounds like a good idea, but is "once the design stabilizes a bit
more" a stopping time? :-)

Duncan Murdoch

From deleeuw at stat.ucla.edu  Sat Oct 11 07:57:56 2003
From: deleeuw at stat.ucla.edu (Jan de Leeuw)
Date: Sat Oct 11 07:57:12 2003
Subject: [Rd] IBM compilers on OS X
Message-ID: <DC3EFE21-FBAF-11D7-BF40-000A95A67E82@stat.ucla.edu>

Although I still have to look into the various flags, the IBM vacpp
(C and C++) and xlf (FORTRAN) compilers can be used to build
at least R.bin. Of course libR.dylib and the various bundles are
more complicated, but R.bin runs (in as far as it does not depend
on any modules and packages).

This is important, because people report speed increases of
100-200% compared to gcc/g77.
===
Jan de Leeuw; Professor and Chair, UCLA Department of Statistics;
Editor: Journal of Multivariate Analysis, Journal of Statistical  
Software
US mail: 8130 Math Sciences Bldg, Box 951554, Los Angeles, CA 90095-1554
phone (310)-825-9550;  fax (310)-206-5658;  email: deleeuw@stat.ucla.edu
homepage: http://gifi.stat.ucla.edu
   
------------------------------------------------------------------------ 
-------------------------
           No matter where you go, there you are. --- Buckaroo Banzai
                    http://gifi.stat.ucla.edu/sounds/nomatter.au

From feferraz at linux.ime.usp.br  Sat Oct 11 08:20:48 2003
From: feferraz at linux.ime.usp.br (feferraz@linux.ime.usp.br)
Date: Sat Oct 11 08:20:07 2003
Subject: [Rd] Problem in 'methods' package (PR#4525)
Message-ID: <200310110620.h9B6Km0P006241@pubhealth.ku.dk>

Full_Name: Fernando Henrique Ferraz Pereira da Rosa
Version: 1.8.0
OS: Linux 2.4.21
Submission from: (NULL) (200.206.211.169)


     After installing R 1.8.0, the R DBI interface stopped working. I tracked it
down as a problem in the 'methods' package, that comes in the default
installation.
     Somehow the function '.valueClassTest' which is defined on package
'methods', is not being defined.
     To ilustrate how this breaks DBI, try this in a 1.8.0 R install (with DBI
installed):

      > library(DBI)
      > con <- dbConnect(dbDriver("MySQL"), dbname = "test")
Error in dbConnect(dbDriver("MySQL"), dbname = "test") : 
        couldn't find function ".valueClassTest"

      A dirty fix would be defining it by hand (from
src/library/methods/R/RMethodUtils.R) : 

   .valueClassTest <- function(object, classes, fname) {
        (...)
    }

       (Which works), but ideally it'd be nice determning why the function is
not being defined on the first place.

From ligges at statistik.uni-dortmund.de  Sat Oct 11 11:42:19 2003
From: ligges at statistik.uni-dortmund.de (ligges@statistik.uni-dortmund.de)
Date: Sat Oct 11 11:41:25 2003
Subject: [Rd] Problem in 'methods' package (PR#4525)
Message-ID: <200310110942.h9B9gJ0P007859@pubhealth.ku.dk>

feferraz@linux.ime.usp.br wrote:
> 
> Full_Name: Fernando Henrique Ferraz Pereira da Rosa
> Version: 1.8.0
> OS: Linux 2.4.21
> Submission from: (NULL) (200.206.211.169)
> 
>      After installing R 1.8.0, the R DBI interface stopped working. I tracked it
> down as a problem in the 'methods' package, that comes in the default
> installation.
>      Somehow the function '.valueClassTest' which is defined on package
> 'methods', is not being defined.

It is. See below.

>      To ilustrate how this breaks DBI, try this in a 1.8.0 R install (with DBI
> installed):
> 
>       > library(DBI)
>       > con <- dbConnect(dbDriver("MySQL"), dbname = "test")
> Error in dbConnect(dbDriver("MySQL"), dbname = "test") :
>         couldn't find function ".valueClassTest"
> 
>       A dirty fix would be defining it by hand (from
> src/library/methods/R/RMethodUtils.R) :
> 
>    .valueClassTest <- function(object, classes, fname) {
>         (...)
>     }
> 
>        (Which works), but ideally it'd be nice determning why the function is
> not being defined on the first place.

Package "methods" has a namespace from which .valueClassTest() is not
exported, but it's in there, try:
  methods:::.valueClassTest

I think .valueClassTest() is not intended to be called by the user, so
the bug seems to be in package DBI rather than in R, and the maintainer
of DBI (David A. James <dj@bell-labs.com>, in CC) will certainly fix it.

Uwe Ligges

From dj at research.bell-labs.com  Sat Oct 11 22:55:13 2003
From: dj at research.bell-labs.com (David James)
Date: Sat Oct 11 22:55:17 2003
Subject: [Rd] Problem in 'methods' package (PR#4525)
In-Reply-To: <3F87D1AC.875FD6AD@statistik.uni-dortmund.de>;
	from ligges@statistik.uni-dortmund.de on Sat, Oct 11, 2003 at
	11:47:24AM +0200
References: <200310110620.h9B6Km0P006241@pubhealth.ku.dk>
	<3F87D1AC.875FD6AD@statistik.uni-dortmund.de>
Message-ID: <20031011165513.A11349@jessie.research.bell-labs.com>

Hello,

It seems to me that Fernando may be right.  The problem seems to be
in R 1.8.0 when defining generics with explicit valueClass.  E.g., 

R-1.7.1:

   > setGeneric("foo", function(x) standardGeneric("foo"), valueClass="numeric")
   > setMethod("foo", "numeric", function(x) x )
   > foo(pi)
   [1] 3.141593

R-devel (1.9.0):  (I don't have 1.8.0 handy at this moment).

   > setGeneric("foo", function(x) standardGeneric("foo"), valueClass="numeric")
   > setMethod("foo", "numeric", function(x) x )
   > foo(pi)
   Error in foo(pi) : couldn't find function ".valueClassTest"

whether the problem is in the methods package or the namespace code,
I cannot say.

--
David

Uwe Ligges wrote:
> feferraz@linux.ime.usp.br wrote:
> > 
> > Full_Name: Fernando Henrique Ferraz Pereira da Rosa
> > Version: 1.8.0
> > OS: Linux 2.4.21
> > Submission from: (NULL) (200.206.211.169)
> > 
> >      After installing R 1.8.0, the R DBI interface stopped working. I tracked it
> > down as a problem in the 'methods' package, that comes in the default
> > installation.
> >      Somehow the function '.valueClassTest' which is defined on package
> > 'methods', is not being defined.
> 
> It is. See below.
> 
> >      To ilustrate how this breaks DBI, try this in a 1.8.0 R install (with DBI
> > installed):
> > 
> >       > library(DBI)
> >       > con <- dbConnect(dbDriver("MySQL"), dbname = "test")
> > Error in dbConnect(dbDriver("MySQL"), dbname = "test") :
> >         couldn't find function ".valueClassTest"
> > 
> >       A dirty fix would be defining it by hand (from
> > src/library/methods/R/RMethodUtils.R) :
> > 
> >    .valueClassTest <- function(object, classes, fname) {
> >         (...)
> >     }
> > 
> >        (Which works), but ideally it'd be nice determning why the function is
> > not being defined on the first place.
> 
> Package "methods" has a namespace from which .valueClassTest() is not
> exported, but it's in there, try:
>   methods:::.valueClassTest
> 
> I think .valueClassTest() is not intended to be called by the user, so
> the bug seems to be in package DBI rather than in R, and the maintainer
> of DBI (David A. James <dj@bell-labs.com>, in CC) will certainly fix it.
> 
> Uwe Ligges

-- 
David A. James
Statistics Research, Room 2C-253            Phone:  (908) 582-3082       
Bell Labs, Lucent Technologies              Fax:    (908) 582-3340
Murray Hill, NJ 09794-0636

From ajp2 at alu.um.es  Sun Oct 12 19:16:30 2003
From: ajp2 at alu.um.es (ajp2@alu.um.es)
Date: Sun Oct 12 19:15:37 2003
Subject: [Rd] Error openning file (PR#4550)
Message-ID: <200310121716.h9CHGU0P021123@pubhealth.ku.dk>

Full_Name: Adolfo Jiménez Pérez
Version: 1.8.0  (2003-10-08)
OS: Window'98 2ed
Submission from: (NULL) (81.203.134.156)


I've a crash when reading a specific file with the command:
> read.table("file.dat")
This file can be readed with the 1.1.1 version using the same command and R
reads it correctly. 
The content file is this:
---->file beginning<---------
"Población" "cpa1900" "cpa1910" "cpa1920" "cpa1930" "cpa1940" "cpa1950"
"cpa1960" "cpa1970" "cpa1981" "cpa1991"
"Abanilla" 6723 7635 8096 8452 8769 8646 8681 8740 7146 6074
"Abarán" 3925 4161 5393 6647 7980 8461 8878 10200 11183 11865
"Águilas" 15753 16037 17315 15903 15466 15427 15535 17187 20809 24894
"Albudeite" 1339 1560 1604 1640 1737 1719 1831 1701 1658 1411
"Alcantarilla" 4986 5752 6399 7879 10966 13294 15959 20070 24617 30144
"Alcázares_(Los)" NA NA NA NA NA NA NA NA NA 3683
"Aledo" 973 958 1335 1233 1297 1384 1237 1067 1081 985
"Alguazas" 2579 2910 3169 3349 4063 4226 5079 4886 5782 6931
"Alhama_de_Murcia" 8410 9207 9743 10042 11083 11344 11786 11600 13132 14175
"Archena" 4510 5827 6238 7071 8269 7608 8935 10110 11944 13487
"Beniel" 1617 2111 2497 3058 4183 4381 4572 5041 6043 7220
"Blanca" 4024 4352 4390 5098 5109 5683 6156 6173 6486 5768
"Bullas" 7704 5021 7974 9182 9363 9883 9594 9132 9666 10009
"Calasparra" 6428 7464 7851 8673 10627 10416 9707 8357 8678 8745
"Campos_del_Río" 1517 1690 1743 1942 1971 2274 2222 2021 2046 1949
"Caravaca_de_la_Cruz" 15804 17520 18854 21560 20550 21752 20943 18782 20455
21296
"Cartagena" 103373 102519 101613 102705 115468 110979 122387 143466 167936
168023
"Cehegín" 11523 13411 13801 15258 17684 15833 16109 12722 13648 13614
"Ceutí" 2303 2642 2891 3504 4127 3933 4649 5396 5664 6411
"Cieza" 13590 14337 16026 17667 23866 23433 22619 26089 30327 30875
"Fortuna" 6552 6770 6306 6681 6248 5964 5707 5612 5792 6004
"Fuente-Álamo" 9964 10917 11505 9073 9597 9873 9596 8977 8538 8279
"Jumilla" 15868 17513 20340 20564 21582 20988 21847 20268 20663 20092
"Librilla" 3076 3498 3184 2981 3049 3032 3079 3194 3516 3764
"Lorca" 69910 72795 75802 61392 69517 71269 59316 60286 61879 65919
"Lorquí" 1439 1777 2275 2734 3600 3220 4066 4200 5049 5328
"Mazarrón" 23362 22878 18206 14120 11928 9501 9998 9191 10270 14591
"Molina_de_Segura" 8654 10494 11082 12374 13887 14861 16415 23579 31515 37806
"Moratalla" 12816 13497 13477 13815 15013 14136 14205 10664 9374 8976
"Mula" 12733 12878 12407 13088 14293 15040 14913 14122 14738 13053
"Murcia" 111693 125243 142480 159825 195658 217934 249771 243687 284585 328100
"Ojós" 1266 1374 1308 1227 1384 1173 1193 888 647 678
"Pliego" 2913 3007 2706 2535 2691 3290 3477 3528 3378 3327
"Puerto-Lumbreras" NA NA NA NA NA NA 7205 8046 8560 9961
"Ricote" 2604 3022 2819 2956 2929 2928 2743 2320 1774 1689
"San_Javier" 4326 4940 5026 5656 6652 9008 9734 10286 12675 14696
"San_Pedro_del_Pinatar" 2637 3076 3276 3380 4377 5074 5449 6518 8866 12057
"Santomera" NA NA NA NA NA NA NA NA 7346 8518
"Torre-Pacheco" 8858 9782 9400 9255 9610 10260 11005 13006 15654 16568
"Torres_de_Cotillas_(Las)" 2616 2964 3557 3954 4806 5327 6010 7259 11349 14132
"Totana" 13714 14235 14211 13842 15453 14718 14424 16300 18537 20466
"Ulea" 1194 1420 1481 1559 1619 1581 1550 1461 1174 1073
"Unión_(La)" 28479 29599 30016 12280 10604 10156 11679 13227 14262 13940
"Villanueva_del_Río_Segura" 983 1087 1154 1300 1545 1547 1711 1872 1738 1663
"Yecla" 18717 23046 25486 26525 22601 24294 21114 20816 25307 27362
------>end file<-------
You can copy and paste this as a text file to reproduce the problem.

Thanks.

Adolfo Jiménez

From ligges at statistik.uni-dortmund.de  Sun Oct 12 19:35:27 2003
From: ligges at statistik.uni-dortmund.de (ligges@statistik.uni-dortmund.de)
Date: Sun Oct 12 19:34:34 2003
Subject: [Rd] Error openning file (PR#4550)
Message-ID: <200310121735.h9CHZR0P021247@pubhealth.ku.dk>

ajp2@alu.um.es wrote:

> Full_Name: Adolfo Jim?nez P?rez
> Version: 1.8.0  (2003-10-08)
> OS: Window'98 2ed
> Submission from: (NULL) (81.203.134.156)
> 
> 
> I've a crash when reading a specific file with the command:
> 
>>read.table("file.dat")
> 
> This file can be readed with the 1.1.1 version using the same command and R
> reads it correctly. 

This is not a bug in R. Please read the FAQs before submitting bug 
report! In particular, for details on the crash you have observed, see 
the R for Windows FAQ 2.18: "Entering certain characters crashes Rgui."

BTW: It works without problems on WinNT4.0 given your mail-tools has not 
changed any character.

So try to remove some of the language specific characters in that file 
or try again with a replace msvcrt.dll.

Uwe Ligges



> The content file is this:
> ---->file beginning<---------
> "Poblaci?n" "cpa1900" "cpa1910" "cpa1920" "cpa1930" "cpa1940" "cpa1950"
> "cpa1960" "cpa1970" "cpa1981" "cpa1991"
> "Abanilla" 6723 7635 8096 8452 8769 8646 8681 8740 7146 6074
> "Abar?n" 3925 4161 5393 6647 7980 8461 8878 10200 11183 11865
> "?guilas" 15753 16037 17315 15903 15466 15427 15535 17187 20809 24894
> "Albudeite" 1339 1560 1604 1640 1737 1719 1831 1701 1658 1411
> "Alcantarilla" 4986 5752 6399 7879 10966 13294 15959 20070 24617 30144
> "Alc?zares_(Los)" NA NA NA NA NA NA NA NA NA 3683
> "Aledo" 973 958 1335 1233 1297 1384 1237 1067 1081 985
> "Alguazas" 2579 2910 3169 3349 4063 4226 5079 4886 5782 6931
> "Alhama_de_Murcia" 8410 9207 9743 10042 11083 11344 11786 11600 13132 14175
> "Archena" 4510 5827 6238 7071 8269 7608 8935 10110 11944 13487
> "Beniel" 1617 2111 2497 3058 4183 4381 4572 5041 6043 7220
> "Blanca" 4024 4352 4390 5098 5109 5683 6156 6173 6486 5768
> "Bullas" 7704 5021 7974 9182 9363 9883 9594 9132 9666 10009
> "Calasparra" 6428 7464 7851 8673 10627 10416 9707 8357 8678 8745
> "Campos_del_R?o" 1517 1690 1743 1942 1971 2274 2222 2021 2046 1949
> "Caravaca_de_la_Cruz" 15804 17520 18854 21560 20550 21752 20943 18782 20455
> 21296
> "Cartagena" 103373 102519 101613 102705 115468 110979 122387 143466 167936
> 168023
> "Ceheg?n" 11523 13411 13801 15258 17684 15833 16109 12722 13648 13614
> "Ceut?" 2303 2642 2891 3504 4127 3933 4649 5396 5664 6411
> "Cieza" 13590 14337 16026 17667 23866 23433 22619 26089 30327 30875
> "Fortuna" 6552 6770 6306 6681 6248 5964 5707 5612 5792 6004
> "Fuente-?lamo" 9964 10917 11505 9073 9597 9873 9596 8977 8538 8279
> "Jumilla" 15868 17513 20340 20564 21582 20988 21847 20268 20663 20092
> "Librilla" 3076 3498 3184 2981 3049 3032 3079 3194 3516 3764
> "Lorca" 69910 72795 75802 61392 69517 71269 59316 60286 61879 65919
> "Lorqu?" 1439 1777 2275 2734 3600 3220 4066 4200 5049 5328
> "Mazarr?n" 23362 22878 18206 14120 11928 9501 9998 9191 10270 14591
> "Molina_de_Segura" 8654 10494 11082 12374 13887 14861 16415 23579 31515 37806
> "Moratalla" 12816 13497 13477 13815 15013 14136 14205 10664 9374 8976
> "Mula" 12733 12878 12407 13088 14293 15040 14913 14122 14738 13053
> "Murcia" 111693 125243 142480 159825 195658 217934 249771 243687 284585 328100
> "Oj?s" 1266 1374 1308 1227 1384 1173 1193 888 647 678
> "Pliego" 2913 3007 2706 2535 2691 3290 3477 3528 3378 3327
> "Puerto-Lumbreras" NA NA NA NA NA NA 7205 8046 8560 9961
> "Ricote" 2604 3022 2819 2956 2929 2928 2743 2320 1774 1689
> "San_Javier" 4326 4940 5026 5656 6652 9008 9734 10286 12675 14696
> "San_Pedro_del_Pinatar" 2637 3076 3276 3380 4377 5074 5449 6518 8866 12057
> "Santomera" NA NA NA NA NA NA NA NA 7346 8518
> "Torre-Pacheco" 8858 9782 9400 9255 9610 10260 11005 13006 15654 16568
> "Torres_de_Cotillas_(Las)" 2616 2964 3557 3954 4806 5327 6010 7259 11349 14132
> "Totana" 13714 14235 14211 13842 15453 14718 14424 16300 18537 20466
> "Ulea" 1194 1420 1481 1559 1619 1581 1550 1461 1174 1073
> "Uni?n_(La)" 28479 29599 30016 12280 10604 10156 11679 13227 14262 13940
> "Villanueva_del_R?o_Segura" 983 1087 1154 1300 1545 1547 1711 1872 1738 1663
> "Yecla" 18717 23046 25486 26525 22601 24294 21114 20816 25307 27362
> ------>end file<-------
> You can copy and paste this as a text file to reproduce the problem.
> 
> Thanks.
> 
> Adolfo Jim?nez
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://www.stat.math.ethz.ch/mailman/listinfo/r-devel

From jmc at research.bell-labs.com  Sun Oct 12 20:37:16 2003
From: jmc at research.bell-labs.com (John Chambers)
Date: Sun Oct 12 20:36:35 2003
Subject: [Rd] Problem in 'methods' package (PR#4525)
References: <200310110620.h9B6Km0P006241@pubhealth.ku.dk>
	<3F87D1AC.875FD6AD@statistik.uni-dortmund.de>
	<20031011165513.A11349@jessie.research.bell-labs.com>
Message-ID: <3F899F5C.6606DC84@research.bell-labs.com>

David James wrote:
> 
> Hello,
> 
> It seems to me that Fernando may be right.  The problem seems to be
> in R 1.8.0 when defining generics with explicit valueClass.  E.g.,
> 
> R-1.7.1:
> 
>    > setGeneric("foo", function(x) standardGeneric("foo"), valueClass="numeric")
>    > setMethod("foo", "numeric", function(x) x )
>    > foo(pi)
>    [1] 3.141593
> 
> R-devel (1.9.0):  (I don't have 1.8.0 handy at this moment).
> 
>    > setGeneric("foo", function(x) standardGeneric("foo"), valueClass="numeric")
>    > setMethod("foo", "numeric", function(x) x )
>    > foo(pi)
>    Error in foo(pi) : couldn't find function ".valueClassTest"
> 
> whether the problem is in the methods package or the namespace code,
> I cannot say.
> 
> --
> David

The simple patch is to add

export(.valueClassTest)

to the NAMESPACE file in the methods package.  This has been done &
committed to r-patched.

However, the longterm best approach is not so obvious.  The valueClass
argument to setGeneric is an addition to the API in the green book.  If
we want to keep it, a different implementation will be needed.

The current mechanism revises the body of the generic function to
include the call to .valueClassTest, but leaves the class of the generic
as "standardGeneric", which is in principle wrong.  A standardGeneric
function is defined to ONLY dispatch methods.  In the present version of
R, that doesn't matter because the body of the function is evaluated as
for any function, but in the future we want to take advantage of
"standardGeneric"-ness by special evaluation.

At that point, the valueClass= argument would need to create a
nonstandardGenericFunction object.  OK, but that raises the question of
whether this special mechanism is worth having.  The class validity test
is just a special case of the general idea of nonstandard generic
functions.  In the example, the call to setGeneric could be of the form
setGeneric("foo", def = fooDef), where fooDef is something like

function(x) {
  value <- standardGeneric("foo")
  if(!is(value,"numeric"))
    stop("foo must return a numeric object for any argument")
  value
}
This is a special case of generics that impose some validity requirement
on the value returned by the method.

Should we complicate the definition of generic functions just to deal
with the particular case of checking for a list of classes?  Seems
questionable, given that it's not imposed by the API.

John

> 
> Uwe Ligges wrote:
> > feferraz@linux.ime.usp.br wrote:
> > >
> > > Full_Name: Fernando Henrique Ferraz Pereira da Rosa
> > > Version: 1.8.0
> > > OS: Linux 2.4.21
> > > Submission from: (NULL) (200.206.211.169)
> > >
> > >      After installing R 1.8.0, the R DBI interface stopped working. I tracked it
> > > down as a problem in the 'methods' package, that comes in the default
> > > installation.
> > >      Somehow the function '.valueClassTest' which is defined on package
> > > 'methods', is not being defined.
> >
> > It is. See below.
> >
> > >      To ilustrate how this breaks DBI, try this in a 1.8.0 R install (with DBI
> > > installed):
> > >
> > >       > library(DBI)
> > >       > con <- dbConnect(dbDriver("MySQL"), dbname = "test")
> > > Error in dbConnect(dbDriver("MySQL"), dbname = "test") :
> > >         couldn't find function ".valueClassTest"
> > >
> > >       A dirty fix would be defining it by hand (from
> > > src/library/methods/R/RMethodUtils.R) :
> > >
> > >    .valueClassTest <- function(object, classes, fname) {
> > >         (...)
> > >     }
> > >
> > >        (Which works), but ideally it'd be nice determning why the function is
> > > not being defined on the first place.
> >
> > Package "methods" has a namespace from which .valueClassTest() is not
> > exported, but it's in there, try:
> >   methods:::.valueClassTest
> >
> > I think .valueClassTest() is not intended to be called by the user, so
> > the bug seems to be in package DBI rather than in R, and the maintainer
> > of DBI (David A. James <dj@bell-labs.com>, in CC) will certainly fix it.
> >
> > Uwe Ligges
> 
> --
> David A. James
> Statistics Research, Room 2C-253            Phone:  (908) 582-3082
> Bell Labs, Lucent Technologies              Fax:    (908) 582-3340
> Murray Hill, NJ 09794-0636

From deleeuw at stat.ucla.edu  Sun Oct 12 20:51:50 2003
From: deleeuw at stat.ucla.edu (Jan de Leeuw)
Date: Sun Oct 12 20:51:17 2003
Subject: [Rd] xlc/xlf on osx 
Message-ID: <234602B9-FCE5-11D7-B43E-000A95A67E82@stat.ucla.edu>

I can now build most of R with XLC/XLF using optimization level O4
on OS X. I twice have to intervene and manually set optimization
to O3 (for trees.c in zlib and util.c in main). But, more importantly, I
cannot use the xlc/xlf compiler drivers for linking. They do not
understand some of the gcc flags, which is no problem because they
then pass them to ld, but more importantly they refuse to handle
any file with name  foo.lo. Is the "lo" a configure switch I can set to
"o" ? Currently I am building everything by setting LD_MAIN and
LD_SHLIB to gcc, i.e. xlc/xlf does the actual compilations and gcc 
drives the
linking. This is not ideal, because it may include the wrong options and
libraries, and it eventually breaks the methods package (which refuses
to dump code after it compiles).

Other things which I see is that the "-framework Carbon" flag gets
lost when linking R.bin, and that I can only link libLapack.dylib
by adding "-flat_namespace -undefined suppress" to the linker
flags. These are somewhat mysterious.

I am attaching config.site.

-------------- next part --------------

===
Jan de Leeuw; Professor and Chair, UCLA Department of Statistics;
Editor: Journal of Multivariate Analysis, Journal of Statistical  
Software
US mail: 8130 Math Sciences Bldg, Box 951554, Los Angeles, CA 90095-1554
phone (310)-825-9550;  fax (310)-206-5658;  email: deleeuw@stat.ucla.edu
homepage: http://gifi.stat.ucla.edu
   
------------------------------------------------------------------------ 
-------------------------
           No matter where you go, there you are. --- Buckaroo Banzai
                    http://gifi.stat.ucla.edu/sounds/nomatter.au
   
------------------------------------------------------------------------ 
------------------------- 
        
From Kurt.Hornik at wu-wien.ac.at  Sun Oct 12 21:12:36 2003
From: Kurt.Hornik at wu-wien.ac.at (Kurt Hornik)
Date: Sun Oct 12 23:22:52 2003
Subject: [Rd] xlc/xlf on osx 
In-Reply-To: <234602B9-FCE5-11D7-B43E-000A95A67E82@stat.ucla.edu>
References: <234602B9-FCE5-11D7-B43E-000A95A67E82@stat.ucla.edu>
Message-ID: <16265.42916.558227.492142@mithrandir.hornik.net>

>>>>> Jan de Leeuw writes:

> I can now build most of R with XLC/XLF using optimization level O4 on
> OS X. I twice have to intervene and manually set optimization to O3
> (for trees.c in zlib and util.c in main). But, more importantly, I
> cannot use the xlc/xlf compiler drivers for linking. They do not
> understand some of the gcc flags, which is no problem because they
> then pass them to ld, but more importantly they refuse to handle any
> file with name foo.lo. Is the "lo" a configure switch I can set to "o"
> ? Currently I am building everything by setting LD_MAIN and LD_SHLIB
> to gcc, i.e. xlc/xlf does the actual compilations and gcc drives the
> linking. This is not ideal, because it may include the wrong options
> and libraries, and it eventually breaks the methods package (which
> refuses to dump code after it compiles).

I think the configure code actually tests whether the compilers can
handle -c -o .lo, and have a workaround if this fails.

-k

From p.murrell at auckland.ac.nz  Mon Oct 13 01:39:21 2003
From: p.murrell at auckland.ac.nz (p.murrell@auckland.ac.nz)
Date: Mon Oct 13 01:38:28 2003
Subject: [Rd] zapsmall with all values small (PR#4554)
Message-ID: <200310122339.h9CNdL0P024293@pubhealth.ku.dk>

Hi

If all values are small, zapsmall does not zap.

For example ...

 > zapsmall(1e-24)
[1] 1e-24
 > zapsmall(1e-24, digits=3)
[1] 1e-24

Problem appears to be in calculation of digits ...

     mx <- max(abs(x[!ina]))
     digits = if (mx > 0)
                max(0, digits - log10(mx))
              else
                digits

If all values are small, mx is very small, log10(mx) is "large" but 
negative, digits - log10(mx) is very large, so no rounding occurs.

Paul
--please do not edit the information below--

Version:
  platform = i686-pc-linux-gnu
  arch = i686
  os = linux-gnu
  system = i686, linux-gnu
  status = Under development (unstable)
  major = 1
  minor = 9.0
  year = 2003
  month = 10
  day = 12
  language = R

Search Path:
  .GlobalEnv, package:gridBase, package:methods, package:ctest, 
package:mva, package:modreg, package:nls, package:ts, package:lattice, 
package:grid, package:graphicsQC, Autoloads, package:base

-- 
Dr Paul Murrell
Department of Statistics
The University of Auckland
Private Bag 92019
Auckland
New Zealand
64 9 3737599 x85392
paul@stat.auckland.ac.nz
http://www.stat.auckland.ac.nz/~paul/

From maechler at stat.math.ethz.ch  Mon Oct 13 09:22:00 2003
From: maechler at stat.math.ethz.ch (maechler@stat.math.ethz.ch)
Date: Mon Oct 13 09:21:04 2003
Subject: [Rd] zapsmall with all values small (PR#4554)
Message-ID: <200310130722.h9D7M00P000582@pubhealth.ku.dk>

>>>>> "Paul" == p murrell <p.murrell@auckland.ac.nz>
>>>>>     on Mon, 13 Oct 2003 01:39:21 +0200 (MET DST) writes:

    Paul> Hi If all values are small, zapsmall does not zap.

    Paul> For example ...

    >> zapsmall(1e-24)
    Paul> [1] 1e-24
    >> zapsmall(1e-24, digits=3)
    Paul> [1] 1e-24


    Paul> Problem appears to be in calculation of digits ...

    Paul>      mx <- max(abs(x[!ina])) digits = if (mx > 0)
    Paul> max(0, digits - log10(mx)) else digits

    Paul> If all values are small, mx is very small, log10(mx)
    Paul> is "large" but negative, digits - log10(mx) is very
    Paul> large, so no rounding occurs.

This has very much been the intent of zapsmall AFAI have
"forever" known (though the documentation unfortunately does not
tell clearly so) :

The "small"  in "zapsmall(x)" is something  *relative* to the other
numbers in `x'.

If you know in advance that 1e-24 is small (it isn't, compared
to 1e-22 or even 1e-50), then use round() with an explicit
digits argument.

Hence, the bug is only in the not-so-clear documentation.

Martin

From John.Marsland at CommerzbankIB.com  Mon Oct 13 10:51:58 2003
From: John.Marsland at CommerzbankIB.com (John.Marsland@CommerzbankIB.com)
Date: Mon Oct 13 10:51:05 2003
Subject: [Rd] R1.8.0 : seq.POSIXt() problems (PR#4558)
Message-ID: <200310130851.h9D8pw0P003493@pubhealth.ku.dk>

I'm having problems with seq.POSIXt() under R 1.8.0 (Windows NT4).

Essentially the last date in my sequence is lost depending on whether the
sequence spans a daylight saving time change. 

This seems to apply regardless as to whether one uses by="DSTdays" or
by="days".

Try the following lines of code:

> seq.POSIXt(as.POSIXct("2003-09-01"),as.POSIXct("2003-10-09"),"DSTdays")
[1] "2003-09-01 GMT Daylight Time" "2003-09-02 GMT Daylight Time"
...
[39] "2003-10-09 GMT Daylight Time"

> seq.POSIXt(as.POSIXct("2003-03-01"),as.POSIXct("2003-10-09"),"DSTdays")
[1] "2003-03-01 GMT Standard Time" "2003-03-02 GMT Standard Time"
...
[221] "2003-10-07 GMT Daylight Time" "2003-10-08 GMT Daylight Time"

> seq.POSIXt(as.POSIXct("2002-10-01"),as.POSIXct("2003-10-09"),"DSTdays")
[1] "2002-10-01 GMT Daylight Time" "2002-10-02 GMT Daylight Time"
...
[373] "2003-10-08 GMT Daylight Time" "2003-10-09 GMT Daylight Time"

Any thoughts?

Regards,

John

> R.version
         _              
platform i386-pc-mingw32
arch     i386           
os       mingw32        
system   i386, mingw32  
status                  
major    1              
minor    8.0            
year     2003           
month    10             
day      08             
language R   


********************************************************************** 
This is a commercial communication from Commerzbank AG.\ \ T...{{dropped}}

From saikat at stat.wisc.edu  Mon Oct 13 18:16:22 2003
From: saikat at stat.wisc.edu (saikat@stat.wisc.edu)
Date: Mon Oct 13 18:15:26 2003
Subject: [Rd] Infinite recursion in getGeneric (PR#4561)
Message-ID: <200310131616.h9DGGM0P018070@pubhealth.ku.dk>

 > setClass('foo')
[1] "foo"
 > setMethod('is.logical', 'foo', function(x) TRUE)
[1] "is.logical"
 > getGeneric('is.integer')
Error in options(x) : evaluation is nested too deeply: infinite 
recursion?
 >

--please do not edit the information below--

Version:
  platform = i686-pc-linux-gnu
  arch = i686
  os = linux-gnu
  system = i686, linux-gnu
  status =
  major = 1
  minor = 8.0
  year = 2003
  month = 10
  day = 08
  language = R

Search Path:
  .GlobalEnv, package:methods, package:ctest, package:mva, 
package:modreg, package:nls, package:ts, Autoloads, package:base

From saikat at stat.wisc.edu  Mon Oct 13 19:56:08 2003
From: saikat at stat.wisc.edu (Saikat DebRoy)
Date: Mon Oct 13 19:54:14 2003
Subject: [Rd] Inconsistency in subset results
Message-ID: <8603ADBE-FDA6-11D7-929B-0003931A3C9E@stat.wisc.edu>

Subsetting objects with attributes are present do not behave 
consistently.
The exception is the empty vector subscript.

Let's look at an example.

 > foo <- matrix(1:16, 4, dimnames=list(letters[1:4], letters[5:8]))
 > names(foo) <- LETTERS[1:16] # add names
 > attr(foo, 'bar') <- TRUE # and an extra attribute
 > foo
   e f  g  h
a 1 5  9 13
b 2 6 10 14
c 3 7 11 15
d 4 8 12 16
attr(,"names")
  [1] "A" "B" "C" "D" "E" "F" "G" "H" "I" "J" "K" "L" "M" "N" "O" "P"
attr(,"bar")
[1] TRUE
 > foo[] # returns the original object
   e f  g  h
a 1 5  9 13
b 2 6 10 14
c 3 7 11 15
d 4 8 12 16
attr(,"names")
  [1] "A" "B" "C" "D" "E" "F" "G" "H" "I" "J" "K" "L" "M" "N" "O" "P"
attr(,"bar")
[1] TRUE
 > foo[,] # but this does not
   e f  g  h
a 1 5  9 13
b 2 6 10 14
c 3 7 11 15
d 4 8 12 16
 > foo[1:16] # neither does this
  A  B  C  D  E  F  G  H  I  J  K  L  M  N  O  P
  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16
 >

Basically, foo[] behaves differently from others. Every other subset 
operation drops attributes (other than those directly relevent).

In case anyone is wondering, for Splus (old 3.4 on a Sun), the results
are same for all but the matrix subset operation. Then we get

Splus3.4> foo[,]
   e f  g  h
a 1 5  9 13
b 2 6 10 14
c 3 7 11 15
d 4 8 12 16
attr(,"names")
  [1] "A" "B" "C" "D" "E" "F" "G" "H" "I" "J" "K" "L" "M" "N" "O" "P"

In fact if a names attribute is present, Splus always subsets it as if 
it was an array with same dimensions as the actual object.

From tlumley at u.washington.edu  Mon Oct 13 20:15:50 2003
From: tlumley at u.washington.edu (tlumley@u.washington.edu)
Date: Mon Oct 13 20:14:56 2003
Subject: [Rd] infinite loop in abbreviate() (PR#4564)
Message-ID: <200310131815.h9DIFo0P021101@pubhealth.ku.dk>



abbreviate() will go into an infinite loop if two elements of the argument
differ only by leading space

eg
  abbreviate(c("A"," A"), 4)

This is in R 1.8.0 (both OS X and Linux).

The problem appears to be that duplicates are removed before leading and
trailing spaces.

	-thomas

From brahm at alum.mit.edu  Mon Oct 13 21:49:41 2003
From: brahm at alum.mit.edu (David Brahm)
Date: Mon Oct 13 21:48:48 2003
Subject: [Rd] 1.8.0 on Unix: interrupting huge print()s  ??
Message-ID: <16267.469.777551.244883@arbres1a.fmr.com>

Martin Maechler <maechler@stat.math.ethz.ch> wrote:
> When accidentally calling print() {implicitly}, we have been used here to
> press CTRL+c (twice in Emacs ESS!) for stopping the output.
> This no longer works in R 1.8.0 at least on our unix platforms.

Luke Tierney <luke@stat.uiowa.edu> wrote:
> Needs a call to R_CheckUserInterrupt at the appropriate place...

Most unfortunate!  Our system is like Martin's (Solaris 2.8, Emacs, ESS)
and we also lose the use of ^C^C with R-1.8.0.  It's probably enough to prevent
us from upgrading.  I saw no sign of Luke's proposed patch as of 10/13 (in the
NEWS file); is one in the works?  Thanks.
-- 
                              -- David Brahm (brahm@alum.mit.edu)

From jmc at research.bell-labs.com  Mon Oct 13 22:17:46 2003
From: jmc at research.bell-labs.com (John Chambers)
Date: Mon Oct 13 22:17:25 2003
Subject: [Rd] Infinite recursion in getGeneric (PR#4561)
References: <200310131616.h9DGGM0P018070@pubhealth.ku.dk>
Message-ID: <3F8B086A.7D86C08D@research.bell-labs.com>

saikat@stat.wisc.edu wrote:
> 
>  > setClass('foo')
> [1] "foo"
>  > setMethod('is.logical', 'foo', function(x) TRUE)
> [1] "is.logical"
>  > getGeneric('is.integer')
> Error in options(x) : evaluation is nested too deeply: infinite
> recursion?

This is one of a number of potential problems when methods are specified
for  primitive functions used in the R code that dispatches methods.

There is a fix for this particular example -- I will commit it to
r-patched.

However, the only real safety will come when primitives are not
dispatched from a global structure (a change planned for 1.9).  Then the
version of primitives used in method dispatch can be separated from any
methods defined in a different namespace.

For example, a quick test showed that even after the above fix, setting
methods for "is.null" causes similar problems.

As a heuristic, setting methods for language-related primitives is
dangerous (also a little strange?).

John

>  >
> 
> --please do not edit the information below--
> 
> Version:
>   platform = i686-pc-linux-gnu
>   arch = i686
>   os = linux-gnu
>   system = i686, linux-gnu
>   status =
>   major = 1
>   minor = 8.0
>   year = 2003
>   month = 10
>   day = 08
>   language = R
> 
> Search Path:
>   .GlobalEnv, package:methods, package:ctest, package:mva,
> package:modreg, package:nls, package:ts, Autoloads, package:base
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://www.stat.math.ethz.ch/mailman/listinfo/r-devel

-- 
John M. Chambers                  jmc@bell-labs.com
Bell Labs, Lucent Technologies    office: (908)582-2681
700 Mountain Avenue, Room 2C-282  fax:    (908)582-3340
Murray Hill, NJ  07974            web: http://www.cs.bell-labs.com/~jmc

From thoffman at zappa.sax.de  Mon Oct 13 22:34:14 2003
From: thoffman at zappa.sax.de (Thomas Hoffmann)
Date: Mon Oct 13 22:19:06 2003
Subject: [Rd] Double inclusion of Runix.h: why?
Message-ID: <3F8B0C46.2060703@zappa.sax.de>

This code can be found near the top of unix/sys-std.c. Is there a reason 
for this?

#include "Runix.h"
#include "Startup.h"

#include "Runix.h"

-- 
Thomas Hoffmann                                    Telephone: 49-351-4598831
thoffman@zappa.sax.de                                       Dresden, Germany

.sig under construction ...

From thoffman at zappa.sax.de  Mon Oct 13 22:34:31 2003
From: thoffman at zappa.sax.de (Thomas Hoffmann)
Date: Mon Oct 13 22:19:23 2003
Subject: [Rd] Documentation buglet in pdf.Rd?
Message-ID: <3F8B0C57.80509@zappa.sax.de>

The comment below points to a non-existing file: devPS.c sits in main 
for some releases.

\name{pdf}
\alias{pdf}
\title{PDF Graphics Device}
%% The definitive doc is the source :-)
%%     ../../../main/devices.c  &   ../../../unix/devPS.c

-- 
Thomas Hoffmann                                    Telephone: 49-351-4598831
thoffman@zappa.sax.de                                       Dresden, Germany

.sig under construction ...

From saikat at stat.wisc.edu  Mon Oct 13 22:40:38 2003
From: saikat at stat.wisc.edu (Saikat DebRoy)
Date: Mon Oct 13 22:38:41 2003
Subject: [Rd] Infinite recursion in getGeneric (PR#4561)
In-Reply-To: <3F8B086A.7D86C08D@research.bell-labs.com>
Message-ID: <80D701A2-FDBD-11D7-81E2-0003931A3C9E@stat.wisc.edu>

On Monday, Oct 13, 2003, at 16:17 US/Eastern, John Chambers wrote:

> As a heuristic, setting methods for language-related primitives is
> dangerous (also a little strange?).

Yes. But if it is allowed, someone will do it. It may actually make 
sense to come up with an appropriate (and preferably small) list of 
primitive functions and say that you can not define methods for them 
(at least easily).

From jmc at research.bell-labs.com  Mon Oct 13 23:52:05 2003
From: jmc at research.bell-labs.com (John Chambers)
Date: Mon Oct 13 23:51:19 2003
Subject: [Rd] Infinite recursion in getGeneric (PR#4561)
References: <80D701A2-FDBD-11D7-81E2-0003931A3C9E@stat.wisc.edu>
Message-ID: <3F8B1E85.3BDE1488@research.bell-labs.com>

Saikat DebRoy wrote:
> 
> On Monday, Oct 13, 2003, at 16:17 US/Eastern, John Chambers wrote:
> 
> > As a heuristic, setting methods for language-related primitives is
> > dangerous (also a little strange?).
> 
> Yes. But if it is allowed, someone will do it. It may actually make
> sense to come up with an appropriate (and preferably small) list of
> primitive functions and say that you can not define methods for them
> (at least easily).

If we're talking about r-devel, not r-patched, we can do better.  The
inherent problem is that a global table is used for dispatching methods
for primitives.  For 1.9, the plan is to replace this with more-or-less
real generic functions  (the less part is that the version of is.logical
the evaluator calls will still be a primitive; the generic will be found
by another mechanism).  Once methods are dispatched from valid generic
functions, then a call to is.logical within method dispatch will be
unaffected by methods defined for is.logical in another namespace.

As for r-patched, it would be easy to prohibit methods for those that
generate infinite loops, if we knew which ones they were.

John

From maechler at stat.math.ethz.ch  Tue Oct 14 12:43:28 2003
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Tue Oct 14 12:43:04 2003
Subject: [Rd] Double inclusion of Runix.h: why?
In-Reply-To: <3F8B0C46.2060703@zappa.sax.de>
References: <3F8B0C46.2060703@zappa.sax.de>
Message-ID: <16267.54096.352732.734085@gargle.gargle.HOWL>

>>>>> "Thomas" == Thomas Hoffmann <thoffman@zappa.sax.de>
>>>>>     on Mon, 13 Oct 2003 22:34:14 +0200 writes:

    Thomas> This code can be found near the top of
    Thomas> unix/sys-std.c. Is there a reason for this?

probably an oversight , cut&paste remnant, ...

Now fixed; thank you, Thomas.

From WhiteG at dfo-mpo.gc.ca  Tue Oct 14 13:50:17 2003
From: WhiteG at dfo-mpo.gc.ca (WhiteG@dfo-mpo.gc.ca)
Date: Tue Oct 14 13:49:31 2003
Subject: [Rd] gtkDevice: configure error from install.packages("gtkDevice")
	(PR#4575)
Message-ID: <200310141150.h9EBoH0P007179@pubhealth.ku.dk>

Full_Name: George N. White III
Version: 1.8.0
OS: Irix 6.5
Submission from: (NULL) (142.176.61.245)


> options(CRAN = "http://cran.us.r-project.org/")
> install.packages("gtkDevice")
* Installing *source* package 'gtkDevice' ...
./configure[1221]: test: argument expected        <<<<<<<<<<<<<<<<
Only versions 1.2 and 2.0 of gtk+ are supported.
** libs
[...]
cc -I/usr/local/lib/R/include  -I/usr/freeware/include \
 -I/usr/people/gwhite/include -OPT:IEEE_NaN_inf=ON \
   -mips4 -n32 -O3 -OPT:Olimit_opt=on -c devGTK.c -o devGTK.o
cc-1005 cc: ERROR File = devGTK.c, Line = 33
  The source file "gtk/gtk.h" is unavailable.

  #include <gtk/gtk.h>
                      ^
1 catastrophic error detected in the compilation of "devGTK.c".
Compilation terminated.
gmake: *** [devGTK.o] Error 2
ERROR: compilation failed for package 'gtkDevice'
** Removing '/usr/local/lib/R/library/gtkDevice'
 ------------------------------------------------------------

A workaround is to add the necessary include (-I) directories
and link options to etc/Makeconf.

From luke at stat.uiowa.edu  Tue Oct 14 18:16:03 2003
From: luke at stat.uiowa.edu (Luke Tierney)
Date: Tue Oct 14 18:15:12 2003
Subject: [Rd] 1.8.0 on Unix: interrupting huge print()s  ??
In-Reply-To: <16267.469.777551.244883@arbres1a.fmr.com>
Message-ID: <Pine.LNX.4.44.0310141112590.8770-100000@itasca.stat.uiowa.edu>

On Mon, 13 Oct 2003, David Brahm wrote:

> Martin Maechler <maechler@stat.math.ethz.ch> wrote:
> > When accidentally calling print() {implicitly}, we have been used here to
> > press CTRL+c (twice in Emacs ESS!) for stopping the output.
> > This no longer works in R 1.8.0 at least on our unix platforms.
> 
> Luke Tierney <luke@stat.uiowa.edu> wrote:
> > Needs a call to R_CheckUserInterrupt at the appropriate place...
> 
> Most unfortunate!  Our system is like Martin's (Solaris 2.8, Emacs, ESS)
> and we also lose the use of ^C^C with R-1.8.0.  It's probably enough to prevent
> us from upgrading.  I saw no sign of Luke's proposed patch as of 10/13 (in the
> NEWS file); is one in the works?  Thanks.
> 

The change is now checked in to patches and devel branches.

If C-c C-c does not work for you at all in ESS then this is not
related to R changes in 1.8.0 (I sometimes seem to need C-g C-c C-c).

luke

-- 
Luke Tierney
University of Iowa                  Phone:             319-335-3386
Department of Statistics and        Fax:               319-335-3017
   Actuarial Science
241 Schaeffer Hall                  email:      luke@stat.uiowa.edu
Iowa City, IA 52242                 WWW:  http://www.stat.uiowa.edu

From bates at stat.wisc.edu  Tue Oct 14 20:36:33 2003
From: bates at stat.wisc.edu (Douglas Bates)
Date: Tue Oct 14 20:35:33 2003
Subject: [Rd] Example of package that uses a namespace with S4 classes
Message-ID: <6rvfqris3y.fsf@bates4.stat.wisc.edu>

Is there an example of a package that uses both a namespace and S4
classes and methods?

From rpeng at jhsph.edu  Tue Oct 14 20:41:30 2003
From: rpeng at jhsph.edu (Roger D. Peng)
Date: Tue Oct 14 20:43:40 2003
Subject: [Rd] Example of package that uses a namespace with S4 classes
In-Reply-To: <6rvfqris3y.fsf@bates4.stat.wisc.edu>
References: <6rvfqris3y.fsf@bates4.stat.wisc.edu>
Message-ID: <3F8C435A.6040805@jhsph.edu>

What about `mle'?

-roger

Douglas Bates wrote:

>Is there an example of a package that uses both a namespace and S4
>classes and methods?
>
>______________________________________________
>R-devel@stat.math.ethz.ch mailing list
>https://www.stat.math.ethz.ch/mailman/listinfo/r-devel
>
>  
>

From hosking at watson.ibm.com  Tue Oct 14 21:44:11 2003
From: hosking at watson.ibm.com (hosking@watson.ibm.com)
Date: Tue Oct 14 21:43:14 2003
Subject: [Rd] NA %*% 0 == 0 (PR#4582)
Message-ID: <200310141944.h9EJiB0P012013@pubhealth.ku.dk>

Full_Name: J . R. M. Hosking
Version: 1.8.0
OS: Windows 2000
Submission from: (NULL) (129.34.20.23)


On R 1.8.0 (and on R 1.5.1), Windows binary:

> NA %*% 0
     [,1]
[1,]    0

This is surprising.  Is it a bug?  Note that 

> 0 %*% NA
     [,1]
[1,]   NA
> NA %*% 1
     [,1]
[1,]   NA
> NA * 0
[1] NA

as expected.

From tlumley at u.washington.edu  Tue Oct 14 23:44:48 2003
From: tlumley at u.washington.edu (Thomas Lumley)
Date: Tue Oct 14 23:44:04 2003
Subject: [Rd] NA %*% 0 == 0 (PR#4582)
In-Reply-To: <200310141944.h9EJiB0P012013@pubhealth.ku.dk>
References: <200310141944.h9EJiB0P012013@pubhealth.ku.dk>
Message-ID: <Pine.A41.4.58.0310141444190.143272@homer34.u.washington.edu>

On Tue, 14 Oct 2003 hosking@watson.ibm.com wrote:

> Full_Name: J . R. M. Hosking
> Version: 1.8.0
> OS: Windows 2000
> Submission from: (NULL) (129.34.20.23)
>
>
> On R 1.8.0 (and on R 1.5.1), Windows binary:
>
> > NA %*% 0
>      [,1]
> [1,]    0
>
> This is surprising.  Is it a bug?  Note that
>

I think it's a bug. It doesn't seem to happen on Linux or OS X, though.

	-thomas

From p.dalgaard at biostat.ku.dk  Wed Oct 15 00:16:00 2003
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard BSA)
Date: Wed Oct 15 00:12:57 2003
Subject: [Rd] NA %*% 0 == 0 (PR#4582)
In-Reply-To: <Pine.A41.4.58.0310141444190.143272@homer34.u.washington.edu>
References: <200310141944.h9EJiB0P012013@pubhealth.ku.dk>
	<Pine.A41.4.58.0310141444190.143272@homer34.u.washington.edu>
Message-ID: <x2r81fea8v.fsf@biostat.ku.dk>

Thomas Lumley <tlumley@u.washington.edu> writes:

> On Tue, 14 Oct 2003 hosking@watson.ibm.com wrote:
> 
> > Full_Name: J . R. M. Hosking
> > Version: 1.8.0
> > OS: Windows 2000
> > Submission from: (NULL) (129.34.20.23)
> >
> >
> > On R 1.8.0 (and on R 1.5.1), Windows binary:
> >
> > > NA %*% 0
> >      [,1]
> > [1,]    0
> >
> > This is surprising.  Is it a bug?  Note that
> >
> 
> I think it's a bug. It doesn't seem to happen on Linux or OS X, though.

Does for me (RedHat, R 1.8.0 and 1.7.0).


-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From r.huggins at latrobe.edu.au  Wed Oct 15 01:20:04 2003
From: r.huggins at latrobe.edu.au (r.huggins@latrobe.edu.au)
Date: Wed Oct 15 01:19:11 2003
Subject: [Rd] fivenum (PR#4586)
Message-ID: <200310142320.h9ENK40P013349@pubhealth.ku.dk>

Full_Name: Richard Huggins
Version: 1.7.1
OS: windows 2000
Submission from: (NULL) (131.172.4.44)


> x<-rnorm(100,2,1)
> mean(x)
[1] 1.73299
> summary(fivenum(x))
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
-0.3655  1.1070  1.7430  1.7320  2.3840  3.7910 
> summary(x)
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
-0.3655  1.1070  1.7430  1.7330  2.3830  3.7910 
> y<-log(abs(x))
> summary(fivenum(y))
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
-3.5950  0.1020  0.5555 -0.1472  0.8688  1.3330 
> mean(y)
[1] 0.2878568
> summary(y)
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
-3.5950  0.1021  0.5555  0.2879  0.8683  1.3330 


summary(fivenum(x)) gives the wrong mean

From edd at debian.org  Wed Oct 15 01:38:32 2003
From: edd at debian.org (Dirk Eddelbuettel)
Date: Wed Oct 15 01:37:40 2003
Subject: [Rd] fivenum (PR#4586)
In-Reply-To: <200310142320.h9ENK40P013349@pubhealth.ku.dk>
References: <200310142320.h9ENK40P013349@pubhealth.ku.dk>
Message-ID: <20031014233832.GA8506@sonny.eddelbuettel.com>

On Wed, Oct 15, 2003 at 01:20:04AM +0200, r.huggins@latrobe.edu.au wrote:
> Full_Name: Richard Huggins
> Version: 1.7.1
> OS: windows 2000
> Submission from: (NULL) (131.172.4.44)
> 
> 
> > x<-rnorm(100,2,1)
> > mean(x)
> [1] 1.73299
> > summary(fivenum(x))
>    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
> -0.3655  1.1070  1.7430  1.7320  2.3840  3.7910 
> > summary(x)
>    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
> -0.3655  1.1070  1.7430  1.7330  2.3830  3.7910 
> > y<-log(abs(x))
> > summary(fivenum(y))
>    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
> -3.5950  0.1020  0.5555 -0.1472  0.8688  1.3330 
> > mean(y)
> [1] 0.2878568
> > summary(y)
>    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
> -3.5950  0.1021  0.5555  0.2879  0.8683  1.3330 
> 
> 
> summary(fivenum(x)) gives the wrong mean

I think you may be misunderstanding what is happening -- fivenum() returns a
simple vector of five numbers, which summary then summarises. 

It so happens that for an (approx.) symmetrically distributed sample x as
the one you drew from the N(2,1), mean(summary(x)) is still approx. mean(x)
(and identical asymptocally).  That no longer holds once you take
logs(abs()).  As so often, it helps to simply plot the data as you could with

> boxplot(x,summary(x),fivenum(x),y,summary(y),fivenum(y),horizontal=TRUE)


Hth, Dirk



-- 
Those are my principles, and if you don't like them... well, I have others.
                                                -- Groucho Marx

From laurent at cbs.dtu.dk  Wed Oct 15 08:02:12 2003
From: laurent at cbs.dtu.dk (Laurent Gautier)
Date: Wed Oct 15 08:00:57 2003
Subject: [Rd] help.search in trouble with R-patched ?
Message-ID: <20031015060212.GE1068049@genome.cbs.dtu.dk>


...unless its me missing something...

> help.search("prompt", agrep=F)
Error: couldn't find function ".class1"
> traceback()
12: initialize(value, ...)
11: initialize(value, ...)
10: new("ObjectsWithPackage", value, package = pkg)
9: metaNameUndo(unique(these), prefix = "M", searchForm = searchForm)
8: methods:::getGenerics(ns)
7: unique(c(methods:::getGenerics(ns), methods:::getGenerics(parent.env(ns))))
6: loadNamespace(name)
5: getNamespace(ns)
4: asNamespace(ns)
3: getExportedValue(pkg, name)
2: tools::fileTest
1: help.search("prompt", agrep = F)
> version
         _
platform i686-pc-linux-gnu
arch     i686
os       linux-gnu
system   i686, linux-gnu
status   Patched
major    1
minor    8.0
year     2003
month    10
day      14
language R
>

From deleeuw at stat.ucla.edu  Wed Oct 15 08:05:52 2003
From: deleeuw at stat.ucla.edu (Jan de Leeuw)
Date: Wed Oct 15 08:05:08 2003
Subject: [Rd] help.search in trouble with R-patched ?
In-Reply-To: <20031015060212.GE1068049@genome.cbs.dtu.dk>
References: <20031015060212.GE1068049@genome.cbs.dtu.dk>
Message-ID: <A1E4143E-FED5-11D7-B288-000A95A67E82@stat.ucla.edu>

This works fine in R-patched in Darwin.

On Oct 14, 2003, at 23:02, Laurent Gautier wrote:

>> help.search("prompt", agrep=F)
===
Jan de Leeuw; Professor and Chair, UCLA Department of Statistics;
Editor: Journal of Multivariate Analysis, Journal of Statistical  
Software
US mail: 8130 Math Sciences Bldg, Box 951554, Los Angeles, CA 90095-1554
phone (310)-825-9550;  fax (310)-206-5658;  email: deleeuw@stat.ucla.edu
homepage: http://gifi.stat.ucla.edu
   
------------------------------------------------------------------------ 
-------------------------
           No matter where you go, there you are. --- Buckaroo Banzai
                    http://gifi.stat.ucla.edu/sounds/nomatter.au

From ligges at statistik.uni-dortmund.de  Wed Oct 15 09:06:39 2003
From: ligges at statistik.uni-dortmund.de (ligges@statistik.uni-dortmund.de)
Date: Wed Oct 15 09:05:44 2003
Subject: [Rd] NA %*% 0 == 0 (PR#4582)
Message-ID: <200310150706.h9F76d0P015637@pubhealth.ku.dk>

Peter Dalgaard BSA wrote:

> Thomas Lumley <tlumley@u.washington.edu> writes:
> 
> 
>>On Tue, 14 Oct 2003 hosking@watson.ibm.com wrote:
>>
>>
>>>Full_Name: J . R. M. Hosking
>>>Version: 1.8.0
>>>OS: Windows 2000
>>>Submission from: (NULL) (129.34.20.23)
>>>
>>>
>>>On R 1.8.0 (and on R 1.5.1), Windows binary:
>>>
>>>
>>>>NA %*% 0
>>>
>>>     [,1]
>>>[1,]    0
>>>
>>>This is surprising.  Is it a bug?  Note that
>>>
>>
>>I think it's a bug. It doesn't seem to happen on Linux or OS X, though.

R-1.8.0: Does not happen for me on WindowsNT4.0 either (self compiled 
binary, gcc-3.3.1).


> Does for me (RedHat, R 1.8.0 and 1.7.0).


I guess the problem is compiler-dependend, because I get that "0" in a 
self-compiled R-1.7.1 (has been compiled with gcc-3.2.?).

Is your binary self-compiled or from CRAN (Duncan Murdoch compiled the 
CRAN binary with gcc-3.3.1 as well, AFAIK)?

Uwe Ligges

From laurent at cbs.dtu.dk  Wed Oct 15 09:35:30 2003
From: laurent at cbs.dtu.dk (Laurent Gautier)
Date: Wed Oct 15 09:34:15 2003
Subject: [Rd] help.search in trouble with R-patched ?
In-Reply-To: <A1E4143E-FED5-11D7-B288-000A95A67E82@stat.ucla.edu>
References: <20031015060212.GE1068049@genome.cbs.dtu.dk>
	<A1E4143E-FED5-11D7-B288-000A95A67E82@stat.ucla.edu>
Message-ID: <20031015073530.GH1068049@genome.cbs.dtu.dk>

I just closed my R session, ran it again... and then 
it worked... the only difference (of possible interest)
I have found between the two sessions is that in the
first one, the package reposTools did:
Synching your local package management information ...
Packages which have been added/updated:
        base
        Biobase
        boot
        class
        cluster
        ctest
        eda
        foreign
        grid
(etc)

Anyways, it seems to work now....



L.

`
On Tue, Oct 14, 2003 at 11:05:52PM -0700, Jan de Leeuw wrote:
> This works fine in R-patched in Darwin.
> 
> On Oct 14, 2003, at 23:02, Laurent Gautier wrote:
> 
> >>help.search("prompt", agrep=F)
> ===
> Jan de Leeuw; Professor and Chair, UCLA Department of Statistics;
> Editor: Journal of Multivariate Analysis, Journal of Statistical  
> Software
> US mail: 8130 Math Sciences Bldg, Box 951554, Los Angeles, CA 90095-1554
> phone (310)-825-9550;  fax (310)-206-5658;  email: deleeuw@stat.ucla.edu
> homepage: http://gifi.stat.ucla.edu
>   
> ------------------------------------------------------------------------ 
> -------------------------
>           No matter where you go, there you are. --- Buckaroo Banzai
>                    http://gifi.stat.ucla.edu/sounds/nomatter.au
>   
> ------------------------------------------------------------------------ 
> -------------------------
>

From dmurdoch at pair.com  Wed Oct 15 13:06:46 2003
From: dmurdoch at pair.com (Duncan Murdoch)
Date: Wed Oct 15 13:06:11 2003
Subject: [Rd] NA %*% 0 == 0 (PR#4582)
In-Reply-To: <200310150706.h9F76d0P015637@pubhealth.ku.dk>
References: <200310150706.h9F76d0P015637@pubhealth.ku.dk>
Message-ID: <c2aqov8i1gst26kndkb7rmfjmift8fte38@4ax.com>

On Wed, 15 Oct 2003 09:06:39 +0200 (MET DST), you wrote:


>R-1.8.0: Does not happen for me on WindowsNT4.0 either (self compiled 
>binary, gcc-3.3.1).
>
>
>> Does for me (RedHat, R 1.8.0 and 1.7.0).
>
>
>I guess the problem is compiler-dependend, because I get that "0" in a 
>self-compiled R-1.7.1 (has been compiled with gcc-3.2.?).
>
>Is your binary self-compiled or from CRAN (Duncan Murdoch compiled the 
>CRAN binary with gcc-3.3.1 as well, AFAIK)?

I get it in Win XP with both 1.8.0 (compiled with 3.3.1) and 1.7.1
(compiled with 3.2.x).  I'd guess one of two things:

 - it depends on the runtime library.  (Windows versions use MSVCRT,
but the exact version used depends on the system you're running on.)
This doesn't seem to explain what happens on Linux, does it? 

 - it depends on some uninitialized variable.  do_matprod is
surprisingly complicated, so I can't tell if this is what's happening.
For some reason Insight won't debug that function properly.

Duncan Murdoch

From ripley at stats.ox.ac.uk  Wed Oct 15 13:50:01 2003
From: ripley at stats.ox.ac.uk (Prof Brian D Ripley)
Date: Wed Oct 15 13:49:08 2003
Subject: [Rd] NA %*% 0 == 0 (PR#4582)
In-Reply-To: <c2aqov8i1gst26kndkb7rmfjmift8fte38@4ax.com>
Message-ID: <Pine.WNT.4.44.0310151241420.3764-100000@gannet.stats.ox.ac.uk>

non-complex %*% is fundamentally done via a call to dgemm, so the answer is
going to depend on the BLAS library in use.  When Doug Bates introduced
that version of matprod, we did discuss a bit the potential problems of
cases like this.

I've cross-checked, and that _is_ what is going on with my Linux box: try
tracing around the call to dgemm in matprod in array.c.

Brian

On Wed, 15 Oct 2003, Duncan Murdoch wrote:

> On Wed, 15 Oct 2003 09:06:39 +0200 (MET DST), you wrote:
>
>
> >R-1.8.0: Does not happen for me on WindowsNT4.0 either (self compiled
> >binary, gcc-3.3.1).
> >
> >
> >> Does for me (RedHat, R 1.8.0 and 1.7.0).
> >
> >
> >I guess the problem is compiler-dependend, because I get that "0" in a
> >self-compiled R-1.7.1 (has been compiled with gcc-3.2.?).
> >
> >Is your binary self-compiled or from CRAN (Duncan Murdoch compiled the
> >CRAN binary with gcc-3.3.1 as well, AFAIK)?
>
> I get it in Win XP with both 1.8.0 (compiled with 3.3.1) and 1.7.1
> (compiled with 3.2.x).  I'd guess one of two things:
>
>  - it depends on the runtime library.  (Windows versions use MSVCRT,
> but the exact version used depends on the system you're running on.)
> This doesn't seem to explain what happens on Linux, does it?
>
>  - it depends on some uninitialized variable.  do_matprod is
> surprisingly complicated, so I can't tell if this is what's happening.
> For some reason Insight won't debug that function properly.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From ripley at stats.ox.ac.uk  Wed Oct 15 13:50:07 2003
From: ripley at stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Wed Oct 15 13:49:23 2003
Subject: [Rd] NA %*% 0 == 0 (PR#4582)
Message-ID: <200310151150.h9FBo70P020421@pubhealth.ku.dk>

non-complex %*% is fundamentally done via a call to dgemm, so the answer is
going to depend on the BLAS library in use.  When Doug Bates introduced
that version of matprod, we did discuss a bit the potential problems of
cases like this.

I've cross-checked, and that _is_ what is going on with my Linux box: try
tracing around the call to dgemm in matprod in array.c.

Brian

On Wed, 15 Oct 2003, Duncan Murdoch wrote:

> On Wed, 15 Oct 2003 09:06:39 +0200 (MET DST), you wrote:
>
>
> >R-1.8.0: Does not happen for me on WindowsNT4.0 either (self compiled
> >binary, gcc-3.3.1).
> >
> >
> >> Does for me (RedHat, R 1.8.0 and 1.7.0).
> >
> >
> >I guess the problem is compiler-dependend, because I get that "0" in a
> >self-compiled R-1.7.1 (has been compiled with gcc-3.2.?).
> >
> >Is your binary self-compiled or from CRAN (Duncan Murdoch compiled the
> >CRAN binary with gcc-3.3.1 as well, AFAIK)?
>
> I get it in Win XP with both 1.8.0 (compiled with 3.3.1) and 1.7.1
> (compiled with 3.2.x).  I'd guess one of two things:
>
>  - it depends on the runtime library.  (Windows versions use MSVCRT,
> but the exact version used depends on the system you're running on.)
> This doesn't seem to explain what happens on Linux, does it?
>
>  - it depends on some uninitialized variable.  do_matprod is
> surprisingly complicated, so I can't tell if this is what's happening.
> For some reason Insight won't debug that function properly.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From ligges at statistik.uni-dortmund.de  Wed Oct 15 14:02:52 2003
From: ligges at statistik.uni-dortmund.de (Uwe Ligges)
Date: Wed Oct 15 14:00:44 2003
Subject: [Rd] NA %*% 0 == 0 (PR#4582)
In-Reply-To: <Pine.WNT.4.44.0310151241420.3764-100000@gannet.stats.ox.ac.uk>
References: <Pine.WNT.4.44.0310151241420.3764-100000@gannet.stats.ox.ac.uk>
Message-ID: <3F8D376C.7040801@statistik.uni-dortmund.de>

Prof Brian D Ripley wrote:
> non-complex %*% is fundamentally done via a call to dgemm, so the answer is
> going to depend on the BLAS library in use.  When Doug Bates introduced
> that version of matprod, we did discuss a bit the potential problems of
> cases like this.
> 
> I've cross-checked, and that _is_ what is going on with my Linux box: try
> tracing around the call to dgemm in matprod in array.c.
> 
> Brian

You are right!
Indeed, I used the ATLAS (Athlon) optimized Rblas.dll (that one you 
provide on CRAN) for R-1.8.0 and R's default Rblas.dll under R-1.7.1.
Using the other version of Rblas.dll changes the outcomes.

So I get "0" for default Rblas.dll, and NA for the Athlon optimzed one.

Uwe Ligges


> On Wed, 15 Oct 2003, Duncan Murdoch wrote:
> 
> 
>>On Wed, 15 Oct 2003 09:06:39 +0200 (MET DST), you wrote:
>>
>>
>>
>>>R-1.8.0: Does not happen for me on WindowsNT4.0 either (self compiled
>>>binary, gcc-3.3.1).
>>>
>>>
>>>
>>>>Does for me (RedHat, R 1.8.0 and 1.7.0).
>>>
>>>
>>>I guess the problem is compiler-dependend, because I get that "0" in a
>>>self-compiled R-1.7.1 (has been compiled with gcc-3.2.?).
>>>
>>>Is your binary self-compiled or from CRAN (Duncan Murdoch compiled the
>>>CRAN binary with gcc-3.3.1 as well, AFAIK)?
>>
>>I get it in Win XP with both 1.8.0 (compiled with 3.3.1) and 1.7.1
>>(compiled with 3.2.x).  I'd guess one of two things:
>>
>> - it depends on the runtime library.  (Windows versions use MSVCRT,
>>but the exact version used depends on the system you're running on.)
>>This doesn't seem to explain what happens on Linux, does it?
>>
>> - it depends on some uninitialized variable.  do_matprod is
>>surprisingly complicated, so I can't tell if this is what's happening.
>>For some reason Insight won't debug that function properly.
> 
>

From jmc at research.bell-labs.com  Wed Oct 15 22:29:22 2003
From: jmc at research.bell-labs.com (John Chambers)
Date: Wed Oct 15 22:28:42 2003
Subject: [Rd] Infinite recursion in getGeneric (PR#4561)
References: <200310131616.h9DGGM0P018070@pubhealth.ku.dk>
	<3F8B086A.7D86C08D@research.bell-labs.com>
Message-ID: <3F8DAE22.95B39FC2@research.bell-labs.com>

John Chambers wrote:
> 
> saikat@stat.wisc.edu wrote:
> >
> >  > setClass('foo')
> > [1] "foo"
> >  > setMethod('is.logical', 'foo', function(x) TRUE)
> > [1] "is.logical"
> >  > getGeneric('is.integer')
> > Error in options(x) : evaluation is nested too deeply: infinite
> > recursion?
> 
> This is one of a number of potential problems when methods are specified
> for  primitive functions used in the R code that dispatches methods.
> 
> There is a fix for this particular example -- I will commit it to
> r-patched.

Committed to r-patched.

> 
> However, the only real safety will come when primitives are not
> dispatched from a global structure (a change planned for 1.9).  Then the
> version of primitives used in method dispatch can be separated from any
> methods defined in a different namespace.
> 
> For example, a quick test showed that even after the above fix, setting
> methods for "is.null" causes similar problems.

A list of primitives has been set up that are known or suspected to
cause this sort of problem (is.null, is.primitive, is.function,
is.object).  Until the general fix is in place, an attempt to set
methods for these functions will cause an error.

If you encounter any other primitives that produce symptoms such as
above (an "evaluation nested" error after setting a method for the
function), please report them.

John

-- 
John M. Chambers                  jmc@bell-labs.com
Bell Labs, Lucent Technologies    office: (908)582-2681
700 Mountain Avenue, Room 2C-282  fax:    (908)582-3340
Murray Hill, NJ  07974            web: http://www.cs.bell-labs.com/~jmc

From maechler at stat.math.ethz.ch  Wed Oct 15 23:48:03 2003
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Wed Oct 15 23:47:06 2003
Subject: [Rd] qqnorm(*, datax=TRUE, xlab,ylab) -- S+ compatibility problem 
Message-ID: <16269.49299.137092.141018@gargle.gargle.HOWL>

Just found because an old (written for S+) function of mine did 
label plots wrongly with R.

Example --- inspired from  example(qqnorm) ---

  data(precip)
  qqnorm(precip, ylab = "Precipitation [in/yr] ...")
  qqnorm(precip, ylab = "Precipitation [in/yr] ...", datax = TRUE)

this is all "fine" -- `datax' is a switch that just switches the
axes but keeps the meaning of "ylab labels the data axis"
(i.e, when changing datax from FALSE to TRUE, you don't have to
 switch xlab and ylab in your call).

Unfortunately,  S+ (6.1) does this differently, 
namely with the logic of  "ylab labels the y-axis",
i.e. the last line above would have to be written

  qqnorm(precip, xlab = "Precipitation [in/yr] ...", datax = TRUE)
  ##            _^_

for S+ to produce the same (well analogous) plot.

Since, the `datax' extension was only introduced for R 1.7.0,
with
NEWS>  o  qqnorm() and qqline() have an optional logical argument
NEWS> 	  `datax' to transpose the plot (S-PLUS compatibility).
                                         ^^^^^^^^^^^^^^^^^^^^
we could consider changing R's behavior here 
--- unfortunately not back-compatibly.

Opinions?

Martin Maechler <maechler@stat.math.ethz.ch>	http://stat.ethz.ch/~maechler/
Seminar fuer Statistik, ETH-Zentrum  LEO C16	Leonhardstr. 27
ETH (Federal Inst. Technology)	8092 Zurich	SWITZERLAND
phone: x-41-1-632-3408		fax: ...-1228			<><

From bates at stat.wisc.edu  Thu Oct 16 16:49:07 2003
From: bates at stat.wisc.edu (Douglas Bates)
Date: Thu Oct 16 16:48:42 2003
Subject: [Rd] Details section of image.Rd
Message-ID: <6roewhp7a4.fsf@bates4.stat.wisc.edu>

I am having trouble understanding the details section of the man page
for image, especially the sentence

     The length of 'x' should be equal to the 'nrow(x)+1' or 'nrow(x)'.

Should nrow(x) be nrow(z), as indicated by this error message from
image.default

	dimensions of z are not length(x)(+1) times length(y)(+1)

From dj at research.bell-labs.com  Thu Oct 16 20:10:29 2003
From: dj at research.bell-labs.com (David James)
Date: Thu Oct 16 20:09:41 2003
Subject: [Rd] data() misbehaving inside a function
Message-ID: <20031016141029.A22651@jessie.research.bell-labs.com>

Calls of the form data(package = pkg) inside a function 
incorrectly fail ("pkg" is a local variable).  For instance,

   foo <- function(pkg) data(package = pkg)
   foo("base")
   Error in .find.package(package, lib.loc, verbose = verbose) :
           none of the packages were found

   ## workaround -- force argument "package" to be an expression
   ## (not a name)

   foo <- function(pkg) data(package = as.character(pkg))
   all.equal(data(package = "base"), foo("base"))
   [1] TRUE

The cause is the following piece of code inside data()

    > print(data)
    .... 
    if (!missing(package))
               if (is.name(y <- substitute(package)))
                              package <- as.character(y)
    ...

namely, when data() is invoked from within a function, e.g.,
data(package = pkg), the argument "package" inside data() is indeed
a name, but not one that should be coerced to character as when one
types data(base) from the R prompt, but rather simply a variable
in the calling function; in the example above, the arg "package"
to data() is effectively computed to be "pkg", which (luckily)
does not correspond to any attached package.

version
       _
platform i686-pc-linux-gnu
arch     i686
os       linux-gnu
system   i686, linux-gnu
status   Patched
major    1
minor    8.0
year     2003
month    10
day      13
language R

-- 
David A. James
Statistics Research, Room 2C-253            Phone:  (908) 582-3082       
Bell Labs, Lucent Technologies              Fax:    (908) 582-3340
Murray Hill, NJ 09794-0636

From mckay at repsac.gmr.com  Thu Oct 16 20:30:20 2003
From: mckay at repsac.gmr.com (Neil McKay)
Date: Thu Oct 16 20:33:23 2003
Subject: [Rd] R scripting patches for R-1.8.0
Message-ID: <200310161830.h9GIULc09505@repsac.gmr.com>

I've updated my scripting patches to R-1.8.0. These patches
allow you to write shell scripts in R (at least on *nix systems)
by putting

#!/path/to/R.bin --script

on the first line of the script file. If you're interested
in the patches, e-mail me at

	mckay@gmr.com

-- 
Neil D. McKay, Mail Code 480-106-359    Phone: (586)986-1470 (GM:8-226-1470)
Manufacturing Systems Research Lab      FAX:   (586)986-0574 (GM:8-226-0574)
GM Research & Development Center        Internet e-mail: mckay@gmr.com
30500 Mound Road
Warren, Mich. 48090

From p.dalgaard at biostat.ku.dk  Thu Oct 16 21:08:27 2003
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Thu Oct 16 21:05:14 2003
Subject: [Rd] data() misbehaving inside a function
In-Reply-To: <20031016141029.A22651@jessie.research.bell-labs.com>
References: <20031016141029.A22651@jessie.research.bell-labs.com>
Message-ID: <x2u169ngpg.fsf@biostat.ku.dk>

David James <dj@research.bell-labs.com> writes:

> Calls of the form data(package = pkg) inside a function 
> incorrectly fail ("pkg" is a local variable).  For instance,
> 
>    foo <- function(pkg) data(package = pkg)
>    foo("base")
>    Error in .find.package(package, lib.loc, verbose = verbose) :
>            none of the packages were found

This is pretty much unavoidable if you want a function to accept
unquoted names. It's not in principle different from

women <- "airquality"
data(women)

not being equivalent to data("airquality"). Some functions (library(),
require(), demo()) have a character.only argument to prevent it, and I
suppose we should consider putting it on help() and data() as well.
Meanwhile, my preferred device is

foo <- function(pkg) eval(substitute(data(package)))

        -p

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From ripley at stats.ox.ac.uk  Thu Oct 16 21:06:44 2003
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu Oct 16 21:05:50 2003
Subject: [Rd] data() misbehaving inside a function
In-Reply-To: <20031016141029.A22651@jessie.research.bell-labs.com>
Message-ID: <Pine.LNX.4.44.0310162000330.8820-100000@gannet.stats>

Yes, but this is not to do with being inside a function:

pkg <- "base"
data(package=pkg)

ilustrates it, and library etc behave in the same way (except
library can make use of character.only = TRUE).

You can use substitute, too, as in

foo <- function(pkg) eval(substitute(data(package = pkg), list(pkg=pkg)))


On Thu, 16 Oct 2003, David James wrote:

> Calls of the form data(package = pkg) inside a function 
> incorrectly fail ("pkg" is a local variable).  For instance,
> 
>    foo <- function(pkg) data(package = pkg)
>    foo("base")
>    Error in .find.package(package, lib.loc, verbose = verbose) :
>            none of the packages were found
> 
>    ## workaround -- force argument "package" to be an expression
>    ## (not a name)
> 
>    foo <- function(pkg) data(package = as.character(pkg))
>    all.equal(data(package = "base"), foo("base"))
>    [1] TRUE
> 
> The cause is the following piece of code inside data()
> 
>     > print(data)
>     .... 
>     if (!missing(package))
>                if (is.name(y <- substitute(package)))
>                               package <- as.character(y)
>     ...
> 
> namely, when data() is invoked from within a function, e.g.,
> data(package = pkg), the argument "package" inside data() is indeed
> a name, but not one that should be coerced to character as when one
> types data(base) from the R prompt, but rather simply a variable
> in the calling function; in the example above, the arg "package"
> to data() is effectively computed to be "pkg", which (luckily)
> does not correspond to any attached package.
> 
> version
>        _
> platform i686-pc-linux-gnu
> arch     i686
> os       linux-gnu
> system   i686, linux-gnu
> status   Patched
> major    1
> minor    8.0
> year     2003
> month    10
> day      13
> language R
> 
> 

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From p.dalgaard at biostat.ku.dk  Thu Oct 16 21:12:38 2003
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Thu Oct 16 21:09:22 2003
Subject: [Rd] data() misbehaving inside a function
In-Reply-To: <x2u169ngpg.fsf@biostat.ku.dk>
References: <20031016141029.A22651@jessie.research.bell-labs.com>
	<x2u169ngpg.fsf@biostat.ku.dk>
Message-ID: <x2ptgxngih.fsf@biostat.ku.dk>

Peter Dalgaard <p.dalgaard@biostat.ku.dk> writes:

> foo <- function(pkg) eval(substitute(data(package)))
                                            ^^^^^^^
Doh. "pkg", of course.

        -p
-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From kleiweg at let.rug.nl  Thu Oct 16 22:34:13 2003
From: kleiweg at let.rug.nl (Peter Kleiweg)
Date: Thu Oct 16 22:33:19 2003
Subject: [Rd] R scripting patches for R-1.8.0
In-Reply-To: <200310161830.h9GIULc09505@repsac.gmr.com>
Message-ID: <Pine.LNX.4.44.0310162232390.1139-100000@kleigh.nl>

# aldus Neil McKay :

> I've updated my scripting patches to R-1.8.0. These patches
> allow you to write shell scripts in R (at least on *nix systems)
> by putting
>
> #!/path/to/R.bin --script
>
> on the first line of the script file. If you're interested

I think this is very useful. Would the developpers consider
including this feature into R?


-- 
Peter Kleiweg
http://www.let.rug.nl/~kleiweg/

From duncan at research.bell-labs.com  Thu Oct 16 23:05:29 2003
From: duncan at research.bell-labs.com (Duncan Temple Lang)
Date: Thu Oct 16 23:04:45 2003
Subject: [Rd] R scripting patches for R-1.8.0
In-Reply-To: <Pine.LNX.4.44.0310162232390.1139-100000@kleigh.nl>;
	from kleiweg@let.rug.nl on Thu, Oct 16, 2003 at 10:34:13PM +0200
References: <200310161830.h9GIULc09505@repsac.gmr.com>
	<Pine.LNX.4.44.0310162232390.1139-100000@kleigh.nl>
Message-ID: <20031016170529.B9019@jessie.research.bell-labs.com>

Peter Kleiweg wrote:
> # aldus Neil McKay :
> 
> > I've updated my scripting patches to R-1.8.0. These patches
> > allow you to write shell scripts in R (at least on *nix systems)
> > by putting
> >
> > #!/path/to/R.bin --script
> >
> > on the first line of the script file. If you're interested
> 
> I think this is very useful. Would the developpers consider
> including this feature into R?


Yes, indeed. And I have done some work.  The hesitation is that we are
also trying to integrate it with other ways of initializing R and
moving things to use more R code so that it is easier to
customize/extend.  And I feel it is better to get this right once
rather than shoving this in now on different platforms and making it
more difficult to do the general approach in the future.  Getting it
to behave on different platforms is time consuming and best done once.

 D.



> 
> 
> -- 
> Peter Kleiweg
> http://www.let.rug.nl/~kleiweg/
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://www.stat.math.ethz.ch/mailman/listinfo/r-devel

-- 
_______________________________________________________________

Duncan Temple Lang                duncan@research.bell-labs.com
Bell Labs, Lucent Technologies    office: (908)582-3217
700 Mountain Avenue, Room 2C-259  fax:    (908)582-3340
Murray Hill, NJ  07974-2070       
         http://cm.bell-labs.com/stat/duncan

From Kurt.Hornik at wu-wien.ac.at  Fri Oct 17 09:04:40 2003
From: Kurt.Hornik at wu-wien.ac.at (Kurt Hornik)
Date: Fri Oct 17 09:05:51 2003
Subject: [Rd] data() misbehaving inside a function
In-Reply-To: <x2u169ngpg.fsf@biostat.ku.dk>
References: <20031016141029.A22651@jessie.research.bell-labs.com>
	<x2u169ngpg.fsf@biostat.ku.dk>
Message-ID: <16271.38024.30026.993340@mithrandir.hornik.net>

>>>>> Peter Dalgaard writes:

> David James <dj@research.bell-labs.com> writes:
>> Calls of the form data(package = pkg) inside a function 
>> incorrectly fail ("pkg" is a local variable).  For instance,
>> 
>> foo <- function(pkg) data(package = pkg)
>> foo("base")
>> Error in .find.package(package, lib.loc, verbose = verbose) :
>> none of the packages were found

> This is pretty much unavoidable if you want a function to accept
> unquoted names. It's not in principle different from

> women <- "airquality"
> data(women)

> not being equivalent to data("airquality"). Some functions (library(),
> require(), demo()) have a character.only argument to prevent it, and I
> suppose we should consider putting it on help() and data() as well.

Or get rid of non-standard evaluation and educate users to use quoted
strings where strings should be used.

-k

From maechler at stat.math.ethz.ch  Fri Oct 17 09:28:59 2003
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Fri Oct 17 09:28:05 2003
Subject: [Rd] data() misbehaving inside a function
In-Reply-To: <16271.38024.30026.993340@mithrandir.hornik.net>
References: <20031016141029.A22651@jessie.research.bell-labs.com>
	<x2u169ngpg.fsf@biostat.ku.dk>
	<16271.38024.30026.993340@mithrandir.hornik.net>
Message-ID: <16271.39483.58310.535259@gargle.gargle.HOWL>

>>>>> "KH" == Kurt Hornik <Kurt.Hornik@wu-wien.ac.at>
>>>>>     on Fri, 17 Oct 2003 09:04:40 +0200 writes:

>>>>> Peter Dalgaard writes:
    >> David James <dj@research.bell-labs.com> writes:
    >>> Calls of the form data(package = pkg) inside a function 
    >>> incorrectly fail ("pkg" is a local variable).  For instance,
    >>> 
    >>> foo <- function(pkg) data(package = pkg)
    >>> foo("base")
    >>> Error in .find.package(package, lib.loc, verbose = verbose) :
    >>> none of the packages were found

    >> This is pretty much unavoidable if you want a function to accept
    >> unquoted names. It's not in principle different from

    >> women <- "airquality"
    >> data(women)

    >> not being equivalent to data("airquality"). Some functions (library(),
    >> require(), demo()) have a character.only argument to prevent it, and I
    >> suppose we should consider putting it on help() and data() as well.

    KH> Or get rid of non-standard evaluation and educate users to use quoted
    KH> strings where strings should be used.

and infuriate those who know and used the S language for more
than 15 years, where  help(help)  has always worked? 

Definitely not worth the pain (I *know* I'd hear ... comments from them!)!
I'd go for adding `character.only'.

Martin

From Kurt.Hornik at wu-wien.ac.at  Fri Oct 17 09:35:49 2003
From: Kurt.Hornik at wu-wien.ac.at (Kurt Hornik)
Date: Fri Oct 17 09:37:08 2003
Subject: [Rd] data() misbehaving inside a function
In-Reply-To: <16271.39483.58310.535259@gargle.gargle.HOWL>
References: <20031016141029.A22651@jessie.research.bell-labs.com>
	<x2u169ngpg.fsf@biostat.ku.dk>
	<16271.38024.30026.993340@mithrandir.hornik.net>
	<16271.39483.58310.535259@gargle.gargle.HOWL>
Message-ID: <16271.39893.702849.859781@mithrandir.hornik.net>

>>>>> Martin Maechler writes:

>>>>> "KH" == Kurt Hornik <Kurt.Hornik@wu-wien.ac.at>
>>>>>     on Fri, 17 Oct 2003 09:04:40 +0200 writes:

>>>>> Peter Dalgaard writes:
>>> David James <dj@research.bell-labs.com> writes:
>>>> Calls of the form data(package = pkg) inside a function 
>>>> incorrectly fail ("pkg" is a local variable).  For instance,
>>>> 
>>>> foo <- function(pkg) data(package = pkg)
>>>> foo("base")
>>>> Error in .find.package(package, lib.loc, verbose = verbose) :
>>>> none of the packages were found

>>> This is pretty much unavoidable if you want a function to accept
>>> unquoted names. It's not in principle different from

>>> women <- "airquality"
>>> data(women)

>>> not being equivalent to data("airquality"). Some functions (library(),
>>> require(), demo()) have a character.only argument to prevent it, and I
>>> suppose we should consider putting it on help() and data() as well.

KH> Or get rid of non-standard evaluation and educate users to use quoted
KH> strings where strings should be used.

> and infuriate those who know and used the S language for more than 15
> years, where help(help) has always worked?

I would think that these users either click themselves to happiness, or
use ? because it is shorter.

> Definitely not worth the pain (I *know* I'd hear ... comments from
> them!)!  I'd go for adding `character.only'.

Actually, I do think it is worth the pain.  The way I understand it, we
have a strategic decision to gradually eliminate non-standard eval.

-k

From rossini at blindglobe.net  Fri Oct 17 09:50:50 2003
From: rossini at blindglobe.net (A.J. Rossini)
Date: Fri Oct 17 09:49:32 2003
Subject: [Rd] data() misbehaving inside a function
In-Reply-To: <16271.39893.702849.859781@mithrandir.hornik.net> (Kurt
	Hornik's message of "Fri, 17 Oct 2003 09:35:49 +0200")
References: <20031016141029.A22651@jessie.research.bell-labs.com>
	<x2u169ngpg.fsf@biostat.ku.dk>
	<16271.38024.30026.993340@mithrandir.hornik.net>
	<16271.39483.58310.535259@gargle.gargle.HOWL>
	<16271.39893.702849.859781@mithrandir.hornik.net>
Message-ID: <85ptgwuwth.fsf@blindglobe.net>

Kurt Hornik <Kurt.Hornik@wu-wien.ac.at> writes:

  <Martin wrote re dropping unquoted function args from packages/data>

>> Definitely not worth the pain (I *know* I'd hear ... comments from
>> them!)!  

I might be one of them.  You'll hear my screams for weeks...

> Actually, I do think it is worth the pain.  The way I understand it, we
> have a strategic decision to gradually eliminate non-standard eval.

and for better or worse, I actually agree with Kurt.  Most languages
don't let you do non-standard eval regularly, and in R/S, it is used
"regularly".  I don't think that the added complexity is worth the
convenience of saving 2 keystrokes. 

best,
-tony

-- 
rossini@u.washington.edu            http://www.analytics.washington.edu/ 
Biomedical and Health Informatics   University of Washington
Biostatistics, SCHARP/HVTN          Fred Hutchinson Cancer Research Center
UW (Tu/Th/F): 206-616-7630 FAX=206-543-3461 | Voicemail is unreliable
FHCRC  (M/W): 206-667-7025 FAX=206-667-4812 | use Email

CONFIDENTIALITY NOTICE: This e-mail message and any attachme...{{dropped}}

From p.dalgaard at biostat.ku.dk  Fri Oct 17 09:54:41 2003
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Fri Oct 17 09:51:26 2003
Subject: [Rd] data() misbehaving inside a function
In-Reply-To: <16271.39893.702849.859781@mithrandir.hornik.net>
References: <20031016141029.A22651@jessie.research.bell-labs.com>
	<x2u169ngpg.fsf@biostat.ku.dk>
	<16271.38024.30026.993340@mithrandir.hornik.net>
	<16271.39483.58310.535259@gargle.gargle.HOWL>
	<16271.39893.702849.859781@mithrandir.hornik.net>
Message-ID: <x2ad80nvsu.fsf@biostat.ku.dk>

Kurt Hornik <Kurt.Hornik@wu-wien.ac.at> writes:

> KH> Or get rid of non-standard evaluation and educate users to use quoted
> KH> strings where strings should be used.
> 
> > and infuriate those who know and used the S language for more than 15
> > years, where help(help) has always worked?
> 
> I would think that these users either click themselves to happiness, or
> use ? because it is shorter.

Ummm, ?help is another non-standard eval. "?" is an operator,
operators work on objects not (normally) their names....

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From Kurt.Hornik at wu-wien.ac.at  Fri Oct 17 09:51:54 2003
From: Kurt.Hornik at wu-wien.ac.at (Kurt Hornik)
Date: Fri Oct 17 09:54:10 2003
Subject: [Rd] data() misbehaving inside a function
In-Reply-To: <85ptgwuwth.fsf@blindglobe.net>
References: <20031016141029.A22651@jessie.research.bell-labs.com>
	<x2u169ngpg.fsf@biostat.ku.dk>
	<16271.38024.30026.993340@mithrandir.hornik.net>
	<16271.39483.58310.535259@gargle.gargle.HOWL>
	<16271.39893.702849.859781@mithrandir.hornik.net>
	<85ptgwuwth.fsf@blindglobe.net>
Message-ID: <16271.40858.42254.407785@mithrandir.hornik.net>

>>>>> A J Rossini writes:

> Kurt Hornik <Kurt.Hornik@wu-wien.ac.at> writes:
>   <Martin wrote re dropping unquoted function args from packages/data>

>>> Definitely not worth the pain (I *know* I'd hear ... comments from
>>> them!)!  

> I might be one of them.  You'll hear my screams for weeks...

[Fortunately, you're mostly in Seattle ...]

>> Actually, I do think it is worth the pain.  The way I understand it, we
>> have a strategic decision to gradually eliminate non-standard eval.

> and for better or worse, I actually agree with Kurt.  Most languages
> don't let you do non-standard eval regularly, and in R/S, it is used
> "regularly".  I don't think that the added complexity is worth the
> convenience of saving 2 keystrokes.

:-)

-k

From Kurt.Hornik at wu-wien.ac.at  Fri Oct 17 09:53:33 2003
From: Kurt.Hornik at wu-wien.ac.at (Kurt Hornik)
Date: Fri Oct 17 09:55:09 2003
Subject: [Rd] data() misbehaving inside a function
In-Reply-To: <x2ad80nvsu.fsf@biostat.ku.dk>
References: <20031016141029.A22651@jessie.research.bell-labs.com>
	<x2u169ngpg.fsf@biostat.ku.dk>
	<16271.38024.30026.993340@mithrandir.hornik.net>
	<16271.39483.58310.535259@gargle.gargle.HOWL>
	<16271.39893.702849.859781@mithrandir.hornik.net>
	<x2ad80nvsu.fsf@biostat.ku.dk>
Message-ID: <16271.40957.398812.546319@mithrandir.hornik.net>

>>>>> Peter Dalgaard writes:

> Kurt Hornik <Kurt.Hornik@wu-wien.ac.at> writes:
KH> Or get rid of non-standard evaluation and educate users to use quoted
KH> strings where strings should be used.
>> 
>> > and infuriate those who know and used the S language for more than 15
>> > years, where help(help) has always worked?
>> 
>> I would think that these users either click themselves to happiness, or
>> use ? because it is shorter.

> Ummm, ?help is another non-standard eval. "?" is an operator,
> operators work on objects not (normally) their names....

Right.  I had meant to say that if we need non-standard eval, let's have
it for ?, where we need it for things like method ? expression anyways,
but let's eliminate it from help().

-k

From smyth at wehi.edu.au  Fri Oct 17 10:12:34 2003
From: smyth at wehi.edu.au (Gordon Smyth)
Date: Fri Oct 17 10:11:44 2003
Subject: [Rd] data() misbehaving inside a function
In-Reply-To: <85ptgwuwth.fsf@blindglobe.net>
References: <16271.39893.702849.859781@mithrandir.hornik.net>
	<20031016141029.A22651@jessie.research.bell-labs.com>
	<x2u169ngpg.fsf@biostat.ku.dk>
	<16271.38024.30026.993340@mithrandir.hornik.net>
	<16271.39483.58310.535259@gargle.gargle.HOWL>
	<16271.39893.702849.859781@mithrandir.hornik.net>
Message-ID: <5.2.1.1.1.20031017180421.0464c548@imaphost.wehi.edu.au>

At 05:50 PM 17/10/2003, A.J. Rossini wrote:
>Kurt Hornik <Kurt.Hornik@wu-wien.ac.at> writes:
>
>   <Martin wrote re dropping unquoted function args from packages/data>
>
> >> Definitely not worth the pain (I *know* I'd hear ... comments from
> >> them!)!
>
>I might be one of them.  You'll hear my screams for weeks...
>
> > Actually, I do think it is worth the pain.  The way I understand it, we
> > have a strategic decision to gradually eliminate non-standard eval.
>
>and for better or worse, I actually agree with Kurt.  Most languages
>don't let you do non-standard eval regularly, and in R/S, it is used
>"regularly".  I don't think that the added complexity is worth the
>convenience of saving 2 keystrokes.

For what it's worth, I'd add my voice to Kurt and Tony. Even though I've 
been an S user for 17 years, I still find it weird that

poisson(link=log)

works but

a <- "log"; poisson(link=a)

doesn't given that the help doc says

poisson(link="log")

Gordon

>best,
>-tony

From ehsaliba at uncc.edu  Fri Oct 17 15:41:09 2003
From: ehsaliba at uncc.edu (ehsaliba@uncc.edu)
Date: Fri Oct 17 15:40:11 2003
Subject: [Rd] Bus error (PR#4623)
Message-ID: <200310171341.h9HDf90P018354@pubhealth.ku.dk>

Full_Name: Elie Saliba
Version: 1.8.0
OS: Solaris 9
Submission from: (NULL) (152.15.81.169)


Hello,

We just compiled R 1.8.0 using gcc 3.2.2 (32 bit) without any error messages but
then
when we try to run it, it dumps a core when using something like plot and so
on.
(i.e, R>plot(rnorm(100),rnorm(100))

The error message is "Bus Error"

Any suggstions on how to fix this problem would be greatly appreciated.

Thanks,
ehsaliba@uncc.edu

From tlumley at u.washington.edu  Fri Oct 17 15:46:14 2003
From: tlumley at u.washington.edu (Thomas Lumley)
Date: Fri Oct 17 15:45:17 2003
Subject: [Rd] data() misbehaving inside a function
In-Reply-To: <16271.40957.398812.546319@mithrandir.hornik.net>
References: <20031016141029.A22651@jessie.research.bell-labs.com>
	<x2u169ngpg.fsf@biostat.ku.dk>
	<16271.38024.30026.993340@mithrandir.hornik.net>
	<16271.39483.58310.535259@gargle.gargle.HOWL>
	<16271.39893.702849.859781@mithrandir.hornik.net>
	<x2ad80nvsu.fsf@biostat.ku.dk>
	<16271.40957.398812.546319@mithrandir.hornik.net>
Message-ID: <Pine.A41.4.58.0310170644370.180024@homer07.u.washington.edu>

On Fri, 17 Oct 2003, Kurt Hornik wrote:

> >>>>> Peter Dalgaard writes:
>
> > Kurt Hornik <Kurt.Hornik@wu-wien.ac.at> writes:
> KH> Or get rid of non-standard evaluation and educate users to use quoted
> KH> strings where strings should be used.
> >>
> >> > and infuriate those who know and used the S language for more than 15
> >> > years, where help(help) has always worked?
> >>

help(help) might be unavoidable, but there is nothing incompatible with S
about requiring the argument to data() to be quoted, and that was what the
original question was about.


	-thomas

From pgilbert at bank-banque-canada.ca  Fri Oct 17 15:48:27 2003
From: pgilbert at bank-banque-canada.ca (Paul Gilbert)
Date: Fri Oct 17 15:47:43 2003
Subject: [Rd] Bus error (PR#4623)
In-Reply-To: <200310171341.h9HDf90P018354@pubhealth.ku.dk>
References: <200310171341.h9HDf90P018354@pubhealth.ku.dk>
Message-ID: <3F8FF32B.2080807@bank-banque-canada.ca>

This is a known problem with gcc 3.2.2 (not with R, though it  is 
mentioned in the R documention). You need at least gcc 3.2.3 (or stick 
with the gcc 2.x series) on Solaris.

Paul Gilbert

ehsaliba@uncc.edu wrote:
> Full_Name: Elie Saliba
> Version: 1.8.0
> OS: Solaris 9
> Submission from: (NULL) (152.15.81.169)
> 
> 
> Hello,
> 
> We just compiled R 1.8.0 using gcc 3.2.2 (32 bit) without any error messages but
> then
> when we try to run it, it dumps a core when using something like plot and so
> on.
> (i.e, R>plot(rnorm(100),rnorm(100))
> 
> The error message is "Bus Error"
> 
> Any suggstions on how to fix this problem would be greatly appreciated.
> 
> Thanks,
> ehsaliba@uncc.edu
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://www.stat.math.ethz.ch/mailman/listinfo/r-devel
>

From ripley at stats.ox.ac.uk  Fri Oct 17 16:04:55 2003
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri Oct 17 16:04:20 2003
Subject: [Rd] Bus error (PR#4623)
In-Reply-To: <3F8FF32B.2080807@bank-banque-canada.ca>
Message-ID: <Pine.LNX.4.44.0310171503200.1203-100000@gannet.stats>

On Fri, 17 Oct 2003, Paul Gilbert wrote:

> This is a known problem with gcc 3.2.2 (not with R, though it  is 
> mentioned in the R documention). You need at least gcc 3.2.3 (or stick 
> with the gcc 2.x series) on Solaris.

Once again, it is a problem only with 32-bit 3.2.1 and 3.2.2, as the
R-admin manual says. 3.0.x and 3.1.x and 3.2 are all fine.

Given that 3.3.1 is now current, it seems strange that so many people are
using 3.2.1/2.

> 
> Paul Gilbert
> 
> ehsaliba@uncc.edu wrote:
> > Full_Name: Elie Saliba
> > Version: 1.8.0
> > OS: Solaris 9
> > Submission from: (NULL) (152.15.81.169)
> > 
> > 
> > Hello,
> > 
> > We just compiled R 1.8.0 using gcc 3.2.2 (32 bit) without any error messages but
> > then
> > when we try to run it, it dumps a core when using something like plot and so
> > on.
> > (i.e, R>plot(rnorm(100),rnorm(100))
> > 
> > The error message is "Bus Error"
> > 
> > Any suggstions on how to fix this problem would be greatly appreciated.
> > 
> > Thanks,
> > ehsaliba@uncc.edu
> > 
> > ______________________________________________
> > R-devel@stat.math.ethz.ch mailing list
> > https://www.stat.math.ethz.ch/mailman/listinfo/r-devel
> >
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://www.stat.math.ethz.ch/mailman/listinfo/r-devel
> 
> 

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From ripley at stats.ox.ac.uk  Fri Oct 17 16:10:22 2003
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri Oct 17 16:09:36 2003
Subject: [Rd] data() misbehaving inside a function
In-Reply-To: <Pine.A41.4.58.0310170644370.180024@homer07.u.washington.edu>
Message-ID: <Pine.LNX.4.44.0310171505050.1203-100000@gannet.stats>

On Fri, 17 Oct 2003, Thomas Lumley wrote:

> On Fri, 17 Oct 2003, Kurt Hornik wrote:
> 
> > >>>>> Peter Dalgaard writes:
> >
> > > Kurt Hornik <Kurt.Hornik@wu-wien.ac.at> writes:
> > KH> Or get rid of non-standard evaluation and educate users to use quoted
> > KH> strings where strings should be used.
> > >>
> > >> > and infuriate those who know and used the S language for more than 15
> > >> > years, where help(help) has always worked?
> > >>
> 
> help(help) might be unavoidable, but there is nothing incompatible with S
> about requiring the argument to data() to be quoted, and that was what the
> original question was about.

It was about the *package* argument to data, and I see no reason at all
why that should be accepted as a name.  We don't allow lib.loc in
library() to be a name, and that seems the closest equivalent.

I think that for back-conmpatibility we do need to allow

?topic
help(topic)
data(dataset)

but could require the package argument to be quoted (note that data has a
list= argument, and help could be given a character.only one).

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From ggrothendieck at myway.com  Fri Oct 17 17:52:03 2003
From: ggrothendieck at myway.com (Gabor Grothendieck)
Date: Fri Oct 17 17:51:44 2003
Subject: [Rd] data() misbehaving inside a function
Message-ID: <20031017155203.8031F3993@xmxpita.myway.com>



There seem to be two opposing yet valid viewpoints to the 
question of doing it right vs. compatibility with S-Plus.
Compatbility with older version of R is a third overlapping
possible goal.

There does not appear to be an overall statement of 
intent in R, but rather, this question and others are 
approached on a case by case basis.

Scoping is an example where R took the first route and the
feature in question is an example of the second.  There 
are undoubtedly many more possible examples.  

One possibility might be to do it right, by default, but have 
a package that, when loaded, gives you S-Plus compatibility (or
visa versa).  This would cover not only this feature but other
features where there was a desire to do it right.  Some things 
that are difficult to implement in two ways, such as scoping, 
would presumably not be handled by this but other simpler items 
such as the one in question could be.

--- 
Date: Fri, 17 Oct 2003 09:28:59 +0200 
From: Martin Maechler <maechler@stat.math.ethz.ch>
[ Add to Address Book | Block Address | Report as Spam ] 
To: <Kurt.Hornik@wu-wien.ac.at> 
Cc: David James <dj@research.bell-labs.com>, <r-devel@r-project.org>,Peter Dalgaard <p.dalgaard@biostat.ku.dk> 
Subject: Re: [Rd] data() misbehaving inside a function 

 
 
>>>>> "KH" == Kurt Hornik <Kurt.Hornik@wu-wien.ac.at>
>>>>> on Fri, 17 Oct 2003 09:04:40 +0200 writes:

>>>>> Peter Dalgaard writes:
>> David James <dj@research.bell-labs.com> writes:
>>> Calls of the form data(package = pkg) inside a function 
>>> incorrectly fail ("pkg" is a local variable). For instance,
>>> 
>>> foo <- function(pkg) data(package = pkg)
>>> foo("base")
>>> Error in .find.package(package, lib.loc, verbose = verbose) :
>>> none of the packages were found

>> This is pretty much unavoidable if you want a function to accept
>> unquoted names. It's not in principle different from

>> women <- "airquality"
>> data(women)

>> not being equivalent to data("airquality"). Some functions (library(),
>> require(), demo()) have a character.only argument to prevent it, and I
>> suppose we should consider putting it on help() and data() as well.

KH> Or get rid of non-standard evaluation and educate users to use quoted
KH> strings where strings should be used.

and infuriate those who know and used the S language for more
than 15 years, where help(help) has always worked? 

Definitely not worth the pain (I *know* I'd hear ... comments from them!)!
I'd go for adding `character.only'.

Martin



_______________________________________________
No banners. No pop-ups. No kidding.
Introducing My Way - http://www.myway.com

From pgilbert at bank-banque-canada.ca  Fri Oct 17 18:31:49 2003
From: pgilbert at bank-banque-canada.ca (Paul Gilbert)
Date: Fri Oct 17 18:31:37 2003
Subject: [Rd] data() misbehaving inside a function
In-Reply-To: <20031017155203.8031F3993@xmxpita.myway.com>
References: <20031017155203.8031F3993@xmxpita.myway.com>
Message-ID: <3F901975.7030209@bank-banque-canada.ca>

Gabor Grothendieck wrote:
> 
> There seem to be two opposing yet valid viewpoints to the 
> question of doing it right vs. compatibility with S-Plus.
> Compatbility with older version of R is a third overlapping
> possible goal.
> 
> There does not appear to be an overall statement of 
> intent in R, but rather, this question and others are 
> approached on a case by case basis.

I think this point was discussed and settled a long time ago. It may 
actually pre-date the mail archives:

1/ Do it right.
2/ If it does not conflict with 1/, have S-plus compatibility.
3/ If back compatibility with older versions of R cannot be maintained 
to accomplish 1/ then make the transition as painless as possible and 
try to isolate the screaming to remote locations like Seattle and Ottawa :).

I would say that eliminating "_" for assignment is a pretty strong 
indication of how much 1/ dominates. The main problem seems to be that 
it sometimes takes awhile to know what "right" is, and in the meantime 
2/ dominates.

Paul Gilbert

From jmc at research.bell-labs.com  Fri Oct 17 22:59:15 2003
From: jmc at research.bell-labs.com (John Chambers)
Date: Fri Oct 17 22:58:30 2003
Subject: [Rd] Bug and fix in ? operator
Message-ID: <3F905823.703F66A4@research.bell-labs.com>

In 1.8, the functional forms of "?" (?f(...) and method?f(...)) were not
finding the generic function & therefore not reporting method
documentation.  Should be fixed in a version of r-patched committed
today.

-- 
John M. Chambers                  jmc@bell-labs.com
Bell Labs, Lucent Technologies    office: (908)582-2681
700 Mountain Avenue, Room 2C-282  fax:    (908)582-3340
Murray Hill, NJ  07974            web: http://www.cs.bell-labs.com/~jmc

From thoffman at zappa.sax.de  Sat Oct 18 12:57:49 2003
From: thoffman at zappa.sax.de (Thomas Hoffmann)
Date: Sat Oct 18 12:43:09 2003
Subject: [Rd] R-1.8.0: Rdconv.in
Message-ID: <3F911CAD.3060609@zappa.sax.de>

I am not quite sure: Isn't the "mac" specifier gone with R-1.7.1: found 
the line below in the file named in the subject:

      --os=NAME        use OS subdir 'NAME' (unix, mac or windows)

Thomas.

-- 
Thomas Hoffmann                                    
thoffman@zappa.sax.de                                   Dresden, Germany

From maechler at stat.math.ethz.ch  Sat Oct 18 16:05:45 2003
From: maechler at stat.math.ethz.ch (maechler@stat.math.ethz.ch)
Date: Sat Oct 18 16:04:44 2003
Subject: [Rd] cor(*,  use = "pair") bug in R 1.8.0 (PR#4646)
Message-ID: <200310181405.h9IE5j0P025578@pubhealth.ku.dk>

As reported on R-help by Ming-Chung Li,
the cor() function has a new bug in R 1.8.0 when used with
matrix arguments (to give the Cor-Matrix) and the non-default	  
      use = "pairwise.complete.obs"
argument (which can be abbreviated, e.g.   to  use = "pair").

A quite minimal example is

  > x <- cbind(1:3, c(0,4,5))
  > cor(x)[1,2]
  [1] 0.9449112
  > cor(x,use="pair")[1,2]
  [1] 0.8858796

This shouldn't have happened, has been my fault, and will be fixed shortly.

Martin Maechler <maechler@stat.math.ethz.ch>	http://stat.ethz.ch/~maechler/
Seminar fuer Statistik, ETH-Zentrum  LEO C16	Leonhardstr. 27
ETH (Federal Inst. Technology)	8092 Zurich	SWITZERLAND
phone: x-41-1-632-3408		fax: ...-1228			<><

From ripley at stats.ox.ac.uk  Sat Oct 18 17:05:37 2003
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Sat Oct 18 17:04:35 2003
Subject: [Rd] Recursive indexing can cause R-1.8.0 (and R-1.7.1) to
	segment fault (PR#4486)
In-Reply-To: <200310092034.h99KYi0P009409@pubhealth.ku.dk>
Message-ID: <Pine.LNX.4.44.0310181550580.4609-100000@gannet.stats>



On Thu, 9 Oct 2003 anaximander@gmx.de wrote:

> Recursive indexing can cause R-1.8.0 (and R-1.7.1) to segment fault
> 
> First of all, many thanks to the R team!!
> R is really a software for everyday work.
> Yes, I've found a fault, but I hope it's not just faultfinding ;-)
> 
> In the NEWS file of R-1.8.0, first printed in R NEWS 1.7.1,
> there was given a promise: [ 1 ]
>   o       Recursive indexing of lists is allowed, so x[[c(4,2)]] is
>           shorthand for x[[4]][[2]] etc.  (Wishlist PR#1588)
> 
> That's not fulfilled in all cases, although there was already a
> code correction in R-1.8.0: [ 2 ]
>    o       Recursive indexing of lists had too little error-checking.
>            (related to PR#3324)

That's not a code correction, that's catching unanticipated user errors.

This report is also user error which is not always caught.

However, please don't say that something has `not been fulfilled' when
it works exactly as documented but punishes misuse too severely.
It really is hard to anticipate just how silly users can be.

> Of coarse, R is not intended to be an ingenious data base program,
> which should be able to handle, let's say, complicated requests 
> like they are possible in SQL-language.
> 
> On the other side, lists are becoming more and more important in R,
> so there *should* be a convenient way to deal with nested lists, shan't it?
> Sure, all of us can avoid such lists in our own data, but we often
> have to use data files from other people with *have* a nested structure.
> (Thats the way I discovered this error.)

> Perhaps we can find a fair compromise?

Yes, would you please not making sweeping statements about R's abilities 
based on its not failing to cope with your own particular errors?
It did report a correct error message at least once!

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From ripley at stats.ox.ac.uk  Sat Oct 18 17:05:36 2003
From: ripley at stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Sat Oct 18 17:04:57 2003
Subject: [Rd] Recursive indexing can cause R-1.8.0 (and R-1.7.1) to
	(PR#4647)
Message-ID: <200310181505.h9IF5a0P025820@pubhealth.ku.dk>



On Thu, 9 Oct 2003 anaximander@gmx.de wrote:

> Recursive indexing can cause R-1.8.0 (and R-1.7.1) to segment fault
> 
> First of all, many thanks to the R team!!
> R is really a software for everyday work.
> Yes, I've found a fault, but I hope it's not just faultfinding ;-)
> 
> In the NEWS file of R-1.8.0, first printed in R NEWS 1.7.1,
> there was given a promise: [ 1 ]
>   o       Recursive indexing of lists is allowed, so x[[c(4,2)]] is
>           shorthand for x[[4]][[2]] etc.  (Wishlist PR#1588)
> 
> That's not fulfilled in all cases, although there was already a
> code correction in R-1.8.0: [ 2 ]
>    o       Recursive indexing of lists had too little error-checking.
>            (related to PR#3324)

That's not a code correction, that's catching unanticipated user errors.

This report is also user error which is not always caught.

However, please don't say that something has `not been fulfilled' when
it works exactly as documented but punishes misuse too severely.
It really is hard to anticipate just how silly users can be.

> Of coarse, R is not intended to be an ingenious data base program,
> which should be able to handle, let's say, complicated requests 
> like they are possible in SQL-language.
> 
> On the other side, lists are becoming more and more important in R,
> so there *should* be a convenient way to deal with nested lists, shan't it?
> Sure, all of us can avoid such lists in our own data, but we often
> have to use data files from other people with *have* a nested structure.
> (Thats the way I discovered this error.)

> Perhaps we can find a fair compromise?

Yes, would you please not making sweeping statements about R's abilities 
based on its not failing to cope with your own particular errors?
It did report a correct error message at least once!

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From xiaopinj at biostat.umn.edu  Sat Oct 18 17:18:39 2003
From: xiaopinj at biostat.umn.edu (xiaopinj@biostat.umn.edu)
Date: Sat Oct 18 17:17:42 2003
Subject: [Rd] R 1.80 version (PR#4648)
Message-ID: <200310181518.h9IFId0P025904@pubhealth.ku.dk>

Full_Name: Xiaoping Jin
Version: 1.80
OS: window xp 
Submission from: (NULL) (24.223.234.248)


I have downloaded R 1.80 recently. I found there was some problems, but I do not
know the reason:

1. I can not do large interation in such new version. For example, 
for( i in 1:36535)
{
if(DAT$age[i]==4) DAT$year3[i]<-DAT$year[i]
}

it seemed to be stuck there, but it computes very quickly in the old version
(such as R 1.40)

2. About RCMD SHLIB command, in such new version, if I use RCMD SHLIB to complie
C program, it will complie all of C program in that directory, although I only
specify one C program.

For example,
RCMD SHLIB weibul.c

but I have dtheta.c in that directory, it will also compile dethea.c.

This does not happen in the old R version.  

Hope you can tell me some reason. Thanks!

From maechler at stat.math.ethz.ch  Sat Oct 18 18:17:14 2003
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Sat Oct 18 18:16:18 2003
Subject: [Rd] Details section of image.Rd
In-Reply-To: <6roewhp7a4.fsf@bates4.stat.wisc.edu>
References: <6roewhp7a4.fsf@bates4.stat.wisc.edu>
Message-ID: <16273.26506.889851.54424@gargle.gargle.HOWL>

>>>>> "DougB" == Douglas Bates <bates@stat.wisc.edu>
>>>>>     on 16 Oct 2003 09:49:07 -0500 writes:

    DougB> I am having trouble understanding the details section
    DougB> of the man page for image, especially the sentence

    DougB>      The length of 'x' should be equal to the
    DougB> 'nrow(x)+1' or 'nrow(x)'.

    DougB> Should nrow(x) be nrow(z), as indicated by this error
    DougB> message from image.default

    DougB> 	dimensions of z are not length(x)(+1) times length(y)(+1)

I'd think that this is a typo and the answer to the question is
"yes" .. (and hence I've just committed the change)

Martin

From deleeuw at stat.ucla.edu  Sat Oct 18 19:27:52 2003
From: deleeuw at stat.ucla.edu (Jan de Leeuw)
Date: Sat Oct 18 19:26:55 2003
Subject: [Rd] libR.dylib on OS X
Message-ID: <672F8BC0-0190-11D8-9A19-000A95A67E82@stat.ucla.edu>

If one installs the CLI and RAqua versions, by saying both "make  
install"
and "make install-aqua", then packages that use libR.dylib get their
symbols from  
/Applications/StartR.app/RAqua.app/Contents/Frameworks/libR.dylib
and not from /usr/local/lib/R/bin/libR.dylib.

That's unfortunate, because the first is likely to change, and the  
second is not.
For instance, what happens if Stefano succeeds in constructing an  
StartR.app
which can sit anywhere on the system (as a Mac application should) ?

Again, these types of problems can be circumvented by putting all of R,
except the CLI and Aqua front ends, in /Library/Frameworks. As in  
MacPython
or in TclTklAqua. If you distribute an installer package, you don't need
a monolithic application, and you avoid useless duplications and  
problems
with hard-coded paths.
===
Jan de Leeuw; Professor and Chair, UCLA Department of Statistics;
Editor: Journal of Multivariate Analysis, Journal of Statistical  
Software
US mail: 8130 Math Sciences Bldg, Box 951554, Los Angeles, CA 90095-1554
phone (310)-825-9550;  fax (310)-206-5658;  email: deleeuw@stat.ucla.edu
homepage: http://gifi.stat.ucla.edu
   
------------------------------------------------------------------------ 
-------------------------
           No matter where you go, there you are. --- Buckaroo Banzai
                    http://gifi.stat.ucla.edu/sounds/nomatter.au

From jago at mclink.it  Sun Oct 19 11:19:33 2003
From: jago at mclink.it (Stefano Iacus)
Date: Sun Oct 19 11:18:33 2003
Subject: [Rd] libR.dylib on OS X
In-Reply-To: <672F8BC0-0190-11D8-9A19-000A95A67E82@stat.ucla.edu>
Message-ID: <5A37345A-0215-11D8-93D2-003065CC4CB8@mclink.it>

Jan,
If you inted to use RAqua as a CLI app you don't need to do "make  
install" but only "make install-aqua" and create a couple of symlinks.  
Otherwise you have conflicts. If you install the RAqua from CRAN and  
apply the symlinks as explained int eh ReadME file you'll have an  
equivalent version R as of installing from sources with make install.

I have discussed a bit with Simon on the relocatable possibility for  
RAqua.
I think we will have something ready for 1.9 and /Library/Frameworks is  
probably a good place.
Having not a monolithic app means that you should also provide a  
un-installer, otherwise dragging RAqua icon into the trashcan only  
removes a couple of bytes but the rest of 50mb still resides in your  
system (the same for user installed packages).

The other problem we are faced is the startup script R, if you move it  
you need to take care of $R_HOME and other similar things. Simon seems  
to have a solution for this.

We will probably be able to use one bumping app only (i.e. only RAqua  
and not the couple of StartR and RAqua).

To summarize: it's in the todo list of R 1.9.0 (as well as the  
eventloop problem which should be a cross platform solution tough).

stefano


On Sabato, ott 18, 2003, at 19:27 Europe/Rome, Jan de Leeuw wrote:

> If one installs the CLI and RAqua versions, by saying both "make  
> install"
> and "make install-aqua", then packages that use libR.dylib get their
> symbols from  
> /Applications/StartR.app/RAqua.app/Contents/Frameworks/libR.dylib
> and not from /usr/local/lib/R/bin/libR.dylib.
>
> That's unfortunate, because the first is likely to change, and the  
> second is not.
> For instance, what happens if Stefano succeeds in constructing an  
> StartR.app
> which can sit anywhere on the system (as a Mac application should) ?
>
> Again, these types of problems can be circumvented by putting all of R,
> except the CLI and Aqua front ends, in /Library/Frameworks. As in  
> MacPython
> or in TclTklAqua. If you distribute an installer package, you don't  
> need
> a monolithic application, and you avoid useless duplications and  
> problems
> with hard-coded paths.
> ===
> Jan de Leeuw; Professor and Chair, UCLA Department of Statistics;
> Editor: Journal of Multivariate Analysis, Journal of Statistical  
> Software
> US mail: 8130 Math Sciences Bldg, Box 951554, Los Angeles, CA  
> 90095-1554
> phone (310)-825-9550;  fax (310)-206-5658;  email:  
> deleeuw@stat.ucla.edu
> homepage: http://gifi.stat.ucla.edu
>   
> ----------------------------------------------------------------------- 
> --------------------------
>           No matter where you go, there you are. --- Buckaroo Banzai
>                    http://gifi.stat.ucla.edu/sounds/nomatter.au
>
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://www.stat.math.ethz.ch/mailman/listinfo/r-devel
>

From len.weil at hs.utc.com  Mon Oct 20 13:54:35 2003
From: len.weil at hs.utc.com (len.weil@hs.utc.com)
Date: Mon Oct 20 13:53:39 2003
Subject: [Rd] Update Packages / help.start() (PR#4681)
Message-ID: <200310201154.h9KBsZ0P013152@pubhealth.ku.dk>

Full_Name: Leonard Weil
Version: 1.8.0
OS: Windows2000 Pro
Submission from: (NULL) (192.249.47.9)


I have encountered two anomalies in version 1.8.0 that I had not observed in
version 1.7.0:

When using the menu Packages -> Update Packages from CRAN,
The console repeats the message twice (example below)

> update.packages()
trying URL `http://cran.r-project.org/bin/windows/contrib/1.8/PACKAGES'
Content type `text/plain; charset=iso-8859-1' length 12608 bytes
opened URL
downloaded 12Kb

lattice :
 Version 0.8-3 in C:/Program Files/R/rw1080/library 
 Version 0.8-7 on CRAN
Update (y/N)?  y
mgcv :
 Version 0.9-3.1 in C:/Program Files/R/rw1080/library 
 Version 0.9-5 on CRAN
Update (y/N)?  y
lattice :
 Version 0.8-3 in C:/PROGRA~1/R/rw1080/library 
 Version 0.8-7 on CRAN
Update (y/N)?  y
mgcv :
 Version 0.9-3.1 in C:/PROGRA~1/R/rw1080/library 
 Version 0.9-5 on CRAN
Update (y/N)?  y
trying URL `http://cran.r-project.org/bin/windows/contrib/1.8/lattice_0.8-7.zip'
Content type `application/zip' length 438509 bytes
opened URL
downloaded 428Kb

trying URL `http://cran.r-project.org/bin/windows/contrib/1.8/mgcv_0.9-5.zip'
Content type `application/zip' length 477360 bytes
opened URL
downloaded 466Kb

and indicates an error message (example below)
package  lattice lattice  successfully unpacked and MD5 sums checked
Error in file(file, "r") : unable to open connection
In addition: Warning messages: 
1: the condition has length > 1 and only the first element will be used in: if
(!file.exists(md5file)) return(NA) 
2: the condition has length > 1 and only the first element will be used in: if
(file == "") file <- stdin() else { 
3: only first element of `description' argument used 
4: cannot open file `lattice/DESCRIPTION'

The packages all work properly.  Message 4 appears with many updates.

When using help.start() to search for information, the references also appear
twice.
The example below uses lrm.fit from the Design package.
Design-internal 
Internal Design functions 
lrm.fit 
Logistic Model Fitter 
Design-internal 
Internal Design functions 
lrm.fit 
Logistic Model Fitter

From len.weil at hs.utc.com  Mon Oct 20 14:17:33 2003
From: len.weil at hs.utc.com (len.weil@hs.utc.com)
Date: Mon Oct 20 14:16:34 2003
Subject: [Rd] Prior bug report by me (PR#4682)
Message-ID: <200310201217.h9KCHX0P013561@pubhealth.ku.dk>

Full_Name: Leonard Weil
Version: 1.8.0
OS: windows2000 Pro
Submission from: (NULL) (192.249.47.9)


I submitted a possible bug report regarding twin appearances of text when
updating packages or using the help.start() system.  Please disregard.  I traced
the problem
to an environment variable that pointed to the library.  After removing this
variable, the observed problems stopped.

From bolker at zoo.ufl.edu  Mon Oct 20 17:45:02 2003
From: bolker at zoo.ufl.edu (Ben Bolker)
Date: Mon Oct 20 17:31:31 2003
Subject: [Rd] Re: [R] R - S compatibility table (fwd)
Message-ID: <Pine.LNX.4.44.0310201041030.15968-100000@bolker.zoo.ufl.edu>


  I appreciate Brian and Martin's answers -- and I certainly don't spend 
as much time & energy maintaining and answering questions about R as they 
do -- *but* it does seem to me that it would make a number of new 
(switching) user's lives easier if there were a succinct list of these 
differences, with a disclaimer ...  I would be willing to maintain such a 
list, but since I don't ever use S-PLUS it would be a little bit hard ...

  http://www.math.uwaterloo.ca/~dbabinea/webpage/function.htm

gives a few differences.

  Ben Bolker


-- 
620B Bartram Hall                            bolker@zoo.ufl.edu
Zoology Department, University of Florida    http://www.zoo.ufl.edu/bolker
Box 118525                                   (ph)  352-392-5697
Gainesville, FL 32611-8525                   (fax) 352-392-3704

---------- Forwarded message ----------
Date: Mon, 20 Oct 2003 16:13:18 +0200
From: Martin Maechler <maechler@stat.math.ethz.ch>
To: Purvis Bedenbaugh <purvis@mbi.ufl.edu>
Cc: r-help@stat.math.ethz.ch
Subject: Re: [R] R - S compatibility table

>>>>> "Purvis" == Purvis Bedenbaugh <purvis@mbi.ufl.edu>
>>>>>     on Mon, 20 Oct 2003 08:03:13 -0400 writes:

    Purvis> Hello all - I've just recently been exploring R for
    Purvis> the first time. After noticing a few things that
    Purvis> have changed from S to R, I started looking for an
    Purvis> R-S compatibility table but didn't find it. Is such
    Purvis> a table out there ? Where ?

    Purvis> Thanks much,

    Purvis> Purvis Bedenbaugh purvis@mbi.ufl.edu

    Purvis> Examples:

    Purvis> 'stdev' is now 'sd' 

"now" is good.  sd() has been in R for about 7 years, whereas
stdev() was introduced into S+ only for version 6.x.. in about 2000.

    Purvis>  - is it exactly the same computation ?  

no, it isn't (in more than one sense)...

    Purvis> couldn't find a built-in for error.bar() 

"built-in" is not a good notion in any version of S, but much
less in R : R comes with 28 (standard + recommended) packages of
which only a few are attached by default, and CRAN has over 200
contributed packages; Bioconductor has another several dozen,
and there are more outside the official repositories above.
Several of the CRAN packages have  error.bar  incantations..

    Purvis> syntax that is an error in R: param(thisframe,"b") <- value

It's not a syntax error;  just, there's no  "param<-" function
in the currently attached R packages (and not in other R
packages I seem to have around)...

Prof. Brian Ripley has given you more hints already.

-- 
Martin Maechler <maechler@stat.math.ethz.ch>	http://stat.ethz.ch/~maechler/
Seminar fuer Statistik, ETH-Zentrum  LEO C16	Leonhardstr. 27
ETH (Federal Inst. Technology)	8092 Zurich	SWITZERLAND
phone: x-41-1-632-3408		fax: ...-1228			<><

______________________________________________
R-help@stat.math.ethz.ch mailing list
https://www.stat.math.ethz.ch/mailman/listinfo/r-help

From tord.snall at ebc.uu.se  Mon Oct 20 18:50:22 2003
From: tord.snall at ebc.uu.se (tord.snall@ebc.uu.se)
Date: Mon Oct 20 18:49:25 2003
Subject: [Rd] warning from return() in 1.8 but not in 1.7.0 (PR#4687)
Message-ID: <200310201650.h9KGoM0P017749@pubhealth.ku.dk>

To whom it may concern,

I get the following message when I run my function:

Warning message: 
multi-argument returns are deprecated in: return(call.fn, repl, time, from,
to, last.year, occup.m, ant.occ.m, 

> version
platform i386-pc-mingw32
arch     i386           
os       mingw32        
system   i386, mingw32  
status                  
major    1              
minor    8.0            
year     2003           
month    10             
day      08             
language R              
Win XP

The whole return call is:
return(call.fn, repl, time, from, to, last.year, occup.m, ant.occ.m,
ant.tree.m, mean.tree.dbh.m, mean.tree.age.m)

If I reduce the call to 
return(call.fn, repl) 
I still gett the error, but if I I reduce to 
return(call.fn) or return(repl) 
it works fine.

The whole long return call works fine with the version I worked with until
today:

platform i386-pc-mingw32
arch     i386           
os       mingw32        
system   i386, mingw32  
status                  
major    1              
minor    7.0            
year     2003           
month    04             
day      16             
language R         
Win XP

I have read CHANGES and can't find changes about return().


Thanks for letting me know what can be wrong.


Sincerely,
Tord

-----------------------------------------------------------------------
Tord Snäll
Avd. f växtekologi, Evolutionsbiologiskt centrum, Uppsala universitet
Dept. of Plant Ecology, Evolutionary Biology Centre, Uppsala University
Villavägen 14			
SE-752 36 Uppsala, Sweden
Tel: 018-471 28 82 (int +46 18 471 28 82) (work)
Tel: 018-25 71 33 (int +46 18 25 71 33) (home)
Fax: 018-55 34 19 (int +46 18 55 34 19) (work)
E-mail: Tord.Snall@ebc.uu.se
Check this: http://www.vaxtbio.uu.se/resfold/snall.htm!

From ligges at statistik.uni-dortmund.de  Mon Oct 20 18:59:57 2003
From: ligges at statistik.uni-dortmund.de (ligges@statistik.uni-dortmund.de)
Date: Mon Oct 20 18:58:58 2003
Subject: [Rd] warning from return() in 1.8 but not in 1.7.0 (PR#4687)
Message-ID: <200310201659.h9KGxv0P017834@pubhealth.ku.dk>

tord.snall@ebc.uu.se wrote:

> To whom it may concern,
> I get the following message when I run my function:
> 
> Warning message: 
> multi-argument returns are deprecated in: return(call.fn, repl, time, from,
> to, last.year, occup.m, ant.occ.m, 
> 
> 
>>version
> 
> platform i386-pc-mingw32
> arch     i386           
> os       mingw32        
> system   i386, mingw32  
> status                  
> major    1              
> minor    8.0            
> year     2003           
> month    10             
> day      08             
> language R              
> Win XP
> 
> The whole return call is:
> return(call.fn, repl, time, from, to, last.year, occup.m, ant.occ.m,
> ant.tree.m, mean.tree.dbh.m, mean.tree.age.m)
> 
> If I reduce the call to 
> return(call.fn, repl) 
> I still gett the error, but if I I reduce to 
> return(call.fn) or return(repl) 
> it works fine.
> 
> The whole long return call works fine with the version I worked with until
> today:
> 
> platform i386-pc-mingw32
> arch     i386           
> os       mingw32        
> system   i386, mingw32  
> status                  
> major    1              
> minor    7.0            
> year     2003           
> month    04             
> day      16             
> language R         
> Win XP
> 
> I have read CHANGES and can't find changes about return().
> 

Not a bug. Please read the NEWS and find that multiple arguments are 
deprecated.

Uwe Ligges



> Thanks for letting me know what can be wrong.
> 
> 
> Sincerely,
> Tord
> 
> -----------------------------------------------------------------------
> Tord Sn?ll
> Avd. f v?xtekologi, Evolutionsbiologiskt centrum, Uppsala universitet
> Dept. of Plant Ecology, Evolutionary Biology Centre, Uppsala University
> Villav?gen 14			
> SE-752 36 Uppsala, Sweden
> Tel: 018-471 28 82 (int +46 18 471 28 82) (work)
> Tel: 018-25 71 33 (int +46 18 25 71 33) (home)
> Fax: 018-55 34 19 (int +46 18 55 34 19) (work)
> E-mail: Tord.Snall@ebc.uu.se
> Check this: http://www.vaxtbio.uu.se/resfold/snall.htm!
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://www.stat.math.ethz.ch/mailman/listinfo/r-devel

From bates at stat.wisc.edu  Mon Oct 20 19:52:13 2003
From: bates at stat.wisc.edu (Douglas Bates)
Date: Mon Oct 20 19:51:19 2003
Subject: [Rd] R 1.80 version
In-Reply-To: <Pine.GSO.4.44.0310191139380.1541-100000@smelt.biostat.umn.edu>
References: <Pine.GSO.4.44.0310191139380.1541-100000@smelt.biostat.umn.edu>
Message-ID: <6rvfqjdcfm.fsf@bates4.stat.wisc.edu>

Xiaoping Jin <xiaopinj@biostat.umn.edu> writes:

> Thank for your quick response. I have known "ifelse" command and
> another alternate way to do that. But I wonder why the same command
> lines can work in R 1.40 version very quickly, but it seems that
> those lines does not work in R 1.80 version well. Is there something
> different?

So apparently you wish to report as a bug the fact that R 1.8.0 is
different from R 1.4.0 (note: there are no versions 1.40 and 1.80 of
R).  Although that is true we do not regard it as a bug.  In fact, we
are well aware of the fact that there are differences between
different versions of R.  That is more-or-less why we give them
different version numbers and why we go to a great deal of effort to
document what has changed between versions.

You also seem to be claiming that on some vaguely defined calculations
on unknown data using an unknown machine under unknown load conditions
R-1.8.0 runs more slowly than R-1.4.0.  Do you honestly expect us to
be able to respond to such a claim?  With that much information to go
on we should be able to nail down the problem in a couple of minutes,
right?

Let's recap here.  You filed a bug report about version 1.80 of R, a
version that doesn't exist.  I asked you to read the section of the
FAQ on "What is a bug?" and also suggested that you you could
accomplish what you apparently want to do in a much easier way.

Did you read "What is a bug?" and "How to report a bug.", especially
the parts on

    The most important principle in reporting a bug is to report
    _facts_, not hypotheses or categorizations.

and 

   It is very useful to try and find simple examples that produce
   apparently the same bug.

If you can provide us with a reproducible example of the behavior you
are experiencing then we can check it out.  But without a reproducible
example, a bug report like this is just a waste of our time.

From tlumley at u.washington.edu  Mon Oct 20 20:07:01 2003
From: tlumley at u.washington.edu (Thomas Lumley)
Date: Mon Oct 20 20:06:13 2003
Subject: [Rd] warning from return() in 1.8 but not in 1.7.0 (PR#4687)
In-Reply-To: <200310201650.h9KGoM0P017749@pubhealth.ku.dk>
References: <200310201650.h9KGoM0P017749@pubhealth.ku.dk>
Message-ID: <Pine.A41.4.58.0310201103030.84428@homer10.u.washington.edu>

On Mon, 20 Oct 2003 tord.snall@ebc.uu.se wrote:

> To whom it may concern,
>
> I get the following message when I run my function:
>
> Warning message:
> multi-argument returns are deprecated in: return(call.fn, repl, time, from,
> to, last.year, occup.m, ant.occ.m,
>

For each version of R there is a list of the most important changes in
R for package developers at http://developer.r-project.org, usually with
advice on what changes you have to make in your code.

The third of ten items in the list for 1.8.0 is
  3) Multi-argument returns are deprecated.  Use a named list, e.g. replace
      return(pred, se)
  by
      return(list(pred=pred, se=se))


This is easier than reading through the NEWS file.


	-thomas

From kjetil at entelnet.bo  Mon Oct 20 20:18:11 2003
From: kjetil at entelnet.bo (kjetil@entelnet.bo)
Date: Mon Oct 20 20:17:57 2003
Subject: [Rd] bug in fisher test---p-value cannot be Inf (PR#4688)
Message-ID: <200310201818.h9KIIB0P018317@pubhealth.ku.dk>

I just found a bug in fisher.test(). This is rw1080, on windows XP.

A p-value can certainly not be Inf, but:

> religion
           Costumbres rel orig
Religion      Si Algunas veces Nunca
  católica  2121          4700  6234
  prot/evan  100           216  2461
  otra C      27            67   502
  otra         0             0    14
> fisher.test(religion, workspace=2000000)

        Fisher's Exact Test for Count Data

data:  religion 
p-value = Inf
alternative hypothesis: two.sided 

Kjetil Halvorsen

From w.huber at dkfz.de  Mon Oct 20 22:15:04 2003
From: w.huber at dkfz.de (w.huber@dkfz.de)
Date: Mon Oct 20 22:14:02 2003
Subject: [Rd] Random Number Generator RNGkind() under "R CMD check" (PR#4691)
Message-ID: <200310202015.h9KKF40P018950@pubhealth.ku.dk>

Full_Name: Wolfgang Huber
Version: 1.8.0
OS: Linux
Submission from: (NULL) (193.174.58.146)


The man page for RNGkind says that the default is Mersenne-Twister, and when I
start R interactively, I get in fact
> RNGkind()
[1] "Mersenne-Twister" "Inversion"

However, during the execution of "R CMD check" I get
> > ### ** Examples
> >
> >  RNGkind()
> [1] "Wichmann-Hill" "Inversion"

This creates discrepancies between the behaviour of code that uses pseudo random
numbers during "check" and otherwise.

> version
         _
platform i686-pc-linux-gnu
arch     i686
os       linux-gnu
system   i686, linux-gnu
status
major    1
minor    8.0
year     2003
month    10
day      08
language R

From dmurdoch at pair.com  Tue Oct 21 01:58:10 2003
From: dmurdoch at pair.com (Duncan Murdoch)
Date: Tue Oct 21 01:57:14 2003
Subject: [Rd] warning from return() in 1.8 but not in 1.7.0 (PR#4687)
In-Reply-To: <200310201650.h9KGoM0P017749@pubhealth.ku.dk>
References: <200310201650.h9KGoM0P017749@pubhealth.ku.dk>
Message-ID: <r6t8pvcl2nc91n5ephv91gf47v5p2vougc@4ax.com>

On Mon, 20 Oct 2003 18:50:22 +0200 (MET DST), you wrote:


>I have read CHANGES and can't find changes about return().

CHANGES is the list of Windows-specific changes.  It says this right
at the top (and says that NEWS is for other versions), but maybe the
names should be rationalized.

The Mac-specific changes are in the main NEWS file, but there are less
of those than of Windows-specific changes, so it makes sense that
Windows keeps its changes separate.  

Should I rename CHANGES to NEWS_Win or something similar in the next
release?

Duncan Murdoch

From nakama at ki.rim.or.jp  Tue Oct 21 06:29:52 2003
From: nakama at ki.rim.or.jp (nakama@ki.rim.or.jp)
Date: Tue Oct 21 06:28:52 2003
Subject: [Rd] Problem R-1.8.0 library tcltk on Tcl-8.0.5 (PR#4699)
Message-ID: <200310210429.h9L4Tq0P021121@pubhealth.ku.dk>

Full_Name: Eiji Nakama
Version: R-1.8.0
OS: linux(VineLinux)
Submission from: (NULL) (219.117.236.13)


I build by Tcl8.0.5 and R-1.8.0.

> library(tcltk)
Error in dyn.load(x, as.logical(local), as.logical(now)) : 
	unable to load shared library "/usr/lib/R/library/tcltk/libs/tcltk.so":
  /usr/lib/R/library/tcltk/libs/tcltk.so: undefined symbol:
RTcl_ActivateConsoleError in runHook(".onLoad", env, package.lib, package) : 
	.onLoad failed
Error in library(tcltk) : package/namespace load failed

R-1.8.0/src/library/tcltk/src/init.c
     32 #ifndef TCL80
     33     {"RTcl_ActivateConsole", (DL_FUNC) &RTcl_ActivateConsole, 0},
     34 #endif

TCL80 is not defined anywhere.
It is defined only as tcltk.c.

From p.dalgaard at biostat.ku.dk  Tue Oct 21 08:49:39 2003
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Tue Oct 21 08:45:27 2003
Subject: [Rd] Problem R-1.8.0 library tcltk on Tcl-8.0.5 (PR#4699)
In-Reply-To: <200310210429.h9L4Tq0P021121@pubhealth.ku.dk>
References: <200310210429.h9L4Tq0P021121@pubhealth.ku.dk>
Message-ID: <x28ynfdr0c.fsf@biostat.ku.dk>

nakama@ki.rim.or.jp writes:

> Full_Name: Eiji Nakama
> Version: R-1.8.0
> OS: linux(VineLinux)
> Submission from: (NULL) (219.117.236.13)
> 
> 
> I build by Tcl8.0.5 and R-1.8.0.
> 
> > library(tcltk)
> Error in dyn.load(x, as.logical(local), as.logical(now)) : 
> 	unable to load shared library "/usr/lib/R/library/tcltk/libs/tcltk.so":
>   /usr/lib/R/library/tcltk/libs/tcltk.so: undefined symbol:
> RTcl_ActivateConsoleError in runHook(".onLoad", env, package.lib, package) : 
> 	.onLoad failed
> Error in library(tcltk) : package/namespace load failed
> 
> R-1.8.0/src/library/tcltk/src/init.c
>      32 #ifndef TCL80
>      33     {"RTcl_ActivateConsole", (DL_FUNC) &RTcl_ActivateConsole, 0},
>      34 #endif
> 
> TCL80 is not defined anywhere.
> It is defined only as tcltk.c.

Yes. The workaround should be obvious. Or upgrade tcl/tk -- 8.0.x is
pretty ancient by now.

The proper fix is probably to move

#include <tcl.h>
#include <tk.h>

#if (TCL_MAJOR_VERSION==8 && TCL_MINOR_VERSION==0)
#define TCL80
#endif

from tcltk.c into tcltk.h.

(Argh. The test builds of 1.8.0 were actually against tcl8.0, but
apparently our testing procedures skip any attempt to load the dynlib.
Automated tests of tcl/tk are difficult because Tk will protest if
there is no X display.)

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From tord.snall at ebc.uu.se  Tue Oct 21 11:53:53 2003
From: tord.snall at ebc.uu.se (Tord Snall)
Date: Tue Oct 21 11:48:39 2003
Subject: [Rd] warning from return() in 1.8 but not in 1.7.0
  (PR#4687)
In-Reply-To: <r6t8pvcl2nc91n5ephv91gf47v5p2vougc@4ax.com>
References: <200310201650.h9KGoM0P017749@pubhealth.ku.dk>
	<200310201650.h9KGoM0P017749@pubhealth.ku.dk>
Message-ID: <3.0.6.32.20031021115353.00ca55e8@mail.anst.uu.se>

Dear Duncan,

At 19:58 2003-10-20 -0400, you wrote:
>On Mon, 20 Oct 2003 18:50:22 +0200 (MET DST), you wrote:
>
>
>>I have read CHANGES and can't find changes about return().
>
>CHANGES is the list of Windows-specific changes.  It says this right
>at the top (and says that NEWS is for other versions), but maybe the
>names should be rationalized.
>
>The Mac-specific changes are in the main NEWS file, but there are less
>of those than of Windows-specific changes, so it makes sense that
>Windows keeps its changes separate.  
>
>Should I rename CHANGES to NEWS_Win or something similar in the next
>release?

As a user, I would prefer only having to look in one place for the
information. A suggestion is one file with all changes listed under
different subtitles, Mac-specific changes, Win-specific changes etc. 


Sincerely,
Tord


>
>Duncan Murdoch
>

-----------------------------------------------------------------------
Tord Sn?ll
Avd. f v?xtekologi, Evolutionsbiologiskt centrum, Uppsala universitet
Dept. of Plant Ecology, Evolutionary Biology Centre, Uppsala University
Villav?gen 14			
SE-752 36 Uppsala, Sweden
Tel: 018-471 28 82 (int +46 18 471 28 82) (work)
Tel: 018-25 71 33 (int +46 18 25 71 33) (home)
Fax: 018-55 34 19 (int +46 18 55 34 19) (work)
E-mail: Tord.Snall@ebc.uu.se
Check this: http://www.vaxtbio.uu.se/resfold/snall.htm!

From david.lenn at rtsson.com  Tue Oct 21 16:21:59 2003
From: david.lenn at rtsson.com (david.lenn@rtsson.com)
Date: Tue Oct 21 16:21:15 2003
Subject: [Rd] Console in RGui does not do CR on \r (PR#4705)
Message-ID: <200310211421.h9LELx0P000324@pubhealth.ku.dk>

Full_Name: David Lennartsson
Version: 1.7.1, 1.8.0
OS: Windows XP
Submission from: (NULL) (62.119.45.80)



A very minor bug, but here it comes. On doing something as simple as cat("1st
test string\r2nd\n") the console in RGui on Windows do not perform a CR on '\r'.
This is very annoying if you for example want to have a simple progress meter
when running a batch job. It works fine in Rterm. 

The same goes for using Rprintf() in a compiled function. Rterm honours '\r' but
not Rgui.

From ripley at stats.ox.ac.uk  Tue Oct 21 17:00:04 2003
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue Oct 21 16:59:08 2003
Subject: [Rd] Console in RGui does not do CR on \r (PR#4705)
In-Reply-To: <200310211421.h9LELx0P000324@pubhealth.ku.dk>
Message-ID: <Pine.LNX.4.44.0310211556590.4160-100000@gannet.stats>

Not a bug, but intentional.  To be a bug, it would need to 
be documented to work, and it is not.

In Rgui other threads (e.g. a tcltk button) can be writing to the console 
too.  Implementing \r would be very complicated, and not worthwhile 
(Windows has a perfectly good progress-meter widget!)

On Tue, 21 Oct 2003 david.lenn@rtsson.com wrote:

> Full_Name: David Lennartsson
> Version: 1.7.1, 1.8.0
> OS: Windows XP
> Submission from: (NULL) (62.119.45.80)
> 
> 
> 
> A very minor bug, but here it comes. On doing something as simple as cat("1st
> test string\r2nd\n") the console in RGui on Windows do not perform a CR on '\r'.
> This is very annoying if you for example want to have a simple progress meter
> when running a batch job. It works fine in Rterm. 

I tis nothing to do with Rterm, but terminal in which Rterm is running.


> The same goes for using Rprintf() in a compiled function. Rterm honours '\r' but
> not Rgui.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From Kurt.Hornik at wu-wien.ac.at  Tue Oct 21 17:02:56 2003
From: Kurt.Hornik at wu-wien.ac.at (Kurt Hornik)
Date: Tue Oct 21 17:05:45 2003
Subject: [Rd] Problem R-1.8.0 library tcltk on Tcl-8.0.5 (PR#4699)
In-Reply-To: <x28ynfdr0c.fsf@biostat.ku.dk>
References: <200310210429.h9L4Tq0P021121@pubhealth.ku.dk>
	<x28ynfdr0c.fsf@biostat.ku.dk>
Message-ID: <16277.19104.764444.11251@mithrandir.hornik.net>

>>>>> Peter Dalgaard writes:

> nakama@ki.rim.or.jp writes:
>> Full_Name: Eiji Nakama
>> Version: R-1.8.0
>> OS: linux(VineLinux)
>> Submission from: (NULL) (219.117.236.13)
>> 
>> 
>> I build by Tcl8.0.5 and R-1.8.0.
>> 
>> > library(tcltk)
>> Error in dyn.load(x, as.logical(local), as.logical(now)) : 
>> unable to load shared library "/usr/lib/R/library/tcltk/libs/tcltk.so":
>> /usr/lib/R/library/tcltk/libs/tcltk.so: undefined symbol:
>> RTcl_ActivateConsoleError in runHook(".onLoad", env, package.lib, package) : 
>> .onLoad failed
>> Error in library(tcltk) : package/namespace load failed
>> 
>> R-1.8.0/src/library/tcltk/src/init.c
>> 32 #ifndef TCL80
>> 33     {"RTcl_ActivateConsole", (DL_FUNC) &RTcl_ActivateConsole, 0},
>> 34 #endif
>> 
>> TCL80 is not defined anywhere.
>> It is defined only as tcltk.c.

> Yes. The workaround should be obvious. Or upgrade tcl/tk -- 8.0.x is
> pretty ancient by now.

> The proper fix is probably to move

> #include <tcl.h>
> #include <tk.h>

> #if (TCL_MAJOR_VERSION==8 && TCL_MINOR_VERSION==0)
> #define TCL80
> #endif

> from tcltk.c into tcltk.h.

> (Argh. The test builds of 1.8.0 were actually against tcl8.0, but
> apparently our testing procedures skip any attempt to load the dynlib.
> Automated tests of tcl/tk are difficult because Tk will protest if
> there is no X display.)

On systems which have Xvfb, this is not a problem.

The daily package checker uses this, for example.

-k

From p.dalgaard at biostat.ku.dk  Tue Oct 21 17:34:39 2003
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Tue Oct 21 17:30:33 2003
Subject: [Rd] Problem R-1.8.0 library tcltk on Tcl-8.0.5 (PR#4699)
In-Reply-To: <16277.19104.764444.11251@mithrandir.hornik.net>
References: <200310210429.h9L4Tq0P021121@pubhealth.ku.dk>
	<x28ynfdr0c.fsf@biostat.ku.dk>
	<16277.19104.764444.11251@mithrandir.hornik.net>
Message-ID: <x28ynehaeo.fsf@biostat.ku.dk>

Kurt Hornik <Kurt.Hornik@wu-wien.ac.at> writes:


> > (Argh. The test builds of 1.8.0 were actually against tcl8.0, but
> > apparently our testing procedures skip any attempt to load the dynlib.
> > Automated tests of tcl/tk are difficult because Tk will protest if
> > there is no X display.)
> 
> On systems which have Xvfb, this is not a problem.
> 
> The daily package checker uses this, for example.

Hmm it is more tricky than that it seems. I see

comparing 'stepfun-Ex.Rout' to 'stepfun-Ex.Rout.prev' ... OK
running code in 'tcltk-Ex.R' ... OK
comparing 'tcltk-Ex.Rout' to 'tcltk-Ex.Rout.prev' ... OK
collecting examples for package 'ts' ...
make[5]: Entering directory `/e7/pd/r-devel/BUILD/src/library'

However, 

[pd@franz BUILD]$ tail  tests/Examples/tcltk-Ex.Rout
> postscript("tcltk-Examples.ps")
> assign("par.postscript", par(no.readonly = TRUE), env = .CheckExEnv)
> options(contrasts = c(unordered = "contr.treatment", ordered = "contr.poly"))
> require('tcltk') || q()
Loading required package: tcltk
Error in dyn.load(x, as.logical(local), as.logical(now)) :
        unable to load shared library "/e7/pd/r-devel/BUILD/library/tcltk/libs/tcltk.so":
  /e7/pd/r-devel/BUILD/library/tcltk/libs/tcltk.so: undefined symbol: RTcl_ActivateConsole
Error in runHook(".onLoad", env, package.lib, package) :
        .onLoad failed

I.e. the seeming pass of make check is really just reflecting the fact
that I got the same catastrophic failure as last time I ran it... 

Is there a better way?

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From bates at stat.wisc.edu  Tue Oct 21 19:11:08 2003
From: bates at stat.wisc.edu (Douglas Bates)
Date: Tue Oct 21 19:10:07 2003
Subject: [Rd] an r-devel change related to attributes
Message-ID: <6rekx6bjo3.fsf@bates4.stat.wisc.edu>

We have made a change in r-devel involving copying during assignment
of attributes.  The only effect should be better performance in
packages that use S4 classes and methods.  However, if you are using
r-devel you should be watch for peculiar errors related to attributes.

From lbagua at yahoo.co.jp  Tue Oct 21 19:25:49 2003
From: lbagua at yahoo.co.jp (lbagua@yahoo.co.jp)
Date: Tue Oct 21 19:24:48 2003
Subject: [Rd] R1.8.0 and virtual PC (PR#4708)
Message-ID: <200310211725.h9LHPn0P001795@pubhealth.ku.dk>

Dear Sir/Madam

First, I should tell that I'm using virtual PC "w2k" in a mac osx 10.2.

The problem: I recently downloaded the windows version 1.8.0. I found 
the following problem with the instruction plot.
E.g., if I type the following instructions, I got the following error 
message:

 > x = 1:10
 > y = 2*x
 > plot(x,y)
Hit <Return> to see next plot:
Error in plot.window(xlim, ylim, log, asp, ...) :
         need finite xlim values
In addition: Warning messages:
1: no finite arguments to max; returning -Inf
2: no finite arguments to max; returning -Inf

The problem disappears when I explicitly type xlim and ylim (e.g.,  
plot(x,y, xlim=c(0,10), ylim=c(0,20)) )
I also found a similar problem in the instructions "demo(image)" and 
"demo(graphics)"

This problem does not occur in version 1.7.1
Is it something to do with the fact I'm using a Virtual PC program?

Thank you in advance

Luis Borda de Agua

P.S. If you are wondering why I'm using R in a virtual PC it is because 
I frequently use WinBUGS (no version for mac as far as I'm aware).


________________________________________________________
Luis Borda de Agua (PhD)
Department of Renewable Resources
751 General Services Building
University of Alberta
Edmonton, AB Canada T6G 2H1
Phone: (780) 492-0715; 
Fax: (780) 492-4323
Email: lbagua@ yahoo.co.jp

__________________________________________________

Yahoo! BB is Broadband by Yahoo!
http://bb.yahoo.co.jp/

From w.huber at dkfz-heidelberg.de  Tue Oct 21 20:48:28 2003
From: w.huber at dkfz-heidelberg.de (w.huber@dkfz-heidelberg.de)
Date: Tue Oct 21 20:48:35 2003
Subject: [Rd] round behaves differently from ceiling,
	floor for matrices with 0 rows (PR#4710)
Message-ID: <200310211848.h9LImS0P002266@pubhealth.ku.dk>

Full_Name: Wolfgang Huber
Version: 1.8.0
OS: Linux
Submission from: (NULL) (193.174.58.146)


base::round converts a matrix with 0 rows into numeric(0),
while floor and ceiling return a matrix of the same size:

> round(matrix(0, nrow=0, ncol=3))
numeric(0)

> ceiling(matrix(0, nrow=0, ncol=3))
     [,1] [,2] [,3]
> floor(matrix(0, nrow=0, ncol=3))
     [,1] [,2] [,3]
> round(matrix(0, nrow=1, ncol=3))
     [,1] [,2] [,3]
[1,]    0    0    0

> version
         _
platform i686-pc-linux-gnu
arch     i686
os       linux-gnu
system   i686, linux-gnu
status
major    1
minor    8.0
year     2003
month    10
day      08
language R

From dmurdoch at pair.com  Tue Oct 21 20:55:34 2003
From: dmurdoch at pair.com (Duncan Murdoch)
Date: Tue Oct 21 20:53:46 2003
Subject: [Rd] R1.8.0 and virtual PC (PR#4708)
In-Reply-To: <200310211725.h9LHPn0P001795@pubhealth.ku.dk>
References: <200310211725.h9LHPn0P001795@pubhealth.ku.dk>
Message-ID: <330bpv4nqhufsafmqv7ca6cqb7u1me036f@4ax.com>

On Tue, 21 Oct 2003 19:25:49 +0200 (MET DST), lbagua@yahoo.co.jp wrote
:

>Dear Sir/Madam
>
>First, I should tell that I'm using virtual PC "w2k" in a mac osx 10.2.
>
>The problem: I recently downloaded the windows version 1.8.0. I found 
>the following problem with the instruction plot.
>E.g., if I type the following instructions, I got the following error 
>message:
>
> > x = 1:10
> > y = 2*x
> > plot(x,y)
>Hit <Return> to see next plot:
>Error in plot.window(xlim, ylim, log, asp, ...) :
>         need finite xlim values
>In addition: Warning messages:
>1: no finite arguments to max; returning -Inf
>2: no finite arguments to max; returning -Inf
>
>The problem disappears when I explicitly type xlim and ylim (e.g.,  
>plot(x,y, xlim=c(0,10), ylim=c(0,20)) )
>I also found a similar problem in the instructions "demo(image)" and 
>"demo(graphics)"
>
>This problem does not occur in version 1.7.1
>Is it something to do with the fact I'm using a Virtual PC program?

It probably is, since that error doesn't show up for me in Windows.
However, I don't get the "Hit <return> to see next plot" either,
because I don't have par(ask=TRUE); it's conceivable it's some other
par() option you've set that is causing the problem.

Duncan Murdoch

From tlumley at u.washington.edu  Tue Oct 21 22:59:45 2003
From: tlumley at u.washington.edu (Thomas Lumley)
Date: Tue Oct 21 22:58:46 2003
Subject: [Rd] R1.8.0 and virtual PC (PR#4708)
In-Reply-To: <200310211725.h9LHPn0P001795@pubhealth.ku.dk>
References: <200310211725.h9LHPn0P001795@pubhealth.ku.dk>
Message-ID: <Pine.A41.4.58.0310211358150.138038@homer10.u.washington.edu>

On Tue, 21 Oct 2003 lbagua@yahoo.co.jp wrote:

> Dear Sir/Madam
>
> First, I should tell that I'm using virtual PC "w2k" in a mac osx 10.2.
>

It would probably be easier (and faster) to use RAqua in OS X, rather than
the windows version under virtual PC.

	-thomas

From brahm at alum.mit.edu  Wed Oct 22 00:25:50 2003
From: brahm at alum.mit.edu (David Brahm)
Date: Wed Oct 22 00:24:50 2003
Subject: [Rd] Subsetted 1-D arrays (PR#4110)
Message-ID: <16277.45678.55489.229526@arbres1a.fmr.com>

In R-patched_2003-10-20, subsetted 1-D arrays no longer get converted to
vectors.  The NEWS file documents this change, as an indirect result of bug
report 4110.  I just wanted to mention this can break code in some rather
obscure ways, such as this toy example:

  R> x <- sort(tapply(1:8, rep(1:4,2), sum))  # Was vector, now is 1D array
  R> y <- matrix(1:4, 1,4)                    # 1x4 matrix
  R> x + y                                    # Used to return a 1x4 matrix
     Error in x + y : non-conformable arrays

I agree with the change, but I would beware that some puzzled users may not
associate new "tapply problems" with this news item.

Also, *should* you be able to add a (4) array to a (1,4) array?
-- 
                              -- David Brahm (brahm@alum.mit.edu)

From p.dalgaard at biostat.ku.dk  Wed Oct 22 01:09:38 2003
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Wed Oct 22 01:05:10 2003
Subject: [Rd] Subsetted 1-D arrays (PR#4110)
In-Reply-To: <16277.45678.55489.229526@arbres1a.fmr.com>
References: <16277.45678.55489.229526@arbres1a.fmr.com>
Message-ID: <x2ad7ugpcd.fsf@biostat.ku.dk>

David Brahm  <brahm@alum.mit.edu> writes:

> In R-patched_2003-10-20, subsetted 1-D arrays no longer get converted to
> vectors.  The NEWS file documents this change, as an indirect result of bug
> report 4110.  I just wanted to mention this can break code in some rather
> obscure ways, such as this toy example:
> 
>   R> x <- sort(tapply(1:8, rep(1:4,2), sum))  # Was vector, now is 1D array
>   R> y <- matrix(1:4, 1,4)                    # 1x4 matrix
>   R> x + y                                    # Used to return a 1x4 matrix
>      Error in x + y : non-conformable arrays

Without the sort() that was an error in 1.8.0 too. However, we've
found other surprises like 

  prop.trend.test(tt[1,], margin.table(tt,2))

which internally will pass a 1D array as weights to lm.
 
> I agree with the change, but I would beware that some puzzled users may not
> associate new "tapply problems" with this news item.

Yep. And I tend to agree that the original problem had to be fixed.

> Also, *should* you be able to add a (4) array to a (1,4) array?

...or to a (4,1) array? Currently the answer is clearly neither: if
both terms have dimensions, the dimensions must match. It is kind of
tempting though.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From ripley at stats.ox.ac.uk  Wed Oct 22 08:54:48 2003
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed Oct 22 08:53:48 2003
Subject: [Rd] Subsetted 1-D arrays (PR#4110)
In-Reply-To: <16277.45678.55489.229526@arbres1a.fmr.com>
Message-ID: <Pine.LNX.4.44.0310220753000.5221-100000@gannet.stats>

On Tue, 21 Oct 2003, David Brahm wrote:

> In R-patched_2003-10-20, subsetted 1-D arrays no longer get converted to
> vectors.  The NEWS file documents this change, as an indirect result of bug
> report 4110.  I just wanted to mention this can break code in some rather
> obscure ways, such as this toy example:
> 
>   R> x <- sort(tapply(1:8, rep(1:4,2), sum))  # Was vector, now is 1D array
>   R> y <- matrix(1:4, 1,4)                    # 1x4 matrix
>   R> x + y                                    # Used to return a 1x4 matrix
>      Error in x + y : non-conformable arrays
> 
> I agree with the change, but I would beware that some puzzled users may not
> associate new "tapply problems" with this news item.

We are aware of a couple of such problems, but they are code that should 
not have worked before.  Unfortunately, in S tapply gives a vector and not 
a 1D array here ....

> Also, *should* you be able to add a (4) array to a (1,4) array?

No.  You cannot in S.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From wettenhall at wehi.edu.au  Wed Oct 22 11:16:11 2003
From: wettenhall at wehi.edu.au (James Wettenhall)
Date: Wed Oct 22 11:15:13 2003
Subject: [Rd] Windows RConsole Focus
Message-ID: <Pine.LNX.4.44.0310221856330.14211-100000@unix28.alpha.wehi.edu.au>

Hi,

I was looking for a Windows-specific R function to focus the 
console window and couldn't find one.  The motivation is that 
after loading the tcltk package, the "main" Tk window "." is 
presumably focused but then immediately withdrawn (hidden) so 
the RConsole loses its focus and you have to click on it to 
continue typing.

Would there be any interest in including a winConsoleFocus() 
function in R at some stage or is it already there?

I tried implementing a quick solution (below) which seemes 
to work.

Regards,
James

src/gnuwin32/rui.c
------------------
int winconsolefocus()
{
    show(RConsole);
    return 0;
}

src/gnuwin32/rui.h
------------------
int winconsolefocus(void);

src/gnuwin32/extra.c
--------------------
SEXP do_winconsolefocus(SEXP call, SEXP op, SEXP args, SEXP rho)
{
    SEXP ans;
    Rboolean success = TRUE;
    winconsolefocus();
    PROTECT(ans = allocVector(LGLSXP, 1));
    LOGICAL(ans)[0] = success;
    UNPROTECT(1);
    return ans;
}

src/main/names.c
----------------
{"winConsoleFocus",do_winconsolefocus,0,11,     0,      
{PP_FUNCALL, PREC_FN,   0}},

src/include/Internal.h
----------------------
SEXP do_winconsolefocus(SEXP, SEXP, SEXP, SEXP);

src/library/base/R/windows/winDialog.R
---------------------------------------
winConsoleFocus <- function()
    invisible(.Internal(winConsoleFocus()))

From maechler at stat.math.ethz.ch  Wed Oct 22 11:45:31 2003
From: maechler at stat.math.ethz.ch (maechler@stat.math.ethz.ch)
Date: Wed Oct 22 11:44:29 2003
Subject: [Rd] Random Number Generator RNGkind() under "R CMD check"
	(PR#4691)
Message-ID: <200310220945.h9M9jV0P009182@pubhealth.ku.dk>

>>>>> "WoHub" == w huber <w.huber@dkfz.de>
>>>>>     on Mon, 20 Oct 2003 22:15:04 +0200 (MET DST) writes:

    WoHub> Full_Name: Wolfgang Huber
    WoHub> Version: 1.8.0
    WoHub> OS: Linux
    WoHub> Submission from: (NULL) (193.174.58.146)


    WoHub> The man page for RNGkind says that the default is
    WoHub> Mersenne-Twister, and when I start R interactively, I
    WoHub> get in fact

    >> RNGkind()
    WoHub> [1] "Mersenne-Twister" "Inversion"

    WoHub> However, during the execution of "R CMD check" I get
    >> > ### ** Examples
    >> >
    >> >  RNGkind()
    >> [1] "Wichmann-Hill" "Inversion"

    WoHub> This creates discrepancies between the behaviour of
    WoHub> code that uses pseudo random numbers during "check"
    WoHub> and otherwise.

yes, but this has been so on purpose "forever".
If you really want reproducible example using random numbers
you must set both RNGkind() and set.seed().

I'd agree that this should be documented -- and further, we tend
to agree that we should consider changing the current behavior,
probably to something like
	 RNGkind("default","default"); set.seed(1)
{in the cleanupEx() function called before each example}.

But note again: You still may see "discrepancies" between the "R
CMD check" and the normal usage, unless you call at least
set.seed(.) yourself in your example.

Martin Maechler <maechler@stat.math.ethz.ch>	http://stat.ethz.ch/~maechler/
Seminar fuer Statistik, ETH-Zentrum  LEO C16	Leonhardstr. 27
ETH (Federal Inst. Technology)	8092 Zurich	SWITZERLAND
phone: x-41-1-632-3408		fax: ...-1228			<><

From i.wilson at maths.abdn.ac.uk  Wed Oct 22 12:11:49 2003
From: i.wilson at maths.abdn.ac.uk (i.wilson@maths.abdn.ac.uk)
Date: Wed Oct 22 12:11:04 2003
Subject: [Rd] Something strange in cor.test in R-1.8.0 (PR#4718)
Message-ID: <200310221011.h9MABn0P009736@pubhealth.ku.dk>

Full_Name: Ian Wilson
Version: R-1.8.0
OS: Windows (but own compilation)
Submission from: (NULL) (139.133.7.38)



the p-value is incorrect for cor.test using method "spearman" in R-1.8.0.  This
was not the case in R-1.7.1.

Version R-1.8.0 on Windows 

> cor.test(rnorm(50),rnorm(50),method="spearman")

	Spearman's rank correlation rho

data:  rnorm(50) and rnorm(50) 
S = 20486, p-value = < 2.2e-16
alternative hypothesis: true rho is not equal to 0 
sample estimates:
       rho 
0.01627851 

> cor.test(rnorm(50),rnorm(50),method="spearman")

	Spearman's rank correlation rho

data:  rnorm(50) and rnorm(50) 
S = 22006, p-value = 1
alternative hypothesis: true rho is not equal to 0 
sample estimates:
        rho 
-0.05671068

From ripley at stats.ox.ac.uk  Wed Oct 22 12:51:46 2003
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed Oct 22 12:50:47 2003
Subject: [Rd] Something strange in cor.test in R-1.8.0 (PR#4718)
In-Reply-To: <200310221011.h9MABn0P009736@pubhealth.ku.dk>
Message-ID: <Pine.LNX.4.44.0310221143580.5414-100000@gannet.stats>

Without knowing the seed used it is impossible for us to reproduce this,
but I am not seeing anything strange.

Could you please reply with a reproducible example (and list the data used 
too, in case the random number generation is the issue).


On Wed, 22 Oct 2003 i.wilson@maths.abdn.ac.uk wrote:

> Full_Name: Ian Wilson
> Version: R-1.8.0
> OS: Windows (but own compilation)
> Submission from: (NULL) (139.133.7.38)
> 
> 
> 
> the p-value is incorrect for cor.test using method "spearman" in R-1.8.0.  This
> was not the case in R-1.7.1.
> 
> Version R-1.8.0 on Windows 
> 
> > cor.test(rnorm(50),rnorm(50),method="spearman")
> 
> 	Spearman's rank correlation rho
> 
> data:  rnorm(50) and rnorm(50) 
> S = 20486, p-value = < 2.2e-16
> alternative hypothesis: true rho is not equal to 0 
> sample estimates:
>        rho 
> 0.01627851 
> 
> > cor.test(rnorm(50),rnorm(50),method="spearman")
> 
> 	Spearman's rank correlation rho
> 
> data:  rnorm(50) and rnorm(50) 
> S = 22006, p-value = 1
> alternative hypothesis: true rho is not equal to 0 
> sample estimates:
>         rho 
> -0.05671068
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://www.stat.math.ethz.ch/mailman/listinfo/r-devel
> 
> 

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From dmurdoch at pair.com  Wed Oct 22 14:12:02 2003
From: dmurdoch at pair.com (Duncan Murdoch)
Date: Wed Oct 22 14:11:01 2003
Subject: [Rd] Something strange in cor.test in R-1.8.0 (PR#4718)
In-Reply-To: <Pine.LNX.4.44.0310221143580.5414-100000@gannet.stats>
References: <200310221011.h9MABn0P009736@pubhealth.ku.dk>
	<Pine.LNX.4.44.0310221143580.5414-100000@gannet.stats>
Message-ID: <skscpv0rf60tm5vd9kfq910burm52ig7tt@4ax.com>

On Wed, 22 Oct 2003 11:51:46 +0100 (BST), you wrote:

>Without knowing the seed used it is impossible for us to reproduce this,
>but I am not seeing anything strange.

I'm getting strange results in 1.8.0 for Windows too.

> set.seed(1)
> x <- rnorm(50)
> y <- rnorm(50)
> cor.test(x,y,method="spearman")

        Spearman's rank correlation rho

data:  x and y 
S = 23640, p-value = 1
alternative hypothesis: true rho is not equal to 0 
sample estimates:
       rho 
-0.1351741 

> x <- rnorm(50)
> y <- rnorm(50)
> cor.test(x,y,method="spearman")

        Spearman's rank correlation rho

data:  x and y 
S = 17248, p-value = < 2.2e-16
alternative hypothesis: true rho is not equal to 0 
sample estimates:
      rho 
0.1717647 

> x
 [1] -0.62036668  0.04211587 -0.91092165  0.15802877 -0.65458464
1.76728727
 [7]  0.71670748  0.91017423  0.38418536  1.68217608 -0.63573645
-0.46164473
[13]  1.43228224 -0.65069635 -0.20738074 -0.39280793 -0.31999287
-0.27911330
[19]  0.49418833 -0.17733048 -0.50595746  1.34303883 -0.21457941
-0.17955653
[25] -0.10019074  0.71266631 -0.07356440 -0.03763417 -0.68166048
-0.32427027
[31]  0.06016044 -0.58889449  0.53149619 -1.51839408  0.30655786
-1.53644982
[37] -0.30097613 -0.52827990 -0.65209478 -0.05689678 -1.91435943
1.17658331
[43] -1.66497244 -0.46353040 -1.11592011 -0.75081900  2.08716655
0.01739562
[49] -1.28630053 -1.64060553
> y
 [1]  0.45018710 -0.01855983 -0.31806837 -0.92936215 -1.48746031
-1.07519230
 [7]  1.00002880 -0.62126669 -1.38442685  1.86929062  0.42510038
-0.23864710
[13]  1.05848305  0.88642265 -0.61924305  2.20610246 -0.25502703
-1.42449465
[19] -0.14439960  0.20753834  2.30797840  0.10580237  0.45699881
-0.07715294
[25] -0.33400084 -0.03472603  0.78763961  2.07524501  1.02739244
1.20790840
[31] -1.23132342  0.98389557  0.21992480 -1.46725003  0.52102274
-0.15875460
[37]  1.46458731 -0.76608200 -0.43021175 -0.92610950 -0.17710396
0.40201178
[43] -0.73174817  0.83037317 -1.20808279 -1.04798441  1.44115771
-1.01584747
[49]  0.41197471 -0.38107605


In 1.7.1, the same code gives the same x and y and rho values, but
more reasonable p-values:

> cor.test(x,y,method="spearman")

        Spearman's rank correlation rho

data:  x and y 
S = 23640, p-value = 0.3482
alternative hypothesis: true rho is not equal to 0 
sample estimates:
       rho 
-0.1351741 

> x <- rnorm(50)
> y <- rnorm(50)
> cor.test(x,y,method="spearman")

        Spearman's rank correlation rho

data:  x and y 
S = 17248, p-value = 0.2322
alternative hypothesis: true rho is not equal to 0 
sample estimates:
      rho 
0.1717647

From dmurdoch at pair.com  Wed Oct 22 14:17:32 2003
From: dmurdoch at pair.com (Duncan Murdoch)
Date: Wed Oct 22 14:16:34 2003
Subject: [Rd] Something strange in cor.test in R-1.8.0 (PR#4718)
In-Reply-To: <Pine.LNX.4.44.0310221143580.5414-100000@gannet.stats>
References: <200310221011.h9MABn0P009736@pubhealth.ku.dk>
	<Pine.LNX.4.44.0310221143580.5414-100000@gannet.stats>
Message-ID: <u7tcpv4tf2n3t6g7i1prcrgdhji7qocv1q@4ax.com>

I've now tried the code 

set.seed(1)
x <- rnorm(50)
y <- rnorm(50)
cor.test(x,y,method="spearman")
x <- rnorm(50)
y <- rnorm(50)
cor.test(x,y,method="spearman")

in r-patched (which gives apparently correct results), and r-devel,
which gives the first result correct, the second incorrect; when
repeated, both are bad.

Duncan Murdoch

From i.wilson at maths.abdn.ac.uk  Wed Oct 22 14:35:50 2003
From: i.wilson at maths.abdn.ac.uk (i.wilson@maths.abdn.ac.uk)
Date: Wed Oct 22 14:34:47 2003
Subject: [Rd] Something strange in cor.test in R-1.8.0 (PR#4718)
Message-ID: <200310221235.h9MCZo0P012690@pubhealth.ku.dk>

reproducible example

> b1 <- c(42.5565911271682, 27.5164947336246, 39.483642950093,
    103.942262842055, 36.0059074090041, 38.5628716462492, 30.4961003157125,
    41.4309 .... [TRUNCATED]

> b2 <- c(32.38938053, 22.44444444, 33.05454545, 42.21176471,
    40.10869565, 29.80952381, 24.79452055, 25.18518519, 37.09677419,
    31.32727273)

> cor.test(b1, b2, method = "spearman")

	Spearman's rank correlation rho

data:  b1 and b2
S = 66, p-value = < 2.2e-16
alternative hypothesis: true rho is not equal to 0
sample estimates:
rho
0.6


> R.version
         _
platform i386-pc-mingw32
arch     i386
os       mingw32
system   i386, mingw32
status
major    1
minor    8.0
year     2003
month    10
day      08
language R
>

-----Original Message-----
From: Prof Brian Ripley [mailto:ripley@stats.ox.ac.uk]
Sent: 22 October 2003 11:52
To: i.wilson@maths.abdn.ac.uk
Cc: r-devel@stat.math.ethz.ch; R-bugs@biostat.ku.dk
Subject: Re: [Rd] Something strange in cor.test in R-1.8.0 (PR#4718)


Without knowing the seed used it is impossible for us to reproduce this,
but I am not seeing anything strange.

Could you please reply with a reproducible example (and list the data used
too, in case the random number generation is the issue).


On Wed, 22 Oct 2003 i.wilson@maths.abdn.ac.uk wrote:

> Full_Name: Ian Wilson
> Version: R-1.8.0
> OS: Windows (but own compilation)
> Submission from: (NULL) (139.133.7.38)
>
>
>
> the p-value is incorrect for cor.test using method "spearman" in R-1.8.0.
This
> was not the case in R-1.7.1.
>
> Version R-1.8.0 on Windows
>
> > cor.test(rnorm(50),rnorm(50),method="spearman")
>
> 	Spearman's rank correlation rho
>
> data:  rnorm(50) and rnorm(50)
> S = 20486, p-value = < 2.2e-16
> alternative hypothesis: true rho is not equal to 0
> sample estimates:
>        rho
> 0.01627851
>
> > cor.test(rnorm(50),rnorm(50),method="spearman")
>
> 	Spearman's rank correlation rho
>
> data:  rnorm(50) and rnorm(50)
> S = 22006, p-value = 1
> alternative hypothesis: true rho is not equal to 0
> sample estimates:
>         rho
> -0.05671068
>
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://www.stat.math.ethz.ch/mailman/listinfo/r-devel
>
>

--
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From maechler at stat.math.ethz.ch  Wed Oct 22 16:09:06 2003
From: maechler at stat.math.ethz.ch (maechler@stat.math.ethz.ch)
Date: Wed Oct 22 16:08:05 2003
Subject: [Rd] Something strange in cor.test in R-1.8.0 (PR#4718)
Message-ID: <200310221409.h9ME960P014577@pubhealth.ku.dk>

>>>>> "Duncan" == Duncan Murdoch <dmurdoch@pair.com>
>>>>>     on Wed, 22 Oct 2003 08:17:32 -0400 writes:

    Duncan> I've now tried the code 

 set.seed(1)
 x <- rnorm(50)
 y <- rnorm(50)
 cor.test(x,y,method="spearman")
 x <- rnorm(50)
 y <- rnorm(50)
 cor.test(x,y,method="spearman")

    Duncan> in r-patched (which gives apparently correct results), and r-devel,
    Duncan> which gives the first result correct, the second incorrect; when
    Duncan> repeated, both are bad.
Hmm,
funny.

I get repeatable results in in R 1.7.1 , 1.8.0, R-patched and
R-devel (all on Linux),

with an (ugly but convenient) 1-liner :

> set.seed(1); for(k in 1:2){x <- rnorm(50);y <- rnorm(50);print(unlist(cor.test(x,y,method="spearman")[1:4]))}
  statistic.S       p.value  estimate.rho 
23640.0000000     0.3482088    -0.1351741 
 statistic.S      p.value estimate.rho 
1.724800e+04 2.322263e-01 1.717647e-01 

---
Martin Maechler <maechler@stat.math.ethz.ch>	http://stat.ethz.ch/~maechler/
Seminar fuer Statistik, ETH-Zentrum  LEO C16	Leonhardstr. 27
ETH (Federal Inst. Technology)	8092 Zurich	SWITZERLAND
phone: x-41-1-632-3408		fax: ...-1228			<><

From ggrothendieck at myway.com  Wed Oct 22 17:14:04 2003
From: ggrothendieck at myway.com (Gabor Grothendieck)
Date: Wed Oct 22 17:13:30 2003
Subject: [Rd] Subsetted 1-D arrays (PR#4110)
Message-ID: <20031022151404.46585399D@xmxpita.myway.com>


Prof Brian Ripley <ripley@stats.ox.ac.uk>
> David Brahm <brahm@alum.mit.edu> 
> > Also, *should* you be able to add a (4) array to a (1,4) array?
> No. You cannot in S.

You can't in APL or mathematics either.  

There is a tradeoff between expressiveness and enforcing code
quality.   The downside of giving meaning to otherwise 
non-meaningful expressions is that fewer errors can
be caught by the system -- its harder for the user to detect a 
wrong result than to simply respond to an error message.


_______________________________________________
No banners. No pop-ups. No kidding.
Introducing My Way - http://www.myway.com

From maechler at stat.math.ethz.ch  Wed Oct 22 17:44:57 2003
From: maechler at stat.math.ethz.ch (maechler@stat.math.ethz.ch)
Date: Wed Oct 22 17:43:55 2003
Subject: [Rd] bug in fisher test---p-value cannot be Inf (PR#4688)
Message-ID: <200310221544.h9MFiv0P015644@pubhealth.ku.dk>

>>>>> "kjetil" == kjetil halvorsen <kjetil@entelnet.bo>
>>>>>     on Mon, 20 Oct 2003 20:18:11 +0200 (MET DST) writes:

    kjetil> I just found a bug in fisher.test(). This is rw1080, on windows XP.
    kjetil> A p-value can certainly not be Inf, but:

Thank you, Kjetil.
The bug does not seem to be version or platform dependent,
I see the same on Linux R versions 1.8.0, 1.7.1, 1.5.x.

    >> religion
    kjetil> Costumbres rel orig
    kjetil> Religion      Si Algunas veces Nunca
    kjetil> católica  2121          4700  6234
    kjetil> prot/evan  100           216  2461
    kjetil> otra C      27            67   502
    kjetil> otra         0             0    14

Please use something like  dput() for example data in bug
reports. That way, others can easily use the same data;
alternatively, the following is sufficient to reproduce the bug :

religion <- cbind(Si = c(2121, 100, 27, 0),
                  av = c(4700, 216, 67, 0),
                  Nc = c(6234,2461,502,14))


    >> fisher.test(religion, workspace=2000000)

    kjetil> Fisher's Exact Test for Count Data

    kjetil> data:  religion 
    kjetil> p-value = Inf
    kjetil> alternative hypothesis: two.sided 

Note that this is not the first bug report on fisher.test()...

we have more cases that don't behave as desired, but these at
least give error messages instead of non-sensical results.

I have ordered the original papers and started reading them..

Martin Maechler <maechler@stat.math.ethz.ch>	http://stat.ethz.ch/~maechler/
Seminar fuer Statistik, ETH-Zentrum  LEO C16	Leonhardstr. 27
ETH (Federal Inst. Technology)	8092 Zurich	SWITZERLAND
phone: x-41-1-632-3408		fax: ...-1228			<><

From mckay at gmr.com  Wed Oct 22 19:10:04 2003
From: mckay at gmr.com (mckay@gmr.com)
Date: Wed Oct 22 19:09:03 2003
Subject: [Rd] Core dump when calling tclvalue (PR#4724)
Message-ID: <200310221710.h9MHA40P016151@pubhealth.ku.dk>

Full_Name: Neil McKay
Version: 1.8.0
OS: Linux (RedHat 7.1)
Submission from: (NULL) (129.124.42.210)


I get a core dump when executing the following code:

> library("tcltk")
> zzz<-tclArray()
> tclvalue(zzz)

Running under gdb gives this output:

Program received signal SIGSEGV, Segmentation fault.
makeRTclObject (tclobj=0x0) at tcltk.c:48
48          Tcl_IncrRefCount(tclobj);

From p.dalgaard at biostat.ku.dk  Wed Oct 22 20:01:48 2003
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Wed Oct 22 20:00:43 2003
Subject: [Rd] Core dump when calling tclvalue (PR#4724)
In-Reply-To: <200310221710.h9MHA40P016151@pubhealth.ku.dk>
References: <200310221710.h9MHA40P016151@pubhealth.ku.dk>
Message-ID: <x21xt540dv.fsf@biostat.ku.dk>

mckay@gmr.com writes:

> Full_Name: Neil McKay
> Version: 1.8.0
> OS: Linux (RedHat 7.1)
> Submission from: (NULL) (129.124.42.210)
> 
> 
> I get a core dump when executing the following code:
> 
> > library("tcltk")
> > zzz<-tclArray()
> > tclvalue(zzz)
> 
> Running under gdb gives this output:
> 
> Program received signal SIGSEGV, Segmentation fault.
> makeRTclObject (tclobj=0x0) at tcltk.c:48
> 48          Tcl_IncrRefCount(tclobj);

Hmm. That's not supposed to happen. I'm not sure it is supposed
to do anything useful either though. The wish equivalent is

% array set x ""
% puts $x
can't read "x": variable is array

so it would seem that we're just not failing gracefully.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From ashenfluff at yahoo.com  Wed Oct 22 22:29:23 2003
From: ashenfluff at yahoo.com (ashenfluff@yahoo.com)
Date: Wed Oct 22 22:28:19 2003
Subject: [Rd] assigning to a null data frame. (PR#4727)
Message-ID: <200310222029.h9MKTN0P017460@pubhealth.ku.dk>

Full_Name: Ben K.
Version: 1.8.0
OS: win2k
Submission from: (NULL) (208.243.20.222)



This fails:

vars<-data.frame(NULL)
vars$delta<-4

output: Error in "$<-.data.frame"(`*tmp*`, "delta", value = 4) : 
        replacement has 1 rows, data has 0

It worked in 1.7.0 and all previous, and if we initialize vars without NULL, 
R is OK with it:

vars<-data.frame(dummy=4)
vars$delta<-4

From ihaka at stat.auckland.ac.nz  Thu Oct 23 02:19:28 2003
From: ihaka at stat.auckland.ac.nz (ihaka@stat.auckland.ac.nz)
Date: Thu Oct 23 02:18:23 2003
Subject: [Rd] persp - incorrect shading of triangular facets (PR#4731)
Message-ID: <200310230019.h9N0JS0P018932@pubhealth.ku.dk>

Full_Name: Ross Ihaka
Version: all versions containing persp
OS: linux
Submission from: (NULL) (130.216.191.167)


When is persp is invoked on a matrix of heights which contains missing values,
the surface which is drawn will contain triangular facets.  The shading
computations for these facets are incorrect and always produce black facets.
(I plan to fix this - the report is just in case I forget or get hit by a bus).

From kjetil at entelnet.bo  Thu Oct 23 03:57:01 2003
From: kjetil at entelnet.bo (kjetil@entelnet.bo)
Date: Thu Oct 23 03:55:56 2003
Subject: [Rd] docu buglet in ?text (PR#4732)
Message-ID: <200310230157.h9N1v10P019422@pubhealth.ku.dk>

?text says

...
Labels whose x, y, labels, cex or xol value is NA are omitted from 
the plot. 

I guess xol should be col?

Kjetil Halvorsen

From maechler at stat.math.ethz.ch  Thu Oct 23 09:22:37 2003
From: maechler at stat.math.ethz.ch (maechler@stat.math.ethz.ch)
Date: Thu Oct 23 09:21:31 2003
Subject: [Rd] assigning to a null data frame. (PR#4727)
Message-ID: <200310230722.h9N7Mb0P021301@pubhealth.ku.dk>

>>>>> "ashenfluff" == ashenfluff  <ashenfluff@yahoo.com>
>>>>>     on Wed, 22 Oct 2003 22:29:23 +0200 (MET DST) writes:

    ashenfluff> Full_Name: Ben K.
    ashenfluff> Version: 1.8.0
    ashenfluff> OS: win2k
    ashenfluff> Submission from: (NULL) (208.243.20.222)


    ashenfluff> This fails:

    ashenfluff> vars<-data.frame(NULL)
    ashenfluff> vars$delta<-4

    ashenfluff> output: Error in "$<-.data.frame"(`*tmp*`, "delta", value = 4) : 
    ashenfluff> replacement has 1 rows, data has 0


    ashenfluff> It worked in 1.7.0 and all previous, 

well, I think it was a bug in the way it did "worked", since it
left a very strange object `vars' that certainly wasn't a valid data frame:

Whereas data.frame(NULL) is a valid data.frame, the `vars' resulting fron
vars$delta <- 4  definitely wasn't valid in R 1.7.1 : 
it had rownames of length 0 and dimension c(0, 1):

> v <- data.frame(NULL); v$delta <- 4; v
[1] delta
<0 rows> (or 0-length row.names)
> dim(v)
[1] 0 1
> dput(v)
structure(list(delta = 4), .Names = "delta", row.names = character(0), class = "data.frame")

Note that S-plus 6.1.2 has the same problematic behavior as R(<= 1.7.1).

----

I do agree that the data.frame method for "$<-" could be made to
work "properly" here (namely producing a data frame of dimension
(1,1) with rownames = "1").
BTW, I think even more than that I would argue that I'd want
cbind() to work with data.frame(NULL), i.e.,
the following could be made to work

    v <- data.frame(NULL)
    v <- cbind(v, delta = 4)

(It does work in S+ though there, the 1st statement gives a
 warning, and the 2nd gives two warnings ..)

    ashenfluff>  and if we initialize vars without NULL, 
    ashenfluff> R is OK with it:

    ashenfluff> vars<-data.frame(dummy=4)
    ashenfluff> vars$delta<-4

Yes, because in this call to data.frame(.) you
produced a well-dimensioned data.frame  with which  the "$<-"
operator worked properly.

From Kurt.Hornik at wu-wien.ac.at  Thu Oct 23 09:40:12 2003
From: Kurt.Hornik at wu-wien.ac.at (Kurt Hornik)
Date: Thu Oct 23 09:41:28 2003
Subject: [Rd] Problem R-1.8.0 library tcltk on Tcl-8.0.5 (PR#4699)
In-Reply-To: <x28ynehaeo.fsf@biostat.ku.dk>
References: <200310210429.h9L4Tq0P021121@pubhealth.ku.dk>
	<x28ynfdr0c.fsf@biostat.ku.dk>
	<16277.19104.764444.11251@mithrandir.hornik.net>
	<x28ynehaeo.fsf@biostat.ku.dk>
Message-ID: <16279.34268.640931.682061@mithrandir.hornik.net>

>>>>> Peter Dalgaard writes:

> Kurt Hornik <Kurt.Hornik@wu-wien.ac.at> writes:
>> > (Argh. The test builds of 1.8.0 were actually against tcl8.0, but
>> > apparently our testing procedures skip any attempt to load the dynlib.
>> > Automated tests of tcl/tk are difficult because Tk will protest if
>> > there is no X display.)
>> 
>> On systems which have Xvfb, this is not a problem.
>> 
>> The daily package checker uses this, for example.

> Hmm it is more tricky than that it seems. I see

> comparing 'stepfun-Ex.Rout' to 'stepfun-Ex.Rout.prev' ... OK
> running code in 'tcltk-Ex.R' ... OK
> comparing 'tcltk-Ex.Rout' to 'tcltk-Ex.Rout.prev' ... OK
> collecting examples for package 'ts' ...
> make[5]: Entering directory `/e7/pd/r-devel/BUILD/src/library'

> However, 

> [pd@franz BUILD]$ tail  tests/Examples/tcltk-Ex.Rout
>> postscript("tcltk-Examples.ps")
>> assign("par.postscript", par(no.readonly = TRUE), env = .CheckExEnv)
>> options(contrasts = c(unordered = "contr.treatment", ordered = "contr.poly"))
>> require('tcltk') || q()
> Loading required package: tcltk
> Error in dyn.load(x, as.logical(local), as.logical(now)) :
>         unable to load shared library "/e7/pd/r-devel/BUILD/library/tcltk/libs/tcltk.so":
>   /e7/pd/r-devel/BUILD/library/tcltk/libs/tcltk.so: undefined symbol: RTcl_ActivateConsole
> Error in runHook(".onLoad", env, package.lib, package) :
>         .onLoad failed

> I.e. the seeming pass of make check is really just reflecting the fact
> that I got the same catastrophic failure as last time I ran it... 

> Is there a better way?

[Untested.]

Maybe we want to try to look more closely at why require("tcltk") might
have failed, as opposed to always exiting gracefully on failure via

  require('tcltk') || q()

Something like

  yy <- try(require("tcltk"), silent = TRUE)
  if(any(regexpr("^Tcl/Tk support is not available") > -1))
    q()
  else
    stop(yy)

???

-k

From Kurt.Hornik at wu-wien.ac.at  Thu Oct 23 13:04:15 2003
From: Kurt.Hornik at wu-wien.ac.at (Kurt Hornik)
Date: Thu Oct 23 13:06:09 2003
Subject: [Rd] Something strange in cor.test in R-1.8.0 (PR#4718)
In-Reply-To: <200310221409.h9ME960P014577@pubhealth.ku.dk>
References: <200310221409.h9ME960P014577@pubhealth.ku.dk>
Message-ID: <16279.46511.714468.14454@mithrandir.hornik.net>

>>>>> maechler  writes:

>>>>> "Duncan" == Duncan Murdoch <dmurdoch@pair.com>
>>>>>     on Wed, 22 Oct 2003 08:17:32 -0400 writes:

Duncan> I've now tried the code 

>  set.seed(1)
>  x <- rnorm(50)
>  y <- rnorm(50)
>  cor.test(x,y,method="spearman")
>  x <- rnorm(50)
>  y <- rnorm(50)
>  cor.test(x,y,method="spearman")

Duncan> in r-patched (which gives apparently correct results), and r-devel,
Duncan> which gives the first result correct, the second incorrect; when
Duncan> repeated, both are bad.
> Hmm,
> funny.

> I get repeatable results in in R 1.7.1 , 1.8.0, R-patched and
> R-devel (all on Linux),

> with an (ugly but convenient) 1-liner :

>> set.seed(1); for(k in 1:2){x <- rnorm(50);y <- rnorm(50);print(unlist(cor.test(x,y,method="spearman")[1:4]))}
>   statistic.S       p.value  estimate.rho 
> 23640.0000000     0.3482088    -0.1351741 
>  statistic.S      p.value estimate.rho 
> 1.724800e+04 2.322263e-01 1.717647e-01

I get the same on Debian GNU/Linux.

Where do we stand on this?  Windows-specific?

-k

From p.dalgaard at biostat.ku.dk  Thu Oct 23 13:44:45 2003
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Thu Oct 23 13:40:18 2003
Subject: [Rd] Something strange in cor.test in R-1.8.0 (PR#4718)
In-Reply-To: <16279.46511.714468.14454@mithrandir.hornik.net>
References: <200310221409.h9ME960P014577@pubhealth.ku.dk>
	<16279.46511.714468.14454@mithrandir.hornik.net>
Message-ID: <x23cdk89g2.fsf@biostat.ku.dk>

Kurt Hornik <Kurt.Hornik@wu-wien.ac.at> writes:

> >>>>> maechler  writes:
> 
> >>>>> "Duncan" == Duncan Murdoch <dmurdoch@pair.com>
> >>>>>     on Wed, 22 Oct 2003 08:17:32 -0400 writes:
> 
> Duncan> I've now tried the code 
> 
> >  set.seed(1)
> >  x <- rnorm(50)
> >  y <- rnorm(50)
> >  cor.test(x,y,method="spearman")
> >  x <- rnorm(50)
> >  y <- rnorm(50)
> >  cor.test(x,y,method="spearman")
> 
> Duncan> in r-patched (which gives apparently correct results), and r-devel,
> Duncan> which gives the first result correct, the second incorrect; when
> Duncan> repeated, both are bad.
> > Hmm,
> > funny.
> 
> > I get repeatable results in in R 1.7.1 , 1.8.0, R-patched and
> > R-devel (all on Linux),
> 
> > with an (ugly but convenient) 1-liner :
> 
> >> set.seed(1); for(k in 1:2){x <- rnorm(50);y <- rnorm(50);print(unlist(cor.test(x,y,method="spearman")[1:4]))}
> >   statistic.S       p.value  estimate.rho 
> > 23640.0000000     0.3482088    -0.1351741 
> >  statistic.S      p.value estimate.rho 
> > 1.724800e+04 2.322263e-01 1.717647e-01
> 
> I get the same on Debian GNU/Linux.
> 
> Where do we stand on this?  Windows-specific?

Probably, but of a nasty kind which I think we need to get to the
bottom of. As I see it there are two possible causes

1. A bug in a Windows library or compiler. Potentially that could
   affect everything else.
2. A bug in ctest that just happens only to cause visible damage on
   Windows, but perhaps invisible damage elsewhere.

Either way, I think we need to investigate. 

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From p.dalgaard at biostat.ku.dk  Thu Oct 23 13:41:13 2003
From: p.dalgaard at biostat.ku.dk (p.dalgaard@biostat.ku.dk)
Date: Thu Oct 23 13:40:42 2003
Subject: [Rd] Something strange in cor.test in R-1.8.0 (PR#4718)
Message-ID: <200310231141.h9NBfD0P026823@pubhealth.ku.dk>

Kurt Hornik <Kurt.Hornik@wu-wien.ac.at> writes:

> >>>>> maechler  writes:
> 
> >>>>> "Duncan" == Duncan Murdoch <dmurdoch@pair.com>
> >>>>>     on Wed, 22 Oct 2003 08:17:32 -0400 writes:
> 
> Duncan> I've now tried the code 
> 
> >  set.seed(1)
> >  x <- rnorm(50)
> >  y <- rnorm(50)
> >  cor.test(x,y,method="spearman")
> >  x <- rnorm(50)
> >  y <- rnorm(50)
> >  cor.test(x,y,method="spearman")
> 
> Duncan> in r-patched (which gives apparently correct results), and r-devel,
> Duncan> which gives the first result correct, the second incorrect; when
> Duncan> repeated, both are bad.
> > Hmm,
> > funny.
> 
> > I get repeatable results in in R 1.7.1 , 1.8.0, R-patched and
> > R-devel (all on Linux),
> 
> > with an (ugly but convenient) 1-liner :
> 
> >> set.seed(1); for(k in 1:2){x <- rnorm(50);y <- rnorm(50);print(unlist(cor.test(x,y,method="spearman")[1:4]))}
> >   statistic.S       p.value  estimate.rho 
> > 23640.0000000     0.3482088    -0.1351741 
> >  statistic.S      p.value estimate.rho 
> > 1.724800e+04 2.322263e-01 1.717647e-01
> 
> I get the same on Debian GNU/Linux.
> 
> Where do we stand on this?  Windows-specific?

Probably, but of a nasty kind which I think we need to get to the
bottom of. As I see it there are two possible causes

1. A bug in a Windows library or compiler. Potentially that could
   affect everything else.
2. A bug in ctest that just happens only to cause visible damage on
   Windows, but perhaps invisible damage elsewhere.

Either way, I think we need to investigate. 

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From Kurt.Hornik at wu-wien.ac.at  Thu Oct 23 13:44:32 2003
From: Kurt.Hornik at wu-wien.ac.at (Kurt.Hornik@wu-wien.ac.at)
Date: Thu Oct 23 13:44:29 2003
Subject: [Rd] Something strange in cor.test in R-1.8.0 (PR#4718)
Message-ID: <200310231144.h9NBiW0P026913@pubhealth.ku.dk>

>>>>> Peter Dalgaard writes:

> Kurt Hornik <Kurt.Hornik@wu-wien.ac.at> writes:
>> >>>>> maechler  writes:
>> 
>> >>>>> "Duncan" == Duncan Murdoch <dmurdoch@pair.com>
>> >>>>>     on Wed, 22 Oct 2003 08:17:32 -0400 writes:
>> 
Duncan> I've now tried the code 
>> 
>> >  set.seed(1)
>> >  x <- rnorm(50)
>> >  y <- rnorm(50)
>> >  cor.test(x,y,method="spearman")
>> >  x <- rnorm(50)
>> >  y <- rnorm(50)
>> >  cor.test(x,y,method="spearman")
>> 
Duncan> in r-patched (which gives apparently correct results), and r-devel,
Duncan> which gives the first result correct, the second incorrect; when
Duncan> repeated, both are bad.
>> > Hmm,
>> > funny.
>> 
>> > I get repeatable results in in R 1.7.1 , 1.8.0, R-patched and
>> > R-devel (all on Linux),
>> 
>> > with an (ugly but convenient) 1-liner :
>> 
>> >> set.seed(1); for(k in 1:2){x <- rnorm(50);y <- rnorm(50);print(unlist(cor.test(x,y,method="spearman")[1:4]))}
>> >   statistic.S       p.value  estimate.rho 
>> > 23640.0000000     0.3482088    -0.1351741 
>> >  statistic.S      p.value estimate.rho 
>> > 1.724800e+04 2.322263e-01 1.717647e-01
>> 
>> I get the same on Debian GNU/Linux.
>> 
>> Where do we stand on this?  Windows-specific?

> Probably, but of a nasty kind which I think we need to get to the
> bottom of. As I see it there are two possible causes

> 1. A bug in a Windows library or compiler. Potentially that could
>    affect everything else.
> 2. A bug in ctest that just happens only to cause visible damage on
>    Windows, but perhaps invisible damage elsewhere.

> Either way, I think we need to investigate.

As Brian had written earlier in this thread, we need a reproducible
example.  If Duncan's example can be reproduced on Windows but not on
Linux (and I cannot), odds are in favor of the problem being Windows
specific.

-k

From Kurt.Hornik at wu-wien.ac.at  Thu Oct 23 13:41:57 2003
From: Kurt.Hornik at wu-wien.ac.at (Kurt Hornik)
Date: Thu Oct 23 13:44:42 2003
Subject: [Rd] Something strange in cor.test in R-1.8.0 (PR#4718)
In-Reply-To: <x23cdk89g2.fsf@biostat.ku.dk>
References: <200310221409.h9ME960P014577@pubhealth.ku.dk>
	<16279.46511.714468.14454@mithrandir.hornik.net>
	<x23cdk89g2.fsf@biostat.ku.dk>
Message-ID: <16279.48773.348306.656697@mithrandir.hornik.net>

>>>>> Peter Dalgaard writes:

> Kurt Hornik <Kurt.Hornik@wu-wien.ac.at> writes:
>> >>>>> maechler  writes:
>> 
>> >>>>> "Duncan" == Duncan Murdoch <dmurdoch@pair.com>
>> >>>>>     on Wed, 22 Oct 2003 08:17:32 -0400 writes:
>> 
Duncan> I've now tried the code 
>> 
>> >  set.seed(1)
>> >  x <- rnorm(50)
>> >  y <- rnorm(50)
>> >  cor.test(x,y,method="spearman")
>> >  x <- rnorm(50)
>> >  y <- rnorm(50)
>> >  cor.test(x,y,method="spearman")
>> 
Duncan> in r-patched (which gives apparently correct results), and r-devel,
Duncan> which gives the first result correct, the second incorrect; when
Duncan> repeated, both are bad.
>> > Hmm,
>> > funny.
>> 
>> > I get repeatable results in in R 1.7.1 , 1.8.0, R-patched and
>> > R-devel (all on Linux),
>> 
>> > with an (ugly but convenient) 1-liner :
>> 
>> >> set.seed(1); for(k in 1:2){x <- rnorm(50);y <- rnorm(50);print(unlist(cor.test(x,y,method="spearman")[1:4]))}
>> >   statistic.S       p.value  estimate.rho 
>> > 23640.0000000     0.3482088    -0.1351741 
>> >  statistic.S      p.value estimate.rho 
>> > 1.724800e+04 2.322263e-01 1.717647e-01
>> 
>> I get the same on Debian GNU/Linux.
>> 
>> Where do we stand on this?  Windows-specific?

> Probably, but of a nasty kind which I think we need to get to the
> bottom of. As I see it there are two possible causes

> 1. A bug in a Windows library or compiler. Potentially that could
>    affect everything else.
> 2. A bug in ctest that just happens only to cause visible damage on
>    Windows, but perhaps invisible damage elsewhere.

> Either way, I think we need to investigate.

As Brian had written earlier in this thread, we need a reproducible
example.  If Duncan's example can be reproduced on Windows but not on
Linux (and I cannot), odds are in favor of the problem being Windows
specific.

-k

From p.dalgaard at biostat.ku.dk  Thu Oct 23 13:54:07 2003
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Thu Oct 23 13:49:32 2003
Subject: [Rd] Something strange in cor.test in R-1.8.0 (PR#4718)
In-Reply-To: <200310231144.h9NBiW0P026913@pubhealth.ku.dk>
References: <200310231144.h9NBiW0P026913@pubhealth.ku.dk>
Message-ID: <x2y8vc6ug0.fsf@biostat.ku.dk>

Kurt.Hornik@wu-wien.ac.at writes:

> > Probably, but of a nasty kind which I think we need to get to the
> > bottom of. As I see it there are two possible causes
> 
> > 1. A bug in a Windows library or compiler. Potentially that could
> >    affect everything else.
> > 2. A bug in ctest that just happens only to cause visible damage on
> >    Windows, but perhaps invisible damage elsewhere.
> 
> > Either way, I think we need to investigate.
> 
> As Brian had written earlier in this thread, we need a reproducible
> example.  If Duncan's example can be reproduced on Windows but not on
> Linux (and I cannot), odds are in favor of the problem being Windows
> specific.

No, odds are in favor of the *symptom* being Windows-specific. See
above... Problem is, we need a Windows guru to debug in that case.

        -p

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From ripley at stats.ox.ac.uk  Thu Oct 23 14:05:43 2003
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu Oct 23 14:05:31 2003
Subject: [Rd] Something strange in cor.test in R-1.8.0 (PR#4718)
In-Reply-To: <x2y8vc6ug0.fsf@biostat.ku.dk>
Message-ID: <Pine.LNX.4.44.0310231302200.1337-100000@gannet.stats>

On 23 Oct 2003, Peter Dalgaard wrote:

> Kurt.Hornik@wu-wien.ac.at writes:
> 
> > > Probably, but of a nasty kind which I think we need to get to the
> > > bottom of. As I see it there are two possible causes
> > 
> > > 1. A bug in a Windows library or compiler. Potentially that could
> > >    affect everything else.
> > > 2. A bug in ctest that just happens only to cause visible damage on
> > >    Windows, but perhaps invisible damage elsewhere.
> > 
> > > Either way, I think we need to investigate.
> > 
> > As Brian had written earlier in this thread, we need a reproducible
> > example.  If Duncan's example can be reproduced on Windows but not on
> > Linux (and I cannot), odds are in favor of the problem being Windows
> > specific.
> 
> No, odds are in favor of the *symptom* being Windows-specific. See
> above... Problem is, we need a Windows guru to debug in that case.


cor.test.default calls the second arg of prho as as.integer(q + 1), but
someone altered the C code (at the last minute before 1.8.0 was frozen) to
*double.

So I think Peter is probably right.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From ripley at stats.ox.ac.uk  Thu Oct 23 14:05:51 2003
From: ripley at stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Thu Oct 23 14:05:49 2003
Subject: [Rd] Something strange in cor.test in R-1.8.0 (PR#4718)
Message-ID: <200310231205.h9NC5p0P027369@pubhealth.ku.dk>

On 23 Oct 2003, Peter Dalgaard wrote:

> Kurt.Hornik@wu-wien.ac.at writes:
> 
> > > Probably, but of a nasty kind which I think we need to get to the
> > > bottom of. As I see it there are two possible causes
> > 
> > > 1. A bug in a Windows library or compiler. Potentially that could
> > >    affect everything else.
> > > 2. A bug in ctest that just happens only to cause visible damage on
> > >    Windows, but perhaps invisible damage elsewhere.
> > 
> > > Either way, I think we need to investigate.
> > 
> > As Brian had written earlier in this thread, we need a reproducible
> > example.  If Duncan's example can be reproduced on Windows but not on
> > Linux (and I cannot), odds are in favor of the problem being Windows
> > specific.
> 
> No, odds are in favor of the *symptom* being Windows-specific. See
> above... Problem is, we need a Windows guru to debug in that case.


cor.test.default calls the second arg of prho as as.integer(q + 1), but
someone altered the C code (at the last minute before 1.8.0 was frozen) to
*double.

So I think Peter is probably right.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From Simon.Urbanek at math.uni-augsburg.de  Thu Oct 23 14:21:08 2003
From: Simon.Urbanek at math.uni-augsburg.de (Simon Urbanek)
Date: Thu Oct 23 14:20:28 2003
Subject: [Rd] linking to R.dll on Win32 - issues with recent MinGW?
Message-ID: <61B2C492-0553-11D8-BE10-000A957CEFBA@math.uni-augsburg.de>

I encountered several strange issues when linking to R.dll on Windows 
and I wonder if anyone of the Windows savvy-folks here had seen some of 
the issues before and have some explanation.

My Rserve links to R dynamic library. That works perfectly on unix 
boxes and worked fairly well with older MinGW and older R (<=1.7.1). 
What I do in fact is that I specify
-L$(R_HOME)/bin -lR
when linking. This produced valid exe which was linked to R.dll. In 
fact you could compile everything with the regular binary distribution 
of R, even without R sources (MinGW got all it needs directly from 
R.dll).

Now with R-1.8.0 (which is presumably compiled with more recent MinGW) 
and MinGW 3.1 this doesn't work anymore on certain Win32 platforms, 
e.g. I got reports that on W2k Rserve bails out with "Can't load 
R.dll". Further investigation reveals that the .exe tries to load "R" 
file and not "R.dll". But if you copy R.dll to R then both R and R.dll 
get loaded, since R loads Rblas.dll which loads (correctly) R.dll. Then 
everything crashes (presumably the two dlls fight each other). XP seems 
to have a fix for that (i.e. a request for "R" will in fact load 
"R.dll"), but not W2k.

Did anyone see this or does anyone have an idea how to prevent this 
(except for downgrading MinGW)?

Now, I thought I'll use libR.a from the R sources instead of using the 
final R.dll, because that's what libR.a is for, right? The first 
obstacle was that libR.a doesn't export R_Home which I need to set in 
my init routine, but fortunately there is "exported-vars" for that 
case. But after finally compiling everything, Rserve crashes. It 
doesn't even get as far as main. What I get is this:
Warning: Invalid Address specified to RtlSizeHeap( 003F0000, 0146008 )
and later a crash somewhere deep in libwsock32 (the trace is rather 
weird) ... I guess the problem is the heap, not wsock itself. Any idea 
what that could be?

All the above was tested with MinGW-3.1.
Any ideas? Is that a MinGW bug or something I did? ;)

Thanks.
Simon

---
Simon Urbanek
Department of computer oriented statistics and data analysis
University of Augsburg
Universit?tsstr. 14
86135 Augsburg
Germany

Tel: +49-821-598-2236
Fax: +49-821-598-2200

Simon.Urbanek@Math.Uni-Augsburg.de
http://simon.urbanek.info

From maechler at stat.math.ethz.ch  Thu Oct 23 14:36:13 2003
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Thu Oct 23 14:35:16 2003
Subject: [Rd] Re: ichar() function in R : 1st implementation, RFC
In-Reply-To: <FC026A0F0EE43E42A6EE465E2C7FFF78033D6B37@coxs-nh.nsw.cmis.CSIRO.AU>
References: <FC026A0F0EE43E42A6EE465E2C7FFF78033D6B37@coxs-nh.nsw.cmis.CSIRO.AU>
Message-ID: <16279.52029.297228.504349@gargle.gargle.HOWL>

(RFC := Request For Comments)

>>>>> "Tim" == Tim Keighley <Tim.Keighley@csiro.au>
>>>>>     on Thu, 23 Oct 2003 11:45:22 +1000 writes:

    Tim> Hi Martin,
    Tim> In October 2000 you wrote to r-help:

    >>> which reminds me that I've had a desire for something like
    >>> the old S function [from the blue book, and library(examples) I think]
    >>> ichar(ch)
    >>> which would return a vector of integers, each the (decimal) equivalent of
    >>> the (ISO-latin1) representation of the corresponding characters in ch.
    >>> 
    >>> This should be easy enough (and be done in C).
    >>> Any volunteers?

    Tim> Did you get any volunteers?
no.
Thank you for reminding me!

    Tim> Is this function or an
    Tim> equivalent now available in R? I have been unsuccessful
    Tim> in my investigation but I do not have all the available
    Tim> CRAN packages, so it might be in one of them.

I've searched myself (we have almost all of them installed), and
didn't find anything.

    Tim> Cheers,
    Tim> Tim Keighley

I now did a first cut, using R only code,
(and realizing that most of  chars8bit() should really happen in C).

I'm proposing to add something like this to R-devel in the near
future.
Note that  AsciiToInt() and ichar() ar for S-plus and "old S"
compatibility, whereas I think we'd really want (equivalents) of
the three functions
    digitsBase()
    chars8bit()
    strcodes()
in R eventually.  

I'm very interested in feedback, 
particularly
- function and arguments' naming
- proposals for improvements
- neat examples of usage.

Martin

Martin Maechler <maechler@stat.math.ethz.ch>	http://stat.ethz.ch/~maechler/
Seminar fuer Statistik, ETH-Zentrum  LEO C16	Leonhardstr. 27
ETH (Federal Inst. Technology)	8092 Zurich	SWITZERLAND
phone: x-41-1-632-3408		fax: ...-1228			<><

-------------- next part --------------

### This was  digits.v()  in library(sfsmisc):
### --> get it's help() file /u/maechler/R/Pkgs/sfsmisc/man/digits.Rd
digitsBase <- function(x, base = 2, ndigits = 1 + floor(log(max(x),base)))
{
    ## Purpose: Give the vector A of the base-_base_ representation of _n_:
    ## -------  n = sum_{k=0}^M  A_{M-k} base ^ k ,   where  M = length(a) - 1
    ## Value: MATRIX  M where  M[,i]  corresponds to  x[i]
    ##	c( result ) then contains the blocks in proper order ..
    ## Author: Martin Maechler, Date:  Wed Dec  4 14:10:27 1991
    ## ----------------------------------------------------------------
    ## Arguments: x: vector of non-negative integers
    ##	base: Base for representation
    ##	ndigits: Number of digits/bits to use
    ## EXAMPLE: digitsBase(1:24, 8) #-- octal representation
    ## ----------------------------------------------------------------
    if(any((x <- as.integer(x)) < 0))
        stop("`x' must be non-negative integers")
    r <- matrix(0, nrow = ndigits, ncol = length(x))
    if(ndigits >= 1) for (i in ndigits:1) {
        r[i,] <- x %% base
        if (i > 1) x <- x %/% base
    }
    r
}


### This is an improved version of  make.ASCII() in 1991's ~/S/Good-string.S !
chars8bit <- function(i = 0:255)
{
    ## Purpose: Compute a character vector from its "ASCII" codes.
    ## We seem to have to use this complicated way thru text and parse.

    ## Author: Martin Maechler, Original date: Wed Dec 4, 1991
    ## ----------------------------------------------------------------
    i <- as.integer(i)
    if(any(i < 0 | i > 255)) stop("`i' must be in 0:255")
    i8 <- apply(digitsBase(i, base = 8), 2, paste, collapse="")
    c8 <- paste('"\\', i8, '"', sep="")
    eval(parse(text = paste("c(",paste(c8, collapse=","),")", sep="")))
}

strcodes <- function(x, table = chars8bit(0:255))
{
    ## Purpose: R (code) implementation of old S's ichar()
    ## ----------------------------------------------------------------------
    ## Arguments: x: character vector
    ## ----------------------------------------------------------------------
    ## Author: Martin Maechler, Date: 23 Oct 2003, 12:42

    lapply(strsplit(x, ""), match, table = table)
}

## S-PLUS has  AsciiToInt() officially, and   ichar() in  library(examples):
AsciiToInt <- ichar <- function(strings) unname(unlist(strcodes(strings)))

## Examples:

all8bit <- chars8bit(0:255)
matrix(all8bit, 32, 8, byrow = TRUE)

x <- c(a = "abc", bb = "BLA & blu", Person = "M?chler, Z?rich")
strcodes(x)
AsciiToInt(x)
From ripley at stats.ox.ac.uk  Thu Oct 23 15:09:01 2003
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu Oct 23 15:08:11 2003
Subject: [Rd] linking to R.dll on Win32 - issues with recent MinGW?
In-Reply-To: <61B2C492-0553-11D8-BE10-000A957CEFBA@math.uni-augsburg.de>
Message-ID: <Pine.LNX.4.44.0310231359430.1443-100000@gannet.stats>

I was told that direct linking against foo.dll is not supported. One
problem is that the link priority order gets broken, and R.dll gets used
for things it should not be used for (malloc springs to mind).

You should be able to use libR.a, though.  It does not need to export 
R_Home, as you should know what that is when you call R_SetParams.
I would make sure that you are really using the mallocs you think you are.
(One day soon we will try to find a better solution for that, but that 
probably depends on me having a working Windows laptop again, as well as 
time to program on it.)

In a few places (Rlapack.dll as I recall) we have had to force in entry 
points to get things resolved in the right place: pedump will tell you 
where they are resolved, and at least this is done at link time and not 
run time so is fairly easy to track down.

Brian

On Thu, 23 Oct 2003, Simon Urbanek wrote:

> I encountered several strange issues when linking to R.dll on Windows 
> and I wonder if anyone of the Windows savvy-folks here had seen some of 
> the issues before and have some explanation.
> 
> My Rserve links to R dynamic library. That works perfectly on unix 
> boxes and worked fairly well with older MinGW and older R (<=1.7.1). 
> What I do in fact is that I specify
> -L$(R_HOME)/bin -lR
> when linking. This produced valid exe which was linked to R.dll. In 
> fact you could compile everything with the regular binary distribution 
> of R, even without R sources (MinGW got all it needs directly from 
> R.dll).
> 
> Now with R-1.8.0 (which is presumably compiled with more recent MinGW) 
> and MinGW 3.1 this doesn't work anymore on certain Win32 platforms, 
> e.g. I got reports that on W2k Rserve bails out with "Can't load 
> R.dll". Further investigation reveals that the .exe tries to load "R" 
> file and not "R.dll". But if you copy R.dll to R then both R and R.dll 
> get loaded, since R loads Rblas.dll which loads (correctly) R.dll. Then 
> everything crashes (presumably the two dlls fight each other). XP seems 
> to have a fix for that (i.e. a request for "R" will in fact load 
> "R.dll"), but not W2k.
> 
> Did anyone see this or does anyone have an idea how to prevent this 
> (except for downgrading MinGW)?
> 
> Now, I thought I'll use libR.a from the R sources instead of using the 
> final R.dll, because that's what libR.a is for, right? The first 
> obstacle was that libR.a doesn't export R_Home which I need to set in 
> my init routine, but fortunately there is "exported-vars" for that 
> case. But after finally compiling everything, Rserve crashes. It 
> doesn't even get as far as main. What I get is this:
> Warning: Invalid Address specified to RtlSizeHeap( 003F0000, 0146008 )
> and later a crash somewhere deep in libwsock32 (the trace is rather 
> weird) ... I guess the problem is the heap, not wsock itself. Any idea 
> what that could be?
> 
> All the above was tested with MinGW-3.1.
> Any ideas? Is that a MinGW bug or something I did? ;)
> 
> Thanks.
> Simon
> 
> ---
> Simon Urbanek
> Department of computer oriented statistics and data analysis
> University of Augsburg
> Universit?tsstr. 14
> 86135 Augsburg
> Germany
> 
> Tel: +49-821-598-2236
> Fax: +49-821-598-2200
> 
> Simon.Urbanek@Math.Uni-Augsburg.de
> http://simon.urbanek.info
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://www.stat.math.ethz.ch/mailman/listinfo/r-devel
> 
> 

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From Kurt.Hornik at wu-wien.ac.at  Thu Oct 23 17:14:02 2003
From: Kurt.Hornik at wu-wien.ac.at (Kurt Hornik)
Date: Thu Oct 23 17:15:44 2003
Subject: [Rd] Re: ichar() function in R : 1st implementation, RFC
In-Reply-To: <16279.52029.297228.504349@gargle.gargle.HOWL>
References: <FC026A0F0EE43E42A6EE465E2C7FFF78033D6B37@coxs-nh.nsw.cmis.CSIRO.AU>
	<16279.52029.297228.504349@gargle.gargle.HOWL>
Message-ID: <16279.61498.815176.585303@mithrandir.hornik.net>

>>>>> Martin Maechler writes:

> (RFC := Request For Comments)

My preference would be that we start by adding a version of sscanf().

-k

>>>>> "Tim" == Tim Keighley <Tim.Keighley@csiro.au>
>>>>>     on Thu, 23 Oct 2003 11:45:22 +1000 writes:

Tim> Hi Martin,
Tim> In October 2000 you wrote to r-help:

>>>> which reminds me that I've had a desire for something like
>>>> the old S function [from the blue book, and library(examples) I think]
>>>> ichar(ch)
>>>> which would return a vector of integers, each the (decimal) equivalent of
>>>> the (ISO-latin1) representation of the corresponding characters in ch.
>>>> 
>>>> This should be easy enough (and be done in C).
>>>> Any volunteers?

Tim> Did you get any volunteers?
> no.
> Thank you for reminding me!

Tim> Is this function or an
Tim> equivalent now available in R? I have been unsuccessful
Tim> in my investigation but I do not have all the available
Tim> CRAN packages, so it might be in one of them.

> I've searched myself (we have almost all of them installed), and
> didn't find anything.

Tim> Cheers,
Tim> Tim Keighley

> I now did a first cut, using R only code,
> (and realizing that most of  chars8bit() should really happen in C).

> I'm proposing to add something like this to R-devel in the near
> future.
> Note that  AsciiToInt() and ichar() ar for S-plus and "old S"
> compatibility, whereas I think we'd really want (equivalents) of
> the three functions
>     digitsBase()
>     chars8bit()
>     strcodes()
> in R eventually.  

> I'm very interested in feedback, 
> particularly
> - function and arguments' naming
> - proposals for improvements
> - neat examples of usage.

> Martin

> Martin Maechler <maechler@stat.math.ethz.ch>	http://stat.ethz.ch/~maechler/
> Seminar fuer Statistik, ETH-Zentrum  LEO C16	Leonhardstr. 27
> ETH (Federal Inst. Technology)	8092 Zurich	SWITZERLAND
> phone: x-41-1-632-3408		fax: ...-1228			<><


> ### This was  digits.v()  in library(sfsmisc):
> ### --> get it's help() file /u/maechler/R/Pkgs/sfsmisc/man/digits.Rd
> digitsBase <- function(x, base = 2, ndigits = 1 + floor(log(max(x),base)))
> {
>     ## Purpose: Give the vector A of the base-_base_ representation of _n_:
>     ## -------  n = sum_{k=0}^M  A_{M-k} base ^ k ,   where  M = length(a) - 1
>     ## Value: MATRIX  M where  M[,i]  corresponds to  x[i]
>     ##	c( result ) then contains the blocks in proper order ..
>     ## Author: Martin Maechler, Date:  Wed Dec  4 14:10:27 1991
>     ## ----------------------------------------------------------------
>     ## Arguments: x: vector of non-negative integers
>     ##	base: Base for representation
>     ##	ndigits: Number of digits/bits to use
>     ## EXAMPLE: digitsBase(1:24, 8) #-- octal representation
>     ## ----------------------------------------------------------------
>     if(any((x <- as.integer(x)) < 0))
>         stop("`x' must be non-negative integers")
>     r <- matrix(0, nrow = ndigits, ncol = length(x))
>     if(ndigits >= 1) for (i in ndigits:1) {
>         r[i,] <- x %% base
>         if (i > 1) x <- x %/% base
>     }
>     r
> }


> ### This is an improved version of  make.ASCII() in 1991's ~/S/Good-string.S !
> chars8bit <- function(i = 0:255)
> {
>     ## Purpose: Compute a character vector from its "ASCII" codes.
>     ## We seem to have to use this complicated way thru text and parse.

>     ## Author: Martin Maechler, Original date: Wed Dec 4, 1991
>     ## ----------------------------------------------------------------
>     i <- as.integer(i)
>     if(any(i < 0 | i > 255)) stop("`i' must be in 0:255")
>     i8 <- apply(digitsBase(i, base = 8), 2, paste, collapse="")
>     c8 <- paste('"\\', i8, '"', sep="")
>     eval(parse(text = paste("c(",paste(c8, collapse=","),")", sep="")))
> }

> strcodes <- function(x, table = chars8bit(0:255))
> {
>     ## Purpose: R (code) implementation of old S's ichar()
>     ## ----------------------------------------------------------------------
>     ## Arguments: x: character vector
>     ## ----------------------------------------------------------------------
>     ## Author: Martin Maechler, Date: 23 Oct 2003, 12:42

>     lapply(strsplit(x, ""), match, table = table)
> }

> ## S-PLUS has  AsciiToInt() officially, and   ichar() in  library(examples):
> AsciiToInt <- ichar <- function(strings) unname(unlist(strcodes(strings)))

> ## Examples:

> all8bit <- chars8bit(0:255)
> matrix(all8bit, 32, 8, byrow = TRUE)

> x <- c(a = "abc", bb = "BLA & blu", Person = "M?chler, Z?rich")
> strcodes(x)
> AsciiToInt(x)
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://www.stat.math.ethz.ch/mailman/listinfo/r-devel

From jgentry at jimmy.harvard.edu  Thu Oct 23 17:23:56 2003
From: jgentry at jimmy.harvard.edu (Jeff Gentry)
Date: Thu Oct 23 17:24:00 2003
Subject: [Rd] Accessing data files w/ --use-zip-data
Message-ID: <Pine.SOL.4.20.0310231116360.13471-100000@santiam.dfci.harvard.edu>


I have encountered an issue while preparing some of the Bioconductor
packages for our upcoming release, and Duncan Murdoch suggested that I
bring one of the related points up here.

The background is that we are building our packages under Windows with
"Rcmd install --build" which will flag the zip options.  When the total
size of files in <pkg>\data are over a certain threshold of size (100k
IIRC) the will be zipped in a file named Rdata.zip to save space.  So far,
so good.

The problem arose in that at least one of the packages in the BioC suite
is directly acccessing files in the data directory and not going through
the data() command or related functions - and in this case the package
authors are doing it in .First.lib() which causes the package loading to
fail.

The issue that Duncan suggested I raise is whether or not it should be
considered accepted behaviour for a package author to be accessing files
in <pkg>\data (at this time I don't know the reasoning behind the specific
example here, I just know that that's what they've done) or if this should
be considered a Bad Thing.

Thanks
-Jeff

From pgilbert at bank-banque-canada.ca  Thu Oct 23 18:05:17 2003
From: pgilbert at bank-banque-canada.ca (Paul Gilbert)
Date: Thu Oct 23 18:00:07 2003
Subject: [Rd] Accessing data files w/ --use-zip-data
In-Reply-To: <Pine.SOL.4.20.0310231116360.13471-100000@santiam.dfci.harvard.edu>
References: <Pine.SOL.4.20.0310231116360.13471-100000@santiam.dfci.harvard.edu>
Message-ID: <3F97FC3D.8090305@bankofcanada.ca>

Jeff Gentry wrote:

>...
>The issue that Duncan suggested I raise is whether or not it should be
>considered accepted behaviour for a package author to be accessing files
>in <pkg>\data (at this time I don't know the reasoning behind the specific
>example here, I just know that that's what they've done) or if this should
>be considered a Bad Thing.
>
I do this in some instances where I have data in a format not supported 
by data(), for example,  database files that are used by package 
programs or tests (but I have always wondered if it is "the right" thing 
to do).  If it is considered a Bad Thing then there needs to be another 
location for files like this, perhaps inst/data or something like that.

Paul Gilbert

From ripley at stats.ox.ac.uk  Thu Oct 23 18:07:44 2003
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu Oct 23 18:06:46 2003
Subject: [Rd] Accessing data files w/ --use-zip-data
In-Reply-To: <3F97FC3D.8090305@bankofcanada.ca>
Message-ID: <Pine.LNX.4.44.0310231705280.1839-100000@gannet.stats>

On Thu, 23 Oct 2003, Paul Gilbert wrote:

> Jeff Gentry wrote:
> 
> >...
> >The issue that Duncan suggested I raise is whether or not it should be
> >considered accepted behaviour for a package author to be accessing files
> >in <pkg>\data (at this time I don't know the reasoning behind the specific
> >example here, I just know that that's what they've done) or if this should
> >be considered a Bad Thing.
> >
> I do this in some instances where I have data in a format not supported 
> by data(), for example,  database files that are used by package 
> programs or tests (but I have always wondered if it is "the right" thing 
> to do).  If it is considered a Bad Thing then there needs to be another 
> location for files like this, perhaps inst/data or something like that.


inst/data will get copied into data in the installed version.

We would prefer you used inst/mydata copied to mydata (for some value of
`mydata' != `data'), as package spatial does.  This allows the QC tools to
check out aspects of the installed data directory unhindered.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From l.bize at wanadoo.fr  Thu Oct 23 19:22:57 2003
From: l.bize at wanadoo.fr (l.bize@wanadoo.fr)
Date: Thu Oct 23 19:22:07 2003
Subject: [Rd] Ask for information about device architecture
Message-ID: <3F980E71.4020007@wanadoo.fr>

Hello.
I'm looking for documentation about the graphic device model in R.
I would understand it in the details, but it seems a bit complex :)
Thanks for any documents which will help me.

    Laurent

From zeileis at ci.tuwien.ac.at  Thu Oct 23 22:16:20 2003
From: zeileis at ci.tuwien.ac.at (Achim Zeileis)
Date: Thu Oct 23 22:15:17 2003
Subject: [Rd] texi2dvi and buildVignettes() on Windows
Message-ID: <200310232016.h9NKGKJk025931@thorin.ci.tuwien.ac.at>

I am currently writing a (private) package in which I produce pdf 
files from within R using LaTeX. To do so I mainly copied some lines 
from the buildVignettes() function in the tools package. This uses the 
texi2dvi which is included in R's bin directory:

  system(paste(file.path(R.home(), "bin", "texi2dvi"),
               "--quiet --pdf", bft))

This runs fine on Linux and I assumed that as it is included in 
buildVignettes() it should also work on Windows (which is important 
for me because I want to share the package with a couple of colleagues 
working on Windows). But apparently, texi2dvi is not provided in the 
Windows distribution of R.

I already asked Duncan privately about this who kindly tried to run 
buildVignettes() on the vignette in my lmtest package. He got the 
results:

<quote>
I get the following:

> buildVignettes('lmtest')
Warning message: 
F:\R\rw1080/bin/texi2dvi not found 

The help for buildVignettes says it's an internal command; perhaps the
thing that calls it has some workaround for Windows.  I only see it
being called from src/scripts/build.in, which runs under Windows, but
I can't see any attempt to work around this limitation, so maybe it's
just not working.  
</quote>

So maybe I am missing something here (which is rather likely as I'm 
not used to Windows at all...) but is it possible that 
buildVignettes() does not work on Windows? If it has some workaround I 
would be glad to learn how that works. Other suggestions on how to 
compile LaTeX from within R in some (more or less) cross-platform way 
are of course also very welcome.

thanks in advance,
Z

From p.murrell at auckland.ac.nz  Thu Oct 23 22:30:32 2003
From: p.murrell at auckland.ac.nz (Paul Murrell)
Date: Thu Oct 23 22:29:45 2003
Subject: [Rd] Ask for information about device architecture
References: <3F980E71.4020007@wanadoo.fr>
Message-ID: <3F983A68.6050706@stat.auckland.ac.nz>

Hi


l.bize@wanadoo.fr wrote:
> Hello.
> I'm looking for documentation about the graphic device model in R.
> I would understand it in the details, but it seems a bit complex :)
> Thanks for any documents which will help me.


I'm assuming you want to write a new device ...

Here are a couple of places to look:

The API for graphics devices (such as it is) is in
R/src/include/R_ext/graphicsDevice.h
There's a reasonable amount of documentation in the code; you should 
probably ingore the first set of "NOTES" and look at all of the comments 
in the NewDevDesc structure, plus the stuff at the end of the file.

The file
R/src/modules/X11/devX11.c
provides a "template" for how a device should be implemented.  It also 
has a reasonable amount of documentation in the code.
Most of the device functions should be fairly straightforward -- 
depending on what sort of device you want to implement, dev_MetricInfo 
can be challenging, but returning 0 for all values is a valid option at 
least initially.
Probably the trickiest part is writing the device initialisation and 
making sure that you allocate/deallocate structures in the correct 
places -- here the X11 template can be particularly useful.

There are a couple of examples of add-on devices for R, so the source 
code for these (particularly the stuff for initialising the device) 
might be useful;  see the gtkDevice package and the RSvgDevice package 
(both on CRAN).

There is a document describing a reorganisation of R's graphics code 
(started a couple of years ago, but still ongoing -- see below) at
http://www.stat.auckland.ac.nz/~paul/R/graphicsChanges.html
Some of this is relevant to graphics device structures and includes a 
section on what should happen when a device is started and when it is 
killed.

Note that my current plan is to make some changes to this stuff in the 
near future (e.g., the graphical primitive functions dev_line, etc will 
be getting a graphical-parameter-structure rather than individual 
graphical parameters col, lwd, ...), so if you go ahead with anything, 
please keep in touch so that I can let you know when these changes (are 
about to) happen.

Paul
-- 
Dr Paul Murrell
Department of Statistics
The University of Auckland
Private Bag 92019
Auckland
New Zealand
64 9 3737599 x85392
paul@stat.auckland.ac.nz
http://www.stat.auckland.ac.nz/~paul/

From l.bize at wanadoo.fr  Thu Oct 23 23:03:46 2003
From: l.bize at wanadoo.fr (l.bize@wanadoo.fr)
Date: Thu Oct 23 23:03:19 2003
Subject: [Rd] Ask for information about device architecture
In-Reply-To: <3F983A68.6050706@stat.auckland.ac.nz>
References: <3F980E71.4020007@wanadoo.fr>
	<3F983A68.6050706@stat.auckland.ac.nz>
Message-ID: <3F984232.8000309@wanadoo.fr>


> I'm assuming you want to write a new device ...
>
Yes. I plan to write a GLX device. The rgl package writed by Daniel Adler
is very interesting but don't correspond to what I want.
I want to write a full device, based on X11 at first, then add specific
features for 3D representation.

> Here are a couple of places to look:
> R/src/include/R_ext/graphicsDevice.h
> R/src/modules/X11/devX11.c
> There are a couple of examples of add-on devices for R, so the source 
> code for these (particularly the stuff for initialising the device) 
> might be useful;  see the gtkDevice package and the RSvgDevice package 
> (both on CRAN).

RSvgDevice sounds good :)
Thanks for locations and informations.

> There is a document describing a reorganisation of R's graphics code 
> (started a couple of years ago, but still ongoing -- see below) at
> http://www.stat.auckland.ac.nz/~paul/R/graphicsChanges.html

I've timeout problems to reach the site. ( Even electrons do strike in 
France ;) )

> Some of this is relevant to graphics device structures and includes a 
> section on what should happen when a device is started and when it is 
> killed.

Ok. This will be very usefull to begin the (hard) work.

> Note that my current plan is to make some changes to this stuff in the 
> near future (e.g., the graphical primitive functions dev_line, etc 
> will be getting a graphical-parameter-structure rather than individual 
> graphical parameters col, lwd, ...), so if you go ahead with anything, 
> please keep in touch so that I can let you know when these changes 
> (are about to) happen.

Ok. I'm going to dive in the R code. If the project is still standing 
after this, I keep you informed.
Thanks a lot,

    Laurent

From ripley at stats.ox.ac.uk  Thu Oct 23 23:51:58 2003
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu Oct 23 23:51:21 2003
Subject: [Rd] texi2dvi and buildVignettes() on Windows
In-Reply-To: <200310232016.h9NKGKJk025931@thorin.ci.tuwien.ac.at>
Message-ID: <Pine.LNX.4.44.0310232249330.3034-100000@gannet.stats>

Last time I tried texi2dvi did not work under the shell used under 
Windows.

On Thu, 23 Oct 2003, Achim Zeileis wrote:

> I am currently writing a (private) package in which I produce pdf 
> files from within R using LaTeX. To do so I mainly copied some lines 
> from the buildVignettes() function in the tools package. This uses the 
> texi2dvi which is included in R's bin directory:
> 
>   system(paste(file.path(R.home(), "bin", "texi2dvi"),
>                "--quiet --pdf", bft))
> 
> This runs fine on Linux and I assumed that as it is included in 
> buildVignettes() it should also work on Windows (which is important 
> for me because I want to share the package with a couple of colleagues 
> working on Windows). But apparently, texi2dvi is not provided in the 
> Windows distribution of R.
> 
> I already asked Duncan privately about this who kindly tried to run 
> buildVignettes() on the vignette in my lmtest package. He got the 
> results:
> 
> <quote>
> I get the following:
> 
> > buildVignettes('lmtest')
> Warning message: 
> F:\R\rw1080/bin/texi2dvi not found 
> 
> The help for buildVignettes says it's an internal command; perhaps the
> thing that calls it has some workaround for Windows.  I only see it
> being called from src/scripts/build.in, which runs under Windows, but
> I can't see any attempt to work around this limitation, so maybe it's
> just not working.  
> </quote>
> 
> So maybe I am missing something here (which is rather likely as I'm 
> not used to Windows at all...) but is it possible that 
> buildVignettes() does not work on Windows? If it has some workaround I 
> would be glad to learn how that works. Other suggestions on how to 
> compile LaTeX from within R in some (more or less) cross-platform way 
> are of course also very welcome.
> 
> thanks in advance,
> Z
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://www.stat.math.ethz.ch/mailman/listinfo/r-devel
> 
> 

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From wfg at hotpennies.net  Thu Oct 23 17:26:30 2003
From: wfg at hotpennies.net (Hot Pennies)
Date: Fri Oct 24 00:27:10 2003
Subject: [Rd] IPFS Watch This St ock Trade
Message-ID: <51d5c01c3997a$08619aa0$66212c45@c2>

Hot Pennies.net Special Situation Alert

Watch This Stock Trade!!!

STOCK DETAILS	  	 
Symbol: IPFS
Exchange: OTCBB
Shares Outstanding:  13,379,000
Current Price: $1.10	 
Industry: Wireless Manufacturing and Technology	 

  
 	 COMPANY DETAILS	 
Integrated Performance Systems Inc
17300 N. Dallas Parkway,  Ste. 2040 	
Dallas, Texas 75248 	 
Phone: 972/381-1212	 
	
Web: www.IntegratedPerformanceSystems.com
<http://www.IntegratedPerformanceSystems.com>  	

 BUSINESS SUMMARY

	                               Integrated Performance Systems,
Inc. ("IPFS") is a Dallas, Texas based holding company which serves the
wireless microwave and communication industry.  From its state of the
art manufacturing plant north of Dallas, IPFS manufactures high
performance digital and microwave products for the defense, avionics,
and telecommunications industries.  IPFS manufactures for industry
leaders like Lockheed Martin, Rockwell, Honeywell, Ball Aerospace, L-3,
Raytheon and Celestica, and has won customer awards for its high quality
manufacturing.  The company is engaged in a strategic plan to capitalize
on its industry leadership through internal growth and synergistic
acquisitions, with the goal of achieving dramatic growth while enhancing
profitability through elimination of redundant overhead. 

	
<http://www.hotpennies.net/images/IPFS/HPIM0606.JPG> Through it's Asian
subsidiary, Voium, the company has gained an entrance into the fast
growing Asian wireless market by providing wireless data streaming
technologies.  The company has just begun offering instant news and
financial messaging services to Singapore wireless customers in
affiliation with Standard and Poors and Sing Tel.  It is anticipated
that this service will be expanded to China and to other markets and
telecommunication carriers now that the revenue enhancement potential
for carriers has been proven.  In addition, Voium is pursuing
opportunities to develop wireless infrastructure using a patented
broadband technology in conjunction with Asian telecom companies.  These
technologies, beyond their significant profit potential, may also open
the door for IPFS to begin manufacturing operations in Asia as a part of
its worldwide expansion plan.

 

 

IPFS benefits from:

*	Blue chip client base
	 
*	Reputation from superior quality
	 
*	Niche markets with few qualified competitors
	 
*	High margins (70%) over material cost
	 
*	Strong partners in Asian Telecom market

Clients use IPFS because of:

*	Ability to deliver hard to build products
	 
*	Product design improvements
	 
*	Cost reductions for long running programs
	 
*	Superior data streaming technology enhances revenues for Asian
Telcos

Highlights of recent accomplishments:

*	IPFS achieves positive EBITDA in fourth quarter on increased
telecommunications business
	 
*	Wireless data streaming partnership with Standard & Poors and
Sing Tel proves concept for Chinese and other Asian telcos.
	 
*	IPFS receives record defense orders in month following start of
Iraq war
	 
*	IPFS acquires Voium, entering Asian wireless technology market

IPFS is poised for explosive growth through its acquisition program and
the anticipated growth in the defense and telecommunications industry
over the next few years.

 


PRODUCTS AND TECHNOLOGY OVERVIEW 


 


Manufacturing


IPFS is a contract manufacturer of microwave frequency components,
high-speed digital boards, antennas, and other wireless communications
components.  As these products become more complex, the need for IPFS'
experience in delivering high speed, performance driven components
continues to grow.  Products manufactured in the company's 45,000 square
foot plant in Frisco, Texas, include:

*	Metal Back Microwave Circuit Boards are used in military,
avionics, and telecommunications applications where high frequency and
high power generate large heat loads which must be dissipated.  IPFS has
sophisticated machine shop and lamination facilities which make it one
of the only U.S. producers of metal back boards. Examples of metal back
boards include cell tower power amplifiers and commercial aircraft
collision control devices.
	 
*	High Speed Digital Boards are produced with a licensed
technology using insulated wires to build high-speed boards.  IPFS is
one of the two licensees of this technology, known as "DWT", in the U.S.
Currently DWT boards are used in telecommunications switching.
	 
*	Antennas are a specialty of IPFS because of its unique
capability to produce large format antennas up to 80 inches long.  In
addition, IPFS' microwave expertise allows it to produce radar antennas.
Company products are used in cell towers, several U.S. missiles, and in
Navy Aegis warships.
	 
*	Value Added Components allow IPFS to deliver a more finished
product to the customer, saving manufacturing time and expenses.  These
products are assembled on to basic boards and antennas produced by the
Company. 

 

Data Streaming Technology 

Through its subsidiary, Voium, IPFS empowers content providers, content
aggregators, content service resellers, mobile operators, and
information portals with turnkey technology and business solutions to
exploit new market opportunities for mobile information services.
Products include:

*	Financial and news content services are provided by using
proprietary technology to extract data from a news source and send the
data to wireless customers of a telco.  This service allows the news
source to generate additional revenue from its data and permits the
telco to enhance revenues from its customer base.  The recently
announced partnership between Standard and Poors (News Source), Voium
and SingTel (Telco) is an example. 
	 
*	Commercial Data Streaming Services allow customers to use the
company's technology to move data through wireless channels.   Currently
developed products include an airport bird strike prevention system,
remote monitoring for petroleum products, and a wireless pest control
system. 
	 
*	Wireless Broadband Services are available using a wireless
broadcast technology owned by a joint venture partner and licensed for
use in Asia.  The technology allows wireless broadband service to be
delivered for a very low investment in infrastructure.  The company is
currently working on proposals involving broadband Internet access and
pay per view television.

 


Technology


The manufacturing processes used by IPFS, with the exception of the DWT
Technology, are not
<http://www.hotpennies.net/images/IPFS/HPIM0609.JPG>  patentable and are
commonly used throughout the industry.  The Company does possess trade
secrets which is has developed to enhance its manufacturing processes
and enables it to produce difficult to manufacture parts.  The DWT
technology is licensed to IPS and one other U.S. company.

The wireless data streaming technology is proprietary with patent
protection.  The technology consists of four software platforms known as
V-Control, V- Charon, Mercury, and V-Phobus.  These four platforms are
used alone or in combination to produce fourteen proprietary products
which are available to customers.  The Company also owns, through a
joint venture, the Asian rights to the patented Wireless Broadband
Technology which allows deployment of wireless broadband services with
very low infrastructure cost.

 

    IPFS Technology Delivers 

*	High quality, high performance microwave and high speed
components
	 
*	Ability to manufacture difficult to build products
	 
*	Communications technology which extracts selected data from a
database (such as Standard & Poors News) for wireless transmission to
Telco customers.
	 
*	The wireless broadband product can deliver high-speed data
transmission, including movies, over a wide area with total reliability.

IPFS Technology Benefits Include:

*	Manufacturing processes and technologies continually updated
through interaction with clients
	 
*	Ability to work with difficult materials such as Teflon
	 
*	Quick turn around time on new products
	 
*	Communications platforms recognized as best in Singapore by IBC
and Mobile Metrix
	 
*	Wireless Broadband Technology allows coverage of large areas at
a fraction of the cost of competing technologies

 


MARKET DESCRIPTION

Manufacturing


IPS targets customers using high frequency, high speed, high performance
components.  These customers, reached through a system of manufacturer's
representatives and in-house sales personnel, fall into three markets:

*	      Defense Market demand for microwave products continues to
expand as "Smart" wireless systems become a focus of U.S. defense
strategy.  Thus, makers of "Smart" bombs, GPS guided missiles, radar
tracking systems, and upgraded aircraft systems are customers of IPFS 
	 
*	      Avionics Market demand for products, such as the collision
avoidance device made by IPFS, has seen a decline after the September 11
airline-manufacturing slump.  This market continues to show weakness,
but signs of revival in the airline business may indicate that the worst
is past.
	 
*	     Telecommunication Market demand for microwave
infrastructure and switching products suffered an abrupt reversal as the
result of the tech meltdown of 2001 and September 11.  However, the need
for continued technical improvement and increased customer demand for
wireless communications is creating spending pressure as balance sheets
of telcos improve.  Growth in sales of power amplifiers are projected to
increase 25%, to over $300 million, by 2004 while antenna sales are
projected to grow at a rate of 30% per year from $100 million through
2005.  Overall, the wireless communications market is expected to grow
40% through 2005.  Thus, the Company expects significant growth in its
telecommunications business over the next few years.

 


Data Streaming Technology


 


Financial and News Content Services


The Company's Asian business focus is on demand for wireless
communication platforms by matching content providers looking for new
markets with telcos looking for new revenue sources for their existing
customer bases.  Thus, Standard and Poors News and Financial Information
is now available to four million Singaporeans through Sing Tel.  Beyond
Singapore, however, the Chinese market looms with hundreds of millions
of subscribers as potential users for the technology, as do markets in
Australia and Eastern Asia.  The Company anticipates breaking into these
markets through existing relationships in these countries.

            

*	Commercial Data Streaming Service

	The commercial data streaming market in Asia is growing as more
and more companies find it advantageous to enhance their productivity
through use of wiring technology.  For example, the company has
developed wireless technology in partnership with a leading pest control
company in Singapore which promises to revolutionize the worldwide pest
control supply industry.  The Company is seeking strategic partners in
other industries such as oil and gas, to exploit its technology in this
immense and growing market.

 

*	Wireless Broadband Service

	While the cities of Asia are often well served by broadband
infrastructures, there are large areas where services are not available
because of infrastructure cost.  The Company's wireless broadband
technology can provide the interconnection solution, and the Company is
actively pursuing negotiations with strategic partners in Singapore,
China, Australia, Thailand, and other Asian countries.  In addition,
some Asian telcos have expressed an interest in using the technology to
broadcast pay per view television.  Thus, the company can leverage into
the multi-billion build out of Asian wiring infrastructure through its
existing relationships.

 


Management
 

D. Ronald Allen   	53	 President & CEO	 
William C. Robinette	 60	 Technology Manager	 
Ben Ng	 40	 President of Voium	 
Danny Kolb	 47	 Plant Manager	 
Steve Hallmark	 50	 Sales Manager	 
Brooks Harman, Jr. 	56	 Director	 

                    
                                                  

 


MILESTONES ACHIEVED


 

*	More than 20 years as a manufacturer of high performance
components used in defense avionics and telecommunications industries.
*	Blue chip clients in U.S. and Asia.
*	Earned quality manufacturing recognition from Lockheed Martin
and Rockwell.
*	Became a fully reporting public company, trading on the OTC BB
under the symbol "IPFS"
*	Survived industry shakeout through triple dip recessions caused
by the tech meltdown, September 11, and the pre-Iraq war slowdown.
*	Acquired Voium, Singapore based company recognized as a wireless
industry leader by IDC and Mobil Metrix
*	Received record defense orders after Iraq war began with
deliveries boosting 3rd quarter sales over 2nd quarter sales.
*	Rolled out wireless data streaming joint venture with Standard
and Poors and SingTel in Singapore, proving concept for China and other
markets
*	Achieves positive EBITDA in fourth quarter on strength of
increased telecommunications orders.

 


[Chart] <http://finance.yahoo.com/q/bc?s=IPFS.OB&t=1d> 
 	 
DETAILS	  	 
Index Membership:	 OTCBB	 
Sector:	 Technology <http://biz.yahoo.com/p/_techno.html> 	 
Industry:	 Computer Services
<http://biz.yahoo.com/p/_techno-cmpsrv.html> 	 
Market Cap:	 15.5 Million	 

  HEADLINES	  	 
	 Webcast Alert: Integrated Performance Systems' Chairman
Interview to be Webcast on Vcall.com
<http://biz.yahoo.com/prnews/030923/dctu026_1.html> 	 
Tue, Sep 23 - PR Newswire	 
	 Integrated Performance Systems Retains Mergers and Acquisitions
Consulting Firm and Investment Banker
<http://biz.yahoo.com/bw/030919/195380_1.html> 	 
Fri, Sep 19 - Business Wire	 
	 Integrated Performance Systems Asian Subsidiary Launches S&P
Wireless Financial Services Through Singapore Telecommunications
<http://biz.yahoo.com/bw/030821/215286_1.html> 	 
Thu, Aug 21 - Business Wire	 

  
 chart	 	  chart	
  _____  


 

Disclaimer:

HotPennies.net is not a Re gistered Invest ment Ad visor or a Brok er /
Deal er. Readers are advised that this newsletter (website) is issued
solely for information purposes and is not to be construed as an offer
to sell or the solicitation of an offer to buy. HotPennies.net does not
guarantee the accuracy of the information provided. Investors should
verify all information independently or by their investment advisor.
This newsletter may contain forward-looking information within the
meaning of section 27A of the Securities Act of 1933 and section 21E of
the Securities Exchange Act of 1934 and is subject to the Safe Harbor
created by those sections. This material may contain statements about
expected future events and/or financial results that are forward-looking
in nature and subject to risks and uncertainties. For those statements,
the Company claims the protection of the safe harbor for forward-looking
statements provisions contained in the Private Securities Litigation
Reform Act of 1995 and any amendments thereto. Such forward-looking
statements by definition involve risks, uncertainties and other factors
which may cause the actual results, performance or achievements of the
Company to be materially different from the future results, performance
or achievements expressed or implied by such forward-looking statements.
Discussions of factors, which may affect future results, are contained
in the Company's most recent filings. Readers can review all public
filings by companies at the SEC's EDGAR page. HotPennies.net may receive
compensation. Editors of HotPennies.net may invest or trade in
securities featured in our newsletter or website. Unauthorized use,
dissemination in whole or in part, disclosure, distribution or copying
of this private e-mail is prohibited without written consent.
HotPennies.net encourages readers to review the investing information
available from the Securities and Exchange Commission ("SEC") at
www.sec.gov/ and/or the National Association of Securities Dealers
("NASD") at www.nasdr.com/ The NASD has published information on how to
invest carefully at its web site. In order to be in full compliance with
the Securities Act of 1933, Section 17(b), HotPennies.net discloses
compensation in our disclaimer for our efforts in presenting and
disseminating information contained herein. Information within this
email contains forward looking statements within the meaning of Section
27A of the Securities Act of 1933 and Section 21B of the Securities
Exchange Act of 1934. Any statements that express or involve discussions
with respect to predictions, expectations, beliefs, plans, projections,
objectives, goals, assumptions or future events or performance are not
statements of historical fact and may be forward looking statements.
Forward looking statements are based on expectations, estimates and
projections at the time the statements are made that involve a number of
risks and uncertainties which could cause actual results or events to
differ materially from those presently anticipated. Forward looking
statements in this action may be identified through the use of words
such as projects, foresee, expects, will, anticipates, estimates,
believes, understands or that by statements indicating certain actions
may, could, or might occur. As with many microcaps, today's featured
company has additional risk factors. The company has a going concern
opinion from its auditors. Furthermore, the company has a large
accumulated deficit since its inception and a substantial negative net
worth. The company has relied on loans from its officers and all the
assets of the company are pledged as collateral for the loans. The
company is in a very competitive industry. Some competitors are better
financed. The company needs to obtain financing. An investment in
today's featured company is considered to be highly speculative and
should not be considered unless a person can afford a complete loss of
investment. All information provided within this email pertaining to
investing, stocks, securities must be understood as information provided
and not investment advice. HotPennies.net does not endorse any company
listed herein and the HotPennies.net does not represent that the
information contained in this message states all material facts or does
not omit a material fact necessary to make the statements therein not
misleading. HotPennies.net Alert advises all readers to seek advice from
a registered professional securities representative before deciding to
trade in stocks featured within this email. None of the material within
this report shall be construed as any kind of investment advice or
solicitation. The publisher of HotPennies.net Alert is not a re gistered
invest ment ad visor. Subscribers should not view information herein as
legal, tax, accounting or investment advice. All information within this
email is qualified in its entirety by the detailed information and
financial statements of the featured company contained in its regulatory
filings with the SEC. End-Users are responsible for verifying all claims
and conducting their own due diligence. Any reference to past
performance(s) of companies are specially selected to be referenced
based on the favorable performance of these companies. You would need
perfect timing to achieve the results in the examples given. There can
be no assurance of that happening. Remember, as always, past performance
is never indicative of future results and a thorough due diligence
effort, including a review of a company's filings, should be completed
prior to investing. In compliance with the Securities Act of 1933,
Section17(b), HotPennies.net discloses the receipt of  Thirteen Thousand
three hundred and thirty three free trading shares of IPFS from SMI
Chips, Inc.. Be aware of an inherent conflict of interest resulting from
such compensation due to our intent to profit from the liquidation of
these shares. Part or all of this position may be sold at any time, even
after positive statements have been made regarding the above company.
All factual information in this report was gathered from public sources,
including but not limited to SEC Filings and Company Press Releases.
HotPennies.net believes this information to be reliable but can make no
guarantee as to its accuracy or completeness. Use of the material within
this email constitutes your acceptance of these terms. 
 

  



This Message Is Being Sent To r-devel@r-project.org. To Be Immediately
Removed <http://www.hotpennies.net/wfg/?Email=r-devel@r-project.org> 

	[[alternative HTML version deleted]]

From dmurdoch at pair.com  Fri Oct 24 01:02:03 2003
From: dmurdoch at pair.com (Duncan Murdoch)
Date: Fri Oct 24 01:01:00 2003
Subject: [Rd] linking to R.dll on Win32 - issues with recent MinGW?
In-Reply-To: <61B2C492-0553-11D8-BE10-000A957CEFBA@math.uni-augsburg.de>
References: <61B2C492-0553-11D8-BE10-000A957CEFBA@math.uni-augsburg.de>
Message-ID: <u0ngpvg8i24ga3ffde1cqhe1f1ml5o2op0@4ax.com>

On Thu, 23 Oct 2003 14:21:08 +0200, you wrote:

>I encountered several strange issues when linking to R.dll on Windows 
>and I wonder if anyone of the Windows savvy-folks here had seen some of 
>the issues before and have some explanation.

I can help with one of them, but not the main one.


>Now, I thought I'll use libR.a from the R sources instead of using the 
>final R.dll, because that's what libR.a is for, right? The first 
>obstacle was that libR.a doesn't export R_Home which I need to set in 
>my init routine, but fortunately there is "exported-vars" for that 
>case. But after finally compiling everything, Rserve crashes. It 
>doesn't even get as far as main. What I get is this:
>Warning: Invalid Address specified to RtlSizeHeap( 003F0000, 0146008 )
>and later a crash somewhere deep in libwsock32 (the trace is rather 
>weird) ... I guess the problem is the heap, not wsock itself. Any idea 
>what that could be?

This looks like what I see every time I run R under gdb.  The problem
is a bug/incompatibility in the MinGW run-time library.  R has its own
malloc, and some functions in the startup code expect the standard
MSVCRT malloc to be called, and it's not.  Within the debugger the
error is harmless, except for wasting some time.  I don't see the
later crash at a different location, but it sounds like a similar
symptom.

The workaround the MinGW folks told me was to rename the R malloc to
something else (e.g. by a define in Defn.h).  However, I got this
advice too close to the 1.8.0 release date to want to risk it.  I'll
try it for 1.9, not 1.8.1.

Duncan Murdoch


>
>All the above was tested with MinGW-3.1.
>Any ideas? Is that a MinGW bug or something I did? ;)
>
>Thanks.
>Simon
>
>---
>Simon Urbanek
>Department of computer oriented statistics and data analysis
>University of Augsburg
>Universit?tsstr. 14
>86135 Augsburg
>Germany
>
>Tel: +49-821-598-2236
>Fax: +49-821-598-2200
>
>Simon.Urbanek@Math.Uni-Augsburg.de
>http://simon.urbanek.info
>
>______________________________________________
>R-devel@stat.math.ethz.ch mailing list
>https://www.stat.math.ethz.ch/mailman/listinfo/r-devel

From w.huber at dkfz-heidelberg.de  Fri Oct 24 08:26:38 2003
From: w.huber at dkfz-heidelberg.de (w.huber@dkfz-heidelberg.de)
Date: Fri Oct 24 08:26:09 2003
Subject: [Rd] Accessing data files w/ --use-zip-data
In-Reply-To: <Pine.SOL.4.20.0310231116360.13471-100000@santiam.dfci.harvard.edu>
References: <Pine.SOL.4.20.0310231116360.13471-100000@santiam.dfci.harvard.edu>
Message-ID: <Pine.GSO.4.53.0310240820240.3958@herkules>


Hi all,

> The issue that Duncan suggested I raise is whether or not it should be
> considered accepted behaviour for a package author to be accessing files
> in <pkg>\data (at this time I don't know the reasoning behind the specific
> example here, I just know that that's what they've done) or if this should
> be considered a Bad Thing.

Examples are the makecdfenv und matchprobes packages, part of which I
wrote. They deal with data formats that are external to R, namely vendor
(Affymetrix) specific file formats, and provide tools for importing these
data into R. For the examples / vignettes, I need to provide example data
files. Up to now I am putting them into the data directory, and access
them with

specializedImportFunction(file.path(.path.package("matchprobes"),
                          "data", "HG-U95Av2_probe_tab.gz"), ...)

Is this considered offensive to the R package structure? Whereelse to put
data that comes in specialized (not .rda, .txt, .csv) formats?

Thanks
  Wolfgang

From ripley at stats.ox.ac.uk  Fri Oct 24 08:36:51 2003
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri Oct 24 08:35:49 2003
Subject: [Rd] Accessing data files w/ --use-zip-data
In-Reply-To: <Pine.GSO.4.53.0310240820240.3958@herkules>
Message-ID: <Pine.LNX.4.44.0310240730280.3699-100000@gannet.stats>

On Fri, 24 Oct 2003 w.huber@dkfz-heidelberg.de wrote:

> > The issue that Duncan suggested I raise is whether or not it should be
> > considered accepted behaviour for a package author to be accessing files
> > in <pkg>\data (at this time I don't know the reasoning behind the specific
> > example here, I just know that that's what they've done) or if this should
> > be considered a Bad Thing.
> 
> Examples are the makecdfenv und matchprobes packages, part of which I
> wrote. They deal with data formats that are external to R, namely vendor
> (Affymetrix) specific file formats, and provide tools for importing these
> data into R. For the examples / vignettes, I need to provide example data
> files. Up to now I am putting them into the data directory, and access
> them with
> 
> specializedImportFunction(file.path(.path.package("matchprobes"),
>                           "data", "HG-U95Av2_probe_tab.gz"), ...)
> 
> Is this considered offensive to the R package structure? Whereelse to put
> data that comes in specialized (not .rda, .txt, .csv) formats?

It is broken, as Windows users have found.  Please use a different
installation directory, as in my earlier reply, or make
specializedImportFunction() handle zipped data directories.

I have been proposing, and may implement as soon as 1.9.0, to process all 
the data directory at install time to .rda files in a database (details 
depend on Luke's final choice of implementation)  which is load-on-demand 
and perhaps unload if not currently used.  So it not a good idea to use 
the data directory for files other than those to be accessed by data().

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From ripley at stats.ox.ac.uk  Fri Oct 24 08:46:41 2003
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri Oct 24 08:45:50 2003
Subject: [Rd] Versions of PCRE, documenting what grep etc do.
Message-ID: <Pine.LNX.4.44.0310240711370.3699-100000@gannet.stats>

A couple of weeks back there was some discussion about documenting the 
regular expressions as used in R.   Several years ago the problem was that 
this was OS-dependent, and to plug that problem we incorporated regexp 
code from a version of GNU grep, later updated to grep-2.4.2 in R 1.2.0.

I have been looking at documenting what grep(perl=TRUE) does, and we
have a similar problem in that the current PCRE, 4.4, implements rather 
more of Perl's regexps than 3.9 (which is in 1.8.0 if the OS does not 
supply it, and RH8.0 has PCRE 3.9. Whichever version of Debian is on franz 
has PCRE 3.4).

I could add a configure check for PCRE >= 4.0, and I think probably should 
do that.  However, my inclination is to always use the version of PCRE in 
the R sources  and thereby ensure that all builds of R have the same 
version, the one I will document.  Comments, please.

For PCRE 4.4 there is a long man page that I will use as a basis for the 
documentation.  I am inclined just to include either a text or PDF version 
of the man page -- any preferences for which form?


For the non-Perl regexps it is harder, as I am unsure exactly what
patterns the GNU regex we have accepts.  (From a problem which occurred
with some Sweave regexps, I think it accepts more than it is intended
to.)  One fairly good docu source is the GNU grep man page: does anyone
know a better one?   I had thought of writing a regexp.Rd help page to 
which grep.Rd could refer.

None of this is imminent (I am too busy) but is intended for the next 
minor release (which may be called 1.9.0 or 2.0.0, I gather).

Brian

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From w.huber at dkfz-heidelberg.de  Fri Oct 24 09:02:43 2003
From: w.huber at dkfz-heidelberg.de (w.huber@dkfz-heidelberg.de)
Date: Fri Oct 24 09:01:39 2003
Subject: [Rd] Accessing data files w/ --use-zip-data
In-Reply-To: <Pine.LNX.4.44.0310231705280.1839-100000@gannet.stats>
References: <Pine.LNX.4.44.0310231705280.1839-100000@gannet.stats>
Message-ID: <Pine.GSO.4.53.0310240833160.3958@herkules>


> We would prefer you used inst/mydata copied to mydata (for some value of
> `mydata' != `data'), as package spatial does.  This allows the QC tools to
> check out aspects of the installed data directory unhindered.

Dear Prof. Ripley,

OK! - I'll do that. As this will probably come up again, would it be
worthwhile to define the recommended way and put something into the
"writing R extensions" manual?

PS I realized that system.file("mydata","myfile.xyz",package="matchprobes")
is a little more elegant than the construction cited in my previous mail.

Best regards
  Wolfgang

From wolfram at fischer-zim.ch  Fri Oct 24 09:15:33 2003
From: wolfram at fischer-zim.ch (wolfram@fischer-zim.ch)
Date: Fri Oct 24 09:14:34 2003
Subject: [Rd] [R] ave and factors with unused levels (PR#4753)
Message-ID: <200310240715.h9O7FX0P005792@pubhealth.ku.dk>

[R 1.7.1 on linux]

There seems to be a problem when using ave() with a grouping factor
having a first level value which is not used in the data vector.

---- CODE ----------------
x <- data.frame( grp = factor( c(10,20,10,10), levels=c(99,10,20) ) )
x$val <- 10^( (nrow(x)-1) : 0 )
x$ave.factor <- ave( x$val, x$grp, FUN=sum )
x$ave.numeric <- ave( x$val, as.numeric( x$grp ), FUN=sum )
x

---- RESULT --------------
  grp  val ave.factor ave.numeric
1  10 1000        100        1011
2  20  100         NA         100
3  10   10        100        1011
4  10    1        100        1011


---- PROBLEM -------------
x$ave.numeric is correct, but x$ave.factor shows abitrary values.

---- OBSERVATIONS --------
If 99 is eliminated as level of x$grp, x$ave.factor is ok:
	x <- data.frame( grp = factor( c(10,20,10,10), levels=c(10,20) ) )

If 99 is the last level of x$grp, x$ave.factor is ok:
	x <- data.frame( grp = factor( c(10,20,10,10), levels=c(10,20,99) ) )

---- ---------------------

Wolfram Fischer

From edd at debian.org  Fri Oct 24 14:27:12 2003
From: edd at debian.org (Dirk Eddelbuettel)
Date: Fri Oct 24 14:26:07 2003
Subject: [Rd] Versions of PCRE, documenting what grep etc do.
In-Reply-To: <Pine.LNX.4.44.0310240711370.3699-100000@gannet.stats>
References: <Pine.LNX.4.44.0310240711370.3699-100000@gannet.stats>
Message-ID: <20031024122712.GA30171@sonny.eddelbuettel.com>

On Fri, Oct 24, 2003 at 07:46:41AM +0100, Prof Brian Ripley wrote:
> I have been looking at documenting what grep(perl=TRUE) does, and we
> have a similar problem in that the current PCRE, 4.4, implements rather 
> more of Perl's regexps than 3.9 (which is in 1.8.0 if the OS does not 
> supply it, and RH8.0 has PCRE 3.9. Whichever version of Debian is on franz 
> has PCRE 3.4).

FWIW the current line of R (>= 1.8.0) in Debian unstable has 

    Depends: [....] libpcre3 (>= 4.0) [...]
    
by virtue of the fact that the pcre libraries in Debian unstable are
currently at version 4.3. 

Dirk

-- 
Those are my principles, and if you don't like them... well, I have others.
                                                -- Groucho Marx

From wb at arb-phys.uni-dortmund.de  Fri Oct 24 14:52:28 2003
From: wb at arb-phys.uni-dortmund.de (wb@arb-phys.uni-dortmund.de)
Date: Fri Oct 24 14:51:22 2003
Subject: [Rd] NLME: gls parameter evaluation inconsistency (PR#4757)
Message-ID: <200310241252.h9OCqS0P011909@pubhealth.ku.dk>

Full_Name: W.B.Kloke
Version: 1.8.0
OS: FreeBSD-4.7
Submission from: (NULL) (195.253.22.63)


I found a parameter evaluation inconsistency in NLME package. I tried to use
gls() inside a function, and I wanted use gls() for different subsets of a data
frame:

prgls <- function(name){ gls( log10(Y)~(cond-1)+(cond-1):t
,pr,subset=subject==name)}

Applying this function with a string as parameter like prgls("VM") yields an
error
Error in eval(expr, envir, enclos) : Object "name" not found

The same definition with lm() instead of gls() works fine. Of course I want to
use the correlation features of gls(). It looks like a wrong environment at the
place of subset evaluation (the local variables and function paramaters are not
available). Probably lme(), ngls() and nlme() have the same inconsistency.

From pgilbert at bank-banque-canada.ca  Fri Oct 24 15:52:45 2003
From: pgilbert at bank-banque-canada.ca (Paul Gilbert)
Date: Fri Oct 24 15:50:15 2003
Subject: [Rd] data/ and data()
In-Reply-To: <Pine.LNX.4.44.0310240730280.3699-100000@gannet.stats>
References: <Pine.LNX.4.44.0310240730280.3699-100000@gannet.stats>
Message-ID: <3F992EAD.3000906@bankofcanada.ca>

(Changed thread from  [Rd] Accessing data files w/ --use-zip-data.)

Prof Brian Ripley wrote:

> I have been proposing, and may implement as soon as 1.9.0, to process all
>
>the data directory at install time to .rda files in a database (details 
>depend on Luke's final choice of implementation)  which is load-on-demand 
>and perhaps unload if not currently used.  So it not a good idea to use 
>the data directory for files other than those to be accessed by data().
>
An issue related to data files that needs to be reconsidered (IMO) is 
the fact that data files cannot use functionality defined in the 
package, according to Writing R Extensions.

This is not too serious a problem with S3 classes, but to the limited 
extent that I understand S4 classes, I think this means that a package 
cannot have example data in a class stucture that is defined in the 
package. This will certainly hinder my ability to switch to S4 classes 
(assuming that I ever get the time to try it).

Paul Gilbert

From ripley at stats.ox.ac.uk  Fri Oct 24 16:08:26 2003
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri Oct 24 16:07:24 2003
Subject: [Rd] data/ and data()
In-Reply-To: <3F992EAD.3000906@bankofcanada.ca>
Message-ID: <Pine.LNX.4.44.0310241506320.1466-100000@gannet.stats>

I hope if we change the data() mechanism this can be solved.  The problem 
is that you can do

data(foo, package="bar")

but if we do things at install time we can arrange for bar to be loaded
(or at least the namespace of bar to be loaded).

On Fri, 24 Oct 2003, Paul Gilbert wrote:

> (Changed thread from  [Rd] Accessing data files w/ --use-zip-data.)
> 
> Prof Brian Ripley wrote:
> 
> > I have been proposing, and may implement as soon as 1.9.0, to process all
> >
> >the data directory at install time to .rda files in a database (details 
> >depend on Luke's final choice of implementation)  which is load-on-demand 
> >and perhaps unload if not currently used.  So it not a good idea to use 
> >the data directory for files other than those to be accessed by data().
> >
> An issue related to data files that needs to be reconsidered (IMO) is 
> the fact that data files cannot use functionality defined in the 
> package, according to Writing R Extensions.
> 
> This is not too serious a problem with S3 classes, but to the limited 
> extent that I understand S4 classes, I think this means that a package 
> cannot have example data in a class stucture that is defined in the 
> package. This will certainly hinder my ability to switch to S4 classes 
> (assuming that I ever get the time to try it).
> 
> Paul Gilbert

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From wolfram at fischer-zim.ch  Fri Oct 24 16:43:44 2003
From: wolfram at fischer-zim.ch (wolfram@fischer-zim.ch)
Date: Fri Oct 24 16:43:56 2003
Subject: [Rd] Re: [R] ave and factors with unused levels (PR#4759)
Message-ID: <200310241443.h9OEhi0P013493@pubhealth.ku.dk>

The problem is solved in R 1.8.0.
[Excuse me for the previous message...]

Wolfram

--- In reply to: ---
>Date:    24.10.03 09:16 (+0200)
>From:    Wolfram Fischer - Z/I/M <wolfram@fischer-zim.ch>
>To:      wolfram@fischer-zim.ch
>Subject: [R] ave and factors with unused levels
>
> [R 1.7.1 on linux]
> 
> There seems to be a problem when using ave() with a grouping factor
> having a first level value which is not used in the data vector.
> 
> ---- CODE ----------------
> x <- data.frame( grp = factor( c(10,20,10,10), levels=c(99,10,20) ) )
> x$val <- 10^( (nrow(x)-1) : 0 )
> x$ave.factor <- ave( x$val, x$grp, FUN=sum )
> x$ave.numeric <- ave( x$val, as.numeric( x$grp ), FUN=sum )
> x
> 
> ---- RESULT --------------
>   grp  val ave.factor ave.numeric
> 1  10 1000        100        1011
> 2  20  100         NA         100
> 3  10   10        100        1011
> 4  10    1        100        1011
> 
> 
> ---- PROBLEM -------------
> x$ave.numeric is correct, but x$ave.factor shows abitrary values.
> 
> ---- OBSERVATIONS --------
> If 99 is eliminated as level of x$grp, x$ave.factor is ok:
> 	x <- data.frame( grp = factor( c(10,20,10,10), levels=c(10,20) ) )
> 
> If 99 is the last level of x$grp, x$ave.factor is ok:
> 	x <- data.frame( grp = factor( c(10,20,10,10), levels=c(10,20,99) ) )
> 
> ---- ---------------------
> 
> Wolfram Fischer

From Kurt.Hornik at wu-wien.ac.at  Fri Oct 24 17:15:17 2003
From: Kurt.Hornik at wu-wien.ac.at (Kurt Hornik)
Date: Fri Oct 24 17:16:24 2003
Subject: [Rd] Versions of PCRE, documenting what grep etc do.
In-Reply-To: <Pine.LNX.4.44.0310240711370.3699-100000@gannet.stats>
References: <Pine.LNX.4.44.0310240711370.3699-100000@gannet.stats>
Message-ID: <16281.16901.529445.577664@mithrandir.hornik.net>

>>>>> Prof Brian Ripley writes:

> A couple of weeks back there was some discussion about documenting the
> regular expressions as used in R.  Several years ago the problem was
> that this was OS-dependent, and to plug that problem we incorporated
> regexp code from a version of GNU grep, later updated to grep-2.4.2 in
> R 1.2.0.

> I have been looking at documenting what grep(perl=TRUE) does, and we
> have a similar problem in that the current PCRE, 4.4, implements
> rather more of Perl's regexps than 3.9 (which is in 1.8.0 if the OS
> does not supply it, and RH8.0 has PCRE 3.9. Whichever version of
> Debian is on franz has PCRE 3.4).

> I could add a configure check for PCRE >= 4.0, and I think probably
> should do that.  However, my inclination is to always use the version
> of PCRE in the R sources and thereby ensure that all builds of R have
> the same version, the one I will document.  Comments, please.

I think we should in any case allow maintainers of binary packages on
platforms with advanced package management systems to force the use of
shared libraries the system can provide.  (So the binary maintainers
would need to verify that the system package provides the right libs and
headers.)

Not sure about the default: we typically try to use available system
resources, unless this is bound to cause problems, and regex was of the
latter type, afaicr.  

> For PCRE 4.4 there is a long man page that I will use as a basis for
> the documentation.  I am inclined just to include either a text or PDF
> version of the man page -- any preferences for which form?

Depends on where you would put the docs, I think.  Btw, where can 4.4 be
found?

> For the non-Perl regexps it is harder, as I am unsure exactly what
> patterns the GNU regex we have accepts.  (From a problem which
> occurred with some Sweave regexps, I think it accepts more than it is
> intended to.)  One fairly good docu source is the GNU grep man page:
> does anyone know a better one?  I had thought of writing a regexp.Rd
> help page to which grep.Rd could refer.

That would be great.  Linux has a regex(7) purported to be "taken from
Henry Spencer's regex package", which might be used as a start.  The old
GNU regex .tar.gz has a texinfo file, but does not help for what we
need, I think.

[I recently looked for available regexp docs, but was not too
successful.]

> None of this is imminent (I am too busy) but is intended for the next 
> minor release (which may be called 1.9.0 or 2.0.0, I gather).

Too bad :-(

Best
-k

From bates at stat.wisc.edu  Fri Oct 24 18:16:25 2003
From: bates at stat.wisc.edu (Douglas Bates)
Date: Fri Oct 24 18:15:24 2003
Subject: [Rd] NLME: gls parameter evaluation inconsistency (PR#4757)
In-Reply-To: <200310241252.h9OCqS0P011909@pubhealth.ku.dk>
References: <200310241252.h9OCqS0P011909@pubhealth.ku.dk>
Message-ID: <6rwuau4nmu.fsf@bates4.stat.wisc.edu>

wb@arb-phys.uni-dortmund.de writes:

> Full_Name: W.B.Kloke
> Version: 1.8.0
> OS: FreeBSD-4.7
> Submission from: (NULL) (195.253.22.63)
> 
> 
> I found a parameter evaluation inconsistency in NLME package. I tried to use
> gls() inside a function, and I wanted use gls() for different subsets of a data
> frame:
> 
> prgls <- function(name){ gls( log10(Y)~(cond-1)+(cond-1):t
> ,pr,subset=subject==name)}
> 
> Applying this function with a string as parameter like prgls("VM")
> yields an error Error in eval(expr, envir, enclos) : Object "name"
> not found
> 
> The same definition with lm() instead of gls() works fine. Of course
> I want to use the correlation features of gls(). It looks like a
> wrong environment at the place of subset evaluation (the local
> variables and function paramaters are not available). Probably
> lme(), ngls() and nlme() have the same inconsistency.

Yes.  It's the old "standard non-standard evaluation" problem.  The
model.frame function is (and has to be) very peculiar in the way
that it determines the value of variable names without local
bindings.  That's the non-standard evaluation part.  Because it is
difficult to get this right, it helps if it only needs to be done in
one place so we have what Thomas Lumley described as a "standard
non-standard evaluation" function in the current model.frame function.

However, model.frame expects to have only one argument called
"formula" (the first argument) containing a formula that will need to
be evaluated in the frame.  The model fitting functions in the nlme
package can have formulas in multiple arguments.  Arranging for the
proper call to model.frame to be evaluated is not easy.

A workaround is to use subset on the data frame passed as an argument

prgls <- function(name){ gls( log10(Y)~(cond-1)+(cond-1):t
 ,subset(pr,subject==name))}



-- 
Douglas Bates                            bates@stat.wisc.edu
Statistics Department                    608/262-2598
University of Wisconsin - Madison        http://www.stat.wisc.edu/~bates/

From ripley at stats.ox.ac.uk  Fri Oct 24 18:33:18 2003
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri Oct 24 18:33:32 2003
Subject: [Rd] Versions of PCRE, documenting what grep etc do.
In-Reply-To: <16281.16901.529445.577664@mithrandir.hornik.net>
Message-ID: <Pine.LNX.4.44.0310241727130.1676-100000@gannet.stats>

On Fri, 24 Oct 2003, Kurt Hornik wrote:

> >>>>> Prof Brian Ripley writes:
> 
> > A couple of weeks back there was some discussion about documenting the
> > regular expressions as used in R.  Several years ago the problem was
> > that this was OS-dependent, and to plug that problem we incorporated
> > regexp code from a version of GNU grep, later updated to grep-2.4.2 in
> > R 1.2.0.
> 
> > I have been looking at documenting what grep(perl=TRUE) does, and we
> > have a similar problem in that the current PCRE, 4.4, implements
> > rather more of Perl's regexps than 3.9 (which is in 1.8.0 if the OS
> > does not supply it, and RH8.0 has PCRE 3.9. Whichever version of
> > Debian is on franz has PCRE 3.4).
> 
> > I could add a configure check for PCRE >= 4.0, and I think probably
> > should do that.  However, my inclination is to always use the version
> > of PCRE in the R sources and thereby ensure that all builds of R have
> > the same version, the one I will document.  Comments, please.
> 
> I think we should in any case allow maintainers of binary packages on
> platforms with advanced package management systems to force the use of
> shared libraries the system can provide.  (So the binary maintainers
> would need to verify that the system package provides the right libs and
> headers.)
> 
> Not sure about the default: we typically try to use available system
> resources, unless this is bound to cause problems, and regex was of the
> latter type, afaicr.  

With a configure check for >= 4.0 I am reasonably happy to have 
--without-pcre as the default and allow --with-pcre at people's peril.

> > For PCRE 4.4 there is a long man page that I will use as a basis for
> > the documentation.  I am inclined just to include either a text or PDF
> > version of the man page -- any preferences for which form?
> 
> Depends on where you would put the docs, I think.  Btw, where can 4.4 be
> found?

At the ftp site mentioned on ?grep, at least earlier this week.

> > For the non-Perl regexps it is harder, as I am unsure exactly what
> > patterns the GNU regex we have accepts.  (From a problem which
> > occurred with some Sweave regexps, I think it accepts more than it is
> > intended to.)  One fairly good docu source is the GNU grep man page:
> > does anyone know a better one?  I had thought of writing a regexp.Rd
> > help page to which grep.Rd could refer.
> 
> That would be great.  Linux has a regex(7) purported to be "taken from
> Henry Spencer's regex package", which might be used as a start.  The old
> GNU regex .tar.gz has a texinfo file, but does not help for what we
> need, I think.

The GNU grep 2.4.2 man page and texinfo file give me enough, except I 
don't understand them well enough.  (What is said about extended vs basic 
expressions is unclear at best).

The Solaris 8 man pages are better and they do document POSIX regexps,
so I will use some of their ideas.

> [I recently looked for available regexp docs, but was not too
> successful.]
> 
> > None of this is imminent (I am too busy) but is intended for the next 
> > minor release (which may be called 1.9.0 or 2.0.0, I gather).
> 
> Too bad :-(

I might try to put regexp.Rd (I have a start) in 1.8.1 then.  Bu thte PCRE 
stuff will need to wait for R-devel's release.

Brian

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From jerome at hivnet.ubc.ca  Fri Oct 24 23:30:28 2003
From: jerome at hivnet.ubc.ca (jerome@hivnet.ubc.ca)
Date: Fri Oct 24 23:29:30 2003
Subject: [Rd] Segmentation fault in .Call() (PR#4761)
Message-ID: <200310242130.h9OLUS0P016175@pubhealth.ku.dk>

Full_Name: Jerome Asselin
Version: 1.8.0
OS: RedHat Linux 7.2
Submission from: (NULL) (142.103.177.13)



I would not expect a segmentation fault; perhaps an error message.

> .Call("log")
Segmentation fault

This is always reproducable for me.

Sincerely,
Jerome Asselin

From duncan at research.bell-labs.com  Sat Oct 25 00:01:55 2003
From: duncan at research.bell-labs.com (Duncan Temple Lang)
Date: Sat Oct 25 00:01:09 2003
Subject: [Rd] Segmentation fault in .Call() (PR#4761)
In-Reply-To: <200310242130.h9OLUS0P016175@pubhealth.ku.dk>;
	from jerome@hivnet.ubc.ca on Fri, Oct 24, 2003 at 11:30:28PM +0200
References: <200310242130.h9OLUS0P016175@pubhealth.ku.dk>
Message-ID: <20031024180154.B20750@jessie.research.bell-labs.com>

jerome@hivnet.ubc.ca wrote:
> Full_Name: Jerome Asselin
> Version: 1.8.0
> OS: RedHat Linux 7.2
> Submission from: (NULL) (142.103.177.13)
> 
> 
> 
> I would not expect a segmentation fault; perhaps an error message.
> 
> > .Call("log")
> Segmentation fault
> 
> This is always reproducable for me.

Thanks for the info.  This should definitely not cause a segfault.
However, the explanation means that the cure is not obvious without
upsetting quite a lot of people.  Let me explain what happens.

Without the PACKAGE argument in the .Call(), we look for the symbol
"log" by walking through the array of previously loaded DLLs/shared
libraries.  Many of the standard packages use registration of the
routines that are to be called by R via the
.C/.Call/.Fortran/.External interaces. However, they also permit the
DLL to be searched using regular dynamic lookup.  This is the default
so as not to break anyone's S code that uses non-registered routines.
And this is what causes the problem!  In my case, we first look in the
methods library (although this is not important) and as for the symbol
"log". And we find it there on Linux.  Precisely why is very much
system-dependent and installation depdenent.  

Peforming the dynamic lookup is the problem.  If everyone were to use
registration, then we could turn this off, but that is a little too
much to ask (currently :-)).  If you had asked for a different symbol
and not something that was in the system libraries, the result would
have been better.

This did reveal a bug in that the base library has the dynamic lookup
turned on which it should not.  Trivial fix in progress.

I doubt too many people will get into this particular situation, so I
am not certain the fix is better than the event of small
probability. Opinions?

Thanks,

 D.

 


> 
> Sincerely,
> Jerome Asselin
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://www.stat.math.ethz.ch/mailman/listinfo/r-devel

-- 
_______________________________________________________________

Duncan Temple Lang                duncan@research.bell-labs.com
Bell Labs, Lucent Technologies    office: (908)582-3217
700 Mountain Avenue, Room 2C-259  fax:    (908)582-3340
Murray Hill, NJ  07974-2070       
         http://cm.bell-labs.com/stat/duncan

From ripley at stats.ox.ac.uk  Sat Oct 25 08:44:19 2003
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Sat Oct 25 08:43:25 2003
Subject: [Rd] Segmentation fault in .Call() (PR#4761)
In-Reply-To: <200310242130.h9OLUS0P016175@pubhealth.ku.dk>
Message-ID: <Pine.LNX.4.44.0310250733450.7594-100000@gannet.stats>

Your expectations are wrong: please re-read the section on BUGS in the
FAQ. It *starts*:

If R executes an illegal instruction, or dies with an operating system
error message that indicates a problem in the program (as opposed to
something like "disk full"), then it is certainly a bug.  If you call
`.C()', `.Fortran()', `.External()' or `.Call()' (or `.Internal()')
yourself (or in a function you wrote), you can always crash R by using
wrong argument types (modes).  This is not a bug.

On Fri, 24 Oct 2003 jerome@hivnet.ubc.ca wrote:

> Full_Name: Jerome Asselin
> Version: 1.8.0
> OS: RedHat Linux 7.2
> Submission from: (NULL) (142.103.177.13)
> 
> 
> 
> I would not expect a segmentation fault; perhaps an error message.
> 
> > .Call("log")
> Segmentation fault
> 
> This is always reproducable for me.

So you never learn from your mistakes?


We look forward to receiving your apologies.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From ripley at stats.ox.ac.uk  Sat Oct 25 10:57:39 2003
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Sat Oct 25 10:56:39 2003
Subject: [Rd] Versions of PCRE, documenting what grep etc do.
In-Reply-To: <16281.16901.529445.577664@mithrandir.hornik.net>
Message-ID: <Pine.LNX.4.44.0310250952350.26673-100000@gannet.stats>

I have added a preliminary help page for regex to R-patched which should
help for now, and added a configure test for PCRE >= 4.0 to R-devel.

I will return to this later in 2003.

Brian

On Fri, 24 Oct 2003, Kurt Hornik wrote:

> >>>>> Prof Brian Ripley writes:
> 
> > A couple of weeks back there was some discussion about documenting the
> > regular expressions as used in R.  Several years ago the problem was
> > that this was OS-dependent, and to plug that problem we incorporated
> > regexp code from a version of GNU grep, later updated to grep-2.4.2 in
> > R 1.2.0.
> 
> > I have been looking at documenting what grep(perl=TRUE) does, and we
> > have a similar problem in that the current PCRE, 4.4, implements
> > rather more of Perl's regexps than 3.9 (which is in 1.8.0 if the OS
> > does not supply it, and RH8.0 has PCRE 3.9. Whichever version of
> > Debian is on franz has PCRE 3.4).
> 
> > I could add a configure check for PCRE >= 4.0, and I think probably
> > should do that.  However, my inclination is to always use the version
> > of PCRE in the R sources and thereby ensure that all builds of R have
> > the same version, the one I will document.  Comments, please.
> 
> I think we should in any case allow maintainers of binary packages on
> platforms with advanced package management systems to force the use of
> shared libraries the system can provide.  (So the binary maintainers
> would need to verify that the system package provides the right libs and
> headers.)
> 
> Not sure about the default: we typically try to use available system
> resources, unless this is bound to cause problems, and regex was of the
> latter type, afaicr.  
> 
> > For PCRE 4.4 there is a long man page that I will use as a basis for
> > the documentation.  I am inclined just to include either a text or PDF
> > version of the man page -- any preferences for which form?
> 
> Depends on where you would put the docs, I think.  Btw, where can 4.4 be
> found?
> 
> > For the non-Perl regexps it is harder, as I am unsure exactly what
> > patterns the GNU regex we have accepts.  (From a problem which
> > occurred with some Sweave regexps, I think it accepts more than it is
> > intended to.)  One fairly good docu source is the GNU grep man page:
> > does anyone know a better one?  I had thought of writing a regexp.Rd
> > help page to which grep.Rd could refer.
> 
> That would be great.  Linux has a regex(7) purported to be "taken from
> Henry Spencer's regex package", which might be used as a start.  The old
> GNU regex .tar.gz has a texinfo file, but does not help for what we
> need, I think.
> 
> [I recently looked for available regexp docs, but was not too
> successful.]
> 
> > None of this is imminent (I am too busy) but is intended for the next 
> > minor release (which may be called 1.9.0 or 2.0.0, I gather).
> 
> Too bad :-(
> 
> Best
> -k
> 
> 

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From deleeuw at stat.ucla.edu  Sun Oct 26 16:43:33 2003
From: deleeuw at stat.ucla.edu (Jan de Leeuw)
Date: Sun Oct 26 16:43:31 2003
Subject: [Rd] FLAME
Message-ID: <27CEA319-07CB-11D8-8553-000A95A67E82@stat.ucla.edu>

Yesterday I ported FLAME to OS X  
(http://www.cs.utexas.edu/users/flame/index.html).
FLAME is a system to automatically (currently semi-automatically)  
generate
efficient and correct linear algebra routines in C or MATLAB or MPI  
from descriptions
of the algorithms. It uses code that relies heavily on partitioning of  
matrices,
and avoids indices as much as possible. There are a number of articles  
in
TOMS on this approach, and on some applications. Short intro at
http://www.cs.utexas.edu/users/flame/new_FIREsite/Examples/index.html

I was able to shave 10%-20% of the time needed to do a large QR  
decomposition,
compared to the LAPACK that is sitting in vecLib.framework. See the  
examples
in http://www.cs.utexas.edu/users/flame/FIREsite/.

Now the FLAME group (in particular Robert van der Geijn, who is also  
responsible
for PLAPACK) is interested in extending the FLAME approach to  
non-standard
LAPACK extensions. I forward a message below, which he asked me to  
forward
to "my community".
====================
If there were operations that are not (properly) supported by LAPACK,  
what are they?  In other words, what wish-list of
operations would you like to see supported by an LAPACK-like library  
(just dense linear algebra, please)?  What routines
in LAPACK were modified to get slightly different functionality?

An example we ran into was in updating the QR factorization:

LAPACK supports A -> Q R.  But what if a new set of observations comes  
in?

Given A->QR ,
/ A \ -> / Q1 \  R1
\ B /      \ Q2 /
requires a complete new factorization, which is costly.
====================
I guess R-core can perhaps help getting more statistical computation  
into FLAME
by answering these questions. I can forward answers, or you can directly
contact  rvdg@cs.utexas.edu

===
Jan de Leeuw; Professor and Chair, UCLA Department of Statistics;
Editor: Journal of Multivariate Analysis, Journal of Statistical  
Software
US mail: 8130 Math Sciences Bldg, Box 951554, Los Angeles, CA 90095-1554
phone (310)-825-9550;  fax (310)-206-5658;  email: deleeuw@stat.ucla.edu
homepage: http://gifi.stat.ucla.edu
   
------------------------------------------------------------------------ 
-------------------------
           No matter where you go, there you are. --- Buckaroo Banzai
                    http://gifi.stat.ucla.edu/sounds/nomatter.au

From bates at stat.wisc.edu  Sun Oct 26 19:23:34 2003
From: bates at stat.wisc.edu (Douglas Bates)
Date: Sun Oct 26 19:23:36 2003
Subject: [Rd] FLAME
In-Reply-To: <27CEA319-07CB-11D8-8553-000A95A67E82@stat.ucla.edu>
References: <27CEA319-07CB-11D8-8553-000A95A67E82@stat.ucla.edu>
Message-ID: <6rptgjq2mx.fsf@bates4.stat.wisc.edu>

I have also been looking at FLAME.  One operation that would be very
helpful in statistical computing is to have a QR decomposition with
pivoting only on approximate singularity.  That is, preserve the
original order of the columns unless a diagonal element would have a
magnitude less than some threshold, in which case the column is moved
to the last position.  That's what dqrdc2 in R and dqrdca in S do so
that the original order of terms is preserved in the partial sums of
squares but rank deficient model matrices can be accomodated.
-- 
Douglas Bates                            bates@stat.wisc.edu
Statistics Department                    608/262-2598
University of Wisconsin - Madison        http://www.stat.wisc.edu/~bates/

From laurent at cbs.dtu.dk  Mon Oct 27 12:55:34 2003
From: laurent at cbs.dtu.dk (Laurent Gautier)
Date: Mon Oct 27 12:53:47 2003
Subject: [Rd] configure, config.site and TCLTK_CPPFLAGS
Message-ID: <20031027115534.GA13043293@genome.cbs.dtu.dk>

Hi,

I am trying to configure R-1.8.0-patched (fresh rsync) for machines
with the tcltk files in unorthodox locations. I specified
a TCLTK_CPPFLAGS='/usr/freeware/include/' in the file config.site
but it seems that a '# no special path needed' is added when running
configure, causing trouble (See the excerpt from config.site below).
This was working with R-1.7.1. I am not an autoconf/configure
expert, so any hint is welcome. 

Thanks,

L.

configure:23914: gcc -o conftest -g -O2 -I/usr/freeware/include -I /usr/freeware/include/ # no special path needed -L/usr/local/lib conftest.c -ldl -ltermcap -lm  -L/usr/freeware/lib32 -ltcl8.0 -L/usr/freeware/lib32 -ltk8.0 -lX11   -lm >&5
gcc: #: No such file or directory
gcc: no: No such file or directory
gcc: special: No such file or directory
gcc: path: No such file or directory
gcc: needed: No such file or directory

From L.T.Kell at cefas.co.uk  Mon Oct 27 16:38:44 2003
From: L.T.Kell at cefas.co.uk (L.T.Kell@cefas.co.uk)
Date: Mon Oct 27 16:37:45 2003
Subject: [Rd] (PR#4806)
Message-ID: <200310271538.h9RFci0P012105@pubhealth.ku.dk>

This message is in MIME format. Since your mail reader does not understand
this format, some or all of this message may not be legible.

------_=_NextPart_000_01C39C9F.B5DABBD0
Content-Type: text/plain;
	charset="iso-8859-1"

# Your mailer is set to "none" (default on Windows),
# hence we cannot send the bug report directly from R.
# Please copy the bug report (after finishing it) to
# your favorite email program and send it to
#
#       r-bugs@r-project.org
#
######################################################



I am trying to call functions written in Visual C++ from R version 1.8.0
under Windows. 
Although these functions ran correctly in version 1.7 in Version 1.8.0 they
cause R to crash after the function has returned to R

I can repeat the problem with a DLL based on a simple example given by
Douglas Bates. 

dyn.load("TestDll.dll")
test<-function(x,y) .Call("out",x,y)

x<-1:10
y<-2:10
test(x,y)

The C++ code is below

#include <windows.h>
#include <R.h>
#include <Rinternals.h>


HWND      hWndMain;   
HINSTANCE hInst;    
HGLOBAL   hXloperArray;

//32 bit Entry point

#define CLASS_NAME_BUFFER  50

BOOL WINAPI DllMain(HINSTANCE hDLL, DWORD dwReason, LPVOID lpReserved)
   {					
   extern HWND      hWndMain;
   extern HINSTANCE hInst;    
   
   hInst = hDLL; 
    
   return TRUE;
   }

extern "C" int FAR PASCAL WEP (int nArgument)
   {
   return 1;
   } 
     
extern "C" __declspec(dllexport) SEXP __stdcall out(SEXP x, SEXP y)
     {
       int i, j, nx, ny;
       double tmp;
       SEXP ans;
     
       nx = length(x); ny = length(y);
       PROTECT(ans = allocMatrix(REALSXP, nx, ny));
       for(i = 0; i < nx; i++) {
         tmp = REAL(x)[i];
         for(j = 0; j < ny; j++)
           REAL(ans)[i + nx*j] = tmp * REAL(y)[j];
       }
       UNPROTECT(1);
       return(ans);
     }
     


I created the lib file from the R.dll using pexports and lib
i.e.

pexports R.dll > RDLL.def
lib /machine:i386 /def:RDLL.def /out:Rdll.lib

Used the following def file

LIBRARY   TestDLL	
EXPORTS	
   out		       =_out@8

Regards Laurie

--please do not edit the information below--

Version:
 platform = i386-pc-mingw32
 arch = i386
 os = mingw32
 system = i386, mingw32
 status = 
 major = 1
 minor = 8.0
 year = 2003
 month = 10
 day = 08
 language = R

Windows 2000 Professional (build 2195) Service Pack 3.0

Search Path:
 .GlobalEnv, package:methods, package:ctest, package:mva, package:modreg,
package:nls, package:ts, Autoloads, package:base


 <<Laurence Kell (E-mail).vcf>> 

------_=_NextPart_000_01C39C9F.B5DABBD0
Content-Type: application/octet-stream;
	name="Laurence Kell (E-mail).vcf"
Content-Disposition: attachment;
	filename="Laurence Kell (E-mail).vcf"

BEGIN:VCARD
VERSION:2.1
N:Kell;Laurence
FN:Laurence Kell (E-mail)
ORG:CEFAS
TEL;WORK;VOICE:+44 (0) 1502 524257
TEL;WORK;FAX:+44 (0) 1502 524511
ADR;WORK:;;Lowestoft Laboratory;Pakefield Road;Lowestoft,;NR33 0HT;UK
LABEL;WORK;ENCODING=QUOTED-PRINTABLE:Lowestoft Laboratory=0D=0APakefield Road, Lowestoft, NR33 0HT=0D=0AUK
EMAIL;PREF;INTERNET:/o=CEFAS/ou=LOWESTOFT/cn=Recipients/cn=LTK00
REV:20030410T130517Z
END:VCARD

------_=_NextPart_000_01C39C9F.B5DABBD0--

From jerome at hivnet.ubc.ca  Mon Oct 27 18:28:05 2003
From: jerome at hivnet.ubc.ca (Jerome Asselin)
Date: Mon Oct 27 18:27:39 2003
Subject: [Rd] Segmentation fault in .Call() (PR#4761)
In-Reply-To: <Pine.LNX.4.44.0310250733450.7594-100000@gannet.stats>
References: <Pine.LNX.4.44.0310250733450.7594-100000@gannet.stats>
Message-ID: <200310271727.JAA19614@hivnet.ubc.ca>


I have reviewed the BUGS section of the FAQ. I did not realise that 
.Call() was an exception in this case.

Please accept my sincere apologies.

Jerome Asselin

On October 24, 2003 11:44 pm, Prof Brian Ripley wrote:
> Your expectations are wrong: please re-read the section on BUGS in the
> FAQ. It *starts*:
>
> If R executes an illegal instruction, or dies with an operating system
> error message that indicates a problem in the program (as opposed to
> something like "disk full"), then it is certainly a bug.  If you call
> `.C()', `.Fortran()', `.External()' or `.Call()' (or `.Internal()')
> yourself (or in a function you wrote), you can always crash R by using
> wrong argument types (modes).  This is not a bug.
>
> On Fri, 24 Oct 2003 jerome@hivnet.ubc.ca wrote:
> > Full_Name: Jerome Asselin
> > Version: 1.8.0
> > OS: RedHat Linux 7.2
> > Submission from: (NULL) (142.103.177.13)
> >
> >
> >
> > I would not expect a segmentation fault; perhaps an error message.
> >
> > > .Call("log")
> >
> > Segmentation fault
> >
> > This is always reproducable for me.
>
> So you never learn from your mistakes?
>
>
> We look forward to receiving your apologies.

From jrogers at cantatapharm.com  Mon Oct 27 18:45:18 2003
From: jrogers at cantatapharm.com (jrogers@cantatapharm.com)
Date: Mon Oct 27 18:44:14 2003
Subject: [Rd] [[<-.data.frame with POSIXt replacement (PR#4808)
Message-ID: <200310271745.h9RHjI0P013228@pubhealth.ku.dk>

Hi,

The following seems to be a bug introduced with version 1.8.0 (it worked
without error on my installation of version 1.7.0):

> test <- data.frame(time = I(c("2003-08-19:22:55:57")))
> test[["time"]] <- strptime(test[["time"]], format =
"%Y-%m-%d:%H:%M:%S")
Error in "[[<-.data.frame"(`*tmp*`, "time", value =
strptime(test[["time"]],  : 
	replacement has 9 rows, data has 1
> ## This generates the same error:
> # test$time <- strptime(test$time, format = "%Y-%m-%d:%H:%M:%S")

         _              
platform i386-pc-mingw32
arch     i386           
os       mingw32        
system   i386, mingw32  
status                  
major    1              
minor    8.0            
year     2003           
month    10             
day      08             
language R            


Thanks,
Jim 

James A. Rogers, Ph.D. <rogers@cantatapharm.com>
Statistical Scientist
Cantata Pharmaceuticals
300 Technology Square, 5th floor
Cambridge, MA  02139
617.225.9009 x312
Fax 617.225.9010

From duncan at research.bell-labs.com  Mon Oct 27 18:52:54 2003
From: duncan at research.bell-labs.com (Duncan Temple Lang)
Date: Mon Oct 27 18:52:06 2003
Subject: [Rd] (PR#4806)
In-Reply-To: <200310271538.h9RFci0P012105@pubhealth.ku.dk>;
	from L.T.Kell@cefas.co.uk on Mon, Oct 27, 2003 at 04:38:44PM +0100
References: <200310271538.h9RFci0P012105@pubhealth.ku.dk>
Message-ID: <20031027125254.G9466@jessie.research.bell-labs.com>

As far as I can see, the code you give passes two integer vectors (x
and y) to a routine out() that accesses the values in the vector as if
they were numeric vectors.  This is an error in the code and not in R.

If test were written as 

  test  = function(x, y) .Call("out", as.numeric(x), as.numeric(y))

the code will work or other problems will be found.


 D.


L.T.Kell@cefas.co.uk wrote:
> This message is in MIME format. Since your mail reader does not understand
> this format, some or all of this message may not be legible.
> 
> ------_=_NextPart_000_01C39C9F.B5DABBD0
> Content-Type: text/plain;
> 	charset="iso-8859-1"
> 
> # Your mailer is set to "none" (default on Windows),
> # hence we cannot send the bug report directly from R.
> # Please copy the bug report (after finishing it) to
> # your favorite email program and send it to
> #
> #       r-bugs@r-project.org
> #
> ######################################################
> 
> 
> 
> I am trying to call functions written in Visual C++ from R version 1.8.0
> under Windows. 
> Although these functions ran correctly in version 1.7 in Version 1.8.0 they
> cause R to crash after the function has returned to R
> 
> I can repeat the problem with a DLL based on a simple example given by
> Douglas Bates. 
> 
> dyn.load("TestDll.dll")
> test<-function(x,y) .Call("out",x,y)
> 
> x<-1:10
> y<-2:10
> test(x,y)
> 
> The C++ code is below
> 
> #include <windows.h>
> #include <R.h>
> #include <Rinternals.h>
> 
> 
> HWND      hWndMain;   
> HINSTANCE hInst;    
> HGLOBAL   hXloperArray;
> 
> //32 bit Entry point
> 
> #define CLASS_NAME_BUFFER  50
> 
> BOOL WINAPI DllMain(HINSTANCE hDLL, DWORD dwReason, LPVOID lpReserved)
>    {					
>    extern HWND      hWndMain;
>    extern HINSTANCE hInst;    
>    
>    hInst = hDLL; 
>     
>    return TRUE;
>    }
> 
> extern "C" int FAR PASCAL WEP (int nArgument)
>    {
>    return 1;
>    } 
>      
> extern "C" __declspec(dllexport) SEXP __stdcall out(SEXP x, SEXP y)
>      {
>        int i, j, nx, ny;
>        double tmp;
>        SEXP ans;
>      
>        nx = length(x); ny = length(y);
>        PROTECT(ans = allocMatrix(REALSXP, nx, ny));
>        for(i = 0; i < nx; i++) {
>          tmp = REAL(x)[i];
>          for(j = 0; j < ny; j++)
>            REAL(ans)[i + nx*j] = tmp * REAL(y)[j];
>        }
>        UNPROTECT(1);
>        return(ans);
>      }
>      
> 
> 
> I created the lib file from the R.dll using pexports and lib
> i.e.
> 
> pexports R.dll > RDLL.def
> lib /machine:i386 /def:RDLL.def /out:Rdll.lib
> 
> Used the following def file
> 
> LIBRARY   TestDLL	
> EXPORTS	
>    out		       =_out@8
> 
> Regards Laurie
> 
> --please do not edit the information below--
> 
> Version:
>  platform = i386-pc-mingw32
>  arch = i386
>  os = mingw32
>  system = i386, mingw32
>  status = 
>  major = 1
>  minor = 8.0
>  year = 2003
>  month = 10
>  day = 08
>  language = R
> 
> Windows 2000 Professional (build 2195) Service Pack 3.0
> 
> Search Path:
>  .GlobalEnv, package:methods, package:ctest, package:mva, package:modreg,
> package:nls, package:ts, Autoloads, package:base
> 
> 
>  <<Laurence Kell (E-mail).vcf>> 
> 
> ------_=_NextPart_000_01C39C9F.B5DABBD0
> Content-Type: application/octet-stream;
> 	name="Laurence Kell (E-mail).vcf"
> Content-Disposition: attachment;
> 	filename="Laurence Kell (E-mail).vcf"
> 
> BEGIN:VCARD
> VERSION:2.1
> N:Kell;Laurence
> FN:Laurence Kell (E-mail)
> ORG:CEFAS
> TEL;WORK;VOICE:+44 (0) 1502 524257
> TEL;WORK;FAX:+44 (0) 1502 524511
> ADR;WORK:;;Lowestoft Laboratory;Pakefield Road;Lowestoft,;NR33 0HT;UK
> LABEL;WORK;ENCODING=QUOTED-PRINTABLE:Lowestoft Laboratory=0D=0APakefield Road, Lowestoft, NR33 0HT=0D=0AUK
> EMAIL;PREF;INTERNET:/o=CEFAS/ou=LOWESTOFT/cn=Recipients/cn=LTK00
> REV:20030410T130517Z
> END:VCARD
> 
> ------_=_NextPart_000_01C39C9F.B5DABBD0--
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://www.stat.math.ethz.ch/mailman/listinfo/r-devel

-- 
_______________________________________________________________

Duncan Temple Lang                duncan@research.bell-labs.com
Bell Labs, Lucent Technologies    office: (908)582-3217
700 Mountain Avenue, Room 2C-259  fax:    (908)582-3340
Murray Hill, NJ  07974-2070       
         http://cm.bell-labs.com/stat/duncan

From rossini at blindglobe.net  Mon Oct 27 19:47:15 2003
From: rossini at blindglobe.net (A.J. Rossini)
Date: Mon Oct 27 19:45:30 2003
Subject: [Rd] initialization of S4 classes/methods
Message-ID: <85llr61psc.fsf@blindglobe.net>


I'm seeing weird issues in methods initialization, i.e. loading
marrayClasses loads Biobase, and when explicitly done, as in

   library(Biobase)
   library(marrayClasses) 

is fine, but when Biobase is loaded via a require statement in
marrayClasses' .First.Lib, I end up with:

  Warning message: In the method signature for function "coerce", class
  "exprSet" has no current definition in: matchSignature(signature,
  fdef, where) 

and based on the "band-aid" working above, suggests an initialization
or evaluation timing problem.

(and exprSet is defined in the Biobase package).

best,
-tony

-- 
rossini@u.washington.edu            http://www.analytics.washington.edu/ 
Biomedical and Health Informatics   University of Washington
Biostatistics, SCHARP/HVTN          Fred Hutchinson Cancer Research Center
UW (Tu/Th/F): 206-616-7630 FAX=206-543-3461 | Voicemail is unreliable
FHCRC  (M/W): 206-667-7025 FAX=206-667-4812 | use Email

CONFIDENTIALITY NOTICE: This e-mail message and any attachme...{{dropped}}

From ripley at stats.ox.ac.uk  Mon Oct 27 19:59:35 2003
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Mon Oct 27 19:58:33 2003
Subject: [Rd] [[<-.data.frame with POSIXt replacement (PR#4808)
In-Reply-To: <200310271745.h9RHjI0P013228@pubhealth.ku.dk>
Message-ID: <Pine.LNX.4.44.0310271857530.28467-100000@gannet.stats>

It is not a bug in 1.8.0.  It was a bug in 1.7.0 (and .1).
X
You cannot assign a POSIXlt value to a data frame correctly.

Please do RTFM, especially the NEWS file.  We don't need smart alecks 
here.

On Mon, 27 Oct 2003 jrogers@cantatapharm.com wrote:

> The following seems to be a bug introduced with version 1.8.0 (it worked
> without error on my installation of version 1.7.0):
> 
> > test <- data.frame(time = I(c("2003-08-19:22:55:57")))
> > test[["time"]] <- strptime(test[["time"]], format =
> "%Y-%m-%d:%H:%M:%S")
> Error in "[[<-.data.frame"(`*tmp*`, "time", value =
> strptime(test[["time"]],  : 
> 	replacement has 9 rows, data has 1
> > ## This generates the same error:
> > # test$time <- strptime(test$time, format = "%Y-%m-%d:%H:%M:%S")
> 
>          _              
> platform i386-pc-mingw32
> arch     i386           
> os       mingw32        
> system   i386, mingw32  
> status                  
> major    1              
> minor    8.0            
> year     2003           
> month    10             
> day      08             
> language R            
> 
> 
> Thanks,
> Jim 
> 
> James A. Rogers, Ph.D. <rogers@cantatapharm.com>
> Statistical Scientist
> Cantata Pharmaceuticals
> 300 Technology Square, 5th floor
> Cambridge, MA  02139
> 617.225.9009 x312
> Fax 617.225.9010
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://www.stat.math.ethz.ch/mailman/listinfo/r-devel
> 
> 

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From jrogers at cantatapharm.com  Mon Oct 27 20:38:16 2003
From: jrogers at cantatapharm.com (Jim Rogers)
Date: Mon Oct 27 20:34:27 2003
Subject: [Rd] [[<-.data.frame with POSIXt replacement (PR#4808)
Message-ID: <99A12772DCDEEB458B996332957B0D53011879@mercury.cantatapharm.com>

??? Smart aleck? Honestly, I am trying my best to help. What in what I
wrote makes me sound like a smart aleck? 

I now understand that I did not do everything I should have, but I
checked the places that occurred to me to check: the release notes for
1.8.0, the documentation for "[[<-" and "$<-", and an R site search for
"$<-" and "[[<-". Having thought about it, and having consulted the FAQ
for bug reports, there was nothing else that I knew to do (short of
submitting a question to R-help, in which case I was afraid I would be
accused of submitting a bug report to the wrong place). 

I took a couple hours out of my day to be as sure as possible that I was
submitting a real bug. I realize that a couple hours is nothing compared
to the time that you and the development team contribute. Nonetheless,
please understand that I sent the report in the spirit of doing my
little bit to help. It would have been MUCH easier for me to do nothing
at all. Surely there is a place in the R project for people like me who,
though inexpert and unable to commit full time to the project, still
want to contribute without the fear of being insulted? 

I truly do not understand. 

Jim  


> -----Original Message-----
> From: Prof Brian Ripley [mailto:ripley@stats.ox.ac.uk] 
> Sent: Monday, October 27, 2003 2:00 PM
> To: Jim Rogers
> Cc: r-devel@stat.math.ethz.ch; R-bugs@biostat.ku.dk
> Subject: Re: [Rd] [[<-.data.frame with POSIXt replacement (PR#4808)
> 
> 
> It is not a bug in 1.8.0.  It was a bug in 1.7.0 (and .1).
> X
> You cannot assign a POSIXlt value to a data frame correctly.
> 
> Please do RTFM, especially the NEWS file.  We don't need smart alecks 
> here.
> 
> On Mon, 27 Oct 2003 jrogers@cantatapharm.com wrote:
> 
> > The following seems to be a bug introduced with version 1.8.0 (it 
> > worked without error on my installation of version 1.7.0):
> > 
> > > test <- data.frame(time = I(c("2003-08-19:22:55:57"))) 
> > > test[["time"]] <- strptime(test[["time"]], format =
> > "%Y-%m-%d:%H:%M:%S")
> > Error in "[[<-.data.frame"(`*tmp*`, "time", value = 
> > strptime(test[["time"]],  :
> > 	replacement has 9 rows, data has 1
> > > ## This generates the same error:
> > > # test$time <- strptime(test$time, format = "%Y-%m-%d:%H:%M:%S")
> > 
> >          _              
> > platform i386-pc-mingw32
> > arch     i386           
> > os       mingw32        
> > system   i386, mingw32  
> > status                  
> > major    1              
> > minor    8.0            
> > year     2003           
> > month    10             
> > day      08             
> > language R            
> > 
> > 
> > Thanks,
> > Jim
> > 
> > James A. Rogers, Ph.D. <rogers@cantatapharm.com>
> > Statistical Scientist
> > Cantata Pharmaceuticals
> > 300 Technology Square, 5th floor
> > Cambridge, MA  02139
> > 617.225.9009 x312
> > Fax 617.225.9010
> > 
> > ______________________________________________
> > R-devel@stat.math.ethz.ch mailing list 
> > https://www.stat.math.ethz.ch/mailman/listinfo/r-devel
> > 
> > 
> 
> -- 
> Brian D. Ripley,                  ripley@stats.ox.ac.uk
> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> University of Oxford,             Tel:  +44 1865 272861 (self)
> 1 South Parks Road,                     +44 1865 272866 (PA)
> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
> 
>

From L.T.Kell at cefas.co.uk  Mon Oct 27 21:00:57 2003
From: L.T.Kell at cefas.co.uk (L.T.Kell@cefas.co.uk)
Date: Mon Oct 27 21:00:02 2003
Subject: [Rd] (PR#4806)
Message-ID: <200310272000.h9RK0v0P014034@pubhealth.ku.dk>

Duncan Temple Lang correctly pointed out that the function should have been
declared as

 test<-function(x,y) .Call("out",as.numeric(x),as.numeric(y))

However, the problem is that calling any of the functions in my DLL
(compiled using MSVC C++) causes R 1.8.0 to crash; out() ws just a simple
example. The functions had previous worked under R 1.7.x. I have now
recompiled R 1.8.0 under an earlier version of MinGW and my DLL functions
now works. I therefore suspect that the problem is related to MinGW and
Windows.

Regards Laurie

>  -----Original Message-----
> From: 	Laurence Kell FM CEFAS  
> Sent:	27 October 2003 15:34
> To:	'r-bugs@r-project.org'
> Subject:	
> 
> # Your mailer is set to "none" (default on Windows),
> # hence we cannot send the bug report directly from R.
> # Please copy the bug report (after finishing it) to
> # your favorite email program and send it to
> #
> #       r-bugs@r-project.org
> #
> ######################################################
> 
> 
> 
> I am trying to call functions written in Visual C++ from R version 1.8.0
> under Windows. 
> Although these functions ran correctly in version 1.7 in Version 1.8.0
> they cause R to crash after the function has returned to R
> 
> I can repeat the problem with a DLL based on a simple example given by
> Douglas Bates. 
> 
> dyn.load("TestDll.dll")
> test<-function(x,y) .Call("out",x,y)
> 
> x<-1:10
> y<-2:10
> test(x,y)
> 
> The C++ code is below
> 
> #include <windows.h>
> #include <R.h>
> #include <Rinternals.h>
> 
> 
> HWND      hWndMain;   
> HINSTANCE hInst;    
> HGLOBAL   hXloperArray;
> 
> //32 bit Entry point
> 
> #define CLASS_NAME_BUFFER  50
> 
> BOOL WINAPI DllMain(HINSTANCE hDLL, DWORD dwReason, LPVOID lpReserved)
>    {					
>    extern HWND      hWndMain;
>    extern HINSTANCE hInst;    
>    
>    hInst = hDLL; 
>     
>    return TRUE;
>    }
> 
> extern "C" int FAR PASCAL WEP (int nArgument)
>    {
>    return 1;
>    } 
>      
> extern "C" __declspec(dllexport) SEXP __stdcall out(SEXP x, SEXP y)
>      {
>        int i, j, nx, ny;
>        double tmp;
>        SEXP ans;
>      
>        nx = length(x); ny = length(y);
>        PROTECT(ans = allocMatrix(REALSXP, nx, ny));
>        for(i = 0; i < nx; i++) {
>          tmp = REAL(x)[i];
>          for(j = 0; j < ny; j++)
>            REAL(ans)[i + nx*j] = tmp * REAL(y)[j];
>        }
>        UNPROTECT(1);
>        return(ans);
>      }
>      
> 
> 
> I created the lib file from the R.dll using pexports and lib
> i.e.
> 
> pexports R.dll > RDLL.def
> lib /machine:i386 /def:RDLL.def /out:Rdll.lib
> 
> Used the following def file
> 
> LIBRARY   TestDLL	
> EXPORTS	
>    out		       =_out@8
> 
> Regards Laurie
> 
> --please do not edit the information below--
> 
> Version:
>  platform = i386-pc-mingw32
>  arch = i386
>  os = mingw32
>  system = i386, mingw32
>  status = 
>  major = 1
>  minor = 8.0
>  year = 2003
>  month = 10
>  day = 08
>  language = R
> 
> Windows 2000 Professional (build 2195) Service Pack 3.0
> 
> Search Path:
>  .GlobalEnv, package:methods, package:ctest, package:mva, package:modreg,
> package:nls, package:ts, Autoloads, package:base
> 
> 
>  << File: Laurence Kell (E-mail).vcf >>

From jmc at research.bell-labs.com  Mon Oct 27 21:21:33 2003
From: jmc at research.bell-labs.com (John Chambers)
Date: Mon Oct 27 21:21:46 2003
Subject: [Rd] initialization of S4 classes/methods
References: <85llr61psc.fsf@blindglobe.net>
Message-ID: <3F9D7E4D.24483090@research.bell-labs.com>

"A.J. Rossini" wrote:
> 
> I'm seeing weird issues in methods initialization, i.e. loading
> marrayClasses loads Biobase, and when explicitly done, as in
> 
>    library(Biobase)
>    library(marrayClasses)
> 
> is fine, but when Biobase is loaded via a require statement in
> marrayClasses' .First.Lib, I end up with:
> 
>   Warning message: In the method signature for function "coerce", class
>   "exprSet" has no current definition in: matchSignature(signature,
>   fdef, where)

Yes.  See below.  Does this actually cause problems later on?  When
methods are dispatched, it's likely that "exprSet" will be found.

> 
> and based on the "band-aid" working above, suggests an initialization
> or evaluation timing problem.

Not exactly.  The problem is one of the behavior of require() combined
with rules for parents of environments; it's bitten us before, but so
far hasn't been fixed.

1.  The effect of require() is to put Biobase on the search path
_before_ marrayClasses, whereas in the case that library(Biobase) has
been done previously, the opposite is true.

2.  In looking for the definiton of class exprSet, the call to exists
from setMethod will start with the environment of package marrayClasses
and search through the chain of parent environments; i.e., all the
packages _after_ marrayClasses in the search list.  And so it doesn't
find class "exprSet".

It's possible to hack our way around point 2 (by having a special case
for the environment not being a namespace), but point 1 seems not quite
correct.  For example, if the owner of marrayClasses wanted to
deliberately override an object in Biobase, require() would prevent it. 
(Not that overriding is necessarily a good practice, but it should
either work or be an error.)
 
John
> 
> (and exprSet is defined in the Biobase package).
> 
> best,
> -tony
> 
> --
> rossini@u.washington.edu            http://www.analytics.washington.edu/
> Biomedical and Health Informatics   University of Washington
> Biostatistics, SCHARP/HVTN          Fred Hutchinson Cancer Research Center
> UW (Tu/Th/F): 206-616-7630 FAX=206-543-3461 | Voicemail is unreliable
> FHCRC  (M/W): 206-667-7025 FAX=206-667-4812 | use Email
> 
> CONFIDENTIALITY NOTICE: This e-mail message and any attachme...{{dropped}}
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://www.stat.math.ethz.ch/mailman/listinfo/r-devel

-- 
John M. Chambers                  jmc@bell-labs.com
Bell Labs, Lucent Technologies    office: (908)582-2681
700 Mountain Avenue, Room 2C-282  fax:    (908)582-3340
Murray Hill, NJ  07974            web: http://www.cs.bell-labs.com/~jmc

From dmurdoch at pair.com  Mon Oct 27 21:36:55 2003
From: dmurdoch at pair.com (Duncan Murdoch)
Date: Mon Oct 27 21:35:55 2003
Subject: [Rd] (PR#4806)
In-Reply-To: <200310272000.h9RK0v0P014034@pubhealth.ku.dk>
References: <200310272000.h9RK0v0P014034@pubhealth.ku.dk>
Message-ID: <790rpvcg4p6351fn8tm0hb5cj8btpr055p@4ax.com>

On Mon, 27 Oct 2003 21:00:57 +0100 (MET), L.T.Kell@cefas.co.uk wrote :

>> I am trying to call functions written in Visual C++ from R version 1.8.0
>> under Windows. 
>> Although these functions ran correctly in version 1.7 in Version 1.8.0
>> they cause R to crash after the function has returned to R

You have a problem with the calling convention.

>> extern "C" __declspec(dllexport) SEXP __stdcall out(SEXP x, SEXP y)

R wants "cdecl", not "stdcall".

See my web page
<http://www.stats.uwo.ca/faculty/murdoch/software/compilingDLLs/> for
some advice (as well as readme.packages for VC++ advice).

Duncan Murdoch

From Kurt.Hornik at wu-wien.ac.at  Mon Oct 27 21:24:14 2003
From: Kurt.Hornik at wu-wien.ac.at (Kurt Hornik)
Date: Mon Oct 27 23:38:29 2003
Subject: [Rd] configure, config.site and TCLTK_CPPFLAGS
In-Reply-To: <20031027115534.GA13043293@genome.cbs.dtu.dk>
References: <20031027115534.GA13043293@genome.cbs.dtu.dk>
Message-ID: <16285.32494.170709.639084@mithrandir.hornik.net>

>>>>> Laurent Gautier writes:

> Hi,

> I am trying to configure R-1.8.0-patched (fresh rsync) for machines
> with the tcltk files in unorthodox locations. I specified a
> TCLTK_CPPFLAGS='/usr/freeware/include/' in the file config.site but it
> seems that a '# no special path needed' is added when running
> configure, causing trouble (See the excerpt from config.site below).
> This was working with R-1.7.1. I am not an autoconf/configure expert,
> so any hint is welcome.

Could the "no special path needed" comment be something you added in one
of your config files?  I cannot seem to find it in the R sources ...

-k

> Thanks,

> L.

> configure:23914: gcc -o conftest -g -O2 -I/usr/freeware/include -I /usr/freeware/include/ # no special path needed -L/usr/local/lib conftest.c -ldl -ltermcap -lm  -L/usr/freeware/lib32 -ltcl8.0 -L/usr/freeware/lib32 -ltk8.0 -lX11   -lm >&5
> gcc: #: No such file or directory
> gcc: no: No such file or directory
> gcc: special: No such file or directory
> gcc: path: No such file or directory
> gcc: needed: No such file or directory

> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://www.stat.math.ethz.ch/mailman/listinfo/r-devel

From kleiweg at let.rug.nl  Tue Oct 28 00:26:34 2003
From: kleiweg at let.rug.nl (Peter Kleiweg)
Date: Tue Oct 28 00:25:31 2003
Subject: [Rd] configure, config.site and TCLTK_CPPFLAGS
In-Reply-To: <16285.32494.170709.639084@mithrandir.hornik.net>
Message-ID: <Pine.LNX.4.44.0310280025530.9636-100000@kleigh.nl>

# aldus Kurt Hornik :

> > I am trying to configure R-1.8.0-patched (fresh rsync) for machines
> > with the tcltk files in unorthodox locations. I specified a
> > TCLTK_CPPFLAGS='/usr/freeware/include/' in the file config.site but it
> > seems that a '# no special path needed' is added when running
> > configure, causing trouble (See the excerpt from config.site below).
> > This was working with R-1.7.1. I am not an autoconf/configure expert,
> > so any hint is welcome.
>
> Could the "no special path needed" comment be something you added in one
> of your config files?  I cannot seem to find it in the R sources ...

See PR#1500


-- 
Peter Kleiweg
http://www.let.rug.nl/~kleiweg/

From tplate at attglobal.net  Tue Oct 28 05:49:44 2003
From: tplate at attglobal.net (Tony Plate)
Date: Tue Oct 28 05:48:55 2003
Subject: [Rd] proposal for "strict" versions of subsetting operators
Message-ID: <5.1.0.14.2.20031027213400.00a99a70@pop6.attglobal.net>

I'd like to propose adding "strict" versions of the subsetting operators "[", "[[", and "$" to the R language.  These strict versions would be intended for use in programming rather than in interactive use.  They do not perform any form of partial string matching or opportunistic simplification such as dimension dropping by default.  They allow more precise specification of which dimensions to drop, which can be very useful when working with higher-dimensional arrays.  The syntax for them can be created by prefixing the existing subsetting operators with some single character such as "$", e.g.: x$[i, j], x$[[i]], and x$$component.  Such syntax would be an addition to the existing syntax and would not cause any existing code to behave differently.

I've created a set of patches that implement and test this syntax addition for R-1.8.0.  They can be downloaded from http://pws.prserv.net/tap/software/strict-subset-R.1.8.0.zip. These patches implement these strict subsetting operators for vectors, lists and arrays, with the following semantics:

(1) The drop argument can be logical or numeric, and the default is F.  If drop is requested, is non-optional (it is an error to request to drop a dimension that is not droppable).  Numeric values for drop, or logical vector values with length greater than one can be used to specify exactly which dimensions to drop.  This is very useful when working with arrays with 3 dimensions or more.
(2) no partial string matching (currently in R, partial string matching is used only for list components and for data frame row indexing)

I've not supplied any documentation is this patch, but if there is any interest in incorporating something like this into the R language, I'd be happy to supply some documentation.  I've also not carefully debugged these patches -- they were intended to test the concept, and they seem to work.  Again, if there is any real interest, I can look over them more carefully and test them more comprehensively.

What follows in this email is some discussion and rational for this addition.

The drop=T default for subsetting tends to catch both new and experienced users.  It generally gives users what they want (at least with matrices).  However, it surprises new users when they don't get what they want, and it fools experienced users because they forget or are too lazy to specify non-default behavior (i.e., drop=F) and they fail to detect this omission because their test cases don't create a situation in which the need for non-default behavior is apparent.

Having a different set of strict subsetting operators might relieve some of the long-standing tension between having subsetting operators support robust programming and making subsetting operators convenient for interactive and common uses (by performing opportunistic simplification, as they currently do).  The following two excerpts demonstrate this tension.

The R FAQ says:
>7.7 Why do my matrices lose dimensions?
>... After much discussion this has been determined to be a feature. ...
>... The drop = FALSE option should be used defensively when programming. ...

Bill Venables (William.Venables@cmis.CSIRO.AU) wrote in an email on an R mailing list on Mon, 15 Nov 1999:

>Re: [R] dimnames
>
>[material explaining the drop=T default for subsetting deleted]
>
>I can't help feeling that this convention, helpful as it might be
>in interactive work, is a bit of a mistake. It second-guesses
>what you mean rather than what you actually program. In that
>respect it is for me an uncomfortable reminder of the sort of
>thing that goes on in much MicroSoft software...

There are at least three ways in which having a set of strict subsetting operators could make R programs more robust and simpler:

(1) Users can make the own programs more robust by consistently using the strict subsetting operators (except when they really want opportunistic simplification).
(2) If a package writer adopts use of the strict subsetting operators, users can have a higher level of confidence that the functions in the package will correctly handle all data presented to them.
(3) Users can more easily work with higher dimensional arrays.  Currently it is requires somewhat cumbersome expressions, or custom functions to, for example, extract a m x k matrix from a n x m x k array (because if one relies on the default in an expression like x[i, , ], a vector will result if m or k happen to be 1, and if one uses x[i, , ,drop=F], then one must explicitly manipulate the dim attribute to get a matrix.)
Here is a brief transcript showing the more easily predicted behavior of the "$[" operator on a 3-d array from which a matrix "slice" is being extracted.  In one case (x1) the slice has both dimensions with length > 1, in the other case (x2), the slice has one dimension of length 1.

> x1 <- array(1:24, dim=c(2,3,4), dimnames=list(LETTERS[25:26],letters[1:3],LETTERS[1:4]))
> x2 <- x1$[,1,]
> dim(x1)
[1] 2 3 4
> dim(x2)
[1] 2 1 4
> dim(x1[1,,])
[1] 3 4
> dim(x1$[1,,])
[1] 1 3 4
> dim(x1$[1,,,drop=1])
[1] 3 4
> dim(x2[1,,])
NULL
> dim(x2$[1,,])
[1] 1 1 4
> dim(x2$[1,,,drop=1])
[1] 1 4
>

The ability to simply and robustly manipulate 3-d (and higher dimensional) arrays is probably going to become more important, as cheap computers now have the storage capacity to store in memory large amounts of data that are most naturally represented as higher dimensional arrays.  Quite a lot of financial data is like this, and I would guess that some biological data is also like this.

It would also be relatively easy to provide some quality-control tools that helped users consistently use more robust subsetting patterns (e.g., by prohibiting use of standard subsetting operations in programs, or warning when a standard subsetting operation was used without supplying the drop argument).

Finally, it's worth noting that it would be possible to provide this functionality in other ways, such as with new functions for subsetting, and/or with new arguments and new behaviors for the existing subsetting operators.  However, code written using subsetting functions and/or arguments specifying behavior lacks the conciseness and visual scanability of code written using subsetting operators.  Admittedly, an operator like "$[" does not have quite the same elegance and simplicity as "[", but it is still quick to type and concise on the screen.

-- Tony Plate

tplate@acm.org

From ggrothendieck at myway.com  Tue Oct 28 06:49:33 2003
From: ggrothendieck at myway.com (Gabor Grothendieck)
Date: Tue Oct 28 06:49:51 2003
Subject: [Rd] proposal for 
Message-ID: <20031028054933.87C6A399A@xmxpita.myway.com>



Having written a number of R programs and having been stung with 
this myself, I think this is a very good idea.  In fact, if the 
aim of R is to "to do it right" (as one person on the list claimed) 
rather than be compatible with S-Plus or prior versions of R then 
I would go even further and make all subscripting behave like this.
(If that were to be the way R goes then, of course, some thought 
would be required on how to smoothly transition to it.)

---
Date: Mon, 27 Oct 2003 21:49:44 -0700 
From: Tony Plate <tplate@attglobal.net>
[ Add to Address Book | Block Address | Report as Spam ] 
To: <r-devel@stat.math.ethz.ch> 
Subject: [Rd] proposal for "strict" versions of subsetting operators 

 
 
I'd like to propose adding "strict" versions of the subsetting operators "[", "[[", and "$" to the R language. These strict versions would be intended for use in programming rather than in interactive use. They do not perform any form of partial string matching or opportunistic simplification such as dimension dropping by default. They allow more precise specification of which dimensions to drop, which can be very useful when working with higher-dimensional arrays. The syntax for them can be created by prefixing the existing subsetting operators with some single character such as "$", e.g.: x$[i, j], x$[[i]], and x$$component. Such syntax would be an addition to the existing syntax and would not cause any existing code to behave differently.

I've created a set of patches that implement and test this syntax addition for R-1.8.0. They can be downloaded from http://pws.prserv.net/tap/software/strict-subset-R.1.8.0.zip. These patches implement these strict subsetting operators for vectors, lists and arrays, with the following semantics:

(1) The drop argument can be logical or numeric, and the default is F. If drop is requested, is non-optional (it is an error to request to drop a dimension that is not droppable). Numeric values for drop, or logical vector values with length greater than one can be used to specify exactly which dimensions to drop. This is very useful when working with arrays with 3 dimensions or more.
(2) no partial string matching (currently in R, partial string matching is used only for list components and for data frame row indexing)

I've not supplied any documentation is this patch, but if there is any interest in incorporating something like this into the R language, I'd be happy to supply some documentation. I've also not carefully debugged these patches -- they were intended to test the concept, and they seem to work. Again, if there is any real interest, I can look over them more carefully and test them more comprehensively.

What follows in this email is some discussion and rational for this addition.

The drop=T default for subsetting tends to catch both new and experienced users. It generally gives users what they want (at least with matrices). However, it surprises new users when they don't get what they want, and it fools experienced users because they forget or are too lazy to specify non-default behavior (i.e., drop=F) and they fail to detect this omission because their test cases don't create a situation in which the need for non-default behavior is apparent.

Having a different set of strict subsetting operators might relieve some of the long-standing tension between having subsetting operators support robust programming and making subsetting operators convenient for interactive and common uses (by performing opportunistic simplification, as they currently do). The following two excerpts demonstrate this tension.

The R FAQ says:
>7.7 Why do my matrices lose dimensions?
>... After much discussion this has been determined to be a feature. ...
>... The drop = FALSE option should be used defensively when programming. ...

Bill Venables (William.Venables@cmis.CSIRO.AU) wrote in an email on an R mailing list on Mon, 15 Nov 1999:

>Re: [R] dimnames
>
>[material explaining the drop=T default for subsetting deleted]
>
>I can't help feeling that this convention, helpful as it might be
>in interactive work, is a bit of a mistake. It second-guesses
>what you mean rather than what you actually program. In that
>respect it is for me an uncomfortable reminder of the sort of
>thing that goes on in much MicroSoft software...

There are at least three ways in which having a set of strict subsetting operators could make R programs more robust and simpler:

(1) Users can make the own programs more robust by consistently using the strict subsetting operators (except when they really want opportunistic simplification).
(2) If a package writer adopts use of the strict subsetting operators, users can have a higher level of confidence that the functions in the package will correctly handle all data presented to them.
(3) Users can more easily work with higher dimensional arrays. Currently it is requires somewhat cumbersome expressions, or custom functions to, for example, extract a m x k matrix from a n x m x k array (because if one relies on the default in an expression like x[i, , ], a vector will result if m or k happen to be 1, and if one uses x[i, , ,drop=F], then one must explicitly manipulate the dim attribute to get a matrix.)
Here is a brief transcript showing the more easily predicted behavior of the "$[" operator on a 3-d array from which a matrix "slice" is being extracted. In one case (x1) the slice has both dimensions with length > 1, in the other case (x2), the slice has one dimension of length 1.

> x1 <- array(1:24, dim=c(2,3,4), dimnames=list(LETTERS[25:26],letters[1:3],LETTERS[1:4]))
> x2 <- x1$[,1,]
> dim(x1)
[1] 2 3 4
> dim(x2)
[1] 2 1 4
> dim(x1[1,,])
[1] 3 4
> dim(x1$[1,,])
[1] 1 3 4
> dim(x1$[1,,,drop=1])
[1] 3 4
> dim(x2[1,,])
NULL
> dim(x2$[1,,])
[1] 1 1 4
> dim(x2$[1,,,drop=1])
[1] 1 4
>

The ability to simply and robustly manipulate 3-d (and higher dimensional) arrays is probably going to become more important, as cheap computers now have the storage capacity to store in memory large amounts of data that are most naturally represented as higher dimensional arrays. Quite a lot of financial data is like this, and I would guess that some biological data is also like this.

It would also be relatively easy to provide some quality-control tools that helped users consistently use more robust subsetting patterns (e.g., by prohibiting use of standard subsetting operations in programs, or warning when a standard subsetting operation was used without supplying the drop argument).

Finally, it's worth noting that it would be possible to provide this functionality in other ways, such as with new functions for subsetting, and/or with new arguments and new behaviors for the existing subsetting operators. However, code written using subsetting functions and/or arguments specifying behavior lacks the conciseness and visual scanability of code written using subsetting operators. Admittedly, an operator like "$[" does not have quite the same elegance and simplicity as "[", but it is still quick to type and concise on the screen.

-- Tony Plate

tplate@acm.org

______________________________________________
R-devel@stat.math.ethz.ch mailing list
https://www.stat.math.ethz.ch/mailman/listinfo/r-devel



_______________________________________________
No banners. No pop-ups. No kidding.
Introducing My Way - http://www.myway.com

From Mark.Bravington at csiro.au  Tue Oct 28 07:29:37 2003
From: Mark.Bravington at csiro.au (Mark.Bravington@csiro.au)
Date: Tue Oct 28 07:28:36 2003
Subject: [Rd] data.frame replacement (PR#4820)
Message-ID: <200310280629.h9S6Tb0P016999@pubhealth.ku.dk>

When replacing all elements of a column in a data.frame, a corrupt data.frame will be generated if the replacer is "short":

test> bbb <- data.frame( x=1:2)
test> bbb[,'x'] <- 3 # should fill the column
test> bbb
     x
1    3
2 <NA>
Warning message: 
corrupt data frame: columns will be truncated or padded with NAs in: format.data.frame(x, digits = digits) 
test> bbb$x
[1] 2

This works OK in R 1.7.1 and also for matrices in R 1.8. Although there have been a number of deliberate changes to data.frame subscripting in R 1.8, I suspect this one isn't intentional!

NB still happens in 1.8.1 alpha

Mark

*******************************

Mark Bravington
CSIRO (CMIS)
PO Box 1538
Castray Esplanade
Hobart
TAS 7001

phone (61) 3 6232 5118
fax (61) 3 6232 5012
Mark.Bravington@csiro.au 

--please do not edit the information below--

Version:
 platform = i386-pc-mingw32
 arch = i386
 os = mingw32
 system = i386, mingw32
 status = 
 major = 1
 minor = 8.0
 year = 2003
 month = 10
 day = 08
 language = R

Windows 2000 Professional (build 2195) Service Pack 4.0

Search Path:
 .GlobalEnv, ROOT, package:lattice, package:methods, package:ctest, package:mva, package:modreg, package:nls, package:ts, package:handy, package:debug, mvb.session.info, package:mvbutils, package:tcltk, Autoloads, package:base

From bolker at zoo.ufl.edu  Tue Oct 28 17:51:40 2003
From: bolker at zoo.ufl.edu (Ben Bolker)
Date: Tue Oct 28 17:37:46 2003
Subject: [Rd] proposal for "strict" versions of subsetting operators
In-Reply-To: <5.1.0.14.2.20031027213400.00a99a70@pop6.attglobal.net>
Message-ID: <Pine.LNX.4.44.0310281146280.25187-100000@bolker.zoo.ufl.edu>


  On a related topic: is there any chance/any interest in a slight 
modification of the subsetting code that would generate a warning when the 
user tried to subset with a non-integer?  The current behavior is that the 
non-integer is coerced to an integer, which means that e.g. x[3.8] is 
equivalent to x[3].  I can't think of (or find in the documentation) any 
time when this would actually be a desired behavior.
  The only integer-testing behavior that I can find in the code base is in 
some of the discrete-distribution code ...
  I might be able to hack this myself -- it looks as though ExtractSubset 
in subset.c might be the place to do this ...

   Ben Bolker


-- 
620B Bartram Hall                            bolker@zoo.ufl.edu
Zoology Department, University of Florida    http://www.zoo.ufl.edu/bolker
Box 118525                                   (ph)  352-392-5697
Gainesville, FL 32611-8525                   (fax) 352-392-3704

From brahm at alum.mit.edu  Tue Oct 28 17:42:16 2003
From: brahm at alum.mit.edu (David Brahm)
Date: Tue Oct 28 17:41:57 2003
Subject: [Rd] proposal for "strict" versions of subsetting operators
References: <5.1.0.14.2.20031027213400.00a99a70@pop6.attglobal.net>
Message-ID: <16286.40040.282076.752071@arbres1a.fmr.com>

Tony Plate <tplate@attglobal.net> wrote:
> I'd like to propose adding "strict" versions of the subsetting operators "[",
> "[[", and "$" to the R language.

Interesting idea, Tony!  I think you're addressing 3 somewhat distinct
problems; here's how I deal with them currently:

1) Partial string matching: don't use it, isn't a problem for me.

2) drop=T default: In production code, I try to remember to set drop=F (just as
   I would have to remember to use "$[" under your scheme).  Admittedly I have
   been tripped up a few times.

3) Selective dropping: I have the function g.slice (below).  On 8/23/00 I
   proposed to S-news that drop= could be a logical vector argument, recycled
   as necessary, so that "drop=T" (the default) or "drop=F" are still valid,
   and no code would break.  If I were slightly smarter, I might even know how
   to make g.slice be my array method for "[".

   g.slice <- function(a, ..., drop=TRUE, use.names=TRUE) {
     b <- a[..., drop=FALSE]               # Drop dimensions selectively
     drop <- drop & dim(b)==1              # Recycles "drop" if necessary
     dn <- dimnames(b)
     dimnames(b) <- NULL
     if (sum(!drop) < 2) {                 # Create a vector (or scalar)
       dim(b) <- NULL
       if (use.names) names(b) <- unlist(dn[!drop])
     } else {                              # Create an array
       dim(b) <- dim(b)[!drop]
       if (use.names) dimnames(b) <- dn[!drop]
     }
     b
   }

> Finally, it's worth noting that it would be possible to provide this
> functionality in other ways...  However, code written using subsetting
> functions and/or arguments specifying behavior lacks the conciseness and
> visual scanability of code written using subsetting operators.

At least the selective dropping option (point 3) could be incorporated under
current syntax, fully backward compatible, similar to your version.
-- 
                              -- David Brahm (brahm@alum.mit.edu)

From ripley at stats.ox.ac.uk  Tue Oct 28 18:25:26 2003
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue Oct 28 18:24:33 2003
Subject: [Rd] proposal for "strict" versions of subsetting operators
In-Reply-To: <Pine.LNX.4.44.0310281146280.25187-100000@bolker.zoo.ufl.edu>
Message-ID: <Pine.LNX.4.44.0310281722150.9637-100000@gannet.stats>

You would need at least a fuzz for computed indices being slightly 
non-integer (although the calling code should do that).

I can think of several cases where the implicit floor() is convenient.
Can you tell me of examples where users would do this by accident (or out 
of non-RTFM)?

On Tue, 28 Oct 2003, Ben Bolker wrote:

> 
>   On a related topic: is there any chance/any interest in a slight 
> modification of the subsetting code that would generate a warning when the 
> user tried to subset with a non-integer?  The current behavior is that the 
> non-integer is coerced to an integer, which means that e.g. x[3.8] is 
> equivalent to x[3].  I can't think of (or find in the documentation) any 
> time when this would actually be a desired behavior.
>   The only integer-testing behavior that I can find in the code base is in 
> some of the discrete-distribution code ...

Yes, but then they are documented that way, and selection is documented to 
do as.integer().

>   I might be able to hack this myself -- it looks as though ExtractSubset 
> in subset.c might be the place to do this ...
> 
>    Ben Bolker
> 
> 
> 

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From tplate at blackmesacapital.com  Tue Oct 28 18:37:54 2003
From: tplate at blackmesacapital.com (Tony Plate)
Date: Tue Oct 28 18:37:48 2003
Subject: [Rd] proposal for "strict" versions of subsetting operators
In-Reply-To: <20031028054933.87C6A399A@xmxpita.myway.com>
Message-ID: <5.2.1.1.2.20031028103202.041383f0@mailhost.blackmesacapital.com>

I suspect that it would break too much existing code to make all 
subscripting behave in a "strict" manner.  However, I wonder if it would be 
possible to use namespaces and packages to make a particular package get 
strict versions of subscripting operators?  It would have to be done in 
such a way that functions called in a different package would use the 
appropriate subscripting behavior for their package.  This might be a way 
to manage a transition to strict subscripting.  However, I suspect that 
this would all be extremely confusing to users.

-- Tony Plate

At Tuesday 12:49 AM 10/28/2003 -0500, Gabor Grothendieck wrote:

>Having written a number of R programs and having been stung with
>this myself, I think this is a very good idea.  In fact, if the
>aim of R is to "to do it right" (as one person on the list claimed)
>rather than be compatible with S-Plus or prior versions of R then
>I would go even further and make all subscripting behave like this.
>(If that were to be the way R goes then, of course, some thought
>would be required on how to smoothly transition to it.)

From rpeng at jhsph.edu  Tue Oct 28 19:20:49 2003
From: rpeng at jhsph.edu (Roger D. Peng)
Date: Tue Oct 28 19:23:43 2003
Subject: [Rd] no traceback in R-patched
Message-ID: <3F9EB381.6010009@jhsph.edu>

Has something changed with traceback's in R-patched?  When I running the 
examples for ?traceback, I get

>      foo <- function(x) { print(1); bar(2) }
>      bar <- function(x) { x + a.variable.which.does.not.exist }
>     foo(2) # gives a strange error
[1] 1
Error in bar(2) : Object "a.variable.which.does.not.exist" not found
>  traceback()
No traceback available
>

It seems the .Traceback variable is never created.

>  version
         _               
platform i686-pc-linux-gnu
arch     i686            
os       linux-gnu       
system   i686, linux-gnu 
status   alpha           
major    1               
minor    8.1             
year     2003            
month    10              
day      28              
language R               

-roger

From Kurt.Hornik at wu-wien.ac.at  Tue Oct 28 19:35:54 2003
From: Kurt.Hornik at wu-wien.ac.at (Kurt Hornik)
Date: Tue Oct 28 19:37:38 2003
Subject: [Rd] configure, config.site and TCLTK_CPPFLAGS
In-Reply-To: <Pine.LNX.4.44.0310280025530.9636-100000@kleigh.nl>
References: <16285.32494.170709.639084@mithrandir.hornik.net>
	<Pine.LNX.4.44.0310280025530.9636-100000@kleigh.nl>
Message-ID: <16286.46858.600817.644383@mithrandir.hornik.net>

>>>>> Peter Kleiweg writes:

> # aldus Kurt Hornik :
>> > I am trying to configure R-1.8.0-patched (fresh rsync) for machines
>> > with the tcltk files in unorthodox locations. I specified a
>> > TCLTK_CPPFLAGS='/usr/freeware/include/' in the file config.site but it
>> > seems that a '# no special path needed' is added when running
>> > configure, causing trouble (See the excerpt from config.site below).
>> > This was working with R-1.7.1. I am not an autoconf/configure expert,
>> > so any hint is welcome.
>> 
>> Could the "no special path needed" comment be something you added in one
>> of your config files?  I cannot seem to find it in the R sources ...

> See PR#1500

Thanks.

I looked into this a bit more.  Seems that Tcl/Tk 8.4 has gotten rid of
these "comments", the Tcl ChangeLog has

2002-07-23  Mo DeJong  <mdejong@users.sourceforge.net>

        * unix/tcl.m4 (SC_PATH_X): Set XINCLUDES to "" instead
        of "# no special path needed" or "# no include files found"
        when x headers cannot be located.

It also seems that the problem is with TK_XINCLUDES only.

Our current Autoconf code in m4/R.m4 does

  if test -n "${TK_XINCLUDES}"; then
    TCLTK_CPPFLAGS="${TCLTK_CPPFLAGS} ${TK_XINCLUDES}"
  else
    TCLTK_CPPFLAGS="${TCLTK_CPPFLAGS} ${X_CFLAGS}"
  fi

so we could do something like

  if test -n "${TK_XINCLUDES}"; then
    case ${TK_XINCLUDES} in
      #*) ;;
      *) TCLTK_CPPFLAGS="${TCLTK_CPPFLAGS} ${TK_XINCLUDES}" ;;
    esac
  else
    TCLTK_CPPFLAGS="${TCLTK_CPPFLAGS} ${X_CFLAGS}"
  fi

Untested: can anyone pls try this change?

Thanks
-k

From bolker at zoo.ufl.edu  Tue Oct 28 20:40:49 2003
From: bolker at zoo.ufl.edu (Ben Bolker)
Date: Tue Oct 28 20:26:51 2003
Subject: [Rd] proposal for "strict" versions of subsetting operators
In-Reply-To: <Pine.LNX.4.44.0310281722150.9637-100000@gannet.stats>
Message-ID: <Pine.LNX.4.44.0310281428550.25441-100000@bolker.zoo.ufl.edu>

 
  You may think this is ridiculous, but here's the situation I'm thinking
about.

  Students are trying (e.g.) to evaluate a likelihood for a series of 
parameter values, and want to store the results in a vector, e.g.:

pvec = seq(0,10,by=0.1)
likvec = numeric(length(pvec))

  They try something like

for (p in pvec) {
   likvec[p] = likfun(p)
}

rather than

for (pctr in 1:length(pvec)) {
   p = pvec[pctr]; likvec[pctr] = likfun(p)
}

I am perfectly aware that they could just do sapply(pvec,likvec) instead,
and that they will be in trouble with other parameter vectors like
seq(1,100,by=4) which will not put the answers where they want them.  
Nevertheless, this is a trap my students fall into.

  I can imagine that implicit floor() is convenient, which is why I was
suggesting this "feature" as an option, FALSE by default -- similar to the
check.bounds option.

  Ben Bolker

On Tue, 28 Oct 2003, Prof Brian Ripley wrote:

> You would need at least a fuzz for computed indices being slightly 
> non-integer (although the calling code should do that).
> 
> I can think of several cases where the implicit floor() is convenient.
> Can you tell me of examples where users would do this by accident (or out 
> of non-RTFM)?
> 
> On Tue, 28 Oct 2003, Ben Bolker wrote:
> 
> > 
> >   On a related topic: is there any chance/any interest in a slight 
> > modification of the subsetting code that would generate a warning when the 
> > user tried to subset with a non-integer?  The current behavior is that the 
> > non-integer is coerced to an integer, which means that e.g. x[3.8] is 
> > equivalent to x[3].  I can't think of (or find in the documentation) any 
> > time when this would actually be a desired behavior.
> >   The only integer-testing behavior that I can find in the code base is in 
> > some of the discrete-distribution code ...
> 
> Yes, but then they are documented that way, and selection is documented to 
> do as.integer().
> 
> >   I might be able to hack this myself -- it looks as though ExtractSubset 
> > in subset.c might be the place to do this ...
> > 
> >    Ben Bolker
> > 
> > 
> > 
> 
> 

-- 
620B Bartram Hall                            bolker@zoo.ufl.edu
Zoology Department, University of Florida    http://www.zoo.ufl.edu/bolker
Box 118525                                   (ph)  352-392-5697
Gainesville, FL 32611-8525                   (fax) 352-392-3704

From htang at hpl.hp.com  Wed Oct 29 01:54:52 2003
From: htang at hpl.hp.com (htang@hpl.hp.com)
Date: Wed Oct 29 01:53:53 2003
Subject: [Rd] Wishlist: user-specified color names for palette() (PR#4836)
Message-ID: <200310290054.h9T0sq0P001792@pubhealth.ku.dk>

Full_Name: Hsiu-Khuern Tang
Version: 1.8.0
OS: GNU/Linux (Debian unstable)
Submission from: (NULL) (156.153.255.243)


Hi,

   I use palette(rgb(red=..., green=..., blue=..., names=mycolors)) to define my
own color palette.  After doing this, the names `mycolors' are not stored in
palette() anymore, so that palette() returns a mix of built-in color names and
RGB values.

Eg:
> palette()
 [1] "black"   "#EAA200" "#FF6633" "gray60"

I wish that palette() would return a _named vector_ like this:

> palette()
    black    orange    tomato      gray 
  "#000000" "#EAA200" "#FF6633"  "#999999" 

One application:

I want to specify colors by name, where the names returned by palette() are
searched first.  If there is a match, the corresponding RGB value is used;
otherwise the built-in R color is used.

Best,
Hsiu-Khuern Tang.

From Tim.Keighley at csiro.au  Wed Oct 29 02:05:28 2003
From: Tim.Keighley at csiro.au (Tim.Keighley@csiro.au)
Date: Wed Oct 29 02:04:23 2003
Subject: [Rd] Rdconv Rd->Ssgm doesn't convert aliases (PR#4838)
Message-ID: <200310290105.h9T15S0P001868@pubhealth.ku.dk>

Hi,

When using Rdconv to convert R documentation to S-PLUS SGML documentation,
the \name{} is converted to <s-topic> but the \alias{}es are not. Below is a
(crude) patch to fix this problem:

Compare: (<)D:\Apps\R\R-1.8.0\share\perl\R\Rdconv.pm.orig (88302 bytes)
   with: (>)D:\Apps\R\R-1.8.0\share\perl\R\Rdconv.pm (88481 bytes)

3188c3188,3197
<     $retval .= "<s-topics>\n
<s-topic>".$name."</s-topic>\n</s-topics>\n\n";
---
> 
>     $retval .= "<s-topics>\n  <s-topic>" . $name . "</s-topic>\n";
> 
>     my $alias;
>     for $alias (@aliases) {
>         next if ($alias eq $name);
>         $retval .= "  <s-topic>" . $alias . "</s-topic>\n";
>     }
>     $retval .= "</s-topics>\n\n";
> 

Note, this relies on the global variable @aliases. Perhaps this code should
be modified so that @aliases is passed into the Ssgm_functionhead function
as an argument.

I have not tested this extensively but it seems to work on the few small
tests I have done.

For the record I am using:

platform i386-pc-mingw32
arch     i386
os       mingw32
system   i386, mingw32
status
major    1
minor    8.0
year     2003
month    10
day      08
language R

Cheers,
Tim Keighley

PS. Please let me know if this is not the correct forum or format for this
type of report, or if you need any more information.

	[[alternative HTML version deleted]]

From Yongchao.Ge at mssm.edu  Wed Oct 29 06:33:58 2003
From: Yongchao.Ge at mssm.edu (Yongchao.Ge@mssm.edu)
Date: Wed Oct 29 06:33:44 2003
Subject: [Rd] R installation problems on Windows XP (PR#4842)
Message-ID: <200310290533.h9T5Xw0P002862@pubhealth.ku.dk>

Full_Name: Yongchao Ge
Version: 1.8
OS: Windows XP profesional
Submission from: (NULL) (146.203.2.152)


The R installation is fine on Windows XP, but when I started to open the R
program, then it pops out this message:

"R for Windows GUI front-end has encountered a problem and needs to close.  We
are sorry for the inconvenience....."

The error signature is:

AppName: rgui.exe	 AppVer: 1.71.30616.0	 ModName: r.dll
ModVer: 1.71.30616.0	 Offset: 0002966e


I have to say that I just bought a brand new Dell computer. Windows XP was just
installed fresh. I installed other softwares and also update the video card
driver from nvidia website. The model is dimension 8300.

I checked the old messages on the R project. It seems one person also had a
similar problem. Check the message with the subject
"Rd] R for Windows GUI Front-End Problem (PR#3364)"

However, I don't think somebody solved this problem. I also tried to install
R1.7, I still have the same problems. I'm not sure the monitor is one cause of
the problem since I'm using a high resolution 1600x1200 20inch LCD with DVI-D
connector to the computer.

However I want to mention that I used the R source code on the same computer but
on the red hat linux 8.0 partition (note that my computer has dual boot
systems). The R worked fine. 

I'm not sure if recomipling R source code for window XP will work. if you have
suggestions to make R work on Windows XP, it will be much appreciated.

From ripley at stats.ox.ac.uk  Wed Oct 29 12:24:34 2003
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed Oct 29 12:23:50 2003
Subject: [Rd] R installation problems on Windows XP (PR#4842)
In-Reply-To: <200310290533.h9T5Xw0P002862@pubhealth.ku.dk>
Message-ID: <Pine.LNX.4.44.0310291115570.22220-100000@gannet.stats>

That error message came from R 1.7.1, not R 1.8.0 (there is no 1.8).
There is a reply to PR#3364 on R-bugs, and you seem not to have followed 
the advice there.  Several such problems have been solved by reinstalling 
the OS and thereby removing rogue software.

On Wed, 29 Oct 2003 Yongchao.Ge@mssm.edu wrote:

> Full_Name: Yongchao Ge
> Version: 1.8
> OS: Windows XP profesional
> Submission from: (NULL) (146.203.2.152)
> 
> 
> The R installation is fine on Windows XP, but when I started to open the R
> program, then it pops out this message:
> 
> "R for Windows GUI front-end has encountered a problem and needs to close.  We
> are sorry for the inconvenience....."
> 
> The error signature is:
> 
> AppName: rgui.exe	 AppVer: 1.71.30616.0	 ModName: r.dll
> ModVer: 1.71.30616.0	 Offset: 0002966e
> 
> 
> I have to say that I just bought a brand new Dell computer. Windows XP was just
> installed fresh. I installed other softwares and also update the video card
> driver from nvidia website. The model is dimension 8300.
> 
> I checked the old messages on the R project. It seems one person also had a
> similar problem. Check the message with the subject
> "Rd] R for Windows GUI Front-End Problem (PR#3364)"
> 
> However, I don't think somebody solved this problem. 

Have you read the reply to that item?

> I also tried to install
> R1.7, I still have the same problems. I'm not sure the monitor is one cause of
> the problem since I'm using a high resolution 1600x1200 20inch LCD with DVI-D
> connector to the computer.
> 
> However I want to mention that I used the R source code on the same computer but
> on the red hat linux 8.0 partition (note that my computer has dual boot
> systems). The R worked fine. 
> 
> I'm not sure if recomipling R source code for window XP will work. if you have
> suggestions to make R work on Windows XP, it will be much appreciated.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From ggrothendieck at myway.com  Wed Oct 29 14:48:52 2003
From: ggrothendieck at myway.com (Gabor Grothendieck)
Date: Wed Oct 29 14:48:49 2003
Subject: [Rd] Wishlist: user-specified color names for palette() (PR#4836)
Message-ID: <20031029134852.91150396D@xmxpita.myway.com>



Provided you are willing to only use colors in the vector returned
by colors() then this function would do it for you:


colors.names <- function( x ) { 
   color.name <- function( x ) 
      ifelse(substr(x,1,1) == "#", colors()[ match( x, colors.hex() ) ], x )
   z <- sapply( x, color.name ) 
   ifelse(is.na(z), x, z)
}

where colors.hex is defined here:

   http://maths.newcastle.edu.au/~rking/R/help/03a/7417.html


e.g.

colors.names( c("red", "#FF00FF", "blue") )

---

To: <r-devel@stat.math.ethz.ch> 
Cc: <R-bugs@biostat.ku.dk> 
Subject: [Rd] Wishlist: user-specified color names for palette() (PR#4836) 

 
 
Full_Name: Hsiu-Khuern Tang
Version: 1.8.0
OS: GNU/Linux (Debian unstable)
Submission from: (NULL) (156.153.255.243)


Hi,

I use palette(rgb(red=..., green=..., blue=..., names=mycolors)) to define my
own color palette. After doing this, the names `mycolors' are not stored in
palette() anymore, so that palette() returns a mix of built-in color names and
RGB values.

Eg:
> palette()
[1] "black" "#EAA200" "#FF6633" "gray60"

I wish that palette() would return a _named vector_ like this:

> palette()
black orange tomato gray 
"#000000" "#EAA200" "#FF6633" "#999999" 

One application:

I want to specify colors by name, where the names returned by palette() are
searched first. If there is a match, the corresponding RGB value is used;
otherwise the built-in R color is used.

Best,
Hsiu-Khuern Tang.

______________________________________________

  
 

        

_______________________________________________
No banners. No pop-ups. No kidding.
Introducing My Way - http://www.myway.com

From Yongchao.Ge at mssm.edu  Wed Oct 29 15:27:20 2003
From: Yongchao.Ge at mssm.edu (Yongchao Ge)
Date: Wed Oct 29 15:35:10 2003
Subject: [Rd] R installation problems on Windows XP (PR#4842)
In-Reply-To: <Pine.LNX.4.44.0310291115570.22220-100000@gannet.stats>
Message-ID: <Pine.LNX.4.44.0310290911500.3193-100000@ge.biomath.mssm.edu>

Hi Prof. Ripley,

I'm sorry. The error message in the previous email was from R1.7.1, but 
for R1.8, it still had the same problem. Sorry for the confusion since I 
tested both versions and copied and pasted the wrong version.

Yes, I did read the bug message 3364 and your reply to that message. But I 
didn't see any further feedback of this message from the user as I need to 
consider the time I'm going to spend reinstalling the OS and all other 
softwares. It's about several day's full time job work. In that message, 
you said the video driver or utility might cause problems. I guess I may 
have to remove the utility and video and reinstall to see if it works.

Thank you!


Yongchao


On Wed, 29 Oct 2003, Prof Brian Ripley wrote:

> That error message came from R 1.7.1, not R 1.8.0 (there is no 1.8).
> There is a reply to PR#3364 on R-bugs, and you seem not to have followed 
> the advice there.  Several such problems have been solved by reinstalling 
> the OS and thereby removing rogue software.
> 
> On Wed, 29 Oct 2003 Yongchao.Ge@mssm.edu wrote:
> 
> > Full_Name: Yongchao Ge
> > Version: 1.8
> > OS: Windows XP profesional
> > Submission from: (NULL) (146.203.2.152)
> > 
> > 
> > The R installation is fine on Windows XP, but when I started to open the R
> > program, then it pops out this message:
> > 
> > "R for Windows GUI front-end has encountered a problem and needs to close.  We
> > are sorry for the inconvenience....."
> > 
> > The error signature is:
> > 
> > AppName: rgui.exe	 AppVer: 1.71.30616.0	 ModName: r.dll
> > ModVer: 1.71.30616.0	 Offset: 0002966e
> > 
> > 
> > I have to say that I just bought a brand new Dell computer. Windows XP was just
> > installed fresh. I installed other softwares and also update the video card
> > driver from nvidia website. The model is dimension 8300.
> > 
> > I checked the old messages on the R project. It seems one person also had a
> > similar problem. Check the message with the subject
> > "Rd] R for Windows GUI Front-End Problem (PR#3364)"
> > 
> > However, I don't think somebody solved this problem. 
> 
> Have you read the reply to that item?
> 
> > I also tried to install
> > R1.7, I still have the same problems. I'm not sure the monitor is one cause of
> > the problem since I'm using a high resolution 1600x1200 20inch LCD with DVI-D
> > connector to the computer.
> > 
> > However I want to mention that I used the R source code on the same computer but
> > on the red hat linux 8.0 partition (note that my computer has dual boot
> > systems). The R worked fine. 
> > 
> > I'm not sure if recomipling R source code for window XP will work. if you have
> > suggestions to make R work on Windows XP, it will be much appreciated.
> 
> 

-- 
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Yongchao Ge                                  Yongchao.Ge@mssm.edu
Mount Sinai School of Medicine               office: 212-241-2821
Dept. of Biomathematical Sciences            fax:    212-860-4630 
One Gustave L. Levy Place, Box 1023,     New York, NY, 10029, USA
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

From dmurdoch at pair.com  Thu Oct 30 05:01:42 2003
From: dmurdoch at pair.com (Duncan Murdoch)
Date: Thu Oct 30 05:00:29 2003
Subject: [Rd] R installation problems on Windows XP (PR#4842)
In-Reply-To: <Pine.LNX.4.44.0310290911500.3193-100000@ge.biomath.mssm.edu>
References: <Pine.LNX.4.44.0310291115570.22220-100000@gannet.stats>
	<Pine.LNX.4.44.0310290911500.3193-100000@ge.biomath.mssm.edu>
Message-ID: <9s21qvk5lvjjbf8j4h6l2mo7jsrfg3osuh@4ax.com>

On Wed, 29 Oct 2003 09:27:20 -0500 (EST), you wrote:

>Hi Prof. Ripley,
>
>I'm sorry. The error message in the previous email was from R1.7.1, but 
>for R1.8, it still had the same problem. Sorry for the confusion since I 
>tested both versions and copied and pasted the wrong version.
>
>Yes, I did read the bug message 3364 and your reply to that message. But I 
>didn't see any further feedback of this message from the user as I need to 
>consider the time I'm going to spend reinstalling the OS and all other 
>softwares. It's about several day's full time job work. In that message, 
>you said the video driver or utility might cause problems. I guess I may 
>have to remove the utility and video and reinstall to see if it works.

My guess would be that it's either the video driver or the currently
installed version of msvcrt.dll.  I'd try those first.  We've also had
problems with keyboard utilities (I don't know what they did; they
might be for recording macros?)

Unfortunately, your problem is very rare, and you're the only one who
really has any chance of diagnosing it.  It may indeed be time
consuming.  

Duncan Murdoch

From jago at mclink.it  Thu Oct 30 12:14:18 2003
From: jago at mclink.it (Stefano Iacus)
Date: Thu Oct 30 13:47:16 2003
Subject: [Rd] RAqua and AquaTclTk
Message-ID: <340FF848-0ACA-11D8-B185-003065CC4CB8@mclink.it>

While playing around with panther I discovered (with surprise) that 
tcltk seems to work (even if not smoothly) with RAqua without first 
calling tkStartGUI.

I switched back to 10.2.6 and it works as well.
I think this is due to the "last minute" fix in RAqua now using idle 
timers because of too much cpu usage.

Some "mouse" trick is needed though. If you want to test it you can 
just try

library(tcltk)
demo(tkdensity)

press return and wait for quartz device to show the density plot.
Then to interact with the widgets just click outside R (everywhere but 
not windows related to R) and click on the tk-window to activate it. 
Now you can interact with the widgets for "some time", which means that 
after a while you loose the control and you need to re-do the trick 
(click outside R and reactivate the tk window).

BTW, doing this (which is far from being even suboptimal) you loose 
RAqua menus.

I think RAqua menus should be reestablished if I force the redrawing 
after every activation of the RAqua Console window.
The other problem (loose of control of tk window) seems to come from 
the bliking cursor on the RAqua Console.

I'll try to change/fix the last two points in R-patched and update you 
on this history.

Of course if you have other ideas in the meanwhile let me know.


stefano

From nakama at ki.rim.or.jp  Thu Oct 30 15:15:08 2003
From: nakama at ki.rim.or.jp (nakama@ki.rim.or.jp)
Date: Thu Oct 30 15:14:05 2003
Subject: [Rd] dataentry.c ESC key overrun. (PR#4865)
Message-ID: <200310301415.h9UEF80P027676@pubhealth.ku.dk>

Full_Name: 
Version: R-1.8.0
OS: linux
Submission from: (NULL) (219.117.236.5)


bufp is not reset.

src/modules/X11/dataentry.c
----------------------------------------------------
 static void handlechar(char *text)
 {
     int c = text[0];

     if ( c == '\033' ) {
         CellModified = FALSE;
         clength = 0;
+        bufp = buf;
         drawelt(crow, ccol);
         return;
     } else

From maechler at stat.math.ethz.ch  Thu Oct 30 15:40:39 2003
From: maechler at stat.math.ethz.ch (maechler@stat.math.ethz.ch)
Date: Thu Oct 30 15:39:42 2003
Subject: [Rd] dist() objects with NA's don't print them (PR#4866)
Message-ID: <200310301440.h9UEed0P028152@pubhealth.ku.dk>

The print.dist() method in the mva package currently prints the
triangular distance matrices with the ``trick'' of setting the
(diagonal and) upper triangular part to NA, and then uses
print(mat, na = "") to print that matrix.
This is very much undesired if there are true NAs.

Reproducible example code:

(x <- cbind(c(1,NA,2,3), c(NA,2,NA,1)))
(d <- dist(x)) ## does not show the NAs
as.matrix(d)   ## now you see them

-- Transcript :

> (x <- cbind(c(1,NA,2,3), c(NA,2,NA,1)))
     [,1] [,2]
[1,]    1   NA
[2,]   NA    2
[3,]    2   NA
[4,]    3    1

> (d <- dist(x)) ## does not show the NAs

         1        2        3
2                           
3 1.414214                  
4 2.828427 1.414214 1.414214

> as.matrix(d)   ## now you see them
         1        2        3        4
1 0.000000       NA 1.414214 2.828427
2       NA 0.000000       NA 1.414214
3 1.414214       NA 0.000000 1.414214
4 2.828427 1.414214 1.414214 0.000000
> 

---------

The fix is to rewrite print.dist() by not using the above trick 
-- which I have almost finished and will commit to  R-patched.

Martin Maechler <maechler@stat.math.ethz.ch>	http://stat.ethz.ch/~maechler/
Seminar fuer Statistik, ETH-Zentrum  LEO C16	Leonhardstr. 27
ETH (Federal Inst. Technology)	8092 Zurich	SWITZERLAND
phone: x-41-1-632-3408		fax: ...-1228			<><

From p.dalgaard at biostat.ku.dk  Thu Oct 30 17:54:01 2003
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Thu Oct 30 17:49:17 2003
Subject: [Rd] RAqua and AquaTclTk
In-Reply-To: <340FF848-0ACA-11D8-B185-003065CC4CB8@mclink.it>
References: <340FF848-0ACA-11D8-B185-003065CC4CB8@mclink.it>
Message-ID: <x2oevyacpi.fsf@biostat.ku.dk>

Stefano Iacus <jago@mclink.it> writes:

> While playing around with panther I discovered (with surprise) that
> tcltk seems to work (even if not smoothly) with RAqua without first
> calling tkStartGUI.
> 
> I switched back to 10.2.6 and it works as well.
> I think this is due to the "last minute" fix in RAqua now using idle
> timers because of too much cpu usage.
> 
> Some "mouse" trick is needed though. If you want to test it you can
> just try
> 
> library(tcltk)
> demo(tkdensity)
> 
> press return and wait for quartz device to show the density plot.
> Then to interact with the widgets just click outside R (everywhere but
> not windows related to R) and click on the tk-window to activate it.
> Now you can interact with the widgets for "some time", which means
> that after a while you loose the control and you need to re-do the
> trick (click outside R and reactivate the tk window).
> 
> BTW, doing this (which is far from being even suboptimal) you loose
> RAqua menus.
> 
> I think RAqua menus should be reestablished if I force the redrawing
> after every activation of the RAqua Console window.
> The other problem (loose of control of tk window) seems to come from
> the bliking cursor on the RAqua Console.
> 
> I'll try to change/fix the last two points in R-patched and update you
> on this history.
> 
> Of course if you have other ideas in the meanwhile let me know.

Stefano, 

I'm not sure I understand the code, but it seems that you're running 
OtherEventLoops in a separate "thread" (or timer)? 

InstallEventLoopTimer(GetMainEventLoop(), 0,
kEventDurationMillisecond*10, NewEventLoopTimerUPP(OtherEventLoops),
NULL, &Inst_OtherEventLoops); 

and it is OtherEventLoops that does 

R_runHandlers(R_InputHandlers, R_checkActivity(0, 1));

If Tcl is among the R_InputHandlers, I think you might want to do this
*only* when idle, to avoid getting a callback interfering with an
executing Tcl command. I.e. perhaps get rid of OtherEventLoops and
move content into RIdleTimer?

Another thing that I suspect you're not handling properly is the
recursive event loop: If you do something like tkwait.variable("foo")
then the tcltk main loop takes over and you need to register an Aqua
event handler for it. Can this be done?

Again, I have zero documentation on how Aqua works and no machine
where it runs, so I could be talking complete rubbish here...

        -p

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From jago at mclink.it  Thu Oct 30 22:45:28 2003
From: jago at mclink.it (Stefano Iacus)
Date: Fri Oct 31 09:00:25 2003
Subject: [Rd] RAqua and AquaTclTk
In-Reply-To: <x2oevyacpi.fsf@biostat.ku.dk>
Message-ID: <609EBBAA-0B22-11D8-B185-003065CC4CB8@mclink.it>


On Gioved?, ott 30, 2003, at 17:54 Europe/Rome, Peter Dalgaard wrote:

> Stefano Iacus <jago@mclink.it> writes:
>
>> While playing around with panther I discovered (with surprise) that
>> tcltk seems to work (even if not smoothly) with RAqua without first
>> calling tkStartGUI.
>>
>> I switched back to 10.2.6 and it works as well.
>> I think this is due to the "last minute" fix in RAqua now using idle
>> timers because of too much cpu usage.
>>
>> Some "mouse" trick is needed though. If you want to test it you can
>> just try
>>
>> library(tcltk)
>> demo(tkdensity)
>>
>> press return and wait for quartz device to show the density plot.
>> Then to interact with the widgets just click outside R (everywhere but
>> not windows related to R) and click on the tk-window to activate it.
>> Now you can interact with the widgets for "some time", which means
>> that after a while you loose the control and you need to re-do the
>> trick (click outside R and reactivate the tk window).
>>
>> BTW, doing this (which is far from being even suboptimal) you loose
>> RAqua menus.
>>
>> I think RAqua menus should be reestablished if I force the redrawing
>> after every activation of the RAqua Console window.
>> The other problem (loose of control of tk window) seems to come from
>> the bliking cursor on the RAqua Console.
>>
>> I'll try to change/fix the last two points in R-patched and update you
>> on this history.
>>
>> Of course if you have other ideas in the meanwhile let me know.
>
> Stefano,
>
> I'm not sure I understand the code, but it seems that you're running
> OtherEventLoops in a separate "thread" (or timer)?

it is not another thread. A timer just fires events to the main 
(carbon) event loop.

>
> InstallEventLoopTimer(GetMainEventLoop(), 0,
> kEventDurationMillisecond*10, NewEventLoopTimerUPP(OtherEventLoops),
> NULL, &Inst_OtherEventLoops);
>
> and it is OtherEventLoops that does
>
> R_runHandlers(R_InputHandlers, R_checkActivity(0, 1));

yes, it is strange as this is needed to interact with X11 windows for 
example

>
> If Tcl is among the R_InputHandlers, I think you might want to do this
> *only* when idle, to avoid getting a callback interfering with an
> executing Tcl command. I.e. perhaps get rid of OtherEventLoops and
> move content into RIdleTimer?
>
I'm not sure. As far as I understand Idle Timers on Carbon, these works 
when the user do not interact with the interface and if I want to 
interact with tkwidgets I think I need to leave the code where it is 
now. I use idle timers to wake up the event loop queue so that when R 
is printing output to the console, the console is refreshed. Otherwise, 
I only see the console refreshed if I do something liek moving the 
mouse, clicking somewhere etc.


> Another thing that I suspect you're not handling properly is the
> recursive event loop: If you do something like tkwait.variable("foo")
> then the tcltk main loop takes over and you need to register an Aqua
> event handler for it. Can this be done?
>

I'm not sure I understand you. Can you drop me a couple of lines of 
code to see what R is expected to do?
I think I can register something if I know how (I think I reasonable 
know the carbon event part, I don't know about the tktcl part of the 
history).


> Again, I have zero documentation on how Aqua works and no machine
> where it runs, so I could be talking complete rubbish here...
>
>         -p
>
> -- 
>    O__  ---- Peter Dalgaard             Blegdamsvej 3
>   c/ /'_ --- Dept. of Biostatistics     2200 Cph. N
>  (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
> ~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
>

From p.dalgaard at biostat.ku.dk  Thu Oct 30 23:16:29 2003
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Fri Oct 31 09:14:00 2003
Subject: [Rd] RAqua and AquaTclTk
In-Reply-To: <609EBBAA-0B22-11D8-B185-003065CC4CB8@mclink.it>
References: <609EBBAA-0B22-11D8-B185-003065CC4CB8@mclink.it>
Message-ID: <x23cdatlqa.fsf@biostat.ku.dk>

Stefano Iacus <jago@mclink.it> writes:

> I'm not sure I understand you. Can you drop me a couple of lines of
> code to see what R is expected to do?
> I think I can register something if I know how (I think I reasonable
> know the carbon event part, I don't know about the tktcl part of the
> history).

The thing is the triplet 

RTcl_setupProc
RTcl_eventProc
RTcl_checkProc

and subsequently

Tcl_CreateEventSource(RTcl_setupProc, RTcl_checkProc, 0);

in .../tcltk/src/tcltk.c

They currently call R_checkActivity, which on X11 returns a set of
file descriptors and then R_runHandlers(R_InputHandlers, readMask). If
aqua events also need to be checked and handled then you need to weave
that into the above routines, or set up a separate event source for
it. 

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From Simon.Urbanek at math.uni-augsburg.de  Fri Oct 31 13:33:09 2003
From: Simon.Urbanek at math.uni-augsburg.de (Simon Urbanek)
Date: Fri Oct 31 13:34:22 2003
Subject: [Rd] R-1.8.0 + IBM VisualAge/C for AIX compiler
Message-ID: <627D4F05-0B9E-11D8-B482-000A957CEFBA@math.uni-augsburg.de>

A while ago I compiled R 1.7.0 for AIX (with the above compiler - I'll  
call it xlc) and I was surprised that it went quite smoothly.

Unfortunately with R 1.8.0 it's not as easy, but I succeeded at least  
partially. Static R works fine (after some tweaking), but  
--enable-R-shlib fails resp. produces a buggy R. Following are the  
problems I encountered (in a warning-to-fatal-error sequence):

0)
  configure says:
configure: WARNING: I could not determine SHLIB_CXXLDFLAGS
I don't know if this is important, I assume it's not since there should  
be no C++ code ;)

1) .lo files
As Jan already stated in his r-sig-mac post:

>> then pass them to ld, but more importantly they refuse to handle any
>> file with name foo.lo. Is the "lo" a configure switch I can set to "o"
>
> I think the configure code actually tests whether the compilers can
> handle -c -o .lo, and have a workaround if this fails.

The configure code looks whether the compile can *create* .lo (xlc can  
do so), but xlc issues tons of warnings when it's told to *link* .lo  
files:

[...]
cc: 1501-218 file ../unix/sys-common.lo contains an incorrect file  
suffix
cc: 1501-218 file ../unix/sys-std.lo contains an incorrect file suffix
cc: 1501-218 file ../unix/sys-unix.lo contains an incorrect file suffix
cc: 1501-218 file ../unix/system.lo contains an incorrect file suffix

I don't know if this has an impact on the linking, but I hope it  
doesn't since fixing this one is really a pain. It is possible that  
more recent xlcs turned this warning into an error...

2) this is not AIX related, but nevertheless annoying:
make[3]: Entering directory `/tmp/R-1.8.0.build/src/library/base'
building package 'base'
/bin/sh: /usr/bin/cat: 0403-027 The parameter list is too long.

If unfixed, I get errors like:
Error: couldn't find function "attach"
(fix: put the source directory somewhere down the tree - e.g. I  
symlinked it to /tmp/R ;)).

3) tilde_expand from readline:
"/.../dce.uni-augsburg.de/fs/home/mathe/sta/urbanesi/work/R-1.8.0/src/ 
unix/sys-unix.c", line 103.14: 1506-196 (S) Initialization between  
types "char*" and "int" is not allowed.
fix: add a corresponding declaration for tilde_expand

4) .so vs .a
ld: 0706-006 Cannot find or open library file: -l Rlapack
         ld:open(): A file or directory in the path name does not exist.
problem: xlc looks for .a suffix even for shared libraries, butR uses  
.so - a fix is to symlink libRlapack.so to libRlapack.a (any AIX-savvy  
folks here that could tell me how to change that behavior in xlc?)

Ok, now such static R works fine.

But when --enable-R-shlib is on then I get:

5) while making libR.so - bad path to R.exp
ld: 0706-003 Cannot find or read import file: /etc/R.exp
         ld:accessx(): A file or directory in the path name does not  
exist.
make[3]: *** [libR.so] Error 255

for some reason /etc/R.exp ends up in the flags instead of  
$(top_builddir)/etc/R.exp . My guess is that there is also  
$(R_HOME)/etc/R.exp in Makeconf and $R_HOME is not set when compiling  
the R shared library.
Setting R_HOME to the build directory indeed fixes this.

6) when linking to libR.a: many duplicate symbols
Every time a module links against libR duplicate symbols are claimed.  
For example when compiling R_X11.so:

         xlc -Wl,-bM:SRE -Wl,-H512 -Wl,-T512 -Wl,-bnoentry -Wl,-bexpall  
-Wl,-bI:../../../etc/R.exp -L/usr/local/lib -o R_X11.so  dataentry.lo  
devX11.lo rotated.lo rbitmap.lo -lSM -lICE -lX11   -L../../../bin -lR  
-lbz2 -lreadline -ldl -lncurses -lm -lc
xlc: 1501-218 file dataentry.lo contains an incorrect file suffix
xlc: 1501-218 file devX11.lo contains an incorrect file suffix
xlc: 1501-218 file rotated.lo contains an incorrect file suffix
xlc: 1501-218 file rbitmap.lo contains an incorrect file suffix
ld: 0711-224 WARNING: Duplicate symbol: p_xargc
ld: 0711-224 WARNING: Duplicate symbol: p_xargv
ld: 0711-224 WARNING: Duplicate symbol: p_xrcfg
ld: 0711-224 WARNING: Duplicate symbol: p_xrc
ld: 0711-224 WARNING: Duplicate symbol: end
ld: 0711-224 WARNING: Duplicate symbol: .Rf_error
ld: 0711-224 WARNING: Duplicate symbol: Rf_error
ld: 0711-224 WARNING: Duplicate symbol: .Rf_warning
ld: 0711-224 WARNING: Duplicate symbol: Rf_warning
ld: 0711-224 WARNING: Duplicate symbol: .Rf_lengthgets
ld: 0711-224 WARNING: Duplicate symbol: Rf_lengthgets
ld: 0711-224 WARNING: Duplicate symbol: .R_Reprotect
ld: 0711-224 WARNING: Duplicate symbol: R_Reprotect
ld: 0711-224 WARNING: Duplicate symbol: .Rf_mkChar
ld: 0711-224 WARNING: Duplicate symbol: Rf_mkChar
ld: 0711-224 WARNING: Duplicate symbol: .SET_STRING_ELT
ld: 0711-224 WARNING: Duplicate symbol: SET_STRING_ELT
ld: 0711-224 WARNING: Duplicate symbol: .Rf_isNull
ld: 0711-224 WARNING: Duplicate symbol: Rf_isNull
[...]
ld: 0711-224 WARNING: Duplicate symbol: .Rprintf
ld: 0711-224 WARNING: Duplicate symbol: Rprintf
ld: 0711-345 Use the -bloadmap or -bnoquiet option to obtain more  
information.

with -bnoquiet I get:

  p_xargc                   crt0main.s(/lib/crt0.o)
     ** Duplicate **        {../../../bin/libR.a}
[...]
.Rf_error                 {../../../bin/libR.a}
     ** Duplicate **        ../../../etc/R.exp{.}
  Rf_error                  {../../../bin/libR.a}
     ** Duplicate **        ../../../etc/R.exp{.}
[...]

7) now, when such R is run, things go wrong. Just after starting R this  
appears:

Error in open.connection(con, "rb") : unable to open connection
In addition: Warning message:
cannot open compressed file  
`/.../dce.uni-augsburg.de/fs/home/mathe/sta/urbanesi/work/R- 
1.8.0.build/library/methods/R/all.rda'

doing anything produces more warnings:

 > 1:10/2
  [1] 0.5 1.0 1.5 2.0 2.5 3.0 3.5 4.0 4.5 5.0
Warning message:
package methods in options("defaultPackages") was not found

back to 6) - Removing -Wl:-bI...R.exp from the linking removes all  
R-related warnings, but then something strange happens:

building package 'methods'
mkdir -p -- ../../../library/methods/R
all.R is unchanged
mkdir -p -- ../../../library/methods/man
Target "Makedeps" is up to date.
mkdir -p -- ../../../../library/methods/libs
dumping R code in package 'methods'
Saving namespace image ...
/bin/sh: 26442 Segmentation fault(coredump)
make: 1254-004 The error code from the last command is 139.

Any idea how to debug this or what goes on with the R.exp??

Simon

----

R 1.8.0 (release tar-ball)
System: AIX 4.3.3.0
compiler: VisualAge C++/C for AIX Version 5.0.2.0, XL Fortran for AIX  
7.1.0.0

call to configure:
CC=xlc CXX=xlc  
/.../dce.uni-augsburg.de/fs/home/mathe/sta/urbanesi/work/R-1.8.0/ 
configure --prefix=${HOME}/aix --enable-R-shlib

configure output:
R is now configured for powerpc-ibm-aix4.3.3.0

   Source directory:           
/.../dce.uni-augsburg.de/fs/home/mathe/sta/urbanesi/work/R-1.8.0
   Installation directory:     
/.../dce.uni-augsburg.de/fs/home/mathe/sta/urbanesi/aix

   C compiler:                xlc  -g
   C++ compiler:              xlc  -g
   Fortran compiler:          f77  -g

   Interfaces supported:      X11
   External libraries:        readline, BLAS(ESSL)
   Additional capabilities:   bzip2, PCRE
   Options enabled:           shared library, R profiling

   Recommended packages:      yes

configure: WARNING: I could not determine SHLIB_CXXLDFLAGS

---
Simon Urbanek
Department of computer oriented statistics and data analysis
University of Augsburg
Universit?tsstr. 14
86135 Augsburg
Germany

Tel: +49-821-598-2236
Fax: +49-821-598-2200

Simon.Urbanek@Math.Uni-Augsburg.de
http://simon.urbanek.info

From Kurt.Hornik at wu-wien.ac.at  Fri Oct 31 13:51:36 2003
From: Kurt.Hornik at wu-wien.ac.at (Kurt Hornik)
Date: Fri Oct 31 13:54:13 2003
Subject: [Rd] Re: R-1.8.0 + IBM VisualAge/C for AIX compiler
In-Reply-To: <627D4F05-0B9E-11D8-B482-000A957CEFBA@math.uni-augsburg.de>
References: <627D4F05-0B9E-11D8-B482-000A957CEFBA@math.uni-augsburg.de>
Message-ID: <16290.23256.562898.528155@mithrandir.hornik.net>

>>>>> Simon Urbanek writes:

> A while ago I compiled R 1.7.0 for AIX (with the above compiler - I'll  
> call it xlc) and I was surprised that it went quite smoothly.

> Unfortunately with R 1.8.0 it's not as easy, but I succeeded at least
> partially. Static R works fine (after some tweaking), but
> --enable-R-shlib fails resp. produces a buggy R. Following are the
> problems I encountered (in a warning-to-fatal-error sequence):

> ...


> 5) while making libR.so - bad path to R.exp
> ld: 0706-003 Cannot find or read import file: /etc/R.exp
>          ld:accessx(): A file or directory in the path name does not  
> exist.
> make[3]: *** [libR.so] Error 255

> for some reason /etc/R.exp ends up in the flags instead of  
> $(top_builddir)/etc/R.exp . My guess is that there is also  
> $(R_HOME)/etc/R.exp in Makeconf and $R_HOME is not set when compiling  
> the R shared library.
> Setting R_HOME to the build directory indeed fixes this.

> ...

libR.so is built using DYLIB_LDFLAGS which by default is set to
SHLIB_LDFLAGS.  For AIX, we have

    shlib_ldflags="${wl}-bM:SRE ${wl}-H512 ${wl}-T512 ${wl}-bnoentry ${wl}-bexpa
ll ${wl}-bI:\$(R_HOME)/etc/R.exp"

but R_HOME is not set when libR.so is built.  We could either do that,
or set DYLIB_LDFLAGS as needed.

-k

From s.conti at sheffield.ac.uk  Fri Oct 31 14:50:59 2003
From: s.conti at sheffield.ac.uk (s.conti@sheffield.ac.uk)
Date: Fri Oct 31 14:49:55 2003
Subject: [Rd] solve.Matrix() not found (PR#4887)
Message-ID: <200310311350.h9VDox0P010652@pubhealth.ku.dk>

# Your mailer is set to "none" (default on Windows),
# hence we cannot send the bug report directly from R.
# Please copy the bug report (after finishing it) to
# your favorite email program and send it to
#
#       r-bugs@r-project.org
#
######################################################



Dear R developers,

this  morning  I  started  experiencing  a  bizarre  problem  with the
solve.Matrix()  command  in  the  Matrix library: basically R does not
recognise such command any longer, no mettar if re-installation of the
library  is  done.  Any  insight  from  youwill be highly appreciated;
thanks in advance, best regards,

Stefano Conti



--please do not edit the information below--

Version:
 platform = i386-pc-mingw32
 arch = i386
 os = mingw32
 system = i386, mingw32
 status = 
 major = 1
 minor = 8.0
 year = 2003
 month = 10
 day = 08
 language = R

Windows 2000 Professional (build 2195) Service Pack 4.0

Search Path:
 .GlobalEnv, package:Matrix, package:methods, package:ctest, package:mva, package:modreg, package:nls, package:ts, Autoloads, package:base



-- 

Stefano Conti
Department of Probability and Statistics,
University of Sheffield,
Hicks Building,
Hounsfield Road,
Sheffield,
S3 7RH, UK.
Phone: +44 (0) 114 222 3824
Fax: +44 (0) 114 222 3759

From ripley at stats.ox.ac.uk  Fri Oct 31 14:58:44 2003
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri Oct 31 14:57:56 2003
Subject: [Rd] solve.Matrix() not found (PR#4887)
In-Reply-To: <200310311350.h9VDox0P010652@pubhealth.ku.dk>
Message-ID: <Pine.LNX.4.44.0310311356550.19100-100000@gannet.stats>

In what sense is this a bug?  *Please* read the description of BUGS in the 
FAQ.

Note: 

> library(Matrix)
> getS3method("solve", "Matrix")
function (a, b, tol = 0, transpose = FALSE, ...)
{
    if (missing(b))
        return(.Call("R_LapackPP_solve", a, NULL, PACKAGE = "Matrix"))
    .Call("R_LapackPP_solve", a, b, PACKAGE = "Matrix")
}
<environment: namespace:Matrix>

It's a *method* and is meant only to be called via the generic solve().

On Fri, 31 Oct 2003 s.conti@sheffield.ac.uk wrote:

> # Your mailer is set to "none" (default on Windows),
> # hence we cannot send the bug report directly from R.
> # Please copy the bug report (after finishing it) to
> # your favorite email program and send it to
> #
> #       r-bugs@r-project.org
> #
> ######################################################
> 
> 
> 
> Dear R developers,
> 
> this  morning  I  started  experiencing  a  bizarre  problem  with the
> solve.Matrix()  command  in  the  Matrix library: basically R does not
> recognise such command any longer, no mettar if re-installation of the
> library  is  done.  Any  insight  from  youwill be highly appreciated;
> thanks in advance, best regards,
> 
> Stefano Conti
> 
> 
> 
> --please do not edit the information below--
> 
> Version:
>  platform = i386-pc-mingw32
>  arch = i386
>  os = mingw32
>  system = i386, mingw32
>  status = 
>  major = 1
>  minor = 8.0
>  year = 2003
>  month = 10
>  day = 08
>  language = R
> 
> Windows 2000 Professional (build 2195) Service Pack 4.0
> 
> Search Path:
>  .GlobalEnv, package:Matrix, package:methods, package:ctest, package:mva, package:modreg, package:nls, package:ts, Autoloads, package:base
> 
> 
> 
> 

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From bates at stat.wisc.edu  Fri Oct 31 15:43:09 2003
From: bates at stat.wisc.edu (Douglas Bates)
Date: Fri Oct 31 15:43:56 2003
Subject: [Rd] solve.Matrix() not found (PR#4887)
In-Reply-To: <Pine.LNX.4.44.0310311356550.19100-100000@gannet.stats>
References: <Pine.LNX.4.44.0310311356550.19100-100000@gannet.stats>
Message-ID: <6r7k2l4gea.fsf@bates4.stat.wisc.edu>

To elaborate a bit - the reason that the behavior of the Matrix
package changed is because I uploaded a new version that has a
NAMESPACE file.  One result, as Brian Ripley points out, is that
direct calls to method functions, such as

 solve.Matrix(foo, bar)

that previously were acceptable now result in errors.  This call would
only produce a useful result if inherits(foo, "Matrix") is TRUE, in
which case it is equivalent to

 solve(foo, bar)

(unless another method for "solve" would take precedence).  This
version continues to work as expected - at least I hope so.

The moral of the story is that you should call the generic function,
not the method function.

This change is the first stage in a major rewrite of the Matrix
package that will include 

 - a switch from the underlying lapack++ code, which is
   no longer under active development, to C code such as cblas and
   clapack and, perhaps, FLAME 
                 http://www.cs.utexas.edu/users/flame

 - switch to S4 classes and methods

 - addition of sparse matrix methods based on TAUCS, UMFPACK, AMD,
   and, perhaps, METIS

 - moving the pdMat classes from the lme4 package to the Matrix
   package which I think is a more natural place for them.

Stay tuned.

Prof Brian Ripley <ripley@stats.ox.ac.uk> writes:

> Note: 
> 
> > library(Matrix)
> > getS3method("solve", "Matrix")
> function (a, b, tol = 0, transpose = FALSE, ...)
> {
>     if (missing(b))
>         return(.Call("R_LapackPP_solve", a, NULL, PACKAGE = "Matrix"))
>     .Call("R_LapackPP_solve", a, b, PACKAGE = "Matrix")
> }
> <environment: namespace:Matrix>
> 
> It's a *method* and is meant only to be called via the generic solve().
> 
> On Fri, 31 Oct 2003 s.conti@sheffield.ac.uk wrote:
> 
> > # Your mailer is set to "none" (default on Windows),
> > # hence we cannot send the bug report directly from R.
> > # Please copy the bug report (after finishing it) to
> > # your favorite email program and send it to
> > #
> > #       r-bugs@r-project.org
> > #
> > ######################################################
> > 
> > 
> > 
> > Dear R developers,
> > 
> > this  morning  I  started  experiencing  a  bizarre  problem  with the
> > solve.Matrix()  command  in  the  Matrix library: basically R does not
> > recognise such command any longer, no mettar if re-installation of the
> > library  is  done.  Any  insight  from  youwill be highly appreciated;
> > thanks in advance, best regards,
> > 
> > Stefano Conti
> > 
> > 
> > 
> > --please do not edit the information below--
> > 
> > Version:
> >  platform = i386-pc-mingw32
> >  arch = i386
> >  os = mingw32
> >  system = i386, mingw32
> >  status = 
> >  major = 1
> >  minor = 8.0
> >  year = 2003
> >  month = 10
> >  day = 08
> >  language = R
> > 
> > Windows 2000 Professional (build 2195) Service Pack 4.0
> > 
> > Search Path:
> >  .GlobalEnv, package:Matrix, package:methods, package:ctest, package:mva, package:modreg, package:nls, package:ts, Autoloads, package:base
> > 
> > 
> > 
> > 
> 
> -- 
> Brian D. Ripley,                  ripley@stats.ox.ac.uk
> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> University of Oxford,             Tel:  +44 1865 272861 (self)
> 1 South Parks Road,                     +44 1865 272866 (PA)
> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://www.stat.math.ethz.ch/mailman/listinfo/r-devel

-- 
Douglas Bates                            bates@stat.wisc.edu
Statistics Department                    608/262-2598
University of Wisconsin - Madison        http://www.stat.wisc.edu/~bates/

