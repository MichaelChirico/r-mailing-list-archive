From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Apr  1 09:28:56 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 1 Apr 97 10:28:56 +0200
Subject: R-alpha: Re: R-Prerelease  ---- Mailing list  "R-devel"
In-Reply-To: <9704010826.AA00322@> (message from Martin Maechler on Tue, 1 Apr
 97 10:26:38 +0200)
Message-ID: <9704010828.AA00328@>

well yes,  I've only sent mail to R-devel,...

When I started, I thought I would first let you give feedback on it,..
I can still change some of the names if any of you thinks it's necessary

	(and yes, no  "April's fool" included...)

Martin 
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Tue Apr  1 09:35:43 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 1 Apr 1997 10:35:43 +0200
Subject: R-alpha: Re: R-Prerelease  ---- Mailing list  "R-devel"
In-Reply-To: <9704010828.AA00328@>
References: <9704010826.AA00322@>
 <9704010828.AA00328@>
Message-ID: <199704010835.KAA30138@aragorn.ci.tuwien.ac.at>

>>>>> Martin Maechler writes:

> well yes,  I've only sent mail to R-devel,...
> When I started, I thought I would first let you give feedback on it,..
> I can still change some of the names if any of you thinks it's necessary

> 	(and yes, no  "April's fool" included...)

:-)

Martin:

Very good idea.  (In fact, I was thinking of proposing something similar
in a few days ...).  Of course, it means that I now have to rewrite the
FAQ more or less completely (0.50, CRAN, new mailing lists, ...).

Could you change my entry to
	Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at>
???

-k

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Thu Apr  3 08:50:54 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Thu, 3 Apr 97 09:50:54 +0200
Subject: R-alpha: Re: Pretest Version + Notes --- write.table
In-Reply-To: <199704021013.MAA09534@aragorn.ci.tuwien.ac.at> (message from
 Kurt Hornik on Wed, 2 Apr 1997 12:13:25 +0200)
Message-ID: <9704030750.AA03413@>


Kurt writes

KH>> * I am also not sure whether one should include the write.table()
KH>> function I posted some time ago.  It seems to be a bad idea to make a
KH>> contrib package out of it (containing only a single function ...).

Yes, I think we should have a good  "write" function for  data.frames.
However, I would go even further and 'vote' for a GENERIC function  'write'
which has methods for
	default	  (including 'matrix'  as long as 'matrix' is not a class)
	data.frame
	....	['ts', ...]

The following is code that I've been using in S-plus for a while and have
adapted to R:
--- Note that it uses something  more primitive than Kurt's write.table.
    The issue really was to be able to "write a data.frame or matrix" such that
    read.table would reproduce it.


write <- function(x, file = "data", ...) UseMethod("write")

write.default <- function (x, file = "data",
			   ncolumns = if (is.character(x)) 1 else 5,
			   append = FALSE, ...)
{
  if(is.matrix(x))
    write.matrix(x, file=file, append= FALSE, ...)
  else
    write0.basic(x, file = file, ncolumns= ncolumns, append = append)
}

write0.basic <- function (x, file, ncolumns, append = FALSE)
  cat(x, file = file, sep = c(rep(" ", ncolumns - 1), "\n"), append = append)

write.data.frame <- function(x, file = "data", rownames = TRUE)
{
  ## Purpose: Method to 'write(.)' such as to read back using  read.table(.)
  ## -------------------------------------------------------------------------
  ## Arguments:       x : data frame;			file : file name
  ##            rownames: if T, also write row names
  ## -------------------------------------------------------------------------
  ## Author: Martin Maechler <maechler@stat.math.ethz.ch>,  1992
  ## -------------------------------------------------------------------------
  ##-- NOT for "parametrized" data.frames; just ``simple'' matrix look-a-likes
  ##-- NOTE: read.table(file) may still give different data.frame --
  ##-- ~~~~  	        (namely,e.g., when some names contained padding blanks)
  ##-- 	    But the "new" names may actually be better .. (!) ..
  ## EXAMPLE:
  ##   data(women); write(women, file= "women.dat")
  ##   wm <- read.table("women.dat")) 
  ##   all.equal(wm, women) ##> TRUE
  if(!is.data.frame(x)) { #-- can only happen when called explicitely
    warning("'x' is not a data.frame; coercing it to one ...")
    x <- data.frame(x)
  }
  cat( names(x), "\n", file = file, append = FALSE)
  write0.basic(unclass(t(cbind(if(rownames)row.names(x), as.matrix(x)))),
	       ncolumns = rownames + ncol(x), file= file, append= TRUE)
}

write.matrix     <- function(x, file = "data", rownames = TRUE)
  write(data.frame(as.matrix(x)), file=file, rownames=rownames)

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Thu Apr  3 13:45:55 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Thu, 3 Apr 97 14:45:55 +0200
Subject: R-alpha: R0.50-pre6:  "stack imbalance in ..." //  is.vector(matrix...)
Message-ID: <9704031245.AA03766@>

[[[ To the new subscribers of the  R-devel  mailing list:
    The latest  prerelease of R 0.50 has not been
    announced to this mailing list, by accident.

  In short, get		R6.tgz  and  R6-update.shar.gz,

  from	ftp://stat.auckland.ac.nz/pub/ihaka/

  and first unpack  the tar file, then the shar file in the same
  directory..
]]]

and to ALL  "R-devel"oppers:
	
	Yes, please use this mailing list to report
	bugs / fixes / annotations / suggestions ...	

-- Martin [after ``e-talking'' to Ross]
------------------------------------------------------------------------

Quite strange error / warning messages that I am getting here:

   > prompt(prompt)
   stack imbalance in internal as.vector, 22 then 21
   stack imbalance in .Internal, 21 then 20
   stack imbalance in <-, 16 then 15
   created file named  prompt.man  in the current directory.
     Edit the file and move it to the appropriate directory,
    /soft/sunos5_1/R-prealpha-0.50-6/src/manual/man/ dropping the ending '.man'
   stack imbalance in {, 14 then 13

The first three messages are created by "as.character" on a 'symbol'
object:

   > (function(x) as.character(substitute(x)))(abc)
   stack imbalance in internal as.vector, 9 then 8
   stack imbalance in .Internal, 8 then 7
   Error: stack imbalance in "unprotect"

-------
The 2nd remark is both a bug and a feature report:

Good news:  One long standing  S(-plus) bug  has been fixed in R:

	is.vector( __named_vector__ )   finally gives TRUE

Bad  news:  is.vector( __matrix__ )  now also is TRUE which is not wanted IMHO.

> is.vector(structure(1:9, names=letters[1:9]))
[1] TRUE
> is.vector(cbind(1,1:3))
[1] TRUE
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Sun Apr  6 10:56:59 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Sun, 6 Apr 1997 21:56:59 +1200 (NZST)
Subject: R-alpha: Some name changes
Message-ID: <199704060956.VAA07988@stat1.stat.auckland.ac.nz>

I would like to raise the possibility of some function name
changes.  For compatibility with S it might be good to change

	"dotplot" to "dotchart"
	"piechart" to "pie"

(are there any others?).  Is either of these a good idea?
(I would actualy like to change "piechart" to something
like

	piechart.use.this.function.and.you.will.catch.ebola

to discourage people from using it, but perhaps sneaking
a segmentation violation into the code will do the trick :-)

We could also replace "save.plot" and " print.plot" by a
single function

	hardcopy(file, printcmd="lpr")

which would work as follows:  If "file" is specified, the
onscreen plot is saved as encapsulated postscript (or whatever
the platform standard is), otherwise the postscript is piped
to the command specified by printcmd.  This would replace
two commands with one.

Even when multiple active devices happen (soonish???),
I think that having a command like this would probably be
useful.
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Sun Apr  6 21:58:11 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Mon, 7 Apr 1997 08:58:11 +1200 (NZST)
Subject: R-alpha: What should is.vector do?
Message-ID: <199704062058.IAA09618@stat1.stat.auckland.ac.nz>

[ Consumer warning: This is a little technical ... ]

I have been pondering the question

		What should is.vector do?

Martin has raised this a number of times.  I ran a few tests 
in S and got the following results.

	S> is.vector(list(1,2,3))
	[1] T
	S> is.vector(expression(a+b))
	[1] T
	S> is.vector(as.name("x"))
	[1] T  
	S> is.vector(NULL)
	[1] T
	S> x <- 1:5
	S> is.vector(x)
	[1] T
	S> names(x) <- letters[1:5] 
	S> is.vector(x)
	[1] F

Essentially, everything in S is a vector unless it has attributes.
This is utterly unreasonable!  Why should something stop being a
vector because it has a names attribute attached.
	
Internally in R, we have a predicate isVector() which returns
true if its argument has one of the storage modes "logical",
"factor", "ordered", "integer", "real", "complex" and "character".
This is useful because these are the types which can be subscripted 
(without using CAR and CDR).  We almost certainly need an external
version of this predicate.  I suppose that it could be called	 
is.vector.mode(x).

Another reasonable definition of "vector" is !is.array(x).
or possibly "isVector(x) == 1 && !is.array(x)

What complicates things is that there is a second argument
which specifies a mode for the vector.  In S, it is possible to
have calls like

	is.vector(x, "list")
	is.vector(x, "language")

We have gone some way down the road to mimicing this behaviour,
but it really doesn't fit naturally into the R model.

Looking at our own code base, I see that "is.vector" is used only
in the "data.entry" functions, (and I think I need to check that
code carefully).  We seem to use the predicates

	is.list(x)
	is.language(x)

etc in preference to the above.

Anyway, can we communally come to (reasonably) firm conclusion about
what is.vector should do?  I'm prepared to implement almost anything,
but I'm rather confused about exactly what is.vector should do.
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Mon Apr  7 08:33:51 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Mon, 7 Apr 97 09:33:51 +0200
Subject: R-alpha: What should is.vector do?
In-Reply-To: <199704062058.IAA09618@stat1.stat.auckland.ac.nz> (message from
 Ross Ihaka on Mon, 7 Apr 1997 08:58:11 +1200 (NZST))
Message-ID: <9704070733.AA00396@>


Ross>> Internally in R, we have a predicate isVector() which returns
Ross>> true if its argument has one of the storage modes "logical",
Ross>> "factor", "ordered", "integer", "real", "complex" and "character".
Ross>> This is useful because these are the types which can be subscripted 
Ross>> (without using CAR and CDR).  We almost certainly need an external
Ross>> version of this predicate.  I suppose that it could be called	 
Ross>> is.vector.mode(x).

Yes, "export"  isVector  as  'is.vector.mode'!

Ross>> Another reasonable definition of "vector" is !is.array(x).
Ross>> or possibly "isVector(x) == 1 && !is.array(x)
Yes, I think
		isVector(x) == 1 && !is.array(x)

is the way to go, at least for   mode = 'any'

Now, for the 2nd argument  mode = '...' :
I think it should always be more restrictive, i.e.,
	  is.vector(OB, mode= MODE)   <-->   is.vector(OB) &&  MODE.test(OB)

which is not the case currently [[correcting a typo in $RHOME/TASKS l.449-451]

 is.vector(call("ls"))			#[1] FALSE
 is.vector(call("ls"), mode='language')	#[1] TRUE
 is.vector(call("ls"), mode='call')	#[1] FALSE

[[here, is.vector(call("ls"), mode='any')  should really return TRUE]]
  
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Apr  8 09:43:55 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 8 Apr 97 10:43:55 +0200
Subject: R-alpha: Seg.faults with complex: factor(..), unique(..).  Missing feature ``sort( complex(..) )''
Message-ID: <9704080843.AA01399@>

1) Several functions still (0.50 - pre6)
   give seg.faults when called with complex:

unique( 1i)  --> segfault
In 'factor', levels are defaulted to  'sort(unique(x))'
which seg.faults  factor( 1i).

Because of 'factor', table(..complex..)  seg.faults,.....


2)  sort ( complex )   [[Of course this is minor ..]]

You may not believe this can be useful, but...
I've been digging in old S-code  which makes use of this (and also of unique(.))

Be  
	z = x + 1i*y;   x,y real vectors
Then,  
	order(z)   : <-->  order(x,y)

This is how it is defined in S (but it is implemented via .Internal(..)).

One could add the following line to the definition of 'sort'

	if(is.complex(x)) return( x[order(Re(x),Im(x))] )

which has the drawback of NOT using the 'partial' and  'na.last' arguments.
((This actually makes me think that
  maybe  'order' should also accept these two)).
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Tue Apr  8 17:47:59 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Tue, 8 Apr 1997 09:47:59 -0700 (PDT)
Subject: R-alpha: rbind
In-Reply-To: <9704010823.AA00318@>
Message-ID: <Pine.SUN.3.91.970408094156.9023A-100000@chekov>

rbind() does something strange to dimnames

R : Copyright 1997, Robert Gentleman and Ross Ihaka
Version 0.50 Beta (April 1, 1997)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type "license()" for details.

> test1 <- data.frame(time=  c(4, 3,1,1,2,2,3),
   +     status=c(1,NA,1,0,1,1,0),
  +     x=     c(0, 2,1,1,1,0,0))
> temp<-as.matrix(test1)
> dimnames(temp)
[[1]]
NULL

[[2]]
[1] "time"   "status" "x"     

> temp<-rbind(temp,temp)
Error: invalid type for dimnames: must be a list
> dimnames(temp)
[[1]]
NULL
Segmentation fault (core dumped)

Part of the problem is that as.matrix() doesn't set dimnames()[[1]]. If I 
set this by hand everything works. Even so, the rbind function should 
succeed or fail -- it shouldn't mutilate its arguments like this.


Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Tue Apr  8 18:04:19 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Tue, 8 Apr 1997 10:04:19 -0700 (PDT)
Subject: R-alpha: as.numeric
In-Reply-To: <Pine.SUN.3.91.970408094156.9023A-100000@chekov>
Message-ID: <Pine.SUN.3.91.970408100342.9023B-100000@chekov>


as.numeric() turns a logical matrix into a numeric vector. Shouldn't it 
stay a matrix?


Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Tue Apr  8 18:27:48 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 08 Apr 1997 19:27:48 +0200
Subject: R-alpha: User friendly functions
Message-ID: <x2k9md77cb.fsf@bush.kubism.ku.dk>

A loose idea for *post*-0.50 development

I've been giving a some (but not all that many) thoughts to whether
some of the conceptual difficulties facing newcomers could be avoided
by having simplified functions for common operations. We already have
parts of this, e.g. in Kurts ctest routines. Specifically, I was
thinking about data frames: How about

dfr.sel<-select.frame(dfr,age,sex,pain1:pain5)

with the : specifying a range, instead of 

dfr.sel<-dfr[,c(1,2,5,6,7,8,9)] 

or 

attach(dfr)
dfr.sel<-data.frame(age,sex,pain1,pain2,pain3,pain4,pain5) 
detach(dfr)

(which isn't even safe if there are variables of the same name in the
global environment)

similarly, how about

dfr.sub<-subset.frame(dfr,sex==1 && age > 30)

rather than

dfr.sub<-dfr[dfr$sex==1 && dfr$age > 30,]

Both would seem to be quite possible to implement, although they do
need to do some sneaky bits of computing-on-the-language internally.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Tue Apr  8 19:03:38 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 8 Apr 1997 20:03:38 +0200
Subject: R-alpha: CRAN source/contrib
Message-ID: <199704081803.UAA13616@aragorn.ci.tuwien.ac.at>

Oops, forgot to attach the INDEX file:

CRAN/source/contrib currently contains:

acepack.tar.gz:
	ace (Alternating Conditional Expectations) and avas (Additivity
	and variance stabilization for regression) for selecting
	regression transformations.

	avas S original by Rob Tibshirani <tibs@utstat.toronto.edu>.
	R port by Thomas Lumley <thomas@biostat.washington.edu>.
	[1997/04/08]
	
bootstrap.tar.gz:
	Software (bootstrap, cross-validation, jackknife), data and
	errata for the book "An Introduction to the Bootstrap" by B.
	Efron and R.  Tibshirani, 1993, Chapman and Hall.

	S original by Rob Tibshirani <tibs@utstat.toronto.edu>.
	R port by Fritz Leisch <Friedrich.Leisch@ci.tuwien.ac.at>.
	[1997/04/08]

ctest.tar.gz:
	A library of classical tests, including the Bartlett, Fisher,
	Kruskal-Wallis, Kolmogorov-Smirnov, and Wilcoxon tests.
	
	Written by Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at>.
	[1997/04/08]

date.tar.gz:
	Functions for dealing with dates.  The most useful of them
	accepts a vector of input dates in any of the forms 8/30/53,
	30Aug53, 30 August 1953,..., August 30 53, or any mixture of
	these.

	S original by Terry Therneau <therneau@mayo.edu>.
	R port by Thomas Lumley <thomas@biostat.washington.edu>.
	[1997/04/08]

e1071.tar.gz:
	Miscellaneous functions used at the Department of Statistics at
	TU Wien (E1071).

	Compiled by Fritz Leisch <Friedrich.Leisch@ci.tuwien.ac.at>.
	[1997/04/08]	

fracdiff.tar.gz:
	Maximum likelihood estimation of the parameters of a
	fractionally differenced ARIMA(p,d,q) model (Haslett and
	Raftery, Applied Statistics, 1989).

	S original by Chris Fraley <fraley@stat.washington.edu>.
	R port by Fritz Leisch <Friedrich.Leisch@ci.tuwien.ac.at>.
	[1997/04/08]

gee.tar.gz:
	An implementation of the Liang/Zeger generalized estimating
	equation approach to GLMs for dependent data.

	S original by Vincent Carey <carey@biostat.harvard.edu> and
	Aidan McDermott.
	R port by Thomas Lumley <thomas@biostat.washington.edu>.
	[1997/04/08]

jpn.tar.gz:
	A function to plot Japan's coast-line and prefecture
	boundaries.

	S original by Ritei Shibata <shibata@statlab.math.keio.ac.jp>.
	R port by Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at>.
	[1997/04/08]	

snns.tar.gz:
	An R interface to the Stuttgart Neural Networks Simulator
	(SNNS).

	Written by Fritz Leisch <Friedrich.Leisch@ci.tuwien.ac.at>.
	[1997/04/08]

splines.tar.gz:
	Regression spline functions.

	S original by Doug Bates <bates@stat.wisc.edu>.
	R port by Thomas Lumley <thomas@biostat.washington.edu>.
	[1997/04/08]

survival4.tar.gz:
	Functions for survival analysis.  This ``port'' is not complete
	yet, because it requires a few changes to the R system itself
	rather than the add-on package, but most of the functionality is
	already available.

	Requires splines.

	S original by Terry Therneau <therneau@mayo.edu>.
	R port by Thomas Lumley <thomas@biostat.washington.edu>.
	[1997/04/08]
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Tue Apr  8 18:49:33 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 8 Apr 1997 19:49:33 +0200
Subject: R-alpha: CRAN source/contrib
Message-ID: <199704081749.TAA13566@aragorn.ci.tuwien.ac.at>

I've put all ``current'' add-on packages into CRAN's source/contrib tree
and created an INDEX file (attached below).  As you can see, currently
we have

  acepack
  bootstrap
  ctest
  date
  e1071
  fracdiff
  gee
  jpn
  snns
  splines
  survival4

(Yes, e1071 and jpn are new ... more on the latter in a later mail.)

In the near future, I am hoping for the following:

  oz		(Bill Venables said should work without problems ...)
  polynom	(Has been used as a test bed for the new group methods
		 in R 0.50, so should only be a matter of packaging.
	         Or were there some changes?)
  wavethresh	(According to A. Kovac, worked under 0.12.  Thought I'd
                 ask the guy for an official port.)
  time.series	(Paul Gilbert promised an official release following the
		 release of R 0.50)

Fritz (and I) have also started to port the `clus' software which was
recently documented in an article in Journal of Statistical Software.

Also, Doug's nonlin seems to compute fine after one change, but the
output needs help.  Is this still useful, or do we have something better
for fitting nonlinear models?

As you can see from the list, we're not doing too bad ...

-k

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Tue Apr  8 19:03:01 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 8 Apr 1997 20:03:01 +0200
Subject: R-alpha: jpn() port
Message-ID: <199704081803.UAA13610@aragorn.ci.tuwien.ac.at>

I've just completing porting the S jpn package to R (available in CRAN's
source/contrib).

Some remarks:

* It seems that S allows recycling when subscripting with logicals, but
R does not.  E.g.,

R> x <- 1:5
R> x
[1] 1 2 3 4 5
R> i <- c(F, T)
R> x[i]
Error: invalid subscript type
R>

In S, this is treated as x[rep(i, length = length(x))].

* It also seems that S does not worry about excluding subscripts which
are out of bounds.  In the above, x[-6] would give x, but in R

R> x[-6]
Error: subscript out of bounds

Just wanted to point that out ...

The jpn package contains VARIABLES (``data'') as well as functions, and
I guess it is the first one to do so.  Because we don't have `data'
grouped similar to `help' yet, the data are now directly in the R
`source'.

A problem occurs when documenting such data sets ... is there a nice way
of saying that something is a list with components
	a ....
	b ...
	c ...
using the R doc format?

Finally, here's something that's also been on my mind for some time now
(and also needed help in the port).  Code like

	if(all(names(x)) == c("x", "y"))

fails if names(x) is NULL.  Is that really necessary?  (More precisely,
obviously we only want to test whether the two objects have equal
values, a la Lisp `equal').

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Tue Apr  8 23:16:43 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 09 Apr 1997 00:16:43 +0200
Subject: R-alpha: as.numeric
In-Reply-To: Thomas Lumley's message of Tue, 8 Apr 1997 10:04:19 -0700 (PDT)
References: <Pine.SUN.3.91.970408100342.9023B-100000@chekov>
Message-ID: <x2iv1xtb1w.fsf@bush.kubism.ku.dk>

Thomas Lumley <thomas@biostat.washington.edu> writes:

> as.numeric() turns a logical matrix into a numeric vector. Shouldn't it 
> stay a matrix?

It *sounds* wrong, but:

S-PLUS : Copyright (c) 1988, 1996 MathSoft, Inc.
S : Copyright AT&T.
Version 3.4 Release 1 for Sun SPARC, SunOS 5.3 : 1996 
Working data will be in .Data 
> cbind(c(T,T),c(F,F))
     [,1] [,2] 
[1,]    T    F
[2,]    T    F
> as.numeric(.Last.value)
[1] 1 1 0 0

In fact, it does the same with numeric matrices.

To convert logical matrix to character matrix in Splus, you could
either add zero or use mode(x)<-"numeric", same thing in R.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Tue Apr  8 23:26:43 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 09 Apr 1997 00:26:43 +0200
Subject: R-alpha: jpn() port
In-Reply-To: Kurt Hornik's message of Tue, 8 Apr 1997 20:03:01 +0200
References: <199704081803.UAA13610@aragorn.ci.tuwien.ac.at>
Message-ID: <x2hghhtal8.fsf@bush.kubism.ku.dk>

Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

> Finally, here's something that's also been on my mind for some time now
> (and also needed help in the port).  Code like
> 
> 	if(all(names(x)) == c("x", "y"))
> 
> fails if names(x) is NULL.  Is that really necessary?  (More precisely,
> obviously we only want to test whether the two objects have equal
> values, a la Lisp `equal').

According to my parenthesis count, that expression will fail in any
case! However, I get your drift. Splus has
> all(NULL)
[1] T
> any(NULL)
[1] F

Which makes sense for cases like yours. R should probably conform to
this. 

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Wed Apr  9 07:34:29 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 9 Apr 97 08:34:29 +0200
Subject: R-alpha: as.numeric
In-Reply-To: <Pine.SUN.3.91.970408100342.9023B-100000@chekov> (message from
 Thomas Lumley on Tue, 8 Apr 1997 10:04:19 -0700 (PDT))
Message-ID: <9704090634.AA01856@>


>>>>> "Thomas" == Thomas Lumley <thomas@biostat.washington.edu> writes:

    Thomas> as.numeric() turns a logical matrix into a numeric
    Thomas> vector. Shouldn't it stay a matrix?

One first would think so.
However, R here behaves as S.

>From ?as.numeric of S-plus 3.4:
S> VALUE:
S>        ....
S> 
S>        as.numeric returns a vector like x, but with storage  mode
S>        "double",  if  x  is  a  simple  object of mode "numeric".
S>        Otherwise, as.numeric returns a numeric object of the same
S>        length  as  x  and  with  data resulting from coercing the
S>        elements of x to mode "numeric".

The following shows the old (in S) quite usual ``workaround''.
The following code works `identically' in R and S :

> Mas.numeric <- function(x){ mode(x) <- "numeric"; x}
> M <- cbind("1",1:3); M
     [,1] [,2]
[1,] "1"  "1" 
[2,] "1"  "2" 
[3,] "1"  "3" 
> as.numeric(M)
[1] 1 1 1 1 2 3
> Mas.numeric(M)
     [,1] [,2]
[1,]    1    1
[2,]    1    2
[3,]    1    3
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Wed Apr  9 10:17:37 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 9 Apr 97 11:17:37 +0200
Subject: R-alpha: R <-> S compatibility; more demos -- using  S-plus validate(..) ..
Message-ID: <9704090917.AA01943@>

Look at the result of
(in S-plus:)
	validate(verbose=TRUE, outfile="......./validate-3.4.out")

which gives (for me, S-plus 3.4 on Solaris 2.5) 
2106 Lines of output.
It's full of tests using "standard data sets".  (-->  'demos' available!)

Basically, at the end of each example, there are  statements which
should return  TRUE  if the 'validation test' is passed, e.g.,
	all(c(b.test$statistic == 1, abs(b.test$p.value - 0.1562) < tol, 
	      b.test$alternative == "two.sided"))

One bigger job would be to run these through R and analyze the
results... -- any volunteers ?
	
	((I could even send you the file if don't have S-plus
	  available...))

-- Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Apr 11 08:18:42 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 11 Apr 97 09:18:42 +0200
Subject: R-alpha: R-lists archives: "timeout" since April 1 -- have you saved all?
Message-ID: <9704110718.AA02705@>

For a silly file permission reason,
the automatical archiving of the three mailing lists hasn't been working
from April 1 till April 10.

If any of you has a "complete" archive of this time-period;
I'd be glad to fix the archives.
((I have an own  ``close to complete'' archive)).

-- Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-


From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Apr 11 08:18:42 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 11 Apr 97 09:18:42 +0200
Subject: R-alpha: R-lists archives: "timeout" since April 1 -- have you saved all?
Message-ID: <9704110718.AA02705@>

For a silly file permission reason,
the automatical archiving of the three mailing lists hasn't been working
from April 1 till April 10.

If any of you has a "complete" archive of this time-period;
I'd be glad to fix the archives.
((I have an own  ``close to complete'' archive)).

-- Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Apr 14 09:04:34 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 14 Apr 1997 10:04:34 +0200
Subject: R-alpha: jpn() port
In-Reply-To: <x2hghhtal8.fsf@bush.kubism.ku.dk>
References: <199704081803.UAA13610@aragorn.ci.tuwien.ac.at>
 <x2hghhtal8.fsf@bush.kubism.ku.dk>

>>>>> Peter Dalgaard BSA writes:

> Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:
>> Finally, here's something that's also been on my mind for some time now
>> (and also needed help in the port).  Code like
>> 
>> if(all(names(x)) == c("x", "y"))
>> 
>> fails if names(x) is NULL.  Is that really necessary?  (More precisely,
>> obviously we only want to test whether the two objects have equal
>> values, a la Lisp `equal').

> According to my parenthesis count, that expression will fail in any
> case!

Yes ... I meant

	if(all(names(x) == c("x", "y")))

> However, I get your drift. Splus has
>> all(NULL)
> [1] T
>> any(NULL)
> [1] F

> Which makes sense for cases like yours. R should probably conform to
> this.

Actually, I am not sure about that, but it does not solve the problem.
If you look at the code in the S jpn package, it contains

	if(all(names(region) == c("x", "y")))

If region has no names attribute,

	all(names(region) == c("x", "y"))

gives NA and if(NA) (correctly) gives ``Error: Missing value where
logical needed''.  The problem is that NULL == something gives NA.
(Should it really do that?)

But perhaps it is better anyway to force the programmer to check for
NULL values before comparisons ...

-k

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-


From Martin Maechler <maechler@stat.math.ethz.ch>  Mon Apr 14 09:25:09 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Mon, 14 Apr 97 10:25:09 +0200
Subject: R-alpha: Re: Mailing list archives -- ok -- thank you
Message-ID: <9704140825.AA00396@>

Thanks to Peter Dalgaard   
who was the first one to offer me help
I've about everything I need for the archives of the 3 mailing lists.

Thank you all	-- Martin.

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Apr 14 14:00:31 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 14 Apr 1997 15:00:31 +0200
Subject: R-alpha: problems qith require/provide
Message-ID: <199704141300.PAA00699@aragorn.ci.tuwien.ac.at>

If I call require() with the most current snapshot and patches, I get

	Error: Object ".Provided" not found

The problem is with

	if (is.na(match(name, .Libraries)) &&
            is.na(match(name, .Provided))) {

which fails if .Provided does not exist yet.  Perhaps it should be
defined in Rprofile, similar to .Libraries?

Also, is the 

  if (!exists(".Libraries", inherits = TRUE)) {
    assign(".Libraries", character(0), NULL)
  }

really needed then?

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Apr 14 14:03:39 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 14 Apr 1997 15:03:39 +0200
Subject: R-alpha: problem with survival4 and ":="
Message-ID: <199704141303.PAA00724@aragorn.ci.tuwien.ac.at>

Has ":=" been eliminated?  It seems to be gone from the most current
snapshot, which makes loading survival4 fail (it contains 6 `:='
assignments in header.R).

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Apr 14 17:33:55 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 14 Apr 1997 18:33:55 +0200
Subject: R-alpha: CRAN source/contrib
Message-ID: <199704141633.SAA04237@aragorn.ci.tuwien.ac.at>

Several of the contrib packages were upgraded today.  Most notably,
Thomas rewrote parts of gee which were copied from Numerical Recipes.
Also, I added a port of the `oz' package which seems to work fine.

The current INDEX file is attached.  I've made several changes as
suggested.  CRAN should be announced soon (hopefully I can get to
upgrading the FAQ tonight).

-k

***********************************************
CRAN/source/contrib currently contains:

acepack.tar.gz:
	ace (Alternating Conditional Expectations) and avas (Additivity
	and variance stabilization for regression) for selecting
	regression transformations.

	S avas original by Rob Tibshirani <tibs@utstat.toronto.edu>,
	FORTRAN ace code by Friedman & Spector from Statlib.
	R package by Thomas Lumley <thomas@biostat.washington.edu>.
	(avas ported; ace modified to use double precision, and an R
	interface cloned from the avas() one).
	[1997/04/14]
	
bootstrap.tar.gz:
	Software (bootstrap, cross-validation, jackknife), data and
	errata for the book "An Introduction to the Bootstrap" by B.
	Efron and R.  Tibshirani, 1993, Chapman and Hall.

	S original by Rob Tibshirani <tibs@utstat.toronto.edu>.
	R port by Fritz Leisch <Friedrich.Leisch@ci.tuwien.ac.at>.
	[1997/04/14]

ctest.tar.gz:
	A library of classical tests, including the Bartlett, Fisher,
	Kruskal-Wallis, Kolmogorov-Smirnov, and Wilcoxon tests.
	
	Written by Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at>.
	[1997/04/08]

date.tar.gz:
	Functions for dealing with dates.  The most useful of them
	accepts a vector of input dates in any of the forms 8/30/53,
	30Aug53, 30 August 1953,..., August 30 53, or any mixture of
	these.

	S original by Terry Therneau <therneau@mayo.edu>.
	R port by Thomas Lumley <thomas@biostat.washington.edu>.
	[1997/04/08]

e1071.tar.gz:
	Miscellaneous functions used at the Department of Statistics at
	TU Wien (E1071).

	Compiled by Fritz Leisch <Friedrich.Leisch@ci.tuwien.ac.at>.
	[1997/04/14]	

fracdiff.tar.gz:
	Maximum likelihood estimation of the parameters of a
	fractionally differenced ARIMA(p,d,q) model (Haslett and
	Raftery, Applied Statistics, 1989).

	S original by Chris Fraley <fraley@stat.washington.edu>.
	R port by Fritz Leisch <Friedrich.Leisch@ci.tuwien.ac.at>.
	[1997/04/08]

gee.tar.gz:
	An implementation of the Liang/Zeger generalized estimating
	equation approach to GLMs for dependent data.

	S original by Vincent Carey <carey@biostat.harvard.edu> and
	Aidan McDermott.
	R port by Thomas Lumley <thomas@biostat.washington.edu>.
	[1997/04/14]

jpn.tar.gz:
	A function to plot Japan's coast-line and prefecture
	boundaries.

	S original by Ritei Shibata <shibata@statlab.math.keio.ac.jp>.
	R port by Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at>.
	[1997/04/08]	

oz.tar.gz:
	Functions for plotting Australias coastline and state boundaries.

	S original by Bill Venables <Bill.Venables@adelaide.edu.au>.
	R port by Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at>.
	[1997/04/14]

snns.tar.gz:
	An R interface to the Stuttgart Neural Networks Simulator
	(SNNS).

	Written by Fritz Leisch <Friedrich.Leisch@ci.tuwien.ac.at>.
	[1997/04/14]

splines.tar.gz:
	Regression spline functions.

	R port by Thomas Lumley <thomas@biostat.washington.edu>, based
	on the S packages `splines' by Doug Bates <bates@stat.wisc.edu>
	and `safe.predict' by John Chambers and Trevor Hastie.
	[1997/04/08]

survival4.tar.gz:
	Functions for survival analysis.  This ``port'' is not complete
	yet, because it requires a few changes to the R system itself
	rather than the add-on package, but most of the functionality is
	already available.

	Requires splines.

	S original by Terry Therneau <therneau@mayo.edu>.
	R port by Thomas Lumley <thomas@biostat.washington.edu>.
	[1997/04/14]
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Apr 14 17:57:44 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 14 Apr 1997 18:57:44 +0200
Subject: R-alpha: User friendly functions
In-Reply-To: <x2k9md77cb.fsf@bush.kubism.ku.dk>
References: <x2k9md77cb.fsf@bush.kubism.ku.dk>
Message-ID: <199704141657.SAA04410@aragorn.ci.tuwien.ac.at>

>>>>> Peter Dalgaard BSA writes:

> A loose idea for *post*-0.50 development
> I've been giving a some (but not all that many) thoughts to whether
> some of the conceptual difficulties facing newcomers could be avoided
> by having simplified functions for common operations. We already have
> parts of this, e.g. in Kurts ctest routines. Specifically, I was
> thinking about data frames: How about

> dfr.sel<-select.frame(dfr,age,sex,pain1:pain5)

> with the : specifying a range, instead of 

> dfr.sel<-dfr[,c(1,2,5,6,7,8,9)] 

> or 

> attach(dfr)
> dfr.sel<-data.frame(age,sex,pain1,pain2,pain3,pain4,pain5) 
> detach(dfr)

> (which isn't even safe if there are variables of the same name in the
> global environment)

> similarly, how about

> dfr.sub<-subset.frame(dfr,sex==1 && age > 30)

> rather than

> dfr.sub<-dfr[dfr$sex==1 && dfr$age > 30,]

> Both would seem to be quite possible to implement, although they do
> need to do some sneaky bits of computing-on-the-language internally.

Something like that would be very nice to have.

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Mon Apr 14 18:28:06 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 14 Apr 1997 19:28:06 +0200
Subject: R-alpha: User friendly functions
In-Reply-To: Kurt Hornik's message of Mon, 14 Apr 1997 18:57:44 +0200
References: <x2k9md77cb.fsf@bush.kubism.ku.dk>
 <199704141657.SAA04410@aragorn.ci.tuwien.ac.at>
Message-ID: <x2208dfra1.fsf@bush.kubism.ku.dk>

Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

> > dfr.sel<-select.frame(dfr,age,sex,pain1:pain5)
> 
> > dfr.sub<-subset.frame(dfr,sex==1 && age > 30)
> 
> Something like that would be very nice to have.

I got a working select.frame() during the weekend. Really easy, once you
get the hang of constructions of the type

eval(as.call(subst.expr(c(as.name("c"),expression(...)))))

- with subst.expr() recursively replacing call arguments with
corresponding numbers using match(). As a bonus, it is actually
possible to do stuff like

select.frame(psychometry,seq(scale1.before,scale15.before,2))

and get every *second* variable in the range (skipping "after"
measurements) 

Next: subset.frame() - before I do the obvious: Is there a simple way
of getting R to search a frame *before* the global environment?

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Mon Apr 14 21:09:49 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Tue, 15 Apr 1997 08:09:49 +1200 (NZST)
Subject: R-alpha: problems qith require/provide
Message-ID: <199704142009.IAA02547@stat1.stat.auckland.ac.nz>

Thomas has sent me a new version which may fix this problem.  I will
take a look.
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Mon Apr 14 21:15:34 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Tue, 15 Apr 1997 08:15:34 +1200 (NZST)
Subject: R-alpha: problem with survival4 and ":="
Message-ID: <199704142015.IAA02571@stat1.stat.auckland.ac.nz>

I did indeed take := out.  If code is loaded with "library" these can
be converted to <-.

:= was one of those temporary hacks we put in place 5 years ago and
never got around to fixing.  We already have <- and <<- as assignment
operators.  This is one assignment too many (some would say two too
many).

If it is really critical I can put it back.  I only removed the
reference from the table of internal functions, the actual code is
still in place.
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Mon Apr 14 21:44:12 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Mon, 14 Apr 1997 13:44:12 -0700 (PDT)
Subject: R-alpha: problems qith require/provide
In-Reply-To: <199704142009.IAA02547@stat1.stat.auckland.ac.nz>
Message-ID: <Pine.SUN.3.91.970414132518.3839A-100000@chekov>

On Tue, 15 Apr 1997, Ross Ihaka wrote:

> Thomas has sent me a new version which may fix this problem.  I will
> take a look.
It doesn't completely.  A better solution is to do as Kurt suggested and 
put 
.Provided<-character(0)
in Rprofile.  The code at the end of this message then works.

Re: :=
The loss of := is not a problem now we know about it (I used sed to 
convert, Kurt used emacs), it was just a bit of a surprise at the time.
It's a good idea to get it killed off *before* we go to a beta version.


libraries:
R source files in the funs/ directory of a library are not used if their 
names begin with a capital letter [eg Rsurvival4, Rgee, Rdate  ;-)]

- thomas
--------------------------------------------------------------
require<- function (name, quietly = FALSE) 
{
  if (missing(name)) 
    return(TRUE)  
  name <- substitute(name)
  if (!is.character(name)) 
	  name <- deparse(name)
  if (is.na(match(name, .Libraries))&& is.na(match(name, .Provided))) {
    file <- system.file("library", name)
    if (file == "") {
      if (!quietly) 
	warning(paste("Required library ", name, " not found.\n"))
      return(FALSE)
    }
    if (!quietly) 
      cat("Autoloading required library:", name, "\n")
    sys.source(file)
    assign(".Libraries", c(name, .Libraries), NULL)
  }
  return(TRUE)
}


provide<-function(name)
{
  if (missing(name)) {
    return(list(provide=.Provided, library=.Libraries))
  }
  name<-substitute(name)
  if (!is.character(name))
    name<-deparse(name)
  if (is.na(match(name, .Libraries)) && is.na(match(name, .Provided))){
    assign(".Provided",c(name,.Provided),environment(NULL))
    return(TRUE)
  } 
  else 
    return(FALSE)
}
  

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Mon Apr 14 23:59:23 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 15 Apr 1997 00:59:23 +0200
Subject: R-alpha: select.frame
Message-ID: <x2ragd9po4.fsf@bush.kubism.ku.dk>

Here's the select.frame() function I babbled about before. Suggestions
about coding style, etc., are welcome, I feel a bit green at this.

select.frame<-
function (dfr, ...) 
{
        subst.exp <- function(e) {
                for (i in 2:length(e)) {
                        ei <- e[[i]]
                        if (is.call(ei)) 
                                e[[i]] <- subst.exp(ei)
                        else {
                                n <- match(as.character(ei), nm)
                                if (!is.na(n)) 
                                 e[[i]] <- n
                        }
                }
                e
        }
        nm <- names(dfr)
        e <- as.call(c(as.name("c"), expression(...)))
        dfr[, eval(subst.exp(e))]
}


-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Tue Apr 15 01:54:23 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Mon, 14 Apr 1997 17:54:23 -0700 (PDT)
Subject: R-alpha: D()
In-Reply-To: <9704090917.AA01943@>
Message-ID: <Pine.SUN.3.95.970414175127.18041A-100000@sulu>


D() doesn't handle exp() correctly:

R> D(expression(exp(sin(x))),"x")
sin(x) * cos(x)
R> D(expression(exp(x)),"x")
x


Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Tue Apr 15 15:23:06 1997
From: ihaka@stat.auckland.ac.nz (Ross &)
Date: Wed, 16 Apr 1997 02:23:06 +1200
Subject: R-alpha: D()
In-Reply-To: <Pine.SUN.3.95.970414175127.18041A-100000@sulu>
References: <9704090917.AA01943@>
 <Pine.SUN.3.95.970414175127.18041A-100000@sulu>
Message-ID: <199704151423.CAA06246@stat9.stat.auckland.ac.nz>

Thomas Lumley writes:
 > 
 > D() doesn't handle exp() correctly:
 > 

Duh!  Back to first year calculus for me.  It's
NOT

	d/dx e^f(x) = f(x) * f'(x).

BUT

	d/dx e^f(x) = e^f(x) * f'(x).

Deep down in the C function "D" in deriv.c you will find the lines

                else if(CAR(expr) == ExpSymbol) {
                        ans = simplify(TimesSymbol,
                                CADR(expr),
                                PP(D(CADR(expr), var)));
                        UNPROTECT(1);
                }

These should in fact read

                else if(CAR(expr) == ExpSymbol) {
                        ans = simplify(TimesSymbol,
                                expr,
                                PP(D(CADR(expr), var)));
                        UNPROTECT(1);
                }

I.e. remove the CADR from around the "expr" in the call to simplify.

This has clearly not been tested by anyone with a firm grasp of the
Newton/Leibnitz version of the calculus.  Use with care ...
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Tue Apr 15 13:07:20 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 15 Apr 1997 14:07:20 +0200
Subject: R-alpha: problem with survival4 and ":="
In-Reply-To: <199704142015.IAA02571@stat1.stat.auckland.ac.nz>
References: <199704142015.IAA02571@stat1.stat.auckland.ac.nz>
Message-ID: <199704151207.OAA07065@aragorn.ci.tuwien.ac.at>

>>>>> Ross Ihaka writes:

> I did indeed take := out.  If code is loaded with "library" these can
> be converted to <-.

> := was one of those temporary hacks we put in place 5 years ago and
> never got around to fixing.  We already have <- and <<- as assignment
> operators.  This is one assignment too many (some would say two too
> many).

> If it is really critical I can put it back.  I only removed the
> reference from the table of internal functions, the actual code is
> still in place.

I don't think we need it anymore.  As Thomas said, taking it out before
moving to beta was perfect ...

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Apr 15 20:31:33 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 15 Apr 97 21:31:33 +0200
Subject: R-alpha: Bug & Patch  in  dbeta.c  (0.50 - PreR 7)
Message-ID: <9704151931.AA01510@>

dbeta(1, a,b)  would return 1 instead of 0.

Here is the patch for  ..../src/math/dbeta.c :

--- dbeta.c~	Sun Nov 24 23:43:10 1996
+++ dbeta.c	Tue Apr 15 21:25:30 1997
@@ -23,9 +23,7 @@
 {
 	if (a <= 0.0 || b <= 0.0)
 		DOMAIN_ERROR;
-	if (x <= 0)
+	if (x <= 0 || x >= 1.0)
 		return 0.0;
-	if (x >= 1.0)
-		return 1.0;
 	return MATH_CHECK(pow(x, a - 1) * pow(1.0 - x, b - 1.0) / beta(a, b));
 }
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Tue Apr 15 20:57:33 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Tue, 15 Apr 1997 12:57:33 -0700 (PDT)
Subject: R-alpha: D()
In-Reply-To: <199704151423.CAA06246@stat9.stat.auckland.ac.nz>
Message-ID: <Pine.SUN.3.95.970415125504.21998A-100000@uhura>


R> D(expression(z * (log(z) /z)),"z")
Error: invalid form in unary minus check



 - thomas

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Tue Apr 15 21:02:55 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Tue, 15 Apr 1997 13:02:55 -0700 (PDT)
Subject: R-alpha: Bug & Patch  in  dbeta.c  (0.50 - PreR 7)
In-Reply-To: <9704151931.AA01510@>
Message-ID: <Pine.SUN.3.95.970415125913.21998B-100000@uhura>

On Tue, 15 Apr 1997, Martin Maechler wrote:

> dbeta(1, a,b)  would return 1 instead of 0.

Shouldn't it be 1 for b=1, Inf for b<1 and 0 for b>1 at x=1 (and similar
behaviour at x=0)?

ie 
double dbeta(double x, double a, double b)
{
        if (a <= 0.0 || b <= 0.0)
                DOMAIN_ERROR;
        if (x < 0)
                return 0.0;
        if (x > 1.0)
                return 0.0;
        return MATH_CHECK(pow(x, a - 1) * pow(1.0 - x, b - 1.0) / beta(a,
b));
}




Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Tue Apr 15 21:12:27 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Tue, 15 Apr 1997 13:12:27 -0700 (PDT)
Subject: R-alpha: Be nice to the English
In-Reply-To: <Pine.SUN.3.95.970415125913.21998B-100000@uhura>
Message-ID: <Pine.SUN.3.95.970415130444.21998C-100000@uhura>

Two suggestions for additions to Rprofile:

colours<-colors
optimise<-optimize

to provide aliases for the alternative spellings of these words.  As an
argument to a function we usually seem to use col= rather than colors=
which gets around that compatibility issue.  I don't know how much it
matters in R but I write \begin{itemise} instead of \begin{itemize} in
LaTeX with annoying regularity.

The aliases would also have to be added to the help pages for the relevant
functions.


Thomas Lumley


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Tue Apr 15 21:16:23 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Wed, 16 Apr 1997 08:16:23 +1200 (NZST)
Subject: R-alpha: D()
Message-ID: <199704152016.IAA24269@stat1.stat.auckland.ac.nz>

	R> D(expression(z * (log(z) /z)),"z")
	Error: invalid form in unary minus check

Yep. this is the result of an implete "if" statement in the C function
"isUminus" in deriv.c.  The function should read

static int isUminus(SEXP s)
{
	if(TYPEOF(s) == LANGSXP && CAR(s) == MinusSymbol) {
		switch(length(s)) { 
		case 2:
			return 1;
		case 3:
			if(CADDR(s) == R_MissingArg)
				return 1;
			else return 0;
		default:
			error("invalid form in unary minus check\n");
		}
	}
	else return 0;
}

This now gives

	> D(expression(z * (log(z) /z)),"z")
	(log(z)/z) + z * (1/z/z - log(z)/z^2)

which I thought was pretty ugly, but

	S-PLUS : Copyright (c) 1988, 1996 MathSoft, Inc.
	S : Copyright AT&T.
	Version 3.4 Release 1 for Sun SPARC, SunOS 4.1.3_U1 : 1996
	Working data will be in .Data
	> D(expression(z * (log(z) /z)),"z")
	(log(z)/z) + z * (1/z/z - log(z)/z^2)

So we are no worse than S.

And shame on you for trying to fool such a dumb bit of software :-).
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Apr 15 22:36:12 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 15 Apr 97 23:36:12 +0200
Subject: R-alpha: Buglet & patch  in  dbinom.c  (0.50 - PreR 7)
Message-ID: <9704152136.AA01576@>

dbinom(k, n, prob = 0) # or  prob=1   would not work;

The following patch makes it work (in  $RHOME/src/math/ ) :

--- dbinom.c~	Sun Nov 24 23:43:10 1996
+++ dbinom.c	Tue Apr 15 23:31:46 1997
@@ -23,9 +23,13 @@
 {
 	x = floor(x + 0.5);
 	n = floor(n + 0.5);
-	if (n <= 0.0 || p <= 0.0 || p >= 1.0)
+	if (n <= 0.0 || p < 0.0 || p > 1.0)
 		DOMAIN_ERROR;
 	if (x < 0.0 || x > n)
 		return 0.0;
+	if (p == 0.0)
+	        return (x == 0) ? 1.0 : 0.0;
+	if (p == 1.0)
+	        return (x == n) ? 1.0 : 0.0;
 	return exp(lfastchoose(n, x) + log(p) * x + (n - x) * log(1.0 - p));
 }
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Apr 15 22:52:01 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 15 Apr 97 23:52:01 +0200
Subject: R-alpha: Bug & Patch  in  dbeta.c  (0.50 - PreR 7)
In-Reply-To: <Pine.SUN.3.95.970415125913.21998B-100000@uhura> (message from
 Thomas Lumley on Tue, 15 Apr 1997 13:02:55 -0700 (PDT))
Message-ID: <9704152152.AA01582@>

Of course ! (--- silly me)

S-plus actually always returns 0 here;  but your solution is mathematically
correct where S is NOT!

The "bad" thing about R is only that we still don't have IEEE arithmetic.
Will get 'NA' instead of 'Inf'  ...


Thomas Lumley :
>> On Tue, 15 Apr 1997, Martin Maechler wrote:
>> 
>> > dbeta(1, a,b)  would return 1 instead of 0.
>> 
>> Shouldn't it be 1 for b=1, Inf for b<1 and 0 for b>1 at x=1 (and similar
>> behaviour at x=0)?
>> 
>> ie 
>> double dbeta(double x, double a, double b)
>> {
>>         if (a <= 0.0 || b <= 0.0)
>>                 DOMAIN_ERROR;
>>         if (x < 0)
>>                 return 0.0;
>>         if (x > 1.0)
>>                 return 0.0;
>>         return MATH_CHECK(pow(x, a - 1) * pow(1.0 - x, b - 1.0) / beta(a,
>> b));
>> }
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Apr 15 23:10:26 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 16 Apr 97 00:10:26 +0200
Subject: R-alpha: R0.50 Pre7 :  Bug in .Internal(print.default(.)...)
Message-ID: <9704152210.AA01600@>

> options()$digi
[1] 7
> (0:2)/1000 + 1e-10
[1]1e-3131e-3131e-313

-->  Hugh ?!?!  (it is NOT in computation just in printing !) :

> options(digits=8)
> 0:2/1000 + 1e-10
[1] 1.0000000e-10 1.0000001e-03 2.0000001e-03
> options(digits=5)
> 0:2/1000 + 1e-10
[1]1e-3131e-3131e-313
> 
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Tue Apr 15 23:54:00 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Wed, 16 Apr 1997 10:54:00 +1200 (NZST)
Subject: R-alpha: Re: select.frame
Message-ID: <199704152254.KAA25648@stat1.stat.auckland.ac.nz>

Peter Dalgaard writes:

> Here's the select.frame() function I babbled about before. Suggestions
> about coding style, etc., are welcome, I feel a bit green at this.

	[ function code omitted. ]

This is a very nice function!  One of the things I like about SAS is
the ability to specify ranges of variables.  I do have a couple of
suggestions.

1. The expression 

	e <- as.call(c(as.name("c"), expression(...)))

   can be written more concisely as

	e <- substitute(c(...))

2. As written, the function uses R scoping rules to pass the value of
   the variable "nm" into the body of "subst.exp", and so the function
   will not work in S.  It might be better to pass "nm" as an argument
   so that the function is portable.

3. It might be good to check that only ":" expressions allowed.


Here is a modified version version of the function which does the above.

select.frame<-
function (dfr, ...)
{
        subst.exp <- function(e, nm) {
                for (i in 2:length(e)) {
                        ei <- e[[i]]
                        if (is.name(ei)) {
                                n <- match(as.character(ei), nm)
                                if (!is.na(n))
                                        e[[i]] <- n
                        }
                        else if (is.call(ei) && as.character(ei[[1]]) == ":")
                                e[[i]] <- subst.exp(ei, nm)
                        else if (is.numeric(ei)) {
                                e[[i]] <- e[[i]]
                        }
                        else stop("invalid selection")
                }
                e
        }
        dfr[, eval(subst.exp(substitute(c(...)), names(dfr)))]
}

Here it is in action:

	> select.frame(iris,Sepal.Length:Petal.Length,Species)[1:5,]
	  Sepal.Length Sepal.Width Petal.Length Species
	1          5.1         3.5          1.4  setosa
	2          4.9         3.0          1.4  setosa
	3          4.7         3.2          1.3  setosa
	4          4.6         3.1          1.5  setosa
	5          5.0         3.6          1.4  setosa
	> 

Note that in S you can write

	as.character(ei[[1]]) == ":"

in the simpler form

	ei[[1]] == ":"

and I have made a change to (my version of) R to make this work.

Finally, it would be possible to use the forbidden black arts (i.e.
"Recall") to make the function body a single expression.  However
I would recommend that "Recall" never be used.  The function above is
more clearly written than a version using "Recall".

I also think that this idea is useful enough to generalized.  One
approach would be to make a generic function "select" and make the
function above the method for data frames - i.e. call it
select.data.frame.

Another idea would be to have "select" operate on name vectors in
general, rather than on just variable names in data frames.  Then the
same trick could be used to select rows as well as columns.
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Wed Apr 16 00:51:18 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 16 Apr 1997 01:51:18 +0200
Subject: R-alpha: Re: select.frame
In-Reply-To: Ross Ihaka's message of Wed, 16 Apr 1997 10:54:00 +1200 (NZST)
References: <199704152254.KAA25648@stat1.stat.auckland.ac.nz>
Message-ID: <x2u3l76e15.fsf@bush.kubism.ku.dk>

Ross Ihaka <ihaka@stat.auckland.ac.nz> writes:

> 2. As written, the function uses R scoping rules to pass the value of
>    the variable "nm" into the body of "subst.exp", and so the function
>    will not work in S.  It might be better to pass "nm" as an argument
>    so that the function is portable.

..and same thing applies to subst.exp itself, isn't that so? As
written, subst.exp would not be able to find subst.exp. Let's see:

[Splus]
> g<-function(n){f<-function(n)ifelse(n,1,n*f(n));f(n)}
> g(3)
Error in f(n): couldn't find function "f"
Dumped

Right. One of the major annoyances in S, actually. This has bugged be
always. You need to put the function in the "evaluation frame" or
define it globally. Maybe one should just leave it and let S solve the
porting problems? ;^)

> 3. It might be good to check that only ":" expressions allowed.

Hum. I was beginning to like the idea that you could put complicated
expressions in there, as in

select.frame(dfr, seq(visit1.1st, length=10, by=3))

when you have visit1.1st, visit1.2nd, visit1.3rd, .... visit10.3rd and
you want to look at the *.1st measurements. The semantics are that
variable names get replaced by their column numbers, if they exist in
the frame, and all that is required is that the resulting integer
expression makes sense. 

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Wed Apr 16 15:57:07 1997
From: ihaka@stat.auckland.ac.nz (Ross &)
Date: Thu, 17 Apr 1997 02:57:07 +1200
Subject: R-alpha: Re: select.frame
In-Reply-To: <x2u3l76e15.fsf@bush.kubism.ku.dk>
References: <199704152254.KAA25648@stat1.stat.auckland.ac.nz>
 <x2u3l76e15.fsf@bush.kubism.ku.dk>
Message-ID: <199704161457.CAA08074@stat9.stat.auckland.ac.nz>

Peter Dalgaard writes:
 > ..and same thing applies to subst.exp itself, isn't that so? As
 > written, subst.exp would not be able to find subst.exp. Let's see:

You are right of course.  Its been a while since I tried anything
substantial in S.

 >  Maybe one should just leave it and let S solve the
 > porting problems? ;^)

Sounds good to me, but I think its an interesting enough idea to get
a bit wider exposure.  You could always mention how much cleaner it is
in R :-).

 > > 3. It might be good to check that only ":" expressions allowed.
 > 
 > Hum. I was beginning to like the idea that you could put complicated
 > expressions in there, as in

By all means.  Whatever makes sense.
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Wed Apr 16 11:49:34 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 16 Apr 1997 12:49:34 +0200
Subject: R-alpha: CRAN announcement
Message-ID: <199704161049.MAA10469@aragorn.ci.tuwien.ac.at>

Attached is an updated version of the CRAN announcement, also to be sent
out as soon as 0.50 is out.  Again, please have a look if possible.

-k

************************************************************************
This is the first announcement of the

		   Comprehensive R Archive Network 
			        (CRAN)

CRAN is a collection of sites which carry identical material, consisting
of the R&R R distribution(s), the contributed extensions, documentation
for R, and binaries.

The CRAN master site can be found at the URL

	ftp://ftp.ci.tuwien.ac.at/pub/R		(Austria)

and is currently being mirrored daily at

	ftp://franz.stat.wisc.edu/pub/R		(U.S.A.)
	ftp://ftp.stat.math.ethz.ch/R-CRAN	(Switzerland)

This list should grow within soon.  If you want to become an official
CRAN mirror, please send me a note (Kurt.Hornik@ci.tuwien.ac.at).

Please use the CRAN site closest to you to reduce network load.

The structure of the CRAN tree is as follows.

	src/base		# Source distribution
	src/contrib		# Source for extensions
	doc/			# Documentation
	bin/<platform>		# Binaries

`src/base' contains the official R source distribution as provided by
Ross Ihaka and Robert Gentleman.

`src/contrib' contains code for extension packages.  Currently, there
are acepack, bootstrap, ctest, date, e1071, fracdiff, gee, jpn, oz,
snns, splines, and survival4.  Look at the INDEX file in this directory
for more specific information.  More packages are expected for the near
future.

`bin' is for prebuilt R binaries (the base distribution and extensions),
grouped according to platforms.  Currently, there are only experimental
packages for Debian GNU/Linux.  I hope that `.tar.gz' files with
contents relative to an installation tree (e.g. `bin/', `lib/R/', and
`man/man1/R.1') can be made available soon for all major supported Unix
platforms.

`doc' is for additional documentation and information on R.

In the short run, the process of `submitting' to CRAN is very simple:
upload to 

	ftp://ftp.ci.tuwien.ac.at/incoming

and drop me a note (Kurt.Hornik@ci.tuwien.ac.at).  Please indicate the
copyright situation (GPL, ...) in your submission.

In the long run, there will be a form to fill in, and some requirement
of authentication (PGPish, ...), and submission could maybe be done via
WWW.  I am open to suggestions here.

*****************************************************************************
*          Kurt Hornik         *                                            *
*  Dept of Statistics TU Wien  * tel:    +43 (1) 58801-4542                 *
*  Wiedner Hauptstr 8-10/1071  * fax:    +43 (1) 504-1498                   *
*          A-1040 Wien         * email:  Kurt.Hornik@ci.tuwien.ac.at        *
*            Austria           * WWW:    http://www.ci.tuwien.ac.at/~hornik *
*****************************************************************************
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Wed Apr 16 11:49:34 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 16 Apr 1997 12:49:34 +0200
Subject: R-alpha: R-FAQ
Message-ID: <199704161049.MAA10470@aragorn.ci.tuwien.ac.at>

Attached is an updated version of the FAQ, to be released right after
0.50 is out.  Please have a look, and let me know where improvements are
needed.

Thanks,
-k

*******************************************
  R FAQ
  Kurt Hornik
  v0.1-0, 1997/04/16

  This document contains answers to some of the most frequently asked
  questions about R.  Feedback is welcome.
  ______________________________________________________________________

  Table of Contents:

  1.	Introduction

  1.1.	Legalese

  1.2.	Obtaining this Document

  1.3.	Notation

  1.4.	Feedback

  2.	R Basics

  2.1.	What Is R?

  2.2.	What Machines Does R Run on?

  2.3.	What Is the Current Version of R?

  2.4.	How Can R Be Obtained?

  2.5.	How Can R Be Installed?

  2.5.1.  How Can R Be Installed (Unix)

  2.5.2.  How Can R Be Installed (Windows)

  2.5.3.  How Can R Be Installed (Macintosh)

  2.6.	Are there Unix Binaries for R?

  2.7.	Which Documentation Exists for R?

  2.8.	Which Mailing Lists Exist for R?

  2.9.	What is CRAN?

  3.	R and S

  3.1.	What Is S?

  3.2.	What Is S-PLUS?

  3.3.	What Are the Differences between R and S?

  4.	R Add-On Packages

  4.1.	Which Add-on Packages Exist for R?

  4.2.	How Can Add-on Packages Be Installed?

  4.3.	How Can Add-on Packages Be Used?

  4.4.	How Can I Contribute to R?

  5.	R and Emacs

  5.1.	Is there Emacs Support for R?

  5.2.	Should I Run R from Within Emacs?

  6.	R Miscellania

  6.1.	How Can I Read a Large Data Set into R?

  6.2.	Why Can't R Source a `Correct' File?

  6.3.	How Can I Set Components of a List to NULL?

  6.4.	How Can I Save My Workspace?

  6.5.	How Can I Clean Up My Workspace?

  7.	Acknowledgments
  ______________________________________________________________________

  1.  Introduction

  This document contains answers to some of the most frequently asked
  questions about R.

  1.1.	Legalese

  This document is free software; you can redistribute it and/or modify
  it under the terms of the GNU General Public License as published by
  the Free Software Foundation; either version 2, or (at your option)
  any later version.

  This program is distributed in the hope that it will be useful, but
  WITHOUT ANY WARRANTY; without even the implied warranty of
  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.	See the GNU
  General Public License for more details.

  If you do not have a copy of the GNU General Public License, write to
  the Free Software Foundation, 59 Temple Place - Suite 330, Boston, MA
  02111-1307, USA.

  1.2.	Obtaining this Document

  The latest version of this document is always available from
  http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html.

  From there, you can also obtain versions converted to plain ASCII
  text, DVI, and PostScript, as well as the SGML source used for
  creating all these formats using the SGML-Tools (formerly Linuxdoc-
  SGML) system.

  1.3.	Notation

  Everything should be pretty standard.	`R>' is used for the R prompt,
  and a `$' for the shell prompt (where applicable).

  1.4.	Feedback

  Feedback is of course most welcome.

  In particular, note that I do not have access to Windows or Mac
  systems.  If you have information on these systems that you think
  should be added to this document, please let me know.

  2.  R Basics

  2.1.	What Is R?

  R is a system for statistical computation and graphics.  It consists
  of a language plus a run-time environment with graphics, a debugger,
  access to certain system functions, and the ability to run programs
  stored in script files.

  The design of R has been heavily influenced by two existing languages:
  Becker, Chambers & Wilks' S (see question ``What is S?'') and
  Sussman's Scheme.  Whereas the resulting language is very similar in
  appearance to S, the underlying implementation and semantics are
  derived from Scheme.	See question ``What Are the Differences between
  R and S?'' for a discussion of the differences between R and S.

  R is being developed by Ross Ihaka and Robert Gentleman, two Senior
  Lecturers at the Department of Statistics of the University of
  Auckland in Auckland, New Zealand.

  R is free software distributed under a GNU-style copyleft.

  2.2.	What Machines Does R Run on?

  R is being developed for the Unix, Windows and Mac platforms.

  R will configure and build under a number of common Unix platforms
  including dec-alpha-osf, freebsd, hpux, linux-elf, sgi-irix, solaris,
  and sunos.  If you know about other platforms, please drop me a note.

  2.3.	What Is the Current Version of R?

  The current Unix version is 0.50, the previous one was 0.16.1.  The
  jump in the version number is deliberate, because 0.50 added group
  methods and complex numbers and hence more or less provides a full
  implementation of S as described in ``The New S Language''.

  The versions for Windows and Mac are pre-alpha.  With some good luck,
  the Windows version will soon catch up with the Unix version.

  2.4.	How Can R Be Obtained?

  Sources, binaries and documentation for R can be obtained via CRAN,
  the ``Comprehensive R Archive Network'' (see question ``What is
  CRAN?'').

  2.5.	How Can R Be Installed?

  2.5.1.  How Can R Be Installed (Unix)

  If binaries are available for your platform (see question ``Are there
  Unix Binaries for R?''), you can use these, following the instructions
  that come with them.

  Otherwise, you can compile and install R yourself, which can be done
  very easily under a number of common Unix platforms (see question
  ``What Machines Does R Run on?'').  The file INSTALL that comes with
  the R distribution contains instructions.

  Choose a place to install the R tree (R is not just a binary, but has
  additional data sets, help files, font metrics etc).	Let's call this
  place RHOME (given appropriate permissions, a natural choice would be
  `/usr/local/lib/R').	Untar the source code, and issue the following
  commands (at the shell prompt):

       $ ./configure
       $ make
       $ make install-help

  You can also build a LaTeX version of the manual entries with

       $ make install-latex

  and an HTML version of the manual with

       $ make install-html

  If these commands execute successfully, the R binary will be copied to
  the `$RHOME/bin' directory.  In addition, a shell script font-end
  called `R' will be created and copied to the same directory.	You can
  copy this script to a place where users can invoke it, for example to
  `/usr/local/bin'.  You could also copy the man page `R.1' to a place
  where your man reader finds it, such as `/usr/local/man/man1'.

  2.5.2.  How Can R Be Installed (Windows)

  Get the file `Rexe.zip' from the `bin/ms-windows' directory of a CRAN
  site.	This archive contains a binary Windows 3.xx distribution for R
  and installation instructions.

  Robert Gentleman has recently made an updated pre-alpha Windows
  executable file available for ftp at
  ftp://stat.auckland.ac.nz/pub/research/rgentlem/rbeta.zip.  This
  binary should be more compatible with Windows 95 than the other (he
  does not know about 3.1).  You still need all the other extra files
  from the previous Windows distribution, it is only an executable.

  2.5.3.  How Can R Be Installed (Macintosh)

  CRAN sites have a directory `bin/macintosh' which contains
  `R.sea.hqx', a binhexed self-extracting archive, and installation
  instructions in `README.MACINTOSH'.

  2.6.	Are there Unix Binaries for R?

  Experimental `.deb' packages for installation under Debian GNU/Linux
  can be found in `bin/ix86-linux'.  No other binaries distributions for
  Unix systems have thus far been made publically available.

  2.7.	Which Documentation Exists for R?

  Currently, there is no R manual.  Online documentation for most of the
  functions and variables in R exists, and can be printed on-screen by
  typing help(name) (or ?name) at the R prompt, where name is the name
  of the R object help is sought for.  (In the case of unary and binary
  operators and control-flow special forms, the name may need to be be
  quoted.)

  This documentation can also be made available as HTML, and as hardcopy
  via LaTeX, see question ``How Can R Be Installed?''.	An up-to-date
  HTML version is always available for web browsing at

       http://www.stat.math.ethz.ch/R-manual

  In the absence of a systematic introduction to R, one can mostly get
  along with introductions to S or S-PLUS, such as ``Notes on S-PLUS:  A
  Programming Environment for Data Analysis and Graphics'' by Bill
  Venables <venables@stats.adelaide.edu.au> and David Smith
  <D.M.Smith@lancaster.ac.uk>.	This document talks mostly about plain S
  features, and does not concentrate on features specific to S-PLUS, and
  is available from the Statlib S repository at
  http://lib.stat.cmu.edu/S/SplusNotes/ (LaTeX source and PostScript).
  An introduction to R based on it will soon be available.

  Last, but not least, Ross' and Robert's experience in designing and
  implementing R is described in:

       @Article{,
	 author =	{Ross Ihaka and Robert Gentleman},
	 title =	{R: {A} Language for Data Analysis and Graphics},
	 journal =	{Journal of Computational and Graphical Statistics},
	 year =		1996,
	 volume =	5,
	 number =	3,
	 pages =	{299--314}
       }

  This is also the reference for R to use in publications.

  2.8.	Which Mailing Lists Exist for R?

  Thanks to Martin Maechler <maechler@stat.math.ethz.ch>, there are
  three mailing lists devoted to R.

     r-announce
	This list is for announcements about the development of R and
	the availability of new code.

     r-devel
	This list is for discussions about the future of R and pre-
	testing of new versions.  It is meant for those who maintain an
	active position in the development of R.

     r-help
	The `main' R mailing list, for announcements about the
	development of R and the availability of new code, questions and
	answers about problems and solutions using R, enhancements and
	patches to the source code and documentation of R, comparison
	and compatibility with S and S-plus, and for the posting of nice
	examples and, benchmarks.

  To send a message to everyone on the r-help mailing list, send email
  to

       r-help@stat.math.ethz.ch

  To subscribe (or unsubscribe) to this list send subscribe (or unsub-
  scribe) in the BODY of the message (not in the subject!)  to r-help-
  request@stat.math.ethz.ch.  Information about the list can be obtained
  by sending an email with info as its contens to r-help-
  request@stat.math.ethz.ch.

  Subscription and posting to the other lists is done analogously, with
  `r-help' replaced by `r-announce' and `r-devel', respectively.  Note
  that the r-announce list is gatewayed into r-help, so you don't need
  to subscribe to both of them.

  It is recommended that you send mail to r-help rather than only to the
  R developers (who are also subscribed to the list, of course).  This
  may save them precious time they can use for constantly improving R,
  and will typically also result in much quicker feedback for yourself.

  Of course, in the case of bug reports it would be very helpful to have
  code which reliably reproduces the problem.

  The developers of R can be reached for comments and reports at
  R@stat.auckland.ac.nz.

  2.9.	What is CRAN?

  The ``Comprehensive R Archive Network'' (CRAN) is a collection of
  sites which carry identical material, consisting of the R
  distribution(s), the contributed extensions, documentation for R, and
  binaries.

  The CRAN master site can be found at the URL

       ftp://ftp.ci.tuwien.ac.at/pub/R/

  and is currently being mirrored daily at
       ftp://franz.stat.wisc.edu/pub/R/
       ftp://ftp.stat.math.ethz.ch/R-CRAN/

  Please use the CRAN site closest to you to reduce network load.

  The structure of the CRAN tree is as follows.

     `src/base'
	contains the official R distribution as provided by Ross Ihaka
	and Robert Gentleman.

     `src/contrib'
	contains code for extension packages.

     `doc'
	is for additional documentation and information on R.

     `bin'
	is for prebuilt R binaries (the base distribution and
	extensions), grouped according to platforms.  Currently, there
	are only experimental packages for Debian GNU/Linux.  I hope
	that `.tar.gz' files with contents relative to an installation
	tree (e.g. `bin', `lib/R/', and `man/man1/R.1') can be made
	available soon for all major supported Unix platforms.

  The process of ``submitting'' to CRAN currently is very simple: upload
  to ftp://ftp.ci.tuwien.ac.at/incoming and send email to Kurt Hornik
  <Kurt.Hornik@ci.tuwien.ac.at>.  Please indicate the copyright
  situation (GPL, ...) in your submission.

  3.  R and S

  3.1.	What Is S?

  S is a very high level language and an environment for data analysis
  and graphics.	S was written by Richard A. Becker, John M. Chambers,
  and Allan R. Wilks of AT&T Bell Laboratories Statistics Research
  Department.

  The primary references for S are two books by the creators of S.

  o  Richard A. Becker, John M. Chambers and Allan R. Wilks (1988),
     ``The New S Language,'' Chapman & Hall, London.

     This book is often called the ``Blue Book''.

  o  John M. Chambers and Trevor J. Hastie (1992), ``Statistical Models
     in S,'' Chapman & Hall, London.

     This is also called the ``White Book''.

  There is a huge amount of user-contributed code for S, available at
  the S Repository at CMU.

  See the ``Frequently Asked Questions about S''
  (http://lib.stat.cmu.edu/S/faq) for further information about S.

  3.2.	What Is S-PLUS?

  S-PLUS is a value-added version of S sold by Statistical Sciences,
  Inc. (now a division of Mathsoft, Inc.)  S is a subset of S-PLUS, and
  hence anything which may be done in S may be done in S-PLUS.	In
  addition S-PLUS has extended functionality in a wide variety areas,
  including robust regression, modern nonparametric regression, time
  series, survival analysis, multivariate analysis, classical
  statistical tests, quality control, and graphics drivers.  Add-on
  modules add additional capabilities for wavelet analysis, spatial
  statistics, and design of experiments.

  See the MathSoft S-PLUS page (http://www.mathsoft.com/splus.html) for
  further information.

  3.3.	What Are the Differences between R and S?

  Whereas the developers of R have tried to stick to the S language as
  defined in ``The New S Language'' (Blue Book, see question ``What is
  S?''), they have adopted the evaluation model of Scheme.

  This difference becomes manifest when free variables occur in a
  function.  Free variables are those which are neither formal
  parameters (occurring in the argument list of the function) nor local
  variables (created by assigning to them in the body of the function).
  Whereas S (like C) by default uses static scoping, R (like Scheme) has
  adopted lexical scoping.  This means the values of free variables are
  determined by a set of global variables in S, but in R by the bindings
  that were in effect at the time the function was created.

  Consider the following function:

       cube <- function(n) {
	 sq <- function() n * n
	 n * sq()
       }

  Under S, sq() does not ``know'' about the variable n unless it is
  defined globally:

       S> cube(2)
       Error in sq():  Object "n" not found
       Dumped
       S> n <- 3
       S> cube(2)
       [1] 18

  In R, the ``environment'' created when cube() was invoked is also
  looked in:

       R> cube(2)
       [1] 8

  Both R and S employ the principle of lazy evaluation, meaning that
  expressions are evaluated only when their values are needed in
  computations.	As one consequence of the above, S sometimes evaluates
  assignments in function argument lists (named arguments) immediately.
  I.e., S uses eager evaluation in these cases.	R always uses lazy
  evaluation.  (Folks, correct me if I am wrong here, but I think this
  was what caused Martin's function plot.step() to behave differently
  under R and S.)

  Lexical scoping allows using function closures and maintaining local
  state.  A simple example (taken from Abelson and Sussman) can be found
  in the `demos/language' subdirectory of the R distribution.  Further
  information is provided in the standard R reference ``R: A Language
  for Data Analysis and Graphics'' (see question ``Which Documentation
  Exists for R?'') and a paper on ``Lexical Scope and Statistical
  Computing'' by Robert Gentleman and Ross Ihaka which can be obtained
  from the `doc/misc' directory of a CRAN site.

  Lexical scoping also implies a further major difference.  Whereas S
  stores all objects as separate files in a directory somewhere (usually
  `.Data' under the current directory), R does not.  All objects in R
  are stored internally.  When R is started up it grabs a very large
  piece of memory and uses it to store the objects.  R performs its own
  memory management of this piece of memory.  Having everything in
  memory is necessary because it is not really possible to externally
  maintain all relevant ``environments'' of symbol/value pairs.	This
  difference also seems to make R much faster than S.

  The down side is that if R crashes you will lose all the work for the
  current session.  Saving and restoring the memory ``images'' (the
  functions and data stored in R's internal memory at any time) can be a
  bit slow, especially if they are big.	In S this does not happen,
  because everything is saved in disk files and if you crash nothing is
  likely to happen to them.  R is still in an alpha stage, and does
  crash from time to time.  Hence, for important work you should
  consider saving often, see question ``How Can I Save My Workspace?''
  (other possibilities are logging your sessions, or have your R
  commands stored in text files which can be read in using source()).

  Apart from lexical scoping and its implications, R follows the S
  language definition in the Blue Book as much as possible, and hence
  really is an ``implementation'' of S.	There are some intentional
  differences where the behavior of S is considered ``not clean''.  In
  general, the rationale is that R should help you detect programming
  errors, while at the same time being as compatible as possible with S.

  Some known differences are the following.

  o  In R, if x is a list, then x[sub] <- NULL and x[[sub]] <- NULL
     remove the specified elements from x.  The first of these is
     incompatible with S, where it is a no-op.

  o  In S, the functions named .First and .Last in the `.Data' directory
     can be used for customizing, as they are executed at the very
     beginning and end of a session, respectively.  R looks for files
     called `.Rprofile' in the user's home directory and the current
     directory, and sources these.  (It also loads a saved image from
     `.RData' in case there is one.)  If a .First function exists then,
     it is executed.  The .Last mechanism is not supported yet.

  o  Attaching library sections works differently.  In S, library(name)
     adds the data directory for the library section name to the search
     list.  If a function object named `.First.lib' exists in the
     directory, it is executed; this is typically used to dynamically
     load compiled code required by the functions in the section.  In R,
     library(name) currently simply sources the file
     $RHOME/library/name, and compiled code can be loaded by calling
     library.dynam() in this file.  The .First.lib mechanism is not
     really supported.	(Note that a library file is only loaded once,
     so that any code in the library that is not in a function is
     executed the first time the library is loaded.)

  o  R does not try as hard as S to preserve dimnames attributes
     (examples are apply, rbind, and cbind, but also arithmetic ops).

  o  R presently does not support IEEE Inf and NaN.

  o  In R, attach currently only works for lists and data frames (not
     for directories).

  o  Categories do not exist in R, and never will as they are deprecated
     now in S.	Use factors instead.

  o  In R, For() loops are not necessary and hence not supported.

  o  In R, assign() uses the argument envir= rather than where= as in S.

  o  The random number generators are different, and the seeds have
     different length.

  o  The glm family objects are implemented differently in R and S.  The
     same functionality is available but the components have different
     names.

  o  terms objects are stored differently.  In S a terms object is an
     expression with attributes, in R it is a formula with attributes.
     The attributes have the same names but are mostly stored
     differently.  The major difference in functionality is that a terms
     object is subscriptable in S but not in R.	If you can't imagine
     why this would matter then you don't need to know.

  There are also differences which are not intentional, and result from
  missing or incorrect code in R.  The developers would appreciate
  hearing about any deficiencies you may find (in a written report fully
  documenting the difference as you see it).  Of course, it would be
  useful if you were to implement the change yourself and make sure it
  works.

  4.  R Add-On Packages

  4.1.	Which Add-on Packages Exist for R?

  The R distribution comes with the following extra libraries:

     eda
	Exploratory Data Analysis.  Currently only contains functions
	for robust line fitting, and median polish and smoothing.

     mva
	Multivariate Analysis.	Currently contains code for principal
	components (prcomp), canonical correlations (cancor),
	hierarchichal clustering (hclust), and metric multidimensional
	scaling (cmdscale).  More functions for clustering and scaling,
	biplots, profile and star plots, and code for ``real''
	discriminant analysis will be added soon.

  The following packages are available from the CRAN `src/contrib' area.

     acepack
	ace (Alternating Conditional Expectations) and avas (Additivity
	and variance stabilization for regression) for selecting
	regression transformations.

     bootstrap
	Software (bootstrap, cross-validation, jackknife), data and
	errata for the book ``An Introduction to the Bootstrap'' by B.
	Efron and R. Tibshirani, 1993, Chapman and Hall.

     ctest
	A library of classical tests, including the Bartlett, Fisher,
	Kruskal-Wallis, Kolmogorov-Smirnov, and Wilcoxon tests.

     date
	Functions for dealing with dates.  The most useful of them
	accepts a vector of input dates in any of the forms 8/30/53,
	30Aug53, 30 August 1953, ..., August 30 53, or any mixture of
	these.

     e1071
	Miscellaneous functions used at the Department of Statistics at
	TU Wien (E1071).

     fracdiff
	Maximum likelihood estimation of the parameters of a
	fractionally differenced ARIMA(p,d,q) model (Haslett and
	Raftery, Applied Statistics, 1989).

     gee
	An implementation of the Liang/Zeger generalized estimating
	equation approach to GLMs for dependent data.

     jpn
	A function to plot Japan's coast-line and prefecture boundaries.

     oz Functions for plotting Australias coastline and state
	boundaries.

     snns
	An R interface to the Stuttgart Neural Networks Simulator
	(SNNS).

     splines
	Regression spline functions.

     survival4
	Functions for survival analysis (requires splines).

  See CRAN `src/contrib/INDEX' for more information.

  Paul Gilbert <pgilbert@bank-banque-canada.ca> has a written a
  multivariate time series library for S called time.series that is
  mostly converted to run in R.	He will make this port generally
  available when complex numbers are implemented (see question ``What is
  the current version of R?'').

  According to Paul, the PADI interface from the Bank of Canada also
  works with minor changes.  PADI can be used to access Fame time series
  data bases and potentially other databases, even remotely over the
  Internet.  For further information see http:www.bank-banque-
  canada.ca/pgilbert.

  According to Arne Kovac <A.Kovac@Bristol.ac.uk>, Guy Nason's
  WaveThresh package for S worked with only minor modifications under R
  version 0.12.
  More code has been posted to the r-help mailing list, and can be
  obtained from the mailing list archive.

  4.2.	How Can Add-on Packages Be Installed?

  (Unix only.)	Untar the add-on packages in $RHOME/src/library/ and
  type

       $ make libs
       $ cd ../..
       $ ./etc/install-libhelp

  at the shell prompt.

  4.3.	How Can Add-on Packages Be Used?

  To find out which add-ons have already been installed, type

       R> library()

  at the R prompt.  This produces something like

       NAME	    DESCRIPTION
       acepack	 ace() and avas() for selecting regression transformations
       bootstrap       Functions for the book "An Introduction to the Bootstrap"
       ctest	   Classical Tests
       date	    Functions for handling dates
       eda	     Exploratory Data Analysis
       fracdiff	Fractionally differenced ARIMA (p,d,q) models
       gee	     Generalized Estimating Equation models
       mva	     Classical Multivariate Analysis
       splines	 Regression spline functions
       survival4       Survival analysis [needs library(splines)]

  You can ``load'' an add-on with name name by

       R> library(name)

  You can then find out which functions it provides by typing

       R> help(library = name)

  4.4.	How Can I Contribute to R?

  R is currently still in alpha (or pre-alpha) state, so simply using it
  and communicating problems is certainly of great value.
  One place where functionality is still missing is the modeling
  software as described in ``Statistical Models in S'' (see question
  ``What is S?''.  The functions

	add1 kappa alias labels drop1 proj

  are missing; many of these are interpreted functions so anyone that is
  bored and wants to have a go at implementing them it would be appreci-
  ated.	In addition, only linear and generalized linear models are cur-
  rently available, aov, gam, loess, tree, and the nonlinear modelling
  code are not there yet.

  Many of the packages available at the Statlib S Repository might be
  worth porting to R.

  If you are interested in working on any of these projects, please
  notify Kurt Hornik.

  5.  R and Emacs

  5.1.	Is there Emacs Support for R?

  There is an Emacs-Lisp interface to S/S-PLUS called S-mode.  Its
  current version is 4.8 and can be obtained at
  http://www.maths.lancs.ac.uk:2080/~maa036/elisp/S-mode/.  The earlier
  versions which can be found at the Statlib S repository (gnuemacs3 and
  gnuemacs4) are outdated.

  It contains code for interacting with an inferior S process from
  within Emacs including an interface to the help system, editing S
  source code, and transcript manipulation, and comes with detailed
  instructions for installation.

  Martin Maechler <maechler@stat.math.ethz.ch> and Tony Rossini
  <rossini@math.sc.edu> have integrated support for R into this package.
  The current version is at

       ftp://ftp.math.sc.edu/rossini/S-mode-4.8.MM6.XE2.tar.gz

  and runs under both GNU Emacs and XEmacs.

  To install, put the byte-compiled `.el' files into a place where Emacs
  can find them, and add

       (if (not (assoc "\\.R$" auto-mode-alist)
	   (add-to-list 'auto-mode-alist (cons "\\.R$" 'R-mode))))
       (autoload 'R "S" "Run an inferior R process" t)
       (autoload 'R-mode "S" "Mode for editing R source" t)
       (autoload 'r-mode "S" "Mode for editing R source" t)

  to one of your Emacs startup files, typically `~/.emacs'.  You can
  then fire up R from within Emacs by typing `M-x R' (note however that
  many interface functions will not work), and if you use the extension
  `.R' for your files with R code, Emacs will automagically turn on R
  edit mode whenever you visit such a file.

  Tony Rossini, Martin Maechler and Kurt Hornik have officially taken
  over the development of S-mode.  Version 4.9 (based on the current
  4.8.MM series) will be released shortly;  version 5.0 (codenamed
  ``istat'') should be out by the end of 1997.

  5.2.	Should I Run R from Within Emacs?

  Yes.	Inferior R mode provides a readline/history mechanism, object
  name completion, and syntax-based highlighting of the interaction
  buffer using Font Lock mode, as well as a very convenient interface to
  the R help system.  Of course, it also integrates nicely with the
  mechanisms for editing R source using Emacs.

  6.  R Miscellania

  6.1.	How Can I Read a Large Data Set into R?

  R (currently) uses a static memory model.  This means that when it
  starts up, it asks the operating system to reserve a fixed amount of
  memory for it.  The size of this chunk cannot be changed subsequently.
  Hence, it can happen that not enough memory was allocated.

  In these cases, you should restart R with more memory available, using
  the command line options -n and -v.  To understand these options, one
  needs to know that R maintains separate areas for fixed and variable
  sized objects.  The first of these is allocated as an array of
  SEXPRECs assembled in a list using ``cons cells'' (ordered pairs each
  containing an element of the list and a pointer to the next cell), and
  the second as an array of VECRECs.  The -n option can be used to
  specify the number of cons cells (each occupying 16 bytes) which R is
  to use (the default is 200000), and the -v option to specify the size
  of the vector heap in megabytes (the default is 2).  Only integers are
  allowed for both options.

  E.g., to read in a table of 5000 observations on 40 numeric variables,
  R -v 6 should do.

  Note that the information where to find vectors and strings on the
  heap is stored using cons cells.  Thus, it may also be necessary to
  allocate more space for cons cells in order to perform computations
  with very ``large'' variable-size objects.

  You can find out the current memory comsumption by typing gc() at the
  R prompt.

  6.2.	Why Can't R Source a `Correct' File?

  R sometimes has problems parsing a file which does not end in a
  newline.  This can happen for example when Emacs is used for editing
  the file and next-line-add-newlines is set to nil.  To avoid the
  problem, either set require-final-newline to a non-nil value in one of
  your Emacs startup files, or make sure R-mode (see question ``Is there
  Emacs Support for R?'') is used for editing R source files (which
  locally ensures this setting).

  Earlier R versions had a similar problem when reading in data files,
  but this should have been taken care of now.

  6.3.	How Can I Set Components of a List to NULL?

  You can use

       x[i] <- list(NULL)

  to set component i of the list x to NULL, similarly for named compo-
  nents.  Do not set x[i] or x[[i]] to NULL, because this will remove
  the corresponding component from the list.

  For dropping the row names of a matrix x, it may be easier to use
  rownames(x) <- NULL, similarly for column names.

  6.4.	How Can I Save My Workspace?

  The expression

       save(list = ls(), file = ".RData")

  saves the objects in the currently active environment (typically the
  user's .GlobalEnv) to the file `.RData' in the R startup directory.

  6.5.	How Can I Clean Up My Workspace?

  To remove all objects in the currently active environment (typically
  the user's .GlobalEnv), you can do

       rm(list = ls())

  7.  Acknowledgments

  Of course, many many thanks to Robert and Ross for the R system, and
  to the package writers and porters for adding to it.

  Special thanks go to Peter Dalgaard, Paul Gilbert, Martin Maechler,
  and Anthony Rossini for their comments which helped me improve this
  FAQ.

  More to some soon ...

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Friedrich.Leisch@ci.tuwien.ac.at  Wed Apr 16 17:17:25 1997
From: Friedrich.Leisch@ci.tuwien.ac.at (Friedrich Leisch)
Date: Wed, 16 Apr 1997 18:17:25 +0200
Subject: R-alpha: data in contributed packages
Message-ID: <199704161617.SAA14180@galadriel.ci.tuwien.ac.at>


I know, we've discussed this several times in the good old days days
of the R-testers list :-), but the problem is still unsolved.

I want to include Tibshirani's data in my port of the bootstrap
package, but we still have no way of including data in a clean way.

IMHO we should have a subdirectory of $RHOME/data for each library,
e.g.
	$RHOME/data/base
	$RHOME/data/bootstrap

Actually that's the setup we are currently using here in Vienna.

We've modified the filename script to reflect that changes (which also
allows users to have a R hierarchy with library, data, etc in
~/lib/R):


*********** original filename *********** =20

#!/bin/sh

file=3D$RHOME/$1/$2

if [ -r $file ]
then
        echo $file
else
        echo
fi



*********** our filename *********** =20

#!/bin/sh

for file in $HOME/lib/R/$1/$2 \         # user R hierarchy
            $RHOME/$1/$2 \              # standard dirs
            $RHOME/$1/[^.]*/$2;         # one level of subdirs
do
    if [ -r $file ]
    then
        echo $file
        break
    fi
done

if [ ! -r $file ]
then
    echo
fi


****************************

Any comments, ... ?

Best,
Fritz

PS: In a best of all possible worlds one should of course have some
recursive searching like in TeX :-)

--=20
---------------------------------------------------------------------
                         Friedrich  Leisch                            =20
 Institut f=FCr Statistik                      Tel: (+43 1) 58801 4541
 Technische Universit=E4t Wien                 Fax: (+43 1)  504 14 98
 Wiedner Hauptstra=DFe 8-10/1071      Friedrich.Leisch@ci.tuwien.ac.at
 A-1040 Wien, Austria             http://www.ci.tuwien.ac.at/~leisch
      PGP public key http://www.ci.tuwien.ac.at/~leisch/pgp.key
---------------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Thu Apr 17 10:05:11 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Thu, 17 Apr 1997 11:05:11 +0200
Subject: R-alpha: R-0.50.b6:  bug in graphics demo
Message-ID: <199704170905.LAA14424@aragorn.ci.tuwien.ac.at>

The line
  contour(volcano, x, y, l, col = "yellow", lty = "solid", add = TRUE)
needs to be changed to
  contour(x, y, volcano, col = "yellow", lty = "solid", add = TRUE)

A patch is appended below.

-k

*** demos/graphics/graphics.orig	Thu Apr 17 11:02:39 1997
--- demos/graphics/graphics	Thu Apr 17 11:03:08 1997
*************** plot(numeric(0), numeric(0), NULL,
*** 129,135 ****
  	type="n", ann=FALSE)
  usr <- par("usr")
  rect(usr[1], usr[3], usr[2], usr[4], col="green3")
! contour(volcano, x, y, l, col="yellow", lty="solid", add=TRUE)
  box()
  title("A Topographic Map of Maunga Whau",font=4)
  title(xlab="Meters North", ylab="Meters West", font=3)
--- 129,135 ----
  	type="n", ann=FALSE)
  usr <- par("usr")
  rect(usr[1], usr[3], usr[2], usr[4], col="green3")
! contour(x, y, volcano, col="yellow", lty="solid", add=TRUE)
  box()
  title("A Topographic Map of Maunga Whau",font=4)
  title(xlab="Meters North", ylab="Meters West", font=3)
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Thu Apr 17 10:33:40 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 17 Apr 1997 11:33:40 +0200
Subject: R-alpha: R-0.50.b6:  bug in graphics demo
In-Reply-To: Kurt Hornik's message of Thu, 17 Apr 1997 11:05:11 +0200
References: <199704170905.LAA14424@aragorn.ci.tuwien.ac.at>
Message-ID: <x2encaxabv.fsf@bush.kubism.ku.dk>

Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

> 
> The line
>   contour(volcano, x, y, l, col = "yellow", lty = "solid", add = TRUE)
> needs to be changed to
>   contour(x, y, volcano, col = "yellow", lty = "solid", add = TRUE)
> 

The help file for image() has the same problem, both in the USAGE and
EXAMPLES section. And while we're at it: the ALIASes should contain
"contour", not "image", right?

BTW: Ross seems to have quietly put out an R7.tgz (compiling as I type
this) and forgotten to tell us about it...

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Thu Apr 17 11:12:44 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 17 Apr 1997 12:12:44 +0200
Subject: R-alpha: fitted = 0 of 1 in logistic regression
Message-ID: <x2d8rux8ir.fsf@bush.kubism.ku.dk>


TASK:   problem with "glm" with binomial errors
STATUS: Open
FROM:   p.dalgaard@kubism.ku.dk
        in glm(,binomial) it's possible that loss of significant
        digits make expected values 0 or 1 even though there's no
        divergence of the fit.  (Happened to me with menarche data,
        infants and grown-ups included)
        [ Need the example data.  Glm needs a complete overhaul. ]

OK, here's a way to fake some data (simulated as if menarche occurs
uniformly between 10 an 15 years of age) There's no real problem with
fitting a logistic regression to this, but the logistic curve gets too
close to 0 and 1 for the very young and the very old.

BTW: rbinom gives NA for p=0 and p=1, which causes some problems with
the simulations. 
BTW2: Doesn't "occurred" take a double r?

> fake.age<-runif(500,0,50)
> fake.menarche<-rbinom(500,1,.99999 *(fake.age > 15) + .99999 * (fake.age > 10 & fake.age <= 15)/5 * (fake.age - 10)+.000005)
> glm(fake.menarche~fake.age,binomial)
Error: fitted probabilities of 0 or 1 occured
> fake2.age<-fake.age[fake.age<25&fake.age>5]
> fake2.menarche<-fake.menarche[fake.age<25&fake.age>5]
> glm(fake2.menarche~fake2.age,binomial)

Call:  glm(fake2.menarche ~ fake2.age, binomial) 

Coefficients:
(Intercept)    fake2.age  
   -15.1061       1.2011  

Degrees of Freedom: 189 Total; 187 Residual
Null Deviance: 253.9 
Residual Deviance: 48.73 
> 


-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Thu Apr 17 11:36:03 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Thu, 17 Apr 1997 22:36:03 +1200 (NZST)
Subject: R-alpha: R-0.50.b6:  bug in graphics demo
Message-ID: <199704171036.WAA08581@stat1.stat.auckland.ac.nz>

> BTW: Ross seems to have quietly put out an R7.tgz (compiling as I type
> this) and forgotten to tell us about it...

Don't expect much difference.  That was just so that Martin M could
check whether configuration and compilation with Fortran would work
under Solaris.

If you people would just stop finding bugs, I could a real version
ready ... :-).  We have a week break from teaching next week.  So
if not tomorrow, hopefully then.

[ Actually I have to confess I've been playing networks - getting a PPP
  connection from home going.  Which is what I'm using at present.
  Infinitely nicer than using "tip". ]
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Thu Apr 17 15:09:36 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Thu, 17 Apr 1997 16:09:36 +0200
Subject: R-alpha: R-0.50.b6:  bug in graphics demo
In-Reply-To: <199704171036.WAA08581@stat1.stat.auckland.ac.nz>
References: <199704171036.WAA08581@stat1.stat.auckland.ac.nz>
Message-ID: <199704171409.QAA25593@aragorn.ci.tuwien.ac.at>

>>>>> Ross Ihaka writes:

>> BTW: Ross seems to have quietly put out an R7.tgz (compiling as I type
>> this) and forgotten to tell us about it...

> Don't expect much difference.  That was just so that Martin M could
> check whether configuration and compilation with Fortran would work
> under Solaris.

And nevertheless, my bug log got almost halved ...

> If you people would just stop finding bugs, I could a real version
> ready ... :-).  We have a week break from teaching next week.  So
> if not tomorrow, hopefully then.

O.k.  I PROMISE I won't send any more bug reports, as I am dying to see
0.50 out :-)

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Thu Apr 17 15:43:33 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 17 Apr 1997 16:43:33 +0200
Subject: R-alpha: The list of *open* tasks
In-Reply-To: Kurt Hornik's message of Thu, 17 Apr 1997 16:09:36 +0200
References: <199704171036.WAA08581@stat1.stat.auckland.ac.nz>
 <199704171409.QAA25593@aragorn.ci.tuwien.ac.at>
Message-ID: <x2n2qxsoa1.fsf_-_@bush.kubism.ku.dk>

Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

> And nevertheless, my bug log got almost halved ...

Apropos bug logs. It's getting a bit boring to wade through all of the
bugs in the TASKS file that have already been fixed. Here's a little
something I cooked up earlier today: 

---------------------------cut------
#!/bin/sh
awk '
/^TASK/                         {task = $0}
/^STATUS/ && $2~/[Oo]pen/       {print task; doprint=1}
doprint 
/^-------/                      {doprint=0}' TASKS
---------------------------cut------

Put into (say) list-open-tasks in the $RHOME and chmod +x. Execute
from $RHOME.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From la-jassine@aix.pacwan.net  Fri Apr 18 10:33:09 1997
From: la-jassine@aix.pacwan.net (Paul Gilbert)
Date: Fri, 18 Apr 1997 06:33:09 -0300
Subject: R-alpha: data in contributed packages
Message-ID: <1350716654-1304675@aix.pacwan.net>

Friedrich

Regarding the location of data for libraries it might be easier if
everything for one library is included in one subdirectory. At least it
would certainly be easier to clean-up, which I like to do every few years.
Thus the code file, data, and any compiled code would be in one subdirectory
under $RHOME/library. 

I realize this means a small change to the way libraries are now found, but
in the end I think it would be much cleaner.

Paul

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Sun Apr 20 17:40:06 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 20 Apr 1997 18:40:06 +0200
Subject: R-alpha: Playing the tag game
Message-ID: <x2rag5r6l5.fsf@bush.kubism.ku.dk>

Here are a handful of oddities in pre0.50-7 (at some risk of reprisals
from people waiting for the real 0.50...):

I was mucking about trying to figure out how to know which tags has
been used in a function call, and some weird stuff happened.

----------
A call with tagged arguments is something like a list, the tags
can be used to access elements, but the names attribute is absent,
until the call is coerced to a list. (Attempting to set the names()
causes evaluation. Changing "list" to "blipblop" causes an 'Error:
couldn't find function "blipblop"' at that point.)

> j<-substitute(list(a=1,b=2))
> j
list(a = 1, b = 2)
> j$b
[1] 2
> names(j)
NULL
> names(j)<-NULL
> j
[[1]]
[1] 1

[[2]]
[1] 2
-----------
This one is plainly a bug. Meaningless, but...

[Previously saved workspace restored]

> j<-as.call(list(a=1,b=2))
> j
Segmentation fault (core dumped)
------------
Strange... as.call should return its argument if is.call is true?

> j<-substitute(list(a=1,b=2))
> j
list(a = 1, b = 2)
> as.call(j)
Error in as.call(j) : invalid argument list
> is.call(j)
[1] TRUE

------------
Ok, the right solution seems to be names(as.list(j)), but then we run
into some other fun with NA's... Shouldn't the real NA print without
quotes?

> ch[1]<-paste("N","A",sep="") 
> is.na(ch)
[1] FALSE FALSE FALSE
> ch
[1] "NA" "a"  "b" 
> ch[1]=="NA"
[1] TRUE
> ch[1]<-"NA"                 
> is.na(ch)
[1]  TRUE FALSE FALSE
> 

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Sun Apr 20 21:43:35 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Mon, 21 Apr 1997 08:43:35 +1200 (NZST)
Subject: R-alpha: Playing the tag game
Message-ID: <199704202043.IAA28435@stat1.stat.auckland.ac.nz>

	Here are a handful of oddities in pre0.50-7 (at some risk of reprisals
	from people waiting for the real 0.50...):

I don't know that these will even be looked at before 0.49 :-) comes
out.  I'm checking portabity and configuration at present.  It would
be REALLY nice if commercial vendors could stick to the standards
(ANSI, POSIX ...) as well as the free software developers do.

	I was mucking about trying to figure out how to know which tags has
	been used in a function call, and some weird stuff happened.

	----------
	A call with tagged arguments is something like a list, the tags
	can be used to access elements, but the names attribute is absent,
	until the call is coerced to a list. (Attempting to set the names()
	causes evaluation. Changing "list" to "blipblop" causes an 'Error:
	couldn't find function "blipblop"' at that point.)

	> j<-substitute(list(a=1,b=2))
	> j
	list(a = 1, b = 2)
	> j$b
	[1] 2
	> names(j)
	NULL
	> names(j)<-NULL
	> j
	[[1]]
	[1] 1

	[[2]]
	[1] 2

This is an oversight, and should have a one line fix (add extra cases
to an existing switch).

	[Previously saved workspace restored]

	> j<-as.call(list(a=1,b=2))
	> j
	Segmentation fault (core dumped)
	------------
	Strange... as.call should return its argument if is.call is true?

	> j<-substitute(list(a=1,b=2))
	> j
	list(a = 1, b = 2)
	> as.call(j)
	Error in as.call(j) : invalid argument list
	> is.call(j)
	[1] TRUE

"as.call" is pretty new and unexercised.

	Ok, the right solution seems to be names(as.list(j)), but then we run
	into some other fun with NA's... Shouldn't the real NA print without
	quotes?

	> ch[1]<-paste("N","A",sep="") 
	> is.na(ch)
	[1] FALSE FALSE FALSE
	> ch
	[1] "NA" "a"  "b" 
	> ch[1]=="NA"
	[1] TRUE
	> ch[1]<-"NA"                 
	> is.na(ch)
	[1]  TRUE FALSE FALSE
	> 

You naughty boy! :-)  I've have always thought that using "NA" to
indicate a missing string value was asking for problems.  What happens
when some poor unsuspecting user starts abbreviating "North America"
for example.

We use a bottleneck at string creation time to check whether the string
being stored is "NA".  If it is, we return the address of a special
unique string.  That way we can check for NA by simply doing an address
comparison rather than a string comparison (this is the same trick we
use for comparing variable names).  This doesn't catch "NA" strings
made in the underhand fashion above.

I see a couple of possible solutions.

1.  Remain compatible with S and just unoptimise our detection of
    string NAs.

2.  Be incompatible with S and introduce a real NA for strings.
    This would print as NA rather than "NA".  I like this second
    solution, but its does violate the "prime directive" (be
    compatible).

Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Tue Apr 22 13:08:08 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 22 Apr 1997 14:08:08 +0200
Subject: R-alpha: data in contributed packages
In-Reply-To: <1350716654-1304675@aix.pacwan.net>
References: <1350716654-1304675@aix.pacwan.net>
Message-ID: <199704221208.OAA00678@aragorn.ci.tuwien.ac.at>

>>>>> Paul Gilbert writes:

> Friedrich

> Regarding the location of data for libraries it might be easier if
> everything for one library is included in one subdirectory. At least
> it would certainly be easier to clean-up, which I like to do every few
> years.  Thus the code file, data, and any compiled code would be in
> one subdirectory under $RHOME/library.

Like

	library/<section>/
	library/<section>/data
	library/<section>/exec		(scripts and or binaries which
					 only make sense for the add-on)
	library/<section>/funs
	library/<section>/help
	library/<section>/html
	library/<section>/objs		(*.so)

???

> I realize this means a small change to the way libraries are now
> found, but in the end I think it would be much cleaner.

I think the changes would not be too hard, and we need to do something
about the directory structure anyway.

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Apr 22 14:07:28 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 22 Apr 97 15:07:28 +0200
Subject: R-alpha:  contributed packages -- Yes, use library/<package>/.. !
Message-ID: <9704221307.AA01047@>


>>>>> "Kurt" == Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

>>>>> Paul Gilbert writes:
    >> Friedrich

    >> Regarding the location of data for libraries it might be easier if
    >> everything for one library is included in one subdirectory. At least
    >> it would certainly be easier to clean-up, which I like to do every
    >> few years.  Thus the code file, data, and any compiled code would be
    >> in one subdirectory under $RHOME/library.

    Kurt> Like

    Kurt> library/<section>/
    Kurt> library/<section>/data
    Kurt> library/<section>/exec		(scripts and or binaries which
    Kurt> 				         only make sense for the add-on)
    Kurt> library/<section>/funs
    Kurt> library/<section>/help
    Kurt> library/<section>/html
    Kurt> library/<section>/objs		(*.so)

    Kurt> ???

    >> I realize this means a small change to the way libraries are now
    >> found, but in the end I think it would be much cleaner.

I agree completely.

Kurt, you surely feel like doing it for us ... ;-)

-- Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Tue Apr 22 14:50:43 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 22 Apr 1997 15:50:43 +0200
Subject: R-alpha: lazy evaluation and plot.step()
Message-ID: <199704221350.PAA01188@aragorn.ci.tuwien.ac.at>

Today I received an email which made me realize that what I wrote in the
FAQ explaining the different behavior of Martin's plot.step() under R
and S is not really true.

Does someone understand what is going on in the following?

"test" <-
function(x, y, xlab = deparse(substitute(x)), ylab = deparse(substitute(y)))
{
  x <- sort(x)
  print(xlab)
  n <- length(x)
  y <- (1:n) / n
  print(ylab)
}

Under R,

R> test(4:1)
[1] "c(1, 2, 3, 4)"
[1] "c(0.25, 0.5, 0.75, 1)"
R> test(4:1, 4)
[1] "c(1, 2, 3, 4)"
[1] "c(0.25, 0.5, 0.75, 1)"

Under S,

> test(4:1)
[1] "4:1"
[1] ""
[1] ""
> test(4:1, 4)
[1] "4:1"
[1] "c(0.25, 0.5, 0.75, 1)"
[1] "c(0.25, 0.5, 0.75, 1)"

???

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Tue Apr 22 16:18:46 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 22 Apr 1997 17:18:46 +0200
Subject: R-alpha: lazy evaluation and plot.step()
In-Reply-To: Kurt Hornik's message of Tue, 22 Apr 1997 15:50:43 +0200
References: <199704221350.PAA01188@aragorn.ci.tuwien.ac.at>
Message-ID: <x2u3kz9jc9.fsf@bush.kubism.ku.dk>


The explanation seems to be in different behaviour of the
substitute(...) construction:

R:
> f<-function(a,b){a<-1; print(deparse(substitute(c(a,b))))}
> f(a,b)
[1] "c(1, b)"

Splus:
> f<-function(a,b){a<-1; print(deparse(substitute(c(a,b))))}
> f(a,b)
[1] "c(a, b)"
[1] "c(a, b)"

So in R, assignment to a formal parameter causes the changed value to
be used for substitution purposes.

In S, this does not happen *unless the formal parameter is a
constant.*!

> f(2,b)
[1] "c(1, b)"
[1] "c(1, b)"
> f(2:2,b)
[1] "c(2:2, b)"
[1] "c(2:2, b)"
> f("a",b)    
[1] "c(1, b)"
[1] "c(1, b)"

This is confusing in both languages, but I'd say that S has the bigger
problem...

In Kurts example, inserting 

xlab 
ylab

as the first two lines of the function defeats lazy evaluation and
provides the desired behaviour (I suppose) in both R and S.

	- Peter

----

Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

> "test" <-
> function(x, y, xlab = deparse(substitute(x)), ylab = deparse(substitute(y)))
> {
>   x <- sort(x)
>   print(xlab)
>   n <- length(x)
>   y <- (1:n) / n
>   print(ylab)
> }
> 
> Under R,
> 
> R> test(4:1)
> [1] "c(1, 2, 3, 4)"
> [1] "c(0.25, 0.5, 0.75, 1)"
> R> test(4:1, 4)
> [1] "c(1, 2, 3, 4)"
> [1] "c(0.25, 0.5, 0.75, 1)"
> 
> Under S,
> 
> > test(4:1)
> [1] "4:1"
> [1] ""
> [1] ""
> > test(4:1, 4)
> [1] "4:1"
> [1] "c(0.25, 0.5, 0.75, 1)"
> [1] "c(0.25, 0.5, 0.75, 1)"
> 
> ???


-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Tue Apr 22 16:43:29 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 22 Apr 1997 17:43:29 +0200
Subject: R-alpha: binom.test
Message-ID: <199704221543.RAA01232@aragorn.ci.tuwien.ac.at>

I just realized that I got the code for the p-value (two-sided case) of
my ctest's binom.test wrong (again).  Anyway, before I fix that:  does
anyone know why S binom.test computes the p-value as it does?  (Any
references?)

Thanks,
-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Tue Apr 22 17:13:29 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 22 Apr 1997 18:13:29 +0200
Subject: R-alpha:  contributed packages -- Yes, use library/<package>/.. !
In-Reply-To: <9704221307.AA01047@>
References: <9704221307.AA01047@>
Message-ID: <199704221613.SAA01350@aragorn.ci.tuwien.ac.at>

>>>>> Martin Maechler writes:

>>>>> "Kurt" == Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

>>>>> Paul Gilbert writes:
>>> Friedrich

>>> Regarding the location of data for libraries it might be easier if
>>> everything for one library is included in one subdirectory. At least
>>> it would certainly be easier to clean-up, which I like to do every
>>> few years.  Thus the code file, data, and any compiled code would be
>>> in one subdirectory under $RHOME/library.

Kurt> Like

Kurt> library/<section>/
Kurt> library/<section>/data
Kurt> library/<section>/exec		(scripts and or binaries which
Kurt>                                    only make sense for the add-on)
Kurt> library/<section>/funs
Kurt> library/<section>/help
Kurt> library/<section>/html
Kurt> library/<section>/objs		(*.so)

Kurt> ???

>>> I realize this means a small change to the way libraries are now
>>> found, but in the end I think it would be much cleaner.

> I agree completely.

:-)

> Kurt, you surely feel like doing it for us ... ;-)

Actually, I think if R&R ok'ed something like that, Fritz and I would
take a look.

(In a way, I NEED to do something like that anyway, because I promised
it for making an official Debian package ...)

Would it mean that we also employ the S library/section concept?

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Tue Apr 22 17:23:24 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 22 Apr 1997 18:23:24 +0200
Subject: R-alpha: Rprofiles
Message-ID: <x2sp0j9gcj.fsf@bush.kubism.ku.dk>

The x11() window can be a nuisance to have popping up at startup (esp.
on small screens) when you're not working with graphics. However,
currently you can't get rid of it without modifying the systemwide
Rprofile. 

Current logic is:

Run $RHOME/library/Rprofile
if ./.Rprofile exists
	run it
else if $HOME/.Rprofile exists
	run that
endif

I think it should be

Run $RHOME/library/Rsetup
if ./.Rprofile exists
	run it
else if $HOME/.Rprofile exists
	run that
else if $RHOME/library/Rprofile exists
	run that
endif

i.e. essential system initialisation goes in Rsetup, the rest in
Rprofile, which can be overridden by the user. Currently, the line

if(interactive()) x11()

is the candidate to move from one to the other. BTW, it really should read

if(interactive() && getenv("DISPLAY")!="") x11()

[BTW2: getenv() implemented using system()? is that really necessary?]
-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Tue Apr 22 17:30:52 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 22 Apr 1997 18:30:52 +0200
Subject: R-alpha: Rprofiles
In-Reply-To: <x2sp0j9gcj.fsf@bush.kubism.ku.dk>
References: <x2sp0j9gcj.fsf@bush.kubism.ku.dk>
Message-ID: <199704221630.SAA01413@aragorn.ci.tuwien.ac.at>

>>>>> Peter Dalgaard BSA writes:

> The x11() window can be a nuisance to have popping up at startup (esp.
> on small screens) when you're not working with graphics. However,
> currently you can't get rid of it without modifying the systemwide
> Rprofile. 

> Current logic is:

> Run $RHOME/library/Rprofile
> if ./.Rprofile exists
> 	run it
> else if $HOME/.Rprofile exists
> 	run that
> endif

> I think it should be

> Run $RHOME/library/Rsetup
> if ./.Rprofile exists
> 	run it
> else if $HOME/.Rprofile exists
> 	run that
> else if $RHOME/library/Rprofile exists
> 	run that
> endif

> i.e. essential system initialisation goes in Rsetup, the rest in
> Rprofile, which can be overridden by the user.

I more or less agree, BUT:

I'd like (in the future) to have the system-wide Rprofile searched in a
site-specific location as well (similar to Emacs, following the idea of
keeping the distribution and the site-specific things apart).

So it would be
	system-wide Rsetup (which should basically be platform-specific
	  stuff, cause otherwise it could go into base as well?)
        if .Rprofile exists run it else
	if ~/.Rprofile exists run it else
        if Rprofile exists on the default library search path, run it

and that search path could e.g. specify all `library' trees with a
compile-time default of

	~/lib/R:/usr/local/lib/R/site:/usr/local/lib/R/${version}

and settable at run time via e.g. the environment variable R_PATH.

> Currently, the line

> if(interactive()) x11()

> is the candidate to move from one to the other. BTW, it really should read

> if(interactive() && getenv("DISPLAY")!="") x11()

Correct.  We've been making the same change with all upgrades :-)

> [BTW2: getenv() implemented using system()? is that really necessary?]

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Tue Apr 22 17:33:36 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 22 Apr 1997 18:33:36 +0200
Subject: R-alpha: lazy evaluation and plot.step()
In-Reply-To: <x2u3kz9jc9.fsf@bush.kubism.ku.dk>
References: <199704221350.PAA01188@aragorn.ci.tuwien.ac.at>
 <x2u3kz9jc9.fsf@bush.kubism.ku.dk>
Message-ID: <199704221633.SAA01423@aragorn.ci.tuwien.ac.at>

>>>>> Peter Dalgaard BSA writes:

> The explanation seems to be in different behaviour of the
> substitute(...) construction:

> R:
>> f<-function(a,b){a<-1; print(deparse(substitute(c(a,b))))}
>> f(a,b)
> [1] "c(1, b)"

> Splus:
>> f<-function(a,b){a<-1; print(deparse(substitute(c(a,b))))}
>> f(a,b)
> [1] "c(a, b)"
> [1] "c(a, b)"

> So in R, assignment to a formal parameter causes the changed value to
> be used for substitution purposes.

> In S, this does not happen *unless the formal parameter is a
> constant.*!

>> f(2,b)
> [1] "c(1, b)"
> [1] "c(1, b)"
>> f(2:2,b)
> [1] "c(2:2, b)"
> [1] "c(2:2, b)"
>> f("a",b)    
> [1] "c(1, b)"
> [1] "c(1, b)"

> This is confusing in both languages, but I'd say that S has the bigger
> problem...

Not a surprise ...

Thanks, Peter, for the explanation.  Does this also explain the
different results for x <- sort(x)?

> In Kurts example, inserting 

> xlab 
> ylab

> as the first two lines of the function defeats lazy evaluation and
> provides the desired behaviour (I suppose) in both R and S.

Yes.  This is also what I suggested to Martin in order to have a version
of plot.step() which does the same under R and S.

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Wed Apr 23 07:45:30 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 23 Apr 1997 08:45:30 +0200
Subject: R-alpha: CRAN
Message-ID: <199704230645.IAA03912@aragorn.ci.tuwien.ac.at>

Just wanted to point out that statlib has also become an official CRAN
mirror with the URL

	http://lib.stat.cmu.edu/R/CRAN/

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Wed Apr 23 09:05:33 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 23 Apr 97 10:05:33 +0200
Subject: R-alpha: Re: R-beta: 0.50 --> 0.49 'available' ((official ???)
In-Reply-To: <9704230756.AA07463@alpha.luc.ac.be> (message from Jim Lindsey on
 Wed, 23 Apr 1997 09:56:34 +0200 (MET DST))
Message-ID: <9704230805.AA01351@>

Hi Jim,
	[CC: only to R-devel,
	  since I expect  R&R  to ANNOUNCE  0.49 OFFICIALLY
	  on  R-announce (and hence R-help)
	]

This night, our mirror software got version 0.49  (=?= pre-release of 0.50 ??)
from the usual R-ftp-directory from Auckland.

Ross & Robert:  You ARE going to announce this on R-announce, yes?

-- Martin
	
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Wed Apr 23 16:28:37 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 23 Apr 1997 17:28:37 +0200
Subject: R-alpha: Re: R-beta: Version 0.49 Released
In-Reply-To: <199704230925.VAA24453@stat1.stat.auckland.ac.nz>
References: <199704230925.VAA24453@stat1.stat.auckland.ac.nz>
Message-ID: <199704231528.RAA14692@aragorn.ci.tuwien.ac.at>

>>>>> Ross Ihaka writes:

> The newest version of R for Unix (version 0.49) is now available
> (or soon will be) from the following sites.

> ...

I noticed the following problems (all already reported, but not in
TASKS).

* TASKS.OLD has

FROM:   <Kurt.Hornik@ci.tuwien.ac.at>
        Btw, here's another way to produce a segfault with admittedly
        nonsense code:
                R> x <- 1:5
                R> dimnames(x)[1,2] <- NULL
                Segmentation fault
        [ Hmmm.  This seems to have gone away.  I get the error     ]
        [ message "Error: incorrect number of subscripts on array". ]

On my Linux system, I still get the segfault.  Perhaps others could
check that?

* File permissions in data should be 644.

* In src/unix/system.c, one `Rdata' should be `RData' (d -> D).

* The documentation for the noncentral chisquare distribution is not
quite correct.  (rnchisq does not exist, the existing functions have x,
df and the noncentrality parameter as args, and the density should be

   pnchisq(x, df, lambda)
   = exp(-lambda / 2)
     * sum_{r=0}^\infty \frac{lambda^r}{2^r r!} pchisq(x, df + 2r)

(semiTeX notation only, sorry).

******************

New minor remarks:

* The documentation for `image' still has the old order z, x, y.

* Perhaps one should add `par(ask = T)' in the image demo?

* Perhaps one should save the original value of par() at the beginning
of the graphics demo, and restore that at its end (s.t. typically asking
is turned off again).

******************

Overall, REALLY GREAT!  Thanks for putting out the official release ...

Best,
-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From rossini@stat.sc.edu  Wed Apr 23 16:45:29 1997
From: rossini@stat.sc.edu (Anthony Rossini)
Date: 23 Apr 1997 11:45:29 -0400
Subject: R-alpha: Re: R-beta: Version 0.49 Released
In-Reply-To: Kurt Hornik's message of Wed, 23 Apr 1997 17:28:37 +0200
References: <199704230925.VAA24453@stat1.stat.auckland.ac.nz> <199704231528.RAA14692@aragorn.ci.tuwien.ac.at>
Message-ID: <wnc7mht9206.fsf@fhat.stat.sc.edu>


>>>>> "Kurt" == Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:


    Kurt> I noticed the following problems (all already reported, but
    Kurt> not in TASKS).

 Kurt> * TASKS.OLD has

    Kurt> FROM: <Kurt.Hornik@ci.tuwien.ac.at>
    Kurt>         Btw, here's another way to produce a segfault with
    Kurt>         admittedly nonsense code:
    R> x <- 1:5 dimnames(x)[1,2] <- NULL
    Kurt>                 Segmentation fault
    Kurt>         [ Hmmm.  This seems to have gone away.  I get the
    Kurt>         error ] [ message "Error: incorrect number of
    Kurt>         subscripts on array". ]

    Kurt> On my Linux system, I still get the segfault.  Perhaps
    Kurt> others could check that?


segfault on Solaris 2.5.1, as well:


fhat 73 > R

R : Copyright 1997, Robert Gentleman and Ross Ihaka
Version 0.49 Beta (April 23, 1997)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type "license()" for details.

> x <- 1:5
> dimnames(x)[1,2] <- NULL
Segmentation fault (core dumped)
fhat 74 > gdb bin/R.binary core
GDB is free software and you are welcome to distribute copies of it
 under certain conditions; type "show copying" to see the conditions.
There is absolutely no warranty for GDB; type "show warranty" for details.
GDB 4.15.1 (sparc-sun-solaris2.4), 
Copyright 1995 Free Software Foundation, Inc...
Core was generated by `/p1/apps/R/src/R-0.49/bin/R.binary'.
Program terminated with signal 11, Segmentation fault.

#0  0x254f0 in allocArray (mode=16, dims=0x175770) at array.c:124
124                     n = n * INTEGER(dims)[i];
(gdb) where
#0  0x254f0 in allocArray (mode=16, dims=0x175770) at array.c:124
#1  0xa6a0c in listAssign1 (call=0x2fb0a4, x=0x175770, subs=0x2fb0cc, 
    y=0x175770) at subassign.c:922
#2  0xa7650 in do_subassign (call=0x2fb0a4, op=0x1760bc, args=0x2fb090, 
    rho=0x17d1c8) at subassign.c:1119
#3  0x59b28 in eval (e=0x2fb0a4, rho=0x17d1c8) at eval.c:137
#4  0x5b630 in applydefine (call=0x2fafc8, op=0x175f40, args=0x2fafb4, 
    rho=0x17d1c8) at eval.c:625
#5  0x5b984 in do_set (call=0x2fafc8, op=0x175f40, args=0x2fafb4, rho=0x17d1c8)
    at eval.c:666
#6  0x59b28 in eval (e=0x2fafc8, rho=0x17d1c8) at eval.c:137
#7  0x65978 in R_Repl (rho=0x17d1c8, savestack=0, browselevel=0) at main.c:187
#8  0x65f4c in mainloop () at main.c:359
#9  0xcd6fc in main (ac=0, av=0xeffffa14) at system.c:267
(gdb) 



----
-tony (Anthony Rossini)	           Statistics Dept., U South Carolina
rossini@stat.sc.edu	           Columbia, SC 29208
http://www.stat.sc.edu/~rossini/   803-777-3578(O) 803-777-4048 (fax)  
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Wed Apr 23 16:59:29 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 23 Apr 1997 17:59:29 +0200
Subject: R-alpha: Re: R-beta: Version 0.49 Released
In-Reply-To: Kurt Hornik's message of Wed, 23 Apr 1997 17:28:37 +0200
References: <199704230925.VAA24453@stat1.stat.auckland.ac.nz>
 <199704231528.RAA14692@aragorn.ci.tuwien.ac.at>
Message-ID: <x2vi5d3f32.fsf@bush.kubism.ku.dk>

Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

> Overall, REALLY GREAT!  Thanks for putting out the official release ...

Agreed. How's the Win32 version coming along? 

And BTW how does the source code in the src/windows directory fit in?
Where's the Makefile, which compiler, which libraries, etc...

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From luke@stat.umn.edu  Wed Apr 23 17:22:38 1997
From: luke@stat.umn.edu (Luke Tierney)
Date: Wed, 23 Apr 1997 11:22:38 -0500 (CDT)
Subject: R-alpha: libraries, modules, namespaces, ...
Message-ID: <9704231622.AA10729@nokomis.stat.umn.edu>

Now that 0.49 has left the dock (great job Ross and Robert!) here is a
more global issue that may be worth thinking about. I haven't seen any
discussion along these lines yet, but maybe I missed it -- if so,
never mind.

One of the weaknesses of S for building larger packages that can be
used together is the lack of any namespace management facility.
Newer languages like Java, Dylan, Perl, Python, Fortran 90, etc., all
provide some variant of a module system with control over what gets
exported from and imported to modules. I believe something of that
flavor would be very useful in R (or any system). Lots of variations
are possible -- SML probably has the fanciest system of any I know,
Common Lisp's packages are arguably at the other end. An outline of
what might be needed:

	For module writers
		specify scope of module (part of file, all of file,
		several files?)

		specify exports, i.e. things that are to be (easily)
		accessible when the module is used.

	For module users
		simple importing (all exported things from a module)

		selective importing (just bring in some exported things)

		importing with renaming (to avoid conflicts)?

		maybe introspection tools to dig out private things in
		a module (mainly for debugging -- maybe this should not
		be supported).

With R's lexical scoping the ability to implement a module system
exists, e.g a module could be created as

mymodule <- (function() {
  import(other.module)
  f<-function() { .... }
  g<-function() { .... f() .... }
  list(h=g)
})()

which is supposed to export g under the name h but hides f.
An import function could do something like

import<-function(module) {
  assign values to names in caller's frame
}

Lots of scheme module systems use closures for module systems more or
less along these lines. It would be nice to have some nicer syntax, like

mymodule <- module (other.module) {
  ...
  export(...)
}

or whatever seems most natural (also depends on whether you want to
allow several modules per file, several files per module, or thether
modules have anything to do with files at all).

Making S code into an R module would (aside from dealing with
whatever incompatibilities there might be) just involve adding the
module wrapper and deciding what to export.

If being able to maintain common S and R sources seems important, modules
could be specified with a comment convention as in PostScript, emacs
mode lines, etc., something like

#@&^!R-MODULE mymodule
#@&^!R-IMPORT other.module
....
#@&^!R-EXPORT h=f, k, ...

The provide/require functions do a different but related job and would
need to be considered as part of such a design.

Just some food for thought.

luke


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From rgentlem@stat.auckland.ac.nz  Thu Apr 24 02:19:55 1997
From: rgentlem@stat.auckland.ac.nz (Robert Gentleman)
Date: Thu, 24 Apr 1997 13:19:55 +1200 (NZST)
Subject: R-alpha: Windows
Message-ID: <199704240119.NAA00278@stat3.stat.auckland.ac.nz>


 There is a alpha version of R for Windows95 available from 
  stat.auckland.ac.nz  in pub/research/rgentlem/RApril.zip

 Please have a look and a play and let me know what needs to be fixed.
 It should be about a (0.48 release)

robert
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Thu Apr 24 07:11:51 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Thu, 24 Apr 1997 08:11:51 +0200
Subject: R-alpha: libraries, modules, namespaces, ...
In-Reply-To: <9704231622.AA10729@nokomis.stat.umn.edu>
References: <9704231622.AA10729@nokomis.stat.umn.edu>
Message-ID: <199704240611.IAA17238@aragorn.ci.tuwien.ac.at>

>>>>> Luke Tierney writes:

> Now that 0.49 has left the dock (great job Ross and Robert!) here is a
> more global issue that may be worth thinking about. I haven't seen any
> discussion along these lines yet, but maybe I missed it -- if so,
> never mind.

> One of the weaknesses of S for building larger packages that can be
> used together is the lack of any namespace management facility.

> ...

Definitely.

> ...

> Just some food for thought.

Very cool!  Do you think that if we have modules, we should get rid of
the `library' mechanism altogether?  

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Thu Apr 24 07:51:32 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Thu, 24 Apr 1997 08:51:32 +0200
Subject: R-alpha: Re: R-beta: multiple binary types
In-Reply-To: <Pine.SUN.3.91.970423185754.10880F-300000@babcomm>
References: <Pine.SUN.3.91.970423185754.10880F-300000@babcomm>
Message-ID: <199704240651.IAA17442@aragorn.ci.tuwien.ac.at>

>>>>> Gregory R Warnes writes:

> I've modified the "$RHOME/bin/R" and "$RHOME/cmd/filename" so that you 
> can use the same directories for multiple machines.  That is, machines 
> running various flavors of UNIX can access the same directories.

> The modified structure adds the directories

> $RHOME/bin/$OSTYPE/
> $RHOME/lib/$OSTYPE/

> to hold the machine specific binaries.

> For instance, here the $RHOME directory contains two subdirectories,

> $RHOME/bin/solaris/
> $RHOME/bin/sunos4/

> which each hold the appropriate R.binary file.  

> These two modified functions assume that the environment variable $OSTYPE 
> is appropriately set, as is done automatically by the shell tcsh.  If it 
> is not set, the directory names collapse to the original values,
> 	$RHOME/bin/ and $RHOME/lib/

> ...

Is OSTYPE defined by POSIX?  I tried bash, ksh and csh on my Debian
GNU/Linux system.  Whereas all have it, we have

	bash, ksh:	Linux
	tcsh, csh:	linux

which is unfortunate but one could live with that (lowercasing ...).
The real problem is that the OS Linux exists on several hardware
platforms (ix86, alpha, solaris, m68k, ...), so one would really need

	${OSTYPE}-${HOSTTYPE}

Again not knowing what POSIX says, here are the results:

	bash, ksh:	i386
	tcsh, csh:	i386-linux

OH NO!

***

Note also that whereas the suggestion is perfect for binaries, it is in
a way `orthogonal' to rearranging the R tree into

	<library>/<section>/<type>

structure ... hmm, or should we have <platform> dirs for exec and objs?

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Thu Apr 24 07:54:55 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Thu, 24 Apr 1997 08:54:55 +0200
Subject: R-alpha: R-0.49:  RE postscript()
Message-ID: <199704240654.IAA17458@aragorn.ci.tuwien.ac.at>

R&R,

It also seems that pictex() is broken.  I've only taken a quick look,
but I think the reason is that

	.Internal(device("pictex", as.character(c(file)), c(width, 
                height, debug, bg, fg)))

should have bg and fg with the character args, and the driver code needs
to be updated accordingly ...

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Friedrich.Leisch@ci.tuwien.ac.at  Thu Apr 24 08:07:55 1997
From: Friedrich.Leisch@ci.tuwien.ac.at (Friedrich Leisch)
Date: Thu, 24 Apr 1997 09:07:55 +0200
Subject: R-alpha: Re: R-beta: multiple binary types
In-Reply-To: <199704240651.IAA17442@aragorn.ci.tuwien.ac.at>
References: <Pine.SUN.3.91.970423185754.10880F-300000@babcomm>
 <199704240651.IAA17442@aragorn.ci.tuwien.ac.at>
Message-ID: <199704240707.JAA11914@galadriel.ci.tuwien.ac.at>

>>>>> On Thu, 24 Apr 1997 08:51:32 +0200,
>>>>> Kurt Hornik wrote:

> ...

> Note also that whereas the suggestion is perfect for binaries, it is in
> a way `orthogonal' to rearranging the R tree into

> 	<library>/<section>/<type>

> structure ... hmm, or should we have <platform> dirs for exec and objs?

IMHO we should definetely have platform-dirs for everything that's
possibly platform-dependent ... resulting in something like

	<library>/<section>/<type>

e.g. for R code and

	<library>/<section>/<type>/<platform>

e.g. for exec and dynload-objects.

for exec there's a problem though, as some exec's are
shell/perl/whatever-scripts and *should* work on any platform
...  

.f
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Thu Apr 24 10:11:51 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Thu, 24 Apr 1997 21:11:51 +1200 (NZST)
Subject: R-alpha: Postscript bug ...
Message-ID: <199704240911.VAA05630@stat1.stat.auckland.ac.nz>

Jeez I dunno - it compiles perfectly and you guys get excited just because
it doesn't work :-)

I have to admit to being baffled about what happened (I'm SURE this was
working not long ago), but here is a quick fix.  The problem is in the
function "GetCharInfo" in the file src/unix/PostScript.c.

The fix is to change the statement

	if(nchar < 0)
		return 0;

to
	if(nchar < 0)
		return 1;

as indicated in the #ifdefs below.  I will make a patch file and put
it the archive with the .tgz file.

We seem to have enough problem reports to justfy getting a new 0.50 out
pretty soon in any case.

	Ross

- - - replacement - - GetCharInfo - - -

static int GetCharInfo(char *buf, FontMetricInfo *metrics)
{
	char *p = buf;
	int nchar;

	if(!MatchKey(buf, "C "))
		return 0;
	p = SkipToNextItem(p);
	sscanf(p, "%d", &nchar);
	if(nchar < 0)
#ifdef OLD
		return 0;
#else
		return 1;
#endif
	p = SkipToNextKey(p);

	if(!MatchKey(p, "WX"))
		return 0;
	p = SkipToNextItem(p);
	sscanf(p, "%hd", &(metrics->CharInfo[nchar].WX));
	p = SkipToNextKey(p);

	if(!MatchKey(p, "N "))
		return 0;
	p = SkipToNextKey(p);

	if(!MatchKey(p, "B "))
		return 0;
	p = SkipToNextItem(p);
	sscanf(p, "%hd %hd %hd %hd",
		&(metrics->CharInfo[nchar].BBox[0]),
		&(metrics->CharInfo[nchar].BBox[1]),
		&(metrics->CharInfo[nchar].BBox[2]),
		&(metrics->CharInfo[nchar].BBox[3]));

#ifdef DEBUG
	printf("nchar = %d %d %d %d %d %d\n", nchar,
		metrics->CharInfo[nchar].WX,
		metrics->CharInfo[nchar].BBox[0],
		metrics->CharInfo[nchar].BBox[1],
		metrics->CharInfo[nchar].BBox[2],
		metrics->CharInfo[nchar].BBox[3]);
#endif
	return 1;
}
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Thu Apr 24 10:35:41 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Thu, 24 Apr 1997 21:35:41 +1200 (NZST)
Subject: R-alpha: R-0.49 Patch #1
Message-ID: <199704240935.VAA06050@stat1.stat.auckland.ac.nz>

This patch corrects the broken postscript graphics driver.
If you have already done it by hand ignore this.

Apply this patch within the R-0.49 directory.

The patch is also at the auckland.ftp site and soon at mirrors.
	Ross


*** src/unix/PostScript.c.orig	Thu Apr 24 21:28:27 1997
--- src/unix//PostScript.c	Thu Apr 24 21:28:51 1997
***************
*** 160,166 ****
  	if(!MatchKey(buf, "C ")) return 0;
  	p = SkipToNextItem(p);
  	sscanf(p, "%d", &nchar);
! 	if(nchar < 0) return 0;
  	p = SkipToNextKey(p);
  
  	if(!MatchKey(p, "WX")) return 0;
--- 160,166 ----
  	if(!MatchKey(buf, "C ")) return 0;
  	p = SkipToNextItem(p);
  	sscanf(p, "%d", &nchar);
! 	if(nchar < 0) return 1;
  	p = SkipToNextKey(p);
  
  	if(!MatchKey(p, "WX")) return 0;
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Thu Apr 24 10:58:59 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 24 Apr 1997 11:58:59 +0200
Subject: R-alpha: Postscript bug ...
In-Reply-To: Ross Ihaka's message of Thu, 24 Apr 1997 21:11:51 +1200 (NZST)
References: <199704240911.VAA05630@stat1.stat.auckland.ac.nz>
Message-ID: <x2bu74vj18.fsf@bush.kubism.ku.dk>

Ross Ihaka <ihaka@stat.auckland.ac.nz> writes:

> We seem to have enough problem reports to justfy getting a new 0.50 out
> pretty soon in any case.

A succession of 0.49.n's would be better, I'd say. Preferably using
patches from 0.49 for those with slow links, but that's not all that
important. Heck, it's only 10 minutes across a 14k4 modem (but it took
more than an hour to transfer R7.tgz from here to Kurt in Vienna the
other day - that's between two sites with direct net connections...).

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Thu Apr 24 11:01:40 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Thu, 24 Apr 1997 22:01:40 +1200 (NZST)
Subject: R-alpha: Postscript bug ...
Message-ID: <199704241001.WAA06175@stat1.stat.auckland.ac.nz>

> A succession of 0.49.n's would be better, I'd say. Preferably using
> patches from 0.49 for those with slow links, but that's not all that
> important. Heck, it's only 10 minutes across a 14k4 modem (but it took
> more than an hour to transfer R7.tgz from here to Kurt in Vienna the
> other day - that's between two sites with direct net connections...).

And here was I thinking that the steam-driven abacus we use for
R development was low tech ...

I will try to send out "important" patches, but its hard to maintain
distinct branches and we have already diverged from 0.49 here.
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Andreas.Weingessel@ci.tuwien.ac.at  Thu Apr 24 11:24:10 1997
From: Andreas.Weingessel@ci.tuwien.ac.at (Andreas Weingessel)
Date: Thu, 24 Apr 1997 12:24:10 +0200
Subject: R-alpha: Seg. fault in tapply
Message-ID: <199704241024.MAA07829@elendil.ci.tuwien.ac.at>



Calling tapply with a NULL as INDEX argument causes a segmentation
fault on an i-586-linux machine.

So, if for example
	 y<-list(a=3D1:10,b=3D2:5)
then
	tapply(y$a,y$c,mean)
causes a segmentation fault.=20

This seg. fault is produced when a dimension of length integer(0) is
assigned to a list with one element and this object is shown
afterwards. E.g.:

R>  y<-list(a=3D1:10)
R> dim(y) <- integer(length(NULL))
R> y
Segmentation fault

This happens in the code of tapply, when INDEX=3DNULL in the lines

  extent <- integer(length(INDEX))
and
  dim(ans) <- extent


Regards,
	Andreas

************************************************************************
*                          Andreas Weingessel                          *
************************************************************************
* Institut f=FCr Statistik      *                Tel: (+43 1) 58801 4541 =
*
* Technische Universit=E4t Wien *                Fax: (+43 1)  504 14 98 =
*
* Wiedner Hauptstr. 8-10/1071 *     Andreas.Weingessel@ci.tuwien.ac.at *
* A-1040 Wien, Austria        * http://www.ci.tuwien.ac.at/~weingessel *
************************************************************************

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Thu Apr 24 11:51:08 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Thu, 24 Apr 1997 12:51:08 +0200
Subject: R-alpha: Postscript bug ...
In-Reply-To: <199704241001.WAA06175@stat1.stat.auckland.ac.nz>
References: <199704241001.WAA06175@stat1.stat.auckland.ac.nz>
Message-ID: <199704241051.MAA18473@aragorn.ci.tuwien.ac.at>

>>>>> Ross Ihaka writes:

>> A succession of 0.49.n's would be better, I'd say. Preferably using
>> patches from 0.49 for those with slow links, but that's not all that
>> important. Heck, it's only 10 minutes across a 14k4 modem (but it took
>> more than an hour to transfer R7.tgz from here to Kurt in Vienna the
>> other day - that's between two sites with direct net connections...).

> And here was I thinking that the steam-driven abacus we use for R
> development was low tech ...

Please don't keep mentioning the performance of my network connection
again and again  :-)

> I will try to send out "important" patches, but its hard to maintain
> distinct branches and we have already diverged from 0.49 here.

Please do.  Perhaps name them like

	R-0.49-0.49.1.diff.gz

???

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Thu Apr 24 11:48:07 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Thu, 24 Apr 1997 12:48:07 +0200
Subject: R-alpha: R-0.49 Patch #1
In-Reply-To: <199704240935.VAA06050@stat1.stat.auckland.ac.nz>
References: <199704240935.VAA06050@stat1.stat.auckland.ac.nz>
Message-ID: <199704241048.MAA18462@aragorn.ci.tuwien.ac.at>

>>>>> Ross Ihaka writes:

> This patch corrects the broken postscript graphics driver.
> If you have already done it by hand ignore this.

> Apply this patch within the R-0.49 directory.

> The patch is also at the auckland.ftp site and soon at mirrors.

Great, thanks.

I've put updated Debian/ix86 packages into CRAN ...

Btw, perhaps the patch should be sent to R-announce?  (The bug reports
came on R-help ...)

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Thu Apr 24 12:09:11 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Thu, 24 Apr 1997 13:09:11 +0200
Subject: R-alpha: R-0.49 PROJECTS
Message-ID: <199704241109.NAA18581@aragorn.ci.tuwien.ac.at>

R&R:

Re

 o  TIME SERIES
    A state-space/structural models package would be nice.  We have a
    partial spectrum analysis package.  It needs to be multivariate
    though.

Fritz and Andreas are teaching a time series course based on R this
semester, so they need to produce some code for that anyway.  If you
won't work on your code for some time, perhaps simply send us the
current versions and see what happens?

-k

PS1.  There was also `poly' function in your snapshot WORK tree ... do
you already have a final version of that?
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Thu Apr 24 14:14:22 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Thu, 24 Apr 1997 15:14:22 +0200
Subject: R-alpha: polynom add-on
Message-ID: <199704241314.PAA20059@aragorn.ci.tuwien.ac.at>

I've packaged Bill's polynom add-on for R (i.e., converted man pages and
took care of TITLE and INDEX).  Apart from the missing poly() everything
should be fine ...

The package can be found in the CRAN src/contrib area.

I've also added it to the Debian ix86 r-contrib package.

-k

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Fri Apr 25 00:36:23 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 25 Apr 1997 01:36:23 +0200
Subject: R-alpha: list assignment
Message-ID: <x2afmo803s.fsf@bush.kubism.ku.dk>

This works in Splus:

> x<-list()
> x[["f"]]<-1
> zz<-"g"
> x[[zz]]<-2 
> x
$f:
[1] 1

$g:
[1] 2

In R both variants fail unless the name is already on the list. The
first one can be replaced by x$f, but there's seems to be no
substitute for the other one (oh yes I found one, but it's not fit to
print!). This comes up if you e.g. want to create a variable in a data
frame with a name given by a character string.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From rgentlem@stat.auckland.ac.nz  Fri Apr 25 02:12:36 1997
From: rgentlem@stat.auckland.ac.nz (Robert Gentleman)
Date: Fri, 25 Apr 1997 13:12:36 +1200 (NZST)
Subject: R-alpha: list assignment
Message-ID: <199704250112.NAA00344@stat3.stat.auckland.ac.nz>


Peter,
  They don't work on purpose. Basically this is the same problem as indexing
beyond the end of an array. In almost all cases it is an error.
To add a variable with a specific name to a data frame how about

x (the dataframe)
var1 the variable
name1 the name

 x<-cbind(x,var1)
 names(x)[ncol(x)]<-name1


robert
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Andreas.Weingessel@ci.tuwien.ac.at  Fri Apr 25 10:04:21 1997
From: Andreas.Weingessel@ci.tuwien.ac.at (Andreas Weingessel)
Date: Fri, 25 Apr 1997 11:04:21 +0200
Subject: R-alpha: bug in approx
Message-ID: <199704250904.LAA11382@elendil.ci.tuwien.ac.at>


When the function approx is called with the argument rule=3D2, one gets
the error message
	Error: NAs in foreign function call (arg 6)
Besides, the meaning of rule=3D1 or rule=3D2 is opposite to that describe=
d
in the help text and used in S-plus.

For example, in R:

R> approx(1:10,2:11,xout=3D5:15,rule=3D1)
$x
 [1]  5  6  7  8  9 10 11 12 13 14 15

$y
 [1]  6  7  8  9 10 11 11 11 11 11 11

R> approx(1:10,2:11,xout=3D5:15,rule=3D2)
Error: NAs in foreign function call (arg 6)

but in S-plus:

> approx(1:10,2:11,xout=3D5:15,rule=3D1)
$x:
 [1]  5  6  7  8  9 10 11 12 13 14 15

$y:
 [1]  6  7  8  9 10 11 NA NA NA NA NA

> approx(1:10,2:11,xout=3D5:15,rule=3D2)
$x:
 [1]  5  6  7  8  9 10 11 12 13 14 15

$y:
 [1]  6  7  8  9 10 11 11 11 11 11 11


The reason for this bug can be found in the last lines of the code of
approx:

        if (rule =3D=3D 1) {
                low <- y[1]
                high <- y[length(x)]
        }
        else if (rule =3D=3D 2) {
                low <- NA
                high <- low
        }
        else stop("invalid extrapolation rule in approx")
        y <- .C("approx", as.double(x), as.double(y), length(x),=20
                xout =3D as.double(xout), length(xout), as.double(low),=20
                as.double(high))$xout
        return(list(x =3D xout, y =3D y))


If (rule =3D=3D 2) the values of low and high are set to NA. Immediately
afterwards, the foreign function "approx" is called with these values,
leading to the error
	Error: NAs in foreign function call (arg 6)

To obtain the same behavior as in S-plus (and as in the help-text) the
commands for (rule =3D=3D 1) and (rule =3D=3D 2) have to be exchanged.

	Regards,
		Andreas

************************************************************************
*                          Andreas Weingessel                          *
************************************************************************
* Institut f=FCr Statistik      *                Tel: (+43 1) 58801 4541 =
*
* Technische Universit=E4t Wien *                Fax: (+43 1)  504 14 98 =
*
* Wiedner Hauptstr. 8-10/1071 *     Andreas.Weingessel@ci.tuwien.ac.at *
* A-1040 Wien, Austria        * http://www.ci.tuwien.ac.at/~weingessel *
************************************************************************



=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Fri Apr 25 10:56:10 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Fri, 25 Apr 1997 11:56:10 +0200
Subject: R-alpha: xgobi
Message-ID: <199704250956.LAA25634@aragorn.ci.tuwien.ac.at>

I've commented out a few lines in the S function that comes with the
XGobi distribution and made 3 more changes or so ... now one can use it
for starting XGobi from within R.  Seems to work o.k.  [Cloning and
Copying does not, but does it under S-PLUS?]

The function requires something like tmpname(), so it currently has to
require our e1071 library.  R&R, couldn't we add the tmpname() wrapper
to the libc function to the distribution?

I've put xgobi.tar.gz into CRAN/src/contrib.  

I've also added it to the Debian Linux/GNU r-contrib package.  Doug,
if you're interested in an XGobi package, please let me know.

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From luke@stat.umn.edu  Fri Apr 25 11:12:19 1997
From: luke@stat.umn.edu (Luke Tierney)
Date: Fri, 25 Apr 1997 05:12:19 -0500 (CDT)
Subject: R-alpha: libraries, modules, namespaces, ...
In-Reply-To: <199704240611.IAA17238@aragorn.ci.tuwien.ac.at> from "Kurt Hornik" at Apr 24, 97 08:11:51 am
Message-ID: <9704251012.AA06862@nokomis.stat.umn.edu>

> 
> Very cool!  Do you think that if we have modules, we should get rid of
> the `library' mechanism altogether?  
> 

Something along those lines is probably still needed. Right now
library/provide/require are an imperative mechanism that (a) makes
additions to the global name space (b) makes code available.

Making code available is, I think, better handled by a declarative
module mechanism that describes what depends on what but leaves the
system the freedom to actually load the relevant code when it needs
to, unloaded it if it isn't needed, etc. A declarative mechanism in
which DLL's are viewed as just a special kind of module or as
containers for such modules (native modules if you like) would also
make handling of DLL code a bit easier and cleaner.

But modifying the global name space at run time to make certain groups
of things available is still something you need to be able to do (you
can think of it as an interactive import directive). So some variant
of a library command is still needed, but provide/require's
functionality would be replaced by the declarative module
mechanism. (At least from a user's point of view -- the implementation
might still use the same mechanism internally. Also some back door for
explicitly loading a module/DLL and for unloading would still be
useful during debugging of new code but would usually not be needed
once code is stable).

There is also a granularity issue that might be worth considering.  S
libraries tend to be fairly coarse-grained. With a module mechanism I
would tend to want to subdivide many of these libraries into smaller
modules, but it would still be useful to be able to organize them into
library-sized chunks. One way to allow that would be to allow nested
modules. While that might be an elegant solution in some sense, I
suspect it is too complex. A better choice is probably to have a
two-tiered mechanism like packages/classes in Java, libraries/modules
in dylan with libraries just a loose way of grouping modules.

One drawback of handling modules by something like

mymodule <- module { ... }

is that it strongly suggests that modules can be nested, are first
class, etc. If that is the case, great. But if not it would cause
confusion. If a simpler notion of module is used, a convention that
makes limitations clear (like comment-based module specification, or a
file=module convention) might be better.

Lots of things to think about.

luke
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Fri Apr 25 12:09:01 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 25 Apr 1997 13:09:01 +0200
Subject: R-alpha: list assignment
In-Reply-To: Robert Gentleman's message of Fri, 25 Apr 1997 13:12:36 +1200 (NZST)
References: <199704250112.NAA00344@stat3.stat.auckland.ac.nz>
Message-ID: <x2rafznyuq.fsf@bush.kubism.ku.dk>

Robert Gentleman <rgentlem@stat.auckland.ac.nz> writes:

> 
> 
> Peter,
>   They don't work on purpose. Basically this is the same problem as indexing
> beyond the end of an array. In almost all cases it is an error.
> To add a variable with a specific name to a data frame how about
> 
> x (the dataframe)
> var1 the variable
> name1 the name
> 
>  x<-cbind(x,var1)
>  names(x)[ncol(x)]<-name1

Hm. Not sure about that argument. After all we don't protect against
typing

x$mumble<-17
instead of 
x$grumble<-17

Once you're into indexing lists through character variables, shouldn't
you be assumed to know what you're doing? Beginners can do much more
mischief with e.g. dfr$new<-0 which will turn dfr into a list.

However, apropos your construct, watch this:

> x<-list()
> x[[1]]<-23
> names(x)[1]<-"a"
> x
$"a"
[1] 23

> unlist(x)
\"a\" 
   23 
> names(x)[1]     
[1] "\"a\""
> names(x)   
[1] "\"a\""
> names(x)[1]<-"a"
> names(x)
[1] "a"
> x
$a
[1] 23

> unlist(x)
 a 
23 


-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Friedrich.Leisch@ci.tuwien.ac.at  Fri Apr 25 13:16:50 1997
From: Friedrich.Leisch@ci.tuwien.ac.at (Friedrich Leisch)
Date: Fri, 25 Apr 1997 14:16:50 +0200
Subject: R-alpha: unresolved symbols
Message-ID: <199704251216.OAA17847@galadriel.ci.tuwien.ac.at>


I tried to convert hastie & tibshiranis mda package to R but ended
with a bunch of unresolved symbols:

R.binary: can't resolve symbol 'dbksl_'
R.binary: can't resolve symbol 'dblepr_'
R.binary: can't resolve symbol 'dqrdca_'
R.binary: can't resolve symbol 'intpr_'
R.binary: can't resolve symbol 'pack_'
R.binary: can't resolve symbol 'sgram_'
R.binary: can't resolve symbol 'sknotl_'
R.binary: can't resolve symbol 'unpack_'
R.binary: can't resolve symbol 'wmean_'

I'm using linux, f2c, gcc

Does anyone know which library these symbols are part of? Sun-specific?

I've also tried to load the stuff into Splus 3.4 on a HP 9000 using the H=
P C
compiler, same symbols seem to be missing.

Has anyone got the mda package up and running?

Best,
Fritz

--=20
-------------------------------------------------------------------
                        Friedrich  Leisch                            =20
Institut f=FCr Statistik                      Tel: (+43 1) 58801 4541
Technische Universit=E4t Wien                 Fax: (+43 1)  504 14 98
Wiedner Hauptstra=DFe 8-10/1071      Friedrich.Leisch@ci.tuwien.ac.at
A-1040 Wien, Austria             http://www.ci.tuwien.ac.at/~leisch
     PGP public key http://www.ci.tuwien.ac.at/~leisch/pgp.key
-------------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Fri Apr 25 13:19:29 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Fri, 25 Apr 1997 14:19:29 +0200
Subject: R-alpha: phyper() woes
Message-ID: <199704251219.OAA26048@aragorn.ci.tuwien.ac.at>

I can also confirm that rhyper(5,200,250,60) never returns (o.k., if
never is anything beyond 5 minutes).

More strikingly,

R> phyper(47, 76, 49, 68)
[1] 1

whereas

Splus> phyper(47, 76, 49, 68)
[1] 0.9883098


(Breaks my fisher.test() ...)

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Sun Apr 27 22:39:02 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Sun, 27 Apr 1997 14:39:02 -0700 (PDT)
Subject: R-alpha: R-beta: vector recycling weirdness
In-Reply-To: <9704010823.AA00318@>
Message-ID: <Pine.SUN.3.95.970427143317.14377A-100000@data>

wompom:~> R
R : Copyright 1997, Robert Gentleman and Ross Ihaka
Version 0.49 Beta (April 23, 1997)

R> f
function () 
{
        FALSE & matrix(FALSE, ncol = 1)
}
R> g
function () 
FALSE & matrix(FALSE, ncol = 1) 
R> f()
Warning in FALSE & matrix(FALSE, ncol = 1) : longer object length
        is not a multiple of shorter object length
      [,1]
[1,] FALSE
R> g()
      [,1]
[1,] FALSE
 
Is this weird or what?


Thomas Lumley
-----------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Apr 28 06:07:05 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 28 Apr 1997 07:07:05 +0200
Subject: R-alpha: R-0.49:  2 problems
Message-ID: <199704280507.HAA02509@aragorn.ci.tuwien.ac.at>

I found the following 2 problems (no debugging, sorry).

* qt(0.975, 3) never returns.

Can someone please check that?  Happens for me on Debian GNU/Linux/ix86
compiled with CFLAGS="-O2 -g".

* Yet another stupid way to cause a segfault:

R> x
Error: Object "x" not found
R> debug(t.test)
R> t.test(rnorm(10))
debug: choices <- c("two.sided", "greater", "less")
Browse[1]> return()
NULL
R> x
Error: Object "x" not found
Browse[1]> return()
Segmentation fault

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Apr 28 06:07:05 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 28 Apr 1997 07:07:05 +0200
Subject: R-alpha: list assignment
In-Reply-To: <x2rafznyuq.fsf@bush.kubism.ku.dk>
References: <199704250112.NAA00344@stat3.stat.auckland.ac.nz>
 <x2rafznyuq.fsf@bush.kubism.ku.dk>
Message-ID: <199704280507.HAA02510@aragorn.ci.tuwien.ac.at>

>>>>> Peter Dalgaard BSA writes:

> Robert Gentleman <rgentlem@stat.auckland.ac.nz> writes:
>> 
>> 
>> Peter,
>> They don't work on purpose. Basically this is the same problem as indexing
>> beyond the end of an array. In almost all cases it is an error.
>> To add a variable with a specific name to a data frame how about
>> 
>> x (the dataframe)
>> var1 the variable
>> name1 the name
>> 
>> x<-cbind(x,var1)
>> names(x)[ncol(x)]<-name1

> Hm. Not sure about that argument. After all we don't protect against
> typing

> x$mumble<-17
> instead of 
> x$grumble<-17

> Once you're into indexing lists through character variables, shouldn't
> you be assumed to know what you're doing? Beginners can do much more
> mischief with e.g. dfr$new<-0 which will turn dfr into a list.

> However, apropos your construct, watch this:

>> x<-list()
>> x[[1]]<-23
>> names(x)[1]<-"a"
>> x
> $"a"
> [1] 23

>> unlist(x)
> \"a\" 
>    23 
>> names(x)[1]     
> [1] "\"a\""
>> names(x)   
> [1] "\"a\""
>> names(x)[1]<-"a"
>> names(x)
> [1] "a"
>> x
> $a
> [1] 23

>> unlist(x)
>  a 
> 23

Which is the same (?) as the

R> l <- list("11" = 1:5)
R> l
$11
[1] 1 2 3 4 5

R> unlist(l)
111 112 113 114 115 
  1   2   3   4   5 

I ran into this weekend ...

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From rossini@math.sc.edu  Mon Apr 28 14:11:34 1997
From: rossini@math.sc.edu (Anthony Rossini)
Date: 28 Apr 1997 09:11:34 -0400
Subject: R-alpha: R-0.49:  2 problems
In-Reply-To: Kurt Hornik's message of Mon, 28 Apr 1997 07:07:05 +0200
References: <199704280507.HAA02509@aragorn.ci.tuwien.ac.at>
Message-ID: <wnc67x7qol5.fsf@fhat.stat.sc.edu>



>>>>> "Kurt" == Kurt Hornik <hornik@ci.tuwien.ac.at> writes:

    Kurt> I found the following 2 problems (no debugging, sorry).
 Kurt> * qt(0.975, 3) never returns.

    Kurt> Can someone please check that?  Happens for me on Debian
    Kurt> GNU/Linux/ix86 compiled with CFLAGS="-O2 -g".

Fine on Solaris, but see the transcript which follows.

 Kurt> * Yet another stupid way to cause a segfault:

    R> x
    Kurt> Error: Object "x" not found
    R> debug(t.test) t.test(rnorm(10))
    Kurt> debug: choices <- c("two.sided", "greater", "less")
    Kurt> Browse[1]> return()
    Kurt> NULL
    R> x
    Kurt> Error: Object "x" not found
    Kurt> Browse[1]> return()
    Kurt> Segmentation fault

I got a Bus Error, and it happened one line earlier...

Transcript:

>  neuromancer 21 > R
>  
>  R : Copyright 1997, Robert Gentleman and Ross Ihaka
>  Version 0.49 Beta (April 23, 1997)
>  
>  R is free software and comes with ABSOLUTELY NO WARRANTY.
>  You are welcome to redistribute it under certain conditions.
>  Type "license()" for details.
>  
>  >  qt(0.975, 3)
>  [1] 3.182446
>  > 
>  >  x
>  Error: Object "x" not found
>  > debug(t.test)
>  >  t.test(rnorm(10))
>  debug: choices <- c("two.sided", "greater", "less")
>  Browse[1]>  return()
>  NULL
>  > x
>  Error: Object "x" not found
>  Bus error (core dumped)
>  neuromancer 22 > 

with the following core dump:

>  neuromancer 22 > gdb /apps/R/bin/R.binary core
>  GDB is free software and you are welcome to distribute copies of it
>   under certain conditions; type "show copying" to see the conditions.
>  There is absolutely no warranty for GDB; type "show warranty" for details.
>  GDB 4.15.1 (sparc-sun-solaris2.4), 
>  Copyright 1995 Free Software Foundation, Inc...
>  Core was generated by `/p1/apps/R/src/R-0.49/bin/R.binary'.
>  Program terminated with signal 10, Bus error.
>  Reading symbols from /p1/apps/X11R6.3/lib/libSM.so.6.0...done.
>  Reading symbols from /p1/apps/X11R6.3/lib/libICE.so.6.3...done.
>  Reading symbols from /p1/apps/X11R6.3/lib/libX11.so.6.1...done.
>  Reading symbols from /usr/lib/libnsl.so.1...done.
>  Reading symbols from /usr/lib/libsocket.so.1...done.
>  Reading symbols from /usr/lib/libdl.so.1...done.
>  Reading symbols from /usr/lib/libm.so.1...done.
>  Reading symbols from /usr/lib/libc.so.1...done.
>  Reading symbols from /usr/lib/libintl.so.1...done.
>  Reading symbols from /usr/lib/libmp.so.1...done.
>  Reading symbols from /usr/lib/libw.so.1...done.
>  #0  0xef4e25c8 in longjmp ()
>  (gdb) where
>  #0  0xef4e25c8 in longjmp ()
>  #1  0x59214 in jump_now () at errors.c:126
>  #2  0x591c8 in jump_to_toplevel () at errors.c:119
>  #3  0x58f78 in error (format=0x1391a8 "Object \"%s\" not found\n")
>      at errors.c:78
>  #4  0x597a0 in eval (e=0x17f2c0, rho=0x17d1c8) at eval.c:92
>  #5  0x65978 in R_Repl (rho=0x17d1c8, savestack=0, browselevel=0) at main.c:187
>  #6  0x65f4c in mainloop () at main.c:359
>  #7  0xcd6fc in main (ac=0, av=0xeffffa6c) at system.c:267
>  (gdb) 

Something is not where it ought to be... (but I've not looked at the
source in a long enough time to tell you exactly what :-().

best,

----
-tony (Anthony Rossini)	           Statistics Dept., U South Carolina
rossini@stat.sc.edu	           Columbia, SC 29208
http://www.stat.sc.edu/~rossini/   803-777-3578(O) 803-777-4048 (fax)  
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Apr 28 14:37:03 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 28 Apr 1997 15:37:03 +0200
Subject: R-alpha: R-0.49:  2 problems
In-Reply-To: <wnc67x7qol5.fsf@fhat.stat.sc.edu>
References: <199704280507.HAA02509@aragorn.ci.tuwien.ac.at>
 <wnc67x7qol5.fsf@fhat.stat.sc.edu>
Message-ID: <199704281337.PAA06954@aragorn.ci.tuwien.ac.at>

>>>>> Anthony Rossini writes:

>>>>> "Kurt" == Kurt Hornik <hornik@ci.tuwien.ac.at> writes:

Kurt> I found the following 2 problems (no debugging, sorry).
Kurt> * qt(0.975, 3) never returns.

Kurt> Can someone please check that?  Happens for me on Debian
Kurt> GNU/Linux/ix86 compiled with CFLAGS="-O2 -g".

> Fine on Solaris, but see the transcript which follows.

Thanks, Tony.

Actually, also fine on Debian GNU/Linux/ix86 compiled with CFLAGS="-g",
as I expected ...

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Mon Apr 28 15:58:03 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Mon, 28 Apr 1997 07:58:03 -0700 (PDT)
Subject: R-alpha: R-beta:matrix & vector multiplication.
In-Reply-To: <9704010823.AA00318@>
Message-ID: <Pine.SUN.3.95.970428075618.1365B-100000@zen>

Both of these used to work and seem useful and harmless:

R> matrix(1,ncol=1)%*%c(1,2)
Error in matrix(1, ncol = 1) %*% c(1, 2) : non-conformable arguments

R> matrix(1,ncol=1)*(1:2)
Error: dim<- length of dims do not match the length of object


Thomas Lumley
-----------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Mon Apr 28 17:52:41 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 28 Apr 1997 18:52:41 +0200
Subject: R-alpha: R-W95
Message-ID: <x2sp0brsx2.fsf@bush.kubism.ku.dk>

Seems to be working very nicely (and what a relief to see it actually
working!), I've found only a few problems till now:

a) Characters outside 0-0x7f seem to get encoded as CP850 or
something, not Latin 1 ( keys on DK keyboard gives
mu,degree,sigma).

b) Infinite recursion crashed R. (I forget details, but it was
something stupid like f<-function(x){if (x < 1) 1 else f(x)*(x-1)})

c) I miss command-line recall *badly*...

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Mon Apr 28 20:18:07 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Mon, 28 Apr 1997 12:18:07 -0700 (PDT)
Subject: R-alpha: R-W95
In-Reply-To: <x2sp0brsx2.fsf@bush.kubism.ku.dk>
Message-ID: <Pine.SUN.3.95.970428121424.8287A-100000@avon>

On 28 Apr 1997, Peter Dalgaard BSA wrote:

> Seems to be working very nicely (and what a relief to see it actually
> working!), I've found only a few problems till now:

Me too.  There are some problems with the html help.  Firstly, if you
unzip the file with a program that doesn't know about long filenames none
of the links will work. Secondly, some of the links use forward rather
than back slashes as directory separators. Internet Explorer doesn't seem
to cope with this (I don't know about other browsers). 

Of course all my favorite test code is in libraries, so I couldn't
brutally stress the poor program....

Thomas Lumley
-----------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Mon Apr 28 22:16:05 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Tue, 29 Apr 1997 09:16:05 +1200 (NZST)
Subject: R-alpha: R-0.49:  2 problems
In-Reply-To: <199704280507.HAA02509@aragorn.ci.tuwien.ac.at>
References: <199704280507.HAA02509@aragorn.ci.tuwien.ac.at>
Message-ID: <199704282116.JAA24437@stat1.stat.auckland.ac.nz>

Kurt Hornik writes:
 > I found the following 2 problems (no debugging, sorry).
 > 
 > * qt(0.975, 3) never returns.
 > 
 > Can someone please check that?  Happens for me on Debian GNU/Linux/ix86
 > compiled with CFLAGS="-O2 -g".

I am having a look at the computations of p-values and quantiles which
depend on the incomplete beta function at  present.  I hope to have a
better set of functions in place by weeks end.  I may need a tester or
two to really exercise the new ones.  I'm also looking at the whole
math library to see exactly how much work a proper handling of Inf, NaN
and NA might involve.
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Apr 29 10:37:00 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 29 Apr 97 11:37:00 +0200
Subject: R-alpha: Re: Inf  et al.
In-Reply-To: <199704282116.JAA24437@stat1.stat.auckland.ac.nz> (message from
 Ross Ihaka on Tue, 29 Apr 1997 09:16:05 +1200 (NZST))
Message-ID: <9704290937.AA00877@>

>>>>> "Ross" == Ross Ihaka <ihaka@stat.auckland.ac.nz> writes:

    Ross> I am having a look at the computations of p-values and quantiles
    Ross> which depend on the incomplete beta function at present.  I hope
    Ross> to have a better set of functions in place by weeks end.  I may
    Ross> need a tester or two to really exercise the new ones.

I'd volunteer for this..

BTW: The phyper 'inaccuracy' is not a pbeta problem however.
I think that AS 152 (which has been improved, but is still available as
		     file  ...statlib.../apstat/152 )
should be used in place of  phyper.c
		

    Ross> I'm also
    Ross> looking at the whole math library to see exactly how much work a
    Ross> proper handling of Inf, NaN and NA might involve. 

I think that this is the most important of the current TASKS.
Even though it doesn't seem to be used so often,
I've been realizing lately that in several places in my code, I just rely
on things like  1/Inf  -> 0.
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Tue Apr 29 13:02:29 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 29 Apr 1997 14:02:29 +0200
Subject: R-alpha: Re: Inf  et al.
In-Reply-To: <9704290937.AA00877@>
References: <199704282116.JAA24437@stat1.stat.auckland.ac.nz>
 <9704290937.AA00877@>
Message-ID: <199704291202.OAA14127@aragorn.ci.tuwien.ac.at>

>>>>> Martin Maechler writes:

>>>>> "Ross" == Ross Ihaka <ihaka@stat.auckland.ac.nz> writes:
Ross> I am having a look at the computations of p-values and quantiles
Ross> which depend on the incomplete beta function at present.  I hope
Ross> to have a better set of functions in place by weeks end.  I may
Ross> need a tester or two to really exercise the new ones.

> I'd volunteer for this..

> BTW: The phyper 'inaccuracy' is not a pbeta problem however.
> I think that AS 152 (which has been improved, but is still available as
> 		     file  ...statlib.../apstat/152 )
> should be used in place of  phyper.c

If Martin volunteers for it, one tester should be enough.
		
-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Tue Apr 29 13:19:14 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 29 Apr 1997 14:19:14 +0200
Subject: R-alpha: Re: R-beta: Archives of   R-announce / R-help / R-devel -- monthly archive files
In-Reply-To: <9704290931.AA00870@>
References: <9704290931.AA00870@>
Message-ID: <199704291219.OAA14305@aragorn.ci.tuwien.ac.at>

>>>>> Martin Maechler writes:

> Something which seems missing from the current  R-FAQ
> which mentions "mailing list archive":

>     The 3 mailing lists   R-announce / R-help / R-devel 
>     are not only archived,
>     but the archives are also made publicly available on the net,
>     in a monthly schedule at

> 	    ftp://ftp.stat.math.ethz.ch/Mail-archives/

>     which is a directory of mail archive files.

>     You will be looking at  
> 	    r-testers-... (the old scheme)
> 	    r-announce-...
> 	    r-help-...
> 	    r-devel-...

Martin,

Thanks for the update.  (Writing something about mailing list archives
had been on my mind for some time now, but I could bot decide whether
CRAN should start mirroring the archives right away ...)

The FAQ now says,

  Archives of the three mailing lists are made publicly available on the
  net in a monthly schedule at ftp://ftp.stat.math.ethz.ch/Mail-
  archives/ (which is a directory of mail archive files).

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Tue Apr 29 13:35:36 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 29 Apr 1997 14:35:36 +0200
Subject: R-alpha: R-0.49:  2 problems
In-Reply-To: Ross Ihaka's message of Tue, 29 Apr 1997 09:16:05 +1200 (NZST)
References: <199704280507.HAA02509@aragorn.ci.tuwien.ac.at>
 <199704282116.JAA24437@stat1.stat.auckland.ac.nz>
Message-ID: <x29122vwfb.fsf@bush.kubism.ku.dk>

Ross Ihaka <ihaka@stat.auckland.ac.nz> writes:

> 
> Kurt Hornik writes:
>  > I found the following 2 problems (no debugging, sorry).
>  > 
>  > * qt(0.975, 3) never returns.
>  > 
>  > Can someone please check that?  Happens for me on Debian GNU/Linux/ix86
>  > compiled with CFLAGS="-O2 -g".
> 
> I am having a look at the computations of p-values and quantiles which
> depend on the incomplete beta function at  present. ....

The original problem seems to be one of loss of accuracy with
instruction reordering. Doubling the value of "acu" cures it (I ran it
under the debugger and the test value was stuck at about 1.5e-32,
being compared to acu=1e-23). This is probably a generic problem with
these last-bit-accurate routines.


-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Tue Apr 29 14:40:10 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 29 Apr 1997 15:40:10 +0200
Subject: R-alpha: R-0.49:  2 problems
In-Reply-To: Peter Dalgaard BSA's message of 29 Apr 1997 14:35:36 +0200
References: <199704280507.HAA02509@aragorn.ci.tuwien.ac.at>
 <199704282116.JAA24437@stat1.stat.auckland.ac.nz>
 <x29122vwfb.fsf@bush.kubism.ku.dk>
Message-ID: <x267x6vtfp.fsf@bush.kubism.ku.dk>

Peter Dalgaard BSA <p.dalgaard@kubism.ku.dk> writes:

> under the debugger and the test value was stuck at about 1.5e-32,
> being compared to acu=1e-23). This is probably a generic problem
                           ^^

Ugh. Make that thirty-two, please...

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Tue Apr 29 23:21:46 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 30 Apr 1997 00:21:46 +0200
Subject: R-alpha: frametools v.0.0000001
Message-ID: <x2wwplzczp.fsf@bush.kubism.ku.dk>

The following three functions are designed to make manipulation of
dataframes easier. I won't write detailed docs just now, but if you
follow the example below, you should get the general picture. Comments
are welcome, esp. re. naming conventions. 

Note that these functions are definitely not portable to S because
they rely on R's scoping rules. Not that difficult to fix, though: The
nm vector and the "parsing" functions need to get assigned to
(evaluation) frame 1 (the "expression frame" of S), and preferably
removed at exit.

data(airquality)
aq<-airquality[1:10,]
select.frame(aq,Ozone:Temp)
subset.frame(aq,Ozone>20)
modify.frame(aq,ratio=Ozone/Temp)

Notice that in modify.frame(), any *new* variable must appear as a
tag, not as the result of an assignment, i.e.:

modify.frame(aq,Ozone<-log(Ozone)) works as expected
modify.frame(aq,lOzone<-log(Ozone)) does not.

This is mainly because it was tricky to figure out what part of a left
hand side constitutes a new variable to be created (note that indexing
could be involved). So assignments to non-existing variables just
create them as local variables within the function. Making a virtue
out of necessity, that might actually be considered a feature...

----------------------------------------
"select.frame" <-
function (dfr, ...) 
{
        subst.call <- function(e) {
                if (length(e) > 1) 
                        for (i in 2:length(e)) e[[i]] <- subst.expr(e[[i]])
                e
        }
        subst.expr <- function(e) {
                if (is.call(e)) 
                        subst.call(e)
                else match.expr(e)
        }
        match.expr <- function(e) {
                n <- match(as.character(e), nm)
                if (is.na(n)) 
                        e
                else n
        }
        nm <- names(dfr)
        e <- substitute(c(...))
        dfr[, eval(subst.expr(e))]
}
"modify.frame" <-
function (dfr, ...) 
{
        nm <- names(dfr)
        e <- substitute(list(...))
        if (length(e) < 2) 
                return(dfr)
        subst.call <- function(e) {
                if (length(e) > 1) 
                        for (i in 2:length(e)) e[[i]] <- subst.expr(e[[i]])
                substitute(e)
        }
        subst.expr <- function(e) {
                if (is.call(e)) 
                        subst.call(e)
                else match.expr(e)
        }
        match.expr <- function(e) {
                if (is.na(n <- match(as.character(e), nm))) 
                        if (is.atomic(e)) 
                                e
                        else substitute(e)
                else substitute(dfr[, n])
        }
        tags <- names(as.list(e))
        for (i in 2:length(e)) {
                ee <- subst.expr(e[[i]])
                r <- eval(ee)
                if (!is.na(tags[i])) {
                        if (is.na(n <- match(as.character(tags[i]), 
                                nm))) {
                                n <- length(nm) + 1
                                dfr[[n]] <- numeric(nrow(dfr))
                                names(dfr)[n] <- tags[i]
                                nm <- names(dfr)
                        }
                        dfr[[tags[i]]][] <- r
                }
        }
        dfr
}
"subset.frame" <-
function (dfr, expr) 
{
        nm <- names(dfr)
        e <- substitute(expr)
        subst.call <- function(e) {
                if (length(e) > 1) 
                        for (i in 2:length(e)) e[[i]] <- subst.expr(e[[i]])
                e
        }
        subst.expr <- function(e) {
                if (is.call(e)) 
                        subst.call(e)
                else match.expr(e)
        }
        match.expr <- function(e) {
                if (is.na(n <- match(as.character(e), nm))) 
                        e
                else dfr[, n]
        }
        r <- eval(subst.expr(e))
        r <- r & !is.na(r)
        dfr[r, ]
}


-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Wed Apr 30 05:56:08 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Wed, 30 Apr 1997 16:56:08 +1200 (NZST)
Subject: R-alpha: New Incomplete Beta Function
Message-ID: <199704300456.QAA07452@stat1.stat.auckland.ac.nz>

Here is a drop-in replacement for the R incomplete beta function.

	src/math/pbeta.c

It is a slightly modified version of the cephes library one from
Netlib.  In the few cases I tried it seems to give at least 14
digit agreement with the one in S-PLUS (its hard to get more).

I'm not sure what performance is like.  I'd like to know if it
helps with some of the problems which have been reported for the
t and F code in R.

If it works It'll be in an official second patch for 0.49 later in
the week (so just swap it temporarily with the old one).

	Ross


- - s n i p - - h e r e - -

/*
 *    Incomplete Beta Integral
 *
 *    Taken from Cephes Math Library, Release 2.3:  March, 1995
 *    Copyright 1984, 1995 by Stephen L. Moshier
 *    Changes for R : Copyright 1997 by Ross Ihaka
 */

#include <math.h>
#include <float.h>
#include <errno.h>

static double incbcf(), incbd(), pseries();

static double big = 4.503599627370496e15;
static double biginv = 2.22044604925031308085e-16;


double pbeta(double xx, double aa, double bb)
{
	double a, b, t, x, xc, w, y;
	int flag;

	if (aa <= 0 || bb <= 0)
		goto domerr;

	if (xx <= 0 || xx >= 1) {
		if (xx == 0)
			return 0;
		if (xx == 1)
			return 1;
domerr:
		errno = EDOM;
		return 0;
	}
	flag = 0;
	if (bb * xx <= 1 && xx <= 0.95) {
		t = pseries(aa, bb, xx);
		goto done;
	}
	w = 1 - xx;

	/* Reverse a and b if x is greater than the mean. */

	if (xx > (aa / (aa + bb))) {
		flag = 1;
		a = bb;
		b = aa;
		xc = xx;
		x = w;
	} else {
		a = aa;
		b = bb;
		xc = w;
		x = xx;
	}

	if (flag == 1 && (b * x) <= 1 && x <= 0.95) {
		t = pseries(a, b, x);
		goto done;
	}

	/* Choose expansion for better convergence. */

	y = x * (a + b - 2) - (a - 1);
	if (y < 0)
		w = incbcf(a, b, x);
	else
		w = incbd(a, b, x) / xc;

	/* Multiply w by the factor
	     a      b   _             _     _
	    x  (1-x)   | (a+b) / ( a | (a) | (b) ) .   */

	y = a * log(x);
	t = b * log(xc);

	/* Resort to logarithms.  */

	y += t + lgamma(a + b) - lgamma(a) - lgamma(b);
	y += log(w / a);
	t = exp(y);

done:

	if (flag == 1) {
		if (t <= DBL_EPSILON)
			t = 1 - DBL_EPSILON;
		else
			t = 1 - t;
	}
	return t;
}


/* Continued fraction expansion #1
 * for incomplete beta integral
 */

static double incbcf(double a, double b, double x)
{
	double xk, pk, pkm1, pkm2, qk, qkm1, qkm2;
	double k1, k2, k3, k4, k5, k6, k7, k8;
	double r, t, ans, thresh;
	int n;

	k1 = a;
	k2 = a + b;
	k3 = a;
	k4 = a + 1;
	k5 = 1;
	k6 = b - 1;
	k7 = k4;
	k8 = a + 2;

	pkm2 = 0;
	qkm2 = 1;
	pkm1 = 1;
	qkm1 = 1;
	ans = 1;
	r = 1;
	n = 0;
	thresh = 3 * DBL_EPSILON;
	do {

		xk = -(x * k1 * k2) / (k3 * k4);
		pk = pkm1 + pkm2 * xk;
		qk = qkm1 + qkm2 * xk;
		pkm2 = pkm1;
		pkm1 = pk;
		qkm2 = qkm1;
		qkm1 = qk;

		xk = (x * k5 * k6) / (k7 * k8);
		pk = pkm1 + pkm2 * xk;
		qk = qkm1 + qkm2 * xk;
		pkm2 = pkm1;
		pkm1 = pk;
		qkm2 = qkm1;
		qkm1 = qk;

		if (qk != 0)
			r = pk / qk;
		if (r != 0) {
			t = fabs((ans - r) / r);
			ans = r;
		} else
			t = 1;

		if (t < thresh)
			goto cdone;

		k1 += 1;
		k2 += 1;
		k3 += 2;
		k4 += 2;
		k5 += 1;
		k6 -= 1;
		k7 += 2;
		k8 += 2;

		if ((fabs(qk) + fabs(pk)) > big) {
			pkm2 *= biginv;
			pkm1 *= biginv;
			qkm2 *= biginv;
			qkm1 *= biginv;
		}
		if ((fabs(qk) < biginv) || (fabs(pk) < biginv)) {
			pkm2 *= big;
			pkm1 *= big;
			qkm2 *= big;
			qkm1 *= big;
		}
	}
	while (++n < 300);

cdone:
	return ans;
}



/* Continued fraction expansion #2
 * for incomplete beta integral
 */

static double incbd(double a, double b, double x)
{
	double xk, pk, pkm1, pkm2, qk, qkm1, qkm2;
	double k1, k2, k3, k4, k5, k6, k7, k8;
	double r, t, ans, z, thresh;
	int n;

	k1 = a;
	k2 = b - 1;
	k3 = a;
	k4 = a + 1;
	k5 = 1;
	k6 = a + b;
	k7 = a + 1;
	k8 = a + 2;

	pkm2 = 0;
	qkm2 = 1;
	pkm1 = 1;
	qkm1 = 1;
	z = x / (1 - x);
	ans = 1;
	r = 1;
	n = 0;
	thresh = 3 * DBL_EPSILON;
	do {

		xk = -(z * k1 * k2) / (k3 * k4);
		pk = pkm1 + pkm2 * xk;
		qk = qkm1 + qkm2 * xk;
		pkm2 = pkm1;
		pkm1 = pk;
		qkm2 = qkm1;
		qkm1 = qk;

		xk = (z * k5 * k6) / (k7 * k8);
		pk = pkm1 + pkm2 * xk;
		qk = qkm1 + qkm2 * xk;
		pkm2 = pkm1;
		pkm1 = pk;
		qkm2 = qkm1;
		qkm1 = qk;

		if (qk != 0)
			r = pk / qk;
		if (r != 0) {
			t = fabs((ans - r) / r);
			ans = r;
		} else
			t = 1;

		if (t < thresh)
			goto cdone;

		k1 += 1;
		k2 -= 1;
		k3 += 2;
		k4 += 2;
		k5 += 1;
		k6 += 1;
		k7 += 2;
		k8 += 2;

		if ((fabs(qk) + fabs(pk)) > big) {
			pkm2 *= biginv;
			pkm1 *= biginv;
			qkm2 *= biginv;
			qkm1 *= biginv;
		}
		if ((fabs(qk) < biginv) || (fabs(pk) < biginv)) {
			pkm2 *= big;
			pkm1 *= big;
			qkm2 *= big;
			qkm1 *= big;
		}
	}
	while (++n < 300);
cdone:
	return ans;
}


/* Power series for incomplete beta integral.
   Use when b*x is small and x not too close to 1.  */

static double pseries(double a, double b, double x)
{
	double s, t, u, v, n, t1, z, ai;

	ai = 1 / a;
	u = (1 - b) * x;
	v = u / (a + 1);
	t1 = v;
	t = u;
	n = 2;
	s = 0;
	z = DBL_EPSILON * ai;
	while (fabs(v) > z) {
		u = (n - b) * x / n;
		t *= u;
		v = t / (a + n);
		s += v;
		n += 1;
	}
	s += t1;
	s += ai;

	u = a * log(x);
	t = lgamma(a + b) - lgamma(a) - lgamma(b) + u + log(s);
	s = exp(t);
	return s;
}
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Wed Apr 30 06:52:23 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 30 Apr 1997 07:52:23 +0200
Subject: R-alpha: New Incomplete Beta Function
In-Reply-To: <199704300456.QAA07452@stat1.stat.auckland.ac.nz>
References: <199704300456.QAA07452@stat1.stat.auckland.ac.nz>
Message-ID: <199704300552.HAA17098@aragorn.ci.tuwien.ac.at>

>>>>> Ross Ihaka writes:

> Here is a drop-in replacement for the R incomplete beta function.
> 	src/math/pbeta.c

> It is a slightly modified version of the cephes library one from
> Netlib.  In the few cases I tried it seems to give at least 14
> digit agreement with the one in S-PLUS (its hard to get more).

> I'm not sure what performance is like.  I'd like to know if it
> helps with some of the problems which have been reported for the
> t and F code in R.

Indeed, `qt(0.975, 3)' now also works on Debian Linux/GNU/ix86 when
compiled with `-O2 -g'.

Thanks!

(Of course, this is the only example I tried thus far ...)

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Wed Apr 30 10:40:54 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 30 Apr 1997 11:40:54 +0200
Subject: R-alpha: Re: R-beta: Re: S Compatibility
In-Reply-To: Ross Ihaka's message of Wed, 30 Apr 1997 14:27:07 +1200 (NZST)
References: <199704300227.OAA06297@stat1.stat.auckland.ac.nz>
Message-ID: <x2k9lk4zmh.fsf@bush.kubism.ku.dk>

Ross Ihaka <ihaka@stat.auckland.ac.nz> writes:

[on out-of-memory data]
> 
> Its something we definitely need (almost as much as REAL libraries).
> If only there were another 24 hours in each day ...

No problem. You just need someone as smart as you are to chip in with
the development. Or four people half as smart ;^)

There might also be some more "brutal" approaches, such as having the
vector heap as a memory-mapped file, leaving the cacheing and similar
work to the operating system. OS's are already quite good at handling
files with holes in them, so it's not like allocating a huge file just
for a handful af variables. Some special routines for defragmentation
might be necessary, though. Not that I really know what I'm talking
about...

At any rate, it would probably be a good thing to start thinking in
terms of modularity, database backends and such.

I've moved the thread to r-devel, it seemed to be getting too
technical for r-help.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Wed Apr 30 11:03:20 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 30 Apr 1997 12:03:20 +0200
Subject: R-alpha: New Incomplete Beta Function
In-Reply-To: Kurt Hornik's message of Wed, 30 Apr 1997 07:52:23 +0200
References: <199704300456.QAA07452@stat1.stat.auckland.ac.nz>
 <199704300552.HAA17098@aragorn.ci.tuwien.ac.at>
Message-ID: <x2iv144yl3.fsf@bush.kubism.ku.dk>

Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

> Indeed, `qt(0.975, 3)' now also works on Debian Linux/GNU/ix86 when
> compiled with `-O2 -g'.
> 
> Thanks!
> 
> (Of course, this is the only example I tried thus far ...)
> 

I suspect that the problem will just crop up again with a different
parameter combination. The original problem was really in qbeta.c, not
pbeta.c. Some of those routines are squeezing the last bit of accuracy
out by doing the computations in a carefully planned sequence. Along
comes the gcc optimizer and says "but it's faster to do it this way",
shuffles the instructions around and we get these problems with
termination criteria that are sometimes never met, depending on bit
patterns at the far end of intermediate results.

(The prototypical problem is that in computers, x + delta - x == 0 for
large x and small delta - unless the compiler decides to use
associativity commutativity and eliminate the x'es. Slightly more
elaborate version is x+delta-y with x and y already in registers and
being almost equal.)

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Wed Apr 30 11:04:24 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 30 Apr 97 12:04:24 +0200
Subject: R-alpha: New pbeta.c : Still problems for BIG 'df' (and an S-bug)
In-Reply-To: <199704300456.QAA07452@stat1.stat.auckland.ac.nz> (message from
 Ross Ihaka on Wed, 30 Apr 1997 16:56:08 +1200 (NZST))
Message-ID: <9704301004.AA01392@>

I've only made a few experiments using  qt(.)  with the new pbeta.c:

At least the problem of  "BIG df" --> 'long/infinite' CPU  remains even
though it has been pushed slightly

For 0.49 'plain', 
	qt(.99, 10^k) already takes quite some time for k=5, and 
			takes for ever for k=7
Try
	for(ee in 1:6) cat(10^ee,":", unix.time(qt(.99,df=10^ee))[1],"\n")

For the new  pbeta.c,  the problem appears about two exponents later.

 	qt(.99, df = 1e8)	## 'never' returns

The following code shows you a bit of what is going on.

BTW, S-plus seems to use a different approximation which remains fast even
when df = BIG.
However, S-plus results then become COMPLETELY RUBBISH!

Here are my few tests:

p <- c(.975, .995, .9995, 1 - 5e-6)
df1 <- c(1:5,10^c(1:8,10,15,10*(2:10)))
df0 <- df1[1:12] ## df0  works for  R 0.49 -patch2-

dig <- 8
for(df in df0)
  cat(formatC(df,w=6),":", formatC(unix.time(qq <- qt(p, df))[1],form='f'), "|",
      formatC(qq, form='f', dig=dig,wid=dig+6),"\n")
cat(" _Inf_ :  ---   |", formatC(qnorm(p), form='f', dig=dig,wid=dig+6),"\n")

## R 0.49  with  pbeta.c  of 30 April 1997:

   df  :  CPU[s]|     q  .975           .995         .9995       .999995=1-5e-6

     1 : 0.0100 |    12.70620474    63.65674116   636.61924876 63661.96977709
     2 : 0.0200 |     4.30265273     9.92484320    31.59905458   316.22539430
     3 : 0.0000 |     3.18244631     5.84090931    12.92397864    60.39682404
     4 : 0.0000 |     2.77644511     4.60409487     8.61030158    27.77164766
     5 : 0.0100 |     2.57058184     4.03214298     6.86882663    17.89686614
    10 : 0.0100 |     2.22813885     3.16927267     4.58689386     8.15028656
   100 : 0.0900 |     1.98397152     2.62589052     3.39049131     4.65424006
  1000 : 0.0300 |     1.96233908     2.58075470     3.30028265     4.43992647
 1e+04 : 0.0400 |     1.96020124     2.57632105     3.29149997     4.41943950
 1e+05 : 0.1300 |     1.95998771     2.57587847     3.29062403     4.41739993
 1e+06 : 0.2800 |     1.95996636     2.57583422     3.29053646     4.41719606
 1e+07 : 0.3800 |     1.95996422     2.57582979     3.29052770     4.41717568
 _Inf_ :  ---   |     1.95996398     2.57582930     3.29052672     4.41718074

## S-plus (3.4): From df ~= 1e4 (p=1-5e-6) results are COMPLETELY wrong !
## ----- You get quick results for even higher 'df' -- but they are wrong...

     1 : 0.0100 |    12.70620474    63.65674116   636.61924876 63661.96770658
     2 : 0.0000 |     4.30265273     9.92484320    31.59905458   316.22539430
     3 : 0.0000 |     3.18244631     5.84090931    12.92397864    60.39682404
     4 : 0.0100 |     2.77644511     4.60409487     8.61030158    27.77164766
     5 : 0.0000 |     2.57058184     4.03214298     6.86882663    17.89686614
    10 : 0.0000 |     2.22813885     3.16927267     4.58689386     8.15028656
   100 : 0.0100 |     1.98397152     2.62589052     3.39049131     4.65424006
  1000 : 0.0200 |     1.96233908     2.58075470     3.30028265     4.43992647
 1e+04 : 0.0200 |     1.96020124     2.57632105     3.29966223     4.70204286
 1e+05 : 0.0200 |     1.95998771     2.57587848     5.14482712    12.48628360
 1e+06 : 0.0100 |     1.95996636     2.57583569    14.70818229    38.67299101
 1e+07 : 0.0200 |     1.95996422     2.57600108    45.98857869   122.03496539
 _Inf_ :  ---   |     1.95996398     2.57582930     3.29052673     4.41717341

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Wed Apr 30 11:38:51 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 30 Apr 1997 12:38:51 +0200
Subject: R-alpha: write()
Message-ID: <199704301038.MAA18107@aragorn.ci.tuwien.ac.at>

Following my posting of a write.table() function, Martin suggested that
one could have a generic write() function and special methods for
e.g. time series, data frames, etc.

Well, a month has passed since ...

What does everyone think?  Is it a good idea, or would write.table() be
enough?  If we think that it is not enough, which arguments should the
write methods typically allow?  What about

	write.xxx (x,		# object
		   file =       # filename, default stdout
                   append =     # obvious
                   sep =	# obvious
		   eol =        # end of line char
                   ...)

???

On the other hand, it seems clear that something like write.table() is
nice, and what it should do.  But what about classes other than
data.frame?

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From luke@stat.umn.edu  Wed Apr 30 16:44:31 1997
From: luke@stat.umn.edu (Luke Tierney)
Date: Wed, 30 Apr 1997 10:44:31 -0500 (CDT)
Subject: R-alpha: Re: S Compatibility
Message-ID: <9704301544.AA10475@nokomis.stat.umn.edu>

On the memory/database/persistent storage issue,the Texas persistent
store, for which Rscheme has an interface, some of the stuff on object
serialization in Java (Java beans variant of OpenDoc's
Bento/quilt/whatever) and (gulp) OLE structured storage might be worth
a look in this context also.
 
luke


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Wed Apr 30 16:55:23 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 30 Apr 97 17:55:23 +0200
Subject: R-alpha: write()
In-Reply-To: <199704301038.MAA18107@aragorn.ci.tuwien.ac.at> (message from
 Kurt Hornik on Wed, 30 Apr 1997 12:38:51 +0200)
Message-ID: <9704301555.AA01443@>

Note that S has a  write(.)  function  which would be our
	write.default(.)

your	write.table	    would be our 
	write.data.frame

The only addition would be a  'write.matrix' which would be 'like'
write.data.frame, the only problem being that  'matrix' is not a class (yet).
	[Note that in S4, everything has a class; 
	   I'm voting for matrices to have a class in R  ..]
write.default  could 'despatch' to write.matrix if  x  is a matrix.
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Wed Apr 30 17:42:52 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Wed, 30 Apr 1997 09:42:52 -0700 (PDT)
Subject: R-alpha: ==NULL
In-Reply-To: <199704301038.MAA18107@aragorn.ci.tuwien.ac.at>
Message-ID: <Pine.SUN.3.95.970430093849.302A-100000@zen>


Any comparison with NULL generates an error
Error: comparison is possible only for vector types
whereas in S(-PLUS) it gives NA, which seems more sensible.

Along similar lines, comparison with a length 0 vector returns logical(0)
in R but NA in S. 

Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From la-jassine@aix.pacwan.net  Wed Apr 30 11:25:51 1997
From: la-jassine@aix.pacwan.net (Paul Gilbert)
Date: Wed, 30 Apr 1997 07:25:51 -0300
Subject: R-alpha: small complex problems
Message-ID: <1349681347-914582@aix.pacwan.net>

Mod, Re, Im, and Conj should work for Real numbers using as.complex

complex should be
   complex <- function (n = 0, real = numeric(), imaginary = numeric())
not 
   complex <- function (n = 0, real = numeric(), imag = numeric()) 


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From la-jassine@aix.pacwan.net  Wed Apr 30 11:25:59 1997
From: la-jassine@aix.pacwan.net (Paul Gilbert)
Date: Wed, 30 Apr 1997 07:25:59 -0300
Subject: R-alpha: false warnings
Message-ID: <1349681339-915060@aix.pacwan.net>

In R 0.49 comparison of logic matrices with & and | seems to sometimes
generate false warning messages about longer object length is not a multiple
of shorter object length. I have not been able to isolate the exact
circumstances.

Paul Gilbert

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From la-jassine@aix.pacwan.net  Wed Apr 30 11:25:53 1997
From: la-jassine@aix.pacwan.net (Paul Gilbert)
Date: Wed, 30 Apr 1997 07:25:53 -0300
Subject: R-alpha: generic print
Message-ID: <1349681345-914696@aix.pacwan.net>

I have  always thought that typing the name of an object generated a call to
the print method for the object, however,  (in 0.49) I redefined the generic
print method as 

print <- function(x, ...)
 {if (is.tframe(x))  UseMethod("print.tframe")
  else UseMethod("print")
 }

Now I have an object z which returns TRUE to is.tframe(z) and
> class(z)
[1] "ts"     "tframe"

Then

> print(z)
[1] 1981.50 2006.25    4.00

But
> z
Error: comparison is possible only for vector types

> traceback()
[1] "c(\"print.ts(structure(c(1981.5, 2006.25, 4), class = c(\\\"ts\\\",
\\\"tframe\\\"\", "
[2] "c(\"print(structure(c(1981.5, 2006.25, 4), class = c(\\\"ts\\\",
\\\"tframe\\\"\", "   

This is generating a call to the class method print.ts rather than to
print.tframe.ts as is done when I use print(z).  If my understanding that
typing the name of an object should generate a call to the print method for
the object then this is a bug. Otherwise, could someone please explain to me
what it does. Thanks.

Paul Gilbert

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Wed Apr 30 22:01:33 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Thu, 1 May 1997 09:01:33 +1200 (NZST)
Subject: R-alpha: Re: R-beta: Re: S Compatibility
Message-ID: <199704302101.JAA10310@stat1.stat.auckland.ac.nz>

Peter Dalgaard writes:

> > Its something we definitely need (almost as much as REAL libraries).
> > If only there were another 24 hours in each day ...

> No problem. You just need someone as smart as you are to chip in with
> the development. Or four people half as smart ;^)

Or half the time of someone twice as smart ...
Did I see you putting your hand up? :-)

> There might also be some more "brutal" approaches, such as having the
> vector heap as a memory-mapped file, leaving the cacheing and similar
> work to the operating system. OS's are already quite good at handling
> files with holes in them, so it's not like allocating a huge file just
> for a handful af variables. Some special routines for defragmentation
> might be necessary, though. Not that I really know what I'm talking
> about...

I recall that the reason we got into this is first place was watching
S thrashing our disks to bits while the cpus stood idle ...
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Apr  1 09:28:56 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 1 Apr 97 10:28:56 +0200
Subject: R-alpha: Re: R-Prerelease  ---- Mailing list  "R-devel"
In-Reply-To: <9704010826.AA00322@> (message from Martin Maechler on Tue, 1 Apr
 97 10:26:38 +0200)
Message-ID: <9704010828.AA00328@>

well yes,  I've only sent mail to R-devel,...

When I started, I thought I would first let you give feedback on it,..
I can still change some of the names if any of you thinks it's necessary

	(and yes, no  "April's fool" included...)

Martin 
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Tue Apr  1 09:35:43 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 1 Apr 1997 10:35:43 +0200
Subject: R-alpha: Re: R-Prerelease  ---- Mailing list  "R-devel"
In-Reply-To: <9704010828.AA00328@>
References: <9704010826.AA00322@>
 <9704010828.AA00328@>
Message-ID: <199704010835.KAA30138@aragorn.ci.tuwien.ac.at>

>>>>> Martin Maechler writes:

> well yes,  I've only sent mail to R-devel,...
> When I started, I thought I would first let you give feedback on it,..
> I can still change some of the names if any of you thinks it's necessary

> 	(and yes, no  "April's fool" included...)

:-)

Martin:

Very good idea.  (In fact, I was thinking of proposing something similar
in a few days ...).  Of course, it means that I now have to rewrite the
FAQ more or less completely (0.50, CRAN, new mailing lists, ...).

Could you change my entry to
	Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at>
???

-k

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Thu Apr  3 08:50:54 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Thu, 3 Apr 97 09:50:54 +0200
Subject: R-alpha: Re: Pretest Version + Notes --- write.table
In-Reply-To: <199704021013.MAA09534@aragorn.ci.tuwien.ac.at> (message from
 Kurt Hornik on Wed, 2 Apr 1997 12:13:25 +0200)
Message-ID: <9704030750.AA03413@>


Kurt writes

KH>> * I am also not sure whether one should include the write.table()
KH>> function I posted some time ago.  It seems to be a bad idea to make a
KH>> contrib package out of it (containing only a single function ...).

Yes, I think we should have a good  "write" function for  data.frames.
However, I would go even further and 'vote' for a GENERIC function  'write'
which has methods for
	default	  (including 'matrix'  as long as 'matrix' is not a class)
	data.frame
	....	['ts', ...]

The following is code that I've been using in S-plus for a while and have
adapted to R:
--- Note that it uses something  more primitive than Kurt's write.table.
    The issue really was to be able to "write a data.frame or matrix" such that
    read.table would reproduce it.


write <- function(x, file = "data", ...) UseMethod("write")

write.default <- function (x, file = "data",
			   ncolumns = if (is.character(x)) 1 else 5,
			   append = FALSE, ...)
{
  if(is.matrix(x))
    write.matrix(x, file=file, append= FALSE, ...)
  else
    write0.basic(x, file = file, ncolumns= ncolumns, append = append)
}

write0.basic <- function (x, file, ncolumns, append = FALSE)
  cat(x, file = file, sep = c(rep(" ", ncolumns - 1), "\n"), append = append)

write.data.frame <- function(x, file = "data", rownames = TRUE)
{
  ## Purpose: Method to 'write(.)' such as to read back using  read.table(.)
  ## -------------------------------------------------------------------------
  ## Arguments:       x : data frame;			file : file name
  ##            rownames: if T, also write row names
  ## -------------------------------------------------------------------------
  ## Author: Martin Maechler <maechler@stat.math.ethz.ch>,  1992
  ## -------------------------------------------------------------------------
  ##-- NOT for "parametrized" data.frames; just ``simple'' matrix look-a-likes
  ##-- NOTE: read.table(file) may still give different data.frame --
  ##-- ~~~~  	        (namely,e.g., when some names contained padding blanks)
  ##-- 	    But the "new" names may actually be better .. (!) ..
  ## EXAMPLE:
  ##   data(women); write(women, file= "women.dat")
  ##   wm <- read.table("women.dat")) 
  ##   all.equal(wm, women) ##> TRUE
  if(!is.data.frame(x)) { #-- can only happen when called explicitely
    warning("'x' is not a data.frame; coercing it to one ...")
    x <- data.frame(x)
  }
  cat( names(x), "\n", file = file, append = FALSE)
  write0.basic(unclass(t(cbind(if(rownames)row.names(x), as.matrix(x)))),
	       ncolumns = rownames + ncol(x), file= file, append= TRUE)
}

write.matrix     <- function(x, file = "data", rownames = TRUE)
  write(data.frame(as.matrix(x)), file=file, rownames=rownames)

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Thu Apr  3 13:45:55 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Thu, 3 Apr 97 14:45:55 +0200
Subject: R-alpha: R0.50-pre6:  "stack imbalance in ..." //  is.vector(matrix...)
Message-ID: <9704031245.AA03766@>

[[[ To the new subscribers of the  R-devel  mailing list:
    The latest  prerelease of R 0.50 has not been
    announced to this mailing list, by accident.

  In short, get		R6.tgz  and  R6-update.shar.gz,

  from	ftp://stat.auckland.ac.nz/pub/ihaka/

  and first unpack  the tar file, then the shar file in the same
  directory..
]]]

and to ALL  "R-devel"oppers:
	
	Yes, please use this mailing list to report
	bugs / fixes / annotations / suggestions ...	

-- Martin [after ``e-talking'' to Ross]
------------------------------------------------------------------------

Quite strange error / warning messages that I am getting here:

   > prompt(prompt)
   stack imbalance in internal as.vector, 22 then 21
   stack imbalance in .Internal, 21 then 20
   stack imbalance in <-, 16 then 15
   created file named  prompt.man  in the current directory.
     Edit the file and move it to the appropriate directory,
    /soft/sunos5_1/R-prealpha-0.50-6/src/manual/man/ dropping the ending '.man'
   stack imbalance in {, 14 then 13

The first three messages are created by "as.character" on a 'symbol'
object:

   > (function(x) as.character(substitute(x)))(abc)
   stack imbalance in internal as.vector, 9 then 8
   stack imbalance in .Internal, 8 then 7
   Error: stack imbalance in "unprotect"

-------
The 2nd remark is both a bug and a feature report:

Good news:  One long standing  S(-plus) bug  has been fixed in R:

	is.vector( __named_vector__ )   finally gives TRUE

Bad  news:  is.vector( __matrix__ )  now also is TRUE which is not wanted IMHO.

> is.vector(structure(1:9, names=letters[1:9]))
[1] TRUE
> is.vector(cbind(1,1:3))
[1] TRUE
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Sun Apr  6 10:56:59 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Sun, 6 Apr 1997 21:56:59 +1200 (NZST)
Subject: R-alpha: Some name changes
Message-ID: <199704060956.VAA07988@stat1.stat.auckland.ac.nz>

I would like to raise the possibility of some function name
changes.  For compatibility with S it might be good to change

	"dotplot" to "dotchart"
	"piechart" to "pie"

(are there any others?).  Is either of these a good idea?
(I would actualy like to change "piechart" to something
like

	piechart.use.this.function.and.you.will.catch.ebola

to discourage people from using it, but perhaps sneaking
a segmentation violation into the code will do the trick :-)

We could also replace "save.plot" and " print.plot" by a
single function

	hardcopy(file, printcmd="lpr")

which would work as follows:  If "file" is specified, the
onscreen plot is saved as encapsulated postscript (or whatever
the platform standard is), otherwise the postscript is piped
to the command specified by printcmd.  This would replace
two commands with one.

Even when multiple active devices happen (soonish???),
I think that having a command like this would probably be
useful.
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Sun Apr  6 21:58:11 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Mon, 7 Apr 1997 08:58:11 +1200 (NZST)
Subject: R-alpha: What should is.vector do?
Message-ID: <199704062058.IAA09618@stat1.stat.auckland.ac.nz>

[ Consumer warning: This is a little technical ... ]

I have been pondering the question

		What should is.vector do?

Martin has raised this a number of times.  I ran a few tests 
in S and got the following results.

	S> is.vector(list(1,2,3))
	[1] T
	S> is.vector(expression(a+b))
	[1] T
	S> is.vector(as.name("x"))
	[1] T  
	S> is.vector(NULL)
	[1] T
	S> x <- 1:5
	S> is.vector(x)
	[1] T
	S> names(x) <- letters[1:5] 
	S> is.vector(x)
	[1] F

Essentially, everything in S is a vector unless it has attributes.
This is utterly unreasonable!  Why should something stop being a
vector because it has a names attribute attached.
	
Internally in R, we have a predicate isVector() which returns
true if its argument has one of the storage modes "logical",
"factor", "ordered", "integer", "real", "complex" and "character".
This is useful because these are the types which can be subscripted 
(without using CAR and CDR).  We almost certainly need an external
version of this predicate.  I suppose that it could be called	 
is.vector.mode(x).

Another reasonable definition of "vector" is !is.array(x).
or possibly "isVector(x) == 1 && !is.array(x)

What complicates things is that there is a second argument
which specifies a mode for the vector.  In S, it is possible to
have calls like

	is.vector(x, "list")
	is.vector(x, "language")

We have gone some way down the road to mimicing this behaviour,
but it really doesn't fit naturally into the R model.

Looking at our own code base, I see that "is.vector" is used only
in the "data.entry" functions, (and I think I need to check that
code carefully).  We seem to use the predicates

	is.list(x)
	is.language(x)

etc in preference to the above.

Anyway, can we communally come to (reasonably) firm conclusion about
what is.vector should do?  I'm prepared to implement almost anything,
but I'm rather confused about exactly what is.vector should do.
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Mon Apr  7 08:33:51 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Mon, 7 Apr 97 09:33:51 +0200
Subject: R-alpha: What should is.vector do?
In-Reply-To: <199704062058.IAA09618@stat1.stat.auckland.ac.nz> (message from
 Ross Ihaka on Mon, 7 Apr 1997 08:58:11 +1200 (NZST))
Message-ID: <9704070733.AA00396@>


Ross>> Internally in R, we have a predicate isVector() which returns
Ross>> true if its argument has one of the storage modes "logical",
Ross>> "factor", "ordered", "integer", "real", "complex" and "character".
Ross>> This is useful because these are the types which can be subscripted 
Ross>> (without using CAR and CDR).  We almost certainly need an external
Ross>> version of this predicate.  I suppose that it could be called	 
Ross>> is.vector.mode(x).

Yes, "export"  isVector  as  'is.vector.mode'!

Ross>> Another reasonable definition of "vector" is !is.array(x).
Ross>> or possibly "isVector(x) == 1 && !is.array(x)
Yes, I think
		isVector(x) == 1 && !is.array(x)

is the way to go, at least for   mode = 'any'

Now, for the 2nd argument  mode = '...' :
I think it should always be more restrictive, i.e.,
	  is.vector(OB, mode= MODE)   <-->   is.vector(OB) &&  MODE.test(OB)

which is not the case currently [[correcting a typo in $RHOME/TASKS l.449-451]

 is.vector(call("ls"))			#[1] FALSE
 is.vector(call("ls"), mode='language')	#[1] TRUE
 is.vector(call("ls"), mode='call')	#[1] FALSE

[[here, is.vector(call("ls"), mode='any')  should really return TRUE]]
  
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Apr  8 09:43:55 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 8 Apr 97 10:43:55 +0200
Subject: R-alpha: Seg.faults with complex: factor(..), unique(..).  Missing feature ``sort( complex(..) )''
Message-ID: <9704080843.AA01399@>

1) Several functions still (0.50 - pre6)
   give seg.faults when called with complex:

unique( 1i)  --> segfault
In 'factor', levels are defaulted to  'sort(unique(x))'
which seg.faults  factor( 1i).

Because of 'factor', table(..complex..)  seg.faults,.....


2)  sort ( complex )   [[Of course this is minor ..]]

You may not believe this can be useful, but...
I've been digging in old S-code  which makes use of this (and also of unique(.))

Be  
	z = x + 1i*y;   x,y real vectors
Then,  
	order(z)   : <-->  order(x,y)

This is how it is defined in S (but it is implemented via .Internal(..)).

One could add the following line to the definition of 'sort'

	if(is.complex(x)) return( x[order(Re(x),Im(x))] )

which has the drawback of NOT using the 'partial' and  'na.last' arguments.
((This actually makes me think that
  maybe  'order' should also accept these two)).
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Tue Apr  8 17:47:59 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Tue, 8 Apr 1997 09:47:59 -0700 (PDT)
Subject: R-alpha: rbind
In-Reply-To: <9704010823.AA00318@>
Message-ID: <Pine.SUN.3.91.970408094156.9023A-100000@chekov>

rbind() does something strange to dimnames

R : Copyright 1997, Robert Gentleman and Ross Ihaka
Version 0.50 Beta (April 1, 1997)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type "license()" for details.

> test1 <- data.frame(time=  c(4, 3,1,1,2,2,3),
   +     status=c(1,NA,1,0,1,1,0),
  +     x=     c(0, 2,1,1,1,0,0))
> temp<-as.matrix(test1)
> dimnames(temp)
[[1]]
NULL

[[2]]
[1] "time"   "status" "x"     

> temp<-rbind(temp,temp)
Error: invalid type for dimnames: must be a list
> dimnames(temp)
[[1]]
NULL
Segmentation fault (core dumped)

Part of the problem is that as.matrix() doesn't set dimnames()[[1]]. If I 
set this by hand everything works. Even so, the rbind function should 
succeed or fail -- it shouldn't mutilate its arguments like this.


Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Tue Apr  8 18:04:19 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Tue, 8 Apr 1997 10:04:19 -0700 (PDT)
Subject: R-alpha: as.numeric
In-Reply-To: <Pine.SUN.3.91.970408094156.9023A-100000@chekov>
Message-ID: <Pine.SUN.3.91.970408100342.9023B-100000@chekov>


as.numeric() turns a logical matrix into a numeric vector. Shouldn't it 
stay a matrix?


Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Tue Apr  8 18:27:48 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 08 Apr 1997 19:27:48 +0200
Subject: R-alpha: User friendly functions
Message-ID: <x2k9md77cb.fsf@bush.kubism.ku.dk>

A loose idea for *post*-0.50 development

I've been giving a some (but not all that many) thoughts to whether
some of the conceptual difficulties facing newcomers could be avoided
by having simplified functions for common operations. We already have
parts of this, e.g. in Kurts ctest routines. Specifically, I was
thinking about data frames: How about

dfr.sel<-select.frame(dfr,age,sex,pain1:pain5)

with the : specifying a range, instead of 

dfr.sel<-dfr[,c(1,2,5,6,7,8,9)] 

or 

attach(dfr)
dfr.sel<-data.frame(age,sex,pain1,pain2,pain3,pain4,pain5) 
detach(dfr)

(which isn't even safe if there are variables of the same name in the
global environment)

similarly, how about

dfr.sub<-subset.frame(dfr,sex==1 && age > 30)

rather than

dfr.sub<-dfr[dfr$sex==1 && dfr$age > 30,]

Both would seem to be quite possible to implement, although they do
need to do some sneaky bits of computing-on-the-language internally.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Tue Apr  8 19:03:38 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 8 Apr 1997 20:03:38 +0200
Subject: R-alpha: CRAN source/contrib
Message-ID: <199704081803.UAA13616@aragorn.ci.tuwien.ac.at>

Oops, forgot to attach the INDEX file:

CRAN/source/contrib currently contains:

acepack.tar.gz:
	ace (Alternating Conditional Expectations) and avas (Additivity
	and variance stabilization for regression) for selecting
	regression transformations.

	avas S original by Rob Tibshirani <tibs@utstat.toronto.edu>.
	R port by Thomas Lumley <thomas@biostat.washington.edu>.
	[1997/04/08]
	
bootstrap.tar.gz:
	Software (bootstrap, cross-validation, jackknife), data and
	errata for the book "An Introduction to the Bootstrap" by B.
	Efron and R.  Tibshirani, 1993, Chapman and Hall.

	S original by Rob Tibshirani <tibs@utstat.toronto.edu>.
	R port by Fritz Leisch <Friedrich.Leisch@ci.tuwien.ac.at>.
	[1997/04/08]

ctest.tar.gz:
	A library of classical tests, including the Bartlett, Fisher,
	Kruskal-Wallis, Kolmogorov-Smirnov, and Wilcoxon tests.
	
	Written by Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at>.
	[1997/04/08]

date.tar.gz:
	Functions for dealing with dates.  The most useful of them
	accepts a vector of input dates in any of the forms 8/30/53,
	30Aug53, 30 August 1953,..., August 30 53, or any mixture of
	these.

	S original by Terry Therneau <therneau@mayo.edu>.
	R port by Thomas Lumley <thomas@biostat.washington.edu>.
	[1997/04/08]

e1071.tar.gz:
	Miscellaneous functions used at the Department of Statistics at
	TU Wien (E1071).

	Compiled by Fritz Leisch <Friedrich.Leisch@ci.tuwien.ac.at>.
	[1997/04/08]	

fracdiff.tar.gz:
	Maximum likelihood estimation of the parameters of a
	fractionally differenced ARIMA(p,d,q) model (Haslett and
	Raftery, Applied Statistics, 1989).

	S original by Chris Fraley <fraley@stat.washington.edu>.
	R port by Fritz Leisch <Friedrich.Leisch@ci.tuwien.ac.at>.
	[1997/04/08]

gee.tar.gz:
	An implementation of the Liang/Zeger generalized estimating
	equation approach to GLMs for dependent data.

	S original by Vincent Carey <carey@biostat.harvard.edu> and
	Aidan McDermott.
	R port by Thomas Lumley <thomas@biostat.washington.edu>.
	[1997/04/08]

jpn.tar.gz:
	A function to plot Japan's coast-line and prefecture
	boundaries.

	S original by Ritei Shibata <shibata@statlab.math.keio.ac.jp>.
	R port by Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at>.
	[1997/04/08]	

snns.tar.gz:
	An R interface to the Stuttgart Neural Networks Simulator
	(SNNS).

	Written by Fritz Leisch <Friedrich.Leisch@ci.tuwien.ac.at>.
	[1997/04/08]

splines.tar.gz:
	Regression spline functions.

	S original by Doug Bates <bates@stat.wisc.edu>.
	R port by Thomas Lumley <thomas@biostat.washington.edu>.
	[1997/04/08]

survival4.tar.gz:
	Functions for survival analysis.  This ``port'' is not complete
	yet, because it requires a few changes to the R system itself
	rather than the add-on package, but most of the functionality is
	already available.

	Requires splines.

	S original by Terry Therneau <therneau@mayo.edu>.
	R port by Thomas Lumley <thomas@biostat.washington.edu>.
	[1997/04/08]
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Tue Apr  8 18:49:33 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 8 Apr 1997 19:49:33 +0200
Subject: R-alpha: CRAN source/contrib
Message-ID: <199704081749.TAA13566@aragorn.ci.tuwien.ac.at>

I've put all ``current'' add-on packages into CRAN's source/contrib tree
and created an INDEX file (attached below).  As you can see, currently
we have

  acepack
  bootstrap
  ctest
  date
  e1071
  fracdiff
  gee
  jpn
  snns
  splines
  survival4

(Yes, e1071 and jpn are new ... more on the latter in a later mail.)

In the near future, I am hoping for the following:

  oz		(Bill Venables said should work without problems ...)
  polynom	(Has been used as a test bed for the new group methods
		 in R 0.50, so should only be a matter of packaging.
	         Or were there some changes?)
  wavethresh	(According to A. Kovac, worked under 0.12.  Thought I'd
                 ask the guy for an official port.)
  time.series	(Paul Gilbert promised an official release following the
		 release of R 0.50)

Fritz (and I) have also started to port the `clus' software which was
recently documented in an article in Journal of Statistical Software.

Also, Doug's nonlin seems to compute fine after one change, but the
output needs help.  Is this still useful, or do we have something better
for fitting nonlinear models?

As you can see from the list, we're not doing too bad ...

-k

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Tue Apr  8 19:03:01 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 8 Apr 1997 20:03:01 +0200
Subject: R-alpha: jpn() port
Message-ID: <199704081803.UAA13610@aragorn.ci.tuwien.ac.at>

I've just completing porting the S jpn package to R (available in CRAN's
source/contrib).

Some remarks:

* It seems that S allows recycling when subscripting with logicals, but
R does not.  E.g.,

R> x <- 1:5
R> x
[1] 1 2 3 4 5
R> i <- c(F, T)
R> x[i]
Error: invalid subscript type
R>

In S, this is treated as x[rep(i, length = length(x))].

* It also seems that S does not worry about excluding subscripts which
are out of bounds.  In the above, x[-6] would give x, but in R

R> x[-6]
Error: subscript out of bounds

Just wanted to point that out ...

The jpn package contains VARIABLES (``data'') as well as functions, and
I guess it is the first one to do so.  Because we don't have `data'
grouped similar to `help' yet, the data are now directly in the R
`source'.

A problem occurs when documenting such data sets ... is there a nice way
of saying that something is a list with components
	a ....
	b ...
	c ...
using the R doc format?

Finally, here's something that's also been on my mind for some time now
(and also needed help in the port).  Code like

	if(all(names(x)) == c("x", "y"))

fails if names(x) is NULL.  Is that really necessary?  (More precisely,
obviously we only want to test whether the two objects have equal
values, a la Lisp `equal').

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Tue Apr  8 23:16:43 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 09 Apr 1997 00:16:43 +0200
Subject: R-alpha: as.numeric
In-Reply-To: Thomas Lumley's message of Tue, 8 Apr 1997 10:04:19 -0700 (PDT)
References: <Pine.SUN.3.91.970408100342.9023B-100000@chekov>
Message-ID: <x2iv1xtb1w.fsf@bush.kubism.ku.dk>

Thomas Lumley <thomas@biostat.washington.edu> writes:

> as.numeric() turns a logical matrix into a numeric vector. Shouldn't it 
> stay a matrix?

It *sounds* wrong, but:

S-PLUS : Copyright (c) 1988, 1996 MathSoft, Inc.
S : Copyright AT&T.
Version 3.4 Release 1 for Sun SPARC, SunOS 5.3 : 1996 
Working data will be in .Data 
> cbind(c(T,T),c(F,F))
     [,1] [,2] 
[1,]    T    F
[2,]    T    F
> as.numeric(.Last.value)
[1] 1 1 0 0

In fact, it does the same with numeric matrices.

To convert logical matrix to character matrix in Splus, you could
either add zero or use mode(x)<-"numeric", same thing in R.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Tue Apr  8 23:26:43 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 09 Apr 1997 00:26:43 +0200
Subject: R-alpha: jpn() port
In-Reply-To: Kurt Hornik's message of Tue, 8 Apr 1997 20:03:01 +0200
References: <199704081803.UAA13610@aragorn.ci.tuwien.ac.at>
Message-ID: <x2hghhtal8.fsf@bush.kubism.ku.dk>

Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

> Finally, here's something that's also been on my mind for some time now
> (and also needed help in the port).  Code like
> 
> 	if(all(names(x)) == c("x", "y"))
> 
> fails if names(x) is NULL.  Is that really necessary?  (More precisely,
> obviously we only want to test whether the two objects have equal
> values, a la Lisp `equal').

According to my parenthesis count, that expression will fail in any
case! However, I get your drift. Splus has
> all(NULL)
[1] T
> any(NULL)
[1] F

Which makes sense for cases like yours. R should probably conform to
this. 

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Wed Apr  9 07:34:29 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 9 Apr 97 08:34:29 +0200
Subject: R-alpha: as.numeric
In-Reply-To: <Pine.SUN.3.91.970408100342.9023B-100000@chekov> (message from
 Thomas Lumley on Tue, 8 Apr 1997 10:04:19 -0700 (PDT))
Message-ID: <9704090634.AA01856@>


>>>>> "Thomas" == Thomas Lumley <thomas@biostat.washington.edu> writes:

    Thomas> as.numeric() turns a logical matrix into a numeric
    Thomas> vector. Shouldn't it stay a matrix?

One first would think so.
However, R here behaves as S.

>From ?as.numeric of S-plus 3.4:
S> VALUE:
S>        ....
S> 
S>        as.numeric returns a vector like x, but with storage  mode
S>        "double",  if  x  is  a  simple  object of mode "numeric".
S>        Otherwise, as.numeric returns a numeric object of the same
S>        length  as  x  and  with  data resulting from coercing the
S>        elements of x to mode "numeric".

The following shows the old (in S) quite usual ``workaround''.
The following code works `identically' in R and S :

> Mas.numeric <- function(x){ mode(x) <- "numeric"; x}
> M <- cbind("1",1:3); M
     [,1] [,2]
[1,] "1"  "1" 
[2,] "1"  "2" 
[3,] "1"  "3" 
> as.numeric(M)
[1] 1 1 1 1 2 3
> Mas.numeric(M)
     [,1] [,2]
[1,]    1    1
[2,]    1    2
[3,]    1    3
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Wed Apr  9 10:17:37 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 9 Apr 97 11:17:37 +0200
Subject: R-alpha: R <-> S compatibility; more demos -- using  S-plus validate(..) ..
Message-ID: <9704090917.AA01943@>

Look at the result of
(in S-plus:)
	validate(verbose=TRUE, outfile="......./validate-3.4.out")

which gives (for me, S-plus 3.4 on Solaris 2.5) 
2106 Lines of output.
It's full of tests using "standard data sets".  (-->  'demos' available!)

Basically, at the end of each example, there are  statements which
should return  TRUE  if the 'validation test' is passed, e.g.,
	all(c(b.test$statistic == 1, abs(b.test$p.value - 0.1562) < tol, 
	      b.test$alternative == "two.sided"))

One bigger job would be to run these through R and analyze the
results... -- any volunteers ?
	
	((I could even send you the file if don't have S-plus
	  available...))

-- Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Apr 11 08:18:42 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 11 Apr 97 09:18:42 +0200
Subject: R-alpha: R-lists archives: "timeout" since April 1 -- have you saved all?
Message-ID: <9704110718.AA02705@>

For a silly file permission reason,
the automatical archiving of the three mailing lists hasn't been working
from April 1 till April 10.

If any of you has a "complete" archive of this time-period;
I'd be glad to fix the archives.
((I have an own  ``close to complete'' archive)).

-- Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-


From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Apr 11 08:18:42 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 11 Apr 97 09:18:42 +0200
Subject: R-alpha: R-lists archives: "timeout" since April 1 -- have you saved all?
Message-ID: <9704110718.AA02705@>

For a silly file permission reason,
the automatical archiving of the three mailing lists hasn't been working
from April 1 till April 10.

If any of you has a "complete" archive of this time-period;
I'd be glad to fix the archives.
((I have an own  ``close to complete'' archive)).

-- Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Apr 14 09:04:34 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 14 Apr 1997 10:04:34 +0200
Subject: R-alpha: jpn() port
In-Reply-To: <x2hghhtal8.fsf@bush.kubism.ku.dk>
References: <199704081803.UAA13610@aragorn.ci.tuwien.ac.at>
 <x2hghhtal8.fsf@bush.kubism.ku.dk>

>>>>> Peter Dalgaard BSA writes:

> Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:
>> Finally, here's something that's also been on my mind for some time now
>> (and also needed help in the port).  Code like
>> 
>> if(all(names(x)) == c("x", "y"))
>> 
>> fails if names(x) is NULL.  Is that really necessary?  (More precisely,
>> obviously we only want to test whether the two objects have equal
>> values, a la Lisp `equal').

> According to my parenthesis count, that expression will fail in any
> case!

Yes ... I meant

	if(all(names(x) == c("x", "y")))

> However, I get your drift. Splus has
>> all(NULL)
> [1] T
>> any(NULL)
> [1] F

> Which makes sense for cases like yours. R should probably conform to
> this.

Actually, I am not sure about that, but it does not solve the problem.
If you look at the code in the S jpn package, it contains

	if(all(names(region) == c("x", "y")))

If region has no names attribute,

	all(names(region) == c("x", "y"))

gives NA and if(NA) (correctly) gives ``Error: Missing value where
logical needed''.  The problem is that NULL == something gives NA.
(Should it really do that?)

But perhaps it is better anyway to force the programmer to check for
NULL values before comparisons ...

-k

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-


From Martin Maechler <maechler@stat.math.ethz.ch>  Mon Apr 14 09:25:09 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Mon, 14 Apr 97 10:25:09 +0200
Subject: R-alpha: Re: Mailing list archives -- ok -- thank you
Message-ID: <9704140825.AA00396@>

Thanks to Peter Dalgaard   
who was the first one to offer me help
I've about everything I need for the archives of the 3 mailing lists.

Thank you all	-- Martin.

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Apr 14 14:00:31 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 14 Apr 1997 15:00:31 +0200
Subject: R-alpha: problems qith require/provide
Message-ID: <199704141300.PAA00699@aragorn.ci.tuwien.ac.at>

If I call require() with the most current snapshot and patches, I get

	Error: Object ".Provided" not found

The problem is with

	if (is.na(match(name, .Libraries)) &&
            is.na(match(name, .Provided))) {

which fails if .Provided does not exist yet.  Perhaps it should be
defined in Rprofile, similar to .Libraries?

Also, is the 

  if (!exists(".Libraries", inherits = TRUE)) {
    assign(".Libraries", character(0), NULL)
  }

really needed then?

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Apr 14 14:03:39 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 14 Apr 1997 15:03:39 +0200
Subject: R-alpha: problem with survival4 and ":="
Message-ID: <199704141303.PAA00724@aragorn.ci.tuwien.ac.at>

Has ":=" been eliminated?  It seems to be gone from the most current
snapshot, which makes loading survival4 fail (it contains 6 `:='
assignments in header.R).

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Apr 14 17:33:55 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 14 Apr 1997 18:33:55 +0200
Subject: R-alpha: CRAN source/contrib
Message-ID: <199704141633.SAA04237@aragorn.ci.tuwien.ac.at>

Several of the contrib packages were upgraded today.  Most notably,
Thomas rewrote parts of gee which were copied from Numerical Recipes.
Also, I added a port of the `oz' package which seems to work fine.

The current INDEX file is attached.  I've made several changes as
suggested.  CRAN should be announced soon (hopefully I can get to
upgrading the FAQ tonight).

-k

***********************************************
CRAN/source/contrib currently contains:

acepack.tar.gz:
	ace (Alternating Conditional Expectations) and avas (Additivity
	and variance stabilization for regression) for selecting
	regression transformations.

	S avas original by Rob Tibshirani <tibs@utstat.toronto.edu>,
	FORTRAN ace code by Friedman & Spector from Statlib.
	R package by Thomas Lumley <thomas@biostat.washington.edu>.
	(avas ported; ace modified to use double precision, and an R
	interface cloned from the avas() one).
	[1997/04/14]
	
bootstrap.tar.gz:
	Software (bootstrap, cross-validation, jackknife), data and
	errata for the book "An Introduction to the Bootstrap" by B.
	Efron and R.  Tibshirani, 1993, Chapman and Hall.

	S original by Rob Tibshirani <tibs@utstat.toronto.edu>.
	R port by Fritz Leisch <Friedrich.Leisch@ci.tuwien.ac.at>.
	[1997/04/14]

ctest.tar.gz:
	A library of classical tests, including the Bartlett, Fisher,
	Kruskal-Wallis, Kolmogorov-Smirnov, and Wilcoxon tests.
	
	Written by Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at>.
	[1997/04/08]

date.tar.gz:
	Functions for dealing with dates.  The most useful of them
	accepts a vector of input dates in any of the forms 8/30/53,
	30Aug53, 30 August 1953,..., August 30 53, or any mixture of
	these.

	S original by Terry Therneau <therneau@mayo.edu>.
	R port by Thomas Lumley <thomas@biostat.washington.edu>.
	[1997/04/08]

e1071.tar.gz:
	Miscellaneous functions used at the Department of Statistics at
	TU Wien (E1071).

	Compiled by Fritz Leisch <Friedrich.Leisch@ci.tuwien.ac.at>.
	[1997/04/14]	

fracdiff.tar.gz:
	Maximum likelihood estimation of the parameters of a
	fractionally differenced ARIMA(p,d,q) model (Haslett and
	Raftery, Applied Statistics, 1989).

	S original by Chris Fraley <fraley@stat.washington.edu>.
	R port by Fritz Leisch <Friedrich.Leisch@ci.tuwien.ac.at>.
	[1997/04/08]

gee.tar.gz:
	An implementation of the Liang/Zeger generalized estimating
	equation approach to GLMs for dependent data.

	S original by Vincent Carey <carey@biostat.harvard.edu> and
	Aidan McDermott.
	R port by Thomas Lumley <thomas@biostat.washington.edu>.
	[1997/04/14]

jpn.tar.gz:
	A function to plot Japan's coast-line and prefecture
	boundaries.

	S original by Ritei Shibata <shibata@statlab.math.keio.ac.jp>.
	R port by Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at>.
	[1997/04/08]	

oz.tar.gz:
	Functions for plotting Australias coastline and state boundaries.

	S original by Bill Venables <Bill.Venables@adelaide.edu.au>.
	R port by Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at>.
	[1997/04/14]

snns.tar.gz:
	An R interface to the Stuttgart Neural Networks Simulator
	(SNNS).

	Written by Fritz Leisch <Friedrich.Leisch@ci.tuwien.ac.at>.
	[1997/04/14]

splines.tar.gz:
	Regression spline functions.

	R port by Thomas Lumley <thomas@biostat.washington.edu>, based
	on the S packages `splines' by Doug Bates <bates@stat.wisc.edu>
	and `safe.predict' by John Chambers and Trevor Hastie.
	[1997/04/08]

survival4.tar.gz:
	Functions for survival analysis.  This ``port'' is not complete
	yet, because it requires a few changes to the R system itself
	rather than the add-on package, but most of the functionality is
	already available.

	Requires splines.

	S original by Terry Therneau <therneau@mayo.edu>.
	R port by Thomas Lumley <thomas@biostat.washington.edu>.
	[1997/04/14]
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Apr 14 17:57:44 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 14 Apr 1997 18:57:44 +0200
Subject: R-alpha: User friendly functions
In-Reply-To: <x2k9md77cb.fsf@bush.kubism.ku.dk>
References: <x2k9md77cb.fsf@bush.kubism.ku.dk>
Message-ID: <199704141657.SAA04410@aragorn.ci.tuwien.ac.at>

>>>>> Peter Dalgaard BSA writes:

> A loose idea for *post*-0.50 development
> I've been giving a some (but not all that many) thoughts to whether
> some of the conceptual difficulties facing newcomers could be avoided
> by having simplified functions for common operations. We already have
> parts of this, e.g. in Kurts ctest routines. Specifically, I was
> thinking about data frames: How about

> dfr.sel<-select.frame(dfr,age,sex,pain1:pain5)

> with the : specifying a range, instead of 

> dfr.sel<-dfr[,c(1,2,5,6,7,8,9)] 

> or 

> attach(dfr)
> dfr.sel<-data.frame(age,sex,pain1,pain2,pain3,pain4,pain5) 
> detach(dfr)

> (which isn't even safe if there are variables of the same name in the
> global environment)

> similarly, how about

> dfr.sub<-subset.frame(dfr,sex==1 && age > 30)

> rather than

> dfr.sub<-dfr[dfr$sex==1 && dfr$age > 30,]

> Both would seem to be quite possible to implement, although they do
> need to do some sneaky bits of computing-on-the-language internally.

Something like that would be very nice to have.

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Mon Apr 14 18:28:06 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 14 Apr 1997 19:28:06 +0200
Subject: R-alpha: User friendly functions
In-Reply-To: Kurt Hornik's message of Mon, 14 Apr 1997 18:57:44 +0200
References: <x2k9md77cb.fsf@bush.kubism.ku.dk>
 <199704141657.SAA04410@aragorn.ci.tuwien.ac.at>
Message-ID: <x2208dfra1.fsf@bush.kubism.ku.dk>

Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

> > dfr.sel<-select.frame(dfr,age,sex,pain1:pain5)
> 
> > dfr.sub<-subset.frame(dfr,sex==1 && age > 30)
> 
> Something like that would be very nice to have.

I got a working select.frame() during the weekend. Really easy, once you
get the hang of constructions of the type

eval(as.call(subst.expr(c(as.name("c"),expression(...)))))

- with subst.expr() recursively replacing call arguments with
corresponding numbers using match(). As a bonus, it is actually
possible to do stuff like

select.frame(psychometry,seq(scale1.before,scale15.before,2))

and get every *second* variable in the range (skipping "after"
measurements) 

Next: subset.frame() - before I do the obvious: Is there a simple way
of getting R to search a frame *before* the global environment?

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Mon Apr 14 21:09:49 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Tue, 15 Apr 1997 08:09:49 +1200 (NZST)
Subject: R-alpha: problems qith require/provide
Message-ID: <199704142009.IAA02547@stat1.stat.auckland.ac.nz>

Thomas has sent me a new version which may fix this problem.  I will
take a look.
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Mon Apr 14 21:15:34 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Tue, 15 Apr 1997 08:15:34 +1200 (NZST)
Subject: R-alpha: problem with survival4 and ":="
Message-ID: <199704142015.IAA02571@stat1.stat.auckland.ac.nz>

I did indeed take := out.  If code is loaded with "library" these can
be converted to <-.

:= was one of those temporary hacks we put in place 5 years ago and
never got around to fixing.  We already have <- and <<- as assignment
operators.  This is one assignment too many (some would say two too
many).

If it is really critical I can put it back.  I only removed the
reference from the table of internal functions, the actual code is
still in place.
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Mon Apr 14 21:44:12 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Mon, 14 Apr 1997 13:44:12 -0700 (PDT)
Subject: R-alpha: problems qith require/provide
In-Reply-To: <199704142009.IAA02547@stat1.stat.auckland.ac.nz>
Message-ID: <Pine.SUN.3.91.970414132518.3839A-100000@chekov>

On Tue, 15 Apr 1997, Ross Ihaka wrote:

> Thomas has sent me a new version which may fix this problem.  I will
> take a look.
It doesn't completely.  A better solution is to do as Kurt suggested and 
put 
.Provided<-character(0)
in Rprofile.  The code at the end of this message then works.

Re: :=
The loss of := is not a problem now we know about it (I used sed to 
convert, Kurt used emacs), it was just a bit of a surprise at the time.
It's a good idea to get it killed off *before* we go to a beta version.


libraries:
R source files in the funs/ directory of a library are not used if their 
names begin with a capital letter [eg Rsurvival4, Rgee, Rdate  ;-)]

- thomas
--------------------------------------------------------------
require<- function (name, quietly = FALSE) 
{
  if (missing(name)) 
    return(TRUE)  
  name <- substitute(name)
  if (!is.character(name)) 
	  name <- deparse(name)
  if (is.na(match(name, .Libraries))&& is.na(match(name, .Provided))) {
    file <- system.file("library", name)
    if (file == "") {
      if (!quietly) 
	warning(paste("Required library ", name, " not found.\n"))
      return(FALSE)
    }
    if (!quietly) 
      cat("Autoloading required library:", name, "\n")
    sys.source(file)
    assign(".Libraries", c(name, .Libraries), NULL)
  }
  return(TRUE)
}


provide<-function(name)
{
  if (missing(name)) {
    return(list(provide=.Provided, library=.Libraries))
  }
  name<-substitute(name)
  if (!is.character(name))
    name<-deparse(name)
  if (is.na(match(name, .Libraries)) && is.na(match(name, .Provided))){
    assign(".Provided",c(name,.Provided),environment(NULL))
    return(TRUE)
  } 
  else 
    return(FALSE)
}
  

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Mon Apr 14 23:59:23 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 15 Apr 1997 00:59:23 +0200
Subject: R-alpha: select.frame
Message-ID: <x2ragd9po4.fsf@bush.kubism.ku.dk>

Here's the select.frame() function I babbled about before. Suggestions
about coding style, etc., are welcome, I feel a bit green at this.

select.frame<-
function (dfr, ...) 
{
        subst.exp <- function(e) {
                for (i in 2:length(e)) {
                        ei <- e[[i]]
                        if (is.call(ei)) 
                                e[[i]] <- subst.exp(ei)
                        else {
                                n <- match(as.character(ei), nm)
                                if (!is.na(n)) 
                                 e[[i]] <- n
                        }
                }
                e
        }
        nm <- names(dfr)
        e <- as.call(c(as.name("c"), expression(...)))
        dfr[, eval(subst.exp(e))]
}


-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Tue Apr 15 01:54:23 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Mon, 14 Apr 1997 17:54:23 -0700 (PDT)
Subject: R-alpha: D()
In-Reply-To: <9704090917.AA01943@>
Message-ID: <Pine.SUN.3.95.970414175127.18041A-100000@sulu>


D() doesn't handle exp() correctly:

R> D(expression(exp(sin(x))),"x")
sin(x) * cos(x)
R> D(expression(exp(x)),"x")
x


Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Tue Apr 15 15:23:06 1997
From: ihaka@stat.auckland.ac.nz (Ross &)
Date: Wed, 16 Apr 1997 02:23:06 +1200
Subject: R-alpha: D()
In-Reply-To: <Pine.SUN.3.95.970414175127.18041A-100000@sulu>
References: <9704090917.AA01943@>
 <Pine.SUN.3.95.970414175127.18041A-100000@sulu>
Message-ID: <199704151423.CAA06246@stat9.stat.auckland.ac.nz>

Thomas Lumley writes:
 > 
 > D() doesn't handle exp() correctly:
 > 

Duh!  Back to first year calculus for me.  It's
NOT

	d/dx e^f(x) = f(x) * f'(x).

BUT

	d/dx e^f(x) = e^f(x) * f'(x).

Deep down in the C function "D" in deriv.c you will find the lines

                else if(CAR(expr) == ExpSymbol) {
                        ans = simplify(TimesSymbol,
                                CADR(expr),
                                PP(D(CADR(expr), var)));
                        UNPROTECT(1);
                }

These should in fact read

                else if(CAR(expr) == ExpSymbol) {
                        ans = simplify(TimesSymbol,
                                expr,
                                PP(D(CADR(expr), var)));
                        UNPROTECT(1);
                }

I.e. remove the CADR from around the "expr" in the call to simplify.

This has clearly not been tested by anyone with a firm grasp of the
Newton/Leibnitz version of the calculus.  Use with care ...
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Tue Apr 15 13:07:20 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 15 Apr 1997 14:07:20 +0200
Subject: R-alpha: problem with survival4 and ":="
In-Reply-To: <199704142015.IAA02571@stat1.stat.auckland.ac.nz>
References: <199704142015.IAA02571@stat1.stat.auckland.ac.nz>
Message-ID: <199704151207.OAA07065@aragorn.ci.tuwien.ac.at>

>>>>> Ross Ihaka writes:

> I did indeed take := out.  If code is loaded with "library" these can
> be converted to <-.

> := was one of those temporary hacks we put in place 5 years ago and
> never got around to fixing.  We already have <- and <<- as assignment
> operators.  This is one assignment too many (some would say two too
> many).

> If it is really critical I can put it back.  I only removed the
> reference from the table of internal functions, the actual code is
> still in place.

I don't think we need it anymore.  As Thomas said, taking it out before
moving to beta was perfect ...

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Apr 15 20:31:33 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 15 Apr 97 21:31:33 +0200
Subject: R-alpha: Bug & Patch  in  dbeta.c  (0.50 - PreR 7)
Message-ID: <9704151931.AA01510@>

dbeta(1, a,b)  would return 1 instead of 0.

Here is the patch for  ..../src/math/dbeta.c :

--- dbeta.c~	Sun Nov 24 23:43:10 1996
+++ dbeta.c	Tue Apr 15 21:25:30 1997
@@ -23,9 +23,7 @@
 {
 	if (a <= 0.0 || b <= 0.0)
 		DOMAIN_ERROR;
-	if (x <= 0)
+	if (x <= 0 || x >= 1.0)
 		return 0.0;
-	if (x >= 1.0)
-		return 1.0;
 	return MATH_CHECK(pow(x, a - 1) * pow(1.0 - x, b - 1.0) / beta(a, b));
 }
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Tue Apr 15 20:57:33 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Tue, 15 Apr 1997 12:57:33 -0700 (PDT)
Subject: R-alpha: D()
In-Reply-To: <199704151423.CAA06246@stat9.stat.auckland.ac.nz>
Message-ID: <Pine.SUN.3.95.970415125504.21998A-100000@uhura>


R> D(expression(z * (log(z) /z)),"z")
Error: invalid form in unary minus check



 - thomas

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Tue Apr 15 21:02:55 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Tue, 15 Apr 1997 13:02:55 -0700 (PDT)
Subject: R-alpha: Bug & Patch  in  dbeta.c  (0.50 - PreR 7)
In-Reply-To: <9704151931.AA01510@>
Message-ID: <Pine.SUN.3.95.970415125913.21998B-100000@uhura>

On Tue, 15 Apr 1997, Martin Maechler wrote:

> dbeta(1, a,b)  would return 1 instead of 0.

Shouldn't it be 1 for b=1, Inf for b<1 and 0 for b>1 at x=1 (and similar
behaviour at x=0)?

ie 
double dbeta(double x, double a, double b)
{
        if (a <= 0.0 || b <= 0.0)
                DOMAIN_ERROR;
        if (x < 0)
                return 0.0;
        if (x > 1.0)
                return 0.0;
        return MATH_CHECK(pow(x, a - 1) * pow(1.0 - x, b - 1.0) / beta(a,
b));
}




Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Tue Apr 15 21:12:27 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Tue, 15 Apr 1997 13:12:27 -0700 (PDT)
Subject: R-alpha: Be nice to the English
In-Reply-To: <Pine.SUN.3.95.970415125913.21998B-100000@uhura>
Message-ID: <Pine.SUN.3.95.970415130444.21998C-100000@uhura>

Two suggestions for additions to Rprofile:

colours<-colors
optimise<-optimize

to provide aliases for the alternative spellings of these words.  As an
argument to a function we usually seem to use col= rather than colors=
which gets around that compatibility issue.  I don't know how much it
matters in R but I write \begin{itemise} instead of \begin{itemize} in
LaTeX with annoying regularity.

The aliases would also have to be added to the help pages for the relevant
functions.


Thomas Lumley


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Tue Apr 15 21:16:23 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Wed, 16 Apr 1997 08:16:23 +1200 (NZST)
Subject: R-alpha: D()
Message-ID: <199704152016.IAA24269@stat1.stat.auckland.ac.nz>

	R> D(expression(z * (log(z) /z)),"z")
	Error: invalid form in unary minus check

Yep. this is the result of an implete "if" statement in the C function
"isUminus" in deriv.c.  The function should read

static int isUminus(SEXP s)
{
	if(TYPEOF(s) == LANGSXP && CAR(s) == MinusSymbol) {
		switch(length(s)) { 
		case 2:
			return 1;
		case 3:
			if(CADDR(s) == R_MissingArg)
				return 1;
			else return 0;
		default:
			error("invalid form in unary minus check\n");
		}
	}
	else return 0;
}

This now gives

	> D(expression(z * (log(z) /z)),"z")
	(log(z)/z) + z * (1/z/z - log(z)/z^2)

which I thought was pretty ugly, but

	S-PLUS : Copyright (c) 1988, 1996 MathSoft, Inc.
	S : Copyright AT&T.
	Version 3.4 Release 1 for Sun SPARC, SunOS 4.1.3_U1 : 1996
	Working data will be in .Data
	> D(expression(z * (log(z) /z)),"z")
	(log(z)/z) + z * (1/z/z - log(z)/z^2)

So we are no worse than S.

And shame on you for trying to fool such a dumb bit of software :-).
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Apr 15 22:36:12 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 15 Apr 97 23:36:12 +0200
Subject: R-alpha: Buglet & patch  in  dbinom.c  (0.50 - PreR 7)
Message-ID: <9704152136.AA01576@>

dbinom(k, n, prob = 0) # or  prob=1   would not work;

The following patch makes it work (in  $RHOME/src/math/ ) :

--- dbinom.c~	Sun Nov 24 23:43:10 1996
+++ dbinom.c	Tue Apr 15 23:31:46 1997
@@ -23,9 +23,13 @@
 {
 	x = floor(x + 0.5);
 	n = floor(n + 0.5);
-	if (n <= 0.0 || p <= 0.0 || p >= 1.0)
+	if (n <= 0.0 || p < 0.0 || p > 1.0)
 		DOMAIN_ERROR;
 	if (x < 0.0 || x > n)
 		return 0.0;
+	if (p == 0.0)
+	        return (x == 0) ? 1.0 : 0.0;
+	if (p == 1.0)
+	        return (x == n) ? 1.0 : 0.0;
 	return exp(lfastchoose(n, x) + log(p) * x + (n - x) * log(1.0 - p));
 }
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Apr 15 22:52:01 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 15 Apr 97 23:52:01 +0200
Subject: R-alpha: Bug & Patch  in  dbeta.c  (0.50 - PreR 7)
In-Reply-To: <Pine.SUN.3.95.970415125913.21998B-100000@uhura> (message from
 Thomas Lumley on Tue, 15 Apr 1997 13:02:55 -0700 (PDT))
Message-ID: <9704152152.AA01582@>

Of course ! (--- silly me)

S-plus actually always returns 0 here;  but your solution is mathematically
correct where S is NOT!

The "bad" thing about R is only that we still don't have IEEE arithmetic.
Will get 'NA' instead of 'Inf'  ...


Thomas Lumley :
>> On Tue, 15 Apr 1997, Martin Maechler wrote:
>> 
>> > dbeta(1, a,b)  would return 1 instead of 0.
>> 
>> Shouldn't it be 1 for b=1, Inf for b<1 and 0 for b>1 at x=1 (and similar
>> behaviour at x=0)?
>> 
>> ie 
>> double dbeta(double x, double a, double b)
>> {
>>         if (a <= 0.0 || b <= 0.0)
>>                 DOMAIN_ERROR;
>>         if (x < 0)
>>                 return 0.0;
>>         if (x > 1.0)
>>                 return 0.0;
>>         return MATH_CHECK(pow(x, a - 1) * pow(1.0 - x, b - 1.0) / beta(a,
>> b));
>> }
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Apr 15 23:10:26 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 16 Apr 97 00:10:26 +0200
Subject: R-alpha: R0.50 Pre7 :  Bug in .Internal(print.default(.)...)
Message-ID: <9704152210.AA01600@>

> options()$digi
[1] 7
> (0:2)/1000 + 1e-10
[1]1e-3131e-3131e-313

-->  Hugh ?!?!  (it is NOT in computation just in printing !) :

> options(digits=8)
> 0:2/1000 + 1e-10
[1] 1.0000000e-10 1.0000001e-03 2.0000001e-03
> options(digits=5)
> 0:2/1000 + 1e-10
[1]1e-3131e-3131e-313
> 
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Tue Apr 15 23:54:00 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Wed, 16 Apr 1997 10:54:00 +1200 (NZST)
Subject: R-alpha: Re: select.frame
Message-ID: <199704152254.KAA25648@stat1.stat.auckland.ac.nz>

Peter Dalgaard writes:

> Here's the select.frame() function I babbled about before. Suggestions
> about coding style, etc., are welcome, I feel a bit green at this.

	[ function code omitted. ]

This is a very nice function!  One of the things I like about SAS is
the ability to specify ranges of variables.  I do have a couple of
suggestions.

1. The expression 

	e <- as.call(c(as.name("c"), expression(...)))

   can be written more concisely as

	e <- substitute(c(...))

2. As written, the function uses R scoping rules to pass the value of
   the variable "nm" into the body of "subst.exp", and so the function
   will not work in S.  It might be better to pass "nm" as an argument
   so that the function is portable.

3. It might be good to check that only ":" expressions allowed.


Here is a modified version version of the function which does the above.

select.frame<-
function (dfr, ...)
{
        subst.exp <- function(e, nm) {
                for (i in 2:length(e)) {
                        ei <- e[[i]]
                        if (is.name(ei)) {
                                n <- match(as.character(ei), nm)
                                if (!is.na(n))
                                        e[[i]] <- n
                        }
                        else if (is.call(ei) && as.character(ei[[1]]) == ":")
                                e[[i]] <- subst.exp(ei, nm)
                        else if (is.numeric(ei)) {
                                e[[i]] <- e[[i]]
                        }
                        else stop("invalid selection")
                }
                e
        }
        dfr[, eval(subst.exp(substitute(c(...)), names(dfr)))]
}

Here it is in action:

	> select.frame(iris,Sepal.Length:Petal.Length,Species)[1:5,]
	  Sepal.Length Sepal.Width Petal.Length Species
	1          5.1         3.5          1.4  setosa
	2          4.9         3.0          1.4  setosa
	3          4.7         3.2          1.3  setosa
	4          4.6         3.1          1.5  setosa
	5          5.0         3.6          1.4  setosa
	> 

Note that in S you can write

	as.character(ei[[1]]) == ":"

in the simpler form

	ei[[1]] == ":"

and I have made a change to (my version of) R to make this work.

Finally, it would be possible to use the forbidden black arts (i.e.
"Recall") to make the function body a single expression.  However
I would recommend that "Recall" never be used.  The function above is
more clearly written than a version using "Recall".

I also think that this idea is useful enough to generalized.  One
approach would be to make a generic function "select" and make the
function above the method for data frames - i.e. call it
select.data.frame.

Another idea would be to have "select" operate on name vectors in
general, rather than on just variable names in data frames.  Then the
same trick could be used to select rows as well as columns.
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Wed Apr 16 00:51:18 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 16 Apr 1997 01:51:18 +0200
Subject: R-alpha: Re: select.frame
In-Reply-To: Ross Ihaka's message of Wed, 16 Apr 1997 10:54:00 +1200 (NZST)
References: <199704152254.KAA25648@stat1.stat.auckland.ac.nz>
Message-ID: <x2u3l76e15.fsf@bush.kubism.ku.dk>

Ross Ihaka <ihaka@stat.auckland.ac.nz> writes:

> 2. As written, the function uses R scoping rules to pass the value of
>    the variable "nm" into the body of "subst.exp", and so the function
>    will not work in S.  It might be better to pass "nm" as an argument
>    so that the function is portable.

..and same thing applies to subst.exp itself, isn't that so? As
written, subst.exp would not be able to find subst.exp. Let's see:

[Splus]
> g<-function(n){f<-function(n)ifelse(n,1,n*f(n));f(n)}
> g(3)
Error in f(n): couldn't find function "f"
Dumped

Right. One of the major annoyances in S, actually. This has bugged be
always. You need to put the function in the "evaluation frame" or
define it globally. Maybe one should just leave it and let S solve the
porting problems? ;^)

> 3. It might be good to check that only ":" expressions allowed.

Hum. I was beginning to like the idea that you could put complicated
expressions in there, as in

select.frame(dfr, seq(visit1.1st, length=10, by=3))

when you have visit1.1st, visit1.2nd, visit1.3rd, .... visit10.3rd and
you want to look at the *.1st measurements. The semantics are that
variable names get replaced by their column numbers, if they exist in
the frame, and all that is required is that the resulting integer
expression makes sense. 

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Wed Apr 16 15:57:07 1997
From: ihaka@stat.auckland.ac.nz (Ross &)
Date: Thu, 17 Apr 1997 02:57:07 +1200
Subject: R-alpha: Re: select.frame
In-Reply-To: <x2u3l76e15.fsf@bush.kubism.ku.dk>
References: <199704152254.KAA25648@stat1.stat.auckland.ac.nz>
 <x2u3l76e15.fsf@bush.kubism.ku.dk>
Message-ID: <199704161457.CAA08074@stat9.stat.auckland.ac.nz>

Peter Dalgaard writes:
 > ..and same thing applies to subst.exp itself, isn't that so? As
 > written, subst.exp would not be able to find subst.exp. Let's see:

You are right of course.  Its been a while since I tried anything
substantial in S.

 >  Maybe one should just leave it and let S solve the
 > porting problems? ;^)

Sounds good to me, but I think its an interesting enough idea to get
a bit wider exposure.  You could always mention how much cleaner it is
in R :-).

 > > 3. It might be good to check that only ":" expressions allowed.
 > 
 > Hum. I was beginning to like the idea that you could put complicated
 > expressions in there, as in

By all means.  Whatever makes sense.
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Wed Apr 16 11:49:34 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 16 Apr 1997 12:49:34 +0200
Subject: R-alpha: CRAN announcement
Message-ID: <199704161049.MAA10469@aragorn.ci.tuwien.ac.at>

Attached is an updated version of the CRAN announcement, also to be sent
out as soon as 0.50 is out.  Again, please have a look if possible.

-k

************************************************************************
This is the first announcement of the

		   Comprehensive R Archive Network 
			        (CRAN)

CRAN is a collection of sites which carry identical material, consisting
of the R&R R distribution(s), the contributed extensions, documentation
for R, and binaries.

The CRAN master site can be found at the URL

	ftp://ftp.ci.tuwien.ac.at/pub/R		(Austria)

and is currently being mirrored daily at

	ftp://franz.stat.wisc.edu/pub/R		(U.S.A.)
	ftp://ftp.stat.math.ethz.ch/R-CRAN	(Switzerland)

This list should grow within soon.  If you want to become an official
CRAN mirror, please send me a note (Kurt.Hornik@ci.tuwien.ac.at).

Please use the CRAN site closest to you to reduce network load.

The structure of the CRAN tree is as follows.

	src/base		# Source distribution
	src/contrib		# Source for extensions
	doc/			# Documentation
	bin/<platform>		# Binaries

`src/base' contains the official R source distribution as provided by
Ross Ihaka and Robert Gentleman.

`src/contrib' contains code for extension packages.  Currently, there
are acepack, bootstrap, ctest, date, e1071, fracdiff, gee, jpn, oz,
snns, splines, and survival4.  Look at the INDEX file in this directory
for more specific information.  More packages are expected for the near
future.

`bin' is for prebuilt R binaries (the base distribution and extensions),
grouped according to platforms.  Currently, there are only experimental
packages for Debian GNU/Linux.  I hope that `.tar.gz' files with
contents relative to an installation tree (e.g. `bin/', `lib/R/', and
`man/man1/R.1') can be made available soon for all major supported Unix
platforms.

`doc' is for additional documentation and information on R.

In the short run, the process of `submitting' to CRAN is very simple:
upload to 

	ftp://ftp.ci.tuwien.ac.at/incoming

and drop me a note (Kurt.Hornik@ci.tuwien.ac.at).  Please indicate the
copyright situation (GPL, ...) in your submission.

In the long run, there will be a form to fill in, and some requirement
of authentication (PGPish, ...), and submission could maybe be done via
WWW.  I am open to suggestions here.

*****************************************************************************
*          Kurt Hornik         *                                            *
*  Dept of Statistics TU Wien  * tel:    +43 (1) 58801-4542                 *
*  Wiedner Hauptstr 8-10/1071  * fax:    +43 (1) 504-1498                   *
*          A-1040 Wien         * email:  Kurt.Hornik@ci.tuwien.ac.at        *
*            Austria           * WWW:    http://www.ci.tuwien.ac.at/~hornik *
*****************************************************************************
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Wed Apr 16 11:49:34 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 16 Apr 1997 12:49:34 +0200
Subject: R-alpha: R-FAQ
Message-ID: <199704161049.MAA10470@aragorn.ci.tuwien.ac.at>

Attached is an updated version of the FAQ, to be released right after
0.50 is out.  Please have a look, and let me know where improvements are
needed.

Thanks,
-k

*******************************************
  R FAQ
  Kurt Hornik
  v0.1-0, 1997/04/16

  This document contains answers to some of the most frequently asked
  questions about R.  Feedback is welcome.
  ______________________________________________________________________

  Table of Contents:

  1.	Introduction

  1.1.	Legalese

  1.2.	Obtaining this Document

  1.3.	Notation

  1.4.	Feedback

  2.	R Basics

  2.1.	What Is R?

  2.2.	What Machines Does R Run on?

  2.3.	What Is the Current Version of R?

  2.4.	How Can R Be Obtained?

  2.5.	How Can R Be Installed?

  2.5.1.  How Can R Be Installed (Unix)

  2.5.2.  How Can R Be Installed (Windows)

  2.5.3.  How Can R Be Installed (Macintosh)

  2.6.	Are there Unix Binaries for R?

  2.7.	Which Documentation Exists for R?

  2.8.	Which Mailing Lists Exist for R?

  2.9.	What is CRAN?

  3.	R and S

  3.1.	What Is S?

  3.2.	What Is S-PLUS?

  3.3.	What Are the Differences between R and S?

  4.	R Add-On Packages

  4.1.	Which Add-on Packages Exist for R?

  4.2.	How Can Add-on Packages Be Installed?

  4.3.	How Can Add-on Packages Be Used?

  4.4.	How Can I Contribute to R?

  5.	R and Emacs

  5.1.	Is there Emacs Support for R?

  5.2.	Should I Run R from Within Emacs?

  6.	R Miscellania

  6.1.	How Can I Read a Large Data Set into R?

  6.2.	Why Can't R Source a `Correct' File?

  6.3.	How Can I Set Components of a List to NULL?

  6.4.	How Can I Save My Workspace?

  6.5.	How Can I Clean Up My Workspace?

  7.	Acknowledgments
  ______________________________________________________________________

  1.  Introduction

  This document contains answers to some of the most frequently asked
  questions about R.

  1.1.	Legalese

  This document is free software; you can redistribute it and/or modify
  it under the terms of the GNU General Public License as published by
  the Free Software Foundation; either version 2, or (at your option)
  any later version.

  This program is distributed in the hope that it will be useful, but
  WITHOUT ANY WARRANTY; without even the implied warranty of
  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.	See the GNU
  General Public License for more details.

  If you do not have a copy of the GNU General Public License, write to
  the Free Software Foundation, 59 Temple Place - Suite 330, Boston, MA
  02111-1307, USA.

  1.2.	Obtaining this Document

  The latest version of this document is always available from
  http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html.

  From there, you can also obtain versions converted to plain ASCII
  text, DVI, and PostScript, as well as the SGML source used for
  creating all these formats using the SGML-Tools (formerly Linuxdoc-
  SGML) system.

  1.3.	Notation

  Everything should be pretty standard.	`R>' is used for the R prompt,
  and a `$' for the shell prompt (where applicable).

  1.4.	Feedback

  Feedback is of course most welcome.

  In particular, note that I do not have access to Windows or Mac
  systems.  If you have information on these systems that you think
  should be added to this document, please let me know.

  2.  R Basics

  2.1.	What Is R?

  R is a system for statistical computation and graphics.  It consists
  of a language plus a run-time environment with graphics, a debugger,
  access to certain system functions, and the ability to run programs
  stored in script files.

  The design of R has been heavily influenced by two existing languages:
  Becker, Chambers & Wilks' S (see question ``What is S?'') and
  Sussman's Scheme.  Whereas the resulting language is very similar in
  appearance to S, the underlying implementation and semantics are
  derived from Scheme.	See question ``What Are the Differences between
  R and S?'' for a discussion of the differences between R and S.

  R is being developed by Ross Ihaka and Robert Gentleman, two Senior
  Lecturers at the Department of Statistics of the University of
  Auckland in Auckland, New Zealand.

  R is free software distributed under a GNU-style copyleft.

  2.2.	What Machines Does R Run on?

  R is being developed for the Unix, Windows and Mac platforms.

  R will configure and build under a number of common Unix platforms
  including dec-alpha-osf, freebsd, hpux, linux-elf, sgi-irix, solaris,
  and sunos.  If you know about other platforms, please drop me a note.

  2.3.	What Is the Current Version of R?

  The current Unix version is 0.50, the previous one was 0.16.1.  The
  jump in the version number is deliberate, because 0.50 added group
  methods and complex numbers and hence more or less provides a full
  implementation of S as described in ``The New S Language''.

  The versions for Windows and Mac are pre-alpha.  With some good luck,
  the Windows version will soon catch up with the Unix version.

  2.4.	How Can R Be Obtained?

  Sources, binaries and documentation for R can be obtained via CRAN,
  the ``Comprehensive R Archive Network'' (see question ``What is
  CRAN?'').

  2.5.	How Can R Be Installed?

  2.5.1.  How Can R Be Installed (Unix)

  If binaries are available for your platform (see question ``Are there
  Unix Binaries for R?''), you can use these, following the instructions
  that come with them.

  Otherwise, you can compile and install R yourself, which can be done
  very easily under a number of common Unix platforms (see question
  ``What Machines Does R Run on?'').  The file INSTALL that comes with
  the R distribution contains instructions.

  Choose a place to install the R tree (R is not just a binary, but has
  additional data sets, help files, font metrics etc).	Let's call this
  place RHOME (given appropriate permissions, a natural choice would be
  `/usr/local/lib/R').	Untar the source code, and issue the following
  commands (at the shell prompt):

       $ ./configure
       $ make
       $ make install-help

  You can also build a LaTeX version of the manual entries with

       $ make install-latex

  and an HTML version of the manual with

       $ make install-html

  If these commands execute successfully, the R binary will be copied to
  the `$RHOME/bin' directory.  In addition, a shell script font-end
  called `R' will be created and copied to the same directory.	You can
  copy this script to a place where users can invoke it, for example to
  `/usr/local/bin'.  You could also copy the man page `R.1' to a place
  where your man reader finds it, such as `/usr/local/man/man1'.

  2.5.2.  How Can R Be Installed (Windows)

  Get the file `Rexe.zip' from the `bin/ms-windows' directory of a CRAN
  site.	This archive contains a binary Windows 3.xx distribution for R
  and installation instructions.

  Robert Gentleman has recently made an updated pre-alpha Windows
  executable file available for ftp at
  ftp://stat.auckland.ac.nz/pub/research/rgentlem/rbeta.zip.  This
  binary should be more compatible with Windows 95 than the other (he
  does not know about 3.1).  You still need all the other extra files
  from the previous Windows distribution, it is only an executable.

  2.5.3.  How Can R Be Installed (Macintosh)

  CRAN sites have a directory `bin/macintosh' which contains
  `R.sea.hqx', a binhexed self-extracting archive, and installation
  instructions in `README.MACINTOSH'.

  2.6.	Are there Unix Binaries for R?

  Experimental `.deb' packages for installation under Debian GNU/Linux
  can be found in `bin/ix86-linux'.  No other binaries distributions for
  Unix systems have thus far been made publically available.

  2.7.	Which Documentation Exists for R?

  Currently, there is no R manual.  Online documentation for most of the
  functions and variables in R exists, and can be printed on-screen by
  typing help(name) (or ?name) at the R prompt, where name is the name
  of the R object help is sought for.  (In the case of unary and binary
  operators and control-flow special forms, the name may need to be be
  quoted.)

  This documentation can also be made available as HTML, and as hardcopy
  via LaTeX, see question ``How Can R Be Installed?''.	An up-to-date
  HTML version is always available for web browsing at

       http://www.stat.math.ethz.ch/R-manual

  In the absence of a systematic introduction to R, one can mostly get
  along with introductions to S or S-PLUS, such as ``Notes on S-PLUS:  A
  Programming Environment for Data Analysis and Graphics'' by Bill
  Venables <venables@stats.adelaide.edu.au> and David Smith
  <D.M.Smith@lancaster.ac.uk>.	This document talks mostly about plain S
  features, and does not concentrate on features specific to S-PLUS, and
  is available from the Statlib S repository at
  http://lib.stat.cmu.edu/S/SplusNotes/ (LaTeX source and PostScript).
  An introduction to R based on it will soon be available.

  Last, but not least, Ross' and Robert's experience in designing and
  implementing R is described in:

       @Article{,
	 author =	{Ross Ihaka and Robert Gentleman},
	 title =	{R: {A} Language for Data Analysis and Graphics},
	 journal =	{Journal of Computational and Graphical Statistics},
	 year =		1996,
	 volume =	5,
	 number =	3,
	 pages =	{299--314}
       }

  This is also the reference for R to use in publications.

  2.8.	Which Mailing Lists Exist for R?

  Thanks to Martin Maechler <maechler@stat.math.ethz.ch>, there are
  three mailing lists devoted to R.

     r-announce
	This list is for announcements about the development of R and
	the availability of new code.

     r-devel
	This list is for discussions about the future of R and pre-
	testing of new versions.  It is meant for those who maintain an
	active position in the development of R.

     r-help
	The `main' R mailing list, for announcements about the
	development of R and the availability of new code, questions and
	answers about problems and solutions using R, enhancements and
	patches to the source code and documentation of R, comparison
	and compatibility with S and S-plus, and for the posting of nice
	examples and, benchmarks.

  To send a message to everyone on the r-help mailing list, send email
  to

       r-help@stat.math.ethz.ch

  To subscribe (or unsubscribe) to this list send subscribe (or unsub-
  scribe) in the BODY of the message (not in the subject!)  to r-help-
  request@stat.math.ethz.ch.  Information about the list can be obtained
  by sending an email with info as its contens to r-help-
  request@stat.math.ethz.ch.

  Subscription and posting to the other lists is done analogously, with
  `r-help' replaced by `r-announce' and `r-devel', respectively.  Note
  that the r-announce list is gatewayed into r-help, so you don't need
  to subscribe to both of them.

  It is recommended that you send mail to r-help rather than only to the
  R developers (who are also subscribed to the list, of course).  This
  may save them precious time they can use for constantly improving R,
  and will typically also result in much quicker feedback for yourself.

  Of course, in the case of bug reports it would be very helpful to have
  code which reliably reproduces the problem.

  The developers of R can be reached for comments and reports at
  R@stat.auckland.ac.nz.

  2.9.	What is CRAN?

  The ``Comprehensive R Archive Network'' (CRAN) is a collection of
  sites which carry identical material, consisting of the R
  distribution(s), the contributed extensions, documentation for R, and
  binaries.

  The CRAN master site can be found at the URL

       ftp://ftp.ci.tuwien.ac.at/pub/R/

  and is currently being mirrored daily at
       ftp://franz.stat.wisc.edu/pub/R/
       ftp://ftp.stat.math.ethz.ch/R-CRAN/

  Please use the CRAN site closest to you to reduce network load.

  The structure of the CRAN tree is as follows.

     `src/base'
	contains the official R distribution as provided by Ross Ihaka
	and Robert Gentleman.

     `src/contrib'
	contains code for extension packages.

     `doc'
	is for additional documentation and information on R.

     `bin'
	is for prebuilt R binaries (the base distribution and
	extensions), grouped according to platforms.  Currently, there
	are only experimental packages for Debian GNU/Linux.  I hope
	that `.tar.gz' files with contents relative to an installation
	tree (e.g. `bin', `lib/R/', and `man/man1/R.1') can be made
	available soon for all major supported Unix platforms.

  The process of ``submitting'' to CRAN currently is very simple: upload
  to ftp://ftp.ci.tuwien.ac.at/incoming and send email to Kurt Hornik
  <Kurt.Hornik@ci.tuwien.ac.at>.  Please indicate the copyright
  situation (GPL, ...) in your submission.

  3.  R and S

  3.1.	What Is S?

  S is a very high level language and an environment for data analysis
  and graphics.	S was written by Richard A. Becker, John M. Chambers,
  and Allan R. Wilks of AT&T Bell Laboratories Statistics Research
  Department.

  The primary references for S are two books by the creators of S.

  o  Richard A. Becker, John M. Chambers and Allan R. Wilks (1988),
     ``The New S Language,'' Chapman & Hall, London.

     This book is often called the ``Blue Book''.

  o  John M. Chambers and Trevor J. Hastie (1992), ``Statistical Models
     in S,'' Chapman & Hall, London.

     This is also called the ``White Book''.

  There is a huge amount of user-contributed code for S, available at
  the S Repository at CMU.

  See the ``Frequently Asked Questions about S''
  (http://lib.stat.cmu.edu/S/faq) for further information about S.

  3.2.	What Is S-PLUS?

  S-PLUS is a value-added version of S sold by Statistical Sciences,
  Inc. (now a division of Mathsoft, Inc.)  S is a subset of S-PLUS, and
  hence anything which may be done in S may be done in S-PLUS.	In
  addition S-PLUS has extended functionality in a wide variety areas,
  including robust regression, modern nonparametric regression, time
  series, survival analysis, multivariate analysis, classical
  statistical tests, quality control, and graphics drivers.  Add-on
  modules add additional capabilities for wavelet analysis, spatial
  statistics, and design of experiments.

  See the MathSoft S-PLUS page (http://www.mathsoft.com/splus.html) for
  further information.

  3.3.	What Are the Differences between R and S?

  Whereas the developers of R have tried to stick to the S language as
  defined in ``The New S Language'' (Blue Book, see question ``What is
  S?''), they have adopted the evaluation model of Scheme.

  This difference becomes manifest when free variables occur in a
  function.  Free variables are those which are neither formal
  parameters (occurring in the argument list of the function) nor local
  variables (created by assigning to them in the body of the function).
  Whereas S (like C) by default uses static scoping, R (like Scheme) has
  adopted lexical scoping.  This means the values of free variables are
  determined by a set of global variables in S, but in R by the bindings
  that were in effect at the time the function was created.

  Consider the following function:

       cube <- function(n) {
	 sq <- function() n * n
	 n * sq()
       }

  Under S, sq() does not ``know'' about the variable n unless it is
  defined globally:

       S> cube(2)
       Error in sq():  Object "n" not found
       Dumped
       S> n <- 3
       S> cube(2)
       [1] 18

  In R, the ``environment'' created when cube() was invoked is also
  looked in:

       R> cube(2)
       [1] 8

  Both R and S employ the principle of lazy evaluation, meaning that
  expressions are evaluated only when their values are needed in
  computations.	As one consequence of the above, S sometimes evaluates
  assignments in function argument lists (named arguments) immediately.
  I.e., S uses eager evaluation in these cases.	R always uses lazy
  evaluation.  (Folks, correct me if I am wrong here, but I think this
  was what caused Martin's function plot.step() to behave differently
  under R and S.)

  Lexical scoping allows using function closures and maintaining local
  state.  A simple example (taken from Abelson and Sussman) can be found
  in the `demos/language' subdirectory of the R distribution.  Further
  information is provided in the standard R reference ``R: A Language
  for Data Analysis and Graphics'' (see question ``Which Documentation
  Exists for R?'') and a paper on ``Lexical Scope and Statistical
  Computing'' by Robert Gentleman and Ross Ihaka which can be obtained
  from the `doc/misc' directory of a CRAN site.

  Lexical scoping also implies a further major difference.  Whereas S
  stores all objects as separate files in a directory somewhere (usually
  `.Data' under the current directory), R does not.  All objects in R
  are stored internally.  When R is started up it grabs a very large
  piece of memory and uses it to store the objects.  R performs its own
  memory management of this piece of memory.  Having everything in
  memory is necessary because it is not really possible to externally
  maintain all relevant ``environments'' of symbol/value pairs.	This
  difference also seems to make R much faster than S.

  The down side is that if R crashes you will lose all the work for the
  current session.  Saving and restoring the memory ``images'' (the
  functions and data stored in R's internal memory at any time) can be a
  bit slow, especially if they are big.	In S this does not happen,
  because everything is saved in disk files and if you crash nothing is
  likely to happen to them.  R is still in an alpha stage, and does
  crash from time to time.  Hence, for important work you should
  consider saving often, see question ``How Can I Save My Workspace?''
  (other possibilities are logging your sessions, or have your R
  commands stored in text files which can be read in using source()).

  Apart from lexical scoping and its implications, R follows the S
  language definition in the Blue Book as much as possible, and hence
  really is an ``implementation'' of S.	There are some intentional
  differences where the behavior of S is considered ``not clean''.  In
  general, the rationale is that R should help you detect programming
  errors, while at the same time being as compatible as possible with S.

  Some known differences are the following.

  o  In R, if x is a list, then x[sub] <- NULL and x[[sub]] <- NULL
     remove the specified elements from x.  The first of these is
     incompatible with S, where it is a no-op.

  o  In S, the functions named .First and .Last in the `.Data' directory
     can be used for customizing, as they are executed at the very
     beginning and end of a session, respectively.  R looks for files
     called `.Rprofile' in the user's home directory and the current
     directory, and sources these.  (It also loads a saved image from
     `.RData' in case there is one.)  If a .First function exists then,
     it is executed.  The .Last mechanism is not supported yet.

  o  Attaching library sections works differently.  In S, library(name)
     adds the data directory for the library section name to the search
     list.  If a function object named `.First.lib' exists in the
     directory, it is executed; this is typically used to dynamically
     load compiled code required by the functions in the section.  In R,
     library(name) currently simply sources the file
     $RHOME/library/name, and compiled code can be loaded by calling
     library.dynam() in this file.  The .First.lib mechanism is not
     really supported.	(Note that a library file is only loaded once,
     so that any code in the library that is not in a function is
     executed the first time the library is loaded.)

  o  R does not try as hard as S to preserve dimnames attributes
     (examples are apply, rbind, and cbind, but also arithmetic ops).

  o  R presently does not support IEEE Inf and NaN.

  o  In R, attach currently only works for lists and data frames (not
     for directories).

  o  Categories do not exist in R, and never will as they are deprecated
     now in S.	Use factors instead.

  o  In R, For() loops are not necessary and hence not supported.

  o  In R, assign() uses the argument envir= rather than where= as in S.

  o  The random number generators are different, and the seeds have
     different length.

  o  The glm family objects are implemented differently in R and S.  The
     same functionality is available but the components have different
     names.

  o  terms objects are stored differently.  In S a terms object is an
     expression with attributes, in R it is a formula with attributes.
     The attributes have the same names but are mostly stored
     differently.  The major difference in functionality is that a terms
     object is subscriptable in S but not in R.	If you can't imagine
     why this would matter then you don't need to know.

  There are also differences which are not intentional, and result from
  missing or incorrect code in R.  The developers would appreciate
  hearing about any deficiencies you may find (in a written report fully
  documenting the difference as you see it).  Of course, it would be
  useful if you were to implement the change yourself and make sure it
  works.

  4.  R Add-On Packages

  4.1.	Which Add-on Packages Exist for R?

  The R distribution comes with the following extra libraries:

     eda
	Exploratory Data Analysis.  Currently only contains functions
	for robust line fitting, and median polish and smoothing.

     mva
	Multivariate Analysis.	Currently contains code for principal
	components (prcomp), canonical correlations (cancor),
	hierarchichal clustering (hclust), and metric multidimensional
	scaling (cmdscale).  More functions for clustering and scaling,
	biplots, profile and star plots, and code for ``real''
	discriminant analysis will be added soon.

  The following packages are available from the CRAN `src/contrib' area.

     acepack
	ace (Alternating Conditional Expectations) and avas (Additivity
	and variance stabilization for regression) for selecting
	regression transformations.

     bootstrap
	Software (bootstrap, cross-validation, jackknife), data and
	errata for the book ``An Introduction to the Bootstrap'' by B.
	Efron and R. Tibshirani, 1993, Chapman and Hall.

     ctest
	A library of classical tests, including the Bartlett, Fisher,
	Kruskal-Wallis, Kolmogorov-Smirnov, and Wilcoxon tests.

     date
	Functions for dealing with dates.  The most useful of them
	accepts a vector of input dates in any of the forms 8/30/53,
	30Aug53, 30 August 1953, ..., August 30 53, or any mixture of
	these.

     e1071
	Miscellaneous functions used at the Department of Statistics at
	TU Wien (E1071).

     fracdiff
	Maximum likelihood estimation of the parameters of a
	fractionally differenced ARIMA(p,d,q) model (Haslett and
	Raftery, Applied Statistics, 1989).

     gee
	An implementation of the Liang/Zeger generalized estimating
	equation approach to GLMs for dependent data.

     jpn
	A function to plot Japan's coast-line and prefecture boundaries.

     oz Functions for plotting Australias coastline and state
	boundaries.

     snns
	An R interface to the Stuttgart Neural Networks Simulator
	(SNNS).

     splines
	Regression spline functions.

     survival4
	Functions for survival analysis (requires splines).

  See CRAN `src/contrib/INDEX' for more information.

  Paul Gilbert <pgilbert@bank-banque-canada.ca> has a written a
  multivariate time series library for S called time.series that is
  mostly converted to run in R.	He will make this port generally
  available when complex numbers are implemented (see question ``What is
  the current version of R?'').

  According to Paul, the PADI interface from the Bank of Canada also
  works with minor changes.  PADI can be used to access Fame time series
  data bases and potentially other databases, even remotely over the
  Internet.  For further information see http:www.bank-banque-
  canada.ca/pgilbert.

  According to Arne Kovac <A.Kovac@Bristol.ac.uk>, Guy Nason's
  WaveThresh package for S worked with only minor modifications under R
  version 0.12.
  More code has been posted to the r-help mailing list, and can be
  obtained from the mailing list archive.

  4.2.	How Can Add-on Packages Be Installed?

  (Unix only.)	Untar the add-on packages in $RHOME/src/library/ and
  type

       $ make libs
       $ cd ../..
       $ ./etc/install-libhelp

  at the shell prompt.

  4.3.	How Can Add-on Packages Be Used?

  To find out which add-ons have already been installed, type

       R> library()

  at the R prompt.  This produces something like

       NAME	    DESCRIPTION
       acepack	 ace() and avas() for selecting regression transformations
       bootstrap       Functions for the book "An Introduction to the Bootstrap"
       ctest	   Classical Tests
       date	    Functions for handling dates
       eda	     Exploratory Data Analysis
       fracdiff	Fractionally differenced ARIMA (p,d,q) models
       gee	     Generalized Estimating Equation models
       mva	     Classical Multivariate Analysis
       splines	 Regression spline functions
       survival4       Survival analysis [needs library(splines)]

  You can ``load'' an add-on with name name by

       R> library(name)

  You can then find out which functions it provides by typing

       R> help(library = name)

  4.4.	How Can I Contribute to R?

  R is currently still in alpha (or pre-alpha) state, so simply using it
  and communicating problems is certainly of great value.
  One place where functionality is still missing is the modeling
  software as described in ``Statistical Models in S'' (see question
  ``What is S?''.  The functions

	add1 kappa alias labels drop1 proj

  are missing; many of these are interpreted functions so anyone that is
  bored and wants to have a go at implementing them it would be appreci-
  ated.	In addition, only linear and generalized linear models are cur-
  rently available, aov, gam, loess, tree, and the nonlinear modelling
  code are not there yet.

  Many of the packages available at the Statlib S Repository might be
  worth porting to R.

  If you are interested in working on any of these projects, please
  notify Kurt Hornik.

  5.  R and Emacs

  5.1.	Is there Emacs Support for R?

  There is an Emacs-Lisp interface to S/S-PLUS called S-mode.  Its
  current version is 4.8 and can be obtained at
  http://www.maths.lancs.ac.uk:2080/~maa036/elisp/S-mode/.  The earlier
  versions which can be found at the Statlib S repository (gnuemacs3 and
  gnuemacs4) are outdated.

  It contains code for interacting with an inferior S process from
  within Emacs including an interface to the help system, editing S
  source code, and transcript manipulation, and comes with detailed
  instructions for installation.

  Martin Maechler <maechler@stat.math.ethz.ch> and Tony Rossini
  <rossini@math.sc.edu> have integrated support for R into this package.
  The current version is at

       ftp://ftp.math.sc.edu/rossini/S-mode-4.8.MM6.XE2.tar.gz

  and runs under both GNU Emacs and XEmacs.

  To install, put the byte-compiled `.el' files into a place where Emacs
  can find them, and add

       (if (not (assoc "\\.R$" auto-mode-alist)
	   (add-to-list 'auto-mode-alist (cons "\\.R$" 'R-mode))))
       (autoload 'R "S" "Run an inferior R process" t)
       (autoload 'R-mode "S" "Mode for editing R source" t)
       (autoload 'r-mode "S" "Mode for editing R source" t)

  to one of your Emacs startup files, typically `~/.emacs'.  You can
  then fire up R from within Emacs by typing `M-x R' (note however that
  many interface functions will not work), and if you use the extension
  `.R' for your files with R code, Emacs will automagically turn on R
  edit mode whenever you visit such a file.

  Tony Rossini, Martin Maechler and Kurt Hornik have officially taken
  over the development of S-mode.  Version 4.9 (based on the current
  4.8.MM series) will be released shortly;  version 5.0 (codenamed
  ``istat'') should be out by the end of 1997.

  5.2.	Should I Run R from Within Emacs?

  Yes.	Inferior R mode provides a readline/history mechanism, object
  name completion, and syntax-based highlighting of the interaction
  buffer using Font Lock mode, as well as a very convenient interface to
  the R help system.  Of course, it also integrates nicely with the
  mechanisms for editing R source using Emacs.

  6.  R Miscellania

  6.1.	How Can I Read a Large Data Set into R?

  R (currently) uses a static memory model.  This means that when it
  starts up, it asks the operating system to reserve a fixed amount of
  memory for it.  The size of this chunk cannot be changed subsequently.
  Hence, it can happen that not enough memory was allocated.

  In these cases, you should restart R with more memory available, using
  the command line options -n and -v.  To understand these options, one
  needs to know that R maintains separate areas for fixed and variable
  sized objects.  The first of these is allocated as an array of
  SEXPRECs assembled in a list using ``cons cells'' (ordered pairs each
  containing an element of the list and a pointer to the next cell), and
  the second as an array of VECRECs.  The -n option can be used to
  specify the number of cons cells (each occupying 16 bytes) which R is
  to use (the default is 200000), and the -v option to specify the size
  of the vector heap in megabytes (the default is 2).  Only integers are
  allowed for both options.

  E.g., to read in a table of 5000 observations on 40 numeric variables,
  R -v 6 should do.

  Note that the information where to find vectors and strings on the
  heap is stored using cons cells.  Thus, it may also be necessary to
  allocate more space for cons cells in order to perform computations
  with very ``large'' variable-size objects.

  You can find out the current memory comsumption by typing gc() at the
  R prompt.

  6.2.	Why Can't R Source a `Correct' File?

  R sometimes has problems parsing a file which does not end in a
  newline.  This can happen for example when Emacs is used for editing
  the file and next-line-add-newlines is set to nil.  To avoid the
  problem, either set require-final-newline to a non-nil value in one of
  your Emacs startup files, or make sure R-mode (see question ``Is there
  Emacs Support for R?'') is used for editing R source files (which
  locally ensures this setting).

  Earlier R versions had a similar problem when reading in data files,
  but this should have been taken care of now.

  6.3.	How Can I Set Components of a List to NULL?

  You can use

       x[i] <- list(NULL)

  to set component i of the list x to NULL, similarly for named compo-
  nents.  Do not set x[i] or x[[i]] to NULL, because this will remove
  the corresponding component from the list.

  For dropping the row names of a matrix x, it may be easier to use
  rownames(x) <- NULL, similarly for column names.

  6.4.	How Can I Save My Workspace?

  The expression

       save(list = ls(), file = ".RData")

  saves the objects in the currently active environment (typically the
  user's .GlobalEnv) to the file `.RData' in the R startup directory.

  6.5.	How Can I Clean Up My Workspace?

  To remove all objects in the currently active environment (typically
  the user's .GlobalEnv), you can do

       rm(list = ls())

  7.  Acknowledgments

  Of course, many many thanks to Robert and Ross for the R system, and
  to the package writers and porters for adding to it.

  Special thanks go to Peter Dalgaard, Paul Gilbert, Martin Maechler,
  and Anthony Rossini for their comments which helped me improve this
  FAQ.

  More to some soon ...

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Friedrich.Leisch@ci.tuwien.ac.at  Wed Apr 16 17:17:25 1997
From: Friedrich.Leisch@ci.tuwien.ac.at (Friedrich Leisch)
Date: Wed, 16 Apr 1997 18:17:25 +0200
Subject: R-alpha: data in contributed packages
Message-ID: <199704161617.SAA14180@galadriel.ci.tuwien.ac.at>


I know, we've discussed this several times in the good old days days
of the R-testers list :-), but the problem is still unsolved.

I want to include Tibshirani's data in my port of the bootstrap
package, but we still have no way of including data in a clean way.

IMHO we should have a subdirectory of $RHOME/data for each library,
e.g.
	$RHOME/data/base
	$RHOME/data/bootstrap

Actually that's the setup we are currently using here in Vienna.

We've modified the filename script to reflect that changes (which also
allows users to have a R hierarchy with library, data, etc in
~/lib/R):


*********** original filename *********** =20

#!/bin/sh

file=3D$RHOME/$1/$2

if [ -r $file ]
then
        echo $file
else
        echo
fi



*********** our filename *********** =20

#!/bin/sh

for file in $HOME/lib/R/$1/$2 \         # user R hierarchy
            $RHOME/$1/$2 \              # standard dirs
            $RHOME/$1/[^.]*/$2;         # one level of subdirs
do
    if [ -r $file ]
    then
        echo $file
        break
    fi
done

if [ ! -r $file ]
then
    echo
fi


****************************

Any comments, ... ?

Best,
Fritz

PS: In a best of all possible worlds one should of course have some
recursive searching like in TeX :-)

--=20
---------------------------------------------------------------------
                         Friedrich  Leisch                            =20
 Institut f=FCr Statistik                      Tel: (+43 1) 58801 4541
 Technische Universit=E4t Wien                 Fax: (+43 1)  504 14 98
 Wiedner Hauptstra=DFe 8-10/1071      Friedrich.Leisch@ci.tuwien.ac.at
 A-1040 Wien, Austria             http://www.ci.tuwien.ac.at/~leisch
      PGP public key http://www.ci.tuwien.ac.at/~leisch/pgp.key
---------------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Thu Apr 17 10:05:11 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Thu, 17 Apr 1997 11:05:11 +0200
Subject: R-alpha: R-0.50.b6:  bug in graphics demo
Message-ID: <199704170905.LAA14424@aragorn.ci.tuwien.ac.at>

The line
  contour(volcano, x, y, l, col = "yellow", lty = "solid", add = TRUE)
needs to be changed to
  contour(x, y, volcano, col = "yellow", lty = "solid", add = TRUE)

A patch is appended below.

-k

*** demos/graphics/graphics.orig	Thu Apr 17 11:02:39 1997
--- demos/graphics/graphics	Thu Apr 17 11:03:08 1997
*************** plot(numeric(0), numeric(0), NULL,
*** 129,135 ****
  	type="n", ann=FALSE)
  usr <- par("usr")
  rect(usr[1], usr[3], usr[2], usr[4], col="green3")
! contour(volcano, x, y, l, col="yellow", lty="solid", add=TRUE)
  box()
  title("A Topographic Map of Maunga Whau",font=4)
  title(xlab="Meters North", ylab="Meters West", font=3)
--- 129,135 ----
  	type="n", ann=FALSE)
  usr <- par("usr")
  rect(usr[1], usr[3], usr[2], usr[4], col="green3")
! contour(x, y, volcano, col="yellow", lty="solid", add=TRUE)
  box()
  title("A Topographic Map of Maunga Whau",font=4)
  title(xlab="Meters North", ylab="Meters West", font=3)
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Thu Apr 17 10:33:40 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 17 Apr 1997 11:33:40 +0200
Subject: R-alpha: R-0.50.b6:  bug in graphics demo
In-Reply-To: Kurt Hornik's message of Thu, 17 Apr 1997 11:05:11 +0200
References: <199704170905.LAA14424@aragorn.ci.tuwien.ac.at>
Message-ID: <x2encaxabv.fsf@bush.kubism.ku.dk>

Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

> 
> The line
>   contour(volcano, x, y, l, col = "yellow", lty = "solid", add = TRUE)
> needs to be changed to
>   contour(x, y, volcano, col = "yellow", lty = "solid", add = TRUE)
> 

The help file for image() has the same problem, both in the USAGE and
EXAMPLES section. And while we're at it: the ALIASes should contain
"contour", not "image", right?

BTW: Ross seems to have quietly put out an R7.tgz (compiling as I type
this) and forgotten to tell us about it...

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Thu Apr 17 11:12:44 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 17 Apr 1997 12:12:44 +0200
Subject: R-alpha: fitted = 0 of 1 in logistic regression
Message-ID: <x2d8rux8ir.fsf@bush.kubism.ku.dk>


TASK:   problem with "glm" with binomial errors
STATUS: Open
FROM:   p.dalgaard@kubism.ku.dk
        in glm(,binomial) it's possible that loss of significant
        digits make expected values 0 or 1 even though there's no
        divergence of the fit.  (Happened to me with menarche data,
        infants and grown-ups included)
        [ Need the example data.  Glm needs a complete overhaul. ]

OK, here's a way to fake some data (simulated as if menarche occurs
uniformly between 10 an 15 years of age) There's no real problem with
fitting a logistic regression to this, but the logistic curve gets too
close to 0 and 1 for the very young and the very old.

BTW: rbinom gives NA for p=0 and p=1, which causes some problems with
the simulations. 
BTW2: Doesn't "occurred" take a double r?

> fake.age<-runif(500,0,50)
> fake.menarche<-rbinom(500,1,.99999 *(fake.age > 15) + .99999 * (fake.age > 10 & fake.age <= 15)/5 * (fake.age - 10)+.000005)
> glm(fake.menarche~fake.age,binomial)
Error: fitted probabilities of 0 or 1 occured
> fake2.age<-fake.age[fake.age<25&fake.age>5]
> fake2.menarche<-fake.menarche[fake.age<25&fake.age>5]
> glm(fake2.menarche~fake2.age,binomial)

Call:  glm(fake2.menarche ~ fake2.age, binomial) 

Coefficients:
(Intercept)    fake2.age  
   -15.1061       1.2011  

Degrees of Freedom: 189 Total; 187 Residual
Null Deviance: 253.9 
Residual Deviance: 48.73 
> 


-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Thu Apr 17 11:36:03 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Thu, 17 Apr 1997 22:36:03 +1200 (NZST)
Subject: R-alpha: R-0.50.b6:  bug in graphics demo
Message-ID: <199704171036.WAA08581@stat1.stat.auckland.ac.nz>

> BTW: Ross seems to have quietly put out an R7.tgz (compiling as I type
> this) and forgotten to tell us about it...

Don't expect much difference.  That was just so that Martin M could
check whether configuration and compilation with Fortran would work
under Solaris.

If you people would just stop finding bugs, I could a real version
ready ... :-).  We have a week break from teaching next week.  So
if not tomorrow, hopefully then.

[ Actually I have to confess I've been playing networks - getting a PPP
  connection from home going.  Which is what I'm using at present.
  Infinitely nicer than using "tip". ]
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Thu Apr 17 15:09:36 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Thu, 17 Apr 1997 16:09:36 +0200
Subject: R-alpha: R-0.50.b6:  bug in graphics demo
In-Reply-To: <199704171036.WAA08581@stat1.stat.auckland.ac.nz>
References: <199704171036.WAA08581@stat1.stat.auckland.ac.nz>
Message-ID: <199704171409.QAA25593@aragorn.ci.tuwien.ac.at>

>>>>> Ross Ihaka writes:

>> BTW: Ross seems to have quietly put out an R7.tgz (compiling as I type
>> this) and forgotten to tell us about it...

> Don't expect much difference.  That was just so that Martin M could
> check whether configuration and compilation with Fortran would work
> under Solaris.

And nevertheless, my bug log got almost halved ...

> If you people would just stop finding bugs, I could a real version
> ready ... :-).  We have a week break from teaching next week.  So
> if not tomorrow, hopefully then.

O.k.  I PROMISE I won't send any more bug reports, as I am dying to see
0.50 out :-)

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Thu Apr 17 15:43:33 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 17 Apr 1997 16:43:33 +0200
Subject: R-alpha: The list of *open* tasks
In-Reply-To: Kurt Hornik's message of Thu, 17 Apr 1997 16:09:36 +0200
References: <199704171036.WAA08581@stat1.stat.auckland.ac.nz>
 <199704171409.QAA25593@aragorn.ci.tuwien.ac.at>
Message-ID: <x2n2qxsoa1.fsf_-_@bush.kubism.ku.dk>

Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

> And nevertheless, my bug log got almost halved ...

Apropos bug logs. It's getting a bit boring to wade through all of the
bugs in the TASKS file that have already been fixed. Here's a little
something I cooked up earlier today: 

---------------------------cut------
#!/bin/sh
awk '
/^TASK/                         {task = $0}
/^STATUS/ && $2~/[Oo]pen/       {print task; doprint=1}
doprint 
/^-------/                      {doprint=0}' TASKS
---------------------------cut------

Put into (say) list-open-tasks in the $RHOME and chmod +x. Execute
from $RHOME.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From la-jassine@aix.pacwan.net  Fri Apr 18 10:33:09 1997
From: la-jassine@aix.pacwan.net (Paul Gilbert)
Date: Fri, 18 Apr 1997 06:33:09 -0300
Subject: R-alpha: data in contributed packages
Message-ID: <1350716654-1304675@aix.pacwan.net>

Friedrich

Regarding the location of data for libraries it might be easier if
everything for one library is included in one subdirectory. At least it
would certainly be easier to clean-up, which I like to do every few years.
Thus the code file, data, and any compiled code would be in one subdirectory
under $RHOME/library. 

I realize this means a small change to the way libraries are now found, but
in the end I think it would be much cleaner.

Paul

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Sun Apr 20 17:40:06 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 20 Apr 1997 18:40:06 +0200
Subject: R-alpha: Playing the tag game
Message-ID: <x2rag5r6l5.fsf@bush.kubism.ku.dk>

Here are a handful of oddities in pre0.50-7 (at some risk of reprisals
from people waiting for the real 0.50...):

I was mucking about trying to figure out how to know which tags has
been used in a function call, and some weird stuff happened.

----------
A call with tagged arguments is something like a list, the tags
can be used to access elements, but the names attribute is absent,
until the call is coerced to a list. (Attempting to set the names()
causes evaluation. Changing "list" to "blipblop" causes an 'Error:
couldn't find function "blipblop"' at that point.)

> j<-substitute(list(a=1,b=2))
> j
list(a = 1, b = 2)
> j$b
[1] 2
> names(j)
NULL
> names(j)<-NULL
> j
[[1]]
[1] 1

[[2]]
[1] 2
-----------
This one is plainly a bug. Meaningless, but...

[Previously saved workspace restored]

> j<-as.call(list(a=1,b=2))
> j
Segmentation fault (core dumped)
------------
Strange... as.call should return its argument if is.call is true?

> j<-substitute(list(a=1,b=2))
> j
list(a = 1, b = 2)
> as.call(j)
Error in as.call(j) : invalid argument list
> is.call(j)
[1] TRUE

------------
Ok, the right solution seems to be names(as.list(j)), but then we run
into some other fun with NA's... Shouldn't the real NA print without
quotes?

> ch[1]<-paste("N","A",sep="") 
> is.na(ch)
[1] FALSE FALSE FALSE
> ch
[1] "NA" "a"  "b" 
> ch[1]=="NA"
[1] TRUE
> ch[1]<-"NA"                 
> is.na(ch)
[1]  TRUE FALSE FALSE
> 

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Sun Apr 20 21:43:35 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Mon, 21 Apr 1997 08:43:35 +1200 (NZST)
Subject: R-alpha: Playing the tag game
Message-ID: <199704202043.IAA28435@stat1.stat.auckland.ac.nz>

	Here are a handful of oddities in pre0.50-7 (at some risk of reprisals
	from people waiting for the real 0.50...):

I don't know that these will even be looked at before 0.49 :-) comes
out.  I'm checking portabity and configuration at present.  It would
be REALLY nice if commercial vendors could stick to the standards
(ANSI, POSIX ...) as well as the free software developers do.

	I was mucking about trying to figure out how to know which tags has
	been used in a function call, and some weird stuff happened.

	----------
	A call with tagged arguments is something like a list, the tags
	can be used to access elements, but the names attribute is absent,
	until the call is coerced to a list. (Attempting to set the names()
	causes evaluation. Changing "list" to "blipblop" causes an 'Error:
	couldn't find function "blipblop"' at that point.)

	> j<-substitute(list(a=1,b=2))
	> j
	list(a = 1, b = 2)
	> j$b
	[1] 2
	> names(j)
	NULL
	> names(j)<-NULL
	> j
	[[1]]
	[1] 1

	[[2]]
	[1] 2

This is an oversight, and should have a one line fix (add extra cases
to an existing switch).

	[Previously saved workspace restored]

	> j<-as.call(list(a=1,b=2))
	> j
	Segmentation fault (core dumped)
	------------
	Strange... as.call should return its argument if is.call is true?

	> j<-substitute(list(a=1,b=2))
	> j
	list(a = 1, b = 2)
	> as.call(j)
	Error in as.call(j) : invalid argument list
	> is.call(j)
	[1] TRUE

"as.call" is pretty new and unexercised.

	Ok, the right solution seems to be names(as.list(j)), but then we run
	into some other fun with NA's... Shouldn't the real NA print without
	quotes?

	> ch[1]<-paste("N","A",sep="") 
	> is.na(ch)
	[1] FALSE FALSE FALSE
	> ch
	[1] "NA" "a"  "b" 
	> ch[1]=="NA"
	[1] TRUE
	> ch[1]<-"NA"                 
	> is.na(ch)
	[1]  TRUE FALSE FALSE
	> 

You naughty boy! :-)  I've have always thought that using "NA" to
indicate a missing string value was asking for problems.  What happens
when some poor unsuspecting user starts abbreviating "North America"
for example.

We use a bottleneck at string creation time to check whether the string
being stored is "NA".  If it is, we return the address of a special
unique string.  That way we can check for NA by simply doing an address
comparison rather than a string comparison (this is the same trick we
use for comparing variable names).  This doesn't catch "NA" strings
made in the underhand fashion above.

I see a couple of possible solutions.

1.  Remain compatible with S and just unoptimise our detection of
    string NAs.

2.  Be incompatible with S and introduce a real NA for strings.
    This would print as NA rather than "NA".  I like this second
    solution, but its does violate the "prime directive" (be
    compatible).

Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Tue Apr 22 13:08:08 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 22 Apr 1997 14:08:08 +0200
Subject: R-alpha: data in contributed packages
In-Reply-To: <1350716654-1304675@aix.pacwan.net>
References: <1350716654-1304675@aix.pacwan.net>
Message-ID: <199704221208.OAA00678@aragorn.ci.tuwien.ac.at>

>>>>> Paul Gilbert writes:

> Friedrich

> Regarding the location of data for libraries it might be easier if
> everything for one library is included in one subdirectory. At least
> it would certainly be easier to clean-up, which I like to do every few
> years.  Thus the code file, data, and any compiled code would be in
> one subdirectory under $RHOME/library.

Like

	library/<section>/
	library/<section>/data
	library/<section>/exec		(scripts and or binaries which
					 only make sense for the add-on)
	library/<section>/funs
	library/<section>/help
	library/<section>/html
	library/<section>/objs		(*.so)

???

> I realize this means a small change to the way libraries are now
> found, but in the end I think it would be much cleaner.

I think the changes would not be too hard, and we need to do something
about the directory structure anyway.

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Apr 22 14:07:28 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 22 Apr 97 15:07:28 +0200
Subject: R-alpha:  contributed packages -- Yes, use library/<package>/.. !
Message-ID: <9704221307.AA01047@>


>>>>> "Kurt" == Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

>>>>> Paul Gilbert writes:
    >> Friedrich

    >> Regarding the location of data for libraries it might be easier if
    >> everything for one library is included in one subdirectory. At least
    >> it would certainly be easier to clean-up, which I like to do every
    >> few years.  Thus the code file, data, and any compiled code would be
    >> in one subdirectory under $RHOME/library.

    Kurt> Like

    Kurt> library/<section>/
    Kurt> library/<section>/data
    Kurt> library/<section>/exec		(scripts and or binaries which
    Kurt> 				         only make sense for the add-on)
    Kurt> library/<section>/funs
    Kurt> library/<section>/help
    Kurt> library/<section>/html
    Kurt> library/<section>/objs		(*.so)

    Kurt> ???

    >> I realize this means a small change to the way libraries are now
    >> found, but in the end I think it would be much cleaner.

I agree completely.

Kurt, you surely feel like doing it for us ... ;-)

-- Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Tue Apr 22 14:50:43 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 22 Apr 1997 15:50:43 +0200
Subject: R-alpha: lazy evaluation and plot.step()
Message-ID: <199704221350.PAA01188@aragorn.ci.tuwien.ac.at>

Today I received an email which made me realize that what I wrote in the
FAQ explaining the different behavior of Martin's plot.step() under R
and S is not really true.

Does someone understand what is going on in the following?

"test" <-
function(x, y, xlab = deparse(substitute(x)), ylab = deparse(substitute(y)))
{
  x <- sort(x)
  print(xlab)
  n <- length(x)
  y <- (1:n) / n
  print(ylab)
}

Under R,

R> test(4:1)
[1] "c(1, 2, 3, 4)"
[1] "c(0.25, 0.5, 0.75, 1)"
R> test(4:1, 4)
[1] "c(1, 2, 3, 4)"
[1] "c(0.25, 0.5, 0.75, 1)"

Under S,

> test(4:1)
[1] "4:1"
[1] ""
[1] ""
> test(4:1, 4)
[1] "4:1"
[1] "c(0.25, 0.5, 0.75, 1)"
[1] "c(0.25, 0.5, 0.75, 1)"

???

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Tue Apr 22 16:18:46 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 22 Apr 1997 17:18:46 +0200
Subject: R-alpha: lazy evaluation and plot.step()
In-Reply-To: Kurt Hornik's message of Tue, 22 Apr 1997 15:50:43 +0200
References: <199704221350.PAA01188@aragorn.ci.tuwien.ac.at>
Message-ID: <x2u3kz9jc9.fsf@bush.kubism.ku.dk>


The explanation seems to be in different behaviour of the
substitute(...) construction:

R:
> f<-function(a,b){a<-1; print(deparse(substitute(c(a,b))))}
> f(a,b)
[1] "c(1, b)"

Splus:
> f<-function(a,b){a<-1; print(deparse(substitute(c(a,b))))}
> f(a,b)
[1] "c(a, b)"
[1] "c(a, b)"

So in R, assignment to a formal parameter causes the changed value to
be used for substitution purposes.

In S, this does not happen *unless the formal parameter is a
constant.*!

> f(2,b)
[1] "c(1, b)"
[1] "c(1, b)"
> f(2:2,b)
[1] "c(2:2, b)"
[1] "c(2:2, b)"
> f("a",b)    
[1] "c(1, b)"
[1] "c(1, b)"

This is confusing in both languages, but I'd say that S has the bigger
problem...

In Kurts example, inserting 

xlab 
ylab

as the first two lines of the function defeats lazy evaluation and
provides the desired behaviour (I suppose) in both R and S.

	- Peter

----

Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

> "test" <-
> function(x, y, xlab = deparse(substitute(x)), ylab = deparse(substitute(y)))
> {
>   x <- sort(x)
>   print(xlab)
>   n <- length(x)
>   y <- (1:n) / n
>   print(ylab)
> }
> 
> Under R,
> 
> R> test(4:1)
> [1] "c(1, 2, 3, 4)"
> [1] "c(0.25, 0.5, 0.75, 1)"
> R> test(4:1, 4)
> [1] "c(1, 2, 3, 4)"
> [1] "c(0.25, 0.5, 0.75, 1)"
> 
> Under S,
> 
> > test(4:1)
> [1] "4:1"
> [1] ""
> [1] ""
> > test(4:1, 4)
> [1] "4:1"
> [1] "c(0.25, 0.5, 0.75, 1)"
> [1] "c(0.25, 0.5, 0.75, 1)"
> 
> ???


-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Tue Apr 22 16:43:29 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 22 Apr 1997 17:43:29 +0200
Subject: R-alpha: binom.test
Message-ID: <199704221543.RAA01232@aragorn.ci.tuwien.ac.at>

I just realized that I got the code for the p-value (two-sided case) of
my ctest's binom.test wrong (again).  Anyway, before I fix that:  does
anyone know why S binom.test computes the p-value as it does?  (Any
references?)

Thanks,
-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Tue Apr 22 17:13:29 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 22 Apr 1997 18:13:29 +0200
Subject: R-alpha:  contributed packages -- Yes, use library/<package>/.. !
In-Reply-To: <9704221307.AA01047@>
References: <9704221307.AA01047@>
Message-ID: <199704221613.SAA01350@aragorn.ci.tuwien.ac.at>

>>>>> Martin Maechler writes:

>>>>> "Kurt" == Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

>>>>> Paul Gilbert writes:
>>> Friedrich

>>> Regarding the location of data for libraries it might be easier if
>>> everything for one library is included in one subdirectory. At least
>>> it would certainly be easier to clean-up, which I like to do every
>>> few years.  Thus the code file, data, and any compiled code would be
>>> in one subdirectory under $RHOME/library.

Kurt> Like

Kurt> library/<section>/
Kurt> library/<section>/data
Kurt> library/<section>/exec		(scripts and or binaries which
Kurt>                                    only make sense for the add-on)
Kurt> library/<section>/funs
Kurt> library/<section>/help
Kurt> library/<section>/html
Kurt> library/<section>/objs		(*.so)

Kurt> ???

>>> I realize this means a small change to the way libraries are now
>>> found, but in the end I think it would be much cleaner.

> I agree completely.

:-)

> Kurt, you surely feel like doing it for us ... ;-)

Actually, I think if R&R ok'ed something like that, Fritz and I would
take a look.

(In a way, I NEED to do something like that anyway, because I promised
it for making an official Debian package ...)

Would it mean that we also employ the S library/section concept?

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Tue Apr 22 17:23:24 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 22 Apr 1997 18:23:24 +0200
Subject: R-alpha: Rprofiles
Message-ID: <x2sp0j9gcj.fsf@bush.kubism.ku.dk>

The x11() window can be a nuisance to have popping up at startup (esp.
on small screens) when you're not working with graphics. However,
currently you can't get rid of it without modifying the systemwide
Rprofile. 

Current logic is:

Run $RHOME/library/Rprofile
if ./.Rprofile exists
	run it
else if $HOME/.Rprofile exists
	run that
endif

I think it should be

Run $RHOME/library/Rsetup
if ./.Rprofile exists
	run it
else if $HOME/.Rprofile exists
	run that
else if $RHOME/library/Rprofile exists
	run that
endif

i.e. essential system initialisation goes in Rsetup, the rest in
Rprofile, which can be overridden by the user. Currently, the line

if(interactive()) x11()

is the candidate to move from one to the other. BTW, it really should read

if(interactive() && getenv("DISPLAY")!="") x11()

[BTW2: getenv() implemented using system()? is that really necessary?]
-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Tue Apr 22 17:30:52 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 22 Apr 1997 18:30:52 +0200
Subject: R-alpha: Rprofiles
In-Reply-To: <x2sp0j9gcj.fsf@bush.kubism.ku.dk>
References: <x2sp0j9gcj.fsf@bush.kubism.ku.dk>
Message-ID: <199704221630.SAA01413@aragorn.ci.tuwien.ac.at>

>>>>> Peter Dalgaard BSA writes:

> The x11() window can be a nuisance to have popping up at startup (esp.
> on small screens) when you're not working with graphics. However,
> currently you can't get rid of it without modifying the systemwide
> Rprofile. 

> Current logic is:

> Run $RHOME/library/Rprofile
> if ./.Rprofile exists
> 	run it
> else if $HOME/.Rprofile exists
> 	run that
> endif

> I think it should be

> Run $RHOME/library/Rsetup
> if ./.Rprofile exists
> 	run it
> else if $HOME/.Rprofile exists
> 	run that
> else if $RHOME/library/Rprofile exists
> 	run that
> endif

> i.e. essential system initialisation goes in Rsetup, the rest in
> Rprofile, which can be overridden by the user.

I more or less agree, BUT:

I'd like (in the future) to have the system-wide Rprofile searched in a
site-specific location as well (similar to Emacs, following the idea of
keeping the distribution and the site-specific things apart).

So it would be
	system-wide Rsetup (which should basically be platform-specific
	  stuff, cause otherwise it could go into base as well?)
        if .Rprofile exists run it else
	if ~/.Rprofile exists run it else
        if Rprofile exists on the default library search path, run it

and that search path could e.g. specify all `library' trees with a
compile-time default of

	~/lib/R:/usr/local/lib/R/site:/usr/local/lib/R/${version}

and settable at run time via e.g. the environment variable R_PATH.

> Currently, the line

> if(interactive()) x11()

> is the candidate to move from one to the other. BTW, it really should read

> if(interactive() && getenv("DISPLAY")!="") x11()

Correct.  We've been making the same change with all upgrades :-)

> [BTW2: getenv() implemented using system()? is that really necessary?]

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Tue Apr 22 17:33:36 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 22 Apr 1997 18:33:36 +0200
Subject: R-alpha: lazy evaluation and plot.step()
In-Reply-To: <x2u3kz9jc9.fsf@bush.kubism.ku.dk>
References: <199704221350.PAA01188@aragorn.ci.tuwien.ac.at>
 <x2u3kz9jc9.fsf@bush.kubism.ku.dk>
Message-ID: <199704221633.SAA01423@aragorn.ci.tuwien.ac.at>

>>>>> Peter Dalgaard BSA writes:

> The explanation seems to be in different behaviour of the
> substitute(...) construction:

> R:
>> f<-function(a,b){a<-1; print(deparse(substitute(c(a,b))))}
>> f(a,b)
> [1] "c(1, b)"

> Splus:
>> f<-function(a,b){a<-1; print(deparse(substitute(c(a,b))))}
>> f(a,b)
> [1] "c(a, b)"
> [1] "c(a, b)"

> So in R, assignment to a formal parameter causes the changed value to
> be used for substitution purposes.

> In S, this does not happen *unless the formal parameter is a
> constant.*!

>> f(2,b)
> [1] "c(1, b)"
> [1] "c(1, b)"
>> f(2:2,b)
> [1] "c(2:2, b)"
> [1] "c(2:2, b)"
>> f("a",b)    
> [1] "c(1, b)"
> [1] "c(1, b)"

> This is confusing in both languages, but I'd say that S has the bigger
> problem...

Not a surprise ...

Thanks, Peter, for the explanation.  Does this also explain the
different results for x <- sort(x)?

> In Kurts example, inserting 

> xlab 
> ylab

> as the first two lines of the function defeats lazy evaluation and
> provides the desired behaviour (I suppose) in both R and S.

Yes.  This is also what I suggested to Martin in order to have a version
of plot.step() which does the same under R and S.

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Wed Apr 23 07:45:30 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 23 Apr 1997 08:45:30 +0200
Subject: R-alpha: CRAN
Message-ID: <199704230645.IAA03912@aragorn.ci.tuwien.ac.at>

Just wanted to point out that statlib has also become an official CRAN
mirror with the URL

	http://lib.stat.cmu.edu/R/CRAN/

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Wed Apr 23 09:05:33 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 23 Apr 97 10:05:33 +0200
Subject: R-alpha: Re: R-beta: 0.50 --> 0.49 'available' ((official ???)
In-Reply-To: <9704230756.AA07463@alpha.luc.ac.be> (message from Jim Lindsey on
 Wed, 23 Apr 1997 09:56:34 +0200 (MET DST))
Message-ID: <9704230805.AA01351@>

Hi Jim,
	[CC: only to R-devel,
	  since I expect  R&R  to ANNOUNCE  0.49 OFFICIALLY
	  on  R-announce (and hence R-help)
	]

This night, our mirror software got version 0.49  (=?= pre-release of 0.50 ??)
from the usual R-ftp-directory from Auckland.

Ross & Robert:  You ARE going to announce this on R-announce, yes?

-- Martin
	
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Wed Apr 23 16:28:37 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 23 Apr 1997 17:28:37 +0200
Subject: R-alpha: Re: R-beta: Version 0.49 Released
In-Reply-To: <199704230925.VAA24453@stat1.stat.auckland.ac.nz>
References: <199704230925.VAA24453@stat1.stat.auckland.ac.nz>
Message-ID: <199704231528.RAA14692@aragorn.ci.tuwien.ac.at>

>>>>> Ross Ihaka writes:

> The newest version of R for Unix (version 0.49) is now available
> (or soon will be) from the following sites.

> ...

I noticed the following problems (all already reported, but not in
TASKS).

* TASKS.OLD has

FROM:   <Kurt.Hornik@ci.tuwien.ac.at>
        Btw, here's another way to produce a segfault with admittedly
        nonsense code:
                R> x <- 1:5
                R> dimnames(x)[1,2] <- NULL
                Segmentation fault
        [ Hmmm.  This seems to have gone away.  I get the error     ]
        [ message "Error: incorrect number of subscripts on array". ]

On my Linux system, I still get the segfault.  Perhaps others could
check that?

* File permissions in data should be 644.

* In src/unix/system.c, one `Rdata' should be `RData' (d -> D).

* The documentation for the noncentral chisquare distribution is not
quite correct.  (rnchisq does not exist, the existing functions have x,
df and the noncentrality parameter as args, and the density should be

   pnchisq(x, df, lambda)
   = exp(-lambda / 2)
     * sum_{r=0}^\infty \frac{lambda^r}{2^r r!} pchisq(x, df + 2r)

(semiTeX notation only, sorry).

******************

New minor remarks:

* The documentation for `image' still has the old order z, x, y.

* Perhaps one should add `par(ask = T)' in the image demo?

* Perhaps one should save the original value of par() at the beginning
of the graphics demo, and restore that at its end (s.t. typically asking
is turned off again).

******************

Overall, REALLY GREAT!  Thanks for putting out the official release ...

Best,
-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From rossini@stat.sc.edu  Wed Apr 23 16:45:29 1997
From: rossini@stat.sc.edu (Anthony Rossini)
Date: 23 Apr 1997 11:45:29 -0400
Subject: R-alpha: Re: R-beta: Version 0.49 Released
In-Reply-To: Kurt Hornik's message of Wed, 23 Apr 1997 17:28:37 +0200
References: <199704230925.VAA24453@stat1.stat.auckland.ac.nz> <199704231528.RAA14692@aragorn.ci.tuwien.ac.at>
Message-ID: <wnc7mht9206.fsf@fhat.stat.sc.edu>


>>>>> "Kurt" == Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:


    Kurt> I noticed the following problems (all already reported, but
    Kurt> not in TASKS).

 Kurt> * TASKS.OLD has

    Kurt> FROM: <Kurt.Hornik@ci.tuwien.ac.at>
    Kurt>         Btw, here's another way to produce a segfault with
    Kurt>         admittedly nonsense code:
    R> x <- 1:5 dimnames(x)[1,2] <- NULL
    Kurt>                 Segmentation fault
    Kurt>         [ Hmmm.  This seems to have gone away.  I get the
    Kurt>         error ] [ message "Error: incorrect number of
    Kurt>         subscripts on array". ]

    Kurt> On my Linux system, I still get the segfault.  Perhaps
    Kurt> others could check that?


segfault on Solaris 2.5.1, as well:


fhat 73 > R

R : Copyright 1997, Robert Gentleman and Ross Ihaka
Version 0.49 Beta (April 23, 1997)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type "license()" for details.

> x <- 1:5
> dimnames(x)[1,2] <- NULL
Segmentation fault (core dumped)
fhat 74 > gdb bin/R.binary core
GDB is free software and you are welcome to distribute copies of it
 under certain conditions; type "show copying" to see the conditions.
There is absolutely no warranty for GDB; type "show warranty" for details.
GDB 4.15.1 (sparc-sun-solaris2.4), 
Copyright 1995 Free Software Foundation, Inc...
Core was generated by `/p1/apps/R/src/R-0.49/bin/R.binary'.
Program terminated with signal 11, Segmentation fault.

#0  0x254f0 in allocArray (mode=16, dims=0x175770) at array.c:124
124                     n = n * INTEGER(dims)[i];
(gdb) where
#0  0x254f0 in allocArray (mode=16, dims=0x175770) at array.c:124
#1  0xa6a0c in listAssign1 (call=0x2fb0a4, x=0x175770, subs=0x2fb0cc, 
    y=0x175770) at subassign.c:922
#2  0xa7650 in do_subassign (call=0x2fb0a4, op=0x1760bc, args=0x2fb090, 
    rho=0x17d1c8) at subassign.c:1119
#3  0x59b28 in eval (e=0x2fb0a4, rho=0x17d1c8) at eval.c:137
#4  0x5b630 in applydefine (call=0x2fafc8, op=0x175f40, args=0x2fafb4, 
    rho=0x17d1c8) at eval.c:625
#5  0x5b984 in do_set (call=0x2fafc8, op=0x175f40, args=0x2fafb4, rho=0x17d1c8)
    at eval.c:666
#6  0x59b28 in eval (e=0x2fafc8, rho=0x17d1c8) at eval.c:137
#7  0x65978 in R_Repl (rho=0x17d1c8, savestack=0, browselevel=0) at main.c:187
#8  0x65f4c in mainloop () at main.c:359
#9  0xcd6fc in main (ac=0, av=0xeffffa14) at system.c:267
(gdb) 



----
-tony (Anthony Rossini)	           Statistics Dept., U South Carolina
rossini@stat.sc.edu	           Columbia, SC 29208
http://www.stat.sc.edu/~rossini/   803-777-3578(O) 803-777-4048 (fax)  
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Wed Apr 23 16:59:29 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 23 Apr 1997 17:59:29 +0200
Subject: R-alpha: Re: R-beta: Version 0.49 Released
In-Reply-To: Kurt Hornik's message of Wed, 23 Apr 1997 17:28:37 +0200
References: <199704230925.VAA24453@stat1.stat.auckland.ac.nz>
 <199704231528.RAA14692@aragorn.ci.tuwien.ac.at>
Message-ID: <x2vi5d3f32.fsf@bush.kubism.ku.dk>

Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

> Overall, REALLY GREAT!  Thanks for putting out the official release ...

Agreed. How's the Win32 version coming along? 

And BTW how does the source code in the src/windows directory fit in?
Where's the Makefile, which compiler, which libraries, etc...

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From luke@stat.umn.edu  Wed Apr 23 17:22:38 1997
From: luke@stat.umn.edu (Luke Tierney)
Date: Wed, 23 Apr 1997 11:22:38 -0500 (CDT)
Subject: R-alpha: libraries, modules, namespaces, ...
Message-ID: <9704231622.AA10729@nokomis.stat.umn.edu>

Now that 0.49 has left the dock (great job Ross and Robert!) here is a
more global issue that may be worth thinking about. I haven't seen any
discussion along these lines yet, but maybe I missed it -- if so,
never mind.

One of the weaknesses of S for building larger packages that can be
used together is the lack of any namespace management facility.
Newer languages like Java, Dylan, Perl, Python, Fortran 90, etc., all
provide some variant of a module system with control over what gets
exported from and imported to modules. I believe something of that
flavor would be very useful in R (or any system). Lots of variations
are possible -- SML probably has the fanciest system of any I know,
Common Lisp's packages are arguably at the other end. An outline of
what might be needed:

	For module writers
		specify scope of module (part of file, all of file,
		several files?)

		specify exports, i.e. things that are to be (easily)
		accessible when the module is used.

	For module users
		simple importing (all exported things from a module)

		selective importing (just bring in some exported things)

		importing with renaming (to avoid conflicts)?

		maybe introspection tools to dig out private things in
		a module (mainly for debugging -- maybe this should not
		be supported).

With R's lexical scoping the ability to implement a module system
exists, e.g a module could be created as

mymodule <- (function() {
  import(other.module)
  f<-function() { .... }
  g<-function() { .... f() .... }
  list(h=g)
})()

which is supposed to export g under the name h but hides f.
An import function could do something like

import<-function(module) {
  assign values to names in caller's frame
}

Lots of scheme module systems use closures for module systems more or
less along these lines. It would be nice to have some nicer syntax, like

mymodule <- module (other.module) {
  ...
  export(...)
}

or whatever seems most natural (also depends on whether you want to
allow several modules per file, several files per module, or thether
modules have anything to do with files at all).

Making S code into an R module would (aside from dealing with
whatever incompatibilities there might be) just involve adding the
module wrapper and deciding what to export.

If being able to maintain common S and R sources seems important, modules
could be specified with a comment convention as in PostScript, emacs
mode lines, etc., something like

#@&^!R-MODULE mymodule
#@&^!R-IMPORT other.module
....
#@&^!R-EXPORT h=f, k, ...

The provide/require functions do a different but related job and would
need to be considered as part of such a design.

Just some food for thought.

luke


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From rgentlem@stat.auckland.ac.nz  Thu Apr 24 02:19:55 1997
From: rgentlem@stat.auckland.ac.nz (Robert Gentleman)
Date: Thu, 24 Apr 1997 13:19:55 +1200 (NZST)
Subject: R-alpha: Windows
Message-ID: <199704240119.NAA00278@stat3.stat.auckland.ac.nz>


 There is a alpha version of R for Windows95 available from 
  stat.auckland.ac.nz  in pub/research/rgentlem/RApril.zip

 Please have a look and a play and let me know what needs to be fixed.
 It should be about a (0.48 release)

robert
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Thu Apr 24 07:11:51 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Thu, 24 Apr 1997 08:11:51 +0200
Subject: R-alpha: libraries, modules, namespaces, ...
In-Reply-To: <9704231622.AA10729@nokomis.stat.umn.edu>
References: <9704231622.AA10729@nokomis.stat.umn.edu>
Message-ID: <199704240611.IAA17238@aragorn.ci.tuwien.ac.at>

>>>>> Luke Tierney writes:

> Now that 0.49 has left the dock (great job Ross and Robert!) here is a
> more global issue that may be worth thinking about. I haven't seen any
> discussion along these lines yet, but maybe I missed it -- if so,
> never mind.

> One of the weaknesses of S for building larger packages that can be
> used together is the lack of any namespace management facility.

> ...

Definitely.

> ...

> Just some food for thought.

Very cool!  Do you think that if we have modules, we should get rid of
the `library' mechanism altogether?  

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Thu Apr 24 07:51:32 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Thu, 24 Apr 1997 08:51:32 +0200
Subject: R-alpha: Re: R-beta: multiple binary types
In-Reply-To: <Pine.SUN.3.91.970423185754.10880F-300000@babcomm>
References: <Pine.SUN.3.91.970423185754.10880F-300000@babcomm>
Message-ID: <199704240651.IAA17442@aragorn.ci.tuwien.ac.at>

>>>>> Gregory R Warnes writes:

> I've modified the "$RHOME/bin/R" and "$RHOME/cmd/filename" so that you 
> can use the same directories for multiple machines.  That is, machines 
> running various flavors of UNIX can access the same directories.

> The modified structure adds the directories

> $RHOME/bin/$OSTYPE/
> $RHOME/lib/$OSTYPE/

> to hold the machine specific binaries.

> For instance, here the $RHOME directory contains two subdirectories,

> $RHOME/bin/solaris/
> $RHOME/bin/sunos4/

> which each hold the appropriate R.binary file.  

> These two modified functions assume that the environment variable $OSTYPE 
> is appropriately set, as is done automatically by the shell tcsh.  If it 
> is not set, the directory names collapse to the original values,
> 	$RHOME/bin/ and $RHOME/lib/

> ...

Is OSTYPE defined by POSIX?  I tried bash, ksh and csh on my Debian
GNU/Linux system.  Whereas all have it, we have

	bash, ksh:	Linux
	tcsh, csh:	linux

which is unfortunate but one could live with that (lowercasing ...).
The real problem is that the OS Linux exists on several hardware
platforms (ix86, alpha, solaris, m68k, ...), so one would really need

	${OSTYPE}-${HOSTTYPE}

Again not knowing what POSIX says, here are the results:

	bash, ksh:	i386
	tcsh, csh:	i386-linux

OH NO!

***

Note also that whereas the suggestion is perfect for binaries, it is in
a way `orthogonal' to rearranging the R tree into

	<library>/<section>/<type>

structure ... hmm, or should we have <platform> dirs for exec and objs?

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Thu Apr 24 07:54:55 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Thu, 24 Apr 1997 08:54:55 +0200
Subject: R-alpha: R-0.49:  RE postscript()
Message-ID: <199704240654.IAA17458@aragorn.ci.tuwien.ac.at>

R&R,

It also seems that pictex() is broken.  I've only taken a quick look,
but I think the reason is that

	.Internal(device("pictex", as.character(c(file)), c(width, 
                height, debug, bg, fg)))

should have bg and fg with the character args, and the driver code needs
to be updated accordingly ...

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Friedrich.Leisch@ci.tuwien.ac.at  Thu Apr 24 08:07:55 1997
From: Friedrich.Leisch@ci.tuwien.ac.at (Friedrich Leisch)
Date: Thu, 24 Apr 1997 09:07:55 +0200
Subject: R-alpha: Re: R-beta: multiple binary types
In-Reply-To: <199704240651.IAA17442@aragorn.ci.tuwien.ac.at>
References: <Pine.SUN.3.91.970423185754.10880F-300000@babcomm>
 <199704240651.IAA17442@aragorn.ci.tuwien.ac.at>
Message-ID: <199704240707.JAA11914@galadriel.ci.tuwien.ac.at>

>>>>> On Thu, 24 Apr 1997 08:51:32 +0200,
>>>>> Kurt Hornik wrote:

> ...

> Note also that whereas the suggestion is perfect for binaries, it is in
> a way `orthogonal' to rearranging the R tree into

> 	<library>/<section>/<type>

> structure ... hmm, or should we have <platform> dirs for exec and objs?

IMHO we should definetely have platform-dirs for everything that's
possibly platform-dependent ... resulting in something like

	<library>/<section>/<type>

e.g. for R code and

	<library>/<section>/<type>/<platform>

e.g. for exec and dynload-objects.

for exec there's a problem though, as some exec's are
shell/perl/whatever-scripts and *should* work on any platform
...  

.f
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Thu Apr 24 10:11:51 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Thu, 24 Apr 1997 21:11:51 +1200 (NZST)
Subject: R-alpha: Postscript bug ...
Message-ID: <199704240911.VAA05630@stat1.stat.auckland.ac.nz>

Jeez I dunno - it compiles perfectly and you guys get excited just because
it doesn't work :-)

I have to admit to being baffled about what happened (I'm SURE this was
working not long ago), but here is a quick fix.  The problem is in the
function "GetCharInfo" in the file src/unix/PostScript.c.

The fix is to change the statement

	if(nchar < 0)
		return 0;

to
	if(nchar < 0)
		return 1;

as indicated in the #ifdefs below.  I will make a patch file and put
it the archive with the .tgz file.

We seem to have enough problem reports to justfy getting a new 0.50 out
pretty soon in any case.

	Ross

- - - replacement - - GetCharInfo - - -

static int GetCharInfo(char *buf, FontMetricInfo *metrics)
{
	char *p = buf;
	int nchar;

	if(!MatchKey(buf, "C "))
		return 0;
	p = SkipToNextItem(p);
	sscanf(p, "%d", &nchar);
	if(nchar < 0)
#ifdef OLD
		return 0;
#else
		return 1;
#endif
	p = SkipToNextKey(p);

	if(!MatchKey(p, "WX"))
		return 0;
	p = SkipToNextItem(p);
	sscanf(p, "%hd", &(metrics->CharInfo[nchar].WX));
	p = SkipToNextKey(p);

	if(!MatchKey(p, "N "))
		return 0;
	p = SkipToNextKey(p);

	if(!MatchKey(p, "B "))
		return 0;
	p = SkipToNextItem(p);
	sscanf(p, "%hd %hd %hd %hd",
		&(metrics->CharInfo[nchar].BBox[0]),
		&(metrics->CharInfo[nchar].BBox[1]),
		&(metrics->CharInfo[nchar].BBox[2]),
		&(metrics->CharInfo[nchar].BBox[3]));

#ifdef DEBUG
	printf("nchar = %d %d %d %d %d %d\n", nchar,
		metrics->CharInfo[nchar].WX,
		metrics->CharInfo[nchar].BBox[0],
		metrics->CharInfo[nchar].BBox[1],
		metrics->CharInfo[nchar].BBox[2],
		metrics->CharInfo[nchar].BBox[3]);
#endif
	return 1;
}
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Thu Apr 24 10:35:41 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Thu, 24 Apr 1997 21:35:41 +1200 (NZST)
Subject: R-alpha: R-0.49 Patch #1
Message-ID: <199704240935.VAA06050@stat1.stat.auckland.ac.nz>

This patch corrects the broken postscript graphics driver.
If you have already done it by hand ignore this.

Apply this patch within the R-0.49 directory.

The patch is also at the auckland.ftp site and soon at mirrors.
	Ross


*** src/unix/PostScript.c.orig	Thu Apr 24 21:28:27 1997
--- src/unix//PostScript.c	Thu Apr 24 21:28:51 1997
***************
*** 160,166 ****
  	if(!MatchKey(buf, "C ")) return 0;
  	p = SkipToNextItem(p);
  	sscanf(p, "%d", &nchar);
! 	if(nchar < 0) return 0;
  	p = SkipToNextKey(p);
  
  	if(!MatchKey(p, "WX")) return 0;
--- 160,166 ----
  	if(!MatchKey(buf, "C ")) return 0;
  	p = SkipToNextItem(p);
  	sscanf(p, "%d", &nchar);
! 	if(nchar < 0) return 1;
  	p = SkipToNextKey(p);
  
  	if(!MatchKey(p, "WX")) return 0;
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Thu Apr 24 10:58:59 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 24 Apr 1997 11:58:59 +0200
Subject: R-alpha: Postscript bug ...
In-Reply-To: Ross Ihaka's message of Thu, 24 Apr 1997 21:11:51 +1200 (NZST)
References: <199704240911.VAA05630@stat1.stat.auckland.ac.nz>
Message-ID: <x2bu74vj18.fsf@bush.kubism.ku.dk>

Ross Ihaka <ihaka@stat.auckland.ac.nz> writes:

> We seem to have enough problem reports to justfy getting a new 0.50 out
> pretty soon in any case.

A succession of 0.49.n's would be better, I'd say. Preferably using
patches from 0.49 for those with slow links, but that's not all that
important. Heck, it's only 10 minutes across a 14k4 modem (but it took
more than an hour to transfer R7.tgz from here to Kurt in Vienna the
other day - that's between two sites with direct net connections...).

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Thu Apr 24 11:01:40 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Thu, 24 Apr 1997 22:01:40 +1200 (NZST)
Subject: R-alpha: Postscript bug ...
Message-ID: <199704241001.WAA06175@stat1.stat.auckland.ac.nz>

> A succession of 0.49.n's would be better, I'd say. Preferably using
> patches from 0.49 for those with slow links, but that's not all that
> important. Heck, it's only 10 minutes across a 14k4 modem (but it took
> more than an hour to transfer R7.tgz from here to Kurt in Vienna the
> other day - that's between two sites with direct net connections...).

And here was I thinking that the steam-driven abacus we use for
R development was low tech ...

I will try to send out "important" patches, but its hard to maintain
distinct branches and we have already diverged from 0.49 here.
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Andreas.Weingessel@ci.tuwien.ac.at  Thu Apr 24 11:24:10 1997
From: Andreas.Weingessel@ci.tuwien.ac.at (Andreas Weingessel)
Date: Thu, 24 Apr 1997 12:24:10 +0200
Subject: R-alpha: Seg. fault in tapply
Message-ID: <199704241024.MAA07829@elendil.ci.tuwien.ac.at>



Calling tapply with a NULL as INDEX argument causes a segmentation
fault on an i-586-linux machine.

So, if for example
	 y<-list(a=3D1:10,b=3D2:5)
then
	tapply(y$a,y$c,mean)
causes a segmentation fault.=20

This seg. fault is produced when a dimension of length integer(0) is
assigned to a list with one element and this object is shown
afterwards. E.g.:

R>  y<-list(a=3D1:10)
R> dim(y) <- integer(length(NULL))
R> y
Segmentation fault

This happens in the code of tapply, when INDEX=3DNULL in the lines

  extent <- integer(length(INDEX))
and
  dim(ans) <- extent


Regards,
	Andreas

************************************************************************
*                          Andreas Weingessel                          *
************************************************************************
* Institut f=FCr Statistik      *                Tel: (+43 1) 58801 4541 =
*
* Technische Universit=E4t Wien *                Fax: (+43 1)  504 14 98 =
*
* Wiedner Hauptstr. 8-10/1071 *     Andreas.Weingessel@ci.tuwien.ac.at *
* A-1040 Wien, Austria        * http://www.ci.tuwien.ac.at/~weingessel *
************************************************************************

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Thu Apr 24 11:51:08 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Thu, 24 Apr 1997 12:51:08 +0200
Subject: R-alpha: Postscript bug ...
In-Reply-To: <199704241001.WAA06175@stat1.stat.auckland.ac.nz>
References: <199704241001.WAA06175@stat1.stat.auckland.ac.nz>
Message-ID: <199704241051.MAA18473@aragorn.ci.tuwien.ac.at>

>>>>> Ross Ihaka writes:

>> A succession of 0.49.n's would be better, I'd say. Preferably using
>> patches from 0.49 for those with slow links, but that's not all that
>> important. Heck, it's only 10 minutes across a 14k4 modem (but it took
>> more than an hour to transfer R7.tgz from here to Kurt in Vienna the
>> other day - that's between two sites with direct net connections...).

> And here was I thinking that the steam-driven abacus we use for R
> development was low tech ...

Please don't keep mentioning the performance of my network connection
again and again  :-)

> I will try to send out "important" patches, but its hard to maintain
> distinct branches and we have already diverged from 0.49 here.

Please do.  Perhaps name them like

	R-0.49-0.49.1.diff.gz

???

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Thu Apr 24 11:48:07 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Thu, 24 Apr 1997 12:48:07 +0200
Subject: R-alpha: R-0.49 Patch #1
In-Reply-To: <199704240935.VAA06050@stat1.stat.auckland.ac.nz>
References: <199704240935.VAA06050@stat1.stat.auckland.ac.nz>
Message-ID: <199704241048.MAA18462@aragorn.ci.tuwien.ac.at>

>>>>> Ross Ihaka writes:

> This patch corrects the broken postscript graphics driver.
> If you have already done it by hand ignore this.

> Apply this patch within the R-0.49 directory.

> The patch is also at the auckland.ftp site and soon at mirrors.

Great, thanks.

I've put updated Debian/ix86 packages into CRAN ...

Btw, perhaps the patch should be sent to R-announce?  (The bug reports
came on R-help ...)

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Thu Apr 24 12:09:11 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Thu, 24 Apr 1997 13:09:11 +0200
Subject: R-alpha: R-0.49 PROJECTS
Message-ID: <199704241109.NAA18581@aragorn.ci.tuwien.ac.at>

R&R:

Re

 o  TIME SERIES
    A state-space/structural models package would be nice.  We have a
    partial spectrum analysis package.  It needs to be multivariate
    though.

Fritz and Andreas are teaching a time series course based on R this
semester, so they need to produce some code for that anyway.  If you
won't work on your code for some time, perhaps simply send us the
current versions and see what happens?

-k

PS1.  There was also `poly' function in your snapshot WORK tree ... do
you already have a final version of that?
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Thu Apr 24 14:14:22 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Thu, 24 Apr 1997 15:14:22 +0200
Subject: R-alpha: polynom add-on
Message-ID: <199704241314.PAA20059@aragorn.ci.tuwien.ac.at>

I've packaged Bill's polynom add-on for R (i.e., converted man pages and
took care of TITLE and INDEX).  Apart from the missing poly() everything
should be fine ...

The package can be found in the CRAN src/contrib area.

I've also added it to the Debian ix86 r-contrib package.

-k

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Fri Apr 25 00:36:23 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 25 Apr 1997 01:36:23 +0200
Subject: R-alpha: list assignment
Message-ID: <x2afmo803s.fsf@bush.kubism.ku.dk>

This works in Splus:

> x<-list()
> x[["f"]]<-1
> zz<-"g"
> x[[zz]]<-2 
> x
$f:
[1] 1

$g:
[1] 2

In R both variants fail unless the name is already on the list. The
first one can be replaced by x$f, but there's seems to be no
substitute for the other one (oh yes I found one, but it's not fit to
print!). This comes up if you e.g. want to create a variable in a data
frame with a name given by a character string.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From rgentlem@stat.auckland.ac.nz  Fri Apr 25 02:12:36 1997
From: rgentlem@stat.auckland.ac.nz (Robert Gentleman)
Date: Fri, 25 Apr 1997 13:12:36 +1200 (NZST)
Subject: R-alpha: list assignment
Message-ID: <199704250112.NAA00344@stat3.stat.auckland.ac.nz>


Peter,
  They don't work on purpose. Basically this is the same problem as indexing
beyond the end of an array. In almost all cases it is an error.
To add a variable with a specific name to a data frame how about

x (the dataframe)
var1 the variable
name1 the name

 x<-cbind(x,var1)
 names(x)[ncol(x)]<-name1


robert
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Andreas.Weingessel@ci.tuwien.ac.at  Fri Apr 25 10:04:21 1997
From: Andreas.Weingessel@ci.tuwien.ac.at (Andreas Weingessel)
Date: Fri, 25 Apr 1997 11:04:21 +0200
Subject: R-alpha: bug in approx
Message-ID: <199704250904.LAA11382@elendil.ci.tuwien.ac.at>


When the function approx is called with the argument rule=3D2, one gets
the error message
	Error: NAs in foreign function call (arg 6)
Besides, the meaning of rule=3D1 or rule=3D2 is opposite to that describe=
d
in the help text and used in S-plus.

For example, in R:

R> approx(1:10,2:11,xout=3D5:15,rule=3D1)
$x
 [1]  5  6  7  8  9 10 11 12 13 14 15

$y
 [1]  6  7  8  9 10 11 11 11 11 11 11

R> approx(1:10,2:11,xout=3D5:15,rule=3D2)
Error: NAs in foreign function call (arg 6)

but in S-plus:

> approx(1:10,2:11,xout=3D5:15,rule=3D1)
$x:
 [1]  5  6  7  8  9 10 11 12 13 14 15

$y:
 [1]  6  7  8  9 10 11 NA NA NA NA NA

> approx(1:10,2:11,xout=3D5:15,rule=3D2)
$x:
 [1]  5  6  7  8  9 10 11 12 13 14 15

$y:
 [1]  6  7  8  9 10 11 11 11 11 11 11


The reason for this bug can be found in the last lines of the code of
approx:

        if (rule =3D=3D 1) {
                low <- y[1]
                high <- y[length(x)]
        }
        else if (rule =3D=3D 2) {
                low <- NA
                high <- low
        }
        else stop("invalid extrapolation rule in approx")
        y <- .C("approx", as.double(x), as.double(y), length(x),=20
                xout =3D as.double(xout), length(xout), as.double(low),=20
                as.double(high))$xout
        return(list(x =3D xout, y =3D y))


If (rule =3D=3D 2) the values of low and high are set to NA. Immediately
afterwards, the foreign function "approx" is called with these values,
leading to the error
	Error: NAs in foreign function call (arg 6)

To obtain the same behavior as in S-plus (and as in the help-text) the
commands for (rule =3D=3D 1) and (rule =3D=3D 2) have to be exchanged.

	Regards,
		Andreas

************************************************************************
*                          Andreas Weingessel                          *
************************************************************************
* Institut f=FCr Statistik      *                Tel: (+43 1) 58801 4541 =
*
* Technische Universit=E4t Wien *                Fax: (+43 1)  504 14 98 =
*
* Wiedner Hauptstr. 8-10/1071 *     Andreas.Weingessel@ci.tuwien.ac.at *
* A-1040 Wien, Austria        * http://www.ci.tuwien.ac.at/~weingessel *
************************************************************************



=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Fri Apr 25 10:56:10 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Fri, 25 Apr 1997 11:56:10 +0200
Subject: R-alpha: xgobi
Message-ID: <199704250956.LAA25634@aragorn.ci.tuwien.ac.at>

I've commented out a few lines in the S function that comes with the
XGobi distribution and made 3 more changes or so ... now one can use it
for starting XGobi from within R.  Seems to work o.k.  [Cloning and
Copying does not, but does it under S-PLUS?]

The function requires something like tmpname(), so it currently has to
require our e1071 library.  R&R, couldn't we add the tmpname() wrapper
to the libc function to the distribution?

I've put xgobi.tar.gz into CRAN/src/contrib.  

I've also added it to the Debian Linux/GNU r-contrib package.  Doug,
if you're interested in an XGobi package, please let me know.

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From luke@stat.umn.edu  Fri Apr 25 11:12:19 1997
From: luke@stat.umn.edu (Luke Tierney)
Date: Fri, 25 Apr 1997 05:12:19 -0500 (CDT)
Subject: R-alpha: libraries, modules, namespaces, ...
In-Reply-To: <199704240611.IAA17238@aragorn.ci.tuwien.ac.at> from "Kurt Hornik" at Apr 24, 97 08:11:51 am
Message-ID: <9704251012.AA06862@nokomis.stat.umn.edu>

> 
> Very cool!  Do you think that if we have modules, we should get rid of
> the `library' mechanism altogether?  
> 

Something along those lines is probably still needed. Right now
library/provide/require are an imperative mechanism that (a) makes
additions to the global name space (b) makes code available.

Making code available is, I think, better handled by a declarative
module mechanism that describes what depends on what but leaves the
system the freedom to actually load the relevant code when it needs
to, unloaded it if it isn't needed, etc. A declarative mechanism in
which DLL's are viewed as just a special kind of module or as
containers for such modules (native modules if you like) would also
make handling of DLL code a bit easier and cleaner.

But modifying the global name space at run time to make certain groups
of things available is still something you need to be able to do (you
can think of it as an interactive import directive). So some variant
of a library command is still needed, but provide/require's
functionality would be replaced by the declarative module
mechanism. (At least from a user's point of view -- the implementation
might still use the same mechanism internally. Also some back door for
explicitly loading a module/DLL and for unloading would still be
useful during debugging of new code but would usually not be needed
once code is stable).

There is also a granularity issue that might be worth considering.  S
libraries tend to be fairly coarse-grained. With a module mechanism I
would tend to want to subdivide many of these libraries into smaller
modules, but it would still be useful to be able to organize them into
library-sized chunks. One way to allow that would be to allow nested
modules. While that might be an elegant solution in some sense, I
suspect it is too complex. A better choice is probably to have a
two-tiered mechanism like packages/classes in Java, libraries/modules
in dylan with libraries just a loose way of grouping modules.

One drawback of handling modules by something like

mymodule <- module { ... }

is that it strongly suggests that modules can be nested, are first
class, etc. If that is the case, great. But if not it would cause
confusion. If a simpler notion of module is used, a convention that
makes limitations clear (like comment-based module specification, or a
file=module convention) might be better.

Lots of things to think about.

luke
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Fri Apr 25 12:09:01 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 25 Apr 1997 13:09:01 +0200
Subject: R-alpha: list assignment
In-Reply-To: Robert Gentleman's message of Fri, 25 Apr 1997 13:12:36 +1200 (NZST)
References: <199704250112.NAA00344@stat3.stat.auckland.ac.nz>
Message-ID: <x2rafznyuq.fsf@bush.kubism.ku.dk>

Robert Gentleman <rgentlem@stat.auckland.ac.nz> writes:

> 
> 
> Peter,
>   They don't work on purpose. Basically this is the same problem as indexing
> beyond the end of an array. In almost all cases it is an error.
> To add a variable with a specific name to a data frame how about
> 
> x (the dataframe)
> var1 the variable
> name1 the name
> 
>  x<-cbind(x,var1)
>  names(x)[ncol(x)]<-name1

Hm. Not sure about that argument. After all we don't protect against
typing

x$mumble<-17
instead of 
x$grumble<-17

Once you're into indexing lists through character variables, shouldn't
you be assumed to know what you're doing? Beginners can do much more
mischief with e.g. dfr$new<-0 which will turn dfr into a list.

However, apropos your construct, watch this:

> x<-list()
> x[[1]]<-23
> names(x)[1]<-"a"
> x
$"a"
[1] 23

> unlist(x)
\"a\" 
   23 
> names(x)[1]     
[1] "\"a\""
> names(x)   
[1] "\"a\""
> names(x)[1]<-"a"
> names(x)
[1] "a"
> x
$a
[1] 23

> unlist(x)
 a 
23 


-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Friedrich.Leisch@ci.tuwien.ac.at  Fri Apr 25 13:16:50 1997
From: Friedrich.Leisch@ci.tuwien.ac.at (Friedrich Leisch)
Date: Fri, 25 Apr 1997 14:16:50 +0200
Subject: R-alpha: unresolved symbols
Message-ID: <199704251216.OAA17847@galadriel.ci.tuwien.ac.at>


I tried to convert hastie & tibshiranis mda package to R but ended
with a bunch of unresolved symbols:

R.binary: can't resolve symbol 'dbksl_'
R.binary: can't resolve symbol 'dblepr_'
R.binary: can't resolve symbol 'dqrdca_'
R.binary: can't resolve symbol 'intpr_'
R.binary: can't resolve symbol 'pack_'
R.binary: can't resolve symbol 'sgram_'
R.binary: can't resolve symbol 'sknotl_'
R.binary: can't resolve symbol 'unpack_'
R.binary: can't resolve symbol 'wmean_'

I'm using linux, f2c, gcc

Does anyone know which library these symbols are part of? Sun-specific?

I've also tried to load the stuff into Splus 3.4 on a HP 9000 using the H=
P C
compiler, same symbols seem to be missing.

Has anyone got the mda package up and running?

Best,
Fritz

--=20
-------------------------------------------------------------------
                        Friedrich  Leisch                            =20
Institut f=FCr Statistik                      Tel: (+43 1) 58801 4541
Technische Universit=E4t Wien                 Fax: (+43 1)  504 14 98
Wiedner Hauptstra=DFe 8-10/1071      Friedrich.Leisch@ci.tuwien.ac.at
A-1040 Wien, Austria             http://www.ci.tuwien.ac.at/~leisch
     PGP public key http://www.ci.tuwien.ac.at/~leisch/pgp.key
-------------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Fri Apr 25 13:19:29 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Fri, 25 Apr 1997 14:19:29 +0200
Subject: R-alpha: phyper() woes
Message-ID: <199704251219.OAA26048@aragorn.ci.tuwien.ac.at>

I can also confirm that rhyper(5,200,250,60) never returns (o.k., if
never is anything beyond 5 minutes).

More strikingly,

R> phyper(47, 76, 49, 68)
[1] 1

whereas

Splus> phyper(47, 76, 49, 68)
[1] 0.9883098


(Breaks my fisher.test() ...)

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Sun Apr 27 22:39:02 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Sun, 27 Apr 1997 14:39:02 -0700 (PDT)
Subject: R-alpha: R-beta: vector recycling weirdness
In-Reply-To: <9704010823.AA00318@>
Message-ID: <Pine.SUN.3.95.970427143317.14377A-100000@data>

wompom:~> R
R : Copyright 1997, Robert Gentleman and Ross Ihaka
Version 0.49 Beta (April 23, 1997)

R> f
function () 
{
        FALSE & matrix(FALSE, ncol = 1)
}
R> g
function () 
FALSE & matrix(FALSE, ncol = 1) 
R> f()
Warning in FALSE & matrix(FALSE, ncol = 1) : longer object length
        is not a multiple of shorter object length
      [,1]
[1,] FALSE
R> g()
      [,1]
[1,] FALSE
 
Is this weird or what?


Thomas Lumley
-----------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Apr 28 06:07:05 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 28 Apr 1997 07:07:05 +0200
Subject: R-alpha: R-0.49:  2 problems
Message-ID: <199704280507.HAA02509@aragorn.ci.tuwien.ac.at>

I found the following 2 problems (no debugging, sorry).

* qt(0.975, 3) never returns.

Can someone please check that?  Happens for me on Debian GNU/Linux/ix86
compiled with CFLAGS="-O2 -g".

* Yet another stupid way to cause a segfault:

R> x
Error: Object "x" not found
R> debug(t.test)
R> t.test(rnorm(10))
debug: choices <- c("two.sided", "greater", "less")
Browse[1]> return()
NULL
R> x
Error: Object "x" not found
Browse[1]> return()
Segmentation fault

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Apr 28 06:07:05 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 28 Apr 1997 07:07:05 +0200
Subject: R-alpha: list assignment
In-Reply-To: <x2rafznyuq.fsf@bush.kubism.ku.dk>
References: <199704250112.NAA00344@stat3.stat.auckland.ac.nz>
 <x2rafznyuq.fsf@bush.kubism.ku.dk>
Message-ID: <199704280507.HAA02510@aragorn.ci.tuwien.ac.at>

>>>>> Peter Dalgaard BSA writes:

> Robert Gentleman <rgentlem@stat.auckland.ac.nz> writes:
>> 
>> 
>> Peter,
>> They don't work on purpose. Basically this is the same problem as indexing
>> beyond the end of an array. In almost all cases it is an error.
>> To add a variable with a specific name to a data frame how about
>> 
>> x (the dataframe)
>> var1 the variable
>> name1 the name
>> 
>> x<-cbind(x,var1)
>> names(x)[ncol(x)]<-name1

> Hm. Not sure about that argument. After all we don't protect against
> typing

> x$mumble<-17
> instead of 
> x$grumble<-17

> Once you're into indexing lists through character variables, shouldn't
> you be assumed to know what you're doing? Beginners can do much more
> mischief with e.g. dfr$new<-0 which will turn dfr into a list.

> However, apropos your construct, watch this:

>> x<-list()
>> x[[1]]<-23
>> names(x)[1]<-"a"
>> x
> $"a"
> [1] 23

>> unlist(x)
> \"a\" 
>    23 
>> names(x)[1]     
> [1] "\"a\""
>> names(x)   
> [1] "\"a\""
>> names(x)[1]<-"a"
>> names(x)
> [1] "a"
>> x
> $a
> [1] 23

>> unlist(x)
>  a 
> 23

Which is the same (?) as the

R> l <- list("11" = 1:5)
R> l
$11
[1] 1 2 3 4 5

R> unlist(l)
111 112 113 114 115 
  1   2   3   4   5 

I ran into this weekend ...

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From rossini@math.sc.edu  Mon Apr 28 14:11:34 1997
From: rossini@math.sc.edu (Anthony Rossini)
Date: 28 Apr 1997 09:11:34 -0400
Subject: R-alpha: R-0.49:  2 problems
In-Reply-To: Kurt Hornik's message of Mon, 28 Apr 1997 07:07:05 +0200
References: <199704280507.HAA02509@aragorn.ci.tuwien.ac.at>
Message-ID: <wnc67x7qol5.fsf@fhat.stat.sc.edu>



>>>>> "Kurt" == Kurt Hornik <hornik@ci.tuwien.ac.at> writes:

    Kurt> I found the following 2 problems (no debugging, sorry).
 Kurt> * qt(0.975, 3) never returns.

    Kurt> Can someone please check that?  Happens for me on Debian
    Kurt> GNU/Linux/ix86 compiled with CFLAGS="-O2 -g".

Fine on Solaris, but see the transcript which follows.

 Kurt> * Yet another stupid way to cause a segfault:

    R> x
    Kurt> Error: Object "x" not found
    R> debug(t.test) t.test(rnorm(10))
    Kurt> debug: choices <- c("two.sided", "greater", "less")
    Kurt> Browse[1]> return()
    Kurt> NULL
    R> x
    Kurt> Error: Object "x" not found
    Kurt> Browse[1]> return()
    Kurt> Segmentation fault

I got a Bus Error, and it happened one line earlier...

Transcript:

>  neuromancer 21 > R
>  
>  R : Copyright 1997, Robert Gentleman and Ross Ihaka
>  Version 0.49 Beta (April 23, 1997)
>  
>  R is free software and comes with ABSOLUTELY NO WARRANTY.
>  You are welcome to redistribute it under certain conditions.
>  Type "license()" for details.
>  
>  >  qt(0.975, 3)
>  [1] 3.182446
>  > 
>  >  x
>  Error: Object "x" not found
>  > debug(t.test)
>  >  t.test(rnorm(10))
>  debug: choices <- c("two.sided", "greater", "less")
>  Browse[1]>  return()
>  NULL
>  > x
>  Error: Object "x" not found
>  Bus error (core dumped)
>  neuromancer 22 > 

with the following core dump:

>  neuromancer 22 > gdb /apps/R/bin/R.binary core
>  GDB is free software and you are welcome to distribute copies of it
>   under certain conditions; type "show copying" to see the conditions.
>  There is absolutely no warranty for GDB; type "show warranty" for details.
>  GDB 4.15.1 (sparc-sun-solaris2.4), 
>  Copyright 1995 Free Software Foundation, Inc...
>  Core was generated by `/p1/apps/R/src/R-0.49/bin/R.binary'.
>  Program terminated with signal 10, Bus error.
>  Reading symbols from /p1/apps/X11R6.3/lib/libSM.so.6.0...done.
>  Reading symbols from /p1/apps/X11R6.3/lib/libICE.so.6.3...done.
>  Reading symbols from /p1/apps/X11R6.3/lib/libX11.so.6.1...done.
>  Reading symbols from /usr/lib/libnsl.so.1...done.
>  Reading symbols from /usr/lib/libsocket.so.1...done.
>  Reading symbols from /usr/lib/libdl.so.1...done.
>  Reading symbols from /usr/lib/libm.so.1...done.
>  Reading symbols from /usr/lib/libc.so.1...done.
>  Reading symbols from /usr/lib/libintl.so.1...done.
>  Reading symbols from /usr/lib/libmp.so.1...done.
>  Reading symbols from /usr/lib/libw.so.1...done.
>  #0  0xef4e25c8 in longjmp ()
>  (gdb) where
>  #0  0xef4e25c8 in longjmp ()
>  #1  0x59214 in jump_now () at errors.c:126
>  #2  0x591c8 in jump_to_toplevel () at errors.c:119
>  #3  0x58f78 in error (format=0x1391a8 "Object \"%s\" not found\n")
>      at errors.c:78
>  #4  0x597a0 in eval (e=0x17f2c0, rho=0x17d1c8) at eval.c:92
>  #5  0x65978 in R_Repl (rho=0x17d1c8, savestack=0, browselevel=0) at main.c:187
>  #6  0x65f4c in mainloop () at main.c:359
>  #7  0xcd6fc in main (ac=0, av=0xeffffa6c) at system.c:267
>  (gdb) 

Something is not where it ought to be... (but I've not looked at the
source in a long enough time to tell you exactly what :-().

best,

----
-tony (Anthony Rossini)	           Statistics Dept., U South Carolina
rossini@stat.sc.edu	           Columbia, SC 29208
http://www.stat.sc.edu/~rossini/   803-777-3578(O) 803-777-4048 (fax)  
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Apr 28 14:37:03 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 28 Apr 1997 15:37:03 +0200
Subject: R-alpha: R-0.49:  2 problems
In-Reply-To: <wnc67x7qol5.fsf@fhat.stat.sc.edu>
References: <199704280507.HAA02509@aragorn.ci.tuwien.ac.at>
 <wnc67x7qol5.fsf@fhat.stat.sc.edu>
Message-ID: <199704281337.PAA06954@aragorn.ci.tuwien.ac.at>

>>>>> Anthony Rossini writes:

>>>>> "Kurt" == Kurt Hornik <hornik@ci.tuwien.ac.at> writes:

Kurt> I found the following 2 problems (no debugging, sorry).
Kurt> * qt(0.975, 3) never returns.

Kurt> Can someone please check that?  Happens for me on Debian
Kurt> GNU/Linux/ix86 compiled with CFLAGS="-O2 -g".

> Fine on Solaris, but see the transcript which follows.

Thanks, Tony.

Actually, also fine on Debian GNU/Linux/ix86 compiled with CFLAGS="-g",
as I expected ...

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Mon Apr 28 15:58:03 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Mon, 28 Apr 1997 07:58:03 -0700 (PDT)
Subject: R-alpha: R-beta:matrix & vector multiplication.
In-Reply-To: <9704010823.AA00318@>
Message-ID: <Pine.SUN.3.95.970428075618.1365B-100000@zen>

Both of these used to work and seem useful and harmless:

R> matrix(1,ncol=1)%*%c(1,2)
Error in matrix(1, ncol = 1) %*% c(1, 2) : non-conformable arguments

R> matrix(1,ncol=1)*(1:2)
Error: dim<- length of dims do not match the length of object


Thomas Lumley
-----------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Mon Apr 28 17:52:41 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 28 Apr 1997 18:52:41 +0200
Subject: R-alpha: R-W95
Message-ID: <x2sp0brsx2.fsf@bush.kubism.ku.dk>

Seems to be working very nicely (and what a relief to see it actually
working!), I've found only a few problems till now:

a) Characters outside 0-0x7f seem to get encoded as CP850 or
something, not Latin 1 ( keys on DK keyboard gives
mu,degree,sigma).

b) Infinite recursion crashed R. (I forget details, but it was
something stupid like f<-function(x){if (x < 1) 1 else f(x)*(x-1)})

c) I miss command-line recall *badly*...

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Mon Apr 28 20:18:07 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Mon, 28 Apr 1997 12:18:07 -0700 (PDT)
Subject: R-alpha: R-W95
In-Reply-To: <x2sp0brsx2.fsf@bush.kubism.ku.dk>
Message-ID: <Pine.SUN.3.95.970428121424.8287A-100000@avon>

On 28 Apr 1997, Peter Dalgaard BSA wrote:

> Seems to be working very nicely (and what a relief to see it actually
> working!), I've found only a few problems till now:

Me too.  There are some problems with the html help.  Firstly, if you
unzip the file with a program that doesn't know about long filenames none
of the links will work. Secondly, some of the links use forward rather
than back slashes as directory separators. Internet Explorer doesn't seem
to cope with this (I don't know about other browsers). 

Of course all my favorite test code is in libraries, so I couldn't
brutally stress the poor program....

Thomas Lumley
-----------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Mon Apr 28 22:16:05 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Tue, 29 Apr 1997 09:16:05 +1200 (NZST)
Subject: R-alpha: R-0.49:  2 problems
In-Reply-To: <199704280507.HAA02509@aragorn.ci.tuwien.ac.at>
References: <199704280507.HAA02509@aragorn.ci.tuwien.ac.at>
Message-ID: <199704282116.JAA24437@stat1.stat.auckland.ac.nz>

Kurt Hornik writes:
 > I found the following 2 problems (no debugging, sorry).
 > 
 > * qt(0.975, 3) never returns.
 > 
 > Can someone please check that?  Happens for me on Debian GNU/Linux/ix86
 > compiled with CFLAGS="-O2 -g".

I am having a look at the computations of p-values and quantiles which
depend on the incomplete beta function at  present.  I hope to have a
better set of functions in place by weeks end.  I may need a tester or
two to really exercise the new ones.  I'm also looking at the whole
math library to see exactly how much work a proper handling of Inf, NaN
and NA might involve.
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Apr 29 10:37:00 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 29 Apr 97 11:37:00 +0200
Subject: R-alpha: Re: Inf  et al.
In-Reply-To: <199704282116.JAA24437@stat1.stat.auckland.ac.nz> (message from
 Ross Ihaka on Tue, 29 Apr 1997 09:16:05 +1200 (NZST))
Message-ID: <9704290937.AA00877@>

>>>>> "Ross" == Ross Ihaka <ihaka@stat.auckland.ac.nz> writes:

    Ross> I am having a look at the computations of p-values and quantiles
    Ross> which depend on the incomplete beta function at present.  I hope
    Ross> to have a better set of functions in place by weeks end.  I may
    Ross> need a tester or two to really exercise the new ones.

I'd volunteer for this..

BTW: The phyper 'inaccuracy' is not a pbeta problem however.
I think that AS 152 (which has been improved, but is still available as
		     file  ...statlib.../apstat/152 )
should be used in place of  phyper.c
		

    Ross> I'm also
    Ross> looking at the whole math library to see exactly how much work a
    Ross> proper handling of Inf, NaN and NA might involve. 

I think that this is the most important of the current TASKS.
Even though it doesn't seem to be used so often,
I've been realizing lately that in several places in my code, I just rely
on things like  1/Inf  -> 0.
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Tue Apr 29 13:02:29 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 29 Apr 1997 14:02:29 +0200
Subject: R-alpha: Re: Inf  et al.
In-Reply-To: <9704290937.AA00877@>
References: <199704282116.JAA24437@stat1.stat.auckland.ac.nz>
 <9704290937.AA00877@>
Message-ID: <199704291202.OAA14127@aragorn.ci.tuwien.ac.at>

>>>>> Martin Maechler writes:

>>>>> "Ross" == Ross Ihaka <ihaka@stat.auckland.ac.nz> writes:
Ross> I am having a look at the computations of p-values and quantiles
Ross> which depend on the incomplete beta function at present.  I hope
Ross> to have a better set of functions in place by weeks end.  I may
Ross> need a tester or two to really exercise the new ones.

> I'd volunteer for this..

> BTW: The phyper 'inaccuracy' is not a pbeta problem however.
> I think that AS 152 (which has been improved, but is still available as
> 		     file  ...statlib.../apstat/152 )
> should be used in place of  phyper.c

If Martin volunteers for it, one tester should be enough.
		
-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Tue Apr 29 13:19:14 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 29 Apr 1997 14:19:14 +0200
Subject: R-alpha: Re: R-beta: Archives of   R-announce / R-help / R-devel -- monthly archive files
In-Reply-To: <9704290931.AA00870@>
References: <9704290931.AA00870@>
Message-ID: <199704291219.OAA14305@aragorn.ci.tuwien.ac.at>

>>>>> Martin Maechler writes:

> Something which seems missing from the current  R-FAQ
> which mentions "mailing list archive":

>     The 3 mailing lists   R-announce / R-help / R-devel 
>     are not only archived,
>     but the archives are also made publicly available on the net,
>     in a monthly schedule at

> 	    ftp://ftp.stat.math.ethz.ch/Mail-archives/

>     which is a directory of mail archive files.

>     You will be looking at  
> 	    r-testers-... (the old scheme)
> 	    r-announce-...
> 	    r-help-...
> 	    r-devel-...

Martin,

Thanks for the update.  (Writing something about mailing list archives
had been on my mind for some time now, but I could bot decide whether
CRAN should start mirroring the archives right away ...)

The FAQ now says,

  Archives of the three mailing lists are made publicly available on the
  net in a monthly schedule at ftp://ftp.stat.math.ethz.ch/Mail-
  archives/ (which is a directory of mail archive files).

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Tue Apr 29 13:35:36 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 29 Apr 1997 14:35:36 +0200
Subject: R-alpha: R-0.49:  2 problems
In-Reply-To: Ross Ihaka's message of Tue, 29 Apr 1997 09:16:05 +1200 (NZST)
References: <199704280507.HAA02509@aragorn.ci.tuwien.ac.at>
 <199704282116.JAA24437@stat1.stat.auckland.ac.nz>
Message-ID: <x29122vwfb.fsf@bush.kubism.ku.dk>

Ross Ihaka <ihaka@stat.auckland.ac.nz> writes:

> 
> Kurt Hornik writes:
>  > I found the following 2 problems (no debugging, sorry).
>  > 
>  > * qt(0.975, 3) never returns.
>  > 
>  > Can someone please check that?  Happens for me on Debian GNU/Linux/ix86
>  > compiled with CFLAGS="-O2 -g".
> 
> I am having a look at the computations of p-values and quantiles which
> depend on the incomplete beta function at  present. ....

The original problem seems to be one of loss of accuracy with
instruction reordering. Doubling the value of "acu" cures it (I ran it
under the debugger and the test value was stuck at about 1.5e-32,
being compared to acu=1e-23). This is probably a generic problem with
these last-bit-accurate routines.


-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Tue Apr 29 14:40:10 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 29 Apr 1997 15:40:10 +0200
Subject: R-alpha: R-0.49:  2 problems
In-Reply-To: Peter Dalgaard BSA's message of 29 Apr 1997 14:35:36 +0200
References: <199704280507.HAA02509@aragorn.ci.tuwien.ac.at>
 <199704282116.JAA24437@stat1.stat.auckland.ac.nz>
 <x29122vwfb.fsf@bush.kubism.ku.dk>
Message-ID: <x267x6vtfp.fsf@bush.kubism.ku.dk>

Peter Dalgaard BSA <p.dalgaard@kubism.ku.dk> writes:

> under the debugger and the test value was stuck at about 1.5e-32,
> being compared to acu=1e-23). This is probably a generic problem
                           ^^

Ugh. Make that thirty-two, please...

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Tue Apr 29 23:21:46 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 30 Apr 1997 00:21:46 +0200
Subject: R-alpha: frametools v.0.0000001
Message-ID: <x2wwplzczp.fsf@bush.kubism.ku.dk>

The following three functions are designed to make manipulation of
dataframes easier. I won't write detailed docs just now, but if you
follow the example below, you should get the general picture. Comments
are welcome, esp. re. naming conventions. 

Note that these functions are definitely not portable to S because
they rely on R's scoping rules. Not that difficult to fix, though: The
nm vector and the "parsing" functions need to get assigned to
(evaluation) frame 1 (the "expression frame" of S), and preferably
removed at exit.

data(airquality)
aq<-airquality[1:10,]
select.frame(aq,Ozone:Temp)
subset.frame(aq,Ozone>20)
modify.frame(aq,ratio=Ozone/Temp)

Notice that in modify.frame(), any *new* variable must appear as a
tag, not as the result of an assignment, i.e.:

modify.frame(aq,Ozone<-log(Ozone)) works as expected
modify.frame(aq,lOzone<-log(Ozone)) does not.

This is mainly because it was tricky to figure out what part of a left
hand side constitutes a new variable to be created (note that indexing
could be involved). So assignments to non-existing variables just
create them as local variables within the function. Making a virtue
out of necessity, that might actually be considered a feature...

----------------------------------------
"select.frame" <-
function (dfr, ...) 
{
        subst.call <- function(e) {
                if (length(e) > 1) 
                        for (i in 2:length(e)) e[[i]] <- subst.expr(e[[i]])
                e
        }
        subst.expr <- function(e) {
                if (is.call(e)) 
                        subst.call(e)
                else match.expr(e)
        }
        match.expr <- function(e) {
                n <- match(as.character(e), nm)
                if (is.na(n)) 
                        e
                else n
        }
        nm <- names(dfr)
        e <- substitute(c(...))
        dfr[, eval(subst.expr(e))]
}
"modify.frame" <-
function (dfr, ...) 
{
        nm <- names(dfr)
        e <- substitute(list(...))
        if (length(e) < 2) 
                return(dfr)
        subst.call <- function(e) {
                if (length(e) > 1) 
                        for (i in 2:length(e)) e[[i]] <- subst.expr(e[[i]])
                substitute(e)
        }
        subst.expr <- function(e) {
                if (is.call(e)) 
                        subst.call(e)
                else match.expr(e)
        }
        match.expr <- function(e) {
                if (is.na(n <- match(as.character(e), nm))) 
                        if (is.atomic(e)) 
                                e
                        else substitute(e)
                else substitute(dfr[, n])
        }
        tags <- names(as.list(e))
        for (i in 2:length(e)) {
                ee <- subst.expr(e[[i]])
                r <- eval(ee)
                if (!is.na(tags[i])) {
                        if (is.na(n <- match(as.character(tags[i]), 
                                nm))) {
                                n <- length(nm) + 1
                                dfr[[n]] <- numeric(nrow(dfr))
                                names(dfr)[n] <- tags[i]
                                nm <- names(dfr)
                        }
                        dfr[[tags[i]]][] <- r
                }
        }
        dfr
}
"subset.frame" <-
function (dfr, expr) 
{
        nm <- names(dfr)
        e <- substitute(expr)
        subst.call <- function(e) {
                if (length(e) > 1) 
                        for (i in 2:length(e)) e[[i]] <- subst.expr(e[[i]])
                e
        }
        subst.expr <- function(e) {
                if (is.call(e)) 
                        subst.call(e)
                else match.expr(e)
        }
        match.expr <- function(e) {
                if (is.na(n <- match(as.character(e), nm))) 
                        e
                else dfr[, n]
        }
        r <- eval(subst.expr(e))
        r <- r & !is.na(r)
        dfr[r, ]
}


-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Wed Apr 30 05:56:08 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Wed, 30 Apr 1997 16:56:08 +1200 (NZST)
Subject: R-alpha: New Incomplete Beta Function
Message-ID: <199704300456.QAA07452@stat1.stat.auckland.ac.nz>

Here is a drop-in replacement for the R incomplete beta function.

	src/math/pbeta.c

It is a slightly modified version of the cephes library one from
Netlib.  In the few cases I tried it seems to give at least 14
digit agreement with the one in S-PLUS (its hard to get more).

I'm not sure what performance is like.  I'd like to know if it
helps with some of the problems which have been reported for the
t and F code in R.

If it works It'll be in an official second patch for 0.49 later in
the week (so just swap it temporarily with the old one).

	Ross


- - s n i p - - h e r e - -

/*
 *    Incomplete Beta Integral
 *
 *    Taken from Cephes Math Library, Release 2.3:  March, 1995
 *    Copyright 1984, 1995 by Stephen L. Moshier
 *    Changes for R : Copyright 1997 by Ross Ihaka
 */

#include <math.h>
#include <float.h>
#include <errno.h>

static double incbcf(), incbd(), pseries();

static double big = 4.503599627370496e15;
static double biginv = 2.22044604925031308085e-16;


double pbeta(double xx, double aa, double bb)
{
	double a, b, t, x, xc, w, y;
	int flag;

	if (aa <= 0 || bb <= 0)
		goto domerr;

	if (xx <= 0 || xx >= 1) {
		if (xx == 0)
			return 0;
		if (xx == 1)
			return 1;
domerr:
		errno = EDOM;
		return 0;
	}
	flag = 0;
	if (bb * xx <= 1 && xx <= 0.95) {
		t = pseries(aa, bb, xx);
		goto done;
	}
	w = 1 - xx;

	/* Reverse a and b if x is greater than the mean. */

	if (xx > (aa / (aa + bb))) {
		flag = 1;
		a = bb;
		b = aa;
		xc = xx;
		x = w;
	} else {
		a = aa;
		b = bb;
		xc = w;
		x = xx;
	}

	if (flag == 1 && (b * x) <= 1 && x <= 0.95) {
		t = pseries(a, b, x);
		goto done;
	}

	/* Choose expansion for better convergence. */

	y = x * (a + b - 2) - (a - 1);
	if (y < 0)
		w = incbcf(a, b, x);
	else
		w = incbd(a, b, x) / xc;

	/* Multiply w by the factor
	     a      b   _             _     _
	    x  (1-x)   | (a+b) / ( a | (a) | (b) ) .   */

	y = a * log(x);
	t = b * log(xc);

	/* Resort to logarithms.  */

	y += t + lgamma(a + b) - lgamma(a) - lgamma(b);
	y += log(w / a);
	t = exp(y);

done:

	if (flag == 1) {
		if (t <= DBL_EPSILON)
			t = 1 - DBL_EPSILON;
		else
			t = 1 - t;
	}
	return t;
}


/* Continued fraction expansion #1
 * for incomplete beta integral
 */

static double incbcf(double a, double b, double x)
{
	double xk, pk, pkm1, pkm2, qk, qkm1, qkm2;
	double k1, k2, k3, k4, k5, k6, k7, k8;
	double r, t, ans, thresh;
	int n;

	k1 = a;
	k2 = a + b;
	k3 = a;
	k4 = a + 1;
	k5 = 1;
	k6 = b - 1;
	k7 = k4;
	k8 = a + 2;

	pkm2 = 0;
	qkm2 = 1;
	pkm1 = 1;
	qkm1 = 1;
	ans = 1;
	r = 1;
	n = 0;
	thresh = 3 * DBL_EPSILON;
	do {

		xk = -(x * k1 * k2) / (k3 * k4);
		pk = pkm1 + pkm2 * xk;
		qk = qkm1 + qkm2 * xk;
		pkm2 = pkm1;
		pkm1 = pk;
		qkm2 = qkm1;
		qkm1 = qk;

		xk = (x * k5 * k6) / (k7 * k8);
		pk = pkm1 + pkm2 * xk;
		qk = qkm1 + qkm2 * xk;
		pkm2 = pkm1;
		pkm1 = pk;
		qkm2 = qkm1;
		qkm1 = qk;

		if (qk != 0)
			r = pk / qk;
		if (r != 0) {
			t = fabs((ans - r) / r);
			ans = r;
		} else
			t = 1;

		if (t < thresh)
			goto cdone;

		k1 += 1;
		k2 += 1;
		k3 += 2;
		k4 += 2;
		k5 += 1;
		k6 -= 1;
		k7 += 2;
		k8 += 2;

		if ((fabs(qk) + fabs(pk)) > big) {
			pkm2 *= biginv;
			pkm1 *= biginv;
			qkm2 *= biginv;
			qkm1 *= biginv;
		}
		if ((fabs(qk) < biginv) || (fabs(pk) < biginv)) {
			pkm2 *= big;
			pkm1 *= big;
			qkm2 *= big;
			qkm1 *= big;
		}
	}
	while (++n < 300);

cdone:
	return ans;
}



/* Continued fraction expansion #2
 * for incomplete beta integral
 */

static double incbd(double a, double b, double x)
{
	double xk, pk, pkm1, pkm2, qk, qkm1, qkm2;
	double k1, k2, k3, k4, k5, k6, k7, k8;
	double r, t, ans, z, thresh;
	int n;

	k1 = a;
	k2 = b - 1;
	k3 = a;
	k4 = a + 1;
	k5 = 1;
	k6 = a + b;
	k7 = a + 1;
	k8 = a + 2;

	pkm2 = 0;
	qkm2 = 1;
	pkm1 = 1;
	qkm1 = 1;
	z = x / (1 - x);
	ans = 1;
	r = 1;
	n = 0;
	thresh = 3 * DBL_EPSILON;
	do {

		xk = -(z * k1 * k2) / (k3 * k4);
		pk = pkm1 + pkm2 * xk;
		qk = qkm1 + qkm2 * xk;
		pkm2 = pkm1;
		pkm1 = pk;
		qkm2 = qkm1;
		qkm1 = qk;

		xk = (z * k5 * k6) / (k7 * k8);
		pk = pkm1 + pkm2 * xk;
		qk = qkm1 + qkm2 * xk;
		pkm2 = pkm1;
		pkm1 = pk;
		qkm2 = qkm1;
		qkm1 = qk;

		if (qk != 0)
			r = pk / qk;
		if (r != 0) {
			t = fabs((ans - r) / r);
			ans = r;
		} else
			t = 1;

		if (t < thresh)
			goto cdone;

		k1 += 1;
		k2 -= 1;
		k3 += 2;
		k4 += 2;
		k5 += 1;
		k6 += 1;
		k7 += 2;
		k8 += 2;

		if ((fabs(qk) + fabs(pk)) > big) {
			pkm2 *= biginv;
			pkm1 *= biginv;
			qkm2 *= biginv;
			qkm1 *= biginv;
		}
		if ((fabs(qk) < biginv) || (fabs(pk) < biginv)) {
			pkm2 *= big;
			pkm1 *= big;
			qkm2 *= big;
			qkm1 *= big;
		}
	}
	while (++n < 300);
cdone:
	return ans;
}


/* Power series for incomplete beta integral.
   Use when b*x is small and x not too close to 1.  */

static double pseries(double a, double b, double x)
{
	double s, t, u, v, n, t1, z, ai;

	ai = 1 / a;
	u = (1 - b) * x;
	v = u / (a + 1);
	t1 = v;
	t = u;
	n = 2;
	s = 0;
	z = DBL_EPSILON * ai;
	while (fabs(v) > z) {
		u = (n - b) * x / n;
		t *= u;
		v = t / (a + n);
		s += v;
		n += 1;
	}
	s += t1;
	s += ai;

	u = a * log(x);
	t = lgamma(a + b) - lgamma(a) - lgamma(b) + u + log(s);
	s = exp(t);
	return s;
}
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Wed Apr 30 06:52:23 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 30 Apr 1997 07:52:23 +0200
Subject: R-alpha: New Incomplete Beta Function
In-Reply-To: <199704300456.QAA07452@stat1.stat.auckland.ac.nz>
References: <199704300456.QAA07452@stat1.stat.auckland.ac.nz>
Message-ID: <199704300552.HAA17098@aragorn.ci.tuwien.ac.at>

>>>>> Ross Ihaka writes:

> Here is a drop-in replacement for the R incomplete beta function.
> 	src/math/pbeta.c

> It is a slightly modified version of the cephes library one from
> Netlib.  In the few cases I tried it seems to give at least 14
> digit agreement with the one in S-PLUS (its hard to get more).

> I'm not sure what performance is like.  I'd like to know if it
> helps with some of the problems which have been reported for the
> t and F code in R.

Indeed, `qt(0.975, 3)' now also works on Debian Linux/GNU/ix86 when
compiled with `-O2 -g'.

Thanks!

(Of course, this is the only example I tried thus far ...)

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Wed Apr 30 10:40:54 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 30 Apr 1997 11:40:54 +0200
Subject: R-alpha: Re: R-beta: Re: S Compatibility
In-Reply-To: Ross Ihaka's message of Wed, 30 Apr 1997 14:27:07 +1200 (NZST)
References: <199704300227.OAA06297@stat1.stat.auckland.ac.nz>
Message-ID: <x2k9lk4zmh.fsf@bush.kubism.ku.dk>

Ross Ihaka <ihaka@stat.auckland.ac.nz> writes:

[on out-of-memory data]
> 
> Its something we definitely need (almost as much as REAL libraries).
> If only there were another 24 hours in each day ...

No problem. You just need someone as smart as you are to chip in with
the development. Or four people half as smart ;^)

There might also be some more "brutal" approaches, such as having the
vector heap as a memory-mapped file, leaving the cacheing and similar
work to the operating system. OS's are already quite good at handling
files with holes in them, so it's not like allocating a huge file just
for a handful af variables. Some special routines for defragmentation
might be necessary, though. Not that I really know what I'm talking
about...

At any rate, it would probably be a good thing to start thinking in
terms of modularity, database backends and such.

I've moved the thread to r-devel, it seemed to be getting too
technical for r-help.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Wed Apr 30 11:03:20 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 30 Apr 1997 12:03:20 +0200
Subject: R-alpha: New Incomplete Beta Function
In-Reply-To: Kurt Hornik's message of Wed, 30 Apr 1997 07:52:23 +0200
References: <199704300456.QAA07452@stat1.stat.auckland.ac.nz>
 <199704300552.HAA17098@aragorn.ci.tuwien.ac.at>
Message-ID: <x2iv144yl3.fsf@bush.kubism.ku.dk>

Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

> Indeed, `qt(0.975, 3)' now also works on Debian Linux/GNU/ix86 when
> compiled with `-O2 -g'.
> 
> Thanks!
> 
> (Of course, this is the only example I tried thus far ...)
> 

I suspect that the problem will just crop up again with a different
parameter combination. The original problem was really in qbeta.c, not
pbeta.c. Some of those routines are squeezing the last bit of accuracy
out by doing the computations in a carefully planned sequence. Along
comes the gcc optimizer and says "but it's faster to do it this way",
shuffles the instructions around and we get these problems with
termination criteria that are sometimes never met, depending on bit
patterns at the far end of intermediate results.

(The prototypical problem is that in computers, x + delta - x == 0 for
large x and small delta - unless the compiler decides to use
associativity commutativity and eliminate the x'es. Slightly more
elaborate version is x+delta-y with x and y already in registers and
being almost equal.)

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Wed Apr 30 11:04:24 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 30 Apr 97 12:04:24 +0200
Subject: R-alpha: New pbeta.c : Still problems for BIG 'df' (and an S-bug)
In-Reply-To: <199704300456.QAA07452@stat1.stat.auckland.ac.nz> (message from
 Ross Ihaka on Wed, 30 Apr 1997 16:56:08 +1200 (NZST))
Message-ID: <9704301004.AA01392@>

I've only made a few experiments using  qt(.)  with the new pbeta.c:

At least the problem of  "BIG df" --> 'long/infinite' CPU  remains even
though it has been pushed slightly

For 0.49 'plain', 
	qt(.99, 10^k) already takes quite some time for k=5, and 
			takes for ever for k=7
Try
	for(ee in 1:6) cat(10^ee,":", unix.time(qt(.99,df=10^ee))[1],"\n")

For the new  pbeta.c,  the problem appears about two exponents later.

 	qt(.99, df = 1e8)	## 'never' returns

The following code shows you a bit of what is going on.

BTW, S-plus seems to use a different approximation which remains fast even
when df = BIG.
However, S-plus results then become COMPLETELY RUBBISH!

Here are my few tests:

p <- c(.975, .995, .9995, 1 - 5e-6)
df1 <- c(1:5,10^c(1:8,10,15,10*(2:10)))
df0 <- df1[1:12] ## df0  works for  R 0.49 -patch2-

dig <- 8
for(df in df0)
  cat(formatC(df,w=6),":", formatC(unix.time(qq <- qt(p, df))[1],form='f'), "|",
      formatC(qq, form='f', dig=dig,wid=dig+6),"\n")
cat(" _Inf_ :  ---   |", formatC(qnorm(p), form='f', dig=dig,wid=dig+6),"\n")

## R 0.49  with  pbeta.c  of 30 April 1997:

   df  :  CPU[s]|     q  .975           .995         .9995       .999995=1-5e-6

     1 : 0.0100 |    12.70620474    63.65674116   636.61924876 63661.96977709
     2 : 0.0200 |     4.30265273     9.92484320    31.59905458   316.22539430
     3 : 0.0000 |     3.18244631     5.84090931    12.92397864    60.39682404
     4 : 0.0000 |     2.77644511     4.60409487     8.61030158    27.77164766
     5 : 0.0100 |     2.57058184     4.03214298     6.86882663    17.89686614
    10 : 0.0100 |     2.22813885     3.16927267     4.58689386     8.15028656
   100 : 0.0900 |     1.98397152     2.62589052     3.39049131     4.65424006
  1000 : 0.0300 |     1.96233908     2.58075470     3.30028265     4.43992647
 1e+04 : 0.0400 |     1.96020124     2.57632105     3.29149997     4.41943950
 1e+05 : 0.1300 |     1.95998771     2.57587847     3.29062403     4.41739993
 1e+06 : 0.2800 |     1.95996636     2.57583422     3.29053646     4.41719606
 1e+07 : 0.3800 |     1.95996422     2.57582979     3.29052770     4.41717568
 _Inf_ :  ---   |     1.95996398     2.57582930     3.29052672     4.41718074

## S-plus (3.4): From df ~= 1e4 (p=1-5e-6) results are COMPLETELY wrong !
## ----- You get quick results for even higher 'df' -- but they are wrong...

     1 : 0.0100 |    12.70620474    63.65674116   636.61924876 63661.96770658
     2 : 0.0000 |     4.30265273     9.92484320    31.59905458   316.22539430
     3 : 0.0000 |     3.18244631     5.84090931    12.92397864    60.39682404
     4 : 0.0100 |     2.77644511     4.60409487     8.61030158    27.77164766
     5 : 0.0000 |     2.57058184     4.03214298     6.86882663    17.89686614
    10 : 0.0000 |     2.22813885     3.16927267     4.58689386     8.15028656
   100 : 0.0100 |     1.98397152     2.62589052     3.39049131     4.65424006
  1000 : 0.0200 |     1.96233908     2.58075470     3.30028265     4.43992647
 1e+04 : 0.0200 |     1.96020124     2.57632105     3.29966223     4.70204286
 1e+05 : 0.0200 |     1.95998771     2.57587848     5.14482712    12.48628360
 1e+06 : 0.0100 |     1.95996636     2.57583569    14.70818229    38.67299101
 1e+07 : 0.0200 |     1.95996422     2.57600108    45.98857869   122.03496539
 _Inf_ :  ---   |     1.95996398     2.57582930     3.29052673     4.41717341

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Wed Apr 30 11:38:51 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 30 Apr 1997 12:38:51 +0200
Subject: R-alpha: write()
Message-ID: <199704301038.MAA18107@aragorn.ci.tuwien.ac.at>

Following my posting of a write.table() function, Martin suggested that
one could have a generic write() function and special methods for
e.g. time series, data frames, etc.

Well, a month has passed since ...

What does everyone think?  Is it a good idea, or would write.table() be
enough?  If we think that it is not enough, which arguments should the
write methods typically allow?  What about

	write.xxx (x,		# object
		   file =       # filename, default stdout
                   append =     # obvious
                   sep =	# obvious
		   eol =        # end of line char
                   ...)

???

On the other hand, it seems clear that something like write.table() is
nice, and what it should do.  But what about classes other than
data.frame?

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From luke@stat.umn.edu  Wed Apr 30 16:44:31 1997
From: luke@stat.umn.edu (Luke Tierney)
Date: Wed, 30 Apr 1997 10:44:31 -0500 (CDT)
Subject: R-alpha: Re: S Compatibility
Message-ID: <9704301544.AA10475@nokomis.stat.umn.edu>

On the memory/database/persistent storage issue,the Texas persistent
store, for which Rscheme has an interface, some of the stuff on object
serialization in Java (Java beans variant of OpenDoc's
Bento/quilt/whatever) and (gulp) OLE structured storage might be worth
a look in this context also.
 
luke


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Wed Apr 30 16:55:23 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 30 Apr 97 17:55:23 +0200
Subject: R-alpha: write()
In-Reply-To: <199704301038.MAA18107@aragorn.ci.tuwien.ac.at> (message from
 Kurt Hornik on Wed, 30 Apr 1997 12:38:51 +0200)
Message-ID: <9704301555.AA01443@>

Note that S has a  write(.)  function  which would be our
	write.default(.)

your	write.table	    would be our 
	write.data.frame

The only addition would be a  'write.matrix' which would be 'like'
write.data.frame, the only problem being that  'matrix' is not a class (yet).
	[Note that in S4, everything has a class; 
	   I'm voting for matrices to have a class in R  ..]
write.default  could 'despatch' to write.matrix if  x  is a matrix.
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Wed Apr 30 17:42:52 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Wed, 30 Apr 1997 09:42:52 -0700 (PDT)
Subject: R-alpha: ==NULL
In-Reply-To: <199704301038.MAA18107@aragorn.ci.tuwien.ac.at>
Message-ID: <Pine.SUN.3.95.970430093849.302A-100000@zen>


Any comparison with NULL generates an error
Error: comparison is possible only for vector types
whereas in S(-PLUS) it gives NA, which seems more sensible.

Along similar lines, comparison with a length 0 vector returns logical(0)
in R but NA in S. 

Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From la-jassine@aix.pacwan.net  Wed Apr 30 11:25:51 1997
From: la-jassine@aix.pacwan.net (Paul Gilbert)
Date: Wed, 30 Apr 1997 07:25:51 -0300
Subject: R-alpha: small complex problems
Message-ID: <1349681347-914582@aix.pacwan.net>

Mod, Re, Im, and Conj should work for Real numbers using as.complex

complex should be
   complex <- function (n = 0, real = numeric(), imaginary = numeric())
not 
   complex <- function (n = 0, real = numeric(), imag = numeric()) 


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From la-jassine@aix.pacwan.net  Wed Apr 30 11:25:59 1997
From: la-jassine@aix.pacwan.net (Paul Gilbert)
Date: Wed, 30 Apr 1997 07:25:59 -0300
Subject: R-alpha: false warnings
Message-ID: <1349681339-915060@aix.pacwan.net>

In R 0.49 comparison of logic matrices with & and | seems to sometimes
generate false warning messages about longer object length is not a multiple
of shorter object length. I have not been able to isolate the exact
circumstances.

Paul Gilbert

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From la-jassine@aix.pacwan.net  Wed Apr 30 11:25:53 1997
From: la-jassine@aix.pacwan.net (Paul Gilbert)
Date: Wed, 30 Apr 1997 07:25:53 -0300
Subject: R-alpha: generic print
Message-ID: <1349681345-914696@aix.pacwan.net>

I have  always thought that typing the name of an object generated a call to
the print method for the object, however,  (in 0.49) I redefined the generic
print method as 

print <- function(x, ...)
 {if (is.tframe(x))  UseMethod("print.tframe")
  else UseMethod("print")
 }

Now I have an object z which returns TRUE to is.tframe(z) and
> class(z)
[1] "ts"     "tframe"

Then

> print(z)
[1] 1981.50 2006.25    4.00

But
> z
Error: comparison is possible only for vector types

> traceback()
[1] "c(\"print.ts(structure(c(1981.5, 2006.25, 4), class = c(\\\"ts\\\",
\\\"tframe\\\"\", "
[2] "c(\"print(structure(c(1981.5, 2006.25, 4), class = c(\\\"ts\\\",
\\\"tframe\\\"\", "   

This is generating a call to the class method print.ts rather than to
print.tframe.ts as is done when I use print(z).  If my understanding that
typing the name of an object should generate a call to the print method for
the object then this is a bug. Otherwise, could someone please explain to me
what it does. Thanks.

Paul Gilbert

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Wed Apr 30 22:01:33 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Thu, 1 May 1997 09:01:33 +1200 (NZST)
Subject: R-alpha: Re: R-beta: Re: S Compatibility
Message-ID: <199704302101.JAA10310@stat1.stat.auckland.ac.nz>

Peter Dalgaard writes:

> > Its something we definitely need (almost as much as REAL libraries).
> > If only there were another 24 hours in each day ...

> No problem. You just need someone as smart as you are to chip in with
> the development. Or four people half as smart ;^)

Or half the time of someone twice as smart ...
Did I see you putting your hand up? :-)

> There might also be some more "brutal" approaches, such as having the
> vector heap as a memory-mapped file, leaving the cacheing and similar
> work to the operating system. OS's are already quite good at handling
> files with holes in them, so it's not like allocating a huge file just
> for a handful af variables. Some special routines for defragmentation
> might be necessary, though. Not that I really know what I'm talking
> about...

I recall that the reason we got into this is first place was watching
S thrashing our disks to bits while the cpus stood idle ...
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Apr  1 09:28:56 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 1 Apr 97 10:28:56 +0200
Subject: R-alpha: Re: R-Prerelease  ---- Mailing list  "R-devel"
In-Reply-To: <9704010826.AA00322@> (message from Martin Maechler on Tue, 1 Apr
 97 10:26:38 +0200)
Message-ID: <9704010828.AA00328@>

well yes,  I've only sent mail to R-devel,...

When I started, I thought I would first let you give feedback on it,..
I can still change some of the names if any of you thinks it's necessary

	(and yes, no  "April's fool" included...)

Martin 
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Tue Apr  1 09:35:43 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 1 Apr 1997 10:35:43 +0200
Subject: R-alpha: Re: R-Prerelease  ---- Mailing list  "R-devel"
In-Reply-To: <9704010828.AA00328@>
References: <9704010826.AA00322@>
 <9704010828.AA00328@>
Message-ID: <199704010835.KAA30138@aragorn.ci.tuwien.ac.at>

>>>>> Martin Maechler writes:

> well yes,  I've only sent mail to R-devel,...
> When I started, I thought I would first let you give feedback on it,..
> I can still change some of the names if any of you thinks it's necessary

> 	(and yes, no  "April's fool" included...)

:-)

Martin:

Very good idea.  (In fact, I was thinking of proposing something similar
in a few days ...).  Of course, it means that I now have to rewrite the
FAQ more or less completely (0.50, CRAN, new mailing lists, ...).

Could you change my entry to
	Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at>
???

-k

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Thu Apr  3 08:50:54 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Thu, 3 Apr 97 09:50:54 +0200
Subject: R-alpha: Re: Pretest Version + Notes --- write.table
In-Reply-To: <199704021013.MAA09534@aragorn.ci.tuwien.ac.at> (message from
 Kurt Hornik on Wed, 2 Apr 1997 12:13:25 +0200)
Message-ID: <9704030750.AA03413@>


Kurt writes

KH>> * I am also not sure whether one should include the write.table()
KH>> function I posted some time ago.  It seems to be a bad idea to make a
KH>> contrib package out of it (containing only a single function ...).

Yes, I think we should have a good  "write" function for  data.frames.
However, I would go even further and 'vote' for a GENERIC function  'write'
which has methods for
	default	  (including 'matrix'  as long as 'matrix' is not a class)
	data.frame
	....	['ts', ...]

The following is code that I've been using in S-plus for a while and have
adapted to R:
--- Note that it uses something  more primitive than Kurt's write.table.
    The issue really was to be able to "write a data.frame or matrix" such that
    read.table would reproduce it.


write <- function(x, file = "data", ...) UseMethod("write")

write.default <- function (x, file = "data",
			   ncolumns = if (is.character(x)) 1 else 5,
			   append = FALSE, ...)
{
  if(is.matrix(x))
    write.matrix(x, file=file, append= FALSE, ...)
  else
    write0.basic(x, file = file, ncolumns= ncolumns, append = append)
}

write0.basic <- function (x, file, ncolumns, append = FALSE)
  cat(x, file = file, sep = c(rep(" ", ncolumns - 1), "\n"), append = append)

write.data.frame <- function(x, file = "data", rownames = TRUE)
{
  ## Purpose: Method to 'write(.)' such as to read back using  read.table(.)
  ## -------------------------------------------------------------------------
  ## Arguments:       x : data frame;			file : file name
  ##            rownames: if T, also write row names
  ## -------------------------------------------------------------------------
  ## Author: Martin Maechler <maechler@stat.math.ethz.ch>,  1992
  ## -------------------------------------------------------------------------
  ##-- NOT for "parametrized" data.frames; just ``simple'' matrix look-a-likes
  ##-- NOTE: read.table(file) may still give different data.frame --
  ##-- ~~~~  	        (namely,e.g., when some names contained padding blanks)
  ##-- 	    But the "new" names may actually be better .. (!) ..
  ## EXAMPLE:
  ##   data(women); write(women, file= "women.dat")
  ##   wm <- read.table("women.dat")) 
  ##   all.equal(wm, women) ##> TRUE
  if(!is.data.frame(x)) { #-- can only happen when called explicitely
    warning("'x' is not a data.frame; coercing it to one ...")
    x <- data.frame(x)
  }
  cat( names(x), "\n", file = file, append = FALSE)
  write0.basic(unclass(t(cbind(if(rownames)row.names(x), as.matrix(x)))),
	       ncolumns = rownames + ncol(x), file= file, append= TRUE)
}

write.matrix     <- function(x, file = "data", rownames = TRUE)
  write(data.frame(as.matrix(x)), file=file, rownames=rownames)

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Thu Apr  3 13:45:55 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Thu, 3 Apr 97 14:45:55 +0200
Subject: R-alpha: R0.50-pre6:  "stack imbalance in ..." //  is.vector(matrix...)
Message-ID: <9704031245.AA03766@>

[[[ To the new subscribers of the  R-devel  mailing list:
    The latest  prerelease of R 0.50 has not been
    announced to this mailing list, by accident.

  In short, get		R6.tgz  and  R6-update.shar.gz,

  from	ftp://stat.auckland.ac.nz/pub/ihaka/

  and first unpack  the tar file, then the shar file in the same
  directory..
]]]

and to ALL  "R-devel"oppers:
	
	Yes, please use this mailing list to report
	bugs / fixes / annotations / suggestions ...	

-- Martin [after ``e-talking'' to Ross]
------------------------------------------------------------------------

Quite strange error / warning messages that I am getting here:

   > prompt(prompt)
   stack imbalance in internal as.vector, 22 then 21
   stack imbalance in .Internal, 21 then 20
   stack imbalance in <-, 16 then 15
   created file named  prompt.man  in the current directory.
     Edit the file and move it to the appropriate directory,
    /soft/sunos5_1/R-prealpha-0.50-6/src/manual/man/ dropping the ending '.man'
   stack imbalance in {, 14 then 13

The first three messages are created by "as.character" on a 'symbol'
object:

   > (function(x) as.character(substitute(x)))(abc)
   stack imbalance in internal as.vector, 9 then 8
   stack imbalance in .Internal, 8 then 7
   Error: stack imbalance in "unprotect"

-------
The 2nd remark is both a bug and a feature report:

Good news:  One long standing  S(-plus) bug  has been fixed in R:

	is.vector( __named_vector__ )   finally gives TRUE

Bad  news:  is.vector( __matrix__ )  now also is TRUE which is not wanted IMHO.

> is.vector(structure(1:9, names=letters[1:9]))
[1] TRUE
> is.vector(cbind(1,1:3))
[1] TRUE
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Sun Apr  6 10:56:59 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Sun, 6 Apr 1997 21:56:59 +1200 (NZST)
Subject: R-alpha: Some name changes
Message-ID: <199704060956.VAA07988@stat1.stat.auckland.ac.nz>

I would like to raise the possibility of some function name
changes.  For compatibility with S it might be good to change

	"dotplot" to "dotchart"
	"piechart" to "pie"

(are there any others?).  Is either of these a good idea?
(I would actualy like to change "piechart" to something
like

	piechart.use.this.function.and.you.will.catch.ebola

to discourage people from using it, but perhaps sneaking
a segmentation violation into the code will do the trick :-)

We could also replace "save.plot" and " print.plot" by a
single function

	hardcopy(file, printcmd="lpr")

which would work as follows:  If "file" is specified, the
onscreen plot is saved as encapsulated postscript (or whatever
the platform standard is), otherwise the postscript is piped
to the command specified by printcmd.  This would replace
two commands with one.

Even when multiple active devices happen (soonish???),
I think that having a command like this would probably be
useful.
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Sun Apr  6 21:58:11 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Mon, 7 Apr 1997 08:58:11 +1200 (NZST)
Subject: R-alpha: What should is.vector do?
Message-ID: <199704062058.IAA09618@stat1.stat.auckland.ac.nz>

[ Consumer warning: This is a little technical ... ]

I have been pondering the question

		What should is.vector do?

Martin has raised this a number of times.  I ran a few tests 
in S and got the following results.

	S> is.vector(list(1,2,3))
	[1] T
	S> is.vector(expression(a+b))
	[1] T
	S> is.vector(as.name("x"))
	[1] T  
	S> is.vector(NULL)
	[1] T
	S> x <- 1:5
	S> is.vector(x)
	[1] T
	S> names(x) <- letters[1:5] 
	S> is.vector(x)
	[1] F

Essentially, everything in S is a vector unless it has attributes.
This is utterly unreasonable!  Why should something stop being a
vector because it has a names attribute attached.
	
Internally in R, we have a predicate isVector() which returns
true if its argument has one of the storage modes "logical",
"factor", "ordered", "integer", "real", "complex" and "character".
This is useful because these are the types which can be subscripted 
(without using CAR and CDR).  We almost certainly need an external
version of this predicate.  I suppose that it could be called	 
is.vector.mode(x).

Another reasonable definition of "vector" is !is.array(x).
or possibly "isVector(x) == 1 && !is.array(x)

What complicates things is that there is a second argument
which specifies a mode for the vector.  In S, it is possible to
have calls like

	is.vector(x, "list")
	is.vector(x, "language")

We have gone some way down the road to mimicing this behaviour,
but it really doesn't fit naturally into the R model.

Looking at our own code base, I see that "is.vector" is used only
in the "data.entry" functions, (and I think I need to check that
code carefully).  We seem to use the predicates

	is.list(x)
	is.language(x)

etc in preference to the above.

Anyway, can we communally come to (reasonably) firm conclusion about
what is.vector should do?  I'm prepared to implement almost anything,
but I'm rather confused about exactly what is.vector should do.
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Mon Apr  7 08:33:51 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Mon, 7 Apr 97 09:33:51 +0200
Subject: R-alpha: What should is.vector do?
In-Reply-To: <199704062058.IAA09618@stat1.stat.auckland.ac.nz> (message from
 Ross Ihaka on Mon, 7 Apr 1997 08:58:11 +1200 (NZST))
Message-ID: <9704070733.AA00396@>


Ross>> Internally in R, we have a predicate isVector() which returns
Ross>> true if its argument has one of the storage modes "logical",
Ross>> "factor", "ordered", "integer", "real", "complex" and "character".
Ross>> This is useful because these are the types which can be subscripted 
Ross>> (without using CAR and CDR).  We almost certainly need an external
Ross>> version of this predicate.  I suppose that it could be called	 
Ross>> is.vector.mode(x).

Yes, "export"  isVector  as  'is.vector.mode'!

Ross>> Another reasonable definition of "vector" is !is.array(x).
Ross>> or possibly "isVector(x) == 1 && !is.array(x)
Yes, I think
		isVector(x) == 1 && !is.array(x)

is the way to go, at least for   mode = 'any'

Now, for the 2nd argument  mode = '...' :
I think it should always be more restrictive, i.e.,
	  is.vector(OB, mode= MODE)   <-->   is.vector(OB) &&  MODE.test(OB)

which is not the case currently [[correcting a typo in $RHOME/TASKS l.449-451]

 is.vector(call("ls"))			#[1] FALSE
 is.vector(call("ls"), mode='language')	#[1] TRUE
 is.vector(call("ls"), mode='call')	#[1] FALSE

[[here, is.vector(call("ls"), mode='any')  should really return TRUE]]
  
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Apr  8 09:43:55 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 8 Apr 97 10:43:55 +0200
Subject: R-alpha: Seg.faults with complex: factor(..), unique(..).  Missing feature ``sort( complex(..) )''
Message-ID: <9704080843.AA01399@>

1) Several functions still (0.50 - pre6)
   give seg.faults when called with complex:

unique( 1i)  --> segfault
In 'factor', levels are defaulted to  'sort(unique(x))'
which seg.faults  factor( 1i).

Because of 'factor', table(..complex..)  seg.faults,.....


2)  sort ( complex )   [[Of course this is minor ..]]

You may not believe this can be useful, but...
I've been digging in old S-code  which makes use of this (and also of unique(.))

Be  
	z = x + 1i*y;   x,y real vectors
Then,  
	order(z)   : <-->  order(x,y)

This is how it is defined in S (but it is implemented via .Internal(..)).

One could add the following line to the definition of 'sort'

	if(is.complex(x)) return( x[order(Re(x),Im(x))] )

which has the drawback of NOT using the 'partial' and  'na.last' arguments.
((This actually makes me think that
  maybe  'order' should also accept these two)).
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Tue Apr  8 17:47:59 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Tue, 8 Apr 1997 09:47:59 -0700 (PDT)
Subject: R-alpha: rbind
In-Reply-To: <9704010823.AA00318@>
Message-ID: <Pine.SUN.3.91.970408094156.9023A-100000@chekov>

rbind() does something strange to dimnames

R : Copyright 1997, Robert Gentleman and Ross Ihaka
Version 0.50 Beta (April 1, 1997)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type "license()" for details.

> test1 <- data.frame(time=  c(4, 3,1,1,2,2,3),
   +     status=c(1,NA,1,0,1,1,0),
  +     x=     c(0, 2,1,1,1,0,0))
> temp<-as.matrix(test1)
> dimnames(temp)
[[1]]
NULL

[[2]]
[1] "time"   "status" "x"     

> temp<-rbind(temp,temp)
Error: invalid type for dimnames: must be a list
> dimnames(temp)
[[1]]
NULL
Segmentation fault (core dumped)

Part of the problem is that as.matrix() doesn't set dimnames()[[1]]. If I 
set this by hand everything works. Even so, the rbind function should 
succeed or fail -- it shouldn't mutilate its arguments like this.


Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Tue Apr  8 18:04:19 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Tue, 8 Apr 1997 10:04:19 -0700 (PDT)
Subject: R-alpha: as.numeric
In-Reply-To: <Pine.SUN.3.91.970408094156.9023A-100000@chekov>
Message-ID: <Pine.SUN.3.91.970408100342.9023B-100000@chekov>


as.numeric() turns a logical matrix into a numeric vector. Shouldn't it 
stay a matrix?


Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Tue Apr  8 18:27:48 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 08 Apr 1997 19:27:48 +0200
Subject: R-alpha: User friendly functions
Message-ID: <x2k9md77cb.fsf@bush.kubism.ku.dk>

A loose idea for *post*-0.50 development

I've been giving a some (but not all that many) thoughts to whether
some of the conceptual difficulties facing newcomers could be avoided
by having simplified functions for common operations. We already have
parts of this, e.g. in Kurts ctest routines. Specifically, I was
thinking about data frames: How about

dfr.sel<-select.frame(dfr,age,sex,pain1:pain5)

with the : specifying a range, instead of 

dfr.sel<-dfr[,c(1,2,5,6,7,8,9)] 

or 

attach(dfr)
dfr.sel<-data.frame(age,sex,pain1,pain2,pain3,pain4,pain5) 
detach(dfr)

(which isn't even safe if there are variables of the same name in the
global environment)

similarly, how about

dfr.sub<-subset.frame(dfr,sex==1 && age > 30)

rather than

dfr.sub<-dfr[dfr$sex==1 && dfr$age > 30,]

Both would seem to be quite possible to implement, although they do
need to do some sneaky bits of computing-on-the-language internally.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Tue Apr  8 19:03:38 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 8 Apr 1997 20:03:38 +0200
Subject: R-alpha: CRAN source/contrib
Message-ID: <199704081803.UAA13616@aragorn.ci.tuwien.ac.at>

Oops, forgot to attach the INDEX file:

CRAN/source/contrib currently contains:

acepack.tar.gz:
	ace (Alternating Conditional Expectations) and avas (Additivity
	and variance stabilization for regression) for selecting
	regression transformations.

	avas S original by Rob Tibshirani <tibs@utstat.toronto.edu>.
	R port by Thomas Lumley <thomas@biostat.washington.edu>.
	[1997/04/08]
	
bootstrap.tar.gz:
	Software (bootstrap, cross-validation, jackknife), data and
	errata for the book "An Introduction to the Bootstrap" by B.
	Efron and R.  Tibshirani, 1993, Chapman and Hall.

	S original by Rob Tibshirani <tibs@utstat.toronto.edu>.
	R port by Fritz Leisch <Friedrich.Leisch@ci.tuwien.ac.at>.
	[1997/04/08]

ctest.tar.gz:
	A library of classical tests, including the Bartlett, Fisher,
	Kruskal-Wallis, Kolmogorov-Smirnov, and Wilcoxon tests.
	
	Written by Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at>.
	[1997/04/08]

date.tar.gz:
	Functions for dealing with dates.  The most useful of them
	accepts a vector of input dates in any of the forms 8/30/53,
	30Aug53, 30 August 1953,..., August 30 53, or any mixture of
	these.

	S original by Terry Therneau <therneau@mayo.edu>.
	R port by Thomas Lumley <thomas@biostat.washington.edu>.
	[1997/04/08]

e1071.tar.gz:
	Miscellaneous functions used at the Department of Statistics at
	TU Wien (E1071).

	Compiled by Fritz Leisch <Friedrich.Leisch@ci.tuwien.ac.at>.
	[1997/04/08]	

fracdiff.tar.gz:
	Maximum likelihood estimation of the parameters of a
	fractionally differenced ARIMA(p,d,q) model (Haslett and
	Raftery, Applied Statistics, 1989).

	S original by Chris Fraley <fraley@stat.washington.edu>.
	R port by Fritz Leisch <Friedrich.Leisch@ci.tuwien.ac.at>.
	[1997/04/08]

gee.tar.gz:
	An implementation of the Liang/Zeger generalized estimating
	equation approach to GLMs for dependent data.

	S original by Vincent Carey <carey@biostat.harvard.edu> and
	Aidan McDermott.
	R port by Thomas Lumley <thomas@biostat.washington.edu>.
	[1997/04/08]

jpn.tar.gz:
	A function to plot Japan's coast-line and prefecture
	boundaries.

	S original by Ritei Shibata <shibata@statlab.math.keio.ac.jp>.
	R port by Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at>.
	[1997/04/08]	

snns.tar.gz:
	An R interface to the Stuttgart Neural Networks Simulator
	(SNNS).

	Written by Fritz Leisch <Friedrich.Leisch@ci.tuwien.ac.at>.
	[1997/04/08]

splines.tar.gz:
	Regression spline functions.

	S original by Doug Bates <bates@stat.wisc.edu>.
	R port by Thomas Lumley <thomas@biostat.washington.edu>.
	[1997/04/08]

survival4.tar.gz:
	Functions for survival analysis.  This ``port'' is not complete
	yet, because it requires a few changes to the R system itself
	rather than the add-on package, but most of the functionality is
	already available.

	Requires splines.

	S original by Terry Therneau <therneau@mayo.edu>.
	R port by Thomas Lumley <thomas@biostat.washington.edu>.
	[1997/04/08]
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Tue Apr  8 18:49:33 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 8 Apr 1997 19:49:33 +0200
Subject: R-alpha: CRAN source/contrib
Message-ID: <199704081749.TAA13566@aragorn.ci.tuwien.ac.at>

I've put all ``current'' add-on packages into CRAN's source/contrib tree
and created an INDEX file (attached below).  As you can see, currently
we have

  acepack
  bootstrap
  ctest
  date
  e1071
  fracdiff
  gee
  jpn
  snns
  splines
  survival4

(Yes, e1071 and jpn are new ... more on the latter in a later mail.)

In the near future, I am hoping for the following:

  oz		(Bill Venables said should work without problems ...)
  polynom	(Has been used as a test bed for the new group methods
		 in R 0.50, so should only be a matter of packaging.
	         Or were there some changes?)
  wavethresh	(According to A. Kovac, worked under 0.12.  Thought I'd
                 ask the guy for an official port.)
  time.series	(Paul Gilbert promised an official release following the
		 release of R 0.50)

Fritz (and I) have also started to port the `clus' software which was
recently documented in an article in Journal of Statistical Software.

Also, Doug's nonlin seems to compute fine after one change, but the
output needs help.  Is this still useful, or do we have something better
for fitting nonlinear models?

As you can see from the list, we're not doing too bad ...

-k

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Tue Apr  8 19:03:01 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 8 Apr 1997 20:03:01 +0200
Subject: R-alpha: jpn() port
Message-ID: <199704081803.UAA13610@aragorn.ci.tuwien.ac.at>

I've just completing porting the S jpn package to R (available in CRAN's
source/contrib).

Some remarks:

* It seems that S allows recycling when subscripting with logicals, but
R does not.  E.g.,

R> x <- 1:5
R> x
[1] 1 2 3 4 5
R> i <- c(F, T)
R> x[i]
Error: invalid subscript type
R>

In S, this is treated as x[rep(i, length = length(x))].

* It also seems that S does not worry about excluding subscripts which
are out of bounds.  In the above, x[-6] would give x, but in R

R> x[-6]
Error: subscript out of bounds

Just wanted to point that out ...

The jpn package contains VARIABLES (``data'') as well as functions, and
I guess it is the first one to do so.  Because we don't have `data'
grouped similar to `help' yet, the data are now directly in the R
`source'.

A problem occurs when documenting such data sets ... is there a nice way
of saying that something is a list with components
	a ....
	b ...
	c ...
using the R doc format?

Finally, here's something that's also been on my mind for some time now
(and also needed help in the port).  Code like

	if(all(names(x)) == c("x", "y"))

fails if names(x) is NULL.  Is that really necessary?  (More precisely,
obviously we only want to test whether the two objects have equal
values, a la Lisp `equal').

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Tue Apr  8 23:16:43 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 09 Apr 1997 00:16:43 +0200
Subject: R-alpha: as.numeric
In-Reply-To: Thomas Lumley's message of Tue, 8 Apr 1997 10:04:19 -0700 (PDT)
References: <Pine.SUN.3.91.970408100342.9023B-100000@chekov>
Message-ID: <x2iv1xtb1w.fsf@bush.kubism.ku.dk>

Thomas Lumley <thomas@biostat.washington.edu> writes:

> as.numeric() turns a logical matrix into a numeric vector. Shouldn't it 
> stay a matrix?

It *sounds* wrong, but:

S-PLUS : Copyright (c) 1988, 1996 MathSoft, Inc.
S : Copyright AT&T.
Version 3.4 Release 1 for Sun SPARC, SunOS 5.3 : 1996 
Working data will be in .Data 
> cbind(c(T,T),c(F,F))
     [,1] [,2] 
[1,]    T    F
[2,]    T    F
> as.numeric(.Last.value)
[1] 1 1 0 0

In fact, it does the same with numeric matrices.

To convert logical matrix to character matrix in Splus, you could
either add zero or use mode(x)<-"numeric", same thing in R.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Tue Apr  8 23:26:43 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 09 Apr 1997 00:26:43 +0200
Subject: R-alpha: jpn() port
In-Reply-To: Kurt Hornik's message of Tue, 8 Apr 1997 20:03:01 +0200
References: <199704081803.UAA13610@aragorn.ci.tuwien.ac.at>
Message-ID: <x2hghhtal8.fsf@bush.kubism.ku.dk>

Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

> Finally, here's something that's also been on my mind for some time now
> (and also needed help in the port).  Code like
> 
> 	if(all(names(x)) == c("x", "y"))
> 
> fails if names(x) is NULL.  Is that really necessary?  (More precisely,
> obviously we only want to test whether the two objects have equal
> values, a la Lisp `equal').

According to my parenthesis count, that expression will fail in any
case! However, I get your drift. Splus has
> all(NULL)
[1] T
> any(NULL)
[1] F

Which makes sense for cases like yours. R should probably conform to
this. 

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Wed Apr  9 07:34:29 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 9 Apr 97 08:34:29 +0200
Subject: R-alpha: as.numeric
In-Reply-To: <Pine.SUN.3.91.970408100342.9023B-100000@chekov> (message from
 Thomas Lumley on Tue, 8 Apr 1997 10:04:19 -0700 (PDT))
Message-ID: <9704090634.AA01856@>


>>>>> "Thomas" == Thomas Lumley <thomas@biostat.washington.edu> writes:

    Thomas> as.numeric() turns a logical matrix into a numeric
    Thomas> vector. Shouldn't it stay a matrix?

One first would think so.
However, R here behaves as S.

>From ?as.numeric of S-plus 3.4:
S> VALUE:
S>        ....
S> 
S>        as.numeric returns a vector like x, but with storage  mode
S>        "double",  if  x  is  a  simple  object of mode "numeric".
S>        Otherwise, as.numeric returns a numeric object of the same
S>        length  as  x  and  with  data resulting from coercing the
S>        elements of x to mode "numeric".

The following shows the old (in S) quite usual ``workaround''.
The following code works `identically' in R and S :

> Mas.numeric <- function(x){ mode(x) <- "numeric"; x}
> M <- cbind("1",1:3); M
     [,1] [,2]
[1,] "1"  "1" 
[2,] "1"  "2" 
[3,] "1"  "3" 
> as.numeric(M)
[1] 1 1 1 1 2 3
> Mas.numeric(M)
     [,1] [,2]
[1,]    1    1
[2,]    1    2
[3,]    1    3
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Wed Apr  9 10:17:37 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 9 Apr 97 11:17:37 +0200
Subject: R-alpha: R <-> S compatibility; more demos -- using  S-plus validate(..) ..
Message-ID: <9704090917.AA01943@>

Look at the result of
(in S-plus:)
	validate(verbose=TRUE, outfile="......./validate-3.4.out")

which gives (for me, S-plus 3.4 on Solaris 2.5) 
2106 Lines of output.
It's full of tests using "standard data sets".  (-->  'demos' available!)

Basically, at the end of each example, there are  statements which
should return  TRUE  if the 'validation test' is passed, e.g.,
	all(c(b.test$statistic == 1, abs(b.test$p.value - 0.1562) < tol, 
	      b.test$alternative == "two.sided"))

One bigger job would be to run these through R and analyze the
results... -- any volunteers ?
	
	((I could even send you the file if don't have S-plus
	  available...))

-- Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Apr 11 08:18:42 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 11 Apr 97 09:18:42 +0200
Subject: R-alpha: R-lists archives: "timeout" since April 1 -- have you saved all?
Message-ID: <9704110718.AA02705@>

For a silly file permission reason,
the automatical archiving of the three mailing lists hasn't been working
from April 1 till April 10.

If any of you has a "complete" archive of this time-period;
I'd be glad to fix the archives.
((I have an own  ``close to complete'' archive)).

-- Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-


From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Apr 11 08:18:42 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 11 Apr 97 09:18:42 +0200
Subject: R-alpha: R-lists archives: "timeout" since April 1 -- have you saved all?
Message-ID: <9704110718.AA02705@>

For a silly file permission reason,
the automatical archiving of the three mailing lists hasn't been working
from April 1 till April 10.

If any of you has a "complete" archive of this time-period;
I'd be glad to fix the archives.
((I have an own  ``close to complete'' archive)).

-- Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Apr 14 09:04:34 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 14 Apr 1997 10:04:34 +0200
Subject: R-alpha: jpn() port
In-Reply-To: <x2hghhtal8.fsf@bush.kubism.ku.dk>
References: <199704081803.UAA13610@aragorn.ci.tuwien.ac.at>
 <x2hghhtal8.fsf@bush.kubism.ku.dk>

>>>>> Peter Dalgaard BSA writes:

> Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:
>> Finally, here's something that's also been on my mind for some time now
>> (and also needed help in the port).  Code like
>> 
>> if(all(names(x)) == c("x", "y"))
>> 
>> fails if names(x) is NULL.  Is that really necessary?  (More precisely,
>> obviously we only want to test whether the two objects have equal
>> values, a la Lisp `equal').

> According to my parenthesis count, that expression will fail in any
> case!

Yes ... I meant

	if(all(names(x) == c("x", "y")))

> However, I get your drift. Splus has
>> all(NULL)
> [1] T
>> any(NULL)
> [1] F

> Which makes sense for cases like yours. R should probably conform to
> this.

Actually, I am not sure about that, but it does not solve the problem.
If you look at the code in the S jpn package, it contains

	if(all(names(region) == c("x", "y")))

If region has no names attribute,

	all(names(region) == c("x", "y"))

gives NA and if(NA) (correctly) gives ``Error: Missing value where
logical needed''.  The problem is that NULL == something gives NA.
(Should it really do that?)

But perhaps it is better anyway to force the programmer to check for
NULL values before comparisons ...

-k

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-


From Martin Maechler <maechler@stat.math.ethz.ch>  Mon Apr 14 09:25:09 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Mon, 14 Apr 97 10:25:09 +0200
Subject: R-alpha: Re: Mailing list archives -- ok -- thank you
Message-ID: <9704140825.AA00396@>

Thanks to Peter Dalgaard   
who was the first one to offer me help
I've about everything I need for the archives of the 3 mailing lists.

Thank you all	-- Martin.

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Apr 14 14:00:31 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 14 Apr 1997 15:00:31 +0200
Subject: R-alpha: problems qith require/provide
Message-ID: <199704141300.PAA00699@aragorn.ci.tuwien.ac.at>

If I call require() with the most current snapshot and patches, I get

	Error: Object ".Provided" not found

The problem is with

	if (is.na(match(name, .Libraries)) &&
            is.na(match(name, .Provided))) {

which fails if .Provided does not exist yet.  Perhaps it should be
defined in Rprofile, similar to .Libraries?

Also, is the 

  if (!exists(".Libraries", inherits = TRUE)) {
    assign(".Libraries", character(0), NULL)
  }

really needed then?

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Apr 14 14:03:39 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 14 Apr 1997 15:03:39 +0200
Subject: R-alpha: problem with survival4 and ":="
Message-ID: <199704141303.PAA00724@aragorn.ci.tuwien.ac.at>

Has ":=" been eliminated?  It seems to be gone from the most current
snapshot, which makes loading survival4 fail (it contains 6 `:='
assignments in header.R).

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Apr 14 17:33:55 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 14 Apr 1997 18:33:55 +0200
Subject: R-alpha: CRAN source/contrib
Message-ID: <199704141633.SAA04237@aragorn.ci.tuwien.ac.at>

Several of the contrib packages were upgraded today.  Most notably,
Thomas rewrote parts of gee which were copied from Numerical Recipes.
Also, I added a port of the `oz' package which seems to work fine.

The current INDEX file is attached.  I've made several changes as
suggested.  CRAN should be announced soon (hopefully I can get to
upgrading the FAQ tonight).

-k

***********************************************
CRAN/source/contrib currently contains:

acepack.tar.gz:
	ace (Alternating Conditional Expectations) and avas (Additivity
	and variance stabilization for regression) for selecting
	regression transformations.

	S avas original by Rob Tibshirani <tibs@utstat.toronto.edu>,
	FORTRAN ace code by Friedman & Spector from Statlib.
	R package by Thomas Lumley <thomas@biostat.washington.edu>.
	(avas ported; ace modified to use double precision, and an R
	interface cloned from the avas() one).
	[1997/04/14]
	
bootstrap.tar.gz:
	Software (bootstrap, cross-validation, jackknife), data and
	errata for the book "An Introduction to the Bootstrap" by B.
	Efron and R.  Tibshirani, 1993, Chapman and Hall.

	S original by Rob Tibshirani <tibs@utstat.toronto.edu>.
	R port by Fritz Leisch <Friedrich.Leisch@ci.tuwien.ac.at>.
	[1997/04/14]

ctest.tar.gz:
	A library of classical tests, including the Bartlett, Fisher,
	Kruskal-Wallis, Kolmogorov-Smirnov, and Wilcoxon tests.
	
	Written by Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at>.
	[1997/04/08]

date.tar.gz:
	Functions for dealing with dates.  The most useful of them
	accepts a vector of input dates in any of the forms 8/30/53,
	30Aug53, 30 August 1953,..., August 30 53, or any mixture of
	these.

	S original by Terry Therneau <therneau@mayo.edu>.
	R port by Thomas Lumley <thomas@biostat.washington.edu>.
	[1997/04/08]

e1071.tar.gz:
	Miscellaneous functions used at the Department of Statistics at
	TU Wien (E1071).

	Compiled by Fritz Leisch <Friedrich.Leisch@ci.tuwien.ac.at>.
	[1997/04/14]	

fracdiff.tar.gz:
	Maximum likelihood estimation of the parameters of a
	fractionally differenced ARIMA(p,d,q) model (Haslett and
	Raftery, Applied Statistics, 1989).

	S original by Chris Fraley <fraley@stat.washington.edu>.
	R port by Fritz Leisch <Friedrich.Leisch@ci.tuwien.ac.at>.
	[1997/04/08]

gee.tar.gz:
	An implementation of the Liang/Zeger generalized estimating
	equation approach to GLMs for dependent data.

	S original by Vincent Carey <carey@biostat.harvard.edu> and
	Aidan McDermott.
	R port by Thomas Lumley <thomas@biostat.washington.edu>.
	[1997/04/14]

jpn.tar.gz:
	A function to plot Japan's coast-line and prefecture
	boundaries.

	S original by Ritei Shibata <shibata@statlab.math.keio.ac.jp>.
	R port by Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at>.
	[1997/04/08]	

oz.tar.gz:
	Functions for plotting Australias coastline and state boundaries.

	S original by Bill Venables <Bill.Venables@adelaide.edu.au>.
	R port by Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at>.
	[1997/04/14]

snns.tar.gz:
	An R interface to the Stuttgart Neural Networks Simulator
	(SNNS).

	Written by Fritz Leisch <Friedrich.Leisch@ci.tuwien.ac.at>.
	[1997/04/14]

splines.tar.gz:
	Regression spline functions.

	R port by Thomas Lumley <thomas@biostat.washington.edu>, based
	on the S packages `splines' by Doug Bates <bates@stat.wisc.edu>
	and `safe.predict' by John Chambers and Trevor Hastie.
	[1997/04/08]

survival4.tar.gz:
	Functions for survival analysis.  This ``port'' is not complete
	yet, because it requires a few changes to the R system itself
	rather than the add-on package, but most of the functionality is
	already available.

	Requires splines.

	S original by Terry Therneau <therneau@mayo.edu>.
	R port by Thomas Lumley <thomas@biostat.washington.edu>.
	[1997/04/14]
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Apr 14 17:57:44 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 14 Apr 1997 18:57:44 +0200
Subject: R-alpha: User friendly functions
In-Reply-To: <x2k9md77cb.fsf@bush.kubism.ku.dk>
References: <x2k9md77cb.fsf@bush.kubism.ku.dk>
Message-ID: <199704141657.SAA04410@aragorn.ci.tuwien.ac.at>

>>>>> Peter Dalgaard BSA writes:

> A loose idea for *post*-0.50 development
> I've been giving a some (but not all that many) thoughts to whether
> some of the conceptual difficulties facing newcomers could be avoided
> by having simplified functions for common operations. We already have
> parts of this, e.g. in Kurts ctest routines. Specifically, I was
> thinking about data frames: How about

> dfr.sel<-select.frame(dfr,age,sex,pain1:pain5)

> with the : specifying a range, instead of 

> dfr.sel<-dfr[,c(1,2,5,6,7,8,9)] 

> or 

> attach(dfr)
> dfr.sel<-data.frame(age,sex,pain1,pain2,pain3,pain4,pain5) 
> detach(dfr)

> (which isn't even safe if there are variables of the same name in the
> global environment)

> similarly, how about

> dfr.sub<-subset.frame(dfr,sex==1 && age > 30)

> rather than

> dfr.sub<-dfr[dfr$sex==1 && dfr$age > 30,]

> Both would seem to be quite possible to implement, although they do
> need to do some sneaky bits of computing-on-the-language internally.

Something like that would be very nice to have.

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Mon Apr 14 18:28:06 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 14 Apr 1997 19:28:06 +0200
Subject: R-alpha: User friendly functions
In-Reply-To: Kurt Hornik's message of Mon, 14 Apr 1997 18:57:44 +0200
References: <x2k9md77cb.fsf@bush.kubism.ku.dk>
 <199704141657.SAA04410@aragorn.ci.tuwien.ac.at>
Message-ID: <x2208dfra1.fsf@bush.kubism.ku.dk>

Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

> > dfr.sel<-select.frame(dfr,age,sex,pain1:pain5)
> 
> > dfr.sub<-subset.frame(dfr,sex==1 && age > 30)
> 
> Something like that would be very nice to have.

I got a working select.frame() during the weekend. Really easy, once you
get the hang of constructions of the type

eval(as.call(subst.expr(c(as.name("c"),expression(...)))))

- with subst.expr() recursively replacing call arguments with
corresponding numbers using match(). As a bonus, it is actually
possible to do stuff like

select.frame(psychometry,seq(scale1.before,scale15.before,2))

and get every *second* variable in the range (skipping "after"
measurements) 

Next: subset.frame() - before I do the obvious: Is there a simple way
of getting R to search a frame *before* the global environment?

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Mon Apr 14 21:09:49 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Tue, 15 Apr 1997 08:09:49 +1200 (NZST)
Subject: R-alpha: problems qith require/provide
Message-ID: <199704142009.IAA02547@stat1.stat.auckland.ac.nz>

Thomas has sent me a new version which may fix this problem.  I will
take a look.
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Mon Apr 14 21:15:34 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Tue, 15 Apr 1997 08:15:34 +1200 (NZST)
Subject: R-alpha: problem with survival4 and ":="
Message-ID: <199704142015.IAA02571@stat1.stat.auckland.ac.nz>

I did indeed take := out.  If code is loaded with "library" these can
be converted to <-.

:= was one of those temporary hacks we put in place 5 years ago and
never got around to fixing.  We already have <- and <<- as assignment
operators.  This is one assignment too many (some would say two too
many).

If it is really critical I can put it back.  I only removed the
reference from the table of internal functions, the actual code is
still in place.
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Mon Apr 14 21:44:12 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Mon, 14 Apr 1997 13:44:12 -0700 (PDT)
Subject: R-alpha: problems qith require/provide
In-Reply-To: <199704142009.IAA02547@stat1.stat.auckland.ac.nz>
Message-ID: <Pine.SUN.3.91.970414132518.3839A-100000@chekov>

On Tue, 15 Apr 1997, Ross Ihaka wrote:

> Thomas has sent me a new version which may fix this problem.  I will
> take a look.
It doesn't completely.  A better solution is to do as Kurt suggested and 
put 
.Provided<-character(0)
in Rprofile.  The code at the end of this message then works.

Re: :=
The loss of := is not a problem now we know about it (I used sed to 
convert, Kurt used emacs), it was just a bit of a surprise at the time.
It's a good idea to get it killed off *before* we go to a beta version.


libraries:
R source files in the funs/ directory of a library are not used if their 
names begin with a capital letter [eg Rsurvival4, Rgee, Rdate  ;-)]

- thomas
--------------------------------------------------------------
require<- function (name, quietly = FALSE) 
{
  if (missing(name)) 
    return(TRUE)  
  name <- substitute(name)
  if (!is.character(name)) 
	  name <- deparse(name)
  if (is.na(match(name, .Libraries))&& is.na(match(name, .Provided))) {
    file <- system.file("library", name)
    if (file == "") {
      if (!quietly) 
	warning(paste("Required library ", name, " not found.\n"))
      return(FALSE)
    }
    if (!quietly) 
      cat("Autoloading required library:", name, "\n")
    sys.source(file)
    assign(".Libraries", c(name, .Libraries), NULL)
  }
  return(TRUE)
}


provide<-function(name)
{
  if (missing(name)) {
    return(list(provide=.Provided, library=.Libraries))
  }
  name<-substitute(name)
  if (!is.character(name))
    name<-deparse(name)
  if (is.na(match(name, .Libraries)) && is.na(match(name, .Provided))){
    assign(".Provided",c(name,.Provided),environment(NULL))
    return(TRUE)
  } 
  else 
    return(FALSE)
}
  

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Mon Apr 14 23:59:23 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 15 Apr 1997 00:59:23 +0200
Subject: R-alpha: select.frame
Message-ID: <x2ragd9po4.fsf@bush.kubism.ku.dk>

Here's the select.frame() function I babbled about before. Suggestions
about coding style, etc., are welcome, I feel a bit green at this.

select.frame<-
function (dfr, ...) 
{
        subst.exp <- function(e) {
                for (i in 2:length(e)) {
                        ei <- e[[i]]
                        if (is.call(ei)) 
                                e[[i]] <- subst.exp(ei)
                        else {
                                n <- match(as.character(ei), nm)
                                if (!is.na(n)) 
                                 e[[i]] <- n
                        }
                }
                e
        }
        nm <- names(dfr)
        e <- as.call(c(as.name("c"), expression(...)))
        dfr[, eval(subst.exp(e))]
}


-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Tue Apr 15 01:54:23 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Mon, 14 Apr 1997 17:54:23 -0700 (PDT)
Subject: R-alpha: D()
In-Reply-To: <9704090917.AA01943@>
Message-ID: <Pine.SUN.3.95.970414175127.18041A-100000@sulu>


D() doesn't handle exp() correctly:

R> D(expression(exp(sin(x))),"x")
sin(x) * cos(x)
R> D(expression(exp(x)),"x")
x


Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Tue Apr 15 15:23:06 1997
From: ihaka@stat.auckland.ac.nz (Ross &)
Date: Wed, 16 Apr 1997 02:23:06 +1200
Subject: R-alpha: D()
In-Reply-To: <Pine.SUN.3.95.970414175127.18041A-100000@sulu>
References: <9704090917.AA01943@>
 <Pine.SUN.3.95.970414175127.18041A-100000@sulu>
Message-ID: <199704151423.CAA06246@stat9.stat.auckland.ac.nz>

Thomas Lumley writes:
 > 
 > D() doesn't handle exp() correctly:
 > 

Duh!  Back to first year calculus for me.  It's
NOT

	d/dx e^f(x) = f(x) * f'(x).

BUT

	d/dx e^f(x) = e^f(x) * f'(x).

Deep down in the C function "D" in deriv.c you will find the lines

                else if(CAR(expr) == ExpSymbol) {
                        ans = simplify(TimesSymbol,
                                CADR(expr),
                                PP(D(CADR(expr), var)));
                        UNPROTECT(1);
                }

These should in fact read

                else if(CAR(expr) == ExpSymbol) {
                        ans = simplify(TimesSymbol,
                                expr,
                                PP(D(CADR(expr), var)));
                        UNPROTECT(1);
                }

I.e. remove the CADR from around the "expr" in the call to simplify.

This has clearly not been tested by anyone with a firm grasp of the
Newton/Leibnitz version of the calculus.  Use with care ...
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Tue Apr 15 13:07:20 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 15 Apr 1997 14:07:20 +0200
Subject: R-alpha: problem with survival4 and ":="
In-Reply-To: <199704142015.IAA02571@stat1.stat.auckland.ac.nz>
References: <199704142015.IAA02571@stat1.stat.auckland.ac.nz>
Message-ID: <199704151207.OAA07065@aragorn.ci.tuwien.ac.at>

>>>>> Ross Ihaka writes:

> I did indeed take := out.  If code is loaded with "library" these can
> be converted to <-.

> := was one of those temporary hacks we put in place 5 years ago and
> never got around to fixing.  We already have <- and <<- as assignment
> operators.  This is one assignment too many (some would say two too
> many).

> If it is really critical I can put it back.  I only removed the
> reference from the table of internal functions, the actual code is
> still in place.

I don't think we need it anymore.  As Thomas said, taking it out before
moving to beta was perfect ...

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Apr 15 20:31:33 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 15 Apr 97 21:31:33 +0200
Subject: R-alpha: Bug & Patch  in  dbeta.c  (0.50 - PreR 7)
Message-ID: <9704151931.AA01510@>

dbeta(1, a,b)  would return 1 instead of 0.

Here is the patch for  ..../src/math/dbeta.c :

--- dbeta.c~	Sun Nov 24 23:43:10 1996
+++ dbeta.c	Tue Apr 15 21:25:30 1997
@@ -23,9 +23,7 @@
 {
 	if (a <= 0.0 || b <= 0.0)
 		DOMAIN_ERROR;
-	if (x <= 0)
+	if (x <= 0 || x >= 1.0)
 		return 0.0;
-	if (x >= 1.0)
-		return 1.0;
 	return MATH_CHECK(pow(x, a - 1) * pow(1.0 - x, b - 1.0) / beta(a, b));
 }
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Tue Apr 15 20:57:33 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Tue, 15 Apr 1997 12:57:33 -0700 (PDT)
Subject: R-alpha: D()
In-Reply-To: <199704151423.CAA06246@stat9.stat.auckland.ac.nz>
Message-ID: <Pine.SUN.3.95.970415125504.21998A-100000@uhura>


R> D(expression(z * (log(z) /z)),"z")
Error: invalid form in unary minus check



 - thomas

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Tue Apr 15 21:02:55 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Tue, 15 Apr 1997 13:02:55 -0700 (PDT)
Subject: R-alpha: Bug & Patch  in  dbeta.c  (0.50 - PreR 7)
In-Reply-To: <9704151931.AA01510@>
Message-ID: <Pine.SUN.3.95.970415125913.21998B-100000@uhura>

On Tue, 15 Apr 1997, Martin Maechler wrote:

> dbeta(1, a,b)  would return 1 instead of 0.

Shouldn't it be 1 for b=1, Inf for b<1 and 0 for b>1 at x=1 (and similar
behaviour at x=0)?

ie 
double dbeta(double x, double a, double b)
{
        if (a <= 0.0 || b <= 0.0)
                DOMAIN_ERROR;
        if (x < 0)
                return 0.0;
        if (x > 1.0)
                return 0.0;
        return MATH_CHECK(pow(x, a - 1) * pow(1.0 - x, b - 1.0) / beta(a,
b));
}




Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Tue Apr 15 21:12:27 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Tue, 15 Apr 1997 13:12:27 -0700 (PDT)
Subject: R-alpha: Be nice to the English
In-Reply-To: <Pine.SUN.3.95.970415125913.21998B-100000@uhura>
Message-ID: <Pine.SUN.3.95.970415130444.21998C-100000@uhura>

Two suggestions for additions to Rprofile:

colours<-colors
optimise<-optimize

to provide aliases for the alternative spellings of these words.  As an
argument to a function we usually seem to use col= rather than colors=
which gets around that compatibility issue.  I don't know how much it
matters in R but I write \begin{itemise} instead of \begin{itemize} in
LaTeX with annoying regularity.

The aliases would also have to be added to the help pages for the relevant
functions.


Thomas Lumley


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Tue Apr 15 21:16:23 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Wed, 16 Apr 1997 08:16:23 +1200 (NZST)
Subject: R-alpha: D()
Message-ID: <199704152016.IAA24269@stat1.stat.auckland.ac.nz>

	R> D(expression(z * (log(z) /z)),"z")
	Error: invalid form in unary minus check

Yep. this is the result of an implete "if" statement in the C function
"isUminus" in deriv.c.  The function should read

static int isUminus(SEXP s)
{
	if(TYPEOF(s) == LANGSXP && CAR(s) == MinusSymbol) {
		switch(length(s)) { 
		case 2:
			return 1;
		case 3:
			if(CADDR(s) == R_MissingArg)
				return 1;
			else return 0;
		default:
			error("invalid form in unary minus check\n");
		}
	}
	else return 0;
}

This now gives

	> D(expression(z * (log(z) /z)),"z")
	(log(z)/z) + z * (1/z/z - log(z)/z^2)

which I thought was pretty ugly, but

	S-PLUS : Copyright (c) 1988, 1996 MathSoft, Inc.
	S : Copyright AT&T.
	Version 3.4 Release 1 for Sun SPARC, SunOS 4.1.3_U1 : 1996
	Working data will be in .Data
	> D(expression(z * (log(z) /z)),"z")
	(log(z)/z) + z * (1/z/z - log(z)/z^2)

So we are no worse than S.

And shame on you for trying to fool such a dumb bit of software :-).
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Apr 15 22:36:12 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 15 Apr 97 23:36:12 +0200
Subject: R-alpha: Buglet & patch  in  dbinom.c  (0.50 - PreR 7)
Message-ID: <9704152136.AA01576@>

dbinom(k, n, prob = 0) # or  prob=1   would not work;

The following patch makes it work (in  $RHOME/src/math/ ) :

--- dbinom.c~	Sun Nov 24 23:43:10 1996
+++ dbinom.c	Tue Apr 15 23:31:46 1997
@@ -23,9 +23,13 @@
 {
 	x = floor(x + 0.5);
 	n = floor(n + 0.5);
-	if (n <= 0.0 || p <= 0.0 || p >= 1.0)
+	if (n <= 0.0 || p < 0.0 || p > 1.0)
 		DOMAIN_ERROR;
 	if (x < 0.0 || x > n)
 		return 0.0;
+	if (p == 0.0)
+	        return (x == 0) ? 1.0 : 0.0;
+	if (p == 1.0)
+	        return (x == n) ? 1.0 : 0.0;
 	return exp(lfastchoose(n, x) + log(p) * x + (n - x) * log(1.0 - p));
 }
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Apr 15 22:52:01 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 15 Apr 97 23:52:01 +0200
Subject: R-alpha: Bug & Patch  in  dbeta.c  (0.50 - PreR 7)
In-Reply-To: <Pine.SUN.3.95.970415125913.21998B-100000@uhura> (message from
 Thomas Lumley on Tue, 15 Apr 1997 13:02:55 -0700 (PDT))
Message-ID: <9704152152.AA01582@>

Of course ! (--- silly me)

S-plus actually always returns 0 here;  but your solution is mathematically
correct where S is NOT!

The "bad" thing about R is only that we still don't have IEEE arithmetic.
Will get 'NA' instead of 'Inf'  ...


Thomas Lumley :
>> On Tue, 15 Apr 1997, Martin Maechler wrote:
>> 
>> > dbeta(1, a,b)  would return 1 instead of 0.
>> 
>> Shouldn't it be 1 for b=1, Inf for b<1 and 0 for b>1 at x=1 (and similar
>> behaviour at x=0)?
>> 
>> ie 
>> double dbeta(double x, double a, double b)
>> {
>>         if (a <= 0.0 || b <= 0.0)
>>                 DOMAIN_ERROR;
>>         if (x < 0)
>>                 return 0.0;
>>         if (x > 1.0)
>>                 return 0.0;
>>         return MATH_CHECK(pow(x, a - 1) * pow(1.0 - x, b - 1.0) / beta(a,
>> b));
>> }
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Apr 15 23:10:26 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 16 Apr 97 00:10:26 +0200
Subject: R-alpha: R0.50 Pre7 :  Bug in .Internal(print.default(.)...)
Message-ID: <9704152210.AA01600@>

> options()$digi
[1] 7
> (0:2)/1000 + 1e-10
[1]1e-3131e-3131e-313

-->  Hugh ?!?!  (it is NOT in computation just in printing !) :

> options(digits=8)
> 0:2/1000 + 1e-10
[1] 1.0000000e-10 1.0000001e-03 2.0000001e-03
> options(digits=5)
> 0:2/1000 + 1e-10
[1]1e-3131e-3131e-313
> 
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Tue Apr 15 23:54:00 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Wed, 16 Apr 1997 10:54:00 +1200 (NZST)
Subject: R-alpha: Re: select.frame
Message-ID: <199704152254.KAA25648@stat1.stat.auckland.ac.nz>

Peter Dalgaard writes:

> Here's the select.frame() function I babbled about before. Suggestions
> about coding style, etc., are welcome, I feel a bit green at this.

	[ function code omitted. ]

This is a very nice function!  One of the things I like about SAS is
the ability to specify ranges of variables.  I do have a couple of
suggestions.

1. The expression 

	e <- as.call(c(as.name("c"), expression(...)))

   can be written more concisely as

	e <- substitute(c(...))

2. As written, the function uses R scoping rules to pass the value of
   the variable "nm" into the body of "subst.exp", and so the function
   will not work in S.  It might be better to pass "nm" as an argument
   so that the function is portable.

3. It might be good to check that only ":" expressions allowed.


Here is a modified version version of the function which does the above.

select.frame<-
function (dfr, ...)
{
        subst.exp <- function(e, nm) {
                for (i in 2:length(e)) {
                        ei <- e[[i]]
                        if (is.name(ei)) {
                                n <- match(as.character(ei), nm)
                                if (!is.na(n))
                                        e[[i]] <- n
                        }
                        else if (is.call(ei) && as.character(ei[[1]]) == ":")
                                e[[i]] <- subst.exp(ei, nm)
                        else if (is.numeric(ei)) {
                                e[[i]] <- e[[i]]
                        }
                        else stop("invalid selection")
                }
                e
        }
        dfr[, eval(subst.exp(substitute(c(...)), names(dfr)))]
}

Here it is in action:

	> select.frame(iris,Sepal.Length:Petal.Length,Species)[1:5,]
	  Sepal.Length Sepal.Width Petal.Length Species
	1          5.1         3.5          1.4  setosa
	2          4.9         3.0          1.4  setosa
	3          4.7         3.2          1.3  setosa
	4          4.6         3.1          1.5  setosa
	5          5.0         3.6          1.4  setosa
	> 

Note that in S you can write

	as.character(ei[[1]]) == ":"

in the simpler form

	ei[[1]] == ":"

and I have made a change to (my version of) R to make this work.

Finally, it would be possible to use the forbidden black arts (i.e.
"Recall") to make the function body a single expression.  However
I would recommend that "Recall" never be used.  The function above is
more clearly written than a version using "Recall".

I also think that this idea is useful enough to generalized.  One
approach would be to make a generic function "select" and make the
function above the method for data frames - i.e. call it
select.data.frame.

Another idea would be to have "select" operate on name vectors in
general, rather than on just variable names in data frames.  Then the
same trick could be used to select rows as well as columns.
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Wed Apr 16 00:51:18 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 16 Apr 1997 01:51:18 +0200
Subject: R-alpha: Re: select.frame
In-Reply-To: Ross Ihaka's message of Wed, 16 Apr 1997 10:54:00 +1200 (NZST)
References: <199704152254.KAA25648@stat1.stat.auckland.ac.nz>
Message-ID: <x2u3l76e15.fsf@bush.kubism.ku.dk>

Ross Ihaka <ihaka@stat.auckland.ac.nz> writes:

> 2. As written, the function uses R scoping rules to pass the value of
>    the variable "nm" into the body of "subst.exp", and so the function
>    will not work in S.  It might be better to pass "nm" as an argument
>    so that the function is portable.

..and same thing applies to subst.exp itself, isn't that so? As
written, subst.exp would not be able to find subst.exp. Let's see:

[Splus]
> g<-function(n){f<-function(n)ifelse(n,1,n*f(n));f(n)}
> g(3)
Error in f(n): couldn't find function "f"
Dumped

Right. One of the major annoyances in S, actually. This has bugged be
always. You need to put the function in the "evaluation frame" or
define it globally. Maybe one should just leave it and let S solve the
porting problems? ;^)

> 3. It might be good to check that only ":" expressions allowed.

Hum. I was beginning to like the idea that you could put complicated
expressions in there, as in

select.frame(dfr, seq(visit1.1st, length=10, by=3))

when you have visit1.1st, visit1.2nd, visit1.3rd, .... visit10.3rd and
you want to look at the *.1st measurements. The semantics are that
variable names get replaced by their column numbers, if they exist in
the frame, and all that is required is that the resulting integer
expression makes sense. 

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Wed Apr 16 15:57:07 1997
From: ihaka@stat.auckland.ac.nz (Ross &)
Date: Thu, 17 Apr 1997 02:57:07 +1200
Subject: R-alpha: Re: select.frame
In-Reply-To: <x2u3l76e15.fsf@bush.kubism.ku.dk>
References: <199704152254.KAA25648@stat1.stat.auckland.ac.nz>
 <x2u3l76e15.fsf@bush.kubism.ku.dk>
Message-ID: <199704161457.CAA08074@stat9.stat.auckland.ac.nz>

Peter Dalgaard writes:
 > ..and same thing applies to subst.exp itself, isn't that so? As
 > written, subst.exp would not be able to find subst.exp. Let's see:

You are right of course.  Its been a while since I tried anything
substantial in S.

 >  Maybe one should just leave it and let S solve the
 > porting problems? ;^)

Sounds good to me, but I think its an interesting enough idea to get
a bit wider exposure.  You could always mention how much cleaner it is
in R :-).

 > > 3. It might be good to check that only ":" expressions allowed.
 > 
 > Hum. I was beginning to like the idea that you could put complicated
 > expressions in there, as in

By all means.  Whatever makes sense.
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Wed Apr 16 11:49:34 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 16 Apr 1997 12:49:34 +0200
Subject: R-alpha: CRAN announcement
Message-ID: <199704161049.MAA10469@aragorn.ci.tuwien.ac.at>

Attached is an updated version of the CRAN announcement, also to be sent
out as soon as 0.50 is out.  Again, please have a look if possible.

-k

************************************************************************
This is the first announcement of the

		   Comprehensive R Archive Network 
			        (CRAN)

CRAN is a collection of sites which carry identical material, consisting
of the R&R R distribution(s), the contributed extensions, documentation
for R, and binaries.

The CRAN master site can be found at the URL

	ftp://ftp.ci.tuwien.ac.at/pub/R		(Austria)

and is currently being mirrored daily at

	ftp://franz.stat.wisc.edu/pub/R		(U.S.A.)
	ftp://ftp.stat.math.ethz.ch/R-CRAN	(Switzerland)

This list should grow within soon.  If you want to become an official
CRAN mirror, please send me a note (Kurt.Hornik@ci.tuwien.ac.at).

Please use the CRAN site closest to you to reduce network load.

The structure of the CRAN tree is as follows.

	src/base		# Source distribution
	src/contrib		# Source for extensions
	doc/			# Documentation
	bin/<platform>		# Binaries

`src/base' contains the official R source distribution as provided by
Ross Ihaka and Robert Gentleman.

`src/contrib' contains code for extension packages.  Currently, there
are acepack, bootstrap, ctest, date, e1071, fracdiff, gee, jpn, oz,
snns, splines, and survival4.  Look at the INDEX file in this directory
for more specific information.  More packages are expected for the near
future.

`bin' is for prebuilt R binaries (the base distribution and extensions),
grouped according to platforms.  Currently, there are only experimental
packages for Debian GNU/Linux.  I hope that `.tar.gz' files with
contents relative to an installation tree (e.g. `bin/', `lib/R/', and
`man/man1/R.1') can be made available soon for all major supported Unix
platforms.

`doc' is for additional documentation and information on R.

In the short run, the process of `submitting' to CRAN is very simple:
upload to 

	ftp://ftp.ci.tuwien.ac.at/incoming

and drop me a note (Kurt.Hornik@ci.tuwien.ac.at).  Please indicate the
copyright situation (GPL, ...) in your submission.

In the long run, there will be a form to fill in, and some requirement
of authentication (PGPish, ...), and submission could maybe be done via
WWW.  I am open to suggestions here.

*****************************************************************************
*          Kurt Hornik         *                                            *
*  Dept of Statistics TU Wien  * tel:    +43 (1) 58801-4542                 *
*  Wiedner Hauptstr 8-10/1071  * fax:    +43 (1) 504-1498                   *
*          A-1040 Wien         * email:  Kurt.Hornik@ci.tuwien.ac.at        *
*            Austria           * WWW:    http://www.ci.tuwien.ac.at/~hornik *
*****************************************************************************
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Wed Apr 16 11:49:34 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 16 Apr 1997 12:49:34 +0200
Subject: R-alpha: R-FAQ
Message-ID: <199704161049.MAA10470@aragorn.ci.tuwien.ac.at>

Attached is an updated version of the FAQ, to be released right after
0.50 is out.  Please have a look, and let me know where improvements are
needed.

Thanks,
-k

*******************************************
  R FAQ
  Kurt Hornik
  v0.1-0, 1997/04/16

  This document contains answers to some of the most frequently asked
  questions about R.  Feedback is welcome.
  ______________________________________________________________________

  Table of Contents:

  1.	Introduction

  1.1.	Legalese

  1.2.	Obtaining this Document

  1.3.	Notation

  1.4.	Feedback

  2.	R Basics

  2.1.	What Is R?

  2.2.	What Machines Does R Run on?

  2.3.	What Is the Current Version of R?

  2.4.	How Can R Be Obtained?

  2.5.	How Can R Be Installed?

  2.5.1.  How Can R Be Installed (Unix)

  2.5.2.  How Can R Be Installed (Windows)

  2.5.3.  How Can R Be Installed (Macintosh)

  2.6.	Are there Unix Binaries for R?

  2.7.	Which Documentation Exists for R?

  2.8.	Which Mailing Lists Exist for R?

  2.9.	What is CRAN?

  3.	R and S

  3.1.	What Is S?

  3.2.	What Is S-PLUS?

  3.3.	What Are the Differences between R and S?

  4.	R Add-On Packages

  4.1.	Which Add-on Packages Exist for R?

  4.2.	How Can Add-on Packages Be Installed?

  4.3.	How Can Add-on Packages Be Used?

  4.4.	How Can I Contribute to R?

  5.	R and Emacs

  5.1.	Is there Emacs Support for R?

  5.2.	Should I Run R from Within Emacs?

  6.	R Miscellania

  6.1.	How Can I Read a Large Data Set into R?

  6.2.	Why Can't R Source a `Correct' File?

  6.3.	How Can I Set Components of a List to NULL?

  6.4.	How Can I Save My Workspace?

  6.5.	How Can I Clean Up My Workspace?

  7.	Acknowledgments
  ______________________________________________________________________

  1.  Introduction

  This document contains answers to some of the most frequently asked
  questions about R.

  1.1.	Legalese

  This document is free software; you can redistribute it and/or modify
  it under the terms of the GNU General Public License as published by
  the Free Software Foundation; either version 2, or (at your option)
  any later version.

  This program is distributed in the hope that it will be useful, but
  WITHOUT ANY WARRANTY; without even the implied warranty of
  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.	See the GNU
  General Public License for more details.

  If you do not have a copy of the GNU General Public License, write to
  the Free Software Foundation, 59 Temple Place - Suite 330, Boston, MA
  02111-1307, USA.

  1.2.	Obtaining this Document

  The latest version of this document is always available from
  http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html.

  From there, you can also obtain versions converted to plain ASCII
  text, DVI, and PostScript, as well as the SGML source used for
  creating all these formats using the SGML-Tools (formerly Linuxdoc-
  SGML) system.

  1.3.	Notation

  Everything should be pretty standard.	`R>' is used for the R prompt,
  and a `$' for the shell prompt (where applicable).

  1.4.	Feedback

  Feedback is of course most welcome.

  In particular, note that I do not have access to Windows or Mac
  systems.  If you have information on these systems that you think
  should be added to this document, please let me know.

  2.  R Basics

  2.1.	What Is R?

  R is a system for statistical computation and graphics.  It consists
  of a language plus a run-time environment with graphics, a debugger,
  access to certain system functions, and the ability to run programs
  stored in script files.

  The design of R has been heavily influenced by two existing languages:
  Becker, Chambers & Wilks' S (see question ``What is S?'') and
  Sussman's Scheme.  Whereas the resulting language is very similar in
  appearance to S, the underlying implementation and semantics are
  derived from Scheme.	See question ``What Are the Differences between
  R and S?'' for a discussion of the differences between R and S.

  R is being developed by Ross Ihaka and Robert Gentleman, two Senior
  Lecturers at the Department of Statistics of the University of
  Auckland in Auckland, New Zealand.

  R is free software distributed under a GNU-style copyleft.

  2.2.	What Machines Does R Run on?

  R is being developed for the Unix, Windows and Mac platforms.

  R will configure and build under a number of common Unix platforms
  including dec-alpha-osf, freebsd, hpux, linux-elf, sgi-irix, solaris,
  and sunos.  If you know about other platforms, please drop me a note.

  2.3.	What Is the Current Version of R?

  The current Unix version is 0.50, the previous one was 0.16.1.  The
  jump in the version number is deliberate, because 0.50 added group
  methods and complex numbers and hence more or less provides a full
  implementation of S as described in ``The New S Language''.

  The versions for Windows and Mac are pre-alpha.  With some good luck,
  the Windows version will soon catch up with the Unix version.

  2.4.	How Can R Be Obtained?

  Sources, binaries and documentation for R can be obtained via CRAN,
  the ``Comprehensive R Archive Network'' (see question ``What is
  CRAN?'').

  2.5.	How Can R Be Installed?

  2.5.1.  How Can R Be Installed (Unix)

  If binaries are available for your platform (see question ``Are there
  Unix Binaries for R?''), you can use these, following the instructions
  that come with them.

  Otherwise, you can compile and install R yourself, which can be done
  very easily under a number of common Unix platforms (see question
  ``What Machines Does R Run on?'').  The file INSTALL that comes with
  the R distribution contains instructions.

  Choose a place to install the R tree (R is not just a binary, but has
  additional data sets, help files, font metrics etc).	Let's call this
  place RHOME (given appropriate permissions, a natural choice would be
  `/usr/local/lib/R').	Untar the source code, and issue the following
  commands (at the shell prompt):

       $ ./configure
       $ make
       $ make install-help

  You can also build a LaTeX version of the manual entries with

       $ make install-latex

  and an HTML version of the manual with

       $ make install-html

  If these commands execute successfully, the R binary will be copied to
  the `$RHOME/bin' directory.  In addition, a shell script font-end
  called `R' will be created and copied to the same directory.	You can
  copy this script to a place where users can invoke it, for example to
  `/usr/local/bin'.  You could also copy the man page `R.1' to a place
  where your man reader finds it, such as `/usr/local/man/man1'.

  2.5.2.  How Can R Be Installed (Windows)

  Get the file `Rexe.zip' from the `bin/ms-windows' directory of a CRAN
  site.	This archive contains a binary Windows 3.xx distribution for R
  and installation instructions.

  Robert Gentleman has recently made an updated pre-alpha Windows
  executable file available for ftp at
  ftp://stat.auckland.ac.nz/pub/research/rgentlem/rbeta.zip.  This
  binary should be more compatible with Windows 95 than the other (he
  does not know about 3.1).  You still need all the other extra files
  from the previous Windows distribution, it is only an executable.

  2.5.3.  How Can R Be Installed (Macintosh)

  CRAN sites have a directory `bin/macintosh' which contains
  `R.sea.hqx', a binhexed self-extracting archive, and installation
  instructions in `README.MACINTOSH'.

  2.6.	Are there Unix Binaries for R?

  Experimental `.deb' packages for installation under Debian GNU/Linux
  can be found in `bin/ix86-linux'.  No other binaries distributions for
  Unix systems have thus far been made publically available.

  2.7.	Which Documentation Exists for R?

  Currently, there is no R manual.  Online documentation for most of the
  functions and variables in R exists, and can be printed on-screen by
  typing help(name) (or ?name) at the R prompt, where name is the name
  of the R object help is sought for.  (In the case of unary and binary
  operators and control-flow special forms, the name may need to be be
  quoted.)

  This documentation can also be made available as HTML, and as hardcopy
  via LaTeX, see question ``How Can R Be Installed?''.	An up-to-date
  HTML version is always available for web browsing at

       http://www.stat.math.ethz.ch/R-manual

  In the absence of a systematic introduction to R, one can mostly get
  along with introductions to S or S-PLUS, such as ``Notes on S-PLUS:  A
  Programming Environment for Data Analysis and Graphics'' by Bill
  Venables <venables@stats.adelaide.edu.au> and David Smith
  <D.M.Smith@lancaster.ac.uk>.	This document talks mostly about plain S
  features, and does not concentrate on features specific to S-PLUS, and
  is available from the Statlib S repository at
  http://lib.stat.cmu.edu/S/SplusNotes/ (LaTeX source and PostScript).
  An introduction to R based on it will soon be available.

  Last, but not least, Ross' and Robert's experience in designing and
  implementing R is described in:

       @Article{,
	 author =	{Ross Ihaka and Robert Gentleman},
	 title =	{R: {A} Language for Data Analysis and Graphics},
	 journal =	{Journal of Computational and Graphical Statistics},
	 year =		1996,
	 volume =	5,
	 number =	3,
	 pages =	{299--314}
       }

  This is also the reference for R to use in publications.

  2.8.	Which Mailing Lists Exist for R?

  Thanks to Martin Maechler <maechler@stat.math.ethz.ch>, there are
  three mailing lists devoted to R.

     r-announce
	This list is for announcements about the development of R and
	the availability of new code.

     r-devel
	This list is for discussions about the future of R and pre-
	testing of new versions.  It is meant for those who maintain an
	active position in the development of R.

     r-help
	The `main' R mailing list, for announcements about the
	development of R and the availability of new code, questions and
	answers about problems and solutions using R, enhancements and
	patches to the source code and documentation of R, comparison
	and compatibility with S and S-plus, and for the posting of nice
	examples and, benchmarks.

  To send a message to everyone on the r-help mailing list, send email
  to

       r-help@stat.math.ethz.ch

  To subscribe (or unsubscribe) to this list send subscribe (or unsub-
  scribe) in the BODY of the message (not in the subject!)  to r-help-
  request@stat.math.ethz.ch.  Information about the list can be obtained
  by sending an email with info as its contens to r-help-
  request@stat.math.ethz.ch.

  Subscription and posting to the other lists is done analogously, with
  `r-help' replaced by `r-announce' and `r-devel', respectively.  Note
  that the r-announce list is gatewayed into r-help, so you don't need
  to subscribe to both of them.

  It is recommended that you send mail to r-help rather than only to the
  R developers (who are also subscribed to the list, of course).  This
  may save them precious time they can use for constantly improving R,
  and will typically also result in much quicker feedback for yourself.

  Of course, in the case of bug reports it would be very helpful to have
  code which reliably reproduces the problem.

  The developers of R can be reached for comments and reports at
  R@stat.auckland.ac.nz.

  2.9.	What is CRAN?

  The ``Comprehensive R Archive Network'' (CRAN) is a collection of
  sites which carry identical material, consisting of the R
  distribution(s), the contributed extensions, documentation for R, and
  binaries.

  The CRAN master site can be found at the URL

       ftp://ftp.ci.tuwien.ac.at/pub/R/

  and is currently being mirrored daily at
       ftp://franz.stat.wisc.edu/pub/R/
       ftp://ftp.stat.math.ethz.ch/R-CRAN/

  Please use the CRAN site closest to you to reduce network load.

  The structure of the CRAN tree is as follows.

     `src/base'
	contains the official R distribution as provided by Ross Ihaka
	and Robert Gentleman.

     `src/contrib'
	contains code for extension packages.

     `doc'
	is for additional documentation and information on R.

     `bin'
	is for prebuilt R binaries (the base distribution and
	extensions), grouped according to platforms.  Currently, there
	are only experimental packages for Debian GNU/Linux.  I hope
	that `.tar.gz' files with contents relative to an installation
	tree (e.g. `bin', `lib/R/', and `man/man1/R.1') can be made
	available soon for all major supported Unix platforms.

  The process of ``submitting'' to CRAN currently is very simple: upload
  to ftp://ftp.ci.tuwien.ac.at/incoming and send email to Kurt Hornik
  <Kurt.Hornik@ci.tuwien.ac.at>.  Please indicate the copyright
  situation (GPL, ...) in your submission.

  3.  R and S

  3.1.	What Is S?

  S is a very high level language and an environment for data analysis
  and graphics.	S was written by Richard A. Becker, John M. Chambers,
  and Allan R. Wilks of AT&T Bell Laboratories Statistics Research
  Department.

  The primary references for S are two books by the creators of S.

  o  Richard A. Becker, John M. Chambers and Allan R. Wilks (1988),
     ``The New S Language,'' Chapman & Hall, London.

     This book is often called the ``Blue Book''.

  o  John M. Chambers and Trevor J. Hastie (1992), ``Statistical Models
     in S,'' Chapman & Hall, London.

     This is also called the ``White Book''.

  There is a huge amount of user-contributed code for S, available at
  the S Repository at CMU.

  See the ``Frequently Asked Questions about S''
  (http://lib.stat.cmu.edu/S/faq) for further information about S.

  3.2.	What Is S-PLUS?

  S-PLUS is a value-added version of S sold by Statistical Sciences,
  Inc. (now a division of Mathsoft, Inc.)  S is a subset of S-PLUS, and
  hence anything which may be done in S may be done in S-PLUS.	In
  addition S-PLUS has extended functionality in a wide variety areas,
  including robust regression, modern nonparametric regression, time
  series, survival analysis, multivariate analysis, classical
  statistical tests, quality control, and graphics drivers.  Add-on
  modules add additional capabilities for wavelet analysis, spatial
  statistics, and design of experiments.

  See the MathSoft S-PLUS page (http://www.mathsoft.com/splus.html) for
  further information.

  3.3.	What Are the Differences between R and S?

  Whereas the developers of R have tried to stick to the S language as
  defined in ``The New S Language'' (Blue Book, see question ``What is
  S?''), they have adopted the evaluation model of Scheme.

  This difference becomes manifest when free variables occur in a
  function.  Free variables are those which are neither formal
  parameters (occurring in the argument list of the function) nor local
  variables (created by assigning to them in the body of the function).
  Whereas S (like C) by default uses static scoping, R (like Scheme) has
  adopted lexical scoping.  This means the values of free variables are
  determined by a set of global variables in S, but in R by the bindings
  that were in effect at the time the function was created.

  Consider the following function:

       cube <- function(n) {
	 sq <- function() n * n
	 n * sq()
       }

  Under S, sq() does not ``know'' about the variable n unless it is
  defined globally:

       S> cube(2)
       Error in sq():  Object "n" not found
       Dumped
       S> n <- 3
       S> cube(2)
       [1] 18

  In R, the ``environment'' created when cube() was invoked is also
  looked in:

       R> cube(2)
       [1] 8

  Both R and S employ the principle of lazy evaluation, meaning that
  expressions are evaluated only when their values are needed in
  computations.	As one consequence of the above, S sometimes evaluates
  assignments in function argument lists (named arguments) immediately.
  I.e., S uses eager evaluation in these cases.	R always uses lazy
  evaluation.  (Folks, correct me if I am wrong here, but I think this
  was what caused Martin's function plot.step() to behave differently
  under R and S.)

  Lexical scoping allows using function closures and maintaining local
  state.  A simple example (taken from Abelson and Sussman) can be found
  in the `demos/language' subdirectory of the R distribution.  Further
  information is provided in the standard R reference ``R: A Language
  for Data Analysis and Graphics'' (see question ``Which Documentation
  Exists for R?'') and a paper on ``Lexical Scope and Statistical
  Computing'' by Robert Gentleman and Ross Ihaka which can be obtained
  from the `doc/misc' directory of a CRAN site.

  Lexical scoping also implies a further major difference.  Whereas S
  stores all objects as separate files in a directory somewhere (usually
  `.Data' under the current directory), R does not.  All objects in R
  are stored internally.  When R is started up it grabs a very large
  piece of memory and uses it to store the objects.  R performs its own
  memory management of this piece of memory.  Having everything in
  memory is necessary because it is not really possible to externally
  maintain all relevant ``environments'' of symbol/value pairs.	This
  difference also seems to make R much faster than S.

  The down side is that if R crashes you will lose all the work for the
  current session.  Saving and restoring the memory ``images'' (the
  functions and data stored in R's internal memory at any time) can be a
  bit slow, especially if they are big.	In S this does not happen,
  because everything is saved in disk files and if you crash nothing is
  likely to happen to them.  R is still in an alpha stage, and does
  crash from time to time.  Hence, for important work you should
  consider saving often, see question ``How Can I Save My Workspace?''
  (other possibilities are logging your sessions, or have your R
  commands stored in text files which can be read in using source()).

  Apart from lexical scoping and its implications, R follows the S
  language definition in the Blue Book as much as possible, and hence
  really is an ``implementation'' of S.	There are some intentional
  differences where the behavior of S is considered ``not clean''.  In
  general, the rationale is that R should help you detect programming
  errors, while at the same time being as compatible as possible with S.

  Some known differences are the following.

  o  In R, if x is a list, then x[sub] <- NULL and x[[sub]] <- NULL
     remove the specified elements from x.  The first of these is
     incompatible with S, where it is a no-op.

  o  In S, the functions named .First and .Last in the `.Data' directory
     can be used for customizing, as they are executed at the very
     beginning and end of a session, respectively.  R looks for files
     called `.Rprofile' in the user's home directory and the current
     directory, and sources these.  (It also loads a saved image from
     `.RData' in case there is one.)  If a .First function exists then,
     it is executed.  The .Last mechanism is not supported yet.

  o  Attaching library sections works differently.  In S, library(name)
     adds the data directory for the library section name to the search
     list.  If a function object named `.First.lib' exists in the
     directory, it is executed; this is typically used to dynamically
     load compiled code required by the functions in the section.  In R,
     library(name) currently simply sources the file
     $RHOME/library/name, and compiled code can be loaded by calling
     library.dynam() in this file.  The .First.lib mechanism is not
     really supported.	(Note that a library file is only loaded once,
     so that any code in the library that is not in a function is
     executed the first time the library is loaded.)

  o  R does not try as hard as S to preserve dimnames attributes
     (examples are apply, rbind, and cbind, but also arithmetic ops).

  o  R presently does not support IEEE Inf and NaN.

  o  In R, attach currently only works for lists and data frames (not
     for directories).

  o  Categories do not exist in R, and never will as they are deprecated
     now in S.	Use factors instead.

  o  In R, For() loops are not necessary and hence not supported.

  o  In R, assign() uses the argument envir= rather than where= as in S.

  o  The random number generators are different, and the seeds have
     different length.

  o  The glm family objects are implemented differently in R and S.  The
     same functionality is available but the components have different
     names.

  o  terms objects are stored differently.  In S a terms object is an
     expression with attributes, in R it is a formula with attributes.
     The attributes have the same names but are mostly stored
     differently.  The major difference in functionality is that a terms
     object is subscriptable in S but not in R.	If you can't imagine
     why this would matter then you don't need to know.

  There are also differences which are not intentional, and result from
  missing or incorrect code in R.  The developers would appreciate
  hearing about any deficiencies you may find (in a written report fully
  documenting the difference as you see it).  Of course, it would be
  useful if you were to implement the change yourself and make sure it
  works.

  4.  R Add-On Packages

  4.1.	Which Add-on Packages Exist for R?

  The R distribution comes with the following extra libraries:

     eda
	Exploratory Data Analysis.  Currently only contains functions
	for robust line fitting, and median polish and smoothing.

     mva
	Multivariate Analysis.	Currently contains code for principal
	components (prcomp), canonical correlations (cancor),
	hierarchichal clustering (hclust), and metric multidimensional
	scaling (cmdscale).  More functions for clustering and scaling,
	biplots, profile and star plots, and code for ``real''
	discriminant analysis will be added soon.

  The following packages are available from the CRAN `src/contrib' area.

     acepack
	ace (Alternating Conditional Expectations) and avas (Additivity
	and variance stabilization for regression) for selecting
	regression transformations.

     bootstrap
	Software (bootstrap, cross-validation, jackknife), data and
	errata for the book ``An Introduction to the Bootstrap'' by B.
	Efron and R. Tibshirani, 1993, Chapman and Hall.

     ctest
	A library of classical tests, including the Bartlett, Fisher,
	Kruskal-Wallis, Kolmogorov-Smirnov, and Wilcoxon tests.

     date
	Functions for dealing with dates.  The most useful of them
	accepts a vector of input dates in any of the forms 8/30/53,
	30Aug53, 30 August 1953, ..., August 30 53, or any mixture of
	these.

     e1071
	Miscellaneous functions used at the Department of Statistics at
	TU Wien (E1071).

     fracdiff
	Maximum likelihood estimation of the parameters of a
	fractionally differenced ARIMA(p,d,q) model (Haslett and
	Raftery, Applied Statistics, 1989).

     gee
	An implementation of the Liang/Zeger generalized estimating
	equation approach to GLMs for dependent data.

     jpn
	A function to plot Japan's coast-line and prefecture boundaries.

     oz Functions for plotting Australias coastline and state
	boundaries.

     snns
	An R interface to the Stuttgart Neural Networks Simulator
	(SNNS).

     splines
	Regression spline functions.

     survival4
	Functions for survival analysis (requires splines).

  See CRAN `src/contrib/INDEX' for more information.

  Paul Gilbert <pgilbert@bank-banque-canada.ca> has a written a
  multivariate time series library for S called time.series that is
  mostly converted to run in R.	He will make this port generally
  available when complex numbers are implemented (see question ``What is
  the current version of R?'').

  According to Paul, the PADI interface from the Bank of Canada also
  works with minor changes.  PADI can be used to access Fame time series
  data bases and potentially other databases, even remotely over the
  Internet.  For further information see http:www.bank-banque-
  canada.ca/pgilbert.

  According to Arne Kovac <A.Kovac@Bristol.ac.uk>, Guy Nason's
  WaveThresh package for S worked with only minor modifications under R
  version 0.12.
  More code has been posted to the r-help mailing list, and can be
  obtained from the mailing list archive.

  4.2.	How Can Add-on Packages Be Installed?

  (Unix only.)	Untar the add-on packages in $RHOME/src/library/ and
  type

       $ make libs
       $ cd ../..
       $ ./etc/install-libhelp

  at the shell prompt.

  4.3.	How Can Add-on Packages Be Used?

  To find out which add-ons have already been installed, type

       R> library()

  at the R prompt.  This produces something like

       NAME	    DESCRIPTION
       acepack	 ace() and avas() for selecting regression transformations
       bootstrap       Functions for the book "An Introduction to the Bootstrap"
       ctest	   Classical Tests
       date	    Functions for handling dates
       eda	     Exploratory Data Analysis
       fracdiff	Fractionally differenced ARIMA (p,d,q) models
       gee	     Generalized Estimating Equation models
       mva	     Classical Multivariate Analysis
       splines	 Regression spline functions
       survival4       Survival analysis [needs library(splines)]

  You can ``load'' an add-on with name name by

       R> library(name)

  You can then find out which functions it provides by typing

       R> help(library = name)

  4.4.	How Can I Contribute to R?

  R is currently still in alpha (or pre-alpha) state, so simply using it
  and communicating problems is certainly of great value.
  One place where functionality is still missing is the modeling
  software as described in ``Statistical Models in S'' (see question
  ``What is S?''.  The functions

	add1 kappa alias labels drop1 proj

  are missing; many of these are interpreted functions so anyone that is
  bored and wants to have a go at implementing them it would be appreci-
  ated.	In addition, only linear and generalized linear models are cur-
  rently available, aov, gam, loess, tree, and the nonlinear modelling
  code are not there yet.

  Many of the packages available at the Statlib S Repository might be
  worth porting to R.

  If you are interested in working on any of these projects, please
  notify Kurt Hornik.

  5.  R and Emacs

  5.1.	Is there Emacs Support for R?

  There is an Emacs-Lisp interface to S/S-PLUS called S-mode.  Its
  current version is 4.8 and can be obtained at
  http://www.maths.lancs.ac.uk:2080/~maa036/elisp/S-mode/.  The earlier
  versions which can be found at the Statlib S repository (gnuemacs3 and
  gnuemacs4) are outdated.

  It contains code for interacting with an inferior S process from
  within Emacs including an interface to the help system, editing S
  source code, and transcript manipulation, and comes with detailed
  instructions for installation.

  Martin Maechler <maechler@stat.math.ethz.ch> and Tony Rossini
  <rossini@math.sc.edu> have integrated support for R into this package.
  The current version is at

       ftp://ftp.math.sc.edu/rossini/S-mode-4.8.MM6.XE2.tar.gz

  and runs under both GNU Emacs and XEmacs.

  To install, put the byte-compiled `.el' files into a place where Emacs
  can find them, and add

       (if (not (assoc "\\.R$" auto-mode-alist)
	   (add-to-list 'auto-mode-alist (cons "\\.R$" 'R-mode))))
       (autoload 'R "S" "Run an inferior R process" t)
       (autoload 'R-mode "S" "Mode for editing R source" t)
       (autoload 'r-mode "S" "Mode for editing R source" t)

  to one of your Emacs startup files, typically `~/.emacs'.  You can
  then fire up R from within Emacs by typing `M-x R' (note however that
  many interface functions will not work), and if you use the extension
  `.R' for your files with R code, Emacs will automagically turn on R
  edit mode whenever you visit such a file.

  Tony Rossini, Martin Maechler and Kurt Hornik have officially taken
  over the development of S-mode.  Version 4.9 (based on the current
  4.8.MM series) will be released shortly;  version 5.0 (codenamed
  ``istat'') should be out by the end of 1997.

  5.2.	Should I Run R from Within Emacs?

  Yes.	Inferior R mode provides a readline/history mechanism, object
  name completion, and syntax-based highlighting of the interaction
  buffer using Font Lock mode, as well as a very convenient interface to
  the R help system.  Of course, it also integrates nicely with the
  mechanisms for editing R source using Emacs.

  6.  R Miscellania

  6.1.	How Can I Read a Large Data Set into R?

  R (currently) uses a static memory model.  This means that when it
  starts up, it asks the operating system to reserve a fixed amount of
  memory for it.  The size of this chunk cannot be changed subsequently.
  Hence, it can happen that not enough memory was allocated.

  In these cases, you should restart R with more memory available, using
  the command line options -n and -v.  To understand these options, one
  needs to know that R maintains separate areas for fixed and variable
  sized objects.  The first of these is allocated as an array of
  SEXPRECs assembled in a list using ``cons cells'' (ordered pairs each
  containing an element of the list and a pointer to the next cell), and
  the second as an array of VECRECs.  The -n option can be used to
  specify the number of cons cells (each occupying 16 bytes) which R is
  to use (the default is 200000), and the -v option to specify the size
  of the vector heap in megabytes (the default is 2).  Only integers are
  allowed for both options.

  E.g., to read in a table of 5000 observations on 40 numeric variables,
  R -v 6 should do.

  Note that the information where to find vectors and strings on the
  heap is stored using cons cells.  Thus, it may also be necessary to
  allocate more space for cons cells in order to perform computations
  with very ``large'' variable-size objects.

  You can find out the current memory comsumption by typing gc() at the
  R prompt.

  6.2.	Why Can't R Source a `Correct' File?

  R sometimes has problems parsing a file which does not end in a
  newline.  This can happen for example when Emacs is used for editing
  the file and next-line-add-newlines is set to nil.  To avoid the
  problem, either set require-final-newline to a non-nil value in one of
  your Emacs startup files, or make sure R-mode (see question ``Is there
  Emacs Support for R?'') is used for editing R source files (which
  locally ensures this setting).

  Earlier R versions had a similar problem when reading in data files,
  but this should have been taken care of now.

  6.3.	How Can I Set Components of a List to NULL?

  You can use

       x[i] <- list(NULL)

  to set component i of the list x to NULL, similarly for named compo-
  nents.  Do not set x[i] or x[[i]] to NULL, because this will remove
  the corresponding component from the list.

  For dropping the row names of a matrix x, it may be easier to use
  rownames(x) <- NULL, similarly for column names.

  6.4.	How Can I Save My Workspace?

  The expression

       save(list = ls(), file = ".RData")

  saves the objects in the currently active environment (typically the
  user's .GlobalEnv) to the file `.RData' in the R startup directory.

  6.5.	How Can I Clean Up My Workspace?

  To remove all objects in the currently active environment (typically
  the user's .GlobalEnv), you can do

       rm(list = ls())

  7.  Acknowledgments

  Of course, many many thanks to Robert and Ross for the R system, and
  to the package writers and porters for adding to it.

  Special thanks go to Peter Dalgaard, Paul Gilbert, Martin Maechler,
  and Anthony Rossini for their comments which helped me improve this
  FAQ.

  More to some soon ...

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Friedrich.Leisch@ci.tuwien.ac.at  Wed Apr 16 17:17:25 1997
From: Friedrich.Leisch@ci.tuwien.ac.at (Friedrich Leisch)
Date: Wed, 16 Apr 1997 18:17:25 +0200
Subject: R-alpha: data in contributed packages
Message-ID: <199704161617.SAA14180@galadriel.ci.tuwien.ac.at>


I know, we've discussed this several times in the good old days days
of the R-testers list :-), but the problem is still unsolved.

I want to include Tibshirani's data in my port of the bootstrap
package, but we still have no way of including data in a clean way.

IMHO we should have a subdirectory of $RHOME/data for each library,
e.g.
	$RHOME/data/base
	$RHOME/data/bootstrap

Actually that's the setup we are currently using here in Vienna.

We've modified the filename script to reflect that changes (which also
allows users to have a R hierarchy with library, data, etc in
~/lib/R):


*********** original filename *********** =20

#!/bin/sh

file=3D$RHOME/$1/$2

if [ -r $file ]
then
        echo $file
else
        echo
fi



*********** our filename *********** =20

#!/bin/sh

for file in $HOME/lib/R/$1/$2 \         # user R hierarchy
            $RHOME/$1/$2 \              # standard dirs
            $RHOME/$1/[^.]*/$2;         # one level of subdirs
do
    if [ -r $file ]
    then
        echo $file
        break
    fi
done

if [ ! -r $file ]
then
    echo
fi


****************************

Any comments, ... ?

Best,
Fritz

PS: In a best of all possible worlds one should of course have some
recursive searching like in TeX :-)

--=20
---------------------------------------------------------------------
                         Friedrich  Leisch                            =20
 Institut f=FCr Statistik                      Tel: (+43 1) 58801 4541
 Technische Universit=E4t Wien                 Fax: (+43 1)  504 14 98
 Wiedner Hauptstra=DFe 8-10/1071      Friedrich.Leisch@ci.tuwien.ac.at
 A-1040 Wien, Austria             http://www.ci.tuwien.ac.at/~leisch
      PGP public key http://www.ci.tuwien.ac.at/~leisch/pgp.key
---------------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Thu Apr 17 10:05:11 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Thu, 17 Apr 1997 11:05:11 +0200
Subject: R-alpha: R-0.50.b6:  bug in graphics demo
Message-ID: <199704170905.LAA14424@aragorn.ci.tuwien.ac.at>

The line
  contour(volcano, x, y, l, col = "yellow", lty = "solid", add = TRUE)
needs to be changed to
  contour(x, y, volcano, col = "yellow", lty = "solid", add = TRUE)

A patch is appended below.

-k

*** demos/graphics/graphics.orig	Thu Apr 17 11:02:39 1997
--- demos/graphics/graphics	Thu Apr 17 11:03:08 1997
*************** plot(numeric(0), numeric(0), NULL,
*** 129,135 ****
  	type="n", ann=FALSE)
  usr <- par("usr")
  rect(usr[1], usr[3], usr[2], usr[4], col="green3")
! contour(volcano, x, y, l, col="yellow", lty="solid", add=TRUE)
  box()
  title("A Topographic Map of Maunga Whau",font=4)
  title(xlab="Meters North", ylab="Meters West", font=3)
--- 129,135 ----
  	type="n", ann=FALSE)
  usr <- par("usr")
  rect(usr[1], usr[3], usr[2], usr[4], col="green3")
! contour(x, y, volcano, col="yellow", lty="solid", add=TRUE)
  box()
  title("A Topographic Map of Maunga Whau",font=4)
  title(xlab="Meters North", ylab="Meters West", font=3)
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Thu Apr 17 10:33:40 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 17 Apr 1997 11:33:40 +0200
Subject: R-alpha: R-0.50.b6:  bug in graphics demo
In-Reply-To: Kurt Hornik's message of Thu, 17 Apr 1997 11:05:11 +0200
References: <199704170905.LAA14424@aragorn.ci.tuwien.ac.at>
Message-ID: <x2encaxabv.fsf@bush.kubism.ku.dk>

Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

> 
> The line
>   contour(volcano, x, y, l, col = "yellow", lty = "solid", add = TRUE)
> needs to be changed to
>   contour(x, y, volcano, col = "yellow", lty = "solid", add = TRUE)
> 

The help file for image() has the same problem, both in the USAGE and
EXAMPLES section. And while we're at it: the ALIASes should contain
"contour", not "image", right?

BTW: Ross seems to have quietly put out an R7.tgz (compiling as I type
this) and forgotten to tell us about it...

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Thu Apr 17 11:12:44 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 17 Apr 1997 12:12:44 +0200
Subject: R-alpha: fitted = 0 of 1 in logistic regression
Message-ID: <x2d8rux8ir.fsf@bush.kubism.ku.dk>


TASK:   problem with "glm" with binomial errors
STATUS: Open
FROM:   p.dalgaard@kubism.ku.dk
        in glm(,binomial) it's possible that loss of significant
        digits make expected values 0 or 1 even though there's no
        divergence of the fit.  (Happened to me with menarche data,
        infants and grown-ups included)
        [ Need the example data.  Glm needs a complete overhaul. ]

OK, here's a way to fake some data (simulated as if menarche occurs
uniformly between 10 an 15 years of age) There's no real problem with
fitting a logistic regression to this, but the logistic curve gets too
close to 0 and 1 for the very young and the very old.

BTW: rbinom gives NA for p=0 and p=1, which causes some problems with
the simulations. 
BTW2: Doesn't "occurred" take a double r?

> fake.age<-runif(500,0,50)
> fake.menarche<-rbinom(500,1,.99999 *(fake.age > 15) + .99999 * (fake.age > 10 & fake.age <= 15)/5 * (fake.age - 10)+.000005)
> glm(fake.menarche~fake.age,binomial)
Error: fitted probabilities of 0 or 1 occured
> fake2.age<-fake.age[fake.age<25&fake.age>5]
> fake2.menarche<-fake.menarche[fake.age<25&fake.age>5]
> glm(fake2.menarche~fake2.age,binomial)

Call:  glm(fake2.menarche ~ fake2.age, binomial) 

Coefficients:
(Intercept)    fake2.age  
   -15.1061       1.2011  

Degrees of Freedom: 189 Total; 187 Residual
Null Deviance: 253.9 
Residual Deviance: 48.73 
> 


-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Thu Apr 17 11:36:03 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Thu, 17 Apr 1997 22:36:03 +1200 (NZST)
Subject: R-alpha: R-0.50.b6:  bug in graphics demo
Message-ID: <199704171036.WAA08581@stat1.stat.auckland.ac.nz>

> BTW: Ross seems to have quietly put out an R7.tgz (compiling as I type
> this) and forgotten to tell us about it...

Don't expect much difference.  That was just so that Martin M could
check whether configuration and compilation with Fortran would work
under Solaris.

If you people would just stop finding bugs, I could a real version
ready ... :-).  We have a week break from teaching next week.  So
if not tomorrow, hopefully then.

[ Actually I have to confess I've been playing networks - getting a PPP
  connection from home going.  Which is what I'm using at present.
  Infinitely nicer than using "tip". ]
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Thu Apr 17 15:09:36 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Thu, 17 Apr 1997 16:09:36 +0200
Subject: R-alpha: R-0.50.b6:  bug in graphics demo
In-Reply-To: <199704171036.WAA08581@stat1.stat.auckland.ac.nz>
References: <199704171036.WAA08581@stat1.stat.auckland.ac.nz>
Message-ID: <199704171409.QAA25593@aragorn.ci.tuwien.ac.at>

>>>>> Ross Ihaka writes:

>> BTW: Ross seems to have quietly put out an R7.tgz (compiling as I type
>> this) and forgotten to tell us about it...

> Don't expect much difference.  That was just so that Martin M could
> check whether configuration and compilation with Fortran would work
> under Solaris.

And nevertheless, my bug log got almost halved ...

> If you people would just stop finding bugs, I could a real version
> ready ... :-).  We have a week break from teaching next week.  So
> if not tomorrow, hopefully then.

O.k.  I PROMISE I won't send any more bug reports, as I am dying to see
0.50 out :-)

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Thu Apr 17 15:43:33 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 17 Apr 1997 16:43:33 +0200
Subject: R-alpha: The list of *open* tasks
In-Reply-To: Kurt Hornik's message of Thu, 17 Apr 1997 16:09:36 +0200
References: <199704171036.WAA08581@stat1.stat.auckland.ac.nz>
 <199704171409.QAA25593@aragorn.ci.tuwien.ac.at>
Message-ID: <x2n2qxsoa1.fsf_-_@bush.kubism.ku.dk>

Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

> And nevertheless, my bug log got almost halved ...

Apropos bug logs. It's getting a bit boring to wade through all of the
bugs in the TASKS file that have already been fixed. Here's a little
something I cooked up earlier today: 

---------------------------cut------
#!/bin/sh
awk '
/^TASK/                         {task = $0}
/^STATUS/ && $2~/[Oo]pen/       {print task; doprint=1}
doprint 
/^-------/                      {doprint=0}' TASKS
---------------------------cut------

Put into (say) list-open-tasks in the $RHOME and chmod +x. Execute
from $RHOME.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From la-jassine@aix.pacwan.net  Fri Apr 18 10:33:09 1997
From: la-jassine@aix.pacwan.net (Paul Gilbert)
Date: Fri, 18 Apr 1997 06:33:09 -0300
Subject: R-alpha: data in contributed packages
Message-ID: <1350716654-1304675@aix.pacwan.net>

Friedrich

Regarding the location of data for libraries it might be easier if
everything for one library is included in one subdirectory. At least it
would certainly be easier to clean-up, which I like to do every few years.
Thus the code file, data, and any compiled code would be in one subdirectory
under $RHOME/library. 

I realize this means a small change to the way libraries are now found, but
in the end I think it would be much cleaner.

Paul

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Sun Apr 20 17:40:06 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 20 Apr 1997 18:40:06 +0200
Subject: R-alpha: Playing the tag game
Message-ID: <x2rag5r6l5.fsf@bush.kubism.ku.dk>

Here are a handful of oddities in pre0.50-7 (at some risk of reprisals
from people waiting for the real 0.50...):

I was mucking about trying to figure out how to know which tags has
been used in a function call, and some weird stuff happened.

----------
A call with tagged arguments is something like a list, the tags
can be used to access elements, but the names attribute is absent,
until the call is coerced to a list. (Attempting to set the names()
causes evaluation. Changing "list" to "blipblop" causes an 'Error:
couldn't find function "blipblop"' at that point.)

> j<-substitute(list(a=1,b=2))
> j
list(a = 1, b = 2)
> j$b
[1] 2
> names(j)
NULL
> names(j)<-NULL
> j
[[1]]
[1] 1

[[2]]
[1] 2
-----------
This one is plainly a bug. Meaningless, but...

[Previously saved workspace restored]

> j<-as.call(list(a=1,b=2))
> j
Segmentation fault (core dumped)
------------
Strange... as.call should return its argument if is.call is true?

> j<-substitute(list(a=1,b=2))
> j
list(a = 1, b = 2)
> as.call(j)
Error in as.call(j) : invalid argument list
> is.call(j)
[1] TRUE

------------
Ok, the right solution seems to be names(as.list(j)), but then we run
into some other fun with NA's... Shouldn't the real NA print without
quotes?

> ch[1]<-paste("N","A",sep="") 
> is.na(ch)
[1] FALSE FALSE FALSE
> ch
[1] "NA" "a"  "b" 
> ch[1]=="NA"
[1] TRUE
> ch[1]<-"NA"                 
> is.na(ch)
[1]  TRUE FALSE FALSE
> 

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Sun Apr 20 21:43:35 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Mon, 21 Apr 1997 08:43:35 +1200 (NZST)
Subject: R-alpha: Playing the tag game
Message-ID: <199704202043.IAA28435@stat1.stat.auckland.ac.nz>

	Here are a handful of oddities in pre0.50-7 (at some risk of reprisals
	from people waiting for the real 0.50...):

I don't know that these will even be looked at before 0.49 :-) comes
out.  I'm checking portabity and configuration at present.  It would
be REALLY nice if commercial vendors could stick to the standards
(ANSI, POSIX ...) as well as the free software developers do.

	I was mucking about trying to figure out how to know which tags has
	been used in a function call, and some weird stuff happened.

	----------
	A call with tagged arguments is something like a list, the tags
	can be used to access elements, but the names attribute is absent,
	until the call is coerced to a list. (Attempting to set the names()
	causes evaluation. Changing "list" to "blipblop" causes an 'Error:
	couldn't find function "blipblop"' at that point.)

	> j<-substitute(list(a=1,b=2))
	> j
	list(a = 1, b = 2)
	> j$b
	[1] 2
	> names(j)
	NULL
	> names(j)<-NULL
	> j
	[[1]]
	[1] 1

	[[2]]
	[1] 2

This is an oversight, and should have a one line fix (add extra cases
to an existing switch).

	[Previously saved workspace restored]

	> j<-as.call(list(a=1,b=2))
	> j
	Segmentation fault (core dumped)
	------------
	Strange... as.call should return its argument if is.call is true?

	> j<-substitute(list(a=1,b=2))
	> j
	list(a = 1, b = 2)
	> as.call(j)
	Error in as.call(j) : invalid argument list
	> is.call(j)
	[1] TRUE

"as.call" is pretty new and unexercised.

	Ok, the right solution seems to be names(as.list(j)), but then we run
	into some other fun with NA's... Shouldn't the real NA print without
	quotes?

	> ch[1]<-paste("N","A",sep="") 
	> is.na(ch)
	[1] FALSE FALSE FALSE
	> ch
	[1] "NA" "a"  "b" 
	> ch[1]=="NA"
	[1] TRUE
	> ch[1]<-"NA"                 
	> is.na(ch)
	[1]  TRUE FALSE FALSE
	> 

You naughty boy! :-)  I've have always thought that using "NA" to
indicate a missing string value was asking for problems.  What happens
when some poor unsuspecting user starts abbreviating "North America"
for example.

We use a bottleneck at string creation time to check whether the string
being stored is "NA".  If it is, we return the address of a special
unique string.  That way we can check for NA by simply doing an address
comparison rather than a string comparison (this is the same trick we
use for comparing variable names).  This doesn't catch "NA" strings
made in the underhand fashion above.

I see a couple of possible solutions.

1.  Remain compatible with S and just unoptimise our detection of
    string NAs.

2.  Be incompatible with S and introduce a real NA for strings.
    This would print as NA rather than "NA".  I like this second
    solution, but its does violate the "prime directive" (be
    compatible).

Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Tue Apr 22 13:08:08 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 22 Apr 1997 14:08:08 +0200
Subject: R-alpha: data in contributed packages
In-Reply-To: <1350716654-1304675@aix.pacwan.net>
References: <1350716654-1304675@aix.pacwan.net>
Message-ID: <199704221208.OAA00678@aragorn.ci.tuwien.ac.at>

>>>>> Paul Gilbert writes:

> Friedrich

> Regarding the location of data for libraries it might be easier if
> everything for one library is included in one subdirectory. At least
> it would certainly be easier to clean-up, which I like to do every few
> years.  Thus the code file, data, and any compiled code would be in
> one subdirectory under $RHOME/library.

Like

	library/<section>/
	library/<section>/data
	library/<section>/exec		(scripts and or binaries which
					 only make sense for the add-on)
	library/<section>/funs
	library/<section>/help
	library/<section>/html
	library/<section>/objs		(*.so)

???

> I realize this means a small change to the way libraries are now
> found, but in the end I think it would be much cleaner.

I think the changes would not be too hard, and we need to do something
about the directory structure anyway.

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Apr 22 14:07:28 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 22 Apr 97 15:07:28 +0200
Subject: R-alpha:  contributed packages -- Yes, use library/<package>/.. !
Message-ID: <9704221307.AA01047@>


>>>>> "Kurt" == Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

>>>>> Paul Gilbert writes:
    >> Friedrich

    >> Regarding the location of data for libraries it might be easier if
    >> everything for one library is included in one subdirectory. At least
    >> it would certainly be easier to clean-up, which I like to do every
    >> few years.  Thus the code file, data, and any compiled code would be
    >> in one subdirectory under $RHOME/library.

    Kurt> Like

    Kurt> library/<section>/
    Kurt> library/<section>/data
    Kurt> library/<section>/exec		(scripts and or binaries which
    Kurt> 				         only make sense for the add-on)
    Kurt> library/<section>/funs
    Kurt> library/<section>/help
    Kurt> library/<section>/html
    Kurt> library/<section>/objs		(*.so)

    Kurt> ???

    >> I realize this means a small change to the way libraries are now
    >> found, but in the end I think it would be much cleaner.

I agree completely.

Kurt, you surely feel like doing it for us ... ;-)

-- Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Tue Apr 22 14:50:43 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 22 Apr 1997 15:50:43 +0200
Subject: R-alpha: lazy evaluation and plot.step()
Message-ID: <199704221350.PAA01188@aragorn.ci.tuwien.ac.at>

Today I received an email which made me realize that what I wrote in the
FAQ explaining the different behavior of Martin's plot.step() under R
and S is not really true.

Does someone understand what is going on in the following?

"test" <-
function(x, y, xlab = deparse(substitute(x)), ylab = deparse(substitute(y)))
{
  x <- sort(x)
  print(xlab)
  n <- length(x)
  y <- (1:n) / n
  print(ylab)
}

Under R,

R> test(4:1)
[1] "c(1, 2, 3, 4)"
[1] "c(0.25, 0.5, 0.75, 1)"
R> test(4:1, 4)
[1] "c(1, 2, 3, 4)"
[1] "c(0.25, 0.5, 0.75, 1)"

Under S,

> test(4:1)
[1] "4:1"
[1] ""
[1] ""
> test(4:1, 4)
[1] "4:1"
[1] "c(0.25, 0.5, 0.75, 1)"
[1] "c(0.25, 0.5, 0.75, 1)"

???

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Tue Apr 22 16:18:46 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 22 Apr 1997 17:18:46 +0200
Subject: R-alpha: lazy evaluation and plot.step()
In-Reply-To: Kurt Hornik's message of Tue, 22 Apr 1997 15:50:43 +0200
References: <199704221350.PAA01188@aragorn.ci.tuwien.ac.at>
Message-ID: <x2u3kz9jc9.fsf@bush.kubism.ku.dk>


The explanation seems to be in different behaviour of the
substitute(...) construction:

R:
> f<-function(a,b){a<-1; print(deparse(substitute(c(a,b))))}
> f(a,b)
[1] "c(1, b)"

Splus:
> f<-function(a,b){a<-1; print(deparse(substitute(c(a,b))))}
> f(a,b)
[1] "c(a, b)"
[1] "c(a, b)"

So in R, assignment to a formal parameter causes the changed value to
be used for substitution purposes.

In S, this does not happen *unless the formal parameter is a
constant.*!

> f(2,b)
[1] "c(1, b)"
[1] "c(1, b)"
> f(2:2,b)
[1] "c(2:2, b)"
[1] "c(2:2, b)"
> f("a",b)    
[1] "c(1, b)"
[1] "c(1, b)"

This is confusing in both languages, but I'd say that S has the bigger
problem...

In Kurts example, inserting 

xlab 
ylab

as the first two lines of the function defeats lazy evaluation and
provides the desired behaviour (I suppose) in both R and S.

	- Peter

----

Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

> "test" <-
> function(x, y, xlab = deparse(substitute(x)), ylab = deparse(substitute(y)))
> {
>   x <- sort(x)
>   print(xlab)
>   n <- length(x)
>   y <- (1:n) / n
>   print(ylab)
> }
> 
> Under R,
> 
> R> test(4:1)
> [1] "c(1, 2, 3, 4)"
> [1] "c(0.25, 0.5, 0.75, 1)"
> R> test(4:1, 4)
> [1] "c(1, 2, 3, 4)"
> [1] "c(0.25, 0.5, 0.75, 1)"
> 
> Under S,
> 
> > test(4:1)
> [1] "4:1"
> [1] ""
> [1] ""
> > test(4:1, 4)
> [1] "4:1"
> [1] "c(0.25, 0.5, 0.75, 1)"
> [1] "c(0.25, 0.5, 0.75, 1)"
> 
> ???


-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Tue Apr 22 16:43:29 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 22 Apr 1997 17:43:29 +0200
Subject: R-alpha: binom.test
Message-ID: <199704221543.RAA01232@aragorn.ci.tuwien.ac.at>

I just realized that I got the code for the p-value (two-sided case) of
my ctest's binom.test wrong (again).  Anyway, before I fix that:  does
anyone know why S binom.test computes the p-value as it does?  (Any
references?)

Thanks,
-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Tue Apr 22 17:13:29 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 22 Apr 1997 18:13:29 +0200
Subject: R-alpha:  contributed packages -- Yes, use library/<package>/.. !
In-Reply-To: <9704221307.AA01047@>
References: <9704221307.AA01047@>
Message-ID: <199704221613.SAA01350@aragorn.ci.tuwien.ac.at>

>>>>> Martin Maechler writes:

>>>>> "Kurt" == Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

>>>>> Paul Gilbert writes:
>>> Friedrich

>>> Regarding the location of data for libraries it might be easier if
>>> everything for one library is included in one subdirectory. At least
>>> it would certainly be easier to clean-up, which I like to do every
>>> few years.  Thus the code file, data, and any compiled code would be
>>> in one subdirectory under $RHOME/library.

Kurt> Like

Kurt> library/<section>/
Kurt> library/<section>/data
Kurt> library/<section>/exec		(scripts and or binaries which
Kurt>                                    only make sense for the add-on)
Kurt> library/<section>/funs
Kurt> library/<section>/help
Kurt> library/<section>/html
Kurt> library/<section>/objs		(*.so)

Kurt> ???

>>> I realize this means a small change to the way libraries are now
>>> found, but in the end I think it would be much cleaner.

> I agree completely.

:-)

> Kurt, you surely feel like doing it for us ... ;-)

Actually, I think if R&R ok'ed something like that, Fritz and I would
take a look.

(In a way, I NEED to do something like that anyway, because I promised
it for making an official Debian package ...)

Would it mean that we also employ the S library/section concept?

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Tue Apr 22 17:23:24 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 22 Apr 1997 18:23:24 +0200
Subject: R-alpha: Rprofiles
Message-ID: <x2sp0j9gcj.fsf@bush.kubism.ku.dk>

The x11() window can be a nuisance to have popping up at startup (esp.
on small screens) when you're not working with graphics. However,
currently you can't get rid of it without modifying the systemwide
Rprofile. 

Current logic is:

Run $RHOME/library/Rprofile
if ./.Rprofile exists
	run it
else if $HOME/.Rprofile exists
	run that
endif

I think it should be

Run $RHOME/library/Rsetup
if ./.Rprofile exists
	run it
else if $HOME/.Rprofile exists
	run that
else if $RHOME/library/Rprofile exists
	run that
endif

i.e. essential system initialisation goes in Rsetup, the rest in
Rprofile, which can be overridden by the user. Currently, the line

if(interactive()) x11()

is the candidate to move from one to the other. BTW, it really should read

if(interactive() && getenv("DISPLAY")!="") x11()

[BTW2: getenv() implemented using system()? is that really necessary?]
-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Tue Apr 22 17:30:52 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 22 Apr 1997 18:30:52 +0200
Subject: R-alpha: Rprofiles
In-Reply-To: <x2sp0j9gcj.fsf@bush.kubism.ku.dk>
References: <x2sp0j9gcj.fsf@bush.kubism.ku.dk>
Message-ID: <199704221630.SAA01413@aragorn.ci.tuwien.ac.at>

>>>>> Peter Dalgaard BSA writes:

> The x11() window can be a nuisance to have popping up at startup (esp.
> on small screens) when you're not working with graphics. However,
> currently you can't get rid of it without modifying the systemwide
> Rprofile. 

> Current logic is:

> Run $RHOME/library/Rprofile
> if ./.Rprofile exists
> 	run it
> else if $HOME/.Rprofile exists
> 	run that
> endif

> I think it should be

> Run $RHOME/library/Rsetup
> if ./.Rprofile exists
> 	run it
> else if $HOME/.Rprofile exists
> 	run that
> else if $RHOME/library/Rprofile exists
> 	run that
> endif

> i.e. essential system initialisation goes in Rsetup, the rest in
> Rprofile, which can be overridden by the user.

I more or less agree, BUT:

I'd like (in the future) to have the system-wide Rprofile searched in a
site-specific location as well (similar to Emacs, following the idea of
keeping the distribution and the site-specific things apart).

So it would be
	system-wide Rsetup (which should basically be platform-specific
	  stuff, cause otherwise it could go into base as well?)
        if .Rprofile exists run it else
	if ~/.Rprofile exists run it else
        if Rprofile exists on the default library search path, run it

and that search path could e.g. specify all `library' trees with a
compile-time default of

	~/lib/R:/usr/local/lib/R/site:/usr/local/lib/R/${version}

and settable at run time via e.g. the environment variable R_PATH.

> Currently, the line

> if(interactive()) x11()

> is the candidate to move from one to the other. BTW, it really should read

> if(interactive() && getenv("DISPLAY")!="") x11()

Correct.  We've been making the same change with all upgrades :-)

> [BTW2: getenv() implemented using system()? is that really necessary?]

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Tue Apr 22 17:33:36 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 22 Apr 1997 18:33:36 +0200
Subject: R-alpha: lazy evaluation and plot.step()
In-Reply-To: <x2u3kz9jc9.fsf@bush.kubism.ku.dk>
References: <199704221350.PAA01188@aragorn.ci.tuwien.ac.at>
 <x2u3kz9jc9.fsf@bush.kubism.ku.dk>
Message-ID: <199704221633.SAA01423@aragorn.ci.tuwien.ac.at>

>>>>> Peter Dalgaard BSA writes:

> The explanation seems to be in different behaviour of the
> substitute(...) construction:

> R:
>> f<-function(a,b){a<-1; print(deparse(substitute(c(a,b))))}
>> f(a,b)
> [1] "c(1, b)"

> Splus:
>> f<-function(a,b){a<-1; print(deparse(substitute(c(a,b))))}
>> f(a,b)
> [1] "c(a, b)"
> [1] "c(a, b)"

> So in R, assignment to a formal parameter causes the changed value to
> be used for substitution purposes.

> In S, this does not happen *unless the formal parameter is a
> constant.*!

>> f(2,b)
> [1] "c(1, b)"
> [1] "c(1, b)"
>> f(2:2,b)
> [1] "c(2:2, b)"
> [1] "c(2:2, b)"
>> f("a",b)    
> [1] "c(1, b)"
> [1] "c(1, b)"

> This is confusing in both languages, but I'd say that S has the bigger
> problem...

Not a surprise ...

Thanks, Peter, for the explanation.  Does this also explain the
different results for x <- sort(x)?

> In Kurts example, inserting 

> xlab 
> ylab

> as the first two lines of the function defeats lazy evaluation and
> provides the desired behaviour (I suppose) in both R and S.

Yes.  This is also what I suggested to Martin in order to have a version
of plot.step() which does the same under R and S.

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Wed Apr 23 07:45:30 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 23 Apr 1997 08:45:30 +0200
Subject: R-alpha: CRAN
Message-ID: <199704230645.IAA03912@aragorn.ci.tuwien.ac.at>

Just wanted to point out that statlib has also become an official CRAN
mirror with the URL

	http://lib.stat.cmu.edu/R/CRAN/

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Wed Apr 23 09:05:33 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 23 Apr 97 10:05:33 +0200
Subject: R-alpha: Re: R-beta: 0.50 --> 0.49 'available' ((official ???)
In-Reply-To: <9704230756.AA07463@alpha.luc.ac.be> (message from Jim Lindsey on
 Wed, 23 Apr 1997 09:56:34 +0200 (MET DST))
Message-ID: <9704230805.AA01351@>

Hi Jim,
	[CC: only to R-devel,
	  since I expect  R&R  to ANNOUNCE  0.49 OFFICIALLY
	  on  R-announce (and hence R-help)
	]

This night, our mirror software got version 0.49  (=?= pre-release of 0.50 ??)
from the usual R-ftp-directory from Auckland.

Ross & Robert:  You ARE going to announce this on R-announce, yes?

-- Martin
	
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Wed Apr 23 16:28:37 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 23 Apr 1997 17:28:37 +0200
Subject: R-alpha: Re: R-beta: Version 0.49 Released
In-Reply-To: <199704230925.VAA24453@stat1.stat.auckland.ac.nz>
References: <199704230925.VAA24453@stat1.stat.auckland.ac.nz>
Message-ID: <199704231528.RAA14692@aragorn.ci.tuwien.ac.at>

>>>>> Ross Ihaka writes:

> The newest version of R for Unix (version 0.49) is now available
> (or soon will be) from the following sites.

> ...

I noticed the following problems (all already reported, but not in
TASKS).

* TASKS.OLD has

FROM:   <Kurt.Hornik@ci.tuwien.ac.at>
        Btw, here's another way to produce a segfault with admittedly
        nonsense code:
                R> x <- 1:5
                R> dimnames(x)[1,2] <- NULL
                Segmentation fault
        [ Hmmm.  This seems to have gone away.  I get the error     ]
        [ message "Error: incorrect number of subscripts on array". ]

On my Linux system, I still get the segfault.  Perhaps others could
check that?

* File permissions in data should be 644.

* In src/unix/system.c, one `Rdata' should be `RData' (d -> D).

* The documentation for the noncentral chisquare distribution is not
quite correct.  (rnchisq does not exist, the existing functions have x,
df and the noncentrality parameter as args, and the density should be

   pnchisq(x, df, lambda)
   = exp(-lambda / 2)
     * sum_{r=0}^\infty \frac{lambda^r}{2^r r!} pchisq(x, df + 2r)

(semiTeX notation only, sorry).

******************

New minor remarks:

* The documentation for `image' still has the old order z, x, y.

* Perhaps one should add `par(ask = T)' in the image demo?

* Perhaps one should save the original value of par() at the beginning
of the graphics demo, and restore that at its end (s.t. typically asking
is turned off again).

******************

Overall, REALLY GREAT!  Thanks for putting out the official release ...

Best,
-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From rossini@stat.sc.edu  Wed Apr 23 16:45:29 1997
From: rossini@stat.sc.edu (Anthony Rossini)
Date: 23 Apr 1997 11:45:29 -0400
Subject: R-alpha: Re: R-beta: Version 0.49 Released
In-Reply-To: Kurt Hornik's message of Wed, 23 Apr 1997 17:28:37 +0200
References: <199704230925.VAA24453@stat1.stat.auckland.ac.nz> <199704231528.RAA14692@aragorn.ci.tuwien.ac.at>
Message-ID: <wnc7mht9206.fsf@fhat.stat.sc.edu>


>>>>> "Kurt" == Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:


    Kurt> I noticed the following problems (all already reported, but
    Kurt> not in TASKS).

 Kurt> * TASKS.OLD has

    Kurt> FROM: <Kurt.Hornik@ci.tuwien.ac.at>
    Kurt>         Btw, here's another way to produce a segfault with
    Kurt>         admittedly nonsense code:
    R> x <- 1:5 dimnames(x)[1,2] <- NULL
    Kurt>                 Segmentation fault
    Kurt>         [ Hmmm.  This seems to have gone away.  I get the
    Kurt>         error ] [ message "Error: incorrect number of
    Kurt>         subscripts on array". ]

    Kurt> On my Linux system, I still get the segfault.  Perhaps
    Kurt> others could check that?


segfault on Solaris 2.5.1, as well:


fhat 73 > R

R : Copyright 1997, Robert Gentleman and Ross Ihaka
Version 0.49 Beta (April 23, 1997)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type "license()" for details.

> x <- 1:5
> dimnames(x)[1,2] <- NULL
Segmentation fault (core dumped)
fhat 74 > gdb bin/R.binary core
GDB is free software and you are welcome to distribute copies of it
 under certain conditions; type "show copying" to see the conditions.
There is absolutely no warranty for GDB; type "show warranty" for details.
GDB 4.15.1 (sparc-sun-solaris2.4), 
Copyright 1995 Free Software Foundation, Inc...
Core was generated by `/p1/apps/R/src/R-0.49/bin/R.binary'.
Program terminated with signal 11, Segmentation fault.

#0  0x254f0 in allocArray (mode=16, dims=0x175770) at array.c:124
124                     n = n * INTEGER(dims)[i];
(gdb) where
#0  0x254f0 in allocArray (mode=16, dims=0x175770) at array.c:124
#1  0xa6a0c in listAssign1 (call=0x2fb0a4, x=0x175770, subs=0x2fb0cc, 
    y=0x175770) at subassign.c:922
#2  0xa7650 in do_subassign (call=0x2fb0a4, op=0x1760bc, args=0x2fb090, 
    rho=0x17d1c8) at subassign.c:1119
#3  0x59b28 in eval (e=0x2fb0a4, rho=0x17d1c8) at eval.c:137
#4  0x5b630 in applydefine (call=0x2fafc8, op=0x175f40, args=0x2fafb4, 
    rho=0x17d1c8) at eval.c:625
#5  0x5b984 in do_set (call=0x2fafc8, op=0x175f40, args=0x2fafb4, rho=0x17d1c8)
    at eval.c:666
#6  0x59b28 in eval (e=0x2fafc8, rho=0x17d1c8) at eval.c:137
#7  0x65978 in R_Repl (rho=0x17d1c8, savestack=0, browselevel=0) at main.c:187
#8  0x65f4c in mainloop () at main.c:359
#9  0xcd6fc in main (ac=0, av=0xeffffa14) at system.c:267
(gdb) 



----
-tony (Anthony Rossini)	           Statistics Dept., U South Carolina
rossini@stat.sc.edu	           Columbia, SC 29208
http://www.stat.sc.edu/~rossini/   803-777-3578(O) 803-777-4048 (fax)  
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Wed Apr 23 16:59:29 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 23 Apr 1997 17:59:29 +0200
Subject: R-alpha: Re: R-beta: Version 0.49 Released
In-Reply-To: Kurt Hornik's message of Wed, 23 Apr 1997 17:28:37 +0200
References: <199704230925.VAA24453@stat1.stat.auckland.ac.nz>
 <199704231528.RAA14692@aragorn.ci.tuwien.ac.at>
Message-ID: <x2vi5d3f32.fsf@bush.kubism.ku.dk>

Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

> Overall, REALLY GREAT!  Thanks for putting out the official release ...

Agreed. How's the Win32 version coming along? 

And BTW how does the source code in the src/windows directory fit in?
Where's the Makefile, which compiler, which libraries, etc...

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From luke@stat.umn.edu  Wed Apr 23 17:22:38 1997
From: luke@stat.umn.edu (Luke Tierney)
Date: Wed, 23 Apr 1997 11:22:38 -0500 (CDT)
Subject: R-alpha: libraries, modules, namespaces, ...
Message-ID: <9704231622.AA10729@nokomis.stat.umn.edu>

Now that 0.49 has left the dock (great job Ross and Robert!) here is a
more global issue that may be worth thinking about. I haven't seen any
discussion along these lines yet, but maybe I missed it -- if so,
never mind.

One of the weaknesses of S for building larger packages that can be
used together is the lack of any namespace management facility.
Newer languages like Java, Dylan, Perl, Python, Fortran 90, etc., all
provide some variant of a module system with control over what gets
exported from and imported to modules. I believe something of that
flavor would be very useful in R (or any system). Lots of variations
are possible -- SML probably has the fanciest system of any I know,
Common Lisp's packages are arguably at the other end. An outline of
what might be needed:

	For module writers
		specify scope of module (part of file, all of file,
		several files?)

		specify exports, i.e. things that are to be (easily)
		accessible when the module is used.

	For module users
		simple importing (all exported things from a module)

		selective importing (just bring in some exported things)

		importing with renaming (to avoid conflicts)?

		maybe introspection tools to dig out private things in
		a module (mainly for debugging -- maybe this should not
		be supported).

With R's lexical scoping the ability to implement a module system
exists, e.g a module could be created as

mymodule <- (function() {
  import(other.module)
  f<-function() { .... }
  g<-function() { .... f() .... }
  list(h=g)
})()

which is supposed to export g under the name h but hides f.
An import function could do something like

import<-function(module) {
  assign values to names in caller's frame
}

Lots of scheme module systems use closures for module systems more or
less along these lines. It would be nice to have some nicer syntax, like

mymodule <- module (other.module) {
  ...
  export(...)
}

or whatever seems most natural (also depends on whether you want to
allow several modules per file, several files per module, or thether
modules have anything to do with files at all).

Making S code into an R module would (aside from dealing with
whatever incompatibilities there might be) just involve adding the
module wrapper and deciding what to export.

If being able to maintain common S and R sources seems important, modules
could be specified with a comment convention as in PostScript, emacs
mode lines, etc., something like

#@&^!R-MODULE mymodule
#@&^!R-IMPORT other.module
....
#@&^!R-EXPORT h=f, k, ...

The provide/require functions do a different but related job and would
need to be considered as part of such a design.

Just some food for thought.

luke


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From rgentlem@stat.auckland.ac.nz  Thu Apr 24 02:19:55 1997
From: rgentlem@stat.auckland.ac.nz (Robert Gentleman)
Date: Thu, 24 Apr 1997 13:19:55 +1200 (NZST)
Subject: R-alpha: Windows
Message-ID: <199704240119.NAA00278@stat3.stat.auckland.ac.nz>


 There is a alpha version of R for Windows95 available from 
  stat.auckland.ac.nz  in pub/research/rgentlem/RApril.zip

 Please have a look and a play and let me know what needs to be fixed.
 It should be about a (0.48 release)

robert
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Thu Apr 24 07:11:51 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Thu, 24 Apr 1997 08:11:51 +0200
Subject: R-alpha: libraries, modules, namespaces, ...
In-Reply-To: <9704231622.AA10729@nokomis.stat.umn.edu>
References: <9704231622.AA10729@nokomis.stat.umn.edu>
Message-ID: <199704240611.IAA17238@aragorn.ci.tuwien.ac.at>

>>>>> Luke Tierney writes:

> Now that 0.49 has left the dock (great job Ross and Robert!) here is a
> more global issue that may be worth thinking about. I haven't seen any
> discussion along these lines yet, but maybe I missed it -- if so,
> never mind.

> One of the weaknesses of S for building larger packages that can be
> used together is the lack of any namespace management facility.

> ...

Definitely.

> ...

> Just some food for thought.

Very cool!  Do you think that if we have modules, we should get rid of
the `library' mechanism altogether?  

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Thu Apr 24 07:51:32 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Thu, 24 Apr 1997 08:51:32 +0200
Subject: R-alpha: Re: R-beta: multiple binary types
In-Reply-To: <Pine.SUN.3.91.970423185754.10880F-300000@babcomm>
References: <Pine.SUN.3.91.970423185754.10880F-300000@babcomm>
Message-ID: <199704240651.IAA17442@aragorn.ci.tuwien.ac.at>

>>>>> Gregory R Warnes writes:

> I've modified the "$RHOME/bin/R" and "$RHOME/cmd/filename" so that you 
> can use the same directories for multiple machines.  That is, machines 
> running various flavors of UNIX can access the same directories.

> The modified structure adds the directories

> $RHOME/bin/$OSTYPE/
> $RHOME/lib/$OSTYPE/

> to hold the machine specific binaries.

> For instance, here the $RHOME directory contains two subdirectories,

> $RHOME/bin/solaris/
> $RHOME/bin/sunos4/

> which each hold the appropriate R.binary file.  

> These two modified functions assume that the environment variable $OSTYPE 
> is appropriately set, as is done automatically by the shell tcsh.  If it 
> is not set, the directory names collapse to the original values,
> 	$RHOME/bin/ and $RHOME/lib/

> ...

Is OSTYPE defined by POSIX?  I tried bash, ksh and csh on my Debian
GNU/Linux system.  Whereas all have it, we have

	bash, ksh:	Linux
	tcsh, csh:	linux

which is unfortunate but one could live with that (lowercasing ...).
The real problem is that the OS Linux exists on several hardware
platforms (ix86, alpha, solaris, m68k, ...), so one would really need

	${OSTYPE}-${HOSTTYPE}

Again not knowing what POSIX says, here are the results:

	bash, ksh:	i386
	tcsh, csh:	i386-linux

OH NO!

***

Note also that whereas the suggestion is perfect for binaries, it is in
a way `orthogonal' to rearranging the R tree into

	<library>/<section>/<type>

structure ... hmm, or should we have <platform> dirs for exec and objs?

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Thu Apr 24 07:54:55 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Thu, 24 Apr 1997 08:54:55 +0200
Subject: R-alpha: R-0.49:  RE postscript()
Message-ID: <199704240654.IAA17458@aragorn.ci.tuwien.ac.at>

R&R,

It also seems that pictex() is broken.  I've only taken a quick look,
but I think the reason is that

	.Internal(device("pictex", as.character(c(file)), c(width, 
                height, debug, bg, fg)))

should have bg and fg with the character args, and the driver code needs
to be updated accordingly ...

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Friedrich.Leisch@ci.tuwien.ac.at  Thu Apr 24 08:07:55 1997
From: Friedrich.Leisch@ci.tuwien.ac.at (Friedrich Leisch)
Date: Thu, 24 Apr 1997 09:07:55 +0200
Subject: R-alpha: Re: R-beta: multiple binary types
In-Reply-To: <199704240651.IAA17442@aragorn.ci.tuwien.ac.at>
References: <Pine.SUN.3.91.970423185754.10880F-300000@babcomm>
 <199704240651.IAA17442@aragorn.ci.tuwien.ac.at>
Message-ID: <199704240707.JAA11914@galadriel.ci.tuwien.ac.at>

>>>>> On Thu, 24 Apr 1997 08:51:32 +0200,
>>>>> Kurt Hornik wrote:

> ...

> Note also that whereas the suggestion is perfect for binaries, it is in
> a way `orthogonal' to rearranging the R tree into

> 	<library>/<section>/<type>

> structure ... hmm, or should we have <platform> dirs for exec and objs?

IMHO we should definetely have platform-dirs for everything that's
possibly platform-dependent ... resulting in something like

	<library>/<section>/<type>

e.g. for R code and

	<library>/<section>/<type>/<platform>

e.g. for exec and dynload-objects.

for exec there's a problem though, as some exec's are
shell/perl/whatever-scripts and *should* work on any platform
...  

.f
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Thu Apr 24 10:11:51 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Thu, 24 Apr 1997 21:11:51 +1200 (NZST)
Subject: R-alpha: Postscript bug ...
Message-ID: <199704240911.VAA05630@stat1.stat.auckland.ac.nz>

Jeez I dunno - it compiles perfectly and you guys get excited just because
it doesn't work :-)

I have to admit to being baffled about what happened (I'm SURE this was
working not long ago), but here is a quick fix.  The problem is in the
function "GetCharInfo" in the file src/unix/PostScript.c.

The fix is to change the statement

	if(nchar < 0)
		return 0;

to
	if(nchar < 0)
		return 1;

as indicated in the #ifdefs below.  I will make a patch file and put
it the archive with the .tgz file.

We seem to have enough problem reports to justfy getting a new 0.50 out
pretty soon in any case.

	Ross

- - - replacement - - GetCharInfo - - -

static int GetCharInfo(char *buf, FontMetricInfo *metrics)
{
	char *p = buf;
	int nchar;

	if(!MatchKey(buf, "C "))
		return 0;
	p = SkipToNextItem(p);
	sscanf(p, "%d", &nchar);
	if(nchar < 0)
#ifdef OLD
		return 0;
#else
		return 1;
#endif
	p = SkipToNextKey(p);

	if(!MatchKey(p, "WX"))
		return 0;
	p = SkipToNextItem(p);
	sscanf(p, "%hd", &(metrics->CharInfo[nchar].WX));
	p = SkipToNextKey(p);

	if(!MatchKey(p, "N "))
		return 0;
	p = SkipToNextKey(p);

	if(!MatchKey(p, "B "))
		return 0;
	p = SkipToNextItem(p);
	sscanf(p, "%hd %hd %hd %hd",
		&(metrics->CharInfo[nchar].BBox[0]),
		&(metrics->CharInfo[nchar].BBox[1]),
		&(metrics->CharInfo[nchar].BBox[2]),
		&(metrics->CharInfo[nchar].BBox[3]));

#ifdef DEBUG
	printf("nchar = %d %d %d %d %d %d\n", nchar,
		metrics->CharInfo[nchar].WX,
		metrics->CharInfo[nchar].BBox[0],
		metrics->CharInfo[nchar].BBox[1],
		metrics->CharInfo[nchar].BBox[2],
		metrics->CharInfo[nchar].BBox[3]);
#endif
	return 1;
}
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Thu Apr 24 10:35:41 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Thu, 24 Apr 1997 21:35:41 +1200 (NZST)
Subject: R-alpha: R-0.49 Patch #1
Message-ID: <199704240935.VAA06050@stat1.stat.auckland.ac.nz>

This patch corrects the broken postscript graphics driver.
If you have already done it by hand ignore this.

Apply this patch within the R-0.49 directory.

The patch is also at the auckland.ftp site and soon at mirrors.
	Ross


*** src/unix/PostScript.c.orig	Thu Apr 24 21:28:27 1997
--- src/unix//PostScript.c	Thu Apr 24 21:28:51 1997
***************
*** 160,166 ****
  	if(!MatchKey(buf, "C ")) return 0;
  	p = SkipToNextItem(p);
  	sscanf(p, "%d", &nchar);
! 	if(nchar < 0) return 0;
  	p = SkipToNextKey(p);
  
  	if(!MatchKey(p, "WX")) return 0;
--- 160,166 ----
  	if(!MatchKey(buf, "C ")) return 0;
  	p = SkipToNextItem(p);
  	sscanf(p, "%d", &nchar);
! 	if(nchar < 0) return 1;
  	p = SkipToNextKey(p);
  
  	if(!MatchKey(p, "WX")) return 0;
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Thu Apr 24 10:58:59 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 24 Apr 1997 11:58:59 +0200
Subject: R-alpha: Postscript bug ...
In-Reply-To: Ross Ihaka's message of Thu, 24 Apr 1997 21:11:51 +1200 (NZST)
References: <199704240911.VAA05630@stat1.stat.auckland.ac.nz>
Message-ID: <x2bu74vj18.fsf@bush.kubism.ku.dk>

Ross Ihaka <ihaka@stat.auckland.ac.nz> writes:

> We seem to have enough problem reports to justfy getting a new 0.50 out
> pretty soon in any case.

A succession of 0.49.n's would be better, I'd say. Preferably using
patches from 0.49 for those with slow links, but that's not all that
important. Heck, it's only 10 minutes across a 14k4 modem (but it took
more than an hour to transfer R7.tgz from here to Kurt in Vienna the
other day - that's between two sites with direct net connections...).

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Thu Apr 24 11:01:40 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Thu, 24 Apr 1997 22:01:40 +1200 (NZST)
Subject: R-alpha: Postscript bug ...
Message-ID: <199704241001.WAA06175@stat1.stat.auckland.ac.nz>

> A succession of 0.49.n's would be better, I'd say. Preferably using
> patches from 0.49 for those with slow links, but that's not all that
> important. Heck, it's only 10 minutes across a 14k4 modem (but it took
> more than an hour to transfer R7.tgz from here to Kurt in Vienna the
> other day - that's between two sites with direct net connections...).

And here was I thinking that the steam-driven abacus we use for
R development was low tech ...

I will try to send out "important" patches, but its hard to maintain
distinct branches and we have already diverged from 0.49 here.
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Andreas.Weingessel@ci.tuwien.ac.at  Thu Apr 24 11:24:10 1997
From: Andreas.Weingessel@ci.tuwien.ac.at (Andreas Weingessel)
Date: Thu, 24 Apr 1997 12:24:10 +0200
Subject: R-alpha: Seg. fault in tapply
Message-ID: <199704241024.MAA07829@elendil.ci.tuwien.ac.at>



Calling tapply with a NULL as INDEX argument causes a segmentation
fault on an i-586-linux machine.

So, if for example
	 y<-list(a=3D1:10,b=3D2:5)
then
	tapply(y$a,y$c,mean)
causes a segmentation fault.=20

This seg. fault is produced when a dimension of length integer(0) is
assigned to a list with one element and this object is shown
afterwards. E.g.:

R>  y<-list(a=3D1:10)
R> dim(y) <- integer(length(NULL))
R> y
Segmentation fault

This happens in the code of tapply, when INDEX=3DNULL in the lines

  extent <- integer(length(INDEX))
and
  dim(ans) <- extent


Regards,
	Andreas

************************************************************************
*                          Andreas Weingessel                          *
************************************************************************
* Institut f=FCr Statistik      *                Tel: (+43 1) 58801 4541 =
*
* Technische Universit=E4t Wien *                Fax: (+43 1)  504 14 98 =
*
* Wiedner Hauptstr. 8-10/1071 *     Andreas.Weingessel@ci.tuwien.ac.at *
* A-1040 Wien, Austria        * http://www.ci.tuwien.ac.at/~weingessel *
************************************************************************

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Thu Apr 24 11:51:08 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Thu, 24 Apr 1997 12:51:08 +0200
Subject: R-alpha: Postscript bug ...
In-Reply-To: <199704241001.WAA06175@stat1.stat.auckland.ac.nz>
References: <199704241001.WAA06175@stat1.stat.auckland.ac.nz>
Message-ID: <199704241051.MAA18473@aragorn.ci.tuwien.ac.at>

>>>>> Ross Ihaka writes:

>> A succession of 0.49.n's would be better, I'd say. Preferably using
>> patches from 0.49 for those with slow links, but that's not all that
>> important. Heck, it's only 10 minutes across a 14k4 modem (but it took
>> more than an hour to transfer R7.tgz from here to Kurt in Vienna the
>> other day - that's between two sites with direct net connections...).

> And here was I thinking that the steam-driven abacus we use for R
> development was low tech ...

Please don't keep mentioning the performance of my network connection
again and again  :-)

> I will try to send out "important" patches, but its hard to maintain
> distinct branches and we have already diverged from 0.49 here.

Please do.  Perhaps name them like

	R-0.49-0.49.1.diff.gz

???

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Thu Apr 24 11:48:07 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Thu, 24 Apr 1997 12:48:07 +0200
Subject: R-alpha: R-0.49 Patch #1
In-Reply-To: <199704240935.VAA06050@stat1.stat.auckland.ac.nz>
References: <199704240935.VAA06050@stat1.stat.auckland.ac.nz>
Message-ID: <199704241048.MAA18462@aragorn.ci.tuwien.ac.at>

>>>>> Ross Ihaka writes:

> This patch corrects the broken postscript graphics driver.
> If you have already done it by hand ignore this.

> Apply this patch within the R-0.49 directory.

> The patch is also at the auckland.ftp site and soon at mirrors.

Great, thanks.

I've put updated Debian/ix86 packages into CRAN ...

Btw, perhaps the patch should be sent to R-announce?  (The bug reports
came on R-help ...)

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Thu Apr 24 12:09:11 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Thu, 24 Apr 1997 13:09:11 +0200
Subject: R-alpha: R-0.49 PROJECTS
Message-ID: <199704241109.NAA18581@aragorn.ci.tuwien.ac.at>

R&R:

Re

 o  TIME SERIES
    A state-space/structural models package would be nice.  We have a
    partial spectrum analysis package.  It needs to be multivariate
    though.

Fritz and Andreas are teaching a time series course based on R this
semester, so they need to produce some code for that anyway.  If you
won't work on your code for some time, perhaps simply send us the
current versions and see what happens?

-k

PS1.  There was also `poly' function in your snapshot WORK tree ... do
you already have a final version of that?
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Thu Apr 24 14:14:22 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Thu, 24 Apr 1997 15:14:22 +0200
Subject: R-alpha: polynom add-on
Message-ID: <199704241314.PAA20059@aragorn.ci.tuwien.ac.at>

I've packaged Bill's polynom add-on for R (i.e., converted man pages and
took care of TITLE and INDEX).  Apart from the missing poly() everything
should be fine ...

The package can be found in the CRAN src/contrib area.

I've also added it to the Debian ix86 r-contrib package.

-k

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Fri Apr 25 00:36:23 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 25 Apr 1997 01:36:23 +0200
Subject: R-alpha: list assignment
Message-ID: <x2afmo803s.fsf@bush.kubism.ku.dk>

This works in Splus:

> x<-list()
> x[["f"]]<-1
> zz<-"g"
> x[[zz]]<-2 
> x
$f:
[1] 1

$g:
[1] 2

In R both variants fail unless the name is already on the list. The
first one can be replaced by x$f, but there's seems to be no
substitute for the other one (oh yes I found one, but it's not fit to
print!). This comes up if you e.g. want to create a variable in a data
frame with a name given by a character string.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From rgentlem@stat.auckland.ac.nz  Fri Apr 25 02:12:36 1997
From: rgentlem@stat.auckland.ac.nz (Robert Gentleman)
Date: Fri, 25 Apr 1997 13:12:36 +1200 (NZST)
Subject: R-alpha: list assignment
Message-ID: <199704250112.NAA00344@stat3.stat.auckland.ac.nz>


Peter,
  They don't work on purpose. Basically this is the same problem as indexing
beyond the end of an array. In almost all cases it is an error.
To add a variable with a specific name to a data frame how about

x (the dataframe)
var1 the variable
name1 the name

 x<-cbind(x,var1)
 names(x)[ncol(x)]<-name1


robert
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Andreas.Weingessel@ci.tuwien.ac.at  Fri Apr 25 10:04:21 1997
From: Andreas.Weingessel@ci.tuwien.ac.at (Andreas Weingessel)
Date: Fri, 25 Apr 1997 11:04:21 +0200
Subject: R-alpha: bug in approx
Message-ID: <199704250904.LAA11382@elendil.ci.tuwien.ac.at>


When the function approx is called with the argument rule=3D2, one gets
the error message
	Error: NAs in foreign function call (arg 6)
Besides, the meaning of rule=3D1 or rule=3D2 is opposite to that describe=
d
in the help text and used in S-plus.

For example, in R:

R> approx(1:10,2:11,xout=3D5:15,rule=3D1)
$x
 [1]  5  6  7  8  9 10 11 12 13 14 15

$y
 [1]  6  7  8  9 10 11 11 11 11 11 11

R> approx(1:10,2:11,xout=3D5:15,rule=3D2)
Error: NAs in foreign function call (arg 6)

but in S-plus:

> approx(1:10,2:11,xout=3D5:15,rule=3D1)
$x:
 [1]  5  6  7  8  9 10 11 12 13 14 15

$y:
 [1]  6  7  8  9 10 11 NA NA NA NA NA

> approx(1:10,2:11,xout=3D5:15,rule=3D2)
$x:
 [1]  5  6  7  8  9 10 11 12 13 14 15

$y:
 [1]  6  7  8  9 10 11 11 11 11 11 11


The reason for this bug can be found in the last lines of the code of
approx:

        if (rule =3D=3D 1) {
                low <- y[1]
                high <- y[length(x)]
        }
        else if (rule =3D=3D 2) {
                low <- NA
                high <- low
        }
        else stop("invalid extrapolation rule in approx")
        y <- .C("approx", as.double(x), as.double(y), length(x),=20
                xout =3D as.double(xout), length(xout), as.double(low),=20
                as.double(high))$xout
        return(list(x =3D xout, y =3D y))


If (rule =3D=3D 2) the values of low and high are set to NA. Immediately
afterwards, the foreign function "approx" is called with these values,
leading to the error
	Error: NAs in foreign function call (arg 6)

To obtain the same behavior as in S-plus (and as in the help-text) the
commands for (rule =3D=3D 1) and (rule =3D=3D 2) have to be exchanged.

	Regards,
		Andreas

************************************************************************
*                          Andreas Weingessel                          *
************************************************************************
* Institut f=FCr Statistik      *                Tel: (+43 1) 58801 4541 =
*
* Technische Universit=E4t Wien *                Fax: (+43 1)  504 14 98 =
*
* Wiedner Hauptstr. 8-10/1071 *     Andreas.Weingessel@ci.tuwien.ac.at *
* A-1040 Wien, Austria        * http://www.ci.tuwien.ac.at/~weingessel *
************************************************************************



=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Fri Apr 25 10:56:10 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Fri, 25 Apr 1997 11:56:10 +0200
Subject: R-alpha: xgobi
Message-ID: <199704250956.LAA25634@aragorn.ci.tuwien.ac.at>

I've commented out a few lines in the S function that comes with the
XGobi distribution and made 3 more changes or so ... now one can use it
for starting XGobi from within R.  Seems to work o.k.  [Cloning and
Copying does not, but does it under S-PLUS?]

The function requires something like tmpname(), so it currently has to
require our e1071 library.  R&R, couldn't we add the tmpname() wrapper
to the libc function to the distribution?

I've put xgobi.tar.gz into CRAN/src/contrib.  

I've also added it to the Debian Linux/GNU r-contrib package.  Doug,
if you're interested in an XGobi package, please let me know.

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From luke@stat.umn.edu  Fri Apr 25 11:12:19 1997
From: luke@stat.umn.edu (Luke Tierney)
Date: Fri, 25 Apr 1997 05:12:19 -0500 (CDT)
Subject: R-alpha: libraries, modules, namespaces, ...
In-Reply-To: <199704240611.IAA17238@aragorn.ci.tuwien.ac.at> from "Kurt Hornik" at Apr 24, 97 08:11:51 am
Message-ID: <9704251012.AA06862@nokomis.stat.umn.edu>

> 
> Very cool!  Do you think that if we have modules, we should get rid of
> the `library' mechanism altogether?  
> 

Something along those lines is probably still needed. Right now
library/provide/require are an imperative mechanism that (a) makes
additions to the global name space (b) makes code available.

Making code available is, I think, better handled by a declarative
module mechanism that describes what depends on what but leaves the
system the freedom to actually load the relevant code when it needs
to, unloaded it if it isn't needed, etc. A declarative mechanism in
which DLL's are viewed as just a special kind of module or as
containers for such modules (native modules if you like) would also
make handling of DLL code a bit easier and cleaner.

But modifying the global name space at run time to make certain groups
of things available is still something you need to be able to do (you
can think of it as an interactive import directive). So some variant
of a library command is still needed, but provide/require's
functionality would be replaced by the declarative module
mechanism. (At least from a user's point of view -- the implementation
might still use the same mechanism internally. Also some back door for
explicitly loading a module/DLL and for unloading would still be
useful during debugging of new code but would usually not be needed
once code is stable).

There is also a granularity issue that might be worth considering.  S
libraries tend to be fairly coarse-grained. With a module mechanism I
would tend to want to subdivide many of these libraries into smaller
modules, but it would still be useful to be able to organize them into
library-sized chunks. One way to allow that would be to allow nested
modules. While that might be an elegant solution in some sense, I
suspect it is too complex. A better choice is probably to have a
two-tiered mechanism like packages/classes in Java, libraries/modules
in dylan with libraries just a loose way of grouping modules.

One drawback of handling modules by something like

mymodule <- module { ... }

is that it strongly suggests that modules can be nested, are first
class, etc. If that is the case, great. But if not it would cause
confusion. If a simpler notion of module is used, a convention that
makes limitations clear (like comment-based module specification, or a
file=module convention) might be better.

Lots of things to think about.

luke
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Fri Apr 25 12:09:01 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 25 Apr 1997 13:09:01 +0200
Subject: R-alpha: list assignment
In-Reply-To: Robert Gentleman's message of Fri, 25 Apr 1997 13:12:36 +1200 (NZST)
References: <199704250112.NAA00344@stat3.stat.auckland.ac.nz>
Message-ID: <x2rafznyuq.fsf@bush.kubism.ku.dk>

Robert Gentleman <rgentlem@stat.auckland.ac.nz> writes:

> 
> 
> Peter,
>   They don't work on purpose. Basically this is the same problem as indexing
> beyond the end of an array. In almost all cases it is an error.
> To add a variable with a specific name to a data frame how about
> 
> x (the dataframe)
> var1 the variable
> name1 the name
> 
>  x<-cbind(x,var1)
>  names(x)[ncol(x)]<-name1

Hm. Not sure about that argument. After all we don't protect against
typing

x$mumble<-17
instead of 
x$grumble<-17

Once you're into indexing lists through character variables, shouldn't
you be assumed to know what you're doing? Beginners can do much more
mischief with e.g. dfr$new<-0 which will turn dfr into a list.

However, apropos your construct, watch this:

> x<-list()
> x[[1]]<-23
> names(x)[1]<-"a"
> x
$"a"
[1] 23

> unlist(x)
\"a\" 
   23 
> names(x)[1]     
[1] "\"a\""
> names(x)   
[1] "\"a\""
> names(x)[1]<-"a"
> names(x)
[1] "a"
> x
$a
[1] 23

> unlist(x)
 a 
23 


-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Friedrich.Leisch@ci.tuwien.ac.at  Fri Apr 25 13:16:50 1997
From: Friedrich.Leisch@ci.tuwien.ac.at (Friedrich Leisch)
Date: Fri, 25 Apr 1997 14:16:50 +0200
Subject: R-alpha: unresolved symbols
Message-ID: <199704251216.OAA17847@galadriel.ci.tuwien.ac.at>


I tried to convert hastie & tibshiranis mda package to R but ended
with a bunch of unresolved symbols:

R.binary: can't resolve symbol 'dbksl_'
R.binary: can't resolve symbol 'dblepr_'
R.binary: can't resolve symbol 'dqrdca_'
R.binary: can't resolve symbol 'intpr_'
R.binary: can't resolve symbol 'pack_'
R.binary: can't resolve symbol 'sgram_'
R.binary: can't resolve symbol 'sknotl_'
R.binary: can't resolve symbol 'unpack_'
R.binary: can't resolve symbol 'wmean_'

I'm using linux, f2c, gcc

Does anyone know which library these symbols are part of? Sun-specific?

I've also tried to load the stuff into Splus 3.4 on a HP 9000 using the H=
P C
compiler, same symbols seem to be missing.

Has anyone got the mda package up and running?

Best,
Fritz

--=20
-------------------------------------------------------------------
                        Friedrich  Leisch                            =20
Institut f=FCr Statistik                      Tel: (+43 1) 58801 4541
Technische Universit=E4t Wien                 Fax: (+43 1)  504 14 98
Wiedner Hauptstra=DFe 8-10/1071      Friedrich.Leisch@ci.tuwien.ac.at
A-1040 Wien, Austria             http://www.ci.tuwien.ac.at/~leisch
     PGP public key http://www.ci.tuwien.ac.at/~leisch/pgp.key
-------------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Fri Apr 25 13:19:29 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Fri, 25 Apr 1997 14:19:29 +0200
Subject: R-alpha: phyper() woes
Message-ID: <199704251219.OAA26048@aragorn.ci.tuwien.ac.at>

I can also confirm that rhyper(5,200,250,60) never returns (o.k., if
never is anything beyond 5 minutes).

More strikingly,

R> phyper(47, 76, 49, 68)
[1] 1

whereas

Splus> phyper(47, 76, 49, 68)
[1] 0.9883098


(Breaks my fisher.test() ...)

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Sun Apr 27 22:39:02 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Sun, 27 Apr 1997 14:39:02 -0700 (PDT)
Subject: R-alpha: R-beta: vector recycling weirdness
In-Reply-To: <9704010823.AA00318@>
Message-ID: <Pine.SUN.3.95.970427143317.14377A-100000@data>

wompom:~> R
R : Copyright 1997, Robert Gentleman and Ross Ihaka
Version 0.49 Beta (April 23, 1997)

R> f
function () 
{
        FALSE & matrix(FALSE, ncol = 1)
}
R> g
function () 
FALSE & matrix(FALSE, ncol = 1) 
R> f()
Warning in FALSE & matrix(FALSE, ncol = 1) : longer object length
        is not a multiple of shorter object length
      [,1]
[1,] FALSE
R> g()
      [,1]
[1,] FALSE
 
Is this weird or what?


Thomas Lumley
-----------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Apr 28 06:07:05 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 28 Apr 1997 07:07:05 +0200
Subject: R-alpha: R-0.49:  2 problems
Message-ID: <199704280507.HAA02509@aragorn.ci.tuwien.ac.at>

I found the following 2 problems (no debugging, sorry).

* qt(0.975, 3) never returns.

Can someone please check that?  Happens for me on Debian GNU/Linux/ix86
compiled with CFLAGS="-O2 -g".

* Yet another stupid way to cause a segfault:

R> x
Error: Object "x" not found
R> debug(t.test)
R> t.test(rnorm(10))
debug: choices <- c("two.sided", "greater", "less")
Browse[1]> return()
NULL
R> x
Error: Object "x" not found
Browse[1]> return()
Segmentation fault

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Apr 28 06:07:05 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 28 Apr 1997 07:07:05 +0200
Subject: R-alpha: list assignment
In-Reply-To: <x2rafznyuq.fsf@bush.kubism.ku.dk>
References: <199704250112.NAA00344@stat3.stat.auckland.ac.nz>
 <x2rafznyuq.fsf@bush.kubism.ku.dk>
Message-ID: <199704280507.HAA02510@aragorn.ci.tuwien.ac.at>

>>>>> Peter Dalgaard BSA writes:

> Robert Gentleman <rgentlem@stat.auckland.ac.nz> writes:
>> 
>> 
>> Peter,
>> They don't work on purpose. Basically this is the same problem as indexing
>> beyond the end of an array. In almost all cases it is an error.
>> To add a variable with a specific name to a data frame how about
>> 
>> x (the dataframe)
>> var1 the variable
>> name1 the name
>> 
>> x<-cbind(x,var1)
>> names(x)[ncol(x)]<-name1

> Hm. Not sure about that argument. After all we don't protect against
> typing

> x$mumble<-17
> instead of 
> x$grumble<-17

> Once you're into indexing lists through character variables, shouldn't
> you be assumed to know what you're doing? Beginners can do much more
> mischief with e.g. dfr$new<-0 which will turn dfr into a list.

> However, apropos your construct, watch this:

>> x<-list()
>> x[[1]]<-23
>> names(x)[1]<-"a"
>> x
> $"a"
> [1] 23

>> unlist(x)
> \"a\" 
>    23 
>> names(x)[1]     
> [1] "\"a\""
>> names(x)   
> [1] "\"a\""
>> names(x)[1]<-"a"
>> names(x)
> [1] "a"
>> x
> $a
> [1] 23

>> unlist(x)
>  a 
> 23

Which is the same (?) as the

R> l <- list("11" = 1:5)
R> l
$11
[1] 1 2 3 4 5

R> unlist(l)
111 112 113 114 115 
  1   2   3   4   5 

I ran into this weekend ...

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From rossini@math.sc.edu  Mon Apr 28 14:11:34 1997
From: rossini@math.sc.edu (Anthony Rossini)
Date: 28 Apr 1997 09:11:34 -0400
Subject: R-alpha: R-0.49:  2 problems
In-Reply-To: Kurt Hornik's message of Mon, 28 Apr 1997 07:07:05 +0200
References: <199704280507.HAA02509@aragorn.ci.tuwien.ac.at>
Message-ID: <wnc67x7qol5.fsf@fhat.stat.sc.edu>



>>>>> "Kurt" == Kurt Hornik <hornik@ci.tuwien.ac.at> writes:

    Kurt> I found the following 2 problems (no debugging, sorry).
 Kurt> * qt(0.975, 3) never returns.

    Kurt> Can someone please check that?  Happens for me on Debian
    Kurt> GNU/Linux/ix86 compiled with CFLAGS="-O2 -g".

Fine on Solaris, but see the transcript which follows.

 Kurt> * Yet another stupid way to cause a segfault:

    R> x
    Kurt> Error: Object "x" not found
    R> debug(t.test) t.test(rnorm(10))
    Kurt> debug: choices <- c("two.sided", "greater", "less")
    Kurt> Browse[1]> return()
    Kurt> NULL
    R> x
    Kurt> Error: Object "x" not found
    Kurt> Browse[1]> return()
    Kurt> Segmentation fault

I got a Bus Error, and it happened one line earlier...

Transcript:

>  neuromancer 21 > R
>  
>  R : Copyright 1997, Robert Gentleman and Ross Ihaka
>  Version 0.49 Beta (April 23, 1997)
>  
>  R is free software and comes with ABSOLUTELY NO WARRANTY.
>  You are welcome to redistribute it under certain conditions.
>  Type "license()" for details.
>  
>  >  qt(0.975, 3)
>  [1] 3.182446
>  > 
>  >  x
>  Error: Object "x" not found
>  > debug(t.test)
>  >  t.test(rnorm(10))
>  debug: choices <- c("two.sided", "greater", "less")
>  Browse[1]>  return()
>  NULL
>  > x
>  Error: Object "x" not found
>  Bus error (core dumped)
>  neuromancer 22 > 

with the following core dump:

>  neuromancer 22 > gdb /apps/R/bin/R.binary core
>  GDB is free software and you are welcome to distribute copies of it
>   under certain conditions; type "show copying" to see the conditions.
>  There is absolutely no warranty for GDB; type "show warranty" for details.
>  GDB 4.15.1 (sparc-sun-solaris2.4), 
>  Copyright 1995 Free Software Foundation, Inc...
>  Core was generated by `/p1/apps/R/src/R-0.49/bin/R.binary'.
>  Program terminated with signal 10, Bus error.
>  Reading symbols from /p1/apps/X11R6.3/lib/libSM.so.6.0...done.
>  Reading symbols from /p1/apps/X11R6.3/lib/libICE.so.6.3...done.
>  Reading symbols from /p1/apps/X11R6.3/lib/libX11.so.6.1...done.
>  Reading symbols from /usr/lib/libnsl.so.1...done.
>  Reading symbols from /usr/lib/libsocket.so.1...done.
>  Reading symbols from /usr/lib/libdl.so.1...done.
>  Reading symbols from /usr/lib/libm.so.1...done.
>  Reading symbols from /usr/lib/libc.so.1...done.
>  Reading symbols from /usr/lib/libintl.so.1...done.
>  Reading symbols from /usr/lib/libmp.so.1...done.
>  Reading symbols from /usr/lib/libw.so.1...done.
>  #0  0xef4e25c8 in longjmp ()
>  (gdb) where
>  #0  0xef4e25c8 in longjmp ()
>  #1  0x59214 in jump_now () at errors.c:126
>  #2  0x591c8 in jump_to_toplevel () at errors.c:119
>  #3  0x58f78 in error (format=0x1391a8 "Object \"%s\" not found\n")
>      at errors.c:78
>  #4  0x597a0 in eval (e=0x17f2c0, rho=0x17d1c8) at eval.c:92
>  #5  0x65978 in R_Repl (rho=0x17d1c8, savestack=0, browselevel=0) at main.c:187
>  #6  0x65f4c in mainloop () at main.c:359
>  #7  0xcd6fc in main (ac=0, av=0xeffffa6c) at system.c:267
>  (gdb) 

Something is not where it ought to be... (but I've not looked at the
source in a long enough time to tell you exactly what :-().

best,

----
-tony (Anthony Rossini)	           Statistics Dept., U South Carolina
rossini@stat.sc.edu	           Columbia, SC 29208
http://www.stat.sc.edu/~rossini/   803-777-3578(O) 803-777-4048 (fax)  
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Apr 28 14:37:03 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 28 Apr 1997 15:37:03 +0200
Subject: R-alpha: R-0.49:  2 problems
In-Reply-To: <wnc67x7qol5.fsf@fhat.stat.sc.edu>
References: <199704280507.HAA02509@aragorn.ci.tuwien.ac.at>
 <wnc67x7qol5.fsf@fhat.stat.sc.edu>
Message-ID: <199704281337.PAA06954@aragorn.ci.tuwien.ac.at>

>>>>> Anthony Rossini writes:

>>>>> "Kurt" == Kurt Hornik <hornik@ci.tuwien.ac.at> writes:

Kurt> I found the following 2 problems (no debugging, sorry).
Kurt> * qt(0.975, 3) never returns.

Kurt> Can someone please check that?  Happens for me on Debian
Kurt> GNU/Linux/ix86 compiled with CFLAGS="-O2 -g".

> Fine on Solaris, but see the transcript which follows.

Thanks, Tony.

Actually, also fine on Debian GNU/Linux/ix86 compiled with CFLAGS="-g",
as I expected ...

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Mon Apr 28 15:58:03 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Mon, 28 Apr 1997 07:58:03 -0700 (PDT)
Subject: R-alpha: R-beta:matrix & vector multiplication.
In-Reply-To: <9704010823.AA00318@>
Message-ID: <Pine.SUN.3.95.970428075618.1365B-100000@zen>

Both of these used to work and seem useful and harmless:

R> matrix(1,ncol=1)%*%c(1,2)
Error in matrix(1, ncol = 1) %*% c(1, 2) : non-conformable arguments

R> matrix(1,ncol=1)*(1:2)
Error: dim<- length of dims do not match the length of object


Thomas Lumley
-----------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Mon Apr 28 17:52:41 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 28 Apr 1997 18:52:41 +0200
Subject: R-alpha: R-W95
Message-ID: <x2sp0brsx2.fsf@bush.kubism.ku.dk>

Seems to be working very nicely (and what a relief to see it actually
working!), I've found only a few problems till now:

a) Characters outside 0-0x7f seem to get encoded as CP850 or
something, not Latin 1 ( keys on DK keyboard gives
mu,degree,sigma).

b) Infinite recursion crashed R. (I forget details, but it was
something stupid like f<-function(x){if (x < 1) 1 else f(x)*(x-1)})

c) I miss command-line recall *badly*...

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Mon Apr 28 20:18:07 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Mon, 28 Apr 1997 12:18:07 -0700 (PDT)
Subject: R-alpha: R-W95
In-Reply-To: <x2sp0brsx2.fsf@bush.kubism.ku.dk>
Message-ID: <Pine.SUN.3.95.970428121424.8287A-100000@avon>

On 28 Apr 1997, Peter Dalgaard BSA wrote:

> Seems to be working very nicely (and what a relief to see it actually
> working!), I've found only a few problems till now:

Me too.  There are some problems with the html help.  Firstly, if you
unzip the file with a program that doesn't know about long filenames none
of the links will work. Secondly, some of the links use forward rather
than back slashes as directory separators. Internet Explorer doesn't seem
to cope with this (I don't know about other browsers). 

Of course all my favorite test code is in libraries, so I couldn't
brutally stress the poor program....

Thomas Lumley
-----------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Mon Apr 28 22:16:05 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Tue, 29 Apr 1997 09:16:05 +1200 (NZST)
Subject: R-alpha: R-0.49:  2 problems
In-Reply-To: <199704280507.HAA02509@aragorn.ci.tuwien.ac.at>
References: <199704280507.HAA02509@aragorn.ci.tuwien.ac.at>
Message-ID: <199704282116.JAA24437@stat1.stat.auckland.ac.nz>

Kurt Hornik writes:
 > I found the following 2 problems (no debugging, sorry).
 > 
 > * qt(0.975, 3) never returns.
 > 
 > Can someone please check that?  Happens for me on Debian GNU/Linux/ix86
 > compiled with CFLAGS="-O2 -g".

I am having a look at the computations of p-values and quantiles which
depend on the incomplete beta function at  present.  I hope to have a
better set of functions in place by weeks end.  I may need a tester or
two to really exercise the new ones.  I'm also looking at the whole
math library to see exactly how much work a proper handling of Inf, NaN
and NA might involve.
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Apr 29 10:37:00 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 29 Apr 97 11:37:00 +0200
Subject: R-alpha: Re: Inf  et al.
In-Reply-To: <199704282116.JAA24437@stat1.stat.auckland.ac.nz> (message from
 Ross Ihaka on Tue, 29 Apr 1997 09:16:05 +1200 (NZST))
Message-ID: <9704290937.AA00877@>

>>>>> "Ross" == Ross Ihaka <ihaka@stat.auckland.ac.nz> writes:

    Ross> I am having a look at the computations of p-values and quantiles
    Ross> which depend on the incomplete beta function at present.  I hope
    Ross> to have a better set of functions in place by weeks end.  I may
    Ross> need a tester or two to really exercise the new ones.

I'd volunteer for this..

BTW: The phyper 'inaccuracy' is not a pbeta problem however.
I think that AS 152 (which has been improved, but is still available as
		     file  ...statlib.../apstat/152 )
should be used in place of  phyper.c
		

    Ross> I'm also
    Ross> looking at the whole math library to see exactly how much work a
    Ross> proper handling of Inf, NaN and NA might involve. 

I think that this is the most important of the current TASKS.
Even though it doesn't seem to be used so often,
I've been realizing lately that in several places in my code, I just rely
on things like  1/Inf  -> 0.
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Tue Apr 29 13:02:29 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 29 Apr 1997 14:02:29 +0200
Subject: R-alpha: Re: Inf  et al.
In-Reply-To: <9704290937.AA00877@>
References: <199704282116.JAA24437@stat1.stat.auckland.ac.nz>
 <9704290937.AA00877@>
Message-ID: <199704291202.OAA14127@aragorn.ci.tuwien.ac.at>

>>>>> Martin Maechler writes:

>>>>> "Ross" == Ross Ihaka <ihaka@stat.auckland.ac.nz> writes:
Ross> I am having a look at the computations of p-values and quantiles
Ross> which depend on the incomplete beta function at present.  I hope
Ross> to have a better set of functions in place by weeks end.  I may
Ross> need a tester or two to really exercise the new ones.

> I'd volunteer for this..

> BTW: The phyper 'inaccuracy' is not a pbeta problem however.
> I think that AS 152 (which has been improved, but is still available as
> 		     file  ...statlib.../apstat/152 )
> should be used in place of  phyper.c

If Martin volunteers for it, one tester should be enough.
		
-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Tue Apr 29 13:19:14 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 29 Apr 1997 14:19:14 +0200
Subject: R-alpha: Re: R-beta: Archives of   R-announce / R-help / R-devel -- monthly archive files
In-Reply-To: <9704290931.AA00870@>
References: <9704290931.AA00870@>
Message-ID: <199704291219.OAA14305@aragorn.ci.tuwien.ac.at>

>>>>> Martin Maechler writes:

> Something which seems missing from the current  R-FAQ
> which mentions "mailing list archive":

>     The 3 mailing lists   R-announce / R-help / R-devel 
>     are not only archived,
>     but the archives are also made publicly available on the net,
>     in a monthly schedule at

> 	    ftp://ftp.stat.math.ethz.ch/Mail-archives/

>     which is a directory of mail archive files.

>     You will be looking at  
> 	    r-testers-... (the old scheme)
> 	    r-announce-...
> 	    r-help-...
> 	    r-devel-...

Martin,

Thanks for the update.  (Writing something about mailing list archives
had been on my mind for some time now, but I could bot decide whether
CRAN should start mirroring the archives right away ...)

The FAQ now says,

  Archives of the three mailing lists are made publicly available on the
  net in a monthly schedule at ftp://ftp.stat.math.ethz.ch/Mail-
  archives/ (which is a directory of mail archive files).

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Tue Apr 29 13:35:36 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 29 Apr 1997 14:35:36 +0200
Subject: R-alpha: R-0.49:  2 problems
In-Reply-To: Ross Ihaka's message of Tue, 29 Apr 1997 09:16:05 +1200 (NZST)
References: <199704280507.HAA02509@aragorn.ci.tuwien.ac.at>
 <199704282116.JAA24437@stat1.stat.auckland.ac.nz>
Message-ID: <x29122vwfb.fsf@bush.kubism.ku.dk>

Ross Ihaka <ihaka@stat.auckland.ac.nz> writes:

> 
> Kurt Hornik writes:
>  > I found the following 2 problems (no debugging, sorry).
>  > 
>  > * qt(0.975, 3) never returns.
>  > 
>  > Can someone please check that?  Happens for me on Debian GNU/Linux/ix86
>  > compiled with CFLAGS="-O2 -g".
> 
> I am having a look at the computations of p-values and quantiles which
> depend on the incomplete beta function at  present. ....

The original problem seems to be one of loss of accuracy with
instruction reordering. Doubling the value of "acu" cures it (I ran it
under the debugger and the test value was stuck at about 1.5e-32,
being compared to acu=1e-23). This is probably a generic problem with
these last-bit-accurate routines.


-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Tue Apr 29 14:40:10 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 29 Apr 1997 15:40:10 +0200
Subject: R-alpha: R-0.49:  2 problems
In-Reply-To: Peter Dalgaard BSA's message of 29 Apr 1997 14:35:36 +0200
References: <199704280507.HAA02509@aragorn.ci.tuwien.ac.at>
 <199704282116.JAA24437@stat1.stat.auckland.ac.nz>
 <x29122vwfb.fsf@bush.kubism.ku.dk>
Message-ID: <x267x6vtfp.fsf@bush.kubism.ku.dk>

Peter Dalgaard BSA <p.dalgaard@kubism.ku.dk> writes:

> under the debugger and the test value was stuck at about 1.5e-32,
> being compared to acu=1e-23). This is probably a generic problem
                           ^^

Ugh. Make that thirty-two, please...

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Tue Apr 29 23:21:46 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 30 Apr 1997 00:21:46 +0200
Subject: R-alpha: frametools v.0.0000001
Message-ID: <x2wwplzczp.fsf@bush.kubism.ku.dk>

The following three functions are designed to make manipulation of
dataframes easier. I won't write detailed docs just now, but if you
follow the example below, you should get the general picture. Comments
are welcome, esp. re. naming conventions. 

Note that these functions are definitely not portable to S because
they rely on R's scoping rules. Not that difficult to fix, though: The
nm vector and the "parsing" functions need to get assigned to
(evaluation) frame 1 (the "expression frame" of S), and preferably
removed at exit.

data(airquality)
aq<-airquality[1:10,]
select.frame(aq,Ozone:Temp)
subset.frame(aq,Ozone>20)
modify.frame(aq,ratio=Ozone/Temp)

Notice that in modify.frame(), any *new* variable must appear as a
tag, not as the result of an assignment, i.e.:

modify.frame(aq,Ozone<-log(Ozone)) works as expected
modify.frame(aq,lOzone<-log(Ozone)) does not.

This is mainly because it was tricky to figure out what part of a left
hand side constitutes a new variable to be created (note that indexing
could be involved). So assignments to non-existing variables just
create them as local variables within the function. Making a virtue
out of necessity, that might actually be considered a feature...

----------------------------------------
"select.frame" <-
function (dfr, ...) 
{
        subst.call <- function(e) {
                if (length(e) > 1) 
                        for (i in 2:length(e)) e[[i]] <- subst.expr(e[[i]])
                e
        }
        subst.expr <- function(e) {
                if (is.call(e)) 
                        subst.call(e)
                else match.expr(e)
        }
        match.expr <- function(e) {
                n <- match(as.character(e), nm)
                if (is.na(n)) 
                        e
                else n
        }
        nm <- names(dfr)
        e <- substitute(c(...))
        dfr[, eval(subst.expr(e))]
}
"modify.frame" <-
function (dfr, ...) 
{
        nm <- names(dfr)
        e <- substitute(list(...))
        if (length(e) < 2) 
                return(dfr)
        subst.call <- function(e) {
                if (length(e) > 1) 
                        for (i in 2:length(e)) e[[i]] <- subst.expr(e[[i]])
                substitute(e)
        }
        subst.expr <- function(e) {
                if (is.call(e)) 
                        subst.call(e)
                else match.expr(e)
        }
        match.expr <- function(e) {
                if (is.na(n <- match(as.character(e), nm))) 
                        if (is.atomic(e)) 
                                e
                        else substitute(e)
                else substitute(dfr[, n])
        }
        tags <- names(as.list(e))
        for (i in 2:length(e)) {
                ee <- subst.expr(e[[i]])
                r <- eval(ee)
                if (!is.na(tags[i])) {
                        if (is.na(n <- match(as.character(tags[i]), 
                                nm))) {
                                n <- length(nm) + 1
                                dfr[[n]] <- numeric(nrow(dfr))
                                names(dfr)[n] <- tags[i]
                                nm <- names(dfr)
                        }
                        dfr[[tags[i]]][] <- r
                }
        }
        dfr
}
"subset.frame" <-
function (dfr, expr) 
{
        nm <- names(dfr)
        e <- substitute(expr)
        subst.call <- function(e) {
                if (length(e) > 1) 
                        for (i in 2:length(e)) e[[i]] <- subst.expr(e[[i]])
                e
        }
        subst.expr <- function(e) {
                if (is.call(e)) 
                        subst.call(e)
                else match.expr(e)
        }
        match.expr <- function(e) {
                if (is.na(n <- match(as.character(e), nm))) 
                        e
                else dfr[, n]
        }
        r <- eval(subst.expr(e))
        r <- r & !is.na(r)
        dfr[r, ]
}


-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Wed Apr 30 05:56:08 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Wed, 30 Apr 1997 16:56:08 +1200 (NZST)
Subject: R-alpha: New Incomplete Beta Function
Message-ID: <199704300456.QAA07452@stat1.stat.auckland.ac.nz>

Here is a drop-in replacement for the R incomplete beta function.

	src/math/pbeta.c

It is a slightly modified version of the cephes library one from
Netlib.  In the few cases I tried it seems to give at least 14
digit agreement with the one in S-PLUS (its hard to get more).

I'm not sure what performance is like.  I'd like to know if it
helps with some of the problems which have been reported for the
t and F code in R.

If it works It'll be in an official second patch for 0.49 later in
the week (so just swap it temporarily with the old one).

	Ross


- - s n i p - - h e r e - -

/*
 *    Incomplete Beta Integral
 *
 *    Taken from Cephes Math Library, Release 2.3:  March, 1995
 *    Copyright 1984, 1995 by Stephen L. Moshier
 *    Changes for R : Copyright 1997 by Ross Ihaka
 */

#include <math.h>
#include <float.h>
#include <errno.h>

static double incbcf(), incbd(), pseries();

static double big = 4.503599627370496e15;
static double biginv = 2.22044604925031308085e-16;


double pbeta(double xx, double aa, double bb)
{
	double a, b, t, x, xc, w, y;
	int flag;

	if (aa <= 0 || bb <= 0)
		goto domerr;

	if (xx <= 0 || xx >= 1) {
		if (xx == 0)
			return 0;
		if (xx == 1)
			return 1;
domerr:
		errno = EDOM;
		return 0;
	}
	flag = 0;
	if (bb * xx <= 1 && xx <= 0.95) {
		t = pseries(aa, bb, xx);
		goto done;
	}
	w = 1 - xx;

	/* Reverse a and b if x is greater than the mean. */

	if (xx > (aa / (aa + bb))) {
		flag = 1;
		a = bb;
		b = aa;
		xc = xx;
		x = w;
	} else {
		a = aa;
		b = bb;
		xc = w;
		x = xx;
	}

	if (flag == 1 && (b * x) <= 1 && x <= 0.95) {
		t = pseries(a, b, x);
		goto done;
	}

	/* Choose expansion for better convergence. */

	y = x * (a + b - 2) - (a - 1);
	if (y < 0)
		w = incbcf(a, b, x);
	else
		w = incbd(a, b, x) / xc;

	/* Multiply w by the factor
	     a      b   _             _     _
	    x  (1-x)   | (a+b) / ( a | (a) | (b) ) .   */

	y = a * log(x);
	t = b * log(xc);

	/* Resort to logarithms.  */

	y += t + lgamma(a + b) - lgamma(a) - lgamma(b);
	y += log(w / a);
	t = exp(y);

done:

	if (flag == 1) {
		if (t <= DBL_EPSILON)
			t = 1 - DBL_EPSILON;
		else
			t = 1 - t;
	}
	return t;
}


/* Continued fraction expansion #1
 * for incomplete beta integral
 */

static double incbcf(double a, double b, double x)
{
	double xk, pk, pkm1, pkm2, qk, qkm1, qkm2;
	double k1, k2, k3, k4, k5, k6, k7, k8;
	double r, t, ans, thresh;
	int n;

	k1 = a;
	k2 = a + b;
	k3 = a;
	k4 = a + 1;
	k5 = 1;
	k6 = b - 1;
	k7 = k4;
	k8 = a + 2;

	pkm2 = 0;
	qkm2 = 1;
	pkm1 = 1;
	qkm1 = 1;
	ans = 1;
	r = 1;
	n = 0;
	thresh = 3 * DBL_EPSILON;
	do {

		xk = -(x * k1 * k2) / (k3 * k4);
		pk = pkm1 + pkm2 * xk;
		qk = qkm1 + qkm2 * xk;
		pkm2 = pkm1;
		pkm1 = pk;
		qkm2 = qkm1;
		qkm1 = qk;

		xk = (x * k5 * k6) / (k7 * k8);
		pk = pkm1 + pkm2 * xk;
		qk = qkm1 + qkm2 * xk;
		pkm2 = pkm1;
		pkm1 = pk;
		qkm2 = qkm1;
		qkm1 = qk;

		if (qk != 0)
			r = pk / qk;
		if (r != 0) {
			t = fabs((ans - r) / r);
			ans = r;
		} else
			t = 1;

		if (t < thresh)
			goto cdone;

		k1 += 1;
		k2 += 1;
		k3 += 2;
		k4 += 2;
		k5 += 1;
		k6 -= 1;
		k7 += 2;
		k8 += 2;

		if ((fabs(qk) + fabs(pk)) > big) {
			pkm2 *= biginv;
			pkm1 *= biginv;
			qkm2 *= biginv;
			qkm1 *= biginv;
		}
		if ((fabs(qk) < biginv) || (fabs(pk) < biginv)) {
			pkm2 *= big;
			pkm1 *= big;
			qkm2 *= big;
			qkm1 *= big;
		}
	}
	while (++n < 300);

cdone:
	return ans;
}



/* Continued fraction expansion #2
 * for incomplete beta integral
 */

static double incbd(double a, double b, double x)
{
	double xk, pk, pkm1, pkm2, qk, qkm1, qkm2;
	double k1, k2, k3, k4, k5, k6, k7, k8;
	double r, t, ans, z, thresh;
	int n;

	k1 = a;
	k2 = b - 1;
	k3 = a;
	k4 = a + 1;
	k5 = 1;
	k6 = a + b;
	k7 = a + 1;
	k8 = a + 2;

	pkm2 = 0;
	qkm2 = 1;
	pkm1 = 1;
	qkm1 = 1;
	z = x / (1 - x);
	ans = 1;
	r = 1;
	n = 0;
	thresh = 3 * DBL_EPSILON;
	do {

		xk = -(z * k1 * k2) / (k3 * k4);
		pk = pkm1 + pkm2 * xk;
		qk = qkm1 + qkm2 * xk;
		pkm2 = pkm1;
		pkm1 = pk;
		qkm2 = qkm1;
		qkm1 = qk;

		xk = (z * k5 * k6) / (k7 * k8);
		pk = pkm1 + pkm2 * xk;
		qk = qkm1 + qkm2 * xk;
		pkm2 = pkm1;
		pkm1 = pk;
		qkm2 = qkm1;
		qkm1 = qk;

		if (qk != 0)
			r = pk / qk;
		if (r != 0) {
			t = fabs((ans - r) / r);
			ans = r;
		} else
			t = 1;

		if (t < thresh)
			goto cdone;

		k1 += 1;
		k2 -= 1;
		k3 += 2;
		k4 += 2;
		k5 += 1;
		k6 += 1;
		k7 += 2;
		k8 += 2;

		if ((fabs(qk) + fabs(pk)) > big) {
			pkm2 *= biginv;
			pkm1 *= biginv;
			qkm2 *= biginv;
			qkm1 *= biginv;
		}
		if ((fabs(qk) < biginv) || (fabs(pk) < biginv)) {
			pkm2 *= big;
			pkm1 *= big;
			qkm2 *= big;
			qkm1 *= big;
		}
	}
	while (++n < 300);
cdone:
	return ans;
}


/* Power series for incomplete beta integral.
   Use when b*x is small and x not too close to 1.  */

static double pseries(double a, double b, double x)
{
	double s, t, u, v, n, t1, z, ai;

	ai = 1 / a;
	u = (1 - b) * x;
	v = u / (a + 1);
	t1 = v;
	t = u;
	n = 2;
	s = 0;
	z = DBL_EPSILON * ai;
	while (fabs(v) > z) {
		u = (n - b) * x / n;
		t *= u;
		v = t / (a + n);
		s += v;
		n += 1;
	}
	s += t1;
	s += ai;

	u = a * log(x);
	t = lgamma(a + b) - lgamma(a) - lgamma(b) + u + log(s);
	s = exp(t);
	return s;
}
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Wed Apr 30 06:52:23 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 30 Apr 1997 07:52:23 +0200
Subject: R-alpha: New Incomplete Beta Function
In-Reply-To: <199704300456.QAA07452@stat1.stat.auckland.ac.nz>
References: <199704300456.QAA07452@stat1.stat.auckland.ac.nz>
Message-ID: <199704300552.HAA17098@aragorn.ci.tuwien.ac.at>

>>>>> Ross Ihaka writes:

> Here is a drop-in replacement for the R incomplete beta function.
> 	src/math/pbeta.c

> It is a slightly modified version of the cephes library one from
> Netlib.  In the few cases I tried it seems to give at least 14
> digit agreement with the one in S-PLUS (its hard to get more).

> I'm not sure what performance is like.  I'd like to know if it
> helps with some of the problems which have been reported for the
> t and F code in R.

Indeed, `qt(0.975, 3)' now also works on Debian Linux/GNU/ix86 when
compiled with `-O2 -g'.

Thanks!

(Of course, this is the only example I tried thus far ...)

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Wed Apr 30 10:40:54 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 30 Apr 1997 11:40:54 +0200
Subject: R-alpha: Re: R-beta: Re: S Compatibility
In-Reply-To: Ross Ihaka's message of Wed, 30 Apr 1997 14:27:07 +1200 (NZST)
References: <199704300227.OAA06297@stat1.stat.auckland.ac.nz>
Message-ID: <x2k9lk4zmh.fsf@bush.kubism.ku.dk>

Ross Ihaka <ihaka@stat.auckland.ac.nz> writes:

[on out-of-memory data]
> 
> Its something we definitely need (almost as much as REAL libraries).
> If only there were another 24 hours in each day ...

No problem. You just need someone as smart as you are to chip in with
the development. Or four people half as smart ;^)

There might also be some more "brutal" approaches, such as having the
vector heap as a memory-mapped file, leaving the cacheing and similar
work to the operating system. OS's are already quite good at handling
files with holes in them, so it's not like allocating a huge file just
for a handful af variables. Some special routines for defragmentation
might be necessary, though. Not that I really know what I'm talking
about...

At any rate, it would probably be a good thing to start thinking in
terms of modularity, database backends and such.

I've moved the thread to r-devel, it seemed to be getting too
technical for r-help.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Wed Apr 30 11:03:20 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 30 Apr 1997 12:03:20 +0200
Subject: R-alpha: New Incomplete Beta Function
In-Reply-To: Kurt Hornik's message of Wed, 30 Apr 1997 07:52:23 +0200
References: <199704300456.QAA07452@stat1.stat.auckland.ac.nz>
 <199704300552.HAA17098@aragorn.ci.tuwien.ac.at>
Message-ID: <x2iv144yl3.fsf@bush.kubism.ku.dk>

Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

> Indeed, `qt(0.975, 3)' now also works on Debian Linux/GNU/ix86 when
> compiled with `-O2 -g'.
> 
> Thanks!
> 
> (Of course, this is the only example I tried thus far ...)
> 

I suspect that the problem will just crop up again with a different
parameter combination. The original problem was really in qbeta.c, not
pbeta.c. Some of those routines are squeezing the last bit of accuracy
out by doing the computations in a carefully planned sequence. Along
comes the gcc optimizer and says "but it's faster to do it this way",
shuffles the instructions around and we get these problems with
termination criteria that are sometimes never met, depending on bit
patterns at the far end of intermediate results.

(The prototypical problem is that in computers, x + delta - x == 0 for
large x and small delta - unless the compiler decides to use
associativity commutativity and eliminate the x'es. Slightly more
elaborate version is x+delta-y with x and y already in registers and
being almost equal.)

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Wed Apr 30 11:04:24 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 30 Apr 97 12:04:24 +0200
Subject: R-alpha: New pbeta.c : Still problems for BIG 'df' (and an S-bug)
In-Reply-To: <199704300456.QAA07452@stat1.stat.auckland.ac.nz> (message from
 Ross Ihaka on Wed, 30 Apr 1997 16:56:08 +1200 (NZST))
Message-ID: <9704301004.AA01392@>

I've only made a few experiments using  qt(.)  with the new pbeta.c:

At least the problem of  "BIG df" --> 'long/infinite' CPU  remains even
though it has been pushed slightly

For 0.49 'plain', 
	qt(.99, 10^k) already takes quite some time for k=5, and 
			takes for ever for k=7
Try
	for(ee in 1:6) cat(10^ee,":", unix.time(qt(.99,df=10^ee))[1],"\n")

For the new  pbeta.c,  the problem appears about two exponents later.

 	qt(.99, df = 1e8)	## 'never' returns

The following code shows you a bit of what is going on.

BTW, S-plus seems to use a different approximation which remains fast even
when df = BIG.
However, S-plus results then become COMPLETELY RUBBISH!

Here are my few tests:

p <- c(.975, .995, .9995, 1 - 5e-6)
df1 <- c(1:5,10^c(1:8,10,15,10*(2:10)))
df0 <- df1[1:12] ## df0  works for  R 0.49 -patch2-

dig <- 8
for(df in df0)
  cat(formatC(df,w=6),":", formatC(unix.time(qq <- qt(p, df))[1],form='f'), "|",
      formatC(qq, form='f', dig=dig,wid=dig+6),"\n")
cat(" _Inf_ :  ---   |", formatC(qnorm(p), form='f', dig=dig,wid=dig+6),"\n")

## R 0.49  with  pbeta.c  of 30 April 1997:

   df  :  CPU[s]|     q  .975           .995         .9995       .999995=1-5e-6

     1 : 0.0100 |    12.70620474    63.65674116   636.61924876 63661.96977709
     2 : 0.0200 |     4.30265273     9.92484320    31.59905458   316.22539430
     3 : 0.0000 |     3.18244631     5.84090931    12.92397864    60.39682404
     4 : 0.0000 |     2.77644511     4.60409487     8.61030158    27.77164766
     5 : 0.0100 |     2.57058184     4.03214298     6.86882663    17.89686614
    10 : 0.0100 |     2.22813885     3.16927267     4.58689386     8.15028656
   100 : 0.0900 |     1.98397152     2.62589052     3.39049131     4.65424006
  1000 : 0.0300 |     1.96233908     2.58075470     3.30028265     4.43992647
 1e+04 : 0.0400 |     1.96020124     2.57632105     3.29149997     4.41943950
 1e+05 : 0.1300 |     1.95998771     2.57587847     3.29062403     4.41739993
 1e+06 : 0.2800 |     1.95996636     2.57583422     3.29053646     4.41719606
 1e+07 : 0.3800 |     1.95996422     2.57582979     3.29052770     4.41717568
 _Inf_ :  ---   |     1.95996398     2.57582930     3.29052672     4.41718074

## S-plus (3.4): From df ~= 1e4 (p=1-5e-6) results are COMPLETELY wrong !
## ----- You get quick results for even higher 'df' -- but they are wrong...

     1 : 0.0100 |    12.70620474    63.65674116   636.61924876 63661.96770658
     2 : 0.0000 |     4.30265273     9.92484320    31.59905458   316.22539430
     3 : 0.0000 |     3.18244631     5.84090931    12.92397864    60.39682404
     4 : 0.0100 |     2.77644511     4.60409487     8.61030158    27.77164766
     5 : 0.0000 |     2.57058184     4.03214298     6.86882663    17.89686614
    10 : 0.0000 |     2.22813885     3.16927267     4.58689386     8.15028656
   100 : 0.0100 |     1.98397152     2.62589052     3.39049131     4.65424006
  1000 : 0.0200 |     1.96233908     2.58075470     3.30028265     4.43992647
 1e+04 : 0.0200 |     1.96020124     2.57632105     3.29966223     4.70204286
 1e+05 : 0.0200 |     1.95998771     2.57587848     5.14482712    12.48628360
 1e+06 : 0.0100 |     1.95996636     2.57583569    14.70818229    38.67299101
 1e+07 : 0.0200 |     1.95996422     2.57600108    45.98857869   122.03496539
 _Inf_ :  ---   |     1.95996398     2.57582930     3.29052673     4.41717341

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Wed Apr 30 11:38:51 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 30 Apr 1997 12:38:51 +0200
Subject: R-alpha: write()
Message-ID: <199704301038.MAA18107@aragorn.ci.tuwien.ac.at>

Following my posting of a write.table() function, Martin suggested that
one could have a generic write() function and special methods for
e.g. time series, data frames, etc.

Well, a month has passed since ...

What does everyone think?  Is it a good idea, or would write.table() be
enough?  If we think that it is not enough, which arguments should the
write methods typically allow?  What about

	write.xxx (x,		# object
		   file =       # filename, default stdout
                   append =     # obvious
                   sep =	# obvious
		   eol =        # end of line char
                   ...)

???

On the other hand, it seems clear that something like write.table() is
nice, and what it should do.  But what about classes other than
data.frame?

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From luke@stat.umn.edu  Wed Apr 30 16:44:31 1997
From: luke@stat.umn.edu (Luke Tierney)
Date: Wed, 30 Apr 1997 10:44:31 -0500 (CDT)
Subject: R-alpha: Re: S Compatibility
Message-ID: <9704301544.AA10475@nokomis.stat.umn.edu>

On the memory/database/persistent storage issue,the Texas persistent
store, for which Rscheme has an interface, some of the stuff on object
serialization in Java (Java beans variant of OpenDoc's
Bento/quilt/whatever) and (gulp) OLE structured storage might be worth
a look in this context also.
 
luke


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Wed Apr 30 16:55:23 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 30 Apr 97 17:55:23 +0200
Subject: R-alpha: write()
In-Reply-To: <199704301038.MAA18107@aragorn.ci.tuwien.ac.at> (message from
 Kurt Hornik on Wed, 30 Apr 1997 12:38:51 +0200)
Message-ID: <9704301555.AA01443@>

Note that S has a  write(.)  function  which would be our
	write.default(.)

your	write.table	    would be our 
	write.data.frame

The only addition would be a  'write.matrix' which would be 'like'
write.data.frame, the only problem being that  'matrix' is not a class (yet).
	[Note that in S4, everything has a class; 
	   I'm voting for matrices to have a class in R  ..]
write.default  could 'despatch' to write.matrix if  x  is a matrix.
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Wed Apr 30 17:42:52 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Wed, 30 Apr 1997 09:42:52 -0700 (PDT)
Subject: R-alpha: ==NULL
In-Reply-To: <199704301038.MAA18107@aragorn.ci.tuwien.ac.at>
Message-ID: <Pine.SUN.3.95.970430093849.302A-100000@zen>


Any comparison with NULL generates an error
Error: comparison is possible only for vector types
whereas in S(-PLUS) it gives NA, which seems more sensible.

Along similar lines, comparison with a length 0 vector returns logical(0)
in R but NA in S. 

Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From la-jassine@aix.pacwan.net  Wed Apr 30 11:25:51 1997
From: la-jassine@aix.pacwan.net (Paul Gilbert)
Date: Wed, 30 Apr 1997 07:25:51 -0300
Subject: R-alpha: small complex problems
Message-ID: <1349681347-914582@aix.pacwan.net>

Mod, Re, Im, and Conj should work for Real numbers using as.complex

complex should be
   complex <- function (n = 0, real = numeric(), imaginary = numeric())
not 
   complex <- function (n = 0, real = numeric(), imag = numeric()) 


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From la-jassine@aix.pacwan.net  Wed Apr 30 11:25:59 1997
From: la-jassine@aix.pacwan.net (Paul Gilbert)
Date: Wed, 30 Apr 1997 07:25:59 -0300
Subject: R-alpha: false warnings
Message-ID: <1349681339-915060@aix.pacwan.net>

In R 0.49 comparison of logic matrices with & and | seems to sometimes
generate false warning messages about longer object length is not a multiple
of shorter object length. I have not been able to isolate the exact
circumstances.

Paul Gilbert

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From la-jassine@aix.pacwan.net  Wed Apr 30 11:25:53 1997
From: la-jassine@aix.pacwan.net (Paul Gilbert)
Date: Wed, 30 Apr 1997 07:25:53 -0300
Subject: R-alpha: generic print
Message-ID: <1349681345-914696@aix.pacwan.net>

I have  always thought that typing the name of an object generated a call to
the print method for the object, however,  (in 0.49) I redefined the generic
print method as 

print <- function(x, ...)
 {if (is.tframe(x))  UseMethod("print.tframe")
  else UseMethod("print")
 }

Now I have an object z which returns TRUE to is.tframe(z) and
> class(z)
[1] "ts"     "tframe"

Then

> print(z)
[1] 1981.50 2006.25    4.00

But
> z
Error: comparison is possible only for vector types

> traceback()
[1] "c(\"print.ts(structure(c(1981.5, 2006.25, 4), class = c(\\\"ts\\\",
\\\"tframe\\\"\", "
[2] "c(\"print(structure(c(1981.5, 2006.25, 4), class = c(\\\"ts\\\",
\\\"tframe\\\"\", "   

This is generating a call to the class method print.ts rather than to
print.tframe.ts as is done when I use print(z).  If my understanding that
typing the name of an object should generate a call to the print method for
the object then this is a bug. Otherwise, could someone please explain to me
what it does. Thanks.

Paul Gilbert

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Wed Apr 30 22:01:33 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Thu, 1 May 1997 09:01:33 +1200 (NZST)
Subject: R-alpha: Re: R-beta: Re: S Compatibility
Message-ID: <199704302101.JAA10310@stat1.stat.auckland.ac.nz>

Peter Dalgaard writes:

> > Its something we definitely need (almost as much as REAL libraries).
> > If only there were another 24 hours in each day ...

> No problem. You just need someone as smart as you are to chip in with
> the development. Or four people half as smart ;^)

Or half the time of someone twice as smart ...
Did I see you putting your hand up? :-)

> There might also be some more "brutal" approaches, such as having the
> vector heap as a memory-mapped file, leaving the cacheing and similar
> work to the operating system. OS's are already quite good at handling
> files with holes in them, so it's not like allocating a huge file just
> for a handful af variables. Some special routines for defragmentation
> might be necessary, though. Not that I really know what I'm talking
> about...

I recall that the reason we got into this is first place was watching
S thrashing our disks to bits while the cpus stood idle ...
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

