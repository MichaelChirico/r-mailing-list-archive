From Martin Maechler <maechler@stat.math.ethz.ch>  Mon Nov  3 17:54:13 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Mon, 3 Nov 1997 18:54:13 +0100
Subject: R-alpha: expression(..) objects -- c(ex1, ex2) `fails'
Message-ID: <199711031754.SAA01954@sophie.ethz.ch>

When investigating  the  
	legend(x,y, expression ( <math>, <math> ), ....)
			 [as suggested by Jim Lindsey],
I once again stumbled over the fact that expression objects behave somewhat
``wierdly'', IMHO.

We can have expressions of length(.) > 1, and access elements of these like
list elements.
However, other natural things don't work with expressions; some example code:


##-- `Simple'  length--1  expressions:
ex1 <- expression(hat(beta) == (X^t * X)^{-1} * X^t * y)
ex2 <- expression(bar(x) == sum(over(x[i], n), i==1, n))
ex3 <- expression(paste(over(1, sigma*sqrt(2*pi)), " ",
    plain(e)^{over(-(x-mu)^2, 2*sigma^2)}))

##-- A length--2 expression:
ex12 <- expression(bar(x) == sum(over(x[i], n), i==1, n),
    		   hat(x) == median(x[i], i==1,n))
mode(ex12) # expression
length(ex12)# 2

mode(ex12 [1]) # expression
mode(ex12[[1]]) # call 
length(ex12[1])# 1
ex12 == ex12[1:2] #> TRUE TRUE


mode(c(ex1,ex2))#> "list" --->> This should be "expression" I think ...
##				---------------------------
mode(ex.12 <- as.expression(c(ex1,ex2))) # "expression"
## but the wrong one:
length(ex.12)# [1] 1
ex.12 #-- still has 'list(..)' in it...

###-> How could I take ex1, ex2 and "concat" them to an expression
###  of length 2 ?





=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From p.dalgaard@kubism.ku.dk  Mon Nov  3 18:27:53 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 03 Nov 1997 19:27:53 +0100
Subject: R-alpha: expression(..) objects -- c(ex1, ex2) `fails'
In-Reply-To: Martin Maechler's message of Mon, 3 Nov 1997 18:54:13 +0100
References: <199711031754.SAA01954@sophie.ethz.ch>
Message-ID: <x2iuu9hlxy.fsf@blueberry.kubism.ku.dk>

Martin Maechler <maechler@stat.math.ethz.ch> writes:
[I've taken out the ">" citation symbols to allow cut and paste]

##-- `Simple'  length--1  expressions:
ex1 <- expression(hat(beta) == (X^t * X)^{-1} * X^t * y)
ex2 <- expression(bar(x) == sum(over(x[i], n), i==1, n))

##-- A length--2 expression:
ex12 <- expression(bar(x) == sum(over(x[i], n), i==1, n),
  hat(x) == median(x[i], i==1,n))

##please avoid TABS, Martin. It confuses readline...

> ###-> How could I take ex1, ex2 and "concat" them to an expression
> ###  of length 2 ?

#Heh. One would at least expect
l<-NULL
l[[1]]<-ex1[[1]]
l[[2]]<-ex2[[1]]
#to be a list of calls, which by definition is what an expression is,
#so you'd only need to change the mode, but:

 
mode(e)<-"expression" 
e
# expression(list(hat(beta) == (X^t * X)^{
#         -1
# } * X^t * y, bar(x) == sum(over(x[i], n), i == 1, n)))

#(Why does it deparse in that strange way, BTW?)

#Also, textual representations of length-2 expressions is acting up:
deparse(ex12)
#[1] "bar(x) == sum(over(x[i], n), i == 1, n)"
str(ex12)
# bar(x) == sum(over(x[i], n), i == 1, n)
dput(ex12)
# bar(x) == sum(over(x[i], n), i == 1, n)
deparse(ex12[[2]])
# [1] "hat(x) == median(x[i], i == 1, n)"

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Nov  4 10:52:42 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 4 Nov 1997 11:52:42 +0100
Subject: R-alpha: Re: Separation of Program & Doc;  REQUIRING Perl5 [was: New Version]
In-Reply-To: <199711030736.IAA00272@pc25.none> (message from Kurt Hornik on
 Mon, 3 Nov 1997 08:36:39 +0100)
Message-ID: <199711041052.LAA02657@sophie.ethz.ch>

[[Again I diverge to R-devel, I think we need more opinions here...]]

>>>>> "KH" == Kurt Hornik <hornik@ci.tuwien.ac.at> writes:

>>>>> Ross Ihaka writes:
    >> I am beginning to get a bit more free time and I would like to get a
    >> "stable" version out as soon as possible.  (This is of course so I can
    >> break absolutely everything without feeling too much pressure to get
    >> things working again quickly :-).

    >> Using perl has produced some build problems because version 5 is not
    >> a universal standard.  There is even no guarantee that any kind of
    >> perl would be available.

    >> It would be nice if the installation could happen without perl.  I
    >> think this is possible if we separate the building of help files from
    >> the compilation/installation of binaries.  Preconfigured help files
    >> could then be distributed separately for anyone who lacks (the correct
    >> version of) perl, or at the cost of a little bloat, be part of the
    >> distribution.
I agree [see below]

    >> Alternatively we could just say "YOU MUST HAVE PERL VERSION 5" and
    >> enforce this with configuration checks.  This is rather user-hostile,
    >> but it does make things simple for us.

    >> Watcha think?

    KH> Well, better late than never (I was on a business trip for the past few
    KH> days), let me say that I am very unhappy about splitting INSTALL into a
    KH> doc and a non-doc part.  Let me explain why.

    KH> From a pedagogical point of view, it creates the impression that one can
    KH> actually `install' a package without the documentation.  This is not
    KH> true, because the documentation is an integral part of the package.  We
    KH> need to force packages writers/maintainers into providing accurate and
    KH> comprehensive documentation, and we need users to use it ...

Yes, [of course] I very much agree.  You may (not) know that I got involved
in R hacking first with the aim of improving documentation considerably
and pushing the idea that we need interesting / relevant examples as 
a very important part of docu.

    KH> From the R Core group's perspective, (I think) it does not solve the
    KH> problem.  The problem is that although we would all be very happy to
    KH> have Perl, and in fact version 5, available on all systems (and NOTE
    KH> that we chose Perl because unlike the shell it is also available on
    KH> non-Unix platforms, dubious as these may be), this does not seem to be
    KH> that case.  We now have Perl show up in both the documentation setup
    KH> process as well as in at least one user-level function, with perhaps
    KH> more to come.

hmm, I think that I said before that I don't like this (R function calling
perl) so much. 
It is nice that for non-Unix platforms, Perl is more available than a shell
(with sed, awk, ....).
However, Perl is not (yet ?) part of standard Unix [unfortunately].
Using perl from R functions  URGES users to have perl available.
This would prohibit the use of R for MANY who don't have a good access to
their system administrators [[which is not so rare, even at Universities..]].

The ``idea'' I got (which seems to be close to Ross' one) was:

A. For a Unix user, if she has perl available, she only needs the 
   base tar file, does ./configure  and
   make (good idea to INCLUDE 'make help' by default !) --> and has all

B. Unix users without Perl, or  Windows / Mac  users:
   
   Besides the base tar/zip file, 
   they need to get the precompiled online help --- as distributed by CRAN,
   in addition, and then can use (but not enhance conveniently) the help.

 We could well setup things such that these users are really REQUIRED to
 get the precompiled help  (following the above point that the doc is
			    integral part of the software).

    KH> Ross, as far as I understand your intentions, you want both `make
    KH> install' and `R INSTALL pkg lib' to work even if Perl 5 is not there.
    KH> The current solution (having install and INSTALL only operate things
    KH> which do not depend on the availability of Perl 5) is a fix, but of
    KH> course users could still do `make install-docs' and `R INSTALL-DOC' on
    KH> the `unfortunate' platforms.  What would happen then?  Well, I think
    KH> they should get a clean (and maybe not error-type) message saying sorry,
    KH> you asked for something which requires Perl 5, which does not seem to be
    KH> available on your system.  Now, the best possible way for this to be
    KH> accomplished would be via the configure script, which could not only
    KH> check for where Perl is, but also whether it is version 5 or not, and
    KH> record this information where needed.  (Maybe even in the R shell
    KH> script.)  E.g., if Perl 5 was found, we'd have

    KH> PERL5=y

    KH> in etc/INSTALL, and then code like

    KH> if [ "$PERL5" != "y" ];
    KH> then
    KH> echo "Sorry, you need ..."
    KH> exit 1
    KH> else
    KH> PROCEED.AS.USUAL()
    KH> fi

    KH> Functions based on Perl scripts could be treated in a unified manner via
    KH> a function perl().  Calling

    KH> perl(script, arg1, arg2, ...)

    KH> would under Unix be the same as

    KH> system(paste("perl", arg1, arg2, ..., collapse = TRUE))

    KH> but be set up in a way that a graceful error message is returned if Perl
    KH> was not available at compilation time.  In fact, we could even give
    KH> perl() a named version argument, or use perl() and perl5()?

    KH> (As an aside, my above reasoning also reflects my attitude that `make
    KH> install' should automatically install the documentation as well.)

Once more, I almost agree on that.

I think  `make' should install the program and doc
	(== current `make install docs')
 If perl is not available, installers should get your message above,
 PLUS the hint that 
	1) they must get the pre-compiled help from CRAN 
		and AFTER installing it,
	2) `make'  (or maybe, even `make install-program')
 will install the software alone [[docs being in place, unpacked from
				  precompiled CRAN help]].

    KH> Enough said.  Opinions?
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From pgilbert@bank-banque-canada.ca  Tue Nov  4 14:25:17 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Tue, 4 Nov 1997 09:25:17 -0500
Subject: R-alpha: Re: Separation of Program & Doc;  REQUIRING Perl5 [was: New Version]
References: <199711041052.LAA02657@sophie.ethz.ch>
Message-ID: <97Nov4.093029est.26503@mailgate.bank-banque-canada.ca>

>B. Unix users without Perl, or  Windows / Mac  users:
 >  Besides the base tar/zip file,
 >  they need to get the precompiled online help --- as distributed by
CRAN,
 >  in addition, and then can use (but not enhance conveniently) the
help.

This does not seem unreasonable for Windows/Mac users since, if I
understand the situation correctly, they will also need a pre-compiled
version of some C and Fortran. For Unix users without Perl5 the
situation is not so obvious. (It might be easier to distribute Perl5
than precompiled versions of all possible Unix versions.)

Also, for users always connected to the Internet, it is not really clear
that they always need and should be forced to have the help on their own
machine. Effectively it is, or can be made, available on line. There are
advantages to this: the help can be updated and corrected on the fly.
(Assuming, of course, that it is not perfect to begin with.)

Paul Gilbert


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From pgilbert@bank-banque-canada.ca  Tue Nov  4 14:31:59 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Tue, 4 Nov 1997 09:31:59 -0500
Subject: R-alpha: l2c libraries
Message-ID: <97Nov4.093841est.26501@mailgate.bank-banque-canada.ca>

How is the problem of l2c libraries being resolved in 0.60? I continue
to have problems with  ld.so.1: /.../R.binary: fatal: relocation error:
symbol not found: pow_ii: referenced in /.../dsefor.so where dsefor.so
is my compiled fortran.

Paul Gilbert

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Nov  4 14:47:54 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 4 Nov 1997 15:47:54 +0100
Subject: R-alpha: Re: Separation of Program & Doc;  REQUIRING Perl5 [was: New Version]
In-Reply-To: <97Nov4.093029est.26503@mailgate.bank-banque-canada.ca> (message
 from Paul Gilbert on Tue, 4 Nov 1997 09:25:17 -0500)
Message-ID: <199711041447.PAA02817@sophie.ethz.ch>

>>>>> "PaulG" == Paul Gilbert <pgilbert@bank-banque-canada.ca> writes:

    >> B. Unix users without Perl, or  Windows / Mac  users:
    >> Besides the base tar/zip file,
    >> they need to get the precompiled online help --- as distributed by
    PaulG> CRAN,
    >> in addition, and then can use (but not enhance conveniently) the
    PaulG> help.

    PaulG> This does not seem unreasonable for Windows/Mac users since, if
    PaulG> I understand the situation correctly, they will also need a
    PaulG> pre-compiled version of some C and Fortran. For Unix users
    PaulG> without Perl5 the situation is not so obvious. (It might be
    PaulG> easier to distribute Perl5 than precompiled versions of all
    PaulG> possible Unix versions.)


    PaulG> Also, for users always connected to the Internet, it is not really clear
    PaulG> that they always need and should be forced to have the help on their own
    PaulG> machine. Effectively it is, or can be made, available on line. There are
    PaulG> advantages to this: the help can be updated and corrected on the fly.
    PaulG> (Assuming, of course, that it is not perfect to begin with.)

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From bates@stat.wisc.edu  Tue Nov  4 14:53:53 1997
From: bates@stat.wisc.edu (Douglas Bates)
Date: 04 Nov 1997 08:53:53 -0600
Subject: R-alpha: Re: Separation of Program & Doc;  REQUIRING Perl5 [was: New Version]
In-Reply-To: Martin Maechler's message of Tue, 4 Nov 1997 11:52:42 +0100
References: <199711041052.LAA02657@sophie.ethz.ch>
Message-ID: <6ren4wg16m.fsf@franz.stat.wisc.edu>

Regarding Perl5 availability:
 - In the Unix world I would be surprised if people who would want to
   install R would not also have access to perl5 or be able to install
   it.  I would assert that the level of skill required to install R
   is comparable to that required to install perl.
 - For Mac or Windows are you expecting that most users would install
   from the .tar.gz file?  I would have thought that there would be
   one compilation done to create a .zip file for Windows and a .hqx
   file for the Mac.  The typical user would only need to install
   these "tar-ball" files and never need to see the part that depended 
   on perl.  If someone decides to write an R function that calls perl 
   then it will croak but the same would happen for shell scripts, awk 
   scripts, ...
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Nov  4 14:58:32 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 4 Nov 1997 15:58:32 +0100
Subject: R-alpha: Re: Separation of Program & Doc ...
In-Reply-To: <97Nov4.093029est.26503@mailgate.bank-banque-canada.ca> (message
 from Paul Gilbert on Tue, 4 Nov 1997 09:25:17 -0500)
Message-ID: <199711041458.PAA02846@sophie.ethz.ch>

>>>>> "PaulG" == Paul Gilbert <pgilbert@bank-banque-canada.ca> writes:

    >> B. Unix users without Perl, or  Windows / Mac  users:
    >> Besides the base tar/zip file,
    >> they need to get the precompiled online help --- as distributed by
    PaulG> CRAN,
    >> in addition, and then can use (but not enhance conveniently) the
    PaulG> help.

    PaulG> This does not seem unreasonable for Windows/Mac users since, if
    PaulG> I understand the situation correctly, they will also need a
    PaulG> pre-compiled version of some C and Fortran. For Unix users
    PaulG> without Perl5 the situation is not so obvious. (It might be
    PaulG> easier to distribute Perl5 than precompiled versions of all
    PaulG> possible Unix versions.)
You misunderstood: `Precompiled help' means
	 "R documentation" (a la src/library/base/man/*) in
		1) help [nroff]
		2) html
		3) latex -> PostScript
	 format.
All of these are ASCII formats.
Therefore, there is no difference in `precompiled help' between 
any operating systems (well as much as ASCII formats are the same;
			knowing that DOS has extra carriage returns ....)

    PaulG> Also, for users always connected to the Internet, it is not
    PaulG> really clear that they always need and should be forced to have
    PaulG> the help on their own machine. Effectively it is, or can be
    PaulG> made, available on line. There are advantages to this: the help
    PaulG> can be updated and corrected on the fly.  (Assuming, of course,
    PaulG> that it is not perfect to begin with.)

This maybe practical in a future internet (or in today's net within
North-America?) where bandwidth of small files 
like these is practially zero.   Today, even getting only a thousand bytes can
take many seconds, which is too long.

-- Martin Maechler <maechler@stat.math.ethz.ch>		 <><
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From Kurt.Hornik@ci.tuwien.ac.at  Tue Nov  4 15:37:33 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 4 Nov 1997 16:37:33 +0100
Subject: R-alpha: Re: Separation of Program & Doc;  REQUIRING Perl5 [was: New Version]
In-Reply-To: <6ren4wg16m.fsf@franz.stat.wisc.edu>
References: <199711041052.LAA02657@sophie.ethz.ch>
 <6ren4wg16m.fsf@franz.stat.wisc.edu>
Message-ID: <199711041537.QAA07525@pc25.none>

>>>>> Douglas Bates writes:

> Regarding Perl5 availability:
>  - In the Unix world I would be surprised if people who would want to
>    install R would not also have access to perl5 or be able to install
>    it.  I would assert that the level of skill required to install R
>    is comparable to that required to install perl.

:-)

Btw, does CPAN have binary distributions as well?

>  - For Mac or Windows are you expecting that most users would install
>    from the .tar.gz file?  I would have thought that there would be
>    one compilation done to create a .zip file for Windows and a .hqx
>    file for the Mac.  The typical user would only need to install
>    these "tar-ball" files and never need to see the part that depended 
>    on perl.  If someone decides to write an R function that calls perl 
>    then it will croak but the same would happen for shell scripts, awk 
>    scripts, ...

I am confused now.  I thought the advantage of Perl is that it is
available on non-Unix platforms as well ...?

(Of course, that does not solve the `packaging' problem ...)

-k

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From bates@stat.wisc.edu  Tue Nov  4 15:44:50 1997
From: bates@stat.wisc.edu (Douglas Bates)
Date: 04 Nov 1997 09:44:50 -0600
Subject: R-alpha: Re: Separation of Program & Doc;  REQUIRING Perl5 [was: New Version]
In-Reply-To: Kurt Hornik's message of Tue, 4 Nov 1997 16:37:33 +0100
References: <199711041052.LAA02657@sophie.ethz.ch> 	<6ren4wg16m.fsf@franz.stat.wisc.edu> <199711041537.QAA07525@pc25.none>
Message-ID: <6rd8kgfytp.fsf@franz.stat.wisc.edu>

Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

> I am confused now.  I thought the advantage of Perl is that it is
> available on non-Unix platforms as well ...?

I know there is a perl for Windows NT.  I don't know about the
Macintosh or Windows 95.

I think it would be a good idea to use perl in the installation on all
platforms.  What I was trying to say is that I imagine the "typical"
Windows or Macintosh user would not be doing the installation from
scratch but instead would be using the tar-ball format appropriate for
their system.  The only people who need to have perl for Windows or
perl for the Macintosh are those who will create the tar-balls.
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From pgilbert@bank-banque-canada.ca  Tue Nov  4 16:49:56 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Tue, 4 Nov 1997 11:49:56 -0500
Subject: R-alpha: Re: Separation of Program & Doc ...
Message-ID: <97Nov4.115513est.26513@mailgate.bank-banque-canada.ca>

>    PaulG> Also, for users always connected to the Internet, it is not
>    PaulG> really clear that they always need and should be forced to
have
 >   PaulG> the help ...
>This maybe practical in a future internet (or in today's net within
>North-America?) where bandwidth of small files
>like these is practially zero.   Today, even getting only a thousand
bytes can
>take many seconds, which is too long.

I am familiar with the low bandwidth problem and I appreciate that lots
of people will want to install help files locally. For many people in
North America the bandwidth is not so low anymore, and I am simply
pointing out that the logic of forcing everyone to install help locally
assumes a set of circumstances which may not exist for everyone.
(Although, for convenience I can certainly appreciate that doing things
one way may be a lot simpler.)

On a related, but slightly longer term issue, it is worth at least
thinking about the possibility that some code libraries could be loaded
on the fly over a high speed Internet. This is a small bandwidth
requirement compared to video, which seems to be coming more quickly
than most people thought. The advantage of this is that development can
be done more easily, continuously and quickly.  As long as the installed
base portion remains stable, newer libraries could be put in place
simply by pointing at them over the network rather than doing an
"install" in the fashion with which we are familiar.

All this is simply to point out that install strategies should probably
be considered to be for the short term rather than the long term.

Paul

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From luke@stat.umn.edu  Tue Nov  4 18:03:40 1997
From: luke@stat.umn.edu (Luke Tierney)
Date: Tue, 4 Nov 1997 12:03:40 -0600 (CST)
Subject: R-alpha: Re: Separation of Program & Doc;  REQUIRING Perl5 [was: New Version]
In-Reply-To: <199711041537.QAA07525@pc25.none> from "Kurt Hornik" at Nov 4, 97 04:37:33 pm
Message-ID: <9711041803.AA08655@nokomis.stat.umn.edu>

Kurt Hornik wrote:
> 
> >>>>> Douglas Bates writes:
> 
> > Regarding Perl5 availability:
> >  - In the Unix world I would be surprised if people who would want to
> >    install R would not also have access to perl5 or be able to install
> >    it.  I would assert that the level of skill required to install R
> >    is comparable to that required to install perl.
> 
> :-)
> 
> Btw, does CPAN have binary distributions as well?

One of the arguments someone made, as I recall, is access. Perl ought
to be installed as a system resource and the person installing R may
not have access at that level. Of course they could install a private
Perl but this is likely to create some headaches someplace down the
road.

luke

-- 
Luke Tierney
University of Minnesota                      Phone:           612-625-7843
School of Statistics                         Fax:             612-624-8868
206 Church Street                            email:      luke@stat.umn.edu
Minneapolis, MN 55455 USA                    WWW:  http://www.stat.umn.edu
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From pgilbert@bank-banque-canada.ca  Tue Nov  4 20:27:08 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Tue, 4 Nov 1997 15:27:08 -0500
Subject: R-alpha: compatibility functions
Message-ID: <97Nov4.153225est.26507@mailgate.bank-banque-canada.ca>

Below is a revised copy of my compatibility functions with additions
from Martin. I expect I may need a new version  when 0.6 arrives but I
thought it would be worth circulating this in case it suggests anything
which might be resolved before the release of 0.6 rather than after.

Thanks to a few people for pointing out the R function machine(). I have
a kludge below for determining the same information in S. If anyone has
a better way to do this I would appreciate it.

There are also several functions where the non-unix versions have not
been defined. Suggestions would be appreciated.

Paul Gilbert

##############################################################################



# This file has code which contains operating system and S/R specific
#   functions. They are intended to be used as a kernel to help
#   protect other code from these problems.

# The following functions are attempted:
#   For S/R differences:
#      global.assign, system.info, exists.graphics.device, unlink,
#      synchronize,  list.add for [["new.element"]]<-
#   For OS differences:
#     system.call, sleep, present.working.directory, whoami, file.copy,
#     file.date.info, date, mail, unlink, local.host.netname,

# Also a number of is.xxx functions are defined to identify systems.

# The variable  .SPAWN is also set to be used to identify if Splus "For"
loops
#    should be used. (It is sometimes better not to use these even in
Splus.)

##############################################################################

#            General Logic and organization of these functions

# 1/ The first group of functions are for identifying S or R and
flavours.
# 2/ The second group of functions are for identifying the operating
system.
# 3/ The third group specify a few functions which depend only on the
#         differences between S and R.
# 4/ The fourth group specify functions which depend only on the
#         differences among operating system.
# 5/ The fifth group specify a few functions which depend on both R/S
and the
#         differences among operating system.

#  >>> I would very much like any input WRT  MS Windows / Win95 / NT /
Mac <<<

# The function system.call is defined in order to provide a generic way
to
#  make a call to the operating system. However, when the calls are
specific
#  to Unix then the function unix() is used.


##############################################################################

system.info <- function()
     {if( !exists("version"))
         { #-- `Vanilla' S (i.e. here "S version 4")
           #- this now works for  S version 4  (this is not S-plus 4.0,
maybe
           #             part of S-plus 5.0 !):
           lv <- nchar(Sv <- Sversion())
           r <- list(
       major = substring(Sv, 1,1),
       minor = substring(Sv, lv,lv))
         }
   else
     {r <- version
      r$minor <- as.numeric(r$minor)
      r$major <- as.numeric(r$major)
     }
   if      (is.Splus())    r$language <- "Splus"
   else if (is.Svanilla()) r$language <- "S"
   r$OSversion <- OSversion()
   r$OStype <- machine()
   r
  }


###########################################################

#    1/  Functions are for identifying S or R and flavours.

###########################################################

#Note It is tempting to use system.info as defined above, but there is a

#        bootstrapping problem to solve.

is.R <- function()
 {exists("version") && !is.null(vl <- version$language) && vl == "R" }

is.R.pre0.60 <- function()
  {is.R() && ((as.numeric(version$major)+.01*as.numeric(version$major))
<0.60) }


is.S <- function(){is.Svanilla() | is.Splus() }
is.Svanilla <- function(){!exists("version")}
is.Splus <- function(){exists("version") && is.null(version$language)}
is.Splus.pre3.3 <- function()
   { ## <= 3.2
    is.Splus() &&  ((system.info()$major+.1*system.info()$minor) < 3.3)
   }

###########################################################

#    2/  Functions are for identifying the operating system.

###########################################################

# if (is.R()) {machine <- machine}

if (is.S())
   {machine <- function()
      {if (version$os == "MS Windows") return(version$os)
       if (version$os == "Macintosh") return(version$os) # needs to be
checked
       else return ("Unix")  # not a very satisfactory test
      }
   }


is.MSwindows <- function(){machine() == "MS Windows"}
is.Mac       <- function(){machine() == "Macintosh" }
is.unix      <- function(){machine() == "Unix" }

# Other is.xxx() should be added here.

# determining Unix flavours doesn't seem to be too important but ...
is.Sun4 <- function() {OSversion() == "SunOS4" }
is.Sun5 <- function() {OSversion() == "SunOS5" }
is.Linux <- function(){OSversion() == "linux"}

OSversion <- function()
   {paste(unix("uname -s"), unix("uname -r | sed -e 's/\\.\.\*//'"),
sep="") }



###########################################################

#    3/  Functions depending only on the
#         differences between S and R

###########################################################

if(is.S())
   {if(is.unix())system.call  <- unix
    global.assign <- function(name, value) {assign(name,value, where =
1)}
    .SPAWN <- TRUE
    exists.graphics.device <- function(){dev.cur() !=1 }
    open.graphics.device  <- function(display=getenv("DISPLAY"))
                                 {openlook(display) }
    #                            {motif(display) }
    close.graphics.device <- function(){dev.off() }
    if (!exists("set.seed.Splus")) set.seed.Splus <- set.seed
    set.seed <- function(seed=NULL)
      {if (is.null(seed))
          seed <-.Random.seed
       else
         {if (1==length(seed)) set.seed.Splus(seed)
          else global.assign(".Random.seed", seed)
         }
       seed
      }

    "list.add<-" <- function(x, replace, value)
       {# replace or add elements to a list.
        x[replace] <- value
        # x[[replace]] <- value  would be more logical but doesn't work
        x
       }
   }

if(is.R())
   {#tempfile <- function(f)
    #   {# Requires C code also from Friedrich Leisch not in version
0.15 of R.
    #    d<-"This is simply a string long enough to hold the name of a
tmpfile";
    #     .C("tmpf", as.character(d))[[1]]
    #    }

    if (is.R.pre0.60())
        {tempfile <- function(pattern = "file")
                {system(paste("for p in", paste(pattern, collapse = "
"), ";",
                       "do echo /tmp/$p$$; done"),
                 intern = TRUE)
                }
        }

    unlink <- function(file) system.call(paste("rm -fr ", file))
    global.assign <- function(name, value)
                          {assign(name,value, envir=.GlobalEnv)}
    synchronize<- function(x){NULL} # perhaps this should do something?
    .SPAWN <- FALSE
    exists.graphics.device <- function(){exists(".Device")}
    open.graphics.device  <- function(display=getenv("DISPLAY"))
                                {x11(display) }
    close.graphics.device <- function(){F} # how do I do this?
    set.seed <- function(seed=NULL)
      {if (is.null(seed))
         {if (!exists(".Random.seed")) zzz <- runif(1) # seed may not
yet exist
          seed <-.Random.seed
         }
       else
         {if (1==length(seed))

global.assign(".Random.seed",round(runif(3,min=seed,max=1e5*seed)))
          else global.assign(".Random.seed", seed)
         }
       seed
      }

   "list.add<-" <- function(x, replace, value)
     {# replace or add elements to a list.
      if (is.numeric(replace))
        {# x<- do.call("default.[[<-", list(x,replace,value))   # use
default
         x[[replace]] <- value
         return(x)
        }
      if (is.null(value))  value <- list(NULL)
      if (!is.list(value)) value <- list(value)
      if (1 == length(value))
       {for (i in seq(length(replace)))
          x<- do.call("$<-", list(x,replace[i],value[[1]]))
       }
      else
        {if(length(value) != length(replace) )
         stop("number of replacement values != number of elements to
replace")
         for (i in seq(length(replace)))
            x<- do.call("$<-", list(x,replace[i],value[[i]]))
        }
      x
     }
 }


###########################################################

#    4/  Functions depending only on the
#         differences among operating system.

###########################################################

if(is.unix())
  {sleep <- function(n) {unix(paste("sleep ", n))} # pause for n seconds

   present.working.directory <- function(){unix("pwd")} # present
directory
   whoami <- function(){unix("whoami")} # return user id (for mail)
   local.host.netname <-function() {unix("uname -n")}

   mail <- function(to, subject="", text="")
    {# If to is null then mail is not sent (useful for testing).
     file <- tempfile()
     write(text, file=file)
   if(!is.null(to)) unix(paste("cat ",file, " | mail  -s '", subject, "'
", to))
     unlink(file)
     invisible()
    }

   file.copy <- function(from, to)unix(paste("cp ", from, to)) # copy
file

   file.date.info <- function(file.name)
     {# This could be a lot better. It will fail for files older than a
year.
      # Also, a returned format like date() below would be better.
      mo <- (1:12)[c("Jan","Feb","Mar","Apr","May", "Jun","Jul","Aug",
"Sep",
         "Oct","Nov","Dec") ==substring(unix(paste("ls -l
",file)),33,35)]
      day <- as.integer(substring(unix(paste("ls -l
",file.name)),37,38))
      hr  <- as.integer(substring(unix(paste("ls -l
",file.name)),40,41))
      sec <- as.integer(substring(unix(paste("ls -l
",file.name)),43,44))
      c(mo,day,hr,sec)
     }

}

if(is.MSwindows())
  {system.call  <- function(cmd)
         {stop("system calls must be modified for this operating
system.")}
   sleep <- system.call
   present.working.directory <- system.call
   whoami <- system.call
   file.copy <- system.call
   file.date.info <- system.call
  }



###########################################################

#    5/  Functions depending on both R/S and the
#         differences among operating system.

###########################################################

if(is.unix())
  {if(is.R())
     {unix <- function(cmd) system(cmd, intern=T)
      system.call <- function(cmd) system(cmd, intern=T)

      date <-function()
        {d<-parse(text=strsplit(
              unix("date \'+%Y %m %d %H %M %S\'")," ")[[1]])
         list(y=  eval(d[1]),
              m=eval(d[2]),
              d= eval(d[3]),
              h= eval(d[4]),
              m= eval(d[5]),
              s= eval(d[6]),
              tz=unix("date '+%Z'"))
        }
     }
   if(is.S())
     {system.call <- function(cmd) unix(cmd)

      date <-function()
        {d <- parse(text=unix("date '+%Y %m %d %H %M %S'"),white=T)
         list(y=  eval(d[1]),
              m=eval(d[2]),
              d= eval(d[3]),
              h= eval(d[4]),
              m= eval(d[5]),
              s= eval(d[6]),
              tz=unix("date '+%Z'"))
        }
     }
  }




##############################################################################




=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From Martin Maechler <maechler@stat.math.ethz.ch>  Thu Nov  6 08:12:47 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Thu, 6 Nov 1997 09:12:47 +0100
Subject: R-alpha: "invisible" (yet again): a more problematic bug[let]
Message-ID: <199711060812.JAA04845@sophie.ethz.ch>

I think this is a more problematic buglet
in (implicit/explicit)  ``invisible behavior'').

Try this  (all versions of R from  0.49 to 0.60):


test0 <- function() c(1,2)
test  <- function(two = FALSE)        c(1, if(two) 2)
testR <- function(two = FALSE) return(c(1, if(two) 2))

test0()# 1 2 as it should
test() # <<<<<<<<<<<<<<<<<<<<<< INVISIBLE! @#$@!
test(T)# 1 2
print(test())
print(test(T))

testR() # ok; NOT invisible...
testR(T)# 1 2

---------------------------
Even though it is not really harmful once you know about it,
it can be pretty wierd when you try and test functions...

-- Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From plummer@iarc.fr  Thu Nov  6 09:28:08 1997
From: plummer@iarc.fr (Martyn Plummer)
Date: Thu, 06 Nov 1997 10:28:08 +0100
Subject: R-alpha: "invisible" (yet again): a more problematic bug[let]
References: <md5:4C26491E69F1EF6D2FB938607D06BE19>
Message-ID: <34618DA8.23AA175C@iarc.fr>

maechler@stat.math.ethz.ch wrote:
> 
> Try this  (all versions of R from  0.49 to 0.60):
> 
> test0 <- function() c(1,2)
> test  <- function(two = FALSE)        c(1, if(two) 2)
> testR <- function(two = FALSE) return(c(1, if(two) 2))
> 
> test0()# 1 2 as it should
> test() # <<<<<<<<<<<<<<<<<<<<<< INVISIBLE! @#$@!
> test(T)# 1 2
> print(test())
> print(test(T))
> 
> testR() # ok; NOT invisible...
> testR(T)# 1 2

The problem seems to be in do_if (eval.c) where the R_Visible flag
is set to 0. Set it to 1 instead and your functions will work
properly. You also get

R>if(F) 2
NULL

instead of 
R>if(F) 2
R>

which is consistent with S-PLUS.

Martyn
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From Martin Maechler <maechler@stat.math.ethz.ch>  Thu Nov  6 10:55:17 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Thu, 6 Nov 1997 11:55:17 +0100
Subject: R-alpha: "invisible" : R_INVISIBLE .. -- repeat{} gives BOMB
In-Reply-To: <34618DA8.23AA175C@iarc.fr> (message from Martyn Plummer on Thu,
 06 Nov 1997 10:28:08 +0100)
Message-ID: <199711061055.LAA05033@sophie.ethz.ch>

>>>>> "Martyn" == Martyn Plummer <plummer@iarc.fr> writes:

    Martyn> maechler@stat.math.ethz.ch wrote:
    >>  Try this (all versions of R from 0.49 to 0.60):
    >> 
    >> test0 <- function() c(1,2) test <- function(two = FALSE) c(1,
    >> if(two) 2) testR <- function(two = FALSE) return(c(1, if(two) 2))
    >> 
    >> test0()# 1 2 as it should test() # <<<<<<<<<<<<<<<<<<<<<< INVISIBLE!
    >> @#$@!  test(T)# 1 2 print(test()) print(test(T))
    >> 
    >> testR() # ok; NOT invisible...  testR(T)# 1 2

    Martyn> The problem seems to be in do_if (eval.c) where the R_Visible
    Martyn> flag is set to 0. Set it to 1 instead and your functions will
    Martyn> work properly. You also get

    R> if(F) 2
    Martyn> NULL

    Martyn> instead of
    R> if(F) 2
    R> 

    Martyn> which is consistent with S-PLUS.

Wow, this was quick and precise,  thank you !!

I investigated some more:  
	R_VISIBLE is set to 0  ``R_Visible = 0;''
	 also in other places in eval.c :

 line	C function
		
  344:	  do_if
  436:	  do_for
  480:	  do_while
  515:	  do_repeat
  720:    \
  727:     > do_set
  738:    /
  ^^^
(line numbers from current 0.60)

In my opinion, only the three cases in do_set ("<-" things) should have
the invisibility flag...

	
testwh <- function(n = 1) c(1, while(n > 1) {n <- n-1; n})
testwh() # invisible !
testwh(2)
print(testwh()) # 1
print(testwh(2))# 1 1
##-- in Splus, both are visible

###-------- THIS IS EVEN WORSE:   Segmentation violation !!! -----

testrep <- function(n = 1) c(1, repeat {n <- n-1; if(n<=0) break})
testrep()
##R : Process R:1 segmentation violation at Thu Nov  6 11:36:27 1997


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From plummer@iarc.fr  Fri Nov  7 14:21:26 1997
From: plummer@iarc.fr (Martyn Plummer)
Date: Fri, 07 Nov 1997 15:21:26 +0100 (MET)
Subject: R-alpha: "invisible" : R_INVISIBLE .. -- repeat{} gives BOMB
Message-ID: <XFMail.971107153147.plummer@iarc.fr>

On 06-Nov-97 maechler@stat.math.ethz.ch wrote:
>I investigated some more:  
>       R_VISIBLE is set to 0  ``R_Visible = 0;''
>        also in other places in eval.c :
>
> line  C function
>               
>  344:   do_if
>  436:   do_for
>  480:   do_while
>  515:   do_repeat
>  720:    \
>  727:     > do_set
>  738:    /
>  ^^^
>(line numbers from current 0.60)
>
>In my opinion, only the three cases in do_set ("<-" things) should have
>the invisibility flag...

In S-PLUS, for, while and repeat all return invisible answers, so for
compatibility these should probably be kept. Note that S-PLUS can behave
pretty strangely with this kind of example. Try this (but type carefully!)

n<-0
repeat{ if(n==0) break }->x

Now try printing x, or indeed doing anything else with it.

>
>###-------- THIS IS EVEN WORSE:   Segmentation violation !!! -----
>
>testrep <- function(n = 1) c(1, repeat {n <- n-1; if(n<=0) break})
>testrep()
>##R : Process R:1 segmentation violation at Thu Nov  6 11:36:27 1997

Try initializing t to R_NilValue in do_repeat (eval.c).

Martyn
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From jlindsey@luc.ac.be  Mon Nov 10 08:48:30 1997
From: jlindsey@luc.ac.be (Jim Lindsey)
Date: Mon, 10 Nov 1997 09:48:30 +0100 (MET)
Subject: R-alpha: text outside plots
Message-ID: <9711100848.AA24437@alpha.luc.ac.be>

When text() is used to write a string in the margin of a plot (for
example, between plots on a multiplot screen), the words appear on the
window but not when a postscript file is produced. In fact, they are
in the file, but clipped. This should be made consistent, preferably
so that they appear in both.
  Jim
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From p.dalgaard@kubism.ku.dk  Mon Nov 10 09:08:50 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 10 Nov 1997 10:08:50 +0100
Subject: R-alpha: text outside plots
In-Reply-To: Jim Lindsey's message of Mon, 10 Nov 1997 09:48:30 +0100 (MET)
References: <9711100848.AA24437@alpha.luc.ac.be>
Message-ID: <x23el5i09p.fsf@blueberry.kubism.ku.dk>

Jim Lindsey <jlindsey@luc.ac.be> writes:

> 
> When text() is used to write a string in the margin of a plot (for
> example, between plots on a multiplot screen), the words appear on the
> window but not when a postscript file is produced. In fact, they are
> in the file, but clipped. This should be made consistent, preferably
> so that they appear in both.
>   Jim

Aren't you supposed to use mtext() for putting text in margins? I
suspect that text() should behave like points(), etc. -- i.e. clip in
all cases. Or the clipping could be made optional.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From ihaka@stat.auckland.ac.nz  Mon Nov 10 09:20:44 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Mon, 10 Nov 1997 22:20:44 +1300 (NZDT)
Subject: R-alpha: text outside plots
Message-ID: <199711100920.WAA02521@stat1.stat.auckland.ac.nz>

The problem is that in X11 clipping is only applied to graphic
elements, not to text elements (why distinguish the two?), whereas
PostScript does the right thing. There are some possible work arounds,
but don't hold your breath.  Getting 0.60 out is job number one at
present.
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From Martin Maechler <maechler@stat.math.ethz.ch>  Mon Nov 10 16:00:56 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Mon, 10 Nov 1997 17:00:56 +0100
Subject: R-alpha: Re: R/R-minus incompatibility [ an old one ]
In-Reply-To: <199711101535.QAA23500@galadriel.ci.tuwien.ac.at> (message from
 Friedrich Leisch on Mon, 10 Nov 1997 16:35:47 +0100)
Message-ID: <199711101600.RAA08965@sophie.ethz.ch>

>>>>> "FrL" == Friedrich Leisch <Friedrich.Leisch@ci.tuwien.ac.at> writes:

    FrL> Hmm, I'm quite perplexed by something very trivial/stupid/whatever
    FrL> ...  don't know, if this one has been reported before:

    R> x<-1 x[1:2]
    FrL> Error: subscript out of bounds

    Splus> x<-1 x[1:2]
    FrL> [1] 1 NA

    FrL> Or is there an option to control this behaviour?

Fritz, this *is* known and is on purpose.
However, it seems that it is  NOT in the R-FAQ  (Kurt ?!?)

-- Martin

--------------- Here are two example mails from R-devel ------------------


 From: Peter Dalgaard BSA <p.dalgaard@kubism.ku.dk>
 Date: 25 Apr 1997 01:36:23 +0200
 To: r-devel@stat.math.ethz.ch
 Subject: R-alpha: list assignment

 This works in Splus:

 > x<-list()
 > x[["f"]]<-1
 > zz<-"g"
 > x[[zz]]<-2
 > x
 $f:
 [1] 1

 $g:
 [1] 2

 In R both variants fail unless the name is already on the list. The
 first one can be replaced by x$f, but there's seems to be no
 substitute for the other one (oh yes I found one, but it's not fit to
 print!). This comes up if you e.g. want to create a variable in a data
 frame with a name given by a character string.

------------------------------------------------------

 From: Robert Gentleman <rgentlem@stat.auckland.ac.nz>
 Date: Fri, 25 Apr 1997 13:12:36 +1200 (NZST)
 To: r-devel@stat.math.ethz.ch
 Subject: Re: R-alpha: list assignment

 Peter,
   They don't work on purpose. Basically this is the same problem as indexing
 beyond the end of an array. In almost all cases it is an error.
 To add a variable with a specific name to a data frame how about

 x (the dataframe)
 var1 the variable
 name1 the name

  x<-cbind(x,var1)
  names(x)[ncol(x)]<-name1

 robert
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From pgilbert@bank-banque-canada.ca  Mon Nov 10 16:43:11 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Mon, 10 Nov 1997 11:43:11 -0500
Subject: R-alpha: Re: R/R-minus incompatibility [ an old one ]
References: <199711101600.RAA08965@sophie.ethz.ch>
Message-ID: <97Nov10.115122est.26514@mailgate.bank-banque-canada.ca>

>> x[["f"]]<-1
 >> zz<-"g"
 >In R both variants fail unless the name is already on the list. The
 >first one can be replaced by x$f, but there's seems to be no
 >substitute for the other one (oh yes I found one, but it's not fit to

A long time ago it seems it was decided to remain incompatible with S on
this, I think because  people often do this in error. (Indeed, it did
point out some errors in my code.) However, there were some instances in
my code where I did something like x[[c("f","g","h")]] <- 1:3 and wanted
the corresponding elements updated or inserted as appropriate.  I have
replaced those instances with listadd(x, c("f","g","h")) <- 1:3 where
listadd is as defined below (more or less as suggested by Ross or Robert
at the time). It is one of the functions in the compatibility code I
have circulated previously.

Paul Gilbert
________
   "list.add<-" <- function(x, replace, value)
     {# replace or add elements to a list.
      if (is.numeric(replace))
        {x[[replace]] <- value
         return(x)
        }
      if (is.null(value))  value <- list(NULL)
      if (!is.list(value)) value <- list(value)
      if (1 == length(value))
       {for (i in seq(length(replace)))
          x<- do.call("$<-", list(x,replace[i],value[[1]]))
       }
      else
        {if(length(value) != length(replace) )
         stop("number of replacement values != number of elements to
replace")
         for (i in seq(length(replace)))
            x<- do.call("$<-", list(x,replace[i],value[[i]]))
        }
      x
     }


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From pgilbert@bank-banque-canada.ca  Mon Nov 10 16:56:06 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Mon, 10 Nov 1997 11:56:06 -0500
Subject: R-alpha: loop speed
Message-ID: <97Nov10.120407est.26511@mailgate.bank-banque-canada.ca>

I noticed Doug only circulated the following on S-news, but it may be of
interest to R users who don't follow S-news. His findings are certainly
consistent with my own, where my problems often force me into the
element by element type of situation.

Paul Gilbert
_______
At the risk of beating this example to death, I went back and compared
the execution time for the element-by-element method with that of the
indexing method.  At vector sizes of 50000 the indexing method is
close to 500 times faster.

 S-PLUS : Copyright (c) 1988, 1996 MathSoft, Inc.
 S : Copyright AT&T.
 Version 3.4 Release 1 for Sun SPARC, SunOS 5.3 : 1996
 Working data will be in .Data
 > x <- rnorm(50000)
 > y <- rnorm(50000)
 > op <- sample(c("*","+","-","/"), 50000, repl = T)
 > foo <-
 + function(x, y, op)
 + {
 +   z <- x
 +   for(i in seq(along = op))
 +     z[i] <- do.call(op[i], list(x[i], y[i]))
 +   z
 + }
 > unix.time(res1 <-
cbind(x*y,x-y,x+y,x/y)[cbind(seq(along=x),match(op,c("*", "-", "+",
"/")))])
 [1] 0.40000010 0.04999995 0.00000000 0.00000000 0.00000000
 > length(res1)
 [1] 50000
 > unix.time(res2 <- foo(x, y, op))
 [1] 196.23   0.29 199.00   0.00   0.00
 > length(res2)
 [1] 50000
 > all.equal(res1, res2)
 [1] T

It is interesting that the difference in execution speed when using R is

much less than when using S-PLUS.  On this machine (Sun UltraSparc 1
running Solaris 2.5.1) R is somewhat slower than S-PLUS for the
indexing version but close to 10 times faster for the
element-by-element version

 R> unix.time(res1 <-
cbind(x*y,x-y,x+y,x/y)[cbind(seq(along=x),match(op,c("*", "-", "+",
"/")))])
 [1] 1.55 0.07 2.00 0.00 0.00
 R> unix.time(res2 <- foo(x, y, op))
 [1] 23.96  0.05 24.00  0.00  0.00
 R> all(res1 == res2)
 [1] TRUE

--
Douglas Bates                            bates@stat.wisc.edu
Statistics Department                    608/262-2598
University of Wisconsin - Madison
http://www.stat.wisc.edu/~bates/



=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From ihaka@stat.auckland.ac.nz  Mon Nov 10 20:00:55 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Tue, 11 Nov 1997 09:00:55 +1300 (NZDT)
Subject: R-alpha: loop speed
Message-ID: <199711102000.JAA20068@stat1.stat.auckland.ac.nz>

	From r-devel-owner@stat.math.ethz.ch Tue Nov 11 05:58 NZD 1997
	Date: Mon, 10 Nov 1997 11:56:06 -0500
	From: Paul Gilbert <pgilbert@bank-banque-canada.ca>

	 S> unix.time(res1 <-
	cbind(x*y,x-y,x+y,x/y)[cbind(seq(along=x),match(op,c("*", "-", "+",
	"/")))])
	 [1] 0.40000010 0.04999995 0.00000000 0.00000000 0.00000000

	 R> unix.time(res1 <-
	cbind(x*y,x-y,x+y,x/y)[cbind(seq(along=x),match(op,c("*", "-", "+",
	"/")))])
	 [1] 1.55 0.07 2.00 0.00 0.00

We have received a patch from someone in CS at Berkeley which will
be in 0.60 and should claw back a decent fraction of the difference
between R and S in this comparison.  [ It eliminates our use of the
% operator in the loops for +, -, * / etc. ]

The looping speed was an original design goal for R.  It's good to
know that it hasn't been fixed (yet).

	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From thomas@biostat.washington.edu  Mon Nov 10 20:19:01 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Mon, 10 Nov 1997 12:19:01 -0800 (PST)
Subject: R-alpha: loop speed
In-Reply-To: <97Nov10.120407est.26511@mailgate.bank-banque-canada.ca>
Message-ID: <Pine.SUN.3.95.971110110012.1963A-100000@troi>

On Mon, 10 Nov 1997, Paul Gilbert wrote:

> I noticed Doug only circulated the following on S-news, but it may be of
> interest to R users who don't follow S-news. His findings are certainly
> consistent with my own, where my problems often force me into the
> element by element type of situation.

It is also interesting to look at the allegedly realistic if extreme
benchmark program provided with Matt Calder's partial S compiler. 

        LMS <- function(M, N)
        {
                ### Pre-allocate result and filter. ###
                R <- matrix(0,nrow=M, ncol=5)
                W <- rep(0,5)
                for (i in 1:M) {
                        ### Simulate MA(1) ###
                        Z <- rnorm(N+1)
                        X <- Z[2:(N+1)] + 0.5 * Z[1:N]
                        ### Perform LMS ###
                        for (j in 5:N) {
                                U <- X[j:(j-4)]
                                E <- Z[j+1] - sum(W * U)
                                W <- W + 0.1* E * U
                        }
                        ### Save final result ###
                        R[i,] <- W
                }
                return(R)
        }


I used this in S, R and compiled to C on an Ultra 1 (Solaris) and in R and
compiled to C on a Pentium Pro 150 under Linux

The results are quite interesting. These are CPU times in seconds for a
fixed value of N (100, I believe, but it was some time ago)

	Ultra             Intel
M     R     C    S      R      C
100  7.24  2.08  11    6.38   0.79
200 14.19  4.06  25.8  12.36  1.56
300 21.59  6.3   56.8  18.89  2.31
400 28.76  8.37  89    24.97  3.09
800 57.62 16.42 295    50.33  6.16

The time taken by R scales roughly linearly with M, S time grows much
faster. The two are comparable for small M. It's also interesting that the
Intel machine was slightly faster, though this doesn't translate to disk
and memory intensive tasks. 


Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From Friedrich.Leisch@ci.tuwien.ac.at  Tue Nov 11 09:33:23 1997
From: Friedrich.Leisch@ci.tuwien.ac.at (Friedrich Leisch)
Date: Tue, 11 Nov 1997 10:33:23 +0100
Subject: R-alpha: christmas wish (partial support for single)
Message-ID: <199711110933.KAA24602@galadriel.ci.tuwien.ac.at>


The following is a re-post (after suggestion from martin) of a mail I
sent to r-core this morning, maybe some of you are interested:


>>>>> On Tue, 11 Nov 1997 08:34:16 +0100,
>>>>> Kurt Hornik (KH) wrote:

KH> As Andreas & Fritz & I have recently, in attempts to port various pkgs
KH> to R, come across the f2c problem again, I thought I'd ask ...

KH> Some time ago, someone (Ross?) suggested that we'd have an f2c add-on
KH> package.  Is this still in the making somewhere?

If we talk about porting packages to R ... well, christmas is
approaching rapidly, so it's that time of the year again where people
think a lot about wishes :-)

The only effort that's involved when porting most pkg's is that R
doesn't support single precision ... well I don't need single
precision through the whole thing, but perhaps .Fortran could be
enhanced to support it? 

I think of something like single() (and friends) attaching an
attribute single to a numeric variable, and if .Fortran detects it, it
converts the stuff internally to single before passing it to the
subroutine. We could also introduce mode "single" which is exactly the
same as "numeric", but .Fortran respects it.

... just an idea, there are probably 1000 other ways of doing it
without introducing single for all things ... but it would ease
porting packages considerably for people who are not used to
programming Fortran or C. I do speak C, but still I'm always afraid of
breaking some code when changing all those real definitions to double
...

That's not urgent, but maybe we could start thinking about it.

Best,
Fritz


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From Friedrich.Leisch@ci.tuwien.ac.at  Tue Nov 11 11:02:39 1997
From: Friedrich.Leisch@ci.tuwien.ac.at (Friedrich Leisch)
Date: Tue, 11 Nov 1997 12:02:39 +0100
Subject: R-alpha: help files of base package
Message-ID: <199711111102.MAA24731@galadriel.ci.tuwien.ac.at>

		[this message bounced, because it had 'help'
		 at beginning of Subject.  Now sent as "approved". -- MM]

I'm not happy at all with the html and latex version of the base help
files, because presenting (currently) 320 files in alphabetic order is
not a good way for unexperienced users.

I'm thinking about introducing a new command like \category or
whatever to split the help files up into parts like


graphics commands
random numbers
linear models
input/output
...


such that we can organize things a little bit. this way we could also
have a concise index of ALL functions available that is still
helpfull. 

somthing like the categories list in the R-minus help window ...

what do you think?

how to organize such a thing (besides providing the technical means)?

fritz
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Nov 11 17:01:11 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 11 Nov 1997 18:01:11 +0100
Subject: R-alpha: help files of base package
In-Reply-To: <199711111102.MAA24731@galadriel.ci.tuwien.ac.at> (message from
 Friedrich Leisch on Tue, 11 Nov 1997 12:02:39 +0100)
Message-ID: <199711111701.SAA10204@sophie.ethz.ch>

>>>>> "FrL" == Friedrich Leisch <Friedrich.Leisch@ci.tuwien.ac.at> writes:

    FrL> I'm not happy at all with the html and latex version of the base
    FrL> help files, because presenting (currently) 320 files in alphabetic
    FrL> order is not a good way for unexperienced users.

One thing which could and should be changed immediately, is to
1)  have a new chapter or section for each package in  Man.tex,
2)  Use a tableofcontents at the beginning
Currently (with 'base' 'eda' and 'mva') We just have 'xy.coords' (last of
base) followed by 'line' (first of 'eda').

ok.
For the inexperienced one, I think we need the "Rnotes chapters" part of
the manual, anyway...

    FrL> I'm thinking about introducing a new command like \category or
    FrL> whatever to split the help files up into parts like
    FrL> graphics commands random numbers linear models input/output ...

Fritz, you must know that I had emphasized the introduction of \keyword{.}
a few months ago.

If you read current appendix A  ``Writing R Documentation'', you find (p.2)
that I say how (one or more) "\keyword{.}" should be used.
I've put several dozens of these \keyword{.} in several of the  *.Rd
files, also, but then I lacked time (and motivation because nobody
encouraged me .. ;-} ).

I also made a point to write  RHOME/doc/KEYWORDS
(was RHOME/mansrc/KEYWORDS in version 0.50) and mentioned it in
the output of  prompt(foo) and the above appendix A.

My goal has always been to have categories
 (these, as you see in KEYWORDS, are further grouped into "Hyper-Categories"). 
for online help  AND  printed documentation.

The point is:  Many functions (& and help files) should have more than one
keyword, since they belong into more than one category.
This is quite fine for   topics() and help.start() [HTML help],
but it is not so easy for printed documentation.

We could resolve the problem by defining the convention
that for printed docu, only the FIRST keyword will be used.

    FrL> such that we can organize things a little bit. this way we could
    FrL> also have a concise index of ALL functions available that is still
    FrL> helpfull.

Index, YES(!)   ((I've always wanted to do this for quite a while...)
		The index should have an entry 'foobar' for each \alias foobar.
This could be started immediately, as of now.
It is very useful anyway (i.e. even with alphabetically sorted man pages), and
has no real connection to the \keyword / category  side.


    FrL> what do you think?

    FrL> how to organize such a thing (besides providing the technical
    FrL> means)?

It's a good idea (not new however)
which needs quite a bit of work to be properly implemented
(editing hundreds of .Rd files  AFTER thinking which keywords to use...).
	
Once you have these categories, you'll want to rely on them.
Therefore, wrong, misspelled or missing keywords WILL be a more severe
problem than other typos / inaccuracies in *.Rd files.

Still, I am deeply convinced that its worth the work.
If several people divided it up, it would be even more fun
(and probably lead to a better  result).

If you start doing the ``technical means''
[[ Enhancing  Rdconv (and  Rd.sty, functions.html) for  latex and html ]],
I'd be very much motivated to restart on the big job of putting in more
\keywords. 
As said, maybe it'll be better to divide this up among several people.

- Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From p.dalgaard@kubism.ku.dk  Tue Nov 11 19:11:02 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 11 Nov 1997 20:11:02 +0100
Subject: R-alpha: help files of base package
In-Reply-To: Friedrich Leisch's message of Tue, 11 Nov 1997 12:02:39 +0100
References: <199711111102.MAA24731@galadriel.ci.tuwien.ac.at>
Message-ID: <x2k9ef2qm1.fsf@blueberry.kubism.ku.dk>

Friedrich Leisch <Friedrich.Leisch@ci.tuwien.ac.at> writes:

> I'm not happy at all with the html and latex version of the base help
> files, because presenting (currently) 320 files in alphabetic order is
> not a good way for unexperienced users.

You're not alone... but I'm afraid that this is something very
difficult to do right. Some things are easy, i.e. factor out graphics
functions and linear models, but other things might be difficult to
structure right, e.g. what goes in a "core" part? arithmetic?
programming constructs? etc.

> what do you think?
> 
> how to organize such a thing (besides providing the technical means)?

I think we need to think for a while and try some things and see how
they work. One technical means that I've been wanting is a way to
extract a mini-manual to go with the reduced curriculum in my medical
PhD course. (Or maybe it's there already and I just didn't have the
time to find out?)

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From Friedrich.Leisch@ci.tuwien.ac.at  Wed Nov 12 07:52:05 1997
From: Friedrich.Leisch@ci.tuwien.ac.at (Friedrich Leisch)
Date: Wed, 12 Nov 1997 08:52:05 +0100
Subject: R-alpha: help files of base package
In-Reply-To: <199711111701.SAA10204@sophie.ethz.ch>
References: <199711111102.MAA24731@galadriel.ci.tuwien.ac.at>
 <199711111701.SAA10204@sophie.ethz.ch>
Message-ID: <199711120752.IAA25461@galadriel.ci.tuwien.ac.at>

>>>>> On Tue, 11 Nov 1997 18:01:11 +0100,
>>>>> Martin Maechler (MM) wrote:

>>>>> "FrL" == Friedrich Leisch <Friedrich.Leisch@ci.tuwien.ac.at> writes:
FrL> I'm not happy at all with the html and latex version of the base
FrL> help files, because presenting (currently) 320 files in alphabetic
FrL> order is not a good way for unexperienced users.

MM> One thing which could and should be changed immediately, is to
MM> 1)  have a new chapter or section for each package in  Man.tex,
MM> 2)  Use a tableofcontents at the beginning

Ok, that Man.tex needs re-organization is obvious now that we have tex
files for all installed pkg's. But that doesn't help with the html
pages. 



MM> ok.
MM> For the inexperienced one, I think we need the "Rnotes chapters" part of
MM> the manual, anyway...

Second thing is that a couple of students complained about the R-notes
... they simply don't think it's a good intro to R because it's rather
longish, but has bo index etc. ... I can't complain about it, but I
had this feedback from several R novices independently. Has anybody
had similar experiences?



FrL> I'm thinking about introducing a new command like \category or
FrL> whatever to split the help files up into parts like
FrL> graphics commands random numbers linear models input/output ...

MM> Fritz, you must know that I had emphasized the introduction of \keyword{.}
MM> a few months ago.

Oh, sorry, I just reread my email fromn yesterday ... when I started
to write it I wanted to put something in like ``this has to be done in
connection with the current keyword concept'' but then forgot to
actually write the line ... SORRY!

Making html index pages for all keywords would be a possibility, but
But as you said: I'm not sure how this would affect printed
documentation ... I still think that the latex part of base should
have subsections ...

MM> If you read current appendix A  ``Writing R Documentation'', you find (p.2)
MM> that I say how (one or more) "\keyword{.}" should be used.
MM> I've put several dozens of these \keyword{.} in several of the  *.Rd
MM> files, also, but then I lacked time (and motivation because nobody
MM> encouraged me .. ;-} ).

Please see this as STRONG encouragement!



MM> I also made a point to write  RHOME/doc/KEYWORDS
MM> (was RHOME/mansrc/KEYWORDS in version 0.50) and mentioned it in
MM> the output of  prompt(foo) and the above appendix A.

MM> My goal has always been to have categories
MM>  (these, as you see in KEYWORDS, are further grouped into "Hyper-Categories"). 
MM> for online help  AND  printed documentation.

MM> The point is:  Many functions (& and help files) should have more than one
MM> keyword, since they belong into more than one category.
MM> This is quite fine for   topics() and help.start() [HTML help],
MM> but it is not so easy for printed documentation.

MM> We could resolve the problem by defining the convention
MM> that for printed docu, only the FIRST keyword will be used.

FrL> such that we can organize things a little bit. this way we could
FrL> also have a concise index of ALL functions available that is still
FrL> helpfull.

MM> Index, YES(!)   ((I've always wanted to do this for quite a while...)
MM> 		The index should have an entry 'foobar' for each \alias foobar.
MM> This could be started immediately, as of now.
MM> It is very useful anyway (i.e. even with alphabetically sorted man pages), and
MM> has no real connection to the \keyword / category  side.


FrL> what do you think?

FrL> how to organize such a thing (besides providing the technical
FrL> means)?

MM> It's a good idea (not new however)

I'm aware of that ... most good ideas aere not new ... just wanted to
restart discussion ...

MM> which needs quite a bit of work to be properly implemented
MM> (editing hundreds of .Rd files  AFTER thinking which keywords to use...).

exactly!

that's why I thought about introducing \category{} ... but simly using
the first keyword would be fine with me ...

We could start (and that shouldn't be too much work) with a rather
small set of obvious hyper-keywords/categories to group things a
little bit ... of course with goal of a larger set of keywords
providing finer clusters in the long run.

MM> Once you have these categories, you'll want to rely on them.
MM> Therefore, wrong, misspelled or missing keywords WILL be a more severe
MM> problem than other typos / inaccuracies in *.Rd files.

MM> Still, I am deeply convinced that its worth the work.
MM> If several people divided it up, it would be even more fun
MM> (and probably lead to a better  result).

MM> If you start doing the ``technical means''
MM> [[ Enhancing  Rdconv (and  Rd.sty, functions.html) for  latex and html ]],
MM> I'd be very much motivated to restart on the big job of putting in more
MM> \keywords. 
MM> As said, maybe it'll be better to divide this up among several people.

Yes!



Best,
Fritz
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From jlindsey@luc.ac.be  Wed Nov 12 08:58:18 1997
From: jlindsey@luc.ac.be (Jim Lindsey)
Date: Wed, 12 Nov 1997 09:58:18 +0100 (MET)
Subject: R-alpha: glm
Message-ID: <9711120858.AA24449@alpha.luc.ac.be>

Here is another bug in glm. Occasionally, with log linear models for
small tables, there can be more parameters (many aliased) than cells
in the table. Then, glm does not work. The problem is in the qr
decomposition. Here is a quick hack that works, although not very
elegant.
  In glm.fit, replace l. 254

Rmat <- fit$qr[1:nvars, 1:nvars]

by

Rmat <- diag(nvars)
nr <- min(sum(good),nvars)
Rmat[1:nr,1:nvars] <- fit$qr[1:nr,1:nvars]

  Jim
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From jlindsey@luc.ac.be  Wed Nov 12 09:03:59 1997
From: jlindsey@luc.ac.be (Jim Lindsey)
Date: Wed, 12 Nov 1997 10:03:59 +0100 (MET)
Subject: R-alpha: NextMethod
Message-ID: <9711120903.AA19776@alpha.luc.ac.be>

Here is something that I am sure has been discussed before, but I
don't understand what is going on.
  I am building some functions for ordinal variables on top of the glm
class. Take one with class lmov as well as glm and lm in that order.
In summary.lmov and print.lmov, is print out some information and then
use NextMethod. summary works fine in all cases. However, if z has
class lmov, print(z) works fine but just typing the name, z, prints
out what I want in print.lmov and then says it cannot find print.lmov
instead of using print.glm (which it finds when print(z) is used).
  Jim
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From jlindsey@luc.ac.be  Wed Nov 12 09:17:52 1997
From: jlindsey@luc.ac.be (Jim Lindsey)
Date: Wed, 12 Nov 1997 10:17:52 +0100 (MET)
Subject: R-alpha: batch
Message-ID: <9711120917.AA21246@alpha.luc.ac.be>

Back to my favourite R subject: batch mode. Some months ago, I pointed
out how the default of saving .RData automatically in batch can often
lead to completely erroneous results when using data.frames. Basically
the idea of .RData is to save the environment to start where one left
off. This will generally be quite different than where one started
the session. The idea of a batch file is to redo a session and create
hard copy of it. Hence one wants to start at the beginning, not the
end. So a .RData file must absolutely not be present. The same holds
if you run a batch file twice. The first time it must not create an
.RData. Otherwise, completely wrong results can be produced the second
time.
  Martin suggested a work around by having a final line in each file
that tests for interactive. This is fine if you remember to put it in
all files. Here is an example of a further problem that hit me the
other day. I am developing some new libraries containing C code. At a
certain point, I wanted hard copy, from batch, before changing the C
to compare before and after. My file has a library call in it (but I
forgot the test on the last line). I ran the batch then went back to
interactive. When I loaded the library and tried to run the C code, it
said that it was not in the load table. Because I was debugging, it
took me quite awhile to discover that the problem was the .RData
created behind my back.
  When is the default going to be changed to not saving the .RData in
batch mode???? Does anyone use batch mode except me?
  Jim
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From plindsey@luc.ac.be  Wed Nov 12 09:19:20 1997
From: plindsey@luc.ac.be (Patrick Lindsey)
Date: Wed, 12 Nov 1997 10:19:20 +0100 (MET)
Subject: R-alpha: Bug in postscript command with boxplots.
Message-ID: <9711120919.AA19072@alpha.luc.ac.be>

In R-0.50-a3, problems occurs when creating a postscript file of
a boxplot. Just using the boxplot command works fine (on the screen).
> x11()
> boxplot(x)

But, once the postscript command is used to capture a boxplot, the
horizontal lines are missing in the file.
> postscript("new.ps",landscape=F)
> boxplot(x)
> dev.off()

On the other hand, using the save.plot command creates a postscript file
of a boxplots which is fine.
> x11()
> boxplot(x)
> save.plot("new.ps")

Patrick.
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From phlamber@luc.ac.be  Wed Nov 12 09:44:32 1997
From: phlamber@luc.ac.be (Philippe Lambert)
Date: Wed, 12 Nov 1997 10:44:32 +0100 (MET)
Subject: R-alpha: Optimize
Message-ID: <Pine.OSF.3.96.971112103643.2170A-100000@alpha>

The function optimize returns the opposite value of the objective
when maximizing:

> f <- function(x) -x**2+1
> optimize(f,c(-5,5),maximum=TRUE)
$maximum
[1] 0

$objective
[1] -1

> f(0)
[1] 1

What should be corrected:

> optimize
function (f, interval, lower = min(interval), upper = max(interval), 
        maximum = FALSE, tol = .Machine$double.eps^0.25, ...) 
{
        if (maximum) {
                val <- .Internal(fmin(function(arg) -f(arg, ...), 
                        lower, upper, tol))
                list(maximum = val, objective = -f(val,...)
                                               ^^^
SHOULD BE +f(val,...) <-------------------------|

   Philippe

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From Martin Maechler <maechler@stat.math.ethz.ch>  Wed Nov 12 09:48:09 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 12 Nov 1997 10:48:09 +0100
Subject: R-alpha: batch -- no problem with make and proper Makefile
In-Reply-To: <9711120917.AA21246@alpha.luc.ac.be> (message from Jim Lindsey on
 Wed, 12 Nov 1997 10:17:52 +0100 (MET))
Message-ID: <199711120948.KAA10947@sophie.ethz.ch>

Yes, I use batch too.

In addition, I also use 'make' consistently
My current approach (this is Makefile syntax)
Just
	@-rm -f .RData
	R < input > output	


Actually, I'm a bit smarter and have a Makefile of the form

##--------------------- Makefile for different R batch jobs ----------
##----------------------------- Martin Maechler ----------------------	
R = /usr/local/bin/R
R = /usr/local/bin/R-MM

TESTsrc = str-test.R foobar.R thistest.R  thattest.R
TESTout = $(TESTsrc:.R=.Rout)

%.Rout: %.R
	if [ -f .RData ];   then mv .RData .RData-mm; fi
	if [ -f .Rprofile ];then mv .Rprofile .Rprofile-mm; fi
	touch .Rprofile;
	(echo '##-*- R-transcript -*- --- empty .Rprofile'; $(R) < $< ) > $@
	-@wc $@

all: tests
tests: $(TESTout)

str-test.Rout:: str-src.R

clean: ; mv $(TESTout) out-safe/ ; rm -f $(Shars)
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From p.dalgaard@kubism.ku.dk  Wed Nov 12 10:34:40 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 12 Nov 1997 11:34:40 +0100
Subject: R-alpha: help files of base package
In-Reply-To: Friedrich Leisch's message of Wed, 12 Nov 1997 08:52:05 +0100
References: <199711111102.MAA24731@galadriel.ci.tuwien.ac.at>
 <199711111701.SAA10204@sophie.ethz.ch>
 <199711120752.IAA25461@galadriel.ci.tuwien.ac.at>
Message-ID: <x2affaxuwv.fsf@blueberry.kubism.ku.dk>

Friedrich Leisch <Friedrich.Leisch@ci.tuwien.ac.at> writes:

> Second thing is that a couple of students complained about the R-notes
> ... they simply don't think it's a good intro to R because it's rather
> longish, but has bo index etc. ... I can't complain about it, but I
> had this feedback from several R novices independently. Has anybody
> had similar experiences?

Hmm, when students say that something is not good enough, they're in a
sense right by definition (excepting cases where student aggravation
is used as a deliberate pedagogical tool -- something *I* wouldn't
dare try...), but that doesn't mean that the reasons they give should
be taken at face value.

I'd say that R-notes is about three times too *short* for a tutorial.
Discounting the examples it's about 60 pages; the notes I'm writing
for my medical PhD's are already twice that size and will probably end
somewhere around 170 pages, and this covers absolutely *no*
programming. Also, R-notes has no pedagogical sequencing (i.e. read
the first n pages and be able to do something useful, the next n
learning some more, etc.), no repetition and extension of earlier
stuff, etc.

There's nothing really wrong with that, because that isn't the kind of
document the R-notes tries to be, it's more of a structured language
overview. Some people can actually learn the language from that kind
of material alone (it's certainly better than starting from the manual
pages), but many others will feel it's like learning a human language
from a grammar book. Once you *have* learned it, document like R-notes
become much more useful than tutorial because of the stricter
structure. An index would probably be a good thing in all cases,
though.

What experience do people have with textbooks on S? Do we already have
something that fits the students' (i.e. our) needs or do "we" need to
write it ourself? (Not quite knowing who "we" should be..)

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From p.dalgaard@kubism.ku.dk  Wed Nov 12 10:57:14 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 12 Nov 1997 11:57:14 +0100
Subject: R-alpha: batch
In-Reply-To: Jim Lindsey's message of Wed, 12 Nov 1997 10:17:52 +0100 (MET)
References: <9711120917.AA21246@alpha.luc.ac.be>
Message-ID: <x290uuxtv9.fsf@blueberry.kubism.ku.dk>

Jim Lindsey <jlindsey@luc.ac.be> writes:

>   When is the default going to be changed to not saving the .RData in
> batch mode???? Does anyone use batch mode except me?

One rather nasty thing to consider is that interactivity is (as I
understand it) detectable only by the existence of a controlling
terminal. This can cause trouble with cases where the controlling
terminal disappears, one case being upon logout from the windows
system or a system shutdown. Presumably, most people prefer their work
to be saved in those cases.

What might be a much better idea is to make the saving (and loading
too) of .Rdata into command line options, so that

R BATCH filein fileout

would translate into 

R -nosaveimg -noloadimg < filein > fileout

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From jlindsey@luc.ac.be  Wed Nov 12 13:16:12 1997
From: jlindsey@luc.ac.be (Jim Lindsey)
Date: Wed, 12 Nov 1997 14:16:12 +0100 (MET)
Subject: R-alpha: glm cont.
Message-ID: <9711121316.AA11236@alpha.luc.ac.be>

Here is a quick example that the uncorrected glm cannot fit. Suppose
that freq contains the nine values from a 3x3 contingency table, fac1
and fac2 the factor variables indexing the margins, and lin1 and lin2
the corresponding linear variables. Then without my correction, glm
cannot fit 
glm(freq~fac1+fac2+fac1:lin2+fac2:lin1,family=poisson)
because there are 11 variable combinations (3 aliased) and only 9
observations.
  Jim
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From jlindsey@luc.ac.be  Wed Nov 12 13:29:39 1997
From: jlindsey@luc.ac.be (Jim Lindsey)
Date: Wed, 12 Nov 1997 14:29:39 +0100 (MET)
Subject: R-alpha: batch
In-Reply-To: <x290uuxtv9.fsf@blueberry.kubism.ku.dk> from "Peter Dalgaard BSA" at Nov 12, 97 11:57:14 am
Message-ID: <9711121329.AA12443@alpha.luc.ac.be>

  Following on Peter's suggestion, if there is going to be a recognized
batch mode that does not save the .RData, then why not just change the
default option in the C code? Only one number has to be changed.
  Up until this version, I systematically did this. But now I am
developing R code to go on a CD for the second edition of my repeated
measures book so I have to be using a standard R, not a specially
compiled one to my tastes.
  As to wanting an .RData if the terminal disappears. Basically, I
never want an .RData. I have the input and hopefully the output files.
If I am working on an article, I keep all relevant data sets and
analyses in the same directory. If I am working on one of my books, I
keep data analyses by chapter. If I am doing consulting, I often have
several distinct analyses of a data set, all in the same directory.
None of these is conducive to using .RData. I just don't like the
S-Plus habit of automatically and silently loading in what you last
did when you may not even remember what it was a couple of weeks ago.
  I have lost too many hours trying to figure out why analyses are not
calculated correctly when it was just a hidden .RData from a batch
job.
  Jim
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From pgilbert@bank-banque-canada.ca  Wed Nov 12 15:13:58 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Wed, 12 Nov 1997 10:13:58 -0500
Subject: R-alpha: help files of base package
References: <199711111102.MAA24731@galadriel.ci.tuwien.ac.at>
 <199711111701.SAA10204@sophie.ethz.ch> <199711120752.IAA25461@galadriel.ci.tuwien.ac.at>
Message-ID: <97Nov12.101538est.26514@mailgate.bank-banque-canada.ca>

>Making html index pages for all keywords would be a possibility, but...

It might be better and easier to use a general purpose full texted
search such as the one for S-news at statlib
<http://lib.stat.cmu.edu/s-news>. It is all done with publicly available
programs. It sure would be nice to have that facility for R-help as
well.

Paul Gilbert


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From Friedrich.Leisch@ci.tuwien.ac.at  Wed Nov 12 15:31:58 1997
From: Friedrich.Leisch@ci.tuwien.ac.at (Friedrich Leisch)
Date: Wed, 12 Nov 1997 16:31:58 +0100
Subject: R-alpha: help files of base package
In-Reply-To: <97Nov12.101538est.26514@mailgate.bank-banque-canada.ca>
References: <199711111102.MAA24731@galadriel.ci.tuwien.ac.at>
 <199711111701.SAA10204@sophie.ethz.ch>
 <199711120752.IAA25461@galadriel.ci.tuwien.ac.at>
 <97Nov12.101538est.26514@mailgate.bank-banque-canada.ca>
Message-ID: <199711121531.QAA26226@galadriel.ci.tuwien.ac.at>

>>>>> On Wed, 12 Nov 1997 10:13:58 -0500,
>>>>> Paul Gilbert (PG) wrote:

>> Making html index pages for all keywords would be a possibility, but...
PG> It might be better and easier to use a general purpose full texted
PG> search such as the one for S-news at statlib
PG> <http://lib.stat.cmu.edu/s-news>. It is all done with publicly available
PG> programs. It sure would be nice to have that facility for R-help as
PG> well.

That's something with top priority on my list ...

I already wanted to do that earlier and sent a corresponding email
(hopefully not only to R-core) ... searching the pages would be
definetely an absolute great thing.

My only problem is how to setup such a thing without a
web-server. All software packages I'm aware of use cgi scripts and
need a http server running. That's something we want to avoid, because
not everybody running R has the means of running an http server.

If you (or somebody else) could provide me with software to do such a
search without need for a http server that would definetely be one of
the next things for me to include into the R help system.

Otherwise we could take a vote if we still want search depending on
the existence of a http server ... in that case I'm aware of several
GPL'ed search packages, e.g., we use htdig here for our web server.



Best,
Fritz
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From pgilbert@bank-banque-canada.ca  Wed Nov 12 16:55:26 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Wed, 12 Nov 1997 11:55:26 -0500
Subject: R-alpha: help files of base package
References: <199711111102.MAA24731@galadriel.ci.tuwien.ac.at>
 <199711111701.SAA10204@sophie.ethz.ch>
 <199711120752.IAA25461@galadriel.ci.tuwien.ac.at>
 <97Nov12.101538est.26514@mailgate.bank-banque-canada.ca> <199711121531.QAA26226@galadriel.ci.tuwien.ac.at>
Message-ID: <97Nov12.115723est.26522@mailgate.bank-banque-canada.ca>

>If you (or somebody else) could provide me with software to do such a
>search without need for a http server that would definetely be one of
>the next things for me to include into the R help system.

I'm afraid I don't know how to do this. I assume the http server uses a
cgi which runs something to do the search, and this could probably be
run without the server. But then you might be faced with building an
non-HTML user interface, which might not be so easy. On the other hand,
if you can run it directly from R, rather than from an HTML form, it
might work with other help formats as well.

Best of luck,
Paul

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From Friedrich.Leisch@ci.tuwien.ac.at  Wed Nov 12 17:50:44 1997
From: Friedrich.Leisch@ci.tuwien.ac.at (Friedrich Leisch)
Date: Wed, 12 Nov 1997 18:50:44 +0100
Subject: R-alpha: help files of base package
In-Reply-To: <97Nov12.115723est.26522@mailgate.bank-banque-canada.ca>
References: <199711111102.MAA24731@galadriel.ci.tuwien.ac.at>
 <199711111701.SAA10204@sophie.ethz.ch>
 <199711120752.IAA25461@galadriel.ci.tuwien.ac.at>
 <97Nov12.101538est.26514@mailgate.bank-banque-canada.ca>
 <199711121531.QAA26226@galadriel.ci.tuwien.ac.at>
 <97Nov12.115723est.26522@mailgate.bank-banque-canada.ca>
Message-ID: <199711121750.SAA26340@galadriel.ci.tuwien.ac.at>

>>>>> On Wed, 12 Nov 1997 11:55:26 -0500,
>>>>> Paul Gilbert (PG) wrote:

>> If you (or somebody else) could provide me with software to do such a
>> search without need for a http server that would definetely be one of
>> the next things for me to include into the R help system.

PG> I'm afraid I don't know how to do this.

welcome to the club ...

PG> I assume the http server uses a
PG> cgi which runs something to do the search, and this could probably be
PG> run without the server.

yes

PG> But then you might be faced with building an
PG> non-HTML user interface, which might not be so easy. On the other hand,
PG> if you can run it directly from R, rather than from an HTML form, it
PG> might work with other help formats as well.

well, it could probably be done without troubles in a java script
... but I've never programmed java before ... so that's more of a long
term project ... 

has anybody some spare time to help out?

best,
fritz
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From jlindsey@luc.ac.be  Fri Nov 14 08:33:48 1997
From: jlindsey@luc.ac.be (Jim Lindsey)
Date: Fri, 14 Nov 1997 09:33:48 +0100 (MET)
Subject: R-alpha: Design and Hmisc
Message-ID: <9711140833.AA32283@alpha.luc.ac.be>

I have been looking at porting Design and Hmisc to R. Unfortunately, I
know nothing about S and do not have access to it. Basically what I
have found is that many functions work directly, as long as they do
not involve data.frames or models. These two create a lot of
incompatibilities.
  Here is what I had to do to get the functions to load:
1. R INSTALL ignores function names beginning with a capital letter.
2. A semicolon between if and else gives an error:
   if( ) expr1 ; else expr2
3. strings cannot be broken over two lines
4. checks on the OS have to be changed to use machine()
5. synchronize() does not exist
6. single has to be changed to double (warning only)
Then when they are finally loaded, nothing connected with models works
anymore, not even glm!
There are a number of missing functions:
1. category, as.category, is.category (the latter is in header.R of
survival4) These need to be written so that they are numeric but
level() works properly.
2. terms.inner (this is called by newsurvival4.R on l.1242 but does
not exist!) Design uses a stripped down version that calls a C
function called all_names. Any idea what this is?
3. The fortran for proportional odds calls directly the fortran
functions underlying the S versions of qr and solve. These appear to
be different modifications of linpack routines than those used in
R. The argument lists are different.

A further incompatibility is that assignments similar to the following
are often used:
Limits <- list()
Limits[["y"]] <- 1
This gives subscript out of bounds.

The S code appears to be very clean (although unreadable because not
properly indented). (This contrasts with Oswald that my son has been
trying to port for the last 6 months and that is extremely poorly
programmed.)  If anyone is interested in pursuing this further, I
shall be happy to forward the results of the 5 or 6 hours work that I
put in to it. For someone who knows S well, I do not think it would be
much work.
  Jim
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Nov 14 17:27:00 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 14 Nov 1997 18:27:00 +0100
Subject: R-alpha: more bugs with names/dims, etc.:
Message-ID: <199711141727.SAA14384@sophie.ethz.ch>


 x_1:4
 data.frame(x=2*x, y=3*x) - structure(x, names=letters[seq(x)])

## R :
## Error in data.frame(x = 2 * x, y = 3 * x) - structure(x, names = letters[seq(x)]) : non-numeric argument to binary operator

## S:
  x y 
1 1 2
2 2 4
3 3 6
4 4 8
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Nov 14 18:16:20 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 14 Nov 1997 19:16:20 +0100
Subject: R-alpha: S-R -- quite a dangerous incompatibility...
Message-ID: <199711141816.TAA14607@sophie.ethz.ch>


any( 1 < 0, na.rm = T) 

##S: FALSE

##R: TRUE		(guess why; the TRUE of  na.rm=T ...)


##-- Of course, the analogon happens for

all( 1 > 0, na.rm = F)

## S : TRUE	
## R : FALSE

-- Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From p.dalgaard@biostat.ku.dk  Fri Nov 14 21:17:34 1997
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 14 Nov 1997 22:17:34 +0100
Subject: R-alpha: S-R -- quite a dangerous incompatibility...
In-Reply-To: Martin Maechler's message of Fri, 14 Nov 1997 19:16:20 +0100
References: <199711141816.TAA14607@sophie.ethz.ch>
Message-ID: <x2lnyr41ld.fsf@blueberry.kubism.ku.dk>

Martin Maechler <maechler@stat.math.ethz.ch> writes:

> 
> 
> any( 1 < 0, na.rm = T) 
> 
> ##S: FALSE
> 
> ##R: TRUE		(guess why; the TRUE of  na.rm=T ...)
> 

Ugh... Root of the problem seems to be that any() and all() don't
understand na.rm=, which they probably should, so it'll go away
eventually. 

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From p.dalgaard@biostat.ku.dk  Mon Nov 17 21:05:02 1997
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 17 Nov 1997 22:05:02 +0100
Subject: R-alpha: Re: R-beta: installing new packages in window95 version of R
In-Reply-To: Luke Tierney's message of Mon, 17 Nov 1997 11:00:36 -0600 (CST)
References: <9711171700.AA04611@nokomis.stat.umn.edu>
Message-ID: <x2g1ovdyf5.fsf@blueberry.kubism.ku.dk>

Luke Tierney <luke@stat.umn.edu> writes:


> One potential problem is with the calling conventions. Watcom uses a
> register based method that appears to be different from the optional
> resgister-based one under MS. The default under MS is I think a stack
> based convention. If the R .exe is compiled with default calling
> conventions then it *may* work to have MS Fortran generate code for
> regieter-based calls (there may be a flag you can set for that) but
> I'm worried there may be more differences than argument passing, that
> the conventions on who saves and restores other registers may be
> different. If that is indeed the case then calls may appear to work in
> some contexts but not in others.

Yuk!

I want this to work with GCC as cross-compiler
I want this to work with GCC as cross-compiler
I want this to work with GCC as cross-compiler
I want this to work with GCC as cross-compiler
I want this to work with GCC as cross-compiler

- but I don't have the time just yet...

(I've got the crosscompiler, Linux->Win32, but I couldn't figure out
how to get the include files for the windows DDE stuff to behave.
Maybe I should spend some time (if I ever get any) on studying what it
does with DLL's?)

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=---
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=---

From jlindsey@luc.ac.be  Tue Nov 18 09:47:24 1997
From: jlindsey@luc.ac.be (Jim Lindsey)
Date: Tue, 18 Nov 1997 10:47:24 +0100 (MET)
Subject: R-alpha: Student t functions
Message-ID: <9711180947.AA13264@alpha.luc.ac.be>

Some of the Student t functions (e.g. dt) still round the degrees of
freedom to an integer whereas others do not (e.g. pt).
  Jim
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=---
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=---

From bates@stat.wisc.edu  Fri Nov 21 14:28:34 1997
From: bates@stat.wisc.edu (Douglas Bates)
Date: 21 Nov 1997 08:28:34 -0600
Subject: R-alpha: nlm and gradients
Message-ID: <6r4t56qq25.fsf@franz.stat.wisc.edu>

At present the documentation for nlm refers the reader to Dennis and
Schnabel for details on the algorithms.  It also states that the
function is liable to change.

Can anyone tell me if the current version of nlm uses only function
values or if it can use gradients and Hessians when they are
available?  I would like to get an idea of how difficult it would be
to port the development versions of our linear mixed-effects code.

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=---
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=---

From pgilbert@bank-banque-canada.ca  Fri Nov 21 16:08:38 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Fri, 21 Nov 1997 11:08:38 -0500
Subject: R-alpha: nlm
Message-ID: <97Nov21.111118est.26511@mailgate.bank-banque-canada.ca>

>Can anyone tell me if the current version of nlm uses only function
>values or if it can use gradients and Hessians when they are
>available?  I would like to get an idea of how difficult it would be
>to port the development versions of our linear mixed-effects code.

Doug

If you don't get the answer you need regarding nlm, I have some
multivariate code which may help. The code has one problem I know about
(the Hessian estimate is off) but mostly I think it is working well.

Paul

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=---
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=---

From p.dalgaard@biostat.ku.dk  Fri Nov 21 16:34:20 1997
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 21 Nov 1997 17:34:20 +0100
Subject: R-alpha: nlm and gradients
In-Reply-To: Douglas Bates's message of 21 Nov 1997 08:28:34 -0600
References: <6r4t56qq25.fsf@franz.stat.wisc.edu>
Message-ID: <x23ekqxl2r.fsf@blueberry.kubism.ku.dk>

Douglas Bates <bates@stat.wisc.edu> writes:

> Can anyone tell me if the current version of nlm uses only function
> values or if it can use gradients and Hessians when they are
> available?  I would like to get an idea of how difficult it would be
> to port the development versions of our linear mixed-effects code.

I'd say that this is so important that you should just tell us what
you want it to do and we'll make it do so.

(Above statement being asymptotically valid for large values of
"we"...)

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=---
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=---

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Nov 21 17:05:43 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 21 Nov 1997 18:05:43 +0100
Subject: R-alpha: nlm and gradients
In-Reply-To: <6r4t56qq25.fsf@franz.stat.wisc.edu> (message from Douglas Bates
 on 21 Nov 1997 08:28:34 -0600)
Message-ID: <199711211705.SAA07895@sophie.ethz.ch>

>>>>> "DougB" == Douglas Bates <bates@stat.wisc.edu> writes:

    DougB> At present the documentation for nlm refers the reader to Dennis
    DougB> and Schnabel for details on the algorithms.  It also states that
    DougB> the function is liable to change.

    DougB> Can anyone tell me if the current version of nlm uses only
    DougB> function values or if it can use gradients and Hessians when
    DougB> they are available?  I would like to get an idea of how
    DougB> difficult it would be to port the development versions of our
    DougB> linear mixed-effects code.

Hello Doug,
 thank you for thinking about the port !!

Unfortunately, the current version of
	src/main/optimize.c
still contains

o.c>   static int F77_SYMBOL(d1fcn)(int *n, double *x, double *g)
o.c>   {
o.c>     error("optimization using analytic gradients not implemented (yet)\n");
o.c>   }
o.c>
o.c>   static int F77_SYMBOL(d2fcn)(int *n, double *x, double *g)
o.c>   {
o.c>     error("optimization using analytic Hessians not implemented (yet)\n");
o.c>   }

(optimize.c is unchanged since 0.50-a4).

The underlying Fortran code would allow gradients and hessians;
the ``only'' remaining thing is to use the internal code in R which
is used for 'deriv(.)' to compute algebraic derivatives ...

Martin Maechler <maechler@stat.math.ethz.ch>		 <><
Seminar fuer Statistik, SOL G1
ETH (Federal Inst. Technology)	8092 Zurich	 SWITZERLAND
phone: x-41-1-632-3408		fax: ...-1086
http://www.stat.math.ethz.ch/~maechler/
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=---
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=---

From pgilbert@bank-banque-canada.ca  Fri Nov 21 16:56:25 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Fri, 21 Nov 1997 11:56:25 -0500
Subject: R-alpha: random number generator
Message-ID: <97Nov21.120108est.26518@mailgate.bank-banque-canada.ca>

>1. Is the random number generator in R the same as the one in S
>"Super-Duper")?

The random number generator is different and also the random seed length

is different. As far as I know there is no way to reproduce the same
random experiments in R that you may have performed in S (but if you
figure it out please let me know). However, in my fairly casual
experimentation the general results of random experiments tend to be the

same (good thing!).

Paul Gilbert

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=---
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=---

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Nov 21 17:45:03 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 21 Nov 1997 18:45:03 +0100
Subject: R-alpha: random number generator
In-Reply-To: <97Nov21.120108est.26518@mailgate.bank-banque-canada.ca> (message
 from Paul Gilbert on Fri, 21 Nov 1997 11:56:25 -0500)
Message-ID: <199711211745.SAA08103@sophie.ethz.ch>

Which reminds me of a remark that  Luke Tierney made a while ago,
and I very much agree with:

LT> From: Luke Tierney <luke@stat.umn.edu>
LT> Subject: Re: R-alpha: compatibility
LT> Date: Mon, 15 Sep 1997 11:55:02 -0500 (CDT)
LT> Cc: R-devel@stat.math.ethz.ch
LT> 
LT> This is one point where compatibility is not necessarily a good
LT> thing. S, like most systems, gives you no real control over the random
LT> number generator expect re-seeding. Usually this is probably good. But
LT> most simulation books recommend running any simulations you care about
LT> with two very different generators.
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Yes! -- That's why I think it would be nice if R allowed for  SEVERAL
random number generators, one of them super-duper, incidentally.
The code is basically in V&R 1 and 2; V&R2 on p.167.
I have it as a C function that I used to dyn.load into S-plus in order to
prove that S-plus was using it.
my function does NOT YET contain the ``zero skipping'' which is mentioned
in the yellow book ..

LT> Most people don't do this because
LT> one generator is usually easy to use (the built-in one in your
LT> favorite system) and anything else is impossible. Another issue that S
LT> faces has to do with running separate bits of a simulation on separate
LT> workstations. Unless you are careful, the separate bits will share
LT> parts of random number streams, and being careful is not really
LT> possible with S's generator (I think) -- it is possible but not easy
LT> with R's. (Of course overlap can be a good thing if you know you have
LT> it -- the point here is that lots of folks run separate simulations
LT> thinking they have independent runs when they probably do not in any
LT> reasonable sense).

LT> The bottom line is that it would be nice to eventually provide "power
LT> users" with more control over the random number generator system.  Now
LT> is clearly not the time to think about how to do that, but it would be
LT> unfortunate if decisions were made at this point in the name of
LT> compatibility that might limit the freedom of doing something "right"
LT> later on.

maybe the time to think about this, could be now..?
Proposals?

-- Martin M
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=---
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=---

From pgilbert@bank-banque-canada.ca  Fri Nov 21 19:32:10 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Fri, 21 Nov 1997 14:32:10 -0500
Subject: R-alpha: random number generator
References: <199711211745.SAA08103@sophie.ethz.ch>
Message-ID: <97Nov21.143456est.26524@mailgate.bank-banque-canada.ca>

>LT> The bottom line is that it would be nice to eventually provide
"power
>LT> users" with more control over the random number generator system.

>maybe the time to think about this, could be now..?
>Proposals?

Maybe there is some subtlty here that I don't understand, but is it not
possible to just add an optional argument to the functions which call
the random number generator, with the default being the current
generator?

Paul Gilbert

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=---
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=---

From bates@stat.wisc.edu  Sun Nov 23 23:32:04 1997
From: bates@stat.wisc.edu (Douglas Bates)
Date: Sun, 23 Nov 1997 17:32:04 -0600 (CST)
Subject: R-alpha: Reading a data.dump format
Message-ID: <m0xZlVU-000hh4C@franz.stat.wisc.edu>

Has anyone taken a crack at creating an R function that would read the 
data.dump format?
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=---
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=---

From Martin Maechler <maechler@stat.math.ethz.ch>  Mon Nov 24 09:49:44 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Mon, 24 Nov 1997 10:49:44 +0100
Subject: R-alpha: Reading a data.dump format
In-Reply-To: <m0xZlVU-000hh4C@franz.stat.wisc.edu> (message from Douglas Bates
 on Sun, 23 Nov 1997 17:32:04 -0600 (CST))
Message-ID: <199711240949.KAA00755@sophie.ethz.ch>

>>>>> "DougB" == Douglas Bates <bates@stat.wisc.edu> writes:

    DougB> Has anyone taken a crack at creating an R function that would
    DougB> read the data.dump format?

This has been listed as a `desideratum'
 -- something we'd all like -- for a while now.

Actually, both   data.dump and data.restore.

Any students who need a challenging home work ?  :-)
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=---
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=---

From Martin Maechler <maechler@stat.math.ethz.ch>  Mon Nov 24 13:51:13 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Mon, 24 Nov 1997 14:51:13 +0100
Subject: R-alpha: random number generator -- S-plus's
In-Reply-To: <97Nov21.164332est.26501@mailgate.bank-banque-canada.ca> (message
 from Paul Gilbert on Fri, 21 Nov 1997 16:40:01 -0500)
Message-ID: <199711241351.OAA01213@sophie.ethz.ch>

--Multipart_Mon_Nov_24_14:51:09_1997-1
Content-Type: text/plain; charset=US-ASCII


>>>>> "PaulG" == Paul Gilbert <pgilbert@bank-banque-canada.ca> writes:

    MM> The code is basically in V&R 1 and 2; V&R2 on p.167.  I have it as a
    MM> C function that I used to dyn.load into S-plus in order
    MM> to prove that S-plus was using it.

    PaulG> Could you send this to me. I'd like to try to reproduce some S
    PaulG> results in R.

Okay here is a little shar file which contains a little more;
it also includes (the S code for) my experiments on what S-plus's  set.seed(.)
does. The C code must be compiled (cc  and ld) ``a la R'' before dyn.load.

I did not yet test this in R,
but I  CC: it to R-devel since others may want to comment.

[appended at the end !]

--------------------------------------------------------

  PaulG> Maybe there is some subtlty here that I don't understand, but is it not
  PaulG> possible to just add an optional argument to the functions which call
  PaulG> the random number generator, with the default being the current
  PaulG> generator?
Reasons why I wouldn't like this:

  - There are too many of these functions;  some are quite nested;
  - adding an extra argument to them is ugly and not backwards (R-minus)
	  compatible; 
  - you shouldn't have to change the R code of your simulation, but rather
	  change a global option in order to use a different RNG.
  - You shouldn't accidentally mix two different generators, since the 
	  resulting RNG has unknown properties.be allowed t

  - It isn't too hard, to implement the more flexible scheme,
	   in the current R implementation.

>From the UI, I'd propose
to use  a function instead of  .Random.seed,

	set.random(generator = "Wichmann-Hill", seed = NULL)

The function (also when called with no arguments) returns a list with the
two components
	$generator : character(1)  giving the name of the RNG.
	$seed	   : integer vector

AND also accepts such a list as input (alternatively), i.e.

	I could
	
first)
	.R.seed <- set.random()
	## ....do simulations

later)
	set.random(.R.seed)
	## ....Re-do  simulations indentically

-------------------------------------------------------------------------------

--Multipart_Mon_Nov_24_14:51:09_1997-1
Content-Type: application/octet-stream
Content-Disposition: attachment; filename="runif.shar"
Content-Transfer-Encoding: 7bit

#!/bin/sh
# This is a shell archive (produced by GNU sharutils 4.2).
# To extract the files from this archive, save it to some FILE, remove
# everything before the `!/bin/sh' line above, then type `sh FILE'.
#
# Made on 1997-11-24 14:21 MET by <maechler@sophie>.
# Source directory was `/users/home2/staff/maechler/S/MISC'.
#
# Existing files will *not* be overwritten unless `-c' is specified.
#
# This shar contains:
# length mode       name
# ------ ---------- ------------------------------------------
#   7088 -rw-r--r-- runif-tst.S
#   3646 -rw-r--r-- setseed-ex.S
#   1132 -rw-r--r-- ../C-Progs/programs/Runif.c
#
save_IFS="${IFS}"
IFS="${IFS}:"
gettext_dir=FAILED
locale_dir=FAILED
first_param="$1"
for dir in $PATH
do
  if test "$gettext_dir" = FAILED && test -f $dir/gettext \
     && ($dir/gettext --version >/dev/null 2>&1)
  then
    set `$dir/gettext --version 2>&1`
    if test "$3" = GNU
    then
      gettext_dir=$dir
    fi
  fi
  if test "$locale_dir" = FAILED && test -f $dir/shar \
     && ($dir/shar --print-text-domain-dir >/dev/null 2>&1)
  then
    locale_dir=`$dir/shar --print-text-domain-dir`
  fi
done
IFS="$save_IFS"
if test "$locale_dir" = FAILED || test "$gettext_dir" = FAILED
then
  echo=echo
else
  TEXTDOMAINDIR=$locale_dir
  export TEXTDOMAINDIR
  TEXTDOMAIN=sharutils
  export TEXTDOMAIN
  echo="$gettext_dir/gettext -s"
fi
touch -am 1231235999 $$.touch >/dev/null 2>&1
if test ! -f 1231235999 && test -f $$.touch; then
  shar_touch=touch
else
  shar_touch=:
  echo
  $echo 'WARNING: not restoring timestamps.  Consider getting and'
  $echo "installing GNU \`touch', distributed in GNU File Utilities..."
  echo
fi
rm -f 1231235999 $$.touch
#
if mkdir _sh01181; then
  $echo 'x -' 'creating lock directory'
else
  $echo 'failed to create lock directory'
  exit 1
fi
# ============= runif-tst.S ==============
if test -f 'runif-tst.S' && test "$first_param" != -c; then
  $echo 'x -' SKIPPING 'runif-tst.S' '(file already exists)'
else
  $echo 'x -' extracting 'runif-tst.S' '(text)'
  sed 's/^X//' << 'SHAR_EOF' > 'runif-tst.S' &&
##SunOS4: print(dyn.load2("/u/maechler/C/C-for-S/Runif.o"))
print(dyn.load("/u/maechler/C/C-for-S/Runif.o"))
X.C("Init_seed",
X   Cval = as.integer(12345),
X   Tval = as.integer(987654321))
str(.C("Get_seed", Cval = integer(1), Tval = integer(1)))
X
rU_ numeric(10)
for(i in 1:10) rU[i] <- unlist(.C("Runif", numeric(1)))
rU
str(.C("Get_seed", Cval = integer(1), Tval = integer(1)))
X
Set.seed <- function(Cval = 12345, Tval =987654321)
{
X  ## Purpose: Initialize my implementation of the 'S' RNG (following Ripley)
X  ## -------------------------------------------------------------------------
X  ## Arguments: Congrval and Tausval, the 2 long integers  [== seed]
X  ## -------------------------------------------------------------------------
X  ## Author: Martin Maechler, Date:  9 May 94, 12:04
X  if(!is.loaded(C.symbol("Init_seed")))
X    dyn.load("/u/maechler/C/C-for-S/Runif.o")
X  invisible(.C("Init_seed",
X	       Cval = as.integer(Cval),
X	       Tval = as.integer(Tval)))
}
X
Runif <- function()
{
X  ## Purpose:  test my runif(.)
X  ## -------------------------------------------------------------------------
X  ## Author: Martin Maechler, Date:  9 May 94, 11:54
X  if(!is.loaded(C.symbol("Runif")))
X    dyn.load("/u/maechler/C/C-for-S/Runif.o")
X  unlist(.C("Runif", numeric(1)))
}
X
X
tst.runif <- function(Cval = 12345, Tval =987654321)
{
X  ## Purpose: test my (following Ripley) implementation of S  RNG
X  ##        return 'next' seeds
X  ## -------------------------------------------------------------------------
X  ## Arguments: Congrval and Tausval  [== seed]
X  ## -------------------------------------------------------------------------
X  ## Author: Martin Maechler, Date:  9 May 94, 12:04
X  if(!is.loaded(C.symbol("Runif")))
X    dyn.load("/u/maechler/C/C-for-S/Runif.o")
X  .C("Init_seed",
X     Cval = as.integer(Cval),
X     Tval = as.integer(Tval))
X  .C("Runif", numeric(1))
X  unlist(.C("Get_seed", Cval = integer(1), Tval = integer(1)))
}
X
###
### Test the 'standard'  .Random.seed  --- compare with  my version
###
X
tst.R.S <- function(nn)
{
X  ## Purpose:  return many .Random.seed s
X  ## -------------------------------------------------------------------------
X  ## Arguments: number
X  ## -------------------------------------------------------------------------
X  ## Author: Martin Maechler, Date:  9 May 94, 11:07
X
X  RR <- matrix(0,nrow = 12, ncol= nn)
X  for(i in 1:nn) { RR[,i] _ .Random.seed; runif(1) }
X  t(RR)
}
X
RR <- tst.R.S(2000)
summary(as.data.frame(RR))#-- Random.seed components
RRt <- apply(RR, 2, table)
RRt2 <- lapply(RRt, function(x) as.integer(names(x)))
str(RRt2, vec.len = 20)
for(j in 1:12) {
X  cat("\n j=",j, " 0:63 = R..[[j]]: ", all.equal(0:63, RRt2[[j]]))
}
X
X
X
X
X
X
##--> only   1, 6, 12  are NOT ==  0...63
## [[1]] =          1 5 9 .. 61  (( = 1 + 4*j ,  j= 0..15 ))
## [[6]] = [[12]] = 0..3
X
X
RS   <- rep(0,12)
#.Random.seed _ RS
##>> Error: Invalid random number seed: congruential part must be odd
RS[1] _ 1
X.Random.seed _ RS  #--> 1st part == congruential part !
for(i in 1:20){ print(.Random.seed); runif(1)} #- the 2nd part STAYS 0 !!
RS2 <- RS
RS2[12] _ 1
X.Random.seed _ RS2
for(i in 1:20){ print(.Random.seed); runif(1)} #- 1st part == 1st part above!
X
###==> first   6 numbers are one long integer, == congrval  (see above)
###    second  6 numbers are 2nd long integer  == tausval
X
### congrval is made up from 4 + 4* 6 + 3 = 31 bits
###                          - actually CAN use ALL odd 1:63 for [1] -> 32 bits
###  tausval is made up from     5* 6 + 3 = 33 bits (?)
X
X
###  The following  PROOFS  that  Runif(.) returns the SAME as  runif(.)
###  AND  that .Random.seed  =^=  ( Congr.val, Taus.val )
X
if(!exists("polyn.eval"))
X  polyn.eval <- function(coef, x)
X  {
X    ## Purpose: Compute coef[1] + coef[2]*x + ... + coef[p+1]* x^p
X    ## 	      x can be any array; result if of same dimensions !
X    ## Author: Martin Maechler
X    lc <- length(coef)
X    if(lc == 0) 0
X      else {
X	r <- coef[lc]
X	if(lc > 1) for(i in (lc - 1):1) r <- coef[i] + r * x
X	r
X      }
X  }
X
qR <- c( 1, rep(0,5))
X.Random.seed <- Rs <- c(qR, qR) #---  1 0 0 0 0 0  1 0 0 0 0 0
Set.seed(1,1)
for (i in 1:100) {
X  CT <- unlist(.C("Get_seed", Cval = integer(1), Tval = integer(1)))
X  RS.C <- .Random.seed[1:6]
X  RS.T <- .Random.seed[1:6 +6]
X  cat(i,": ")
X  ##print(c(CT, RS.C = RS.C, RS.T = RS.T))
X  if(CT["Cval"]<0) { CT["Cval"] <- 2^32 + CT["Cval"]
X		     cat("'Cval' corrected by adding 2^32\n") }
X  if(CT["Tval"]<0) { CT["Tval"] <- 2^32 + CT["Tval"]
X		     cat("'Tval' corrected by adding 2^32\n") }
X  if(CT["Cval"] != polyn.eval(RS.C, 2^6)) stop("'Congr.val' do not match!")
X  if(CT["Tval"] != polyn.eval(RS.T, 2^6)) stop(" 'Taus.val' do not match!")
X  u1 <- runif(1)
X  u2 <- Runif()
X  if((u1-u2)!=0) stop("u1 != u2")
}
X
X
X.Random.seed <- Rs <- c(qR, qR) #---  1 0 0 0 0 0  1 0 0 0 0 0
Set.seed(1,1)
X
runif(1)
##> [1] 4.659873e-05
Runif()
##> [1] 4.659873e-05
unlist(.C("Get_seed", Cval = integer(1), Tval = integer(1)))
##>   Cval   Tval
##>  69069 131073
X.Random.seed
##>  [1] 13 55 16  0  0  0  1  0 32  0  0  0
X
Runif()
##> [1] 0.1106027
runif(1)
##> [1] 0.1106027
unlist(.C("Get_seed", Cval = integer(1), Tval = integer(1)))
##>       Cval   Tval
##>  475559465 524293
X.Random.seed
##>  [1] 41 24  7 22 28  0  5  0  0  2  0  0
X
X
### --- finding out things about   set.seed(.) -----
X
for(i in 0:1100){
X  cat("set.seed(i=",formatC(i,dig=4),") -> .Random.s = "); set.seed(i)
X  cat(format(.Random.seed),"\n")
}
##- set.seed(i=     0 ) -> .Random.s = 21 14 49   32 43  1   32 22 36 23 28  3
##- set.seed(i=     1 ) -> .Random.s = 21 14 49   48 24  1   32 22 36 23 28  3
##- set.seed(i=     2 ) -> .Random.s = 21 14 49    0  6  1   32 22 36 23 28  3
##- set.seed(i=     3 ) -> .Random.s = 21 14 49   16 51  0   32 22 36 23 28  3
##- set.seed(i=     4 ) -> .Random.s = 21 14 49   32 32  0   32 22 36 23 28  3
##- set.seed(i=     5 ) -> .Random.s = 21 14 49   48 13  0   32 22 36 23 28  3
##- set.seed(i=     6 ) -> .Random.s = 21 14 49    0 59  3   32 22 36 23 28  3
##- set.seed(i=     7 ) -> .Random.s = 21 14 49   16 40  3   32 22 36 23 28  3
##- .........
##-          			      [ 1  2  3    4  5  6    7  8  9 10 12 12 ]
###--> only  [4:6]  really change !!
###- They have  6 + 6 + 2 = 14  bits each (the ranges are 0:63, 0:63, and 0:3),
###- i.e.,  2^14 = 16384  different possibilities.
###-        ~~~~   ~~~~~
###===>  Period of  set.seed(.) =: P | 2^14
X
## test this period
tst.sseed <- function(i)
{
X  ## Purpose:  test  set.seed(.)
X  ## -------------------------------------------------------------------------
X  ## Author: Martin Maechler, Date:  9 May 94, 11:54
X  set.seed(i)
X  .Random.seed
}
X
for (i in c(0:7, 11, 17, 20, 23, 40, 53, 59, 67, 76, 97)) {
X  cat("i=",i,": ")
X  print(all.equal(tst.sseed(i), tst.sseed(i + 2^ 14)))
}
##--> all  'TRUE'
##
## same thing for  2^13, 2^12, 2^11, 2^10 ! --
##
## Test a full period for  2^10 = 1024 :
X
for (i in 0:(2^10 - 1))
X  if(!is.all.equal(tst.sseed(i), tst.sseed(i + 2^ 10)))
X  cat("i=",i," DIFFERENT ! ")
## -> nothing (i.e., all equal !)
X
###==> Full period is from  set.seed(0) to  set.seed(1023) ! --
SHAR_EOF
  $shar_touch -am 1124142097 'runif-tst.S' &&
  chmod 0644 'runif-tst.S' ||
  $echo 'restore of' 'runif-tst.S' 'failed'
  if ( md5sum --help 2>&1 | grep 'sage: md5sum \[' ) >/dev/null 2>&1 \
  && ( md5sum --version 2>&1 | grep -v 'textutils 1.12' ) >/dev/null; then
    md5sum -c << SHAR_EOF >/dev/null 2>&1 \
    || $echo 'runif-tst.S:' 'MD5 check failed'
35e91fce41f56de76bab514ecfc5c840  runif-tst.S
SHAR_EOF
  else
    shar_count="`LC_ALL= LC_CTYPE= LANG= wc -c < 'runif-tst.S'`"
    test 7088 -eq "$shar_count" ||
    $echo 'runif-tst.S:' 'original size' '7088,' 'current size' "$shar_count!"
  fi
fi
# ============= setseed-ex.S ==============
if test -f 'setseed-ex.S' && test "$first_param" != -c; then
  $echo 'x -' SKIPPING 'setseed-ex.S' '(file already exists)'
else
  $echo 'x -' extracting 'setseed-ex.S' '(text)'
  sed 's/^X//' << 'SHAR_EOF' > 'setseed-ex.S' &&
###--> See also (the much OLDER)  ./runif-tst.S
###				  ~~~~~~~~~~~~~
X
ss <- function(i) { set.seed(i); .Random.seed }
s0 <- ss(0)
for(i in -1000:4000)
X if(any(ss(i)[-(4:6)] != s0[-(4:6)])) cat("i=",i," .R.s=",.Random.seed,"\n")
##--> no output, i.e., it's really
##    only .Random.seed[c(4,5,6)] which are modified by set.seed(.)
X
ni <- length(i.set <- -2:2000)
m456 <- matrix(NA, ni, 3, dimnames=list(paste(i.set),paste(4:6)))
for(i in i.set)  m456[paste(i),] <- ss(i)[4:6]
t(m456[1:25,])
X
apply(m456, 2,  function(x) sort(unique(x)))
##- $"4":
##- [1]  0 16 32 48
##-
##- $"5":
##-[1]  0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23
##[25] 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47
##[49] 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63
##-
##- $"6":
##- [1] 0 1 2 3
len456 <- apply(m456, 2,  function(x) length(unique(x)))
len456
prod(len456) #-- 1024 : no more than these many different
X
d456 <- dim(table(m456[,"4"], m456[,"5"], m456[,"6"]))#- and these all appear ..
d456
d456 == len456 # Yes !
X
all(m456[,"4"] == rep(16*(0:3), length=ni))#-> TRUE
X
for(i in -4:10) print(ss(i)[4] == 16*(i+2)%%4)
X
table(m456[,"6"]) #-- only 0, 1, 2, 3, but not as regularly ...
##-    0   1   2   3
##-  502 501 500 500
X
##---- mI  contains .Random.seed[4:6]  after set.seed(i = 1:1024) : ----
mI <- m456[paste(1:1024),]
dim(table(mI[,"4"], mI[,"5"], mI[,"6"]))#- and these all appear ..
X
all(ss(0) == ss(1024)) #-- TRUE
for(i in -100:2000)
X   if(any(ss(i) != ss(i + 1024))) cat("i=",i," .R.s=",.Random.seed,"\n")
#- no output, i.e., it's true
X
# the part of the 'congrval'
all(table(mI %*% 2^(6*0:2)) == 1)# TRUE
X
X
## Return 'congrval' part of .Random.seed after  set.seed(.):
## need 'polyn.eval' from my goodies:
ssC <- function(i){ set.seed(i);polyn.eval(.Random.seed[  1:6],2^6)}
ssT <- function(i){ set.seed(i);polyn.eval(.Random.seed[6+1:6],2^6)}
X
##-- All the 'congrval' that set.seed(.) produces ..
Cs <- ii <- 1:1024
for(i in ii) Cs[i] <- ssC(i)
dim(tCs <- table(Cs))# = 1024
all(tCs == 1) # TRUE  (each once)
X
summary(Cs / 2^32)
##-       Min. 1st Qu. Median   Mean 3rd Qu.   Max.
##-  4.694e-05  0.2498 0.4996 0.4996  0.7493 0.9991
X
dCs <- unique(diff(srt.C <- sort(Cs)))
dCs##->  4194304  only one value !
log(dCs, base =2)# == 22
X
C1 <- srt.C[1]
all(srt.C == C1 + (ii-1) * 2^22) #- TRUE !
X
## the values are not quite symmetrical in {0,..,2^32-1} :
2^32 - srt.C[1024]# 3992683
C1                #  201621
X
###------------ Martin Mchler's Summary : ------------------------
X
###--- Mon, Sept. 15, 1997 ----------
X
##- Unfortunately, we don't know what exactly happens in
##- the S-plus code for set.seed(i), namely,  .C("setseed", as.integer(i))
##- However, I have found out the following which should suffice :
##-
##-  1) Only .Random.seed[4:6]  are varyied by set.seed, i.e.,
##-    after set.seed(i), .Random.seed always is
##-
##-            1  2  3  4  5  6  7  8  9 10 11 12
##-       [1] 21 14 49  *  *  * 32 22 36 23 28  3
##-                    X4 X5 X6
##-
##- which means that only the 'congrval' {Venables & Ripley, 2nd ed., p.166-167}
##-    is varied
##-
##-  2) X4 is always ==  16*((i+2) %% 4)
##-     X5 takes (all) values in 0:63  [also with some periodicity]
##-     X6 takes the values of 0:3
##-
##-  3) set.seed(i) <==> set.seed(i + n*1024)  for all integers n, i
##-
##-  4) { set.seed(i) ;  i \in {integers}}
##-     results in a set of 1024 different values of 'congrval'.
##-     These values are EXACTLY EQUISPACED lying in {0,..,2^32}.
##-
##-     If C[1:1024] are these sorted values, we have
##-
##- 	C[i] == 201621 + (i-1)* 2^22  , for i in 1:1024
##-
X
SHAR_EOF
  $shar_touch -am 1124095797 'setseed-ex.S' &&
  chmod 0644 'setseed-ex.S' ||
  $echo 'restore of' 'setseed-ex.S' 'failed'
  if ( md5sum --help 2>&1 | grep 'sage: md5sum \[' ) >/dev/null 2>&1 \
  && ( md5sum --version 2>&1 | grep -v 'textutils 1.12' ) >/dev/null; then
    md5sum -c << SHAR_EOF >/dev/null 2>&1 \
    || $echo 'setseed-ex.S:' 'MD5 check failed'
c2d03d4318c03a8f2ed8b4f0b656c647  setseed-ex.S
SHAR_EOF
  else
    shar_count="`LC_ALL= LC_CTYPE= LANG= wc -c < 'setseed-ex.S'`"
    test 3646 -eq "$shar_count" ||
    $echo 'setseed-ex.S:' 'original size' '3646,' 'current size' "$shar_count!"
  fi
fi
# ============= ../C-Progs/programs/Runif.c ==============
if test ! -d '..'; then
  $echo 'x -' 'creating directory' '..'
  mkdir '..'
fi
if test ! -d '../C-Progs'; then
  $echo 'x -' 'creating directory' '../C-Progs'
  mkdir '../C-Progs'
fi
if test ! -d '../C-Progs/programs'; then
  $echo 'x -' 'creating directory' '../C-Progs/programs'
  mkdir '../C-Progs/programs'
fi
if test -f '../C-Progs/programs/Runif.c' && test "$first_param" != -c; then
  $echo 'x -' SKIPPING '../C-Progs/programs/Runif.c' '(file already exists)'
else
  $echo 'x -' extracting '../C-Progs/programs/Runif.c' '(text)'
  sed 's/^X//' << 'SHAR_EOF' > '../C-Progs/programs/Runif.c' &&
/*--- this code is from a posting of
X  Brian Ripley to the S-news, 7 Aug 92,
X  and a slight correction from  Allen Mcintosh <mcintosh@larch.bellcore.com>
X  + a correction of mine (B.R. wrote '69096' instead of '69069'))
X
X  -->  /u/maechler/tex/o.peopl/Ripley-S-RNG.tex
*/
X
/*--- This code is perfectly tested out via S-code
X
X  in -->  /u/maechler/S/MISC/runif-tst.S
*/
X
unsigned long congr_MM, taus_MM;
X
static double xuni()
{
X        unsigned long n, lambda = 69069;
X        congr_MM *= lambda;
X        taus_MM  ^= taus_MM >> 15;
X        taus_MM  ^= taus_MM << 17;
/* Orig (Splus <= 3.2):
X        n = taus_MM ^ congr_MM;
X        return ( (n>>1) / 2147483648.);
X * New: */
X        n = (taus_MM ^ congr_MM) >> 1;
X        if(n) { /* n != 0 */ return( n / 2147483648.);
X	} else return(xuni());
}
X
X
/*--- The following are to be  dyn.load(..)ed   and called  from  S(plus) --*/
X
void Runif (double* res) {  *res = xuni(); }
X
void Init_seed (long* Cval, long* Tval)
{
X  congr_MM = (unsigned long)*Cval;
X  taus_MM  = (unsigned long)*Tval;
}
X
void Get_seed (long* Cval, long* Tval)
{
X  *Cval = (long) congr_MM;
X  *Tval = (long) taus_MM;
}
SHAR_EOF
  $shar_touch -am 1124141497 '../C-Progs/programs/Runif.c' &&
  chmod 0644 '../C-Progs/programs/Runif.c' ||
  $echo 'restore of' '../C-Progs/programs/Runif.c' 'failed'
  if ( md5sum --help 2>&1 | grep 'sage: md5sum \[' ) >/dev/null 2>&1 \
  && ( md5sum --version 2>&1 | grep -v 'textutils 1.12' ) >/dev/null; then
    md5sum -c << SHAR_EOF >/dev/null 2>&1 \
    || $echo '../C-Progs/programs/Runif.c:' 'MD5 check failed'
f5888c70e55b647a34d8bee3aae3b4ad  ../C-Progs/programs/Runif.c
SHAR_EOF
  else
    shar_count="`LC_ALL= LC_CTYPE= LANG= wc -c < '../C-Progs/programs/Runif.c'`"
    test 1132 -eq "$shar_count" ||
    $echo '../C-Progs/programs/Runif.c:' 'original size' '1132,' 'current size' "$shar_count!"
  fi
fi
rm -fr _sh01181
exit 0

--Multipart_Mon_Nov_24_14:51:09_1997-1
Content-Type: text/plain; charset=US-ASCII



--Multipart_Mon_Nov_24_14:51:09_1997-1--
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=---
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=---

From Martin Maechler <maechler@stat.math.ethz.ch>  Wed Nov 26 08:27:32 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 26 Nov 1997 09:27:32 +0100
Subject: R-alpha: Re: R-beta: Latin-1 characters (and "=-=" footer and MIME...)
In-Reply-To: <x2g1oklqxg.fsf@blueberry.kubism.ku.dk> (message from Peter
 Dalgaard BSA on 25 Nov 1997 20:22:19 +0100)
Message-ID: <199711260827.JAA00479@sophie.ethz.ch>

=09[redirected to R-devel;  does NOT belong anymore into R-help]

>>>>> "PD" =3D=3D Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk> writes:

    PD> Martin Maechler <maechler@stat.math.ethz.ch> writes:

    >>  You didn't say which version of R you are using;
    >> 
    >> It is true that 0.50-a4 still doesn't properly work with these.
    >> However, I though Windows "Rsept" was somewhat newer...
    >> 
    >> Anyway, in current source (unreleased) version, it's all nice :
=09MM> > M=E4chler <- 1:3
=09MM> > ls(pat=3D"^M")
=09MM> [1] "M=E4chler"
=09MM> > M=E4chler
=09MM> [1] 1 2 3


    PD> This seems to be wandering in and out of the sources. The snapshot
    PD> I've been using does

    >> =F8

    PD> Save workspace image? [y/n/c]:

    PD> - but I'm pretty sure an *earlier* one (0.49?) did do Latin1. How
    PD> about adding this to your set of regression tests, so that it
    PD> becomes possible to detect whenever the source tree gets modified?
Ok, I'll think about doing this.


ISO-Latin1 Characters (current source, not yet 0.50): 
~~~~~~~~~~~~~~~~~~~~~

 1) Everything seems ok, if they are used in  strings (and comments)

 2) If you use them as [language] symbols, things are different :
=09

> =D6
[1] 0
> =C4
[1] 0
> =FC
Error: syntax error
=09=09=09--- so `=FC' is different from `=E4' ...
> =E4
[1] 0
> =E4 <- 1
Error in 0 <- 1 : invalid (do_set) left-hand side to assignment


> =F2
Error: Object "=F2" not found
> =B5
Error: syntax error
> =AE
Error: Object "=AE" not found
> =AB
Error: syntax error
> "=ABQuoted=BB text"
[1] "=ABQuoted=BB text"
> =FE
Error: syntax error
> "=FE"
[1] "=FE"
> =F8
Error: syntax error
> "=F8"
[1] "=F8"
> nchar("=F8")
[1] 1

---------------------- etc. ---------------------------

Point is: 
=09It's not quite clear which ISO-latin1 characters should 
=09belong to the set of characters which can be used in R symbols
=09{this is not the same as R object names,
=09 which can contain everything, using  assign(..) and  get(..)}

Note that in S-plus,  ONLY  ASCII characters valid  symbol names,

I think, all the following should be allowed  symbol components,
to make  R  really  ``nicely usable'' for  European-Language users

  A.accents <- "=E0=E1=E2=E3=E4=E5=E6 =C0=C1=C2=C3=C4=C5=C6" # `a 'a ^a "a =
oa ae  `A 'A ^A "A oA AE
  EI.accents <- "=C8=C9=CA=CB=CC=CD=CE=CF =E8=E9=EA=EB=EC=ED=EE=EF"# =3D `E=
 'E ^E "E  `I 'I .....
  O.accents <- "=D2=D3=D4=D5=D6=D8=F2=F3=F4=F5=F6=F8"
  U.accents <- "=D9=DA=DB=DC=DD=F9=FA=FB=FC=FD"
## I did not include the two islandic
  Islandic <- "=D0=F0" # maybe we should

------------------------
R & R, any comments?
------------------------



    PD> And BTW, yes, your message became "malformed quoted printable"
    PD> because of the =3D-=3D- pattern in the footer. May I suggest we qui=
etly
    PD> change "=3D" to "+" or "~" (while equally quietly cursing the MIME
    PD> standard mess...)

Ok, just done it (change and polite curse).  You should see it now..

- Martin
_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_---
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_---

From p.dalgaard@biostat.ku.dk  Wed Nov 26 10:24:02 1997
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 26 Nov 1997 11:24:02 +0100
Subject: R-alpha: Re: R-beta: Latin-1 characters (and "=-=" footer and MIME...)
In-Reply-To: Martin Maechler's message of Wed, 26 Nov 1997 09:27:32 +0100
References: <199711260827.JAA00479@sophie.ethz.ch>
Message-ID: <x2wwhweywt.fsf@blueberry.kubism.ku.dk>

Martin Maechler <maechler@stat.math.ethz.ch> writes:

>   A.accents <- "=E0=E1=E2=E3=E4=E5=E6 =C0=C1=C2=C3=C4=C5=C6" # `a 'a ^=
a "a oa ae  `A 'A ^A "A oA AE
>   EI.accents <- "=C8=C9=CA=CB=CC=CD=CE=CF =E8=E9=EA=EB=EC=ED=EE=EF"# =3D=
 `E 'E ^E "E  `I 'I .....
>   O.accents <- "=D2=D3=D4=D5=D6=D8=F2=F3=F4=F5=F6=F8"
>   U.accents <- "=D9=DA=DB=DC=DD=F9=FA=FB=FC=FD"
> ## I did not include the two islandic
>   Islandic <- "=D0=F0" # maybe we should
>=20

Given R's habit of using symbol names in plots, anything occurring in
any Latin1-language should be there (I've seen too many manglings of
the Danish language for 7-bit programs, that I'd pass the opportunity
to get it done right in R). The above lists misses n-tilde (=F1) and
c-cedilla (=E7). I dont see anything harmful in including the whole
"upper ascii" part (characters 160-255, at least) as symbols.

> ------------------------
> R & R, any comments?
> ------------------------


--=20
   O__  ---- Peter Dalgaard             Blegdamsvej 3 =20
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N  =20
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Wed Nov 26 10:47:19 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 26 Nov 1997 11:47:19 +0100
Subject: R-alpha:  Latin-1 characters (3)
In-Reply-To: <x2wwhweywt.fsf@blueberry.kubism.ku.dk> (message from Peter
 Dalgaard BSA on 26 Nov 1997 11:24:02 +0100)
Message-ID: <199711261047.LAA00657@sophie.ethz.ch>

>>>>> "PD" =3D=3D Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk> writes:

    PD> Martin Maechler <maechler@stat.math.ethz.ch> writes:
    >> A.accents <- "=E0=E1=E2=E3=E4=E5=E6 =C0=C1=C2=C3=C4=C5=C6" # `a 'a ^=
a "a oa ae  `A 'A ^A "A oA AE
    >> EI.accents <- "=C8=C9=CA=CB=CC=CD=CE=CF =E8=E9=EA=EB=EC=ED=EE=EF"# =
=3D `E 'E ^E "E  `I 'I .....
    >> O.accents <- "=D2=D3=D4=D5=D6=D8=F2=F3=F4=F5=F6=F8"
    >> U.accents <- "=D9=DA=DB=DC=DD=F9=FA=FB=FC=FD"
    >> ## I did not include the two islandic
    >> Islandic <- "=D0=F0" # maybe we should
    >> 

    PD> Given R's habit of using symbol names in plots, anything occurring =
in
    PD> any Latin1-language should be there (I've seen too many manglings o=
f
    PD> the Danish language for 7-bit programs, that I'd pass the opportuni=
ty
    PD> to get it done right in R). The above lists misses n-tilde (=F1) an=
d
    PD> c-cedilla (=E7).
and '=DF'  (we don't use it in Switzerland; 
=09  it's ``just'' the Germans and Austrians .... :-)

 
    PD> I dont see anything harmful in including the whole
    PD> "upper ascii" part (characters 160-255, at least) as symbols.

are you serious,  including  160 =3D octal 240 ?
Would you want legal syntax such as

=09=B1=B4=B4 <- 1:3


Here is an excerpt of a file I wrote a few years ago:

All-L1> Note that \240 is VERY funny "invisible", 
All-L1> makes things reversevideo/invisible/!@#!  depending on Emacs versio=
n.
All-L1> For this reason, I  OMIT it in the following [Enter it with ^Q240]:
All-L1> 
All-L1> Dec Oct               Dec Oct 
All-L1>           =A1=A2=A3=A4=A5=A6=A7                =A8=A9=AA=AB=AC=AD=
=AE=AF
All-L1> 160 240: 01234567     168 250:   01234567
All-L1>                      
All-L1>          =B0=B1=B2=B3=B4=B5=B6=B7                =B8=B9=BA=BB=BC=BD=
=BE=BF
All-L1> 176 260: 01234567     184 270:   01234567
All-L1>                      
All-L1>          =C0=C1=C2=C3=C4=C5=C6=C7                =C8=C9=CA=CB=CC=CD=
=CE=CF
All-L1> 192 300: 01234567     200 310:   01234567
All-L1>                      
All-L1>          =D0=D1=D2=D3=D4=D5=D6=D7                =D8=D9=DA=DB=DC=DD=
=DE=DF
All-L1> 208 320: 01234567     216 330:   01234567
All-L1>                      
All-L1>          =E0=E1=E2=E3=E4=E5=E6=E7                =E8=E9=EA=EB=EC=ED=
=EE=EF
All-L1> 224 340: 01234567     232 350:   01234567
All-L1>                      
All-L1>          =F0=F1=F2=F3=F4=F5=F6=F7                =F8=F9=FA=FB=FC=FD=
=FE=FF
All-L1> 240 360: 01234567     248 370:   01234567


Given this table, I'd say  192-255 [dec] =3D 300-377 [okt],
maybe excluding   =D7 and =F7 ..



    >> ------------------------
    >> R & R, any comments?
    >> ------------------------

(when you get up to a new day.. find all these funny symbols in your
 mail box ..)

-- Martin

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Wed Nov 26 11:14:35 1997
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 26 Nov 1997 12:14:35 +0100
Subject: R-alpha:  Latin-1 characters (3)
In-Reply-To: Martin Maechler's message of Wed, 26 Nov 1997 11:47:19 +0100
References: <199711261047.LAA00657@sophie.ethz.ch>
Message-ID: <x2vhxfgb50.fsf@blueberry.kubism.ku.dk>

Martin Maechler <maechler@stat.math.ethz.ch> writes:

> are you serious,  including  160 =3D octal 240 ?
> Would you want legal syntax such as
>=20
> =09=B1=B4=B4 <- 1:3

Maybe use the circled c (=A9) as a variable containing the GNU Copyleft
message? ;)

But how about =B5l.H2O ?

Question is, would it harm anything (except legibility)? And in a
slightly longer run, what about other ISO character sets (e.g. Latin2,
used in Slavic parts of Eastern Europe and Cyrillic). Do they have
punctuation in the same places? As long as there's no technical reason
to forbid it, why not allow it? I don't suppose we plan to use any of
the characters as syntax elements, do we? (And why am I speaking in
questions today?)

>=20
> Here is an excerpt of a file I wrote a few years ago:
>=20
> All-L1> Note that \240 is VERY funny "invisible",=20
> All-L1> makes things reversevideo/invisible/!@#!  depending on Emacs v=
ersion.
> All-L1> For this reason, I  OMIT it in the following [Enter it with ^Q=
240]:

This is curious. It's supposed to represent non-breakable space --
which might actually make it a rather useful item.

> Given this table, I'd say  192-255 [dec] =3D 300-377 [okt],
> maybe excluding   =D7 and =F7 ..


>     >> ------------------------
>     >> R & R, any comments?
>     >> ------------------------
>=20
> (when you get up to a new day.. find all these funny symbols in your
>  mail box ..)

<grin>

--=20
   O__  ---- Peter Dalgaard             Blegdamsvej 3 =20
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N  =20
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ihaka@stat.auckland.ac.nz  Wed Nov 26 19:35:05 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Thu, 27 Nov 1997 08:35:05 +1300 (NZDT)
Subject: R-alpha:  Latin-1 characters (3)
Message-ID: <199711261935.IAA09097@stat1.stat.auckland.ac.nz>

	>> ------------------------
	>> R & R, any comments?
	>> ------------------------

At present the parser makes the decision on what characters can go into
symbol names based on isalpha(c).  If someone will send me a function -
say isidchar(c) which returns 1 for characters which can be in
identifiers and 0 otherwise, I will replace the current test with that.

	Ross
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Wed Nov 26 21:46:45 1997
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 26 Nov 1997 22:46:45 +0100
Subject: R-alpha:  Latin-1 characters (3)
In-Reply-To: Ross Ihaka's message of Thu, 27 Nov 1997 08:35:05 +1300 (NZDT)
References: <199711261935.IAA09097@stat1.stat.auckland.ac.nz>
Message-ID: <x2pvnn2ure.fsf@blueberry.kubism.ku.dk>

Ross Ihaka <ihaka@stat.auckland.ac.nz> writes:

>=20
> =09>> ------------------------
> =09>> R & R, any comments?
> =09>> ------------------------
>=20
> At present the parser makes the decision on what characters can go int=
o
> symbol names based on isalpha(c).  If someone will send me a function =
-
> say isidchar(c) which returns 1 for characters which can be in
> identifiers and 0 otherwise, I will replace the current test with that=
.
>=20
> =09Ross

Ahaaa... So the "oscillatory behaviour" is just me shifting between
machines with proper locale configuration and machines without it! I
think that isalpha() is actually the way to go. People just have to
get their locales right. Here's what's in isalpha(c)=3D=3D1 for the da_D=
K
locale:

ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz=AD
=C0=C1=C2=C3=C4=C5=C6=C7=C8=C9=CA=CB=CC=CD=CE=CF=D0=D1=D2=D3=D4=D5=D6=D8=
=D9=DA=DB=DC=DD=DE=DF=E0=E1=E2=E3=E4=E5=E6=E7=E8=E9=EA=EB=EC=ED=EE=EF=F0=
=F1=F2=F3=F4=F5=F6=F8=F9=FA=FB=FC=FD=FE=FF

The hyphen following 'z' is actually 0xad (soft hyphen).

--=20
   O__  ---- Peter Dalgaard             Blegdamsvej 3 =20
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N  =20
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Thu Nov 27 09:35:06 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Thu, 27 Nov 1997 10:35:06 +0100
Subject: R-alpha:  Latin-1 characters / Locale etc.
In-Reply-To: <x2pvnn2ure.fsf@blueberry.kubism.ku.dk> (message from Peter
 Dalgaard BSA on 26 Nov 1997 22:46:45 +0100)
Message-ID: <199711270935.KAA03092@sophie.ethz.ch>

>>>>> "PD" =3D=3D Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk> writes:

    PD> Ross Ihaka <ihaka@stat.auckland.ac.nz> writes:
    >>  >> ------------------------ >> R & R, any comments?  >>
    >> ------------------------
    >> 
    >> At present the parser makes the decision on what characters can go
    >> into symbol names based on isalpha(c).  If someone will send me a
    >> function - say isidchar(c) which returns 1 for characters which can
    >> be in identifiers and 0 otherwise, I will replace the current test
    >> with that.
    >> 
    >> Ross

Hmm, so we would follow the Unix locale philosophy.
I could live with it.

It has however, a distinct drawback:

You can write R code which works with R compiled in one environment but
fails with --identical R source code-- compiled in a different environment.

While this is true for things like 'readline' and 'proc.time / system.time'=
,
I don't like it so much for such a basic things as symbol characters.


    PD> Ahaaa... So the "oscillatory behaviour" is just me shifting between
    PD> machines with proper locale configuration and machines without it!
    PD> I think that isalpha() is actually the way to go. People just have
    PD> to get their locales right. Here's what's in isalpha(c)=3D=3D1 for =
the
    PD> da_DK locale:

    PD> ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz=AD
    PD> =C0=C1=C2=C3=C4=C5=C6=C7=C8=C9=CA=CB=CC=CD=CE=CF=D0=D1=D2=D3=D4=D5=
=D6=D8=D9=DA=DB=DC=DD=DE=DF=E0=E1=E2=E3=E4=E5=E6=E7=E8=E9=EA=EB=EC=ED=EE=EF=
=F0=F1=F2=F3=F4=F5=F6=F8=F9=FA=FB=FC=FD=FE=FF

    PD> The hyphen following 'z' is actually 0xad (soft hyphen).


In any case, I'd propose a new  
=09function 'alphachars()' 
and/or a global variable 
=09Alphachars
or=09.Symbolchars
(or something better)
which returns a vector of nchar(1)-characters
giving the available symbols.

In=09../library/base/Alpha.Rd  (the accompanying help page),
all this would then be explained to users.

BTW, Peter D., do you have a (electronical form of a) document available
which nicely explains the  locale stuff (for a user, not a C-programmer ..)=
.
 Kurt/Fritz/???: I think there are some nice pages available in Linux.somet=
hing 

----------------------------------------
I'm still wondering:
The  only locale thing we have is (the environment variable)

=09LC_CTYPE=3Diso_8859_1

But then I wonder why I saw the difference between  =E4 and =FC 
that I reported ....

- Martin=
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From phlamber@luc.ac.be  Thu Nov 27 10:02:26 1997
From: phlamber@luc.ac.be (Philippe Lambert)
Date: Thu, 27 Nov 1997 11:02:26 +0100 (MET)
Subject: R-alpha: RData in batch
Message-ID: <Pine.OSF.3.96.971127103915.13153A-100000@alpha>

Just a word to mention that I have lost 2 hours yesterday to find out why
R refused to use a function from a package calling C-code.
R invariably answered that the C code was not in the load table (something
like this). I have tried everything (or nearly) to solve my problem
knowing that this same package used to work on my computer at the
university.
Finally, I found out that running the same instructions as root work fine.
The explanation for my computer sudden good will is not that I was root,
but that I ran R in a different directory ... without .RData!!
(and I don't care about .RData when I use R in batch mode!!).

Thus, 
would it be possible to have R not creating .RData file by default in
batch mode?

A second potential problem: when I build packages including personal
functions, I use to test my functions interactively by typing
library(mypackage) after modification of my code in an editor.
The problem is that repeating the library load does not erase the old
version. Do I do something wrong?


Philippe


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Thu Nov 27 10:09:40 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Thu, 27 Nov 1997 11:09:40 +0100
Subject: R-alpha: RData in batch
In-Reply-To: <Pine.OSF.3.96.971127103915.13153A-100000@alpha> (message from
 Philippe Lambert on Thu, 27 Nov 1997 11:02:26 +0100 (MET))
Message-ID: <199711271009.LAA03190@sophie.ethz.ch>

>>>>> "Philippe" == Philippe Lambert <phlamber@luc.ac.be> writes:

    Philippe> Just a word to mention that I have lost 2 hours yesterday to
    Philippe> find out why R refused to use a function from a package
    Philippe> calling C-code.  R invariably answered that the C code was
    Philippe> not in the load table (something like this). I have tried
    Philippe> everything (or nearly) to solve my problem knowing that this
    Philippe> same package used to work on my computer at the university.
    Philippe> Finally, I found out that running the same instructions as
    Philippe> root work fine.  The explanation for my computer sudden good
    Philippe> will is not that I was root, but that I ran R in a different
    Philippe> directory ... without .RData!!  (and I don't care about
    Philippe> .RData when I use R in batch mode!!).

    Philippe> Thus, would it be possible to have R not creating .RData file
    Philippe> by default in batch mode?

Most of us (I think) don't like your proposal;
.RData is the only thing to prevent losses of hours of computation
(simulation runs). 

If you want to make sure that a .RData is not interfering at the START of
your batch job, just do
(in a 'sh' script, or even better, in the Makefile, I'd recommend using):

	if [ -f .RData ]; mv .RData .RData.old; fi
	R < input.R > output.Rout


    Philippe> A second potential problem: when I build packages including
    Philippe> personal functions, I use to test my functions interactively
    Philippe> by typing library(mypackage) after modification of my code in
    Philippe> an editor.  The problem is that repeating the library load
    Philippe> does not erase the old version. Do I do something wrong?

library(.) tries to make sure to be efficient and not load the same things
twice. (--> online help  ?library ).
In the case where you are constantly changing / upgrading a library,
you should just work with  source(.)

Martin
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Friedrich.Leisch@ci.tuwien.ac.at  Thu Nov 27 10:14:51 1997
From: Friedrich.Leisch@ci.tuwien.ac.at (Friedrich Leisch)
Date: Thu, 27 Nov 1997 11:14:51 +0100
Subject: R-alpha: RData in batch
In-Reply-To: <Pine.OSF.3.96.971127103915.13153A-100000@alpha>
References: <Pine.OSF.3.96.971127103915.13153A-100000@alpha>
Message-ID: <199711271014.LAA27212@galadriel.ci.tuwien.ac.at>

>>>>> On Thu, 27 Nov 1997 11:02:26 +0100 (MET),
>>>>> Philippe Lambert (PL) wrote:

PL> Just a word to mention that I have lost 2 hours yesterday to find out=
 why
PL> R refused to use a function from a package calling C-code.
PL> R invariably answered that the C code was not in the load table (some=
thing
PL> like this). I have tried everything (or nearly) to solve my problem
PL> knowing that this same package used to work on my computer at the
PL> university.
PL> Finally, I found out that running the same instructions as root work =
fine.
PL> The explanation for my computer sudden good will is not that I was ro=
ot,
PL> but that I ran R in a different directory ... without .RData!!
PL> (and I don't care about .RData when I use R in batch mode!!).

There was a bug in dynamic loading by libraries ... the load-table was
written to the .RData file, so R didn't reload any dynamic code after
starting R a second time in a directory upon the library(...) command.
This bug is already fixed in the current sources (which are not
publicly available yet but should be out soon).


PL> Thus,=20
PL> would it be possible to have R not creating .RData file by default in
PL> batch mode?

Why don't you simply rename or delete the .Rdata file before you start
the batch simulation?


PL> A second potential problem: when I build packages including personal
PL> functions, I use to test my functions interactively by typing
PL> library(mypackage) after modification of my code in an editor.
PL> The problem is that repeating the library load does not erase the old
PL> version. Do I do something wrong?

Well, the idea of the library command is to be ``smart'' when loading
code, i.e., library first looks if the package has already been loaded
and only loads the code when this is not already loaded. This way the
overhead of loading the same stuff over and over again can be avoided.

Use source() if you want to override this.


Best,
Fritz

--=20
-------------------------------------------------------------------
                        Friedrich  Leisch                            =20
Institut f=FCr Statistik                      Tel: (+43 1) 58801 4541
Technische Universit=E4t Wien                 Fax: (+43 1)  504 14 98
Wiedner Hauptstra=DFe 8-10/1071      Friedrich.Leisch@ci.tuwien.ac.at
A-1040 Wien, Austria             http://www.ci.tuwien.ac.at/~leisch
     PGP public key http://www.ci.tuwien.ac.at/~leisch/pgp.key
-------------------------------------------------------------------

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From jlindsey@luc.ac.be  Thu Nov 27 11:02:08 1997
From: jlindsey@luc.ac.be (Jim Lindsey)
Date: Thu, 27 Nov 1997 12:02:08 +0100 (MET)
Subject: R-alpha: batch
Message-ID: <9711271102.AA20305@alpha.luc.ac.be>

There absolutely has to be a global option (environment or RProfile)
that allows creating the .RData in batch mode to be disabled. It is
not at all serious to expect that it be disabled in each batch file.
(On my complete system, I have creation of .RData in interactive mode
disabled by redefinition of q() in the global RProfile.)  Otherwise, R
will never be a serious tool for statistical work because of the
incorrect statistical analyses that stray unnoticed .RData files can
produce. If this control of options is not introduced into 0.60, I
shall have seriously reconsider whether I shall continue using R.
  Jim
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Thu Nov 27 11:05:50 1997
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 27 Nov 1997 12:05:50 +0100
Subject: R-alpha:  Latin-1 characters / Locale etc.
In-Reply-To: Martin Maechler's message of Thu, 27 Nov 1997 10:35:06 +0100
References: <199711270935.KAA03092@sophie.ethz.ch>
Message-ID: <x27m9uwq9d.fsf@blueberry.kubism.ku.dk>

Martin Maechler <maechler@stat.math.ethz.ch> writes:

>=20
> >>>>> "PD" =3D=3D Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk> writes=
:

> Hmm, so we would follow the Unix locale philosophy.
> I could live with it.
>=20
> It has however, a distinct drawback:
>=20
> You can write R code which works with R compiled in one environment bu=
t
> fails with --identical R source code-- compiled in a different environ=
ment.

Actually, it's a run-time not compile-time issue.

> While this is true for things like 'readline' and 'proc.time / system.=
time',
> I don't like it so much for such a basic things as symbol characters.

Yes, it's no good having library code that only works in some locales.
However, it should be fairly easy to enforce (in some sense) a
requirement that everything on CRAN should work with LANG=3DC (unless,
of course it *is* language-specific code).

> BTW, Peter D., do you have a (electronical form of a) document availab=
le
> which nicely explains the  locale stuff (for a user, not a C-programme=
r ..).
>  Kurt/Fritz/???: I think there are some nice pages available in Linux.=
something=20

Argh. Stop tickling my guilty conscience. I've been promising to do a
write-up of that for the Danish-Howto for months. Trouble is, I tend
to forget how to do it myself... So right now, the two main machines
that I use are not set up right (running a straigh RedHat 4.2),
whereas my old 486 does have the stuff in place.=20

> I'm still wondering:
> The  only locale thing we have is (the environment variable)
>=20
> =09LC_CTYPE=3Diso_8859_1
>=20
> But then I wonder why I saw the difference between  =E4 and =FC=20
> that I reported ....

Hmm, that *is* strange... Try a variant of

unsigned char c =3D 0;
char *p;
main()
{
        while(++c)
                if ( isalpha(c) ) putchar(c);
        putchar('\n');
}

--=20
   O__  ---- Peter Dalgaard             Blegdamsvej 3 =20
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N  =20
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From thomas@biostat.washington.edu  Thu Nov 27 17:33:37 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Thu, 27 Nov 1997 09:33:37 -0800 (PST)
Subject: R-alpha: RData in batch
In-Reply-To: <Pine.OSF.3.96.971127103915.13153A-100000@alpha>
Message-ID: <Pine.SOL.3.95.971127092638.7075A-100000@gorn>

On Thu, 27 Nov 1997, Philippe Lambert wrote:

> Finally, I found out that running the same instructions as root work fine.
> The explanation for my computer sudden good will is not that I was root,
> but that I ran R in a different directory ... without .RData!!
> (and I don't care about .RData when I use R in batch mode!!).

This is a known and probably fixed bug.  The list of currently loaded
dynamic libraries is stored in .Dyn.libs, which is (incorrectly) saved in
.Rdata.  It should just be discarded.  A temporary fix is to add 
	.Dyn.libs<-NULL
to your start-up file.

> A second potential problem: when I build packages including personal
> functions, I use to test my functions interactively by typing
> library(mypackage) after modification of my code in an editor.
> The problem is that repeating the library load does not erase the old
> version. Do I do something wrong?

No. library() is only supposed to load a package if it hasn't already been
loaded.  This is a feature.  You can unload the package with detach() and
then reload with library().  I don't know if compiled code can be unloaded
and reloaded in the current version, though I think it is at least
planned.

	-thomas

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ihaka@stat.auckland.ac.nz  Thu Nov 27 23:40:25 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Fri, 28 Nov 1997 12:40:25 +1300 (NZDT)
Subject: R-alpha:  Latin-1 characters / Locale etc.
In-Reply-To: <199711270935.KAA03092@sophie.ethz.ch>
References: <x2pvnn2ure.fsf@blueberry.kubism.ku.dk>
 <199711270935.KAA03092@sophie.ethz.ch>
Message-ID: <199711272340.MAA28827@stat1.stat.auckland.ac.nz>

Martin Maechler writes:
 > Hmm, so we would follow the Unix locale philosophy.
 > I could live with it.
 > 
 > It has however, a distinct drawback:
 > 
 > You can write R code which works with R compiled in one environment but
 > fails with --identical R source code-- compiled in a different environment.
 > 
 > While this is true for things like 'readline' and 'proc.time / system.time',

I would tend to agree that this is a drawback.  I'd rather see a
locale independent solution.  So let me repeat my invitation ...
If someone will send me a function which identifies the set of
characters which can be used in identifiers (in addition to "."), I
will add it to the sources.

Getting it exactly right first time probably isn't crucial.
I'm sure we'll here form anyone who feels slighted :).
	Ross
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ihaka@stat.auckland.ac.nz  Thu Nov 27 23:57:40 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Fri, 28 Nov 1997 12:57:40 +1300 (NZDT)
Subject: R-alpha: RData in batch
In-Reply-To: <Pine.OSF.3.96.971127103915.13153A-100000@alpha>
References: <Pine.OSF.3.96.971127103915.13153A-100000@alpha>
Message-ID: <199711272357.MAA01329@stat1.stat.auckland.ac.nz>

Philippe Lambert writes:
 > Thus, 
 > would it be possible to have R not creating .RData file by default in
 > batch mode?

Hmmm.  Actually I was on your side, but there were a number of
requests to do it the other way.

So let me play Solomon ...

I think that I will introduce two new options to be used when invoking
R.

	R -save
	R -nosave

The default behavior in batch mode will be to refuse to run unless one
of these options is specified.

Multiple versions of these options will be allowed on the command
line, and it is the last (rightmost) one which determines what
happens.

In the front-end shell-script there is a line which reads

	exec $DEBUGGER $RHOME/bin/R.binary $*

and I will change this to

	exec $DEBUGGER $RHOME/bin/R.binary $BATCHSAVE $*

and give the person installing R the option of setting a value for
BATCHSAVE in the config.site script (or when we go gnu --with-save
or --with-nosave).

This way there can be a site-wide selection of the default behavior
which individual users can override.

Sound ok?
	Ross

(I think that Thomas L pointed out that the real bug that bit you has
been fixed too).
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Nov 28 07:45:39 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 28 Nov 1997 08:45:39 +0100
Subject: R-alpha:  Latin-1 characters / Locale etc.
In-Reply-To: <x2zpmquyvg.fsf@blueberry.kubism.ku.dk> (message from Peter
 Dalgaard BSA on 27 Nov 1997 16:42:43 +0100)
Message-ID: <199711280745.IAA04422@sophie.ethz.ch>

[to R-devel,  for everyone's information;
 thanks a lot, Peter!]

>>>>> "PD" =3D=3D Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk> writes:

    PD> Hmmm. You may need a call to 
       
    PD> #include <locale.h>
    PD> setlocale(LC_ALL,"")

    PD> (or LC_CTYPE?) before your environment variables take effect.

Yes, this was `it'.  
Maybe  R  needs such a call also? (I did not yet look in the src)


sophie{maechler}328> cat isalpha-tst.c
=09=09=09 -------------
/*--- Testing  'locale' [env.variable  LC_CTYPE ] --------------- */

#include <ctype.h> /*- isalpha(.) -*/
#include <stdio.h> /*- putchar(.) -*/
#include <locale.h>

unsigned char c =3D 0;
char *p;
void main()
{
  setlocale(LC_ALL,"");

  while(++c)
    if ( isalpha(c) ) putchar(c);
  putchar('\n');
}
sophie{maechler}329> cc isalpha-tst.c
sophie{maechler}330> cc -V
cc: SC3.0.1 13 Jul 1994
usage: cc [ options] files.  Use 'cc -flags' for details

sophie{maechler}314> printenv LC_CTYPE
iso_8859_1

sophie{maechler}331> isalpha-tst 
ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz=C0=C1=C2=C3=C4=C5=C6=
=C7=C8=C9=CA=CB=CC=CD=CE=CF=D0=D1=D2=D3=D4=D5=D6=D8=D9=DA=DB=DC=DD=DE=DF=E0=
=E1=E2=E3=E4=E5=E6=E7=E8=E9=EA=EB=EC=ED=EE=EF=F0=F1=F2=F3=F4=F5=F6=F8=F9=FA=
=FB=FC=FD=FE=FF

sophie{maechler}332> gcc -v
Reading specs from /usr/local/lib/gcc-lib/sparc-sun-solaris2.5/2.7.2.1/spec=
s
gcc version 2.7.2.1
sophie{maechler}333> gcc isalpha-tst.c
sophie{maechler}334> isalpha-tst
ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz=C0=C1=C2=C3=C4=C5=C6=
=C7=C8=C9=CA=CB=CC=CD=CE=CF=D0=D1=D2=D3=D4=D5=D6=D8=D9=DA=DB=DC=DD=DE=DF=E0=
=E1=E2=E3=E4=E5=E6=E7=E8=E9=EA=EB=EC=ED=EE=EF=F0=F1=F2=F3=F4=F5=F6=F8=F9=FA=
=FB=FC=FD=FE=FF



sophie{maechler}335> unsetenv LC_CTYPE
sophie{maechler}336> isalpha-tst
ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz

sophie{maechler}337> setenv LC_CTYPE C
sophie{maechler}338> isalpha-tst
ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz

sophie{maechler}339> setenv LC_CTYPE es=09#-- espa=F1ol
sophie{maechler}340> isalpha-tst
ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz=C0=C1=C2=C3=C4=C5=C6=
=C7=C8=C9=CA=CB=CC=CD=CE=CF=D0=D1=D2=D3=D4=D5=D6=D8=D9=DA=DB=DC=DD=DE=DF=E0=
=E1=E2=E3=E4=E5=E6=E7=E8=E9=EA=EB=EC=ED=EE=EF=F0=F1=F2=F3=F4=F5=F6=F8=F9=FA=
=FB=FC=FD=FE=FF
sophie{maechler}341> setenv LC_CTYPE de #-- deutsch
sophie{maechler}342> isalpha-tst
ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz=C0=C1=C2=C3=C4=C5=C6=
=C7=C8=C9=CA=CB=CC=CD=CE=CF=D0=D1=D2=D3=D4=D5=D6=D8=D9=DA=DB=DC=DD=DE=DF=E0=
=E1=E2=E3=E4=E5=E6=E7=E8=E9=EA=EB=EC=ED=EE=EF=F0=F1=F2=F3=F4=F5=F6=F8=F9=FA=
=FB=FC=FD=FE=FF
sophie{maechler}345> setenv LC_CTYPE iso_8859_1
sophie{maechler}346> isalpha-tst
ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz=C0=C1=C2=C3=C4=C5=C6=
=C7=C8=C9=CA=CB=CC=CD=CE=CF=D0=D1=D2=D3=D4=D5=D6=D8=D9=DA=DB=DC=DD=DE=DF=E0=
=E1=E2=E3=E4=E5=E6=E7=E8=E9=EA=EB=EC=ED=EE=EF=F0=F1=F2=F3=F4=F5=F6=F8=F9=FA=
=FB=FC=FD=FE=FF

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From jlindsey@luc.ac.be  Fri Nov 28 08:25:04 1997
From: jlindsey@luc.ac.be (Jim Lindsey)
Date: Fri, 28 Nov 1997 09:25:04 +0100 (MET)
Subject: R-alpha: batch
Message-ID: <9711280825.AA30943@alpha.luc.ac.be>

In my limited knowledge of computers, a program that creates a hidden
file without informing you and then, in subsequent runs, has its
behaviour modified in unpredictable ways because of this is called a
virus.
  I am glad to learn that, with Ross's suggestion, R will finally be
removed from this undesirable class of programs, something that I have
been requesting since v0.13.
  I strongly recommend that the default in the distribution be no
.RData so the beginners do not get badly burned. The warnings in the
R notes about cleaning up before creating the .RData are far from
sufficient to indicate the dangers of these files. There should also
be a clear statement in the FAQ about the problems with their
existence.
  Jim 
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From plummer@iarc.fr  Fri Nov 28 11:05:22 1997
From: plummer@iarc.fr (Martyn Plummer)
Date: Fri, 28 Nov 1997 12:05:22 +0100 (MET)
Subject: R-alpha: Problems with dimnames and names
Message-ID: <XFMail.971128122615.plummer@iarc.fr>

This message is in MIME format
--_=XFMail.1.1.p0.Linux:971128122615:3052=_
Content-Type: text/plain; charset=us-ascii

I have rounded up three buglets in R-0.50-a4. Two of them I can
fix and a patch is supplied below. I hope this is useful for the
current source (if these haven't been fixed already :)

1) cov
cov() fails when it's argument is a matrix with one column and with
column names defined. It tries to apply dimnames to the output but
the output is a vector of length 1.

> x <- matrix(rnorm(100),ncol=1,dimnames=list(NULL,"foo"))
> var(x)
Error: dimnames applied to non-array

2) Subscripting one-dimensional arrays.
These are treated as vectors when subscripting
so subscripting by dimnames fails.

> x <- c(0,0,0,1,1,1,1,3)
> table(x)
0 1 3
3 4 1
> table(x)["3"]
Error: subscript out of bounds

3) I have no idea what's going on here.

> c(r=1,s=2)
s
2
> c(u=100,b=4)
b
4

This seems to happen only for "r" and "u". Other single-letter
names are OK. This doesn't happen on my home PC which is still
running R-0.50-a1.

Martyn

--_=XFMail.1.1.p0.Linux:971128122615:3052=_
Content-Type: text/plain; charset=us-ascii; name=apatch; SizeOnDisk=1206
Content-Description: apatch
Content-Transfer-Encoding: 7bit
Content-Disposition: attachment; filename="apatch"

diff -ur R-0.50-a4/src/main/cov.c R-0.50-a4.patched/src/main/cov.c
--- R-0.50-a4/src/main/cov.c	Sun Nov 24 23:43:05 1996
+++ R-0.50-a4.patched/src/main/cov.c	Fri Nov 28 11:21:23 1997
@@ -390,7 +390,7 @@
 	}
 	if(isNull(y)) {
 		x = getAttrib(x, R_DimNamesSymbol);
-		if(!isNull(x) && !isNull(CADR(x))) {
+		if(ncx > 1 && !isNull(x) && !isNull(CADR(x))) {
 			PROTECT(ind = allocList(2));
 			CAR(ind) = CADR(x);
 			CADR(ind) = CADR(x);
@@ -401,7 +401,7 @@
 	else {
 		x = getAttrib(x, R_DimNamesSymbol);
 		y = getAttrib(y, R_DimNamesSymbol);
-		if((!isNull(x) && !isNull(CADR(x))) || (!isNull(y) && !isNull(CADR(y)))) {
+		if((ncx > 1 && !isNull(x) && !isNull(CADR(x))) || ( ncy > 1 && !isNull(y) && 
!isNull(CADR(y)))) {
 			PROTECT(ind = allocList(2));
 			CAR(ind) = CADR(x);
 			CADR(ind) = CADR(y);
diff -ur R-0.50-a4/src/main/subset.c R-0.50-a4.patched/src/main/subset.c
--- R-0.50-a4/src/main/subset.c	Mon Aug 11 04:59:12 1997
+++ R-0.50-a4.patched/src/main/subset.c	Fri Nov 28 11:16:55 1997
@@ -608,7 +608,7 @@
 		PROTECT(dim = getAttrib(x, R_DimSymbol));
 		nsubs = length(subs);
 
-		if(nsubs == 1) {
+		if(nsubs == 1 && isNull(dim)) {
 			ans = vectorSubset(x, CAR(subs), call);
 		}
 		else {

--_=XFMail.1.1.p0.Linux:971128122615:3052=_--
End of MIME message
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Fri Nov 28 10:48:36 1997
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 28 Nov 1997 11:48:36 +0100
Subject: R-alpha: batch
In-Reply-To: Jim Lindsey's message of Fri, 28 Nov 1997 09:25:04 +0100 (MET)
References: <9711280825.AA30943@alpha.luc.ac.be>
Message-ID: <x2zpmpgupn.fsf@blueberry.kubism.ku.dk>

Jim Lindsey <jlindsey@luc.ac.be> writes:

> 
> In my limited knowledge of computers, a program that creates a hidden
> file without informing you and then, in subsequent runs, has its
> behaviour modified in unpredictable ways because of this is called a
> virus.

Aw c'mon, Jim! A program that changes *it's own* behavior based on a
saved wokspace? There's a company in Redmond employing thousands of
people producing millions of viruses and charging money for them to
boot, then.

Your voice in this matter is becoming increasingly shrill, and it is
becoming more and more difficult to take you seriously. Not saying
that you might not be right, but how about taking other people's
opinions into account?

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Fri Nov 28 10:56:35 1997
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 28 Nov 1997 11:56:35 +0100
Subject: R-alpha: Problems with dimnames and names
In-Reply-To: Martyn Plummer's message of Fri, 28 Nov 1997 12:05:22 +0100 (MET)
References: <XFMail.971128122615.plummer@iarc.fr>
Message-ID: <x2wwhtgucc.fsf@blueberry.kubism.ku.dk>

Martyn Plummer <plummer@iarc.fr> writes:

> 3) I have no idea what's going on here.
> 
> > c(r=1,s=2)
> s
> 2
> > c(u=100,b=4)
> b
> 4
> 
> This seems to happen only for "r" and "u". Other single-letter
> names are OK. This doesn't happen on my home PC which is still
> running R-0.50-a1.

"r" is probably matching "recursive", but what about "u"? ("unlist"??)

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From plummer@iarc.fr  Fri Nov 28 12:26:07 1997
From: plummer@iarc.fr (Martyn Plummer)
Date: Fri, 28 Nov 1997 13:26:07 +0100 (MET)
Subject: R-alpha: Problems with dimnames and names
Message-ID: <XFMail.971128133158.plummer@iarc.fr>

On 28-Nov-97 p.dalgaard@biostat.ku.dk wrote:
>Martyn Plummer <plummer@iarc.fr> writes:
>
>> 3) I have no idea what's going on here.
>> 
>> > c(r=1,s=2)
>> s
>> 2
>> > c(u=100,b=4)
>> b
>> 4
>>
>"r" is probably matching "recursive", but what about "u"? ("unlist"??)

Aha! It's matching use.names (one of the arguments of unlist())
> c(u=0,x=1,y=2)
[1] 1 2
> c(u=10,x=1,y=2)
x y
1 2

Isn't it a bit dangerous to allow partial matching of arguments
(especially undocumented arguments)? NB It doesn't consistently
match the arguments either:

> c(r=1,u=2)
u
2
> c(u=2,r=1)
r
1

Martyn
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Nov 28 14:11:30 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 28 Nov 1997 15:11:30 +0100
Subject: R-alpha: "..." arg.matching [was 'Problems with dimnames and names']
In-Reply-To: <XFMail.971128122615.plummer@iarc.fr> (message from Martyn
 Plummer on Fri, 28 Nov 1997 12:05:22 +0100 (MET))
Message-ID: <199711281411.PAA05002@sophie.ethz.ch>

>>>>> "Martyn" == Martyn Plummer <plummer@iarc.fr> writes:

    Martyn> I have rounded up three buglets in R-0.50-a4. Two of them I can
    Martyn> fix and a patch is supplied below. I hope this is useful for the
    Martyn> current source (if these haven't been fixed already :)

Both of these bugs are already fixed in 0.60

    Martyn> 1) cov
    Martyn> cov() fails when it's argument is a matrix with one column and with
    Martyn> column names defined. It tries to apply dimnames to the output but
    Martyn> the output is a vector of length 1.

    >> x <- matrix(rnorm(100),ncol=1,dimnames=list(NULL,"foo"))
    >> var(x)
    Martyn> Error: dimnames applied to non-array

    Martyn> 2) Subscripting one-dimensional arrays.
    Martyn> These are treated as vectors when subscripting
    Martyn> so subscripting by dimnames fails.

    >> x <- c(0,0,0,1,1,1,1,3)
    >> table(x)
    Martyn> 0 1 3
    Martyn> 3 4 1
    >> table(x)["3"]
    Martyn> Error: subscript out of bounds

-- Now to the ``real'' one : --

    Martyn> 3) I have no idea what's going on here.

    >> c(r=1,s=2)
    Martyn> s
    Martyn> 2
    >> c(u=100,b=4)
    Martyn> b
    Martyn> 4

    Martyn> This seems to happen only for "r" and "u". Other single-letter
    Martyn> names are OK. This doesn't happen on my home PC which is still
    Martyn> running R-0.50-a1.

Well, we (i.e., Peter and Martyn) have found *why* it happens.

However, this is a semantic change from older versions of R and from S
which I consider serious [a bug ?!?] an we should discuss.

The general accepted semantic for S is:

  <> <>  If a function has a '...' argument,                    <> <>
  <> <>  all the other argument names must be matched EXACTLY,  <> <>    (S)
  <> <>  not only up to the unique string beginning.            <> <>

This behaviour (S) definitely IS a pain sometimes,
because it forces you not abbreviate argument names for all these
functions.

For the ``function writer'', this leads to 
  1) you really should only use "..." arguments if you must.
  2) if you have "..." argument(s),
	use relatively short argument names for the other arguments
  3) if there are named arguments in "..." (which is the usual case),
	make sure 
		[if you can, which is the case mostly, but not for 'c(.)']
	that all the argument names are valid.


Unfortunately, "3)" is not followed too often in S-plus,
which leads to the ``famous'' situation, that

	glm(ni ~ x1 * x2, familiy = binomial)

will fit a normal instead of a logistic regression,
with no warning, just because of a 1 letter typo ..

	(misspelling of 'familiy' makes the whole argument be ignored,
	  and family = gaussian , the default, be taken).

--------

So, we now see why Ross(?) may have wanted
to change the  argument matching behavior in the "..." case.
[[Rule: If  S  does things wierdly, R should do better ...]]

I still think however that this must be carefully tought over,
and I am not yet convinced if we shouldn't follow the S way after all.
Where we could do better (in our `own' functions) is to folllow my rule 
"3)" above as strictly as possible.


Martin Maechler <maechler@stat.math.ethz.ch>		 <><
Seminar fuer Statistik, SOL G1
ETH (Federal Inst. Technology)	8092 Zurich	 SWITZERLAND
phone: x-41-1-632-3408		fax: ...-1086
http://www.stat.math.ethz.ch/~maechler/

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ihaka@stat.auckland.ac.nz  Fri Nov 28 19:35:06 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Sat, 29 Nov 1997 08:35:06 +1300 (NZDT)
Subject: R-alpha: "..." arg.matching [was 'Problems with dimnames and names']
Message-ID: <199711281935.IAA13179@stat1.stat.auckland.ac.nz>

> -- Now to the ``real'' one : --
>
>     Martyn> 3) I have no idea what's going on here.
>
>     >> c(r=1,s=2)
>     Martyn> s
>     Martyn> 2
>     >> c(u=100,b=4)
>     Martyn> b
>     Martyn> 4
>
>     Martyn> This seems to happen only for "r" and "u". Other single-letter
>     Martyn> names are OK. This doesn't happen on my home PC which is still
>     Martyn> running R-0.50-a1.
>
> Well, we (i.e., Peter and Martyn) have found *why* it happens.
>
> However, this is a semantic change from older versions of R and from S
> which I consider serious [a bug ?!?] an we should discuss.

This wasn't a deliberate change, just my usual incompetence.
I think it crept in when we changed c() to be a generic function
(which does method dispatch internally).

The problem is in the function "ExtractOptionals" in bind.c.  There the
matching of arguments is done in two places with pmatch using a third
argument which is 0.  This indicates partial matching and should be
changed so that the third argument is 1 indicating exact matching.

	Ross
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From bates@stat.wisc.edu  Fri Nov 28 22:20:22 1997
From: bates@stat.wisc.edu (Douglas Bates)
Date: 28 Nov 1997 16:20:22 -0600
Subject: R-alpha: documentation for nlm
Message-ID: <6r4t4wek49.fsf@franz.stat.wisc.edu>

The documentation for nlm lists an argument named iterlim but the name
of the argument in the function itself is itnlim (a legacy of the
Fortran code, no doubt).
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Mon Nov  3 17:54:13 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Mon, 3 Nov 1997 18:54:13 +0100
Subject: R-alpha: expression(..) objects -- c(ex1, ex2) `fails'
Message-ID: <199711031754.SAA01954@sophie.ethz.ch>

When investigating  the  
	legend(x,y, expression ( <math>, <math> ), ....)
			 [as suggested by Jim Lindsey],
I once again stumbled over the fact that expression objects behave somewhat
``wierdly'', IMHO.

We can have expressions of length(.) > 1, and access elements of these like
list elements.
However, other natural things don't work with expressions; some example code:


##-- `Simple'  length--1  expressions:
ex1 <- expression(hat(beta) == (X^t * X)^{-1} * X^t * y)
ex2 <- expression(bar(x) == sum(over(x[i], n), i==1, n))
ex3 <- expression(paste(over(1, sigma*sqrt(2*pi)), " ",
    plain(e)^{over(-(x-mu)^2, 2*sigma^2)}))

##-- A length--2 expression:
ex12 <- expression(bar(x) == sum(over(x[i], n), i==1, n),
    		   hat(x) == median(x[i], i==1,n))
mode(ex12) # expression
length(ex12)# 2

mode(ex12 [1]) # expression
mode(ex12[[1]]) # call 
length(ex12[1])# 1
ex12 == ex12[1:2] #> TRUE TRUE


mode(c(ex1,ex2))#> "list" --->> This should be "expression" I think ...
##				---------------------------
mode(ex.12 <- as.expression(c(ex1,ex2))) # "expression"
## but the wrong one:
length(ex.12)# [1] 1
ex.12 #-- still has 'list(..)' in it...

###-> How could I take ex1, ex2 and "concat" them to an expression
###  of length 2 ?





=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From p.dalgaard@kubism.ku.dk  Mon Nov  3 18:27:53 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 03 Nov 1997 19:27:53 +0100
Subject: R-alpha: expression(..) objects -- c(ex1, ex2) `fails'
In-Reply-To: Martin Maechler's message of Mon, 3 Nov 1997 18:54:13 +0100
References: <199711031754.SAA01954@sophie.ethz.ch>
Message-ID: <x2iuu9hlxy.fsf@blueberry.kubism.ku.dk>

Martin Maechler <maechler@stat.math.ethz.ch> writes:
[I've taken out the ">" citation symbols to allow cut and paste]

##-- `Simple'  length--1  expressions:
ex1 <- expression(hat(beta) == (X^t * X)^{-1} * X^t * y)
ex2 <- expression(bar(x) == sum(over(x[i], n), i==1, n))

##-- A length--2 expression:
ex12 <- expression(bar(x) == sum(over(x[i], n), i==1, n),
  hat(x) == median(x[i], i==1,n))

##please avoid TABS, Martin. It confuses readline...

> ###-> How could I take ex1, ex2 and "concat" them to an expression
> ###  of length 2 ?

#Heh. One would at least expect
l<-NULL
l[[1]]<-ex1[[1]]
l[[2]]<-ex2[[1]]
#to be a list of calls, which by definition is what an expression is,
#so you'd only need to change the mode, but:

 
mode(e)<-"expression" 
e
# expression(list(hat(beta) == (X^t * X)^{
#         -1
# } * X^t * y, bar(x) == sum(over(x[i], n), i == 1, n)))

#(Why does it deparse in that strange way, BTW?)

#Also, textual representations of length-2 expressions is acting up:
deparse(ex12)
#[1] "bar(x) == sum(over(x[i], n), i == 1, n)"
str(ex12)
# bar(x) == sum(over(x[i], n), i == 1, n)
dput(ex12)
# bar(x) == sum(over(x[i], n), i == 1, n)
deparse(ex12[[2]])
# [1] "hat(x) == median(x[i], i == 1, n)"

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Nov  4 10:52:42 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 4 Nov 1997 11:52:42 +0100
Subject: R-alpha: Re: Separation of Program & Doc;  REQUIRING Perl5 [was: New Version]
In-Reply-To: <199711030736.IAA00272@pc25.none> (message from Kurt Hornik on
 Mon, 3 Nov 1997 08:36:39 +0100)
Message-ID: <199711041052.LAA02657@sophie.ethz.ch>

[[Again I diverge to R-devel, I think we need more opinions here...]]

>>>>> "KH" == Kurt Hornik <hornik@ci.tuwien.ac.at> writes:

>>>>> Ross Ihaka writes:
    >> I am beginning to get a bit more free time and I would like to get a
    >> "stable" version out as soon as possible.  (This is of course so I can
    >> break absolutely everything without feeling too much pressure to get
    >> things working again quickly :-).

    >> Using perl has produced some build problems because version 5 is not
    >> a universal standard.  There is even no guarantee that any kind of
    >> perl would be available.

    >> It would be nice if the installation could happen without perl.  I
    >> think this is possible if we separate the building of help files from
    >> the compilation/installation of binaries.  Preconfigured help files
    >> could then be distributed separately for anyone who lacks (the correct
    >> version of) perl, or at the cost of a little bloat, be part of the
    >> distribution.
I agree [see below]

    >> Alternatively we could just say "YOU MUST HAVE PERL VERSION 5" and
    >> enforce this with configuration checks.  This is rather user-hostile,
    >> but it does make things simple for us.

    >> Watcha think?

    KH> Well, better late than never (I was on a business trip for the past few
    KH> days), let me say that I am very unhappy about splitting INSTALL into a
    KH> doc and a non-doc part.  Let me explain why.

    KH> From a pedagogical point of view, it creates the impression that one can
    KH> actually `install' a package without the documentation.  This is not
    KH> true, because the documentation is an integral part of the package.  We
    KH> need to force packages writers/maintainers into providing accurate and
    KH> comprehensive documentation, and we need users to use it ...

Yes, [of course] I very much agree.  You may (not) know that I got involved
in R hacking first with the aim of improving documentation considerably
and pushing the idea that we need interesting / relevant examples as 
a very important part of docu.

    KH> From the R Core group's perspective, (I think) it does not solve the
    KH> problem.  The problem is that although we would all be very happy to
    KH> have Perl, and in fact version 5, available on all systems (and NOTE
    KH> that we chose Perl because unlike the shell it is also available on
    KH> non-Unix platforms, dubious as these may be), this does not seem to be
    KH> that case.  We now have Perl show up in both the documentation setup
    KH> process as well as in at least one user-level function, with perhaps
    KH> more to come.

hmm, I think that I said before that I don't like this (R function calling
perl) so much. 
It is nice that for non-Unix platforms, Perl is more available than a shell
(with sed, awk, ....).
However, Perl is not (yet ?) part of standard Unix [unfortunately].
Using perl from R functions  URGES users to have perl available.
This would prohibit the use of R for MANY who don't have a good access to
their system administrators [[which is not so rare, even at Universities..]].

The ``idea'' I got (which seems to be close to Ross' one) was:

A. For a Unix user, if she has perl available, she only needs the 
   base tar file, does ./configure  and
   make (good idea to INCLUDE 'make help' by default !) --> and has all

B. Unix users without Perl, or  Windows / Mac  users:
   
   Besides the base tar/zip file, 
   they need to get the precompiled online help --- as distributed by CRAN,
   in addition, and then can use (but not enhance conveniently) the help.

 We could well setup things such that these users are really REQUIRED to
 get the precompiled help  (following the above point that the doc is
			    integral part of the software).

    KH> Ross, as far as I understand your intentions, you want both `make
    KH> install' and `R INSTALL pkg lib' to work even if Perl 5 is not there.
    KH> The current solution (having install and INSTALL only operate things
    KH> which do not depend on the availability of Perl 5) is a fix, but of
    KH> course users could still do `make install-docs' and `R INSTALL-DOC' on
    KH> the `unfortunate' platforms.  What would happen then?  Well, I think
    KH> they should get a clean (and maybe not error-type) message saying sorry,
    KH> you asked for something which requires Perl 5, which does not seem to be
    KH> available on your system.  Now, the best possible way for this to be
    KH> accomplished would be via the configure script, which could not only
    KH> check for where Perl is, but also whether it is version 5 or not, and
    KH> record this information where needed.  (Maybe even in the R shell
    KH> script.)  E.g., if Perl 5 was found, we'd have

    KH> PERL5=y

    KH> in etc/INSTALL, and then code like

    KH> if [ "$PERL5" != "y" ];
    KH> then
    KH> echo "Sorry, you need ..."
    KH> exit 1
    KH> else
    KH> PROCEED.AS.USUAL()
    KH> fi

    KH> Functions based on Perl scripts could be treated in a unified manner via
    KH> a function perl().  Calling

    KH> perl(script, arg1, arg2, ...)

    KH> would under Unix be the same as

    KH> system(paste("perl", arg1, arg2, ..., collapse = TRUE))

    KH> but be set up in a way that a graceful error message is returned if Perl
    KH> was not available at compilation time.  In fact, we could even give
    KH> perl() a named version argument, or use perl() and perl5()?

    KH> (As an aside, my above reasoning also reflects my attitude that `make
    KH> install' should automatically install the documentation as well.)

Once more, I almost agree on that.

I think  `make' should install the program and doc
	(== current `make install docs')
 If perl is not available, installers should get your message above,
 PLUS the hint that 
	1) they must get the pre-compiled help from CRAN 
		and AFTER installing it,
	2) `make'  (or maybe, even `make install-program')
 will install the software alone [[docs being in place, unpacked from
				  precompiled CRAN help]].

    KH> Enough said.  Opinions?
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From pgilbert@bank-banque-canada.ca  Tue Nov  4 14:25:17 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Tue, 4 Nov 1997 09:25:17 -0500
Subject: R-alpha: Re: Separation of Program & Doc;  REQUIRING Perl5 [was: New Version]
References: <199711041052.LAA02657@sophie.ethz.ch>
Message-ID: <97Nov4.093029est.26503@mailgate.bank-banque-canada.ca>

>B. Unix users without Perl, or  Windows / Mac  users:
 >  Besides the base tar/zip file,
 >  they need to get the precompiled online help --- as distributed by
CRAN,
 >  in addition, and then can use (but not enhance conveniently) the
help.

This does not seem unreasonable for Windows/Mac users since, if I
understand the situation correctly, they will also need a pre-compiled
version of some C and Fortran. For Unix users without Perl5 the
situation is not so obvious. (It might be easier to distribute Perl5
than precompiled versions of all possible Unix versions.)

Also, for users always connected to the Internet, it is not really clear
that they always need and should be forced to have the help on their own
machine. Effectively it is, or can be made, available on line. There are
advantages to this: the help can be updated and corrected on the fly.
(Assuming, of course, that it is not perfect to begin with.)

Paul Gilbert


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From pgilbert@bank-banque-canada.ca  Tue Nov  4 14:31:59 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Tue, 4 Nov 1997 09:31:59 -0500
Subject: R-alpha: l2c libraries
Message-ID: <97Nov4.093841est.26501@mailgate.bank-banque-canada.ca>

How is the problem of l2c libraries being resolved in 0.60? I continue
to have problems with  ld.so.1: /.../R.binary: fatal: relocation error:
symbol not found: pow_ii: referenced in /.../dsefor.so where dsefor.so
is my compiled fortran.

Paul Gilbert

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Nov  4 14:47:54 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 4 Nov 1997 15:47:54 +0100
Subject: R-alpha: Re: Separation of Program & Doc;  REQUIRING Perl5 [was: New Version]
In-Reply-To: <97Nov4.093029est.26503@mailgate.bank-banque-canada.ca> (message
 from Paul Gilbert on Tue, 4 Nov 1997 09:25:17 -0500)
Message-ID: <199711041447.PAA02817@sophie.ethz.ch>

>>>>> "PaulG" == Paul Gilbert <pgilbert@bank-banque-canada.ca> writes:

    >> B. Unix users without Perl, or  Windows / Mac  users:
    >> Besides the base tar/zip file,
    >> they need to get the precompiled online help --- as distributed by
    PaulG> CRAN,
    >> in addition, and then can use (but not enhance conveniently) the
    PaulG> help.

    PaulG> This does not seem unreasonable for Windows/Mac users since, if
    PaulG> I understand the situation correctly, they will also need a
    PaulG> pre-compiled version of some C and Fortran. For Unix users
    PaulG> without Perl5 the situation is not so obvious. (It might be
    PaulG> easier to distribute Perl5 than precompiled versions of all
    PaulG> possible Unix versions.)


    PaulG> Also, for users always connected to the Internet, it is not really clear
    PaulG> that they always need and should be forced to have the help on their own
    PaulG> machine. Effectively it is, or can be made, available on line. There are
    PaulG> advantages to this: the help can be updated and corrected on the fly.
    PaulG> (Assuming, of course, that it is not perfect to begin with.)

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From bates@stat.wisc.edu  Tue Nov  4 14:53:53 1997
From: bates@stat.wisc.edu (Douglas Bates)
Date: 04 Nov 1997 08:53:53 -0600
Subject: R-alpha: Re: Separation of Program & Doc;  REQUIRING Perl5 [was: New Version]
In-Reply-To: Martin Maechler's message of Tue, 4 Nov 1997 11:52:42 +0100
References: <199711041052.LAA02657@sophie.ethz.ch>
Message-ID: <6ren4wg16m.fsf@franz.stat.wisc.edu>

Regarding Perl5 availability:
 - In the Unix world I would be surprised if people who would want to
   install R would not also have access to perl5 or be able to install
   it.  I would assert that the level of skill required to install R
   is comparable to that required to install perl.
 - For Mac or Windows are you expecting that most users would install
   from the .tar.gz file?  I would have thought that there would be
   one compilation done to create a .zip file for Windows and a .hqx
   file for the Mac.  The typical user would only need to install
   these "tar-ball" files and never need to see the part that depended 
   on perl.  If someone decides to write an R function that calls perl 
   then it will croak but the same would happen for shell scripts, awk 
   scripts, ...
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Nov  4 14:58:32 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 4 Nov 1997 15:58:32 +0100
Subject: R-alpha: Re: Separation of Program & Doc ...
In-Reply-To: <97Nov4.093029est.26503@mailgate.bank-banque-canada.ca> (message
 from Paul Gilbert on Tue, 4 Nov 1997 09:25:17 -0500)
Message-ID: <199711041458.PAA02846@sophie.ethz.ch>

>>>>> "PaulG" == Paul Gilbert <pgilbert@bank-banque-canada.ca> writes:

    >> B. Unix users without Perl, or  Windows / Mac  users:
    >> Besides the base tar/zip file,
    >> they need to get the precompiled online help --- as distributed by
    PaulG> CRAN,
    >> in addition, and then can use (but not enhance conveniently) the
    PaulG> help.

    PaulG> This does not seem unreasonable for Windows/Mac users since, if
    PaulG> I understand the situation correctly, they will also need a
    PaulG> pre-compiled version of some C and Fortran. For Unix users
    PaulG> without Perl5 the situation is not so obvious. (It might be
    PaulG> easier to distribute Perl5 than precompiled versions of all
    PaulG> possible Unix versions.)
You misunderstood: `Precompiled help' means
	 "R documentation" (a la src/library/base/man/*) in
		1) help [nroff]
		2) html
		3) latex -> PostScript
	 format.
All of these are ASCII formats.
Therefore, there is no difference in `precompiled help' between 
any operating systems (well as much as ASCII formats are the same;
			knowing that DOS has extra carriage returns ....)

    PaulG> Also, for users always connected to the Internet, it is not
    PaulG> really clear that they always need and should be forced to have
    PaulG> the help on their own machine. Effectively it is, or can be
    PaulG> made, available on line. There are advantages to this: the help
    PaulG> can be updated and corrected on the fly.  (Assuming, of course,
    PaulG> that it is not perfect to begin with.)

This maybe practical in a future internet (or in today's net within
North-America?) where bandwidth of small files 
like these is practially zero.   Today, even getting only a thousand bytes can
take many seconds, which is too long.

-- Martin Maechler <maechler@stat.math.ethz.ch>		 <><
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From Kurt.Hornik@ci.tuwien.ac.at  Tue Nov  4 15:37:33 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 4 Nov 1997 16:37:33 +0100
Subject: R-alpha: Re: Separation of Program & Doc;  REQUIRING Perl5 [was: New Version]
In-Reply-To: <6ren4wg16m.fsf@franz.stat.wisc.edu>
References: <199711041052.LAA02657@sophie.ethz.ch>
 <6ren4wg16m.fsf@franz.stat.wisc.edu>
Message-ID: <199711041537.QAA07525@pc25.none>

>>>>> Douglas Bates writes:

> Regarding Perl5 availability:
>  - In the Unix world I would be surprised if people who would want to
>    install R would not also have access to perl5 or be able to install
>    it.  I would assert that the level of skill required to install R
>    is comparable to that required to install perl.

:-)

Btw, does CPAN have binary distributions as well?

>  - For Mac or Windows are you expecting that most users would install
>    from the .tar.gz file?  I would have thought that there would be
>    one compilation done to create a .zip file for Windows and a .hqx
>    file for the Mac.  The typical user would only need to install
>    these "tar-ball" files and never need to see the part that depended 
>    on perl.  If someone decides to write an R function that calls perl 
>    then it will croak but the same would happen for shell scripts, awk 
>    scripts, ...

I am confused now.  I thought the advantage of Perl is that it is
available on non-Unix platforms as well ...?

(Of course, that does not solve the `packaging' problem ...)

-k

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From bates@stat.wisc.edu  Tue Nov  4 15:44:50 1997
From: bates@stat.wisc.edu (Douglas Bates)
Date: 04 Nov 1997 09:44:50 -0600
Subject: R-alpha: Re: Separation of Program & Doc;  REQUIRING Perl5 [was: New Version]
In-Reply-To: Kurt Hornik's message of Tue, 4 Nov 1997 16:37:33 +0100
References: <199711041052.LAA02657@sophie.ethz.ch> 	<6ren4wg16m.fsf@franz.stat.wisc.edu> <199711041537.QAA07525@pc25.none>
Message-ID: <6rd8kgfytp.fsf@franz.stat.wisc.edu>

Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

> I am confused now.  I thought the advantage of Perl is that it is
> available on non-Unix platforms as well ...?

I know there is a perl for Windows NT.  I don't know about the
Macintosh or Windows 95.

I think it would be a good idea to use perl in the installation on all
platforms.  What I was trying to say is that I imagine the "typical"
Windows or Macintosh user would not be doing the installation from
scratch but instead would be using the tar-ball format appropriate for
their system.  The only people who need to have perl for Windows or
perl for the Macintosh are those who will create the tar-balls.
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From pgilbert@bank-banque-canada.ca  Tue Nov  4 16:49:56 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Tue, 4 Nov 1997 11:49:56 -0500
Subject: R-alpha: Re: Separation of Program & Doc ...
Message-ID: <97Nov4.115513est.26513@mailgate.bank-banque-canada.ca>

>    PaulG> Also, for users always connected to the Internet, it is not
>    PaulG> really clear that they always need and should be forced to
have
 >   PaulG> the help ...
>This maybe practical in a future internet (or in today's net within
>North-America?) where bandwidth of small files
>like these is practially zero.   Today, even getting only a thousand
bytes can
>take many seconds, which is too long.

I am familiar with the low bandwidth problem and I appreciate that lots
of people will want to install help files locally. For many people in
North America the bandwidth is not so low anymore, and I am simply
pointing out that the logic of forcing everyone to install help locally
assumes a set of circumstances which may not exist for everyone.
(Although, for convenience I can certainly appreciate that doing things
one way may be a lot simpler.)

On a related, but slightly longer term issue, it is worth at least
thinking about the possibility that some code libraries could be loaded
on the fly over a high speed Internet. This is a small bandwidth
requirement compared to video, which seems to be coming more quickly
than most people thought. The advantage of this is that development can
be done more easily, continuously and quickly.  As long as the installed
base portion remains stable, newer libraries could be put in place
simply by pointing at them over the network rather than doing an
"install" in the fashion with which we are familiar.

All this is simply to point out that install strategies should probably
be considered to be for the short term rather than the long term.

Paul

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From luke@stat.umn.edu  Tue Nov  4 18:03:40 1997
From: luke@stat.umn.edu (Luke Tierney)
Date: Tue, 4 Nov 1997 12:03:40 -0600 (CST)
Subject: R-alpha: Re: Separation of Program & Doc;  REQUIRING Perl5 [was: New Version]
In-Reply-To: <199711041537.QAA07525@pc25.none> from "Kurt Hornik" at Nov 4, 97 04:37:33 pm
Message-ID: <9711041803.AA08655@nokomis.stat.umn.edu>

Kurt Hornik wrote:
> 
> >>>>> Douglas Bates writes:
> 
> > Regarding Perl5 availability:
> >  - In the Unix world I would be surprised if people who would want to
> >    install R would not also have access to perl5 or be able to install
> >    it.  I would assert that the level of skill required to install R
> >    is comparable to that required to install perl.
> 
> :-)
> 
> Btw, does CPAN have binary distributions as well?

One of the arguments someone made, as I recall, is access. Perl ought
to be installed as a system resource and the person installing R may
not have access at that level. Of course they could install a private
Perl but this is likely to create some headaches someplace down the
road.

luke

-- 
Luke Tierney
University of Minnesota                      Phone:           612-625-7843
School of Statistics                         Fax:             612-624-8868
206 Church Street                            email:      luke@stat.umn.edu
Minneapolis, MN 55455 USA                    WWW:  http://www.stat.umn.edu
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From pgilbert@bank-banque-canada.ca  Tue Nov  4 20:27:08 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Tue, 4 Nov 1997 15:27:08 -0500
Subject: R-alpha: compatibility functions
Message-ID: <97Nov4.153225est.26507@mailgate.bank-banque-canada.ca>

Below is a revised copy of my compatibility functions with additions
from Martin. I expect I may need a new version  when 0.6 arrives but I
thought it would be worth circulating this in case it suggests anything
which might be resolved before the release of 0.6 rather than after.

Thanks to a few people for pointing out the R function machine(). I have
a kludge below for determining the same information in S. If anyone has
a better way to do this I would appreciate it.

There are also several functions where the non-unix versions have not
been defined. Suggestions would be appreciated.

Paul Gilbert

##############################################################################



# This file has code which contains operating system and S/R specific
#   functions. They are intended to be used as a kernel to help
#   protect other code from these problems.

# The following functions are attempted:
#   For S/R differences:
#      global.assign, system.info, exists.graphics.device, unlink,
#      synchronize,  list.add for [["new.element"]]<-
#   For OS differences:
#     system.call, sleep, present.working.directory, whoami, file.copy,
#     file.date.info, date, mail, unlink, local.host.netname,

# Also a number of is.xxx functions are defined to identify systems.

# The variable  .SPAWN is also set to be used to identify if Splus "For"
loops
#    should be used. (It is sometimes better not to use these even in
Splus.)

##############################################################################

#            General Logic and organization of these functions

# 1/ The first group of functions are for identifying S or R and
flavours.
# 2/ The second group of functions are for identifying the operating
system.
# 3/ The third group specify a few functions which depend only on the
#         differences between S and R.
# 4/ The fourth group specify functions which depend only on the
#         differences among operating system.
# 5/ The fifth group specify a few functions which depend on both R/S
and the
#         differences among operating system.

#  >>> I would very much like any input WRT  MS Windows / Win95 / NT /
Mac <<<

# The function system.call is defined in order to provide a generic way
to
#  make a call to the operating system. However, when the calls are
specific
#  to Unix then the function unix() is used.


##############################################################################

system.info <- function()
     {if( !exists("version"))
         { #-- `Vanilla' S (i.e. here "S version 4")
           #- this now works for  S version 4  (this is not S-plus 4.0,
maybe
           #             part of S-plus 5.0 !):
           lv <- nchar(Sv <- Sversion())
           r <- list(
       major = substring(Sv, 1,1),
       minor = substring(Sv, lv,lv))
         }
   else
     {r <- version
      r$minor <- as.numeric(r$minor)
      r$major <- as.numeric(r$major)
     }
   if      (is.Splus())    r$language <- "Splus"
   else if (is.Svanilla()) r$language <- "S"
   r$OSversion <- OSversion()
   r$OStype <- machine()
   r
  }


###########################################################

#    1/  Functions are for identifying S or R and flavours.

###########################################################

#Note It is tempting to use system.info as defined above, but there is a

#        bootstrapping problem to solve.

is.R <- function()
 {exists("version") && !is.null(vl <- version$language) && vl == "R" }

is.R.pre0.60 <- function()
  {is.R() && ((as.numeric(version$major)+.01*as.numeric(version$major))
<0.60) }


is.S <- function(){is.Svanilla() | is.Splus() }
is.Svanilla <- function(){!exists("version")}
is.Splus <- function(){exists("version") && is.null(version$language)}
is.Splus.pre3.3 <- function()
   { ## <= 3.2
    is.Splus() &&  ((system.info()$major+.1*system.info()$minor) < 3.3)
   }

###########################################################

#    2/  Functions are for identifying the operating system.

###########################################################

# if (is.R()) {machine <- machine}

if (is.S())
   {machine <- function()
      {if (version$os == "MS Windows") return(version$os)
       if (version$os == "Macintosh") return(version$os) # needs to be
checked
       else return ("Unix")  # not a very satisfactory test
      }
   }


is.MSwindows <- function(){machine() == "MS Windows"}
is.Mac       <- function(){machine() == "Macintosh" }
is.unix      <- function(){machine() == "Unix" }

# Other is.xxx() should be added here.

# determining Unix flavours doesn't seem to be too important but ...
is.Sun4 <- function() {OSversion() == "SunOS4" }
is.Sun5 <- function() {OSversion() == "SunOS5" }
is.Linux <- function(){OSversion() == "linux"}

OSversion <- function()
   {paste(unix("uname -s"), unix("uname -r | sed -e 's/\\.\.\*//'"),
sep="") }



###########################################################

#    3/  Functions depending only on the
#         differences between S and R

###########################################################

if(is.S())
   {if(is.unix())system.call  <- unix
    global.assign <- function(name, value) {assign(name,value, where =
1)}
    .SPAWN <- TRUE
    exists.graphics.device <- function(){dev.cur() !=1 }
    open.graphics.device  <- function(display=getenv("DISPLAY"))
                                 {openlook(display) }
    #                            {motif(display) }
    close.graphics.device <- function(){dev.off() }
    if (!exists("set.seed.Splus")) set.seed.Splus <- set.seed
    set.seed <- function(seed=NULL)
      {if (is.null(seed))
          seed <-.Random.seed
       else
         {if (1==length(seed)) set.seed.Splus(seed)
          else global.assign(".Random.seed", seed)
         }
       seed
      }

    "list.add<-" <- function(x, replace, value)
       {# replace or add elements to a list.
        x[replace] <- value
        # x[[replace]] <- value  would be more logical but doesn't work
        x
       }
   }

if(is.R())
   {#tempfile <- function(f)
    #   {# Requires C code also from Friedrich Leisch not in version
0.15 of R.
    #    d<-"This is simply a string long enough to hold the name of a
tmpfile";
    #     .C("tmpf", as.character(d))[[1]]
    #    }

    if (is.R.pre0.60())
        {tempfile <- function(pattern = "file")
                {system(paste("for p in", paste(pattern, collapse = "
"), ";",
                       "do echo /tmp/$p$$; done"),
                 intern = TRUE)
                }
        }

    unlink <- function(file) system.call(paste("rm -fr ", file))
    global.assign <- function(name, value)
                          {assign(name,value, envir=.GlobalEnv)}
    synchronize<- function(x){NULL} # perhaps this should do something?
    .SPAWN <- FALSE
    exists.graphics.device <- function(){exists(".Device")}
    open.graphics.device  <- function(display=getenv("DISPLAY"))
                                {x11(display) }
    close.graphics.device <- function(){F} # how do I do this?
    set.seed <- function(seed=NULL)
      {if (is.null(seed))
         {if (!exists(".Random.seed")) zzz <- runif(1) # seed may not
yet exist
          seed <-.Random.seed
         }
       else
         {if (1==length(seed))

global.assign(".Random.seed",round(runif(3,min=seed,max=1e5*seed)))
          else global.assign(".Random.seed", seed)
         }
       seed
      }

   "list.add<-" <- function(x, replace, value)
     {# replace or add elements to a list.
      if (is.numeric(replace))
        {# x<- do.call("default.[[<-", list(x,replace,value))   # use
default
         x[[replace]] <- value
         return(x)
        }
      if (is.null(value))  value <- list(NULL)
      if (!is.list(value)) value <- list(value)
      if (1 == length(value))
       {for (i in seq(length(replace)))
          x<- do.call("$<-", list(x,replace[i],value[[1]]))
       }
      else
        {if(length(value) != length(replace) )
         stop("number of replacement values != number of elements to
replace")
         for (i in seq(length(replace)))
            x<- do.call("$<-", list(x,replace[i],value[[i]]))
        }
      x
     }
 }


###########################################################

#    4/  Functions depending only on the
#         differences among operating system.

###########################################################

if(is.unix())
  {sleep <- function(n) {unix(paste("sleep ", n))} # pause for n seconds

   present.working.directory <- function(){unix("pwd")} # present
directory
   whoami <- function(){unix("whoami")} # return user id (for mail)
   local.host.netname <-function() {unix("uname -n")}

   mail <- function(to, subject="", text="")
    {# If to is null then mail is not sent (useful for testing).
     file <- tempfile()
     write(text, file=file)
   if(!is.null(to)) unix(paste("cat ",file, " | mail  -s '", subject, "'
", to))
     unlink(file)
     invisible()
    }

   file.copy <- function(from, to)unix(paste("cp ", from, to)) # copy
file

   file.date.info <- function(file.name)
     {# This could be a lot better. It will fail for files older than a
year.
      # Also, a returned format like date() below would be better.
      mo <- (1:12)[c("Jan","Feb","Mar","Apr","May", "Jun","Jul","Aug",
"Sep",
         "Oct","Nov","Dec") ==substring(unix(paste("ls -l
",file)),33,35)]
      day <- as.integer(substring(unix(paste("ls -l
",file.name)),37,38))
      hr  <- as.integer(substring(unix(paste("ls -l
",file.name)),40,41))
      sec <- as.integer(substring(unix(paste("ls -l
",file.name)),43,44))
      c(mo,day,hr,sec)
     }

}

if(is.MSwindows())
  {system.call  <- function(cmd)
         {stop("system calls must be modified for this operating
system.")}
   sleep <- system.call
   present.working.directory <- system.call
   whoami <- system.call
   file.copy <- system.call
   file.date.info <- system.call
  }



###########################################################

#    5/  Functions depending on both R/S and the
#         differences among operating system.

###########################################################

if(is.unix())
  {if(is.R())
     {unix <- function(cmd) system(cmd, intern=T)
      system.call <- function(cmd) system(cmd, intern=T)

      date <-function()
        {d<-parse(text=strsplit(
              unix("date \'+%Y %m %d %H %M %S\'")," ")[[1]])
         list(y=  eval(d[1]),
              m=eval(d[2]),
              d= eval(d[3]),
              h= eval(d[4]),
              m= eval(d[5]),
              s= eval(d[6]),
              tz=unix("date '+%Z'"))
        }
     }
   if(is.S())
     {system.call <- function(cmd) unix(cmd)

      date <-function()
        {d <- parse(text=unix("date '+%Y %m %d %H %M %S'"),white=T)
         list(y=  eval(d[1]),
              m=eval(d[2]),
              d= eval(d[3]),
              h= eval(d[4]),
              m= eval(d[5]),
              s= eval(d[6]),
              tz=unix("date '+%Z'"))
        }
     }
  }




##############################################################################




=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From Martin Maechler <maechler@stat.math.ethz.ch>  Thu Nov  6 08:12:47 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Thu, 6 Nov 1997 09:12:47 +0100
Subject: R-alpha: "invisible" (yet again): a more problematic bug[let]
Message-ID: <199711060812.JAA04845@sophie.ethz.ch>

I think this is a more problematic buglet
in (implicit/explicit)  ``invisible behavior'').

Try this  (all versions of R from  0.49 to 0.60):


test0 <- function() c(1,2)
test  <- function(two = FALSE)        c(1, if(two) 2)
testR <- function(two = FALSE) return(c(1, if(two) 2))

test0()# 1 2 as it should
test() # <<<<<<<<<<<<<<<<<<<<<< INVISIBLE! @#$@!
test(T)# 1 2
print(test())
print(test(T))

testR() # ok; NOT invisible...
testR(T)# 1 2

---------------------------
Even though it is not really harmful once you know about it,
it can be pretty wierd when you try and test functions...

-- Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From plummer@iarc.fr  Thu Nov  6 09:28:08 1997
From: plummer@iarc.fr (Martyn Plummer)
Date: Thu, 06 Nov 1997 10:28:08 +0100
Subject: R-alpha: "invisible" (yet again): a more problematic bug[let]
References: <md5:4C26491E69F1EF6D2FB938607D06BE19>
Message-ID: <34618DA8.23AA175C@iarc.fr>

maechler@stat.math.ethz.ch wrote:
> 
> Try this  (all versions of R from  0.49 to 0.60):
> 
> test0 <- function() c(1,2)
> test  <- function(two = FALSE)        c(1, if(two) 2)
> testR <- function(two = FALSE) return(c(1, if(two) 2))
> 
> test0()# 1 2 as it should
> test() # <<<<<<<<<<<<<<<<<<<<<< INVISIBLE! @#$@!
> test(T)# 1 2
> print(test())
> print(test(T))
> 
> testR() # ok; NOT invisible...
> testR(T)# 1 2

The problem seems to be in do_if (eval.c) where the R_Visible flag
is set to 0. Set it to 1 instead and your functions will work
properly. You also get

R>if(F) 2
NULL

instead of 
R>if(F) 2
R>

which is consistent with S-PLUS.

Martyn
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From Martin Maechler <maechler@stat.math.ethz.ch>  Thu Nov  6 10:55:17 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Thu, 6 Nov 1997 11:55:17 +0100
Subject: R-alpha: "invisible" : R_INVISIBLE .. -- repeat{} gives BOMB
In-Reply-To: <34618DA8.23AA175C@iarc.fr> (message from Martyn Plummer on Thu,
 06 Nov 1997 10:28:08 +0100)
Message-ID: <199711061055.LAA05033@sophie.ethz.ch>

>>>>> "Martyn" == Martyn Plummer <plummer@iarc.fr> writes:

    Martyn> maechler@stat.math.ethz.ch wrote:
    >>  Try this (all versions of R from 0.49 to 0.60):
    >> 
    >> test0 <- function() c(1,2) test <- function(two = FALSE) c(1,
    >> if(two) 2) testR <- function(two = FALSE) return(c(1, if(two) 2))
    >> 
    >> test0()# 1 2 as it should test() # <<<<<<<<<<<<<<<<<<<<<< INVISIBLE!
    >> @#$@!  test(T)# 1 2 print(test()) print(test(T))
    >> 
    >> testR() # ok; NOT invisible...  testR(T)# 1 2

    Martyn> The problem seems to be in do_if (eval.c) where the R_Visible
    Martyn> flag is set to 0. Set it to 1 instead and your functions will
    Martyn> work properly. You also get

    R> if(F) 2
    Martyn> NULL

    Martyn> instead of
    R> if(F) 2
    R> 

    Martyn> which is consistent with S-PLUS.

Wow, this was quick and precise,  thank you !!

I investigated some more:  
	R_VISIBLE is set to 0  ``R_Visible = 0;''
	 also in other places in eval.c :

 line	C function
		
  344:	  do_if
  436:	  do_for
  480:	  do_while
  515:	  do_repeat
  720:    \
  727:     > do_set
  738:    /
  ^^^
(line numbers from current 0.60)

In my opinion, only the three cases in do_set ("<-" things) should have
the invisibility flag...

	
testwh <- function(n = 1) c(1, while(n > 1) {n <- n-1; n})
testwh() # invisible !
testwh(2)
print(testwh()) # 1
print(testwh(2))# 1 1
##-- in Splus, both are visible

###-------- THIS IS EVEN WORSE:   Segmentation violation !!! -----

testrep <- function(n = 1) c(1, repeat {n <- n-1; if(n<=0) break})
testrep()
##R : Process R:1 segmentation violation at Thu Nov  6 11:36:27 1997


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From plummer@iarc.fr  Fri Nov  7 14:21:26 1997
From: plummer@iarc.fr (Martyn Plummer)
Date: Fri, 07 Nov 1997 15:21:26 +0100 (MET)
Subject: R-alpha: "invisible" : R_INVISIBLE .. -- repeat{} gives BOMB
Message-ID: <XFMail.971107153147.plummer@iarc.fr>

On 06-Nov-97 maechler@stat.math.ethz.ch wrote:
>I investigated some more:  
>       R_VISIBLE is set to 0  ``R_Visible = 0;''
>        also in other places in eval.c :
>
> line  C function
>               
>  344:   do_if
>  436:   do_for
>  480:   do_while
>  515:   do_repeat
>  720:    \
>  727:     > do_set
>  738:    /
>  ^^^
>(line numbers from current 0.60)
>
>In my opinion, only the three cases in do_set ("<-" things) should have
>the invisibility flag...

In S-PLUS, for, while and repeat all return invisible answers, so for
compatibility these should probably be kept. Note that S-PLUS can behave
pretty strangely with this kind of example. Try this (but type carefully!)

n<-0
repeat{ if(n==0) break }->x

Now try printing x, or indeed doing anything else with it.

>
>###-------- THIS IS EVEN WORSE:   Segmentation violation !!! -----
>
>testrep <- function(n = 1) c(1, repeat {n <- n-1; if(n<=0) break})
>testrep()
>##R : Process R:1 segmentation violation at Thu Nov  6 11:36:27 1997

Try initializing t to R_NilValue in do_repeat (eval.c).

Martyn
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From jlindsey@luc.ac.be  Mon Nov 10 08:48:30 1997
From: jlindsey@luc.ac.be (Jim Lindsey)
Date: Mon, 10 Nov 1997 09:48:30 +0100 (MET)
Subject: R-alpha: text outside plots
Message-ID: <9711100848.AA24437@alpha.luc.ac.be>

When text() is used to write a string in the margin of a plot (for
example, between plots on a multiplot screen), the words appear on the
window but not when a postscript file is produced. In fact, they are
in the file, but clipped. This should be made consistent, preferably
so that they appear in both.
  Jim
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From p.dalgaard@kubism.ku.dk  Mon Nov 10 09:08:50 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 10 Nov 1997 10:08:50 +0100
Subject: R-alpha: text outside plots
In-Reply-To: Jim Lindsey's message of Mon, 10 Nov 1997 09:48:30 +0100 (MET)
References: <9711100848.AA24437@alpha.luc.ac.be>
Message-ID: <x23el5i09p.fsf@blueberry.kubism.ku.dk>

Jim Lindsey <jlindsey@luc.ac.be> writes:

> 
> When text() is used to write a string in the margin of a plot (for
> example, between plots on a multiplot screen), the words appear on the
> window but not when a postscript file is produced. In fact, they are
> in the file, but clipped. This should be made consistent, preferably
> so that they appear in both.
>   Jim

Aren't you supposed to use mtext() for putting text in margins? I
suspect that text() should behave like points(), etc. -- i.e. clip in
all cases. Or the clipping could be made optional.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From ihaka@stat.auckland.ac.nz  Mon Nov 10 09:20:44 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Mon, 10 Nov 1997 22:20:44 +1300 (NZDT)
Subject: R-alpha: text outside plots
Message-ID: <199711100920.WAA02521@stat1.stat.auckland.ac.nz>

The problem is that in X11 clipping is only applied to graphic
elements, not to text elements (why distinguish the two?), whereas
PostScript does the right thing. There are some possible work arounds,
but don't hold your breath.  Getting 0.60 out is job number one at
present.
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From Martin Maechler <maechler@stat.math.ethz.ch>  Mon Nov 10 16:00:56 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Mon, 10 Nov 1997 17:00:56 +0100
Subject: R-alpha: Re: R/R-minus incompatibility [ an old one ]
In-Reply-To: <199711101535.QAA23500@galadriel.ci.tuwien.ac.at> (message from
 Friedrich Leisch on Mon, 10 Nov 1997 16:35:47 +0100)
Message-ID: <199711101600.RAA08965@sophie.ethz.ch>

>>>>> "FrL" == Friedrich Leisch <Friedrich.Leisch@ci.tuwien.ac.at> writes:

    FrL> Hmm, I'm quite perplexed by something very trivial/stupid/whatever
    FrL> ...  don't know, if this one has been reported before:

    R> x<-1 x[1:2]
    FrL> Error: subscript out of bounds

    Splus> x<-1 x[1:2]
    FrL> [1] 1 NA

    FrL> Or is there an option to control this behaviour?

Fritz, this *is* known and is on purpose.
However, it seems that it is  NOT in the R-FAQ  (Kurt ?!?)

-- Martin

--------------- Here are two example mails from R-devel ------------------


 From: Peter Dalgaard BSA <p.dalgaard@kubism.ku.dk>
 Date: 25 Apr 1997 01:36:23 +0200
 To: r-devel@stat.math.ethz.ch
 Subject: R-alpha: list assignment

 This works in Splus:

 > x<-list()
 > x[["f"]]<-1
 > zz<-"g"
 > x[[zz]]<-2
 > x
 $f:
 [1] 1

 $g:
 [1] 2

 In R both variants fail unless the name is already on the list. The
 first one can be replaced by x$f, but there's seems to be no
 substitute for the other one (oh yes I found one, but it's not fit to
 print!). This comes up if you e.g. want to create a variable in a data
 frame with a name given by a character string.

------------------------------------------------------

 From: Robert Gentleman <rgentlem@stat.auckland.ac.nz>
 Date: Fri, 25 Apr 1997 13:12:36 +1200 (NZST)
 To: r-devel@stat.math.ethz.ch
 Subject: Re: R-alpha: list assignment

 Peter,
   They don't work on purpose. Basically this is the same problem as indexing
 beyond the end of an array. In almost all cases it is an error.
 To add a variable with a specific name to a data frame how about

 x (the dataframe)
 var1 the variable
 name1 the name

  x<-cbind(x,var1)
  names(x)[ncol(x)]<-name1

 robert
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From pgilbert@bank-banque-canada.ca  Mon Nov 10 16:43:11 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Mon, 10 Nov 1997 11:43:11 -0500
Subject: R-alpha: Re: R/R-minus incompatibility [ an old one ]
References: <199711101600.RAA08965@sophie.ethz.ch>
Message-ID: <97Nov10.115122est.26514@mailgate.bank-banque-canada.ca>

>> x[["f"]]<-1
 >> zz<-"g"
 >In R both variants fail unless the name is already on the list. The
 >first one can be replaced by x$f, but there's seems to be no
 >substitute for the other one (oh yes I found one, but it's not fit to

A long time ago it seems it was decided to remain incompatible with S on
this, I think because  people often do this in error. (Indeed, it did
point out some errors in my code.) However, there were some instances in
my code where I did something like x[[c("f","g","h")]] <- 1:3 and wanted
the corresponding elements updated or inserted as appropriate.  I have
replaced those instances with listadd(x, c("f","g","h")) <- 1:3 where
listadd is as defined below (more or less as suggested by Ross or Robert
at the time). It is one of the functions in the compatibility code I
have circulated previously.

Paul Gilbert
________
   "list.add<-" <- function(x, replace, value)
     {# replace or add elements to a list.
      if (is.numeric(replace))
        {x[[replace]] <- value
         return(x)
        }
      if (is.null(value))  value <- list(NULL)
      if (!is.list(value)) value <- list(value)
      if (1 == length(value))
       {for (i in seq(length(replace)))
          x<- do.call("$<-", list(x,replace[i],value[[1]]))
       }
      else
        {if(length(value) != length(replace) )
         stop("number of replacement values != number of elements to
replace")
         for (i in seq(length(replace)))
            x<- do.call("$<-", list(x,replace[i],value[[i]]))
        }
      x
     }


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From pgilbert@bank-banque-canada.ca  Mon Nov 10 16:56:06 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Mon, 10 Nov 1997 11:56:06 -0500
Subject: R-alpha: loop speed
Message-ID: <97Nov10.120407est.26511@mailgate.bank-banque-canada.ca>

I noticed Doug only circulated the following on S-news, but it may be of
interest to R users who don't follow S-news. His findings are certainly
consistent with my own, where my problems often force me into the
element by element type of situation.

Paul Gilbert
_______
At the risk of beating this example to death, I went back and compared
the execution time for the element-by-element method with that of the
indexing method.  At vector sizes of 50000 the indexing method is
close to 500 times faster.

 S-PLUS : Copyright (c) 1988, 1996 MathSoft, Inc.
 S : Copyright AT&T.
 Version 3.4 Release 1 for Sun SPARC, SunOS 5.3 : 1996
 Working data will be in .Data
 > x <- rnorm(50000)
 > y <- rnorm(50000)
 > op <- sample(c("*","+","-","/"), 50000, repl = T)
 > foo <-
 + function(x, y, op)
 + {
 +   z <- x
 +   for(i in seq(along = op))
 +     z[i] <- do.call(op[i], list(x[i], y[i]))
 +   z
 + }
 > unix.time(res1 <-
cbind(x*y,x-y,x+y,x/y)[cbind(seq(along=x),match(op,c("*", "-", "+",
"/")))])
 [1] 0.40000010 0.04999995 0.00000000 0.00000000 0.00000000
 > length(res1)
 [1] 50000
 > unix.time(res2 <- foo(x, y, op))
 [1] 196.23   0.29 199.00   0.00   0.00
 > length(res2)
 [1] 50000
 > all.equal(res1, res2)
 [1] T

It is interesting that the difference in execution speed when using R is

much less than when using S-PLUS.  On this machine (Sun UltraSparc 1
running Solaris 2.5.1) R is somewhat slower than S-PLUS for the
indexing version but close to 10 times faster for the
element-by-element version

 R> unix.time(res1 <-
cbind(x*y,x-y,x+y,x/y)[cbind(seq(along=x),match(op,c("*", "-", "+",
"/")))])
 [1] 1.55 0.07 2.00 0.00 0.00
 R> unix.time(res2 <- foo(x, y, op))
 [1] 23.96  0.05 24.00  0.00  0.00
 R> all(res1 == res2)
 [1] TRUE

--
Douglas Bates                            bates@stat.wisc.edu
Statistics Department                    608/262-2598
University of Wisconsin - Madison
http://www.stat.wisc.edu/~bates/



=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From ihaka@stat.auckland.ac.nz  Mon Nov 10 20:00:55 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Tue, 11 Nov 1997 09:00:55 +1300 (NZDT)
Subject: R-alpha: loop speed
Message-ID: <199711102000.JAA20068@stat1.stat.auckland.ac.nz>

	From r-devel-owner@stat.math.ethz.ch Tue Nov 11 05:58 NZD 1997
	Date: Mon, 10 Nov 1997 11:56:06 -0500
	From: Paul Gilbert <pgilbert@bank-banque-canada.ca>

	 S> unix.time(res1 <-
	cbind(x*y,x-y,x+y,x/y)[cbind(seq(along=x),match(op,c("*", "-", "+",
	"/")))])
	 [1] 0.40000010 0.04999995 0.00000000 0.00000000 0.00000000

	 R> unix.time(res1 <-
	cbind(x*y,x-y,x+y,x/y)[cbind(seq(along=x),match(op,c("*", "-", "+",
	"/")))])
	 [1] 1.55 0.07 2.00 0.00 0.00

We have received a patch from someone in CS at Berkeley which will
be in 0.60 and should claw back a decent fraction of the difference
between R and S in this comparison.  [ It eliminates our use of the
% operator in the loops for +, -, * / etc. ]

The looping speed was an original design goal for R.  It's good to
know that it hasn't been fixed (yet).

	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From thomas@biostat.washington.edu  Mon Nov 10 20:19:01 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Mon, 10 Nov 1997 12:19:01 -0800 (PST)
Subject: R-alpha: loop speed
In-Reply-To: <97Nov10.120407est.26511@mailgate.bank-banque-canada.ca>
Message-ID: <Pine.SUN.3.95.971110110012.1963A-100000@troi>

On Mon, 10 Nov 1997, Paul Gilbert wrote:

> I noticed Doug only circulated the following on S-news, but it may be of
> interest to R users who don't follow S-news. His findings are certainly
> consistent with my own, where my problems often force me into the
> element by element type of situation.

It is also interesting to look at the allegedly realistic if extreme
benchmark program provided with Matt Calder's partial S compiler. 

        LMS <- function(M, N)
        {
                ### Pre-allocate result and filter. ###
                R <- matrix(0,nrow=M, ncol=5)
                W <- rep(0,5)
                for (i in 1:M) {
                        ### Simulate MA(1) ###
                        Z <- rnorm(N+1)
                        X <- Z[2:(N+1)] + 0.5 * Z[1:N]
                        ### Perform LMS ###
                        for (j in 5:N) {
                                U <- X[j:(j-4)]
                                E <- Z[j+1] - sum(W * U)
                                W <- W + 0.1* E * U
                        }
                        ### Save final result ###
                        R[i,] <- W
                }
                return(R)
        }


I used this in S, R and compiled to C on an Ultra 1 (Solaris) and in R and
compiled to C on a Pentium Pro 150 under Linux

The results are quite interesting. These are CPU times in seconds for a
fixed value of N (100, I believe, but it was some time ago)

	Ultra             Intel
M     R     C    S      R      C
100  7.24  2.08  11    6.38   0.79
200 14.19  4.06  25.8  12.36  1.56
300 21.59  6.3   56.8  18.89  2.31
400 28.76  8.37  89    24.97  3.09
800 57.62 16.42 295    50.33  6.16

The time taken by R scales roughly linearly with M, S time grows much
faster. The two are comparable for small M. It's also interesting that the
Intel machine was slightly faster, though this doesn't translate to disk
and memory intensive tasks. 


Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From Friedrich.Leisch@ci.tuwien.ac.at  Tue Nov 11 09:33:23 1997
From: Friedrich.Leisch@ci.tuwien.ac.at (Friedrich Leisch)
Date: Tue, 11 Nov 1997 10:33:23 +0100
Subject: R-alpha: christmas wish (partial support for single)
Message-ID: <199711110933.KAA24602@galadriel.ci.tuwien.ac.at>


The following is a re-post (after suggestion from martin) of a mail I
sent to r-core this morning, maybe some of you are interested:


>>>>> On Tue, 11 Nov 1997 08:34:16 +0100,
>>>>> Kurt Hornik (KH) wrote:

KH> As Andreas & Fritz & I have recently, in attempts to port various pkgs
KH> to R, come across the f2c problem again, I thought I'd ask ...

KH> Some time ago, someone (Ross?) suggested that we'd have an f2c add-on
KH> package.  Is this still in the making somewhere?

If we talk about porting packages to R ... well, christmas is
approaching rapidly, so it's that time of the year again where people
think a lot about wishes :-)

The only effort that's involved when porting most pkg's is that R
doesn't support single precision ... well I don't need single
precision through the whole thing, but perhaps .Fortran could be
enhanced to support it? 

I think of something like single() (and friends) attaching an
attribute single to a numeric variable, and if .Fortran detects it, it
converts the stuff internally to single before passing it to the
subroutine. We could also introduce mode "single" which is exactly the
same as "numeric", but .Fortran respects it.

... just an idea, there are probably 1000 other ways of doing it
without introducing single for all things ... but it would ease
porting packages considerably for people who are not used to
programming Fortran or C. I do speak C, but still I'm always afraid of
breaking some code when changing all those real definitions to double
...

That's not urgent, but maybe we could start thinking about it.

Best,
Fritz


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From Friedrich.Leisch@ci.tuwien.ac.at  Tue Nov 11 11:02:39 1997
From: Friedrich.Leisch@ci.tuwien.ac.at (Friedrich Leisch)
Date: Tue, 11 Nov 1997 12:02:39 +0100
Subject: R-alpha: help files of base package
Message-ID: <199711111102.MAA24731@galadriel.ci.tuwien.ac.at>

		[this message bounced, because it had 'help'
		 at beginning of Subject.  Now sent as "approved". -- MM]

I'm not happy at all with the html and latex version of the base help
files, because presenting (currently) 320 files in alphabetic order is
not a good way for unexperienced users.

I'm thinking about introducing a new command like \category or
whatever to split the help files up into parts like


graphics commands
random numbers
linear models
input/output
...


such that we can organize things a little bit. this way we could also
have a concise index of ALL functions available that is still
helpfull. 

somthing like the categories list in the R-minus help window ...

what do you think?

how to organize such a thing (besides providing the technical means)?

fritz
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Nov 11 17:01:11 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 11 Nov 1997 18:01:11 +0100
Subject: R-alpha: help files of base package
In-Reply-To: <199711111102.MAA24731@galadriel.ci.tuwien.ac.at> (message from
 Friedrich Leisch on Tue, 11 Nov 1997 12:02:39 +0100)
Message-ID: <199711111701.SAA10204@sophie.ethz.ch>

>>>>> "FrL" == Friedrich Leisch <Friedrich.Leisch@ci.tuwien.ac.at> writes:

    FrL> I'm not happy at all with the html and latex version of the base
    FrL> help files, because presenting (currently) 320 files in alphabetic
    FrL> order is not a good way for unexperienced users.

One thing which could and should be changed immediately, is to
1)  have a new chapter or section for each package in  Man.tex,
2)  Use a tableofcontents at the beginning
Currently (with 'base' 'eda' and 'mva') We just have 'xy.coords' (last of
base) followed by 'line' (first of 'eda').

ok.
For the inexperienced one, I think we need the "Rnotes chapters" part of
the manual, anyway...

    FrL> I'm thinking about introducing a new command like \category or
    FrL> whatever to split the help files up into parts like
    FrL> graphics commands random numbers linear models input/output ...

Fritz, you must know that I had emphasized the introduction of \keyword{.}
a few months ago.

If you read current appendix A  ``Writing R Documentation'', you find (p.2)
that I say how (one or more) "\keyword{.}" should be used.
I've put several dozens of these \keyword{.} in several of the  *.Rd
files, also, but then I lacked time (and motivation because nobody
encouraged me .. ;-} ).

I also made a point to write  RHOME/doc/KEYWORDS
(was RHOME/mansrc/KEYWORDS in version 0.50) and mentioned it in
the output of  prompt(foo) and the above appendix A.

My goal has always been to have categories
 (these, as you see in KEYWORDS, are further grouped into "Hyper-Categories"). 
for online help  AND  printed documentation.

The point is:  Many functions (& and help files) should have more than one
keyword, since they belong into more than one category.
This is quite fine for   topics() and help.start() [HTML help],
but it is not so easy for printed documentation.

We could resolve the problem by defining the convention
that for printed docu, only the FIRST keyword will be used.

    FrL> such that we can organize things a little bit. this way we could
    FrL> also have a concise index of ALL functions available that is still
    FrL> helpfull.

Index, YES(!)   ((I've always wanted to do this for quite a while...)
		The index should have an entry 'foobar' for each \alias foobar.
This could be started immediately, as of now.
It is very useful anyway (i.e. even with alphabetically sorted man pages), and
has no real connection to the \keyword / category  side.


    FrL> what do you think?

    FrL> how to organize such a thing (besides providing the technical
    FrL> means)?

It's a good idea (not new however)
which needs quite a bit of work to be properly implemented
(editing hundreds of .Rd files  AFTER thinking which keywords to use...).
	
Once you have these categories, you'll want to rely on them.
Therefore, wrong, misspelled or missing keywords WILL be a more severe
problem than other typos / inaccuracies in *.Rd files.

Still, I am deeply convinced that its worth the work.
If several people divided it up, it would be even more fun
(and probably lead to a better  result).

If you start doing the ``technical means''
[[ Enhancing  Rdconv (and  Rd.sty, functions.html) for  latex and html ]],
I'd be very much motivated to restart on the big job of putting in more
\keywords. 
As said, maybe it'll be better to divide this up among several people.

- Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From p.dalgaard@kubism.ku.dk  Tue Nov 11 19:11:02 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 11 Nov 1997 20:11:02 +0100
Subject: R-alpha: help files of base package
In-Reply-To: Friedrich Leisch's message of Tue, 11 Nov 1997 12:02:39 +0100
References: <199711111102.MAA24731@galadriel.ci.tuwien.ac.at>
Message-ID: <x2k9ef2qm1.fsf@blueberry.kubism.ku.dk>

Friedrich Leisch <Friedrich.Leisch@ci.tuwien.ac.at> writes:

> I'm not happy at all with the html and latex version of the base help
> files, because presenting (currently) 320 files in alphabetic order is
> not a good way for unexperienced users.

You're not alone... but I'm afraid that this is something very
difficult to do right. Some things are easy, i.e. factor out graphics
functions and linear models, but other things might be difficult to
structure right, e.g. what goes in a "core" part? arithmetic?
programming constructs? etc.

> what do you think?
> 
> how to organize such a thing (besides providing the technical means)?

I think we need to think for a while and try some things and see how
they work. One technical means that I've been wanting is a way to
extract a mini-manual to go with the reduced curriculum in my medical
PhD course. (Or maybe it's there already and I just didn't have the
time to find out?)

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From Friedrich.Leisch@ci.tuwien.ac.at  Wed Nov 12 07:52:05 1997
From: Friedrich.Leisch@ci.tuwien.ac.at (Friedrich Leisch)
Date: Wed, 12 Nov 1997 08:52:05 +0100
Subject: R-alpha: help files of base package
In-Reply-To: <199711111701.SAA10204@sophie.ethz.ch>
References: <199711111102.MAA24731@galadriel.ci.tuwien.ac.at>
 <199711111701.SAA10204@sophie.ethz.ch>
Message-ID: <199711120752.IAA25461@galadriel.ci.tuwien.ac.at>

>>>>> On Tue, 11 Nov 1997 18:01:11 +0100,
>>>>> Martin Maechler (MM) wrote:

>>>>> "FrL" == Friedrich Leisch <Friedrich.Leisch@ci.tuwien.ac.at> writes:
FrL> I'm not happy at all with the html and latex version of the base
FrL> help files, because presenting (currently) 320 files in alphabetic
FrL> order is not a good way for unexperienced users.

MM> One thing which could and should be changed immediately, is to
MM> 1)  have a new chapter or section for each package in  Man.tex,
MM> 2)  Use a tableofcontents at the beginning

Ok, that Man.tex needs re-organization is obvious now that we have tex
files for all installed pkg's. But that doesn't help with the html
pages. 



MM> ok.
MM> For the inexperienced one, I think we need the "Rnotes chapters" part of
MM> the manual, anyway...

Second thing is that a couple of students complained about the R-notes
... they simply don't think it's a good intro to R because it's rather
longish, but has bo index etc. ... I can't complain about it, but I
had this feedback from several R novices independently. Has anybody
had similar experiences?



FrL> I'm thinking about introducing a new command like \category or
FrL> whatever to split the help files up into parts like
FrL> graphics commands random numbers linear models input/output ...

MM> Fritz, you must know that I had emphasized the introduction of \keyword{.}
MM> a few months ago.

Oh, sorry, I just reread my email fromn yesterday ... when I started
to write it I wanted to put something in like ``this has to be done in
connection with the current keyword concept'' but then forgot to
actually write the line ... SORRY!

Making html index pages for all keywords would be a possibility, but
But as you said: I'm not sure how this would affect printed
documentation ... I still think that the latex part of base should
have subsections ...

MM> If you read current appendix A  ``Writing R Documentation'', you find (p.2)
MM> that I say how (one or more) "\keyword{.}" should be used.
MM> I've put several dozens of these \keyword{.} in several of the  *.Rd
MM> files, also, but then I lacked time (and motivation because nobody
MM> encouraged me .. ;-} ).

Please see this as STRONG encouragement!



MM> I also made a point to write  RHOME/doc/KEYWORDS
MM> (was RHOME/mansrc/KEYWORDS in version 0.50) and mentioned it in
MM> the output of  prompt(foo) and the above appendix A.

MM> My goal has always been to have categories
MM>  (these, as you see in KEYWORDS, are further grouped into "Hyper-Categories"). 
MM> for online help  AND  printed documentation.

MM> The point is:  Many functions (& and help files) should have more than one
MM> keyword, since they belong into more than one category.
MM> This is quite fine for   topics() and help.start() [HTML help],
MM> but it is not so easy for printed documentation.

MM> We could resolve the problem by defining the convention
MM> that for printed docu, only the FIRST keyword will be used.

FrL> such that we can organize things a little bit. this way we could
FrL> also have a concise index of ALL functions available that is still
FrL> helpfull.

MM> Index, YES(!)   ((I've always wanted to do this for quite a while...)
MM> 		The index should have an entry 'foobar' for each \alias foobar.
MM> This could be started immediately, as of now.
MM> It is very useful anyway (i.e. even with alphabetically sorted man pages), and
MM> has no real connection to the \keyword / category  side.


FrL> what do you think?

FrL> how to organize such a thing (besides providing the technical
FrL> means)?

MM> It's a good idea (not new however)

I'm aware of that ... most good ideas aere not new ... just wanted to
restart discussion ...

MM> which needs quite a bit of work to be properly implemented
MM> (editing hundreds of .Rd files  AFTER thinking which keywords to use...).

exactly!

that's why I thought about introducing \category{} ... but simly using
the first keyword would be fine with me ...

We could start (and that shouldn't be too much work) with a rather
small set of obvious hyper-keywords/categories to group things a
little bit ... of course with goal of a larger set of keywords
providing finer clusters in the long run.

MM> Once you have these categories, you'll want to rely on them.
MM> Therefore, wrong, misspelled or missing keywords WILL be a more severe
MM> problem than other typos / inaccuracies in *.Rd files.

MM> Still, I am deeply convinced that its worth the work.
MM> If several people divided it up, it would be even more fun
MM> (and probably lead to a better  result).

MM> If you start doing the ``technical means''
MM> [[ Enhancing  Rdconv (and  Rd.sty, functions.html) for  latex and html ]],
MM> I'd be very much motivated to restart on the big job of putting in more
MM> \keywords. 
MM> As said, maybe it'll be better to divide this up among several people.

Yes!



Best,
Fritz
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From jlindsey@luc.ac.be  Wed Nov 12 08:58:18 1997
From: jlindsey@luc.ac.be (Jim Lindsey)
Date: Wed, 12 Nov 1997 09:58:18 +0100 (MET)
Subject: R-alpha: glm
Message-ID: <9711120858.AA24449@alpha.luc.ac.be>

Here is another bug in glm. Occasionally, with log linear models for
small tables, there can be more parameters (many aliased) than cells
in the table. Then, glm does not work. The problem is in the qr
decomposition. Here is a quick hack that works, although not very
elegant.
  In glm.fit, replace l. 254

Rmat <- fit$qr[1:nvars, 1:nvars]

by

Rmat <- diag(nvars)
nr <- min(sum(good),nvars)
Rmat[1:nr,1:nvars] <- fit$qr[1:nr,1:nvars]

  Jim
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From jlindsey@luc.ac.be  Wed Nov 12 09:03:59 1997
From: jlindsey@luc.ac.be (Jim Lindsey)
Date: Wed, 12 Nov 1997 10:03:59 +0100 (MET)
Subject: R-alpha: NextMethod
Message-ID: <9711120903.AA19776@alpha.luc.ac.be>

Here is something that I am sure has been discussed before, but I
don't understand what is going on.
  I am building some functions for ordinal variables on top of the glm
class. Take one with class lmov as well as glm and lm in that order.
In summary.lmov and print.lmov, is print out some information and then
use NextMethod. summary works fine in all cases. However, if z has
class lmov, print(z) works fine but just typing the name, z, prints
out what I want in print.lmov and then says it cannot find print.lmov
instead of using print.glm (which it finds when print(z) is used).
  Jim
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From jlindsey@luc.ac.be  Wed Nov 12 09:17:52 1997
From: jlindsey@luc.ac.be (Jim Lindsey)
Date: Wed, 12 Nov 1997 10:17:52 +0100 (MET)
Subject: R-alpha: batch
Message-ID: <9711120917.AA21246@alpha.luc.ac.be>

Back to my favourite R subject: batch mode. Some months ago, I pointed
out how the default of saving .RData automatically in batch can often
lead to completely erroneous results when using data.frames. Basically
the idea of .RData is to save the environment to start where one left
off. This will generally be quite different than where one started
the session. The idea of a batch file is to redo a session and create
hard copy of it. Hence one wants to start at the beginning, not the
end. So a .RData file must absolutely not be present. The same holds
if you run a batch file twice. The first time it must not create an
.RData. Otherwise, completely wrong results can be produced the second
time.
  Martin suggested a work around by having a final line in each file
that tests for interactive. This is fine if you remember to put it in
all files. Here is an example of a further problem that hit me the
other day. I am developing some new libraries containing C code. At a
certain point, I wanted hard copy, from batch, before changing the C
to compare before and after. My file has a library call in it (but I
forgot the test on the last line). I ran the batch then went back to
interactive. When I loaded the library and tried to run the C code, it
said that it was not in the load table. Because I was debugging, it
took me quite awhile to discover that the problem was the .RData
created behind my back.
  When is the default going to be changed to not saving the .RData in
batch mode???? Does anyone use batch mode except me?
  Jim
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From plindsey@luc.ac.be  Wed Nov 12 09:19:20 1997
From: plindsey@luc.ac.be (Patrick Lindsey)
Date: Wed, 12 Nov 1997 10:19:20 +0100 (MET)
Subject: R-alpha: Bug in postscript command with boxplots.
Message-ID: <9711120919.AA19072@alpha.luc.ac.be>

In R-0.50-a3, problems occurs when creating a postscript file of
a boxplot. Just using the boxplot command works fine (on the screen).
> x11()
> boxplot(x)

But, once the postscript command is used to capture a boxplot, the
horizontal lines are missing in the file.
> postscript("new.ps",landscape=F)
> boxplot(x)
> dev.off()

On the other hand, using the save.plot command creates a postscript file
of a boxplots which is fine.
> x11()
> boxplot(x)
> save.plot("new.ps")

Patrick.
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From phlamber@luc.ac.be  Wed Nov 12 09:44:32 1997
From: phlamber@luc.ac.be (Philippe Lambert)
Date: Wed, 12 Nov 1997 10:44:32 +0100 (MET)
Subject: R-alpha: Optimize
Message-ID: <Pine.OSF.3.96.971112103643.2170A-100000@alpha>

The function optimize returns the opposite value of the objective
when maximizing:

> f <- function(x) -x**2+1
> optimize(f,c(-5,5),maximum=TRUE)
$maximum
[1] 0

$objective
[1] -1

> f(0)
[1] 1

What should be corrected:

> optimize
function (f, interval, lower = min(interval), upper = max(interval), 
        maximum = FALSE, tol = .Machine$double.eps^0.25, ...) 
{
        if (maximum) {
                val <- .Internal(fmin(function(arg) -f(arg, ...), 
                        lower, upper, tol))
                list(maximum = val, objective = -f(val,...)
                                               ^^^
SHOULD BE +f(val,...) <-------------------------|

   Philippe

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From Martin Maechler <maechler@stat.math.ethz.ch>  Wed Nov 12 09:48:09 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 12 Nov 1997 10:48:09 +0100
Subject: R-alpha: batch -- no problem with make and proper Makefile
In-Reply-To: <9711120917.AA21246@alpha.luc.ac.be> (message from Jim Lindsey on
 Wed, 12 Nov 1997 10:17:52 +0100 (MET))
Message-ID: <199711120948.KAA10947@sophie.ethz.ch>

Yes, I use batch too.

In addition, I also use 'make' consistently
My current approach (this is Makefile syntax)
Just
	@-rm -f .RData
	R < input > output	


Actually, I'm a bit smarter and have a Makefile of the form

##--------------------- Makefile for different R batch jobs ----------
##----------------------------- Martin Maechler ----------------------	
R = /usr/local/bin/R
R = /usr/local/bin/R-MM

TESTsrc = str-test.R foobar.R thistest.R  thattest.R
TESTout = $(TESTsrc:.R=.Rout)

%.Rout: %.R
	if [ -f .RData ];   then mv .RData .RData-mm; fi
	if [ -f .Rprofile ];then mv .Rprofile .Rprofile-mm; fi
	touch .Rprofile;
	(echo '##-*- R-transcript -*- --- empty .Rprofile'; $(R) < $< ) > $@
	-@wc $@

all: tests
tests: $(TESTout)

str-test.Rout:: str-src.R

clean: ; mv $(TESTout) out-safe/ ; rm -f $(Shars)
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From p.dalgaard@kubism.ku.dk  Wed Nov 12 10:34:40 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 12 Nov 1997 11:34:40 +0100
Subject: R-alpha: help files of base package
In-Reply-To: Friedrich Leisch's message of Wed, 12 Nov 1997 08:52:05 +0100
References: <199711111102.MAA24731@galadriel.ci.tuwien.ac.at>
 <199711111701.SAA10204@sophie.ethz.ch>
 <199711120752.IAA25461@galadriel.ci.tuwien.ac.at>
Message-ID: <x2affaxuwv.fsf@blueberry.kubism.ku.dk>

Friedrich Leisch <Friedrich.Leisch@ci.tuwien.ac.at> writes:

> Second thing is that a couple of students complained about the R-notes
> ... they simply don't think it's a good intro to R because it's rather
> longish, but has bo index etc. ... I can't complain about it, but I
> had this feedback from several R novices independently. Has anybody
> had similar experiences?

Hmm, when students say that something is not good enough, they're in a
sense right by definition (excepting cases where student aggravation
is used as a deliberate pedagogical tool -- something *I* wouldn't
dare try...), but that doesn't mean that the reasons they give should
be taken at face value.

I'd say that R-notes is about three times too *short* for a tutorial.
Discounting the examples it's about 60 pages; the notes I'm writing
for my medical PhD's are already twice that size and will probably end
somewhere around 170 pages, and this covers absolutely *no*
programming. Also, R-notes has no pedagogical sequencing (i.e. read
the first n pages and be able to do something useful, the next n
learning some more, etc.), no repetition and extension of earlier
stuff, etc.

There's nothing really wrong with that, because that isn't the kind of
document the R-notes tries to be, it's more of a structured language
overview. Some people can actually learn the language from that kind
of material alone (it's certainly better than starting from the manual
pages), but many others will feel it's like learning a human language
from a grammar book. Once you *have* learned it, document like R-notes
become much more useful than tutorial because of the stricter
structure. An index would probably be a good thing in all cases,
though.

What experience do people have with textbooks on S? Do we already have
something that fits the students' (i.e. our) needs or do "we" need to
write it ourself? (Not quite knowing who "we" should be..)

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From p.dalgaard@kubism.ku.dk  Wed Nov 12 10:57:14 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 12 Nov 1997 11:57:14 +0100
Subject: R-alpha: batch
In-Reply-To: Jim Lindsey's message of Wed, 12 Nov 1997 10:17:52 +0100 (MET)
References: <9711120917.AA21246@alpha.luc.ac.be>
Message-ID: <x290uuxtv9.fsf@blueberry.kubism.ku.dk>

Jim Lindsey <jlindsey@luc.ac.be> writes:

>   When is the default going to be changed to not saving the .RData in
> batch mode???? Does anyone use batch mode except me?

One rather nasty thing to consider is that interactivity is (as I
understand it) detectable only by the existence of a controlling
terminal. This can cause trouble with cases where the controlling
terminal disappears, one case being upon logout from the windows
system or a system shutdown. Presumably, most people prefer their work
to be saved in those cases.

What might be a much better idea is to make the saving (and loading
too) of .Rdata into command line options, so that

R BATCH filein fileout

would translate into 

R -nosaveimg -noloadimg < filein > fileout

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From jlindsey@luc.ac.be  Wed Nov 12 13:16:12 1997
From: jlindsey@luc.ac.be (Jim Lindsey)
Date: Wed, 12 Nov 1997 14:16:12 +0100 (MET)
Subject: R-alpha: glm cont.
Message-ID: <9711121316.AA11236@alpha.luc.ac.be>

Here is a quick example that the uncorrected glm cannot fit. Suppose
that freq contains the nine values from a 3x3 contingency table, fac1
and fac2 the factor variables indexing the margins, and lin1 and lin2
the corresponding linear variables. Then without my correction, glm
cannot fit 
glm(freq~fac1+fac2+fac1:lin2+fac2:lin1,family=poisson)
because there are 11 variable combinations (3 aliased) and only 9
observations.
  Jim
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From jlindsey@luc.ac.be  Wed Nov 12 13:29:39 1997
From: jlindsey@luc.ac.be (Jim Lindsey)
Date: Wed, 12 Nov 1997 14:29:39 +0100 (MET)
Subject: R-alpha: batch
In-Reply-To: <x290uuxtv9.fsf@blueberry.kubism.ku.dk> from "Peter Dalgaard BSA" at Nov 12, 97 11:57:14 am
Message-ID: <9711121329.AA12443@alpha.luc.ac.be>

  Following on Peter's suggestion, if there is going to be a recognized
batch mode that does not save the .RData, then why not just change the
default option in the C code? Only one number has to be changed.
  Up until this version, I systematically did this. But now I am
developing R code to go on a CD for the second edition of my repeated
measures book so I have to be using a standard R, not a specially
compiled one to my tastes.
  As to wanting an .RData if the terminal disappears. Basically, I
never want an .RData. I have the input and hopefully the output files.
If I am working on an article, I keep all relevant data sets and
analyses in the same directory. If I am working on one of my books, I
keep data analyses by chapter. If I am doing consulting, I often have
several distinct analyses of a data set, all in the same directory.
None of these is conducive to using .RData. I just don't like the
S-Plus habit of automatically and silently loading in what you last
did when you may not even remember what it was a couple of weeks ago.
  I have lost too many hours trying to figure out why analyses are not
calculated correctly when it was just a hidden .RData from a batch
job.
  Jim
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From pgilbert@bank-banque-canada.ca  Wed Nov 12 15:13:58 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Wed, 12 Nov 1997 10:13:58 -0500
Subject: R-alpha: help files of base package
References: <199711111102.MAA24731@galadriel.ci.tuwien.ac.at>
 <199711111701.SAA10204@sophie.ethz.ch> <199711120752.IAA25461@galadriel.ci.tuwien.ac.at>
Message-ID: <97Nov12.101538est.26514@mailgate.bank-banque-canada.ca>

>Making html index pages for all keywords would be a possibility, but...

It might be better and easier to use a general purpose full texted
search such as the one for S-news at statlib
<http://lib.stat.cmu.edu/s-news>. It is all done with publicly available
programs. It sure would be nice to have that facility for R-help as
well.

Paul Gilbert


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From Friedrich.Leisch@ci.tuwien.ac.at  Wed Nov 12 15:31:58 1997
From: Friedrich.Leisch@ci.tuwien.ac.at (Friedrich Leisch)
Date: Wed, 12 Nov 1997 16:31:58 +0100
Subject: R-alpha: help files of base package
In-Reply-To: <97Nov12.101538est.26514@mailgate.bank-banque-canada.ca>
References: <199711111102.MAA24731@galadriel.ci.tuwien.ac.at>
 <199711111701.SAA10204@sophie.ethz.ch>
 <199711120752.IAA25461@galadriel.ci.tuwien.ac.at>
 <97Nov12.101538est.26514@mailgate.bank-banque-canada.ca>
Message-ID: <199711121531.QAA26226@galadriel.ci.tuwien.ac.at>

>>>>> On Wed, 12 Nov 1997 10:13:58 -0500,
>>>>> Paul Gilbert (PG) wrote:

>> Making html index pages for all keywords would be a possibility, but...
PG> It might be better and easier to use a general purpose full texted
PG> search such as the one for S-news at statlib
PG> <http://lib.stat.cmu.edu/s-news>. It is all done with publicly available
PG> programs. It sure would be nice to have that facility for R-help as
PG> well.

That's something with top priority on my list ...

I already wanted to do that earlier and sent a corresponding email
(hopefully not only to R-core) ... searching the pages would be
definetely an absolute great thing.

My only problem is how to setup such a thing without a
web-server. All software packages I'm aware of use cgi scripts and
need a http server running. That's something we want to avoid, because
not everybody running R has the means of running an http server.

If you (or somebody else) could provide me with software to do such a
search without need for a http server that would definetely be one of
the next things for me to include into the R help system.

Otherwise we could take a vote if we still want search depending on
the existence of a http server ... in that case I'm aware of several
GPL'ed search packages, e.g., we use htdig here for our web server.



Best,
Fritz
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From pgilbert@bank-banque-canada.ca  Wed Nov 12 16:55:26 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Wed, 12 Nov 1997 11:55:26 -0500
Subject: R-alpha: help files of base package
References: <199711111102.MAA24731@galadriel.ci.tuwien.ac.at>
 <199711111701.SAA10204@sophie.ethz.ch>
 <199711120752.IAA25461@galadriel.ci.tuwien.ac.at>
 <97Nov12.101538est.26514@mailgate.bank-banque-canada.ca> <199711121531.QAA26226@galadriel.ci.tuwien.ac.at>
Message-ID: <97Nov12.115723est.26522@mailgate.bank-banque-canada.ca>

>If you (or somebody else) could provide me with software to do such a
>search without need for a http server that would definetely be one of
>the next things for me to include into the R help system.

I'm afraid I don't know how to do this. I assume the http server uses a
cgi which runs something to do the search, and this could probably be
run without the server. But then you might be faced with building an
non-HTML user interface, which might not be so easy. On the other hand,
if you can run it directly from R, rather than from an HTML form, it
might work with other help formats as well.

Best of luck,
Paul

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From Friedrich.Leisch@ci.tuwien.ac.at  Wed Nov 12 17:50:44 1997
From: Friedrich.Leisch@ci.tuwien.ac.at (Friedrich Leisch)
Date: Wed, 12 Nov 1997 18:50:44 +0100
Subject: R-alpha: help files of base package
In-Reply-To: <97Nov12.115723est.26522@mailgate.bank-banque-canada.ca>
References: <199711111102.MAA24731@galadriel.ci.tuwien.ac.at>
 <199711111701.SAA10204@sophie.ethz.ch>
 <199711120752.IAA25461@galadriel.ci.tuwien.ac.at>
 <97Nov12.101538est.26514@mailgate.bank-banque-canada.ca>
 <199711121531.QAA26226@galadriel.ci.tuwien.ac.at>
 <97Nov12.115723est.26522@mailgate.bank-banque-canada.ca>
Message-ID: <199711121750.SAA26340@galadriel.ci.tuwien.ac.at>

>>>>> On Wed, 12 Nov 1997 11:55:26 -0500,
>>>>> Paul Gilbert (PG) wrote:

>> If you (or somebody else) could provide me with software to do such a
>> search without need for a http server that would definetely be one of
>> the next things for me to include into the R help system.

PG> I'm afraid I don't know how to do this.

welcome to the club ...

PG> I assume the http server uses a
PG> cgi which runs something to do the search, and this could probably be
PG> run without the server.

yes

PG> But then you might be faced with building an
PG> non-HTML user interface, which might not be so easy. On the other hand,
PG> if you can run it directly from R, rather than from an HTML form, it
PG> might work with other help formats as well.

well, it could probably be done without troubles in a java script
... but I've never programmed java before ... so that's more of a long
term project ... 

has anybody some spare time to help out?

best,
fritz
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From jlindsey@luc.ac.be  Fri Nov 14 08:33:48 1997
From: jlindsey@luc.ac.be (Jim Lindsey)
Date: Fri, 14 Nov 1997 09:33:48 +0100 (MET)
Subject: R-alpha: Design and Hmisc
Message-ID: <9711140833.AA32283@alpha.luc.ac.be>

I have been looking at porting Design and Hmisc to R. Unfortunately, I
know nothing about S and do not have access to it. Basically what I
have found is that many functions work directly, as long as they do
not involve data.frames or models. These two create a lot of
incompatibilities.
  Here is what I had to do to get the functions to load:
1. R INSTALL ignores function names beginning with a capital letter.
2. A semicolon between if and else gives an error:
   if( ) expr1 ; else expr2
3. strings cannot be broken over two lines
4. checks on the OS have to be changed to use machine()
5. synchronize() does not exist
6. single has to be changed to double (warning only)
Then when they are finally loaded, nothing connected with models works
anymore, not even glm!
There are a number of missing functions:
1. category, as.category, is.category (the latter is in header.R of
survival4) These need to be written so that they are numeric but
level() works properly.
2. terms.inner (this is called by newsurvival4.R on l.1242 but does
not exist!) Design uses a stripped down version that calls a C
function called all_names. Any idea what this is?
3. The fortran for proportional odds calls directly the fortran
functions underlying the S versions of qr and solve. These appear to
be different modifications of linpack routines than those used in
R. The argument lists are different.

A further incompatibility is that assignments similar to the following
are often used:
Limits <- list()
Limits[["y"]] <- 1
This gives subscript out of bounds.

The S code appears to be very clean (although unreadable because not
properly indented). (This contrasts with Oswald that my son has been
trying to port for the last 6 months and that is extremely poorly
programmed.)  If anyone is interested in pursuing this further, I
shall be happy to forward the results of the 5 or 6 hours work that I
put in to it. For someone who knows S well, I do not think it would be
much work.
  Jim
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Nov 14 17:27:00 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 14 Nov 1997 18:27:00 +0100
Subject: R-alpha: more bugs with names/dims, etc.:
Message-ID: <199711141727.SAA14384@sophie.ethz.ch>


 x_1:4
 data.frame(x=2*x, y=3*x) - structure(x, names=letters[seq(x)])

## R :
## Error in data.frame(x = 2 * x, y = 3 * x) - structure(x, names = letters[seq(x)]) : non-numeric argument to binary operator

## S:
  x y 
1 1 2
2 2 4
3 3 6
4 4 8
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Nov 14 18:16:20 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 14 Nov 1997 19:16:20 +0100
Subject: R-alpha: S-R -- quite a dangerous incompatibility...
Message-ID: <199711141816.TAA14607@sophie.ethz.ch>


any( 1 < 0, na.rm = T) 

##S: FALSE

##R: TRUE		(guess why; the TRUE of  na.rm=T ...)


##-- Of course, the analogon happens for

all( 1 > 0, na.rm = F)

## S : TRUE	
## R : FALSE

-- Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From p.dalgaard@biostat.ku.dk  Fri Nov 14 21:17:34 1997
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 14 Nov 1997 22:17:34 +0100
Subject: R-alpha: S-R -- quite a dangerous incompatibility...
In-Reply-To: Martin Maechler's message of Fri, 14 Nov 1997 19:16:20 +0100
References: <199711141816.TAA14607@sophie.ethz.ch>
Message-ID: <x2lnyr41ld.fsf@blueberry.kubism.ku.dk>

Martin Maechler <maechler@stat.math.ethz.ch> writes:

> 
> 
> any( 1 < 0, na.rm = T) 
> 
> ##S: FALSE
> 
> ##R: TRUE		(guess why; the TRUE of  na.rm=T ...)
> 

Ugh... Root of the problem seems to be that any() and all() don't
understand na.rm=, which they probably should, so it'll go away
eventually. 

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From p.dalgaard@biostat.ku.dk  Mon Nov 17 21:05:02 1997
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 17 Nov 1997 22:05:02 +0100
Subject: R-alpha: Re: R-beta: installing new packages in window95 version of R
In-Reply-To: Luke Tierney's message of Mon, 17 Nov 1997 11:00:36 -0600 (CST)
References: <9711171700.AA04611@nokomis.stat.umn.edu>
Message-ID: <x2g1ovdyf5.fsf@blueberry.kubism.ku.dk>

Luke Tierney <luke@stat.umn.edu> writes:


> One potential problem is with the calling conventions. Watcom uses a
> register based method that appears to be different from the optional
> resgister-based one under MS. The default under MS is I think a stack
> based convention. If the R .exe is compiled with default calling
> conventions then it *may* work to have MS Fortran generate code for
> regieter-based calls (there may be a flag you can set for that) but
> I'm worried there may be more differences than argument passing, that
> the conventions on who saves and restores other registers may be
> different. If that is indeed the case then calls may appear to work in
> some contexts but not in others.

Yuk!

I want this to work with GCC as cross-compiler
I want this to work with GCC as cross-compiler
I want this to work with GCC as cross-compiler
I want this to work with GCC as cross-compiler
I want this to work with GCC as cross-compiler

- but I don't have the time just yet...

(I've got the crosscompiler, Linux->Win32, but I couldn't figure out
how to get the include files for the windows DDE stuff to behave.
Maybe I should spend some time (if I ever get any) on studying what it
does with DLL's?)

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=---
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=---

From jlindsey@luc.ac.be  Tue Nov 18 09:47:24 1997
From: jlindsey@luc.ac.be (Jim Lindsey)
Date: Tue, 18 Nov 1997 10:47:24 +0100 (MET)
Subject: R-alpha: Student t functions
Message-ID: <9711180947.AA13264@alpha.luc.ac.be>

Some of the Student t functions (e.g. dt) still round the degrees of
freedom to an integer whereas others do not (e.g. pt).
  Jim
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=---
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=---

From bates@stat.wisc.edu  Fri Nov 21 14:28:34 1997
From: bates@stat.wisc.edu (Douglas Bates)
Date: 21 Nov 1997 08:28:34 -0600
Subject: R-alpha: nlm and gradients
Message-ID: <6r4t56qq25.fsf@franz.stat.wisc.edu>

At present the documentation for nlm refers the reader to Dennis and
Schnabel for details on the algorithms.  It also states that the
function is liable to change.

Can anyone tell me if the current version of nlm uses only function
values or if it can use gradients and Hessians when they are
available?  I would like to get an idea of how difficult it would be
to port the development versions of our linear mixed-effects code.

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=---
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=---

From pgilbert@bank-banque-canada.ca  Fri Nov 21 16:08:38 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Fri, 21 Nov 1997 11:08:38 -0500
Subject: R-alpha: nlm
Message-ID: <97Nov21.111118est.26511@mailgate.bank-banque-canada.ca>

>Can anyone tell me if the current version of nlm uses only function
>values or if it can use gradients and Hessians when they are
>available?  I would like to get an idea of how difficult it would be
>to port the development versions of our linear mixed-effects code.

Doug

If you don't get the answer you need regarding nlm, I have some
multivariate code which may help. The code has one problem I know about
(the Hessian estimate is off) but mostly I think it is working well.

Paul

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=---
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=---

From p.dalgaard@biostat.ku.dk  Fri Nov 21 16:34:20 1997
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 21 Nov 1997 17:34:20 +0100
Subject: R-alpha: nlm and gradients
In-Reply-To: Douglas Bates's message of 21 Nov 1997 08:28:34 -0600
References: <6r4t56qq25.fsf@franz.stat.wisc.edu>
Message-ID: <x23ekqxl2r.fsf@blueberry.kubism.ku.dk>

Douglas Bates <bates@stat.wisc.edu> writes:

> Can anyone tell me if the current version of nlm uses only function
> values or if it can use gradients and Hessians when they are
> available?  I would like to get an idea of how difficult it would be
> to port the development versions of our linear mixed-effects code.

I'd say that this is so important that you should just tell us what
you want it to do and we'll make it do so.

(Above statement being asymptotically valid for large values of
"we"...)

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=---
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=---

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Nov 21 17:05:43 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 21 Nov 1997 18:05:43 +0100
Subject: R-alpha: nlm and gradients
In-Reply-To: <6r4t56qq25.fsf@franz.stat.wisc.edu> (message from Douglas Bates
 on 21 Nov 1997 08:28:34 -0600)
Message-ID: <199711211705.SAA07895@sophie.ethz.ch>

>>>>> "DougB" == Douglas Bates <bates@stat.wisc.edu> writes:

    DougB> At present the documentation for nlm refers the reader to Dennis
    DougB> and Schnabel for details on the algorithms.  It also states that
    DougB> the function is liable to change.

    DougB> Can anyone tell me if the current version of nlm uses only
    DougB> function values or if it can use gradients and Hessians when
    DougB> they are available?  I would like to get an idea of how
    DougB> difficult it would be to port the development versions of our
    DougB> linear mixed-effects code.

Hello Doug,
 thank you for thinking about the port !!

Unfortunately, the current version of
	src/main/optimize.c
still contains

o.c>   static int F77_SYMBOL(d1fcn)(int *n, double *x, double *g)
o.c>   {
o.c>     error("optimization using analytic gradients not implemented (yet)\n");
o.c>   }
o.c>
o.c>   static int F77_SYMBOL(d2fcn)(int *n, double *x, double *g)
o.c>   {
o.c>     error("optimization using analytic Hessians not implemented (yet)\n");
o.c>   }

(optimize.c is unchanged since 0.50-a4).

The underlying Fortran code would allow gradients and hessians;
the ``only'' remaining thing is to use the internal code in R which
is used for 'deriv(.)' to compute algebraic derivatives ...

Martin Maechler <maechler@stat.math.ethz.ch>		 <><
Seminar fuer Statistik, SOL G1
ETH (Federal Inst. Technology)	8092 Zurich	 SWITZERLAND
phone: x-41-1-632-3408		fax: ...-1086
http://www.stat.math.ethz.ch/~maechler/
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=---
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=---

From pgilbert@bank-banque-canada.ca  Fri Nov 21 16:56:25 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Fri, 21 Nov 1997 11:56:25 -0500
Subject: R-alpha: random number generator
Message-ID: <97Nov21.120108est.26518@mailgate.bank-banque-canada.ca>

>1. Is the random number generator in R the same as the one in S
>"Super-Duper")?

The random number generator is different and also the random seed length

is different. As far as I know there is no way to reproduce the same
random experiments in R that you may have performed in S (but if you
figure it out please let me know). However, in my fairly casual
experimentation the general results of random experiments tend to be the

same (good thing!).

Paul Gilbert

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=---
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=---

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Nov 21 17:45:03 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 21 Nov 1997 18:45:03 +0100
Subject: R-alpha: random number generator
In-Reply-To: <97Nov21.120108est.26518@mailgate.bank-banque-canada.ca> (message
 from Paul Gilbert on Fri, 21 Nov 1997 11:56:25 -0500)
Message-ID: <199711211745.SAA08103@sophie.ethz.ch>

Which reminds me of a remark that  Luke Tierney made a while ago,
and I very much agree with:

LT> From: Luke Tierney <luke@stat.umn.edu>
LT> Subject: Re: R-alpha: compatibility
LT> Date: Mon, 15 Sep 1997 11:55:02 -0500 (CDT)
LT> Cc: R-devel@stat.math.ethz.ch
LT> 
LT> This is one point where compatibility is not necessarily a good
LT> thing. S, like most systems, gives you no real control over the random
LT> number generator expect re-seeding. Usually this is probably good. But
LT> most simulation books recommend running any simulations you care about
LT> with two very different generators.
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Yes! -- That's why I think it would be nice if R allowed for  SEVERAL
random number generators, one of them super-duper, incidentally.
The code is basically in V&R 1 and 2; V&R2 on p.167.
I have it as a C function that I used to dyn.load into S-plus in order to
prove that S-plus was using it.
my function does NOT YET contain the ``zero skipping'' which is mentioned
in the yellow book ..

LT> Most people don't do this because
LT> one generator is usually easy to use (the built-in one in your
LT> favorite system) and anything else is impossible. Another issue that S
LT> faces has to do with running separate bits of a simulation on separate
LT> workstations. Unless you are careful, the separate bits will share
LT> parts of random number streams, and being careful is not really
LT> possible with S's generator (I think) -- it is possible but not easy
LT> with R's. (Of course overlap can be a good thing if you know you have
LT> it -- the point here is that lots of folks run separate simulations
LT> thinking they have independent runs when they probably do not in any
LT> reasonable sense).

LT> The bottom line is that it would be nice to eventually provide "power
LT> users" with more control over the random number generator system.  Now
LT> is clearly not the time to think about how to do that, but it would be
LT> unfortunate if decisions were made at this point in the name of
LT> compatibility that might limit the freedom of doing something "right"
LT> later on.

maybe the time to think about this, could be now..?
Proposals?

-- Martin M
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=---
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=---

From pgilbert@bank-banque-canada.ca  Fri Nov 21 19:32:10 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Fri, 21 Nov 1997 14:32:10 -0500
Subject: R-alpha: random number generator
References: <199711211745.SAA08103@sophie.ethz.ch>
Message-ID: <97Nov21.143456est.26524@mailgate.bank-banque-canada.ca>

>LT> The bottom line is that it would be nice to eventually provide
"power
>LT> users" with more control over the random number generator system.

>maybe the time to think about this, could be now..?
>Proposals?

Maybe there is some subtlty here that I don't understand, but is it not
possible to just add an optional argument to the functions which call
the random number generator, with the default being the current
generator?

Paul Gilbert

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=---
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=---

From bates@stat.wisc.edu  Sun Nov 23 23:32:04 1997
From: bates@stat.wisc.edu (Douglas Bates)
Date: Sun, 23 Nov 1997 17:32:04 -0600 (CST)
Subject: R-alpha: Reading a data.dump format
Message-ID: <m0xZlVU-000hh4C@franz.stat.wisc.edu>

Has anyone taken a crack at creating an R function that would read the 
data.dump format?
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=---
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=---

From Martin Maechler <maechler@stat.math.ethz.ch>  Mon Nov 24 09:49:44 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Mon, 24 Nov 1997 10:49:44 +0100
Subject: R-alpha: Reading a data.dump format
In-Reply-To: <m0xZlVU-000hh4C@franz.stat.wisc.edu> (message from Douglas Bates
 on Sun, 23 Nov 1997 17:32:04 -0600 (CST))
Message-ID: <199711240949.KAA00755@sophie.ethz.ch>

>>>>> "DougB" == Douglas Bates <bates@stat.wisc.edu> writes:

    DougB> Has anyone taken a crack at creating an R function that would
    DougB> read the data.dump format?

This has been listed as a `desideratum'
 -- something we'd all like -- for a while now.

Actually, both   data.dump and data.restore.

Any students who need a challenging home work ?  :-)
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=---
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=---

From Martin Maechler <maechler@stat.math.ethz.ch>  Mon Nov 24 13:51:13 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Mon, 24 Nov 1997 14:51:13 +0100
Subject: R-alpha: random number generator -- S-plus's
In-Reply-To: <97Nov21.164332est.26501@mailgate.bank-banque-canada.ca> (message
 from Paul Gilbert on Fri, 21 Nov 1997 16:40:01 -0500)
Message-ID: <199711241351.OAA01213@sophie.ethz.ch>

--Multipart_Mon_Nov_24_14:51:09_1997-1
Content-Type: text/plain; charset=US-ASCII


>>>>> "PaulG" == Paul Gilbert <pgilbert@bank-banque-canada.ca> writes:

    MM> The code is basically in V&R 1 and 2; V&R2 on p.167.  I have it as a
    MM> C function that I used to dyn.load into S-plus in order
    MM> to prove that S-plus was using it.

    PaulG> Could you send this to me. I'd like to try to reproduce some S
    PaulG> results in R.

Okay here is a little shar file which contains a little more;
it also includes (the S code for) my experiments on what S-plus's  set.seed(.)
does. The C code must be compiled (cc  and ld) ``a la R'' before dyn.load.

I did not yet test this in R,
but I  CC: it to R-devel since others may want to comment.

[appended at the end !]

--------------------------------------------------------

  PaulG> Maybe there is some subtlty here that I don't understand, but is it not
  PaulG> possible to just add an optional argument to the functions which call
  PaulG> the random number generator, with the default being the current
  PaulG> generator?
Reasons why I wouldn't like this:

  - There are too many of these functions;  some are quite nested;
  - adding an extra argument to them is ugly and not backwards (R-minus)
	  compatible; 
  - you shouldn't have to change the R code of your simulation, but rather
	  change a global option in order to use a different RNG.
  - You shouldn't accidentally mix two different generators, since the 
	  resulting RNG has unknown properties.be allowed t

  - It isn't too hard, to implement the more flexible scheme,
	   in the current R implementation.

>From the UI, I'd propose
to use  a function instead of  .Random.seed,

	set.random(generator = "Wichmann-Hill", seed = NULL)

The function (also when called with no arguments) returns a list with the
two components
	$generator : character(1)  giving the name of the RNG.
	$seed	   : integer vector

AND also accepts such a list as input (alternatively), i.e.

	I could
	
first)
	.R.seed <- set.random()
	## ....do simulations

later)
	set.random(.R.seed)
	## ....Re-do  simulations indentically

-------------------------------------------------------------------------------

--Multipart_Mon_Nov_24_14:51:09_1997-1
Content-Type: application/octet-stream
Content-Disposition: attachment; filename="runif.shar"
Content-Transfer-Encoding: 7bit

#!/bin/sh
# This is a shell archive (produced by GNU sharutils 4.2).
# To extract the files from this archive, save it to some FILE, remove
# everything before the `!/bin/sh' line above, then type `sh FILE'.
#
# Made on 1997-11-24 14:21 MET by <maechler@sophie>.
# Source directory was `/users/home2/staff/maechler/S/MISC'.
#
# Existing files will *not* be overwritten unless `-c' is specified.
#
# This shar contains:
# length mode       name
# ------ ---------- ------------------------------------------
#   7088 -rw-r--r-- runif-tst.S
#   3646 -rw-r--r-- setseed-ex.S
#   1132 -rw-r--r-- ../C-Progs/programs/Runif.c
#
save_IFS="${IFS}"
IFS="${IFS}:"
gettext_dir=FAILED
locale_dir=FAILED
first_param="$1"
for dir in $PATH
do
  if test "$gettext_dir" = FAILED && test -f $dir/gettext \
     && ($dir/gettext --version >/dev/null 2>&1)
  then
    set `$dir/gettext --version 2>&1`
    if test "$3" = GNU
    then
      gettext_dir=$dir
    fi
  fi
  if test "$locale_dir" = FAILED && test -f $dir/shar \
     && ($dir/shar --print-text-domain-dir >/dev/null 2>&1)
  then
    locale_dir=`$dir/shar --print-text-domain-dir`
  fi
done
IFS="$save_IFS"
if test "$locale_dir" = FAILED || test "$gettext_dir" = FAILED
then
  echo=echo
else
  TEXTDOMAINDIR=$locale_dir
  export TEXTDOMAINDIR
  TEXTDOMAIN=sharutils
  export TEXTDOMAIN
  echo="$gettext_dir/gettext -s"
fi
touch -am 1231235999 $$.touch >/dev/null 2>&1
if test ! -f 1231235999 && test -f $$.touch; then
  shar_touch=touch
else
  shar_touch=:
  echo
  $echo 'WARNING: not restoring timestamps.  Consider getting and'
  $echo "installing GNU \`touch', distributed in GNU File Utilities..."
  echo
fi
rm -f 1231235999 $$.touch
#
if mkdir _sh01181; then
  $echo 'x -' 'creating lock directory'
else
  $echo 'failed to create lock directory'
  exit 1
fi
# ============= runif-tst.S ==============
if test -f 'runif-tst.S' && test "$first_param" != -c; then
  $echo 'x -' SKIPPING 'runif-tst.S' '(file already exists)'
else
  $echo 'x -' extracting 'runif-tst.S' '(text)'
  sed 's/^X//' << 'SHAR_EOF' > 'runif-tst.S' &&
##SunOS4: print(dyn.load2("/u/maechler/C/C-for-S/Runif.o"))
print(dyn.load("/u/maechler/C/C-for-S/Runif.o"))
X.C("Init_seed",
X   Cval = as.integer(12345),
X   Tval = as.integer(987654321))
str(.C("Get_seed", Cval = integer(1), Tval = integer(1)))
X
rU_ numeric(10)
for(i in 1:10) rU[i] <- unlist(.C("Runif", numeric(1)))
rU
str(.C("Get_seed", Cval = integer(1), Tval = integer(1)))
X
Set.seed <- function(Cval = 12345, Tval =987654321)
{
X  ## Purpose: Initialize my implementation of the 'S' RNG (following Ripley)
X  ## -------------------------------------------------------------------------
X  ## Arguments: Congrval and Tausval, the 2 long integers  [== seed]
X  ## -------------------------------------------------------------------------
X  ## Author: Martin Maechler, Date:  9 May 94, 12:04
X  if(!is.loaded(C.symbol("Init_seed")))
X    dyn.load("/u/maechler/C/C-for-S/Runif.o")
X  invisible(.C("Init_seed",
X	       Cval = as.integer(Cval),
X	       Tval = as.integer(Tval)))
}
X
Runif <- function()
{
X  ## Purpose:  test my runif(.)
X  ## -------------------------------------------------------------------------
X  ## Author: Martin Maechler, Date:  9 May 94, 11:54
X  if(!is.loaded(C.symbol("Runif")))
X    dyn.load("/u/maechler/C/C-for-S/Runif.o")
X  unlist(.C("Runif", numeric(1)))
}
X
X
tst.runif <- function(Cval = 12345, Tval =987654321)
{
X  ## Purpose: test my (following Ripley) implementation of S  RNG
X  ##        return 'next' seeds
X  ## -------------------------------------------------------------------------
X  ## Arguments: Congrval and Tausval  [== seed]
X  ## -------------------------------------------------------------------------
X  ## Author: Martin Maechler, Date:  9 May 94, 12:04
X  if(!is.loaded(C.symbol("Runif")))
X    dyn.load("/u/maechler/C/C-for-S/Runif.o")
X  .C("Init_seed",
X     Cval = as.integer(Cval),
X     Tval = as.integer(Tval))
X  .C("Runif", numeric(1))
X  unlist(.C("Get_seed", Cval = integer(1), Tval = integer(1)))
}
X
###
### Test the 'standard'  .Random.seed  --- compare with  my version
###
X
tst.R.S <- function(nn)
{
X  ## Purpose:  return many .Random.seed s
X  ## -------------------------------------------------------------------------
X  ## Arguments: number
X  ## -------------------------------------------------------------------------
X  ## Author: Martin Maechler, Date:  9 May 94, 11:07
X
X  RR <- matrix(0,nrow = 12, ncol= nn)
X  for(i in 1:nn) { RR[,i] _ .Random.seed; runif(1) }
X  t(RR)
}
X
RR <- tst.R.S(2000)
summary(as.data.frame(RR))#-- Random.seed components
RRt <- apply(RR, 2, table)
RRt2 <- lapply(RRt, function(x) as.integer(names(x)))
str(RRt2, vec.len = 20)
for(j in 1:12) {
X  cat("\n j=",j, " 0:63 = R..[[j]]: ", all.equal(0:63, RRt2[[j]]))
}
X
X
X
X
X
X
##--> only   1, 6, 12  are NOT ==  0...63
## [[1]] =          1 5 9 .. 61  (( = 1 + 4*j ,  j= 0..15 ))
## [[6]] = [[12]] = 0..3
X
X
RS   <- rep(0,12)
#.Random.seed _ RS
##>> Error: Invalid random number seed: congruential part must be odd
RS[1] _ 1
X.Random.seed _ RS  #--> 1st part == congruential part !
for(i in 1:20){ print(.Random.seed); runif(1)} #- the 2nd part STAYS 0 !!
RS2 <- RS
RS2[12] _ 1
X.Random.seed _ RS2
for(i in 1:20){ print(.Random.seed); runif(1)} #- 1st part == 1st part above!
X
###==> first   6 numbers are one long integer, == congrval  (see above)
###    second  6 numbers are 2nd long integer  == tausval
X
### congrval is made up from 4 + 4* 6 + 3 = 31 bits
###                          - actually CAN use ALL odd 1:63 for [1] -> 32 bits
###  tausval is made up from     5* 6 + 3 = 33 bits (?)
X
X
###  The following  PROOFS  that  Runif(.) returns the SAME as  runif(.)
###  AND  that .Random.seed  =^=  ( Congr.val, Taus.val )
X
if(!exists("polyn.eval"))
X  polyn.eval <- function(coef, x)
X  {
X    ## Purpose: Compute coef[1] + coef[2]*x + ... + coef[p+1]* x^p
X    ## 	      x can be any array; result if of same dimensions !
X    ## Author: Martin Maechler
X    lc <- length(coef)
X    if(lc == 0) 0
X      else {
X	r <- coef[lc]
X	if(lc > 1) for(i in (lc - 1):1) r <- coef[i] + r * x
X	r
X      }
X  }
X
qR <- c( 1, rep(0,5))
X.Random.seed <- Rs <- c(qR, qR) #---  1 0 0 0 0 0  1 0 0 0 0 0
Set.seed(1,1)
for (i in 1:100) {
X  CT <- unlist(.C("Get_seed", Cval = integer(1), Tval = integer(1)))
X  RS.C <- .Random.seed[1:6]
X  RS.T <- .Random.seed[1:6 +6]
X  cat(i,": ")
X  ##print(c(CT, RS.C = RS.C, RS.T = RS.T))
X  if(CT["Cval"]<0) { CT["Cval"] <- 2^32 + CT["Cval"]
X		     cat("'Cval' corrected by adding 2^32\n") }
X  if(CT["Tval"]<0) { CT["Tval"] <- 2^32 + CT["Tval"]
X		     cat("'Tval' corrected by adding 2^32\n") }
X  if(CT["Cval"] != polyn.eval(RS.C, 2^6)) stop("'Congr.val' do not match!")
X  if(CT["Tval"] != polyn.eval(RS.T, 2^6)) stop(" 'Taus.val' do not match!")
X  u1 <- runif(1)
X  u2 <- Runif()
X  if((u1-u2)!=0) stop("u1 != u2")
}
X
X
X.Random.seed <- Rs <- c(qR, qR) #---  1 0 0 0 0 0  1 0 0 0 0 0
Set.seed(1,1)
X
runif(1)
##> [1] 4.659873e-05
Runif()
##> [1] 4.659873e-05
unlist(.C("Get_seed", Cval = integer(1), Tval = integer(1)))
##>   Cval   Tval
##>  69069 131073
X.Random.seed
##>  [1] 13 55 16  0  0  0  1  0 32  0  0  0
X
Runif()
##> [1] 0.1106027
runif(1)
##> [1] 0.1106027
unlist(.C("Get_seed", Cval = integer(1), Tval = integer(1)))
##>       Cval   Tval
##>  475559465 524293
X.Random.seed
##>  [1] 41 24  7 22 28  0  5  0  0  2  0  0
X
X
### --- finding out things about   set.seed(.) -----
X
for(i in 0:1100){
X  cat("set.seed(i=",formatC(i,dig=4),") -> .Random.s = "); set.seed(i)
X  cat(format(.Random.seed),"\n")
}
##- set.seed(i=     0 ) -> .Random.s = 21 14 49   32 43  1   32 22 36 23 28  3
##- set.seed(i=     1 ) -> .Random.s = 21 14 49   48 24  1   32 22 36 23 28  3
##- set.seed(i=     2 ) -> .Random.s = 21 14 49    0  6  1   32 22 36 23 28  3
##- set.seed(i=     3 ) -> .Random.s = 21 14 49   16 51  0   32 22 36 23 28  3
##- set.seed(i=     4 ) -> .Random.s = 21 14 49   32 32  0   32 22 36 23 28  3
##- set.seed(i=     5 ) -> .Random.s = 21 14 49   48 13  0   32 22 36 23 28  3
##- set.seed(i=     6 ) -> .Random.s = 21 14 49    0 59  3   32 22 36 23 28  3
##- set.seed(i=     7 ) -> .Random.s = 21 14 49   16 40  3   32 22 36 23 28  3
##- .........
##-          			      [ 1  2  3    4  5  6    7  8  9 10 12 12 ]
###--> only  [4:6]  really change !!
###- They have  6 + 6 + 2 = 14  bits each (the ranges are 0:63, 0:63, and 0:3),
###- i.e.,  2^14 = 16384  different possibilities.
###-        ~~~~   ~~~~~
###===>  Period of  set.seed(.) =: P | 2^14
X
## test this period
tst.sseed <- function(i)
{
X  ## Purpose:  test  set.seed(.)
X  ## -------------------------------------------------------------------------
X  ## Author: Martin Maechler, Date:  9 May 94, 11:54
X  set.seed(i)
X  .Random.seed
}
X
for (i in c(0:7, 11, 17, 20, 23, 40, 53, 59, 67, 76, 97)) {
X  cat("i=",i,": ")
X  print(all.equal(tst.sseed(i), tst.sseed(i + 2^ 14)))
}
##--> all  'TRUE'
##
## same thing for  2^13, 2^12, 2^11, 2^10 ! --
##
## Test a full period for  2^10 = 1024 :
X
for (i in 0:(2^10 - 1))
X  if(!is.all.equal(tst.sseed(i), tst.sseed(i + 2^ 10)))
X  cat("i=",i," DIFFERENT ! ")
## -> nothing (i.e., all equal !)
X
###==> Full period is from  set.seed(0) to  set.seed(1023) ! --
SHAR_EOF
  $shar_touch -am 1124142097 'runif-tst.S' &&
  chmod 0644 'runif-tst.S' ||
  $echo 'restore of' 'runif-tst.S' 'failed'
  if ( md5sum --help 2>&1 | grep 'sage: md5sum \[' ) >/dev/null 2>&1 \
  && ( md5sum --version 2>&1 | grep -v 'textutils 1.12' ) >/dev/null; then
    md5sum -c << SHAR_EOF >/dev/null 2>&1 \
    || $echo 'runif-tst.S:' 'MD5 check failed'
35e91fce41f56de76bab514ecfc5c840  runif-tst.S
SHAR_EOF
  else
    shar_count="`LC_ALL= LC_CTYPE= LANG= wc -c < 'runif-tst.S'`"
    test 7088 -eq "$shar_count" ||
    $echo 'runif-tst.S:' 'original size' '7088,' 'current size' "$shar_count!"
  fi
fi
# ============= setseed-ex.S ==============
if test -f 'setseed-ex.S' && test "$first_param" != -c; then
  $echo 'x -' SKIPPING 'setseed-ex.S' '(file already exists)'
else
  $echo 'x -' extracting 'setseed-ex.S' '(text)'
  sed 's/^X//' << 'SHAR_EOF' > 'setseed-ex.S' &&
###--> See also (the much OLDER)  ./runif-tst.S
###				  ~~~~~~~~~~~~~
X
ss <- function(i) { set.seed(i); .Random.seed }
s0 <- ss(0)
for(i in -1000:4000)
X if(any(ss(i)[-(4:6)] != s0[-(4:6)])) cat("i=",i," .R.s=",.Random.seed,"\n")
##--> no output, i.e., it's really
##    only .Random.seed[c(4,5,6)] which are modified by set.seed(.)
X
ni <- length(i.set <- -2:2000)
m456 <- matrix(NA, ni, 3, dimnames=list(paste(i.set),paste(4:6)))
for(i in i.set)  m456[paste(i),] <- ss(i)[4:6]
t(m456[1:25,])
X
apply(m456, 2,  function(x) sort(unique(x)))
##- $"4":
##- [1]  0 16 32 48
##-
##- $"5":
##-[1]  0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23
##[25] 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47
##[49] 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63
##-
##- $"6":
##- [1] 0 1 2 3
len456 <- apply(m456, 2,  function(x) length(unique(x)))
len456
prod(len456) #-- 1024 : no more than these many different
X
d456 <- dim(table(m456[,"4"], m456[,"5"], m456[,"6"]))#- and these all appear ..
d456
d456 == len456 # Yes !
X
all(m456[,"4"] == rep(16*(0:3), length=ni))#-> TRUE
X
for(i in -4:10) print(ss(i)[4] == 16*(i+2)%%4)
X
table(m456[,"6"]) #-- only 0, 1, 2, 3, but not as regularly ...
##-    0   1   2   3
##-  502 501 500 500
X
##---- mI  contains .Random.seed[4:6]  after set.seed(i = 1:1024) : ----
mI <- m456[paste(1:1024),]
dim(table(mI[,"4"], mI[,"5"], mI[,"6"]))#- and these all appear ..
X
all(ss(0) == ss(1024)) #-- TRUE
for(i in -100:2000)
X   if(any(ss(i) != ss(i + 1024))) cat("i=",i," .R.s=",.Random.seed,"\n")
#- no output, i.e., it's true
X
# the part of the 'congrval'
all(table(mI %*% 2^(6*0:2)) == 1)# TRUE
X
X
## Return 'congrval' part of .Random.seed after  set.seed(.):
## need 'polyn.eval' from my goodies:
ssC <- function(i){ set.seed(i);polyn.eval(.Random.seed[  1:6],2^6)}
ssT <- function(i){ set.seed(i);polyn.eval(.Random.seed[6+1:6],2^6)}
X
##-- All the 'congrval' that set.seed(.) produces ..
Cs <- ii <- 1:1024
for(i in ii) Cs[i] <- ssC(i)
dim(tCs <- table(Cs))# = 1024
all(tCs == 1) # TRUE  (each once)
X
summary(Cs / 2^32)
##-       Min. 1st Qu. Median   Mean 3rd Qu.   Max.
##-  4.694e-05  0.2498 0.4996 0.4996  0.7493 0.9991
X
dCs <- unique(diff(srt.C <- sort(Cs)))
dCs##->  4194304  only one value !
log(dCs, base =2)# == 22
X
C1 <- srt.C[1]
all(srt.C == C1 + (ii-1) * 2^22) #- TRUE !
X
## the values are not quite symmetrical in {0,..,2^32-1} :
2^32 - srt.C[1024]# 3992683
C1                #  201621
X
###------------ Martin Mchler's Summary : ------------------------
X
###--- Mon, Sept. 15, 1997 ----------
X
##- Unfortunately, we don't know what exactly happens in
##- the S-plus code for set.seed(i), namely,  .C("setseed", as.integer(i))
##- However, I have found out the following which should suffice :
##-
##-  1) Only .Random.seed[4:6]  are varyied by set.seed, i.e.,
##-    after set.seed(i), .Random.seed always is
##-
##-            1  2  3  4  5  6  7  8  9 10 11 12
##-       [1] 21 14 49  *  *  * 32 22 36 23 28  3
##-                    X4 X5 X6
##-
##- which means that only the 'congrval' {Venables & Ripley, 2nd ed., p.166-167}
##-    is varied
##-
##-  2) X4 is always ==  16*((i+2) %% 4)
##-     X5 takes (all) values in 0:63  [also with some periodicity]
##-     X6 takes the values of 0:3
##-
##-  3) set.seed(i) <==> set.seed(i + n*1024)  for all integers n, i
##-
##-  4) { set.seed(i) ;  i \in {integers}}
##-     results in a set of 1024 different values of 'congrval'.
##-     These values are EXACTLY EQUISPACED lying in {0,..,2^32}.
##-
##-     If C[1:1024] are these sorted values, we have
##-
##- 	C[i] == 201621 + (i-1)* 2^22  , for i in 1:1024
##-
X
SHAR_EOF
  $shar_touch -am 1124095797 'setseed-ex.S' &&
  chmod 0644 'setseed-ex.S' ||
  $echo 'restore of' 'setseed-ex.S' 'failed'
  if ( md5sum --help 2>&1 | grep 'sage: md5sum \[' ) >/dev/null 2>&1 \
  && ( md5sum --version 2>&1 | grep -v 'textutils 1.12' ) >/dev/null; then
    md5sum -c << SHAR_EOF >/dev/null 2>&1 \
    || $echo 'setseed-ex.S:' 'MD5 check failed'
c2d03d4318c03a8f2ed8b4f0b656c647  setseed-ex.S
SHAR_EOF
  else
    shar_count="`LC_ALL= LC_CTYPE= LANG= wc -c < 'setseed-ex.S'`"
    test 3646 -eq "$shar_count" ||
    $echo 'setseed-ex.S:' 'original size' '3646,' 'current size' "$shar_count!"
  fi
fi
# ============= ../C-Progs/programs/Runif.c ==============
if test ! -d '..'; then
  $echo 'x -' 'creating directory' '..'
  mkdir '..'
fi
if test ! -d '../C-Progs'; then
  $echo 'x -' 'creating directory' '../C-Progs'
  mkdir '../C-Progs'
fi
if test ! -d '../C-Progs/programs'; then
  $echo 'x -' 'creating directory' '../C-Progs/programs'
  mkdir '../C-Progs/programs'
fi
if test -f '../C-Progs/programs/Runif.c' && test "$first_param" != -c; then
  $echo 'x -' SKIPPING '../C-Progs/programs/Runif.c' '(file already exists)'
else
  $echo 'x -' extracting '../C-Progs/programs/Runif.c' '(text)'
  sed 's/^X//' << 'SHAR_EOF' > '../C-Progs/programs/Runif.c' &&
/*--- this code is from a posting of
X  Brian Ripley to the S-news, 7 Aug 92,
X  and a slight correction from  Allen Mcintosh <mcintosh@larch.bellcore.com>
X  + a correction of mine (B.R. wrote '69096' instead of '69069'))
X
X  -->  /u/maechler/tex/o.peopl/Ripley-S-RNG.tex
*/
X
/*--- This code is perfectly tested out via S-code
X
X  in -->  /u/maechler/S/MISC/runif-tst.S
*/
X
unsigned long congr_MM, taus_MM;
X
static double xuni()
{
X        unsigned long n, lambda = 69069;
X        congr_MM *= lambda;
X        taus_MM  ^= taus_MM >> 15;
X        taus_MM  ^= taus_MM << 17;
/* Orig (Splus <= 3.2):
X        n = taus_MM ^ congr_MM;
X        return ( (n>>1) / 2147483648.);
X * New: */
X        n = (taus_MM ^ congr_MM) >> 1;
X        if(n) { /* n != 0 */ return( n / 2147483648.);
X	} else return(xuni());
}
X
X
/*--- The following are to be  dyn.load(..)ed   and called  from  S(plus) --*/
X
void Runif (double* res) {  *res = xuni(); }
X
void Init_seed (long* Cval, long* Tval)
{
X  congr_MM = (unsigned long)*Cval;
X  taus_MM  = (unsigned long)*Tval;
}
X
void Get_seed (long* Cval, long* Tval)
{
X  *Cval = (long) congr_MM;
X  *Tval = (long) taus_MM;
}
SHAR_EOF
  $shar_touch -am 1124141497 '../C-Progs/programs/Runif.c' &&
  chmod 0644 '../C-Progs/programs/Runif.c' ||
  $echo 'restore of' '../C-Progs/programs/Runif.c' 'failed'
  if ( md5sum --help 2>&1 | grep 'sage: md5sum \[' ) >/dev/null 2>&1 \
  && ( md5sum --version 2>&1 | grep -v 'textutils 1.12' ) >/dev/null; then
    md5sum -c << SHAR_EOF >/dev/null 2>&1 \
    || $echo '../C-Progs/programs/Runif.c:' 'MD5 check failed'
f5888c70e55b647a34d8bee3aae3b4ad  ../C-Progs/programs/Runif.c
SHAR_EOF
  else
    shar_count="`LC_ALL= LC_CTYPE= LANG= wc -c < '../C-Progs/programs/Runif.c'`"
    test 1132 -eq "$shar_count" ||
    $echo '../C-Progs/programs/Runif.c:' 'original size' '1132,' 'current size' "$shar_count!"
  fi
fi
rm -fr _sh01181
exit 0

--Multipart_Mon_Nov_24_14:51:09_1997-1
Content-Type: text/plain; charset=US-ASCII



--Multipart_Mon_Nov_24_14:51:09_1997-1--
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=---
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=---

From Martin Maechler <maechler@stat.math.ethz.ch>  Wed Nov 26 08:27:32 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 26 Nov 1997 09:27:32 +0100
Subject: R-alpha: Re: R-beta: Latin-1 characters (and "=-=" footer and MIME...)
In-Reply-To: <x2g1oklqxg.fsf@blueberry.kubism.ku.dk> (message from Peter
 Dalgaard BSA on 25 Nov 1997 20:22:19 +0100)
Message-ID: <199711260827.JAA00479@sophie.ethz.ch>

=09[redirected to R-devel;  does NOT belong anymore into R-help]

>>>>> "PD" =3D=3D Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk> writes:

    PD> Martin Maechler <maechler@stat.math.ethz.ch> writes:

    >>  You didn't say which version of R you are using;
    >> 
    >> It is true that 0.50-a4 still doesn't properly work with these.
    >> However, I though Windows "Rsept" was somewhat newer...
    >> 
    >> Anyway, in current source (unreleased) version, it's all nice :
=09MM> > M=E4chler <- 1:3
=09MM> > ls(pat=3D"^M")
=09MM> [1] "M=E4chler"
=09MM> > M=E4chler
=09MM> [1] 1 2 3


    PD> This seems to be wandering in and out of the sources. The snapshot
    PD> I've been using does

    >> =F8

    PD> Save workspace image? [y/n/c]:

    PD> - but I'm pretty sure an *earlier* one (0.49?) did do Latin1. How
    PD> about adding this to your set of regression tests, so that it
    PD> becomes possible to detect whenever the source tree gets modified?
Ok, I'll think about doing this.


ISO-Latin1 Characters (current source, not yet 0.50): 
~~~~~~~~~~~~~~~~~~~~~

 1) Everything seems ok, if they are used in  strings (and comments)

 2) If you use them as [language] symbols, things are different :
=09

> =D6
[1] 0
> =C4
[1] 0
> =FC
Error: syntax error
=09=09=09--- so `=FC' is different from `=E4' ...
> =E4
[1] 0
> =E4 <- 1
Error in 0 <- 1 : invalid (do_set) left-hand side to assignment


> =F2
Error: Object "=F2" not found
> =B5
Error: syntax error
> =AE
Error: Object "=AE" not found
> =AB
Error: syntax error
> "=ABQuoted=BB text"
[1] "=ABQuoted=BB text"
> =FE
Error: syntax error
> "=FE"
[1] "=FE"
> =F8
Error: syntax error
> "=F8"
[1] "=F8"
> nchar("=F8")
[1] 1

---------------------- etc. ---------------------------

Point is: 
=09It's not quite clear which ISO-latin1 characters should 
=09belong to the set of characters which can be used in R symbols
=09{this is not the same as R object names,
=09 which can contain everything, using  assign(..) and  get(..)}

Note that in S-plus,  ONLY  ASCII characters valid  symbol names,

I think, all the following should be allowed  symbol components,
to make  R  really  ``nicely usable'' for  European-Language users

  A.accents <- "=E0=E1=E2=E3=E4=E5=E6 =C0=C1=C2=C3=C4=C5=C6" # `a 'a ^a "a =
oa ae  `A 'A ^A "A oA AE
  EI.accents <- "=C8=C9=CA=CB=CC=CD=CE=CF =E8=E9=EA=EB=EC=ED=EE=EF"# =3D `E=
 'E ^E "E  `I 'I .....
  O.accents <- "=D2=D3=D4=D5=D6=D8=F2=F3=F4=F5=F6=F8"
  U.accents <- "=D9=DA=DB=DC=DD=F9=FA=FB=FC=FD"
## I did not include the two islandic
  Islandic <- "=D0=F0" # maybe we should

------------------------
R & R, any comments?
------------------------



    PD> And BTW, yes, your message became "malformed quoted printable"
    PD> because of the =3D-=3D- pattern in the footer. May I suggest we qui=
etly
    PD> change "=3D" to "+" or "~" (while equally quietly cursing the MIME
    PD> standard mess...)

Ok, just done it (change and polite curse).  You should see it now..

- Martin
_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_---
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_---

From p.dalgaard@biostat.ku.dk  Wed Nov 26 10:24:02 1997
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 26 Nov 1997 11:24:02 +0100
Subject: R-alpha: Re: R-beta: Latin-1 characters (and "=-=" footer and MIME...)
In-Reply-To: Martin Maechler's message of Wed, 26 Nov 1997 09:27:32 +0100
References: <199711260827.JAA00479@sophie.ethz.ch>
Message-ID: <x2wwhweywt.fsf@blueberry.kubism.ku.dk>

Martin Maechler <maechler@stat.math.ethz.ch> writes:

>   A.accents <- "=E0=E1=E2=E3=E4=E5=E6 =C0=C1=C2=C3=C4=C5=C6" # `a 'a ^=
a "a oa ae  `A 'A ^A "A oA AE
>   EI.accents <- "=C8=C9=CA=CB=CC=CD=CE=CF =E8=E9=EA=EB=EC=ED=EE=EF"# =3D=
 `E 'E ^E "E  `I 'I .....
>   O.accents <- "=D2=D3=D4=D5=D6=D8=F2=F3=F4=F5=F6=F8"
>   U.accents <- "=D9=DA=DB=DC=DD=F9=FA=FB=FC=FD"
> ## I did not include the two islandic
>   Islandic <- "=D0=F0" # maybe we should
>=20

Given R's habit of using symbol names in plots, anything occurring in
any Latin1-language should be there (I've seen too many manglings of
the Danish language for 7-bit programs, that I'd pass the opportunity
to get it done right in R). The above lists misses n-tilde (=F1) and
c-cedilla (=E7). I dont see anything harmful in including the whole
"upper ascii" part (characters 160-255, at least) as symbols.

> ------------------------
> R & R, any comments?
> ------------------------


--=20
   O__  ---- Peter Dalgaard             Blegdamsvej 3 =20
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N  =20
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Wed Nov 26 10:47:19 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 26 Nov 1997 11:47:19 +0100
Subject: R-alpha:  Latin-1 characters (3)
In-Reply-To: <x2wwhweywt.fsf@blueberry.kubism.ku.dk> (message from Peter
 Dalgaard BSA on 26 Nov 1997 11:24:02 +0100)
Message-ID: <199711261047.LAA00657@sophie.ethz.ch>

>>>>> "PD" =3D=3D Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk> writes:

    PD> Martin Maechler <maechler@stat.math.ethz.ch> writes:
    >> A.accents <- "=E0=E1=E2=E3=E4=E5=E6 =C0=C1=C2=C3=C4=C5=C6" # `a 'a ^=
a "a oa ae  `A 'A ^A "A oA AE
    >> EI.accents <- "=C8=C9=CA=CB=CC=CD=CE=CF =E8=E9=EA=EB=EC=ED=EE=EF"# =
=3D `E 'E ^E "E  `I 'I .....
    >> O.accents <- "=D2=D3=D4=D5=D6=D8=F2=F3=F4=F5=F6=F8"
    >> U.accents <- "=D9=DA=DB=DC=DD=F9=FA=FB=FC=FD"
    >> ## I did not include the two islandic
    >> Islandic <- "=D0=F0" # maybe we should
    >> 

    PD> Given R's habit of using symbol names in plots, anything occurring =
in
    PD> any Latin1-language should be there (I've seen too many manglings o=
f
    PD> the Danish language for 7-bit programs, that I'd pass the opportuni=
ty
    PD> to get it done right in R). The above lists misses n-tilde (=F1) an=
d
    PD> c-cedilla (=E7).
and '=DF'  (we don't use it in Switzerland; 
=09  it's ``just'' the Germans and Austrians .... :-)

 
    PD> I dont see anything harmful in including the whole
    PD> "upper ascii" part (characters 160-255, at least) as symbols.

are you serious,  including  160 =3D octal 240 ?
Would you want legal syntax such as

=09=B1=B4=B4 <- 1:3


Here is an excerpt of a file I wrote a few years ago:

All-L1> Note that \240 is VERY funny "invisible", 
All-L1> makes things reversevideo/invisible/!@#!  depending on Emacs versio=
n.
All-L1> For this reason, I  OMIT it in the following [Enter it with ^Q240]:
All-L1> 
All-L1> Dec Oct               Dec Oct 
All-L1>           =A1=A2=A3=A4=A5=A6=A7                =A8=A9=AA=AB=AC=AD=
=AE=AF
All-L1> 160 240: 01234567     168 250:   01234567
All-L1>                      
All-L1>          =B0=B1=B2=B3=B4=B5=B6=B7                =B8=B9=BA=BB=BC=BD=
=BE=BF
All-L1> 176 260: 01234567     184 270:   01234567
All-L1>                      
All-L1>          =C0=C1=C2=C3=C4=C5=C6=C7                =C8=C9=CA=CB=CC=CD=
=CE=CF
All-L1> 192 300: 01234567     200 310:   01234567
All-L1>                      
All-L1>          =D0=D1=D2=D3=D4=D5=D6=D7                =D8=D9=DA=DB=DC=DD=
=DE=DF
All-L1> 208 320: 01234567     216 330:   01234567
All-L1>                      
All-L1>          =E0=E1=E2=E3=E4=E5=E6=E7                =E8=E9=EA=EB=EC=ED=
=EE=EF
All-L1> 224 340: 01234567     232 350:   01234567
All-L1>                      
All-L1>          =F0=F1=F2=F3=F4=F5=F6=F7                =F8=F9=FA=FB=FC=FD=
=FE=FF
All-L1> 240 360: 01234567     248 370:   01234567


Given this table, I'd say  192-255 [dec] =3D 300-377 [okt],
maybe excluding   =D7 and =F7 ..



    >> ------------------------
    >> R & R, any comments?
    >> ------------------------

(when you get up to a new day.. find all these funny symbols in your
 mail box ..)

-- Martin

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Wed Nov 26 11:14:35 1997
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 26 Nov 1997 12:14:35 +0100
Subject: R-alpha:  Latin-1 characters (3)
In-Reply-To: Martin Maechler's message of Wed, 26 Nov 1997 11:47:19 +0100
References: <199711261047.LAA00657@sophie.ethz.ch>
Message-ID: <x2vhxfgb50.fsf@blueberry.kubism.ku.dk>

Martin Maechler <maechler@stat.math.ethz.ch> writes:

> are you serious,  including  160 =3D octal 240 ?
> Would you want legal syntax such as
>=20
> =09=B1=B4=B4 <- 1:3

Maybe use the circled c (=A9) as a variable containing the GNU Copyleft
message? ;)

But how about =B5l.H2O ?

Question is, would it harm anything (except legibility)? And in a
slightly longer run, what about other ISO character sets (e.g. Latin2,
used in Slavic parts of Eastern Europe and Cyrillic). Do they have
punctuation in the same places? As long as there's no technical reason
to forbid it, why not allow it? I don't suppose we plan to use any of
the characters as syntax elements, do we? (And why am I speaking in
questions today?)

>=20
> Here is an excerpt of a file I wrote a few years ago:
>=20
> All-L1> Note that \240 is VERY funny "invisible",=20
> All-L1> makes things reversevideo/invisible/!@#!  depending on Emacs v=
ersion.
> All-L1> For this reason, I  OMIT it in the following [Enter it with ^Q=
240]:

This is curious. It's supposed to represent non-breakable space --
which might actually make it a rather useful item.

> Given this table, I'd say  192-255 [dec] =3D 300-377 [okt],
> maybe excluding   =D7 and =F7 ..


>     >> ------------------------
>     >> R & R, any comments?
>     >> ------------------------
>=20
> (when you get up to a new day.. find all these funny symbols in your
>  mail box ..)

<grin>

--=20
   O__  ---- Peter Dalgaard             Blegdamsvej 3 =20
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N  =20
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ihaka@stat.auckland.ac.nz  Wed Nov 26 19:35:05 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Thu, 27 Nov 1997 08:35:05 +1300 (NZDT)
Subject: R-alpha:  Latin-1 characters (3)
Message-ID: <199711261935.IAA09097@stat1.stat.auckland.ac.nz>

	>> ------------------------
	>> R & R, any comments?
	>> ------------------------

At present the parser makes the decision on what characters can go into
symbol names based on isalpha(c).  If someone will send me a function -
say isidchar(c) which returns 1 for characters which can be in
identifiers and 0 otherwise, I will replace the current test with that.

	Ross
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Wed Nov 26 21:46:45 1997
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 26 Nov 1997 22:46:45 +0100
Subject: R-alpha:  Latin-1 characters (3)
In-Reply-To: Ross Ihaka's message of Thu, 27 Nov 1997 08:35:05 +1300 (NZDT)
References: <199711261935.IAA09097@stat1.stat.auckland.ac.nz>
Message-ID: <x2pvnn2ure.fsf@blueberry.kubism.ku.dk>

Ross Ihaka <ihaka@stat.auckland.ac.nz> writes:

>=20
> =09>> ------------------------
> =09>> R & R, any comments?
> =09>> ------------------------
>=20
> At present the parser makes the decision on what characters can go int=
o
> symbol names based on isalpha(c).  If someone will send me a function =
-
> say isidchar(c) which returns 1 for characters which can be in
> identifiers and 0 otherwise, I will replace the current test with that=
.
>=20
> =09Ross

Ahaaa... So the "oscillatory behaviour" is just me shifting between
machines with proper locale configuration and machines without it! I
think that isalpha() is actually the way to go. People just have to
get their locales right. Here's what's in isalpha(c)=3D=3D1 for the da_D=
K
locale:

ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz=AD
=C0=C1=C2=C3=C4=C5=C6=C7=C8=C9=CA=CB=CC=CD=CE=CF=D0=D1=D2=D3=D4=D5=D6=D8=
=D9=DA=DB=DC=DD=DE=DF=E0=E1=E2=E3=E4=E5=E6=E7=E8=E9=EA=EB=EC=ED=EE=EF=F0=
=F1=F2=F3=F4=F5=F6=F8=F9=FA=FB=FC=FD=FE=FF

The hyphen following 'z' is actually 0xad (soft hyphen).

--=20
   O__  ---- Peter Dalgaard             Blegdamsvej 3 =20
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N  =20
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Thu Nov 27 09:35:06 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Thu, 27 Nov 1997 10:35:06 +0100
Subject: R-alpha:  Latin-1 characters / Locale etc.
In-Reply-To: <x2pvnn2ure.fsf@blueberry.kubism.ku.dk> (message from Peter
 Dalgaard BSA on 26 Nov 1997 22:46:45 +0100)
Message-ID: <199711270935.KAA03092@sophie.ethz.ch>

>>>>> "PD" =3D=3D Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk> writes:

    PD> Ross Ihaka <ihaka@stat.auckland.ac.nz> writes:
    >>  >> ------------------------ >> R & R, any comments?  >>
    >> ------------------------
    >> 
    >> At present the parser makes the decision on what characters can go
    >> into symbol names based on isalpha(c).  If someone will send me a
    >> function - say isidchar(c) which returns 1 for characters which can
    >> be in identifiers and 0 otherwise, I will replace the current test
    >> with that.
    >> 
    >> Ross

Hmm, so we would follow the Unix locale philosophy.
I could live with it.

It has however, a distinct drawback:

You can write R code which works with R compiled in one environment but
fails with --identical R source code-- compiled in a different environment.

While this is true for things like 'readline' and 'proc.time / system.time'=
,
I don't like it so much for such a basic things as symbol characters.


    PD> Ahaaa... So the "oscillatory behaviour" is just me shifting between
    PD> machines with proper locale configuration and machines without it!
    PD> I think that isalpha() is actually the way to go. People just have
    PD> to get their locales right. Here's what's in isalpha(c)=3D=3D1 for =
the
    PD> da_DK locale:

    PD> ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz=AD
    PD> =C0=C1=C2=C3=C4=C5=C6=C7=C8=C9=CA=CB=CC=CD=CE=CF=D0=D1=D2=D3=D4=D5=
=D6=D8=D9=DA=DB=DC=DD=DE=DF=E0=E1=E2=E3=E4=E5=E6=E7=E8=E9=EA=EB=EC=ED=EE=EF=
=F0=F1=F2=F3=F4=F5=F6=F8=F9=FA=FB=FC=FD=FE=FF

    PD> The hyphen following 'z' is actually 0xad (soft hyphen).


In any case, I'd propose a new  
=09function 'alphachars()' 
and/or a global variable 
=09Alphachars
or=09.Symbolchars
(or something better)
which returns a vector of nchar(1)-characters
giving the available symbols.

In=09../library/base/Alpha.Rd  (the accompanying help page),
all this would then be explained to users.

BTW, Peter D., do you have a (electronical form of a) document available
which nicely explains the  locale stuff (for a user, not a C-programmer ..)=
.
 Kurt/Fritz/???: I think there are some nice pages available in Linux.somet=
hing 

----------------------------------------
I'm still wondering:
The  only locale thing we have is (the environment variable)

=09LC_CTYPE=3Diso_8859_1

But then I wonder why I saw the difference between  =E4 and =FC 
that I reported ....

- Martin=
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From phlamber@luc.ac.be  Thu Nov 27 10:02:26 1997
From: phlamber@luc.ac.be (Philippe Lambert)
Date: Thu, 27 Nov 1997 11:02:26 +0100 (MET)
Subject: R-alpha: RData in batch
Message-ID: <Pine.OSF.3.96.971127103915.13153A-100000@alpha>

Just a word to mention that I have lost 2 hours yesterday to find out why
R refused to use a function from a package calling C-code.
R invariably answered that the C code was not in the load table (something
like this). I have tried everything (or nearly) to solve my problem
knowing that this same package used to work on my computer at the
university.
Finally, I found out that running the same instructions as root work fine.
The explanation for my computer sudden good will is not that I was root,
but that I ran R in a different directory ... without .RData!!
(and I don't care about .RData when I use R in batch mode!!).

Thus, 
would it be possible to have R not creating .RData file by default in
batch mode?

A second potential problem: when I build packages including personal
functions, I use to test my functions interactively by typing
library(mypackage) after modification of my code in an editor.
The problem is that repeating the library load does not erase the old
version. Do I do something wrong?


Philippe


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Thu Nov 27 10:09:40 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Thu, 27 Nov 1997 11:09:40 +0100
Subject: R-alpha: RData in batch
In-Reply-To: <Pine.OSF.3.96.971127103915.13153A-100000@alpha> (message from
 Philippe Lambert on Thu, 27 Nov 1997 11:02:26 +0100 (MET))
Message-ID: <199711271009.LAA03190@sophie.ethz.ch>

>>>>> "Philippe" == Philippe Lambert <phlamber@luc.ac.be> writes:

    Philippe> Just a word to mention that I have lost 2 hours yesterday to
    Philippe> find out why R refused to use a function from a package
    Philippe> calling C-code.  R invariably answered that the C code was
    Philippe> not in the load table (something like this). I have tried
    Philippe> everything (or nearly) to solve my problem knowing that this
    Philippe> same package used to work on my computer at the university.
    Philippe> Finally, I found out that running the same instructions as
    Philippe> root work fine.  The explanation for my computer sudden good
    Philippe> will is not that I was root, but that I ran R in a different
    Philippe> directory ... without .RData!!  (and I don't care about
    Philippe> .RData when I use R in batch mode!!).

    Philippe> Thus, would it be possible to have R not creating .RData file
    Philippe> by default in batch mode?

Most of us (I think) don't like your proposal;
.RData is the only thing to prevent losses of hours of computation
(simulation runs). 

If you want to make sure that a .RData is not interfering at the START of
your batch job, just do
(in a 'sh' script, or even better, in the Makefile, I'd recommend using):

	if [ -f .RData ]; mv .RData .RData.old; fi
	R < input.R > output.Rout


    Philippe> A second potential problem: when I build packages including
    Philippe> personal functions, I use to test my functions interactively
    Philippe> by typing library(mypackage) after modification of my code in
    Philippe> an editor.  The problem is that repeating the library load
    Philippe> does not erase the old version. Do I do something wrong?

library(.) tries to make sure to be efficient and not load the same things
twice. (--> online help  ?library ).
In the case where you are constantly changing / upgrading a library,
you should just work with  source(.)

Martin
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Friedrich.Leisch@ci.tuwien.ac.at  Thu Nov 27 10:14:51 1997
From: Friedrich.Leisch@ci.tuwien.ac.at (Friedrich Leisch)
Date: Thu, 27 Nov 1997 11:14:51 +0100
Subject: R-alpha: RData in batch
In-Reply-To: <Pine.OSF.3.96.971127103915.13153A-100000@alpha>
References: <Pine.OSF.3.96.971127103915.13153A-100000@alpha>
Message-ID: <199711271014.LAA27212@galadriel.ci.tuwien.ac.at>

>>>>> On Thu, 27 Nov 1997 11:02:26 +0100 (MET),
>>>>> Philippe Lambert (PL) wrote:

PL> Just a word to mention that I have lost 2 hours yesterday to find out=
 why
PL> R refused to use a function from a package calling C-code.
PL> R invariably answered that the C code was not in the load table (some=
thing
PL> like this). I have tried everything (or nearly) to solve my problem
PL> knowing that this same package used to work on my computer at the
PL> university.
PL> Finally, I found out that running the same instructions as root work =
fine.
PL> The explanation for my computer sudden good will is not that I was ro=
ot,
PL> but that I ran R in a different directory ... without .RData!!
PL> (and I don't care about .RData when I use R in batch mode!!).

There was a bug in dynamic loading by libraries ... the load-table was
written to the .RData file, so R didn't reload any dynamic code after
starting R a second time in a directory upon the library(...) command.
This bug is already fixed in the current sources (which are not
publicly available yet but should be out soon).


PL> Thus,=20
PL> would it be possible to have R not creating .RData file by default in
PL> batch mode?

Why don't you simply rename or delete the .Rdata file before you start
the batch simulation?


PL> A second potential problem: when I build packages including personal
PL> functions, I use to test my functions interactively by typing
PL> library(mypackage) after modification of my code in an editor.
PL> The problem is that repeating the library load does not erase the old
PL> version. Do I do something wrong?

Well, the idea of the library command is to be ``smart'' when loading
code, i.e., library first looks if the package has already been loaded
and only loads the code when this is not already loaded. This way the
overhead of loading the same stuff over and over again can be avoided.

Use source() if you want to override this.


Best,
Fritz

--=20
-------------------------------------------------------------------
                        Friedrich  Leisch                            =20
Institut f=FCr Statistik                      Tel: (+43 1) 58801 4541
Technische Universit=E4t Wien                 Fax: (+43 1)  504 14 98
Wiedner Hauptstra=DFe 8-10/1071      Friedrich.Leisch@ci.tuwien.ac.at
A-1040 Wien, Austria             http://www.ci.tuwien.ac.at/~leisch
     PGP public key http://www.ci.tuwien.ac.at/~leisch/pgp.key
-------------------------------------------------------------------

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From jlindsey@luc.ac.be  Thu Nov 27 11:02:08 1997
From: jlindsey@luc.ac.be (Jim Lindsey)
Date: Thu, 27 Nov 1997 12:02:08 +0100 (MET)
Subject: R-alpha: batch
Message-ID: <9711271102.AA20305@alpha.luc.ac.be>

There absolutely has to be a global option (environment or RProfile)
that allows creating the .RData in batch mode to be disabled. It is
not at all serious to expect that it be disabled in each batch file.
(On my complete system, I have creation of .RData in interactive mode
disabled by redefinition of q() in the global RProfile.)  Otherwise, R
will never be a serious tool for statistical work because of the
incorrect statistical analyses that stray unnoticed .RData files can
produce. If this control of options is not introduced into 0.60, I
shall have seriously reconsider whether I shall continue using R.
  Jim
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Thu Nov 27 11:05:50 1997
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 27 Nov 1997 12:05:50 +0100
Subject: R-alpha:  Latin-1 characters / Locale etc.
In-Reply-To: Martin Maechler's message of Thu, 27 Nov 1997 10:35:06 +0100
References: <199711270935.KAA03092@sophie.ethz.ch>
Message-ID: <x27m9uwq9d.fsf@blueberry.kubism.ku.dk>

Martin Maechler <maechler@stat.math.ethz.ch> writes:

>=20
> >>>>> "PD" =3D=3D Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk> writes=
:

> Hmm, so we would follow the Unix locale philosophy.
> I could live with it.
>=20
> It has however, a distinct drawback:
>=20
> You can write R code which works with R compiled in one environment bu=
t
> fails with --identical R source code-- compiled in a different environ=
ment.

Actually, it's a run-time not compile-time issue.

> While this is true for things like 'readline' and 'proc.time / system.=
time',
> I don't like it so much for such a basic things as symbol characters.

Yes, it's no good having library code that only works in some locales.
However, it should be fairly easy to enforce (in some sense) a
requirement that everything on CRAN should work with LANG=3DC (unless,
of course it *is* language-specific code).

> BTW, Peter D., do you have a (electronical form of a) document availab=
le
> which nicely explains the  locale stuff (for a user, not a C-programme=
r ..).
>  Kurt/Fritz/???: I think there are some nice pages available in Linux.=
something=20

Argh. Stop tickling my guilty conscience. I've been promising to do a
write-up of that for the Danish-Howto for months. Trouble is, I tend
to forget how to do it myself... So right now, the two main machines
that I use are not set up right (running a straigh RedHat 4.2),
whereas my old 486 does have the stuff in place.=20

> I'm still wondering:
> The  only locale thing we have is (the environment variable)
>=20
> =09LC_CTYPE=3Diso_8859_1
>=20
> But then I wonder why I saw the difference between  =E4 and =FC=20
> that I reported ....

Hmm, that *is* strange... Try a variant of

unsigned char c =3D 0;
char *p;
main()
{
        while(++c)
                if ( isalpha(c) ) putchar(c);
        putchar('\n');
}

--=20
   O__  ---- Peter Dalgaard             Blegdamsvej 3 =20
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N  =20
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From thomas@biostat.washington.edu  Thu Nov 27 17:33:37 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Thu, 27 Nov 1997 09:33:37 -0800 (PST)
Subject: R-alpha: RData in batch
In-Reply-To: <Pine.OSF.3.96.971127103915.13153A-100000@alpha>
Message-ID: <Pine.SOL.3.95.971127092638.7075A-100000@gorn>

On Thu, 27 Nov 1997, Philippe Lambert wrote:

> Finally, I found out that running the same instructions as root work fine.
> The explanation for my computer sudden good will is not that I was root,
> but that I ran R in a different directory ... without .RData!!
> (and I don't care about .RData when I use R in batch mode!!).

This is a known and probably fixed bug.  The list of currently loaded
dynamic libraries is stored in .Dyn.libs, which is (incorrectly) saved in
.Rdata.  It should just be discarded.  A temporary fix is to add 
	.Dyn.libs<-NULL
to your start-up file.

> A second potential problem: when I build packages including personal
> functions, I use to test my functions interactively by typing
> library(mypackage) after modification of my code in an editor.
> The problem is that repeating the library load does not erase the old
> version. Do I do something wrong?

No. library() is only supposed to load a package if it hasn't already been
loaded.  This is a feature.  You can unload the package with detach() and
then reload with library().  I don't know if compiled code can be unloaded
and reloaded in the current version, though I think it is at least
planned.

	-thomas

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ihaka@stat.auckland.ac.nz  Thu Nov 27 23:40:25 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Fri, 28 Nov 1997 12:40:25 +1300 (NZDT)
Subject: R-alpha:  Latin-1 characters / Locale etc.
In-Reply-To: <199711270935.KAA03092@sophie.ethz.ch>
References: <x2pvnn2ure.fsf@blueberry.kubism.ku.dk>
 <199711270935.KAA03092@sophie.ethz.ch>
Message-ID: <199711272340.MAA28827@stat1.stat.auckland.ac.nz>

Martin Maechler writes:
 > Hmm, so we would follow the Unix locale philosophy.
 > I could live with it.
 > 
 > It has however, a distinct drawback:
 > 
 > You can write R code which works with R compiled in one environment but
 > fails with --identical R source code-- compiled in a different environment.
 > 
 > While this is true for things like 'readline' and 'proc.time / system.time',

I would tend to agree that this is a drawback.  I'd rather see a
locale independent solution.  So let me repeat my invitation ...
If someone will send me a function which identifies the set of
characters which can be used in identifiers (in addition to "."), I
will add it to the sources.

Getting it exactly right first time probably isn't crucial.
I'm sure we'll here form anyone who feels slighted :).
	Ross
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ihaka@stat.auckland.ac.nz  Thu Nov 27 23:57:40 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Fri, 28 Nov 1997 12:57:40 +1300 (NZDT)
Subject: R-alpha: RData in batch
In-Reply-To: <Pine.OSF.3.96.971127103915.13153A-100000@alpha>
References: <Pine.OSF.3.96.971127103915.13153A-100000@alpha>
Message-ID: <199711272357.MAA01329@stat1.stat.auckland.ac.nz>

Philippe Lambert writes:
 > Thus, 
 > would it be possible to have R not creating .RData file by default in
 > batch mode?

Hmmm.  Actually I was on your side, but there were a number of
requests to do it the other way.

So let me play Solomon ...

I think that I will introduce two new options to be used when invoking
R.

	R -save
	R -nosave

The default behavior in batch mode will be to refuse to run unless one
of these options is specified.

Multiple versions of these options will be allowed on the command
line, and it is the last (rightmost) one which determines what
happens.

In the front-end shell-script there is a line which reads

	exec $DEBUGGER $RHOME/bin/R.binary $*

and I will change this to

	exec $DEBUGGER $RHOME/bin/R.binary $BATCHSAVE $*

and give the person installing R the option of setting a value for
BATCHSAVE in the config.site script (or when we go gnu --with-save
or --with-nosave).

This way there can be a site-wide selection of the default behavior
which individual users can override.

Sound ok?
	Ross

(I think that Thomas L pointed out that the real bug that bit you has
been fixed too).
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Nov 28 07:45:39 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 28 Nov 1997 08:45:39 +0100
Subject: R-alpha:  Latin-1 characters / Locale etc.
In-Reply-To: <x2zpmquyvg.fsf@blueberry.kubism.ku.dk> (message from Peter
 Dalgaard BSA on 27 Nov 1997 16:42:43 +0100)
Message-ID: <199711280745.IAA04422@sophie.ethz.ch>

[to R-devel,  for everyone's information;
 thanks a lot, Peter!]

>>>>> "PD" =3D=3D Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk> writes:

    PD> Hmmm. You may need a call to 
       
    PD> #include <locale.h>
    PD> setlocale(LC_ALL,"")

    PD> (or LC_CTYPE?) before your environment variables take effect.

Yes, this was `it'.  
Maybe  R  needs such a call also? (I did not yet look in the src)


sophie{maechler}328> cat isalpha-tst.c
=09=09=09 -------------
/*--- Testing  'locale' [env.variable  LC_CTYPE ] --------------- */

#include <ctype.h> /*- isalpha(.) -*/
#include <stdio.h> /*- putchar(.) -*/
#include <locale.h>

unsigned char c =3D 0;
char *p;
void main()
{
  setlocale(LC_ALL,"");

  while(++c)
    if ( isalpha(c) ) putchar(c);
  putchar('\n');
}
sophie{maechler}329> cc isalpha-tst.c
sophie{maechler}330> cc -V
cc: SC3.0.1 13 Jul 1994
usage: cc [ options] files.  Use 'cc -flags' for details

sophie{maechler}314> printenv LC_CTYPE
iso_8859_1

sophie{maechler}331> isalpha-tst 
ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz=C0=C1=C2=C3=C4=C5=C6=
=C7=C8=C9=CA=CB=CC=CD=CE=CF=D0=D1=D2=D3=D4=D5=D6=D8=D9=DA=DB=DC=DD=DE=DF=E0=
=E1=E2=E3=E4=E5=E6=E7=E8=E9=EA=EB=EC=ED=EE=EF=F0=F1=F2=F3=F4=F5=F6=F8=F9=FA=
=FB=FC=FD=FE=FF

sophie{maechler}332> gcc -v
Reading specs from /usr/local/lib/gcc-lib/sparc-sun-solaris2.5/2.7.2.1/spec=
s
gcc version 2.7.2.1
sophie{maechler}333> gcc isalpha-tst.c
sophie{maechler}334> isalpha-tst
ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz=C0=C1=C2=C3=C4=C5=C6=
=C7=C8=C9=CA=CB=CC=CD=CE=CF=D0=D1=D2=D3=D4=D5=D6=D8=D9=DA=DB=DC=DD=DE=DF=E0=
=E1=E2=E3=E4=E5=E6=E7=E8=E9=EA=EB=EC=ED=EE=EF=F0=F1=F2=F3=F4=F5=F6=F8=F9=FA=
=FB=FC=FD=FE=FF



sophie{maechler}335> unsetenv LC_CTYPE
sophie{maechler}336> isalpha-tst
ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz

sophie{maechler}337> setenv LC_CTYPE C
sophie{maechler}338> isalpha-tst
ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz

sophie{maechler}339> setenv LC_CTYPE es=09#-- espa=F1ol
sophie{maechler}340> isalpha-tst
ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz=C0=C1=C2=C3=C4=C5=C6=
=C7=C8=C9=CA=CB=CC=CD=CE=CF=D0=D1=D2=D3=D4=D5=D6=D8=D9=DA=DB=DC=DD=DE=DF=E0=
=E1=E2=E3=E4=E5=E6=E7=E8=E9=EA=EB=EC=ED=EE=EF=F0=F1=F2=F3=F4=F5=F6=F8=F9=FA=
=FB=FC=FD=FE=FF
sophie{maechler}341> setenv LC_CTYPE de #-- deutsch
sophie{maechler}342> isalpha-tst
ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz=C0=C1=C2=C3=C4=C5=C6=
=C7=C8=C9=CA=CB=CC=CD=CE=CF=D0=D1=D2=D3=D4=D5=D6=D8=D9=DA=DB=DC=DD=DE=DF=E0=
=E1=E2=E3=E4=E5=E6=E7=E8=E9=EA=EB=EC=ED=EE=EF=F0=F1=F2=F3=F4=F5=F6=F8=F9=FA=
=FB=FC=FD=FE=FF
sophie{maechler}345> setenv LC_CTYPE iso_8859_1
sophie{maechler}346> isalpha-tst
ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz=C0=C1=C2=C3=C4=C5=C6=
=C7=C8=C9=CA=CB=CC=CD=CE=CF=D0=D1=D2=D3=D4=D5=D6=D8=D9=DA=DB=DC=DD=DE=DF=E0=
=E1=E2=E3=E4=E5=E6=E7=E8=E9=EA=EB=EC=ED=EE=EF=F0=F1=F2=F3=F4=F5=F6=F8=F9=FA=
=FB=FC=FD=FE=FF

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From jlindsey@luc.ac.be  Fri Nov 28 08:25:04 1997
From: jlindsey@luc.ac.be (Jim Lindsey)
Date: Fri, 28 Nov 1997 09:25:04 +0100 (MET)
Subject: R-alpha: batch
Message-ID: <9711280825.AA30943@alpha.luc.ac.be>

In my limited knowledge of computers, a program that creates a hidden
file without informing you and then, in subsequent runs, has its
behaviour modified in unpredictable ways because of this is called a
virus.
  I am glad to learn that, with Ross's suggestion, R will finally be
removed from this undesirable class of programs, something that I have
been requesting since v0.13.
  I strongly recommend that the default in the distribution be no
.RData so the beginners do not get badly burned. The warnings in the
R notes about cleaning up before creating the .RData are far from
sufficient to indicate the dangers of these files. There should also
be a clear statement in the FAQ about the problems with their
existence.
  Jim 
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From plummer@iarc.fr  Fri Nov 28 11:05:22 1997
From: plummer@iarc.fr (Martyn Plummer)
Date: Fri, 28 Nov 1997 12:05:22 +0100 (MET)
Subject: R-alpha: Problems with dimnames and names
Message-ID: <XFMail.971128122615.plummer@iarc.fr>

This message is in MIME format
--_=XFMail.1.1.p0.Linux:971128122615:3052=_
Content-Type: text/plain; charset=us-ascii

I have rounded up three buglets in R-0.50-a4. Two of them I can
fix and a patch is supplied below. I hope this is useful for the
current source (if these haven't been fixed already :)

1) cov
cov() fails when it's argument is a matrix with one column and with
column names defined. It tries to apply dimnames to the output but
the output is a vector of length 1.

> x <- matrix(rnorm(100),ncol=1,dimnames=list(NULL,"foo"))
> var(x)
Error: dimnames applied to non-array

2) Subscripting one-dimensional arrays.
These are treated as vectors when subscripting
so subscripting by dimnames fails.

> x <- c(0,0,0,1,1,1,1,3)
> table(x)
0 1 3
3 4 1
> table(x)["3"]
Error: subscript out of bounds

3) I have no idea what's going on here.

> c(r=1,s=2)
s
2
> c(u=100,b=4)
b
4

This seems to happen only for "r" and "u". Other single-letter
names are OK. This doesn't happen on my home PC which is still
running R-0.50-a1.

Martyn

--_=XFMail.1.1.p0.Linux:971128122615:3052=_
Content-Type: text/plain; charset=us-ascii; name=apatch; SizeOnDisk=1206
Content-Description: apatch
Content-Transfer-Encoding: 7bit
Content-Disposition: attachment; filename="apatch"

diff -ur R-0.50-a4/src/main/cov.c R-0.50-a4.patched/src/main/cov.c
--- R-0.50-a4/src/main/cov.c	Sun Nov 24 23:43:05 1996
+++ R-0.50-a4.patched/src/main/cov.c	Fri Nov 28 11:21:23 1997
@@ -390,7 +390,7 @@
 	}
 	if(isNull(y)) {
 		x = getAttrib(x, R_DimNamesSymbol);
-		if(!isNull(x) && !isNull(CADR(x))) {
+		if(ncx > 1 && !isNull(x) && !isNull(CADR(x))) {
 			PROTECT(ind = allocList(2));
 			CAR(ind) = CADR(x);
 			CADR(ind) = CADR(x);
@@ -401,7 +401,7 @@
 	else {
 		x = getAttrib(x, R_DimNamesSymbol);
 		y = getAttrib(y, R_DimNamesSymbol);
-		if((!isNull(x) && !isNull(CADR(x))) || (!isNull(y) && !isNull(CADR(y)))) {
+		if((ncx > 1 && !isNull(x) && !isNull(CADR(x))) || ( ncy > 1 && !isNull(y) && 
!isNull(CADR(y)))) {
 			PROTECT(ind = allocList(2));
 			CAR(ind) = CADR(x);
 			CADR(ind) = CADR(y);
diff -ur R-0.50-a4/src/main/subset.c R-0.50-a4.patched/src/main/subset.c
--- R-0.50-a4/src/main/subset.c	Mon Aug 11 04:59:12 1997
+++ R-0.50-a4.patched/src/main/subset.c	Fri Nov 28 11:16:55 1997
@@ -608,7 +608,7 @@
 		PROTECT(dim = getAttrib(x, R_DimSymbol));
 		nsubs = length(subs);
 
-		if(nsubs == 1) {
+		if(nsubs == 1 && isNull(dim)) {
 			ans = vectorSubset(x, CAR(subs), call);
 		}
 		else {

--_=XFMail.1.1.p0.Linux:971128122615:3052=_--
End of MIME message
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Fri Nov 28 10:48:36 1997
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 28 Nov 1997 11:48:36 +0100
Subject: R-alpha: batch
In-Reply-To: Jim Lindsey's message of Fri, 28 Nov 1997 09:25:04 +0100 (MET)
References: <9711280825.AA30943@alpha.luc.ac.be>
Message-ID: <x2zpmpgupn.fsf@blueberry.kubism.ku.dk>

Jim Lindsey <jlindsey@luc.ac.be> writes:

> 
> In my limited knowledge of computers, a program that creates a hidden
> file without informing you and then, in subsequent runs, has its
> behaviour modified in unpredictable ways because of this is called a
> virus.

Aw c'mon, Jim! A program that changes *it's own* behavior based on a
saved wokspace? There's a company in Redmond employing thousands of
people producing millions of viruses and charging money for them to
boot, then.

Your voice in this matter is becoming increasingly shrill, and it is
becoming more and more difficult to take you seriously. Not saying
that you might not be right, but how about taking other people's
opinions into account?

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Fri Nov 28 10:56:35 1997
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 28 Nov 1997 11:56:35 +0100
Subject: R-alpha: Problems with dimnames and names
In-Reply-To: Martyn Plummer's message of Fri, 28 Nov 1997 12:05:22 +0100 (MET)
References: <XFMail.971128122615.plummer@iarc.fr>
Message-ID: <x2wwhtgucc.fsf@blueberry.kubism.ku.dk>

Martyn Plummer <plummer@iarc.fr> writes:

> 3) I have no idea what's going on here.
> 
> > c(r=1,s=2)
> s
> 2
> > c(u=100,b=4)
> b
> 4
> 
> This seems to happen only for "r" and "u". Other single-letter
> names are OK. This doesn't happen on my home PC which is still
> running R-0.50-a1.

"r" is probably matching "recursive", but what about "u"? ("unlist"??)

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From plummer@iarc.fr  Fri Nov 28 12:26:07 1997
From: plummer@iarc.fr (Martyn Plummer)
Date: Fri, 28 Nov 1997 13:26:07 +0100 (MET)
Subject: R-alpha: Problems with dimnames and names
Message-ID: <XFMail.971128133158.plummer@iarc.fr>

On 28-Nov-97 p.dalgaard@biostat.ku.dk wrote:
>Martyn Plummer <plummer@iarc.fr> writes:
>
>> 3) I have no idea what's going on here.
>> 
>> > c(r=1,s=2)
>> s
>> 2
>> > c(u=100,b=4)
>> b
>> 4
>>
>"r" is probably matching "recursive", but what about "u"? ("unlist"??)

Aha! It's matching use.names (one of the arguments of unlist())
> c(u=0,x=1,y=2)
[1] 1 2
> c(u=10,x=1,y=2)
x y
1 2

Isn't it a bit dangerous to allow partial matching of arguments
(especially undocumented arguments)? NB It doesn't consistently
match the arguments either:

> c(r=1,u=2)
u
2
> c(u=2,r=1)
r
1

Martyn
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Nov 28 14:11:30 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 28 Nov 1997 15:11:30 +0100
Subject: R-alpha: "..." arg.matching [was 'Problems with dimnames and names']
In-Reply-To: <XFMail.971128122615.plummer@iarc.fr> (message from Martyn
 Plummer on Fri, 28 Nov 1997 12:05:22 +0100 (MET))
Message-ID: <199711281411.PAA05002@sophie.ethz.ch>

>>>>> "Martyn" == Martyn Plummer <plummer@iarc.fr> writes:

    Martyn> I have rounded up three buglets in R-0.50-a4. Two of them I can
    Martyn> fix and a patch is supplied below. I hope this is useful for the
    Martyn> current source (if these haven't been fixed already :)

Both of these bugs are already fixed in 0.60

    Martyn> 1) cov
    Martyn> cov() fails when it's argument is a matrix with one column and with
    Martyn> column names defined. It tries to apply dimnames to the output but
    Martyn> the output is a vector of length 1.

    >> x <- matrix(rnorm(100),ncol=1,dimnames=list(NULL,"foo"))
    >> var(x)
    Martyn> Error: dimnames applied to non-array

    Martyn> 2) Subscripting one-dimensional arrays.
    Martyn> These are treated as vectors when subscripting
    Martyn> so subscripting by dimnames fails.

    >> x <- c(0,0,0,1,1,1,1,3)
    >> table(x)
    Martyn> 0 1 3
    Martyn> 3 4 1
    >> table(x)["3"]
    Martyn> Error: subscript out of bounds

-- Now to the ``real'' one : --

    Martyn> 3) I have no idea what's going on here.

    >> c(r=1,s=2)
    Martyn> s
    Martyn> 2
    >> c(u=100,b=4)
    Martyn> b
    Martyn> 4

    Martyn> This seems to happen only for "r" and "u". Other single-letter
    Martyn> names are OK. This doesn't happen on my home PC which is still
    Martyn> running R-0.50-a1.

Well, we (i.e., Peter and Martyn) have found *why* it happens.

However, this is a semantic change from older versions of R and from S
which I consider serious [a bug ?!?] an we should discuss.

The general accepted semantic for S is:

  <> <>  If a function has a '...' argument,                    <> <>
  <> <>  all the other argument names must be matched EXACTLY,  <> <>    (S)
  <> <>  not only up to the unique string beginning.            <> <>

This behaviour (S) definitely IS a pain sometimes,
because it forces you not abbreviate argument names for all these
functions.

For the ``function writer'', this leads to 
  1) you really should only use "..." arguments if you must.
  2) if you have "..." argument(s),
	use relatively short argument names for the other arguments
  3) if there are named arguments in "..." (which is the usual case),
	make sure 
		[if you can, which is the case mostly, but not for 'c(.)']
	that all the argument names are valid.


Unfortunately, "3)" is not followed too often in S-plus,
which leads to the ``famous'' situation, that

	glm(ni ~ x1 * x2, familiy = binomial)

will fit a normal instead of a logistic regression,
with no warning, just because of a 1 letter typo ..

	(misspelling of 'familiy' makes the whole argument be ignored,
	  and family = gaussian , the default, be taken).

--------

So, we now see why Ross(?) may have wanted
to change the  argument matching behavior in the "..." case.
[[Rule: If  S  does things wierdly, R should do better ...]]

I still think however that this must be carefully tought over,
and I am not yet convinced if we shouldn't follow the S way after all.
Where we could do better (in our `own' functions) is to folllow my rule 
"3)" above as strictly as possible.


Martin Maechler <maechler@stat.math.ethz.ch>		 <><
Seminar fuer Statistik, SOL G1
ETH (Federal Inst. Technology)	8092 Zurich	 SWITZERLAND
phone: x-41-1-632-3408		fax: ...-1086
http://www.stat.math.ethz.ch/~maechler/

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ihaka@stat.auckland.ac.nz  Fri Nov 28 19:35:06 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Sat, 29 Nov 1997 08:35:06 +1300 (NZDT)
Subject: R-alpha: "..." arg.matching [was 'Problems with dimnames and names']
Message-ID: <199711281935.IAA13179@stat1.stat.auckland.ac.nz>

> -- Now to the ``real'' one : --
>
>     Martyn> 3) I have no idea what's going on here.
>
>     >> c(r=1,s=2)
>     Martyn> s
>     Martyn> 2
>     >> c(u=100,b=4)
>     Martyn> b
>     Martyn> 4
>
>     Martyn> This seems to happen only for "r" and "u". Other single-letter
>     Martyn> names are OK. This doesn't happen on my home PC which is still
>     Martyn> running R-0.50-a1.
>
> Well, we (i.e., Peter and Martyn) have found *why* it happens.
>
> However, this is a semantic change from older versions of R and from S
> which I consider serious [a bug ?!?] an we should discuss.

This wasn't a deliberate change, just my usual incompetence.
I think it crept in when we changed c() to be a generic function
(which does method dispatch internally).

The problem is in the function "ExtractOptionals" in bind.c.  There the
matching of arguments is done in two places with pmatch using a third
argument which is 0.  This indicates partial matching and should be
changed so that the third argument is 1 indicating exact matching.

	Ross
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From bates@stat.wisc.edu  Fri Nov 28 22:20:22 1997
From: bates@stat.wisc.edu (Douglas Bates)
Date: 28 Nov 1997 16:20:22 -0600
Subject: R-alpha: documentation for nlm
Message-ID: <6r4t4wek49.fsf@franz.stat.wisc.edu>

The documentation for nlm lists an argument named iterlim but the name
of the argument in the function itself is itnlim (a legacy of the
Fortran code, no doubt).
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Mon Nov  3 17:54:13 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Mon, 3 Nov 1997 18:54:13 +0100
Subject: R-alpha: expression(..) objects -- c(ex1, ex2) `fails'
Message-ID: <199711031754.SAA01954@sophie.ethz.ch>

When investigating  the  
	legend(x,y, expression ( <math>, <math> ), ....)
			 [as suggested by Jim Lindsey],
I once again stumbled over the fact that expression objects behave somewhat
``wierdly'', IMHO.

We can have expressions of length(.) > 1, and access elements of these like
list elements.
However, other natural things don't work with expressions; some example code:


##-- `Simple'  length--1  expressions:
ex1 <- expression(hat(beta) == (X^t * X)^{-1} * X^t * y)
ex2 <- expression(bar(x) == sum(over(x[i], n), i==1, n))
ex3 <- expression(paste(over(1, sigma*sqrt(2*pi)), " ",
    plain(e)^{over(-(x-mu)^2, 2*sigma^2)}))

##-- A length--2 expression:
ex12 <- expression(bar(x) == sum(over(x[i], n), i==1, n),
    		   hat(x) == median(x[i], i==1,n))
mode(ex12) # expression
length(ex12)# 2

mode(ex12 [1]) # expression
mode(ex12[[1]]) # call 
length(ex12[1])# 1
ex12 == ex12[1:2] #> TRUE TRUE


mode(c(ex1,ex2))#> "list" --->> This should be "expression" I think ...
##				---------------------------
mode(ex.12 <- as.expression(c(ex1,ex2))) # "expression"
## but the wrong one:
length(ex.12)# [1] 1
ex.12 #-- still has 'list(..)' in it...

###-> How could I take ex1, ex2 and "concat" them to an expression
###  of length 2 ?





=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From p.dalgaard@kubism.ku.dk  Mon Nov  3 18:27:53 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 03 Nov 1997 19:27:53 +0100
Subject: R-alpha: expression(..) objects -- c(ex1, ex2) `fails'
In-Reply-To: Martin Maechler's message of Mon, 3 Nov 1997 18:54:13 +0100
References: <199711031754.SAA01954@sophie.ethz.ch>
Message-ID: <x2iuu9hlxy.fsf@blueberry.kubism.ku.dk>

Martin Maechler <maechler@stat.math.ethz.ch> writes:
[I've taken out the ">" citation symbols to allow cut and paste]

##-- `Simple'  length--1  expressions:
ex1 <- expression(hat(beta) == (X^t * X)^{-1} * X^t * y)
ex2 <- expression(bar(x) == sum(over(x[i], n), i==1, n))

##-- A length--2 expression:
ex12 <- expression(bar(x) == sum(over(x[i], n), i==1, n),
  hat(x) == median(x[i], i==1,n))

##please avoid TABS, Martin. It confuses readline...

> ###-> How could I take ex1, ex2 and "concat" them to an expression
> ###  of length 2 ?

#Heh. One would at least expect
l<-NULL
l[[1]]<-ex1[[1]]
l[[2]]<-ex2[[1]]
#to be a list of calls, which by definition is what an expression is,
#so you'd only need to change the mode, but:

 
mode(e)<-"expression" 
e
# expression(list(hat(beta) == (X^t * X)^{
#         -1
# } * X^t * y, bar(x) == sum(over(x[i], n), i == 1, n)))

#(Why does it deparse in that strange way, BTW?)

#Also, textual representations of length-2 expressions is acting up:
deparse(ex12)
#[1] "bar(x) == sum(over(x[i], n), i == 1, n)"
str(ex12)
# bar(x) == sum(over(x[i], n), i == 1, n)
dput(ex12)
# bar(x) == sum(over(x[i], n), i == 1, n)
deparse(ex12[[2]])
# [1] "hat(x) == median(x[i], i == 1, n)"

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Nov  4 10:52:42 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 4 Nov 1997 11:52:42 +0100
Subject: R-alpha: Re: Separation of Program & Doc;  REQUIRING Perl5 [was: New Version]
In-Reply-To: <199711030736.IAA00272@pc25.none> (message from Kurt Hornik on
 Mon, 3 Nov 1997 08:36:39 +0100)
Message-ID: <199711041052.LAA02657@sophie.ethz.ch>

[[Again I diverge to R-devel, I think we need more opinions here...]]

>>>>> "KH" == Kurt Hornik <hornik@ci.tuwien.ac.at> writes:

>>>>> Ross Ihaka writes:
    >> I am beginning to get a bit more free time and I would like to get a
    >> "stable" version out as soon as possible.  (This is of course so I can
    >> break absolutely everything without feeling too much pressure to get
    >> things working again quickly :-).

    >> Using perl has produced some build problems because version 5 is not
    >> a universal standard.  There is even no guarantee that any kind of
    >> perl would be available.

    >> It would be nice if the installation could happen without perl.  I
    >> think this is possible if we separate the building of help files from
    >> the compilation/installation of binaries.  Preconfigured help files
    >> could then be distributed separately for anyone who lacks (the correct
    >> version of) perl, or at the cost of a little bloat, be part of the
    >> distribution.
I agree [see below]

    >> Alternatively we could just say "YOU MUST HAVE PERL VERSION 5" and
    >> enforce this with configuration checks.  This is rather user-hostile,
    >> but it does make things simple for us.

    >> Watcha think?

    KH> Well, better late than never (I was on a business trip for the past few
    KH> days), let me say that I am very unhappy about splitting INSTALL into a
    KH> doc and a non-doc part.  Let me explain why.

    KH> From a pedagogical point of view, it creates the impression that one can
    KH> actually `install' a package without the documentation.  This is not
    KH> true, because the documentation is an integral part of the package.  We
    KH> need to force packages writers/maintainers into providing accurate and
    KH> comprehensive documentation, and we need users to use it ...

Yes, [of course] I very much agree.  You may (not) know that I got involved
in R hacking first with the aim of improving documentation considerably
and pushing the idea that we need interesting / relevant examples as 
a very important part of docu.

    KH> From the R Core group's perspective, (I think) it does not solve the
    KH> problem.  The problem is that although we would all be very happy to
    KH> have Perl, and in fact version 5, available on all systems (and NOTE
    KH> that we chose Perl because unlike the shell it is also available on
    KH> non-Unix platforms, dubious as these may be), this does not seem to be
    KH> that case.  We now have Perl show up in both the documentation setup
    KH> process as well as in at least one user-level function, with perhaps
    KH> more to come.

hmm, I think that I said before that I don't like this (R function calling
perl) so much. 
It is nice that for non-Unix platforms, Perl is more available than a shell
(with sed, awk, ....).
However, Perl is not (yet ?) part of standard Unix [unfortunately].
Using perl from R functions  URGES users to have perl available.
This would prohibit the use of R for MANY who don't have a good access to
their system administrators [[which is not so rare, even at Universities..]].

The ``idea'' I got (which seems to be close to Ross' one) was:

A. For a Unix user, if she has perl available, she only needs the 
   base tar file, does ./configure  and
   make (good idea to INCLUDE 'make help' by default !) --> and has all

B. Unix users without Perl, or  Windows / Mac  users:
   
   Besides the base tar/zip file, 
   they need to get the precompiled online help --- as distributed by CRAN,
   in addition, and then can use (but not enhance conveniently) the help.

 We could well setup things such that these users are really REQUIRED to
 get the precompiled help  (following the above point that the doc is
			    integral part of the software).

    KH> Ross, as far as I understand your intentions, you want both `make
    KH> install' and `R INSTALL pkg lib' to work even if Perl 5 is not there.
    KH> The current solution (having install and INSTALL only operate things
    KH> which do not depend on the availability of Perl 5) is a fix, but of
    KH> course users could still do `make install-docs' and `R INSTALL-DOC' on
    KH> the `unfortunate' platforms.  What would happen then?  Well, I think
    KH> they should get a clean (and maybe not error-type) message saying sorry,
    KH> you asked for something which requires Perl 5, which does not seem to be
    KH> available on your system.  Now, the best possible way for this to be
    KH> accomplished would be via the configure script, which could not only
    KH> check for where Perl is, but also whether it is version 5 or not, and
    KH> record this information where needed.  (Maybe even in the R shell
    KH> script.)  E.g., if Perl 5 was found, we'd have

    KH> PERL5=y

    KH> in etc/INSTALL, and then code like

    KH> if [ "$PERL5" != "y" ];
    KH> then
    KH> echo "Sorry, you need ..."
    KH> exit 1
    KH> else
    KH> PROCEED.AS.USUAL()
    KH> fi

    KH> Functions based on Perl scripts could be treated in a unified manner via
    KH> a function perl().  Calling

    KH> perl(script, arg1, arg2, ...)

    KH> would under Unix be the same as

    KH> system(paste("perl", arg1, arg2, ..., collapse = TRUE))

    KH> but be set up in a way that a graceful error message is returned if Perl
    KH> was not available at compilation time.  In fact, we could even give
    KH> perl() a named version argument, or use perl() and perl5()?

    KH> (As an aside, my above reasoning also reflects my attitude that `make
    KH> install' should automatically install the documentation as well.)

Once more, I almost agree on that.

I think  `make' should install the program and doc
	(== current `make install docs')
 If perl is not available, installers should get your message above,
 PLUS the hint that 
	1) they must get the pre-compiled help from CRAN 
		and AFTER installing it,
	2) `make'  (or maybe, even `make install-program')
 will install the software alone [[docs being in place, unpacked from
				  precompiled CRAN help]].

    KH> Enough said.  Opinions?
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From pgilbert@bank-banque-canada.ca  Tue Nov  4 14:25:17 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Tue, 4 Nov 1997 09:25:17 -0500
Subject: R-alpha: Re: Separation of Program & Doc;  REQUIRING Perl5 [was: New Version]
References: <199711041052.LAA02657@sophie.ethz.ch>
Message-ID: <97Nov4.093029est.26503@mailgate.bank-banque-canada.ca>

>B. Unix users without Perl, or  Windows / Mac  users:
 >  Besides the base tar/zip file,
 >  they need to get the precompiled online help --- as distributed by
CRAN,
 >  in addition, and then can use (but not enhance conveniently) the
help.

This does not seem unreasonable for Windows/Mac users since, if I
understand the situation correctly, they will also need a pre-compiled
version of some C and Fortran. For Unix users without Perl5 the
situation is not so obvious. (It might be easier to distribute Perl5
than precompiled versions of all possible Unix versions.)

Also, for users always connected to the Internet, it is not really clear
that they always need and should be forced to have the help on their own
machine. Effectively it is, or can be made, available on line. There are
advantages to this: the help can be updated and corrected on the fly.
(Assuming, of course, that it is not perfect to begin with.)

Paul Gilbert


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From pgilbert@bank-banque-canada.ca  Tue Nov  4 14:31:59 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Tue, 4 Nov 1997 09:31:59 -0500
Subject: R-alpha: l2c libraries
Message-ID: <97Nov4.093841est.26501@mailgate.bank-banque-canada.ca>

How is the problem of l2c libraries being resolved in 0.60? I continue
to have problems with  ld.so.1: /.../R.binary: fatal: relocation error:
symbol not found: pow_ii: referenced in /.../dsefor.so where dsefor.so
is my compiled fortran.

Paul Gilbert

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Nov  4 14:47:54 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 4 Nov 1997 15:47:54 +0100
Subject: R-alpha: Re: Separation of Program & Doc;  REQUIRING Perl5 [was: New Version]
In-Reply-To: <97Nov4.093029est.26503@mailgate.bank-banque-canada.ca> (message
 from Paul Gilbert on Tue, 4 Nov 1997 09:25:17 -0500)
Message-ID: <199711041447.PAA02817@sophie.ethz.ch>

>>>>> "PaulG" == Paul Gilbert <pgilbert@bank-banque-canada.ca> writes:

    >> B. Unix users without Perl, or  Windows / Mac  users:
    >> Besides the base tar/zip file,
    >> they need to get the precompiled online help --- as distributed by
    PaulG> CRAN,
    >> in addition, and then can use (but not enhance conveniently) the
    PaulG> help.

    PaulG> This does not seem unreasonable for Windows/Mac users since, if
    PaulG> I understand the situation correctly, they will also need a
    PaulG> pre-compiled version of some C and Fortran. For Unix users
    PaulG> without Perl5 the situation is not so obvious. (It might be
    PaulG> easier to distribute Perl5 than precompiled versions of all
    PaulG> possible Unix versions.)


    PaulG> Also, for users always connected to the Internet, it is not really clear
    PaulG> that they always need and should be forced to have the help on their own
    PaulG> machine. Effectively it is, or can be made, available on line. There are
    PaulG> advantages to this: the help can be updated and corrected on the fly.
    PaulG> (Assuming, of course, that it is not perfect to begin with.)

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From bates@stat.wisc.edu  Tue Nov  4 14:53:53 1997
From: bates@stat.wisc.edu (Douglas Bates)
Date: 04 Nov 1997 08:53:53 -0600
Subject: R-alpha: Re: Separation of Program & Doc;  REQUIRING Perl5 [was: New Version]
In-Reply-To: Martin Maechler's message of Tue, 4 Nov 1997 11:52:42 +0100
References: <199711041052.LAA02657@sophie.ethz.ch>
Message-ID: <6ren4wg16m.fsf@franz.stat.wisc.edu>

Regarding Perl5 availability:
 - In the Unix world I would be surprised if people who would want to
   install R would not also have access to perl5 or be able to install
   it.  I would assert that the level of skill required to install R
   is comparable to that required to install perl.
 - For Mac or Windows are you expecting that most users would install
   from the .tar.gz file?  I would have thought that there would be
   one compilation done to create a .zip file for Windows and a .hqx
   file for the Mac.  The typical user would only need to install
   these "tar-ball" files and never need to see the part that depended 
   on perl.  If someone decides to write an R function that calls perl 
   then it will croak but the same would happen for shell scripts, awk 
   scripts, ...
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Nov  4 14:58:32 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 4 Nov 1997 15:58:32 +0100
Subject: R-alpha: Re: Separation of Program & Doc ...
In-Reply-To: <97Nov4.093029est.26503@mailgate.bank-banque-canada.ca> (message
 from Paul Gilbert on Tue, 4 Nov 1997 09:25:17 -0500)
Message-ID: <199711041458.PAA02846@sophie.ethz.ch>

>>>>> "PaulG" == Paul Gilbert <pgilbert@bank-banque-canada.ca> writes:

    >> B. Unix users without Perl, or  Windows / Mac  users:
    >> Besides the base tar/zip file,
    >> they need to get the precompiled online help --- as distributed by
    PaulG> CRAN,
    >> in addition, and then can use (but not enhance conveniently) the
    PaulG> help.

    PaulG> This does not seem unreasonable for Windows/Mac users since, if
    PaulG> I understand the situation correctly, they will also need a
    PaulG> pre-compiled version of some C and Fortran. For Unix users
    PaulG> without Perl5 the situation is not so obvious. (It might be
    PaulG> easier to distribute Perl5 than precompiled versions of all
    PaulG> possible Unix versions.)
You misunderstood: `Precompiled help' means
	 "R documentation" (a la src/library/base/man/*) in
		1) help [nroff]
		2) html
		3) latex -> PostScript
	 format.
All of these are ASCII formats.
Therefore, there is no difference in `precompiled help' between 
any operating systems (well as much as ASCII formats are the same;
			knowing that DOS has extra carriage returns ....)

    PaulG> Also, for users always connected to the Internet, it is not
    PaulG> really clear that they always need and should be forced to have
    PaulG> the help on their own machine. Effectively it is, or can be
    PaulG> made, available on line. There are advantages to this: the help
    PaulG> can be updated and corrected on the fly.  (Assuming, of course,
    PaulG> that it is not perfect to begin with.)

This maybe practical in a future internet (or in today's net within
North-America?) where bandwidth of small files 
like these is practially zero.   Today, even getting only a thousand bytes can
take many seconds, which is too long.

-- Martin Maechler <maechler@stat.math.ethz.ch>		 <><
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From Kurt.Hornik@ci.tuwien.ac.at  Tue Nov  4 15:37:33 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 4 Nov 1997 16:37:33 +0100
Subject: R-alpha: Re: Separation of Program & Doc;  REQUIRING Perl5 [was: New Version]
In-Reply-To: <6ren4wg16m.fsf@franz.stat.wisc.edu>
References: <199711041052.LAA02657@sophie.ethz.ch>
 <6ren4wg16m.fsf@franz.stat.wisc.edu>
Message-ID: <199711041537.QAA07525@pc25.none>

>>>>> Douglas Bates writes:

> Regarding Perl5 availability:
>  - In the Unix world I would be surprised if people who would want to
>    install R would not also have access to perl5 or be able to install
>    it.  I would assert that the level of skill required to install R
>    is comparable to that required to install perl.

:-)

Btw, does CPAN have binary distributions as well?

>  - For Mac or Windows are you expecting that most users would install
>    from the .tar.gz file?  I would have thought that there would be
>    one compilation done to create a .zip file for Windows and a .hqx
>    file for the Mac.  The typical user would only need to install
>    these "tar-ball" files and never need to see the part that depended 
>    on perl.  If someone decides to write an R function that calls perl 
>    then it will croak but the same would happen for shell scripts, awk 
>    scripts, ...

I am confused now.  I thought the advantage of Perl is that it is
available on non-Unix platforms as well ...?

(Of course, that does not solve the `packaging' problem ...)

-k

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From bates@stat.wisc.edu  Tue Nov  4 15:44:50 1997
From: bates@stat.wisc.edu (Douglas Bates)
Date: 04 Nov 1997 09:44:50 -0600
Subject: R-alpha: Re: Separation of Program & Doc;  REQUIRING Perl5 [was: New Version]
In-Reply-To: Kurt Hornik's message of Tue, 4 Nov 1997 16:37:33 +0100
References: <199711041052.LAA02657@sophie.ethz.ch> 	<6ren4wg16m.fsf@franz.stat.wisc.edu> <199711041537.QAA07525@pc25.none>
Message-ID: <6rd8kgfytp.fsf@franz.stat.wisc.edu>

Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

> I am confused now.  I thought the advantage of Perl is that it is
> available on non-Unix platforms as well ...?

I know there is a perl for Windows NT.  I don't know about the
Macintosh or Windows 95.

I think it would be a good idea to use perl in the installation on all
platforms.  What I was trying to say is that I imagine the "typical"
Windows or Macintosh user would not be doing the installation from
scratch but instead would be using the tar-ball format appropriate for
their system.  The only people who need to have perl for Windows or
perl for the Macintosh are those who will create the tar-balls.
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From pgilbert@bank-banque-canada.ca  Tue Nov  4 16:49:56 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Tue, 4 Nov 1997 11:49:56 -0500
Subject: R-alpha: Re: Separation of Program & Doc ...
Message-ID: <97Nov4.115513est.26513@mailgate.bank-banque-canada.ca>

>    PaulG> Also, for users always connected to the Internet, it is not
>    PaulG> really clear that they always need and should be forced to
have
 >   PaulG> the help ...
>This maybe practical in a future internet (or in today's net within
>North-America?) where bandwidth of small files
>like these is practially zero.   Today, even getting only a thousand
bytes can
>take many seconds, which is too long.

I am familiar with the low bandwidth problem and I appreciate that lots
of people will want to install help files locally. For many people in
North America the bandwidth is not so low anymore, and I am simply
pointing out that the logic of forcing everyone to install help locally
assumes a set of circumstances which may not exist for everyone.
(Although, for convenience I can certainly appreciate that doing things
one way may be a lot simpler.)

On a related, but slightly longer term issue, it is worth at least
thinking about the possibility that some code libraries could be loaded
on the fly over a high speed Internet. This is a small bandwidth
requirement compared to video, which seems to be coming more quickly
than most people thought. The advantage of this is that development can
be done more easily, continuously and quickly.  As long as the installed
base portion remains stable, newer libraries could be put in place
simply by pointing at them over the network rather than doing an
"install" in the fashion with which we are familiar.

All this is simply to point out that install strategies should probably
be considered to be for the short term rather than the long term.

Paul

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From luke@stat.umn.edu  Tue Nov  4 18:03:40 1997
From: luke@stat.umn.edu (Luke Tierney)
Date: Tue, 4 Nov 1997 12:03:40 -0600 (CST)
Subject: R-alpha: Re: Separation of Program & Doc;  REQUIRING Perl5 [was: New Version]
In-Reply-To: <199711041537.QAA07525@pc25.none> from "Kurt Hornik" at Nov 4, 97 04:37:33 pm
Message-ID: <9711041803.AA08655@nokomis.stat.umn.edu>

Kurt Hornik wrote:
> 
> >>>>> Douglas Bates writes:
> 
> > Regarding Perl5 availability:
> >  - In the Unix world I would be surprised if people who would want to
> >    install R would not also have access to perl5 or be able to install
> >    it.  I would assert that the level of skill required to install R
> >    is comparable to that required to install perl.
> 
> :-)
> 
> Btw, does CPAN have binary distributions as well?

One of the arguments someone made, as I recall, is access. Perl ought
to be installed as a system resource and the person installing R may
not have access at that level. Of course they could install a private
Perl but this is likely to create some headaches someplace down the
road.

luke

-- 
Luke Tierney
University of Minnesota                      Phone:           612-625-7843
School of Statistics                         Fax:             612-624-8868
206 Church Street                            email:      luke@stat.umn.edu
Minneapolis, MN 55455 USA                    WWW:  http://www.stat.umn.edu
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From pgilbert@bank-banque-canada.ca  Tue Nov  4 20:27:08 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Tue, 4 Nov 1997 15:27:08 -0500
Subject: R-alpha: compatibility functions
Message-ID: <97Nov4.153225est.26507@mailgate.bank-banque-canada.ca>

Below is a revised copy of my compatibility functions with additions
from Martin. I expect I may need a new version  when 0.6 arrives but I
thought it would be worth circulating this in case it suggests anything
which might be resolved before the release of 0.6 rather than after.

Thanks to a few people for pointing out the R function machine(). I have
a kludge below for determining the same information in S. If anyone has
a better way to do this I would appreciate it.

There are also several functions where the non-unix versions have not
been defined. Suggestions would be appreciated.

Paul Gilbert

##############################################################################



# This file has code which contains operating system and S/R specific
#   functions. They are intended to be used as a kernel to help
#   protect other code from these problems.

# The following functions are attempted:
#   For S/R differences:
#      global.assign, system.info, exists.graphics.device, unlink,
#      synchronize,  list.add for [["new.element"]]<-
#   For OS differences:
#     system.call, sleep, present.working.directory, whoami, file.copy,
#     file.date.info, date, mail, unlink, local.host.netname,

# Also a number of is.xxx functions are defined to identify systems.

# The variable  .SPAWN is also set to be used to identify if Splus "For"
loops
#    should be used. (It is sometimes better not to use these even in
Splus.)

##############################################################################

#            General Logic and organization of these functions

# 1/ The first group of functions are for identifying S or R and
flavours.
# 2/ The second group of functions are for identifying the operating
system.
# 3/ The third group specify a few functions which depend only on the
#         differences between S and R.
# 4/ The fourth group specify functions which depend only on the
#         differences among operating system.
# 5/ The fifth group specify a few functions which depend on both R/S
and the
#         differences among operating system.

#  >>> I would very much like any input WRT  MS Windows / Win95 / NT /
Mac <<<

# The function system.call is defined in order to provide a generic way
to
#  make a call to the operating system. However, when the calls are
specific
#  to Unix then the function unix() is used.


##############################################################################

system.info <- function()
     {if( !exists("version"))
         { #-- `Vanilla' S (i.e. here "S version 4")
           #- this now works for  S version 4  (this is not S-plus 4.0,
maybe
           #             part of S-plus 5.0 !):
           lv <- nchar(Sv <- Sversion())
           r <- list(
       major = substring(Sv, 1,1),
       minor = substring(Sv, lv,lv))
         }
   else
     {r <- version
      r$minor <- as.numeric(r$minor)
      r$major <- as.numeric(r$major)
     }
   if      (is.Splus())    r$language <- "Splus"
   else if (is.Svanilla()) r$language <- "S"
   r$OSversion <- OSversion()
   r$OStype <- machine()
   r
  }


###########################################################

#    1/  Functions are for identifying S or R and flavours.

###########################################################

#Note It is tempting to use system.info as defined above, but there is a

#        bootstrapping problem to solve.

is.R <- function()
 {exists("version") && !is.null(vl <- version$language) && vl == "R" }

is.R.pre0.60 <- function()
  {is.R() && ((as.numeric(version$major)+.01*as.numeric(version$major))
<0.60) }


is.S <- function(){is.Svanilla() | is.Splus() }
is.Svanilla <- function(){!exists("version")}
is.Splus <- function(){exists("version") && is.null(version$language)}
is.Splus.pre3.3 <- function()
   { ## <= 3.2
    is.Splus() &&  ((system.info()$major+.1*system.info()$minor) < 3.3)
   }

###########################################################

#    2/  Functions are for identifying the operating system.

###########################################################

# if (is.R()) {machine <- machine}

if (is.S())
   {machine <- function()
      {if (version$os == "MS Windows") return(version$os)
       if (version$os == "Macintosh") return(version$os) # needs to be
checked
       else return ("Unix")  # not a very satisfactory test
      }
   }


is.MSwindows <- function(){machine() == "MS Windows"}
is.Mac       <- function(){machine() == "Macintosh" }
is.unix      <- function(){machine() == "Unix" }

# Other is.xxx() should be added here.

# determining Unix flavours doesn't seem to be too important but ...
is.Sun4 <- function() {OSversion() == "SunOS4" }
is.Sun5 <- function() {OSversion() == "SunOS5" }
is.Linux <- function(){OSversion() == "linux"}

OSversion <- function()
   {paste(unix("uname -s"), unix("uname -r | sed -e 's/\\.\.\*//'"),
sep="") }



###########################################################

#    3/  Functions depending only on the
#         differences between S and R

###########################################################

if(is.S())
   {if(is.unix())system.call  <- unix
    global.assign <- function(name, value) {assign(name,value, where =
1)}
    .SPAWN <- TRUE
    exists.graphics.device <- function(){dev.cur() !=1 }
    open.graphics.device  <- function(display=getenv("DISPLAY"))
                                 {openlook(display) }
    #                            {motif(display) }
    close.graphics.device <- function(){dev.off() }
    if (!exists("set.seed.Splus")) set.seed.Splus <- set.seed
    set.seed <- function(seed=NULL)
      {if (is.null(seed))
          seed <-.Random.seed
       else
         {if (1==length(seed)) set.seed.Splus(seed)
          else global.assign(".Random.seed", seed)
         }
       seed
      }

    "list.add<-" <- function(x, replace, value)
       {# replace or add elements to a list.
        x[replace] <- value
        # x[[replace]] <- value  would be more logical but doesn't work
        x
       }
   }

if(is.R())
   {#tempfile <- function(f)
    #   {# Requires C code also from Friedrich Leisch not in version
0.15 of R.
    #    d<-"This is simply a string long enough to hold the name of a
tmpfile";
    #     .C("tmpf", as.character(d))[[1]]
    #    }

    if (is.R.pre0.60())
        {tempfile <- function(pattern = "file")
                {system(paste("for p in", paste(pattern, collapse = "
"), ";",
                       "do echo /tmp/$p$$; done"),
                 intern = TRUE)
                }
        }

    unlink <- function(file) system.call(paste("rm -fr ", file))
    global.assign <- function(name, value)
                          {assign(name,value, envir=.GlobalEnv)}
    synchronize<- function(x){NULL} # perhaps this should do something?
    .SPAWN <- FALSE
    exists.graphics.device <- function(){exists(".Device")}
    open.graphics.device  <- function(display=getenv("DISPLAY"))
                                {x11(display) }
    close.graphics.device <- function(){F} # how do I do this?
    set.seed <- function(seed=NULL)
      {if (is.null(seed))
         {if (!exists(".Random.seed")) zzz <- runif(1) # seed may not
yet exist
          seed <-.Random.seed
         }
       else
         {if (1==length(seed))

global.assign(".Random.seed",round(runif(3,min=seed,max=1e5*seed)))
          else global.assign(".Random.seed", seed)
         }
       seed
      }

   "list.add<-" <- function(x, replace, value)
     {# replace or add elements to a list.
      if (is.numeric(replace))
        {# x<- do.call("default.[[<-", list(x,replace,value))   # use
default
         x[[replace]] <- value
         return(x)
        }
      if (is.null(value))  value <- list(NULL)
      if (!is.list(value)) value <- list(value)
      if (1 == length(value))
       {for (i in seq(length(replace)))
          x<- do.call("$<-", list(x,replace[i],value[[1]]))
       }
      else
        {if(length(value) != length(replace) )
         stop("number of replacement values != number of elements to
replace")
         for (i in seq(length(replace)))
            x<- do.call("$<-", list(x,replace[i],value[[i]]))
        }
      x
     }
 }


###########################################################

#    4/  Functions depending only on the
#         differences among operating system.

###########################################################

if(is.unix())
  {sleep <- function(n) {unix(paste("sleep ", n))} # pause for n seconds

   present.working.directory <- function(){unix("pwd")} # present
directory
   whoami <- function(){unix("whoami")} # return user id (for mail)
   local.host.netname <-function() {unix("uname -n")}

   mail <- function(to, subject="", text="")
    {# If to is null then mail is not sent (useful for testing).
     file <- tempfile()
     write(text, file=file)
   if(!is.null(to)) unix(paste("cat ",file, " | mail  -s '", subject, "'
", to))
     unlink(file)
     invisible()
    }

   file.copy <- function(from, to)unix(paste("cp ", from, to)) # copy
file

   file.date.info <- function(file.name)
     {# This could be a lot better. It will fail for files older than a
year.
      # Also, a returned format like date() below would be better.
      mo <- (1:12)[c("Jan","Feb","Mar","Apr","May", "Jun","Jul","Aug",
"Sep",
         "Oct","Nov","Dec") ==substring(unix(paste("ls -l
",file)),33,35)]
      day <- as.integer(substring(unix(paste("ls -l
",file.name)),37,38))
      hr  <- as.integer(substring(unix(paste("ls -l
",file.name)),40,41))
      sec <- as.integer(substring(unix(paste("ls -l
",file.name)),43,44))
      c(mo,day,hr,sec)
     }

}

if(is.MSwindows())
  {system.call  <- function(cmd)
         {stop("system calls must be modified for this operating
system.")}
   sleep <- system.call
   present.working.directory <- system.call
   whoami <- system.call
   file.copy <- system.call
   file.date.info <- system.call
  }



###########################################################

#    5/  Functions depending on both R/S and the
#         differences among operating system.

###########################################################

if(is.unix())
  {if(is.R())
     {unix <- function(cmd) system(cmd, intern=T)
      system.call <- function(cmd) system(cmd, intern=T)

      date <-function()
        {d<-parse(text=strsplit(
              unix("date \'+%Y %m %d %H %M %S\'")," ")[[1]])
         list(y=  eval(d[1]),
              m=eval(d[2]),
              d= eval(d[3]),
              h= eval(d[4]),
              m= eval(d[5]),
              s= eval(d[6]),
              tz=unix("date '+%Z'"))
        }
     }
   if(is.S())
     {system.call <- function(cmd) unix(cmd)

      date <-function()
        {d <- parse(text=unix("date '+%Y %m %d %H %M %S'"),white=T)
         list(y=  eval(d[1]),
              m=eval(d[2]),
              d= eval(d[3]),
              h= eval(d[4]),
              m= eval(d[5]),
              s= eval(d[6]),
              tz=unix("date '+%Z'"))
        }
     }
  }




##############################################################################




=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From Martin Maechler <maechler@stat.math.ethz.ch>  Thu Nov  6 08:12:47 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Thu, 6 Nov 1997 09:12:47 +0100
Subject: R-alpha: "invisible" (yet again): a more problematic bug[let]
Message-ID: <199711060812.JAA04845@sophie.ethz.ch>

I think this is a more problematic buglet
in (implicit/explicit)  ``invisible behavior'').

Try this  (all versions of R from  0.49 to 0.60):


test0 <- function() c(1,2)
test  <- function(two = FALSE)        c(1, if(two) 2)
testR <- function(two = FALSE) return(c(1, if(two) 2))

test0()# 1 2 as it should
test() # <<<<<<<<<<<<<<<<<<<<<< INVISIBLE! @#$@!
test(T)# 1 2
print(test())
print(test(T))

testR() # ok; NOT invisible...
testR(T)# 1 2

---------------------------
Even though it is not really harmful once you know about it,
it can be pretty wierd when you try and test functions...

-- Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From plummer@iarc.fr  Thu Nov  6 09:28:08 1997
From: plummer@iarc.fr (Martyn Plummer)
Date: Thu, 06 Nov 1997 10:28:08 +0100
Subject: R-alpha: "invisible" (yet again): a more problematic bug[let]
References: <md5:4C26491E69F1EF6D2FB938607D06BE19>
Message-ID: <34618DA8.23AA175C@iarc.fr>

maechler@stat.math.ethz.ch wrote:
> 
> Try this  (all versions of R from  0.49 to 0.60):
> 
> test0 <- function() c(1,2)
> test  <- function(two = FALSE)        c(1, if(two) 2)
> testR <- function(two = FALSE) return(c(1, if(two) 2))
> 
> test0()# 1 2 as it should
> test() # <<<<<<<<<<<<<<<<<<<<<< INVISIBLE! @#$@!
> test(T)# 1 2
> print(test())
> print(test(T))
> 
> testR() # ok; NOT invisible...
> testR(T)# 1 2

The problem seems to be in do_if (eval.c) where the R_Visible flag
is set to 0. Set it to 1 instead and your functions will work
properly. You also get

R>if(F) 2
NULL

instead of 
R>if(F) 2
R>

which is consistent with S-PLUS.

Martyn
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From Martin Maechler <maechler@stat.math.ethz.ch>  Thu Nov  6 10:55:17 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Thu, 6 Nov 1997 11:55:17 +0100
Subject: R-alpha: "invisible" : R_INVISIBLE .. -- repeat{} gives BOMB
In-Reply-To: <34618DA8.23AA175C@iarc.fr> (message from Martyn Plummer on Thu,
 06 Nov 1997 10:28:08 +0100)
Message-ID: <199711061055.LAA05033@sophie.ethz.ch>

>>>>> "Martyn" == Martyn Plummer <plummer@iarc.fr> writes:

    Martyn> maechler@stat.math.ethz.ch wrote:
    >>  Try this (all versions of R from 0.49 to 0.60):
    >> 
    >> test0 <- function() c(1,2) test <- function(two = FALSE) c(1,
    >> if(two) 2) testR <- function(two = FALSE) return(c(1, if(two) 2))
    >> 
    >> test0()# 1 2 as it should test() # <<<<<<<<<<<<<<<<<<<<<< INVISIBLE!
    >> @#$@!  test(T)# 1 2 print(test()) print(test(T))
    >> 
    >> testR() # ok; NOT invisible...  testR(T)# 1 2

    Martyn> The problem seems to be in do_if (eval.c) where the R_Visible
    Martyn> flag is set to 0. Set it to 1 instead and your functions will
    Martyn> work properly. You also get

    R> if(F) 2
    Martyn> NULL

    Martyn> instead of
    R> if(F) 2
    R> 

    Martyn> which is consistent with S-PLUS.

Wow, this was quick and precise,  thank you !!

I investigated some more:  
	R_VISIBLE is set to 0  ``R_Visible = 0;''
	 also in other places in eval.c :

 line	C function
		
  344:	  do_if
  436:	  do_for
  480:	  do_while
  515:	  do_repeat
  720:    \
  727:     > do_set
  738:    /
  ^^^
(line numbers from current 0.60)

In my opinion, only the three cases in do_set ("<-" things) should have
the invisibility flag...

	
testwh <- function(n = 1) c(1, while(n > 1) {n <- n-1; n})
testwh() # invisible !
testwh(2)
print(testwh()) # 1
print(testwh(2))# 1 1
##-- in Splus, both are visible

###-------- THIS IS EVEN WORSE:   Segmentation violation !!! -----

testrep <- function(n = 1) c(1, repeat {n <- n-1; if(n<=0) break})
testrep()
##R : Process R:1 segmentation violation at Thu Nov  6 11:36:27 1997


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From plummer@iarc.fr  Fri Nov  7 14:21:26 1997
From: plummer@iarc.fr (Martyn Plummer)
Date: Fri, 07 Nov 1997 15:21:26 +0100 (MET)
Subject: R-alpha: "invisible" : R_INVISIBLE .. -- repeat{} gives BOMB
Message-ID: <XFMail.971107153147.plummer@iarc.fr>

On 06-Nov-97 maechler@stat.math.ethz.ch wrote:
>I investigated some more:  
>       R_VISIBLE is set to 0  ``R_Visible = 0;''
>        also in other places in eval.c :
>
> line  C function
>               
>  344:   do_if
>  436:   do_for
>  480:   do_while
>  515:   do_repeat
>  720:    \
>  727:     > do_set
>  738:    /
>  ^^^
>(line numbers from current 0.60)
>
>In my opinion, only the three cases in do_set ("<-" things) should have
>the invisibility flag...

In S-PLUS, for, while and repeat all return invisible answers, so for
compatibility these should probably be kept. Note that S-PLUS can behave
pretty strangely with this kind of example. Try this (but type carefully!)

n<-0
repeat{ if(n==0) break }->x

Now try printing x, or indeed doing anything else with it.

>
>###-------- THIS IS EVEN WORSE:   Segmentation violation !!! -----
>
>testrep <- function(n = 1) c(1, repeat {n <- n-1; if(n<=0) break})
>testrep()
>##R : Process R:1 segmentation violation at Thu Nov  6 11:36:27 1997

Try initializing t to R_NilValue in do_repeat (eval.c).

Martyn
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From jlindsey@luc.ac.be  Mon Nov 10 08:48:30 1997
From: jlindsey@luc.ac.be (Jim Lindsey)
Date: Mon, 10 Nov 1997 09:48:30 +0100 (MET)
Subject: R-alpha: text outside plots
Message-ID: <9711100848.AA24437@alpha.luc.ac.be>

When text() is used to write a string in the margin of a plot (for
example, between plots on a multiplot screen), the words appear on the
window but not when a postscript file is produced. In fact, they are
in the file, but clipped. This should be made consistent, preferably
so that they appear in both.
  Jim
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From p.dalgaard@kubism.ku.dk  Mon Nov 10 09:08:50 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 10 Nov 1997 10:08:50 +0100
Subject: R-alpha: text outside plots
In-Reply-To: Jim Lindsey's message of Mon, 10 Nov 1997 09:48:30 +0100 (MET)
References: <9711100848.AA24437@alpha.luc.ac.be>
Message-ID: <x23el5i09p.fsf@blueberry.kubism.ku.dk>

Jim Lindsey <jlindsey@luc.ac.be> writes:

> 
> When text() is used to write a string in the margin of a plot (for
> example, between plots on a multiplot screen), the words appear on the
> window but not when a postscript file is produced. In fact, they are
> in the file, but clipped. This should be made consistent, preferably
> so that they appear in both.
>   Jim

Aren't you supposed to use mtext() for putting text in margins? I
suspect that text() should behave like points(), etc. -- i.e. clip in
all cases. Or the clipping could be made optional.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From ihaka@stat.auckland.ac.nz  Mon Nov 10 09:20:44 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Mon, 10 Nov 1997 22:20:44 +1300 (NZDT)
Subject: R-alpha: text outside plots
Message-ID: <199711100920.WAA02521@stat1.stat.auckland.ac.nz>

The problem is that in X11 clipping is only applied to graphic
elements, not to text elements (why distinguish the two?), whereas
PostScript does the right thing. There are some possible work arounds,
but don't hold your breath.  Getting 0.60 out is job number one at
present.
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From Martin Maechler <maechler@stat.math.ethz.ch>  Mon Nov 10 16:00:56 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Mon, 10 Nov 1997 17:00:56 +0100
Subject: R-alpha: Re: R/R-minus incompatibility [ an old one ]
In-Reply-To: <199711101535.QAA23500@galadriel.ci.tuwien.ac.at> (message from
 Friedrich Leisch on Mon, 10 Nov 1997 16:35:47 +0100)
Message-ID: <199711101600.RAA08965@sophie.ethz.ch>

>>>>> "FrL" == Friedrich Leisch <Friedrich.Leisch@ci.tuwien.ac.at> writes:

    FrL> Hmm, I'm quite perplexed by something very trivial/stupid/whatever
    FrL> ...  don't know, if this one has been reported before:

    R> x<-1 x[1:2]
    FrL> Error: subscript out of bounds

    Splus> x<-1 x[1:2]
    FrL> [1] 1 NA

    FrL> Or is there an option to control this behaviour?

Fritz, this *is* known and is on purpose.
However, it seems that it is  NOT in the R-FAQ  (Kurt ?!?)

-- Martin

--------------- Here are two example mails from R-devel ------------------


 From: Peter Dalgaard BSA <p.dalgaard@kubism.ku.dk>
 Date: 25 Apr 1997 01:36:23 +0200
 To: r-devel@stat.math.ethz.ch
 Subject: R-alpha: list assignment

 This works in Splus:

 > x<-list()
 > x[["f"]]<-1
 > zz<-"g"
 > x[[zz]]<-2
 > x
 $f:
 [1] 1

 $g:
 [1] 2

 In R both variants fail unless the name is already on the list. The
 first one can be replaced by x$f, but there's seems to be no
 substitute for the other one (oh yes I found one, but it's not fit to
 print!). This comes up if you e.g. want to create a variable in a data
 frame with a name given by a character string.

------------------------------------------------------

 From: Robert Gentleman <rgentlem@stat.auckland.ac.nz>
 Date: Fri, 25 Apr 1997 13:12:36 +1200 (NZST)
 To: r-devel@stat.math.ethz.ch
 Subject: Re: R-alpha: list assignment

 Peter,
   They don't work on purpose. Basically this is the same problem as indexing
 beyond the end of an array. In almost all cases it is an error.
 To add a variable with a specific name to a data frame how about

 x (the dataframe)
 var1 the variable
 name1 the name

  x<-cbind(x,var1)
  names(x)[ncol(x)]<-name1

 robert
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From pgilbert@bank-banque-canada.ca  Mon Nov 10 16:43:11 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Mon, 10 Nov 1997 11:43:11 -0500
Subject: R-alpha: Re: R/R-minus incompatibility [ an old one ]
References: <199711101600.RAA08965@sophie.ethz.ch>
Message-ID: <97Nov10.115122est.26514@mailgate.bank-banque-canada.ca>

>> x[["f"]]<-1
 >> zz<-"g"
 >In R both variants fail unless the name is already on the list. The
 >first one can be replaced by x$f, but there's seems to be no
 >substitute for the other one (oh yes I found one, but it's not fit to

A long time ago it seems it was decided to remain incompatible with S on
this, I think because  people often do this in error. (Indeed, it did
point out some errors in my code.) However, there were some instances in
my code where I did something like x[[c("f","g","h")]] <- 1:3 and wanted
the corresponding elements updated or inserted as appropriate.  I have
replaced those instances with listadd(x, c("f","g","h")) <- 1:3 where
listadd is as defined below (more or less as suggested by Ross or Robert
at the time). It is one of the functions in the compatibility code I
have circulated previously.

Paul Gilbert
________
   "list.add<-" <- function(x, replace, value)
     {# replace or add elements to a list.
      if (is.numeric(replace))
        {x[[replace]] <- value
         return(x)
        }
      if (is.null(value))  value <- list(NULL)
      if (!is.list(value)) value <- list(value)
      if (1 == length(value))
       {for (i in seq(length(replace)))
          x<- do.call("$<-", list(x,replace[i],value[[1]]))
       }
      else
        {if(length(value) != length(replace) )
         stop("number of replacement values != number of elements to
replace")
         for (i in seq(length(replace)))
            x<- do.call("$<-", list(x,replace[i],value[[i]]))
        }
      x
     }


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From pgilbert@bank-banque-canada.ca  Mon Nov 10 16:56:06 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Mon, 10 Nov 1997 11:56:06 -0500
Subject: R-alpha: loop speed
Message-ID: <97Nov10.120407est.26511@mailgate.bank-banque-canada.ca>

I noticed Doug only circulated the following on S-news, but it may be of
interest to R users who don't follow S-news. His findings are certainly
consistent with my own, where my problems often force me into the
element by element type of situation.

Paul Gilbert
_______
At the risk of beating this example to death, I went back and compared
the execution time for the element-by-element method with that of the
indexing method.  At vector sizes of 50000 the indexing method is
close to 500 times faster.

 S-PLUS : Copyright (c) 1988, 1996 MathSoft, Inc.
 S : Copyright AT&T.
 Version 3.4 Release 1 for Sun SPARC, SunOS 5.3 : 1996
 Working data will be in .Data
 > x <- rnorm(50000)
 > y <- rnorm(50000)
 > op <- sample(c("*","+","-","/"), 50000, repl = T)
 > foo <-
 + function(x, y, op)
 + {
 +   z <- x
 +   for(i in seq(along = op))
 +     z[i] <- do.call(op[i], list(x[i], y[i]))
 +   z
 + }
 > unix.time(res1 <-
cbind(x*y,x-y,x+y,x/y)[cbind(seq(along=x),match(op,c("*", "-", "+",
"/")))])
 [1] 0.40000010 0.04999995 0.00000000 0.00000000 0.00000000
 > length(res1)
 [1] 50000
 > unix.time(res2 <- foo(x, y, op))
 [1] 196.23   0.29 199.00   0.00   0.00
 > length(res2)
 [1] 50000
 > all.equal(res1, res2)
 [1] T

It is interesting that the difference in execution speed when using R is

much less than when using S-PLUS.  On this machine (Sun UltraSparc 1
running Solaris 2.5.1) R is somewhat slower than S-PLUS for the
indexing version but close to 10 times faster for the
element-by-element version

 R> unix.time(res1 <-
cbind(x*y,x-y,x+y,x/y)[cbind(seq(along=x),match(op,c("*", "-", "+",
"/")))])
 [1] 1.55 0.07 2.00 0.00 0.00
 R> unix.time(res2 <- foo(x, y, op))
 [1] 23.96  0.05 24.00  0.00  0.00
 R> all(res1 == res2)
 [1] TRUE

--
Douglas Bates                            bates@stat.wisc.edu
Statistics Department                    608/262-2598
University of Wisconsin - Madison
http://www.stat.wisc.edu/~bates/



=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From ihaka@stat.auckland.ac.nz  Mon Nov 10 20:00:55 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Tue, 11 Nov 1997 09:00:55 +1300 (NZDT)
Subject: R-alpha: loop speed
Message-ID: <199711102000.JAA20068@stat1.stat.auckland.ac.nz>

	From r-devel-owner@stat.math.ethz.ch Tue Nov 11 05:58 NZD 1997
	Date: Mon, 10 Nov 1997 11:56:06 -0500
	From: Paul Gilbert <pgilbert@bank-banque-canada.ca>

	 S> unix.time(res1 <-
	cbind(x*y,x-y,x+y,x/y)[cbind(seq(along=x),match(op,c("*", "-", "+",
	"/")))])
	 [1] 0.40000010 0.04999995 0.00000000 0.00000000 0.00000000

	 R> unix.time(res1 <-
	cbind(x*y,x-y,x+y,x/y)[cbind(seq(along=x),match(op,c("*", "-", "+",
	"/")))])
	 [1] 1.55 0.07 2.00 0.00 0.00

We have received a patch from someone in CS at Berkeley which will
be in 0.60 and should claw back a decent fraction of the difference
between R and S in this comparison.  [ It eliminates our use of the
% operator in the loops for +, -, * / etc. ]

The looping speed was an original design goal for R.  It's good to
know that it hasn't been fixed (yet).

	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From thomas@biostat.washington.edu  Mon Nov 10 20:19:01 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Mon, 10 Nov 1997 12:19:01 -0800 (PST)
Subject: R-alpha: loop speed
In-Reply-To: <97Nov10.120407est.26511@mailgate.bank-banque-canada.ca>
Message-ID: <Pine.SUN.3.95.971110110012.1963A-100000@troi>

On Mon, 10 Nov 1997, Paul Gilbert wrote:

> I noticed Doug only circulated the following on S-news, but it may be of
> interest to R users who don't follow S-news. His findings are certainly
> consistent with my own, where my problems often force me into the
> element by element type of situation.

It is also interesting to look at the allegedly realistic if extreme
benchmark program provided with Matt Calder's partial S compiler. 

        LMS <- function(M, N)
        {
                ### Pre-allocate result and filter. ###
                R <- matrix(0,nrow=M, ncol=5)
                W <- rep(0,5)
                for (i in 1:M) {
                        ### Simulate MA(1) ###
                        Z <- rnorm(N+1)
                        X <- Z[2:(N+1)] + 0.5 * Z[1:N]
                        ### Perform LMS ###
                        for (j in 5:N) {
                                U <- X[j:(j-4)]
                                E <- Z[j+1] - sum(W * U)
                                W <- W + 0.1* E * U
                        }
                        ### Save final result ###
                        R[i,] <- W
                }
                return(R)
        }


I used this in S, R and compiled to C on an Ultra 1 (Solaris) and in R and
compiled to C on a Pentium Pro 150 under Linux

The results are quite interesting. These are CPU times in seconds for a
fixed value of N (100, I believe, but it was some time ago)

	Ultra             Intel
M     R     C    S      R      C
100  7.24  2.08  11    6.38   0.79
200 14.19  4.06  25.8  12.36  1.56
300 21.59  6.3   56.8  18.89  2.31
400 28.76  8.37  89    24.97  3.09
800 57.62 16.42 295    50.33  6.16

The time taken by R scales roughly linearly with M, S time grows much
faster. The two are comparable for small M. It's also interesting that the
Intel machine was slightly faster, though this doesn't translate to disk
and memory intensive tasks. 


Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From Friedrich.Leisch@ci.tuwien.ac.at  Tue Nov 11 09:33:23 1997
From: Friedrich.Leisch@ci.tuwien.ac.at (Friedrich Leisch)
Date: Tue, 11 Nov 1997 10:33:23 +0100
Subject: R-alpha: christmas wish (partial support for single)
Message-ID: <199711110933.KAA24602@galadriel.ci.tuwien.ac.at>


The following is a re-post (after suggestion from martin) of a mail I
sent to r-core this morning, maybe some of you are interested:


>>>>> On Tue, 11 Nov 1997 08:34:16 +0100,
>>>>> Kurt Hornik (KH) wrote:

KH> As Andreas & Fritz & I have recently, in attempts to port various pkgs
KH> to R, come across the f2c problem again, I thought I'd ask ...

KH> Some time ago, someone (Ross?) suggested that we'd have an f2c add-on
KH> package.  Is this still in the making somewhere?

If we talk about porting packages to R ... well, christmas is
approaching rapidly, so it's that time of the year again where people
think a lot about wishes :-)

The only effort that's involved when porting most pkg's is that R
doesn't support single precision ... well I don't need single
precision through the whole thing, but perhaps .Fortran could be
enhanced to support it? 

I think of something like single() (and friends) attaching an
attribute single to a numeric variable, and if .Fortran detects it, it
converts the stuff internally to single before passing it to the
subroutine. We could also introduce mode "single" which is exactly the
same as "numeric", but .Fortran respects it.

... just an idea, there are probably 1000 other ways of doing it
without introducing single for all things ... but it would ease
porting packages considerably for people who are not used to
programming Fortran or C. I do speak C, but still I'm always afraid of
breaking some code when changing all those real definitions to double
...

That's not urgent, but maybe we could start thinking about it.

Best,
Fritz


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From Friedrich.Leisch@ci.tuwien.ac.at  Tue Nov 11 11:02:39 1997
From: Friedrich.Leisch@ci.tuwien.ac.at (Friedrich Leisch)
Date: Tue, 11 Nov 1997 12:02:39 +0100
Subject: R-alpha: help files of base package
Message-ID: <199711111102.MAA24731@galadriel.ci.tuwien.ac.at>

		[this message bounced, because it had 'help'
		 at beginning of Subject.  Now sent as "approved". -- MM]

I'm not happy at all with the html and latex version of the base help
files, because presenting (currently) 320 files in alphabetic order is
not a good way for unexperienced users.

I'm thinking about introducing a new command like \category or
whatever to split the help files up into parts like


graphics commands
random numbers
linear models
input/output
...


such that we can organize things a little bit. this way we could also
have a concise index of ALL functions available that is still
helpfull. 

somthing like the categories list in the R-minus help window ...

what do you think?

how to organize such a thing (besides providing the technical means)?

fritz
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Nov 11 17:01:11 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 11 Nov 1997 18:01:11 +0100
Subject: R-alpha: help files of base package
In-Reply-To: <199711111102.MAA24731@galadriel.ci.tuwien.ac.at> (message from
 Friedrich Leisch on Tue, 11 Nov 1997 12:02:39 +0100)
Message-ID: <199711111701.SAA10204@sophie.ethz.ch>

>>>>> "FrL" == Friedrich Leisch <Friedrich.Leisch@ci.tuwien.ac.at> writes:

    FrL> I'm not happy at all with the html and latex version of the base
    FrL> help files, because presenting (currently) 320 files in alphabetic
    FrL> order is not a good way for unexperienced users.

One thing which could and should be changed immediately, is to
1)  have a new chapter or section for each package in  Man.tex,
2)  Use a tableofcontents at the beginning
Currently (with 'base' 'eda' and 'mva') We just have 'xy.coords' (last of
base) followed by 'line' (first of 'eda').

ok.
For the inexperienced one, I think we need the "Rnotes chapters" part of
the manual, anyway...

    FrL> I'm thinking about introducing a new command like \category or
    FrL> whatever to split the help files up into parts like
    FrL> graphics commands random numbers linear models input/output ...

Fritz, you must know that I had emphasized the introduction of \keyword{.}
a few months ago.

If you read current appendix A  ``Writing R Documentation'', you find (p.2)
that I say how (one or more) "\keyword{.}" should be used.
I've put several dozens of these \keyword{.} in several of the  *.Rd
files, also, but then I lacked time (and motivation because nobody
encouraged me .. ;-} ).

I also made a point to write  RHOME/doc/KEYWORDS
(was RHOME/mansrc/KEYWORDS in version 0.50) and mentioned it in
the output of  prompt(foo) and the above appendix A.

My goal has always been to have categories
 (these, as you see in KEYWORDS, are further grouped into "Hyper-Categories"). 
for online help  AND  printed documentation.

The point is:  Many functions (& and help files) should have more than one
keyword, since they belong into more than one category.
This is quite fine for   topics() and help.start() [HTML help],
but it is not so easy for printed documentation.

We could resolve the problem by defining the convention
that for printed docu, only the FIRST keyword will be used.

    FrL> such that we can organize things a little bit. this way we could
    FrL> also have a concise index of ALL functions available that is still
    FrL> helpfull.

Index, YES(!)   ((I've always wanted to do this for quite a while...)
		The index should have an entry 'foobar' for each \alias foobar.
This could be started immediately, as of now.
It is very useful anyway (i.e. even with alphabetically sorted man pages), and
has no real connection to the \keyword / category  side.


    FrL> what do you think?

    FrL> how to organize such a thing (besides providing the technical
    FrL> means)?

It's a good idea (not new however)
which needs quite a bit of work to be properly implemented
(editing hundreds of .Rd files  AFTER thinking which keywords to use...).
	
Once you have these categories, you'll want to rely on them.
Therefore, wrong, misspelled or missing keywords WILL be a more severe
problem than other typos / inaccuracies in *.Rd files.

Still, I am deeply convinced that its worth the work.
If several people divided it up, it would be even more fun
(and probably lead to a better  result).

If you start doing the ``technical means''
[[ Enhancing  Rdconv (and  Rd.sty, functions.html) for  latex and html ]],
I'd be very much motivated to restart on the big job of putting in more
\keywords. 
As said, maybe it'll be better to divide this up among several people.

- Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From p.dalgaard@kubism.ku.dk  Tue Nov 11 19:11:02 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 11 Nov 1997 20:11:02 +0100
Subject: R-alpha: help files of base package
In-Reply-To: Friedrich Leisch's message of Tue, 11 Nov 1997 12:02:39 +0100
References: <199711111102.MAA24731@galadriel.ci.tuwien.ac.at>
Message-ID: <x2k9ef2qm1.fsf@blueberry.kubism.ku.dk>

Friedrich Leisch <Friedrich.Leisch@ci.tuwien.ac.at> writes:

> I'm not happy at all with the html and latex version of the base help
> files, because presenting (currently) 320 files in alphabetic order is
> not a good way for unexperienced users.

You're not alone... but I'm afraid that this is something very
difficult to do right. Some things are easy, i.e. factor out graphics
functions and linear models, but other things might be difficult to
structure right, e.g. what goes in a "core" part? arithmetic?
programming constructs? etc.

> what do you think?
> 
> how to organize such a thing (besides providing the technical means)?

I think we need to think for a while and try some things and see how
they work. One technical means that I've been wanting is a way to
extract a mini-manual to go with the reduced curriculum in my medical
PhD course. (Or maybe it's there already and I just didn't have the
time to find out?)

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From Friedrich.Leisch@ci.tuwien.ac.at  Wed Nov 12 07:52:05 1997
From: Friedrich.Leisch@ci.tuwien.ac.at (Friedrich Leisch)
Date: Wed, 12 Nov 1997 08:52:05 +0100
Subject: R-alpha: help files of base package
In-Reply-To: <199711111701.SAA10204@sophie.ethz.ch>
References: <199711111102.MAA24731@galadriel.ci.tuwien.ac.at>
 <199711111701.SAA10204@sophie.ethz.ch>
Message-ID: <199711120752.IAA25461@galadriel.ci.tuwien.ac.at>

>>>>> On Tue, 11 Nov 1997 18:01:11 +0100,
>>>>> Martin Maechler (MM) wrote:

>>>>> "FrL" == Friedrich Leisch <Friedrich.Leisch@ci.tuwien.ac.at> writes:
FrL> I'm not happy at all with the html and latex version of the base
FrL> help files, because presenting (currently) 320 files in alphabetic
FrL> order is not a good way for unexperienced users.

MM> One thing which could and should be changed immediately, is to
MM> 1)  have a new chapter or section for each package in  Man.tex,
MM> 2)  Use a tableofcontents at the beginning

Ok, that Man.tex needs re-organization is obvious now that we have tex
files for all installed pkg's. But that doesn't help with the html
pages. 



MM> ok.
MM> For the inexperienced one, I think we need the "Rnotes chapters" part of
MM> the manual, anyway...

Second thing is that a couple of students complained about the R-notes
... they simply don't think it's a good intro to R because it's rather
longish, but has bo index etc. ... I can't complain about it, but I
had this feedback from several R novices independently. Has anybody
had similar experiences?



FrL> I'm thinking about introducing a new command like \category or
FrL> whatever to split the help files up into parts like
FrL> graphics commands random numbers linear models input/output ...

MM> Fritz, you must know that I had emphasized the introduction of \keyword{.}
MM> a few months ago.

Oh, sorry, I just reread my email fromn yesterday ... when I started
to write it I wanted to put something in like ``this has to be done in
connection with the current keyword concept'' but then forgot to
actually write the line ... SORRY!

Making html index pages for all keywords would be a possibility, but
But as you said: I'm not sure how this would affect printed
documentation ... I still think that the latex part of base should
have subsections ...

MM> If you read current appendix A  ``Writing R Documentation'', you find (p.2)
MM> that I say how (one or more) "\keyword{.}" should be used.
MM> I've put several dozens of these \keyword{.} in several of the  *.Rd
MM> files, also, but then I lacked time (and motivation because nobody
MM> encouraged me .. ;-} ).

Please see this as STRONG encouragement!



MM> I also made a point to write  RHOME/doc/KEYWORDS
MM> (was RHOME/mansrc/KEYWORDS in version 0.50) and mentioned it in
MM> the output of  prompt(foo) and the above appendix A.

MM> My goal has always been to have categories
MM>  (these, as you see in KEYWORDS, are further grouped into "Hyper-Categories"). 
MM> for online help  AND  printed documentation.

MM> The point is:  Many functions (& and help files) should have more than one
MM> keyword, since they belong into more than one category.
MM> This is quite fine for   topics() and help.start() [HTML help],
MM> but it is not so easy for printed documentation.

MM> We could resolve the problem by defining the convention
MM> that for printed docu, only the FIRST keyword will be used.

FrL> such that we can organize things a little bit. this way we could
FrL> also have a concise index of ALL functions available that is still
FrL> helpfull.

MM> Index, YES(!)   ((I've always wanted to do this for quite a while...)
MM> 		The index should have an entry 'foobar' for each \alias foobar.
MM> This could be started immediately, as of now.
MM> It is very useful anyway (i.e. even with alphabetically sorted man pages), and
MM> has no real connection to the \keyword / category  side.


FrL> what do you think?

FrL> how to organize such a thing (besides providing the technical
FrL> means)?

MM> It's a good idea (not new however)

I'm aware of that ... most good ideas aere not new ... just wanted to
restart discussion ...

MM> which needs quite a bit of work to be properly implemented
MM> (editing hundreds of .Rd files  AFTER thinking which keywords to use...).

exactly!

that's why I thought about introducing \category{} ... but simly using
the first keyword would be fine with me ...

We could start (and that shouldn't be too much work) with a rather
small set of obvious hyper-keywords/categories to group things a
little bit ... of course with goal of a larger set of keywords
providing finer clusters in the long run.

MM> Once you have these categories, you'll want to rely on them.
MM> Therefore, wrong, misspelled or missing keywords WILL be a more severe
MM> problem than other typos / inaccuracies in *.Rd files.

MM> Still, I am deeply convinced that its worth the work.
MM> If several people divided it up, it would be even more fun
MM> (and probably lead to a better  result).

MM> If you start doing the ``technical means''
MM> [[ Enhancing  Rdconv (and  Rd.sty, functions.html) for  latex and html ]],
MM> I'd be very much motivated to restart on the big job of putting in more
MM> \keywords. 
MM> As said, maybe it'll be better to divide this up among several people.

Yes!



Best,
Fritz
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From jlindsey@luc.ac.be  Wed Nov 12 08:58:18 1997
From: jlindsey@luc.ac.be (Jim Lindsey)
Date: Wed, 12 Nov 1997 09:58:18 +0100 (MET)
Subject: R-alpha: glm
Message-ID: <9711120858.AA24449@alpha.luc.ac.be>

Here is another bug in glm. Occasionally, with log linear models for
small tables, there can be more parameters (many aliased) than cells
in the table. Then, glm does not work. The problem is in the qr
decomposition. Here is a quick hack that works, although not very
elegant.
  In glm.fit, replace l. 254

Rmat <- fit$qr[1:nvars, 1:nvars]

by

Rmat <- diag(nvars)
nr <- min(sum(good),nvars)
Rmat[1:nr,1:nvars] <- fit$qr[1:nr,1:nvars]

  Jim
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From jlindsey@luc.ac.be  Wed Nov 12 09:03:59 1997
From: jlindsey@luc.ac.be (Jim Lindsey)
Date: Wed, 12 Nov 1997 10:03:59 +0100 (MET)
Subject: R-alpha: NextMethod
Message-ID: <9711120903.AA19776@alpha.luc.ac.be>

Here is something that I am sure has been discussed before, but I
don't understand what is going on.
  I am building some functions for ordinal variables on top of the glm
class. Take one with class lmov as well as glm and lm in that order.
In summary.lmov and print.lmov, is print out some information and then
use NextMethod. summary works fine in all cases. However, if z has
class lmov, print(z) works fine but just typing the name, z, prints
out what I want in print.lmov and then says it cannot find print.lmov
instead of using print.glm (which it finds when print(z) is used).
  Jim
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From jlindsey@luc.ac.be  Wed Nov 12 09:17:52 1997
From: jlindsey@luc.ac.be (Jim Lindsey)
Date: Wed, 12 Nov 1997 10:17:52 +0100 (MET)
Subject: R-alpha: batch
Message-ID: <9711120917.AA21246@alpha.luc.ac.be>

Back to my favourite R subject: batch mode. Some months ago, I pointed
out how the default of saving .RData automatically in batch can often
lead to completely erroneous results when using data.frames. Basically
the idea of .RData is to save the environment to start where one left
off. This will generally be quite different than where one started
the session. The idea of a batch file is to redo a session and create
hard copy of it. Hence one wants to start at the beginning, not the
end. So a .RData file must absolutely not be present. The same holds
if you run a batch file twice. The first time it must not create an
.RData. Otherwise, completely wrong results can be produced the second
time.
  Martin suggested a work around by having a final line in each file
that tests for interactive. This is fine if you remember to put it in
all files. Here is an example of a further problem that hit me the
other day. I am developing some new libraries containing C code. At a
certain point, I wanted hard copy, from batch, before changing the C
to compare before and after. My file has a library call in it (but I
forgot the test on the last line). I ran the batch then went back to
interactive. When I loaded the library and tried to run the C code, it
said that it was not in the load table. Because I was debugging, it
took me quite awhile to discover that the problem was the .RData
created behind my back.
  When is the default going to be changed to not saving the .RData in
batch mode???? Does anyone use batch mode except me?
  Jim
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From plindsey@luc.ac.be  Wed Nov 12 09:19:20 1997
From: plindsey@luc.ac.be (Patrick Lindsey)
Date: Wed, 12 Nov 1997 10:19:20 +0100 (MET)
Subject: R-alpha: Bug in postscript command with boxplots.
Message-ID: <9711120919.AA19072@alpha.luc.ac.be>

In R-0.50-a3, problems occurs when creating a postscript file of
a boxplot. Just using the boxplot command works fine (on the screen).
> x11()
> boxplot(x)

But, once the postscript command is used to capture a boxplot, the
horizontal lines are missing in the file.
> postscript("new.ps",landscape=F)
> boxplot(x)
> dev.off()

On the other hand, using the save.plot command creates a postscript file
of a boxplots which is fine.
> x11()
> boxplot(x)
> save.plot("new.ps")

Patrick.
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From phlamber@luc.ac.be  Wed Nov 12 09:44:32 1997
From: phlamber@luc.ac.be (Philippe Lambert)
Date: Wed, 12 Nov 1997 10:44:32 +0100 (MET)
Subject: R-alpha: Optimize
Message-ID: <Pine.OSF.3.96.971112103643.2170A-100000@alpha>

The function optimize returns the opposite value of the objective
when maximizing:

> f <- function(x) -x**2+1
> optimize(f,c(-5,5),maximum=TRUE)
$maximum
[1] 0

$objective
[1] -1

> f(0)
[1] 1

What should be corrected:

> optimize
function (f, interval, lower = min(interval), upper = max(interval), 
        maximum = FALSE, tol = .Machine$double.eps^0.25, ...) 
{
        if (maximum) {
                val <- .Internal(fmin(function(arg) -f(arg, ...), 
                        lower, upper, tol))
                list(maximum = val, objective = -f(val,...)
                                               ^^^
SHOULD BE +f(val,...) <-------------------------|

   Philippe

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From Martin Maechler <maechler@stat.math.ethz.ch>  Wed Nov 12 09:48:09 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 12 Nov 1997 10:48:09 +0100
Subject: R-alpha: batch -- no problem with make and proper Makefile
In-Reply-To: <9711120917.AA21246@alpha.luc.ac.be> (message from Jim Lindsey on
 Wed, 12 Nov 1997 10:17:52 +0100 (MET))
Message-ID: <199711120948.KAA10947@sophie.ethz.ch>

Yes, I use batch too.

In addition, I also use 'make' consistently
My current approach (this is Makefile syntax)
Just
	@-rm -f .RData
	R < input > output	


Actually, I'm a bit smarter and have a Makefile of the form

##--------------------- Makefile for different R batch jobs ----------
##----------------------------- Martin Maechler ----------------------	
R = /usr/local/bin/R
R = /usr/local/bin/R-MM

TESTsrc = str-test.R foobar.R thistest.R  thattest.R
TESTout = $(TESTsrc:.R=.Rout)

%.Rout: %.R
	if [ -f .RData ];   then mv .RData .RData-mm; fi
	if [ -f .Rprofile ];then mv .Rprofile .Rprofile-mm; fi
	touch .Rprofile;
	(echo '##-*- R-transcript -*- --- empty .Rprofile'; $(R) < $< ) > $@
	-@wc $@

all: tests
tests: $(TESTout)

str-test.Rout:: str-src.R

clean: ; mv $(TESTout) out-safe/ ; rm -f $(Shars)
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From p.dalgaard@kubism.ku.dk  Wed Nov 12 10:34:40 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 12 Nov 1997 11:34:40 +0100
Subject: R-alpha: help files of base package
In-Reply-To: Friedrich Leisch's message of Wed, 12 Nov 1997 08:52:05 +0100
References: <199711111102.MAA24731@galadriel.ci.tuwien.ac.at>
 <199711111701.SAA10204@sophie.ethz.ch>
 <199711120752.IAA25461@galadriel.ci.tuwien.ac.at>
Message-ID: <x2affaxuwv.fsf@blueberry.kubism.ku.dk>

Friedrich Leisch <Friedrich.Leisch@ci.tuwien.ac.at> writes:

> Second thing is that a couple of students complained about the R-notes
> ... they simply don't think it's a good intro to R because it's rather
> longish, but has bo index etc. ... I can't complain about it, but I
> had this feedback from several R novices independently. Has anybody
> had similar experiences?

Hmm, when students say that something is not good enough, they're in a
sense right by definition (excepting cases where student aggravation
is used as a deliberate pedagogical tool -- something *I* wouldn't
dare try...), but that doesn't mean that the reasons they give should
be taken at face value.

I'd say that R-notes is about three times too *short* for a tutorial.
Discounting the examples it's about 60 pages; the notes I'm writing
for my medical PhD's are already twice that size and will probably end
somewhere around 170 pages, and this covers absolutely *no*
programming. Also, R-notes has no pedagogical sequencing (i.e. read
the first n pages and be able to do something useful, the next n
learning some more, etc.), no repetition and extension of earlier
stuff, etc.

There's nothing really wrong with that, because that isn't the kind of
document the R-notes tries to be, it's more of a structured language
overview. Some people can actually learn the language from that kind
of material alone (it's certainly better than starting from the manual
pages), but many others will feel it's like learning a human language
from a grammar book. Once you *have* learned it, document like R-notes
become much more useful than tutorial because of the stricter
structure. An index would probably be a good thing in all cases,
though.

What experience do people have with textbooks on S? Do we already have
something that fits the students' (i.e. our) needs or do "we" need to
write it ourself? (Not quite knowing who "we" should be..)

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From p.dalgaard@kubism.ku.dk  Wed Nov 12 10:57:14 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 12 Nov 1997 11:57:14 +0100
Subject: R-alpha: batch
In-Reply-To: Jim Lindsey's message of Wed, 12 Nov 1997 10:17:52 +0100 (MET)
References: <9711120917.AA21246@alpha.luc.ac.be>
Message-ID: <x290uuxtv9.fsf@blueberry.kubism.ku.dk>

Jim Lindsey <jlindsey@luc.ac.be> writes:

>   When is the default going to be changed to not saving the .RData in
> batch mode???? Does anyone use batch mode except me?

One rather nasty thing to consider is that interactivity is (as I
understand it) detectable only by the existence of a controlling
terminal. This can cause trouble with cases where the controlling
terminal disappears, one case being upon logout from the windows
system or a system shutdown. Presumably, most people prefer their work
to be saved in those cases.

What might be a much better idea is to make the saving (and loading
too) of .Rdata into command line options, so that

R BATCH filein fileout

would translate into 

R -nosaveimg -noloadimg < filein > fileout

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From jlindsey@luc.ac.be  Wed Nov 12 13:16:12 1997
From: jlindsey@luc.ac.be (Jim Lindsey)
Date: Wed, 12 Nov 1997 14:16:12 +0100 (MET)
Subject: R-alpha: glm cont.
Message-ID: <9711121316.AA11236@alpha.luc.ac.be>

Here is a quick example that the uncorrected glm cannot fit. Suppose
that freq contains the nine values from a 3x3 contingency table, fac1
and fac2 the factor variables indexing the margins, and lin1 and lin2
the corresponding linear variables. Then without my correction, glm
cannot fit 
glm(freq~fac1+fac2+fac1:lin2+fac2:lin1,family=poisson)
because there are 11 variable combinations (3 aliased) and only 9
observations.
  Jim
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From jlindsey@luc.ac.be  Wed Nov 12 13:29:39 1997
From: jlindsey@luc.ac.be (Jim Lindsey)
Date: Wed, 12 Nov 1997 14:29:39 +0100 (MET)
Subject: R-alpha: batch
In-Reply-To: <x290uuxtv9.fsf@blueberry.kubism.ku.dk> from "Peter Dalgaard BSA" at Nov 12, 97 11:57:14 am
Message-ID: <9711121329.AA12443@alpha.luc.ac.be>

  Following on Peter's suggestion, if there is going to be a recognized
batch mode that does not save the .RData, then why not just change the
default option in the C code? Only one number has to be changed.
  Up until this version, I systematically did this. But now I am
developing R code to go on a CD for the second edition of my repeated
measures book so I have to be using a standard R, not a specially
compiled one to my tastes.
  As to wanting an .RData if the terminal disappears. Basically, I
never want an .RData. I have the input and hopefully the output files.
If I am working on an article, I keep all relevant data sets and
analyses in the same directory. If I am working on one of my books, I
keep data analyses by chapter. If I am doing consulting, I often have
several distinct analyses of a data set, all in the same directory.
None of these is conducive to using .RData. I just don't like the
S-Plus habit of automatically and silently loading in what you last
did when you may not even remember what it was a couple of weeks ago.
  I have lost too many hours trying to figure out why analyses are not
calculated correctly when it was just a hidden .RData from a batch
job.
  Jim
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From pgilbert@bank-banque-canada.ca  Wed Nov 12 15:13:58 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Wed, 12 Nov 1997 10:13:58 -0500
Subject: R-alpha: help files of base package
References: <199711111102.MAA24731@galadriel.ci.tuwien.ac.at>
 <199711111701.SAA10204@sophie.ethz.ch> <199711120752.IAA25461@galadriel.ci.tuwien.ac.at>
Message-ID: <97Nov12.101538est.26514@mailgate.bank-banque-canada.ca>

>Making html index pages for all keywords would be a possibility, but...

It might be better and easier to use a general purpose full texted
search such as the one for S-news at statlib
<http://lib.stat.cmu.edu/s-news>. It is all done with publicly available
programs. It sure would be nice to have that facility for R-help as
well.

Paul Gilbert


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From Friedrich.Leisch@ci.tuwien.ac.at  Wed Nov 12 15:31:58 1997
From: Friedrich.Leisch@ci.tuwien.ac.at (Friedrich Leisch)
Date: Wed, 12 Nov 1997 16:31:58 +0100
Subject: R-alpha: help files of base package
In-Reply-To: <97Nov12.101538est.26514@mailgate.bank-banque-canada.ca>
References: <199711111102.MAA24731@galadriel.ci.tuwien.ac.at>
 <199711111701.SAA10204@sophie.ethz.ch>
 <199711120752.IAA25461@galadriel.ci.tuwien.ac.at>
 <97Nov12.101538est.26514@mailgate.bank-banque-canada.ca>
Message-ID: <199711121531.QAA26226@galadriel.ci.tuwien.ac.at>

>>>>> On Wed, 12 Nov 1997 10:13:58 -0500,
>>>>> Paul Gilbert (PG) wrote:

>> Making html index pages for all keywords would be a possibility, but...
PG> It might be better and easier to use a general purpose full texted
PG> search such as the one for S-news at statlib
PG> <http://lib.stat.cmu.edu/s-news>. It is all done with publicly available
PG> programs. It sure would be nice to have that facility for R-help as
PG> well.

That's something with top priority on my list ...

I already wanted to do that earlier and sent a corresponding email
(hopefully not only to R-core) ... searching the pages would be
definetely an absolute great thing.

My only problem is how to setup such a thing without a
web-server. All software packages I'm aware of use cgi scripts and
need a http server running. That's something we want to avoid, because
not everybody running R has the means of running an http server.

If you (or somebody else) could provide me with software to do such a
search without need for a http server that would definetely be one of
the next things for me to include into the R help system.

Otherwise we could take a vote if we still want search depending on
the existence of a http server ... in that case I'm aware of several
GPL'ed search packages, e.g., we use htdig here for our web server.



Best,
Fritz
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From pgilbert@bank-banque-canada.ca  Wed Nov 12 16:55:26 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Wed, 12 Nov 1997 11:55:26 -0500
Subject: R-alpha: help files of base package
References: <199711111102.MAA24731@galadriel.ci.tuwien.ac.at>
 <199711111701.SAA10204@sophie.ethz.ch>
 <199711120752.IAA25461@galadriel.ci.tuwien.ac.at>
 <97Nov12.101538est.26514@mailgate.bank-banque-canada.ca> <199711121531.QAA26226@galadriel.ci.tuwien.ac.at>
Message-ID: <97Nov12.115723est.26522@mailgate.bank-banque-canada.ca>

>If you (or somebody else) could provide me with software to do such a
>search without need for a http server that would definetely be one of
>the next things for me to include into the R help system.

I'm afraid I don't know how to do this. I assume the http server uses a
cgi which runs something to do the search, and this could probably be
run without the server. But then you might be faced with building an
non-HTML user interface, which might not be so easy. On the other hand,
if you can run it directly from R, rather than from an HTML form, it
might work with other help formats as well.

Best of luck,
Paul

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From Friedrich.Leisch@ci.tuwien.ac.at  Wed Nov 12 17:50:44 1997
From: Friedrich.Leisch@ci.tuwien.ac.at (Friedrich Leisch)
Date: Wed, 12 Nov 1997 18:50:44 +0100
Subject: R-alpha: help files of base package
In-Reply-To: <97Nov12.115723est.26522@mailgate.bank-banque-canada.ca>
References: <199711111102.MAA24731@galadriel.ci.tuwien.ac.at>
 <199711111701.SAA10204@sophie.ethz.ch>
 <199711120752.IAA25461@galadriel.ci.tuwien.ac.at>
 <97Nov12.101538est.26514@mailgate.bank-banque-canada.ca>
 <199711121531.QAA26226@galadriel.ci.tuwien.ac.at>
 <97Nov12.115723est.26522@mailgate.bank-banque-canada.ca>
Message-ID: <199711121750.SAA26340@galadriel.ci.tuwien.ac.at>

>>>>> On Wed, 12 Nov 1997 11:55:26 -0500,
>>>>> Paul Gilbert (PG) wrote:

>> If you (or somebody else) could provide me with software to do such a
>> search without need for a http server that would definetely be one of
>> the next things for me to include into the R help system.

PG> I'm afraid I don't know how to do this.

welcome to the club ...

PG> I assume the http server uses a
PG> cgi which runs something to do the search, and this could probably be
PG> run without the server.

yes

PG> But then you might be faced with building an
PG> non-HTML user interface, which might not be so easy. On the other hand,
PG> if you can run it directly from R, rather than from an HTML form, it
PG> might work with other help formats as well.

well, it could probably be done without troubles in a java script
... but I've never programmed java before ... so that's more of a long
term project ... 

has anybody some spare time to help out?

best,
fritz
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From jlindsey@luc.ac.be  Fri Nov 14 08:33:48 1997
From: jlindsey@luc.ac.be (Jim Lindsey)
Date: Fri, 14 Nov 1997 09:33:48 +0100 (MET)
Subject: R-alpha: Design and Hmisc
Message-ID: <9711140833.AA32283@alpha.luc.ac.be>

I have been looking at porting Design and Hmisc to R. Unfortunately, I
know nothing about S and do not have access to it. Basically what I
have found is that many functions work directly, as long as they do
not involve data.frames or models. These two create a lot of
incompatibilities.
  Here is what I had to do to get the functions to load:
1. R INSTALL ignores function names beginning with a capital letter.
2. A semicolon between if and else gives an error:
   if( ) expr1 ; else expr2
3. strings cannot be broken over two lines
4. checks on the OS have to be changed to use machine()
5. synchronize() does not exist
6. single has to be changed to double (warning only)
Then when they are finally loaded, nothing connected with models works
anymore, not even glm!
There are a number of missing functions:
1. category, as.category, is.category (the latter is in header.R of
survival4) These need to be written so that they are numeric but
level() works properly.
2. terms.inner (this is called by newsurvival4.R on l.1242 but does
not exist!) Design uses a stripped down version that calls a C
function called all_names. Any idea what this is?
3. The fortran for proportional odds calls directly the fortran
functions underlying the S versions of qr and solve. These appear to
be different modifications of linpack routines than those used in
R. The argument lists are different.

A further incompatibility is that assignments similar to the following
are often used:
Limits <- list()
Limits[["y"]] <- 1
This gives subscript out of bounds.

The S code appears to be very clean (although unreadable because not
properly indented). (This contrasts with Oswald that my son has been
trying to port for the last 6 months and that is extremely poorly
programmed.)  If anyone is interested in pursuing this further, I
shall be happy to forward the results of the 5 or 6 hours work that I
put in to it. For someone who knows S well, I do not think it would be
much work.
  Jim
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Nov 14 17:27:00 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 14 Nov 1997 18:27:00 +0100
Subject: R-alpha: more bugs with names/dims, etc.:
Message-ID: <199711141727.SAA14384@sophie.ethz.ch>


 x_1:4
 data.frame(x=2*x, y=3*x) - structure(x, names=letters[seq(x)])

## R :
## Error in data.frame(x = 2 * x, y = 3 * x) - structure(x, names = letters[seq(x)]) : non-numeric argument to binary operator

## S:
  x y 
1 1 2
2 2 4
3 3 6
4 4 8
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Nov 14 18:16:20 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 14 Nov 1997 19:16:20 +0100
Subject: R-alpha: S-R -- quite a dangerous incompatibility...
Message-ID: <199711141816.TAA14607@sophie.ethz.ch>


any( 1 < 0, na.rm = T) 

##S: FALSE

##R: TRUE		(guess why; the TRUE of  na.rm=T ...)


##-- Of course, the analogon happens for

all( 1 > 0, na.rm = F)

## S : TRUE	
## R : FALSE

-- Martin
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From p.dalgaard@biostat.ku.dk  Fri Nov 14 21:17:34 1997
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 14 Nov 1997 22:17:34 +0100
Subject: R-alpha: S-R -- quite a dangerous incompatibility...
In-Reply-To: Martin Maechler's message of Fri, 14 Nov 1997 19:16:20 +0100
References: <199711141816.TAA14607@sophie.ethz.ch>
Message-ID: <x2lnyr41ld.fsf@blueberry.kubism.ku.dk>

Martin Maechler <maechler@stat.math.ethz.ch> writes:

> 
> 
> any( 1 < 0, na.rm = T) 
> 
> ##S: FALSE
> 
> ##R: TRUE		(guess why; the TRUE of  na.rm=T ...)
> 

Ugh... Root of the problem seems to be that any() and all() don't
understand na.rm=, which they probably should, so it'll go away
eventually. 

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

From p.dalgaard@biostat.ku.dk  Mon Nov 17 21:05:02 1997
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 17 Nov 1997 22:05:02 +0100
Subject: R-alpha: Re: R-beta: installing new packages in window95 version of R
In-Reply-To: Luke Tierney's message of Mon, 17 Nov 1997 11:00:36 -0600 (CST)
References: <9711171700.AA04611@nokomis.stat.umn.edu>
Message-ID: <x2g1ovdyf5.fsf@blueberry.kubism.ku.dk>

Luke Tierney <luke@stat.umn.edu> writes:


> One potential problem is with the calling conventions. Watcom uses a
> register based method that appears to be different from the optional
> resgister-based one under MS. The default under MS is I think a stack
> based convention. If the R .exe is compiled with default calling
> conventions then it *may* work to have MS Fortran generate code for
> regieter-based calls (there may be a flag you can set for that) but
> I'm worried there may be more differences than argument passing, that
> the conventions on who saves and restores other registers may be
> different. If that is indeed the case then calls may appear to work in
> some contexts but not in others.

Yuk!

I want this to work with GCC as cross-compiler
I want this to work with GCC as cross-compiler
I want this to work with GCC as cross-compiler
I want this to work with GCC as cross-compiler
I want this to work with GCC as cross-compiler

- but I don't have the time just yet...

(I've got the crosscompiler, Linux->Win32, but I couldn't figure out
how to get the include files for the windows DDE stuff to behave.
Maybe I should spend some time (if I ever get any) on studying what it
does with DLL's?)

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=---
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=---

From jlindsey@luc.ac.be  Tue Nov 18 09:47:24 1997
From: jlindsey@luc.ac.be (Jim Lindsey)
Date: Tue, 18 Nov 1997 10:47:24 +0100 (MET)
Subject: R-alpha: Student t functions
Message-ID: <9711180947.AA13264@alpha.luc.ac.be>

Some of the Student t functions (e.g. dt) still round the degrees of
freedom to an integer whereas others do not (e.g. pt).
  Jim
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=---
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=---

From bates@stat.wisc.edu  Fri Nov 21 14:28:34 1997
From: bates@stat.wisc.edu (Douglas Bates)
Date: 21 Nov 1997 08:28:34 -0600
Subject: R-alpha: nlm and gradients
Message-ID: <6r4t56qq25.fsf@franz.stat.wisc.edu>

At present the documentation for nlm refers the reader to Dennis and
Schnabel for details on the algorithms.  It also states that the
function is liable to change.

Can anyone tell me if the current version of nlm uses only function
values or if it can use gradients and Hessians when they are
available?  I would like to get an idea of how difficult it would be
to port the development versions of our linear mixed-effects code.

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=---
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=---

From pgilbert@bank-banque-canada.ca  Fri Nov 21 16:08:38 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Fri, 21 Nov 1997 11:08:38 -0500
Subject: R-alpha: nlm
Message-ID: <97Nov21.111118est.26511@mailgate.bank-banque-canada.ca>

>Can anyone tell me if the current version of nlm uses only function
>values or if it can use gradients and Hessians when they are
>available?  I would like to get an idea of how difficult it would be
>to port the development versions of our linear mixed-effects code.

Doug

If you don't get the answer you need regarding nlm, I have some
multivariate code which may help. The code has one problem I know about
(the Hessian estimate is off) but mostly I think it is working well.

Paul

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=---
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=---

From p.dalgaard@biostat.ku.dk  Fri Nov 21 16:34:20 1997
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 21 Nov 1997 17:34:20 +0100
Subject: R-alpha: nlm and gradients
In-Reply-To: Douglas Bates's message of 21 Nov 1997 08:28:34 -0600
References: <6r4t56qq25.fsf@franz.stat.wisc.edu>
Message-ID: <x23ekqxl2r.fsf@blueberry.kubism.ku.dk>

Douglas Bates <bates@stat.wisc.edu> writes:

> Can anyone tell me if the current version of nlm uses only function
> values or if it can use gradients and Hessians when they are
> available?  I would like to get an idea of how difficult it would be
> to port the development versions of our linear mixed-effects code.

I'd say that this is so important that you should just tell us what
you want it to do and we'll make it do so.

(Above statement being asymptotically valid for large values of
"we"...)

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=---
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=---

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Nov 21 17:05:43 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 21 Nov 1997 18:05:43 +0100
Subject: R-alpha: nlm and gradients
In-Reply-To: <6r4t56qq25.fsf@franz.stat.wisc.edu> (message from Douglas Bates
 on 21 Nov 1997 08:28:34 -0600)
Message-ID: <199711211705.SAA07895@sophie.ethz.ch>

>>>>> "DougB" == Douglas Bates <bates@stat.wisc.edu> writes:

    DougB> At present the documentation for nlm refers the reader to Dennis
    DougB> and Schnabel for details on the algorithms.  It also states that
    DougB> the function is liable to change.

    DougB> Can anyone tell me if the current version of nlm uses only
    DougB> function values or if it can use gradients and Hessians when
    DougB> they are available?  I would like to get an idea of how
    DougB> difficult it would be to port the development versions of our
    DougB> linear mixed-effects code.

Hello Doug,
 thank you for thinking about the port !!

Unfortunately, the current version of
	src/main/optimize.c
still contains

o.c>   static int F77_SYMBOL(d1fcn)(int *n, double *x, double *g)
o.c>   {
o.c>     error("optimization using analytic gradients not implemented (yet)\n");
o.c>   }
o.c>
o.c>   static int F77_SYMBOL(d2fcn)(int *n, double *x, double *g)
o.c>   {
o.c>     error("optimization using analytic Hessians not implemented (yet)\n");
o.c>   }

(optimize.c is unchanged since 0.50-a4).

The underlying Fortran code would allow gradients and hessians;
the ``only'' remaining thing is to use the internal code in R which
is used for 'deriv(.)' to compute algebraic derivatives ...

Martin Maechler <maechler@stat.math.ethz.ch>		 <><
Seminar fuer Statistik, SOL G1
ETH (Federal Inst. Technology)	8092 Zurich	 SWITZERLAND
phone: x-41-1-632-3408		fax: ...-1086
http://www.stat.math.ethz.ch/~maechler/
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=---
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=---

From pgilbert@bank-banque-canada.ca  Fri Nov 21 16:56:25 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Fri, 21 Nov 1997 11:56:25 -0500
Subject: R-alpha: random number generator
Message-ID: <97Nov21.120108est.26518@mailgate.bank-banque-canada.ca>

>1. Is the random number generator in R the same as the one in S
>"Super-Duper")?

The random number generator is different and also the random seed length

is different. As far as I know there is no way to reproduce the same
random experiments in R that you may have performed in S (but if you
figure it out please let me know). However, in my fairly casual
experimentation the general results of random experiments tend to be the

same (good thing!).

Paul Gilbert

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=---
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=---

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Nov 21 17:45:03 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 21 Nov 1997 18:45:03 +0100
Subject: R-alpha: random number generator
In-Reply-To: <97Nov21.120108est.26518@mailgate.bank-banque-canada.ca> (message
 from Paul Gilbert on Fri, 21 Nov 1997 11:56:25 -0500)
Message-ID: <199711211745.SAA08103@sophie.ethz.ch>

Which reminds me of a remark that  Luke Tierney made a while ago,
and I very much agree with:

LT> From: Luke Tierney <luke@stat.umn.edu>
LT> Subject: Re: R-alpha: compatibility
LT> Date: Mon, 15 Sep 1997 11:55:02 -0500 (CDT)
LT> Cc: R-devel@stat.math.ethz.ch
LT> 
LT> This is one point where compatibility is not necessarily a good
LT> thing. S, like most systems, gives you no real control over the random
LT> number generator expect re-seeding. Usually this is probably good. But
LT> most simulation books recommend running any simulations you care about
LT> with two very different generators.
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Yes! -- That's why I think it would be nice if R allowed for  SEVERAL
random number generators, one of them super-duper, incidentally.
The code is basically in V&R 1 and 2; V&R2 on p.167.
I have it as a C function that I used to dyn.load into S-plus in order to
prove that S-plus was using it.
my function does NOT YET contain the ``zero skipping'' which is mentioned
in the yellow book ..

LT> Most people don't do this because
LT> one generator is usually easy to use (the built-in one in your
LT> favorite system) and anything else is impossible. Another issue that S
LT> faces has to do with running separate bits of a simulation on separate
LT> workstations. Unless you are careful, the separate bits will share
LT> parts of random number streams, and being careful is not really
LT> possible with S's generator (I think) -- it is possible but not easy
LT> with R's. (Of course overlap can be a good thing if you know you have
LT> it -- the point here is that lots of folks run separate simulations
LT> thinking they have independent runs when they probably do not in any
LT> reasonable sense).

LT> The bottom line is that it would be nice to eventually provide "power
LT> users" with more control over the random number generator system.  Now
LT> is clearly not the time to think about how to do that, but it would be
LT> unfortunate if decisions were made at this point in the name of
LT> compatibility that might limit the freedom of doing something "right"
LT> later on.

maybe the time to think about this, could be now..?
Proposals?

-- Martin M
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=---
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=---

From pgilbert@bank-banque-canada.ca  Fri Nov 21 19:32:10 1997
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Fri, 21 Nov 1997 14:32:10 -0500
Subject: R-alpha: random number generator
References: <199711211745.SAA08103@sophie.ethz.ch>
Message-ID: <97Nov21.143456est.26524@mailgate.bank-banque-canada.ca>

>LT> The bottom line is that it would be nice to eventually provide
"power
>LT> users" with more control over the random number generator system.

>maybe the time to think about this, could be now..?
>Proposals?

Maybe there is some subtlty here that I don't understand, but is it not
possible to just add an optional argument to the functions which call
the random number generator, with the default being the current
generator?

Paul Gilbert

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=---
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=---

From bates@stat.wisc.edu  Sun Nov 23 23:32:04 1997
From: bates@stat.wisc.edu (Douglas Bates)
Date: Sun, 23 Nov 1997 17:32:04 -0600 (CST)
Subject: R-alpha: Reading a data.dump format
Message-ID: <m0xZlVU-000hh4C@franz.stat.wisc.edu>

Has anyone taken a crack at creating an R function that would read the 
data.dump format?
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=---
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=---

From Martin Maechler <maechler@stat.math.ethz.ch>  Mon Nov 24 09:49:44 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Mon, 24 Nov 1997 10:49:44 +0100
Subject: R-alpha: Reading a data.dump format
In-Reply-To: <m0xZlVU-000hh4C@franz.stat.wisc.edu> (message from Douglas Bates
 on Sun, 23 Nov 1997 17:32:04 -0600 (CST))
Message-ID: <199711240949.KAA00755@sophie.ethz.ch>

>>>>> "DougB" == Douglas Bates <bates@stat.wisc.edu> writes:

    DougB> Has anyone taken a crack at creating an R function that would
    DougB> read the data.dump format?

This has been listed as a `desideratum'
 -- something we'd all like -- for a while now.

Actually, both   data.dump and data.restore.

Any students who need a challenging home work ?  :-)
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=---
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=---

From Martin Maechler <maechler@stat.math.ethz.ch>  Mon Nov 24 13:51:13 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Mon, 24 Nov 1997 14:51:13 +0100
Subject: R-alpha: random number generator -- S-plus's
In-Reply-To: <97Nov21.164332est.26501@mailgate.bank-banque-canada.ca> (message
 from Paul Gilbert on Fri, 21 Nov 1997 16:40:01 -0500)
Message-ID: <199711241351.OAA01213@sophie.ethz.ch>

--Multipart_Mon_Nov_24_14:51:09_1997-1
Content-Type: text/plain; charset=US-ASCII


>>>>> "PaulG" == Paul Gilbert <pgilbert@bank-banque-canada.ca> writes:

    MM> The code is basically in V&R 1 and 2; V&R2 on p.167.  I have it as a
    MM> C function that I used to dyn.load into S-plus in order
    MM> to prove that S-plus was using it.

    PaulG> Could you send this to me. I'd like to try to reproduce some S
    PaulG> results in R.

Okay here is a little shar file which contains a little more;
it also includes (the S code for) my experiments on what S-plus's  set.seed(.)
does. The C code must be compiled (cc  and ld) ``a la R'' before dyn.load.

I did not yet test this in R,
but I  CC: it to R-devel since others may want to comment.

[appended at the end !]

--------------------------------------------------------

  PaulG> Maybe there is some subtlty here that I don't understand, but is it not
  PaulG> possible to just add an optional argument to the functions which call
  PaulG> the random number generator, with the default being the current
  PaulG> generator?
Reasons why I wouldn't like this:

  - There are too many of these functions;  some are quite nested;
  - adding an extra argument to them is ugly and not backwards (R-minus)
	  compatible; 
  - you shouldn't have to change the R code of your simulation, but rather
	  change a global option in order to use a different RNG.
  - You shouldn't accidentally mix two different generators, since the 
	  resulting RNG has unknown properties.be allowed t

  - It isn't too hard, to implement the more flexible scheme,
	   in the current R implementation.

>From the UI, I'd propose
to use  a function instead of  .Random.seed,

	set.random(generator = "Wichmann-Hill", seed = NULL)

The function (also when called with no arguments) returns a list with the
two components
	$generator : character(1)  giving the name of the RNG.
	$seed	   : integer vector

AND also accepts such a list as input (alternatively), i.e.

	I could
	
first)
	.R.seed <- set.random()
	## ....do simulations

later)
	set.random(.R.seed)
	## ....Re-do  simulations indentically

-------------------------------------------------------------------------------

--Multipart_Mon_Nov_24_14:51:09_1997-1
Content-Type: application/octet-stream
Content-Disposition: attachment; filename="runif.shar"
Content-Transfer-Encoding: 7bit

#!/bin/sh
# This is a shell archive (produced by GNU sharutils 4.2).
# To extract the files from this archive, save it to some FILE, remove
# everything before the `!/bin/sh' line above, then type `sh FILE'.
#
# Made on 1997-11-24 14:21 MET by <maechler@sophie>.
# Source directory was `/users/home2/staff/maechler/S/MISC'.
#
# Existing files will *not* be overwritten unless `-c' is specified.
#
# This shar contains:
# length mode       name
# ------ ---------- ------------------------------------------
#   7088 -rw-r--r-- runif-tst.S
#   3646 -rw-r--r-- setseed-ex.S
#   1132 -rw-r--r-- ../C-Progs/programs/Runif.c
#
save_IFS="${IFS}"
IFS="${IFS}:"
gettext_dir=FAILED
locale_dir=FAILED
first_param="$1"
for dir in $PATH
do
  if test "$gettext_dir" = FAILED && test -f $dir/gettext \
     && ($dir/gettext --version >/dev/null 2>&1)
  then
    set `$dir/gettext --version 2>&1`
    if test "$3" = GNU
    then
      gettext_dir=$dir
    fi
  fi
  if test "$locale_dir" = FAILED && test -f $dir/shar \
     && ($dir/shar --print-text-domain-dir >/dev/null 2>&1)
  then
    locale_dir=`$dir/shar --print-text-domain-dir`
  fi
done
IFS="$save_IFS"
if test "$locale_dir" = FAILED || test "$gettext_dir" = FAILED
then
  echo=echo
else
  TEXTDOMAINDIR=$locale_dir
  export TEXTDOMAINDIR
  TEXTDOMAIN=sharutils
  export TEXTDOMAIN
  echo="$gettext_dir/gettext -s"
fi
touch -am 1231235999 $$.touch >/dev/null 2>&1
if test ! -f 1231235999 && test -f $$.touch; then
  shar_touch=touch
else
  shar_touch=:
  echo
  $echo 'WARNING: not restoring timestamps.  Consider getting and'
  $echo "installing GNU \`touch', distributed in GNU File Utilities..."
  echo
fi
rm -f 1231235999 $$.touch
#
if mkdir _sh01181; then
  $echo 'x -' 'creating lock directory'
else
  $echo 'failed to create lock directory'
  exit 1
fi
# ============= runif-tst.S ==============
if test -f 'runif-tst.S' && test "$first_param" != -c; then
  $echo 'x -' SKIPPING 'runif-tst.S' '(file already exists)'
else
  $echo 'x -' extracting 'runif-tst.S' '(text)'
  sed 's/^X//' << 'SHAR_EOF' > 'runif-tst.S' &&
##SunOS4: print(dyn.load2("/u/maechler/C/C-for-S/Runif.o"))
print(dyn.load("/u/maechler/C/C-for-S/Runif.o"))
X.C("Init_seed",
X   Cval = as.integer(12345),
X   Tval = as.integer(987654321))
str(.C("Get_seed", Cval = integer(1), Tval = integer(1)))
X
rU_ numeric(10)
for(i in 1:10) rU[i] <- unlist(.C("Runif", numeric(1)))
rU
str(.C("Get_seed", Cval = integer(1), Tval = integer(1)))
X
Set.seed <- function(Cval = 12345, Tval =987654321)
{
X  ## Purpose: Initialize my implementation of the 'S' RNG (following Ripley)
X  ## -------------------------------------------------------------------------
X  ## Arguments: Congrval and Tausval, the 2 long integers  [== seed]
X  ## -------------------------------------------------------------------------
X  ## Author: Martin Maechler, Date:  9 May 94, 12:04
X  if(!is.loaded(C.symbol("Init_seed")))
X    dyn.load("/u/maechler/C/C-for-S/Runif.o")
X  invisible(.C("Init_seed",
X	       Cval = as.integer(Cval),
X	       Tval = as.integer(Tval)))
}
X
Runif <- function()
{
X  ## Purpose:  test my runif(.)
X  ## -------------------------------------------------------------------------
X  ## Author: Martin Maechler, Date:  9 May 94, 11:54
X  if(!is.loaded(C.symbol("Runif")))
X    dyn.load("/u/maechler/C/C-for-S/Runif.o")
X  unlist(.C("Runif", numeric(1)))
}
X
X
tst.runif <- function(Cval = 12345, Tval =987654321)
{
X  ## Purpose: test my (following Ripley) implementation of S  RNG
X  ##        return 'next' seeds
X  ## -------------------------------------------------------------------------
X  ## Arguments: Congrval and Tausval  [== seed]
X  ## -------------------------------------------------------------------------
X  ## Author: Martin Maechler, Date:  9 May 94, 12:04
X  if(!is.loaded(C.symbol("Runif")))
X    dyn.load("/u/maechler/C/C-for-S/Runif.o")
X  .C("Init_seed",
X     Cval = as.integer(Cval),
X     Tval = as.integer(Tval))
X  .C("Runif", numeric(1))
X  unlist(.C("Get_seed", Cval = integer(1), Tval = integer(1)))
}
X
###
### Test the 'standard'  .Random.seed  --- compare with  my version
###
X
tst.R.S <- function(nn)
{
X  ## Purpose:  return many .Random.seed s
X  ## -------------------------------------------------------------------------
X  ## Arguments: number
X  ## -------------------------------------------------------------------------
X  ## Author: Martin Maechler, Date:  9 May 94, 11:07
X
X  RR <- matrix(0,nrow = 12, ncol= nn)
X  for(i in 1:nn) { RR[,i] _ .Random.seed; runif(1) }
X  t(RR)
}
X
RR <- tst.R.S(2000)
summary(as.data.frame(RR))#-- Random.seed components
RRt <- apply(RR, 2, table)
RRt2 <- lapply(RRt, function(x) as.integer(names(x)))
str(RRt2, vec.len = 20)
for(j in 1:12) {
X  cat("\n j=",j, " 0:63 = R..[[j]]: ", all.equal(0:63, RRt2[[j]]))
}
X
X
X
X
X
X
##--> only   1, 6, 12  are NOT ==  0...63
## [[1]] =          1 5 9 .. 61  (( = 1 + 4*j ,  j= 0..15 ))
## [[6]] = [[12]] = 0..3
X
X
RS   <- rep(0,12)
#.Random.seed _ RS
##>> Error: Invalid random number seed: congruential part must be odd
RS[1] _ 1
X.Random.seed _ RS  #--> 1st part == congruential part !
for(i in 1:20){ print(.Random.seed); runif(1)} #- the 2nd part STAYS 0 !!
RS2 <- RS
RS2[12] _ 1
X.Random.seed _ RS2
for(i in 1:20){ print(.Random.seed); runif(1)} #- 1st part == 1st part above!
X
###==> first   6 numbers are one long integer, == congrval  (see above)
###    second  6 numbers are 2nd long integer  == tausval
X
### congrval is made up from 4 + 4* 6 + 3 = 31 bits
###                          - actually CAN use ALL odd 1:63 for [1] -> 32 bits
###  tausval is made up from     5* 6 + 3 = 33 bits (?)
X
X
###  The following  PROOFS  that  Runif(.) returns the SAME as  runif(.)
###  AND  that .Random.seed  =^=  ( Congr.val, Taus.val )
X
if(!exists("polyn.eval"))
X  polyn.eval <- function(coef, x)
X  {
X    ## Purpose: Compute coef[1] + coef[2]*x + ... + coef[p+1]* x^p
X    ## 	      x can be any array; result if of same dimensions !
X    ## Author: Martin Maechler
X    lc <- length(coef)
X    if(lc == 0) 0
X      else {
X	r <- coef[lc]
X	if(lc > 1) for(i in (lc - 1):1) r <- coef[i] + r * x
X	r
X      }
X  }
X
qR <- c( 1, rep(0,5))
X.Random.seed <- Rs <- c(qR, qR) #---  1 0 0 0 0 0  1 0 0 0 0 0
Set.seed(1,1)
for (i in 1:100) {
X  CT <- unlist(.C("Get_seed", Cval = integer(1), Tval = integer(1)))
X  RS.C <- .Random.seed[1:6]
X  RS.T <- .Random.seed[1:6 +6]
X  cat(i,": ")
X  ##print(c(CT, RS.C = RS.C, RS.T = RS.T))
X  if(CT["Cval"]<0) { CT["Cval"] <- 2^32 + CT["Cval"]
X		     cat("'Cval' corrected by adding 2^32\n") }
X  if(CT["Tval"]<0) { CT["Tval"] <- 2^32 + CT["Tval"]
X		     cat("'Tval' corrected by adding 2^32\n") }
X  if(CT["Cval"] != polyn.eval(RS.C, 2^6)) stop("'Congr.val' do not match!")
X  if(CT["Tval"] != polyn.eval(RS.T, 2^6)) stop(" 'Taus.val' do not match!")
X  u1 <- runif(1)
X  u2 <- Runif()
X  if((u1-u2)!=0) stop("u1 != u2")
}
X
X
X.Random.seed <- Rs <- c(qR, qR) #---  1 0 0 0 0 0  1 0 0 0 0 0
Set.seed(1,1)
X
runif(1)
##> [1] 4.659873e-05
Runif()
##> [1] 4.659873e-05
unlist(.C("Get_seed", Cval = integer(1), Tval = integer(1)))
##>   Cval   Tval
##>  69069 131073
X.Random.seed
##>  [1] 13 55 16  0  0  0  1  0 32  0  0  0
X
Runif()
##> [1] 0.1106027
runif(1)
##> [1] 0.1106027
unlist(.C("Get_seed", Cval = integer(1), Tval = integer(1)))
##>       Cval   Tval
##>  475559465 524293
X.Random.seed
##>  [1] 41 24  7 22 28  0  5  0  0  2  0  0
X
X
### --- finding out things about   set.seed(.) -----
X
for(i in 0:1100){
X  cat("set.seed(i=",formatC(i,dig=4),") -> .Random.s = "); set.seed(i)
X  cat(format(.Random.seed),"\n")
}
##- set.seed(i=     0 ) -> .Random.s = 21 14 49   32 43  1   32 22 36 23 28  3
##- set.seed(i=     1 ) -> .Random.s = 21 14 49   48 24  1   32 22 36 23 28  3
##- set.seed(i=     2 ) -> .Random.s = 21 14 49    0  6  1   32 22 36 23 28  3
##- set.seed(i=     3 ) -> .Random.s = 21 14 49   16 51  0   32 22 36 23 28  3
##- set.seed(i=     4 ) -> .Random.s = 21 14 49   32 32  0   32 22 36 23 28  3
##- set.seed(i=     5 ) -> .Random.s = 21 14 49   48 13  0   32 22 36 23 28  3
##- set.seed(i=     6 ) -> .Random.s = 21 14 49    0 59  3   32 22 36 23 28  3
##- set.seed(i=     7 ) -> .Random.s = 21 14 49   16 40  3   32 22 36 23 28  3
##- .........
##-          			      [ 1  2  3    4  5  6    7  8  9 10 12 12 ]
###--> only  [4:6]  really change !!
###- They have  6 + 6 + 2 = 14  bits each (the ranges are 0:63, 0:63, and 0:3),
###- i.e.,  2^14 = 16384  different possibilities.
###-        ~~~~   ~~~~~
###===>  Period of  set.seed(.) =: P | 2^14
X
## test this period
tst.sseed <- function(i)
{
X  ## Purpose:  test  set.seed(.)
X  ## -------------------------------------------------------------------------
X  ## Author: Martin Maechler, Date:  9 May 94, 11:54
X  set.seed(i)
X  .Random.seed
}
X
for (i in c(0:7, 11, 17, 20, 23, 40, 53, 59, 67, 76, 97)) {
X  cat("i=",i,": ")
X  print(all.equal(tst.sseed(i), tst.sseed(i + 2^ 14)))
}
##--> all  'TRUE'
##
## same thing for  2^13, 2^12, 2^11, 2^10 ! --
##
## Test a full period for  2^10 = 1024 :
X
for (i in 0:(2^10 - 1))
X  if(!is.all.equal(tst.sseed(i), tst.sseed(i + 2^ 10)))
X  cat("i=",i," DIFFERENT ! ")
## -> nothing (i.e., all equal !)
X
###==> Full period is from  set.seed(0) to  set.seed(1023) ! --
SHAR_EOF
  $shar_touch -am 1124142097 'runif-tst.S' &&
  chmod 0644 'runif-tst.S' ||
  $echo 'restore of' 'runif-tst.S' 'failed'
  if ( md5sum --help 2>&1 | grep 'sage: md5sum \[' ) >/dev/null 2>&1 \
  && ( md5sum --version 2>&1 | grep -v 'textutils 1.12' ) >/dev/null; then
    md5sum -c << SHAR_EOF >/dev/null 2>&1 \
    || $echo 'runif-tst.S:' 'MD5 check failed'
35e91fce41f56de76bab514ecfc5c840  runif-tst.S
SHAR_EOF
  else
    shar_count="`LC_ALL= LC_CTYPE= LANG= wc -c < 'runif-tst.S'`"
    test 7088 -eq "$shar_count" ||
    $echo 'runif-tst.S:' 'original size' '7088,' 'current size' "$shar_count!"
  fi
fi
# ============= setseed-ex.S ==============
if test -f 'setseed-ex.S' && test "$first_param" != -c; then
  $echo 'x -' SKIPPING 'setseed-ex.S' '(file already exists)'
else
  $echo 'x -' extracting 'setseed-ex.S' '(text)'
  sed 's/^X//' << 'SHAR_EOF' > 'setseed-ex.S' &&
###--> See also (the much OLDER)  ./runif-tst.S
###				  ~~~~~~~~~~~~~
X
ss <- function(i) { set.seed(i); .Random.seed }
s0 <- ss(0)
for(i in -1000:4000)
X if(any(ss(i)[-(4:6)] != s0[-(4:6)])) cat("i=",i," .R.s=",.Random.seed,"\n")
##--> no output, i.e., it's really
##    only .Random.seed[c(4,5,6)] which are modified by set.seed(.)
X
ni <- length(i.set <- -2:2000)
m456 <- matrix(NA, ni, 3, dimnames=list(paste(i.set),paste(4:6)))
for(i in i.set)  m456[paste(i),] <- ss(i)[4:6]
t(m456[1:25,])
X
apply(m456, 2,  function(x) sort(unique(x)))
##- $"4":
##- [1]  0 16 32 48
##-
##- $"5":
##-[1]  0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23
##[25] 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47
##[49] 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63
##-
##- $"6":
##- [1] 0 1 2 3
len456 <- apply(m456, 2,  function(x) length(unique(x)))
len456
prod(len456) #-- 1024 : no more than these many different
X
d456 <- dim(table(m456[,"4"], m456[,"5"], m456[,"6"]))#- and these all appear ..
d456
d456 == len456 # Yes !
X
all(m456[,"4"] == rep(16*(0:3), length=ni))#-> TRUE
X
for(i in -4:10) print(ss(i)[4] == 16*(i+2)%%4)
X
table(m456[,"6"]) #-- only 0, 1, 2, 3, but not as regularly ...
##-    0   1   2   3
##-  502 501 500 500
X
##---- mI  contains .Random.seed[4:6]  after set.seed(i = 1:1024) : ----
mI <- m456[paste(1:1024),]
dim(table(mI[,"4"], mI[,"5"], mI[,"6"]))#- and these all appear ..
X
all(ss(0) == ss(1024)) #-- TRUE
for(i in -100:2000)
X   if(any(ss(i) != ss(i + 1024))) cat("i=",i," .R.s=",.Random.seed,"\n")
#- no output, i.e., it's true
X
# the part of the 'congrval'
all(table(mI %*% 2^(6*0:2)) == 1)# TRUE
X
X
## Return 'congrval' part of .Random.seed after  set.seed(.):
## need 'polyn.eval' from my goodies:
ssC <- function(i){ set.seed(i);polyn.eval(.Random.seed[  1:6],2^6)}
ssT <- function(i){ set.seed(i);polyn.eval(.Random.seed[6+1:6],2^6)}
X
##-- All the 'congrval' that set.seed(.) produces ..
Cs <- ii <- 1:1024
for(i in ii) Cs[i] <- ssC(i)
dim(tCs <- table(Cs))# = 1024
all(tCs == 1) # TRUE  (each once)
X
summary(Cs / 2^32)
##-       Min. 1st Qu. Median   Mean 3rd Qu.   Max.
##-  4.694e-05  0.2498 0.4996 0.4996  0.7493 0.9991
X
dCs <- unique(diff(srt.C <- sort(Cs)))
dCs##->  4194304  only one value !
log(dCs, base =2)# == 22
X
C1 <- srt.C[1]
all(srt.C == C1 + (ii-1) * 2^22) #- TRUE !
X
## the values are not quite symmetrical in {0,..,2^32-1} :
2^32 - srt.C[1024]# 3992683
C1                #  201621
X
###------------ Martin Mchler's Summary : ------------------------
X
###--- Mon, Sept. 15, 1997 ----------
X
##- Unfortunately, we don't know what exactly happens in
##- the S-plus code for set.seed(i), namely,  .C("setseed", as.integer(i))
##- However, I have found out the following which should suffice :
##-
##-  1) Only .Random.seed[4:6]  are varyied by set.seed, i.e.,
##-    after set.seed(i), .Random.seed always is
##-
##-            1  2  3  4  5  6  7  8  9 10 11 12
##-       [1] 21 14 49  *  *  * 32 22 36 23 28  3
##-                    X4 X5 X6
##-
##- which means that only the 'congrval' {Venables & Ripley, 2nd ed., p.166-167}
##-    is varied
##-
##-  2) X4 is always ==  16*((i+2) %% 4)
##-     X5 takes (all) values in 0:63  [also with some periodicity]
##-     X6 takes the values of 0:3
##-
##-  3) set.seed(i) <==> set.seed(i + n*1024)  for all integers n, i
##-
##-  4) { set.seed(i) ;  i \in {integers}}
##-     results in a set of 1024 different values of 'congrval'.
##-     These values are EXACTLY EQUISPACED lying in {0,..,2^32}.
##-
##-     If C[1:1024] are these sorted values, we have
##-
##- 	C[i] == 201621 + (i-1)* 2^22  , for i in 1:1024
##-
X
SHAR_EOF
  $shar_touch -am 1124095797 'setseed-ex.S' &&
  chmod 0644 'setseed-ex.S' ||
  $echo 'restore of' 'setseed-ex.S' 'failed'
  if ( md5sum --help 2>&1 | grep 'sage: md5sum \[' ) >/dev/null 2>&1 \
  && ( md5sum --version 2>&1 | grep -v 'textutils 1.12' ) >/dev/null; then
    md5sum -c << SHAR_EOF >/dev/null 2>&1 \
    || $echo 'setseed-ex.S:' 'MD5 check failed'
c2d03d4318c03a8f2ed8b4f0b656c647  setseed-ex.S
SHAR_EOF
  else
    shar_count="`LC_ALL= LC_CTYPE= LANG= wc -c < 'setseed-ex.S'`"
    test 3646 -eq "$shar_count" ||
    $echo 'setseed-ex.S:' 'original size' '3646,' 'current size' "$shar_count!"
  fi
fi
# ============= ../C-Progs/programs/Runif.c ==============
if test ! -d '..'; then
  $echo 'x -' 'creating directory' '..'
  mkdir '..'
fi
if test ! -d '../C-Progs'; then
  $echo 'x -' 'creating directory' '../C-Progs'
  mkdir '../C-Progs'
fi
if test ! -d '../C-Progs/programs'; then
  $echo 'x -' 'creating directory' '../C-Progs/programs'
  mkdir '../C-Progs/programs'
fi
if test -f '../C-Progs/programs/Runif.c' && test "$first_param" != -c; then
  $echo 'x -' SKIPPING '../C-Progs/programs/Runif.c' '(file already exists)'
else
  $echo 'x -' extracting '../C-Progs/programs/Runif.c' '(text)'
  sed 's/^X//' << 'SHAR_EOF' > '../C-Progs/programs/Runif.c' &&
/*--- this code is from a posting of
X  Brian Ripley to the S-news, 7 Aug 92,
X  and a slight correction from  Allen Mcintosh <mcintosh@larch.bellcore.com>
X  + a correction of mine (B.R. wrote '69096' instead of '69069'))
X
X  -->  /u/maechler/tex/o.peopl/Ripley-S-RNG.tex
*/
X
/*--- This code is perfectly tested out via S-code
X
X  in -->  /u/maechler/S/MISC/runif-tst.S
*/
X
unsigned long congr_MM, taus_MM;
X
static double xuni()
{
X        unsigned long n, lambda = 69069;
X        congr_MM *= lambda;
X        taus_MM  ^= taus_MM >> 15;
X        taus_MM  ^= taus_MM << 17;
/* Orig (Splus <= 3.2):
X        n = taus_MM ^ congr_MM;
X        return ( (n>>1) / 2147483648.);
X * New: */
X        n = (taus_MM ^ congr_MM) >> 1;
X        if(n) { /* n != 0 */ return( n / 2147483648.);
X	} else return(xuni());
}
X
X
/*--- The following are to be  dyn.load(..)ed   and called  from  S(plus) --*/
X
void Runif (double* res) {  *res = xuni(); }
X
void Init_seed (long* Cval, long* Tval)
{
X  congr_MM = (unsigned long)*Cval;
X  taus_MM  = (unsigned long)*Tval;
}
X
void Get_seed (long* Cval, long* Tval)
{
X  *Cval = (long) congr_MM;
X  *Tval = (long) taus_MM;
}
SHAR_EOF
  $shar_touch -am 1124141497 '../C-Progs/programs/Runif.c' &&
  chmod 0644 '../C-Progs/programs/Runif.c' ||
  $echo 'restore of' '../C-Progs/programs/Runif.c' 'failed'
  if ( md5sum --help 2>&1 | grep 'sage: md5sum \[' ) >/dev/null 2>&1 \
  && ( md5sum --version 2>&1 | grep -v 'textutils 1.12' ) >/dev/null; then
    md5sum -c << SHAR_EOF >/dev/null 2>&1 \
    || $echo '../C-Progs/programs/Runif.c:' 'MD5 check failed'
f5888c70e55b647a34d8bee3aae3b4ad  ../C-Progs/programs/Runif.c
SHAR_EOF
  else
    shar_count="`LC_ALL= LC_CTYPE= LANG= wc -c < '../C-Progs/programs/Runif.c'`"
    test 1132 -eq "$shar_count" ||
    $echo '../C-Progs/programs/Runif.c:' 'original size' '1132,' 'current size' "$shar_count!"
  fi
fi
rm -fr _sh01181
exit 0

--Multipart_Mon_Nov_24_14:51:09_1997-1
Content-Type: text/plain; charset=US-ASCII



--Multipart_Mon_Nov_24_14:51:09_1997-1--
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=---
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=---

From Martin Maechler <maechler@stat.math.ethz.ch>  Wed Nov 26 08:27:32 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 26 Nov 1997 09:27:32 +0100
Subject: R-alpha: Re: R-beta: Latin-1 characters (and "=-=" footer and MIME...)
In-Reply-To: <x2g1oklqxg.fsf@blueberry.kubism.ku.dk> (message from Peter
 Dalgaard BSA on 25 Nov 1997 20:22:19 +0100)
Message-ID: <199711260827.JAA00479@sophie.ethz.ch>

=09[redirected to R-devel;  does NOT belong anymore into R-help]

>>>>> "PD" =3D=3D Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk> writes:

    PD> Martin Maechler <maechler@stat.math.ethz.ch> writes:

    >>  You didn't say which version of R you are using;
    >> 
    >> It is true that 0.50-a4 still doesn't properly work with these.
    >> However, I though Windows "Rsept" was somewhat newer...
    >> 
    >> Anyway, in current source (unreleased) version, it's all nice :
=09MM> > M=E4chler <- 1:3
=09MM> > ls(pat=3D"^M")
=09MM> [1] "M=E4chler"
=09MM> > M=E4chler
=09MM> [1] 1 2 3


    PD> This seems to be wandering in and out of the sources. The snapshot
    PD> I've been using does

    >> =F8

    PD> Save workspace image? [y/n/c]:

    PD> - but I'm pretty sure an *earlier* one (0.49?) did do Latin1. How
    PD> about adding this to your set of regression tests, so that it
    PD> becomes possible to detect whenever the source tree gets modified?
Ok, I'll think about doing this.


ISO-Latin1 Characters (current source, not yet 0.50): 
~~~~~~~~~~~~~~~~~~~~~

 1) Everything seems ok, if they are used in  strings (and comments)

 2) If you use them as [language] symbols, things are different :
=09

> =D6
[1] 0
> =C4
[1] 0
> =FC
Error: syntax error
=09=09=09--- so `=FC' is different from `=E4' ...
> =E4
[1] 0
> =E4 <- 1
Error in 0 <- 1 : invalid (do_set) left-hand side to assignment


> =F2
Error: Object "=F2" not found
> =B5
Error: syntax error
> =AE
Error: Object "=AE" not found
> =AB
Error: syntax error
> "=ABQuoted=BB text"
[1] "=ABQuoted=BB text"
> =FE
Error: syntax error
> "=FE"
[1] "=FE"
> =F8
Error: syntax error
> "=F8"
[1] "=F8"
> nchar("=F8")
[1] 1

---------------------- etc. ---------------------------

Point is: 
=09It's not quite clear which ISO-latin1 characters should 
=09belong to the set of characters which can be used in R symbols
=09{this is not the same as R object names,
=09 which can contain everything, using  assign(..) and  get(..)}

Note that in S-plus,  ONLY  ASCII characters valid  symbol names,

I think, all the following should be allowed  symbol components,
to make  R  really  ``nicely usable'' for  European-Language users

  A.accents <- "=E0=E1=E2=E3=E4=E5=E6 =C0=C1=C2=C3=C4=C5=C6" # `a 'a ^a "a =
oa ae  `A 'A ^A "A oA AE
  EI.accents <- "=C8=C9=CA=CB=CC=CD=CE=CF =E8=E9=EA=EB=EC=ED=EE=EF"# =3D `E=
 'E ^E "E  `I 'I .....
  O.accents <- "=D2=D3=D4=D5=D6=D8=F2=F3=F4=F5=F6=F8"
  U.accents <- "=D9=DA=DB=DC=DD=F9=FA=FB=FC=FD"
## I did not include the two islandic
  Islandic <- "=D0=F0" # maybe we should

------------------------
R & R, any comments?
------------------------



    PD> And BTW, yes, your message became "malformed quoted printable"
    PD> because of the =3D-=3D- pattern in the footer. May I suggest we qui=
etly
    PD> change "=3D" to "+" or "~" (while equally quietly cursing the MIME
    PD> standard mess...)

Ok, just done it (change and polite curse).  You should see it now..

- Martin
_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_---
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_---

From p.dalgaard@biostat.ku.dk  Wed Nov 26 10:24:02 1997
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 26 Nov 1997 11:24:02 +0100
Subject: R-alpha: Re: R-beta: Latin-1 characters (and "=-=" footer and MIME...)
In-Reply-To: Martin Maechler's message of Wed, 26 Nov 1997 09:27:32 +0100
References: <199711260827.JAA00479@sophie.ethz.ch>
Message-ID: <x2wwhweywt.fsf@blueberry.kubism.ku.dk>

Martin Maechler <maechler@stat.math.ethz.ch> writes:

>   A.accents <- "=E0=E1=E2=E3=E4=E5=E6 =C0=C1=C2=C3=C4=C5=C6" # `a 'a ^=
a "a oa ae  `A 'A ^A "A oA AE
>   EI.accents <- "=C8=C9=CA=CB=CC=CD=CE=CF =E8=E9=EA=EB=EC=ED=EE=EF"# =3D=
 `E 'E ^E "E  `I 'I .....
>   O.accents <- "=D2=D3=D4=D5=D6=D8=F2=F3=F4=F5=F6=F8"
>   U.accents <- "=D9=DA=DB=DC=DD=F9=FA=FB=FC=FD"
> ## I did not include the two islandic
>   Islandic <- "=D0=F0" # maybe we should
>=20

Given R's habit of using symbol names in plots, anything occurring in
any Latin1-language should be there (I've seen too many manglings of
the Danish language for 7-bit programs, that I'd pass the opportunity
to get it done right in R). The above lists misses n-tilde (=F1) and
c-cedilla (=E7). I dont see anything harmful in including the whole
"upper ascii" part (characters 160-255, at least) as symbols.

> ------------------------
> R & R, any comments?
> ------------------------


--=20
   O__  ---- Peter Dalgaard             Blegdamsvej 3 =20
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N  =20
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Wed Nov 26 10:47:19 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 26 Nov 1997 11:47:19 +0100
Subject: R-alpha:  Latin-1 characters (3)
In-Reply-To: <x2wwhweywt.fsf@blueberry.kubism.ku.dk> (message from Peter
 Dalgaard BSA on 26 Nov 1997 11:24:02 +0100)
Message-ID: <199711261047.LAA00657@sophie.ethz.ch>

>>>>> "PD" =3D=3D Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk> writes:

    PD> Martin Maechler <maechler@stat.math.ethz.ch> writes:
    >> A.accents <- "=E0=E1=E2=E3=E4=E5=E6 =C0=C1=C2=C3=C4=C5=C6" # `a 'a ^=
a "a oa ae  `A 'A ^A "A oA AE
    >> EI.accents <- "=C8=C9=CA=CB=CC=CD=CE=CF =E8=E9=EA=EB=EC=ED=EE=EF"# =
=3D `E 'E ^E "E  `I 'I .....
    >> O.accents <- "=D2=D3=D4=D5=D6=D8=F2=F3=F4=F5=F6=F8"
    >> U.accents <- "=D9=DA=DB=DC=DD=F9=FA=FB=FC=FD"
    >> ## I did not include the two islandic
    >> Islandic <- "=D0=F0" # maybe we should
    >> 

    PD> Given R's habit of using symbol names in plots, anything occurring =
in
    PD> any Latin1-language should be there (I've seen too many manglings o=
f
    PD> the Danish language for 7-bit programs, that I'd pass the opportuni=
ty
    PD> to get it done right in R). The above lists misses n-tilde (=F1) an=
d
    PD> c-cedilla (=E7).
and '=DF'  (we don't use it in Switzerland; 
=09  it's ``just'' the Germans and Austrians .... :-)

 
    PD> I dont see anything harmful in including the whole
    PD> "upper ascii" part (characters 160-255, at least) as symbols.

are you serious,  including  160 =3D octal 240 ?
Would you want legal syntax such as

=09=B1=B4=B4 <- 1:3


Here is an excerpt of a file I wrote a few years ago:

All-L1> Note that \240 is VERY funny "invisible", 
All-L1> makes things reversevideo/invisible/!@#!  depending on Emacs versio=
n.
All-L1> For this reason, I  OMIT it in the following [Enter it with ^Q240]:
All-L1> 
All-L1> Dec Oct               Dec Oct 
All-L1>           =A1=A2=A3=A4=A5=A6=A7                =A8=A9=AA=AB=AC=AD=
=AE=AF
All-L1> 160 240: 01234567     168 250:   01234567
All-L1>                      
All-L1>          =B0=B1=B2=B3=B4=B5=B6=B7                =B8=B9=BA=BB=BC=BD=
=BE=BF
All-L1> 176 260: 01234567     184 270:   01234567
All-L1>                      
All-L1>          =C0=C1=C2=C3=C4=C5=C6=C7                =C8=C9=CA=CB=CC=CD=
=CE=CF
All-L1> 192 300: 01234567     200 310:   01234567
All-L1>                      
All-L1>          =D0=D1=D2=D3=D4=D5=D6=D7                =D8=D9=DA=DB=DC=DD=
=DE=DF
All-L1> 208 320: 01234567     216 330:   01234567
All-L1>                      
All-L1>          =E0=E1=E2=E3=E4=E5=E6=E7                =E8=E9=EA=EB=EC=ED=
=EE=EF
All-L1> 224 340: 01234567     232 350:   01234567
All-L1>                      
All-L1>          =F0=F1=F2=F3=F4=F5=F6=F7                =F8=F9=FA=FB=FC=FD=
=FE=FF
All-L1> 240 360: 01234567     248 370:   01234567


Given this table, I'd say  192-255 [dec] =3D 300-377 [okt],
maybe excluding   =D7 and =F7 ..



    >> ------------------------
    >> R & R, any comments?
    >> ------------------------

(when you get up to a new day.. find all these funny symbols in your
 mail box ..)

-- Martin

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Wed Nov 26 11:14:35 1997
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 26 Nov 1997 12:14:35 +0100
Subject: R-alpha:  Latin-1 characters (3)
In-Reply-To: Martin Maechler's message of Wed, 26 Nov 1997 11:47:19 +0100
References: <199711261047.LAA00657@sophie.ethz.ch>
Message-ID: <x2vhxfgb50.fsf@blueberry.kubism.ku.dk>

Martin Maechler <maechler@stat.math.ethz.ch> writes:

> are you serious,  including  160 =3D octal 240 ?
> Would you want legal syntax such as
>=20
> =09=B1=B4=B4 <- 1:3

Maybe use the circled c (=A9) as a variable containing the GNU Copyleft
message? ;)

But how about =B5l.H2O ?

Question is, would it harm anything (except legibility)? And in a
slightly longer run, what about other ISO character sets (e.g. Latin2,
used in Slavic parts of Eastern Europe and Cyrillic). Do they have
punctuation in the same places? As long as there's no technical reason
to forbid it, why not allow it? I don't suppose we plan to use any of
the characters as syntax elements, do we? (And why am I speaking in
questions today?)

>=20
> Here is an excerpt of a file I wrote a few years ago:
>=20
> All-L1> Note that \240 is VERY funny "invisible",=20
> All-L1> makes things reversevideo/invisible/!@#!  depending on Emacs v=
ersion.
> All-L1> For this reason, I  OMIT it in the following [Enter it with ^Q=
240]:

This is curious. It's supposed to represent non-breakable space --
which might actually make it a rather useful item.

> Given this table, I'd say  192-255 [dec] =3D 300-377 [okt],
> maybe excluding   =D7 and =F7 ..


>     >> ------------------------
>     >> R & R, any comments?
>     >> ------------------------
>=20
> (when you get up to a new day.. find all these funny symbols in your
>  mail box ..)

<grin>

--=20
   O__  ---- Peter Dalgaard             Blegdamsvej 3 =20
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N  =20
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ihaka@stat.auckland.ac.nz  Wed Nov 26 19:35:05 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Thu, 27 Nov 1997 08:35:05 +1300 (NZDT)
Subject: R-alpha:  Latin-1 characters (3)
Message-ID: <199711261935.IAA09097@stat1.stat.auckland.ac.nz>

	>> ------------------------
	>> R & R, any comments?
	>> ------------------------

At present the parser makes the decision on what characters can go into
symbol names based on isalpha(c).  If someone will send me a function -
say isidchar(c) which returns 1 for characters which can be in
identifiers and 0 otherwise, I will replace the current test with that.

	Ross
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Wed Nov 26 21:46:45 1997
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 26 Nov 1997 22:46:45 +0100
Subject: R-alpha:  Latin-1 characters (3)
In-Reply-To: Ross Ihaka's message of Thu, 27 Nov 1997 08:35:05 +1300 (NZDT)
References: <199711261935.IAA09097@stat1.stat.auckland.ac.nz>
Message-ID: <x2pvnn2ure.fsf@blueberry.kubism.ku.dk>

Ross Ihaka <ihaka@stat.auckland.ac.nz> writes:

>=20
> =09>> ------------------------
> =09>> R & R, any comments?
> =09>> ------------------------
>=20
> At present the parser makes the decision on what characters can go int=
o
> symbol names based on isalpha(c).  If someone will send me a function =
-
> say isidchar(c) which returns 1 for characters which can be in
> identifiers and 0 otherwise, I will replace the current test with that=
.
>=20
> =09Ross

Ahaaa... So the "oscillatory behaviour" is just me shifting between
machines with proper locale configuration and machines without it! I
think that isalpha() is actually the way to go. People just have to
get their locales right. Here's what's in isalpha(c)=3D=3D1 for the da_D=
K
locale:

ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz=AD
=C0=C1=C2=C3=C4=C5=C6=C7=C8=C9=CA=CB=CC=CD=CE=CF=D0=D1=D2=D3=D4=D5=D6=D8=
=D9=DA=DB=DC=DD=DE=DF=E0=E1=E2=E3=E4=E5=E6=E7=E8=E9=EA=EB=EC=ED=EE=EF=F0=
=F1=F2=F3=F4=F5=F6=F8=F9=FA=FB=FC=FD=FE=FF

The hyphen following 'z' is actually 0xad (soft hyphen).

--=20
   O__  ---- Peter Dalgaard             Blegdamsvej 3 =20
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N  =20
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Thu Nov 27 09:35:06 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Thu, 27 Nov 1997 10:35:06 +0100
Subject: R-alpha:  Latin-1 characters / Locale etc.
In-Reply-To: <x2pvnn2ure.fsf@blueberry.kubism.ku.dk> (message from Peter
 Dalgaard BSA on 26 Nov 1997 22:46:45 +0100)
Message-ID: <199711270935.KAA03092@sophie.ethz.ch>

>>>>> "PD" =3D=3D Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk> writes:

    PD> Ross Ihaka <ihaka@stat.auckland.ac.nz> writes:
    >>  >> ------------------------ >> R & R, any comments?  >>
    >> ------------------------
    >> 
    >> At present the parser makes the decision on what characters can go
    >> into symbol names based on isalpha(c).  If someone will send me a
    >> function - say isidchar(c) which returns 1 for characters which can
    >> be in identifiers and 0 otherwise, I will replace the current test
    >> with that.
    >> 
    >> Ross

Hmm, so we would follow the Unix locale philosophy.
I could live with it.

It has however, a distinct drawback:

You can write R code which works with R compiled in one environment but
fails with --identical R source code-- compiled in a different environment.

While this is true for things like 'readline' and 'proc.time / system.time'=
,
I don't like it so much for such a basic things as symbol characters.


    PD> Ahaaa... So the "oscillatory behaviour" is just me shifting between
    PD> machines with proper locale configuration and machines without it!
    PD> I think that isalpha() is actually the way to go. People just have
    PD> to get their locales right. Here's what's in isalpha(c)=3D=3D1 for =
the
    PD> da_DK locale:

    PD> ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz=AD
    PD> =C0=C1=C2=C3=C4=C5=C6=C7=C8=C9=CA=CB=CC=CD=CE=CF=D0=D1=D2=D3=D4=D5=
=D6=D8=D9=DA=DB=DC=DD=DE=DF=E0=E1=E2=E3=E4=E5=E6=E7=E8=E9=EA=EB=EC=ED=EE=EF=
=F0=F1=F2=F3=F4=F5=F6=F8=F9=FA=FB=FC=FD=FE=FF

    PD> The hyphen following 'z' is actually 0xad (soft hyphen).


In any case, I'd propose a new  
=09function 'alphachars()' 
and/or a global variable 
=09Alphachars
or=09.Symbolchars
(or something better)
which returns a vector of nchar(1)-characters
giving the available symbols.

In=09../library/base/Alpha.Rd  (the accompanying help page),
all this would then be explained to users.

BTW, Peter D., do you have a (electronical form of a) document available
which nicely explains the  locale stuff (for a user, not a C-programmer ..)=
.
 Kurt/Fritz/???: I think there are some nice pages available in Linux.somet=
hing 

----------------------------------------
I'm still wondering:
The  only locale thing we have is (the environment variable)

=09LC_CTYPE=3Diso_8859_1

But then I wonder why I saw the difference between  =E4 and =FC 
that I reported ....

- Martin=
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From phlamber@luc.ac.be  Thu Nov 27 10:02:26 1997
From: phlamber@luc.ac.be (Philippe Lambert)
Date: Thu, 27 Nov 1997 11:02:26 +0100 (MET)
Subject: R-alpha: RData in batch
Message-ID: <Pine.OSF.3.96.971127103915.13153A-100000@alpha>

Just a word to mention that I have lost 2 hours yesterday to find out why
R refused to use a function from a package calling C-code.
R invariably answered that the C code was not in the load table (something
like this). I have tried everything (or nearly) to solve my problem
knowing that this same package used to work on my computer at the
university.
Finally, I found out that running the same instructions as root work fine.
The explanation for my computer sudden good will is not that I was root,
but that I ran R in a different directory ... without .RData!!
(and I don't care about .RData when I use R in batch mode!!).

Thus, 
would it be possible to have R not creating .RData file by default in
batch mode?

A second potential problem: when I build packages including personal
functions, I use to test my functions interactively by typing
library(mypackage) after modification of my code in an editor.
The problem is that repeating the library load does not erase the old
version. Do I do something wrong?


Philippe


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Thu Nov 27 10:09:40 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Thu, 27 Nov 1997 11:09:40 +0100
Subject: R-alpha: RData in batch
In-Reply-To: <Pine.OSF.3.96.971127103915.13153A-100000@alpha> (message from
 Philippe Lambert on Thu, 27 Nov 1997 11:02:26 +0100 (MET))
Message-ID: <199711271009.LAA03190@sophie.ethz.ch>

>>>>> "Philippe" == Philippe Lambert <phlamber@luc.ac.be> writes:

    Philippe> Just a word to mention that I have lost 2 hours yesterday to
    Philippe> find out why R refused to use a function from a package
    Philippe> calling C-code.  R invariably answered that the C code was
    Philippe> not in the load table (something like this). I have tried
    Philippe> everything (or nearly) to solve my problem knowing that this
    Philippe> same package used to work on my computer at the university.
    Philippe> Finally, I found out that running the same instructions as
    Philippe> root work fine.  The explanation for my computer sudden good
    Philippe> will is not that I was root, but that I ran R in a different
    Philippe> directory ... without .RData!!  (and I don't care about
    Philippe> .RData when I use R in batch mode!!).

    Philippe> Thus, would it be possible to have R not creating .RData file
    Philippe> by default in batch mode?

Most of us (I think) don't like your proposal;
.RData is the only thing to prevent losses of hours of computation
(simulation runs). 

If you want to make sure that a .RData is not interfering at the START of
your batch job, just do
(in a 'sh' script, or even better, in the Makefile, I'd recommend using):

	if [ -f .RData ]; mv .RData .RData.old; fi
	R < input.R > output.Rout


    Philippe> A second potential problem: when I build packages including
    Philippe> personal functions, I use to test my functions interactively
    Philippe> by typing library(mypackage) after modification of my code in
    Philippe> an editor.  The problem is that repeating the library load
    Philippe> does not erase the old version. Do I do something wrong?

library(.) tries to make sure to be efficient and not load the same things
twice. (--> online help  ?library ).
In the case where you are constantly changing / upgrading a library,
you should just work with  source(.)

Martin
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Friedrich.Leisch@ci.tuwien.ac.at  Thu Nov 27 10:14:51 1997
From: Friedrich.Leisch@ci.tuwien.ac.at (Friedrich Leisch)
Date: Thu, 27 Nov 1997 11:14:51 +0100
Subject: R-alpha: RData in batch
In-Reply-To: <Pine.OSF.3.96.971127103915.13153A-100000@alpha>
References: <Pine.OSF.3.96.971127103915.13153A-100000@alpha>
Message-ID: <199711271014.LAA27212@galadriel.ci.tuwien.ac.at>

>>>>> On Thu, 27 Nov 1997 11:02:26 +0100 (MET),
>>>>> Philippe Lambert (PL) wrote:

PL> Just a word to mention that I have lost 2 hours yesterday to find out=
 why
PL> R refused to use a function from a package calling C-code.
PL> R invariably answered that the C code was not in the load table (some=
thing
PL> like this). I have tried everything (or nearly) to solve my problem
PL> knowing that this same package used to work on my computer at the
PL> university.
PL> Finally, I found out that running the same instructions as root work =
fine.
PL> The explanation for my computer sudden good will is not that I was ro=
ot,
PL> but that I ran R in a different directory ... without .RData!!
PL> (and I don't care about .RData when I use R in batch mode!!).

There was a bug in dynamic loading by libraries ... the load-table was
written to the .RData file, so R didn't reload any dynamic code after
starting R a second time in a directory upon the library(...) command.
This bug is already fixed in the current sources (which are not
publicly available yet but should be out soon).


PL> Thus,=20
PL> would it be possible to have R not creating .RData file by default in
PL> batch mode?

Why don't you simply rename or delete the .Rdata file before you start
the batch simulation?


PL> A second potential problem: when I build packages including personal
PL> functions, I use to test my functions interactively by typing
PL> library(mypackage) after modification of my code in an editor.
PL> The problem is that repeating the library load does not erase the old
PL> version. Do I do something wrong?

Well, the idea of the library command is to be ``smart'' when loading
code, i.e., library first looks if the package has already been loaded
and only loads the code when this is not already loaded. This way the
overhead of loading the same stuff over and over again can be avoided.

Use source() if you want to override this.


Best,
Fritz

--=20
-------------------------------------------------------------------
                        Friedrich  Leisch                            =20
Institut f=FCr Statistik                      Tel: (+43 1) 58801 4541
Technische Universit=E4t Wien                 Fax: (+43 1)  504 14 98
Wiedner Hauptstra=DFe 8-10/1071      Friedrich.Leisch@ci.tuwien.ac.at
A-1040 Wien, Austria             http://www.ci.tuwien.ac.at/~leisch
     PGP public key http://www.ci.tuwien.ac.at/~leisch/pgp.key
-------------------------------------------------------------------

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From jlindsey@luc.ac.be  Thu Nov 27 11:02:08 1997
From: jlindsey@luc.ac.be (Jim Lindsey)
Date: Thu, 27 Nov 1997 12:02:08 +0100 (MET)
Subject: R-alpha: batch
Message-ID: <9711271102.AA20305@alpha.luc.ac.be>

There absolutely has to be a global option (environment or RProfile)
that allows creating the .RData in batch mode to be disabled. It is
not at all serious to expect that it be disabled in each batch file.
(On my complete system, I have creation of .RData in interactive mode
disabled by redefinition of q() in the global RProfile.)  Otherwise, R
will never be a serious tool for statistical work because of the
incorrect statistical analyses that stray unnoticed .RData files can
produce. If this control of options is not introduced into 0.60, I
shall have seriously reconsider whether I shall continue using R.
  Jim
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Thu Nov 27 11:05:50 1997
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 27 Nov 1997 12:05:50 +0100
Subject: R-alpha:  Latin-1 characters / Locale etc.
In-Reply-To: Martin Maechler's message of Thu, 27 Nov 1997 10:35:06 +0100
References: <199711270935.KAA03092@sophie.ethz.ch>
Message-ID: <x27m9uwq9d.fsf@blueberry.kubism.ku.dk>

Martin Maechler <maechler@stat.math.ethz.ch> writes:

>=20
> >>>>> "PD" =3D=3D Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk> writes=
:

> Hmm, so we would follow the Unix locale philosophy.
> I could live with it.
>=20
> It has however, a distinct drawback:
>=20
> You can write R code which works with R compiled in one environment bu=
t
> fails with --identical R source code-- compiled in a different environ=
ment.

Actually, it's a run-time not compile-time issue.

> While this is true for things like 'readline' and 'proc.time / system.=
time',
> I don't like it so much for such a basic things as symbol characters.

Yes, it's no good having library code that only works in some locales.
However, it should be fairly easy to enforce (in some sense) a
requirement that everything on CRAN should work with LANG=3DC (unless,
of course it *is* language-specific code).

> BTW, Peter D., do you have a (electronical form of a) document availab=
le
> which nicely explains the  locale stuff (for a user, not a C-programme=
r ..).
>  Kurt/Fritz/???: I think there are some nice pages available in Linux.=
something=20

Argh. Stop tickling my guilty conscience. I've been promising to do a
write-up of that for the Danish-Howto for months. Trouble is, I tend
to forget how to do it myself... So right now, the two main machines
that I use are not set up right (running a straigh RedHat 4.2),
whereas my old 486 does have the stuff in place.=20

> I'm still wondering:
> The  only locale thing we have is (the environment variable)
>=20
> =09LC_CTYPE=3Diso_8859_1
>=20
> But then I wonder why I saw the difference between  =E4 and =FC=20
> that I reported ....

Hmm, that *is* strange... Try a variant of

unsigned char c =3D 0;
char *p;
main()
{
        while(++c)
                if ( isalpha(c) ) putchar(c);
        putchar('\n');
}

--=20
   O__  ---- Peter Dalgaard             Blegdamsvej 3 =20
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N  =20
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From thomas@biostat.washington.edu  Thu Nov 27 17:33:37 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Thu, 27 Nov 1997 09:33:37 -0800 (PST)
Subject: R-alpha: RData in batch
In-Reply-To: <Pine.OSF.3.96.971127103915.13153A-100000@alpha>
Message-ID: <Pine.SOL.3.95.971127092638.7075A-100000@gorn>

On Thu, 27 Nov 1997, Philippe Lambert wrote:

> Finally, I found out that running the same instructions as root work fine.
> The explanation for my computer sudden good will is not that I was root,
> but that I ran R in a different directory ... without .RData!!
> (and I don't care about .RData when I use R in batch mode!!).

This is a known and probably fixed bug.  The list of currently loaded
dynamic libraries is stored in .Dyn.libs, which is (incorrectly) saved in
.Rdata.  It should just be discarded.  A temporary fix is to add 
	.Dyn.libs<-NULL
to your start-up file.

> A second potential problem: when I build packages including personal
> functions, I use to test my functions interactively by typing
> library(mypackage) after modification of my code in an editor.
> The problem is that repeating the library load does not erase the old
> version. Do I do something wrong?

No. library() is only supposed to load a package if it hasn't already been
loaded.  This is a feature.  You can unload the package with detach() and
then reload with library().  I don't know if compiled code can be unloaded
and reloaded in the current version, though I think it is at least
planned.

	-thomas

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ihaka@stat.auckland.ac.nz  Thu Nov 27 23:40:25 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Fri, 28 Nov 1997 12:40:25 +1300 (NZDT)
Subject: R-alpha:  Latin-1 characters / Locale etc.
In-Reply-To: <199711270935.KAA03092@sophie.ethz.ch>
References: <x2pvnn2ure.fsf@blueberry.kubism.ku.dk>
 <199711270935.KAA03092@sophie.ethz.ch>
Message-ID: <199711272340.MAA28827@stat1.stat.auckland.ac.nz>

Martin Maechler writes:
 > Hmm, so we would follow the Unix locale philosophy.
 > I could live with it.
 > 
 > It has however, a distinct drawback:
 > 
 > You can write R code which works with R compiled in one environment but
 > fails with --identical R source code-- compiled in a different environment.
 > 
 > While this is true for things like 'readline' and 'proc.time / system.time',

I would tend to agree that this is a drawback.  I'd rather see a
locale independent solution.  So let me repeat my invitation ...
If someone will send me a function which identifies the set of
characters which can be used in identifiers (in addition to "."), I
will add it to the sources.

Getting it exactly right first time probably isn't crucial.
I'm sure we'll here form anyone who feels slighted :).
	Ross
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ihaka@stat.auckland.ac.nz  Thu Nov 27 23:57:40 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Fri, 28 Nov 1997 12:57:40 +1300 (NZDT)
Subject: R-alpha: RData in batch
In-Reply-To: <Pine.OSF.3.96.971127103915.13153A-100000@alpha>
References: <Pine.OSF.3.96.971127103915.13153A-100000@alpha>
Message-ID: <199711272357.MAA01329@stat1.stat.auckland.ac.nz>

Philippe Lambert writes:
 > Thus, 
 > would it be possible to have R not creating .RData file by default in
 > batch mode?

Hmmm.  Actually I was on your side, but there were a number of
requests to do it the other way.

So let me play Solomon ...

I think that I will introduce two new options to be used when invoking
R.

	R -save
	R -nosave

The default behavior in batch mode will be to refuse to run unless one
of these options is specified.

Multiple versions of these options will be allowed on the command
line, and it is the last (rightmost) one which determines what
happens.

In the front-end shell-script there is a line which reads

	exec $DEBUGGER $RHOME/bin/R.binary $*

and I will change this to

	exec $DEBUGGER $RHOME/bin/R.binary $BATCHSAVE $*

and give the person installing R the option of setting a value for
BATCHSAVE in the config.site script (or when we go gnu --with-save
or --with-nosave).

This way there can be a site-wide selection of the default behavior
which individual users can override.

Sound ok?
	Ross

(I think that Thomas L pointed out that the real bug that bit you has
been fixed too).
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Nov 28 07:45:39 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 28 Nov 1997 08:45:39 +0100
Subject: R-alpha:  Latin-1 characters / Locale etc.
In-Reply-To: <x2zpmquyvg.fsf@blueberry.kubism.ku.dk> (message from Peter
 Dalgaard BSA on 27 Nov 1997 16:42:43 +0100)
Message-ID: <199711280745.IAA04422@sophie.ethz.ch>

[to R-devel,  for everyone's information;
 thanks a lot, Peter!]

>>>>> "PD" =3D=3D Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk> writes:

    PD> Hmmm. You may need a call to 
       
    PD> #include <locale.h>
    PD> setlocale(LC_ALL,"")

    PD> (or LC_CTYPE?) before your environment variables take effect.

Yes, this was `it'.  
Maybe  R  needs such a call also? (I did not yet look in the src)


sophie{maechler}328> cat isalpha-tst.c
=09=09=09 -------------
/*--- Testing  'locale' [env.variable  LC_CTYPE ] --------------- */

#include <ctype.h> /*- isalpha(.) -*/
#include <stdio.h> /*- putchar(.) -*/
#include <locale.h>

unsigned char c =3D 0;
char *p;
void main()
{
  setlocale(LC_ALL,"");

  while(++c)
    if ( isalpha(c) ) putchar(c);
  putchar('\n');
}
sophie{maechler}329> cc isalpha-tst.c
sophie{maechler}330> cc -V
cc: SC3.0.1 13 Jul 1994
usage: cc [ options] files.  Use 'cc -flags' for details

sophie{maechler}314> printenv LC_CTYPE
iso_8859_1

sophie{maechler}331> isalpha-tst 
ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz=C0=C1=C2=C3=C4=C5=C6=
=C7=C8=C9=CA=CB=CC=CD=CE=CF=D0=D1=D2=D3=D4=D5=D6=D8=D9=DA=DB=DC=DD=DE=DF=E0=
=E1=E2=E3=E4=E5=E6=E7=E8=E9=EA=EB=EC=ED=EE=EF=F0=F1=F2=F3=F4=F5=F6=F8=F9=FA=
=FB=FC=FD=FE=FF

sophie{maechler}332> gcc -v
Reading specs from /usr/local/lib/gcc-lib/sparc-sun-solaris2.5/2.7.2.1/spec=
s
gcc version 2.7.2.1
sophie{maechler}333> gcc isalpha-tst.c
sophie{maechler}334> isalpha-tst
ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz=C0=C1=C2=C3=C4=C5=C6=
=C7=C8=C9=CA=CB=CC=CD=CE=CF=D0=D1=D2=D3=D4=D5=D6=D8=D9=DA=DB=DC=DD=DE=DF=E0=
=E1=E2=E3=E4=E5=E6=E7=E8=E9=EA=EB=EC=ED=EE=EF=F0=F1=F2=F3=F4=F5=F6=F8=F9=FA=
=FB=FC=FD=FE=FF



sophie{maechler}335> unsetenv LC_CTYPE
sophie{maechler}336> isalpha-tst
ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz

sophie{maechler}337> setenv LC_CTYPE C
sophie{maechler}338> isalpha-tst
ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz

sophie{maechler}339> setenv LC_CTYPE es=09#-- espa=F1ol
sophie{maechler}340> isalpha-tst
ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz=C0=C1=C2=C3=C4=C5=C6=
=C7=C8=C9=CA=CB=CC=CD=CE=CF=D0=D1=D2=D3=D4=D5=D6=D8=D9=DA=DB=DC=DD=DE=DF=E0=
=E1=E2=E3=E4=E5=E6=E7=E8=E9=EA=EB=EC=ED=EE=EF=F0=F1=F2=F3=F4=F5=F6=F8=F9=FA=
=FB=FC=FD=FE=FF
sophie{maechler}341> setenv LC_CTYPE de #-- deutsch
sophie{maechler}342> isalpha-tst
ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz=C0=C1=C2=C3=C4=C5=C6=
=C7=C8=C9=CA=CB=CC=CD=CE=CF=D0=D1=D2=D3=D4=D5=D6=D8=D9=DA=DB=DC=DD=DE=DF=E0=
=E1=E2=E3=E4=E5=E6=E7=E8=E9=EA=EB=EC=ED=EE=EF=F0=F1=F2=F3=F4=F5=F6=F8=F9=FA=
=FB=FC=FD=FE=FF
sophie{maechler}345> setenv LC_CTYPE iso_8859_1
sophie{maechler}346> isalpha-tst
ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz=C0=C1=C2=C3=C4=C5=C6=
=C7=C8=C9=CA=CB=CC=CD=CE=CF=D0=D1=D2=D3=D4=D5=D6=D8=D9=DA=DB=DC=DD=DE=DF=E0=
=E1=E2=E3=E4=E5=E6=E7=E8=E9=EA=EB=EC=ED=EE=EF=F0=F1=F2=F3=F4=F5=F6=F8=F9=FA=
=FB=FC=FD=FE=FF

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From jlindsey@luc.ac.be  Fri Nov 28 08:25:04 1997
From: jlindsey@luc.ac.be (Jim Lindsey)
Date: Fri, 28 Nov 1997 09:25:04 +0100 (MET)
Subject: R-alpha: batch
Message-ID: <9711280825.AA30943@alpha.luc.ac.be>

In my limited knowledge of computers, a program that creates a hidden
file without informing you and then, in subsequent runs, has its
behaviour modified in unpredictable ways because of this is called a
virus.
  I am glad to learn that, with Ross's suggestion, R will finally be
removed from this undesirable class of programs, something that I have
been requesting since v0.13.
  I strongly recommend that the default in the distribution be no
.RData so the beginners do not get badly burned. The warnings in the
R notes about cleaning up before creating the .RData are far from
sufficient to indicate the dangers of these files. There should also
be a clear statement in the FAQ about the problems with their
existence.
  Jim 
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From plummer@iarc.fr  Fri Nov 28 11:05:22 1997
From: plummer@iarc.fr (Martyn Plummer)
Date: Fri, 28 Nov 1997 12:05:22 +0100 (MET)
Subject: R-alpha: Problems with dimnames and names
Message-ID: <XFMail.971128122615.plummer@iarc.fr>

This message is in MIME format
--_=XFMail.1.1.p0.Linux:971128122615:3052=_
Content-Type: text/plain; charset=us-ascii

I have rounded up three buglets in R-0.50-a4. Two of them I can
fix and a patch is supplied below. I hope this is useful for the
current source (if these haven't been fixed already :)

1) cov
cov() fails when it's argument is a matrix with one column and with
column names defined. It tries to apply dimnames to the output but
the output is a vector of length 1.

> x <- matrix(rnorm(100),ncol=1,dimnames=list(NULL,"foo"))
> var(x)
Error: dimnames applied to non-array

2) Subscripting one-dimensional arrays.
These are treated as vectors when subscripting
so subscripting by dimnames fails.

> x <- c(0,0,0,1,1,1,1,3)
> table(x)
0 1 3
3 4 1
> table(x)["3"]
Error: subscript out of bounds

3) I have no idea what's going on here.

> c(r=1,s=2)
s
2
> c(u=100,b=4)
b
4

This seems to happen only for "r" and "u". Other single-letter
names are OK. This doesn't happen on my home PC which is still
running R-0.50-a1.

Martyn

--_=XFMail.1.1.p0.Linux:971128122615:3052=_
Content-Type: text/plain; charset=us-ascii; name=apatch; SizeOnDisk=1206
Content-Description: apatch
Content-Transfer-Encoding: 7bit
Content-Disposition: attachment; filename="apatch"

diff -ur R-0.50-a4/src/main/cov.c R-0.50-a4.patched/src/main/cov.c
--- R-0.50-a4/src/main/cov.c	Sun Nov 24 23:43:05 1996
+++ R-0.50-a4.patched/src/main/cov.c	Fri Nov 28 11:21:23 1997
@@ -390,7 +390,7 @@
 	}
 	if(isNull(y)) {
 		x = getAttrib(x, R_DimNamesSymbol);
-		if(!isNull(x) && !isNull(CADR(x))) {
+		if(ncx > 1 && !isNull(x) && !isNull(CADR(x))) {
 			PROTECT(ind = allocList(2));
 			CAR(ind) = CADR(x);
 			CADR(ind) = CADR(x);
@@ -401,7 +401,7 @@
 	else {
 		x = getAttrib(x, R_DimNamesSymbol);
 		y = getAttrib(y, R_DimNamesSymbol);
-		if((!isNull(x) && !isNull(CADR(x))) || (!isNull(y) && !isNull(CADR(y)))) {
+		if((ncx > 1 && !isNull(x) && !isNull(CADR(x))) || ( ncy > 1 && !isNull(y) && 
!isNull(CADR(y)))) {
 			PROTECT(ind = allocList(2));
 			CAR(ind) = CADR(x);
 			CADR(ind) = CADR(y);
diff -ur R-0.50-a4/src/main/subset.c R-0.50-a4.patched/src/main/subset.c
--- R-0.50-a4/src/main/subset.c	Mon Aug 11 04:59:12 1997
+++ R-0.50-a4.patched/src/main/subset.c	Fri Nov 28 11:16:55 1997
@@ -608,7 +608,7 @@
 		PROTECT(dim = getAttrib(x, R_DimSymbol));
 		nsubs = length(subs);
 
-		if(nsubs == 1) {
+		if(nsubs == 1 && isNull(dim)) {
 			ans = vectorSubset(x, CAR(subs), call);
 		}
 		else {

--_=XFMail.1.1.p0.Linux:971128122615:3052=_--
End of MIME message
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Fri Nov 28 10:48:36 1997
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 28 Nov 1997 11:48:36 +0100
Subject: R-alpha: batch
In-Reply-To: Jim Lindsey's message of Fri, 28 Nov 1997 09:25:04 +0100 (MET)
References: <9711280825.AA30943@alpha.luc.ac.be>
Message-ID: <x2zpmpgupn.fsf@blueberry.kubism.ku.dk>

Jim Lindsey <jlindsey@luc.ac.be> writes:

> 
> In my limited knowledge of computers, a program that creates a hidden
> file without informing you and then, in subsequent runs, has its
> behaviour modified in unpredictable ways because of this is called a
> virus.

Aw c'mon, Jim! A program that changes *it's own* behavior based on a
saved wokspace? There's a company in Redmond employing thousands of
people producing millions of viruses and charging money for them to
boot, then.

Your voice in this matter is becoming increasingly shrill, and it is
becoming more and more difficult to take you seriously. Not saying
that you might not be right, but how about taking other people's
opinions into account?

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Fri Nov 28 10:56:35 1997
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 28 Nov 1997 11:56:35 +0100
Subject: R-alpha: Problems with dimnames and names
In-Reply-To: Martyn Plummer's message of Fri, 28 Nov 1997 12:05:22 +0100 (MET)
References: <XFMail.971128122615.plummer@iarc.fr>
Message-ID: <x2wwhtgucc.fsf@blueberry.kubism.ku.dk>

Martyn Plummer <plummer@iarc.fr> writes:

> 3) I have no idea what's going on here.
> 
> > c(r=1,s=2)
> s
> 2
> > c(u=100,b=4)
> b
> 4
> 
> This seems to happen only for "r" and "u". Other single-letter
> names are OK. This doesn't happen on my home PC which is still
> running R-0.50-a1.

"r" is probably matching "recursive", but what about "u"? ("unlist"??)

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From plummer@iarc.fr  Fri Nov 28 12:26:07 1997
From: plummer@iarc.fr (Martyn Plummer)
Date: Fri, 28 Nov 1997 13:26:07 +0100 (MET)
Subject: R-alpha: Problems with dimnames and names
Message-ID: <XFMail.971128133158.plummer@iarc.fr>

On 28-Nov-97 p.dalgaard@biostat.ku.dk wrote:
>Martyn Plummer <plummer@iarc.fr> writes:
>
>> 3) I have no idea what's going on here.
>> 
>> > c(r=1,s=2)
>> s
>> 2
>> > c(u=100,b=4)
>> b
>> 4
>>
>"r" is probably matching "recursive", but what about "u"? ("unlist"??)

Aha! It's matching use.names (one of the arguments of unlist())
> c(u=0,x=1,y=2)
[1] 1 2
> c(u=10,x=1,y=2)
x y
1 2

Isn't it a bit dangerous to allow partial matching of arguments
(especially undocumented arguments)? NB It doesn't consistently
match the arguments either:

> c(r=1,u=2)
u
2
> c(u=2,r=1)
r
1

Martyn
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Nov 28 14:11:30 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 28 Nov 1997 15:11:30 +0100
Subject: R-alpha: "..." arg.matching [was 'Problems with dimnames and names']
In-Reply-To: <XFMail.971128122615.plummer@iarc.fr> (message from Martyn
 Plummer on Fri, 28 Nov 1997 12:05:22 +0100 (MET))
Message-ID: <199711281411.PAA05002@sophie.ethz.ch>

>>>>> "Martyn" == Martyn Plummer <plummer@iarc.fr> writes:

    Martyn> I have rounded up three buglets in R-0.50-a4. Two of them I can
    Martyn> fix and a patch is supplied below. I hope this is useful for the
    Martyn> current source (if these haven't been fixed already :)

Both of these bugs are already fixed in 0.60

    Martyn> 1) cov
    Martyn> cov() fails when it's argument is a matrix with one column and with
    Martyn> column names defined. It tries to apply dimnames to the output but
    Martyn> the output is a vector of length 1.

    >> x <- matrix(rnorm(100),ncol=1,dimnames=list(NULL,"foo"))
    >> var(x)
    Martyn> Error: dimnames applied to non-array

    Martyn> 2) Subscripting one-dimensional arrays.
    Martyn> These are treated as vectors when subscripting
    Martyn> so subscripting by dimnames fails.

    >> x <- c(0,0,0,1,1,1,1,3)
    >> table(x)
    Martyn> 0 1 3
    Martyn> 3 4 1
    >> table(x)["3"]
    Martyn> Error: subscript out of bounds

-- Now to the ``real'' one : --

    Martyn> 3) I have no idea what's going on here.

    >> c(r=1,s=2)
    Martyn> s
    Martyn> 2
    >> c(u=100,b=4)
    Martyn> b
    Martyn> 4

    Martyn> This seems to happen only for "r" and "u". Other single-letter
    Martyn> names are OK. This doesn't happen on my home PC which is still
    Martyn> running R-0.50-a1.

Well, we (i.e., Peter and Martyn) have found *why* it happens.

However, this is a semantic change from older versions of R and from S
which I consider serious [a bug ?!?] an we should discuss.

The general accepted semantic for S is:

  <> <>  If a function has a '...' argument,                    <> <>
  <> <>  all the other argument names must be matched EXACTLY,  <> <>    (S)
  <> <>  not only up to the unique string beginning.            <> <>

This behaviour (S) definitely IS a pain sometimes,
because it forces you not abbreviate argument names for all these
functions.

For the ``function writer'', this leads to 
  1) you really should only use "..." arguments if you must.
  2) if you have "..." argument(s),
	use relatively short argument names for the other arguments
  3) if there are named arguments in "..." (which is the usual case),
	make sure 
		[if you can, which is the case mostly, but not for 'c(.)']
	that all the argument names are valid.


Unfortunately, "3)" is not followed too often in S-plus,
which leads to the ``famous'' situation, that

	glm(ni ~ x1 * x2, familiy = binomial)

will fit a normal instead of a logistic regression,
with no warning, just because of a 1 letter typo ..

	(misspelling of 'familiy' makes the whole argument be ignored,
	  and family = gaussian , the default, be taken).

--------

So, we now see why Ross(?) may have wanted
to change the  argument matching behavior in the "..." case.
[[Rule: If  S  does things wierdly, R should do better ...]]

I still think however that this must be carefully tought over,
and I am not yet convinced if we shouldn't follow the S way after all.
Where we could do better (in our `own' functions) is to folllow my rule 
"3)" above as strictly as possible.


Martin Maechler <maechler@stat.math.ethz.ch>		 <><
Seminar fuer Statistik, SOL G1
ETH (Federal Inst. Technology)	8092 Zurich	 SWITZERLAND
phone: x-41-1-632-3408		fax: ...-1086
http://www.stat.math.ethz.ch/~maechler/

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ihaka@stat.auckland.ac.nz  Fri Nov 28 19:35:06 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Sat, 29 Nov 1997 08:35:06 +1300 (NZDT)
Subject: R-alpha: "..." arg.matching [was 'Problems with dimnames and names']
Message-ID: <199711281935.IAA13179@stat1.stat.auckland.ac.nz>

> -- Now to the ``real'' one : --
>
>     Martyn> 3) I have no idea what's going on here.
>
>     >> c(r=1,s=2)
>     Martyn> s
>     Martyn> 2
>     >> c(u=100,b=4)
>     Martyn> b
>     Martyn> 4
>
>     Martyn> This seems to happen only for "r" and "u". Other single-letter
>     Martyn> names are OK. This doesn't happen on my home PC which is still
>     Martyn> running R-0.50-a1.
>
> Well, we (i.e., Peter and Martyn) have found *why* it happens.
>
> However, this is a semantic change from older versions of R and from S
> which I consider serious [a bug ?!?] an we should discuss.

This wasn't a deliberate change, just my usual incompetence.
I think it crept in when we changed c() to be a generic function
(which does method dispatch internally).

The problem is in the function "ExtractOptionals" in bind.c.  There the
matching of arguments is done in two places with pmatch using a third
argument which is 0.  This indicates partial matching and should be
changed so that the third argument is 1 indicating exact matching.

	Ross
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From bates@stat.wisc.edu  Fri Nov 28 22:20:22 1997
From: bates@stat.wisc.edu (Douglas Bates)
Date: 28 Nov 1997 16:20:22 -0600
Subject: R-alpha: documentation for nlm
Message-ID: <6r4t4wek49.fsf@franz.stat.wisc.edu>

The documentation for nlm lists an argument named iterlim but the name
of the argument in the function itself is itnlim (a legacy of the
Fortran code, no doubt).
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

