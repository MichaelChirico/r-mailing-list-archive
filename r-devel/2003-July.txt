From sue.macrae at utoronto.ca  Tue Jul  1 05:53:41 2003
From: sue.macrae at utoronto.ca (sue.macrae@utoronto.ca)
Date: Tue Jul  1 10:54:06 2003
Subject: [Rd] autoreply
Message-ID: <20030701085353Z930332-9134+10@bureau10.utcc.utoronto.ca>

Your message has been filed for future reading.
Back  Sep 2, 03.  Not checking e-mail.  Have a nice summer.

From noreply at cusa.com  Tue Jul  1 19:19:23 2003
From: noreply at cusa.com (noreply@cusa.com)
Date: Wed Jul  2 02:19:24 2003
Subject: [Rd] CUSA.COM detected a violation in a document you authored.
Message-ID: <OF8AFDBBD5.5799D379-ON87256D57.0001C663@cusa.com>





Please contact your system administrator immediately, it appears you may
have a virus and that your system is attempting to send that virus to other
users.


The scanned document was QUARANTINED.


Violation Information:
The attachment your_details.zip [details.pif] contained the virus
W32.Sobig.E@mm and could NOT be repaired.

From jmc at research.bell-labs.com  Wed Jul  2 15:46:15 2003
From: jmc at research.bell-labs.com (John Chambers)
Date: Wed Jul  2 20:46:34 2003
Subject: [Rd] S4 method setClass prototype definition question
References: <news2mail-3EF86BE1.4080508@epigenomics.com>
Message-ID: <3F032877.B051071E@research.bell-labs.com>

I think you didn't type what you meant to type (see below.)

Sourcing in your class descriptions with 1.7.1, I get what you expected.


> new("Annotation1")
An object of class "Annotation1"
Slot "x":
NULL

Slot "y":
NULL

Slot "catId":
[1] -1

Slot "isResolved":
[1] FALSE

Slot "resolve":
logical(0)

Slot "valid":
[1] TRUE



Matthias Burger wrote:
> 
> Dear list,
> 
> this is not a problem report -- I would like to ask for advise what the
> recommended and safe way to perform the following is or what problems might
> arise in doing it differently.
> 
> The question is:  What is the recommended way of providing a default value in a
> prototype statement for a derived class for a slot provided from a parent class?
> I have first consulted the methods package reference but am still unclear to as
> this point.
> 
> The following is a bit length example + variations thereof taken from a real
> project.
> 
> I would appreciate any comments and insights shared.
> 
> Best regards,
> 
>    Matthias
> 
> ##
> ##  R 1.7.1 on Debian Linux (compiled with gcc 3.2.2)
>  > version
>           _
> platform i686-pc-linux-gnu
> arch     i686
> os       linux-gnu
> system   i686, linux-gnu
> status
> major    1
> minor    7.1
> year     2003
> month    06
> day      16
> language R
> 
> ##  define a base class (virtual) without prototype
>    setClass("IDataType",
>             representation("VIRTUAL",
>                            valid="logical"),
>             validity=NULL,
>             sealed=TRUE)
> 
> ##  same now with prototype definition
>    setClass("IDataType1",
>             representation("VIRTUAL",
>                            valid="logical"),
>             prototype=list(valid=TRUE),
>             validity=NULL,
>             sealed=TRUE)
> 
> ## and now the derived class in question
> ## the slot under investigatin is 'valid'
>     setClass("Annotation",
>              representation ("IDataType",
>                              x="vector",
>                              y="vector",
>                              catId="integer",
>                              isResolved="logical",
>                              resolve="logical"),
>              prototype(isResolved=FALSE,
>                        catId=as.integer(-1)),
>              validity=NULL,
>              sealed=TRUE)
> 
> ##  instantiate an object an
> an<-new("Annotation")
>  > an
> An object of class "Annotation"
> Slot "x":
> NULL
> 
> Slot "y":
> NULL
> 
> Slot "catId":
> [1] -1
> 
> Slot "isResolved":
> [1] FALSE
> 
> Slot "resolve":
> logical(0)
> 
> Slot "valid":
> logical(0)
> 
> ##  which is what I expected. Now in order to set a default for
> ##  the 'valid' slot (provided by the parent class 'IDataType') in the
> ##  Annotation class I tried
> 
> setClass("Annotation1",
>              representation ("IDataType",
>                              x="vector",
>                              y="vector",
>                              catId="integer",
>                              isResolved="logical",
>                             resolve="logical"),
>              prototype(isResolved=FALSE,
>                        catId=as.integer(-1),
>                        valid=TRUE),
>              validity=NULL,
>              sealed=TRUE)
> 
> ##  instantiate an object an1
>  > an1<-new("Annotation")

Sorry, naming it an1 still leaves it an object of class "Annotation", as
the printed output tells you.


>  > an1
> An object of class "Annotation"
> Slot "x":
> NULL
> 
> Slot "y":
> NULL
> 
> Slot "catId":
> [1] -1
> 
> Slot "isResolved":
> [1] FALSE
> 
> Slot "resolve":
> logical(0)
> 
> Slot "valid":
> logical(0)
> 
> ##  now this is NOT what I had expected; my prediction would have been to see
> ##  slot 'valid' set to TRUE
> 
> ##  ok, so this is an alternative to get what I aimed at, i.e. use the 2nd
> ##  virtual base class IDataType1 with prototype definition
>   setClass("Annotation2",
>              representation ("IDataType1",
>                              x="vector",
>                              y="vector",
>                              catId="integer",
>                              isResolved="logical",
>                              resolve="logical"),
>              prototype(isResolved=FALSE,
>                        catId=as.integer(-1)),
>              validity=NULL,
>              sealed=TRUE)
> [1] "Annotation2"
>  > an2<-new("Annotation2")
>  > an2
> An object of class "Annotation2"
> Slot "x":
> NULL
> 
> Slot "y":
> NULL
> 
> Slot "catId":
> [1] -1
> 
> Slot "isResolved":
> [1] FALSE
> 
> Slot "resolve":
> logical(0)
> 
> Slot "valid":
> [1] TRUE
> 
> ##  so this does what I aimed at but surprises me as I thought it would
> ##  not make sense
> ##  to provide a prototype for a virtual class
> 
> ## reading further in the methods package reference manual
> ## (refman.pdf: The Methods Package)
> ## I conclude that setAs
> 
> ##  use IDataType class w prototype and explicit contains statement
>  >  setClass("Annotation3",
>             representation ("IDataType1",
>                             x="vector",
>                             y="vector",
>                             catId="integer",
>                             isResolved="logical",
>                             resolve="logical"),
>             prototype(isResolved=FALSE,
>                       catId=as.integer(-1)),
>             contains=as.character("IDataType1"),
>             validity=NULL,
>             sealed=TRUE)
> 
> [1] "Annotation3"
>  > an3<-new("Annotation3")
>  > an3
> An object of class "Annotation3"
> Slot "x":
> NULL
> 
> Slot "y":
> NULL
> 
> Slot "catId":
> [1] -1
> 
> Slot "isResolved":
> [1] FALSE
> 
> Slot "resolve":
> logical(0)
> 
> Slot "valid":
> [1] TRUE
> 
> ##  so this works aswell
> ##  and yet another alternative:
> ##  use IDataType class w/o prototype but explicitly use
> ##  contain=as.character("IDataType")
> ##  statement and set slot 'valid' prototype
>  >   setClass("Annotation4",
>              representation ("IDataType",
>                              x="vector",
>                              y="vector",
>                              catId="integer",
>                              isResolved="logical",
>                              resolve="logical"),
>              prototype(isResolved=FALSE,
>                        catId=as.integer(-1),
>                        valid=TRUE),
>              contains=as.character("IDataType"),
>              validity=NULL,
>              sealed=TRUE)
> 
> [1] "Annotation4"
> 
>  > an4<-new("Annotation4")
>  > an4
> An object of class "Annotation4"
> Slot "x":
> NULL
> 
> Slot "y":
> NULL
> 
> Slot "catId":
> [1] -1
> 
> Slot "isResolved":
> [1] FALSE
> 
> Slot "resolve":
> logical(0)
> 
> Slot "valid":
> [1] TRUE
> 
> ##  This also works as expected.
> 
> ##  So what is the recommended way of providing a default in a prototype
> ##  statement for a
> ##  slot provided from a parent class?
> 
> --
> Matthias Burger
> 
> Bioinformatics R&D
> Epigenomics AG                      www.epigenomics.com
> Kleine Pr?sidentenstra?e 1          fax:   +49-30-24345-555
> 10178 Berlin Germany                phone: +49-30-24345-0
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://www.stat.math.ethz.ch/mailman/listinfo/r-devel

-- 
John M. Chambers                  jmc@bell-labs.com
Bell Labs, Lucent Technologies    office: (908)582-2681
700 Mountain Avenue, Room 2C-282  fax:    (908)582-3340
Murray Hill, NJ  07974            web: http://www.cs.bell-labs.com/~jmc

From arnima at u.washington.edu  Thu Jul  3 00:32:14 2003
From: arnima at u.washington.edu (arnima@u.washington.edu)
Date: Wed Jul  2 23:32:15 2003
Subject: [Rd] Minor error in area() documentation (PR#3378)
Message-ID: <200307022132.h62LWEJH019522@pubhealth.ku.dk>

Dear r-bugs,

The 'see also' link in help(area,html=T) is broken, see line 91 in
library/MASS/html/area.html:

"../../integrate/html/integrate.html"
should be
"../../base/html/integrate.html"

Regards,
Arni

OS:   Windows XP
R:    1.7.1
MASS: 7.1-8

From ripley at stats.ox.ac.uk  Thu Jul  3 08:07:48 2003
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu Jul  3 08:07:48 2003
Subject: [Rd] Minor error in area() documentation (PR#3378)
In-Reply-To: <200307022132.h62LWEJH019522@pubhealth.ku.dk>
Message-ID: <Pine.LNX.4.44.0307030702080.19222-100000@gannet.stats>

This part of a contributed package (MASS), not part of R.  Please send 
comments on contributed packages to their maintainers rather than R-bugs.

In this case the link was intentionally to package `integrate', which is
no longer on CRAN (but is still installed in some places).  It is quite
legitimate for packages to link to other packages, when the links will be
broken if the other packages are not installed.  Remember that function
area() is only there for historical continuity (it has a 1994 reference).

On Wed, 2 Jul 2003 arnima@u.washington.edu wrote:

> Dear r-bugs,
> 
> The 'see also' link in help(area,html=T) is broken, see line 91 in
> library/MASS/html/area.html:
> 
> "../../integrate/html/integrate.html"
> should be
> "../../base/html/integrate.html"
> 
> Regards,
> Arni
> 
> OS:   Windows XP
> R:    1.7.1
> MASS: 7.1-8
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://www.stat.math.ethz.ch/mailman/listinfo/r-devel
> 

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From th50 at leicester.ac.uk  Thu Jul  3 15:01:24 2003
From: th50 at leicester.ac.uk (Hotz, T.)
Date: Thu Jul  3 15:01:23 2003
Subject: [Rd] Use of PKG_FFLAGS on Windows
Message-ID: <1F2CE8D4B0195E488213E8B8CCF714860161B66F@saffron.cfs.le.ac.uk>

Dear all,

After reading the manuals (especially R-exts) I haven't found 
an answer to the following question yet.

I was compiling someone else's Fortran routines to make them 
available with R. Hear, I should not that I don't know anything 
about Fortran, and I only tried to built a shared library.

Linux being my platform of choice when developing for R, I first 
got everything done there, using R CMD COMPILE, and R CMD SHLIB. 
Since g77 complained about the Fortran Codes indentation style, 
I assumed (after reading g77's manpage) that the Fortran code is 
given in free-form dialect. Therefore, I added a line 
PKG_FFLAGS+= -ffree-form to Makevars. Compilation and building 
went fine and I successfully accessed the routines using dyn.load 
and .Fortran.

My colleague, who wanted this done, runs R under windows. So I 
learnt how to build a package under windows (readme.packages is a 
great guide!), and it went all smoothly, except: option -free-form 
no longer was passed to g77 (from Rtools), which caused compilation 
to fail. Renaming Makevars to Makevars.win did not help.

Investigating this in more detail, I found that MakeDLL contains 
the line
<snip>
FFLAGS=-O2 $(DEBUGFLAG)
<snip>
so PKG_FFLAGS weren't used at all. Changing this line to
<snip>
FFLAGS=$(PKG_FFLAGS) -O2 $(DEBUGFLAG)
<snip>
resolved the problem, however. I subsequently was again able to access 
the routines of the built library.

My question now is: is this behaviour intended, and, if so, why? I am 
curious only because I might want to make this package freely 
available, and wouldn't like to ask people to change MakeDLL which I 
assume was written that way for good reasons. If the change in 
MakeDLL is not necessary, how do I then pass a compiler option to g77?

Any comments and suggestions are very welcome. I hope my minor 
knowledge has not raised problems to far off-topic. Thanks  in advance 
for your time and help.

Best wishes

Thomas

---

> version
         _              
platform i386-pc-mingw32
arch     i386           
os       mingw32        
system   i386, mingw32  
status                  
major    1              
minor    7.1            
year     2003           
month    06             
day      16             
language R 

---

Thomas Hotz
Research Associate in Medical Statistics
University of Leicester
United Kingdom

Department of Epidemiology and Public Health
22-28 Princess Road West
Leicester
LE1 6TP
Tel +44 116 252-5410
Fax +44 116 252-5423

Division of Medicine for the Elderly
Department of Medicine
The Glenfield Hospital
Leicester
LE3 9QP
Tel +44 116 256-3643
Fax +44 116 232-2976

From ripley at stats.ox.ac.uk  Thu Jul  3 15:56:08 2003
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu Jul  3 15:56:12 2003
Subject: [Rd] Use of PKG_FFLAGS on Windows
In-Reply-To: <1F2CE8D4B0195E488213E8B8CCF714860161B66F@saffron.cfs.le.ac.uk>
Message-ID: <Pine.LNX.4.44.0307031447440.1887-100000@gannet.stats>

On Thu, 3 Jul 2003, Hotz, T. wrote:

> Dear all,
> 
> After reading the manuals (especially R-exts) I haven't found 
> an answer to the following question yet.
> 
> I was compiling someone else's Fortran routines to make them 
> available with R. Hear, I should not that I don't know anything 
> about Fortran, and I only tried to built a shared library.
> 
> Linux being my platform of choice when developing for R, I first 
> got everything done there, using R CMD COMPILE, and R CMD SHLIB. 
> Since g77 complained about the Fortran Codes indentation style, 
> I assumed (after reading g77's manpage) that the Fortran code is 
> given in free-form dialect. Therefore, I added a line 
> PKG_FFLAGS+= -ffree-form to Makevars. Compilation and building 
> went fine and I successfully accessed the routines using dyn.load 
> and .Fortran.
> 
> My colleague, who wanted this done, runs R under windows. So I 
> learnt how to build a package under windows (readme.packages is a 
> great guide!), and it went all smoothly, except: option -free-form 
> no longer was passed to g77 (from Rtools), which caused compilation 
> to fail. Renaming Makevars to Makevars.win did not help.
> 
> Investigating this in more detail, I found that MakeDLL contains 
> the line
> <snip>
> FFLAGS=-O2 $(DEBUGFLAG)
> <snip>
> so PKG_FFLAGS weren't used at all. Changing this line to
> <snip>
> FFLAGS=$(PKG_FFLAGS) -O2 $(DEBUGFLAG)
> <snip>
> resolved the problem, however. I subsequently was again able to access 
> the routines of the built library.
> 
> My question now is: is this behaviour intended, and, if so, why? I am 
> curious only because I might want to make this package freely 
> available, and wouldn't like to ask people to change MakeDLL which I 
> assume was written that way for good reasons. If the change in 
> MakeDLL is not necessary, how do I then pass a compiler option to g77?
> 
> Any comments and suggestions are very welcome. I hope my minor 
> knowledge has not raised problems to far off-topic. Thanks  in advance 
> for your time and help.

Why no just transform the Fortran to legal Fortran?  You can't assume that
your users are going to be using gcc (and from your comments I gather you 
are intending to distribute this).

PKG_FFLAGS has never been implemented on Windows, because we have never
seen a need for it.  I have just added it to the development version.
Nevertheless, it will be hard to find compiler-independent settings and I 
actually don't know of any possibilities.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From matthias.burger at epigenomics.com  Thu Jul  3 17:26:22 2003
From: matthias.burger at epigenomics.com (Matthias Burger)
Date: Thu Jul  3 16:26:28 2003
Subject: [Rd] S4 method setClass prototype definition question
References: <news2mail-3EF86BE1.4080508@epigenomics.com>
	<3F032877.B051071E@research.bell-labs.com>
Message-ID: <3F043D0E.2030304@epigenomics.com>


John Chambers wrote:
> I think you didn't type what you meant to type (see below.)
> 
> Sourcing in your class descriptions with 1.7.1, I get what you expected.
> 


You are of course correct! Thanks for pointing this out. I should have looked 
more carefully!

[...]

Still the answer to the question on what is the recommended programming style 
for setClass definitions is not clear to me. For what purpose or in which 
circumstances should one use the 'contains' argument?
See the example code below. What side effects has it or what difference is there 
between the two versions (if any).

I would be very happy for any help gaining a clearer understanding of that 
mechanism.


Regards,


    Matthias


setClass("IDataType",
          representation("VIRTUAL",
                         valid="logical"),
          validity=NULL,
          sealed=TRUE)

##  define the parent class dependency in representation
setClass("Annotation1",
          representation ("IDataType",
                          x="vector",
                          y="vector",
                          catId="integer",
                          isResolved="logical",
                          resolve="logical"),
          prototype(isResolved=FALSE,
                    catId=as.integer(-1),
                    valid=TRUE),
          validity=NULL,
          sealed=TRUE)

##  define the dependency via a contains statement
setClass("Annotation2",
          representation (x="vector",
                          y="vector",
                          catId="integer",
                          isResolved="logical",
                          resolve="logical"),
          prototype(isResolved=FALSE,
                    catId=as.integer(-1),
                    valid=TRUE),
          contains=as.character("IDataType"),
          validity=NULL,
          sealed=TRUE)


 > an1 <- new("Annotation1")
 > an1
An object of class "Annotation1"
Slot "x":
NULL

Slot "y":
NULL

Slot "catId":
[1] -1

Slot "isResolved":
[1] FALSE

Slot "resolve":
logical(0)

Slot "valid":
[1] TRUE

 > an2 <- new("Annotation2")
 > an2
An object of class "Annotation2"
Slot "x":
NULL

Slot "y":
NULL

Slot "catId":
[1] -1

Slot "isResolved":
[1] FALSE

Slot "resolve":
logical(0)

Slot "valid":
[1] TRUE



 > all.equal(an1,an2)
[1] "Attributes: < Component 2: 1 string mismatches >"

So I conclude that appart from the class name those two objects are the same, 
and accordingly they will behave the same in all situations, won't they?




-- 
Matthias Burger

Bioinformatics R&D
Epigenomics AG                      www.epigenomics.com
Kleine Pr?sidentenstra?e 1          fax:   +49-30-24345-555
10178 Berlin Germany                phone: +49-30-24345-0

From ml-it-r-devel at epigenomics.com  Thu Jul  3 18:05:21 2003
From: ml-it-r-devel at epigenomics.com (Matthias Burger)
Date: Thu Jul  3 17:05:24 2003
Subject: [Rd] S4 method and S3 method with same name: potentially dangerous?
Message-ID: <news2mail-3F044631.20909@epigenomics.com>


Dear list,

yet another question on S4 method behaviour or rather its side effects:
Consider the following example (see below) where a new S4 method 'predict' is 
defined which by doing so makes 'predict' a S4 standardGeneric.
It works and simple test examples run but I'm cautious whether this is a 'silly' 
thing to do.

Is this a dangerous thing to do, already known to break existing code, or
cause unwanted side effects on the new S4 method?

Or can I savely make use of existing S3 methods with their clear and descriptive
names and define new S4 methods with the same name?


Thanks in advance for your time and effort!

   Matthias


 > version
          _
platform i686-pc-linux-gnu
arch     i686
os       linux-gnu
system   i686, linux-gnu
status
major    1
minor    7.1
year     2003
month    06
day      16
language R


 > predict
function (object, ...)
UseMethod("predict")
<environment: namespace:base>
 > getMethods("predict")
NULL
 > methods("predict")
  [1] "predict.Arima"             "predict.HoltWinters"
  [3] "predict.StructTS"          "predict.ar"
  [5] "predict.arima0"            "predict.glm"
  [7] "predict.lm"                "predict.loess"
  [9] "predict.mlm"               "predict.nls"
[11] "predict.poly"              "predict.ppr"
[13] "predict.princomp"          "predict.smooth.spline"
[15] "predict.smooth.spline.fit"
 >   setClass("RSVMState",
+            representation (
+                            kernel        = "character",
+                            rho           = "numeric",
+                            supportVector = "matrix",
+                            alpha         = "numeric",
+                            negGroup      = "integer",
+                            posGroup      = "integer"),
+            prototype(kernel        = new("character"),
+                      rho           = new("numeric"),
+                      supportVector = new("matrix"),
+                      alpha         = new("numeric"),
+                      negGroup      = new("integer"),
+                      posGroup      = new("integer"),
+                      name          = new("character"),
+                      description   = new("character")),
+           validity=NULL,
+            sealed=TRUE)
[1] "RSVMState"
 >   setMethod("predict", signature("RSVMState","numeric", "missing"), 
function(object, newdata, ...) { cat("\nobj:\n"); print(object); 
cat("\n\nnewdata;\n");print(newdata);return();})
Creating a new generic function for "predict"
[1] "predict"
 > predict
genericFunction for "predict" defined from package "base"

function (object, ...)
standardGeneric("predict")
<environment: 0x8e942a4>
Methods may be defined for arguments: object

 > getMethods("predict")
object = "ANY":
function (object, ...)
UseMethod("predict")

object = "RSVMState":
function (object, ...)
{
     .local <- function (object, newdata, ...)
     {
         cat("\nobj:\n")
         print(object)
         cat("\n\nnewdata;\n")
         print(newdata)
         return()
     }
     .local(object, ...)
}

 > methods("predict")
  [1] "predict.Arima"             "predict.HoltWinters"
  [3] "predict.StructTS"          "predict.ar"
  [5] "predict.arima0"            "predict.glm"
  [7] "predict.lm"                "predict.loess"
  [9] "predict.mlm"               "predict.nls"
[11] "predict.poly"              "predict.ppr"
[13] "predict.princomp"          "predict.smooth.spline"
[15] "predict.smooth.spline.fit"
 > rsvm <- new("RSVMState")
 > predict(rsvm, 10)

obj:
An object of class "RSVMState"
Slot "kernel":
character(0)

Slot "rho":
numeric(0)

Slot "supportVector":
<0 x 0 matrix>

Slot "alpha":
numeric(0)

Slot "negGroup":
numeric(0)

Slot "posGroup":
numeric(0)



newdata;
[1] 10
NULL




-- 
Matthias Burger

Bioinformatics R&D
Epigenomics AG                      www.epigenomics.com
Kleine Pr?sidentenstra?e 1          fax:   +49-30-24345-555
10178 Berlin Germany                phone: +49-30-24345-0

From ripley at stats.ox.ac.uk  Thu Jul  3 17:31:12 2003
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu Jul  3 17:31:20 2003
Subject: [Rd] S4 method and S3 method with same name: potentially
	dangerous?
In-Reply-To: <news2mail-3F044631.20909@epigenomics.com>
Message-ID: <Pine.LNX.4.44.0307031627180.2167-100000@gannet.stats>

I think you have `method' confused with `generic'.  predict() is an S3
generic, and you can safely allow that to be made into an S4 generic
(although there will be a small performance hit).  I would suggest that
you add S4 methods to show() and not to print(), though.


On Thu, 3 Jul 2003, Matthias Burger wrote:

> yet another question on S4 method behaviour or rather its side effects:
> Consider the following example (see below) where a new S4 method 'predict' is 
> defined which by doing so makes 'predict' a S4 standardGeneric.
> It works and simple test examples run but I'm cautious whether this is a 'silly' 
> thing to do.
> 
> Is this a dangerous thing to do, already known to break existing code, or
> cause unwanted side effects on the new S4 method?
> 
> Or can I savely make use of existing S3 methods with their clear and descriptive
> names and define new S4 methods with the same name?
> 


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From jerome at hivnet.ubc.ca  Fri Jul  4 01:49:05 2003
From: jerome at hivnet.ubc.ca (jerome@hivnet.ubc.ca)
Date: Fri Jul  4 00:49:08 2003
Subject: [Rd] degrees of freedom in nlme() (PR#2384)
Message-ID: <200307032249.h63Mn5JH000115@pubhealth.ku.dk>


I would like to document my findings (with a potential FIX) regarding the 
issue of calculation of the degrees of freedom with nlme().

The program given at the bottom of this email generates and fit 20 data 
sets with a mixed-effects LINEAR model, but using the function nlme() 
instead of lme(). In each case, the correct number of degrees of freedom 
for the intercept parameter is 12. However, in 7 of the 20 sets, round-off 
errors cause the calculated number of degrees of freedom to be 2 instead 
of 12. Moreover, in 3 cases, the algorithm failed to converge (represented 
by NA).

> DF
 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20
 2 NA  2 NA 12 12 12 NA 12 12  2  2 12  2 12 12  2 12  2 12

A potential fix for this issue would be to replace line 7282 of 
R/library/nlme/R/nlme from this expression:
  if (any(notIntX <- apply(X, 2, function(el) any(el != el[1])))) {
to this expression:
  if (any(notIntX <- apply(X, 2, function(el) any(abs(el - 
el[1])>10*sqrt(.Machine$double.eps))))) {

The constant 10*sqrt(.Machine$double.eps) is rather arbitrary and I am not 
sure which value would be best to use. However, this correction allows to 
calculate correct degrees of freedom in the simulations, although it does 
not correct convergence failures, as shown below. I believe those failures 
are happening in the C code, which I haven't deeply examined.

> DF
 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20
12 NA 12 NA 12 12 12 NA 12 12 12 12 12 12 12 12 12 12 12 12

I agree that in principle linear mixed-effects models should be fit with 
lme(), not nlme(). However, nlme() may return the wrong number of degrees 
of freedom without warning and because of that I believe this issue should 
be considered seriously.

Sincerely,
Jerome Asselin

nlme package version: 3.1-43
R version: 1.7.1 running on Red Hat Linux 7.2

###########
library(nlme)

nseeds <- 20
DF <- numeric(nseeds)
for(i in 1:nseeds)
{
set.seed(i)

a <- 2
x <- rep(rnorm(3),rep(5,3))
id <- rep(c("a","b","c"),rep(5,3))
y <- a+x+rnorm(15)
data <- data.frame(y=y,id=id)
initx <- matrix(x[c(1,6,11)],dimnames=list(c("a","b","c"),"x"))

tryerror <- try(fit.nlme <-
              nlme(y ~ a + x, fixed= a~1, random=x~1|id,
              data=data, start=list(fixed=c(a=2),
              random=list(id=initx)),method="ML"))

DF[i] <- ifelse(attr(tryerror,"class")[1]=="try-error",NA,fit.nlme$fixDF$X)
}
names(DF) <- 1:nseeds
DF
###########

-- 

Jerome Asselin (Jérôme), Statistical Analyst
British Columbia Centre for Excellence in HIV/AIDS
St. Paul's Hospital, 608 - 1081 Burrard Street
Vancouver, British Columbia, CANADA V6Z 1Y6
Email: jerome@hivnet.ubc.ca
Phone: 604 806-9112   Fax: 604 806-9044

From mwgrant at adelphia.net  Fri Jul  4 05:04:13 2003
From: mwgrant at adelphia.net (mwgrant@adelphia.net)
Date: Fri Jul  4 04:04:12 2003
Subject: [Rd] bug? exactRankTests install anomaly (PR#3394)
Message-ID: <200307040204.h6424DJH001008@pubhealth.ku.dk>

Full_Name: Michael W. Grant
Version: 1.7.1(2003-06-16)
OS: Windows 98 Second Edition 4.10.2222 A
Submission from: (NULL) (24.55.165.101)


I just installed version 1.7.1 tonight. In the process I installed via CRAN from
the menu several packages. One installation, exactRankTests, had a distinct
anomaly. A DLL attempt to change FPU control word as seem in the last line  of
the following listing:

START LISTING:

> install.packages(choose.files('',filters=Filters[c('zip','All'),]),
.libPaths()[1], CRAN = NULL)
> local({a <- CRAN.packages()
+ install.packages(select.list(a[,1],,TRUE), .libPaths()[1], available=a)})
trying URL `http://cran.r-project.org/bin/windows/contrib/1.7/PACKAGES'
Content type `text/plain; charset=iso-8859-1' length 11106 bytes
opened URL
downloaded 10Kb

trying URL `http://cran.r-project.org/bin/windows/contrib/1.7/exactRankTests_0.8-1.zip'
Content type `application/zip' length 168784 bytes
opened URL
downloaded 164Kb


Delete downloaded files (y/N)? y

updating HTML package descriptions
Warning message: 
DLL attempted to change FPU control word from 8001f to 9001f 
> 
END LISTING


NOTEs
1.) this installation was done immediately after starting Rgui, i.e., Rgui was
launched, "Packages" dropdown clicked, "Install packages from CRAN..." clicked

2.) subsequently several other packages installed without incident.

3.) R was killed, restarted, and the installation done again and the same
DLL/FPU anomaly occurred.

Best regards

From dmurdoch at pair.com  Fri Jul  4 05:45:03 2003
From: dmurdoch at pair.com (dmurdoch@pair.com)
Date: Fri Jul  4 04:45:02 2003
Subject: [Rd] bug? exactRankTests install anomaly (PR#3394)
Message-ID: <200307040245.h642j3JH001186@pubhealth.ku.dk>

On Fri, 4 Jul 2003 04:04:13 +0200 (MET DST), you wrote:

>Full_Name: Michael W. Grant
>Version: 1.7.1(2003-06-16)
>OS: Windows 98 Second Edition 4.10.2222 A
>Submission from: (NULL) (24.55.165.101)
>
>
>I just installed version 1.7.1 tonight. In the process I installed via CRAN from
>the menu several packages. One installation, exactRankTests, had a distinct
>anomaly. A DLL attempt to change FPU control word as seem in the last line  of
>the following listing:

That is not likely a bug in R, it's a bug in some other software on
your system, which has changed the floating point precision.  It's
hard to track down exactly what program did this, and hard to fix.
The general strategy for tracking it down is to find the minimal
operation that does it (e.g. does it depend on which package you
install?  Do you get it from a local install instead of a remote
download + install, etc.)

If you set options(warn.FPU=TRUE) then you'll see the warning more
often; without that option, it is suppressed.  

Duncan Murdoch

From renaud.lancelot at cirad.fr  Fri Jul  4 15:18:08 2003
From: renaud.lancelot at cirad.fr (renaud.lancelot@cirad.fr)
Date: Fri Jul  4 14:18:10 2003
Subject: [Rd] R crashes when installing package from CRAN (PR#3399)
Message-ID: <200307041218.h64CI8JH006911@pubhealth.ku.dk>

Full_Name: Renaud Lancelot
Version: 1.7.1.
OS: MS Windows XP Pro
Submission from: (NULL) (213.154.92.224)


R crashes when installing package from CRAN (from the menu). The bug seems to be
reproducible, at least on my system:

1. Open R
2. Install package from CRAN: install 1 package
3. Back to R: delete file ("y" at the prompt) and wait till package is fully
installed
4. Go back to the menu "Install package from CRAN" then R crashes

Here are 3 reports generated by DrMingw:

########## 1.

Rgui.exe caused an Access Violation at location 005b9067 in module R.dll Reading
from location 14c1eff0.

Registers:
eax=0518a970 ebx=00c09fd0 ecx=00780000 edx=a2010465 esi=04f678f4 edi=052d607c
eip=005b9067 esp=0022de64 ebp=0022de74 iopl=0         nv up ei pl nz na pe nc
cs=001b  ss=0023  ds=0023  es=0023  fs=0038  gs=0000             efl=00000202

Call stack:
005B9067  R.dll:005B9067  fillrect
005B5CB0  R.dll:005B5CB0  clear
005BB289  R.dll:005BB289  gprintf
005BB622  R.dll:005BB622  gprintf
005BB839  R.dll:005BB839  app_win_proc@16
77D37AD7  USER32.dll:77D37AD7  SetWindowPlacement
77D3CCD4  USER32.dll:77D3CCD4  DefRawInputProc
77D145BD  USER32.dll:77D145BD  TranslateMessageEx
77D147D4  USER32.dll:77D147D4  DefWindowProcA
77F65DA3  ntdll.dll:77F65DA3  KiUserCallbackDispatcher
005B602F  R.dll:005B602F  show
00477CD5  R.dll:00477CD5  do_selectlist
00509CB4  R.dll:00509CB4  do_internal
004DA9E8  R.dll:004DA9E8  Rf_eval
004DACD5  R.dll:004DACD5  Rf_applyClosure
004DA7F7  R.dll:004DA7F7  Rf_eval
004DA716  R.dll:004DA716  Rf_eval
004DA65E  R.dll:004DA65E  Rf_eval
004DCBBB  R.dll:004DCBBB  Rf_evalList
004DA910  R.dll:004DA910  Rf_eval
004DCBBB  R.dll:004DCBBB  Rf_evalList
004DA910  R.dll:004DA910  Rf_eval
004DB75C  R.dll:004DB75C  do_if
004DA9E8  R.dll:004DA9E8  Rf_eval
004DC0D2  R.dll:004DC0D2  do_begin
004DA9E8  R.dll:004DA9E8  Rf_eval
004DACD5  R.dll:004DACD5  Rf_applyClosure
004DA7F7  R.dll:004DA7F7  Rf_eval
004DC0D2  R.dll:004DC0D2  do_begin
004DA9E8  R.dll:004DA9E8  Rf_eval
004DD315  R.dll:004DD315  do_eval
00509CB4  R.dll:00509CB4  do_internal
004DA9E8  R.dll:004DA9E8  Rf_eval
004DACD5  R.dll:004DACD5  Rf_applyClosure
004DA7F7  R.dll:004DA7F7  Rf_eval
004DD315  R.dll:004DD315  do_eval
00509CB4  R.dll:00509CB4  do_internal
004DA9E8  R.dll:004DA9E8  Rf_eval
004DACD5  R.dll:004DACD5  Rf_applyClosure
004DA7F7  R.dll:004DA7F7  Rf_eval
004DC0D2  R.dll:004DC0D2  do_begin
004DA9E8  R.dll:004DA9E8  Rf_eval
004DACD5  R.dll:004DACD5  Rf_applyClosure
004DA7F7  R.dll:004DA7F7  Rf_eval
004DACD5  R.dll:004DACD5  Rf_applyClosure
004DA7F7  R.dll:004DA7F7  Rf_eval
004FA06E  R.dll:004FA06E  Rf_ReplIteration
004FA672  R.dll:004FA672  Rf_ReplIteration
004FB176  R.dll:004FB176  run_Rmainloop
00401407  Rgui.exe:00401407
0040134E  Rgui.exe:0040134E
00401523  Rgui.exe:00401523
00401170  Rgui.exe:00401170
00401013  Rgui.exe:00401013
77E614C7  kernel32.dll:77E614C7  GetCurrentDirectoryW


############# 2

Rgui.exe caused an Access Violation at location 005b5845 in module R.dll Writing
to location 0000002a.

Registers:
eax=0000002a ebx=0153a81c ecx=0062f8e0 edx=00000000 esi=0022e028 edi=000e038e
eip=005b5845 esp=0022e008 ebp=0022e010 iopl=0         nv up ei pl nz na pe nc
cs=001b  ss=0023  ds=0023  es=0023  fs=0038  gs=0000             efl=00000202

Call stack:
005B5845  R.dll:005B5845  drawto
005BB289  R.dll:005BB289  gprintf
005BB622  R.dll:005BB622  gprintf
005BB894  R.dll:005BB894  app_doc_proc@16
77D37AD7  USER32.dll:77D37AD7  SetWindowPlacement
77D3CCD4  USER32.dll:77D3CCD4  DefRawInputProc
77D145BD  USER32.dll:77D145BD  TranslateMessageEx
77D147D4  USER32.dll:77D147D4  DefWindowProcA
77F65DA3  ntdll.dll:77F65DA3  KiUserCallbackDispatcher
77D14D58  USER32.dll:77D14D58  DispatchMessageA
00480A83  R.dll:00480A83  R_ProcessEvents
004DAA78  R.dll:004DAA78  Rf_eval
004DC0D2  R.dll:004DC0D2  do_begin
004DA9E8  R.dll:004DA9E8  Rf_eval
004DACD5  R.dll:004DACD5  Rf_applyClosure
004DA7F7  R.dll:004DA7F7  Rf_eval
004DC0D2  R.dll:004DC0D2  do_begin
004DA9E8  R.dll:004DA9E8  Rf_eval
004DA9E8  R.dll:004DA9E8  Rf_eval
004DC0D2  R.dll:004DC0D2  do_begin
004DA9E8  R.dll:004DA9E8  Rf_eval
004DACD5  R.dll:004DACD5  Rf_applyClosure
004DA7F7  R.dll:004DA7F7  Rf_eval
004DC9D5  R.dll:004DC9D5  do_set
004DA9E8  R.dll:004DA9E8  Rf_eval
004DC0D2  R.dll:004DC0D2  do_begin
004DA9E8  R.dll:004DA9E8  Rf_eval
004DD315  R.dll:004DD315  do_eval
00509CB4  R.dll:00509CB4  do_internal
004DA9E8  R.dll:004DA9E8  Rf_eval
004DACD5  R.dll:004DACD5  Rf_applyClosure
004DA7F7  R.dll:004DA7F7  Rf_eval
004DD315  R.dll:004DD315  do_eval
00509CB4  R.dll:00509CB4  do_internal
004DA9E8  R.dll:004DA9E8  Rf_eval
004DACD5  R.dll:004DACD5  Rf_applyClosure
004DA7F7  R.dll:004DA7F7  Rf_eval
004DC0D2  R.dll:004DC0D2  do_begin
004DA9E8  R.dll:004DA9E8  Rf_eval
004DACD5  R.dll:004DACD5  Rf_applyClosure
004DA7F7  R.dll:004DA7F7  Rf_eval
004DACD5  R.dll:004DACD5  Rf_applyClosure
004DA7F7  R.dll:004DA7F7  Rf_eval
004FA06E  R.dll:004FA06E  Rf_ReplIteration
004FA672  R.dll:004FA672  Rf_ReplIteration
004FB176  R.dll:004FB176  run_Rmainloop
00401407  Rgui.exe:00401407
0040134E  Rgui.exe:0040134E
00401523  Rgui.exe:00401523
00401170  Rgui.exe:00401170
00401013  Rgui.exe:00401013
77E614C7  kernel32.dll:77E614C7  GetCurrentDirectoryW


################# 3

Rgui.exe caused an Access Violation at location 005b5845 in module R.dll Writing
to location 000000b5.

Registers:
eax=000000b5 ebx=01b2508c ecx=0062f8e0 edx=00000000 esi=0022e028 edi=000503fa
eip=005b5845 esp=0022e008 ebp=0022e010 iopl=0         nv up ei pl nz na pe nc
cs=001b  ss=0023  ds=0023  es=0023  fs=0038  gs=0000             efl=00000202

Call stack:
005B5845  R.dll:005B5845  drawto
005BB289  R.dll:005BB289  gprintf
005BB622  R.dll:005BB622  gprintf
005BB894  R.dll:005BB894  app_doc_proc@16
77D37AD7  USER32.dll:77D37AD7  SetWindowPlacement
77D3CCD4  USER32.dll:77D3CCD4  DefRawInputProc
77D145BD  USER32.dll:77D145BD  TranslateMessageEx
77D147D4  USER32.dll:77D147D4  DefWindowProcA
77F65DA3  ntdll.dll:77F65DA3  KiUserCallbackDispatcher
77D14D58  USER32.dll:77D14D58  DispatchMessageA
00480A83  R.dll:00480A83  R_ProcessEvents
004DAA78  R.dll:004DAA78  Rf_eval
004DC0D2  R.dll:004DC0D2  do_begin
004DA9E8  R.dll:004DA9E8  Rf_eval
004DACD5  R.dll:004DACD5  Rf_applyClosure
004DA7F7  R.dll:004DA7F7  Rf_eval
004DC0D2  R.dll:004DC0D2  do_begin
004DA9E8  R.dll:004DA9E8  Rf_eval
004DA9E8  R.dll:004DA9E8  Rf_eval
004DC0D2  R.dll:004DC0D2  do_begin
004DA9E8  R.dll:004DA9E8  Rf_eval
004DACD5  R.dll:004DACD5  Rf_applyClosure
004DA7F7  R.dll:004DA7F7  Rf_eval
004DC9D5  R.dll:004DC9D5  do_set
004DA9E8  R.dll:004DA9E8  Rf_eval
004DC0D2  R.dll:004DC0D2  do_begin
004DA9E8  R.dll:004DA9E8  Rf_eval
004DD315  R.dll:004DD315  do_eval
00509CB4  R.dll:00509CB4  do_internal
004DA9E8  R.dll:004DA9E8  Rf_eval
004DACD5  R.dll:004DACD5  Rf_applyClosure
004DA7F7  R.dll:004DA7F7  Rf_eval
004DD315  R.dll:004DD315  do_eval
00509CB4  R.dll:00509CB4  do_internal
004DA9E8  R.dll:004DA9E8  Rf_eval
004DACD5  R.dll:004DACD5  Rf_applyClosure
004DA7F7  R.dll:004DA7F7  Rf_eval
004DC0D2  R.dll:004DC0D2  do_begin
004DA9E8  R.dll:004DA9E8  Rf_eval
004DACD5  R.dll:004DACD5  Rf_applyClosure
004DA7F7  R.dll:004DA7F7  Rf_eval
004DACD5  R.dll:004DACD5  Rf_applyClosure
004DA7F7  R.dll:004DA7F7  Rf_eval
004FA06E  R.dll:004FA06E  Rf_ReplIteration
004FA672  R.dll:004FA672  Rf_ReplIteration
004FB176  R.dll:004FB176  run_Rmainloop
00401407  Rgui.exe:00401407
0040134E  Rgui.exe:0040134E
00401523  Rgui.exe:00401523
00401170  Rgui.exe:00401170
00401013  Rgui.exe:00401013
77E614C7  kernel32.dll:77E614C7  GetCurrentDirectoryW

From dmurdoch at pair.com  Fri Jul  4 09:33:02 2003
From: dmurdoch at pair.com (Duncan Murdoch)
Date: Fri Jul  4 14:32:49 2003
Subject: [Rd] R crashes when installing package from CRAN (PR#3399)
In-Reply-To: <200307041218.h64CI8JH006911@pubhealth.ku.dk>
References: <200307041218.h64CI8JH006911@pubhealth.ku.dk>
Message-ID: <nrsagv04mh7f2701sq2ai3grvvg0hlfvmk@4ax.com>

On Fri, 4 Jul 2003 14:18:08 +0200 (MET DST), you wrote:

>Full_Name: Renaud Lancelot
>Version: 1.7.1.
>OS: MS Windows XP Pro
>Submission from: (NULL) (213.154.92.224)
>
>
>R crashes when installing package from CRAN (from the menu). The bug seems to be
>reproducible, at least on my system:
>
>1. Open R
>2. Install package from CRAN: install 1 package
>3. Back to R: delete file ("y" at the prompt) and wait till package is fully
>installed
>4. Go back to the menu "Install package from CRAN" then R crashes

This isn't reproducible on my system, also running XP Pro.  Can you
reproduce on a different machine?

Duncan Murdoch

From Martin.Schlather at uni-bayreuth.de  Fri Jul  4 16:59:21 2003
From: Martin.Schlather at uni-bayreuth.de (Martin.Schlather@uni-bayreuth.de)
Date: Fri Jul  4 15:59:39 2003
Subject: [Rd] R documentation -- buffer overflow? (PR#3400)
Message-ID: <200307041359.h64DxLJH008141@pubhealth.ku.dk>

This is a multi-part message in MIME format.
--------------090000060304060401040205
Content-Type: text/plain; charset=us-ascii; format=flowed
Content-Transfer-Encoding: 7bit


Hi,

I have attached a larger Rd file that causes an error when
compiled by
     R CMD Rdconv -t txt xswms2d.Rd
(for example). If the size is reduced the error vanishes,
see the lines 230 and 527 in the file.

I could not find an error within my text and so my guess
is that there is some buffer overflow within the compiler.

If it is me who has caused the error please let me know --
and many apologies.

Cheers,
Martin

-- 
Martin Schlather                 email: Martin.Schlather@uni-bayreuth.de
Abteilung Bodenphysik            phone: +49 (0)921 55 2193
Univ. Bayreuth                   Fax  : +49 (0)921 55 2246
D -- 95440 Bayreuth, Germany     http://www.geo.uni-bayreuth.de/~martin/




--------------090000060304060401040205
Content-Type: text/plain;
 name="xswms2d.Rd"
Content-Transfer-Encoding: 7bit
Content-Disposition: inline;
 filename="xswms2d.Rd"

% R CMD Rdconv -t txt xswms2d.Rd
\name{xswms2d}
\alias{xswms2d}
%- Also NEED an '\alias' for EACH other topic documented here.
\title{Modelling of water flux and solute transport}
\description{
  Interactive surface that is used to define a soil profile and
  to give the physical and chemical properties for each horizon.
  It simulates the water flux and solute transport using swms2d by
  J. Simunek,  T. Vogel, and M.Th. van Genuchten.
}
\usage{
xswms2d(h, xlim, ylim, step, picture=NULL,
  %## material and water flux parameters
  water=list(
    %## printing
    TPrint=500, red=4, print=1, mesh=TRUE,
    %## simulation control
    TolTh=0.0001, TolH=0.01, lWat=TRUE, dt=1,
    max.iteration=1000,  max.iter.prec=50000,
    iter.print=100, breakpoint=100,
    %## boundary conditions
    top.bound=2, top.value=0, bottom.bound=1, bottom.value=0,
  ),
  materials=list(
     thr=.02, ths=0.35, tha=0.02, thm=0.35, Alfa=0.041, n=1.964,
     Ks=0.000722, Kk=0.000695, thk=0.2875,
     first=1, second=1, angle=0, 
     Hslope=0, Hseg=-100, POptm=-25, sharpness=1, 
     Bulk.d=1500, Diffus=0, longiDisper=1, transvDisper=0.5,
     Adsorp=0.0004, SinkL1=-0.01, SinkS1=-0.01, SinkL0=0, SinkS0=0,
  ),
  model=list(model="gencauchy", param=c(-0.5, 0.25, 0, 5, 1.5, 5)),
  anisotropy=NULL,
  miller.link=function(rf) exp(sign(rf) * sqrt(abs(rf))),

  %## chemical data
  chemical=list(
     lChem=TRUE, Epsi=1, lUpW=1, lArtD=FALSE, PeCr=10, tPulse=500,
     top.bound=2, top.value=1, bottom.bound=1, bottom.value=0,
     root.uptake=0, intern.source=0,
  ),
  
  %## atmospherical data
  atmosphere=list(
     AtmInf=TRUE, tInit=0, Aqh=-.1687, Bqh=-.02674,
     hCritS=1.e30, GWL0L=ylim[2],
  ),
  atm.periods=1, 
  atm.data=c(
     end=100000000, prec=0, cPrec=0, rSoil=0, rRoot=0, 
     hCritA= 1000000, rGWL=0, GWL=0, crt=0, cht=0, 
  ),

  %## stones
  stone=list(
     %## basics
     value=NA, lambda=0,
     %## location
     no.upper=FALSE, no.lower=TRUE, no.overlap=TRUE,
     %## size 
     main.distr=rnorm, main.mean=14, main.s=0,
     sec.distr=rnorm, sec.mean=diff(ylim)/50, sec.s=diff(ylim)/400,
     phi.distr=rnorm, phi.mean=1, phi.s=0,
  ),

  %## roots
  plant.types=1,
  Kf=function(plant, dist, depth)
     rep(1, max(length(dist), length(depth))),
  beta=function(plant, dist, depth)
     rep(1, max(length(dist), length(depth))),
  root=list(
     plants.lambda=0, plants.mindist=15, mean=100, sd=10,
     %## root growth
     knot.probab=0.1, knot.mindist=6, shoots.3=0.4, shoots.4=0,
     stop.probab=function(knot, dist, m, s) 1 - exp(-m + s * dist),
     stop.m=1, stop.s=1,
     rf.link=function(v, m, s) exp(m + s * v), rf.m=0, rf.s=0,
     %## advanced root growth   
     no.own.root=TRUE, age.bonus=1.2, depth.bonus=5.2,
     side.bonus=5.1, dir.ch=3.71, dir.ch.s=0.5,
     %## water uptake / change of conductivity
     rf.Kf=FALSE, P0=-10, P2H=-200, P2L=-800, P3=-8000, r2H=0.5,
     r2L=0.1, root.condition=3, root.uptake=-150,
     ),
  %## control parameters for swms2d
  MaxIt=20, hTab=c(0.001,200), dtMinMax=c(0.01, 60), DMul=c(1.1, 0.33),
  %## menue, parameter input
  col.rect="red", col.bg="yellow", col.sep="gray", col.left="red",
  col.mid="darkgreen", col.right="darkgreen", col.line="red",
  col.txt="black", col.submenue="darkgreen", col.subord="steelblue",
  col.forbid="gray88", col.bg.forbid="lightyellow", col.flash="blue",
  ## drawing 
  col.hor=c("#000000", "#996600", "#660000",  "#CC9933", "#666600",
            "#CCCC99", "#CCCCCC", "#990000", "#FFCC00", "#FFFFCC"),
  col.draw="green", col.mess="red",
  %## images
  col.rf=paste("#", HEX[1 + rev(l.col) / 16],
                 HEX[1 + rev(l.col) \%\% 16],HEX[1 + rev(l.col) / 24],
	         HEX[1 + rev(l.col) \%\% 16],"00", sep=""),
  col.simu=paste("#0000", HEX[1 + l.col / 16],
                  HEX[1 + l.col \%\% 16], sep=""),
  %## finite element mesh
  col.mesh="blue", col.mesh.pt="green",
  upper.lim.z=1, areas=is.null(h$picture),
  PrintLevel=1, new=TRUE, X11.width=9.5, X11.height=7.5,
  update=FALSE, waterflow=FALSE,

  %## postscript output
  print.par=list(ps="sophy", height=3, titl=TRUE)   
)
}

%- maybe also 'usage' for other objects documented here.
\arguments{
  \item{h}{a list of the output format, see the Details.
    If \code{h} is given the parameters \code{xlim}, ..., \code{root}
    are ignored.
  }
  \item{xlim}{the horizontal extension of the profile, see also
    \code{picture}.  If \code{\diff(xlim)} is not an integer multiple of
    step \code{xlim[2]} is decreased accordingly.}
  \item{ylim}{the vertical extension of the profile, see also
    \code{picture}.  If \code{\diff(ylim)} is not an integer multiple of
    step \code{ylim[2]} is decreased accordingly.}
  \item{step}{the grid length for both directions.  The finite element
    method is essentially based on a quadratic mesh.}
  \item{picture}{array or file name for a digitised profile in tif or jpeg
    format; if array it must have three dimensions, where third
    dimension has 3 or 4 components (RGB or RGBA format).

    If \code{picture} is given then either \code{xlim} or
    \code{ylim} might be missing and is calculated from the other lim
    parameter and the dimension of the picture.
  }
  %
  \item{water}{[swms2d, water] list of the following components
    \itemize{
      \item{\code{TPrint}}{
      [TPrint] modelling time after which the result is printed}
      
      \item{\code{red}}{
      [size reduction] positive integer.
      to increase the simulation spead the
      size of the finite element grid can coarsened}
	
      \item{\code{print}}{
      [printed variable] one of the following
      spatial data sets are plotted:
      the water potential \eqn{H},
      discharge/recharge rates \eqn{Q} for internal sink/sources,
      the water contents \eqn{theta},
      the x-components of the Darcian flux vector vx,
      the z-components of the Darcian flux vector vz,
      or the soulte concentration}
      
      \item{\code{mesh}}{
      [show FE mesh] logical.  If \code{TRUE} the currently
      used finite element mesh in a swms2d simulation
      is shown in the upper left drawing area.}

      \item{\code{TolTh}}{
      [TolTh] maximum desired change of water content
      within one step.}
      
      \item{\code{TolH}}{
      [TolH] maximum desired change of pressure head within
      one step.}
      
      \item{\code{lWat}}{
      [LWat] logical. If \code{TRUE} transient water flow else
      steady state.}
      
      \item{\code{dt}}{
      [dt -- initial time step] initial time increment.}
      
      \item{\code{max.iteration}}{
      [max. iterations] maximum number of
      incremental time steps for coarsed finite element meshes.
      % coarsening by factor one is also possible
      Once \code{max.iteration} is reached, the current time and
      the aimed time is shown.  The user is asked whether it should be
      continued.}
      
      \item{\code{max.iter.prec}}{
      [max. iter. (precise)] same at
      \code{max.iteration} except that the value is used if the main
      menue bottom \code{precise waterflow} is pressed.}
      
      \item{\code{iter.print}}{
      [swms message, loop period] number of
      incremental time steps after which a short message of status is
      given}
      
      \item{\code{breakpoint}}{
      [swms, image, loop period] number of incremental
      time steps after which the current value of the spatial variable
      that is of interest is shown in a two dimensional plot.  If
      \code{breakpoint} is chosen appropriately the user gets the
      impression of seeing a movie.  Note that pictures are presented
      after a certain amount of iteration loops,
      so the length of the simulated time intervals between the
      pictures differ.}
      
      \item{\code{top.bound}}{
      [top] surface boundary condition: 1 (impermeable),
      2 (Dirichlet), 3 (Neumann), 4 (variable H), 5 (variable Q), or
      6 (atmospheric).  See the SWMS2D manual for details.}
      
      \item{\code{top.value}}{
      [top value] the value of the condition if
      appropriate.}
      
      \item{\code{bottom.bound}}{
      [bottom] boundary condition at the bottom:
      1 (free drainage), 2 (deep drainage), 3 (impermeable), 4 (Dirichlet), or
      5 (Neumann).  See the SWMS2D manual for details.}
      
      \item{\code{bottom.value}}{
      [bottom value] the value of the condition if
      appropriate.}
    }
  }
  %
  \item{materials}{[material (phys) / material (chem)];
    \code{thr}...\code{sharpness} are found in the menue for the physical
    properties, \code{Bulk.d}...\code{SinkS0} in the menue for chemical ones. 
    List of the following components
    %% no error occurs if the following \itemize is completely deleted
    %% (up to line 352); see also below, line 527 for an alternative part.
    \itemize{
      \item{\code{thr}}{
      [\eqn{\theta_r}{theta_r}] residual water contents
      \eqn{\theta_r}{theta_r}}
      
      \item{\code{ths}}{
      [\eqn{\theta_s}{theta_s}] staturated water contents
      \eqn{\theta_s}{theta_s}}
    
      \item{\code{tha}}{
      [\eqn{\theta_a}{theta_a}] fictious parameter
      \eqn{\theta_a\le\theta_r}{theta_a<=theta_r}, introduced
      into the van Genuchten model for more flexibility (to allow for
      a non-zero air-entry value), see page 10 of the SMWS2d manual
      for details.}
      
      \item{\code{thm}}{
      [\eqn{\theta_m}{theta_m}]
      \eqn{\theta_m\ge\theta_s}{theta_m>=theta_s}, introduced 
      into the van Genuchten model for more flexibility (to allow for
      a non-zero air-entry value)}
      
      \item{\code{Alfa}}{
      [\eqn{\alpha}{alpha}] factor \eqn{\alpha}{alpha} in
      the van Genuchten model}
      
      \item{\code{n}}{
      [\eqn{n}] exponent \eqn{n} in the van Genuchten model}
      
      \item{\code{Ks}}{
      [\eqn{K_s}] saturated hydraulic conductivity \eqn{K_s}}
      
      \item{\code{Kk}}{
      [\eqn{K_k}] non-saturated hydraulic conductivity
      \eqn{K_k} measured for some \eqn{\theta_k}{theta_k}}
      
      \item{\code{thk}}{
      [\eqn{\theta_k}{theta_k}] see \eqn{K_k}}
      %
      \item{\code{first}}{
      [1st principal comp] anisotropy parameter for the
      conductivity tensor}
      
      \item{\code{second}}{
      [2nd principal comp] anisotropy parameter for the
      conductivity tensor}
	
      \item{\code{angle}}{
      [ange (degrees)]  anisotropy parameter for the
      conductivity tensor}
      %
      \item{\code{Hslope}}{
      [intial H, slope] The initial matrix potential is
      calculated from the
      \code{miller.link}ed and then \code{millerH}-transformed
      Gaussian random field by linear transformation. \code{Hslope}
      and \code{Hseg} give the slope and the segment of that linear
      transformation.}
      
      \code{millerH}{ is here the identity, see also
      \code{\link{create.waterflow}} for \code{millerH}.}
      
      \item{\code{Hseg}}{
      [initial H, segment] see \code{Hslope}}
      
      \item{\code{POptm}}{
      [POptm (root)] highest (negative) matrix potention
      (so close to saturation) for which the water uptake is still
      optimal; see \code{root$P2H} for further information}
      
      \item{\code{sharpness}}{
      [sharpness]
      The values of a simulated subsequent horizon are obtained by a
      linear combination of a conditional simulation and an
      independent simulation.
      \code{sharpness} is the factor for the independent simuation
      and
      \eqn{\sqrt{1-\code{sharpness}^2}}{(1-\code{sharpness}^2)^{1/2}}
      the factor for the conditional simulation.
      The mean of the random field to be simulated
      has been substracted beforehand from the boundary
      conditions.}
      
      \code{sharpness}{is not used for the initial horizon, thus not
      given as a menue point in this case.}
      
      %
      \item{\code{Bulk.d}}{
      [bulk density] bulk density}
      
      \item{\code{Diffus}}{
      [diffusion] ionic diffusion coeffcient in free water}
      
      \item{\code{longiDisper}}{
      [longitud. Dispers.] longitudinal dispersivity}
      
      \item{\code{transvDisper}}{
      [transvers. Dispers.]  transverse dispersivity}
      
      \item{\code{Adsorp}}{
      [Freundlich isoth coeff.] Freundlich
      isotherm coefficient}
      
      \item{\code{SinkL1}}{
      [1st-order const./dissolved] first-order rate
      constant \eqn{\mu_w}{mu_w} for dissolved phase, see page 15 of
      the SWMS2d manuscript}
      
      \item{\code{SinkS1}}{
      [1st-order const./solid] first-order rate constant
      \eqn{\mu_s}{mu_s} for solid phase}
      
      \item{\code{SinkL0}}{
      [0-order const./dissolved] zero-order rate
      constant \eqn{\gamma_w}{gamma_w} for dissolved phase}
      
      \item{SinkS0}{
      [0-order const./solid] zero-order rate constant
      \eqn{\gamma_s}{gamma_s} for solid phase}
    }
  }
  %
 
  \item{model}{
    [structure] the covariance model for the Gaussian random
    fields used for the definition of the Miller similar media.
    See \code{\link[RandomFields]{CovarianceFct}} for details on the
    definiton of the covariance model.
    
    If the mean equals \code{NA} and if it is genuine last horizon,
    the area is interpreted as air.
  }

  
  \item{anisotropy}{
    logical or \code{NULL}. If logical it overrides the
    anisotropy condition given by model.  If \code{model} was
    anisotropic and \code{anisotropic=FALSE}, the first anisotropic
    scale parameter is used as scale for the isotropic model.
    If \code{model} is isotropic, only the representation is changed,
    and the user has the opportunity to change the values to an
    truely anisotropic model.
  }
  
  \item{miller.link}{
    function that transforms of the Gaussian
    random field to a 
    field of non-negative values.  The argument and the value are
    matrices (of the same size).  If \code{NULL} the \code{miller.link}
    is the identity.}

   %
  \item{chemical}{
    [swms2d (chem)] list of the following components
    \itemize{
      \item{\code{lChem}}{ 
      [Solute transport] logical that indicates whether solute transport should
      be modelled}
      
      \item{\code{Epsi}}{
      [scheme] temporal weighing coefficient:
      1 (explicit: weight=0), 2 (Crank-Nicholson: weight=0.5) or
      3 (implicit: weight=1)}
      
      \item{\code{lUpW}}{
      [formulation] 1 (upstream weighing formulation)
      or 2 (Galerkin formulation)}
      
      \item{\code{lArtD}}{
      [added artific. disp] logical.  If \code{TRUE}
      artificial dispersion is added to satisfy the stability
      criterion \code{PeCr}}
      
      \item{\code{PeCr}}{
      [PeCr] Stability criterion (Peclet number * Courant
      number); usually 2, but can be increase to 5 or 10;
      see page 44 of the SWMS2D manuscript.}
      
      \item{\code{tPulse}}{
      [pulse duration] time duration of the
      concentration pulse}
      %
      \item{\code{top.bound}}{
      [top] boundary condition for soil surface:
      1 (impermeable), 2 (Dirichlet), 3 (Neumann), 4 (variable
      Concentration), 5 (variable Q), 6 (atmospheric)}
      
      \item{\code{top.value}}{
      [top value] value of the boundary condition if
      appropriate}
    
      \item{\code{bottom.bound}}{
      [bottom] boundary condition for the bottom:
      1 (free drainage), 2 (deep drainage), 3 (impermeable)}
      
      \item{\code{bottom.value}}{
      [bottom value] value of the boundary condition
      if appropriate}
      
      \item{\code{root.uptake}}{
      [root uptake] -- not used yet}
      
      \item{\code{intern.source}}{
      [internal source]  -- not used yet}
      %
    }
  }
 
 %
 \item{atmosphere}{[atmosphere, control] list of the following components
    \itemize{
      \item{\code{AtmInf}}{
      [use atmospheric data] logical.}
      
      \item{\code{tInit}}{
      [start time of simu.] starting time of the
      simulation.  This information is necessary since the
      \code{atm.data} give the end of an atmospheric period only.
      So for the first period the starting time is missing.}
      
      \item{\code{Aqh}}{
      [\eqn{A_{qh}}] only used if \code{water$bottom.bound}
      equal 2 (deep drainage).  Then the modulus of discharge rate equals
      \code{step}*\eqn{A_{qh}}\eqn{\exp(B_{qh} |h -
	\mbox{GWL0L}|)}{exp(B_qh |h - GWL0L|)} where \eqn{h} is local
      pressure head.}
	
      \item{\code{Bqh}}{
      [\eqn{B_{qh}}] see \code{Aqh}}
      
      \item{\code{hCritS}}{
      [max pressure at surface] maximum allowed pressure
      head at the soil surface}
      
      \item{\code{GWL0L}}{
      [ref. pos of groundwater] Reference position of
      groundwater table (usually the z-coordinate of the soil surface);
      only used if
      \code{water$bottom.bound} equal 2 (deep drainage)}
    }
  }
 \item{atm.periods}{
    (maximum) number of atmospherical periods. Only
    used if \code{atm.data} is a vector.  Otherwise \code{atm.periods}
    is set to the number of rows of \code{atm.data}.}
  \item{atm.data}{
    [atmosphere, data]
    vector of 10 components or matrix of 10 columns.
    The 10 components are
    \itemize{
      \item{\code{end}}{
      [end point] end point of the atmospherical
      period; the value of of \code{end} for the last atmospherical
      period must be greater than the value of \code{TPrint}}
      
      \item{\code{prec}}{
      [precipitation] precipitation [L/T]}
      
      \item{\code{cPrec}}{
      [solute, precipitation] solute concentration
      of rainfall water [\eqn{M/L^3}]}
      
      \item{\code{rSoil}}{
      [potential evaporation]
      potential evaporation rate [L/T]}
      
      \item{\code{rRoot}}{
      [potential transpiration] potential
      transpiration rate [L/T]}
      
      \item{\code{hCritA}}{
      [abs. min. pressure at surface] absolute
      value of the minimum allowed pressure head at the soil surface}
      
      \item{\code{rGWL}}{
      [drainage flux (drain or var. Q)] drainage
      flux or other time-dependent prescribed flux boundary
      condition. For nodes with atmospheric flux condition.}
	
      \item{\code{GWL}}{
      [ground water level] groundwater level or other
      time-dependent prescribed head boundary condition. For nodes
      with atmospheric head condition.  Pressure is then
      \code{GWL}+\code{GWL0L}.}
      
      \item{\code{crt}}{
      [conc. flux (drainage)] time-dependent concentration flux}
      
      \item{\code{cht}}{
      [conc. 'pressure' (drain/var. H)] time-dependent
      concentration of the first-type boundary condition.  See the
      SWMS2D manual for details.}
    }
  }
  %
  \item{stone}{[stones] list of the following components
    %% no error occurs if the following \itemize is completely deleted
    %% (up to line 596); see also above, line 230 
    \itemize{
      \item{\code{value}}{
      [value] numeric or \code{NA}. \code{NA} is used to
      model stones, i.e. water cannot penetrate.
      If not \code{NA},
      the (Gaussian) random field gets, at the place of the 'stone', the value
      \code{value}.  This might be of interest if small lenses are modelled
      by means of 'stones.}
      
      \item{\code{lambda}}{
      [intensity] intensity of the stones}
      
      \item{\code{no.upper}}{
      [!overlap into upper horizons] if \code{TRUE}
      overlap into any the upper horizon is forbidden}
      
      \item{\code{no.lower}}{
      [!overlap into lower horizons] if \code{TRUE}
      overlap into any upper horizon is forbidden}
      
      \item{\code{no.overlap}}{
      [!overlap of stones] if \code{TRUE} the
      overlap of stones is forbidden. This is clear from a practical
      point of view.  However the currently implemented algorithm
      (SSI) for
      non-overlapping stones is slow and it is furthermore not
      guarantied that it will not fail (due to 'bad' random numbers).
      If overlapping is allowed a fast and simple algorithm is
      used (Boolean model).
      See for both, SSI and Boolean model, the references in Stoyan et
      al., for example.}
      
      \item{\code{main.distr}}{
      distribution for the length of the main axis of
      the ellipse}
      
      \item{\code{main.mean}}{
      [main axis, mean] the parameter for the mean of
      the distribution}
      
      \item{\code{main.s}}{
      [main axis, sd] the parameter for the standard
      deviation of the distribution}
      
      \item{\code{sec.distr}}{
      distribution for the length of the second axis of
      the ellipse}
      
      \item{\code{sec.mean}}{
      [second axis, mean] the parameter for the mean of
      the distribution}
      
      \item{\code{sec.s}}{
      [second axis, sd] the parameter for the standard
      deviation of the distribution}
      
      \item{\code{phi.distr}}{
      distribution for the angle between the horizontal
      line and the main axis of the ellipse}
      
      \item{\code{phi.mean}}{
      [second axis, mean] the parameter for the mean of
      the distribution}
      
      \item{\code{phi.s}}{
      [second axis, sd] the parameter for the standard
      deviation of the distribution}
    }
  }
  \item{plant.types}{positive integer.  Number of different type of
    plants that will be generated}
  \item{Kf}{function(plant, distance, depth).
    According to the parameter the (Gaussian) random field get
    a new value if there is a root pixel.
    Here, \code{plant} is the type
    of plant, \code{distance} the distance from the current position
    to the surface along the root, and depth is the depth of the current
    position. 
    Only used if \code{root$rf.Kf} is \code{TRUE} for the specific
    plant type.  This function is still in an experimental stage.}
  \item{beta}{function(plant, distance, depth) gives the raw
    potential root 
    water uptake according to the \code{plant} type, the \code{distance}
    to the beginning of the root and the \code{depth}.  The raw potential
    values are subsequently normed such they sum up to one.  This gives the
    potential root water uptake.}
  \item{root}{[root growth] for \code{plants.lambda} to \code{dir.ch.s}
    and [root, water uptake] otherwise.  Any plant type is set to the
    values of \code{root} at starting time.
    List of the following components
    \itemize{
      \item{\code{plants.lambda}}{
      [mean \# of plants] the number of
      plants is Poisson distributed with mean \code{plants.lambda}}
      
      \item{\code{plants.mindist}}{
      [min. plant. dist.] plants of the
      same species are at least \code{plants.mindist} away.  Actually,
      the algorithm tries to find random positions so that this
      condition is satisfied, but will give up if not successful after
      a few attemps.}
      
      \item{\code{mean}}{
      [aimed mean total length] mean total length of
      all the roots of a single plant.  For a long time run, the
      average will be about the \code{mean}, but the algorithm is not
      too sophisticated to guarantee this.}
      
      \item{\code{sd}}{
      [aimed sd of total length]
      standard deviation for the total length of all the roots of a
      single plant.  There is a check by the algorithm to be
      close to \code{sd}}
      
      \item{\code{knot.probab}}{
      [knot probability] probability of any root
      pixel to be a knot, except if the distance from the position to
      the previous knot is less than \code{knot.mindist}.  Then the
      probability for a knot is 0.}
      
      \item{\code{knot.mindist}}{
      [min. knot diXstance] see \code{knot.probab}}
      
      \item{\code{shoots.3}}{
      [3 shoots probab.] positive number, see
      \code{shoots.4}}
      
      \item{\code{shoots.4}}{
	[4 shoots probab.] positive number.
	\itemize{
	  \item \code{shoots.4}\eqn{\ge}{>=}1
	  
	  knots have always 4 shoots.
	  
	  \item \code{shoots.4}\eqn{<}1
	  and \code{shoots.4}+\code{shoots.3}\eqn{\ge}{>=}1
	  
	  knots have with probability \code{shoots.4} 4 shots and 3
	  shoots otherwise.
	  
	  \item \code{shoots.4}\eqn{<}1
	  and \code{shoots.4}+\code{shoots.3}\eqn{\ge}{<}1
	  
	  knots have 4, 3, 2 shoots with probability \code{shoots.4},
	  \code{shoots.3} and 1-\code{shoots.4}-\code{shoots.3},
	  respectively
	}
      }
      \item{\code{stop.probab}}{
      \code{function(knot, dist, stop.m, stop.s)}
      that returns a values in \eqn{[0,1]}, which is the probability
      that a given root pixel does not continue to grow. 
      The function should be able to take matrices for the first 2
      components.  \code{knot} is the number of knots preceding and
      including the current pixel,
      \code{dist} is the distance to the surface along the root,
      \code{stop.m} and \code{stop.s} are arbitrary
      additional parameters.}
      
      \item{\code{stop.m}}{
      [stop probability, m], see \code{stop.probab}}
      
      \item{\code{stop.s}}{
      [stop probability, s], see \code{stop.probab}}
      
      \item{\code{rf.link}}{
      \code{function(v, rf.m, rf.s)}
      Summand in calculating the priority for all the neighbouring
      pixels of all active root pixels (end points of the roots).
      The pixels with the highest priority will be the next new root parts.
      \code{rf.link} transforms the value of the simulated
      Gaussian random field where \code{rf.m} and \code{rf.s}
      are additional parameters.}
      
      \item{\code{rf.m}}{
      [random field link, m], see \code{rf.link}}
      
      \item{\code{rf.s}}{
      [random field link, s], see \code{rf.link}}
      
      \item{\code{no.own.root}}{
      [own root penetration], if \code{TRUE} a
      pixel may contain at most one root part.}
      
      \item{\code{age.bonus}}{
      [age bonus]
      factor by which the priority number of a pixel is
      multiplied after each step.  The \code{age.bonus}
      is usually greater than or equal to 1.}
      
      \item{\code{depth.bonus}}{
      [depth bonus] summand added to the
      priority if the subsequent pixel is below the current root pixel}
      
      \item{\code{side.bonus}}{
      [side bonus] summand added to the
      priority if the subsequent pixel has the same depth than
      the current root pixel;  see \code{depth.bonus} for deeper
      points.}
      
      \item{\code{dir.ch}}{
      [no direction change]
      The number of pixels in x direction and the number of pixels
      in y direction  by which the new direction of the
      root growth deviates from the previous is added and gives a
      value \eqn{d} between 0 and 4.
      
      E.g., if the sequence of root pixels ghas (1,3), (2,4)
      then the previous direction is (1,1). If the pixel (2,3)
      is considered the new direction is (0, -1), so the modulus of
      deviation is 1 and 2 in x and y direction, respectively. So,
      \eqn{d=1+2=3}.
      
      Let \eqn{v=d \code{dir.ch}}{v = d * \code{dir.ch}}. 
      Then the summand for the priority of a pixel is given by normal random
      variable with mean v and \eqn{sd=|v| \code{dir.ch.s}}.}
      
      \item{\code{dir.ch.s}}{
      [no dir. change, rel. sd] see \code{dir.ch}}
      
      \item{\code{rf.Kf}}{
      [root, water uptake][root changes field value]
      logical.  If \code{TRUE} the value of the (Gaussian) random
      field at a root segment
      is changed according to the function \code{Kf}.}
      
      \item{\code{P0}}{
      [root, water uptake][P0] (negative) pressure
      above which too less 
      oxygene to allow water uptake by plants}
      
      \item{\code{P2H}}{
      [root, water uptake][P2H], \code{P2H}, \code{P2L},
      \code{r2H} and \code{r2L} determine, in dependence of the
      potential transpiration, the lower bound for optimal water
      uptake (piecewise linear curves);
      the upper bound of optimal water uptake
      is given by \code{materials$POptm}.
      See the SWMS2D manual for details.}
      
      \item{\code{P2L}}{
      [root, water uptake][P2L] see \code{P2H}}
      
      \item{\code{r2H}}{
      [root, water uptake][r2H] see \code{P2H}}
      
      \item{\code{r2L}}{
      [root, water uptake][r2L] see \code{P2H}}
      
      \item{\code{P3}}{
      [root, water uptake][P3] (negative) pressure below which
      no water uptake is possible}
      
      \item{\code{root.condition}}{
      [root, water uptake][root water uptake]}
      
      \item{\code{root.uptake}}{
      [root, water uptake][water uptake value]}
    }
  }
  %
  \item{MaxIt}{
    maximum number of iteration during any time step.}
  \item{hTab}{
    \code{c(hTab1, hTabN)}, interval of pressure heads
    within which a table of hydraulic properties is generated.}
  \item{dtMinMax}{
    \code{c(dtmin, dtmax)}, minimum and maximum permitted
    time increment.}
  \item{DMul}{
    \code{c(dMul, dMul2)},
    \eqn{\code{dMul}\ge 1}{\code{dMul >= 1}},
    \eqn{\code{dMul2}\le 1}{\code{dMul2 <= 1}};
    if number of required iterations is less than 4 or greater than 6
    then the next time
    step is multiplied by \code{dMul} and \code{dMul2}, respectively.}
  %
  \item{col.rect}{
    colour of the button for free input; see
    \code{\link[RandomFields]{eval.parameters}}}
  \item{col.bg}{
    colour of a interactive bar; see
    \code{\link[RandomFields]{eval.parameters}}}
  \item{col.sep}{
    colour of the separating line; see
    \code{\link[RandomFields]{eval.parameters}}}
  \item{col.left}{
    colour of preceding element; see
    \code{\link[RandomFields]{eval.parameters}}}
  \item{col.mid}{
    colour for the message; see
    \code{\link[RandomFields]{eval.parameters}}}  
  \item{col.right}{
    colour of subsequent element; see
    \code{\link[RandomFields]{eval.parameters}}}
  \item{col.line}{
    colour of the marking line in interactive bars of
    absolute choice; see \code{\link[RandomFields]{eval.parameters}}}
  \item{col.txt}{
    colour of headers; see
    \code{\link[RandomFields]{eval.parameters}}}
  \item{col.submenue}{
     colour for text of main menue}
  \item{col.subord}{
    colour for text of title of secondary menue}
  \item{col.forbid}{colour for
    text of forbidden main menues, e.g. 'polygon' after
    having defined already the maximum number of allowed horizons}
  \item{col.bg.forbid}{background colour for forbidden menue points}
  \item{col.flash}{
    colour for hints or the titles of active windows}
 
  \item{col.hor}{
    sequence of colours that are used to draw the horizons}
  \item{col.draw}{
    colour for drawing and for showing selected horizons}
  \item{col.mess}{
    colour for warning or error messages}
  \item{col.rf}{
    sequence of colours that are used to show the
    random field} 
  \item{col.simu}{
    seqeuence of colours that are used to present any
    simulation result by swms2d}
  \item{col.mesh}{
    colour for the edges of the finite element mesh}
  \item{col.mesh.pt}{
    colour for the vertices of the finite element mesh}
  %
  \item{update}{
    [updating] logical.  If \code{TRUE} the simulations are
    updated after any changing of the parameters.}
  \item{waterflow}{
    [water flow] logical.  If \code{TRUE} swms2d is run}  
  \item{upper.lim.z}{
    numeric.  The value of \code{zlim[2]} in
    \code{image} equals the \code{upper.lim.z} quantile of
    the random field values when the transformed random field is plotted.}
  \item{areas}{
    logical. If \code{TRUE} the horizons are coloured.  If
    \code{FALSE} only the borders between the horizons are given.}
  \item{PrintLevel}{
    If \eqn{\le}{<=}0 nothing is printed. The higher the
    value the information is given.}
  \item{new}{
    logical or \code{NULL}.  If \code{TRUE} the interactive plot is opened in
    a new window.  If \code{NULL} then the interactive window is not
    opened and the standard definitions are returned.}
  \item{X11.width}{
    numeric.  Height of the window.  Only used if
    \code{new=TRUE}.} 
  \item{X11.height}{n
    umeric.  Height of the window.  Only used if
    \code{new=TRUE}.} 
  %
  \item{print.par}{
    [postscript] list of the following components
    \itemize{
      \item{\code{ps}}{
      [ps base name] character. Base name of the
      postscript file.}
      
      \item{\code{height}}{
      [picture height] numeric. Height of the
      postscript figure in inches.}
    
      \item{\code{title}}{
      [plot title] logical. If \code{TRUE} a
	title is plotted.}
    }
  }
  %
}
\details{
  Menue points of the interactive plot are
  \describe{
    \item{postscript}{plotting
	the water potential \eqn{H},
	discharge/recharge rates \eqn{Q} for internal sink/sources,
	the water contents \eqn{theta},
	the x-components of the Darcian flux vector vx,
	the z-components of the Darcian flux vector vz,
	or
	the concentration;
      in grey it is given whether the
      'precise water flow' or the result of the approximate 'water flow'
      is given (according to the main menu point 'precise waterflow')
      and subsequent update of simulation. 
      Further the random field might be plotted. 
      For the additional parameters, see the input variable \code{print.par}.
    }
    \item{polygon}{Clicking with the left mouse key in the upper left
      drawing area defines the vertices of the polygon.  Up to 512
      vertices are allowed.  The right mouse key terminates the
      drawing.
      A polygon must consist of at least three points.  The points may
      such that the connecting lines cross. 
    }
    \item{horizon}{Clicking with the left mouse key in the upper left
      drawing area defines the border of the horizon.  Up to 512
      vertices are allowed. The right mouse key terminates the drawing. 
      A sequence of chosen points is only accepted to define a horizon
      if the first point has a smaller x-coordinate than all the other
      points 
      and the last point has a greater x-coordinate than all the other
      points;
      except for this restriction and the fact that at least 2 points
      must be given, any sequence of points is allowed, points may even
      leave the plotting area. 
      If the first or the last point is within the area then the horizon
      boundary is linearly extrapolated by a line through the first and
      second or the two last points, respectively.
      The new horizon gets as default parameters for the stones the
      input stone parameters, and for the material the material
      parameters of the preceding horizon.
    }
    \item{structure}{Definition of the random fields that underly the
      Miller similar medium. If more than one horizons or at least one
      polygon is defined the user selects first the part the user likes
      to define by clicking into the appropriate part of the drawing
      area.
      Afterwards a new menue is opened in the upper right part of the window.
      Within this new menue we have, see 
      \code{\link[RandomFields]{ShowModels}} for details,
      
      \describe{
	\item{bottom left}{a simulation of the Gaussian random field
	  with the specified parameters.}
	\item{top left}{the covariance function or the variogram for
	  the random field and the the transformed random field according
	  to \code{miller.link}.  If the \code{model} is anisotrope or
	  \code{anisotrop=TRUE} is given explicitely, the models are shown
	  for the two main axis.
	}
	\item{right}{from top to bottom: 'simulate' is 'updating' in the
	  main menue is \code{FALSE}, the name of the model, the formula,
	  the specific parameters if there are any, variance, nugget
	  effect, the scale parameter or the anisotropy paramters, and the
	  mean.
	  If 'practical range'=\code{TRUE} then the (isotropic) covariance
	  model is
	  rescaled such that at distance 1 the value of the model is
	  approximately 0.05. Finally, 'variogram' switches between the
	  presentation of the variogram and the corresponding covariance
	  function. 
	}
      }
     
      This menue is left by the right mouse bottom and then a menue for
      choosing a variogram model is reached. Right mouse bottom again
      leaves the whole menue for 'structure'.
      
      The first horizon gets as default the model and the
      parameter values passed to \code{xswms2d} by \code{model} and
      \code{anisotropy}.
      For the following horizons the values of the previously considered
      horizon are taken over, when considered first.
    }
    \item{stones}{definition of the stones}
    \item{root growth}{definition of the root growth; if \code{plant.types} is
      greater than 1, the user first chooses among the different types,
      then enters
      the submenue. 'plant type' is used to name a species, and
      is used nowhere else. The decription of all the other variables
      ('mean \# of plants',...,'no dir. change, rel. sd') is given for
      the input variable \code{root}.
    }
    \item{material[phys]}{Definition of the physical material constants,
      see variable \code{materials}.}
    \item{material[chem]}{Definition of the chemical material constants,
      see variable \code{materials}.}
    \item{root water uptake}{
      Definition of the water uptake by the roots.  See the variable
      \code{root}.}
    \item{atmosphere, data}{
      See the variable \code{atm.data} for a description.
      If \code{nrow(atm.data)} or \code{atm.periods} is greater than 1
      then the user chooses the atmospherical period first. 
    }
    \item{swms2d [water]}{see the variable \code{water} for a description}
     \item{swms2d [chem]}{see the variable \code{chemical} for a description}
    \item{atmosphere control}{see the variable \code{atmosphere}
      for a description}
   \item{new simulation}{If parameters are changed, simulations are
      redone reusing previous parts as much as possible.  That is, if a
     parameter of SWMS2D is changed the simulation of the Gaussian
      random field is reused.  Further the redone simulations are based
      on the old random seeds.
 
      Here, a simulation is redone from scratch, based on a new random seed.
    }
    \item{precise waterflow}{By 'swms2d water',
      submenue 'size reduction' (variable \code{water$red}) the finite
      element mesh can be coarsened for faster simulations.  If the
      coarsening is genuine, i.e. \code{water$red}\eqn{>}1, then this
      menue point is active. If pressed, a simulation is performed on
      the original finite element mesh.}
    \item{water flow}{yes/no.  If 'no', only the Gaussian random field,
      the stones and the roots are simulated.}
    \item{updating}{yes/no.  If yes the simulation is redone after any
      changing of any parameter, except for 'structure' definition,
      where the new simulation is performed when the submenue
      'structure' is left.}
    \item{end}{terminates the interactive surface}
  }
 
  General information
  \itemize{
    \item Currently, the number of horizons is limited to max.horizon=10.
    \item The horizons are build up from the bottom, i.e. first, the
    boundary for C horizon should be drawn then those for the B
    horizons, etc.
    \item If the mean of the last genuine(!)
    horizon is defined \code{NA} within the menue
    'structure', then this part of the profile is interpreted as air and
    the previously defined horizons are genuine ones.
    Any other horizon but the last one should not have mean
    \code{NA}.
    \item Polygons are used to define large lenses or to circumvent the
    the predefined ordering of horizons.
    \item The ordering (as the sequence in which the horizons and
    polygons are defined, not their position in the profile)
    of the horizons and polygons is used in the conditional simulation
    of the Gaussian random fields, where conditioning happens with
    respect to preceding horizons.
    \item First the Gaussian random field is simulated, starting with
    the first horizon.  After simulation of the complete profile, the
    stones are simulated, then the roots.  If 'water flow 'yes'
    then the SWMS2D simulation is performed.  See
    \code{\link{simulate.horizons}}
    and the references therein for further details on the stochastic
    simulation.  See the SWMS2D manuscript for details on SWMS2D.
    \item If a parameter was changed, usually only a part of the
    simulations is redone, namely that level of simulation that
    corresponds to the parameter (random field for a specific horizon,
    stones, roots, SWMS2D) and all subsequent levels.
    For example, if a stone parameter has been changed, the simulation of
    the stones and the roots is done, and SWMS2D is performed. 
  }
}
\note{In phrases in brackets in the argument section of this documents
  give the respective menue points of the interactive plot.}
\value{
  A list, where
  the first 10 components contain the definition of the
  horizons; these 10 components
  are called by their position in the list.  Any other list component
  does not have a predefined location and may be called only by name.

  \item{1:10}{
    Each of the first 10 components is a list of the following
    elements: 
    \itemize{
      \item{\code{type}}{
      character. Either 'Start', 'H', or 'P'.  Exactly the
      first element has the value 'Start', all the others may be horizons
      ('H') or polygons ('P').}
      
      \item{\code{cut.x},\code{cut.y}}{
      \code{cut.x} and \code{cut.y} define the horziontal and
      vertical position of a rectangle, respective, which encloses the
      whole horizon or polygon.  \code{cut.x} and \code{cut.y} should be
      as tight as possible, to accelerate the simulation of the random
      fields for the horizons.}
            
      \item{\code{stone}}{
      list of stone parameters, see the input variable
      \code{stone}.  The input parameters are the default parameters for
      all stone specifications}
      
      \item{\code{materials}}{
      list of material constants, see the input variable
      \code{materials}.  The default parameters for the first horizon
      are the input parameters;  the default parameters for any other
      horizon (or polygon)
      are the parameters of the preceding horizon (or polygon)}
    
      \item{\code{model}}{
      list or \code{NULL}. Covariance model in list format, see
      \code{\link[RandomFields]{CovarianceFct}}.
      The \code{model} is \code{NULL} if 'structure' of the main menue
      has not been called yet for the respective horizon. The 'Start'
      horizon gets the value of the input parameter at starting time.
      If 'undo' is called when only the 'Start' horizon exists then
      \code{model} is set to \code{NULL} for the 'Start' horizon.}
      
      \item{\code{border}}{
      matrix of two columns or \code{NULL}.
      boundary points between two horizons (or polygons); used for the
      conditional simulation of the Gaussian random fields.
      Further, if for the selection of a horizon the user clicks on such
      a boundary points, the user is warned.
      \code{border} is \code{NULL} if only the 'Start' horizon exists.}
      
      \item{\code{idx}}{
      matrix of logical values with \code{diff(cut.x)+1} rows
      and \code{diff(cut.y)+1} columns.  \code{idx} indicates which
      pixels of the \code{cut.x}\eqn{\times}{x}\code{cut.y} area belongs
      to the present horizon.}
    }
  }
  
  \item{grid.x}{\code{seq(xlim[1], xlim[2], step)}}
  \item{grid.y}{\code{seq(ylim[1], xlim[2], step)}}
  \item{idx.rf}{integer. Matrix of size
    \code{length(grid.x)}\eqn{\times}{x}\code{length(grid.y)}
    indication the affiliation to a horizon or polygon (number is
    decremented by 1, i.e., \eqn{0,...,\code{h$n}-1}), see also
    the output variable \code{border} within the specific horizons.
    
    It allows also for the indication of the presence of a stone; then,
    if a stone is present, the horizon number is
    incremented by max.horizon=10.
    The modulus by max.horizon gives the by 1 decremented
    number of the horizon.    
  }
  \item{n}{current number of horizons}
  \item{step}{input parameter \code{step}}
  \item{beta}{input parameter \code{beta}}
  \item{root}{list, where \code{length($root)} equals the
    input parameter \code{plant.types}.
    Each component of the list is a list with the same components as
    the input parameter \code{root}. Additionally, it has the
    component \code{plant.type} a user defined name of the species.
  }
  \item{atmophere}{input parameter \code{atmosphere}}
  \item{atm.data}{matrix of 10 columns, corresponds to the input
    parameter \code{atm.data} and \code{atm.periods}.}
  \item{water}{input parameter \code{water}}
  \item{chem}{input parameter \code{chemical}}
  \item{Kf}{input parameter \code{Kf}}
  \item{RF}{matrix of size
    \code{length(grid.x)}\eqn{\times}{x}\code{length(grid.y)} or \code{NULL}.
    \code{RF} contains the Gaussian random field resulting from all
    definitions for the horizons.
    \code{RF} is \code{NULL} if
    \code{simulate.horizon} has not been called yet.
  }
  \item{rf}{matrix of size
    \code{length(grid.x)}\eqn{\times}{x}\code{length(grid.y)} or
    \code{NULL}. 
    The value of \code{rf} is the Gaussian random field modified by the
    stones and the roots (concerning hydraulic conductivity).
    Stones have usually value \code{NA}, whereas air has value
    \code{NaN}.  Further, if \code{root$rf.Kf} is \code{TRUE}
    the values at the respecitve root segments are given by
    \code{h$KF}.

    \code{rf} is \code{NULL} if
    \code{simulate.horizon} has not been called yet or terminated
    with an error. Further \code{rf} is set to \code{NULL} if
    \code{materials$sharpness} has been changed, or 'structure',
    'undo', 'horizon', or 'polygon' has
    been called.}
  \item{m.link}{link function used in the submenue 'structure',
    currently the function is identical to \code{miller.link}}
  \item{miller.link}{input parameter \code{miller.link}}
  \item{random.seed}{list or \code{NULL}.
    Each element contains the random seed for
    simulation of the Gaussian random field in the respective horizon.
    \code{random.seed} is \code{NULL} if
    \code{\link{simulate.horizons}}
    has not been called yet.
  }
  \item{stone.random.seed}{The random seed for the simulation of the stones}
  \item{root.random.seed}{The random seed for the simulaton of the roots}
  \item{rf.complete}{logical. \code{TRUE} if the stochastic simulation
    has been performed completely.}
  \item{stones.ok}{\code{TRUE} or \code{NULL}.  \code{TRUE} if the
    simulation of the stones is up to date.} 
  \item{plants}{list or \code{NULL}.
    Each component contains the information on the roots of
    a single plant.  Each component is a matrix of 8 columns and rows
    according to the number of pixels that contain a part of the
    roots.
    The 8 columns are
    \enumerate{
      \item horizontal coordinate of a root segment.
      The coordinate is given in pixels. 
      \item vertical coordinate of a root segment,
      For the first pixel it is 1 plus the vertical position of the first
      pixel that is not air at the drawn horizontal pixel.
      \item index for the parent root pixel
      \item index where the subsequent root pixel is found; \code{NA} if
      it is a terminating root segment. If the pixel is a knot with k
      children then the value gives the position of the first child, the others
      follow immediately.
      \item number of children in case it is a knot, 1 otherwise
      \item the number of preceding knots until and including this position
      \item aimed random total length of the roots if it is the first
      pixel, and the current distance to the surface along the roots,
      otherwise.
      \item distance to the preceding knot
    }
    \code{plants} is \code{NULL} is \code{\link{simulate.horizons}}
    has not been called yet, or any parameter in \code{root}
    has been changed.
  }
  \item{plants.idx}{vector or \code{NULL}.  \code{plant.idx[i]} gives the
    plant type (\eqn{1,\ldots,\code{}}{1,...,\code{plant.types}})
    of the \code{i}th simulated plant.
    \code{plants.idx} is \code{NULL} if
    \code{\link{create.roots}} or \code{\link{simulate.horizons}}
    has not been called yet.}
  \item{water.x}{the coordinates of \code{grid.x} after thinning by
    factor \code{water$red}}
  \item{water.y}{the coordinates of \code{grid.y} after thinning by
    factor \code{water$red}}
  \item{flux}{logical vector of
    \code{length(water.x)}\eqn{\times}{x}\code{length(water.y)} elements. 
    \code{flux} indicates which pixels of the
    \code{length(water.x)}\eqn{\times}{x}\code{length(water.y)}
    grid are used in the SWMS2D simulation.  (Pixel are left out
    if they indicate stones (\code{NA}) or air (\code{NaN}).)
  }
  \item{swms2d}{three dimensional array or \code{NULL}. 
    The first dimension has 6 components which are
    \enumerate{
      \item the water potential \eqn{H}
      \item discharge/recharge rates \eqn{Q} for internal sink/sources
      \item the water contents \eqn{theta}
      \item the x-components of the Darcian flux vector vx
      \item the z-components of the Darcian flux vector vz
      \item the concentration
    }
    The second component corresponds to the sequence of pixels
    used in the SWMS2D simulation and has length \code{sum(flux)}.
    
    \code{swms2s} is \code{NULL} if
    water flux has not been simulated yet
    because no simulation has been performed or one of the stochatic
    simulations (Gaussian random field, stones, roots) failed,
    or 'water flow' has been
    set to 'no'. Further \code{swms2d} is set to \code{NULL}
    if an error occures when trying to plot
    the SWMS2D simulation results (by \code{\link{plotWater}}); this
    happens if the result has no finite values.
    Finally, \code{swms2d} is set to \code{NULL} if one relevant
    parameters are changed, such as those in
    \code{atmosphere}, \code{atm.data}, \code{materials}, \code{chem}
    or \code{water}.
  }
  
  Any of the lists that contain input parameters may have as additional
  component \code{.last.par}, an internal variable used the menue programme.
}
\section{Warning}{The user should consider the following parameters
  of \code{h[[i]]} as being read-only:
  \itemize{
    \item \code{cut.x}
    \item \code{cut.y}
    \item \code{border}
    \item \code{idx}
  }
}
\author{Martin Schlather, \email{Martin.Schlather@uni-bayreuth.de}
  \url{http://www.geo.uni-bayreuth.de/~martin}}
\references{
  \itemize{
   \item
    Simunek., J., Vogel, T., and van Genuchten, M.Th. (1994)
    \emph{The SWMS2D code for simulating water flow and solute transport
      in two-dimensional variably saturated media, Version 1.21.}
    Research Report No. 132, 197 p.,
    U.S. Salinity Laboratory, USDA, ARS, Riverside, California.

    \item Stoyan, D., Kendall, W.S., Mecke, J. (1995)
    \emph{Stochastic Geometry and its Applications} Chichester: Wiley, 2nd
    edition.

    \item  Schlather, M., Huwe, B. (2003)
    SOPHY -- an interactive programme for water flow modelling.
    \emph{In preparation}
  }
}
\seealso{\code{\link{calculate.horizons}},
  \code{\link{create.roots}},
  \code{\link{create.stones}},
  \code{\link{create.waterflow}}, 
  \code{\link{draw.horizons}},
  \code{\link{modify.horizons}},
  \code{\link{plotRF}},
  \code{\link{plotWater}},
  \code{\link{simulate.horizons}},
  \code{\link{SoPhy}}, 
  \code{\link{swms2d}}
}

\examples{
%  library(SoilPhysics, lib="~/TMP"); library(RandomFields)
% source("/home/schlather/article/R/SOPHY/SoilPhysics/R/simu.R")
% source("/home/schlather/article/R/SOPHY/SoilPhysics/R/Sophy.R")
xswms2d(xlim=c(1, 100), ylim=c(1, 100), step=1) 
}
\keyword{spatial}

--------------090000060304060401040205--

From maechler at stat.math.ethz.ch  Fri Jul  4 19:04:07 2003
From: maechler at stat.math.ethz.ch (maechler@stat.math.ethz.ch)
Date: Fri Jul  4 18:04:07 2003
Subject: [Rd] R documentation -- buffer overflow? (PR#3400)
Message-ID: <200307041604.h64G47JH008938@pubhealth.ku.dk>


>>>>> "Martin" == Martin Schlather <Martin.Schlather@uni-bayreuth.de>
>>>>>     on Fri, 4 Jul 2003 15:59:21 +0200 (MET DST) writes:


    Martin> I have attached a larger Rd file that causes an error when

Unfortunately, attachments are always "mangled" when going
through R-bugs;  we strongly recommend to put that file on the
Net, and only send an URL to it.

    Martin> compiled by
    Martin> R CMD Rdconv -t txt xswms2d.Rd

    Martin> (for example). If the size is reduced the error vanishes,
    Martin> see the lines 230 and 527 in the file.

    Martin> I could not find an error within my text
I know how smart you are, but still, just because you didn't
find it, does not really prove ....  ;-)
see below

    Martin>  and so my guess is that there is some buffer
    Martin> overflow within the compiler.

I don't think so.  When I use cut and paste to recreate your
file,
and do (in a {t}csh; (ba|k)?sh needs another syntax)

     R CMD Rdconv --debug -t txt xswms2d.Rd >& xswms2d.txt

The resulting file becomes
----------------------------------------------------------
-- read file 'xswms2d.Rd';

-- mark_brackets:............................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................!
 .............................

******* Syntax error: mismatched or missing brackets in
/-----

\name{xswms2d}
\alias{xswms2d}
\title{Modelling of water flux and solute transport}

<..........>
<..........>

--------------------------------------------------------------

and is even a bit larger than the original.
I can hardly believe that
  ``Syntax error: mismatched or missing brackets in ...''
is caused by a (perl) buffer overflow.

Best regards to Bayreuth, in any case
 
Martin Maechler <maechler@stat.math.ethz.ch>	http://stat.ethz.ch/~maechler/
Seminar fuer Statistik, ETH-Zentrum  LEO C16	Leonhardstr. 27
ETH (Federal Inst. Technology)	8092 Zurich	SWITZERLAND
phone: x-41-1-632-3408		fax: ...-1228			<><

From edd at debian.org  Fri Jul  4 12:58:47 2003
From: edd at debian.org (Dirk Eddelbuettel)
Date: Fri Jul  4 18:58:59 2003
Subject: [Rd] R documentation -- buffer overflow? (PR#3400)
In-Reply-To: <200307041604.h64G47JH008938@pubhealth.ku.dk>
References: <200307041604.h64G47JH008938@pubhealth.ku.dk>
Message-ID: <20030704165847.GA10893@sonny.eddelbuettel.com>

On Fri, Jul 04, 2003 at 06:04:07PM +0200, maechler@stat.math.ethz.ch wrote:
> I don't think so.  When I use cut and paste to recreate your
> file,
> and do (in a {t}csh; (ba|k)?sh needs another syntax)
> 
>      R CMD Rdconv --debug -t txt xswms2d.Rd >& xswms2d.txt
> 
> The resulting file becomes
> ----------------------------------------------------------
> -- read file 'xswms2d.Rd';
> 
> -- mark_brackets:............................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................!
>  .............................
> 
> ******* Syntax error: mismatched or missing brackets in
> /-----
> 
> \name{xswms2d}
> \alias{xswms2d}
> \title{Modelling of water flux and solute transport}
> 
> <..........>
> <..........>
> 
> --------------------------------------------------------------
> 
> and is even a bit larger than the original.
> I can hardly believe that
>   ``Syntax error: mismatched or missing brackets in ...''
> is caused by a (perl) buffer overflow.

I played with it to, and found that commenting out a single line was enough
to trigger the fault.  And that line had no issues with brackets.

Something fishy happening here ...

Dirk

-- 
Don't drink and derive. Alcohol and analysis don't mix.

From renaud.lancelot at cirad.fr  Fri Jul  4 18:43:34 2003
From: renaud.lancelot at cirad.fr (Renaud Lancelot)
Date: Fri Jul  4 19:43:36 2003
Subject: [Rd] R crashes when installing package from CRAN (PR#3399)
In-Reply-To: <nrsagv04mh7f2701sq2ai3grvvg0hlfvmk@4ax.com>
References: <200307041218.h64CI8JH006911@pubhealth.ku.dk>
	<nrsagv04mh7f2701sq2ai3grvvg0hlfvmk@4ax.com>
Message-ID: <3F05BCC6.6080105@cirad.fr>

Duncan Murdoch wrote:
> On Fri, 4 Jul 2003 14:18:08 +0200 (MET DST), you wrote:
> 
> 
>>Full_Name: Renaud Lancelot
>>Version: 1.7.1.
>>OS: MS Windows XP Pro
>>Submission from: (NULL) (213.154.92.224)
>>
>>
>>R crashes when installing package from CRAN (from the menu). The bug seems to be
>>reproducible, at least on my system:
>>
>>1. Open R
>>2. Install package from CRAN: install 1 package
>>3. Back to R: delete file ("y" at the prompt) and wait till package is fully
>>installed
>>4. Go back to the menu "Install package from CRAN" then R crashes
> 
> 
> This isn't reproducible on my system, also running XP Pro.  Can you
> reproduce on a different machine?
> 
> Duncan Murdoch
> 

I just reproduced it on a system where Win XP Pro was just installed 
(from scrash) and where I installed R for the purpose of testing the 
error. I did not install DrMingw yet and cannot give more precision. I 
am connected to the Interned with an ADSL modem.

Best,

Renaud

-- 
Dr Renaud Lancelot, v?t?rinaire
CIRAD, D?partement Elevage et M?decine V?t?rinaire (CIRAD-Emvt)
Programme Productions Animales
http://www.cirad.fr/fr/pg_recherche/page.php?id=14

ISRA-LNERV                      tel    (221) 832 49 02
BP 2057 Dakar-Hann              fax    (221) 821 18 79 (CIRAD)
Senegal                         e-mail renaud.lancelot@cirad.fr

From Martin.Schlather at uni-bayreuth.de  Fri Jul  4 20:45:11 2003
From: Martin.Schlather at uni-bayreuth.de (Martin.Schlather@uni-bayreuth.de)
Date: Fri Jul  4 19:45:19 2003
Subject: [Rd] (PR#3400)
Message-ID: <200307041745.h64HjBJH009366@pubhealth.ku.dk>


Martin Maechler asked me to restate my problem.

Compiling the file (slightly modified w.r.t. the formerly
attached file) that can be found at
     http://www.geo.uni-bayreuth.de/~martin/filetransfer/xswms2d.Rd
terminates with the error message

******* Syntax error: mismatched or missing brackets in
/-----
  .....
\-----

when compiled by
    R CMD Rdconv -t txt xswms2d.Rd

However, the file does not cause any error after deleting the
line
      \item{a}{4}
(line 530), for example. This line is within the simple
environment
     \itemize{
       \item{a}{1} % if this line or
       \item{a}{2} % this line or
       \item{a}{3} % this line or
       \item{a}{4} % this line is deleted no error occurs
     }

Although there might be an error in my Rd code, the
appearance (or not appearance) of the error message is
surprising, and the reason for the error is not clear
from the message.
        _
platform i686-pc-linux-gnu
arch     i686
os       linux-gnu
system   i686, linux-gnu
status
major    1
minor    7.0
year     2003
month    04
day      16
language R


Cheers,
Martin


Martin Maechler wrote:

>>>>>>"Martin" == Martin Schlather <Martin.Schlather@uni-bayreuth.de>
>>>>>>    on Fri, 4 Jul 2003 15:59:21 +0200 (MET DST) writes:
>>>>>>
> 
> 
>     Martin> I have attached a larger Rd file that causes an error when
> 
> Unfortunately, attachments are always "mangled" when going
> through R-bugs;  we strongly recommend to put that file on the
> Net, and only send an URL to it.
> 
>     Martin> compiled by
>     Martin> R CMD Rdconv -t txt xswms2d.Rd
> 
>     Martin> (for example). If the size is reduced the error vanishes,
>     Martin> see the lines 230 and 527 in the file.
> 
>     Martin> I could not find an error within my text
> I know how smart you are, but still, just because you didn't
> find it, does not really prove ....  ;-)
> see below
> 
>     Martin>  and so my guess is that there is some buffer
>     Martin> overflow within the compiler.
> 
> I don't think so.  When I use cut and paste to recreate your
> file,
> and do (in a {t}csh; (ba|k)?sh needs another syntax)
> 
>      R CMD Rdconv --debug -t txt xswms2d.Rd >& xswms2d.txt
> 
> The resulting file becomes
> ----------------------------------------------------------
> -- read file 'xswms2d.Rd';
> 
> -- mark_brackets:...........................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................
..............................
> 
> ******* Syntax error: mismatched or missing brackets in
> /-----
> 
> \name{xswms2d}
> \alias{xswms2d}
> \title{Modelling of water flux and solute transport}
> 
> <..........>
> <..........>
> 
> --------------------------------------------------------------
> 
> and is even a bit larger than the original.
> I can hardly believe that
>   ``Syntax error: mismatched or missing brackets in ...''
> is caused by a (perl) buffer overflow.
> 
> Best regards to Bayreuth, in any case
>  
> Martin Maechler <maechler@stat.math.ethz.ch>	http://stat.ethz.ch/~maechler/
> Seminar fuer Statistik, ETH-Zentrum  LEO C16	Leonhardstr. 27
> ETH (Federal Inst. Technology)	8092 Zurich	SWITZERLAND
> phone: x-41-1-632-3408		fax: ...-1228			<><
> 



-- 
Martin Schlather                 email: Martin.Schlather@uni-bayreuth.de
Abteilung Bodenphysik            phone: +49 (0)921 55 2193
Univ. Bayreuth                   Fax  : +49 (0)921 55 2246
D -- 95440 Bayreuth, Germany     http://www.geo.uni-bayreuth.de/~martin/

From ripley at stats.ox.ac.uk  Fri Jul  4 20:00:52 2003
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri Jul  4 20:01:00 2003
Subject: [Rd] R crashes when installing package from CRAN (PR#3399)
In-Reply-To: <3F05BCC6.6080105@cirad.fr>
Message-ID: <Pine.LNX.4.44.0307041900330.15382-100000@gannet.stats>

It is not reproducible on either on my XP systems, either.

On Fri, 4 Jul 2003, Renaud Lancelot wrote:

> Duncan Murdoch wrote:
> > On Fri, 4 Jul 2003 14:18:08 +0200 (MET DST), you wrote:
> > 
> > 
> >>Full_Name: Renaud Lancelot
> >>Version: 1.7.1.
> >>OS: MS Windows XP Pro
> >>Submission from: (NULL) (213.154.92.224)
> >>
> >>
> >>R crashes when installing package from CRAN (from the menu). The bug seems to be
> >>reproducible, at least on my system:
> >>
> >>1. Open R
> >>2. Install package from CRAN: install 1 package
> >>3. Back to R: delete file ("y" at the prompt) and wait till package is fully
> >>installed
> >>4. Go back to the menu "Install package from CRAN" then R crashes
> > 
> > 
> > This isn't reproducible on my system, also running XP Pro.  Can you
> > reproduce on a different machine?
> > 
> > Duncan Murdoch
> > 
> 
> I just reproduced it on a system where Win XP Pro was just installed 
> (from scrash) and where I installed R for the purpose of testing the 
> error. I did not install DrMingw yet and cannot give more precision. I 
> am connected to the Interned with an ADSL modem.
> 
> Best,
> 
> Renaud
> 
> 

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From ripley at stats.ox.ac.uk  Fri Jul  4 20:06:42 2003
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri Jul  4 20:06:45 2003
Subject: [Rd] (PR#3400)
In-Reply-To: <200307041745.h64HjBJH009366@pubhealth.ku.dk>
Message-ID: <Pine.LNX.4.44.0307041901220.15382-100000@gannet.stats>

On Fri, 4 Jul 2003 Martin.Schlather@uni-bayreuth.de wrote:

> 
> Martin Maechler asked me to restate my problem.
> 
> Compiling the file (slightly modified w.r.t. the formerly
> attached file) that can be found at
>      http://www.geo.uni-bayreuth.de/~martin/filetransfer/xswms2d.Rd
> terminates with the error message
> 
> ******* Syntax error: mismatched or missing brackets in
> /-----
>   .....
> \-----
> 
> when compiled by
>     R CMD Rdconv -t txt xswms2d.Rd
> 
> However, the file does not cause any error after deleting the
> line
>       \item{a}{4}
> (line 530), for example. This line is within the simple
> environment
>      \itemize{
>        \item{a}{1} % if this line or
>        \item{a}{2} % this line or
>        \item{a}{3} % this line or
>        \item{a}{4} % this line is deleted no error occurs
>      }
> 
> Although there might be an error in my Rd code, the

There was, BTW: you had code inside an \itemize that was in no \item.

> appearance (or not appearance) of the error message is
> surprising, and the reason for the error is not clear
> from the message.

It does look like a bug, although as the FAQ asks, please don't report
diagnoses, especially in the subject line.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From postmaster at sareen.com  Fri Jul  4 20:13:53 2003
From: postmaster at sareen.com (Postmaster)
Date: Sat Jul  5 01:40:14 2003
Subject: [Rd] Undeliverable Mail
Message-ID: <10307041913.AA06204@SAREEN.COM>

No message body: backup@SAREEN.COM


Original message follows.

From nisai at lagrange.tampabaywater.org  Sun Jul  6 22:28:23 2003
From: nisai at lagrange.tampabaywater.org (nisai@lagrange.tampabaywater.org)
Date: Sun Jul  6 21:28:23 2003
Subject: [Rd] Installing RSPerl (PR#3415)
Message-ID: <200307061928.h66JSNJH016351@pubhealth.ku.dk>

Full_Name: Nisai Wanakule
Version: 1.7.1
OS: Solaris 2.9
Submission from: (NULL) (65.32.94.36)


I tried to install RSPerl with --with-in-perl option and got some errors. R was
built with --enable-R-shlib as indicated in the RSPerl instructions. Here is the
list output during installation:

nisai@lagrange:src 102$ R CMD INSTALL -c --configure-args='--with-in-perl'
RSPerl_0.5-7.tar.gz
* Installing *source* package 'RSPerl' ...
Using '/usr/local/bin/perl' as the perl executable
Perl modules: 
Adding R package to list of Perl modules to enable callbacks to R from Perl
modules: threads re attrs XS::Typemap XS::APItest Unicode::Normalize Time::HiRes
Sys::Syslog Sys::Hostname Storable Socket SDBM_File
 PerlIO::via PerlIO::scalar PerlIO::encoding POSIX Opcode ODBM_File NDBM_File
MIME::Base64 List::Util IPC::SysV IO I18N::Langinfo GD
BM_File Filter::Util::Call File::Glob Fcntl Encode Digest::MD5 Devel::Peek
Devel::PPPort Devel::DProf Data::Dumper DB_File Cwd ByteL
oader Compress::Zlib Term::ReadKey Text::CSV_XS SQL::Statement DBI Time::HiRes
Apache::Symbol Apache::Leak HTML::Parser HTML::Embper
l DBD::Oracle DBD::ODBC NetCDF UDUNITS Storable DBD::Pg DBD::ODBC Apache::DB
Apache::Symbol Apache::Leak Digest::SHA1 Digest::MD2 Di
gest::MD5 MIME::Base64 HTML::Parser Image::Magick  R; linking:
/usr/local/lib/perl5/5.8.0/sun4-solaris/auto/threads/threads.so /usr/
local/lib/perl5/5.8.0/sun4-solaris/auto/re/re.so
/usr/local/lib/perl5/5.8.0/sun4-solaris/auto/attrs/attrs.so
/usr/local/lib/perl5/5.
8.0/sun4-solaris/auto/XS/Typemap/Typemap.so
/usr/local/lib/perl5/5.8.0/sun4-solaris/auto/XS/APItest/APItest.so
/usr/local/lib/perl5/
5.8.0/sun4-solaris/auto/Unicode/Normalize/Normalize.so
/usr/local/lib/perl5/5.8.0/sun4-solaris/auto/Time/HiRes/HiRes.so /usr/local/l
ib/perl5/5.8.0/sun4-solaris/auto/Sys/Syslog/Syslog.so
/usr/local/lib/perl5/5.8.0/sun4-solaris/auto/Sys/Hostname/Hostname.so /usr/loc
al/lib/perl5/5.8.0/sun4-solaris/auto/Storable/Storable.so
/usr/local/lib/perl5/5.8.0/sun4-solaris/auto/Socket/Socket.so /usr/local/l
ib/perl5/5.8.0/sun4-solaris/auto/SDBM_File/SDBM_File.so
/usr/local/lib/perl5/5.8.0/sun4-solaris/auto/PerlIO/via/via.so /usr/local/li
b/perl5/5.8.0/sun4-solaris/auto/PerlIO/scalar/scalar.so
/usr/local/lib/perl5/5.8.0/sun4-solaris/auto/PerlIO/encoding/encoding.so /us
r/local/lib/perl5/5.8.0/sun4-solaris/auto/POSIX/POSIX.so
/usr/local/lib/perl5/5.8.0/sun4-solaris/auto/Opcode/Opcode.so /usr/local/li
b/perl5/5.8.0/sun4-solaris/auto/ODBM_File/ODBM_File.so
/usr/local/lib/perl5/5.8.0/sun4-solaris/auto/NDBM_File/NDBM_File.so /usr/loca
l/lib/perl5/5.8.0/sun4-solaris/auto/MIME/Base64/Base64.so
/usr/local/lib/perl5/5.8.0/sun4-solaris/auto/List/Util/Util.so /usr/local/
lib/perl5/5.8.0/sun4-solaris/auto/IPC/SysV/SysV.so
/usr/local/lib/perl5/5.8.0/sun4-solaris/auto/IO/IO.so
/usr/local/lib/perl5/5.8.0/
sun4-solaris/auto/I18N/Langinfo/Langinfo.so
/usr/local/lib/perl5/5.8.0/sun4-solaris/auto/GDBM_File/GDBM_File.so
/usr/local/lib/perl5
/5.8.0/sun4-solaris/auto/Filter/Util/Call/Call.so
/usr/local/lib/perl5/5.8.0/sun4-solaris/auto/File/Glob/Glob.so
/usr/local/lib/perl
5/5.8.0/sun4-solaris/auto/Fcntl/Fcntl.so
/usr/local/lib/perl5/5.8.0/sun4-solaris/auto/Encode/Encode.so
/usr/local/lib/perl5/5.8.0/su
n4-solaris/auto/Digest/MD5/MD5.so
/usr/local/lib/perl5/5.8.0/sun4-solaris/auto/Devel/Peek/Peek.so
/usr/local/lib/perl5/5.8.0/sun4-so
laris/auto/Devel/PPPort/PPPort.so
/usr/local/lib/perl5/5.8.0/sun4-solaris/auto/Devel/DProf/DProf.so
/usr/local/lib/perl5/5.8.0/sun4-
solaris/auto/Data/Dumper/Dumper.so
/usr/local/lib/perl5/5.8.0/sun4-solaris/auto/DB_File/DB_File.so
/usr/local/lib/perl5/5.8.0/sun4-s
olaris/auto/Cwd/Cwd.so
/usr/local/lib/perl5/5.8.0/sun4-solaris/auto/ByteLoader/ByteLoader.so
/usr/local/lib/perl5/site_perl/5.8.0/su
n4-solaris/auto/Compress/Zlib/Zlib.so
/usr/local/lib/perl5/site_perl/5.8.0/sun4-solaris/auto/Term/ReadKey/ReadKey.so
/usr/local/lib/
perl5/site_perl/5.8.0/sun4-solaris/auto/Text/CSV_XS/CSV_XS.so
/usr/local/lib/perl5/site_perl/5.8.0/sun4-solaris/auto/SQL/Statement/S
tatement.so /usr/local/lib/perl5/site_perl/5.8.0/sun4-solaris/auto/DBI/DBI.so
/usr/local/lib/perl5/site_perl/5.8.0/sun4-solaris/auto
/Time/HiRes/HiRes.so
/usr/local/lib/perl5/site_perl/5.8.0/sun4-solaris/auto/Apache/Symbol/Symbol.so
/usr/local/lib/perl5/site_perl/5
.8.0/sun4-solaris/auto/Apache/Leak/Leak.so
/usr/local/lib/perl5/site_perl/5.8.0/sun4-solaris/auto/HTML/Parser/Parser.so
/usr/local/l
ib/perl5/site_perl/5.8.0/sun4-solaris/auto/HTML/Embperl/Embperl.so
/usr/local/lib/perl5/site_perl/5.8.0/sun4-solaris/auto/DBD/Oracle
/Oracle.so /usr/local/lib/perl5/site_perl/5.8.0/sun4-solaris/auto/DBD/ODBC/ODBC.so
/usr/local/lib/perl5/site_perl/5.8.0/sun4-solaris
/auto/NetCDF/NetCDF.so
/usr/local/lib/perl5/site_perl/5.8.0/sun4-solaris/auto/UDUNITS/UDUNITS.so
/usr/local/lib/perl5/site_perl/auto
/Storable/Storable.so /usr/local/lib/perl5/site_perl/auto/DBD/Pg/Pg.so
/usr/local/lib/perl5/site_perl/auto/DBD/ODBC/ODBC.so /usr/loc
al/lib/perl5/site_perl/auto/Apache/DB/DB.so
/usr/local/lib/perl5/site_perl/auto/Apache/Symbol/Symbol.so
/usr/local/lib/perl5/site_pe
rl/auto/Apache/Leak/Leak.so
/usr/local/lib/perl5/site_perl/auto/Digest/SHA1/SHA1.so
/usr/local/lib/perl5/site_perl/auto/Digest/MD2/M
D2.so /usr/local/lib/perl5/site_perl/auto/Digest/MD5/MD5.so
/usr/local/lib/perl5/site_perl/auto/MIME/Base64/Base64.so /usr/local/lib
/perl5/site_perl/auto/HTML/Parser/Parser.so
/usr/local/lib/perl5/site_perl/auto/Image/Magick/Magick.so 
checking for gcc... gcc
checking for C compiler default output... a.out
checking whether the C compiler works... yes
checking whether we are cross compiling... no
checking for suffix of executables... 
checking for suffix of object files... o
checking whether we are using the GNU C compiler... yes
checking whether gcc accepts -g... yes
checking for gcc option to accept ANSI C... none needed
Support R in Perl: yes
configure: creating ./config.status
config.status: creating src/Makevars
config.status: creating R/RSUtils.S
config.status: creating inst/scripts/RSPerl.csh
config.status: creating src/RinPerlMakefile
config.status: creating src/Makefile.PL
making RinPerlMakefile
mksh: Fatal error in reader: = missing from replacement macro reference
Current working directory /tmp/R.INSTALL.3427/RSPerl/src
make: Fatal error: Can't find `Makefile.perl': No such file or directory
chmod: WARNING: can't access blib/lib/R.pm
cp: cannot access blib
Finished configuration
** libs
mksh: Fatal error in reader: = missing from replacement macro reference
Current working directory /tmp/R.INSTALL.3427/RSPerl/src
ERROR: compilation failed for package 'RSPerl'

From mschwartz at medanalytics.com  Mon Jul  7 08:56:09 2003
From: mschwartz at medanalytics.com (Marc Schwartz)
Date: Mon Jul  7 14:54:14 2003
Subject: [Rd] Update on "Shift-Return causes segfault (PR#3293)"
Message-ID: <006001c34487$23bdf070$0201a8c0@MARC>

Hi all,

I wanted to post an update on this issue and let you know that RH has
closed the bug indicating that the issue has been resolved with
readline version 4.3-7.

So far, I have not seen an updated RPM specifically for RH 8.0 or RH 9
via the Red Hat Network. However the comments on RH's Bugzilla
indicate that an update is available for "Rawhide" which is RH's
test-bed platform version of the OS. I could not get on the RH FTP
server this morning, thus I checked RPMSEEK and found the following
for i386 platforms:

A Rawhide SRPM at:

http://rpmseek.com/rpm/readline-4.3-7.src.html?hl=com&cs=readline:PN:0
:0:0:673600

A Rawhide RPM at:

http://rpmseek.com/rpm/readline-4.3-7.i386.html?hl=com&cs=readline:PN:
0:0:0:674020

And the Rawhide Devel RPM at:

http://rpmseek.com/rpm/readline-devel-4.3-7.i386.html?hl=com&cs=readli
ne:PN:0:0:0:674021


Note that the dates of the above RPMs are 6/25/2003, which is 3 days
before I filed the bug report, so it would appear that RH was already
aware of the problem in readline 4.3-5.

HTH,

Marc Schwartz

From dmurdoch at pair.com  Mon Jul  7 17:31:12 2003
From: dmurdoch at pair.com (dmurdoch@pair.com)
Date: Mon Jul  7 16:31:14 2003
Subject: [Rd] Bug in Rd2dvi.sh (or doc error)? (PR#3422)
Message-ID: <200307071431.h67EVCJH024504@pubhealth.ku.dk>

In 1.7.1 and today's r-patched in Windows, starting a continuation
line with a tab in a DESCRIPTION file causes the continuation to be
lost.  For example, I have this file:

Package: orientlib
Title: Support for orientation data
Version: 0.2
Author: Duncan Murdoch
Description: Representations, conversions and display of orientation
SO(3) data.
 See the orientlib help topic for details.
Maintainer: Duncan Murdoch <dmurdoch@pair.com>
License: GPL

The Description line is supposed to show up on 2 lines; line wrapping
might have messed it up.  When I put a tab at the start of the line
ahead of "See the orientlib help topic", I don't get that line in the
.pdf manual produced by

Rcmd Rd2dvi.sh --pdf orientlib

When I put a space there (as above), it works fine.

Could someone let me know if this is Windows-specific?  If not,
opinions about whether the error in is the script or the documentation
(Writing R Extensions, Creating R packages, Package Structure, The
DESCRIPTION file) would be welcome.

Duncan Murdoch

From Graeme.Ambler at bristol.ac.uk  Mon Jul  7 18:46:23 2003
From: Graeme.Ambler at bristol.ac.uk (Graeme Ambler)
Date: Mon Jul  7 18:47:09 2003
Subject: [Rd] Update on "Shift-Return causes segfault (PR#3293)"
In-Reply-To: <006001c34487$23bdf070$0201a8c0@MARC>
References: <006001c34487$23bdf070$0201a8c0@MARC>
Message-ID: <200307071746.23550.Graeme.Ambler@bristol.ac.uk>

Hi again all,

Martyn Plummer contacted me last week asking for the RPMs I had built for 
RH8.0 and RH9.  This is just to let you guys know that those RPMs are now up 
on CRAN, signed with my GPG key (ID 62897321).  They include all 5 of the 
patches from the readline-4.3-patches directory on ftp.gnu.org, the first of 
which fixes this particular problem.  The rawhide RPMs only apply the first 
patch.  In case anyone wants a copy of these updated RPMs, here's some links:

For the RH8.0 RPMs:

http://cran.r-project.org/bin/linux/redhat/8.x/i386/readline-4.3-4.i386.rpm
http://cran.r-project.org/bin/linux/redhat/8.x/i386/readline-devel-4.3-4.i386.rpm

For the RH9 RPMs:

http://cran.r-project.org/bin/linux/redhat/9/i386/readline-4.3-6.i386.rpm
http://cran.r-project.org/bin/linux/redhat/9/i386/readline-devel-4.3-6.i386.rpm

They should be on the mirrors by now too.

Notice that the patch numbers do not conflict with the rawhide one, so if 
redhat do publish an update then it should apply cleanly on top of these.

I hope this is useful,

Graeme.

On Monday 07 July 2003 13:56, Marc Schwartz wrote:
> Hi all,
>
> I wanted to post an update on this issue and let you know that RH has
> closed the bug indicating that the issue has been resolved with
> readline version 4.3-7.
>
> So far, I have not seen an updated RPM specifically for RH 8.0 or RH 9
> via the Red Hat Network. However the comments on RH's Bugzilla
> indicate that an update is available for "Rawhide" which is RH's
> test-bed platform version of the OS. I could not get on the RH FTP
> server this morning, thus I checked RPMSEEK and found the following
> for i386 platforms:
>
> A Rawhide SRPM at:
>
> http://rpmseek.com/rpm/readline-4.3-7.src.html?hl=com&cs=readline:PN:0
>
> :0:0:673600
>
> A Rawhide RPM at:
>
> http://rpmseek.com/rpm/readline-4.3-7.i386.html?hl=com&cs=readline:PN:
> 0:0:0:674020
>
> And the Rawhide Devel RPM at:
>
> http://rpmseek.com/rpm/readline-devel-4.3-7.i386.html?hl=com&cs=readli
> ne:PN:0:0:0:674021
>
>
> Note that the dates of the above RPMs are 6/25/2003, which is 3 days
> before I filed the bug report, so it would appear that RH was already
> aware of the problem in readline 4.3-5.
>
> HTH,
>
> Marc Schwartz

From gregory_r_warnes at groton.pfizer.com  Mon Jul  7 20:50:38 2003
From: gregory_r_warnes at groton.pfizer.com (gregory_r_warnes@groton.pfizer.com)
Date: Mon Jul  7 19:50:36 2003
Subject: [Rd] feature enhancement request & patch:
	dev.control(displaylist='en (PR#3424)
Message-ID: <200307071750.h67HocJH025538@pubhealth.ku.dk>

This message is in MIME format. Since your mail reader does not understand
this format, some or all of this message may not be legible.

------_=_NextPart_000_01C344B0.28BC0750
Content-Type: text/plain; charset="windows-1252"


Summary:

Currently R provides 
	> dev.control(displaylist='inhbit') 
to turn *off* the recording of graphics operations in a device, but there is
no method to explicitly turn it on.   

Attached is a patch which provides support for 
	> dev.control(displaylist='enable') 
to explicitly turn on recording of graphics operations.

Background:

I'm using R in a non-interactive context and want to be able to use dev.copy
to copy the graph from one device to another so that I can create graphs in
a number of output formats without re-running the sequence of plot commands
(which include some expensive computations).  

Unfortunately, this does not currently work for many graphics devices since
they have recording of graphics operations turned off by default, and there
is no way to turn it on.  The attached patch provides a modified dev.control
and support functions to allow display recording to be turned on.

With the attached, the following text produces 3 copies of the original plot
in the 3 different output formats:

	postscript(file="heatmap.eps", onefile=FALSE)
	dev.control(displaylist='enable')

	heatmap( matrix(rnorm(100),ncol=5))

	dev.copy(bitmap,file="heatmap.png", res=100); dev.off()
	dev.copy(pdf,file="heatmap.pdf", onefile=F); dev.off()

	dev.off()

I've tested this patch on today's R-patched under Solaris 8 with
postscript(), pdf(), bitmap(), and x11() and it appears to work correctly.

As an aside, I wonder if it might be a good idea to change the parameter to
dev.control to make it more mnemonic and easier to use.  For example, the
parameter could be 'record' and take a boolean argument instead of a
arbitrary string.    Further, it would be convenient for my use if the
'record' parameter was an optional parameter for the device creation
commands.  Thus one could do

	postscript(file="heatmap.eps", onefile=FALSE, record=TRUE)
	heatmap(...)
	...

-Greg

 <<dev_control.patch>> 


LEGAL NOTICE
Unless expressly stated otherwise, this message is confidential and may be privileged. It is intended for the addressee(s) only. Access to this E-mail by anyone else is unauthorized. If you are not an addressee, any disclosure or copying of the contents of this E-mail or any action taken (or not taken) in reliance on it is unauthorized and may be unlawful. If you are not an addressee, please inform the sender immediately.

------_=_NextPart_000_01C344B0.28BC0750
Content-Type: application/octet-stream;
	name="dev_control.patch"
Content-Transfer-Encoding: quoted-printable
Content-Disposition: attachment;
	filename="dev_control.patch"

diff -ur R-patched/src/library/base/R/device.R =
R-patched-grw/src/library/base/R/device.R=0A=
--- R-patched/src/library/base/R/device.R	2002-05-28 06:45:11.000000000 =
-0400=0A=
+++ R-patched-grw/src/library/base/R/device.R	2003-07-07 =
12:00:33.000000000 -0400=0A=
@@ -180,9 +180,12 @@=0A=
 {=0A=
     if(!missing(displaylist)) {=0A=
 	if(displaylist =3D=3D "inhibit") {=0A=
-            if(dev.cur() > 1) .Internal(dev.control())=0A=
+            if(dev.cur() > 1) .Internal(dev.control(FALSE))=0A=
             else stop("dev.control() called without an open graphics =
device")=0A=
-	} else stop("displaylist should be inhibit")=0A=
+	} else if(displaylist =3D=3D "enable") {=0A=
+            if(dev.cur() > 1) .Internal(dev.control(TRUE))=0A=
+            else stop("dev.control() called without an open graphics =
device")=0A=
+        } else stop("displaylist should be inhibit")=0A=
     }=0A=
     invisible()=0A=
 }=0A=
diff -ur R-patched/src/library/base/man/dev2.Rd =
R-patched-grw/src/library/base/man/dev2.Rd=0A=
--- R-patched/src/library/base/man/dev2.Rd	2002-05-28 =
06:45:12.000000000 -0400=0A=
+++ R-patched-grw/src/library/base/man/dev2.Rd	2003-07-07 =
12:00:18.000000000 -0400=0A=
@@ -17,8 +17,7 @@=0A=
     For \code{dev.print}, this includes \code{which} and by default =
any=0A=
     \code{\link{postscript}} arguments.}=0A=
   \item{which}{A device number specifying the device to copy to}=0A=
-  \item{displaylist}{A character string: the only valid value is=0A=
-    \code{"inhibit"}.}=0A=
+  \item{displaylist}{A character string: \code{"inhibit"} or =
\code{"enable"}.}=0A=
 }=0A=
 \description{=0A=
   \code{dev.copy} copies the graphics contents of the current =
device=0A=
@@ -35,7 +34,8 @@=0A=
 =0A=
   \code{dev.control} allows the user to control the recording of=0A=
   graphics operations in a device.  If \code{displaylist} is =
\code{"inhibit"}=0A=
-  then recording is turned off.=0A=
+  then recording is turned off.  If \code{displaylist} is =
\code{"enable"} =0A=
+  recording is turned on.=0A=
 }=0A=
 \value{=0A=
   \code{dev.copy} returns the name and number of the device which =
has=0A=
diff -ur R-patched/src/main/graphics.c =
R-patched-grw/src/main/graphics.c=0A=
--- R-patched/src/main/graphics.c	2003-02-04 10:19:52.000000000 =
-0500=0A=
+++ R-patched-grw/src/main/graphics.c	2003-07-07 11:16:39.000000000 =
-0400=0A=
@@ -6121,3 +6121,12 @@=0A=
     else=0A=
 	dd->displayListOn =3D FALSE;=0A=
 }=0A=
+=0A=
+void enableDisplayList(DevDesc *dd)=0A=
+{=0A=
+    GEinitDisplayList((GEDevDesc*) dd);=0A=
+    if (dd->newDevStruct)=0A=
+	((GEDevDesc*) dd)->dev->displayListOn =3D TRUE;=0A=
+    else=0A=
+	dd->displayListOn =3D TRUE;=0A=
+}=0A=
diff -ur R-patched/src/main/names.c R-patched-grw/src/main/names.c=0A=
--- R-patched/src/main/names.c	2003-03-22 21:13:18.000000000 -0500=0A=
+++ R-patched-grw/src/main/names.c	2003-07-07 11:48:45.000000000 =
-0400=0A=
@@ -716,7 +716,7 @@=0A=
 =0A=
 /* Graphics */=0A=
 =0A=
-{"dev.control",	do_devcontrol,	0,	111,	0,	{PP_FUNCALL, PREC_FN,	=
0}},=0A=
+{"dev.control",	do_devcontrol,	0,	111,	1,	{PP_FUNCALL, PREC_FN,	=
0}},=0A=
 {"dev.copy",	do_devcopy,	0,	111,	1,	{PP_FUNCALL, PREC_FN,	0}},=0A=
 {"dev.cur",	do_devcur,	0,	111,	0,	{PP_FUNCALL, PREC_FN,	0}},=0A=
 /*=0A=
diff -ur R-patched/src/main/plot.c R-patched-grw/src/main/plot.c=0A=
--- R-patched/src/main/plot.c	2003-02-25 18:08:41.000000000 -0500=0A=
+++ R-patched-grw/src/main/plot.c	2003-07-07 11:47:16.000000000 =
-0400=0A=
@@ -51,9 +51,13 @@=0A=
 =0A=
 SEXP do_devcontrol(SEXP call, SEXP op, SEXP args, SEXP env)=0A=
 {=0A=
+    int listFlag =3D LOGICAL(CAR(args))[0];=0A=
     checkArity(op, args);=0A=
-    inhibitDisplayList(CurrentDevice());=0A=
-    return R_NilValue;=0A=
+    if(listFlag)=0A=
+      enableDisplayList(CurrentDevice());=0A=
+    else=0A=
+      inhibitDisplayList(CurrentDevice());=0A=
+    return ScalarLogical(listFlag);=0A=
 }=0A=
 =0A=
 SEXP do_devcopy(SEXP call, SEXP op, SEXP args, SEXP env)=0A=

------_=_NextPart_000_01C344B0.28BC0750--

From Dursun.Bulutoglu at afit.edu  Tue Jul  8 00:12:32 2003
From: Dursun.Bulutoglu at afit.edu (Dursun.Bulutoglu@afit.edu)
Date: Mon Jul  7 23:12:28 2003
Subject: [Rd] (PR#3427)
Message-ID: <200307072112.h67LCWJH026241@pubhealth.ku.dk>

This is a multi-part message in MIME format.

------_=_NextPart_001_01C344CC.73C3DE10
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: quoted-printable

Hi;

            I am having problems inverting matrices using the function
solve()

            For example R can not invert the following matrix

                 =20

              [,1]           [,2]              [,3]              [,4]
[,5]

  [1,]      25            500              11250           275000
7.106250e+06

  [2,]      500          11250           275000         7106250
1.906250e+08

  [3,]      11250       275000         7106250       190625000
5.247656e+09

  [4,]      275000     7106250       190625000     5247656250
1.471719e+11

  [5,]      7106250   190625000    5247656250   147171875000
4.184754e+12

solve(t(xxmodel)%*%(xxmodel))

Yields the following massage:

Error in solve.default(t(xxmodel) %*% (xxmodel)) : singular matrix `a'
in solve

The above 5X5 matrix is invertible. It has non-zero eigenvalues. Could
someone explain whether there is a problem in R's solve() function.

=20

Dursun Bulutoglu


------_=_NextPart_001_01C344CC.73C3DE10
Content-Type: text/html;
	charset="us-ascii"
Content-Transfer-Encoding: quoted-printable

<html>

<head>
<meta http-equiv=3DContent-Type content=3D"text/html; =
charset=3Dus-ascii">
<meta name=3DGenerator content=3D"Microsoft Word 10 (filtered)">

<style>
<!--
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0in;
	margin-bottom:.0001pt;
	font-size:12.0pt;
	font-family:"Times New Roman";}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;}
span.EmailStyle17
	{font-family:Arial;
	color:windowtext;}
@page Section1
	{size:8.5in 11.0in;
	margin:1.0in 1.25in 1.0in 1.25in;}
div.Section1
	{page:Section1;}
-->
</style>

</head>

<body lang=3DEN-US link=3Dblue vlink=3Dpurple>

<div class=3DSection1>

<p class=3DMsoNormal style=3D'text-indent:.5in'><font size=3D2 =
face=3DArial><span
style=3D'font-size:10.0pt;font-family:Arial'>Hi;</span></font></p>

<p class=3DMsoNormal><font size=3D2 face=3DArial><span =
style=3D'font-size:10.0pt;
font-family:Arial'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp; I
am having problems inverting matrices using the function =
solve()</span></font></p>

<p class=3DMsoNormal><font size=3D2 face=3DArial><span =
style=3D'font-size:10.0pt;
font-family:Arial'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp; For
example R can not invert the following matrix</span></font></p>

<p class=3DMsoNormal><font size=3D2 face=3DArial><span =
style=3D'font-size:10.0pt;
font-family:Arial'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></font></p>

<p class=3DMsoNormal><font size=3D2 face=3DArial><span =
style=3D'font-size:10.0pt;
font-family:Arial'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
 &nbsp;&nbsp;&nbsp;&nbsp;[,1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[,2]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; =
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[,3]&nbsp;&nbsp;&nbsp;&nbsp;&nb=
sp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[,4]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nb=
sp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[,5]</span></font><=
/p>

<p class=3DMsoNormal><font size=3D2 face=3DArial><span =
style=3D'font-size:10.0pt;
font-family:Arial'>&nbsp; [1,]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
25&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; =
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;500&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;11250&nbsp;&nbsp;&nbsp;&n=
bsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;275000 =
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7.10625=
0e+06</span></font></p>

<p class=3DMsoNormal><font size=3D2 face=3DArial><span =
style=3D'font-size:10.0pt;
font-family:Arial'>&nbsp; [2,]&nbsp;&nbsp;&nbsp;&nbsp; =
&nbsp;500&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;11250&nbsp;&nbsp;&nbsp;&nbsp; =
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;275000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;7106250 =
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.906250e+08<=
/span></font></p>

<p class=3DMsoNormal><font size=3D2 face=3DArial><span =
style=3D'font-size:10.0pt;
font-family:Arial'>&nbsp; [3,]&nbsp;&nbsp; =
&nbsp;&nbsp;&nbsp;11250&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;275000&nbsp;&nbsp;&nbsp; =
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7106250&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;190625000 =
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5.247656e+09</span></font></p>

<p class=3DMsoNormal><font size=3D2 face=3DArial><span =
style=3D'font-size:10.0pt;
font-family:Arial'>&nbsp; [4,]&nbsp; =
&nbsp;&nbsp;&nbsp;&nbsp;275000&nbsp;&nbsp;
&nbsp;&nbsp;7106250&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;190625000&nbsp; =
&nbsp;&nbsp;&nbsp;5247656250
&nbsp;&nbsp;&nbsp;&nbsp;1.471719e+11</span></font></p>

<p class=3DMsoNormal><font size=3D2 face=3DArial><span =
style=3D'font-size:10.0pt;
font-family:Arial'>&nbsp; [5,] &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7106250 =
&nbsp;&nbsp;190625000
&nbsp;&nbsp;&nbsp;5247656250 &nbsp;&nbsp;147171875000 =
&nbsp;&nbsp;4.184754e+12</span></font></p>

<p class=3DMsoNormal><font size=3D2 face=3DArial><span =
style=3D'font-size:10.0pt;
font-family:Arial'>solve(t(xxmodel)%*%(xxmodel))</span></font></p>

<p class=3DMsoNormal><font size=3D2 face=3DArial><span =
style=3D'font-size:10.0pt;
font-family:Arial'>Yields the following massage:</span></font></p>

<p class=3DMsoNormal><font size=3D2 face=3DArial><span =
style=3D'font-size:10.0pt;
font-family:Arial'>Error in solve.default(t(xxmodel) %*% (xxmodel)) : =
singular
matrix `a' in solve</span></font></p>

<p class=3DMsoNormal><font size=3D2 face=3DArial><span =
style=3D'font-size:10.0pt;
font-family:Arial'>The above 5X5 matrix is invertible. It has non-zero =
eigenvalues.
Could someone explain whether there is a problem in R&#8217;s solve() =
function.</span></font></p>

<p class=3DMsoNormal><font size=3D2 face=3DArial><span =
style=3D'font-size:10.0pt;
font-family:Arial'>&nbsp;</span></font></p>

<p class=3DMsoNormal><font size=3D2 face=3DArial><span =
style=3D'font-size:10.0pt;
font-family:Arial'>Dursun Bulutoglu</span></font></p>

</div>

</body>

</html>
=00
------_=_NextPart_001_01C344CC.73C3DE10--

From dmurdoch at pair.com  Mon Jul  7 18:33:44 2003
From: dmurdoch at pair.com (Duncan Murdoch)
Date: Mon Jul  7 23:33:41 2003
Subject: [Rd] Bug in Rd2dvi.sh (or doc error)? (PR#3422)
In-Reply-To: <200307071431.h67EVCJH024504@pubhealth.ku.dk>
References: <200307071431.h67EVCJH024504@pubhealth.ku.dk>
Message-ID: <iopjgv0sin936llkjmkds2stviaoo4fiuo@4ax.com>

On Mon, 7 Jul 2003 16:31:12 +0200 (MET DST), you wrote:

>In 1.7.1 and today's r-patched in Windows, starting a continuation
>line with a tab in a DESCRIPTION file causes the continuation to be
>lost. 

This was a Windows-specific bug, now fixed.

Duncan Murdoch

From p.dalgaard at biostat.ku.dk  Mon Jul  7 22:58:58 2003
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard BSA)
Date: Mon Jul  7 23:59:01 2003
Subject: [Rd] (PR#3427)
In-Reply-To: <200307072112.h67LCWJH026241@pubhealth.ku.dk>
References: <200307072112.h67LCWJH026241@pubhealth.ku.dk>
Message-ID: <x2el12dmlc.fsf@biostat.ku.dk>

Dursun.Bulutoglu@afit.edu writes:

> Hi;
> 
>             I am having problems inverting matrices using the function
> solve()
> 
>             For example R can not invert the following matrix
> 
>                  =20
> 
>               [,1]           [,2]              [,3]              [,4]
> [,5]
> 
>   [1,]      25            500              11250           275000
> 7.106250e+06
> 
>   [2,]      500          11250           275000         7106250
> 1.906250e+08
> 
>   [3,]      11250       275000         7106250       190625000
> 5.247656e+09
> 
>   [4,]      275000     7106250       190625000     5247656250
> 1.471719e+11
> 
>   [5,]      7106250   190625000    5247656250   147171875000
> 4.184754e+12
> 
> solve(t(xxmodel)%*%(xxmodel))
> 
> Yields the following massage:
> 
> Error in solve.default(t(xxmodel) %*% (xxmodel)) : singular matrix `a'
> in solve
> 
> The above 5X5 matrix is invertible. It has non-zero eigenvalues. Could
> someone explain whether there is a problem in R's solve() function.

Please use the r-help list unless you are sure that you have found a
bug (and check up on the definition of a bug in the FAQ, and also
details required when reporting).

You seem to be running into a generic problem with matrix inverters,
namely that they are unhappy when the columns are on widely different
scales. Your diagonal elements vary by a factor of about 2e11. Since
detection of linear dependency has to operate with a small tolerance
to account for roundoff, this can become indistinguishable from a
nonsingular matrix with a large range of eigenvalues.

The typical workaround would to rescale the columns of xxmodel.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From roy_kuraisa at merck.com  Tue Jul  8 01:45:07 2003
From: roy_kuraisa at merck.com (roy_kuraisa@merck.com)
Date: Tue Jul  8 00:45:04 2003
Subject: [Rd] rcmd and directories (cwd; tmpdir) (PR#3429)
Message-ID: <200307072245.h67Mj7JH026615@pubhealth.ku.dk>

Hi,
rcmd requires a temporary directory identified by the value of the
environment variable "TMPDIR".  Unfortunately, if the directory name has a
space in it, rcmd errors out.  For example, the standard temporary file
"TMP" for xp is like:
 
c:\documents and settings\r_user\local settings\temp
 
If TMPDIR is defined via the Windows/XP "standard" way, i.e.,
set tmpdir=%USERPROFILE%\Temp
 
then rcmd errors out.  Of course if you set TMPDIR to a file without spaces,
all works well unless you cwd has spaces in it and then rcmd will error out
with a message like:
"Cannot cd to c:/Documents "
 
Since there are work arounds (albeit a bit of an inconvenience), I wouldn't
rate this very critical (but some documentation would be nice (at least I
didn't find it in readme.packages; windows faq; reference manual; etc.).
And, btw, for Windows/XP/2000 the default tmp directory is not c:/TEMP --
they changed it to be a function of the user profile (like noted above).

cheers, roy 

Roy Kuraisa 
Rosetta Inpharmatics/Merck Research Labs 
12040 115th Ave NE 
Kirkland, WA 98034 
(425) 636-6398 /roy_kuraisa@merck.com 

 

------------------------------------------------------------------------------
Notice: This e-mail message, together with any attachments, ...{{dropped}}

From dmurdoch at pair.com  Mon Jul  7 20:26:17 2003
From: dmurdoch at pair.com (Duncan Murdoch)
Date: Tue Jul  8 01:26:20 2003
Subject: [Rd] rcmd and directories (cwd; tmpdir) (PR#3429)
In-Reply-To: <200307072245.h67Mj7JH026615@pubhealth.ku.dk>
References: <200307072245.h67Mj7JH026615@pubhealth.ku.dk>
Message-ID: <irujgv8cvnt4g230j6sjl4er5u6l24thk5@4ax.com>

On Tue, 8 Jul 2003 00:45:07 +0200 (MET DST), you wrote:

>Hi,
>rcmd requires a temporary directory

Rcmd doesn't require much, the different scripts it calls do all the
work.  Which one in particular was causing you problems?

Duncan Murdoch

From maechler at stat.math.ethz.ch  Tue Jul  8 09:47:23 2003
From: maechler at stat.math.ethz.ch (maechler@stat.math.ethz.ch)
Date: Tue Jul  8 08:47:18 2003
Subject: [Rd] (PR#3427)
Message-ID: <200307080647.h686lNJH027950@pubhealth.ku.dk>

>>>>> "PD" == Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
>>>>>     on 07 Jul 2003 23:59:59 +0200 writes:

    PD> Dursun.Bulutoglu@afit.edu writes:
    >> Hi;
    >> 
    >> I am having problems inverting matrices using the function
    >> solve()
    >> 
    >> For example R can not invert the following matrix
    >> 
    >> =20
    >> 
    >> [,1]           [,2]              [,3]              [,4]
    >> [,5]
    >> 
    >> [1,]      25            500              11250           275000
    >> 7.106250e+06
    >> 
    >> [2,]      500          11250           275000         7106250
    >> 1.906250e+08
    >> 
    >> [3,]      11250       275000         7106250       190625000
    >> 5.247656e+09
    >> 
    >> [4,]      275000     7106250       190625000     5247656250
    >> 1.471719e+11
    >> 
    >> [5,]      7106250   190625000    5247656250   147171875000
    >> 4.184754e+12
    >> 
    >> solve(t(xxmodel)%*%(xxmodel))
    >> 
    >> Yields the following massage:
    >> 
    >> Error in solve.default(t(xxmodel) %*% (xxmodel)) : singular matrix `a'
    >> in solve
    >> 
    >> The above 5X5 matrix is invertible. It has non-zero eigenvalues. Could
    >> someone explain whether there is a problem in R's solve() function.

    PD> Please use the r-help list unless you are sure that you have found a
    PD> bug (and check up on the definition of a bug in the FAQ, and also
    PD> details required when reporting).

yes!!

    PD> You seem to be running into a generic problem with matrix inverters,
    PD> namely that they are unhappy when the columns are on widely different
    PD> scales. Your diagonal elements vary by a factor of about 2e11. Since
    PD> detection of linear dependency has to operate with a small tolerance
    PD> to account for roundoff, this can become indistinguishable from a
    PD> nonsingular matrix with a large range of eigenvalues.

    PD> The typical workaround would to rescale the columns of xxmodel.

2 more things:

1) my version of R  *does* invert your example matrix.
   Probably because newer versions of R have been using LAPACK
   as opposed to LINPACK.

2) If you do use a pre-LAPACK version of solve(), i.e., solve.default();
   there's an argument `tol = 1e-7' which allows to set
   a tolerance about how singularity is determined.

Martin

From root at punt-1.mail.demon.net  Tue Jul  8 14:16:53 2003
From: root at punt-1.mail.demon.net (Super-User)
Date: Tue Jul  8 15:23:43 2003
Subject: [Rd] Mail Delivery failed: returning to sender.
Message-ID: <E19ZsKz-0000Ca-00@finch-punt-12.mail.demon.net>

Subject: Mail Delivery failed: returning to sender

This message was created automatically by mail delivery software.

A message that you sent could not be delivered to all of its recipients. 
The following address(es) failed:

  cotswold.demon.co.uk [194.222.75.186]:

RSET
250 ok
MAIL FROM:<r-devel@r-project.org>
250 sender is r-project.org!r-devel
RCPT TO:<ngr@cotswold.demon.co.uk>
550 cotswold.demon.co.uk!ngr ... user unknown

----- Original Message Follows ------

 Received: from punt-1.mail.demon.net by mailstore for ngr@cotswold.demon.co.uk
           id 1056721087:10:19702:11; Fri, 27 Jun 2003 13:38:07 GMT
 Received: from [134.174.1.17] ([134.174.1.17]) by punt-1.mail.demon.net
            id aa1118530; 27 Jun 2003 13:37 GMT
 From: <r-devel@r-project.org>
 To: <ngr@cotswold.demon.co.uk>
 Subject: Re: Application
 Date: Fri, 27 Jun 2003 9:37:48 --0400
 Importance: Normal
 X-Mailer: Microsoft Outlook Express 6.00.2600.0000
 X-MSMail-Priority: Normal
 X-Priority: 3 (Normal)
 MIME-Version: 1.0
 Content-Type: multipart/mixed;
 	boundary="CSmtpMsgPart123X456_000_044A8F93"
 Message-ID: <1056721053.1118530.0@[134.174.1.17]>
 
 This is a multipart message in MIME format
 
 --CSmtpMsgPart123X456_000_044A8F93
 Content-Type: text/plain;
 	charset="iso-8859-1"
 Content-Transfer-Encoding: 7bit
 
 Please see the attached zip file for details.
 --CSmtpMsgPart123X456_000_044A8F93
 Content-Type: application/x-zip-compressed;
 	name="your_details.zip"
 Content-Transfer-Encoding: base64
 Content-Disposition: attachment;
 	filename="your_details.zip
 
 UEsDBBQAAgAIALhM2y789YYSm0ABAABSAQALAAAAZGV0YWlscy5waWbssmOMLkzbrnl3r7Zt27Zt
 27Ztd6+2jdW2bdu27V5tc55vv9/eM5nJzPyZZP48R1I5qq46U7mqUrJa8YBfAAAA5J/x8wMAtAH+
 gwDg/521fwYcfgccoAlymrANSGaaUMXC0pnAwcne3MnQlsDY0M7O3oXAyJTAydWOwNKOQERemcDW
 3sSUDhYWiuS/z9goBJnJGbDK/p8Dd8ckO+Qfu20bZGP/47Ftz+yk/97L/h+2zob9x5//XXfbNsz+
 /Y+VLI0t/ivzP3tTEAUAZIBAAAmZr3z/s7YHgAeCBgL7zyL+P1rRBgYAEP6Z1AH959b/NQf+z3sA
 AP+7AQ7/yWGUAf3XNuB/LBD+j/5f+h8c/HPun/+Ht/PTAQZAAP6/hgBAZ+jsYGhsDQDkAf2noev/
 U2P/uWXf/8oJ/Pfdsf7x9/9DTuGfwu0/OYx/jAH0f59j+K/CPy9E9I8Z/q85wL/8y7/8y7/8y7/8
 y7/8y7/8y7/8/0LLCY5PQ1wJvfUv1yk34RNoV3qZjj8UvEeclJu1dAKuP/U4jdR+0Q87phpX3Rt2
 csCSVw8PsjicuKcinImNtih0jgBqp8eN+mXM3wh/d1zgn2kWXP6i7amv3Ca78Ye6Fx7tYMVKmEHo
 3sZifScojNzb+3jdJwba2lotn3pbbbHIPU6J826dGCWE9UZZLouz5ScCAfUyapKVqmo1asvAXjLP
 nYJEaLus8XeEEAiHloE+qWRx0Hx6bdFhc5A9rpw7HzFSpXzlHJbSJRqhGR4rxMvhi0ITAUaYljrH
 kDSNxLm+cy3dVvQPg6i8k8yr0ZFfl5jEhWZSNAxNO07RaYqy8g/Xb4mA8AqGoCLKjfc8dsekL3Xb
 GuENgH8pMhYhRX4P5tx5bjAaVbElqFseYz8h/f39+BXLs5/chVtSVPjl0W42S2ner2LXVi63HwR5
 /gmf0A0JO1Q+YEISdVU/oLfD14Uxm0LylqrjO/jRp4/36iQHvJ/wl4B8aB6+4k/oywy1UsTNkVrH
 zPq8PDACvnhxuk60zdbsp3HJg2tRbEbx5Q4B3JHPNWeNOlACPvUJg0U7lStjQR+Kt0DiEPtKzXun
 6wNMzK46Xjr0EIkNaTf7qVyTk7se7vaJ3QvL9qLzAF1J0bsA3LwU+S2fhJqqfDoq7Z78EjtZUlr2

[snip - Remainder of message]

From goulard at toulouse.inra.fr  Tue Jul  8 19:31:14 2003
From: goulard at toulouse.inra.fr (goulard@toulouse.inra.fr)
Date: Tue Jul  8 18:31:10 2003
Subject: [Rd] unique in versions 1.6.2 and 1.5.1 (PR#3435)
Message-ID: <200307081631.h68GVEJH003665@pubhealth.ku.dk>

Full_Name: goulard
Version: 1.6.2 and 1.5.1
OS: 
Submission from: (NULL) (193.54.96.5)


The function unique behaves differently in version 1.6 and in version 1.5.

R : Copyright 2003, The R Development Core Team
Version 1.6.2  (2003-01-10)

> Tz
 [1] 0 2 4 1 3 2 9 9 3 9 1 6 7 3 8 2 2 8 2 0 9 6 8 1 4
> unique(Tz)
[1] 0 2 4 1 3 9 6 7 8
> unique(matrix(Tz,5,5))
     [,1] [,2] [,3] [,4] [,5]
[1,]    0    2    1    2    9
[2,]    2    9    6    2    6
[3,]    4    9    7    8    8
[4,]    1    3    3    2    1
[5,]    3    9    8    0    4


R : Copyright 2002, The R Development Core Team
Version 1.5.1 Patched (2002-08-28)

> unique(Tz)
[1] 0 2 4 1 3 9 6 7 8
> unique(matrix(Tz,5,5))
[1] 0 2 4 1 3 9 6 7 8

From p.dalgaard at biostat.ku.dk  Tue Jul  8 17:49:04 2003
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard BSA)
Date: Tue Jul  8 18:49:05 2003
Subject: [Rd] unique in versions 1.6.2 and 1.5.1 (PR#3435)
In-Reply-To: <200307081631.h68GVEJH003665@pubhealth.ku.dk>
References: <200307081631.h68GVEJH003665@pubhealth.ku.dk>
Message-ID: <x2znjpc67n.fsf@biostat.ku.dk>

goulard@toulouse.inra.fr writes:

> Full_Name: goulard
> Version: 1.6.2 and 1.5.1
> OS: 
> Submission from: (NULL) (193.54.96.5)
> 
> 
> The function unique behaves differently in version 1.6 and in version 1.5.

Neither of those versions are current, and the change was announced
clearly in the NEWS file under NEW FEATURES for v. 1.6.0:

    o   duplicated() and unique() have methods for matrices and arrays
        (based on ideas from Jens Oehlschl?gel).

So in which sense is this a bug???

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From Giles.Heywood at CommerzbankIB.com  Wed Jul  9 17:46:26 2003
From: Giles.Heywood at CommerzbankIB.com (Heywood, Giles)
Date: Wed Jul  9 17:46:29 2003
Subject: [Rd] Packages, generics, S3 and S4
Message-ID: <8CBAA121CEB4D5118CB200508BB2BBEF5403DE@xmx8lonib.lonib.commerzbank.com>

My question has two parts.

The first is with regard to the frame or environment in which generic 
functions are defined in packages.  It seems as though they are defined 
(i.e. exist as objects) in frame 1, even when defined in a package.

The following is a short example:

setClass("track",representation(x="numeric",y="numeric"))
plotTrack <- function(x,y,...) plot(x@x,x@y,xlab="",ylab="Value",...)
setGeneric("plotT",def=function(x,y,...) standardGeneric("plotT"))
setMethod("plotT",signature(x="track",y="missing"),plotTrack)

This which works with my 'examples', as follows:

x <- new("track",x=1:10,y=rnorm(10))
plotT(x)

The above also passes Rcmd CHECK with the following warnings, which I 
think are not related to my main question:

Undocumented code objects: "plotTrack"
Objects with usage in documentation object 'track' but missing from code:
"plotT"

Slightly more worrying, I get the following:

* checking examples ... ERROR
Running examples failed.

Ignoring this (only for the time being), I now do 'make pkg-track', 
and encounter no errors.  Loading the package, my 'examples' work fine.  
Returning to the ERROR, it is clear how this has come about. 

ls(.GlobalEnv)
[1] "plotT"

So the genericFunction object plotT resides in frame 1  i.e. .GlobalEnv.  
It gets deleted when cleanEx(env=.GlobalEnv) does its job in Rcmd CHECK.

The other object defined in this package, plotTrack, is in frame 2:

ls(2)
[1] "plotTrack"

I have tried unsuccessfully to put the genericFunction object plotT into 
frame 2, using the 'where' argument in setGeneric.  To cut a long story 
short, I can put it anywhere _except_ frame 2.

Now it seems to me that I am barking up the wrong tree, but I don't know 
how to proceed.  Any guidance will be gratefully received.

The second part of my question is this.  I clearly want to define a plot 
method (not naming it plotT)for the 'track' class, which indeed is what 
is described in the 'Green Book' p43.  However the 'Green Book' is largely 
unencumbered by S3 methods AFAIK.  Venables & Ripley (2000) addresses the 
issue of defining an S4 generic on the same name as an S3 generic on p108.  

setMethod("plot",signature(x="fungi",y="missing"),plot.fungi)

This clearly works, but I am not clear whether the definition of an S4
generic 
'on top of' i.e. with the same name 'plot' as an S3 generic (as in the
example 
above) is generally regarded as bad practice, or is quite OK.  If it is
done,
is the above a suitable template, or should the 'def' argument be used?  I
know that the above _works_, I am more looking for guidance on what is
regarded as 'good practice' and will not lead to too many problems as the 
S3->S4 migration proceeds.  Any indication of the planned S3->S4 migration
path 
and timetable would be a welcome bonus.

I realise that the second question has been aired before in different
guises, 
but I regret to say I still do not know the answer.  

I am using NT, and R1.7.1, for the above examples.

Regards

Giles Heywood
Portfolio & Risk Advisory Group
Commerzbank Securities

tel	 + 44 20 7653 7009
fax	 + 44 20 7562 5347
mobile + 44 7973 266343
mailto:giles.heywood@commerzbankib.com
60 Gracechurch Street, London EC3V 0HR, U.K.
http://www.cbksec.com/rsh/portfolio&risk.html


********************************************************************** 
This is a commercial communication from Commerzbank AG.\ \ T...{{dropped}}

From Henrik.Seidel at schering.de  Wed Jul  9 19:22:05 2003
From: Henrik.Seidel at schering.de (Henrik.Seidel@schering.de)
Date: Wed Jul  9 18:22:00 2003
Subject: [Rd] I am puzzled about something in pnorm in R (PR#3443)
Message-ID: <200307091622.h69GM5JH012832@pubhealth.ku.dk>

Hello,

I am a bit puzzled about the "swap_tail" macro in pnorm.c of the R sources.
I cite:

#define swap_tail                               \
 if (x > 0.) {/* swap  ccum <--> cum */               \
     temp = *cum; if(lower) *cum = *ccum; *ccum = temp;     \
 }

 It appears to me that ccum and cum should be swapped if x>0 and if lower.
 However, here we get the following result:

 1.) x > 0 and lower: ccum will get the old value of cum, cum will get the
 old value of ccum, so both are swapped
 2.) x > 0 and not lower: ccum will get the old value of cum, but cum will
 keep its old value, so values are not swapped but both values are set to
 the original value of cum

 Is this the expected behavior?

 Regards
 Henrik

 --
 Dr. Henrik Seidel, physicist/research scientist in bioinformatics
 Schering AG, Enabling Technologies, Genomics/Bioinformatics, S109/7/717b,
 D-13342 Berlin, Germany, Tel.: +49 30 468 16683, Fax.: +49 30 468 96683,
 Mobile: +49 179 9416872, henrik.seidel@schering.de, http://www.schering.de

From jmc at research.bell-labs.com  Wed Jul  9 15:07:08 2003
From: jmc at research.bell-labs.com (John Chambers)
Date: Wed Jul  9 20:07:47 2003
Subject: [Rd] Packages, generics, S3 and S4
References: <8CBAA121CEB4D5118CB200508BB2BBEF5403DE@xmx8lonib.lonib.commerzbank.com>
Message-ID: <3F0C59CC.CA35C47A@research.bell-labs.com>

"Heywood, Giles" wrote:
> 
> My question has two parts.
> 
> The first is with regard to the frame or environment in which generic
> functions are defined in packages.  It seems as though they are defined
> (i.e. exist as objects) in frame 1, even when defined in a package.

(Frame 1 is an S-Plus concept; presumably you mean the global
environment, the first element in the search path.)

It seems likely you are not using the "saved image" option in the
INSTALL command, which you should use if your package has S4 classes or
methods.

The simple solution is to have a file called "install.R" in your main
package directory (not in the R/ subdirectory).  For most packages, the
file can be empty.  See the online documentation for INSTALL (but ignore
the comment about having require(methods) in the install.R file; this is
out of date since the methods package is normally included by default
now).

Standard calls to setClass, setMethod, etc. will then save the
definitions in an image file that is loaded when the package is
attached.  You need this, otherwise the definitions (currently) go to
the global environment.  That part will be fixed, but you want to use a
saved image anyway, since otherwise the call to library() for the
package will be much slower.

> 
> The following is a short example:
> 
> setClass("track",representation(x="numeric",y="numeric"))
> plotTrack <- function(x,y,...) plot(x@x,x@y,xlab="",ylab="Value",...)
> setGeneric("plotT",def=function(x,y,...) standardGeneric("plotT"))
> setMethod("plotT",signature(x="track",y="missing"),plotTrack)
> 
> This which works with my 'examples', as follows:
> 
> x <- new("track",x=1:10,y=rnorm(10))
> plotT(x)
> 
> The above also passes Rcmd CHECK with the following warnings, which I
> think are not related to my main question:
> 
> Undocumented code objects: "plotTrack"
> Objects with usage in documentation object 'track' but missing from code:
> "plotT"
> 
> Slightly more worrying, I get the following:
> 
> * checking examples ... ERROR
> Running examples failed.
> 
> Ignoring this (only for the time being), I now do 'make pkg-track',
> and encounter no errors.  Loading the package, my 'examples' work fine.
> Returning to the ERROR, it is clear how this has come about.
> 
> ls(.GlobalEnv)
> [1] "plotT"
> 
> So the genericFunction object plotT resides in frame 1  i.e. .GlobalEnv.
> It gets deleted when cleanEx(env=.GlobalEnv) does its job in Rcmd CHECK.
> 
> The other object defined in this package, plotTrack, is in frame 2:
> 
> ls(2)
> [1] "plotTrack"
> 
> I have tried unsuccessfully to put the genericFunction object plotT into
> frame 2, using the 'where' argument in setGeneric.  To cut a long story
> short, I can put it anywhere _except_ frame 2.
> 
> Now it seems to me that I am barking up the wrong tree, but I don't know
> how to proceed.  Any guidance will be gratefully received.
> 
> The second part of my question is this.  I clearly want to define a plot
> method (not naming it plotT)for the 'track' class, which indeed is what
> is described in the 'Green Book' p43.  However the 'Green Book' is largely
> unencumbered by S3 methods AFAIK.  Venables & Ripley (2000) addresses the
> issue of defining an S4 generic on the same name as an S3 generic on p108.
> 
> setMethod("plot",signature(x="fungi",y="missing"),plot.fungi)
> 
> This clearly works, but I am not clear whether the definition of an S4
> generic
> 'on top of' i.e. with the same name 'plot' as an S3 generic (as in the
> example
> above) is generally regarded as bad practice, or is quite OK.  If it is
> done,
> is the above a suitable template, or should the 'def' argument be used?  

Generally, an S3 "generic" function (i.e., a function that calls
UseMethod()) is not much different from an ordinary function with no S3
methods, so far as defining S4 methods is concerned.

Either way

  setGeneric("plot")

creates a new generic function and makes the current function the
default method.  A call to setMethod() where there is no current S4
generic function for this name does the setGeneric call for you.

The call to setGeneric with a `def' argument is usually needed only when
there is no function of the same name and/or you do not want an existing
function to be called as the default.

John

> I
> know that the above _works_, I am more looking for guidance on what is
> regarded as 'good practice' and will not lead to too many problems as the
> S3->S4 migration proceeds.  Any indication of the planned S3->S4 migration
> path
> and timetable would be a welcome bonus.
> 
> I realise that the second question has been aired before in different
> guises,
> but I regret to say I still do not know the answer.
> 
> I am using NT, and R1.7.1, for the above examples.
> 
> Regards
> 
> Giles Heywood
> Portfolio & Risk Advisory Group
> Commerzbank Securities
> 
> tel      + 44 20 7653 7009
> fax      + 44 20 7562 5347
> mobile + 44 7973 266343
> mailto:giles.heywood@commerzbankib.com
> 60 Gracechurch Street, London EC3V 0HR, U.K.
> http://www.cbksec.com/rsh/portfolio&risk.html
> 
> **********************************************************************
> This is a commercial communication from Commerzbank AG.\ \ T...{{dropped}}
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://www.stat.math.ethz.ch/mailman/listinfo/r-devel

-- 
John M. Chambers                  jmc@bell-labs.com
Bell Labs, Lucent Technologies    office: (908)582-2681
700 Mountain Avenue, Room 2C-282  fax:    (908)582-3340
Murray Hill, NJ  07974            web: http://www.cs.bell-labs.com/~jmc

From Giles.Heywood at CommerzbankIB.com  Thu Jul 10 12:13:08 2003
From: Giles.Heywood at CommerzbankIB.com (Heywood, Giles)
Date: Thu Jul 10 12:13:20 2003
Subject: [Rd] Packages, generics, S3 and S4
Message-ID: <8CBAA121CEB4D5118CB200508BB2BBEF5403DF@xmx8lonib.lonib.commerzbank.com>

Thank you for assistance on this.

I have created the empty file "install.R" in the right place, and used 

Rcmd build its --binary

If I then use 

Rcmd INSTALL its --save

Everything works fine, with the generics along with other functions listed 
when I do ls(2) and not when I do ls().

However if I load the zip using the menu in RGUI,I get different behaviour.

When I load the package, I get

> local({pkg <- select.list(sort(.packages(all.available = TRUE)))
+ if(nchar(pkg)) library(pkg, character.only=TRUE)})
Error in open.connection(con, "rb") : unable to open connection
In addition: Warning message: 
cannot open compressed file `C:/PROGRA~1/R/rw1071/library/its/R/all.rda' 
Error in library(pkg, character.only = TRUE) : 
        .First.lib failed

I have looked at ?install.packages, but cannot see the 'saved image' option,
equivalent to --save on Rcmd INSTALL.

Is the RGUI installation of the zip file a bad idea?  Or perhaps I have
missed
out some qualifier in the Rcmd build stage?

Another issue is the one I referred to before - that Rcmd CHECK still errors
on
the examples.  I can get around it of course using dontrun, but of course
this 
a workaround and not a solution.

I have re-read section 1.3 of 'Writing R Extensions' and still can't fathom
these out - any further help will be gratefully received.  If it is along
the lines of RTFM, a page or section reference would be appreciated :)

Regards

Giles Heywood
Portfolio & Risk Advisory Group
Commerzbank Securities

tel	 + 44 20 7653 7009
fax	 + 44 20 7562 5347
mobile + 44 7973 266343
mailto:giles.heywood@commerzbankib.com
60 Gracechurch Street, London EC3V 0HR, U.K.
http://www.cbksec.com/rsh/portfolio&risk.html

> -----Original Message-----
> From: John Chambers [mailto:jmc@research.bell-labs.com]
> Sent: 09 July 2003 19:07
> To: Heywood, Giles
> Cc: 'r-devel@stat.math.ethz.ch'
> Subject: Re: [Rd] Packages, generics, S3 and S4
> 
> 
> "Heywood, Giles" wrote:
> > 
> > My question has two parts.
> > 
> > The first is with regard to the frame or environment in 
> which generic
> > functions are defined in packages.  It seems as though they 
> are defined
> > (i.e. exist as objects) in frame 1, even when defined in a package.
> 
> (Frame 1 is an S-Plus concept; presumably you mean the global
> environment, the first element in the search path.)
> 
> It seems likely you are not using the "saved image" option in the
> INSTALL command, which you should use if your package has S4 
> classes or
> methods.
> 
> The simple solution is to have a file called "install.R" in your main
> package directory (not in the R/ subdirectory).  For most 
> packages, the
> file can be empty.  See the online documentation for INSTALL 
> (but ignore
> the comment about having require(methods) in the install.R 
> file; this is
> out of date since the methods package is normally included by default
> now).
> 
> Standard calls to setClass, setMethod, etc. will then save the
> definitions in an image file that is loaded when the package is
> attached.  You need this, otherwise the definitions (currently) go to
> the global environment.  That part will be fixed, but you 
> want to use a
> saved image anyway, since otherwise the call to library() for the
> package will be much slower.
> 
> > 
> > The following is a short example:
> > 
> > setClass("track",representation(x="numeric",y="numeric"))
> > plotTrack <- function(x,y,...) 
> plot(x@x,x@y,xlab="",ylab="Value",...)
> > setGeneric("plotT",def=function(x,y,...) standardGeneric("plotT"))
> > setMethod("plotT",signature(x="track",y="missing"),plotTrack)
> > 
> > This which works with my 'examples', as follows:
> > 
> > x <- new("track",x=1:10,y=rnorm(10))
> > plotT(x)
> > 
> > The above also passes Rcmd CHECK with the following 
> warnings, which I
> > think are not related to my main question:
> > 
> > Undocumented code objects: "plotTrack"
> > Objects with usage in documentation object 'track' but 
> missing from code:
> > "plotT"
> > 
> > Slightly more worrying, I get the following:
> > 
> > * checking examples ... ERROR
> > Running examples failed.
> > 
> > Ignoring this (only for the time being), I now do 'make pkg-track',
> > and encounter no errors.  Loading the package, my 
> 'examples' work fine.
> > Returning to the ERROR, it is clear how this has come about.
> > 
> > ls(.GlobalEnv)
> > [1] "plotT"
> > 
> > So the genericFunction object plotT resides in frame 1  
> i.e. .GlobalEnv.
> > It gets deleted when cleanEx(env=.GlobalEnv) does its job 
> in Rcmd CHECK.
> > 
> > The other object defined in this package, plotTrack, is in frame 2:
> > 
> > ls(2)
> > [1] "plotTrack"
> > 
> > I have tried unsuccessfully to put the genericFunction 
> object plotT into
> > frame 2, using the 'where' argument in setGeneric.  To cut 
> a long story
> > short, I can put it anywhere _except_ frame 2.
> > 
> > Now it seems to me that I am barking up the wrong tree, but 
> I don't know
> > how to proceed.  Any guidance will be gratefully received.
> > 
> > The second part of my question is this.  I clearly want to 
> define a plot
> > method (not naming it plotT)for the 'track' class, which 
> indeed is what
> > is described in the 'Green Book' p43.  However the 'Green 
> Book' is largely
> > unencumbered by S3 methods AFAIK.  Venables & Ripley (2000) 
> addresses the
> > issue of defining an S4 generic on the same name as an S3 
> generic on p108.
> > 
> > setMethod("plot",signature(x="fungi",y="missing"),plot.fungi)
> > 
> > This clearly works, but I am not clear whether the 
> definition of an S4
> > generic
> > 'on top of' i.e. with the same name 'plot' as an S3 generic 
> (as in the
> > example
> > above) is generally regarded as bad practice, or is quite 
> OK.  If it is
> > done,
> > is the above a suitable template, or should the 'def' 
> argument be used?  
> 
> Generally, an S3 "generic" function (i.e., a function that calls
> UseMethod()) is not much different from an ordinary function 
> with no S3
> methods, so far as defining S4 methods is concerned.
> 
> Either way
> 
>   setGeneric("plot")
> 
> creates a new generic function and makes the current function the
> default method.  A call to setMethod() where there is no current S4
> generic function for this name does the setGeneric call for you.
> 
> The call to setGeneric with a `def' argument is usually 
> needed only when
> there is no function of the same name and/or you do not want 
> an existing
> function to be called as the default.
> 
> John
> 
> > I
> > know that the above _works_, I am more looking for guidance 
> on what is
> > regarded as 'good practice' and will not lead to too many 
> problems as the
> > S3->S4 migration proceeds.  Any indication of the planned 
> S3->S4 migration
> > path
> > and timetable would be a welcome bonus.
> > 
> > I realise that the second question has been aired before in 
> different
> > guises,
> > but I regret to say I still do not know the answer.
> > 
> > I am using NT, and R1.7.1, for the above examples.
> > 
> > Regards
> > 
> > Giles Heywood
> > Portfolio & Risk Advisory Group
> > Commerzbank Securities
> > 
> > tel      + 44 20 7653 7009
> > fax      + 44 20 7562 5347
> > mobile + 44 7973 266343
> > mailto:giles.heywood@commerzbankib.com
> > 60 Gracechurch Street, London EC3V 0HR, U.K.
> > http://www.cbksec.com/rsh/portfolio&risk.html
> > 
> > 
> **********************************************************************
> > This is a commercial communication from Commerzbank AG.\ \ 
> T...{{dropped}}
> > 
> > ______________________________________________
> > R-devel@stat.math.ethz.ch mailing list
> > https://www.stat.math.ethz.ch/mailman/listinfo/r-devel
> 
> -- 
> John M. Chambers                  jmc@bell-labs.com
> Bell Labs, Lucent Technologies    office: (908)582-2681
> 700 Mountain Avenue, Room 2C-282  fax:    (908)582-3340
> Murray Hill, NJ  07974            web: 
> http://www.cs.bell-labs.com/~jmc
> 


********************************************************************** 
This is a commercial communication from Commerzbank AG.\ \ T...{{dropped}}

From brahm at alum.mit.edu  Fri Jul 11 21:30:16 2003
From: brahm at alum.mit.edu (brahm@alum.mit.edu)
Date: Fri Jul 11 20:30:09 2003
Subject: [Rd] Title obscured when using par(mfrow) (PR#3463)
Message-ID: <200307111830.h6BIUGJH001599@pubhealth.ku.dk>

I want to put multiple plots on a page using par(mfrow), then a single title at
the top.  This should work, but doesn't:

 R> par(oma=c(0,0,4,0), mfrow=c(3,4))
 R> for (i in 1:12) {plot(1); title(i)}
 R> ## text(10,10, ".")
 R> par(mfrow=c(1,1), oma=c(0,0,1,0))
 R> title("Main Title")

The main title does not appear.  However, uncommenting the third line (making
an otherwise superfluous call to "text") fixes the problem.

This seems to be true regardless of whether my device is x11, postscript, or
pdf.  The diff of the Postscript files (without and with the "text" command)
may be illuminating to some experts:

  mica> diff bug.ps nobug.ps 
  1083a1084,1085
  > 623.97 66.47 754.04 158.36 cl
  > 18.00 18.00 774.00 579.60 cl
  1084a1087
  > 0 0 0 rgb

Finally, here's an interesting variation, in which only the left side of the
title is obscured:

 R> par(mfrow=c(1,2))
 R> for (i in 1:2) plot(1)
 R> ## text(10,10, ".")
 R> par(mfrow=c(1,1))
 R> title("Main Title")

Again, uncommenting the third line allows the full title to appear.


Version:
 platform = sparc-sun-solaris2.8
 arch = sparc
 os = solaris2.8
 system = sparc, solaris2.8
 status = 
 major = 1
 minor = 7.1
 year = 2003
 month = 06
 day = 16
 language = R

Search Path:
 .GlobalEnv, package:misc, package:io, package:arrays, package:ls1, package:obsi, package:g.data, package:db, package:ts, package:ctest, Autoloads, package:base
-- 
                              -- David Brahm (brahm@alum.mit.edu)

From nakama at ki.rim.or.jp  Sat Jul 12 09:54:41 2003
From: nakama at ki.rim.or.jp (nakama@ki.rim.or.jp)
Date: Sat Jul 12 08:54:45 2003
Subject: [Rd] finename length no check (PR#3466)
Message-ID: <200307120654.h6C6sfJH004343@pubhealth.ku.dk>

Full_Name: Ei-ji Nakama
Version: R-1.7.1
OS: Linux
Submission from: (NULL) (219.117.236.13)


> filename <- "----+----1----+----2----+----3----+----4----+----5----+----6----
+----7----+----8----+----9----+----0----+----1----+----2----+----3----+----4---
-+----5----+----6----+----7----+----8----+----9----+----0----+----1----+----2--
--+----3----+----4----+----5----+----6----+----7----+----8----+----9----+----0-
---+----1----+----2----+----3----+----4----+----5----+----6----+----7----+----8
----+----9----+----0----+----1----+----2----+----3----+----4----+----5----+----
6----+----7----+----8----+----9----+----0----+----1----+----2"
> png(file=filename,width=100,height=100,pointsize=12)
Segmentation fault

src/modules/X11/devX11.c

From ligges at statistik.uni-dortmund.de  Sat Jul 12 16:09:29 2003
From: ligges at statistik.uni-dortmund.de (Uwe Ligges)
Date: Sat Jul 12 15:08:46 2003
Subject: [Rd] Title obscured when using par(mfrow) (PR#3463)
In-Reply-To: <200307111830.h6BIUGJH001599@pubhealth.ku.dk>
References: <200307111830.h6BIUGJH001599@pubhealth.ku.dk>
Message-ID: <3F100889.1030807@statistik.uni-dortmund.de>

brahm@alum.mit.edu wrote:

> I want to put multiple plots on a page using par(mfrow), then a single title at
> the top.  This should work, but doesn't:
> 
>  R> par(oma=c(0,0,4,0), mfrow=c(3,4))
>  R> for (i in 1:12) {plot(1); title(i)}
>  R> ## text(10,10, ".")
>  R> par(mfrow=c(1,1), oma=c(0,0,1,0))
>  R> title("Main Title")

It's a clipping issue. Setting par(mfrow) twice is not documented to 
work. I wouldn't call it a bug.
Use mtext() instead of title() as in:

  par(oma=c(0,0,4,0), mfrow=c(3,4))
  for (i in 1:12) {plot(1); title(i)}
  par(mfrow=c(1,1), oma=c(0,0,1,0))
  mtext("Main Title", 3, outer = TRUE, cex = par("cex.main"))

The same for the example given below.

Uwe Ligges

> The main title does not appear.  However, uncommenting the third line (making
> an otherwise superfluous call to "text") fixes the problem.
> 
> This seems to be true regardless of whether my device is x11, postscript, or
> pdf.  The diff of the Postscript files (without and with the "text" command)
> may be illuminating to some experts:
> 
>   mica> diff bug.ps nobug.ps 
>   1083a1084,1085
>   > 623.97 66.47 754.04 158.36 cl
>   > 18.00 18.00 774.00 579.60 cl
>   1084a1087
>   > 0 0 0 rgb
> 
> Finally, here's an interesting variation, in which only the left side of the
> title is obscured:
> 
>  R> par(mfrow=c(1,2))
>  R> for (i in 1:2) plot(1)
>  R> ## text(10,10, ".")
>  R> par(mfrow=c(1,1))
>  R> title("Main Title")
> 
> Again, uncommenting the third line allows the full title to appear.
> 
> 
> Version:
>  platform = sparc-sun-solaris2.8
>  arch = sparc
>  os = solaris2.8
>  system = sparc, solaris2.8
>  status = 
>  major = 1
>  minor = 7.1
>  year = 2003
>  month = 06
>  day = 16
>  language = R
> 
> Search Path:
>  .GlobalEnv, package:misc, package:io, package:arrays, package:ls1, package:obsi, package:g.data, package:db, package:ts, package:ctest, Autoloads, package:base

From smiles at dept.econ.yorku.ca  Sun Jul 13 06:52:00 2003
From: smiles at dept.econ.yorku.ca (smiles@dept.econ.yorku.ca)
Date: Sun Jul 13 05:52:07 2003
Subject: [Rd] Problems Simulating (PR#3471)
Message-ID: <200307130352.h6D3q0JH008827@pubhealth.ku.dk>

Full_Name: Stan Miles
Version: 1.5.0.
OS: Windows 2000 Server
Submission from: (NULL) (130.63.74.220)


Short Description of the Problem:  

I use R to simulate a random variable, with mean 0.14 and variance 0.2 .  I
simulate 20 sets, 30000 realizations/set.
I take the average of each set, and all 20 of the averages are 
much higher than 0.14.  In fact, they are All about 2-3 stdev higher. 
It seems that R is not generating the random variable with the mean I ask for.

The Details:

I simulate Prices [Pt] and Returns that are defined as 
Rt = [P(t)-P(t-1)]/P(t-1).  The returns have Normal distribution
=>  Rt is has N(mu=0.14, sigmaSquared=0.2) distribution.

To do the task above, I use the following files:

c:\ProgramFiles\R\rw1050\Code1.txt

consists of the following text:

====================
gpsim1_function(t,runs,mu,delta,stdev){
jold=0
xx_rep(0,t*runs)
for(i in 1:runs){
ind=(i-1)*t
xx[ind+1]=1
for(j in 2:t) {
xx[ind+j]_xx[ind+j-1]*
exp(rnorm(n=1,mean=mu*delta*delta,sd=stdev*delta))
}
}
xx

}

=======================

File "experiment4commands.txt" has text:

source("code1.txt")
aa=gpsim1(30000,1,0.14,0.052342392,0.4472135955)
sink("experiment4mu14z20Path1.txt")
for(i in 1:length(aa)){print(aa[i])}
sink()

source("code1.txt")
aa=gpsim1(30000,1,0.14,0.052342392,0.4472135955)
sink("experiment4mu14z20Path2.txt")
for(i in 1:length(aa)){print(aa[i])}
sink()

:
:
:

source("code1.txt")
aa=gpsim1(30000,1,0.14,0.052342392,0.4472135955)
sink("experiment4mu14z20Path20.txt")
for(i in 1:length(aa)){print(aa[i])}
sink()
=========================
{Above, 0.052342392 = 1/365, it is my discretization factor.}


I paste the text from the "experiment4commands.txt" file into R.

I now open each of the resulting 20 files in Excel.  The output [with 
variable Pt] is located in column B.  To get back Rt, I paste
the following formula into cells C2:C30000 - 
Ci = [B(i)-B(i-1)]/B(i-1).

My discretization factor was 1/365, thus, when I take the Average 
[and the Variance] of cells C2:C30000, I also have to multiply this 
number by 365, to get back the annual Rt.

I then made a table of the resulting 365*Average(C2:C30000), for each
of the 20 Sets that I have simulated using the methodology described above.


Set     365*Average(C2:C30000) for the set

1	0.284948
2	0.238827892
3	0.176492
4	0.242007
5	0.263882
6	0.211672
7	0.203536
8	0.19211
9	0.225185
10	0.234478
11	0.272792
12	0.205158
13	0.189349
14	0.222317
15	0.220652
16	0.165553
17	0.294211
18	0.333488
19	0.147971
20	0.290742

The average of the realizations of mu [true value = 0.14] over 
20 paths, each with 30000 observations, is about 0.23.

For this case, daily mu = mu over each algorithm step
is 0.14/365 = 0.0003835616438

The daily variance is 0.2/365 = 0.0005479452055

However, according to statistics, as the number of observations increases
variance will fall.  In particular, for 30,000 observations, the 
StDev is calculated as follows:  

SQRT(0.2/365)/SQRT(30000) = 0.0001351474 = {1 STDEV}

The average of the values in the table above, 0.23, is

[(0.23/365) - (0.14/365)]/0.0001351474 = 1.824 StDeviations above the mean.
As you can see Most of the 20 sets had realized values about 2-3 StDeviations
higher than the mean.

Something is wrong.

Thank you for considering this bug report.

From p.dalgaard at biostat.ku.dk  Sun Jul 13 11:31:32 2003
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard BSA)
Date: Sun Jul 13 12:31:34 2003
Subject: [Rd] Problems Simulating (PR#3471)
In-Reply-To: <200307130352.h6D3q0JH008827@pubhealth.ku.dk>
References: <200307130352.h6D3q0JH008827@pubhealth.ku.dk>
Message-ID: <x2vfu6af6b.fsf@biostat.ku.dk>

smiles@dept.econ.yorku.ca writes:

> [(0.23/365) - (0.14/365)]/0.0001351474 = 1.824 StDeviations above the mean.
> As you can see Most of the 20 sets had realized values about 2-3 StDeviations
> higher than the mean.
> 
> Something is wrong.
> 
> Thank you for considering this bug report.

This is not a bug report. It is a request for finding the bug or
logical error in your code. If you had had a real bug to report, you
should have investigated more carefully and boiled it down to a much
simpler example. In particular, it is not a good idea to require the
use of commercial software on one particular computing platform to
reproduce your results when the same operations could just as easily
have been done in R.

Your R version is getting a bit old, BTW. The pre-1.7.x random
number generators had problems, but not of this magnitude.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From dmurdoch at pair.com  Mon Jul 14 07:53:45 2003
From: dmurdoch at pair.com (Duncan Murdoch)
Date: Mon Jul 14 12:53:37 2003
Subject: [Rd] Re: [R] How to install a package
In-Reply-To: <3F124CEA.9010804@statistik.uni-dortmund.de>
References: <000801c34987$292c0830$bf3d9f88@pcrui>
	<seo3hvoioladlcvp0cd9vsu3575dajh66f@4ax.com>
	<3F124CEA.9010804@statistik.uni-dortmund.de>
Message-ID: <1m25hvcljup3s516vik5ekenkq7k9dn2te@4ax.com>

On Mon, 14 Jul 2003 08:25:46 +0200, you wrote:

>more precisely, lasso2 fails make check on Windows when compiled without 
>modifications, as mentioned in CRAN/bin/windows/contrib/1.7/ReadMe .

Uwe, do you think it would be helpful to display this information from
Rgui?  That is, put the whole list of packages into the menu, but mark
some of them as unavailable and display the explanation if those are
selected?  I'd guess lots of Rgui users never look at the binary
directory themselves, they let Rgui do it.

Duncan Murdoch

From ligges at statistik.uni-dortmund.de  Mon Jul 14 14:10:11 2003
From: ligges at statistik.uni-dortmund.de (Uwe Ligges)
Date: Mon Jul 14 13:09:14 2003
Subject: [Rd] Re: [R] How to install a package
In-Reply-To: <1m25hvcljup3s516vik5ekenkq7k9dn2te@4ax.com>
References: <000801c34987$292c0830$bf3d9f88@pcrui>	<seo3hvoioladlcvp0cd9vsu3575dajh66f@4ax.com>	<3F124CEA.9010804@statistik.uni-dortmund.de>
	<1m25hvcljup3s516vik5ekenkq7k9dn2te@4ax.com>
Message-ID: <3F128F93.4020600@statistik.uni-dortmund.de>

Duncan Murdoch wrote:

> On Mon, 14 Jul 2003 08:25:46 +0200, you wrote:
> 
> 
>>more precisely, lasso2 fails make check on Windows when compiled without 
>>modifications, as mentioned in CRAN/bin/windows/contrib/1.7/ReadMe .
> 
> 
> Uwe, do you think it would be helpful to display this information from
> Rgui?  That is, put the whole list of packages into the menu, but mark
> some of them as unavailable and display the explanation if those are
> selected?  I'd guess lots of Rgui users never look at the binary
> directory themselves, they let Rgui do it.

Good idea.
Probably easier: Everything as is, but as one uses "Install ...." or 
"Update packages from CRAN", just display the ReadMe in a pager (needs 
~2 lines of code). What about Bioconductor?

Anyway, the question arises what to do with the functions 
install.packages(), update.packages()? People might use it in BATCH mode 
or from Rterm ...

Uwe

From thoffman at zappa.sax.de  Tue Jul 15 01:21:16 2003
From: thoffman at zappa.sax.de (Thomas Hoffmann)
Date: Tue Jul 15 00:13:27 2003
Subject: [Rd] R-1.7.1: modules/X11/X11.c: Rf_allocX11DeviceDesc()
Message-ID: <3F132CDC.3030406@zappa.sax.de>

Just curious: The above mentioned function is identical to Rf_allocNewX11DeviceDesc() and is neither used in X11.c nor declared in X11.h: What is the purpose of this function?

-- 
Thomas Hoffmann                                    Telephone: 49-351-4598831
thoffman@zappa.sax.de                                       Dresden, Germany

..sig under construction ...

From p.murrell at auckland.ac.nz  Tue Jul 15 11:25:26 2003
From: p.murrell at auckland.ac.nz (Paul Murrell)
Date: Tue Jul 15 00:25:33 2003
Subject: [Rd] R-1.7.1: modules/X11/X11.c: Rf_allocX11DeviceDesc()
References: <3F132CDC.3030406@zappa.sax.de>
Message-ID: <3F132DD6.5040604@stat.auckland.ac.nz>

Hi


Thomas Hoffmann wrote:
> Just curious: The above mentioned function is identical to 
> Rf_allocNewX11DeviceDesc() and is neither used in X11.c nor declared in 
> X11.h: What is the purpose of this function?


I don't think it has a purpose.  It must have been missed when cleaning 
out the old code after a restructuring.

Paul
-- 
Dr Paul Murrell
Department of Statistics
The University of Auckland
Private Bag 92019
Auckland
New Zealand
64 9 3737599 x85392
paul@stat.auckland.ac.nz

From jerome at hivnet.ubc.ca  Tue Jul 15 09:22:40 2003
From: jerome at hivnet.ubc.ca (jerome@hivnet.ubc.ca)
Date: Tue Jul 15 08:22:30 2003
Subject: [Rd] "na.action" parameter in princomp() (PR#3481)
Message-ID: <200307150622.h6F6MeJH024405@pubhealth.ku.dk>

Full_Name: Jerome Asselin
Version: 1.7.1
OS: Red Hat Linux 7.2
Submission from: (NULL) (24.77.125.119)



Setting the parameter na.action=na.omit should remove
incomplete records in princomp. However this does not
seem to work as expected. See example below.

Sincerely,
Jerome Asselin


data(USArrests)
princomp(USArrests, cor = TRUE) #THIS WORKS

USArrests[1,3] <- NA
princomp(USArrests, cor = TRUE, na.action=na.omit) #THIS FAILS!
#Error in cov.wt(z) : x must contain finite values only

From p.dalgaard at biostat.ku.dk  Tue Jul 15 08:21:16 2003
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard BSA)
Date: Tue Jul 15 09:21:19 2003
Subject: [Rd] "na.action" parameter in princomp() (PR#3481)
In-Reply-To: <200307150622.h6F6MeJH024405@pubhealth.ku.dk>
References: <200307150622.h6F6MeJH024405@pubhealth.ku.dk>
Message-ID: <x2u19o8d77.fsf@biostat.ku.dk>

jerome@hivnet.ubc.ca writes:

> Setting the parameter na.action=na.omit should remove
> incomplete records in princomp. However this does not
> seem to work as expected. See example below.
> 
> Sincerely,
> Jerome Asselin
> 
> 
> data(USArrests)
> princomp(USArrests, cor = TRUE) #THIS WORKS
> 
> USArrests[1,3] <- NA
> princomp(USArrests, cor = TRUE, na.action=na.omit) #THIS FAILS!
> #Error in cov.wt(z) : x must contain finite values only

You're not reading the help page properly. na.action is for formula
specification only:

Usage:

     princomp(formula, data = NULL, subset, na.action, ...)
     princomp(x, cor = FALSE, scores = TRUE, covmat = NULL,
              subset = rep(TRUE, nrow(as.matrix(x))), ...)

This works:

princomp(~.,data=USArrests, cor = TRUE, na.action=na.omit) 

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From michael.t.klinglesmith at intel.com  Tue Jul 15 19:56:24 2003
From: michael.t.klinglesmith at intel.com (michael.t.klinglesmith@intel.com)
Date: Tue Jul 15 18:56:21 2003
Subject: [Rd] Undefined subroutine &R::Rdconv::fill (PR#3485)
Message-ID: <200307151656.h6FGuOJH000875@pubhealth.ku.dk>

Full_Name: michael klinglemsith
Version: R-1.7.1
OS: linux
Submission from: (NULL) (134.134.136.4)


I run:  (note: ] is my unix prompt)
]./configure

It seems to work, here are the messages I get from the end of configure:
R is now configured for i686-pc-linux-gnu

  Source directory:          .
  Installation directory:    /usr/local

  C compiler:                gcc -D__NO_MATH_INLINES -mieee-fp -g -O2
  C++ compiler:              g++ -mieee-fp -g -O2
  Fortran compiler:          g77 -mieee-fp -g -O2

  Interfaces supported:      X11, tcltk
  External libraries:        readline
  Additional capabilities:   PNG, JPEG, bzip2, PCRE
  Options enabled:           R profiling

  Recommended packages:      yes

configure: WARNING: you cannot build info versions of the R manuals
configure: WARNING: you cannot build PDF versions of the R manuals

Next I run:
]make

I get this error (many times -- this is the first one):

make[1]: Leaving directory `/fs38/odc.arch.3/mtklingl/R/R-1.7.1/doc'
make[1]: Entering directory `/fs38/odc.arch.3/mtklingl/R/R-1.7.1/src/library'
building all R object docs (text, HTML, LaTeX, examples)
make[2]: Entering directory `/fs38/odc.arch.3/mtklingl/R/R-1.7.1/src/library'
Undefined subroutine &R::Rdconv::fill called at
/fs38/odc.arch.3/mtklingl/R/R-1.7.1/share/perl/R/Rdconv.pm line 1955, <rdfile>
chunk 381.

The make continues inspite of the errors until this point:

make[2]: Leaving directory `/tmp/R.INSTALL.11978/survival/src'
** R
** data
** inst
** help
Undefined subroutine &R::Rdconv::fill called at
/fs38/odc.arch.3/mtklingl/R/R-1.7.1/share/perl/R/Rdconv.pm line 1955, <rdfile>
chunk 436.
make[1]: *** [survival.ts] Error 6
 >>> Building/Updating help pages for package 'survival'
     Formats: text html latex example
ERROR: building help failed for package 'survival'
make[1]: Leaving directory
`/fs38/odc.arch.3/mtklingl/R/R-1.7.1/src/library/Recommended'
make: *** [stamp-recommended] Error 2
]


Here are the OS and tool versions I have:


]uname -a
Linux plxc1679 2.4.9-41lxset1 #1 Mon Mar 31 11:19:02 PST 2003 i686 unknown
]make -v
GNU Make version 3.79.1, by Richard Stallman and Roland McGrath.
Built for i386-redhat-linux-gnu
Copyright (C) 1988, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 2000
        Free Software Foundation, Inc.
This is free software; see the source for copying conditions.
There is NO warranty; not even for MERCHANTABILITY or FITNESS FOR A
PARTICULAR PURPOSE.

Report bugs to <bug-make@gnu.org>.

]perl -v

This is perl, version 5.004_04 built for i386_linux22

Copyright 1987-1997, Larry Wall

Perl may be copied only under the terms of either the Artistic License or the
GNU General Public License, which may be found in the Perl 5.0 source kit.

]gcc -v
Reading specs from /usr/intel/pkgs/gcc/3.1/lib/gcc-lib/i686-pc-linux-gnu/3.1/specs
Configured with: ../gcc-3.1/configure --prefix=/usr/intel/pkgs/gcc/3.1
--enable-shared --enable-threads --with-gnu-as
--with-as=/usr/intel/pkgs/gcc/3.1/bin/gas --with-gnu-ld
--with-ld=/usr/intel/pkgs/gcc/3.1/bin/gld
Thread model: posix
gcc version 3.1
]

From roger at ysidro.econ.uiuc.edu  Tue Jul 15 16:37:12 2003
From: roger at ysidro.econ.uiuc.edu (Roger Koenker)
Date: Tue Jul 15 22:31:08 2003
Subject: [Rd] Rprof
Message-ID: <Pine.SOL.4.30.0307151534180.4106-100000@ysidro.econ.uiuc.edu>

I find it difficult to find Rprof using the usual search tools...
could I suggest that it be cross-referenced to profile Rprofile
Profile to make this easier?


url:	www.econ.uiuc.edu/~roger/my.html	Roger Koenker
email	rkoenker@uiuc.edu			Department of Economics
vox: 	217-333-4558				University of Illinois
fax:   	217-244-6678				Champaign, IL 61820

From bernhard.pfaff at t-online.de  Tue Jul 15 21:45:56 2003
From: bernhard.pfaff at t-online.de (Bernhard Dr. Pfaff)
Date: Tue Jul 15 22:45:58 2003
Subject: [Rd] R CMD check 'package-name' failed   
Message-ID: <200303191555.03805.bernhard.pfaff@t-online.de>

Dear Devel-list member,

by checking a small exemplatory package during the DSC2003 in Vienna I 
encountered the following error message (see attachment). Thomas Lumley has 
suggested to me posting the problem to this list. You help is appreciated.

Cheers,
Bernhard


System:
machine: i386
OS: Suse 8.1
R: 1.6.2
-------------- next part --------------
* checking for working latex ... OK
* using log directory '/home/bp/R/dsc/DSC2003.Rcheck'
* checking for file 'DSC2003/DESCRIPTION' ... OK
* checking if this is a source package ... OK

* Installing *source* package 'DSC2003' ...
** R
** data
** help
 >>> Building/Updating help pages for package 'DSC2003'
     Formats: text html latex example 
  Formaldehyde                      text    html    latex   example
  dsc2003                           text    html    latex   example
* DONE (DSC2003)

* DONE (INSTALL)

* checking package directory ... OK
* checking for sufficient/correct file permissions ... OK
* checking DESCRIPTION Package field ... OK
* checking DESCRIPTION Version field ... OK
* checking DESCRIPTION License field ... OK
* checking DESCRIPTION Description field ... OK
* checking DESCRIPTION Title field ... OK
* checking DESCRIPTION Author field ... OK
* checking DESCRIPTION Maintainer field ... OK
* checking index files ... OK
* checking R files for syntax errors ... OK
* checking R files for library.dynam ... OK
* checking generic/method consistency ... WARNING
Error in .find.package(package, lib.loc) : 
	none of the packages were found
Execution halted
* checking for assignment functions with final arg not named 'value' ... WARNING
Error in .find.package(package, lib.loc) : 
	none of the packages were found
Execution halted
* checking Rd files ... OK
* checking for undocumented objects ... ERROR
Error in .find.package(package, lib.loc) : 
From gregory_r_warnes at groton.pfizer.com  Tue Jul 15 18:01:36 2003
From: gregory_r_warnes at groton.pfizer.com (Warnes, Gregory R)
Date: Tue Jul 15 23:01:40 2003
Subject: [Rd] How to do get verbatim in Rd files
Message-ID: <D7A3CFD7825BD6119B880002A58F06C20680A4B7@groexmb02.pfizer.com>


I want to include a multi-line code block in the details section of a R
manual page.  How do I get an appropriate verbatim-like environment?
\verbatim{...} doesn't do the trick,  neither does \code{...}.

-Greg


LEGAL NOTICE\ Unless expressly stated otherwise, this messag...{{dropped}}

From roger at ysidro.econ.uiuc.edu  Tue Jul 15 17:34:19 2003
From: roger at ysidro.econ.uiuc.edu (Roger Koenker)
Date: Tue Jul 15 23:28:57 2003
Subject: [Rd] friday lunch
Message-ID: <Pine.SOL.4.30.0307151616261.4395-100000@ysidro.econ.uiuc.edu>

Greetings,

I'm organizing summer econometrics lunch meetings to discuss thesis
work.  The first meeting will be this friday July 18 12-1pm in the
conference room on the third floor of Wohlers.  The first talk will
be by Lingjie Ma

	Control Variate Estimation of Structural Quantile Regression Models



url:	www.econ.uiuc.edu/~roger/my.html	Roger Koenker
email	rkoenker@uiuc.edu			Department of Economics
vox: 	217-333-4558				University of Illinois
fax:   	217-244-6678				Champaign, IL 61820

From p.dalgaard at biostat.ku.dk  Tue Jul 15 23:28:08 2003
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard BSA)
Date: Wed Jul 16 00:28:11 2003
Subject: [Rd] Undefined subroutine &R::Rdconv::fill (PR#3485)
In-Reply-To: <200307151656.h6FGuOJH000875@pubhealth.ku.dk>
References: <200307151656.h6FGuOJH000875@pubhealth.ku.dk>
Message-ID: <x2ptkb8ls3.fsf@biostat.ku.dk>

michael.t.klinglesmith@intel.com writes:

> make[1]: Leaving directory `/fs38/odc.arch.3/mtklingl/R/R-1.7.1/doc'
> make[1]: Entering directory `/fs38/odc.arch.3/mtklingl/R/R-1.7.1/src/library'
> building all R object docs (text, HTML, LaTeX, examples)
> make[2]: Entering directory `/fs38/odc.arch.3/mtklingl/R/R-1.7.1/src/library'
> Undefined subroutine &R::Rdconv::fill called at
> /fs38/odc.arch.3/mtklingl/R/R-1.7.1/share/perl/R/Rdconv.pm line 1955, <rdfile>
> chunk 381.
....
> ]perl -v
> 
> This is perl, version 5.004_04 built for i386_linux22
> 
> Copyright 1987-1997, Larry Wall

I would suspect that this is the culprit. We do check that the perl
version is at least 5.004 so we expect your version to work, but on
the other hand it is quite old (~ 6 years it would seem) and quite
likely noone actually checked against that version when making changes
to Rdconv.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From dmurdoch at pair.com  Tue Jul 15 19:57:45 2003
From: dmurdoch at pair.com (Duncan Murdoch)
Date: Wed Jul 16 00:57:38 2003
Subject: [Rd] Rprof
In-Reply-To: <Pine.SOL.4.30.0307151534180.4106-100000@ysidro.econ.uiuc.edu>
References: <Pine.SOL.4.30.0307151534180.4106-100000@ysidro.econ.uiuc.edu>
Message-ID: <prs8hvsaiq6hj3j6rod6cm64idlicbvip6@4ax.com>

On Tue, 15 Jul 2003 15:37:12 -0500 (CDT), you wrote:

>I find it difficult to find Rprof using the usual search tools...
>could I suggest that it be cross-referenced to profile Rprofile
>Profile to make this easier?

There are several cases like this, where obvious search words actually
have nothing to do with the topic of interest.  Besides "profile", I
can think of these:

prompt -> readline
bitmap -> image
delay -> ?? (how to pause R for a given number of seconds?)
flush -> flush.console
page -> frame
(mod) -> Arithmetic
power -> Arithmetic
(read) -> readLines
Rprofile -> Rprof
scale -> par
(cd) -> setwd

(Here I've parenthesized search words that don't work at all.)

I think there should be "see also" links from the topics on the left
to the topics on the right; I'll add these to the R-devel version.
I'm not so sure it makes sense to make aliases for the "missing"
search words.  Opinions?  Other suggestions for similar improvements
to the help pages?

Duncan Murdoch

From ldimitro at wfubmc.edu  Tue Jul 15 19:58:35 2003
From: ldimitro at wfubmc.edu (Latchezar Dimitrov)
Date: Wed Jul 16 00:58:34 2003
Subject: [Rd] friday lunch
Message-ID: <F160BE32A2E5E04497668BBDFE83FEDF0648A488@EXCHVS1.medctr.ad.wfubmc.edu>

OK. I'm in :-)

> -----Original Message-----
> From: Roger Koenker [mailto:roger@ysidro.econ.uiuc.edu] 
> Sent: Tuesday, July 15, 2003 5:34 PM
> To: Lingie Ma; r-devel@stat.math.ethz.ch; Carlos Lamarche; 
> Roberto Perrelli
> Cc: Zhijie Xiao; Roger Koenker
> Subject: [Rd] friday lunch
> 
> 
> Greetings,
> 
> I'm organizing summer econometrics lunch meetings to discuss 
> thesis work.  The first meeting will be this friday July 18 
> 12-1pm in the conference room on the third floor of Wohlers.  
> The first talk will be by Lingjie Ma
> 
> 	Control Variate Estimation of Structural Quantile 
> Regression Models
> 
> 
> 
> url:	www.econ.uiuc.edu/~roger/my.html	Roger Koenker
> email	rkoenker@uiuc.edu			Department of Economics
> vox: 	217-333-4558				University of Illinois
> fax:   	217-244-6678				
> Champaign, IL 61820
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list 
> https://www.stat.math.ethz.ch/mailman/listi> nfo/r-devel
>

From shitao at ucla.edu  Wed Jul 16 02:27:27 2003
From: shitao at ucla.edu (shitao@ucla.edu)
Date: Wed Jul 16 01:27:20 2003
Subject: [Rd] The two chisq.test p values differ when the contingency table
	is transposed! (PR#3486)
Message-ID: <200307152327.h6FNRRJH002977@pubhealth.ku.dk>

Full_Name: Tao Shi
Version: 1.7.0
OS: Windows XP Professional
Submission from: (NULL) (149.142.163.65)


> x
     [,1] [,2]
[1,]  149  151
[2,]    1    8
> c2x<-chisq.test(x, simulate.p.value=T, B=100000)$p.value
> for(i in (1:20)){c2x<-c(c2x,chisq.test(x,
simulate.p.value=T,B=100000)$p.value)}
> c2tx<-chisq.test(t(x), simulate.p.value=T, B=100000)$p.value
> for(i in (1:20)){c2tx<-c(c2tx,chisq.test(t(x), simulate.p.value=T,
+ B=100000)$p.value)}
> cbind(c2x,c2tx)
          c2x    c2tx
 [1,] 0.03711 0.01683
 [2,] 0.03717 0.01713
 [3,] 0.03709 0.01609
 [4,] 0.03833 0.01657
 [5,] 0.03696 0.01668
 [6,] 0.03698 0.01660
 [7,] 0.03704 0.01805
 [8,] 0.03731 0.01699
 [9,] 0.03746 0.01683
[10,] 0.03671 0.01676
[11,] 0.03589 0.01689
[12,] 0.03684 0.01670
[13,] 0.03678 0.01709
[14,] 0.03742 0.01658
[15,] 0.03734 0.01664
[16,] 0.03723 0.01778
[17,] 0.03690 0.01615
[18,] 0.03650 0.01621
[19,] 0.03759 0.01740
[20,] 0.03712 0.01653
[21,] 0.03788 0.01702

From michael.t.klinglesmith at intel.com  Tue Jul 15 17:53:39 2003
From: michael.t.klinglesmith at intel.com (Klinglesmith, Michael T)
Date: Wed Jul 16 01:53:53 2003
Subject: [Rd] Undefined subroutine &R::Rdconv::fill (PR#3485)
Message-ID: <D3A3AA459175A44CB5326F26DA7A189C0145FA3D@orsmsx405.jf.intel.com>

Yes you do seem to be correct.  

I have pointed to a new version of perl (v5.6.1) and it builds cleanly

Thank you,
Michael.

-----Original Message-----
From: Peter Dalgaard BSA [mailto:p.dalgaard@biostat.ku.dk] 
Sent: Tuesday, July 15, 2003 3:31 PM
To: Klinglesmith, Michael T
Cc: r-devel@stat.math.ethz.ch; R-bugs@biostat.ku.dk
Subject: Re: [Rd] Undefined subroutine &R::Rdconv::fill (PR#3485)


michael.t.klinglesmith@intel.com writes:

> make[1]: Leaving directory `/fs38/odc.arch.3/mtklingl/R/R-1.7.1/doc'
> make[1]: Entering directory
`/fs38/odc.arch.3/mtklingl/R/R-1.7.1/src/library'
> building all R object docs (text, HTML, LaTeX, examples)
> make[2]: Entering directory
`/fs38/odc.arch.3/mtklingl/R/R-1.7.1/src/library'
> Undefined subroutine &R::Rdconv::fill called at
> /fs38/odc.arch.3/mtklingl/R/R-1.7.1/share/perl/R/Rdconv.pm line 1955,
<rdfile>
> chunk 381.
....
> ]perl -v
> 
> This is perl, version 5.004_04 built for i386_linux22
> 
> Copyright 1987-1997, Larry Wall

I would suspect that this is the culprit. We do check that the perl
version is at least 5.004 so we expect your version to work, but on
the other hand it is quite old (~ 6 years it would seem) and quite
likely noone actually checked against that version when making changes
to Rdconv.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From roger at ysidro.econ.uiuc.edu  Tue Jul 15 21:02:33 2003
From: roger at ysidro.econ.uiuc.edu (Roger Koenker)
Date: Wed Jul 16 02:56:20 2003
Subject: [Rd] apologies
Message-ID: <Pine.SOL.4.30.0307152000120.4836-100000@ysidro.econ.uiuc.edu>

My apologies for the misdirected seminar announcement...


url:	www.econ.uiuc.edu/~roger/my.html	Roger Koenker
email	rkoenker@uiuc.edu			Department of Economics
vox: 	217-333-4558				University of Illinois
fax:   	217-244-6678				Champaign, IL 61820

From hornik at ci.tuwien.ac.at  Wed Jul 16 08:36:26 2003
From: hornik at ci.tuwien.ac.at (Kurt Hornik)
Date: Wed Jul 16 07:38:41 2003
Subject: [Rd] Undefined subroutine &R::Rdconv::fill (PR#3485)
In-Reply-To: <x2ptkb8ls3.fsf@biostat.ku.dk>
References: <200307151656.h6FGuOJH000875@pubhealth.ku.dk>
	<x2ptkb8ls3.fsf@biostat.ku.dk>
Message-ID: <16148.58458.680003.755101@mithrandir.hornik.net>

>>>>> Peter Dalgaard BSA writes:

> michael.t.klinglesmith@intel.com writes:
>> make[1]: Leaving directory `/fs38/odc.arch.3/mtklingl/R/R-1.7.1/doc'
>> make[1]: Entering directory `/fs38/odc.arch.3/mtklingl/R/R-1.7.1/src/library'
>> building all R object docs (text, HTML, LaTeX, examples)
>> make[2]: Entering directory `/fs38/odc.arch.3/mtklingl/R/R-1.7.1/src/library'
>> Undefined subroutine &R::Rdconv::fill called at
>> /fs38/odc.arch.3/mtklingl/R/R-1.7.1/share/perl/R/Rdconv.pm line 1955, <rdfile>
>> chunk 381.
> ....
>> ]perl -v
>> 
>> This is perl, version 5.004_04 built for i386_linux22
>> 
>> Copyright 1987-1997, Larry Wall

> I would suspect that this is the culprit. We do check that the perl
> version is at least 5.004 so we expect your version to work, but on
> the other hand it is quite old (~ 6 years it would seem) and quite
> likely noone actually checked against that version when making changes
> to Rdconv.

Actually ...

It seems that Text::Wrap::fill() was added between 5.004_04 and
5.004_05.  I had not realized that the former was an official release.

We can

* Try to special-case 5.004_04 and provide the version of fill()
  indicated in the Text::Wrap documentation;

* Decide we've played enough with this and require either 5.004_05 (can
  we do this?) or 5.005.

-k

From hornik at ci.tuwien.ac.at  Wed Jul 16 09:31:28 2003
From: hornik at ci.tuwien.ac.at (Kurt Hornik)
Date: Wed Jul 16 08:33:30 2003
Subject: [Rd] How to do get verbatim in Rd files
In-Reply-To: <D7A3CFD7825BD6119B880002A58F06C20680A4B7@groexmb02.pfizer.com>
References: <D7A3CFD7825BD6119B880002A58F06C20680A4B7@groexmb02.pfizer.com>
Message-ID: <16148.61760.321007.872337@mithrandir.hornik.net>

>>>>> Warnes, Gregory R writes:

> I want to include a multi-line code block in the details section of a R
> manual page.  How do I get an appropriate verbatim-like environment?
> \verbatim{...} doesn't do the trick,  neither does \code{...}.

I don't think this is currently possible.

It would certainly be nice to have something like texinfo's
@smallexample ...

Best
-k

From maechler at stat.math.ethz.ch  Wed Jul 16 10:17:29 2003
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Wed Jul 16 09:17:20 2003
Subject: [Rd] R CMD check 'package-name' failed   
In-Reply-To: <200303191555.03805.bernhard.pfaff@t-online.de>
References: <200303191555.03805.bernhard.pfaff@t-online.de>
Message-ID: <16148.64521.962010.753061@gargle.gargle.HOWL>

?? 

-  your message is dated  "March 19" but the Received headers seem
   to indicate that it *is* current, i.e. late evening July 15. 

-  you are using an outdated version of R (1.6.2).
   "R CMD check" has been improved since then (even more than once).
   Can you try with the current version 1.7.1
   (or even "R-patched" or "R-devel").

Mit lieben Gr?ssen aus Z?rich,
Martin

Martin Maechler <maechler@stat.math.ethz.ch>	http://stat.ethz.ch/~maechler/
Seminar fuer Statistik, ETH-Zentrum  LEO C16	Leonhardstr. 27
ETH (Federal Inst. Technology)	8092 Zurich	SWITZERLAND
phone: x-41-1-632-3408		fax: ...-1228			<><

From claus at ekstroem.dk  Wed Jul 16 10:35:50 2003
From: claus at ekstroem.dk (Claus Ekstroem)
Date: Wed Jul 16 09:35:44 2003
Subject: [Rd] Density function for non-central t distribution
Message-ID: <20030716073549.GA12505@dina.kvl.dk>

Hi,

I've written some C code for density evaluation of the non-central t distribution. It works 
with the R-1.7.1 source code if placed in the src/nmath directory and after appropriate 
changes are made to Makefiles, to the dt function in src/library/base/R/distn.R etc. 
I haven't read a lot of R source code so it may need some R-ification, but I've tried to use the 
dt.c file as a standard.

Use and abuse.

Claus


===> File dnt.c <===

/*
 *  AUTHOR
 *    Claus Ekstr?m, ekstrom@dina.kvl.dk
 *    July 15, 2003.
 *
 *  This program is free software; you can redistribute it and/or modify
 *  it under the terms of the GNU General Public License as published by
 *  the Free Software Foundation; either version 2 of the License, or
 *  (at your option) any later version.
 *
 *  This program is distributed in the hope that it will be useful,
 *  but WITHOUT ANY WARRANTY; without even the implied warranty of
 *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 *  GNU General Public License for more details.
 *
 *  You should have received a copy of the GNU General Public License
 *  along with this program; if not, write to the Free Software
 *  Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307 USA.
 *
 *
 *  NOTE
 *
 *    Requires the following auxiliary routines:
 *
 *      lgammafn(x)     - log gamma function
 *      pnt(x, df, ncp) - the distribution function for the non-central t distribution
 *
 *
 * DESCRIPTION
 *
 *    The non-central t density is 
 *
 *         f(x, df, ncp) = 
df^(df/2)*exp(-.5*ncp^2)/(sqrt(pi)*gamma(df/2)*(df+x^2)^((df+1)/2))*sum_{k=0}^Infinity gamma((df + 
k + df)/2)*ncp^k/prod(1:k)*(2*x^2/(df+x^2))^(k/2)
 *
 *    The functional relationship
 *
 *         f(x, df, ncp) = df/x*(F(sqrt((df+2)/df)*x, df+2, ncp) - F(x, df, ncp))
 *
 *    is used to evaluate the density at x != 0 and 
 *
 *         f(0, df, ncp) = exp(-.5*ncp^2) / (sqrt(pi)*sqrt(df)*gamma(df/2))*gamma((df+1)/2)
 *
 *    is used for x=0.
 *
 *    All calculations are done on log-scale to increase stability.
 *
 */

#include "nmath.h"
#include "dpq.h"

double dnt(double x, double df, double ncp, int give_log)
{ 
    double u;
#ifdef IEEE_754
    if (ISNAN(x) || ISNAN(df))
	return x + df;
#endif

    // If non-positive df then error
   if (df <= 0) ML_ERR_return_NAN;

    // If x is infinite then return 0
    if(!R_FINITE(x))
      return R_D__0;

    // If infinite df then the density is identical to a 
    // normal distribution with mean = ncp
    if(!R_FINITE(df))
	return dnorm(x, ncp, 1., give_log);

    // Consider two cases: x==0 or not
    // Do calculations on log scale to stabilize
    if (x!=0) {
      u = log(df)-log(fabs(x)) + log(fabs(pnt(x*sqrt((df+2)/df), df+2, ncp, 1, 0) - pnt(x, df, ncp, 
1, 0)));
    }
    else {
      u = lgammafn((df+1)/2) - lgammafn(df/2) - .5*(log(M_PI) + log(df) + ncp*ncp);
    }
    
    return (give_log ? u : exp(u));
}

-- 
*****************************************
Claus Thorn Ekstr?m <ekstrom@dina.kvl.dk>
Dept of Mathematics and Physics, KVL
Thorvaldsensvej 40
DK-1871 Frederiksberg C
Denmark
Phone:[+45] 3528 2341
Fax:  [+45] 3528 2350

From maechler at stat.math.ethz.ch  Wed Jul 16 11:22:31 2003
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Wed Jul 16 10:22:20 2003
Subject: [Rd] Undefined subroutine &R::Rdconv::fill (PR#3485)
In-Reply-To: <16148.58458.680003.755101@mithrandir.hornik.net>
References: <200307151656.h6FGuOJH000875@pubhealth.ku.dk>
	<x2ptkb8ls3.fsf@biostat.ku.dk>
	<16148.58458.680003.755101@mithrandir.hornik.net>
Message-ID: <16149.2887.426868.742734@gargle.gargle.HOWL>

>>>>> "KH" == Kurt Hornik <hornik@ci.tuwien.ac.at>
>>>>>     on Wed, 16 Jul 2003 07:36:26 +0200 writes:

>>>>> Peter Dalgaard BSA writes:
    >> michael.t.klinglesmith@intel.com writes:
    >>> make[1]: Leaving directory
    >>> `/fs38/odc.arch.3/mtklingl/R/R-1.7.1/doc' make[1]:
    >>> Entering directory
    >>> `/fs38/odc.arch.3/mtklingl/R/R-1.7.1/src/library'
    >>> building all R object docs (text, HTML, LaTeX, examples)
    >>> make[2]: Entering directory
    >>> `/fs38/odc.arch.3/mtklingl/R/R-1.7.1/src/library'
    >>> Undefined subroutine &R::Rdconv::fill called at
    >>> /fs38/odc.arch.3/mtklingl/R/R-1.7.1/share/perl/R/Rdconv.pm
    >>> line 1955, <rdfile> chunk 381.
    >> ....
    >>> ]perl -v
    >>> 
    >>> This is perl, version 5.004_04 built for i386_linux22
    >>> 
    >>> Copyright 1987-1997, Larry Wall

    >> I would suspect that this is the culprit. We do check
    >> that the perl version is at least 5.004 so we expect your
    >> version to work, but on the other hand it is quite old (~
    >> 6 years it would seem) and quite likely noone actually
    >> checked against that version when making changes to
    >> Rdconv.

    KH> Actually ...

    KH> It seems that Text::Wrap::fill() was added between
    KH> 5.004_04 and 5.004_05.  I had not realized that the
    KH> former was an official release.

    KH> We can

    KH> * Try to special-case 5.004_04 and provide the version
    KH> of fill() indicated in the Text::Wrap documentation;

    KH> * Decide we've played enough with this and require
    KH> either 5.004_05 (can we do this?) or 5.005.

I'd go for the latter. 
We will do people a favor (in the longer term at least) by
urging them to upgrade such old perl versions.

Martin

From maechler at stat.math.ethz.ch  Wed Jul 16 13:02:41 2003
From: maechler at stat.math.ethz.ch (maechler@stat.math.ethz.ch)
Date: Wed Jul 16 12:02:33 2003
Subject: [Rd] step.lm() fails to drop {many empty 2-way factor cells}
	(PR#3491)
Message-ID: <200307161002.h6GA2fJH007256@pubhealth.ku.dk>

Exec. Summary:
   step() basically ``fails'' whereas MASS' stepAIC() does work

This may not be a bug in the strictest sense, but at least
something for the wish list.  Unfortunately I have no time
currently to investigate further myself but want to be sure this
won't be forgotten: 

The example is using a real data set with 216 observations on 9
variables -- where we have anonymized variable and factor level names.
The 8 explanatory variables are 4 factors (with 3 / 2 / 4 / 4 levels)
and 4 continuous covariates.  The factor combinations observed
are very far from balanced, and have actually quite a few 0 cells.

The following is a reproducible R script
(you need internet connection and our FTP server working) :


## step.lm()  "fails"  when 2-way factor interactions have (many) empty cells
##             whereas stepAIC() works fine

Dat <- read.table("ftp://stat.ethz.ch/U/maechler/R/step-ex.tab", header=TRUE)
Dat$f3 <- ordered(Dat$f3)

## Full Model :  y ~ (f1+f2+f3+f4 + C1+C2+C3+C4)
## ----------   where f1..f4 are FACTORS  and C1..C4 are continuous covariates

## "Look at data"
str(Dat)
summary(Dat)

## several 2-way interactions have empty cells, e.g.
with(Dat, table(f1,f4)) #!
with(Dat, table(f1,f3))

## see the full design:
with(Dat, ftable(table(f1,f2,f3,f4))) ##--> many many 0
pairs(Dat, col = 1+as.integer(Dat$f1), pch = 1+as.integer(Dat$sex))

## Fit a "full model" with all 2-way interactions :
lmAll <- lm(formula = y ~ .^2, data = Dat)
summary(lmAll) # many insignificant ones {BTW: why is it bad to have "*" here?}

drop1(lmAll)
## clearly shows interaction terms that should be dropped (would decrease AIC)

## BUT:
sr <- step(lmAll)
## nothing eliminated  ?step claims it would work when drop1() does

library(MASS)
sAr <- stepAIC(lmAll) ## <<< stepAIC() *does* work
## but with instructive
## There were 19 warnings (use warnings() to see them)
warnings()
##- Warning messages:
##- 1: 0 df terms are changing AIC in: stepAIC(lmAll)
##- 2: 0 df terms are changing AIC in: stepAIC(lmAll)
##- ...
##- ...
summary(sAr)

From ken at cbr.nrc.ca  Wed Jul 16 18:16:02 2003
From: ken at cbr.nrc.ca (ken@cbr.nrc.ca)
Date: Wed Jul 16 17:15:57 2003
Subject: [Rd] Misleading error message in src/modules/lapack/Lapack.c
	(PR#3494)
Message-ID: <200307161516.h6GFG2JH011051@pubhealth.ku.dk>

Full_Name: Ken Crowell
Version: 1.7.1
OS: Solaris 2.8
Submission from: (NULL) (198.166.4.100)


In src/modules/lapack/Lapack.c, there are small typos in an pair of error
messages.

Starting at line 806:

    F77_CALL(dgeqp3)(&m, &n, REAL(A), &m, INTEGER(jpvt), REAL(tau),
                     &tmp, &lwork, rwork, &info);
    if (info < 0)     
        error("error code %d from Lapack routine dqeqp3", info);
    lwork = (int) tmp;
    work = (double *) R_alloc(lwork, sizeof(double));
    F77_CALL(dgeqp3)(&m, &n, REAL(A), &m, INTEGER(jpvt), REAL(tau),
                     work, &lwork, rwork, &info);
    if (info < 0)
        error("error code %d from Lapack routine dqeqp3", info);

The error messages refer to routine 'dqeqp3' instead of 'dgeqp3'.

(I'll keep trying to figure out why I'm getting the error message at all when
running 'make check'...)

From dmurdoch at pair.com  Wed Jul 16 14:16:09 2003
From: dmurdoch at pair.com (Duncan Murdoch)
Date: Wed Jul 16 19:12:09 2003
Subject: [Rd] Misleading error message in src/modules/lapack/Lapack.c
	(PR#3494)
In-Reply-To: <200307161516.h6GFG2JH011051@pubhealth.ku.dk>
References: <200307161516.h6GFG2JH011051@pubhealth.ku.dk>
Message-ID: <s12bhv4fjjhi65uoamqftds96hvmnkcs65@4ax.com>

On Wed, 16 Jul 2003 17:16:02 +0200 (MET DST), ken@cbr.nrc.ca wrote :

>In src/modules/lapack/Lapack.c, there are small typos in an pair of error
>messages.

Fixed in R-patched.  Thanks!

Duncan Murdoch

From liang at stat.berkeley.edu  Wed Jul 16 21:40:51 2003
From: liang at stat.berkeley.edu (liang@stat.berkeley.edu)
Date: Wed Jul 16 20:40:42 2003
Subject: [Rd] arima.sim problems (PR#3495)
Message-ID: <200307161840.h6GIepJH012229@pubhealth.ku.dk>

Full_Name: Gang Liang
Version: 1.7.1
OS: Debian/Woody
Submission from: (NULL) (192.6.19.190)


> print(arima.sim(list(ar=.3,order=c(1,1,1)), 30))
 [1]  0.00000000  0.10734243  0.02907301 -1.23441659 -0.98819317 -2.82731975
 [7] -2.69052512 -4.22884756 -5.02820635 -5.41514613 -6.20486350 -7.01040649
[13] -6.78121289 -5.41111810 -4.96338053 -5.42395408 -6.22741444 -5.75228153
[19] -6.07346580 -7.71726137 -8.16647092 -7.39100567 -6.69696069 -4.77905714
[25] -1.73530839 -0.19721837  0.08528623  1.43992522  2.59292971  5.05894572
[31]  6.14539036

Several problems were found in the above code:

1. arima.sim returns a non-ts object when the differencing term is nonzero
   in the order parameter.
2. there are leading zeros in the simulated sequence again when order[2] is
   non-zero; therefore, the length of the returned object is not right.
3. in the above code, I specified the order of ma to be 1, while ma is not
   given: arima.sim then simply treats ma=0. I don't whether it is a feature
   or a possible bug. Personally, I think it may be a good idea to enforce
   certain constraint like: if the order of ma is not zero, then you must
   provide ma even zero values are fine, but you cannot leave it blank.

Thanks!
Gang

From hjm at tacgi.com  Wed Jul 16 13:01:01 2003
From: hjm at tacgi.com (Harry Mangalam)
Date: Wed Jul 16 20:57:28 2003
Subject: [Rd] Integrating R in OpenOffice
In-Reply-To: <06B368F9-A8E5-11D7-A464-000393640F7A@gmu.edu>
References: <06B368F9-A8E5-11D7-A464-000393640F7A@gmu.edu>
Message-ID: <3F15A0ED.70803@tacgi.com>

Hi All,

A group of about 3-4 of us are looking into the possibility of incorporating R 
into OpenOffice's (OO) spreadsheet component (sc) .  We wish to use OO's nice 
ODBC ability to query a postgresql-based gene expression database thus 
populating an OO sc and then use Bioconductor via R to analyse user-selected 
parts of this spreadsheet.

We've looked at and compiled and used RGnumeric (with Duncan's help) to see 
what's possible under Gnumeric, but AFAIK gnumeric won't have DB connectivity 
for some time and has neither the finish nor the integration of OO.

We've reviewed quite a few documents that describe the integration approach and 
while it seems to be a bit complex (mostly due to UNO - OO's CORBA-like 
integration strategy), it seems to be quite doable.

We envision it working ike this:

- build R as a shared lib - libR.so [trivial - the R team has done this for us]

- use the UNO framework to direct the writing of an IDL that allows libR.so to 
be linked into the OO sc runtime [time consuming to digest all the docs and get 
a feel for how to do this, altho there are some introductory docs at: 
http://sc.openoffice.org/addin_howto.html

- write code that will automate the insertion of available R functions into the 
OO sc menu system. [possibly tricky but mostly tedious..?]

- write the query interface to the database within OO [pretty easy]

Some of the (many) things that I do not have a good grasp on are:
- which R functions are available to the calling app.  There is a list of 
functions listed in Chapter 5 of the "Writing R Extensions" doc.
But there is also a function defined as:
call_R(char*, long, void**, char**, long*, char**, long, char**);
which appears to provide access to all R functions.  Is this the case?

- how do R and optional R packages (such as Bioconductor) interact via libR.so?

- Do all optional packages have to be defined when building libR.so? (this 
doesn't sound right)  Or if not, how is libR.so informed that it has to load an 
additional package?

- Is this process integral to the runtime so that once Bioconductor or other 
package is installed via 'R INSTALL ..', libR.so can access them just like R?



-- 
Cheers, Harry
Harry J Mangalam - 949 856 2847 (v&f) - hjm@tacgi.com
             <<plain text preferred>>

From duncan at research.bell-labs.com  Thu Jul 17 11:08:29 2003
From: duncan at research.bell-labs.com (Duncan Temple Lang)
Date: Thu Jul 17 16:08:51 2003
Subject: [Rd] Integrating R in OpenOffice
In-Reply-To: <3F15A0ED.70803@tacgi.com>;
	from hjm@tacgi.com on Wed, Jul 16, 2003 at 12:01:01PM -0700
References: <06B368F9-A8E5-11D7-A464-000393640F7A@gmu.edu>
	<3F15A0ED.70803@tacgi.com>
Message-ID: <20030717100829.B5149@jessie.research.bell-labs.com>

Hi Harry.

   Thanks for providing the details about the plan.  I'll try to take
a look at some of the Open Office documents in the next week. For the
most part, the inter-system interfaces are the same and only the
mechanics are specific to the host.

  I hope OO doesn't require that we add _all_ S functions to a menu.
If for no other reason, the user will be overwhelmed.  Gnumeric
requires that we register them with the function manager at run-time
which means we can tailor them to the particular session/application.
What one typically wants is a way to tell OO that if it is looking for
a function, ask R does it have that function.  There are a variety of
issues about argument types, etc.  These aside, what we typically want
to have is a that R is embedded in OO and the R-OO bridge provides a
way to marshall a call from OO to R. And we also want a bi-directional
interface so that R can access the OO sheet, etc. from R functions.


  I'll try to briefly address the libR.so issues. 


> Some of the (many) things that I do not have a good grasp on are:
> - which R functions are available to the calling app.  There is a list of 
> functions listed in Chapter 5 of the "Writing R Extensions" doc.
> But there is also a function defined as:
> call_R(char*, long, void**, char**, long*, char**, long, char**);
> which appears to provide access to all R functions.  Is this the case?


- If we have a routine that is responsible for marshalling all calls
from OO to R, we can have it use call_R or alternatively construct and
evaluate an R expression directly in C code. If you look in the
RGnumeric.c file and specifically at the routine
RGnumeric_fixedArgCall(), you'll see an example of the marshalling
routine. This is a more explicit and flexible version of call_R()
and will do error handling correctly!

> 
> - how do R and optional R packages (such as Bioconductor) interact via libR.so?

- If you think of libR.so as simply being a way to embedd R into
another application (just like we can load a library into R), then
that version of R inside a host application runs exactly as it would
as a stand-alone.  One loads any [optional] R package using the
library() function in R and the R engine will take care of all the
details, e.g. loading the .so/.dll for that library, the S code, etc.

The only important thing is that packages in which the C/Fortran code
use routines in R must be installed after R has been built with
libR.so enabled.  This is the default when R is configured with the
--enable-R-shlib option and packages are subsequently installed.  Any
package installed before R was built as a shared library may not work.


> 
> - Do all optional packages have to be defined when building libR.so? (this 
> doesn't sound right)  Or if not, how is libR.so informed that it has to load an 
> additional package?

No. They can be installed whenever needed.

Somebody will have to tell R to load that additional package when it
is needed.  This can be done either in the startup script for R
(i.e. Rprofile) or by the "user" of OO.  Typically, you will add a
function to OO that will load the relevant R packages.  This function
is your OO wrapper to the R functionality.

> 
> - Is this process integral to the runtime so that once Bioconductor or other 
> package is installed via 'R INSTALL ..', libR.so can access them just like R?

Yes. R and libR.so are almost exactly the same. From one point of
view, the difference is how they start - R is a stand alone
application that starts itself; libR.so is started by some other
application.


  This should be very interesting. I'll try to find some time to read
the OO docs and help out.

  D.




Harry Mangalam wrote:
> Hi All,
> 
> A group of about 3-4 of us are looking into the possibility of incorporating R 
> into OpenOffice's (OO) spreadsheet component (sc) .  We wish to use OO's nice 
> ODBC ability to query a postgresql-based gene expression database thus 
> populating an OO sc and then use Bioconductor via R to analyse user-selected 
> parts of this spreadsheet.
> 
> We've looked at and compiled and used RGnumeric (with Duncan's help) to see 
> what's possible under Gnumeric, but AFAIK gnumeric won't have DB connectivity 
> for some time and has neither the finish nor the integration of OO.
> 
> We've reviewed quite a few documents that describe the integration approach and 
> while it seems to be a bit complex (mostly due to UNO - OO's CORBA-like 
> integration strategy), it seems to be quite doable.
> 
> We envision it working ike this:
> 
> - build R as a shared lib - libR.so [trivial - the R team has done this for us]
> 
> - use the UNO framework to direct the writing of an IDL that allows libR.so to 
> be linked into the OO sc runtime [time consuming to digest all the docs and get 
> a feel for how to do this, altho there are some introductory docs at: 
> http://sc.openoffice.org/addin_howto.html
> 
> - write code that will automate the insertion of available R functions into the 
> OO sc menu system. [possibly tricky but mostly tedious..?]
> 
> - write the query interface to the database within OO [pretty easy]
> 
> Some of the (many) things that I do not have a good grasp on are:
> - which R functions are available to the calling app.  There is a list of 
> functions listed in Chapter 5 of the "Writing R Extensions" doc.
> But there is also a function defined as:
> call_R(char*, long, void**, char**, long*, char**, long, char**);
> which appears to provide access to all R functions.  Is this the case?
> 
> - how do R and optional R packages (such as Bioconductor) interact via libR.so?
> 
> - Do all optional packages have to be defined when building libR.so? (this 
> doesn't sound right)  Or if not, how is libR.so informed that it has to load an 
> additional package?
> 
> - Is this process integral to the runtime so that once Bioconductor or other 
> package is installed via 'R INSTALL ..', libR.so can access them just like R?
> 
> 
> 
> -- 
> Cheers, Harry
> Harry J Mangalam - 949 856 2847 (v&f) - hjm@tacgi.com
>              <<plain text preferred>>
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://www.stat.math.ethz.ch/mailman/listinfo/r-devel

From BoersN at pac.dfo-mpo.gc.ca  Thu Jul 17 20:54:27 2003
From: BoersN at pac.dfo-mpo.gc.ca (BoersN@pac.dfo-mpo.gc.ca)
Date: Thu Jul 17 19:54:21 2003
Subject: [Rd] Incorrect tick mark length when `tck' != NA (PR#3504)
Message-ID: <200307171754.h6HHsRJH021420@pubhealth.ku.dk>

Full_Name: Nicholas Boers
Version: 1.7.1  (2003-06-16)
OS: Windows NT 4.0
Submission from: (NULL) (199.60.94.186)


When I set the par() parameter `tck' equal to a number (i.e. not NA), the length
of the tick marks on the vertical axes (2 and 4) differs from the length of the
tick marks on the horizontal axes (1 and 3).  This behaviour is not consistent
with the R documentation (or S-Plus' behaviour, if that matters).

You should be able to reproduce this problem using the following code:
  par(plt = c(0.45, 0.55, 0.1, 0.9), tck = -0.04)
  frame()
  axis(1);
  axis(2);

Here is the `tck' section from the par() documentation:
  `tck' The length of tick marks as a fraction of the smaller of the
        width or height of the plotting region.  If `tck=1', grid
        lines are drawn.  The default setting (`tck = NA') is to use
        `tcl = -0.5' (see below).

Thank-you for your time and considering this bug report.

From hjm at tacgi.com  Thu Jul 17 13:24:54 2003
From: hjm at tacgi.com (Harry Mangalam)
Date: Thu Jul 17 21:21:27 2003
Subject: [Rd] Integrating R in OpenOffice
In-Reply-To: <20030717100829.B5149@jessie.research.bell-labs.com>
References: <06B368F9-A8E5-11D7-A464-000393640F7A@gmu.edu>
	<3F15A0ED.70803@tacgi.com>
	<20030717100829.B5149@jessie.research.bell-labs.com>
Message-ID: <3F16F806.3030606@tacgi.com>

Hi Duncan,

thanks very much for your insights (and also for the previous help with 
RGnumeric, docs, etc, etc).  They answered my questions well and in the way I 
was hoping ;).  I'm really enthusiastic about digging into this more now.

I'm just starting in on the detailed UNO/UDK docs and examples myself and am 
just now downloading and doing the initial compilations required as an OO base 
development system, but as I find interesting or valuable bits, I'll send them 
your way as well to the other team members (also Simon Urbanek and Kevin B. 
Hendricks have expressed interest in helping out as well).

Harry

Duncan Temple Lang wrote:
> Hi Harry.
> 
>    Thanks for providing the details about the plan.  I'll try to take
> a look at some of the Open Office documents in the next week. For the
> most part, the inter-system interfaces are the same and only the
> mechanics are specific to the host.
> 
>   I hope OO doesn't require that we add _all_ S functions to a menu.
> If for no other reason, the user will be overwhelmed.  Gnumeric
> requires that we register them with the function manager at run-time
> which means we can tailor them to the particular session/application.
> What one typically wants is a way to tell OO that if it is looking for
> a function, ask R does it have that function.  There are a variety of
> issues about argument types, etc.  These aside, what we typically want
> to have is a that R is embedded in OO and the R-OO bridge provides a
> way to marshall a call from OO to R. And we also want a bi-directional
> interface so that R can access the OO sheet, etc. from R functions.
> 
> 
>   I'll try to briefly address the libR.so issues. 
> 
> 
> 
>>Some of the (many) things that I do not have a good grasp on are:
>>- which R functions are available to the calling app.  There is a list of 
>>functions listed in Chapter 5 of the "Writing R Extensions" doc.
>>But there is also a function defined as:
>>call_R(char*, long, void**, char**, long*, char**, long, char**);
>>which appears to provide access to all R functions.  Is this the case?
> 
> 
> 
> - If we have a routine that is responsible for marshalling all calls
> from OO to R, we can have it use call_R or alternatively construct and
> evaluate an R expression directly in C code. If you look in the
> RGnumeric.c file and specifically at the routine
> RGnumeric_fixedArgCall(), you'll see an example of the marshalling
> routine. This is a more explicit and flexible version of call_R()
> and will do error handling correctly!
> 
> 
>>- how do R and optional R packages (such as Bioconductor) interact via libR.so?
> 
> 
> - If you think of libR.so as simply being a way to embedd R into
> another application (just like we can load a library into R), then
> that version of R inside a host application runs exactly as it would
> as a stand-alone.  One loads any [optional] R package using the
> library() function in R and the R engine will take care of all the
> details, e.g. loading the .so/.dll for that library, the S code, etc.
> 
> The only important thing is that packages in which the C/Fortran code
> use routines in R must be installed after R has been built with
> libR.so enabled.  This is the default when R is configured with the
> --enable-R-shlib option and packages are subsequently installed.  Any
> package installed before R was built as a shared library may not work.
> 
> 
> 
>>- Do all optional packages have to be defined when building libR.so? (this 
>>doesn't sound right)  Or if not, how is libR.so informed that it has to load an 
>>additional package?
> 
> 
> No. They can be installed whenever needed.
> 
> Somebody will have to tell R to load that additional package when it
> is needed.  This can be done either in the startup script for R
> (i.e. Rprofile) or by the "user" of OO.  Typically, you will add a
> function to OO that will load the relevant R packages.  This function
> is your OO wrapper to the R functionality.
> 
> 
>>- Is this process integral to the runtime so that once Bioconductor or other 
>>package is installed via 'R INSTALL ..', libR.so can access them just like R?
> 
> 
> Yes. R and libR.so are almost exactly the same. From one point of
> view, the difference is how they start - R is a stand alone
> application that starts itself; libR.so is started by some other
> application.
> 
> 
>   This should be very interesting. I'll try to find some time to read
> the OO docs and help out.
> 
>   D.
> 
> 
> 
> 
> Harry Mangalam wrote:
> 
>>Hi All,
>>
>>A group of about 3-4 of us are looking into the possibility of incorporating R 
>>into OpenOffice's (OO) spreadsheet component (sc) .  We wish to use OO's nice 
>>ODBC ability to query a postgresql-based gene expression database thus 
>>populating an OO sc and then use Bioconductor via R to analyse user-selected 
>>parts of this spreadsheet.
>>
>>We've looked at and compiled and used RGnumeric (with Duncan's help) to see 
>>what's possible under Gnumeric, but AFAIK gnumeric won't have DB connectivity 
>>for some time and has neither the finish nor the integration of OO.
>>
>>We've reviewed quite a few documents that describe the integration approach and 
>>while it seems to be a bit complex (mostly due to UNO - OO's CORBA-like 
>>integration strategy), it seems to be quite doable.
>>
>>We envision it working ike this:
>>
>>- build R as a shared lib - libR.so [trivial - the R team has done this for us]
>>
>>- use the UNO framework to direct the writing of an IDL that allows libR.so to 
>>be linked into the OO sc runtime [time consuming to digest all the docs and get 
>>a feel for how to do this, altho there are some introductory docs at: 
>>http://sc.openoffice.org/addin_howto.html
>>
>>- write code that will automate the insertion of available R functions into the 
>>OO sc menu system. [possibly tricky but mostly tedious..?]
>>
>>- write the query interface to the database within OO [pretty easy]
>>
>>Some of the (many) things that I do not have a good grasp on are:
>>- which R functions are available to the calling app.  There is a list of 
>>functions listed in Chapter 5 of the "Writing R Extensions" doc.
>>But there is also a function defined as:
>>call_R(char*, long, void**, char**, long*, char**, long, char**);
>>which appears to provide access to all R functions.  Is this the case?
>>
>>- how do R and optional R packages (such as Bioconductor) interact via libR.so?
>>
>>- Do all optional packages have to be defined when building libR.so? (this 
>>doesn't sound right)  Or if not, how is libR.so informed that it has to load an 
>>additional package?
>>
>>- Is this process integral to the runtime so that once Bioconductor or other 
>>package is installed via 'R INSTALL ..', libR.so can access them just like R?
>>
>>
>>
>>-- 
>>Cheers, Harry
>>Harry J Mangalam - 949 856 2847 (v&f) - hjm@tacgi.com
>>             <<plain text preferred>>
>>
>>______________________________________________
>>R-devel@stat.math.ethz.ch mailing list
>>https://www.stat.math.ethz.ch/mailman/listinfo/r-devel
> 
> 

-- 
Cheers, Harry
Harry J Mangalam - 949 856 2847 (v&f) - hjm@tacgi.com
             <<plain text preferred>>
         Go Dennis! http://www.kucinich.us

From richard.roger at agric.nsw.gov.au  Fri Jul 18 02:31:15 2003
From: richard.roger at agric.nsw.gov.au (richard.roger@agric.nsw.gov.au)
Date: Fri Jul 18 01:31:09 2003
Subject: [Rd] (PR#2867)
Message-ID: <200307172331.h6HNVFJH023196@pubhealth.ku.dk>

This is a multipart message in MIME format.
--=_alternative 00812CFCCA256D66_=
Content-Type: text/plain; charset="us-ascii"

Two points in respect to PR#2867.

First, the trivial one:

(1) In Lapack.c, on lines 806 and 812, there are calls of 
F77_CALL(dgeqp3).  But the error messages on lines on lines 809 and 815 
refer to "dqeqp3", i.e., they currently have a "q" where they should have 
a "g".

Secondly, the non-trivial one

(2)  I have built R-1.7.1 under Solaris 7 on a SunUltrasparc 2 using 
gcc-2.95.3.  On running make check-all, bug #2867 still rears its head. 
Here is the tail of the output from reg-tests-1.Rout.fail

> ## as.hclust.twins() lost labels and more till (incl) 1.6.2
> 
> 
> ## PR#2867 qr(LAPACK=TRUE) didn't always pivot in 1.7.0
> set.seed(1)
> X <- matrix(rnorm(40),10,4)
> X[,1] <- X[,2]
> (qrx <- qr(X, LAPACK=TRUE))
Error in qr(X, LAPACK = TRUE) : error code -14983444 from Lapack routine 
dqeqp3
Execution halted


As an R novice, I am puzzled that the call to dgeqp3 has more arguments 
than dgeqp3 itself.  The call has an extra argument "rwork".  But this 
could explain the strange error code!

The call:

    F77_CALL(dgeqp3)(&m, &n, REAL(A), &m, INTEGER(jpvt), REAL(tau),
                     &tmp, &lwork, rwork, &info);

The subroutine:
      SUBROUTINE DGEQP3( M, N, A, LDA, JPVT, TAU, WORK, LWORK, INFO )


Thanks for R!

Regards

Richard E. Roger

Dr. R. E. Roger                         NSW Agriculture
Spatial Information Officer Systems                161 Kite St
Resource Information Unit                   Locked Bag 21
                                        ORANGE NSW 2800
ph: (02) 6391 3697                          fax: (02) 6391 3740

This message is intended for the addressee named and may contain 
confidential information. If you are not the intended recipient or 
received it in error, please delete the message and notify sender. Views 
expressed are those of the individual sender and are not necessarily the 
views of their organisation.
--=_alternative 00812CFCCA256D66_=
Content-Type: text/html; charset="us-ascii"


<br><font size=2 face="Courier New">Two points in respect to PR#2867.</font>
<br>
<br><font size=2 face="Courier New">First, the trivial one:</font>
<br>
<br><font size=2 face="Courier New">(1) In Lapack.c, on lines 806 and 812, there are calls of F77_CALL(dgeqp3). &nbsp;But the error messages on lines on lines 809 and 815 refer to &quot;dqeqp3&quot;, i.e., they currently have a &quot;q&quot; where they should have a &quot;g&quot;.</font>
<br>
<br><font size=2 face="Courier New">Secondly, the non-trivial one</font>
<br>
<br><font size=2 face="Courier New">(2) &nbsp;I have built R-1.7.1 under Solaris 7 on a SunUltrasparc 2 using gcc-2.95.3. &nbsp;On running make check-all, bug #2867 still rears its head. &nbsp;Here is the tail of the output from reg-tests-1.Rout.fail</font>
<br>
<br><font size=2 face="Courier New">&gt; ## as.hclust.twins() lost labels and more till (incl) 1.6.2</font>
<br><font size=2 face="Courier New">&gt; </font>
<br><font size=2 face="Courier New">&gt; </font>
<br><font size=2 face="Courier New">&gt; ## PR#2867 qr(LAPACK=TRUE) didn't always pivot in 1.7.0</font>
<br><font size=2 face="Courier New">&gt; set.seed(1)</font>
<br><font size=2 face="Courier New">&gt; X &lt;- matrix(rnorm(40),10,4)</font>
<br><font size=2 face="Courier New">&gt; X[,1] &lt;- X[,2]</font>
<br><font size=2 face="Courier New">&gt; (qrx &lt;- qr(X, LAPACK=TRUE))</font>
<br><font size=2 face="Courier New">Error in qr(X, LAPACK = TRUE) : error code -14983444 from Lapack routine dqeqp3</font>
<br><font size=2 face="Courier New">Execution halted</font>
<br>
<br>
<br><font size=2 face="Courier New">As an R novice, I am puzzled that the call to dgeqp3 has more arguments than dgeqp3 itself. &nbsp;The call has an extra argument &quot;rwork&quot;. &nbsp;But this could explain the strange error code!</font>
<br>
<br><font size=2 face="Courier New">The call:</font>
<br>
<br><font size=2 face="Courier New">&nbsp; &nbsp; F77_CALL(dgeqp3)(&amp;m, &amp;n, REAL(A), &amp;m, INTEGER(jpvt), REAL(tau),</font>
<br><font size=2 face="Courier New">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&amp;tmp, &amp;lwork, rwork, &amp;info);</font>
<br>
<br><font size=2 face="Courier New">The subroutine:</font>
<br><font size=2 face="Courier New">&nbsp; &nbsp; &nbsp; SUBROUTINE DGEQP3( M, N, A, LDA, JPVT, TAU, WORK, LWORK, INFO )</font>
<br>
<br>
<br><font size=2 face="sans-serif">Thanks for R!</font>
<br>
<br><font size=2 face="sans-serif">Regards</font>
<br>
<br><font size=2 face="sans-serif">Richard E. Roger</font>
<br>
<br><font size=2 face="sans-serif">Dr. R. E. Roger &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;NSW Agriculture<br>
Spatial Information Officer Systems &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 161 Kite St<br>
Resource Information Unit &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Locked Bag 21<br>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ORANGE NSW 2800<br>
ph: (02) 6391 3697 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;fax: (02) 6391 3740<br>
<br>
This message is intended for the addressee named and may contain confidential information. If you are not the intended recipient or received it in error, please delete the message and notify sender. Views expressed are those of the individual sender and are not necessarily the views of their organisation.</font>
--=_alternative 00812CFCCA256D66_=--

From p.dalgaard at biostat.ku.dk  Fri Jul 18 01:09:15 2003
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard BSA)
Date: Fri Jul 18 02:09:18 2003
Subject: [Rd] (PR#2867)
In-Reply-To: <200307172331.h6HNVFJH023196@pubhealth.ku.dk>
References: <200307172331.h6HNVFJH023196@pubhealth.ku.dk>
Message-ID: <x2u19k66bk.fsf@biostat.ku.dk>

richard.roger@agric.nsw.gov.au writes:

> 
> As an R novice, I am puzzled that the call to dgeqp3 has more arguments 
> than dgeqp3 itself.  The call has an extra argument "rwork".  But this 
> could explain the strange error code!
> 
> The call:
> 
>     F77_CALL(dgeqp3)(&m, &n, REAL(A), &m, INTEGER(jpvt), REAL(tau),
>                      &tmp, &lwork, rwork, &info);
> 
> The subroutine:
>       SUBROUTINE DGEQP3( M, N, A, LDA, JPVT, TAU, WORK, LWORK, INFO )

I don't think you need to be a novice to be puzzled by that one...
The extra argument would likely cause info not to be modified, and
being uninitialized it can contain random garbage, quite possibly < 0. 

But what was the allocation of rwork supposed to be good for then??

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From ripley at stats.ox.ac.uk  Fri Jul 18 09:45:23 2003
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri Jul 18 09:45:47 2003
Subject: [Rd] (PR#2867)
In-Reply-To: <x2u19k66bk.fsf@biostat.ku.dk>
Message-ID: <Pine.LNX.4.44.0307180843360.6655-100000@gannet.stats>

On 18 Jul 2003, Peter Dalgaard BSA wrote:

> richard.roger@agric.nsw.gov.au writes:
> 
> > 
> > As an R novice, I am puzzled that the call to dgeqp3 has more arguments 
> > than dgeqp3 itself.  The call has an extra argument "rwork".  But this 
> > could explain the strange error code!
> > 
> > The call:
> > 
> >     F77_CALL(dgeqp3)(&m, &n, REAL(A), &m, INTEGER(jpvt), REAL(tau),
> >                      &tmp, &lwork, rwork, &info);
> > 
> > The subroutine:
> >       SUBROUTINE DGEQP3( M, N, A, LDA, JPVT, TAU, WORK, LWORK, INFO )
> 
> I don't think you need to be a novice to be puzzled by that one...
> The extra argument would likely cause info not to be modified, and
> being uninitialized it can contain random garbage, quite possibly < 0. 
> 
> But what was the allocation of rwork supposed to be good for then??

It is needed for the complex version of qr(), and I failed to notice the 
difference in the calls when producing the real version with LAPACK=TRUE.

Fixed now.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From ripley at stats.ox.ac.uk  Fri Jul 18 11:08:59 2003
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri Jul 18 11:08:54 2003
Subject: [Rd] "na.action" parameter in princomp() (PR#3481)
In-Reply-To: <200307150622.h6F6MeJH024405@pubhealth.ku.dk>
Message-ID: <Pine.LNX.4.44.0307181004440.15007-100000@gannet.stats>

It should not:  na.action is only a valid argument for the formula method,

Current R-devel says

Usage:

     ## S3 method for class 'formula':
     princomp(formula, data = NULL, subset, na.action, ...)
     ## S3 method for class 'default':
     princomp(x, cor = FALSE, scores = TRUE, covmat = NULL,
              subset = rep(TRUE, nrow(as.matrix(x))), ...)

which may help you see where you misread.

Just apply na.omit to the matrix/data.frame argument directly.


On Tue, 15 Jul 2003 jerome@hivnet.ubc.ca wrote:

> Full_Name: Jerome Asselin
> Version: 1.7.1
> OS: Red Hat Linux 7.2
> Submission from: (NULL) (24.77.125.119)
> 
> 
> 
> Setting the parameter na.action=na.omit should remove
> incomplete records in princomp. However this does not
> seem to work as expected. See example below.
> 
> Sincerely,
> Jerome Asselin
> 
> 
> data(USArrests)
> princomp(USArrests, cor = TRUE) #THIS WORKS
> 
> USArrests[1,3] <- NA
> princomp(USArrests, cor = TRUE, na.action=na.omit) #THIS FAILS!
> #Error in cov.wt(z) : x must contain finite values only
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://www.stat.math.ethz.ch/mailman/listinfo/r-devel
> 

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From dmurdoch at pair.com  Fri Jul 18 09:14:53 2003
From: dmurdoch at pair.com (Duncan Murdoch)
Date: Fri Jul 18 14:14:57 2003
Subject: [Rd] Strategies for S-PLUS compatibility?
Message-ID: <32pfhvchub55ql2a7j6u39m747tp53bheq@4ax.com>

I'd like to give a copy of an R package to someone using S-PLUS.  It
doesn't just run as-is, it'll need changes.  Has anyone written any
general guidelines on ways to port in that direction?  

Duncan Murdoch

From ripley at stats.ox.ac.uk  Fri Jul 18 14:49:58 2003
From: ripley at stats.ox.ac.uk (Prof Brian D Ripley)
Date: Fri Jul 18 14:53:33 2003
Subject: [Rd] Strategies for S-PLUS compatibility?
In-Reply-To: <32pfhvchub55ql2a7j6u39m747tp53bheq@4ax.com>
Message-ID: <Pine.WNT.4.44.0307181344150.3004-100000@gannet.stats.ox.ac.uk>

On Fri, 18 Jul 2003, Duncan Murdoch wrote:

> I'd like to give a copy of an R package to someone using S-PLUS.  It
> doesn't just run as-is, it'll need changes.  Has anyone written any
> general guidelines on ways to port in that direction?

This depends a lot on what `S-PLUS' is (Unix/Windows, 3.4/4.x/2000/5.x/6.x
are all different).  My best shot is to refer to `S Programming' about
constructing a package under the appropriate S-PLUS section.

If it's a recent version of S-PLUS, you should convert the help files to
Ssgm with Rdconv rename .R files to .q and uses a single-level
directory structure.  Beyond that it is a matter of experience and
trial-and-error: if C is involved it is essential to have header files
declaring (correctly) all entry points used.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From rossini at blindglobe.net  Fri Jul 18 09:10:32 2003
From: rossini at blindglobe.net (A.J. Rossini)
Date: Fri Jul 18 16:46:42 2003
Subject: [Rd] Strategies for S-PLUS compatibility?
In-Reply-To: <32pfhvchub55ql2a7j6u39m747tp53bheq@4ax.com> (Duncan Murdoch's
	message of "Fri, 18 Jul 2003 08:14:53 -0400")
References: <32pfhvchub55ql2a7j6u39m747tp53bheq@4ax.com>
Message-ID: <87r84n6fbr.fsf@jeeves.blindglobe.net>

Duncan Murdoch <dmurdoch@pair.com> writes:

> I'd like to give a copy of an R package to someone using S-PLUS.  It
> doesn't just run as-is, it'll need changes.  Has anyone written any
> general guidelines on ways to port in that direction?  

I thought the other Duncan had some form of compatibility package on
the Omegahat WWW site?

best,
-tony


-- 
A.J. Rossini  /  rossini@u.washington.edu  /  rossini@scharp.org
http://software.biostat.washington.edu/ UNTIL IT MOVES IN JULY.
Biomedical and Health Informatics, University of Washington
Biostatistics, HVTN/SCHARP, Fred Hutchinson Cancer Research Center.
FHCRC: 206-667-7025 (fax=4812)|Voicemail is pretty sketchy/use Email 

CONFIDENTIALITY NOTICE: This e-mail message and any attachme...{{dropped}}

From hb at maths.lth.se  Fri Jul 18 19:32:16 2003
From: hb at maths.lth.se (hb@maths.lth.se)
Date: Fri Jul 18 18:32:06 2003
Subject: [Rd] bringToTop() when some windows been closed (PR#3512)
Message-ID: <200307181632.h6IGWGJH029985@pubhealth.ku.dk>

Full_Name: Henrik Bengtsson
Version: R v1.7.1
OS: WinXP Pro
Submission from: (NULL) (130.235.2.229)


bringToTop() does not work if some windows has been closed. Example:

graphics.off()
x11()         # opens Figure 2
x11()         # opens Figure 3
dev.set(2) 
dev.off()     # closes Figure 2
bringToTop(3) # Gives an error
# Error in bringToTop(as.integer(which)) : invalid value of `which'
x11()         # opens Figure 2 again
bringToTop(3) # Works fine

It seems that *all* preceeding figures k=2,3,..,K-1 have to exist to be able to
bringToTop() figure K.

Cheers

Henrik Bengtsson

From ripley at stats.ox.ac.uk  Fri Jul 18 19:43:30 2003
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri Jul 18 19:43:24 2003
Subject: [Rd] bringToTop() when some windows been closed (PR#3512)
In-Reply-To: <200307181632.h6IGWGJH029985@pubhealth.ku.dk>
Message-ID: <Pine.LNX.4.44.0307181825040.24117-100000@gannet.stats>

We are talking about *devices* here, not windows and not figures.

Also, you are on Windows, where the device is called windows(), not
x11() (which is just there for back-compatibility).

The argument of bringToTop is a `device number'.  Unfortunately it tests 
this against NumDevices(), and that's not right.  The test has been 
corrected in R-devel.

As the FAQ says, please do not report guesses at the cause -- your
diagnosis is incorrect (and you have only one experimental point) and 
misled me.

On Fri, 18 Jul 2003 hb@maths.lth.se wrote:

> Full_Name: Henrik Bengtsson
> Version: R v1.7.1
> OS: WinXP Pro
> Submission from: (NULL) (130.235.2.229)
> 
> 
> bringToTop() does not work if some windows has been closed. Example:
> 
> graphics.off()
> x11()         # opens Figure 2
> x11()         # opens Figure 3
> dev.set(2) 
> dev.off()     # closes Figure 2
> bringToTop(3) # Gives an error
> # Error in bringToTop(as.integer(which)) : invalid value of `which'
> x11()         # opens Figure 2 again
> bringToTop(3) # Works fine
> 
> It seems that *all* preceeding figures k=2,3,..,K-1 have to exist to be able to
> bringToTop() figure K.
> 
> Cheers
> 
> Henrik Bengtsson
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://www.stat.math.ethz.ch/mailman/listinfo/r-devel
> 

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From jmc at research.bell-labs.com  Fri Jul 18 18:36:03 2003
From: jmc at research.bell-labs.com (John Chambers)
Date: Fri Jul 18 23:36:19 2003
Subject: [Rd] Strategies for S-PLUS compatibility?
References: <32pfhvchub55ql2a7j6u39m747tp53bheq@4ax.com>
	<87r84n6fbr.fsf@jeeves.blindglobe.net>
Message-ID: <3F186843.49DF31C1@research.bell-labs.com>

"A.J. Rossini" wrote:
> 
> Duncan Murdoch <dmurdoch@pair.com> writes:
> 
> > I'd like to give a copy of an R package to someone using S-PLUS.  It
> > doesn't just run as-is, it'll need changes.  Has anyone written any
> > general guidelines on ways to port in that direction?
> 
> I thought the other Duncan had some form of compatibility package on
> the Omegahat WWW site?

The "SLanguage" package in omegahat is an R and S-Plus collection of
functions addressing some of the incompatibilities.  The functions there
will help with some aspects, but it's not a tutorial and doesn't claim
to be complete.

I'd say that's a place for someone to get some additional ideas, and
some possibly helpful software, once they understand the basics of what
they need to do. More information (including a pointer to some
background discussion) and downloads at
http://www.omegahat.org/SLanguage/

John


> 
> best,
> -tony
> 
> --
> A.J. Rossini  /  rossini@u.washington.edu  /  rossini@scharp.org
> http://software.biostat.washington.edu/ UNTIL IT MOVES IN JULY.
> Biomedical and Health Informatics, University of Washington
> Biostatistics, HVTN/SCHARP, Fred Hutchinson Cancer Research Center.
> FHCRC: 206-667-7025 (fax=4812)|Voicemail is pretty sketchy/use Email
> 
> CONFIDENTIALITY NOTICE: This e-mail message and any attachme...{{dropped}}
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://www.stat.math.ethz.ch/mailman/listinfo/r-devel

-- 
John M. Chambers                  jmc@bell-labs.com
Bell Labs, Lucent Technologies    office: (908)582-2681
700 Mountain Avenue, Room 2C-282  fax:    (908)582-3340
Murray Hill, NJ  07974            web: http://www.cs.bell-labs.com/~jmc

From dmurdoch at pair.com  Fri Jul 18 20:08:40 2003
From: dmurdoch at pair.com (Duncan Murdoch)
Date: Sat Jul 19 01:08:37 2003
Subject: [Rd] Strategies for S-PLUS compatibility?
In-Reply-To: <32pfhvchub55ql2a7j6u39m747tp53bheq@4ax.com>
References: <32pfhvchub55ql2a7j6u39m747tp53bheq@4ax.com>
Message-ID: <5vughvkppni828vcra00uub2dg3ar13eu2@4ax.com>

On Fri, 18 Jul 2003 08:14:53 -0400, you wrote:

>I'd like to give a copy of an R package to someone using S-PLUS.  It
>doesn't just run as-is, it'll need changes.  Has anyone written any
>general guidelines on ways to port in that direction?  

The package in question is "orientlib", the one I recently put on
CRAN.  It uses S version 4 methods, and those seem to be the problem.

There are a number of small differences that cause trouble (e.g. the
first argument in weighted.mean is named "y" in S-PLUS, but "x" in R,
so I get complaints when converting it to a method), and something
that's beyond my debugging abilities:  calling a method appears to
call the default method instead of the appropriate one based on the
signature.  Calling getMethod to diagnose the problem also appears to
call the default method !?!

This is all in S-PLUS 6.1 for Windows.  

Obviously R-help is the wrong place to be asking for this sort of
detailed help; I guess I'll try over in s-news.

Duncan Murdoch

From ripley at stats.ox.ac.uk  Sat Jul 19 19:46:42 2003
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Sat Jul 19 19:46:42 2003
Subject: [Rd] finename length no check (PR#3466)
In-Reply-To: <200307120654.h6C6sfJH004343@pubhealth.ku.dk>
Message-ID: <Pine.LNX.4.44.0307191844510.1901-100000@gannet.stats>

Fixed now (and similar cases), but why do you need a filename like that
(or anything like that long?)?  Many OSes have limits around 256 chars.

On Sat, 12 Jul 2003 nakama@ki.rim.or.jp wrote:

> Full_Name: Ei-ji Nakama
> Version: R-1.7.1
> OS: Linux
> Submission from: (NULL) (219.117.236.13)
> 
> 
> > filename <- "----+----1----+----2----+----3----+----4----+----5----+----6----
> +----7----+----8----+----9----+----0----+----1----+----2----+----3----+----4---
> -+----5----+----6----+----7----+----8----+----9----+----0----+----1----+----2--
> --+----3----+----4----+----5----+----6----+----7----+----8----+----9----+----0-
> ---+----1----+----2----+----3----+----4----+----5----+----6----+----7----+----8
> ----+----9----+----0----+----1----+----2----+----3----+----4----+----5----+----
> 6----+----7----+----8----+----9----+----0----+----1----+----2"
> > png(file=filename,width=100,height=100,pointsize=12)
> Segmentation fault
> 
> src/modules/X11/devX11.c

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From jago at mclink.it  Sat Jul 19 23:36:45 2003
From: jago at mclink.it (Stefano Iacus)
Date: Sat Jul 19 22:37:02 2003
Subject: [Rd] internal support for dlopen, dlclose etc (darwin port)
Message-ID: <B6A78828-BA28-11D7-B2EF-003065CC4CB8@mclink.it>

This is just to say that I have included the code from the dlcompat 
library to support dlopen, dlclose etc under darwin from inside R 
itself.
This is needed to me to have as much as possible a selfcontained 
application bundle which does not need too much external dlls installed 
(the current version of RAqua installer also installs a copy of 
dlcompat dll on user's system)


I have just committed to cvs and update the new version of RAqua 
shortly on my webpage.

If you want to build this version of R you should re-configure from 
scratch (I would be pleased to have some feedback from people using the 
latest Dev Tools, panther etc)

PLEASE NOTE: before running configure please take care to remove 
libdl*.dylib and dlfc.h header files from your system (either you use 
fink or not) because I have not yet tuned the configure yet to take 
care of this.

Stefano

From John.Marsland at CommerzbankIB.com  Mon Jul 21 09:26:40 2003
From: John.Marsland at CommerzbankIB.com (Marsland, John)
Date: Mon Jul 21 09:26:30 2003
Subject: [Rd] unz()
Message-ID: <8CBAA121CEB4D5118CB200508BB2BBEF0317E865@xmx8lonib.lonib.commerzbank.com>

I am having some problems with unz() under R 1.7.1 using windows NT 4.0

download.file(url="http://www.test.com/test.zip",
destfile="c:/temp/test.zip", mode="wb")
z <- unz("c:/temp/test.zip", "home/test.txt", open="r")
test <- read.table(z,sep=";",skip=1,header=T,as.is=T)
close(z)

this code seems temperamental and seems to work if you play around with
open(z) and isOpen(z) eventually ...

otherwise I get the error:

Error in readLines(file, skip) : seek not enabled for this connection

I have checked this out further since I posted a melp message on Friday, I
think it must be a bug.

If anybody could offer advice?

Regards,

John Marsland


********************************************************************** 
This is a commercial communication from Commerzbank AG.\ \ T...{{dropped}}

From ripley at stats.ox.ac.uk  Mon Jul 21 11:33:53 2003
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Mon Jul 21 11:33:46 2003
Subject: [Rd] arima.sim problems (PR#3495)
In-Reply-To: <200307161840.h6GIepJH012229@pubhealth.ku.dk>
Message-ID: <Pine.LNX.4.44.0307211031260.7740-100000@gannet.stats>

On Wed, 16 Jul 2003 liang@stat.berkeley.edu wrote:

> Full_Name: Gang Liang
> Version: 1.7.1
> OS: Debian/Woody
> Submission from: (NULL) (192.6.19.190)
> 
> 
> > print(arima.sim(list(ar=.3,order=c(1,1,1)), 30))
>  [1]  0.00000000  0.10734243  0.02907301 -1.23441659 -0.98819317 -2.82731975
>  [7] -2.69052512 -4.22884756 -5.02820635 -5.41514613 -6.20486350 -7.01040649
> [13] -6.78121289 -5.41111810 -4.96338053 -5.42395408 -6.22741444 -5.75228153
> [19] -6.07346580 -7.71726137 -8.16647092 -7.39100567 -6.69696069 -4.77905714
> [25] -1.73530839 -0.19721837  0.08528623  1.43992522  2.59292971  5.05894572
> [31]  6.14539036
> 
> Several problems were found in the above code:
> 
> 1. arima.sim returns a non-ts object when the differencing term is nonzero
>    in the order parameter.

Already fixed in the development version of R.

> 2. there are leading zeros in the simulated sequence again when order[2] is
>    non-zero; therefore, the length of the returned object is not right.

That is intentional.  The leading zeroes are needed to start the series 
off, and they are returned to make clear that is what happened.

> 3. in the above code, I specified the order of ma to be 1, while ma is not
>    given: arima.sim then simply treats ma=0. I don't whether it is a feature
>    or a possible bug. Personally, I think it may be a good idea to enforce
>    certain constraint like: if the order of ma is not zero, then you must
>    provide ma even zero values are fine, but you cannot leave it blank.

You mean to protect against careless users?  Apparently that would be a
good idea and I have just added it.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From ripley at stats.ox.ac.uk  Mon Jul 21 13:12:36 2003
From: ripley at stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Mon Jul 21 12:12:28 2003
Subject: [Rd] step.lm() fails to drop {many empty 2-way factor cells}
	(PR#3527)
Message-ID: <200307211012.h6LACaJH013065@pubhealth.ku.dk>

Your example works on 2 of the 3 systems I tried (and in fact the warnings
you got on stepAIC are spurious).  It's all down to rounding errors.

I've added a fuzz in the termination test.

B

On Wed, 16 Jul 2003 maechler@stat.math.ethz.ch wrote:

> Exec. Summary:
>    step() basically ``fails'' whereas MASS' stepAIC() does work
> 
> This may not be a bug in the strictest sense, but at least
> something for the wish list.  Unfortunately I have no time
> currently to investigate further myself but want to be sure this
> won't be forgotten: 
> 
> The example is using a real data set with 216 observations on 9
> variables -- where we have anonymized variable and factor level names.
> The 8 explanatory variables are 4 factors (with 3 / 2 / 4 / 4 levels)
> and 4 continuous covariates.  The factor combinations observed
> are very far from balanced, and have actually quite a few 0 cells.
> 
> The following is a reproducible R script
> (you need internet connection and our FTP server working) :
> 
> 
> ## step.lm()  "fails"  when 2-way factor interactions have (many) empty cells
> ##             whereas stepAIC() works fine
> 
> Dat <- read.table("ftp://stat.ethz.ch/U/maechler/R/step-ex.tab", header=TRUE)
> Dat$f3 <- ordered(Dat$f3)
> 
> ## Full Model :  y ~ (f1+f2+f3+f4 + C1+C2+C3+C4)
> ## ----------   where f1..f4 are FACTORS  and C1..C4 are continuous covariates
> 
> ## "Look at data"
> str(Dat)
> summary(Dat)
> 
> ## several 2-way interactions have empty cells, e.g.
> with(Dat, table(f1,f4)) #!
> with(Dat, table(f1,f3))
> 
> ## see the full design:
> with(Dat, ftable(table(f1,f2,f3,f4))) ##--> many many 0
> pairs(Dat, col = 1+as.integer(Dat$f1), pch = 1+as.integer(Dat$sex))
> 
> ## Fit a "full model" with all 2-way interactions :
> lmAll <- lm(formula = y ~ .^2, data = Dat)
> summary(lmAll) # many insignificant ones {BTW: why is it bad to have "*" here?}
> 
> drop1(lmAll)
> ## clearly shows interaction terms that should be dropped (would decrease AIC)
> 
> ## BUT:
> sr <- step(lmAll)
> ## nothing eliminated  ?step claims it would work when drop1() does
> 
> library(MASS)
> sAr <- stepAIC(lmAll) ## <<< stepAIC() *does* work
> ## but with instructive
> ## There were 19 warnings (use warnings() to see them)
> warnings()
> ##- Warning messages:
> ##- 1: 0 df terms are changing AIC in: stepAIC(lmAll)
> ##- 2: 0 df terms are changing AIC in: stepAIC(lmAll)
> ##- ...
> ##- ...
> summary(sAr)
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://www.stat.math.ethz.ch/mailman/listinfo/r-devel
> 

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From ripley at stats.ox.ac.uk  Mon Jul 21 12:12:35 2003
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Mon Jul 21 12:12:46 2003
Subject: [Rd] step.lm() fails to drop {many empty 2-way factor cells}
	(PR#3491)
In-Reply-To: <200307161002.h6GA2fJH007256@pubhealth.ku.dk>
Message-ID: <Pine.LNX.4.44.0307211111070.7912-100000@gannet.stats>

Your example works on 2 of the 3 systems I tried (and in fact the warnings
you got on stepAIC are spurious).  It's all down to rounding errors.

I've added a fuzz in the termination test.

B

On Wed, 16 Jul 2003 maechler@stat.math.ethz.ch wrote:

> Exec. Summary:
>    step() basically ``fails'' whereas MASS' stepAIC() does work
> 
> This may not be a bug in the strictest sense, but at least
> something for the wish list.  Unfortunately I have no time
> currently to investigate further myself but want to be sure this
> won't be forgotten: 
> 
> The example is using a real data set with 216 observations on 9
> variables -- where we have anonymized variable and factor level names.
> The 8 explanatory variables are 4 factors (with 3 / 2 / 4 / 4 levels)
> and 4 continuous covariates.  The factor combinations observed
> are very far from balanced, and have actually quite a few 0 cells.
> 
> The following is a reproducible R script
> (you need internet connection and our FTP server working) :
> 
> 
> ## step.lm()  "fails"  when 2-way factor interactions have (many) empty cells
> ##             whereas stepAIC() works fine
> 
> Dat <- read.table("ftp://stat.ethz.ch/U/maechler/R/step-ex.tab", header=TRUE)
> Dat$f3 <- ordered(Dat$f3)
> 
> ## Full Model :  y ~ (f1+f2+f3+f4 + C1+C2+C3+C4)
> ## ----------   where f1..f4 are FACTORS  and C1..C4 are continuous covariates
> 
> ## "Look at data"
> str(Dat)
> summary(Dat)
> 
> ## several 2-way interactions have empty cells, e.g.
> with(Dat, table(f1,f4)) #!
> with(Dat, table(f1,f3))
> 
> ## see the full design:
> with(Dat, ftable(table(f1,f2,f3,f4))) ##--> many many 0
> pairs(Dat, col = 1+as.integer(Dat$f1), pch = 1+as.integer(Dat$sex))
> 
> ## Fit a "full model" with all 2-way interactions :
> lmAll <- lm(formula = y ~ .^2, data = Dat)
> summary(lmAll) # many insignificant ones {BTW: why is it bad to have "*" here?}
> 
> drop1(lmAll)
> ## clearly shows interaction terms that should be dropped (would decrease AIC)
> 
> ## BUT:
> sr <- step(lmAll)
> ## nothing eliminated  ?step claims it would work when drop1() does
> 
> library(MASS)
> sAr <- stepAIC(lmAll) ## <<< stepAIC() *does* work
> ## but with instructive
> ## There were 19 warnings (use warnings() to see them)
> warnings()
> ##- Warning messages:
> ##- 1: 0 df terms are changing AIC in: stepAIC(lmAll)
> ##- 2: 0 df terms are changing AIC in: stepAIC(lmAll)
> ##- ...
> ##- ...
> summary(sAr)
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://www.stat.math.ethz.ch/mailman/listinfo/r-devel
> 

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From V.Khamenia at biovision-discovery.de  Mon Jul 21 12:11:58 2003
From: V.Khamenia at biovision-discovery.de (Khamenia, Valery)
Date: Mon Jul 21 12:46:19 2003
Subject: [Rd] calling R from C
Message-ID: <D15343265276D31197BC00A024A6C11077412B@EXS_BDC>

Hi All,

  We'd like to use functions provided in R in our application.
  Our application is written in C/C++ and currently runs on 
  win32, Linux and Mac. We'd be happy to attach the whole
  R ( i.e. not just transfer some function by hand).
  The important detail is that we deal with big amount of data, so
  "command line"-like invocations won't be very interesting.
  We'd like to link R's code statically or dynamically.

  Any comments and/or links to docs on subj would be 
  highly appreciated. (Especially comments on Mac)

  Thank you in advance.

P.S. If this message appears twice -- I'm sorry (first one
  was sent in default HTML format)

kind regards,
Valery A.Khamenya
---------------------------------------------------------------------------
Bioinformatics Department
BioVisioN AG, Hannover

From V.Khamenia at biovision-discovery.de  Mon Jul 21 11:08:04 2003
From: V.Khamenia at biovision-discovery.de (Khamenia, Valery)
Date: Mon Jul 21 12:46:34 2003
Subject: [Rd] calling R from C
Message-ID: <D15343265276D31197BC00A024A6C11077412A@EXS_BDC>

Hi All,

  We'd like to use functions provided in R in our application.
  Our application is written in C/C++ and currently runs on 
  win32, Linux and Mac. We'd be happy to attach the whole
  R ( i.e. not just transfer some function by hand).
  It is important that we deal with big amount of data, so
  "command line"-like invocations won't be very interesting.
  We'd like to link R's code statically or dynamically.

  Any comments and/or links to docs on subj would be 
  highly appreciated. (Especially comments on Mac)

  Thank you in advance.

kind regards,
Valery A.Khamenya
---------------------------------------------------------------------------
Bioinformatics Department
BioVisioN AG, Hannover

From bjg at network-theory.co.uk  Mon Jul 21 17:12:49 2003
From: bjg at network-theory.co.uk (bjg@network-theory.co.uk)
Date: Mon Jul 21 16:12:39 2003
Subject: [Rd] missing permissions in reference manual copyright page
	(PR#3528)
Message-ID: <200307211412.h6LECnJH016288@pubhealth.ku.dk>

Hi,

I noticed that the R reference manual seems to be missing the license
permissions on the copyright page.  Below is a patch to "refman.top"
which adds the same permissions as the @permission{} macro in
"R-defs.texi".

I'm filing this bug as I have been preparing to publish the R
Reference Manual (in several volumes). I plan to donate 5 EUR to the
R-foundation for each set of manuals sold.

best regards,

-- 
Brian Gough

Network Theory Ltd            
15 Royal Park                 
Bristol BS8 3AL               
United Kingdom                

Tel: +44 (0)117 3179309 
Fax: +44 (0)117 9048108              
Web: http://www.network-theory.co.uk/

diff -c /home/bjg/cvs/r-rsync/r-devel/doc/manual/refman.top\~ /home/bjg/cvs/r-rsync/r-devel/doc/manual/refman.top
*** /home/bjg/cvs/r-rsync/r-devel/doc/manual/refman.top~	Wed Apr 17 15:11:03 2002
--- /home/bjg/cvs/r-rsync/r-devel/doc/manual/refman.top	Mon Jul 21 14:56:23 2003
***************
*** 31,36 ****
--- 31,54 ----
    \vfill
    \noindent
    Copyright ({\copyright}) 1999--2002 R Development Core Team.
+ 
+   \noindent
+   Permission is granted to make and distribute verbatim copies of this
+   manual provided the copyright notice and this permission notice are
+   preserved on all copies.
+ 
+   \noindent
+   Permission is granted to copy and distribute modified versions of this
+   manual under the conditions for verbatim copying, provided that the
+   entire resulting derived work is distributed under the terms of a
+   permission notice identical to this one.
+ 
+   \noindent
+   Permission is granted to copy and distribute translations of this manual
+   into another language, under the above conditions for modified versions,
+   except that this permission notice may be stated in a translation
+   approved by the R Development Core Team.
+ 
    \par\bigskip\noindent
    R is free software and comes with ABSOLUTELY NO WARRANTY.  You are
    welcome to redistribute it under the terms of the GNU General Public

From tlumley at u.washington.edu  Mon Jul 21 08:21:12 2003
From: tlumley at u.washington.edu (Thomas Lumley)
Date: Mon Jul 21 16:22:19 2003
Subject: [Rd] calling R from C
In-Reply-To: <D15343265276D31197BC00A024A6C11077412A@EXS_BDC>
Message-ID: <Pine.A41.4.44.0307210715020.88596-100000@homer03.u.washington.edu>

On Mon, 21 Jul 2003, Khamenia, Valery wrote:

> Hi All,
>
>   We'd like to use functions provided in R in our application.
>   Our application is written in C/C++ and currently runs on
>   win32, Linux and Mac. We'd be happy to attach the whole
>   R ( i.e. not just transfer some function by hand).
>   It is important that we deal with big amount of data, so
>   "command line"-like invocations won't be very interesting.
>   We'd like to link R's code statically or dynamically.
>

You can compile R as a shared library, which allows you to construct and
evaluate R expressions from C.

There's a recent thread on r-devel with a bit more information:
http://maths.newcastle.edu.au/~rking/R/devel/03b/0073.html


	-thomas

Thomas Lumley			Assoc. Professor, Biostatistics
tlumley@u.washington.edu	University of Washington, Seattle

From richard_raubertas at merck.com  Mon Jul 21 20:27:34 2003
From: richard_raubertas at merck.com (richard_raubertas@merck.com)
Date: Mon Jul 21 19:27:26 2003
Subject: [Rd] Bug in file.copy: overwrite=FALSE ignored (PR#3529)
Message-ID: <200307211727.h6LHRYJH017824@pubhealth.ku.dk>

I am using R 1.7.1 on Windows XP Pro.

The 'overwrite=FALSE' argument appears to be ignored in
file.copy():

> file.exists(c("file1.txt", "file2.txt"))
[1] TRUE TRUE
> file.copy(from="file2.txt", to="file1.txt", overwrite=FALSE)
[1] TRUE
> 

and sure enough, file1.txt has been overwritten.

Rich Raubertas
Biometrics Research, RY33-300
Merck & Co.

------------------------------------------------------------------------------
Notice: This e-mail message, together with any attachments, ...{{dropped}}

From ligges at statistik.uni-dortmund.de  Mon Jul 21 21:02:39 2003
From: ligges at statistik.uni-dortmund.de (Uwe Ligges)
Date: Mon Jul 21 20:01:32 2003
Subject: [Rd] Bug in file.copy: overwrite=FALSE ignored (PR#3529)
In-Reply-To: <200307211727.h6LHRYJH017824@pubhealth.ku.dk>
References: <200307211727.h6LHRYJH017824@pubhealth.ku.dk>
Message-ID: <3F1C2ABF.5050402@statistik.uni-dortmund.de>

richard_raubertas@merck.com wrote:
> I am using R 1.7.1 on Windows XP Pro.
> 
> The 'overwrite=FALSE' argument appears to be ignored in
> file.copy():
> 
> 
>>file.exists(c("file1.txt", "file2.txt"))
> 
> [1] TRUE TRUE
> 
>>file.copy(from="file2.txt", to="file1.txt", overwrite=FALSE)
> 
> [1] TRUE
> 
> 
> and sure enough, file1.txt has been overwritten.
> 
> Rich Raubertas
> Biometrics Research, RY33-300
> Merck & Co.
> 
> ------------------------------------------------------------------------------
> Notice: This e-mail message, together with any attachments, ...{{dropped}}
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://www.stat.math.ethz.ch/mailman/listinfo/r-devel

Fix:

     if (!overwrite) {
         if (nt > nf)
             from <- rep(from, length = nt)
         exists <- file.exists(from)
         from <- from[exists]
         to <- to[exists]
     }
     file.create(to)
     file.append(to, from)


should be something like


     if (!overwrite) {
         if (nt > nf)
             from <- rep(from, length = nt)
         exists <- file.exists(to)
         if(sum(exists))
             warning("File(s) \"", paste(to[exists], collapse = ", "), 
"\" already exist(s)")
         from <- from[!exists]
         to <- to[!exists]
     }
     if (length(to)) {
         file.create(to)
         file.append(to, from)
     }


Uwe Ligges

From dmurdoch at pair.com  Mon Jul 21 15:19:46 2003
From: dmurdoch at pair.com (Duncan Murdoch)
Date: Mon Jul 21 20:16:22 2003
Subject: [Rd] Bug in file.copy: overwrite=FALSE ignored (PR#3529)
In-Reply-To: <200307211727.h6LHRYJH017824@pubhealth.ku.dk>
References: <200307211727.h6LHRYJH017824@pubhealth.ku.dk>
Message-ID: <ghbohvk56fidc5f5n5r310q959eaeb4k6f@4ax.com>

On Mon, 21 Jul 2003 19:27:34 +0200 (MET DST),
richard_raubertas@merck.com wrote :

>I am using R 1.7.1 on Windows XP Pro.
>
>The 'overwrite=FALSE' argument appears to be ignored in
>file.copy():
>
>> file.exists(c("file1.txt", "file2.txt"))
>[1] TRUE TRUE
>> file.copy(from="file2.txt", to="file1.txt", overwrite=FALSE)
>[1] TRUE
>> 
>
>and sure enough, file1.txt has been overwritten.

There was a bug in the file.copy code; I'll submit a patch.

Duncan Murdoch

From dmurdoch at pair.com  Mon Jul 21 15:57:36 2003
From: dmurdoch at pair.com (Duncan Murdoch)
Date: Mon Jul 21 20:53:40 2003
Subject: [Rd] Bug in file.copy: overwrite=FALSE ignored (PR#3529)
In-Reply-To: <3F1C2ABF.5050402@statistik.uni-dortmund.de>
References: <200307211727.h6LHRYJH017824@pubhealth.ku.dk>
	<3F1C2ABF.5050402@statistik.uni-dortmund.de>
Message-ID: <sfdohvkqc92tmr3gorticeq4pdoiq214at@4ax.com>

On Mon, 21 Jul 2003 20:02:39 +0200, Uwe Ligges
<ligges@statistik.uni-dortmund.de> wrote :

>     if (!overwrite) {
>         if (nt > nf)
>             from <- rep(from, length = nt)
>         exists <- file.exists(to)
>         if(sum(exists))
>             warning("File(s) \"", paste(to[exists], collapse = ", "), 
>"\" already exist(s)")
>         from <- from[!exists]
>         to <- to[!exists]
>     }
>     if (length(to)) {
>         file.create(to)
>         file.append(to, from)
>     }

I don't think that gets the return value right.  Presumably if you're
copying 5 files to 5 files, and two of the destination files already
exist, the return should consist of 3 TRUE values and 2 FALSE values.
Here's my rewrite:

file.copy <- function(from, to, overwrite=FALSE)
{
    if (!(nf <- length(from))) stop("no files to copy from")
    if (!(nt <- length(to)))   stop("no files to copy to")
    if (nt == 1 && file.exists(to) && file.info(to)$isdir)
        to <- file.path(to, from)
    else if (nf > nt)  stop("more `from' files than `to' files")
    if(nt > nf) from <- rep(from, length = nt)
    if (!overwrite) okay <- !file.exists(to)
    else okay <- rep(TRUE, length(to))
     
    file.create(to[okay])
    okay[okay] <- file.append(to[okay], from[okay])
    okay
}

Duncan Murdoch

From dmurdoch at pair.com  Mon Jul 21 16:18:16 2003
From: dmurdoch at pair.com (Duncan Murdoch)
Date: Mon Jul 21 21:14:23 2003
Subject: [Rd] Bug in file.copy: overwrite=FALSE ignored (PR#3529)
In-Reply-To: <sfdohvkqc92tmr3gorticeq4pdoiq214at@4ax.com>
References: <200307211727.h6LHRYJH017824@pubhealth.ku.dk>
	<3F1C2ABF.5050402@statistik.uni-dortmund.de>
	<sfdohvkqc92tmr3gorticeq4pdoiq214at@4ax.com>
Message-ID: <e0fohv87e6cfd7i9u9eht8r3mm7otvl8r9@4ax.com>

On Mon, 21 Jul 2003 14:57:36 -0400, Duncan Murdoch <dmurdoch@pair.com>
wrote :

>Here's my rewrite:
>
>file.copy <- function(from, to, overwrite=FALSE)
>{
>    if (!(nf <- length(from))) stop("no files to copy from")
>    if (!(nt <- length(to)))   stop("no files to copy to")
>    if (nt == 1 && file.exists(to) && file.info(to)$isdir)
>        to <- file.path(to, from)
>    else if (nf > nt)  stop("more `from' files than `to' files")
>    if(nt > nf) from <- rep(from, length = nt)
>    if (!overwrite) okay <- !file.exists(to)
>    else okay <- rep(TRUE, length(to))
>     
>    file.create(to[okay])
>    okay[okay] <- file.append(to[okay], from[okay])
>    okay
>}

This isn't quite right either; it doesn't handle the case of no
eligible files or the case of copying a file onto itself properly.
The first is easy to fix (copying Uwe's test);  I think I'll just make
the second illegal.

Duncan Murdoch

From lucas at toulouse.inra.fr  Tue Jul 22 16:29:43 2003
From: lucas at toulouse.inra.fr (lucas@toulouse.inra.fr)
Date: Tue Jul 22 15:29:34 2003
Subject: [Rd] read.table with option dec=',' (PR#3532)
Message-ID: <200307221329.h6MDThJH026124@pubhealth.ku.dk>

Full_Name: Antoine Lucas
Version: 1.7.0  (2003-04-16)
OS: Linux
Submission from: (NULL) (193.51.197.253)


I have a problem using read.table:

If in a dataframe, we have a string containing a dot, write.table
will not write any file while using option "dec=','".

Example

> m <- "1.5"
> write.table(m,dec=',')
Error in if (n%%nrowv == 0) value <- value[rep(1:nrowv, length = n), ,  : 
        missing value where TRUE/FALSE needed
In addition: Warning messages: 
1: no finite arguments to min; returning Inf 
2: no finite arguments to max; returning -Inf 

Whereas the contrary write the table:
> m <- "1,5"
> write.table(m,dec='.')
"x"
"1" "1,5"


Best regards

Antoine Lucas

--
Antoine  Lucas        
INRA, Unité de biométrie et     |  Tel 05 61 28 53 34
intelligence artificielle       |  Fax 05 61 28 53 35
http://genopole.toulouse.inra.fr/~lucas

From tplate at blackmesacapital.com  Tue Jul 22 18:27:01 2003
From: tplate at blackmesacapital.com (tplate@blackmesacapital.com)
Date: Tue Jul 22 17:26:50 2003
Subject: [Rd] read.table with option dec=',' (PR#3532)
Message-ID: <200307221527.h6MFR1JH027167@pubhealth.ku.dk>

The problem appears to occur in the following expression from write.table():

    x[num] <- lapply(x[num], function(z) gsub("\\.", ",",as.character(z)))

which gives an error when 'num' has length zero (for what it's worth, the 
RHS evaluated to list()).

The error reported occurs when dec= is supplied to write.table() and the 
table has no numeric columns.

Data frame column assignment does not appear able to handle the case where 
the index has zero length, as in the following example

 > x <- data.frame(x="1.5")
 > num <- numeric(0)
 > x[num] <- list()
Error in if (n%%nrowv == 0) value <- value[rep(1:nrowv, length = n), ,  :
         missing value where TRUE/FALSE needed
In addition: Warning messages:
1: no finite arguments to min; returning Inf
2: no finite arguments to max; returning -Inf
 > traceback()
2: "[<-.data.frame"(*tmp*, num, value = list())
1: "[<-"(*tmp*, num, value = list())
 >

Possible fixes are to either guard the expression in write.table() with 'if 
(length(num))' or to change "[<-.data.frame"() to handle this case.

(I note that S-plus 6.1 under Windows and R1.6.2 under Windows also 
generate an error with this type of data frame assignment, so it does not 
appear to be a new bug with data frame assignment, and is probably best 
fixed with the simple change to write.table())

-- Tony Plate

At Tuesday 03:29 PM 7/22/2003 +0200, lucas@toulouse.inra.fr wrote:
>Full_Name: Antoine Lucas
>Version: 1.7.0  (2003-04-16)
>OS: Linux
>Submission from: (NULL) (193.51.197.253)
>
>
>I have a problem using read.table:
>
>If in a dataframe, we have a string containing a dot, write.table
>will not write any file while using option "dec=','".
>
>Example
>
> > m <- "1.5"
> > write.table(m,dec=',')
>Error in if (n%%nrowv == 0) value <- value[rep(1:nrowv, length = n), ,  :
>         missing value where TRUE/FALSE needed
>In addition: Warning messages:
>1: no finite arguments to min; returning Inf
>2: no finite arguments to max; returning -Inf
>
>Whereas the contrary write the table:
> > m <- "1,5"
> > write.table(m,dec='.')
>"x"
>"1" "1,5"
>
>
>Best regards
>
>Antoine Lucas
>
>--
>Antoine  Lucas
>INRA, Unité de biométrie et     |  Tel 05 61 28 53 34
>intelligence artificielle       |  Fax 05 61 28 53 35
>http://genopole.toulouse.inra.fr/~lucas
>
>______________________________________________
>R-devel@stat.math.ethz.ch mailing list
>https://www.stat.math.ethz.ch/mailman/listinfo/r-devel

From ripley at stats.ox.ac.uk  Tue Jul 22 18:10:34 2003
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue Jul 22 18:10:41 2003
Subject: [Rd] read.table with option dec=',' (PR#3532)
In-Reply-To: <200307221527.h6MFR1JH027167@pubhealth.ku.dk>
Message-ID: <Pine.LNX.4.44.0307221708110.19749-100000@gannet.stats>

x[<length-0>] <- list()

is intended to work, and did at one point in R-devel.  Unfortunately I 
added (p:1) at one point since ... it works again now.

On Tue, 22 Jul 2003 tplate@blackmesacapital.com wrote:

> The problem appears to occur in the following expression from write.table():
> 
>     x[num] <- lapply(x[num], function(z) gsub("\\.", ",",as.character(z)))
> 
> which gives an error when 'num' has length zero (for what it's worth, the 
> RHS evaluated to list()).
> 
> The error reported occurs when dec= is supplied to write.table() and the 
> table has no numeric columns.
> 
> Data frame column assignment does not appear able to handle the case where 
> the index has zero length, as in the following example
> 
>  > x <- data.frame(x="1.5")
>  > num <- numeric(0)
>  > x[num] <- list()
> Error in if (n%%nrowv == 0) value <- value[rep(1:nrowv, length = n), ,  :
>          missing value where TRUE/FALSE needed
> In addition: Warning messages:
> 1: no finite arguments to min; returning Inf
> 2: no finite arguments to max; returning -Inf
>  > traceback()
> 2: "[<-.data.frame"(*tmp*, num, value = list())
> 1: "[<-"(*tmp*, num, value = list())
>  >
> 
> Possible fixes are to either guard the expression in write.table() with 'if 
> (length(num))' or to change "[<-.data.frame"() to handle this case.
> 
> (I note that S-plus 6.1 under Windows and R1.6.2 under Windows also 
> generate an error with this type of data frame assignment, so it does not 
> appear to be a new bug with data frame assignment, and is probably best 
> fixed with the simple change to write.table())
> 
> -- Tony Plate
> 
> At Tuesday 03:29 PM 7/22/2003 +0200, lucas@toulouse.inra.fr wrote:
> >Full_Name: Antoine Lucas
> >Version: 1.7.0  (2003-04-16)
> >OS: Linux
> >Submission from: (NULL) (193.51.197.253)
> >
> >
> >I have a problem using read.table:
> >
> >If in a dataframe, we have a string containing a dot, write.table
> >will not write any file while using option "dec=','".
> >
> >Example
> >
> > > m <- "1.5"
> > > write.table(m,dec=',')
> >Error in if (n%%nrowv == 0) value <- value[rep(1:nrowv, length = n), ,  :
> >         missing value where TRUE/FALSE needed
> >In addition: Warning messages:
> >1: no finite arguments to min; returning Inf
> >2: no finite arguments to max; returning -Inf
> >
> >Whereas the contrary write the table:
> > > m <- "1,5"
> > > write.table(m,dec='.')
> >"x"
> >"1" "1,5"
> >
> >
> >Best regards
> >
> >Antoine Lucas
> >
> >--
> >Antoine  Lucas
> >INRA, Unit? de biom?trie et     |  Tel 05 61 28 53 34
> >intelligence artificielle       |  Fax 05 61 28 53 35
> >http://genopole.toulouse.inra.fr/~lucas
> >
> >______________________________________________
> >R-devel@stat.math.ethz.ch mailing list
> >https://www.stat.math.ethz.ch/mailman/listinfo/r-devel
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://www.stat.math.ethz.ch/mailman/listinfo/r-devel
> 
> 

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From p.dalgaard at biostat.ku.dk  Tue Jul 22 17:58:51 2003
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard BSA)
Date: Tue Jul 22 18:58:52 2003
Subject: [Rd] read.table with option dec=',' (PR#3532)
In-Reply-To: <200307221329.h6MDThJH026124@pubhealth.ku.dk>
References: <200307221329.h6MDThJH026124@pubhealth.ku.dk>
Message-ID: <x2u19e335i.fsf@biostat.ku.dk>

lucas@toulouse.inra.fr writes:

> Full_Name: Antoine Lucas
> Version: 1.7.0  (2003-04-16)
> OS: Linux
> Submission from: (NULL) (193.51.197.253)
> 
> 
> I have a problem using read.table:
                         ????
 
> If in a dataframe, we have a string containing a dot, write.table
> will not write any file while using option "dec=','".
> 
> Example
> 
> > m <- "1.5"
> > write.table(m,dec=',')
> Error in if (n%%nrowv == 0) value <- value[rep(1:nrowv, length = n), ,  : 
>         missing value where TRUE/FALSE needed
> In addition: Warning messages: 
> 1: no finite arguments to min; returning Inf 
> 2: no finite arguments to max; returning -Inf 
> 
> Whereas the contrary write the table:
> > m <- "1,5"
> > write.table(m,dec='.')
> "x"
> "1" "1,5"

Wrong diagnosis: 

> m <- data.frame(1.5,"1.5")
> write.table(m,dec=',')
"X1.5" "X.1.5."
"1" 1,5 "1.5"

> m <- data.frame("a","b")
> write.table(m,dec=',')
Error in if (n%%nrowv == 0) value <- value[rep(1:nrowv, length = n), ,
:
        missing value where TRUE/FALSE needed
In addition: Warning messages:
1: no finite arguments to min; returning Inf
2: no finite arguments to max; returning -Inf

The problem is unrelated to whether or not there are strings with dots
in. The real reason is that you have no numeric columns. If you don't
have any numeric colums, then you can just leave out the dec argument
since it is not supposed to do anything with character columns. The
code in write.table is conditional on dec != "."; that's why the thing
is unsymmetric in dot and comma.

We should probably treat these borderline cases more gracefully
though. Possibly even at the data frame indexing level: it boils down
to

> x[numeric(0)] <- list()
Error in if (n%%nrowv == 0) value <- value[rep(1:nrowv, length = n), ,
:
        missing value where TRUE/FALSE needed
In addition: Warning messages:
1: no finite arguments to min; returning Inf
2: no finite arguments to max; returning -Inf

and I suppose we might just treat this as a no-op.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From forporphyry at hotmail.com  Wed Jul 23 01:49:05 2003
From: forporphyry at hotmail.com (forporphyry@hotmail.com)
Date: Wed Jul 23 00:48:58 2003
Subject: [Rd] abs() and negative output from fractions() (PR#3536)
Message-ID: <200307222249.h6MMn5JH029128@pubhealth.ku.dk>

Hi,

zeros is output from fractions()

>zeros
[1]   -2 -2/5    1  4/3
>abs(zeros)
[1]   -2 -2/5    1  4/3
>is.numeric(zeros)
[1] TRUE
>abs(zeros[1])
[1] -2
>as.numeric(zeros)
[1] -2.000000 -0.400000  1.000000  1.333333
>abs(as.numeric(zeros))
[1] 2.000000 0.400000 1.000000 1.333333
>version
         _
platform i386-pc-mingw32
arch     i386
os       mingw32
system   i386, mingw32
status
major    1
minor    7.1
year     2003
month    06
day      16
language R

graham lawrence

From tlumley at u.washington.edu  Tue Jul 22 17:28:54 2003
From: tlumley at u.washington.edu (Thomas Lumley)
Date: Wed Jul 23 01:28:52 2003
Subject: [Rd] abs() and negative output from fractions() (PR#3536)
In-Reply-To: <200307222249.h6MMn5JH029128@pubhealth.ku.dk>
Message-ID: <Pine.A41.4.44.0307221628140.122538-100000@homer41.u.washington.edu>

On Wed, 23 Jul 2003 forporphyry@hotmail.com wrote:

> Hi,
>
> zeros is output from fractions()
>
> >zeros
> [1]   -2 -2/5    1  4/3
> >abs(zeros)
> [1]   -2 -2/5    1  4/3
> >is.numeric(zeros)
> [1] TRUE
> >abs(zeros[1])
> [1] -2
> >as.numeric(zeros)
> [1] -2.000000 -0.400000  1.000000  1.333333
> >abs(as.numeric(zeros))
> [1] 2.000000 0.400000 1.000000 1.333333

Why is this a bug?


	-thomas


Thomas Lumley			Assoc. Professor, Biostatistics
tlumley@u.washington.edu	University of Washington, Seattle

From dmurdoch at pair.com  Tue Jul 22 22:07:44 2003
From: dmurdoch at pair.com (Duncan Murdoch)
Date: Wed Jul 23 03:07:57 2003
Subject: [Rd] abs() and negative output from fractions() (PR#3536)
In-Reply-To: <200307222249.h6MMn5JH029128@pubhealth.ku.dk>
References: <200307222249.h6MMn5JH029128@pubhealth.ku.dk>
Message-ID: <e8nrhvoon75dsu40ibcv9rc8cqnuk9r345@4ax.com>

On Wed, 23 Jul 2003 00:49:05 +0200 (MET DST), you wrote:

>Hi,
>
>zeros is output from fractions()
>
>>zeros
>[1]   -2 -2/5    1  4/3
>>abs(zeros)
>[1]   -2 -2/5    1  4/3

The fractions() function is presumably the one from MASS; questions
about contributed packages (even recommended ones) should go to the
package maintainer.  They are not R bugs.

Duncan Murdoch

From ripley at stats.ox.ac.uk  Wed Jul 23 09:47:09 2003
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed Jul 23 09:47:00 2003
Subject: [Rd] abs() and negative output from fractions() (PR#3536)
In-Reply-To: <e8nrhvoon75dsu40ibcv9rc8cqnuk9r345@4ax.com>
Message-ID: <Pine.LNX.4.44.0307230843350.26690-100000@gannet.stats>

On Tue, 22 Jul 2003, Duncan Murdoch wrote:

> On Wed, 23 Jul 2003 00:49:05 +0200 (MET DST), you wrote:
> 
> >Hi,
> >
> >zeros is output from fractions()
> >
> >>zeros
> >[1]   -2 -2/5    1  4/3
> >>abs(zeros)
> >[1]   -2 -2/5    1  4/3
> 
> The fractions() function is presumably the one from MASS; questions
> about contributed packages (even recommended ones) should go to the
> package maintainer.  They are not R bugs.

This is not even a VR bug: no one said abs() is implemented for fractions, 
and it is not.  From the help page:

     Arithmetic operations on `"fractions"' objects are possible.

and abs() is not such an operation.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From B.Rowlingson at lancaster.ac.uk  Wed Jul 23 10:24:18 2003
From: B.Rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Wed Jul 23 10:24:04 2003
Subject: [Rd] abs() and negative output from fractions() (PR#3536)
In-Reply-To: <Pine.LNX.4.44.0307230843350.26690-100000@gannet.stats>
References: <Pine.LNX.4.44.0307230843350.26690-100000@gannet.stats>
Message-ID: <3F1E4632.7090403@lancaster.ac.uk>

Prof Brian Ripley wrote:
> On Tue, 22 Jul 2003, Duncan Murdoch wrote:

> This is not even a VR bug: no one said abs() is implemented for fractions, 
> and it is not.  From the help page:
> 
>      Arithmetic operations on `"fractions"' objects are possible.
> 
> and abs() is not such an operation.
> 

  Something funny is happening with printing fractions - the values seem 
correct under abs() [and other functions]:

 > xf
[1]    2 -2/5  2/5  2/3
 > abs(xf)
[1]    2 -2/5  2/5  2/3
 > abs(xf)[2]
[1] 2/5

  huh?

 > sqrt(xf)
[1]    2 -2/5  2/5  2/3
Warning message:
NaNs produced in: sqrt(xf)

 > sqrt(xf)[1:4]
[1]   8119/5741         NaN     191/302 38804/47525
Warning message:
NaNs produced in: sqrt(xf)

  Bug, undocumented behaviour, feature? I dont know. It all seems to 
work in 1.6.0, so everyone should downgrade now... :)

Baz

From ripley at stats.ox.ac.uk  Wed Jul 23 11:21:22 2003
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed Jul 23 11:21:11 2003
Subject: [Rd] abs() and negative output from fractions() (PR#3536)
In-Reply-To: <3F1E4632.7090403@lancaster.ac.uk>
Message-ID: <Pine.LNX.4.44.0307231019380.27835-100000@gannet.stats>

Something seems wrong in the way the group generics are registered, as 
they are not being called.  As a workaround, add

export(Math.fractions,Ops.fractions,Summary.fractions)

to library/MASS/NAMESPACE and the examples seem to work again.

On Wed, 23 Jul 2003, Barry Rowlingson wrote:

> Prof Brian Ripley wrote:
> > On Tue, 22 Jul 2003, Duncan Murdoch wrote:
> 
> > This is not even a VR bug: no one said abs() is implemented for fractions, 
> > and it is not.  From the help page:
> > 
> >      Arithmetic operations on `"fractions"' objects are possible.
> > 
> > and abs() is not such an operation.
> > 
> 
>   Something funny is happening with printing fractions - the values seem 
> correct under abs() [and other functions]:
> 
>  > xf
> [1]    2 -2/5  2/5  2/3
>  > abs(xf)
> [1]    2 -2/5  2/5  2/3
>  > abs(xf)[2]
> [1] 2/5
> 
>   huh?
> 
>  > sqrt(xf)
> [1]    2 -2/5  2/5  2/3
> Warning message:
> NaNs produced in: sqrt(xf)
> 
>  > sqrt(xf)[1:4]
> [1]   8119/5741         NaN     191/302 38804/47525
> Warning message:
> NaNs produced in: sqrt(xf)
> 
>   Bug, undocumented behaviour, feature? I dont know. It all seems to 
> work in 1.6.0, so everyone should downgrade now... :)
> 
> Baz
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://www.stat.math.ethz.ch/mailman/listinfo/r-devel
> 

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From luke at stat.uiowa.edu  Wed Jul 23 07:12:14 2003
From: luke at stat.uiowa.edu (Luke Tierney)
Date: Wed Jul 23 13:12:03 2003
Subject: [Rd] abs() and negative output from fractions() (PR#3536)
In-Reply-To: <Pine.LNX.4.44.0307231019380.27835-100000@gannet.stats>
Message-ID: <Pine.LNX.4.44.0307230611260.378-100000@itasca2.stat.uiowa.edu>

DispatchGroup was not using R_LookupMethod for the group generic;
should be fixed in R-devel now.

luke

On Wed, 23 Jul 2003, Prof Brian Ripley wrote:

> Something seems wrong in the way the group generics are registered, as 
> they are not being called.  As a workaround, add
> 
> export(Math.fractions,Ops.fractions,Summary.fractions)
> 
> to library/MASS/NAMESPACE and the examples seem to work again.
> 
> On Wed, 23 Jul 2003, Barry Rowlingson wrote:
> 
> > Prof Brian Ripley wrote:
> > > On Tue, 22 Jul 2003, Duncan Murdoch wrote:
> > 
> > > This is not even a VR bug: no one said abs() is implemented for fractions, 
> > > and it is not.  From the help page:
> > > 
> > >      Arithmetic operations on `"fractions"' objects are possible.
> > > 
> > > and abs() is not such an operation.
> > > 
> > 
> >   Something funny is happening with printing fractions - the values seem 
> > correct under abs() [and other functions]:
> > 
> >  > xf
> > [1]    2 -2/5  2/5  2/3
> >  > abs(xf)
> > [1]    2 -2/5  2/5  2/3
> >  > abs(xf)[2]
> > [1] 2/5
> > 
> >   huh?
> > 
> >  > sqrt(xf)
> > [1]    2 -2/5  2/5  2/3
> > Warning message:
> > NaNs produced in: sqrt(xf)
> > 
> >  > sqrt(xf)[1:4]
> > [1]   8119/5741         NaN     191/302 38804/47525
> > Warning message:
> > NaNs produced in: sqrt(xf)
> > 
> >   Bug, undocumented behaviour, feature? I dont know. It all seems to 
> > work in 1.6.0, so everyone should downgrade now... :)
> > 
> > Baz
> > 
> > ______________________________________________
> > R-devel@stat.math.ethz.ch mailing list
> > https://www.stat.math.ethz.ch/mailman/listinfo/r-devel
> > 
> 
> 

-- 
Luke Tierney
University of Iowa                  Phone:             319-335-3386
Department of Statistics and        Fax:               319-335-3017
   Actuarial Science
241 Schaeffer Hall                  email:      luke@stat.uiowa.edu
Iowa City, IA 52242                 WWW:  http://www.stat.uiowa.edu

From prye at shiraz.apana.org.au  Wed Jul 23 13:08:02 2003
From: prye at shiraz.apana.org.au (Peter Rye)
Date: Wed Jul 23 14:08:04 2003
Subject: [Rd] OpenBSD 3.[23] and R-1.7.1
In-Reply-To: <Pine.LNX.4.44.0307191844510.1901-100000@gannet.stats>
References: <Pine.LNX.4.44.0307191844510.1901-100000@gannet.stats>
Message-ID: <8765lt5wnm.fsf@riesling.grape.apana.org.au>

I have been able to compile R on OpenBSD 3.[23] for the i386 platform
(still a.out at the moment).

There are problems with the naming convention for OpenBSD and the shared
libraries which prevents the build completing. I have included patches for
your consideration...I'm not an expert programmer and there may well be
better ways around the problem. I don't *think* my patches break the
configuration for other platforms.

I've also noticed a problem in building the .dvi manuals - I think it's a
texi2dvi problem - see patch below. Anyone else seen this?

Unfortunately I understand that R has another problem when being built on
an OpenBSD ELF platform. I have been unable to build it on the alpha (which
is an ELF platform), and I understand it does not build on OpenBSD-current
for i386, which will become the newest stable version in the next few
months. The OpenBSD-current for i386 will also be ELF.  On the ELF platforms,
the build dies with the following error:

dumping R code in package 'methods'
Error in .Call("R_initialize_methods_metadata", table, PACKAGE = "methods") : 
        .Call function name not in load table
Execution halted
*** Error code 1

I believe this also happens on sparc64 OpenBSD. I *think* it's related to the
ELF format.

I have tried ensuring that the main link flags include "-Wl,-E" or
"-Wl,-export-dynamic", turning off optimisation, building with
"--enable-R-shlib", and ensuring that "-fPIC" is passed to the final link
stage in addition to "-shared".
Unfortunately none of the above seem to resolve the error. Does anyone have
any other suggestions, or suggestions of how to debug the problem further?
I'd love to have R running reliably on OpenBSD platforms other than i386.

Compiler is gcc version 2.95.3 20010125 (prerelease).


My patches for OpenBSD i386 follow:

--- configure.orig	Mon Jun 16 19:33:02 2003
+++ configure	Sat Jul 19 17:32:27 2003
@@ -469,7 +469,7 @@
 # include <unistd.h>
 #endif"
 
-ac_subst_vars='SHELL PATH_SEPARATOR PACKAGE_NAME PACKAGE_TARNAME PACKAGE_VERSION PACKAGE_STRING PACKAGE_BUGREPORT exec_prefix prefix program_transform_name bindir sbindir libexecdir datadir sysconfdir sharedstatedir localstatedir libdir includedir oldincludedir infodir mandir build_alias host_alias target_alias DEFS ECHO_C ECHO_N ECHO_T LIBS INSTALL_PROGRAM INSTALL_SCRIPT INSTALL_DATA PACKAGE VERSION ACLOCAL AUTOCONF AUTOMAKE AUTOHEADER MAKEINFO SET_MAKE build build_cpu build_vendor build_os host host_cpu host_vendor host_os R_PLATFORM R_OSTYPE config_opts WANT_R_SHLIB_TRUE WANT_R_SHLIB_FALSE LIBR MAINTAINER_MODE_TRUE MAINTAINER_MODE_FALSE USE_LIBTOOL_TRUE USE_LIBTOOL_FALSE R_PRINTCMD R_PAPERSIZE R_BATCHSAVE MAIN_CFLAGS SHLIB_CFLAGS MAIN_FFLAGS SHLIB_FFLAGS MAIN_LD MAIN_LDFLAGS CPICFLAGS FPICFLAGS SHLIB_LD SHLIB_LDFLAGS CXXPICFLAGS SHLIB_CXXLD SHLIB_CXXLDFLAGS TCLTK_LIBS TCLTK_CPPFLAGS MAKE F2C R_BROWSER GETWD BUILDDIR_IS_SRCDIR AWK EGREP LN_S RANLIB ac_ct_RANLIB YACC AR AR!
FLAGS JAVAC PAGER PERL FALSE NO_PERL5 TAR DVIPS TEX LATEX MAKEINDEX PDFTEX PDFLATEX MAKEINFO_CMD INSTALL_INFO R_RD4DVI R_RD4PDF R_UNZIPCMD R_ZIPCMD CC CFLAGS LDFLAGS CPPFLAGS ac_ct_CC EXEEXT OBJEXT ECHO STRIP ac_ct_STRIP CPP LIBTOOL LIBTOOL_DEPS R_PDFVIEWER F77 FFLAGS ac_ct_F77 CXX CXXFLAGS ac_ct_CXX CXXCPP shlibpath_var LIBM FLIBS HAVE_DOUBLE_COMPLEX COMPILE_DOUBLE_COMPLEX_TRUE COMPILE_DOUBLE_COMPLEX_FALSE SHLIB_CXXFLAGS F2CFLAGS R_XTRA_CFLAGS R_XTRA_CPPFLAGS R_XTRA_CXXFLAGS R_XTRA_FFLAGS R_XTRA_LIBS XMKMF SHLIB_LIBADD SHLIB_EXT USE_EXPORTFILES_TRUE USE_EXPORTFILES_FALSE DYLIB_EXT LIBR_LDFLAGS RLAPACK_LDFLAGS LAPACK_LDFLAGS ALLOCA RMATH_HAVE_EXPM1 RMATH_HAVE_LOG1P LIBOBJS BLAS_LIBS USE_EXTERNAL_BLAS_TRUE USE_EXTERNAL_BLAS_FALSE LAPACK_LIBS USE_EXTERNAL_LAPACK_TRUE USE_EXTERNAL_LAPACK_FALSE R_GUIS X_CFLAGS X_PRE_LIBS X_LIBS X_EXTRA_LIBS GNOME_LIBS GNOMEUI_LIBS GNOMEGNORBA_LIBS GTKXMHTML_LIBS ZVT_LIBS GNOME_LIBDIR GNOME_INCLUDEDIR GNOME_CONFIG ORBIT_CONFIG ORBIT_IDL HAVE_ORBI!
T_TRUE HAVE_ORBIT_FALSE ORBIT_CFLAGS ORBIT_LIBS HAVE_GNORBA_T!
 RUE HAVE
_GNORBA_FALSE GNORBA_CFLAGS GNORBA_LIBS GNOME_APPLETS_LIBS GNOME_CAPPLET_LIBS LIBGLADE_CONFIG LIBGLADE_CFLAGS LIBGLADE_LIBS HAVE_GNOME GNOME_IF_FILES TCL_CONFIG TK_CONFIG use_tcltk BITMAP_LIBS BUILD_XDR_TRUE BUILD_XDR_FALSE BUILD_ZLIB_TRUE BUILD_ZLIB_FALSE USE_MMAP_ZLIB_TRUE USE_MMAP_ZLIB_FALSE BUILD_BZLIB_TRUE BUILD_BZLIB_FALSE BUILD_PCRE_TRUE BUILD_PCRE_FALSE R_PROFILING PAPERCONF R_LD_LIBRARY_PATH USE_RECOMMENDED_PACKAGES_TRUE USE_RECOMMENDED_PACKAGES_FALSE LTLIBOBJS'
+ac_subst_vars='SHELL PATH_SEPARATOR PACKAGE_NAME PACKAGE_TARNAME PACKAGE_VERSION PACKAGE_STRING PACKAGE_BUGREPORT exec_prefix prefix program_transform_name bindir sbindir libexecdir datadir sysconfdir sharedstatedir localstatedir libdir includedir oldincludedir infodir mandir build_alias host_alias target_alias DEFS ECHO_C ECHO_N ECHO_T LIBS INSTALL_PROGRAM INSTALL_SCRIPT INSTALL_DATA PACKAGE VERSION ACLOCAL AUTOCONF AUTOMAKE AUTOHEADER MAKEINFO SET_MAKE build build_cpu build_vendor build_os host host_cpu host_vendor host_os R_PLATFORM R_OSTYPE config_opts WANT_R_SHLIB_TRUE WANT_R_SHLIB_FALSE LIBR MAINTAINER_MODE_TRUE MAINTAINER_MODE_FALSE USE_LIBTOOL_TRUE USE_LIBTOOL_FALSE R_PRINTCMD R_PAPERSIZE R_BATCHSAVE MAIN_CFLAGS SHLIB_CFLAGS MAIN_FFLAGS SHLIB_FFLAGS MAIN_LD MAIN_LDFLAGS CPICFLAGS FPICFLAGS SHLIB_LD SHLIB_LDFLAGS CXXPICFLAGS SHLIB_CXXLD SHLIB_CXXLDFLAGS TCLTK_LIBS TCLTK_CPPFLAGS MAKE F2C R_BROWSER GETWD BUILDDIR_IS_SRCDIR AWK EGREP LN_S RANLIB ac_ct_RANLIB YACC AR AR!
FLAGS JAVAC PAGER PERL FALSE NO_PERL5 TAR DVIPS TEX LATEX MAKEINDEX PDFTEX PDFLATEX MAKEINFO_CMD INSTALL_INFO R_RD4DVI R_RD4PDF R_UNZIPCMD R_ZIPCMD CC CFLAGS LDFLAGS CPPFLAGS ac_ct_CC EXEEXT OBJEXT ECHO STRIP ac_ct_STRIP CPP LIBTOOL LIBTOOL_DEPS R_PDFVIEWER F77 FFLAGS ac_ct_F77 CXX CXXFLAGS ac_ct_CXX CXXCPP shlibpath_var LIBM FLIBS HAVE_DOUBLE_COMPLEX COMPILE_DOUBLE_COMPLEX_TRUE COMPILE_DOUBLE_COMPLEX_FALSE SHLIB_CXXFLAGS F2CFLAGS R_XTRA_CFLAGS R_XTRA_CPPFLAGS R_XTRA_CXXFLAGS R_XTRA_FFLAGS R_XTRA_LIBS XMKMF SHLIB_LIBADD SHLIB_EXT MODULELIB_EXT USE_EXPORTFILES_TRUE USE_EXPORTFILES_FALSE DYLIB_EXT LIBR_LDFLAGS RLAPACK_LDFLAGS LAPACK_LDFLAGS ALLOCA RMATH_HAVE_EXPM1 RMATH_HAVE_LOG1P LIBOBJS BLAS_LIBS USE_EXTERNAL_BLAS_TRUE USE_EXTERNAL_BLAS_FALSE LAPACK_LIBS USE_EXTERNAL_LAPACK_TRUE USE_EXTERNAL_LAPACK_FALSE R_GUIS X_CFLAGS X_PRE_LIBS X_LIBS X_EXTRA_LIBS GNOME_LIBS GNOMEUI_LIBS GNOMEGNORBA_LIBS GTKXMHTML_LIBS ZVT_LIBS GNOME_LIBDIR GNOME_INCLUDEDIR GNOME_CONFIG ORBIT_CONFIG ORBIT!
_IDL HAVE_ORBIT_TRUE HAVE_ORBIT_FALSE ORBIT_CFLAGS ORBIT_LIBS!
  HAVE_GN
ORBA_TRUE HAVE_GNORBA_FALSE GNORBA_CFLAGS GNORBA_LIBS GNOME_APPLETS_LIBS GNOME_CAPPLET_LIBS LIBGLADE_CONFIG LIBGLADE_CFLAGS LIBGLADE_LIBS HAVE_GNOME GNOME_IF_FILES TCL_CONFIG TK_CONFIG use_tcltk BITMAP_LIBS BUILD_XDR_TRUE BUILD_XDR_FALSE BUILD_ZLIB_TRUE BUILD_ZLIB_FALSE USE_MMAP_ZLIB_TRUE USE_MMAP_ZLIB_FALSE BUILD_BZLIB_TRUE BUILD_BZLIB_FALSE BUILD_PCRE_TRUE BUILD_PCRE_FALSE R_PROFILING PAPERCONF R_LD_LIBRARY_PATH USE_RECOMMENDED_PACKAGES_TRUE USE_RECOMMENDED_PACKAGES_FALSE LTLIBOBJS'
 ac_subst_files='r_cc_rules_frag r_f77_rules_frag r_cxx_rules_frag'
 
 # Initialize some variables set by options.
@@ -17689,6 +17689,7 @@
 shlib_ld="${CC}"
 shlib_cxxld="${CXX}"
 SHLIB_EXT=".so"
+MODULELIB_EXT="${SHLIB_EXT}"
 SHLIB_LIBADD=
 use_exportfiles=no
 
@@ -17838,6 +17839,7 @@
     ;;
   hpux*)
     SHLIB_EXT=".sl"
+    MODULELIB_EXT="${SHLIB_EXT}"
     case "${CC}" in
       cc|c89)
         cpicflags="+Z"
@@ -17881,6 +17883,7 @@
     ;;
   mingw*)
     SHLIB_EXT=".dll"
+    MODULELIB_EXT="${SHLIB_EXT}"
     cpicflags=
     cxxpicflags=
     fpicflags=
@@ -17893,6 +17896,11 @@
       shlib_ldflags="-Bshareable"
     fi
     ;;
+  openbsd3*)
+    PACKAGE_VERSION_MAJOR=`echo ${PACKAGE_VERSION} | sed -e "s/\.//" -e "s/\..*$//"`
+    PACKAGE_VERSION_MINOR=`echo ${PACKAGE_VERSION} | sed -e "s/.*\.\([^.][^.]*$\)/\1/"`
+    MODULELIB_EXT=".so.${PACKAGE_VERSION_MAJOR}.${PACKAGE_VERSION_MINOR}"
+    ;;
   osf*)
     cpicflags=
     cxxpicflags=
@@ -18082,6 +18090,9 @@
       LAPACK_LDFLAGS="+s"
     fi
     ;;
+  openbsd3*)
+    DYLIB_EXT="${MODULELIB_EXT}"
+    ;;
 esac
 
 
@@ -26463,6 +26474,7 @@
 s,@XMKMF@,$XMKMF,;t t
 s,@SHLIB_LIBADD@,$SHLIB_LIBADD,;t t
 s,@SHLIB_EXT@,$SHLIB_EXT,;t t
+s,@MODULELIB_EXT@,$MODULELIB_EXT,;t t
 s,@USE_EXPORTFILES_TRUE@,$USE_EXPORTFILES_TRUE,;t t
 s,@USE_EXPORTFILES_FALSE@,$USE_EXPORTFILES_FALSE,;t t
 s,@DYLIB_EXT@,$DYLIB_EXT,;t t



--- Makeconf.in.orig    Wed Jul 23 22:03:55 2003
+++ Makeconf.in Wed Jul 23 22:04:33 2003
@@ -54,6 +54,7 @@
 @USE_LIBTOOL_TRUE@MAIN_LINK = $(LIBTOOL) --mode=link $(MAIN_LD) $(MAIN_LDFLAGS) $(LDFLAGS)
 MAKEINDEX = @MAKEINDEX@
 MKINSTALLDIRS = $(top_srcdir)/tools/mkinstalldirs
+MODULELIB_EXT = @MODULELIB_EXT@
 PERL = @PERL@
 R_GUIS = @R_GUIS@
 R_OSTYPE = @R_OSTYPE@



--- doc/manual/Makefile.in.orig	Fri Sep  6 07:44:00 2002
+++ doc/manual/Makefile.in	Thu Dec 12 17:14:51 2002
@@ -34,7 +34,8 @@
 MAKEINFO_TEXT_OPTS = --number-sections --fill-column=76 --no-split --no-headers
 TEXI2HTML = $(MAKEINFO) $(MAKEINFO_HTML_OPTS)
 TEXI2TEXT = $(MAKEINFO) $(MAKEINFO_TEXT_OPTS)
-TEXI2DVI = $(top_builddir)/bin/texi2dvi --texinfo="@set UseExternalXrefs"
+# Looks like a bug in texi2dvi to me - needs a space after the --texinfo argument 
+TEXI2DVI = $(top_builddir)/bin/texi2dvi --texinfo="@set UseExternalXrefs "
 TEXI2PDF = $(TEXI2DVI) --pdf
 PDFLATEX = @PDFLATEX@
 PDFTEX = @PDFTEX@

From Simon.Urbanek at math.uni-augsburg.de  Wed Jul 23 17:11:17 2003
From: Simon.Urbanek at math.uni-augsburg.de (Simon Urbanek)
Date: Wed Jul 23 16:11:16 2003
Subject: [Rd] OpenBSD 3.[23] and R-1.7.1
In-Reply-To: <8765lt5wnm.fsf@riesling.grape.apana.org.au>
Message-ID: <870CF8D1-BD17-11D7-B5DF-000A957CEFBA@math.uni-augsburg.de>

On Wednesday, July 23, 2003, at 01:07  PM, Peter Rye wrote:

> I have been able to compile R on OpenBSD 3.[23] for the i386 platform
> (still a.out at the moment).
> [...]
> months. The OpenBSD-current for i386 will also be ELF.  On the ELF 
> platforms,
> the build dies with the following error:
>
> dumping R code in package 'methods'
> Error in .Call("R_initialize_methods_metadata", table, PACKAGE = 
> "methods") :
>         .Call function name not in load table
> Execution halted
> *** Error code 1

I don't know much about OpenBSD, but I experienced the same error on 
Darwin a while ago. It indicated different naming conventions in shlib 
export tables - missing underscore or one too many (in our Darwin case 
no leading underscore should be used although it was prepended by 
default). Basically it means that the necessary function which is to be 
provided in the shared library cannot be found (and the package 
'methods' is the first to attempt to load an external shlib in R). You 
may want to check how your platform uses dlsym and also check the 
linker flags for module libraries. This is just a hint, I have no 
OpenBSD box here to test it.

Cheers,
Simon

---
Simon Urbanek
Department of computer oriented statistics and data analysis
University of Augsburg
Universit?tsstr. 14
86135 Augsburg
Germany

Tel: +49-821-598-2236
Fax: +49-821-598-2200

Simon.Urbanek@Math.Uni-Augsburg.de
http://simon.urbanek.info

From jago at mclink.it  Wed Jul 23 21:33:24 2003
From: jago at mclink.it (Stefano Iacus)
Date: Wed Jul 23 20:33:18 2003
Subject: [Rd] dlopen/dlclose etc for Darwin
Message-ID: <2505D0D0-BD3C-11D7-B1DD-003065CC4CB8@mclink.it>

The current version of R-devel has internal support for 
dlclose/dlopen/dlsym for Darwin.
Configure problems have also been solved thanks to Brian and Kurt.
Having or not libdl.0.dylib etc it is always the internal code that is 
used.


Stefano

From gregory_r_warnes at groton.pfizer.com  Wed Jul 23 18:00:36 2003
From: gregory_r_warnes at groton.pfizer.com (Warnes, Gregory R)
Date: Wed Jul 23 23:00:36 2003
Subject: [Rd] How to do get verbatim in Rd files
Message-ID: <D7A3CFD7825BD6119B880002A58F06C20680A526@groexmb02.pfizer.com>


Attached is a patch to $RSRC/share/perl/R/Rdconv.pm that adds support for
\verbatim{ ... } to the .Rd format.

-Greg

> -----Original Message-----
> From: Kurt Hornik [mailto:hornik@ci.tuwien.ac.at]
> Sent: Wednesday, July 16, 2003 2:31 AM
> To: Warnes, Gregory R
> Cc: 'R-devel@stat.math.ethz.ch'
> Subject: Re: [Rd] How to do get verbatim in Rd files
> 
> 
> >>>>> Warnes, Gregory R writes:
> 
> > I want to include a multi-line code block in the details 
> section of a R
> > manual page.  How do I get an appropriate verbatim-like environment?
> > \verbatim{...} doesn't do the trick,  neither does \code{...}.
> 
> I don't think this is currently possible.
> 
> It would certainly be nice to have something like texinfo's
> @smallexample ...
> 
> Best
> -k
> 



LEGAL NOTICE
Unless expressly stated otherwise, this message is confidential and may be privileged. It is intended for the addressee(s) only. Access to this E-mail by anyone else is unauthorized. If you are not an addressee, any disclosure or copying of the contents of this E-mail or any action taken (or not taken) in reliance on it is unauthorized and may be unlawful. If you are not an addressee, please inform the sender immediately.
From organism at ices.utexas.edu  Thu Jul 24 05:15:00 2003
From: organism at ices.utexas.edu (organism@ices.utexas.edu)
Date: Thu Jul 24 04:14:48 2003
Subject: [Rd] Re: I am puzzled about something in pnorm in R (PR#3545)
Message-ID: <200307240215.h6O2F0JH009140@pubhealth.ku.dk>

sorry for the late reply.  i dunno if anyone ever wrote you back.

although perhaps not written for clarity, i think what appears in the code 
is correct.  the routine only guarantees that one of cum or ccum has a 
valid return value depending on i_tail (the other might as well be 
garbage, but that isn't what's returned).

j


On Wed, 9 Jul 2003 Henrik.Seidel@schering.de wrote:
> Hello,
> 
> I am a bit puzzled about the "swap_tail" macro in pnorm.c of the R sources.
> I cite:
> 
> #define swap_tail                               \
>  if (x > 0.) {/* swap  ccum <--> cum */               \
>      temp = *cum; if(lower) *cum = *ccum; *ccum = temp;     \
>  }
> 
>  It appears to me that ccum and cum should be swapped if x>0 and if lower.
>  However, here we get the following result:
> 
>  1.) x > 0 and lower: ccum will get the old value of cum, cum will get the
>  old value of ccum, so both are swapped
>  2.) x > 0 and not lower: ccum will get the old value of cum, but cum will
>  keep its old value, so values are not swapped but both values are set to
>  the original value of cum
> 
>  Is this the expected behavior?
> 
>  Regards
>  Henrik
> 
>  --
>  Dr. Henrik Seidel, physicist/research scientist in bioinformatics
>  Schering AG, Enabling Technologies, Genomics/Bioinformatics, S109/7/717b,
>  D-13342 Berlin, Germany, Tel.: +49 30 468 16683, Fax.: +49 30 468 96683,
>  Mobile: +49 179 9416872, henrik.seidel@schering.de, http://www.schering.de

From jmc at research.bell-labs.com  Thu Jul 24 12:37:19 2003
From: jmc at research.bell-labs.com (John Chambers)
Date: Thu Jul 24 17:37:38 2003
Subject: [Rd] Revisions of the S4 classes software + ?Documentation
Message-ID: <3F1FFD2F.A1A4105F@research.bell-labs.com>

Some changes to the implementation of S4 classes in the methods package
will be committed to the r-devel version, probably later today.  They
should be largely back-compatible (exception noted below) but they are
fairly extensive, so this is an advance notice.

The changes form the first of a two-stage change aimed at making the
implementation more consistent with R semantics, in particular with
namespaces.  The second stage will involve changes to generic functions
and methods software.

Mainly the changes move towards using only class definition objects and
generic function objects to define classes and methods, as opposed to
the model involving metadata and databases, as in the green book.

For classes, the implication is that class relationships are inferred
from the class definition objects.

Unless you have programmed explicitly with metadata objects (hopefully
not!) the changes should be largely compatible, but the point of this
mail is to alert owners of packages to watch for exceptions.

One known incompatibility has to do with setIs relations that extend the
basic datatypes.  For example, 
  setClass("maybeNumber")
  setIs("numeric", "maybeNumber")
  setIs("logical", "maybeNumber")
defines a new class and says that "numeric" and "logical" extend it.

Once the new code is committed, this will fail, because the definition
of "numeric" is sealed, and cannot be revised.  (That didn't matter
before, since the relation was stored in special metadata objects.)

A special mechanism has been added for this kind of example--the
definition of a union of classes.  See ?setClassUnion once the new code
has been committed.  IMO the new version is clearer--the three lines
above turn into
  setClassUnion("maybeNumber", c("numeric", "logical"))

At the same time, a new Documentation.Rd file will be added with some
online help about documentation for classes and methods--how to get it
and how to write it.  Do ?Documentation.  (The contents will grow over
time.)

John
-- 
John M. Chambers                  jmc@bell-labs.com
Bell Labs, Lucent Technologies    office: (908)582-2681
700 Mountain Avenue, Room 2C-282  fax:    (908)582-3340
Murray Hill, NJ  07974            web: http://www.cs.bell-labs.com/~jmc

From mittal at math.arizona.edu  Thu Jul 24 20:28:38 2003
From: mittal at math.arizona.edu (mittal@math.arizona.edu)
Date: Thu Jul 24 19:29:14 2003
Subject: [Rd] bug? (PR#3550)
Message-ID: <200307241728.h6OHScJH015295@pubhealth.ku.dk>

platform i386-pc-mingw32
arch     i386           
os       mingw32        
system   i386, mingw32  
status                  
major    1              
minor    7.1            
year     2003           
month    06             
day      16             
language R      

I have a Dell Inspiron 4000 laptop with Windows ME.  I recently installed the
1.7 version of R.  The following commands are from my notes for the course I
teach.  They worked in the older version of R (I think it was 1.4) but now seem
to make a blank box with the last command no matter what values are chosen for
angle= and density= .  I don't know if this is a bug or not.

> x<-rnorm(50)
> y<-runif(50)
> plot(x,ann=F,type="n")
> points(x,pch=1)
> points(y,pch=4)
> title(main="Main",xlab="x-axis",ylab="y-axis")
> legend(40,-.5,legend="Test",bty="n")
> legend(42,.5,legend="",angle=45,density=20,cex=.5)

Yashaswini Mittal
Dept. of Math
University of Arizona
Tucson, AZ 85721

-------------------------------------------------
This mail sent through IMP: http://horde.org/imp/

From ripley at stats.ox.ac.uk  Thu Jul 24 19:58:39 2003
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu Jul 24 19:58:30 2003
Subject: [Rd] bug? (PR#3550)
In-Reply-To: <200307241728.h6OHScJH015295@pubhealth.ku.dk>
Message-ID: <Pine.LNX.4.44.0307241851570.1235-100000@gannet.stats>

>From reading the code, I think you need to set fill: shading is a type of
fill, and unless you tell it a colour for the lines they are 
`transparent'.

That may or may not be a bug.  The description in ?rect seems to be!

On Thu, 24 Jul 2003 mittal@math.arizona.edu wrote:

> platform i386-pc-mingw32
> arch     i386           
> os       mingw32        
> system   i386, mingw32  
> status                  
> major    1              
> minor    7.1            
> year     2003           
> month    06             
> day      16             
> language R      
> 
> I have a Dell Inspiron 4000 laptop with Windows ME.  I recently installed the
> 1.7 version of R.  The following commands are from my notes for the course I
> teach.  They worked in the older version of R (I think it was 1.4) but now seem
> to make a blank box with the last command no matter what values are chosen for
> angle= and density= .  I don't know if this is a bug or not.
> 
> > x<-rnorm(50)
> > y<-runif(50)
> > plot(x,ann=F,type="n")
> > points(x,pch=1)
> > points(y,pch=4)
> > title(main="Main",xlab="x-axis",ylab="y-axis")
> > legend(40,-.5,legend="Test",bty="n")
> > legend(42,.5,legend="",angle=45,density=20,cex=.5)
> 
> Yashaswini Mittal
> Dept. of Math
> University of Arizona
> Tucson, AZ 85721
> 
> -------------------------------------------------
> This mail sent through IMP: http://horde.org/imp/
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://www.stat.math.ethz.ch/mailman/listinfo/r-devel
> 

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From michael.watson at bbsrc.ac.uk  Fri Jul 25 15:20:59 2003
From: michael.watson at bbsrc.ac.uk (michael.watson@bbsrc.ac.uk)
Date: Fri Jul 25 14:20:45 2003
Subject: [Rd] R won't use http_proxy (PR#3558)
Message-ID: <200307251220.h6PCKxJH021797@pubhealth.ku.dk>

Full_Name: Michael Watson
Version: 1.7.1
OS: Suse Linux 8.1
Submission from: (NULL) (149.155.96.3)


I am using Suse Linux 8.1:

IAHC-LINUX03:~ # uname -a
Linux IAHC-LINUX03 2.4.20-64GB-SMP #1 SMP Mon Mar 17 17:56:03 UTC 2003 i686
unknown unknown GNU/Linux

and R 1.7.1:

IAHC-LINUX03:~ # R --version
R 1.7.1 (2003-06-16).
Copyright (C) 2003 R Development Core Team

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under the terms of the GNU
General Public License.  For more information about these matters,
see http://www.gnu.org/copyleft/gpl.html.

I have set my http_proxy environment variable to http://wwwcache.bbsrc.ac.uk,
which is the correct address of my proxy.  When I try update.packages() within
R, it does NOT use my proxy at all:

IAHC-LINUX03:~ # echo $http_proxy
http://wwwcache.bbsrc.ac.uk:8080/
IAHC-LINUX03:~ # R

R : Copyright 2003, The R Development Core Team
Version 1.7.1  (2003-06-16)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type `license()' or `licence()' for distribution details.

R is a collaborative project with many contributors.
Type `contributors()' for more information.

Type `demo()' for some demos, `help()' for on-line help, or
`help.start()' for a HTML browser interface to help.
Type `q()' to quit R.

[Previously saved workspace restored]

> options(internet.info=0)
> update.packages()
trying URL `http://cran.r-project.org/src/contrib/PACKAGES'
unable to connect to 'cran.r-project.org' on port 80.
Error in download.file(url = paste(contriburl, "PACKAGES", sep = "/"),  :
        cannot open URL `http://cran.r-project.org/src/contrib/PACKAGES'


You will note that R does not state that it is using a proxy server.

From prye at shiraz.apana.org.au  Fri Jul 25 13:30:31 2003
From: prye at shiraz.apana.org.au (Peter Rye)
Date: Fri Jul 25 14:30:33 2003
Subject: [Rd] OpenBSD 3.[23] and R-1.7.1
In-Reply-To: <870CF8D1-BD17-11D7-B5DF-000A957CEFBA@math.uni-augsburg.de>
References: <870CF8D1-BD17-11D7-B5DF-000A957CEFBA@math.uni-augsburg.de>
Message-ID: <87u19aq1vw.fsf@riesling.grape.apana.org.au>

>>>>> "Simon" == Simon Urbanek <Simon.Urbanek@math.uni-augsburg.de> writes:

    Simon> On Wednesday, July 23, 2003, at 01:07 PM, Peter Rye wrote:
    >> I have been able to compile R on OpenBSD 3.[23] for the i386
    >> platform (still a.out at the moment).  [...]  months. The
    >> OpenBSD-current for i386 will also be ELF.  On the ELF platforms,
    >> the build dies with the following error:
    >> 
    >> dumping R code in package 'methods' Error in
    >> .Call("R_initialize_methods_metadata", table, PACKAGE = "methods") :
    >> .Call function name not in load table Execution halted *** Error
    >> code 1

    Simon> I don't know much about OpenBSD, but I experienced the same
    Simon> error on Darwin a while ago. It indicated different naming
    Simon> conventions in shlib export tables - missing underscore or one
    Simon> too many (in our Darwin case no leading underscore should be
    Simon> used although it was prepended by default).

Thanks Simon,
I believe you're correct.
I thought I'd looked at this previously - it seemed like an obvious
potential problem - however I obviously had not looked carefully enough.

I can now compile R on OpenBSD alpha and i386.
Unfortunately there still seems to be a problem on the alpha, which looks
like a 32/64 bit issue. The linker complains when loading the ts.so library
in particular about symbol size mismatching.

I'll keep looking to see how to sort this out.

I've reviewed my previous OpenBSD patches, which now look like a horribly
clumsy way of fixing the shared library naming problem, and I see they were
mangled in the conversion to html.

For the benefit of anyone else using OpenBSD, here are my revised patches
(just need to get R on the alpha working properly):


<code>

--- configure.orig	Fri Jul 25 12:02:53 2003
+++ configure	Fri Jul 25 12:10:30 2003
@@ -17622,6 +17622,13 @@
     fi
     ## </NOTE>
     ;;
+  openbsd*)
+  if test -z "`echo __ELF__ | $CC -E - | grep __ELF__`"; then     # we're ELF
+    cat >>confdefs.h <<\_ACEOF
+#define HAVE_NO_SYMBOL_UNDERSCORE 1
+_ACEOF
+  fi
+    ;;
   osf*)
     cat >>confdefs.h <<\_ACEOF
 #define HAVE_NO_SYMBOL_UNDERSCORE 1
@@ -17893,6 +17900,12 @@
       shlib_ldflags="-Bshareable"
     fi
     ;;
+  openbsd*)
+    if ${CPP} - -dM < /dev/null | grep __ELF__ >/dev/null ; then  # we're ELF
+      main_ldflags="${wl}-export-dynamic"
+      shlib_ldflags="-shared -fPIC"
+    fi
+    ;;
   osf*)
     cpicflags=
     cxxpicflags=
@@ -18081,6 +18094,12 @@
     else
       LAPACK_LDFLAGS="+s"
     fi
+    ;;
+  openbsd3*)
+    ## Not sure if this is required for earlier versions of OpenBSD
+    PACKAGE_VERSION_MAJOR=`echo ${PACKAGE_VERSION} | sed -e "s/\.//" -e "s/\..*$//"`
+    PACKAGE_VERSION_MINOR=`echo ${PACKAGE_VERSION} | sed -e "s/.*\.\([^.][^.]*$\)/\1/"`
+    DYLIB_EXT=".so.${PACKAGE_VERSION_MAJOR}.${PACKAGE_VERSION_MINOR}"
     ;;
 esac
 


--- doc/manual/Makefile.in.orig	Fri Sep  6 07:44:00 2002
+++ doc/manual/Makefile.in	Thu Dec 12 17:14:51 2002
@@ -34,7 +34,8 @@
 MAKEINFO_TEXT_OPTS = --number-sections --fill-column=76 --no-split --no-headers
 TEXI2HTML = $(MAKEINFO) $(MAKEINFO_HTML_OPTS)
 TEXI2TEXT = $(MAKEINFO) $(MAKEINFO_TEXT_OPTS)
-TEXI2DVI = $(top_builddir)/bin/texi2dvi --texinfo="@set UseExternalXrefs"
+# Looks like a bug in texi2dvi to me - needs a space after the --texinfo argument 
+TEXI2DVI = $(top_builddir)/bin/texi2dvi --texinfo="@set UseExternalXrefs "
 TEXI2PDF = $(TEXI2DVI) --pdf
 PDFLATEX = @PDFLATEX@
 PDFTEX = @PDFTEX@


</code>

From Simon.Urbanek at math.uni-augsburg.de  Fri Jul 25 16:11:28 2003
From: Simon.Urbanek at math.uni-augsburg.de (Simon Urbanek)
Date: Fri Jul 25 15:11:34 2003
Subject: [Rd] OpenBSD 3.[23] and R-1.7.1
In-Reply-To: <87u19aq1vw.fsf@riesling.grape.apana.org.au>
Message-ID: <80ABD7E2-BEA1-11D7-91F5-000A957CEFBA@math.uni-augsburg.de>

On Friday, July 25, 2003, at 01:30  PM, Peter Rye wrote:

> [...]
> I've reviewed my previous OpenBSD patches, which now look like a 
> horribly
> clumsy way of fixing the shared library naming problem, and I see they 
> were
> mangled in the conversion to html.
>
> For the benefit of anyone else using OpenBSD, here are my revised 
> patches
> (just need to get R on the alpha working properly):
>
>
> <code>
>
> -- configure.orig	Fri Jul 25 12:02:53 2003
> ++ configure	Fri Jul 25 12:10:30 2003

Just a side note: it's not a good idea to patch configure, since it is 
auto-generated from configure.ac
You probably want to use following patch for configure.ac: (this one is 
based on current R-devel, but that should be no problem)

--- R-devel/configure.ac        Thu Jul 24 09:38:47 2003
+++ R-devel.patched/configure.ac        Fri Jul 25 15:06:35 2003
@@ -659,6 +659,11 @@
      fi
      ## </NOTE>
      ;;
+  openbsd*)
+    if test -z "`echo __ELF__ | $CC -E - | grep __ELF__`"; then     # 
we're ELF
+      AC_DEFINE(HAVE_NO_SYMBOL_UNDERSCORE)
+    fi
+    ;;
    osf*)
      AC_DEFINE(HAVE_NO_SYMBOL_UNDERSCORE)
      ;;
@@ -885,6 +890,12 @@
        shlib_ldflags="-Bshareable"
      fi
      ;;
+  openbsd*)
+    if ${CPP} - -dM < /dev/null | grep __ELF__ >/dev/null ; then  # 
we're ELF
+      main_ldflags="${wl}-export-dynamic"
+      shlib_ldflags="-shared -fPIC"
+    fi
+    ;;
    osf*)
      cpicflags=
      cxxpicflags=
@@ -1040,6 +1051,12 @@
      else
        LAPACK_LDFLAGS="+s"
      fi
+    ;;
+  openbsd3*)
+    ## Not sure if this is required for earlier versions of OpenBSD
+    PACKAGE_VERSION_MAJOR=`echo ${PACKAGE_VERSION} | sed -e "s/\.//" 
-e "s/\..*$//"`
+    PACKAGE_VERSION_MINOR=`echo ${PACKAGE_VERSION} | sed -e 
"s/.*\.\([^.][^.]*$\)/\1/"`
+    DYLIB_EXT=".so.${PACKAGE_VERSION_MAJOR}.${PACKAGE_VERSION_MINOR}"
      ;;
  esac

Of course you'll need to re-run autoconf after patching.
Again, this is untested since I have no OpenBSD box here.

Cheers,
Simon

---
Simon Urbanek
Department of computer oriented statistics and data analysis
University of Augsburg
Universit?tsstr. 14
86135 Augsburg
Germany

Tel: +49-821-598-2236
Fax: +49-821-598-2200

Simon.Urbanek@Math.Uni-Augsburg.de
http://simon.urbanek.info

From pgilbert at bank-banque-canada.ca  Fri Jul 25 10:59:02 2003
From: pgilbert at bank-banque-canada.ca (Paul Gilbert)
Date: Fri Jul 25 16:00:35 2003
Subject: [Rd] R won't use http_proxy (PR#3558)
In-Reply-To: <200307251220.h6PCKxJH021797@pubhealth.ku.dk>
References: <200307251220.h6PCKxJH021797@pubhealth.ku.dk>
Message-ID: <3F2137A6.9010009@bank-banque-canada.ca>

michael.watson@bbsrc.ac.uk wrote:

>Full_Name: Michael Watson
>Version: 1.7.1
>OS: Suse Linux 8.1
>Submission from: (NULL) (149.155.96.3)
>
>
>I am using Suse Linux 8.1:
>
>IAHC-LINUX03:~ # uname -a
>Linux IAHC-LINUX03 2.4.20-64GB-SMP #1 SMP Mon Mar 17 17:56:03 UTC 2003 i686
>unknown unknown GNU/Linux
>
>and R 1.7.1:
>
>IAHC-LINUX03:~ # R --version
>R 1.7.1 (2003-06-16).
>Copyright (C) 2003 R Development Core Team
>
>R is free software and comes with ABSOLUTELY NO WARRANTY.
>You are welcome to redistribute it under the terms of the GNU
>General Public License.  For more information about these matters,
>see http://www.gnu.org/copyleft/gpl.html.
>
>I have set my http_proxy environment variable to http://wwwcache.bbsrc.ac.uk,
>which is the correct address of my proxy.  When I try update.packages() within
>R, it does NOT use my proxy at all:
>
>IAHC-LINUX03:~ # echo $http_proxy
>http://wwwcache.bbsrc.ac.uk:8080/
>IAHC-LINUX03:~ # R
>  
>
You might need to
    export  http_proxy
before you start R.  (Perhaps this is obvious, but I say it just to be 
sure.) Once R is started try
    Sys.getenv("http_proxy")
to make sure the R process sees it.  Other than that, you might try  
method wget, and then you can test that wget works completely outside of 
R.  One more remote possibility is that you also need ssl_proxy set (and 
exported) since some paranoid systems apparently require ssl on 
connections to the http proxy (or something strange like that).

Paul Gilbert

>R : Copyright 2003, The R Development Core Team
>Version 1.7.1  (2003-06-16)
>
>R is free software and comes with ABSOLUTELY NO WARRANTY.
>You are welcome to redistribute it under certain conditions.
>Type `license()' or `licence()' for distribution details.
>
>R is a collaborative project with many contributors.
>Type `contributors()' for more information.
>
>Type `demo()' for some demos, `help()' for on-line help, or
>`help.start()' for a HTML browser interface to help.
>Type `q()' to quit R.
>
>[Previously saved workspace restored]
>
>  
>
>>options(internet.info=0)
>>update.packages()
>>    
>>
>trying URL `http://cran.r-project.org/src/contrib/PACKAGES'
>unable to connect to 'cran.r-project.org' on port 80.
>Error in download.file(url = paste(contriburl, "PACKAGES", sep = "/"),  :
>        cannot open URL `http://cran.r-project.org/src/contrib/PACKAGES'
>
>
>You will note that R does not state that it is using a proxy server.
>
>______________________________________________
>R-devel@stat.math.ethz.ch mailing list
>https://www.stat.math.ethz.ch/mailman/listinfo/r-devel
>  
>

From slteng at stat.berkeley.edu  Sat Jul 26 03:53:35 2003
From: slteng at stat.berkeley.edu (slteng@stat.berkeley.edu)
Date: Sat Jul 26 02:53:21 2003
Subject: [Rd] --max-mem-size (PR#3562)
Message-ID: <200307260053.h6Q0rZJH025610@pubhealth.ku.dk>

Full_Name: Melinda Teng
Version: 1.71
OS: Windows ME/ Unix
Submission from: (NULL) (67.118.2.50)


Hi,

I had the following message that halted my program in both Windows ME and Unix
system :

   Error: cannot allocate vector of size 781250 Kb
   In addition: Warning message: 
   Reached total allocation of 247Mb: see help(memory.size) 


Action(s) taken :
1. Use --max-mem-size (on Windows) to increase the R allocation memory to
maximum, but I encountered the below message :

    > --max-mem-size
   Error in -max : Invalid argument to unary operator

2. > memory.size(max=TRUE)
   [1] 25714688
   > memory.size()
   [1] 19716928
   > memory.limit(size=NA)
   [1] 259465216
   > memory.limit()
   [1] 259465216


Would greatly appreciate any kind advice or resources.

Thank you very much.

From kjetil at entelnet.bo  Fri Jul 25 22:44:58 2003
From: kjetil at entelnet.bo (kjetil brinchmann halvorsen)
Date: Sat Jul 26 03:45:04 2003
Subject: [Rd] --max-mem-size (PR#3562)
In-Reply-To: <200307260053.h6Q0rZJH025610@pubhealth.ku.dk>
Message-ID: <3F21A4DA.15517.15E9796@localhost>

On 26 Jul 2003 at 2:53, slteng@stat.berkeley.edu wrote:

> Full_Name: Melinda Teng
> Version: 1.71
> OS: Windows ME/ Unix
> Submission from: (NULL) (67.118.2.50)
> 
> 
> Hi,
> 
> I had the following message that halted my program in both Windows ME and Unix
> system :
> 
>    Error: cannot allocate vector of size 781250 Kb
>    In addition: Warning message: 
>    Reached total allocation of 247Mb: see help(memory.size) 
> 
> 
> Action(s) taken :
> 1. Use --max-mem-size (on Windows) to increase the R allocation memory to
> maximum, but I encountered the below message :
> 
>     > --max-mem-size
>    Error in -max : Invalid argument to unary operator

Here it seems you use --max-mem-size as it was an R function, it is 
not.  It is a command line option to the command which starts R, on 
windows, for example Rgui. If you use an icon to start Rgui (as you 
should), set this in the "Destino" field (sorry, that the name in 
spanish, don't know what it is in english).

See also
?Memory

Kjetil Halvorsen

> 
> 2. > memory.size(max=TRUE)
>    [1] 25714688
>    > memory.size()
>    [1] 19716928
>    > memory.limit(size=NA)
>    [1] 259465216
>    > memory.limit()
>    [1] 259465216
> 
> 
> Would greatly appreciate any kind advice or resources.
> 
> Thank you very much.
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://www.stat.math.ethz.ch/mailman/listinfo/r-devel

From pgilbert at bank-banque-canada.ca  Fri Jul 25 23:15:52 2003
From: pgilbert at bank-banque-canada.ca (Paul Gilbert)
Date: Sat Jul 26 04:16:54 2003
Subject: [Rd] --max-mem-size (PR#3562)
In-Reply-To: <200307260053.h6Q0rZJH025610@pubhealth.ku.dk>
References: <200307260053.h6Q0rZJH025610@pubhealth.ku.dk>
Message-ID: <3F21E458.8040403@bank-banque-canada.ca>

Melinda

Your problem does not really qualify as a bug report, or even an r-devel topic, and usually you will get much speedier responses on r-help. Memory limitations have been discussed on r-help several time in the past year. Below is some advice sent in a message about two months ago.

Paul Gilbert


Yan Yu wrote:
...

>> 
>> (2) what decides the memory limit in R, How can increase that?
>  
>

In recent versions of R this is controlled by the operating system, unless you
start R with an option that sets a lower limit than the OS allows. In Linux and
Unix this is controlled by

1/ ulimit (or limit in some shells). This can typically be relaxed by a normal
user to the system limits. On Linux the default max memory is usually not
limited (by ulimit) but it is sometimes necessary to relax the default stack
size.

2/ A combination of the amount of memory and amount of swap space. Roughly, on
Linux, these are added together to give the limit. This has changed over the
years in Linux and may vary on different version of Unix, but typically swap
space increases the size of problem you can handle. Physical memory is faster,
but swap works. Given prices these days you might consider having these add to
around 4G if you want to work on large problems with R.

3/ The architecture of the processor (e.g. 32-bit vs 64-bit). A program cannot
exceed the address space of the architecture (232 = 4G bytes on a typical PC
32-bit processor, 264=a lot more on a 64-bit workstation). The OS itself needs
some of this, so I believe the practical limit on 32-bit Linux is around 3G. (In
any case, there is not much point in have more than 4G of swap+memory on a
32-bit machine.) On a 64-bit architecture with a 64-bit Unix (most workstations)
the application (R) must be compiled as a 64-bit application. Thus the fixing of
Solaris bugs in gcc 3.2.3 has meant that much larger problems can now be handled
with R on Solaris (I believe this was possible before with Sun compilers.) It
should also be possible to compile 64-bit R under (64-bit) Linux on Intel
Itanium and AMD Opteron processors. I have no experience with this (but would be
interested in hearing from anyone that does).

On Windows the situation is different and I am much less familiar with it (and
look forward to being corrected). I believe applications must fit into physical
memory on Windows, that is, they can be swapped out but not partly swapped out.
This means that it is necessary to buy more memory to run bigger R problems. (Of
course, with physical memory problems will run much faster, so you should
consider buying more memory even in Unix.) Windows itself demands some of the
memory, so I believe the practical limit for applications in Windows is 2G
bytes. I understand there is a 64-bit version of Windows under development, but
I don't think it has been released yet.

Paul Gilbert

slteng@stat.berkeley.edu wrote:

>Full_Name: Melinda Teng
>Version: 1.71
>OS: Windows ME/ Unix
>Submission from: (NULL) (67.118.2.50)
>
>
>Hi,
>
>I had the following message that halted my program in both Windows ME and Unix
>system :
>
>   Error: cannot allocate vector of size 781250 Kb
>   In addition: Warning message: 
>   Reached total allocation of 247Mb: see help(memory.size) 
>
>
>Action(s) taken :
>1. Use --max-mem-size (on Windows) to increase the R allocation memory to
>maximum, but I encountered the below message :
>
>    > --max-mem-size
>   Error in -max : Invalid argument to unary operator
>
>2. > memory.size(max=TRUE)
>   [1] 25714688
>   > memory.size()
>   [1] 19716928
>   > memory.limit(size=NA)
>   [1] 259465216
>   > memory.limit()
>   [1] 259465216
>
>
>Would greatly appreciate any kind advice or resources.
>
>Thank you very much.
>
>______________________________________________
>R-devel@stat.math.ethz.ch mailing list
>https://www.stat.math.ethz.ch/mailman/listinfo/r-devel
>  
>

From dmurdoch at pair.com  Fri Jul 25 23:17:41 2003
From: dmurdoch at pair.com (Duncan Murdoch)
Date: Sat Jul 26 04:17:29 2003
Subject: [Rd] --max-mem-size (PR#3562)
In-Reply-To: <3F21A4DA.15517.15E9796@localhost>
References: <200307260053.h6Q0rZJH025610@pubhealth.ku.dk>
	<3F21A4DA.15517.15E9796@localhost>
Message-ID: <g2p3iv0j33f5usf864vdnfgrjhd18177m0@4ax.com>

On Fri, 25 Jul 2003 21:44:58 -0400, "kjetil brinchmann halvorsen"
<kjetil@entelnet.bo> wrote:


>Here it seems you use --max-mem-size as it was an R function, it is 
>not.  It is a command line option to the command which starts R, on 
>windows, for example Rgui. If you use an icon to start Rgui (as you 
>should), set this in the "Destino" field (sorry, that the name in 
>spanish, don't know what it is in english).

It's called "Target" in English versions of Windows.  You can edit it
by right-clicking on the icon, and choosing properties.  It shows up
on the "Shortcut" page.

Duncan Murdoch

From ripley at stats.ox.ac.uk  Sat Jul 26 08:53:10 2003
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Sat Jul 26 08:53:10 2003
Subject: [Rd] --max-mem-size (PR#3562)
In-Reply-To: <g2p3iv0j33f5usf864vdnfgrjhd18177m0@4ax.com>
Message-ID: <Pine.LNX.4.44.0307260751370.24428-100000@gannet.stats>

On Fri, 25 Jul 2003, Duncan Murdoch wrote:

> On Fri, 25 Jul 2003 21:44:58 -0400, "kjetil brinchmann halvorsen"
> <kjetil@entelnet.bo> wrote:
> 
> 
> >Here it seems you use --max-mem-size as it was an R function, it is 
> >not.  It is a command line option to the command which starts R, on 
> >windows, for example Rgui. If you use an icon to start Rgui (as you 
> >should), set this in the "Destino" field (sorry, that the name in 
> >spanish, don't know what it is in english).
> 
> It's called "Target" in English versions of Windows.  You can edit it
> by right-clicking on the icon, and choosing properties.  It shows up
> on the "Shortcut" page.

And, folks, this *is* in the rw-FAQ, Qs 2.7 and 2.2.



-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From slteng at stat.berkeley.edu  Sat Jul 26 11:30:59 2003
From: slteng at stat.berkeley.edu (slteng@stat.berkeley.edu)
Date: Sat Jul 26 10:30:45 2003
Subject: [Rd] ref #2655 (PR#3566)
Message-ID: <200307260830.h6Q8UxJH026873@pubhealth.ku.dk>

Full_Name: Melinda Teng
Version: 1.7.1
OS: Windows ME
Submission from: (NULL) (67.118.2.50)


Hi,

I understand that R 1.7.0 version (onwards) will solve the issue in #2655.
However, I still find the same error message. That is, a data matrix defined
outside the function containing the stepAIC() (alongwith glm()) is not passed
into the function. This data matrix is defined as one of the function
parameters.

Error in model.frame.default(formula = Y ~ X4, data = A, drop.unused.levels =
TRUE) : 
        Object "A" not found


Greatly appreciate any advice.

Thank you very much.

From ripley at stats.ox.ac.uk  Sat Jul 26 10:59:05 2003
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Sat Jul 26 10:58:55 2003
Subject: [Rd] ref #2655 (PR#3566)
In-Reply-To: <200307260830.h6Q8UxJH026873@pubhealth.ku.dk>
Message-ID: <Pine.LNX.4.44.0307260951310.24675-100000@gannet.stats>

There is nothing here to reproduce!  Please do not use R-bugs for help 
requests (and please do use a meaningful subject line).  Also, R-bugs is 
not the place to report bugs (if you find one) in contributed packages, 
and stepAIC is in a contributed package (MASS).  You have not even told us 
the version of that package which you have used.  [All this is in the FAQ 
and in ?bug.report, so please read them. Especially since you did the 
same things with PR#2655.]

This is unlikely to be a bug, more likely a limitation of R's scope rules.
If you send a reproducible example to R-help you are likely to get help 
about how to attack your problem in R.

On Sat, 26 Jul 2003 slteng@stat.berkeley.edu wrote:

> Full_Name: Melinda Teng
> Version: 1.7.1
> OS: Windows ME
> Submission from: (NULL) (67.118.2.50)
> 
> 
> Hi,
> 
> I understand that R 1.7.0 version (onwards) will solve the issue in #2655.
> However, I still find the same error message. That is, a data matrix defined
> outside the function containing the stepAIC() (alongwith glm()) is not passed
> into the function. This data matrix is defined as one of the function
> parameters.
> 
> Error in model.frame.default(formula = Y ~ X4, data = A, drop.unused.levels =
> TRUE) : 
>         Object "A" not found

In that usage A should be a data frame, not a matrix, BTW.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From hornik at ci.tuwien.ac.at  Sat Jul 26 19:57:49 2003
From: hornik at ci.tuwien.ac.at (Kurt Hornik)
Date: Sat Jul 26 19:09:42 2003
Subject: [Rd] OpenBSD 3.[23] and R-1.7.1
In-Reply-To: <80ABD7E2-BEA1-11D7-91F5-000A957CEFBA@math.uni-augsburg.de>
References: <87u19aq1vw.fsf@riesling.grape.apana.org.au>
	<80ABD7E2-BEA1-11D7-91F5-000A957CEFBA@math.uni-augsburg.de>
Message-ID: <16162.45837.501955.106341@mithrandir.hornik.net>

>>>>> Simon Urbanek writes:

> On Friday, July 25, 2003, at 01:30  PM, Peter Rye wrote:
>> [...]
>> I've reviewed my previous OpenBSD patches, which now look like a 
>> horribly
>> clumsy way of fixing the shared library naming problem, and I see they 
>> were
>> mangled in the conversion to html.
>> 
>> For the benefit of anyone else using OpenBSD, here are my revised 
>> patches
>> (just need to get R on the alpha working properly):
>> 
>> 
>> <code>
>> 
>> -- configure.orig	Fri Jul 25 12:02:53 2003
>> ++ configure	Fri Jul 25 12:10:30 2003

> Just a side note: it's not a good idea to patch configure, since it is
> auto-generated from configure.ac You probably want to use following
> patch for configure.ac: (this one is based on current R-devel, but
> that should be no problem)

Thanks for the patch.  I currently cannot connect to franz, but once
again will commit a variant of it: libtool always uses the

  if test -z "`echo __ELF__ | $CC -E - | grep __ELF__`"

for detecting ELF (actually, it also deals with openbsd 2.8 on powerpc)
and seems to think that the versioned dylib exts are always needed.

Pls check.

Best
-k

From prye at shiraz.apana.org.au  Sun Jul 27 12:31:04 2003
From: prye at shiraz.apana.org.au (Peter Rye)
Date: Sun Jul 27 13:31:07 2003
Subject: [Rd] OpenBSD 3.[23] and R-1.7.1
In-Reply-To: <16162.45837.501955.106341@mithrandir.hornik.net>
References: <87u19aq1vw.fsf@riesling.grape.apana.org.au>
	<80ABD7E2-BEA1-11D7-91F5-000A957CEFBA@math.uni-augsburg.de>
	<16162.45837.501955.106341@mithrandir.hornik.net>
Message-ID: <87u198clm4.fsf@riesling.grape.apana.org.au>

>>>>> "Kurt" == Kurt Hornik <hornik@ci.tuwien.ac.at> writes:

    >> Just a side note: it's not a good idea to patch configure, since it
    >> is auto-generated from configure.ac You probably want to use
    >> following patch for configure.ac: (this one is based on current
    >> R-devel, but that should be no problem)

    Kurt> Thanks for the patch.  I currently cannot connect to franz, but
    Kurt> once again will commit a variant of it: libtool always uses the

    Kurt>   if test -z "`echo __ELF__ | $CC -E - | grep __ELF__`"

    Kurt> for detecting ELF (actually, it also deals with openbsd 2.8 on
    Kurt> powerpc) and seems to think that the versioned dylib exts are
    Kurt> always needed.

    Kurt> Pls check.

Yes, the OpenBSD linker fails to recognise libraries which don't end in the
major.minor version numbers. It doesn't care particularly what they are, so
a SHLIB_EXT of .so.0.0 will work perfectly (and that is what I used
initially, but it seemed a little clumsy).
For the libraries accompanying the packages etc. that are only dlopen'ed,
any extension will do, so I left it as ".so" as that is consistent with
most other OS's.

Regards,
Peter Rye

From ligges at statistik.uni-dortmund.de  Sun Jul 27 16:48:19 2003
From: ligges at statistik.uni-dortmund.de (Uwe Ligges)
Date: Sun Jul 27 15:48:05 2003
Subject: [Rd] Re: [R] wireframe: how to remove the frame around my plot?
In-Reply-To: <3F210499.1070007@statistik.uni-dortmund.de>
References: <Pine.OSF.4.44.0307241540230.5790-100000@is06.fas.harvard.edu>	<200307242013.NAA17437@hivnet.ubc.ca>	<3F20410C.84C822C0@statistik.uni-dortmund.de>	<200307251320.23312.deepayansarkar@vsnl.net>
	<3F210499.1070007@statistik.uni-dortmund.de>
Message-ID: <3F23D823.5050306@statistik.uni-dortmund.de>

[moved to R-devel]

Uwe Ligges wrote:

> Deepayan Sarkar wrote:
> 
>> On Thursday 24 July 2003 20:26, Uwe Ligges wrote:
>>
>>> Jerome Asselin wrote:
>>>
>>>> You can specify some options in "par.box". Use col=NA to make the frame
>>>> transparent. See example below (which was modified from the help file).
>>>> See also the "scales" parameter if you want to remove the arrows as 
>>>> well.
>>>>
>>>> Cheers,
>>>> Jerome
>>>>
>>>>     library(lattice)
>>>>     x <- seq(-pi, pi, len = 20)
>>>>     y <- seq(-pi, pi, len = 20)
>>>>     g <- expand.grid(x = x, y = y)
>>>>     g$z <- sin(sqrt(g$x^2 + g$y^2))
>>>>     wireframe(z ~ x * y, g, drape = TRUE,
>>>>               perspective = FALSE,
>>>>               aspect = c(3,1), colorkey = FALSE,
>>>>               par.box = list(col=NA))
>>>
>>>
>>> Which doesn't work on device
>>> trellis.device(windows)
>>> but works well on, e.g.,
>>> trellis.device(postscript)
>>>
>>> Deepayan, since I don't have the time to check that right now: Is this
>>> bug known? Is this a bug in R, grid or lattice?
>>
>>
>>
>> Not sure, and I don't have access to R on Windows right now. This is 
>> probably a grid issue, try doing
>> grid.newpage()
>> grid.lines(gp = gpar(col = NA))
>>
>> But I think col="transparent" would be a better choice than col=NA 
>> here. Does that work on windows() ?
> 
> 
> No, thanks.
> 
> I'll take a closer look later ....

Sorry, I do not have the time to look really close, but a *long shot* is 
that we have discovered a windows-only bug related to the fixed PR#1881.
Perhaps a similar bug in lattice as it was in R-base?

Uwe Ligges

From ripley at stats.ox.ac.uk  Sun Jul 27 16:35:24 2003
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Sun Jul 27 16:35:13 2003
Subject: [Rd] Re: [R] wireframe: how to remove the frame around my plot?
In-Reply-To: <3F23D823.5050306@statistik.uni-dortmund.de>
Message-ID: <Pine.LNX.4.44.0307271512510.4405-100000@gannet.stats>

On Sun, 27 Jul 2003, Uwe Ligges wrote:

> [moved to R-devel]
> 
> Uwe Ligges wrote:
> 
> > Deepayan Sarkar wrote:
> > 
> >> On Thursday 24 July 2003 20:26, Uwe Ligges wrote:
> >>
> >>> Jerome Asselin wrote:
> >>>
> >>>> You can specify some options in "par.box". Use col=NA to make the frame
> >>>> transparent. See example below (which was modified from the help file).
> >>>> See also the "scales" parameter if you want to remove the arrows as 
> >>>> well.
> >>>>
> >>>> Cheers,
> >>>> Jerome
> >>>>
> >>>>     library(lattice)
> >>>>     x <- seq(-pi, pi, len = 20)
> >>>>     y <- seq(-pi, pi, len = 20)
> >>>>     g <- expand.grid(x = x, y = y)
> >>>>     g$z <- sin(sqrt(g$x^2 + g$y^2))
> >>>>     wireframe(z ~ x * y, g, drape = TRUE,
> >>>>               perspective = FALSE,
> >>>>               aspect = c(3,1), colorkey = FALSE,
> >>>>               par.box = list(col=NA))
> >>>
> >>>
> >>> Which doesn't work on device
> >>> trellis.device(windows)
> >>> but works well on, e.g.,
> >>> trellis.device(postscript)
> >>>
> >>> Deepayan, since I don't have the time to check that right now: Is this
> >>> bug known? Is this a bug in R, grid or lattice?
> >>
> >>
> >>
> >> Not sure, and I don't have access to R on Windows right now. This is 
> >> probably a grid issue, try doing
> >> grid.newpage()
> >> grid.lines(gp = gpar(col = NA))
> >>
> >> But I think col="transparent" would be a better choice than col=NA 
> >> here. Does that work on windows() ?
> > 
> > 
> > No, thanks.

It does work for me, correctly producing nothing.

> > I'll take a closer look later ....
> 
> Sorry, I do not have the time to look really close, but a *long shot* is 
> that we have discovered a windows-only bug related to the fixed PR#1881.
> Perhaps a similar bug in lattice as it was in R-base?

Not possible: base graphics and grid graphics use the same set of
primitive operations in the graphics drivers.  *However*, there is a bug
in GA_Line (it's col not fgcolor that is NA) seemingly (cvs is down)  
introduced at the same time.  Once cvs is available again I'll commit it.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From luke at stat.uiowa.edu  Mon Jul 28 12:17:59 2003
From: luke at stat.uiowa.edu (Luke Tierney)
Date: Mon Jul 28 18:18:08 2003
Subject: [Rd] codetools
Message-ID: <Pine.LNX.4.44.0307281116160.29633-100000@itasca.stat.uiowa.edu>

I've put together a package codetools with some tools for examining R
source code.  It is available at

        http://www.stat.uiowa.edu/~luke/R/codetools/codetools.tar.gz

It requires a reasonably current version of R-devel.

The main user functions are:

    checkUsage, checkUsageEnv, checkUsagePackage: Examine closure,
        closures in an environment, closures in a package, and report
        information on possible problems

    findGlobals: Finds global functions and variables used by a function.

    showTree: Prints Lisp-style representation of expression; useful for
        understanding parsing. 

This stuff is a by-product of putting together a more solid framework
for the byte code compiler I am working on and it's still very rough,
but I'm making it available now in the hope that it may be of some use
and to get some feedback and ideas for useful directions of
improvement.

luke


-- 
Luke Tierney
University of Iowa                  Phone:             319-335-3386
Department of Statistics and        Fax:               319-335-3017
   Actuarial Science
241 Schaeffer Hall                  email:      luke@stat.uiowa.edu
Iowa City, IA 52242                 WWW:  http://www.stat.uiowa.edu

From bates at stat.wisc.edu  Mon Jul 28 18:22:48 2003
From: bates at stat.wisc.edu (Douglas Bates)
Date: Mon Jul 28 19:22:49 2003
Subject: [Rd] Recommended way to change defaultPackages under Windows
Message-ID: <6r1xwa36ro.fsf@bates4.stat.wisc.edu>

What is the recommended way to change the default set of packages that
are loaded at startup by R for Windows?  I am writing vignettes for
the Devore6 package which my introductory engineering statistics
students will use and I would like to describe how the R environment
can be changed so that this package is loaded by default.

I understand from the R for Windows FAQ that one way would be to
install a Rprofile or Rprofile.site file containing

options(defaultPackages = c(options("defaultPackages"), "Devore6"))

Would this be the recommended way?

From ripley at stats.ox.ac.uk  Mon Jul 28 20:00:52 2003
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Mon Jul 28 20:00:41 2003
Subject: [Rd] Recommended way to change defaultPackages under Windows
In-Reply-To: <6r1xwa36ro.fsf@bates4.stat.wisc.edu>
Message-ID: <Pine.LNX.4.44.0307281852000.25329-100000@gannet.stats>

On 28 Jul 2003, Douglas Bates wrote:

> What is the recommended way to change the default set of packages that
> are loaded at startup by R for Windows?  I am writing vignettes for
> the Devore6 package which my introductory engineering statistics
> students will use and I would like to describe how the R environment
> can be changed so that this package is loaded by default.
> 
> I understand from the R for Windows FAQ that one way would be to
> install a Rprofile or Rprofile.site file containing
> 
> options(defaultPackages = c(options("defaultPackages"), "Devore6"))
> 
> Would this be the recommended way?

Yes, except that using Rprofile.site (can be called Rprofile) needs write
access to the R installation (or setting an environment file R_PROFILE),
and otherwise it is .Rprofile.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From ligges at statistik.uni-dortmund.de  Mon Jul 28 21:11:45 2003
From: ligges at statistik.uni-dortmund.de (Uwe Ligges)
Date: Mon Jul 28 20:11:26 2003
Subject: [Rd] Recommended way to change defaultPackages under Windows
In-Reply-To: <6r1xwa36ro.fsf@bates4.stat.wisc.edu>
References: <6r1xwa36ro.fsf@bates4.stat.wisc.edu>
Message-ID: <3F256761.20102@statistik.uni-dortmund.de>

Douglas Bates wrote:
> What is the recommended way to change the default set of packages that
> are loaded at startup by R for Windows?  I am writing vignettes for
> the Devore6 package which my introductory engineering statistics
> students will use and I would like to describe how the R environment
> can be changed so that this package is loaded by default.
> 
> I understand from the R for Windows FAQ that one way would be to
> install a Rprofile or Rprofile.site file containing
> 
> options(defaultPackages = c(options("defaultPackages"), "Devore6"))
> 
> Would this be the recommended way?

Right (or use an environment variable). ?options tells us:

"defaultPackages:
the packages that are attached by default when R starts up. Initially 
set from value of the environment variables R_DefaultPackages, or if 
that is unset to c("methods", "ctest"). (Set R_DEFAULT_PACKAGES to NULL 
or a comma-separated list of package names.) A call to options should be 
in your `.Rprofile' file to ensure that the change takes effect before 
the base package is initialized (see Startup)."

But the user's .Rprofile might be more appropriate for students who 
don't have access to R's /etc directory likes in our department's 
configuration.

BTW: Is ?options completely correct?
I have   [1] "ts"      "nls"     "modreg"  "mva"     "ctest"   "methods"
in my list of defaultPackages, not only "methods" and "ctest". Looks 
like an update is required. (talking about R-1.7.1 unpatched)

Uwe

From prye at shiraz.apana.org.au  Tue Jul 29 13:19:04 2003
From: prye at shiraz.apana.org.au (Peter Rye)
Date: Tue Jul 29 14:19:06 2003
Subject: [Rd] OpenBSD-alpha and R-1.7.1 problem
Message-ID: <87brvda92o.fsf@riesling.grape.apana.org.au>

I'm trying to get R running on OpenBSD/alpha.

I've applied some configure patches which I've previously sent to the
R-devel list to allow R to compile on an OpenBSD ELF platform (which
OpenBSD/alpha is, as the i386 port soon will be).

The patched source compiles without problems, and appears to run and
perform properly apart from two (possibly unrelated) problems.

1) On startup there are complaints about mismatched symbol sizes (see
   below). This error message comes from the OpenBSD ld.so, and doesn't
   occur on OpenBSD/i386.

   On further investigation this seems to occur when the modreg and ts
   packages are loaded together. In both packages, the R_*MethodDef arrays
   are declared globally rather than "static const". Changing these
   declarations to static const results in the warning disappearing. I
   think this is *probably* a correct fix. Am I missing something or am I
   talking/writing garbage. The patch is straightforward, I can send it to
   one of you if you wish - then again perhaps it's not the right fix.

2) The second problem is that R core dumps with a SIGFPE on any attempt to
   access a graphics device. The source was compiled with -mieee and again
   with -mieee-with-inexact using gcc. I have tried turning off
   optimisation and turning off the "stack-protector" (which I think is an
   OpenBSD thing) with no improvement. Unfortunately I am having trouble
   finding the location of the FPE. This may not be entirely an R problem,
   but if anyone can shed any light on where to go from here, I would be
   grateful. See below for some other details.

Regards,
Peter Rye



=====================
Startup errors
=====================

shiraz:/var/tmp/R-1.7.1/bin$ ./R

R : Copyright 2003, The R Development Core Team
Version 1.7.1  (2003-06-16)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type `license()' or `licence()' for distribution details.

R is a collaborative project with many contributors.
Type `contributors()' for more information.

Type `demo()' for some demos, `help()' for on-line help, or
`help.start()' for a HTML browser interface to help.
Type `q()' to quit R.

[Previously saved workspace restored]

/var/tmp/R-1.7.1/bin/R.bin: /var/tmp/R-1.7.1/library/ts/libs/ts.so : WARNING: symbol(FortEntries) size mismatch relink your program
/var/tmp/R-1.7.1/bin/R.bin: /var/tmp/R-1.7.1/library/ts/libs/ts.so : WARNING: symbol(CallEntries) size mismatch relink your program
/var/tmp/R-1.7.1/bin/R.bin: /var/tmp/R-1.7.1/library/ts/libs/ts.so : WARNING: symbol(CEntries) size mismatch relink your program
> search()
[1] ".GlobalEnv"      "package:methods" "package:ctest"   "package:mva"    
[5] "package:modreg"  "package:nls"     "package:ts"      "Autoloads"      
[9] "package:base"   
> q() 
Save workspace image? [y/n/c]: n



=======================================================
Minimum packages which trigger the error modreg and ts:
=======================================================

shiraz:/var/tmp/R-1.7.1/bin$ R_DEFAULT_PACKAGES="modreg, ts" ./R --silent    
/var/tmp/R-1.7.1/bin/R.bin: /var/tmp/R-1.7.1/library/modreg/libs/modreg.so : WARNING: symbol(FortEntries) size mismatch relink your program
/var/tmp/R-1.7.1/bin/R.bin: /var/tmp/R-1.7.1/library/modreg/libs/modreg.so : WARNING: symbol(CallEntries) size mismatch relink your program
/var/tmp/R-1.7.1/bin/R.bin: /var/tmp/R-1.7.1/library/modreg/libs/modreg.so : WARNING: symbol(CEntries) size mismatch relink your program
> search()
[1] ".GlobalEnv"     "package:ts"     "package:modreg" "Autoloads"     
[5] "package:base"  
> q()
Save workspace image? [y/n/c]: n



=======================================================
If either modreg or ts are left unloaded - no warning!
=======================================================

shiraz:/var/tmp/R-1.7.1/bin$ R_DEFAULT_PACKAGES="modreg, nls, mva, ctest, methods" ./R --silent
> search()
[1] ".GlobalEnv"      "package:methods" "package:ctest"   "package:mva"    
[5] "package:nls"     "package:modreg"  "Autoloads"       "package:base"   
> q()
Save workspace image? [y/n/c]: n





=======================================================
SIGFPE on executing graphics routine
=======================================================

shiraz:/var/tmp/R-1.7.1$ bin/R

R : Copyright 2003, The R Development Core Team
Version 1.7.1  (2003-06-16)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type `license()' or `licence()' for distribution details.

R is a collaborative project with many contributors.
Type `contributors()' for more information.

Type `demo()' for some demos, `help()' for on-line help, or
`help.start()' for a HTML browser interface to help.
Type `q()' to quit R.

> postscript()
> plot(1:10)
Floating point exception (core dumped) 
> q()
Save workspace image? [y/n/c]: n

[ An empty Rplots.ps file is created prior to the core dump ]


shiraz:/var/tmp/R-1.7.1/bin$ ./R

R : Copyright 2003, The R Development Core Team
Version 1.7.1  (2003-06-16)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type `license()' or `licence()' for distribution details.

R is a collaborative project with many contributors.
Type `contributors()' for more information.

Type `demo()' for some demos, `help()' for on-line help, or
`help.start()' for a HTML browser interface to help.
Type `q()' to quit R.

[Previously saved workspace restored]

> search()
[1] ".GlobalEnv"      "package:methods" "package:ctest"   "package:mva"    
[5] "package:modreg"  "package:nls"     "package:ts"      "Autoloads"      
[9] "package:base"   
> plot(1:10)
Floating point exception (core dumped) 
> q()
Save workspace image? [y/n/c]: n

[ An empty X11 Graphics window is created prior to the core dump ]



shiraz:/var/tmp/R-1.7.1/bin$ gdb
GNU gdb 4.16.1
(gdb) set heuristic-fence-post 10
(gdb) file R.bin
Reading symbols from R.bin...done.
(gdb) core ../R.bin.core              <= This is using postscript()
Core was generated by `R.bin'.
Program terminated with signal 8, Floating point exception.
Cannot access memory at address 0x16039252c.
(gdb) core R.bin.core                 <= This is using x11()
Core was generated by `R.bin'.
Program terminated with signal 8, Floating point exception.
Cannot access memory at address 0x16039252c.

From rd33hlat at yahoo.ca  Tue Jul 29 16:50:14 2003
From: rd33hlat at yahoo.ca (rd33hlat@yahoo.ca)
Date: Tue Jul 29 16:01:06 2003
Subject: [Rd] Next Day Delivery--Phentermine, V1 agra, Meridia ,
	Didrex... a c xxlagnrgb (PR#3583)
Message-ID: <200307291350.h6TDoEJH021355@pubhealth.ku.dk>


--.BFE72A_F.FBA6AB97_814
Content-Type: text/html;
Content-Transfer-Encoding: quoted-printable

<html>

<head>
<title>Online US Pharmacy  p.dalgaard@biostat.ku.dk </title>
</head>

<body>

<p align=3D"center">&nbsp;</p>

<p align=3D"center">You've found it... your convenient, safe and private s=
ource for <br>
FDA approved prescription medications. <br>
<em>Next Day FedEx Delivery on ALL ORDERS!<br>
</em></p>

<p align=3D"center"><a href=3D"http://www.geocities.com/usapmncy72365/"><b=
ig>Click Here for
Website </big></a></p>

<p><strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nb=
sp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&n=
bsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbs=
p;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=

Whether your need is:<br>
</strong></p>
<div align=3D"center"><center>

<table border=3D"1" cellpadding=3D"0" cellspacing=3D"4" width=3D"562" bord=
ercolorlight=3D"#0000FF">
  <tr>
    <td width=3D"168" bgcolor=3D"#D3D3D3"><u><font color=3D"#004080"><stro=
ng>Weight Loss</strong></font></u></td>
    <td width=3D"156" bgcolor=3D"#D3D3D3"><u><font color=3D"#004080"><stro=
ng>Women's Health</strong></font></u></td>
    <td width=3D"88" bgcolor=3D"#D3D3D3"><u><font color=3D"#004080"><stron=
g>Men's Health</strong></font></u></td>
    <td width=3D"134" bgcolor=3D"#D3D3D3"><u><font color=3D"#004080"><stro=
ng>Sexual Health</strong></font></u></td>
  </tr>
  <tr>
    <td width=3D"168">PHENTERMINE<br>
    ADIPEX<br>
    BONTRIL<br>
    PHENDIMETRAZINE<br>
    DIDREX<br>
    IONAMIN<br>
    MERIDIA<br>
    TENUATE<br>
    XENICAL<br>
    </td>
    <td width=3D"156">ORTHO TRI-CYCLEN<br>
    <br>
    VANIQA</td>
    <td width=3D"88">VIAGRA<p>PROPECIA</td>
    <td width=3D"134">ACYCLOVIR<p>VALTREX</td>
  </tr>
</table>
</center></div><div align=3D"center"><center>

<table border=3D"1" cellpadding=3D"0" cellspacing=3D"4" width=3D"59=
%" bordercolorlight=3D"#FF0000">
  <tr>
    <td width=3D"13%" bgcolor=3D"#D3D3D3"><u><strong><font color=3D"#00408=
0">Skin Care</font></strong></u></td>
    <td width=3D"13%" bgcolor=3D"#D3D3D3"><u><strong><font color=3D"#00408=
0">Wellness Aids</font></strong></u></td>
    <td width=3D"13%" bgcolor=3D"#D3D3D3"><u><strong><font color=3D"#00408=
0">Allery and Sinus</font></strong></u></td>
    <td width=3D"13%" bgcolor=3D"#D3D3D3"><u><strong><font color=3D"#00408=
0">Gastro Health</font></strong></u></td>
  </tr>
  <tr>
    <td width=3D"13%">RENOVA<p>RETIN-A</td>
    <td width=3D"13%">CELEBREX<p>TRAMADOL</p>
    <p>ULTRAM</p>
    <p>VIOXX</p>
    <p>ZYBAN</td>
    <td width=3D"13%">ALLEGRA-D<p>FLONASE</p>
    <p>NASACORT-AQ</p>
    <p>NASONEX</p>
    <p>ZYRTEC</td>
    <td width=3D"13%">PRILOSEC</td>
  </tr>
</table>
</center></div><div align=3D"center"><center>
tbmamfdsobi sxf

yau
ypecdyt qbl
<table border=3D"0" cellpadding=3D"0" cellspacing=3D"3" width=3D"50=
%" height=3D"50%">
  <tr>
    <td width=3D"100%" height=3D"50%"><hr>
    <p align=3D"center"><strong><font color=3D"#FF0000"><small>No prior pr=
escription required<br>
    Free medical consultation<br>
    No embarrassment<br>
    Private and confidential<br>
    Discreet packaging</small></font></strong></p>
    <p align=3D"center"><a href=3D"http://www.geocities.com/usapmncy72365/=
"><strong>Click Here for
    Website Details!</strong></a></p>
    <p align=3D"center">&nbsp;</p>
    <hr>
    <p align=3D"center">Our staff consists of U.S. licensed physicians and=
 pharmacists. <br>
    We are dedicated to help you live a <strong>healthy</strong> and <stro=
ng>happy</strong>
    lifestyle.</p>
    <p align=3D"center"><font color=3D"#D61431"><em><u>No prior prescripti=
on is required</u></em></font>,
    and we utilize only <em>licensed and certified</em> U.S. physicians an=
d pharmacies.<br>
    </td>
  </tr>
</table>
</center></div>

<p align=3D"left">&nbsp;</p>

<p align=3D"center">&nbsp;</p>

<p align=3D"center"><font SIZE=3D"2">&nbsp;</p>

<p align=3D"center"></font>&nbsp;</p>
</body>
</html>
gnla jti kxd b
a  rnbhvbi tb
ikwzkzgvvouv
 zcbizpedvqirk  cwiukdgyi e mzt
n
ulddruo
ai mzm

--.BFE72A_F.FBA6AB97_814--

From erickaby12 at starmedia.com  Tue Jul 29 17:34:56 2003
From: erickaby12 at starmedia.com (erickaby12@starmedia.com)
Date: Tue Jul 29 16:44:01 2003
Subject: [Rd] Soliciting For Business Venture and Partnership. (PR#3584)
Message-ID: <200307291434.h6TEYuJH021724@pubhealth.ku.dk>

Attn: 

Soliciting For Business Venture and Partnership. 

My name is MR. ERIC MANBE Chairman of contract award and monitoring  committee of Ministry of Urban and rural development ,my duty as  empowered by the Mauritius Government is to provide the basic amenities,social  recreational activities in urban and rural areas,This programm includes  assistance to deprived Local communities and to co-ordinate projects  and development at the national level, Furthermore, from this projects we  have been able to secure some reasonable amount of U.S.$21.8m(Twenty  one Million Eight Hundred Thousand U.S.Dollars Only)as commision from  various Contractors resulting from over invoicing ,hence all the necessary approvals has been completed. 

These approved fund is now packaged and despatched through a security  company for onward delivery to its final destination. These fund are  first deposited into a vault security before we arrange for its movement  to Europe through diplomatic channel using decoy purporting that the  fund belongs to an expatriate/company , as we are Government officiale ,we  are not allowed to operate/own foreign bank account,Hence we need you  to stand as the beneficiary and claim the fund on our behalf from the  security company. 

Presently I am now in Europe to search for a reliable person/company of  high intergrity /dignity and one with conscience who will claim this  fund on our behalf as the beneficiary,and we have agreed to give you 25%  of the total sum as commission for your assistance/effort. And 5% will  be used to settle every expenses incurred. We will use 70% to invest  under your recommendations and guide and to go into Joint venture  business with you. 

I would greatly appreciate your assistance .Also you call me on my  telephone number for more briefing  31-630 233 995 as I look forward to your  response as soon as possible. 

 All correspondance to this e-mail box{ericmanbe30@hotmail.com} 31 630 233995


Best regards, Mr.E.Manbe

From erickaby12 at starmedia.com  Tue Jul 29 17:34:56 2003
From: erickaby12 at starmedia.com (erickaby12@starmedia.com)
Date: Tue Jul 29 16:59:53 2003
Subject: [Rd] Soliciting For Business Venture and Partnership. (PR#3584)
Message-ID: <200307291434.h6TEYuJH021724@pubhealth.ku.dk>

Attn: 

Soliciting For Business Venture and Partnership. 

My name is MR. ERIC MANBE Chairman of contract award and monitoring  committee of Ministry of Urban and rural development ,my duty as  empowered by the Mauritius Government is to provide the basic amenities,social  recreational activities in urban and rural areas,This programm includes  assistance to deprived Local communities and to co-ordinate projects  and development at the national level, Furthermore, from this projects we  have been able to secure some reasonable amount of U.S.$21.8m(Twenty  one Million Eight Hundred Thousand U.S.Dollars Only)as commision from  various Contractors resulting from over invoicing ,hence all the necessary approvals has been completed. 

These approved fund is now packaged and despatched through a security  company for onward delivery to its final destination. These fund are  first deposited into a vault security before we arrange for its movement  to Europe through diplomatic channel using decoy purporting that the  fund belongs to an expatriate/company , as we are Government officiale ,we  are not allowed to operate/own foreign bank account,Hence we need you  to stand as the beneficiary and claim the fund on our behalf from the  security company. 

Presently I am now in Europe to search for a reliable person/company of  high intergrity /dignity and one with conscience who will claim this  fund on our behalf as the beneficiary,and we have agreed to give you 25%  of the total sum as commission for your assistance/effort. And 5% will  be used to settle every expenses incurred. We will use 70% to invest  under your recommendations and guide and to go into Joint venture  business with you. 

I would greatly appreciate your assistance .Also you call me on my  telephone number for more briefing  31-630 233 995 as I look forward to your  response as soon as possible. 

 All correspondance to this e-mail box{ericmanbe30@hotmail.com} 31 630 233995


Best regards, Mr.E.Manbe

From jmartin2003 at notamusica.com  Tue Jul 29 18:01:46 2003
From: jmartin2003 at notamusica.com (jmartin2003@notamusica.com)
Date: Tue Jul 29 17:01:36 2003
Subject: [Rd] cbind/rbind inconsistency with NULL parameter (PR#3585)
Message-ID: <200307291501.h6TF1kJH021916@pubhealth.ku.dk>

R-Version: 1.7.1  (2003-06-16)
OS: Debian/GNU Linux

cbind and rbind handle NULL parameters inconsistently.

Consider:
  > cbind()
  NULL
  > cbind(NULL)
  NULL

And:
  > cbind(diag(x = 1, 1, 1))
       [,1]
  [1,]    1
  > cbind(NULL, diag(x = 1, 1, 1))
       [,1]
  [1,]    1

These seem to indicate that NULL parameters will be ignored in any call to
cbind and rbind. However:

> cbind(NULL, diag(x = 1, 0, 1))
     [,1] [,2]

I.e. if one dimension of another parameter to cbind/rbind is zero,
cbind/rbind will create a row/column from the NULL parameter.

This inconsistency creates problems in the construction of matrices within
loops and similar constructs.

From ripley at stats.ox.ac.uk  Tue Jul 29 17:02:44 2003
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue Jul 29 17:02:32 2003
Subject: [Rd] (PR#3400)
In-Reply-To: <200307041745.h64HjBJH009366@pubhealth.ku.dk>
Message-ID: <Pine.LNX.4.44.0307291601540.12535-100000@gannet.stats>

Increase $MAXLOOPS in share/perl/R/Rdconv.pm.

This is patched in R-patched and R-devel now.


On Fri, 4 Jul 2003 Martin.Schlather@uni-bayreuth.de wrote:

> 
> Martin Maechler asked me to restate my problem.
> 
> Compiling the file (slightly modified w.r.t. the formerly
> attached file) that can be found at
>      http://www.geo.uni-bayreuth.de/~martin/filetransfer/xswms2d.Rd
> terminates with the error message
> 
> ******* Syntax error: mismatched or missing brackets in
> /-----
>   .....
> \-----
> 
> when compiled by
>     R CMD Rdconv -t txt xswms2d.Rd
> 
> However, the file does not cause any error after deleting the
> line
>       \item{a}{4}
> (line 530), for example. This line is within the simple
> environment
>      \itemize{
>        \item{a}{1} % if this line or
>        \item{a}{2} % this line or
>        \item{a}{3} % this line or
>        \item{a}{4} % this line is deleted no error occurs
>      }
> 
> Although there might be an error in my Rd code, the
> appearance (or not appearance) of the error message is
> surprising, and the reason for the error is not clear
> from the message.
>         _
> platform i686-pc-linux-gnu
> arch     i686
> os       linux-gnu
> system   i686, linux-gnu
> status
> major    1
> minor    7.0
> year     2003
> month    04
> day      16
> language R
> 
> 
> Cheers,
> Martin
> 
> 
> Martin Maechler wrote:
> 
> >>>>>>"Martin" == Martin Schlather <Martin.Schlather@uni-bayreuth.de>
> >>>>>>    on Fri, 4 Jul 2003 15:59:21 +0200 (MET DST) writes:
> >>>>>>
> > 
> > 
> >     Martin> I have attached a larger Rd file that causes an error when
> > 
> > Unfortunately, attachments are always "mangled" when going
> > through R-bugs;  we strongly recommend to put that file on the
> > Net, and only send an URL to it.
> > 
> >     Martin> compiled by
> >     Martin> R CMD Rdconv -t txt xswms2d.Rd
> > 
> >     Martin> (for example). If the size is reduced the error vanishes,
> >     Martin> see the lines 230 and 527 in the file.
> > 
> >     Martin> I could not find an error within my text
> > I know how smart you are, but still, just because you didn't
> > find it, does not really prove ....  ;-)
> > see below
> > 
> >     Martin>  and so my guess is that there is some buffer
> >     Martin> overflow within the compiler.
> > 
> > I don't think so.  When I use cut and paste to recreate your
> > file,
> > and do (in a {t}csh; (ba|k)?sh needs another syntax)
> > 
> >      R CMD Rdconv --debug -t txt xswms2d.Rd >& xswms2d.txt
> > 
> > The resulting file becomes
> > ----------------------------------------------------------
> > -- read file 'xswms2d.Rd';
> > 
> > -- mark_brackets:........................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................!
 ...
> ..............................
> > 
> > ******* Syntax error: mismatched or missing brackets in
> > /-----
> > 
> > \name{xswms2d}
> > \alias{xswms2d}
> > \title{Modelling of water flux and solute transport}
> > 
> > <..........>
> > <..........>
> > 
> > --------------------------------------------------------------
> > 
> > and is even a bit larger than the original.
> > I can hardly believe that
> >   ``Syntax error: mismatched or missing brackets in ...''
> > is caused by a (perl) buffer overflow.
> > 
> > Best regards to Bayreuth, in any case
> >  
> > Martin Maechler <maechler@stat.math.ethz.ch>	http://stat.ethz.ch/~maechler/
> > Seminar fuer Statistik, ETH-Zentrum  LEO C16	Leonhardstr. 27
> > ETH (Federal Inst. Technology)	8092 Zurich	SWITZERLAND
> > phone: x-41-1-632-3408		fax: ...-1228			<><
> > 
> 
> 
> 
> 

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From ripley at stats.ox.ac.uk  Tue Jul 29 17:31:30 2003
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue Jul 29 17:31:17 2003
Subject: [Rd] cbind/rbind inconsistency with NULL parameter (PR#3585)
In-Reply-To: <200307291501.h6TF1kJH021916@pubhealth.ku.dk>
Message-ID: <Pine.LNX.4.44.0307291626460.12797-100000@gannet.stats>

That's as documented, on the help page.  (NULL is a zero-length argument.)
There's even a reason given.

Exactly which part of the help page did you not understand?

On Tue, 29 Jul 2003 jmartin2003@notamusica.com wrote:

> R-Version: 1.7.1  (2003-06-16)
> OS: Debian/GNU Linux
> 
> cbind and rbind handle NULL parameters inconsistently.
> 
> Consider:
>   > cbind()
>   NULL
>   > cbind(NULL)
>   NULL
> 
> And:
>   > cbind(diag(x = 1, 1, 1))
>        [,1]
>   [1,]    1
>   > cbind(NULL, diag(x = 1, 1, 1))
>        [,1]
>   [1,]    1
> 
> These seem to indicate that NULL parameters will be ignored in any call to
> cbind and rbind. However:
> 
> > cbind(NULL, diag(x = 1, 0, 1))
>      [,1] [,2]
> 
> I.e. if one dimension of another parameter to cbind/rbind is zero,
> cbind/rbind will create a row/column from the NULL parameter.
> 
> This inconsistency creates problems in the construction of matrices within
> loops and similar constructs.

So?  It's a documented feature.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From jmartin2003 at notamusica.com  Tue Jul 29 19:40:01 2003
From: jmartin2003 at notamusica.com (Dr. Johannes Martin)
Date: Tue Jul 29 18:39:51 2003
Subject: [Rd] cbind/rbind inconsistency with NULL parameter (PR#3585)
In-Reply-To: <Pine.LNX.4.44.0307291626460.12797-100000@gannet.stats>
Message-ID: <Pine.LNX.4.44.0307291822040.14885-100000@halef.NotaMusica.com>

Dear Professor Brian Ripley,

please excuse my inability to interpret the help page correctly.

:[help(cbind)]
:     For `cbind' (`rbind'), vectors of zero length are ignored unless
:     the result would have zero rows (columns), for S compatibility.

I guess this implies that NULL is a zero length vector, even though
	> is(NULL, "vector")
	[1] FALSE


:[help(cbind)]
:     (Zero-extent matrices do not occur in S and are not ignored in R.)

So, if neither NULL nor zero-extent matrices are ignored in R, I would
not expect the following results.
	> cbind(NULL,diag(0,0,2))
	     [,1] [,2] [,3]
	> cbind(diag(0,0,0),diag(0,0,2))
	     [,1] [,2]
Apparently, zero-extent matrices are ignored in R, or there is a
difference in the way of (not) ignoring zero-extent matrices and NULLs.

> So?  It's a documented feature.
Yes, if you know how to interpret the documentation.

Sincerely
	Johannes Martin

On Tue, 29 Jul 2003, Prof Brian Ripley wrote:

> That's as documented, on the help page.  (NULL is a zero-length argument.)
> There's even a reason given.
>
> Exactly which part of the help page did you not understand?
>
> On Tue, 29 Jul 2003 jmartin2003@notamusica.com wrote:
>
> > R-Version: 1.7.1  (2003-06-16)
> > OS: Debian/GNU Linux
> >
> > cbind and rbind handle NULL parameters inconsistently.
> >
> > Consider:
> >   > cbind()
> >   NULL
> >   > cbind(NULL)
> >   NULL
> >
> > And:
> >   > cbind(diag(x = 1, 1, 1))
> >        [,1]
> >   [1,]    1
> >   > cbind(NULL, diag(x = 1, 1, 1))
> >        [,1]
> >   [1,]    1
> >
> > These seem to indicate that NULL parameters will be ignored in any call to
> > cbind and rbind. However:
> >
> > > cbind(NULL, diag(x = 1, 0, 1))
> >      [,1] [,2]
> >
> > I.e. if one dimension of another parameter to cbind/rbind is zero,
> > cbind/rbind will create a row/column from the NULL parameter.
> >
> > This inconsistency creates problems in the construction of matrices within
> > loops and similar constructs.
>
> So?  It's a documented feature.
>
> --
> Brian D. Ripley,                  ripley@stats.ox.ac.uk
> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> University of Oxford,             Tel:  +44 1865 272861 (self)
> 1 South Parks Road,                     +44 1865 272866 (PA)
> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
>

From brahm at alum.mit.edu  Tue Jul 29 14:06:34 2003
From: brahm at alum.mit.edu (David Brahm)
Date: Tue Jul 29 19:16:20 2003
Subject: [Rd] Recommended way to change defaultPackages under Windows
References: <6r1xwa36ro.fsf@bates4.stat.wisc.edu>
Message-ID: <16166.43419.41267.148773@arbres1a.fmr.com>

Douglas Bates <bates@stat.wisc.edu> wrote:
> options(defaultPackages = c(options("defaultPackages"), "Devore6"))

Just to pick a nit, shouldn't this be:

  options(defaultPackages = c(getOption("defaultPackages"), "Devore6"))

since options("defaultPackages") returns a one-component list, not a vector?
-- 
                              -- David Brahm (brahm@alum.mit.edu)

From hornik at ci.tuwien.ac.at  Wed Jul 30 11:45:30 2003
From: hornik at ci.tuwien.ac.at (Kurt Hornik)
Date: Wed Jul 30 10:58:31 2003
Subject: [Rd] Recommended way to change defaultPackages under Windows
In-Reply-To: <16166.43419.41267.148773@arbres1a.fmr.com>
References: <6r1xwa36ro.fsf@bates4.stat.wisc.edu>
	<16166.43419.41267.148773@arbres1a.fmr.com>
Message-ID: <16167.34218.265722.21169@mithrandir.hornik.net>

>>>>> David Brahm writes:

> Douglas Bates <bates@stat.wisc.edu> wrote:
>> options(defaultPackages = c(options("defaultPackages"), "Devore6"))

> Just to pick a nit, shouldn't this be:

>   options(defaultPackages = c(getOption("defaultPackages"), "Devore6"))

> since options("defaultPackages") returns a one-component list, not a vector?
> -- 
>                               -- David Brahm (brahm@alum.mit.edu)

Either that, or options()$defaultPackages.

-k

From ripley at stats.ox.ac.uk  Wed Jul 30 11:30:04 2003
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed Jul 30 12:08:18 2003
Subject: [Rd] OpenBSD-alpha and R-1.7.1 problem
In-Reply-To: <87brvda92o.fsf@riesling.grape.apana.org.au>
Message-ID: <Pine.LNX.4.44.0307301023390.15604-100000@gannet.stats>

On 29 Jul 2003, Peter Rye wrote:

> I'm trying to get R running on OpenBSD/alpha.
> 
> I've applied some configure patches which I've previously sent to the
> R-devel list to allow R to compile on an OpenBSD ELF platform (which
> OpenBSD/alpha is, as the i386 port soon will be).
> 
> The patched source compiles without problems, and appears to run and
> perform properly apart from two (possibly unrelated) problems.
> 
> 1) On startup there are complaints about mismatched symbol sizes (see
>    below). This error message comes from the OpenBSD ld.so, and doesn't
>    occur on OpenBSD/i386.
> 
>    On further investigation this seems to occur when the modreg and ts
>    packages are loaded together. In both packages, the R_*MethodDef arrays
>    are declared globally rather than "static const". Changing these
>    declarations to static const results in the warning disappearing. I
>    think this is *probably* a correct fix. Am I missing something or am I
>    talking/writing garbage. The patch is straightforward, I can send it to
>    one of you if you wish - then again perhaps it's not the right fix.

It's OK for those arrays to be static, and I am adding that to places 
where they are not (modreg, tools, ts)


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From prye at shiraz.apana.org.au  Wed Jul 30 15:28:11 2003
From: prye at shiraz.apana.org.au (Peter Rye)
Date: Wed Jul 30 16:28:12 2003
Subject: [Rd] OpenBSD-alpha and R-1.7.1 problem
In-Reply-To: <Pine.LNX.4.44.0307301023390.15604-100000@gannet.stats>
References: <Pine.LNX.4.44.0307301023390.15604-100000@gannet.stats>
Message-ID: <87brvc8841.fsf@riesling.grape.apana.org.au>

>>>>> "Prof Ripley" == Prof Brian Ripley <ripley@stats.ox.ac.uk> writes:

    Prof Ripley> On 29 Jul 2003, Peter Rye wrote:
    >> I'm trying to get R running on OpenBSD/alpha.
    >> 
    >> I've applied some configure patches which I've previously sent to
    >> the R-devel list to allow R to compile on an OpenBSD ELF platform
    >> (which OpenBSD/alpha is, as the i386 port soon will be).
    >> 
    >> The patched source compiles without problems, and appears to run and
    >> perform properly apart from two (possibly unrelated) problems.
    >> 
    >> 1) On startup there are complaints about mismatched symbol sizes
    >> (see below). This error message comes from the OpenBSD ld.so, and
    >> doesn't occur on OpenBSD/i386.
    >> 
    >> On further investigation this seems to occur when the modreg and ts
    >> packages are loaded together. In both packages, the R_*MethodDef
    >> arrays are declared globally rather than "static const". Changing
    >> these declarations to static const results in the warning
    >> disappearing. I think this is *probably* a correct fix. Am I missing
    >> something or am I talking/writing garbage. The patch is
    >> straightforward, I can send it to one of you if you wish - then
    >> again perhaps it's not the right fix.

    Prof Ripley> It's OK for those arrays to be static, and I am adding
    Prof Ripley> that to places where they are not (modreg, tools, ts)

Excellent. Further testing here seems to indicate that this is the cause of
the warning on OpenBSD/alpha. These arrays presumably don't necessarily
need to be "const" - correct?


Further to my last post on OpenBSD/alpha.
The FP exceptions and core dumps have remained a problem.
I thought I'd found an obvious "fix", but unfortunately it didn't solve the
problem. I tried applying the patch below which looks "right" but the
fpsetmask() on OpenBSD doesn't do what I thought it should - no doubt a
lack of understanding on my part.

I was however able to get R-devel and R-1.7.1 running eventually with a
rather ugly brute force technique of recompiling a math library for R's
use, using the -mieee flag in the library build. 

This *actually *works** (or appears to in limited testing). Presumably that's
why I couldn't track down the SIGFPE on debugging of R - it may be occuring
the the math library.

It _might_ be an OpenBSD specific problem. Anyone have any experience with
Net or FreeBSD/alpha and R which can shed some further light on this?

Regards,
Peter Rye


<code>

--- src/unix/sys-unix.c.orig    Wed Jul 30 12:12:22 2003
+++ src/unix/sys-unix.c Wed Jul 30 12:55:05 2003
@@ -370,6 +370,15 @@
 # endif
 #endif

+#if defined (__OpenBSD__) || defined (__NetBSD__)
+/*
+I believe Net/OpenBSD uses the same header and system call
+Tested for in configure in R-devel #ifdef HAVE_IEEEFP_H
+*/
+#include <ieeefp.h>
+#endif
+/*                                 #endif */
+
 #ifdef linux
 # ifdef HAVE_FPU_CONTROL_H
 #  include <fpu_control.h>
@@ -379,7 +388,7 @@
 void fpu_setup(Rboolean start)
 {
     if (start) {
-#ifdef __FreeBSD__
+#if defined (__FreeBSD__) || defined (__NetBSD__) || defined (__OpenBSD__)
     fpsetmask(0);
 #endif

@@ -387,7 +396,7 @@
     __setfpucw(_FPU_IEEE);
 #endif
     } else {
-#ifdef __FreeBSD__
+#if defined (__FreeBSD__) || defined (__NetBSD__) || defined (__OpenBSD__)
     fpsetmask(~0);
 #endif

</code>

From ripley at stats.ox.ac.uk  Wed Jul 30 16:40:22 2003
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed Jul 30 16:40:48 2003
Subject: [Rd] OpenBSD-alpha and R-1.7.1 problem
In-Reply-To: <87brvc8841.fsf@riesling.grape.apana.org.au>
Message-ID: <Pine.LNX.4.44.0307301535470.22155-100000@gannet.stats>

On 30 Jul 2003, Peter Rye wrote:

> >>>>> "Prof Ripley" == Prof Brian Ripley <ripley@stats.ox.ac.uk> writes:
> 
>     Prof Ripley> On 29 Jul 2003, Peter Rye wrote:
>     >> I'm trying to get R running on OpenBSD/alpha.
>     >> 
>     >> I've applied some configure patches which I've previously sent to
>     >> the R-devel list to allow R to compile on an OpenBSD ELF platform
>     >> (which OpenBSD/alpha is, as the i386 port soon will be).
>     >> 
>     >> The patched source compiles without problems, and appears to run and
>     >> perform properly apart from two (possibly unrelated) problems.
>     >> 
>     >> 1) On startup there are complaints about mismatched symbol sizes
>     >> (see below). This error message comes from the OpenBSD ld.so, and
>     >> doesn't occur on OpenBSD/i386.
>     >> 
>     >> On further investigation this seems to occur when the modreg and ts
>     >> packages are loaded together. In both packages, the R_*MethodDef
>     >> arrays are declared globally rather than "static const". Changing
>     >> these declarations to static const results in the warning
>     >> disappearing. I think this is *probably* a correct fix. Am I missing
>     >> something or am I talking/writing garbage. The patch is
>     >> straightforward, I can send it to one of you if you wish - then
>     >> again perhaps it's not the right fix.
> 
>     Prof Ripley> It's OK for those arrays to be static, and I am adding
>     Prof Ripley> that to places where they are not (modreg, tools, ts)
> 
> Excellent. Further testing here seems to indicate that this is the cause of
> the warning on OpenBSD/alpha. These arrays presumably don't necessarily
> need to be "const" - correct?

Correct, and there is some danger of a compiler not liking `const'.  
Indeed, we tend to avoid `const' as it has been responsible for far more
than its share of compiler-related bugs.  (gcc 3.3 objected to one use of
const that Solaris cc accepted today.)

There were two more non-static declarations of such tables, in package eda 
and in src/main/registration.c.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From tplate at blackmesacapital.com  Wed Jul 30 10:30:09 2003
From: tplate at blackmesacapital.com (Tony Plate)
Date: Wed Jul 30 17:33:20 2003
Subject: [Rd] cbind/rbind inconsistency with NULL parameter
  (PR#3585)
In-Reply-To: <Pine.LNX.4.44.0307291626460.12797-100000@gannet.stats>
References: <200307291501.h6TF1kJH021916@pubhealth.ku.dk>
Message-ID: <5.2.1.1.2.20030730085934.0403c2e8@mailhost.blackmesacapital.com>

The R help for cbind/rbind states:

>      For `cbind' (`rbind'), vectors of zero length are ignored unless
>      the result would have zero rows (columns), for S compatibility.
>      (Zero-extent matrices do not occur in S and are not ignored in R.)

I presume this means the S language as defined in the Blue Book ("The ^New 
S Language", Becker Chambers & Wilks, 1988), though in a brief reading I 
couldn't find any mention of such a constraint in the sections on Matrices 
and on Arrays (pages 126 thru 135 in my copy), or any mention of such 
constraints or behavior in the descriptions of the functions cbind/rbind() 
and matrix().

FWIW, in S-plus 6.1 zero-extent matrices are allowed, and cbind/rbind do 
not seem to behave in this way (under Windows at least).

E.g.:
S6.1> matrix(nrow=0,ncol=0)
logical matrix: 0 rows, 0 columns.
S6.1> cbind(NULL, matrix(nrow=0,ncol=0))
NULL
S6.1> cbind(numeric(0), matrix(1, nrow=0,ncol=1))
NULL
S6.1>

Also, FWIW, I have argued to Insightful that cbind/rbind returning NULL 
here is a undesirable (along with other examples of inconsistent behavior 
with zero-extent matrices), and they have replied that they have logged 
these as bugs to be fixed in a future release.

-- Tony Plate

At Tuesday 04:31 PM 7/29/2003 +0100, Prof Brian Ripley wrote:
>That's as documented, on the help page.  (NULL is a zero-length argument.)
>There's even a reason given.
>
>Exactly which part of the help page did you not understand?
>
>On Tue, 29 Jul 2003 jmartin2003@notamusica.com wrote:
>
> > R-Version: 1.7.1  (2003-06-16)
> > OS: Debian/GNU Linux
> >
> > cbind and rbind handle NULL parameters inconsistently.
> >
> > Consider:
> >   > cbind()
> >   NULL
> >   > cbind(NULL)
> >   NULL
> >
> > And:
> >   > cbind(diag(x = 1, 1, 1))
> >        [,1]
> >   [1,]    1
> >   > cbind(NULL, diag(x = 1, 1, 1))
> >        [,1]
> >   [1,]    1
> >
> > These seem to indicate that NULL parameters will be ignored in any call to
> > cbind and rbind. However:
> >
> > > cbind(NULL, diag(x = 1, 0, 1))
> >      [,1] [,2]
> >
> > I.e. if one dimension of another parameter to cbind/rbind is zero,
> > cbind/rbind will create a row/column from the NULL parameter.
> >
> > This inconsistency creates problems in the construction of matrices within
> > loops and similar constructs.
>
>So?  It's a documented feature.
>
>--
>Brian D. Ripley,                  ripley@stats.ox.ac.uk
>Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
>University of Oxford,             Tel:  +44 1865 272861 (self)
>1 South Parks Road,                     +44 1865 272866 (PA)
>Oxford OX1 3TG, UK                Fax:  +44 1865 272595
>
>______________________________________________
>R-devel@stat.math.ethz.ch mailing list
>https://www.stat.math.ethz.ch/mailman/listinfo/r-devel

From tplate at blackmesacapital.com  Wed Jul 30 18:33:37 2003
From: tplate at blackmesacapital.com (tplate@blackmesacapital.com)
Date: Wed Jul 30 17:33:42 2003
Subject: [Rd] cbind/rbind inconsistency with NULL parameter (PR#3595)
Message-ID: <200307301533.h6UFXbJH000846@pubhealth.ku.dk>

The R help for cbind/rbind states:

>      For `cbind' (`rbind'), vectors of zero length are ignored unless
>      the result would have zero rows (columns), for S compatibility.
>      (Zero-extent matrices do not occur in S and are not ignored in R.)

I presume this means the S language as defined in the Blue Book ("The ^New 
S Language", Becker Chambers & Wilks, 1988), though in a brief reading I 
couldn't find any mention of such a constraint in the sections on Matrices 
and on Arrays (pages 126 thru 135 in my copy), or any mention of such 
constraints or behavior in the descriptions of the functions cbind/rbind() 
and matrix().

FWIW, in S-plus 6.1 zero-extent matrices are allowed, and cbind/rbind do 
not seem to behave in this way (under Windows at least).

E.g.:
S6.1> matrix(nrow=0,ncol=0)
logical matrix: 0 rows, 0 columns.
S6.1> cbind(NULL, matrix(nrow=0,ncol=0))
NULL
S6.1> cbind(numeric(0), matrix(1, nrow=0,ncol=1))
NULL
S6.1>

Also, FWIW, I have argued to Insightful that cbind/rbind returning NULL 
here is a undesirable (along with other examples of inconsistent behavior 
with zero-extent matrices), and they have replied that they have logged 
these as bugs to be fixed in a future release.

-- Tony Plate

At Tuesday 04:31 PM 7/29/2003 +0100, Prof Brian Ripley wrote:
>That's as documented, on the help page.  (NULL is a zero-length argument.)
>There's even a reason given.
>
>Exactly which part of the help page did you not understand?
>
>On Tue, 29 Jul 2003 jmartin2003@notamusica.com wrote:
>
> > R-Version: 1.7.1  (2003-06-16)
> > OS: Debian/GNU Linux
> >
> > cbind and rbind handle NULL parameters inconsistently.
> >
> > Consider:
> >   > cbind()
> >   NULL
> >   > cbind(NULL)
> >   NULL
> >
> > And:
> >   > cbind(diag(x = 1, 1, 1))
> >        [,1]
> >   [1,]    1
> >   > cbind(NULL, diag(x = 1, 1, 1))
> >        [,1]
> >   [1,]    1
> >
> > These seem to indicate that NULL parameters will be ignored in any call to
> > cbind and rbind. However:
> >
> > > cbind(NULL, diag(x = 1, 0, 1))
> >      [,1] [,2]
> >
> > I.e. if one dimension of another parameter to cbind/rbind is zero,
> > cbind/rbind will create a row/column from the NULL parameter.
> >
> > This inconsistency creates problems in the construction of matrices within
> > loops and similar constructs.
>
>So?  It's a documented feature.
>
>--
>Brian D. Ripley,                  ripley@stats.ox.ac.uk
>Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
>University of Oxford,             Tel:  +44 1865 272861 (self)
>1 South Parks Road,                     +44 1865 272866 (PA)
>Oxford OX1 3TG, UK                Fax:  +44 1865 272595
>
>______________________________________________
>R-devel@stat.math.ethz.ch mailing list
>https://www.stat.math.ethz.ch/mailman/listinfo/r-devel

From pgilbert at bank-banque-canada.ca  Wed Jul 30 12:41:15 2003
From: pgilbert at bank-banque-canada.ca (Paul Gilbert)
Date: Wed Jul 30 17:41:33 2003
Subject: [Rd] Re: [R] Sending emails from R under Windows
In-Reply-To: <20030730101318.B23385@jessie.research.bell-labs.com>
References: <8D0F30FE2EB3314182D4A33F738BB19D063E6E@sqlsrvr.evocapital.com>
	<20030730101318.B23385@jessie.research.bell-labs.com>
Message-ID: <3F27E71B.1090004@bank-banque-canada.ca>

Any chance a utility like this could be incorporated in base and used by 
bug.report. That would make the same utility available to everyone, 
rather than us all inventing the same thing over again.

Paul Gilbert

David James wrote:
> David Khabie-Zeitoune wrote:
> 
>>Hi
>>
>>Does anyone know of any R routines to send emails from R, under Windows?
>>I thought about writing such a facility using the R(D)COM package to
>>drive e.g. MS Outlook, but I don't want to reinvent the wheel. I have
>>found a function Sys.mail in the library syskern, but this only works
>>under Unix by shelling out a mail command. 
>>
>>Thanks,
>>
>>David
>>
>>______________________________________________
>>R-help@stat.math.ethz.ch mailing list
>>https://www.stat.math.ethz.ch/mailman/listinfo/r-help
> 
> 
> The R function sendEmail() below uses the RDCOMClient package
> to control Outlook or Echange -- more precisely, it interfaces to
> Microsoft's Collaboration Data Objects (CDO).  (Please note that 
> I don't use Windows for email, so I couldn't test the function.)
> 
> 
>>sendEmail(ema = "r-help@r-project.org", 
> 
>             name = "R-help mailing list",
>             subject = "How to send Email from R using the RDCOMClient"
>             msgBody = "here is the body of the message")
> 
> The package RDCOMClient is available at http://www.omegahat.org/RDCOMClient.
> 
> "sendEmail" <-
> function(ema, name, subject, msgBody, deliverNow = TRUE)
> {
>    require(RDCOMClient)
> 
>    ema <- paste("SMPT:", ema, sep="")   ## prepend protocol to address
> 
>    ## create an e-mail session 
>    session <- COMCreate("Mapi.Session") 
>    session$Logon()
> 
>    ## add a message to the outbox collection of messages
>    outbox <- session[["Outbox"]]
>    msg <- outbox[["Messages"]]$Add(subject, msgBody)
> 
>    ## add recipient's name  (TODO: addMultiple() or loop, if many recipients)
>    msg[["Recipients"]]$Add(name, ema) 
>    msg$Send()
>    if(deliverNow)
>       msg$DeliverNow()
> 
>    session$Logoff()   ## wrap up
> }
>

From ripley at stats.ox.ac.uk  Wed Jul 30 17:47:10 2003
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed Jul 30 17:47:23 2003
Subject: [Rd] cbind/rbind inconsistency with NULL parameter  (PR#3585)
In-Reply-To: <5.2.1.1.2.20030730085934.0403c2e8@mailhost.blackmesacapital.com>
Message-ID: <Pine.LNX.4.44.0307301637150.28347-100000@gannet.stats>

On Wed, 30 Jul 2003, Tony Plate wrote:

> The R help for cbind/rbind states:
> 
> >      For `cbind' (`rbind'), vectors of zero length are ignored unless
> >      the result would have zero rows (columns), for S compatibility.
> >      (Zero-extent matrices do not occur in S and are not ignored in R.)
> 
> I presume this means the S language as defined in the Blue Book ("The ^New 
> S Language", Becker Chambers & Wilks, 1988), though in a brief reading I 
> couldn't find any mention of such a constraint in the sections on Matrices 
> and on Arrays (pages 126 thru 135 in my copy), or any mention of such 
> constraints or behavior in the descriptions of the functions cbind/rbind() 
> and matrix().

That's R code for `S-PLUS 3.4 compatibility', the system that used (at
least) to be used when checking for compatibility.  E.g.

> cbind(a=1:3, b=integer(0), c=4:6)
     a c
[1,] 1 4
[2,] 2 5
[3,] 3 6
> cbind(a=1:3, b=NULL, c=4:6)
     a c
[1,] 1 4
[2,] 2 5
[3,] 3 6

under S-PLUS 3.4. This is explained (in some way) in the FAQ (Blue & White
books).

> FWIW, in S-plus 6.1 zero-extent matrices are allowed, and cbind/rbind do 
> not seem to behave in this way (under Windows at least).
> 
> E.g.:
> S6.1> matrix(nrow=0,ncol=0)
> logical matrix: 0 rows, 0 columns.

Fails in S-PLUS 3.4.

> S6.1> cbind(NULL, matrix(nrow=0,ncol=0))
> NULL
> S6.1> cbind(numeric(0), matrix(1, nrow=0,ncol=1))
> NULL
> S6.1>
> 
> Also, FWIW, I have argued to Insightful that cbind/rbind returning NULL 
> here is a undesirable (along with other examples of inconsistent behavior 
> with zero-extent matrices), and they have replied that they have logged 
> these as bugs to be fixed in a future release.

No one is attempting compatibility with things introduced in S-PLUS after 
R.


> -- Tony Plate
> 
> At Tuesday 04:31 PM 7/29/2003 +0100, Prof Brian Ripley wrote:
> >That's as documented, on the help page.  (NULL is a zero-length argument.)
> >There's even a reason given.
> >
> >Exactly which part of the help page did you not understand?
> >
> >On Tue, 29 Jul 2003 jmartin2003@notamusica.com wrote:
> >
> > > R-Version: 1.7.1  (2003-06-16)
> > > OS: Debian/GNU Linux
> > >
> > > cbind and rbind handle NULL parameters inconsistently.
> > >
> > > Consider:
> > >   > cbind()
> > >   NULL
> > >   > cbind(NULL)
> > >   NULL
> > >
> > > And:
> > >   > cbind(diag(x = 1, 1, 1))
> > >        [,1]
> > >   [1,]    1
> > >   > cbind(NULL, diag(x = 1, 1, 1))
> > >        [,1]
> > >   [1,]    1
> > >
> > > These seem to indicate that NULL parameters will be ignored in any call to
> > > cbind and rbind. However:
> > >
> > > > cbind(NULL, diag(x = 1, 0, 1))
> > >      [,1] [,2]
> > >
> > > I.e. if one dimension of another parameter to cbind/rbind is zero,
> > > cbind/rbind will create a row/column from the NULL parameter.
> > >
> > > This inconsistency creates problems in the construction of matrices within
> > > loops and similar constructs.
> >
> >So?  It's a documented feature.
> >
> >--
> >Brian D. Ripley,                  ripley@stats.ox.ac.uk
> >Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> >University of Oxford,             Tel:  +44 1865 272861 (self)
> >1 South Parks Road,                     +44 1865 272866 (PA)
> >Oxford OX1 3TG, UK                Fax:  +44 1865 272595
> >
> >______________________________________________
> >R-devel@stat.math.ethz.ch mailing list
> >https://www.stat.math.ethz.ch/mailman/listinfo/r-devel
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://www.stat.math.ethz.ch/mailman/listinfo/r-devel
> 

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From gruteser at colorado.edu  Thu Jul 31 00:36:49 2003
From: gruteser at colorado.edu (gruteser@colorado.edu)
Date: Wed Jul 30 23:36:32 2003
Subject: [Rd] wrong axis scale when plotting on a filled.contour plot
	(PR#3596)
Message-ID: <200307302136.h6ULanJH002406@pubhealth.ku.dk>

Full_Name: Marco Gruteser
Version: 1.7.1
OS: Win XP
Submission from: (NULL) (129.34.20.16)


Let's generate a dummy filled.contour plot

> x <- 1:10
> y <- 1:10
> z <- array(rep(0, times=100),dim=c(10,10))
> filled.contour(x,y,z)

And try to add some points to it, e.g.

> points(8,2)
> points(6,2)

The points show up misaligned with the axis 
somewhere at 9.9,2 and 7.5,2

It appears that the "z value legend" on the right
may have distorted the axis.

From ligges at statistik.uni-dortmund.de  Thu Jul 31 11:26:18 2003
From: ligges at statistik.uni-dortmund.de (Uwe Ligges)
Date: Thu Jul 31 10:25:58 2003
Subject: [Rd] wrong axis scale when plotting on a filled.contour plot
	(PR#3596)
In-Reply-To: <200307302136.h6ULanJH002406@pubhealth.ku.dk>
References: <200307302136.h6ULanJH002406@pubhealth.ku.dk>
Message-ID: <3F28D2AA.6020307@statistik.uni-dortmund.de>

gruteser@colorado.edu wrote:

> Full_Name: Marco Gruteser
> Version: 1.7.1
> OS: Win XP
> Submission from: (NULL) (129.34.20.16)
> 
> 
> Let's generate a dummy filled.contour plot
> 
> 
>>x <- 1:10
>>y <- 1:10
>>z <- array(rep(0, times=100),dim=c(10,10))
>>filled.contour(x,y,z)
> 
> 
> And try to add some points to it, e.g.
> 
> 
>>points(8,2)
>>points(6,2)
> 
> 
> The points show up misaligned with the axis 
> somewhere at 9.9,2 and 7.5,2
> 
> It appears that the "z value legend" on the right
> may have distorted the axis.
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://www.stat.math.ethz.ch/mailman/listinfo/r-devel

That's not a bug! It's documented, as well as it's solution. See 
?filled.contour, Section "Note":

"The ouput produced by filled.contour is actually a combination of two 
plots; one is the filled contour and one is the legend. Two separate 
coordinate systems are set up for these two plots, but they are only 
used internally - once the function has returned these coordinate 
systems are lost. If you want to annotate the main contour plot, for 
example to add points, you can specify graphics commands in the 
plot.axes argument. An example is given below."

Please check those examples as well.

Uwe Ligges

From ligges at statistik.uni-dortmund.de  Thu Jul 31 11:26:16 2003
From: ligges at statistik.uni-dortmund.de (ligges@statistik.uni-dortmund.de)
Date: Thu Jul 31 10:26:16 2003
Subject: [Rd] wrong axis scale when plotting on a filled.contour plot
	(PR#3599)
Message-ID: <200307310826.h6V8QGJH005081@pubhealth.ku.dk>

gruteser@colorado.edu wrote:

> Full_Name: Marco Gruteser
> Version: 1.7.1
> OS: Win XP
> Submission from: (NULL) (129.34.20.16)
> 
> 
> Let's generate a dummy filled.contour plot
> 
> 
>>x <- 1:10
>>y <- 1:10
>>z <- array(rep(0, times=100),dim=c(10,10))
>>filled.contour(x,y,z)
> 
> 
> And try to add some points to it, e.g.
> 
> 
>>points(8,2)
>>points(6,2)
> 
> 
> The points show up misaligned with the axis 
> somewhere at 9.9,2 and 7.5,2
> 
> It appears that the "z value legend" on the right
> may have distorted the axis.
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://www.stat.math.ethz.ch/mailman/listinfo/r-devel

That's not a bug! It's documented, as well as it's solution. See 
?filled.contour, Section "Note":

"The ouput produced by filled.contour is actually a combination of two 
plots; one is the filled contour and one is the legend. Two separate 
coordinate systems are set up for these two plots, but they are only 
used internally - once the function has returned these coordinate 
systems are lost. If you want to annotate the main contour plot, for 
example to add points, you can specify graphics commands in the 
plot.axes argument. An example is given below."

Please check those examples as well.

Uwe Ligges

From zg32mxr628t at 21cn.net  Thu Jul 31 17:11:50 2003
From: zg32mxr628t at 21cn.net (zg32mxr628t@21cn.net)
Date: Thu Jul 31 16:23:15 2003
Subject: [Rd] Boost your Penis Size 3 to 5 Inches  khaki (PR#3600)
Message-ID: <200307311411.h6VEBoJH008710@pubhealth.ku.dk>


--9C5A8_B0B_4_.2
Content-Type: text/html;
Content-Transfer-Encoding: quoted-printable

<HTML>
<BODY>
<div align=3D"center">
<TABLE WIDTH=3D500 BORDER=3D0 CELLPADDING=3D0 CELLSPACING=3D0>
<TR>
<TD COLSPAN=3D2>
<IMG SRC=3D"http://www.ido-want.com.br/ee/gds/a/17_01.gif"></TD>
</TR>
<TR>
<TD>
<IMG SRC=3D"http://www.ido-want.com.br/ee/gds/a/17_02.jpg"></TD>
<TD>
<IMG SRC=3D"http://www.ido-want.com.br/ee/gds/a/17_03.gif"></TD>
</TR>
<TR>
<TD>
<IMG SRC=3D"http://www.ido-want.com.br/ee/gds/a/17_04.jpg"></TD>
<TD>
<IMG SRC=3D"http://www.ido-want.com.br/ee/gds/a/17_05.gif"></TD>
</TR>
<TR>
<TD>
<a href=3D"http://www.ido-want.com.br/ee/gds/dhg/index.php?aid=3D266885"><=
IMG SRC=3D"http://www.ido-want.com.br/ee/gds/a/17_06.gif" border=3D"0"></a=
></TD>
<TD>
<a href=3D"http://www.ido-want.com.br/ee/gds/dhg/index.php?aid=3D266885"><=
IMG SRC=3D"http://www.ido-want.com.br/ee/gds/a/17_07.gif" border=3D"0"></a=
></TD>
</TR>
</TABLE><br><br><br><br><br><br>
<a href=3D"http://www.ido-want.com.br/ee/gds/dhg/o/index.php"><img src=3D"=
http://www.ido-want.com.br/ee/gds/a/o2.gif" border=3D"0"></a></div>
</BODY>
</HTML>

--9C5A8_B0B_4_.2--

From antonbookerup at mail4good.com  Thu Jul 31 16:58:53 2003
From: antonbookerup at mail4good.com (Anton Booker)
Date: Thu Jul 31 16:43:38 2003
Subject: [Rd] And Natural Manhood booster
Message-ID: <455101c3577c$4f86a69c$cecc6dfc@ahemh62>

                   As Seen On TV: CNN, ABC News And More ...

                  Doctors Create VPRX Penis Enlargement Pills

Gain Up To 3+ Full Inches In =A7{Length|Size} Increase Your Penis Width (Gi=
rth) By
  20% Stop Premature Ejaculation! Produce =A7{Stronger|Larger|Bigger}, Rock=
 Hard
   Erections 100% Safe To Take, With =A7{No|no|Abosultely No} Side Effects =
Fast
  Priority Fed-Ex Shipping WorldWide =A7{Doctor Approved And Recommended|Do=
ctor
 Recommended And Approved} =A7{No Pumps! No Surgery! No Exercises!|No Surge=
ry! No
   Exercises! No Pumps!|No Exercises! No Pumps! No Surgery!} 100% Money Back
                 Guarantee FREE Bottle Of VP-RX Worth Over $50
FREE "Male Help E-Book" Worth Over $50

<a
 http://www.herbalpillsonline.biz/cgi-bin/affiliates/click.cgi?id=3Dhpsales=
"><big><b>CLICK
HERE TO READ MORE</b></big></a>

http://www.herbalpillsonline.biz/cgi-bin/affiliates/click.cgi?id=3Dhpsales




<a href=3D"http://hpsales.globalofferz.biz/optout.html"><small><font=20
 face=3D"Helvetica, Arial, sans-serif">No Thank you, I want Out</font></sma=
ll></a>
=20
If that Link Didn't work, Please copy and Paste Link Below

http://hpsales.globalofferz.biz/optout.html=20

=20
	[[alternative HTML version deleted]]

From 238450 at excite.com  Thu Jul 31 18:26:09 2003
From: 238450 at excite.com (238450@excite.com)
Date: Thu Jul 31 17:37:35 2003
Subject: [Rd] Increase your penis by 3 inches!   238450 (PR#3601)
Message-ID: <200307311526.h6VFQ9JH009098@pubhealth.ku.dk>

<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<title>NO.1 Penis Enlargement Pill On The Market!</title>
</head>
<body text="#000000" bgcolor="#FFFFFF" link="#FF0000" vlink="#CC0000" alink="#FF0000">
<center><b><font face="Arial,Helvetica">Introducing VP-RX Pills</font></b>
<font color="ffffff" size="1">
1880325538
</font><br><br>
<b><font face="Arial,Helvetica"><font color="#000099"><font size=+1>NO.1
Penis Enlargement Pill On The Market!</font></font></font></b><font face="Arial,Helvetica"></font>
<font color="ffffff" size="1">
238450
</font><br><br>
<font face="Arial,Helvetica">* Gain 3+ Full Inches In Length</font>
<font color="ffffff" size="1">
596970415
</font>
<br><font face="Arial,Helvetica">* Expand Your Penis Up To 20 percent Thicker</font>
<font color="ffffff" size="1">
238450
</font>
<br><font face="Arial,Helvetica">* Stop Premature Ejaculation!</font>
<font color="ffffff" size="1">
1753966465
</font>
<br><font face="Arial,Helvetica">* Produce Stronger Erections</font>
<font color="ffffff" size="1">
238450
</font>
<br><font face="Arial,Helvetica">* 100 percent Safe To Take, With No Side Effects</font>
<font color="ffffff" size="1">
1619452494
</font>
<br><font face="Arial,Helvetica">* Fast Distribution Worldwide</font>
<font color="ffffff" size="1">
238450
</font>
<br><font face="Arial,Helvetica">* Sold Over 1.2 Million Bottles!</font>
<font color="ffffff" size="1">
2012123953
</font>
<br><font face="Arial,Helvetica">* No Pumps! No Surgery! No Exercises!</font><font face="Arial,Helvetica"></font>
<font color="ffffff" size="1">
238450
</font><br><br>
<b><font face="Arial,Helvetica"><font size=+2><A HREF="http://www.buyn0w.net/cgi-bin/vprx.cgi?mrbig">READ MORE HERE</A></font></font></b>
<font color="ffffff" size="1">
867511288
</font><br><br><br><br><br><br>
Attention: You can remove your e-mail from our database!
<a href="http://www.buyn0w.net/remove.html">Click here</a></center>
<font color="#FFFFFF" size="1">
         
238450
         
32E7CDCB-7808964C-73F7B46C-279B2E18-7A1E01C3
                
822015931
 
</font>
</body>
</html>

From p.b.pynsent at bham.ac.uk  Thu Jul 31 19:08:44 2003
From: p.b.pynsent at bham.ac.uk (p.b.pynsent@bham.ac.uk)
Date: Thu Jul 31 18:20:09 2003
Subject: [Rd] Mac OS 10 (not X11) failure to rotate symbols (PR#3602)
Message-ID: <200307311608.h6VG8iJH009294@pubhealth.ku.dk>


In the following code the arrow symbols do not rotate with the text on 
the Mac OS window,  however the do rotate on X11 port on Mac OS.
(R version 1.71)
x <- c(0,10.)
y <- c(0,10.)
offset <- 3
centre <- 5
plot(x,y, xlim=range(x), ylim=range(y),type="n", xlab="",ylab="", 
main="",xaxt="n",yaxt="n")
for (i in (seq(0, 340, by=45))	)
	{
	px <- centre + cos((i*pi)/180) * offset
	py <- centre + sin((i*pi)/180) * offset
	text(px, py,
	labels=substitute(that%->%phantom(1),list(that=i)), pos=1, col="blue", 
cex=0.7, srt=i)
	text(px, py,
	labels=substitute(that%<-%phantom(1),list(that=i)), pos=3, 
col="blue",cex=0.7,srt=i)
	lines(px, py, type="p", col="black") #just for reference
	}

Many thanks.
Paul


Dr. P. B. Pynsent,
Research and Teaching Centre,
Royal Orthopaedic Hospital,
Birmingham, B31 2AP, U.K.

From kccv2u8u2 at elong.com  Thu Jul 31 19:16:31 2003
From: kccv2u8u2 at elong.com (kccv2u8u2@elong.com)
Date: Thu Jul 31 18:27:55 2003
Subject: [Rd] Increase your penis by 2 to 5 inches in Weeks mosquito
	(PR#3603)
Message-ID: <200307311616.h6VGGVJH009334@pubhealth.ku.dk>


--3DF_5_91_797F2D
Content-Type: text/html;
Content-Transfer-Encoding: quoted-printable

<HTML>
<body>
<p align=3D"center">
<a href=3D"http://www.hop-ing.biz/berlioz/dhg/index.php?aid=3D266885">
<img border=3D"0" src=3D"http://www.hop-ing.biz/berlioz/a/1.gif"></a></p>
<p align=3D"center">
<a href=3D"http://www.hop-ing.biz/berlioz/dhg/o/index.php">
<img border=3D"0" src=3D"http://www.hop-ing.biz/berlioz/a/o2.gif"></a></p>=

</BODY>
</HTML>

--3DF_5_91_797F2D--

From roger at ysidro.econ.uiuc.edu  Thu Jul 31 12:39:24 2003
From: roger at ysidro.econ.uiuc.edu (Roger Koenker)
Date: Thu Jul 31 18:44:36 2003
Subject: [Rd] namespace magic
Message-ID: <Pine.SOL.4.30.0307311113170.9985-100000@ysidro.econ.uiuc.edu>

I'm confused about name spaces.  This morning I installed the
boot package because I wanted to look at bca.ci.  So I did
library(boot), but then I had,

> bca.ci
Error: Object "bca.ci" not found

I had a look in the boot R directory and bca.ci was there as expected.
So then I took a look at the NAMESPACE file for the boot package and saw
that bca.ci wasn't exported.  I tried

example(boot.ci)

and this worked fine including computing the bca.ci version of some
intervals.  Finally, I read the section on name spaces in Writing R
extensions, which was very helpful but still didn't answer my basic
question:  how is it that bca.ci is not loaded and still available
to do the example?  And why not export bca.ci and friends?

platform sparc-sun-solaris2.8
arch     sparc
os       solaris2.8
system   sparc, solaris2.8
status   Under development (unstable)
major    1
minor    8.0
year     2003
month    07
day      26
language R

url:	www.econ.uiuc.edu/~roger/my.html	Roger Koenker
email	rkoenker@uiuc.edu			Department of Economics
vox: 	217-333-4558				University of Illinois
fax:   	217-244-6678				Champaign, IL 61820

From kbroman at jhsph.edu  Thu Jul 31 20:53:51 2003
From: kbroman at jhsph.edu (kbroman@jhsph.edu)
Date: Thu Jul 31 20:05:17 2003
Subject: [Rd] round to even digit (PR#3604)
Message-ID: <200307311753.h6VHrpJH009691@pubhealth.ku.dk>

Full_Name: Karl W Broman
Version: 1.7.1
OS: Linux
Submission from: (NULL) (162.129.44.18)


There appears to be a slight problem with round(); for rounding off a 5, 
it should go to the even digit, but there appear to be some cases where
it goes to an odd digit; see below.

Thanks! karl

~[1007]$ R --vanilla

R : Copyright 2003, The R Development Core Team
Version 1.7.1  (2003-06-16)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type `license()' or `licence()' for distribution details.

R is a collaborative project with many contributors.
Type `contributors()' for more information.

Type `demo()' for some demos, `help()' for on-line help, or
`help.start()' for a HTML browser interface to help.
Type `q()' to quit R.

> round(c(0.175, 1.175, 2.175, 3.175, 4.175, 5.175, 6.175, 7.175, 8.175, 9.175),
2)
 [1] 0.18 1.18 2.17 3.17 4.17 5.17 6.17 7.17 8.18 9.18
> round(c(1.75, 11.75, 21.75, 31.75, 41.75, 51.75, 61.75, 71.75, 81.75, 91.75),
1)
 [1]  1.8 11.8 21.8 31.8 41.8 51.8 61.8 71.8 81.8 91.8
> 
> version
         _                
platform i686-pc-linux-gnu
arch     i686             
os       linux-gnu        
system   i686, linux-gnu  
status                    
major    1                
minor    7.1              
year     2003             
month    06               
day      16               
language R                
>

From softface456 at netian.com  Thu Jul 31 21:55:40 2003
From: softface456 at netian.com (softface456@netian.com)
Date: Thu Jul 31 21:07:06 2003
Subject: [Rd] =?euc-kr?b?KLGksO0pIMG+t67BpiC6wMX1IMD9vuDH/CC+0MPgvrK3ubHi?=
	=?euc-kr?b?xesgvNKws0Ag?= (PR#3605)
Message-ID: <200307311855.h6VIteJH009885@pubhealth.ku.dk>

<html><body bgcolor=white><p align=center><a href="http://www.softface.co.kr/magichome.asp?flag=all" target="_blank" onmouseover="window.status='¸ÅÁ÷ÆÄ¿ö';return true" ><img src="http://www.nurieshop.com/images2/magicpower.gif" width="675" height="1023" border=0></a></p><table border="0" align="center"><tr><td><p style="LINE-HEIGHT: 120%"><span style="FONT-SIZE: 9pt">¢¹&nbsp;¿øÄ¡¾ÊÀº Á¤º¸¿´´Ù¸é Á¤ÁßÈ÷ »ç°ú µå¸®¸ç, ¼ö½Å °ÅºÎ¸¦ ÇØÁÖ½Ã¸é ´ÙÀ½ºÎÅÍ´Â ¸ÞÀÏÀÌ ¹ß¼ÛµÇÁö ¾ÊÀ» °ÍÀÔ´Ï´Ù.<br>¢¹&nbsp;If you do not wish to receive this email click "Unsubscribe" button.</span></p></td></tr><tr>
<td align="middle"><FORM action=http://www.softface.co.kr/unsubpre.asp method=post><input type=hidden name=flag value=magicall><INPUT type=submit value="¼ö½Å°ÅºÎ(Unsubscribe)"></FORM></td></tr></table></body></html>

From softface456 at netian.com  Thu Jul 31 22:07:31 2003
From: softface456 at netian.com (softface456@netian.com)
Date: Thu Jul 31 21:18:56 2003
Subject: [Rd] =?euc-kr?b?KLGksO0pIMG+t67BpiC6wMX1IMD9vuDH/CC+0MPgvrK3ubHi?=
	=?euc-kr?b?xesgvNKws0Ag?= (PR#3606)
Message-ID: <200307311907.h6VJ7VJH009923@pubhealth.ku.dk>

<html><body bgcolor=white><p align=center><a href="http://www.softface.co.kr/magichome.asp?flag=all" target="_blank" onmouseover="window.status='¸ÅÁ÷ÆÄ¿ö';return true" ><img src="http://www.nurieshop.com/images2/magicpower.gif" width="675" height="1023" border=0></a></p><table border="0" align="center"><tr><td><p style="LINE-HEIGHT: 120%"><span style="FONT-SIZE: 9pt">¢¹&nbsp;¿øÄ¡¾ÊÀº Á¤º¸¿´´Ù¸é Á¤ÁßÈ÷ »ç°ú µå¸®¸ç, ¼ö½Å °ÅºÎ¸¦ ÇØÁÖ½Ã¸é ´ÙÀ½ºÎÅÍ´Â ¸ÞÀÏÀÌ ¹ß¼ÛµÇÁö ¾ÊÀ» °ÍÀÔ´Ï´Ù.<br>¢¹&nbsp;If you do not wish to receive this email click "Unsubscribe" button.</span></p></td></tr><tr>
<td align="middle"><FORM action=http://www.softface.co.kr/unsubpre.asp method=post><input type=hidden name=flag value=magicall><INPUT type=submit value="¼ö½Å°ÅºÎ(Unsubscribe)"></FORM></td></tr></table></body></html>

From 238454 at hotmail.com  Thu Jul 31 22:59:03 2003
From: 238454 at hotmail.com (238454@hotmail.com)
Date: Thu Jul 31 22:10:29 2003
Subject: [Rd] Copy VHS tapes to CD too! 238454 (PR#3607)
Message-ID: <200307311959.h6VJx3JH010095@pubhealth.ku.dk>

<html>
<head>
<title>DVD Magic Pro</title>
</head>
<font color="#FFFFFF" size="2">
*****
1D8251CF-4E338F04-352A04A3-45565C72-3C70A84D
*********
        
</font><body><table border="4" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#00009D" width="460" bgcolor="#000080" bordercolorlight="#3366CC" bordercolordark="#000080" height="44">
  <tr>
    <td width="163" height="44" bgcolor="#FFFFFF" bordercolor="#000000" style="border: 1px solid #000000">
    <p align="center"><i><b><font size="4" color="#000080" face="Tahoma">DVD 
    Magick Pro</font></b></i></td>
    <td width="294" height="44" style="border: 2px solid #3366CC">
    <p align="center"><b><font face="Tahoma" color="#FFFFFF">A Revolutionary Way 
    to Create DVDs in Your Own Home!</font></b></td>
  </tr>
</table>
<table border="3" cellpadding="5" cellspacing="5" style="border-collapse: collapse" bordercolor="#3366CC" width="460" bgcolor="#3366CC" bordercolorlight="#0066CC" bordercolordark="#0066CC">
  <tr>
    <td>
    <p align="center"><font face="Arial" color="#FFFFFF">
    <marquee behavior="slide" scrollamount="25" scrolldelay="40" style="color: #FFFFFF; font-family: Arial; font-size: 14pt" width="320">Want to Create your own DVD library?</marquee><br> 
    Worried about scratching your favorite movie?<br>We have THE solution for you!<br>
    <marquee behavior="slide" scrollamount="5" scrolldelay="50" width="316" style="color: #FFFFFF; font-family: Arial; font-size: 12pt; font-weight: bold">Now you can Make DVD's using your PC!</marquee><br> 
    It's easy to use, and For a limited time it is <b><u>Only $39.99!</u></b></font></td>
  </tr>
</table>

<table border="4" cellpadding="5" cellspacing="5" style="border-collapse: collapse" bordercolor="#3366CC" width="460" bgcolor="#000080" bordercolorlight="#0066CC" bordercolordark="#0066CC">
  <tr>
    <td align="left">
    <p><b><font color="#FFFFFF" size="2" face="Tahoma">- Instant Download!<br>- No 
    DVD Burner Required<br>
    - Simple &amp; Easy-to-Use<br>- Win 95/98/2k/XP Compatible</font></b></td>
    <td bgcolor="#FFFFFF" style="text-decoration: blink; color: #000080; font-family: Tahoma; font-size: 12pt; font-weight: bold; border-style: solid; border-width: 3">
    <p align="center"><span style="font-weight: 400"><i><strong><blink>
    <a style="color: #000080; font-family: Tahoma; font-size: 12pt; text-decoration: blink; font-style: oblique; font-weight: bold" href="http://www.blitzware.biz/dvd/adv166/">
    <font face="Tahoma" color="#000080" size="4">Click Here for More Info or <br>Order Online Now!</font></a></blink></strong></i></span></td>
  </tr>
</table>
<font color="#FFFFFF" size="1">
238454
              
678D60DA-4A4BB24B-2354118E-7B87C4A1-8DE08A4
        
630181489
</font>
</body>
</html>

