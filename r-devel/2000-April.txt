From mlapsley@ndirect.co.uk  Sat Apr  1 19:18:09 2000
From: mlapsley@ndirect.co.uk (Michael Lapsley)
Date: Sat, 1 Apr 2000 19:18:09 +0100
Subject: [Rd] Bug ? mine or ? in R core
Message-ID: <20000401191809.A16446@athome.lapsley>

Dear R Gurus,

I would very much appreciate some help with this code snippit
from my RODBC package.

R crashes or exhibits bizarre behaviour when repeatedly fetching
large numbers of rows.

Examples:

> odbcFetchRows(0,max=50000)->xx
> odbcFetchRows(0,max=50000)->xx
> odbcFetchRows(0,max=50000)->xx
> odbcFetchRows(0,max=50000)->xx
> odbcFetchRows(0,max=50000)->xx
3rd arg (table) not of type VECSXP, from R_HashGet
Segmentation fault (core dumped)


> odbcFetchRows(0,max=100000)->xx
> odbcFetchRows(0,max=100000)->xx
Segmentation fault (core dumped)

> odbcFetchRows(0,max=50000)
...
...[49996,] "Some dummy data"
[49997,] "Some dummy data"
[49998,] "Some dummy data"
[49999,] "Some dummy data"
[50000,] "Some dummy data"

$stat
[1] 1

> odbcFetchRows(0,max=50000)
Error in odbcFetchRows(0, max = 50000) : can not set length of non-vector
> odbcFetchRows(0,max=50000)

[49998,] "Some dummy data"
[49999,] "Some dummy data"
[50000,] "Some dummy data"

$stat
[1] 1

> odbcFetchRows(0,max=50000)
Segmentation fault (core dumped)

(This is using a hacked version that does not actually fetch rows
from the database to save time).

Using the C that I distilled out (see below) to remove all
dependencies on sql/odbc I get something even more bizarre:

> odbcFetchRows(0,max=50000)->xx
> odbcFetchRows(0,max=50000)->xx
> odbcFetchRows(0,max=50000)->xx
Segmentation fault (core dumped)

but

> odbcFetchRows(0,max=25000)->xx
> odbcFetchRows(0,max=25000)->xx
> odbcFetchRows(0,max=25000)->xx
> odbcFetchRows(0,max=25000)->xx
Error: corrupted options list
Error: corrupted options list
Error: corrupted options list
Error: corrupted options list
Error: corrupted options list
Error: corrupted options list
Error: corrupted options list
Error: corrupted options list
.....
(endless loop needing killing)

I have stared at this for ages and cannot see the bug?  Is it me
or is there a problem in garbage collection or elsewhere?

Thanks in advance for any enlightenment.


Michael

-----------------------------------------------------------------

/* RODBC low level interface : crash function
 *
 * crash.c
 *
 */
#include <stdio.h>
#include <sys/types.h>
#include <fcntl.h>
#include <stdlib.h>


#include <Rinternals.h>
#include <Rdefines.h>


#define DBG(x,y) if(debug >= x) printf("%s\n",y)

/*******************************************************************************/
/* Replacement callee for odbcFetchRows to demonstate bug.                     */
/* Independant of sql/odbc                                                     */
/* Compile with                                                                */
/* cc -g  -Wall -I/usr/local/src/R-1.0.0/include/  -o crash.o -c crash.c       */
/* gcc -shared -g -Wall      -o crash.so  crash.o                              */
/* mv crash.so /usr/local/src/R-1.0.0/library/RODBC/libs/RODBC.so              */
/* then                                                                        */
/* $R -q                                                                       */
/* >library(RODBC)                                                             */
/* >odbcFetchRows(0,max=50000)                                                 */
/* and repeat till crashes.                                                    */
/*                                                                             */
/* Note that the loop will never exit unless max is specified.                 */
/*                                                                             */
/* Designed to work with RODBC-0.6.1a                                          */
/* Caller looks like:                                                          */
/*                                                                             */
/* "odbcFetchRows"<-                                                           */
/* function(channel,max=0,transposing=F,buffsize=1000,debug=0)                 */
/* {                                                                           */
/*         erg<-.Call("RODBCFetchRows",as.integer(channel),max=as.real(max),   */
/*                         transposing=as.logical(transposing),                */
/*                         buffsize=as.real(buffsize),debug=as.integer(debug)) */
/*         return(erg)                                                         */
/*         }                                                                   */
/*                                                                             */
/*                                                                             */
/*******************************************************************************/
SEXP RODBCFetchRows(SEXP sock,SEXP max,SEXP tx,SEXP bs,SEXP dbg)
{
SEXP data,t_data,names,ans,stat,dim;
int 	status=1,
	i,				/* col counter */
	NCOLS,
	channel=INTEGER(sock)[0],	/* not used here */
	debug=INTEGER(dbg)[0],
	transposing=(int)LOGICAL(tx)[0];	/*true if transposing, not used here*/

long maximum=(long)REAL(max)[0];

long 	j=1,k=1,			/* row counters*/
	buffsize=(long)REAL(bs)[0],	/* prealloc if row count NA*/
	length,offset,t_offset;		/* counts into output buf*/


NCOLS=1;
PROTECT(ans=NEW_LIST(2)); /*create answer [0] = data, [1]=stat */
PROTECT(stat=NEW_INTEGER(1)); /* numeric status vector */
PROTECT(data=NEW_CHARACTER(buffsize));
while(1){
	for (i=1; i<= NCOLS; i++){
			offset=((i-1)*maximum)+(j-1);
		}
	  DBG(2,"writing to data");
	  STRING(data)[offset]=COPY_TO_USER_STRING("Some dummy data");
		if(offset +NCOLS >= buffsize){
			DBG(1,"reallocating space");
			length=length(data);
			buffsize=length+buffsize;
			SET_LENGTH(data,buffsize);
		}
	j++;
	if(maximum && j>maximum)
		break;
}	

/* transpose it */
DBG(1,"trimming");
SET_LENGTH(data,j*NCOLS); /* trim down buffer*/

INTEGER(stat)[0]=status;
PROTECT(dim=NEW_INTEGER(2));


INTEGER(dim)[1]=NCOLS;
INTEGER(dim)[0]=length(data)/NCOLS;


DBG(2,"writing dim to data");
SET_DIM(data,dim);
DBG(2,"writing to ans 0");
VECTOR(ans)[0]=data;
DBG(2,"writing to ans 1");
VECTOR(ans)[1]=stat;
DBG(3,"protecting names");
PROTECT(names=NEW_CHARACTER(2));                                  
DBG(2,"writing to names 0");
STRING(names)[0]=COPY_TO_USER_STRING("data");                    
DBG(2,"writing to names 1");
STRING(names)[1]=COPY_TO_USER_STRING("stat");                   
DBG(2,"writing to ans");
SET_NAMES(ans,names);                                          
UNPROTECT(5);
return ans;
}

/****************************************/
/* Just a dummy to allow library(RODBC) */
/****************************************/
void RODBCInit()
{
}
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Sat Apr  1 19:31:42 2000
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 01 Apr 2000 20:31:42 +0200
Subject: [Rd] Bug ? mine or ? in R core
In-Reply-To: Michael Lapsley's message of "Sat, 1 Apr 2000 19:18:09 +0100"
References: <20000401191809.A16446@athome.lapsley>
Message-ID: <x2bt3tsmep.fsf@blueberry.kubism.ku.dk>

Michael Lapsley <mlapsley@ndirect.co.uk> writes:

[Crashes with the following code]

> PROTECT(ans=NEW_LIST(2)); /*create answer [0] = data, [1]=stat */
> PROTECT(stat=NEW_INTEGER(1)); /* numeric status vector */
> PROTECT(data=NEW_CHARACTER(buffsize));
> while(1){
> 	for (i=1; i<= NCOLS; i++){
> 			offset=((i-1)*maximum)+(j-1);
> 		}
> 	  DBG(2,"writing to data");
> 	  STRING(data)[offset]=COPY_TO_USER_STRING("Some dummy data");
> 		if(offset +NCOLS >= buffsize){
> 			DBG(1,"reallocating space");
> 			length=length(data);
> 			buffsize=length+buffsize;
> 			SET_LENGTH(data,buffsize);
                        ^^^^^^^^^^^^^^^^^^^^^^^^^
> 		}
> 	j++;
> 	if(maximum && j>maximum)
> 		break;
> }	
> 
> /* transpose it */
> DBG(1,"trimming");
> SET_LENGTH(data,j*NCOLS); /* trim down buffer*/
  ^^^^^^^^^^^^^^^^^^^^^^^^

I'm not too well accustomed to these macros (they aren't used in the R
internals), but in Rdefines.h we have

#define SET_LENGTH(x, n)       (x = lengthgets(x, n))

so I wouldn't count on "data" being the same after those operations,
and in particular not expect it to be protected anymore. You probably
need to stick in "UNPROTECT(1); PROTECT(data);" after the SET_LENGTH
operations.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From mlapsley@ndirect.co.uk  Sun Apr  2 00:28:21 2000
From: mlapsley@ndirect.co.uk (Michael Lapsley)
Date: Sun, 2 Apr 2000 00:28:21 +0100
Subject: [Rd] Bug ? mine or ? in R core
In-Reply-To: <x2bt3tsmep.fsf@blueberry.kubism.ku.dk>
References: <20000401191809.A16446@athome.lapsley> <x2bt3tsmep.fsf@blueberry.kubism.ku.dk>
Message-ID: <20000402002821.A16858@athome.lapsley>


Thanks, Peter, it seems to do the trick.  I spent a lot of
time trying first to reproduce then identify this one!

What is the 'approved' method of resizing a vector?
Is SET_LENGTH deprecated, or does it just happen that there is
no need for it in tht R internals?


Michael

On Sat, Apr 01, 2000 at 08:31:42PM +0200, Peter Dalgaard BSA wrote:
> > /* transpose it */
> > DBG(1,"trimming");
> > SET_LENGTH(data,j*NCOLS); /* trim down buffer*/
>   ^^^^^^^^^^^^^^^^^^^^^^^^
> 
> I'm not too well accustomed to these macros (they aren't used in the R
> internals), but in Rdefines.h we have
> 
> #define SET_LENGTH(x, n)       (x = lengthgets(x, n))
> 
> so I wouldn't count on "data" being the same after those operations,
> and in particular not expect it to be protected anymore. You probably
> need to stick in "UNPROTECT(1); PROTECT(data);" after the SET_LENGTH
> operations.
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Sun Apr  2 00:36:20 2000
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 02 Apr 2000 01:36:20 +0200
Subject: [Rd] Bug ? mine or ? in R core
In-Reply-To: Michael Lapsley's message of "Sun, 2 Apr 2000 00:28:21 +0100"
References: <20000401191809.A16446@athome.lapsley> <x2bt3tsmep.fsf@blueberry.kubism.ku.dk> <20000402002821.A16858@athome.lapsley>
Message-ID: <x2k8ih5r7v.fsf@blueberry.kubism.ku.dk>

Michael Lapsley <mlapsley@ndirect.co.uk> writes:

> Thanks, Peter, it seems to do the trick.  I spent a lot of
> time trying first to reproduce then identify this one!

Been there...

> What is the 'approved' method of resizing a vector?
> Is SET_LENGTH deprecated, or does it just happen that there is
> no need for it in tht R internals?

On the contrary! It's the official way. We just don't use it
internally (in the few places where it might be used, we're using
direct calls to realloc()).

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Sun Apr  2 15:31:54 2000
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Sun, 2 Apr 2000 16:31:54 +0200
Subject: [Rd] C++ support
Message-ID: <200004021431.QAA14557@aragorn.ci.tuwien.ac.at>

I will shortly commit a first shot a C++ support for add-on packages (to
r-devel, of course).

For me, installation of a trivial test package (basically consisting of
the example in R-exts) works without problems.  I'll put the package
into CRAN's src/contrib/Devel for some time.

If anyone knows about platform/compiler specific settings CXXPICFLAGS
settings that configure needs to be taught, pls let me know.

Building shared libs would be based on the following idea: if C++ code
was found, then try using CXX as SHLIBLD (i.e. the C++ compiler for
building the shared library).  Alternatively, one would need to find out
what C++ is linked against, which may be a pain.  Anyway, I thought I'd
collect some feedback and then maybe come up with something refined.

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From maechler@stat.math.ethz.ch  Mon Apr  3 13:37:43 2000
From: maechler@stat.math.ethz.ch (maechler@stat.math.ethz.ch)
Date: Mon, 3 Apr 2000 14:37:43 +0200 (MET DST)
Subject: [Rd] another save/load problem, only(?) affecting ascii = TRUE (PR#507)
Message-ID: <200004031237.OAA25910@pubhealth.ku.dk>

On all current R versions, afaik:

When using  save(....., ascii = TRUE),
the resulting file is not always readable by load(.).

The following is executable R code
exhibiting two (slightly different) examples
of which I have seen even more [~/R/MISC/saveload-bug.R]:

### BUG :  save(..., ascii = TRUE)  produces load() -  unreadable files :

tstf1 <- function(n = 500)
{
    ## Purpose:
    ## -----------------------------------------------------------------------
    ## Author: Martin Maechler, Date: 29 Mar 2000, 15:40
    ## -----------------------------------------------------------------------
    n2 <- n %/% 2
    nk <- n2 * 4
    CPU <- numeric(n)
    ## -----------------------------------------------------------------------
    for(i in 1:n) { ## just a simple pseudo loop
        n <- n*nk
        CPU[i] <- i^n
    }
    CPU
}

tstf2 <- function(n = 500)
{
    ## Author: Martin Maechler, Date: 1 Apr 2000, 15:40
    n %/% 2
}

save(tstf1, file="foo1",ascii=TRUE); load(file="foo1")
## Error in load(file = "foo1") : NewReadItem: unknown type -1073749696
save(tstf2, file="foo2",ascii=TRUE); load(file="foo2")
## Error in load(file = "foo2") : NewReadItem: unknown type 92

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Mon Apr  3 16:09:35 2000
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 03 Apr 2000 17:09:35 +0200
Subject: [Rd] another save/load problem, only(?) affecting ascii = TRUE (PR#507)
In-Reply-To: maechler@stat.math.ethz.ch's message of "Mon, 3 Apr 2000 14:37:43 +0200 (MET DST)"
References: <200004031237.OAA25910@pubhealth.ku.dk>
Message-ID: <x2ya6vte4w.fsf@blueberry.kubism.ku.dk>

maechler@stat.math.ethz.ch writes:

> tstf2 <- function(n = 500)
> {
>     ## Author: Martin Maechler, Date: 1 Apr 2000, 15:40
>     n %/% 2
> }
> 
> save(tstf1, file="foo1",ascii=TRUE); load(file="foo1")
> ## Error in load(file = "foo1") : NewReadItem: unknown type -1073749696
> save(tstf2, file="foo2",ascii=TRUE); load(file="foo2")
> ## Error in load(file = "foo2") : NewReadItem: unknown type 92

Squished (I think). Problem was that nonprinting characters (incl. the
Space character) were printed in octal using %o format in
OutStringAscii. That should be %.3o to ensure that exactly three octal
digits get printed. Otherwise we're in trouble every time a digit
follows a space. 

I kind of suspect that there's really no reason to escape spaces like
that, but we'd have the same problem with other unprintables.

The $ffff question is whether %.3o is guaranteed to work on all
platforms.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From koller2@fgr.wu-wien.ac.at  Mon Apr  3 17:21:13 2000
From: koller2@fgr.wu-wien.ac.at (Wolfgang Koller)
Date: Mon, 03 Apr 2000 18:21:13 +0200
Subject: [Rd] window(): feature request
Message-ID: <3.0.6.32.20000403182113.008f1bf0@fgr.wu-wien.ac.at>

Dear R-developpers,

currently the function window shows the following behaviour, if start or
end is out of range:

> x <- ts(1:14,start=c(1950,2),frequency=4)
> y <- window(x,start=c(1950,1),end=c(1953,4))
Warning messages: 
1: start value not changed in: window.default(x, ...) 
2: end value not changed in: window.default(x, ...) 

Instead of this I would like it to fill with NAs the values before start(x)
and after end(x). Could this be done by introducing an additional option in
window()? Could you please consider this in future releases? Or is there a
better way to do this using existing functions?
 
Thanks very much! 

Wolfgang Koller

P.S.: Below I have added some code that accomplishes this aim in a separate
function (which is probably an example of akward programming...).

sloppywindow <- function(x,start,end) {
  if (!is.ts(x) || (NCOL(x) > 1)) 
     stop("x is not a univariate time series") # does not work for frames
  xfrequ <- frequency(x)
  n <- length(x)

  time.start <- if (length(start) > 1) {
     if(start[2] > xfrequ) stop("invalid start")
     start[1] + (start[2] - 1)/xfrequ
  } else start

  time.end <- if (length(end) > 1) {
     if(end[2] > xfrequ) stop("invalid end")
     end[1] + (end[2] - 1)/xfrequ
  } else end

  if(time.start > time.end)
        stop("start cannot be after end")
  
  before <- round( (time(x)[1] - time.start) * xfrequ)
  before.NAs <- if (before > 0) rep(NA,before) else NULL
  after <- round( (time.end - time(x)[n] ) * xfrequ)
  after.NAs <- if (after > 0) rep(NA,after) else NULL
   
  first.start <- if (before > 0) start else start(x)
  x <- ts(c(before.NAs,x,after.NAs),start=first.start,frequency=xfrequ)  
  return(window(x,start,end))
}


-------------------------------------------------
Wolfgang Koller,  koller2@fgr.wu-wien.ac.at
Forschungsinstitut für Europafragen
Wirtschaftsuniversitaet Wien
Althanstrasse 39-45, 1090 Vienna, Austria
http://fgr.wu-wien.ac.at/institut/ef/ief-home.htm
-------------------------------------------------
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From koller2@fgr.wu-wien.ac.at  Mon Apr  3 19:08:12 2000
From: koller2@fgr.wu-wien.ac.at (koller2@fgr.wu-wien.ac.at)
Date: Mon, 3 Apr 2000 20:08:12 +0200 (MET DST)
Subject: [Rd] cbind.ts(),ts.union() (PR#508)
Message-ID: <200004031808.UAA29180@pubhealth.ku.dk>

Full_Name: Wolfgang Koller
Version: 1.0.0
OS: linux 
Submission from: (NULL) (137.208.7.48)


> data(UKLungDeaths)
> ts.union(mdeaths, fdeaths,dframe=TRUE)
Error in names<-.default(*tmp*, value = nmsers) : 
        names attribute must be the same length as the vector
> cbind(mdeaths, fdeaths,dframe=TRUE)
Error in names<-.default(*tmp*, value = nmsers) : 
        names attribute must be the same length as the vector

should not give an error

BR#239--241

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Mon Apr  3 20:56:21 2000
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Mon, 3 Apr 2000 20:56:21 +0100 (BST)
Subject: [Rd] cbind.ts(),ts.union() (PR#508)
In-Reply-To: <200004031808.UAA29180@pubhealth.ku.dk>
Message-ID: <Pine.GSO.4.05.10004032053370.14448-100000@auk.stats>

On Mon, 3 Apr 2000 koller2@fgr.wu-wien.ac.at wrote:

> Full_Name: Wolfgang Koller
> Version: 1.0.0
> OS: linux 
> Submission from: (NULL) (137.208.7.48)
> 
> 
> > data(UKLungDeaths)
> > ts.union(mdeaths, fdeaths,dframe=TRUE)
> Error in names<-.default(*tmp*, value = nmsers) : 
>         names attribute must be the same length as the vector
> > cbind(mdeaths, fdeaths,dframe=TRUE)
> Error in names<-.default(*tmp*, value = nmsers) : 
>         names attribute must be the same length as the vector
> 
> should not give an error

Those are the same thing.  Replace

       x <- vector("list", n)
by

       x <- vector("list", nser)

which was not too hard to debug, surely?

> BR#239--241

Eh?  That's beyond me!

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Thomas Vogels <tov@ece.cmu.edu>  Mon Apr  3 21:42:12 2000
From: Thomas Vogels <tov@ece.cmu.edu> (Thomas J Vogels)
Date: 03 Apr 2000 16:42:12 -0400
Subject: [Rd] AIX fails on startup with R-1.0.0
In-Reply-To: Kurt Hornik's message of "Fri, 31 Mar 2000 19:21:21 +0200 (CEST)"
References: <Pine.GSO.4.21.0003181111590.11158-100000@mail.biostat.washington.edu> <871z561pcm.fsf@bavaria.ece.cmu.edu> <14552.57463.552150.382635@aragorn.ci.tuwien.ac.at> <8766uens46.fsf@bavaria.ece.cmu.edu> <14554.25111.847983.270127@aragorn.ci.tuwien.a
Message-ID: <87bt3qj4rf.fsf@bavaria.ece.cmu.edu>


Kurt,

  the saga continues...

> Users of current r-devel snapshots on AIX, can you confirm that
> 
> 	MAINLD=cc SHLIBLD=cc /path/to/configure
> 	make

yes, this compiles cleanly, make check runs without a hiccup.  But
then problems start:

(old) make install fails.  I compile in a build directory to make it
    easier to nuke the compilation tree.  Installation from there fails as
    it can't find $(INSTALL_DATA).
/bin/sh: ../tools/install-sh:  not found.  [repeats six times]

    Here is the excerpt from the Makefile:
        @(cd $(srcdir); \
          for f in $(INSTFILES); do \
-           $(INSTALL_DATA) $${f} $(rhome); \
+           pwd; tools/$(INSTALL_DATA) $${f} $(rhome); \
          done)
    The line with a '-' is the original line.  This will fail because
    of the cd to srcdir.  The line prefixed by '+' works but is a bad
    patch. Since INSTALL_DATA is ../tools/install-sh (forced to be on
    AIX!), would the following work?
        @(for f in $(INSTFILES); do \
            $(INSTALL_DATA) $(srcdir)/$${f} $(rhome); \
          done)

   Somehow, the path to install-sh is not made absolute, as Kurt
   expected.  AIX is/should be one of the platforms where the use of
   the install-sh that comes with R is forced.  But the path to it is
   relative (not absolute) in Makeconf:

$ grep install-sh Makeconf /dev/null
Makeconf:INSTALL = $(top_srcdir)/tools/install-sh -c
$ grep top_srcdir Makefile /dev/null
Makefile:top_srcdir = ..

(old) the file R.exp doesn't get copied into rhome/etc/.  Installation of
   packages with source code may/will fail (AIX specific).  I don't
   know at which step this file should get copied so I can't trace the
   Makefiles to see why it doesn't.

(new) Actually, compilation fails for a different reason.  E.g. for
   date (smallest contrib package I saw): 

Installing package `date' ...
 libs
gcc -I/afs/ece/usr/tov/opt/arch/lib/R/include  -I/usr/local/include -I/afs/ece/usr/tov/opt/share/include -mno-fp-in-toc  -fPIC -g -O2 -c char_date.c -o char_date.o
make: *** No rule to make target `*.o', needed by `/afs/ece/usr/tov/opt/arch/lib/R/library/date/libs/date.so'.  Stop.

    R INSTALL nevertheless proceeds happily with the installation and
    reports DONE.

(old) demo(dyn.load) in an R session will fail as R can't find
   demo.so.  This file doesn't get installed, nor are there
   instructions in the README in demos/dynload on how to compile it.
   (The hint to run "R SHLIB zero.c" would be nice to have in the
   demos/dynload/README.) 
   The install target in demos/dynload/Makefile will not copy
   demo.so.  It only copies README, zero.R and zero.c.  

[snip]
> > -- ld/cc doesn't automatically include /usr/local/lib while gcc does.
> > This comes from the sytem installation here and has nothing to do with
> > R.  But having to add LIBS=-L/usr/local/lib may come as a surprise to
> > people who don't do this regularly.
> 
> > Does configure check for the existence of e.g. libz.a with cc or gcc?
> It uses the C compiler specified.
> 
> Well, LIBS is needed when you have things in `non-standard' locations.
> Of course your mileage may vary on the definition of non-standard :-)

> Is there anything I/configure could do about this?  (Note that I don't
> think that unconditionally adding /usr/local/lib to LIBS is a good
> idea.) 

Dunno.  As Brian pointed out in his reply, he has to add
/usr/local/lib also on a Solaris machine.  At the moment, my humble
suggestion would be to add this in the installation instructions.

At the moment, I'm worried about the missing rule for *.o files.  Does
this happen only for me?

Thanks,
  -tom


BTW, this happens with code from this morning:
         _                           
platform powerpc-ibm-aix4.3.2.0      
arch     powerpc                     
os       aix4.3.2.0                  
system   powerpc, aix4.3.2.0         
status   Under development (unstable)
major    1                           
minor    1.0                         
year     2000                        
month    April                       
day      3                           
language R               

-- 
mailto:tov@ece.cmu.edu (Tom Vogels)   Tel: (412) 268-6638   FAX: -3204
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From edd@debian.org  Tue Apr  4 00:23:34 2000
From: edd@debian.org (edd@debian.org)
Date: Tue, 4 Apr 2000 01:23:34 +0200 (MET DST)
Subject: [Rd] write.table with rows and cols (PR#509)
Message-ID: <200004032323.BAA00377@pubhealth.ku.dk>

Full_Name: Dirk Eddelbuettel
Version: 1.0.0 (patched)
OS: Linux
Submission from: (NULL) (192.139.71.69)


A frame with rownames and colnames got properly written, but the colnames
started 
without an offset -- but if the .csv file is read back in, the rownames column
now 
has the header of the first column.  

"Graphically", suppose a frame with two rows 1999 and 2000, and two columns foo
and 
bar, with content equal to the row/col index.

This should be written as

  ,foo,bar
  1999,11,12
  2000,21,22

but was written without the initial ","  (I used "," as the sep).

Am I making sense? 

Anyway, big thanks for R!

Dirk


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Tue Apr  4 07:25:01 2000
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Tue, 4 Apr 2000 07:25:01 +0100 (BST)
Subject: [Rd] write.table with rows and cols (PR#509)
In-Reply-To: <200004032323.BAA00377@pubhealth.ku.dk>
Message-ID: <Pine.GSO.4.05.10004040710030.15113-100000@auk.stats>

On Tue, 4 Apr 2000 edd@debian.org wrote:

> Full_Name: Dirk Eddelbuettel
> Version: 1.0.0 (patched)
> OS: Linux
> Submission from: (NULL) (192.139.71.69)
> 
> 
> A frame with rownames and colnames got properly written, but the colnames
> started 
> without an offset -- but if the .csv file is read back in, the rownames column
> now 
> has the header of the first column.  
> 
> "Graphically", suppose a frame with two rows 1999 and 2000, and two columns foo
> and 
> bar, with content equal to the row/col index.
> 
> This should be written as
> 
>   ,foo,bar
>   1999,11,12
>   2000,21,22
> 
> but was written without the initial ","  (I used "," as the sep).
> 
> Am I making sense? 

In the S convention, the header is regarded as separate, with a potentially
different format from the rest of the file. If I have

auk% cat test.csv
foo,bar
1999,11,12
2000,21,22

then

> read.table("test.csv", sep=",")
     foo bar
1999  11  12
2000  21  22

works, as does test <- read.csv("test.csv"). If I then do

> write.table(test, "test2.csv", sep=",", quote=F)

I get

auk% cat test2.csv
foo,bar
1999,11,12
2000,21,22

as before, so it seems that this is working as expected.  Can you give the
actual example you used that fails?  There are a lot of other things which
can potentially go wrong, including the quote setting (and I had to use
quote=F to approximate the file you quote).

Note that when I read your suggested correction with read.table/read.cvs I
get

    NA foo bar
1 1999  11  12
2 2000  21  22

unless I use read.csv("test2.csv", row.names=1).


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From edd@debian.org  Tue Apr  4 13:34:53 2000
From: edd@debian.org (Dirk Eddelbuettel)
Date: Tue, 4 Apr 2000 08:34:53 -0400
Subject: [Rd] write.table with rows and cols (PR#509)
In-Reply-To: <Pine.GSO.4.05.10004040710030.15113-100000@auk.stats>; from ripley@stats.ox.ac.uk on Tue, Apr 04, 2000 at 07:25:01AM +0100
References: <200004032323.BAA00377@pubhealth.ku.dk> <Pine.GSO.4.05.10004040710030.15113-100000@auk.stats>
Message-ID: <20000404083453.B3373@eddelbuettel.com>


With my head hanging low as this is a non-bug:

On Tue, Apr 04, 2000 at 07:25:01AM +0100, Prof Brian D Ripley wrote:
> On Tue, 4 Apr 2000 edd@debian.org wrote:
[...]
> > A frame with rownames and colnames got properly written, but the colnames
> > started 
> > without an offset -- but if the .csv file is read back in, the rownames column
> > now 
> > has the header of the first column.  
[...]

> In the S convention, the header is regarded as separate, with a potentially
> different format from the rest of the file. If I have

Ahh. Shows once again that I am still a novice when it comes to S (and R).
You are of course correct -- re-reading works just fine as expected. No bug
here.

But maybe the (extremely low-priority) need for new semantics -- I actually
only wrote the file to pass data on to my Excel using collegues at work, and
for them the csv _is_ wrong as the 'Dates' column (build from rownames) is
headerless, and the other headers are "shifted".  Having to hand-edit the
file for them is silly. 

Thanks,  Dirk

-- 
According to the latest figures, 43% of all statistics are totally worthless.
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Wed Apr  5 07:30:57 2000
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 5 Apr 2000 08:30:57 +0200
Subject: [Rd] R CMD build
In-Reply-To: <Pine.GSO.4.05.10003300709540.23994-100000@auk.stats>
References: <38E26279.BC2A6400@bank-banque-canada.ca>
 <Pine.GSO.4.05.10003300709540.23994-100000@auk.stats>
Message-ID: <200004050630.IAA16129@aragorn.ci.tuwien.ac.at>

>>>>> Prof Brian D Ripley writes:

> On Wed, 29 Mar 2000, Paul Gilbert wrote:
>> >Well, are there \alias entries in the Rd files?
>> No. I guess that would be it. Should I have an empty \alias entry if the
>> object does not have an alias, or should should I just live with the
>> warnings?

> You should have an alias for each function documented there, even if
> there is only one. The object name is itself an alias.  The \name
> field is the help file name, not the object name (although 90+% of
> them are the same), and it is the \alias's that gives the object
> names,

(Not sure about the 90+ percent :-))

>> >The convention is to put a \alias for the method in the help file for
>> the generic.
>> Ok, but I guess this won't work if the generic is the base and my method
>> is in my library?

> Sure (and that is part of the debate). Either ignore them, or have a
> .Rd with just a very brief description of these (e.g. just their
> usages).

>> >> 4/ Checking for undocumented objects fails with an ERROR when
>> checking
>> >> an (undocumented) assignment object ( "input.series.names<-" ).
>> >I think it works if you document it, though, and the error is correct,
>> >surely?  Do you mean it gives ERROR and then stops rather than warns?
>> 
>> Yes, it should warn me about this, but it gives ERROR and stops. (If I
>> run it with my makefile it returns code 1.) The message is:
>> in eval(expr, envir, enclos) : couldn't find function
>> "input.series.names<-"

> Looks like a bug, then.

Hmm.  Can you (Paul) perhaps give a small example I could reproduce?  I
just tried the following:  let the R code contain 

	"foo<-" <- function(x, value) NULL

Then if an Rd file has \alias{foo<-}, everything is o.k., if not,
"foo<-" is shows as undoc object.  How do you get the error?

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Wed Apr  5 07:40:25 2000
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Wed, 5 Apr 2000 07:40:25 +0100 (BST)
Subject: [Rd] R CMD build
In-Reply-To: <200004050630.IAA16129@aragorn.ci.tuwien.ac.at>
Message-ID: <Pine.GSO.4.05.10004050738240.21288-100000@auk.stats>

On Wed, 5 Apr 2000, Kurt Hornik wrote:

> >>>>> Prof Brian D Ripley writes:
> 
> > On Wed, 29 Mar 2000, Paul Gilbert wrote:
> >> >Well, are there \alias entries in the Rd files?
> >> No. I guess that would be it. Should I have an empty \alias entry if the
> >> object does not have an alias, or should should I just live with the
> >> warnings?
> 
> > You should have an alias for each function documented there, even if
> > there is only one. The object name is itself an alias.  The \name
> > field is the help file name, not the object name (although 90+% of
> > them are the same), and it is the \alias's that gives the object
> > names,
> 
> (Not sure about the 90+ percent :-))

Last time I looked there were about 20 exceptions in the whole of base R,
out of ca 700 files.

> 
> >> >The convention is to put a \alias for the method in the help file for
> >> the generic.
> >> Ok, but I guess this won't work if the generic is the base and my method
> >> is in my library?
> 
> > Sure (and that is part of the debate). Either ignore them, or have a
> > .Rd with just a very brief description of these (e.g. just their
> > usages).
> 
> >> >> 4/ Checking for undocumented objects fails with an ERROR when
> >> checking
> >> >> an (undocumented) assignment object ( "input.series.names<-" ).
> >> >I think it works if you document it, though, and the error is correct,
> >> >surely?  Do you mean it gives ERROR and then stops rather than warns?
> >> 
> >> Yes, it should warn me about this, but it gives ERROR and stops. (If I
> >> run it with my makefile it returns code 1.) The message is:
> >> in eval(expr, envir, enclos) : couldn't find function
> >> "input.series.names<-"
> 
> > Looks like a bug, then.
> 
> Hmm.  Can you (Paul) perhaps give a small example I could reproduce?  I
> just tried the following:  let the R code contain 
> 
> 	"foo<-" <- function(x, value) NULL
> 
> Then if an Rd file has \alias{foo<-}, everything is o.k., if not,
> "foo<-" is shows as undoc object.  How do you get the error?

That (and "input.series.names<-") work for me on Solaris, too.


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From marggie24@guelmail.com  Wed Apr  5 18:07:58 2000
From: marggie24@guelmail.com (marggie24@guelmail.com)
Date: Wed, 05 Apr 2000 17:07:58
Subject: [Rd] People with pain
Message-ID: <zfjle5ynj4hlb58.050420001707@localhost>

ARE YOU LOOKING FOR THE PERFECT BUSINESS VENTURE?

Unique product, sold in the multinational market for the last 16 years!

Only available for the last four years in the US!

One initial product purchase required to qualify for commissions!
This means no monthly qualification!

Enthusiastic testimonials from health professionals, athletes, people with chronic
pain, insomnia, circulation problems, who are using this product daily!

Immediate relief felt that continues to improve your comfort the more you use it!

Commissions paid monthly at 10 to 40% with the addition of car bonus, travel bonus and profit sharing for leadership level! Over ride profits of 1-30% on your downline
leadership groups!  Business builders compress up to become your active legs!

Invest a few minutes of your time to respond to this message by emailing

<A HREF="networks@fiberia.com">

and requesting information  or call our voice mail at
888-818-0944  for a personal return call!

We look forward to hearing from you!
***************************************************

We are terribly sorry if you received this message in error.
If you wish to be removed, please type REMOVE in the subjuct line.
ler@fiberia.com      Thank you.
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From marggie24@guelmail.com  Wed Apr  5 19:05:30 2000
From: marggie24@guelmail.com (marggie24@guelmail.com)
Date: Wed, 05 Apr 2000 18:05:30
Subject: [Rd] Live long and prosper
Message-ID: <ecl1s6skim5puq4.050420001805@localhost>

ARE YOU LOOKING FOR THE PERFECT BUSINESS VENTURE?

Unique product, sold in the multinational market for the last 16 years!

Only available for the last four years in the US!

One initial product purchase required to qualify for commissions!
This means no monthly qualification!

Enthusiastic testimonials from health professionals, athletes, people with chronic
pain, insomnia, circulation problems, who are using this product daily!

Immediate relief felt that continues to improve your comfort the more you use it!

Commissions paid monthly at 10 to 40% with the addition of car bonus, travel bonus and profit sharing for leadership level! Over ride profits of 1-30% on your downline
leadership groups!  Business builders compress up to become your active legs!

Invest a few minutes of your time to respond to this message by emailing

<A HREF="networks@fiberia.com">

and requesting information  or call our voice mail at
888-818-0944  for a personal return call!

We look forward to hearing from you!
***************************************************

We are terribly sorry if you received this message in error.
If you wish to be removed, please type REMOVE in the subjuct line.
ler@fiberia.com      Thank you.
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ligges@statistik.uni-dortmund.de  Thu Apr  6 08:28:54 2000
From: ligges@statistik.uni-dortmund.de (Uwe Ligges)
Date: Thu, 06 Apr 2000 09:28:54 +0200
Subject: [Rd] xyz.coords(.)
References: <38DA5007.B0AB5186@statistik.uni-dortmund.de>
 <14555.7873.266935.277408@lynne.ethz.ch>
 <38DD1154.9FF80C75@statistik.uni-dortmund.de> <14559.2458.327647.545328@lynne.ethz.ch>
Message-ID: <38EC3CB6.E1C7BF41@statistik.uni-dortmund.de>

In order to improve scatterplot3d(.), Martin Maechler wrote:

> Maybe you could extend  xy.coord() to xyz.coord(), a function that would be
> useful in a more general context.

If you are interested, have a look at 
http://www.statistik.uni-dortmund.de/leute/ligges.htm
for source and examples of xyz.coords(.).
I only added (changed) some lines to xy.coords(.) of R's base package.

Discussion and comments are welcome.

Best regards,
Uwe Ligges
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From krishnan@nrl.cs.uoregon.edu  Thu Apr  6 15:03:39 2000
From: krishnan@nrl.cs.uoregon.edu (Sivaramakrishna Iyer Krishnan)
Date: Thu, 6 Apr 2000 07:03:39 -0700 (PDT)
Subject: [Rd] Automation of scripts ... reading a file.
Message-ID: <Pine.BSF.3.96.1000406070011.20041E-100000@day.nrl.cs.uoregon.edu>


Hi,

I want to automate a set of scripts that spit out data that are later used
by R to plot graphs. However, I need to get into R's environment now and
then use my R script using the source command. Is there a way to run the
R script from the unix prompt ?. 

Thanks,
Krishnan.

-----------------------------------------------------------
Sivaramakrishna Iyer Krishnan (Anand)
Research Assistant 
University of Oregon. 

House Address : 		Office Address : 
942 East, 18th Avenue, #14,	Deschutes Hall, Computer Science Department,
Ridgewood Apartments,		Room No. 228, University of Oregon - 97403.
Eugene, Oregon - 97403. 	Ph. : 541-346-4409.
Ph. : 541-683-8223.

E-mail : krishnan@nrl.cs.uoregon.edu,krishnan@.cs.uoregon.edu
URL    : http://www.nrg.cs.uoregon.edu/~krishnan/cs-web/.
------------------------------------------------------------
"It is better to be defeated on principle than to win on lies."
- Arthur Calwell

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From guido@sirio.stat.unipd.it  Thu Apr  6 17:29:08 2000
From: guido@sirio.stat.unipd.it (Guido Masarotto)
Date: Thu, 6 Apr 2000 18:29:08 +0200
Subject: [Rd] Re: [R] MetaPost device?
In-Reply-To: <x2ya6r2qea.fsf@blueberry.kubism.ku.dk>; from p.dalgaard@biostat.ku.dk on Thu, Apr 06, 2000 at 05:35:57PM +0200
References: <005501bf9fd8$2697d420$9570fe8c@lucent.com> <x2ya6r2qea.fsf@blueberry.kubism.ku.dk>
Message-ID: <20000406182908.A19743@sirio.stat.unipd.it>

[moving to r-devel]


On Thu, Apr 06, 2000 at 05:35:57PM +0200, Peter Dalgaard BSA wrote:
> "Vidhyanath Rao" <rao.3@osu.edu> writes:
> 
> > I would like to know if a MetaPost device is available or in the plans.
> > .....................................................................
> > If not, how easy/hard is it to add a new device to R? I caouln't see
> > ...................................................................
> It's not terribly hard (said the man who people have been nagging to
> do an xfig driver for years...) if you know the file format to
> generate. You need to figure out how to do do a rather small
> set of primitives to do text, polylines, etc., and then fill routines
> to do those into a fairly simple framework. 

  The problem with MetaPost (if I understand well) is how
  you do get metric information about the fonts. 
  In particular for the plotmath stuff.
  The easiest way is to delegate the whole thing to metapost itself (and
  to TeX in the back), i.e., you use 
  > text(somewhere,"\sum_i x_i")
  (not 'text(somewhere,expression(...))')
  and on the mp file the device write
  'btex $\sum_i x_i$ etex'
  ie, you ask to MetaPost to call TeX to process the fragment.
  However, this has the obvious drawback that the preview on the screen
  is not good.
  The alternative is to use the approach of the postscript device
  (you fix the fonts available, distribute a set of files with metric
   information of the fonts, and make the device to use it).
   I am not sure about how hard this will be. BTW, which
   kind of fonts is used by MetaPost?

   guido
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From J.C.Rougier@durham.ac.uk  Thu Apr  6 19:15:05 2000
From: J.C.Rougier@durham.ac.uk (J.C.Rougier@durham.ac.uk)
Date: Thu, 6 Apr 2000 20:15:05 +0200 (MET DST)
Subject: [Rd] Strange behaviour of image (PR#510)
Message-ID: <200004061815.UAA02888@pubhealth.ku.dk>

The following commands

z <- matrix(seq(0, 1, len=1000))
image(z, 1, z, zlim=c(0, 1), col=gray(1:10/10))

appear to violate the image functionality as described on the
help page.  As I understand it, by specifying a zlim of c(0, 1)
and a colour vector of length 10, the colours should correspond
to the intervals (0, 0.1), (0.1, 0.2), ..., (0.9, 1.0), this
being 10 equally-spaced intervals on (0, 1).  It is clear from
the image that this has not occurred.  In fact the intervals are
apparently (0, 1/18), (1/18, 3/18), ..., (15/18, 17/18), (17/18,
1).  Have I misunderstood something?

Cheers, Jonathan.

--please do not edit the information below--

Version:
 platform = sparc-sun-solaris2.7
 arch = sparc
 os = solaris2.7
 system = sparc, solaris2.7
 status = Patched
 major = 0
 minor = 99.0
 year = 2000
 month = February
 day = 9
 language = R

Search Path:
 .GlobalEnv, Autoloads, package:base

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Thu Apr  6 19:47:44 2000
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 06 Apr 2000 20:47:44 +0200
Subject: [Rd] Strange behaviour of image (PR#510)
In-Reply-To: J.C.Rougier@durham.ac.uk's message of "Thu, 6 Apr 2000 20:15:05 +0200 (MET DST)"
References: <200004061815.UAA02888@pubhealth.ku.dk>
Message-ID: <x21z4jnk1b.fsf@blueberry.kubism.ku.dk>

J.C.Rougier@durham.ac.uk writes:

> The following commands
> 
> z <- matrix(seq(0, 1, len=1000))
> image(z, 1, z, zlim=c(0, 1), col=gray(1:10/10))
> 
> appear to violate the image functionality as described on the
> help page.  As I understand it, by specifying a zlim of c(0, 1)
> and a colour vector of length 10, the colours should correspond
> to the intervals (0, 0.1), (0.1, 0.2), ..., (0.9, 1.0), this
> being 10 equally-spaced intervals on (0, 1).  It is clear from
> the image that this has not occurred.  In fact the intervals are
> apparently (0, 1/18), (1/18, 3/18), ..., (15/18, 17/18), (17/18,
> 1).  Have I misunderstood something?

I don't see that anything else is being promised...

If someone actually thought about this, then the choice might be
related to the behavior at peaks and troughs. (since a circle with
radius r looks wide compared to the region between two circles with
diameter n*r and (n+1)*r)

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ihaka@stat.auckland.ac.nz  Thu Apr  6 23:02:31 2000
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Fri, 7 Apr 2000 10:02:31 +1200
Subject: [Rd] Re: [R] MetaPost device?
In-Reply-To: <20000406182908.A19743@sirio.stat.unipd.it>; from Guido Masarotto on Thu, Apr 06, 2000 at 06:29:08PM +0200
References: <005501bf9fd8$2697d420$9570fe8c@lucent.com> <x2ya6r2qea.fsf@blueberry.kubism.ku.dk> <20000406182908.A19743@sirio.stat.unipd.it>
Message-ID: <20000407100231.A2998@stat1.stat.auckland.ac.nz>

On Thu, Apr 06, 2000 at 06:29:08PM +0200, Guido Masarotto wrote:

>   The problem with MetaPost (if I understand well) is how
>   you do get metric information about the fonts. 

The metric info problem is what stoped me writing the XFig driver.
Which metrics do you use for Times-Roman for example -- the X11 metrics
or the PostScript metrics?
	
	Ross
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pd@blueberry.kubism.ku.dk  Fri Apr  7 06:15:04 2000
From: pd@blueberry.kubism.ku.dk (Peter Dalgaard BSA)
Date: Fri, 7 Apr 2000 07:15:04 +0200
Subject: [Rd] Bug list summary (automatic post)
Message-ID: <200004070515.HAA21833@blueberry.kubism.ku.dk>

=================================================
This is an automated summary of the status of the R-bugs
repository.

Note that this may be neither complete nor perfectly
correct at any given instance: Not all bugs are reported,
and some reported bugs may have been fixed, but the
repository not yet updated.

Some bug fixes are difficult to verify because they pertain
to specific hardware or operating system versions. If you
have information to contribute, please do so.

If you happen to know how to fix a problem please send
patches to the bug repository, too.

New bugs are reported either through the web
interface at r-bugs.biostat.ku.dk or via email to
r-bugs@biostat.ku.dk. The bug.report() function can be
used to automate parts of the procedure on many systems.
Followups on older bugs can be done by including the string
"(PR#999)" in the Subject of an email (change 999 to the
actual reference number, of course!).
=================================================

Directory:  Accuracy

none

Directory:  Add-ons

* PR# 503 *
Subject: dmvnorm() bug in e1071
From: "Gregory R. Warnes" <warnes@biostat.washington.edu>
Date: Fri, 24 Mar 2000 03:24:45 +0000 (GMT)
* PR# 496 *
From: bonneau@epi.roazhon.inra.fr (en148)
Date: Tue, 21 Mar 2000 10:57:13 +0100 (MET)
--base R has no est.variogram function.
--This appears to be a bug report on sgeostat.
* PR# 471 *
Subject:  Problems with nlme 
From: Berwin Turlach <berwin@maths.uwa.edu.au>
Date: Tue, 7 Mar 2000 15:28:00 +0800
--Problem 1) was a subscripting bug introduced in 1.0.0 and fixed for 1.0.1
--Problem 2) (mssing datasets) needs a revised nlme

Directory:  Analyses

none

Directory:  Documentation

* PR# 497 *
Subject: par help wrong: xlog & ylog
From: wsi@gcal.ac.uk
Date: Tue, 21 Mar 2000 14:57:57 +0100 (MET)

Directory:  Graphics

* PR# 495 *
Subject: barplot
From: skala@incoma.cz
Date: Tue, 21 Mar 2000 09:20:33 +0100 (MET)
* PR# 202 *
Subject: persp box occlusion bug
From: wsi@gcal.ac.uk
Date: Wed, 2 Jun 1999 15:02:03 +0200 (MET DST)
--The persp algorithm does not apply the occlusion rules to the frame, 
--which is always plotted first. 
--A bug, but not very simple to fix.
* PR# 414 *
Subject:  graphics bugs: steep slopes and large values beyond ylim 
From: Ben Bolker <bolker@zoo.ufl.edu>
Date: Mon, 7 Feb 2000 18:28:04 -0500
--Followup on R-devel showed this was due to generating integer coordinates 
--outside +/- 2^15 in the X11 driver.
* PR# 400 *
Subject: X11 troubles
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 13 Jan 2000 14:31:42 +0100
--a) We don't handle multiple window closes well
--b) X11 errors should be caught by an error handler, not kill R
* PR# 494 *
Subject:  minor problem in barplot legend 
From: Ben Bolker <bolker@zoo.ufl.edu>
Date: Mon, 20 Mar 2000 17:31:36 -0500
* PR# 483 *
Subject: error in par option xaxt
From: aim@uwo.ca
Date: Mon, 13 Mar 2000 22:02:42 +0100 (MET)

Directory:  In-Out

none

Directory:  Installation

* PR# 485 *
Subject: Install R1.0.0
From: Lynn Zhang <lyzhang@umich.edu>
Date: Mon, 13 Mar 2000 16:10:52 -0500 (EST)
* PR# 478 *
Subject: Conditional for XDR code left out in saveload.c
From: hoffmann@ehmgs2.et.tu-dresden.de
Date: Thu, 9 Mar 2000 09:43:01 +0100 (MET)
--This seems to be a harmless warning, not an error.
* PR# 467 *
Subject: Re: [R] Re: R-1.0.0 is released
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 01 Mar 2000 20:26:40 +0100
--followup to PR#466
* PR# 466 *
Subject: Re: R-1.0.0 is released
From: bhoel@server.python.net (Berthold=?iso-8859-1?q?_H=F6llmann?=)
Date: 01 Mar 2000 16:00:54 +0100

Directory:  Language

* PR# 412 *
Subject: anomalies with call objects
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 06 Feb 2000 01:18:50 +0100
* PR# 408 *
Subject: convolution bug
From: wsimpson@gcal.ac.uk
Date: Fri, 28 Jan 2000 11:17:36 +0100 (MET)

Directory:  Low-level

* PR# 500 *
Subject:  segmentation fault with 1D array 
From: J.C.Rougier@durham.ac.uk
Date: Wed, 22 Mar 2000 18:25:24 GMT
* PR# 391 *
Subject: Segfault in dataentry()
From: Peter Dalgaard BSA <p.dalgaard@pubhealth.ku.dk>
Date: 29 Dec 1999 11:59:50 +0100
--dataentry(0,0) segfaults

Directory:  Misc

none

Directory:  Models

none

Directory:  Startup

* PR# 486 *
Subject: Re: autoload error in profile {was anova-bug in R-version  1.0.0?}
From: Martin Maechler <maechler@stat.math.ethz.ch>
Date: Tue, 14 Mar 2000 10:32:43 +0100 (MET)

Directory:  System-specific

* PR# 490 *
Subject: R-1.0.0 on alpha/osf1 memory glitch
From: Ray Brownrigg <Ray.Brownrigg@mcs.vuw.ac.nz>
Date: Fri, 17 Mar 2000 11:25:30 +1300 (NZDT)
* PR# 452 *
Subject: problem with glm
From: Brad McNeney <mcneney@cs.sfu.ca>
Date: Fri, 18 Feb 2000 17:51:54 -0800 (PST)
--Problems on Alpha's with glm. Status unclear

Directory:  TooMuchAtOnce

none

Directory:  Windows

none

Directory:  incoming

* PR# 510 *
Subject:  Strange behaviour of image 
From: J.C.Rougier@durham.ac.uk
Date: Thu, 6 Apr 2000 19:15:19 +0100 (BST)
* PR# 488 *
Subject: Error in lme?
From: simon.frost@ed.ac.uk
Date: Tue, 14 Mar 2000 14:15:52 +0100 (MET)
--No example to reproduce this.
* PR# 463 *
Subject: Bug in read.table
From: "E. S. Venkatraman" <venkat@biosta.mskcc.org>
Date: Tue, 29 Feb 2000 17:47:54 -0500 (EST)
--looks like quote arguments to read.table/count.fields needs to be set
* PR# 505 *
Subject: interrupted save 
From: Thomas Lumley <thomas@biostat.washington.edu>
Date: Sat, 25 Mar 2000 12:16:50 -0800 (PST)
* PR# 498 *
Subject: Use of Rd2txt on .Rd files from rw-1.0.0
Subject: Use of Rd2txt on .Rd files from rw-1.0.0
From: John Maindonald <john.maindonald@anu.edu.au>
Date: Wed, 22 Mar 2000 09:15:20 +1100 (EST)
--No response from author, but does look like using CRLF files on Unix.
* PR# 507 *
Subject: another save/load problem, only(?) affecting ascii = TRUE
From: Martin Maechler <maechler@stat.math.ethz.ch>
Date: Mon, 3 Apr 2000 14:37:50 +0200 (CEST)
* PR# 506 *
Subject: matlines, matpoints don't follow prototype
From: "Charles C. Berry" <cberry@tajo.ucsd.edu>
Date: Sun, 26 Mar 2000 12:51:24 -0800
* PR# 509 *
Subject: write.table with rows and cols
From: edd@debian.org
Date: Tue, 4 Apr 2000 01:23:32 +0200 (MET DST)
* PR# 508 *
Subject: cbind.ts(),ts.union()
From: koller2@fgr.wu-wien.ac.at
Date: Mon, 3 Apr 2000 20:08:11 +0200 (MET DST)
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Fri Apr  7 07:17:13 2000
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Fri, 7 Apr 2000 08:17:13 +0200 (CEST)
Subject: [Rd] Re: [R] Perl v5.6.0 breaks the configure script
In-Reply-To: <Pine.GSO.4.05.10004051414570.1837-100000@auk.stats>
References: <20000405083728.A29748@eddelbuettel.com>
 <Pine.GSO.4.05.10004051414570.1837-100000@auk.stats>
Message-ID: <14573.32105.668793.488172@aragorn.ci.tuwien.ac.at>

>>>>> Prof Brian D Ripley writes:

> On Wed, 5 Apr 2000, Dirk Eddelbuettel wrote:
>> 
>> On Wed, Apr 05, 2000 at 10:31:57AM +0100, Prof Brian D Ripley wrote:
>> > On Wed, 5 Apr 2000, tom kennedy wrote:
>> [..] 
>> > I think the trick is to use perl itself, as in
>> > 
>> > perl_version=`${PERL} -e '$v=$]; $v =~ s/(.)\..*/\1/;print $v'`
>> > 
>> > as perl is guaranteed to return its version as a number like 5.006
>> > even for `v5.6.0'.
>> > 
>> > Unfortunately the "]" in there confuses m4 when building configure
>> > from aclocal.m4, but I am sure the experts can fix that.

Guess this means that I am not an autoconf expert any more.

>> 
>> One would be to use the English module and PERL_VERSION instead:
>> 
>> perl_version=
>> = `${PERL}-MEnglish  -e '$v=$PERL_VERSION; $v =~ s/(.)\..*/\1/;print $v'`
>> 
>> > One could even do the whole test in Perl:
>> > 
>> > r_cv_prog_perl_v5=
>> > `${PERL} -e 'if($] >= 5) {print "yes";} else {print "no"}'`
>> 
>> Likewise:
>> 
>> r_cv_prog_perl_v5=
>> `${PERL} -MEnglish -e 'if($] >= 5) {print "yes";} else {print "no"}'`
> Um, not that but I think we know what you meant!

> Yes, I know and I considered that, but I do not think the English
> module is guaranteed to be present. This is a test of the Perl
> version, and as far as I could see -MEnglish does not work in Perl 4.
> (The -M flag is not in the Quick Reference Guide for 4.019.)  So I
> think your version assumes the thing it is testing for, Perl 5.x.

I also think we should not assume that English is there.

Anyway, I tried adding a line of code to configure.in which uses $], but
I failed miserably ... I would either get M4 syntax errors or not get
the `]'.  Hence, I changed the test to

    AC_CACHE_CHECK([whether perl version is at least 5],
      r_cv_prog_perl_v5,
      [ ${PERL} -e 'require 5' 2>/dev/null
        if test ${?} -eq 0; then
          r_cv_prog_perl_v5=yes
        else
          r_cv_prog_perl_v5=no
        fi
      ])

which I think should also do the job.

Changed in r-devel only.  If anyone thinks we should also do this in
r-release for 1.0.1, pls let me know && I will make the change (assuming
that the fix is correct).

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Fri Apr  7 07:28:47 2000
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Fri, 7 Apr 2000 07:28:47 +0100 (BST)
Subject: [Rd] Re: [R] Perl v5.6.0 breaks the configure script
In-Reply-To: <14573.32105.668793.488172@aragorn.ci.tuwien.ac.at>
Message-ID: <Pine.GSO.4.05.10004070722320.23146-100000@auk.stats>

On Fri, 7 Apr 2000, Kurt Hornik wrote:

> Anyway, I tried adding a line of code to configure.in which uses $], but
> I failed miserably ... I would either get M4 syntax errors or not get
> the `]'.  Hence, I changed the test to
> 
>     AC_CACHE_CHECK([whether perl version is at least 5],
>       r_cv_prog_perl_v5,
>       [ ${PERL} -e 'require 5' 2>/dev/null
>         if test ${?} -eq 0; then
>           r_cv_prog_perl_v5=yes
>         else
>           r_cv_prog_perl_v5=no
>         fi
>       ])
> 
> which I think should also do the job.

Can anyone test this?  Again, I thought of that, and `require number'
is not in my Perl 4 book.  So although I think it will fail on Perl4,
I am not sure.  In any case, it is safer than what went before.

> Changed in r-devel only.  If anyone thinks we should also do this in
> r-release for 1.0.1, pls let me know && I will make the change (assuming
> that the fix is correct).

Yes, I think it should be changed. We want 1.0.1 to configure under the 
current Perl, which is the only easy one to find.

Brian

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From maechler@stat.math.ethz.ch  Fri Apr  7 10:35:45 2000
From: maechler@stat.math.ethz.ch (maechler@stat.math.ethz.ch)
Date: Fri, 7 Apr 2000 11:35:45 +0200 (MET DST)
Subject: [Rd] matlines, matpoints don't follow prototype (PR#506)
Message-ID: <200004070935.LAA08246@pubhealth.ku.dk>

>>>>> "ChuckB" == Charles C Berry <cberry@tajo.ucsd.edu> writes:

    ChuckB> The Blue Book allows the 'type' argument to be used in matpoints and
    ChuckB> matlines.

    ChuckB>	matlines(x, y, type="l", lty=1:5, pch=, col=1:4)

    ChuckB> R-1.0.0 does not.

    ChuckB> Thus, type="h", "b", must be invoked thru matplot( x, y, type = "h",
    ChuckB> add=TRUE)

    ChuckB> For the sake of consistency with S, it would be nice to have
    ChuckB> matlines defined as:

    ChuckB> "matlines" <-
    ChuckB> function(x, y, type = 'l', lty=1:5, lwd = 1, pch=NULL, col=1:6, ...)
    ChuckB> matplot(x=x, y=y, type=type, lty=lty, lwd=lwd, pch=pch, col=col,
    ChuckB> add=TRUE, ...)

    ChuckB> and similarly for matpoints.

You are right.

I've fixed it for the upcoming patch release (1.0.1).

Martin Maechler <maechler@stat.math.ethz.ch>	http://stat.ethz.ch/~maechler/
Seminar fuer Statistik, ETH-Zentrum  LEO D10	Leonhardstr. 27
ETH (Federal Inst. Technology)	8092 Zurich	SWITZERLAND
phone: x-41-1-632-3408		fax: ...-1228			<><

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Fri Apr  7 11:44:44 2000
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Fri, 7 Apr 2000 12:44:44 +0200 (CEST)
Subject: [Rd] Re: [R] Perl v5.6.0 breaks the configure script
In-Reply-To: <Pine.GSO.4.05.10004070722320.23146-100000@auk.stats>
References: <14573.32105.668793.488172@aragorn.ci.tuwien.ac.at>
 <Pine.GSO.4.05.10004070722320.23146-100000@auk.stats>
Message-ID: <14573.48156.91155.461519@aragorn.ci.tuwien.ac.at>

>>>>> Prof Brian D Ripley writes:

> On Fri, 7 Apr 2000, Kurt Hornik wrote:
>> Anyway, I tried adding a line of code to configure.in which uses $], but
>> I failed miserably ... I would either get M4 syntax errors or not get
>> the `]'.  Hence, I changed the test to
>> 
>> AC_CACHE_CHECK([whether perl version is at least 5],
>> r_cv_prog_perl_v5,
>> [ ${PERL} -e 'require 5' 2>/dev/null
>> if test ${?} -eq 0; then
>> r_cv_prog_perl_v5=yes
>> else
>> r_cv_prog_perl_v5=no
>> fi
>> ])
>> 
>> which I think should also do the job.

> Can anyone test this?  Again, I thought of that, and `require number'
> is not in my Perl 4 book.  So although I think it will fail on Perl4,
> I am not sure.  In any case, it is safer than what went before.

My idea was that if it fails in v4 it is fine anyway.  (Testing for a
feature only present in v5 is also a good test for v5.)

In fact:

khornik@sim:~$ perl4 -v

This is perl, version 4.0

$RCSfile: perl.c,v $$Revision: 4.0.1.8 $$Date: 1993/02/05 19:39:30 $
Patch level: 36

Copyright (c) 1989, 1990, 1991, Larry Wall

khornik@sim:~$ perl4 -e 'require 5'            
Can't locate 5 in @INC at /tmp/perl-ea22225 line 1.

hence:

khornik@sim:~$ perl4 -e 'require 5' 2>/dev/null
khornik@sim:~$ echo $?
2

>> Changed in r-devel only.  If anyone thinks we should also do this in
>> r-release for 1.0.1, pls let me know && I will make the change (assuming
>> that the fix is correct).

> Yes, I think it should be changed. We want 1.0.1 to configure under
> the current Perl, which is the only easy one to find.

Good enough?

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Fri Apr  7 12:26:22 2000
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 07 Apr 2000 13:26:22 +0200
Subject: [Rd] Re: [R] Perl v5.6.0 breaks the configure script
In-Reply-To: Kurt Hornik's message of "Fri, 7 Apr 2000 12:44:44 +0200 (CEST)"
References: <14573.32105.668793.488172@aragorn.ci.tuwien.ac.at> <Pine.GSO.4.05.10004070722320.23146-100000@auk.stats> <14573.48156.91155.461519@aragorn.ci.tuwien.ac.at>
Message-ID: <x2zor640f5.fsf@blueberry.kubism.ku.dk>

Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:


> khornik@sim:~$ perl4 -e 'require 5' 2>/dev/null
> khornik@sim:~$ echo $?
> 2
...
> Good enough?

Hmmmf... Well if it can't be otherwise, but the *right* solution would
seem to be

if perl -e 'exit 1 if $]<5' 
then
  r_cv_prog_perl_v5=yes
else
  r_cv_prog_perl_v5=no
fi
 

if it weren't for that %/&/%# m4 problem... (I'll see what I can dig up) 

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Thomas Vogels <tov@ece.cmu.edu>  Fri Apr  7 15:53:35 2000
From: Thomas Vogels <tov@ece.cmu.edu> (Thomas J Vogels)
Date: 07 Apr 2000 10:53:35 -0400
Subject: [Rd] Re: [R] MetaPost device?
In-Reply-To: Ross Ihaka's message of "Fri, 7 Apr 2000 10:02:31 +1200"
References: <005501bf9fd8$2697d420$9570fe8c@lucent.com> <x2ya6r2qea.fsf@blueberry.kubism.ku.dk> <20000406182908.A19743@sirio.stat.unipd.it> <20000407100231.A2998@stat1.stat.auckland.ac.nz>
Message-ID: <87d7o2hsi8.fsf@bavaria.ece.cmu.edu>


Ross Ihaka <ihaka@stat.auckland.ac.nz> writes:

> On Thu, Apr 06, 2000 at 06:29:08PM +0200, Guido Masarotto wrote:
> 
> >   The problem with MetaPost (if I understand well) is how
> >   you do get metric information about the fonts. 
> 
> The metric info problem is what stoped me writing the XFig driver.
> Which metrics do you use for Times-Roman for example -- the X11 metrics
> or the PostScript metrics?

I'll be sorry for this naive question, but if you limited the fonts
in the FIG output to LaTeX fonts, couldn't you use the LaTeX font
information?  (This doesn't solve the problem that what you see in an
X11 device is not what you get with dev.print which may or may not be
a good thing.)

  -tom

-- 
mailto:tov@ece.cmu.edu (Tom Vogels)   Tel: (412) 268-6638   FAX: -3204
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From dtrenkler@nts6.oec.uni-osnabrueck.de  Fri Apr  7 16:15:31 2000
From: dtrenkler@nts6.oec.uni-osnabrueck.de (dtrenkler@nts6.oec.uni-osnabrueck.de)
Date: Fri, 7 Apr 2000 17:15:31 +0200 (MET DST)
Subject: [Rd] Bug in qbinom? (PR#511)
Message-ID: <200004071515.RAA13504@pubhealth.ku.dk>

n_10;p_0.5;jjx_0:n;qbinom(pbinom(jjx,n,p),n,p) #  This one works as
expected

n_100;p_0.5;jjx_0:n;qbinom(pbinom(jjx,n,p),n,p)  # This one causes
severe problems

I cannot interrupt using ESC and I finally have to resort to the Windows
Task manager to kill the R session.
A friend of mine told me that he faced similar problems under Unix.



--please do not edit the information below--

Version:
 platform = Windows
 arch = x86
 os = Win32
 system = x86, Win32
 status = 
 major = 1
 minor = 0.0
 year = 2000
 month = February
 day = 29
 language = R

Windows NT 4.0 (build 1381) Service Pack 3

Search Path:
 .GlobalEnv, Autoloads, package:base




   --- D.Trenkler ---

************************************************************************
*********
   Dietrich Trenkler
(trenkler@oec.uni-osnabrueck.de)      
   Statistik / Empirische Wirtschaftsforschung
   Universitaet Osnabrueck
   Rolandstrasse 8                             Phone: +49(0)
541-969-2753
   D-49069 Osnabrueck                        Fax  : +49(0) 541-969-2745
   GERMANY
************************************************************************
*********




-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From thomas@biostat.washington.edu  Fri Apr  7 16:33:13 2000
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Fri, 7 Apr 2000 08:33:13 -0700 (PDT)
Subject: [Rd] Bug in qbinom? (PR#511)
In-Reply-To: <200004071515.RAA13504@pubhealth.ku.dk>
Message-ID: <Pine.GSO.4.21.0004070829110.20598-100000@mail.biostat.washington.edu>

On Fri, 7 Apr 2000 dtrenkler@nts6.oec.uni-osnabrueck.de wrote:

> n_10;p_0.5;jjx_0:n;qbinom(pbinom(jjx,n,p),n,p) #  This one works as
> expected
> 
> n_100;p_0.5;jjx_0:n;qbinom(pbinom(jjx,n,p),n,p)  # This one causes
> severe problems

The problem is in qbinom(1-epsilon,100,0.5) for epsilon between 10^-15 and
10^-17. It appears to go for ever.

> pbinom(jjx,n,p)[89]-1 
[1] -1.110223e-16

An even simpler version is
   qbinom(1-1e-16,2,0.5)

Presumably a check for zero needs some fuzz.

	-thomas

Thomas Lumley
Assistant Professor, Biostatistics
University of Washington, Seattle

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From tov@ece.cmu.edu  Fri Apr  7 16:53:25 2000
From: tov@ece.cmu.edu (tov@ece.cmu.edu)
Date: Fri, 7 Apr 2000 17:53:25 +0200 (MET DST)
Subject: [Rd] x11 colortype problems ('gray' is broken?) (PR#512)
Message-ID: <200004071553.RAA13862@pubhealth.ku.dk>


Hi,

  I occasionally run out of color in my X11 terminal.  At this
point, R will issue this error message:
        Error: X11 cannot allocate additional graphics colors.
Consider using colortype="pseudo.cube" or "gray".

An immediate x11(colortype="pseudo.cube") doesn't work as the
colortype seems to be shared among the different x11 plotting windows.
So I have to close all windows first, then I can open an x11 device
with the colortype "pseudo.cube".  (Neither the necessity to close all
windows nor the fact, that colortype is an option to X11 and not to
the plot command, is clear from the help pages or the error message.)

The real problem, however, comes with x11(colortype="gray") as this
brings up just a black screen (and it stays black).  I can't quite see
whether I'm stumbling across some issues with X resources, here.
x11() usually gives a white background.

Thanks,
  -tom


 --
platform = i586-unknown-linux
arch = i586
os = linux
system = i586, linux
status = 
major = 1
minor = 0.0
year = 2000
month = February
day = 29
language = R


-- 
mailto:tov@ece.cmu.edu (Tom Vogels)   Tel: (412) 268-6638   FAX: -3204


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From J.C.Rougier@durham.ac.uk  Fri Apr  7 17:04:17 2000
From: J.C.Rougier@durham.ac.uk (Jonathan Rougier)
Date: Fri, 7 Apr 2000 17:04:17 +0100 (BST)
Subject: [Rd] Strange behaviour of image (PR#510)
In-Reply-To: <x21z4jnk1b.fsf@blueberry.kubism.ku.dk>
Message-ID: <Pine.GSO.4.20.0004071656130.15072-100000@laplace>

Hi Peter,

On 6 Apr 2000, Peter Dalgaard BSA wrote:

> J.C.Rougier@durham.ac.uk writes:
> 
> > The following commands
> > 
> > z <- matrix(seq(0, 1, len=1000))
> > image(z, 1, z, zlim=c(0, 1), col=gray(1:10/10))
> > 
> > appear to violate the image functionality as described on the
> > help page.  As I understand it, by specifying a zlim of c(0, 1)
> > and a colour vector of length 10, the colours should correspond
> > to the intervals (0, 0.1), (0.1, 0.2), ..., (0.9, 1.0), this
> > being 10 equally-spaced intervals on (0, 1).  It is clear from
> > the image that this has not occurred.  In fact the intervals are
> > apparently (0, 1/18), (1/18, 3/18), ..., (15/18, 17/18), (17/18,
> > 1).  Have I misunderstood something?
> 
> I don't see that anything else is being promised...
> 
> If someone actually thought about this, then the choice might be
> related to the behavior at peaks and troughs. (since a circle with
> radius r looks wide compared to the region between two circles with
> diameter n*r and (n+1)*r)

I'm not quite sure I follow.  My feeling is that the displayed behaviour
of image is unreasonable, and, I hazard, not what most people who use
image expect.  I think the default behaviour of image should be to give
colour bands of equal widths, and, if I may append to the wish list, I
woud like to be able to specify a "breaks" argument to have unequal widths
should I so choose.

Cheers, Jonathan.

Jonathan Rougier                       Science Laboratories
Department of Mathematical Sciences    South Road
University of Durham                   Durham DH1 3LE
http://www.maths.dur.ac.uk/stats/people/jcr/jcr.html


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From thomas@biostat.washington.edu  Fri Apr  7 17:10:59 2000
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Fri, 7 Apr 2000 09:10:59 -0700 (PDT)
Subject: [Rd] Bug in qbinom? (PR#511)
In-Reply-To: <200004071515.RAA13504@pubhealth.ku.dk>
Message-ID: <Pine.GSO.4.21.0004070904390.20598-100000@mail.biostat.washington.edu>

On Fri, 7 Apr 2000 dtrenkler@nts6.oec.uni-osnabrueck.de wrote:

> n_10;p_0.5;jjx_0:n;qbinom(pbinom(jjx,n,p),n,p) #  This one works as
> expected
> 
> n_100;p_0.5;jjx_0:n;qbinom(pbinom(jjx,n,p),n,p)  # This one causes
> severe problems


In qbinom  we calculate an estimate y based on a Cornish-Fisher expansion
and then search up or down to the right number.  However, for p=1-1e-16 or
thereabouts we get

y=83931130944911952

which is bigger than 1/machine epsilon.  Thus y=y-1 and searching up or
down doesnt work.  A crude solution is to just treat this as p=1, but it
would be better to search up or down in bigger steps.

	-thomas


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From maechler@stat.math.ethz.ch  Fri Apr  7 17:23:38 2000
From: maechler@stat.math.ethz.ch (maechler@stat.math.ethz.ch)
Date: Fri, 7 Apr 2000 18:23:38 +0200 (MET DST)
Subject: [Rd] Bug in qbinom? (PR#511)
Message-ID: <200004071623.SAA14021@pubhealth.ku.dk>

>>>>> "TL" == Thomas Lumley <thomas@biostat.washington.edu> writes:

    TL> On Fri, 7 Apr 2000 dtrenkler@nts6.oec.uni-osnabrueck.de wrote:
    >> n_10;p_0.5;jjx_0:n;qbinom(pbinom(jjx,n,p),n,p) #  This one works as
    >> expected
    >> 
    >> n_100;p_0.5;jjx_0:n;qbinom(pbinom(jjx,n,p),n,p)  # This one causes
    >> severe problems

    TL> The problem is in qbinom(1-epsilon,100,0.5) for epsilon between
    TL> 10^-15 and 10^-17. It appears to go for ever.

    >> pbinom(jjx,n,p)[89]-1 
    TL> [1] -1.110223e-16

    TL> An even simpler version is
    TL> qbinom(1-1e-16,2,0.5)

    TL> Presumably a check for zero needs some fuzz.

Note that we (I) also have a considerable improvement for  dbinom() in the
pipeline, from  Clive Loader's post of a few weeks ago.

But this may be a completely orthogonal issue...
I will have a look over the weekend.

Martin

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Prof Brian Ripley <ripley@stats.ox.ac.uk>  Fri Apr  7 17:51:47 2000
From: Prof Brian Ripley <ripley@stats.ox.ac.uk> (Prof Brian Ripley)
Date: Fri, 7 Apr 2000 17:51:47 +0100 (BST)
Subject: [Rd] Strange behaviour of image (PR#510)
Message-ID: <200004071651.RAA15284@toucan.stats.ox.ac.uk>


> Date: Fri, 7 Apr 2000 17:04:17 +0100 (BST)
> From: Jonathan Rougier <J.C.Rougier@durham.ac.uk>
> 
> Hi Peter,
> 
> On 6 Apr 2000, Peter Dalgaard BSA wrote:
> 
> > J.C.Rougier@durham.ac.uk writes:
> > 
> > > The following commands
> > > 
> > > z <- matrix(seq(0, 1, len=1000))
> > > image(z, 1, z, zlim=c(0, 1), col=gray(1:10/10))
> > > 
> > > appear to violate the image functionality as described on the
> > > help page.  As I understand it, by specifying a zlim of c(0, 1)
> > > and a colour vector of length 10, the colours should correspond
> > > to the intervals (0, 0.1), (0.1, 0.2), ..., (0.9, 1.0), this
> > > being 10 equally-spaced intervals on (0, 1).  It is clear from
> > > the image that this has not occurred.  In fact the intervals are
> > > apparently (0, 1/18), (1/18, 3/18), ..., (15/18, 17/18), (17/18,
> > > 1).  Have I misunderstood something?
> > 
> > I don't see that anything else is being promised...
> > 
> > If someone actually thought about this, then the choice might be
> > related to the behavior at peaks and troughs. (since a circle with
> > radius r looks wide compared to the region between two circles with
> > diameter n*r and (n+1)*r)
> 
> I'm not quite sure I follow.  My feeling is that the displayed behaviour
> of image is unreasonable, and, I hazard, not what most people who use
> image expect.  I think the default behaviour of image should be to give
> colour bands of equal widths, and, if I may append to the wish list, I
> woud like to be able to specify a "breaks" argument to have unequal widths
> should I so choose.

I side with Jonathan.

(1) The prototype does as JCR describes: given 64 colours it allocates
1/64th of the space to each.

(2) Setting the break points seems a good idea to me (but can always be
faked by a non-linear monotonic transformation of z, as I have done
before now).

I suggest we do add a `breaks' arg and that we do change the default
at the level of the R code, perhaps with an oldstyle parameter.
OK?

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Fri Apr  7 17:59:22 2000
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 07 Apr 2000 18:59:22 +0200
Subject: [Rd] Strange behaviour of image (PR#510)
In-Reply-To: Prof Brian Ripley's message of "Fri, 7 Apr 2000 17:51:47 +0100 (BST)"
References: <200004071651.RAA15284@toucan.stats.ox.ac.uk>
Message-ID: <x2wvm93l05.fsf@blueberry.kubism.ku.dk>

Prof Brian Ripley <ripley@stats.ox.ac.uk> writes:

> I side with Jonathan.
> 
> (1) The prototype does as JCR describes: given 64 colours it allocates
> 1/64th of the space to each.
> 
> (2) Setting the break points seems a good idea to me (but can always be
> faked by a non-linear monotonic transformation of z, as I have done
> before now).
> 
> I suggest we do add a `breaks' arg and that we do change the default
> at the level of the R code, perhaps with an oldstyle parameter.
> OK?

OK with me. Didn't feel too strongly about in in the first place. But
perhaps somone else did since they did it that way?

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From thomas@biostat.washington.edu  Fri Apr  7 17:57:41 2000
From: thomas@biostat.washington.edu (thomas@biostat.washington.edu)
Date: Fri, 7 Apr 2000 18:57:41 +0200 (MET DST)
Subject: [Rd] Bug in qbinom? (PR#511)
Message-ID: <200004071657.SAA14316@pubhealth.ku.dk>


I've committed a fix to the development branch.  We now start searching at 
max(0,min(n,normal-approximation))

We still don't get  qbinom(pbinom(x,100,0.5))==x for x>86, but that's to
be expected. 


Thomas Lumley
Assistant Professor, Biostatistics
University of Washington, Seattle


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From erich.neuwirth@univie.ac.at  Sat Apr  8 01:35:06 2000
From: erich.neuwirth@univie.ac.at (Erich Neuwirth)
Date: Sat, 08 Apr 2000 02:35:06 +0200
Subject: [Rd] cannot compile on solaris
References: <200004071651.RAA15284@toucan.stats.ox.ac.uk> <x2wvm93l05.fsf@blueberry.kubism.ku.dk>
Message-ID: <38EE7EBA.36942CA@univie.ac.at>

on my old sun ipx with gcc and texinfo installed 
u run ./configure ok, and then i get

[szego@neuwirth:/install/R-1.0.0] make
make[1]: Entering directory `/install/R-1.0.0/tools'
make[1]: Nothing to be done for `R'.
make[1]: Leaving directory `/install/R-1.0.0/tools'
make[1]: Entering directory `/install/R-1.0.0/afm'
make[1]: Leaving directory `/install/R-1.0.0/afm'
make[1]: Entering directory `/install/R-1.0.0/doc'
false: false: cannot open
make[1]: *** [R] Error 1
make[1]: Leaving directory `/install/R-1.0.0/doc'
make: *** [R] Error 1

what is happening?
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ihaka@stat.auckland.ac.nz  Sat Apr  8 02:38:41 2000
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Sat, 8 Apr 2000 13:38:41 +1200
Subject: [Rd] Re: [R] MetaPost device?
In-Reply-To: <87d7o2hsi8.fsf@bavaria.ece.cmu.edu>; from Thomas J Vogels on Fri, Apr 07, 2000 at 10:53:35AM -0400
References: <005501bf9fd8$2697d420$9570fe8c@lucent.com> <x2ya6r2qea.fsf@blueberry.kubism.ku.dk> <20000406182908.A19743@sirio.stat.unipd.it> <20000407100231.A2998@stat1.stat.auckland.ac.nz> <87d7o2hsi8.fsf@bavaria.ece.cmu.edu>
Message-ID: <20000408133841.B1234@stat1.stat.auckland.ac.nz>

On Fri, Apr 07, 2000 at 10:53:35AM -0400, Thomas J Vogels wrote:
> 
> Ross Ihaka <ihaka@stat.auckland.ac.nz> writes:
> 
> > On Thu, Apr 06, 2000 at 06:29:08PM +0200, Guido Masarotto wrote:
> > 
> > >   The problem with MetaPost (if I understand well) is how
> > >   you do get metric information about the fonts. 
> > 
> > The metric info problem is what stoped me writing the XFig driver.
> > Which metrics do you use for Times-Roman for example -- the X11 metrics
> > or the PostScript metrics?
> 
> I'll be sorry for this naive question, but if you limited the fonts
> in the FIG output to LaTeX fonts, couldn't you use the LaTeX font
> information?  (This doesn't solve the problem that what you see in an
> X11 device is not what you get with dev.print which may or may not be
> a good thing.)

This is supposing that you can get get access to it.  I certainly don't
know enough about TeX to be able to parse tfm files.  If code existed to
compute the dimensions of strings then we'd be away.

Another problem the text output by TeX can be rather richly structured
-- kerning and glue come to mind.  I think a general solution might
require either writing a version of the TeX layout code for R, or running
TeX to compute metric information whenever a string is placed in a plot
(hmmmm actually this last might just be workable - if a little slow).

	Ross
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Sat Apr  8 08:05:26 2000
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Sat, 8 Apr 2000 08:05:26 +0100 (BST)
Subject: xfig device (was [Rd] Re: [R] MetaPost device?)
In-Reply-To: <20000408133841.B1234@stat1.stat.auckland.ac.nz>
Message-ID: <Pine.GSO.4.05.10004080721170.7242-100000@auk.stats>

On Sat, 8 Apr 2000, Ross Ihaka wrote:

> On Fri, Apr 07, 2000 at 10:53:35AM -0400, Thomas J Vogels wrote:
> > 
> > Ross Ihaka <ihaka@stat.auckland.ac.nz> writes:
> > 
> > > On Thu, Apr 06, 2000 at 06:29:08PM +0200, Guido Masarotto wrote:
> > > 
> > > >   The problem with MetaPost (if I understand well) is how
> > > >   you do get metric information about the fonts. 
> > > 
> > > The metric info problem is what stoped me writing the XFig driver.
> > > Which metrics do you use for Times-Roman for example -- the X11 metrics
> > > or the PostScript metrics?
> > 
> > I'll be sorry for this naive question, but if you limited the fonts
> > in the FIG output to LaTeX fonts, couldn't you use the LaTeX font
> > information?  (This doesn't solve the problem that what you see in an
> > X11 device is not what you get with dev.print which may or may not be
> > a good thing.)
> 
> This is supposing that you can get get access to it.  I certainly don't
> know enough about TeX to be able to parse tfm files.  If code existed to
> compute the dimensions of strings then we'd be away.

AFAIR no problem: many dvixx drivers such as dvips compute string widths at
least.  In dvips bbox.c computes the bounding box for a dvi file, and
thereby computes BB info for each string. In doing so it computes from the
tfm the llx,lly,urx,ury for each character.

However, I would be inclined to go the other way, and just use the
PostScript fonts and their metrics.  For a start, the X11 metrics are I
believe device-specific, and I would view xfig screen output as an
approximation to the final printed form. And it is that final form I want
to be accurate.

> Another problem the text output by TeX can be rather richly structured
> -- kerning and glue come to mind.
 
Are we not just discussing a xfig driver for R, and R's driver model only
writes single text strings at specified (x,y) locations?  So test output
from an R xfig driver would not be richly structured?  Yes, there is
kerning but there is using postscript fonts directly, surely?
By the time a dvixx driver is reading the dvi file the kerning has been
done, but the information is all there in the tfm, and the format is
readily available (e.g. in tftopl).

Brian

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Sat Apr  8 08:24:43 2000
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Sat, 8 Apr 2000 08:24:43 +0100 (BST)
Subject: [Rd] cannot compile on solaris
In-Reply-To: <38EE7EBA.36942CA@univie.ac.at>
Message-ID: <Pine.GSO.4.05.10004080813230.7242-100000@auk.stats>

On Sat, 8 Apr 2000, Erich Neuwirth wrote:

> on my old sun ipx with gcc and texinfo installed 
> u run ./configure ok, and then i get
> 
> [szego@neuwirth:/install/R-1.0.0] make
> make[1]: Entering directory `/install/R-1.0.0/tools'
> make[1]: Nothing to be done for `R'.
> make[1]: Leaving directory `/install/R-1.0.0/tools'
> make[1]: Entering directory `/install/R-1.0.0/afm'
> make[1]: Leaving directory `/install/R-1.0.0/afm'
> make[1]: Entering directory `/install/R-1.0.0/doc'
> false: false: cannot open
> make[1]: *** [R] Error 1
> make[1]: Leaving directory `/install/R-1.0.0/doc'
> make: *** [R] Error 1
> 
> what is happening?

false should be in /usr/bin/false:
auk% which false
/usr/bin/false
auk% ls -l `which false`
-r-xr-xr-x   1 bin      bin           314 Jul 16  1997 /usr/bin/false*

It is not clear from your output what this is trying to do: I get
auk% make -n R
/opt/R/cvs/R/tools/mkinstalldirs ../doc/html/search
cat /opt/R/cvs/R/doc/html/search/SearchEngine-head.html > \
  ../doc/html/search/SearchEngine.html
../tools/keywords2html /opt/R/cvs/R/doc/KEYWORDS.db >> \
  ../doc/html/search/SearchEngine.html
cat /opt/R/cvs/R/doc/html/search/SearchEngine-foot.html >> \
  ../doc/html/search/SearchEngine.html
if [ "/opt/R/cvs/R/doc" != "." ]; then \
  make rhome=.. install-html; \
  (cd manual && make R); \
fi
echo "installing doc ..."
...

so one of these is failing (and I think not the if clause as that should
echo something). Can you do the same and track down what has not been
created?


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Sat Apr  8 09:31:48 2000
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Sat, 8 Apr 2000 09:31:48 +0100 (BST)
Subject: [Rd] window(): feature request
In-Reply-To: <3.0.6.32.20000403182113.008f1bf0@fgr.wu-wien.ac.at>
Message-ID: <Pine.GSO.4.05.10004080927380.8001-100000@auk.stats>

On Mon, 3 Apr 2000, Wolfgang Koller wrote:

> Dear R-developpers,
> 
> currently the function window shows the following behaviour, if start or
> end is out of range:
> 
> > x <- ts(1:14,start=c(1950,2),frequency=4)
> > y <- window(x,start=c(1950,1),end=c(1953,4))
> Warning messages: 
> 1: start value not changed in: window.default(x, ...) 
> 2: end value not changed in: window.default(x, ...) 
> 
> Instead of this I would like it to fill with NAs the values before start(x)
> and after end(x). Could this be done by introducing an additional option in
> window()? Could you please consider this in future releases? Or is there a
> better way to do this using existing functions?

This is incompatible with S and the existing behaviour, so I have added a
new argument `extend' defaulting to FALSE. The new version is in the
R-devel distribution, so will not appear in a released version until 1.1.0.

> P.S.: Below I have added some code that accomplishes this aim in a separate
> function (which is probably an example of akward programming...).

[It does not handle matrix ts objects, for example, nor does it handle
changing the frequency.]

[code snipped.]

PS: R-bugs now has a `wishlist' section, so sending a feature request as a
bug report is a way to ensure it gets recorded.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Sat Apr  8 09:38:18 2000
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 08 Apr 2000 10:38:18 +0200
Subject: xfig device (was [Rd] Re: [R] MetaPost device?)
In-Reply-To: Prof Brian D Ripley's message of "Sat, 8 Apr 2000 08:05:26 +0100 (BST)"
References: <Pine.GSO.4.05.10004080721170.7242-100000@auk.stats>
Message-ID: <x2em8hyolh.fsf@blueberry.kubism.ku.dk>

Prof Brian D Ripley <ripley@stats.ox.ac.uk> writes:

> Are we not just discussing a xfig driver for R, and R's driver model only
> writes single text strings at specified (x,y) locations?  So test output
> from an R xfig driver would not be richly structured?  Yes, there is
> kerning but there is using postscript fonts directly, surely?
> By the time a dvixx driver is reading the dvi file the kerning has been
> done, but the information is all there in the tfm, and the format is
> readily available (e.g. in tftopl).

But what about plotmath? If we want to get the equivalent of
\alpha*\text{threshold}_i (say) to come out right then we need to know
the length of "threshold" in the relevant font... Of course you could
(potentially) get the driver to output actual TeX, but then you have
no inkling about the total size of the formula object, and it comes
out as TeX code inside XFig. Xfig is pretty much geared towards
postscript fonts, so I suppose the most practical thing to do is to
assume PS as the final target and accept the approximations caused by
the screen fonts while previewing. 

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Sat Apr  8 09:42:37 2000
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Sat, 8 Apr 2000 09:42:37 +0100 (BST)
Subject: [Rd] Strange behaviour of image (PR#510)
In-Reply-To: <200004071651.RAA15284@toucan.stats.ox.ac.uk>
Message-ID: <Pine.GSO.4.05.10004080932360.8001-100000@auk.stats>

On Fri, 7 Apr 2000, Prof Brian Ripley wrote:

> 
> > Date: Fri, 7 Apr 2000 17:04:17 +0100 (BST)
> > From: Jonathan Rougier <J.C.Rougier@durham.ac.uk>
> > 
> > Hi Peter,
> > 
> > On 6 Apr 2000, Peter Dalgaard BSA wrote:
> > 
> > > J.C.Rougier@durham.ac.uk writes:
> > > 
> > > > The following commands
> > > > 
> > > > z <- matrix(seq(0, 1, len=1000))
> > > > image(z, 1, z, zlim=c(0, 1), col=gray(1:10/10))
> > > > 
> > > > appear to violate the image functionality as described on the
> > > > help page.  As I understand it, by specifying a zlim of c(0, 1)
> > > > and a colour vector of length 10, the colours should correspond
> > > > to the intervals (0, 0.1), (0.1, 0.2), ..., (0.9, 1.0), this
> > > > being 10 equally-spaced intervals on (0, 1).  It is clear from
> > > > the image that this has not occurred.  In fact the intervals are
> > > > apparently (0, 1/18), (1/18, 3/18), ..., (15/18, 17/18), (17/18,
> > > > 1).  Have I misunderstood something?
> > > 
> > > I don't see that anything else is being promised...
> > > 
> > > If someone actually thought about this, then the choice might be
> > > related to the behavior at peaks and troughs. (since a circle with
> > > radius r looks wide compared to the region between two circles with
> > > diameter n*r and (n+1)*r)
> > 
> > I'm not quite sure I follow.  My feeling is that the displayed behaviour
> > of image is unreasonable, and, I hazard, not what most people who use
> > image expect.  I think the default behaviour of image should be to give
> > colour bands of equal widths, and, if I may append to the wish list, I
> > woud like to be able to specify a "breaks" argument to have unequal widths
> > should I so choose.
> 
> I side with Jonathan.
> 
> (1) The prototype does as JCR describes: given 64 colours it allocates
> 1/64th of the space to each.
> 
> (2) Setting the break points seems a good idea to me (but can always be
> faked by a non-linear monotonic transformation of z, as I have done
> before now).
> 
> I suggest we do add a `breaks' arg and that we do change the default
> at the level of the R code, perhaps with an oldstyle parameter.
> OK?

Now done for R-devel. The new version computes the indices into the colour
table in the R code so is much easier to customize.

help(image) did say

    zlim: the minimum and maximum `z' values for which colors will be
          plotted.  Each of the given colors will be used to color an
          equispaced interval of this range.

and what happened was that the midpoints of the colour grid covered the
range, so the lowest and highest z values which were plotted were smaller
and larger than as specified here.  I've altered the help file for 1.0.1.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Sat Apr  8 10:08:40 2000
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Sat, 8 Apr 2000 10:08:40 +0100 (BST)
Subject: xfig device (was [Rd] Re: [R] MetaPost device?)
In-Reply-To: <x2em8hyolh.fsf@blueberry.kubism.ku.dk>
Message-ID: <Pine.GSO.4.05.10004080943340.8001-100000@auk.stats>

On 8 Apr 2000, Peter Dalgaard BSA wrote:

> Prof Brian D Ripley <ripley@stats.ox.ac.uk> writes:
> 
> > Are we not just discussing a xfig driver for R, and R's driver model only
> > writes single text strings at specified (x,y) locations?  So test output
> > from an R xfig driver would not be richly structured?  Yes, there is
> > kerning but there is using postscript fonts directly, surely?
> > By the time a dvixx driver is reading the dvi file the kerning has been
> > done, but the information is all there in the tfm, and the format is
> > readily available (e.g. in tftopl).
> 
> But what about plotmath? If we want to get the equivalent of
> \alpha*\text{threshold}_i (say) to come out right then we need to know
> the length of "threshold" in the relevant font... Of course you could

Do you mean *width* of "threshold"?  That's exactly what I was envisaging.
Even to plot "threshold" centred you need to know its width and height and
depth: see GText.

As I understand it plotmath computes the locations of the pieces ("alpha"
and "threshold" and "i" in the example) and outputs them as separate
strings.  And as far as I can see plotmath does not use kerning information
(look at RenderStr in plotmath.c) to find the string's bounding box, even
though the postscript renderer will.  Similar, the GStrWidth for the 
postscript device just adds up the character widths and so ignores kerning.

> (potentially) get the driver to output actual TeX, but then you have
> no inkling about the total size of the formula object, and it comes
> out as TeX code inside XFig. Xfig is pretty much geared towards
> postscript fonts, so I suppose the most practical thing to do is to
> assume PS as the final target and accept the approximations caused by
> the screen fonts while previewing. 

I think I said that in part of my posting which you omitted!


Summary: 

R currently seems to ignore kerning in computing string dimensions.

Finding char info from tfm files is easy: there is lots of example code.

For an xfig device one could (at least initially) use the existing 
information on postscript fonts, and only allow those to be used in the
device.  I think the same applies to a metapost device.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Sat Apr  8 10:37:19 2000
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 08 Apr 2000 11:37:19 +0200
Subject: xfig device (was [Rd] Re: [R] MetaPost device?)
In-Reply-To: Prof Brian D Ripley's message of "Sat, 8 Apr 2000 10:08:40 +0100 (BST)"
References: <Pine.GSO.4.05.10004080943340.8001-100000@auk.stats>
Message-ID: <x2r9chhr1s.fsf@blueberry.kubism.ku.dk>

Prof Brian D Ripley <ripley@stats.ox.ac.uk> writes:

> > the length of "threshold" in the relevant font... Of course you could
> 
> Do you mean *width* of "threshold"?  

Um, yes. The *length* is 9, I suppose.

> > (potentially) get the driver to output actual TeX, but then you have
> > no inkling about the total size of the formula object, and it comes
> > out as TeX code inside XFig. Xfig is pretty much geared towards
> > postscript fonts, so I suppose the most practical thing to do is to
> > assume PS as the final target and accept the approximations caused by
> > the screen fonts while previewing. 
> 
> I think I said that in part of my posting which you omitted!

So you did. (I must have woken up too early today...) What I forgot to
add was something to the effect that as long as you keep formulas as
"compound objects" in XFig then it shouldn't be a major obstacle to
moving the labels around.

> R currently seems to ignore kerning in computing string dimensions.

..which we should probably fix at some point. Can't be that hard?
(BTW, I forget whether Postscript itself does kerning by default or
one has to use a special string operator to obtain it?)

Also, I suspect that some of the finer points of the Appendix G of the
TeXbook are getting lost -- the micro-spacing in formulas appear to be
not quite right.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Sat Apr  8 11:31:15 2000
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Sat, 8 Apr 2000 11:31:15 +0100 (BST)
Subject: [Rd] x11 colortype problems ('gray' is broken?) (PR#512)
In-Reply-To: <200004071553.RAA13862@pubhealth.ku.dk>
Message-ID: <Pine.GSO.4.05.10004081123590.6335-100000@auk.stats>

On Fri, 7 Apr 2000 tov@ece.cmu.edu wrote:

> 
> Hi,
> 
>   I occasionally run out of color in my X11 terminal.  At this
> point, R will issue this error message:
>         Error: X11 cannot allocate additional graphics colors.
> Consider using colortype="pseudo.cube" or "gray".
> 
> An immediate x11(colortype="pseudo.cube") doesn't work as the
> colortype seems to be shared among the different x11 plotting windows.
> So I have to close all windows first, then I can open an x11 device
> with the colortype "pseudo.cube".  (Neither the necessity to close all
> windows nor the fact, that colortype is an option to X11 and not to
> the plot command, is clear from the help pages or the error message.)

There is a single colortype shared by all x11 devices.  That couild eb
clearer!

> The real problem, however, comes with x11(colortype="gray") as this
> brings up just a black screen (and it stays black).  I can't quite see
> whether I'm stumbling across some issues with X resources, here.
> x11() usually gives a white background.

No. It's a bug.  When you set x11(colortype="gray") it tries to allocate
min(256, 2^depth) colours, that is all the colours on an 8-bit display.
That is clearly going to fail (unless perhaps your window manager is 
in mono).  So it does fail, set PaletteSize = 0, and then maps all
colours to black.  That's what the x11 driver seems to do when colour
allocation fails.  I suspect it should not open at all under those 
circumstances.

Quick fix:

static void SetupGrayScale()
{
    PaletteSize = 0;
    if (depth > 7)
	depth = 7;
    if (GetGrayPalette(display, colormap, 1 << depth) == 0)
	depth = 1;
}

(8 replaced by 7) in devX11.c.  I'll commit a more sophisticated one
to R-release.


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From erich.neuwirth@univie.ac.at  Sun Apr  9 10:23:26 2000
From: erich.neuwirth@univie.ac.at (Erich Neuwirth)
Date: Sun, 09 Apr 2000 11:23:26 +0200
Subject: [Rd] cannot compile on solaris
References: <Pine.GSO.4.05.10004080813230.7242-100000@auk.stats>
Message-ID: <38F04C0E.859AA7E8@univie.ac.at>

mystery solved.
the machine did not have perl installed.
BUT
probably there should be a more informative warning message,
and perhaps configure should complain more audibly.


Prof Brian D Ripley wrote:
> 
> On Sat, 8 Apr 2000, Erich Neuwirth wrote:
> 
> > on my old sun ipx with gcc and texinfo installed
> > u run ./configure ok, and then i get
> >
> > [szego@neuwirth:/install/R-1.0.0] make
> > make[1]: Entering directory `/install/R-1.0.0/tools'
> > make[1]: Nothing to be done for `R'.
> > make[1]: Leaving directory `/install/R-1.0.0/tools'
> > make[1]: Entering directory `/install/R-1.0.0/afm'
> > make[1]: Leaving directory `/install/R-1.0.0/afm'
> > make[1]: Entering directory `/install/R-1.0.0/doc'
> > false: false: cannot open
> > make[1]: *** [R] Error 1
> > make[1]: Leaving directory `/install/R-1.0.0/doc'
> > make: *** [R] Error 1
> >
> > what is happening?
> 
> false should be in /usr/bin/false:
> auk% which false
> /usr/bin/false
> auk% ls -l `which false`
> -r-xr-xr-x   1 bin      bin           314 Jul 16  1997 /usr/bin/false*
> 
> It is not clear from your output what this is trying to do: I get
> auk% make -n R
> /opt/R/cvs/R/tools/mkinstalldirs ../doc/html/search
> cat /opt/R/cvs/R/doc/html/search/SearchEngine-head.html > \
>   ../doc/html/search/SearchEngine.html
> ../tools/keywords2html /opt/R/cvs/R/doc/KEYWORDS.db >> \
>   ../doc/html/search/SearchEngine.html
> cat /opt/R/cvs/R/doc/html/search/SearchEngine-foot.html >> \
>   ../doc/html/search/SearchEngine.html
> if [ "/opt/R/cvs/R/doc" != "." ]; then \
>   make rhome=.. install-html; \
>   (cd manual && make R); \
> fi
> echo "installing doc ..."
> ...
> 
> so one of these is failing (and I think not the if clause as that should
> echo something). Can you do the same and track down what has not been
> created?
> 
> --
> Brian D. Ripley,                  ripley@stats.ox.ac.uk
> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> University of Oxford,             Tel:  +44 1865 272861 (self)
> 1 South Parks Road,                     +44 1865 272860 (secr)
> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
> 
> -.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
> r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
> Send "info", "help", or "[un]subscribe"
> (in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
> _._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Mon Apr 10 06:46:39 2000
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 10 Apr 2000 07:46:39 +0200
Subject: [Rd] R CMD build/check
Message-ID: <200004100546.HAA14716@aragorn.ci.tuwien.ac.at>

I would like to bring the attention of R package maintainers/developers
to the mechanisms for checking and building add-on packages that come
with the R distribution.

* R CMD check has been around for a while.  It can be used for run-time
testing the examples that come with an installed add-on package.  Recent
development versions of R also have preliminary support for additional
specific regression testing.

* R CMD build should be used for actually building the add-on packages,
in particular if you are planning to upload them to CRAN.  From the R
Extension Writers Guide:

	Prior to actually building the package in the common gzipped tar
	file format, a variety of diagnostic checks and cleanups are
	performed.  In particular, it is tested whether the
	`DESCRIPTION' file contains the required entries, whether object
	and data indices exist and can be assumed to be up-to-date,
	whether the documentation sources contain the required name,
	alias, title, description, and keyword information, and whether
	there are any undocumented user level objects.

Please try to eliminate all problems reported by the R package builder
before submitting a package to CRAN.

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Mon Apr 10 09:41:48 2000
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Mon, 10 Apr 2000 10:41:48 +0200 (CEST)
Subject: [Rd] R CMD build/check
In-Reply-To: <200004100546.HAA14716@aragorn.ci.tuwien.ac.at>
References: <200004100546.HAA14716@aragorn.ci.tuwien.ac.at>
Message-ID: <14577.37836.184592.123670@lynne.ethz.ch>

>>>>> "KH" == Kurt Hornik <hornik@ci.tuwien.ac.at> writes:

    KH> I would like to bring the attention of R package maintainers/developers
    KH> to the mechanisms for checking and building add-on packages that come
    KH> with the R distribution.

    KH> * R CMD check has been around for a while.  It can be used for run-time
    KH> testing the examples that come with an installed add-on package.  Recent
    KH> development versions of R also have preliminary support for additional
    KH> specific regression testing.

    KH> * R CMD build should be used for actually building the add-on packages,
    KH> in particular if you are planning to upload them to CRAN.  From the R
    KH> Extension Writers Guide:

    KH> Prior to actually building the package in the common gzipped tar
    KH> file format, a variety of diagnostic checks and cleanups are
    KH> performed.  In particular, it is tested whether the
    KH> `DESCRIPTION' file contains the required entries, whether object
    KH> and data indices exist and can be assumed to be up-to-date,
    KH> whether the documentation sources contain the required name,
    KH> alias, title, description, and keyword information, and whether
    KH> there are any undocumented user level objects.

    KH> Please try to eliminate all problems reported by the R package builder
    KH> before submitting a package to CRAN.

The "data index" is mentioned in the R Extensions Writer guide as
>> The subdirectory should contain a `00Index' file
>> that describes the datasets available.

Now since this is now required,  
what is the format of that file? what must/should it contain?
Shouldn't this be built automatically from the data's *.Rd files when it
doesn't exist?

Thanks for any clarification; the requirement of this 00Index has been new
for me (must have slept at some time in the past...).

Martin.
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Mon Apr 10 14:25:52 2000
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Mon, 10 Apr 2000 09:25:52 -0400
Subject: [Rd] 00Index of data
Message-ID: <38F1D65F.F70F0FFF@bank-banque-canada.ca>

The "data index" is mentioned in the R Extensions Writer guide as
>> The subdirectory should contain a `00Index' file
>> that describes the datasets available.

I'm not sure what the official format is suppose to be, but given that
it displays like an index, this has to be a very short description which
I find somewhat inadequate. Some of my data sets are multivariate time
series and it is impossible to describe them in such a brief format, so
I have resorted to very poor descriptions like "data used in ...".  It
would be nice to have a facility to give a more complete description of
the data.

Paul Gilbert

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Prof Brian Ripley <ripley@stats.ox.ac.uk>  Mon Apr 10 14:33:10 2000
From: Prof Brian Ripley <ripley@stats.ox.ac.uk> (Prof Brian Ripley)
Date: Mon, 10 Apr 2000 14:33:10 +0100 (BST)
Subject: [Rd] 00Index of data
Message-ID: <200004101333.OAA22020@toucan.stats.ox.ac.uk>


> Date: Mon, 10 Apr 2000 09:25:52 -0400
> From: Paul Gilbert <pgilbert@bank-banque-canada.ca>
> To: r-devel <r-devel@stat.math.ethz.ch>
> Subject: [Rd] 00Index of data
> 
> The "data index" is mentioned in the R Extensions Writer guide as
> >> The subdirectory should contain a `00Index' file
> >> that describes the datasets available.
> 
> I'm not sure what the official format is suppose to be, but given that
> it displays like an index, this has to be a very short description which
> I find somewhat inadequate. Some of my data sets are multivariate time
> series and it is impossible to describe them in such a brief format, so
> I have resorted to very poor descriptions like "data used in ...".  It
> would be nice to have a facility to give a more complete description of
> the data.

There is no restriction on the format.  The only use is with data()
to show what is available. But a few lines should suffice to 
indicate if it is worth looking up the help page for the data.
(And that needs a one-line title.)

The same comments apply to the INDEX file: you can let build
generate it, but several packages have hand-customised files (e.g.boot).

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Mon Apr 10 15:25:41 2000
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Mon, 10 Apr 2000 10:25:41 -0400
Subject: [Rd] 00Index of data
References: <200004101333.OAA22020@toucan.stats.ox.ac.uk>
Message-ID: <38F1E464.C7976425@bank-banque-canada.ca>

>the help page for the data.

Now that's something I didn't know about but is probably documented
somewhere that I missed. (No wonder I found the index rather
restrictive.) I now see it is reported as missing documentation by R CMD
build. (It is buried by all the other warnings.) I guess it should just
be an Rd file like the function help. Does a link get automatically
built from the 00Index of the data to the help for data or do I need to
point readers to the help? Or will the 00Index of the data get built
automatically from the titles in the data help files in the same way
that the function index is built? (And if so, how does it know the
documentation is for data?)

Thanks,
Paul Gilbert

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Prof Brian Ripley <ripley@stats.ox.ac.uk>  Mon Apr 10 15:31:49 2000
From: Prof Brian Ripley <ripley@stats.ox.ac.uk> (Prof Brian Ripley)
Date: Mon, 10 Apr 2000 15:31:49 +0100 (BST)
Subject: [Rd] 00Index of data
Message-ID: <200004101431.PAA22511@toucan.stats.ox.ac.uk>


> Date: Mon, 10 Apr 2000 10:25:41 -0400
> From: Paul Gilbert <pgilbert@bank-banque-canada.ca>
> To: Prof Brian Ripley <ripley@stats.ox.ac.uk>
> CC: r-devel@stat.math.ethz.ch
> Subject: Re: [Rd] 00Index of data
> 
> >the help page for the data.
> 
> Now that's something I didn't know about but is probably documented
> somewhere that I missed. (No wonder I found the index rather
> restrictive.) I now see it is reported as missing documentation by R CMD
> build. (It is buried by all the other warnings.) I guess it should just

When you solve all the others it will emerge more clearly :)

> be an Rd file like the function help. 

Yes, and `Writing R Extensions' tells you about making help files for data.
And the base system has them. (So does S-PLUS!)

> Does a link get automatically
> built from the 00Index of the data to the help for data or do I need to
> point readers to the help?

Readers are supposed to know to look for help on R *objects* (not
just functions).  Even the help.start intro says `Functions & Datasets'

>  Or will the 00Index of the data get built
> automatically from the titles in the data help files in the same way
> that the function index is built? (And if so, how does it know the
> documentation is for data?)

It does not get built, and help for data goes in INDEX. (That is
one reason why some of us prefer hand-crafted INDEX files.)
We are moving towards a way to distinguish the object type in a help file,
but are not there yet.


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Mon Apr 10 16:32:28 2000
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Mon, 10 Apr 2000 11:32:28 -0400
Subject: [Rd] R CMD build/check
References: <200004100546.HAA14716@aragorn.ci.tuwien.ac.at>
Message-ID: <38F1F40B.56C0A7B@bank-banque-canada.ca>

Let me start out by saying that after using "R CMD build" for a few days
it appears to be a truely wonderful facility, even if I didn't really
want to know about all the problems with my packages right now.

>Please try to eliminate all problems reported by the R package builder
>before submitting a package to CRAN.

Now here are a few caveates. Please let me know if  I'm not aware of
something that has already been fixed.

1/ I'm using a file 00General_Description.Rd to provide a general
description of the package. This gets reported as an Rd file without
alias, but even though the package builder reports that as a problem I
didn't intend to eliminate it.

2/ Specific methods get reported as undocumented functions unless the
generic documentation has an alias line for the specific method. This is
not a problem when everything is in one package, however, for many of my
specific methods  the generic method is in another of my packages or in
the base. (This can generate a lot of warning, which obscure more
important warnings.) I'm putting a "stub" description in to eliminate
all the warnings, but I'm not sure if this is the ideal way to do this.

3/ Data sets cannot use constructors in the package. They need to be
structures which can be fully recognized by the base system. (.rda files
may be a better alternative in this case?)

4/ R CMD build does not work for bundles, but it can be used to test
sub-packages and then the bundle rolled up afterwards directly with tar
and gzip. (This is not difficult and not a problem, but people should be
aware of it.)

Paul Gilbert

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Mon Apr 10 21:25:45 2000
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Mon, 10 Apr 2000 16:25:45 -0400
Subject: [Rd] 2 \alias{obj}
Message-ID: <38F238C8.DC36720B@bank-banque-canada.ca>

R CMD build does not seems to complain about an alias for the same
object in two different .Rd files. Should that be allowed? I don't see
when it would be legitimate.  (And I didn't intend to do this and would
have expected for a warning.)

Paul Gilbert

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Mon Apr 10 21:30:37 2000
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Mon, 10 Apr 2000 21:30:37 +0100 (BST)
Subject: [Rd] 2 \alias{obj}
In-Reply-To: <38F238C8.DC36720B@bank-banque-canada.ca>
Message-ID: <Pine.GSO.4.05.10004102128170.24235-100000@auk.stats>

On Mon, 10 Apr 2000, Paul Gilbert wrote:

> R CMD build does not seems to complain about an alias for the same
> object in two different .Rd files. Should that be allowed? I don't see
> when it would be legitimate.  (And I didn't intend to do this and would
> have expected for a warning.)

If you mean in the same package, just installing will object. (As with
survreg.old in survival5, Thomas.)  If in different packages, no ban!

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From telford@progsoc.uts.edu.au  Tue Apr 11 02:32:15 2000
From: telford@progsoc.uts.edu.au (Telford Tendys)
Date: Tue, 11 Apr 2000 11:32:15 +1000
Subject: xfig device (was [Rd] Re: [R] MetaPost device?)
In-Reply-To: <Pine.GSO.4.05.10004080943340.8001-100000@auk.stats>; from ripley@stats.ox.ac.uk on Sat, Apr 08, 2000 at 10:08:40AM +0100
References: <x2em8hyolh.fsf@blueberry.kubism.ku.dk> <Pine.GSO.4.05.10004080943340.8001-100000@auk.stats>
Message-ID: <20000411113215.E7411@ftoomsh.progsoc.uts.edu.au>

> Even to plot "threshold" centred you need to know its width and height and
> depth: see GText.

In xfig you can choose for a string to be centered and then give it
the string and the centre-point and it figures out the rest, it also
outputs this correctly centred despite font variations.

Admittedly, just being able to centre-justify a string doesn't solve
the problem of plotting an equation but it might help in a few cases...

Also, there is a ghostscript operator for getting the width of a string:

stringwidth

     * USAGE:   str stringwidth
     * RESULTS   x y

     calculates the change in the current point which would occur using
     "show", but doesn't actually draw the string
  
[http://www.colorado.edu/ITS/docs/scientific/gs/GSO.html]

Running up gs in the background in order to do font calculations
seems a bit messy but it would be easy to achieve and it kind of fits
with the unix philosophy of each program does it's own job well and
doesn't try to overlap its neighbour. Maybe it is fair to presume that
the win-32 users don't want xfig output? They probably want ms-draw or
something...

> As I understand it plotmath computes the locations of the pieces ("alpha"
> and "threshold" and "i" in the example) and outputs them as separate
> strings.  And as far as I can see plotmath does not use kerning information
> (look at RenderStr in plotmath.c) to find the string's bounding box, even
> though the postscript renderer will.  Similar, the GStrWidth for the 
> postscript device just adds up the character widths and so ignores kerning.

Yeah, I've noticed that some of the R outputs don't look quite as good as
latex but they still look better than just about any other plotter. Sometimes
I get latex to splat the formulas down onto the diagrams which is a dirty
trick but the reader of the printed copy only sees the end result not the
method.

> Finding char info from tfm files is easy: there is lots of example code.
> 
> For an xfig device one could (at least initially) use the existing 
> information on postscript fonts, and only allow those to be used in the
> device.  I think the same applies to a metapost device.

Which would make the xfig-device depend on having tex installed which seems
kind of illogical but no worse than insisting that gs in installed. Most
people who use xfig also use both tex and gs. Perhaps R could look around
for tfm files, use them if it finds them, and resort to counting the
characters if it can't think of anything better to do (i.e. some output
with small kerning errors is better than no output at all).

	- Tel
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Tue Apr 11 07:25:50 2000
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Tue, 11 Apr 2000 07:25:50 +0100 (BST)
Subject: xfig device (was [Rd] Re: [R] MetaPost device?)
In-Reply-To: <20000411113215.E7411@ftoomsh.progsoc.uts.edu.au>
Message-ID: <Pine.GSO.4.05.10004110718120.4502-100000@auk.stats>

On Tue, 11 Apr 2000, Telford Tendys wrote:

> > Even to plot "threshold" centred you need to know its width and height and
> > depth: see GText.
> 
> In xfig you can choose for a string to be centered and then give it
> the string and the centre-point and it figures out the rest, it also
> outputs this correctly centred despite font variations.

Eh?  R allows proportional centring (adj can be between 0 and 1) and my
point was that the R driver model *requires* the knowledge. As I said, see
the code for GText.

> Admittedly, just being able to centre-justify a string doesn't solve
> the problem of plotting an equation but it might help in a few cases...
> 
> Also, there is a ghostscript operator for getting the width of a string:
> 
> stringwidth
> 
>      * USAGE:   str stringwidth
>      * RESULTS   x y
> 
>      calculates the change in the current point which would occur using
>      "show", but doesn't actually draw the string
>   
> [http://www.colorado.edu/ITS/docs/scientific/gs/GSO.html]
> 
> Running up gs in the background in order to do font calculations
> seems a bit messy but it would be easy to achieve and it kind of fits
> with the unix philosophy of each program does it's own job well and
> doesn't try to overlap its neighbour. Maybe it is fair to presume that
> the win-32 users don't want xfig output? They probably want ms-draw or
> something...

It's not fair, and they also want postscript and the code for this in
postscript is already internal to R (less kerning, it seems).

My point, which you seem to have missed, is that existing code for font
metric information could be used in an xfig driver.

> > As I understand it plotmath computes the locations of the pieces ("alpha"
> > and "threshold" and "i" in the example) and outputs them as separate
> > strings.  And as far as I can see plotmath does not use kerning information
> > (look at RenderStr in plotmath.c) to find the string's bounding box, even
> > though the postscript renderer will.  Similar, the GStrWidth for the 
> > postscript device just adds up the character widths and so ignores kerning.
> 
> Yeah, I've noticed that some of the R outputs don't look quite as good as
> latex but they still look better than just about any other plotter. Sometimes
> I get latex to splat the formulas down onto the diagrams which is a dirty
> trick but the reader of the printed copy only sees the end result not the
> method.
> 
> > Finding char info from tfm files is easy: there is lots of example code.
> > 
> > For an xfig device one could (at least initially) use the existing 
> > information on postscript fonts, and only allow those to be used in the
> > device.  I think the same applies to a metapost device.
> 
> Which would make the xfig-device depend on having tex installed which seems
> kind of illogical but no worse than insisting that gs in installed. Most
> people who use xfig also use both tex and gs. Perhaps R could look around
> for tfm files, use them if it finds them, and resort to counting the
> characters if it can't think of anything better to do (i.e. some output
> with small kerning errors is better than no output at all).

Eh? If we restrict to postscript fonts we can use the afms which we already
have. There would be no need for tex at all.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From telford@progsoc.uts.edu.au  Tue Apr 11 08:21:44 2000
From: telford@progsoc.uts.edu.au (Telford Tendys)
Date: Tue, 11 Apr 2000 17:21:44 +1000
Subject: xfig device (was [Rd] Re: [R] MetaPost device?)
In-Reply-To: <Pine.GSO.4.05.10004110718120.4502-100000@auk.stats>; from ripley@stats.ox.ac.uk on Tue, Apr 11, 2000 at 07:25:50AM +0100
References: <20000411113215.E7411@ftoomsh.progsoc.uts.edu.au> <Pine.GSO.4.05.10004110718120.4502-100000@auk.stats>
Message-ID: <20000411172144.A22534@ftoomsh.progsoc.uts.edu.au>

On Tue, Apr 11, 2000 at 07:25:50AM +0100, Prof Brian D Ripley wrote:
> On Tue, 11 Apr 2000, Telford Tendys wrote:
> 
> > > Even to plot "threshold" centred you need to know its width and height and
> > > depth: see GText.
> > 
> > In xfig you can choose for a string to be centered and then give it
> > the string and the centre-point and it figures out the rest, it also
> > outputs this correctly centred despite font variations.
> 
> Eh?  R allows proportional centring (adj can be between 0 and 1) and my
> point was that the R driver model *requires* the knowledge. As I said, see
> the code for GText.

Hmm, OK xfig only supports left, right and centre, and now I look closer
at the drivers I see that there is a slot for a string width function.
I also notice the PS driver supports the string width function by simply
summing up the character widths from the afm (see the PostScriptStringWidth
function in devPS.c).

So I agree, make the assumption that all xfig fonts are postscript fonts and
share code with the PS driver for string width.

There should be a fancier implementation of the string width calculation
inside the GNU ghostscript source somewhere. Since that is GPL code it
should be OK to paste into R (adapting it should not be too difficult),
this would include all kerning stuff and would guarantee compatability
between the R driver and the printout (if I remember rightly, gs is built
from lots and lots of little source files, each one implementing one function).

> My point, which you seem to have missed, is that existing code for font
> metric information could be used in an xfig driver.

Yup, I'm with you now.

	- Tel
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From plummer@iarc.fr  Tue Apr 11 11:23:24 2000
From: plummer@iarc.fr (plummer@iarc.fr)
Date: Tue, 11 Apr 2000 12:23:24 +0200 (MET DST)
Subject: [Rd] start.ts, end.ts (PR#513)
Message-ID: <200004111023.MAA11374@pubhealth.ku.dk>

I'm having trouble with column-subsetting a multivariate time
series.  The underlying problem is with start().

R> x <- ts(matrix(rnorm(100), ncol=2))
R> y <- aggregate(x, ndeltat=2)
R> y[,1]
Error in ts(y, start = start(x), freq = frequency(x)) :
        invalid start
R> start(y)
[1] 2 1
R> frequency(y)
[1] 0.5

The point where the error occurs in ts() is:

    if(length(start) > 1) {
        if(start[2] > frequency) stop("invalid start")
        ...

IMHO the 2-vector notation for the start and end of a time series makes
sense only when the frequency is an integer (and I believe I have said
this before). S-PLUS seems to follow this convention:

S> x <- ts(rnorm(10), start=3, frequency=1/3)
S> start(x)
[1] 3
S> end(x)
[1] 30
S> x <- ts(rnorm(10), start=1/3, frequency=3)
S> start(x)
[1] 0 2
S> end(x)
[1] 3 2

whereas R gives c(0,2) in both cases.

My suggested fix is to edit start.default and end.default, replacing

if(abs(is-round(is)) < ts.eps)

with

if(abs(tsp[3] - round(tsp[3])) < ts.eps && abs(is - round(is)) < ts.eps)

Martyn

--please do not edit the information below--

Version:
 platform = i686-unknown-linux
 arch = i686
 os = linux
 system = i686, linux
 status =
 major = 1
 minor = 0.0
 year = 2000
 month = February
 day = 29
 language = R

Search Path:
 .GlobalEnv, Autoloads, package:base



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From plummer@iarc.fr  Tue Apr 11 11:27:28 2000
From: plummer@iarc.fr (plummer@iarc.fr)
Date: Tue, 11 Apr 2000 12:27:28 +0200 (MET DST)
Subject: [Rd] aggregate.ts (PR#514)
Message-ID: <200004111027.MAA11464@pubhealth.ku.dk>

aggregate.ts does not behave in the same way as the equivalent
method aggregate.rts in S-PLUS. In particular it
- changes the start of the time series
- tends to have a length which is 1 shorter

For example:

R> x <- ts(1:10)
R> aggregate(x, nfreq=0.5, FUN=min)
Time Series:
Start = 2 
End = 8 
Frequency = 0.5 
[1] 2 4 6 8

S> x <- rts(1:10)
S> aggregate(x, nf=0.5, fun = min)
[1] 1 3 5 7 9
 start deltat frequency 
     1      2       0.5

I have edited the aggregate.ts function to reproduce the S-PLUS
behaviour, which I find more intuitive:

old:
    #nstart <- ceiling(tsp(x)[1] * nfrequency)/nfrequency
    #x <- as.matrix(window(x, start = nstart))
new:    
    nstart <- tsp(x)[1]
    # Can't use nstart <- start(x) as this causes problems if
    # you get a vector of length 2.
    x <- as.matrix(x)

I have tried this on a range of examples and have not encountered
any problems, but of course I may be missing something.

Martyn

--please do not edit the information below--

Version:
 platform = i686-unknown-linux
 arch = i686
 os = linux
 system = i686, linux
 status =
 major = 1
 minor = 0.0
 year = 2000
 month = February
 day = 29
 language = R

Search Path:
 .GlobalEnv, Autoloads, package:base

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Tue Apr 11 14:44:27 2000
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Tue, 11 Apr 2000 09:44:27 -0400
Subject: [Rd] 2 \alias{obj}
References: <Pine.GSO.4.05.10004102128170.24235-100000@auk.stats>
Message-ID: <38F32C3B.E25D17D8@bank-banque-canada.ca>

>> R CMD build does not seems to complain about an alias for the same
>> object in two different .Rd files. Should that be allowed? I don't see
>> when it would be legitimate.  (And I didn't intend to do this and would
>> have expected for a warning.)

>If you mean in the same package, just installing will object. (As with
>survreg.old in survival5, Thomas.)

Ok, thanks. I was just revising documentation and running R CMD build, not
re-installing. I see now that install gives a warning.

>If in different packages, no ban!

Is this considered a problem or are there situations were it really makes sense
(other than to perpetuate the problem of name space conflicts)?

Paul Gilbert



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Tue Apr 11 14:53:39 2000
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Tue, 11 Apr 2000 14:53:39 +0100 (BST)
Subject: [Rd] 2 \alias{obj}
In-Reply-To: <38F32C3B.E25D17D8@bank-banque-canada.ca>
Message-ID: <Pine.GSO.4.05.10004111450100.8685-100000@auk.stats>

On Tue, 11 Apr 2000, Paul Gilbert wrote:

> >> R CMD build does not seems to complain about an alias for the same
> >> object in two different .Rd files. Should that be allowed? I don't see
> >> when it would be legitimate.  (And I didn't intend to do this and would
> >> have expected for a warning.)
> 
> >If you mean in the same package, just installing will object. (As with
> >survreg.old in survival5, Thomas.)
> 
> Ok, thanks. I was just revising documentation and running R CMD build, not
> re-installing. I see now that install gives a warning.

Before the final build, we expect you to have

1) INSTALL-ed successfully
2) run R CMD check
3) run Rd2dvi on the man directory

and I guess this should be in the R-exts manual.

> >If in different packages, no ban!
> 
> Is this considered a problem or are there situations were it really makes sense
> (other than to perpetuate the problem of name space conflicts)?

Well, once upon a time package ts had enhanced versions of some of the 
functions in base, with enhanced docs too, and on S MASS has enhanced
versions of functions in base and survival5, with enhanced docs.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Tue Apr 11 17:08:09 2000
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 11 Apr 2000 18:08:09 +0200
Subject: [Rd] cannot compile on solaris
In-Reply-To: <38F04C0E.859AA7E8@univie.ac.at>
References: <Pine.GSO.4.05.10004080813230.7242-100000@auk.stats>
 <38F04C0E.859AA7E8@univie.ac.at>
Message-ID: <200004111608.SAA15146@aragorn.ci.tuwien.ac.at>

>>>>> Erich Neuwirth writes:

> mystery solved.  the machine did not have perl installed.  BUT
> probably there should be a more informative warning message, and
> perhaps configure should complain more audibly.

O.k., improved now.

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Wed Apr 12 07:24:05 2000
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 12 Apr 2000 08:24:05 +0200 (CEST)
Subject: [Rd] 00Index of data
In-Reply-To: <200004101431.PAA22511@toucan.stats.ox.ac.uk>
References: <200004101431.PAA22511@toucan.stats.ox.ac.uk>
Message-ID: <14580.5765.300868.265594@aragorn.ci.tuwien.ac.at>

>>>>> Prof Brian Ripley writes:

>> Date: Mon, 10 Apr 2000 10:25:41 -0400
>> From: Paul Gilbert <pgilbert@bank-banque-canada.ca>
>> To: Prof Brian Ripley <ripley@stats.ox.ac.uk>
>> CC: r-devel@stat.math.ethz.ch
>> Subject: Re: [Rd] 00Index of data
>> 
>> >the help page for the data.
>> 
>> Now that's something I didn't know about but is probably documented
>> somewhere that I missed. (No wonder I found the index rather
>> restrictive.) I now see it is reported as missing documentation by R CMD
>> build. (It is buried by all the other warnings.) I guess it should just

> When you solve all the others it will emerge more clearly :)

:-)

>> be an Rd file like the function help. 

> Yes, and `Writing R Extensions' tells you about making help files for
> data.  And the base system has them. (So does S-PLUS!)

>> Does a link get automatically
>> built from the 00Index of the data to the help for data or do I need to
>> point readers to the help?

> Readers are supposed to know to look for help on R *objects* (not just
> functions).  Even the help.start intro says `Functions & Datasets'

>> Or will the 00Index of the data get built
>> automatically from the titles in the data help files in the same way
>> that the function index is built? (And if so, how does it know the
>> documentation is for data?)

> It does not get built, and help for data goes in INDEX. (That is one
> reason why some of us prefer hand-crafted INDEX files.)  We are moving
> towards a way to distinguish the object type in a help file, but are
> not there yet.

Correction: R CMD build will try to build/update the documentation index
(`INDEX') as well as the data index (`data/00Index').  The latter, as I
think Paul expected, happens by taking the names of all Rd files that
contain the keyword `datasets' (which again shows how important it is to
eliminate all warnings about Rd files without keywords etc).

The problem is that package developers might register more (or less)
information in their INDEX than obtained via this procedure.  E.g., if
an Rd file documents more than one object, the alias mechanism ensures
that documentation for all objects is found, but it is not smart enough
to ensure that all objects documented get a corresponding index entry.

The solution would be to introduce something like

	\index{NAME}{DESCRIPTION}

lines in the Rd files, and in fact have the index built from these lines
exclusively rather than the names.  But first we must know what `NAME'
exactly should be here, e.g. whether we only want to list *OBJECTS* in
the index or *ALL* topics being documented.

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Wed Apr 12 07:29:38 2000
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 12 Apr 2000 08:29:38 +0200 (CEST)
Subject: [Rd] R CMD build/check
In-Reply-To: <38F1F40B.56C0A7B@bank-banque-canada.ca>
References: <200004100546.HAA14716@aragorn.ci.tuwien.ac.at>
 <38F1F40B.56C0A7B@bank-banque-canada.ca>
Message-ID: <14580.6098.971883.305959@aragorn.ci.tuwien.ac.at>

>>>>> Paul Gilbert writes:

> Let me start out by saying that after using "R CMD build" for a few days
> it appears to be a truely wonderful facility, even if I didn't really
> want to know about all the problems with my packages right now.

>> Please try to eliminate all problems reported by the R package builder
>> before submitting a package to CRAN.

> Now here are a few caveates. Please let me know if  I'm not aware of
> something that has already been fixed.

> 1/ I'm using a file 00General_Description.Rd to provide a general
> description of the package. This gets reported as an Rd file without
> alias, but even though the package builder reports that as a problem I
> didn't intend to eliminate it.

The rule is as follows (from the R Extension Writers guide):

  `\alias{TOPIC}'
     The `\alias' entries specify all "topics" the file documents.
     This information (together with the file name) is collected into
     index data bases for lookup by the on-line (plain text and HTML)
     help systems.

     There may be several `\alias' entries.  Quite often it is
     convenient to document several R objects in one file.  For example,
     file `Normal.Rd' documents the density, distribution function,
     quantile function and generation of random variates for the normal
     distribution, and hence starts with

          \name{Normal}
          \alias{dnorm}
          \alias{pnorm}
          \alias{qnorm}
          \alias{rnorm}

     Note that the name of the file is not necessarily a topic
     documented.

Hence, an Rd file without an alias is pointless because it does not
register any topic it provides information for.

> 2/ Specific methods get reported as undocumented functions unless the
> generic documentation has an alias line for the specific method. This
> is not a problem when everything is in one package, however, for many
> of my specific methods the generic method is in another of my packages
> or in the base. (This can generate a lot of warning, which obscure
> more important warnings.) I'm putting a "stub" description in to
> eliminate all the warnings, but I'm not sure if this is the ideal way
> to do this.

Not sure if I understand this correctly.  If you have a specific method
say foo.dse then you'd have

  \alias{foo.dse}

etc.  So why would this be undocumented?

> 3/ Data sets cannot use constructors in the package. They need to be
> structures which can be fully recognized by the base system. (.rda
> files may be a better alternative in this case?)

Yes.  I will add something on this to the R-exts.

> 4/ R CMD build does not work for bundles, but it can be used to test
> sub-packages and then the bundle rolled up afterwards directly with
> tar and gzip. (This is not difficult and not a problem, but people
> should be aware of it.)

I should add something on this too.  Perhaps, Paul, once you release dse
as a package bundle I can try to make R CMD build work for bundles, too.

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From plummer@iarc.fr  Wed Apr 12 10:55:37 2000
From: plummer@iarc.fr (plummer@iarc.fr)
Date: Wed, 12 Apr 2000 11:55:37 +0200 (MET DST)
Subject: [Rd] For wishlist: sanity checks for subsets in lm, glm (PR#515)
Message-ID: <200004120955.LAA22235@pubhealth.ku.dk>

I got stung by this yesterday:

R> x <- seq(0,1,length=101)
R> y <- x + rnorm(101)/5
R> test.data <- data.frame(x=x, y=y, cond=(x <= 0.5))
R> # A perfect fit! But very implausible parameter estimates.
R> glm(y ~ x, data=test.data, subset=cond)

Call:  glm(formula = y ~ x, data = test.data, subset = cond) 

Coefficients:
(Intercept)            x  
    -0.1283      29.5571  

Degrees of Freedom: 100 Total (i.e. Null);  99 Residual
Null Deviance:      2.206 
Residual Deviance: 3.929e-32    AIC: -7477 
R> # Here's why ...
R> test.data2 <- test.data[test.data$cond, ]
R> table(test.data2$x, test.data2$y)
      
       -0.128278372512167 0.167292488167292
  0                    50                 0
  0.01                  0                51
R> # ... I just replicated the first two rows
R> test.data[1:2,]
     x          y cond
1 0.00 -0.1282784 TRUE
2 0.01  0.1672925 TRUE

Now, I admit that this isn't a bug. I should have used

R> test.data <- data.frame(x=x, y=y, cond=I(x <= 0.5))

to preserve cond as a logical vector, as documented in the help for
data.frame.  However, it is still very unpleasant behaviour, and no
warnings were issued.  I can't help thinking that some sanity checks on
the subset argument could have helped me.

So I suggest that the subset argument should either be
* A logical vector of the same length as the number of rows in the data
  frame, or
* A numeric vector of unique integers
to ensure that we really do get a subset of the data frame. The more
flexible behaviour of "[.data.frame" really isn't required here.

Martyn

--please do not edit the information below--

Version:
 platform = i686-unknown-linux
 arch = i686
 os = linux
 system = i686, linux
 status =
 major = 1
 minor = 0.0
 year = 2000
 month = February
 day = 29
 language = R

Search Path:
 .GlobalEnv, Autoloads, package:base

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Wed Apr 12 11:12:59 2000
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 12 Apr 2000 12:12:59 +0200
Subject: [Rd] For wishlist: sanity checks for subsets in lm, glm (PR#515)
In-Reply-To: plummer@iarc.fr's message of "Wed, 12 Apr 2000 11:55:37 +0200 (MET DST)"
References: <200004120955.LAA22235@pubhealth.ku.dk>
Message-ID: <x2purv39w4.fsf@blueberry.kubism.ku.dk>

plummer@iarc.fr writes:

> to preserve cond as a logical vector, as documented in the help for
> data.frame.  However, it is still very unpleasant behaviour, and no
> warnings were issued.  I can't help thinking that some sanity checks on
> the subset argument could have helped me.
> 
> So I suggest that the subset argument should either be
> * A logical vector of the same length as the number of rows in the data
>   frame, or
> * A numeric vector of unique integers
> to ensure that we really do get a subset of the data frame. The more
> flexible behaviour of "[.data.frame" really isn't required here.

Might be a good idea. Mind you, Splus 3.4 does exatly the same thing,
and I'm a little worried that the uniqueness assumption might kill
some bootstrapping applications:

 glm(y ~ x, data=test.data, subset=sample(seq(along=y),replace=T))


-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From plummer@iarc.fr  Wed Apr 12 11:55:55 2000
From: plummer@iarc.fr (Martyn Plummer)
Date: Wed, 12 Apr 2000 12:55:55 +0200 (CEST)
Subject: [Rd] For wishlist: sanity checks for subsets in lm, glm (PR#
In-Reply-To: <x2purv39w4.fsf@blueberry.kubism.ku.dk>
Message-ID: <XFMail.000412125555.plummer@iarc.fr>

On 12-Apr-00 Peter Dalgaard BSA wrote:
> Might be a good idea. Mind you, Splus 3.4 does exatly the same thing,
> and I'm a little worried that the uniqueness assumption might kill
> some bootstrapping applications:
> 
>  glm(y ~ x, data=test.data, subset=sample(seq(along=y),replace=T))

Splus 5.1 doesn't do this, because it preserves logical vectors in
data frames (but then perhaps comparisons with S4 or SPlus 5.x are
irrelevant?)

I knew there would be a good reason not to implement this. My feeling
is that high level modelling functions should protect the  user as
much as possible. If you want more flexibility, you can always
program around it.

   temp.data <- test.data[sample(seq(along=y), replace=T),]
   glm(y ~x, data=temp.data)

This doesn't help with breaking existing code though.

Martyn
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Wed Apr 12 12:18:37 2000
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 12 Apr 2000 13:18:37 +0200
Subject: [Rd] For wishlist: sanity checks for subsets in lm, glm (PR#
In-Reply-To: Martyn Plummer's message of "Wed, 12 Apr 2000 12:55:55 +0200 (CEST)"
References: <XFMail.000412125555.plummer@iarc.fr>
Message-ID: <x2n1mz36uq.fsf@blueberry.kubism.ku.dk>

Martyn Plummer <plummer@iarc.fr> writes:

> On 12-Apr-00 Peter Dalgaard BSA wrote:
> > Might be a good idea. Mind you, Splus 3.4 does exatly the same thing,
> > and I'm a little worried that the uniqueness assumption might kill
> > some bootstrapping applications:
> > 
> >  glm(y ~ x, data=test.data, subset=sample(seq(along=y),replace=T))
> 
> Splus 5.1 doesn't do this, because it preserves logical vectors in
> data frames (but then perhaps comparisons with S4 or SPlus 5.x are
> irrelevant?)

They're sometimes relevant because they show what has been considered
a bug in 3.x... The convert-to-factor conventions in 3.x (and R) are
quite a bit of a pain in my opinion, but I'm afraid we're stuck with
them at least for the near future (we couldn't make an API change as
pervasive as that without bumping the major version number). 

> I knew there would be a good reason not to implement this. My feeling
> is that high level modelling functions should protect the  user as
> much as possible. If you want more flexibility, you can always
> program around it.

Maybe, but... Getting people to program around S/R differences in
their add-on packages haven't always been unproblematic.

What would also catch your case would be to disallow factors as subset
variables, and I can't think of any situation where subsetting with a
factor would occur naturally. Does 5.1 allow subsetting with factors?

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Wed Apr 12 12:16:21 2000
From: p.dalgaard@biostat.ku.dk (p.dalgaard@biostat.ku.dk)
Date: Wed, 12 Apr 2000 13:16:21 +0200 (MET DST)
Subject: [Rd] For wishlist: sanity checks for subsets in lm, glm (PR#
Message-ID: <200004121116.NAA23535@pubhealth.ku.dk>

Martyn Plummer <plummer@iarc.fr> writes:

> On 12-Apr-00 Peter Dalgaard BSA wrote:
> > Might be a good idea. Mind you, Splus 3.4 does exatly the same thing,
> > and I'm a little worried that the uniqueness assumption might kill
> > some bootstrapping applications:
> > 
> >  glm(y ~ x, data=test.data, subset=sample(seq(along=y),replace=T))
> 
> Splus 5.1 doesn't do this, because it preserves logical vectors in
> data frames (but then perhaps comparisons with S4 or SPlus 5.x are
> irrelevant?)

They're sometimes relevant because they show what has been considered
a bug in 3.x... The convert-to-factor conventions in 3.x (and R) are
quite a bit of a pain in my opinion, but I'm afraid we're stuck with
them at least for the near future (we couldn't make an API change as
pervasive as that without bumping the major version number). 

> I knew there would be a good reason not to implement this. My feeling
> is that high level modelling functions should protect the  user as
> much as possible. If you want more flexibility, you can always
> program around it.

Maybe, but... Getting people to program around S/R differences in
their add-on packages haven't always been unproblematic.

What would also catch your case would be to disallow factors as subset
variables, and I can't think of any situation where subsetting with a
factor would occur naturally. Does 5.1 allow subsetting with factors?

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Prof Brian Ripley <ripley@stats.ox.ac.uk>  Wed Apr 12 13:54:57 2000
From: Prof Brian Ripley <ripley@stats.ox.ac.uk> (Prof Brian Ripley)
Date: Wed, 12 Apr 2000 13:54:57 +0100 (BST)
Subject: [Rd] For wishlist: sanity checks for subsets in lm, glm (PR#
Message-ID: <200004121254.NAA22977@toucan.stats.ox.ac.uk>

> From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
> Date: 12 Apr 2000 13:18:37 +0200
> 
> Martyn Plummer <plummer@iarc.fr> writes:
> 
> > On 12-Apr-00 Peter Dalgaard BSA wrote:
> > > Might be a good idea. Mind you, Splus 3.4 does exatly the same thing,
> > > and I'm a little worried that the uniqueness assumption might kill
> > > some bootstrapping applications:
> > > 
> > >  glm(y ~ x, data=test.data, subset=sample(seq(along=y),replace=T))
> > 
> > Splus 5.1 doesn't do this, because it preserves logical vectors in
> > data frames (but then perhaps comparisons with S4 or SPlus 5.x are
> > irrelevant?)
> 
> They're sometimes relevant because they show what has been considered
> a bug in 3.x... The convert-to-factor conventions in 3.x (and R) are
> quite a bit of a pain in my opinion, but I'm afraid we're stuck with
> them at least for the near future (we couldn't make an API change as
> pervasive as that without bumping the major version number). 

I would argue for changing the behaviour of converting logicals for 1.1.
It's a rare case, breaks almost nothing (as evidenced by the lack
of problems with S-PLUS 5.x) and would be helpful. Character vars
are another matter.

> > I knew there would be a good reason not to implement this. My feeling
> > is that high level modelling functions should protect the  user as
> > much as possible. If you want more flexibility, you can always
> > program around it.
> 
> Maybe, but... Getting people to program around S/R differences in
> their add-on packages haven't always been unproblematic.
> 
> What would also catch your case would be to disallow factors as subset
> variables, and I can't think of any situation where subsetting with a
> factor would occur naturally. Does 5.1 allow subsetting with factors?

Yes, exactly as before.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Wed Apr 12 19:34:40 2000
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Wed, 12 Apr 2000 14:34:40 -0400
Subject: [Rd] R CMD build/check
References: <200004100546.HAA14716@aragorn.ci.tuwien.ac.at>
 <38F1F40B.56C0A7B@bank-banque-canada.ca> <14580.6098.971883.305959@aragorn.ci.tuwien.ac.at>
Message-ID: <38F4C1C0.5B781B8C@bank-banque-canada.ca>

 >`\alias{TOPIC}'
 >    The `\alias' entries specify all "topics" the file documents.

Ok. I thought TOPIC had to be an object. (In fact, I thought I was
getting another error message if it wasn't, but I must have been
mistaken as it works fine now.)

>> 2/ Specific methods get reported as undocumented functions unless the

>> generic documentation has an alias line for the specific method. This

>> is not a problem when everything is in one package, however, for many

>> of my specific methods the generic method is in another of my
packages
>> or in the base. (This can generate a lot of warning, which obscure
>> more important warnings.) I'm putting a "stub" description in to
>> eliminate all the warnings, but I'm not sure if this is the ideal way

>> to do this.

>Not sure if I understand this correctly.  If you have a specific method

>say foo.dse then you'd have
> \alias{foo.dse}
>etc.  So why would this be undocumented?

It is not a problem if everything is in one package. But when that is
not the case things are a bit more complicated. For example, I have a
method print.TSdata and the documention for "print" is in base so
instead of just putting an \alias{print.TSdata} in with the
documentation for print, I need to make a little "stub"  .Rd with
\name{print.something} and put all my \alias{print.*'s in that. The same
applies to print.summary and other generic methods in the base.

In addition to the base, I have a lot of generic methods defined in my
tframe package. DSE defines specific methods for these, so the same
problem occurs. I guess in this case I could put the alias for the
specific methods in with the tframe package, but I like to think of
tframe as self-contained and expect not to need to update it as
frequently as I might add new things to DSE.

I've now gone from about 600 undocument function on my first R CMD build
down to about 100. Most of the 500 fixed have just been additional
aliases, and probably 3/4 of them had to be put in these "stub" files
because the generic method was not in the same package. (But it is worth
the trouble, I now have a much better idea where the documentation
truely is weak.)

>> 4/ R CMD build does not work for bundles, but it can be used to test
>> sub-packages and then the bundle rolled up afterwards directly with
>> tar and gzip. (This is not difficult and not a problem, but people
>> should be aware of it.)

>I should add something on this too.  Perhaps, Paul, once you release
dse
>as a package bundle I can try to make R CMD build work for bundles,
too.

ok, but I wouldn't treat it as any sort of priority. Testing the
individual packages and then rolling up the bundle seems to work pretty
well.

Paul Gilbert


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From erich.neuwirth@univie.ac.at  Wed Apr 12 22:40:19 2000
From: erich.neuwirth@univie.ac.at (Erich Neuwirth)
Date: Wed, 12 Apr 2000 23:40:19 +0200
Subject: [Rd] xgobin on win95
References: <200004100546.HAA14716@aragorn.ci.tuwien.ac.at>
 <38F1F40B.56C0A7B@bank-banque-canada.ca> <14580.6098.971883.305959@aragorn.ci.tuwien.ac.at> <38F4C1C0.5B781B8C@bank-banque-canada.ca>
Message-ID: <38F4ED43.23B81778@univie.ac.at>

i finally managed to install brians latest version of
xgobi and the r interface to it on win95.
i am running exceed 6.1
it works,
but clone xgobi (within xgobi) does not work.
has anybody made clone xgobi run on win95 (or win98)?
how about w2k?

additionally,
set DISPLAY=localhost
does not work
i do have
localhost 	127.0.0.1
in my hosts file, nonetheless i get an error message
when i try to start xgobi (standalone or from within r)

any ideas about that?
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From erich.neuwirth@univie.ac.at  Wed Apr 12 22:44:48 2000
From: erich.neuwirth@univie.ac.at (Erich Neuwirth)
Date: Wed, 12 Apr 2000 23:44:48 +0200
Subject: [Rd] xgobi, footnote
References: <200003212215.XAA03296@pubhealth.ku.dk>
Message-ID: <38F4EE4F.DDE280CA@univie.ac.at>

XIO:  fatal IO error 104 (Connection reset by peer) on X server
"localhost:0.0"
after 0 requests (0 known processed) with 0 events remaining.

is the error message i get when DISPLAY=localhost:0.0
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From erich.neuwirth@univie.ac.at  Wed Apr 12 23:25:50 2000
From: erich.neuwirth@univie.ac.at (Erich Neuwirth)
Date: Thu, 13 Apr 2000 00:25:50 +0200
Subject: [Rd] xgobi, second footnote
References: <200003212215.XAA03296@pubhealth.ku.dk> <38F4EE4F.DDE280CA@univie.ac.at>
Message-ID: <38F4F7EE.1A36D4E3@univie.ac.at>

updgrading to exceed 6.2
solved the localhost display problem.


Erich Neuwirth wrote:
> 
> XIO:  fatal IO error 104 (Connection reset by peer) on X server
> "localhost:0.0"
> after 0 requests (0 known processed) with 0 events remaining.
> 
> is the error message i get when DISPLAY=localhost:0.0
> -.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
> r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
> Send "info", "help", or "[un]subscribe"
> (in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
> _._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Thu Apr 13 07:07:37 2000
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Thu, 13 Apr 2000 07:07:37 +0100 (BST)
Subject: [Rd] xgobin on win95
In-Reply-To: <38F4ED43.23B81778@univie.ac.at>
Message-ID: <Pine.GSO.4.05.10004130658240.17187-100000@auk.stats>

On Wed, 12 Apr 2000, Erich Neuwirth wrote:

> i finally managed to install brians latest version of
> xgobi and the r interface to it on win95.
> i am running exceed 6.1
> it works,
> but clone xgobi (within xgobi) does not work.
> has anybody made clone xgobi run on win95 (or win98)?

Yes, people have, but there have been several reports of problems from
people who have not followed the instructions. Have you read and followed
all the instructions in the README (like having a suitable shell at
/bin/sh?  On Win9x you may need to ensure that DISPLAY is set as a global
environmental variable.  Note that as Win9x has quite a broken fork,
spawning processes like this is known to give problems.

> how about w2k?

Don't know, but that is really NT, where it does work.

> additionally,
> set DISPLAY=localhost
> does not work
> i do have
> localhost 	127.0.0.1
> in my hosts file, nonetheless i get an error message
> when i try to start xgobi (standalone or from within r)
> 
> any ideas about that?

Should be localhost:0.0 (see the README and xgobi.bat)

BTW, I think this is off-topic for R-devel, and the README in that
distribution does explicitly say that it is unsupported.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From erich.neuwirth@univie.ac.at  Thu Apr 13 12:20:57 2000
From: erich.neuwirth@univie.ac.at (Erich Neuwirth)
Date: Thu, 13 Apr 2000 13:20:57 +0200
Subject: [Rd] xgobi in R on win95
References: <200004121254.NAA22977@toucan.stats.ox.ac.uk>
Message-ID: <38F5AD99.83150CA3@univie.ac.at>

this time,
it is REALLY a bug in the r code for the xgobi interface.
on win95, at least in my configuration,
xgobi(...,multi=TRUE)
does not work.

the temp files R creates are deleted before
the xgobi process gets a chance to read the files.

the culprit is

  on.exit(file.remove(tmpfiles)) 

on windows95, this deletes the files too early.

changing it to
        if(!multi) { on.exit(file.remove(tmpfiles)) }

solves the problem, but of course has the side effect
of leaving the the temporary files on the machine.
i do not understand enough of the mechanics of the system calls 
involved (yet) to do a full repair myself.


my xgobi only questions to this list were cause by the fact
thet multi=TRUE did not work, therefore i tried to use
clone xgobi, which did not work either.
it still does not work, despice the fatc that i think i
read and followed the instructions carefully.

erich
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From duncan@research.bell-labs.com  Thu Apr 13 12:44:09 2000
From: duncan@research.bell-labs.com (Duncan Temple Lang)
Date: Thu, 13 Apr 2000 07:44:09 -0400 (EDT)
Subject: [Rd] xgobi in R on win95
Message-ID: <200004131144.HAA03413@jessie.research.bell-labs.com>


> Date: Thu, 13 Apr 2000 13:20:57 +0200
> From: Erich Neuwirth <erich.neuwirth@univie.ac.at>
> Organization: University of Vienna
> CC: r-devel@stat.math.ethz.ch
> References: <200004121254.NAA22977@toucan.stats.ox.ac.uk>
> Sender: owner-r-devel@stat.math.ethz.ch
> Precedence: bulk
> 
> this time,
> it is REALLY a bug in the r code for the xgobi interface.
> on win95, at least in my configuration,
> xgobi(...,multi=TRUE)
> does not work.
> 
> the temp files R creates are deleted before
> the xgobi process gets a chance to read the files.
> 
> the culprit is
> 
>   on.exit(file.remove(tmpfiles)) 
> 
> on windows95, this deletes the files too early.
> 
> changing it to
>         if(!multi) { on.exit(file.remove(tmpfiles)) }
> 
> solves the problem, but of course has the side effect
> of leaving the the temporary files on the machine.
> i do not understand enough of the mechanics of the system calls 
> involved (yet) to do a full repair myself.
> 
> 
> erich


The lack of synchronization is a fundamental limitation of this style
of inter-process communication. One has to add crude hacks that are
bound to fail under someones configuration in the absence of more
coherent, formal and hence predictable, debuggable approaches are
needed. 

We have two such approaches. Ross, Debby Swayne and I have, at
different times, made modifications to xgobi to allow one to
communicate with it via CORBA.  Combined with the R-CORBA package,
dynamic remote control and query of xgobi is quite simple. With this
approach, the data is transferred directly and no messing with file
systems, timing, etc is needed.

The second approach is to allow XGobi be dynamically loaded into the R
session as a shared library.  I started about a week ago and most of
that is functional (since it shares much of the functionality added
via the CORBA server), but I won't get back to it until next week.
One of the motivations for embedding XGobi into R (& S) is to look at
event-loop integration, with the potential to lead to connections
and/or (internal) threads.  It would be good to know if there is any
interest in having this embedded version for regular use (on Unix,
since it would run in the R process). Otherwise it may not be worth
the effort packaging it up that carefully.

D.

-- 
_______________________________________________________________

Duncan Temple Lang                duncan@research.bell-labs.com
Bell Labs, Lucent Technologies    office: (908)582-3217
700 Mountain Avenue, Room 2C-259  fax:    (908)582-3340
Murray Hill, NJ  07974-2070       
         http://cm.bell-labs.com/stat/duncan

      "Languages shape the way we think, and determine what 
       we can think about."        
                                      Benjamin Whorf
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Thu Apr 13 15:45:55 2000
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Thu, 13 Apr 2000 16:45:55 +0200 (CEST)
Subject: [Rd] Embedding Xgobi into R
In-Reply-To: <200004131144.HAA03413@jessie.research.bell-labs.com>
References: <200004131144.HAA03413@jessie.research.bell-labs.com>
Message-ID: <14581.56739.292151.347850@lynne.ethz.ch>


>>>>> "Duncan" == Duncan Temple Lang <duncan@research.bell-labs.com> writes:

      .............

    Duncan> The second approach is to allow XGobi be dynamically loaded
    Duncan> into the R session as a shared library.  I started about a week
    Duncan> ago and most of that is functional (since it shares much of the
    Duncan> functionality added via the CORBA server), but I won't get back
    Duncan> to it until next week.  One of the motivations for embedding
    Duncan> XGobi into R (& S) is to look at event-loop integration, with
    Duncan> the potential to lead to connections and/or (internal) threads.
    Duncan> It would be good to know if there is any interest in having
    Duncan> this embedded version for regular use (on Unix, since it would
    Duncan> run in the R process).

I'm interested very much!

{Now showing my complete ignorance:}
I assume this would not rely on any CORBA server availability, right?

    Duncan> Otherwise it may not be worth the effort
    Duncan> packaging it up that carefully.

Martin
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From kohnicho@comp.nus.edu.sg  Thu Apr 13 17:08:57 2000
From: kohnicho@comp.nus.edu.sg (Nicholas Lewin-Koh)
Date: Fri, 14 Apr 2000 00:08:57 +0800 (SST)
Subject: [Rd] xgobi in R on win95
In-Reply-To: <200004131144.HAA03413@jessie.research.bell-labs.com>
Message-ID: <Pine.OSF.4.21.0004140004460.4962-100000@decunx.comp.nus.edu.sg>

Hi,
Debby Swayne is working on a new version of xgobi (now called ggobi). I
have been working with her and we have succeeded in compiling (and
running) the preliminary version native on windows. No more emulation! all
it needs is a com interface and it can communicate directly with R. We
will be putting out some test versions soon, so comments (and help) would
be appreciated.

Nicholas


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Prof Brian Ripley <ripley@stats.ox.ac.uk>  Thu Apr 13 18:04:29 2000
From: Prof Brian Ripley <ripley@stats.ox.ac.uk> (Prof Brian Ripley)
Date: Thu, 13 Apr 2000 18:04:29 +0100 (BST)
Subject: [Rd] XFig device
Message-ID: <200004131704.SAA00170@toucan.stats.ox.ac.uk>

After all the discussion I decided to act, and wrote an XFig device
(for the standard postscript fonts only) which is now in R-devel.
Also, I implementing kerning for the postscript() device.

One thing someone may be able to help me with. XFig 3.2 implements
multiple pages, but does not say in the FORMAT how to split the file
into pages.  If anyone knows, please let me know. (Some reading of the
code suggested this was perhaps not implemented except for printing.)

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From sergei@stams.strath.ac.uk  Fri Apr 14 13:14:29 2000
From: sergei@stams.strath.ac.uk (sergei@stams.strath.ac.uk)
Date: Fri, 14 Apr 2000 14:14:29 +0200 (MET DST)
Subject: [Rd] bundle build and Rd2Sd converion fail (PR#519)
Message-ID: <200004141214.OAA16983@pubhealth.ku.dk>

Dear R-core,
Thank you for your great effort! I am finalising a bundle that works both in
R and Splus. But I faced the following minor problems with R CMD under both
UNIX and LINUX.
1. R CMD build denies to work with bundles. It reports
* checking `DESCRIPTION' package entry ... ERROR: no package entry in 
`DESCRIPTION'
Surely, there is no one, but there is Contains entry.
Next, according to R-exts manual, the packages contained in the bundle need
not contain DESCRIPTION but DESCRIPTION.in file. So building individual bundle 
packages with R CMD does not work neither:
* checking for `DESCRIPTION' ... ERROR: file `DESCRIPTION' not found           

This does not prevent from installing the bundle, and surprisingly enough, 
DESCRIPTION file appears afterwards in all bundle packages! So building 
individual packages now become available (!?)
2. Writing Rd-documentation is much easier than nroff files. But as the 
packages are also working in Splus, I need to generate .d-files as well.
I tried the command below in R-1.0.0 and development version R-1.1 both under 
UNIX and LINUX and get the following error:
sherna man/ % R CMD Rdconv --type=Sd plot.mefista.Rd > plot.mefista.d
Undefined subroutine &main::text2nroff called at /auto/local/pkg/R-1.0.0/instal
l.stams/lib/R/etc/Rdconvlib.pl line 1412, <rdfile> chunk 33.
It would also be nice just to be able to type R CMD Rd2Sd ;-)
Waiting for your reaction.
Best wishes,
Sergei

=================================================================
                           Dr. Sergei ZUYEV
Statistics and Modelling Science dept., University of Strathclyde
    Livingston Tower, 26 Richmond str., Glasgow, G1 1XH, U.K.
     Tel.: +44 (0)141 548 3663    Fax:  +44 (0)141 552 2079
sergei@stams.strath.ac.uk   http://www.stams.strath.ac.uk/~sergei
=================================================================


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From sergei@stams.strath.ac.uk  Fri Apr 14 13:26:48 2000
From: sergei@stams.strath.ac.uk (sergei@stams.strath.ac.uk)
Date: Fri, 14 Apr 2000 14:26:48 +0200 (MET DST)
Subject: [Rd] Rd2Sd conversion: files (PR#520)
Message-ID: <200004141226.OAA17227@pubhealth.ku.dk>

This is a multipart MIME message.

--==_Exmh_-19086308140
Content-Type: text/plain; charset=us-ascii

In addition to my previous message, here is the source Rd-file that I used in

 R CMD Rdconv -d --type=Sd plot.mefista.Rd > plot.mefista.d

command.

--==_Exmh_-19086308140
Content-Type: text/plain ; name="plot.mefista.Rd"; charset=us-ascii
Content-Description: plot.mefista.Rd
Content-Disposition: attachment; filename="plot.mefista.Rd"

\name{plot.mefista}
\alias{plot.mefista}
\title{Plot an object of class mefista.}
\usage{
plot.mefista(mef,draw.style=NA,Space=mef$param$space,xgrid=mef$param$xgrid,
             ygrid=mef$param$ygrid,nlevels=15,ncolors=0,\dots)
}
%- maybe also `usage' for other objects documented here.
\arguments{
  \item{mef}{An object of class \code{mefista}.}
  \item{draw.style}{Values: 0 - linear, 1 - \code{\link{image}}, 2 -
    \code{\link{contour}}, 3 - \code{image()} \emph{and} \code{contour}
    superposed, 4 - \code{\link{persp}}.}
  \item{Space}{
  The state space of the measures. A vector or a matrix giving the
  coordinates of the points in each \emph{row} of the latter. If not
  supplied  it is defined as
  \code{expand.grid(xgrid, ygrid)} if the latter are available,
  otherwise it is considered to be \code{1:length(mu)}.}
\item{nlevels}{Number of levels used in \code{image} or \code{contour}
  plots.}
\item{ncolors}{Number of customized colors to be used in \code{image} or
  \code{contour} plots. If 0, the default color palette is used.}
\item{\dots}{Other plot parameters.}
}
\description{
Plots the gradient function and the measure given in an object of class
\code{mefista}.
}

\seealso{\code{\link{mefista}}, \code{\link{go.steep}} and
    \code{\link{summary.mefista}}. 
}
--==_Exmh_-19086308140--



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Prof Brian Ripley <ripley@stats.ox.ac.uk>  Fri Apr 14 13:47:07 2000
From: Prof Brian Ripley <ripley@stats.ox.ac.uk> (Prof Brian Ripley)
Date: Fri, 14 Apr 2000 13:47:07 +0100 (BST)
Subject: [Rd] bundle build and Rd2Sd converion fail (PR#519)
Message-ID: <200004141247.NAA04540@toucan.stats.ox.ac.uk>


> From: sergei@stams.strath.ac.uk
> Date: Fri, 14 Apr 2000 14:14:29 +0200 (MET DST)
> 
> Dear R-core,
> Thank you for your great effort! I am finalising a bundle that works both in
> R and Splus. But I faced the following minor problems with R CMD under both
> UNIX and LINUX.
> 1. R CMD build denies to work with bundles. It reports
> * checking `DESCRIPTION' package entry ... ERROR: no package entry in 
> `DESCRIPTION'

Yes, no one said it would work with a bundle, did they?  (See
R CMD build --help.)

You can use it to help check packages within a bundle (you can then
ignore that message) and build the bundle by hand.

Now people other than me are building bundles, to make it work with
bundles is on the TODO list.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Prof Brian Ripley <ripley@stats.ox.ac.uk>  Fri Apr 14 13:50:49 2000
From: Prof Brian Ripley <ripley@stats.ox.ac.uk> (Prof Brian Ripley)
Date: Fri, 14 Apr 2000 13:50:49 +0100 (BST)
Subject: [Rd] Rd2Sd conversion: files (PR#520)
Message-ID: <200004141250.NAA04633@toucan.stats.ox.ac.uk>


> From: sergei@stams.strath.ac.uk
> Date: Fri, 14 Apr 2000 14:26:48 +0200 (MET DST)
> To: r-devel@stat.math.ethz.ch
> Subject: [Rd] Rd2Sd conversion: files (PR#520)
> CC: R-bugs@biostat.ku.dk
> X-Loop: R-bugs@biostat.ku.dk
> 
> This is a multipart MIME message.
> 
> --==_Exmh_-19086308140
> Content-Type: text/plain; charset=us-ascii
> 
> In addition to my previous message, here is the source Rd-file that I used in
> 
>  R CMD Rdconv -d --type=Sd plot.mefista.Rd > plot.mefista.d
> 
> command.

Conversion to Sd has never been very good.  As you see, it has been
inadvertently removed together with nroff support.  I have put it back
for 1.1, but do not expect it to be 100% correct and we do not plan to
continue to support nroff-based methods.


[BTW, your example lacks any keywords.]

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Fri Apr 14 15:44:14 2000
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Fri, 14 Apr 2000 10:44:14 -0400
Subject: [Rd] bundle build and Rd2Sd converion fail (PR#519)
References: <200004141214.OAA16983@pubhealth.ku.dk>
Message-ID: <38F72EBE.93EEB4F0@bank-banque-canada.ca>

Sergei

If you just blend together the bundle DESCRIPTION and the DESCRIPTION.in for
each package in the bundle, and put this in a DESCRIPTION file in the package,
then you can run R CMD build on the package. Here are some lines from my
makefile for package dse1 (in  bundle dse):

 cat DESCRIPTION | grep -v Bundle | grep -v Contains \
       >dse1/DESCRIPTION
 cat dse1/DESCRIPTION.in  >>dse1/DESCRIPTION

After you do this R CMD build works on the package and does all its testing, and
produces a tar.gz for each package. You then need to delete these and manually
tar and gzip the bundle.

Paul Gilbert

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From bates@stat.wisc.edu  Sun Apr 16 18:18:35 2000
From: bates@stat.wisc.edu (Douglas Bates)
Date: Sun, 16 Apr 2000 12:18:35 -0500 (CDT)
Subject: [Rd] R-1.0.1 now available via rsync
Message-ID: <m12gsgt-000ZSXC@franz.stat.wisc.edu>

The rsync directories on rsync.r-project.org have been updated so that
r-release points to the 1.0.1 release.  That is,

 rsync -Ca rsync.r-project.org::r-release R-1.0.1

will produce a copy of the 1.0.1 tree in a subdirectory called R-1.0.1
of the current directory.

Other options are:

$ rsync rsync.r-project.org::
r-release      	R sources (feature-frozen version) CVS tree (approx 12 MB)
r-release-patched	patched R sources (feature-frozen version) CVS tree (approx 12 MB)
r-devel        	R sources (development version) CVS tree (approx 12 MB)
r-manuals      	Development sources for manuals for R
xlispstat      	xlispstat sources (development version) CVS tree (approx 12 MB)
ess            	ess (Emacs Speaks Statistics) CVS tree (approx 8.5 MB)
omega          	Omega Project for Statistical Computing CVS tree
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From santini@dsi.unimi.it  Mon Apr 17 10:30:43 2000
From: santini@dsi.unimi.it (santini@dsi.unimi.it)
Date: Mon, 17 Apr 2000 11:30:43 +0200 (MET DST)
Subject: [Rd] akima core dumps on loading (PR#521)
Message-ID: <200004170930.LAA01569@pubhealth.ku.dk>

Full_Name: Massimo santini
Version: 1.0.1
OS: Linux
Submission from: (NULL) (159.149.147.89)


I've just dl the .rpm of R 1.0.1, installed it and then launched 

	insatll.packages("akima")

after re-launching R [--vanilla], the command

	library(akima)

has the only effect to coredump the program. Here is the output of gdb and
strace...

--- GDB (commands given can be seen from the except)

$ R -d gdb
GNU gdb 19991004
Copyright 1998 Free Software Foundation, Inc.
GDB is free software, covered by the GNU General Public License, and you are
welcome to change it and/or distribute copies of it under certain conditions.
Type "show copying" to see the conditions.
There is absolutely no warranty for GDB.  Type "show warranty" for details.
This GDB was configured as "i386-redhat-linux"...
(gdb) run --vanilla
Starting program: /usr/lib/R/bin/R.X11 --vanilla

R : Copyright 2000, The R Development Core Team
Version 1.0.1  (April 14, 2000)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type	"?license" or "?licence" for distribution details.

R is a collaborative project with many contributors.
Type	"?contributors" for a list.

Type	"demo()" for some demos, "help()" for on-line help, or
    	"help.start()" for a HTML browser interface to help.
Type	"q()" to quit R.

> library(akima)

Program received signal SIGSEGV, Segmentation fault.
_dl_lookup_symbol (undef_name=0x2d2e3b3 <Address 0x2d2e3b3 out of bounds>,
ref=0xbfffabb4, 
    symbol_scope=0x81ec65c, reference_name=0x81e8b20
"/usr/lib/R/library/akima/libs/akima.so", reloc_type=208)
    at ../sysdeps/generic/dl-hash.h:31
31	../sysdeps/generic/dl-hash.h: No such file or directory.
(gdb) 

--- STRACE (echo "library(akima)" | strace R --vanilla)

[...]
rt_sigprocmask(SIG_BLOCK, NULL, [], 8)  = 0
stat("/usr/lib/R/library/akima/libs/akima.so", {st_mode=S_IFREG|0755,
st_size=289367, ...}) = 0
stat("/usr/lib/R/library/base/libs/akima.so", 0xbfffdb60) = -1 ENOENT (No such
file or directory)
rt_sigprocmask(SIG_BLOCK, NULL, [], 8)  = 0
rt_sigprocmask(SIG_BLOCK, NULL, [], 8)  = 0
rt_sigprocmask(SIG_BLOCK, NULL, [], 8)  = 0
rt_sigprocmask(SIG_BLOCK, NULL, [], 8)  = 0
rt_sigprocmask(SIG_BLOCK, NULL, [], 8)  = 0
rt_sigprocmask(SIG_BLOCK, NULL, [], 8)  = 0
rt_sigprocmask(SIG_SETMASK, [], NULL, 8) = 0
rt_sigprocmask(SIG_BLOCK, NULL, [], 8)  = 0
rt_sigprocmask(SIG_BLOCK, NULL, [], 8)  = 0
rt_sigprocmask(SIG_SETMASK, [], NULL, 8) = 0
open("/usr/lib/R/library/akima/libs/akima.so", O_RDONLY) = 4
fstat(4, {st_mode=S_IFREG|0755, st_size=289367, ...}) = 0
read(4, "\177ELF\1\1\1\0\0\0\0\0\0\0\0\0\3\0\3\0\1\0\0\0000F\0\000"..., 4096) =
4096
old_mmap(NULL, 115364, PROT_READ|PROT_EXEC, MAP_PRIVATE, 4, 0) = 0x40f3d000
mprotect(0x40f55000, 17060, PROT_NONE)  = 0
old_mmap(0x40f55000, 8192, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED, 4,
0x17000) = 0x40f55000
old_mmap(0x40f57000, 8868, PROT_READ|PROT_WRITE,
MAP_PRIVATE|MAP_FIXED|MAP_ANONYMOUS, -1, 0) = 0x40f57000
close(4)                                = 0
mprotect(0x40f3d000, 98304, PROT_READ|PROT_WRITE) = 0
--- SIGSEGV (Segmentation fault) ---
+++ killed by SIGSEGV +++

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Mon Apr 17 11:03:19 2000
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 17 Apr 2000 12:03:19 +0200
Subject: [Rd] akima core dumps on loading (PR#521)
In-Reply-To: santini@dsi.unimi.it's message of "Mon, 17 Apr 2000 11:30:43 +0200 (MET DST)"
References: <200004170930.LAA01569@pubhealth.ku.dk>
Message-ID: <x2zoqtkpso.fsf@blueberry.kubism.ku.dk>

santini@dsi.unimi.it writes:

> Full_Name: Massimo santini
> Version: 1.0.1
> OS: Linux
> Submission from: (NULL) (159.149.147.89)
> 
> 
> I've just dl the .rpm of R 1.0.1, installed it and then launched 
> 
> 	insatll.packages("akima")
> 
> after re-launching R [--vanilla], the command
> 
> 	library(akima)
> 
> has the only effect to coredump the program. Here is the output of gdb and
> strace...

Hmm. Doesn't happen here. (BTW: Remember to include as much
information about your system as you can think of. It's not obvious
whether you're running RedHat or SuSE for instance and in what
version.) 

> Program received signal SIGSEGV, Segmentation fault.
> _dl_lookup_symbol (undef_name=0x2d2e3b3 <Address 0x2d2e3b3 out of bounds>,
> ref=0xbfffabb4, 
>     symbol_scope=0x81ec65c, reference_name=0x81e8b20
> "/usr/lib/R/library/akima/libs/akima.so", reloc_type=208)
>     at ../sysdeps/generic/dl-hash.h:31
> 31	../sysdeps/generic/dl-hash.h: No such file or directory.
> (gdb) 
> 
> --- STRACE (echo "library(akima)" | strace R --vanilla)
> 
> [...]
> rt_sigprocmask(SIG_BLOCK, NULL, [], 8)  = 0
> stat("/usr/lib/R/library/akima/libs/akima.so", {st_mode=S_IFREG|0755,
> st_size=289367, ...}) = 0
> stat("/usr/lib/R/library/base/libs/akima.so", 0xbfffdb60) = -1 ENOENT (No such
> file or directory)

This would seem to be the problem: the dynamic library isn't there.
Did you get any error messages while compiling the package? (Except
for "...might be used uninitialized..." of which there are quite a few
here too).

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From sergei@stams.strath.ac.uk  Mon Apr 17 11:53:20 2000
From: sergei@stams.strath.ac.uk (sergei@stams.strath.ac.uk)
Date: Mon, 17 Apr 2000 12:53:20 +0200 (MET DST)
Subject: [Rd] na.omit fails for matrices (PR#522)
Message-ID: <200004171053.MAA02535@pubhealth.ku.dk>

Dear R-core team,
I came across the following bug (feature?):
Modyfying example from help(na.omit):
> ( m<-matrix(c(1, 2, 3, 0, 10, NA),ncol=2) )
     [,1] [,2]
[1,]    1    0
[2,]    2   10
[3,]    3   NA
> ( mo<- na.omit(m) )
     [,1] [,2]
attr(,"na.action")
[1] 1
attr(,"na.action")attr(,"class")
[1] "omit"  
> dim(mo)
[1] 0 2        
> is.matrix(mo)
[1] TRUE                                                                       

So the result is an empty matrix! On the other hand   
> na.omit(as.data.frame(m))
  V1 V2
1  1  0
2  2 10                                                                        


works fine. help(na.omit) does not say that matrix is not a valid argument. At 
least in na.omit in Splus it is valid.
I have tested this in R-1.0.0 and development version R-1.1 under LINUX, 
Solaris and MSWindows.

Best wishes,
Sergei

=================================================================
                           Dr. Sergei ZUYEV
Statistics and Modelling Science dept., University of Strathclyde
    Livingston Tower, 26 Richmond str., Glasgow, G1 1XH, U.K.
     Tel.: +44 (0)141 548 3663    Fax:  +44 (0)141 552 2079
E-mail: sergei@stams.strath.ac.uk   http://www.stams.strath.ac.uk
=================================================================


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Mon Apr 17 14:47:41 2000
From: p.dalgaard@biostat.ku.dk (p.dalgaard@biostat.ku.dk)
Date: Mon, 17 Apr 2000 15:47:41 +0200 (MET DST)
Subject: [Rd] akima core dumps on loading (PR#521)
Message-ID: <200004171347.PAA05197@pubhealth.ku.dk>

Massimo Santini <santini@dsi.unimi.it> writes:

> > Hmm. Doesn't happen here. (BTW: Remember to include as much
> > information about your system as you can think of. It's not obvious
> > whether you're running RedHat or SuSE for instance and in what
> > version.) 
> 
> You are perfectly right. My system is an updated RedHat 6.2.

Same here...

> > > stat("/usr/lib/R/library/akima/libs/akima.so", {st_mode=S_IFREG|0755,
> > > st_size=289367, ...}) = 0
> > > stat("/usr/lib/R/library/base/libs/akima.so", 0xbfffdb60) = -1 ENOENT (No such
> > > file or directory)
> > 
> > This would seem to be the problem: the dynamic library isn't there.
> > Did you get any error messages while compiling the package? (Except
> > for "...might be used uninitialized..." of which there are quite a few
> > here too).
> 
> Non errors during the installation phase. The akima.so library is in 
> 
> 	/usr/lib/R/library/akima/libs/akima.so
> 
> where it should be (with correct premissions), but is not in
> 
> 	/usr/lib/R/library/base/libs/akima.so
> 
> (the dir /usr/lib/R/library/base/libs is missing, to be precise).

Oh. Didn't see that. Then that part is OK. Sorry.

> Have you some hint about what to do now?

Hmmm. Interesting: I can provoke the crash on *my other* RedHat6.2
computer (the one still running the egcs compiler). My stack trace says

#0  _dl_lookup_symbol (
    undef_name=0xcbf203b4 <Address 0xcbf203b4 out of bounds>,
    ref=0xbfffb234, 
    symbol_scope=0x81d3cac, 
    reference_name=0x81d3a60
    "/usr/local/src/misc/r-release/BUILD/library/akima/libs/akima.so",
    reloc_type=64) at ../sysdeps/generic/dl-hash.h:31
#1  0x400096ad in _dl_relocate_object (l=0x81d3aa8, scope=0x81d3cac, lazy=0, 
    consider_profiling=0) at ../sysdeps/i386/dl-machine.h:326
#2  0x40255be4 in dl_open_worker (a=0xbfffb3a0) at dl-open.c:182
#3  0x4000ac3b in _dl_catch_error (errstring=0xbfffb39c, 
    operate=0x40255990 <dl_open_worker>, args=0xbfffb3a0) at dl-error.c:141
#4  0x40255d3d in _dl_open (
    file=0xbfffc51c 
"/usr/local/src/misc/r-release/BUILD/library/akima/libs/akima.so",
mode=2, caller=0xbfffb39c) at dl-open.c:232
#5  0x401323d3 in dlopen_doit (a=0xbfffb4b0) at dlopen.c:41
#6  0x4000ac3b in _dl_catch_error (errstring=0x40134080, 
    operate=0x401323a8 <dlopen_doit>, args=0xbfffb4b0) at
dl-error.c:141
#7  0x401328b9 in _dlerror_run (operate=0x401323a8 <dlopen_doit>, 
    args=0xbfffb4b0) at dlerror.c:125
#8  0x40132393 in __dlopen_check (
    file=0xbfffc51c
"/usr/local/src/misc/r-release/BUILD/library/akima/libs/akima.so",
mode=2) at dlopen.c:53
#9  0x80d9cc3 in AddDLL (
    path=0xbfffc51c
"/usr/local/src/misc/r-release/BUILD/library/akima/libs/akim
a.so", asLocal=1, now=1) at ../../../R/src/unix/dynload.c:207


Looks like it is happening during the dynamic linking itself. Doesn't
look nice. (But installing gcc 2.95.2 might fix your problem.)

[diverted back to r-bugs]

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From plummer@iarc.fr  Mon Apr 17 17:09:40 2000
From: plummer@iarc.fr (plummer@iarc.fr)
Date: Mon, 17 Apr 2000 18:09:40 +0200 (MET DST)
Subject: [Rd] Maths in R documentation (PR#523)
Message-ID: <200004171609.SAA06411@pubhealth.ku.dk>

The document R-exts contains the following example of using 
mathematics in R documentation.

\deqn{p(x) = {\lambda^x\ \frac{e^{-\lambda}}{x!}}
     {p(x) = lambda^x exp(-lambda)/x!}

There is a syntax error in there, but that's not my point.
The problem is that using "R CMD Rd2dvi" I find that putting
the alternate forms of the equation on top of each other doesn't
work.

\deqn{foo}
     {bar}

is interpreted as

\deqn{foo}
bar

which causes a number of problems,e.g. you get both forms of the
equation printed, LaTeX complains about missing math delimiters, etc.
I solved this by putting everything on one line:

\deqn{foo}{bar}

but there is either a documentation error in there, or a problem with
parsing ".Rd" format files.

Another problem is that when I type "R CMD Rd2dvi coda" to get a printable
reference for all the functions in the coda package, they seem to come out in
a more or less random order. I get
read.bugs, mcmc, plot.mcmc, codamenu, read.and.check,...
I was expecting alphabetical order. What do I have to do to get this?

Martyn

--please do not edit the information below--

Version:
 platform = i686-unknown-linux
 arch = i686
 os = linux
 system = i686, linux
 status =
 major = 1
 minor = 0.1
 year = 2000
 month = April
 day = 14
 language = R

Search Path:
 .GlobalEnv, Autoloads, package:base

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From rgentlem@stat.auckland.ac.nz  Mon Apr 17 17:57:22 2000
From: rgentlem@stat.auckland.ac.nz (Robert Gentleman)
Date: Tue, 18 Apr 2000 04:57:22 +1200
Subject: [Rd] Maths in R documentation (PR#523)
In-Reply-To: <200004171609.SAA06411@pubhealth.ku.dk>; from plummer@iarc.fr on Mon, Apr 17, 2000 at 06:09:40PM +0200
References: <200004171609.SAA06411@pubhealth.ku.dk>
Message-ID: <20000418045722.A17858@stat1.stat.auckland.ac.nz>

 I pointed this anomaly out sometime ago. It would be nice to either
have the documentation change or the behaviour (I would perfer the 
latter).

On Mon, Apr 17, 2000 at 06:09:40PM +0200, plummer@iarc.fr wrote:
> The document R-exts contains the following example of using 
> mathematics in R documentation.
> 
> \deqn{p(x) = {\lambda^x\ \frac{e^{-\lambda}}{x!}}
>      {p(x) = lambda^x exp(-lambda)/x!}
> 
> There is a syntax error in there, but that's not my point.
> The problem is that using "R CMD Rd2dvi" I find that putting
> the alternate forms of the equation on top of each other doesn't
> work.
> 
> \deqn{foo}
>      {bar}
> 
> is interpreted as
> 
> \deqn{foo}
> bar
> 
> which causes a number of problems,e.g. you get both forms of the
> equation printed, LaTeX complains about missing math delimiters, etc.
> I solved this by putting everything on one line:
> 
> \deqn{foo}{bar}
> 
> but there is either a documentation error in there, or a problem with
> parsing ".Rd" format files.
> 
> Another problem is that when I type "R CMD Rd2dvi coda" to get a printable
> reference for all the functions in the coda package, they seem to come out in
> a more or less random order. I get
> read.bugs, mcmc, plot.mcmc, codamenu, read.and.check,...
> I was expecting alphabetical order. What do I have to do to get this?
> 
> Martyn
> 
> --please do not edit the information below--
> 
> Version:
>  platform = i686-unknown-linux
>  arch = i686
>  os = linux
>  system = i686, linux
>  status =
>  major = 1
>  minor = 0.1
>  year = 2000
>  month = April
>  day = 14
>  language = R
> 
> Search Path:
>  .GlobalEnv, Autoloads, package:base
> 
> -.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
> r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
> Send "info", "help", or "[un]subscribe"
> (in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
> _._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

-- 
+-------------------------------------------------------------------------+
| Robert Gentleman              phone : (64-9) 3737-599 ext 3946          | 
| Senior Lecturer               fax :   (64-9) 3737-018                   |
| Department of Statistics      office : Room 206 Maths/Physics           |
| University of Auckland	email : rgentlem@stat.auckland.ac.nz      |
+-------------------------------------------------------------------------+
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From maechler@stat.math.ethz.ch  Tue Apr 18 08:00:41 2000
From: maechler@stat.math.ethz.ch (maechler@stat.math.ethz.ch)
Date: Tue, 18 Apr 2000 09:00:41 +0200 (MET DST)
Subject: [Rd] Maths in R documentation (PR#523)
Message-ID: <200004180700.JAA08711@pubhealth.ku.dk>

>>>>> "Martyn" == Martyn Plummer <plummer@iarc.fr> writes:

    Martyn> The document R-exts contains the following example of using 
    Martyn> mathematics in R documentation.

    Martyn> \deqn{p(x) = {\lambda^x\ \frac{e^{-\lambda}}{x!}}
    Martyn>      {p(x) = lambda^x exp(-lambda)/x!}

    Martyn> There is a syntax error in there, but that's not my point.
    Martyn> The problem is that using "R CMD Rd2dvi" I find that putting
    Martyn> the alternate forms of the equation on top of each other doesn't
    Martyn> work.

    Martyn> \deqn{foo}
    Martyn>      {bar}

    Martyn> is interpreted as

    Martyn> \deqn{foo}
    Martyn> bar

yes.

The typo is simply a missing "%" at the end of the first line
(which once was there, and "of course" was dropped when that documentation
 was translated from latex to texinfo ...)

The following is correct

 \deqn{foo}%
      {bar}

(see e.g. src/library/base/man/Special.Rd or ...../symnum.Rd )

I'll fix R-exts.texi.

    Martyn> which causes a number of problems,e.g. you get both forms of the
    Martyn> equation printed, LaTeX complains about missing math delimiters, etc.
    Martyn> I solved this by putting everything on one line:

    Martyn> \deqn{foo}{bar}

    Martyn> but there is either a documentation error in there, or a
    Martyn> problem with parsing ".Rd" format files.

    Martyn> Another problem is that when I type "R CMD Rd2dvi coda" to get
    Martyn> a printable reference for all the functions in the coda
    Martyn> package, they seem to come out in a more or less random
    Martyn> order. I get read.bugs, mcmc, plot.mcmc, codamenu,
    Martyn> read.and.check,...  I was expecting alphabetical order. What do
    Martyn> I have to do to get this?

The change just been proposed yesterday by Doug Bates:

Replace in R..../bin/Rd2dvi , about line 88

	files=`find ${dir} -name "*.[Rr]d" -print`
by
	files=`find ${dir} -name "*.[Rr]d" -print | sort`


    Martyn> --please do not edit the information below--

    Martyn> Version:
    Martyn> platform = i686-unknown-linux
    Martyn> arch = i686
    Martyn> os = linux
    Martyn> system = i686, linux
    Martyn> status =
    Martyn> major = 1
    Martyn> minor = 0.1
    Martyn> year = 2000
    Martyn> month = April
    Martyn> day = 14
    Martyn> language = R

    Martyn> Search Path:
    Martyn> .GlobalEnv, Autoloads, package:base

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From maechler@stat.math.ethz.ch  Tue Apr 18 13:19:01 2000
From: maechler@stat.math.ethz.ch (maechler@stat.math.ethz.ch)
Date: Tue, 18 Apr 2000 14:19:01 +0200 (MET DST)
Subject: [Rd] Maths in R documentation (PR#523)
Message-ID: <200004181219.OAA12317@pubhealth.ku.dk>

>>>>> "MM" == Martin Maechler <maechler@stat.math.ethz.ch> writes:

>>>>> "Martyn" == Martyn Plummer <plummer@iarc.fr> writes:
    Martyn> The document R-exts contains the following example of using 
    Martyn> mathematics in R documentation.

    Martyn> \deqn{p(x) = {\lambda^x\ \frac{e^{-\lambda}}{x!}}
    Martyn> {p(x) = lambda^x exp(-lambda)/x!}

    Martyn> There is a syntax error in there, but that's not my point.
    Martyn> The problem is that using "R CMD Rd2dvi" I find that putting
    Martyn> the alternate forms of the equation on top of each other doesn't
    Martyn> work.

    Martyn> \deqn{foo}
    Martyn> {bar}

    Martyn> is interpreted as

    Martyn> \deqn{foo}
    Martyn> bar

    MM> yes.

    MM> The typo is simply a missing "%" at the end of the first line
    MM> (which once was there, and "of course" was dropped when that documentation
    MM> was translated from latex to texinfo ...)

    MM> The following is correct

    MM> \deqn{foo}%
    MM>      {bar}

NO!  ...dear me... a closer look at these two files
    MM> (see e.g. src/library/base/man/Special.Rd or ...../symnum.Rd )

reveals that

 \deqn{foo}{%
       bar}

is *the way* ..

sorry for the additional confusion I've added...

    MM> I'll fix R-exts.texi.
..yes..

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ligges@statistik.uni-dortmund.de  Tue Apr 18 18:39:53 2000
From: ligges@statistik.uni-dortmund.de (ligges@statistik.uni-dortmund.de)
Date: Tue, 18 Apr 2000 19:39:53 +0200 (MET DST)
Subject: [Rd] strheight() crashes without opened device (PR#524)
Message-ID: <200004181739.TAA15047@pubhealth.ku.dk>

My mistake, but also a bug.
I did not open a device and called strheight("X").
==> R crashed

...\rgui --vanilla
[...]

> strwidth("X")
Error in strwidth("X") : plot.new has not been called yet
(OK.)

> strheight("X")

R crashed.
(Happens also on Solaris.)


Regards, 
Uwe Ligges


--please do not edit the information below--

Version:
 platform = Windows
 arch = x86
 os = Win32
 system = x86, Win32
 status = 
 major = 1
 minor = 0.0
 year = 2000
 month = February
 day = 29
 language = R

Windows NT 4.0 (build 1381) Service Pack 6

Search Path:
 .GlobalEnv, Autoloads, package:base

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From thomas@biostat.washington.edu  Tue Apr 18 19:17:42 2000
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Tue, 18 Apr 2000 11:17:42 -0700 (PDT)
Subject: [Rd] strheight() crashes without opened device (PR#524)
In-Reply-To: <200004181739.TAA15047@pubhealth.ku.dk>
Message-ID: <Pine.GSO.4.21.0004181116550.10925-100000@mail.biostat.washington.edu>

On Tue, 18 Apr 2000 ligges@statistik.uni-dortmund.de wrote:

> My mistake, but also a bug.
> I did not open a device and called strheight("X").
> ==> R crashed

Fixed for R1.1: we weren't checking that the device existed.

	-thomas


Thomas Lumley
Assistant Professor, Biostatistics
University of Washington, Seattle

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From bolker@zoo.ufl.edu  Wed Apr 19 15:23:34 2000
From: bolker@zoo.ufl.edu (bolker@zoo.ufl.edu)
Date: Wed, 19 Apr 2000 16:23:34 +0200 (MET DST)
Subject: [Rd] Windows-specific: image(z,zlim=()) gives bogus colors outside range (PR#525)
Message-ID: <200004191423.QAA23141@pubhealth.ku.dk>


  In the Windows version of R (not in the equivalent version
running on Linux RH 6.0), doing image(z,zlim=c(a,b)) with
non-trivial limits (i.e., smaller than the range of z)
plots bogus colors (randomly picked from the colormap,
perhaps?) in regions where z is outside of zlim.  (on the
Linux version those regions are just plotted in black, which
seems more appropriate)

  For example:

x <- seq(-1,1,length=50)
z1 <- expand.grid(x,x)
z2 <- matrix(apply(z1,1,function(x)sum(x^2)),nrow=50)
image(z2,zlim=c(0.5,1.5))


--please do not edit the information below--

Version:
 platform = Windows
 arch = x86
 os = Win32
 system = x86, Win32
 status = 
 major = 1
 minor = 0.0
 year = 2000
 month = February
 day = 29
 language = R

Windows 9x 4.0 (build 1212)  B

Search Path:
 .GlobalEnv, Autoloads, package:base

-- 
Ben Bolker                                  bolker@zoo.ufl.edu
Zoology Department, University of Florida   http://www.zoo.ufl.edu/bolker
318 Carr Hall/Box 118525                    tel: (352) 392-5697
Gainesville, FL 32611-8525                  fax: (352) 392-3704


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From bolker@zoo.ufl.edu  Wed Apr 19 15:46:45 2000
From: bolker@zoo.ufl.edu (Ben Bolker)
Date: Wed, 19 Apr 2000 10:46:45 -0400 (EDT)
Subject: [Rd] scale factors/overdispersion in GLM: possible bug?
Message-ID: <Pine.LNX.4.10.10004191030500.863-100000@bolker.zoo.ufl.edu>


  I've been poking around with GLMs (on which I am *not* an expert) on
behalf of a student, particularly binomial (standard logit link) nested
models with overdispersion.

  I have one possible bug to report (but I'm not confident enough to be
*sure* it's a bug); one comment on the general inconsistency that seems to
afflict the various functions for dealing with overdispersion in GLMs
(anova.glm, drop1.glm, summary.glm); and one statistical query that maybe
someone would answer if they're feeling generous.

  1.  possible bug:
  in drop1.glm() with scale != 0, R seems to divide by the dispersion
parameter twice:

 first (if family != "gaussian") it sets

 loglik <- dev/dispersion

 then (if test == "Chisq") it calculates

     dev <- loglik - loglik[1]
     dev[nas] <- 1 - pchisq(dev[nas]/dispersion, aod$Df[nas])

(in addition, I suppose this could now be just 
pchisq(...,lower.tail=FALSE) for greater precision)

  Is this a bug or am I missing something?

  2.  There seems to be a fair amount of variability in how drop1.glm,
anova.glm, stat.anova, summary.glm deal with dispersion parameters:
  summary.glm() has an optional parameter called "dispersion"
  stat.anova() has a parameter called "scale", which it doesn't even use
if test=="Chisq"
  anova.glm calls stat.anova() with an automatically calculated scale
parameter (sum(object$weights*object$residuals^2)/object$df.residual), not
allowing a user-defined scale
  drop1.glm() has an optional parameter called "scale"

  I would mess around and try to fix these myself, but (1) there seem to
be some design decisions to make here, (2) I'm not sufficiently sure of
myself to want to break things.

  3. There seems to be a certain variety of advice around in how to deal
with overdispersion in GLMs.  One could (1) calculate the scale parameter
from the residuals (either residual deviance/residual df or Pearson
chi-sq/residual df) and feed that back into the analysis; (2) use
quasi-likelihood with logit link and variance mu(1-mu); (3) use a form of
F-test, as suggested by Crawley (which I guess has something to do with
the fact that the scale parameter is estimated, not really known).  Are
these equivalent, or approximately equivalent?  Does anyone have a
favorite reference on the subject?  (I've been looking at V&R3, Crawley's
"GLIM for Ecologists", and Lindsey's GLM book -- I haven't acquired Dobson
or McCullagh and Nelder yet).

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ligges@statistik.uni-dortmund.de  Wed Apr 19 16:03:06 2000
From: ligges@statistik.uni-dortmund.de (Uwe Ligges)
Date: Wed, 19 Apr 2000 17:03:06 +0200
Subject: [Rd] Windows-specific: image(z,zlim=()) gives bogus colors outside
 range (PR#525)
References: <200004191423.QAA23141@pubhealth.ku.dk>
Message-ID: <38FDCAAA.41B5DAE@statistik.uni-dortmund.de>

bolker@zoo.ufl.edu schrieb:
> 
>   In the Windows version of R (not in the equivalent version
> running on Linux RH 6.0), doing image(z,zlim=c(a,b)) with
> non-trivial limits (i.e., smaller than the range of z)
> plots bogus colors (randomly picked from the colormap,
> perhaps?) in regions where z is outside of zlim.  (on the
> Linux version those regions are just plotted in black, which
> seems more appropriate)
> 
>   For example:
> 
> x <- seq(-1,1,length=50)
> z1 <- expand.grid(x,x)
> z2 <- matrix(apply(z1,1,function(x)sum(x^2)),nrow=50)
> image(z2,zlim=c(0.5,1.5))

Additionally try

  image(z2,zlim=c(0.5,0.500001))

Gives segmentation fault on Solaris / Dr. Watson on WinNT

Regards, 
Uwe Ligges
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From bolker@zoo.ufl.edu  Wed Apr 19 16:02:55 2000
From: bolker@zoo.ufl.edu (Ben Bolker)
Date: Wed, 19 Apr 2000 11:02:55 -0400 (EDT)
Subject: [Rd] Windows-specific: image(z,zlim=()) gives bogus colors
 outside  range (PR#525)
In-Reply-To: <38FDCAAA.41B5DAE@statistik.uni-dortmund.de>
Message-ID: <Pine.LNX.4.10.10004191059540.885-100000@bolker.zoo.ufl.edu>


  Oops, I take it back.  I *thought* it worked on Linux, but I just tried
it and got the same problem -- and I get the segmentation fault on Linux
too.

On Wed, 19 Apr 2000, Uwe Ligges wrote:

> bolker@zoo.ufl.edu schrieb:
> > 
> >   In the Windows version of R (not in the equivalent version
> > running on Linux RH 6.0), doing image(z,zlim=c(a,b)) with
> > non-trivial limits (i.e., smaller than the range of z)
> > plots bogus colors (randomly picked from the colormap,
> > perhaps?) in regions where z is outside of zlim.  (on the
> > Linux version those regions are just plotted in black, which
> > seems more appropriate)
> > 
> >   For example:
> > 
> > x <- seq(-1,1,length=50)
> > z1 <- expand.grid(x,x)
> > z2 <- matrix(apply(z1,1,function(x)sum(x^2)),nrow=50)
> > image(z2,zlim=c(0.5,1.5))
> 
> Additionally try
> 
>   image(z2,zlim=c(0.5,0.500001))
> 
> Gives segmentation fault on Solaris / Dr. Watson on WinNT
> 
> Regards, 
> Uwe Ligges
> 
> 

-- 
Ben Bolker                                  bolker@zoo.ufl.edu
Zoology Department, University of Florida   http://www.zoo.ufl.edu/bolker
318 Carr Hall/Box 118525                    tel: (352) 392-5697
Gainesville, FL 32611-8525                  fax: (352) 392-3704

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From lamj@stat.cmu.edu  Wed Apr 19 16:27:37 2000
From: lamj@stat.cmu.edu (lamj@stat.cmu.edu)
Date: Wed, 19 Apr 2000 17:27:37 +0200 (MET DST)
Subject: [Rd] INSTALL_SCRIPT during installation (PR#526)
Message-ID: <200004191527.RAA23531@pubhealth.ku.dk>

The following patch uses INSTALL_SCRIPT to install scripts, as opposed
to directly using INSTALL.  It is relative to R-1.0.1 source.

     -- Johnny C. Lam <lamj@stat.cmu.edu>
        Department of Statistics, Carnegie Mellon University
        http://www.stat.cmu.edu/~lamj/

--- Makeconf.in.orig	Sat Jan 22 15:10:00 2000
+++ Makeconf.in	Mon Apr 17 16:04:58 2000
@@ -23,6 +23,7 @@
 INSTALL = @INSTALL@
 INSTALL_DATA = @INSTALL_DATA@
 INSTALL_PROGRAM = @INSTALL_PROGRAM@
+INSTALL_SCRIPT = @INSTALL_SCRIPT@
 INSTALL_DIR = ${INSTALL} -d
 LATEX = @LATEX@
 LDCMD = @LDCMD@
--- Makefile.in.orig	Mon Feb 21 02:03:26 2000
+++ Makefile.in	Mon Apr 17 16:11:47 2000
@@ -74,7 +74,7 @@
 	@for f in `ls bin/* | grep -v '^bin/R\**$$' \
 	                    | grep -v '^bin/R.X11\**$$' \
 	                    | grep -v '^bin/R.GNOME\**$$'`; do \
-	  $(INSTALL) $${f} $(rhome)/bin; \
+	  $(INSTALL_SCRIPT) $${f} $(rhome)/bin; \
 	done
 	@echo "installing headers ..."
 	@for f in include/*.h; do \
--- src/scripts/Makefile.in.orig	Mon Feb 21 05:49:10 2000
+++ src/scripts/Makefile.in	Mon Apr 17 16:13:11 2000
@@ -38,10 +38,10 @@
 	  > $(top_builddir)/bin/R
 	@chmod +x $(top_builddir)/bin/R
 	@for f in $(SCRIPTS_S); do \
-	  $(INSTALL) $(srcdir)/$$f $(top_builddir)/bin; \
+	  $(INSTALL_SCRIPT) $(srcdir)/$$f $(top_builddir)/bin; \
 	done
 	@for f in $(SCRIPTS_B); do \
-	  $(INSTALL) $$f $(top_builddir)/bin; \
+	  $(INSTALL_SCRIPT) $$f $(top_builddir)/bin; \
 	done
 
 $(SCRIPTS_B): $(top_builddir)/config.status


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From thomas@biostat.washington.edu  Wed Apr 19 16:55:43 2000
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Wed, 19 Apr 2000 08:55:43 -0700 (PDT)
Subject: [Rd] Windows-specific: image(z,zlim=()) gives bogus colors
 outside  range (PR#525)
In-Reply-To: <Pine.LNX.4.10.10004191059540.885-100000@bolker.zoo.ufl.edu>
Message-ID: <Pine.GSO.4.21.0004190855090.27936-100000@mail.biostat.washington.edu>

On Wed, 19 Apr 2000, Ben Bolker wrote:

> 
>   Oops, I take it back.  I *thought* it worked on Linux, but I just tried
> it and got the same problem -- and I get the segmentation fault on Linux
> too.

This seems to have been fixed in the development branch at least.

	-thomas

Thomas Lumley
Assistant Professor, Biostatistics
University of Washington, Seattle


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ligges@statistik.uni-dortmund.de  Wed Apr 19 17:01:38 2000
From: ligges@statistik.uni-dortmund.de (Uwe Ligges)
Date: Wed, 19 Apr 2000 18:01:38 +0200
Subject: [Rd] .Renviron and WinNT4 SP5/SP6
Message-ID: <38FDD862.6DDC642C@statistik.uni-dortmund.de>

Hello!

This is a really rare problem / bug(?).

I tested around because of the mail on R-Help:

  Faheem Mitha <faheem@email.unc.edu>
  Subj.: increasing memory size


I created a file .Renviron:

   R_VSIZE=10M

without a linebreak after that line, because I thought Faheem might have
forgot it.
I expected, the line would not be interpreted.

To my surprise R crashed at once (R-1.0.0 patched, WinNT4.0 SP6).
Using the same R-1.0.0 (files on the same Server) but on a WinNT4.0 SP5
machine, it works as expected (R starts without interpreting
"R_VSIZE=10M").


Regards,
Uwe Ligges
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Wed Apr 19 17:43:43 2000
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 19 Apr 2000 18:43:43 +0200 (CEST)
Subject: [Rd] INSTALL_SCRIPT during installation (PR#526)
In-Reply-To: <200004191527.RAA23531@pubhealth.ku.dk>
References: <200004191527.RAA23531@pubhealth.ku.dk>
Message-ID: <14589.57919.217396.444893@aragorn.ci.tuwien.ac.at>

>>>>> lamj  writes:

> The following patch uses INSTALL_SCRIPT to install scripts, as opposed
> to directly using INSTALL.  It is relative to R-1.0.1 source.

I am not sure this is really a bug, and the changes are already in 1.1.0
anyway.  If someone is willing to make the change in 1.0.1, please note:
the changes in Makeconf.in and src/scripts/Makefile.in are fine.  The
one in Makefile.in is not, because 1.1.0 has GUI shared libs as well,
which need INSTALL rather than INSTALL_SCRIPT.  I think one can get that
right via `grep -v '^bin/R_''.

Hmm ...

-k

>      -- Johnny C. Lam <lamj@stat.cmu.edu>
>         Department of Statistics, Carnegie Mellon University
>         http://www.stat.cmu.edu/~lamj/

> --- Makeconf.in.orig	Sat Jan 22 15:10:00 2000
> +++ Makeconf.in	Mon Apr 17 16:04:58 2000
> @@ -23,6 +23,7 @@
>  INSTALL = @INSTALL@
>  INSTALL_DATA = @INSTALL_DATA@
>  INSTALL_PROGRAM = @INSTALL_PROGRAM@
> +INSTALL_SCRIPT = @INSTALL_SCRIPT@
>  INSTALL_DIR = ${INSTALL} -d
>  LATEX = @LATEX@
>  LDCMD = @LDCMD@
> --- Makefile.in.orig	Mon Feb 21 02:03:26 2000
> +++ Makefile.in	Mon Apr 17 16:11:47 2000
> @@ -74,7 +74,7 @@
>  	@for f in `ls bin/* | grep -v '^bin/R\**$$' \
>  	                    | grep -v '^bin/R.X11\**$$' \
>  	                    | grep -v '^bin/R.GNOME\**$$'`; do \
> -	  $(INSTALL) $${f} $(rhome)/bin; \
> +	  $(INSTALL_SCRIPT) $${f} $(rhome)/bin; \
>  	done
>  	@echo "installing headers ..."
>  	@for f in include/*.h; do \
> --- src/scripts/Makefile.in.orig	Mon Feb 21 05:49:10 2000
> +++ src/scripts/Makefile.in	Mon Apr 17 16:13:11 2000
> @@ -38,10 +38,10 @@
>> $(top_builddir)/bin/R
>  	@chmod +x $(top_builddir)/bin/R
>  	@for f in $(SCRIPTS_S); do \
> -	  $(INSTALL) $(srcdir)/$$f $(top_builddir)/bin; \
> +	  $(INSTALL_SCRIPT) $(srcdir)/$$f $(top_builddir)/bin; \
>  	done
>  	@for f in $(SCRIPTS_B); do \
> -	  $(INSTALL) $$f $(top_builddir)/bin; \
> +	  $(INSTALL_SCRIPT) $$f $(top_builddir)/bin; \
>  	done
 
>  $(SCRIPTS_B): $(top_builddir)/config.status


> -.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
> r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
> Send "info", "help", or "[un]subscribe"
> (in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
> _._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Wed Apr 19 22:10:49 2000
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Wed, 19 Apr 2000 17:10:49 -0400
Subject: [Rd] R CMD check seg fault in Linux
Message-ID: <38FE20D9.E83527F9@bank-banque-canada.ca>

For some of my packages I am getting a segmentation fault in Linux when
I use R CMD check. (Using R 1.0.1) The segmentation fault does not
happen in Solaris and in some cases it does not happen in Linux if I set
R_NSIZE and R_VSIZE much higher than I need in Solaris. Should I expect
a segmentation fault if there is not enough memory for R CMD check, or
are these unrelated?

Paul Gilbert

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Wed Apr 19 22:55:58 2000
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 19 Apr 2000 23:55:58 +0200
Subject: [Rd] R CMD check seg fault in Linux
In-Reply-To: Paul Gilbert's message of "Wed, 19 Apr 2000 17:10:49 -0400"
References: <38FE20D9.E83527F9@bank-banque-canada.ca>
Message-ID: <x2ya69kb69.fsf@blueberry.kubism.ku.dk>

Paul Gilbert <pgilbert@bank-banque-canada.ca> writes:

> For some of my packages I am getting a segmentation fault in Linux when
> I use R CMD check. (Using R 1.0.1) The segmentation fault does not
> happen in Solaris and in some cases it does not happen in Linux if I set
> R_NSIZE and R_VSIZE much higher than I need in Solaris. Should I expect
> a segmentation fault if there is not enough memory for R CMD check, or
> are these unrelated?

It's certainly not the intention to give segfaults for that reason...

However, the same pattern could occur from PROTECT errors in your C
code, triggered by a garbage collection at just the wrong moment
(which could be different on different OSs). 

You should rerun the relevant testscript under "R -d gdb" and see
exactly where the segfault occurs.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Thu Apr 20 16:28:54 2000
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Thu, 20 Apr 2000 11:28:54 -0400
Subject: [Rd] R CMD check seg fault in Linux
References: <38FE20D9.E83527F9@bank-banque-canada.ca> <x2ya69kb69.fsf@blueberry.kubism.ku.dk>
Message-ID: <38FF2236.AFE7EC04@bank-banque-canada.ca>

>>Should I expect
>> a segmentation fault if there is not enough memory for R CMD check, or
>> are these unrelated?

>It's certainly not the intention to give segfaults for that reason...
...
>You should rerun the relevant testscript under "R -d gdb" and see
>exactly where the segfault occurs.

It seems the correlation with CMD check and memory was spurious but I have now
observered that the seg faults occur when I run tests on one Linux machine, but
not when I run on the Linux machine I used for installing R (from source) and my
code (which includes some fortan). The machines have similar Linux2.2.9/Mandrake
installations (but fortran didn't get installed on one). The biggest difference
is that the one with fortran installed has has a Celeron processor and the other
one has an AMD-K6. I've never had problems with this differences before. It
might be some time before I get a chance to really dig into it with gdb so if
anyone has any quick insights I would appreciate suggestions. Would there be
compiler flags for different processors or anything like that which might cause
a problem?

Thanks,
Paul Gilbert

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pd@blueberry.kubism.ku.dk  Fri Apr 21 06:15:04 2000
From: pd@blueberry.kubism.ku.dk (Peter Dalgaard BSA)
Date: Fri, 21 Apr 2000 07:15:04 +0200
Subject: [Rd] Bug list summary (automatic post)
Message-ID: <200004210515.HAA04991@blueberry.kubism.ku.dk>

=================================================
This is an automated summary of the status of the R-bugs
repository.

Note that this may be neither complete nor perfectly
correct at any given instance: Not all bugs are reported,
and some reported bugs may have been fixed, but the
repository not yet updated.

Some bug fixes are difficult to verify because they pertain
to specific hardware or operating system versions. If you
have information to contribute, please do so.

If you happen to know how to fix a problem please send
patches to the bug repository, too.

New bugs are reported either through the web
interface at r-bugs.biostat.ku.dk or via email to
r-bugs@biostat.ku.dk. The bug.report() function can be
used to automate parts of the procedure on many systems.
Followups on older bugs can be done by including the string
"(PR#999)" in the Subject of an email (change 999 to the
actual reference number, of course!).
=================================================

Directory:  Accuracy

none

Directory:  Add-ons

* PR# 503 *
Subject: dmvnorm() bug in e1071
From: "Gregory R. Warnes" <warnes@biostat.washington.edu>
Date: Fri, 24 Mar 2000 03:24:45 +0000 (GMT)
* PR# 496 *
From: bonneau@epi.roazhon.inra.fr (en148)
Date: Tue, 21 Mar 2000 10:57:13 +0100 (MET)
--base R has no est.variogram function.
--This appears to be a bug report on sgeostat.
* PR# 488 *
Subject: Error in lme?
From: simon.frost@ed.ac.uk
Date: Tue, 14 Mar 2000 14:15:52 +0100 (MET)
--No example to reproduce this.
* PR# 471 *
Subject:  Problems with nlme 
From: Berwin Turlach <berwin@maths.uwa.edu.au>
Date: Tue, 7 Mar 2000 15:28:00 +0800
--Problem 1) was a subscripting bug introduced in 1.0.0 and fixed for 1.0.1
--Problem 2) (mssing datasets) needs a revised nlme

Directory:  Analyses

none

Directory:  Documentation

none

Directory:  Graphics

* PR# 510 *
Subject:  Strange behaviour of image 
From: J.C.Rougier@durham.ac.uk
Date: Thu, 6 Apr 2000 19:15:19 +0100 (BST)
--At least an inaccurate description.
--To be changed (with a back-compatibility option) in 1.1.0
* PR# 400 *
Subject: X11 troubles
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 13 Jan 2000 14:31:42 +0100
--a) We don't handle multiple window closes well
--b) X11 errors should be caught by an error handler, not kill R
* PR# 202 *
Subject: persp box occlusion bug
From: wsi@gcal.ac.uk
Date: Wed, 2 Jun 1999 15:02:03 +0200 (MET DST)
--The persp algorithm does not apply the occlusion rules to the frame, 
--which is always plotted first. 
--A bug, but not very simple to fix.
* PR# 495 *
Subject: barplot
From: skala@incoma.cz
Date: Tue, 21 Mar 2000 09:20:33 +0100 (MET)
* PR# 414 *
Subject:  graphics bugs: steep slopes and large values beyond ylim 
From: Ben Bolker <bolker@zoo.ufl.edu>
Date: Mon, 7 Feb 2000 18:28:04 -0500
--Followup on R-devel showed this was due to generating integer coordinates 
--outside +/- 2^15 in the X11 driver.

Directory:  In-Out

none

Directory:  Installation

* PR# 485 *
Subject: Install R1.0.0
From: Lynn Zhang <lyzhang@umich.edu>
Date: Mon, 13 Mar 2000 16:10:52 -0500 (EST)
* PR# 478 *
Subject: Conditional for XDR code left out in saveload.c
From: hoffmann@ehmgs2.et.tu-dresden.de
Date: Thu, 9 Mar 2000 09:43:01 +0100 (MET)
--This seems to be a harmless warning, not an error.
* PR# 467 *
Subject: Re: [R] Re: R-1.0.0 is released
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 01 Mar 2000 20:26:40 +0100
--followup to PR#466
* PR# 466 *
Subject: Re: R-1.0.0 is released
From: bhoel@server.python.net (Berthold=?iso-8859-1?q?_H=F6llmann?=)
Date: 01 Mar 2000 16:00:54 +0100

Directory:  Language

* PR# 412 *
Subject: anomalies with call objects
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 06 Feb 2000 01:18:50 +0100
* PR# 408 *
Subject: convolution bug
From: wsimpson@gcal.ac.uk
Date: Fri, 28 Jan 2000 11:17:36 +0100 (MET)

Directory:  Low-level

* PR# 505 *
Subject: interrupted save 
From: Thomas Lumley <thomas@biostat.washington.edu>
Date: Sat, 25 Mar 2000 12:16:50 -0800 (PST)

Directory:  Misc

none

Directory:  Models

none

Directory:  Startup

* PR# 486 *
Subject: Re: autoload error in profile {was anova-bug in R-version  1.0.0?}
From: Martin Maechler <maechler@stat.math.ethz.ch>
Date: Tue, 14 Mar 2000 10:32:43 +0100 (MET)
--workaround to the origin problem in 1.0.1
--New report: try does not work from the profile.

Directory:  System-specific

* PR# 490 *
Subject: R-1.0.0 on alpha/osf1 memory glitch
From: Ray Brownrigg <Ray.Brownrigg@mcs.vuw.ac.nz>
Date: Fri, 17 Mar 2000 11:25:30 +1300 (NZDT)
* PR# 452 *
Subject: problem with glm
From: Brad McNeney <mcneney@cs.sfu.ca>
Date: Fri, 18 Feb 2000 17:51:54 -0800 (PST)
--Problems on Alpha's with glm. Status unclear

Directory:  TooMuchAtOnce

none

Directory:  Windows

none

Directory:  incoming

* PR# 526 *
Subject: INSTALL_SCRIPT during installation
From: "Johnny C. Lam" <lamj@stat.cmu.edu>
Date: Wed, 19 Apr 2000 11:27:52 -0400
* PR# 520 *
Subject: Rd2Sd conversion: files
From: Sergei Zuyev <sergei@stams.strath.ac.uk>
Date: Fri, 14 Apr 2000 13:26:19 +0100
* PR# 519 *
Subject: bundle build and Rd2Sd converion fail
From: Sergei Zuyev <sergei@stams.strath.ac.uk>
Date: Fri, 14 Apr 2000 13:13:48 +0100
* PR# 522 *
Subject: na.omit fails for matrices
From: Sergei Zuyev <sergei@stams.strath.ac.uk>
Date: Mon, 17 Apr 2000 11:52:28 +0100
* PR# 521 *
Subject: akima core dumps on loading
From: santini@dsi.unimi.it
Date: Mon, 17 Apr 2000 11:30:41 +0200 (MET DST)
* PR# 525 *
Subject: Windows-specific: image(z,zlim=()) gives bogus colors outside range
From: Ben Bolker <ben@zoo.ufl.edu>
Date: Wed, 19 Apr 2000 10:20:12 -0400 (EDT)
* PR# 524 *
Subject: strheight() crashes without opened device
From: Uwe Ligges <ligges@statistik.uni-dortmund.de>
Date: Tue, 18 Apr 2000 19:42:00 +0200
* PR# 523 *
Subject: Maths in R documentation
From: Martyn Plummer <plummer@iarc.fr>
Date: Mon, 17 Apr 2000 18:18:55 +0200 (CEST)
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From salwin@mitretek.org  Mon Apr 24 19:36:55 2000
From: salwin@mitretek.org (salwin@mitretek.org)
Date: Mon, 24 Apr 2000 20:36:55 +0200 (MET DST)
Subject: [Rd] Comments on Win95 R Distribution (PR#527)
Message-ID: <200004241836.UAA08583@pubhealth.ku.dk>

Here are some comments generated by a new R user based on
initial experiences with the tool.  

On-line help for tapply:
The following appears "for to each (non-empty) group of
values"  It seems there's an extra preposition in this
sentence.

On-line help for cut:
"break" should be "breaks"

morley.data not available with the distribution.  Would be
helpful for doing the examples in the Intro.

The rwinst.exe did not work at all on Win95.  It could find
no files.  Wasn't clear from the instructions which
directory I should be in while running rwinst.  I tried
several; none worked.  So I manually unzipped the files and
they worked fine.  


-- 
Art Salwin
salwin@mitretek.org
(202) 863-2985
(202) 863-2988 (fax)

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Tue Apr 25 08:09:32 2000
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Tue, 25 Apr 2000 08:09:32 +0100 (BST)
Subject: [Rd] Comments on Win95 R Distribution (PR#527)
In-Reply-To: <200004241836.UAA08583@pubhealth.ku.dk>
Message-ID: <Pine.GSO.4.05.10004250800560.13729-100000@auk.stats>

On Mon, 24 Apr 2000 salwin@mitretek.org wrote:

> Here are some comments generated by a new R user based on
> initial experiences with the tool.  

Please give the R version number or (preferably) use bug.report() to
generate the report.

> On-line help for tapply:
> The following appears "for to each (non-empty) group of
> values"  It seems there's an extra preposition in this
> sentence.
> 
> On-line help for cut:
> "break" should be "breaks"

[Fixed, thank you]

> morley.data not available with the distribution.  Would be
> helpful for doing the examples in the Intro.

That has already been altered for R 1.1. The file is in the Rnotes
package on CRAN at present, and will be in 1.1.0 on.

> The rwinst.exe did not work at all on Win95.  It could find
> no files.  Wasn't clear from the instructions which
> directory I should be in while running rwinst.  I tried
> several; none worked.  So I manually unzipped the files and
> they worked fine.  

You can use it from anywhere, hence it does not specify where. This
puzzles me: you have to set the source directory to where the files
are: use the Browse button to do so.  The installer is known to work
on Windows 95, and there have been many, many, successful uses.
Could you please try again using Browse to get the right directory
with the zip files?


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From john.maindonald@anu.edu.au  Wed Apr 26 03:41:51 2000
From: john.maindonald@anu.edu.au (john.maindonald@anu.edu.au)
Date: Wed, 26 Apr 2000 04:41:51 +0200 (MET DST)
Subject: [Rd] Wrong SEs in predict.lm(..., type="terms") (PR#528)
Message-ID: <200004260241.EAA22007@pubhealth.ku.dk>

>From e980153 Tue Apr 25 14:42:27 2000
To: r-help@stat.math.ethz.ch
Subject: Wrong SEs in predict.lm(..., type="terms")

For what it is worth, I am using RW-1.0.0 under Windows 98.
I submitted this earlier to r-help.  There is one change
below to my proposed corrected code:

predict.lm(..., type="terms") gives wrong standard errors.

Below, I have provided what I believe are the necessary fixes.
However, there are subtleties, and the code needs careful
checking.  Some of the looping is surely not necessary, but
it is surely best to begin with the minimum necessary changes.

My tests, including checks against S-PLUS, have extended to fitting
spline curves.  I have not tested the code with any example where
the pivot sequence does not run sequentially from 1 to p1.

df<-data.frame(x=1:9,y=c(2,3,6,4,8,10,12,14,15))
> df.lm_lm(y~x,data=df)
> as.vector(predict(df.lm,se=T,type="terms")$se.fit)
[1] 0.9904885 0.7428664 0.4952442 0.2476221 0.0000000 0.2476221 0.4952442
[8] 0.7428664 0.9904885

Here is what one should get:
> abs((df$x-mean(df$x)))*summary(df.lm)$coef[2,2]
[1] 0.5769836 0.4327377 0.2884918 0.1442459 0.0000000 0.1442459 0.2884918
[8] 0.4327377 0.5769836

Here is the relevant section of corrected code:


    if (type=="terms"){
      asgn <- attrassign(object)
      beta<-coef(object)
      hasintercept<-attr(tt,"intercept")>0
      if (hasintercept)
        asgn$"(Intercept)"<-NULL
      nterms<-length(asgn)
      predictor<-matrix(ncol=nterms,nrow=NROW(X))
      dimnames(predictor)<-list(rownames(X),names(asgn))

      if (se.fit){
        ip<-matrix(ncol=nterms,nrow=NROW(X))
        dimnames(ip)<-list(rownames(X),names(asgn))
      }
      if (hasintercept){     # This was omitted in the code on r-help
        avX<-apply(X,2,mean)  
        X<-sweep(X,2,avX)    # We'd best sweep out column means
                             # before we start
      }
      for (i in seq(1,nterms,length=nterms)){
        ii<-piv[asgn[[i]]]
	        predictor[,i]<-X[,ii,drop=F]%*%(beta[ii])
        if (se.fit){
          ii2_asgn[[i]]      # X[,piv] matches rows & columns of R
          vci<-R[ii2,ii2]*res.var
          for(j in (1:NROW(X))){
            xi<-X[j,ii,drop=F]  # Do not multiply by beta[ii]
           ip[j,i]<-sum(xi%*% vci %*%t(xi))

          }
        }
      }

Here is the existing section of the (1.0.0) code:

    if (type=="terms"){
      asgn <- attrassign(object)
      beta<-coef(object)
      hasintercept<-attr(tt,"intercept")>0
      if (hasintercept)
        asgn$"(Intercept)"<-NULL
      nterms<-length(asgn)
      predictor<-matrix(ncol=nterms,nrow=NROW(X))
      dimnames(predictor)<-list(rownames(X),names(asgn))
      if (se.fit){
        ip<-matrix(ncol=nterms,nrow=NROW(X))
        dimnames(ip)<-list(rownames(X),names(asgn))
      }
      for (i in seq(1,nterms,length=nterms)){
        if (hasintercept)  # Redundant
          i0<-1            # Redundant
        else               # Redundant
          i0<-NULL         # Redundant
        ii<-piv[asgn[[i]]]
        predictor[,i]<-X[,ii,drop=F]%*%(beta[ii])  # Should be centred
        X[,ii]<-X[,ii]-mean(X[,ii]) # Columns must be centred individually
        if (se.fit){
          vci<-R[ii,ii]*res.var    # The pivot should not be applied to R
          for(j in (1:NROW(X))){
            xi<-X[j,ii,drop=F]*(beta[ii])  # Do not Xply by beta
            ip[j,i]<-sum(xi%*% vci %*%t(xi))
          }
        }
      }


John Maindonald               email : john.maindonald@anu.edu.au        
Statistical Consulting Unit,  phone : (6249)3998        
c/o CMA, SMS,                 fax   : (6249)5549  
John Dedman Mathematical Sciences Building
Australian National University
Canberra ACT 0200
Australia


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From bates@stat.wisc.edu  Thu Apr 27 00:05:14 2000
From: bates@stat.wisc.edu (Douglas Bates)
Date: Wed, 26 Apr 2000 18:05:14 -0500 (CDT)
Subject: [Rd] Cross compiling a package for Windows on Linux
Message-ID: <m12karq-000ZSaC@franz.stat.wisc.edu>

I would like to compile for Windows a rather simple R package that
contains some C code.  It does not contain any Fortran code.

I tried the cross-compilation route using the pre-built set of tools
from http://www.devolution.com/~slouken/SDL/Xmingw32/, as described in
$R_SRC/src/gnuwin32/INSTALL

Using the sources in r-devel from the rsync site I am able to build
libR.a in src/gnuwin32 but I can't build the package.  Using the
sources in r-release-patched from the rsync site I am unable to build
libR.a.  The tail end of that compilation log is

 $ cd r-release/src/gnuwin32/
 $ make
 mkdir -p ../../bin 
 make -C ./fixed
 make[1]: Entering directory `/usr/src/r-release/src/gnuwin32/fixed'
 -------- Building ../../../library/base/R/Rprofile from ../../library/profile/Common.R ../../library/profile/Rprofile.gnw--------
 mkdir -p ../../../library/base/R
 cat  ../../library/profile/Common.R ../../library/profile/Rprofile.gnw > ../../../library/base/R/Rprofile
 sed -e '/^#/d' -e '/Rsockfork/d' -e 's/F77_SUBROUTINE(\(.*\))/void * \1_();/' -e 's/C_FUNCTION(\(.*\))/void * \1();/' ../../appl/ROUTINES > ../../include/FFDecl.h
 sed -e '/^#/d' -e '/Rsockfork/d' -e 's/F77_SUBROUTINE(\(.*\))/	{ "\1_",	\1_},/' -e 's/C_FUNCTION(\(.*\))/{ "\1",	\1 },/' ../../appl/ROUTINES > ../../include/FFTab.h
 sh ./GETCONFIG > ../../include/Rconfig.h
 sh ./GETVERSION > ../../include/Rversion.h
 cp -p ./h/config.h ./h/psignal.h ../../include
 echo done > fixh
 (cd ../../../doc; \
 cat html/search/SearchEngine-head.html > html/search/SearchEngine.html; \
 perl ../src/gnuwin32/fixed/keywords2html KEYWORDS.db >> html/search/SearchEngine.html; \
 cat html/search/SearchEngine-foot.html >> html/search/SearchEngine.html)
 cp -p ./r/*.html ../../../doc/html
 echo done > fixr
 cp -p  bin/Rd2dvi.sh bin/Rd2txt.bat bin/Rdconv.bat bin/Rdindex.bat bin/Sd2Rd.bat bin/fwf2table bin/helpPRINT.bat ../../../bin
 echo done > fixbin
 cp -p etc/Rconsole etc/Rdevga etc/Rprofile etc/rgb.txt ../../../etc
 echo done > fixetc
 ...  (many lines deleted)
 i386-mingw32-gcc -isystem /packages/R-X/i386-mingw32/include   -O2 -Wall -pedantic -I../include -I../include/R_ext -DHAVE_CONFIG_H  -c zeroin.c -o zeroin.o
 i386-mingw32-g77 -O2 -Wall -pedantic  -c blas.f -o blas.o
 make[1]: i386-mingw32-g77: Command not found
 make[1]: *** [blas.o] Error 127
 make[1]: Leaving directory `/usr/src/r-release/src/appl'
 make: *** [rlibs] Error 2
 $ make libR.a
 i386-mingw32-gcc -isystem /packages/R-X/i386-mingw32/include   -O2 -Wall -pedantic -I../include -I../include/R_ext -I. -DHAVE_CONFIG_H  -c console.c -o console.o
 i386-mingw32-gcc -isystem /packages/R-X/i386-mingw32/include   -O2 -Wall -pedantic -I../include -I../include/R_ext -I. -DHAVE_CONFIG_H  -c dataentry.c -o dataentry.o
 i386-mingw32-gcc -isystem /packages/R-X/i386-mingw32/include   -O2 -Wall -pedantic -I../include -I../include/R_ext -I. -DHAVE_CONFIG_H  -c devga.c -o devga.o
 i386-mingw32-gcc -isystem /packages/R-X/i386-mingw32/include   -O2 -Wall -pedantic -I../include -I../include/R_ext -I. -DHAVE_CONFIG_H  -c dodevga.c -o dodevga.o
 i386-mingw32-gcc -isystem /packages/R-X/i386-mingw32/include   -O2 -Wall -pedantic -I../include -I../include/R_ext -I. -DHAVE_CONFIG_H  -c dounzip.c -o dounzip.o
 i386-mingw32-gcc -isystem /packages/R-X/i386-mingw32/include   -O2 -Wall -pedantic -I../include -I../include/R_ext -I. -DHAVE_CONFIG_H  -c dynload.c -o dynload.o
 i386-mingw32-gcc -isystem /packages/R-X/i386-mingw32/include   -O2 -Wall -pedantic -I../include -I../include/R_ext -I. -DHAVE_CONFIG_H  -c edit.c -o edit.o
 i386-mingw32-gcc -isystem /packages/R-X/i386-mingw32/include   -O2 -Wall -pedantic -I../include -I../include/R_ext -I. -DHAVE_CONFIG_H  -c extra.c -o extra.o
 extra.c: In function `Rwin_fpset':
 extra.c:452: warning: implicit declaration of function `_fpreset'
 extra.c:453: warning: implicit declaration of function `_controlfp'
 extra.c:453: `_MCW_EM' undeclared (first use in this function)
 extra.c:453: (Each undeclared identifier is reported only once
 extra.c:453: for each function it appears in.)
 make: *** [extra.o] Error 1
 $ i386-mingw32-gcc --version
 2.95.2


With the sources from r-devel, which have been changed today, I can
generate libR.a but I cannot build a library, even with libR.a.  I
tried building the nls library just as a test.  The errors reported after 
make pkg-nls are

 $ make pkg-nls
 make DLLNM=  EXTRADOCS= \
   -C /usr/src/r-devel/src/library/nls PKG=nls RHOME=/usr/src/r-devel RLIB=/usr/src/r-devel/library \
   -f /usr/src/r-devel/src/gnuwin32/MakePkg
 make[1]: Entering directory `/usr/src/r-devel/src/library/nls'
 ---------- Making package nls ------------
 mkdir -p /usr/src/r-devel/library/nls
 cp -r   ./DESCRIPTION  ./INDEX  ./TITLE  /usr/src/r-devel/library/nls/
 cp: ./DESCRIPTION: No such file or directory
 make[1]: [/usr/src/r-devel/library/nls/zzzz] Error 1 (ignored)
 make -C ./src RHOME=/usr/src/r-devel \
   -f /usr/src/r-devel/src/gnuwin32/MakeDll DLLNAME=nls
 make[2]: Entering directory `/usr/src/r-devel/src/library/nls/src'
 ------- Building nls.dll from nls.a --------
 echo LIBRARY nls > nls.def
 echo EXPORTS >> nls.def
 i386-mingw32-nm nls.a > Defs
 sed -n "/^........ [BCDRT] _/s/^........ [BCDRT] _/ /p" Defs >> nls.def
 i386-mingw32-gcc  -mdll -Wl,--base-file,nls.b -s  -o nls.dll  nls.a  -L/usr/src/r-devel/src/gnuwin32   -lR 
 i386-mingw32-dlltool -k --as i386-mingw32-as   --dllname nls.dll  --base-file nls.b --output-exp nls.e --def nls.def
 i386-mingw32-gcc  -mdll  -Wl,--base-file,nls.b -s  -o nls.dll nls.e nls.a  -L/usr/src/r-devel/src/gnuwin32   -lR 
 nls.a(nls.o)(.text+0x203):nls.c: undefined reference to `Rf_asLogical'
 nls.a(nls.o)(.text+0x20f):nls.c: undefined reference to `Rf_isNewList'
 nls.a(nls.o)(.text+0x223):nls.c: undefined reference to `Rf_error'
 ...  (many lines deleted)
 nls.a(nls.o)(.text+0xb52):nls.c: undefined reference to `Rf_setAttrib'
 nls.a(nls.o)(.text+0xb5c):nls.c: undefined reference to `Rf_unprotect'
 make[2]: *** [nls.dll] Error 1
 make[2]: Leaving directory `/usr/src/r-devel/src/library/nls/src'
 make[1]: *** [src/nls.dll] Error 2
 make[1]: Leaving directory `/usr/src/r-devel/src/library/nls'
 make: *** [pkg-nls] Error 2

Do I need to go back and build a cross-compiler for g77 and start from
scratch?
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Thu Apr 27 07:30:48 2000
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Thu, 27 Apr 2000 07:30:48 +0100 (BST)
Subject: [Rd] Cross compiling a package for Windows on Linux
In-Reply-To: <m12karq-000ZSaC@franz.stat.wisc.edu>
Message-ID: <Pine.GSO.4.05.10004270708090.26167-100000@auk.stats>

On Wed, 26 Apr 2000, Douglas Bates wrote:

> I would like to compile for Windows a rather simple R package that
> contains some C code.  It does not contain any Fortran code.
> 
> I tried the cross-compilation route using the pre-built set of tools
> from http://www.devolution.com/~slouken/SDL/Xmingw32/, as described in
> $R_SRC/src/gnuwin32/INSTALL
> 
> Using the sources in r-devel from the rsync site I am able to build
> libR.a in src/gnuwin32 but I can't build the package.  Using the

Almost certainly you built an incorrect libR.a from the evidence below.

> sources in r-release-patched from the rsync site I am unable to build
> libR.a.  The tail end of that compilation log is
> 
>  $ cd r-release/src/gnuwin32/
>  $ make
>  mkdir -p ../../bin 
>  make -C ./fixed

...

If you use Makefile you are trying to build R, and you can't do that
without Fortran.  To build just a package you need Makefile.packages
and the distributed R.exp file.


>  make[1]: Entering directory `/usr/src/r-release/src/gnuwin32/fixed'
>  -------- Building ../../../library/base/R/Rprofile from ../../library/profile/Common.R ../../library/profile/Rprofile.gnw--------
>  mkdir -p ../../../library/base/R
>  cat  ../../library/profile/Common.R ../../library/profile/Rprofile.gnw > ../../../library/base/R/Rprofile
>  sed -e '/^#/d' -e '/Rsockfork/d' -e 's/F77_SUBROUTINE(\(.*\))/void * \1_();/' -e 's/C_FUNCTION(\(.*\))/void * \1();/' ../../appl/ROUTINES > ../../include/FFDecl.h
>  sed -e '/^#/d' -e '/Rsockfork/d' -e 's/F77_SUBROUTINE(\(.*\))/	{ "\1_",	\1_},/' -e 's/C_FUNCTION(\(.*\))/{ "\1",	\1 },/' ../../appl/ROUTINES > ../../include/FFTab.h
>  sh ./GETCONFIG > ../../include/Rconfig.h
>  sh ./GETVERSION > ../../include/Rversion.h
>  cp -p ./h/config.h ./h/psignal.h ../../include
>  echo done > fixh
>  (cd ../../../doc; \
>  cat html/search/SearchEngine-head.html > html/search/SearchEngine.html; \
>  perl ../src/gnuwin32/fixed/keywords2html KEYWORDS.db >> html/search/SearchEngine.html; \
>  cat html/search/SearchEngine-foot.html >> html/search/SearchEngine.html)
>  cp -p ./r/*.html ../../../doc/html
>  echo done > fixr
>  cp -p  bin/Rd2dvi.sh bin/Rd2txt.bat bin/Rdconv.bat bin/Rdindex.bat bin/Sd2Rd.bat bin/fwf2table bin/helpPRINT.bat ../../../bin
>  echo done > fixbin
>  cp -p etc/Rconsole etc/Rdevga etc/Rprofile etc/rgb.txt ../../../etc
>  echo done > fixetc
>  ...  (many lines deleted)
>  i386-mingw32-gcc -isystem /packages/R-X/i386-mingw32/include   -O2 -Wall -pedantic -I../include -I../include/R_ext -DHAVE_CONFIG_H  -c zeroin.c -o zeroin.o
>  i386-mingw32-g77 -O2 -Wall -pedantic  -c blas.f -o blas.o
>  make[1]: i386-mingw32-g77: Command not found
>  make[1]: *** [blas.o] Error 127
>  make[1]: Leaving directory `/usr/src/r-release/src/appl'
>  make: *** [rlibs] Error 2
>  $ make libR.a
>  i386-mingw32-gcc -isystem /packages/R-X/i386-mingw32/include   -O2 -Wall -pedantic -I../include -I../include/R_ext -I. -DHAVE_CONFIG_H  -c console.c -o console.o
>  i386-mingw32-gcc -isystem /packages/R-X/i386-mingw32/include   -O2 -Wall -pedantic -I../include -I../include/R_ext -I. -DHAVE_CONFIG_H  -c dataentry.c -o dataentry.o
>  i386-mingw32-gcc -isystem /packages/R-X/i386-mingw32/include   -O2 -Wall -pedantic -I../include -I../include/R_ext -I. -DHAVE_CONFIG_H  -c devga.c -o devga.o
>  i386-mingw32-gcc -isystem /packages/R-X/i386-mingw32/include   -O2 -Wall -pedantic -I../include -I../include/R_ext -I. -DHAVE_CONFIG_H  -c dodevga.c -o dodevga.o
>  i386-mingw32-gcc -isystem /packages/R-X/i386-mingw32/include   -O2 -Wall -pedantic -I../include -I../include/R_ext -I. -DHAVE_CONFIG_H  -c dounzip.c -o dounzip.o
>  i386-mingw32-gcc -isystem /packages/R-X/i386-mingw32/include   -O2 -Wall -pedantic -I../include -I../include/R_ext -I. -DHAVE_CONFIG_H  -c dynload.c -o dynload.o
>  i386-mingw32-gcc -isystem /packages/R-X/i386-mingw32/include   -O2 -Wall -pedantic -I../include -I../include/R_ext -I. -DHAVE_CONFIG_H  -c edit.c -o edit.o
>  i386-mingw32-gcc -isystem /packages/R-X/i386-mingw32/include   -O2 -Wall -pedantic -I../include -I../include/R_ext -I. -DHAVE_CONFIG_H  -c extra.c -o extra.o
>  extra.c: In function `Rwin_fpset':
>  extra.c:452: warning: implicit declaration of function `_fpreset'
>  extra.c:453: warning: implicit declaration of function `_controlfp'
>  extra.c:453: `_MCW_EM' undeclared (first use in this function)
>  extra.c:453: (Each undeclared identifier is reported only once
>  extra.c:453: for each function it appears in.)
>  make: *** [extra.o] Error 1
>  $ i386-mingw32-gcc --version
>  2.95.2

I think you omitted to customize MkRules: it seems highly unlikely that
/packages/R-X/i386-mingw32/include is correct for you (it is from my
system): INSTALL says

> Edit MkRules to set BUILD=CROSS and the appropriate paths as needed.

and you need to set HEADER.  In any case, you are getting the wrong
headers.

> With the sources from r-devel, which have been changed today, I can
> generate libR.a but I cannot build a library, even with libR.a.  
> I tried building the nls library just as a test.  The errors reported
after 
> make pkg-nls are
> 
>  $ make pkg-nls

[...]

Looks like libR.a is wrong as R.exp is corrupt (probably empty). When I try
`make libR.a' on R-devel it behaves as for R-release.

The short answer is that you need R.exp, and to get that you need either to
build the whole of R (for which you need g77) or get the one in rwxxxxsp.  
What I suggest you do is to unpack rw1001 (you'll need I think the just
rw1001b? and rw1001sp zip files) and use that. The binary distribution has
the correct Makefile and supplies R.exp.  Last time I tried that
cross-compiled out of the box.

As you noted, I am in the process of changing the Makefiles and
instructions, mainly because the Cygwin release has changed and (aargh!)
not longer has a fully functional make, and the header set has also
changed.  It's a rash assumption that the R-devel or R-release-patched
will cross-compile as we only test that occasionally, including just before
release.

Brian

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Thu Apr 27 08:27:55 2000
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 27 Apr 2000 09:27:55 +0200
Subject: [Rd] Cross compiling a package for Windows on Linux
In-Reply-To: Prof Brian D Ripley's message of "Thu, 27 Apr 2000 07:30:48 +0100 (BST)"
References: <Pine.GSO.4.05.10004270708090.26167-100000@auk.stats>
Message-ID: <x24s8of1fo.fsf@blueberry.kubism.ku.dk>

Prof Brian D Ripley <ripley@stats.ox.ac.uk> writes:

> As you noted, I am in the process of changing the Makefiles and
> instructions, mainly because the Cygwin release has changed and (aargh!)
> not longer has a fully functional make, and the header set has also
> changed.  It's a rash assumption that the R-devel or R-release-patched
> will cross-compile as we only test that occasionally, including just before
> release.

It did last night, though (R-1-0-patches, that is).

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From yaacov@mscc.huji.ac.il  Thu Apr 27 11:56:54 2000
From: yaacov@mscc.huji.ac.il (jr)
Date: Thu, 27 Apr 2000 13:56:54 +0300
Subject: [Rd] R
Message-ID: <005101bfb038$02ff34c0$57058b80@ritov>

I guess there is a mistake in the function princomp (package mva).
I believe that the scores are computed wrongly under cor=TRUE condition:

Lines 42-43:

    if (scores && !missing(x))
        scr <- scale(z, center = TRUE, scale = FALSE) %*% edc$vectors

should be replaced by something like

     if (scores && !missing(x) && !cor)
        scr <- scale(z, center = TRUE, scale = FALSE) %*% edc$vectors
    if (scores && !missing(x) && cor)
        scr <- scale(z) %*% edc$vectors


Sincerely

************************************************

Ya'acov Ritov
Department of Statistics
The Hebrew University of Jerusalem,
Jerusalem 91905
Israel
Tel. (972-2) 652-9929 (Okay way)
Fax (972-2) 652-9996
http://pluto.mscc.huji.ac.il/~yaacov/jr.html
AND THIS IS ANOTHER PROOF THAT IF YOU KEEP AN OPEN MIND, SOMEBODY WILL FILL IT
WITH RUBBISH (an anonymous BBC correspondent)


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Thu Apr 27 12:08:07 2000
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 27 Apr 2000 13:08:07 +0200
Subject: [Rd] Cross compiling a package for Windows on Linux
In-Reply-To: Peter Dalgaard BSA's message of "27 Apr 2000 09:27:55 +0200"
References: <Pine.GSO.4.05.10004270708090.26167-100000@auk.stats> <x24s8of1fo.fsf@blueberry.kubism.ku.dk>
Message-ID: <x2itx3ls2w.fsf@blueberry.kubism.ku.dk>

Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk> writes:

> Prof Brian D Ripley <ripley@stats.ox.ac.uk> writes:
> 
> > As you noted, I am in the process of changing the Makefiles and
> > instructions, mainly because the Cygwin release has changed and (aargh!)
> > not longer has a fully functional make, and the header set has also
> > changed.  It's a rash assumption that the R-devel or R-release-patched
> > will cross-compile as we only test that occasionally, including just before
> > release.
> 
> It did last night, though (R-1-0-patches, that is).

..as does R-devel as of this moment.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Thu Apr 27 13:17:54 2000
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Thu, 27 Apr 2000 14:17:54 +0200 (CEST)
Subject: [Rd] options(keep.source = TRUE) -- also for "library(.)" ?
Message-ID: <14600.12274.664989.534291@lynne.ethz.ch>

       help(options)

contains

    keep.source: When `TRUE', the default, the source code for functions
	      loaded by is stored in their `"source"' attribute, allowing
	      comments to be kept in the right places.  
	      This does not apply to functions loaded by `library'.
	      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

and R behaves as documented, i.e., currently
all functions in package:base and all "interactively defined" functions
keep their source (__including__ comments) with them, whereas all the other
functions do not.

As I tend to create small own packages more and more, and ask others to use
them, users of the packages (and myself) are suffering increasingly from
function definitions with lost comments. 

Can we [those of us who know how sys.source() works...]
think of changing this?  As it was possible for the base package, it must
be doable for the others as well....

Martin
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Thu Apr 27 13:37:01 2000
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 27 Apr 2000 14:37:01 +0200
Subject: [Rd] options(keep.source = TRUE) -- also for "library(.)" ?
In-Reply-To: Martin Maechler's message of "Thu, 27 Apr 2000 14:17:54 +0200 (CEST)"
References: <14600.12274.664989.534291@lynne.ethz.ch>
Message-ID: <x2d7nblnyq.fsf@blueberry.kubism.ku.dk>

Martin Maechler <maechler@stat.math.ethz.ch> writes:

> Can we [those of us who know how sys.source() works...]
> think of changing this?  As it was possible for the base package, it must
> be doable for the others as well....

Martin, surely you could have figured out to remove these two lines
from sys.source:

    oop <- options(keep.source = FALSE)
    on.exit(options(oop))

The real question is whether we want to have a different mechanism for
controlling whether keep.source is set or not. Originally it was FALSE
for the base library to save space, and according the same setting was
used for other libraries since some of them are rather large, but
later it got flipped to TRUE for base, and then there is little point
in setting it FALSE for packages. Question is whether anyone would
want the old behaviour back to get more space for analyses?

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Thu Apr 27 14:04:03 2000
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Thu, 27 Apr 2000 15:04:03 +0200 (CEST)
Subject: [Rd] options(keep.source = TRUE) -- also for "library(.)" ?
In-Reply-To: <x2d7nblnyq.fsf@blueberry.kubism.ku.dk>
References: <14600.12274.664989.534291@lynne.ethz.ch>
 <x2d7nblnyq.fsf@blueberry.kubism.ku.dk>
Message-ID: <14600.15043.86395.259088@lynne.ethz.ch>

>>>>> "PD" == Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk> writes:

    PD> Martin Maechler <maechler@stat.math.ethz.ch> writes:
    >> Can we [those of us who know how sys.source() works...]  think of
    >> changing this?  As it was possible for the base package, it must be
    >> doable for the others as well....

    PD> Martin, surely you could have figured out to remove these two lines
    PD> from sys.source:

    PD>     oop <- options(keep.source = FALSE)
    PD>      on.exit(options(oop))

[blush... *BLUSH* ...
 I didn't look at sys.source(); 
 just knew that parts of it used to look rather "magical" to me ..
]

Of course we now could even make 
   keep.source = getOption("keep.source") 
an argument to library(), being propagated to sys.source(..).

    PD> The real question is whether we want to have a different mechanism
    PD> for controlling whether keep.source is set or not. 
right.

    PD> Originally it was FALSE for the base library to save space, and
    PD> according the same setting was used for other libraries since some
    PD> of them are rather large, but later it got flipped to TRUE for
    PD> base,
(yes, I'm still wondering...)
    PD> and then there is little point in setting it FALSE for packages. 
    PD> Question is whether anyone would want the old behaviour
    PD> back to get more space for analyses?

would be nice if it *was* configurable for base as well;
possibly both via cmd line option
	 (something like --keepsource / --no-keepsource )
and a setting in Rprofile..

>From grepping through the source code, I don't see how it was turned off
for base...

Martin

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From kjetil.kjernsmo@astro.uio.no  Thu Apr 27 14:16:10 2000
From: kjetil.kjernsmo@astro.uio.no (Kjetil Kjernsmo)
Date: Thu, 27 Apr 2000 15:16:10 +0200 (MET DST)
Subject: [Rd] Re: [R] Writing lgrindefs
In-Reply-To: <3907EA6D.6BE703BF@statistik.uni-dortmund.de>
Message-ID: <Pine.OSF.4.05.10004271508590.9815-100000@alnair.uio.no>

On Thu, 27 Apr 2000, Uwe Ligges wrote:

>> however, having all the functions defined in base highlighted as keywords.
>> Would that be a good idea, and if it is, how can I extract the function
>> names most easily?
>
>1. You get a list of objects (not only functions!!!) by typing
>    ls(env=environment("R_GlobalEnv"))
>
>2. In the html-help files, e.g. the "Functions" index could help you.
>   Attention: Not only functions are listed here!

Yeah, that's the problem with both of those, that it doesn't only contain
functions. 

>3. For my R-WinEdt "package", I extracted names of functions of many R
>packages. 
>   If you want, I will send some files.

Oh, I thought about it, but then I figured for this to work consistently,
every user would have to generate his own defs, depending on what packages
he has installed, which would be a bit bothersome I guess. 

>Maybe R-devel is the better forum to discuss this?

Perhaps, so I send this reply there, I sent the original post to r-help
because I figured it might be an easy question for most. I assume that
most of the R-devel members are on the R-help list so I do not resend my
original post. If this assumption doesn't hold, please let me know.  

Best,

Kjetil
-- 
Kjetil Kjernsmo
Graduate astronomy-student                    Problems worthy of attack
University of Oslo, Norway            Prove their worth by hitting back
E-mail: kjetikj@astro.uio.no                                - Piet Hein
Homepage <URL:http://www.astro.uio.no/~kjetikj/>
Webmaster@skepsis.no 

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Prof Brian Ripley <ripley@stats.ox.ac.uk>  Thu Apr 27 14:57:41 2000
From: Prof Brian Ripley <ripley@stats.ox.ac.uk> (Prof Brian Ripley)
Date: Thu, 27 Apr 2000 14:57:41 +0100 (BST)
Subject: [Rd] options(keep.source = TRUE) -- also for "library(.)" ?
Message-ID: <200004271357.OAA21290@toucan.stats.ox.ac.uk>

> Subject: Re: [Rd] options(keep.source = TRUE) -- also for "library(.)" ?
> From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
> Date: 27 Apr 2000 14:37:01 +0200
> 
> Martin Maechler <maechler@stat.math.ethz.ch> writes:
> 
> > Can we [those of us who know how sys.source() works...]
> > think of changing this?  As it was possible for the base package, it must
> > be doable for the others as well....
> 
> Martin, surely you could have figured out to remove these two lines
> from sys.source:
> 
>     oop <- options(keep.source = FALSE)
>     on.exit(options(oop))
> 
> The real question is whether we want to have a different mechanism for
> controlling whether keep.source is set or not. Originally it was FALSE
> for the base library to save space, and according the same setting was
> used for other libraries since some of them are rather large, but
> later it got flipped to TRUE for base, and then there is little point
> in setting it FALSE for packages. Question is whether anyone would
> want the old behaviour back to get more space for analyses?

Yes, but really I would rather have packages stored in separate
workspaces that the garabage collector avoided. Then space is less of
an issue.  Ross I know suggested that, but I don't think anyone
is working on it.

My guess would be that we will not have any space/gc improvements
ready for 1.1, unless Luke's things are close. (BTW, Luke, is your
changed code available?  I went to think about doing some timings the
other night and realized that I thought not. A cvs branch might be good(ish)
way to let us play with it.)

Brian

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Friedrich.Leisch@ci.tuwien.ac.at  Thu Apr 27 15:09:00 2000
From: Friedrich.Leisch@ci.tuwien.ac.at (Friedrich Leisch)
Date: Thu, 27 Apr 2000 16:09:00 +0200 (CEST)
Subject: [Rd] Re: [R] Writing lgrindefs
In-Reply-To: <Pine.OSF.4.05.10004271508590.9815-100000@alnair.uio.no>
References: <3907EA6D.6BE703BF@statistik.uni-dortmund.de>
 <Pine.OSF.4.05.10004271508590.9815-100000@alnair.uio.no>
Message-ID: <14600.18940.551062.659955@galadriel.ci.tuwien.ac.at>

>>>>> On Thu, 27 Apr 2000 15:16:10 +0200 (MET DST),
>>>>> Kjetil Kjernsmo (KK) wrote:

KK> On Thu, 27 Apr 2000, Uwe Ligges wrote:
>>> however, having all the functions defined in base highlighted as keywords.
>>> Would that be a good idea, and if it is, how can I extract the function
>>> names most easily?
>> 
>> 1. You get a list of objects (not only functions!!!) by typing
>> ls(env=environment("R_GlobalEnv"))
>> 
>> 2. In the html-help files, e.g. the "Functions" index could help you.
>> Attention: Not only functions are listed here!


Finding out what is a function and what not is easy:

R> x<- ls("package:base")
R> x[40]
[1] ".lib.loc"
R> x[140]
[1] "anovalist.lm"

where the first is a vector and the second a function, which can
easily be traced:

R> sapply(x[c(40,140)],function(y){is.function(get(y))})
    .lib.loc anovalist.lm 
       FALSE         TRUE 

(don't know if this is the most elegant way of doing it). This leaves
all operators in the list as they are only functions allowing a
special syntax, hence if you want only ordinary functions, you could
simply discard those not starting with a dot or a letter.

Hope this helps,
Fritz

-- 
-------------------------------------------------------------------
                        Friedrich  Leisch 
Institut für Statistik                     Tel: (+43 1) 58801 10715
Technische Universität Wien                Fax: (+43 1) 58801 10798
Wiedner Hauptstraße 8-10/1071      Friedrich.Leisch@ci.tuwien.ac.at
A-1040 Wien, Austria             http://www.ci.tuwien.ac.at/~leisch
     PGP public key http://www.ci.tuwien.ac.at/~leisch/pgp.key
-------------------------------------------------------------------

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Friedrich.Leisch@ci.tuwien.ac.at  Thu Apr 27 15:42:05 2000
From: Friedrich.Leisch@ci.tuwien.ac.at (Friedrich Leisch)
Date: Thu, 27 Apr 2000 16:42:05 +0200 (CEST)
Subject: [Rd] Re: [R] Writing lgrindefs
In-Reply-To: <14600.18940.551062.659955@galadriel.ci.tuwien.ac.at>
References: <3907EA6D.6BE703BF@statistik.uni-dortmund.de>
 <Pine.OSF.4.05.10004271508590.9815-100000@alnair.uio.no>
 <14600.18940.551062.659955@galadriel.ci.tuwien.ac.at>
Message-ID: <14600.20925.394876.538432@galadriel.ci.tuwien.ac.at>

>>>>> On Thu, 27 Apr 2000 16:09:00 +0200 (CEST),
>>>>> Friedrich Leisch (FL) wrote:

>>>>> On Thu, 27 Apr 2000 15:16:10 +0200 (MET DST),
>>>>> Kjetil Kjernsmo (KK) wrote:

KK> On Thu, 27 Apr 2000, Uwe Ligges wrote:
>>>> however, having all the functions defined in base highlighted as keywords.
>>>> Would that be a good idea, and if it is, how can I extract the function
>>>> names most easily?
>>> 
>>> 1. You get a list of objects (not only functions!!!) by typing
>>> ls(env=environment("R_GlobalEnv"))
>>> 
>>> 2. In the html-help files, e.g. the "Functions" index could help you.
>>> Attention: Not only functions are listed here!


FL> Finding out what is a function and what not is easy:

R> x<- ls("package:base")

sorry, forgot the all=TRUE here ...

.f
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ligges@statistik.uni-dortmund.de  Thu Apr 27 16:47:54 2000
From: ligges@statistik.uni-dortmund.de (Uwe Ligges)
Date: Thu, 27 Apr 2000 17:47:54 +0200
Subject: [Rd] Writing lgrindefs
References: <Pine.OSF.4.05.10004271508590.9815-100000@alnair.uio.no>
Message-ID: <3908612A.95CC5F8F@statistik.uni-dortmund.de>

> >> however, having all the functions defined in base highlighted as keywords.
> >> Would that be a good idea, and if it is, how can I extract the function
> >> names most easily?
> >
> >1. You get a list of objects (not only functions!!!) by typing
> >    ls(env=environment("R_GlobalEnv"))
> >
> >2. In the html-help files, e.g. the "Functions" index could help you.
> >   Attention: Not only functions are listed here!
> 
> Yeah, that's the problem with both of those, that it doesn't only contain
> functions.
> 
> >3. For my R-WinEdt "package", I extracted names of functions of many R
> >packages.
> >   If you want, I will send some files.
> 
> Oh, I thought about it, but then I figured for this to work consistently,
> every user would have to generate his own defs, depending on what packages
> he has installed, which would be a bit bothersome I guess.

OK. Fritz has got it! And I feel stupid...

After thinking:
Only functions of the base package are not enough for some users,
on the other hand you will never be up to date with names of all
functions of all packages, I suppose.
Of course TeX cannot know names of R functions, if they are not
specified explicitly.

Suggestions:
1)
Another way is to write a R function, that generates "nice" TeX code.
Or a R function, that generates code to be interpreted by a TeX macro.
Such a function would know about loaded packages and their functions,
user specific functions, other objects in the users environment (as
needed).

2)
Providing names of functions of the most used packages (e.g. base,
ctest, ts, ...) would be enough, if the user could easily extend the
list of "known" functions (or other objects).
I think about a TeX command (defined in your macro), that could be used
as follows:
 \addrfunctionnames{myfunc1, myfunc2, myfunc3}


But maybe there are much better ideas?

Regards,
Uwe Ligges
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Prof Brian Ripley <ripley@stats.ox.ac.uk>  Thu Apr 27 17:00:30 2000
From: Prof Brian Ripley <ripley@stats.ox.ac.uk> (Prof Brian Ripley)
Date: Thu, 27 Apr 2000 17:00:30 +0100 (BST)
Subject: [Rd] Cross compiling a package for Windows on Linux
Message-ID: <200004271600.RAA21782@toucan.stats.ox.ac.uk>

> From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
> Date: 27 Apr 2000 13:08:07 +0200
> 
> Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk> writes:
> 
> > Prof Brian D Ripley <ripley@stats.ox.ac.uk> writes:
> > 
> > > As you noted, I am in the process of changing the Makefiles and
> > > instructions, mainly because the Cygwin release has changed and (aargh!)
> > > not longer has a fully functional make, and the header set has also
> > > changed.  It's a rash assumption that the R-devel or R-release-patched
> > > will cross-compile as we only test that occasionally, including just 
before
> > > release.
> > 
> > It did last night, though (R-1-0-patches, that is).
> 
> ..as does R-devel as of this moment.

Indeed it does.  To make life a bit easier I have put up a complete
current cross-tools set with the latest headers at

http://www.stats.ox.ac.uk/pub/bdr/RWin/i386cross.tar.bz2  (ca 5Mb)

Just unpack it somewhere, put the bin directory in your path and
follow the instructions in INSTALL.

The caveat remains, though: this is not tested frequently.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From thomas@biostat.washington.edu  Thu Apr 27 20:00:23 2000
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Thu, 27 Apr 2000 12:00:23 -0700 (PDT)
Subject: [Rd] gcinfo/R_alloc inconsistency
In-Reply-To: <200004271357.OAA21290@toucan.stats.ox.ac.uk>
Message-ID: <Pine.GSO.4.21.0004271154550.28220-100000@mail.biostat.washington.edu>


gcinfo reports the amount of remaining heap using
	vcells = R_VSize - (R_VTop - R_VHeap);

but R_alloc tests
        if (R_VMax - R_VTop < size)
		mem_err_heap(size);


This means that you can get an out of memory error when gcinfo insists
there are vast amounts of memory left.


	-thomas

Thomas Lumley
Assistant Professor, Biostatistics
University of Washington, Seattle

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From bates@stat.wisc.edu  Thu Apr 27 23:25:40 2000
From: bates@stat.wisc.edu (Douglas Bates)
Date: 27 Apr 2000 17:25:40 -0500
Subject: [Rd] Cross compiling a package for Windows on Linux
In-Reply-To: Prof Brian Ripley's message of "Thu, 27 Apr 2000 17:00:30 +0100 (BST)"
References: <200004271600.RAA21782@toucan.stats.ox.ac.uk>
Message-ID: <6raeiftc4b.fsf@franz.stat.wisc.edu>

Prof Brian Ripley <ripley@stats.ox.ac.uk> writes:

> > From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
> > Date: 27 Apr 2000 13:08:07 +0200
> > 
> > Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk> writes:
> > 
> > > Prof Brian D Ripley <ripley@stats.ox.ac.uk> writes:
> > > 
> > > > As you noted, I am in the process of changing the Makefiles and
> > > > instructions, mainly because the Cygwin release has changed and (aargh!)
> > > > not longer has a fully functional make, and the header set has also
> > > > changed.  It's a rash assumption that the R-devel or R-release-patched
> > > > will cross-compile as we only test that occasionally, including just 
> before
> > > > release.
> > > 
> > > It did last night, though (R-1-0-patches, that is).
> > 
> > ..as does R-devel as of this moment.
> 
> Indeed it does.  To make life a bit easier I have put up a complete
> current cross-tools set with the latest headers at
> 
> http://www.stats.ox.ac.uk/pub/bdr/RWin/i386cross.tar.bz2  (ca 5Mb)
> 
> Just unpack it somewhere, put the bin directory in your path and
> follow the instructions in INSTALL.
> 
> The caveat remains, though: this is not tested frequently.

That worked nicely, thanks.

I did have to make two additional modifications to the Makefile to
drop the --number-pages and the --html flags in calls to makeinfo.  My
version of makeinfo did not accept those flags.

I will have to check at home this evening if the compilation of my
library was successful.  I am optimistic.

This is a very useful facility.

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Fri Apr 28 07:18:49 2000
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Fri, 28 Apr 2000 07:18:49 +0100 (BST)
Subject: [Rd] Cross compiling a package for Windows on Linux
In-Reply-To: <6raeiftc4b.fsf@franz.stat.wisc.edu>
Message-ID: <Pine.GSO.4.05.10004280713150.26961-100000@auk.stats>

On 27 Apr 2000, Douglas Bates wrote:

> Prof Brian Ripley <ripley@stats.ox.ac.uk> writes:
> 
> > > From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
> > > Date: 27 Apr 2000 13:08:07 +0200
> > > 
> > > Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk> writes:
> > > 
> > > > Prof Brian D Ripley <ripley@stats.ox.ac.uk> writes:
> > > > 
> > > > > As you noted, I am in the process of changing the Makefiles and
> > > > > instructions, mainly because the Cygwin release has changed and (aargh!)
> > > > > not longer has a fully functional make, and the header set has also
> > > > > changed.  It's a rash assumption that the R-devel or R-release-patched
> > > > > will cross-compile as we only test that occasionally, including just 
> > before
> > > > > release.
> > > > 
> > > > It did last night, though (R-1-0-patches, that is).
> > > 
> > > ..as does R-devel as of this moment.
> > 
> > Indeed it does.  To make life a bit easier I have put up a complete
> > current cross-tools set with the latest headers at
> > 
> > http://www.stats.ox.ac.uk/pub/bdr/RWin/i386cross.tar.bz2  (ca 5Mb)
> > 
> > Just unpack it somewhere, put the bin directory in your path and
> > follow the instructions in INSTALL.
> > 
> > The caveat remains, though: this is not tested frequently.
> 
> That worked nicely, thanks.
> 
> I did have to make two additional modifications to the Makefile to
> drop the --number-pages and the --html flags in calls to makeinfo.  My
> version of makeinfo did not accept those flags.

Yes, you need makeinfo 4.0 (as you do for R on Unix), and without those
flags you will get the wrong answers.  Actually, this step should not be
necessary: it happens because cvs updates files with the update date, not
the creation date. The same thing happens with configure and configure.in
not infrequently.  So `touch rw-faq fixed/r/rw-FAQ.html' is all that is
needed.


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Apr 28 09:26:47 2000
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 28 Apr 2000 10:26:47 +0200 (CEST)
Subject: [Rd] options(keep.source = TRUE) -- also for "library(.)" ?
In-Reply-To: <14600.15043.86395.259088@lynne.ethz.ch>
References: <14600.12274.664989.534291@lynne.ethz.ch>
 <x2d7nblnyq.fsf@blueberry.kubism.ku.dk>
 <14600.15043.86395.259088@lynne.ethz.ch>
Message-ID: <14601.19271.866855.581704@lynne.ethz.ch>

>>>>> "MM" == Martin Maechler <maechler@stat.math.ethz.ch> writes:

(and I haven't seen more feedback..)

>>>>> "PD" == Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk> writes:
     PD> Martin Maechler <maechler@stat.math.ethz.ch> writes:

	>>> Can we [those of us who know how sys.source() works...]  think of
	>>> changing this?  As it was possible for the base package, it must be
	>>> doable for the others as well....

     PD> Martin, surely you could have figured out to remove these two lines
     PD> from sys.source:

     PD> oop <- options(keep.source = FALSE)
     PD> on.exit(options(oop))

    MM> [blush... *BLUSH* ...
    MM> I didn't look at sys.source(); 
    MM> just knew that parts of it used to look rather "magical" to me ..
    MM> ]

    MM> Of course we now could even make 
    MM> keep.source = getOption("keep.source") 
    MM> an argument to library(), being propagated to sys.source(..).

I'm considering to commit the necessary changes and add the following to
NEWS [for "R-devel"]

    o	library(), require(), and sys.source() have a new argument
	` keep.source = getOption("keep.source") '.
	Hence, by default, functions from all packages (not just base)
	`keep their source'.

Is this okay for everyone ?


     PD> The real question is whether we want to have a different mechanism
     PD> for controlling whether keep.source is set or not. 

    MM> right.

      PD> Originally it was FALSE for the base library to save space, and
      PD> according the same setting was used for other libraries since some
      PD> of them are rather large, but later it got flipped to TRUE for
      PD> base,
    MM> (yes, I'm still wondering...)
      PD> and then there is little point in setting it FALSE for packages. 
      PD> Question is whether anyone would want the old behaviour
      PD> back to get more space for analyses?

    MM> would be nice if it *was* configurable for base as well;
    MM> possibly both via cmd line option
    MM> (something like --keepsource / --no-keepsource )
    MM> and a setting in Rprofile..

    >> From grepping through the source code, I don't see how it was turned off
    MM> for base...

anyone [R-core] ?

Martin Maechler <maechler@stat.math.ethz.ch>	http://stat.ethz.ch/~maechler/
Seminar fuer Statistik, ETH-Zentrum  LEO D10	Leonhardstr. 27
ETH (Federal Inst. Technology)	8092 Zurich	SWITZERLAND
phone: x-41-1-632-3408		fax: ...-1228			<><
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Craig.Mckinstry@pnl.gov  Fri Apr 28 16:36:37 2000
From: Craig.Mckinstry@pnl.gov (Craig.Mckinstry@pnl.gov)
Date: Fri, 28 Apr 2000 17:36:37 +0200 (MET DST)
Subject: [Rd] graphics: par(mfg=c(i,j,r,c)) (PR#529)
Message-ID: <200004281536.RAA21899@pubhealth.ku.dk>

Full_Name: Craig A. McKinstry
Version: 1.0.0
OS: WinNT4.0 and Win98
Submission from: (NULL) (192.101.100.130)


When creating a multi-panel graphic, the command par(mfg=c(i,j,r,c)) is
supposed
to allow the user free movement between graphics panels to develop each panel 
separately. This works for the first invocation of par(mfg=c()) and for the 
first panel panel specified, but not for subsequent calls to the other panels. 

Coded example:

x_1:20
y_1:20
#these 5 commands produce a 2x2 panel plot
par(mfrow=c(2,2))
plot(x,y)
plot(x,y)
plot(x,y)
plot(x,y)

#the following 2 commands successfully added the text 'panel[2,1]' to
panel[2,1]
par(mfg=c(2,1,2,2))
text(10,10,'panel[2,1]')

#None of the following 3 command-pairs produced their intended results for the
other
# 3 panels
par(mfg=c(1,2,2,2))
text(10,10,'panel[1,2]')

par(mfg=c(1,1,2,2))
text(10,10,'panel[1,1]')

par(mfg=c(2,2,2,2))
text(10,10,'panel[2,2]')

#However, the following command-pair did as intended on the first panel
specified
# by mfg=c(2,1,2,2) above
par(mfg=c(2,1,2,2))
text(15,15,'panel[2,2]')

#Running this in S-plus 4.0 produced the intended results


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Fri Apr 28 16:58:29 2000
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 28 Apr 2000 17:58:29 +0200
Subject: [Rd] graphics: par(mfg=c(i,j,r,c)) (PR#529)
In-Reply-To: Craig.Mckinstry@pnl.gov's message of "Fri, 28 Apr 2000 17:36:37 +0200 (MET DST)"
References: <200004281536.RAA21899@pubhealth.ku.dk>
Message-ID: <x28zxyw72y.fsf@blueberry.kubism.ku.dk>

Craig.Mckinstry@pnl.gov writes:

> x_1:20
> y_1:20
> #these 5 commands produce a 2x2 panel plot
> par(mfrow=c(2,2))
> plot(x,y)
> plot(x,y)
> plot(x,y)
> plot(x,y)
> 
> #the following 2 commands successfully added the text 'panel[2,1]' to
> panel[2,1]
> par(mfg=c(2,1,2,2))
> text(10,10,'panel[2,1]')
> 
> #None of the following 3 command-pairs produced their intended results for the
> other
> # 3 panels
> par(mfg=c(1,2,2,2))
> text(10,10,'panel[1,2]')
> 
> par(mfg=c(1,1,2,2))
> text(10,10,'panel[1,1]')
> 
> par(mfg=c(2,2,2,2))
> text(10,10,'panel[2,2]')
> 
> #However, the following command-pair did as intended on the first panel
> specified
> # by mfg=c(2,1,2,2) above
> par(mfg=c(2,1,2,2))
> text(15,15,'panel[2,2]')

Same thing happens on Linux. Might be something with restoring the
coordinate transformations. Using

par(mfg=c(1,1,2,2))
plot(x,y)
text(10,10,'panel[1,1]')

*does* seem to work.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Fri Apr 28 17:02:00 2000
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Fri, 28 Apr 2000 12:02:00 -0400
Subject: [Rd] Rd files with multiple functions?
Message-ID: <3909B5F8.70004B7@bank-banque-canada.ca>

There was at one time some discussion about supporting documentation of multiple
functions in one Rd file. Is that supported or still in the plans?

Paul Gilbert

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Apr 28 17:19:50 2000
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 28 Apr 2000 18:19:50 +0200 (CEST)
Subject: [Rd] options(keep.source = TRUE) -- also for "library(.)" ?
In-Reply-To: <14601.19271.866855.581704@lynne.ethz.ch>
References: <14600.12274.664989.534291@lynne.ethz.ch>
 <x2d7nblnyq.fsf@blueberry.kubism.ku.dk>
 <14600.15043.86395.259088@lynne.ethz.ch>
 <14601.19271.866855.581704@lynne.ethz.ch>
Message-ID: <14601.47654.736464.353659@lynne.ethz.ch>

I'm replying to myself once more :

[and this gets more and more envolved, please "d" if you're not interested ..]

>>>>> "MM" == Martin Maechler <maechler@stat.math.ethz.ch> writes:

    MM> (and I haven't seen more feedback..)

>>>>> "PD" == Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk> writes:

      ........

    MM> Of course we now could even make 
    MM>	   keep.source = getOption("keep.source") 
    MM> an argument to library(), being propagated to sys.source(..).

 MM>   I'm considering to commit the necessary changes and add the following to
 MM>    NEWS [for "R-devel"]
 MM> 
 MM>    o	library(), require(), and sys.source() have a new argument
 MM> 	` keep.source = getOption("keep.source") '.
 MM> 
 MM>   Hence, by default, functions from all packages (not just base)
 MM>   `keep their source'.
 MM> 
 MM>   Is this okay for everyone ?

Now, I still haven't committed the new code, but I have been using it
myself and made a "big picture statistic" *using* the new code, and gc()
for many packages (actually I've done this for all CRAN packages and more)
to find  how much memory is "spilled" by   keep.source = TRUE.

Here are the results :

I show the difference in memory usage {Vcells & Ncells, see ?gc & ?Memory}
for interesting packages, only using R builtin and CRAN (non-Devel) packages:

   Package    Bytes used
	      additionally with   Ncells  Vcells
	      keep.source= TRUE                 
				                
   nlme       2305'364             19023  107659   (actually  nlme + nls)
   survival5  1066'776		   8867    49792
   MASS        631'628		   5186    29507
   mclust      493'512		   4349    22936
   boot        456'944		   3833    21314
   ctest       309'288		   2406    14502
   ts          297'368		   2311    13944
   cluster     244'120		   2270    11298
   nls         236'668		   1871    11085
   wavethresh  218'624		   1878    10180
   mda         215'944		   1878    10046
   rpart       203'892		   1654     9533
   chron       194'640		   1735     9038
   tseries     183'360		   1505     8566
   locfit      176'416		   1632     8168
   tree        166'844		   1248     7843
   modreg      116'752		    989     5442
   nnet         98'124		    838     4571
   splines      85'112		    769     3948
   mva          79'280		    710     3680
   lqs          34'116		    292     1589
   eda          10'860		    105      501
   zmatrix       7'196		     82      327
   Devore5           0		      0        0  [took this to "test"

I.e., for the nlme() one needs an extra 2.3 MBytes of memory just for
"keep.source = TRUE".

I further investigated a bit how much the "keep.source" of base ``costs''
memory wise.
Note that I still don't know how to turn it off easily for base (Peter ?).

However, I just counted how much "source" is in base :
  > length(ob <- ls(pos= match("package:base",search()), all.nam = TRUE))
  [1] 1193
  > length(fns <- ob[sapply(ob, function(n)is.function(get(n)))])
  [1] 1169
  > stem(len.src <- sapply(fns, function(n)sum(nchar(attr(get(n),"source")))))

   The decimal point is 3 digit(s) to the right of the |
  
    0 | 00000000000000000000000000000000000000000000000000000000000000000000+980
    1 | 00000000000112222233333333334444555555666667777778888899
    2 | 00000012333334444555556666777788899
    3 | 12234477
    4 | 15669
    5 | 34
    6 | 
    7 | 35
    8 | 
    9 | 
   10 | 2
		(guess *which* is the  outlier  ;-)

  > sum(len.src)
  [1] 359964

i.e., only ~360'000 characters.

Now compare this with  survival5 which was scoring pretty high above :

  > library(survival5, keep.source = TRUE)
  > length(ob <- ls(pos= match("package:survival5",search()), all.nam = TRUE))
  [1] 117
  > length(fns <- ob[sapply(ob, function(n)is.function(get(n)))])
  [1] 116
  > stem(len.src <- sapply(fns, function(n)sum(nchar(attr(get(n),"source")))))

    The decimal point is 3 digit(s) to the right of the |

     0 | 00000000011111111111111112222222233344444455555789
     1 | 0001122334445567777899
     2 | 0001134555555789
     3 | 02233445567
     4 | 12368
     5 | 2478
     6 | 14799
     7 | 
     8 | 0
     9 | 
    10 | 
    11 | 
    12 | 
    13 | 
    14 | 
    15 | 4
    16 | 
    17 | 3

  > sum(len.src)
  [1] 235633

i.e.  about 2/3 of "base".

(but then base has "source" attributes for much more objects)
Very crude extrapolation would mean that turning off the "keep.source" for
"base" would save about 1.5 MBytes of RAM {I'd guess even more..}

After all this testing, I think what we really want is
"keep.source = FALSE" (including for "base" !)
WHEN working with large data, working on smallish machines,
    or for all "batch" processing.

Hence I'd propose

1.  
  options(keep.source = interactive())

  in the default profile

2. {as proposed earlier today -- see below}

  provide a command line option to turn it on or off.
------------

    PD> The real question is whether we want to have a different mechanism
    PD> for controlling whether keep.source is set or not. 

    MM> right.

    PD> Originally it was FALSE for the base library to save space, and
    PD> according the same setting was used for other libraries since some
    PD> of them are rather large, but later it got flipped to TRUE for
    PD> base,
    MM> (yes, I'm still wondering...)
    PD> and then there is little point in setting it FALSE for packages. 
    PD> Question is whether anyone would want the old behaviour
    PD> back to get more space for analyses?

  would be nice if it *was* configurable for base as well;
  possibly both via cmd line option
  (something like --keepsource / --no-keepsource )
  and a setting in Rprofile..

  MM> From grepping through the source code, I don't see how it was turned off
  MM> for base...

 anyone [R-core] ?

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Apr 28 17:23:51 2000
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 28 Apr 2000 18:23:51 +0200 (CEST)
Subject: [Rd] Rd files with multiple functions?
In-Reply-To: <3909B5F8.70004B7@bank-banque-canada.ca>
References: <3909B5F8.70004B7@bank-banque-canada.ca>
Message-ID: <14601.47895.555375.853908@lynne.ethz.ch>

>>>>> "PaulG" == Paul Gilbert <pgilbert@bank-banque-canada.ca> writes:

    PaulG> There was at one time some discussion about supporting
    PaulG> documentation of multiple functions in one Rd file. Is that
    PaulG> supported or still in the plans?

This "happens all the time". 
It's even recommended in some cases (however people `fight' *which* cases ..). 

Just make sure to have an \alias{} *and* a usage line (but just one
\usage{}) for each function.  
For an example, see      src/library/base/man/lm.Rd

Martin
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Fri Apr 28 17:51:37 2000
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Fri, 28 Apr 2000 12:51:37 -0400
Subject: [Rd] Rd files with multiple functions?
References: <3909B5F8.70004B7@bank-banque-canada.ca> <14601.47895.555375.853908@lynne.ethz.ch>
Message-ID: <3909C199.AF669A43@bank-banque-canada.ca>

>This "happens all the time".
>It's even recommended in some cases (however people `fight' *which* cases ..).
...
>For an example, see      src/library/base/man/lm.Rd

In my version of R src/library/base/man/lm.Rd just has one \name{}  with
multiple \alias{}s.
What I meant was truely different functions (all the functions in a package) so
there would be multiple \name{} lines in the file. Is that possible?

>Just make sure to have an \alias{} *and* a usage line (but just one
>\usage{}) for each function.

BTW
As of yesterday's R-devel snapshot Kurt fixed R CMD build to check for just one
usage, which is a nice feature.

Paul Gilbert

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Prof Brian Ripley <ripley@stats.ox.ac.uk>  Fri Apr 28 17:57:58 2000
From: Prof Brian Ripley <ripley@stats.ox.ac.uk> (Prof Brian Ripley)
Date: Fri, 28 Apr 2000 17:57:58 +0100 (BST)
Subject: [Rd] Rd files with multiple functions?
Message-ID: <200004281657.RAA01123@toucan.stats.ox.ac.uk>


> Date: Fri, 28 Apr 2000 12:51:37 -0400
> From: Paul Gilbert <pgilbert@bank-banque-canada.ca>
> To: Martin Maechler <maechler@stat.math.ethz.ch>, Douglas Bates 
<bates@stat.wisc.edu>
> CC: R-devel <R-devel@stat.math.ethz.ch>
> Subject: Re: [Rd] Rd files with multiple functions?
> 
> >This "happens all the time".
> >It's even recommended in some cases (however people `fight' *which* cases 
..).
> ...
> >For an example, see      src/library/base/man/lm.Rd
> 
> In my version of R src/library/base/man/lm.Rd just has one \name{}  with
> multiple \alias{}s.
> What I meant was truely different functions (all the functions in a package) 
so
> there would be multiple \name{} lines in the file. Is that possible?

No, the \name is the name of the *file*, the \alias'es are the names
of the objects.

Use \name for a topic, that is the package name in your example. See
e.g. Poisson.Rd that has \name{Poisson}, but there is no function
Poisson(), and the functions are named as \alias{}es

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Fri Apr 28 18:17:54 2000
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Fri, 28 Apr 2000 19:17:54 +0200 (CEST)
Subject: [Rd] options(keep.source = TRUE) -- also for "library(.)" ?
In-Reply-To: <14601.47654.736464.353659@lynne.ethz.ch>
References: <14600.12274.664989.534291@lynne.ethz.ch>
 <x2d7nblnyq.fsf@blueberry.kubism.ku.dk>
 <14600.15043.86395.259088@lynne.ethz.ch>
 <14601.19271.866855.581704@lynne.ethz.ch>
 <14601.47654.736464.353659@lynne.ethz.ch>
Message-ID: <14601.51138.245606.306428@aragorn.ci.tuwien.ac.at>

>>>>> Martin Maechler writes:

> I'm replying to myself once more : [and this gets more and more
> envolved, please "d" if you're not interested ..]

> ...

> After all this testing, I think what we really want is "keep.source =
> FALSE" (including for "base" !)  WHEN working with large data, working
> on smallish machines, or for all "batch" processing.

> Hence I'd propose

> 1.  
>   options(keep.source = interactive())

>   in the default profile

> 2. {as proposed earlier today -- see below}

>   provide a command line option to turn it on or off.

I am not sure whether we really want a command line option.  I'd say we
should keep things as simple as possible.

-k

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Apr 28 18:24:55 2000
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 28 Apr 2000 19:24:55 +0200 (CEST)
Subject: [Rd] "keep.source" changes committed to R-devel
In-Reply-To: <14601.47654.736464.353659@lynne.ethz.ch>
References: <14600.12274.664989.534291@lynne.ethz.ch>
 <x2d7nblnyq.fsf@blueberry.kubism.ku.dk>
 <14600.15043.86395.259088@lynne.ethz.ch>
 <14601.19271.866855.581704@lynne.ethz.ch>
 <14601.47654.736464.353659@lynne.ethz.ch>
Message-ID: <14601.51559.135470.386006@lynne.ethz.ch>

These are the NEWS entries

    o	library(), require(), and sys.source() have a new argument
	` keep.source = getOption("keep.source") '.
	Hence, by default, functions from all packages (not just base)
	`keep their source'

    o	The "keep.source" option now defaults to interactive() instead of TRUE.


Note that this (the 2nd one!) speeded up  "make check" a bit (about 1-2 %).

What is *not* yet working is
     "keep.source = FALSE  having an effect on the functions in base.

Martin

PS:
 to get this latest "R-devel snapshot", either 
 use "rsync" (used to be updated hourly), or anonymous "cvs" (updated daily
 to cvs.r-project.org
 or FTP in about 8 hours from  ftp://stat.ethz.ch/Software/R/R-devel.tar.gz
 or get it from the CRAN mirrors  a few more hours later ...)
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Fri Apr 28 18:40:46 2000
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Fri, 28 Apr 2000 13:40:46 -0400
Subject: [Rd] Rd files with multiple functions?
References: <200004281657.RAA01123@toucan.stats.ox.ac.uk>
Message-ID: <3909CD1D.25E3A964@bank-banque-canada.ca>

I guess I'm using the wrong terminology, and also getting confused because \name
seems to mean both "topic" and "file".

Let me ask the broader question. What I would like to do is keep all my
documentation for a package in one file because this makes searching and editing
simpler (in the same way that I keep all the code in one .R file). I still end
up with a fairly large number of files since there are many packages involved,
but it's only a dozen or so, not hundreds. What I have been doing is keeping it
this way and then using a script to parse the file into multiple .Rd files which
I put in the man directory. Each of these files is a topic and has one \name
line. My question is: Is it still necessary for me to parse the file, or is that
being supported by R now?

Thanks,
Paul Gilbert

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From kjetil.kjernsmo@astro.uio.no  Fri Apr 28 19:07:30 2000
From: kjetil.kjernsmo@astro.uio.no (Kjetil Kjernsmo)
Date: Fri, 28 Apr 2000 20:07:30 +0200 (MET DST)
Subject: [Rd] Writing lgrindefs
In-Reply-To: <3908612A.95CC5F8F@statistik.uni-dortmund.de>
Message-ID: <Pine.OSF.4.05.10004282004340.11560-100000@rukbat.uio.no>

On Thu, 27 Apr 2000, Uwe Ligges wrote:

>Suggestions:
>1)
>Another way is to write a R function, that generates "nice" TeX code.
>Or a R function, that generates code to be interpreted by a TeX macro.
>Such a function would know about loaded packages and their functions,
>user specific functions, other objects in the users environment (as
>needed).
>
>2)
>Providing names of functions of the most used packages (e.g. base,
>ctest, ts, ...) would be enough, if the user could easily extend the
>list of "known" functions (or other objects).
>I think about a TeX command (defined in your macro), that could be used
>as follows:
> \addrfunctionnames{myfunc1, myfunc2, myfunc3}

Both your suggestions are interesting, and should receive some attention I
guess. The good thing about lgrind is that it is in fairly common use, and
that definitions for many languages allready exist. When the time of
generating LaTeX code for my thesis approaches, I think I'll try to find a
newsgroup and ask about a few details.

Best,

Kjetil
-- 
Kjetil Kjernsmo
Graduate astronomy-student                    Problems worthy of attack
University of Oslo, Norway            Prove their worth by hitting back
E-mail: kjetikj@astro.uio.no                                - Piet Hein
Homepage <URL:http://www.astro.uio.no/~kjetikj/>
Webmaster@skepsis.no 

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Sun Apr 30 16:40:26 2000
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Sun, 30 Apr 2000 17:40:26 +0200 (CEST)
Subject: [Rd] Rd files with multiple functions?
In-Reply-To: <3909CD1D.25E3A964@bank-banque-canada.ca>
References: <200004281657.RAA01123@toucan.stats.ox.ac.uk>
 <3909CD1D.25E3A964@bank-banque-canada.ca>
Message-ID: <14604.21482.220633.89296@aragorn.ci.tuwien.ac.at>

>>>>> Paul Gilbert writes:

> I guess I'm using the wrong terminology, and also getting confused
> because \name seems to mean both "topic" and "file".

> Let me ask the broader question. What I would like to do is keep all
> my documentation for a package in one file because this makes
> searching and editing simpler (in the same way that I keep all the
> code in one .R file). I still end up with a fairly large number of
> files since there are many packages involved, but it's only a dozen or
> so, not hundreds. What I have been doing is keeping it this way and
> then using a script to parse the file into multiple .Rd files which I
> put in the man directory. Each of these files is a topic and has one
> \name line. My question is: Is it still necessary for me to parse the
> file, or is that being supported by R now?

It is not supported.

Re terminology. `topic' is really anything that documentation is given
for (such as an R object, a concept, etc ...).  That's also why the
argument in help() is called `topic'.  One declares the topics a file
(documentation object) provides documentation for using the \alias
statements (which maybe should be called \topic then ...)

(So, `each of these files is a topic' may be misleading ...)

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From kjetikj@astro.uio.no  Sun Apr 30 20:01:04 2000
From: kjetikj@astro.uio.no (kjetikj@astro.uio.no)
Date: Sun, 30 Apr 2000 21:01:04 +0200 (MET DST)
Subject: [Rd] rpois hangs (PR#530)
Message-ID: <200004301901.VAA28610@pubhealth.ku.dk>

Full_Name: Kjetil Kjernsmo
Version: Version 1.0.0
OS: osf1
Submission from: (NULL) (129.240.28.227)


Dear all,

I have come across another really strange bug in rpois.
If I do
> rpois(1, 1000000 * rpois(1, 10000))
sometimes it hangs, and hangs...
On my XP1000 alphaev6 workstation, it seems to happen more 
frequently than on other machines. I started a session on an older 
computer, and from the start, it looks like this:
> rpois(1, 1000000 * rpois(1, 10000))
[1] 1537190728
> ^[[A
Error: syntax error [whoops, I'm usually using ESS]
> rpois(1, 1000000 * rpois(1, 10000))
[1] 1507263999
> rpois(1000, 1000000 * rpois(1000, 10000))          
[hanged here, killed with ^C]

> rpois(1, 1000000 * rpois(1, 10000))
[1] 1463075843
> rpois(1, 1000000 * rpois(1, 10000))
[1] 1438068697
> rpois(1, 1000000 * rpois(1, 10000))
[hanging]

I think this is strange, because I've been doing this stuff 
a lot lately, but usually with a rather small parameter to the 
second rpois.  

Kjetil

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Sun Apr 30 20:41:36 2000
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 30 Apr 2000 21:41:36 +0200
Subject: [Rd] rpois hangs (PR#530)
In-Reply-To: kjetikj@astro.uio.no's message of "Sun, 30 Apr 2000 21:01:04 +0200 (MET DST)"
References: <200004301901.VAA28610@pubhealth.ku.dk>
Message-ID: <x2ya5vcr67.fsf@blueberry.kubism.ku.dk>

kjetikj@astro.uio.no writes:

> I have come across another really strange bug in rpois.
> If I do
> > rpois(1, 1000000 * rpois(1, 10000))
> sometimes it hangs, and hangs...
> On my XP1000 alphaev6 workstation, it seems to happen more 
> frequently than on other machines. I started a session on an older 
........
> > rpois(1, 1000000 * rpois(1, 10000))
> [hanging]
> 
> I think this is strange, because I've been doing this stuff 
> a lot lately, but usually with a rather small parameter to the 
> second rpois.  

On Intel, that consistently gives

>  rpois(1, 1000000 * rpois(1, 10000))
[1] -2147483648

I.e. signs of integer overflow. Apparently you partly get away with it
on a 64 bit machine, but I'm not surprised you get into regimes that
are not well tested by the poor developers working on hardware from
the bygone millennium....

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From kjetil.kjernsmo@astro.uio.no  Sun Apr 30 20:57:59 2000
From: kjetil.kjernsmo@astro.uio.no (Kjetil Kjernsmo)
Date: Sun, 30 Apr 2000 21:57:59 +0200 (MET DST)
Subject: [Rd] rpois hangs (PR#530)
In-Reply-To: <x2ya5vcr67.fsf@blueberry.kubism.ku.dk>
Message-ID: <Pine.OSF.4.05.10004302139190.20697-100000@alnair.uio.no>

On 30 Apr 2000, Peter Dalgaard BSA wrote:

>On Intel, that consistently gives
>
>>  rpois(1, 1000000 * rpois(1, 10000))
>[1] -2147483648
>
>I.e. signs of integer overflow.

Aha!

> Apparently you partly get away with it
>on a 64 bit machine, but I'm not surprised you get into regimes that
>are not well tested by the poor developers working on hardware from
>the bygone millennium....

:-) Whaddayamean "bygone", you're speaking to an astronomer here, you
know... :-) Anyway, if I can put my hardware to use, I'd be happy to do
so, just give me some detailed instructions.

Best,

Kjetil
-- 
Kjetil Kjernsmo
Graduate astronomy-student                    Problems worthy of attack
University of Oslo, Norway            Prove their worth by hitting back
E-mail: kjetikj@astro.uio.no                                - Piet Hein
Homepage <URL:http://www.astro.uio.no/~kjetikj/>
Webmaster@skepsis.no 

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From mlapsley@ndirect.co.uk  Sat Apr  1 19:18:09 2000
From: mlapsley@ndirect.co.uk (Michael Lapsley)
Date: Sat, 1 Apr 2000 19:18:09 +0100
Subject: [Rd] Bug ? mine or ? in R core
Message-ID: <20000401191809.A16446@athome.lapsley>

Dear R Gurus,

I would very much appreciate some help with this code snippit
from my RODBC package.

R crashes or exhibits bizarre behaviour when repeatedly fetching
large numbers of rows.

Examples:

> odbcFetchRows(0,max=50000)->xx
> odbcFetchRows(0,max=50000)->xx
> odbcFetchRows(0,max=50000)->xx
> odbcFetchRows(0,max=50000)->xx
> odbcFetchRows(0,max=50000)->xx
3rd arg (table) not of type VECSXP, from R_HashGet
Segmentation fault (core dumped)


> odbcFetchRows(0,max=100000)->xx
> odbcFetchRows(0,max=100000)->xx
Segmentation fault (core dumped)

> odbcFetchRows(0,max=50000)
...
...[49996,] "Some dummy data"
[49997,] "Some dummy data"
[49998,] "Some dummy data"
[49999,] "Some dummy data"
[50000,] "Some dummy data"

$stat
[1] 1

> odbcFetchRows(0,max=50000)
Error in odbcFetchRows(0, max = 50000) : can not set length of non-vector
> odbcFetchRows(0,max=50000)

[49998,] "Some dummy data"
[49999,] "Some dummy data"
[50000,] "Some dummy data"

$stat
[1] 1

> odbcFetchRows(0,max=50000)
Segmentation fault (core dumped)

(This is using a hacked version that does not actually fetch rows
from the database to save time).

Using the C that I distilled out (see below) to remove all
dependencies on sql/odbc I get something even more bizarre:

> odbcFetchRows(0,max=50000)->xx
> odbcFetchRows(0,max=50000)->xx
> odbcFetchRows(0,max=50000)->xx
Segmentation fault (core dumped)

but

> odbcFetchRows(0,max=25000)->xx
> odbcFetchRows(0,max=25000)->xx
> odbcFetchRows(0,max=25000)->xx
> odbcFetchRows(0,max=25000)->xx
Error: corrupted options list
Error: corrupted options list
Error: corrupted options list
Error: corrupted options list
Error: corrupted options list
Error: corrupted options list
Error: corrupted options list
Error: corrupted options list
.....
(endless loop needing killing)

I have stared at this for ages and cannot see the bug?  Is it me
or is there a problem in garbage collection or elsewhere?

Thanks in advance for any enlightenment.


Michael

-----------------------------------------------------------------

/* RODBC low level interface : crash function
 *
 * crash.c
 *
 */
#include <stdio.h>
#include <sys/types.h>
#include <fcntl.h>
#include <stdlib.h>


#include <Rinternals.h>
#include <Rdefines.h>


#define DBG(x,y) if(debug >= x) printf("%s\n",y)

/*******************************************************************************/
/* Replacement callee for odbcFetchRows to demonstate bug.                     */
/* Independant of sql/odbc                                                     */
/* Compile with                                                                */
/* cc -g  -Wall -I/usr/local/src/R-1.0.0/include/  -o crash.o -c crash.c       */
/* gcc -shared -g -Wall      -o crash.so  crash.o                              */
/* mv crash.so /usr/local/src/R-1.0.0/library/RODBC/libs/RODBC.so              */
/* then                                                                        */
/* $R -q                                                                       */
/* >library(RODBC)                                                             */
/* >odbcFetchRows(0,max=50000)                                                 */
/* and repeat till crashes.                                                    */
/*                                                                             */
/* Note that the loop will never exit unless max is specified.                 */
/*                                                                             */
/* Designed to work with RODBC-0.6.1a                                          */
/* Caller looks like:                                                          */
/*                                                                             */
/* "odbcFetchRows"<-                                                           */
/* function(channel,max=0,transposing=F,buffsize=1000,debug=0)                 */
/* {                                                                           */
/*         erg<-.Call("RODBCFetchRows",as.integer(channel),max=as.real(max),   */
/*                         transposing=as.logical(transposing),                */
/*                         buffsize=as.real(buffsize),debug=as.integer(debug)) */
/*         return(erg)                                                         */
/*         }                                                                   */
/*                                                                             */
/*                                                                             */
/*******************************************************************************/
SEXP RODBCFetchRows(SEXP sock,SEXP max,SEXP tx,SEXP bs,SEXP dbg)
{
SEXP data,t_data,names,ans,stat,dim;
int 	status=1,
	i,				/* col counter */
	NCOLS,
	channel=INTEGER(sock)[0],	/* not used here */
	debug=INTEGER(dbg)[0],
	transposing=(int)LOGICAL(tx)[0];	/*true if transposing, not used here*/

long maximum=(long)REAL(max)[0];

long 	j=1,k=1,			/* row counters*/
	buffsize=(long)REAL(bs)[0],	/* prealloc if row count NA*/
	length,offset,t_offset;		/* counts into output buf*/


NCOLS=1;
PROTECT(ans=NEW_LIST(2)); /*create answer [0] = data, [1]=stat */
PROTECT(stat=NEW_INTEGER(1)); /* numeric status vector */
PROTECT(data=NEW_CHARACTER(buffsize));
while(1){
	for (i=1; i<= NCOLS; i++){
			offset=((i-1)*maximum)+(j-1);
		}
	  DBG(2,"writing to data");
	  STRING(data)[offset]=COPY_TO_USER_STRING("Some dummy data");
		if(offset +NCOLS >= buffsize){
			DBG(1,"reallocating space");
			length=length(data);
			buffsize=length+buffsize;
			SET_LENGTH(data,buffsize);
		}
	j++;
	if(maximum && j>maximum)
		break;
}	

/* transpose it */
DBG(1,"trimming");
SET_LENGTH(data,j*NCOLS); /* trim down buffer*/

INTEGER(stat)[0]=status;
PROTECT(dim=NEW_INTEGER(2));


INTEGER(dim)[1]=NCOLS;
INTEGER(dim)[0]=length(data)/NCOLS;


DBG(2,"writing dim to data");
SET_DIM(data,dim);
DBG(2,"writing to ans 0");
VECTOR(ans)[0]=data;
DBG(2,"writing to ans 1");
VECTOR(ans)[1]=stat;
DBG(3,"protecting names");
PROTECT(names=NEW_CHARACTER(2));                                  
DBG(2,"writing to names 0");
STRING(names)[0]=COPY_TO_USER_STRING("data");                    
DBG(2,"writing to names 1");
STRING(names)[1]=COPY_TO_USER_STRING("stat");                   
DBG(2,"writing to ans");
SET_NAMES(ans,names);                                          
UNPROTECT(5);
return ans;
}

/****************************************/
/* Just a dummy to allow library(RODBC) */
/****************************************/
void RODBCInit()
{
}
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Sat Apr  1 19:31:42 2000
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 01 Apr 2000 20:31:42 +0200
Subject: [Rd] Bug ? mine or ? in R core
In-Reply-To: Michael Lapsley's message of "Sat, 1 Apr 2000 19:18:09 +0100"
References: <20000401191809.A16446@athome.lapsley>
Message-ID: <x2bt3tsmep.fsf@blueberry.kubism.ku.dk>

Michael Lapsley <mlapsley@ndirect.co.uk> writes:

[Crashes with the following code]

> PROTECT(ans=NEW_LIST(2)); /*create answer [0] = data, [1]=stat */
> PROTECT(stat=NEW_INTEGER(1)); /* numeric status vector */
> PROTECT(data=NEW_CHARACTER(buffsize));
> while(1){
> 	for (i=1; i<= NCOLS; i++){
> 			offset=((i-1)*maximum)+(j-1);
> 		}
> 	  DBG(2,"writing to data");
> 	  STRING(data)[offset]=COPY_TO_USER_STRING("Some dummy data");
> 		if(offset +NCOLS >= buffsize){
> 			DBG(1,"reallocating space");
> 			length=length(data);
> 			buffsize=length+buffsize;
> 			SET_LENGTH(data,buffsize);
                        ^^^^^^^^^^^^^^^^^^^^^^^^^
> 		}
> 	j++;
> 	if(maximum && j>maximum)
> 		break;
> }	
> 
> /* transpose it */
> DBG(1,"trimming");
> SET_LENGTH(data,j*NCOLS); /* trim down buffer*/
  ^^^^^^^^^^^^^^^^^^^^^^^^

I'm not too well accustomed to these macros (they aren't used in the R
internals), but in Rdefines.h we have

#define SET_LENGTH(x, n)       (x = lengthgets(x, n))

so I wouldn't count on "data" being the same after those operations,
and in particular not expect it to be protected anymore. You probably
need to stick in "UNPROTECT(1); PROTECT(data);" after the SET_LENGTH
operations.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From mlapsley@ndirect.co.uk  Sun Apr  2 00:28:21 2000
From: mlapsley@ndirect.co.uk (Michael Lapsley)
Date: Sun, 2 Apr 2000 00:28:21 +0100
Subject: [Rd] Bug ? mine or ? in R core
In-Reply-To: <x2bt3tsmep.fsf@blueberry.kubism.ku.dk>
References: <20000401191809.A16446@athome.lapsley> <x2bt3tsmep.fsf@blueberry.kubism.ku.dk>
Message-ID: <20000402002821.A16858@athome.lapsley>


Thanks, Peter, it seems to do the trick.  I spent a lot of
time trying first to reproduce then identify this one!

What is the 'approved' method of resizing a vector?
Is SET_LENGTH deprecated, or does it just happen that there is
no need for it in tht R internals?


Michael

On Sat, Apr 01, 2000 at 08:31:42PM +0200, Peter Dalgaard BSA wrote:
> > /* transpose it */
> > DBG(1,"trimming");
> > SET_LENGTH(data,j*NCOLS); /* trim down buffer*/
>   ^^^^^^^^^^^^^^^^^^^^^^^^
> 
> I'm not too well accustomed to these macros (they aren't used in the R
> internals), but in Rdefines.h we have
> 
> #define SET_LENGTH(x, n)       (x = lengthgets(x, n))
> 
> so I wouldn't count on "data" being the same after those operations,
> and in particular not expect it to be protected anymore. You probably
> need to stick in "UNPROTECT(1); PROTECT(data);" after the SET_LENGTH
> operations.
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Sun Apr  2 00:36:20 2000
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 02 Apr 2000 01:36:20 +0200
Subject: [Rd] Bug ? mine or ? in R core
In-Reply-To: Michael Lapsley's message of "Sun, 2 Apr 2000 00:28:21 +0100"
References: <20000401191809.A16446@athome.lapsley> <x2bt3tsmep.fsf@blueberry.kubism.ku.dk> <20000402002821.A16858@athome.lapsley>
Message-ID: <x2k8ih5r7v.fsf@blueberry.kubism.ku.dk>

Michael Lapsley <mlapsley@ndirect.co.uk> writes:

> Thanks, Peter, it seems to do the trick.  I spent a lot of
> time trying first to reproduce then identify this one!

Been there...

> What is the 'approved' method of resizing a vector?
> Is SET_LENGTH deprecated, or does it just happen that there is
> no need for it in tht R internals?

On the contrary! It's the official way. We just don't use it
internally (in the few places where it might be used, we're using
direct calls to realloc()).

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Sun Apr  2 15:31:54 2000
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Sun, 2 Apr 2000 16:31:54 +0200
Subject: [Rd] C++ support
Message-ID: <200004021431.QAA14557@aragorn.ci.tuwien.ac.at>

I will shortly commit a first shot a C++ support for add-on packages (to
r-devel, of course).

For me, installation of a trivial test package (basically consisting of
the example in R-exts) works without problems.  I'll put the package
into CRAN's src/contrib/Devel for some time.

If anyone knows about platform/compiler specific settings CXXPICFLAGS
settings that configure needs to be taught, pls let me know.

Building shared libs would be based on the following idea: if C++ code
was found, then try using CXX as SHLIBLD (i.e. the C++ compiler for
building the shared library).  Alternatively, one would need to find out
what C++ is linked against, which may be a pain.  Anyway, I thought I'd
collect some feedback and then maybe come up with something refined.

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From maechler@stat.math.ethz.ch  Mon Apr  3 13:37:43 2000
From: maechler@stat.math.ethz.ch (maechler@stat.math.ethz.ch)
Date: Mon, 3 Apr 2000 14:37:43 +0200 (MET DST)
Subject: [Rd] another save/load problem, only(?) affecting ascii = TRUE (PR#507)
Message-ID: <200004031237.OAA25910@pubhealth.ku.dk>

On all current R versions, afaik:

When using  save(....., ascii = TRUE),
the resulting file is not always readable by load(.).

The following is executable R code
exhibiting two (slightly different) examples
of which I have seen even more [~/R/MISC/saveload-bug.R]:

### BUG :  save(..., ascii = TRUE)  produces load() -  unreadable files :

tstf1 <- function(n = 500)
{
    ## Purpose:
    ## -----------------------------------------------------------------------
    ## Author: Martin Maechler, Date: 29 Mar 2000, 15:40
    ## -----------------------------------------------------------------------
    n2 <- n %/% 2
    nk <- n2 * 4
    CPU <- numeric(n)
    ## -----------------------------------------------------------------------
    for(i in 1:n) { ## just a simple pseudo loop
        n <- n*nk
        CPU[i] <- i^n
    }
    CPU
}

tstf2 <- function(n = 500)
{
    ## Author: Martin Maechler, Date: 1 Apr 2000, 15:40
    n %/% 2
}

save(tstf1, file="foo1",ascii=TRUE); load(file="foo1")
## Error in load(file = "foo1") : NewReadItem: unknown type -1073749696
save(tstf2, file="foo2",ascii=TRUE); load(file="foo2")
## Error in load(file = "foo2") : NewReadItem: unknown type 92

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Mon Apr  3 16:09:35 2000
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 03 Apr 2000 17:09:35 +0200
Subject: [Rd] another save/load problem, only(?) affecting ascii = TRUE (PR#507)
In-Reply-To: maechler@stat.math.ethz.ch's message of "Mon, 3 Apr 2000 14:37:43 +0200 (MET DST)"
References: <200004031237.OAA25910@pubhealth.ku.dk>
Message-ID: <x2ya6vte4w.fsf@blueberry.kubism.ku.dk>

maechler@stat.math.ethz.ch writes:

> tstf2 <- function(n = 500)
> {
>     ## Author: Martin Maechler, Date: 1 Apr 2000, 15:40
>     n %/% 2
> }
> 
> save(tstf1, file="foo1",ascii=TRUE); load(file="foo1")
> ## Error in load(file = "foo1") : NewReadItem: unknown type -1073749696
> save(tstf2, file="foo2",ascii=TRUE); load(file="foo2")
> ## Error in load(file = "foo2") : NewReadItem: unknown type 92

Squished (I think). Problem was that nonprinting characters (incl. the
Space character) were printed in octal using %o format in
OutStringAscii. That should be %.3o to ensure that exactly three octal
digits get printed. Otherwise we're in trouble every time a digit
follows a space. 

I kind of suspect that there's really no reason to escape spaces like
that, but we'd have the same problem with other unprintables.

The $ffff question is whether %.3o is guaranteed to work on all
platforms.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From koller2@fgr.wu-wien.ac.at  Mon Apr  3 17:21:13 2000
From: koller2@fgr.wu-wien.ac.at (Wolfgang Koller)
Date: Mon, 03 Apr 2000 18:21:13 +0200
Subject: [Rd] window(): feature request
Message-ID: <3.0.6.32.20000403182113.008f1bf0@fgr.wu-wien.ac.at>

Dear R-developpers,

currently the function window shows the following behaviour, if start or
end is out of range:

> x <- ts(1:14,start=c(1950,2),frequency=4)
> y <- window(x,start=c(1950,1),end=c(1953,4))
Warning messages: 
1: start value not changed in: window.default(x, ...) 
2: end value not changed in: window.default(x, ...) 

Instead of this I would like it to fill with NAs the values before start(x)
and after end(x). Could this be done by introducing an additional option in
window()? Could you please consider this in future releases? Or is there a
better way to do this using existing functions?
 
Thanks very much! 

Wolfgang Koller

P.S.: Below I have added some code that accomplishes this aim in a separate
function (which is probably an example of akward programming...).

sloppywindow <- function(x,start,end) {
  if (!is.ts(x) || (NCOL(x) > 1)) 
     stop("x is not a univariate time series") # does not work for frames
  xfrequ <- frequency(x)
  n <- length(x)

  time.start <- if (length(start) > 1) {
     if(start[2] > xfrequ) stop("invalid start")
     start[1] + (start[2] - 1)/xfrequ
  } else start

  time.end <- if (length(end) > 1) {
     if(end[2] > xfrequ) stop("invalid end")
     end[1] + (end[2] - 1)/xfrequ
  } else end

  if(time.start > time.end)
        stop("start cannot be after end")
  
  before <- round( (time(x)[1] - time.start) * xfrequ)
  before.NAs <- if (before > 0) rep(NA,before) else NULL
  after <- round( (time.end - time(x)[n] ) * xfrequ)
  after.NAs <- if (after > 0) rep(NA,after) else NULL
   
  first.start <- if (before > 0) start else start(x)
  x <- ts(c(before.NAs,x,after.NAs),start=first.start,frequency=xfrequ)  
  return(window(x,start,end))
}


-------------------------------------------------
Wolfgang Koller,  koller2@fgr.wu-wien.ac.at
Forschungsinstitut für Europafragen
Wirtschaftsuniversitaet Wien
Althanstrasse 39-45, 1090 Vienna, Austria
http://fgr.wu-wien.ac.at/institut/ef/ief-home.htm
-------------------------------------------------
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From koller2@fgr.wu-wien.ac.at  Mon Apr  3 19:08:12 2000
From: koller2@fgr.wu-wien.ac.at (koller2@fgr.wu-wien.ac.at)
Date: Mon, 3 Apr 2000 20:08:12 +0200 (MET DST)
Subject: [Rd] cbind.ts(),ts.union() (PR#508)
Message-ID: <200004031808.UAA29180@pubhealth.ku.dk>

Full_Name: Wolfgang Koller
Version: 1.0.0
OS: linux 
Submission from: (NULL) (137.208.7.48)


> data(UKLungDeaths)
> ts.union(mdeaths, fdeaths,dframe=TRUE)
Error in names<-.default(*tmp*, value = nmsers) : 
        names attribute must be the same length as the vector
> cbind(mdeaths, fdeaths,dframe=TRUE)
Error in names<-.default(*tmp*, value = nmsers) : 
        names attribute must be the same length as the vector

should not give an error

BR#239--241

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Mon Apr  3 20:56:21 2000
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Mon, 3 Apr 2000 20:56:21 +0100 (BST)
Subject: [Rd] cbind.ts(),ts.union() (PR#508)
In-Reply-To: <200004031808.UAA29180@pubhealth.ku.dk>
Message-ID: <Pine.GSO.4.05.10004032053370.14448-100000@auk.stats>

On Mon, 3 Apr 2000 koller2@fgr.wu-wien.ac.at wrote:

> Full_Name: Wolfgang Koller
> Version: 1.0.0
> OS: linux 
> Submission from: (NULL) (137.208.7.48)
> 
> 
> > data(UKLungDeaths)
> > ts.union(mdeaths, fdeaths,dframe=TRUE)
> Error in names<-.default(*tmp*, value = nmsers) : 
>         names attribute must be the same length as the vector
> > cbind(mdeaths, fdeaths,dframe=TRUE)
> Error in names<-.default(*tmp*, value = nmsers) : 
>         names attribute must be the same length as the vector
> 
> should not give an error

Those are the same thing.  Replace

       x <- vector("list", n)
by

       x <- vector("list", nser)

which was not too hard to debug, surely?

> BR#239--241

Eh?  That's beyond me!

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Thomas Vogels <tov@ece.cmu.edu>  Mon Apr  3 21:42:12 2000
From: Thomas Vogels <tov@ece.cmu.edu> (Thomas J Vogels)
Date: 03 Apr 2000 16:42:12 -0400
Subject: [Rd] AIX fails on startup with R-1.0.0
In-Reply-To: Kurt Hornik's message of "Fri, 31 Mar 2000 19:21:21 +0200 (CEST)"
References: <Pine.GSO.4.21.0003181111590.11158-100000@mail.biostat.washington.edu> <871z561pcm.fsf@bavaria.ece.cmu.edu> <14552.57463.552150.382635@aragorn.ci.tuwien.ac.at> <8766uens46.fsf@bavaria.ece.cmu.edu> <14554.25111.847983.270127@aragorn.ci.tuwien.a
Message-ID: <87bt3qj4rf.fsf@bavaria.ece.cmu.edu>


Kurt,

  the saga continues...

> Users of current r-devel snapshots on AIX, can you confirm that
> 
> 	MAINLD=cc SHLIBLD=cc /path/to/configure
> 	make

yes, this compiles cleanly, make check runs without a hiccup.  But
then problems start:

(old) make install fails.  I compile in a build directory to make it
    easier to nuke the compilation tree.  Installation from there fails as
    it can't find $(INSTALL_DATA).
/bin/sh: ../tools/install-sh:  not found.  [repeats six times]

    Here is the excerpt from the Makefile:
        @(cd $(srcdir); \
          for f in $(INSTFILES); do \
-           $(INSTALL_DATA) $${f} $(rhome); \
+           pwd; tools/$(INSTALL_DATA) $${f} $(rhome); \
          done)
    The line with a '-' is the original line.  This will fail because
    of the cd to srcdir.  The line prefixed by '+' works but is a bad
    patch. Since INSTALL_DATA is ../tools/install-sh (forced to be on
    AIX!), would the following work?
        @(for f in $(INSTFILES); do \
            $(INSTALL_DATA) $(srcdir)/$${f} $(rhome); \
          done)

   Somehow, the path to install-sh is not made absolute, as Kurt
   expected.  AIX is/should be one of the platforms where the use of
   the install-sh that comes with R is forced.  But the path to it is
   relative (not absolute) in Makeconf:

$ grep install-sh Makeconf /dev/null
Makeconf:INSTALL = $(top_srcdir)/tools/install-sh -c
$ grep top_srcdir Makefile /dev/null
Makefile:top_srcdir = ..

(old) the file R.exp doesn't get copied into rhome/etc/.  Installation of
   packages with source code may/will fail (AIX specific).  I don't
   know at which step this file should get copied so I can't trace the
   Makefiles to see why it doesn't.

(new) Actually, compilation fails for a different reason.  E.g. for
   date (smallest contrib package I saw): 

Installing package `date' ...
 libs
gcc -I/afs/ece/usr/tov/opt/arch/lib/R/include  -I/usr/local/include -I/afs/ece/usr/tov/opt/share/include -mno-fp-in-toc  -fPIC -g -O2 -c char_date.c -o char_date.o
make: *** No rule to make target `*.o', needed by `/afs/ece/usr/tov/opt/arch/lib/R/library/date/libs/date.so'.  Stop.

    R INSTALL nevertheless proceeds happily with the installation and
    reports DONE.

(old) demo(dyn.load) in an R session will fail as R can't find
   demo.so.  This file doesn't get installed, nor are there
   instructions in the README in demos/dynload on how to compile it.
   (The hint to run "R SHLIB zero.c" would be nice to have in the
   demos/dynload/README.) 
   The install target in demos/dynload/Makefile will not copy
   demo.so.  It only copies README, zero.R and zero.c.  

[snip]
> > -- ld/cc doesn't automatically include /usr/local/lib while gcc does.
> > This comes from the sytem installation here and has nothing to do with
> > R.  But having to add LIBS=-L/usr/local/lib may come as a surprise to
> > people who don't do this regularly.
> 
> > Does configure check for the existence of e.g. libz.a with cc or gcc?
> It uses the C compiler specified.
> 
> Well, LIBS is needed when you have things in `non-standard' locations.
> Of course your mileage may vary on the definition of non-standard :-)

> Is there anything I/configure could do about this?  (Note that I don't
> think that unconditionally adding /usr/local/lib to LIBS is a good
> idea.) 

Dunno.  As Brian pointed out in his reply, he has to add
/usr/local/lib also on a Solaris machine.  At the moment, my humble
suggestion would be to add this in the installation instructions.

At the moment, I'm worried about the missing rule for *.o files.  Does
this happen only for me?

Thanks,
  -tom


BTW, this happens with code from this morning:
         _                           
platform powerpc-ibm-aix4.3.2.0      
arch     powerpc                     
os       aix4.3.2.0                  
system   powerpc, aix4.3.2.0         
status   Under development (unstable)
major    1                           
minor    1.0                         
year     2000                        
month    April                       
day      3                           
language R               

-- 
mailto:tov@ece.cmu.edu (Tom Vogels)   Tel: (412) 268-6638   FAX: -3204
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From edd@debian.org  Tue Apr  4 00:23:34 2000
From: edd@debian.org (edd@debian.org)
Date: Tue, 4 Apr 2000 01:23:34 +0200 (MET DST)
Subject: [Rd] write.table with rows and cols (PR#509)
Message-ID: <200004032323.BAA00377@pubhealth.ku.dk>

Full_Name: Dirk Eddelbuettel
Version: 1.0.0 (patched)
OS: Linux
Submission from: (NULL) (192.139.71.69)


A frame with rownames and colnames got properly written, but the colnames
started 
without an offset -- but if the .csv file is read back in, the rownames column
now 
has the header of the first column.  

"Graphically", suppose a frame with two rows 1999 and 2000, and two columns foo
and 
bar, with content equal to the row/col index.

This should be written as

  ,foo,bar
  1999,11,12
  2000,21,22

but was written without the initial ","  (I used "," as the sep).

Am I making sense? 

Anyway, big thanks for R!

Dirk


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Tue Apr  4 07:25:01 2000
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Tue, 4 Apr 2000 07:25:01 +0100 (BST)
Subject: [Rd] write.table with rows and cols (PR#509)
In-Reply-To: <200004032323.BAA00377@pubhealth.ku.dk>
Message-ID: <Pine.GSO.4.05.10004040710030.15113-100000@auk.stats>

On Tue, 4 Apr 2000 edd@debian.org wrote:

> Full_Name: Dirk Eddelbuettel
> Version: 1.0.0 (patched)
> OS: Linux
> Submission from: (NULL) (192.139.71.69)
> 
> 
> A frame with rownames and colnames got properly written, but the colnames
> started 
> without an offset -- but if the .csv file is read back in, the rownames column
> now 
> has the header of the first column.  
> 
> "Graphically", suppose a frame with two rows 1999 and 2000, and two columns foo
> and 
> bar, with content equal to the row/col index.
> 
> This should be written as
> 
>   ,foo,bar
>   1999,11,12
>   2000,21,22
> 
> but was written without the initial ","  (I used "," as the sep).
> 
> Am I making sense? 

In the S convention, the header is regarded as separate, with a potentially
different format from the rest of the file. If I have

auk% cat test.csv
foo,bar
1999,11,12
2000,21,22

then

> read.table("test.csv", sep=",")
     foo bar
1999  11  12
2000  21  22

works, as does test <- read.csv("test.csv"). If I then do

> write.table(test, "test2.csv", sep=",", quote=F)

I get

auk% cat test2.csv
foo,bar
1999,11,12
2000,21,22

as before, so it seems that this is working as expected.  Can you give the
actual example you used that fails?  There are a lot of other things which
can potentially go wrong, including the quote setting (and I had to use
quote=F to approximate the file you quote).

Note that when I read your suggested correction with read.table/read.cvs I
get

    NA foo bar
1 1999  11  12
2 2000  21  22

unless I use read.csv("test2.csv", row.names=1).


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From edd@debian.org  Tue Apr  4 13:34:53 2000
From: edd@debian.org (Dirk Eddelbuettel)
Date: Tue, 4 Apr 2000 08:34:53 -0400
Subject: [Rd] write.table with rows and cols (PR#509)
In-Reply-To: <Pine.GSO.4.05.10004040710030.15113-100000@auk.stats>; from ripley@stats.ox.ac.uk on Tue, Apr 04, 2000 at 07:25:01AM +0100
References: <200004032323.BAA00377@pubhealth.ku.dk> <Pine.GSO.4.05.10004040710030.15113-100000@auk.stats>
Message-ID: <20000404083453.B3373@eddelbuettel.com>


With my head hanging low as this is a non-bug:

On Tue, Apr 04, 2000 at 07:25:01AM +0100, Prof Brian D Ripley wrote:
> On Tue, 4 Apr 2000 edd@debian.org wrote:
[...]
> > A frame with rownames and colnames got properly written, but the colnames
> > started 
> > without an offset -- but if the .csv file is read back in, the rownames column
> > now 
> > has the header of the first column.  
[...]

> In the S convention, the header is regarded as separate, with a potentially
> different format from the rest of the file. If I have

Ahh. Shows once again that I am still a novice when it comes to S (and R).
You are of course correct -- re-reading works just fine as expected. No bug
here.

But maybe the (extremely low-priority) need for new semantics -- I actually
only wrote the file to pass data on to my Excel using collegues at work, and
for them the csv _is_ wrong as the 'Dates' column (build from rownames) is
headerless, and the other headers are "shifted".  Having to hand-edit the
file for them is silly. 

Thanks,  Dirk

-- 
According to the latest figures, 43% of all statistics are totally worthless.
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Wed Apr  5 07:30:57 2000
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 5 Apr 2000 08:30:57 +0200
Subject: [Rd] R CMD build
In-Reply-To: <Pine.GSO.4.05.10003300709540.23994-100000@auk.stats>
References: <38E26279.BC2A6400@bank-banque-canada.ca>
 <Pine.GSO.4.05.10003300709540.23994-100000@auk.stats>
Message-ID: <200004050630.IAA16129@aragorn.ci.tuwien.ac.at>

>>>>> Prof Brian D Ripley writes:

> On Wed, 29 Mar 2000, Paul Gilbert wrote:
>> >Well, are there \alias entries in the Rd files?
>> No. I guess that would be it. Should I have an empty \alias entry if the
>> object does not have an alias, or should should I just live with the
>> warnings?

> You should have an alias for each function documented there, even if
> there is only one. The object name is itself an alias.  The \name
> field is the help file name, not the object name (although 90+% of
> them are the same), and it is the \alias's that gives the object
> names,

(Not sure about the 90+ percent :-))

>> >The convention is to put a \alias for the method in the help file for
>> the generic.
>> Ok, but I guess this won't work if the generic is the base and my method
>> is in my library?

> Sure (and that is part of the debate). Either ignore them, or have a
> .Rd with just a very brief description of these (e.g. just their
> usages).

>> >> 4/ Checking for undocumented objects fails with an ERROR when
>> checking
>> >> an (undocumented) assignment object ( "input.series.names<-" ).
>> >I think it works if you document it, though, and the error is correct,
>> >surely?  Do you mean it gives ERROR and then stops rather than warns?
>> 
>> Yes, it should warn me about this, but it gives ERROR and stops. (If I
>> run it with my makefile it returns code 1.) The message is:
>> in eval(expr, envir, enclos) : couldn't find function
>> "input.series.names<-"

> Looks like a bug, then.

Hmm.  Can you (Paul) perhaps give a small example I could reproduce?  I
just tried the following:  let the R code contain 

	"foo<-" <- function(x, value) NULL

Then if an Rd file has \alias{foo<-}, everything is o.k., if not,
"foo<-" is shows as undoc object.  How do you get the error?

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Wed Apr  5 07:40:25 2000
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Wed, 5 Apr 2000 07:40:25 +0100 (BST)
Subject: [Rd] R CMD build
In-Reply-To: <200004050630.IAA16129@aragorn.ci.tuwien.ac.at>
Message-ID: <Pine.GSO.4.05.10004050738240.21288-100000@auk.stats>

On Wed, 5 Apr 2000, Kurt Hornik wrote:

> >>>>> Prof Brian D Ripley writes:
> 
> > On Wed, 29 Mar 2000, Paul Gilbert wrote:
> >> >Well, are there \alias entries in the Rd files?
> >> No. I guess that would be it. Should I have an empty \alias entry if the
> >> object does not have an alias, or should should I just live with the
> >> warnings?
> 
> > You should have an alias for each function documented there, even if
> > there is only one. The object name is itself an alias.  The \name
> > field is the help file name, not the object name (although 90+% of
> > them are the same), and it is the \alias's that gives the object
> > names,
> 
> (Not sure about the 90+ percent :-))

Last time I looked there were about 20 exceptions in the whole of base R,
out of ca 700 files.

> 
> >> >The convention is to put a \alias for the method in the help file for
> >> the generic.
> >> Ok, but I guess this won't work if the generic is the base and my method
> >> is in my library?
> 
> > Sure (and that is part of the debate). Either ignore them, or have a
> > .Rd with just a very brief description of these (e.g. just their
> > usages).
> 
> >> >> 4/ Checking for undocumented objects fails with an ERROR when
> >> checking
> >> >> an (undocumented) assignment object ( "input.series.names<-" ).
> >> >I think it works if you document it, though, and the error is correct,
> >> >surely?  Do you mean it gives ERROR and then stops rather than warns?
> >> 
> >> Yes, it should warn me about this, but it gives ERROR and stops. (If I
> >> run it with my makefile it returns code 1.) The message is:
> >> in eval(expr, envir, enclos) : couldn't find function
> >> "input.series.names<-"
> 
> > Looks like a bug, then.
> 
> Hmm.  Can you (Paul) perhaps give a small example I could reproduce?  I
> just tried the following:  let the R code contain 
> 
> 	"foo<-" <- function(x, value) NULL
> 
> Then if an Rd file has \alias{foo<-}, everything is o.k., if not,
> "foo<-" is shows as undoc object.  How do you get the error?

That (and "input.series.names<-") work for me on Solaris, too.


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From marggie24@guelmail.com  Wed Apr  5 18:07:58 2000
From: marggie24@guelmail.com (marggie24@guelmail.com)
Date: Wed, 05 Apr 2000 17:07:58
Subject: [Rd] People with pain
Message-ID: <zfjle5ynj4hlb58.050420001707@localhost>

ARE YOU LOOKING FOR THE PERFECT BUSINESS VENTURE?

Unique product, sold in the multinational market for the last 16 years!

Only available for the last four years in the US!

One initial product purchase required to qualify for commissions!
This means no monthly qualification!

Enthusiastic testimonials from health professionals, athletes, people with chronic
pain, insomnia, circulation problems, who are using this product daily!

Immediate relief felt that continues to improve your comfort the more you use it!

Commissions paid monthly at 10 to 40% with the addition of car bonus, travel bonus and profit sharing for leadership level! Over ride profits of 1-30% on your downline
leadership groups!  Business builders compress up to become your active legs!

Invest a few minutes of your time to respond to this message by emailing

<A HREF="networks@fiberia.com">

and requesting information  or call our voice mail at
888-818-0944  for a personal return call!

We look forward to hearing from you!
***************************************************

We are terribly sorry if you received this message in error.
If you wish to be removed, please type REMOVE in the subjuct line.
ler@fiberia.com      Thank you.
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From marggie24@guelmail.com  Wed Apr  5 19:05:30 2000
From: marggie24@guelmail.com (marggie24@guelmail.com)
Date: Wed, 05 Apr 2000 18:05:30
Subject: [Rd] Live long and prosper
Message-ID: <ecl1s6skim5puq4.050420001805@localhost>

ARE YOU LOOKING FOR THE PERFECT BUSINESS VENTURE?

Unique product, sold in the multinational market for the last 16 years!

Only available for the last four years in the US!

One initial product purchase required to qualify for commissions!
This means no monthly qualification!

Enthusiastic testimonials from health professionals, athletes, people with chronic
pain, insomnia, circulation problems, who are using this product daily!

Immediate relief felt that continues to improve your comfort the more you use it!

Commissions paid monthly at 10 to 40% with the addition of car bonus, travel bonus and profit sharing for leadership level! Over ride profits of 1-30% on your downline
leadership groups!  Business builders compress up to become your active legs!

Invest a few minutes of your time to respond to this message by emailing

<A HREF="networks@fiberia.com">

and requesting information  or call our voice mail at
888-818-0944  for a personal return call!

We look forward to hearing from you!
***************************************************

We are terribly sorry if you received this message in error.
If you wish to be removed, please type REMOVE in the subjuct line.
ler@fiberia.com      Thank you.
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ligges@statistik.uni-dortmund.de  Thu Apr  6 08:28:54 2000
From: ligges@statistik.uni-dortmund.de (Uwe Ligges)
Date: Thu, 06 Apr 2000 09:28:54 +0200
Subject: [Rd] xyz.coords(.)
References: <38DA5007.B0AB5186@statistik.uni-dortmund.de>
 <14555.7873.266935.277408@lynne.ethz.ch>
 <38DD1154.9FF80C75@statistik.uni-dortmund.de> <14559.2458.327647.545328@lynne.ethz.ch>
Message-ID: <38EC3CB6.E1C7BF41@statistik.uni-dortmund.de>

In order to improve scatterplot3d(.), Martin Maechler wrote:

> Maybe you could extend  xy.coord() to xyz.coord(), a function that would be
> useful in a more general context.

If you are interested, have a look at 
http://www.statistik.uni-dortmund.de/leute/ligges.htm
for source and examples of xyz.coords(.).
I only added (changed) some lines to xy.coords(.) of R's base package.

Discussion and comments are welcome.

Best regards,
Uwe Ligges
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From krishnan@nrl.cs.uoregon.edu  Thu Apr  6 15:03:39 2000
From: krishnan@nrl.cs.uoregon.edu (Sivaramakrishna Iyer Krishnan)
Date: Thu, 6 Apr 2000 07:03:39 -0700 (PDT)
Subject: [Rd] Automation of scripts ... reading a file.
Message-ID: <Pine.BSF.3.96.1000406070011.20041E-100000@day.nrl.cs.uoregon.edu>


Hi,

I want to automate a set of scripts that spit out data that are later used
by R to plot graphs. However, I need to get into R's environment now and
then use my R script using the source command. Is there a way to run the
R script from the unix prompt ?. 

Thanks,
Krishnan.

-----------------------------------------------------------
Sivaramakrishna Iyer Krishnan (Anand)
Research Assistant 
University of Oregon. 

House Address : 		Office Address : 
942 East, 18th Avenue, #14,	Deschutes Hall, Computer Science Department,
Ridgewood Apartments,		Room No. 228, University of Oregon - 97403.
Eugene, Oregon - 97403. 	Ph. : 541-346-4409.
Ph. : 541-683-8223.

E-mail : krishnan@nrl.cs.uoregon.edu,krishnan@.cs.uoregon.edu
URL    : http://www.nrg.cs.uoregon.edu/~krishnan/cs-web/.
------------------------------------------------------------
"It is better to be defeated on principle than to win on lies."
- Arthur Calwell

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From guido@sirio.stat.unipd.it  Thu Apr  6 17:29:08 2000
From: guido@sirio.stat.unipd.it (Guido Masarotto)
Date: Thu, 6 Apr 2000 18:29:08 +0200
Subject: [Rd] Re: [R] MetaPost device?
In-Reply-To: <x2ya6r2qea.fsf@blueberry.kubism.ku.dk>; from p.dalgaard@biostat.ku.dk on Thu, Apr 06, 2000 at 05:35:57PM +0200
References: <005501bf9fd8$2697d420$9570fe8c@lucent.com> <x2ya6r2qea.fsf@blueberry.kubism.ku.dk>
Message-ID: <20000406182908.A19743@sirio.stat.unipd.it>

[moving to r-devel]


On Thu, Apr 06, 2000 at 05:35:57PM +0200, Peter Dalgaard BSA wrote:
> "Vidhyanath Rao" <rao.3@osu.edu> writes:
> 
> > I would like to know if a MetaPost device is available or in the plans.
> > .....................................................................
> > If not, how easy/hard is it to add a new device to R? I caouln't see
> > ...................................................................
> It's not terribly hard (said the man who people have been nagging to
> do an xfig driver for years...) if you know the file format to
> generate. You need to figure out how to do do a rather small
> set of primitives to do text, polylines, etc., and then fill routines
> to do those into a fairly simple framework. 

  The problem with MetaPost (if I understand well) is how
  you do get metric information about the fonts. 
  In particular for the plotmath stuff.
  The easiest way is to delegate the whole thing to metapost itself (and
  to TeX in the back), i.e., you use 
  > text(somewhere,"\sum_i x_i")
  (not 'text(somewhere,expression(...))')
  and on the mp file the device write
  'btex $\sum_i x_i$ etex'
  ie, you ask to MetaPost to call TeX to process the fragment.
  However, this has the obvious drawback that the preview on the screen
  is not good.
  The alternative is to use the approach of the postscript device
  (you fix the fonts available, distribute a set of files with metric
   information of the fonts, and make the device to use it).
   I am not sure about how hard this will be. BTW, which
   kind of fonts is used by MetaPost?

   guido
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From J.C.Rougier@durham.ac.uk  Thu Apr  6 19:15:05 2000
From: J.C.Rougier@durham.ac.uk (J.C.Rougier@durham.ac.uk)
Date: Thu, 6 Apr 2000 20:15:05 +0200 (MET DST)
Subject: [Rd] Strange behaviour of image (PR#510)
Message-ID: <200004061815.UAA02888@pubhealth.ku.dk>

The following commands

z <- matrix(seq(0, 1, len=1000))
image(z, 1, z, zlim=c(0, 1), col=gray(1:10/10))

appear to violate the image functionality as described on the
help page.  As I understand it, by specifying a zlim of c(0, 1)
and a colour vector of length 10, the colours should correspond
to the intervals (0, 0.1), (0.1, 0.2), ..., (0.9, 1.0), this
being 10 equally-spaced intervals on (0, 1).  It is clear from
the image that this has not occurred.  In fact the intervals are
apparently (0, 1/18), (1/18, 3/18), ..., (15/18, 17/18), (17/18,
1).  Have I misunderstood something?

Cheers, Jonathan.

--please do not edit the information below--

Version:
 platform = sparc-sun-solaris2.7
 arch = sparc
 os = solaris2.7
 system = sparc, solaris2.7
 status = Patched
 major = 0
 minor = 99.0
 year = 2000
 month = February
 day = 9
 language = R

Search Path:
 .GlobalEnv, Autoloads, package:base

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Thu Apr  6 19:47:44 2000
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 06 Apr 2000 20:47:44 +0200
Subject: [Rd] Strange behaviour of image (PR#510)
In-Reply-To: J.C.Rougier@durham.ac.uk's message of "Thu, 6 Apr 2000 20:15:05 +0200 (MET DST)"
References: <200004061815.UAA02888@pubhealth.ku.dk>
Message-ID: <x21z4jnk1b.fsf@blueberry.kubism.ku.dk>

J.C.Rougier@durham.ac.uk writes:

> The following commands
> 
> z <- matrix(seq(0, 1, len=1000))
> image(z, 1, z, zlim=c(0, 1), col=gray(1:10/10))
> 
> appear to violate the image functionality as described on the
> help page.  As I understand it, by specifying a zlim of c(0, 1)
> and a colour vector of length 10, the colours should correspond
> to the intervals (0, 0.1), (0.1, 0.2), ..., (0.9, 1.0), this
> being 10 equally-spaced intervals on (0, 1).  It is clear from
> the image that this has not occurred.  In fact the intervals are
> apparently (0, 1/18), (1/18, 3/18), ..., (15/18, 17/18), (17/18,
> 1).  Have I misunderstood something?

I don't see that anything else is being promised...

If someone actually thought about this, then the choice might be
related to the behavior at peaks and troughs. (since a circle with
radius r looks wide compared to the region between two circles with
diameter n*r and (n+1)*r)

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ihaka@stat.auckland.ac.nz  Thu Apr  6 23:02:31 2000
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Fri, 7 Apr 2000 10:02:31 +1200
Subject: [Rd] Re: [R] MetaPost device?
In-Reply-To: <20000406182908.A19743@sirio.stat.unipd.it>; from Guido Masarotto on Thu, Apr 06, 2000 at 06:29:08PM +0200
References: <005501bf9fd8$2697d420$9570fe8c@lucent.com> <x2ya6r2qea.fsf@blueberry.kubism.ku.dk> <20000406182908.A19743@sirio.stat.unipd.it>
Message-ID: <20000407100231.A2998@stat1.stat.auckland.ac.nz>

On Thu, Apr 06, 2000 at 06:29:08PM +0200, Guido Masarotto wrote:

>   The problem with MetaPost (if I understand well) is how
>   you do get metric information about the fonts. 

The metric info problem is what stoped me writing the XFig driver.
Which metrics do you use for Times-Roman for example -- the X11 metrics
or the PostScript metrics?
	
	Ross
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pd@blueberry.kubism.ku.dk  Fri Apr  7 06:15:04 2000
From: pd@blueberry.kubism.ku.dk (Peter Dalgaard BSA)
Date: Fri, 7 Apr 2000 07:15:04 +0200
Subject: [Rd] Bug list summary (automatic post)
Message-ID: <200004070515.HAA21833@blueberry.kubism.ku.dk>

=================================================
This is an automated summary of the status of the R-bugs
repository.

Note that this may be neither complete nor perfectly
correct at any given instance: Not all bugs are reported,
and some reported bugs may have been fixed, but the
repository not yet updated.

Some bug fixes are difficult to verify because they pertain
to specific hardware or operating system versions. If you
have information to contribute, please do so.

If you happen to know how to fix a problem please send
patches to the bug repository, too.

New bugs are reported either through the web
interface at r-bugs.biostat.ku.dk or via email to
r-bugs@biostat.ku.dk. The bug.report() function can be
used to automate parts of the procedure on many systems.
Followups on older bugs can be done by including the string
"(PR#999)" in the Subject of an email (change 999 to the
actual reference number, of course!).
=================================================

Directory:  Accuracy

none

Directory:  Add-ons

* PR# 503 *
Subject: dmvnorm() bug in e1071
From: "Gregory R. Warnes" <warnes@biostat.washington.edu>
Date: Fri, 24 Mar 2000 03:24:45 +0000 (GMT)
* PR# 496 *
From: bonneau@epi.roazhon.inra.fr (en148)
Date: Tue, 21 Mar 2000 10:57:13 +0100 (MET)
--base R has no est.variogram function.
--This appears to be a bug report on sgeostat.
* PR# 471 *
Subject:  Problems with nlme 
From: Berwin Turlach <berwin@maths.uwa.edu.au>
Date: Tue, 7 Mar 2000 15:28:00 +0800
--Problem 1) was a subscripting bug introduced in 1.0.0 and fixed for 1.0.1
--Problem 2) (mssing datasets) needs a revised nlme

Directory:  Analyses

none

Directory:  Documentation

* PR# 497 *
Subject: par help wrong: xlog & ylog
From: wsi@gcal.ac.uk
Date: Tue, 21 Mar 2000 14:57:57 +0100 (MET)

Directory:  Graphics

* PR# 495 *
Subject: barplot
From: skala@incoma.cz
Date: Tue, 21 Mar 2000 09:20:33 +0100 (MET)
* PR# 202 *
Subject: persp box occlusion bug
From: wsi@gcal.ac.uk
Date: Wed, 2 Jun 1999 15:02:03 +0200 (MET DST)
--The persp algorithm does not apply the occlusion rules to the frame, 
--which is always plotted first. 
--A bug, but not very simple to fix.
* PR# 414 *
Subject:  graphics bugs: steep slopes and large values beyond ylim 
From: Ben Bolker <bolker@zoo.ufl.edu>
Date: Mon, 7 Feb 2000 18:28:04 -0500
--Followup on R-devel showed this was due to generating integer coordinates 
--outside +/- 2^15 in the X11 driver.
* PR# 400 *
Subject: X11 troubles
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 13 Jan 2000 14:31:42 +0100
--a) We don't handle multiple window closes well
--b) X11 errors should be caught by an error handler, not kill R
* PR# 494 *
Subject:  minor problem in barplot legend 
From: Ben Bolker <bolker@zoo.ufl.edu>
Date: Mon, 20 Mar 2000 17:31:36 -0500
* PR# 483 *
Subject: error in par option xaxt
From: aim@uwo.ca
Date: Mon, 13 Mar 2000 22:02:42 +0100 (MET)

Directory:  In-Out

none

Directory:  Installation

* PR# 485 *
Subject: Install R1.0.0
From: Lynn Zhang <lyzhang@umich.edu>
Date: Mon, 13 Mar 2000 16:10:52 -0500 (EST)
* PR# 478 *
Subject: Conditional for XDR code left out in saveload.c
From: hoffmann@ehmgs2.et.tu-dresden.de
Date: Thu, 9 Mar 2000 09:43:01 +0100 (MET)
--This seems to be a harmless warning, not an error.
* PR# 467 *
Subject: Re: [R] Re: R-1.0.0 is released
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 01 Mar 2000 20:26:40 +0100
--followup to PR#466
* PR# 466 *
Subject: Re: R-1.0.0 is released
From: bhoel@server.python.net (Berthold=?iso-8859-1?q?_H=F6llmann?=)
Date: 01 Mar 2000 16:00:54 +0100

Directory:  Language

* PR# 412 *
Subject: anomalies with call objects
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 06 Feb 2000 01:18:50 +0100
* PR# 408 *
Subject: convolution bug
From: wsimpson@gcal.ac.uk
Date: Fri, 28 Jan 2000 11:17:36 +0100 (MET)

Directory:  Low-level

* PR# 500 *
Subject:  segmentation fault with 1D array 
From: J.C.Rougier@durham.ac.uk
Date: Wed, 22 Mar 2000 18:25:24 GMT
* PR# 391 *
Subject: Segfault in dataentry()
From: Peter Dalgaard BSA <p.dalgaard@pubhealth.ku.dk>
Date: 29 Dec 1999 11:59:50 +0100
--dataentry(0,0) segfaults

Directory:  Misc

none

Directory:  Models

none

Directory:  Startup

* PR# 486 *
Subject: Re: autoload error in profile {was anova-bug in R-version  1.0.0?}
From: Martin Maechler <maechler@stat.math.ethz.ch>
Date: Tue, 14 Mar 2000 10:32:43 +0100 (MET)

Directory:  System-specific

* PR# 490 *
Subject: R-1.0.0 on alpha/osf1 memory glitch
From: Ray Brownrigg <Ray.Brownrigg@mcs.vuw.ac.nz>
Date: Fri, 17 Mar 2000 11:25:30 +1300 (NZDT)
* PR# 452 *
Subject: problem with glm
From: Brad McNeney <mcneney@cs.sfu.ca>
Date: Fri, 18 Feb 2000 17:51:54 -0800 (PST)
--Problems on Alpha's with glm. Status unclear

Directory:  TooMuchAtOnce

none

Directory:  Windows

none

Directory:  incoming

* PR# 510 *
Subject:  Strange behaviour of image 
From: J.C.Rougier@durham.ac.uk
Date: Thu, 6 Apr 2000 19:15:19 +0100 (BST)
* PR# 488 *
Subject: Error in lme?
From: simon.frost@ed.ac.uk
Date: Tue, 14 Mar 2000 14:15:52 +0100 (MET)
--No example to reproduce this.
* PR# 463 *
Subject: Bug in read.table
From: "E. S. Venkatraman" <venkat@biosta.mskcc.org>
Date: Tue, 29 Feb 2000 17:47:54 -0500 (EST)
--looks like quote arguments to read.table/count.fields needs to be set
* PR# 505 *
Subject: interrupted save 
From: Thomas Lumley <thomas@biostat.washington.edu>
Date: Sat, 25 Mar 2000 12:16:50 -0800 (PST)
* PR# 498 *
Subject: Use of Rd2txt on .Rd files from rw-1.0.0
Subject: Use of Rd2txt on .Rd files from rw-1.0.0
From: John Maindonald <john.maindonald@anu.edu.au>
Date: Wed, 22 Mar 2000 09:15:20 +1100 (EST)
--No response from author, but does look like using CRLF files on Unix.
* PR# 507 *
Subject: another save/load problem, only(?) affecting ascii = TRUE
From: Martin Maechler <maechler@stat.math.ethz.ch>
Date: Mon, 3 Apr 2000 14:37:50 +0200 (CEST)
* PR# 506 *
Subject: matlines, matpoints don't follow prototype
From: "Charles C. Berry" <cberry@tajo.ucsd.edu>
Date: Sun, 26 Mar 2000 12:51:24 -0800
* PR# 509 *
Subject: write.table with rows and cols
From: edd@debian.org
Date: Tue, 4 Apr 2000 01:23:32 +0200 (MET DST)
* PR# 508 *
Subject: cbind.ts(),ts.union()
From: koller2@fgr.wu-wien.ac.at
Date: Mon, 3 Apr 2000 20:08:11 +0200 (MET DST)
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Fri Apr  7 07:17:13 2000
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Fri, 7 Apr 2000 08:17:13 +0200 (CEST)
Subject: [Rd] Re: [R] Perl v5.6.0 breaks the configure script
In-Reply-To: <Pine.GSO.4.05.10004051414570.1837-100000@auk.stats>
References: <20000405083728.A29748@eddelbuettel.com>
 <Pine.GSO.4.05.10004051414570.1837-100000@auk.stats>
Message-ID: <14573.32105.668793.488172@aragorn.ci.tuwien.ac.at>

>>>>> Prof Brian D Ripley writes:

> On Wed, 5 Apr 2000, Dirk Eddelbuettel wrote:
>> 
>> On Wed, Apr 05, 2000 at 10:31:57AM +0100, Prof Brian D Ripley wrote:
>> > On Wed, 5 Apr 2000, tom kennedy wrote:
>> [..] 
>> > I think the trick is to use perl itself, as in
>> > 
>> > perl_version=`${PERL} -e '$v=$]; $v =~ s/(.)\..*/\1/;print $v'`
>> > 
>> > as perl is guaranteed to return its version as a number like 5.006
>> > even for `v5.6.0'.
>> > 
>> > Unfortunately the "]" in there confuses m4 when building configure
>> > from aclocal.m4, but I am sure the experts can fix that.

Guess this means that I am not an autoconf expert any more.

>> 
>> One would be to use the English module and PERL_VERSION instead:
>> 
>> perl_version=
>> = `${PERL}-MEnglish  -e '$v=$PERL_VERSION; $v =~ s/(.)\..*/\1/;print $v'`
>> 
>> > One could even do the whole test in Perl:
>> > 
>> > r_cv_prog_perl_v5=
>> > `${PERL} -e 'if($] >= 5) {print "yes";} else {print "no"}'`
>> 
>> Likewise:
>> 
>> r_cv_prog_perl_v5=
>> `${PERL} -MEnglish -e 'if($] >= 5) {print "yes";} else {print "no"}'`
> Um, not that but I think we know what you meant!

> Yes, I know and I considered that, but I do not think the English
> module is guaranteed to be present. This is a test of the Perl
> version, and as far as I could see -MEnglish does not work in Perl 4.
> (The -M flag is not in the Quick Reference Guide for 4.019.)  So I
> think your version assumes the thing it is testing for, Perl 5.x.

I also think we should not assume that English is there.

Anyway, I tried adding a line of code to configure.in which uses $], but
I failed miserably ... I would either get M4 syntax errors or not get
the `]'.  Hence, I changed the test to

    AC_CACHE_CHECK([whether perl version is at least 5],
      r_cv_prog_perl_v5,
      [ ${PERL} -e 'require 5' 2>/dev/null
        if test ${?} -eq 0; then
          r_cv_prog_perl_v5=yes
        else
          r_cv_prog_perl_v5=no
        fi
      ])

which I think should also do the job.

Changed in r-devel only.  If anyone thinks we should also do this in
r-release for 1.0.1, pls let me know && I will make the change (assuming
that the fix is correct).

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Fri Apr  7 07:28:47 2000
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Fri, 7 Apr 2000 07:28:47 +0100 (BST)
Subject: [Rd] Re: [R] Perl v5.6.0 breaks the configure script
In-Reply-To: <14573.32105.668793.488172@aragorn.ci.tuwien.ac.at>
Message-ID: <Pine.GSO.4.05.10004070722320.23146-100000@auk.stats>

On Fri, 7 Apr 2000, Kurt Hornik wrote:

> Anyway, I tried adding a line of code to configure.in which uses $], but
> I failed miserably ... I would either get M4 syntax errors or not get
> the `]'.  Hence, I changed the test to
> 
>     AC_CACHE_CHECK([whether perl version is at least 5],
>       r_cv_prog_perl_v5,
>       [ ${PERL} -e 'require 5' 2>/dev/null
>         if test ${?} -eq 0; then
>           r_cv_prog_perl_v5=yes
>         else
>           r_cv_prog_perl_v5=no
>         fi
>       ])
> 
> which I think should also do the job.

Can anyone test this?  Again, I thought of that, and `require number'
is not in my Perl 4 book.  So although I think it will fail on Perl4,
I am not sure.  In any case, it is safer than what went before.

> Changed in r-devel only.  If anyone thinks we should also do this in
> r-release for 1.0.1, pls let me know && I will make the change (assuming
> that the fix is correct).

Yes, I think it should be changed. We want 1.0.1 to configure under the 
current Perl, which is the only easy one to find.

Brian

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From maechler@stat.math.ethz.ch  Fri Apr  7 10:35:45 2000
From: maechler@stat.math.ethz.ch (maechler@stat.math.ethz.ch)
Date: Fri, 7 Apr 2000 11:35:45 +0200 (MET DST)
Subject: [Rd] matlines, matpoints don't follow prototype (PR#506)
Message-ID: <200004070935.LAA08246@pubhealth.ku.dk>

>>>>> "ChuckB" == Charles C Berry <cberry@tajo.ucsd.edu> writes:

    ChuckB> The Blue Book allows the 'type' argument to be used in matpoints and
    ChuckB> matlines.

    ChuckB>	matlines(x, y, type="l", lty=1:5, pch=, col=1:4)

    ChuckB> R-1.0.0 does not.

    ChuckB> Thus, type="h", "b", must be invoked thru matplot( x, y, type = "h",
    ChuckB> add=TRUE)

    ChuckB> For the sake of consistency with S, it would be nice to have
    ChuckB> matlines defined as:

    ChuckB> "matlines" <-
    ChuckB> function(x, y, type = 'l', lty=1:5, lwd = 1, pch=NULL, col=1:6, ...)
    ChuckB> matplot(x=x, y=y, type=type, lty=lty, lwd=lwd, pch=pch, col=col,
    ChuckB> add=TRUE, ...)

    ChuckB> and similarly for matpoints.

You are right.

I've fixed it for the upcoming patch release (1.0.1).

Martin Maechler <maechler@stat.math.ethz.ch>	http://stat.ethz.ch/~maechler/
Seminar fuer Statistik, ETH-Zentrum  LEO D10	Leonhardstr. 27
ETH (Federal Inst. Technology)	8092 Zurich	SWITZERLAND
phone: x-41-1-632-3408		fax: ...-1228			<><

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Fri Apr  7 11:44:44 2000
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Fri, 7 Apr 2000 12:44:44 +0200 (CEST)
Subject: [Rd] Re: [R] Perl v5.6.0 breaks the configure script
In-Reply-To: <Pine.GSO.4.05.10004070722320.23146-100000@auk.stats>
References: <14573.32105.668793.488172@aragorn.ci.tuwien.ac.at>
 <Pine.GSO.4.05.10004070722320.23146-100000@auk.stats>
Message-ID: <14573.48156.91155.461519@aragorn.ci.tuwien.ac.at>

>>>>> Prof Brian D Ripley writes:

> On Fri, 7 Apr 2000, Kurt Hornik wrote:
>> Anyway, I tried adding a line of code to configure.in which uses $], but
>> I failed miserably ... I would either get M4 syntax errors or not get
>> the `]'.  Hence, I changed the test to
>> 
>> AC_CACHE_CHECK([whether perl version is at least 5],
>> r_cv_prog_perl_v5,
>> [ ${PERL} -e 'require 5' 2>/dev/null
>> if test ${?} -eq 0; then
>> r_cv_prog_perl_v5=yes
>> else
>> r_cv_prog_perl_v5=no
>> fi
>> ])
>> 
>> which I think should also do the job.

> Can anyone test this?  Again, I thought of that, and `require number'
> is not in my Perl 4 book.  So although I think it will fail on Perl4,
> I am not sure.  In any case, it is safer than what went before.

My idea was that if it fails in v4 it is fine anyway.  (Testing for a
feature only present in v5 is also a good test for v5.)

In fact:

khornik@sim:~$ perl4 -v

This is perl, version 4.0

$RCSfile: perl.c,v $$Revision: 4.0.1.8 $$Date: 1993/02/05 19:39:30 $
Patch level: 36

Copyright (c) 1989, 1990, 1991, Larry Wall

khornik@sim:~$ perl4 -e 'require 5'            
Can't locate 5 in @INC at /tmp/perl-ea22225 line 1.

hence:

khornik@sim:~$ perl4 -e 'require 5' 2>/dev/null
khornik@sim:~$ echo $?
2

>> Changed in r-devel only.  If anyone thinks we should also do this in
>> r-release for 1.0.1, pls let me know && I will make the change (assuming
>> that the fix is correct).

> Yes, I think it should be changed. We want 1.0.1 to configure under
> the current Perl, which is the only easy one to find.

Good enough?

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Fri Apr  7 12:26:22 2000
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 07 Apr 2000 13:26:22 +0200
Subject: [Rd] Re: [R] Perl v5.6.0 breaks the configure script
In-Reply-To: Kurt Hornik's message of "Fri, 7 Apr 2000 12:44:44 +0200 (CEST)"
References: <14573.32105.668793.488172@aragorn.ci.tuwien.ac.at> <Pine.GSO.4.05.10004070722320.23146-100000@auk.stats> <14573.48156.91155.461519@aragorn.ci.tuwien.ac.at>
Message-ID: <x2zor640f5.fsf@blueberry.kubism.ku.dk>

Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:


> khornik@sim:~$ perl4 -e 'require 5' 2>/dev/null
> khornik@sim:~$ echo $?
> 2
...
> Good enough?

Hmmmf... Well if it can't be otherwise, but the *right* solution would
seem to be

if perl -e 'exit 1 if $]<5' 
then
  r_cv_prog_perl_v5=yes
else
  r_cv_prog_perl_v5=no
fi
 

if it weren't for that %/&/%# m4 problem... (I'll see what I can dig up) 

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Thomas Vogels <tov@ece.cmu.edu>  Fri Apr  7 15:53:35 2000
From: Thomas Vogels <tov@ece.cmu.edu> (Thomas J Vogels)
Date: 07 Apr 2000 10:53:35 -0400
Subject: [Rd] Re: [R] MetaPost device?
In-Reply-To: Ross Ihaka's message of "Fri, 7 Apr 2000 10:02:31 +1200"
References: <005501bf9fd8$2697d420$9570fe8c@lucent.com> <x2ya6r2qea.fsf@blueberry.kubism.ku.dk> <20000406182908.A19743@sirio.stat.unipd.it> <20000407100231.A2998@stat1.stat.auckland.ac.nz>
Message-ID: <87d7o2hsi8.fsf@bavaria.ece.cmu.edu>


Ross Ihaka <ihaka@stat.auckland.ac.nz> writes:

> On Thu, Apr 06, 2000 at 06:29:08PM +0200, Guido Masarotto wrote:
> 
> >   The problem with MetaPost (if I understand well) is how
> >   you do get metric information about the fonts. 
> 
> The metric info problem is what stoped me writing the XFig driver.
> Which metrics do you use for Times-Roman for example -- the X11 metrics
> or the PostScript metrics?

I'll be sorry for this naive question, but if you limited the fonts
in the FIG output to LaTeX fonts, couldn't you use the LaTeX font
information?  (This doesn't solve the problem that what you see in an
X11 device is not what you get with dev.print which may or may not be
a good thing.)

  -tom

-- 
mailto:tov@ece.cmu.edu (Tom Vogels)   Tel: (412) 268-6638   FAX: -3204
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From dtrenkler@nts6.oec.uni-osnabrueck.de  Fri Apr  7 16:15:31 2000
From: dtrenkler@nts6.oec.uni-osnabrueck.de (dtrenkler@nts6.oec.uni-osnabrueck.de)
Date: Fri, 7 Apr 2000 17:15:31 +0200 (MET DST)
Subject: [Rd] Bug in qbinom? (PR#511)
Message-ID: <200004071515.RAA13504@pubhealth.ku.dk>

n_10;p_0.5;jjx_0:n;qbinom(pbinom(jjx,n,p),n,p) #  This one works as
expected

n_100;p_0.5;jjx_0:n;qbinom(pbinom(jjx,n,p),n,p)  # This one causes
severe problems

I cannot interrupt using ESC and I finally have to resort to the Windows
Task manager to kill the R session.
A friend of mine told me that he faced similar problems under Unix.



--please do not edit the information below--

Version:
 platform = Windows
 arch = x86
 os = Win32
 system = x86, Win32
 status = 
 major = 1
 minor = 0.0
 year = 2000
 month = February
 day = 29
 language = R

Windows NT 4.0 (build 1381) Service Pack 3

Search Path:
 .GlobalEnv, Autoloads, package:base




   --- D.Trenkler ---

************************************************************************
*********
   Dietrich Trenkler
(trenkler@oec.uni-osnabrueck.de)      
   Statistik / Empirische Wirtschaftsforschung
   Universitaet Osnabrueck
   Rolandstrasse 8                             Phone: +49(0)
541-969-2753
   D-49069 Osnabrueck                        Fax  : +49(0) 541-969-2745
   GERMANY
************************************************************************
*********




-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From thomas@biostat.washington.edu  Fri Apr  7 16:33:13 2000
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Fri, 7 Apr 2000 08:33:13 -0700 (PDT)
Subject: [Rd] Bug in qbinom? (PR#511)
In-Reply-To: <200004071515.RAA13504@pubhealth.ku.dk>
Message-ID: <Pine.GSO.4.21.0004070829110.20598-100000@mail.biostat.washington.edu>

On Fri, 7 Apr 2000 dtrenkler@nts6.oec.uni-osnabrueck.de wrote:

> n_10;p_0.5;jjx_0:n;qbinom(pbinom(jjx,n,p),n,p) #  This one works as
> expected
> 
> n_100;p_0.5;jjx_0:n;qbinom(pbinom(jjx,n,p),n,p)  # This one causes
> severe problems

The problem is in qbinom(1-epsilon,100,0.5) for epsilon between 10^-15 and
10^-17. It appears to go for ever.

> pbinom(jjx,n,p)[89]-1 
[1] -1.110223e-16

An even simpler version is
   qbinom(1-1e-16,2,0.5)

Presumably a check for zero needs some fuzz.

	-thomas

Thomas Lumley
Assistant Professor, Biostatistics
University of Washington, Seattle

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From tov@ece.cmu.edu  Fri Apr  7 16:53:25 2000
From: tov@ece.cmu.edu (tov@ece.cmu.edu)
Date: Fri, 7 Apr 2000 17:53:25 +0200 (MET DST)
Subject: [Rd] x11 colortype problems ('gray' is broken?) (PR#512)
Message-ID: <200004071553.RAA13862@pubhealth.ku.dk>


Hi,

  I occasionally run out of color in my X11 terminal.  At this
point, R will issue this error message:
        Error: X11 cannot allocate additional graphics colors.
Consider using colortype="pseudo.cube" or "gray".

An immediate x11(colortype="pseudo.cube") doesn't work as the
colortype seems to be shared among the different x11 plotting windows.
So I have to close all windows first, then I can open an x11 device
with the colortype "pseudo.cube".  (Neither the necessity to close all
windows nor the fact, that colortype is an option to X11 and not to
the plot command, is clear from the help pages or the error message.)

The real problem, however, comes with x11(colortype="gray") as this
brings up just a black screen (and it stays black).  I can't quite see
whether I'm stumbling across some issues with X resources, here.
x11() usually gives a white background.

Thanks,
  -tom


 --
platform = i586-unknown-linux
arch = i586
os = linux
system = i586, linux
status = 
major = 1
minor = 0.0
year = 2000
month = February
day = 29
language = R


-- 
mailto:tov@ece.cmu.edu (Tom Vogels)   Tel: (412) 268-6638   FAX: -3204


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From J.C.Rougier@durham.ac.uk  Fri Apr  7 17:04:17 2000
From: J.C.Rougier@durham.ac.uk (Jonathan Rougier)
Date: Fri, 7 Apr 2000 17:04:17 +0100 (BST)
Subject: [Rd] Strange behaviour of image (PR#510)
In-Reply-To: <x21z4jnk1b.fsf@blueberry.kubism.ku.dk>
Message-ID: <Pine.GSO.4.20.0004071656130.15072-100000@laplace>

Hi Peter,

On 6 Apr 2000, Peter Dalgaard BSA wrote:

> J.C.Rougier@durham.ac.uk writes:
> 
> > The following commands
> > 
> > z <- matrix(seq(0, 1, len=1000))
> > image(z, 1, z, zlim=c(0, 1), col=gray(1:10/10))
> > 
> > appear to violate the image functionality as described on the
> > help page.  As I understand it, by specifying a zlim of c(0, 1)
> > and a colour vector of length 10, the colours should correspond
> > to the intervals (0, 0.1), (0.1, 0.2), ..., (0.9, 1.0), this
> > being 10 equally-spaced intervals on (0, 1).  It is clear from
> > the image that this has not occurred.  In fact the intervals are
> > apparently (0, 1/18), (1/18, 3/18), ..., (15/18, 17/18), (17/18,
> > 1).  Have I misunderstood something?
> 
> I don't see that anything else is being promised...
> 
> If someone actually thought about this, then the choice might be
> related to the behavior at peaks and troughs. (since a circle with
> radius r looks wide compared to the region between two circles with
> diameter n*r and (n+1)*r)

I'm not quite sure I follow.  My feeling is that the displayed behaviour
of image is unreasonable, and, I hazard, not what most people who use
image expect.  I think the default behaviour of image should be to give
colour bands of equal widths, and, if I may append to the wish list, I
woud like to be able to specify a "breaks" argument to have unequal widths
should I so choose.

Cheers, Jonathan.

Jonathan Rougier                       Science Laboratories
Department of Mathematical Sciences    South Road
University of Durham                   Durham DH1 3LE
http://www.maths.dur.ac.uk/stats/people/jcr/jcr.html


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From thomas@biostat.washington.edu  Fri Apr  7 17:10:59 2000
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Fri, 7 Apr 2000 09:10:59 -0700 (PDT)
Subject: [Rd] Bug in qbinom? (PR#511)
In-Reply-To: <200004071515.RAA13504@pubhealth.ku.dk>
Message-ID: <Pine.GSO.4.21.0004070904390.20598-100000@mail.biostat.washington.edu>

On Fri, 7 Apr 2000 dtrenkler@nts6.oec.uni-osnabrueck.de wrote:

> n_10;p_0.5;jjx_0:n;qbinom(pbinom(jjx,n,p),n,p) #  This one works as
> expected
> 
> n_100;p_0.5;jjx_0:n;qbinom(pbinom(jjx,n,p),n,p)  # This one causes
> severe problems


In qbinom  we calculate an estimate y based on a Cornish-Fisher expansion
and then search up or down to the right number.  However, for p=1-1e-16 or
thereabouts we get

y=83931130944911952

which is bigger than 1/machine epsilon.  Thus y=y-1 and searching up or
down doesnt work.  A crude solution is to just treat this as p=1, but it
would be better to search up or down in bigger steps.

	-thomas


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From maechler@stat.math.ethz.ch  Fri Apr  7 17:23:38 2000
From: maechler@stat.math.ethz.ch (maechler@stat.math.ethz.ch)
Date: Fri, 7 Apr 2000 18:23:38 +0200 (MET DST)
Subject: [Rd] Bug in qbinom? (PR#511)
Message-ID: <200004071623.SAA14021@pubhealth.ku.dk>

>>>>> "TL" == Thomas Lumley <thomas@biostat.washington.edu> writes:

    TL> On Fri, 7 Apr 2000 dtrenkler@nts6.oec.uni-osnabrueck.de wrote:
    >> n_10;p_0.5;jjx_0:n;qbinom(pbinom(jjx,n,p),n,p) #  This one works as
    >> expected
    >> 
    >> n_100;p_0.5;jjx_0:n;qbinom(pbinom(jjx,n,p),n,p)  # This one causes
    >> severe problems

    TL> The problem is in qbinom(1-epsilon,100,0.5) for epsilon between
    TL> 10^-15 and 10^-17. It appears to go for ever.

    >> pbinom(jjx,n,p)[89]-1 
    TL> [1] -1.110223e-16

    TL> An even simpler version is
    TL> qbinom(1-1e-16,2,0.5)

    TL> Presumably a check for zero needs some fuzz.

Note that we (I) also have a considerable improvement for  dbinom() in the
pipeline, from  Clive Loader's post of a few weeks ago.

But this may be a completely orthogonal issue...
I will have a look over the weekend.

Martin

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Prof Brian Ripley <ripley@stats.ox.ac.uk>  Fri Apr  7 17:51:47 2000
From: Prof Brian Ripley <ripley@stats.ox.ac.uk> (Prof Brian Ripley)
Date: Fri, 7 Apr 2000 17:51:47 +0100 (BST)
Subject: [Rd] Strange behaviour of image (PR#510)
Message-ID: <200004071651.RAA15284@toucan.stats.ox.ac.uk>


> Date: Fri, 7 Apr 2000 17:04:17 +0100 (BST)
> From: Jonathan Rougier <J.C.Rougier@durham.ac.uk>
> 
> Hi Peter,
> 
> On 6 Apr 2000, Peter Dalgaard BSA wrote:
> 
> > J.C.Rougier@durham.ac.uk writes:
> > 
> > > The following commands
> > > 
> > > z <- matrix(seq(0, 1, len=1000))
> > > image(z, 1, z, zlim=c(0, 1), col=gray(1:10/10))
> > > 
> > > appear to violate the image functionality as described on the
> > > help page.  As I understand it, by specifying a zlim of c(0, 1)
> > > and a colour vector of length 10, the colours should correspond
> > > to the intervals (0, 0.1), (0.1, 0.2), ..., (0.9, 1.0), this
> > > being 10 equally-spaced intervals on (0, 1).  It is clear from
> > > the image that this has not occurred.  In fact the intervals are
> > > apparently (0, 1/18), (1/18, 3/18), ..., (15/18, 17/18), (17/18,
> > > 1).  Have I misunderstood something?
> > 
> > I don't see that anything else is being promised...
> > 
> > If someone actually thought about this, then the choice might be
> > related to the behavior at peaks and troughs. (since a circle with
> > radius r looks wide compared to the region between two circles with
> > diameter n*r and (n+1)*r)
> 
> I'm not quite sure I follow.  My feeling is that the displayed behaviour
> of image is unreasonable, and, I hazard, not what most people who use
> image expect.  I think the default behaviour of image should be to give
> colour bands of equal widths, and, if I may append to the wish list, I
> woud like to be able to specify a "breaks" argument to have unequal widths
> should I so choose.

I side with Jonathan.

(1) The prototype does as JCR describes: given 64 colours it allocates
1/64th of the space to each.

(2) Setting the break points seems a good idea to me (but can always be
faked by a non-linear monotonic transformation of z, as I have done
before now).

I suggest we do add a `breaks' arg and that we do change the default
at the level of the R code, perhaps with an oldstyle parameter.
OK?

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Fri Apr  7 17:59:22 2000
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 07 Apr 2000 18:59:22 +0200
Subject: [Rd] Strange behaviour of image (PR#510)
In-Reply-To: Prof Brian Ripley's message of "Fri, 7 Apr 2000 17:51:47 +0100 (BST)"
References: <200004071651.RAA15284@toucan.stats.ox.ac.uk>
Message-ID: <x2wvm93l05.fsf@blueberry.kubism.ku.dk>

Prof Brian Ripley <ripley@stats.ox.ac.uk> writes:

> I side with Jonathan.
> 
> (1) The prototype does as JCR describes: given 64 colours it allocates
> 1/64th of the space to each.
> 
> (2) Setting the break points seems a good idea to me (but can always be
> faked by a non-linear monotonic transformation of z, as I have done
> before now).
> 
> I suggest we do add a `breaks' arg and that we do change the default
> at the level of the R code, perhaps with an oldstyle parameter.
> OK?

OK with me. Didn't feel too strongly about in in the first place. But
perhaps somone else did since they did it that way?

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From thomas@biostat.washington.edu  Fri Apr  7 17:57:41 2000
From: thomas@biostat.washington.edu (thomas@biostat.washington.edu)
Date: Fri, 7 Apr 2000 18:57:41 +0200 (MET DST)
Subject: [Rd] Bug in qbinom? (PR#511)
Message-ID: <200004071657.SAA14316@pubhealth.ku.dk>


I've committed a fix to the development branch.  We now start searching at 
max(0,min(n,normal-approximation))

We still don't get  qbinom(pbinom(x,100,0.5))==x for x>86, but that's to
be expected. 


Thomas Lumley
Assistant Professor, Biostatistics
University of Washington, Seattle


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From erich.neuwirth@univie.ac.at  Sat Apr  8 01:35:06 2000
From: erich.neuwirth@univie.ac.at (Erich Neuwirth)
Date: Sat, 08 Apr 2000 02:35:06 +0200
Subject: [Rd] cannot compile on solaris
References: <200004071651.RAA15284@toucan.stats.ox.ac.uk> <x2wvm93l05.fsf@blueberry.kubism.ku.dk>
Message-ID: <38EE7EBA.36942CA@univie.ac.at>

on my old sun ipx with gcc and texinfo installed 
u run ./configure ok, and then i get

[szego@neuwirth:/install/R-1.0.0] make
make[1]: Entering directory `/install/R-1.0.0/tools'
make[1]: Nothing to be done for `R'.
make[1]: Leaving directory `/install/R-1.0.0/tools'
make[1]: Entering directory `/install/R-1.0.0/afm'
make[1]: Leaving directory `/install/R-1.0.0/afm'
make[1]: Entering directory `/install/R-1.0.0/doc'
false: false: cannot open
make[1]: *** [R] Error 1
make[1]: Leaving directory `/install/R-1.0.0/doc'
make: *** [R] Error 1

what is happening?
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ihaka@stat.auckland.ac.nz  Sat Apr  8 02:38:41 2000
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Sat, 8 Apr 2000 13:38:41 +1200
Subject: [Rd] Re: [R] MetaPost device?
In-Reply-To: <87d7o2hsi8.fsf@bavaria.ece.cmu.edu>; from Thomas J Vogels on Fri, Apr 07, 2000 at 10:53:35AM -0400
References: <005501bf9fd8$2697d420$9570fe8c@lucent.com> <x2ya6r2qea.fsf@blueberry.kubism.ku.dk> <20000406182908.A19743@sirio.stat.unipd.it> <20000407100231.A2998@stat1.stat.auckland.ac.nz> <87d7o2hsi8.fsf@bavaria.ece.cmu.edu>
Message-ID: <20000408133841.B1234@stat1.stat.auckland.ac.nz>

On Fri, Apr 07, 2000 at 10:53:35AM -0400, Thomas J Vogels wrote:
> 
> Ross Ihaka <ihaka@stat.auckland.ac.nz> writes:
> 
> > On Thu, Apr 06, 2000 at 06:29:08PM +0200, Guido Masarotto wrote:
> > 
> > >   The problem with MetaPost (if I understand well) is how
> > >   you do get metric information about the fonts. 
> > 
> > The metric info problem is what stoped me writing the XFig driver.
> > Which metrics do you use for Times-Roman for example -- the X11 metrics
> > or the PostScript metrics?
> 
> I'll be sorry for this naive question, but if you limited the fonts
> in the FIG output to LaTeX fonts, couldn't you use the LaTeX font
> information?  (This doesn't solve the problem that what you see in an
> X11 device is not what you get with dev.print which may or may not be
> a good thing.)

This is supposing that you can get get access to it.  I certainly don't
know enough about TeX to be able to parse tfm files.  If code existed to
compute the dimensions of strings then we'd be away.

Another problem the text output by TeX can be rather richly structured
-- kerning and glue come to mind.  I think a general solution might
require either writing a version of the TeX layout code for R, or running
TeX to compute metric information whenever a string is placed in a plot
(hmmmm actually this last might just be workable - if a little slow).

	Ross
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Sat Apr  8 08:05:26 2000
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Sat, 8 Apr 2000 08:05:26 +0100 (BST)
Subject: xfig device (was [Rd] Re: [R] MetaPost device?)
In-Reply-To: <20000408133841.B1234@stat1.stat.auckland.ac.nz>
Message-ID: <Pine.GSO.4.05.10004080721170.7242-100000@auk.stats>

On Sat, 8 Apr 2000, Ross Ihaka wrote:

> On Fri, Apr 07, 2000 at 10:53:35AM -0400, Thomas J Vogels wrote:
> > 
> > Ross Ihaka <ihaka@stat.auckland.ac.nz> writes:
> > 
> > > On Thu, Apr 06, 2000 at 06:29:08PM +0200, Guido Masarotto wrote:
> > > 
> > > >   The problem with MetaPost (if I understand well) is how
> > > >   you do get metric information about the fonts. 
> > > 
> > > The metric info problem is what stoped me writing the XFig driver.
> > > Which metrics do you use for Times-Roman for example -- the X11 metrics
> > > or the PostScript metrics?
> > 
> > I'll be sorry for this naive question, but if you limited the fonts
> > in the FIG output to LaTeX fonts, couldn't you use the LaTeX font
> > information?  (This doesn't solve the problem that what you see in an
> > X11 device is not what you get with dev.print which may or may not be
> > a good thing.)
> 
> This is supposing that you can get get access to it.  I certainly don't
> know enough about TeX to be able to parse tfm files.  If code existed to
> compute the dimensions of strings then we'd be away.

AFAIR no problem: many dvixx drivers such as dvips compute string widths at
least.  In dvips bbox.c computes the bounding box for a dvi file, and
thereby computes BB info for each string. In doing so it computes from the
tfm the llx,lly,urx,ury for each character.

However, I would be inclined to go the other way, and just use the
PostScript fonts and their metrics.  For a start, the X11 metrics are I
believe device-specific, and I would view xfig screen output as an
approximation to the final printed form. And it is that final form I want
to be accurate.

> Another problem the text output by TeX can be rather richly structured
> -- kerning and glue come to mind.
 
Are we not just discussing a xfig driver for R, and R's driver model only
writes single text strings at specified (x,y) locations?  So test output
from an R xfig driver would not be richly structured?  Yes, there is
kerning but there is using postscript fonts directly, surely?
By the time a dvixx driver is reading the dvi file the kerning has been
done, but the information is all there in the tfm, and the format is
readily available (e.g. in tftopl).

Brian

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Sat Apr  8 08:24:43 2000
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Sat, 8 Apr 2000 08:24:43 +0100 (BST)
Subject: [Rd] cannot compile on solaris
In-Reply-To: <38EE7EBA.36942CA@univie.ac.at>
Message-ID: <Pine.GSO.4.05.10004080813230.7242-100000@auk.stats>

On Sat, 8 Apr 2000, Erich Neuwirth wrote:

> on my old sun ipx with gcc and texinfo installed 
> u run ./configure ok, and then i get
> 
> [szego@neuwirth:/install/R-1.0.0] make
> make[1]: Entering directory `/install/R-1.0.0/tools'
> make[1]: Nothing to be done for `R'.
> make[1]: Leaving directory `/install/R-1.0.0/tools'
> make[1]: Entering directory `/install/R-1.0.0/afm'
> make[1]: Leaving directory `/install/R-1.0.0/afm'
> make[1]: Entering directory `/install/R-1.0.0/doc'
> false: false: cannot open
> make[1]: *** [R] Error 1
> make[1]: Leaving directory `/install/R-1.0.0/doc'
> make: *** [R] Error 1
> 
> what is happening?

false should be in /usr/bin/false:
auk% which false
/usr/bin/false
auk% ls -l `which false`
-r-xr-xr-x   1 bin      bin           314 Jul 16  1997 /usr/bin/false*

It is not clear from your output what this is trying to do: I get
auk% make -n R
/opt/R/cvs/R/tools/mkinstalldirs ../doc/html/search
cat /opt/R/cvs/R/doc/html/search/SearchEngine-head.html > \
  ../doc/html/search/SearchEngine.html
../tools/keywords2html /opt/R/cvs/R/doc/KEYWORDS.db >> \
  ../doc/html/search/SearchEngine.html
cat /opt/R/cvs/R/doc/html/search/SearchEngine-foot.html >> \
  ../doc/html/search/SearchEngine.html
if [ "/opt/R/cvs/R/doc" != "." ]; then \
  make rhome=.. install-html; \
  (cd manual && make R); \
fi
echo "installing doc ..."
...

so one of these is failing (and I think not the if clause as that should
echo something). Can you do the same and track down what has not been
created?


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Sat Apr  8 09:31:48 2000
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Sat, 8 Apr 2000 09:31:48 +0100 (BST)
Subject: [Rd] window(): feature request
In-Reply-To: <3.0.6.32.20000403182113.008f1bf0@fgr.wu-wien.ac.at>
Message-ID: <Pine.GSO.4.05.10004080927380.8001-100000@auk.stats>

On Mon, 3 Apr 2000, Wolfgang Koller wrote:

> Dear R-developpers,
> 
> currently the function window shows the following behaviour, if start or
> end is out of range:
> 
> > x <- ts(1:14,start=c(1950,2),frequency=4)
> > y <- window(x,start=c(1950,1),end=c(1953,4))
> Warning messages: 
> 1: start value not changed in: window.default(x, ...) 
> 2: end value not changed in: window.default(x, ...) 
> 
> Instead of this I would like it to fill with NAs the values before start(x)
> and after end(x). Could this be done by introducing an additional option in
> window()? Could you please consider this in future releases? Or is there a
> better way to do this using existing functions?

This is incompatible with S and the existing behaviour, so I have added a
new argument `extend' defaulting to FALSE. The new version is in the
R-devel distribution, so will not appear in a released version until 1.1.0.

> P.S.: Below I have added some code that accomplishes this aim in a separate
> function (which is probably an example of akward programming...).

[It does not handle matrix ts objects, for example, nor does it handle
changing the frequency.]

[code snipped.]

PS: R-bugs now has a `wishlist' section, so sending a feature request as a
bug report is a way to ensure it gets recorded.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Sat Apr  8 09:38:18 2000
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 08 Apr 2000 10:38:18 +0200
Subject: xfig device (was [Rd] Re: [R] MetaPost device?)
In-Reply-To: Prof Brian D Ripley's message of "Sat, 8 Apr 2000 08:05:26 +0100 (BST)"
References: <Pine.GSO.4.05.10004080721170.7242-100000@auk.stats>
Message-ID: <x2em8hyolh.fsf@blueberry.kubism.ku.dk>

Prof Brian D Ripley <ripley@stats.ox.ac.uk> writes:

> Are we not just discussing a xfig driver for R, and R's driver model only
> writes single text strings at specified (x,y) locations?  So test output
> from an R xfig driver would not be richly structured?  Yes, there is
> kerning but there is using postscript fonts directly, surely?
> By the time a dvixx driver is reading the dvi file the kerning has been
> done, but the information is all there in the tfm, and the format is
> readily available (e.g. in tftopl).

But what about plotmath? If we want to get the equivalent of
\alpha*\text{threshold}_i (say) to come out right then we need to know
the length of "threshold" in the relevant font... Of course you could
(potentially) get the driver to output actual TeX, but then you have
no inkling about the total size of the formula object, and it comes
out as TeX code inside XFig. Xfig is pretty much geared towards
postscript fonts, so I suppose the most practical thing to do is to
assume PS as the final target and accept the approximations caused by
the screen fonts while previewing. 

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Sat Apr  8 09:42:37 2000
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Sat, 8 Apr 2000 09:42:37 +0100 (BST)
Subject: [Rd] Strange behaviour of image (PR#510)
In-Reply-To: <200004071651.RAA15284@toucan.stats.ox.ac.uk>
Message-ID: <Pine.GSO.4.05.10004080932360.8001-100000@auk.stats>

On Fri, 7 Apr 2000, Prof Brian Ripley wrote:

> 
> > Date: Fri, 7 Apr 2000 17:04:17 +0100 (BST)
> > From: Jonathan Rougier <J.C.Rougier@durham.ac.uk>
> > 
> > Hi Peter,
> > 
> > On 6 Apr 2000, Peter Dalgaard BSA wrote:
> > 
> > > J.C.Rougier@durham.ac.uk writes:
> > > 
> > > > The following commands
> > > > 
> > > > z <- matrix(seq(0, 1, len=1000))
> > > > image(z, 1, z, zlim=c(0, 1), col=gray(1:10/10))
> > > > 
> > > > appear to violate the image functionality as described on the
> > > > help page.  As I understand it, by specifying a zlim of c(0, 1)
> > > > and a colour vector of length 10, the colours should correspond
> > > > to the intervals (0, 0.1), (0.1, 0.2), ..., (0.9, 1.0), this
> > > > being 10 equally-spaced intervals on (0, 1).  It is clear from
> > > > the image that this has not occurred.  In fact the intervals are
> > > > apparently (0, 1/18), (1/18, 3/18), ..., (15/18, 17/18), (17/18,
> > > > 1).  Have I misunderstood something?
> > > 
> > > I don't see that anything else is being promised...
> > > 
> > > If someone actually thought about this, then the choice might be
> > > related to the behavior at peaks and troughs. (since a circle with
> > > radius r looks wide compared to the region between two circles with
> > > diameter n*r and (n+1)*r)
> > 
> > I'm not quite sure I follow.  My feeling is that the displayed behaviour
> > of image is unreasonable, and, I hazard, not what most people who use
> > image expect.  I think the default behaviour of image should be to give
> > colour bands of equal widths, and, if I may append to the wish list, I
> > woud like to be able to specify a "breaks" argument to have unequal widths
> > should I so choose.
> 
> I side with Jonathan.
> 
> (1) The prototype does as JCR describes: given 64 colours it allocates
> 1/64th of the space to each.
> 
> (2) Setting the break points seems a good idea to me (but can always be
> faked by a non-linear monotonic transformation of z, as I have done
> before now).
> 
> I suggest we do add a `breaks' arg and that we do change the default
> at the level of the R code, perhaps with an oldstyle parameter.
> OK?

Now done for R-devel. The new version computes the indices into the colour
table in the R code so is much easier to customize.

help(image) did say

    zlim: the minimum and maximum `z' values for which colors will be
          plotted.  Each of the given colors will be used to color an
          equispaced interval of this range.

and what happened was that the midpoints of the colour grid covered the
range, so the lowest and highest z values which were plotted were smaller
and larger than as specified here.  I've altered the help file for 1.0.1.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Sat Apr  8 10:08:40 2000
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Sat, 8 Apr 2000 10:08:40 +0100 (BST)
Subject: xfig device (was [Rd] Re: [R] MetaPost device?)
In-Reply-To: <x2em8hyolh.fsf@blueberry.kubism.ku.dk>
Message-ID: <Pine.GSO.4.05.10004080943340.8001-100000@auk.stats>

On 8 Apr 2000, Peter Dalgaard BSA wrote:

> Prof Brian D Ripley <ripley@stats.ox.ac.uk> writes:
> 
> > Are we not just discussing a xfig driver for R, and R's driver model only
> > writes single text strings at specified (x,y) locations?  So test output
> > from an R xfig driver would not be richly structured?  Yes, there is
> > kerning but there is using postscript fonts directly, surely?
> > By the time a dvixx driver is reading the dvi file the kerning has been
> > done, but the information is all there in the tfm, and the format is
> > readily available (e.g. in tftopl).
> 
> But what about plotmath? If we want to get the equivalent of
> \alpha*\text{threshold}_i (say) to come out right then we need to know
> the length of "threshold" in the relevant font... Of course you could

Do you mean *width* of "threshold"?  That's exactly what I was envisaging.
Even to plot "threshold" centred you need to know its width and height and
depth: see GText.

As I understand it plotmath computes the locations of the pieces ("alpha"
and "threshold" and "i" in the example) and outputs them as separate
strings.  And as far as I can see plotmath does not use kerning information
(look at RenderStr in plotmath.c) to find the string's bounding box, even
though the postscript renderer will.  Similar, the GStrWidth for the 
postscript device just adds up the character widths and so ignores kerning.

> (potentially) get the driver to output actual TeX, but then you have
> no inkling about the total size of the formula object, and it comes
> out as TeX code inside XFig. Xfig is pretty much geared towards
> postscript fonts, so I suppose the most practical thing to do is to
> assume PS as the final target and accept the approximations caused by
> the screen fonts while previewing. 

I think I said that in part of my posting which you omitted!


Summary: 

R currently seems to ignore kerning in computing string dimensions.

Finding char info from tfm files is easy: there is lots of example code.

For an xfig device one could (at least initially) use the existing 
information on postscript fonts, and only allow those to be used in the
device.  I think the same applies to a metapost device.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Sat Apr  8 10:37:19 2000
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 08 Apr 2000 11:37:19 +0200
Subject: xfig device (was [Rd] Re: [R] MetaPost device?)
In-Reply-To: Prof Brian D Ripley's message of "Sat, 8 Apr 2000 10:08:40 +0100 (BST)"
References: <Pine.GSO.4.05.10004080943340.8001-100000@auk.stats>
Message-ID: <x2r9chhr1s.fsf@blueberry.kubism.ku.dk>

Prof Brian D Ripley <ripley@stats.ox.ac.uk> writes:

> > the length of "threshold" in the relevant font... Of course you could
> 
> Do you mean *width* of "threshold"?  

Um, yes. The *length* is 9, I suppose.

> > (potentially) get the driver to output actual TeX, but then you have
> > no inkling about the total size of the formula object, and it comes
> > out as TeX code inside XFig. Xfig is pretty much geared towards
> > postscript fonts, so I suppose the most practical thing to do is to
> > assume PS as the final target and accept the approximations caused by
> > the screen fonts while previewing. 
> 
> I think I said that in part of my posting which you omitted!

So you did. (I must have woken up too early today...) What I forgot to
add was something to the effect that as long as you keep formulas as
"compound objects" in XFig then it shouldn't be a major obstacle to
moving the labels around.

> R currently seems to ignore kerning in computing string dimensions.

..which we should probably fix at some point. Can't be that hard?
(BTW, I forget whether Postscript itself does kerning by default or
one has to use a special string operator to obtain it?)

Also, I suspect that some of the finer points of the Appendix G of the
TeXbook are getting lost -- the micro-spacing in formulas appear to be
not quite right.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Sat Apr  8 11:31:15 2000
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Sat, 8 Apr 2000 11:31:15 +0100 (BST)
Subject: [Rd] x11 colortype problems ('gray' is broken?) (PR#512)
In-Reply-To: <200004071553.RAA13862@pubhealth.ku.dk>
Message-ID: <Pine.GSO.4.05.10004081123590.6335-100000@auk.stats>

On Fri, 7 Apr 2000 tov@ece.cmu.edu wrote:

> 
> Hi,
> 
>   I occasionally run out of color in my X11 terminal.  At this
> point, R will issue this error message:
>         Error: X11 cannot allocate additional graphics colors.
> Consider using colortype="pseudo.cube" or "gray".
> 
> An immediate x11(colortype="pseudo.cube") doesn't work as the
> colortype seems to be shared among the different x11 plotting windows.
> So I have to close all windows first, then I can open an x11 device
> with the colortype "pseudo.cube".  (Neither the necessity to close all
> windows nor the fact, that colortype is an option to X11 and not to
> the plot command, is clear from the help pages or the error message.)

There is a single colortype shared by all x11 devices.  That couild eb
clearer!

> The real problem, however, comes with x11(colortype="gray") as this
> brings up just a black screen (and it stays black).  I can't quite see
> whether I'm stumbling across some issues with X resources, here.
> x11() usually gives a white background.

No. It's a bug.  When you set x11(colortype="gray") it tries to allocate
min(256, 2^depth) colours, that is all the colours on an 8-bit display.
That is clearly going to fail (unless perhaps your window manager is 
in mono).  So it does fail, set PaletteSize = 0, and then maps all
colours to black.  That's what the x11 driver seems to do when colour
allocation fails.  I suspect it should not open at all under those 
circumstances.

Quick fix:

static void SetupGrayScale()
{
    PaletteSize = 0;
    if (depth > 7)
	depth = 7;
    if (GetGrayPalette(display, colormap, 1 << depth) == 0)
	depth = 1;
}

(8 replaced by 7) in devX11.c.  I'll commit a more sophisticated one
to R-release.


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From erich.neuwirth@univie.ac.at  Sun Apr  9 10:23:26 2000
From: erich.neuwirth@univie.ac.at (Erich Neuwirth)
Date: Sun, 09 Apr 2000 11:23:26 +0200
Subject: [Rd] cannot compile on solaris
References: <Pine.GSO.4.05.10004080813230.7242-100000@auk.stats>
Message-ID: <38F04C0E.859AA7E8@univie.ac.at>

mystery solved.
the machine did not have perl installed.
BUT
probably there should be a more informative warning message,
and perhaps configure should complain more audibly.


Prof Brian D Ripley wrote:
> 
> On Sat, 8 Apr 2000, Erich Neuwirth wrote:
> 
> > on my old sun ipx with gcc and texinfo installed
> > u run ./configure ok, and then i get
> >
> > [szego@neuwirth:/install/R-1.0.0] make
> > make[1]: Entering directory `/install/R-1.0.0/tools'
> > make[1]: Nothing to be done for `R'.
> > make[1]: Leaving directory `/install/R-1.0.0/tools'
> > make[1]: Entering directory `/install/R-1.0.0/afm'
> > make[1]: Leaving directory `/install/R-1.0.0/afm'
> > make[1]: Entering directory `/install/R-1.0.0/doc'
> > false: false: cannot open
> > make[1]: *** [R] Error 1
> > make[1]: Leaving directory `/install/R-1.0.0/doc'
> > make: *** [R] Error 1
> >
> > what is happening?
> 
> false should be in /usr/bin/false:
> auk% which false
> /usr/bin/false
> auk% ls -l `which false`
> -r-xr-xr-x   1 bin      bin           314 Jul 16  1997 /usr/bin/false*
> 
> It is not clear from your output what this is trying to do: I get
> auk% make -n R
> /opt/R/cvs/R/tools/mkinstalldirs ../doc/html/search
> cat /opt/R/cvs/R/doc/html/search/SearchEngine-head.html > \
>   ../doc/html/search/SearchEngine.html
> ../tools/keywords2html /opt/R/cvs/R/doc/KEYWORDS.db >> \
>   ../doc/html/search/SearchEngine.html
> cat /opt/R/cvs/R/doc/html/search/SearchEngine-foot.html >> \
>   ../doc/html/search/SearchEngine.html
> if [ "/opt/R/cvs/R/doc" != "." ]; then \
>   make rhome=.. install-html; \
>   (cd manual && make R); \
> fi
> echo "installing doc ..."
> ...
> 
> so one of these is failing (and I think not the if clause as that should
> echo something). Can you do the same and track down what has not been
> created?
> 
> --
> Brian D. Ripley,                  ripley@stats.ox.ac.uk
> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> University of Oxford,             Tel:  +44 1865 272861 (self)
> 1 South Parks Road,                     +44 1865 272860 (secr)
> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
> 
> -.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
> r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
> Send "info", "help", or "[un]subscribe"
> (in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
> _._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Mon Apr 10 06:46:39 2000
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 10 Apr 2000 07:46:39 +0200
Subject: [Rd] R CMD build/check
Message-ID: <200004100546.HAA14716@aragorn.ci.tuwien.ac.at>

I would like to bring the attention of R package maintainers/developers
to the mechanisms for checking and building add-on packages that come
with the R distribution.

* R CMD check has been around for a while.  It can be used for run-time
testing the examples that come with an installed add-on package.  Recent
development versions of R also have preliminary support for additional
specific regression testing.

* R CMD build should be used for actually building the add-on packages,
in particular if you are planning to upload them to CRAN.  From the R
Extension Writers Guide:

	Prior to actually building the package in the common gzipped tar
	file format, a variety of diagnostic checks and cleanups are
	performed.  In particular, it is tested whether the
	`DESCRIPTION' file contains the required entries, whether object
	and data indices exist and can be assumed to be up-to-date,
	whether the documentation sources contain the required name,
	alias, title, description, and keyword information, and whether
	there are any undocumented user level objects.

Please try to eliminate all problems reported by the R package builder
before submitting a package to CRAN.

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Mon Apr 10 09:41:48 2000
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Mon, 10 Apr 2000 10:41:48 +0200 (CEST)
Subject: [Rd] R CMD build/check
In-Reply-To: <200004100546.HAA14716@aragorn.ci.tuwien.ac.at>
References: <200004100546.HAA14716@aragorn.ci.tuwien.ac.at>
Message-ID: <14577.37836.184592.123670@lynne.ethz.ch>

>>>>> "KH" == Kurt Hornik <hornik@ci.tuwien.ac.at> writes:

    KH> I would like to bring the attention of R package maintainers/developers
    KH> to the mechanisms for checking and building add-on packages that come
    KH> with the R distribution.

    KH> * R CMD check has been around for a while.  It can be used for run-time
    KH> testing the examples that come with an installed add-on package.  Recent
    KH> development versions of R also have preliminary support for additional
    KH> specific regression testing.

    KH> * R CMD build should be used for actually building the add-on packages,
    KH> in particular if you are planning to upload them to CRAN.  From the R
    KH> Extension Writers Guide:

    KH> Prior to actually building the package in the common gzipped tar
    KH> file format, a variety of diagnostic checks and cleanups are
    KH> performed.  In particular, it is tested whether the
    KH> `DESCRIPTION' file contains the required entries, whether object
    KH> and data indices exist and can be assumed to be up-to-date,
    KH> whether the documentation sources contain the required name,
    KH> alias, title, description, and keyword information, and whether
    KH> there are any undocumented user level objects.

    KH> Please try to eliminate all problems reported by the R package builder
    KH> before submitting a package to CRAN.

The "data index" is mentioned in the R Extensions Writer guide as
>> The subdirectory should contain a `00Index' file
>> that describes the datasets available.

Now since this is now required,  
what is the format of that file? what must/should it contain?
Shouldn't this be built automatically from the data's *.Rd files when it
doesn't exist?

Thanks for any clarification; the requirement of this 00Index has been new
for me (must have slept at some time in the past...).

Martin.
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Mon Apr 10 14:25:52 2000
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Mon, 10 Apr 2000 09:25:52 -0400
Subject: [Rd] 00Index of data
Message-ID: <38F1D65F.F70F0FFF@bank-banque-canada.ca>

The "data index" is mentioned in the R Extensions Writer guide as
>> The subdirectory should contain a `00Index' file
>> that describes the datasets available.

I'm not sure what the official format is suppose to be, but given that
it displays like an index, this has to be a very short description which
I find somewhat inadequate. Some of my data sets are multivariate time
series and it is impossible to describe them in such a brief format, so
I have resorted to very poor descriptions like "data used in ...".  It
would be nice to have a facility to give a more complete description of
the data.

Paul Gilbert

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Prof Brian Ripley <ripley@stats.ox.ac.uk>  Mon Apr 10 14:33:10 2000
From: Prof Brian Ripley <ripley@stats.ox.ac.uk> (Prof Brian Ripley)
Date: Mon, 10 Apr 2000 14:33:10 +0100 (BST)
Subject: [Rd] 00Index of data
Message-ID: <200004101333.OAA22020@toucan.stats.ox.ac.uk>


> Date: Mon, 10 Apr 2000 09:25:52 -0400
> From: Paul Gilbert <pgilbert@bank-banque-canada.ca>
> To: r-devel <r-devel@stat.math.ethz.ch>
> Subject: [Rd] 00Index of data
> 
> The "data index" is mentioned in the R Extensions Writer guide as
> >> The subdirectory should contain a `00Index' file
> >> that describes the datasets available.
> 
> I'm not sure what the official format is suppose to be, but given that
> it displays like an index, this has to be a very short description which
> I find somewhat inadequate. Some of my data sets are multivariate time
> series and it is impossible to describe them in such a brief format, so
> I have resorted to very poor descriptions like "data used in ...".  It
> would be nice to have a facility to give a more complete description of
> the data.

There is no restriction on the format.  The only use is with data()
to show what is available. But a few lines should suffice to 
indicate if it is worth looking up the help page for the data.
(And that needs a one-line title.)

The same comments apply to the INDEX file: you can let build
generate it, but several packages have hand-customised files (e.g.boot).

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Mon Apr 10 15:25:41 2000
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Mon, 10 Apr 2000 10:25:41 -0400
Subject: [Rd] 00Index of data
References: <200004101333.OAA22020@toucan.stats.ox.ac.uk>
Message-ID: <38F1E464.C7976425@bank-banque-canada.ca>

>the help page for the data.

Now that's something I didn't know about but is probably documented
somewhere that I missed. (No wonder I found the index rather
restrictive.) I now see it is reported as missing documentation by R CMD
build. (It is buried by all the other warnings.) I guess it should just
be an Rd file like the function help. Does a link get automatically
built from the 00Index of the data to the help for data or do I need to
point readers to the help? Or will the 00Index of the data get built
automatically from the titles in the data help files in the same way
that the function index is built? (And if so, how does it know the
documentation is for data?)

Thanks,
Paul Gilbert

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Prof Brian Ripley <ripley@stats.ox.ac.uk>  Mon Apr 10 15:31:49 2000
From: Prof Brian Ripley <ripley@stats.ox.ac.uk> (Prof Brian Ripley)
Date: Mon, 10 Apr 2000 15:31:49 +0100 (BST)
Subject: [Rd] 00Index of data
Message-ID: <200004101431.PAA22511@toucan.stats.ox.ac.uk>


> Date: Mon, 10 Apr 2000 10:25:41 -0400
> From: Paul Gilbert <pgilbert@bank-banque-canada.ca>
> To: Prof Brian Ripley <ripley@stats.ox.ac.uk>
> CC: r-devel@stat.math.ethz.ch
> Subject: Re: [Rd] 00Index of data
> 
> >the help page for the data.
> 
> Now that's something I didn't know about but is probably documented
> somewhere that I missed. (No wonder I found the index rather
> restrictive.) I now see it is reported as missing documentation by R CMD
> build. (It is buried by all the other warnings.) I guess it should just

When you solve all the others it will emerge more clearly :)

> be an Rd file like the function help. 

Yes, and `Writing R Extensions' tells you about making help files for data.
And the base system has them. (So does S-PLUS!)

> Does a link get automatically
> built from the 00Index of the data to the help for data or do I need to
> point readers to the help?

Readers are supposed to know to look for help on R *objects* (not
just functions).  Even the help.start intro says `Functions & Datasets'

>  Or will the 00Index of the data get built
> automatically from the titles in the data help files in the same way
> that the function index is built? (And if so, how does it know the
> documentation is for data?)

It does not get built, and help for data goes in INDEX. (That is
one reason why some of us prefer hand-crafted INDEX files.)
We are moving towards a way to distinguish the object type in a help file,
but are not there yet.


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Mon Apr 10 16:32:28 2000
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Mon, 10 Apr 2000 11:32:28 -0400
Subject: [Rd] R CMD build/check
References: <200004100546.HAA14716@aragorn.ci.tuwien.ac.at>
Message-ID: <38F1F40B.56C0A7B@bank-banque-canada.ca>

Let me start out by saying that after using "R CMD build" for a few days
it appears to be a truely wonderful facility, even if I didn't really
want to know about all the problems with my packages right now.

>Please try to eliminate all problems reported by the R package builder
>before submitting a package to CRAN.

Now here are a few caveates. Please let me know if  I'm not aware of
something that has already been fixed.

1/ I'm using a file 00General_Description.Rd to provide a general
description of the package. This gets reported as an Rd file without
alias, but even though the package builder reports that as a problem I
didn't intend to eliminate it.

2/ Specific methods get reported as undocumented functions unless the
generic documentation has an alias line for the specific method. This is
not a problem when everything is in one package, however, for many of my
specific methods  the generic method is in another of my packages or in
the base. (This can generate a lot of warning, which obscure more
important warnings.) I'm putting a "stub" description in to eliminate
all the warnings, but I'm not sure if this is the ideal way to do this.

3/ Data sets cannot use constructors in the package. They need to be
structures which can be fully recognized by the base system. (.rda files
may be a better alternative in this case?)

4/ R CMD build does not work for bundles, but it can be used to test
sub-packages and then the bundle rolled up afterwards directly with tar
and gzip. (This is not difficult and not a problem, but people should be
aware of it.)

Paul Gilbert

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Mon Apr 10 21:25:45 2000
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Mon, 10 Apr 2000 16:25:45 -0400
Subject: [Rd] 2 \alias{obj}
Message-ID: <38F238C8.DC36720B@bank-banque-canada.ca>

R CMD build does not seems to complain about an alias for the same
object in two different .Rd files. Should that be allowed? I don't see
when it would be legitimate.  (And I didn't intend to do this and would
have expected for a warning.)

Paul Gilbert

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Mon Apr 10 21:30:37 2000
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Mon, 10 Apr 2000 21:30:37 +0100 (BST)
Subject: [Rd] 2 \alias{obj}
In-Reply-To: <38F238C8.DC36720B@bank-banque-canada.ca>
Message-ID: <Pine.GSO.4.05.10004102128170.24235-100000@auk.stats>

On Mon, 10 Apr 2000, Paul Gilbert wrote:

> R CMD build does not seems to complain about an alias for the same
> object in two different .Rd files. Should that be allowed? I don't see
> when it would be legitimate.  (And I didn't intend to do this and would
> have expected for a warning.)

If you mean in the same package, just installing will object. (As with
survreg.old in survival5, Thomas.)  If in different packages, no ban!

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From telford@progsoc.uts.edu.au  Tue Apr 11 02:32:15 2000
From: telford@progsoc.uts.edu.au (Telford Tendys)
Date: Tue, 11 Apr 2000 11:32:15 +1000
Subject: xfig device (was [Rd] Re: [R] MetaPost device?)
In-Reply-To: <Pine.GSO.4.05.10004080943340.8001-100000@auk.stats>; from ripley@stats.ox.ac.uk on Sat, Apr 08, 2000 at 10:08:40AM +0100
References: <x2em8hyolh.fsf@blueberry.kubism.ku.dk> <Pine.GSO.4.05.10004080943340.8001-100000@auk.stats>
Message-ID: <20000411113215.E7411@ftoomsh.progsoc.uts.edu.au>

> Even to plot "threshold" centred you need to know its width and height and
> depth: see GText.

In xfig you can choose for a string to be centered and then give it
the string and the centre-point and it figures out the rest, it also
outputs this correctly centred despite font variations.

Admittedly, just being able to centre-justify a string doesn't solve
the problem of plotting an equation but it might help in a few cases...

Also, there is a ghostscript operator for getting the width of a string:

stringwidth

     * USAGE:   str stringwidth
     * RESULTS   x y

     calculates the change in the current point which would occur using
     "show", but doesn't actually draw the string
  
[http://www.colorado.edu/ITS/docs/scientific/gs/GSO.html]

Running up gs in the background in order to do font calculations
seems a bit messy but it would be easy to achieve and it kind of fits
with the unix philosophy of each program does it's own job well and
doesn't try to overlap its neighbour. Maybe it is fair to presume that
the win-32 users don't want xfig output? They probably want ms-draw or
something...

> As I understand it plotmath computes the locations of the pieces ("alpha"
> and "threshold" and "i" in the example) and outputs them as separate
> strings.  And as far as I can see plotmath does not use kerning information
> (look at RenderStr in plotmath.c) to find the string's bounding box, even
> though the postscript renderer will.  Similar, the GStrWidth for the 
> postscript device just adds up the character widths and so ignores kerning.

Yeah, I've noticed that some of the R outputs don't look quite as good as
latex but they still look better than just about any other plotter. Sometimes
I get latex to splat the formulas down onto the diagrams which is a dirty
trick but the reader of the printed copy only sees the end result not the
method.

> Finding char info from tfm files is easy: there is lots of example code.
> 
> For an xfig device one could (at least initially) use the existing 
> information on postscript fonts, and only allow those to be used in the
> device.  I think the same applies to a metapost device.

Which would make the xfig-device depend on having tex installed which seems
kind of illogical but no worse than insisting that gs in installed. Most
people who use xfig also use both tex and gs. Perhaps R could look around
for tfm files, use them if it finds them, and resort to counting the
characters if it can't think of anything better to do (i.e. some output
with small kerning errors is better than no output at all).

	- Tel
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Tue Apr 11 07:25:50 2000
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Tue, 11 Apr 2000 07:25:50 +0100 (BST)
Subject: xfig device (was [Rd] Re: [R] MetaPost device?)
In-Reply-To: <20000411113215.E7411@ftoomsh.progsoc.uts.edu.au>
Message-ID: <Pine.GSO.4.05.10004110718120.4502-100000@auk.stats>

On Tue, 11 Apr 2000, Telford Tendys wrote:

> > Even to plot "threshold" centred you need to know its width and height and
> > depth: see GText.
> 
> In xfig you can choose for a string to be centered and then give it
> the string and the centre-point and it figures out the rest, it also
> outputs this correctly centred despite font variations.

Eh?  R allows proportional centring (adj can be between 0 and 1) and my
point was that the R driver model *requires* the knowledge. As I said, see
the code for GText.

> Admittedly, just being able to centre-justify a string doesn't solve
> the problem of plotting an equation but it might help in a few cases...
> 
> Also, there is a ghostscript operator for getting the width of a string:
> 
> stringwidth
> 
>      * USAGE:   str stringwidth
>      * RESULTS   x y
> 
>      calculates the change in the current point which would occur using
>      "show", but doesn't actually draw the string
>   
> [http://www.colorado.edu/ITS/docs/scientific/gs/GSO.html]
> 
> Running up gs in the background in order to do font calculations
> seems a bit messy but it would be easy to achieve and it kind of fits
> with the unix philosophy of each program does it's own job well and
> doesn't try to overlap its neighbour. Maybe it is fair to presume that
> the win-32 users don't want xfig output? They probably want ms-draw or
> something...

It's not fair, and they also want postscript and the code for this in
postscript is already internal to R (less kerning, it seems).

My point, which you seem to have missed, is that existing code for font
metric information could be used in an xfig driver.

> > As I understand it plotmath computes the locations of the pieces ("alpha"
> > and "threshold" and "i" in the example) and outputs them as separate
> > strings.  And as far as I can see plotmath does not use kerning information
> > (look at RenderStr in plotmath.c) to find the string's bounding box, even
> > though the postscript renderer will.  Similar, the GStrWidth for the 
> > postscript device just adds up the character widths and so ignores kerning.
> 
> Yeah, I've noticed that some of the R outputs don't look quite as good as
> latex but they still look better than just about any other plotter. Sometimes
> I get latex to splat the formulas down onto the diagrams which is a dirty
> trick but the reader of the printed copy only sees the end result not the
> method.
> 
> > Finding char info from tfm files is easy: there is lots of example code.
> > 
> > For an xfig device one could (at least initially) use the existing 
> > information on postscript fonts, and only allow those to be used in the
> > device.  I think the same applies to a metapost device.
> 
> Which would make the xfig-device depend on having tex installed which seems
> kind of illogical but no worse than insisting that gs in installed. Most
> people who use xfig also use both tex and gs. Perhaps R could look around
> for tfm files, use them if it finds them, and resort to counting the
> characters if it can't think of anything better to do (i.e. some output
> with small kerning errors is better than no output at all).

Eh? If we restrict to postscript fonts we can use the afms which we already
have. There would be no need for tex at all.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From telford@progsoc.uts.edu.au  Tue Apr 11 08:21:44 2000
From: telford@progsoc.uts.edu.au (Telford Tendys)
Date: Tue, 11 Apr 2000 17:21:44 +1000
Subject: xfig device (was [Rd] Re: [R] MetaPost device?)
In-Reply-To: <Pine.GSO.4.05.10004110718120.4502-100000@auk.stats>; from ripley@stats.ox.ac.uk on Tue, Apr 11, 2000 at 07:25:50AM +0100
References: <20000411113215.E7411@ftoomsh.progsoc.uts.edu.au> <Pine.GSO.4.05.10004110718120.4502-100000@auk.stats>
Message-ID: <20000411172144.A22534@ftoomsh.progsoc.uts.edu.au>

On Tue, Apr 11, 2000 at 07:25:50AM +0100, Prof Brian D Ripley wrote:
> On Tue, 11 Apr 2000, Telford Tendys wrote:
> 
> > > Even to plot "threshold" centred you need to know its width and height and
> > > depth: see GText.
> > 
> > In xfig you can choose for a string to be centered and then give it
> > the string and the centre-point and it figures out the rest, it also
> > outputs this correctly centred despite font variations.
> 
> Eh?  R allows proportional centring (adj can be between 0 and 1) and my
> point was that the R driver model *requires* the knowledge. As I said, see
> the code for GText.

Hmm, OK xfig only supports left, right and centre, and now I look closer
at the drivers I see that there is a slot for a string width function.
I also notice the PS driver supports the string width function by simply
summing up the character widths from the afm (see the PostScriptStringWidth
function in devPS.c).

So I agree, make the assumption that all xfig fonts are postscript fonts and
share code with the PS driver for string width.

There should be a fancier implementation of the string width calculation
inside the GNU ghostscript source somewhere. Since that is GPL code it
should be OK to paste into R (adapting it should not be too difficult),
this would include all kerning stuff and would guarantee compatability
between the R driver and the printout (if I remember rightly, gs is built
from lots and lots of little source files, each one implementing one function).

> My point, which you seem to have missed, is that existing code for font
> metric information could be used in an xfig driver.

Yup, I'm with you now.

	- Tel
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From plummer@iarc.fr  Tue Apr 11 11:23:24 2000
From: plummer@iarc.fr (plummer@iarc.fr)
Date: Tue, 11 Apr 2000 12:23:24 +0200 (MET DST)
Subject: [Rd] start.ts, end.ts (PR#513)
Message-ID: <200004111023.MAA11374@pubhealth.ku.dk>

I'm having trouble with column-subsetting a multivariate time
series.  The underlying problem is with start().

R> x <- ts(matrix(rnorm(100), ncol=2))
R> y <- aggregate(x, ndeltat=2)
R> y[,1]
Error in ts(y, start = start(x), freq = frequency(x)) :
        invalid start
R> start(y)
[1] 2 1
R> frequency(y)
[1] 0.5

The point where the error occurs in ts() is:

    if(length(start) > 1) {
        if(start[2] > frequency) stop("invalid start")
        ...

IMHO the 2-vector notation for the start and end of a time series makes
sense only when the frequency is an integer (and I believe I have said
this before). S-PLUS seems to follow this convention:

S> x <- ts(rnorm(10), start=3, frequency=1/3)
S> start(x)
[1] 3
S> end(x)
[1] 30
S> x <- ts(rnorm(10), start=1/3, frequency=3)
S> start(x)
[1] 0 2
S> end(x)
[1] 3 2

whereas R gives c(0,2) in both cases.

My suggested fix is to edit start.default and end.default, replacing

if(abs(is-round(is)) < ts.eps)

with

if(abs(tsp[3] - round(tsp[3])) < ts.eps && abs(is - round(is)) < ts.eps)

Martyn

--please do not edit the information below--

Version:
 platform = i686-unknown-linux
 arch = i686
 os = linux
 system = i686, linux
 status =
 major = 1
 minor = 0.0
 year = 2000
 month = February
 day = 29
 language = R

Search Path:
 .GlobalEnv, Autoloads, package:base



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From plummer@iarc.fr  Tue Apr 11 11:27:28 2000
From: plummer@iarc.fr (plummer@iarc.fr)
Date: Tue, 11 Apr 2000 12:27:28 +0200 (MET DST)
Subject: [Rd] aggregate.ts (PR#514)
Message-ID: <200004111027.MAA11464@pubhealth.ku.dk>

aggregate.ts does not behave in the same way as the equivalent
method aggregate.rts in S-PLUS. In particular it
- changes the start of the time series
- tends to have a length which is 1 shorter

For example:

R> x <- ts(1:10)
R> aggregate(x, nfreq=0.5, FUN=min)
Time Series:
Start = 2 
End = 8 
Frequency = 0.5 
[1] 2 4 6 8

S> x <- rts(1:10)
S> aggregate(x, nf=0.5, fun = min)
[1] 1 3 5 7 9
 start deltat frequency 
     1      2       0.5

I have edited the aggregate.ts function to reproduce the S-PLUS
behaviour, which I find more intuitive:

old:
    #nstart <- ceiling(tsp(x)[1] * nfrequency)/nfrequency
    #x <- as.matrix(window(x, start = nstart))
new:    
    nstart <- tsp(x)[1]
    # Can't use nstart <- start(x) as this causes problems if
    # you get a vector of length 2.
    x <- as.matrix(x)

I have tried this on a range of examples and have not encountered
any problems, but of course I may be missing something.

Martyn

--please do not edit the information below--

Version:
 platform = i686-unknown-linux
 arch = i686
 os = linux
 system = i686, linux
 status =
 major = 1
 minor = 0.0
 year = 2000
 month = February
 day = 29
 language = R

Search Path:
 .GlobalEnv, Autoloads, package:base

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Tue Apr 11 14:44:27 2000
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Tue, 11 Apr 2000 09:44:27 -0400
Subject: [Rd] 2 \alias{obj}
References: <Pine.GSO.4.05.10004102128170.24235-100000@auk.stats>
Message-ID: <38F32C3B.E25D17D8@bank-banque-canada.ca>

>> R CMD build does not seems to complain about an alias for the same
>> object in two different .Rd files. Should that be allowed? I don't see
>> when it would be legitimate.  (And I didn't intend to do this and would
>> have expected for a warning.)

>If you mean in the same package, just installing will object. (As with
>survreg.old in survival5, Thomas.)

Ok, thanks. I was just revising documentation and running R CMD build, not
re-installing. I see now that install gives a warning.

>If in different packages, no ban!

Is this considered a problem or are there situations were it really makes sense
(other than to perpetuate the problem of name space conflicts)?

Paul Gilbert



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Tue Apr 11 14:53:39 2000
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Tue, 11 Apr 2000 14:53:39 +0100 (BST)
Subject: [Rd] 2 \alias{obj}
In-Reply-To: <38F32C3B.E25D17D8@bank-banque-canada.ca>
Message-ID: <Pine.GSO.4.05.10004111450100.8685-100000@auk.stats>

On Tue, 11 Apr 2000, Paul Gilbert wrote:

> >> R CMD build does not seems to complain about an alias for the same
> >> object in two different .Rd files. Should that be allowed? I don't see
> >> when it would be legitimate.  (And I didn't intend to do this and would
> >> have expected for a warning.)
> 
> >If you mean in the same package, just installing will object. (As with
> >survreg.old in survival5, Thomas.)
> 
> Ok, thanks. I was just revising documentation and running R CMD build, not
> re-installing. I see now that install gives a warning.

Before the final build, we expect you to have

1) INSTALL-ed successfully
2) run R CMD check
3) run Rd2dvi on the man directory

and I guess this should be in the R-exts manual.

> >If in different packages, no ban!
> 
> Is this considered a problem or are there situations were it really makes sense
> (other than to perpetuate the problem of name space conflicts)?

Well, once upon a time package ts had enhanced versions of some of the 
functions in base, with enhanced docs too, and on S MASS has enhanced
versions of functions in base and survival5, with enhanced docs.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Tue Apr 11 17:08:09 2000
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 11 Apr 2000 18:08:09 +0200
Subject: [Rd] cannot compile on solaris
In-Reply-To: <38F04C0E.859AA7E8@univie.ac.at>
References: <Pine.GSO.4.05.10004080813230.7242-100000@auk.stats>
 <38F04C0E.859AA7E8@univie.ac.at>
Message-ID: <200004111608.SAA15146@aragorn.ci.tuwien.ac.at>

>>>>> Erich Neuwirth writes:

> mystery solved.  the machine did not have perl installed.  BUT
> probably there should be a more informative warning message, and
> perhaps configure should complain more audibly.

O.k., improved now.

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Wed Apr 12 07:24:05 2000
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 12 Apr 2000 08:24:05 +0200 (CEST)
Subject: [Rd] 00Index of data
In-Reply-To: <200004101431.PAA22511@toucan.stats.ox.ac.uk>
References: <200004101431.PAA22511@toucan.stats.ox.ac.uk>
Message-ID: <14580.5765.300868.265594@aragorn.ci.tuwien.ac.at>

>>>>> Prof Brian Ripley writes:

>> Date: Mon, 10 Apr 2000 10:25:41 -0400
>> From: Paul Gilbert <pgilbert@bank-banque-canada.ca>
>> To: Prof Brian Ripley <ripley@stats.ox.ac.uk>
>> CC: r-devel@stat.math.ethz.ch
>> Subject: Re: [Rd] 00Index of data
>> 
>> >the help page for the data.
>> 
>> Now that's something I didn't know about but is probably documented
>> somewhere that I missed. (No wonder I found the index rather
>> restrictive.) I now see it is reported as missing documentation by R CMD
>> build. (It is buried by all the other warnings.) I guess it should just

> When you solve all the others it will emerge more clearly :)

:-)

>> be an Rd file like the function help. 

> Yes, and `Writing R Extensions' tells you about making help files for
> data.  And the base system has them. (So does S-PLUS!)

>> Does a link get automatically
>> built from the 00Index of the data to the help for data or do I need to
>> point readers to the help?

> Readers are supposed to know to look for help on R *objects* (not just
> functions).  Even the help.start intro says `Functions & Datasets'

>> Or will the 00Index of the data get built
>> automatically from the titles in the data help files in the same way
>> that the function index is built? (And if so, how does it know the
>> documentation is for data?)

> It does not get built, and help for data goes in INDEX. (That is one
> reason why some of us prefer hand-crafted INDEX files.)  We are moving
> towards a way to distinguish the object type in a help file, but are
> not there yet.

Correction: R CMD build will try to build/update the documentation index
(`INDEX') as well as the data index (`data/00Index').  The latter, as I
think Paul expected, happens by taking the names of all Rd files that
contain the keyword `datasets' (which again shows how important it is to
eliminate all warnings about Rd files without keywords etc).

The problem is that package developers might register more (or less)
information in their INDEX than obtained via this procedure.  E.g., if
an Rd file documents more than one object, the alias mechanism ensures
that documentation for all objects is found, but it is not smart enough
to ensure that all objects documented get a corresponding index entry.

The solution would be to introduce something like

	\index{NAME}{DESCRIPTION}

lines in the Rd files, and in fact have the index built from these lines
exclusively rather than the names.  But first we must know what `NAME'
exactly should be here, e.g. whether we only want to list *OBJECTS* in
the index or *ALL* topics being documented.

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Wed Apr 12 07:29:38 2000
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 12 Apr 2000 08:29:38 +0200 (CEST)
Subject: [Rd] R CMD build/check
In-Reply-To: <38F1F40B.56C0A7B@bank-banque-canada.ca>
References: <200004100546.HAA14716@aragorn.ci.tuwien.ac.at>
 <38F1F40B.56C0A7B@bank-banque-canada.ca>
Message-ID: <14580.6098.971883.305959@aragorn.ci.tuwien.ac.at>

>>>>> Paul Gilbert writes:

> Let me start out by saying that after using "R CMD build" for a few days
> it appears to be a truely wonderful facility, even if I didn't really
> want to know about all the problems with my packages right now.

>> Please try to eliminate all problems reported by the R package builder
>> before submitting a package to CRAN.

> Now here are a few caveates. Please let me know if  I'm not aware of
> something that has already been fixed.

> 1/ I'm using a file 00General_Description.Rd to provide a general
> description of the package. This gets reported as an Rd file without
> alias, but even though the package builder reports that as a problem I
> didn't intend to eliminate it.

The rule is as follows (from the R Extension Writers guide):

  `\alias{TOPIC}'
     The `\alias' entries specify all "topics" the file documents.
     This information (together with the file name) is collected into
     index data bases for lookup by the on-line (plain text and HTML)
     help systems.

     There may be several `\alias' entries.  Quite often it is
     convenient to document several R objects in one file.  For example,
     file `Normal.Rd' documents the density, distribution function,
     quantile function and generation of random variates for the normal
     distribution, and hence starts with

          \name{Normal}
          \alias{dnorm}
          \alias{pnorm}
          \alias{qnorm}
          \alias{rnorm}

     Note that the name of the file is not necessarily a topic
     documented.

Hence, an Rd file without an alias is pointless because it does not
register any topic it provides information for.

> 2/ Specific methods get reported as undocumented functions unless the
> generic documentation has an alias line for the specific method. This
> is not a problem when everything is in one package, however, for many
> of my specific methods the generic method is in another of my packages
> or in the base. (This can generate a lot of warning, which obscure
> more important warnings.) I'm putting a "stub" description in to
> eliminate all the warnings, but I'm not sure if this is the ideal way
> to do this.

Not sure if I understand this correctly.  If you have a specific method
say foo.dse then you'd have

  \alias{foo.dse}

etc.  So why would this be undocumented?

> 3/ Data sets cannot use constructors in the package. They need to be
> structures which can be fully recognized by the base system. (.rda
> files may be a better alternative in this case?)

Yes.  I will add something on this to the R-exts.

> 4/ R CMD build does not work for bundles, but it can be used to test
> sub-packages and then the bundle rolled up afterwards directly with
> tar and gzip. (This is not difficult and not a problem, but people
> should be aware of it.)

I should add something on this too.  Perhaps, Paul, once you release dse
as a package bundle I can try to make R CMD build work for bundles, too.

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From plummer@iarc.fr  Wed Apr 12 10:55:37 2000
From: plummer@iarc.fr (plummer@iarc.fr)
Date: Wed, 12 Apr 2000 11:55:37 +0200 (MET DST)
Subject: [Rd] For wishlist: sanity checks for subsets in lm, glm (PR#515)
Message-ID: <200004120955.LAA22235@pubhealth.ku.dk>

I got stung by this yesterday:

R> x <- seq(0,1,length=101)
R> y <- x + rnorm(101)/5
R> test.data <- data.frame(x=x, y=y, cond=(x <= 0.5))
R> # A perfect fit! But very implausible parameter estimates.
R> glm(y ~ x, data=test.data, subset=cond)

Call:  glm(formula = y ~ x, data = test.data, subset = cond) 

Coefficients:
(Intercept)            x  
    -0.1283      29.5571  

Degrees of Freedom: 100 Total (i.e. Null);  99 Residual
Null Deviance:      2.206 
Residual Deviance: 3.929e-32    AIC: -7477 
R> # Here's why ...
R> test.data2 <- test.data[test.data$cond, ]
R> table(test.data2$x, test.data2$y)
      
       -0.128278372512167 0.167292488167292
  0                    50                 0
  0.01                  0                51
R> # ... I just replicated the first two rows
R> test.data[1:2,]
     x          y cond
1 0.00 -0.1282784 TRUE
2 0.01  0.1672925 TRUE

Now, I admit that this isn't a bug. I should have used

R> test.data <- data.frame(x=x, y=y, cond=I(x <= 0.5))

to preserve cond as a logical vector, as documented in the help for
data.frame.  However, it is still very unpleasant behaviour, and no
warnings were issued.  I can't help thinking that some sanity checks on
the subset argument could have helped me.

So I suggest that the subset argument should either be
* A logical vector of the same length as the number of rows in the data
  frame, or
* A numeric vector of unique integers
to ensure that we really do get a subset of the data frame. The more
flexible behaviour of "[.data.frame" really isn't required here.

Martyn

--please do not edit the information below--

Version:
 platform = i686-unknown-linux
 arch = i686
 os = linux
 system = i686, linux
 status =
 major = 1
 minor = 0.0
 year = 2000
 month = February
 day = 29
 language = R

Search Path:
 .GlobalEnv, Autoloads, package:base

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Wed Apr 12 11:12:59 2000
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 12 Apr 2000 12:12:59 +0200
Subject: [Rd] For wishlist: sanity checks for subsets in lm, glm (PR#515)
In-Reply-To: plummer@iarc.fr's message of "Wed, 12 Apr 2000 11:55:37 +0200 (MET DST)"
References: <200004120955.LAA22235@pubhealth.ku.dk>
Message-ID: <x2purv39w4.fsf@blueberry.kubism.ku.dk>

plummer@iarc.fr writes:

> to preserve cond as a logical vector, as documented in the help for
> data.frame.  However, it is still very unpleasant behaviour, and no
> warnings were issued.  I can't help thinking that some sanity checks on
> the subset argument could have helped me.
> 
> So I suggest that the subset argument should either be
> * A logical vector of the same length as the number of rows in the data
>   frame, or
> * A numeric vector of unique integers
> to ensure that we really do get a subset of the data frame. The more
> flexible behaviour of "[.data.frame" really isn't required here.

Might be a good idea. Mind you, Splus 3.4 does exatly the same thing,
and I'm a little worried that the uniqueness assumption might kill
some bootstrapping applications:

 glm(y ~ x, data=test.data, subset=sample(seq(along=y),replace=T))


-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From plummer@iarc.fr  Wed Apr 12 11:55:55 2000
From: plummer@iarc.fr (Martyn Plummer)
Date: Wed, 12 Apr 2000 12:55:55 +0200 (CEST)
Subject: [Rd] For wishlist: sanity checks for subsets in lm, glm (PR#
In-Reply-To: <x2purv39w4.fsf@blueberry.kubism.ku.dk>
Message-ID: <XFMail.000412125555.plummer@iarc.fr>

On 12-Apr-00 Peter Dalgaard BSA wrote:
> Might be a good idea. Mind you, Splus 3.4 does exatly the same thing,
> and I'm a little worried that the uniqueness assumption might kill
> some bootstrapping applications:
> 
>  glm(y ~ x, data=test.data, subset=sample(seq(along=y),replace=T))

Splus 5.1 doesn't do this, because it preserves logical vectors in
data frames (but then perhaps comparisons with S4 or SPlus 5.x are
irrelevant?)

I knew there would be a good reason not to implement this. My feeling
is that high level modelling functions should protect the  user as
much as possible. If you want more flexibility, you can always
program around it.

   temp.data <- test.data[sample(seq(along=y), replace=T),]
   glm(y ~x, data=temp.data)

This doesn't help with breaking existing code though.

Martyn
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Wed Apr 12 12:18:37 2000
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 12 Apr 2000 13:18:37 +0200
Subject: [Rd] For wishlist: sanity checks for subsets in lm, glm (PR#
In-Reply-To: Martyn Plummer's message of "Wed, 12 Apr 2000 12:55:55 +0200 (CEST)"
References: <XFMail.000412125555.plummer@iarc.fr>
Message-ID: <x2n1mz36uq.fsf@blueberry.kubism.ku.dk>

Martyn Plummer <plummer@iarc.fr> writes:

> On 12-Apr-00 Peter Dalgaard BSA wrote:
> > Might be a good idea. Mind you, Splus 3.4 does exatly the same thing,
> > and I'm a little worried that the uniqueness assumption might kill
> > some bootstrapping applications:
> > 
> >  glm(y ~ x, data=test.data, subset=sample(seq(along=y),replace=T))
> 
> Splus 5.1 doesn't do this, because it preserves logical vectors in
> data frames (but then perhaps comparisons with S4 or SPlus 5.x are
> irrelevant?)

They're sometimes relevant because they show what has been considered
a bug in 3.x... The convert-to-factor conventions in 3.x (and R) are
quite a bit of a pain in my opinion, but I'm afraid we're stuck with
them at least for the near future (we couldn't make an API change as
pervasive as that without bumping the major version number). 

> I knew there would be a good reason not to implement this. My feeling
> is that high level modelling functions should protect the  user as
> much as possible. If you want more flexibility, you can always
> program around it.

Maybe, but... Getting people to program around S/R differences in
their add-on packages haven't always been unproblematic.

What would also catch your case would be to disallow factors as subset
variables, and I can't think of any situation where subsetting with a
factor would occur naturally. Does 5.1 allow subsetting with factors?

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Wed Apr 12 12:16:21 2000
From: p.dalgaard@biostat.ku.dk (p.dalgaard@biostat.ku.dk)
Date: Wed, 12 Apr 2000 13:16:21 +0200 (MET DST)
Subject: [Rd] For wishlist: sanity checks for subsets in lm, glm (PR#
Message-ID: <200004121116.NAA23535@pubhealth.ku.dk>

Martyn Plummer <plummer@iarc.fr> writes:

> On 12-Apr-00 Peter Dalgaard BSA wrote:
> > Might be a good idea. Mind you, Splus 3.4 does exatly the same thing,
> > and I'm a little worried that the uniqueness assumption might kill
> > some bootstrapping applications:
> > 
> >  glm(y ~ x, data=test.data, subset=sample(seq(along=y),replace=T))
> 
> Splus 5.1 doesn't do this, because it preserves logical vectors in
> data frames (but then perhaps comparisons with S4 or SPlus 5.x are
> irrelevant?)

They're sometimes relevant because they show what has been considered
a bug in 3.x... The convert-to-factor conventions in 3.x (and R) are
quite a bit of a pain in my opinion, but I'm afraid we're stuck with
them at least for the near future (we couldn't make an API change as
pervasive as that without bumping the major version number). 

> I knew there would be a good reason not to implement this. My feeling
> is that high level modelling functions should protect the  user as
> much as possible. If you want more flexibility, you can always
> program around it.

Maybe, but... Getting people to program around S/R differences in
their add-on packages haven't always been unproblematic.

What would also catch your case would be to disallow factors as subset
variables, and I can't think of any situation where subsetting with a
factor would occur naturally. Does 5.1 allow subsetting with factors?

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Prof Brian Ripley <ripley@stats.ox.ac.uk>  Wed Apr 12 13:54:57 2000
From: Prof Brian Ripley <ripley@stats.ox.ac.uk> (Prof Brian Ripley)
Date: Wed, 12 Apr 2000 13:54:57 +0100 (BST)
Subject: [Rd] For wishlist: sanity checks for subsets in lm, glm (PR#
Message-ID: <200004121254.NAA22977@toucan.stats.ox.ac.uk>

> From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
> Date: 12 Apr 2000 13:18:37 +0200
> 
> Martyn Plummer <plummer@iarc.fr> writes:
> 
> > On 12-Apr-00 Peter Dalgaard BSA wrote:
> > > Might be a good idea. Mind you, Splus 3.4 does exatly the same thing,
> > > and I'm a little worried that the uniqueness assumption might kill
> > > some bootstrapping applications:
> > > 
> > >  glm(y ~ x, data=test.data, subset=sample(seq(along=y),replace=T))
> > 
> > Splus 5.1 doesn't do this, because it preserves logical vectors in
> > data frames (but then perhaps comparisons with S4 or SPlus 5.x are
> > irrelevant?)
> 
> They're sometimes relevant because they show what has been considered
> a bug in 3.x... The convert-to-factor conventions in 3.x (and R) are
> quite a bit of a pain in my opinion, but I'm afraid we're stuck with
> them at least for the near future (we couldn't make an API change as
> pervasive as that without bumping the major version number). 

I would argue for changing the behaviour of converting logicals for 1.1.
It's a rare case, breaks almost nothing (as evidenced by the lack
of problems with S-PLUS 5.x) and would be helpful. Character vars
are another matter.

> > I knew there would be a good reason not to implement this. My feeling
> > is that high level modelling functions should protect the  user as
> > much as possible. If you want more flexibility, you can always
> > program around it.
> 
> Maybe, but... Getting people to program around S/R differences in
> their add-on packages haven't always been unproblematic.
> 
> What would also catch your case would be to disallow factors as subset
> variables, and I can't think of any situation where subsetting with a
> factor would occur naturally. Does 5.1 allow subsetting with factors?

Yes, exactly as before.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Wed Apr 12 19:34:40 2000
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Wed, 12 Apr 2000 14:34:40 -0400
Subject: [Rd] R CMD build/check
References: <200004100546.HAA14716@aragorn.ci.tuwien.ac.at>
 <38F1F40B.56C0A7B@bank-banque-canada.ca> <14580.6098.971883.305959@aragorn.ci.tuwien.ac.at>
Message-ID: <38F4C1C0.5B781B8C@bank-banque-canada.ca>

 >`\alias{TOPIC}'
 >    The `\alias' entries specify all "topics" the file documents.

Ok. I thought TOPIC had to be an object. (In fact, I thought I was
getting another error message if it wasn't, but I must have been
mistaken as it works fine now.)

>> 2/ Specific methods get reported as undocumented functions unless the

>> generic documentation has an alias line for the specific method. This

>> is not a problem when everything is in one package, however, for many

>> of my specific methods the generic method is in another of my
packages
>> or in the base. (This can generate a lot of warning, which obscure
>> more important warnings.) I'm putting a "stub" description in to
>> eliminate all the warnings, but I'm not sure if this is the ideal way

>> to do this.

>Not sure if I understand this correctly.  If you have a specific method

>say foo.dse then you'd have
> \alias{foo.dse}
>etc.  So why would this be undocumented?

It is not a problem if everything is in one package. But when that is
not the case things are a bit more complicated. For example, I have a
method print.TSdata and the documention for "print" is in base so
instead of just putting an \alias{print.TSdata} in with the
documentation for print, I need to make a little "stub"  .Rd with
\name{print.something} and put all my \alias{print.*'s in that. The same
applies to print.summary and other generic methods in the base.

In addition to the base, I have a lot of generic methods defined in my
tframe package. DSE defines specific methods for these, so the same
problem occurs. I guess in this case I could put the alias for the
specific methods in with the tframe package, but I like to think of
tframe as self-contained and expect not to need to update it as
frequently as I might add new things to DSE.

I've now gone from about 600 undocument function on my first R CMD build
down to about 100. Most of the 500 fixed have just been additional
aliases, and probably 3/4 of them had to be put in these "stub" files
because the generic method was not in the same package. (But it is worth
the trouble, I now have a much better idea where the documentation
truely is weak.)

>> 4/ R CMD build does not work for bundles, but it can be used to test
>> sub-packages and then the bundle rolled up afterwards directly with
>> tar and gzip. (This is not difficult and not a problem, but people
>> should be aware of it.)

>I should add something on this too.  Perhaps, Paul, once you release
dse
>as a package bundle I can try to make R CMD build work for bundles,
too.

ok, but I wouldn't treat it as any sort of priority. Testing the
individual packages and then rolling up the bundle seems to work pretty
well.

Paul Gilbert


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From erich.neuwirth@univie.ac.at  Wed Apr 12 22:40:19 2000
From: erich.neuwirth@univie.ac.at (Erich Neuwirth)
Date: Wed, 12 Apr 2000 23:40:19 +0200
Subject: [Rd] xgobin on win95
References: <200004100546.HAA14716@aragorn.ci.tuwien.ac.at>
 <38F1F40B.56C0A7B@bank-banque-canada.ca> <14580.6098.971883.305959@aragorn.ci.tuwien.ac.at> <38F4C1C0.5B781B8C@bank-banque-canada.ca>
Message-ID: <38F4ED43.23B81778@univie.ac.at>

i finally managed to install brians latest version of
xgobi and the r interface to it on win95.
i am running exceed 6.1
it works,
but clone xgobi (within xgobi) does not work.
has anybody made clone xgobi run on win95 (or win98)?
how about w2k?

additionally,
set DISPLAY=localhost
does not work
i do have
localhost 	127.0.0.1
in my hosts file, nonetheless i get an error message
when i try to start xgobi (standalone or from within r)

any ideas about that?
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From erich.neuwirth@univie.ac.at  Wed Apr 12 22:44:48 2000
From: erich.neuwirth@univie.ac.at (Erich Neuwirth)
Date: Wed, 12 Apr 2000 23:44:48 +0200
Subject: [Rd] xgobi, footnote
References: <200003212215.XAA03296@pubhealth.ku.dk>
Message-ID: <38F4EE4F.DDE280CA@univie.ac.at>

XIO:  fatal IO error 104 (Connection reset by peer) on X server
"localhost:0.0"
after 0 requests (0 known processed) with 0 events remaining.

is the error message i get when DISPLAY=localhost:0.0
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From erich.neuwirth@univie.ac.at  Wed Apr 12 23:25:50 2000
From: erich.neuwirth@univie.ac.at (Erich Neuwirth)
Date: Thu, 13 Apr 2000 00:25:50 +0200
Subject: [Rd] xgobi, second footnote
References: <200003212215.XAA03296@pubhealth.ku.dk> <38F4EE4F.DDE280CA@univie.ac.at>
Message-ID: <38F4F7EE.1A36D4E3@univie.ac.at>

updgrading to exceed 6.2
solved the localhost display problem.


Erich Neuwirth wrote:
> 
> XIO:  fatal IO error 104 (Connection reset by peer) on X server
> "localhost:0.0"
> after 0 requests (0 known processed) with 0 events remaining.
> 
> is the error message i get when DISPLAY=localhost:0.0
> -.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
> r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
> Send "info", "help", or "[un]subscribe"
> (in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
> _._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Thu Apr 13 07:07:37 2000
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Thu, 13 Apr 2000 07:07:37 +0100 (BST)
Subject: [Rd] xgobin on win95
In-Reply-To: <38F4ED43.23B81778@univie.ac.at>
Message-ID: <Pine.GSO.4.05.10004130658240.17187-100000@auk.stats>

On Wed, 12 Apr 2000, Erich Neuwirth wrote:

> i finally managed to install brians latest version of
> xgobi and the r interface to it on win95.
> i am running exceed 6.1
> it works,
> but clone xgobi (within xgobi) does not work.
> has anybody made clone xgobi run on win95 (or win98)?

Yes, people have, but there have been several reports of problems from
people who have not followed the instructions. Have you read and followed
all the instructions in the README (like having a suitable shell at
/bin/sh?  On Win9x you may need to ensure that DISPLAY is set as a global
environmental variable.  Note that as Win9x has quite a broken fork,
spawning processes like this is known to give problems.

> how about w2k?

Don't know, but that is really NT, where it does work.

> additionally,
> set DISPLAY=localhost
> does not work
> i do have
> localhost 	127.0.0.1
> in my hosts file, nonetheless i get an error message
> when i try to start xgobi (standalone or from within r)
> 
> any ideas about that?

Should be localhost:0.0 (see the README and xgobi.bat)

BTW, I think this is off-topic for R-devel, and the README in that
distribution does explicitly say that it is unsupported.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From erich.neuwirth@univie.ac.at  Thu Apr 13 12:20:57 2000
From: erich.neuwirth@univie.ac.at (Erich Neuwirth)
Date: Thu, 13 Apr 2000 13:20:57 +0200
Subject: [Rd] xgobi in R on win95
References: <200004121254.NAA22977@toucan.stats.ox.ac.uk>
Message-ID: <38F5AD99.83150CA3@univie.ac.at>

this time,
it is REALLY a bug in the r code for the xgobi interface.
on win95, at least in my configuration,
xgobi(...,multi=TRUE)
does not work.

the temp files R creates are deleted before
the xgobi process gets a chance to read the files.

the culprit is

  on.exit(file.remove(tmpfiles)) 

on windows95, this deletes the files too early.

changing it to
        if(!multi) { on.exit(file.remove(tmpfiles)) }

solves the problem, but of course has the side effect
of leaving the the temporary files on the machine.
i do not understand enough of the mechanics of the system calls 
involved (yet) to do a full repair myself.


my xgobi only questions to this list were cause by the fact
thet multi=TRUE did not work, therefore i tried to use
clone xgobi, which did not work either.
it still does not work, despice the fatc that i think i
read and followed the instructions carefully.

erich
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From duncan@research.bell-labs.com  Thu Apr 13 12:44:09 2000
From: duncan@research.bell-labs.com (Duncan Temple Lang)
Date: Thu, 13 Apr 2000 07:44:09 -0400 (EDT)
Subject: [Rd] xgobi in R on win95
Message-ID: <200004131144.HAA03413@jessie.research.bell-labs.com>


> Date: Thu, 13 Apr 2000 13:20:57 +0200
> From: Erich Neuwirth <erich.neuwirth@univie.ac.at>
> Organization: University of Vienna
> CC: r-devel@stat.math.ethz.ch
> References: <200004121254.NAA22977@toucan.stats.ox.ac.uk>
> Sender: owner-r-devel@stat.math.ethz.ch
> Precedence: bulk
> 
> this time,
> it is REALLY a bug in the r code for the xgobi interface.
> on win95, at least in my configuration,
> xgobi(...,multi=TRUE)
> does not work.
> 
> the temp files R creates are deleted before
> the xgobi process gets a chance to read the files.
> 
> the culprit is
> 
>   on.exit(file.remove(tmpfiles)) 
> 
> on windows95, this deletes the files too early.
> 
> changing it to
>         if(!multi) { on.exit(file.remove(tmpfiles)) }
> 
> solves the problem, but of course has the side effect
> of leaving the the temporary files on the machine.
> i do not understand enough of the mechanics of the system calls 
> involved (yet) to do a full repair myself.
> 
> 
> erich


The lack of synchronization is a fundamental limitation of this style
of inter-process communication. One has to add crude hacks that are
bound to fail under someones configuration in the absence of more
coherent, formal and hence predictable, debuggable approaches are
needed. 

We have two such approaches. Ross, Debby Swayne and I have, at
different times, made modifications to xgobi to allow one to
communicate with it via CORBA.  Combined with the R-CORBA package,
dynamic remote control and query of xgobi is quite simple. With this
approach, the data is transferred directly and no messing with file
systems, timing, etc is needed.

The second approach is to allow XGobi be dynamically loaded into the R
session as a shared library.  I started about a week ago and most of
that is functional (since it shares much of the functionality added
via the CORBA server), but I won't get back to it until next week.
One of the motivations for embedding XGobi into R (& S) is to look at
event-loop integration, with the potential to lead to connections
and/or (internal) threads.  It would be good to know if there is any
interest in having this embedded version for regular use (on Unix,
since it would run in the R process). Otherwise it may not be worth
the effort packaging it up that carefully.

D.

-- 
_______________________________________________________________

Duncan Temple Lang                duncan@research.bell-labs.com
Bell Labs, Lucent Technologies    office: (908)582-3217
700 Mountain Avenue, Room 2C-259  fax:    (908)582-3340
Murray Hill, NJ  07974-2070       
         http://cm.bell-labs.com/stat/duncan

      "Languages shape the way we think, and determine what 
       we can think about."        
                                      Benjamin Whorf
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Thu Apr 13 15:45:55 2000
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Thu, 13 Apr 2000 16:45:55 +0200 (CEST)
Subject: [Rd] Embedding Xgobi into R
In-Reply-To: <200004131144.HAA03413@jessie.research.bell-labs.com>
References: <200004131144.HAA03413@jessie.research.bell-labs.com>
Message-ID: <14581.56739.292151.347850@lynne.ethz.ch>


>>>>> "Duncan" == Duncan Temple Lang <duncan@research.bell-labs.com> writes:

      .............

    Duncan> The second approach is to allow XGobi be dynamically loaded
    Duncan> into the R session as a shared library.  I started about a week
    Duncan> ago and most of that is functional (since it shares much of the
    Duncan> functionality added via the CORBA server), but I won't get back
    Duncan> to it until next week.  One of the motivations for embedding
    Duncan> XGobi into R (& S) is to look at event-loop integration, with
    Duncan> the potential to lead to connections and/or (internal) threads.
    Duncan> It would be good to know if there is any interest in having
    Duncan> this embedded version for regular use (on Unix, since it would
    Duncan> run in the R process).

I'm interested very much!

{Now showing my complete ignorance:}
I assume this would not rely on any CORBA server availability, right?

    Duncan> Otherwise it may not be worth the effort
    Duncan> packaging it up that carefully.

Martin
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From kohnicho@comp.nus.edu.sg  Thu Apr 13 17:08:57 2000
From: kohnicho@comp.nus.edu.sg (Nicholas Lewin-Koh)
Date: Fri, 14 Apr 2000 00:08:57 +0800 (SST)
Subject: [Rd] xgobi in R on win95
In-Reply-To: <200004131144.HAA03413@jessie.research.bell-labs.com>
Message-ID: <Pine.OSF.4.21.0004140004460.4962-100000@decunx.comp.nus.edu.sg>

Hi,
Debby Swayne is working on a new version of xgobi (now called ggobi). I
have been working with her and we have succeeded in compiling (and
running) the preliminary version native on windows. No more emulation! all
it needs is a com interface and it can communicate directly with R. We
will be putting out some test versions soon, so comments (and help) would
be appreciated.

Nicholas


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Prof Brian Ripley <ripley@stats.ox.ac.uk>  Thu Apr 13 18:04:29 2000
From: Prof Brian Ripley <ripley@stats.ox.ac.uk> (Prof Brian Ripley)
Date: Thu, 13 Apr 2000 18:04:29 +0100 (BST)
Subject: [Rd] XFig device
Message-ID: <200004131704.SAA00170@toucan.stats.ox.ac.uk>

After all the discussion I decided to act, and wrote an XFig device
(for the standard postscript fonts only) which is now in R-devel.
Also, I implementing kerning for the postscript() device.

One thing someone may be able to help me with. XFig 3.2 implements
multiple pages, but does not say in the FORMAT how to split the file
into pages.  If anyone knows, please let me know. (Some reading of the
code suggested this was perhaps not implemented except for printing.)

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From sergei@stams.strath.ac.uk  Fri Apr 14 13:14:29 2000
From: sergei@stams.strath.ac.uk (sergei@stams.strath.ac.uk)
Date: Fri, 14 Apr 2000 14:14:29 +0200 (MET DST)
Subject: [Rd] bundle build and Rd2Sd converion fail (PR#519)
Message-ID: <200004141214.OAA16983@pubhealth.ku.dk>

Dear R-core,
Thank you for your great effort! I am finalising a bundle that works both in
R and Splus. But I faced the following minor problems with R CMD under both
UNIX and LINUX.
1. R CMD build denies to work with bundles. It reports
* checking `DESCRIPTION' package entry ... ERROR: no package entry in 
`DESCRIPTION'
Surely, there is no one, but there is Contains entry.
Next, according to R-exts manual, the packages contained in the bundle need
not contain DESCRIPTION but DESCRIPTION.in file. So building individual bundle 
packages with R CMD does not work neither:
* checking for `DESCRIPTION' ... ERROR: file `DESCRIPTION' not found           

This does not prevent from installing the bundle, and surprisingly enough, 
DESCRIPTION file appears afterwards in all bundle packages! So building 
individual packages now become available (!?)
2. Writing Rd-documentation is much easier than nroff files. But as the 
packages are also working in Splus, I need to generate .d-files as well.
I tried the command below in R-1.0.0 and development version R-1.1 both under 
UNIX and LINUX and get the following error:
sherna man/ % R CMD Rdconv --type=Sd plot.mefista.Rd > plot.mefista.d
Undefined subroutine &main::text2nroff called at /auto/local/pkg/R-1.0.0/instal
l.stams/lib/R/etc/Rdconvlib.pl line 1412, <rdfile> chunk 33.
It would also be nice just to be able to type R CMD Rd2Sd ;-)
Waiting for your reaction.
Best wishes,
Sergei

=================================================================
                           Dr. Sergei ZUYEV
Statistics and Modelling Science dept., University of Strathclyde
    Livingston Tower, 26 Richmond str., Glasgow, G1 1XH, U.K.
     Tel.: +44 (0)141 548 3663    Fax:  +44 (0)141 552 2079
sergei@stams.strath.ac.uk   http://www.stams.strath.ac.uk/~sergei
=================================================================


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From sergei@stams.strath.ac.uk  Fri Apr 14 13:26:48 2000
From: sergei@stams.strath.ac.uk (sergei@stams.strath.ac.uk)
Date: Fri, 14 Apr 2000 14:26:48 +0200 (MET DST)
Subject: [Rd] Rd2Sd conversion: files (PR#520)
Message-ID: <200004141226.OAA17227@pubhealth.ku.dk>

This is a multipart MIME message.

--==_Exmh_-19086308140
Content-Type: text/plain; charset=us-ascii

In addition to my previous message, here is the source Rd-file that I used in

 R CMD Rdconv -d --type=Sd plot.mefista.Rd > plot.mefista.d

command.

--==_Exmh_-19086308140
Content-Type: text/plain ; name="plot.mefista.Rd"; charset=us-ascii
Content-Description: plot.mefista.Rd
Content-Disposition: attachment; filename="plot.mefista.Rd"

\name{plot.mefista}
\alias{plot.mefista}
\title{Plot an object of class mefista.}
\usage{
plot.mefista(mef,draw.style=NA,Space=mef$param$space,xgrid=mef$param$xgrid,
             ygrid=mef$param$ygrid,nlevels=15,ncolors=0,\dots)
}
%- maybe also `usage' for other objects documented here.
\arguments{
  \item{mef}{An object of class \code{mefista}.}
  \item{draw.style}{Values: 0 - linear, 1 - \code{\link{image}}, 2 -
    \code{\link{contour}}, 3 - \code{image()} \emph{and} \code{contour}
    superposed, 4 - \code{\link{persp}}.}
  \item{Space}{
  The state space of the measures. A vector or a matrix giving the
  coordinates of the points in each \emph{row} of the latter. If not
  supplied  it is defined as
  \code{expand.grid(xgrid, ygrid)} if the latter are available,
  otherwise it is considered to be \code{1:length(mu)}.}
\item{nlevels}{Number of levels used in \code{image} or \code{contour}
  plots.}
\item{ncolors}{Number of customized colors to be used in \code{image} or
  \code{contour} plots. If 0, the default color palette is used.}
\item{\dots}{Other plot parameters.}
}
\description{
Plots the gradient function and the measure given in an object of class
\code{mefista}.
}

\seealso{\code{\link{mefista}}, \code{\link{go.steep}} and
    \code{\link{summary.mefista}}. 
}
--==_Exmh_-19086308140--



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Prof Brian Ripley <ripley@stats.ox.ac.uk>  Fri Apr 14 13:47:07 2000
From: Prof Brian Ripley <ripley@stats.ox.ac.uk> (Prof Brian Ripley)
Date: Fri, 14 Apr 2000 13:47:07 +0100 (BST)
Subject: [Rd] bundle build and Rd2Sd converion fail (PR#519)
Message-ID: <200004141247.NAA04540@toucan.stats.ox.ac.uk>


> From: sergei@stams.strath.ac.uk
> Date: Fri, 14 Apr 2000 14:14:29 +0200 (MET DST)
> 
> Dear R-core,
> Thank you for your great effort! I am finalising a bundle that works both in
> R and Splus. But I faced the following minor problems with R CMD under both
> UNIX and LINUX.
> 1. R CMD build denies to work with bundles. It reports
> * checking `DESCRIPTION' package entry ... ERROR: no package entry in 
> `DESCRIPTION'

Yes, no one said it would work with a bundle, did they?  (See
R CMD build --help.)

You can use it to help check packages within a bundle (you can then
ignore that message) and build the bundle by hand.

Now people other than me are building bundles, to make it work with
bundles is on the TODO list.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Prof Brian Ripley <ripley@stats.ox.ac.uk>  Fri Apr 14 13:50:49 2000
From: Prof Brian Ripley <ripley@stats.ox.ac.uk> (Prof Brian Ripley)
Date: Fri, 14 Apr 2000 13:50:49 +0100 (BST)
Subject: [Rd] Rd2Sd conversion: files (PR#520)
Message-ID: <200004141250.NAA04633@toucan.stats.ox.ac.uk>


> From: sergei@stams.strath.ac.uk
> Date: Fri, 14 Apr 2000 14:26:48 +0200 (MET DST)
> To: r-devel@stat.math.ethz.ch
> Subject: [Rd] Rd2Sd conversion: files (PR#520)
> CC: R-bugs@biostat.ku.dk
> X-Loop: R-bugs@biostat.ku.dk
> 
> This is a multipart MIME message.
> 
> --==_Exmh_-19086308140
> Content-Type: text/plain; charset=us-ascii
> 
> In addition to my previous message, here is the source Rd-file that I used in
> 
>  R CMD Rdconv -d --type=Sd plot.mefista.Rd > plot.mefista.d
> 
> command.

Conversion to Sd has never been very good.  As you see, it has been
inadvertently removed together with nroff support.  I have put it back
for 1.1, but do not expect it to be 100% correct and we do not plan to
continue to support nroff-based methods.


[BTW, your example lacks any keywords.]

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Fri Apr 14 15:44:14 2000
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Fri, 14 Apr 2000 10:44:14 -0400
Subject: [Rd] bundle build and Rd2Sd converion fail (PR#519)
References: <200004141214.OAA16983@pubhealth.ku.dk>
Message-ID: <38F72EBE.93EEB4F0@bank-banque-canada.ca>

Sergei

If you just blend together the bundle DESCRIPTION and the DESCRIPTION.in for
each package in the bundle, and put this in a DESCRIPTION file in the package,
then you can run R CMD build on the package. Here are some lines from my
makefile for package dse1 (in  bundle dse):

 cat DESCRIPTION | grep -v Bundle | grep -v Contains \
       >dse1/DESCRIPTION
 cat dse1/DESCRIPTION.in  >>dse1/DESCRIPTION

After you do this R CMD build works on the package and does all its testing, and
produces a tar.gz for each package. You then need to delete these and manually
tar and gzip the bundle.

Paul Gilbert

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From bates@stat.wisc.edu  Sun Apr 16 18:18:35 2000
From: bates@stat.wisc.edu (Douglas Bates)
Date: Sun, 16 Apr 2000 12:18:35 -0500 (CDT)
Subject: [Rd] R-1.0.1 now available via rsync
Message-ID: <m12gsgt-000ZSXC@franz.stat.wisc.edu>

The rsync directories on rsync.r-project.org have been updated so that
r-release points to the 1.0.1 release.  That is,

 rsync -Ca rsync.r-project.org::r-release R-1.0.1

will produce a copy of the 1.0.1 tree in a subdirectory called R-1.0.1
of the current directory.

Other options are:

$ rsync rsync.r-project.org::
r-release      	R sources (feature-frozen version) CVS tree (approx 12 MB)
r-release-patched	patched R sources (feature-frozen version) CVS tree (approx 12 MB)
r-devel        	R sources (development version) CVS tree (approx 12 MB)
r-manuals      	Development sources for manuals for R
xlispstat      	xlispstat sources (development version) CVS tree (approx 12 MB)
ess            	ess (Emacs Speaks Statistics) CVS tree (approx 8.5 MB)
omega          	Omega Project for Statistical Computing CVS tree
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From santini@dsi.unimi.it  Mon Apr 17 10:30:43 2000
From: santini@dsi.unimi.it (santini@dsi.unimi.it)
Date: Mon, 17 Apr 2000 11:30:43 +0200 (MET DST)
Subject: [Rd] akima core dumps on loading (PR#521)
Message-ID: <200004170930.LAA01569@pubhealth.ku.dk>

Full_Name: Massimo santini
Version: 1.0.1
OS: Linux
Submission from: (NULL) (159.149.147.89)


I've just dl the .rpm of R 1.0.1, installed it and then launched 

	insatll.packages("akima")

after re-launching R [--vanilla], the command

	library(akima)

has the only effect to coredump the program. Here is the output of gdb and
strace...

--- GDB (commands given can be seen from the except)

$ R -d gdb
GNU gdb 19991004
Copyright 1998 Free Software Foundation, Inc.
GDB is free software, covered by the GNU General Public License, and you are
welcome to change it and/or distribute copies of it under certain conditions.
Type "show copying" to see the conditions.
There is absolutely no warranty for GDB.  Type "show warranty" for details.
This GDB was configured as "i386-redhat-linux"...
(gdb) run --vanilla
Starting program: /usr/lib/R/bin/R.X11 --vanilla

R : Copyright 2000, The R Development Core Team
Version 1.0.1  (April 14, 2000)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type	"?license" or "?licence" for distribution details.

R is a collaborative project with many contributors.
Type	"?contributors" for a list.

Type	"demo()" for some demos, "help()" for on-line help, or
    	"help.start()" for a HTML browser interface to help.
Type	"q()" to quit R.

> library(akima)

Program received signal SIGSEGV, Segmentation fault.
_dl_lookup_symbol (undef_name=0x2d2e3b3 <Address 0x2d2e3b3 out of bounds>,
ref=0xbfffabb4, 
    symbol_scope=0x81ec65c, reference_name=0x81e8b20
"/usr/lib/R/library/akima/libs/akima.so", reloc_type=208)
    at ../sysdeps/generic/dl-hash.h:31
31	../sysdeps/generic/dl-hash.h: No such file or directory.
(gdb) 

--- STRACE (echo "library(akima)" | strace R --vanilla)

[...]
rt_sigprocmask(SIG_BLOCK, NULL, [], 8)  = 0
stat("/usr/lib/R/library/akima/libs/akima.so", {st_mode=S_IFREG|0755,
st_size=289367, ...}) = 0
stat("/usr/lib/R/library/base/libs/akima.so", 0xbfffdb60) = -1 ENOENT (No such
file or directory)
rt_sigprocmask(SIG_BLOCK, NULL, [], 8)  = 0
rt_sigprocmask(SIG_BLOCK, NULL, [], 8)  = 0
rt_sigprocmask(SIG_BLOCK, NULL, [], 8)  = 0
rt_sigprocmask(SIG_BLOCK, NULL, [], 8)  = 0
rt_sigprocmask(SIG_BLOCK, NULL, [], 8)  = 0
rt_sigprocmask(SIG_BLOCK, NULL, [], 8)  = 0
rt_sigprocmask(SIG_SETMASK, [], NULL, 8) = 0
rt_sigprocmask(SIG_BLOCK, NULL, [], 8)  = 0
rt_sigprocmask(SIG_BLOCK, NULL, [], 8)  = 0
rt_sigprocmask(SIG_SETMASK, [], NULL, 8) = 0
open("/usr/lib/R/library/akima/libs/akima.so", O_RDONLY) = 4
fstat(4, {st_mode=S_IFREG|0755, st_size=289367, ...}) = 0
read(4, "\177ELF\1\1\1\0\0\0\0\0\0\0\0\0\3\0\3\0\1\0\0\0000F\0\000"..., 4096) =
4096
old_mmap(NULL, 115364, PROT_READ|PROT_EXEC, MAP_PRIVATE, 4, 0) = 0x40f3d000
mprotect(0x40f55000, 17060, PROT_NONE)  = 0
old_mmap(0x40f55000, 8192, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED, 4,
0x17000) = 0x40f55000
old_mmap(0x40f57000, 8868, PROT_READ|PROT_WRITE,
MAP_PRIVATE|MAP_FIXED|MAP_ANONYMOUS, -1, 0) = 0x40f57000
close(4)                                = 0
mprotect(0x40f3d000, 98304, PROT_READ|PROT_WRITE) = 0
--- SIGSEGV (Segmentation fault) ---
+++ killed by SIGSEGV +++

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Mon Apr 17 11:03:19 2000
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 17 Apr 2000 12:03:19 +0200
Subject: [Rd] akima core dumps on loading (PR#521)
In-Reply-To: santini@dsi.unimi.it's message of "Mon, 17 Apr 2000 11:30:43 +0200 (MET DST)"
References: <200004170930.LAA01569@pubhealth.ku.dk>
Message-ID: <x2zoqtkpso.fsf@blueberry.kubism.ku.dk>

santini@dsi.unimi.it writes:

> Full_Name: Massimo santini
> Version: 1.0.1
> OS: Linux
> Submission from: (NULL) (159.149.147.89)
> 
> 
> I've just dl the .rpm of R 1.0.1, installed it and then launched 
> 
> 	insatll.packages("akima")
> 
> after re-launching R [--vanilla], the command
> 
> 	library(akima)
> 
> has the only effect to coredump the program. Here is the output of gdb and
> strace...

Hmm. Doesn't happen here. (BTW: Remember to include as much
information about your system as you can think of. It's not obvious
whether you're running RedHat or SuSE for instance and in what
version.) 

> Program received signal SIGSEGV, Segmentation fault.
> _dl_lookup_symbol (undef_name=0x2d2e3b3 <Address 0x2d2e3b3 out of bounds>,
> ref=0xbfffabb4, 
>     symbol_scope=0x81ec65c, reference_name=0x81e8b20
> "/usr/lib/R/library/akima/libs/akima.so", reloc_type=208)
>     at ../sysdeps/generic/dl-hash.h:31
> 31	../sysdeps/generic/dl-hash.h: No such file or directory.
> (gdb) 
> 
> --- STRACE (echo "library(akima)" | strace R --vanilla)
> 
> [...]
> rt_sigprocmask(SIG_BLOCK, NULL, [], 8)  = 0
> stat("/usr/lib/R/library/akima/libs/akima.so", {st_mode=S_IFREG|0755,
> st_size=289367, ...}) = 0
> stat("/usr/lib/R/library/base/libs/akima.so", 0xbfffdb60) = -1 ENOENT (No such
> file or directory)

This would seem to be the problem: the dynamic library isn't there.
Did you get any error messages while compiling the package? (Except
for "...might be used uninitialized..." of which there are quite a few
here too).

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From sergei@stams.strath.ac.uk  Mon Apr 17 11:53:20 2000
From: sergei@stams.strath.ac.uk (sergei@stams.strath.ac.uk)
Date: Mon, 17 Apr 2000 12:53:20 +0200 (MET DST)
Subject: [Rd] na.omit fails for matrices (PR#522)
Message-ID: <200004171053.MAA02535@pubhealth.ku.dk>

Dear R-core team,
I came across the following bug (feature?):
Modyfying example from help(na.omit):
> ( m<-matrix(c(1, 2, 3, 0, 10, NA),ncol=2) )
     [,1] [,2]
[1,]    1    0
[2,]    2   10
[3,]    3   NA
> ( mo<- na.omit(m) )
     [,1] [,2]
attr(,"na.action")
[1] 1
attr(,"na.action")attr(,"class")
[1] "omit"  
> dim(mo)
[1] 0 2        
> is.matrix(mo)
[1] TRUE                                                                       

So the result is an empty matrix! On the other hand   
> na.omit(as.data.frame(m))
  V1 V2
1  1  0
2  2 10                                                                        


works fine. help(na.omit) does not say that matrix is not a valid argument. At 
least in na.omit in Splus it is valid.
I have tested this in R-1.0.0 and development version R-1.1 under LINUX, 
Solaris and MSWindows.

Best wishes,
Sergei

=================================================================
                           Dr. Sergei ZUYEV
Statistics and Modelling Science dept., University of Strathclyde
    Livingston Tower, 26 Richmond str., Glasgow, G1 1XH, U.K.
     Tel.: +44 (0)141 548 3663    Fax:  +44 (0)141 552 2079
E-mail: sergei@stams.strath.ac.uk   http://www.stams.strath.ac.uk
=================================================================


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Mon Apr 17 14:47:41 2000
From: p.dalgaard@biostat.ku.dk (p.dalgaard@biostat.ku.dk)
Date: Mon, 17 Apr 2000 15:47:41 +0200 (MET DST)
Subject: [Rd] akima core dumps on loading (PR#521)
Message-ID: <200004171347.PAA05197@pubhealth.ku.dk>

Massimo Santini <santini@dsi.unimi.it> writes:

> > Hmm. Doesn't happen here. (BTW: Remember to include as much
> > information about your system as you can think of. It's not obvious
> > whether you're running RedHat or SuSE for instance and in what
> > version.) 
> 
> You are perfectly right. My system is an updated RedHat 6.2.

Same here...

> > > stat("/usr/lib/R/library/akima/libs/akima.so", {st_mode=S_IFREG|0755,
> > > st_size=289367, ...}) = 0
> > > stat("/usr/lib/R/library/base/libs/akima.so", 0xbfffdb60) = -1 ENOENT (No such
> > > file or directory)
> > 
> > This would seem to be the problem: the dynamic library isn't there.
> > Did you get any error messages while compiling the package? (Except
> > for "...might be used uninitialized..." of which there are quite a few
> > here too).
> 
> Non errors during the installation phase. The akima.so library is in 
> 
> 	/usr/lib/R/library/akima/libs/akima.so
> 
> where it should be (with correct premissions), but is not in
> 
> 	/usr/lib/R/library/base/libs/akima.so
> 
> (the dir /usr/lib/R/library/base/libs is missing, to be precise).

Oh. Didn't see that. Then that part is OK. Sorry.

> Have you some hint about what to do now?

Hmmm. Interesting: I can provoke the crash on *my other* RedHat6.2
computer (the one still running the egcs compiler). My stack trace says

#0  _dl_lookup_symbol (
    undef_name=0xcbf203b4 <Address 0xcbf203b4 out of bounds>,
    ref=0xbfffb234, 
    symbol_scope=0x81d3cac, 
    reference_name=0x81d3a60
    "/usr/local/src/misc/r-release/BUILD/library/akima/libs/akima.so",
    reloc_type=64) at ../sysdeps/generic/dl-hash.h:31
#1  0x400096ad in _dl_relocate_object (l=0x81d3aa8, scope=0x81d3cac, lazy=0, 
    consider_profiling=0) at ../sysdeps/i386/dl-machine.h:326
#2  0x40255be4 in dl_open_worker (a=0xbfffb3a0) at dl-open.c:182
#3  0x4000ac3b in _dl_catch_error (errstring=0xbfffb39c, 
    operate=0x40255990 <dl_open_worker>, args=0xbfffb3a0) at dl-error.c:141
#4  0x40255d3d in _dl_open (
    file=0xbfffc51c 
"/usr/local/src/misc/r-release/BUILD/library/akima/libs/akima.so",
mode=2, caller=0xbfffb39c) at dl-open.c:232
#5  0x401323d3 in dlopen_doit (a=0xbfffb4b0) at dlopen.c:41
#6  0x4000ac3b in _dl_catch_error (errstring=0x40134080, 
    operate=0x401323a8 <dlopen_doit>, args=0xbfffb4b0) at
dl-error.c:141
#7  0x401328b9 in _dlerror_run (operate=0x401323a8 <dlopen_doit>, 
    args=0xbfffb4b0) at dlerror.c:125
#8  0x40132393 in __dlopen_check (
    file=0xbfffc51c
"/usr/local/src/misc/r-release/BUILD/library/akima/libs/akima.so",
mode=2) at dlopen.c:53
#9  0x80d9cc3 in AddDLL (
    path=0xbfffc51c
"/usr/local/src/misc/r-release/BUILD/library/akima/libs/akim
a.so", asLocal=1, now=1) at ../../../R/src/unix/dynload.c:207


Looks like it is happening during the dynamic linking itself. Doesn't
look nice. (But installing gcc 2.95.2 might fix your problem.)

[diverted back to r-bugs]

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From plummer@iarc.fr  Mon Apr 17 17:09:40 2000
From: plummer@iarc.fr (plummer@iarc.fr)
Date: Mon, 17 Apr 2000 18:09:40 +0200 (MET DST)
Subject: [Rd] Maths in R documentation (PR#523)
Message-ID: <200004171609.SAA06411@pubhealth.ku.dk>

The document R-exts contains the following example of using 
mathematics in R documentation.

\deqn{p(x) = {\lambda^x\ \frac{e^{-\lambda}}{x!}}
     {p(x) = lambda^x exp(-lambda)/x!}

There is a syntax error in there, but that's not my point.
The problem is that using "R CMD Rd2dvi" I find that putting
the alternate forms of the equation on top of each other doesn't
work.

\deqn{foo}
     {bar}

is interpreted as

\deqn{foo}
bar

which causes a number of problems,e.g. you get both forms of the
equation printed, LaTeX complains about missing math delimiters, etc.
I solved this by putting everything on one line:

\deqn{foo}{bar}

but there is either a documentation error in there, or a problem with
parsing ".Rd" format files.

Another problem is that when I type "R CMD Rd2dvi coda" to get a printable
reference for all the functions in the coda package, they seem to come out in
a more or less random order. I get
read.bugs, mcmc, plot.mcmc, codamenu, read.and.check,...
I was expecting alphabetical order. What do I have to do to get this?

Martyn

--please do not edit the information below--

Version:
 platform = i686-unknown-linux
 arch = i686
 os = linux
 system = i686, linux
 status =
 major = 1
 minor = 0.1
 year = 2000
 month = April
 day = 14
 language = R

Search Path:
 .GlobalEnv, Autoloads, package:base

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From rgentlem@stat.auckland.ac.nz  Mon Apr 17 17:57:22 2000
From: rgentlem@stat.auckland.ac.nz (Robert Gentleman)
Date: Tue, 18 Apr 2000 04:57:22 +1200
Subject: [Rd] Maths in R documentation (PR#523)
In-Reply-To: <200004171609.SAA06411@pubhealth.ku.dk>; from plummer@iarc.fr on Mon, Apr 17, 2000 at 06:09:40PM +0200
References: <200004171609.SAA06411@pubhealth.ku.dk>
Message-ID: <20000418045722.A17858@stat1.stat.auckland.ac.nz>

 I pointed this anomaly out sometime ago. It would be nice to either
have the documentation change or the behaviour (I would perfer the 
latter).

On Mon, Apr 17, 2000 at 06:09:40PM +0200, plummer@iarc.fr wrote:
> The document R-exts contains the following example of using 
> mathematics in R documentation.
> 
> \deqn{p(x) = {\lambda^x\ \frac{e^{-\lambda}}{x!}}
>      {p(x) = lambda^x exp(-lambda)/x!}
> 
> There is a syntax error in there, but that's not my point.
> The problem is that using "R CMD Rd2dvi" I find that putting
> the alternate forms of the equation on top of each other doesn't
> work.
> 
> \deqn{foo}
>      {bar}
> 
> is interpreted as
> 
> \deqn{foo}
> bar
> 
> which causes a number of problems,e.g. you get both forms of the
> equation printed, LaTeX complains about missing math delimiters, etc.
> I solved this by putting everything on one line:
> 
> \deqn{foo}{bar}
> 
> but there is either a documentation error in there, or a problem with
> parsing ".Rd" format files.
> 
> Another problem is that when I type "R CMD Rd2dvi coda" to get a printable
> reference for all the functions in the coda package, they seem to come out in
> a more or less random order. I get
> read.bugs, mcmc, plot.mcmc, codamenu, read.and.check,...
> I was expecting alphabetical order. What do I have to do to get this?
> 
> Martyn
> 
> --please do not edit the information below--
> 
> Version:
>  platform = i686-unknown-linux
>  arch = i686
>  os = linux
>  system = i686, linux
>  status =
>  major = 1
>  minor = 0.1
>  year = 2000
>  month = April
>  day = 14
>  language = R
> 
> Search Path:
>  .GlobalEnv, Autoloads, package:base
> 
> -.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
> r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
> Send "info", "help", or "[un]subscribe"
> (in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
> _._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

-- 
+-------------------------------------------------------------------------+
| Robert Gentleman              phone : (64-9) 3737-599 ext 3946          | 
| Senior Lecturer               fax :   (64-9) 3737-018                   |
| Department of Statistics      office : Room 206 Maths/Physics           |
| University of Auckland	email : rgentlem@stat.auckland.ac.nz      |
+-------------------------------------------------------------------------+
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From maechler@stat.math.ethz.ch  Tue Apr 18 08:00:41 2000
From: maechler@stat.math.ethz.ch (maechler@stat.math.ethz.ch)
Date: Tue, 18 Apr 2000 09:00:41 +0200 (MET DST)
Subject: [Rd] Maths in R documentation (PR#523)
Message-ID: <200004180700.JAA08711@pubhealth.ku.dk>

>>>>> "Martyn" == Martyn Plummer <plummer@iarc.fr> writes:

    Martyn> The document R-exts contains the following example of using 
    Martyn> mathematics in R documentation.

    Martyn> \deqn{p(x) = {\lambda^x\ \frac{e^{-\lambda}}{x!}}
    Martyn>      {p(x) = lambda^x exp(-lambda)/x!}

    Martyn> There is a syntax error in there, but that's not my point.
    Martyn> The problem is that using "R CMD Rd2dvi" I find that putting
    Martyn> the alternate forms of the equation on top of each other doesn't
    Martyn> work.

    Martyn> \deqn{foo}
    Martyn>      {bar}

    Martyn> is interpreted as

    Martyn> \deqn{foo}
    Martyn> bar

yes.

The typo is simply a missing "%" at the end of the first line
(which once was there, and "of course" was dropped when that documentation
 was translated from latex to texinfo ...)

The following is correct

 \deqn{foo}%
      {bar}

(see e.g. src/library/base/man/Special.Rd or ...../symnum.Rd )

I'll fix R-exts.texi.

    Martyn> which causes a number of problems,e.g. you get both forms of the
    Martyn> equation printed, LaTeX complains about missing math delimiters, etc.
    Martyn> I solved this by putting everything on one line:

    Martyn> \deqn{foo}{bar}

    Martyn> but there is either a documentation error in there, or a
    Martyn> problem with parsing ".Rd" format files.

    Martyn> Another problem is that when I type "R CMD Rd2dvi coda" to get
    Martyn> a printable reference for all the functions in the coda
    Martyn> package, they seem to come out in a more or less random
    Martyn> order. I get read.bugs, mcmc, plot.mcmc, codamenu,
    Martyn> read.and.check,...  I was expecting alphabetical order. What do
    Martyn> I have to do to get this?

The change just been proposed yesterday by Doug Bates:

Replace in R..../bin/Rd2dvi , about line 88

	files=`find ${dir} -name "*.[Rr]d" -print`
by
	files=`find ${dir} -name "*.[Rr]d" -print | sort`


    Martyn> --please do not edit the information below--

    Martyn> Version:
    Martyn> platform = i686-unknown-linux
    Martyn> arch = i686
    Martyn> os = linux
    Martyn> system = i686, linux
    Martyn> status =
    Martyn> major = 1
    Martyn> minor = 0.1
    Martyn> year = 2000
    Martyn> month = April
    Martyn> day = 14
    Martyn> language = R

    Martyn> Search Path:
    Martyn> .GlobalEnv, Autoloads, package:base

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From maechler@stat.math.ethz.ch  Tue Apr 18 13:19:01 2000
From: maechler@stat.math.ethz.ch (maechler@stat.math.ethz.ch)
Date: Tue, 18 Apr 2000 14:19:01 +0200 (MET DST)
Subject: [Rd] Maths in R documentation (PR#523)
Message-ID: <200004181219.OAA12317@pubhealth.ku.dk>

>>>>> "MM" == Martin Maechler <maechler@stat.math.ethz.ch> writes:

>>>>> "Martyn" == Martyn Plummer <plummer@iarc.fr> writes:
    Martyn> The document R-exts contains the following example of using 
    Martyn> mathematics in R documentation.

    Martyn> \deqn{p(x) = {\lambda^x\ \frac{e^{-\lambda}}{x!}}
    Martyn> {p(x) = lambda^x exp(-lambda)/x!}

    Martyn> There is a syntax error in there, but that's not my point.
    Martyn> The problem is that using "R CMD Rd2dvi" I find that putting
    Martyn> the alternate forms of the equation on top of each other doesn't
    Martyn> work.

    Martyn> \deqn{foo}
    Martyn> {bar}

    Martyn> is interpreted as

    Martyn> \deqn{foo}
    Martyn> bar

    MM> yes.

    MM> The typo is simply a missing "%" at the end of the first line
    MM> (which once was there, and "of course" was dropped when that documentation
    MM> was translated from latex to texinfo ...)

    MM> The following is correct

    MM> \deqn{foo}%
    MM>      {bar}

NO!  ...dear me... a closer look at these two files
    MM> (see e.g. src/library/base/man/Special.Rd or ...../symnum.Rd )

reveals that

 \deqn{foo}{%
       bar}

is *the way* ..

sorry for the additional confusion I've added...

    MM> I'll fix R-exts.texi.
..yes..

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ligges@statistik.uni-dortmund.de  Tue Apr 18 18:39:53 2000
From: ligges@statistik.uni-dortmund.de (ligges@statistik.uni-dortmund.de)
Date: Tue, 18 Apr 2000 19:39:53 +0200 (MET DST)
Subject: [Rd] strheight() crashes without opened device (PR#524)
Message-ID: <200004181739.TAA15047@pubhealth.ku.dk>

My mistake, but also a bug.
I did not open a device and called strheight("X").
==> R crashed

...\rgui --vanilla
[...]

> strwidth("X")
Error in strwidth("X") : plot.new has not been called yet
(OK.)

> strheight("X")

R crashed.
(Happens also on Solaris.)


Regards, 
Uwe Ligges


--please do not edit the information below--

Version:
 platform = Windows
 arch = x86
 os = Win32
 system = x86, Win32
 status = 
 major = 1
 minor = 0.0
 year = 2000
 month = February
 day = 29
 language = R

Windows NT 4.0 (build 1381) Service Pack 6

Search Path:
 .GlobalEnv, Autoloads, package:base

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From thomas@biostat.washington.edu  Tue Apr 18 19:17:42 2000
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Tue, 18 Apr 2000 11:17:42 -0700 (PDT)
Subject: [Rd] strheight() crashes without opened device (PR#524)
In-Reply-To: <200004181739.TAA15047@pubhealth.ku.dk>
Message-ID: <Pine.GSO.4.21.0004181116550.10925-100000@mail.biostat.washington.edu>

On Tue, 18 Apr 2000 ligges@statistik.uni-dortmund.de wrote:

> My mistake, but also a bug.
> I did not open a device and called strheight("X").
> ==> R crashed

Fixed for R1.1: we weren't checking that the device existed.

	-thomas


Thomas Lumley
Assistant Professor, Biostatistics
University of Washington, Seattle

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From bolker@zoo.ufl.edu  Wed Apr 19 15:23:34 2000
From: bolker@zoo.ufl.edu (bolker@zoo.ufl.edu)
Date: Wed, 19 Apr 2000 16:23:34 +0200 (MET DST)
Subject: [Rd] Windows-specific: image(z,zlim=()) gives bogus colors outside range (PR#525)
Message-ID: <200004191423.QAA23141@pubhealth.ku.dk>


  In the Windows version of R (not in the equivalent version
running on Linux RH 6.0), doing image(z,zlim=c(a,b)) with
non-trivial limits (i.e., smaller than the range of z)
plots bogus colors (randomly picked from the colormap,
perhaps?) in regions where z is outside of zlim.  (on the
Linux version those regions are just plotted in black, which
seems more appropriate)

  For example:

x <- seq(-1,1,length=50)
z1 <- expand.grid(x,x)
z2 <- matrix(apply(z1,1,function(x)sum(x^2)),nrow=50)
image(z2,zlim=c(0.5,1.5))


--please do not edit the information below--

Version:
 platform = Windows
 arch = x86
 os = Win32
 system = x86, Win32
 status = 
 major = 1
 minor = 0.0
 year = 2000
 month = February
 day = 29
 language = R

Windows 9x 4.0 (build 1212)  B

Search Path:
 .GlobalEnv, Autoloads, package:base

-- 
Ben Bolker                                  bolker@zoo.ufl.edu
Zoology Department, University of Florida   http://www.zoo.ufl.edu/bolker
318 Carr Hall/Box 118525                    tel: (352) 392-5697
Gainesville, FL 32611-8525                  fax: (352) 392-3704


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From bolker@zoo.ufl.edu  Wed Apr 19 15:46:45 2000
From: bolker@zoo.ufl.edu (Ben Bolker)
Date: Wed, 19 Apr 2000 10:46:45 -0400 (EDT)
Subject: [Rd] scale factors/overdispersion in GLM: possible bug?
Message-ID: <Pine.LNX.4.10.10004191030500.863-100000@bolker.zoo.ufl.edu>


  I've been poking around with GLMs (on which I am *not* an expert) on
behalf of a student, particularly binomial (standard logit link) nested
models with overdispersion.

  I have one possible bug to report (but I'm not confident enough to be
*sure* it's a bug); one comment on the general inconsistency that seems to
afflict the various functions for dealing with overdispersion in GLMs
(anova.glm, drop1.glm, summary.glm); and one statistical query that maybe
someone would answer if they're feeling generous.

  1.  possible bug:
  in drop1.glm() with scale != 0, R seems to divide by the dispersion
parameter twice:

 first (if family != "gaussian") it sets

 loglik <- dev/dispersion

 then (if test == "Chisq") it calculates

     dev <- loglik - loglik[1]
     dev[nas] <- 1 - pchisq(dev[nas]/dispersion, aod$Df[nas])

(in addition, I suppose this could now be just 
pchisq(...,lower.tail=FALSE) for greater precision)

  Is this a bug or am I missing something?

  2.  There seems to be a fair amount of variability in how drop1.glm,
anova.glm, stat.anova, summary.glm deal with dispersion parameters:
  summary.glm() has an optional parameter called "dispersion"
  stat.anova() has a parameter called "scale", which it doesn't even use
if test=="Chisq"
  anova.glm calls stat.anova() with an automatically calculated scale
parameter (sum(object$weights*object$residuals^2)/object$df.residual), not
allowing a user-defined scale
  drop1.glm() has an optional parameter called "scale"

  I would mess around and try to fix these myself, but (1) there seem to
be some design decisions to make here, (2) I'm not sufficiently sure of
myself to want to break things.

  3. There seems to be a certain variety of advice around in how to deal
with overdispersion in GLMs.  One could (1) calculate the scale parameter
from the residuals (either residual deviance/residual df or Pearson
chi-sq/residual df) and feed that back into the analysis; (2) use
quasi-likelihood with logit link and variance mu(1-mu); (3) use a form of
F-test, as suggested by Crawley (which I guess has something to do with
the fact that the scale parameter is estimated, not really known).  Are
these equivalent, or approximately equivalent?  Does anyone have a
favorite reference on the subject?  (I've been looking at V&R3, Crawley's
"GLIM for Ecologists", and Lindsey's GLM book -- I haven't acquired Dobson
or McCullagh and Nelder yet).

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ligges@statistik.uni-dortmund.de  Wed Apr 19 16:03:06 2000
From: ligges@statistik.uni-dortmund.de (Uwe Ligges)
Date: Wed, 19 Apr 2000 17:03:06 +0200
Subject: [Rd] Windows-specific: image(z,zlim=()) gives bogus colors outside
 range (PR#525)
References: <200004191423.QAA23141@pubhealth.ku.dk>
Message-ID: <38FDCAAA.41B5DAE@statistik.uni-dortmund.de>

bolker@zoo.ufl.edu schrieb:
> 
>   In the Windows version of R (not in the equivalent version
> running on Linux RH 6.0), doing image(z,zlim=c(a,b)) with
> non-trivial limits (i.e., smaller than the range of z)
> plots bogus colors (randomly picked from the colormap,
> perhaps?) in regions where z is outside of zlim.  (on the
> Linux version those regions are just plotted in black, which
> seems more appropriate)
> 
>   For example:
> 
> x <- seq(-1,1,length=50)
> z1 <- expand.grid(x,x)
> z2 <- matrix(apply(z1,1,function(x)sum(x^2)),nrow=50)
> image(z2,zlim=c(0.5,1.5))

Additionally try

  image(z2,zlim=c(0.5,0.500001))

Gives segmentation fault on Solaris / Dr. Watson on WinNT

Regards, 
Uwe Ligges
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From bolker@zoo.ufl.edu  Wed Apr 19 16:02:55 2000
From: bolker@zoo.ufl.edu (Ben Bolker)
Date: Wed, 19 Apr 2000 11:02:55 -0400 (EDT)
Subject: [Rd] Windows-specific: image(z,zlim=()) gives bogus colors
 outside  range (PR#525)
In-Reply-To: <38FDCAAA.41B5DAE@statistik.uni-dortmund.de>
Message-ID: <Pine.LNX.4.10.10004191059540.885-100000@bolker.zoo.ufl.edu>


  Oops, I take it back.  I *thought* it worked on Linux, but I just tried
it and got the same problem -- and I get the segmentation fault on Linux
too.

On Wed, 19 Apr 2000, Uwe Ligges wrote:

> bolker@zoo.ufl.edu schrieb:
> > 
> >   In the Windows version of R (not in the equivalent version
> > running on Linux RH 6.0), doing image(z,zlim=c(a,b)) with
> > non-trivial limits (i.e., smaller than the range of z)
> > plots bogus colors (randomly picked from the colormap,
> > perhaps?) in regions where z is outside of zlim.  (on the
> > Linux version those regions are just plotted in black, which
> > seems more appropriate)
> > 
> >   For example:
> > 
> > x <- seq(-1,1,length=50)
> > z1 <- expand.grid(x,x)
> > z2 <- matrix(apply(z1,1,function(x)sum(x^2)),nrow=50)
> > image(z2,zlim=c(0.5,1.5))
> 
> Additionally try
> 
>   image(z2,zlim=c(0.5,0.500001))
> 
> Gives segmentation fault on Solaris / Dr. Watson on WinNT
> 
> Regards, 
> Uwe Ligges
> 
> 

-- 
Ben Bolker                                  bolker@zoo.ufl.edu
Zoology Department, University of Florida   http://www.zoo.ufl.edu/bolker
318 Carr Hall/Box 118525                    tel: (352) 392-5697
Gainesville, FL 32611-8525                  fax: (352) 392-3704

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From lamj@stat.cmu.edu  Wed Apr 19 16:27:37 2000
From: lamj@stat.cmu.edu (lamj@stat.cmu.edu)
Date: Wed, 19 Apr 2000 17:27:37 +0200 (MET DST)
Subject: [Rd] INSTALL_SCRIPT during installation (PR#526)
Message-ID: <200004191527.RAA23531@pubhealth.ku.dk>

The following patch uses INSTALL_SCRIPT to install scripts, as opposed
to directly using INSTALL.  It is relative to R-1.0.1 source.

     -- Johnny C. Lam <lamj@stat.cmu.edu>
        Department of Statistics, Carnegie Mellon University
        http://www.stat.cmu.edu/~lamj/

--- Makeconf.in.orig	Sat Jan 22 15:10:00 2000
+++ Makeconf.in	Mon Apr 17 16:04:58 2000
@@ -23,6 +23,7 @@
 INSTALL = @INSTALL@
 INSTALL_DATA = @INSTALL_DATA@
 INSTALL_PROGRAM = @INSTALL_PROGRAM@
+INSTALL_SCRIPT = @INSTALL_SCRIPT@
 INSTALL_DIR = ${INSTALL} -d
 LATEX = @LATEX@
 LDCMD = @LDCMD@
--- Makefile.in.orig	Mon Feb 21 02:03:26 2000
+++ Makefile.in	Mon Apr 17 16:11:47 2000
@@ -74,7 +74,7 @@
 	@for f in `ls bin/* | grep -v '^bin/R\**$$' \
 	                    | grep -v '^bin/R.X11\**$$' \
 	                    | grep -v '^bin/R.GNOME\**$$'`; do \
-	  $(INSTALL) $${f} $(rhome)/bin; \
+	  $(INSTALL_SCRIPT) $${f} $(rhome)/bin; \
 	done
 	@echo "installing headers ..."
 	@for f in include/*.h; do \
--- src/scripts/Makefile.in.orig	Mon Feb 21 05:49:10 2000
+++ src/scripts/Makefile.in	Mon Apr 17 16:13:11 2000
@@ -38,10 +38,10 @@
 	  > $(top_builddir)/bin/R
 	@chmod +x $(top_builddir)/bin/R
 	@for f in $(SCRIPTS_S); do \
-	  $(INSTALL) $(srcdir)/$$f $(top_builddir)/bin; \
+	  $(INSTALL_SCRIPT) $(srcdir)/$$f $(top_builddir)/bin; \
 	done
 	@for f in $(SCRIPTS_B); do \
-	  $(INSTALL) $$f $(top_builddir)/bin; \
+	  $(INSTALL_SCRIPT) $$f $(top_builddir)/bin; \
 	done
 
 $(SCRIPTS_B): $(top_builddir)/config.status


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From thomas@biostat.washington.edu  Wed Apr 19 16:55:43 2000
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Wed, 19 Apr 2000 08:55:43 -0700 (PDT)
Subject: [Rd] Windows-specific: image(z,zlim=()) gives bogus colors
 outside  range (PR#525)
In-Reply-To: <Pine.LNX.4.10.10004191059540.885-100000@bolker.zoo.ufl.edu>
Message-ID: <Pine.GSO.4.21.0004190855090.27936-100000@mail.biostat.washington.edu>

On Wed, 19 Apr 2000, Ben Bolker wrote:

> 
>   Oops, I take it back.  I *thought* it worked on Linux, but I just tried
> it and got the same problem -- and I get the segmentation fault on Linux
> too.

This seems to have been fixed in the development branch at least.

	-thomas

Thomas Lumley
Assistant Professor, Biostatistics
University of Washington, Seattle


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ligges@statistik.uni-dortmund.de  Wed Apr 19 17:01:38 2000
From: ligges@statistik.uni-dortmund.de (Uwe Ligges)
Date: Wed, 19 Apr 2000 18:01:38 +0200
Subject: [Rd] .Renviron and WinNT4 SP5/SP6
Message-ID: <38FDD862.6DDC642C@statistik.uni-dortmund.de>

Hello!

This is a really rare problem / bug(?).

I tested around because of the mail on R-Help:

  Faheem Mitha <faheem@email.unc.edu>
  Subj.: increasing memory size


I created a file .Renviron:

   R_VSIZE=10M

without a linebreak after that line, because I thought Faheem might have
forgot it.
I expected, the line would not be interpreted.

To my surprise R crashed at once (R-1.0.0 patched, WinNT4.0 SP6).
Using the same R-1.0.0 (files on the same Server) but on a WinNT4.0 SP5
machine, it works as expected (R starts without interpreting
"R_VSIZE=10M").


Regards,
Uwe Ligges
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Wed Apr 19 17:43:43 2000
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 19 Apr 2000 18:43:43 +0200 (CEST)
Subject: [Rd] INSTALL_SCRIPT during installation (PR#526)
In-Reply-To: <200004191527.RAA23531@pubhealth.ku.dk>
References: <200004191527.RAA23531@pubhealth.ku.dk>
Message-ID: <14589.57919.217396.444893@aragorn.ci.tuwien.ac.at>

>>>>> lamj  writes:

> The following patch uses INSTALL_SCRIPT to install scripts, as opposed
> to directly using INSTALL.  It is relative to R-1.0.1 source.

I am not sure this is really a bug, and the changes are already in 1.1.0
anyway.  If someone is willing to make the change in 1.0.1, please note:
the changes in Makeconf.in and src/scripts/Makefile.in are fine.  The
one in Makefile.in is not, because 1.1.0 has GUI shared libs as well,
which need INSTALL rather than INSTALL_SCRIPT.  I think one can get that
right via `grep -v '^bin/R_''.

Hmm ...

-k

>      -- Johnny C. Lam <lamj@stat.cmu.edu>
>         Department of Statistics, Carnegie Mellon University
>         http://www.stat.cmu.edu/~lamj/

> --- Makeconf.in.orig	Sat Jan 22 15:10:00 2000
> +++ Makeconf.in	Mon Apr 17 16:04:58 2000
> @@ -23,6 +23,7 @@
>  INSTALL = @INSTALL@
>  INSTALL_DATA = @INSTALL_DATA@
>  INSTALL_PROGRAM = @INSTALL_PROGRAM@
> +INSTALL_SCRIPT = @INSTALL_SCRIPT@
>  INSTALL_DIR = ${INSTALL} -d
>  LATEX = @LATEX@
>  LDCMD = @LDCMD@
> --- Makefile.in.orig	Mon Feb 21 02:03:26 2000
> +++ Makefile.in	Mon Apr 17 16:11:47 2000
> @@ -74,7 +74,7 @@
>  	@for f in `ls bin/* | grep -v '^bin/R\**$$' \
>  	                    | grep -v '^bin/R.X11\**$$' \
>  	                    | grep -v '^bin/R.GNOME\**$$'`; do \
> -	  $(INSTALL) $${f} $(rhome)/bin; \
> +	  $(INSTALL_SCRIPT) $${f} $(rhome)/bin; \
>  	done
>  	@echo "installing headers ..."
>  	@for f in include/*.h; do \
> --- src/scripts/Makefile.in.orig	Mon Feb 21 05:49:10 2000
> +++ src/scripts/Makefile.in	Mon Apr 17 16:13:11 2000
> @@ -38,10 +38,10 @@
>> $(top_builddir)/bin/R
>  	@chmod +x $(top_builddir)/bin/R
>  	@for f in $(SCRIPTS_S); do \
> -	  $(INSTALL) $(srcdir)/$$f $(top_builddir)/bin; \
> +	  $(INSTALL_SCRIPT) $(srcdir)/$$f $(top_builddir)/bin; \
>  	done
>  	@for f in $(SCRIPTS_B); do \
> -	  $(INSTALL) $$f $(top_builddir)/bin; \
> +	  $(INSTALL_SCRIPT) $$f $(top_builddir)/bin; \
>  	done
 
>  $(SCRIPTS_B): $(top_builddir)/config.status


> -.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
> r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
> Send "info", "help", or "[un]subscribe"
> (in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
> _._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Wed Apr 19 22:10:49 2000
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Wed, 19 Apr 2000 17:10:49 -0400
Subject: [Rd] R CMD check seg fault in Linux
Message-ID: <38FE20D9.E83527F9@bank-banque-canada.ca>

For some of my packages I am getting a segmentation fault in Linux when
I use R CMD check. (Using R 1.0.1) The segmentation fault does not
happen in Solaris and in some cases it does not happen in Linux if I set
R_NSIZE and R_VSIZE much higher than I need in Solaris. Should I expect
a segmentation fault if there is not enough memory for R CMD check, or
are these unrelated?

Paul Gilbert

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Wed Apr 19 22:55:58 2000
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 19 Apr 2000 23:55:58 +0200
Subject: [Rd] R CMD check seg fault in Linux
In-Reply-To: Paul Gilbert's message of "Wed, 19 Apr 2000 17:10:49 -0400"
References: <38FE20D9.E83527F9@bank-banque-canada.ca>
Message-ID: <x2ya69kb69.fsf@blueberry.kubism.ku.dk>

Paul Gilbert <pgilbert@bank-banque-canada.ca> writes:

> For some of my packages I am getting a segmentation fault in Linux when
> I use R CMD check. (Using R 1.0.1) The segmentation fault does not
> happen in Solaris and in some cases it does not happen in Linux if I set
> R_NSIZE and R_VSIZE much higher than I need in Solaris. Should I expect
> a segmentation fault if there is not enough memory for R CMD check, or
> are these unrelated?

It's certainly not the intention to give segfaults for that reason...

However, the same pattern could occur from PROTECT errors in your C
code, triggered by a garbage collection at just the wrong moment
(which could be different on different OSs). 

You should rerun the relevant testscript under "R -d gdb" and see
exactly where the segfault occurs.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Thu Apr 20 16:28:54 2000
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Thu, 20 Apr 2000 11:28:54 -0400
Subject: [Rd] R CMD check seg fault in Linux
References: <38FE20D9.E83527F9@bank-banque-canada.ca> <x2ya69kb69.fsf@blueberry.kubism.ku.dk>
Message-ID: <38FF2236.AFE7EC04@bank-banque-canada.ca>

>>Should I expect
>> a segmentation fault if there is not enough memory for R CMD check, or
>> are these unrelated?

>It's certainly not the intention to give segfaults for that reason...
...
>You should rerun the relevant testscript under "R -d gdb" and see
>exactly where the segfault occurs.

It seems the correlation with CMD check and memory was spurious but I have now
observered that the seg faults occur when I run tests on one Linux machine, but
not when I run on the Linux machine I used for installing R (from source) and my
code (which includes some fortan). The machines have similar Linux2.2.9/Mandrake
installations (but fortran didn't get installed on one). The biggest difference
is that the one with fortran installed has has a Celeron processor and the other
one has an AMD-K6. I've never had problems with this differences before. It
might be some time before I get a chance to really dig into it with gdb so if
anyone has any quick insights I would appreciate suggestions. Would there be
compiler flags for different processors or anything like that which might cause
a problem?

Thanks,
Paul Gilbert

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pd@blueberry.kubism.ku.dk  Fri Apr 21 06:15:04 2000
From: pd@blueberry.kubism.ku.dk (Peter Dalgaard BSA)
Date: Fri, 21 Apr 2000 07:15:04 +0200
Subject: [Rd] Bug list summary (automatic post)
Message-ID: <200004210515.HAA04991@blueberry.kubism.ku.dk>

=================================================
This is an automated summary of the status of the R-bugs
repository.

Note that this may be neither complete nor perfectly
correct at any given instance: Not all bugs are reported,
and some reported bugs may have been fixed, but the
repository not yet updated.

Some bug fixes are difficult to verify because they pertain
to specific hardware or operating system versions. If you
have information to contribute, please do so.

If you happen to know how to fix a problem please send
patches to the bug repository, too.

New bugs are reported either through the web
interface at r-bugs.biostat.ku.dk or via email to
r-bugs@biostat.ku.dk. The bug.report() function can be
used to automate parts of the procedure on many systems.
Followups on older bugs can be done by including the string
"(PR#999)" in the Subject of an email (change 999 to the
actual reference number, of course!).
=================================================

Directory:  Accuracy

none

Directory:  Add-ons

* PR# 503 *
Subject: dmvnorm() bug in e1071
From: "Gregory R. Warnes" <warnes@biostat.washington.edu>
Date: Fri, 24 Mar 2000 03:24:45 +0000 (GMT)
* PR# 496 *
From: bonneau@epi.roazhon.inra.fr (en148)
Date: Tue, 21 Mar 2000 10:57:13 +0100 (MET)
--base R has no est.variogram function.
--This appears to be a bug report on sgeostat.
* PR# 488 *
Subject: Error in lme?
From: simon.frost@ed.ac.uk
Date: Tue, 14 Mar 2000 14:15:52 +0100 (MET)
--No example to reproduce this.
* PR# 471 *
Subject:  Problems with nlme 
From: Berwin Turlach <berwin@maths.uwa.edu.au>
Date: Tue, 7 Mar 2000 15:28:00 +0800
--Problem 1) was a subscripting bug introduced in 1.0.0 and fixed for 1.0.1
--Problem 2) (mssing datasets) needs a revised nlme

Directory:  Analyses

none

Directory:  Documentation

none

Directory:  Graphics

* PR# 510 *
Subject:  Strange behaviour of image 
From: J.C.Rougier@durham.ac.uk
Date: Thu, 6 Apr 2000 19:15:19 +0100 (BST)
--At least an inaccurate description.
--To be changed (with a back-compatibility option) in 1.1.0
* PR# 400 *
Subject: X11 troubles
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 13 Jan 2000 14:31:42 +0100
--a) We don't handle multiple window closes well
--b) X11 errors should be caught by an error handler, not kill R
* PR# 202 *
Subject: persp box occlusion bug
From: wsi@gcal.ac.uk
Date: Wed, 2 Jun 1999 15:02:03 +0200 (MET DST)
--The persp algorithm does not apply the occlusion rules to the frame, 
--which is always plotted first. 
--A bug, but not very simple to fix.
* PR# 495 *
Subject: barplot
From: skala@incoma.cz
Date: Tue, 21 Mar 2000 09:20:33 +0100 (MET)
* PR# 414 *
Subject:  graphics bugs: steep slopes and large values beyond ylim 
From: Ben Bolker <bolker@zoo.ufl.edu>
Date: Mon, 7 Feb 2000 18:28:04 -0500
--Followup on R-devel showed this was due to generating integer coordinates 
--outside +/- 2^15 in the X11 driver.

Directory:  In-Out

none

Directory:  Installation

* PR# 485 *
Subject: Install R1.0.0
From: Lynn Zhang <lyzhang@umich.edu>
Date: Mon, 13 Mar 2000 16:10:52 -0500 (EST)
* PR# 478 *
Subject: Conditional for XDR code left out in saveload.c
From: hoffmann@ehmgs2.et.tu-dresden.de
Date: Thu, 9 Mar 2000 09:43:01 +0100 (MET)
--This seems to be a harmless warning, not an error.
* PR# 467 *
Subject: Re: [R] Re: R-1.0.0 is released
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 01 Mar 2000 20:26:40 +0100
--followup to PR#466
* PR# 466 *
Subject: Re: R-1.0.0 is released
From: bhoel@server.python.net (Berthold=?iso-8859-1?q?_H=F6llmann?=)
Date: 01 Mar 2000 16:00:54 +0100

Directory:  Language

* PR# 412 *
Subject: anomalies with call objects
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 06 Feb 2000 01:18:50 +0100
* PR# 408 *
Subject: convolution bug
From: wsimpson@gcal.ac.uk
Date: Fri, 28 Jan 2000 11:17:36 +0100 (MET)

Directory:  Low-level

* PR# 505 *
Subject: interrupted save 
From: Thomas Lumley <thomas@biostat.washington.edu>
Date: Sat, 25 Mar 2000 12:16:50 -0800 (PST)

Directory:  Misc

none

Directory:  Models

none

Directory:  Startup

* PR# 486 *
Subject: Re: autoload error in profile {was anova-bug in R-version  1.0.0?}
From: Martin Maechler <maechler@stat.math.ethz.ch>
Date: Tue, 14 Mar 2000 10:32:43 +0100 (MET)
--workaround to the origin problem in 1.0.1
--New report: try does not work from the profile.

Directory:  System-specific

* PR# 490 *
Subject: R-1.0.0 on alpha/osf1 memory glitch
From: Ray Brownrigg <Ray.Brownrigg@mcs.vuw.ac.nz>
Date: Fri, 17 Mar 2000 11:25:30 +1300 (NZDT)
* PR# 452 *
Subject: problem with glm
From: Brad McNeney <mcneney@cs.sfu.ca>
Date: Fri, 18 Feb 2000 17:51:54 -0800 (PST)
--Problems on Alpha's with glm. Status unclear

Directory:  TooMuchAtOnce

none

Directory:  Windows

none

Directory:  incoming

* PR# 526 *
Subject: INSTALL_SCRIPT during installation
From: "Johnny C. Lam" <lamj@stat.cmu.edu>
Date: Wed, 19 Apr 2000 11:27:52 -0400
* PR# 520 *
Subject: Rd2Sd conversion: files
From: Sergei Zuyev <sergei@stams.strath.ac.uk>
Date: Fri, 14 Apr 2000 13:26:19 +0100
* PR# 519 *
Subject: bundle build and Rd2Sd converion fail
From: Sergei Zuyev <sergei@stams.strath.ac.uk>
Date: Fri, 14 Apr 2000 13:13:48 +0100
* PR# 522 *
Subject: na.omit fails for matrices
From: Sergei Zuyev <sergei@stams.strath.ac.uk>
Date: Mon, 17 Apr 2000 11:52:28 +0100
* PR# 521 *
Subject: akima core dumps on loading
From: santini@dsi.unimi.it
Date: Mon, 17 Apr 2000 11:30:41 +0200 (MET DST)
* PR# 525 *
Subject: Windows-specific: image(z,zlim=()) gives bogus colors outside range
From: Ben Bolker <ben@zoo.ufl.edu>
Date: Wed, 19 Apr 2000 10:20:12 -0400 (EDT)
* PR# 524 *
Subject: strheight() crashes without opened device
From: Uwe Ligges <ligges@statistik.uni-dortmund.de>
Date: Tue, 18 Apr 2000 19:42:00 +0200
* PR# 523 *
Subject: Maths in R documentation
From: Martyn Plummer <plummer@iarc.fr>
Date: Mon, 17 Apr 2000 18:18:55 +0200 (CEST)
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From salwin@mitretek.org  Mon Apr 24 19:36:55 2000
From: salwin@mitretek.org (salwin@mitretek.org)
Date: Mon, 24 Apr 2000 20:36:55 +0200 (MET DST)
Subject: [Rd] Comments on Win95 R Distribution (PR#527)
Message-ID: <200004241836.UAA08583@pubhealth.ku.dk>

Here are some comments generated by a new R user based on
initial experiences with the tool.  

On-line help for tapply:
The following appears "for to each (non-empty) group of
values"  It seems there's an extra preposition in this
sentence.

On-line help for cut:
"break" should be "breaks"

morley.data not available with the distribution.  Would be
helpful for doing the examples in the Intro.

The rwinst.exe did not work at all on Win95.  It could find
no files.  Wasn't clear from the instructions which
directory I should be in while running rwinst.  I tried
several; none worked.  So I manually unzipped the files and
they worked fine.  


-- 
Art Salwin
salwin@mitretek.org
(202) 863-2985
(202) 863-2988 (fax)

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Tue Apr 25 08:09:32 2000
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Tue, 25 Apr 2000 08:09:32 +0100 (BST)
Subject: [Rd] Comments on Win95 R Distribution (PR#527)
In-Reply-To: <200004241836.UAA08583@pubhealth.ku.dk>
Message-ID: <Pine.GSO.4.05.10004250800560.13729-100000@auk.stats>

On Mon, 24 Apr 2000 salwin@mitretek.org wrote:

> Here are some comments generated by a new R user based on
> initial experiences with the tool.  

Please give the R version number or (preferably) use bug.report() to
generate the report.

> On-line help for tapply:
> The following appears "for to each (non-empty) group of
> values"  It seems there's an extra preposition in this
> sentence.
> 
> On-line help for cut:
> "break" should be "breaks"

[Fixed, thank you]

> morley.data not available with the distribution.  Would be
> helpful for doing the examples in the Intro.

That has already been altered for R 1.1. The file is in the Rnotes
package on CRAN at present, and will be in 1.1.0 on.

> The rwinst.exe did not work at all on Win95.  It could find
> no files.  Wasn't clear from the instructions which
> directory I should be in while running rwinst.  I tried
> several; none worked.  So I manually unzipped the files and
> they worked fine.  

You can use it from anywhere, hence it does not specify where. This
puzzles me: you have to set the source directory to where the files
are: use the Browse button to do so.  The installer is known to work
on Windows 95, and there have been many, many, successful uses.
Could you please try again using Browse to get the right directory
with the zip files?


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From john.maindonald@anu.edu.au  Wed Apr 26 03:41:51 2000
From: john.maindonald@anu.edu.au (john.maindonald@anu.edu.au)
Date: Wed, 26 Apr 2000 04:41:51 +0200 (MET DST)
Subject: [Rd] Wrong SEs in predict.lm(..., type="terms") (PR#528)
Message-ID: <200004260241.EAA22007@pubhealth.ku.dk>

>From e980153 Tue Apr 25 14:42:27 2000
To: r-help@stat.math.ethz.ch
Subject: Wrong SEs in predict.lm(..., type="terms")

For what it is worth, I am using RW-1.0.0 under Windows 98.
I submitted this earlier to r-help.  There is one change
below to my proposed corrected code:

predict.lm(..., type="terms") gives wrong standard errors.

Below, I have provided what I believe are the necessary fixes.
However, there are subtleties, and the code needs careful
checking.  Some of the looping is surely not necessary, but
it is surely best to begin with the minimum necessary changes.

My tests, including checks against S-PLUS, have extended to fitting
spline curves.  I have not tested the code with any example where
the pivot sequence does not run sequentially from 1 to p1.

df<-data.frame(x=1:9,y=c(2,3,6,4,8,10,12,14,15))
> df.lm_lm(y~x,data=df)
> as.vector(predict(df.lm,se=T,type="terms")$se.fit)
[1] 0.9904885 0.7428664 0.4952442 0.2476221 0.0000000 0.2476221 0.4952442
[8] 0.7428664 0.9904885

Here is what one should get:
> abs((df$x-mean(df$x)))*summary(df.lm)$coef[2,2]
[1] 0.5769836 0.4327377 0.2884918 0.1442459 0.0000000 0.1442459 0.2884918
[8] 0.4327377 0.5769836

Here is the relevant section of corrected code:


    if (type=="terms"){
      asgn <- attrassign(object)
      beta<-coef(object)
      hasintercept<-attr(tt,"intercept")>0
      if (hasintercept)
        asgn$"(Intercept)"<-NULL
      nterms<-length(asgn)
      predictor<-matrix(ncol=nterms,nrow=NROW(X))
      dimnames(predictor)<-list(rownames(X),names(asgn))

      if (se.fit){
        ip<-matrix(ncol=nterms,nrow=NROW(X))
        dimnames(ip)<-list(rownames(X),names(asgn))
      }
      if (hasintercept){     # This was omitted in the code on r-help
        avX<-apply(X,2,mean)  
        X<-sweep(X,2,avX)    # We'd best sweep out column means
                             # before we start
      }
      for (i in seq(1,nterms,length=nterms)){
        ii<-piv[asgn[[i]]]
	        predictor[,i]<-X[,ii,drop=F]%*%(beta[ii])
        if (se.fit){
          ii2_asgn[[i]]      # X[,piv] matches rows & columns of R
          vci<-R[ii2,ii2]*res.var
          for(j in (1:NROW(X))){
            xi<-X[j,ii,drop=F]  # Do not multiply by beta[ii]
           ip[j,i]<-sum(xi%*% vci %*%t(xi))

          }
        }
      }

Here is the existing section of the (1.0.0) code:

    if (type=="terms"){
      asgn <- attrassign(object)
      beta<-coef(object)
      hasintercept<-attr(tt,"intercept")>0
      if (hasintercept)
        asgn$"(Intercept)"<-NULL
      nterms<-length(asgn)
      predictor<-matrix(ncol=nterms,nrow=NROW(X))
      dimnames(predictor)<-list(rownames(X),names(asgn))
      if (se.fit){
        ip<-matrix(ncol=nterms,nrow=NROW(X))
        dimnames(ip)<-list(rownames(X),names(asgn))
      }
      for (i in seq(1,nterms,length=nterms)){
        if (hasintercept)  # Redundant
          i0<-1            # Redundant
        else               # Redundant
          i0<-NULL         # Redundant
        ii<-piv[asgn[[i]]]
        predictor[,i]<-X[,ii,drop=F]%*%(beta[ii])  # Should be centred
        X[,ii]<-X[,ii]-mean(X[,ii]) # Columns must be centred individually
        if (se.fit){
          vci<-R[ii,ii]*res.var    # The pivot should not be applied to R
          for(j in (1:NROW(X))){
            xi<-X[j,ii,drop=F]*(beta[ii])  # Do not Xply by beta
            ip[j,i]<-sum(xi%*% vci %*%t(xi))
          }
        }
      }


John Maindonald               email : john.maindonald@anu.edu.au        
Statistical Consulting Unit,  phone : (6249)3998        
c/o CMA, SMS,                 fax   : (6249)5549  
John Dedman Mathematical Sciences Building
Australian National University
Canberra ACT 0200
Australia


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From bates@stat.wisc.edu  Thu Apr 27 00:05:14 2000
From: bates@stat.wisc.edu (Douglas Bates)
Date: Wed, 26 Apr 2000 18:05:14 -0500 (CDT)
Subject: [Rd] Cross compiling a package for Windows on Linux
Message-ID: <m12karq-000ZSaC@franz.stat.wisc.edu>

I would like to compile for Windows a rather simple R package that
contains some C code.  It does not contain any Fortran code.

I tried the cross-compilation route using the pre-built set of tools
from http://www.devolution.com/~slouken/SDL/Xmingw32/, as described in
$R_SRC/src/gnuwin32/INSTALL

Using the sources in r-devel from the rsync site I am able to build
libR.a in src/gnuwin32 but I can't build the package.  Using the
sources in r-release-patched from the rsync site I am unable to build
libR.a.  The tail end of that compilation log is

 $ cd r-release/src/gnuwin32/
 $ make
 mkdir -p ../../bin 
 make -C ./fixed
 make[1]: Entering directory `/usr/src/r-release/src/gnuwin32/fixed'
 -------- Building ../../../library/base/R/Rprofile from ../../library/profile/Common.R ../../library/profile/Rprofile.gnw--------
 mkdir -p ../../../library/base/R
 cat  ../../library/profile/Common.R ../../library/profile/Rprofile.gnw > ../../../library/base/R/Rprofile
 sed -e '/^#/d' -e '/Rsockfork/d' -e 's/F77_SUBROUTINE(\(.*\))/void * \1_();/' -e 's/C_FUNCTION(\(.*\))/void * \1();/' ../../appl/ROUTINES > ../../include/FFDecl.h
 sed -e '/^#/d' -e '/Rsockfork/d' -e 's/F77_SUBROUTINE(\(.*\))/	{ "\1_",	\1_},/' -e 's/C_FUNCTION(\(.*\))/{ "\1",	\1 },/' ../../appl/ROUTINES > ../../include/FFTab.h
 sh ./GETCONFIG > ../../include/Rconfig.h
 sh ./GETVERSION > ../../include/Rversion.h
 cp -p ./h/config.h ./h/psignal.h ../../include
 echo done > fixh
 (cd ../../../doc; \
 cat html/search/SearchEngine-head.html > html/search/SearchEngine.html; \
 perl ../src/gnuwin32/fixed/keywords2html KEYWORDS.db >> html/search/SearchEngine.html; \
 cat html/search/SearchEngine-foot.html >> html/search/SearchEngine.html)
 cp -p ./r/*.html ../../../doc/html
 echo done > fixr
 cp -p  bin/Rd2dvi.sh bin/Rd2txt.bat bin/Rdconv.bat bin/Rdindex.bat bin/Sd2Rd.bat bin/fwf2table bin/helpPRINT.bat ../../../bin
 echo done > fixbin
 cp -p etc/Rconsole etc/Rdevga etc/Rprofile etc/rgb.txt ../../../etc
 echo done > fixetc
 ...  (many lines deleted)
 i386-mingw32-gcc -isystem /packages/R-X/i386-mingw32/include   -O2 -Wall -pedantic -I../include -I../include/R_ext -DHAVE_CONFIG_H  -c zeroin.c -o zeroin.o
 i386-mingw32-g77 -O2 -Wall -pedantic  -c blas.f -o blas.o
 make[1]: i386-mingw32-g77: Command not found
 make[1]: *** [blas.o] Error 127
 make[1]: Leaving directory `/usr/src/r-release/src/appl'
 make: *** [rlibs] Error 2
 $ make libR.a
 i386-mingw32-gcc -isystem /packages/R-X/i386-mingw32/include   -O2 -Wall -pedantic -I../include -I../include/R_ext -I. -DHAVE_CONFIG_H  -c console.c -o console.o
 i386-mingw32-gcc -isystem /packages/R-X/i386-mingw32/include   -O2 -Wall -pedantic -I../include -I../include/R_ext -I. -DHAVE_CONFIG_H  -c dataentry.c -o dataentry.o
 i386-mingw32-gcc -isystem /packages/R-X/i386-mingw32/include   -O2 -Wall -pedantic -I../include -I../include/R_ext -I. -DHAVE_CONFIG_H  -c devga.c -o devga.o
 i386-mingw32-gcc -isystem /packages/R-X/i386-mingw32/include   -O2 -Wall -pedantic -I../include -I../include/R_ext -I. -DHAVE_CONFIG_H  -c dodevga.c -o dodevga.o
 i386-mingw32-gcc -isystem /packages/R-X/i386-mingw32/include   -O2 -Wall -pedantic -I../include -I../include/R_ext -I. -DHAVE_CONFIG_H  -c dounzip.c -o dounzip.o
 i386-mingw32-gcc -isystem /packages/R-X/i386-mingw32/include   -O2 -Wall -pedantic -I../include -I../include/R_ext -I. -DHAVE_CONFIG_H  -c dynload.c -o dynload.o
 i386-mingw32-gcc -isystem /packages/R-X/i386-mingw32/include   -O2 -Wall -pedantic -I../include -I../include/R_ext -I. -DHAVE_CONFIG_H  -c edit.c -o edit.o
 i386-mingw32-gcc -isystem /packages/R-X/i386-mingw32/include   -O2 -Wall -pedantic -I../include -I../include/R_ext -I. -DHAVE_CONFIG_H  -c extra.c -o extra.o
 extra.c: In function `Rwin_fpset':
 extra.c:452: warning: implicit declaration of function `_fpreset'
 extra.c:453: warning: implicit declaration of function `_controlfp'
 extra.c:453: `_MCW_EM' undeclared (first use in this function)
 extra.c:453: (Each undeclared identifier is reported only once
 extra.c:453: for each function it appears in.)
 make: *** [extra.o] Error 1
 $ i386-mingw32-gcc --version
 2.95.2


With the sources from r-devel, which have been changed today, I can
generate libR.a but I cannot build a library, even with libR.a.  I
tried building the nls library just as a test.  The errors reported after 
make pkg-nls are

 $ make pkg-nls
 make DLLNM=  EXTRADOCS= \
   -C /usr/src/r-devel/src/library/nls PKG=nls RHOME=/usr/src/r-devel RLIB=/usr/src/r-devel/library \
   -f /usr/src/r-devel/src/gnuwin32/MakePkg
 make[1]: Entering directory `/usr/src/r-devel/src/library/nls'
 ---------- Making package nls ------------
 mkdir -p /usr/src/r-devel/library/nls
 cp -r   ./DESCRIPTION  ./INDEX  ./TITLE  /usr/src/r-devel/library/nls/
 cp: ./DESCRIPTION: No such file or directory
 make[1]: [/usr/src/r-devel/library/nls/zzzz] Error 1 (ignored)
 make -C ./src RHOME=/usr/src/r-devel \
   -f /usr/src/r-devel/src/gnuwin32/MakeDll DLLNAME=nls
 make[2]: Entering directory `/usr/src/r-devel/src/library/nls/src'
 ------- Building nls.dll from nls.a --------
 echo LIBRARY nls > nls.def
 echo EXPORTS >> nls.def
 i386-mingw32-nm nls.a > Defs
 sed -n "/^........ [BCDRT] _/s/^........ [BCDRT] _/ /p" Defs >> nls.def
 i386-mingw32-gcc  -mdll -Wl,--base-file,nls.b -s  -o nls.dll  nls.a  -L/usr/src/r-devel/src/gnuwin32   -lR 
 i386-mingw32-dlltool -k --as i386-mingw32-as   --dllname nls.dll  --base-file nls.b --output-exp nls.e --def nls.def
 i386-mingw32-gcc  -mdll  -Wl,--base-file,nls.b -s  -o nls.dll nls.e nls.a  -L/usr/src/r-devel/src/gnuwin32   -lR 
 nls.a(nls.o)(.text+0x203):nls.c: undefined reference to `Rf_asLogical'
 nls.a(nls.o)(.text+0x20f):nls.c: undefined reference to `Rf_isNewList'
 nls.a(nls.o)(.text+0x223):nls.c: undefined reference to `Rf_error'
 ...  (many lines deleted)
 nls.a(nls.o)(.text+0xb52):nls.c: undefined reference to `Rf_setAttrib'
 nls.a(nls.o)(.text+0xb5c):nls.c: undefined reference to `Rf_unprotect'
 make[2]: *** [nls.dll] Error 1
 make[2]: Leaving directory `/usr/src/r-devel/src/library/nls/src'
 make[1]: *** [src/nls.dll] Error 2
 make[1]: Leaving directory `/usr/src/r-devel/src/library/nls'
 make: *** [pkg-nls] Error 2

Do I need to go back and build a cross-compiler for g77 and start from
scratch?
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Thu Apr 27 07:30:48 2000
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Thu, 27 Apr 2000 07:30:48 +0100 (BST)
Subject: [Rd] Cross compiling a package for Windows on Linux
In-Reply-To: <m12karq-000ZSaC@franz.stat.wisc.edu>
Message-ID: <Pine.GSO.4.05.10004270708090.26167-100000@auk.stats>

On Wed, 26 Apr 2000, Douglas Bates wrote:

> I would like to compile for Windows a rather simple R package that
> contains some C code.  It does not contain any Fortran code.
> 
> I tried the cross-compilation route using the pre-built set of tools
> from http://www.devolution.com/~slouken/SDL/Xmingw32/, as described in
> $R_SRC/src/gnuwin32/INSTALL
> 
> Using the sources in r-devel from the rsync site I am able to build
> libR.a in src/gnuwin32 but I can't build the package.  Using the

Almost certainly you built an incorrect libR.a from the evidence below.

> sources in r-release-patched from the rsync site I am unable to build
> libR.a.  The tail end of that compilation log is
> 
>  $ cd r-release/src/gnuwin32/
>  $ make
>  mkdir -p ../../bin 
>  make -C ./fixed

...

If you use Makefile you are trying to build R, and you can't do that
without Fortran.  To build just a package you need Makefile.packages
and the distributed R.exp file.


>  make[1]: Entering directory `/usr/src/r-release/src/gnuwin32/fixed'
>  -------- Building ../../../library/base/R/Rprofile from ../../library/profile/Common.R ../../library/profile/Rprofile.gnw--------
>  mkdir -p ../../../library/base/R
>  cat  ../../library/profile/Common.R ../../library/profile/Rprofile.gnw > ../../../library/base/R/Rprofile
>  sed -e '/^#/d' -e '/Rsockfork/d' -e 's/F77_SUBROUTINE(\(.*\))/void * \1_();/' -e 's/C_FUNCTION(\(.*\))/void * \1();/' ../../appl/ROUTINES > ../../include/FFDecl.h
>  sed -e '/^#/d' -e '/Rsockfork/d' -e 's/F77_SUBROUTINE(\(.*\))/	{ "\1_",	\1_},/' -e 's/C_FUNCTION(\(.*\))/{ "\1",	\1 },/' ../../appl/ROUTINES > ../../include/FFTab.h
>  sh ./GETCONFIG > ../../include/Rconfig.h
>  sh ./GETVERSION > ../../include/Rversion.h
>  cp -p ./h/config.h ./h/psignal.h ../../include
>  echo done > fixh
>  (cd ../../../doc; \
>  cat html/search/SearchEngine-head.html > html/search/SearchEngine.html; \
>  perl ../src/gnuwin32/fixed/keywords2html KEYWORDS.db >> html/search/SearchEngine.html; \
>  cat html/search/SearchEngine-foot.html >> html/search/SearchEngine.html)
>  cp -p ./r/*.html ../../../doc/html
>  echo done > fixr
>  cp -p  bin/Rd2dvi.sh bin/Rd2txt.bat bin/Rdconv.bat bin/Rdindex.bat bin/Sd2Rd.bat bin/fwf2table bin/helpPRINT.bat ../../../bin
>  echo done > fixbin
>  cp -p etc/Rconsole etc/Rdevga etc/Rprofile etc/rgb.txt ../../../etc
>  echo done > fixetc
>  ...  (many lines deleted)
>  i386-mingw32-gcc -isystem /packages/R-X/i386-mingw32/include   -O2 -Wall -pedantic -I../include -I../include/R_ext -DHAVE_CONFIG_H  -c zeroin.c -o zeroin.o
>  i386-mingw32-g77 -O2 -Wall -pedantic  -c blas.f -o blas.o
>  make[1]: i386-mingw32-g77: Command not found
>  make[1]: *** [blas.o] Error 127
>  make[1]: Leaving directory `/usr/src/r-release/src/appl'
>  make: *** [rlibs] Error 2
>  $ make libR.a
>  i386-mingw32-gcc -isystem /packages/R-X/i386-mingw32/include   -O2 -Wall -pedantic -I../include -I../include/R_ext -I. -DHAVE_CONFIG_H  -c console.c -o console.o
>  i386-mingw32-gcc -isystem /packages/R-X/i386-mingw32/include   -O2 -Wall -pedantic -I../include -I../include/R_ext -I. -DHAVE_CONFIG_H  -c dataentry.c -o dataentry.o
>  i386-mingw32-gcc -isystem /packages/R-X/i386-mingw32/include   -O2 -Wall -pedantic -I../include -I../include/R_ext -I. -DHAVE_CONFIG_H  -c devga.c -o devga.o
>  i386-mingw32-gcc -isystem /packages/R-X/i386-mingw32/include   -O2 -Wall -pedantic -I../include -I../include/R_ext -I. -DHAVE_CONFIG_H  -c dodevga.c -o dodevga.o
>  i386-mingw32-gcc -isystem /packages/R-X/i386-mingw32/include   -O2 -Wall -pedantic -I../include -I../include/R_ext -I. -DHAVE_CONFIG_H  -c dounzip.c -o dounzip.o
>  i386-mingw32-gcc -isystem /packages/R-X/i386-mingw32/include   -O2 -Wall -pedantic -I../include -I../include/R_ext -I. -DHAVE_CONFIG_H  -c dynload.c -o dynload.o
>  i386-mingw32-gcc -isystem /packages/R-X/i386-mingw32/include   -O2 -Wall -pedantic -I../include -I../include/R_ext -I. -DHAVE_CONFIG_H  -c edit.c -o edit.o
>  i386-mingw32-gcc -isystem /packages/R-X/i386-mingw32/include   -O2 -Wall -pedantic -I../include -I../include/R_ext -I. -DHAVE_CONFIG_H  -c extra.c -o extra.o
>  extra.c: In function `Rwin_fpset':
>  extra.c:452: warning: implicit declaration of function `_fpreset'
>  extra.c:453: warning: implicit declaration of function `_controlfp'
>  extra.c:453: `_MCW_EM' undeclared (first use in this function)
>  extra.c:453: (Each undeclared identifier is reported only once
>  extra.c:453: for each function it appears in.)
>  make: *** [extra.o] Error 1
>  $ i386-mingw32-gcc --version
>  2.95.2

I think you omitted to customize MkRules: it seems highly unlikely that
/packages/R-X/i386-mingw32/include is correct for you (it is from my
system): INSTALL says

> Edit MkRules to set BUILD=CROSS and the appropriate paths as needed.

and you need to set HEADER.  In any case, you are getting the wrong
headers.

> With the sources from r-devel, which have been changed today, I can
> generate libR.a but I cannot build a library, even with libR.a.  
> I tried building the nls library just as a test.  The errors reported
after 
> make pkg-nls are
> 
>  $ make pkg-nls

[...]

Looks like libR.a is wrong as R.exp is corrupt (probably empty). When I try
`make libR.a' on R-devel it behaves as for R-release.

The short answer is that you need R.exp, and to get that you need either to
build the whole of R (for which you need g77) or get the one in rwxxxxsp.  
What I suggest you do is to unpack rw1001 (you'll need I think the just
rw1001b? and rw1001sp zip files) and use that. The binary distribution has
the correct Makefile and supplies R.exp.  Last time I tried that
cross-compiled out of the box.

As you noted, I am in the process of changing the Makefiles and
instructions, mainly because the Cygwin release has changed and (aargh!)
not longer has a fully functional make, and the header set has also
changed.  It's a rash assumption that the R-devel or R-release-patched
will cross-compile as we only test that occasionally, including just before
release.

Brian

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Thu Apr 27 08:27:55 2000
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 27 Apr 2000 09:27:55 +0200
Subject: [Rd] Cross compiling a package for Windows on Linux
In-Reply-To: Prof Brian D Ripley's message of "Thu, 27 Apr 2000 07:30:48 +0100 (BST)"
References: <Pine.GSO.4.05.10004270708090.26167-100000@auk.stats>
Message-ID: <x24s8of1fo.fsf@blueberry.kubism.ku.dk>

Prof Brian D Ripley <ripley@stats.ox.ac.uk> writes:

> As you noted, I am in the process of changing the Makefiles and
> instructions, mainly because the Cygwin release has changed and (aargh!)
> not longer has a fully functional make, and the header set has also
> changed.  It's a rash assumption that the R-devel or R-release-patched
> will cross-compile as we only test that occasionally, including just before
> release.

It did last night, though (R-1-0-patches, that is).

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From yaacov@mscc.huji.ac.il  Thu Apr 27 11:56:54 2000
From: yaacov@mscc.huji.ac.il (jr)
Date: Thu, 27 Apr 2000 13:56:54 +0300
Subject: [Rd] R
Message-ID: <005101bfb038$02ff34c0$57058b80@ritov>

I guess there is a mistake in the function princomp (package mva).
I believe that the scores are computed wrongly under cor=TRUE condition:

Lines 42-43:

    if (scores && !missing(x))
        scr <- scale(z, center = TRUE, scale = FALSE) %*% edc$vectors

should be replaced by something like

     if (scores && !missing(x) && !cor)
        scr <- scale(z, center = TRUE, scale = FALSE) %*% edc$vectors
    if (scores && !missing(x) && cor)
        scr <- scale(z) %*% edc$vectors


Sincerely

************************************************

Ya'acov Ritov
Department of Statistics
The Hebrew University of Jerusalem,
Jerusalem 91905
Israel
Tel. (972-2) 652-9929 (Okay way)
Fax (972-2) 652-9996
http://pluto.mscc.huji.ac.il/~yaacov/jr.html
AND THIS IS ANOTHER PROOF THAT IF YOU KEEP AN OPEN MIND, SOMEBODY WILL FILL IT
WITH RUBBISH (an anonymous BBC correspondent)


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Thu Apr 27 12:08:07 2000
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 27 Apr 2000 13:08:07 +0200
Subject: [Rd] Cross compiling a package for Windows on Linux
In-Reply-To: Peter Dalgaard BSA's message of "27 Apr 2000 09:27:55 +0200"
References: <Pine.GSO.4.05.10004270708090.26167-100000@auk.stats> <x24s8of1fo.fsf@blueberry.kubism.ku.dk>
Message-ID: <x2itx3ls2w.fsf@blueberry.kubism.ku.dk>

Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk> writes:

> Prof Brian D Ripley <ripley@stats.ox.ac.uk> writes:
> 
> > As you noted, I am in the process of changing the Makefiles and
> > instructions, mainly because the Cygwin release has changed and (aargh!)
> > not longer has a fully functional make, and the header set has also
> > changed.  It's a rash assumption that the R-devel or R-release-patched
> > will cross-compile as we only test that occasionally, including just before
> > release.
> 
> It did last night, though (R-1-0-patches, that is).

..as does R-devel as of this moment.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Thu Apr 27 13:17:54 2000
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Thu, 27 Apr 2000 14:17:54 +0200 (CEST)
Subject: [Rd] options(keep.source = TRUE) -- also for "library(.)" ?
Message-ID: <14600.12274.664989.534291@lynne.ethz.ch>

       help(options)

contains

    keep.source: When `TRUE', the default, the source code for functions
	      loaded by is stored in their `"source"' attribute, allowing
	      comments to be kept in the right places.  
	      This does not apply to functions loaded by `library'.
	      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

and R behaves as documented, i.e., currently
all functions in package:base and all "interactively defined" functions
keep their source (__including__ comments) with them, whereas all the other
functions do not.

As I tend to create small own packages more and more, and ask others to use
them, users of the packages (and myself) are suffering increasingly from
function definitions with lost comments. 

Can we [those of us who know how sys.source() works...]
think of changing this?  As it was possible for the base package, it must
be doable for the others as well....

Martin
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Thu Apr 27 13:37:01 2000
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 27 Apr 2000 14:37:01 +0200
Subject: [Rd] options(keep.source = TRUE) -- also for "library(.)" ?
In-Reply-To: Martin Maechler's message of "Thu, 27 Apr 2000 14:17:54 +0200 (CEST)"
References: <14600.12274.664989.534291@lynne.ethz.ch>
Message-ID: <x2d7nblnyq.fsf@blueberry.kubism.ku.dk>

Martin Maechler <maechler@stat.math.ethz.ch> writes:

> Can we [those of us who know how sys.source() works...]
> think of changing this?  As it was possible for the base package, it must
> be doable for the others as well....

Martin, surely you could have figured out to remove these two lines
from sys.source:

    oop <- options(keep.source = FALSE)
    on.exit(options(oop))

The real question is whether we want to have a different mechanism for
controlling whether keep.source is set or not. Originally it was FALSE
for the base library to save space, and according the same setting was
used for other libraries since some of them are rather large, but
later it got flipped to TRUE for base, and then there is little point
in setting it FALSE for packages. Question is whether anyone would
want the old behaviour back to get more space for analyses?

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Thu Apr 27 14:04:03 2000
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Thu, 27 Apr 2000 15:04:03 +0200 (CEST)
Subject: [Rd] options(keep.source = TRUE) -- also for "library(.)" ?
In-Reply-To: <x2d7nblnyq.fsf@blueberry.kubism.ku.dk>
References: <14600.12274.664989.534291@lynne.ethz.ch>
 <x2d7nblnyq.fsf@blueberry.kubism.ku.dk>
Message-ID: <14600.15043.86395.259088@lynne.ethz.ch>

>>>>> "PD" == Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk> writes:

    PD> Martin Maechler <maechler@stat.math.ethz.ch> writes:
    >> Can we [those of us who know how sys.source() works...]  think of
    >> changing this?  As it was possible for the base package, it must be
    >> doable for the others as well....

    PD> Martin, surely you could have figured out to remove these two lines
    PD> from sys.source:

    PD>     oop <- options(keep.source = FALSE)
    PD>      on.exit(options(oop))

[blush... *BLUSH* ...
 I didn't look at sys.source(); 
 just knew that parts of it used to look rather "magical" to me ..
]

Of course we now could even make 
   keep.source = getOption("keep.source") 
an argument to library(), being propagated to sys.source(..).

    PD> The real question is whether we want to have a different mechanism
    PD> for controlling whether keep.source is set or not. 
right.

    PD> Originally it was FALSE for the base library to save space, and
    PD> according the same setting was used for other libraries since some
    PD> of them are rather large, but later it got flipped to TRUE for
    PD> base,
(yes, I'm still wondering...)
    PD> and then there is little point in setting it FALSE for packages. 
    PD> Question is whether anyone would want the old behaviour
    PD> back to get more space for analyses?

would be nice if it *was* configurable for base as well;
possibly both via cmd line option
	 (something like --keepsource / --no-keepsource )
and a setting in Rprofile..

>From grepping through the source code, I don't see how it was turned off
for base...

Martin

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From kjetil.kjernsmo@astro.uio.no  Thu Apr 27 14:16:10 2000
From: kjetil.kjernsmo@astro.uio.no (Kjetil Kjernsmo)
Date: Thu, 27 Apr 2000 15:16:10 +0200 (MET DST)
Subject: [Rd] Re: [R] Writing lgrindefs
In-Reply-To: <3907EA6D.6BE703BF@statistik.uni-dortmund.de>
Message-ID: <Pine.OSF.4.05.10004271508590.9815-100000@alnair.uio.no>

On Thu, 27 Apr 2000, Uwe Ligges wrote:

>> however, having all the functions defined in base highlighted as keywords.
>> Would that be a good idea, and if it is, how can I extract the function
>> names most easily?
>
>1. You get a list of objects (not only functions!!!) by typing
>    ls(env=environment("R_GlobalEnv"))
>
>2. In the html-help files, e.g. the "Functions" index could help you.
>   Attention: Not only functions are listed here!

Yeah, that's the problem with both of those, that it doesn't only contain
functions. 

>3. For my R-WinEdt "package", I extracted names of functions of many R
>packages. 
>   If you want, I will send some files.

Oh, I thought about it, but then I figured for this to work consistently,
every user would have to generate his own defs, depending on what packages
he has installed, which would be a bit bothersome I guess. 

>Maybe R-devel is the better forum to discuss this?

Perhaps, so I send this reply there, I sent the original post to r-help
because I figured it might be an easy question for most. I assume that
most of the R-devel members are on the R-help list so I do not resend my
original post. If this assumption doesn't hold, please let me know.  

Best,

Kjetil
-- 
Kjetil Kjernsmo
Graduate astronomy-student                    Problems worthy of attack
University of Oslo, Norway            Prove their worth by hitting back
E-mail: kjetikj@astro.uio.no                                - Piet Hein
Homepage <URL:http://www.astro.uio.no/~kjetikj/>
Webmaster@skepsis.no 

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Prof Brian Ripley <ripley@stats.ox.ac.uk>  Thu Apr 27 14:57:41 2000
From: Prof Brian Ripley <ripley@stats.ox.ac.uk> (Prof Brian Ripley)
Date: Thu, 27 Apr 2000 14:57:41 +0100 (BST)
Subject: [Rd] options(keep.source = TRUE) -- also for "library(.)" ?
Message-ID: <200004271357.OAA21290@toucan.stats.ox.ac.uk>

> Subject: Re: [Rd] options(keep.source = TRUE) -- also for "library(.)" ?
> From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
> Date: 27 Apr 2000 14:37:01 +0200
> 
> Martin Maechler <maechler@stat.math.ethz.ch> writes:
> 
> > Can we [those of us who know how sys.source() works...]
> > think of changing this?  As it was possible for the base package, it must
> > be doable for the others as well....
> 
> Martin, surely you could have figured out to remove these two lines
> from sys.source:
> 
>     oop <- options(keep.source = FALSE)
>     on.exit(options(oop))
> 
> The real question is whether we want to have a different mechanism for
> controlling whether keep.source is set or not. Originally it was FALSE
> for the base library to save space, and according the same setting was
> used for other libraries since some of them are rather large, but
> later it got flipped to TRUE for base, and then there is little point
> in setting it FALSE for packages. Question is whether anyone would
> want the old behaviour back to get more space for analyses?

Yes, but really I would rather have packages stored in separate
workspaces that the garabage collector avoided. Then space is less of
an issue.  Ross I know suggested that, but I don't think anyone
is working on it.

My guess would be that we will not have any space/gc improvements
ready for 1.1, unless Luke's things are close. (BTW, Luke, is your
changed code available?  I went to think about doing some timings the
other night and realized that I thought not. A cvs branch might be good(ish)
way to let us play with it.)

Brian

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Friedrich.Leisch@ci.tuwien.ac.at  Thu Apr 27 15:09:00 2000
From: Friedrich.Leisch@ci.tuwien.ac.at (Friedrich Leisch)
Date: Thu, 27 Apr 2000 16:09:00 +0200 (CEST)
Subject: [Rd] Re: [R] Writing lgrindefs
In-Reply-To: <Pine.OSF.4.05.10004271508590.9815-100000@alnair.uio.no>
References: <3907EA6D.6BE703BF@statistik.uni-dortmund.de>
 <Pine.OSF.4.05.10004271508590.9815-100000@alnair.uio.no>
Message-ID: <14600.18940.551062.659955@galadriel.ci.tuwien.ac.at>

>>>>> On Thu, 27 Apr 2000 15:16:10 +0200 (MET DST),
>>>>> Kjetil Kjernsmo (KK) wrote:

KK> On Thu, 27 Apr 2000, Uwe Ligges wrote:
>>> however, having all the functions defined in base highlighted as keywords.
>>> Would that be a good idea, and if it is, how can I extract the function
>>> names most easily?
>> 
>> 1. You get a list of objects (not only functions!!!) by typing
>> ls(env=environment("R_GlobalEnv"))
>> 
>> 2. In the html-help files, e.g. the "Functions" index could help you.
>> Attention: Not only functions are listed here!


Finding out what is a function and what not is easy:

R> x<- ls("package:base")
R> x[40]
[1] ".lib.loc"
R> x[140]
[1] "anovalist.lm"

where the first is a vector and the second a function, which can
easily be traced:

R> sapply(x[c(40,140)],function(y){is.function(get(y))})
    .lib.loc anovalist.lm 
       FALSE         TRUE 

(don't know if this is the most elegant way of doing it). This leaves
all operators in the list as they are only functions allowing a
special syntax, hence if you want only ordinary functions, you could
simply discard those not starting with a dot or a letter.

Hope this helps,
Fritz

-- 
-------------------------------------------------------------------
                        Friedrich  Leisch 
Institut für Statistik                     Tel: (+43 1) 58801 10715
Technische Universität Wien                Fax: (+43 1) 58801 10798
Wiedner Hauptstraße 8-10/1071      Friedrich.Leisch@ci.tuwien.ac.at
A-1040 Wien, Austria             http://www.ci.tuwien.ac.at/~leisch
     PGP public key http://www.ci.tuwien.ac.at/~leisch/pgp.key
-------------------------------------------------------------------

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Friedrich.Leisch@ci.tuwien.ac.at  Thu Apr 27 15:42:05 2000
From: Friedrich.Leisch@ci.tuwien.ac.at (Friedrich Leisch)
Date: Thu, 27 Apr 2000 16:42:05 +0200 (CEST)
Subject: [Rd] Re: [R] Writing lgrindefs
In-Reply-To: <14600.18940.551062.659955@galadriel.ci.tuwien.ac.at>
References: <3907EA6D.6BE703BF@statistik.uni-dortmund.de>
 <Pine.OSF.4.05.10004271508590.9815-100000@alnair.uio.no>
 <14600.18940.551062.659955@galadriel.ci.tuwien.ac.at>
Message-ID: <14600.20925.394876.538432@galadriel.ci.tuwien.ac.at>

>>>>> On Thu, 27 Apr 2000 16:09:00 +0200 (CEST),
>>>>> Friedrich Leisch (FL) wrote:

>>>>> On Thu, 27 Apr 2000 15:16:10 +0200 (MET DST),
>>>>> Kjetil Kjernsmo (KK) wrote:

KK> On Thu, 27 Apr 2000, Uwe Ligges wrote:
>>>> however, having all the functions defined in base highlighted as keywords.
>>>> Would that be a good idea, and if it is, how can I extract the function
>>>> names most easily?
>>> 
>>> 1. You get a list of objects (not only functions!!!) by typing
>>> ls(env=environment("R_GlobalEnv"))
>>> 
>>> 2. In the html-help files, e.g. the "Functions" index could help you.
>>> Attention: Not only functions are listed here!


FL> Finding out what is a function and what not is easy:

R> x<- ls("package:base")

sorry, forgot the all=TRUE here ...

.f
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ligges@statistik.uni-dortmund.de  Thu Apr 27 16:47:54 2000
From: ligges@statistik.uni-dortmund.de (Uwe Ligges)
Date: Thu, 27 Apr 2000 17:47:54 +0200
Subject: [Rd] Writing lgrindefs
References: <Pine.OSF.4.05.10004271508590.9815-100000@alnair.uio.no>
Message-ID: <3908612A.95CC5F8F@statistik.uni-dortmund.de>

> >> however, having all the functions defined in base highlighted as keywords.
> >> Would that be a good idea, and if it is, how can I extract the function
> >> names most easily?
> >
> >1. You get a list of objects (not only functions!!!) by typing
> >    ls(env=environment("R_GlobalEnv"))
> >
> >2. In the html-help files, e.g. the "Functions" index could help you.
> >   Attention: Not only functions are listed here!
> 
> Yeah, that's the problem with both of those, that it doesn't only contain
> functions.
> 
> >3. For my R-WinEdt "package", I extracted names of functions of many R
> >packages.
> >   If you want, I will send some files.
> 
> Oh, I thought about it, but then I figured for this to work consistently,
> every user would have to generate his own defs, depending on what packages
> he has installed, which would be a bit bothersome I guess.

OK. Fritz has got it! And I feel stupid...

After thinking:
Only functions of the base package are not enough for some users,
on the other hand you will never be up to date with names of all
functions of all packages, I suppose.
Of course TeX cannot know names of R functions, if they are not
specified explicitly.

Suggestions:
1)
Another way is to write a R function, that generates "nice" TeX code.
Or a R function, that generates code to be interpreted by a TeX macro.
Such a function would know about loaded packages and their functions,
user specific functions, other objects in the users environment (as
needed).

2)
Providing names of functions of the most used packages (e.g. base,
ctest, ts, ...) would be enough, if the user could easily extend the
list of "known" functions (or other objects).
I think about a TeX command (defined in your macro), that could be used
as follows:
 \addrfunctionnames{myfunc1, myfunc2, myfunc3}


But maybe there are much better ideas?

Regards,
Uwe Ligges
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Prof Brian Ripley <ripley@stats.ox.ac.uk>  Thu Apr 27 17:00:30 2000
From: Prof Brian Ripley <ripley@stats.ox.ac.uk> (Prof Brian Ripley)
Date: Thu, 27 Apr 2000 17:00:30 +0100 (BST)
Subject: [Rd] Cross compiling a package for Windows on Linux
Message-ID: <200004271600.RAA21782@toucan.stats.ox.ac.uk>

> From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
> Date: 27 Apr 2000 13:08:07 +0200
> 
> Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk> writes:
> 
> > Prof Brian D Ripley <ripley@stats.ox.ac.uk> writes:
> > 
> > > As you noted, I am in the process of changing the Makefiles and
> > > instructions, mainly because the Cygwin release has changed and (aargh!)
> > > not longer has a fully functional make, and the header set has also
> > > changed.  It's a rash assumption that the R-devel or R-release-patched
> > > will cross-compile as we only test that occasionally, including just 
before
> > > release.
> > 
> > It did last night, though (R-1-0-patches, that is).
> 
> ..as does R-devel as of this moment.

Indeed it does.  To make life a bit easier I have put up a complete
current cross-tools set with the latest headers at

http://www.stats.ox.ac.uk/pub/bdr/RWin/i386cross.tar.bz2  (ca 5Mb)

Just unpack it somewhere, put the bin directory in your path and
follow the instructions in INSTALL.

The caveat remains, though: this is not tested frequently.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From thomas@biostat.washington.edu  Thu Apr 27 20:00:23 2000
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Thu, 27 Apr 2000 12:00:23 -0700 (PDT)
Subject: [Rd] gcinfo/R_alloc inconsistency
In-Reply-To: <200004271357.OAA21290@toucan.stats.ox.ac.uk>
Message-ID: <Pine.GSO.4.21.0004271154550.28220-100000@mail.biostat.washington.edu>


gcinfo reports the amount of remaining heap using
	vcells = R_VSize - (R_VTop - R_VHeap);

but R_alloc tests
        if (R_VMax - R_VTop < size)
		mem_err_heap(size);


This means that you can get an out of memory error when gcinfo insists
there are vast amounts of memory left.


	-thomas

Thomas Lumley
Assistant Professor, Biostatistics
University of Washington, Seattle

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From bates@stat.wisc.edu  Thu Apr 27 23:25:40 2000
From: bates@stat.wisc.edu (Douglas Bates)
Date: 27 Apr 2000 17:25:40 -0500
Subject: [Rd] Cross compiling a package for Windows on Linux
In-Reply-To: Prof Brian Ripley's message of "Thu, 27 Apr 2000 17:00:30 +0100 (BST)"
References: <200004271600.RAA21782@toucan.stats.ox.ac.uk>
Message-ID: <6raeiftc4b.fsf@franz.stat.wisc.edu>

Prof Brian Ripley <ripley@stats.ox.ac.uk> writes:

> > From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
> > Date: 27 Apr 2000 13:08:07 +0200
> > 
> > Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk> writes:
> > 
> > > Prof Brian D Ripley <ripley@stats.ox.ac.uk> writes:
> > > 
> > > > As you noted, I am in the process of changing the Makefiles and
> > > > instructions, mainly because the Cygwin release has changed and (aargh!)
> > > > not longer has a fully functional make, and the header set has also
> > > > changed.  It's a rash assumption that the R-devel or R-release-patched
> > > > will cross-compile as we only test that occasionally, including just 
> before
> > > > release.
> > > 
> > > It did last night, though (R-1-0-patches, that is).
> > 
> > ..as does R-devel as of this moment.
> 
> Indeed it does.  To make life a bit easier I have put up a complete
> current cross-tools set with the latest headers at
> 
> http://www.stats.ox.ac.uk/pub/bdr/RWin/i386cross.tar.bz2  (ca 5Mb)
> 
> Just unpack it somewhere, put the bin directory in your path and
> follow the instructions in INSTALL.
> 
> The caveat remains, though: this is not tested frequently.

That worked nicely, thanks.

I did have to make two additional modifications to the Makefile to
drop the --number-pages and the --html flags in calls to makeinfo.  My
version of makeinfo did not accept those flags.

I will have to check at home this evening if the compilation of my
library was successful.  I am optimistic.

This is a very useful facility.

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Fri Apr 28 07:18:49 2000
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Fri, 28 Apr 2000 07:18:49 +0100 (BST)
Subject: [Rd] Cross compiling a package for Windows on Linux
In-Reply-To: <6raeiftc4b.fsf@franz.stat.wisc.edu>
Message-ID: <Pine.GSO.4.05.10004280713150.26961-100000@auk.stats>

On 27 Apr 2000, Douglas Bates wrote:

> Prof Brian Ripley <ripley@stats.ox.ac.uk> writes:
> 
> > > From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
> > > Date: 27 Apr 2000 13:08:07 +0200
> > > 
> > > Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk> writes:
> > > 
> > > > Prof Brian D Ripley <ripley@stats.ox.ac.uk> writes:
> > > > 
> > > > > As you noted, I am in the process of changing the Makefiles and
> > > > > instructions, mainly because the Cygwin release has changed and (aargh!)
> > > > > not longer has a fully functional make, and the header set has also
> > > > > changed.  It's a rash assumption that the R-devel or R-release-patched
> > > > > will cross-compile as we only test that occasionally, including just 
> > before
> > > > > release.
> > > > 
> > > > It did last night, though (R-1-0-patches, that is).
> > > 
> > > ..as does R-devel as of this moment.
> > 
> > Indeed it does.  To make life a bit easier I have put up a complete
> > current cross-tools set with the latest headers at
> > 
> > http://www.stats.ox.ac.uk/pub/bdr/RWin/i386cross.tar.bz2  (ca 5Mb)
> > 
> > Just unpack it somewhere, put the bin directory in your path and
> > follow the instructions in INSTALL.
> > 
> > The caveat remains, though: this is not tested frequently.
> 
> That worked nicely, thanks.
> 
> I did have to make two additional modifications to the Makefile to
> drop the --number-pages and the --html flags in calls to makeinfo.  My
> version of makeinfo did not accept those flags.

Yes, you need makeinfo 4.0 (as you do for R on Unix), and without those
flags you will get the wrong answers.  Actually, this step should not be
necessary: it happens because cvs updates files with the update date, not
the creation date. The same thing happens with configure and configure.in
not infrequently.  So `touch rw-faq fixed/r/rw-FAQ.html' is all that is
needed.


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Apr 28 09:26:47 2000
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 28 Apr 2000 10:26:47 +0200 (CEST)
Subject: [Rd] options(keep.source = TRUE) -- also for "library(.)" ?
In-Reply-To: <14600.15043.86395.259088@lynne.ethz.ch>
References: <14600.12274.664989.534291@lynne.ethz.ch>
 <x2d7nblnyq.fsf@blueberry.kubism.ku.dk>
 <14600.15043.86395.259088@lynne.ethz.ch>
Message-ID: <14601.19271.866855.581704@lynne.ethz.ch>

>>>>> "MM" == Martin Maechler <maechler@stat.math.ethz.ch> writes:

(and I haven't seen more feedback..)

>>>>> "PD" == Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk> writes:
     PD> Martin Maechler <maechler@stat.math.ethz.ch> writes:

	>>> Can we [those of us who know how sys.source() works...]  think of
	>>> changing this?  As it was possible for the base package, it must be
	>>> doable for the others as well....

     PD> Martin, surely you could have figured out to remove these two lines
     PD> from sys.source:

     PD> oop <- options(keep.source = FALSE)
     PD> on.exit(options(oop))

    MM> [blush... *BLUSH* ...
    MM> I didn't look at sys.source(); 
    MM> just knew that parts of it used to look rather "magical" to me ..
    MM> ]

    MM> Of course we now could even make 
    MM> keep.source = getOption("keep.source") 
    MM> an argument to library(), being propagated to sys.source(..).

I'm considering to commit the necessary changes and add the following to
NEWS [for "R-devel"]

    o	library(), require(), and sys.source() have a new argument
	` keep.source = getOption("keep.source") '.
	Hence, by default, functions from all packages (not just base)
	`keep their source'.

Is this okay for everyone ?


     PD> The real question is whether we want to have a different mechanism
     PD> for controlling whether keep.source is set or not. 

    MM> right.

      PD> Originally it was FALSE for the base library to save space, and
      PD> according the same setting was used for other libraries since some
      PD> of them are rather large, but later it got flipped to TRUE for
      PD> base,
    MM> (yes, I'm still wondering...)
      PD> and then there is little point in setting it FALSE for packages. 
      PD> Question is whether anyone would want the old behaviour
      PD> back to get more space for analyses?

    MM> would be nice if it *was* configurable for base as well;
    MM> possibly both via cmd line option
    MM> (something like --keepsource / --no-keepsource )
    MM> and a setting in Rprofile..

    >> From grepping through the source code, I don't see how it was turned off
    MM> for base...

anyone [R-core] ?

Martin Maechler <maechler@stat.math.ethz.ch>	http://stat.ethz.ch/~maechler/
Seminar fuer Statistik, ETH-Zentrum  LEO D10	Leonhardstr. 27
ETH (Federal Inst. Technology)	8092 Zurich	SWITZERLAND
phone: x-41-1-632-3408		fax: ...-1228			<><
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Craig.Mckinstry@pnl.gov  Fri Apr 28 16:36:37 2000
From: Craig.Mckinstry@pnl.gov (Craig.Mckinstry@pnl.gov)
Date: Fri, 28 Apr 2000 17:36:37 +0200 (MET DST)
Subject: [Rd] graphics: par(mfg=c(i,j,r,c)) (PR#529)
Message-ID: <200004281536.RAA21899@pubhealth.ku.dk>

Full_Name: Craig A. McKinstry
Version: 1.0.0
OS: WinNT4.0 and Win98
Submission from: (NULL) (192.101.100.130)


When creating a multi-panel graphic, the command par(mfg=c(i,j,r,c)) is
supposed
to allow the user free movement between graphics panels to develop each panel 
separately. This works for the first invocation of par(mfg=c()) and for the 
first panel panel specified, but not for subsequent calls to the other panels. 

Coded example:

x_1:20
y_1:20
#these 5 commands produce a 2x2 panel plot
par(mfrow=c(2,2))
plot(x,y)
plot(x,y)
plot(x,y)
plot(x,y)

#the following 2 commands successfully added the text 'panel[2,1]' to
panel[2,1]
par(mfg=c(2,1,2,2))
text(10,10,'panel[2,1]')

#None of the following 3 command-pairs produced their intended results for the
other
# 3 panels
par(mfg=c(1,2,2,2))
text(10,10,'panel[1,2]')

par(mfg=c(1,1,2,2))
text(10,10,'panel[1,1]')

par(mfg=c(2,2,2,2))
text(10,10,'panel[2,2]')

#However, the following command-pair did as intended on the first panel
specified
# by mfg=c(2,1,2,2) above
par(mfg=c(2,1,2,2))
text(15,15,'panel[2,2]')

#Running this in S-plus 4.0 produced the intended results


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Fri Apr 28 16:58:29 2000
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 28 Apr 2000 17:58:29 +0200
Subject: [Rd] graphics: par(mfg=c(i,j,r,c)) (PR#529)
In-Reply-To: Craig.Mckinstry@pnl.gov's message of "Fri, 28 Apr 2000 17:36:37 +0200 (MET DST)"
References: <200004281536.RAA21899@pubhealth.ku.dk>
Message-ID: <x28zxyw72y.fsf@blueberry.kubism.ku.dk>

Craig.Mckinstry@pnl.gov writes:

> x_1:20
> y_1:20
> #these 5 commands produce a 2x2 panel plot
> par(mfrow=c(2,2))
> plot(x,y)
> plot(x,y)
> plot(x,y)
> plot(x,y)
> 
> #the following 2 commands successfully added the text 'panel[2,1]' to
> panel[2,1]
> par(mfg=c(2,1,2,2))
> text(10,10,'panel[2,1]')
> 
> #None of the following 3 command-pairs produced their intended results for the
> other
> # 3 panels
> par(mfg=c(1,2,2,2))
> text(10,10,'panel[1,2]')
> 
> par(mfg=c(1,1,2,2))
> text(10,10,'panel[1,1]')
> 
> par(mfg=c(2,2,2,2))
> text(10,10,'panel[2,2]')
> 
> #However, the following command-pair did as intended on the first panel
> specified
> # by mfg=c(2,1,2,2) above
> par(mfg=c(2,1,2,2))
> text(15,15,'panel[2,2]')

Same thing happens on Linux. Might be something with restoring the
coordinate transformations. Using

par(mfg=c(1,1,2,2))
plot(x,y)
text(10,10,'panel[1,1]')

*does* seem to work.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Fri Apr 28 17:02:00 2000
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Fri, 28 Apr 2000 12:02:00 -0400
Subject: [Rd] Rd files with multiple functions?
Message-ID: <3909B5F8.70004B7@bank-banque-canada.ca>

There was at one time some discussion about supporting documentation of multiple
functions in one Rd file. Is that supported or still in the plans?

Paul Gilbert

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Apr 28 17:19:50 2000
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 28 Apr 2000 18:19:50 +0200 (CEST)
Subject: [Rd] options(keep.source = TRUE) -- also for "library(.)" ?
In-Reply-To: <14601.19271.866855.581704@lynne.ethz.ch>
References: <14600.12274.664989.534291@lynne.ethz.ch>
 <x2d7nblnyq.fsf@blueberry.kubism.ku.dk>
 <14600.15043.86395.259088@lynne.ethz.ch>
 <14601.19271.866855.581704@lynne.ethz.ch>
Message-ID: <14601.47654.736464.353659@lynne.ethz.ch>

I'm replying to myself once more :

[and this gets more and more envolved, please "d" if you're not interested ..]

>>>>> "MM" == Martin Maechler <maechler@stat.math.ethz.ch> writes:

    MM> (and I haven't seen more feedback..)

>>>>> "PD" == Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk> writes:

      ........

    MM> Of course we now could even make 
    MM>	   keep.source = getOption("keep.source") 
    MM> an argument to library(), being propagated to sys.source(..).

 MM>   I'm considering to commit the necessary changes and add the following to
 MM>    NEWS [for "R-devel"]
 MM> 
 MM>    o	library(), require(), and sys.source() have a new argument
 MM> 	` keep.source = getOption("keep.source") '.
 MM> 
 MM>   Hence, by default, functions from all packages (not just base)
 MM>   `keep their source'.
 MM> 
 MM>   Is this okay for everyone ?

Now, I still haven't committed the new code, but I have been using it
myself and made a "big picture statistic" *using* the new code, and gc()
for many packages (actually I've done this for all CRAN packages and more)
to find  how much memory is "spilled" by   keep.source = TRUE.

Here are the results :

I show the difference in memory usage {Vcells & Ncells, see ?gc & ?Memory}
for interesting packages, only using R builtin and CRAN (non-Devel) packages:

   Package    Bytes used
	      additionally with   Ncells  Vcells
	      keep.source= TRUE                 
				                
   nlme       2305'364             19023  107659   (actually  nlme + nls)
   survival5  1066'776		   8867    49792
   MASS        631'628		   5186    29507
   mclust      493'512		   4349    22936
   boot        456'944		   3833    21314
   ctest       309'288		   2406    14502
   ts          297'368		   2311    13944
   cluster     244'120		   2270    11298
   nls         236'668		   1871    11085
   wavethresh  218'624		   1878    10180
   mda         215'944		   1878    10046
   rpart       203'892		   1654     9533
   chron       194'640		   1735     9038
   tseries     183'360		   1505     8566
   locfit      176'416		   1632     8168
   tree        166'844		   1248     7843
   modreg      116'752		    989     5442
   nnet         98'124		    838     4571
   splines      85'112		    769     3948
   mva          79'280		    710     3680
   lqs          34'116		    292     1589
   eda          10'860		    105      501
   zmatrix       7'196		     82      327
   Devore5           0		      0        0  [took this to "test"

I.e., for the nlme() one needs an extra 2.3 MBytes of memory just for
"keep.source = TRUE".

I further investigated a bit how much the "keep.source" of base ``costs''
memory wise.
Note that I still don't know how to turn it off easily for base (Peter ?).

However, I just counted how much "source" is in base :
  > length(ob <- ls(pos= match("package:base",search()), all.nam = TRUE))
  [1] 1193
  > length(fns <- ob[sapply(ob, function(n)is.function(get(n)))])
  [1] 1169
  > stem(len.src <- sapply(fns, function(n)sum(nchar(attr(get(n),"source")))))

   The decimal point is 3 digit(s) to the right of the |
  
    0 | 00000000000000000000000000000000000000000000000000000000000000000000+980
    1 | 00000000000112222233333333334444555555666667777778888899
    2 | 00000012333334444555556666777788899
    3 | 12234477
    4 | 15669
    5 | 34
    6 | 
    7 | 35
    8 | 
    9 | 
   10 | 2
		(guess *which* is the  outlier  ;-)

  > sum(len.src)
  [1] 359964

i.e., only ~360'000 characters.

Now compare this with  survival5 which was scoring pretty high above :

  > library(survival5, keep.source = TRUE)
  > length(ob <- ls(pos= match("package:survival5",search()), all.nam = TRUE))
  [1] 117
  > length(fns <- ob[sapply(ob, function(n)is.function(get(n)))])
  [1] 116
  > stem(len.src <- sapply(fns, function(n)sum(nchar(attr(get(n),"source")))))

    The decimal point is 3 digit(s) to the right of the |

     0 | 00000000011111111111111112222222233344444455555789
     1 | 0001122334445567777899
     2 | 0001134555555789
     3 | 02233445567
     4 | 12368
     5 | 2478
     6 | 14799
     7 | 
     8 | 0
     9 | 
    10 | 
    11 | 
    12 | 
    13 | 
    14 | 
    15 | 4
    16 | 
    17 | 3

  > sum(len.src)
  [1] 235633

i.e.  about 2/3 of "base".

(but then base has "source" attributes for much more objects)
Very crude extrapolation would mean that turning off the "keep.source" for
"base" would save about 1.5 MBytes of RAM {I'd guess even more..}

After all this testing, I think what we really want is
"keep.source = FALSE" (including for "base" !)
WHEN working with large data, working on smallish machines,
    or for all "batch" processing.

Hence I'd propose

1.  
  options(keep.source = interactive())

  in the default profile

2. {as proposed earlier today -- see below}

  provide a command line option to turn it on or off.
------------

    PD> The real question is whether we want to have a different mechanism
    PD> for controlling whether keep.source is set or not. 

    MM> right.

    PD> Originally it was FALSE for the base library to save space, and
    PD> according the same setting was used for other libraries since some
    PD> of them are rather large, but later it got flipped to TRUE for
    PD> base,
    MM> (yes, I'm still wondering...)
    PD> and then there is little point in setting it FALSE for packages. 
    PD> Question is whether anyone would want the old behaviour
    PD> back to get more space for analyses?

  would be nice if it *was* configurable for base as well;
  possibly both via cmd line option
  (something like --keepsource / --no-keepsource )
  and a setting in Rprofile..

  MM> From grepping through the source code, I don't see how it was turned off
  MM> for base...

 anyone [R-core] ?

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Apr 28 17:23:51 2000
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 28 Apr 2000 18:23:51 +0200 (CEST)
Subject: [Rd] Rd files with multiple functions?
In-Reply-To: <3909B5F8.70004B7@bank-banque-canada.ca>
References: <3909B5F8.70004B7@bank-banque-canada.ca>
Message-ID: <14601.47895.555375.853908@lynne.ethz.ch>

>>>>> "PaulG" == Paul Gilbert <pgilbert@bank-banque-canada.ca> writes:

    PaulG> There was at one time some discussion about supporting
    PaulG> documentation of multiple functions in one Rd file. Is that
    PaulG> supported or still in the plans?

This "happens all the time". 
It's even recommended in some cases (however people `fight' *which* cases ..). 

Just make sure to have an \alias{} *and* a usage line (but just one
\usage{}) for each function.  
For an example, see      src/library/base/man/lm.Rd

Martin
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Fri Apr 28 17:51:37 2000
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Fri, 28 Apr 2000 12:51:37 -0400
Subject: [Rd] Rd files with multiple functions?
References: <3909B5F8.70004B7@bank-banque-canada.ca> <14601.47895.555375.853908@lynne.ethz.ch>
Message-ID: <3909C199.AF669A43@bank-banque-canada.ca>

>This "happens all the time".
>It's even recommended in some cases (however people `fight' *which* cases ..).
...
>For an example, see      src/library/base/man/lm.Rd

In my version of R src/library/base/man/lm.Rd just has one \name{}  with
multiple \alias{}s.
What I meant was truely different functions (all the functions in a package) so
there would be multiple \name{} lines in the file. Is that possible?

>Just make sure to have an \alias{} *and* a usage line (but just one
>\usage{}) for each function.

BTW
As of yesterday's R-devel snapshot Kurt fixed R CMD build to check for just one
usage, which is a nice feature.

Paul Gilbert

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Prof Brian Ripley <ripley@stats.ox.ac.uk>  Fri Apr 28 17:57:58 2000
From: Prof Brian Ripley <ripley@stats.ox.ac.uk> (Prof Brian Ripley)
Date: Fri, 28 Apr 2000 17:57:58 +0100 (BST)
Subject: [Rd] Rd files with multiple functions?
Message-ID: <200004281657.RAA01123@toucan.stats.ox.ac.uk>


> Date: Fri, 28 Apr 2000 12:51:37 -0400
> From: Paul Gilbert <pgilbert@bank-banque-canada.ca>
> To: Martin Maechler <maechler@stat.math.ethz.ch>, Douglas Bates 
<bates@stat.wisc.edu>
> CC: R-devel <R-devel@stat.math.ethz.ch>
> Subject: Re: [Rd] Rd files with multiple functions?
> 
> >This "happens all the time".
> >It's even recommended in some cases (however people `fight' *which* cases 
..).
> ...
> >For an example, see      src/library/base/man/lm.Rd
> 
> In my version of R src/library/base/man/lm.Rd just has one \name{}  with
> multiple \alias{}s.
> What I meant was truely different functions (all the functions in a package) 
so
> there would be multiple \name{} lines in the file. Is that possible?

No, the \name is the name of the *file*, the \alias'es are the names
of the objects.

Use \name for a topic, that is the package name in your example. See
e.g. Poisson.Rd that has \name{Poisson}, but there is no function
Poisson(), and the functions are named as \alias{}es

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Fri Apr 28 18:17:54 2000
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Fri, 28 Apr 2000 19:17:54 +0200 (CEST)
Subject: [Rd] options(keep.source = TRUE) -- also for "library(.)" ?
In-Reply-To: <14601.47654.736464.353659@lynne.ethz.ch>
References: <14600.12274.664989.534291@lynne.ethz.ch>
 <x2d7nblnyq.fsf@blueberry.kubism.ku.dk>
 <14600.15043.86395.259088@lynne.ethz.ch>
 <14601.19271.866855.581704@lynne.ethz.ch>
 <14601.47654.736464.353659@lynne.ethz.ch>
Message-ID: <14601.51138.245606.306428@aragorn.ci.tuwien.ac.at>

>>>>> Martin Maechler writes:

> I'm replying to myself once more : [and this gets more and more
> envolved, please "d" if you're not interested ..]

> ...

> After all this testing, I think what we really want is "keep.source =
> FALSE" (including for "base" !)  WHEN working with large data, working
> on smallish machines, or for all "batch" processing.

> Hence I'd propose

> 1.  
>   options(keep.source = interactive())

>   in the default profile

> 2. {as proposed earlier today -- see below}

>   provide a command line option to turn it on or off.

I am not sure whether we really want a command line option.  I'd say we
should keep things as simple as possible.

-k

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Apr 28 18:24:55 2000
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 28 Apr 2000 19:24:55 +0200 (CEST)
Subject: [Rd] "keep.source" changes committed to R-devel
In-Reply-To: <14601.47654.736464.353659@lynne.ethz.ch>
References: <14600.12274.664989.534291@lynne.ethz.ch>
 <x2d7nblnyq.fsf@blueberry.kubism.ku.dk>
 <14600.15043.86395.259088@lynne.ethz.ch>
 <14601.19271.866855.581704@lynne.ethz.ch>
 <14601.47654.736464.353659@lynne.ethz.ch>
Message-ID: <14601.51559.135470.386006@lynne.ethz.ch>

These are the NEWS entries

    o	library(), require(), and sys.source() have a new argument
	` keep.source = getOption("keep.source") '.
	Hence, by default, functions from all packages (not just base)
	`keep their source'

    o	The "keep.source" option now defaults to interactive() instead of TRUE.


Note that this (the 2nd one!) speeded up  "make check" a bit (about 1-2 %).

What is *not* yet working is
     "keep.source = FALSE  having an effect on the functions in base.

Martin

PS:
 to get this latest "R-devel snapshot", either 
 use "rsync" (used to be updated hourly), or anonymous "cvs" (updated daily
 to cvs.r-project.org
 or FTP in about 8 hours from  ftp://stat.ethz.ch/Software/R/R-devel.tar.gz
 or get it from the CRAN mirrors  a few more hours later ...)
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Fri Apr 28 18:40:46 2000
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Fri, 28 Apr 2000 13:40:46 -0400
Subject: [Rd] Rd files with multiple functions?
References: <200004281657.RAA01123@toucan.stats.ox.ac.uk>
Message-ID: <3909CD1D.25E3A964@bank-banque-canada.ca>

I guess I'm using the wrong terminology, and also getting confused because \name
seems to mean both "topic" and "file".

Let me ask the broader question. What I would like to do is keep all my
documentation for a package in one file because this makes searching and editing
simpler (in the same way that I keep all the code in one .R file). I still end
up with a fairly large number of files since there are many packages involved,
but it's only a dozen or so, not hundreds. What I have been doing is keeping it
this way and then using a script to parse the file into multiple .Rd files which
I put in the man directory. Each of these files is a topic and has one \name
line. My question is: Is it still necessary for me to parse the file, or is that
being supported by R now?

Thanks,
Paul Gilbert

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From kjetil.kjernsmo@astro.uio.no  Fri Apr 28 19:07:30 2000
From: kjetil.kjernsmo@astro.uio.no (Kjetil Kjernsmo)
Date: Fri, 28 Apr 2000 20:07:30 +0200 (MET DST)
Subject: [Rd] Writing lgrindefs
In-Reply-To: <3908612A.95CC5F8F@statistik.uni-dortmund.de>
Message-ID: <Pine.OSF.4.05.10004282004340.11560-100000@rukbat.uio.no>

On Thu, 27 Apr 2000, Uwe Ligges wrote:

>Suggestions:
>1)
>Another way is to write a R function, that generates "nice" TeX code.
>Or a R function, that generates code to be interpreted by a TeX macro.
>Such a function would know about loaded packages and their functions,
>user specific functions, other objects in the users environment (as
>needed).
>
>2)
>Providing names of functions of the most used packages (e.g. base,
>ctest, ts, ...) would be enough, if the user could easily extend the
>list of "known" functions (or other objects).
>I think about a TeX command (defined in your macro), that could be used
>as follows:
> \addrfunctionnames{myfunc1, myfunc2, myfunc3}

Both your suggestions are interesting, and should receive some attention I
guess. The good thing about lgrind is that it is in fairly common use, and
that definitions for many languages allready exist. When the time of
generating LaTeX code for my thesis approaches, I think I'll try to find a
newsgroup and ask about a few details.

Best,

Kjetil
-- 
Kjetil Kjernsmo
Graduate astronomy-student                    Problems worthy of attack
University of Oslo, Norway            Prove their worth by hitting back
E-mail: kjetikj@astro.uio.no                                - Piet Hein
Homepage <URL:http://www.astro.uio.no/~kjetikj/>
Webmaster@skepsis.no 

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Sun Apr 30 16:40:26 2000
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Sun, 30 Apr 2000 17:40:26 +0200 (CEST)
Subject: [Rd] Rd files with multiple functions?
In-Reply-To: <3909CD1D.25E3A964@bank-banque-canada.ca>
References: <200004281657.RAA01123@toucan.stats.ox.ac.uk>
 <3909CD1D.25E3A964@bank-banque-canada.ca>
Message-ID: <14604.21482.220633.89296@aragorn.ci.tuwien.ac.at>

>>>>> Paul Gilbert writes:

> I guess I'm using the wrong terminology, and also getting confused
> because \name seems to mean both "topic" and "file".

> Let me ask the broader question. What I would like to do is keep all
> my documentation for a package in one file because this makes
> searching and editing simpler (in the same way that I keep all the
> code in one .R file). I still end up with a fairly large number of
> files since there are many packages involved, but it's only a dozen or
> so, not hundreds. What I have been doing is keeping it this way and
> then using a script to parse the file into multiple .Rd files which I
> put in the man directory. Each of these files is a topic and has one
> \name line. My question is: Is it still necessary for me to parse the
> file, or is that being supported by R now?

It is not supported.

Re terminology. `topic' is really anything that documentation is given
for (such as an R object, a concept, etc ...).  That's also why the
argument in help() is called `topic'.  One declares the topics a file
(documentation object) provides documentation for using the \alias
statements (which maybe should be called \topic then ...)

(So, `each of these files is a topic' may be misleading ...)

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From kjetikj@astro.uio.no  Sun Apr 30 20:01:04 2000
From: kjetikj@astro.uio.no (kjetikj@astro.uio.no)
Date: Sun, 30 Apr 2000 21:01:04 +0200 (MET DST)
Subject: [Rd] rpois hangs (PR#530)
Message-ID: <200004301901.VAA28610@pubhealth.ku.dk>

Full_Name: Kjetil Kjernsmo
Version: Version 1.0.0
OS: osf1
Submission from: (NULL) (129.240.28.227)


Dear all,

I have come across another really strange bug in rpois.
If I do
> rpois(1, 1000000 * rpois(1, 10000))
sometimes it hangs, and hangs...
On my XP1000 alphaev6 workstation, it seems to happen more 
frequently than on other machines. I started a session on an older 
computer, and from the start, it looks like this:
> rpois(1, 1000000 * rpois(1, 10000))
[1] 1537190728
> ^[[A
Error: syntax error [whoops, I'm usually using ESS]
> rpois(1, 1000000 * rpois(1, 10000))
[1] 1507263999
> rpois(1000, 1000000 * rpois(1000, 10000))          
[hanged here, killed with ^C]

> rpois(1, 1000000 * rpois(1, 10000))
[1] 1463075843
> rpois(1, 1000000 * rpois(1, 10000))
[1] 1438068697
> rpois(1, 1000000 * rpois(1, 10000))
[hanging]

I think this is strange, because I've been doing this stuff 
a lot lately, but usually with a rather small parameter to the 
second rpois.  

Kjetil

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Sun Apr 30 20:41:36 2000
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 30 Apr 2000 21:41:36 +0200
Subject: [Rd] rpois hangs (PR#530)
In-Reply-To: kjetikj@astro.uio.no's message of "Sun, 30 Apr 2000 21:01:04 +0200 (MET DST)"
References: <200004301901.VAA28610@pubhealth.ku.dk>
Message-ID: <x2ya5vcr67.fsf@blueberry.kubism.ku.dk>

kjetikj@astro.uio.no writes:

> I have come across another really strange bug in rpois.
> If I do
> > rpois(1, 1000000 * rpois(1, 10000))
> sometimes it hangs, and hangs...
> On my XP1000 alphaev6 workstation, it seems to happen more 
> frequently than on other machines. I started a session on an older 
........
> > rpois(1, 1000000 * rpois(1, 10000))
> [hanging]
> 
> I think this is strange, because I've been doing this stuff 
> a lot lately, but usually with a rather small parameter to the 
> second rpois.  

On Intel, that consistently gives

>  rpois(1, 1000000 * rpois(1, 10000))
[1] -2147483648

I.e. signs of integer overflow. Apparently you partly get away with it
on a 64 bit machine, but I'm not surprised you get into regimes that
are not well tested by the poor developers working on hardware from
the bygone millennium....

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From kjetil.kjernsmo@astro.uio.no  Sun Apr 30 20:57:59 2000
From: kjetil.kjernsmo@astro.uio.no (Kjetil Kjernsmo)
Date: Sun, 30 Apr 2000 21:57:59 +0200 (MET DST)
Subject: [Rd] rpois hangs (PR#530)
In-Reply-To: <x2ya5vcr67.fsf@blueberry.kubism.ku.dk>
Message-ID: <Pine.OSF.4.05.10004302139190.20697-100000@alnair.uio.no>

On 30 Apr 2000, Peter Dalgaard BSA wrote:

>On Intel, that consistently gives
>
>>  rpois(1, 1000000 * rpois(1, 10000))
>[1] -2147483648
>
>I.e. signs of integer overflow.

Aha!

> Apparently you partly get away with it
>on a 64 bit machine, but I'm not surprised you get into regimes that
>are not well tested by the poor developers working on hardware from
>the bygone millennium....

:-) Whaddayamean "bygone", you're speaking to an astronomer here, you
know... :-) Anyway, if I can put my hardware to use, I'd be happy to do
so, just give me some detailed instructions.

Best,

Kjetil
-- 
Kjetil Kjernsmo
Graduate astronomy-student                    Problems worthy of attack
University of Oslo, Norway            Prove their worth by hitting back
E-mail: kjetikj@astro.uio.no                                - Piet Hein
Homepage <URL:http://www.astro.uio.no/~kjetikj/>
Webmaster@skepsis.no 

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From mlapsley@ndirect.co.uk  Sat Apr  1 19:18:09 2000
From: mlapsley@ndirect.co.uk (Michael Lapsley)
Date: Sat, 1 Apr 2000 19:18:09 +0100
Subject: [Rd] Bug ? mine or ? in R core
Message-ID: <20000401191809.A16446@athome.lapsley>

Dear R Gurus,

I would very much appreciate some help with this code snippit
from my RODBC package.

R crashes or exhibits bizarre behaviour when repeatedly fetching
large numbers of rows.

Examples:

> odbcFetchRows(0,max=50000)->xx
> odbcFetchRows(0,max=50000)->xx
> odbcFetchRows(0,max=50000)->xx
> odbcFetchRows(0,max=50000)->xx
> odbcFetchRows(0,max=50000)->xx
3rd arg (table) not of type VECSXP, from R_HashGet
Segmentation fault (core dumped)


> odbcFetchRows(0,max=100000)->xx
> odbcFetchRows(0,max=100000)->xx
Segmentation fault (core dumped)

> odbcFetchRows(0,max=50000)
...
...[49996,] "Some dummy data"
[49997,] "Some dummy data"
[49998,] "Some dummy data"
[49999,] "Some dummy data"
[50000,] "Some dummy data"

$stat
[1] 1

> odbcFetchRows(0,max=50000)
Error in odbcFetchRows(0, max = 50000) : can not set length of non-vector
> odbcFetchRows(0,max=50000)

[49998,] "Some dummy data"
[49999,] "Some dummy data"
[50000,] "Some dummy data"

$stat
[1] 1

> odbcFetchRows(0,max=50000)
Segmentation fault (core dumped)

(This is using a hacked version that does not actually fetch rows
from the database to save time).

Using the C that I distilled out (see below) to remove all
dependencies on sql/odbc I get something even more bizarre:

> odbcFetchRows(0,max=50000)->xx
> odbcFetchRows(0,max=50000)->xx
> odbcFetchRows(0,max=50000)->xx
Segmentation fault (core dumped)

but

> odbcFetchRows(0,max=25000)->xx
> odbcFetchRows(0,max=25000)->xx
> odbcFetchRows(0,max=25000)->xx
> odbcFetchRows(0,max=25000)->xx
Error: corrupted options list
Error: corrupted options list
Error: corrupted options list
Error: corrupted options list
Error: corrupted options list
Error: corrupted options list
Error: corrupted options list
Error: corrupted options list
.....
(endless loop needing killing)

I have stared at this for ages and cannot see the bug?  Is it me
or is there a problem in garbage collection or elsewhere?

Thanks in advance for any enlightenment.


Michael

-----------------------------------------------------------------

/* RODBC low level interface : crash function
 *
 * crash.c
 *
 */
#include <stdio.h>
#include <sys/types.h>
#include <fcntl.h>
#include <stdlib.h>


#include <Rinternals.h>
#include <Rdefines.h>


#define DBG(x,y) if(debug >= x) printf("%s\n",y)

/*******************************************************************************/
/* Replacement callee for odbcFetchRows to demonstate bug.                     */
/* Independant of sql/odbc                                                     */
/* Compile with                                                                */
/* cc -g  -Wall -I/usr/local/src/R-1.0.0/include/  -o crash.o -c crash.c       */
/* gcc -shared -g -Wall      -o crash.so  crash.o                              */
/* mv crash.so /usr/local/src/R-1.0.0/library/RODBC/libs/RODBC.so              */
/* then                                                                        */
/* $R -q                                                                       */
/* >library(RODBC)                                                             */
/* >odbcFetchRows(0,max=50000)                                                 */
/* and repeat till crashes.                                                    */
/*                                                                             */
/* Note that the loop will never exit unless max is specified.                 */
/*                                                                             */
/* Designed to work with RODBC-0.6.1a                                          */
/* Caller looks like:                                                          */
/*                                                                             */
/* "odbcFetchRows"<-                                                           */
/* function(channel,max=0,transposing=F,buffsize=1000,debug=0)                 */
/* {                                                                           */
/*         erg<-.Call("RODBCFetchRows",as.integer(channel),max=as.real(max),   */
/*                         transposing=as.logical(transposing),                */
/*                         buffsize=as.real(buffsize),debug=as.integer(debug)) */
/*         return(erg)                                                         */
/*         }                                                                   */
/*                                                                             */
/*                                                                             */
/*******************************************************************************/
SEXP RODBCFetchRows(SEXP sock,SEXP max,SEXP tx,SEXP bs,SEXP dbg)
{
SEXP data,t_data,names,ans,stat,dim;
int 	status=1,
	i,				/* col counter */
	NCOLS,
	channel=INTEGER(sock)[0],	/* not used here */
	debug=INTEGER(dbg)[0],
	transposing=(int)LOGICAL(tx)[0];	/*true if transposing, not used here*/

long maximum=(long)REAL(max)[0];

long 	j=1,k=1,			/* row counters*/
	buffsize=(long)REAL(bs)[0],	/* prealloc if row count NA*/
	length,offset,t_offset;		/* counts into output buf*/


NCOLS=1;
PROTECT(ans=NEW_LIST(2)); /*create answer [0] = data, [1]=stat */
PROTECT(stat=NEW_INTEGER(1)); /* numeric status vector */
PROTECT(data=NEW_CHARACTER(buffsize));
while(1){
	for (i=1; i<= NCOLS; i++){
			offset=((i-1)*maximum)+(j-1);
		}
	  DBG(2,"writing to data");
	  STRING(data)[offset]=COPY_TO_USER_STRING("Some dummy data");
		if(offset +NCOLS >= buffsize){
			DBG(1,"reallocating space");
			length=length(data);
			buffsize=length+buffsize;
			SET_LENGTH(data,buffsize);
		}
	j++;
	if(maximum && j>maximum)
		break;
}	

/* transpose it */
DBG(1,"trimming");
SET_LENGTH(data,j*NCOLS); /* trim down buffer*/

INTEGER(stat)[0]=status;
PROTECT(dim=NEW_INTEGER(2));


INTEGER(dim)[1]=NCOLS;
INTEGER(dim)[0]=length(data)/NCOLS;


DBG(2,"writing dim to data");
SET_DIM(data,dim);
DBG(2,"writing to ans 0");
VECTOR(ans)[0]=data;
DBG(2,"writing to ans 1");
VECTOR(ans)[1]=stat;
DBG(3,"protecting names");
PROTECT(names=NEW_CHARACTER(2));                                  
DBG(2,"writing to names 0");
STRING(names)[0]=COPY_TO_USER_STRING("data");                    
DBG(2,"writing to names 1");
STRING(names)[1]=COPY_TO_USER_STRING("stat");                   
DBG(2,"writing to ans");
SET_NAMES(ans,names);                                          
UNPROTECT(5);
return ans;
}

/****************************************/
/* Just a dummy to allow library(RODBC) */
/****************************************/
void RODBCInit()
{
}
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Sat Apr  1 19:31:42 2000
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 01 Apr 2000 20:31:42 +0200
Subject: [Rd] Bug ? mine or ? in R core
In-Reply-To: Michael Lapsley's message of "Sat, 1 Apr 2000 19:18:09 +0100"
References: <20000401191809.A16446@athome.lapsley>
Message-ID: <x2bt3tsmep.fsf@blueberry.kubism.ku.dk>

Michael Lapsley <mlapsley@ndirect.co.uk> writes:

[Crashes with the following code]

> PROTECT(ans=NEW_LIST(2)); /*create answer [0] = data, [1]=stat */
> PROTECT(stat=NEW_INTEGER(1)); /* numeric status vector */
> PROTECT(data=NEW_CHARACTER(buffsize));
> while(1){
> 	for (i=1; i<= NCOLS; i++){
> 			offset=((i-1)*maximum)+(j-1);
> 		}
> 	  DBG(2,"writing to data");
> 	  STRING(data)[offset]=COPY_TO_USER_STRING("Some dummy data");
> 		if(offset +NCOLS >= buffsize){
> 			DBG(1,"reallocating space");
> 			length=length(data);
> 			buffsize=length+buffsize;
> 			SET_LENGTH(data,buffsize);
                        ^^^^^^^^^^^^^^^^^^^^^^^^^
> 		}
> 	j++;
> 	if(maximum && j>maximum)
> 		break;
> }	
> 
> /* transpose it */
> DBG(1,"trimming");
> SET_LENGTH(data,j*NCOLS); /* trim down buffer*/
  ^^^^^^^^^^^^^^^^^^^^^^^^

I'm not too well accustomed to these macros (they aren't used in the R
internals), but in Rdefines.h we have

#define SET_LENGTH(x, n)       (x = lengthgets(x, n))

so I wouldn't count on "data" being the same after those operations,
and in particular not expect it to be protected anymore. You probably
need to stick in "UNPROTECT(1); PROTECT(data);" after the SET_LENGTH
operations.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From mlapsley@ndirect.co.uk  Sun Apr  2 00:28:21 2000
From: mlapsley@ndirect.co.uk (Michael Lapsley)
Date: Sun, 2 Apr 2000 00:28:21 +0100
Subject: [Rd] Bug ? mine or ? in R core
In-Reply-To: <x2bt3tsmep.fsf@blueberry.kubism.ku.dk>
References: <20000401191809.A16446@athome.lapsley> <x2bt3tsmep.fsf@blueberry.kubism.ku.dk>
Message-ID: <20000402002821.A16858@athome.lapsley>


Thanks, Peter, it seems to do the trick.  I spent a lot of
time trying first to reproduce then identify this one!

What is the 'approved' method of resizing a vector?
Is SET_LENGTH deprecated, or does it just happen that there is
no need for it in tht R internals?


Michael

On Sat, Apr 01, 2000 at 08:31:42PM +0200, Peter Dalgaard BSA wrote:
> > /* transpose it */
> > DBG(1,"trimming");
> > SET_LENGTH(data,j*NCOLS); /* trim down buffer*/
>   ^^^^^^^^^^^^^^^^^^^^^^^^
> 
> I'm not too well accustomed to these macros (they aren't used in the R
> internals), but in Rdefines.h we have
> 
> #define SET_LENGTH(x, n)       (x = lengthgets(x, n))
> 
> so I wouldn't count on "data" being the same after those operations,
> and in particular not expect it to be protected anymore. You probably
> need to stick in "UNPROTECT(1); PROTECT(data);" after the SET_LENGTH
> operations.
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Sun Apr  2 00:36:20 2000
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 02 Apr 2000 01:36:20 +0200
Subject: [Rd] Bug ? mine or ? in R core
In-Reply-To: Michael Lapsley's message of "Sun, 2 Apr 2000 00:28:21 +0100"
References: <20000401191809.A16446@athome.lapsley> <x2bt3tsmep.fsf@blueberry.kubism.ku.dk> <20000402002821.A16858@athome.lapsley>
Message-ID: <x2k8ih5r7v.fsf@blueberry.kubism.ku.dk>

Michael Lapsley <mlapsley@ndirect.co.uk> writes:

> Thanks, Peter, it seems to do the trick.  I spent a lot of
> time trying first to reproduce then identify this one!

Been there...

> What is the 'approved' method of resizing a vector?
> Is SET_LENGTH deprecated, or does it just happen that there is
> no need for it in tht R internals?

On the contrary! It's the official way. We just don't use it
internally (in the few places where it might be used, we're using
direct calls to realloc()).

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Sun Apr  2 15:31:54 2000
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Sun, 2 Apr 2000 16:31:54 +0200
Subject: [Rd] C++ support
Message-ID: <200004021431.QAA14557@aragorn.ci.tuwien.ac.at>

I will shortly commit a first shot a C++ support for add-on packages (to
r-devel, of course).

For me, installation of a trivial test package (basically consisting of
the example in R-exts) works without problems.  I'll put the package
into CRAN's src/contrib/Devel for some time.

If anyone knows about platform/compiler specific settings CXXPICFLAGS
settings that configure needs to be taught, pls let me know.

Building shared libs would be based on the following idea: if C++ code
was found, then try using CXX as SHLIBLD (i.e. the C++ compiler for
building the shared library).  Alternatively, one would need to find out
what C++ is linked against, which may be a pain.  Anyway, I thought I'd
collect some feedback and then maybe come up with something refined.

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From maechler@stat.math.ethz.ch  Mon Apr  3 13:37:43 2000
From: maechler@stat.math.ethz.ch (maechler@stat.math.ethz.ch)
Date: Mon, 3 Apr 2000 14:37:43 +0200 (MET DST)
Subject: [Rd] another save/load problem, only(?) affecting ascii = TRUE (PR#507)
Message-ID: <200004031237.OAA25910@pubhealth.ku.dk>

On all current R versions, afaik:

When using  save(....., ascii = TRUE),
the resulting file is not always readable by load(.).

The following is executable R code
exhibiting two (slightly different) examples
of which I have seen even more [~/R/MISC/saveload-bug.R]:

### BUG :  save(..., ascii = TRUE)  produces load() -  unreadable files :

tstf1 <- function(n = 500)
{
    ## Purpose:
    ## -----------------------------------------------------------------------
    ## Author: Martin Maechler, Date: 29 Mar 2000, 15:40
    ## -----------------------------------------------------------------------
    n2 <- n %/% 2
    nk <- n2 * 4
    CPU <- numeric(n)
    ## -----------------------------------------------------------------------
    for(i in 1:n) { ## just a simple pseudo loop
        n <- n*nk
        CPU[i] <- i^n
    }
    CPU
}

tstf2 <- function(n = 500)
{
    ## Author: Martin Maechler, Date: 1 Apr 2000, 15:40
    n %/% 2
}

save(tstf1, file="foo1",ascii=TRUE); load(file="foo1")
## Error in load(file = "foo1") : NewReadItem: unknown type -1073749696
save(tstf2, file="foo2",ascii=TRUE); load(file="foo2")
## Error in load(file = "foo2") : NewReadItem: unknown type 92

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Mon Apr  3 16:09:35 2000
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 03 Apr 2000 17:09:35 +0200
Subject: [Rd] another save/load problem, only(?) affecting ascii = TRUE (PR#507)
In-Reply-To: maechler@stat.math.ethz.ch's message of "Mon, 3 Apr 2000 14:37:43 +0200 (MET DST)"
References: <200004031237.OAA25910@pubhealth.ku.dk>
Message-ID: <x2ya6vte4w.fsf@blueberry.kubism.ku.dk>

maechler@stat.math.ethz.ch writes:

> tstf2 <- function(n = 500)
> {
>     ## Author: Martin Maechler, Date: 1 Apr 2000, 15:40
>     n %/% 2
> }
> 
> save(tstf1, file="foo1",ascii=TRUE); load(file="foo1")
> ## Error in load(file = "foo1") : NewReadItem: unknown type -1073749696
> save(tstf2, file="foo2",ascii=TRUE); load(file="foo2")
> ## Error in load(file = "foo2") : NewReadItem: unknown type 92

Squished (I think). Problem was that nonprinting characters (incl. the
Space character) were printed in octal using %o format in
OutStringAscii. That should be %.3o to ensure that exactly three octal
digits get printed. Otherwise we're in trouble every time a digit
follows a space. 

I kind of suspect that there's really no reason to escape spaces like
that, but we'd have the same problem with other unprintables.

The $ffff question is whether %.3o is guaranteed to work on all
platforms.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From koller2@fgr.wu-wien.ac.at  Mon Apr  3 17:21:13 2000
From: koller2@fgr.wu-wien.ac.at (Wolfgang Koller)
Date: Mon, 03 Apr 2000 18:21:13 +0200
Subject: [Rd] window(): feature request
Message-ID: <3.0.6.32.20000403182113.008f1bf0@fgr.wu-wien.ac.at>

Dear R-developpers,

currently the function window shows the following behaviour, if start or
end is out of range:

> x <- ts(1:14,start=c(1950,2),frequency=4)
> y <- window(x,start=c(1950,1),end=c(1953,4))
Warning messages: 
1: start value not changed in: window.default(x, ...) 
2: end value not changed in: window.default(x, ...) 

Instead of this I would like it to fill with NAs the values before start(x)
and after end(x). Could this be done by introducing an additional option in
window()? Could you please consider this in future releases? Or is there a
better way to do this using existing functions?
 
Thanks very much! 

Wolfgang Koller

P.S.: Below I have added some code that accomplishes this aim in a separate
function (which is probably an example of akward programming...).

sloppywindow <- function(x,start,end) {
  if (!is.ts(x) || (NCOL(x) > 1)) 
     stop("x is not a univariate time series") # does not work for frames
  xfrequ <- frequency(x)
  n <- length(x)

  time.start <- if (length(start) > 1) {
     if(start[2] > xfrequ) stop("invalid start")
     start[1] + (start[2] - 1)/xfrequ
  } else start

  time.end <- if (length(end) > 1) {
     if(end[2] > xfrequ) stop("invalid end")
     end[1] + (end[2] - 1)/xfrequ
  } else end

  if(time.start > time.end)
        stop("start cannot be after end")
  
  before <- round( (time(x)[1] - time.start) * xfrequ)
  before.NAs <- if (before > 0) rep(NA,before) else NULL
  after <- round( (time.end - time(x)[n] ) * xfrequ)
  after.NAs <- if (after > 0) rep(NA,after) else NULL
   
  first.start <- if (before > 0) start else start(x)
  x <- ts(c(before.NAs,x,after.NAs),start=first.start,frequency=xfrequ)  
  return(window(x,start,end))
}


-------------------------------------------------
Wolfgang Koller,  koller2@fgr.wu-wien.ac.at
Forschungsinstitut für Europafragen
Wirtschaftsuniversitaet Wien
Althanstrasse 39-45, 1090 Vienna, Austria
http://fgr.wu-wien.ac.at/institut/ef/ief-home.htm
-------------------------------------------------
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From koller2@fgr.wu-wien.ac.at  Mon Apr  3 19:08:12 2000
From: koller2@fgr.wu-wien.ac.at (koller2@fgr.wu-wien.ac.at)
Date: Mon, 3 Apr 2000 20:08:12 +0200 (MET DST)
Subject: [Rd] cbind.ts(),ts.union() (PR#508)
Message-ID: <200004031808.UAA29180@pubhealth.ku.dk>

Full_Name: Wolfgang Koller
Version: 1.0.0
OS: linux 
Submission from: (NULL) (137.208.7.48)


> data(UKLungDeaths)
> ts.union(mdeaths, fdeaths,dframe=TRUE)
Error in names<-.default(*tmp*, value = nmsers) : 
        names attribute must be the same length as the vector
> cbind(mdeaths, fdeaths,dframe=TRUE)
Error in names<-.default(*tmp*, value = nmsers) : 
        names attribute must be the same length as the vector

should not give an error

BR#239--241

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Mon Apr  3 20:56:21 2000
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Mon, 3 Apr 2000 20:56:21 +0100 (BST)
Subject: [Rd] cbind.ts(),ts.union() (PR#508)
In-Reply-To: <200004031808.UAA29180@pubhealth.ku.dk>
Message-ID: <Pine.GSO.4.05.10004032053370.14448-100000@auk.stats>

On Mon, 3 Apr 2000 koller2@fgr.wu-wien.ac.at wrote:

> Full_Name: Wolfgang Koller
> Version: 1.0.0
> OS: linux 
> Submission from: (NULL) (137.208.7.48)
> 
> 
> > data(UKLungDeaths)
> > ts.union(mdeaths, fdeaths,dframe=TRUE)
> Error in names<-.default(*tmp*, value = nmsers) : 
>         names attribute must be the same length as the vector
> > cbind(mdeaths, fdeaths,dframe=TRUE)
> Error in names<-.default(*tmp*, value = nmsers) : 
>         names attribute must be the same length as the vector
> 
> should not give an error

Those are the same thing.  Replace

       x <- vector("list", n)
by

       x <- vector("list", nser)

which was not too hard to debug, surely?

> BR#239--241

Eh?  That's beyond me!

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Thomas Vogels <tov@ece.cmu.edu>  Mon Apr  3 21:42:12 2000
From: Thomas Vogels <tov@ece.cmu.edu> (Thomas J Vogels)
Date: 03 Apr 2000 16:42:12 -0400
Subject: [Rd] AIX fails on startup with R-1.0.0
In-Reply-To: Kurt Hornik's message of "Fri, 31 Mar 2000 19:21:21 +0200 (CEST)"
References: <Pine.GSO.4.21.0003181111590.11158-100000@mail.biostat.washington.edu> <871z561pcm.fsf@bavaria.ece.cmu.edu> <14552.57463.552150.382635@aragorn.ci.tuwien.ac.at> <8766uens46.fsf@bavaria.ece.cmu.edu> <14554.25111.847983.270127@aragorn.ci.tuwien.a
Message-ID: <87bt3qj4rf.fsf@bavaria.ece.cmu.edu>


Kurt,

  the saga continues...

> Users of current r-devel snapshots on AIX, can you confirm that
> 
> 	MAINLD=cc SHLIBLD=cc /path/to/configure
> 	make

yes, this compiles cleanly, make check runs without a hiccup.  But
then problems start:

(old) make install fails.  I compile in a build directory to make it
    easier to nuke the compilation tree.  Installation from there fails as
    it can't find $(INSTALL_DATA).
/bin/sh: ../tools/install-sh:  not found.  [repeats six times]

    Here is the excerpt from the Makefile:
        @(cd $(srcdir); \
          for f in $(INSTFILES); do \
-           $(INSTALL_DATA) $${f} $(rhome); \
+           pwd; tools/$(INSTALL_DATA) $${f} $(rhome); \
          done)
    The line with a '-' is the original line.  This will fail because
    of the cd to srcdir.  The line prefixed by '+' works but is a bad
    patch. Since INSTALL_DATA is ../tools/install-sh (forced to be on
    AIX!), would the following work?
        @(for f in $(INSTFILES); do \
            $(INSTALL_DATA) $(srcdir)/$${f} $(rhome); \
          done)

   Somehow, the path to install-sh is not made absolute, as Kurt
   expected.  AIX is/should be one of the platforms where the use of
   the install-sh that comes with R is forced.  But the path to it is
   relative (not absolute) in Makeconf:

$ grep install-sh Makeconf /dev/null
Makeconf:INSTALL = $(top_srcdir)/tools/install-sh -c
$ grep top_srcdir Makefile /dev/null
Makefile:top_srcdir = ..

(old) the file R.exp doesn't get copied into rhome/etc/.  Installation of
   packages with source code may/will fail (AIX specific).  I don't
   know at which step this file should get copied so I can't trace the
   Makefiles to see why it doesn't.

(new) Actually, compilation fails for a different reason.  E.g. for
   date (smallest contrib package I saw): 

Installing package `date' ...
 libs
gcc -I/afs/ece/usr/tov/opt/arch/lib/R/include  -I/usr/local/include -I/afs/ece/usr/tov/opt/share/include -mno-fp-in-toc  -fPIC -g -O2 -c char_date.c -o char_date.o
make: *** No rule to make target `*.o', needed by `/afs/ece/usr/tov/opt/arch/lib/R/library/date/libs/date.so'.  Stop.

    R INSTALL nevertheless proceeds happily with the installation and
    reports DONE.

(old) demo(dyn.load) in an R session will fail as R can't find
   demo.so.  This file doesn't get installed, nor are there
   instructions in the README in demos/dynload on how to compile it.
   (The hint to run "R SHLIB zero.c" would be nice to have in the
   demos/dynload/README.) 
   The install target in demos/dynload/Makefile will not copy
   demo.so.  It only copies README, zero.R and zero.c.  

[snip]
> > -- ld/cc doesn't automatically include /usr/local/lib while gcc does.
> > This comes from the sytem installation here and has nothing to do with
> > R.  But having to add LIBS=-L/usr/local/lib may come as a surprise to
> > people who don't do this regularly.
> 
> > Does configure check for the existence of e.g. libz.a with cc or gcc?
> It uses the C compiler specified.
> 
> Well, LIBS is needed when you have things in `non-standard' locations.
> Of course your mileage may vary on the definition of non-standard :-)

> Is there anything I/configure could do about this?  (Note that I don't
> think that unconditionally adding /usr/local/lib to LIBS is a good
> idea.) 

Dunno.  As Brian pointed out in his reply, he has to add
/usr/local/lib also on a Solaris machine.  At the moment, my humble
suggestion would be to add this in the installation instructions.

At the moment, I'm worried about the missing rule for *.o files.  Does
this happen only for me?

Thanks,
  -tom


BTW, this happens with code from this morning:
         _                           
platform powerpc-ibm-aix4.3.2.0      
arch     powerpc                     
os       aix4.3.2.0                  
system   powerpc, aix4.3.2.0         
status   Under development (unstable)
major    1                           
minor    1.0                         
year     2000                        
month    April                       
day      3                           
language R               

-- 
mailto:tov@ece.cmu.edu (Tom Vogels)   Tel: (412) 268-6638   FAX: -3204
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From edd@debian.org  Tue Apr  4 00:23:34 2000
From: edd@debian.org (edd@debian.org)
Date: Tue, 4 Apr 2000 01:23:34 +0200 (MET DST)
Subject: [Rd] write.table with rows and cols (PR#509)
Message-ID: <200004032323.BAA00377@pubhealth.ku.dk>

Full_Name: Dirk Eddelbuettel
Version: 1.0.0 (patched)
OS: Linux
Submission from: (NULL) (192.139.71.69)


A frame with rownames and colnames got properly written, but the colnames
started 
without an offset -- but if the .csv file is read back in, the rownames column
now 
has the header of the first column.  

"Graphically", suppose a frame with two rows 1999 and 2000, and two columns foo
and 
bar, with content equal to the row/col index.

This should be written as

  ,foo,bar
  1999,11,12
  2000,21,22

but was written without the initial ","  (I used "," as the sep).

Am I making sense? 

Anyway, big thanks for R!

Dirk


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Tue Apr  4 07:25:01 2000
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Tue, 4 Apr 2000 07:25:01 +0100 (BST)
Subject: [Rd] write.table with rows and cols (PR#509)
In-Reply-To: <200004032323.BAA00377@pubhealth.ku.dk>
Message-ID: <Pine.GSO.4.05.10004040710030.15113-100000@auk.stats>

On Tue, 4 Apr 2000 edd@debian.org wrote:

> Full_Name: Dirk Eddelbuettel
> Version: 1.0.0 (patched)
> OS: Linux
> Submission from: (NULL) (192.139.71.69)
> 
> 
> A frame with rownames and colnames got properly written, but the colnames
> started 
> without an offset -- but if the .csv file is read back in, the rownames column
> now 
> has the header of the first column.  
> 
> "Graphically", suppose a frame with two rows 1999 and 2000, and two columns foo
> and 
> bar, with content equal to the row/col index.
> 
> This should be written as
> 
>   ,foo,bar
>   1999,11,12
>   2000,21,22
> 
> but was written without the initial ","  (I used "," as the sep).
> 
> Am I making sense? 

In the S convention, the header is regarded as separate, with a potentially
different format from the rest of the file. If I have

auk% cat test.csv
foo,bar
1999,11,12
2000,21,22

then

> read.table("test.csv", sep=",")
     foo bar
1999  11  12
2000  21  22

works, as does test <- read.csv("test.csv"). If I then do

> write.table(test, "test2.csv", sep=",", quote=F)

I get

auk% cat test2.csv
foo,bar
1999,11,12
2000,21,22

as before, so it seems that this is working as expected.  Can you give the
actual example you used that fails?  There are a lot of other things which
can potentially go wrong, including the quote setting (and I had to use
quote=F to approximate the file you quote).

Note that when I read your suggested correction with read.table/read.cvs I
get

    NA foo bar
1 1999  11  12
2 2000  21  22

unless I use read.csv("test2.csv", row.names=1).


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From edd@debian.org  Tue Apr  4 13:34:53 2000
From: edd@debian.org (Dirk Eddelbuettel)
Date: Tue, 4 Apr 2000 08:34:53 -0400
Subject: [Rd] write.table with rows and cols (PR#509)
In-Reply-To: <Pine.GSO.4.05.10004040710030.15113-100000@auk.stats>; from ripley@stats.ox.ac.uk on Tue, Apr 04, 2000 at 07:25:01AM +0100
References: <200004032323.BAA00377@pubhealth.ku.dk> <Pine.GSO.4.05.10004040710030.15113-100000@auk.stats>
Message-ID: <20000404083453.B3373@eddelbuettel.com>


With my head hanging low as this is a non-bug:

On Tue, Apr 04, 2000 at 07:25:01AM +0100, Prof Brian D Ripley wrote:
> On Tue, 4 Apr 2000 edd@debian.org wrote:
[...]
> > A frame with rownames and colnames got properly written, but the colnames
> > started 
> > without an offset -- but if the .csv file is read back in, the rownames column
> > now 
> > has the header of the first column.  
[...]

> In the S convention, the header is regarded as separate, with a potentially
> different format from the rest of the file. If I have

Ahh. Shows once again that I am still a novice when it comes to S (and R).
You are of course correct -- re-reading works just fine as expected. No bug
here.

But maybe the (extremely low-priority) need for new semantics -- I actually
only wrote the file to pass data on to my Excel using collegues at work, and
for them the csv _is_ wrong as the 'Dates' column (build from rownames) is
headerless, and the other headers are "shifted".  Having to hand-edit the
file for them is silly. 

Thanks,  Dirk

-- 
According to the latest figures, 43% of all statistics are totally worthless.
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Wed Apr  5 07:30:57 2000
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 5 Apr 2000 08:30:57 +0200
Subject: [Rd] R CMD build
In-Reply-To: <Pine.GSO.4.05.10003300709540.23994-100000@auk.stats>
References: <38E26279.BC2A6400@bank-banque-canada.ca>
 <Pine.GSO.4.05.10003300709540.23994-100000@auk.stats>
Message-ID: <200004050630.IAA16129@aragorn.ci.tuwien.ac.at>

>>>>> Prof Brian D Ripley writes:

> On Wed, 29 Mar 2000, Paul Gilbert wrote:
>> >Well, are there \alias entries in the Rd files?
>> No. I guess that would be it. Should I have an empty \alias entry if the
>> object does not have an alias, or should should I just live with the
>> warnings?

> You should have an alias for each function documented there, even if
> there is only one. The object name is itself an alias.  The \name
> field is the help file name, not the object name (although 90+% of
> them are the same), and it is the \alias's that gives the object
> names,

(Not sure about the 90+ percent :-))

>> >The convention is to put a \alias for the method in the help file for
>> the generic.
>> Ok, but I guess this won't work if the generic is the base and my method
>> is in my library?

> Sure (and that is part of the debate). Either ignore them, or have a
> .Rd with just a very brief description of these (e.g. just their
> usages).

>> >> 4/ Checking for undocumented objects fails with an ERROR when
>> checking
>> >> an (undocumented) assignment object ( "input.series.names<-" ).
>> >I think it works if you document it, though, and the error is correct,
>> >surely?  Do you mean it gives ERROR and then stops rather than warns?
>> 
>> Yes, it should warn me about this, but it gives ERROR and stops. (If I
>> run it with my makefile it returns code 1.) The message is:
>> in eval(expr, envir, enclos) : couldn't find function
>> "input.series.names<-"

> Looks like a bug, then.

Hmm.  Can you (Paul) perhaps give a small example I could reproduce?  I
just tried the following:  let the R code contain 

	"foo<-" <- function(x, value) NULL

Then if an Rd file has \alias{foo<-}, everything is o.k., if not,
"foo<-" is shows as undoc object.  How do you get the error?

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Wed Apr  5 07:40:25 2000
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Wed, 5 Apr 2000 07:40:25 +0100 (BST)
Subject: [Rd] R CMD build
In-Reply-To: <200004050630.IAA16129@aragorn.ci.tuwien.ac.at>
Message-ID: <Pine.GSO.4.05.10004050738240.21288-100000@auk.stats>

On Wed, 5 Apr 2000, Kurt Hornik wrote:

> >>>>> Prof Brian D Ripley writes:
> 
> > On Wed, 29 Mar 2000, Paul Gilbert wrote:
> >> >Well, are there \alias entries in the Rd files?
> >> No. I guess that would be it. Should I have an empty \alias entry if the
> >> object does not have an alias, or should should I just live with the
> >> warnings?
> 
> > You should have an alias for each function documented there, even if
> > there is only one. The object name is itself an alias.  The \name
> > field is the help file name, not the object name (although 90+% of
> > them are the same), and it is the \alias's that gives the object
> > names,
> 
> (Not sure about the 90+ percent :-))

Last time I looked there were about 20 exceptions in the whole of base R,
out of ca 700 files.

> 
> >> >The convention is to put a \alias for the method in the help file for
> >> the generic.
> >> Ok, but I guess this won't work if the generic is the base and my method
> >> is in my library?
> 
> > Sure (and that is part of the debate). Either ignore them, or have a
> > .Rd with just a very brief description of these (e.g. just their
> > usages).
> 
> >> >> 4/ Checking for undocumented objects fails with an ERROR when
> >> checking
> >> >> an (undocumented) assignment object ( "input.series.names<-" ).
> >> >I think it works if you document it, though, and the error is correct,
> >> >surely?  Do you mean it gives ERROR and then stops rather than warns?
> >> 
> >> Yes, it should warn me about this, but it gives ERROR and stops. (If I
> >> run it with my makefile it returns code 1.) The message is:
> >> in eval(expr, envir, enclos) : couldn't find function
> >> "input.series.names<-"
> 
> > Looks like a bug, then.
> 
> Hmm.  Can you (Paul) perhaps give a small example I could reproduce?  I
> just tried the following:  let the R code contain 
> 
> 	"foo<-" <- function(x, value) NULL
> 
> Then if an Rd file has \alias{foo<-}, everything is o.k., if not,
> "foo<-" is shows as undoc object.  How do you get the error?

That (and "input.series.names<-") work for me on Solaris, too.


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From marggie24@guelmail.com  Wed Apr  5 18:07:58 2000
From: marggie24@guelmail.com (marggie24@guelmail.com)
Date: Wed, 05 Apr 2000 17:07:58
Subject: [Rd] People with pain
Message-ID: <zfjle5ynj4hlb58.050420001707@localhost>

ARE YOU LOOKING FOR THE PERFECT BUSINESS VENTURE?

Unique product, sold in the multinational market for the last 16 years!

Only available for the last four years in the US!

One initial product purchase required to qualify for commissions!
This means no monthly qualification!

Enthusiastic testimonials from health professionals, athletes, people with chronic
pain, insomnia, circulation problems, who are using this product daily!

Immediate relief felt that continues to improve your comfort the more you use it!

Commissions paid monthly at 10 to 40% with the addition of car bonus, travel bonus and profit sharing for leadership level! Over ride profits of 1-30% on your downline
leadership groups!  Business builders compress up to become your active legs!

Invest a few minutes of your time to respond to this message by emailing

<A HREF="networks@fiberia.com">

and requesting information  or call our voice mail at
888-818-0944  for a personal return call!

We look forward to hearing from you!
***************************************************

We are terribly sorry if you received this message in error.
If you wish to be removed, please type REMOVE in the subjuct line.
ler@fiberia.com      Thank you.
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From marggie24@guelmail.com  Wed Apr  5 19:05:30 2000
From: marggie24@guelmail.com (marggie24@guelmail.com)
Date: Wed, 05 Apr 2000 18:05:30
Subject: [Rd] Live long and prosper
Message-ID: <ecl1s6skim5puq4.050420001805@localhost>

ARE YOU LOOKING FOR THE PERFECT BUSINESS VENTURE?

Unique product, sold in the multinational market for the last 16 years!

Only available for the last four years in the US!

One initial product purchase required to qualify for commissions!
This means no monthly qualification!

Enthusiastic testimonials from health professionals, athletes, people with chronic
pain, insomnia, circulation problems, who are using this product daily!

Immediate relief felt that continues to improve your comfort the more you use it!

Commissions paid monthly at 10 to 40% with the addition of car bonus, travel bonus and profit sharing for leadership level! Over ride profits of 1-30% on your downline
leadership groups!  Business builders compress up to become your active legs!

Invest a few minutes of your time to respond to this message by emailing

<A HREF="networks@fiberia.com">

and requesting information  or call our voice mail at
888-818-0944  for a personal return call!

We look forward to hearing from you!
***************************************************

We are terribly sorry if you received this message in error.
If you wish to be removed, please type REMOVE in the subjuct line.
ler@fiberia.com      Thank you.
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ligges@statistik.uni-dortmund.de  Thu Apr  6 08:28:54 2000
From: ligges@statistik.uni-dortmund.de (Uwe Ligges)
Date: Thu, 06 Apr 2000 09:28:54 +0200
Subject: [Rd] xyz.coords(.)
References: <38DA5007.B0AB5186@statistik.uni-dortmund.de>
 <14555.7873.266935.277408@lynne.ethz.ch>
 <38DD1154.9FF80C75@statistik.uni-dortmund.de> <14559.2458.327647.545328@lynne.ethz.ch>
Message-ID: <38EC3CB6.E1C7BF41@statistik.uni-dortmund.de>

In order to improve scatterplot3d(.), Martin Maechler wrote:

> Maybe you could extend  xy.coord() to xyz.coord(), a function that would be
> useful in a more general context.

If you are interested, have a look at 
http://www.statistik.uni-dortmund.de/leute/ligges.htm
for source and examples of xyz.coords(.).
I only added (changed) some lines to xy.coords(.) of R's base package.

Discussion and comments are welcome.

Best regards,
Uwe Ligges
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From krishnan@nrl.cs.uoregon.edu  Thu Apr  6 15:03:39 2000
From: krishnan@nrl.cs.uoregon.edu (Sivaramakrishna Iyer Krishnan)
Date: Thu, 6 Apr 2000 07:03:39 -0700 (PDT)
Subject: [Rd] Automation of scripts ... reading a file.
Message-ID: <Pine.BSF.3.96.1000406070011.20041E-100000@day.nrl.cs.uoregon.edu>


Hi,

I want to automate a set of scripts that spit out data that are later used
by R to plot graphs. However, I need to get into R's environment now and
then use my R script using the source command. Is there a way to run the
R script from the unix prompt ?. 

Thanks,
Krishnan.

-----------------------------------------------------------
Sivaramakrishna Iyer Krishnan (Anand)
Research Assistant 
University of Oregon. 

House Address : 		Office Address : 
942 East, 18th Avenue, #14,	Deschutes Hall, Computer Science Department,
Ridgewood Apartments,		Room No. 228, University of Oregon - 97403.
Eugene, Oregon - 97403. 	Ph. : 541-346-4409.
Ph. : 541-683-8223.

E-mail : krishnan@nrl.cs.uoregon.edu,krishnan@.cs.uoregon.edu
URL    : http://www.nrg.cs.uoregon.edu/~krishnan/cs-web/.
------------------------------------------------------------
"It is better to be defeated on principle than to win on lies."
- Arthur Calwell

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From guido@sirio.stat.unipd.it  Thu Apr  6 17:29:08 2000
From: guido@sirio.stat.unipd.it (Guido Masarotto)
Date: Thu, 6 Apr 2000 18:29:08 +0200
Subject: [Rd] Re: [R] MetaPost device?
In-Reply-To: <x2ya6r2qea.fsf@blueberry.kubism.ku.dk>; from p.dalgaard@biostat.ku.dk on Thu, Apr 06, 2000 at 05:35:57PM +0200
References: <005501bf9fd8$2697d420$9570fe8c@lucent.com> <x2ya6r2qea.fsf@blueberry.kubism.ku.dk>
Message-ID: <20000406182908.A19743@sirio.stat.unipd.it>

[moving to r-devel]


On Thu, Apr 06, 2000 at 05:35:57PM +0200, Peter Dalgaard BSA wrote:
> "Vidhyanath Rao" <rao.3@osu.edu> writes:
> 
> > I would like to know if a MetaPost device is available or in the plans.
> > .....................................................................
> > If not, how easy/hard is it to add a new device to R? I caouln't see
> > ...................................................................
> It's not terribly hard (said the man who people have been nagging to
> do an xfig driver for years...) if you know the file format to
> generate. You need to figure out how to do do a rather small
> set of primitives to do text, polylines, etc., and then fill routines
> to do those into a fairly simple framework. 

  The problem with MetaPost (if I understand well) is how
  you do get metric information about the fonts. 
  In particular for the plotmath stuff.
  The easiest way is to delegate the whole thing to metapost itself (and
  to TeX in the back), i.e., you use 
  > text(somewhere,"\sum_i x_i")
  (not 'text(somewhere,expression(...))')
  and on the mp file the device write
  'btex $\sum_i x_i$ etex'
  ie, you ask to MetaPost to call TeX to process the fragment.
  However, this has the obvious drawback that the preview on the screen
  is not good.
  The alternative is to use the approach of the postscript device
  (you fix the fonts available, distribute a set of files with metric
   information of the fonts, and make the device to use it).
   I am not sure about how hard this will be. BTW, which
   kind of fonts is used by MetaPost?

   guido
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From J.C.Rougier@durham.ac.uk  Thu Apr  6 19:15:05 2000
From: J.C.Rougier@durham.ac.uk (J.C.Rougier@durham.ac.uk)
Date: Thu, 6 Apr 2000 20:15:05 +0200 (MET DST)
Subject: [Rd] Strange behaviour of image (PR#510)
Message-ID: <200004061815.UAA02888@pubhealth.ku.dk>

The following commands

z <- matrix(seq(0, 1, len=1000))
image(z, 1, z, zlim=c(0, 1), col=gray(1:10/10))

appear to violate the image functionality as described on the
help page.  As I understand it, by specifying a zlim of c(0, 1)
and a colour vector of length 10, the colours should correspond
to the intervals (0, 0.1), (0.1, 0.2), ..., (0.9, 1.0), this
being 10 equally-spaced intervals on (0, 1).  It is clear from
the image that this has not occurred.  In fact the intervals are
apparently (0, 1/18), (1/18, 3/18), ..., (15/18, 17/18), (17/18,
1).  Have I misunderstood something?

Cheers, Jonathan.

--please do not edit the information below--

Version:
 platform = sparc-sun-solaris2.7
 arch = sparc
 os = solaris2.7
 system = sparc, solaris2.7
 status = Patched
 major = 0
 minor = 99.0
 year = 2000
 month = February
 day = 9
 language = R

Search Path:
 .GlobalEnv, Autoloads, package:base

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Thu Apr  6 19:47:44 2000
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 06 Apr 2000 20:47:44 +0200
Subject: [Rd] Strange behaviour of image (PR#510)
In-Reply-To: J.C.Rougier@durham.ac.uk's message of "Thu, 6 Apr 2000 20:15:05 +0200 (MET DST)"
References: <200004061815.UAA02888@pubhealth.ku.dk>
Message-ID: <x21z4jnk1b.fsf@blueberry.kubism.ku.dk>

J.C.Rougier@durham.ac.uk writes:

> The following commands
> 
> z <- matrix(seq(0, 1, len=1000))
> image(z, 1, z, zlim=c(0, 1), col=gray(1:10/10))
> 
> appear to violate the image functionality as described on the
> help page.  As I understand it, by specifying a zlim of c(0, 1)
> and a colour vector of length 10, the colours should correspond
> to the intervals (0, 0.1), (0.1, 0.2), ..., (0.9, 1.0), this
> being 10 equally-spaced intervals on (0, 1).  It is clear from
> the image that this has not occurred.  In fact the intervals are
> apparently (0, 1/18), (1/18, 3/18), ..., (15/18, 17/18), (17/18,
> 1).  Have I misunderstood something?

I don't see that anything else is being promised...

If someone actually thought about this, then the choice might be
related to the behavior at peaks and troughs. (since a circle with
radius r looks wide compared to the region between two circles with
diameter n*r and (n+1)*r)

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ihaka@stat.auckland.ac.nz  Thu Apr  6 23:02:31 2000
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Fri, 7 Apr 2000 10:02:31 +1200
Subject: [Rd] Re: [R] MetaPost device?
In-Reply-To: <20000406182908.A19743@sirio.stat.unipd.it>; from Guido Masarotto on Thu, Apr 06, 2000 at 06:29:08PM +0200
References: <005501bf9fd8$2697d420$9570fe8c@lucent.com> <x2ya6r2qea.fsf@blueberry.kubism.ku.dk> <20000406182908.A19743@sirio.stat.unipd.it>
Message-ID: <20000407100231.A2998@stat1.stat.auckland.ac.nz>

On Thu, Apr 06, 2000 at 06:29:08PM +0200, Guido Masarotto wrote:

>   The problem with MetaPost (if I understand well) is how
>   you do get metric information about the fonts. 

The metric info problem is what stoped me writing the XFig driver.
Which metrics do you use for Times-Roman for example -- the X11 metrics
or the PostScript metrics?
	
	Ross
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pd@blueberry.kubism.ku.dk  Fri Apr  7 06:15:04 2000
From: pd@blueberry.kubism.ku.dk (Peter Dalgaard BSA)
Date: Fri, 7 Apr 2000 07:15:04 +0200
Subject: [Rd] Bug list summary (automatic post)
Message-ID: <200004070515.HAA21833@blueberry.kubism.ku.dk>

=================================================
This is an automated summary of the status of the R-bugs
repository.

Note that this may be neither complete nor perfectly
correct at any given instance: Not all bugs are reported,
and some reported bugs may have been fixed, but the
repository not yet updated.

Some bug fixes are difficult to verify because they pertain
to specific hardware or operating system versions. If you
have information to contribute, please do so.

If you happen to know how to fix a problem please send
patches to the bug repository, too.

New bugs are reported either through the web
interface at r-bugs.biostat.ku.dk or via email to
r-bugs@biostat.ku.dk. The bug.report() function can be
used to automate parts of the procedure on many systems.
Followups on older bugs can be done by including the string
"(PR#999)" in the Subject of an email (change 999 to the
actual reference number, of course!).
=================================================

Directory:  Accuracy

none

Directory:  Add-ons

* PR# 503 *
Subject: dmvnorm() bug in e1071
From: "Gregory R. Warnes" <warnes@biostat.washington.edu>
Date: Fri, 24 Mar 2000 03:24:45 +0000 (GMT)
* PR# 496 *
From: bonneau@epi.roazhon.inra.fr (en148)
Date: Tue, 21 Mar 2000 10:57:13 +0100 (MET)
--base R has no est.variogram function.
--This appears to be a bug report on sgeostat.
* PR# 471 *
Subject:  Problems with nlme 
From: Berwin Turlach <berwin@maths.uwa.edu.au>
Date: Tue, 7 Mar 2000 15:28:00 +0800
--Problem 1) was a subscripting bug introduced in 1.0.0 and fixed for 1.0.1
--Problem 2) (mssing datasets) needs a revised nlme

Directory:  Analyses

none

Directory:  Documentation

* PR# 497 *
Subject: par help wrong: xlog & ylog
From: wsi@gcal.ac.uk
Date: Tue, 21 Mar 2000 14:57:57 +0100 (MET)

Directory:  Graphics

* PR# 495 *
Subject: barplot
From: skala@incoma.cz
Date: Tue, 21 Mar 2000 09:20:33 +0100 (MET)
* PR# 202 *
Subject: persp box occlusion bug
From: wsi@gcal.ac.uk
Date: Wed, 2 Jun 1999 15:02:03 +0200 (MET DST)
--The persp algorithm does not apply the occlusion rules to the frame, 
--which is always plotted first. 
--A bug, but not very simple to fix.
* PR# 414 *
Subject:  graphics bugs: steep slopes and large values beyond ylim 
From: Ben Bolker <bolker@zoo.ufl.edu>
Date: Mon, 7 Feb 2000 18:28:04 -0500
--Followup on R-devel showed this was due to generating integer coordinates 
--outside +/- 2^15 in the X11 driver.
* PR# 400 *
Subject: X11 troubles
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 13 Jan 2000 14:31:42 +0100
--a) We don't handle multiple window closes well
--b) X11 errors should be caught by an error handler, not kill R
* PR# 494 *
Subject:  minor problem in barplot legend 
From: Ben Bolker <bolker@zoo.ufl.edu>
Date: Mon, 20 Mar 2000 17:31:36 -0500
* PR# 483 *
Subject: error in par option xaxt
From: aim@uwo.ca
Date: Mon, 13 Mar 2000 22:02:42 +0100 (MET)

Directory:  In-Out

none

Directory:  Installation

* PR# 485 *
Subject: Install R1.0.0
From: Lynn Zhang <lyzhang@umich.edu>
Date: Mon, 13 Mar 2000 16:10:52 -0500 (EST)
* PR# 478 *
Subject: Conditional for XDR code left out in saveload.c
From: hoffmann@ehmgs2.et.tu-dresden.de
Date: Thu, 9 Mar 2000 09:43:01 +0100 (MET)
--This seems to be a harmless warning, not an error.
* PR# 467 *
Subject: Re: [R] Re: R-1.0.0 is released
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 01 Mar 2000 20:26:40 +0100
--followup to PR#466
* PR# 466 *
Subject: Re: R-1.0.0 is released
From: bhoel@server.python.net (Berthold=?iso-8859-1?q?_H=F6llmann?=)
Date: 01 Mar 2000 16:00:54 +0100

Directory:  Language

* PR# 412 *
Subject: anomalies with call objects
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 06 Feb 2000 01:18:50 +0100
* PR# 408 *
Subject: convolution bug
From: wsimpson@gcal.ac.uk
Date: Fri, 28 Jan 2000 11:17:36 +0100 (MET)

Directory:  Low-level

* PR# 500 *
Subject:  segmentation fault with 1D array 
From: J.C.Rougier@durham.ac.uk
Date: Wed, 22 Mar 2000 18:25:24 GMT
* PR# 391 *
Subject: Segfault in dataentry()
From: Peter Dalgaard BSA <p.dalgaard@pubhealth.ku.dk>
Date: 29 Dec 1999 11:59:50 +0100
--dataentry(0,0) segfaults

Directory:  Misc

none

Directory:  Models

none

Directory:  Startup

* PR# 486 *
Subject: Re: autoload error in profile {was anova-bug in R-version  1.0.0?}
From: Martin Maechler <maechler@stat.math.ethz.ch>
Date: Tue, 14 Mar 2000 10:32:43 +0100 (MET)

Directory:  System-specific

* PR# 490 *
Subject: R-1.0.0 on alpha/osf1 memory glitch
From: Ray Brownrigg <Ray.Brownrigg@mcs.vuw.ac.nz>
Date: Fri, 17 Mar 2000 11:25:30 +1300 (NZDT)
* PR# 452 *
Subject: problem with glm
From: Brad McNeney <mcneney@cs.sfu.ca>
Date: Fri, 18 Feb 2000 17:51:54 -0800 (PST)
--Problems on Alpha's with glm. Status unclear

Directory:  TooMuchAtOnce

none

Directory:  Windows

none

Directory:  incoming

* PR# 510 *
Subject:  Strange behaviour of image 
From: J.C.Rougier@durham.ac.uk
Date: Thu, 6 Apr 2000 19:15:19 +0100 (BST)
* PR# 488 *
Subject: Error in lme?
From: simon.frost@ed.ac.uk
Date: Tue, 14 Mar 2000 14:15:52 +0100 (MET)
--No example to reproduce this.
* PR# 463 *
Subject: Bug in read.table
From: "E. S. Venkatraman" <venkat@biosta.mskcc.org>
Date: Tue, 29 Feb 2000 17:47:54 -0500 (EST)
--looks like quote arguments to read.table/count.fields needs to be set
* PR# 505 *
Subject: interrupted save 
From: Thomas Lumley <thomas@biostat.washington.edu>
Date: Sat, 25 Mar 2000 12:16:50 -0800 (PST)
* PR# 498 *
Subject: Use of Rd2txt on .Rd files from rw-1.0.0
Subject: Use of Rd2txt on .Rd files from rw-1.0.0
From: John Maindonald <john.maindonald@anu.edu.au>
Date: Wed, 22 Mar 2000 09:15:20 +1100 (EST)
--No response from author, but does look like using CRLF files on Unix.
* PR# 507 *
Subject: another save/load problem, only(?) affecting ascii = TRUE
From: Martin Maechler <maechler@stat.math.ethz.ch>
Date: Mon, 3 Apr 2000 14:37:50 +0200 (CEST)
* PR# 506 *
Subject: matlines, matpoints don't follow prototype
From: "Charles C. Berry" <cberry@tajo.ucsd.edu>
Date: Sun, 26 Mar 2000 12:51:24 -0800
* PR# 509 *
Subject: write.table with rows and cols
From: edd@debian.org
Date: Tue, 4 Apr 2000 01:23:32 +0200 (MET DST)
* PR# 508 *
Subject: cbind.ts(),ts.union()
From: koller2@fgr.wu-wien.ac.at
Date: Mon, 3 Apr 2000 20:08:11 +0200 (MET DST)
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Fri Apr  7 07:17:13 2000
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Fri, 7 Apr 2000 08:17:13 +0200 (CEST)
Subject: [Rd] Re: [R] Perl v5.6.0 breaks the configure script
In-Reply-To: <Pine.GSO.4.05.10004051414570.1837-100000@auk.stats>
References: <20000405083728.A29748@eddelbuettel.com>
 <Pine.GSO.4.05.10004051414570.1837-100000@auk.stats>
Message-ID: <14573.32105.668793.488172@aragorn.ci.tuwien.ac.at>

>>>>> Prof Brian D Ripley writes:

> On Wed, 5 Apr 2000, Dirk Eddelbuettel wrote:
>> 
>> On Wed, Apr 05, 2000 at 10:31:57AM +0100, Prof Brian D Ripley wrote:
>> > On Wed, 5 Apr 2000, tom kennedy wrote:
>> [..] 
>> > I think the trick is to use perl itself, as in
>> > 
>> > perl_version=`${PERL} -e '$v=$]; $v =~ s/(.)\..*/\1/;print $v'`
>> > 
>> > as perl is guaranteed to return its version as a number like 5.006
>> > even for `v5.6.0'.
>> > 
>> > Unfortunately the "]" in there confuses m4 when building configure
>> > from aclocal.m4, but I am sure the experts can fix that.

Guess this means that I am not an autoconf expert any more.

>> 
>> One would be to use the English module and PERL_VERSION instead:
>> 
>> perl_version=
>> = `${PERL}-MEnglish  -e '$v=$PERL_VERSION; $v =~ s/(.)\..*/\1/;print $v'`
>> 
>> > One could even do the whole test in Perl:
>> > 
>> > r_cv_prog_perl_v5=
>> > `${PERL} -e 'if($] >= 5) {print "yes";} else {print "no"}'`
>> 
>> Likewise:
>> 
>> r_cv_prog_perl_v5=
>> `${PERL} -MEnglish -e 'if($] >= 5) {print "yes";} else {print "no"}'`
> Um, not that but I think we know what you meant!

> Yes, I know and I considered that, but I do not think the English
> module is guaranteed to be present. This is a test of the Perl
> version, and as far as I could see -MEnglish does not work in Perl 4.
> (The -M flag is not in the Quick Reference Guide for 4.019.)  So I
> think your version assumes the thing it is testing for, Perl 5.x.

I also think we should not assume that English is there.

Anyway, I tried adding a line of code to configure.in which uses $], but
I failed miserably ... I would either get M4 syntax errors or not get
the `]'.  Hence, I changed the test to

    AC_CACHE_CHECK([whether perl version is at least 5],
      r_cv_prog_perl_v5,
      [ ${PERL} -e 'require 5' 2>/dev/null
        if test ${?} -eq 0; then
          r_cv_prog_perl_v5=yes
        else
          r_cv_prog_perl_v5=no
        fi
      ])

which I think should also do the job.

Changed in r-devel only.  If anyone thinks we should also do this in
r-release for 1.0.1, pls let me know && I will make the change (assuming
that the fix is correct).

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Fri Apr  7 07:28:47 2000
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Fri, 7 Apr 2000 07:28:47 +0100 (BST)
Subject: [Rd] Re: [R] Perl v5.6.0 breaks the configure script
In-Reply-To: <14573.32105.668793.488172@aragorn.ci.tuwien.ac.at>
Message-ID: <Pine.GSO.4.05.10004070722320.23146-100000@auk.stats>

On Fri, 7 Apr 2000, Kurt Hornik wrote:

> Anyway, I tried adding a line of code to configure.in which uses $], but
> I failed miserably ... I would either get M4 syntax errors or not get
> the `]'.  Hence, I changed the test to
> 
>     AC_CACHE_CHECK([whether perl version is at least 5],
>       r_cv_prog_perl_v5,
>       [ ${PERL} -e 'require 5' 2>/dev/null
>         if test ${?} -eq 0; then
>           r_cv_prog_perl_v5=yes
>         else
>           r_cv_prog_perl_v5=no
>         fi
>       ])
> 
> which I think should also do the job.

Can anyone test this?  Again, I thought of that, and `require number'
is not in my Perl 4 book.  So although I think it will fail on Perl4,
I am not sure.  In any case, it is safer than what went before.

> Changed in r-devel only.  If anyone thinks we should also do this in
> r-release for 1.0.1, pls let me know && I will make the change (assuming
> that the fix is correct).

Yes, I think it should be changed. We want 1.0.1 to configure under the 
current Perl, which is the only easy one to find.

Brian

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From maechler@stat.math.ethz.ch  Fri Apr  7 10:35:45 2000
From: maechler@stat.math.ethz.ch (maechler@stat.math.ethz.ch)
Date: Fri, 7 Apr 2000 11:35:45 +0200 (MET DST)
Subject: [Rd] matlines, matpoints don't follow prototype (PR#506)
Message-ID: <200004070935.LAA08246@pubhealth.ku.dk>

>>>>> "ChuckB" == Charles C Berry <cberry@tajo.ucsd.edu> writes:

    ChuckB> The Blue Book allows the 'type' argument to be used in matpoints and
    ChuckB> matlines.

    ChuckB>	matlines(x, y, type="l", lty=1:5, pch=, col=1:4)

    ChuckB> R-1.0.0 does not.

    ChuckB> Thus, type="h", "b", must be invoked thru matplot( x, y, type = "h",
    ChuckB> add=TRUE)

    ChuckB> For the sake of consistency with S, it would be nice to have
    ChuckB> matlines defined as:

    ChuckB> "matlines" <-
    ChuckB> function(x, y, type = 'l', lty=1:5, lwd = 1, pch=NULL, col=1:6, ...)
    ChuckB> matplot(x=x, y=y, type=type, lty=lty, lwd=lwd, pch=pch, col=col,
    ChuckB> add=TRUE, ...)

    ChuckB> and similarly for matpoints.

You are right.

I've fixed it for the upcoming patch release (1.0.1).

Martin Maechler <maechler@stat.math.ethz.ch>	http://stat.ethz.ch/~maechler/
Seminar fuer Statistik, ETH-Zentrum  LEO D10	Leonhardstr. 27
ETH (Federal Inst. Technology)	8092 Zurich	SWITZERLAND
phone: x-41-1-632-3408		fax: ...-1228			<><

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Fri Apr  7 11:44:44 2000
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Fri, 7 Apr 2000 12:44:44 +0200 (CEST)
Subject: [Rd] Re: [R] Perl v5.6.0 breaks the configure script
In-Reply-To: <Pine.GSO.4.05.10004070722320.23146-100000@auk.stats>
References: <14573.32105.668793.488172@aragorn.ci.tuwien.ac.at>
 <Pine.GSO.4.05.10004070722320.23146-100000@auk.stats>
Message-ID: <14573.48156.91155.461519@aragorn.ci.tuwien.ac.at>

>>>>> Prof Brian D Ripley writes:

> On Fri, 7 Apr 2000, Kurt Hornik wrote:
>> Anyway, I tried adding a line of code to configure.in which uses $], but
>> I failed miserably ... I would either get M4 syntax errors or not get
>> the `]'.  Hence, I changed the test to
>> 
>> AC_CACHE_CHECK([whether perl version is at least 5],
>> r_cv_prog_perl_v5,
>> [ ${PERL} -e 'require 5' 2>/dev/null
>> if test ${?} -eq 0; then
>> r_cv_prog_perl_v5=yes
>> else
>> r_cv_prog_perl_v5=no
>> fi
>> ])
>> 
>> which I think should also do the job.

> Can anyone test this?  Again, I thought of that, and `require number'
> is not in my Perl 4 book.  So although I think it will fail on Perl4,
> I am not sure.  In any case, it is safer than what went before.

My idea was that if it fails in v4 it is fine anyway.  (Testing for a
feature only present in v5 is also a good test for v5.)

In fact:

khornik@sim:~$ perl4 -v

This is perl, version 4.0

$RCSfile: perl.c,v $$Revision: 4.0.1.8 $$Date: 1993/02/05 19:39:30 $
Patch level: 36

Copyright (c) 1989, 1990, 1991, Larry Wall

khornik@sim:~$ perl4 -e 'require 5'            
Can't locate 5 in @INC at /tmp/perl-ea22225 line 1.

hence:

khornik@sim:~$ perl4 -e 'require 5' 2>/dev/null
khornik@sim:~$ echo $?
2

>> Changed in r-devel only.  If anyone thinks we should also do this in
>> r-release for 1.0.1, pls let me know && I will make the change (assuming
>> that the fix is correct).

> Yes, I think it should be changed. We want 1.0.1 to configure under
> the current Perl, which is the only easy one to find.

Good enough?

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Fri Apr  7 12:26:22 2000
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 07 Apr 2000 13:26:22 +0200
Subject: [Rd] Re: [R] Perl v5.6.0 breaks the configure script
In-Reply-To: Kurt Hornik's message of "Fri, 7 Apr 2000 12:44:44 +0200 (CEST)"
References: <14573.32105.668793.488172@aragorn.ci.tuwien.ac.at> <Pine.GSO.4.05.10004070722320.23146-100000@auk.stats> <14573.48156.91155.461519@aragorn.ci.tuwien.ac.at>
Message-ID: <x2zor640f5.fsf@blueberry.kubism.ku.dk>

Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:


> khornik@sim:~$ perl4 -e 'require 5' 2>/dev/null
> khornik@sim:~$ echo $?
> 2
...
> Good enough?

Hmmmf... Well if it can't be otherwise, but the *right* solution would
seem to be

if perl -e 'exit 1 if $]<5' 
then
  r_cv_prog_perl_v5=yes
else
  r_cv_prog_perl_v5=no
fi
 

if it weren't for that %/&/%# m4 problem... (I'll see what I can dig up) 

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Thomas Vogels <tov@ece.cmu.edu>  Fri Apr  7 15:53:35 2000
From: Thomas Vogels <tov@ece.cmu.edu> (Thomas J Vogels)
Date: 07 Apr 2000 10:53:35 -0400
Subject: [Rd] Re: [R] MetaPost device?
In-Reply-To: Ross Ihaka's message of "Fri, 7 Apr 2000 10:02:31 +1200"
References: <005501bf9fd8$2697d420$9570fe8c@lucent.com> <x2ya6r2qea.fsf@blueberry.kubism.ku.dk> <20000406182908.A19743@sirio.stat.unipd.it> <20000407100231.A2998@stat1.stat.auckland.ac.nz>
Message-ID: <87d7o2hsi8.fsf@bavaria.ece.cmu.edu>


Ross Ihaka <ihaka@stat.auckland.ac.nz> writes:

> On Thu, Apr 06, 2000 at 06:29:08PM +0200, Guido Masarotto wrote:
> 
> >   The problem with MetaPost (if I understand well) is how
> >   you do get metric information about the fonts. 
> 
> The metric info problem is what stoped me writing the XFig driver.
> Which metrics do you use for Times-Roman for example -- the X11 metrics
> or the PostScript metrics?

I'll be sorry for this naive question, but if you limited the fonts
in the FIG output to LaTeX fonts, couldn't you use the LaTeX font
information?  (This doesn't solve the problem that what you see in an
X11 device is not what you get with dev.print which may or may not be
a good thing.)

  -tom

-- 
mailto:tov@ece.cmu.edu (Tom Vogels)   Tel: (412) 268-6638   FAX: -3204
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From dtrenkler@nts6.oec.uni-osnabrueck.de  Fri Apr  7 16:15:31 2000
From: dtrenkler@nts6.oec.uni-osnabrueck.de (dtrenkler@nts6.oec.uni-osnabrueck.de)
Date: Fri, 7 Apr 2000 17:15:31 +0200 (MET DST)
Subject: [Rd] Bug in qbinom? (PR#511)
Message-ID: <200004071515.RAA13504@pubhealth.ku.dk>

n_10;p_0.5;jjx_0:n;qbinom(pbinom(jjx,n,p),n,p) #  This one works as
expected

n_100;p_0.5;jjx_0:n;qbinom(pbinom(jjx,n,p),n,p)  # This one causes
severe problems

I cannot interrupt using ESC and I finally have to resort to the Windows
Task manager to kill the R session.
A friend of mine told me that he faced similar problems under Unix.



--please do not edit the information below--

Version:
 platform = Windows
 arch = x86
 os = Win32
 system = x86, Win32
 status = 
 major = 1
 minor = 0.0
 year = 2000
 month = February
 day = 29
 language = R

Windows NT 4.0 (build 1381) Service Pack 3

Search Path:
 .GlobalEnv, Autoloads, package:base




   --- D.Trenkler ---

************************************************************************
*********
   Dietrich Trenkler
(trenkler@oec.uni-osnabrueck.de)      
   Statistik / Empirische Wirtschaftsforschung
   Universitaet Osnabrueck
   Rolandstrasse 8                             Phone: +49(0)
541-969-2753
   D-49069 Osnabrueck                        Fax  : +49(0) 541-969-2745
   GERMANY
************************************************************************
*********




-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From thomas@biostat.washington.edu  Fri Apr  7 16:33:13 2000
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Fri, 7 Apr 2000 08:33:13 -0700 (PDT)
Subject: [Rd] Bug in qbinom? (PR#511)
In-Reply-To: <200004071515.RAA13504@pubhealth.ku.dk>
Message-ID: <Pine.GSO.4.21.0004070829110.20598-100000@mail.biostat.washington.edu>

On Fri, 7 Apr 2000 dtrenkler@nts6.oec.uni-osnabrueck.de wrote:

> n_10;p_0.5;jjx_0:n;qbinom(pbinom(jjx,n,p),n,p) #  This one works as
> expected
> 
> n_100;p_0.5;jjx_0:n;qbinom(pbinom(jjx,n,p),n,p)  # This one causes
> severe problems

The problem is in qbinom(1-epsilon,100,0.5) for epsilon between 10^-15 and
10^-17. It appears to go for ever.

> pbinom(jjx,n,p)[89]-1 
[1] -1.110223e-16

An even simpler version is
   qbinom(1-1e-16,2,0.5)

Presumably a check for zero needs some fuzz.

	-thomas

Thomas Lumley
Assistant Professor, Biostatistics
University of Washington, Seattle

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From tov@ece.cmu.edu  Fri Apr  7 16:53:25 2000
From: tov@ece.cmu.edu (tov@ece.cmu.edu)
Date: Fri, 7 Apr 2000 17:53:25 +0200 (MET DST)
Subject: [Rd] x11 colortype problems ('gray' is broken?) (PR#512)
Message-ID: <200004071553.RAA13862@pubhealth.ku.dk>


Hi,

  I occasionally run out of color in my X11 terminal.  At this
point, R will issue this error message:
        Error: X11 cannot allocate additional graphics colors.
Consider using colortype="pseudo.cube" or "gray".

An immediate x11(colortype="pseudo.cube") doesn't work as the
colortype seems to be shared among the different x11 plotting windows.
So I have to close all windows first, then I can open an x11 device
with the colortype "pseudo.cube".  (Neither the necessity to close all
windows nor the fact, that colortype is an option to X11 and not to
the plot command, is clear from the help pages or the error message.)

The real problem, however, comes with x11(colortype="gray") as this
brings up just a black screen (and it stays black).  I can't quite see
whether I'm stumbling across some issues with X resources, here.
x11() usually gives a white background.

Thanks,
  -tom


 --
platform = i586-unknown-linux
arch = i586
os = linux
system = i586, linux
status = 
major = 1
minor = 0.0
year = 2000
month = February
day = 29
language = R


-- 
mailto:tov@ece.cmu.edu (Tom Vogels)   Tel: (412) 268-6638   FAX: -3204


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From J.C.Rougier@durham.ac.uk  Fri Apr  7 17:04:17 2000
From: J.C.Rougier@durham.ac.uk (Jonathan Rougier)
Date: Fri, 7 Apr 2000 17:04:17 +0100 (BST)
Subject: [Rd] Strange behaviour of image (PR#510)
In-Reply-To: <x21z4jnk1b.fsf@blueberry.kubism.ku.dk>
Message-ID: <Pine.GSO.4.20.0004071656130.15072-100000@laplace>

Hi Peter,

On 6 Apr 2000, Peter Dalgaard BSA wrote:

> J.C.Rougier@durham.ac.uk writes:
> 
> > The following commands
> > 
> > z <- matrix(seq(0, 1, len=1000))
> > image(z, 1, z, zlim=c(0, 1), col=gray(1:10/10))
> > 
> > appear to violate the image functionality as described on the
> > help page.  As I understand it, by specifying a zlim of c(0, 1)
> > and a colour vector of length 10, the colours should correspond
> > to the intervals (0, 0.1), (0.1, 0.2), ..., (0.9, 1.0), this
> > being 10 equally-spaced intervals on (0, 1).  It is clear from
> > the image that this has not occurred.  In fact the intervals are
> > apparently (0, 1/18), (1/18, 3/18), ..., (15/18, 17/18), (17/18,
> > 1).  Have I misunderstood something?
> 
> I don't see that anything else is being promised...
> 
> If someone actually thought about this, then the choice might be
> related to the behavior at peaks and troughs. (since a circle with
> radius r looks wide compared to the region between two circles with
> diameter n*r and (n+1)*r)

I'm not quite sure I follow.  My feeling is that the displayed behaviour
of image is unreasonable, and, I hazard, not what most people who use
image expect.  I think the default behaviour of image should be to give
colour bands of equal widths, and, if I may append to the wish list, I
woud like to be able to specify a "breaks" argument to have unequal widths
should I so choose.

Cheers, Jonathan.

Jonathan Rougier                       Science Laboratories
Department of Mathematical Sciences    South Road
University of Durham                   Durham DH1 3LE
http://www.maths.dur.ac.uk/stats/people/jcr/jcr.html


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From thomas@biostat.washington.edu  Fri Apr  7 17:10:59 2000
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Fri, 7 Apr 2000 09:10:59 -0700 (PDT)
Subject: [Rd] Bug in qbinom? (PR#511)
In-Reply-To: <200004071515.RAA13504@pubhealth.ku.dk>
Message-ID: <Pine.GSO.4.21.0004070904390.20598-100000@mail.biostat.washington.edu>

On Fri, 7 Apr 2000 dtrenkler@nts6.oec.uni-osnabrueck.de wrote:

> n_10;p_0.5;jjx_0:n;qbinom(pbinom(jjx,n,p),n,p) #  This one works as
> expected
> 
> n_100;p_0.5;jjx_0:n;qbinom(pbinom(jjx,n,p),n,p)  # This one causes
> severe problems


In qbinom  we calculate an estimate y based on a Cornish-Fisher expansion
and then search up or down to the right number.  However, for p=1-1e-16 or
thereabouts we get

y=83931130944911952

which is bigger than 1/machine epsilon.  Thus y=y-1 and searching up or
down doesnt work.  A crude solution is to just treat this as p=1, but it
would be better to search up or down in bigger steps.

	-thomas


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From maechler@stat.math.ethz.ch  Fri Apr  7 17:23:38 2000
From: maechler@stat.math.ethz.ch (maechler@stat.math.ethz.ch)
Date: Fri, 7 Apr 2000 18:23:38 +0200 (MET DST)
Subject: [Rd] Bug in qbinom? (PR#511)
Message-ID: <200004071623.SAA14021@pubhealth.ku.dk>

>>>>> "TL" == Thomas Lumley <thomas@biostat.washington.edu> writes:

    TL> On Fri, 7 Apr 2000 dtrenkler@nts6.oec.uni-osnabrueck.de wrote:
    >> n_10;p_0.5;jjx_0:n;qbinom(pbinom(jjx,n,p),n,p) #  This one works as
    >> expected
    >> 
    >> n_100;p_0.5;jjx_0:n;qbinom(pbinom(jjx,n,p),n,p)  # This one causes
    >> severe problems

    TL> The problem is in qbinom(1-epsilon,100,0.5) for epsilon between
    TL> 10^-15 and 10^-17. It appears to go for ever.

    >> pbinom(jjx,n,p)[89]-1 
    TL> [1] -1.110223e-16

    TL> An even simpler version is
    TL> qbinom(1-1e-16,2,0.5)

    TL> Presumably a check for zero needs some fuzz.

Note that we (I) also have a considerable improvement for  dbinom() in the
pipeline, from  Clive Loader's post of a few weeks ago.

But this may be a completely orthogonal issue...
I will have a look over the weekend.

Martin

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Prof Brian Ripley <ripley@stats.ox.ac.uk>  Fri Apr  7 17:51:47 2000
From: Prof Brian Ripley <ripley@stats.ox.ac.uk> (Prof Brian Ripley)
Date: Fri, 7 Apr 2000 17:51:47 +0100 (BST)
Subject: [Rd] Strange behaviour of image (PR#510)
Message-ID: <200004071651.RAA15284@toucan.stats.ox.ac.uk>


> Date: Fri, 7 Apr 2000 17:04:17 +0100 (BST)
> From: Jonathan Rougier <J.C.Rougier@durham.ac.uk>
> 
> Hi Peter,
> 
> On 6 Apr 2000, Peter Dalgaard BSA wrote:
> 
> > J.C.Rougier@durham.ac.uk writes:
> > 
> > > The following commands
> > > 
> > > z <- matrix(seq(0, 1, len=1000))
> > > image(z, 1, z, zlim=c(0, 1), col=gray(1:10/10))
> > > 
> > > appear to violate the image functionality as described on the
> > > help page.  As I understand it, by specifying a zlim of c(0, 1)
> > > and a colour vector of length 10, the colours should correspond
> > > to the intervals (0, 0.1), (0.1, 0.2), ..., (0.9, 1.0), this
> > > being 10 equally-spaced intervals on (0, 1).  It is clear from
> > > the image that this has not occurred.  In fact the intervals are
> > > apparently (0, 1/18), (1/18, 3/18), ..., (15/18, 17/18), (17/18,
> > > 1).  Have I misunderstood something?
> > 
> > I don't see that anything else is being promised...
> > 
> > If someone actually thought about this, then the choice might be
> > related to the behavior at peaks and troughs. (since a circle with
> > radius r looks wide compared to the region between two circles with
> > diameter n*r and (n+1)*r)
> 
> I'm not quite sure I follow.  My feeling is that the displayed behaviour
> of image is unreasonable, and, I hazard, not what most people who use
> image expect.  I think the default behaviour of image should be to give
> colour bands of equal widths, and, if I may append to the wish list, I
> woud like to be able to specify a "breaks" argument to have unequal widths
> should I so choose.

I side with Jonathan.

(1) The prototype does as JCR describes: given 64 colours it allocates
1/64th of the space to each.

(2) Setting the break points seems a good idea to me (but can always be
faked by a non-linear monotonic transformation of z, as I have done
before now).

I suggest we do add a `breaks' arg and that we do change the default
at the level of the R code, perhaps with an oldstyle parameter.
OK?

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Fri Apr  7 17:59:22 2000
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 07 Apr 2000 18:59:22 +0200
Subject: [Rd] Strange behaviour of image (PR#510)
In-Reply-To: Prof Brian Ripley's message of "Fri, 7 Apr 2000 17:51:47 +0100 (BST)"
References: <200004071651.RAA15284@toucan.stats.ox.ac.uk>
Message-ID: <x2wvm93l05.fsf@blueberry.kubism.ku.dk>

Prof Brian Ripley <ripley@stats.ox.ac.uk> writes:

> I side with Jonathan.
> 
> (1) The prototype does as JCR describes: given 64 colours it allocates
> 1/64th of the space to each.
> 
> (2) Setting the break points seems a good idea to me (but can always be
> faked by a non-linear monotonic transformation of z, as I have done
> before now).
> 
> I suggest we do add a `breaks' arg and that we do change the default
> at the level of the R code, perhaps with an oldstyle parameter.
> OK?

OK with me. Didn't feel too strongly about in in the first place. But
perhaps somone else did since they did it that way?

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From thomas@biostat.washington.edu  Fri Apr  7 17:57:41 2000
From: thomas@biostat.washington.edu (thomas@biostat.washington.edu)
Date: Fri, 7 Apr 2000 18:57:41 +0200 (MET DST)
Subject: [Rd] Bug in qbinom? (PR#511)
Message-ID: <200004071657.SAA14316@pubhealth.ku.dk>


I've committed a fix to the development branch.  We now start searching at 
max(0,min(n,normal-approximation))

We still don't get  qbinom(pbinom(x,100,0.5))==x for x>86, but that's to
be expected. 


Thomas Lumley
Assistant Professor, Biostatistics
University of Washington, Seattle


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From erich.neuwirth@univie.ac.at  Sat Apr  8 01:35:06 2000
From: erich.neuwirth@univie.ac.at (Erich Neuwirth)
Date: Sat, 08 Apr 2000 02:35:06 +0200
Subject: [Rd] cannot compile on solaris
References: <200004071651.RAA15284@toucan.stats.ox.ac.uk> <x2wvm93l05.fsf@blueberry.kubism.ku.dk>
Message-ID: <38EE7EBA.36942CA@univie.ac.at>

on my old sun ipx with gcc and texinfo installed 
u run ./configure ok, and then i get

[szego@neuwirth:/install/R-1.0.0] make
make[1]: Entering directory `/install/R-1.0.0/tools'
make[1]: Nothing to be done for `R'.
make[1]: Leaving directory `/install/R-1.0.0/tools'
make[1]: Entering directory `/install/R-1.0.0/afm'
make[1]: Leaving directory `/install/R-1.0.0/afm'
make[1]: Entering directory `/install/R-1.0.0/doc'
false: false: cannot open
make[1]: *** [R] Error 1
make[1]: Leaving directory `/install/R-1.0.0/doc'
make: *** [R] Error 1

what is happening?
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ihaka@stat.auckland.ac.nz  Sat Apr  8 02:38:41 2000
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Sat, 8 Apr 2000 13:38:41 +1200
Subject: [Rd] Re: [R] MetaPost device?
In-Reply-To: <87d7o2hsi8.fsf@bavaria.ece.cmu.edu>; from Thomas J Vogels on Fri, Apr 07, 2000 at 10:53:35AM -0400
References: <005501bf9fd8$2697d420$9570fe8c@lucent.com> <x2ya6r2qea.fsf@blueberry.kubism.ku.dk> <20000406182908.A19743@sirio.stat.unipd.it> <20000407100231.A2998@stat1.stat.auckland.ac.nz> <87d7o2hsi8.fsf@bavaria.ece.cmu.edu>
Message-ID: <20000408133841.B1234@stat1.stat.auckland.ac.nz>

On Fri, Apr 07, 2000 at 10:53:35AM -0400, Thomas J Vogels wrote:
> 
> Ross Ihaka <ihaka@stat.auckland.ac.nz> writes:
> 
> > On Thu, Apr 06, 2000 at 06:29:08PM +0200, Guido Masarotto wrote:
> > 
> > >   The problem with MetaPost (if I understand well) is how
> > >   you do get metric information about the fonts. 
> > 
> > The metric info problem is what stoped me writing the XFig driver.
> > Which metrics do you use for Times-Roman for example -- the X11 metrics
> > or the PostScript metrics?
> 
> I'll be sorry for this naive question, but if you limited the fonts
> in the FIG output to LaTeX fonts, couldn't you use the LaTeX font
> information?  (This doesn't solve the problem that what you see in an
> X11 device is not what you get with dev.print which may or may not be
> a good thing.)

This is supposing that you can get get access to it.  I certainly don't
know enough about TeX to be able to parse tfm files.  If code existed to
compute the dimensions of strings then we'd be away.

Another problem the text output by TeX can be rather richly structured
-- kerning and glue come to mind.  I think a general solution might
require either writing a version of the TeX layout code for R, or running
TeX to compute metric information whenever a string is placed in a plot
(hmmmm actually this last might just be workable - if a little slow).

	Ross
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Sat Apr  8 08:05:26 2000
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Sat, 8 Apr 2000 08:05:26 +0100 (BST)
Subject: xfig device (was [Rd] Re: [R] MetaPost device?)
In-Reply-To: <20000408133841.B1234@stat1.stat.auckland.ac.nz>
Message-ID: <Pine.GSO.4.05.10004080721170.7242-100000@auk.stats>

On Sat, 8 Apr 2000, Ross Ihaka wrote:

> On Fri, Apr 07, 2000 at 10:53:35AM -0400, Thomas J Vogels wrote:
> > 
> > Ross Ihaka <ihaka@stat.auckland.ac.nz> writes:
> > 
> > > On Thu, Apr 06, 2000 at 06:29:08PM +0200, Guido Masarotto wrote:
> > > 
> > > >   The problem with MetaPost (if I understand well) is how
> > > >   you do get metric information about the fonts. 
> > > 
> > > The metric info problem is what stoped me writing the XFig driver.
> > > Which metrics do you use for Times-Roman for example -- the X11 metrics
> > > or the PostScript metrics?
> > 
> > I'll be sorry for this naive question, but if you limited the fonts
> > in the FIG output to LaTeX fonts, couldn't you use the LaTeX font
> > information?  (This doesn't solve the problem that what you see in an
> > X11 device is not what you get with dev.print which may or may not be
> > a good thing.)
> 
> This is supposing that you can get get access to it.  I certainly don't
> know enough about TeX to be able to parse tfm files.  If code existed to
> compute the dimensions of strings then we'd be away.

AFAIR no problem: many dvixx drivers such as dvips compute string widths at
least.  In dvips bbox.c computes the bounding box for a dvi file, and
thereby computes BB info for each string. In doing so it computes from the
tfm the llx,lly,urx,ury for each character.

However, I would be inclined to go the other way, and just use the
PostScript fonts and their metrics.  For a start, the X11 metrics are I
believe device-specific, and I would view xfig screen output as an
approximation to the final printed form. And it is that final form I want
to be accurate.

> Another problem the text output by TeX can be rather richly structured
> -- kerning and glue come to mind.
 
Are we not just discussing a xfig driver for R, and R's driver model only
writes single text strings at specified (x,y) locations?  So test output
from an R xfig driver would not be richly structured?  Yes, there is
kerning but there is using postscript fonts directly, surely?
By the time a dvixx driver is reading the dvi file the kerning has been
done, but the information is all there in the tfm, and the format is
readily available (e.g. in tftopl).

Brian

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Sat Apr  8 08:24:43 2000
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Sat, 8 Apr 2000 08:24:43 +0100 (BST)
Subject: [Rd] cannot compile on solaris
In-Reply-To: <38EE7EBA.36942CA@univie.ac.at>
Message-ID: <Pine.GSO.4.05.10004080813230.7242-100000@auk.stats>

On Sat, 8 Apr 2000, Erich Neuwirth wrote:

> on my old sun ipx with gcc and texinfo installed 
> u run ./configure ok, and then i get
> 
> [szego@neuwirth:/install/R-1.0.0] make
> make[1]: Entering directory `/install/R-1.0.0/tools'
> make[1]: Nothing to be done for `R'.
> make[1]: Leaving directory `/install/R-1.0.0/tools'
> make[1]: Entering directory `/install/R-1.0.0/afm'
> make[1]: Leaving directory `/install/R-1.0.0/afm'
> make[1]: Entering directory `/install/R-1.0.0/doc'
> false: false: cannot open
> make[1]: *** [R] Error 1
> make[1]: Leaving directory `/install/R-1.0.0/doc'
> make: *** [R] Error 1
> 
> what is happening?

false should be in /usr/bin/false:
auk% which false
/usr/bin/false
auk% ls -l `which false`
-r-xr-xr-x   1 bin      bin           314 Jul 16  1997 /usr/bin/false*

It is not clear from your output what this is trying to do: I get
auk% make -n R
/opt/R/cvs/R/tools/mkinstalldirs ../doc/html/search
cat /opt/R/cvs/R/doc/html/search/SearchEngine-head.html > \
  ../doc/html/search/SearchEngine.html
../tools/keywords2html /opt/R/cvs/R/doc/KEYWORDS.db >> \
  ../doc/html/search/SearchEngine.html
cat /opt/R/cvs/R/doc/html/search/SearchEngine-foot.html >> \
  ../doc/html/search/SearchEngine.html
if [ "/opt/R/cvs/R/doc" != "." ]; then \
  make rhome=.. install-html; \
  (cd manual && make R); \
fi
echo "installing doc ..."
...

so one of these is failing (and I think not the if clause as that should
echo something). Can you do the same and track down what has not been
created?


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Sat Apr  8 09:31:48 2000
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Sat, 8 Apr 2000 09:31:48 +0100 (BST)
Subject: [Rd] window(): feature request
In-Reply-To: <3.0.6.32.20000403182113.008f1bf0@fgr.wu-wien.ac.at>
Message-ID: <Pine.GSO.4.05.10004080927380.8001-100000@auk.stats>

On Mon, 3 Apr 2000, Wolfgang Koller wrote:

> Dear R-developpers,
> 
> currently the function window shows the following behaviour, if start or
> end is out of range:
> 
> > x <- ts(1:14,start=c(1950,2),frequency=4)
> > y <- window(x,start=c(1950,1),end=c(1953,4))
> Warning messages: 
> 1: start value not changed in: window.default(x, ...) 
> 2: end value not changed in: window.default(x, ...) 
> 
> Instead of this I would like it to fill with NAs the values before start(x)
> and after end(x). Could this be done by introducing an additional option in
> window()? Could you please consider this in future releases? Or is there a
> better way to do this using existing functions?

This is incompatible with S and the existing behaviour, so I have added a
new argument `extend' defaulting to FALSE. The new version is in the
R-devel distribution, so will not appear in a released version until 1.1.0.

> P.S.: Below I have added some code that accomplishes this aim in a separate
> function (which is probably an example of akward programming...).

[It does not handle matrix ts objects, for example, nor does it handle
changing the frequency.]

[code snipped.]

PS: R-bugs now has a `wishlist' section, so sending a feature request as a
bug report is a way to ensure it gets recorded.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Sat Apr  8 09:38:18 2000
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 08 Apr 2000 10:38:18 +0200
Subject: xfig device (was [Rd] Re: [R] MetaPost device?)
In-Reply-To: Prof Brian D Ripley's message of "Sat, 8 Apr 2000 08:05:26 +0100 (BST)"
References: <Pine.GSO.4.05.10004080721170.7242-100000@auk.stats>
Message-ID: <x2em8hyolh.fsf@blueberry.kubism.ku.dk>

Prof Brian D Ripley <ripley@stats.ox.ac.uk> writes:

> Are we not just discussing a xfig driver for R, and R's driver model only
> writes single text strings at specified (x,y) locations?  So test output
> from an R xfig driver would not be richly structured?  Yes, there is
> kerning but there is using postscript fonts directly, surely?
> By the time a dvixx driver is reading the dvi file the kerning has been
> done, but the information is all there in the tfm, and the format is
> readily available (e.g. in tftopl).

But what about plotmath? If we want to get the equivalent of
\alpha*\text{threshold}_i (say) to come out right then we need to know
the length of "threshold" in the relevant font... Of course you could
(potentially) get the driver to output actual TeX, but then you have
no inkling about the total size of the formula object, and it comes
out as TeX code inside XFig. Xfig is pretty much geared towards
postscript fonts, so I suppose the most practical thing to do is to
assume PS as the final target and accept the approximations caused by
the screen fonts while previewing. 

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Sat Apr  8 09:42:37 2000
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Sat, 8 Apr 2000 09:42:37 +0100 (BST)
Subject: [Rd] Strange behaviour of image (PR#510)
In-Reply-To: <200004071651.RAA15284@toucan.stats.ox.ac.uk>
Message-ID: <Pine.GSO.4.05.10004080932360.8001-100000@auk.stats>

On Fri, 7 Apr 2000, Prof Brian Ripley wrote:

> 
> > Date: Fri, 7 Apr 2000 17:04:17 +0100 (BST)
> > From: Jonathan Rougier <J.C.Rougier@durham.ac.uk>
> > 
> > Hi Peter,
> > 
> > On 6 Apr 2000, Peter Dalgaard BSA wrote:
> > 
> > > J.C.Rougier@durham.ac.uk writes:
> > > 
> > > > The following commands
> > > > 
> > > > z <- matrix(seq(0, 1, len=1000))
> > > > image(z, 1, z, zlim=c(0, 1), col=gray(1:10/10))
> > > > 
> > > > appear to violate the image functionality as described on the
> > > > help page.  As I understand it, by specifying a zlim of c(0, 1)
> > > > and a colour vector of length 10, the colours should correspond
> > > > to the intervals (0, 0.1), (0.1, 0.2), ..., (0.9, 1.0), this
> > > > being 10 equally-spaced intervals on (0, 1).  It is clear from
> > > > the image that this has not occurred.  In fact the intervals are
> > > > apparently (0, 1/18), (1/18, 3/18), ..., (15/18, 17/18), (17/18,
> > > > 1).  Have I misunderstood something?
> > > 
> > > I don't see that anything else is being promised...
> > > 
> > > If someone actually thought about this, then the choice might be
> > > related to the behavior at peaks and troughs. (since a circle with
> > > radius r looks wide compared to the region between two circles with
> > > diameter n*r and (n+1)*r)
> > 
> > I'm not quite sure I follow.  My feeling is that the displayed behaviour
> > of image is unreasonable, and, I hazard, not what most people who use
> > image expect.  I think the default behaviour of image should be to give
> > colour bands of equal widths, and, if I may append to the wish list, I
> > woud like to be able to specify a "breaks" argument to have unequal widths
> > should I so choose.
> 
> I side with Jonathan.
> 
> (1) The prototype does as JCR describes: given 64 colours it allocates
> 1/64th of the space to each.
> 
> (2) Setting the break points seems a good idea to me (but can always be
> faked by a non-linear monotonic transformation of z, as I have done
> before now).
> 
> I suggest we do add a `breaks' arg and that we do change the default
> at the level of the R code, perhaps with an oldstyle parameter.
> OK?

Now done for R-devel. The new version computes the indices into the colour
table in the R code so is much easier to customize.

help(image) did say

    zlim: the minimum and maximum `z' values for which colors will be
          plotted.  Each of the given colors will be used to color an
          equispaced interval of this range.

and what happened was that the midpoints of the colour grid covered the
range, so the lowest and highest z values which were plotted were smaller
and larger than as specified here.  I've altered the help file for 1.0.1.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Sat Apr  8 10:08:40 2000
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Sat, 8 Apr 2000 10:08:40 +0100 (BST)
Subject: xfig device (was [Rd] Re: [R] MetaPost device?)
In-Reply-To: <x2em8hyolh.fsf@blueberry.kubism.ku.dk>
Message-ID: <Pine.GSO.4.05.10004080943340.8001-100000@auk.stats>

On 8 Apr 2000, Peter Dalgaard BSA wrote:

> Prof Brian D Ripley <ripley@stats.ox.ac.uk> writes:
> 
> > Are we not just discussing a xfig driver for R, and R's driver model only
> > writes single text strings at specified (x,y) locations?  So test output
> > from an R xfig driver would not be richly structured?  Yes, there is
> > kerning but there is using postscript fonts directly, surely?
> > By the time a dvixx driver is reading the dvi file the kerning has been
> > done, but the information is all there in the tfm, and the format is
> > readily available (e.g. in tftopl).
> 
> But what about plotmath? If we want to get the equivalent of
> \alpha*\text{threshold}_i (say) to come out right then we need to know
> the length of "threshold" in the relevant font... Of course you could

Do you mean *width* of "threshold"?  That's exactly what I was envisaging.
Even to plot "threshold" centred you need to know its width and height and
depth: see GText.

As I understand it plotmath computes the locations of the pieces ("alpha"
and "threshold" and "i" in the example) and outputs them as separate
strings.  And as far as I can see plotmath does not use kerning information
(look at RenderStr in plotmath.c) to find the string's bounding box, even
though the postscript renderer will.  Similar, the GStrWidth for the 
postscript device just adds up the character widths and so ignores kerning.

> (potentially) get the driver to output actual TeX, but then you have
> no inkling about the total size of the formula object, and it comes
> out as TeX code inside XFig. Xfig is pretty much geared towards
> postscript fonts, so I suppose the most practical thing to do is to
> assume PS as the final target and accept the approximations caused by
> the screen fonts while previewing. 

I think I said that in part of my posting which you omitted!


Summary: 

R currently seems to ignore kerning in computing string dimensions.

Finding char info from tfm files is easy: there is lots of example code.

For an xfig device one could (at least initially) use the existing 
information on postscript fonts, and only allow those to be used in the
device.  I think the same applies to a metapost device.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Sat Apr  8 10:37:19 2000
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 08 Apr 2000 11:37:19 +0200
Subject: xfig device (was [Rd] Re: [R] MetaPost device?)
In-Reply-To: Prof Brian D Ripley's message of "Sat, 8 Apr 2000 10:08:40 +0100 (BST)"
References: <Pine.GSO.4.05.10004080943340.8001-100000@auk.stats>
Message-ID: <x2r9chhr1s.fsf@blueberry.kubism.ku.dk>

Prof Brian D Ripley <ripley@stats.ox.ac.uk> writes:

> > the length of "threshold" in the relevant font... Of course you could
> 
> Do you mean *width* of "threshold"?  

Um, yes. The *length* is 9, I suppose.

> > (potentially) get the driver to output actual TeX, but then you have
> > no inkling about the total size of the formula object, and it comes
> > out as TeX code inside XFig. Xfig is pretty much geared towards
> > postscript fonts, so I suppose the most practical thing to do is to
> > assume PS as the final target and accept the approximations caused by
> > the screen fonts while previewing. 
> 
> I think I said that in part of my posting which you omitted!

So you did. (I must have woken up too early today...) What I forgot to
add was something to the effect that as long as you keep formulas as
"compound objects" in XFig then it shouldn't be a major obstacle to
moving the labels around.

> R currently seems to ignore kerning in computing string dimensions.

..which we should probably fix at some point. Can't be that hard?
(BTW, I forget whether Postscript itself does kerning by default or
one has to use a special string operator to obtain it?)

Also, I suspect that some of the finer points of the Appendix G of the
TeXbook are getting lost -- the micro-spacing in formulas appear to be
not quite right.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Sat Apr  8 11:31:15 2000
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Sat, 8 Apr 2000 11:31:15 +0100 (BST)
Subject: [Rd] x11 colortype problems ('gray' is broken?) (PR#512)
In-Reply-To: <200004071553.RAA13862@pubhealth.ku.dk>
Message-ID: <Pine.GSO.4.05.10004081123590.6335-100000@auk.stats>

On Fri, 7 Apr 2000 tov@ece.cmu.edu wrote:

> 
> Hi,
> 
>   I occasionally run out of color in my X11 terminal.  At this
> point, R will issue this error message:
>         Error: X11 cannot allocate additional graphics colors.
> Consider using colortype="pseudo.cube" or "gray".
> 
> An immediate x11(colortype="pseudo.cube") doesn't work as the
> colortype seems to be shared among the different x11 plotting windows.
> So I have to close all windows first, then I can open an x11 device
> with the colortype "pseudo.cube".  (Neither the necessity to close all
> windows nor the fact, that colortype is an option to X11 and not to
> the plot command, is clear from the help pages or the error message.)

There is a single colortype shared by all x11 devices.  That couild eb
clearer!

> The real problem, however, comes with x11(colortype="gray") as this
> brings up just a black screen (and it stays black).  I can't quite see
> whether I'm stumbling across some issues with X resources, here.
> x11() usually gives a white background.

No. It's a bug.  When you set x11(colortype="gray") it tries to allocate
min(256, 2^depth) colours, that is all the colours on an 8-bit display.
That is clearly going to fail (unless perhaps your window manager is 
in mono).  So it does fail, set PaletteSize = 0, and then maps all
colours to black.  That's what the x11 driver seems to do when colour
allocation fails.  I suspect it should not open at all under those 
circumstances.

Quick fix:

static void SetupGrayScale()
{
    PaletteSize = 0;
    if (depth > 7)
	depth = 7;
    if (GetGrayPalette(display, colormap, 1 << depth) == 0)
	depth = 1;
}

(8 replaced by 7) in devX11.c.  I'll commit a more sophisticated one
to R-release.


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From erich.neuwirth@univie.ac.at  Sun Apr  9 10:23:26 2000
From: erich.neuwirth@univie.ac.at (Erich Neuwirth)
Date: Sun, 09 Apr 2000 11:23:26 +0200
Subject: [Rd] cannot compile on solaris
References: <Pine.GSO.4.05.10004080813230.7242-100000@auk.stats>
Message-ID: <38F04C0E.859AA7E8@univie.ac.at>

mystery solved.
the machine did not have perl installed.
BUT
probably there should be a more informative warning message,
and perhaps configure should complain more audibly.


Prof Brian D Ripley wrote:
> 
> On Sat, 8 Apr 2000, Erich Neuwirth wrote:
> 
> > on my old sun ipx with gcc and texinfo installed
> > u run ./configure ok, and then i get
> >
> > [szego@neuwirth:/install/R-1.0.0] make
> > make[1]: Entering directory `/install/R-1.0.0/tools'
> > make[1]: Nothing to be done for `R'.
> > make[1]: Leaving directory `/install/R-1.0.0/tools'
> > make[1]: Entering directory `/install/R-1.0.0/afm'
> > make[1]: Leaving directory `/install/R-1.0.0/afm'
> > make[1]: Entering directory `/install/R-1.0.0/doc'
> > false: false: cannot open
> > make[1]: *** [R] Error 1
> > make[1]: Leaving directory `/install/R-1.0.0/doc'
> > make: *** [R] Error 1
> >
> > what is happening?
> 
> false should be in /usr/bin/false:
> auk% which false
> /usr/bin/false
> auk% ls -l `which false`
> -r-xr-xr-x   1 bin      bin           314 Jul 16  1997 /usr/bin/false*
> 
> It is not clear from your output what this is trying to do: I get
> auk% make -n R
> /opt/R/cvs/R/tools/mkinstalldirs ../doc/html/search
> cat /opt/R/cvs/R/doc/html/search/SearchEngine-head.html > \
>   ../doc/html/search/SearchEngine.html
> ../tools/keywords2html /opt/R/cvs/R/doc/KEYWORDS.db >> \
>   ../doc/html/search/SearchEngine.html
> cat /opt/R/cvs/R/doc/html/search/SearchEngine-foot.html >> \
>   ../doc/html/search/SearchEngine.html
> if [ "/opt/R/cvs/R/doc" != "." ]; then \
>   make rhome=.. install-html; \
>   (cd manual && make R); \
> fi
> echo "installing doc ..."
> ...
> 
> so one of these is failing (and I think not the if clause as that should
> echo something). Can you do the same and track down what has not been
> created?
> 
> --
> Brian D. Ripley,                  ripley@stats.ox.ac.uk
> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> University of Oxford,             Tel:  +44 1865 272861 (self)
> 1 South Parks Road,                     +44 1865 272860 (secr)
> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
> 
> -.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
> r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
> Send "info", "help", or "[un]subscribe"
> (in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
> _._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Mon Apr 10 06:46:39 2000
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 10 Apr 2000 07:46:39 +0200
Subject: [Rd] R CMD build/check
Message-ID: <200004100546.HAA14716@aragorn.ci.tuwien.ac.at>

I would like to bring the attention of R package maintainers/developers
to the mechanisms for checking and building add-on packages that come
with the R distribution.

* R CMD check has been around for a while.  It can be used for run-time
testing the examples that come with an installed add-on package.  Recent
development versions of R also have preliminary support for additional
specific regression testing.

* R CMD build should be used for actually building the add-on packages,
in particular if you are planning to upload them to CRAN.  From the R
Extension Writers Guide:

	Prior to actually building the package in the common gzipped tar
	file format, a variety of diagnostic checks and cleanups are
	performed.  In particular, it is tested whether the
	`DESCRIPTION' file contains the required entries, whether object
	and data indices exist and can be assumed to be up-to-date,
	whether the documentation sources contain the required name,
	alias, title, description, and keyword information, and whether
	there are any undocumented user level objects.

Please try to eliminate all problems reported by the R package builder
before submitting a package to CRAN.

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Mon Apr 10 09:41:48 2000
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Mon, 10 Apr 2000 10:41:48 +0200 (CEST)
Subject: [Rd] R CMD build/check
In-Reply-To: <200004100546.HAA14716@aragorn.ci.tuwien.ac.at>
References: <200004100546.HAA14716@aragorn.ci.tuwien.ac.at>
Message-ID: <14577.37836.184592.123670@lynne.ethz.ch>

>>>>> "KH" == Kurt Hornik <hornik@ci.tuwien.ac.at> writes:

    KH> I would like to bring the attention of R package maintainers/developers
    KH> to the mechanisms for checking and building add-on packages that come
    KH> with the R distribution.

    KH> * R CMD check has been around for a while.  It can be used for run-time
    KH> testing the examples that come with an installed add-on package.  Recent
    KH> development versions of R also have preliminary support for additional
    KH> specific regression testing.

    KH> * R CMD build should be used for actually building the add-on packages,
    KH> in particular if you are planning to upload them to CRAN.  From the R
    KH> Extension Writers Guide:

    KH> Prior to actually building the package in the common gzipped tar
    KH> file format, a variety of diagnostic checks and cleanups are
    KH> performed.  In particular, it is tested whether the
    KH> `DESCRIPTION' file contains the required entries, whether object
    KH> and data indices exist and can be assumed to be up-to-date,
    KH> whether the documentation sources contain the required name,
    KH> alias, title, description, and keyword information, and whether
    KH> there are any undocumented user level objects.

    KH> Please try to eliminate all problems reported by the R package builder
    KH> before submitting a package to CRAN.

The "data index" is mentioned in the R Extensions Writer guide as
>> The subdirectory should contain a `00Index' file
>> that describes the datasets available.

Now since this is now required,  
what is the format of that file? what must/should it contain?
Shouldn't this be built automatically from the data's *.Rd files when it
doesn't exist?

Thanks for any clarification; the requirement of this 00Index has been new
for me (must have slept at some time in the past...).

Martin.
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Mon Apr 10 14:25:52 2000
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Mon, 10 Apr 2000 09:25:52 -0400
Subject: [Rd] 00Index of data
Message-ID: <38F1D65F.F70F0FFF@bank-banque-canada.ca>

The "data index" is mentioned in the R Extensions Writer guide as
>> The subdirectory should contain a `00Index' file
>> that describes the datasets available.

I'm not sure what the official format is suppose to be, but given that
it displays like an index, this has to be a very short description which
I find somewhat inadequate. Some of my data sets are multivariate time
series and it is impossible to describe them in such a brief format, so
I have resorted to very poor descriptions like "data used in ...".  It
would be nice to have a facility to give a more complete description of
the data.

Paul Gilbert

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Prof Brian Ripley <ripley@stats.ox.ac.uk>  Mon Apr 10 14:33:10 2000
From: Prof Brian Ripley <ripley@stats.ox.ac.uk> (Prof Brian Ripley)
Date: Mon, 10 Apr 2000 14:33:10 +0100 (BST)
Subject: [Rd] 00Index of data
Message-ID: <200004101333.OAA22020@toucan.stats.ox.ac.uk>


> Date: Mon, 10 Apr 2000 09:25:52 -0400
> From: Paul Gilbert <pgilbert@bank-banque-canada.ca>
> To: r-devel <r-devel@stat.math.ethz.ch>
> Subject: [Rd] 00Index of data
> 
> The "data index" is mentioned in the R Extensions Writer guide as
> >> The subdirectory should contain a `00Index' file
> >> that describes the datasets available.
> 
> I'm not sure what the official format is suppose to be, but given that
> it displays like an index, this has to be a very short description which
> I find somewhat inadequate. Some of my data sets are multivariate time
> series and it is impossible to describe them in such a brief format, so
> I have resorted to very poor descriptions like "data used in ...".  It
> would be nice to have a facility to give a more complete description of
> the data.

There is no restriction on the format.  The only use is with data()
to show what is available. But a few lines should suffice to 
indicate if it is worth looking up the help page for the data.
(And that needs a one-line title.)

The same comments apply to the INDEX file: you can let build
generate it, but several packages have hand-customised files (e.g.boot).

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Mon Apr 10 15:25:41 2000
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Mon, 10 Apr 2000 10:25:41 -0400
Subject: [Rd] 00Index of data
References: <200004101333.OAA22020@toucan.stats.ox.ac.uk>
Message-ID: <38F1E464.C7976425@bank-banque-canada.ca>

>the help page for the data.

Now that's something I didn't know about but is probably documented
somewhere that I missed. (No wonder I found the index rather
restrictive.) I now see it is reported as missing documentation by R CMD
build. (It is buried by all the other warnings.) I guess it should just
be an Rd file like the function help. Does a link get automatically
built from the 00Index of the data to the help for data or do I need to
point readers to the help? Or will the 00Index of the data get built
automatically from the titles in the data help files in the same way
that the function index is built? (And if so, how does it know the
documentation is for data?)

Thanks,
Paul Gilbert

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Prof Brian Ripley <ripley@stats.ox.ac.uk>  Mon Apr 10 15:31:49 2000
From: Prof Brian Ripley <ripley@stats.ox.ac.uk> (Prof Brian Ripley)
Date: Mon, 10 Apr 2000 15:31:49 +0100 (BST)
Subject: [Rd] 00Index of data
Message-ID: <200004101431.PAA22511@toucan.stats.ox.ac.uk>


> Date: Mon, 10 Apr 2000 10:25:41 -0400
> From: Paul Gilbert <pgilbert@bank-banque-canada.ca>
> To: Prof Brian Ripley <ripley@stats.ox.ac.uk>
> CC: r-devel@stat.math.ethz.ch
> Subject: Re: [Rd] 00Index of data
> 
> >the help page for the data.
> 
> Now that's something I didn't know about but is probably documented
> somewhere that I missed. (No wonder I found the index rather
> restrictive.) I now see it is reported as missing documentation by R CMD
> build. (It is buried by all the other warnings.) I guess it should just

When you solve all the others it will emerge more clearly :)

> be an Rd file like the function help. 

Yes, and `Writing R Extensions' tells you about making help files for data.
And the base system has them. (So does S-PLUS!)

> Does a link get automatically
> built from the 00Index of the data to the help for data or do I need to
> point readers to the help?

Readers are supposed to know to look for help on R *objects* (not
just functions).  Even the help.start intro says `Functions & Datasets'

>  Or will the 00Index of the data get built
> automatically from the titles in the data help files in the same way
> that the function index is built? (And if so, how does it know the
> documentation is for data?)

It does not get built, and help for data goes in INDEX. (That is
one reason why some of us prefer hand-crafted INDEX files.)
We are moving towards a way to distinguish the object type in a help file,
but are not there yet.


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Mon Apr 10 16:32:28 2000
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Mon, 10 Apr 2000 11:32:28 -0400
Subject: [Rd] R CMD build/check
References: <200004100546.HAA14716@aragorn.ci.tuwien.ac.at>
Message-ID: <38F1F40B.56C0A7B@bank-banque-canada.ca>

Let me start out by saying that after using "R CMD build" for a few days
it appears to be a truely wonderful facility, even if I didn't really
want to know about all the problems with my packages right now.

>Please try to eliminate all problems reported by the R package builder
>before submitting a package to CRAN.

Now here are a few caveates. Please let me know if  I'm not aware of
something that has already been fixed.

1/ I'm using a file 00General_Description.Rd to provide a general
description of the package. This gets reported as an Rd file without
alias, but even though the package builder reports that as a problem I
didn't intend to eliminate it.

2/ Specific methods get reported as undocumented functions unless the
generic documentation has an alias line for the specific method. This is
not a problem when everything is in one package, however, for many of my
specific methods  the generic method is in another of my packages or in
the base. (This can generate a lot of warning, which obscure more
important warnings.) I'm putting a "stub" description in to eliminate
all the warnings, but I'm not sure if this is the ideal way to do this.

3/ Data sets cannot use constructors in the package. They need to be
structures which can be fully recognized by the base system. (.rda files
may be a better alternative in this case?)

4/ R CMD build does not work for bundles, but it can be used to test
sub-packages and then the bundle rolled up afterwards directly with tar
and gzip. (This is not difficult and not a problem, but people should be
aware of it.)

Paul Gilbert

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Mon Apr 10 21:25:45 2000
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Mon, 10 Apr 2000 16:25:45 -0400
Subject: [Rd] 2 \alias{obj}
Message-ID: <38F238C8.DC36720B@bank-banque-canada.ca>

R CMD build does not seems to complain about an alias for the same
object in two different .Rd files. Should that be allowed? I don't see
when it would be legitimate.  (And I didn't intend to do this and would
have expected for a warning.)

Paul Gilbert

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Mon Apr 10 21:30:37 2000
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Mon, 10 Apr 2000 21:30:37 +0100 (BST)
Subject: [Rd] 2 \alias{obj}
In-Reply-To: <38F238C8.DC36720B@bank-banque-canada.ca>
Message-ID: <Pine.GSO.4.05.10004102128170.24235-100000@auk.stats>

On Mon, 10 Apr 2000, Paul Gilbert wrote:

> R CMD build does not seems to complain about an alias for the same
> object in two different .Rd files. Should that be allowed? I don't see
> when it would be legitimate.  (And I didn't intend to do this and would
> have expected for a warning.)

If you mean in the same package, just installing will object. (As with
survreg.old in survival5, Thomas.)  If in different packages, no ban!

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From telford@progsoc.uts.edu.au  Tue Apr 11 02:32:15 2000
From: telford@progsoc.uts.edu.au (Telford Tendys)
Date: Tue, 11 Apr 2000 11:32:15 +1000
Subject: xfig device (was [Rd] Re: [R] MetaPost device?)
In-Reply-To: <Pine.GSO.4.05.10004080943340.8001-100000@auk.stats>; from ripley@stats.ox.ac.uk on Sat, Apr 08, 2000 at 10:08:40AM +0100
References: <x2em8hyolh.fsf@blueberry.kubism.ku.dk> <Pine.GSO.4.05.10004080943340.8001-100000@auk.stats>
Message-ID: <20000411113215.E7411@ftoomsh.progsoc.uts.edu.au>

> Even to plot "threshold" centred you need to know its width and height and
> depth: see GText.

In xfig you can choose for a string to be centered and then give it
the string and the centre-point and it figures out the rest, it also
outputs this correctly centred despite font variations.

Admittedly, just being able to centre-justify a string doesn't solve
the problem of plotting an equation but it might help in a few cases...

Also, there is a ghostscript operator for getting the width of a string:

stringwidth

     * USAGE:   str stringwidth
     * RESULTS   x y

     calculates the change in the current point which would occur using
     "show", but doesn't actually draw the string
  
[http://www.colorado.edu/ITS/docs/scientific/gs/GSO.html]

Running up gs in the background in order to do font calculations
seems a bit messy but it would be easy to achieve and it kind of fits
with the unix philosophy of each program does it's own job well and
doesn't try to overlap its neighbour. Maybe it is fair to presume that
the win-32 users don't want xfig output? They probably want ms-draw or
something...

> As I understand it plotmath computes the locations of the pieces ("alpha"
> and "threshold" and "i" in the example) and outputs them as separate
> strings.  And as far as I can see plotmath does not use kerning information
> (look at RenderStr in plotmath.c) to find the string's bounding box, even
> though the postscript renderer will.  Similar, the GStrWidth for the 
> postscript device just adds up the character widths and so ignores kerning.

Yeah, I've noticed that some of the R outputs don't look quite as good as
latex but they still look better than just about any other plotter. Sometimes
I get latex to splat the formulas down onto the diagrams which is a dirty
trick but the reader of the printed copy only sees the end result not the
method.

> Finding char info from tfm files is easy: there is lots of example code.
> 
> For an xfig device one could (at least initially) use the existing 
> information on postscript fonts, and only allow those to be used in the
> device.  I think the same applies to a metapost device.

Which would make the xfig-device depend on having tex installed which seems
kind of illogical but no worse than insisting that gs in installed. Most
people who use xfig also use both tex and gs. Perhaps R could look around
for tfm files, use them if it finds them, and resort to counting the
characters if it can't think of anything better to do (i.e. some output
with small kerning errors is better than no output at all).

	- Tel
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Tue Apr 11 07:25:50 2000
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Tue, 11 Apr 2000 07:25:50 +0100 (BST)
Subject: xfig device (was [Rd] Re: [R] MetaPost device?)
In-Reply-To: <20000411113215.E7411@ftoomsh.progsoc.uts.edu.au>
Message-ID: <Pine.GSO.4.05.10004110718120.4502-100000@auk.stats>

On Tue, 11 Apr 2000, Telford Tendys wrote:

> > Even to plot "threshold" centred you need to know its width and height and
> > depth: see GText.
> 
> In xfig you can choose for a string to be centered and then give it
> the string and the centre-point and it figures out the rest, it also
> outputs this correctly centred despite font variations.

Eh?  R allows proportional centring (adj can be between 0 and 1) and my
point was that the R driver model *requires* the knowledge. As I said, see
the code for GText.

> Admittedly, just being able to centre-justify a string doesn't solve
> the problem of plotting an equation but it might help in a few cases...
> 
> Also, there is a ghostscript operator for getting the width of a string:
> 
> stringwidth
> 
>      * USAGE:   str stringwidth
>      * RESULTS   x y
> 
>      calculates the change in the current point which would occur using
>      "show", but doesn't actually draw the string
>   
> [http://www.colorado.edu/ITS/docs/scientific/gs/GSO.html]
> 
> Running up gs in the background in order to do font calculations
> seems a bit messy but it would be easy to achieve and it kind of fits
> with the unix philosophy of each program does it's own job well and
> doesn't try to overlap its neighbour. Maybe it is fair to presume that
> the win-32 users don't want xfig output? They probably want ms-draw or
> something...

It's not fair, and they also want postscript and the code for this in
postscript is already internal to R (less kerning, it seems).

My point, which you seem to have missed, is that existing code for font
metric information could be used in an xfig driver.

> > As I understand it plotmath computes the locations of the pieces ("alpha"
> > and "threshold" and "i" in the example) and outputs them as separate
> > strings.  And as far as I can see plotmath does not use kerning information
> > (look at RenderStr in plotmath.c) to find the string's bounding box, even
> > though the postscript renderer will.  Similar, the GStrWidth for the 
> > postscript device just adds up the character widths and so ignores kerning.
> 
> Yeah, I've noticed that some of the R outputs don't look quite as good as
> latex but they still look better than just about any other plotter. Sometimes
> I get latex to splat the formulas down onto the diagrams which is a dirty
> trick but the reader of the printed copy only sees the end result not the
> method.
> 
> > Finding char info from tfm files is easy: there is lots of example code.
> > 
> > For an xfig device one could (at least initially) use the existing 
> > information on postscript fonts, and only allow those to be used in the
> > device.  I think the same applies to a metapost device.
> 
> Which would make the xfig-device depend on having tex installed which seems
> kind of illogical but no worse than insisting that gs in installed. Most
> people who use xfig also use both tex and gs. Perhaps R could look around
> for tfm files, use them if it finds them, and resort to counting the
> characters if it can't think of anything better to do (i.e. some output
> with small kerning errors is better than no output at all).

Eh? If we restrict to postscript fonts we can use the afms which we already
have. There would be no need for tex at all.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From telford@progsoc.uts.edu.au  Tue Apr 11 08:21:44 2000
From: telford@progsoc.uts.edu.au (Telford Tendys)
Date: Tue, 11 Apr 2000 17:21:44 +1000
Subject: xfig device (was [Rd] Re: [R] MetaPost device?)
In-Reply-To: <Pine.GSO.4.05.10004110718120.4502-100000@auk.stats>; from ripley@stats.ox.ac.uk on Tue, Apr 11, 2000 at 07:25:50AM +0100
References: <20000411113215.E7411@ftoomsh.progsoc.uts.edu.au> <Pine.GSO.4.05.10004110718120.4502-100000@auk.stats>
Message-ID: <20000411172144.A22534@ftoomsh.progsoc.uts.edu.au>

On Tue, Apr 11, 2000 at 07:25:50AM +0100, Prof Brian D Ripley wrote:
> On Tue, 11 Apr 2000, Telford Tendys wrote:
> 
> > > Even to plot "threshold" centred you need to know its width and height and
> > > depth: see GText.
> > 
> > In xfig you can choose for a string to be centered and then give it
> > the string and the centre-point and it figures out the rest, it also
> > outputs this correctly centred despite font variations.
> 
> Eh?  R allows proportional centring (adj can be between 0 and 1) and my
> point was that the R driver model *requires* the knowledge. As I said, see
> the code for GText.

Hmm, OK xfig only supports left, right and centre, and now I look closer
at the drivers I see that there is a slot for a string width function.
I also notice the PS driver supports the string width function by simply
summing up the character widths from the afm (see the PostScriptStringWidth
function in devPS.c).

So I agree, make the assumption that all xfig fonts are postscript fonts and
share code with the PS driver for string width.

There should be a fancier implementation of the string width calculation
inside the GNU ghostscript source somewhere. Since that is GPL code it
should be OK to paste into R (adapting it should not be too difficult),
this would include all kerning stuff and would guarantee compatability
between the R driver and the printout (if I remember rightly, gs is built
from lots and lots of little source files, each one implementing one function).

> My point, which you seem to have missed, is that existing code for font
> metric information could be used in an xfig driver.

Yup, I'm with you now.

	- Tel
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From plummer@iarc.fr  Tue Apr 11 11:23:24 2000
From: plummer@iarc.fr (plummer@iarc.fr)
Date: Tue, 11 Apr 2000 12:23:24 +0200 (MET DST)
Subject: [Rd] start.ts, end.ts (PR#513)
Message-ID: <200004111023.MAA11374@pubhealth.ku.dk>

I'm having trouble with column-subsetting a multivariate time
series.  The underlying problem is with start().

R> x <- ts(matrix(rnorm(100), ncol=2))
R> y <- aggregate(x, ndeltat=2)
R> y[,1]
Error in ts(y, start = start(x), freq = frequency(x)) :
        invalid start
R> start(y)
[1] 2 1
R> frequency(y)
[1] 0.5

The point where the error occurs in ts() is:

    if(length(start) > 1) {
        if(start[2] > frequency) stop("invalid start")
        ...

IMHO the 2-vector notation for the start and end of a time series makes
sense only when the frequency is an integer (and I believe I have said
this before). S-PLUS seems to follow this convention:

S> x <- ts(rnorm(10), start=3, frequency=1/3)
S> start(x)
[1] 3
S> end(x)
[1] 30
S> x <- ts(rnorm(10), start=1/3, frequency=3)
S> start(x)
[1] 0 2
S> end(x)
[1] 3 2

whereas R gives c(0,2) in both cases.

My suggested fix is to edit start.default and end.default, replacing

if(abs(is-round(is)) < ts.eps)

with

if(abs(tsp[3] - round(tsp[3])) < ts.eps && abs(is - round(is)) < ts.eps)

Martyn

--please do not edit the information below--

Version:
 platform = i686-unknown-linux
 arch = i686
 os = linux
 system = i686, linux
 status =
 major = 1
 minor = 0.0
 year = 2000
 month = February
 day = 29
 language = R

Search Path:
 .GlobalEnv, Autoloads, package:base



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From plummer@iarc.fr  Tue Apr 11 11:27:28 2000
From: plummer@iarc.fr (plummer@iarc.fr)
Date: Tue, 11 Apr 2000 12:27:28 +0200 (MET DST)
Subject: [Rd] aggregate.ts (PR#514)
Message-ID: <200004111027.MAA11464@pubhealth.ku.dk>

aggregate.ts does not behave in the same way as the equivalent
method aggregate.rts in S-PLUS. In particular it
- changes the start of the time series
- tends to have a length which is 1 shorter

For example:

R> x <- ts(1:10)
R> aggregate(x, nfreq=0.5, FUN=min)
Time Series:
Start = 2 
End = 8 
Frequency = 0.5 
[1] 2 4 6 8

S> x <- rts(1:10)
S> aggregate(x, nf=0.5, fun = min)
[1] 1 3 5 7 9
 start deltat frequency 
     1      2       0.5

I have edited the aggregate.ts function to reproduce the S-PLUS
behaviour, which I find more intuitive:

old:
    #nstart <- ceiling(tsp(x)[1] * nfrequency)/nfrequency
    #x <- as.matrix(window(x, start = nstart))
new:    
    nstart <- tsp(x)[1]
    # Can't use nstart <- start(x) as this causes problems if
    # you get a vector of length 2.
    x <- as.matrix(x)

I have tried this on a range of examples and have not encountered
any problems, but of course I may be missing something.

Martyn

--please do not edit the information below--

Version:
 platform = i686-unknown-linux
 arch = i686
 os = linux
 system = i686, linux
 status =
 major = 1
 minor = 0.0
 year = 2000
 month = February
 day = 29
 language = R

Search Path:
 .GlobalEnv, Autoloads, package:base

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Tue Apr 11 14:44:27 2000
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Tue, 11 Apr 2000 09:44:27 -0400
Subject: [Rd] 2 \alias{obj}
References: <Pine.GSO.4.05.10004102128170.24235-100000@auk.stats>
Message-ID: <38F32C3B.E25D17D8@bank-banque-canada.ca>

>> R CMD build does not seems to complain about an alias for the same
>> object in two different .Rd files. Should that be allowed? I don't see
>> when it would be legitimate.  (And I didn't intend to do this and would
>> have expected for a warning.)

>If you mean in the same package, just installing will object. (As with
>survreg.old in survival5, Thomas.)

Ok, thanks. I was just revising documentation and running R CMD build, not
re-installing. I see now that install gives a warning.

>If in different packages, no ban!

Is this considered a problem or are there situations were it really makes sense
(other than to perpetuate the problem of name space conflicts)?

Paul Gilbert



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Tue Apr 11 14:53:39 2000
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Tue, 11 Apr 2000 14:53:39 +0100 (BST)
Subject: [Rd] 2 \alias{obj}
In-Reply-To: <38F32C3B.E25D17D8@bank-banque-canada.ca>
Message-ID: <Pine.GSO.4.05.10004111450100.8685-100000@auk.stats>

On Tue, 11 Apr 2000, Paul Gilbert wrote:

> >> R CMD build does not seems to complain about an alias for the same
> >> object in two different .Rd files. Should that be allowed? I don't see
> >> when it would be legitimate.  (And I didn't intend to do this and would
> >> have expected for a warning.)
> 
> >If you mean in the same package, just installing will object. (As with
> >survreg.old in survival5, Thomas.)
> 
> Ok, thanks. I was just revising documentation and running R CMD build, not
> re-installing. I see now that install gives a warning.

Before the final build, we expect you to have

1) INSTALL-ed successfully
2) run R CMD check
3) run Rd2dvi on the man directory

and I guess this should be in the R-exts manual.

> >If in different packages, no ban!
> 
> Is this considered a problem or are there situations were it really makes sense
> (other than to perpetuate the problem of name space conflicts)?

Well, once upon a time package ts had enhanced versions of some of the 
functions in base, with enhanced docs too, and on S MASS has enhanced
versions of functions in base and survival5, with enhanced docs.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Tue Apr 11 17:08:09 2000
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 11 Apr 2000 18:08:09 +0200
Subject: [Rd] cannot compile on solaris
In-Reply-To: <38F04C0E.859AA7E8@univie.ac.at>
References: <Pine.GSO.4.05.10004080813230.7242-100000@auk.stats>
 <38F04C0E.859AA7E8@univie.ac.at>
Message-ID: <200004111608.SAA15146@aragorn.ci.tuwien.ac.at>

>>>>> Erich Neuwirth writes:

> mystery solved.  the machine did not have perl installed.  BUT
> probably there should be a more informative warning message, and
> perhaps configure should complain more audibly.

O.k., improved now.

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Wed Apr 12 07:24:05 2000
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 12 Apr 2000 08:24:05 +0200 (CEST)
Subject: [Rd] 00Index of data
In-Reply-To: <200004101431.PAA22511@toucan.stats.ox.ac.uk>
References: <200004101431.PAA22511@toucan.stats.ox.ac.uk>
Message-ID: <14580.5765.300868.265594@aragorn.ci.tuwien.ac.at>

>>>>> Prof Brian Ripley writes:

>> Date: Mon, 10 Apr 2000 10:25:41 -0400
>> From: Paul Gilbert <pgilbert@bank-banque-canada.ca>
>> To: Prof Brian Ripley <ripley@stats.ox.ac.uk>
>> CC: r-devel@stat.math.ethz.ch
>> Subject: Re: [Rd] 00Index of data
>> 
>> >the help page for the data.
>> 
>> Now that's something I didn't know about but is probably documented
>> somewhere that I missed. (No wonder I found the index rather
>> restrictive.) I now see it is reported as missing documentation by R CMD
>> build. (It is buried by all the other warnings.) I guess it should just

> When you solve all the others it will emerge more clearly :)

:-)

>> be an Rd file like the function help. 

> Yes, and `Writing R Extensions' tells you about making help files for
> data.  And the base system has them. (So does S-PLUS!)

>> Does a link get automatically
>> built from the 00Index of the data to the help for data or do I need to
>> point readers to the help?

> Readers are supposed to know to look for help on R *objects* (not just
> functions).  Even the help.start intro says `Functions & Datasets'

>> Or will the 00Index of the data get built
>> automatically from the titles in the data help files in the same way
>> that the function index is built? (And if so, how does it know the
>> documentation is for data?)

> It does not get built, and help for data goes in INDEX. (That is one
> reason why some of us prefer hand-crafted INDEX files.)  We are moving
> towards a way to distinguish the object type in a help file, but are
> not there yet.

Correction: R CMD build will try to build/update the documentation index
(`INDEX') as well as the data index (`data/00Index').  The latter, as I
think Paul expected, happens by taking the names of all Rd files that
contain the keyword `datasets' (which again shows how important it is to
eliminate all warnings about Rd files without keywords etc).

The problem is that package developers might register more (or less)
information in their INDEX than obtained via this procedure.  E.g., if
an Rd file documents more than one object, the alias mechanism ensures
that documentation for all objects is found, but it is not smart enough
to ensure that all objects documented get a corresponding index entry.

The solution would be to introduce something like

	\index{NAME}{DESCRIPTION}

lines in the Rd files, and in fact have the index built from these lines
exclusively rather than the names.  But first we must know what `NAME'
exactly should be here, e.g. whether we only want to list *OBJECTS* in
the index or *ALL* topics being documented.

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Wed Apr 12 07:29:38 2000
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 12 Apr 2000 08:29:38 +0200 (CEST)
Subject: [Rd] R CMD build/check
In-Reply-To: <38F1F40B.56C0A7B@bank-banque-canada.ca>
References: <200004100546.HAA14716@aragorn.ci.tuwien.ac.at>
 <38F1F40B.56C0A7B@bank-banque-canada.ca>
Message-ID: <14580.6098.971883.305959@aragorn.ci.tuwien.ac.at>

>>>>> Paul Gilbert writes:

> Let me start out by saying that after using "R CMD build" for a few days
> it appears to be a truely wonderful facility, even if I didn't really
> want to know about all the problems with my packages right now.

>> Please try to eliminate all problems reported by the R package builder
>> before submitting a package to CRAN.

> Now here are a few caveates. Please let me know if  I'm not aware of
> something that has already been fixed.

> 1/ I'm using a file 00General_Description.Rd to provide a general
> description of the package. This gets reported as an Rd file without
> alias, but even though the package builder reports that as a problem I
> didn't intend to eliminate it.

The rule is as follows (from the R Extension Writers guide):

  `\alias{TOPIC}'
     The `\alias' entries specify all "topics" the file documents.
     This information (together with the file name) is collected into
     index data bases for lookup by the on-line (plain text and HTML)
     help systems.

     There may be several `\alias' entries.  Quite often it is
     convenient to document several R objects in one file.  For example,
     file `Normal.Rd' documents the density, distribution function,
     quantile function and generation of random variates for the normal
     distribution, and hence starts with

          \name{Normal}
          \alias{dnorm}
          \alias{pnorm}
          \alias{qnorm}
          \alias{rnorm}

     Note that the name of the file is not necessarily a topic
     documented.

Hence, an Rd file without an alias is pointless because it does not
register any topic it provides information for.

> 2/ Specific methods get reported as undocumented functions unless the
> generic documentation has an alias line for the specific method. This
> is not a problem when everything is in one package, however, for many
> of my specific methods the generic method is in another of my packages
> or in the base. (This can generate a lot of warning, which obscure
> more important warnings.) I'm putting a "stub" description in to
> eliminate all the warnings, but I'm not sure if this is the ideal way
> to do this.

Not sure if I understand this correctly.  If you have a specific method
say foo.dse then you'd have

  \alias{foo.dse}

etc.  So why would this be undocumented?

> 3/ Data sets cannot use constructors in the package. They need to be
> structures which can be fully recognized by the base system. (.rda
> files may be a better alternative in this case?)

Yes.  I will add something on this to the R-exts.

> 4/ R CMD build does not work for bundles, but it can be used to test
> sub-packages and then the bundle rolled up afterwards directly with
> tar and gzip. (This is not difficult and not a problem, but people
> should be aware of it.)

I should add something on this too.  Perhaps, Paul, once you release dse
as a package bundle I can try to make R CMD build work for bundles, too.

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From plummer@iarc.fr  Wed Apr 12 10:55:37 2000
From: plummer@iarc.fr (plummer@iarc.fr)
Date: Wed, 12 Apr 2000 11:55:37 +0200 (MET DST)
Subject: [Rd] For wishlist: sanity checks for subsets in lm, glm (PR#515)
Message-ID: <200004120955.LAA22235@pubhealth.ku.dk>

I got stung by this yesterday:

R> x <- seq(0,1,length=101)
R> y <- x + rnorm(101)/5
R> test.data <- data.frame(x=x, y=y, cond=(x <= 0.5))
R> # A perfect fit! But very implausible parameter estimates.
R> glm(y ~ x, data=test.data, subset=cond)

Call:  glm(formula = y ~ x, data = test.data, subset = cond) 

Coefficients:
(Intercept)            x  
    -0.1283      29.5571  

Degrees of Freedom: 100 Total (i.e. Null);  99 Residual
Null Deviance:      2.206 
Residual Deviance: 3.929e-32    AIC: -7477 
R> # Here's why ...
R> test.data2 <- test.data[test.data$cond, ]
R> table(test.data2$x, test.data2$y)
      
       -0.128278372512167 0.167292488167292
  0                    50                 0
  0.01                  0                51
R> # ... I just replicated the first two rows
R> test.data[1:2,]
     x          y cond
1 0.00 -0.1282784 TRUE
2 0.01  0.1672925 TRUE

Now, I admit that this isn't a bug. I should have used

R> test.data <- data.frame(x=x, y=y, cond=I(x <= 0.5))

to preserve cond as a logical vector, as documented in the help for
data.frame.  However, it is still very unpleasant behaviour, and no
warnings were issued.  I can't help thinking that some sanity checks on
the subset argument could have helped me.

So I suggest that the subset argument should either be
* A logical vector of the same length as the number of rows in the data
  frame, or
* A numeric vector of unique integers
to ensure that we really do get a subset of the data frame. The more
flexible behaviour of "[.data.frame" really isn't required here.

Martyn

--please do not edit the information below--

Version:
 platform = i686-unknown-linux
 arch = i686
 os = linux
 system = i686, linux
 status =
 major = 1
 minor = 0.0
 year = 2000
 month = February
 day = 29
 language = R

Search Path:
 .GlobalEnv, Autoloads, package:base

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Wed Apr 12 11:12:59 2000
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 12 Apr 2000 12:12:59 +0200
Subject: [Rd] For wishlist: sanity checks for subsets in lm, glm (PR#515)
In-Reply-To: plummer@iarc.fr's message of "Wed, 12 Apr 2000 11:55:37 +0200 (MET DST)"
References: <200004120955.LAA22235@pubhealth.ku.dk>
Message-ID: <x2purv39w4.fsf@blueberry.kubism.ku.dk>

plummer@iarc.fr writes:

> to preserve cond as a logical vector, as documented in the help for
> data.frame.  However, it is still very unpleasant behaviour, and no
> warnings were issued.  I can't help thinking that some sanity checks on
> the subset argument could have helped me.
> 
> So I suggest that the subset argument should either be
> * A logical vector of the same length as the number of rows in the data
>   frame, or
> * A numeric vector of unique integers
> to ensure that we really do get a subset of the data frame. The more
> flexible behaviour of "[.data.frame" really isn't required here.

Might be a good idea. Mind you, Splus 3.4 does exatly the same thing,
and I'm a little worried that the uniqueness assumption might kill
some bootstrapping applications:

 glm(y ~ x, data=test.data, subset=sample(seq(along=y),replace=T))


-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From plummer@iarc.fr  Wed Apr 12 11:55:55 2000
From: plummer@iarc.fr (Martyn Plummer)
Date: Wed, 12 Apr 2000 12:55:55 +0200 (CEST)
Subject: [Rd] For wishlist: sanity checks for subsets in lm, glm (PR#
In-Reply-To: <x2purv39w4.fsf@blueberry.kubism.ku.dk>
Message-ID: <XFMail.000412125555.plummer@iarc.fr>

On 12-Apr-00 Peter Dalgaard BSA wrote:
> Might be a good idea. Mind you, Splus 3.4 does exatly the same thing,
> and I'm a little worried that the uniqueness assumption might kill
> some bootstrapping applications:
> 
>  glm(y ~ x, data=test.data, subset=sample(seq(along=y),replace=T))

Splus 5.1 doesn't do this, because it preserves logical vectors in
data frames (but then perhaps comparisons with S4 or SPlus 5.x are
irrelevant?)

I knew there would be a good reason not to implement this. My feeling
is that high level modelling functions should protect the  user as
much as possible. If you want more flexibility, you can always
program around it.

   temp.data <- test.data[sample(seq(along=y), replace=T),]
   glm(y ~x, data=temp.data)

This doesn't help with breaking existing code though.

Martyn
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Wed Apr 12 12:18:37 2000
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 12 Apr 2000 13:18:37 +0200
Subject: [Rd] For wishlist: sanity checks for subsets in lm, glm (PR#
In-Reply-To: Martyn Plummer's message of "Wed, 12 Apr 2000 12:55:55 +0200 (CEST)"
References: <XFMail.000412125555.plummer@iarc.fr>
Message-ID: <x2n1mz36uq.fsf@blueberry.kubism.ku.dk>

Martyn Plummer <plummer@iarc.fr> writes:

> On 12-Apr-00 Peter Dalgaard BSA wrote:
> > Might be a good idea. Mind you, Splus 3.4 does exatly the same thing,
> > and I'm a little worried that the uniqueness assumption might kill
> > some bootstrapping applications:
> > 
> >  glm(y ~ x, data=test.data, subset=sample(seq(along=y),replace=T))
> 
> Splus 5.1 doesn't do this, because it preserves logical vectors in
> data frames (but then perhaps comparisons with S4 or SPlus 5.x are
> irrelevant?)

They're sometimes relevant because they show what has been considered
a bug in 3.x... The convert-to-factor conventions in 3.x (and R) are
quite a bit of a pain in my opinion, but I'm afraid we're stuck with
them at least for the near future (we couldn't make an API change as
pervasive as that without bumping the major version number). 

> I knew there would be a good reason not to implement this. My feeling
> is that high level modelling functions should protect the  user as
> much as possible. If you want more flexibility, you can always
> program around it.

Maybe, but... Getting people to program around S/R differences in
their add-on packages haven't always been unproblematic.

What would also catch your case would be to disallow factors as subset
variables, and I can't think of any situation where subsetting with a
factor would occur naturally. Does 5.1 allow subsetting with factors?

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Wed Apr 12 12:16:21 2000
From: p.dalgaard@biostat.ku.dk (p.dalgaard@biostat.ku.dk)
Date: Wed, 12 Apr 2000 13:16:21 +0200 (MET DST)
Subject: [Rd] For wishlist: sanity checks for subsets in lm, glm (PR#
Message-ID: <200004121116.NAA23535@pubhealth.ku.dk>

Martyn Plummer <plummer@iarc.fr> writes:

> On 12-Apr-00 Peter Dalgaard BSA wrote:
> > Might be a good idea. Mind you, Splus 3.4 does exatly the same thing,
> > and I'm a little worried that the uniqueness assumption might kill
> > some bootstrapping applications:
> > 
> >  glm(y ~ x, data=test.data, subset=sample(seq(along=y),replace=T))
> 
> Splus 5.1 doesn't do this, because it preserves logical vectors in
> data frames (but then perhaps comparisons with S4 or SPlus 5.x are
> irrelevant?)

They're sometimes relevant because they show what has been considered
a bug in 3.x... The convert-to-factor conventions in 3.x (and R) are
quite a bit of a pain in my opinion, but I'm afraid we're stuck with
them at least for the near future (we couldn't make an API change as
pervasive as that without bumping the major version number). 

> I knew there would be a good reason not to implement this. My feeling
> is that high level modelling functions should protect the  user as
> much as possible. If you want more flexibility, you can always
> program around it.

Maybe, but... Getting people to program around S/R differences in
their add-on packages haven't always been unproblematic.

What would also catch your case would be to disallow factors as subset
variables, and I can't think of any situation where subsetting with a
factor would occur naturally. Does 5.1 allow subsetting with factors?

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Prof Brian Ripley <ripley@stats.ox.ac.uk>  Wed Apr 12 13:54:57 2000
From: Prof Brian Ripley <ripley@stats.ox.ac.uk> (Prof Brian Ripley)
Date: Wed, 12 Apr 2000 13:54:57 +0100 (BST)
Subject: [Rd] For wishlist: sanity checks for subsets in lm, glm (PR#
Message-ID: <200004121254.NAA22977@toucan.stats.ox.ac.uk>

> From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
> Date: 12 Apr 2000 13:18:37 +0200
> 
> Martyn Plummer <plummer@iarc.fr> writes:
> 
> > On 12-Apr-00 Peter Dalgaard BSA wrote:
> > > Might be a good idea. Mind you, Splus 3.4 does exatly the same thing,
> > > and I'm a little worried that the uniqueness assumption might kill
> > > some bootstrapping applications:
> > > 
> > >  glm(y ~ x, data=test.data, subset=sample(seq(along=y),replace=T))
> > 
> > Splus 5.1 doesn't do this, because it preserves logical vectors in
> > data frames (but then perhaps comparisons with S4 or SPlus 5.x are
> > irrelevant?)
> 
> They're sometimes relevant because they show what has been considered
> a bug in 3.x... The convert-to-factor conventions in 3.x (and R) are
> quite a bit of a pain in my opinion, but I'm afraid we're stuck with
> them at least for the near future (we couldn't make an API change as
> pervasive as that without bumping the major version number). 

I would argue for changing the behaviour of converting logicals for 1.1.
It's a rare case, breaks almost nothing (as evidenced by the lack
of problems with S-PLUS 5.x) and would be helpful. Character vars
are another matter.

> > I knew there would be a good reason not to implement this. My feeling
> > is that high level modelling functions should protect the  user as
> > much as possible. If you want more flexibility, you can always
> > program around it.
> 
> Maybe, but... Getting people to program around S/R differences in
> their add-on packages haven't always been unproblematic.
> 
> What would also catch your case would be to disallow factors as subset
> variables, and I can't think of any situation where subsetting with a
> factor would occur naturally. Does 5.1 allow subsetting with factors?

Yes, exactly as before.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Wed Apr 12 19:34:40 2000
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Wed, 12 Apr 2000 14:34:40 -0400
Subject: [Rd] R CMD build/check
References: <200004100546.HAA14716@aragorn.ci.tuwien.ac.at>
 <38F1F40B.56C0A7B@bank-banque-canada.ca> <14580.6098.971883.305959@aragorn.ci.tuwien.ac.at>
Message-ID: <38F4C1C0.5B781B8C@bank-banque-canada.ca>

 >`\alias{TOPIC}'
 >    The `\alias' entries specify all "topics" the file documents.

Ok. I thought TOPIC had to be an object. (In fact, I thought I was
getting another error message if it wasn't, but I must have been
mistaken as it works fine now.)

>> 2/ Specific methods get reported as undocumented functions unless the

>> generic documentation has an alias line for the specific method. This

>> is not a problem when everything is in one package, however, for many

>> of my specific methods the generic method is in another of my
packages
>> or in the base. (This can generate a lot of warning, which obscure
>> more important warnings.) I'm putting a "stub" description in to
>> eliminate all the warnings, but I'm not sure if this is the ideal way

>> to do this.

>Not sure if I understand this correctly.  If you have a specific method

>say foo.dse then you'd have
> \alias{foo.dse}
>etc.  So why would this be undocumented?

It is not a problem if everything is in one package. But when that is
not the case things are a bit more complicated. For example, I have a
method print.TSdata and the documention for "print" is in base so
instead of just putting an \alias{print.TSdata} in with the
documentation for print, I need to make a little "stub"  .Rd with
\name{print.something} and put all my \alias{print.*'s in that. The same
applies to print.summary and other generic methods in the base.

In addition to the base, I have a lot of generic methods defined in my
tframe package. DSE defines specific methods for these, so the same
problem occurs. I guess in this case I could put the alias for the
specific methods in with the tframe package, but I like to think of
tframe as self-contained and expect not to need to update it as
frequently as I might add new things to DSE.

I've now gone from about 600 undocument function on my first R CMD build
down to about 100. Most of the 500 fixed have just been additional
aliases, and probably 3/4 of them had to be put in these "stub" files
because the generic method was not in the same package. (But it is worth
the trouble, I now have a much better idea where the documentation
truely is weak.)

>> 4/ R CMD build does not work for bundles, but it can be used to test
>> sub-packages and then the bundle rolled up afterwards directly with
>> tar and gzip. (This is not difficult and not a problem, but people
>> should be aware of it.)

>I should add something on this too.  Perhaps, Paul, once you release
dse
>as a package bundle I can try to make R CMD build work for bundles,
too.

ok, but I wouldn't treat it as any sort of priority. Testing the
individual packages and then rolling up the bundle seems to work pretty
well.

Paul Gilbert


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From erich.neuwirth@univie.ac.at  Wed Apr 12 22:40:19 2000
From: erich.neuwirth@univie.ac.at (Erich Neuwirth)
Date: Wed, 12 Apr 2000 23:40:19 +0200
Subject: [Rd] xgobin on win95
References: <200004100546.HAA14716@aragorn.ci.tuwien.ac.at>
 <38F1F40B.56C0A7B@bank-banque-canada.ca> <14580.6098.971883.305959@aragorn.ci.tuwien.ac.at> <38F4C1C0.5B781B8C@bank-banque-canada.ca>
Message-ID: <38F4ED43.23B81778@univie.ac.at>

i finally managed to install brians latest version of
xgobi and the r interface to it on win95.
i am running exceed 6.1
it works,
but clone xgobi (within xgobi) does not work.
has anybody made clone xgobi run on win95 (or win98)?
how about w2k?

additionally,
set DISPLAY=localhost
does not work
i do have
localhost 	127.0.0.1
in my hosts file, nonetheless i get an error message
when i try to start xgobi (standalone or from within r)

any ideas about that?
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From erich.neuwirth@univie.ac.at  Wed Apr 12 22:44:48 2000
From: erich.neuwirth@univie.ac.at (Erich Neuwirth)
Date: Wed, 12 Apr 2000 23:44:48 +0200
Subject: [Rd] xgobi, footnote
References: <200003212215.XAA03296@pubhealth.ku.dk>
Message-ID: <38F4EE4F.DDE280CA@univie.ac.at>

XIO:  fatal IO error 104 (Connection reset by peer) on X server
"localhost:0.0"
after 0 requests (0 known processed) with 0 events remaining.

is the error message i get when DISPLAY=localhost:0.0
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From erich.neuwirth@univie.ac.at  Wed Apr 12 23:25:50 2000
From: erich.neuwirth@univie.ac.at (Erich Neuwirth)
Date: Thu, 13 Apr 2000 00:25:50 +0200
Subject: [Rd] xgobi, second footnote
References: <200003212215.XAA03296@pubhealth.ku.dk> <38F4EE4F.DDE280CA@univie.ac.at>
Message-ID: <38F4F7EE.1A36D4E3@univie.ac.at>

updgrading to exceed 6.2
solved the localhost display problem.


Erich Neuwirth wrote:
> 
> XIO:  fatal IO error 104 (Connection reset by peer) on X server
> "localhost:0.0"
> after 0 requests (0 known processed) with 0 events remaining.
> 
> is the error message i get when DISPLAY=localhost:0.0
> -.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
> r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
> Send "info", "help", or "[un]subscribe"
> (in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
> _._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Thu Apr 13 07:07:37 2000
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Thu, 13 Apr 2000 07:07:37 +0100 (BST)
Subject: [Rd] xgobin on win95
In-Reply-To: <38F4ED43.23B81778@univie.ac.at>
Message-ID: <Pine.GSO.4.05.10004130658240.17187-100000@auk.stats>

On Wed, 12 Apr 2000, Erich Neuwirth wrote:

> i finally managed to install brians latest version of
> xgobi and the r interface to it on win95.
> i am running exceed 6.1
> it works,
> but clone xgobi (within xgobi) does not work.
> has anybody made clone xgobi run on win95 (or win98)?

Yes, people have, but there have been several reports of problems from
people who have not followed the instructions. Have you read and followed
all the instructions in the README (like having a suitable shell at
/bin/sh?  On Win9x you may need to ensure that DISPLAY is set as a global
environmental variable.  Note that as Win9x has quite a broken fork,
spawning processes like this is known to give problems.

> how about w2k?

Don't know, but that is really NT, where it does work.

> additionally,
> set DISPLAY=localhost
> does not work
> i do have
> localhost 	127.0.0.1
> in my hosts file, nonetheless i get an error message
> when i try to start xgobi (standalone or from within r)
> 
> any ideas about that?

Should be localhost:0.0 (see the README and xgobi.bat)

BTW, I think this is off-topic for R-devel, and the README in that
distribution does explicitly say that it is unsupported.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From erich.neuwirth@univie.ac.at  Thu Apr 13 12:20:57 2000
From: erich.neuwirth@univie.ac.at (Erich Neuwirth)
Date: Thu, 13 Apr 2000 13:20:57 +0200
Subject: [Rd] xgobi in R on win95
References: <200004121254.NAA22977@toucan.stats.ox.ac.uk>
Message-ID: <38F5AD99.83150CA3@univie.ac.at>

this time,
it is REALLY a bug in the r code for the xgobi interface.
on win95, at least in my configuration,
xgobi(...,multi=TRUE)
does not work.

the temp files R creates are deleted before
the xgobi process gets a chance to read the files.

the culprit is

  on.exit(file.remove(tmpfiles)) 

on windows95, this deletes the files too early.

changing it to
        if(!multi) { on.exit(file.remove(tmpfiles)) }

solves the problem, but of course has the side effect
of leaving the the temporary files on the machine.
i do not understand enough of the mechanics of the system calls 
involved (yet) to do a full repair myself.


my xgobi only questions to this list were cause by the fact
thet multi=TRUE did not work, therefore i tried to use
clone xgobi, which did not work either.
it still does not work, despice the fatc that i think i
read and followed the instructions carefully.

erich
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From duncan@research.bell-labs.com  Thu Apr 13 12:44:09 2000
From: duncan@research.bell-labs.com (Duncan Temple Lang)
Date: Thu, 13 Apr 2000 07:44:09 -0400 (EDT)
Subject: [Rd] xgobi in R on win95
Message-ID: <200004131144.HAA03413@jessie.research.bell-labs.com>


> Date: Thu, 13 Apr 2000 13:20:57 +0200
> From: Erich Neuwirth <erich.neuwirth@univie.ac.at>
> Organization: University of Vienna
> CC: r-devel@stat.math.ethz.ch
> References: <200004121254.NAA22977@toucan.stats.ox.ac.uk>
> Sender: owner-r-devel@stat.math.ethz.ch
> Precedence: bulk
> 
> this time,
> it is REALLY a bug in the r code for the xgobi interface.
> on win95, at least in my configuration,
> xgobi(...,multi=TRUE)
> does not work.
> 
> the temp files R creates are deleted before
> the xgobi process gets a chance to read the files.
> 
> the culprit is
> 
>   on.exit(file.remove(tmpfiles)) 
> 
> on windows95, this deletes the files too early.
> 
> changing it to
>         if(!multi) { on.exit(file.remove(tmpfiles)) }
> 
> solves the problem, but of course has the side effect
> of leaving the the temporary files on the machine.
> i do not understand enough of the mechanics of the system calls 
> involved (yet) to do a full repair myself.
> 
> 
> erich


The lack of synchronization is a fundamental limitation of this style
of inter-process communication. One has to add crude hacks that are
bound to fail under someones configuration in the absence of more
coherent, formal and hence predictable, debuggable approaches are
needed. 

We have two such approaches. Ross, Debby Swayne and I have, at
different times, made modifications to xgobi to allow one to
communicate with it via CORBA.  Combined with the R-CORBA package,
dynamic remote control and query of xgobi is quite simple. With this
approach, the data is transferred directly and no messing with file
systems, timing, etc is needed.

The second approach is to allow XGobi be dynamically loaded into the R
session as a shared library.  I started about a week ago and most of
that is functional (since it shares much of the functionality added
via the CORBA server), but I won't get back to it until next week.
One of the motivations for embedding XGobi into R (& S) is to look at
event-loop integration, with the potential to lead to connections
and/or (internal) threads.  It would be good to know if there is any
interest in having this embedded version for regular use (on Unix,
since it would run in the R process). Otherwise it may not be worth
the effort packaging it up that carefully.

D.

-- 
_______________________________________________________________

Duncan Temple Lang                duncan@research.bell-labs.com
Bell Labs, Lucent Technologies    office: (908)582-3217
700 Mountain Avenue, Room 2C-259  fax:    (908)582-3340
Murray Hill, NJ  07974-2070       
         http://cm.bell-labs.com/stat/duncan

      "Languages shape the way we think, and determine what 
       we can think about."        
                                      Benjamin Whorf
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Thu Apr 13 15:45:55 2000
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Thu, 13 Apr 2000 16:45:55 +0200 (CEST)
Subject: [Rd] Embedding Xgobi into R
In-Reply-To: <200004131144.HAA03413@jessie.research.bell-labs.com>
References: <200004131144.HAA03413@jessie.research.bell-labs.com>
Message-ID: <14581.56739.292151.347850@lynne.ethz.ch>


>>>>> "Duncan" == Duncan Temple Lang <duncan@research.bell-labs.com> writes:

      .............

    Duncan> The second approach is to allow XGobi be dynamically loaded
    Duncan> into the R session as a shared library.  I started about a week
    Duncan> ago and most of that is functional (since it shares much of the
    Duncan> functionality added via the CORBA server), but I won't get back
    Duncan> to it until next week.  One of the motivations for embedding
    Duncan> XGobi into R (& S) is to look at event-loop integration, with
    Duncan> the potential to lead to connections and/or (internal) threads.
    Duncan> It would be good to know if there is any interest in having
    Duncan> this embedded version for regular use (on Unix, since it would
    Duncan> run in the R process).

I'm interested very much!

{Now showing my complete ignorance:}
I assume this would not rely on any CORBA server availability, right?

    Duncan> Otherwise it may not be worth the effort
    Duncan> packaging it up that carefully.

Martin
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From kohnicho@comp.nus.edu.sg  Thu Apr 13 17:08:57 2000
From: kohnicho@comp.nus.edu.sg (Nicholas Lewin-Koh)
Date: Fri, 14 Apr 2000 00:08:57 +0800 (SST)
Subject: [Rd] xgobi in R on win95
In-Reply-To: <200004131144.HAA03413@jessie.research.bell-labs.com>
Message-ID: <Pine.OSF.4.21.0004140004460.4962-100000@decunx.comp.nus.edu.sg>

Hi,
Debby Swayne is working on a new version of xgobi (now called ggobi). I
have been working with her and we have succeeded in compiling (and
running) the preliminary version native on windows. No more emulation! all
it needs is a com interface and it can communicate directly with R. We
will be putting out some test versions soon, so comments (and help) would
be appreciated.

Nicholas


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Prof Brian Ripley <ripley@stats.ox.ac.uk>  Thu Apr 13 18:04:29 2000
From: Prof Brian Ripley <ripley@stats.ox.ac.uk> (Prof Brian Ripley)
Date: Thu, 13 Apr 2000 18:04:29 +0100 (BST)
Subject: [Rd] XFig device
Message-ID: <200004131704.SAA00170@toucan.stats.ox.ac.uk>

After all the discussion I decided to act, and wrote an XFig device
(for the standard postscript fonts only) which is now in R-devel.
Also, I implementing kerning for the postscript() device.

One thing someone may be able to help me with. XFig 3.2 implements
multiple pages, but does not say in the FORMAT how to split the file
into pages.  If anyone knows, please let me know. (Some reading of the
code suggested this was perhaps not implemented except for printing.)

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From sergei@stams.strath.ac.uk  Fri Apr 14 13:14:29 2000
From: sergei@stams.strath.ac.uk (sergei@stams.strath.ac.uk)
Date: Fri, 14 Apr 2000 14:14:29 +0200 (MET DST)
Subject: [Rd] bundle build and Rd2Sd converion fail (PR#519)
Message-ID: <200004141214.OAA16983@pubhealth.ku.dk>

Dear R-core,
Thank you for your great effort! I am finalising a bundle that works both in
R and Splus. But I faced the following minor problems with R CMD under both
UNIX and LINUX.
1. R CMD build denies to work with bundles. It reports
* checking `DESCRIPTION' package entry ... ERROR: no package entry in 
`DESCRIPTION'
Surely, there is no one, but there is Contains entry.
Next, according to R-exts manual, the packages contained in the bundle need
not contain DESCRIPTION but DESCRIPTION.in file. So building individual bundle 
packages with R CMD does not work neither:
* checking for `DESCRIPTION' ... ERROR: file `DESCRIPTION' not found           

This does not prevent from installing the bundle, and surprisingly enough, 
DESCRIPTION file appears afterwards in all bundle packages! So building 
individual packages now become available (!?)
2. Writing Rd-documentation is much easier than nroff files. But as the 
packages are also working in Splus, I need to generate .d-files as well.
I tried the command below in R-1.0.0 and development version R-1.1 both under 
UNIX and LINUX and get the following error:
sherna man/ % R CMD Rdconv --type=Sd plot.mefista.Rd > plot.mefista.d
Undefined subroutine &main::text2nroff called at /auto/local/pkg/R-1.0.0/instal
l.stams/lib/R/etc/Rdconvlib.pl line 1412, <rdfile> chunk 33.
It would also be nice just to be able to type R CMD Rd2Sd ;-)
Waiting for your reaction.
Best wishes,
Sergei

=================================================================
                           Dr. Sergei ZUYEV
Statistics and Modelling Science dept., University of Strathclyde
    Livingston Tower, 26 Richmond str., Glasgow, G1 1XH, U.K.
     Tel.: +44 (0)141 548 3663    Fax:  +44 (0)141 552 2079
sergei@stams.strath.ac.uk   http://www.stams.strath.ac.uk/~sergei
=================================================================


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From sergei@stams.strath.ac.uk  Fri Apr 14 13:26:48 2000
From: sergei@stams.strath.ac.uk (sergei@stams.strath.ac.uk)
Date: Fri, 14 Apr 2000 14:26:48 +0200 (MET DST)
Subject: [Rd] Rd2Sd conversion: files (PR#520)
Message-ID: <200004141226.OAA17227@pubhealth.ku.dk>

This is a multipart MIME message.

--==_Exmh_-19086308140
Content-Type: text/plain; charset=us-ascii

In addition to my previous message, here is the source Rd-file that I used in

 R CMD Rdconv -d --type=Sd plot.mefista.Rd > plot.mefista.d

command.

--==_Exmh_-19086308140
Content-Type: text/plain ; name="plot.mefista.Rd"; charset=us-ascii
Content-Description: plot.mefista.Rd
Content-Disposition: attachment; filename="plot.mefista.Rd"

\name{plot.mefista}
\alias{plot.mefista}
\title{Plot an object of class mefista.}
\usage{
plot.mefista(mef,draw.style=NA,Space=mef$param$space,xgrid=mef$param$xgrid,
             ygrid=mef$param$ygrid,nlevels=15,ncolors=0,\dots)
}
%- maybe also `usage' for other objects documented here.
\arguments{
  \item{mef}{An object of class \code{mefista}.}
  \item{draw.style}{Values: 0 - linear, 1 - \code{\link{image}}, 2 -
    \code{\link{contour}}, 3 - \code{image()} \emph{and} \code{contour}
    superposed, 4 - \code{\link{persp}}.}
  \item{Space}{
  The state space of the measures. A vector or a matrix giving the
  coordinates of the points in each \emph{row} of the latter. If not
  supplied  it is defined as
  \code{expand.grid(xgrid, ygrid)} if the latter are available,
  otherwise it is considered to be \code{1:length(mu)}.}
\item{nlevels}{Number of levels used in \code{image} or \code{contour}
  plots.}
\item{ncolors}{Number of customized colors to be used in \code{image} or
  \code{contour} plots. If 0, the default color palette is used.}
\item{\dots}{Other plot parameters.}
}
\description{
Plots the gradient function and the measure given in an object of class
\code{mefista}.
}

\seealso{\code{\link{mefista}}, \code{\link{go.steep}} and
    \code{\link{summary.mefista}}. 
}
--==_Exmh_-19086308140--



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Prof Brian Ripley <ripley@stats.ox.ac.uk>  Fri Apr 14 13:47:07 2000
From: Prof Brian Ripley <ripley@stats.ox.ac.uk> (Prof Brian Ripley)
Date: Fri, 14 Apr 2000 13:47:07 +0100 (BST)
Subject: [Rd] bundle build and Rd2Sd converion fail (PR#519)
Message-ID: <200004141247.NAA04540@toucan.stats.ox.ac.uk>


> From: sergei@stams.strath.ac.uk
> Date: Fri, 14 Apr 2000 14:14:29 +0200 (MET DST)
> 
> Dear R-core,
> Thank you for your great effort! I am finalising a bundle that works both in
> R and Splus. But I faced the following minor problems with R CMD under both
> UNIX and LINUX.
> 1. R CMD build denies to work with bundles. It reports
> * checking `DESCRIPTION' package entry ... ERROR: no package entry in 
> `DESCRIPTION'

Yes, no one said it would work with a bundle, did they?  (See
R CMD build --help.)

You can use it to help check packages within a bundle (you can then
ignore that message) and build the bundle by hand.

Now people other than me are building bundles, to make it work with
bundles is on the TODO list.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Prof Brian Ripley <ripley@stats.ox.ac.uk>  Fri Apr 14 13:50:49 2000
From: Prof Brian Ripley <ripley@stats.ox.ac.uk> (Prof Brian Ripley)
Date: Fri, 14 Apr 2000 13:50:49 +0100 (BST)
Subject: [Rd] Rd2Sd conversion: files (PR#520)
Message-ID: <200004141250.NAA04633@toucan.stats.ox.ac.uk>


> From: sergei@stams.strath.ac.uk
> Date: Fri, 14 Apr 2000 14:26:48 +0200 (MET DST)
> To: r-devel@stat.math.ethz.ch
> Subject: [Rd] Rd2Sd conversion: files (PR#520)
> CC: R-bugs@biostat.ku.dk
> X-Loop: R-bugs@biostat.ku.dk
> 
> This is a multipart MIME message.
> 
> --==_Exmh_-19086308140
> Content-Type: text/plain; charset=us-ascii
> 
> In addition to my previous message, here is the source Rd-file that I used in
> 
>  R CMD Rdconv -d --type=Sd plot.mefista.Rd > plot.mefista.d
> 
> command.

Conversion to Sd has never been very good.  As you see, it has been
inadvertently removed together with nroff support.  I have put it back
for 1.1, but do not expect it to be 100% correct and we do not plan to
continue to support nroff-based methods.


[BTW, your example lacks any keywords.]

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Fri Apr 14 15:44:14 2000
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Fri, 14 Apr 2000 10:44:14 -0400
Subject: [Rd] bundle build and Rd2Sd converion fail (PR#519)
References: <200004141214.OAA16983@pubhealth.ku.dk>
Message-ID: <38F72EBE.93EEB4F0@bank-banque-canada.ca>

Sergei

If you just blend together the bundle DESCRIPTION and the DESCRIPTION.in for
each package in the bundle, and put this in a DESCRIPTION file in the package,
then you can run R CMD build on the package. Here are some lines from my
makefile for package dse1 (in  bundle dse):

 cat DESCRIPTION | grep -v Bundle | grep -v Contains \
       >dse1/DESCRIPTION
 cat dse1/DESCRIPTION.in  >>dse1/DESCRIPTION

After you do this R CMD build works on the package and does all its testing, and
produces a tar.gz for each package. You then need to delete these and manually
tar and gzip the bundle.

Paul Gilbert

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From bates@stat.wisc.edu  Sun Apr 16 18:18:35 2000
From: bates@stat.wisc.edu (Douglas Bates)
Date: Sun, 16 Apr 2000 12:18:35 -0500 (CDT)
Subject: [Rd] R-1.0.1 now available via rsync
Message-ID: <m12gsgt-000ZSXC@franz.stat.wisc.edu>

The rsync directories on rsync.r-project.org have been updated so that
r-release points to the 1.0.1 release.  That is,

 rsync -Ca rsync.r-project.org::r-release R-1.0.1

will produce a copy of the 1.0.1 tree in a subdirectory called R-1.0.1
of the current directory.

Other options are:

$ rsync rsync.r-project.org::
r-release      	R sources (feature-frozen version) CVS tree (approx 12 MB)
r-release-patched	patched R sources (feature-frozen version) CVS tree (approx 12 MB)
r-devel        	R sources (development version) CVS tree (approx 12 MB)
r-manuals      	Development sources for manuals for R
xlispstat      	xlispstat sources (development version) CVS tree (approx 12 MB)
ess            	ess (Emacs Speaks Statistics) CVS tree (approx 8.5 MB)
omega          	Omega Project for Statistical Computing CVS tree
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From santini@dsi.unimi.it  Mon Apr 17 10:30:43 2000
From: santini@dsi.unimi.it (santini@dsi.unimi.it)
Date: Mon, 17 Apr 2000 11:30:43 +0200 (MET DST)
Subject: [Rd] akima core dumps on loading (PR#521)
Message-ID: <200004170930.LAA01569@pubhealth.ku.dk>

Full_Name: Massimo santini
Version: 1.0.1
OS: Linux
Submission from: (NULL) (159.149.147.89)


I've just dl the .rpm of R 1.0.1, installed it and then launched 

	insatll.packages("akima")

after re-launching R [--vanilla], the command

	library(akima)

has the only effect to coredump the program. Here is the output of gdb and
strace...

--- GDB (commands given can be seen from the except)

$ R -d gdb
GNU gdb 19991004
Copyright 1998 Free Software Foundation, Inc.
GDB is free software, covered by the GNU General Public License, and you are
welcome to change it and/or distribute copies of it under certain conditions.
Type "show copying" to see the conditions.
There is absolutely no warranty for GDB.  Type "show warranty" for details.
This GDB was configured as "i386-redhat-linux"...
(gdb) run --vanilla
Starting program: /usr/lib/R/bin/R.X11 --vanilla

R : Copyright 2000, The R Development Core Team
Version 1.0.1  (April 14, 2000)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type	"?license" or "?licence" for distribution details.

R is a collaborative project with many contributors.
Type	"?contributors" for a list.

Type	"demo()" for some demos, "help()" for on-line help, or
    	"help.start()" for a HTML browser interface to help.
Type	"q()" to quit R.

> library(akima)

Program received signal SIGSEGV, Segmentation fault.
_dl_lookup_symbol (undef_name=0x2d2e3b3 <Address 0x2d2e3b3 out of bounds>,
ref=0xbfffabb4, 
    symbol_scope=0x81ec65c, reference_name=0x81e8b20
"/usr/lib/R/library/akima/libs/akima.so", reloc_type=208)
    at ../sysdeps/generic/dl-hash.h:31
31	../sysdeps/generic/dl-hash.h: No such file or directory.
(gdb) 

--- STRACE (echo "library(akima)" | strace R --vanilla)

[...]
rt_sigprocmask(SIG_BLOCK, NULL, [], 8)  = 0
stat("/usr/lib/R/library/akima/libs/akima.so", {st_mode=S_IFREG|0755,
st_size=289367, ...}) = 0
stat("/usr/lib/R/library/base/libs/akima.so", 0xbfffdb60) = -1 ENOENT (No such
file or directory)
rt_sigprocmask(SIG_BLOCK, NULL, [], 8)  = 0
rt_sigprocmask(SIG_BLOCK, NULL, [], 8)  = 0
rt_sigprocmask(SIG_BLOCK, NULL, [], 8)  = 0
rt_sigprocmask(SIG_BLOCK, NULL, [], 8)  = 0
rt_sigprocmask(SIG_BLOCK, NULL, [], 8)  = 0
rt_sigprocmask(SIG_BLOCK, NULL, [], 8)  = 0
rt_sigprocmask(SIG_SETMASK, [], NULL, 8) = 0
rt_sigprocmask(SIG_BLOCK, NULL, [], 8)  = 0
rt_sigprocmask(SIG_BLOCK, NULL, [], 8)  = 0
rt_sigprocmask(SIG_SETMASK, [], NULL, 8) = 0
open("/usr/lib/R/library/akima/libs/akima.so", O_RDONLY) = 4
fstat(4, {st_mode=S_IFREG|0755, st_size=289367, ...}) = 0
read(4, "\177ELF\1\1\1\0\0\0\0\0\0\0\0\0\3\0\3\0\1\0\0\0000F\0\000"..., 4096) =
4096
old_mmap(NULL, 115364, PROT_READ|PROT_EXEC, MAP_PRIVATE, 4, 0) = 0x40f3d000
mprotect(0x40f55000, 17060, PROT_NONE)  = 0
old_mmap(0x40f55000, 8192, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED, 4,
0x17000) = 0x40f55000
old_mmap(0x40f57000, 8868, PROT_READ|PROT_WRITE,
MAP_PRIVATE|MAP_FIXED|MAP_ANONYMOUS, -1, 0) = 0x40f57000
close(4)                                = 0
mprotect(0x40f3d000, 98304, PROT_READ|PROT_WRITE) = 0
--- SIGSEGV (Segmentation fault) ---
+++ killed by SIGSEGV +++

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Mon Apr 17 11:03:19 2000
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 17 Apr 2000 12:03:19 +0200
Subject: [Rd] akima core dumps on loading (PR#521)
In-Reply-To: santini@dsi.unimi.it's message of "Mon, 17 Apr 2000 11:30:43 +0200 (MET DST)"
References: <200004170930.LAA01569@pubhealth.ku.dk>
Message-ID: <x2zoqtkpso.fsf@blueberry.kubism.ku.dk>

santini@dsi.unimi.it writes:

> Full_Name: Massimo santini
> Version: 1.0.1
> OS: Linux
> Submission from: (NULL) (159.149.147.89)
> 
> 
> I've just dl the .rpm of R 1.0.1, installed it and then launched 
> 
> 	insatll.packages("akima")
> 
> after re-launching R [--vanilla], the command
> 
> 	library(akima)
> 
> has the only effect to coredump the program. Here is the output of gdb and
> strace...

Hmm. Doesn't happen here. (BTW: Remember to include as much
information about your system as you can think of. It's not obvious
whether you're running RedHat or SuSE for instance and in what
version.) 

> Program received signal SIGSEGV, Segmentation fault.
> _dl_lookup_symbol (undef_name=0x2d2e3b3 <Address 0x2d2e3b3 out of bounds>,
> ref=0xbfffabb4, 
>     symbol_scope=0x81ec65c, reference_name=0x81e8b20
> "/usr/lib/R/library/akima/libs/akima.so", reloc_type=208)
>     at ../sysdeps/generic/dl-hash.h:31
> 31	../sysdeps/generic/dl-hash.h: No such file or directory.
> (gdb) 
> 
> --- STRACE (echo "library(akima)" | strace R --vanilla)
> 
> [...]
> rt_sigprocmask(SIG_BLOCK, NULL, [], 8)  = 0
> stat("/usr/lib/R/library/akima/libs/akima.so", {st_mode=S_IFREG|0755,
> st_size=289367, ...}) = 0
> stat("/usr/lib/R/library/base/libs/akima.so", 0xbfffdb60) = -1 ENOENT (No such
> file or directory)

This would seem to be the problem: the dynamic library isn't there.
Did you get any error messages while compiling the package? (Except
for "...might be used uninitialized..." of which there are quite a few
here too).

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From sergei@stams.strath.ac.uk  Mon Apr 17 11:53:20 2000
From: sergei@stams.strath.ac.uk (sergei@stams.strath.ac.uk)
Date: Mon, 17 Apr 2000 12:53:20 +0200 (MET DST)
Subject: [Rd] na.omit fails for matrices (PR#522)
Message-ID: <200004171053.MAA02535@pubhealth.ku.dk>

Dear R-core team,
I came across the following bug (feature?):
Modyfying example from help(na.omit):
> ( m<-matrix(c(1, 2, 3, 0, 10, NA),ncol=2) )
     [,1] [,2]
[1,]    1    0
[2,]    2   10
[3,]    3   NA
> ( mo<- na.omit(m) )
     [,1] [,2]
attr(,"na.action")
[1] 1
attr(,"na.action")attr(,"class")
[1] "omit"  
> dim(mo)
[1] 0 2        
> is.matrix(mo)
[1] TRUE                                                                       

So the result is an empty matrix! On the other hand   
> na.omit(as.data.frame(m))
  V1 V2
1  1  0
2  2 10                                                                        


works fine. help(na.omit) does not say that matrix is not a valid argument. At 
least in na.omit in Splus it is valid.
I have tested this in R-1.0.0 and development version R-1.1 under LINUX, 
Solaris and MSWindows.

Best wishes,
Sergei

=================================================================
                           Dr. Sergei ZUYEV
Statistics and Modelling Science dept., University of Strathclyde
    Livingston Tower, 26 Richmond str., Glasgow, G1 1XH, U.K.
     Tel.: +44 (0)141 548 3663    Fax:  +44 (0)141 552 2079
E-mail: sergei@stams.strath.ac.uk   http://www.stams.strath.ac.uk
=================================================================


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Mon Apr 17 14:47:41 2000
From: p.dalgaard@biostat.ku.dk (p.dalgaard@biostat.ku.dk)
Date: Mon, 17 Apr 2000 15:47:41 +0200 (MET DST)
Subject: [Rd] akima core dumps on loading (PR#521)
Message-ID: <200004171347.PAA05197@pubhealth.ku.dk>

Massimo Santini <santini@dsi.unimi.it> writes:

> > Hmm. Doesn't happen here. (BTW: Remember to include as much
> > information about your system as you can think of. It's not obvious
> > whether you're running RedHat or SuSE for instance and in what
> > version.) 
> 
> You are perfectly right. My system is an updated RedHat 6.2.

Same here...

> > > stat("/usr/lib/R/library/akima/libs/akima.so", {st_mode=S_IFREG|0755,
> > > st_size=289367, ...}) = 0
> > > stat("/usr/lib/R/library/base/libs/akima.so", 0xbfffdb60) = -1 ENOENT (No such
> > > file or directory)
> > 
> > This would seem to be the problem: the dynamic library isn't there.
> > Did you get any error messages while compiling the package? (Except
> > for "...might be used uninitialized..." of which there are quite a few
> > here too).
> 
> Non errors during the installation phase. The akima.so library is in 
> 
> 	/usr/lib/R/library/akima/libs/akima.so
> 
> where it should be (with correct premissions), but is not in
> 
> 	/usr/lib/R/library/base/libs/akima.so
> 
> (the dir /usr/lib/R/library/base/libs is missing, to be precise).

Oh. Didn't see that. Then that part is OK. Sorry.

> Have you some hint about what to do now?

Hmmm. Interesting: I can provoke the crash on *my other* RedHat6.2
computer (the one still running the egcs compiler). My stack trace says

#0  _dl_lookup_symbol (
    undef_name=0xcbf203b4 <Address 0xcbf203b4 out of bounds>,
    ref=0xbfffb234, 
    symbol_scope=0x81d3cac, 
    reference_name=0x81d3a60
    "/usr/local/src/misc/r-release/BUILD/library/akima/libs/akima.so",
    reloc_type=64) at ../sysdeps/generic/dl-hash.h:31
#1  0x400096ad in _dl_relocate_object (l=0x81d3aa8, scope=0x81d3cac, lazy=0, 
    consider_profiling=0) at ../sysdeps/i386/dl-machine.h:326
#2  0x40255be4 in dl_open_worker (a=0xbfffb3a0) at dl-open.c:182
#3  0x4000ac3b in _dl_catch_error (errstring=0xbfffb39c, 
    operate=0x40255990 <dl_open_worker>, args=0xbfffb3a0) at dl-error.c:141
#4  0x40255d3d in _dl_open (
    file=0xbfffc51c 
"/usr/local/src/misc/r-release/BUILD/library/akima/libs/akima.so",
mode=2, caller=0xbfffb39c) at dl-open.c:232
#5  0x401323d3 in dlopen_doit (a=0xbfffb4b0) at dlopen.c:41
#6  0x4000ac3b in _dl_catch_error (errstring=0x40134080, 
    operate=0x401323a8 <dlopen_doit>, args=0xbfffb4b0) at
dl-error.c:141
#7  0x401328b9 in _dlerror_run (operate=0x401323a8 <dlopen_doit>, 
    args=0xbfffb4b0) at dlerror.c:125
#8  0x40132393 in __dlopen_check (
    file=0xbfffc51c
"/usr/local/src/misc/r-release/BUILD/library/akima/libs/akima.so",
mode=2) at dlopen.c:53
#9  0x80d9cc3 in AddDLL (
    path=0xbfffc51c
"/usr/local/src/misc/r-release/BUILD/library/akima/libs/akim
a.so", asLocal=1, now=1) at ../../../R/src/unix/dynload.c:207


Looks like it is happening during the dynamic linking itself. Doesn't
look nice. (But installing gcc 2.95.2 might fix your problem.)

[diverted back to r-bugs]

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From plummer@iarc.fr  Mon Apr 17 17:09:40 2000
From: plummer@iarc.fr (plummer@iarc.fr)
Date: Mon, 17 Apr 2000 18:09:40 +0200 (MET DST)
Subject: [Rd] Maths in R documentation (PR#523)
Message-ID: <200004171609.SAA06411@pubhealth.ku.dk>

The document R-exts contains the following example of using 
mathematics in R documentation.

\deqn{p(x) = {\lambda^x\ \frac{e^{-\lambda}}{x!}}
     {p(x) = lambda^x exp(-lambda)/x!}

There is a syntax error in there, but that's not my point.
The problem is that using "R CMD Rd2dvi" I find that putting
the alternate forms of the equation on top of each other doesn't
work.

\deqn{foo}
     {bar}

is interpreted as

\deqn{foo}
bar

which causes a number of problems,e.g. you get both forms of the
equation printed, LaTeX complains about missing math delimiters, etc.
I solved this by putting everything on one line:

\deqn{foo}{bar}

but there is either a documentation error in there, or a problem with
parsing ".Rd" format files.

Another problem is that when I type "R CMD Rd2dvi coda" to get a printable
reference for all the functions in the coda package, they seem to come out in
a more or less random order. I get
read.bugs, mcmc, plot.mcmc, codamenu, read.and.check,...
I was expecting alphabetical order. What do I have to do to get this?

Martyn

--please do not edit the information below--

Version:
 platform = i686-unknown-linux
 arch = i686
 os = linux
 system = i686, linux
 status =
 major = 1
 minor = 0.1
 year = 2000
 month = April
 day = 14
 language = R

Search Path:
 .GlobalEnv, Autoloads, package:base

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From rgentlem@stat.auckland.ac.nz  Mon Apr 17 17:57:22 2000
From: rgentlem@stat.auckland.ac.nz (Robert Gentleman)
Date: Tue, 18 Apr 2000 04:57:22 +1200
Subject: [Rd] Maths in R documentation (PR#523)
In-Reply-To: <200004171609.SAA06411@pubhealth.ku.dk>; from plummer@iarc.fr on Mon, Apr 17, 2000 at 06:09:40PM +0200
References: <200004171609.SAA06411@pubhealth.ku.dk>
Message-ID: <20000418045722.A17858@stat1.stat.auckland.ac.nz>

 I pointed this anomaly out sometime ago. It would be nice to either
have the documentation change or the behaviour (I would perfer the 
latter).

On Mon, Apr 17, 2000 at 06:09:40PM +0200, plummer@iarc.fr wrote:
> The document R-exts contains the following example of using 
> mathematics in R documentation.
> 
> \deqn{p(x) = {\lambda^x\ \frac{e^{-\lambda}}{x!}}
>      {p(x) = lambda^x exp(-lambda)/x!}
> 
> There is a syntax error in there, but that's not my point.
> The problem is that using "R CMD Rd2dvi" I find that putting
> the alternate forms of the equation on top of each other doesn't
> work.
> 
> \deqn{foo}
>      {bar}
> 
> is interpreted as
> 
> \deqn{foo}
> bar
> 
> which causes a number of problems,e.g. you get both forms of the
> equation printed, LaTeX complains about missing math delimiters, etc.
> I solved this by putting everything on one line:
> 
> \deqn{foo}{bar}
> 
> but there is either a documentation error in there, or a problem with
> parsing ".Rd" format files.
> 
> Another problem is that when I type "R CMD Rd2dvi coda" to get a printable
> reference for all the functions in the coda package, they seem to come out in
> a more or less random order. I get
> read.bugs, mcmc, plot.mcmc, codamenu, read.and.check,...
> I was expecting alphabetical order. What do I have to do to get this?
> 
> Martyn
> 
> --please do not edit the information below--
> 
> Version:
>  platform = i686-unknown-linux
>  arch = i686
>  os = linux
>  system = i686, linux
>  status =
>  major = 1
>  minor = 0.1
>  year = 2000
>  month = April
>  day = 14
>  language = R
> 
> Search Path:
>  .GlobalEnv, Autoloads, package:base
> 
> -.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
> r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
> Send "info", "help", or "[un]subscribe"
> (in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
> _._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

-- 
+-------------------------------------------------------------------------+
| Robert Gentleman              phone : (64-9) 3737-599 ext 3946          | 
| Senior Lecturer               fax :   (64-9) 3737-018                   |
| Department of Statistics      office : Room 206 Maths/Physics           |
| University of Auckland	email : rgentlem@stat.auckland.ac.nz      |
+-------------------------------------------------------------------------+
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From maechler@stat.math.ethz.ch  Tue Apr 18 08:00:41 2000
From: maechler@stat.math.ethz.ch (maechler@stat.math.ethz.ch)
Date: Tue, 18 Apr 2000 09:00:41 +0200 (MET DST)
Subject: [Rd] Maths in R documentation (PR#523)
Message-ID: <200004180700.JAA08711@pubhealth.ku.dk>

>>>>> "Martyn" == Martyn Plummer <plummer@iarc.fr> writes:

    Martyn> The document R-exts contains the following example of using 
    Martyn> mathematics in R documentation.

    Martyn> \deqn{p(x) = {\lambda^x\ \frac{e^{-\lambda}}{x!}}
    Martyn>      {p(x) = lambda^x exp(-lambda)/x!}

    Martyn> There is a syntax error in there, but that's not my point.
    Martyn> The problem is that using "R CMD Rd2dvi" I find that putting
    Martyn> the alternate forms of the equation on top of each other doesn't
    Martyn> work.

    Martyn> \deqn{foo}
    Martyn>      {bar}

    Martyn> is interpreted as

    Martyn> \deqn{foo}
    Martyn> bar

yes.

The typo is simply a missing "%" at the end of the first line
(which once was there, and "of course" was dropped when that documentation
 was translated from latex to texinfo ...)

The following is correct

 \deqn{foo}%
      {bar}

(see e.g. src/library/base/man/Special.Rd or ...../symnum.Rd )

I'll fix R-exts.texi.

    Martyn> which causes a number of problems,e.g. you get both forms of the
    Martyn> equation printed, LaTeX complains about missing math delimiters, etc.
    Martyn> I solved this by putting everything on one line:

    Martyn> \deqn{foo}{bar}

    Martyn> but there is either a documentation error in there, or a
    Martyn> problem with parsing ".Rd" format files.

    Martyn> Another problem is that when I type "R CMD Rd2dvi coda" to get
    Martyn> a printable reference for all the functions in the coda
    Martyn> package, they seem to come out in a more or less random
    Martyn> order. I get read.bugs, mcmc, plot.mcmc, codamenu,
    Martyn> read.and.check,...  I was expecting alphabetical order. What do
    Martyn> I have to do to get this?

The change just been proposed yesterday by Doug Bates:

Replace in R..../bin/Rd2dvi , about line 88

	files=`find ${dir} -name "*.[Rr]d" -print`
by
	files=`find ${dir} -name "*.[Rr]d" -print | sort`


    Martyn> --please do not edit the information below--

    Martyn> Version:
    Martyn> platform = i686-unknown-linux
    Martyn> arch = i686
    Martyn> os = linux
    Martyn> system = i686, linux
    Martyn> status =
    Martyn> major = 1
    Martyn> minor = 0.1
    Martyn> year = 2000
    Martyn> month = April
    Martyn> day = 14
    Martyn> language = R

    Martyn> Search Path:
    Martyn> .GlobalEnv, Autoloads, package:base

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From maechler@stat.math.ethz.ch  Tue Apr 18 13:19:01 2000
From: maechler@stat.math.ethz.ch (maechler@stat.math.ethz.ch)
Date: Tue, 18 Apr 2000 14:19:01 +0200 (MET DST)
Subject: [Rd] Maths in R documentation (PR#523)
Message-ID: <200004181219.OAA12317@pubhealth.ku.dk>

>>>>> "MM" == Martin Maechler <maechler@stat.math.ethz.ch> writes:

>>>>> "Martyn" == Martyn Plummer <plummer@iarc.fr> writes:
    Martyn> The document R-exts contains the following example of using 
    Martyn> mathematics in R documentation.

    Martyn> \deqn{p(x) = {\lambda^x\ \frac{e^{-\lambda}}{x!}}
    Martyn> {p(x) = lambda^x exp(-lambda)/x!}

    Martyn> There is a syntax error in there, but that's not my point.
    Martyn> The problem is that using "R CMD Rd2dvi" I find that putting
    Martyn> the alternate forms of the equation on top of each other doesn't
    Martyn> work.

    Martyn> \deqn{foo}
    Martyn> {bar}

    Martyn> is interpreted as

    Martyn> \deqn{foo}
    Martyn> bar

    MM> yes.

    MM> The typo is simply a missing "%" at the end of the first line
    MM> (which once was there, and "of course" was dropped when that documentation
    MM> was translated from latex to texinfo ...)

    MM> The following is correct

    MM> \deqn{foo}%
    MM>      {bar}

NO!  ...dear me... a closer look at these two files
    MM> (see e.g. src/library/base/man/Special.Rd or ...../symnum.Rd )

reveals that

 \deqn{foo}{%
       bar}

is *the way* ..

sorry for the additional confusion I've added...

    MM> I'll fix R-exts.texi.
..yes..

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ligges@statistik.uni-dortmund.de  Tue Apr 18 18:39:53 2000
From: ligges@statistik.uni-dortmund.de (ligges@statistik.uni-dortmund.de)
Date: Tue, 18 Apr 2000 19:39:53 +0200 (MET DST)
Subject: [Rd] strheight() crashes without opened device (PR#524)
Message-ID: <200004181739.TAA15047@pubhealth.ku.dk>

My mistake, but also a bug.
I did not open a device and called strheight("X").
==> R crashed

...\rgui --vanilla
[...]

> strwidth("X")
Error in strwidth("X") : plot.new has not been called yet
(OK.)

> strheight("X")

R crashed.
(Happens also on Solaris.)


Regards, 
Uwe Ligges


--please do not edit the information below--

Version:
 platform = Windows
 arch = x86
 os = Win32
 system = x86, Win32
 status = 
 major = 1
 minor = 0.0
 year = 2000
 month = February
 day = 29
 language = R

Windows NT 4.0 (build 1381) Service Pack 6

Search Path:
 .GlobalEnv, Autoloads, package:base

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From thomas@biostat.washington.edu  Tue Apr 18 19:17:42 2000
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Tue, 18 Apr 2000 11:17:42 -0700 (PDT)
Subject: [Rd] strheight() crashes without opened device (PR#524)
In-Reply-To: <200004181739.TAA15047@pubhealth.ku.dk>
Message-ID: <Pine.GSO.4.21.0004181116550.10925-100000@mail.biostat.washington.edu>

On Tue, 18 Apr 2000 ligges@statistik.uni-dortmund.de wrote:

> My mistake, but also a bug.
> I did not open a device and called strheight("X").
> ==> R crashed

Fixed for R1.1: we weren't checking that the device existed.

	-thomas


Thomas Lumley
Assistant Professor, Biostatistics
University of Washington, Seattle

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From bolker@zoo.ufl.edu  Wed Apr 19 15:23:34 2000
From: bolker@zoo.ufl.edu (bolker@zoo.ufl.edu)
Date: Wed, 19 Apr 2000 16:23:34 +0200 (MET DST)
Subject: [Rd] Windows-specific: image(z,zlim=()) gives bogus colors outside range (PR#525)
Message-ID: <200004191423.QAA23141@pubhealth.ku.dk>


  In the Windows version of R (not in the equivalent version
running on Linux RH 6.0), doing image(z,zlim=c(a,b)) with
non-trivial limits (i.e., smaller than the range of z)
plots bogus colors (randomly picked from the colormap,
perhaps?) in regions where z is outside of zlim.  (on the
Linux version those regions are just plotted in black, which
seems more appropriate)

  For example:

x <- seq(-1,1,length=50)
z1 <- expand.grid(x,x)
z2 <- matrix(apply(z1,1,function(x)sum(x^2)),nrow=50)
image(z2,zlim=c(0.5,1.5))


--please do not edit the information below--

Version:
 platform = Windows
 arch = x86
 os = Win32
 system = x86, Win32
 status = 
 major = 1
 minor = 0.0
 year = 2000
 month = February
 day = 29
 language = R

Windows 9x 4.0 (build 1212)  B

Search Path:
 .GlobalEnv, Autoloads, package:base

-- 
Ben Bolker                                  bolker@zoo.ufl.edu
Zoology Department, University of Florida   http://www.zoo.ufl.edu/bolker
318 Carr Hall/Box 118525                    tel: (352) 392-5697
Gainesville, FL 32611-8525                  fax: (352) 392-3704


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From bolker@zoo.ufl.edu  Wed Apr 19 15:46:45 2000
From: bolker@zoo.ufl.edu (Ben Bolker)
Date: Wed, 19 Apr 2000 10:46:45 -0400 (EDT)
Subject: [Rd] scale factors/overdispersion in GLM: possible bug?
Message-ID: <Pine.LNX.4.10.10004191030500.863-100000@bolker.zoo.ufl.edu>


  I've been poking around with GLMs (on which I am *not* an expert) on
behalf of a student, particularly binomial (standard logit link) nested
models with overdispersion.

  I have one possible bug to report (but I'm not confident enough to be
*sure* it's a bug); one comment on the general inconsistency that seems to
afflict the various functions for dealing with overdispersion in GLMs
(anova.glm, drop1.glm, summary.glm); and one statistical query that maybe
someone would answer if they're feeling generous.

  1.  possible bug:
  in drop1.glm() with scale != 0, R seems to divide by the dispersion
parameter twice:

 first (if family != "gaussian") it sets

 loglik <- dev/dispersion

 then (if test == "Chisq") it calculates

     dev <- loglik - loglik[1]
     dev[nas] <- 1 - pchisq(dev[nas]/dispersion, aod$Df[nas])

(in addition, I suppose this could now be just 
pchisq(...,lower.tail=FALSE) for greater precision)

  Is this a bug or am I missing something?

  2.  There seems to be a fair amount of variability in how drop1.glm,
anova.glm, stat.anova, summary.glm deal with dispersion parameters:
  summary.glm() has an optional parameter called "dispersion"
  stat.anova() has a parameter called "scale", which it doesn't even use
if test=="Chisq"
  anova.glm calls stat.anova() with an automatically calculated scale
parameter (sum(object$weights*object$residuals^2)/object$df.residual), not
allowing a user-defined scale
  drop1.glm() has an optional parameter called "scale"

  I would mess around and try to fix these myself, but (1) there seem to
be some design decisions to make here, (2) I'm not sufficiently sure of
myself to want to break things.

  3. There seems to be a certain variety of advice around in how to deal
with overdispersion in GLMs.  One could (1) calculate the scale parameter
from the residuals (either residual deviance/residual df or Pearson
chi-sq/residual df) and feed that back into the analysis; (2) use
quasi-likelihood with logit link and variance mu(1-mu); (3) use a form of
F-test, as suggested by Crawley (which I guess has something to do with
the fact that the scale parameter is estimated, not really known).  Are
these equivalent, or approximately equivalent?  Does anyone have a
favorite reference on the subject?  (I've been looking at V&R3, Crawley's
"GLIM for Ecologists", and Lindsey's GLM book -- I haven't acquired Dobson
or McCullagh and Nelder yet).

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ligges@statistik.uni-dortmund.de  Wed Apr 19 16:03:06 2000
From: ligges@statistik.uni-dortmund.de (Uwe Ligges)
Date: Wed, 19 Apr 2000 17:03:06 +0200
Subject: [Rd] Windows-specific: image(z,zlim=()) gives bogus colors outside
 range (PR#525)
References: <200004191423.QAA23141@pubhealth.ku.dk>
Message-ID: <38FDCAAA.41B5DAE@statistik.uni-dortmund.de>

bolker@zoo.ufl.edu schrieb:
> 
>   In the Windows version of R (not in the equivalent version
> running on Linux RH 6.0), doing image(z,zlim=c(a,b)) with
> non-trivial limits (i.e., smaller than the range of z)
> plots bogus colors (randomly picked from the colormap,
> perhaps?) in regions where z is outside of zlim.  (on the
> Linux version those regions are just plotted in black, which
> seems more appropriate)
> 
>   For example:
> 
> x <- seq(-1,1,length=50)
> z1 <- expand.grid(x,x)
> z2 <- matrix(apply(z1,1,function(x)sum(x^2)),nrow=50)
> image(z2,zlim=c(0.5,1.5))

Additionally try

  image(z2,zlim=c(0.5,0.500001))

Gives segmentation fault on Solaris / Dr. Watson on WinNT

Regards, 
Uwe Ligges
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From bolker@zoo.ufl.edu  Wed Apr 19 16:02:55 2000
From: bolker@zoo.ufl.edu (Ben Bolker)
Date: Wed, 19 Apr 2000 11:02:55 -0400 (EDT)
Subject: [Rd] Windows-specific: image(z,zlim=()) gives bogus colors
 outside  range (PR#525)
In-Reply-To: <38FDCAAA.41B5DAE@statistik.uni-dortmund.de>
Message-ID: <Pine.LNX.4.10.10004191059540.885-100000@bolker.zoo.ufl.edu>


  Oops, I take it back.  I *thought* it worked on Linux, but I just tried
it and got the same problem -- and I get the segmentation fault on Linux
too.

On Wed, 19 Apr 2000, Uwe Ligges wrote:

> bolker@zoo.ufl.edu schrieb:
> > 
> >   In the Windows version of R (not in the equivalent version
> > running on Linux RH 6.0), doing image(z,zlim=c(a,b)) with
> > non-trivial limits (i.e., smaller than the range of z)
> > plots bogus colors (randomly picked from the colormap,
> > perhaps?) in regions where z is outside of zlim.  (on the
> > Linux version those regions are just plotted in black, which
> > seems more appropriate)
> > 
> >   For example:
> > 
> > x <- seq(-1,1,length=50)
> > z1 <- expand.grid(x,x)
> > z2 <- matrix(apply(z1,1,function(x)sum(x^2)),nrow=50)
> > image(z2,zlim=c(0.5,1.5))
> 
> Additionally try
> 
>   image(z2,zlim=c(0.5,0.500001))
> 
> Gives segmentation fault on Solaris / Dr. Watson on WinNT
> 
> Regards, 
> Uwe Ligges
> 
> 

-- 
Ben Bolker                                  bolker@zoo.ufl.edu
Zoology Department, University of Florida   http://www.zoo.ufl.edu/bolker
318 Carr Hall/Box 118525                    tel: (352) 392-5697
Gainesville, FL 32611-8525                  fax: (352) 392-3704

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From lamj@stat.cmu.edu  Wed Apr 19 16:27:37 2000
From: lamj@stat.cmu.edu (lamj@stat.cmu.edu)
Date: Wed, 19 Apr 2000 17:27:37 +0200 (MET DST)
Subject: [Rd] INSTALL_SCRIPT during installation (PR#526)
Message-ID: <200004191527.RAA23531@pubhealth.ku.dk>

The following patch uses INSTALL_SCRIPT to install scripts, as opposed
to directly using INSTALL.  It is relative to R-1.0.1 source.

     -- Johnny C. Lam <lamj@stat.cmu.edu>
        Department of Statistics, Carnegie Mellon University
        http://www.stat.cmu.edu/~lamj/

--- Makeconf.in.orig	Sat Jan 22 15:10:00 2000
+++ Makeconf.in	Mon Apr 17 16:04:58 2000
@@ -23,6 +23,7 @@
 INSTALL = @INSTALL@
 INSTALL_DATA = @INSTALL_DATA@
 INSTALL_PROGRAM = @INSTALL_PROGRAM@
+INSTALL_SCRIPT = @INSTALL_SCRIPT@
 INSTALL_DIR = ${INSTALL} -d
 LATEX = @LATEX@
 LDCMD = @LDCMD@
--- Makefile.in.orig	Mon Feb 21 02:03:26 2000
+++ Makefile.in	Mon Apr 17 16:11:47 2000
@@ -74,7 +74,7 @@
 	@for f in `ls bin/* | grep -v '^bin/R\**$$' \
 	                    | grep -v '^bin/R.X11\**$$' \
 	                    | grep -v '^bin/R.GNOME\**$$'`; do \
-	  $(INSTALL) $${f} $(rhome)/bin; \
+	  $(INSTALL_SCRIPT) $${f} $(rhome)/bin; \
 	done
 	@echo "installing headers ..."
 	@for f in include/*.h; do \
--- src/scripts/Makefile.in.orig	Mon Feb 21 05:49:10 2000
+++ src/scripts/Makefile.in	Mon Apr 17 16:13:11 2000
@@ -38,10 +38,10 @@
 	  > $(top_builddir)/bin/R
 	@chmod +x $(top_builddir)/bin/R
 	@for f in $(SCRIPTS_S); do \
-	  $(INSTALL) $(srcdir)/$$f $(top_builddir)/bin; \
+	  $(INSTALL_SCRIPT) $(srcdir)/$$f $(top_builddir)/bin; \
 	done
 	@for f in $(SCRIPTS_B); do \
-	  $(INSTALL) $$f $(top_builddir)/bin; \
+	  $(INSTALL_SCRIPT) $$f $(top_builddir)/bin; \
 	done
 
 $(SCRIPTS_B): $(top_builddir)/config.status


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From thomas@biostat.washington.edu  Wed Apr 19 16:55:43 2000
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Wed, 19 Apr 2000 08:55:43 -0700 (PDT)
Subject: [Rd] Windows-specific: image(z,zlim=()) gives bogus colors
 outside  range (PR#525)
In-Reply-To: <Pine.LNX.4.10.10004191059540.885-100000@bolker.zoo.ufl.edu>
Message-ID: <Pine.GSO.4.21.0004190855090.27936-100000@mail.biostat.washington.edu>

On Wed, 19 Apr 2000, Ben Bolker wrote:

> 
>   Oops, I take it back.  I *thought* it worked on Linux, but I just tried
> it and got the same problem -- and I get the segmentation fault on Linux
> too.

This seems to have been fixed in the development branch at least.

	-thomas

Thomas Lumley
Assistant Professor, Biostatistics
University of Washington, Seattle


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ligges@statistik.uni-dortmund.de  Wed Apr 19 17:01:38 2000
From: ligges@statistik.uni-dortmund.de (Uwe Ligges)
Date: Wed, 19 Apr 2000 18:01:38 +0200
Subject: [Rd] .Renviron and WinNT4 SP5/SP6
Message-ID: <38FDD862.6DDC642C@statistik.uni-dortmund.de>

Hello!

This is a really rare problem / bug(?).

I tested around because of the mail on R-Help:

  Faheem Mitha <faheem@email.unc.edu>
  Subj.: increasing memory size


I created a file .Renviron:

   R_VSIZE=10M

without a linebreak after that line, because I thought Faheem might have
forgot it.
I expected, the line would not be interpreted.

To my surprise R crashed at once (R-1.0.0 patched, WinNT4.0 SP6).
Using the same R-1.0.0 (files on the same Server) but on a WinNT4.0 SP5
machine, it works as expected (R starts without interpreting
"R_VSIZE=10M").


Regards,
Uwe Ligges
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Wed Apr 19 17:43:43 2000
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 19 Apr 2000 18:43:43 +0200 (CEST)
Subject: [Rd] INSTALL_SCRIPT during installation (PR#526)
In-Reply-To: <200004191527.RAA23531@pubhealth.ku.dk>
References: <200004191527.RAA23531@pubhealth.ku.dk>
Message-ID: <14589.57919.217396.444893@aragorn.ci.tuwien.ac.at>

>>>>> lamj  writes:

> The following patch uses INSTALL_SCRIPT to install scripts, as opposed
> to directly using INSTALL.  It is relative to R-1.0.1 source.

I am not sure this is really a bug, and the changes are already in 1.1.0
anyway.  If someone is willing to make the change in 1.0.1, please note:
the changes in Makeconf.in and src/scripts/Makefile.in are fine.  The
one in Makefile.in is not, because 1.1.0 has GUI shared libs as well,
which need INSTALL rather than INSTALL_SCRIPT.  I think one can get that
right via `grep -v '^bin/R_''.

Hmm ...

-k

>      -- Johnny C. Lam <lamj@stat.cmu.edu>
>         Department of Statistics, Carnegie Mellon University
>         http://www.stat.cmu.edu/~lamj/

> --- Makeconf.in.orig	Sat Jan 22 15:10:00 2000
> +++ Makeconf.in	Mon Apr 17 16:04:58 2000
> @@ -23,6 +23,7 @@
>  INSTALL = @INSTALL@
>  INSTALL_DATA = @INSTALL_DATA@
>  INSTALL_PROGRAM = @INSTALL_PROGRAM@
> +INSTALL_SCRIPT = @INSTALL_SCRIPT@
>  INSTALL_DIR = ${INSTALL} -d
>  LATEX = @LATEX@
>  LDCMD = @LDCMD@
> --- Makefile.in.orig	Mon Feb 21 02:03:26 2000
> +++ Makefile.in	Mon Apr 17 16:11:47 2000
> @@ -74,7 +74,7 @@
>  	@for f in `ls bin/* | grep -v '^bin/R\**$$' \
>  	                    | grep -v '^bin/R.X11\**$$' \
>  	                    | grep -v '^bin/R.GNOME\**$$'`; do \
> -	  $(INSTALL) $${f} $(rhome)/bin; \
> +	  $(INSTALL_SCRIPT) $${f} $(rhome)/bin; \
>  	done
>  	@echo "installing headers ..."
>  	@for f in include/*.h; do \
> --- src/scripts/Makefile.in.orig	Mon Feb 21 05:49:10 2000
> +++ src/scripts/Makefile.in	Mon Apr 17 16:13:11 2000
> @@ -38,10 +38,10 @@
>> $(top_builddir)/bin/R
>  	@chmod +x $(top_builddir)/bin/R
>  	@for f in $(SCRIPTS_S); do \
> -	  $(INSTALL) $(srcdir)/$$f $(top_builddir)/bin; \
> +	  $(INSTALL_SCRIPT) $(srcdir)/$$f $(top_builddir)/bin; \
>  	done
>  	@for f in $(SCRIPTS_B); do \
> -	  $(INSTALL) $$f $(top_builddir)/bin; \
> +	  $(INSTALL_SCRIPT) $$f $(top_builddir)/bin; \
>  	done
 
>  $(SCRIPTS_B): $(top_builddir)/config.status


> -.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
> r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
> Send "info", "help", or "[un]subscribe"
> (in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
> _._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Wed Apr 19 22:10:49 2000
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Wed, 19 Apr 2000 17:10:49 -0400
Subject: [Rd] R CMD check seg fault in Linux
Message-ID: <38FE20D9.E83527F9@bank-banque-canada.ca>

For some of my packages I am getting a segmentation fault in Linux when
I use R CMD check. (Using R 1.0.1) The segmentation fault does not
happen in Solaris and in some cases it does not happen in Linux if I set
R_NSIZE and R_VSIZE much higher than I need in Solaris. Should I expect
a segmentation fault if there is not enough memory for R CMD check, or
are these unrelated?

Paul Gilbert

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Wed Apr 19 22:55:58 2000
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 19 Apr 2000 23:55:58 +0200
Subject: [Rd] R CMD check seg fault in Linux
In-Reply-To: Paul Gilbert's message of "Wed, 19 Apr 2000 17:10:49 -0400"
References: <38FE20D9.E83527F9@bank-banque-canada.ca>
Message-ID: <x2ya69kb69.fsf@blueberry.kubism.ku.dk>

Paul Gilbert <pgilbert@bank-banque-canada.ca> writes:

> For some of my packages I am getting a segmentation fault in Linux when
> I use R CMD check. (Using R 1.0.1) The segmentation fault does not
> happen in Solaris and in some cases it does not happen in Linux if I set
> R_NSIZE and R_VSIZE much higher than I need in Solaris. Should I expect
> a segmentation fault if there is not enough memory for R CMD check, or
> are these unrelated?

It's certainly not the intention to give segfaults for that reason...

However, the same pattern could occur from PROTECT errors in your C
code, triggered by a garbage collection at just the wrong moment
(which could be different on different OSs). 

You should rerun the relevant testscript under "R -d gdb" and see
exactly where the segfault occurs.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Thu Apr 20 16:28:54 2000
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Thu, 20 Apr 2000 11:28:54 -0400
Subject: [Rd] R CMD check seg fault in Linux
References: <38FE20D9.E83527F9@bank-banque-canada.ca> <x2ya69kb69.fsf@blueberry.kubism.ku.dk>
Message-ID: <38FF2236.AFE7EC04@bank-banque-canada.ca>

>>Should I expect
>> a segmentation fault if there is not enough memory for R CMD check, or
>> are these unrelated?

>It's certainly not the intention to give segfaults for that reason...
...
>You should rerun the relevant testscript under "R -d gdb" and see
>exactly where the segfault occurs.

It seems the correlation with CMD check and memory was spurious but I have now
observered that the seg faults occur when I run tests on one Linux machine, but
not when I run on the Linux machine I used for installing R (from source) and my
code (which includes some fortan). The machines have similar Linux2.2.9/Mandrake
installations (but fortran didn't get installed on one). The biggest difference
is that the one with fortran installed has has a Celeron processor and the other
one has an AMD-K6. I've never had problems with this differences before. It
might be some time before I get a chance to really dig into it with gdb so if
anyone has any quick insights I would appreciate suggestions. Would there be
compiler flags for different processors or anything like that which might cause
a problem?

Thanks,
Paul Gilbert

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pd@blueberry.kubism.ku.dk  Fri Apr 21 06:15:04 2000
From: pd@blueberry.kubism.ku.dk (Peter Dalgaard BSA)
Date: Fri, 21 Apr 2000 07:15:04 +0200
Subject: [Rd] Bug list summary (automatic post)
Message-ID: <200004210515.HAA04991@blueberry.kubism.ku.dk>

=================================================
This is an automated summary of the status of the R-bugs
repository.

Note that this may be neither complete nor perfectly
correct at any given instance: Not all bugs are reported,
and some reported bugs may have been fixed, but the
repository not yet updated.

Some bug fixes are difficult to verify because they pertain
to specific hardware or operating system versions. If you
have information to contribute, please do so.

If you happen to know how to fix a problem please send
patches to the bug repository, too.

New bugs are reported either through the web
interface at r-bugs.biostat.ku.dk or via email to
r-bugs@biostat.ku.dk. The bug.report() function can be
used to automate parts of the procedure on many systems.
Followups on older bugs can be done by including the string
"(PR#999)" in the Subject of an email (change 999 to the
actual reference number, of course!).
=================================================

Directory:  Accuracy

none

Directory:  Add-ons

* PR# 503 *
Subject: dmvnorm() bug in e1071
From: "Gregory R. Warnes" <warnes@biostat.washington.edu>
Date: Fri, 24 Mar 2000 03:24:45 +0000 (GMT)
* PR# 496 *
From: bonneau@epi.roazhon.inra.fr (en148)
Date: Tue, 21 Mar 2000 10:57:13 +0100 (MET)
--base R has no est.variogram function.
--This appears to be a bug report on sgeostat.
* PR# 488 *
Subject: Error in lme?
From: simon.frost@ed.ac.uk
Date: Tue, 14 Mar 2000 14:15:52 +0100 (MET)
--No example to reproduce this.
* PR# 471 *
Subject:  Problems with nlme 
From: Berwin Turlach <berwin@maths.uwa.edu.au>
Date: Tue, 7 Mar 2000 15:28:00 +0800
--Problem 1) was a subscripting bug introduced in 1.0.0 and fixed for 1.0.1
--Problem 2) (mssing datasets) needs a revised nlme

Directory:  Analyses

none

Directory:  Documentation

none

Directory:  Graphics

* PR# 510 *
Subject:  Strange behaviour of image 
From: J.C.Rougier@durham.ac.uk
Date: Thu, 6 Apr 2000 19:15:19 +0100 (BST)
--At least an inaccurate description.
--To be changed (with a back-compatibility option) in 1.1.0
* PR# 400 *
Subject: X11 troubles
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 13 Jan 2000 14:31:42 +0100
--a) We don't handle multiple window closes well
--b) X11 errors should be caught by an error handler, not kill R
* PR# 202 *
Subject: persp box occlusion bug
From: wsi@gcal.ac.uk
Date: Wed, 2 Jun 1999 15:02:03 +0200 (MET DST)
--The persp algorithm does not apply the occlusion rules to the frame, 
--which is always plotted first. 
--A bug, but not very simple to fix.
* PR# 495 *
Subject: barplot
From: skala@incoma.cz
Date: Tue, 21 Mar 2000 09:20:33 +0100 (MET)
* PR# 414 *
Subject:  graphics bugs: steep slopes and large values beyond ylim 
From: Ben Bolker <bolker@zoo.ufl.edu>
Date: Mon, 7 Feb 2000 18:28:04 -0500
--Followup on R-devel showed this was due to generating integer coordinates 
--outside +/- 2^15 in the X11 driver.

Directory:  In-Out

none

Directory:  Installation

* PR# 485 *
Subject: Install R1.0.0
From: Lynn Zhang <lyzhang@umich.edu>
Date: Mon, 13 Mar 2000 16:10:52 -0500 (EST)
* PR# 478 *
Subject: Conditional for XDR code left out in saveload.c
From: hoffmann@ehmgs2.et.tu-dresden.de
Date: Thu, 9 Mar 2000 09:43:01 +0100 (MET)
--This seems to be a harmless warning, not an error.
* PR# 467 *
Subject: Re: [R] Re: R-1.0.0 is released
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 01 Mar 2000 20:26:40 +0100
--followup to PR#466
* PR# 466 *
Subject: Re: R-1.0.0 is released
From: bhoel@server.python.net (Berthold=?iso-8859-1?q?_H=F6llmann?=)
Date: 01 Mar 2000 16:00:54 +0100

Directory:  Language

* PR# 412 *
Subject: anomalies with call objects
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 06 Feb 2000 01:18:50 +0100
* PR# 408 *
Subject: convolution bug
From: wsimpson@gcal.ac.uk
Date: Fri, 28 Jan 2000 11:17:36 +0100 (MET)

Directory:  Low-level

* PR# 505 *
Subject: interrupted save 
From: Thomas Lumley <thomas@biostat.washington.edu>
Date: Sat, 25 Mar 2000 12:16:50 -0800 (PST)

Directory:  Misc

none

Directory:  Models

none

Directory:  Startup

* PR# 486 *
Subject: Re: autoload error in profile {was anova-bug in R-version  1.0.0?}
From: Martin Maechler <maechler@stat.math.ethz.ch>
Date: Tue, 14 Mar 2000 10:32:43 +0100 (MET)
--workaround to the origin problem in 1.0.1
--New report: try does not work from the profile.

Directory:  System-specific

* PR# 490 *
Subject: R-1.0.0 on alpha/osf1 memory glitch
From: Ray Brownrigg <Ray.Brownrigg@mcs.vuw.ac.nz>
Date: Fri, 17 Mar 2000 11:25:30 +1300 (NZDT)
* PR# 452 *
Subject: problem with glm
From: Brad McNeney <mcneney@cs.sfu.ca>
Date: Fri, 18 Feb 2000 17:51:54 -0800 (PST)
--Problems on Alpha's with glm. Status unclear

Directory:  TooMuchAtOnce

none

Directory:  Windows

none

Directory:  incoming

* PR# 526 *
Subject: INSTALL_SCRIPT during installation
From: "Johnny C. Lam" <lamj@stat.cmu.edu>
Date: Wed, 19 Apr 2000 11:27:52 -0400
* PR# 520 *
Subject: Rd2Sd conversion: files
From: Sergei Zuyev <sergei@stams.strath.ac.uk>
Date: Fri, 14 Apr 2000 13:26:19 +0100
* PR# 519 *
Subject: bundle build and Rd2Sd converion fail
From: Sergei Zuyev <sergei@stams.strath.ac.uk>
Date: Fri, 14 Apr 2000 13:13:48 +0100
* PR# 522 *
Subject: na.omit fails for matrices
From: Sergei Zuyev <sergei@stams.strath.ac.uk>
Date: Mon, 17 Apr 2000 11:52:28 +0100
* PR# 521 *
Subject: akima core dumps on loading
From: santini@dsi.unimi.it
Date: Mon, 17 Apr 2000 11:30:41 +0200 (MET DST)
* PR# 525 *
Subject: Windows-specific: image(z,zlim=()) gives bogus colors outside range
From: Ben Bolker <ben@zoo.ufl.edu>
Date: Wed, 19 Apr 2000 10:20:12 -0400 (EDT)
* PR# 524 *
Subject: strheight() crashes without opened device
From: Uwe Ligges <ligges@statistik.uni-dortmund.de>
Date: Tue, 18 Apr 2000 19:42:00 +0200
* PR# 523 *
Subject: Maths in R documentation
From: Martyn Plummer <plummer@iarc.fr>
Date: Mon, 17 Apr 2000 18:18:55 +0200 (CEST)
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From salwin@mitretek.org  Mon Apr 24 19:36:55 2000
From: salwin@mitretek.org (salwin@mitretek.org)
Date: Mon, 24 Apr 2000 20:36:55 +0200 (MET DST)
Subject: [Rd] Comments on Win95 R Distribution (PR#527)
Message-ID: <200004241836.UAA08583@pubhealth.ku.dk>

Here are some comments generated by a new R user based on
initial experiences with the tool.  

On-line help for tapply:
The following appears "for to each (non-empty) group of
values"  It seems there's an extra preposition in this
sentence.

On-line help for cut:
"break" should be "breaks"

morley.data not available with the distribution.  Would be
helpful for doing the examples in the Intro.

The rwinst.exe did not work at all on Win95.  It could find
no files.  Wasn't clear from the instructions which
directory I should be in while running rwinst.  I tried
several; none worked.  So I manually unzipped the files and
they worked fine.  


-- 
Art Salwin
salwin@mitretek.org
(202) 863-2985
(202) 863-2988 (fax)

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Tue Apr 25 08:09:32 2000
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Tue, 25 Apr 2000 08:09:32 +0100 (BST)
Subject: [Rd] Comments on Win95 R Distribution (PR#527)
In-Reply-To: <200004241836.UAA08583@pubhealth.ku.dk>
Message-ID: <Pine.GSO.4.05.10004250800560.13729-100000@auk.stats>

On Mon, 24 Apr 2000 salwin@mitretek.org wrote:

> Here are some comments generated by a new R user based on
> initial experiences with the tool.  

Please give the R version number or (preferably) use bug.report() to
generate the report.

> On-line help for tapply:
> The following appears "for to each (non-empty) group of
> values"  It seems there's an extra preposition in this
> sentence.
> 
> On-line help for cut:
> "break" should be "breaks"

[Fixed, thank you]

> morley.data not available with the distribution.  Would be
> helpful for doing the examples in the Intro.

That has already been altered for R 1.1. The file is in the Rnotes
package on CRAN at present, and will be in 1.1.0 on.

> The rwinst.exe did not work at all on Win95.  It could find
> no files.  Wasn't clear from the instructions which
> directory I should be in while running rwinst.  I tried
> several; none worked.  So I manually unzipped the files and
> they worked fine.  

You can use it from anywhere, hence it does not specify where. This
puzzles me: you have to set the source directory to where the files
are: use the Browse button to do so.  The installer is known to work
on Windows 95, and there have been many, many, successful uses.
Could you please try again using Browse to get the right directory
with the zip files?


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From john.maindonald@anu.edu.au  Wed Apr 26 03:41:51 2000
From: john.maindonald@anu.edu.au (john.maindonald@anu.edu.au)
Date: Wed, 26 Apr 2000 04:41:51 +0200 (MET DST)
Subject: [Rd] Wrong SEs in predict.lm(..., type="terms") (PR#528)
Message-ID: <200004260241.EAA22007@pubhealth.ku.dk>

>From e980153 Tue Apr 25 14:42:27 2000
To: r-help@stat.math.ethz.ch
Subject: Wrong SEs in predict.lm(..., type="terms")

For what it is worth, I am using RW-1.0.0 under Windows 98.
I submitted this earlier to r-help.  There is one change
below to my proposed corrected code:

predict.lm(..., type="terms") gives wrong standard errors.

Below, I have provided what I believe are the necessary fixes.
However, there are subtleties, and the code needs careful
checking.  Some of the looping is surely not necessary, but
it is surely best to begin with the minimum necessary changes.

My tests, including checks against S-PLUS, have extended to fitting
spline curves.  I have not tested the code with any example where
the pivot sequence does not run sequentially from 1 to p1.

df<-data.frame(x=1:9,y=c(2,3,6,4,8,10,12,14,15))
> df.lm_lm(y~x,data=df)
> as.vector(predict(df.lm,se=T,type="terms")$se.fit)
[1] 0.9904885 0.7428664 0.4952442 0.2476221 0.0000000 0.2476221 0.4952442
[8] 0.7428664 0.9904885

Here is what one should get:
> abs((df$x-mean(df$x)))*summary(df.lm)$coef[2,2]
[1] 0.5769836 0.4327377 0.2884918 0.1442459 0.0000000 0.1442459 0.2884918
[8] 0.4327377 0.5769836

Here is the relevant section of corrected code:


    if (type=="terms"){
      asgn <- attrassign(object)
      beta<-coef(object)
      hasintercept<-attr(tt,"intercept")>0
      if (hasintercept)
        asgn$"(Intercept)"<-NULL
      nterms<-length(asgn)
      predictor<-matrix(ncol=nterms,nrow=NROW(X))
      dimnames(predictor)<-list(rownames(X),names(asgn))

      if (se.fit){
        ip<-matrix(ncol=nterms,nrow=NROW(X))
        dimnames(ip)<-list(rownames(X),names(asgn))
      }
      if (hasintercept){     # This was omitted in the code on r-help
        avX<-apply(X,2,mean)  
        X<-sweep(X,2,avX)    # We'd best sweep out column means
                             # before we start
      }
      for (i in seq(1,nterms,length=nterms)){
        ii<-piv[asgn[[i]]]
	        predictor[,i]<-X[,ii,drop=F]%*%(beta[ii])
        if (se.fit){
          ii2_asgn[[i]]      # X[,piv] matches rows & columns of R
          vci<-R[ii2,ii2]*res.var
          for(j in (1:NROW(X))){
            xi<-X[j,ii,drop=F]  # Do not multiply by beta[ii]
           ip[j,i]<-sum(xi%*% vci %*%t(xi))

          }
        }
      }

Here is the existing section of the (1.0.0) code:

    if (type=="terms"){
      asgn <- attrassign(object)
      beta<-coef(object)
      hasintercept<-attr(tt,"intercept")>0
      if (hasintercept)
        asgn$"(Intercept)"<-NULL
      nterms<-length(asgn)
      predictor<-matrix(ncol=nterms,nrow=NROW(X))
      dimnames(predictor)<-list(rownames(X),names(asgn))
      if (se.fit){
        ip<-matrix(ncol=nterms,nrow=NROW(X))
        dimnames(ip)<-list(rownames(X),names(asgn))
      }
      for (i in seq(1,nterms,length=nterms)){
        if (hasintercept)  # Redundant
          i0<-1            # Redundant
        else               # Redundant
          i0<-NULL         # Redundant
        ii<-piv[asgn[[i]]]
        predictor[,i]<-X[,ii,drop=F]%*%(beta[ii])  # Should be centred
        X[,ii]<-X[,ii]-mean(X[,ii]) # Columns must be centred individually
        if (se.fit){
          vci<-R[ii,ii]*res.var    # The pivot should not be applied to R
          for(j in (1:NROW(X))){
            xi<-X[j,ii,drop=F]*(beta[ii])  # Do not Xply by beta
            ip[j,i]<-sum(xi%*% vci %*%t(xi))
          }
        }
      }


John Maindonald               email : john.maindonald@anu.edu.au        
Statistical Consulting Unit,  phone : (6249)3998        
c/o CMA, SMS,                 fax   : (6249)5549  
John Dedman Mathematical Sciences Building
Australian National University
Canberra ACT 0200
Australia


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From bates@stat.wisc.edu  Thu Apr 27 00:05:14 2000
From: bates@stat.wisc.edu (Douglas Bates)
Date: Wed, 26 Apr 2000 18:05:14 -0500 (CDT)
Subject: [Rd] Cross compiling a package for Windows on Linux
Message-ID: <m12karq-000ZSaC@franz.stat.wisc.edu>

I would like to compile for Windows a rather simple R package that
contains some C code.  It does not contain any Fortran code.

I tried the cross-compilation route using the pre-built set of tools
from http://www.devolution.com/~slouken/SDL/Xmingw32/, as described in
$R_SRC/src/gnuwin32/INSTALL

Using the sources in r-devel from the rsync site I am able to build
libR.a in src/gnuwin32 but I can't build the package.  Using the
sources in r-release-patched from the rsync site I am unable to build
libR.a.  The tail end of that compilation log is

 $ cd r-release/src/gnuwin32/
 $ make
 mkdir -p ../../bin 
 make -C ./fixed
 make[1]: Entering directory `/usr/src/r-release/src/gnuwin32/fixed'
 -------- Building ../../../library/base/R/Rprofile from ../../library/profile/Common.R ../../library/profile/Rprofile.gnw--------
 mkdir -p ../../../library/base/R
 cat  ../../library/profile/Common.R ../../library/profile/Rprofile.gnw > ../../../library/base/R/Rprofile
 sed -e '/^#/d' -e '/Rsockfork/d' -e 's/F77_SUBROUTINE(\(.*\))/void * \1_();/' -e 's/C_FUNCTION(\(.*\))/void * \1();/' ../../appl/ROUTINES > ../../include/FFDecl.h
 sed -e '/^#/d' -e '/Rsockfork/d' -e 's/F77_SUBROUTINE(\(.*\))/	{ "\1_",	\1_},/' -e 's/C_FUNCTION(\(.*\))/{ "\1",	\1 },/' ../../appl/ROUTINES > ../../include/FFTab.h
 sh ./GETCONFIG > ../../include/Rconfig.h
 sh ./GETVERSION > ../../include/Rversion.h
 cp -p ./h/config.h ./h/psignal.h ../../include
 echo done > fixh
 (cd ../../../doc; \
 cat html/search/SearchEngine-head.html > html/search/SearchEngine.html; \
 perl ../src/gnuwin32/fixed/keywords2html KEYWORDS.db >> html/search/SearchEngine.html; \
 cat html/search/SearchEngine-foot.html >> html/search/SearchEngine.html)
 cp -p ./r/*.html ../../../doc/html
 echo done > fixr
 cp -p  bin/Rd2dvi.sh bin/Rd2txt.bat bin/Rdconv.bat bin/Rdindex.bat bin/Sd2Rd.bat bin/fwf2table bin/helpPRINT.bat ../../../bin
 echo done > fixbin
 cp -p etc/Rconsole etc/Rdevga etc/Rprofile etc/rgb.txt ../../../etc
 echo done > fixetc
 ...  (many lines deleted)
 i386-mingw32-gcc -isystem /packages/R-X/i386-mingw32/include   -O2 -Wall -pedantic -I../include -I../include/R_ext -DHAVE_CONFIG_H  -c zeroin.c -o zeroin.o
 i386-mingw32-g77 -O2 -Wall -pedantic  -c blas.f -o blas.o
 make[1]: i386-mingw32-g77: Command not found
 make[1]: *** [blas.o] Error 127
 make[1]: Leaving directory `/usr/src/r-release/src/appl'
 make: *** [rlibs] Error 2
 $ make libR.a
 i386-mingw32-gcc -isystem /packages/R-X/i386-mingw32/include   -O2 -Wall -pedantic -I../include -I../include/R_ext -I. -DHAVE_CONFIG_H  -c console.c -o console.o
 i386-mingw32-gcc -isystem /packages/R-X/i386-mingw32/include   -O2 -Wall -pedantic -I../include -I../include/R_ext -I. -DHAVE_CONFIG_H  -c dataentry.c -o dataentry.o
 i386-mingw32-gcc -isystem /packages/R-X/i386-mingw32/include   -O2 -Wall -pedantic -I../include -I../include/R_ext -I. -DHAVE_CONFIG_H  -c devga.c -o devga.o
 i386-mingw32-gcc -isystem /packages/R-X/i386-mingw32/include   -O2 -Wall -pedantic -I../include -I../include/R_ext -I. -DHAVE_CONFIG_H  -c dodevga.c -o dodevga.o
 i386-mingw32-gcc -isystem /packages/R-X/i386-mingw32/include   -O2 -Wall -pedantic -I../include -I../include/R_ext -I. -DHAVE_CONFIG_H  -c dounzip.c -o dounzip.o
 i386-mingw32-gcc -isystem /packages/R-X/i386-mingw32/include   -O2 -Wall -pedantic -I../include -I../include/R_ext -I. -DHAVE_CONFIG_H  -c dynload.c -o dynload.o
 i386-mingw32-gcc -isystem /packages/R-X/i386-mingw32/include   -O2 -Wall -pedantic -I../include -I../include/R_ext -I. -DHAVE_CONFIG_H  -c edit.c -o edit.o
 i386-mingw32-gcc -isystem /packages/R-X/i386-mingw32/include   -O2 -Wall -pedantic -I../include -I../include/R_ext -I. -DHAVE_CONFIG_H  -c extra.c -o extra.o
 extra.c: In function `Rwin_fpset':
 extra.c:452: warning: implicit declaration of function `_fpreset'
 extra.c:453: warning: implicit declaration of function `_controlfp'
 extra.c:453: `_MCW_EM' undeclared (first use in this function)
 extra.c:453: (Each undeclared identifier is reported only once
 extra.c:453: for each function it appears in.)
 make: *** [extra.o] Error 1
 $ i386-mingw32-gcc --version
 2.95.2


With the sources from r-devel, which have been changed today, I can
generate libR.a but I cannot build a library, even with libR.a.  I
tried building the nls library just as a test.  The errors reported after 
make pkg-nls are

 $ make pkg-nls
 make DLLNM=  EXTRADOCS= \
   -C /usr/src/r-devel/src/library/nls PKG=nls RHOME=/usr/src/r-devel RLIB=/usr/src/r-devel/library \
   -f /usr/src/r-devel/src/gnuwin32/MakePkg
 make[1]: Entering directory `/usr/src/r-devel/src/library/nls'
 ---------- Making package nls ------------
 mkdir -p /usr/src/r-devel/library/nls
 cp -r   ./DESCRIPTION  ./INDEX  ./TITLE  /usr/src/r-devel/library/nls/
 cp: ./DESCRIPTION: No such file or directory
 make[1]: [/usr/src/r-devel/library/nls/zzzz] Error 1 (ignored)
 make -C ./src RHOME=/usr/src/r-devel \
   -f /usr/src/r-devel/src/gnuwin32/MakeDll DLLNAME=nls
 make[2]: Entering directory `/usr/src/r-devel/src/library/nls/src'
 ------- Building nls.dll from nls.a --------
 echo LIBRARY nls > nls.def
 echo EXPORTS >> nls.def
 i386-mingw32-nm nls.a > Defs
 sed -n "/^........ [BCDRT] _/s/^........ [BCDRT] _/ /p" Defs >> nls.def
 i386-mingw32-gcc  -mdll -Wl,--base-file,nls.b -s  -o nls.dll  nls.a  -L/usr/src/r-devel/src/gnuwin32   -lR 
 i386-mingw32-dlltool -k --as i386-mingw32-as   --dllname nls.dll  --base-file nls.b --output-exp nls.e --def nls.def
 i386-mingw32-gcc  -mdll  -Wl,--base-file,nls.b -s  -o nls.dll nls.e nls.a  -L/usr/src/r-devel/src/gnuwin32   -lR 
 nls.a(nls.o)(.text+0x203):nls.c: undefined reference to `Rf_asLogical'
 nls.a(nls.o)(.text+0x20f):nls.c: undefined reference to `Rf_isNewList'
 nls.a(nls.o)(.text+0x223):nls.c: undefined reference to `Rf_error'
 ...  (many lines deleted)
 nls.a(nls.o)(.text+0xb52):nls.c: undefined reference to `Rf_setAttrib'
 nls.a(nls.o)(.text+0xb5c):nls.c: undefined reference to `Rf_unprotect'
 make[2]: *** [nls.dll] Error 1
 make[2]: Leaving directory `/usr/src/r-devel/src/library/nls/src'
 make[1]: *** [src/nls.dll] Error 2
 make[1]: Leaving directory `/usr/src/r-devel/src/library/nls'
 make: *** [pkg-nls] Error 2

Do I need to go back and build a cross-compiler for g77 and start from
scratch?
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Thu Apr 27 07:30:48 2000
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Thu, 27 Apr 2000 07:30:48 +0100 (BST)
Subject: [Rd] Cross compiling a package for Windows on Linux
In-Reply-To: <m12karq-000ZSaC@franz.stat.wisc.edu>
Message-ID: <Pine.GSO.4.05.10004270708090.26167-100000@auk.stats>

On Wed, 26 Apr 2000, Douglas Bates wrote:

> I would like to compile for Windows a rather simple R package that
> contains some C code.  It does not contain any Fortran code.
> 
> I tried the cross-compilation route using the pre-built set of tools
> from http://www.devolution.com/~slouken/SDL/Xmingw32/, as described in
> $R_SRC/src/gnuwin32/INSTALL
> 
> Using the sources in r-devel from the rsync site I am able to build
> libR.a in src/gnuwin32 but I can't build the package.  Using the

Almost certainly you built an incorrect libR.a from the evidence below.

> sources in r-release-patched from the rsync site I am unable to build
> libR.a.  The tail end of that compilation log is
> 
>  $ cd r-release/src/gnuwin32/
>  $ make
>  mkdir -p ../../bin 
>  make -C ./fixed

...

If you use Makefile you are trying to build R, and you can't do that
without Fortran.  To build just a package you need Makefile.packages
and the distributed R.exp file.


>  make[1]: Entering directory `/usr/src/r-release/src/gnuwin32/fixed'
>  -------- Building ../../../library/base/R/Rprofile from ../../library/profile/Common.R ../../library/profile/Rprofile.gnw--------
>  mkdir -p ../../../library/base/R
>  cat  ../../library/profile/Common.R ../../library/profile/Rprofile.gnw > ../../../library/base/R/Rprofile
>  sed -e '/^#/d' -e '/Rsockfork/d' -e 's/F77_SUBROUTINE(\(.*\))/void * \1_();/' -e 's/C_FUNCTION(\(.*\))/void * \1();/' ../../appl/ROUTINES > ../../include/FFDecl.h
>  sed -e '/^#/d' -e '/Rsockfork/d' -e 's/F77_SUBROUTINE(\(.*\))/	{ "\1_",	\1_},/' -e 's/C_FUNCTION(\(.*\))/{ "\1",	\1 },/' ../../appl/ROUTINES > ../../include/FFTab.h
>  sh ./GETCONFIG > ../../include/Rconfig.h
>  sh ./GETVERSION > ../../include/Rversion.h
>  cp -p ./h/config.h ./h/psignal.h ../../include
>  echo done > fixh
>  (cd ../../../doc; \
>  cat html/search/SearchEngine-head.html > html/search/SearchEngine.html; \
>  perl ../src/gnuwin32/fixed/keywords2html KEYWORDS.db >> html/search/SearchEngine.html; \
>  cat html/search/SearchEngine-foot.html >> html/search/SearchEngine.html)
>  cp -p ./r/*.html ../../../doc/html
>  echo done > fixr
>  cp -p  bin/Rd2dvi.sh bin/Rd2txt.bat bin/Rdconv.bat bin/Rdindex.bat bin/Sd2Rd.bat bin/fwf2table bin/helpPRINT.bat ../../../bin
>  echo done > fixbin
>  cp -p etc/Rconsole etc/Rdevga etc/Rprofile etc/rgb.txt ../../../etc
>  echo done > fixetc
>  ...  (many lines deleted)
>  i386-mingw32-gcc -isystem /packages/R-X/i386-mingw32/include   -O2 -Wall -pedantic -I../include -I../include/R_ext -DHAVE_CONFIG_H  -c zeroin.c -o zeroin.o
>  i386-mingw32-g77 -O2 -Wall -pedantic  -c blas.f -o blas.o
>  make[1]: i386-mingw32-g77: Command not found
>  make[1]: *** [blas.o] Error 127
>  make[1]: Leaving directory `/usr/src/r-release/src/appl'
>  make: *** [rlibs] Error 2
>  $ make libR.a
>  i386-mingw32-gcc -isystem /packages/R-X/i386-mingw32/include   -O2 -Wall -pedantic -I../include -I../include/R_ext -I. -DHAVE_CONFIG_H  -c console.c -o console.o
>  i386-mingw32-gcc -isystem /packages/R-X/i386-mingw32/include   -O2 -Wall -pedantic -I../include -I../include/R_ext -I. -DHAVE_CONFIG_H  -c dataentry.c -o dataentry.o
>  i386-mingw32-gcc -isystem /packages/R-X/i386-mingw32/include   -O2 -Wall -pedantic -I../include -I../include/R_ext -I. -DHAVE_CONFIG_H  -c devga.c -o devga.o
>  i386-mingw32-gcc -isystem /packages/R-X/i386-mingw32/include   -O2 -Wall -pedantic -I../include -I../include/R_ext -I. -DHAVE_CONFIG_H  -c dodevga.c -o dodevga.o
>  i386-mingw32-gcc -isystem /packages/R-X/i386-mingw32/include   -O2 -Wall -pedantic -I../include -I../include/R_ext -I. -DHAVE_CONFIG_H  -c dounzip.c -o dounzip.o
>  i386-mingw32-gcc -isystem /packages/R-X/i386-mingw32/include   -O2 -Wall -pedantic -I../include -I../include/R_ext -I. -DHAVE_CONFIG_H  -c dynload.c -o dynload.o
>  i386-mingw32-gcc -isystem /packages/R-X/i386-mingw32/include   -O2 -Wall -pedantic -I../include -I../include/R_ext -I. -DHAVE_CONFIG_H  -c edit.c -o edit.o
>  i386-mingw32-gcc -isystem /packages/R-X/i386-mingw32/include   -O2 -Wall -pedantic -I../include -I../include/R_ext -I. -DHAVE_CONFIG_H  -c extra.c -o extra.o
>  extra.c: In function `Rwin_fpset':
>  extra.c:452: warning: implicit declaration of function `_fpreset'
>  extra.c:453: warning: implicit declaration of function `_controlfp'
>  extra.c:453: `_MCW_EM' undeclared (first use in this function)
>  extra.c:453: (Each undeclared identifier is reported only once
>  extra.c:453: for each function it appears in.)
>  make: *** [extra.o] Error 1
>  $ i386-mingw32-gcc --version
>  2.95.2

I think you omitted to customize MkRules: it seems highly unlikely that
/packages/R-X/i386-mingw32/include is correct for you (it is from my
system): INSTALL says

> Edit MkRules to set BUILD=CROSS and the appropriate paths as needed.

and you need to set HEADER.  In any case, you are getting the wrong
headers.

> With the sources from r-devel, which have been changed today, I can
> generate libR.a but I cannot build a library, even with libR.a.  
> I tried building the nls library just as a test.  The errors reported
after 
> make pkg-nls are
> 
>  $ make pkg-nls

[...]

Looks like libR.a is wrong as R.exp is corrupt (probably empty). When I try
`make libR.a' on R-devel it behaves as for R-release.

The short answer is that you need R.exp, and to get that you need either to
build the whole of R (for which you need g77) or get the one in rwxxxxsp.  
What I suggest you do is to unpack rw1001 (you'll need I think the just
rw1001b? and rw1001sp zip files) and use that. The binary distribution has
the correct Makefile and supplies R.exp.  Last time I tried that
cross-compiled out of the box.

As you noted, I am in the process of changing the Makefiles and
instructions, mainly because the Cygwin release has changed and (aargh!)
not longer has a fully functional make, and the header set has also
changed.  It's a rash assumption that the R-devel or R-release-patched
will cross-compile as we only test that occasionally, including just before
release.

Brian

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Thu Apr 27 08:27:55 2000
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 27 Apr 2000 09:27:55 +0200
Subject: [Rd] Cross compiling a package for Windows on Linux
In-Reply-To: Prof Brian D Ripley's message of "Thu, 27 Apr 2000 07:30:48 +0100 (BST)"
References: <Pine.GSO.4.05.10004270708090.26167-100000@auk.stats>
Message-ID: <x24s8of1fo.fsf@blueberry.kubism.ku.dk>

Prof Brian D Ripley <ripley@stats.ox.ac.uk> writes:

> As you noted, I am in the process of changing the Makefiles and
> instructions, mainly because the Cygwin release has changed and (aargh!)
> not longer has a fully functional make, and the header set has also
> changed.  It's a rash assumption that the R-devel or R-release-patched
> will cross-compile as we only test that occasionally, including just before
> release.

It did last night, though (R-1-0-patches, that is).

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From yaacov@mscc.huji.ac.il  Thu Apr 27 11:56:54 2000
From: yaacov@mscc.huji.ac.il (jr)
Date: Thu, 27 Apr 2000 13:56:54 +0300
Subject: [Rd] R
Message-ID: <005101bfb038$02ff34c0$57058b80@ritov>

I guess there is a mistake in the function princomp (package mva).
I believe that the scores are computed wrongly under cor=TRUE condition:

Lines 42-43:

    if (scores && !missing(x))
        scr <- scale(z, center = TRUE, scale = FALSE) %*% edc$vectors

should be replaced by something like

     if (scores && !missing(x) && !cor)
        scr <- scale(z, center = TRUE, scale = FALSE) %*% edc$vectors
    if (scores && !missing(x) && cor)
        scr <- scale(z) %*% edc$vectors


Sincerely

************************************************

Ya'acov Ritov
Department of Statistics
The Hebrew University of Jerusalem,
Jerusalem 91905
Israel
Tel. (972-2) 652-9929 (Okay way)
Fax (972-2) 652-9996
http://pluto.mscc.huji.ac.il/~yaacov/jr.html
AND THIS IS ANOTHER PROOF THAT IF YOU KEEP AN OPEN MIND, SOMEBODY WILL FILL IT
WITH RUBBISH (an anonymous BBC correspondent)


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Thu Apr 27 12:08:07 2000
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 27 Apr 2000 13:08:07 +0200
Subject: [Rd] Cross compiling a package for Windows on Linux
In-Reply-To: Peter Dalgaard BSA's message of "27 Apr 2000 09:27:55 +0200"
References: <Pine.GSO.4.05.10004270708090.26167-100000@auk.stats> <x24s8of1fo.fsf@blueberry.kubism.ku.dk>
Message-ID: <x2itx3ls2w.fsf@blueberry.kubism.ku.dk>

Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk> writes:

> Prof Brian D Ripley <ripley@stats.ox.ac.uk> writes:
> 
> > As you noted, I am in the process of changing the Makefiles and
> > instructions, mainly because the Cygwin release has changed and (aargh!)
> > not longer has a fully functional make, and the header set has also
> > changed.  It's a rash assumption that the R-devel or R-release-patched
> > will cross-compile as we only test that occasionally, including just before
> > release.
> 
> It did last night, though (R-1-0-patches, that is).

..as does R-devel as of this moment.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Thu Apr 27 13:17:54 2000
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Thu, 27 Apr 2000 14:17:54 +0200 (CEST)
Subject: [Rd] options(keep.source = TRUE) -- also for "library(.)" ?
Message-ID: <14600.12274.664989.534291@lynne.ethz.ch>

       help(options)

contains

    keep.source: When `TRUE', the default, the source code for functions
	      loaded by is stored in their `"source"' attribute, allowing
	      comments to be kept in the right places.  
	      This does not apply to functions loaded by `library'.
	      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

and R behaves as documented, i.e., currently
all functions in package:base and all "interactively defined" functions
keep their source (__including__ comments) with them, whereas all the other
functions do not.

As I tend to create small own packages more and more, and ask others to use
them, users of the packages (and myself) are suffering increasingly from
function definitions with lost comments. 

Can we [those of us who know how sys.source() works...]
think of changing this?  As it was possible for the base package, it must
be doable for the others as well....

Martin
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Thu Apr 27 13:37:01 2000
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 27 Apr 2000 14:37:01 +0200
Subject: [Rd] options(keep.source = TRUE) -- also for "library(.)" ?
In-Reply-To: Martin Maechler's message of "Thu, 27 Apr 2000 14:17:54 +0200 (CEST)"
References: <14600.12274.664989.534291@lynne.ethz.ch>
Message-ID: <x2d7nblnyq.fsf@blueberry.kubism.ku.dk>

Martin Maechler <maechler@stat.math.ethz.ch> writes:

> Can we [those of us who know how sys.source() works...]
> think of changing this?  As it was possible for the base package, it must
> be doable for the others as well....

Martin, surely you could have figured out to remove these two lines
from sys.source:

    oop <- options(keep.source = FALSE)
    on.exit(options(oop))

The real question is whether we want to have a different mechanism for
controlling whether keep.source is set or not. Originally it was FALSE
for the base library to save space, and according the same setting was
used for other libraries since some of them are rather large, but
later it got flipped to TRUE for base, and then there is little point
in setting it FALSE for packages. Question is whether anyone would
want the old behaviour back to get more space for analyses?

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Thu Apr 27 14:04:03 2000
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Thu, 27 Apr 2000 15:04:03 +0200 (CEST)
Subject: [Rd] options(keep.source = TRUE) -- also for "library(.)" ?
In-Reply-To: <x2d7nblnyq.fsf@blueberry.kubism.ku.dk>
References: <14600.12274.664989.534291@lynne.ethz.ch>
 <x2d7nblnyq.fsf@blueberry.kubism.ku.dk>
Message-ID: <14600.15043.86395.259088@lynne.ethz.ch>

>>>>> "PD" == Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk> writes:

    PD> Martin Maechler <maechler@stat.math.ethz.ch> writes:
    >> Can we [those of us who know how sys.source() works...]  think of
    >> changing this?  As it was possible for the base package, it must be
    >> doable for the others as well....

    PD> Martin, surely you could have figured out to remove these two lines
    PD> from sys.source:

    PD>     oop <- options(keep.source = FALSE)
    PD>      on.exit(options(oop))

[blush... *BLUSH* ...
 I didn't look at sys.source(); 
 just knew that parts of it used to look rather "magical" to me ..
]

Of course we now could even make 
   keep.source = getOption("keep.source") 
an argument to library(), being propagated to sys.source(..).

    PD> The real question is whether we want to have a different mechanism
    PD> for controlling whether keep.source is set or not. 
right.

    PD> Originally it was FALSE for the base library to save space, and
    PD> according the same setting was used for other libraries since some
    PD> of them are rather large, but later it got flipped to TRUE for
    PD> base,
(yes, I'm still wondering...)
    PD> and then there is little point in setting it FALSE for packages. 
    PD> Question is whether anyone would want the old behaviour
    PD> back to get more space for analyses?

would be nice if it *was* configurable for base as well;
possibly both via cmd line option
	 (something like --keepsource / --no-keepsource )
and a setting in Rprofile..

>From grepping through the source code, I don't see how it was turned off
for base...

Martin

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From kjetil.kjernsmo@astro.uio.no  Thu Apr 27 14:16:10 2000
From: kjetil.kjernsmo@astro.uio.no (Kjetil Kjernsmo)
Date: Thu, 27 Apr 2000 15:16:10 +0200 (MET DST)
Subject: [Rd] Re: [R] Writing lgrindefs
In-Reply-To: <3907EA6D.6BE703BF@statistik.uni-dortmund.de>
Message-ID: <Pine.OSF.4.05.10004271508590.9815-100000@alnair.uio.no>

On Thu, 27 Apr 2000, Uwe Ligges wrote:

>> however, having all the functions defined in base highlighted as keywords.
>> Would that be a good idea, and if it is, how can I extract the function
>> names most easily?
>
>1. You get a list of objects (not only functions!!!) by typing
>    ls(env=environment("R_GlobalEnv"))
>
>2. In the html-help files, e.g. the "Functions" index could help you.
>   Attention: Not only functions are listed here!

Yeah, that's the problem with both of those, that it doesn't only contain
functions. 

>3. For my R-WinEdt "package", I extracted names of functions of many R
>packages. 
>   If you want, I will send some files.

Oh, I thought about it, but then I figured for this to work consistently,
every user would have to generate his own defs, depending on what packages
he has installed, which would be a bit bothersome I guess. 

>Maybe R-devel is the better forum to discuss this?

Perhaps, so I send this reply there, I sent the original post to r-help
because I figured it might be an easy question for most. I assume that
most of the R-devel members are on the R-help list so I do not resend my
original post. If this assumption doesn't hold, please let me know.  

Best,

Kjetil
-- 
Kjetil Kjernsmo
Graduate astronomy-student                    Problems worthy of attack
University of Oslo, Norway            Prove their worth by hitting back
E-mail: kjetikj@astro.uio.no                                - Piet Hein
Homepage <URL:http://www.astro.uio.no/~kjetikj/>
Webmaster@skepsis.no 

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Prof Brian Ripley <ripley@stats.ox.ac.uk>  Thu Apr 27 14:57:41 2000
From: Prof Brian Ripley <ripley@stats.ox.ac.uk> (Prof Brian Ripley)
Date: Thu, 27 Apr 2000 14:57:41 +0100 (BST)
Subject: [Rd] options(keep.source = TRUE) -- also for "library(.)" ?
Message-ID: <200004271357.OAA21290@toucan.stats.ox.ac.uk>

> Subject: Re: [Rd] options(keep.source = TRUE) -- also for "library(.)" ?
> From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
> Date: 27 Apr 2000 14:37:01 +0200
> 
> Martin Maechler <maechler@stat.math.ethz.ch> writes:
> 
> > Can we [those of us who know how sys.source() works...]
> > think of changing this?  As it was possible for the base package, it must
> > be doable for the others as well....
> 
> Martin, surely you could have figured out to remove these two lines
> from sys.source:
> 
>     oop <- options(keep.source = FALSE)
>     on.exit(options(oop))
> 
> The real question is whether we want to have a different mechanism for
> controlling whether keep.source is set or not. Originally it was FALSE
> for the base library to save space, and according the same setting was
> used for other libraries since some of them are rather large, but
> later it got flipped to TRUE for base, and then there is little point
> in setting it FALSE for packages. Question is whether anyone would
> want the old behaviour back to get more space for analyses?

Yes, but really I would rather have packages stored in separate
workspaces that the garabage collector avoided. Then space is less of
an issue.  Ross I know suggested that, but I don't think anyone
is working on it.

My guess would be that we will not have any space/gc improvements
ready for 1.1, unless Luke's things are close. (BTW, Luke, is your
changed code available?  I went to think about doing some timings the
other night and realized that I thought not. A cvs branch might be good(ish)
way to let us play with it.)

Brian

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Friedrich.Leisch@ci.tuwien.ac.at  Thu Apr 27 15:09:00 2000
From: Friedrich.Leisch@ci.tuwien.ac.at (Friedrich Leisch)
Date: Thu, 27 Apr 2000 16:09:00 +0200 (CEST)
Subject: [Rd] Re: [R] Writing lgrindefs
In-Reply-To: <Pine.OSF.4.05.10004271508590.9815-100000@alnair.uio.no>
References: <3907EA6D.6BE703BF@statistik.uni-dortmund.de>
 <Pine.OSF.4.05.10004271508590.9815-100000@alnair.uio.no>
Message-ID: <14600.18940.551062.659955@galadriel.ci.tuwien.ac.at>

>>>>> On Thu, 27 Apr 2000 15:16:10 +0200 (MET DST),
>>>>> Kjetil Kjernsmo (KK) wrote:

KK> On Thu, 27 Apr 2000, Uwe Ligges wrote:
>>> however, having all the functions defined in base highlighted as keywords.
>>> Would that be a good idea, and if it is, how can I extract the function
>>> names most easily?
>> 
>> 1. You get a list of objects (not only functions!!!) by typing
>> ls(env=environment("R_GlobalEnv"))
>> 
>> 2. In the html-help files, e.g. the "Functions" index could help you.
>> Attention: Not only functions are listed here!


Finding out what is a function and what not is easy:

R> x<- ls("package:base")
R> x[40]
[1] ".lib.loc"
R> x[140]
[1] "anovalist.lm"

where the first is a vector and the second a function, which can
easily be traced:

R> sapply(x[c(40,140)],function(y){is.function(get(y))})
    .lib.loc anovalist.lm 
       FALSE         TRUE 

(don't know if this is the most elegant way of doing it). This leaves
all operators in the list as they are only functions allowing a
special syntax, hence if you want only ordinary functions, you could
simply discard those not starting with a dot or a letter.

Hope this helps,
Fritz

-- 
-------------------------------------------------------------------
                        Friedrich  Leisch 
Institut für Statistik                     Tel: (+43 1) 58801 10715
Technische Universität Wien                Fax: (+43 1) 58801 10798
Wiedner Hauptstraße 8-10/1071      Friedrich.Leisch@ci.tuwien.ac.at
A-1040 Wien, Austria             http://www.ci.tuwien.ac.at/~leisch
     PGP public key http://www.ci.tuwien.ac.at/~leisch/pgp.key
-------------------------------------------------------------------

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Friedrich.Leisch@ci.tuwien.ac.at  Thu Apr 27 15:42:05 2000
From: Friedrich.Leisch@ci.tuwien.ac.at (Friedrich Leisch)
Date: Thu, 27 Apr 2000 16:42:05 +0200 (CEST)
Subject: [Rd] Re: [R] Writing lgrindefs
In-Reply-To: <14600.18940.551062.659955@galadriel.ci.tuwien.ac.at>
References: <3907EA6D.6BE703BF@statistik.uni-dortmund.de>
 <Pine.OSF.4.05.10004271508590.9815-100000@alnair.uio.no>
 <14600.18940.551062.659955@galadriel.ci.tuwien.ac.at>
Message-ID: <14600.20925.394876.538432@galadriel.ci.tuwien.ac.at>

>>>>> On Thu, 27 Apr 2000 16:09:00 +0200 (CEST),
>>>>> Friedrich Leisch (FL) wrote:

>>>>> On Thu, 27 Apr 2000 15:16:10 +0200 (MET DST),
>>>>> Kjetil Kjernsmo (KK) wrote:

KK> On Thu, 27 Apr 2000, Uwe Ligges wrote:
>>>> however, having all the functions defined in base highlighted as keywords.
>>>> Would that be a good idea, and if it is, how can I extract the function
>>>> names most easily?
>>> 
>>> 1. You get a list of objects (not only functions!!!) by typing
>>> ls(env=environment("R_GlobalEnv"))
>>> 
>>> 2. In the html-help files, e.g. the "Functions" index could help you.
>>> Attention: Not only functions are listed here!


FL> Finding out what is a function and what not is easy:

R> x<- ls("package:base")

sorry, forgot the all=TRUE here ...

.f
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ligges@statistik.uni-dortmund.de  Thu Apr 27 16:47:54 2000
From: ligges@statistik.uni-dortmund.de (Uwe Ligges)
Date: Thu, 27 Apr 2000 17:47:54 +0200
Subject: [Rd] Writing lgrindefs
References: <Pine.OSF.4.05.10004271508590.9815-100000@alnair.uio.no>
Message-ID: <3908612A.95CC5F8F@statistik.uni-dortmund.de>

> >> however, having all the functions defined in base highlighted as keywords.
> >> Would that be a good idea, and if it is, how can I extract the function
> >> names most easily?
> >
> >1. You get a list of objects (not only functions!!!) by typing
> >    ls(env=environment("R_GlobalEnv"))
> >
> >2. In the html-help files, e.g. the "Functions" index could help you.
> >   Attention: Not only functions are listed here!
> 
> Yeah, that's the problem with both of those, that it doesn't only contain
> functions.
> 
> >3. For my R-WinEdt "package", I extracted names of functions of many R
> >packages.
> >   If you want, I will send some files.
> 
> Oh, I thought about it, but then I figured for this to work consistently,
> every user would have to generate his own defs, depending on what packages
> he has installed, which would be a bit bothersome I guess.

OK. Fritz has got it! And I feel stupid...

After thinking:
Only functions of the base package are not enough for some users,
on the other hand you will never be up to date with names of all
functions of all packages, I suppose.
Of course TeX cannot know names of R functions, if they are not
specified explicitly.

Suggestions:
1)
Another way is to write a R function, that generates "nice" TeX code.
Or a R function, that generates code to be interpreted by a TeX macro.
Such a function would know about loaded packages and their functions,
user specific functions, other objects in the users environment (as
needed).

2)
Providing names of functions of the most used packages (e.g. base,
ctest, ts, ...) would be enough, if the user could easily extend the
list of "known" functions (or other objects).
I think about a TeX command (defined in your macro), that could be used
as follows:
 \addrfunctionnames{myfunc1, myfunc2, myfunc3}


But maybe there are much better ideas?

Regards,
Uwe Ligges
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Prof Brian Ripley <ripley@stats.ox.ac.uk>  Thu Apr 27 17:00:30 2000
From: Prof Brian Ripley <ripley@stats.ox.ac.uk> (Prof Brian Ripley)
Date: Thu, 27 Apr 2000 17:00:30 +0100 (BST)
Subject: [Rd] Cross compiling a package for Windows on Linux
Message-ID: <200004271600.RAA21782@toucan.stats.ox.ac.uk>

> From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
> Date: 27 Apr 2000 13:08:07 +0200
> 
> Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk> writes:
> 
> > Prof Brian D Ripley <ripley@stats.ox.ac.uk> writes:
> > 
> > > As you noted, I am in the process of changing the Makefiles and
> > > instructions, mainly because the Cygwin release has changed and (aargh!)
> > > not longer has a fully functional make, and the header set has also
> > > changed.  It's a rash assumption that the R-devel or R-release-patched
> > > will cross-compile as we only test that occasionally, including just 
before
> > > release.
> > 
> > It did last night, though (R-1-0-patches, that is).
> 
> ..as does R-devel as of this moment.

Indeed it does.  To make life a bit easier I have put up a complete
current cross-tools set with the latest headers at

http://www.stats.ox.ac.uk/pub/bdr/RWin/i386cross.tar.bz2  (ca 5Mb)

Just unpack it somewhere, put the bin directory in your path and
follow the instructions in INSTALL.

The caveat remains, though: this is not tested frequently.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From thomas@biostat.washington.edu  Thu Apr 27 20:00:23 2000
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Thu, 27 Apr 2000 12:00:23 -0700 (PDT)
Subject: [Rd] gcinfo/R_alloc inconsistency
In-Reply-To: <200004271357.OAA21290@toucan.stats.ox.ac.uk>
Message-ID: <Pine.GSO.4.21.0004271154550.28220-100000@mail.biostat.washington.edu>


gcinfo reports the amount of remaining heap using
	vcells = R_VSize - (R_VTop - R_VHeap);

but R_alloc tests
        if (R_VMax - R_VTop < size)
		mem_err_heap(size);


This means that you can get an out of memory error when gcinfo insists
there are vast amounts of memory left.


	-thomas

Thomas Lumley
Assistant Professor, Biostatistics
University of Washington, Seattle

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From bates@stat.wisc.edu  Thu Apr 27 23:25:40 2000
From: bates@stat.wisc.edu (Douglas Bates)
Date: 27 Apr 2000 17:25:40 -0500
Subject: [Rd] Cross compiling a package for Windows on Linux
In-Reply-To: Prof Brian Ripley's message of "Thu, 27 Apr 2000 17:00:30 +0100 (BST)"
References: <200004271600.RAA21782@toucan.stats.ox.ac.uk>
Message-ID: <6raeiftc4b.fsf@franz.stat.wisc.edu>

Prof Brian Ripley <ripley@stats.ox.ac.uk> writes:

> > From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
> > Date: 27 Apr 2000 13:08:07 +0200
> > 
> > Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk> writes:
> > 
> > > Prof Brian D Ripley <ripley@stats.ox.ac.uk> writes:
> > > 
> > > > As you noted, I am in the process of changing the Makefiles and
> > > > instructions, mainly because the Cygwin release has changed and (aargh!)
> > > > not longer has a fully functional make, and the header set has also
> > > > changed.  It's a rash assumption that the R-devel or R-release-patched
> > > > will cross-compile as we only test that occasionally, including just 
> before
> > > > release.
> > > 
> > > It did last night, though (R-1-0-patches, that is).
> > 
> > ..as does R-devel as of this moment.
> 
> Indeed it does.  To make life a bit easier I have put up a complete
> current cross-tools set with the latest headers at
> 
> http://www.stats.ox.ac.uk/pub/bdr/RWin/i386cross.tar.bz2  (ca 5Mb)
> 
> Just unpack it somewhere, put the bin directory in your path and
> follow the instructions in INSTALL.
> 
> The caveat remains, though: this is not tested frequently.

That worked nicely, thanks.

I did have to make two additional modifications to the Makefile to
drop the --number-pages and the --html flags in calls to makeinfo.  My
version of makeinfo did not accept those flags.

I will have to check at home this evening if the compilation of my
library was successful.  I am optimistic.

This is a very useful facility.

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Fri Apr 28 07:18:49 2000
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Fri, 28 Apr 2000 07:18:49 +0100 (BST)
Subject: [Rd] Cross compiling a package for Windows on Linux
In-Reply-To: <6raeiftc4b.fsf@franz.stat.wisc.edu>
Message-ID: <Pine.GSO.4.05.10004280713150.26961-100000@auk.stats>

On 27 Apr 2000, Douglas Bates wrote:

> Prof Brian Ripley <ripley@stats.ox.ac.uk> writes:
> 
> > > From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
> > > Date: 27 Apr 2000 13:08:07 +0200
> > > 
> > > Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk> writes:
> > > 
> > > > Prof Brian D Ripley <ripley@stats.ox.ac.uk> writes:
> > > > 
> > > > > As you noted, I am in the process of changing the Makefiles and
> > > > > instructions, mainly because the Cygwin release has changed and (aargh!)
> > > > > not longer has a fully functional make, and the header set has also
> > > > > changed.  It's a rash assumption that the R-devel or R-release-patched
> > > > > will cross-compile as we only test that occasionally, including just 
> > before
> > > > > release.
> > > > 
> > > > It did last night, though (R-1-0-patches, that is).
> > > 
> > > ..as does R-devel as of this moment.
> > 
> > Indeed it does.  To make life a bit easier I have put up a complete
> > current cross-tools set with the latest headers at
> > 
> > http://www.stats.ox.ac.uk/pub/bdr/RWin/i386cross.tar.bz2  (ca 5Mb)
> > 
> > Just unpack it somewhere, put the bin directory in your path and
> > follow the instructions in INSTALL.
> > 
> > The caveat remains, though: this is not tested frequently.
> 
> That worked nicely, thanks.
> 
> I did have to make two additional modifications to the Makefile to
> drop the --number-pages and the --html flags in calls to makeinfo.  My
> version of makeinfo did not accept those flags.

Yes, you need makeinfo 4.0 (as you do for R on Unix), and without those
flags you will get the wrong answers.  Actually, this step should not be
necessary: it happens because cvs updates files with the update date, not
the creation date. The same thing happens with configure and configure.in
not infrequently.  So `touch rw-faq fixed/r/rw-FAQ.html' is all that is
needed.


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Apr 28 09:26:47 2000
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 28 Apr 2000 10:26:47 +0200 (CEST)
Subject: [Rd] options(keep.source = TRUE) -- also for "library(.)" ?
In-Reply-To: <14600.15043.86395.259088@lynne.ethz.ch>
References: <14600.12274.664989.534291@lynne.ethz.ch>
 <x2d7nblnyq.fsf@blueberry.kubism.ku.dk>
 <14600.15043.86395.259088@lynne.ethz.ch>
Message-ID: <14601.19271.866855.581704@lynne.ethz.ch>

>>>>> "MM" == Martin Maechler <maechler@stat.math.ethz.ch> writes:

(and I haven't seen more feedback..)

>>>>> "PD" == Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk> writes:
     PD> Martin Maechler <maechler@stat.math.ethz.ch> writes:

	>>> Can we [those of us who know how sys.source() works...]  think of
	>>> changing this?  As it was possible for the base package, it must be
	>>> doable for the others as well....

     PD> Martin, surely you could have figured out to remove these two lines
     PD> from sys.source:

     PD> oop <- options(keep.source = FALSE)
     PD> on.exit(options(oop))

    MM> [blush... *BLUSH* ...
    MM> I didn't look at sys.source(); 
    MM> just knew that parts of it used to look rather "magical" to me ..
    MM> ]

    MM> Of course we now could even make 
    MM> keep.source = getOption("keep.source") 
    MM> an argument to library(), being propagated to sys.source(..).

I'm considering to commit the necessary changes and add the following to
NEWS [for "R-devel"]

    o	library(), require(), and sys.source() have a new argument
	` keep.source = getOption("keep.source") '.
	Hence, by default, functions from all packages (not just base)
	`keep their source'.

Is this okay for everyone ?


     PD> The real question is whether we want to have a different mechanism
     PD> for controlling whether keep.source is set or not. 

    MM> right.

      PD> Originally it was FALSE for the base library to save space, and
      PD> according the same setting was used for other libraries since some
      PD> of them are rather large, but later it got flipped to TRUE for
      PD> base,
    MM> (yes, I'm still wondering...)
      PD> and then there is little point in setting it FALSE for packages. 
      PD> Question is whether anyone would want the old behaviour
      PD> back to get more space for analyses?

    MM> would be nice if it *was* configurable for base as well;
    MM> possibly both via cmd line option
    MM> (something like --keepsource / --no-keepsource )
    MM> and a setting in Rprofile..

    >> From grepping through the source code, I don't see how it was turned off
    MM> for base...

anyone [R-core] ?

Martin Maechler <maechler@stat.math.ethz.ch>	http://stat.ethz.ch/~maechler/
Seminar fuer Statistik, ETH-Zentrum  LEO D10	Leonhardstr. 27
ETH (Federal Inst. Technology)	8092 Zurich	SWITZERLAND
phone: x-41-1-632-3408		fax: ...-1228			<><
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Craig.Mckinstry@pnl.gov  Fri Apr 28 16:36:37 2000
From: Craig.Mckinstry@pnl.gov (Craig.Mckinstry@pnl.gov)
Date: Fri, 28 Apr 2000 17:36:37 +0200 (MET DST)
Subject: [Rd] graphics: par(mfg=c(i,j,r,c)) (PR#529)
Message-ID: <200004281536.RAA21899@pubhealth.ku.dk>

Full_Name: Craig A. McKinstry
Version: 1.0.0
OS: WinNT4.0 and Win98
Submission from: (NULL) (192.101.100.130)


When creating a multi-panel graphic, the command par(mfg=c(i,j,r,c)) is
supposed
to allow the user free movement between graphics panels to develop each panel 
separately. This works for the first invocation of par(mfg=c()) and for the 
first panel panel specified, but not for subsequent calls to the other panels. 

Coded example:

x_1:20
y_1:20
#these 5 commands produce a 2x2 panel plot
par(mfrow=c(2,2))
plot(x,y)
plot(x,y)
plot(x,y)
plot(x,y)

#the following 2 commands successfully added the text 'panel[2,1]' to
panel[2,1]
par(mfg=c(2,1,2,2))
text(10,10,'panel[2,1]')

#None of the following 3 command-pairs produced their intended results for the
other
# 3 panels
par(mfg=c(1,2,2,2))
text(10,10,'panel[1,2]')

par(mfg=c(1,1,2,2))
text(10,10,'panel[1,1]')

par(mfg=c(2,2,2,2))
text(10,10,'panel[2,2]')

#However, the following command-pair did as intended on the first panel
specified
# by mfg=c(2,1,2,2) above
par(mfg=c(2,1,2,2))
text(15,15,'panel[2,2]')

#Running this in S-plus 4.0 produced the intended results


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Fri Apr 28 16:58:29 2000
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 28 Apr 2000 17:58:29 +0200
Subject: [Rd] graphics: par(mfg=c(i,j,r,c)) (PR#529)
In-Reply-To: Craig.Mckinstry@pnl.gov's message of "Fri, 28 Apr 2000 17:36:37 +0200 (MET DST)"
References: <200004281536.RAA21899@pubhealth.ku.dk>
Message-ID: <x28zxyw72y.fsf@blueberry.kubism.ku.dk>

Craig.Mckinstry@pnl.gov writes:

> x_1:20
> y_1:20
> #these 5 commands produce a 2x2 panel plot
> par(mfrow=c(2,2))
> plot(x,y)
> plot(x,y)
> plot(x,y)
> plot(x,y)
> 
> #the following 2 commands successfully added the text 'panel[2,1]' to
> panel[2,1]
> par(mfg=c(2,1,2,2))
> text(10,10,'panel[2,1]')
> 
> #None of the following 3 command-pairs produced their intended results for the
> other
> # 3 panels
> par(mfg=c(1,2,2,2))
> text(10,10,'panel[1,2]')
> 
> par(mfg=c(1,1,2,2))
> text(10,10,'panel[1,1]')
> 
> par(mfg=c(2,2,2,2))
> text(10,10,'panel[2,2]')
> 
> #However, the following command-pair did as intended on the first panel
> specified
> # by mfg=c(2,1,2,2) above
> par(mfg=c(2,1,2,2))
> text(15,15,'panel[2,2]')

Same thing happens on Linux. Might be something with restoring the
coordinate transformations. Using

par(mfg=c(1,1,2,2))
plot(x,y)
text(10,10,'panel[1,1]')

*does* seem to work.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Fri Apr 28 17:02:00 2000
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Fri, 28 Apr 2000 12:02:00 -0400
Subject: [Rd] Rd files with multiple functions?
Message-ID: <3909B5F8.70004B7@bank-banque-canada.ca>

There was at one time some discussion about supporting documentation of multiple
functions in one Rd file. Is that supported or still in the plans?

Paul Gilbert

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Apr 28 17:19:50 2000
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 28 Apr 2000 18:19:50 +0200 (CEST)
Subject: [Rd] options(keep.source = TRUE) -- also for "library(.)" ?
In-Reply-To: <14601.19271.866855.581704@lynne.ethz.ch>
References: <14600.12274.664989.534291@lynne.ethz.ch>
 <x2d7nblnyq.fsf@blueberry.kubism.ku.dk>
 <14600.15043.86395.259088@lynne.ethz.ch>
 <14601.19271.866855.581704@lynne.ethz.ch>
Message-ID: <14601.47654.736464.353659@lynne.ethz.ch>

I'm replying to myself once more :

[and this gets more and more envolved, please "d" if you're not interested ..]

>>>>> "MM" == Martin Maechler <maechler@stat.math.ethz.ch> writes:

    MM> (and I haven't seen more feedback..)

>>>>> "PD" == Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk> writes:

      ........

    MM> Of course we now could even make 
    MM>	   keep.source = getOption("keep.source") 
    MM> an argument to library(), being propagated to sys.source(..).

 MM>   I'm considering to commit the necessary changes and add the following to
 MM>    NEWS [for "R-devel"]
 MM> 
 MM>    o	library(), require(), and sys.source() have a new argument
 MM> 	` keep.source = getOption("keep.source") '.
 MM> 
 MM>   Hence, by default, functions from all packages (not just base)
 MM>   `keep their source'.
 MM> 
 MM>   Is this okay for everyone ?

Now, I still haven't committed the new code, but I have been using it
myself and made a "big picture statistic" *using* the new code, and gc()
for many packages (actually I've done this for all CRAN packages and more)
to find  how much memory is "spilled" by   keep.source = TRUE.

Here are the results :

I show the difference in memory usage {Vcells & Ncells, see ?gc & ?Memory}
for interesting packages, only using R builtin and CRAN (non-Devel) packages:

   Package    Bytes used
	      additionally with   Ncells  Vcells
	      keep.source= TRUE                 
				                
   nlme       2305'364             19023  107659   (actually  nlme + nls)
   survival5  1066'776		   8867    49792
   MASS        631'628		   5186    29507
   mclust      493'512		   4349    22936
   boot        456'944		   3833    21314
   ctest       309'288		   2406    14502
   ts          297'368		   2311    13944
   cluster     244'120		   2270    11298
   nls         236'668		   1871    11085
   wavethresh  218'624		   1878    10180
   mda         215'944		   1878    10046
   rpart       203'892		   1654     9533
   chron       194'640		   1735     9038
   tseries     183'360		   1505     8566
   locfit      176'416		   1632     8168
   tree        166'844		   1248     7843
   modreg      116'752		    989     5442
   nnet         98'124		    838     4571
   splines      85'112		    769     3948
   mva          79'280		    710     3680
   lqs          34'116		    292     1589
   eda          10'860		    105      501
   zmatrix       7'196		     82      327
   Devore5           0		      0        0  [took this to "test"

I.e., for the nlme() one needs an extra 2.3 MBytes of memory just for
"keep.source = TRUE".

I further investigated a bit how much the "keep.source" of base ``costs''
memory wise.
Note that I still don't know how to turn it off easily for base (Peter ?).

However, I just counted how much "source" is in base :
  > length(ob <- ls(pos= match("package:base",search()), all.nam = TRUE))
  [1] 1193
  > length(fns <- ob[sapply(ob, function(n)is.function(get(n)))])
  [1] 1169
  > stem(len.src <- sapply(fns, function(n)sum(nchar(attr(get(n),"source")))))

   The decimal point is 3 digit(s) to the right of the |
  
    0 | 00000000000000000000000000000000000000000000000000000000000000000000+980
    1 | 00000000000112222233333333334444555555666667777778888899
    2 | 00000012333334444555556666777788899
    3 | 12234477
    4 | 15669
    5 | 34
    6 | 
    7 | 35
    8 | 
    9 | 
   10 | 2
		(guess *which* is the  outlier  ;-)

  > sum(len.src)
  [1] 359964

i.e., only ~360'000 characters.

Now compare this with  survival5 which was scoring pretty high above :

  > library(survival5, keep.source = TRUE)
  > length(ob <- ls(pos= match("package:survival5",search()), all.nam = TRUE))
  [1] 117
  > length(fns <- ob[sapply(ob, function(n)is.function(get(n)))])
  [1] 116
  > stem(len.src <- sapply(fns, function(n)sum(nchar(attr(get(n),"source")))))

    The decimal point is 3 digit(s) to the right of the |

     0 | 00000000011111111111111112222222233344444455555789
     1 | 0001122334445567777899
     2 | 0001134555555789
     3 | 02233445567
     4 | 12368
     5 | 2478
     6 | 14799
     7 | 
     8 | 0
     9 | 
    10 | 
    11 | 
    12 | 
    13 | 
    14 | 
    15 | 4
    16 | 
    17 | 3

  > sum(len.src)
  [1] 235633

i.e.  about 2/3 of "base".

(but then base has "source" attributes for much more objects)
Very crude extrapolation would mean that turning off the "keep.source" for
"base" would save about 1.5 MBytes of RAM {I'd guess even more..}

After all this testing, I think what we really want is
"keep.source = FALSE" (including for "base" !)
WHEN working with large data, working on smallish machines,
    or for all "batch" processing.

Hence I'd propose

1.  
  options(keep.source = interactive())

  in the default profile

2. {as proposed earlier today -- see below}

  provide a command line option to turn it on or off.
------------

    PD> The real question is whether we want to have a different mechanism
    PD> for controlling whether keep.source is set or not. 

    MM> right.

    PD> Originally it was FALSE for the base library to save space, and
    PD> according the same setting was used for other libraries since some
    PD> of them are rather large, but later it got flipped to TRUE for
    PD> base,
    MM> (yes, I'm still wondering...)
    PD> and then there is little point in setting it FALSE for packages. 
    PD> Question is whether anyone would want the old behaviour
    PD> back to get more space for analyses?

  would be nice if it *was* configurable for base as well;
  possibly both via cmd line option
  (something like --keepsource / --no-keepsource )
  and a setting in Rprofile..

  MM> From grepping through the source code, I don't see how it was turned off
  MM> for base...

 anyone [R-core] ?

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Apr 28 17:23:51 2000
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 28 Apr 2000 18:23:51 +0200 (CEST)
Subject: [Rd] Rd files with multiple functions?
In-Reply-To: <3909B5F8.70004B7@bank-banque-canada.ca>
References: <3909B5F8.70004B7@bank-banque-canada.ca>
Message-ID: <14601.47895.555375.853908@lynne.ethz.ch>

>>>>> "PaulG" == Paul Gilbert <pgilbert@bank-banque-canada.ca> writes:

    PaulG> There was at one time some discussion about supporting
    PaulG> documentation of multiple functions in one Rd file. Is that
    PaulG> supported or still in the plans?

This "happens all the time". 
It's even recommended in some cases (however people `fight' *which* cases ..). 

Just make sure to have an \alias{} *and* a usage line (but just one
\usage{}) for each function.  
For an example, see      src/library/base/man/lm.Rd

Martin
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Fri Apr 28 17:51:37 2000
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Fri, 28 Apr 2000 12:51:37 -0400
Subject: [Rd] Rd files with multiple functions?
References: <3909B5F8.70004B7@bank-banque-canada.ca> <14601.47895.555375.853908@lynne.ethz.ch>
Message-ID: <3909C199.AF669A43@bank-banque-canada.ca>

>This "happens all the time".
>It's even recommended in some cases (however people `fight' *which* cases ..).
...
>For an example, see      src/library/base/man/lm.Rd

In my version of R src/library/base/man/lm.Rd just has one \name{}  with
multiple \alias{}s.
What I meant was truely different functions (all the functions in a package) so
there would be multiple \name{} lines in the file. Is that possible?

>Just make sure to have an \alias{} *and* a usage line (but just one
>\usage{}) for each function.

BTW
As of yesterday's R-devel snapshot Kurt fixed R CMD build to check for just one
usage, which is a nice feature.

Paul Gilbert

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Prof Brian Ripley <ripley@stats.ox.ac.uk>  Fri Apr 28 17:57:58 2000
From: Prof Brian Ripley <ripley@stats.ox.ac.uk> (Prof Brian Ripley)
Date: Fri, 28 Apr 2000 17:57:58 +0100 (BST)
Subject: [Rd] Rd files with multiple functions?
Message-ID: <200004281657.RAA01123@toucan.stats.ox.ac.uk>


> Date: Fri, 28 Apr 2000 12:51:37 -0400
> From: Paul Gilbert <pgilbert@bank-banque-canada.ca>
> To: Martin Maechler <maechler@stat.math.ethz.ch>, Douglas Bates 
<bates@stat.wisc.edu>
> CC: R-devel <R-devel@stat.math.ethz.ch>
> Subject: Re: [Rd] Rd files with multiple functions?
> 
> >This "happens all the time".
> >It's even recommended in some cases (however people `fight' *which* cases 
..).
> ...
> >For an example, see      src/library/base/man/lm.Rd
> 
> In my version of R src/library/base/man/lm.Rd just has one \name{}  with
> multiple \alias{}s.
> What I meant was truely different functions (all the functions in a package) 
so
> there would be multiple \name{} lines in the file. Is that possible?

No, the \name is the name of the *file*, the \alias'es are the names
of the objects.

Use \name for a topic, that is the package name in your example. See
e.g. Poisson.Rd that has \name{Poisson}, but there is no function
Poisson(), and the functions are named as \alias{}es

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Fri Apr 28 18:17:54 2000
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Fri, 28 Apr 2000 19:17:54 +0200 (CEST)
Subject: [Rd] options(keep.source = TRUE) -- also for "library(.)" ?
In-Reply-To: <14601.47654.736464.353659@lynne.ethz.ch>
References: <14600.12274.664989.534291@lynne.ethz.ch>
 <x2d7nblnyq.fsf@blueberry.kubism.ku.dk>
 <14600.15043.86395.259088@lynne.ethz.ch>
 <14601.19271.866855.581704@lynne.ethz.ch>
 <14601.47654.736464.353659@lynne.ethz.ch>
Message-ID: <14601.51138.245606.306428@aragorn.ci.tuwien.ac.at>

>>>>> Martin Maechler writes:

> I'm replying to myself once more : [and this gets more and more
> envolved, please "d" if you're not interested ..]

> ...

> After all this testing, I think what we really want is "keep.source =
> FALSE" (including for "base" !)  WHEN working with large data, working
> on smallish machines, or for all "batch" processing.

> Hence I'd propose

> 1.  
>   options(keep.source = interactive())

>   in the default profile

> 2. {as proposed earlier today -- see below}

>   provide a command line option to turn it on or off.

I am not sure whether we really want a command line option.  I'd say we
should keep things as simple as possible.

-k

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Apr 28 18:24:55 2000
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 28 Apr 2000 19:24:55 +0200 (CEST)
Subject: [Rd] "keep.source" changes committed to R-devel
In-Reply-To: <14601.47654.736464.353659@lynne.ethz.ch>
References: <14600.12274.664989.534291@lynne.ethz.ch>
 <x2d7nblnyq.fsf@blueberry.kubism.ku.dk>
 <14600.15043.86395.259088@lynne.ethz.ch>
 <14601.19271.866855.581704@lynne.ethz.ch>
 <14601.47654.736464.353659@lynne.ethz.ch>
Message-ID: <14601.51559.135470.386006@lynne.ethz.ch>

These are the NEWS entries

    o	library(), require(), and sys.source() have a new argument
	` keep.source = getOption("keep.source") '.
	Hence, by default, functions from all packages (not just base)
	`keep their source'

    o	The "keep.source" option now defaults to interactive() instead of TRUE.


Note that this (the 2nd one!) speeded up  "make check" a bit (about 1-2 %).

What is *not* yet working is
     "keep.source = FALSE  having an effect on the functions in base.

Martin

PS:
 to get this latest "R-devel snapshot", either 
 use "rsync" (used to be updated hourly), or anonymous "cvs" (updated daily
 to cvs.r-project.org
 or FTP in about 8 hours from  ftp://stat.ethz.ch/Software/R/R-devel.tar.gz
 or get it from the CRAN mirrors  a few more hours later ...)
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Fri Apr 28 18:40:46 2000
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Fri, 28 Apr 2000 13:40:46 -0400
Subject: [Rd] Rd files with multiple functions?
References: <200004281657.RAA01123@toucan.stats.ox.ac.uk>
Message-ID: <3909CD1D.25E3A964@bank-banque-canada.ca>

I guess I'm using the wrong terminology, and also getting confused because \name
seems to mean both "topic" and "file".

Let me ask the broader question. What I would like to do is keep all my
documentation for a package in one file because this makes searching and editing
simpler (in the same way that I keep all the code in one .R file). I still end
up with a fairly large number of files since there are many packages involved,
but it's only a dozen or so, not hundreds. What I have been doing is keeping it
this way and then using a script to parse the file into multiple .Rd files which
I put in the man directory. Each of these files is a topic and has one \name
line. My question is: Is it still necessary for me to parse the file, or is that
being supported by R now?

Thanks,
Paul Gilbert

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From kjetil.kjernsmo@astro.uio.no  Fri Apr 28 19:07:30 2000
From: kjetil.kjernsmo@astro.uio.no (Kjetil Kjernsmo)
Date: Fri, 28 Apr 2000 20:07:30 +0200 (MET DST)
Subject: [Rd] Writing lgrindefs
In-Reply-To: <3908612A.95CC5F8F@statistik.uni-dortmund.de>
Message-ID: <Pine.OSF.4.05.10004282004340.11560-100000@rukbat.uio.no>

On Thu, 27 Apr 2000, Uwe Ligges wrote:

>Suggestions:
>1)
>Another way is to write a R function, that generates "nice" TeX code.
>Or a R function, that generates code to be interpreted by a TeX macro.
>Such a function would know about loaded packages and their functions,
>user specific functions, other objects in the users environment (as
>needed).
>
>2)
>Providing names of functions of the most used packages (e.g. base,
>ctest, ts, ...) would be enough, if the user could easily extend the
>list of "known" functions (or other objects).
>I think about a TeX command (defined in your macro), that could be used
>as follows:
> \addrfunctionnames{myfunc1, myfunc2, myfunc3}

Both your suggestions are interesting, and should receive some attention I
guess. The good thing about lgrind is that it is in fairly common use, and
that definitions for many languages allready exist. When the time of
generating LaTeX code for my thesis approaches, I think I'll try to find a
newsgroup and ask about a few details.

Best,

Kjetil
-- 
Kjetil Kjernsmo
Graduate astronomy-student                    Problems worthy of attack
University of Oslo, Norway            Prove their worth by hitting back
E-mail: kjetikj@astro.uio.no                                - Piet Hein
Homepage <URL:http://www.astro.uio.no/~kjetikj/>
Webmaster@skepsis.no 

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Sun Apr 30 16:40:26 2000
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Sun, 30 Apr 2000 17:40:26 +0200 (CEST)
Subject: [Rd] Rd files with multiple functions?
In-Reply-To: <3909CD1D.25E3A964@bank-banque-canada.ca>
References: <200004281657.RAA01123@toucan.stats.ox.ac.uk>
 <3909CD1D.25E3A964@bank-banque-canada.ca>
Message-ID: <14604.21482.220633.89296@aragorn.ci.tuwien.ac.at>

>>>>> Paul Gilbert writes:

> I guess I'm using the wrong terminology, and also getting confused
> because \name seems to mean both "topic" and "file".

> Let me ask the broader question. What I would like to do is keep all
> my documentation for a package in one file because this makes
> searching and editing simpler (in the same way that I keep all the
> code in one .R file). I still end up with a fairly large number of
> files since there are many packages involved, but it's only a dozen or
> so, not hundreds. What I have been doing is keeping it this way and
> then using a script to parse the file into multiple .Rd files which I
> put in the man directory. Each of these files is a topic and has one
> \name line. My question is: Is it still necessary for me to parse the
> file, or is that being supported by R now?

It is not supported.

Re terminology. `topic' is really anything that documentation is given
for (such as an R object, a concept, etc ...).  That's also why the
argument in help() is called `topic'.  One declares the topics a file
(documentation object) provides documentation for using the \alias
statements (which maybe should be called \topic then ...)

(So, `each of these files is a topic' may be misleading ...)

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From kjetikj@astro.uio.no  Sun Apr 30 20:01:04 2000
From: kjetikj@astro.uio.no (kjetikj@astro.uio.no)
Date: Sun, 30 Apr 2000 21:01:04 +0200 (MET DST)
Subject: [Rd] rpois hangs (PR#530)
Message-ID: <200004301901.VAA28610@pubhealth.ku.dk>

Full_Name: Kjetil Kjernsmo
Version: Version 1.0.0
OS: osf1
Submission from: (NULL) (129.240.28.227)


Dear all,

I have come across another really strange bug in rpois.
If I do
> rpois(1, 1000000 * rpois(1, 10000))
sometimes it hangs, and hangs...
On my XP1000 alphaev6 workstation, it seems to happen more 
frequently than on other machines. I started a session on an older 
computer, and from the start, it looks like this:
> rpois(1, 1000000 * rpois(1, 10000))
[1] 1537190728
> ^[[A
Error: syntax error [whoops, I'm usually using ESS]
> rpois(1, 1000000 * rpois(1, 10000))
[1] 1507263999
> rpois(1000, 1000000 * rpois(1000, 10000))          
[hanged here, killed with ^C]

> rpois(1, 1000000 * rpois(1, 10000))
[1] 1463075843
> rpois(1, 1000000 * rpois(1, 10000))
[1] 1438068697
> rpois(1, 1000000 * rpois(1, 10000))
[hanging]

I think this is strange, because I've been doing this stuff 
a lot lately, but usually with a rather small parameter to the 
second rpois.  

Kjetil

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Sun Apr 30 20:41:36 2000
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 30 Apr 2000 21:41:36 +0200
Subject: [Rd] rpois hangs (PR#530)
In-Reply-To: kjetikj@astro.uio.no's message of "Sun, 30 Apr 2000 21:01:04 +0200 (MET DST)"
References: <200004301901.VAA28610@pubhealth.ku.dk>
Message-ID: <x2ya5vcr67.fsf@blueberry.kubism.ku.dk>

kjetikj@astro.uio.no writes:

> I have come across another really strange bug in rpois.
> If I do
> > rpois(1, 1000000 * rpois(1, 10000))
> sometimes it hangs, and hangs...
> On my XP1000 alphaev6 workstation, it seems to happen more 
> frequently than on other machines. I started a session on an older 
........
> > rpois(1, 1000000 * rpois(1, 10000))
> [hanging]
> 
> I think this is strange, because I've been doing this stuff 
> a lot lately, but usually with a rather small parameter to the 
> second rpois.  

On Intel, that consistently gives

>  rpois(1, 1000000 * rpois(1, 10000))
[1] -2147483648

I.e. signs of integer overflow. Apparently you partly get away with it
on a 64 bit machine, but I'm not surprised you get into regimes that
are not well tested by the poor developers working on hardware from
the bygone millennium....

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From kjetil.kjernsmo@astro.uio.no  Sun Apr 30 20:57:59 2000
From: kjetil.kjernsmo@astro.uio.no (Kjetil Kjernsmo)
Date: Sun, 30 Apr 2000 21:57:59 +0200 (MET DST)
Subject: [Rd] rpois hangs (PR#530)
In-Reply-To: <x2ya5vcr67.fsf@blueberry.kubism.ku.dk>
Message-ID: <Pine.OSF.4.05.10004302139190.20697-100000@alnair.uio.no>

On 30 Apr 2000, Peter Dalgaard BSA wrote:

>On Intel, that consistently gives
>
>>  rpois(1, 1000000 * rpois(1, 10000))
>[1] -2147483648
>
>I.e. signs of integer overflow.

Aha!

> Apparently you partly get away with it
>on a 64 bit machine, but I'm not surprised you get into regimes that
>are not well tested by the poor developers working on hardware from
>the bygone millennium....

:-) Whaddayamean "bygone", you're speaking to an astronomer here, you
know... :-) Anyway, if I can put my hardware to use, I'd be happy to do
so, just give me some detailed instructions.

Best,

Kjetil
-- 
Kjetil Kjernsmo
Graduate astronomy-student                    Problems worthy of attack
University of Oslo, Norway            Prove their worth by hitting back
E-mail: kjetikj@astro.uio.no                                - Piet Hein
Homepage <URL:http://www.astro.uio.no/~kjetikj/>
Webmaster@skepsis.no 

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

