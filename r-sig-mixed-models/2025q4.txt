From chr|@ @end|ng |rom tr|cky@o|ut|on@@com@@u  Wed Oct  1 06:11:28 2025
From: chr|@ @end|ng |rom tr|cky@o|ut|on@@com@@u (Chris Howden)
Date: Wed, 1 Oct 2025 04:11:28 +0000
Subject: [R-sig-ME] glmmTMB Zero-inflated Gamma GLMM
In-Reply-To: <DM6PR01MB5898E3D5B0B48EB0CCCCDA76911AA@DM6PR01MB5898.prod.exchangelabs.com>
References: <DM6PR01MB58985E99F36D88E71803BCB4911BA@DM6PR01MB5898.prod.exchangelabs.com>
 <SYBPR01MB71934B46CAB66B5AC9B32DC8981BA@SYBPR01MB7193.ausprd01.prod.outlook.com>
 <DM6PR01MB5898E3D5B0B48EB0CCCCDA76911AA@DM6PR01MB5898.prod.exchangelabs.com>
Message-ID: <SYBPR01MB71931FD613F66CAE2C94891198E6A@SYBPR01MB7193.ausprd01.prod.outlook.com>

Hi Trent,

Yes, I believe it is the former as well.

Chris Howden B.Sc. (Hons)
Founding Partner
Data Analysis, Modelling and Training
Evidence Based Strategy/Policy Development, IP Commercialisation and Innovation
(mobile) +61 (0) 410 689 945 | (skype) chris at trickysolutions.com.au<mailto:chris at trickysolutions.com.au>

From: DENNIS, TRENT <dennis.tm.1 at pg.com>
Sent: Tuesday, 30 September 2025 11:02 PM
To: Chris Howden <chris at trickysolutions.com.au>; r-sig-mixed-models at r-project.org
Subject: Re: glmmTMB Zero-inflated Gamma GLMM

Business Use


Hi Chris,


You've made a great point, my ultimate goal is to simulate new individuals. I should have also reported the estimate of the subject variance component because this would serve as the variance when drawing new random intercepts from a normal distribution.

My real question was whether I draw normal rvs that get put into my linear predictor for the gamma, or if I draw normal rvs and these get added to my overall response separately from the gamma rv.


I believe it is the former, but I have never read a textbook on the specifics of this topic and wanted to ask some experts. I know that in glmmTMB at least, when you use predict(model) and specify the type, they will bake the random intercepts for a given subject into the linear predictor for the component you fit them in (if you fit random subject in conditional gamma, it will put each subjects random intercept into the gamma linear predictor, same with zero component)...which would support the former of my two options above.


Trent,


________________________________
From: Chris Howden <chris at trickysolutions.com.au<mailto:chris at trickysolutions.com.au>>
Sent: Monday, September 29, 2025 7:13 PM
To: DENNIS, TRENT <dennis.tm.1 at pg.com<mailto:dennis.tm.1 at pg.com>>; r-sig-mixed-models at r-project.org<mailto:r-sig-mixed-models at r-project.org> <r-sig-mixed-models at r-project.org<mailto:r-sig-mixed-models at r-project.org>>
Subject: RE: glmmTMB Zero-inflated Gamma GLMM

[EXTERNAL]


Hi Trent,

I'm not familiar with glmmTMB, so take what I say here with a grain of salt!

Assuming you are adding a random intercept (it looks like that's what yr doing). Then I think it depends on whether you want to simulate just those 3 individuals, or the population.

If its just those 3 individuals then wouldn't you add their BLUP to the overall intercept in the linear predictor? And after that simulate the gamma rv for each of these 3 individuals only?

On the other hand if you want to simulate new individuals than I think you'd draw their simulated "BLUPS" from an appropriate distribution (which I think is usually a normal distribution with mean = 0 and SD as per yr model) - and then continue as above?

Chris Howden B.Sc. (Hons)
Founding Partner
Data Analysis, Modelling and Training
Evidence Based Strategy/Policy Development, IP Commercialisation and Innovation
(mobile) +61 (0) 410 689 945 | (skype) chris at trickysolutions.com.au<mailto:chris at trickysolutions.com.au>

-----Original Message-----
From: R-sig-mixed-models <r-sig-mixed-models-bounces at r-project.org<mailto:r-sig-mixed-models-bounces at r-project.org>> On Behalf Of DENNIS, TRENT via R-sig-mixed-models
Sent: Tuesday, 30 September 2025 7:15 AM
To: r-sig-mixed-models at r-project.org<mailto:r-sig-mixed-models at r-project.org>
Subject: [R-sig-ME] glmmTMB Zero-inflated Gamma GLMM

Business Use


Hello,

I am trying to simulate a response from a zero-inflated Gamma generalized linear mixed-effect model and have a question when it comes to the random effects. I am fitting the models with glmmTMB, using ziGamma as the family with a log link function.

Say I fit the model with a random effect for subject (N=3 subjects) and 1 covariate (treatment), which I only include in the conditional Gamma model. Example code:

  model <- glmmTMB(Lactobacillus_crispatus~Treatment+(1|Subject),
                   ziformula = ~ 1,
                   family = ziGamma(link="log"),
                   data=data)


 These are the coefficients I get:

Conditional model:
Intercept: 1.5
Treatment A: -1

Zero model:
Intercept: 1.8

Random effects, conditional:
Subject 1: -2
Subject 2: 0.5
Subject 3: 1



Would you incorporate the random effects into the linear predictor for the Gamma component then simulate Gamma rv, or do the random effects get used to simulate a normal rv which is then added to the Gamma rv? (I also simultaneously simulate a binomial rv based on the proability an observation will be non-zero and multiply this by corresponding Gamma rv to complete the zero-inflated component).

I have simplified my data for illustration sake. The real data is metagenomic species data with 23 subjects. Each subject was swabbed/sequenced at 7 visits and 8 anatomical sites per visit.


Any info would be greatly appreciated.

Thank you,



        [[alternative HTML version deleted]]

_______________________________________________
R-sig-mixed-models at r-project.org<mailto:R-sig-mixed-models at r-project.org> mailing list https://urldefense.com/v3/__https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models__;!!NgSi4SaN6ydtRVQ-!xnUtAYJ9DWhuOK_-6LpOk9aBPtFCbFFTBAK7slm1k4eg8S2yXWon0hrc2y2ZmfXl7Qp0q4XJ2PpLf7JjP2duAQ$<https://urldefense.com/v3/__https:/stat.ethz.ch/mailman/listinfo/r-sig-mixed-models__;!!NgSi4SaN6ydtRVQ-!xnUtAYJ9DWhuOK_-6LpOk9aBPtFCbFFTBAK7slm1k4eg8S2yXWon0hrc2y2ZmfXl7Qp0q4XJ2PpLf7JjP2duAQ$>

	[[alternative HTML version deleted]]


From o||verhooker @end|ng |rom pr@t@t|@t|c@@com  Fri Oct 10 16:11:30 2025
From: o||verhooker @end|ng |rom pr@t@t|@t|c@@com (Oliver Hooker)
Date: Fri, 10 Oct 2025 15:11:30 +0100
Subject: [R-sig-ME] =?utf-8?q?Bayesian_Multilevel_Modelling_Using=C2=A0br?=
	=?utf-8?q?ms=C2=A0for_Ecologists_=28BMME01=29?=
Message-ID: <CAEsSYzyrU=0ubqPwjURMs7UHz4xBFy83DSu2E6QQU7NnfC-g9A@mail.gmail.com>

Bayesian Multilevel Modelling Using *brms* for Ecologists (BMME01)
www.prstats.org/course/bayesian-multilevel-modelling-using-brms-for-ecologists-bmme01
<https://www.prstats.org/course/bayesian-multilevel-modelling-using-brms-for-ecologists-bmme01?utm_source=chatgpt.com>

*Dates:* October 20?24 and 27?31, 2025
*Format:* Live online course (4 hours per day)
*Fee:* ?450 (standard) | ?400 (early bird for the first 5 registrations)
SOLD OUT

Bayesian methods are rapidly becoming the standard for ecological data
analysis. They offer a flexible, transparent, and robust approach to
dealing with uncertainty, hierarchical data structures, and complex
ecological processes. If you work with ecological data and want to extend
your modelling skills beyond classical statistics, this course will give
you the tools and understanding to do so with confidence.

*Bayesian Multilevel Modelling using brms for Ecologists (BMME01)* is an
intensive 10-day live online course designed to provide ecologists,
environmental scientists, and applied researchers with a solid grounding in
Bayesian hierarchical modelling using the *brms* package in R.

Over the course of ten sessions, participants will be guided step by step
through the key concepts and practical applications of Bayesian inference,
with a strong focus on real ecological examples. The course combines clear,
structured teaching with extensive hands-on coding and interpretation.
Course Overview

Participants will begin by reviewing the fundamentals of Bayesian
inference?priors, posteriors, and credible intervals?before moving on to
the construction and interpretation of generalised linear and multilevel
models. You will learn how to fit and diagnose models for a range of
ecological data types, including continuous, count, binary, and
zero-inflated data, as well as how to address common challenges such as
spatial and temporal autocorrelation.

Throughout, you will work with real-world datasets and gain practical
experience in coding models using *brms*, an R package that provides a
user-friendly interface to *Stan*, one of the most powerful Bayesian
computation frameworks available. By the end of the course, you will have
the skills to build, diagnose, and interpret complex Bayesian models
relevant to your own ecological research.
Key Topics Include

   -

   The foundations of Bayesian inference and model formulation
   -

   Understanding priors, posteriors, and credible intervals
   -

   Generalised linear models (GLMs) and extensions to hierarchical models
   -

   Random effects, nested structures, and partial pooling
   -

   Modelling count, binary, zero-inflated, and multivariate ecological data
   -

   Incorporating spatial and temporal structures
   -

   Model checking, convergence diagnostics, and posterior predictive checks
   -

   Interpreting and communicating uncertainty in ecological research

Who Should Attend

This course is aimed at ecologists, environmental scientists, conservation
biologists, statisticians, and postgraduate researchers who already have a
working knowledge of R (data import, manipulation, and basic plotting) and
want to develop practical expertise in Bayesian multilevel modelling. No
prior experience with Bayesian methods is required?concepts and techniques
are introduced progressively, with plenty of guided practice and individual
feedback.
Why Choose This Course

   -

   Expert instruction from *Dr Niamh Mimnagh*, an experienced statistical
   ecologist and educator
   -

   A carefully balanced mix of lectures, demonstrations, and hands-on coding
   -

   Small-group format encouraging discussion and individual support
   -

   All course materials, R scripts, and datasets provided
   -

   Access to recorded sessions for 30 days after the course
   -

   Certificate of attendance upon completion

Registration

Places are limited to ensure an interactive learning experience. The early
bird rate of ?400 applies to the first five registrants. Standard
registration is ?450.

For full details, schedule, and registration, visit:
www.prstats.org/course/bayesian-multilevel-modelling-using-brms-for-ecologists-bmme01
<https://www.prstats.org/course/bayesian-multilevel-modelling-using-brms-for-ecologists-bmme01?utm_source=chatgpt.com>

-- 
Oliver Hooker PhD.
PR stats

	[[alternative HTML version deleted]]


