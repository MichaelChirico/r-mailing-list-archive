From chr|@ @end|ng |rom tr|cky@o|ut|on@@com@@u  Wed Oct  1 06:11:28 2025
From: chr|@ @end|ng |rom tr|cky@o|ut|on@@com@@u (Chris Howden)
Date: Wed, 1 Oct 2025 04:11:28 +0000
Subject: [R-sig-ME] glmmTMB Zero-inflated Gamma GLMM
In-Reply-To: <DM6PR01MB5898E3D5B0B48EB0CCCCDA76911AA@DM6PR01MB5898.prod.exchangelabs.com>
References: <DM6PR01MB58985E99F36D88E71803BCB4911BA@DM6PR01MB5898.prod.exchangelabs.com>
 <SYBPR01MB71934B46CAB66B5AC9B32DC8981BA@SYBPR01MB7193.ausprd01.prod.outlook.com>
 <DM6PR01MB5898E3D5B0B48EB0CCCCDA76911AA@DM6PR01MB5898.prod.exchangelabs.com>
Message-ID: <SYBPR01MB71931FD613F66CAE2C94891198E6A@SYBPR01MB7193.ausprd01.prod.outlook.com>

Hi Trent,

Yes, I believe it is the former as well.

Chris Howden B.Sc. (Hons)
Founding Partner
Data Analysis, Modelling and Training
Evidence Based Strategy/Policy Development, IP Commercialisation and Innovation
(mobile) +61 (0) 410 689 945 | (skype) chris at trickysolutions.com.au<mailto:chris at trickysolutions.com.au>

From: DENNIS, TRENT <dennis.tm.1 at pg.com>
Sent: Tuesday, 30 September 2025 11:02 PM
To: Chris Howden <chris at trickysolutions.com.au>; r-sig-mixed-models at r-project.org
Subject: Re: glmmTMB Zero-inflated Gamma GLMM

Business Use


Hi Chris,


You've made a great point, my ultimate goal is to simulate new individuals. I should have also reported the estimate of the subject variance component because this would serve as the variance when drawing new random intercepts from a normal distribution.

My real question was whether I draw normal rvs that get put into my linear predictor for the gamma, or if I draw normal rvs and these get added to my overall response separately from the gamma rv.


I believe it is the former, but I have never read a textbook on the specifics of this topic and wanted to ask some experts. I know that in glmmTMB at least, when you use predict(model) and specify the type, they will bake the random intercepts for a given subject into the linear predictor for the component you fit them in (if you fit random subject in conditional gamma, it will put each subjects random intercept into the gamma linear predictor, same with zero component)...which would support the former of my two options above.


Trent,


________________________________
From: Chris Howden <chris at trickysolutions.com.au<mailto:chris at trickysolutions.com.au>>
Sent: Monday, September 29, 2025 7:13 PM
To: DENNIS, TRENT <dennis.tm.1 at pg.com<mailto:dennis.tm.1 at pg.com>>; r-sig-mixed-models at r-project.org<mailto:r-sig-mixed-models at r-project.org> <r-sig-mixed-models at r-project.org<mailto:r-sig-mixed-models at r-project.org>>
Subject: RE: glmmTMB Zero-inflated Gamma GLMM

[EXTERNAL]


Hi Trent,

I'm not familiar with glmmTMB, so take what I say here with a grain of salt!

Assuming you are adding a random intercept (it looks like that's what yr doing). Then I think it depends on whether you want to simulate just those 3 individuals, or the population.

If its just those 3 individuals then wouldn't you add their BLUP to the overall intercept in the linear predictor? And after that simulate the gamma rv for each of these 3 individuals only?

On the other hand if you want to simulate new individuals than I think you'd draw their simulated "BLUPS" from an appropriate distribution (which I think is usually a normal distribution with mean = 0 and SD as per yr model) - and then continue as above?

Chris Howden B.Sc. (Hons)
Founding Partner
Data Analysis, Modelling and Training
Evidence Based Strategy/Policy Development, IP Commercialisation and Innovation
(mobile) +61 (0) 410 689 945 | (skype) chris at trickysolutions.com.au<mailto:chris at trickysolutions.com.au>

-----Original Message-----
From: R-sig-mixed-models <r-sig-mixed-models-bounces at r-project.org<mailto:r-sig-mixed-models-bounces at r-project.org>> On Behalf Of DENNIS, TRENT via R-sig-mixed-models
Sent: Tuesday, 30 September 2025 7:15 AM
To: r-sig-mixed-models at r-project.org<mailto:r-sig-mixed-models at r-project.org>
Subject: [R-sig-ME] glmmTMB Zero-inflated Gamma GLMM

Business Use


Hello,

I am trying to simulate a response from a zero-inflated Gamma generalized linear mixed-effect model and have a question when it comes to the random effects. I am fitting the models with glmmTMB, using ziGamma as the family with a log link function.

Say I fit the model with a random effect for subject (N=3 subjects) and 1 covariate (treatment), which I only include in the conditional Gamma model. Example code:

  model <- glmmTMB(Lactobacillus_crispatus~Treatment+(1|Subject),
                   ziformula = ~ 1,
                   family = ziGamma(link="log"),
                   data=data)


 These are the coefficients I get:

Conditional model:
Intercept: 1.5
Treatment A: -1

Zero model:
Intercept: 1.8

Random effects, conditional:
Subject 1: -2
Subject 2: 0.5
Subject 3: 1



Would you incorporate the random effects into the linear predictor for the Gamma component then simulate Gamma rv, or do the random effects get used to simulate a normal rv which is then added to the Gamma rv? (I also simultaneously simulate a binomial rv based on the proability an observation will be non-zero and multiply this by corresponding Gamma rv to complete the zero-inflated component).

I have simplified my data for illustration sake. The real data is metagenomic species data with 23 subjects. Each subject was swabbed/sequenced at 7 visits and 8 anatomical sites per visit.


Any info would be greatly appreciated.

Thank you,



        [[alternative HTML version deleted]]

_______________________________________________
R-sig-mixed-models at r-project.org<mailto:R-sig-mixed-models at r-project.org> mailing list https://urldefense.com/v3/__https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models__;!!NgSi4SaN6ydtRVQ-!xnUtAYJ9DWhuOK_-6LpOk9aBPtFCbFFTBAK7slm1k4eg8S2yXWon0hrc2y2ZmfXl7Qp0q4XJ2PpLf7JjP2duAQ$<https://urldefense.com/v3/__https:/stat.ethz.ch/mailman/listinfo/r-sig-mixed-models__;!!NgSi4SaN6ydtRVQ-!xnUtAYJ9DWhuOK_-6LpOk9aBPtFCbFFTBAK7slm1k4eg8S2yXWon0hrc2y2ZmfXl7Qp0q4XJ2PpLf7JjP2duAQ$>

	[[alternative HTML version deleted]]


From o||verhooker @end|ng |rom pr@t@t|@t|c@@com  Fri Oct 10 16:11:30 2025
From: o||verhooker @end|ng |rom pr@t@t|@t|c@@com (Oliver Hooker)
Date: Fri, 10 Oct 2025 15:11:30 +0100
Subject: [R-sig-ME] =?utf-8?q?Bayesian_Multilevel_Modelling_Using=C2=A0br?=
	=?utf-8?q?ms=C2=A0for_Ecologists_=28BMME01=29?=
Message-ID: <CAEsSYzyrU=0ubqPwjURMs7UHz4xBFy83DSu2E6QQU7NnfC-g9A@mail.gmail.com>

Bayesian Multilevel Modelling Using *brms* for Ecologists (BMME01)
www.prstats.org/course/bayesian-multilevel-modelling-using-brms-for-ecologists-bmme01
<https://www.prstats.org/course/bayesian-multilevel-modelling-using-brms-for-ecologists-bmme01?utm_source=chatgpt.com>

*Dates:* October 20?24 and 27?31, 2025
*Format:* Live online course (4 hours per day)
*Fee:* ?450 (standard) | ?400 (early bird for the first 5 registrations)
SOLD OUT

Bayesian methods are rapidly becoming the standard for ecological data
analysis. They offer a flexible, transparent, and robust approach to
dealing with uncertainty, hierarchical data structures, and complex
ecological processes. If you work with ecological data and want to extend
your modelling skills beyond classical statistics, this course will give
you the tools and understanding to do so with confidence.

*Bayesian Multilevel Modelling using brms for Ecologists (BMME01)* is an
intensive 10-day live online course designed to provide ecologists,
environmental scientists, and applied researchers with a solid grounding in
Bayesian hierarchical modelling using the *brms* package in R.

Over the course of ten sessions, participants will be guided step by step
through the key concepts and practical applications of Bayesian inference,
with a strong focus on real ecological examples. The course combines clear,
structured teaching with extensive hands-on coding and interpretation.
Course Overview

Participants will begin by reviewing the fundamentals of Bayesian
inference?priors, posteriors, and credible intervals?before moving on to
the construction and interpretation of generalised linear and multilevel
models. You will learn how to fit and diagnose models for a range of
ecological data types, including continuous, count, binary, and
zero-inflated data, as well as how to address common challenges such as
spatial and temporal autocorrelation.

Throughout, you will work with real-world datasets and gain practical
experience in coding models using *brms*, an R package that provides a
user-friendly interface to *Stan*, one of the most powerful Bayesian
computation frameworks available. By the end of the course, you will have
the skills to build, diagnose, and interpret complex Bayesian models
relevant to your own ecological research.
Key Topics Include

   -

   The foundations of Bayesian inference and model formulation
   -

   Understanding priors, posteriors, and credible intervals
   -

   Generalised linear models (GLMs) and extensions to hierarchical models
   -

   Random effects, nested structures, and partial pooling
   -

   Modelling count, binary, zero-inflated, and multivariate ecological data
   -

   Incorporating spatial and temporal structures
   -

   Model checking, convergence diagnostics, and posterior predictive checks
   -

   Interpreting and communicating uncertainty in ecological research

Who Should Attend

This course is aimed at ecologists, environmental scientists, conservation
biologists, statisticians, and postgraduate researchers who already have a
working knowledge of R (data import, manipulation, and basic plotting) and
want to develop practical expertise in Bayesian multilevel modelling. No
prior experience with Bayesian methods is required?concepts and techniques
are introduced progressively, with plenty of guided practice and individual
feedback.
Why Choose This Course

   -

   Expert instruction from *Dr Niamh Mimnagh*, an experienced statistical
   ecologist and educator
   -

   A carefully balanced mix of lectures, demonstrations, and hands-on coding
   -

   Small-group format encouraging discussion and individual support
   -

   All course materials, R scripts, and datasets provided
   -

   Access to recorded sessions for 30 days after the course
   -

   Certificate of attendance upon completion

Registration

Places are limited to ensure an interactive learning experience. The early
bird rate of ?400 applies to the first five registrants. Standard
registration is ?450.

For full details, schedule, and registration, visit:
www.prstats.org/course/bayesian-multilevel-modelling-using-brms-for-ecologists-bmme01
<https://www.prstats.org/course/bayesian-multilevel-modelling-using-brms-for-ecologists-bmme01?utm_source=chatgpt.com>

-- 
Oliver Hooker PhD.
PR stats

	[[alternative HTML version deleted]]


From i@io m@iii@g oii phys@ii@-courses@org  Tue Oct 21 19:28:28 2025
From: i@io m@iii@g oii phys@ii@-courses@org (i@io m@iii@g oii phys@ii@-courses@org)
Date: Tue, 21 Oct 2025 19:28:28 +0200 (CEST)
Subject: [R-sig-ME] =?utf-8?q?online_course=3A_Applied_Bayesian_Modelling?=
 =?utf-8?q?_with_R-INLA=3A_A_Hands-on_Introduction_=2827=E2=80=9331_Octobe?=
 =?utf-8?q?r=29?=
Message-ID: <1761067708.86737039@webmail.jimdo.com>


Dear all,

Only a few seats remain for our upcoming Physalia online course ?Applied Bayesian Modelling with R-INLA: A Hands-on Introduction?, taking place from 27?31 October.
 
Course website: [ https://www.physalia-courses.org/courses-workshops/r-inla/ ]( https://www.physalia-courses.org/courses-workshops/r-inla/ )
 
This four-day hands-on workshop provides an accessible and applied introduction to Bayesian modelling using R-INLA, covering linear models, GLMs, GAMs, and GLMMs, with a strong focus on practical applications and interpretation.
 
 
Best regards,
 
Carlo
 
 
 
 
--------------------

Carlo Pecoraro, Ph.D


Physalia-courses DIRECTOR

info at physalia-courses.org

mobile: +49 17645230846

[ Bluesky ]( https://bsky.app/profile/physaliacourses.bsky.social ) [ Linkedin ]( https://www.linkedin.com/in/physalia-courses-a64418127/ )


	[[alternative HTML version deleted]]


From h|gh@t@t @end|ng |rom h|gh@t@t@com  Thu Oct 23 08:03:21 2025
From: h|gh@t@t @end|ng |rom h|gh@t@t@com (Alain Zuur)
Date: Thu, 23 Oct 2025 07:03:21 +0100
Subject: [R-sig-ME] 4 hybrid stats courses in Australia
Message-ID: <d6409c22-4a6c-4fae-a85f-3a6b7cb6dfec@highstat.com>

We?re pleased to announce four hybrid statistics courses in Australia in 
February and March 2026.

Format: On-site and simultaneously online (live).

*Hybrid (online and onsite) courses in Australia:*

  * Introduction to linear mixed-effects models and GLMM with R. Murdoch
    University, Perth. 9-13 February 2026.
  * GLMs and GAMs with Spatial, Temporal, or Spatial-Temporal
    Correlation using INLA.?Murdoch University, Perth. 16-20 February 2026.
  * GLMs and GAMs with Spatial, Temporal, or Spatial-Temporal
    Correlation using INLA. Deakin University, Melbourne. 23-27 February
    2026. *7 onsite seats left!*
  * Introduction to GAMM and GLMM with R (frequentist). - With GAM
    applications to spatial, temporal, and spatial-temporal data -. JCU,
    Townsville. 2-6 March 2026.


Flyers and registration: www.highstat.com

Early registration is recommended

Kind regards,

Alain



	[[alternative HTML version deleted]]


From hkubr@@eno| @end|ng |rom gm@||@com  Mon Nov  3 16:15:49 2025
From: hkubr@@eno| @end|ng |rom gm@||@com (HATICE T KUBRA AKDUR)
Date: Mon, 3 Nov 2025 18:15:49 +0300
Subject: [R-sig-ME] =?utf-8?q?Clarification_on_the_=E2=80=9Csize=E2=80=9D?=
	=?utf-8?q?_parameter_used_for_RQR_=28Dunn=E2=80=93Smyth_residuals?=
	=?utf-8?q?=29_in_NB1_and_NB2_models_in_glmmTMB?=
In-Reply-To: <CA+_DO+zoWShJS5NZy9C5J98Wy4_gHJ-3A1Awn2kYa44eMFLidw@mail.gmail.com>
References: <CA+_DO+wUEs=v0BxZ3AZ46gmZC0yqHLV4=Ypc+D1gvm8CQcRzKA@mail.gmail.com>
 <E8FC7326-D609-433C-8A76-5B4D9D6B1F21@yahoo.fr>
 <CA+_DO+zoWShJS5NZy9C5J98Wy4_gHJ-3A1Awn2kYa44eMFLidw@mail.gmail.com>
Message-ID: <CA+_DO+x5SoyOn4Tj5ddYpXGkPP_PSmCZHhGi1=9xwLTv3FNeFg@mail.gmail.com>

Dear glmmTMB development team,

I am currently working with *glmmTMB* to fit several count mixed-effects
models, including *nbinom1* and *nbinom2* families. I would like to
compute *Randomized
Quantile Residuals (Dunn?Smyth residuals)* manually, following the standard
definition:

[
u_i = F(y_i - 1 \mid \mu_i, \theta_i) + f(y_i \mid \mu_i, \theta_i)\cdot
U(0,1)
]
[
\text{RQR}_i = \Phi^{-1}(u_i)
]

To do this, I need to supply the correct *?size?* parameter to R?s dnbinom()
and pnbinom() functions.

However, I am unsure about the exact relationship between:

   -

   the dispersion parameter estimated by *glmmTMB* (sigma() output),
   -

   the model parametrization used internally in nbinom1 and nbinom2, and
   -

   the ?size? argument required by dnbinom/pnbinom.

Could you please confirm whether the relationships above are correct?

Specifically:

   1.

   *Is sigma(model)^2 equal to 1/? for NB2 and equal to ? for NB1?*
   2.

   *When computing Dunn?Smyth residuals, is it correct to pass*
   -

      size = 1/sigma^2 for NB2
      -

      size = mu / sigma^2 (observation-specific) for NB1
      *to dnbinom/pnbinom?*
      3.

   *Is this exactly the parametrization used internally when glmmTMB
   computes type="dunn-smyth" residuals?*

I want to ensure that the residuals I compute manually are fully consistent
with the definitions used inside glmmTMB.

Thank you very much for your time, and for developing such an excellent and
flexible modeling framework.

Best regards,
Hatice

	[[alternative HTML version deleted]]


From o||verhooker @end|ng |rom pr@t@t|@t|c@@com  Tue Nov 11 16:17:07 2025
From: o||verhooker @end|ng |rom pr@t@t|@t|c@@com (Oliver Hooker)
Date: Tue, 11 Nov 2025 15:17:07 +0000
Subject: [R-sig-ME] Bayesian Multilevel Modelling using brms for Ecologists
 (BMME02)
Message-ID: <CAEsSYzyec8R4xEKuf0tyJPBmpMDt46AN7Sg5EOr_RqDFFzYc8w@mail.gmail.com>

Advance Your Ecological Research with Bayesian Multilevel Modelling

Take your data analysis to the next level with this hands-on course:

Bayesian Multilevel Modelling using brms for Ecologists (BMME02)
<https://prstats.org/course/bayesian-multilevel-modelling-using-brms-for-ecologists-bmme02/>

This 5-day live, online workshop is designed by ecologists, for ecologists
who want to master the use of Bayesian approaches for complex, hierarchical
data. You?ll gain the practical skills and confidence to apply brms in R to
real ecological datasets, exploring topics such as GLMs, GLMMs,
hierarchical and zero-inflated models.

 What you?ll learn:


   -

   Core principles of Bayesian inference ? priors, posteriors, and credible
   intervals
   -

   How to fit and interpret multilevel models using the brms package
   -

   Best practices for model checking, residual diagnostics, and
   visualization
   -

   Techniques to handle zero-inflated and overdispersed ecological data
   -

   How to apply these models directly to your own research questions


Whether you?re studying population dynamics, biodiversity patterns, or
ecological processes, this course will equip you with cutting-edge
statistical tools for transparent, reproducible science.


Spaces are limited ? secure your spot today and transform how you model
ecological data!

Register here
<https://prstats.org/course/bayesian-multilevel-modelling-using-brms-for-ecologists-bmme02/>



Oliver Hooker PhD.
PR stats

	[[alternative HTML version deleted]]


From don-|me4 @end|ng |rom |@|@@c@3-|nc@com  Thu Nov 13 20:32:20 2025
From: don-|me4 @end|ng |rom |@|@@c@3-|nc@com (Don Cohen)
Date: Thu, 13 Nov 2025 19:32:20 +0000
Subject: [R-sig-ME] generalized binomial distribution
Message-ID: <26902.12868.188437.643978@isis.cs3-inc.com>


I think I have a reasonable use for the binomial distribution with
non-integer arguments, and would appreciate references to other cases
where this has been done (or reasons it should NOT be done).

I notice
 glmmTMB(c(.5,2/3,.4)~1,weights=c(2.2,3,5),family= binomial)

[notice the non integer weight 2.2 with probability .5 also
giving a non-integer number of successes]

shows
     AIC      BIC   logLik df.resid
 7.74875  6.84736 -2.87437        2
(and intercept 0, which was intentional)

and the loglik agrees with what I compute from simply generalizing
dbinom to non-integers by replacing factorial with gamma:
 choose2 = function(outof, howmany)                                                         
  return( gamma(outof+1)/(gamma(howmany+1) * gamma(outof+1-howmany)))                      
 dbinom2=function(x,size,prob)return(choose2(size,x)*prob^x * (1-prob)^(size-x))            

 log( dbinom(2,3,.5) * dbinom(2,5,.5) * dbinom(1.1,2.2,.5))
 => NaN
but
 log( dbinom2(2,3,.5) * dbinom2(2,5,.5) * dbinom2(1.1,2.2,.5))
 => -2.874375

So glmmTMB must not be using the regular dbinom function to compute loglik.
I have to guess this was an intentional generalization in glmmTMB.
Is it there for some particular reason?  (related to my original question)

Whereas
 glm(c(.5,2/3,.4)~1,weights=c(2.2,3,5),family= binomial)
shows
 Residual Deviance: 0.5412       AIC: 7.674
which is different, and in fact the same result as
 glm(c(.5,2/3,.4)~1,weights=c(2,3,5),family= binomial)
which I think means that glm is rounding (or possibly truncating) the 2.2.

A related question is how to find the code that glmmTMB is using for
the loglik computations above.  I can see the definition of glmmTMB but
that quickly leads to functions for which there seem to be no available
definitions.  I can find some of them by downloading the source, but so
far I don't see anything there that looks like it's computing dbinom as
I expect.


