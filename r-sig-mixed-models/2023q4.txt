From @@nto@h@b@@r|n|v@@ @end|ng |rom out|ook@com  Sun Oct  8 17:32:31 2023
From: @@nto@h@b@@r|n|v@@ @end|ng |rom out|ook@com (Santosh Srinivas)
Date: Sun, 8 Oct 2023 15:32:31 +0000
Subject: [R-sig-ME] How to specify correlation structure along with modeling
 heteroskedasticity in glmmTMB?
Message-ID: <BY3PR06MB7907DBE7A767AD90A6CE1F04C9CFA@BY3PR06MB7907.namprd06.prod.outlook.com>

Hello list members,

For one of our papers, we are trying to understand if there is an equivalent of the following nlme::lme() specification in glmmTMB:
m = lme(y ~ gender + time, data = df, random= ~1+time|id, correlation = corAR1(), weights = varExp(form = ~time))

In our case, time = 0, 1, 2, ....8, where year 2008 was converted to 0, 2009 to 1, and so on for all individuals. Not all individuals have data on all timepoints. They also may start at different timepoints.

------------------------------------
id --- y --- time --- gender
------------------------------------
ab --- 0.2 --- 1 --- 2
ab --- 0.3 --- 2 --- 2
ac --- 0.5 --- 0 --- 1
ac --- 0.2 --- 1 --- 1
ac --- 0.7 --- 3 --- 1
bd --- 0.3 --- 2 --- 2
bd --- 0.2 --- 5 --- 2
bd --- 0.3 --- 8 --- 2
:
:

In essence, we are wondering if it is possible to include a) first-order autoregressive structure, along with b) modeling heteroscedasticity as an exponent of the covariate instead of as a power function of the covariate in glmmTMB.

>From the documentation, it appears that the below specification achieves the purpose:
m_alt = glmmTMB(y ~ gender + time + ar1(0 + factor(time)|id) + (1|id), data= df, dispformula = ~factor(time))

Not sure if our understanding of the model specification is right.


  1.  Is ar1() as specified here equivalent to corAr1() above?
  2.  Is dispformula = ~factor(time) equivalent to weights = varExp(form = ~time)?
  3.  We are also unsure if we are messing up with factorizing time.

Request your expertise and help.

Thank you.
sbs








	[[alternative HTML version deleted]]


From bbo|ker @end|ng |rom gm@||@com  Sun Oct  8 18:49:07 2023
From: bbo|ker @end|ng |rom gm@||@com (Ben Bolker)
Date: Sun, 8 Oct 2023 12:49:07 -0400
Subject: [R-sig-ME] 
 How to specify correlation structure along with modeling
 heteroskedasticity in glmmTMB?
In-Reply-To: <BY3PR06MB7907DBE7A767AD90A6CE1F04C9CFA@BY3PR06MB7907.namprd06.prod.outlook.com>
References: <BY3PR06MB7907DBE7A767AD90A6CE1F04C9CFA@BY3PR06MB7907.namprd06.prod.outlook.com>
Message-ID: <8f562f61-83a7-4347-94c9-fb106f55cb06@gmail.com>



On 2023-10-08 11:32 a.m., Santosh Srinivas wrote:
> Hello list members,
> 
> For one of our papers, we are trying to understand if there is an equivalent of the following nlme::lme() specification in glmmTMB:
> m = lme(y ~ gender + time, data = df, random= ~1+time|id, correlation = corAR1(), weights = varExp(form = ~time))
> 
> In our case, time = 0, 1, 2, ....8, where year 2008 was converted to 0, 2009 to 1, and so on for all individuals. Not all individuals have data on all timepoints. They also may start at different timepoints.
> 
> ------------------------------------
> id --- y --- time --- gender
> ------------------------------------
> ab --- 0.2 --- 1 --- 2
> ab --- 0.3 --- 2 --- 2
> ac --- 0.5 --- 0 --- 1
> ac --- 0.2 --- 1 --- 1
> ac --- 0.7 --- 3 --- 1
> bd --- 0.3 --- 2 --- 2
> bd --- 0.2 --- 5 --- 2
> bd --- 0.3 --- 8 --- 2
> :
> :
> 
> In essence, we are wondering if it is possible to include a) first-order autoregressive structure, along with b) modeling heteroscedasticity as an exponent of the covariate instead of as a power function of the covariate in glmmTMB.
> 
>  From the documentation, it appears that the below specification achieves the purpose:
> m_alt = glmmTMB(y ~ gender + time + ar1(0 + factor(time)|id) + (1|id), data= df, dispformula = ~factor(time))
> 
> Not sure if our understanding of the model specification is right.
> 
> 
>    1.  Is ar1() as specified here equivalent to corAr1() above?
>    2.  Is dispformula = ~factor(time) equivalent to weights = varExp(form = ~time)?
>    3.  We are also unsure if we are messing up with factorizing time.


   Almost.

   1. Yes.
   2. I don't think so. I think it should be dispformula = ~ time; the 
dispersion model uses a log link, so this should correspond to var = 
exp(a + b*time) = v0*exp(b*time), which should be the same as varExp
   3. You should be using time as a factor in the ar1() specification 
but numeric in the dispformula specification.

   When in doubt, I'd recommend fitting both packages/formulations to a 
small made-up data set to see if they give answers that are identical 
(up to rounding errors/variation)

> 
> Request your expertise and help.
> 
> Thank you.
> sbs
> 
> 
> 
> 
> 
> 
> 
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models

-- 
Dr. Benjamin Bolker
Professor, Mathematics & Statistics and Biology, McMaster University
Director, School of Computational Science and Engineering
(Acting) Graduate chair, Mathematics & Statistics
 > E-mail is sent at my convenience; I don't expect replies outside of 
working hours.


From @@nto@h@b@@r|n|v@@ @end|ng |rom out|ook@com  Sun Oct  8 19:03:24 2023
From: @@nto@h@b@@r|n|v@@ @end|ng |rom out|ook@com (Santosh Srinivas)
Date: Sun, 8 Oct 2023 17:03:24 +0000
Subject: [R-sig-ME] 
 How to specify correlation structure along with modeling
 heteroskedasticity in glmmTMB?
In-Reply-To: <8f562f61-83a7-4347-94c9-fb106f55cb06@gmail.com>
References: <BY3PR06MB7907DBE7A767AD90A6CE1F04C9CFA@BY3PR06MB7907.namprd06.prod.outlook.com>
 <8f562f61-83a7-4347-94c9-fb106f55cb06@gmail.com>
Message-ID: <BY3PR06MB7907A928C902C2C2A37865B6C9CFA@BY3PR06MB7907.namprd06.prod.outlook.com>

Thank you so much for your kind help, Dr. Bolker. This is informative and timely advice.

Regards,
sbs
________________________________
From: R-sig-mixed-models <r-sig-mixed-models-bounces at r-project.org> on behalf of Ben Bolker <bbolker at gmail.com>
Sent: Sunday, October 8, 2023 6:49 PM
To: r-sig-mixed-models at r-project.org <r-sig-mixed-models at r-project.org>
Subject: Re: [R-sig-ME] How to specify correlation structure along with modeling heteroskedasticity in glmmTMB?



On 2023-10-08 11:32 a.m., Santosh Srinivas wrote:
> Hello list members,
>
> For one of our papers, we are trying to understand if there is an equivalent of the following nlme::lme() specification in glmmTMB:
> m = lme(y ~ gender + time, data = df, random= ~1+time|id, correlation = corAR1(), weights = varExp(form = ~time))
>
> In our case, time = 0, 1, 2, ....8, where year 2008 was converted to 0, 2009 to 1, and so on for all individuals. Not all individuals have data on all timepoints. They also may start at different timepoints.
>
> ------------------------------------
> id --- y --- time --- gender
> ------------------------------------
> ab --- 0.2 --- 1 --- 2
> ab --- 0.3 --- 2 --- 2
> ac --- 0.5 --- 0 --- 1
> ac --- 0.2 --- 1 --- 1
> ac --- 0.7 --- 3 --- 1
> bd --- 0.3 --- 2 --- 2
> bd --- 0.2 --- 5 --- 2
> bd --- 0.3 --- 8 --- 2
> :
> :
>
> In essence, we are wondering if it is possible to include a) first-order autoregressive structure, along with b) modeling heteroscedasticity as an exponent of the covariate instead of as a power function of the covariate in glmmTMB.
>
>  From the documentation, it appears that the below specification achieves the purpose:
> m_alt = glmmTMB(y ~ gender + time + ar1(0 + factor(time)|id) + (1|id), data= df, dispformula = ~factor(time))
>
> Not sure if our understanding of the model specification is right.
>
>
>    1.  Is ar1() as specified here equivalent to corAr1() above?
>    2.  Is dispformula = ~factor(time) equivalent to weights = varExp(form = ~time)?
>    3.  We are also unsure if we are messing up with factorizing time.


   Almost.

   1. Yes.
   2. I don't think so. I think it should be dispformula = ~ time; the
dispersion model uses a log link, so this should correspond to var =
exp(a + b*time) = v0*exp(b*time), which should be the same as varExp
   3. You should be using time as a factor in the ar1() specification
but numeric in the dispformula specification.

   When in doubt, I'd recommend fitting both packages/formulations to a
small made-up data set to see if they give answers that are identical
(up to rounding errors/variation)

>
> Request your expertise and help.
>
> Thank you.
> sbs
>
>
>
>
>
>
>
>
>        [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models

--
Dr. Benjamin Bolker
Professor, Mathematics & Statistics and Biology, McMaster University
Director, School of Computational Science and Engineering
(Acting) Graduate chair, Mathematics & Statistics
 > E-mail is sent at my convenience; I don't expect replies outside of
working hours.

_______________________________________________
R-sig-mixed-models at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models

	[[alternative HTML version deleted]]


From w|wp@31 @end|ng |rom gm@||@com  Thu Oct 19 12:53:06 2023
From: w|wp@31 @end|ng |rom gm@||@com (Werner Poschenrieder)
Date: Thu, 19 Oct 2023 12:53:06 +0200
Subject: [R-sig-ME] glmmTMB model requires weights in prediction - what to
 supply
Message-ID: <CAC+RVsSeSu3L8jF9Y=cZOiOQB30neTaxURKWTDOT4QntqbQzcg@mail.gmail.com>

Dear Mixed-Models Community,



I have to predict from a model of class glmmTMB that has been calibrated as
follows



the_formula = as.formula("used_avail ~ SHA_DI_cat +
scale(forest_dist_raster) + scale(resid_dist_raster) +
scale(woody_dist_raster) + scale(road_dist_raster) +
scale(I(road_dist_raster^2)) + grassland + (1|study.area) + (1|IDyear)")



tmbmod = glmmTMB::glmmTMB(the_formula , data = group_df, weights = weight,
family = binomial(link = "logit"), na.action = na.omit)



I am surprised that prediction from that model using newdata does complain:



predict(tmbmod, newdata = df_newdata, type = type, re.form = "~0", se.fit =
T, allow.new.levels=TRUE)

Error in eval(extras, data, env) : object 'weight' not found



where df_newdata includes any of the predictors, i.e. fixed and random
effects. However, it does not include the column weight, as to my
understanding weights are for giving the residual a particular weight in
the course of fitting the model.

Such a weight thus results in an according value of the resulting effects.



What are weights for in prediction with glmmTMB, and thus, what value to
set them to?



Thanks in advance, best



Werner

	[[alternative HTML version deleted]]


From bbo|ker @end|ng |rom gm@||@com  Fri Oct 20 02:16:11 2023
From: bbo|ker @end|ng |rom gm@||@com (Ben Bolker)
Date: Thu, 19 Oct 2023 20:16:11 -0400
Subject: [R-sig-ME] 
 glmmTMB model requires weights in prediction - what to supply
In-Reply-To: <CAC+RVsSeSu3L8jF9Y=cZOiOQB30neTaxURKWTDOT4QntqbQzcg@mail.gmail.com>
References: <CAC+RVsSeSu3L8jF9Y=cZOiOQB30neTaxURKWTDOT4QntqbQzcg@mail.gmail.com>
Message-ID: <fc2ee03e-82ed-4636-b827-8e4e794433c0@gmail.com>

   It would probably be harmless to specify weight = 1 for the 
prediction.  I suspect this is just a side effect of the way that the 
prediction machinery works (I haven't looked). If you have a 
reproducible example, could you post this as an issue at the glmmTMB 
issues list?

On 2023-10-19 6:53 a.m., Werner Poschenrieder wrote:
> Dear Mixed-Models Community,
> 
> 
> 
> I have to predict from a model of class glmmTMB that has been calibrated as
> follows
> 
> 
> 
> the_formula = as.formula("used_avail ~ SHA_DI_cat +
> scale(forest_dist_raster) + scale(resid_dist_raster) +
> scale(woody_dist_raster) + scale(road_dist_raster) +
> scale(I(road_dist_raster^2)) + grassland + (1|study.area) + (1|IDyear)")
> 
> 
> 
> tmbmod = glmmTMB::glmmTMB(the_formula , data = group_df, weights = weight,
> family = binomial(link = "logit"), na.action = na.omit)
> 
> 
> 
> I am surprised that prediction from that model using newdata does complain:
> 
> 
> 
> predict(tmbmod, newdata = df_newdata, type = type, re.form = "~0", se.fit =
> T, allow.new.levels=TRUE)
> 
> Error in eval(extras, data, env) : object 'weight' not found
> 
> 
> 
> where df_newdata includes any of the predictors, i.e. fixed and random
> effects. However, it does not include the column weight, as to my
> understanding weights are for giving the residual a particular weight in
> the course of fitting the model.
> 
> Such a weight thus results in an according value of the resulting effects.
> 
> 
> 
> What are weights for in prediction with glmmTMB, and thus, what value to
> set them to?
> 
> 
> 
> Thanks in advance, best
> 
> 
> 
> Werner
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models


From @d@m@tc|@rk @end|ng |rom gm@||@com  Mon Nov  6 14:03:26 2023
From: @d@m@tc|@rk @end|ng |rom gm@||@com (Adam Clark)
Date: Mon, 6 Nov 2023 14:03:26 +0100
Subject: [R-sig-ME] Non-zero residual sums, correlation structure (nlme)
Message-ID: <CAL7OOdweJUziZLnr1z4hLp3T=57mybC7yA7MwhHVdv5f4cDU6g@mail.gmail.com>

Hi all,

My colleague and I were working through some examples in the Pinheiro and
Bates book, and ran into a bit of a puzzle. When we try fitting a simple
intercept-only model to the default Orthodont dataset that includes a
correlation structure, the residuals of the model no longer add up to 0 -
rather, they diverge from zero quite a bit. This divergence seems to be
much larger than we would expect simply from finite computational error.

I'm sure that the answer is that I'm missing something fundamental about
what the correlation structure is doing to the model residuals, but after
quite a bit of Googling, I'm none the wiser.

Can anyone suggest a source that I could read (or an answer) that could
explain this behaviour?

Many thanks,
Adam Clark


### example code
require(nlme)
data(Orthodont)
## 1. fit mixed model
mod_lme = lme(distance ~ 1, Orthodont, random = ~1|Subject)
resid_lme = Orthodont$distance-predict(mod_lme, level = 0)

# raw residuals
sum(resid_lme) # ~0

# normalised residuals
sum(residuals(mod_lme, type = "n")) # ~0


## 2. fit mixed model with correlation structure
mod_lme2 = lme(distance ~ 1, Orthodont, random = ~1|Subject, correlation =
corSymm(form = ~1|Subject))
resid_lme2 = Orthodont$distance-predict(mod_lme2, level = 0)

# raw residuals
sum(resid_lme2) # -11.9!

# normalised residuals
sum(residuals(mod_lme2, type = "n")) # 17.8!

-- 
Adam Thomas Clark
Asst. Professor
Karl-Franzens-Universit?t Graz
Institut f?r Biologie
www.adamclarktheecologist.com

	[[alternative HTML version deleted]]


From hedyeh@h @end|ng |rom u@c@edu  Mon Nov  6 17:37:53 2023
From: hedyeh@h @end|ng |rom u@c@edu (Hedyeh Ahmadi)
Date: Mon, 6 Nov 2023 16:37:53 +0000
Subject: [R-sig-ME] Looking for a multi-level mixture models
Message-ID: <LV3PR07MB9943510C81DC2A682924352ED1AAA@LV3PR07MB9943.namprd07.prod.outlook.com>

Hello all,
I am looking for an R package that can implement multi-level finite mixture models with more than 2 levels (at least 3 levels).

I know flexmix() can implement repeated measure but that's about it.

Any suggestions and/or resources would be greatly appreciated.

Best,

Hedyeh Ahmadi, Ph.D.
Statistician
Keck School of Medicine
Department of Preventive Medicine
University of Southern California

LinkedIn
www.linkedin.com/in/hedyeh-ahmadi<http://www.linkedin.com/in/hedyeh-ahmadi>





	[[alternative HTML version deleted]]


From bbo|ker @end|ng |rom gm@||@com  Mon Nov  6 17:46:41 2023
From: bbo|ker @end|ng |rom gm@||@com (Ben Bolker)
Date: Mon, 6 Nov 2023 11:46:41 -0500
Subject: [R-sig-ME] Looking for a multi-level mixture models
In-Reply-To: <LV3PR07MB9943510C81DC2A682924352ED1AAA@LV3PR07MB9943.namprd07.prod.outlook.com>
References: <LV3PR07MB9943510C81DC2A682924352ED1AAA@LV3PR07MB9943.namprd07.prod.outlook.com>
Message-ID: <d11c7cd3-e103-4818-afbb-9b88e5e873ef@gmail.com>

   Unfortunately that's sort of off-topic for this list (which covers 
*mixed* models, i.e. hierarchical models where there are *observed* 
grouping variables, not *finite/discrete mixture* models, which model 
*unobserved* or latent groups), but possibly someone will have a helpful 
suggestion anyway.

On 2023-11-06 11:37 a.m., Hedyeh Ahmadi wrote:
> Hello all,
> I am looking for an R package that can implement multi-level finite mixture models with more than 2 levels (at least 3 levels).
> 
> I know flexmix() can implement repeated measure but that's about it.
> 
> Any suggestions and/or resources would be greatly appreciated.
> 
> Best,
> 
> Hedyeh Ahmadi, Ph.D.
> Statistician
> Keck School of Medicine
> Department of Preventive Medicine
> University of Southern California
> 
> LinkedIn
> www.linkedin.com/in/hedyeh-ahmadi<http://www.linkedin.com/in/hedyeh-ahmadi>
> 
> 
> 
> 
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models


From ju||u@@o|@||@ @end|ng |rom ok@t@te@edu  Tue Nov  7 21:46:58 2023
From: ju||u@@o|@||@ @end|ng |rom ok@t@te@edu (Olaifa, Julius)
Date: Tue, 7 Nov 2023 20:46:58 +0000
Subject: [R-sig-ME] Full Information matrix or Variance Covariance matrix in
 glmmTMB
Message-ID: <CO3PR03MB67583F07CDD4EB603D96D381EDA9A@CO3PR03MB6758.namprd03.prod.outlook.com>

I am trying to obtain the Fisher Information matrix or variance covariance matrix for a glmmTMB model. The model implements model$sdr$cov.fixed?  which returns the variance covariance matrix between the regression parameter coefficient (Beta)?and the dispersiom parameter (phi).
I however want to obtain the variance covariance matrix of both the fixed parameters and random effect covariance estimates (Beta, phi, Sigma)?

	[[alternative HTML version deleted]]


From bbo|ker @end|ng |rom gm@||@com  Tue Nov  7 23:40:59 2023
From: bbo|ker @end|ng |rom gm@||@com (Ben Bolker)
Date: Tue, 7 Nov 2023 17:40:59 -0500
Subject: [R-sig-ME] 
 Full Information matrix or Variance Covariance matrix in glmmTMB
In-Reply-To: <CO3PR03MB67583F07CDD4EB603D96D381EDA9A@CO3PR03MB6758.namprd03.prod.outlook.com>
References: <CO3PR03MB67583F07CDD4EB603D96D381EDA9A@CO3PR03MB6758.namprd03.prod.outlook.com>
Message-ID: <2d0ece47-9eac-4605-bd49-d3e796c23edf@gmail.com>



On 2023-11-07 3:46 p.m., Olaifa, Julius wrote:
> I am trying to obtain the Fisher Information matrix or variance covariance matrix for a glmmTMB model. The model implements model$sdr$cov.fixed?  which returns the variance covariance matrix between the regression parameter coefficient (Beta)?and the dispersiom parameter (phi).
> I however want to obtain the variance covariance matrix of both the fixed parameters and random effect covariance estimates (Beta, phi, Sigma)?

  I think vcov(., full = TRUE) will get what you want.

   I You should be able to get this by inverting the results of 
TMB::sdreport(..., getJointPrecision = TRUE), as for example:


library(glmmTMB)
data("sleepstudy", package = "lme4")
m1 <- glmmTMB(Reaction ~ Days + (Days|Subject), sleepstudy)
colnames(vcov(m1, full = TRUE))

                 cond1                  cond2                   disp
          "(Intercept)"                 "Days"        "d~(Intercept)"
                 theta1                 theta2                 theta3
"theta_Days|Subject.1" "theta_Days|Subject.2" "theta_Days|Subject.3"

   If you want the joint precision/covariance matrix that also includes 
the BLUPs/conditional modes:

ss <- TMB::sdreport(m1$obj, getJointPrecision = TRUE)
h <- solve(ss$jointPrecision)

    You should be aware that this could get ugly for large problems; the 
joint precision matrix (i.e., the inverse of covariance matrix) is 
sparse/well-structured, but the joint covariance matrix is dense.


> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models

-- 
Dr. Benjamin Bolker
Professor, Mathematics & Statistics and Biology, McMaster University
Director, School of Computational Science and Engineering
(Acting) Graduate chair, Mathematics & Statistics
 > E-mail is sent at my convenience; I don't expect replies outside of 
working hours.


From @|ex@cone@ @end|ng |rom uky@edu  Mon Nov  6 14:00:44 2023
From: @|ex@cone@ @end|ng |rom uky@edu (Cones, Alexandra G.)
Date: Mon, 6 Nov 2023 13:00:44 +0000
Subject: [R-sig-ME] Specifying bivariate priors with different distributions
 in MCMCglmm
Message-ID: <SN4PR03MB676775497B8C71920466176B8DAAA@SN4PR03MB6767.namprd03.prod.outlook.com>

Hello all!

I am having trouble specifying my priors for a bivariate model in MCMCglmm with two response variable distributions.  I want to see if they covary at the among-individual level ("ID"). I have two response variables, one is gaussian (parental feeding rate of chicks per hour "Rate_h") and one is binomial (proportion of chicks that survive "propfledged").

I am able to specify the priors and model successfully for the binomial case when it is univariate:

prior1 <- list(G = list(G1 = list(V = diag(1), nu = 0.002)), R = list(V = 0.5, nu = 0.002, fix = T))
model1<-MCMCglmm(propfledged~1,random=~ID,nitt=100000,rcov=~trait:units,thin=10,burnin=1000,prior=prior1,data=dat,family="categorical",verbose=FALSE)

Based on my reading, I hold the residual variance at a fixed value to improve the running of the model in the binomial case. However, when I want to set up the bivariate, I don't know how to properly set up my priors when I have both a gaussian and binomial response.

I tried this for the bivariate but was told that V is the wrong dimension for some prior$G/prior$R elements:

prior2<-list(R=list(V=diag(2),nu=0.002), G=list(G1=list(V=diag(2), nu=0.002)))
bivmodel<-MCMCglmm(cbind(Rate_h,propfledged)~trait,
                    random=~us(trait):ID,
                    rcov=~idh(trait):units,
                    family=c("gaussian","categorical"),
                    nitt=100000,thin=10,burnin=1000,prior=prior2,data=dat,verbose=FALSE)

I also tried fixing the residual variance in the bivariate and come up with the same problem (V is the wrong dimension for some prior$G/prior$R elements):

prior3<-list(R = list(V = 0.5, nu = 0.002, fix = T), G=list(G1=list(V=diag(2), nu=0.002)))
bivmodel2<-MCMCglmm(cbind(Rate_h,propfledged)~trait,
                    random=~us(trait):ID,
                    rcov=~idh(trait):units,
                    family=c("gaussian","categorical"),
                    nitt=100000,thin=10,burnin=1000,prior=prior3,data=dat,verbose=FALSE)

How do I correctly specify my priors here?

Thank you for your time!

Cheers,
Alex Cones

	[[alternative HTML version deleted]]


From j@h@d||e|d @end|ng |rom ed@@c@uk  Thu Nov  9 09:00:54 2023
From: j@h@d||e|d @end|ng |rom ed@@c@uk (Jarrod Hadfield)
Date: Thu, 9 Nov 2023 08:00:54 +0000
Subject: [R-sig-ME] 
 Specifying bivariate priors with different distributions in MCMCglmm
In-Reply-To: <SN4PR03MB676775497B8C71920466176B8DAAA@SN4PR03MB6767.namprd03.prod.outlook.com>
References: <SN4PR03MB676775497B8C71920466176B8DAAA@SN4PR03MB6767.namprd03.prod.outlook.com>
Message-ID: <5C8CA25C-B056-4F1A-A4EC-BCEF619D477F@ed.ac.uk>

Hi,

By specifying propfledged as ?categorical? you are treating each unique value of propfledged as a categorical variable. My guesses that this is not your intention. Binomial models should be of the form cbind(number_successes, number_failures)~ with family=?multinomial2?. The priors should then ?work? in the sense that they are of the right dimension. However, you shouldn?t fix the residual variance unless the binomial only has 1 trial (i.e. is Bernoulli).

Cheers,

Jarrod




On 6 Nov 2023, at 13:00, Cones, Alexandra G. <alex.cones at uky.edu> wrote:

propfledged

The University of Edinburgh is a charitable body, registered in Scotland, with registration number SC005336. Is e buidheann carthannais a th? ann an Oilthigh Dh?n ?ideann, cl?raichte an Alba, ?ireamh cl?raidh SC005336.

	[[alternative HTML version deleted]]


From |ongrob604 @end|ng |rom gm@||@com  Thu Nov  9 13:08:54 2023
From: |ongrob604 @end|ng |rom gm@||@com (Robert Long)
Date: Thu, 9 Nov 2023 12:08:54 +0000
Subject: [R-sig-ME] 
 https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models is down ?
Message-ID: <CA+3TTkOMKiZPF5V4KfJZeB26Uxo_VQM-AMR7zGiKHHYtuxX-dw@mail.gmail.com>

Hello all

Are the archives of this list still at
https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models ? If so, then it
appears to be down on my side. Or have they been moved somewhere else ?

Cheers
RL

	[[alternative HTML version deleted]]


From m@ech|er @end|ng |rom @t@t@m@th@ethz@ch  Thu Nov  9 14:31:29 2023
From: m@ech|er @end|ng |rom @t@t@m@th@ethz@ch (Martin Maechler)
Date: Thu, 9 Nov 2023 14:31:29 +0100
Subject: [R-sig-ME] 
 https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models is down ?
In-Reply-To: <CA+3TTkOMKiZPF5V4KfJZeB26Uxo_VQM-AMR7zGiKHHYtuxX-dw@mail.gmail.com>
References: <CA+3TTkOMKiZPF5V4KfJZeB26Uxo_VQM-AMR7zGiKHHYtuxX-dw@mail.gmail.com>
Message-ID: <25932.57137.23273.834052@stat.math.ethz.ch>

>>>>> Robert Long 
>>>>>     on Thu, 9 Nov 2023 12:08:54 +0000 writes:

    > Hello all

    > Are the archives of this list still at
    > https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models ? If so, then it
    > appears to be down on my side. Or have they been moved somewhere else ?

They were *NEVER* at the above URL.

Please do more carefully follow the links on the ML web page
(given in all R-SIG-Mixed-models footers).

    > Cheers
    > RL

    > [[alternative HTML version deleted]]


From moh@med@j@b|r @end|ng |rom hec@c@  Tue Nov 21 21:11:27 2023
From: moh@med@j@b|r @end|ng |rom hec@c@ (Mohamed Jabir)
Date: Tue, 21 Nov 2023 20:11:27 +0000
Subject: [R-sig-ME] Error in qr.default(X) : too large a matrix for LINPACK
Message-ID: <YT1PR01MB3387CE7205480C12C61C073883BBA@YT1PR01MB3387.CANPRD01.PROD.OUTLOOK.COM>

Hi,

I am trying to use glmmTMB. I am getting this error :
Error in qr.default(X) : too large a matrix for LINPACK
Calls: glmmTMB ... .adjustX -> <Anonymous> -> <Anonymous> -> qr.default
Execution halted
Can you help?

Best,

Mohamed Jabir
Analyste de donn?es LACED
Biblioth?que HEC Montr?al (LACED)
3000, chemin de la C?te-Sainte-Catherine
Montr?al (Qu?bec)  H3T 2A7
514-340-6934<https://inscription.hec.ca/signature/app/voir?type=minimal>
HEC Montr?al
hec.ca<http://www.hec.ca/>


	[[alternative HTML version deleted]]


From bbo|ker @end|ng |rom gm@||@com  Wed Nov 22 15:23:49 2023
From: bbo|ker @end|ng |rom gm@||@com (Ben Bolker)
Date: Wed, 22 Nov 2023 09:23:49 -0500
Subject: [R-sig-ME] 
 Error in qr.default(X) : too large a matrix for LINPACK
In-Reply-To: <YT1PR01MB3387CE7205480C12C61C073883BBA@YT1PR01MB3387.CANPRD01.PROD.OUTLOOK.COM>
References: <YT1PR01MB3387CE7205480C12C61C073883BBA@YT1PR01MB3387.CANPRD01.PROD.OUTLOOK.COM>
Message-ID: <b201e584-6bae-45e8-b086-5242ce5da32f@gmail.com>

   We'd love to help, but we can't help much without more information. 
How large is your data set, what analysis are you running?

   Based on the minimal info in the error message, it looks like the 
model is failing in the place where it checks to see whether the model 
matrix is collinear (i.e., here:

https://github.com/glmmTMB/glmmTMB/blob/5939686f39b169b7d5a81512b6a66025f103d598/glmmTMB/R/glmmTMB.R#L1432

) Digging a little bit farther, it seems that LINPACK can't do QR 
decomposition if the total size of your matrix is bigger than 2^31-1:

  if (1 * n * p > 2147483647)
         stop("too large a matrix for LINPACK")

   You should be able to skip this checking step by specifying

control = glmmTMBControl(rank_check = "skip")

  ... but you may run into trouble further down the line if your model 
matrix has more than a billion entries ...

   If you can tell us a little bit more about your problem people may be 
able to suggest strategies.

   Ben Bolker


On 2023-11-21 3:11 p.m., Mohamed Jabir wrote:
> Hi,
> 
> I am trying to use glmmTMB. I am getting this error :
> Error in qr.default(X) : too large a matrix for LINPACK
> Calls: glmmTMB ... .adjustX -> <Anonymous> -> <Anonymous> -> qr.default
> Execution halted
> Can you help?
> 
> Best,
> 
> Mohamed Jabir
> Analyste de donn?es LACED
> Biblioth?que HEC Montr?al (LACED)
> 3000, chemin de la C?te-Sainte-Catherine
> Montr?al (Qu?bec)  H3T 2A7
> 514-340-6934<https://inscription.hec.ca/signature/app/voir?type=minimal>
> HEC Montr?al
> hec.ca<http://www.hec.ca/>
> 
> 
> 	[[alternative HTML version deleted]]
> 
> 
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models


From benpe|zer @end|ng |rom gm@||@com  Mon Nov 27 12:23:34 2023
From: benpe|zer @end|ng |rom gm@||@com (ben pelzer)
Date: Mon, 27 Nov 2023 12:23:34 +0100
Subject: [R-sig-ME] homogeneous glmmTMB models
Message-ID: <CAFgPNS-x-g9vzw3VGK4wtYv2MkwqeUeuUVMgwOuiF1y8MUSQGg@mail.gmail.com>

Dear all,

In glmmTMB we have these nice heterogeneous variances models like compound
symmetry, ar1, toeplitz and unstructured, for the covariance matrix over
time, say. For a course I'm teaching, I would also like to discuss the more
"simple" homogeneous variances models with compound symmetry, ar1, etc.
These can be estimated with e.g. package nlme. But why are these not
available in glmmTMB? Or are they, and should I use a particular syntax?
Best regards,

Ben.

	[[alternative HTML version deleted]]


From bbo|ker @end|ng |rom gm@||@com  Mon Nov 27 16:31:31 2023
From: bbo|ker @end|ng |rom gm@||@com (Ben Bolker)
Date: Mon, 27 Nov 2023 10:31:31 -0500
Subject: [R-sig-ME] homogeneous glmmTMB models
In-Reply-To: <CAFgPNS-x-g9vzw3VGK4wtYv2MkwqeUeuUVMgwOuiF1y8MUSQGg@mail.gmail.com>
References: <CAFgPNS-x-g9vzw3VGK4wtYv2MkwqeUeuUVMgwOuiF1y8MUSQGg@mail.gmail.com>
Message-ID: <06081528-0ffe-45c3-b121-061e33b82dce@gmail.com>

   They're not available because no-one has gotten around to writing 
them yet. Pull requests welcome ...

   There are a few notes here (search for "Adding a covariance 
structure") about what needs to be done to add them:

http://glmmtmb.github.io/glmmTMB/articles/hacking.html

   which outlines the code added in this pull request: 
https://github.com/glmmTMB/glmmTMB/pull/891

   Alternatively, you can do this with the map= argument:

data("cbpp", package = "lme4")
library(glmmTMB)

## fit a binomial model with compound-specific variation among periods
m1 <- glmmTMB(cbind(incidence, size-incidence) ~ period + 
cs(period+0|herd), cbpp, family = binomial)

## fix all of the log-standard-deviation parameters (first 4 elements of
##   the random-effects parameter vector to be equal;
##  estimate the correlation (element 5) separately

m2 <- update(m1, map = list(theta = factor(c(rep(1,4), 2))))

   The good news is that you can do this without waiting for anyone to 
update the code.  The bad news is that it's scarier-looking for your 
students (you have to know that the random-effects variance parameter 
vector is called 'theta', how the compound symmetric model is 
parameterized (see the table at the beginning of 
http://glmmtmb.github.io/glmmTMB/articles/covstruct.html; and how the 
map= argument works).

   cheers
    Ben Bolker



On 2023-11-27 6:23 a.m., ben pelzer wrote:
> Dear all,
> 
> In glmmTMB we have these nice heterogeneous variances models like compound
> symmetry, ar1, toeplitz and unstructured, for the covariance matrix over
> time, say. For a course I'm teaching, I would also like to discuss the more
> "simple" homogeneous variances models with compound symmetry, ar1, etc.
> These can be estimated with e.g. package nlme. But why are these not
> available in glmmTMB? Or are they, and should I use a particular syntax?
> Best regards,
> 
> Ben.
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models


From benpe|zer @end|ng |rom gm@||@com  Tue Nov 28 09:50:14 2023
From: benpe|zer @end|ng |rom gm@||@com (ben pelzer)
Date: Tue, 28 Nov 2023 09:50:14 +0100
Subject: [R-sig-ME] homogeneous glmmTMB models
In-Reply-To: <06081528-0ffe-45c3-b121-061e33b82dce@gmail.com>
References: <CAFgPNS-x-g9vzw3VGK4wtYv2MkwqeUeuUVMgwOuiF1y8MUSQGg@mail.gmail.com>
 <06081528-0ffe-45c3-b121-061e33b82dce@gmail.com>
Message-ID: <CAFgPNS_iweDMW-mQvEZdsMFnsWY3hHE1dv54Mv210EKCfDLxyA@mail.gmail.com>

Thanks for your reply Ben, I've tried your "maps" suggestion for a Toeplitz
model and that works fine. Indeed it looks scary, as you say, but then
again this is also true for the way it is done in gls from the nlme
package, where Toeplitz is specified as an ARMA structure (which I do not
understand too, just apply it). The glmmTMB summary shows the estimated
variances and correlations under the Random Effects, which is not the case
with gls. Hence I like the glmmTMB results more. For gls I use covmat <-
getVarcov(model, individual="3") for a case observed at all time points,
and then covmat must be converted into correlations; all in all not really
nice in a course. Thanks again!

	[[alternative HTML version deleted]]


From @hm@t|@@ @end|ng |rom gm@||@com  Thu Nov 30 11:09:59 2023
From: @hm@t|@@ @end|ng |rom gm@||@com (Toni Hernandez-Matias)
Date: Thu, 30 Nov 2023 11:09:59 +0100
Subject: [R-sig-ME] how to cite github resources'
Message-ID: <CA+hwERn8r6B5O+nUU28dYRiY=EnRfVCk0XQoA5AZ23_uHcoUrA@mail.gmail.com>

Dear all,
I would like to cite this information:
https://bbolker.github.io/mixedmodels-misc/glmmFAQ.html#testing-significance-of-random-effects

Do you know which format should I use?

Thanks in advance,

Toni

	[[alternative HTML version deleted]]


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Thu Nov 30 16:06:12 2023
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Thu, 30 Nov 2023 07:06:12 -0800
Subject: [R-sig-ME] how to cite github resources'
In-Reply-To: <CA+hwERn8r6B5O+nUU28dYRiY=EnRfVCk0XQoA5AZ23_uHcoUrA@mail.gmail.com>
References: <CA+hwERn8r6B5O+nUU28dYRiY=EnRfVCk0XQoA5AZ23_uHcoUrA@mail.gmail.com>
Message-ID: <BC3403EA-26E7-4E31-8FE2-BD9D3815F09A@dcn.davis.ca.us>

Isn't this driven by the conventions of the publishing context?

On November 30, 2023 2:09:59 AM PST, Toni Hernandez-Matias <ahmatias at gmail.com> wrote:
>Dear all,
>I would like to cite this information:
>https://bbolker.github.io/mixedmodels-misc/glmmFAQ.html#testing-significance-of-random-effects
>
>Do you know which format should I use?
>
>Thanks in advance,
>
>Toni
>
>	[[alternative HTML version deleted]]
>
>_______________________________________________
>R-sig-mixed-models at r-project.org mailing list
>https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models

-- 
Sent from my phone. Please excuse my brevity.


From bbo|ker @end|ng |rom gm@||@com  Fri Dec  1 22:48:09 2023
From: bbo|ker @end|ng |rom gm@||@com (Ben Bolker)
Date: Fri, 1 Dec 2023 16:48:09 -0500
Subject: [R-sig-ME] how to cite github resources'
In-Reply-To: <BC3403EA-26E7-4E31-8FE2-BD9D3815F09A@dcn.davis.ca.us>
References: <CA+hwERn8r6B5O+nUU28dYRiY=EnRfVCk0XQoA5AZ23_uHcoUrA@mail.gmail.com>
 <BC3403EA-26E7-4E31-8FE2-BD9D3815F09A@dcn.davis.ca.us>
Message-ID: <a47a569e-6581-478f-a5f2-06f9c8db80df@gmail.com>

   If you really need a literature citation, you could specify exactly 
which piece of information from the GLMM FAQ you want to reference (the 
section has a lot of stuff in it) and someone might be able to give you 
a book or article reference that supports that information ...

On 2023-11-30 10:06 a.m., Jeff Newmiller via R-sig-mixed-models wrote:
> Isn't this driven by the conventions of the publishing context?
> 
> On November 30, 2023 2:09:59 AM PST, Toni Hernandez-Matias <ahmatias at gmail.com> wrote:
>> Dear all,
>> I would like to cite this information:
>> https://bbolker.github.io/mixedmodels-misc/glmmFAQ.html#testing-significance-of-random-effects
>>
>> Do you know which format should I use?
>>
>> Thanks in advance,
>>
>> Toni
>>
>> 	[[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-mixed-models at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>


From bbo|ker @end|ng |rom gm@||@com  Fri Dec  8 00:34:18 2023
From: bbo|ker @end|ng |rom gm@||@com (Ben Bolker)
Date: Thu, 7 Dec 2023 18:34:18 -0500
Subject: [R-sig-ME] how to cite github resources'
In-Reply-To: <CAFSSRFL_d=0mXEtvA4FA_PqztGt+sGpOECTCGuYOGhzgJ2wYog@mail.gmail.com>
References: <CA+hwERn8r6B5O+nUU28dYRiY=EnRfVCk0XQoA5AZ23_uHcoUrA@mail.gmail.com>
 <BC3403EA-26E7-4E31-8FE2-BD9D3815F09A@dcn.davis.ca.us>
 <a47a569e-6581-478f-a5f2-06f9c8db80df@gmail.com>
 <CAFSSRFL_d=0mXEtvA4FA_PqztGt+sGpOECTCGuYOGhzgJ2wYog@mail.gmail.com>
Message-ID: <55e6eeab-0b26-4f4d-816f-787f29c1f41c@gmail.com>

   [please keep r-sig-mixed at r-project.org in the Cc: list]

On 2023-12-07 4:02 p.m., Antonio HERNANDEZ-MATIAS wrote:
> Many thanks for your message, I just need to justify that :
> With recent versions of |lme4|, goodness-of-fit (deviance) can be 
> compared between |(g)lmer|?and |(g)lm|?models, although |anova()|?must 
> be called with the mixed (|(g)lmer|) model listed first

   Honestly, I don't think this is the kind of statement that needs a 
citation from peer-reviewed literature or a book; instead, it's a 
statement about the behaviour of software.  The archaeology is a little 
bit difficult, but I think the relevant information is from the [lme4 
NEWS file](https://cran.r-project.org/web/packages/lme4/news.html), 
which says for version 1.1-8 (2015-06-22) that:

* deviance() now returns the deviance, rather than half the negative 
log-likelihood, for GLMMs fitted with Laplace (the behaviour for LMMs 
and GLMMs fitted with nAGQ>1 has not changed)

  This is consistent with the GLMM FAQ "git blame", which says that the 
comment about "recent versions of lme4" was added on 2016-12-17 (at 
which time version 1.1-8 would have been "recent")

   Based on more archaeology, this change was made here, originally on 
2014-07-02 (but the change wasn't in the CRAN version until the 1.1-8 
release date mentioned above):

https://github.com/lme4/lme4/commit/5ac6f57f608e425765703b8e83eef7b513b599a6

   As far as the requirement for listing the glmer() model first, that's 
a quirk of the methods dispatch (more ugly detail is available if you 
want it); IIRC listing the glmer() model other than first will throw an 
error, rather than giving an incorrect answer.

   If your supervisor/reviewers/whoever need more than a pointer to the 
GLMM FAQ/a pointer to this e-mail in the list archives/a "pers. comm." 
citation from me, you might be out of luck.

   As long as we've gone this far down the rabbit hole, I'll also 
emphasize the very next sentence in the GLMM FAQ, which points out a 
potential *statistical* issue with such comparisons:

 > Keep in mind that LRT-based null hypothesis tests are conservative 
when the null value (such as ?2=0) is on the boundary of the feasible 
space (Self and Liang 1987; Stram and Lee 1994; Goldman and Whelan 
2000); in the simplest case (single random effect variance), the p-value 
is approximately twice as large as it should be (Pinheiro and Bates 2000).

> 
> El vie, 1 dic 2023 a las 22:48, Ben Bolker (<bbolker at gmail.com 
> <mailto:bbolker at gmail.com>>) escribi?:
> 
>      ? ?If you really need a literature citation, you could specify exactly
>     which piece of information from the GLMM FAQ you want to reference (the
>     section has a lot of stuff in it) and someone might be able to give you
>     a book or article reference that supports that information ...
> 
>     On 2023-11-30 10:06 a.m., Jeff Newmiller via R-sig-mixed-models wrote:
>      > Isn't this driven by the conventions of the publishing context?
>      >
>      > On November 30, 2023 2:09:59 AM PST, Toni Hernandez-Matias
>     <ahmatias at gmail.com <mailto:ahmatias at gmail.com>> wrote:
>      >> Dear all,
>      >> I would like to cite this information:
>      >>
>     https://bbolker.github.io/mixedmodels-misc/glmmFAQ.html#testing-significance-of-random-effects <https://bbolker.github.io/mixedmodels-misc/glmmFAQ.html#testing-significance-of-random-effects>
>      >>
>      >> Do you know which format should I use?
>      >>
>      >> Thanks in advance,
>      >>
>      >> Toni
>      >>
>      >>? ? ? [[alternative HTML version deleted]]
>      >>
>      >> _______________________________________________
>      >> R-sig-mixed-models at r-project.org
>     <mailto:R-sig-mixed-models at r-project.org> mailing list
>      >> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>      >
> 
>     _______________________________________________
>     R-sig-mixed-models at r-project.org
>     <mailto:R-sig-mixed-models at r-project.org> mailing list
>     https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>


From ||on@@@c@r||@4 @end|ng |rom gm@||@com  Tue Dec 12 07:45:25 2023
From: ||on@@@c@r||@4 @end|ng |rom gm@||@com (Fiona Scarff)
Date: Tue, 12 Dec 2023 14:45:25 +0800
Subject: [R-sig-ME] How to supply random intercepts for new data, blme
Message-ID: <CAP=UNak0Lfakpn=z0ARicMcHj-xDi7CwN4L4O-CxerpPo2ACBw@mail.gmail.com>

Hello folks,

I have a mixed model that predicts the presence or absence of a species,
given a set of predictors describing habitat. It is based on tracking data
from tagged individual animals, together with pseudoabsences sampled from
the surrounding area. The model assumes all individuals have the same
habitat preferences (i.e. the slope coefficients are represented as fixed
effects). By specifying random intercepts per individual, the model
accommodates the fact that some individuals were tracked for much longer
than others, so that the number of presences relative to pseudoabsences is
much higher for some individuals.

As part of a cross-validation exercise to assess model accuracy, I would
like to make predictions on new data, involving different individuals from
other geographic areas. As I already know how long these individuals were
tracked for, I would like to supply that information (in the form of fitted
random intercepts from a 'global' model fitted to all individuals) to the
model for that particular cross validation fold. Otherwise, it seems like
the estimate of model accuracy will be unnecessarily pessimistic, since the
predictions for each new individual won't take into account whether they
were extensively tracked or not.

I am using an implementation of binary random forests with mixed effects
due to Speiser and colleagues (see refs below). The random effects part of
the model is produced using blme.

My questions are:
1) Is this a bad idea? It involves taking intercepts from one model and
inserting them into another.
2) If it is a bad idea, is there an alternative?
3) If it is a good idea, how is it best executed using a model derived from
blme? I could find all the parts of the model object containing
individual-specific terms and replace them (so far I've counted eight
vectors in the model object that contain either the individual IDs, or
values fitted to those IDs) , but is there a more elegant solution?

A different approach could be to draw pseudoabsences for each individual
equal to the number of presences recorded for that animal. That would mean
that the ratio of presences to absences was fixed at 0.5 for all
individuals. I avoided this in the first instance, because it would mean
fitting models with few points for some individuals - as few as 5 or 10
presences so n= presences + absence = 10?20.

Many thanks for any help you can offer, Fiona

References
Speiser, J. L., et al. (2019). "BiMM forest: A random forest method for
modeling clustered and longitudinal binary outcomes." Chemometrics and
Intelligent Laboratory Systems *185*: 122-134)

Speiser, J. L. (2021). "A random forest method with feature selection for
developing medical prediction models with clustered and longitudinal
data." Journal
of Biomedical Informatics *117*: 103763.


*Fiona Scarff*
*Murdoch University*

	[[alternative HTML version deleted]]


From ||on@@@c@r||@4 @end|ng |rom gm@||@com  Thu Dec 14 05:20:22 2023
From: ||on@@@c@r||@4 @end|ng |rom gm@||@com (Fiona Scarff)
Date: Thu, 14 Dec 2023 12:20:22 +0800
Subject: [R-sig-ME] How to supply random intercepts for new data, blme
In-Reply-To: <CAP=UNak0Lfakpn=z0ARicMcHj-xDi7CwN4L4O-CxerpPo2ACBw@mail.gmail.com>
References: <CAP=UNak0Lfakpn=z0ARicMcHj-xDi7CwN4L4O-CxerpPo2ACBw@mail.gmail.com>
Message-ID: <CAP=UNanpAd5+RBLex+UyejJ+YO0=PnCoi6Jz-86t9GAJdQqz+Q@mail.gmail.com>

...Thinking some more about this, it occurs to me that one solution would
be to add a predictor consisting of the number of records obtained for each
individual, fitting this as a fixed effect. This seems better than trying
to model a random effect of individual ID, without providing that
information. (It is also more convenient, as the distribution of those
records is not remotely Gaussian in my case). More generally though, I
would be interested to know whether it is possible, and good practice, to
supply random effects to a model that have been determined by some external
process, such as another model or based on a priori expectations.

Best,
Fiona

*Dr Fiona Scarff*
*Murdoch University*


On Tue, Dec 12, 2023 at 2:45?PM Fiona Scarff <fiona.scarff.4 at gmail.com>
wrote:

> Hello folks,
>
> I have a mixed model that predicts the presence or absence of a species,
> given a set of predictors describing habitat. It is based on tracking data
> from tagged individual animals, together with pseudoabsences sampled from
> the surrounding area. The model assumes all individuals have the same
> habitat preferences (i.e. the slope coefficients are represented as fixed
> effects). By specifying random intercepts per individual, the model
> accommodates the fact that some individuals were tracked for much longer
> than others, so that the number of presences relative to pseudoabsences is
> much higher for some individuals.
>
> As part of a cross-validation exercise to assess model accuracy, I would
> like to make predictions on new data, involving different individuals from
> other geographic areas. As I already know how long these individuals were
> tracked for, I would like to supply that information (in the form of fitted
> random intercepts from a 'global' model fitted to all individuals) to the
> model for that particular cross validation fold. Otherwise, it seems like
> the estimate of model accuracy will be unnecessarily pessimistic, since the
> predictions for each new individual won't take into account whether they
> were extensively tracked or not.
>
> I am using an implementation of binary random forests with mixed effects
> due to Speiser and colleagues (see refs below). The random effects part of
> the model is produced using blme.
>
> My questions are:
> 1) Is this a bad idea? It involves taking intercepts from one model and
> inserting them into another.
> 2) If it is a bad idea, is there an alternative?
> 3) If it is a good idea, how is it best executed using a model derived
> from blme? I could find all the parts of the model object containing
> individual-specific terms and replace them (so far I've counted eight
> vectors in the model object that contain either the individual IDs, or
> values fitted to those IDs) , but is there a more elegant solution?
>
> A different approach could be to draw pseudoabsences for each individual
> equal to the number of presences recorded for that animal. That would mean
> that the ratio of presences to absences was fixed at 0.5 for all
> individuals. I avoided this in the first instance, because it would mean
> fitting models with few points for some individuals - as few as 5 or 10
> presences so n= presences + absence = 10?20.
>
> Many thanks for any help you can offer, Fiona
>
> References
> Speiser, J. L., et al. (2019). "BiMM forest: A random forest method for
> modeling clustered and longitudinal binary outcomes." Chemometrics and
> Intelligent Laboratory Systems *185*: 122-134)
>
> Speiser, J. L. (2021). "A random forest method with feature selection for
> developing medical prediction models with clustered and longitudinal data." Journal
> of Biomedical Informatics *117*: 103763.
>
>
> *Fiona Scarff*
> *Murdoch University*
>
>

	[[alternative HTML version deleted]]


From @|m@h@rme| @end|ng |rom gm@||@com  Sun Dec 17 04:30:32 2023
From: @|m@h@rme| @end|ng |rom gm@||@com (Simon Harmel)
Date: Sat, 16 Dec 2023 21:30:32 -0600
Subject: [R-sig-ME] Implications of modeling residuals in multilevel models
Message-ID: <CACgv6yV1_fXFD8LfEP+U+Jvz2=_G7ZpGQ=StH86JvqOdxqRZ0A@mail.gmail.com>

Hello All,

I have a highly skewed dataset. But, my MODEL of choice below shows
drastically improved, normally distributed residuals (and predicted values)
compared to other models whose residuals are not modeled.

Three quick questions:

1- Is MODEL below assuming that my data come from a population that looks
normal once "X1_categorical" and "X2_numeric" are taken into account
as modeled in MODEL?

2- Do these normally distributed predictions work better for a subject
randomly drawn from a similarly skewed population with a
known "X1_categorical" and "X2_numeric"?

3- I think the distribution of residuals mirrors that of the data. If so,
is it correct to say MODEL below is actually **trimming** my highly skewed
data as if it was distributed as:
```
hist(resid(MODEL, type = "normalized"))
```

 MODEL <- nlme::lme(y ~ X1_categorical + X2_numeric ...,
         random = ~1| subject,
         data = data,
         correlation = corSymm(~1|subject),
         weights = varComb(varIdent(form = ~ 1 |  X1_categorical ),
                                          varPower(form = ~  X2_numeric )))

Thanks,
Simon

	[[alternative HTML version deleted]]


From @|m@h@rme| @end|ng |rom gm@||@com  Fri Dec 22 19:10:50 2023
From: @|m@h@rme| @end|ng |rom gm@||@com (Simon Harmel)
Date: Fri, 22 Dec 2023 12:10:50 -0600
Subject: [R-sig-ME] 
 Implications of modeling residuals in multilevel models
In-Reply-To: <CACgv6yV1_fXFD8LfEP+U+Jvz2=_G7ZpGQ=StH86JvqOdxqRZ0A@mail.gmail.com>
References: <CACgv6yV1_fXFD8LfEP+U+Jvz2=_G7ZpGQ=StH86JvqOdxqRZ0A@mail.gmail.com>
Message-ID: <CACgv6yU3o-BP+GNeTX4j+Gz-4P7J68Axshkb+4b+18Jh9mRQNg@mail.gmail.com>

Hello All,

Just a follow-up, can we say the model I sketched above is a location-scale
model?

Thanks,
Simon

On Sat, Dec 16, 2023 at 9:30?PM Simon Harmel <sim.harmel at gmail.com> wrote:

> Hello All,
>
> I have a highly skewed dataset. But, my MODEL of choice below shows
> drastically improved, normally distributed residuals (and predicted values)
> compared to other models whose residuals are not modeled.
>
> Three quick questions:
>
> 1- Is MODEL below assuming that my data come from a population that looks
> normal once "X1_categorical" and "X2_numeric" are taken into account
> as modeled in MODEL?
>
> 2- Do these normally distributed predictions work better for a subject
> randomly drawn from a similarly skewed population with a
> known "X1_categorical" and "X2_numeric"?
>
> 3- I think the distribution of residuals mirrors that of the data. If so,
> is it correct to say MODEL below is actually **trimming** my highly skewed
> data as if it was distributed as:
> ```
> hist(resid(MODEL, type = "normalized"))
> ```
>
>  MODEL <- nlme::lme(y ~ X1_categorical + X2_numeric ...,
>          random = ~1| subject,
>          data = data,
>          correlation = corSymm(~1|subject),
>          weights = varComb(varIdent(form = ~ 1 |  X1_categorical ),
>                                           varPower(form = ~  X2_numeric )))
>
> Thanks,
> Simon
>

	[[alternative HTML version deleted]]


From bbo|ker @end|ng |rom gm@||@com  Fri Dec 22 19:30:01 2023
From: bbo|ker @end|ng |rom gm@||@com (Ben Bolker)
Date: Fri, 22 Dec 2023 13:30:01 -0500
Subject: [R-sig-ME] 
 Implications of modeling residuals in multilevel models
In-Reply-To: <CACgv6yU3o-BP+GNeTX4j+Gz-4P7J68Axshkb+4b+18Jh9mRQNg@mail.gmail.com>
References: <CACgv6yV1_fXFD8LfEP+U+Jvz2=_G7ZpGQ=StH86JvqOdxqRZ0A@mail.gmail.com>
 <CACgv6yU3o-BP+GNeTX4j+Gz-4P7J68Axshkb+4b+18Jh9mRQNg@mail.gmail.com>
Message-ID: <4c12b847-328a-459c-9bd3-08b8099b072d@gmail.com>

   This slipped through the cracks.

On 2023-12-22 1:10 p.m., Simon Harmel wrote:
> Hello All,
> 
> Just a follow-up, can we say the model I sketched above is a location-scale
> model?
> 
> Thanks,
> Simon
> 
> On Sat, Dec 16, 2023 at 9:30?PM Simon Harmel <sim.harmel at gmail.com> wrote:
> 
>> Hello All,
>>
>> I have a highly skewed dataset.

   As may have been said before, the *marginal* distribution of your 
data set (e.g., what you get if you plot hist(y)) is irrelevant/doesn't 
matter at all (the models make no assumptions about the marginal 
distribution)

  But, my MODEL of choice below shows
>> drastically improved, normally distributed residuals (and predicted values)
>> compared to other models whose residuals are not modeled.
>>
>> Three quick questions:
>>
>> 1- Is MODEL below assuming that my data come from a population that looks
>> normal once "X1_categorical" and "X2_numeric" are taken into account
>> as modeled in MODEL?

   Yes, the *conditional distribution* of y is Gaussian (but not IID 
because you have specified correlation and variance (weights) structures).


>> 2- Do these normally distributed predictions work better for a subject
>> randomly drawn from a similarly skewed population with a
>> known "X1_categorical" and "X2_numeric"?

   Don't think I understand what this means.

>> 3- I think the distribution of residuals mirrors that of the data. If so,
>> is it correct to say MODEL below is actually **trimming** my highly skewed
>> data as if it was distributed as:

   That seems an odd way to put it.  I would say that, if the residuals 
look Normally distributed, that means that the covariates in the model 
are accounting for the skew.

Here's an example of a dataset where the marginal distribution is 
heavily skewed but the conditional distribution is (exactly) Normal:

set.seed(101)
x <- rgamma(1000, shape = 1)
y <- rnorm(1000, mean = x, sd = 0.1)
hist(y)

qqnorm(residuals(lm(y~x)))

   Heteroscedasticity (but not autocorrelation) will also change the 
distribution of the residuals, but I don't think it's necessary to 
illustrate the point here.

   I think it would be fair to call this a location-scale model since 
you are modeling both the location (mean) and the scale (SD/variance), 
although often people use the term for models where there is a random 
effect in both the location and the scale model.





>> ```
>> hist(resid(MODEL, type = "normalized"))
>> ```
>>
>>   MODEL <- nlme::lme(y ~ X1_categorical + X2_numeric ...,
>>           random = ~1| subject,
>>           data = data,
>>           correlation = corSymm(~1|subject),
>>           weights = varComb(varIdent(form = ~ 1 |  X1_categorical ),
>>                                            varPower(form = ~  X2_numeric )))
>>
>> Thanks,
>> Simon
>>
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models

-- 
Dr. Benjamin Bolker
Professor, Mathematics & Statistics and Biology, McMaster University
Director, School of Computational Science and Engineering
(Acting) Graduate chair, Mathematics & Statistics
 > E-mail is sent at my convenience; I don't expect replies outside of 
working hours.


From c|@|rec@ @end|ng |rom u@c@edu  Fri Dec 22 21:00:35 2023
From: c|@|rec@ @end|ng |rom u@c@edu (Claire Campbell)
Date: Fri, 22 Dec 2023 12:00:35 -0800
Subject: [R-sig-ME] Unstructured Covariance Structure for lmer()
Message-ID: <76EAB835-EC72-4AB0-A0E5-435F48B46508@usc.edu>

Hi -
I was wondering how to implement an unstructured covariance structure in lmer(), is there code for that?
Thank you!


--

Claire Campbell
Neuroscience PhD Candidate
F31 NRSA Predoctoral Fellow
Herting Neuroimaging Lab

USC Keck School of Medicine
Department of Population and Public Health Sciences
Los Angeles, CA, USA


	[[alternative HTML version deleted]]


From bbo|ker @end|ng |rom gm@||@com  Fri Dec 22 21:42:07 2023
From: bbo|ker @end|ng |rom gm@||@com (Ben Bolker)
Date: Fri, 22 Dec 2023 15:42:07 -0500
Subject: [R-sig-ME] Unstructured Covariance Structure for lmer()
In-Reply-To: <76EAB835-EC72-4AB0-A0E5-435F48B46508@usc.edu>
References: <76EAB835-EC72-4AB0-A0E5-435F48B46508@usc.edu>
Message-ID: <86ea46f9-3d23-41ae-b9c8-ddecc8440cba@gmail.com>

    "Unstructured" (aka 'general positive (semi)definite') covariance 
matrices are the *only* option in lme4.  If you give a little bit more 
detail/context about what you want to do, we may be able to help you better.

On 2023-12-22 3:00 p.m., Claire Campbell wrote:
> Hi -
> I was wondering how to implement an unstructured covariance structure in lmer(), is there code for that?
> Thank you!
> 
> 
> --
> 
> Claire Campbell
> Neuroscience PhD Candidate
> F31 NRSA Predoctoral Fellow
> Herting Neuroimaging Lab
> 
> USC Keck School of Medicine
> Department of Population and Public Health Sciences
> Los Angeles, CA, USA
> 
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models


From @|m@h@rme| @end|ng |rom gm@||@com  Fri Dec 22 22:50:20 2023
From: @|m@h@rme| @end|ng |rom gm@||@com (Simon Harmel)
Date: Fri, 22 Dec 2023 15:50:20 -0600
Subject: [R-sig-ME] 
 Implications of modeling residuals in multilevel models
In-Reply-To: <4c12b847-328a-459c-9bd3-08b8099b072d@gmail.com>
References: <CACgv6yV1_fXFD8LfEP+U+Jvz2=_G7ZpGQ=StH86JvqOdxqRZ0A@mail.gmail.com>
 <CACgv6yU3o-BP+GNeTX4j+Gz-4P7J68Axshkb+4b+18Jh9mRQNg@mail.gmail.com>
 <4c12b847-328a-459c-9bd3-08b8099b072d@gmail.com>
Message-ID: <CACgv6yU-pMdE-rLkNKx4muJ_h7XYBLvERrnUDe-n8=dLNBDkhQ@mail.gmail.com>

Dear Ben,

These are exactly what I was looking for! Thank you so much. Please allow
me to clarify my 2nd question.

When I compare predict(MODEL) with predict(model_with_no_resid_modeled),
the former looks quite normal and unimodal in shape but the latter looks
multi-model (see the illustration below).

This made me think: should a good-fitting model produce normally
distributed predicted values? And does such a model do a better job of
predicting the value of random draw from the y population?
               *
            * * *
       * * * * * * *
   * * * * * * * * * *
* * * * * * * * * * * *
-------------------------  vs:
                        *
                      * *
      *             * * *
   * *   * *     * * * *
* * * * * * * * * * * *
-------------------------

On Fri, Dec 22, 2023 at 12:30?PM Ben Bolker <bbolker at gmail.com> wrote:

>    This slipped through the cracks.
>
> On 2023-12-22 1:10 p.m., Simon Harmel wrote:
> > Hello All,
> >
> > Just a follow-up, can we say the model I sketched above is a
> location-scale
> > model?
> >
> > Thanks,
> > Simon
> >
> > On Sat, Dec 16, 2023 at 9:30?PM Simon Harmel <sim.harmel at gmail.com>
> wrote:
> >
> >> Hello All,
> >>
> >> I have a highly skewed dataset.
>
>    As may have been said before, the *marginal* distribution of your
> data set (e.g., what you get if you plot hist(y)) is irrelevant/doesn't
> matter at all (the models make no assumptions about the marginal
> distribution)
>
>   But, my MODEL of choice below shows
> >> drastically improved, normally distributed residuals (and predicted
> values)
> >> compared to other models whose residuals are not modeled.
> >>
> >> Three quick questions:
> >>
> >> 1- Is MODEL below assuming that my data come from a population that
> looks
> >> normal once "X1_categorical" and "X2_numeric" are taken into account
> >> as modeled in MODEL?
>
>    Yes, the *conditional distribution* of y is Gaussian (but not IID
> because you have specified correlation and variance (weights) structures).
>
>
> >> 2- Do these normally distributed predictions work better for a subject
> >> randomly drawn from a similarly skewed population with a
> >> known "X1_categorical" and "X2_numeric"?
>
>    Don't think I understand what this means.
>
> >> 3- I think the distribution of residuals mirrors that of the data. If
> so,
> >> is it correct to say MODEL below is actually **trimming** my highly
> skewed
> >> data as if it was distributed as:
>
>    That seems an odd way to put it.  I would say that, if the residuals
> look Normally distributed, that means that the covariates in the model
> are accounting for the skew.
>
> Here's an example of a dataset where the marginal distribution is
> heavily skewed but the conditional distribution is (exactly) Normal:
>
> set.seed(101)
> x <- rgamma(1000, shape = 1)
> y <- rnorm(1000, mean = x, sd = 0.1)
> hist(y)
>
> qqnorm(residuals(lm(y~x)))
>
>    Heteroscedasticity (but not autocorrelation) will also change the
> distribution of the residuals, but I don't think it's necessary to
> illustrate the point here.
>
>    I think it would be fair to call this a location-scale model since
> you are modeling both the location (mean) and the scale (SD/variance),
> although often people use the term for models where there is a random
> effect in both the location and the scale model.
>
>
>
>
>
> >> ```
> >> hist(resid(MODEL, type = "normalized"))
> >> ```
> >>
> >>   MODEL <- nlme::lme(y ~ X1_categorical + X2_numeric ...,
> >>           random = ~1| subject,
> >>           data = data,
> >>           correlation = corSymm(~1|subject),
> >>           weights = varComb(varIdent(form = ~ 1 |  X1_categorical ),
> >>                                            varPower(form = ~
> X2_numeric )))
> >>
> >> Thanks,
> >> Simon
> >>
> >
> >       [[alternative HTML version deleted]]
> >
> > _______________________________________________
> > R-sig-mixed-models at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>
> --
> Dr. Benjamin Bolker
> Professor, Mathematics & Statistics and Biology, McMaster University
> Director, School of Computational Science and Engineering
> (Acting) Graduate chair, Mathematics & Statistics
>  > E-mail is sent at my convenience; I don't expect replies outside of
> working hours.
>
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>

	[[alternative HTML version deleted]]


From bbo|ker @end|ng |rom gm@||@com  Fri Dec 22 23:07:13 2023
From: bbo|ker @end|ng |rom gm@||@com (Ben Bolker)
Date: Fri, 22 Dec 2023 17:07:13 -0500
Subject: [R-sig-ME] 
 Implications of modeling residuals in multilevel models
In-Reply-To: <CACgv6yU-pMdE-rLkNKx4muJ_h7XYBLvERrnUDe-n8=dLNBDkhQ@mail.gmail.com>
References: <CACgv6yV1_fXFD8LfEP+U+Jvz2=_G7ZpGQ=StH86JvqOdxqRZ0A@mail.gmail.com>
 <CACgv6yU3o-BP+GNeTX4j+Gz-4P7J68Axshkb+4b+18Jh9mRQNg@mail.gmail.com>
 <4c12b847-328a-459c-9bd3-08b8099b072d@gmail.com>
 <CACgv6yU-pMdE-rLkNKx4muJ_h7XYBLvERrnUDe-n8=dLNBDkhQ@mail.gmail.com>
Message-ID: <099e162e-0a4b-42ab-aac0-4fd307a24503@gmail.com>



On 2023-12-22 4:50 p.m., Simon Harmel wrote:
> Dear?Ben,
> 
> These are exactly what I was?looking for! Thank you so much. Please 
> allow me to clarify my 2nd?question.
> 
> When I compare predict(MODEL) with predict(model_with_no_resid_modeled), 
> the former looks quite normal and unimodal in shape but the latter looks 
> multi-model (see the illustration below).
> 
> This made me think: should a good-fitting model produce normally 
> distributed predicted values? And does such a model do a better?job of 
> predicting?the value?of random draw?from the y population?

     Ideally the *marginal* (overall) distribution of *predictions* 
should match the marginal distribution of the response variable (this is 
what the 'posterior predictive check' panel of 
performance::check_model() does).  If the marginal distribution of your 
data is skewed, then the marginal distribution of your prediction should 
be skewed in the same way -- if it's not, then it's not doing a good job 
describing the data.

m <- lm(mpg ~ cyl + disp, mtcars)
performance::check_model(m, check = "pp_check")

   This is a different story from the *residuals* (which tell you 
something about the conditional distribution, not the marginal 
distribution ...)


>  ? ? ? ? ? ? ? ?*
>  ? ? ? ? ? ? * * *
>  ? ? ? ?* * * * * * *
>  ? ?* * * * * * * * * *
> * * * * * * * * * * * *
> -------------------------? vs:
>  ? ? ? ? ? ? ? ? ? ? ? ? *
>  ? ? ? ? ? ? ? ? ? ? ? * *
>  ? ? ? *? ? ? ? ? ? ?* * *
>  ? ?* *? ?* *? ? ?* * * *
> * * * * * * * * * * * *
> -------------------------
> 
> On Fri, Dec 22, 2023 at 12:30?PM Ben Bolker <bbolker at gmail.com 
> <mailto:bbolker at gmail.com>> wrote:
> 
>      ? ?This slipped through the cracks.
> 
>     On 2023-12-22 1:10 p.m., Simon Harmel wrote:
>      > Hello All,
>      >
>      > Just a follow-up, can we say the model I sketched above is a
>     location-scale
>      > model?
>      >
>      > Thanks,
>      > Simon
>      >
>      > On Sat, Dec 16, 2023 at 9:30?PM Simon Harmel
>     <sim.harmel at gmail.com <mailto:sim.harmel at gmail.com>> wrote:
>      >
>      >> Hello All,
>      >>
>      >> I have a highly skewed dataset.
> 
>      ? ?As may have been said before, the *marginal* distribution of your
>     data set (e.g., what you get if you plot hist(y)) is irrelevant/doesn't
>     matter at all (the models make no assumptions about the marginal
>     distribution)
> 
>      ? But, my MODEL of choice below shows
>      >> drastically improved, normally distributed residuals (and
>     predicted values)
>      >> compared to other models whose residuals are not modeled.
>      >>
>      >> Three quick questions:
>      >>
>      >> 1- Is MODEL below assuming that my data come from a population
>     that looks
>      >> normal once "X1_categorical" and "X2_numeric" are taken into account
>      >> as modeled in MODEL?
> 
>      ? ?Yes, the *conditional distribution* of y is Gaussian (but not IID
>     because you have specified correlation and variance (weights)
>     structures).
> 
> 
>      >> 2- Do these normally distributed predictions work better for a
>     subject
>      >> randomly drawn from a similarly skewed population with a
>      >> known "X1_categorical" and "X2_numeric"?
> 
>      ? ?Don't think I understand what this means.
> 
>      >> 3- I think the distribution of residuals mirrors that of the
>     data. If so,
>      >> is it correct to say MODEL below is actually **trimming** my
>     highly skewed
>      >> data as if it was distributed as:
> 
>      ? ?That seems an odd way to put it.? I would say that, if the
>     residuals
>     look Normally distributed, that means that the covariates in the model
>     are accounting for the skew.
> 
>     Here's an example of a dataset where the marginal distribution is
>     heavily skewed but the conditional distribution is (exactly) Normal:
> 
>     set.seed(101)
>     x <- rgamma(1000, shape = 1)
>     y <- rnorm(1000, mean = x, sd = 0.1)
>     hist(y)
> 
>     qqnorm(residuals(lm(y~x)))
> 
>      ? ?Heteroscedasticity (but not autocorrelation) will also change the
>     distribution of the residuals, but I don't think it's necessary to
>     illustrate the point here.
> 
>      ? ?I think it would be fair to call this a location-scale model since
>     you are modeling both the location (mean) and the scale (SD/variance),
>     although often people use the term for models where there is a random
>     effect in both the location and the scale model.
> 
> 
> 
> 
> 
>      >> ```
>      >> hist(resid(MODEL, type = "normalized"))
>      >> ```
>      >>
>      >>? ?MODEL <- nlme::lme(y ~ X1_categorical + X2_numeric ...,
>      >>? ? ? ? ? ?random = ~1| subject,
>      >>? ? ? ? ? ?data = data,
>      >>? ? ? ? ? ?correlation = corSymm(~1|subject),
>      >>? ? ? ? ? ?weights = varComb(varIdent(form = ~ 1 |? X1_categorical ),
>      >>? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? varPower(form = ~ 
>     X2_numeric )))
>      >>
>      >> Thanks,
>      >> Simon
>      >>
>      >
>      >? ? ? ?[[alternative HTML version deleted]]
>      >
>      > _______________________________________________
>      > R-sig-mixed-models at r-project.org
>     <mailto:R-sig-mixed-models at r-project.org> mailing list
>      > https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
> 
>     -- 
>     Dr. Benjamin Bolker
>     Professor, Mathematics & Statistics and Biology, McMaster University
>     Director, School of Computational Science and Engineering
>     (Acting) Graduate chair, Mathematics & Statistics
>      ?> E-mail is sent at my convenience; I don't expect replies outside of
>     working hours.
> 
>     _______________________________________________
>     R-sig-mixed-models at r-project.org
>     <mailto:R-sig-mixed-models at r-project.org> mailing list
>     https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
> 

-- 
Dr. Benjamin Bolker
Professor, Mathematics & Statistics and Biology, McMaster University
Director, School of Computational Science and Engineering
(Acting) Graduate chair, Mathematics & Statistics
 > E-mail is sent at my convenience; I don't expect replies outside of 
working hours.


From @|m@h@rme| @end|ng |rom gm@||@com  Mon Dec 25 05:55:47 2023
From: @|m@h@rme| @end|ng |rom gm@||@com (Simon Harmel)
Date: Sun, 24 Dec 2023 22:55:47 -0600
Subject: [R-sig-ME] 
 Implications of modeling residuals in multilevel models
In-Reply-To: <4c12b847-328a-459c-9bd3-08b8099b072d@gmail.com>
References: <CACgv6yV1_fXFD8LfEP+U+Jvz2=_G7ZpGQ=StH86JvqOdxqRZ0A@mail.gmail.com>
 <CACgv6yU3o-BP+GNeTX4j+Gz-4P7J68Axshkb+4b+18Jh9mRQNg@mail.gmail.com>
 <4c12b847-328a-459c-9bd3-08b8099b072d@gmail.com>
Message-ID: <CACgv6yWYg-TX8bLj7R_0qbayJ_11LTxqzBXMKSaKu_QJSsRhMA@mail.gmail.com>

Dear Ben,

A question regarding your response is inline below.

### I think it would be fair to call this a location-scale model since
you are modeling both the location (mean) and the scale (SD/variance),
although often people use the term for models where there is a random
effect in both the location and the scale model.

Q: Usually for the scale part of a location-scale model, the linear model
uses a logarithmic link to guarantee that the estimate of scale is positive:

log(scale_i) = a_0 + b_1*x_i1+ ... + b_n*x_ip  (for p predictors of scale)

But in the MODEL that I sketched below, how such a guarantee is made?

MODEL <- nlme::lme(y ~ X1_categorical + X2_numeric ...,
         random = ~1| subject,
         data = data,
         correlation = corSymm(~1|subject),
         weights = varComb(varIdent(form = ~ 1 |  X1_categorical ),
                                          varPower(form = ~  X2_numeric )))

Thanks, Simon

On Fri, Dec 22, 2023 at 12:30?PM Ben Bolker <bbolker at gmail.com> wrote:

>    This slipped through the cracks.
>
> On 2023-12-22 1:10 p.m., Simon Harmel wrote:
> > Hello All,
> >
> > Just a follow-up, can we say the model I sketched above is a
> location-scale
> > model?
> >
> > Thanks,
> > Simon
> >
> > On Sat, Dec 16, 2023 at 9:30?PM Simon Harmel <sim.harmel at gmail.com>
> wrote:
> >
> >> Hello All,
> >>
> >> I have a highly skewed dataset.
>
>    As may have been said before, the *marginal* distribution of your
> data set (e.g., what you get if you plot hist(y)) is irrelevant/doesn't
> matter at all (the models make no assumptions about the marginal
> distribution)
>
>   But, my MODEL of choice below shows
> >> drastically improved, normally distributed residuals (and predicted
> values)
> >> compared to other models whose residuals are not modeled.
> >>
> >> Three quick questions:
> >>
> >> 1- Is MODEL below assuming that my data come from a population that
> looks
> >> normal once "X1_categorical" and "X2_numeric" are taken into account
> >> as modeled in MODEL?
>
>    Yes, the *conditional distribution* of y is Gaussian (but not IID
> because you have specified correlation and variance (weights) structures).
>
>
> >> 2- Do these normally distributed predictions work better for a subject
> >> randomly drawn from a similarly skewed population with a
> >> known "X1_categorical" and "X2_numeric"?
>
>    Don't think I understand what this means.
>
> >> 3- I think the distribution of residuals mirrors that of the data. If
> so,
> >> is it correct to say MODEL below is actually **trimming** my highly
> skewed
> >> data as if it was distributed as:
>
>    That seems an odd way to put it.  I would say that, if the residuals
> look Normally distributed, that means that the covariates in the model
> are accounting for the skew.
>
> Here's an example of a dataset where the marginal distribution is
> heavily skewed but the conditional distribution is (exactly) Normal:
>
> set.seed(101)
> x <- rgamma(1000, shape = 1)
> y <- rnorm(1000, mean = x, sd = 0.1)
> hist(y)
>
> qqnorm(residuals(lm(y~x)))
>
>    Heteroscedasticity (but not autocorrelation) will also change the
> distribution of the residuals, but I don't think it's necessary to
> illustrate the point here.
>
>    I think it would be fair to call this a location-scale model since
> you are modeling both the location (mean) and the scale (SD/variance),
> although often people use the term for models where there is a random
> effect in both the location and the scale model.
>
>
>
>
>
> >> ```
> >> hist(resid(MODEL, type = "normalized"))
> >> ```
> >>
> >>   MODEL <- nlme::lme(y ~ X1_categorical + X2_numeric ...,
> >>           random = ~1| subject,
> >>           data = data,
> >>           correlation = corSymm(~1|subject),
> >>           weights = varComb(varIdent(form = ~ 1 |  X1_categorical ),
> >>                                            varPower(form = ~
> X2_numeric )))
> >>
> >> Thanks,
> >> Simon
> >>
> >
> >       [[alternative HTML version deleted]]
> >
> > _______________________________________________
> > R-sig-mixed-models at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>
> --
> Dr. Benjamin Bolker
> Professor, Mathematics & Statistics and Biology, McMaster University
> Director, School of Computational Science and Engineering
> (Acting) Graduate chair, Mathematics & Statistics
>  > E-mail is sent at my convenience; I don't expect replies outside of
> working hours.
>
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>

	[[alternative HTML version deleted]]


