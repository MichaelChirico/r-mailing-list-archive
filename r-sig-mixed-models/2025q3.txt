From @o|ed@d@e@teb@n @end|ng |rom tr@n@m|tt|ng@c|ence@com  Wed Jul  9 17:51:19 2025
From: @o|ed@d@e@teb@n @end|ng |rom tr@n@m|tt|ng@c|ence@com (Soledad De Esteban-Trivigno)
Date: Wed, 09 Jul 2025 15:51:19 +0000
Subject: [R-sig-ME] Online course: Generalised Additive Mixed Models (GAMM):
 modelling space-time correlation structures, July 2025
In-Reply-To: <98f4bea9f4cd7d713d081f219fe9a016@transmittingscience.com>
References: <98f4bea9f4cd7d713d081f219fe9a016@transmittingscience.com>
Message-ID: <a27c00b280d09c35831440defc2def8a@transmittingscience.com>

Dear colleagues,

There are 2 slots available for Transmitting science's course 
"Generalised Additive Mixed Models (GAMM): modelling space-time 
correlation structures".

Dates and schedule: July 21st, 23rd, and 25th, 2025. From 09:30 to 13:30 
(Madrid time zone).

Course webpage: 
https://www.transmittingscience.com/courses/statistics-and-bioinformatics/generalised-additive-mixed-models-modelling-space-time-correlation-structures/

Programme:

Module I. Spatial and Temporal Autocorrelation

  	* Definition of spatial and temporal autocorrelation
  	* Tools for detection of spatial and temporal autocorrelation
  	* GAM Models
  	* Theory of Additive Models (AM) and Generalized Additive Models (GAM)
  	* Simple GAM Model
  	* Fitting and Validation of a simple GAM model (bivariate)
  	* Multiple GAM Models (multivariable)
  	* Fitting and Validation of a multiple GAM model
  	* Multiple GAM for count data with an offset

Module II. Mixed Models and GAMMs

  	* Introduction to Mixed Effects Models
  	* Fitting GAM Model and Independence Validation
  	* Fitting and validation of GAMM 1 Model
  	* GAMM with temporal autocorrelation structure
  	* Fitting and validation of GAMM 2 Model
  	* GAMM with space-temporal structure
  	* Resolution of specific work doubts

If you have further inquiries, do not hesitate to contact me or write to 
courses at transmittingscience.com

With best regards

Sole

-- 
Soledad De Esteban-Trivigno, PhD
Director
Transmitting Science
www.transmittingscience.com/courses

Bluesky @soledeesteban.bsky.social
X @SoleDeEsteban
Orcid: https://orcid.org/0000-0002-2049-0890
	[[alternative HTML version deleted]]


From i@io m@iii@g oii phys@ii@-courses@org  Thu Jul 10 17:29:09 2025
From: i@io m@iii@g oii phys@ii@-courses@org (i@io m@iii@g oii phys@ii@-courses@org)
Date: Thu, 10 Jul 2025 17:29:09 +0200 (CEST)
Subject: [R-sig-ME] =?utf-8?q?Course=3A_Species_Distribution_Modeling_wit?=
 =?utf-8?q?h_Bayesian_Additive_Regression_Tree_=28BART=29_Methods?=
In-Reply-To: <1752077210.332121248@webmail.jimdo.com>
References: <1752077210.332121248@webmail.jimdo.com>
Message-ID: <1752161349.878112254@webmail.jimdo.com>


Dear colleagues,

Registration is open for our upcoming online course: Species Distribution Modeling with Bayesian Additive Regression Tree (BART) Methods
 
Dates: 22-24 September
 
Course website: [ https://www.physalia-courses.org/courses-workshops/barts/ ]( https://www.physalia-courses.org/courses-workshops/barts/ )
 
This course will introduce BART methods for species distribution modeling (SDM) and other ecological applications. Participants will learn how BART improves over traditional SDM approaches and gain hands-on experience using the embarcadero and dbarts R packages to select predictors, train models, and project species distributions.
 
For the full list of our courses and workshops, please visit:  [ https://www.physalia-courses.org/courses-workshops/ ]( https://www.physalia-courses.org/courses-workshops/barts/ )
 
Best regards,
Carlo
 
 
--------------------

Carlo Pecoraro, Ph.D


Physalia-courses DIRECTOR

info at physalia-courses.org

mobile: +49 17645230846

[ Bluesky ]( https://bsky.app/profile/physaliacourses.bsky.social ) [ Linkedin ]( https://www.linkedin.com/in/physalia-courses-a64418127/ )





 
	[[alternative HTML version deleted]]


From mew0099 @end|ng |rom @uburn@edu  Fri Jul 18 18:33:37 2025
From: mew0099 @end|ng |rom @uburn@edu (Matthew Wolak)
Date: Fri, 18 Jul 2025 11:33:37 -0500
Subject: [R-sig-ME] MCMCglmm: possible to estimate a covariance with mm()
 multiple membership structure
Message-ID: <31310b6f-52f9-4003-bbef-040c8b911fc3@auburn.edu>

Dear List,

I am using MCMCglmm for a quantitative genetic analysis of reproductive 
success data where 1 focal individual competed in an assay against 3 
same-sex competitors. We have pedigree information for every individual 
and so I would like to estimate the direct genetic effects (DGE) 
variance among focal individuals, indirect genetic effects (IGE) 
variance among competitors, and the DGE-IGE covariance.

My main question is whether it is possible to estimate the DGE-IGE 
covariance in MCMCglmm? I know this is possible when there is a single 
term making up the IGE effects, as in a DGE-maternal genetic covariance 
by including these terms in the `str()` function (for example, as 
described in another post: 
https://stat.ethz.ch/pipermail/r-sig-mixed-models/2017q4/026271.html).

However, since I have 3 competitors I am using the multiple membership 
function `mm()` and it seems MCMCglmm does not allow combining `str()` 
and `mm()`. The code for specifying my random effects terms _without_ a 
covariance is:

```
# below `id` is the focal individual and `irr_comp_X` is each of the 3
competitors of the focal

 ?? random = ~ id + mm(irr_comp_1 + irr_comp_2 + irr_comp_3),
 ?? ginverse = list(id = AinvM,
 ???? irr_comp_1 = AinvM, irr_comp_2 = AinvM, irr_comp_3 = AinvM),

```

If I try to use `str()` to estimate the DGE-IGE covariance as well: 
`random = ~str(id + mm(irr_comp_1 + irr_comp_2 + irr_comp_3)) ` I get 
the error:

```
Error in buildZ(rmodel.terms[r], data = data, nginverse = 
names(ginverse)) :
 ? object id and mm(irr_comp_1 and irr_comp_2 and irr_comp_3) not found
```

Is there another way to write the formula or other workaround for using 
MCMCglmm to estimate the DGE-IGE covariance that anyone knows about or 
is this currently just not possible?

Sincerely,
Matthew

-- 
****************************************************
Matthew E. Wolak, Ph.D.
Associate Professor
Department of Biological Sciences
Auburn University
306 Funchess Hall
Auburn, AL 36849, USA

https://qgevoeco.com
Email:terps at auburn.edu
Tel: 334-844-9242

	[[alternative HTML version deleted]]


From j@h@d||e|d @end|ng |rom ed@@c@uk  Fri Jul 18 19:06:30 2025
From: j@h@d||e|d @end|ng |rom ed@@c@uk (Jarrod Hadfield)
Date: Fri, 18 Jul 2025 17:06:30 +0000
Subject: [R-sig-ME] 
 MCMCglmm: possible to estimate a covariance with mm()
 multiple membership structure
In-Reply-To: <31310b6f-52f9-4003-bbef-040c8b911fc3@auburn.edu>
References: <31310b6f-52f9-4003-bbef-040c8b911fc3@auburn.edu>
Message-ID: <9AEBC9DE-1EB1-4CE4-9C62-0591F28E362E@ed.ac.uk>

Hi Matthew,

Sorry - this is not implemented. It's annoyed me too as I needed it for some of my analyses, but in the end I didn?t have the energy to implement it and used asreml instead.

Cheers,

Jarrod


> On 18 Jul 2025, at 17:33, Matthew Wolak <mew0099 at auburn.edu> wrote:
>
> [You don't often get email from mew0099 at auburn.edu. Learn why this is important at https://aka.ms/LearnAboutSenderIdentification ]
>
> Dear List,
>
> I am using MCMCglmm for a quantitative genetic analysis of reproductive
> success data where 1 focal individual competed in an assay against 3
> same-sex competitors. We have pedigree information for every individual
> and so I would like to estimate the direct genetic effects (DGE)
> variance among focal individuals, indirect genetic effects (IGE)
> variance among competitors, and the DGE-IGE covariance.
>
> My main question is whether it is possible to estimate the DGE-IGE
> covariance in MCMCglmm? I know this is possible when there is a single
> term making up the IGE effects, as in a DGE-maternal genetic covariance
> by including these terms in the `str()` function (for example, as
> described in another post:
> https://stat.ethz.ch/pipermail/r-sig-mixed-models/2017q4/026271.html).
>
> However, since I have 3 competitors I am using the multiple membership
> function `mm()` and it seems MCMCglmm does not allow combining `str()`
> and `mm()`. The code for specifying my random effects terms _without_ a
> covariance is:
>
> ```
> # below `id` is the focal individual and `irr_comp_X` is each of the 3
> competitors of the focal
>
>    random = ~ id + mm(irr_comp_1 + irr_comp_2 + irr_comp_3),
>    ginverse = list(id = AinvM,
>      irr_comp_1 = AinvM, irr_comp_2 = AinvM, irr_comp_3 = AinvM),
>
> ```
>
> If I try to use `str()` to estimate the DGE-IGE covariance as well:
> `random = ~str(id + mm(irr_comp_1 + irr_comp_2 + irr_comp_3)) ` I get
> the error:
>
> ```
> Error in buildZ(rmodel.terms[r], data = data, nginverse =
> names(ginverse)) :
>   object id and mm(irr_comp_1 and irr_comp_2 and irr_comp_3) not found
> ```
>
> Is there another way to write the formula or other workaround for using
> MCMCglmm to estimate the DGE-IGE covariance that anyone knows about or
> is this currently just not possible?
>
> Sincerely,
> Matthew
>
> --
> ****************************************************
> Matthew E. Wolak, Ph.D.
> Associate Professor
> Department of Biological Sciences
> Auburn University
> 306 Funchess Hall
> Auburn, AL 36849, USA
>
> https://qgevoeco.com/
> Email:terps at auburn.edu
> Tel: 334-844-9242
>
>        [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models

The University of Edinburgh is a charitable body, registered in Scotland, with registration number SC005336. Is e buidheann carthannais a th? ann an Oilthigh Dh?n ?ideann, cl?raichte an Alba, ?ireamh cl?raidh SC005336.

From mew0099 @end|ng |rom @uburn@edu  Fri Jul 18 19:54:35 2025
From: mew0099 @end|ng |rom @uburn@edu (Matthew Wolak)
Date: Fri, 18 Jul 2025 12:54:35 -0500
Subject: [R-sig-ME] 
 MCMCglmm: possible to estimate a covariance with mm()
 multiple membership structure
In-Reply-To: <9AEBC9DE-1EB1-4CE4-9C62-0591F28E362E@ed.ac.uk>
References: <31310b6f-52f9-4003-bbef-040c8b911fc3@auburn.edu>
 <9AEBC9DE-1EB1-4CE4-9C62-0591F28E362E@ed.ac.uk>
Message-ID: <2e2c7832-87c7-4f59-ad34-34ee71958bd2@auburn.edu>

Hi Jarrod,

Thanks for the speedy reply and that helps narrow down the choices for 
how to analyze the data to just asreml now.

Sincerely,
Matthew

On 7/18/25 12:06, Jarrod Hadfield wrote:
> Hi Matthew,
>
> Sorry - this is not implemented. It's annoyed me too as I needed it for some of my analyses, but in the end I didn?t have the energy to implement it and used asreml instead.
>
> Cheers,
>
> Jarrod
>
>
>> On 18 Jul 2025, at 17:33, Matthew Wolak <mew0099 at auburn.edu> wrote:
>>
>> [You don't often get email from mew0099 at auburn.edu. Learn why this is important at https://aka.ms/LearnAboutSenderIdentification ]
>>
>> Dear List,
>>
>> I am using MCMCglmm for a quantitative genetic analysis of reproductive
>> success data where 1 focal individual competed in an assay against 3
>> same-sex competitors. We have pedigree information for every individual
>> and so I would like to estimate the direct genetic effects (DGE)
>> variance among focal individuals, indirect genetic effects (IGE)
>> variance among competitors, and the DGE-IGE covariance.
>>
>> My main question is whether it is possible to estimate the DGE-IGE
>> covariance in MCMCglmm? I know this is possible when there is a single
>> term making up the IGE effects, as in a DGE-maternal genetic covariance
>> by including these terms in the `str()` function (for example, as
>> described in another post:
>> https://stat.ethz.ch/pipermail/r-sig-mixed-models/2017q4/026271.html).
>>
>> However, since I have 3 competitors I am using the multiple membership
>> function `mm()` and it seems MCMCglmm does not allow combining `str()`
>> and `mm()`. The code for specifying my random effects terms _without_ a
>> covariance is:
>>
>> ```
>> # below `id` is the focal individual and `irr_comp_X` is each of the 3
>> competitors of the focal
>>
>>     random = ~ id + mm(irr_comp_1 + irr_comp_2 + irr_comp_3),
>>     ginverse = list(id = AinvM,
>>       irr_comp_1 = AinvM, irr_comp_2 = AinvM, irr_comp_3 = AinvM),
>>
>> ```
>>
>> If I try to use `str()` to estimate the DGE-IGE covariance as well:
>> `random = ~str(id + mm(irr_comp_1 + irr_comp_2 + irr_comp_3)) ` I get
>> the error:
>>
>> ```
>> Error in buildZ(rmodel.terms[r], data = data, nginverse =
>> names(ginverse)) :
>>    object id and mm(irr_comp_1 and irr_comp_2 and irr_comp_3) not found
>> ```
>>
>> Is there another way to write the formula or other workaround for using
>> MCMCglmm to estimate the DGE-IGE covariance that anyone knows about or
>> is this currently just not possible?
>>
>> Sincerely,
>> Matthew
>>
>> --
>> ****************************************************
>> Matthew E. Wolak, Ph.D.
>> Associate Professor
>> Department of Biological Sciences
>> Auburn University
>> 306 Funchess Hall
>> Auburn, AL 36849, USA
>>
>> https://qgevoeco.com/
>> Email:terps at auburn.edu
>> Tel: 334-844-9242
>>
>>         [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-mixed-models at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> The University of Edinburgh is a charitable body, registered in Scotland, with registration number SC005336. Is e buidheann carthannais a th? ann an Oilthigh Dh?n ?ideann, cl?raichte an Alba, ?ireamh cl?raidh SC005336.

-- 
****************************************************
Matthew E. Wolak, Ph.D.
Associate Professor
Department of Biological Sciences
Auburn University
306 Funchess Hall
Auburn, AL 36849, USA

https://qgevoeco.com/
Email: terps at auburn.edu
Tel: 334-844-9242


From o||verhooker @end|ng |rom pr@t@t|@t|c@@com  Tue Jul 29 19:43:28 2025
From: o||verhooker @end|ng |rom pr@t@t|@t|c@@com (Oliver Hooker)
Date: Tue, 29 Jul 2025 18:43:28 +0100
Subject: [R-sig-ME] Introduction to Generalised Linear Mixed Models for
 Ecologists (MMIE01)
Message-ID: <CAEsSYzxo4x3F924JYhbnh_0d5+ZsnF0_8r=9cTwHQRmj9gThsw@mail.gmail.com>

*Course Title:* Introduction to Generalised Linear Mixed Models for
Ecologists (MMIE01)
https://www.prstats.org/course/introduction-to-generalised-linear-mixed-models-for-ecologists-mmie01/

*Dates:* 22?26 September 2025
*Format:* Live online (GMT+1) with recordings available for this who can't
join live
*Price:* ?400 early?bird (first 10 places), ?450 thereafter
------------------------------
Why Attend?

Unlock powerful statistical tools tailored for ecological research:

   -

   Dive into *generalised linear mixed models (GLMMs)* to model complex
   ecological datasets with hierarchical or grouped structure.
   -

   Learn to implement real-world analyses using *R packages including lme4
   and brms*, including Bayesian methods.
   -

   Tackle count, binary, overdispersed, and zero-inflated data with ease.
   -

   Engage in *hands?on sessions*, workshops, and case studies?bring your
   own data to practice.
   -

   Benefit from *post-course support* and 30-day access to session
   recordings so you can catch up anytime.

------------------------------
Who Should Join?

Designed for ecologists, early-career researchers, postgraduate students,
and data analysts with basic R and statistical backgrounds:

   -

   Familiarity with R or RStudio basics, importing data, and simple linear
   models is recommended.
   -

   Experience with exploratory data tools (e.g. dplyr, ggplot2) is
   helpful?but not required.

------------------------------
What You'll Learn -

Over five days (approx. 40 learning hours), you?ll explore:

   1.

   *The GLMM framework*: fixed vs. random effects, hierarchical structures
   2.

   *Practice in R*: fitting GLMMs via lme4, exploring Bayesian extensions
   with brms
   3.

   *Model diagnostics*: checking assumptions, handling overdispersion,
   understanding shrinkage and intraclass correlation
   4.

   *Advanced structures*: nested vs crossed random effects, group-level
   predictors
   5.

   *Bayesian approaches*: how and when to use brms for complex ecological
   data.


   Please visit the course schedule
   <https://www.prstats.org/course/introduction-to-generalised-linear-mixed-models-for-ecologists-mmie01/>
   on the course webpage for a detailed outline of the topics covered.

------------------------------
Meet the Expert Instructors

Led by seasoned ecologists-statisticians, *Dr Niamh?Mimnagh*, the course
brings real-world experience at the intersection of ecology, epidemiology,
and statistical methodology. Expect an engaging blend of theory,
interactive workshops, and lively Q&A sessions.
------------------------------
Ready to Advance Your Analysis?

Whether you're designing ecological field studies, managing wildlife
monitoring data, or analyzing species distributions over space and
time?this course equips you with practical expertise to unlock deeper
insights from your data.

Secure your place today and take your ecological modelling to the next
level!


Email oliverhooker at prstatistics.com with any questions

-- 
Oliver Hooker PhD.
PR stats

	[[alternative HTML version deleted]]


From o||verhooker @end|ng |rom pr@t@t|@t|c@@com  Tue Aug  5 14:55:25 2025
From: o||verhooker @end|ng |rom pr@t@t|@t|c@@com (Oliver Hooker)
Date: Tue, 5 Aug 2025 13:55:25 +0100
Subject: [R-sig-ME] =?utf-8?q?Bayesian_Multilevel_Modelling_using=C2=A0br?=
	=?utf-8?q?ms=C2=A0for_Ecologists_=28BMME01=29?=
Message-ID: <CAEsSYzwvM7EViNY-TyXxtMWCUi82BSTvYXkDmmq1eT9KeSJTyw@mail.gmail.com>

Bayesian Multilevel Modelling using *brms* for Ecologists (BMME01) ?
PR?StatsFrame ecological questions rigorously using *Bayesian multilevel
models in R*
https://www.prstats.org/course/bayesian-multilevel-modelling-using-brms-for-ecologists-bmme01/

Explore model building, uncertainty quantification, spatial and temporal
autocorrelation, and species distribution modelling through a *ten?session
live online course*, designed for ecologists using R.
------------------------------
 Course Details & Format

   -

   *Next Session*: October?20?24 & October?27?31,?2025 (Monday?Friday)
   -

   *Duration*: 10 days ? ~4 hours/day = 40 hours total
   -

   *Schedule*: Live sessions conducted in UK time (GMT+1); all sessions
   recorded and available for later viewing, accommodating global participants
   -

   *Format*: Interactive learning via remote online classroom; lectures and
   Q&A, plus applied coding exercises

------------------------------
Who It?s For & What You?ll Gain

Designed for ecologists, postgraduate researchers, analysts, and
early-career scientists with basic R/RStudio experience and fundamental
statistics knowledge.

By the end of the course, you?ll be able to:

   -

   Frame and implement *Bayesian inference*, including priors, posteriors,
   and credible intervals
   -

   Fit GLMs and hierarchical multilevel models using *brms*
   -

   Choose and interpret meaningful priors for ecological parameters
   -

   Diagnose and critique model fit with posterior predictive checks, WAIC,
   LOO-CV
   -

   Model non-Gaussian ecological data (counts, proportions, zero-inflation)
   -

   Account for *spatial and temporal autocorrelation* in hierarchical models
   -

   Build multivariate/joint species distribution models for community
   analysis
   -

   Visualize and clearly communicate uncertainty in model results

------------------------------
? Fees & Registration

   -

   *Early bird (first 10 places)*: *?400*
   -

   *Standard fee*: *?450*


Ideal participants should be comfortable installing and using R and
RStudio, and have basic familiarity with functions, plotting (e.g.
ggplot2), and statistics like regression.
------------------------------
Why Choose BMME01?

   -

   *Comprehensive curriculum*: From Bayesian fundamentals to advanced
   ecological modelling
   -

   *Focus on applied use*: Ecologically-relevant examples including
   spatial, temporal, count, and joint species modelling
   -

   *Expert-led sessions*: Topic-by-topic deep dives with practical exercises
   -

   *Flexible structure*: Live sessions with recordings ? rewind, revisit,
   and learn at your pace
   -

   *Learning continuity*: Bring and work with your data, and get feedback
   via guided exercises and peer interaction

------------------------------

Build multilevel models with *confidence*, interpret ecological data with
*nuance*, and communicate results with *clarity*.

Email oliver at prstats.org with any questions

-- 
Oliver Hooker PhD.
PR stats

	[[alternative HTML version deleted]]


From i@io m@iii@g oii phys@ii@-courses@org  Thu Aug  7 14:46:10 2025
From: i@io m@iii@g oii phys@ii@-courses@org (i@io m@iii@g oii phys@ii@-courses@org)
Date: Thu, 7 Aug 2025 14:46:10 +0200 (CEST)
Subject: [R-sig-ME] =?utf-8?q?Online_Course=3A_Generalised_Additive_Model?=
 =?utf-8?q?s_=28GAMs=29_in_R_=E2=80=93_Registration_Open!?=
In-Reply-To: <1752066889.09837579@webmail.jimdo.com>
References: <1752066889.09837579@webmail.jimdo.com>
Message-ID: <1754570770.750827909@webmail.jimdo.com>


Dear all,

registrations are now open for the Physalia upcoming online course: Generalised Additive Models (GAMs) in R
Dates: 8?11 December 
 
Course webite: [ https://www.physalia-courses.org/courses-workshops/gams-in-r/ ]( https://www.physalia-courses.org/courses-workshops/gams-in-r/ ) 
 
In this course, you?ll learn how to model complex, non-linear relationships using splines and the powerful mgcv and gratia packages in R. The course includes hands-on exercises and practical examples?perfect for anyone with basic R knowledge looking to expand their modelling skills.
 
 
More details and registration: [ https://www.physalia-courses.org/courses-workshops/gams-in-r/ ]( https://www.physalia-courses.org/courses-workshops/gams-in-r/ )
 
Feel free to reach out if you have any questions!
Best regards,
 
Carlo
 
 
 
 
--------------------

Carlo Pecoraro, Ph.D


Physalia-courses DIRECTOR

info at physalia-courses.org

mobile: +49 17645230846

[ Bluesky ]( https://bsky.app/profile/physaliacourses.bsky.social ) [ Linkedin ]( https://www.linkedin.com/in/physalia-courses-a64418127/ )





 
	[[alternative HTML version deleted]]


From ken@knob|@uch @end|ng |rom |n@erm@|r  Wed Sep  3 17:56:21 2025
From: ken@knob|@uch @end|ng |rom |n@erm@|r (Kenneth KNOBLAUCH)
Date: Wed, 3 Sep 2025 15:56:21 +0000
Subject: [R-sig-ME] specifying random effects in nlme with correlation fixed
 at 0
Message-ID: <b66c01ff293149f1999bb44068cd57c1@inserm.fr>

I'm fitting a model using nlme. ?The data frame has 9600 rows and the grouping variable, Obs, has 10 levels. ?I fit the following model (names of variables simplified from original) that runs fine:

m1 <-?nlme(y ~ A * x / (x + B), data = d.df,
                   fixed = A + B ~ F,  
                   random = A + B ~ 1 | Obs,
                   start = list(fixed = c(A = c(2, 0), B = c(15, 0)) ))

F is a 2 level factor and A and B parameters to estimate.  This runs fine, too, using SSmicmen(x, A, B) for the right hand side of the formula.  x and y are numeric variables.

I would like to compare model m1 to a model where the correlation between random effects is fixed to 0.  I tried

update(m1, random = list(A ~ 1 | Obs, B ~ 1 | Obs))

but I get the following error message:

Error in parse(text = paste("~", paste(nVal, collapse = "/"))) : 
  <text>:2:0: unexpected end of input
1: ~ 
   ^

I've also tried with various combinations of the pdMat functions but can't find the right way to specify this. 

Simpler models, leaving out one or the other random effect work as well as for leaving out fixed effects after the random effects have been tested. 

Thank you for any suggestions.

Ken
  ___
  Kenneth Knoblauch
 Inserm U1208
 Stem-cell and Brain Research Institute
 18 avenue du Doyen L?pine
 69500 Bron
 France
 tel: +33 (0)4 72 91 34 77
 fax: +33 (0)4 72 91 34 61
 portable: +33 (0)6 84 10 64 10
 https://sbri.fr/public-profile/63/single-member/
    

From bbo|ker @end|ng |rom gm@||@com  Wed Sep  3 19:52:45 2025
From: bbo|ker @end|ng |rom gm@||@com (Ben Bolker)
Date: Wed, 3 Sep 2025 13:52:45 -0400
Subject: [R-sig-ME] 
 specifying random effects in nlme with correlation fixed at 0
In-Reply-To: <b66c01ff293149f1999bb44068cd57c1@inserm.fr>
References: <b66c01ff293149f1999bb44068cd57c1@inserm.fr>
Message-ID: <43862965-4ff4-40e4-afac-4913fdcc6eb1@gmail.com>

    I will dig into this if I get a chance, although the nlme code can 
be a little scary sometimes.  It might not be possible.

   It's not quite the same model but you might be able to hack this in 
lme4::glmer or glmmTMB by using a Gaussian model with an *inverse* link: 
that effectively transforms the problem from

y ~ A * x / (x + B)

to

1/y ~ A + (B/A)*(1/x)

but preserves the constant-variance/Gaussian assumption on the original 
scale.

On 9/3/25 11:56, Kenneth KNOBLAUCH wrote:
> I'm fitting a model using nlme. ?The data frame has 9600 rows and the grouping variable, Obs, has 10 levels. ?I fit the following model (names of variables simplified from original) that runs fine:
> 
> m1 <-?nlme(y ~ A * x / (x + B), data = d.df,
>                     fixed = A + B ~ F,
>                     random = A + B ~ 1 | Obs,
>                     start = list(fixed = c(A = c(2, 0), B = c(15, 0)) ))
> 
> F is a 2 level factor and A and B parameters to estimate.  This runs fine, too, using SSmicmen(x, A, B) for the right hand side of the formula.  x and y are numeric variables.
> 
> I would like to compare model m1 to a model where the correlation between random effects is fixed to 0.  I tried
> 
> update(m1, random = list(A ~ 1 | Obs, B ~ 1 | Obs))
> 
> but I get the following error message:
> 
> Error in parse(text = paste("~", paste(nVal, collapse = "/"))) :
>    <text>:2:0: unexpected end of input
> 1: ~
>     ^
> 
> I've also tried with various combinations of the pdMat functions but can't find the right way to specify this.
> 
> Simpler models, leaving out one or the other random effect work as well as for leaving out fixed effects after the random effects have been tested.
> 
> Thank you for any suggestions.
> 
> Ken
>    ___
>    Kenneth Knoblauch
>   Inserm U1208
>   Stem-cell and Brain Research Institute
>   18 avenue du Doyen L?pine
>   69500 Bron
>   France
>   tel: +33 (0)4 72 91 34 77
>   fax: +33 (0)4 72 91 34 61
>   portable: +33 (0)6 84 10 64 10
>   https://sbri.fr/public-profile/63/single-member/
>      
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models

-- 
Dr. Benjamin Bolker
Professor, Mathematics & Statistics and Biology, McMaster University
Associate chair (graduate), Mathematics & Statistics
Director, School of Computational Science and Engineering
* E-mail is sent at my convenience; I don't expect replies outside of 
working hours.


From ken@knob|@uch @end|ng |rom |n@erm@|r  Wed Sep  3 20:44:27 2025
From: ken@knob|@uch @end|ng |rom |n@erm@|r (Kenneth KNOBLAUCH)
Date: Wed, 3 Sep 2025 18:44:27 +0000
Subject: [R-sig-ME] 
 specifying random effects in nlme with correlation fixed at 0
In-Reply-To: <b66c01ff293149f1999bb44068cd57c1@inserm.fr>
References: <b66c01ff293149f1999bb44068cd57c1@inserm.fr>
Message-ID: <a1d547e353e04a7a8c5db84638146491@inserm.fr>

Thank you Ben for the rapid response.  I knew about the linearization of the Michelis-Menten function by inverting both sides but I hadn't thought of the inverse link.  Very clever.

I tried

d.df$invx<- 1/d.df$x
d.df$invy <- 1/d.df$y
g1 <- glmer(invy ~ Filter * invx+ (invx | Obs), d.df, 
            family = gaussian("inverse"))

I get a singular fit, I guess, because the correlation of random effects is -1, with this parameterization (only about 0.4 with what I was getting using nlme on the uninverted responses).

with glmer on inverted model:
Random effects:
 Groups   Name          Variance Std.Dev. Corr 
 Obs      (Intercept)      0.01231  0.1110        
               invx              0.54359  0.7373   -1.00
 Residual                    3.78661  1.9459        
Number of obs: 9600, groups:  Obs, 10


with nlme on uninverted model:

                      StdDev    Corr  
A.(Intercept)  0.2514793 A.(I)
B.(Intercept)  1.1955573 0.428 
Residual        0.4257936       

Also, the reparameterization complicates a little bit the parameter interpretation. A is still A but now the second parameter becomes B/A.  With nlme, I can test whether there is a fixed effect on both.  Here, I can look at F wrt to the Intercept and F:invx wrt to invx.  I can live with that.

Any suggestions for the singular model (I can re-read the isSingular page).

It's interesting.  

If you come up with a solution for nlme, I would be interested to see it.

Thanks.

Ken


###############################
    I will dig into this if I get a chance, although the nlme code can  be a little scary sometimes.  It might not be possible.     It's not quite the same model but you might be able to hack this in  lme4::glmer or glmmTMB by using a Gaussian model with an *inverse* link:  that effectively transforms the problem from  y ~ A * x / (x + B)  to  1/y ~ A + (B/A)*(1/x)  but preserves the constant-variance/Gaussian assumption on the original  scale.  On 9/3/25 11:56, Kenneth KNOBLAUCH wrote: > I'm fitting a model using nlme. ?The data frame has 9600 rows and the grouping variable, Obs, has 10 levels. ?I fit the following model (names of variables simplified from original) that runs fine: >  > m1 <-?nlme(y ~ A * x / (x + B), data = d.df, >                     fixed = A + B ~ F, >                     random = A + B ~ 1 | Obs, >                     start = list(fixed = c(A = c(2, 0), B = c(15, 0)) )) >  > F is a 2 level factor and A and B parameters to estimate.  This runs fine, too, using SSmicmen(x, A, B) for the right hand side of the formula.  x and y are numeric variables. >  > I would like to compare model m1 to a model where the correlation between random effects is fixed to 0.  I tried >  > update(m1, random = list(A ~ 1 | Obs, B ~ 1 | Obs)) >  > but I get the following error message: >  > Error in parse(text = paste("~", paste(nVal, collapse = "/"))) : >    <text>:2:0: unexpected end of input > 1: ~ >     ^ >  > I've also tried with various combinations of the pdMat functions but can't find the right way to specify this. >  > Simpler models, leaving out one or the other random effect work as well as for leaving out fixed effects after the random effects have been tested. >  > Thank you for any suggestions.
  
 De : Kenneth KNOBLAUCH
Envoy? : mercredi 3 septembre 2025 17:56
? : r-sig-mixed-models at r-project.org
Objet : specifying random effects in nlme with correlation fixed at 0
?   
I'm fitting a model using nlme. ?The data frame has 9600 rows and the grouping variable, Obs, has 10 levels. ?I fit the following model (names of variables simplified from original) that runs fine:

m1 <-?nlme(y ~ A * x / (x + B), data = d.df,
?????????????????? fixed = A + B ~ F,? 
?????????????????? random = A + B ~ 1 | Obs,
?????????????????? start = list(fixed = c(A = c(2, 0), B = c(15, 0)) ))

F is a 2 level factor and A and B parameters to estimate.? This runs fine, too, using SSmicmen(x, A, B) for the right hand side of the formula.? x and y are numeric variables.

I would like to compare model m1 to a model where the correlation between random effects is fixed to 0.? I tried

update(m1, random = list(A ~ 1 | Obs, B ~ 1 | Obs))

but I get the following error message:

Error in parse(text = paste("~", paste(nVal, collapse = "/"))) : 
? <text>:2:0: unexpected end of input
1: ~ 
?? ^

I've also tried with various combinations of the pdMat functions but can't find the right way to specify this.

Simpler models, leaving out one or the other random effect work as well as for leaving out fixed effects after the random effects have been tested.

Thank you for any suggestions.

Ken
? ___
? Kenneth Knoblauch
?Inserm U1208
?Stem-cell and Brain Research Institute
?18 avenue du Doyen L?pine
?69500 Bron
?France
?tel: +33 (0)4 72 91 34 77
?fax: +33 (0)4 72 91 34 61
?portable: +33 (0)6 84 10 64 10
?https://sbri.fr/public-profile/63/single-member/
???     

From bbo|ker @end|ng |rom gm@||@com  Wed Sep  3 22:11:49 2025
From: bbo|ker @end|ng |rom gm@||@com (Ben Bolker)
Date: Wed, 3 Sep 2025 16:11:49 -0400
Subject: [R-sig-ME] 
 specifying random effects in nlme with correlation fixed at 0
In-Reply-To: <a1d547e353e04a7a8c5db84638146491@inserm.fr>
References: <b66c01ff293149f1999bb44068cd57c1@inserm.fr>
 <a1d547e353e04a7a8c5db84638146491@inserm.fr>
Message-ID: <1bdf0429-ef7c-4604-b9e6-0fa633ca2de1@gmail.com>

   I think you shouldn't be using glmer(invy ~ ... ), but glmer(y ~ 
...); the link function takes care of the inversion for you. By analogy, 
you use e.g. glmer(y ~ ..., family = poisson(link = "log")) rather than 
glmer(log(y) ~ ... family(poisson(link = "log")) for a log-link Poisson 
response.  By using glmer(invy ~ ..., family = gaussian("inverse")) I 
think you're actually undoing the transformation (!) because inverse() 
is its own (function) inverse ...


On 9/3/25 14:44, Kenneth KNOBLAUCH wrote:
> Thank you Ben for the rapid response.  I knew about the linearization of the Michelis-Menten function by inverting both sides but I hadn't thought of the inverse link.  Very clever.
> 
> I tried
> 
> d.df$invx<- 1/d.df$x
> d.df$invy <- 1/d.df$y
> g1 <- glmer(invy ~ Filter * invx+ (invx | Obs), d.df,
>              family = gaussian("inverse"))
> 
> I get a singular fit, I guess, because the correlation of random effects is -1, with this parameterization (only about 0.4 with what I was getting using nlme on the uninverted responses).
> 
> with glmer on inverted model:
> Random effects:
>   Groups   Name          Variance Std.Dev. Corr
>   Obs      (Intercept)      0.01231  0.1110
>                 invx              0.54359  0.7373   -1.00
>   Residual                    3.78661  1.9459
> Number of obs: 9600, groups:  Obs, 10
> 
> 
> with nlme on uninverted model:
> 
>                        StdDev    Corr
> A.(Intercept)  0.2514793 A.(I)
> B.(Intercept)  1.1955573 0.428
> Residual        0.4257936
> 
> Also, the reparameterization complicates a little bit the parameter interpretation. A is still A but now the second parameter becomes B/A.  With nlme, I can test whether there is a fixed effect on both.  Here, I can look at F wrt to the Intercept and F:invx wrt to invx.  I can live with that.
> 
> Any suggestions for the singular model (I can re-read the isSingular page).
> 
> It's interesting.
> 
> If you come up with a solution for nlme, I would be interested to see it.
> 
> Thanks.
> 
> Ken
> 
> 
> ###############################
>      I will dig into this if I get a chance, although the nlme code can  be a little scary sometimes.  It might not be possible.     It's not quite the same model but you might be able to hack this in  lme4::glmer or glmmTMB by using a Gaussian model with an *inverse* link:  that effectively transforms the problem from  y ~ A * x / (x + B)  to  1/y ~ A + (B/A)*(1/x)  but preserves the constant-variance/Gaussian assumption on the original  scale.  On 9/3/25 11:56, Kenneth KNOBLAUCH wrote: > I'm fitting a model using nlme. ?The data frame has 9600 rows and the grouping variable, Obs, has 10 levels. ?I fit the following model (names of variables simplified from original) that runs fine: >  > m1 <-?nlme(y ~ A * x / (x + B), data = d.df, >                     fixed = A + B ~ F, >                     random = A + B ~ 1 | Obs, >                     start = list(fixed = c(A = c(2, 0), B = c(15, 0)) )) >  > F is a 2 level factor and A and B parameters to estimate.  This runs fine, too, using SSmicmen(x, A, B) for the right hand side of the formula.  x and y are numeric variables. >  > I would like to compare model m1 to a model where the correlation between random effects is fixed to 0.  I tried >  > update(m1, random = list(A ~ 1 | Obs, B ~ 1 | Obs)) >  > but I get the following error message: >  > Error in parse(text = paste("~", paste(nVal, collapse = "/"))) : >    <text>:2:0: unexpected end of input > 1: ~ >     ^ >  > I've also tried with various combinations of the pdMat functions but can't find the right way to specify this. >  > Simpler models, leaving out one or the other random effect work as well as for leaving out fixed effects after the random effects have been tested. >  > Thank you for any suggestions.
>    
>   De : Kenneth KNOBLAUCH
> Envoy? : mercredi 3 septembre 2025 17:56
> ? : r-sig-mixed-models at r-project.org
> Objet : specifying random effects in nlme with correlation fixed at 0
>      
> I'm fitting a model using nlme. ?The data frame has 9600 rows and the grouping variable, Obs, has 10 levels. ?I fit the following model (names of variables simplified from original) that runs fine:
> 
> m1 <-?nlme(y ~ A * x / (x + B), data = d.df,
>  ?????????????????? fixed = A + B ~ F,
>  ?????????????????? random = A + B ~ 1 | Obs,
>  ?????????????????? start = list(fixed = c(A = c(2, 0), B = c(15, 0)) ))
> 
> F is a 2 level factor and A and B parameters to estimate.? This runs fine, too, using SSmicmen(x, A, B) for the right hand side of the formula.? x and y are numeric variables.
> 
> I would like to compare model m1 to a model where the correlation between random effects is fixed to 0.? I tried
> 
> update(m1, random = list(A ~ 1 | Obs, B ~ 1 | Obs))
> 
> but I get the following error message:
> 
> Error in parse(text = paste("~", paste(nVal, collapse = "/"))) :
>  ? <text>:2:0: unexpected end of input
> 1: ~
>  ?? ^
> 
> I've also tried with various combinations of the pdMat functions but can't find the right way to specify this.
> 
> Simpler models, leaving out one or the other random effect work as well as for leaving out fixed effects after the random effects have been tested.
> 
> Thank you for any suggestions.
> 
> Ken
>  ? ___
>  ? Kenneth Knoblauch
>  ?Inserm U1208
>  ?Stem-cell and Brain Research Institute
>  ?18 avenue du Doyen L?pine
>  ?69500 Bron
>  ?France
>  ?tel: +33 (0)4 72 91 34 77
>  ?fax: +33 (0)4 72 91 34 61
>  ?portable: +33 (0)6 84 10 64 10
>  ?https://sbri.fr/public-profile/63/single-member/
>          
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models

-- 
Dr. Benjamin Bolker
Professor, Mathematics & Statistics and Biology, McMaster University
Associate chair (graduate), Mathematics & Statistics
Director, School of Computational Science and Engineering
* E-mail is sent at my convenience; I don't expect replies outside of 
working hours.


From ken@knob|@uch @end|ng |rom |n@erm@|r  Thu Sep  4 08:05:39 2025
From: ken@knob|@uch @end|ng |rom |n@erm@|r (Kenneth KNOBLAUCH)
Date: Thu, 4 Sep 2025 06:05:39 +0000
Subject: [R-sig-ME] 
 specifying random effects in nlme with correlation fixed at 0
In-Reply-To: <a1d547e353e04a7a8c5db84638146491@inserm.fr>
References: <b66c01ff293149f1999bb44068cd57c1@inserm.fr>,
 <a1d547e353e04a7a8c5db84638146491@inserm.fr>
Message-ID: <ddae4f0cdb454d1dae07491588eb63e7@inserm.fr>

Absolutely.   My brain got inverted.  My original response variable, what I'm calling invy, is actually reaction time and I inverted it to get speed, what I'm calling y, for variance stabilization.  Unnecessarily confusing to free my example from its context.

I was pretty sure based on what I've gleaned from web examples that there is a way to do this in nlme using pdMat functions.  I'm away from home but will be back tonight where I can consult Pinheiro and Bates and other references.

Thanks.

Ken


################################
De Ben Bolker bbo|ker @end|ng |rom gm@||@com
 I think you shouldn't be using glmer(invy ~ ... ), but glmer(y ~ 
...); the link function takes care of the inversion for you. By analogy, 
you use e.g. glmer(y ~ ..., family = poisson(link = "log")) rather than
glmer(log(y) ~ ... family(poisson(link = "log")) for a log-link Poisson 
response.  By using glmer(invy ~ ..., family = gaussian("inverse")) I 
think you're actually undoing the transformation (!) because inverse() 
is its own (function) inverse ...
     
  

  ___
  Kenneth Knoblauch
 Inserm U1208
 Stem-cell and Brain Research Institute
 18 avenue du Doyen L?pine
 69500 Bron
 France
 tel: +33 (0)4 72 91 34 77
 fax: +33 (0)4 72 91 34 61
 portable: +33 (0)6 84 10 64 10
 https://sbri.fr/public-profile/63/single-member/
    




De : Kenneth KNOBLAUCH
Envoy? : mercredi 3 septembre 2025 20:44
? : r-sig-mixed-models at r-project.org
Objet : RE: specifying random effects in nlme with correlation fixed at 0
?   
Thank you Ben for the rapid response.? I knew about the linearization of the Michelis-Menten function by inverting both sides but I hadn't thought of the inverse link.? Very clever.

I tried

d.df$invx<- 1/d.df$x
d.df$invy <- 1/d.df$y
g1 <- glmer(invy ~ Filter * invx+ (invx | Obs), d.df, 
??????????? family = gaussian("inverse"))

I get a singular fit, I guess, because the correlation of random effects is -1, with this parameterization (only about 0.4 with what I was getting using nlme on the uninverted responses).

with glmer on inverted model:
Random effects:
?Groups?? Name????????? Variance Std.Dev. Corr 
?Obs????? (Intercept)????? 0.01231? 0.1110??????? 
?????????????? invx????????????? 0.54359? 0.7373?? -1.00
?Residual??????????????????? 3.78661? 1.9459??????? 
Number of obs: 9600, groups:? Obs, 10


with nlme on uninverted model:

????????????????????? StdDev??? Corr? 
A.(Intercept)? 0.2514793 A.(I)
B.(Intercept)? 1.1955573 0.428 
Residual??????? 0.4257936?????? 

Also, the reparameterization complicates a little bit the parameter interpretation. A is still A but now the second parameter becomes B/A.? With nlme, I can test whether there is a fixed effect on both.? Here, I can look at F wrt to the Intercept and F:invx  wrt to invx.? I can live with that.

Any suggestions for the singular model (I can re-read the isSingular page).

It's interesting.? 

If you come up with a solution for nlme, I would be interested to see it.

Thanks.

Ken


###############################
De Ben Bolker bbo|ker @end|ng |rom gm@||@com
??? I will dig into this if I get a chance, although the nlme code can? be a little scary sometimes.? It might not be possible.???? It's not quite the same model but you might be able to hack this in? lme4::glmer or glmmTMB by using a Gaussian model with an  *inverse* link:? that effectively transforms the problem from? y ~ A * x / (x + B)? to? 1/y ~ A + (B/A)*(1/x)? but preserves the constant-variance/Gaussian assumption on the original? scale.? On 9/3/25 11:56, Kenneth KNOBLAUCH wrote: > I'm fitting a model  using nlme. ?The data frame has 9600 rows and the grouping variable, Obs, has 10 levels. ?I fit the following model (names of variables simplified from original) that runs fine: >? > m1 <-?nlme(y ~ A * x / (x + B), data = d.df, >???????????????????? fixed  = A + B ~ F, >???????????????????? random = A + B ~ 1 | Obs, >???????????????????? start = list(fixed = c(A = c(2, 0), B = c(15, 0)) )) >? > F is a 2 level factor and A and B parameters to estimate.? This runs fine, too, using SSmicmen(x, A, B) for the right  hand side of the formula.? x and y are numeric variables. >? > I would like to compare model m1 to a model where the correlation between random effects is fixed to 0.? I tried >? > update(m1, random = list(A ~ 1 | Obs, B ~ 1 | Obs)) >? > but I get the following  error message: >? > Error in parse(text = paste("~", paste(nVal, collapse = "/"))) : >??? <text>:2:0: unexpected end of input > 1: ~ >???? ^ >? > I've also tried with various combinations of the pdMat functions but can't find the right way to specify this.  >? > Simpler models, leaving out one or the other random effect work as well as for leaving out fixed effects after the random effects have been tested. >? > Thank you for any suggestions.
? 
?De : Kenneth KNOBLAUCH
Envoy? : mercredi 3 septembre 2025 17:56
? : r-sig-mixed-models at r-project.org
Objet : specifying random effects in nlme with correlation fixed at 0
??? 
I'm fitting a model using nlme. ?The data frame has 9600 rows and the grouping variable, Obs, has 10 levels. ?I fit the following model (names of variables simplified from original) that runs fine:

m1 <-?nlme(y ~ A * x / (x + B), data = d.df,
?????????????????? fixed = A + B ~ F,? 
?????????????????? random = A + B ~ 1 | Obs,
?????????????????? start = list(fixed = c(A = c(2, 0), B = c(15, 0)) ))

F is a 2 level factor and A and B parameters to estimate.? This runs fine, too, using SSmicmen(x, A, B) for the right hand side of the formula.? x and y are numeric variables.

I would like to compare model m1 to a model where the correlation between random effects is fixed to 0.? I tried

update(m1, random = list(A ~ 1 | Obs, B ~ 1 | Obs))

but I get the following error message:

Error in parse(text = paste("~", paste(nVal, collapse = "/"))) : 
? <text>:2:0: unexpected end of input
1: ~ 
?? ^

I've also tried with various combinations of the pdMat functions but can't find the right way to specify this.

Simpler models, leaving out one or the other random effect work as well as for leaving out fixed effects after the random effects have been tested.

Thank you for any suggestions.

Ken
? ___
? Kenneth Knoblauch
?Inserm U1208
?Stem-cell and Brain Research Institute
?18 avenue du Doyen L?pine
?69500 Bron
?France
?tel: +33 (0)4 72 91 34 77
?fax: +33 (0)4 72 91 34 61
?portable: +33 (0)6 84 10 64 10
?https://sbri.fr/public-profile/63/single-member/
???????     

From v@r|n@@ch@ @end|ng |rom y@hoo@|r  Fri Sep  5 00:21:24 2025
From: v@r|n@@ch@ @end|ng |rom y@hoo@|r (varin sacha)
Date: Fri, 5 Sep 2025 00:21:24 +0200
Subject: [R-sig-ME] 
 specifying random effects in nlme with correlation fixed at 0
In-Reply-To: <ddae4f0cdb454d1dae07491588eb63e7@inserm.fr>
References: <ddae4f0cdb454d1dae07491588eb63e7@inserm.fr>
Message-ID: <262E0E2F-2B34-4E5D-BB27-69EF02BE2707@yahoo.fr>

Hi,



Just a hint. What about forcing 0 correlation ? 

This is a way to test the need for a non-zero correlation in nlme.

To fix correlation at 0, we need to specify that the covariance structure is diagonal, not full. That?s what the pdDiag structure is for:

m2 <- update (m1,

  random = list(Obs = pdDiag(~ A + B - 1))

)



? pdDiag() = diagonal positive-definite matrix ? random effects are independent.

? ~ A + B - 1 = random intercepts for A and B separately, no correlation.

? The -1 just removes the intercept term from the pdMat specification.



And then we compare to the correlated version :

anova(m1, m2)



Use anova as a fast diagnostic. We have a likelihood ratio test for whether the correlation parameter is (or not) necessary.

Best,




> Le 4 sept. 2025 ? 08:06, Kenneth KNOBLAUCH <ken.knoblauch at inserm.fr> a ?crit :
> 
> ?Absolutely.   My brain got inverted.  My original response variable, what I'm calling invy, is actually reaction time and I inverted it to get speed, what I'm calling y, for variance stabilization.  Unnecessarily confusing to free my example from its context.
> 
> I was pretty sure based on what I've gleaned from web examples that there is a way to do this in nlme using pdMat functions.  I'm away from home but will be back tonight where I can consult Pinheiro and Bates and other references.
> 
> Thanks.
> 
> Ken
> 
> 
> ################################
> De Ben Bolker bbo|ker @end|ng |rom gm@||@com
> I think you shouldn't be using glmer(invy ~ ... ), but glmer(y ~
> ...); the link function takes care of the inversion for you. By analogy,
> you use e.g. glmer(y ~ ..., family = poisson(link = "log")) rather than
> glmer(log(y) ~ ... family(poisson(link = "log")) for a log-link Poisson
> response.  By using glmer(invy ~ ..., family = gaussian("inverse")) I
> think you're actually undoing the transformation (!) because inverse()
> is its own (function) inverse ...
> 
> 
> 
>  ___
>  Kenneth Knoblauch
> Inserm U1208
> Stem-cell and Brain Research Institute
> 18 avenue du Doyen L?pine
> 69500 Bron
> France
> tel: +33 (0)4 72 91 34 77
> fax: +33 (0)4 72 91 34 61
> portable: +33 (0)6 84 10 64 10
> https://sbri.fr/public-profile/63/single-member/
> 
> 
> 
> 
> 
> De : Kenneth KNOBLAUCH
> Envoy? : mercredi 3 septembre 2025 20:44
> ? : r-sig-mixed-models at r-project.org
> Objet : RE: specifying random effects in nlme with correlation fixed at 0
>     
> Thank you Ben for the rapid response.  I knew about the linearization of the Michelis-Menten function by inverting both sides but I hadn't thought of the inverse link.  Very clever.
> 
> I tried
> 
> d.df$invx<- 1/d.df$x
> d.df$invy <- 1/d.df$y
> g1 <- glmer(invy ~ Filter * invx+ (invx | Obs), d.df,
>             family = gaussian("inverse"))
> 
> I get a singular fit, I guess, because the correlation of random effects is -1, with this parameterization (only about 0.4 with what I was getting using nlme on the uninverted responses).
> 
> with glmer on inverted model:
> Random effects:
>  Groups   Name          Variance Std.Dev. Corr
>  Obs      (Intercept)      0.01231  0.1110       
>                invx              0.54359  0.7373   -1.00
>  Residual                    3.78661  1.9459       
> Number of obs: 9600, groups:  Obs, 10
> 
> 
> with nlme on uninverted model:
> 
>                       StdDev    Corr 
> A.(Intercept)  0.2514793 A.(I)
> B.(Intercept)  1.1955573 0.428
> Residual        0.4257936      
> 
> Also, the reparameterization complicates a little bit the parameter interpretation. A is still A but now the second parameter becomes B/A.  With nlme, I can test whether there is a fixed effect on both.  Here, I can look at F wrt to the Intercept and F:invx  wrt to invx.  I can live with that.
> 
> Any suggestions for the singular model (I can re-read the isSingular page).
> 
> It's interesting. 
> 
> If you come up with a solution for nlme, I would be interested to see it.
> 
> Thanks.
> 
> Ken
> 
> 
> ###############################
> De Ben Bolker bbo|ker @end|ng |rom gm@||@com
>     I will dig into this if I get a chance, although the nlme code can  be a little scary sometimes.  It might not be possible.     It's not quite the same model but you might be able to hack this in  lme4::glmer or glmmTMB by using a Gaussian model with an  *inverse* link:  that effectively transforms the problem from  y ~ A * x / (x + B)  to  1/y ~ A + (B/A)*(1/x)  but preserves the constant-variance/Gaussian assumption on the original  scale.  On 9/3/25 11:56, Kenneth KNOBLAUCH wrote: > I'm fitting a model  using nlme.  The data frame has 9600 rows and the grouping variable, Obs, has 10 levels.  I fit the following model (names of variables simplified from original) that runs fine: >  > m1 <- nlme(y ~ A * x / (x + B), data = d.df, >                     fixed  = A + B ~ F, >                     random = A + B ~ 1 | Obs, >                     start = list(fixed = c(A = c(2, 0), B = c(15, 0)) )) >  > F is a 2 level factor and A and B parameters to estimate.  This runs fine, too, using SSmicmen(x, A, B) for the right  hand side of the formula.  x and y are numeric variables. >  > I would like to compare model m1 to a model where the correlation between random effects is fixed to 0.  I tried >  > update(m1, random = list(A ~ 1 | Obs, B ~ 1 | Obs)) >  > but I get the following  error message: >  > Error in parse(text = paste("~", paste(nVal, collapse = "/"))) : >    <text>:2:0: unexpected end of input > 1: ~ >     ^ >  > I've also tried with various combinations of the pdMat functions but can't find the right way to specify this.  >  > Simpler models, leaving out one or the other random effect work as well as for leaving out fixed effects after the random effects have been tested. >  > Thank you for any suggestions.
>  
>  De : Kenneth KNOBLAUCH
> Envoy? : mercredi 3 septembre 2025 17:56
> ? : r-sig-mixed-models at r-project.org
> Objet : specifying random effects in nlme with correlation fixed at 0
>    
> I'm fitting a model using nlme.  The data frame has 9600 rows and the grouping variable, Obs, has 10 levels.  I fit the following model (names of variables simplified from original) that runs fine:
> 
> m1 <- nlme(y ~ A * x / (x + B), data = d.df,
>                    fixed = A + B ~ F, 
>                    random = A + B ~ 1 | Obs,
>                    start = list(fixed = c(A = c(2, 0), B = c(15, 0)) ))
> 
> F is a 2 level factor and A and B parameters to estimate.  This runs fine, too, using SSmicmen(x, A, B) for the right hand side of the formula.  x and y are numeric variables.
> 
> I would like to compare model m1 to a model where the correlation between random effects is fixed to 0.  I tried
> 
> update(m1, random = list(A ~ 1 | Obs, B ~ 1 | Obs))
> 
> but I get the following error message:
> 
> Error in parse(text = paste("~", paste(nVal, collapse = "/"))) :
>   <text>:2:0: unexpected end of input
> 1: ~
>    ^
> 
> I've also tried with various combinations of the pdMat functions but can't find the right way to specify this.
> 
> Simpler models, leaving out one or the other random effect work as well as for leaving out fixed effects after the random effects have been tested.
> 
> Thank you for any suggestions.
> 
> Ken
>   ___
>   Kenneth Knoblauch
>  Inserm U1208
>  Stem-cell and Brain Research Institute
>  18 avenue du Doyen L?pine
>  69500 Bron
>  France
>  tel: +33 (0)4 72 91 34 77
>  fax: +33 (0)4 72 91 34 61
>  portable: +33 (0)6 84 10 64 10
>  https://sbri.fr/public-profile/63/single-member/
>             
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models

	[[alternative HTML version deleted]]


From h|gh@t@t @end|ng |rom h|gh@t@t@com  Fri Sep  5 10:57:54 2025
From: h|gh@t@t @end|ng |rom h|gh@t@t@com (Alain Zuur)
Date: Fri, 5 Sep 2025 09:57:54 +0100
Subject: [R-sig-ME] Stats course (hybrid): Introduction to GLLVM -With
 spatial and temporal dependency -
Message-ID: <a6125b70-24d3-4e6d-b379-7e4cb66dc6f4@highstat.com>

We still have some places available on the following hybrid (onsite and 
online) statistics course:

*Course*: Introduction to GLLVM. With spatial and temporal dependency.
*Location: *IPMA, Lisbon, Portugal
*Dates*: 22-26?September 2025
*Teaching times:* Monday-Thursday: 09.000-16.30. Friday: 09.00-13.00
*Flyer*: https://www.highstat.com/Courses/Flyers/Flyer2025_10_GLLVM_IPMA.pdf
*Registration*: www.highstat.com

*Course content*: The central theme of this course is the analysis of 
multiple correlated response (or dependent) variables using GLMs and 
GLMMs. Rather than applying multiple univariate GLMs or GLMMs, we will 
focus on multivariate GLMMs, particularly generalised linear latent 
variable models (GLLVMs), for the simultaneous analysis of all variables.


Kind regards,

Alain Zuur




	[[alternative HTML version deleted]]


From ken@knob|@uch @end|ng |rom |n@erm@|r  Fri Sep  5 12:03:17 2025
From: ken@knob|@uch @end|ng |rom |n@erm@|r (Kenneth KNOBLAUCH)
Date: Fri, 5 Sep 2025 10:03:17 +0000
Subject: [R-sig-ME] 
 specifying random effects in nlme with correlation fixed at 0
In-Reply-To: <262E0E2F-2B34-4E5D-BB27-69EF02BE2707@yahoo.fr>
References: <ddae4f0cdb454d1dae07491588eb63e7@inserm.fr>,
 <262E0E2F-2B34-4E5D-BB27-69EF02BE2707@yahoo.fr>
Message-ID: <b8469327a681466a9cdaf27406321466@inserm.fr>

Thanks.  That's the sort of thing that I am looking for but alas I get the following error message when I try it:


Error in nlme.formula(model = y ~ A * x/(x +  :

  'random' must be a formula or list of formulae


Ken




___

Kenneth Knoblauch
Inserm U1208
Stem-cell and Brain Research Institute
18 avenue du Doyen L?pine
69500 Bron
France
tel: +33 (0)4 72 91 34 77
fax: +33 (0)4 72 91 34 61
portable: +33 (0)6 84 10 64 10

https://sbri.fr/public-profile/63/single-member/


________________________________
De : varin sacha <varinsacha at yahoo.fr>
Envoy? : vendredi 5 septembre 2025 00:21
? : Kenneth KNOBLAUCH
Cc : r-sig-mixed-models at r-project.org
Objet : Re: [R-sig-ME] specifying random effects in nlme with correlation fixed at 0


Hi,


Just a hint. What about forcing 0 correlation ?

This is a way to test the need for a non-zero correlation in nlme.

To fix correlation at 0, we need to specify that the covariance structure is diagonal, not full. That?s what the pdDiag structure is for:

m2 <- update (m1,

  random = list(Obs = pdDiag(~ A + B - 1))

)


? pdDiag() = diagonal positive-definite matrix ? random effects are independent.

? ~ A + B - 1 = random intercepts for A and B separately, no correlation.

? The -1 just removes the intercept term from the pdMat specification.


And then we compare to the correlated version :

anova(m1, m2)


Use anova as a fast diagnostic. We have a likelihood ratio test for whether the correlation parameter is (or not) necessary.

Best,


Le 4 sept. 2025 ? 08:06, Kenneth KNOBLAUCH <ken.knoblauch at inserm.fr> a ?crit :

?Absolutely.   My brain got inverted.  My original response variable, what I'm calling invy, is actually reaction time and I inverted it to get speed, what I'm calling y, for variance stabilization.  Unnecessarily confusing to free my example from its context.

I was pretty sure based on what I've gleaned from web examples that there is a way to do this in nlme using pdMat functions.  I'm away from home but will be back tonight where I can consult Pinheiro and Bates and other references.

Thanks.

Ken


################################
De Ben Bolker bbo|ker @end|ng |rom gm@||@com
I think you shouldn't be using glmer(invy ~ ... ), but glmer(y ~
...); the link function takes care of the inversion for you. By analogy,
you use e.g. glmer(y ~ ..., family = poisson(link = "log")) rather than
glmer(log(y) ~ ... family(poisson(link = "log")) for a log-link Poisson
response.  By using glmer(invy ~ ..., family = gaussian("inverse")) I
think you're actually undoing the transformation (!) because inverse()
is its own (function) inverse ...



 ___
 Kenneth Knoblauch
Inserm U1208
Stem-cell and Brain Research Institute
18 avenue du Doyen L?pine
69500 Bron
France
tel: +33 (0)4 72 91 34 77
fax: +33 (0)4 72 91 34 61
portable: +33 (0)6 84 10 64 10
https://sbri.fr/public-profile/63/single-member/





De : Kenneth KNOBLAUCH
Envoy? : mercredi 3 septembre 2025 20:44
? : r-sig-mixed-models at r-project.org
Objet : RE: specifying random effects in nlme with correlation fixed at 0

Thank you Ben for the rapid response.  I knew about the linearization of the Michelis-Menten function by inverting both sides but I hadn't thought of the inverse link.  Very clever.

I tried

d.df$invx<- 1/d.df$x
d.df$invy <- 1/d.df$y
g1 <- glmer(invy ~ Filter * invx+ (invx | Obs), d.df,
            family = gaussian("inverse"))

I get a singular fit, I guess, because the correlation of random effects is -1, with this parameterization (only about 0.4 with what I was getting using nlme on the uninverted responses).

with glmer on inverted model:
Random effects:
 Groups   Name          Variance Std.Dev. Corr
 Obs      (Intercept)      0.01231  0.1110
               invx              0.54359  0.7373   -1.00
 Residual                    3.78661  1.9459
Number of obs: 9600, groups:  Obs, 10


with nlme on uninverted model:

                      StdDev    Corr
A.(Intercept)  0.2514793 A.(I)
B.(Intercept)  1.1955573 0.428
Residual        0.4257936

Also, the reparameterization complicates a little bit the parameter interpretation. A is still A but now the second parameter becomes B/A.  With nlme, I can test whether there is a fixed effect on both.  Here, I can look at F wrt to the Intercept and F:invx  wrt to invx.  I can live with that.

Any suggestions for the singular model (I can re-read the isSingular page).

It's interesting.

If you come up with a solution for nlme, I would be interested to see it.

Thanks.

Ken


###############################
De Ben Bolker bbo|ker @end|ng |rom gm@||@com
    I will dig into this if I get a chance, although the nlme code can  be a little scary sometimes.  It might not be possible.     It's not quite the same model but you might be able to hack this in  lme4::glmer or glmmTMB by using a Gaussian model with an  *inverse* link:  that effectively transforms the problem from  y ~ A * x / (x + B)  to  1/y ~ A + (B/A)*(1/x)  but preserves the constant-variance/Gaussian assumption on the original  scale.  On 9/3/25 11:56, Kenneth KNOBLAUCH wrote: > I'm fitting a model  using nlme.  The data frame has 9600 rows and the grouping variable, Obs, has 10 levels.  I fit the following model (names of variables simplified from original) that runs fine: >  > m1 <- nlme(y ~ A * x / (x + B), data = d.df, >                     fixed  = A + B ~ F, >                     random = A + B ~ 1 | Obs, >                     start = list(fixed = c(A = c(2, 0), B = c(15, 0)) )) >  > F is a 2 level factor and A and B parameters to estimate.  This runs fine, too, using SSmicmen(x, A, B) for the right  hand side of the formula.  x and y are numeric variables. >  > I would like to compare model m1 to a model where the correlation between random effects is fixed to 0.  I tried >  > update(m1, random = list(A ~ 1 | Obs, B ~ 1 | Obs)) >  > but I get the following  error message: >  > Error in parse(text = paste("~", paste(nVal, collapse = "/"))) : >    <text>:2:0: unexpected end of input > 1: ~ >     ^ >  > I've also tried with various combinations of the pdMat functions but can't find the right way to specify this.  >  > Simpler models, leaving out one or the other random effect work as well as for leaving out fixed effects after the random effects have been tested. >  > Thank you for any suggestions.

 De : Kenneth KNOBLAUCH
Envoy? : mercredi 3 septembre 2025 17:56
? : r-sig-mixed-models at r-project.org
Objet : specifying random effects in nlme with correlation fixed at 0

I'm fitting a model using nlme.  The data frame has 9600 rows and the grouping variable, Obs, has 10 levels.  I fit the following model (names of variables simplified from original) that runs fine:

m1 <- nlme(y ~ A * x / (x + B), data = d.df,
                   fixed = A + B ~ F,
                   random = A + B ~ 1 | Obs,
                   start = list(fixed = c(A = c(2, 0), B = c(15, 0)) ))

F is a 2 level factor and A and B parameters to estimate.  This runs fine, too, using SSmicmen(x, A, B) for the right hand side of the formula.  x and y are numeric variables.

I would like to compare model m1 to a model where the correlation between random effects is fixed to 0.  I tried

update(m1, random = list(A ~ 1 | Obs, B ~ 1 | Obs))

but I get the following error message:

Error in parse(text = paste("~", paste(nVal, collapse = "/"))) :
  <text>:2:0: unexpected end of input
1: ~
   ^

I've also tried with various combinations of the pdMat functions but can't find the right way to specify this.

Simpler models, leaving out one or the other random effect work as well as for leaving out fixed effects after the random effects have been tested.

Thank you for any suggestions.

Ken
  ___
  Kenneth Knoblauch
 Inserm U1208
 Stem-cell and Brain Research Institute
 18 avenue du Doyen L?pine
 69500 Bron
 France
 tel: +33 (0)4 72 91 34 77
 fax: +33 (0)4 72 91 34 61
 portable: +33 (0)6 84 10 64 10
 https://sbri.fr/public-profile/63/single-member/

_______________________________________________
R-sig-mixed-models at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models

	[[alternative HTML version deleted]]


From v@r|n@@ch@ @end|ng |rom y@hoo@|r  Fri Sep  5 14:54:58 2025
From: v@r|n@@ch@ @end|ng |rom y@hoo@|r (varin sacha)
Date: Fri, 5 Sep 2025 14:54:58 +0200
Subject: [R-sig-ME] 
 specifying random effects in nlme with correlation fixed at 0
In-Reply-To: <b8469327a681466a9cdaf27406321466@inserm.fr>
References: <b8469327a681466a9cdaf27406321466@inserm.fr>
Message-ID: <B181C7C3-1E07-45E7-BF08-30AEF9DCB875@yahoo.fr>

Hi,

Try dropping the -1 and we should get a valid diagonal structure: random effects for A and B with no correlation.

m2 <- update(m1,

  random = list(Obs = pdDiag(~ A + B))

)

Hope it works. 

Best,




> Le 5 sept. 2025 ? 12:03, Kenneth KNOBLAUCH <ken.knoblauch at inserm.fr> a ?crit :
> ?
> Thanks.  That's the sort of thing that I am looking for but alas I get the following error message when I try it:
> 
> 
> 
> Error in nlme.formula(model = y ~ A * x/(x +  : 
> 
>   'random' must be a formula or list of formulae
> 
> 
> 
> Ken
> 
> 
> 
> 
> 
> 
> ___
> 
> Kenneth Knoblauch
> Inserm U1208
> Stem-cell and Brain Research Institute
> 18 avenue du Doyen L?pine
> 69500 Bron
> France
> tel: +33 (0)4 72 91 34 77
> fax: +33 (0)4 72 91 34 61
> portable: +33 (0)6 84 10 64 10
> 
> https://sbri.fr/public-profile/63/single-member/
> 
> 
> 
> De : varin sacha <varinsacha at yahoo.fr>
> Envoy? : vendredi 5 septembre 2025 00:21
> ? : Kenneth KNOBLAUCH
> Cc : r-sig-mixed-models at r-project.org
> Objet : Re: [R-sig-ME] specifying random effects in nlme with correlation fixed at 0
>  
> Hi,
> 
> 
> 
> Just a hint. What about forcing 0 correlation ? 
> 
> This is a way to test the need for a non-zero correlation in nlme.
> 
> To fix correlation at 0, we need to specify that the covariance structure is diagonal, not full. That?s what the pdDiag structure is for:
> 
> m2 <- update (m1,
> 
>   random = list(Obs = pdDiag(~ A + B - 1))
> 
> )
> 
> 
> 
> ? pdDiag() = diagonal positive-definite matrix ? random effects are independent.
> 
> ? ~ A + B - 1 = random intercepts for A and B separately, no correlation.
> 
> ? The -1 just removes the intercept term from the pdMat specification.
> 
> 
> 
> And then we compare to the correlated version :
> 
> anova(m1, m2)
> 
> 
> 
> Use anova as a fast diagnostic. We have a likelihood ratio test for whether the correlation parameter is (or not) necessary.
> 
> Best,
> 
> 
> 
> 
>> Le 4 sept. 2025 ? 08:06, Kenneth KNOBLAUCH <ken.knoblauch at inserm.fr> a ?crit :
>> ?Absolutely.   My brain got inverted.  My original response variable, what I'm calling invy, is actually reaction time and I inverted it to get speed, what I'm calling y, for variance stabilization.  Unnecessarily confusing to free my example from its context.
>> 
>> I was pretty sure based on what I've gleaned from web examples that there is a way to do this in nlme using pdMat functions.  I'm away from home but will be back tonight where I can consult Pinheiro and Bates and other references.
>> 
>> Thanks.
>> 
>> Ken
>> 
>> 
>> ################################
>> De Ben Bolker bbo|ker @end|ng |rom gm@||@com
>> I think you shouldn't be using glmer(invy ~ ... ), but glmer(y ~
>> ...); the link function takes care of the inversion for you. By analogy,
>> you use e.g. glmer(y ~ ..., family = poisson(link = "log")) rather than
>> glmer(log(y) ~ ... family(poisson(link = "log")) for a log-link Poisson
>> response.  By using glmer(invy ~ ..., family = gaussian("inverse")) I
>> think you're actually undoing the transformation (!) because inverse()
>> is its own (function) inverse ...
>> 
>> 
>> 
>>  ___
>>  Kenneth Knoblauch
>> Inserm U1208
>> Stem-cell and Brain Research Institute
>> 18 avenue du Doyen L?pine
>> 69500 Bron
>> France
>> tel: +33 (0)4 72 91 34 77
>> fax: +33 (0)4 72 91 34 61
>> portable: +33 (0)6 84 10 64 10
>> https://sbri.fr/public-profile/63/single-member/
>> 
>> 
>> 
>> 
>> 
>> De : Kenneth KNOBLAUCH
>> Envoy? : mercredi 3 septembre 2025 20:44
>> ? : r-sig-mixed-models at r-project.org
>> Objet : RE: specifying random effects in nlme with correlation fixed at 0
>>     
>> Thank you Ben for the rapid response.  I knew about the linearization of the Michelis-Menten function by inverting both sides but I hadn't thought of the inverse link.  Very clever.
>> 
>> I tried
>> 
>> d.df$invx<- 1/d.df$x
>> d.df$invy <- 1/d.df$y
>> g1 <- glmer(invy ~ Filter * invx+ (invx | Obs), d.df,
>>             family = gaussian("inverse"))
>> 
>> I get a singular fit, I guess, because the correlation of random effects is -1, with this parameterization (only about 0.4 with what I was getting using nlme on the uninverted responses).
>> 
>> with glmer on inverted model:
>> Random effects:
>>  Groups   Name          Variance Std.Dev. Corr
>>  Obs      (Intercept)      0.01231  0.1110       
>>                invx              0.54359  0.7373   -1.00
>>  Residual                    3.78661  1.9459       
>> Number of obs: 9600, groups:  Obs, 10
>> 
>> 
>> with nlme on uninverted model:
>> 
>>                       StdDev    Corr 
>> A.(Intercept)  0.2514793 A.(I)
>> B.(Intercept)  1.1955573 0.428
>> Residual        0.4257936      
>> 
>> Also, the reparameterization complicates a little bit the parameter interpretation. A is still A but now the second parameter becomes B/A.  With nlme, I can test whether there is a fixed effect on both.  Here, I can look at F wrt to the Intercept and F:invx  wrt to invx.  I can live with that.
>> 
>> Any suggestions for the singular model (I can re-read the isSingular page).
>> 
>> It's interesting. 
>> 
>> If you come up with a solution for nlme, I would be interested to see it.
>> 
>> Thanks.
>> 
>> Ken
>> 
>> 
>> ###############################
>> De Ben Bolker bbo|ker @end|ng |rom gm@||@com
>>     I will dig into this if I get a chance, although the nlme code can  be a little scary sometimes.  It might not be possible.     It's not quite the same model but you might be able to hack this in  lme4::glmer or glmmTMB by using a Gaussian model with an  *inverse* link:  that effectively transforms the problem from  y ~ A * x / (x + B)  to  1/y ~ A + (B/A)*(1/x)  but preserves the constant-variance/Gaussian assumption on the original  scale.  On 9/3/25 11:56, Kenneth KNOBLAUCH wrote: > I'm fitting a model  using nlme.  The data frame has 9600 rows and the grouping variable, Obs, has 10 levels.  I fit the following model (names of variables simplified from original) that runs fine: >  > m1 <- nlme(y ~ A * x / (x + B), data = d.df, >                     fixed  = A + B ~ F, >                     random = A + B ~ 1 | Obs, >                     start = list(fixed = c(A = c(2, 0), B = c(15, 0)) )) >  > F is a 2 level factor and A and B parameters to estimate.  This runs fine, too, using SSmicmen(x, A, B) for the right  hand side of the formula.  x and y are numeric variables. >  > I would like to compare model m1 to a model where the correlation between random effects is fixed to 0.  I tried >  > update(m1, random = list(A ~ 1 | Obs, B ~ 1 | Obs)) >  > but I get the following  error message: >  > Error in parse(text = paste("~", paste(nVal, collapse = "/"))) : >    <text>:2:0: unexpected end of input > 1: ~ >     ^ >  > I've also tried with various combinations of the pdMat functions but can't find the right way to specify this.  >  > Simpler models, leaving out one or the other random effect work as well as for leaving out fixed effects after the random effects have been tested. >  > Thank you for any suggestions.
>>  
>>  De : Kenneth KNOBLAUCH
>> Envoy? : mercredi 3 septembre 2025 17:56
>> ? : r-sig-mixed-models at r-project.org
>> Objet : specifying random effects in nlme with correlation fixed at 0
>>    
>> I'm fitting a model using nlme.  The data frame has 9600 rows and the grouping variable, Obs, has 10 levels.  I fit the following model (names of variables simplified from original) that runs fine:
>> 
>> m1 <- nlme(y ~ A * x / (x + B), data = d.df,
>>                    fixed = A + B ~ F, 
>>                    random = A + B ~ 1 | Obs,
>>                    start = list(fixed = c(A = c(2, 0), B = c(15, 0)) ))
>> 
>> F is a 2 level factor and A and B parameters to estimate.  This runs fine, too, using SSmicmen(x, A, B) for the right hand side of the formula.  x and y are numeric variables.
>> 
>> I would like to compare model m1 to a model where the correlation between random effects is fixed to 0.  I tried
>> 
>> update(m1, random = list(A ~ 1 | Obs, B ~ 1 | Obs))
>> 
>> but I get the following error message:
>> 
>> Error in parse(text = paste("~", paste(nVal, collapse = "/"))) :
>>   <text>:2:0: unexpected end of input
>> 1: ~
>>    ^
>> 
>> I've also tried with various combinations of the pdMat functions but can't find the right way to specify this.
>> 
>> Simpler models, leaving out one or the other random effect work as well as for leaving out fixed effects after the random effects have been tested.
>> 
>> Thank you for any suggestions.
>> 
>> Ken
>>   ___
>>   Kenneth Knoblauch
>>  Inserm U1208
>>  Stem-cell and Brain Research Institute
>>  18 avenue du Doyen L?pine
>>  69500 Bron
>>  France
>>  tel: +33 (0)4 72 91 34 77
>>  fax: +33 (0)4 72 91 34 61
>>  portable: +33 (0)6 84 10 64 10
>>  https://sbri.fr/public-profile/63/single-member/
>>             
>> _______________________________________________
>> R-sig-mixed-models at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models

	[[alternative HTML version deleted]]


From ken@knob|@uch @end|ng |rom |n@erm@|r  Sat Sep  6 14:04:55 2025
From: ken@knob|@uch @end|ng |rom |n@erm@|r (Kenneth KNOBLAUCH)
Date: Sat, 6 Sep 2025 12:04:55 +0000
Subject: [R-sig-ME] 
 specifying random effects in nlme with correlation fixed at 0
In-Reply-To: <B181C7C3-1E07-45E7-BF08-30AEF9DCB875@yahoo.fr>
References: <b8469327a681466a9cdaf27406321466@inserm.fr>,
 <B181C7C3-1E07-45E7-BF08-30AEF9DCB875@yahoo.fr>
Message-ID: <586677fc5a4a4a7faa13c73298412daa@inserm.fr>

I thank Ben and Sacha for their suggestions. ?

This is the random argument of nlme?that I found ran without error and provides results that seem to make sense to:

random =?list(Obs = pdDiag(list(A ~ 1, B ~ 1)))

The model with that random argument gave:

Random effects:
?Formula: list(A ~ 1, B ~ 1)
?Level: Obs
?Structure: Diagonal
? ? ? ? A.(Intercept) B.(Intercept) ?Residual
StdDev: ? ? ?0.2403019 ? ? ? 1.105224 0.4258117

so no correlation, and the model didn't differ significantly from the saturated model using the anova method.  If anyone sees a problem with that approach, I'd appreciate your feedback. 

Thanks, again, for your suggestions and help.

best,

Ken
 _
  Kenneth Knoblauch
 Inserm U1208
 Stem-cell and Brain Research Institute
 18 avenue du Doyen L?pine
 69500 Bron
 France
 tel: +33 (0)4 72 91 34 77
 fax: +33 (0)4 72 91 34 61
 portable: +33 (0)6 84 10 64 10
 https://sbri.fr/public-profile/63/single-member/
    



De : varin sacha <varinsacha at yahoo.fr>
Envoy? : vendredi 5 septembre 2025 14:54
? : Kenneth KNOBLAUCH
Cc?: r-sig-mixed-models at r-project.org
Objet : Re: [R-sig-ME] specifying random effects in nlme with correlation fixed at 0
? 




Hi,


Try dropping the -1 and we should get a valid diagonal structure: random effects for A and B with no correlation.
m2 <- update(m1,
? random = list(Obs = pdDiag(~ A + B))

)
Hope it works.?
Best,


  


 

Le 5 sept. 2025 ? 12:03, Kenneth KNOBLAUCH <ken.knoblauch at inserm.fr> a ?crit?:

  
?
Thanks. ?That's the sort of thing that I am looking for but alas I get the following error message when I try it:

Error in nlme.formula(model = y?~?A?*?x/(x?+??:?
? 'random' must be a formula or list of formulae

Ken






___
Kenneth Knoblauch
Inserm U1208
Stem-cell and Brain Research Institute
18 avenue du Doyen L?pine
69500 Bron
France
tel: +33 (0)4 72 91 34 77
fax: +33 (0)4 72 91 34 61
portable: +33 (0)6 84 10 64 10
https://sbri.fr/public-profile/63/single-member/
  



De : varin sacha <varinsacha at yahoo.fr>
Envoy? : vendredi 5 septembre 2025 00:21
? : Kenneth KNOBLAUCH
Cc?: r-sig-mixed-models at r-project.org
Objet : Re: [R-sig-ME] specifying random effects in nlme with correlation fixed at 0
? 


Hi,

Just a hint.?What about forcing 0 correlation ??
This is a way to test the need for a non-zero correlation in nlme.
To fix correlation at 0, we need to specify that the covariance structure is diagonal, not full. That?s what the pdDiag structure is for:
m2 <- update (m1,
? random = list(Obs = pdDiag(~ A + B - 1))
)

? pdDiag() = diagonal positive-definite matrix ? random effects are independent.
? ~ A + B - 1 = random intercepts for A and B separately, no correlation.
? The -1 just removes the intercept term from the pdMat specification.


And then we compare to the correlated version :
anova(m1, m2)


Use anova as a fast diagnostic. We have a likelihood ratio test for whether the correlation parameter is (or not) necessary.
Best,

 


  
Le 4 sept. 2025 ? 08:06, Kenneth KNOBLAUCH <ken.knoblauch at inserm.fr> a ?crit?:

  
?Absolutely. ??My brain got inverted. ?My original response variable, what I'm calling invy, is actually reaction time and I inverted it to get speed, what I'm calling y, for variance stabilization. ?Unnecessarily confusing to free my example  from its context.

I was pretty sure based on what I've gleaned from web examples that there is a way to do this in nlme using pdMat functions. ?I'm away from home but will be back tonight where I can consult Pinheiro and Bates and other references.

Thanks.

Ken


################################
De Ben Bolker bbo|ker @end|ng |rom gm@||@com
I think you shouldn't be using glmer(invy ~ ... ), but glmer(y ~ 
...); the link function takes care of the inversion for you. By analogy, 
you use e.g. glmer(y ~ ..., family = poisson(link = "log")) rather than
glmer(log(y) ~ ... family(poisson(link = "log")) for a log-link Poisson 
response. ?By using glmer(invy ~ ..., family = gaussian("inverse")) I 
think you're actually undoing the transformation (!) because inverse() 
is its own (function) inverse ...



?___
?Kenneth Knoblauch
Inserm U1208
Stem-cell and Brain Research Institute
18 avenue du Doyen L?pine
69500 Bron
France
tel: +33 (0)4 72 91 34 77
fax: +33 (0)4 72 91 34 61
portable: +33 (0)6 84 10 64 10
https://sbri.fr/public-profile/63/single-member/





De : Kenneth KNOBLAUCH
Envoy? : mercredi 3 septembre 2025 20:44
? : r-sig-mixed-models at r-project.org
Objet : RE: specifying random effects in nlme with correlation fixed at 0
? ??
Thank you Ben for the rapid response.? I knew about the linearization of the Michelis-Menten function by inverting both sides but I hadn't thought of the inverse link.? Very clever.

I tried

d.df$invx<- 1/d.df$x
d.df$invy <- 1/d.df$y
g1 <- glmer(invy ~ Filter * invx+ (invx | Obs), d.df, 
??????????? family = gaussian("inverse"))

I get a singular fit, I guess, because the correlation of random effects is -1, with this parameterization (only about 0.4 with what I was getting using nlme on the uninverted responses).

with glmer on inverted model:
Random effects:
?Groups?? Name????????? Variance Std.Dev. Corr 
?Obs????? (Intercept)????? 0.01231? 0.1110??????? 
?????????????? invx????????????? 0.54359? 0.7373?? -1.00
?Residual??????????????????? 3.78661? 1.9459??????? 
Number of obs: 9600, groups:? Obs, 10


with nlme on uninverted model:

????????????????????? StdDev??? Corr? 
A.(Intercept)? 0.2514793 A.(I)
B.(Intercept)? 1.1955573 0.428 
Residual??????? 0.4257936?????? 

Also, the reparameterization complicates a little bit the parameter interpretation. A is still A but now the second parameter becomes B/A.? With nlme, I can test whether there is a fixed effect on both.? Here, I can look at F wrt to the Intercept and  F:invx ?wrt to invx.? I can live with that.

Any suggestions for the singular model (I can re-read the isSingular page).

It's interesting.? 

If you come up with a solution for nlme, I would be interested to see it.

Thanks.

Ken


###############################
De Ben Bolker bbo|ker @end|ng |rom gm@||@com
??? I will dig into this if I get a chance, although the nlme code can? be a little scary sometimes.? It might not be possible.???? It's not quite the same model but you might be able to hack this in? lme4::glmer or glmmTMB by using a Gaussian model with  an ?*inverse* link:? that effectively transforms the problem from? y ~ A * x / (x + B)? to? 1/y ~ A + (B/A)*(1/x)? but preserves the constant-variance/Gaussian assumption on the original? scale.? On 9/3/25 11:56, Kenneth KNOBLAUCH wrote: > I'm fitting a model  ?using nlme. ?The data frame has 9600 rows and the grouping variable, Obs, has 10 levels. ?I fit the following model (names of variables simplified from original) that runs fine: >? > m1 <-?nlme(y ~ A * x / (x + B), data = d.df, >???????????????????? fixed  ?= A + B ~ F, >???????????????????? random = A + B ~ 1 | Obs, >???????????????????? start = list(fixed = c(A = c(2, 0), B = c(15, 0)) )) >? > F is a 2 level factor and A and B parameters to estimate.? This runs fine, too, using SSmicmen(x, A, B) for the right  ?hand side of the formula.? x and y are numeric variables. >? > I would like to compare model m1 to a model where the correlation between random effects is fixed to 0.? I tried >? > update(m1, random = list(A ~ 1 | Obs, B ~ 1 | Obs)) >? > but I get the following  ?error message: >? > Error in parse(text = paste("~", paste(nVal, collapse = "/"))) : >??? <text>:2:0: unexpected end of input > 1: ~ >???? ^ >? > I've also tried with various combinations of the pdMat functions but can't find the right way to specify this.  ?>? > Simpler models, leaving out one or the other random effect work as well as for leaving out fixed effects after the random effects have been tested. >? > Thank you for any suggestions.
? 
?De : Kenneth KNOBLAUCH
Envoy? : mercredi 3 septembre 2025 17:56
? : r-sig-mixed-models at r-project.org
Objet : specifying random effects in nlme with correlation fixed at 0
??? 
I'm fitting a model using nlme. ?The data frame has 9600 rows and the grouping variable, Obs, has 10 levels. ?I fit the following model (names of variables simplified from original) that runs fine:

m1 <-?nlme(y ~ A * x / (x + B), data = d.df,
?????????????????? fixed = A + B ~ F,? 
?????????????????? random = A + B ~ 1 | Obs,
?????????????????? start = list(fixed = c(A = c(2, 0), B = c(15, 0)) ))

F is a 2 level factor and A and B parameters to estimate.? This runs fine, too, using SSmicmen(x, A, B) for the right hand side of the formula.? x and y are numeric variables.

I would like to compare model m1 to a model where the correlation between random effects is fixed to 0.? I tried

update(m1, random = list(A ~ 1 | Obs, B ~ 1 | Obs))

but I get the following error message:

Error in parse(text = paste("~", paste(nVal, collapse = "/"))) : 
? <text>:2:0: unexpected end of input
1: ~ 
?? ^

I've also tried with various combinations of the pdMat functions but can't find the right way to specify this.

Simpler models, leaving out one or the other random effect work as well as for leaving out fixed effects after the random effects have been tested.

Thank you for any suggestions.

Ken
? ___
? Kenneth Knoblauch
?Inserm U1208
?Stem-cell and Brain Research Institute
?18 avenue du Doyen L?pine
?69500 Bron
?France
?tel: +33 (0)4 72 91 34 77
?fax: +33 (0)4 72 91 34 61
?portable: +33 (0)6 84 10 64 10
?https://sbri.fr/public-profile/63/single-member/
??????? ????
_______________________________________________
R-sig-mixed-models at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
           

From v@r|n@@ch@ @end|ng |rom y@hoo@|r  Sat Sep  6 18:21:34 2025
From: v@r|n@@ch@ @end|ng |rom y@hoo@|r (varin sacha)
Date: Sat, 6 Sep 2025 18:21:34 +0200
Subject: [R-sig-ME] 
 specifying random effects in nlme with correlation fixed at 0
In-Reply-To: <586677fc5a4a4a7faa13c73298412daa@inserm.fr>
References: <586677fc5a4a4a7faa13c73298412daa@inserm.fr>
Message-ID: <F0CEF914-4B77-4B80-8D00-36A2811C8506@yahoo.fr>

Hi,

A few comments :

1. I would not over-interpret anova(m_full, m_diag) ?? p-value for testing whether the covariance is zero. Because covariance lives on a boundary, the usual ?? approximation can be misleading. If you care about a formal test, use a parametric bootstrap LRT (simulate under the diagonal model, refit both, build empirical LRT distribution).

2. Check diagnostics: plot(m2) (residuals vs fitted), qqnorm(resid(m2)) or qqnorm(m2) to confirm assumptions.

# basic residual plots
plot(m2, resid(.) ~ fitted(.) | Obs, abline = 0)   # residuals vs fitted by group
qqnorm(resid(m2, type = "normalized")); qqline(resid(m2, type="normalized"))

# global residual vs fitted
plot(fitted(m2), resid(m2)); abline(h = 0, col = "red")


3. Inspect variance components:

VarCorr(m2)        # variances / stddev (no correlation printed for pdDiag)
getVarCov(m2)      # covariance matrix for random effects (group-level)
intervals(m2)      # approximate CIs for fixed effects & variance parameters

Check that the random-effect variances are meaningfully > 0 (not effectively zero).


4. If you want a quick model-selection rule instead of a formal test, compare AIC or BIC (m1, m2) (pragmatic) but report the bootstrap if you claim a hypothesis test.

AIC(m1, m2)
BIC(m1, m2)

Rule of thumb: ?AIC ? 4?7 is moderate evidence; ?10 strong evidence for the lower-AIC model.

If AIC/BIC and diagnostics both favor m2 (or m1), that?s usually sufficient for reporting model choice; but for formal claims about correlation = 0, quote the bootstrap p-value/CI.

Best


> Le 6 sept. 2025 ? 14:04, Kenneth KNOBLAUCH <ken.knoblauch at inserm.fr> a ?crit :
> 
> ?I thank Ben and Sacha for their suggestions.  
> 
> This is the random argument of nlme that I found ran without error and provides results that seem to make sense to:
> 
> random = list(Obs = pdDiag(list(A ~ 1, B ~ 1)))
> 
> The model with that random argument gave:
> 
> Random effects:
>  Formula: list(A ~ 1, B ~ 1)
>  Level: Obs
>  Structure: Diagonal
>         A.(Intercept) B.(Intercept)  Residual
> StdDev:      0.2403019       1.105224 0.4258117
> 
> so no correlation, and the model didn't differ significantly from the saturated model using the anova method.  If anyone sees a problem with that approach, I'd appreciate your feedback.
> 
> Thanks, again, for your suggestions and help.
> 
> best,
> 
> Ken
> _
>  Kenneth Knoblauch
> Inserm U1208
> Stem-cell and Brain Research Institute
> 18 avenue du Doyen L?pine
> 69500 Bron
> France
> tel: +33 (0)4 72 91 34 77
> fax: +33 (0)4 72 91 34 61
> portable: +33 (0)6 84 10 64 10
> https://sbri.fr/public-profile/63/single-member/
> 
> 
> 
> 
> De : varin sacha <varinsacha at yahoo.fr>
> Envoy? : vendredi 5 septembre 2025 14:54
> ? : Kenneth KNOBLAUCH
> Cc : r-sig-mixed-models at r-project.org
> Objet : Re: [R-sig-ME] specifying random effects in nlme with correlation fixed at 0
>  
> 
> 
> 
> 
> Hi,
> 
> 
> Try dropping the -1 and we should get a valid diagonal structure: random effects for A and B with no correlation.
> m2 <- update(m1,
>   random = list(Obs = pdDiag(~ A + B))
> 
> )
> Hope it works. 
> Best,
> 
> 
> 
> 
> 
> 
> 
> Le 5 sept. 2025 ? 12:03, Kenneth KNOBLAUCH <ken.knoblauch at inserm.fr> a ?crit :
> 
> 
> ?
> Thanks.  That's the sort of thing that I am looking for but alas I get the following error message when I try it:
> 
> Error in nlme.formula(model = y ~ A * x/(x +  : 
>   'random' must be a formula or list of formulae
> 
> Ken
> 
> 
> 
> 
> 
> 
> ___
> Kenneth Knoblauch
> Inserm U1208
> Stem-cell and Brain Research Institute
> 18 avenue du Doyen L?pine
> 69500 Bron
> France
> tel: +33 (0)4 72 91 34 77
> fax: +33 (0)4 72 91 34 61
> portable: +33 (0)6 84 10 64 10
> https://sbri.fr/public-profile/63/single-member/
> 
> 
> 
> 
> De : varin sacha <varinsacha at yahoo.fr>
> Envoy? : vendredi 5 septembre 2025 00:21
> ? : Kenneth KNOBLAUCH
> Cc : r-sig-mixed-models at r-project.org
> Objet : Re: [R-sig-ME] specifying random effects in nlme with correlation fixed at 0
>  
> 
> 
> Hi,
> 
> Just a hint. What about forcing 0 correlation ? 
> This is a way to test the need for a non-zero correlation in nlme.
> To fix correlation at 0, we need to specify that the covariance structure is diagonal, not full. That?s what the pdDiag structure is for:
> m2 <- update (m1,
>   random = list(Obs = pdDiag(~ A + B - 1))
> )
> 
> ? pdDiag() = diagonal positive-definite matrix ? random effects are independent.
> ? ~ A + B - 1 = random intercepts for A and B separately, no correlation.
> ? The -1 just removes the intercept term from the pdMat specification.
> 
> 
> And then we compare to the correlated version :
> anova(m1, m2)
> 
> 
> Use anova as a fast diagnostic. We have a likelihood ratio test for whether the correlation parameter is (or not) necessary.
> Best,
> 
> 
> 
> 
> 
> Le 4 sept. 2025 ? 08:06, Kenneth KNOBLAUCH <ken.knoblauch at inserm.fr> a ?crit :
> 
> 
> ?Absolutely.   My brain got inverted.  My original response variable, what I'm calling invy, is actually reaction time and I inverted it to get speed, what I'm calling y, for variance stabilization.  Unnecessarily confusing to free my example  from its context.
> 
> I was pretty sure based on what I've gleaned from web examples that there is a way to do this in nlme using pdMat functions.  I'm away from home but will be back tonight where I can consult Pinheiro and Bates and other references.
> 
> Thanks.
> 
> Ken
> 
> 
> ################################
> De Ben Bolker bbo|ker @end|ng |rom gm@||@com
> I think you shouldn't be using glmer(invy ~ ... ), but glmer(y ~
> ...); the link function takes care of the inversion for you. By analogy,
> you use e.g. glmer(y ~ ..., family = poisson(link = "log")) rather than
> glmer(log(y) ~ ... family(poisson(link = "log")) for a log-link Poisson
> response.  By using glmer(invy ~ ..., family = gaussian("inverse")) I
> think you're actually undoing the transformation (!) because inverse()
> is its own (function) inverse ...
> 
> 
> 
>  ___
>  Kenneth Knoblauch
> Inserm U1208
> Stem-cell and Brain Research Institute
> 18 avenue du Doyen L?pine
> 69500 Bron
> France
> tel: +33 (0)4 72 91 34 77
> fax: +33 (0)4 72 91 34 61
> portable: +33 (0)6 84 10 64 10
> https://sbri.fr/public-profile/63/single-member/
> 
> 
> 
> 
> 
> De : Kenneth KNOBLAUCH
> Envoy? : mercredi 3 septembre 2025 20:44
> ? : r-sig-mixed-models at r-project.org
> Objet : RE: specifying random effects in nlme with correlation fixed at 0
>     
> Thank you Ben for the rapid response.  I knew about the linearization of the Michelis-Menten function by inverting both sides but I hadn't thought of the inverse link.  Very clever.
> 
> I tried
> 
> d.df$invx<- 1/d.df$x
> d.df$invy <- 1/d.df$y
> g1 <- glmer(invy ~ Filter * invx+ (invx | Obs), d.df,
>             family = gaussian("inverse"))
> 
> I get a singular fit, I guess, because the correlation of random effects is -1, with this parameterization (only about 0.4 with what I was getting using nlme on the uninverted responses).
> 
> with glmer on inverted model:
> Random effects:
>  Groups   Name          Variance Std.Dev. Corr
>  Obs      (Intercept)      0.01231  0.1110       
>                invx              0.54359  0.7373   -1.00
>  Residual                    3.78661  1.9459       
> Number of obs: 9600, groups:  Obs, 10
> 
> 
> with nlme on uninverted model:
> 
>                       StdDev    Corr 
> A.(Intercept)  0.2514793 A.(I)
> B.(Intercept)  1.1955573 0.428
> Residual        0.4257936      
> 
> Also, the reparameterization complicates a little bit the parameter interpretation. A is still A but now the second parameter becomes B/A.  With nlme, I can test whether there is a fixed effect on both.  Here, I can look at F wrt to the Intercept and  F:invx  wrt to invx.  I can live with that.
> 
> Any suggestions for the singular model (I can re-read the isSingular page).
> 
> It's interesting. 
> 
> If you come up with a solution for nlme, I would be interested to see it.
> 
> Thanks.
> 
> Ken
> 
> 
> ###############################
> De Ben Bolker bbo|ker @end|ng |rom gm@||@com
>     I will dig into this if I get a chance, although the nlme code can  be a little scary sometimes.  It might not be possible.     It's not quite the same model but you might be able to hack this in  lme4::glmer or glmmTMB by using a Gaussian model with  an  *inverse* link:  that effectively transforms the problem from  y ~ A * x / (x + B)  to  1/y ~ A + (B/A)*(1/x)  but preserves the constant-variance/Gaussian assumption on the original  scale.  On 9/3/25 11:56, Kenneth KNOBLAUCH wrote: > I'm fitting a model   using nlme.  The data frame has 9600 rows and the grouping variable, Obs, has 10 levels.  I fit the following model (names of variables simplified from original) that runs fine: >  > m1 <- nlme(y ~ A * x / (x + B), data = d.df, >                     fixed   = A + B ~ F, >                     random = A + B ~ 1 | Obs, >                     start = list(fixed = c(A = c(2, 0), B = c(15, 0)) )) >  > F is a 2 level factor and A and B parameters to estimate.  This runs fine, too, using SSmicmen(x, A, B) for the right   hand side of the formula.  x and y are numeric variables. >  > I would like to compare model m1 to a model where the correlation between random effects is fixed to 0.  I tried >  > update(m1, random = list(A ~ 1 | Obs, B ~ 1 | Obs)) >  > but I get the following   error message: >  > Error in parse(text = paste("~", paste(nVal, collapse = "/"))) : >    <text>:2:0: unexpected end of input > 1: ~ >     ^ >  > I've also tried with various combinations of the pdMat functions but can't find the right way to specify this.   >  > Simpler models, leaving out one or the other random effect work as well as for leaving out fixed effects after the random effects have been tested. >  > Thank you for any suggestions.
>  
>  De : Kenneth KNOBLAUCH
> Envoy? : mercredi 3 septembre 2025 17:56
> ? : r-sig-mixed-models at r-project.org
> Objet : specifying random effects in nlme with correlation fixed at 0
>    
> I'm fitting a model using nlme.  The data frame has 9600 rows and the grouping variable, Obs, has 10 levels.  I fit the following model (names of variables simplified from original) that runs fine:
> 
> m1 <- nlme(y ~ A * x / (x + B), data = d.df,
>                    fixed = A + B ~ F, 
>                    random = A + B ~ 1 | Obs,
>                    start = list(fixed = c(A = c(2, 0), B = c(15, 0)) ))
> 
> F is a 2 level factor and A and B parameters to estimate.  This runs fine, too, using SSmicmen(x, A, B) for the right hand side of the formula.  x and y are numeric variables.
> 
> I would like to compare model m1 to a model where the correlation between random effects is fixed to 0.  I tried
> 
> update(m1, random = list(A ~ 1 | Obs, B ~ 1 | Obs))
> 
> but I get the following error message:
> 
> Error in parse(text = paste("~", paste(nVal, collapse = "/"))) :
>   <text>:2:0: unexpected end of input
> 1: ~
>    ^
> 
> I've also tried with various combinations of the pdMat functions but can't find the right way to specify this.
> 
> Simpler models, leaving out one or the other random effect work as well as for leaving out fixed effects after the random effects have been tested.
> 
> Thank you for any suggestions.
> 
> Ken
>   ___
>   Kenneth Knoblauch
>  Inserm U1208
>  Stem-cell and Brain Research Institute
>  18 avenue du Doyen L?pine
>  69500 Bron
>  France
>  tel: +33 (0)4 72 91 34 77
>  fax: +33 (0)4 72 91 34 61
>  portable: +33 (0)6 84 10 64 10
>  https://sbri.fr/public-profile/63/single-member/
>             
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models


From ken@knob|@uch @end|ng |rom |n@erm@|r  Sun Sep  7 15:15:04 2025
From: ken@knob|@uch @end|ng |rom |n@erm@|r (Kenneth KNOBLAUCH)
Date: Sun, 7 Sep 2025 13:15:04 +0000
Subject: [R-sig-ME] 
 specifying random effects in nlme with correlation fixed at 0
In-Reply-To: <F0CEF914-4B77-4B80-8D00-36A2811C8506@yahoo.fr>
References: <586677fc5a4a4a7faa13c73298412daa@inserm.fr>,
 <F0CEF914-4B77-4B80-8D00-36A2811C8506@yahoo.fr>
Message-ID: <6628b814312a476fb0dc2c0808730c13@inserm.fr>

Duly noted.  Thank you.

best,

Ken


     
  
 
  ___
  Kenneth Knoblauch
 Inserm U1208
 Stem-cell and Brain Research Institute
 18 avenue du Doyen L?pine
 69500 Bron
 France
 tel: +33 (0)4 72 91 34 77
 fax: +33 (0)4 72 91 34 61
 portable: +33 (0)6 84 10 64 10
 https://sbri.fr/public-profile/63/single-member/
    




De : varin sacha <varinsacha at yahoo.fr>
Envoy? : samedi 6 septembre 2025 18:21
? : Kenneth KNOBLAUCH
Cc?: r-sig-mixed-models at r-project.org
Objet : Re: [R-sig-ME] specifying random effects in nlme with correlation fixed at 0
?   
Hi,

A few comments :

1. I would not over-interpret anova(m_full, m_diag) ?? p-value for testing whether the covariance is zero. Because covariance lives on a boundary, the usual ?? approximation can be misleading. If you care about a formal test, use a parametric bootstrap LRT  (simulate under the diagonal model, refit both, build empirical LRT distribution).

2. Check diagnostics: plot(m2) (residuals vs fitted), qqnorm(resid(m2)) or qqnorm(m2) to confirm assumptions.

# basic residual plots
plot(m2, resid(.) ~ fitted(.) | Obs, abline = 0)?? # residuals vs fitted by group
qqnorm(resid(m2, type = "normalized")); qqline(resid(m2, type="normalized"))

# global residual vs fitted
plot(fitted(m2), resid(m2)); abline(h = 0, col = "red")


3. Inspect variance components:

VarCorr(m2)??????? # variances / stddev (no correlation printed for pdDiag)
getVarCov(m2)????? # covariance matrix for random effects (group-level)
intervals(m2)????? # approximate CIs for fixed effects & variance parameters

Check that the random-effect variances are meaningfully > 0 (not effectively zero).


4. If you want a quick model-selection rule instead of a formal test, compare AIC or BIC (m1, m2) (pragmatic) but report the bootstrap if you claim a hypothesis test.

AIC(m1, m2)
BIC(m1, m2)

Rule of thumb: ?AIC ? 4?7 is moderate evidence; ?10 strong evidence for the lower-AIC model.

If AIC/BIC and diagnostics both favor m2 (or m1), that?s usually sufficient for reporting model choice; but for formal claims about correlation = 0, quote the bootstrap p-value/CI.

Best


> Le 6 sept. 2025 ? 14:04, Kenneth KNOBLAUCH <ken.knoblauch at inserm.fr> a ?crit :
> 
> ?I thank Ben and Sacha for their suggestions.? 
> 
> This is the random argument of nlme that I found ran without error and provides results that seem to make sense to:
> 
> random = list(Obs = pdDiag(list(A ~ 1, B ~ 1)))
> 
> The model with that random argument gave:
> 
> Random effects:
>? Formula: list(A ~ 1, B ~ 1)
>? Level: Obs
>? Structure: Diagonal
>???????? A.(Intercept) B.(Intercept)? Residual
> StdDev:????? 0.2403019?????? 1.105224 0.4258117
> 
> so no correlation, and the model didn't differ significantly from the saturated model using the anova method.? If anyone sees a problem with that approach, I'd appreciate your feedback.
> 
> Thanks, again, for your suggestions and help.
> 
> best,
> 
> Ken
> _
>? Kenneth Knoblauch
> Inserm U1208
> Stem-cell and Brain Research Institute
> 18 avenue du Doyen L?pine
> 69500 Bron
> France
> tel: +33 (0)4 72 91 34 77
> fax: +33 (0)4 72 91 34 61
> portable: +33 (0)6 84 10 64 10
> https://sbri.fr/public-profile/63/single-member/
> 
> 
> 
> 
> De : varin sacha <varinsacha at yahoo.fr>
> Envoy? : vendredi 5 septembre 2025 14:54
> ? : Kenneth KNOBLAUCH
> Cc : r-sig-mixed-models at r-project.org
> Objet : Re: [R-sig-ME] specifying random effects in nlme with correlation fixed at 0
>? 
> 
> 
> 
> 
> Hi,
> 
> 
> Try dropping the -1 and we should get a valid diagonal structure: random effects for A and B with no correlation.
> m2 <- update(m1,
>?? random = list(Obs = pdDiag(~ A + B))
> 
> )
> Hope it works. 
> Best,
> 
> 
> 
> 
> 
> 
> 
> Le 5 sept. 2025 ? 12:03, Kenneth KNOBLAUCH <ken.knoblauch at inserm.fr> a ?crit :
> 
> 
> ?
> Thanks.? That's the sort of thing that I am looking for but alas I get the following error message when I try it:
> 
> Error in nlme.formula(model = y ~ A * x/(x +? : 
>?? 'random' must be a formula or list of formulae
> 
> Ken
> 
> 
> 
> 
> 
> 
> ___
> Kenneth Knoblauch
> Inserm U1208
> Stem-cell and Brain Research Institute
> 18 avenue du Doyen L?pine
> 69500 Bron
> France
> tel: +33 (0)4 72 91 34 77
> fax: +33 (0)4 72 91 34 61
> portable: +33 (0)6 84 10 64 10
> https://sbri.fr/public-profile/63/single-member/
> 
> 
> 
> 
> De : varin sacha <varinsacha at yahoo.fr>
> Envoy? : vendredi 5 septembre 2025 00:21
> ? : Kenneth KNOBLAUCH
> Cc : r-sig-mixed-models at r-project.org
> Objet : Re: [R-sig-ME] specifying random effects in nlme with correlation fixed at 0
>? 
> 
> 
> Hi,
> 
> Just a hint. What about forcing 0 correlation ? 
> This is a way to test the need for a non-zero correlation in nlme.
> To fix correlation at 0, we need to specify that the covariance structure is diagonal, not full. That?s what the pdDiag structure is for:
> m2 <- update (m1,
>?? random = list(Obs = pdDiag(~ A + B - 1))
> )
> 
> ? pdDiag() = diagonal positive-definite matrix ? random effects are independent.
> ? ~ A + B - 1 = random intercepts for A and B separately, no correlation.
> ? The -1 just removes the intercept term from the pdMat specification.
> 
> 
> And then we compare to the correlated version :
> anova(m1, m2)
> 
> 
> Use anova as a fast diagnostic. We have a likelihood ratio test for whether the correlation parameter is (or not) necessary.
> Best,
> 
> 
> 
> 
> 
> Le 4 sept. 2025 ? 08:06, Kenneth KNOBLAUCH <ken.knoblauch at inserm.fr> a ?crit :
> 
> 
> ?Absolutely.?? My brain got inverted.? My original response variable, what I'm calling invy, is actually reaction time and I inverted it to get speed, what I'm calling y, for variance stabilization.? Unnecessarily confusing to free my example? from its context.
> 
> I was pretty sure based on what I've gleaned from web examples that there is a way to do this in nlme using pdMat functions.? I'm away from home but will be back tonight where I can consult Pinheiro and Bates and other references.
> 
> Thanks.
> 
> Ken
> 
> 
> ################################
> De Ben Bolker bbo|ker @end|ng |rom gm@||@com
> I think you shouldn't be using glmer(invy ~ ... ), but glmer(y ~
> ...); the link function takes care of the inversion for you. By analogy,
> you use e.g. glmer(y ~ ..., family = poisson(link = "log")) rather than
> glmer(log(y) ~ ... family(poisson(link = "log")) for a log-link Poisson
> response.? By using glmer(invy ~ ..., family = gaussian("inverse")) I
> think you're actually undoing the transformation (!) because inverse()
> is its own (function) inverse ...
> 
> 
> 
>? ___
>? Kenneth Knoblauch
> Inserm U1208
> Stem-cell and Brain Research Institute
> 18 avenue du Doyen L?pine
> 69500 Bron
> France
> tel: +33 (0)4 72 91 34 77
> fax: +33 (0)4 72 91 34 61
> portable: +33 (0)6 84 10 64 10
> https://sbri.fr/public-profile/63/single-member/
> 
> 
> 
> 
> 
> De : Kenneth KNOBLAUCH
> Envoy? : mercredi 3 septembre 2025 20:44
> ? : r-sig-mixed-models at r-project.org
> Objet : RE: specifying random effects in nlme with correlation fixed at 0
>???? 
> Thank you Ben for the rapid response.? I knew about the linearization of the Michelis-Menten function by inverting both sides but I hadn't thought of the inverse link.? Very clever.
> 
> I tried
> 
> d.df$invx<- 1/d.df$x
> d.df$invy <- 1/d.df$y
> g1 <- glmer(invy ~ Filter * invx+ (invx | Obs), d.df,
>???????????? family = gaussian("inverse"))
> 
> I get a singular fit, I guess, because the correlation of random effects is -1, with this parameterization (only about 0.4 with what I was getting using nlme on the uninverted responses).
> 
> with glmer on inverted model:
> Random effects:
>? Groups?? Name????????? Variance Std.Dev. Corr
>? Obs????? (Intercept)????? 0.01231? 0.1110?????? 
>??????????????? invx????????????? 0.54359? 0.7373?? -1.00
>? Residual??????????????????? 3.78661? 1.9459?????? 
> Number of obs: 9600, groups:? Obs, 10
> 
> 
> with nlme on uninverted model:
> 
>?????????????????????? StdDev??? Corr 
> A.(Intercept)? 0.2514793 A.(I)
> B.(Intercept)? 1.1955573 0.428
> Residual??????? 0.4257936????? 
> 
> Also, the reparameterization complicates a little bit the parameter interpretation. A is still A but now the second parameter becomes B/A.? With nlme, I can test whether there is a fixed effect on both.? Here, I can look at F wrt to the Intercept and? F:invx?  wrt to invx.? I can live with that.
> 
> Any suggestions for the singular model (I can re-read the isSingular page).
> 
> It's interesting. 
> 
> If you come up with a solution for nlme, I would be interested to see it.
> 
> Thanks.
> 
> Ken
> 
> 
> ###############################
> De Ben Bolker bbo|ker @end|ng |rom gm@||@com
>???? I will dig into this if I get a chance, although the nlme code can? be a little scary sometimes.? It might not be possible.???? It's not quite the same model but you might be able to hack this in? lme4::glmer or glmmTMB by using a Gaussian model with?  an? *inverse* link:? that effectively transforms the problem from? y ~ A * x / (x + B)? to? 1/y ~ A + (B/A)*(1/x)? but preserves the constant-variance/Gaussian assumption on the original? scale.? On 9/3/25 11:56, Kenneth KNOBLAUCH wrote: > I'm fitting a model??  using nlme.? The data frame has 9600 rows and the grouping variable, Obs, has 10 levels.? I fit the following model (names of variables simplified from original) that runs fine: >? > m1 <- nlme(y ~ A * x / (x + B), data = d.df, >???????????????????? fixed??  = A + B ~ F, >???????????????????? random = A + B ~ 1 | Obs, >???????????????????? start = list(fixed = c(A = c(2, 0), B = c(15, 0)) )) >? > F is a 2 level factor and A and B parameters to estimate.? This runs fine, too, using SSmicmen(x, A, B) for the right??  hand side of the formula.? x and y are numeric variables. >? > I would like to compare model m1 to a model where the correlation between random effects is fixed to 0.? I tried >? > update(m1, random = list(A ~ 1 | Obs, B ~ 1 | Obs)) >? > but I get the following??  error message: >? > Error in parse(text = paste("~", paste(nVal, collapse = "/"))) : >??? <text>:2:0: unexpected end of input > 1: ~ >???? ^ >? > I've also tried with various combinations of the pdMat functions but can't find the right way to specify this.??  >? > Simpler models, leaving out one or the other random effect work as well as for leaving out fixed effects after the random effects have been tested. >? > Thank you for any suggestions.
>? 
>? De : Kenneth KNOBLAUCH
> Envoy? : mercredi 3 septembre 2025 17:56
> ? : r-sig-mixed-models at r-project.org
> Objet : specifying random effects in nlme with correlation fixed at 0
>??? 
> I'm fitting a model using nlme.? The data frame has 9600 rows and the grouping variable, Obs, has 10 levels.? I fit the following model (names of variables simplified from original) that runs fine:
> 
> m1 <- nlme(y ~ A * x / (x + B), data = d.df,
>??????????????????? fixed = A + B ~ F, 
>??????????????????? random = A + B ~ 1 | Obs,
>??????????????????? start = list(fixed = c(A = c(2, 0), B = c(15, 0)) ))
> 
> F is a 2 level factor and A and B parameters to estimate.? This runs fine, too, using SSmicmen(x, A, B) for the right hand side of the formula.? x and y are numeric variables.
> 
> I would like to compare model m1 to a model where the correlation between random effects is fixed to 0.? I tried
> 
> update(m1, random = list(A ~ 1 | Obs, B ~ 1 | Obs))
> 
> but I get the following error message:
> 
> Error in parse(text = paste("~", paste(nVal, collapse = "/"))) :
>?? <text>:2:0: unexpected end of input
> 1: ~
>??? ^
> 
> I've also tried with various combinations of the pdMat functions but can't find the right way to specify this.
> 
> Simpler models, leaving out one or the other random effect work as well as for leaving out fixed effects after the random effects have been tested.
> 
> Thank you for any suggestions.
> 
> Ken
>?? ___
>?? Kenneth Knoblauch
>? Inserm U1208
>? Stem-cell and Brain Research Institute
>? 18 avenue du Doyen L?pine
>? 69500 Bron
>? France
>? tel: +33 (0)4 72 91 34 77
>? fax: +33 (0)4 72 91 34 61
>? portable: +33 (0)6 84 10 64 10
>? https://sbri.fr/public-profile/63/single-member/
>???????????? 
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models

    

From hkubr@@eno| @end|ng |rom gm@||@com  Mon Sep  8 10:40:00 2025
From: hkubr@@eno| @end|ng |rom gm@||@com (HATICE T KUBRA AKDUR)
Date: Mon, 8 Sep 2025 11:40:00 +0300
Subject: [R-sig-ME] Question on parametrization and underdispersion in
 genpois family of glmmTMB
Message-ID: <CA+_DO+wUEs=v0BxZ3AZ46gmZC0yqHLV4=Ypc+D1gvm8CQcRzKA@mail.gmail.com>

Dear glmmTMB Developers,

I am currently working on a methodological paper regarding  mixed-effects
count models, where the Generalized Poisson distribution plays an important
role. I have been using the glmmTMB package and I have a couple of
questions regarding the implementation of the genpois family:

   1.

   *Parametrization*:
   -

      According to the package documentation, the genpois family is based
      on Consul & Famoye (1992), but the implementation was taken from the
      HMMpa package, which in turn follows Joe & Zhu (2005).
      -

      Could you please clarify the exact parametrization used in glmmTMB
      for the Generalized Poisson? F
      2.

   *Underdispersion*:
   -

      In the original Consul?Famoye formulation, negative values of the
      dispersion parameter allow modeling underdispersed data.
      -

      Does the glmmTMB implementation of genpois allow negative dispersion
      parameters, and thus support underdispersion? Or is the parameter
      constrained to nonnegative values (overdispersion only)?

This clarification would be very valuable for correctly citing the package
and explaining the underlying assumptions in my work.

Thank you very much in advance for your time and for maintaining such an
excellent and widely used package.

Best regards,
-- 
Assoc. Prof. Dr. Hatice T. Kubra AKDUR
Department of Statistics, Faculty of Science, Gazi University
06500 Teknikokullar ANKARA, TURKEY
Phone: +90 553 324 5380
Email: hatice_senol at wsu.edu
https://scholar.google.com/citations?user=_DLBsl4AAAAJ&hl=en

	[[alternative HTML version deleted]]


From v@r|n@@ch@ @end|ng |rom y@hoo@|r  Mon Sep  8 13:05:08 2025
From: v@r|n@@ch@ @end|ng |rom y@hoo@|r (varin sacha)
Date: Mon, 8 Sep 2025 13:05:08 +0200
Subject: [R-sig-ME] Question on parametrization and underdispersion in
 genpois family of glmmTMB
In-Reply-To: <CA+_DO+wUEs=v0BxZ3AZ46gmZC0yqHLV4=Ypc+D1gvm8CQcRzKA@mail.gmail.com>
References: <CA+_DO+wUEs=v0BxZ3AZ46gmZC0yqHLV4=Ypc+D1gvm8CQcRzKA@mail.gmail.com>
Message-ID: <E8FC7326-D609-433C-8A76-5B4D9D6B1F21@yahoo.fr>

Hi,

From what I know but not sure, here are a few responses. 

1. Parametrization in glmmTMB
glmmTMB uses the Joe & Zhu (2005) parametrization of the Generalized Poisson distribution, not the original Consul & Famoye (1992) parametrization directly.
This was ported via the HMMpa package, and the documentation reflects that.
Joe & Zhu (2005) is a reparametrization of the Consul?Famoye GP that is more stable numerically for GLM fitting.

2. Underdispersion in glmmTMB
Yes, negative values of the dispersion parameter (alpha) are allowed in glmmTMB.
This means underdispersion is supported. More precisely  glmmTMB::genpois covers both overdispersion (alpha>0) and underdispersion (alpha<0).

Others could confirm ?

Best,


> Le 8 sept. 2025 ? 10:40, HATICE T KUBRA AKDUR <hkubrasenol at gmail.com> a ?crit :
> 
> ?Dear glmmTMB Developers,
> 
> I am currently working on a methodological paper regarding  mixed-effects
> count models, where the Generalized Poisson distribution plays an important
> role. I have been using the glmmTMB package and I have a couple of
> questions regarding the implementation of the genpois family:
> 
>   1.
> 
>   *Parametrization*:
>   -
> 
>      According to the package documentation, the genpois family is based
>      on Consul & Famoye (1992), but the implementation was taken from the
>      HMMpa package, which in turn follows Joe & Zhu (2005).
>      -
> 
>      Could you please clarify the exact parametrization used in glmmTMB
>      for the Generalized Poisson? F
>      2.
> 
>   *Underdispersion*:
>   -
> 
>      In the original Consul?Famoye formulation, negative values of the
>      dispersion parameter allow modeling underdispersed data.
>      -
> 
>      Does the glmmTMB implementation of genpois allow negative dispersion
>      parameters, and thus support underdispersion? Or is the parameter
>      constrained to nonnegative values (overdispersion only)?
> 
> This clarification would be very valuable for correctly citing the package
> and explaining the underlying assumptions in my work.
> 
> Thank you very much in advance for your time and for maintaining such an
> excellent and widely used package.
> 
> Best regards,
> --
> Assoc. Prof. Dr. Hatice T. Kubra AKDUR
> Department of Statistics, Faculty of Science, Gazi University
> 06500 Teknikokullar ANKARA, TURKEY
> Phone: +90 553 324 5380
> Email: hatice_senol at wsu.edu
> https://scholar.google.com/citations?user=_DLBsl4AAAAJ&hl=en
> 
>    [[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models


From hkubr@@eno| @end|ng |rom gm@||@com  Mon Sep  8 19:44:55 2025
From: hkubr@@eno| @end|ng |rom gm@||@com (HATICE T KUBRA AKDUR)
Date: Mon, 8 Sep 2025 20:44:55 +0300
Subject: [R-sig-ME] Question on parametrization and underdispersion in
 genpois family of glmmTMB
In-Reply-To: <E8FC7326-D609-433C-8A76-5B4D9D6B1F21@yahoo.fr>
References: <CA+_DO+wUEs=v0BxZ3AZ46gmZC0yqHLV4=Ypc+D1gvm8CQcRzKA@mail.gmail.com>
 <E8FC7326-D609-433C-8A76-5B4D9D6B1F21@yahoo.fr>
Message-ID: <CA+_DO+zoWShJS5NZy9C5J98Wy4_gHJ-3A1Awn2kYa44eMFLidw@mail.gmail.com>

Thank you for your answer.
Best!

On Mon, Sep 8, 2025 at 2:05?PM varin sacha <varinsacha at yahoo.fr> wrote:

> Hi,
>
> From what I know but not sure, here are a few responses.
>
> 1. Parametrization in glmmTMB
> glmmTMB uses the Joe & Zhu (2005) parametrization of the Generalized
> Poisson distribution, not the original Consul & Famoye (1992)
> parametrization directly.
> This was ported via the HMMpa package, and the documentation reflects that.
> Joe & Zhu (2005) is a reparametrization of the Consul?Famoye GP that is
> more stable numerically for GLM fitting.
>
> 2. Underdispersion in glmmTMB
> Yes, negative values of the dispersion parameter (alpha) are allowed in
> glmmTMB.
> This means underdispersion is supported. More precisely  glmmTMB::genpois
> covers both overdispersion (alpha>0) and underdispersion (alpha<0).
>
> Others could confirm ?
>
> Best,
>
>
> > Le 8 sept. 2025 ? 10:40, HATICE T KUBRA AKDUR <hkubrasenol at gmail.com> a
> ?crit :
> >
> > ?Dear glmmTMB Developers,
> >
> > I am currently working on a methodological paper regarding  mixed-effects
> > count models, where the Generalized Poisson distribution plays an
> important
> > role. I have been using the glmmTMB package and I have a couple of
> > questions regarding the implementation of the genpois family:
> >
> >   1.
> >
> >   *Parametrization*:
> >   -
> >
> >      According to the package documentation, the genpois family is based
> >      on Consul & Famoye (1992), but the implementation was taken from the
> >      HMMpa package, which in turn follows Joe & Zhu (2005).
> >      -
> >
> >      Could you please clarify the exact parametrization used in glmmTMB
> >      for the Generalized Poisson? F
> >      2.
> >
> >   *Underdispersion*:
> >   -
> >
> >      In the original Consul?Famoye formulation, negative values of the
> >      dispersion parameter allow modeling underdispersed data.
> >      -
> >
> >      Does the glmmTMB implementation of genpois allow negative dispersion
> >      parameters, and thus support underdispersion? Or is the parameter
> >      constrained to nonnegative values (overdispersion only)?
> >
> > This clarification would be very valuable for correctly citing the
> package
> > and explaining the underlying assumptions in my work.
> >
> > Thank you very much in advance for your time and for maintaining such an
> > excellent and widely used package.
> >
> > Best regards,
> > --
> > Assoc. Prof. Dr. Hatice T. Kubra AKDUR
> > Department of Statistics, Faculty of Science, Gazi University
> > 06500 Teknikokullar ANKARA, TURKEY
> > Phone: +90 553 324 5380
> > Email: hatice_senol at wsu.edu
> > https://scholar.google.com/citations?user=_DLBsl4AAAAJ&hl=en
> >
> >    [[alternative HTML version deleted]]
> >
> > _______________________________________________
> > R-sig-mixed-models at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>
>

-- 
Assoc. Prof. Dr. Hatice T. Kubra AKDUR
Department of Statistics, Faculty of Science, Gazi University
06500 Teknikokullar ANKARA, TURKEY
Phone: +90 553 324 5380
Email: hatice_senol at wsu.edu
https://scholar.google.com/citations?user=_DLBsl4AAAAJ&hl=en

	[[alternative HTML version deleted]]


From i@io m@iii@g oii phys@ii@-courses@org  Mon Sep 15 17:03:01 2025
From: i@io m@iii@g oii phys@ii@-courses@org (i@io m@iii@g oii phys@ii@-courses@org)
Date: Mon, 15 Sep 2025 17:03:01 +0200 (CEST)
Subject: [R-sig-ME] =?utf-8?q?online_course=3A_Generalised_Additive_Model?=
 =?utf-8?q?s_in_R_-_8=E2=80=9311_December?=
Message-ID: <1757948581.52024551@webmail.jimdo.com>


Dear all,
We are pleased to announce the online course: Generalised Additive Models in R
Dates: 8?11 December
Course website: [ https://www.physalia-courses.org/courses-workshops/gams-in-r/ ]( https://www.physalia-courses.org/courses-workshops/gams-in-r/ )
 
This four-day training will introduce participants to Generalised Additive Models (GAMs), a flexible extension of GLMs that allows the relationships between covariates and responses to be learned directly from the data using splines. The course combines lectures, discussions and hands-on exercises to provide both the theoretical background and the practical tools needed to fit, interpret and visualise GAMs in R using the mgcv and gratia packages.
 
 
Sessions will run from 14:00 to 20:00 (Berlin time), Monday to Thursday.
 
Best regards,
Carlo
 
--------------------

Carlo Pecoraro, Ph.D


Physalia-courses DIRECTOR

info at physalia-courses.org

mobile: +49 17645230846

[ Bluesky ]( https://bsky.app/profile/physaliacourses.bsky.social ) [ Linkedin ]( https://www.linkedin.com/in/physalia-courses-a64418127/ )


	[[alternative HTML version deleted]]


From o||verhooker @end|ng |rom pr@t@t|@t|c@@com  Tue Sep 23 18:04:56 2025
From: o||verhooker @end|ng |rom pr@t@t|@t|c@@com (Oliver Hooker)
Date: Tue, 23 Sep 2025 17:04:56 +0100
Subject: [R-sig-ME] =?utf-8?q?Bayesian_Multilevel_Modelling_using=C2=A0br?=
	=?utf-8?q?ms=C2=A0for_Ecologists_=28BMME01=29?=
Message-ID: <CAEsSYzyic1DUVGZDbW5ho=hLWiHnZLf+5L3boLr0rCjgy+=5nA@mail.gmail.com>

Bayesian Multilevel Modelling using *brms* for Ecologists (BMME01)Frame
ecological questions rigorously using *Bayesian multilevel models in R*
https://www.prstats.org/course/bayesian-multilevel-modelling-using-brms-for-ecologists-bmme01/

Explore model building, uncertainty quantification, spatial and temporal
autocorrelation, and species distribution modelling through a *ten?session
live online course*, designed for ecologists using R.
------------------------------
 Course Details & Format

   -

   *Next Session*: October?20?24 & October?27?31,?2025 (Monday?Friday)
   -

   *Duration*: 10 days ? ~4 hours/day = 40 hours total
   -

   *Schedule*: Live sessions conducted in UK time (GMT+1); all sessions
   recorded and available for later viewing, accommodating global participants
   -

   *Format*: Interactive learning via remote online classroom; lectures and
   Q&A, plus applied coding exercises

------------------------------
Who It?s For & What You?ll Gain

Designed for ecologists, postgraduate researchers, analysts, and
early-career scientists with basic R/RStudio experience and fundamental
statistics knowledge.

By the end of the course, you?ll be able to:

   -

   Frame and implement *Bayesian inference*, including priors, posteriors,
   and credible intervals
   -

   Fit GLMs and hierarchical multilevel models using *brms*
   -

   Choose and interpret meaningful priors for ecological parameters
   -

   Diagnose and critique model fit with posterior predictive checks, WAIC,
   LOO-CV
   -

   Model non-Gaussian ecological data (counts, proportions, zero-inflation)
   -

   Account for *spatial and temporal autocorrelation* in hierarchical models
   -

   Build multivariate/joint species distribution models for community
   analysis
   -

   Visualize and clearly communicate uncertainty in model results

------------------------------
? Fees & Registration

   -

   *Early bird (first 10 places)*: *?400*
   -

   *Standard fee*: *?450*


Ideal participants should be comfortable installing and using R and
RStudio, and have basic familiarity with functions, plotting (e.g.
ggplot2), and statistics like regression.
------------------------------
Why Choose BMME01?

   -

   *Comprehensive curriculum*: From Bayesian fundamentals to advanced
   ecological modelling
   -

   *Focus on applied use*: Ecologically-relevant examples including
   spatial, temporal, count, and joint species modelling
   -

   *Expert-led sessions*: Topic-by-topic deep dives with practical exercises
   -

   *Flexible structure*: Live sessions with recordings ? rewind, revisit,
   and learn at your pace
   -

   *Learning continuity*: Bring and work with your data, and get feedback
   via guided exercises and peer interaction

------------------------------

Build multilevel models with *confidence*, interpret ecological data with
*nuance*, and communicate results with *clarity*.

Email oliver at prstats.org with any questions

-- 
Oliver Hooker PhD.
PR stats

	[[alternative HTML version deleted]]


