From |@w|@wt @end|ng |rom gm@||@com  Wed Jan  4 21:42:52 2023
From: |@w|@wt @end|ng |rom gm@||@com (Timothy MacKenzie)
Date: Wed, 4 Jan 2023 14:42:52 -0600
Subject: [R-sig-ME] Narrative interpretation of a complex mixed model
Message-ID: <CADreqixChzsGESWw12D-oq+=pD20bXNVZBQKyfmbH07wMrR4vg@mail.gmail.com>

Dear community,

I have fit the mixed-effects model below. I was wondering if my narrative
interpretation of the random part of the model plus its residual modeling
is accurate?

-- Tim M

### Model:
lme(y ~ time*cal,
     random = list(participant = pdDiag(~cal+0)),
       data = data,
correlation = corCompSymm(),
    weights = varComb(varIdent(form = ~1|time),
                      varIdent(form = ~1|cal)))

### Narrative Interpretation:
First, the model assumed that CAL measures used in our study were a random
sample of a larger set of possible CAL measures available in the
literature. As a result, CAL measures were considered to be random-effects
for each participant across all the participants in the study.

Second, these CAL measure random-effects were found to be non-overlapping
(uncorrelated) with one another within each participant across all the
participants.

Third, the CAL measure random-effects seemed to have varying amounts of
variation in them (i.e., were heterogeneous) across the participants.

Fourth, although the random-effects seemed to be uncorrelated, the
residuals of the model seemed to be slightly correlated symmetrically for
each participant across all the participants.

Finally, in addition to their correlation, the residuals of the model
seemed to change as a function of different CAL measures as well as the
timing of CAL measurement.

	[[alternative HTML version deleted]]


From n@m|t@@k@k|@ @end|ng |rom thet@@utoronto@c@  Thu Jan  5 17:45:10 2023
From: n@m|t@@k@k|@ @end|ng |rom thet@@utoronto@c@ (Nicholas Mitsakakis)
Date: Thu, 5 Jan 2023 11:45:10 -0500
Subject: [R-sig-ME] Converting SAS code into R
Message-ID: <CAJ4s-a7XdvzNjx-2G_e7xtS4Q6-4qNrNCs+=OuK_L8Htp0WTeQ@mail.gmail.com>

I have been trying to convert some PROC MIXED SAS code into R, but without
success. The code is:

proc mixed data=rmanova4;class randomization_arm cancer_type site wk;
model chgpf=randomization_arm cancer_type site wk;
repeated  / subject=study_id;
contrast '12 vs 4' randomization_arm 1 -1;
lsmeans randomization_arm / cl pdiff alpha=0.05;
run;quit;

I have tried something like

lme(chgpf ~ Randomization_Arm  + Cancer_Type + site + wk, data=rmanova.data,
            random = ~ 1  | Study_ID,
            correlation = corSymm(form = ~ 1 | Study_ID),
            na.action=na.exclude, method = "REML")

but I am getting different estimate values.

Perhaps I am misunderstanding something basic. Any comment/suggestion would
be greatly appreciated.

I am adding here the output. Part of the output from the SAS code is below:

Least Squares Means
Effect  Randomization_Arm   Estimate    Standard Error  DF  t Value Pr
> |t|    Alpha   Lower   Upper
Randomization_Arm   12 weekly BTA   -4.5441 1.3163  222 -3.45   0.0007
 0.05    -7.1382 -1.9501
Randomization_Arm   4 weekly BTA    -6.4224 1.3143  222 -4.89   <.0001
 0.05    -9.0126 -3.8322

Differences of Least Squares Means
Effect  Randomization_Arm   _Randomization_Arm  Estimate    Standard
Error  DF  t Value Pr > |t|    Alpha   Lower   Upper
Randomization_Arm   12 weekly BTA   4 weekly BTA    1.8783  1.4774
222 1.27    0.2049  0.05    -1.0332 4.7898

The output from the R code is below:

Linear mixed-effects model fit by REML
  Data: rmanova.data
       AIC     BIC    logLik
  6526.315 6586.65 -3250.157

Random effects:
 Formula: ~1 | Study_ID
        (Intercept) Residual
StdDev:    16.51816 12.95417

Correlation Structure: General
 Formula: ~1 | Study_ID
 Parameter estimate(s):
 Correlation:
  1      2      3     2  0.222              3 -0.159  0.225       4
-0.421 -0.042  0.083
Fixed effects:  chgpf ~ Randomization_Arm + Cancer_Type + site + wk
                                  Value Std.Error  DF    t-value
p-value(Intercept)                    5.739240 2.8987216 541
1.9799209  0.0482
Randomization_Arm4 weekly BTA -1.174704 2.3915873 225 -0.4911817  0.6238
Cancer_TypeProsta             -4.459715 2.4711025 225 -1.8047469  0.0725
site                          -1.917902 0.9709655 225 -1.9752530  0.0495
wk                            -1.570707 0.5115174 541 -3.0706809  0.0022
 Correlation:
                              (Intr) R_A4wB Cnc_TP site
Randomization_Arm4 weekly BTA -0.440
Cancer_TypeProsta             -0.314  0.043
site                          -0.598  0.003 -0.064
wk                            -0.421 -0.004  0.032  0.003

Standardized Within-Group Residuals:
        Min          Q1         Med          Q3         Max
-4.99530346 -0.36507852  0.08308708  0.45937864  3.12730244

Number of Observations: 771
Number of Groups: 229








--
Nicholas Mitsakakis, MSc, PhD, P.Stat.

Senior Biostatistician and Associate Scientist
Children's Hospital of Eastern Ontario Research Institute
Adjunct Lecturer, Dalla Lana School of Public Health, University of Toronto

-- 

This e-mail may be confidential and/or privileged and is intended to be 
viewed only by the recipient(s) named above. If you are not the intended 
recipient, you are strictly prohibited from reading, using, disclosing, 
copying or distributing this e-mail. If you received this e-mail in error, 
please immediately notify the sender, and permanently delete this e-mail 
and any attachments.

	[[alternative HTML version deleted]]


From benpe|zer @end|ng |rom gm@||@com  Fri Jan  6 09:04:45 2023
From: benpe|zer @end|ng |rom gm@||@com (ben pelzer)
Date: Fri, 6 Jan 2023 09:04:45 +0100
Subject: [R-sig-ME] Converting SAS code into R
Message-ID: <CAFgPNS_A06ipq2+Wgs7T++ve-iUQ7ixVB31BCVY6LY85+Tq0dA@mail.gmail.com>

Dear Nicholas,

The sas code may estimate a different variance for each study_id. I'm not
sure, but mixed in spss would do this if repeated is used. In that case,
add something like "weights = varIdent(form = ~1|study_id)" to your lme
code in R. Regards,

Ben.

	[[alternative HTML version deleted]]


From wo||g@ng@v|echtb@uer @end|ng |rom m@@@tr|chtun|ver@|ty@n|  Fri Jan  6 13:29:26 2023
From: wo||g@ng@v|echtb@uer @end|ng |rom m@@@tr|chtun|ver@|ty@n| (Viechtbauer, Wolfgang (NP))
Date: Fri, 6 Jan 2023 12:29:26 +0000
Subject: [R-sig-ME] Converting SAS code into R
In-Reply-To: <CAJ4s-a7XdvzNjx-2G_e7xtS4Q6-4qNrNCs+=OuK_L8Htp0WTeQ@mail.gmail.com>
References: <CAJ4s-a7XdvzNjx-2G_e7xtS4Q6-4qNrNCs+=OuK_L8Htp0WTeQ@mail.gmail.com>
Message-ID: <558cf9984b114442ab08544409b51e59@UM-MAIL3214.unimaas.nl>

Dear Nicholas,

The model specified via 'proc mixed' is actually not a mixed-effects / multilevel model at all. The default 'type' for 'repeated' is VC, which is the same as in a standard regression type model (i.e., it assumes independence between repeated observations within subjects and assumes a single variance error variance component). So you are in essence just fitting:

proc glm data=rmanova4; class randomization_arm cancer_type site wk;
 model chgpf = randomization_arm cancer_type site wk;
run;

which is identical in R to:

res <- lm(chgpf ~ Randomization_Arm + Cancer_Type + site + wk, data=rmanova.data)
summary(res)

(assuming that the the predictors are all coded as factors in R).

I suspect that you actually wanted to fit a different model in SAS to begin with (why else use proc mixed?), but you would have to tell us first what the actual model is that you wanted to fit in SAS before we can tell you how to fit the same model in R.

Best,
Wolfgang

-- 
Wolfgang Viechtbauer, PhD, Statistician | Department of Psychiatry and    
Neuropsychology | Maastricht University | PO Box 616 (VIJV1) | 6200 MD    
Maastricht, The Netherlands | +31(43)3884170 | https://www.wvbauer.com    

>-----Original Message-----
>From: R-sig-mixed-models [mailto:r-sig-mixed-models-bounces at r-project.org] On
>Behalf Of Nicholas Mitsakakis via R-sig-mixed-models
>Sent: Thursday, 05 January, 2023 17:45
>To: r-sig-mixed-models at r-project.org
>Subject: [R-sig-ME] Converting SAS code into R
>
>I have been trying to convert some PROC MIXED SAS code into R, but without
>success. The code is:
>
>proc mixed data=rmanova4;class randomization_arm cancer_type site wk;
>model chgpf=randomization_arm cancer_type site wk;
>repeated  / subject=study_id;
>contrast '12 vs 4' randomization_arm 1 -1;
>lsmeans randomization_arm / cl pdiff alpha=0.05;
>run;quit;
>
>I have tried something like
>
>lme(chgpf ~ Randomization_Arm  + Cancer_Type + site + wk, data=rmanova.data,
>            random = ~ 1  | Study_ID,
>            correlation = corSymm(form = ~ 1 | Study_ID),
>            na.action=na.exclude, method = "REML")
>
>but I am getting different estimate values.
>
>Perhaps I am misunderstanding something basic. Any comment/suggestion would
>be greatly appreciated.
>
>I am adding here the output. Part of the output from the SAS code is below:
>
>Least Squares Means
>Effect  Randomization_Arm   Estimate    Standard Error  DF  t Value Pr
>> |t|    Alpha   Lower   Upper
>Randomization_Arm   12 weekly BTA   -4.5441 1.3163  222 -3.45   0.0007
> 0.05    -7.1382 -1.9501
>Randomization_Arm   4 weekly BTA    -6.4224 1.3143  222 -4.89   <.0001
> 0.05    -9.0126 -3.8322
>
>Differences of Least Squares Means
>Effect  Randomization_Arm   _Randomization_Arm  Estimate    Standard
>Error  DF  t Value Pr > |t|    Alpha   Lower   Upper
>Randomization_Arm   12 weekly BTA   4 weekly BTA    1.8783  1.4774
>222 1.27    0.2049  0.05    -1.0332 4.7898
>
>The output from the R code is below:
>
>Linear mixed-effects model fit by REML
>  Data: rmanova.data
>       AIC     BIC    logLik
>  6526.315 6586.65 -3250.157
>
>Random effects:
> Formula: ~1 | Study_ID
>        (Intercept) Residual
>StdDev:    16.51816 12.95417
>
>Correlation Structure: General
> Formula: ~1 | Study_ID
> Parameter estimate(s):
> Correlation:
>  1      2      3     2  0.222              3 -0.159  0.225       4
>-0.421 -0.042  0.083
>Fixed effects:  chgpf ~ Randomization_Arm + Cancer_Type + site + wk
>                                  Value Std.Error  DF    t-value
>p-value(Intercept)                    5.739240 2.8987216 541
>1.9799209  0.0482
>Randomization_Arm4 weekly BTA -1.174704 2.3915873 225 -0.4911817  0.6238
>Cancer_TypeProsta             -4.459715 2.4711025 225 -1.8047469  0.0725
>site                          -1.917902 0.9709655 225 -1.9752530  0.0495
>wk                            -1.570707 0.5115174 541 -3.0706809  0.0022
> Correlation:
>                              (Intr) R_A4wB Cnc_TP site
>Randomization_Arm4 weekly BTA -0.440
>Cancer_TypeProsta             -0.314  0.043
>site                          -0.598  0.003 -0.064
>wk                            -0.421 -0.004  0.032  0.003
>
>Standardized Within-Group Residuals:
>        Min          Q1         Med          Q3         Max
>-4.99530346 -0.36507852  0.08308708  0.45937864  3.12730244
>
>Number of Observations: 771
>Number of Groups: 229
>
>--
>Nicholas Mitsakakis, MSc, PhD, P.Stat.
>
>Senior Biostatistician and Associate Scientist
>Children's Hospital of Eastern Ontario Research Institute
>Adjunct Lecturer, Dalla Lana School of Public Health, University of Toronto


From e|||otjohn@ton21 @end|ng |rom gm@||@com  Wed Jan 11 18:14:29 2023
From: e|||otjohn@ton21 @end|ng |rom gm@||@com (Elliot Johnston)
Date: Wed, 11 Jan 2023 12:14:29 -0500
Subject: [R-sig-ME] Odd ANOVA degrees of freedom with ZI component of
 glmmTMB model
Message-ID: <CAMAqrC7TUky4s_s4sx5Vkk9+BtG6xydnYt6uJT9C1-tjcr8ViA@mail.gmail.com>

Hi all,

I am using the car package to run ANOVAs (type II Wald chi square tests) on
the following model:

m1 <- glmmTMB(Count ~ Time_Period*Assignment + (1|Region/Site_ID),
                  ziformula = ~ Time_Period*Assignment + (1|Region/Site_ID),
                  data = allbirds, family = poisson)

Time Period has three levels and Assignment has two levels. When running
the ANOVA on the conditional component -- car::Anova(m1, component =
"cond") -- the degrees of freedom in the output is as I would expected
(n-1):

                                Chisq    Df  Pr(>Chisq)
Time_Period            0.9105  2    0.63429
Assignment             2.1043  1    0.14689
Time_Period:Assignment 6.8486  2    0.03257 *

But when I run the ANOVA for the zero-inflated component -- car::Anova(m1,
component = "zi") -- the output looks strange:

                                Chisq    Df Pr(>Chisq)
Time_Period            9.8876  3   0.019546 *
Assignment             9.4648  2   0.008805 **
Time_Period:Assignment 7.9605  2   0.018681 *

Why would the degrees of freedom change? FWIW this df discrepancy between
the conditional and ZI ANOVAs does *not* happen when running the above
glmmTMB model with subsetted data frames based on different bird guilds. It
also seems strange that between the Time Period and Assignment terms the
smaller chi square value leads to greater statistical significance. Do you
agree that something seems wrong here or am I misunderstanding what is
going on under the hood? Any ideas on how to troubleshoot?

Thank you!

-Elliot

	[[alternative HTML version deleted]]


From bbo|ker @end|ng |rom gm@||@com  Wed Jan 11 19:12:40 2023
From: bbo|ker @end|ng |rom gm@||@com (Ben Bolker)
Date: Wed, 11 Jan 2023 13:12:40 -0500
Subject: [R-sig-ME] Odd ANOVA degrees of freedom with ZI component of
 glmmTMB model
In-Reply-To: <CAMAqrC7TUky4s_s4sx5Vkk9+BtG6xydnYt6uJT9C1-tjcr8ViA@mail.gmail.com>
References: <CAMAqrC7TUky4s_s4sx5Vkk9+BtG6xydnYt6uJT9C1-tjcr8ViA@mail.gmail.com>
Message-ID: <43865e80-2980-fb8d-4d0c-c7024638c8f6@gmail.com>

 ???? The difference in 'Df' between the two components, which appear to 
have the same fixed-effect model specification, is definitely surprising.

 ???? It's not surprising that chisq=9.46 with 2 df could have a lower 
p-value than chisq=9.89 with 3 df; the larger the df (i.e. the larger 
the difference in the number of parameters/complexity between the two 
models implicitly being compared), the more dispersed the null 
distribution of the deviance difference (=='chisq').

 ?? To troubleshoot I would look at the guts of glmmTMB:::Anova.glmmTMB 
and see what's going on. I'm not claiming that will be obvious: if you 
can post a *reproducible* example to the glmmTMB issues list I'd be 
happy to take a look.

On 2023-01-11 12:14 PM, Elliot Johnston wrote:
> Hi all,
>
> I am using the car package to run ANOVAs (type II Wald chi square tests) on
> the following model:
>
> m1 <- glmmTMB(Count ~ Time_Period*Assignment + (1|Region/Site_ID),
>                    ziformula = ~ Time_Period*Assignment + (1|Region/Site_ID),
>                    data = allbirds, family = poisson)
>
> Time Period has three levels and Assignment has two levels. When running
> the ANOVA on the conditional component -- car::Anova(m1, component =
> "cond") -- the degrees of freedom in the output is as I would expected
> (n-1):
>
>                                  Chisq    Df  Pr(>Chisq)
> Time_Period            0.9105  2    0.63429
> Assignment             2.1043  1    0.14689
> Time_Period:Assignment 6.8486  2    0.03257 *
>
> But when I run the ANOVA for the zero-inflated component -- car::Anova(m1,
> component = "zi") -- the output looks strange:
>
>                                  Chisq    Df Pr(>Chisq)
> Time_Period            9.8876  3   0.019546 *
> Assignment             9.4648  2   0.008805 **
> Time_Period:Assignment 7.9605  2   0.018681 *
>
> Why would the degrees of freedom change? FWIW this df discrepancy between
> the conditional and ZI ANOVAs does *not* happen when running the above
> glmmTMB model with subsetted data frames based on different bird guilds. It
> also seems strange that between the Time Period and Assignment terms the
> smaller chi square value leads to greater statistical significance. Do you
> agree that something seems wrong here or am I misunderstanding what is
> going on under the hood? Any ideas on how to troubleshoot?
>
> Thank you!
>
> -Elliot
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models


From j|ox @end|ng |rom mcm@@ter@c@  Wed Jan 11 20:51:56 2023
From: j|ox @end|ng |rom mcm@@ter@c@ (John Fox)
Date: Wed, 11 Jan 2023 14:51:56 -0500
Subject: [R-sig-ME] Odd ANOVA degrees of freedom with ZI component of
 glmmTMB model
In-Reply-To: <17081_1673460776_30BICtef023863_43865e80-2980-fb8d-4d0c-c7024638c8f6@gmail.com>
References: <CAMAqrC7TUky4s_s4sx5Vkk9+BtG6xydnYt6uJT9C1-tjcr8ViA@mail.gmail.com>
 <17081_1673460776_30BICtef023863_43865e80-2980-fb8d-4d0c-c7024638c8f6@gmail.com>
Message-ID: <0216a145-f66e-7bd1-a9c2-72de328d083a@mcmaster.ca>

Dear Elliot and Ben,

Yes, something definitely seems wrong here, and as usual a reproducible 
example would help. Given that, and as soon as I have some time, I'll 
try to see what went wrong, but I won't be able to do that this week.

My apologies for the problem,
  John

John Fox, Professor Emeritus
McMaster University
Hamilton, Ontario, Canada
web: https://socialsciences.mcmaster.ca/jfox/

On 2023-01-11 1:12 p.m., Ben Bolker wrote:
>  ???? The difference in 'Df' between the two components, which appear to 
> have the same fixed-effect model specification, is definitely surprising.
> 
>  ???? It's not surprising that chisq=9.46 with 2 df could have a lower 
> p-value than chisq=9.89 with 3 df; the larger the df (i.e. the larger 
> the difference in the number of parameters/complexity between the two 
> models implicitly being compared), the more dispersed the null 
> distribution of the deviance difference (=='chisq').
> 
>  ?? To troubleshoot I would look at the guts of glmmTMB:::Anova.glmmTMB 
> and see what's going on. I'm not claiming that will be obvious: if you 
> can post a *reproducible* example to the glmmTMB issues list I'd be 
> happy to take a look.
> 
> On 2023-01-11 12:14 PM, Elliot Johnston wrote:
>> Hi all,
>>
>> I am using the car package to run ANOVAs (type II Wald chi square 
>> tests) on
>> the following model:
>>
>> m1 <- glmmTMB(Count ~ Time_Period*Assignment + (1|Region/Site_ID),
>> ?????????????????? ziformula = ~ Time_Period*Assignment + 
>> (1|Region/Site_ID),
>> ?????????????????? data = allbirds, family = poisson)
>>
>> Time Period has three levels and Assignment has two levels. When running
>> the ANOVA on the conditional component -- car::Anova(m1, component =
>> "cond") -- the degrees of freedom in the output is as I would expected
>> (n-1):
>>
>> ???????????????????????????????? Chisq??? Df? Pr(>Chisq)
>> Time_Period??????????? 0.9105? 2??? 0.63429
>> Assignment???????????? 2.1043? 1??? 0.14689
>> Time_Period:Assignment 6.8486? 2??? 0.03257 *
>>
>> But when I run the ANOVA for the zero-inflated component -- 
>> car::Anova(m1,
>> component = "zi") -- the output looks strange:
>>
>> ???????????????????????????????? Chisq??? Df Pr(>Chisq)
>> Time_Period??????????? 9.8876? 3?? 0.019546 *
>> Assignment???????????? 9.4648? 2?? 0.008805 **
>> Time_Period:Assignment 7.9605? 2?? 0.018681 *
>>
>> Why would the degrees of freedom change? FWIW this df discrepancy between
>> the conditional and ZI ANOVAs does *not* happen when running the above
>> glmmTMB model with subsetted data frames based on different bird 
>> guilds. It
>> also seems strange that between the Time Period and Assignment terms the
>> smaller chi square value leads to greater statistical significance. Do 
>> you
>> agree that something seems wrong here or am I misunderstanding what is
>> going on under the hood? Any ideas on how to troubleshoot?
>>
>> Thank you!
>>
>> -Elliot
>>
>> ????[[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-mixed-models at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> 
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models


From e|||otjohn@ton21 @end|ng |rom gm@||@com  Thu Jan 12 00:08:40 2023
From: e|||otjohn@ton21 @end|ng |rom gm@||@com (Elliot Johnston)
Date: Wed, 11 Jan 2023 18:08:40 -0500
Subject: [R-sig-ME] Odd ANOVA degrees of freedom with ZI component of
 glmmTMB model
In-Reply-To: <0216a145-f66e-7bd1-a9c2-72de328d083a@mcmaster.ca>
References: <CAMAqrC7TUky4s_s4sx5Vkk9+BtG6xydnYt6uJT9C1-tjcr8ViA@mail.gmail.com>
 <17081_1673460776_30BICtef023863_43865e80-2980-fb8d-4d0c-c7024638c8f6@gmail.com>
 <0216a145-f66e-7bd1-a9c2-72de328d083a@mcmaster.ca>
Message-ID: <CAMAqrC5MWi+zfhnLdvPgavC38R0svopyQhSDrd=vXwyKFgX1EA@mail.gmail.com>

Thanks for getting back to me Ben and John. As I was making a reproducible
example for this thread, I dropped all of the dataframe columns not used in
the analysis and ended up trimming the dataframe down from 35 columns to 6.
The zero-inflated ANOVA output now appears more sensical:

> car::Anova(m1, component = "zi")

Analysis of Deviance Table (Type II Wald chisquare tests)

Response: Count

                                 Chisq   Df  Pr(>Chisq)
Time_Period            1.9271  2    0.38154
Assignment             1.5043  1    0.22001
Time_Period:Assignment 7.9605  2    0.01868 *

The statistics for the interaction are the same as before, but the Time
Period and Assignment terms now make more sense. No observations were
dropped and the model specification remained the same, I just dropped a
number of columns. Seems strange, but I have the desired output so I don't
feel the need to troubleshoot the source of the error at this point. Hope
that's alright with you both. Thanks again for getting back to me.

-Elliot

On Wed, Jan 11, 2023 at 2:52 PM John Fox <jfox at mcmaster.ca> wrote:

> Dear Elliot and Ben,
>
> Yes, something definitely seems wrong here, and as usual a reproducible
> example would help. Given that, and as soon as I have some time, I'll
> try to see what went wrong, but I won't be able to do that this week.
>
> My apologies for the problem,
>   John
>
> John Fox, Professor Emeritus
> McMaster University
> Hamilton, Ontario, Canada
> web: https://socialsciences.mcmaster.ca/jfox/
>
> On 2023-01-11 1:12 p.m., Ben Bolker wrote:
> >       The difference in 'Df' between the two components, which appear to
> > have the same fixed-effect model specification, is definitely surprising.
> >
> >       It's not surprising that chisq=9.46 with 2 df could have a lower
> > p-value than chisq=9.89 with 3 df; the larger the df (i.e. the larger
> > the difference in the number of parameters/complexity between the two
> > models implicitly being compared), the more dispersed the null
> > distribution of the deviance difference (=='chisq').
> >
> >     To troubleshoot I would look at the guts of glmmTMB:::Anova.glmmTMB
> > and see what's going on. I'm not claiming that will be obvious: if you
> > can post a *reproducible* example to the glmmTMB issues list I'd be
> > happy to take a look.
> >
> > On 2023-01-11 12:14 PM, Elliot Johnston wrote:
> >> Hi all,
> >>
> >> I am using the car package to run ANOVAs (type II Wald chi square
> >> tests) on
> >> the following model:
> >>
> >> m1 <- glmmTMB(Count ~ Time_Period*Assignment + (1|Region/Site_ID),
> >>                    ziformula = ~ Time_Period*Assignment +
> >> (1|Region/Site_ID),
> >>                    data = allbirds, family = poisson)
> >>
> >> Time Period has three levels and Assignment has two levels. When running
> >> the ANOVA on the conditional component -- car::Anova(m1, component =
> >> "cond") -- the degrees of freedom in the output is as I would expected
> >> (n-1):
> >>
> >>                                  Chisq    Df  Pr(>Chisq)
> >> Time_Period            0.9105  2    0.63429
> >> Assignment             2.1043  1    0.14689
> >> Time_Period:Assignment 6.8486  2    0.03257 *
> >>
> >> But when I run the ANOVA for the zero-inflated component --
> >> car::Anova(m1,
> >> component = "zi") -- the output looks strange:
> >>
> >>                                  Chisq    Df Pr(>Chisq)
> >> Time_Period            9.8876  3   0.019546 *
> >> Assignment             9.4648  2   0.008805 **
> >> Time_Period:Assignment 7.9605  2   0.018681 *
> >>
> >> Why would the degrees of freedom change? FWIW this df discrepancy
> between
> >> the conditional and ZI ANOVAs does *not* happen when running the above
> >> glmmTMB model with subsetted data frames based on different bird
> >> guilds. It
> >> also seems strange that between the Time Period and Assignment terms the
> >> smaller chi square value leads to greater statistical significance. Do
> >> you
> >> agree that something seems wrong here or am I misunderstanding what is
> >> going on under the hood? Any ideas on how to troubleshoot?
> >>
> >> Thank you!
> >>
> >> -Elliot
> >>
> >>     [[alternative HTML version deleted]]
> >>
> >> _______________________________________________
> >> R-sig-mixed-models at r-project.org mailing list
> >> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >
> > _______________________________________________
> > R-sig-mixed-models at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>

	[[alternative HTML version deleted]]


From bbo|ker @end|ng |rom gm@||@com  Thu Jan 12 00:24:57 2023
From: bbo|ker @end|ng |rom gm@||@com (Ben Bolker)
Date: Wed, 11 Jan 2023 18:24:57 -0500
Subject: [R-sig-ME] Odd ANOVA degrees of freedom with ZI component of
 glmmTMB model
In-Reply-To: <CAMAqrC5MWi+zfhnLdvPgavC38R0svopyQhSDrd=vXwyKFgX1EA@mail.gmail.com>
References: <CAMAqrC7TUky4s_s4sx5Vkk9+BtG6xydnYt6uJT9C1-tjcr8ViA@mail.gmail.com>
 <17081_1673460776_30BICtef023863_43865e80-2980-fb8d-4d0c-c7024638c8f6@gmail.com>
 <0216a145-f66e-7bd1-a9c2-72de328d083a@mcmaster.ca>
 <CAMAqrC5MWi+zfhnLdvPgavC38R0svopyQhSDrd=vXwyKFgX1EA@mail.gmail.com>
Message-ID: <ca3fb309-a220-c905-a29c-81c96c443bf5@gmail.com>

   It would be great if you can send along a reproducible example, 
privately if necessary.  It's always alarming to have undiagnosed 
weirdness happening, even if you can make it go away by limiting the 
problem ...

On 2023-01-11 6:08 p.m., Elliot Johnston wrote:
> Thanks for getting back to me Ben and John. As I was making a 
> reproducible example for this thread, I dropped all of the dataframe 
> columns not used in the analysis and ended up trimming the dataframe 
> down from 35 columns to 6. The zero-inflated ANOVA output now appears 
> more sensical:
> 
>  > car::Anova(m1, component = "zi")
> 
> Analysis of Deviance Table (Type II Wald chisquare tests)
> 
> Response: Count
> 
>  ? ? ? ? ? ? ? ? ? ? ? ?????????? Chisq?? Df? Pr(>Chisq)
> Time_Period ? ? ? ? ? ?1.9271 ?2 ? ?0.38154
> Assignment ? ? ? ? ? ? 1.5043 ?1 ? ?0.22001
> Time_Period:Assignment 7.9605 ?2 ? ?0.01868 *
> 
> The statistics for the interaction are the same as before, but the Time 
> Period and Assignment terms now make more sense. No observations were 
> dropped and the model specification remained the same, I just dropped a 
> number of columns. Seems strange, but I have the desired output so I 
> don't feel the need to troubleshoot the source of the error at this 
> point. Hope that's alright with you both. Thanks again for getting back 
> to me.
> 
> -Elliot
> 
> On Wed, Jan 11, 2023 at 2:52 PM John Fox <jfox at mcmaster.ca 
> <mailto:jfox at mcmaster.ca>> wrote:
> 
>     Dear Elliot and Ben,
> 
>     Yes, something definitely seems wrong here, and as usual a reproducible
>     example would help. Given that, and as soon as I have some time, I'll
>     try to see what went wrong, but I won't be able to do that this week.
> 
>     My apologies for the problem,
>      ? John
> 
>     John Fox, Professor Emeritus
>     McMaster University
>     Hamilton, Ontario, Canada
>     web: https://socialsciences.mcmaster.ca/jfox/
>     <https://socialsciences.mcmaster.ca/jfox/>
> 
>     On 2023-01-11 1:12 p.m., Ben Bolker wrote:
>      >? ???? The difference in 'Df' between the two components, which
>     appear to
>      > have the same fixed-effect model specification, is definitely
>     surprising.
>      >
>      >? ???? It's not surprising that chisq=9.46 with 2 df could have a
>     lower
>      > p-value than chisq=9.89 with 3 df; the larger the df (i.e. the
>     larger
>      > the difference in the number of parameters/complexity between the
>     two
>      > models implicitly being compared), the more dispersed the null
>      > distribution of the deviance difference (=='chisq').
>      >
>      >? ?? To troubleshoot I would look at the guts of
>     glmmTMB:::Anova.glmmTMB
>      > and see what's going on. I'm not claiming that will be obvious:
>     if you
>      > can post a *reproducible* example to the glmmTMB issues list I'd be
>      > happy to take a look.
>      >
>      > On 2023-01-11 12:14 PM, Elliot Johnston wrote:
>      >> Hi all,
>      >>
>      >> I am using the car package to run ANOVAs (type II Wald chi square
>      >> tests) on
>      >> the following model:
>      >>
>      >> m1 <- glmmTMB(Count ~ Time_Period*Assignment + (1|Region/Site_ID),
>      >> ?????????????????? ziformula = ~ Time_Period*Assignment +
>      >> (1|Region/Site_ID),
>      >> ?????????????????? data = allbirds, family = poisson)
>      >>
>      >> Time Period has three levels and Assignment has two levels. When
>     running
>      >> the ANOVA on the conditional component -- car::Anova(m1, component =
>      >> "cond") -- the degrees of freedom in the output is as I would
>     expected
>      >> (n-1):
>      >>
>      >> ???????????????????????????????? Chisq??? Df? Pr(>Chisq)
>      >> Time_Period??????????? 0.9105? 2??? 0.63429
>      >> Assignment???????????? 2.1043? 1??? 0.14689
>      >> Time_Period:Assignment 6.8486? 2??? 0.03257 *
>      >>
>      >> But when I run the ANOVA for the zero-inflated component --
>      >> car::Anova(m1,
>      >> component = "zi") -- the output looks strange:
>      >>
>      >> ???????????????????????????????? Chisq??? Df Pr(>Chisq)
>      >> Time_Period??????????? 9.8876? 3?? 0.019546 *
>      >> Assignment???????????? 9.4648? 2?? 0.008805 **
>      >> Time_Period:Assignment 7.9605? 2?? 0.018681 *
>      >>
>      >> Why would the degrees of freedom change? FWIW this df
>     discrepancy between
>      >> the conditional and ZI ANOVAs does *not* happen when running the
>     above
>      >> glmmTMB model with subsetted data frames based on different bird
>      >> guilds. It
>      >> also seems strange that between the Time Period and Assignment
>     terms the
>      >> smaller chi square value leads to greater statistical
>     significance. Do
>      >> you
>      >> agree that something seems wrong here or am I misunderstanding
>     what is
>      >> going on under the hood? Any ideas on how to troubleshoot?
>      >>
>      >> Thank you!
>      >>
>      >> -Elliot
>      >>
>      >> ????[[alternative HTML version deleted]]
>      >>
>      >> _______________________________________________
>      >> R-sig-mixed-models at r-project.org
>     <mailto:R-sig-mixed-models at r-project.org> mailing list
>      >> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>      >
>      > _______________________________________________
>      > R-sig-mixed-models at r-project.org
>     <mailto:R-sig-mixed-models at r-project.org> mailing list
>      > https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
> 

-- 
Dr. Benjamin Bolker
Professor, Mathematics & Statistics and Biology, McMaster University
Director, School of Computational Science and Engineering
(Acting) Graduate chair, Mathematics & Statistics
 > E-mail is sent at my convenience; I don't expect replies outside of 
working hours.


From bbo|ker @end|ng |rom gm@||@com  Thu Jan 12 00:24:57 2023
From: bbo|ker @end|ng |rom gm@||@com (Ben Bolker)
Date: Wed, 11 Jan 2023 18:24:57 -0500
Subject: [R-sig-ME] Odd ANOVA degrees of freedom with ZI component of
 glmmTMB model
In-Reply-To: <CAMAqrC5MWi+zfhnLdvPgavC38R0svopyQhSDrd=vXwyKFgX1EA@mail.gmail.com>
References: <CAMAqrC7TUky4s_s4sx5Vkk9+BtG6xydnYt6uJT9C1-tjcr8ViA@mail.gmail.com>
 <17081_1673460776_30BICtef023863_43865e80-2980-fb8d-4d0c-c7024638c8f6@gmail.com>
 <0216a145-f66e-7bd1-a9c2-72de328d083a@mcmaster.ca>
 <CAMAqrC5MWi+zfhnLdvPgavC38R0svopyQhSDrd=vXwyKFgX1EA@mail.gmail.com>
Message-ID: <ca3fb309-a220-c905-a29c-81c96c443bf5@gmail.com>

   It would be great if you can send along a reproducible example, 
privately if necessary.  It's always alarming to have undiagnosed 
weirdness happening, even if you can make it go away by limiting the 
problem ...

On 2023-01-11 6:08 p.m., Elliot Johnston wrote:
> Thanks for getting back to me Ben and John. As I was making a 
> reproducible example for this thread, I dropped all of the dataframe 
> columns not used in the analysis and ended up trimming the dataframe 
> down from 35 columns to 6. The zero-inflated ANOVA output now appears 
> more sensical:
> 
>  > car::Anova(m1, component = "zi")
> 
> Analysis of Deviance Table (Type II Wald chisquare tests)
> 
> Response: Count
> 
>  ? ? ? ? ? ? ? ? ? ? ? ?????????? Chisq?? Df? Pr(>Chisq)
> Time_Period ? ? ? ? ? ?1.9271 ?2 ? ?0.38154
> Assignment ? ? ? ? ? ? 1.5043 ?1 ? ?0.22001
> Time_Period:Assignment 7.9605 ?2 ? ?0.01868 *
> 
> The statistics for the interaction are the same as before, but the Time 
> Period and Assignment terms now make more sense. No observations were 
> dropped and the model specification remained the same, I just dropped a 
> number of columns. Seems strange, but I have the desired output so I 
> don't feel the need to troubleshoot the source of the error at this 
> point. Hope that's alright with you both. Thanks again for getting back 
> to me.
> 
> -Elliot
> 
> On Wed, Jan 11, 2023 at 2:52 PM John Fox <jfox at mcmaster.ca 
> <mailto:jfox at mcmaster.ca>> wrote:
> 
>     Dear Elliot and Ben,
> 
>     Yes, something definitely seems wrong here, and as usual a reproducible
>     example would help. Given that, and as soon as I have some time, I'll
>     try to see what went wrong, but I won't be able to do that this week.
> 
>     My apologies for the problem,
>      ? John
> 
>     John Fox, Professor Emeritus
>     McMaster University
>     Hamilton, Ontario, Canada
>     web: https://socialsciences.mcmaster.ca/jfox/
>     <https://socialsciences.mcmaster.ca/jfox/>
> 
>     On 2023-01-11 1:12 p.m., Ben Bolker wrote:
>      >? ???? The difference in 'Df' between the two components, which
>     appear to
>      > have the same fixed-effect model specification, is definitely
>     surprising.
>      >
>      >? ???? It's not surprising that chisq=9.46 with 2 df could have a
>     lower
>      > p-value than chisq=9.89 with 3 df; the larger the df (i.e. the
>     larger
>      > the difference in the number of parameters/complexity between the
>     two
>      > models implicitly being compared), the more dispersed the null
>      > distribution of the deviance difference (=='chisq').
>      >
>      >? ?? To troubleshoot I would look at the guts of
>     glmmTMB:::Anova.glmmTMB
>      > and see what's going on. I'm not claiming that will be obvious:
>     if you
>      > can post a *reproducible* example to the glmmTMB issues list I'd be
>      > happy to take a look.
>      >
>      > On 2023-01-11 12:14 PM, Elliot Johnston wrote:
>      >> Hi all,
>      >>
>      >> I am using the car package to run ANOVAs (type II Wald chi square
>      >> tests) on
>      >> the following model:
>      >>
>      >> m1 <- glmmTMB(Count ~ Time_Period*Assignment + (1|Region/Site_ID),
>      >> ?????????????????? ziformula = ~ Time_Period*Assignment +
>      >> (1|Region/Site_ID),
>      >> ?????????????????? data = allbirds, family = poisson)
>      >>
>      >> Time Period has three levels and Assignment has two levels. When
>     running
>      >> the ANOVA on the conditional component -- car::Anova(m1, component =
>      >> "cond") -- the degrees of freedom in the output is as I would
>     expected
>      >> (n-1):
>      >>
>      >> ???????????????????????????????? Chisq??? Df? Pr(>Chisq)
>      >> Time_Period??????????? 0.9105? 2??? 0.63429
>      >> Assignment???????????? 2.1043? 1??? 0.14689
>      >> Time_Period:Assignment 6.8486? 2??? 0.03257 *
>      >>
>      >> But when I run the ANOVA for the zero-inflated component --
>      >> car::Anova(m1,
>      >> component = "zi") -- the output looks strange:
>      >>
>      >> ???????????????????????????????? Chisq??? Df Pr(>Chisq)
>      >> Time_Period??????????? 9.8876? 3?? 0.019546 *
>      >> Assignment???????????? 9.4648? 2?? 0.008805 **
>      >> Time_Period:Assignment 7.9605? 2?? 0.018681 *
>      >>
>      >> Why would the degrees of freedom change? FWIW this df
>     discrepancy between
>      >> the conditional and ZI ANOVAs does *not* happen when running the
>     above
>      >> glmmTMB model with subsetted data frames based on different bird
>      >> guilds. It
>      >> also seems strange that between the Time Period and Assignment
>     terms the
>      >> smaller chi square value leads to greater statistical
>     significance. Do
>      >> you
>      >> agree that something seems wrong here or am I misunderstanding
>     what is
>      >> going on under the hood? Any ideas on how to troubleshoot?
>      >>
>      >> Thank you!
>      >>
>      >> -Elliot
>      >>
>      >> ????[[alternative HTML version deleted]]
>      >>
>      >> _______________________________________________
>      >> R-sig-mixed-models at r-project.org
>     <mailto:R-sig-mixed-models at r-project.org> mailing list
>      >> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>      >
>      > _______________________________________________
>      > R-sig-mixed-models at r-project.org
>     <mailto:R-sig-mixed-models at r-project.org> mailing list
>      > https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
> 

-- 
Dr. Benjamin Bolker
Professor, Mathematics & Statistics and Biology, McMaster University
Director, School of Computational Science and Engineering
(Acting) Graduate chair, Mathematics & Statistics
 > E-mail is sent at my convenience; I don't expect replies outside of 
working hours.


From bbo|ker @end|ng |rom gm@||@com  Thu Jan 12 00:24:57 2023
From: bbo|ker @end|ng |rom gm@||@com (Ben Bolker)
Date: Wed, 11 Jan 2023 18:24:57 -0500
Subject: [R-sig-ME] Odd ANOVA degrees of freedom with ZI component of
 glmmTMB model
In-Reply-To: <CAMAqrC5MWi+zfhnLdvPgavC38R0svopyQhSDrd=vXwyKFgX1EA@mail.gmail.com>
References: <CAMAqrC7TUky4s_s4sx5Vkk9+BtG6xydnYt6uJT9C1-tjcr8ViA@mail.gmail.com>
 <17081_1673460776_30BICtef023863_43865e80-2980-fb8d-4d0c-c7024638c8f6@gmail.com>
 <0216a145-f66e-7bd1-a9c2-72de328d083a@mcmaster.ca>
 <CAMAqrC5MWi+zfhnLdvPgavC38R0svopyQhSDrd=vXwyKFgX1EA@mail.gmail.com>
Message-ID: <ca3fb309-a220-c905-a29c-81c96c443bf5@gmail.com>

   It would be great if you can send along a reproducible example, 
privately if necessary.  It's always alarming to have undiagnosed 
weirdness happening, even if you can make it go away by limiting the 
problem ...

On 2023-01-11 6:08 p.m., Elliot Johnston wrote:
> Thanks for getting back to me Ben and John. As I was making a 
> reproducible example for this thread, I dropped all of the dataframe 
> columns not used in the analysis and ended up trimming the dataframe 
> down from 35 columns to 6. The zero-inflated ANOVA output now appears 
> more sensical:
> 
>  > car::Anova(m1, component = "zi")
> 
> Analysis of Deviance Table (Type II Wald chisquare tests)
> 
> Response: Count
> 
>  ? ? ? ? ? ? ? ? ? ? ? ?????????? Chisq?? Df? Pr(>Chisq)
> Time_Period ? ? ? ? ? ?1.9271 ?2 ? ?0.38154
> Assignment ? ? ? ? ? ? 1.5043 ?1 ? ?0.22001
> Time_Period:Assignment 7.9605 ?2 ? ?0.01868 *
> 
> The statistics for the interaction are the same as before, but the Time 
> Period and Assignment terms now make more sense. No observations were 
> dropped and the model specification remained the same, I just dropped a 
> number of columns. Seems strange, but I have the desired output so I 
> don't feel the need to troubleshoot the source of the error at this 
> point. Hope that's alright with you both. Thanks again for getting back 
> to me.
> 
> -Elliot
> 
> On Wed, Jan 11, 2023 at 2:52 PM John Fox <jfox at mcmaster.ca 
> <mailto:jfox at mcmaster.ca>> wrote:
> 
>     Dear Elliot and Ben,
> 
>     Yes, something definitely seems wrong here, and as usual a reproducible
>     example would help. Given that, and as soon as I have some time, I'll
>     try to see what went wrong, but I won't be able to do that this week.
> 
>     My apologies for the problem,
>      ? John
> 
>     John Fox, Professor Emeritus
>     McMaster University
>     Hamilton, Ontario, Canada
>     web: https://socialsciences.mcmaster.ca/jfox/
>     <https://socialsciences.mcmaster.ca/jfox/>
> 
>     On 2023-01-11 1:12 p.m., Ben Bolker wrote:
>      >? ???? The difference in 'Df' between the two components, which
>     appear to
>      > have the same fixed-effect model specification, is definitely
>     surprising.
>      >
>      >? ???? It's not surprising that chisq=9.46 with 2 df could have a
>     lower
>      > p-value than chisq=9.89 with 3 df; the larger the df (i.e. the
>     larger
>      > the difference in the number of parameters/complexity between the
>     two
>      > models implicitly being compared), the more dispersed the null
>      > distribution of the deviance difference (=='chisq').
>      >
>      >? ?? To troubleshoot I would look at the guts of
>     glmmTMB:::Anova.glmmTMB
>      > and see what's going on. I'm not claiming that will be obvious:
>     if you
>      > can post a *reproducible* example to the glmmTMB issues list I'd be
>      > happy to take a look.
>      >
>      > On 2023-01-11 12:14 PM, Elliot Johnston wrote:
>      >> Hi all,
>      >>
>      >> I am using the car package to run ANOVAs (type II Wald chi square
>      >> tests) on
>      >> the following model:
>      >>
>      >> m1 <- glmmTMB(Count ~ Time_Period*Assignment + (1|Region/Site_ID),
>      >> ?????????????????? ziformula = ~ Time_Period*Assignment +
>      >> (1|Region/Site_ID),
>      >> ?????????????????? data = allbirds, family = poisson)
>      >>
>      >> Time Period has three levels and Assignment has two levels. When
>     running
>      >> the ANOVA on the conditional component -- car::Anova(m1, component =
>      >> "cond") -- the degrees of freedom in the output is as I would
>     expected
>      >> (n-1):
>      >>
>      >> ???????????????????????????????? Chisq??? Df? Pr(>Chisq)
>      >> Time_Period??????????? 0.9105? 2??? 0.63429
>      >> Assignment???????????? 2.1043? 1??? 0.14689
>      >> Time_Period:Assignment 6.8486? 2??? 0.03257 *
>      >>
>      >> But when I run the ANOVA for the zero-inflated component --
>      >> car::Anova(m1,
>      >> component = "zi") -- the output looks strange:
>      >>
>      >> ???????????????????????????????? Chisq??? Df Pr(>Chisq)
>      >> Time_Period??????????? 9.8876? 3?? 0.019546 *
>      >> Assignment???????????? 9.4648? 2?? 0.008805 **
>      >> Time_Period:Assignment 7.9605? 2?? 0.018681 *
>      >>
>      >> Why would the degrees of freedom change? FWIW this df
>     discrepancy between
>      >> the conditional and ZI ANOVAs does *not* happen when running the
>     above
>      >> glmmTMB model with subsetted data frames based on different bird
>      >> guilds. It
>      >> also seems strange that between the Time Period and Assignment
>     terms the
>      >> smaller chi square value leads to greater statistical
>     significance. Do
>      >> you
>      >> agree that something seems wrong here or am I misunderstanding
>     what is
>      >> going on under the hood? Any ideas on how to troubleshoot?
>      >>
>      >> Thank you!
>      >>
>      >> -Elliot
>      >>
>      >> ????[[alternative HTML version deleted]]
>      >>
>      >> _______________________________________________
>      >> R-sig-mixed-models at r-project.org
>     <mailto:R-sig-mixed-models at r-project.org> mailing list
>      >> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>      >
>      > _______________________________________________
>      > R-sig-mixed-models at r-project.org
>     <mailto:R-sig-mixed-models at r-project.org> mailing list
>      > https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
> 

-- 
Dr. Benjamin Bolker
Professor, Mathematics & Statistics and Biology, McMaster University
Director, School of Computational Science and Engineering
(Acting) Graduate chair, Mathematics & Statistics
 > E-mail is sent at my convenience; I don't expect replies outside of 
working hours.


From bbo|ker @end|ng |rom gm@||@com  Thu Jan 12 00:27:00 2023
From: bbo|ker @end|ng |rom gm@||@com (Ben Bolker)
Date: Wed, 11 Jan 2023 18:27:00 -0500
Subject: [R-sig-ME] Odd ANOVA degrees of freedom with ZI component of
 glmmTMB model
In-Reply-To: <CAMAqrC5MWi+zfhnLdvPgavC38R0svopyQhSDrd=vXwyKFgX1EA@mail.gmail.com>
References: <CAMAqrC7TUky4s_s4sx5Vkk9+BtG6xydnYt6uJT9C1-tjcr8ViA@mail.gmail.com>
 <17081_1673460776_30BICtef023863_43865e80-2980-fb8d-4d0c-c7024638c8f6@gmail.com>
 <0216a145-f66e-7bd1-a9c2-72de328d083a@mcmaster.ca>
 <CAMAqrC5MWi+zfhnLdvPgavC38R0svopyQhSDrd=vXwyKFgX1EA@mail.gmail.com>
Message-ID: <90ed742c-8811-e257-621c-48673b1c5756@gmail.com>

   It would be great if you can send along a reproducible example, 
privately if necessary.  It's always alarming to have undiagnosed 
weirdness happening, even if you can make it go away by limiting the 
problem ...

On 2023-01-11 6:08 p.m., Elliot Johnston wrote:
> Thanks for getting back to me Ben and John. As I was making a 
> reproducible example for this thread, I dropped all of the dataframe 
> columns not used in the analysis and ended up trimming the dataframe 
> down from 35 columns to 6. The zero-inflated ANOVA output now appears 
> more sensical:
> 
>  > car::Anova(m1, component = "zi")
> 
> Analysis of Deviance Table (Type II Wald chisquare tests)
> 
> Response: Count
> 
>  ? ? ? ? ? ? ? ? ? ? ? ?????????? Chisq?? Df? Pr(>Chisq)
> Time_Period ? ? ? ? ? ?1.9271 ?2 ? ?0.38154
> Assignment ? ? ? ? ? ? 1.5043 ?1 ? ?0.22001
> Time_Period:Assignment 7.9605 ?2 ? ?0.01868 *
> 
> The statistics for the interaction are the same as before, but the Time 
> Period and Assignment terms now make more sense. No observations were 
> dropped and the model specification remained the same, I just dropped a 
> number of columns. Seems strange, but I have the desired output so I 
> don't feel the need to troubleshoot the source of the error at this 
> point. Hope that's alright with you both. Thanks again for getting back 
> to me.
> 
> -Elliot
> 
> On Wed, Jan 11, 2023 at 2:52 PM John Fox <jfox at mcmaster.ca 
> <mailto:jfox at mcmaster.ca>> wrote:
> 
>     Dear Elliot and Ben,
> 
>     Yes, something definitely seems wrong here, and as usual a reproducible
>     example would help. Given that, and as soon as I have some time, I'll
>     try to see what went wrong, but I won't be able to do that this week.
> 
>     My apologies for the problem,
>      ? John
> 
>     John Fox, Professor Emeritus
>     McMaster University
>     Hamilton, Ontario, Canada
>     web: https://socialsciences.mcmaster.ca/jfox/
>     <https://socialsciences.mcmaster.ca/jfox/>
> 
>     On 2023-01-11 1:12 p.m., Ben Bolker wrote:
>      >? ???? The difference in 'Df' between the two components, which
>     appear to
>      > have the same fixed-effect model specification, is definitely
>     surprising.
>      >
>      >? ???? It's not surprising that chisq=9.46 with 2 df could have a
>     lower
>      > p-value than chisq=9.89 with 3 df; the larger the df (i.e. the
>     larger
>      > the difference in the number of parameters/complexity between the
>     two
>      > models implicitly being compared), the more dispersed the null
>      > distribution of the deviance difference (=='chisq').
>      >
>      >? ?? To troubleshoot I would look at the guts of
>     glmmTMB:::Anova.glmmTMB
>      > and see what's going on. I'm not claiming that will be obvious:
>     if you
>      > can post a *reproducible* example to the glmmTMB issues list I'd be
>      > happy to take a look.
>      >
>      > On 2023-01-11 12:14 PM, Elliot Johnston wrote:
>      >> Hi all,
>      >>
>      >> I am using the car package to run ANOVAs (type II Wald chi square
>      >> tests) on
>      >> the following model:
>      >>
>      >> m1 <- glmmTMB(Count ~ Time_Period*Assignment + (1|Region/Site_ID),
>      >> ?????????????????? ziformula = ~ Time_Period*Assignment +
>      >> (1|Region/Site_ID),
>      >> ?????????????????? data = allbirds, family = poisson)
>      >>
>      >> Time Period has three levels and Assignment has two levels. When
>     running
>      >> the ANOVA on the conditional component -- car::Anova(m1, component =
>      >> "cond") -- the degrees of freedom in the output is as I would
>     expected
>      >> (n-1):
>      >>
>      >> ???????????????????????????????? Chisq??? Df? Pr(>Chisq)
>      >> Time_Period??????????? 0.9105? 2??? 0.63429
>      >> Assignment???????????? 2.1043? 1??? 0.14689
>      >> Time_Period:Assignment 6.8486? 2??? 0.03257 *
>      >>
>      >> But when I run the ANOVA for the zero-inflated component --
>      >> car::Anova(m1,
>      >> component = "zi") -- the output looks strange:
>      >>
>      >> ???????????????????????????????? Chisq??? Df Pr(>Chisq)
>      >> Time_Period??????????? 9.8876? 3?? 0.019546 *
>      >> Assignment???????????? 9.4648? 2?? 0.008805 **
>      >> Time_Period:Assignment 7.9605? 2?? 0.018681 *
>      >>
>      >> Why would the degrees of freedom change? FWIW this df
>     discrepancy between
>      >> the conditional and ZI ANOVAs does *not* happen when running the
>     above
>      >> glmmTMB model with subsetted data frames based on different bird
>      >> guilds. It
>      >> also seems strange that between the Time Period and Assignment
>     terms the
>      >> smaller chi square value leads to greater statistical
>     significance. Do
>      >> you
>      >> agree that something seems wrong here or am I misunderstanding
>     what is
>      >> going on under the hood? Any ideas on how to troubleshoot?
>      >>
>      >> Thank you!
>      >>
>      >> -Elliot
>      >>
>      >> ????[[alternative HTML version deleted]]
>      >>
>      >> _______________________________________________
>      >> R-sig-mixed-models at r-project.org
>     <mailto:R-sig-mixed-models at r-project.org> mailing list
>      >> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>      >
>      > _______________________________________________
>      > R-sig-mixed-models at r-project.org
>     <mailto:R-sig-mixed-models at r-project.org> mailing list
>      > https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
> 

-- 
Dr. Benjamin Bolker
Professor, Mathematics & Statistics and Biology, McMaster University
Director, School of Computational Science and Engineering
(Acting) Graduate chair, Mathematics & Statistics
> E-mail is sent at my convenience; I don't expect replies outside of 
working hours.


From j|ox @end|ng |rom mcm@@ter@c@  Thu Jan 12 00:31:21 2023
From: j|ox @end|ng |rom mcm@@ter@c@ (John Fox)
Date: Wed, 11 Jan 2023 18:31:21 -0500
Subject: [R-sig-ME] Odd ANOVA degrees of freedom with ZI component of
 glmmTMB model
In-Reply-To: <90ed742c-8811-e257-621c-48673b1c5756@gmail.com>
References: <CAMAqrC7TUky4s_s4sx5Vkk9+BtG6xydnYt6uJT9C1-tjcr8ViA@mail.gmail.com>
 <17081_1673460776_30BICtef023863_43865e80-2980-fb8d-4d0c-c7024638c8f6@gmail.com>
 <0216a145-f66e-7bd1-a9c2-72de328d083a@mcmaster.ca>
 <CAMAqrC5MWi+zfhnLdvPgavC38R0svopyQhSDrd=vXwyKFgX1EA@mail.gmail.com>
 <90ed742c-8811-e257-621c-48673b1c5756@gmail.com>
Message-ID: <1c81c2fa-956e-209e-1688-2c8a1fdad02d@mcmaster.ca>

Dear Elliot,

On 2023-01-11 6:27 p.m., Ben Bolker wrote:
>  ? It would be great if you can send along a reproducible example, 
> privately if necessary.? It's always alarming to have undiagnosed 
> weirdness happening, even if you can make it go away by limiting the 
> problem ...

Exactly!

Elliot: When you had a problem, I'm sure that you appreciated the fact 
the Ben volunteered to try to help -- even though he's not responsible 
for car::Anova().

Wouldn't you like to help future users who may step on the same bug that 
you did? Of course, that assumes that there is a bug in car:Anova() and 
not another explanation for the anomaly. In either case, it would be 
useful to know what went on.

Best,
  John

> 
> On 2023-01-11 6:08 p.m., Elliot Johnston wrote:
>> Thanks for getting back to me Ben and John. As I was making a 
>> reproducible example for this thread, I dropped all of the dataframe 
>> columns not used in the analysis and ended up trimming the dataframe 
>> down from 35 columns to 6. The zero-inflated ANOVA output now appears 
>> more sensical:
>>
>> ?> car::Anova(m1, component = "zi")
>>
>> Analysis of Deviance Table (Type II Wald chisquare tests)
>>
>> Response: Count
>>
>> ?? ? ? ? ? ? ? ? ? ? ? ?????????? Chisq?? Df? Pr(>Chisq)
>> Time_Period ? ? ? ? ? ?1.9271 ?2 ? ?0.38154
>> Assignment ? ? ? ? ? ? 1.5043 ?1 ? ?0.22001
>> Time_Period:Assignment 7.9605 ?2 ? ?0.01868 *
>>
>> The statistics for the interaction are the same as before, but the 
>> Time Period and Assignment terms now make more sense. No observations 
>> were dropped and the model specification remained the same, I just 
>> dropped a number of columns. Seems strange, but I have the desired 
>> output so I don't feel the need to troubleshoot the source of the 
>> error at this point. Hope that's alright with you both. Thanks again 
>> for getting back to me.
>>
>> -Elliot
>>
>> On Wed, Jan 11, 2023 at 2:52 PM John Fox <jfox at mcmaster.ca 
>> <mailto:jfox at mcmaster.ca>> wrote:
>>
>> ??? Dear Elliot and Ben,
>>
>> ??? Yes, something definitely seems wrong here, and as usual a 
>> reproducible
>> ??? example would help. Given that, and as soon as I have some time, I'll
>> ??? try to see what went wrong, but I won't be able to do that this week.
>>
>> ??? My apologies for the problem,
>> ???? ? John
>>
>> ??? John Fox, Professor Emeritus
>> ??? McMaster University
>> ??? Hamilton, Ontario, Canada
>> ??? web: https://socialsciences.mcmaster.ca/jfox/
>> ??? <https://socialsciences.mcmaster.ca/jfox/>
>>
>> ??? On 2023-01-11 1:12 p.m., Ben Bolker wrote:
>> ???? >? ???? The difference in 'Df' between the two components, which
>> ??? appear to
>> ???? > have the same fixed-effect model specification, is definitely
>> ??? surprising.
>> ???? >
>> ???? >? ???? It's not surprising that chisq=9.46 with 2 df could have a
>> ??? lower
>> ???? > p-value than chisq=9.89 with 3 df; the larger the df (i.e. the
>> ??? larger
>> ???? > the difference in the number of parameters/complexity between the
>> ??? two
>> ???? > models implicitly being compared), the more dispersed the null
>> ???? > distribution of the deviance difference (=='chisq').
>> ???? >
>> ???? >? ?? To troubleshoot I would look at the guts of
>> ??? glmmTMB:::Anova.glmmTMB
>> ???? > and see what's going on. I'm not claiming that will be obvious:
>> ??? if you
>> ???? > can post a *reproducible* example to the glmmTMB issues list 
>> I'd be
>> ???? > happy to take a look.
>> ???? >
>> ???? > On 2023-01-11 12:14 PM, Elliot Johnston wrote:
>> ???? >> Hi all,
>> ???? >>
>> ???? >> I am using the car package to run ANOVAs (type II Wald chi square
>> ???? >> tests) on
>> ???? >> the following model:
>> ???? >>
>> ???? >> m1 <- glmmTMB(Count ~ Time_Period*Assignment + 
>> (1|Region/Site_ID),
>> ???? >> ?????????????????? ziformula = ~ Time_Period*Assignment +
>> ???? >> (1|Region/Site_ID),
>> ???? >> ?????????????????? data = allbirds, family = poisson)
>> ???? >>
>> ???? >> Time Period has three levels and Assignment has two levels. When
>> ??? running
>> ???? >> the ANOVA on the conditional component -- car::Anova(m1, 
>> component =
>> ???? >> "cond") -- the degrees of freedom in the output is as I would
>> ??? expected
>> ???? >> (n-1):
>> ???? >>
>> ???? >> ???????????????????????????????? Chisq??? Df? Pr(>Chisq)
>> ???? >> Time_Period??????????? 0.9105? 2??? 0.63429
>> ???? >> Assignment???????????? 2.1043? 1??? 0.14689
>> ???? >> Time_Period:Assignment 6.8486? 2??? 0.03257 *
>> ???? >>
>> ???? >> But when I run the ANOVA for the zero-inflated component --
>> ???? >> car::Anova(m1,
>> ???? >> component = "zi") -- the output looks strange:
>> ???? >>
>> ???? >> ???????????????????????????????? Chisq??? Df Pr(>Chisq)
>> ???? >> Time_Period??????????? 9.8876? 3?? 0.019546 *
>> ???? >> Assignment???????????? 9.4648? 2?? 0.008805 **
>> ???? >> Time_Period:Assignment 7.9605? 2?? 0.018681 *
>> ???? >>
>> ???? >> Why would the degrees of freedom change? FWIW this df
>> ??? discrepancy between
>> ???? >> the conditional and ZI ANOVAs does *not* happen when running the
>> ??? above
>> ???? >> glmmTMB model with subsetted data frames based on different bird
>> ???? >> guilds. It
>> ???? >> also seems strange that between the Time Period and Assignment
>> ??? terms the
>> ???? >> smaller chi square value leads to greater statistical
>> ??? significance. Do
>> ???? >> you
>> ???? >> agree that something seems wrong here or am I misunderstanding
>> ??? what is
>> ???? >> going on under the hood? Any ideas on how to troubleshoot?
>> ???? >>
>> ???? >> Thank you!
>> ???? >>
>> ???? >> -Elliot
>> ???? >>
>> ???? >> ????[[alternative HTML version deleted]]
>> ???? >>
>> ???? >> _______________________________________________
>> ???? >> R-sig-mixed-models at r-project.org
>> ??? <mailto:R-sig-mixed-models at r-project.org> mailing list
>> ???? >> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>> ??? <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>> ???? >
>> ???? > _______________________________________________
>> ???? > R-sig-mixed-models at r-project.org
>> ??? <mailto:R-sig-mixed-models at r-project.org> mailing list
>> ???? > https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>> ??? <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>>
>


From |@w|@wt @end|ng |rom gm@||@com  Sat Jan 14 20:44:57 2023
From: |@w|@wt @end|ng |rom gm@||@com (Timothy MacKenzie)
Date: Sat, 14 Jan 2023 13:44:57 -0600
Subject: [R-sig-ME] Graphical validation of residuals of two models or their
 AICc?
Message-ID: <CADreqiwGQzXpdPArBnNuxpAeZjPvBDS9F6PqiGpe=a-zUPH4Ww@mail.gmail.com>

Dear All,

I'm deciding between two candidate models (m1 and m2). AICc shows that m2
is to be preferred over m1.

However, when I plot the residuals of m1 and m2, residuals of m1 look more
reasonable than those of m2.

I wonder which criteria to rely on to choose my model: graphical validation
of residuals of the two models or their AICc?

Thank you,
Tim M
#-----------------------------------------#
dat <- read.csv("https://raw.githubusercontent.com/fpqq/w/main/c.csv")
dat <- transform(dat, time = factor(time))

library(nlme)
m1 <- lme(score ~ time*cal,
random = list(id = pdDiag(~cal +0)),
data = dat,
weights = varIdent(form = ~ cal:time),
control = lmeControl(msMaxIter  = 2e2))

m2 <- lme(score ~ time*cal,
          random = list(id = pdDiag(~cal:time +0)),
          data = dat,
          weights = varIdent(form = ~ cal:time),
          control = lmeControl(msMaxIter  = 2e2))

library(bbmle)

AICctab(m1, m2)

plot(m1)
plot(m2)
#-----------------------------------------#

	[[alternative HTML version deleted]]


From @pro @end|ng |rom un|me|b@edu@@u  Sun Jan 15 21:31:57 2023
From: @pro @end|ng |rom un|me|b@edu@@u (Andrew Robinson)
Date: Sun, 15 Jan 2023 20:31:57 +0000
Subject: [R-sig-ME] 
 Graphical validation of residuals of two models or their AICc?
In-Reply-To: <CADreqiwGQzXpdPArBnNuxpAeZjPvBDS9F6PqiGpe=a-zUPH4Ww@mail.gmail.com>
References: <CADreqiwGQzXpdPArBnNuxpAeZjPvBDS9F6PqiGpe=a-zUPH4Ww@mail.gmail.com>
Message-ID: <5561ca2b-26a8-480d-ba06-5fd0587ca534@Spark>

Neither residual plot really floats my boat.  Presumably you have reasons to compare these model specifications that are unrelated to the data as we see them.  Ultimately it depends on the use to which the model will be put. Are you trying to estimate parameters with uncertainty or to make a prediction of some future state or something else?

I'd note that AIC is computed from LL at its maximum conditional on the model.  If the model is wrong then the MLE is unknowably wrong and the AIC is unknowably wrong. So absent other context I focus on the information that is available about the model, namely the residual plots.

I'd add that making time a factor is a curious decision.

Cheers,

Andrew

--
Andrew Robinson
Chief Executive Officer, CEBRA and Professor of Biosecurity,
School/s of BioSciences and Mathematics & Statistics
University of Melbourne, VIC 3010 Australia
Tel: (+61) 0403 138 955
Email: apro at unimelb.edu.au
Website: https://researchers.ms.unimelb.edu.au/~apro at unimelb/

I acknowledge the Traditional Owners of the land I inhabit, and pay my respects to their Elders.
On 15 Jan 2023 at 6:45 AM +1100, Timothy MacKenzie <fswfswt at gmail.com>, wrote:
Dear All,

I'm deciding between two candidate models (m1 and m2). AICc shows that m2
is to be preferred over m1.

However, when I plot the residuals of m1 and m2, residuals of m1 look more
reasonable than those of m2.

I wonder which criteria to rely on to choose my model: graphical validation
of residuals of the two models or their AICc?

Thank you,
Tim M
#-----------------------------------------#
dat <- read.csv("https://raw.githubusercontent.com/fpqq/w/main/c.csv")
dat <- transform(dat, time = factor(time))

library(nlme)
m1 <- lme(score ~ time*cal,
random = list(id = pdDiag(~cal +0)),
data = dat,
weights = varIdent(form = ~ cal:time),
control = lmeControl(msMaxIter = 2e2))

m2 <- lme(score ~ time*cal,
random = list(id = pdDiag(~cal:time +0)),
data = dat,
weights = varIdent(form = ~ cal:time),
control = lmeControl(msMaxIter = 2e2))

library(bbmle)

AICctab(m1, m2)

plot(m1)
plot(m2)
#-----------------------------------------#

[[alternative HTML version deleted]]

_______________________________________________
R-sig-mixed-models at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models


	[[alternative HTML version deleted]]


From |@w|@wt @end|ng |rom gm@||@com  Sun Jan 15 22:41:04 2023
From: |@w|@wt @end|ng |rom gm@||@com (Timothy MacKenzie)
Date: Sun, 15 Jan 2023 15:41:04 -0600
Subject: [R-sig-ME] 
 Graphical validation of residuals of two models or their AICc?
In-Reply-To: <5561ca2b-26a8-480d-ba06-5fd0587ca534@Spark>
References: <CADreqiwGQzXpdPArBnNuxpAeZjPvBDS9F6PqiGpe=a-zUPH4Ww@mail.gmail.com>
 <5561ca2b-26a8-480d-ba06-5fd0587ca534@Spark>
Message-ID: <CADreqiwfbJFNqy9kNmWmQYNhn5MGbvQBZnVK92Z5w=asVLWnLg@mail.gmail.com>

Dear Andrew,

Thank you for the thoughtful comments. I'm mainly trying to estimate
parameters with uncertainty.

The model is a multivariate multilevel model where `cal` defines the
dependent variables. It does seem that the `cal` variables (there are 7 of
them) don't correlate much with each other for each subject (`id`) across
all subjects. As a result, I used `id = pdDiag(~cal +0)` to honor this
feature.

The problem I'm facing is that the `cal` variables have very different
descriptive statistics (e.g., their range varies substantially). As a
result, I did expect the residuals of the model to be wild. To partly
mitigate this, I let the residuals be spread differently across `cal:time`
combinations for each subject across all subjects, that is: `weights =
varIdent(form = ~ cal:time)`, correction: it must have been: `varIdent(form
= ~ 1|cal*time)` .

On the issue of residuals, there is one thought that comes my mind: For a
multivariate multilevel model like mine, is it even fair to look at
residuals like univariate multilevel models, that is: simply
`plot(fitted(m2), resid(m2, type="normalized"))` OR rather we should break
the residuals down by `cal` levels across `id` levels and then look at the
residuals' pattern?

My suggestion in the previous paragraph is based on the following post from
our archives: (
https://stat.ethz.ch/pipermail/r-sig-mixed-models/2020q2/028684.html)

Thanks,
Tim M


On Sun, Jan 15, 2023 at 2:32 PM Andrew Robinson <apro at unimelb.edu.au> wrote:

> Neither residual plot really floats my boat.  Presumably you have reasons
> to compare these model specifications that are unrelated to the data as we
> see them.  Ultimately it depends on the use to which the model will be put.
> Are you trying to estimate parameters with uncertainty or to make a
> prediction of some future state or something else?
>
> I'd note that AIC is computed from LL at its maximum conditional on the
> model.  If the model is wrong then the MLE is unknowably wrong and the AIC
> is unknowably wrong. So absent other context I focus on the information
> that is available about the model, namely the residual plots.
>
> I'd add that making time a factor is a curious decision.
>
> Cheers,
>
> Andrew
>
> --
> Andrew Robinson
> Chief Executive Officer, CEBRA and Professor of Biosecurity,
> School/s of BioSciences and Mathematics & Statistics
> University of Melbourne, VIC 3010 Australia
> Tel: (+61) 0403 138 955
> Email: apro at unimelb.edu.au
> Website: https://researchers.ms.unimelb.edu.au/~apro at unimelb/
>
> I acknowledge the Traditional Owners of the land I inhabit, and pay my
> respects to their Elders.
> On 15 Jan 2023 at 6:45 AM +1100, Timothy MacKenzie <fswfswt at gmail.com>,
> wrote:
>
> Dear All,
>
> I'm deciding between two candidate models (m1 and m2). AICc shows that m2
> is to be preferred over m1.
>
> However, when I plot the residuals of m1 and m2, residuals of m1 look more
> reasonable than those of m2.
>
> I wonder which criteria to rely on to choose my model: graphical validation
> of residuals of the two models or their AICc?
>
> Thank you,
> Tim M
> #-----------------------------------------#
> dat <- read.csv("https://raw.githubusercontent.com/fpqq/w/main/c.csv")
> dat <- transform(dat, time = factor(time))
>
> library(nlme)
> m1 <- lme(score ~ time*cal,
> random = list(id = pdDiag(~cal +0)),
> data = dat,
> weights = varIdent(form = ~ cal:time),
> control = lmeControl(msMaxIter = 2e2))
>
> m2 <- lme(score ~ time*cal,
> random = list(id = pdDiag(~cal:time +0)),
> data = dat,
> weights = varIdent(form = ~ cal:time),
> control = lmeControl(msMaxIter = 2e2))
>
> library(bbmle)
>
> AICctab(m1, m2)
>
> plot(m1)
> plot(m2)
> #-----------------------------------------#
>
> [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>
>

	[[alternative HTML version deleted]]


From @pro @end|ng |rom un|me|b@edu@@u  Tue Jan 17 02:39:19 2023
From: @pro @end|ng |rom un|me|b@edu@@u (Andrew Robinson)
Date: Tue, 17 Jan 2023 01:39:19 +0000
Subject: [R-sig-ME] [EXT] Re: Graphical validation of residuals of two
 models or their AICc?
In-Reply-To: <CADreqiwfbJFNqy9kNmWmQYNhn5MGbvQBZnVK92Z5w=asVLWnLg@mail.gmail.com>
References: <CADreqiwGQzXpdPArBnNuxpAeZjPvBDS9F6PqiGpe=a-zUPH4Ww@mail.gmail.com>
 <5561ca2b-26a8-480d-ba06-5fd0587ca534@Spark>
 <CADreqiwfbJFNqy9kNmWmQYNhn5MGbvQBZnVK92Z5w=asVLWnLg@mail.gmail.com>
Message-ID: <7d33ffaf-34f9-40c4-a1eb-39181c7ef6e4@Spark>

Hi Tim,

Presumably the inference will be across all levels, and the model reports SE based on all the data.  In that case, I think that you're needing to look at all the model at once.

I'm afraid that I can't offer any further insight without a deeper dive into the data and model than I have time for.

In passing, I'd suggest that the lack of correlation within subject is a testable claim.

Cheers

Andrew

--
Andrew Robinson
Chief Executive Officer, CEBRA and Professor of Biosecurity,
School/s of BioSciences and Mathematics & Statistics
University of Melbourne, VIC 3010 Australia
Tel: (+61) 0403 138 955
Email: apro at unimelb.edu.au
Website: https://researchers.ms.unimelb.edu.au/~apro at unimelb/

I acknowledge the Traditional Owners of the land I inhabit, and pay my respects to their Elders.
On 16 Jan 2023 at 8:42 AM +1100, Timothy MacKenzie <fswfswt at gmail.com>, wrote:
External email: Please exercise caution

________________________________
Dear Andrew,

Thank you for the thoughtful comments. I'm mainly trying to estimate parameters with uncertainty.

The model is a multivariate multilevel model where `cal` defines the dependent variables. It does seem that the `cal` variables (there are 7 of them) don't correlate much with each other for each subject (`id`) across all subjects. As a result, I used `id = pdDiag(~cal +0)` to honor this feature.

The problem I'm facing is that the `cal` variables have very different descriptive statistics (e.g., their range varies substantially). As a result, I did expect the residuals of the model to be wild. To partly mitigate this, I let the residuals be spread differently across `cal:time` combinations for each subject across all subjects, that is: `weights = varIdent(form = ~ cal:time)`, correction: it must have been: `varIdent(form = ~ 1|cal*time)` .

On the issue of residuals, there is one thought that comes my mind: For a multivariate multilevel model like mine, is it even fair to look at residuals like univariate multilevel models, that is: simply `plot(fitted(m2), resid(m2, type="normalized"))` OR rather we should break the residuals down by `cal` levels across `id` levels and then look at the residuals' pattern?

My suggestion in the previous paragraph is based on the following post from our archives: (https://stat.ethz.ch/pipermail/r-sig-mixed-models/2020q2/028684.html<https://stat.ethz.ch/pipermail/r-sig-mixed-models/2020q2/028684.html>)

Thanks,
Tim M


On Sun, Jan 15, 2023 at 2:32 PM Andrew Robinson <apro at unimelb.edu.au<mailto:apro at unimelb.edu.au>> wrote:
Neither residual plot really floats my boat.  Presumably you have reasons to compare these model specifications that are unrelated to the data as we see them.  Ultimately it depends on the use to which the model will be put. Are you trying to estimate parameters with uncertainty or to make a prediction of some future state or something else?

I'd note that AIC is computed from LL at its maximum conditional on the model.  If the model is wrong then the MLE is unknowably wrong and the AIC is unknowably wrong. So absent other context I focus on the information that is available about the model, namely the residual plots.

I'd add that making time a factor is a curious decision.

Cheers,

Andrew

--
Andrew Robinson
Chief Executive Officer, CEBRA and Professor of Biosecurity,
School/s of BioSciences and Mathematics & Statistics
University of Melbourne, VIC 3010 Australia
Tel: (+61) 0403 138 955
Email: apro at unimelb.edu.au<mailto:apro at unimelb.edu.au>
Website: https://researchers.ms.unimelb.edu.au/~apro at unimelb/

I acknowledge the Traditional Owners of the land I inhabit, and pay my respects to their Elders.
On 15 Jan 2023 at 6:45 AM +1100, Timothy MacKenzie <fswfswt at gmail.com<mailto:fswfswt at gmail.com>>, wrote:
Dear All,

I'm deciding between two candidate models (m1 and m2). AICc shows that m2
is to be preferred over m1.

However, when I plot the residuals of m1 and m2, residuals of m1 look more
reasonable than those of m2.

I wonder which criteria to rely on to choose my model: graphical validation
of residuals of the two models or their AICc?

Thank you,
Tim M
#-----------------------------------------#
dat <- read.csv("https://raw.githubusercontent.com/fpqq/w/main/c.csv<https://raw.githubusercontent.com/fpqq/w/main/c.csv>")
dat <- transform(dat, time = factor(time))

library(nlme)
m1 <- lme(score ~ time*cal,
random = list(id = pdDiag(~cal +0)),
data = dat,
weights = varIdent(form = ~ cal:time),
control = lmeControl(msMaxIter = 2e2))

m2 <- lme(score ~ time*cal,
random = list(id = pdDiag(~cal:time +0)),
data = dat,
weights = varIdent(form = ~ cal:time),
control = lmeControl(msMaxIter = 2e2))

library(bbmle)

AICctab(m1, m2)

plot(m1)
plot(m2)
#-----------------------------------------#

[[alternative HTML version deleted]]

_______________________________________________
R-sig-mixed-models at r-project.org<mailto:R-sig-mixed-models at r-project.org> mailing list
https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models<https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>


	[[alternative HTML version deleted]]


From benpe|zer @end|ng |rom gm@||@com  Tue Jan 17 16:10:20 2023
From: benpe|zer @end|ng |rom gm@||@com (ben pelzer)
Date: Tue, 17 Jan 2023 16:10:20 +0100
Subject: [R-sig-ME] subject-specific interpetation two random effects
In-Reply-To: <CAFgPNS8Dt4V8ECBbj5m8xqCvTh+NqQ34jNvOBL+Z+qUycNRgDA@mail.gmail.com>
References: <CAFgPNS-cZLVJ4yM1R2XwCYUNeiMpcx2xmgUiECqknyQcdTAZbA@mail.gmail.com>
 <PAXPR04MB9277D37C26217AE420FD65D8E8F39@PAXPR04MB9277.eurprd04.prod.outlook.com>
 <CAFgPNS8Dt4V8ECBbj5m8xqCvTh+NqQ34jNvOBL+Z+qUycNRgDA@mail.gmail.com>
Message-ID: <CAFgPNS8BBF8VfLTZSvf6VcpAXBwMKP=nfyUqjNA42n_rokJ68w@mail.gmail.com>

Dear Dimitris and others,

I would like to get back to the problem posted a while ago: different
estimates for correlated vs. uncorrelated intercepts of two groups, males
and females. The problem can be put more simply than I did before.

Let's assume a LINEAR random intercept null-model for the Y value of male i
in school j: Yij = b0 + uj + eij, with b0 being the grand mean (for males),
uj being the deviation of school j from the grand mean (for males), and eij
the individual error of male pupil i in school j. For females the model is
similar: Yij = a0 + vj + eij with grand mean a0, and vj  the deviation of
school j from the grand mean (for females).

I first estimated both models separately (with lme), leading to particular
estimates of the fixed effects a0 and b0.

mmale    <- lme(y ~ 1, random = ~ 1|school, data=damale,
control=lmeControl(opt="optim"))
mfemale  <- lme(y ~ 1, random = ~ 1|school, data=dafemale,
control=lmeControl(opt="optim"))

I then estimated both models simultaneously, in two ways: the first model
below has correlated intercepts (uj and vj), the second model has
independent intercepts:

mboth_corr <- lme(y ~ 0+male+female, random = ~ 0+male+female|school,
                      weights = varIdent(form= ~ 1 | male), data=da,
                      control=lmeControl(opt="optim"))

mboth_indep <- lme(y ~ 0+male+female, random = list(school = pdDiag(~
0+male+female)),
                       weights = varIdent(form= ~ 1 | male), data=da)

"male" and "female" are 0/1 indicators of gender.

For model "mboth_indep" the fixed estimates of "male" and "female" are
equal to the fixed intercept estimates of the separate models "mmale" and
"mfemale".
However, for model "mboth_corr, the fixed estimates  of "male" and "female"
are (in general) NOT equal to the fixed intercept estimates of the separate
models "mmale" and "mfemale". I find this hard to understand... Apparently,
allowing correlation between uj and vj leads to a better model (lower
deviance) but also to a different grand mean estimate for males as well as
for females.

What is more: if I simulate data in which all schools have the same (even)
number of pupils, half of which are male, half of which female, then using
"mboth_corr" with correlated intercepts does NOT lead to estimates
different from the ones in the separate models. Why is this the case?

I would really appreciate some explanation of these complex (for me)
results. Thanks in advance for any help!

Ben.





On Fri, 30 Dec 2022 at 15:38, ben pelzer <benpelzer at gmail.com> wrote:

> Dear Dimitris,
>
> Thanks for your response, that was really helpful and the estimates are
> now as good as equal!
>
> I thought the difference was caused by the subject-specific
> interpretation, which for the interaction model "mab" is different than for
> the two separate models, if I'm right ...
>
> After reading your comment, I also tried linear models (using lme) for
> males/females separately and for the two groups combined using interaction
> (for linear models the subject-specific interpretation would not make a
> difference). Again it appeared that allowing for correlation of the
> intercepts for males and females leads to slightly different estimates of
> the fixed effects, whereas no correlation leads to exactly the same fixed
> effects as in the separate analyses.
>
> Thanks for your help, and, of course, a happy and healthy 2023,
>
> Ben.
>
>
> On Thu, 29 Dec 2022 at 07:37, Dimitris Rizopoulos <
> d.rizopoulos at erasmusmc.nl> wrote:
>
>> The last model says that the random effects for males and females are
>> correlated-you would need to assume independent random effects.
>>
>> Best,
>> Dimitris
>>
>>
>> ??
>> Dimitris Rizopoulos
>> Professor of Biostatistics
>> Erasmus University Medical Center
>> The Netherlands
>> ------------------------------
>> *From:* R-sig-mixed-models <r-sig-mixed-models-bounces at r-project.org> on
>> behalf of ben pelzer <benpelzer at gmail.com>
>> *Sent:* Wednesday, December 28, 2022 3:13:26 PM
>> *To:* r-sig-mixed-models <r-sig-mixed-models at r-project.org>
>> *Subject:* [R-sig-ME] subject-specific interpetation two random effects
>>
>>
>>
>> Waarschuwing: Deze e-mail is afkomstig van buiten de organisatie. Klik
>> niet op links en open geen bijlagen, tenzij u de afzender herkent en weet
>> dat de inhoud veilig is.
>> Caution: This email originated from outside of the organization. Do not
>> click links or open attachments unless you recognize the sender and know
>> the content is safe.
>>
>>
>>
>> Dear list,
>>
>> Sorry for cross-posting this question; I got no response on Cross
>> Validated. Hope to get one here.
>>
>>
>> I have two groups of pupils, males and females in a number of schools. So,
>> two-level data, pupils nested in schools. For each gender group, a
>> logistic
>> model was estimated with a school-level predictor "type" of school. Next,
>> a
>> "complete" model was estimated for both gender groups simultaneously. Here
>> is the syntax I used:
>>
>>
>> library(GLMMadaptive)
>>
>>
>> ma  <- mixed_model(y ~ 1+type, random=~ 1|school, family=binomial,
>> data=maledata)
>>
>>
>>
>> mb  <- mixed_model(y ~ 1+type, random=~ 1|school, family=binomial,
>> data=femaledata)
>>
>>
>>
>> mab <- mixed_model(y ~ 0+male+female+type:male+type:female,
>>
>>                    random=~ 0+male+female|school, family=binomial,
>> data=completedata)
>>
>>
>> The final model mab uses interaction terms and is specified without
>> intercepts, so that its estimates can directly be compared with those of
>> the separate group models ma and mb.
>>
>>
>> I expected that the final "complete" model mab would give the same
>> estimates for the effects of "type" as the separate models do. More in
>> particular, that the regression coefficients of type:male and type:female
>> in model mab would be equal to the coefficients of "type" in ma and mb,
>> respectively.
>>
>>
>> However, this is not (exactly) the case: the coefficients are relatively
>> close, but clearly not equal. I first thought that these dissimilarities
>> might be due to the number of quadrature points used by mixed_model.
>> Hence,
>> I chose larger values for nAGQ but this did not help: the dissimilarities
>> persist, and all estimates hardly change. Also, no convergence problems
>> exist, everything seems all right.
>>
>>
>> Now my guess is that these differences are caused by the fact that the
>> regression coefficients are subject-specific. That is, for model ma, the
>> effect of "type" expresses the influence of schooltype for two schools
>> with
>> the same random school effect across male pupils. In contrast, the effect
>> of "type" in model mab expresses the effect of schooltype for two schools
>> with the same random school effect across male pupils and also across
>> female pupils. So in mab, there are two random school effects, one for
>> males and the other for females, which BOTH have to be equal. It toke me
>> quite a while to realise this, and still I'm not completely sure. I would
>> really appreciate it if someone could confirm my suspicion. Thanks!!!
>>
>>
>> Ben.
>>
>>         [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-mixed-models at r-project.org mailing list
>>
>> https://eur01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-sig-mixed-models&data=05%7C01%7Cd.rizopoulos%40erasmusmc.nl%7C09a5f446bc1443dd190608dae8ddbf2a%7C526638ba6af34b0fa532a1a511f4ac80%7C0%7C0%7C638078336334964127%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=FAr0RrkoPQSniGE4JOjKQzQfjkohGTucLO0VC3R93oE%3D&reserved=0
>>
>

	[[alternative HTML version deleted]]


From @|m@h@rme| @end|ng |rom gm@||@com  Mon Jan 23 01:45:35 2023
From: @|m@h@rme| @end|ng |rom gm@||@com (Simon Harmel)
Date: Sun, 22 Jan 2023 18:45:35 -0600
Subject: [R-sig-ME] ICC for mixed models with modeled residuals
Message-ID: <CACgv6yWLtkG6fHrNnryFygehpaC68ek33r-DmMyU15B9-RSehQ@mail.gmail.com>

Hello All,

I was wondering if for models like below, there is a standard way to
calculate the ICC given the extra modeling of residuals?

Any possible `R` package capable of calculating ICC for such models?

Thank you,
Simon

 lme(yij ~ X1 + X2 ...,
         random = ~1| subject,
         data = data,
         subset = DV == "DV1",
         correlation = corSymm(~1|subject),
         weights = varComb(varIdent(form = ~ 1 | X1),
                                          varPower(form = ~ X2)))


  glmmTMB(yij ~ X1 + X2 + ... + (1|subject),
               family = beta_family(), data = subset(data, DV =="DV2"),
               dispformula = ~X1 + X2)


From ci@udi@@k@sper-voeiki m@iii@g oii @groscope@@dmi@@ch  Mon Jan 23 08:34:10 2023
From: ci@udi@@k@sper-voeiki m@iii@g oii @groscope@@dmi@@ch (ci@udi@@k@sper-voeiki m@iii@g oii @groscope@@dmi@@ch)
Date: Mon, 23 Jan 2023 07:34:10 +0000
Subject: [R-sig-ME] MCMCglmm: can one combine different prior distributions
 in one model?
In-Reply-To: <78c061a102134f5697070804e6a083b2@agroscope.admin.ch>
References: <78c061a102134f5697070804e6a083b2@agroscope.admin.ch>
Message-ID: <9dd4dfa925c74534bb8c61712aa8e313@agroscope.admin.ch>

Dear list,

We are currently investigating heritability of protein efficiency in pigs. Protein efficiency is the amount of protein found in muscle tissue over the amount of protein in the feed an animal ingested over a certain period. By design, this variable is bound between 0 and 1, and it is quite narrowly symmetrically distributed (mean = 0.39, SD = 0.04, min = 0.18, max 0.64).

We ran an analysis with MCMCglmm on data from around 1000 pigs from a paternal half-sib design, an animal model which contained two random effects (an animal effect and litter effect). There were no convergence issues, and the model diagnostics we checked (trace plots, autocorrelation, Heidelberger diagnostic, and effective size) looked all very reasonable. The heritability was 0.43 [0.29, 0.58] and the litter effect 0.12 [0.07, 0.17] - 95% credible intervals in brackets.

modelH <- MCMCglmm(prot_eff_carcass ~ year + slaughterweight + treatment2 + sex + age + temp + treatment2*age + Y_change1*age + slaughterweight*sex + treatment2*sex,
                   random = ~animal+sibship, family = "gaussian",
                   prior = prior, pedigree = ped, data = herit2, nitt = 2000000,
                   burnin = 100000, thin = 1000, verbose=FALSE)

Following a reviewer's request, we reran the same model (and others, with other traits that have a wider distribution) in ASReml-R, and we got quite some differences for protein efficiency in the results from ASReml-R and MCMCglmm [ASReml-R heritability: 0.60 ? 0.08; ASREMLR litter effect: 0.00006 ? 0.000003]. MCMCglmm estimated lower heritability and higher litter effect. The models for the other traits, however, yielded pretty much the same estimates.

In order to verify results from both packages, we simulated data similar with the same heritability from MCMCglmm (0.43) and mean as estimated in the real dataset, but with a range of different litter effects. We observed that ASReml-R estimated the true litter effect more accurately, whereas MCMCglmm overestimated the litter effect and underestimated heritability throughout. We ran the same model in brms (with the default prior [student_t(3, 0, 2.5)]) and we had similar results as with ASReml-R.

We further played around with the priors (all weakly informative priors), combining the standard prior [inverse gamma with V=1 and nu=0.002] for the additive genetic variance, the standard prior [inverse gamma with V=1 and nu=0.002] for the residual variance and a parameter-expanded (for the litter effect) (with V=1, nu=1, alpha.mu=0, alpha.v=1000). Surprisingly, the 'combined' prior gave the similar results as ASReml and brms for simulated and real data. Using the parameter-expanded prior for both additive genetic and litter variance results in dramatically underestimating heritability [real data: 0.04; for simulated data: 0.00003]. Is it even permissible to combine the two in one model? Since brms is taking a much longer time to run for the same model, and we are quite familiar with MCMCglmm already, we would prefer to stick with it.

prior4 <- list(R = list(V = 1, nu = 0.002), G = list(G1 = list(V = 1, nu = 0.002), G1 = list(V = 1, nu = 1, alpha.mu = 0, alpha.V = 1000)))

We will appreciate any comments over this issue.

Best regards,

Esther Ewaoluwagbemiga and Claudia Kasper

	[[alternative HTML version deleted]]


From th|erry@onke||nx @end|ng |rom |nbo@be  Tue Jan 24 10:09:49 2023
From: th|erry@onke||nx @end|ng |rom |nbo@be (Thierry Onkelinx)
Date: Tue, 24 Jan 2023 10:09:49 +0100
Subject: [R-sig-ME] ICC for mixed models with modeled residuals
In-Reply-To: <CACgv6yWLtkG6fHrNnryFygehpaC68ek33r-DmMyU15B9-RSehQ@mail.gmail.com>
References: <CACgv6yWLtkG6fHrNnryFygehpaC68ek33r-DmMyU15B9-RSehQ@mail.gmail.com>
Message-ID: <CAJuCY5wmwBUkEs2sN_dYNn1F8Gm-JFfsgPFMdZpw4sgeZF1ZrA@mail.gmail.com>

Dear Simon,

I'd rephrase the question to "Is ICC defined for these models?". The answer
is probably no.

Best regards,

ir. Thierry Onkelinx
Statisticus / Statistician

Vlaamse Overheid / Government of Flanders
INSTITUUT VOOR NATUUR- EN BOSONDERZOEK / RESEARCH INSTITUTE FOR NATURE AND
FOREST
Team Biometrie & Kwaliteitszorg / Team Biometrics & Quality Assurance
thierry.onkelinx at inbo.be
Havenlaan 88 bus 73, 1000 Brussel
www.inbo.be

///////////////////////////////////////////////////////////////////////////////////////////
To call in the statistician after the experiment is done may be no more
than asking him to perform a post-mortem examination: he may be able to say
what the experiment died of. ~ Sir Ronald Aylmer Fisher
The plural of anecdote is not data. ~ Roger Brinner
The combination of some data and an aching desire for an answer does not
ensure that a reasonable answer can be extracted from a given body of data.
~ John Tukey
///////////////////////////////////////////////////////////////////////////////////////////

<https://www.inbo.be>


Op ma 23 jan. 2023 om 01:46 schreef Simon Harmel <sim.harmel at gmail.com>:

> Hello All,
>
> I was wondering if for models like below, there is a standard way to
> calculate the ICC given the extra modeling of residuals?
>
> Any possible `R` package capable of calculating ICC for such models?
>
> Thank you,
> Simon
>
>  lme(yij ~ X1 + X2 ...,
>          random = ~1| subject,
>          data = data,
>          subset = DV == "DV1",
>          correlation = corSymm(~1|subject),
>          weights = varComb(varIdent(form = ~ 1 | X1),
>                                           varPower(form = ~ X2)))
>
>
>   glmmTMB(yij ~ X1 + X2 + ... + (1|subject),
>                family = beta_family(), data = subset(data, DV =="DV2"),
>                dispformula = ~X1 + X2)
>
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>

	[[alternative HTML version deleted]]


From d@m@r|o @end|ng |rom mdw@@c@@t  Tue Jan 24 16:26:15 2023
From: d@m@r|o @end|ng |rom mdw@@c@@t (Sara D'Amario)
Date: Tue, 24 Jan 2023 16:26:15 +0100
Subject: [R-sig-ME] glmmTMB: repeated measure design and ar component
Message-ID: <63CFF897020000040004AE34@tgwia7.mdw.ac.at>

Dear all,
I am trying to implement a mixed model that takes into account the
repeated measure design of my study.

My study consists of a 2 parts ("part 1" and "part 2") x 2 takes ("take
1" and "take 2") x 2 target ("NOT AT ALL" and "MOST") x 2 mode ("UNISON"
and "CANON") x 15 participants (i.e. participants number from P01 to
P15).  Part, take, target, mode and participant number are fully
crossed.


For each condition resulting from the above fully crossed combinations,
I also have an autoregressive component (time).


I would like to investigate the fixed effects of: 
- target (a categorical variable, with 2 levels)
- mode (a categorical variable, with 2 levels)
- tuning (a continuous variable)

 on:
- wrist_position (a continuous variable) - the response variable

I am a bit familiar with glmmTMB, but I am not sure:
1) how to account for the repeated measure design
2) how to specify the ar1 component

For a simple model without the repeated measure design I would have done
something like:

m_simple <- glmmTMB(wrist_position ~  tuning  + mode + target +
	(1|participant),
        data = tuning_wrist, na.action = na.exclude)


However, my study is much more complex than that and includes a repeated
measure design and an autoregressive component for the data resulting
from these fully crossed variables. 
I would really appreciate your input in this respect.


How can I account for the repeated measure design?
How can I enter the ar1 component with the conditions resulting from
this fully crossed design?


Thanks a lot for you feedback.
 
Best,
Sara D'Amario


-----
Dr Sara D?Amario
Postdoctoral Research Associate
Department of Music Acoustics ? Wiener Klangstil
University of Music and Performing Arts Vienna
Anton-von-Webern-Platz 1
1030 Vienna, Austria
 
Ad majora semper
 
https://www.mdw.ac.at/iwk/fwf-togetherness/ 


Recent publications:
- D?Amario, S. & Bailes, F. (2021). Ensemble timing and synchronization,
in R. Timmers, F. Bailes, & H. Daffern (Eds.), Together in Music:
Coordination, expression, participation (139-147), Oxford University
Press. DOI: 10.1093/oso/9780198860761.001.0001.
- Daffern, H. & D?Amario, S. (2021). Understanding expressive ensemble
singing through acoustics, in R. Timmers, F. Bailes, & H. Daffern
(Eds.), Together in Music: Coordination, expression, participation
(129-138), Oxford University Press. DOI:
10.1093/oso/9780198860761.001.0001.

 



From @d@m@roebuck @end|ng |rom uconn@edu  Wed Jan 25 23:13:57 2023
From: @d@m@roebuck @end|ng |rom uconn@edu (Adam Roebuck)
Date: Wed, 25 Jan 2023 17:13:57 -0500
Subject: [R-sig-ME] Mixed models with a dichotomous outcome, random slopes,
 and accounting for autocorrelation
Message-ID: <CABDmvJ9xQgV+zr31OZE9WcRdXnRTWeKRfvccuLUQhipErxr0CQ@mail.gmail.com>

Hello,

I am attempting to set up a multilevel model with two grouping variables
(team and year), random slopes for day of the year, and accounting for
autocorrelation. I have a number of different outcome variables I can use.
When the outcome variable is continuous, I can set up a simple growth model
using the nlme package that looks something like the following:

model1 <- lme(continuous_outcome ~ 1 + Predictor_X + Day,

random = ~1 + Day | Team | Year, data = dat, method = "REML",

control=list(opt="optim"), correlation = corAR1()

However, I now want to build a model with a dichotomous outcome variable.
As far as I know, nlme cannot account for all of the above and a
dichotomous outcome. I have, however, seen a few references to glmer (in
the lme4 package) and glmmTMB being capable of such. I've gone back through
the archives, though, and am not seeing any clear explanations on how to
set up such a model.

Using the parameters above and the variables I specified, could someone
please help specify what that model might look like in R or at least point
me in the right direction?

Thanks,
Adam

-- 
*Adam Roebuck*
University of Connecticut | School of Business
Doctoral Candidate | Management
2100 Hillside Rd., Unit 1041
Storrs, CT 06269
(248) 613-9609

	[[alternative HTML version deleted]]


From pnb@t|ey @end|ng |rom gm@||@com  Wed Jan 25 23:14:23 2023
From: pnb@t|ey @end|ng |rom gm@||@com (Prathiba Natesan Batley)
Date: Wed, 25 Jan 2023 17:14:23 -0500
Subject: [R-sig-ME] Please post to the listserv
Message-ID: <CAFA0+65YEs=oUTjwGCV8X3jFWs0neJLu8_Jo_0Tn_S9Yi2cskA@mail.gmail.com>

Hello:
Could you please post the following to the listserv?

I am in a bit of a pickle here. I tried running a fixed effects model with
autocorrelation on a very small dataset (single case design). My syntax
look like this:
  lm2 <- lme(y ~ 1 + treatment, random = ~1|pid, data = df, correlation =
corAR1())
I want to obtain the phi coefficient which I see is in
lm2$modelStruct$corStruct. But the moment I extract it and put it into a
matrix it stores a different value. In this case it should be -0.17 but is
stored as -0.35. Pls see below:
> lm.2$modelStruct$corStruct
Correlation structure of class corAR1 representing
       Phi
-0.1743846

> cbind(1, lm.2$modelStruct$corStruct)
     [,1]       [,2]
[1,]    1 -0.3523706

Here is a sample dataset and syntax
            d=.5
            ICC=.1
            m=6
            phi=0
            n=5
            rep=1
            df <- read.csv(paste0("data", d, "-", ICC, "-", phi, "-", m,
"-", n, "_", rep, ".csv"))
lm2 <- lme(y ~ 1 + treatment, random = ~1|pid, data = df, correlation =
corAR1())
phi.hps <- c(lm2[[1]][2]) #or lm2$modelStruct#corStruct

From j|ox @end|ng |rom mcm@@ter@c@  Thu Jan 26 00:21:06 2023
From: j|ox @end|ng |rom mcm@@ter@c@ (John Fox)
Date: Wed, 25 Jan 2023 18:21:06 -0500
Subject: [R-sig-ME] Please post to the listserv
In-Reply-To: <17101_1674685951_30PMWUBr009712_CAFA0+65YEs=oUTjwGCV8X3jFWs0neJLu8_Jo_0Tn_S9Yi2cskA@mail.gmail.com>
References: <17101_1674685951_30PMWUBr009712_CAFA0+65YEs=oUTjwGCV8X3jFWs0neJLu8_Jo_0Tn_S9Yi2cskA@mail.gmail.com>
Message-ID: <1d2bd0bc-30ff-342d-2af3-a7af9100000c@mcmaster.ca>

Dear Prathiba,

m2$modelStruct$corStruct is a fairly complex object, not a simple 
number. Try:

	coef(m2$modelStruct$corStruct, unconstrained=FALSE)

(By the way, I couldn't make sense of the sample dataset you said you 
supplied, so I couldn't check my answer. Also, your model is a mixed 
model, not a fixed-effects model -- there are random effects.)

I hope this helps,
  John

-- 
John Fox, Professor Emeritus
McMaster University
Hamilton, Ontario, Canada
web: https://socialsciences.mcmaster.ca/jfox/

On 2023-01-25 5:14 p.m., Prathiba Natesan Batley wrote:
> Hello:
> Could you please post the following to the listserv?
> 
> I am in a bit of a pickle here. I tried running a fixed effects model with
> autocorrelation on a very small dataset (single case design). My syntax
> look like this:
>    lm2 <- lme(y ~ 1 + treatment, random = ~1|pid, data = df, correlation =
> corAR1())
> I want to obtain the phi coefficient which I see is in
> lm2$modelStruct$corStruct. But the moment I extract it and put it into a
> matrix it stores a different value. In this case it should be -0.17 but is
> stored as -0.35. Pls see below:
>> lm.2$modelStruct$corStruct
> Correlation structure of class corAR1 representing
>         Phi
> -0.1743846
> 
>> cbind(1, lm.2$modelStruct$corStruct)
>       [,1]       [,2]
> [1,]    1 -0.3523706
> 
> Here is a sample dataset and syntax
>              d=.5
>              ICC=.1
>              m=6
>              phi=0
>              n=5
>              rep=1
>              df <- read.csv(paste0("data", d, "-", ICC, "-", phi, "-", m,
> "-", n, "_", rep, ".csv"))
> lm2 <- lme(y ~ 1 + treatment, random = ~1|pid, data = df, correlation =
> corAR1())
> phi.hps <- c(lm2[[1]][2]) #or lm2$modelStruct#corStruct
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models


From j@h@d||e|d @end|ng |rom ed@@c@uk  Thu Jan 26 11:15:47 2023
From: j@h@d||e|d @end|ng |rom ed@@c@uk (Jarrod Hadfield)
Date: Thu, 26 Jan 2023 10:15:47 +0000
Subject: [R-sig-ME] 
 MCMCglmm: can one combine different prior distributions
 in one model?
In-Reply-To: <9dd4dfa925c74534bb8c61712aa8e313@agroscope.admin.ch>
References: <78c061a102134f5697070804e6a083b2@agroscope.admin.ch>
 <9dd4dfa925c74534bb8c61712aa8e313@agroscope.admin.ch>
Message-ID: <AS8PR05MB86594E0D3357F343BEDA953BACCF9@AS8PR05MB8659.eurprd05.prod.outlook.com>

Hi,

Having a parameter expanded prior of

V = 1, nu = 3, alpha.mu = 0, alpha.V = 2.5^2

gives a half-scaled-t prior on the standard deviation with df=3 and scale=2.5 (which is the same as the default brms prior you stated).

Depending on the scale of the data I would think this could be a strong prior, so I?m not sure what is the motivation for making it the default?

Cheers,

Jarrod


From: R-sig-mixed-models <r-sig-mixed-models-bounces at r-project.org> on behalf of claudia.kasper-voelkl--- via R-sig-mixed-models <r-sig-mixed-models at r-project.org>
Date: Monday, 23 January 2023 at 07:34
To: r-sig-mixed-models at r-project.org <r-sig-mixed-models at r-project.org>
Cc: esther.ewaoluwagbemiga at agroscope.admin.ch <esther.ewaoluwagbemiga at agroscope.admin.ch>
Subject: [R-sig-ME] MCMCglmm: can one combine different prior distributions in one model?
This email was sent to you by someone outside the University.
You should only click on links or attachments if you are certain that the email is genuine and the content is safe.

Dear list,

We are currently investigating heritability of protein efficiency in pigs. Protein efficiency is the amount of protein found in muscle tissue over the amount of protein in the feed an animal ingested over a certain period. By design, this variable is bound between 0 and 1, and it is quite narrowly symmetrically distributed (mean = 0.39, SD = 0.04, min = 0.18, max 0.64).

We ran an analysis with MCMCglmm on data from around 1000 pigs from a paternal half-sib design, an animal model which contained two random effects (an animal effect and litter effect). There were no convergence issues, and the model diagnostics we checked (trace plots, autocorrelation, Heidelberger diagnostic, and effective size) looked all very reasonable. The heritability was 0.43 [0.29, 0.58] and the litter effect 0.12 [0.07, 0.17] - 95% credible intervals in brackets.

modelH <- MCMCglmm(prot_eff_carcass ~ year + slaughterweight + treatment2 + sex + age + temp + treatment2*age + Y_change1*age + slaughterweight*sex + treatment2*sex,
                   random = ~animal+sibship, family = "gaussian",
                   prior = prior, pedigree = ped, data = herit2, nitt = 2000000,
                   burnin = 100000, thin = 1000, verbose=FALSE)

Following a reviewer's request, we reran the same model (and others, with other traits that have a wider distribution) in ASReml-R, and we got quite some differences for protein efficiency in the results from ASReml-R and MCMCglmm [ASReml-R heritability: 0.60 ? 0.08; ASREMLR litter effect: 0.00006 ? 0.000003]. MCMCglmm estimated lower heritability and higher litter effect. The models for the other traits, however, yielded pretty much the same estimates.

In order to verify results from both packages, we simulated data similar with the same heritability from MCMCglmm (0.43) and mean as estimated in the real dataset, but with a range of different litter effects. We observed that ASReml-R estimated the true litter effect more accurately, whereas MCMCglmm overestimated the litter effect and underestimated heritability throughout. We ran the same model in brms (with the default prior [student_t(3, 0, 2.5)]) and we had similar results as with ASReml-R.

We further played around with the priors (all weakly informative priors), combining the standard prior [inverse gamma with V=1 and nu=0.002] for the additive genetic variance, the standard prior [inverse gamma with V=1 and nu=0.002] for the residual variance and a parameter-expanded (for the litter effect) (with V=1, nu=1, alpha.mu=0, alpha.v=1000). Surprisingly, the 'combined' prior gave the similar results as ASReml and brms for simulated and real data. Using the parameter-expanded prior for both additive genetic and litter variance results in dramatically underestimating heritability [real data: 0.04; for simulated data: 0.00003]. Is it even permissible to combine the two in one model? Since brms is taking a much longer time to run for the same model, and we are quite familiar with MCMCglmm already, we would prefer to stick with it.

prior4 <- list(R = list(V = 1, nu = 0.002), G = list(G1 = list(V = 1, nu = 0.002), G1 = list(V = 1, nu = 1, alpha.mu = 0, alpha.V = 1000)))

We will appreciate any comments over this issue.

Best regards,

Esther Ewaoluwagbemiga and Claudia Kasper

        [[alternative HTML version deleted]]
The University of Edinburgh is a charitable body, registered in Scotland, with registration number SC005336. Is e buidheann carthannais a th? ann an Oilthigh Dh?n ?ideann, cl?raichte an Alba, ?ireamh cl?raidh SC005336.

	[[alternative HTML version deleted]]


From juho@kr|@t|@n@ruohonen @end|ng |rom gm@||@com  Thu Jan 26 15:56:16 2023
From: juho@kr|@t|@n@ruohonen @end|ng |rom gm@||@com (Juho Kristian Ruohonen)
Date: Thu, 26 Jan 2023 16:56:16 +0200
Subject: [R-sig-ME] 
 Collinearity diagnostics for (mixed) multinomial models
In-Reply-To: <d8c397b8-fbec-6c39-fdf5-5047daf6f219@mcmaster.ca>
References: <mailman.19600.5.1645786802.52378.r-sig-mixed-models@r-project.org>
 <CAKk2L3LEaRHPQDNx49twbQaM4t5=FGJArkz1kCRzBkiAP87kQQ@mail.gmail.com>
 <24314_1645908336_21QKjZ8b017357_CAG_dBVfdOZmbLRsWOQ5f28Y32ZMtDsOVE2-6FZmUaQ0H8f0+EQ@mail.gmail.com>
 <ec746b24-eb5b-5579-2b24-3c3b492d55d9@mcmaster.ca>
 <CAG_dBVfcpzW5RAs9syWFdL+RvryeAppowexjX_a9zJqRu+PC4Q@mail.gmail.com>
 <7e05d26d-e8af-aa48-8fd4-543c9f3dc3a2@mcmaster.ca>
 <CAG_dBVenhHeF5-hmA7M6xfD2FAeLmqzwc6AL-xrVREZuKyyKpA@mail.gmail.com>
 <67a63dca-f3c0-d766-0a2a-bad1a5fed9c3@mcmaster.ca>
 <CAG_dBVcv+12Q6_dSdX7_2cBPR5PgQmJ5bqZgQoWh88ATCmT6GA@mail.gmail.com>
 <0f03187e-d848-ea43-e370-ead2d403b530@mcmaster.ca>
 <CAG_dBVfv2-8Z0VRvcK4QUP97oh5jOhPd2d=LUj0N_6Ec+appMw@mail.gmail.com>
 <f80557f3-35c7-7b22-ae9c-2f14ff0d7ac0@mcmaster.ca>
 <CAG_dBVe7f5aEB_hA5t-j2u9ZJw-bDQPOchxc3-QTX3VejqXQSQ@mail.gmail.com>
 <d8c397b8-fbec-6c39-fdf5-5047daf6f219@mcmaster.ca>
Message-ID: <CAG_dBVc2Vw6mQ17ZvXM+vJvvON9D=jHsXp+_3gM7m1zukNAAuQ@mail.gmail.com>

Dear all,

I'm resurrecting this thread because a problem has come up which might need
fixing once someone gets around to writing a relevant R package.

In this same thread last March, John Fox showed me how to compute GVIFs for
a *nnet* multinomial model. I then wrote a simple function that loops
through all predictors in such a model and applies John's code to them,
returning the GVIF, DF, and GVIF^(1/(2*Df)) statistic for each predictor.
Available here
<https://github.com/jkruohon/StatsMisc/blob/main/gvif_multinom.R>, the
function seems to work just fine, reproducing John's results exactly on the
carData examples. Likewise, applying this function to my own research data
yielded entirely plausible results.

But to my horror, I now discover that *when I refit my multinomial model
with two quantitative predictors centered, the GVIF statistics change
considerably** -- *even though the model has the same fit and virtually
identical coefficients (except for the intercepts) as the original one. How
can this be? The only thing that changes between the two models is the set
of intercepts which, moreover, are specifically excluded from the GVIF
calculations.

Below is a minimal example. The anonymized datafile is downloadable here
<https://github.com/jkruohon/StatsMisc/raw/main/d_anon.RData>.

> mod1 <- multinom(y ~., data = d.anon, maxit = 999)
> gvif.multinom(mod1) # x6 and x26 top the collinearity list
            GVIF DF GVIF^(1/(2df))
x6  3.463522e+03  3       3.889732
x26 2.988396e+03  3       3.795244
x27 1.390830e+03  3       3.341019
x2  3.889656e+02  3       2.701792
x13 2.930026e+02  3       2.577183
x19 2.051250e+04  6       2.287362
x25 7.043339e+03  6       2.092417
x24 1.078212e+07 12       1.963493
x9  2.357662e+01  3       1.693351
x17 1.991744e+01  3       1.646413
x5  3.869759e+02  6       1.643010
x12 1.787075e+01  3       1.616927
x18 2.943991e+02  6       1.605997
x1  2.700175e+03  9       1.551075
x16 2.576739e+04 12       1.526844
x7  1.483341e+02  6       1.516829
x20 1.159374e+01  3       1.504425
x3  1.612637e+04 12       1.497318
x28 1.081693e+01  3       1.487136
x10 9.706880e+00  3       1.460539
x22 9.459035e+00  3       1.454257
x15 9.124519e+00  3       1.445556
x14 7.017242e+00  3       1.383655
x21 6.404687e+00  3       1.362750
x8  6.072614e+00  3       1.350712
x11 4.797251e+00  3       1.298670
x4  3.665742e+03 18       1.256043
x23 3.557201e+00  3       1.235525

Now we refit the model with the quantitative predictors x6 and x26 centered:

> d.anon$x6 <- d.anon$x6 - mean(d.anon$x6)
> d.anon$x26 <- d.anon$x26 - mean(d.anon$x26)
> mod2 <- update(mod1, data = d.anon, maxit = 999)
> c(logLik(mod1), logLik(mod2))  # same fit to the data
[1] -2074.133 -2074.134

> gvif.multinom(mod2)
            GVIF DF GVIF^(1/(2df))
x2  6.196959e+04  3       6.290663
x13 3.031115e+04  3       5.583850
x27 2.552811e+04  3       5.426291
x14 1.642231e+04  3       5.041646
x6  1.573721e+04  3       5.005967
x26 1.464437e+04  3       4.946277
x9  1.262667e+04  3       4.825564
x10 5.714321e+03  3       4.228251
x19 2.255013e+07  6       4.099798
x25 1.227033e+07  6       3.897068
x12 3.394139e+03  3       3.876635
x15 1.938364e+03  3       3.531067
x11 1.685265e+03  3       3.449674
x21 8.429450e+02  3       3.073500
x23 7.639755e+02  3       3.023523
x22 6.887451e+02  3       2.971733
x17 5.640312e+02  3       2.874422
x20 3.855848e+02  3       2.697864
x24 1.444083e+10 12       2.650430
x7  7.148911e+04  6       2.538166
x18 1.674603e+04  6       2.249017
x5  9.662266e+03  6       2.148275
x16 6.264044e+07 12       2.112851
x1  6.634544e+05  9       2.105882
x3  1.558132e+07 12       1.993847
x8  6.168472e+01  3       1.987755
x4  4.256459e+06 18       1.528059
x28 9.783234e+00  3       1.462448

And so I'm at my wits' end. The models are virtually identical, yet the
GVIF statistics are very different. I don't know which ones to trust.
Worse, the discrepancy makes me disinclined to trust either of them --
which is a return to Square One, i.e. the situation where GVIF statistics
for multinomial models did not exist. And I don't know which
multicollinearity metric I can present in my thesis, if any.

I hope someone can help.

Best,

Juho





ke 2. maalisk. 2022 klo 16.35 John Fox (jfox at mcmaster.ca) kirjoitti:

> Dear Juho,
>
> On 2022-03-02 6:23 a.m., Juho Kristian Ruohonen wrote:
> > One last comment, John: Sorry if I seemed to be implying that you (or
> > anyone else) should debug my code for me. That wasn't the idea. I do
> > believe that the function locates the intended rows/columns
> > successfully. I just wasn't entirely positive what those intended
> > rows/columns should be when dealing with a multicategory factor.
> > Presently, it locates every row/column involving the multicategory
> > factor in question, so the number of rows/columns identified is the
> > number of factor levels minus one, times the number of response
> > categories minus one. I hope that's correct.
>
> OK, that's a fair remark. Yes, what you describe is correct.
>
> You can also reassure yourself that your function is working properly by:
>
> (1) If you haven't already done so, show that you get the same GVIFs
> from your function as from the one I sent you used directly.
>
> (2) Vary the baseline level of the response variable and confirm that
> you get the same GVIFs.
>
> (3) Vary the basis for the regressor subspace for a factor, e.g., either
> by using contr.sum() in place of the default contr.treatment() or by
> changing the baseline level of the factor for contr.treatment(), and
> again confirm that the GVIFs are unchanged.
>
> Best,
>   John
>
> >
> > My current plan is to present the output of the new function in my
> > thesis and credit you for the math. But if *vif()* gets a relevant
> > update before my project is finished, then I'll use that and cite the
> > /car /package instead.
> >
> > Thanks again for your help.
> >
> > Best,
> >
> > Juho
> >
> > ti 1. maalisk. 2022 klo 23.54 John Fox (jfox at mcmaster.ca
> > <mailto:jfox at mcmaster.ca>) kirjoitti:
> >
> >     Dear Juho,
> >
> >     On 2022-03-01 3:13 p.m., Juho Kristian Ruohonen wrote:
> >      > Dear John,
> >      >
> >      > Yes, my function uses your code for the math. I was just hoping to
> >      > verify that it is handling multicategory factors correctly (your
> >      > examples didn't involve any).
> >
> >     That's not really my point. Your code sets up computations for the
> >     various terms in the model automatically, while the function I sent
> >     requires that you locate the rows/columns for the intercepts and each
> >     focal term manually. If you haven't already done so, you could check
> >     that your function is identifying the correct columns and getting the
> >     corresponding GVIFs.
> >
> >      >
> >      > I guess interactions aren't that important after all, given that
> the
> >      > chief concern is usually collinearity among main effects.
> >
> >     I wouldn't say that, but it's not clear what collinearity means in
> >     models with interactions, and if you compute VIFs or GVIFs for "main
> >     effects" in models with interactions, you'll probably get nonsense.
> >
> >     As I said, I think that this might be a solvable problem, but one
> that
> >     requires thought about what needs to remain invariant.
> >
> >     I think that we've probably come to end for now.
> >
> >     John
> >
> >      >
> >      > Many thanks for all your help.
> >      >
> >      > Best,
> >      >
> >      > Juho
> >      >
> >      > ti 1. maalisk. 2022 klo 18.01 John Fox (jfox at mcmaster.ca
> >     <mailto:jfox at mcmaster.ca>
> >      > <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>) kirjoitti:
> >      >
> >      >     Dear Juho,
> >      >
> >      >     On 2022-03-01 8:24 a.m., Juho Kristian Ruohonen wrote:
> >      >      > Dear John (Fox, as well as other list members),
> >      >      >
> >      >      > I've now written a simple function to try and calculate
> >     GVIFS for
> >      >     all
> >      >      > predictors in a nnet::multinom() object based on John's
> >     example
> >      >     code. If
> >      >      > its results are correct (see below), I will proceed to
> write a
> >      >     version
> >      >      > that also works with mixed-effects multinomial models fit
> by
> >      >      > brms::brm(). Here's the code:
> >      >      >
> >      >      >     gvif.multinom <- function(model){
> >      >      >        (classes <- model$lev)
> >      >      >        (V.all <- vcov(model))
> >      >      >        (V.noIntercepts <- V.all[!grepl("\\(Intercept\\)$",
> >      >      >     rownames(V.all), perl = T),
> >      >      >                                 !grepl("\\(Intercept\\)$",
> >      >      >     colnames(V.all), perl = T)])
> >      >      >        (R <- cov2cor(V.noIntercepts))
> >      >      >        (terms <- attr(model$terms, "term.labels"))
> >      >      >        (gvif <- numeric(length = length(terms)))
> >      >      >        (names(gvif) <- terms)
> >      >      >        (SE.multiplier <- numeric(length = length(terms)))
> >      >      >        (names(SE.multiplier) <- terms)
> >      >      >        #The line below tries to capture all factor levels
> >     into a
> >      >     regex
> >      >      >     for coef name matching.
> >      >      >        (LevelsRegex <- paste0("(",
> >     paste(unlist(model$xlevels),
> >      >     collapse
> >      >      >     = "|"),")?"))
> >      >      >
> >      >      >        for(i in terms){
> >      >      >          #The regex stuff below tries to ensure all
> >     interaction
> >      >      >     coefficients are matched, including those involving
> >     factors.
> >      >      >          if(grepl(":", i)){
> >      >      >            (termname <- gsub(":", paste0(LevelsRegex,
> ":"), i,
> >      >     perl = T))
> >      >      >          }else{termname <- i}
> >      >      >          (RegexToMatch <- paste0("^(",
> >      >     paste(classes[2:length(classes)],
> >      >      >     collapse = "|") ,"):", termname, LevelsRegex, "$"))
> >      >      >
> >      >      >          #Now the actual calculation:
> >      >      >          (indices <- grep(RegexToMatch, rownames(R), perl
> >     = T))
> >      >      >          (gvif[i] <- det(R[indices, indices]) *
> >     det(R[-indices,
> >      >      >     -indices]) / det(R))
> >      >      >          (SE.multiplier[i] <-
> gvif[i]^(1/(2*length(indices))))
> >      >      >        }
> >      >      >        #Put the results together and order them by degree
> >     of SE
> >      >     inflation:
> >      >      >        (result <- cbind(GVIF = gvif, `GVIF^(1/(2df))` =
> >      >     SE.multiplier))
> >      >      >        return(result[order(result[,"GVIF^(1/(2df))"],
> >     decreasing
> >      >     = T),])}
> >      >      >
> >      >      >
> >      >      > The results seem correct to me when applied to John's
> example
> >      >     model fit
> >      >      > to the BEPS data. However, that dataset contains no
> multi-df
> >      >     factors, of
> >      >      > which my own models have many. Below is a maximally simple
> >      >     example with
> >      >      > one multi-df factor (/region/):
> >      >      >
> >      >      >     mod1 <- multinom(partic ~., data = carData::Womenlf)
> >      >      >     gvif.multinom(mod1)
> >      >      >
> >      >      >     GVIF GVIF^(1/(2df))
> >      >      >     children 1.298794       1.067542
> >      >      >     hincome  1.184215       1.043176
> >      >      >     region   1.381480       1.020403
> >      >      >
> >      >      >
> >      >      > These results look plausible to me. Finally, below is an
> >     example
> >      >      > involving both a multi-df factor and an interaction:
> >      >      >
> >      >      >     mod2 <- update(mod1, ~. +children:region)
> >      >      >     gvif.multinom(mod2)
> >      >      >
> >      >      >                              GVIF GVIF^(1/(2df))
> >      >      >     children:region 4.965762e+16      11.053482
> >      >      >     region          1.420418e+16      10.221768
> >      >      >     children        1.471412e+03       6.193463
> >      >      >     hincome         6.462161e+00       1.594390
> >      >      >
> >      >      >
> >      >      > These results look a bit more dubious. To be sure, it is
> to be
> >      >     expected
> >      >      > that interaction terms will introduce a lot of
> >     collinearity. But an
> >      >      > 11-fold increase in SE? I hope someone can tell me whether
> >     this is
> >      >      > correct or not!
> >      >
> >      >     You don't need someone else to check your work because you
> >     could just
> >      >     apply the simple function that I sent you yesterday, which,
> >     though not
> >      >     automatic, computes the GVIFs in a transparent manner.
> >      >
> >      >     A brief comment on GVIFs for models with interactions (this
> >     isn't the
> >      >     place to discuss the question in detail): The Fox and Monette
> >     JASA
> >      >     paper
> >      >     addresses the question briefly in the context of a two-way
> >     ANOVA, but I
> >      >     don't think that the approach suggested there is easily
> >     generalized.
> >      >
> >      >     The following simple approach pays attention to what's
> >     invariant under
> >      >     different parametrizations of the RHS side of the model:
> >     Simultaneously
> >      >     check the collinearity of all of the coefficients of an
> >     interaction
> >      >     together with the main effects and, potentially, lower-order
> >      >     interactions that are marginal to it. So, e.g., in the model
> >     y ~ a +
> >      >     b +
> >      >     a:b + c, you'd check all of the coefficients for a, b, and
> >     a:b together.
> >      >
> >      >     Alternatively, one could focus in turn on each explanatory
> >     variable and
> >      >     check the collinearity of all coefficients to which it is
> >     marginal. So
> >      >     in y ~ a + b + c + a:b + a:c + d, when you focus on a, you'd
> >     look at
> >      >     all
> >      >     of the coefficients for a, b, c, a:b, and a:c.
> >      >
> >      >     John
> >      >
> >      >      >
> >      >      > Best,
> >      >      >
> >      >      > Juho
> >      >      >
> >      >      >
> >      >      >
> >      >      >
> >      >      >
> >      >      >
> >      >      >
> >      >      >
> >      >      >
> >      >      >
> >      >      >
> >      >      > ti 1. maalisk. 2022 klo 0.05 John Fox (jfox at mcmaster.ca
> >     <mailto:jfox at mcmaster.ca>
> >      >     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>
> >      >      > <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
> >     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>>) kirjoitti:
> >      >      >
> >      >      >     Dear Juha,
> >      >      >
> >      >      >     On 2022-02-28 5:00 p.m., Juho Kristian Ruohonen wrote:
> >      >      >      > Apologies for my misreading, John, and many thanks
> >     for showing
> >      >      >     how the
> >      >      >      > calculation is done for a single term.
> >      >      >      >
> >      >      >      > Do you think *vif()* might be updated in the near
> >     future
> >      >     with the
> >      >      >      > capability of auto-detecting a multinomial model
> >     and returning
> >      >      >      > mathematically correct GVIF statistics?
> >      >      >
> >      >      >     The thought crossed my mind, but I'd want to do it in a
> >      >     general way,
> >      >      >     not
> >      >      >     just for the multinom() function, and in a way that
> avoids
> >      >     incorrect
> >      >      >     results such as those currently produced for "multinom"
> >      >     models, albeit
> >      >      >     with a warning. I can't guarantee whether or when I'll
> be
> >      >     able to do
> >      >      >     that.
> >      >      >
> >      >      >     John
> >      >      >
> >      >      >      >
> >      >      >      > If not, I'll proceed to writing my own function
> >     based on your
> >      >      >     example.
> >      >      >      > However, /car/ is such an excellent and widely used
> >      >     package that the
> >      >      >      > greatest benefit to mankind would probably accrue
> >     if /car /was
> >      >      >     upgraded
> >      >      >      > with this feature sooner rather than later.
> >      >      >      >
> >      >      >      > Best,
> >      >      >      >
> >      >      >      > Juho
> >      >      >      >
> >      >      >      >
> >      >      >      >
> >      >      >      >
> >      >      >      >
> >      >      >      >
> >      >      >      >
> >      >      >      >
> >      >      >      >
> >      >      >      > ma 28. helmik. 2022 klo 17.08 John Fox
> >     (jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
> >      >     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>
> >      >      >     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
> >     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>>
> >      >      >      > <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
> >     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>
> >      >     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
> >     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>>>) kirjoitti:
> >      >      >      >
> >      >      >      >     Dear Juho,
> >      >      >      >
> >      >      >      >     On 2022-02-28 2:06 a.m., Juho Kristian Ruohonen
> >     wrote:
> >      >      >      >      > Dear Professor Fox and other list members,
> >      >      >      >      >
> >      >      >      >      > Profuse thanks for doing that detective work
> for
> >      >     me! I myself
> >      >      >      >     thought
> >      >      >      >      > the inflation factors reported by
> >      >     check_collinearity() were
> >      >      >      >     suspiciously
> >      >      >      >      > high, but unlike you I lacked the expertise
> >     to identify
> >      >      >     what was
> >      >      >      >     going on.
> >      >      >      >      >
> >      >      >      >      > As for your suggested approach, have I
> >     understood this
> >      >      >     correctly:
> >      >      >      >      >
> >      >      >      >      > Since there doesn't yet exist an R function
> >     that will
> >      >      >     calculate the
> >      >      >      >      > (G)VIFS of multinomial models correctly, my
> best
> >      >     bet for
> >      >      >     now is
> >      >      >      >     just to
> >      >      >      >      > ignore the fact that such models partition
> >     the data
> >      >     into C-1
> >      >      >      >     subsets,
> >      >      >      >      > and to calculate approximate GVIFs from the
> >     entire
> >      >     dataset at
> >      >      >      >     once as if
> >      >      >      >      > the response were continuous? And a simple
> >     way to
> >      >     do this
> >      >      >     is to
> >      >      >      >      > construct a fake continuous response, call
> >      >      >     *lm(fakeresponse ~.)*,
> >      >      >      >     and
> >      >      >      >      > apply *car::vif()* on the result?
> >      >      >      >
> >      >      >      >     No, you misunderstand my suggestion, which
> >     perhaps isn't
> >      >      >     surprising
> >      >      >      >     given the length of my message. What you
> >     propose is what I
> >      >      >     suggested as
> >      >      >      >     a rough approximation *before* I confirmed that
> my
> >      >     guess of the
> >      >      >      >     solution
> >      >      >      >     was correct.
> >      >      >      >
> >      >      >      >     The R code that I sent yesterday showed how to
> >     compute the
> >      >      >     GVIF for a
> >      >      >      >     multinomial regression model, and I suggested
> >     that you
> >      >     write
> >      >      >     either a
> >      >      >      >     script or a simple function to do that. Here's
> >     a function
> >      >      >     that will
> >      >      >      >     work
> >      >      >      >     for a model object that responds to vcov():
> >      >      >      >
> >      >      >      >     GVIF <- function(model, intercepts, term){
> >      >      >      >         # model: regression model object
> >      >      >      >         # intercepts: row/column positions of
> >     intercepts
> >      >     in the
> >      >      >     coefficient
> >      >      >      >     covariance matrix
> >      >      >      >         # term: row/column positions of the
> >     coefficients
> >      >     for the
> >      >      >     focal term
> >      >      >      >         V <- vcov(model)
> >      >      >      >         term <- colnames(V)[term]
> >      >      >      >         V <- V[-intercepts, -intercepts]
> >      >      >      >         V <- cov2cor(V)
> >      >      >      >         term <- which(colnames(V) %in% term)
> >      >      >      >         gvif <- det(V[term, term])*det(V[-term,
> >     -term])/det(V)
> >      >      >      >         c(GVIF=gvif,
> >      >     "GVIF^(1/(2*p))"=gvif^(1/(2*length(term))))
> >      >      >      >     }
> >      >      >      >
> >      >      >      >     and here's an application to the multinom()
> >     example that I
> >      >      >     showed you
> >      >      >      >     yesterday:
> >      >      >      >
> >      >      >      >       > colnames(vcov(m)) # to get coefficient
> >     positions
> >      >      >      >        [1] "Labour:(Intercept)"
> >      >       "Labour:age"
> >      >      >      >
> >      >      >      >        [3] "Labour:economic.cond.national"
> >      >      >      >     "Labour:economic.cond.household"
> >      >      >      >        [5] "Labour:Blair"
> >      >       "Labour:Hague"
> >      >      >      >
> >      >      >      >        [7] "Labour:Kennedy"
> >      >       "Labour:Europe"
> >      >      >      >
> >      >      >      >        [9] "Labour:political.knowledge"
> >      >      >       "Labour:gendermale"
> >      >      >      >
> >      >      >      >     [11] "Liberal Democrat:(Intercept)"
> >       "Liberal
> >      >      >     Democrat:age"
> >      >      >      >
> >      >      >      >     [13] "Liberal Democrat:economic.cond.national"
> >     "Liberal
> >      >      >      >     Democrat:economic.cond.household"
> >      >      >      >     [15] "Liberal Democrat:Blair"
> >       "Liberal
> >      >      >      >     Democrat:Hague"
> >      >      >      >
> >      >      >      >     [17] "Liberal Democrat:Kennedy"
> >       "Liberal
> >      >      >      >     Democrat:Europe"
> >      >      >      >     [19] "Liberal Democrat:political.knowledge"
> >       "Liberal
> >      >      >      >     Democrat:gendermale"
> >      >      >      >
> >      >      >      >       > GVIF(m, intercepts=c(1, 11), term=c(2, 12))
> >     # GVIF
> >      >     for age
> >      >      >      >                 GVIF GVIF^(1/(2*p))
> >      >      >      >             1.046232       1.011363
> >      >      >      >
> >      >      >      >
> >      >      >      >     Finally, here's what you get for a linear model
> >     with
> >      >     the same RHS
> >      >      >      >     (where
> >      >      >      >     the sqrt(VIF) should be a rough approximation to
> >      >     GVIF^(1/4)
> >      >      >     reported by
> >      >      >      >     my GVIF() function):
> >      >      >      >
> >      >      >      >       > m.lm <- lm(as.numeric(vote) ~ . - vote1,
> >     data=BEPS)
> >      >      >      >       > sqrt(car::vif(m.lm))
> >      >      >      >                           age
> economic.cond.national
> >      >      >      >     economic.cond.household
> >      >      >      >                         Blair
> >      >      >      >                      1.006508
> 1.124132
> >      >      >      >     1.075656
> >      >      >      >                      1.118441
> >      >      >      >                         Hague
>  Kennedy
> >      >      >      >     Europe
> >      >      >      >           political.knowledge
> >      >      >      >                      1.066799
> 1.015532
> >      >      >      >     1.101741
> >      >      >      >                      1.028546
> >      >      >      >                        gender
> >      >      >      >                      1.017386
> >      >      >      >
> >      >      >      >
> >      >      >      >     John
> >      >      >      >
> >      >      >      >      >
> >      >      >      >      > Best,
> >      >      >      >      >
> >      >      >      >      > Juho
> >      >      >      >      >
> >      >      >      >      > ma 28. helmik. 2022 klo 2.23 John Fox
> >      >     (jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
> >     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>
> >      >      >     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
> >     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>>
> >      >      >      >     <mailto:jfox at mcmaster.ca
> >     <mailto:jfox at mcmaster.ca> <mailto:jfox at mcmaster.ca
> >     <mailto:jfox at mcmaster.ca>>
> >      >     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
> >     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>>>
> >      >      >      >      > <mailto:jfox at mcmaster.ca
> >     <mailto:jfox at mcmaster.ca> <mailto:jfox at mcmaster.ca
> >     <mailto:jfox at mcmaster.ca>>
> >      >     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
> >     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>>
> >      >      >     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
> >     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>
> >      >     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
> >     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>>>>) kirjoitti:
> >      >      >      >      >
> >      >      >      >      >     Dear Juho,
> >      >      >      >      >
> >      >      >      >      >     I've now had a chance to think about this
> >      >     problem some
> >      >      >     more,
> >      >      >      >     and I
> >      >      >      >      >     believe that the approach I suggested is
> >     correct. I
> >      >      >     also had an
> >      >      >      >      >     opportunity to talk the problem over a
> >     bit with
> >      >     Georges
> >      >      >      >     Monette, who
> >      >      >      >      >     coauthored the paper that introduced
> >      >     generalized variance
> >      >      >      >     inflation
> >      >      >      >      >     factors (GVIFs). On the other hand, the
> >     results
> >      >      >     produced by
> >      >      >      >      >     performance::check_collinearity() for
> >      >     multinomial logit
> >      >      >      >     models don't
> >      >      >      >      >     seem to be correct (see below).
> >      >      >      >      >
> >      >      >      >      >     Here's an example, using the
> >     nnet::multinom()
> >      >     function
> >      >      >     to fit a
> >      >      >      >      >     multinomial logit model, with alternative
> >      >      >     parametrizations of the
> >      >      >      >      >     LHS of
> >      >      >      >      >     the model:
> >      >      >      >      >
> >      >      >      >      >     --------- snip -----------
> >      >      >      >      >
> >      >      >      >      >       > library(nnet) # for multinom()
> >      >      >      >      >       > library(carData) # for BEPS data set
> >      >      >      >      >
> >      >      >      >      >       > # alternative ordering of the
> >     response levels:
> >      >      >      >      >       > BEPS$vote1 <- factor(BEPS$vote,
> >      >     levels=c("Labour",
> >      >      >     "Liberal
> >      >      >      >      >     Democrat", "Conservative"))
> >      >      >      >      >       > levels(BEPS$vote)
> >      >      >      >      >     [1] "Conservative"     "Labour"
> >       "Liberal
> >      >      >     Democrat"
> >      >      >      >      >       > levels(BEPS$vote1)
> >      >      >      >      >     [1] "Labour"           "Liberal Democrat"
> >      >     "Conservative"
> >      >      >      >      >
> >      >      >      >      >       > m <- multinom(vote ~ . - vote1,
> >     data=BEPS)
> >      >      >      >      >     # weights:  33 (20 variable)
> >      >      >      >      >     initial  value 1675.383740
> >      >      >      >      >     iter  10 value 1345.935273
> >      >      >      >      >     iter  20 value 1150.956807
> >      >      >      >      >     iter  30 value 1141.921662
> >      >      >      >      >     iter  30 value 1141.921661
> >      >      >      >      >     iter  30 value 1141.921661
> >      >      >      >      >     final  value 1141.921661
> >      >      >      >      >     converged
> >      >      >      >      >       > m1 <- multinom(vote1 ~ . - vote,
> >     data=BEPS)
> >      >      >      >      >     # weights:  33 (20 variable)
> >      >      >      >      >     initial  value 1675.383740
> >      >      >      >      >     iter  10 value 1280.439304
> >      >      >      >      >     iter  20 value 1165.513772
> >      >      >      >      >     final  value 1141.921662
> >      >      >      >      >     converged
> >      >      >      >      >
> >      >      >      >      >       > rbind(coef(m), coef(m1)) # compare
> >     coefficients
> >      >      >      >      >                        (Intercept)
> age
> >      >      >      >     economic.cond.national
> >      >      >      >      >     economic.cond.household
> >      >      >      >      >     Labour             0.9515214 -0.021913989
> >      >      >     0.5575707
> >      >      >      >      >            0.15839096
> >      >      >      >      >     Liberal Democrat   1.4119306 -0.016810735
> >      >      >     0.1810761
> >      >      >      >      >           -0.01196664
> >      >      >      >      >     Liberal Democrat   0.4604567  0.005102666
> >      >      >       -0.3764928
> >      >      >      >      >           -0.17036682
> >      >      >      >      >     Conservative      -0.9514466  0.021912305
> >      >      >       -0.5575644
> >      >      >      >      >           -0.15838744
> >      >      >      >      >                             Blair       Hague
> >      >     Kennedy
> >      >      >          Europe
> >      >      >      >      >     political.knowledge
> >      >      >      >      >     Labour            0.8371764 -0.90775585
> >     0.2513436
> >      >      >     -0.22781308
> >      >      >      >      >     -0.5370612
> >      >      >      >      >     Liberal Democrat  0.2937331 -0.82217625
> >     0.6710567
> >      >      >     -0.20004624
> >      >      >      >      >     -0.2034605
> >      >      >      >      >     Liberal Democrat -0.5434408  0.08559455
> >     0.4197027
> >      >      >     0.02776465
> >      >      >      >      >     0.3336068
> >      >      >      >      >     Conservative     -0.8371670  0.90778068
> >     -0.2513735
> >      >      >     0.22781092
> >      >      >      >      >     0.5370545
> >      >      >      >      >                         gendermale
> >      >      >      >      >     Labour            0.13765774
> >      >      >      >      >     Liberal Democrat  0.12640823
> >      >      >      >      >     Liberal Democrat -0.01125898
> >      >      >      >      >     Conservative     -0.13764849
> >      >      >      >      >
> >      >      >      >      >       > c(logLik(m), logLik(m1)) # same fit
> >     to the data
> >      >      >      >      >     [1] -1141.922 -1141.922
> >      >      >      >      >
> >      >      >      >      >       > # covariance matrices for
> coefficients:
> >      >      >      >      >       > V <- vcov(m)
> >      >      >      >      >       > V1 <- vcov(m1)
> >      >      >      >      >       > cbind(colnames(V), colnames(V1)) #
> >     compare
> >      >      >      >      >             [,1]
> >      >         [,2]
> >      >      >      >      >
> >      >      >      >      >        [1,] "Labour:(Intercept)"
> >      >      >       "Liberal
> >      >      >      >      >     Democrat:(Intercept)"
> >      >      >      >      >        [2,] "Labour:age"
> >      >      >       "Liberal
> >      >      >      >      >     Democrat:age"
> >      >      >      >      >
> >      >      >      >      >        [3,] "Labour:economic.cond.national"
> >      >      >     "Liberal
> >      >      >      >      >     Democrat:economic.cond.national"
> >      >      >      >      >        [4,] "Labour:economic.cond.household"
> >      >      >       "Liberal
> >      >      >      >      >     Democrat:economic.cond.household"
> >      >      >      >      >        [5,] "Labour:Blair"
> >      >      >       "Liberal
> >      >      >      >      >     Democrat:Blair"
> >      >      >      >      >        [6,] "Labour:Hague"
> >      >      >       "Liberal
> >      >      >      >      >     Democrat:Hague"
> >      >      >      >      >        [7,] "Labour:Kennedy"
> >      >      >       "Liberal
> >      >      >      >      >     Democrat:Kennedy"
> >      >      >      >      >        [8,] "Labour:Europe"
> >      >      >     "Liberal
> >      >      >      >      >     Democrat:Europe"
> >      >      >      >      >        [9,] "Labour:political.knowledge"
> >      >      >       "Liberal
> >      >      >      >      >     Democrat:political.knowledge"
> >      >      >      >      >     [10,] "Labour:gendermale"
> >      >        "Liberal
> >      >      >      >      >     Democrat:gendermale"
> >      >      >      >      >     [11,] "Liberal Democrat:(Intercept)"
> >      >      >      >      >     "Conservative:(Intercept)"
> >      >      >      >      >     [12,] "Liberal Democrat:age"
> >      >      >      >       "Conservative:age"
> >      >      >      >      >
> >      >      >      >      >     [13,] "Liberal
> >     Democrat:economic.cond.national"
> >      >      >      >      >     "Conservative:economic.cond.national"
> >      >      >      >      >     [14,] "Liberal
> >     Democrat:economic.cond.household"
> >      >      >      >      >     "Conservative:economic.cond.household"
> >      >      >      >      >     [15,] "Liberal Democrat:Blair"
> >      >      >      >       "Conservative:Blair"
> >      >      >      >      >
> >      >      >      >      >     [16,] "Liberal Democrat:Hague"
> >      >      >      >       "Conservative:Hague"
> >      >      >      >      >
> >      >      >      >      >     [17,] "Liberal Democrat:Kennedy"
> >      >      >      >       "Conservative:Kennedy"
> >      >      >      >      >
> >      >      >      >      >     [18,] "Liberal Democrat:Europe"
> >      >      >      >     "Conservative:Europe"
> >      >      >      >      >
> >      >      >      >      >     [19,] "Liberal
> Democrat:political.knowledge"
> >      >      >      >      >     "Conservative:political.knowledge"
> >      >      >      >      >     [20,] "Liberal Democrat:gendermale"
> >      >      >      >      >     "Conservative:gendermale"
> >      >      >      >      >
> >      >      >      >      >       > int <- c(1, 11) # remove intercepts
> >      >      >      >      >       > colnames(V)[int]
> >      >      >      >      >     [1] "Labour:(Intercept)"
>  "Liberal
> >      >      >     Democrat:(Intercept)"
> >      >      >      >      >
> >      >      >      >      >       > colnames(V1)[int]
> >      >      >      >      >     [1] "Liberal Democrat:(Intercept)"
> >      >      >     "Conservative:(Intercept)"
> >      >      >      >      >       > V <- V[-int, -int]
> >      >      >      >      >       > V1 <- V1[-int, -int]
> >      >      >      >      >
> >      >      >      >      >       > age <- c(1, 10) # locate age
> >     coefficients
> >      >      >      >      >       > colnames(V)[age]
> >      >      >      >      >     [1] "Labour:age"           "Liberal
> >     Democrat:age"
> >      >      >      >      >       > colnames(V1)[age]
> >      >      >      >      >     [1] "Liberal Democrat:age"
> >     "Conservative:age"
> >      >      >      >      >
> >      >      >      >      >       > V <- cov2cor(V) # compute coefficient
> >      >     correlations
> >      >      >      >      >       > V1 <- cov2cor(V1)
> >      >      >      >      >
> >      >      >      >      >       > # compare GVIFs:
> >      >      >      >      >       > c(det(V[age, age])*det(V[-age,
> >     -age])/det(V),
> >      >      >      >      >     +   det(V1[age, age])*det(V1[-age,
> >     -age])/det(V1))
> >      >      >      >      >     [1] 1.046232 1.046229
> >      >      >      >      >
> >      >      >      >      >     --------- snip -----------
> >      >      >      >      >
> >      >      >      >      >     For curiosity, I applied car::vif() and
> >      >      >      >      >     performance::check_collinearity() to
> these
> >      >     models to
> >      >      >     see what
> >      >      >      >     they
> >      >      >      >      >     would
> >      >      >      >      >     do. Both returned the wrong answer. vif()
> >      >     produced a
> >      >      >     warning, but
> >      >      >      >      >     check_collinearity() didn't:
> >      >      >      >      >
> >      >      >      >      >     --------- snip -----------
> >      >      >      >      >
> >      >      >      >      >       > car::vif(m1)
> >      >      >      >      >                           age
> >     economic.cond.national
> >      >      >      >      >     economic.cond.household
> >      >      >      >      >                     15.461045
> >       22.137772
> >      >      >      >      >       16.693877
> >      >      >      >      >                         Blair
> >         Hague
> >      >      >      >      >       Kennedy
> >      >      >      >      >                     14.681562
> >     7.483039
> >      >      >      >      >       15.812067
> >      >      >      >      >                        Europe
> >       political.knowledge
> >      >      >      >      >     gender
> >      >      >      >      >                      6.502119
> >     4.219507
> >      >      >      >      >     2.313885
> >      >      >      >      >     Warning message:
> >      >      >      >      >     In vif.default(m1) : No intercept: vifs
> >     may not be
> >      >      >     sensible.
> >      >      >      >      >
> >      >      >      >      >       > performance::check_collinearity(m)
> >      >      >      >      >     # Check for Multicollinearity
> >      >      >      >      >
> >      >      >      >      >     Low Correlation
> >      >      >      >      >
> >      >      >      >      >                           Term  VIF
> Increased SE
> >      >     Tolerance
> >      >      >      >      >                            age 1.72
> >       1.31
> >      >        0.58
> >      >      >      >      >         economic.cond.national 1.85
> >       1.36
> >      >        0.54
> >      >      >      >      >        economic.cond.household 1.86
> >       1.37
> >      >        0.54
> >      >      >      >      >                          Blair 1.63
> >       1.28
> >      >        0.61
> >      >      >      >      >                          Hague 1.94
> >       1.39
> >      >        0.52
> >      >      >      >      >                        Kennedy 1.70
> >       1.30
> >      >        0.59
> >      >      >      >      >                         Europe 2.01
> >       1.42
> >      >        0.50
> >      >      >      >      >            political.knowledge 1.94
> >       1.39
> >      >        0.52
> >      >      >      >      >                         gender 1.78
> >       1.33
> >      >        0.56
> >      >      >      >      >       > performance::check_collinearity(m1)
> >      >      >      >      >     # Check for Multicollinearity
> >      >      >      >      >
> >      >      >      >      >     Low Correlation
> >      >      >      >      >
> >      >      >      >      >                           Term  VIF
> Increased SE
> >      >     Tolerance
> >      >      >      >      >                            age 1.19
> >       1.09
> >      >        0.84
> >      >      >      >      >         economic.cond.national 1.42
> >       1.19
> >      >        0.70
> >      >      >      >      >        economic.cond.household 1.32
> >       1.15
> >      >        0.76
> >      >      >      >      >                          Blair 1.50
> >       1.22
> >      >        0.67
> >      >      >      >      >                          Hague 1.30
> >       1.14
> >      >        0.77
> >      >      >      >      >                        Kennedy 1.19
> >       1.09
> >      >        0.84
> >      >      >      >      >                         Europe 1.34
> >       1.16
> >      >        0.75
> >      >      >      >      >            political.knowledge 1.30
> >       1.14
> >      >        0.77
> >      >      >      >      >                         gender 1.23
> >       1.11
> >      >        0.81
> >      >      >      >      >
> >      >      >      >      >     --------- snip -----------
> >      >      >      >      >
> >      >      >      >      >     I looked at the code for vif() and
> >      >     check_collinearity() to
> >      >      >      >     see where
> >      >      >      >      >     they went wrong. Both failed to handle
> >     the two
> >      >      >     intercepts in
> >      >      >      >     the model
> >      >      >      >      >     correctly -- vif() thought there was no
> >      >     intercept and
> >      >      >      >      >     check_collinearity() just removed the
> first
> >      >     intercept
> >      >      >     but not the
> >      >      >      >      >     second.
> >      >      >      >      >
> >      >      >      >      >     In examining the code for
> >     check_collinearity(), I
> >      >      >     discovered a
> >      >      >      >      >     couple of
> >      >      >      >      >     additional disconcerting facts. First,
> >     part of the
> >      >      >     code seems
> >      >      >      >     to be
> >      >      >      >      >     copied from vif.default(). Second, as a
> >      >     consequence,
> >      >      >      >      >     check_collinearity() actually computes
> >     GVIFs rather
> >      >      >     than VIFs
> >      >      >      >     (and
> >      >      >      >      >     doesn't reference either the Fox and
> >     Monette paper
> >      >      >      >     introducing GVIFs or
> >      >      >      >      >     the car package) but doesn't seem to
> >     understand
> >      >     that, and,
> >      >      >      >     for example,
> >      >      >      >      >     takes the squareroot of the GVIF
> >     (reported in the
> >      >      >     column marked
> >      >      >      >      >     "Increased SE") rather than the 2p root
> >     (when there
> >      >      >     are p > 1
> >      >      >      >      >     coefficients in a term).
> >      >      >      >      >
> >      >      >      >      >     Here's the relevant code from the two
> >     functions
> >      >     (where
> >      >      >     . . .
> >      >      >      >     denotes
> >      >      >      >      >     elided lines) -- the default method for
> >     vif() and
> >      >      >      >      >     .check_collinearity(),
> >      >      >      >      >     which is called by
> >     check_collinearity.default():
> >      >      >      >      >
> >      >      >      >      >     --------- snip -----------
> >      >      >      >      >
> >      >      >      >      >       > car:::vif.default
> >      >      >      >      >     function (mod, ...)
> >      >      >      >      >     {
> >      >      >      >      >           . . .
> >      >      >      >      >           v <- vcov(mod)
> >      >      >      >      >           assign <- attr(model.matrix(mod),
> >     "assign")
> >      >      >      >      >           if (names(coefficients(mod)[1]) ==
> >      >     "(Intercept)") {
> >      >      >      >      >               v <- v[-1, -1]
> >      >      >      >      >               assign <- assign[-1]
> >      >      >      >      >           }
> >      >      >      >      >           else warning("No intercept: vifs
> >     may not be
> >      >      >     sensible.")
> >      >      >      >      >           terms <- labels(terms(mod))
> >      >      >      >      >           n.terms <- length(terms)
> >      >      >      >      >           if (n.terms < 2)
> >      >      >      >      >               stop("model contains fewer
> >     than 2 terms")
> >      >      >      >      >           R <- cov2cor(v)
> >      >      >      >      >           detR <- det(R)
> >      >      >      >      >           . . .
> >      >      >      >      >           for (term in 1:n.terms) {
> >      >      >      >      >               subs <- which(assign == term)
> >      >      >      >      >               result[term, 1] <-
> >     det(as.matrix(R[subs,
> >      >      >     subs])) *
> >      >      >      >      >     det(as.matrix(R[-subs,
> >      >      >      >      >                   -subs]))/detR
> >      >      >      >      >               result[term, 2] <- length(subs)
> >      >      >      >      >           }
> >      >      >      >      >           . . .
> >      >      >      >      >     }
> >      >      >      >      >
> >      >      >      >      >       > performance:::.check_collinearity
> >      >      >      >      >     function (x, component, verbose = TRUE)
> >      >      >      >      >     {
> >      >      >      >      >           v <- insight::get_varcov(x,
> >     component =
> >      >     component,
> >      >      >      >     verbose =
> >      >      >      >      >     FALSE)
> >      >      >      >      >           assign <- .term_assignments(x,
> >     component,
> >      >     verbose =
> >      >      >      >     verbose)
> >      >      >      >      >           . . .
> >      >      >      >      >           if (insight::has_intercept(x)) {
> >      >      >      >      >               v <- v[-1, -1]
> >      >      >      >      >               assign <- assign[-1]
> >      >      >      >      >           }
> >      >      >      >      >           else {
> >      >      >      >      >               if (isTRUE(verbose)) {
> >      >      >      >      >                   warning("Model has no
> >     intercept. VIFs
> >      >      >     may not be
> >      >      >      >      >     sensible.",
> >      >      >      >      >                       call. = FALSE)
> >      >      >      >      >               }
> >      >      >      >      >           }
> >      >      >      >      >               . . .
> >      >      >      >      >               terms <-
> >      >     labels(stats::terms(f[[component]]))
> >      >      >      >      >               . . .
> >      >      >      >      >           n.terms <- length(terms)
> >      >      >      >      >           if (n.terms < 2) {
> >      >      >      >      >               if (isTRUE(verbose)) {
> >      >      >      >      >
> >      >       warning(insight::format_message(sprintf("Not
> >      >      >      >     enough model
> >      >      >      >      >     terms in the %s part of the model to
> >     check for
> >      >      >      >     multicollinearity.",
> >      >      >      >      >                       component)), call. =
> >     FALSE)
> >      >      >      >      >               }
> >      >      >      >      >               return(NULL)
> >      >      >      >      >           }
> >      >      >      >      >           R <- stats::cov2cor(v)
> >      >      >      >      >           detR <- det(R)
> >      >      >      >      >           . . .
> >      >      >      >      >           for (term in 1:n.terms) {
> >      >      >      >      >               subs <- which(assign == term)
> >      >      >      >      >                   . . .
> >      >      >      >      >                   result <- c(result,
> >      >      >     det(as.matrix(R[subs, subs])) *
> >      >      >      >      >                       det(as.matrix(R[-subs,
> >      >     -subs]))/detR)
> >      >      >      >      >                   . . .
> >      >      >      >      >           }
> >      >      >      >      >           . . .
> >      >      >      >      >     }
> >      >      >      >      >
> >      >      >      >      >     --------- snip -----------
> >      >      >      >      >
> >      >      >      >      >     So, the upshot of all this is that you
> >     should
> >      >     be able
> >      >      >     to do
> >      >      >      >     what you
> >      >      >      >      >     want, but not with either car::vif() or
> >      >      >      >      >     performance::check_collinearity().
> >     Instead, either
> >      >      >     write your own
> >      >      >      >      >     function or do the computations in a
> script.
> >      >      >      >      >
> >      >      >      >      >     There's also a lesson here about S3
> default
> >      >     methods:
> >      >      >     The fact
> >      >      >      >     that a
> >      >      >      >      >     default method returns a result rather
> than
> >      >     throwing
> >      >      >     an error
> >      >      >      >     or a
> >      >      >      >      >     warning doesn't mean that the result is
> the
> >      >     right answer.
> >      >      >      >      >
> >      >      >      >      >     I hope this helps,
> >      >      >      >      >        John
> >      >      >      >      >
> >      >      >      >      >
> >      >      >      >      >     On 2022-02-26 3:45 p.m., Juho Kristian
> >     Ruohonen
> >      >     wrote:
> >      >      >      >      >      > Dear John W,
> >      >      >      >      >      >
> >      >      >      >      >      > Thank you very much for the tip-off!
> >      >     Apologies for not
> >      >      >      >     responding
> >      >      >      >      >     earlier
> >      >      >      >      >      > (gmail apparently decided to direct
> >     your email
> >      >      >     right into the
> >      >      >      >      >     junk folder).
> >      >      >      >      >      > I am very pleased to note that the
> >     package you
> >      >      >     mention does
> >      >      >      >      >     indeed work
> >      >      >      >      >      > with *brms* multinomial models!
> >     Thanks again!
> >      >      >      >      >      >
> >      >      >      >      >      > Best,
> >      >      >      >      >      >
> >      >      >      >      >      > Juho
> >      >      >      >      >      >
> >      >      >      >      >      > pe 25. helmik. 2022 klo 19.23 John
> >     Willoughby
> >      >      >      >      >     (johnwillec at gmail.com
> >     <mailto:johnwillec at gmail.com>
> >      >     <mailto:johnwillec at gmail.com <mailto:johnwillec at gmail.com>>
> >     <mailto:johnwillec at gmail.com <mailto:johnwillec at gmail.com>
> >      >     <mailto:johnwillec at gmail.com <mailto:johnwillec at gmail.com>>>
> >      >      >     <mailto:johnwillec at gmail.com
> >     <mailto:johnwillec at gmail.com> <mailto:johnwillec at gmail.com
> >     <mailto:johnwillec at gmail.com>>
> >      >     <mailto:johnwillec at gmail.com <mailto:johnwillec at gmail.com>
> >     <mailto:johnwillec at gmail.com <mailto:johnwillec at gmail.com>>>>
> >      >      >      >     <mailto:johnwillec at gmail.com
> >     <mailto:johnwillec at gmail.com>
> >      >     <mailto:johnwillec at gmail.com <mailto:johnwillec at gmail.com>>
> >     <mailto:johnwillec at gmail.com <mailto:johnwillec at gmail.com>
> >      >     <mailto:johnwillec at gmail.com <mailto:johnwillec at gmail.com>>>
> >      >      >     <mailto:johnwillec at gmail.com
> >     <mailto:johnwillec at gmail.com> <mailto:johnwillec at gmail.com
> >     <mailto:johnwillec at gmail.com>>
> >      >     <mailto:johnwillec at gmail.com <mailto:johnwillec at gmail.com>
> >     <mailto:johnwillec at gmail.com <mailto:johnwillec at gmail.com>>>>>)
> >      >      >      >      >      > kirjoitti:
> >      >      >      >      >      >
> >      >      >      >      >      >> Have you tried the
> check_collinearity()
> >      >     function
> >      >      >     in the
> >      >      >      >     performance
> >      >      >      >      >      >> package? It's supposed to work on
> brms
> >      >     models, but
> >      >      >     whether it
> >      >      >      >      >     will work on
> >      >      >      >      >      >> a multinomial model I don't know.
> >     It works
> >      >     well
> >      >      >     on mixed
> >      >      >      >     models
> >      >      >      >      >     generated
> >      >      >      >      >      >> by glmmTMB().
> >      >      >      >      >      >>
> >      >      >      >      >      >> John Willoughby
> >      >      >      >      >      >>
> >      >      >      >      >      >>
> >      >      >      >      >      >> On Fri, Feb 25, 2022 at 3:01 AM
> >      >      >      >      >
> >       <r-sig-mixed-models-request at r-project.org
> >     <mailto:r-sig-mixed-models-request at r-project.org>
> >      >     <mailto:r-sig-mixed-models-request at r-project.org
> >     <mailto:r-sig-mixed-models-request at r-project.org>>
> >      >      >     <mailto:r-sig-mixed-models-request at r-project.org
> >     <mailto:r-sig-mixed-models-request at r-project.org>
> >      >     <mailto:r-sig-mixed-models-request at r-project.org
> >     <mailto:r-sig-mixed-models-request at r-project.org>>>
> >      >      >      >
> >       <mailto:r-sig-mixed-models-request at r-project.org
> >     <mailto:r-sig-mixed-models-request at r-project.org>
> >      >     <mailto:r-sig-mixed-models-request at r-project.org
> >     <mailto:r-sig-mixed-models-request at r-project.org>>
> >      >      >     <mailto:r-sig-mixed-models-request at r-project.org
> >     <mailto:r-sig-mixed-models-request at r-project.org>
> >      >     <mailto:r-sig-mixed-models-request at r-project.org
> >     <mailto:r-sig-mixed-models-request at r-project.org>>>>
> >      >      >      >      >
> >      >       <mailto:r-sig-mixed-models-request at r-project.org
> >     <mailto:r-sig-mixed-models-request at r-project.org>
> >      >     <mailto:r-sig-mixed-models-request at r-project.org
> >     <mailto:r-sig-mixed-models-request at r-project.org>>
> >      >      >     <mailto:r-sig-mixed-models-request at r-project.org
> >     <mailto:r-sig-mixed-models-request at r-project.org>
> >      >     <mailto:r-sig-mixed-models-request at r-project.org
> >     <mailto:r-sig-mixed-models-request at r-project.org>>>
> >      >      >      >
> >       <mailto:r-sig-mixed-models-request at r-project.org
> >     <mailto:r-sig-mixed-models-request at r-project.org>
> >      >     <mailto:r-sig-mixed-models-request at r-project.org
> >     <mailto:r-sig-mixed-models-request at r-project.org>>
> >      >      >     <mailto:r-sig-mixed-models-request at r-project.org
> >     <mailto:r-sig-mixed-models-request at r-project.org>
> >      >     <mailto:r-sig-mixed-models-request at r-project.org
> >     <mailto:r-sig-mixed-models-request at r-project.org>>>>>>
> >      >      >      >      >      >> wrote:
> >      >      >      >      >      >>
> >      >      >      >      >      >>> Send R-sig-mixed-models mailing list
> >      >     submissions to
> >      >      >      >      >      >>> r-sig-mixed-models at r-project.org
> >     <mailto:r-sig-mixed-models at r-project.org>
> >      >     <mailto:r-sig-mixed-models at r-project.org
> >     <mailto:r-sig-mixed-models at r-project.org>>
> >      >      >     <mailto:r-sig-mixed-models at r-project.org
> >     <mailto:r-sig-mixed-models at r-project.org>
> >      >     <mailto:r-sig-mixed-models at r-project.org
> >     <mailto:r-sig-mixed-models at r-project.org>>>
> >      >      >      >     <mailto:r-sig-mixed-models at r-project.org
> >     <mailto:r-sig-mixed-models at r-project.org>
> >      >     <mailto:r-sig-mixed-models at r-project.org
> >     <mailto:r-sig-mixed-models at r-project.org>>
> >      >      >     <mailto:r-sig-mixed-models at r-project.org
> >     <mailto:r-sig-mixed-models at r-project.org>
> >      >     <mailto:r-sig-mixed-models at r-project.org
> >     <mailto:r-sig-mixed-models at r-project.org>>>>
> >      >      >      >      >     <mailto:r-sig-mixed-models at r-project.org
> >     <mailto:r-sig-mixed-models at r-project.org>
> >      >     <mailto:r-sig-mixed-models at r-project.org
> >     <mailto:r-sig-mixed-models at r-project.org>>
> >      >      >     <mailto:r-sig-mixed-models at r-project.org
> >     <mailto:r-sig-mixed-models at r-project.org>
> >      >     <mailto:r-sig-mixed-models at r-project.org
> >     <mailto:r-sig-mixed-models at r-project.org>>>
> >      >      >      >     <mailto:r-sig-mixed-models at r-project.org
> >     <mailto:r-sig-mixed-models at r-project.org>
> >      >     <mailto:r-sig-mixed-models at r-project.org
> >     <mailto:r-sig-mixed-models at r-project.org>>
> >      >      >     <mailto:r-sig-mixed-models at r-project.org
> >     <mailto:r-sig-mixed-models at r-project.org>
> >      >     <mailto:r-sig-mixed-models at r-project.org
> >     <mailto:r-sig-mixed-models at r-project.org>>>>>
> >      >      >      >      >      >>>
> >      >      >      >      >      >>> To subscribe or unsubscribe via the
> >     World Wide
> >      >      >     Web, visit
> >      >      >      >      >      >>>
> >      >      > https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
> >      >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>
> >      >      >
> >       <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
> >      >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>>
> >      >      >      >
> >      >       <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
> >      >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>
> >      >      >
> >       <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
> >      >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>>>
> >      >      >      >      >
> >      >      >
> >       <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
> >      >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>
> >      >      >
> >       <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
> >      >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>>
> >      >      >      >
> >      >       <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
> >      >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>
> >      >      >
> >       <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
> >      >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>>>>
> >      >      >      >      >      >>> or, via email, send a message with
> >     subject or
> >      >      >     body 'help' to
> >      >      >      >      >      >>>
> >     r-sig-mixed-models-request at r-project.org
> >     <mailto:r-sig-mixed-models-request at r-project.org>
> >      >     <mailto:r-sig-mixed-models-request at r-project.org
> >     <mailto:r-sig-mixed-models-request at r-project.org>>
> >      >      >     <mailto:r-sig-mixed-models-request at r-project.org
> >     <mailto:r-sig-mixed-models-request at r-project.org>
> >      >     <mailto:r-sig-mixed-models-request at r-project.org
> >     <mailto:r-sig-mixed-models-request at r-project.org>>>
> >      >      >      >
> >       <mailto:r-sig-mixed-models-request at r-project.org
> >     <mailto:r-sig-mixed-models-request at r-project.org>
> >      >     <mailto:r-sig-mixed-models-request at r-project.org
> >     <mailto:r-sig-mixed-models-request at r-project.org>>
> >      >      >     <mailto:r-sig-mixed-models-request at r-project.org
> >     <mailto:r-sig-mixed-models-request at r-project.org>
> >      >     <mailto:r-sig-mixed-models-request at r-project.org
> >     <mailto:r-sig-mixed-models-request at r-project.org>>>>
> >      >      >      >      >
> >      >       <mailto:r-sig-mixed-models-request at r-project.org
> >     <mailto:r-sig-mixed-models-request at r-project.org>
> >      >     <mailto:r-sig-mixed-models-request at r-project.org
> >     <mailto:r-sig-mixed-models-request at r-project.org>>
> >      >      >     <mailto:r-sig-mixed-models-request at r-project.org
> >     <mailto:r-sig-mixed-models-request at r-project.org>
> >      >     <mailto:r-sig-mixed-models-request at r-project.org
> >     <mailto:r-sig-mixed-models-request at r-project.org>>>
> >      >      >      >
> >       <mailto:r-sig-mixed-models-request at r-project.org
> >     <mailto:r-sig-mixed-models-request at r-project.org>
> >      >     <mailto:r-sig-mixed-models-request at r-project.org
> >     <mailto:r-sig-mixed-models-request at r-project.org>>
> >      >      >     <mailto:r-sig-mixed-models-request at r-project.org
> >     <mailto:r-sig-mixed-models-request at r-project.org>
> >      >     <mailto:r-sig-mixed-models-request at r-project.org
> >     <mailto:r-sig-mixed-models-request at r-project.org>>>>>
> >      >      >      >      >      >>>
> >      >      >      >      >      >>> You can reach the person managing
> >     the list at
> >      >      >      >      >      >>>
> >     r-sig-mixed-models-owner at r-project.org
> >     <mailto:r-sig-mixed-models-owner at r-project.org>
> >      >     <mailto:r-sig-mixed-models-owner at r-project.org
> >     <mailto:r-sig-mixed-models-owner at r-project.org>>
> >      >      >     <mailto:r-sig-mixed-models-owner at r-project.org
> >     <mailto:r-sig-mixed-models-owner at r-project.org>
> >      >     <mailto:r-sig-mixed-models-owner at r-project.org
> >     <mailto:r-sig-mixed-models-owner at r-project.org>>>
> >      >      >      >     <mailto:r-sig-mixed-models-owner at r-project.org
> >     <mailto:r-sig-mixed-models-owner at r-project.org>
> >      >     <mailto:r-sig-mixed-models-owner at r-project.org
> >     <mailto:r-sig-mixed-models-owner at r-project.org>>
> >      >      >     <mailto:r-sig-mixed-models-owner at r-project.org
> >     <mailto:r-sig-mixed-models-owner at r-project.org>
> >      >     <mailto:r-sig-mixed-models-owner at r-project.org
> >     <mailto:r-sig-mixed-models-owner at r-project.org>>>>
> >      >      >      >      >
> >       <mailto:r-sig-mixed-models-owner at r-project.org
> >     <mailto:r-sig-mixed-models-owner at r-project.org>
> >      >     <mailto:r-sig-mixed-models-owner at r-project.org
> >     <mailto:r-sig-mixed-models-owner at r-project.org>>
> >      >      >     <mailto:r-sig-mixed-models-owner at r-project.org
> >     <mailto:r-sig-mixed-models-owner at r-project.org>
> >      >     <mailto:r-sig-mixed-models-owner at r-project.org
> >     <mailto:r-sig-mixed-models-owner at r-project.org>>>
> >      >      >      >     <mailto:r-sig-mixed-models-owner at r-project.org
> >     <mailto:r-sig-mixed-models-owner at r-project.org>
> >      >     <mailto:r-sig-mixed-models-owner at r-project.org
> >     <mailto:r-sig-mixed-models-owner at r-project.org>>
> >      >      >     <mailto:r-sig-mixed-models-owner at r-project.org
> >     <mailto:r-sig-mixed-models-owner at r-project.org>
> >      >     <mailto:r-sig-mixed-models-owner at r-project.org
> >     <mailto:r-sig-mixed-models-owner at r-project.org>>>>>
> >      >      >      >      >      >>>
> >      >      >      >      >      >>> When replying, please edit your
> Subject
> >      >     line so it is
> >      >      >      >     more specific
> >      >      >      >      >      >>> than "Re: Contents of
> >     R-sig-mixed-models
> >      >     digest..."
> >      >      >      >      >      >>>
> >      >      >      >      >      >>>
> >      >      >      >      >      >>> Today's Topics:
> >      >      >      >      >      >>>
> >      >      >      >      >      >>>     1. Collinearity diagnostics for
> >     (mixed)
> >      >      >     multinomial
> >      >      >      >     models
> >      >      >      >      >      >>>        (Juho Kristian Ruohonen)
> >      >      >      >      >      >>>
> >      >      >      >      >      >>>
> >      >      >      >      >
> >      >      >      >
> >      >      >
> >      >
> >
>  ----------------------------------------------------------------------
> >      >      >      >      >      >>>
> >      >      >      >      >      >>> Message: 1
> >      >      >      >      >      >>> Date: Fri, 25 Feb 2022 10:23:25
> +0200
> >      >      >      >      >      >>> From: Juho Kristian Ruohonen
> >      >      >      >     <juho.kristian.ruohonen at gmail.com
> >     <mailto:juho.kristian.ruohonen at gmail.com>
> >      >     <mailto:juho.kristian.ruohonen at gmail.com
> >     <mailto:juho.kristian.ruohonen at gmail.com>>
> >      >      >     <mailto:juho.kristian.ruohonen at gmail.com
> >     <mailto:juho.kristian.ruohonen at gmail.com>
> >      >     <mailto:juho.kristian.ruohonen at gmail.com
> >     <mailto:juho.kristian.ruohonen at gmail.com>>>
> >      >      >      >     <mailto:juho.kristian.ruohonen at gmail.com
> >     <mailto:juho.kristian.ruohonen at gmail.com>
> >      >     <mailto:juho.kristian.ruohonen at gmail.com
> >     <mailto:juho.kristian.ruohonen at gmail.com>>
> >      >      >     <mailto:juho.kristian.ruohonen at gmail.com
> >     <mailto:juho.kristian.ruohonen at gmail.com>
> >      >     <mailto:juho.kristian.ruohonen at gmail.com
> >     <mailto:juho.kristian.ruohonen at gmail.com>>>>
> >      >      >      >      >     <mailto:juho.kristian.ruohonen at gmail.com
> >     <mailto:juho.kristian.ruohonen at gmail.com>
> >      >     <mailto:juho.kristian.ruohonen at gmail.com
> >     <mailto:juho.kristian.ruohonen at gmail.com>>
> >      >      >     <mailto:juho.kristian.ruohonen at gmail.com
> >     <mailto:juho.kristian.ruohonen at gmail.com>
> >      >     <mailto:juho.kristian.ruohonen at gmail.com
> >     <mailto:juho.kristian.ruohonen at gmail.com>>>
> >      >      >      >     <mailto:juho.kristian.ruohonen at gmail.com
> >     <mailto:juho.kristian.ruohonen at gmail.com>
> >      >     <mailto:juho.kristian.ruohonen at gmail.com
> >     <mailto:juho.kristian.ruohonen at gmail.com>>
> >      >      >     <mailto:juho.kristian.ruohonen at gmail.com
> >     <mailto:juho.kristian.ruohonen at gmail.com>
> >      >     <mailto:juho.kristian.ruohonen at gmail.com
> >     <mailto:juho.kristian.ruohonen at gmail.com>>>>>>
> >      >      >      >      >      >>> To: John Fox <jfox at mcmaster.ca
> >     <mailto:jfox at mcmaster.ca>
> >      >     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>
> >      >      >     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
> >     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>>
> >      >     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
> >     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>
> >      >      >     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
> >     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>>>
> >      >      >      >     <mailto:jfox at mcmaster.ca
> >     <mailto:jfox at mcmaster.ca> <mailto:jfox at mcmaster.ca
> >     <mailto:jfox at mcmaster.ca>>
> >      >     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
> >     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>>
> >      >      >     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
> >     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>
> >      >     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
> >     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>>>>>
> >      >      >      >      >      >>> Cc:
> >     "r-sig-mixed-models at r-project.org
> >     <mailto:r-sig-mixed-models at r-project.org>
> >      >     <mailto:r-sig-mixed-models at r-project.org
> >     <mailto:r-sig-mixed-models at r-project.org>>
> >      >      >     <mailto:r-sig-mixed-models at r-project.org
> >     <mailto:r-sig-mixed-models at r-project.org>
> >      >     <mailto:r-sig-mixed-models at r-project.org
> >     <mailto:r-sig-mixed-models at r-project.org>>>
> >      >      >      >     <mailto:r-sig-mixed-models at r-project.org
> >     <mailto:r-sig-mixed-models at r-project.org>
> >      >     <mailto:r-sig-mixed-models at r-project.org
> >     <mailto:r-sig-mixed-models at r-project.org>>
> >      >      >     <mailto:r-sig-mixed-models at r-project.org
> >     <mailto:r-sig-mixed-models at r-project.org>
> >      >     <mailto:r-sig-mixed-models at r-project.org
> >     <mailto:r-sig-mixed-models at r-project.org>>>>
> >      >      >      >      >     <mailto:r-sig-mixed-models at r-project.org
> >     <mailto:r-sig-mixed-models at r-project.org>
> >      >     <mailto:r-sig-mixed-models at r-project.org
> >     <mailto:r-sig-mixed-models at r-project.org>>
> >      >      >     <mailto:r-sig-mixed-models at r-project.org
> >     <mailto:r-sig-mixed-models at r-project.org>
> >      >     <mailto:r-sig-mixed-models at r-project.org
> >     <mailto:r-sig-mixed-models at r-project.org>>>
> >      >      >      >     <mailto:r-sig-mixed-models at r-project.org
> >     <mailto:r-sig-mixed-models at r-project.org>
> >      >     <mailto:r-sig-mixed-models at r-project.org
> >     <mailto:r-sig-mixed-models at r-project.org>>
> >      >      >     <mailto:r-sig-mixed-models at r-project.org
> >     <mailto:r-sig-mixed-models at r-project.org>
> >      >     <mailto:r-sig-mixed-models at r-project.org
> >     <mailto:r-sig-mixed-models at r-project.org>>>>>"
> >      >      >      >      >      >>>
> >     <r-sig-mixed-models at r-project.org
> >     <mailto:r-sig-mixed-models at r-project.org>
> >      >     <mailto:r-sig-mixed-models at r-project.org
> >     <mailto:r-sig-mixed-models at r-project.org>>
> >      >      >     <mailto:r-sig-mixed-models at r-project.org
> >     <mailto:r-sig-mixed-models at r-project.org>
> >      >     <mailto:r-sig-mixed-models at r-project.org
> >     <mailto:r-sig-mixed-models at r-project.org>>>
> >      >      >      >     <mailto:r-sig-mixed-models at r-project.org
> >     <mailto:r-sig-mixed-models at r-project.org>
> >      >     <mailto:r-sig-mixed-models at r-project.org
> >     <mailto:r-sig-mixed-models at r-project.org>>
> >      >      >     <mailto:r-sig-mixed-models at r-project.org
> >     <mailto:r-sig-mixed-models at r-project.org>
> >      >     <mailto:r-sig-mixed-models at r-project.org
> >     <mailto:r-sig-mixed-models at r-project.org>>>>
> >      >      >      >      >     <mailto:r-sig-mixed-models at r-project.org
> >     <mailto:r-sig-mixed-models at r-project.org>
> >      >     <mailto:r-sig-mixed-models at r-project.org
> >     <mailto:r-sig-mixed-models at r-project.org>>
> >      >      >     <mailto:r-sig-mixed-models at r-project.org
> >     <mailto:r-sig-mixed-models at r-project.org>
> >      >     <mailto:r-sig-mixed-models at r-project.org
> >     <mailto:r-sig-mixed-models at r-project.org>>>
> >      >      >      >     <mailto:r-sig-mixed-models at r-project.org
> >     <mailto:r-sig-mixed-models at r-project.org>
> >      >     <mailto:r-sig-mixed-models at r-project.org
> >     <mailto:r-sig-mixed-models at r-project.org>>
> >      >      >     <mailto:r-sig-mixed-models at r-project.org
> >     <mailto:r-sig-mixed-models at r-project.org>
> >      >     <mailto:r-sig-mixed-models at r-project.org
> >     <mailto:r-sig-mixed-models at r-project.org>>>>>>
> >      >      >      >      >      >>> Subject: [R-sig-ME] Collinearity
> >      >     diagnostics for
> >      >      >     (mixed)
> >      >      >      >      >     multinomial
> >      >      >      >      >      >>>          models
> >      >      >      >      >      >>> Message-ID:
> >      >      >      >      >      >>>          <
> >      >      >      >      >      >>>
> >      >      >      >      >
> >      >      >      >
> >      >      >
> >      >
> >     CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com
> >     <mailto:
> CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com>
> >      >
> >       <mailto:
> CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com
> <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com
> >>
> >      >      >
> >      >
> >       <mailto:
> CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com
> <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com>
> <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com
> <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com
> >>>
> >      >      >      >
> >      >      >
> >      >
> >       <mailto:
> CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com
> <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com>
> <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com
> <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com>>
> <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com
> <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com>
> <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com
> <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com
> >>>>
> >      >      >      >      >
> >      >      >      >
> >      >      >
> >      >
> >       <mailto:
> CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com
> <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com>
> <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com
> <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com>>
> <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com
> <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com>
> <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com
> <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com>>>
> <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com
> <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com>
> <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com
> <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com>>
> <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com
> <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com>
> <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com
> <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com
> >>>>>>
> >      >      >      >      >      >>> Content-Type: text/plain;
> >     charset="utf-8"
> >      >      >      >      >      >>>
> >      >      >      >      >      >>> Dear John (and anyone else
> qualified to
> >      >     comment),
> >      >      >      >      >      >>>
> >      >      >      >      >      >>> I fit lots of mixed-effects
> multinomial
> >      >     models in my
> >      >      >      >     research,
> >      >      >      >      >     and I
> >      >      >      >      >      >> would
> >      >      >      >      >      >>> like to see some (multi)collinearity
> >      >     diagnostics
> >      >      >     on the
> >      >      >      >     fixed
> >      >      >      >      >     effects, of
> >      >      >      >      >      >>> which there are over 30. My models
> >     are fit
> >      >     using the
> >      >      >      >     Bayesian
> >      >      >      >      >     *brms*
> >      >      >      >      >      >>> package because I know of no
> >     frequentist
> >      >     packages
> >      >      >     with
> >      >      >      >      >     multinomial GLMM
> >      >      >      >      >      >>> compatibility.
> >      >      >      >      >      >>>
> >      >      >      >      >      >>> With continuous or dichotomous
> >     outcomes,
> >      >     my go-to
> >      >      >      >     function for
> >      >      >      >      >      >> calculating
> >      >      >      >      >      >>> multicollinearity diagnostics is of
> >     course
> >      >      >     *vif()* from
> >      >      >      >     the *car*
> >      >      >      >      >      >> package.
> >      >      >      >      >      >>> As expected, however, this function
> >     does not
> >      >      >     report sensible
> >      >      >      >      >     diagnostics
> >      >      >      >      >      >>> for multinomial models -- not even
> for
> >      >     standard
> >      >      >     ones fit
> >      >      >      >     by the
> >      >      >      >      >     *nnet*
> >      >      >      >      >      >>> package's *multinom()* function.
> >     The reason, I
> >      >      >     presume, is
> >      >      >      >      >     because a
> >      >      >      >      >      >>> multinomial model is not really one
> >     but C-1
> >      >      >     regression
> >      >      >      >     models
> >      >      >      >      >     (where C
> >      >      >      >      >      >> is
> >      >      >      >      >      >>> the number of response categories)
> >     and the
> >      >     *vif()*
> >      >      >      >     function is not
> >      >      >      >      >      >> designed
> >      >      >      >      >      >>> to deal with this scenario.
> >      >      >      >      >      >>>
> >      >      >      >      >      >>> Therefore, in order to obtain
> >     meaningful
> >      >     collinearity
> >      >      >      >     metrics,
> >      >      >      >      >     my present
> >      >      >      >      >      >>> plan is to write a simple helper
> >     function
> >      >     that uses
> >      >      >      >     *vif() *to
> >      >      >      >      >     calculate
> >      >      >      >      >      >>> and present (generalized) variance
> >     inflation
> >      >      >     metrics for
> >      >      >      >     the C-1
> >      >      >      >      >      >>> sub-datasets to which the C-1
> component
> >      >     binomial
> >      >      >     models
> >      >      >      >     of the
> >      >      >      >      >     overall
> >      >      >      >      >      >>> multinomial model are fit. In other
> >     words, it
> >      >      >     will partition
> >      >      >      >      >     the data
> >      >      >      >      >      >> into
> >      >      >      >      >      >>> those C-1 subsets, and then apply
> >     *vif()*
> >      >     to as
> >      >      >     many linear
> >      >      >      >      >     regressions
> >      >      >      >      >      >>> using a made-up continuous response
> and
> >      >     the fixed
> >      >      >     effects of
> >      >      >      >      >     interest.
> >      >      >      >      >      >>>
> >      >      >      >      >      >>> Does this seem like a sensible
> >     approach?
> >      >      >      >      >      >>>
> >      >      >      >      >      >>> Best,
> >      >      >      >      >      >>>
> >      >      >      >      >      >>> Juho
> >      >      >      >      >      >>>
> >      >      >      >      >      >>>
> >      >      >      >      >      >>>
> >      >      >      >      >      >>
> >      >      >      >      >      >>          [[alternative HTML version
> >     deleted]]
> >      >      >      >      >      >>
> >      >      >      >      >      >>
> >     _______________________________________________
> >      >      >      >      >      >> R-sig-mixed-models at r-project.org
> >     <mailto:R-sig-mixed-models at r-project.org>
> >      >     <mailto:R-sig-mixed-models at r-project.org
> >     <mailto:R-sig-mixed-models at r-project.org>>
> >      >      >     <mailto:R-sig-mixed-models at r-project.org
> >     <mailto:R-sig-mixed-models at r-project.org>
> >      >     <mailto:R-sig-mixed-models at r-project.org
> >     <mailto:R-sig-mixed-models at r-project.org>>>
> >      >      >      >     <mailto:R-sig-mixed-models at r-project.org
> >     <mailto:R-sig-mixed-models at r-project.org>
> >      >     <mailto:R-sig-mixed-models at r-project.org
> >     <mailto:R-sig-mixed-models at r-project.org>>
> >      >      >     <mailto:R-sig-mixed-models at r-project.org
> >     <mailto:R-sig-mixed-models at r-project.org>
> >      >     <mailto:R-sig-mixed-models at r-project.org
> >     <mailto:R-sig-mixed-models at r-project.org>>>>
> >      >      >      >      >     <mailto:R-sig-mixed-models at r-project.org
> >     <mailto:R-sig-mixed-models at r-project.org>
> >      >     <mailto:R-sig-mixed-models at r-project.org
> >     <mailto:R-sig-mixed-models at r-project.org>>
> >      >      >     <mailto:R-sig-mixed-models at r-project.org
> >     <mailto:R-sig-mixed-models at r-project.org>
> >      >     <mailto:R-sig-mixed-models at r-project.org
> >     <mailto:R-sig-mixed-models at r-project.org>>>
> >      >      >      >     <mailto:R-sig-mixed-models at r-project.org
> >     <mailto:R-sig-mixed-models at r-project.org>
> >      >     <mailto:R-sig-mixed-models at r-project.org
> >     <mailto:R-sig-mixed-models at r-project.org>>
> >      >      >     <mailto:R-sig-mixed-models at r-project.org
> >     <mailto:R-sig-mixed-models at r-project.org>
> >      >     <mailto:R-sig-mixed-models at r-project.org
> >     <mailto:R-sig-mixed-models at r-project.org>>>>> mailing list
> >      >      >      >      >      >>
> >      >      > https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
> >      >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>
> >      >      >
> >       <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
> >      >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>>
> >      >      >      >
> >      >       <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
> >      >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>
> >      >      >
> >       <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
> >      >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>>>
> >      >      >      >      >
> >      >      >
> >       <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
> >      >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>
> >      >      >
> >       <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
> >      >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>>
> >      >      >      >
> >      >       <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
> >      >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>
> >      >      >
> >       <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
> >      >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>>>>
> >      >      >      >      >      >>
> >      >      >      >      >      >
> >      >      >      >      >      >       [[alternative HTML version
> >     deleted]]
> >      >      >      >      >      >
> >      >      >      >      >      >
> >     _______________________________________________
> >      >      >      >      >      > R-sig-mixed-models at r-project.org
> >     <mailto:R-sig-mixed-models at r-project.org>
> >      >     <mailto:R-sig-mixed-models at r-project.org
> >     <mailto:R-sig-mixed-models at r-project.org>>
> >      >      >     <mailto:R-sig-mixed-models at r-project.org
> >     <mailto:R-sig-mixed-models at r-project.org>
> >      >     <mailto:R-sig-mixed-models at r-project.org
> >     <mailto:R-sig-mixed-models at r-project.org>>>
> >      >      >      >     <mailto:R-sig-mixed-models at r-project.org
> >     <mailto:R-sig-mixed-models at r-project.org>
> >      >     <mailto:R-sig-mixed-models at r-project.org
> >     <mailto:R-sig-mixed-models at r-project.org>>
> >      >      >     <mailto:R-sig-mixed-models at r-project.org
> >     <mailto:R-sig-mixed-models at r-project.org>
> >      >     <mailto:R-sig-mixed-models at r-project.org
> >     <mailto:R-sig-mixed-models at r-project.org>>>>
> >      >      >      >      >     <mailto:R-sig-mixed-models at r-project.org
> >     <mailto:R-sig-mixed-models at r-project.org>
> >      >     <mailto:R-sig-mixed-models at r-project.org
> >     <mailto:R-sig-mixed-models at r-project.org>>
> >      >      >     <mailto:R-sig-mixed-models at r-project.org
> >     <mailto:R-sig-mixed-models at r-project.org>
> >      >     <mailto:R-sig-mixed-models at r-project.org
> >     <mailto:R-sig-mixed-models at r-project.org>>>
> >      >      >      >     <mailto:R-sig-mixed-models at r-project.org
> >     <mailto:R-sig-mixed-models at r-project.org>
> >      >     <mailto:R-sig-mixed-models at r-project.org
> >     <mailto:R-sig-mixed-models at r-project.org>>
> >      >      >     <mailto:R-sig-mixed-models at r-project.org
> >     <mailto:R-sig-mixed-models at r-project.org>
> >      >     <mailto:R-sig-mixed-models at r-project.org
> >     <mailto:R-sig-mixed-models at r-project.org>>>>> mailing list
> >      >      >      >      >      >
> >      >      > https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
> >      >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>
> >      >      >
> >       <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
> >      >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>>
> >      >      >      >
> >      >       <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
> >      >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>
> >      >      >
> >       <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
> >      >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>>>
> >      >      >      >      >
> >      >      >
> >       <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
> >      >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>
> >      >      >
> >       <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
> >      >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>>
> >      >      >      >
> >      >       <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
> >      >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>
> >      >      >
> >       <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
> >      >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>>>>
> >      >      >      >      >     --
> >      >      >      >      >     John Fox, Professor Emeritus
> >      >      >      >      >     McMaster University
> >      >      >      >      >     Hamilton, Ontario, Canada
> >      >      >      >      >     web:
> >     https://socialsciences.mcmaster.ca/jfox/
> >     <https://socialsciences.mcmaster.ca/jfox/>
> >      >     <https://socialsciences.mcmaster.ca/jfox/
> >     <https://socialsciences.mcmaster.ca/jfox/>>
> >      >      >     <https://socialsciences.mcmaster.ca/jfox/
> >     <https://socialsciences.mcmaster.ca/jfox/>
> >      >     <https://socialsciences.mcmaster.ca/jfox/
> >     <https://socialsciences.mcmaster.ca/jfox/>>>
> >      >      >      >     <https://socialsciences.mcmaster.ca/jfox/
> >     <https://socialsciences.mcmaster.ca/jfox/>
> >      >     <https://socialsciences.mcmaster.ca/jfox/
> >     <https://socialsciences.mcmaster.ca/jfox/>>
> >      >      >     <https://socialsciences.mcmaster.ca/jfox/
> >     <https://socialsciences.mcmaster.ca/jfox/>
> >      >     <https://socialsciences.mcmaster.ca/jfox/
> >     <https://socialsciences.mcmaster.ca/jfox/>>>>
> >      >      >      >      >
> >       <https://socialsciences.mcmaster.ca/jfox/
> >     <https://socialsciences.mcmaster.ca/jfox/>
> >      >     <https://socialsciences.mcmaster.ca/jfox/
> >     <https://socialsciences.mcmaster.ca/jfox/>>
> >      >      >     <https://socialsciences.mcmaster.ca/jfox/
> >     <https://socialsciences.mcmaster.ca/jfox/>
> >      >     <https://socialsciences.mcmaster.ca/jfox/
> >     <https://socialsciences.mcmaster.ca/jfox/>>>
> >      >      >      >     <https://socialsciences.mcmaster.ca/jfox/
> >     <https://socialsciences.mcmaster.ca/jfox/>
> >      >     <https://socialsciences.mcmaster.ca/jfox/
> >     <https://socialsciences.mcmaster.ca/jfox/>>
> >      >      >     <https://socialsciences.mcmaster.ca/jfox/
> >     <https://socialsciences.mcmaster.ca/jfox/>
> >      >     <https://socialsciences.mcmaster.ca/jfox/
> >     <https://socialsciences.mcmaster.ca/jfox/>>>>>
> >      >      >      >      >
> >      >      >      >     --
> >      >      >      >     John Fox, Professor Emeritus
> >      >      >      >     McMaster University
> >      >      >      >     Hamilton, Ontario, Canada
> >      >      >      >     web: https://socialsciences.mcmaster.ca/jfox/
> >     <https://socialsciences.mcmaster.ca/jfox/>
> >      >     <https://socialsciences.mcmaster.ca/jfox/
> >     <https://socialsciences.mcmaster.ca/jfox/>>
> >      >      >     <https://socialsciences.mcmaster.ca/jfox/
> >     <https://socialsciences.mcmaster.ca/jfox/>
> >      >     <https://socialsciences.mcmaster.ca/jfox/
> >     <https://socialsciences.mcmaster.ca/jfox/>>>
> >      >      >      >     <https://socialsciences.mcmaster.ca/jfox/
> >     <https://socialsciences.mcmaster.ca/jfox/>
> >      >     <https://socialsciences.mcmaster.ca/jfox/
> >     <https://socialsciences.mcmaster.ca/jfox/>>
> >      >      >     <https://socialsciences.mcmaster.ca/jfox/
> >     <https://socialsciences.mcmaster.ca/jfox/>
> >      >     <https://socialsciences.mcmaster.ca/jfox/
> >     <https://socialsciences.mcmaster.ca/jfox/>>>>
> >      >      >      >
> >      >      >     --
> >      >      >     John Fox, Professor Emeritus
> >      >      >     McMaster University
> >      >      >     Hamilton, Ontario, Canada
> >      >      >     web: https://socialsciences.mcmaster.ca/jfox/
> >     <https://socialsciences.mcmaster.ca/jfox/>
> >      >     <https://socialsciences.mcmaster.ca/jfox/
> >     <https://socialsciences.mcmaster.ca/jfox/>>
> >      >      >     <https://socialsciences.mcmaster.ca/jfox/
> >     <https://socialsciences.mcmaster.ca/jfox/>
> >      >     <https://socialsciences.mcmaster.ca/jfox/
> >     <https://socialsciences.mcmaster.ca/jfox/>>>
> >      >      >
> >      >
> >
>  ------------------------------------------------------------------------
> >      >     --
> >      >     John Fox, Professor Emeritus
> >      >     McMaster University
> >      >     Hamilton, Ontario, Canada
> >      >     web: https://socialsciences.mcmaster.ca/jfox/
> >     <https://socialsciences.mcmaster.ca/jfox/>
> >      >     <https://socialsciences.mcmaster.ca/jfox/
> >     <https://socialsciences.mcmaster.ca/jfox/>>
> >      >
> >     --
> >     John Fox, Professor Emeritus
> >     McMaster University
> >     Hamilton, Ontario, Canada
> >     web: https://socialsciences.mcmaster.ca/jfox/
> >     <https://socialsciences.mcmaster.ca/jfox/>
> >
> --
> John Fox, Professor Emeritus
> McMaster University
> Hamilton, Ontario, Canada
> web: https://socialsciences.mcmaster.ca/jfox/
>
>

	[[alternative HTML version deleted]]


From pnb@t|ey @end|ng |rom gm@||@com  Thu Jan 26 21:23:45 2023
From: pnb@t|ey @end|ng |rom gm@||@com (Prathiba Natesan Batley)
Date: Thu, 26 Jan 2023 15:23:45 -0500
Subject: [R-sig-ME] Please post to the listserv
In-Reply-To: <1d2bd0bc-30ff-342d-2af3-a7af9100000c@mcmaster.ca>
References: <17101_1674685951_30PMWUBr009712_CAFA0+65YEs=oUTjwGCV8X3jFWs0neJLu8_Jo_0Tn_S9Yi2cskA@mail.gmail.com>
 <1d2bd0bc-30ff-342d-2af3-a7af9100000c@mcmaster.ca>
Message-ID: <CAFA0+65eYdBuwmLNroEPF7yZcvYcnEkROWdk4KN4yZtHk-sJ_A@mail.gmail.com>

John: You made my day!!! And in haste I typed in a f instead of an m in my
original message. Yes, it is a mixed effects model.

On Wed, Jan 25, 2023 at 6:21 PM John Fox <jfox at mcmaster.ca> wrote:

> Dear Prathiba,
>
> m2$modelStruct$corStruct is a fairly complex object, not a simple
> number. Try:
>
>         coef(m2$modelStruct$corStruct, unconstrained=FALSE)
>
> (By the way, I couldn't make sense of the sample dataset you said you
> supplied, so I couldn't check my answer. Also, your model is a mixed
> model, not a fixed-effects model -- there are random effects.)
>
> I hope this helps,
>   John
>
> --
> John Fox, Professor Emeritus
> McMaster University
> Hamilton, Ontario, Canada
> web: https://socialsciences.mcmaster.ca/jfox/
>
> On 2023-01-25 5:14 p.m., Prathiba Natesan Batley wrote:
> > Hello:
> > Could you please post the following to the listserv?
> >
> > I am in a bit of a pickle here. I tried running a fixed effects model
> with
> > autocorrelation on a very small dataset (single case design). My syntax
> > look like this:
> >    lm2 <- lme(y ~ 1 + treatment, random = ~1|pid, data = df, correlation
> =
> > corAR1())
> > I want to obtain the phi coefficient which I see is in
> > lm2$modelStruct$corStruct. But the moment I extract it and put it into a
> > matrix it stores a different value. In this case it should be -0.17 but
> is
> > stored as -0.35. Pls see below:
> >> lm.2$modelStruct$corStruct
> > Correlation structure of class corAR1 representing
> >         Phi
> > -0.1743846
> >
> >> cbind(1, lm.2$modelStruct$corStruct)
> >       [,1]       [,2]
> > [1,]    1 -0.3523706
> >
> > Here is a sample dataset and syntax
> >              d=.5
> >              ICC=.1
> >              m=6
> >              phi=0
> >              n=5
> >              rep=1
> >              df <- read.csv(paste0("data", d, "-", ICC, "-", phi, "-", m,
> > "-", n, "_", rep, ".csv"))
> > lm2 <- lme(y ~ 1 + treatment, random = ~1|pid, data = df, correlation =
> > corAR1())
> > phi.hps <- c(lm2[[1]][2]) #or lm2$modelStruct#corStruct
> > _______________________________________________
> > R-sig-mixed-models at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>
>

	[[alternative HTML version deleted]]


From |@w|@wt @end|ng |rom gm@||@com  Sat Jan 28 06:22:18 2023
From: |@w|@wt @end|ng |rom gm@||@com (Timothy MacKenzie)
Date: Fri, 27 Jan 2023 23:22:18 -0600
Subject: [R-sig-ME] glmmTMB: dispformula for mixed beta regression
Message-ID: <CADreqiz=T2GWdWQ8Oh8=dAEvKo7zzzpPf0=DE-PfBOn+e4696Q@mail.gmail.com>

Dear All,

I have a mixed beta-regression model whose residuals don't spread
evenly across its fitted values unless I add X1 and X2 (two numeric
predictors) to the "dispformula" argument (see below).

Based on the Dispersion model results below, can I say the higher the
value of X2 (0.147987), the more spread-out the residuals but not so
much so for X1 (0.003548)?

In other words, can I think of the variables in dispformula as
"variance covariates"?

glmmTMB(y ~ X1 + X2 + (1 | id), family = beta_family("logit"),
dispformula = ~ X1 + X2)

Dispersion model:
   (Intercept)           X1                   X2
      0.752923        0.003548        0.147987

Thanks,
Tim M


From jh@|t|g@ @end|ng |rom gm@||@com  Sun Jan 29 02:07:38 2023
From: jh@|t|g@ @end|ng |rom gm@||@com (J.D. Haltigan)
Date: Sat, 28 Jan 2023 20:07:38 -0500
Subject: [R-sig-ME] Question on HGLM package HGLM2 function
Message-ID: <CAH_7VOn_C6FptkJQN53=dsQsk6um25FmRo2m0OvCYfNx6fG34w@mail.gmail.com>

Hi:

Perhaps someone on the list may be able to assist me in troubleshooting why
when I run the following model using HGLM2:

>GLM2_1 = hglm2(posXsymp~ treatment+proper_mask_base+prop_resp_ill_base_2 +
(1 | union), family=gaussian(link=identity), rand.family=Beta(link=logit),
maxit = 100, data = my_data)

I get the following error:

# Error in glm.fit(x = c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,  :
#                          NA/NaN/Inf in 'x'
#                        In addition: Warning message:
#                          In hglm.default(X = X, y = Y, Z = Z, family =
family, rand.family = rand.family,  :
#                                            Residuals numerically 0 are
replaced by 1e-8

Yet, when I run a similar model:

HGLM2_5 = hglm2(posXsymp~ treatment+proper_mask_base+prop_resp_ill_base_2 +
(1 | union), family =poisson (link = log), rand.family =Gamma(link=log),
data = my_data)

I have no problems.

The only difference, of course, between the two models is one is specified
as a Gaussian run and one is specified as a poisson run. The data are the
same, variables are the same etc.

The Y response distribution in both cases is binomial (symptoms or not),
but the error in the first run seems to suggest my issue is with the X
variable response distributions.

Any insights would be most appreciated.

Best,
J.D.

	[[alternative HTML version deleted]]


From bbo|ker @end|ng |rom gm@||@com  Sun Jan 29 03:20:12 2023
From: bbo|ker @end|ng |rom gm@||@com (Ben Bolker)
Date: Sat, 28 Jan 2023 21:20:12 -0500
Subject: [R-sig-ME] Question on HGLM package HGLM2 function
In-Reply-To: <CAH_7VOn_C6FptkJQN53=dsQsk6um25FmRo2m0OvCYfNx6fG34w@mail.gmail.com>
References: <CAH_7VOn_C6FptkJQN53=dsQsk6um25FmRo2m0OvCYfNx6fG34w@mail.gmail.com>
Message-ID: <CABghstRHbZPw4UGzEbeX8TH6dEgVLg0-zp7s_7XmtC1rd8pn2w@mail.gmail.com>

Do you have only a single observation per group (union)? This looks like
the kind of error message you would get if the random effect were
confounded with the residual variance (which wouldn't be a problem with a
Poisson response)

On Sat, Jan 28, 2023, 8:08 PM J.D. Haltigan <jhaltiga at gmail.com> wrote:

> Hi:
>
> Perhaps someone on the list may be able to assist me in troubleshooting why
> when I run the following model using HGLM2:
>
> >GLM2_1 = hglm2(posXsymp~ treatment+proper_mask_base+prop_resp_ill_base_2 +
> (1 | union), family=gaussian(link=identity), rand.family=Beta(link=logit),
> maxit = 100, data = my_data)
>
> I get the following error:
>
> # Error in glm.fit(x = c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,  :
> #                          NA/NaN/Inf in 'x'
> #                        In addition: Warning message:
> #                          In hglm.default(X = X, y = Y, Z = Z, family =
> family, rand.family = rand.family,  :
> #                                            Residuals numerically 0 are
> replaced by 1e-8
>
> Yet, when I run a similar model:
>
> HGLM2_5 = hglm2(posXsymp~ treatment+proper_mask_base+prop_resp_ill_base_2 +
> (1 | union), family =poisson (link = log), rand.family =Gamma(link=log),
> data = my_data)
>
> I have no problems.
>
> The only difference, of course, between the two models is one is specified
> as a Gaussian run and one is specified as a poisson run. The data are the
> same, variables are the same etc.
>
> The Y response distribution in both cases is binomial (symptoms or not),
> but the error in the first run seems to suggest my issue is with the X
> variable response distributions.
>
> Any insights would be most appreciated.
>
> Best,
> J.D.
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>

	[[alternative HTML version deleted]]


From mo|||eebrook@ @end|ng |rom gm@||@com  Mon Jan 30 13:09:03 2023
From: mo|||eebrook@ @end|ng |rom gm@||@com (Mollie Brooks)
Date: Mon, 30 Jan 2023 13:09:03 +0100
Subject: [R-sig-ME] glmmTMB: dispformula for mixed beta regression
In-Reply-To: <CADreqiz=T2GWdWQ8Oh8=dAEvKo7zzzpPf0=DE-PfBOn+e4696Q@mail.gmail.com>
References: <CADreqiz=T2GWdWQ8Oh8=dAEvKo7zzzpPf0=DE-PfBOn+e4696Q@mail.gmail.com>
Message-ID: <3D065F33-87AC-439A-88B1-DB64A5E87519@gmail.com>

Dear Tim,

For the beta family, the conditional variance is mu*(1-mu)/(1+phi) (i.e., increasing phi decreases the variance.) This is in the helpfile ?sigma.glmmTMB. The dispersion model is for log(phi). So higher X2 values give lower variance.  Does that agree with your data?

Cheers,
Mollie

> On 28 Jan 2023, at 06.22, Timothy MacKenzie <fswfswt at gmail.com> wrote:
> 
> Dear All,
> 
> I have a mixed beta-regression model whose residuals don't spread
> evenly across its fitted values unless I add X1 and X2 (two numeric
> predictors) to the "dispformula" argument (see below).
> 
> Based on the Dispersion model results below, can I say the higher the
> value of X2 (0.147987), the more spread-out the residuals but not so
> much so for X1 (0.003548)?
> 
> In other words, can I think of the variables in dispformula as
> "variance covariates"?
> 
> glmmTMB(y ~ X1 + X2 + (1 | id), family = beta_family("logit"),
> dispformula = ~ X1 + X2)
> 
> Dispersion model:
>   (Intercept)           X1                   X2
>      0.752923        0.003548        0.147987
> 
> Thanks,
> Tim M
> 
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models


From |@w|@wt @end|ng |rom gm@||@com  Mon Jan 30 17:10:53 2023
From: |@w|@wt @end|ng |rom gm@||@com (Timothy MacKenzie)
Date: Mon, 30 Jan 2023 10:10:53 -0600
Subject: [R-sig-ME] glmmTMB: dispformula for mixed beta regression
In-Reply-To: <3D065F33-87AC-439A-88B1-DB64A5E87519@gmail.com>
References: <CADreqiz=T2GWdWQ8Oh8=dAEvKo7zzzpPf0=DE-PfBOn+e4696Q@mail.gmail.com>
 <3D065F33-87AC-439A-88B1-DB64A5E87519@gmail.com>
Message-ID: <CADreqixTRGGBsLMshEA6PzG66RaoQZJgy1zFvNnx+F0e6+KUUg@mail.gmail.com>

Dear Mollie,

Thank you for your clarification. So, I can conclude that X2 has a
logarithmically inverse association with residuals' variance. But then
for interpretation purposes, should I say that: 0.147987 for X2 in the
dispersion model is the slope of that association when X2 is 0?

OR should I say that: for each unit of increase in X2, residuals'
variance decreases by exp(0.147987) = 1.16?

Thank you,
Tim M

On Mon, Jan 30, 2023 at 6:09 AM Mollie Brooks <mollieebrooks at gmail.com> wrote:
>
> Dear Tim,
>
> For the beta family, the conditional variance is mu*(1-mu)/(1+phi) (i.e., increasing phi decreases the variance.) This is in the helpfile ?sigma.glmmTMB. The dispersion model is for log(phi). So higher X2 values give lower variance.  Does that agree with your data?
>
> Cheers,
> Mollie
>
> > On 28 Jan 2023, at 06.22, Timothy MacKenzie <fswfswt at gmail.com> wrote:
> >
> > Dear All,
> >
> > I have a mixed beta-regression model whose residuals don't spread
> > evenly across its fitted values unless I add X1 and X2 (two numeric
> > predictors) to the "dispformula" argument (see below).
> >
> > Based on the Dispersion model results below, can I say the higher the
> > value of X2 (0.147987), the more spread-out the residuals but not so
> > much so for X1 (0.003548)?
> >
> > In other words, can I think of the variables in dispformula as
> > "variance covariates"?
> >
> > glmmTMB(y ~ X1 + X2 + (1 | id), family = beta_family("logit"),
> > dispformula = ~ X1 + X2)
> >
> > Dispersion model:
> >   (Intercept)           X1                   X2
> >      0.752923        0.003548        0.147987
> >
> > Thanks,
> > Tim M
> >
> > _______________________________________________
> > R-sig-mixed-models at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>


From me @end|ng |rom ph||||p@|d@y@com  Wed Feb  1 06:19:32 2023
From: me @end|ng |rom ph||||p@|d@y@com (Phillip Alday)
Date: Tue, 31 Jan 2023 23:19:32 -0600
Subject: [R-sig-ME] 
 Collinearity diagnostics for (mixed) multinomial models
In-Reply-To: <CAG_dBVc2Vw6mQ17ZvXM+vJvvON9D=jHsXp+_3gM7m1zukNAAuQ@mail.gmail.com>
References: <mailman.19600.5.1645786802.52378.r-sig-mixed-models@r-project.org>
 <CAKk2L3LEaRHPQDNx49twbQaM4t5=FGJArkz1kCRzBkiAP87kQQ@mail.gmail.com>
 <24314_1645908336_21QKjZ8b017357_CAG_dBVfdOZmbLRsWOQ5f28Y32ZMtDsOVE2-6FZmUaQ0H8f0+EQ@mail.gmail.com>
 <ec746b24-eb5b-5579-2b24-3c3b492d55d9@mcmaster.ca>
 <CAG_dBVfcpzW5RAs9syWFdL+RvryeAppowexjX_a9zJqRu+PC4Q@mail.gmail.com>
 <7e05d26d-e8af-aa48-8fd4-543c9f3dc3a2@mcmaster.ca>
 <CAG_dBVenhHeF5-hmA7M6xfD2FAeLmqzwc6AL-xrVREZuKyyKpA@mail.gmail.com>
 <67a63dca-f3c0-d766-0a2a-bad1a5fed9c3@mcmaster.ca>
 <CAG_dBVcv+12Q6_dSdX7_2cBPR5PgQmJ5bqZgQoWh88ATCmT6GA@mail.gmail.com>
 <0f03187e-d848-ea43-e370-ead2d403b530@mcmaster.ca>
 <CAG_dBVfv2-8Z0VRvcK4QUP97oh5jOhPd2d=LUj0N_6Ec+appMw@mail.gmail.com>
 <f80557f3-35c7-7b22-ae9c-2f14ff0d7ac0@mcmaster.ca>
 <CAG_dBVe7f5aEB_hA5t-j2u9ZJw-bDQPOchxc3-QTX3VejqXQSQ@mail.gmail.com>
 <d8c397b8-fbec-6c39-fdf5-5047daf6f219@mcmaster.ca>
 <CAG_dBVc2Vw6mQ17ZvXM+vJvvON9D=jHsXp+_3gM7m1zukNAAuQ@mail.gmail.com>
Message-ID: <dfd31e31-511c-73c0-a8a4-dfc2a3e37b20@phillipalday.com>

I haven't seen an answer go by yet, but here's a breadcrumb:

Iacobucci, D., Schneider, M.J., Popovich, D.L. et al. Mean centering
helps alleviate ?micro? but not ?macro? multicollinearity. Behav Res 48,
1308?1317 (2016). https://doi.org/10.3758/s13428-015-0624-x



On 26/1/23 8:56 am, Juho Kristian Ruohonen wrote:
> Dear all,
> 
> I'm resurrecting this thread because a problem has come up which might need
> fixing once someone gets around to writing a relevant R package.
> 
> In this same thread last March, John Fox showed me how to compute GVIFs for
> a *nnet* multinomial model. I then wrote a simple function that loops
> through all predictors in such a model and applies John's code to them,
> returning the GVIF, DF, and GVIF^(1/(2*Df)) statistic for each predictor.
> Available here
> <https://github.com/jkruohon/StatsMisc/blob/main/gvif_multinom.R>, the
> function seems to work just fine, reproducing John's results exactly on the
> carData examples. Likewise, applying this function to my own research data
> yielded entirely plausible results.
> 
> But to my horror, I now discover that *when I refit my multinomial model
> with two quantitative predictors centered, the GVIF statistics change
> considerably** -- *even though the model has the same fit and virtually
> identical coefficients (except for the intercepts) as the original one. How
> can this be? The only thing that changes between the two models is the set
> of intercepts which, moreover, are specifically excluded from the GVIF
> calculations.
> 
> Below is a minimal example. The anonymized datafile is downloadable here
> <https://github.com/jkruohon/StatsMisc/raw/main/d_anon.RData>.
> 
>> mod1 <- multinom(y ~., data = d.anon, maxit = 999)
>> gvif.multinom(mod1) # x6 and x26 top the collinearity list
>             GVIF DF GVIF^(1/(2df))
> x6  3.463522e+03  3       3.889732
> x26 2.988396e+03  3       3.795244
> x27 1.390830e+03  3       3.341019
> x2  3.889656e+02  3       2.701792
> x13 2.930026e+02  3       2.577183
> x19 2.051250e+04  6       2.287362
> x25 7.043339e+03  6       2.092417
> x24 1.078212e+07 12       1.963493
> x9  2.357662e+01  3       1.693351
> x17 1.991744e+01  3       1.646413
> x5  3.869759e+02  6       1.643010
> x12 1.787075e+01  3       1.616927
> x18 2.943991e+02  6       1.605997
> x1  2.700175e+03  9       1.551075
> x16 2.576739e+04 12       1.526844
> x7  1.483341e+02  6       1.516829
> x20 1.159374e+01  3       1.504425
> x3  1.612637e+04 12       1.497318
> x28 1.081693e+01  3       1.487136
> x10 9.706880e+00  3       1.460539
> x22 9.459035e+00  3       1.454257
> x15 9.124519e+00  3       1.445556
> x14 7.017242e+00  3       1.383655
> x21 6.404687e+00  3       1.362750
> x8  6.072614e+00  3       1.350712
> x11 4.797251e+00  3       1.298670
> x4  3.665742e+03 18       1.256043
> x23 3.557201e+00  3       1.235525
> 
> Now we refit the model with the quantitative predictors x6 and x26 centered:
> 
>> d.anon$x6 <- d.anon$x6 - mean(d.anon$x6)
>> d.anon$x26 <- d.anon$x26 - mean(d.anon$x26)
>> mod2 <- update(mod1, data = d.anon, maxit = 999)
>> c(logLik(mod1), logLik(mod2))  # same fit to the data
> [1] -2074.133 -2074.134
> 
>> gvif.multinom(mod2)
>             GVIF DF GVIF^(1/(2df))
> x2  6.196959e+04  3       6.290663
> x13 3.031115e+04  3       5.583850
> x27 2.552811e+04  3       5.426291
> x14 1.642231e+04  3       5.041646
> x6  1.573721e+04  3       5.005967
> x26 1.464437e+04  3       4.946277
> x9  1.262667e+04  3       4.825564
> x10 5.714321e+03  3       4.228251
> x19 2.255013e+07  6       4.099798
> x25 1.227033e+07  6       3.897068
> x12 3.394139e+03  3       3.876635
> x15 1.938364e+03  3       3.531067
> x11 1.685265e+03  3       3.449674
> x21 8.429450e+02  3       3.073500
> x23 7.639755e+02  3       3.023523
> x22 6.887451e+02  3       2.971733
> x17 5.640312e+02  3       2.874422
> x20 3.855848e+02  3       2.697864
> x24 1.444083e+10 12       2.650430
> x7  7.148911e+04  6       2.538166
> x18 1.674603e+04  6       2.249017
> x5  9.662266e+03  6       2.148275
> x16 6.264044e+07 12       2.112851
> x1  6.634544e+05  9       2.105882
> x3  1.558132e+07 12       1.993847
> x8  6.168472e+01  3       1.987755
> x4  4.256459e+06 18       1.528059
> x28 9.783234e+00  3       1.462448
> 
> And so I'm at my wits' end. The models are virtually identical, yet the
> GVIF statistics are very different. I don't know which ones to trust.
> Worse, the discrepancy makes me disinclined to trust either of them --
> which is a return to Square One, i.e. the situation where GVIF statistics
> for multinomial models did not exist. And I don't know which
> multicollinearity metric I can present in my thesis, if any.
> 
> I hope someone can help.
> 
> Best,
> 
> Juho
> 
> 
> 
> 
> 
> ke 2. maalisk. 2022 klo 16.35 John Fox (jfox at mcmaster.ca) kirjoitti:
> 
>> Dear Juho,
>>
>> On 2022-03-02 6:23 a.m., Juho Kristian Ruohonen wrote:
>>> One last comment, John: Sorry if I seemed to be implying that you (or
>>> anyone else) should debug my code for me. That wasn't the idea. I do
>>> believe that the function locates the intended rows/columns
>>> successfully. I just wasn't entirely positive what those intended
>>> rows/columns should be when dealing with a multicategory factor.
>>> Presently, it locates every row/column involving the multicategory
>>> factor in question, so the number of rows/columns identified is the
>>> number of factor levels minus one, times the number of response
>>> categories minus one. I hope that's correct.
>>
>> OK, that's a fair remark. Yes, what you describe is correct.
>>
>> You can also reassure yourself that your function is working properly by:
>>
>> (1) If you haven't already done so, show that you get the same GVIFs
>> from your function as from the one I sent you used directly.
>>
>> (2) Vary the baseline level of the response variable and confirm that
>> you get the same GVIFs.
>>
>> (3) Vary the basis for the regressor subspace for a factor, e.g., either
>> by using contr.sum() in place of the default contr.treatment() or by
>> changing the baseline level of the factor for contr.treatment(), and
>> again confirm that the GVIFs are unchanged.
>>
>> Best,
>>   John
>>
>>>
>>> My current plan is to present the output of the new function in my
>>> thesis and credit you for the math. But if *vif()* gets a relevant
>>> update before my project is finished, then I'll use that and cite the
>>> /car /package instead.
>>>
>>> Thanks again for your help.
>>>
>>> Best,
>>>
>>> Juho
>>>
>>> ti 1. maalisk. 2022 klo 23.54 John Fox (jfox at mcmaster.ca
>>> <mailto:jfox at mcmaster.ca>) kirjoitti:
>>>
>>>     Dear Juho,
>>>
>>>     On 2022-03-01 3:13 p.m., Juho Kristian Ruohonen wrote:
>>>      > Dear John,
>>>      >
>>>      > Yes, my function uses your code for the math. I was just hoping to
>>>      > verify that it is handling multicategory factors correctly (your
>>>      > examples didn't involve any).
>>>
>>>     That's not really my point. Your code sets up computations for the
>>>     various terms in the model automatically, while the function I sent
>>>     requires that you locate the rows/columns for the intercepts and each
>>>     focal term manually. If you haven't already done so, you could check
>>>     that your function is identifying the correct columns and getting the
>>>     corresponding GVIFs.
>>>
>>>      >
>>>      > I guess interactions aren't that important after all, given that
>> the
>>>      > chief concern is usually collinearity among main effects.
>>>
>>>     I wouldn't say that, but it's not clear what collinearity means in
>>>     models with interactions, and if you compute VIFs or GVIFs for "main
>>>     effects" in models with interactions, you'll probably get nonsense.
>>>
>>>     As I said, I think that this might be a solvable problem, but one
>> that
>>>     requires thought about what needs to remain invariant.
>>>
>>>     I think that we've probably come to end for now.
>>>
>>>     John
>>>
>>>      >
>>>      > Many thanks for all your help.
>>>      >
>>>      > Best,
>>>      >
>>>      > Juho
>>>      >
>>>      > ti 1. maalisk. 2022 klo 18.01 John Fox (jfox at mcmaster.ca
>>>     <mailto:jfox at mcmaster.ca>
>>>      > <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>) kirjoitti:
>>>      >
>>>      >     Dear Juho,
>>>      >
>>>      >     On 2022-03-01 8:24 a.m., Juho Kristian Ruohonen wrote:
>>>      >      > Dear John (Fox, as well as other list members),
>>>      >      >
>>>      >      > I've now written a simple function to try and calculate
>>>     GVIFS for
>>>      >     all
>>>      >      > predictors in a nnet::multinom() object based on John's
>>>     example
>>>      >     code. If
>>>      >      > its results are correct (see below), I will proceed to
>> write a
>>>      >     version
>>>      >      > that also works with mixed-effects multinomial models fit
>> by
>>>      >      > brms::brm(). Here's the code:
>>>      >      >
>>>      >      >     gvif.multinom <- function(model){
>>>      >      >        (classes <- model$lev)
>>>      >      >        (V.all <- vcov(model))
>>>      >      >        (V.noIntercepts <- V.all[!grepl("\\(Intercept\\)$",
>>>      >      >     rownames(V.all), perl = T),
>>>      >      >                                 !grepl("\\(Intercept\\)$",
>>>      >      >     colnames(V.all), perl = T)])
>>>      >      >        (R <- cov2cor(V.noIntercepts))
>>>      >      >        (terms <- attr(model$terms, "term.labels"))
>>>      >      >        (gvif <- numeric(length = length(terms)))
>>>      >      >        (names(gvif) <- terms)
>>>      >      >        (SE.multiplier <- numeric(length = length(terms)))
>>>      >      >        (names(SE.multiplier) <- terms)
>>>      >      >        #The line below tries to capture all factor levels
>>>     into a
>>>      >     regex
>>>      >      >     for coef name matching.
>>>      >      >        (LevelsRegex <- paste0("(",
>>>     paste(unlist(model$xlevels),
>>>      >     collapse
>>>      >      >     = "|"),")?"))
>>>      >      >
>>>      >      >        for(i in terms){
>>>      >      >          #The regex stuff below tries to ensure all
>>>     interaction
>>>      >      >     coefficients are matched, including those involving
>>>     factors.
>>>      >      >          if(grepl(":", i)){
>>>      >      >            (termname <- gsub(":", paste0(LevelsRegex,
>> ":"), i,
>>>      >     perl = T))
>>>      >      >          }else{termname <- i}
>>>      >      >          (RegexToMatch <- paste0("^(",
>>>      >     paste(classes[2:length(classes)],
>>>      >      >     collapse = "|") ,"):", termname, LevelsRegex, "$"))
>>>      >      >
>>>      >      >          #Now the actual calculation:
>>>      >      >          (indices <- grep(RegexToMatch, rownames(R), perl
>>>     = T))
>>>      >      >          (gvif[i] <- det(R[indices, indices]) *
>>>     det(R[-indices,
>>>      >      >     -indices]) / det(R))
>>>      >      >          (SE.multiplier[i] <-
>> gvif[i]^(1/(2*length(indices))))
>>>      >      >        }
>>>      >      >        #Put the results together and order them by degree
>>>     of SE
>>>      >     inflation:
>>>      >      >        (result <- cbind(GVIF = gvif, `GVIF^(1/(2df))` =
>>>      >     SE.multiplier))
>>>      >      >        return(result[order(result[,"GVIF^(1/(2df))"],
>>>     decreasing
>>>      >     = T),])}
>>>      >      >
>>>      >      >
>>>      >      > The results seem correct to me when applied to John's
>> example
>>>      >     model fit
>>>      >      > to the BEPS data. However, that dataset contains no
>> multi-df
>>>      >     factors, of
>>>      >      > which my own models have many. Below is a maximally simple
>>>      >     example with
>>>      >      > one multi-df factor (/region/):
>>>      >      >
>>>      >      >     mod1 <- multinom(partic ~., data = carData::Womenlf)
>>>      >      >     gvif.multinom(mod1)
>>>      >      >
>>>      >      >     GVIF GVIF^(1/(2df))
>>>      >      >     children 1.298794       1.067542
>>>      >      >     hincome  1.184215       1.043176
>>>      >      >     region   1.381480       1.020403
>>>      >      >
>>>      >      >
>>>      >      > These results look plausible to me. Finally, below is an
>>>     example
>>>      >      > involving both a multi-df factor and an interaction:
>>>      >      >
>>>      >      >     mod2 <- update(mod1, ~. +children:region)
>>>      >      >     gvif.multinom(mod2)
>>>      >      >
>>>      >      >                              GVIF GVIF^(1/(2df))
>>>      >      >     children:region 4.965762e+16      11.053482
>>>      >      >     region          1.420418e+16      10.221768
>>>      >      >     children        1.471412e+03       6.193463
>>>      >      >     hincome         6.462161e+00       1.594390
>>>      >      >
>>>      >      >
>>>      >      > These results look a bit more dubious. To be sure, it is
>> to be
>>>      >     expected
>>>      >      > that interaction terms will introduce a lot of
>>>     collinearity. But an
>>>      >      > 11-fold increase in SE? I hope someone can tell me whether
>>>     this is
>>>      >      > correct or not!
>>>      >
>>>      >     You don't need someone else to check your work because you
>>>     could just
>>>      >     apply the simple function that I sent you yesterday, which,
>>>     though not
>>>      >     automatic, computes the GVIFs in a transparent manner.
>>>      >
>>>      >     A brief comment on GVIFs for models with interactions (this
>>>     isn't the
>>>      >     place to discuss the question in detail): The Fox and Monette
>>>     JASA
>>>      >     paper
>>>      >     addresses the question briefly in the context of a two-way
>>>     ANOVA, but I
>>>      >     don't think that the approach suggested there is easily
>>>     generalized.
>>>      >
>>>      >     The following simple approach pays attention to what's
>>>     invariant under
>>>      >     different parametrizations of the RHS side of the model:
>>>     Simultaneously
>>>      >     check the collinearity of all of the coefficients of an
>>>     interaction
>>>      >     together with the main effects and, potentially, lower-order
>>>      >     interactions that are marginal to it. So, e.g., in the model
>>>     y ~ a +
>>>      >     b +
>>>      >     a:b + c, you'd check all of the coefficients for a, b, and
>>>     a:b together.
>>>      >
>>>      >     Alternatively, one could focus in turn on each explanatory
>>>     variable and
>>>      >     check the collinearity of all coefficients to which it is
>>>     marginal. So
>>>      >     in y ~ a + b + c + a:b + a:c + d, when you focus on a, you'd
>>>     look at
>>>      >     all
>>>      >     of the coefficients for a, b, c, a:b, and a:c.
>>>      >
>>>      >     John
>>>      >
>>>      >      >
>>>      >      > Best,
>>>      >      >
>>>      >      > Juho
>>>      >      >
>>>      >      >
>>>      >      >
>>>      >      >
>>>      >      >
>>>      >      >
>>>      >      >
>>>      >      >
>>>      >      >
>>>      >      >
>>>      >      >
>>>      >      > ti 1. maalisk. 2022 klo 0.05 John Fox (jfox at mcmaster.ca
>>>     <mailto:jfox at mcmaster.ca>
>>>      >     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>
>>>      >      > <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
>>>     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>>) kirjoitti:
>>>      >      >
>>>      >      >     Dear Juha,
>>>      >      >
>>>      >      >     On 2022-02-28 5:00 p.m., Juho Kristian Ruohonen wrote:
>>>      >      >      > Apologies for my misreading, John, and many thanks
>>>     for showing
>>>      >      >     how the
>>>      >      >      > calculation is done for a single term.
>>>      >      >      >
>>>      >      >      > Do you think *vif()* might be updated in the near
>>>     future
>>>      >     with the
>>>      >      >      > capability of auto-detecting a multinomial model
>>>     and returning
>>>      >      >      > mathematically correct GVIF statistics?
>>>      >      >
>>>      >      >     The thought crossed my mind, but I'd want to do it in a
>>>      >     general way,
>>>      >      >     not
>>>      >      >     just for the multinom() function, and in a way that
>> avoids
>>>      >     incorrect
>>>      >      >     results such as those currently produced for "multinom"
>>>      >     models, albeit
>>>      >      >     with a warning. I can't guarantee whether or when I'll
>> be
>>>      >     able to do
>>>      >      >     that.
>>>      >      >
>>>      >      >     John
>>>      >      >
>>>      >      >      >
>>>      >      >      > If not, I'll proceed to writing my own function
>>>     based on your
>>>      >      >     example.
>>>      >      >      > However, /car/ is such an excellent and widely used
>>>      >     package that the
>>>      >      >      > greatest benefit to mankind would probably accrue
>>>     if /car /was
>>>      >      >     upgraded
>>>      >      >      > with this feature sooner rather than later.
>>>      >      >      >
>>>      >      >      > Best,
>>>      >      >      >
>>>      >      >      > Juho
>>>      >      >      >
>>>      >      >      >
>>>      >      >      >
>>>      >      >      >
>>>      >      >      >
>>>      >      >      >
>>>      >      >      >
>>>      >      >      >
>>>      >      >      >
>>>      >      >      > ma 28. helmik. 2022 klo 17.08 John Fox
>>>     (jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
>>>      >     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>
>>>      >      >     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
>>>     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>>
>>>      >      >      > <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
>>>     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>
>>>      >     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
>>>     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>>>) kirjoitti:
>>>      >      >      >
>>>      >      >      >     Dear Juho,
>>>      >      >      >
>>>      >      >      >     On 2022-02-28 2:06 a.m., Juho Kristian Ruohonen
>>>     wrote:
>>>      >      >      >      > Dear Professor Fox and other list members,
>>>      >      >      >      >
>>>      >      >      >      > Profuse thanks for doing that detective work
>> for
>>>      >     me! I myself
>>>      >      >      >     thought
>>>      >      >      >      > the inflation factors reported by
>>>      >     check_collinearity() were
>>>      >      >      >     suspiciously
>>>      >      >      >      > high, but unlike you I lacked the expertise
>>>     to identify
>>>      >      >     what was
>>>      >      >      >     going on.
>>>      >      >      >      >
>>>      >      >      >      > As for your suggested approach, have I
>>>     understood this
>>>      >      >     correctly:
>>>      >      >      >      >
>>>      >      >      >      > Since there doesn't yet exist an R function
>>>     that will
>>>      >      >     calculate the
>>>      >      >      >      > (G)VIFS of multinomial models correctly, my
>> best
>>>      >     bet for
>>>      >      >     now is
>>>      >      >      >     just to
>>>      >      >      >      > ignore the fact that such models partition
>>>     the data
>>>      >     into C-1
>>>      >      >      >     subsets,
>>>      >      >      >      > and to calculate approximate GVIFs from the
>>>     entire
>>>      >     dataset at
>>>      >      >      >     once as if
>>>      >      >      >      > the response were continuous? And a simple
>>>     way to
>>>      >     do this
>>>      >      >     is to
>>>      >      >      >      > construct a fake continuous response, call
>>>      >      >     *lm(fakeresponse ~.)*,
>>>      >      >      >     and
>>>      >      >      >      > apply *car::vif()* on the result?
>>>      >      >      >
>>>      >      >      >     No, you misunderstand my suggestion, which
>>>     perhaps isn't
>>>      >      >     surprising
>>>      >      >      >     given the length of my message. What you
>>>     propose is what I
>>>      >      >     suggested as
>>>      >      >      >     a rough approximation *before* I confirmed that
>> my
>>>      >     guess of the
>>>      >      >      >     solution
>>>      >      >      >     was correct.
>>>      >      >      >
>>>      >      >      >     The R code that I sent yesterday showed how to
>>>     compute the
>>>      >      >     GVIF for a
>>>      >      >      >     multinomial regression model, and I suggested
>>>     that you
>>>      >     write
>>>      >      >     either a
>>>      >      >      >     script or a simple function to do that. Here's
>>>     a function
>>>      >      >     that will
>>>      >      >      >     work
>>>      >      >      >     for a model object that responds to vcov():
>>>      >      >      >
>>>      >      >      >     GVIF <- function(model, intercepts, term){
>>>      >      >      >         # model: regression model object
>>>      >      >      >         # intercepts: row/column positions of
>>>     intercepts
>>>      >     in the
>>>      >      >     coefficient
>>>      >      >      >     covariance matrix
>>>      >      >      >         # term: row/column positions of the
>>>     coefficients
>>>      >     for the
>>>      >      >     focal term
>>>      >      >      >         V <- vcov(model)
>>>      >      >      >         term <- colnames(V)[term]
>>>      >      >      >         V <- V[-intercepts, -intercepts]
>>>      >      >      >         V <- cov2cor(V)
>>>      >      >      >         term <- which(colnames(V) %in% term)
>>>      >      >      >         gvif <- det(V[term, term])*det(V[-term,
>>>     -term])/det(V)
>>>      >      >      >         c(GVIF=gvif,
>>>      >     "GVIF^(1/(2*p))"=gvif^(1/(2*length(term))))
>>>      >      >      >     }
>>>      >      >      >
>>>      >      >      >     and here's an application to the multinom()
>>>     example that I
>>>      >      >     showed you
>>>      >      >      >     yesterday:
>>>      >      >      >
>>>      >      >      >       > colnames(vcov(m)) # to get coefficient
>>>     positions
>>>      >      >      >        [1] "Labour:(Intercept)"
>>>      >       "Labour:age"
>>>      >      >      >
>>>      >      >      >        [3] "Labour:economic.cond.national"
>>>      >      >      >     "Labour:economic.cond.household"
>>>      >      >      >        [5] "Labour:Blair"
>>>      >       "Labour:Hague"
>>>      >      >      >
>>>      >      >      >        [7] "Labour:Kennedy"
>>>      >       "Labour:Europe"
>>>      >      >      >
>>>      >      >      >        [9] "Labour:political.knowledge"
>>>      >      >       "Labour:gendermale"
>>>      >      >      >
>>>      >      >      >     [11] "Liberal Democrat:(Intercept)"
>>>       "Liberal
>>>      >      >     Democrat:age"
>>>      >      >      >
>>>      >      >      >     [13] "Liberal Democrat:economic.cond.national"
>>>     "Liberal
>>>      >      >      >     Democrat:economic.cond.household"
>>>      >      >      >     [15] "Liberal Democrat:Blair"
>>>       "Liberal
>>>      >      >      >     Democrat:Hague"
>>>      >      >      >
>>>      >      >      >     [17] "Liberal Democrat:Kennedy"
>>>       "Liberal
>>>      >      >      >     Democrat:Europe"
>>>      >      >      >     [19] "Liberal Democrat:political.knowledge"
>>>       "Liberal
>>>      >      >      >     Democrat:gendermale"
>>>      >      >      >
>>>      >      >      >       > GVIF(m, intercepts=c(1, 11), term=c(2, 12))
>>>     # GVIF
>>>      >     for age
>>>      >      >      >                 GVIF GVIF^(1/(2*p))
>>>      >      >      >             1.046232       1.011363
>>>      >      >      >
>>>      >      >      >
>>>      >      >      >     Finally, here's what you get for a linear model
>>>     with
>>>      >     the same RHS
>>>      >      >      >     (where
>>>      >      >      >     the sqrt(VIF) should be a rough approximation to
>>>      >     GVIF^(1/4)
>>>      >      >     reported by
>>>      >      >      >     my GVIF() function):
>>>      >      >      >
>>>      >      >      >       > m.lm <- lm(as.numeric(vote) ~ . - vote1,
>>>     data=BEPS)
>>>      >      >      >       > sqrt(car::vif(m.lm))
>>>      >      >      >                           age
>> economic.cond.national
>>>      >      >      >     economic.cond.household
>>>      >      >      >                         Blair
>>>      >      >      >                      1.006508
>> 1.124132
>>>      >      >      >     1.075656
>>>      >      >      >                      1.118441
>>>      >      >      >                         Hague
>>  Kennedy
>>>      >      >      >     Europe
>>>      >      >      >           political.knowledge
>>>      >      >      >                      1.066799
>> 1.015532
>>>      >      >      >     1.101741
>>>      >      >      >                      1.028546
>>>      >      >      >                        gender
>>>      >      >      >                      1.017386
>>>      >      >      >
>>>      >      >      >
>>>      >      >      >     John
>>>      >      >      >
>>>      >      >      >      >
>>>      >      >      >      > Best,
>>>      >      >      >      >
>>>      >      >      >      > Juho
>>>      >      >      >      >
>>>      >      >      >      > ma 28. helmik. 2022 klo 2.23 John Fox
>>>      >     (jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
>>>     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>
>>>      >      >     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
>>>     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>>
>>>      >      >      >     <mailto:jfox at mcmaster.ca
>>>     <mailto:jfox at mcmaster.ca> <mailto:jfox at mcmaster.ca
>>>     <mailto:jfox at mcmaster.ca>>
>>>      >     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
>>>     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>>>
>>>      >      >      >      > <mailto:jfox at mcmaster.ca
>>>     <mailto:jfox at mcmaster.ca> <mailto:jfox at mcmaster.ca
>>>     <mailto:jfox at mcmaster.ca>>
>>>      >     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
>>>     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>>
>>>      >      >     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
>>>     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>
>>>      >     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
>>>     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>>>>) kirjoitti:
>>>      >      >      >      >
>>>      >      >      >      >     Dear Juho,
>>>      >      >      >      >
>>>      >      >      >      >     I've now had a chance to think about this
>>>      >     problem some
>>>      >      >     more,
>>>      >      >      >     and I
>>>      >      >      >      >     believe that the approach I suggested is
>>>     correct. I
>>>      >      >     also had an
>>>      >      >      >      >     opportunity to talk the problem over a
>>>     bit with
>>>      >     Georges
>>>      >      >      >     Monette, who
>>>      >      >      >      >     coauthored the paper that introduced
>>>      >     generalized variance
>>>      >      >      >     inflation
>>>      >      >      >      >     factors (GVIFs). On the other hand, the
>>>     results
>>>      >      >     produced by
>>>      >      >      >      >     performance::check_collinearity() for
>>>      >     multinomial logit
>>>      >      >      >     models don't
>>>      >      >      >      >     seem to be correct (see below).
>>>      >      >      >      >
>>>      >      >      >      >     Here's an example, using the
>>>     nnet::multinom()
>>>      >     function
>>>      >      >     to fit a
>>>      >      >      >      >     multinomial logit model, with alternative
>>>      >      >     parametrizations of the
>>>      >      >      >      >     LHS of
>>>      >      >      >      >     the model:
>>>      >      >      >      >
>>>      >      >      >      >     --------- snip -----------
>>>      >      >      >      >
>>>      >      >      >      >       > library(nnet) # for multinom()
>>>      >      >      >      >       > library(carData) # for BEPS data set
>>>      >      >      >      >
>>>      >      >      >      >       > # alternative ordering of the
>>>     response levels:
>>>      >      >      >      >       > BEPS$vote1 <- factor(BEPS$vote,
>>>      >     levels=c("Labour",
>>>      >      >     "Liberal
>>>      >      >      >      >     Democrat", "Conservative"))
>>>      >      >      >      >       > levels(BEPS$vote)
>>>      >      >      >      >     [1] "Conservative"     "Labour"
>>>       "Liberal
>>>      >      >     Democrat"
>>>      >      >      >      >       > levels(BEPS$vote1)
>>>      >      >      >      >     [1] "Labour"           "Liberal Democrat"
>>>      >     "Conservative"
>>>      >      >      >      >
>>>      >      >      >      >       > m <- multinom(vote ~ . - vote1,
>>>     data=BEPS)
>>>      >      >      >      >     # weights:  33 (20 variable)
>>>      >      >      >      >     initial  value 1675.383740
>>>      >      >      >      >     iter  10 value 1345.935273
>>>      >      >      >      >     iter  20 value 1150.956807
>>>      >      >      >      >     iter  30 value 1141.921662
>>>      >      >      >      >     iter  30 value 1141.921661
>>>      >      >      >      >     iter  30 value 1141.921661
>>>      >      >      >      >     final  value 1141.921661
>>>      >      >      >      >     converged
>>>      >      >      >      >       > m1 <- multinom(vote1 ~ . - vote,
>>>     data=BEPS)
>>>      >      >      >      >     # weights:  33 (20 variable)
>>>      >      >      >      >     initial  value 1675.383740
>>>      >      >      >      >     iter  10 value 1280.439304
>>>      >      >      >      >     iter  20 value 1165.513772
>>>      >      >      >      >     final  value 1141.921662
>>>      >      >      >      >     converged
>>>      >      >      >      >
>>>      >      >      >      >       > rbind(coef(m), coef(m1)) # compare
>>>     coefficients
>>>      >      >      >      >                        (Intercept)
>> age
>>>      >      >      >     economic.cond.national
>>>      >      >      >      >     economic.cond.household
>>>      >      >      >      >     Labour             0.9515214 -0.021913989
>>>      >      >     0.5575707
>>>      >      >      >      >            0.15839096
>>>      >      >      >      >     Liberal Democrat   1.4119306 -0.016810735
>>>      >      >     0.1810761
>>>      >      >      >      >           -0.01196664
>>>      >      >      >      >     Liberal Democrat   0.4604567  0.005102666
>>>      >      >       -0.3764928
>>>      >      >      >      >           -0.17036682
>>>      >      >      >      >     Conservative      -0.9514466  0.021912305
>>>      >      >       -0.5575644
>>>      >      >      >      >           -0.15838744
>>>      >      >      >      >                             Blair       Hague
>>>      >     Kennedy
>>>      >      >          Europe
>>>      >      >      >      >     political.knowledge
>>>      >      >      >      >     Labour            0.8371764 -0.90775585
>>>     0.2513436
>>>      >      >     -0.22781308
>>>      >      >      >      >     -0.5370612
>>>      >      >      >      >     Liberal Democrat  0.2937331 -0.82217625
>>>     0.6710567
>>>      >      >     -0.20004624
>>>      >      >      >      >     -0.2034605
>>>      >      >      >      >     Liberal Democrat -0.5434408  0.08559455
>>>     0.4197027
>>>      >      >     0.02776465
>>>      >      >      >      >     0.3336068
>>>      >      >      >      >     Conservative     -0.8371670  0.90778068
>>>     -0.2513735
>>>      >      >     0.22781092
>>>      >      >      >      >     0.5370545
>>>      >      >      >      >                         gendermale
>>>      >      >      >      >     Labour            0.13765774
>>>      >      >      >      >     Liberal Democrat  0.12640823
>>>      >      >      >      >     Liberal Democrat -0.01125898
>>>      >      >      >      >     Conservative     -0.13764849
>>>      >      >      >      >
>>>      >      >      >      >       > c(logLik(m), logLik(m1)) # same fit
>>>     to the data
>>>      >      >      >      >     [1] -1141.922 -1141.922
>>>      >      >      >      >
>>>      >      >      >      >       > # covariance matrices for
>> coefficients:
>>>      >      >      >      >       > V <- vcov(m)
>>>      >      >      >      >       > V1 <- vcov(m1)
>>>      >      >      >      >       > cbind(colnames(V), colnames(V1)) #
>>>     compare
>>>      >      >      >      >             [,1]
>>>      >         [,2]
>>>      >      >      >      >
>>>      >      >      >      >        [1,] "Labour:(Intercept)"
>>>      >      >       "Liberal
>>>      >      >      >      >     Democrat:(Intercept)"
>>>      >      >      >      >        [2,] "Labour:age"
>>>      >      >       "Liberal
>>>      >      >      >      >     Democrat:age"
>>>      >      >      >      >
>>>      >      >      >      >        [3,] "Labour:economic.cond.national"
>>>      >      >     "Liberal
>>>      >      >      >      >     Democrat:economic.cond.national"
>>>      >      >      >      >        [4,] "Labour:economic.cond.household"
>>>      >      >       "Liberal
>>>      >      >      >      >     Democrat:economic.cond.household"
>>>      >      >      >      >        [5,] "Labour:Blair"
>>>      >      >       "Liberal
>>>      >      >      >      >     Democrat:Blair"
>>>      >      >      >      >        [6,] "Labour:Hague"
>>>      >      >       "Liberal
>>>      >      >      >      >     Democrat:Hague"
>>>      >      >      >      >        [7,] "Labour:Kennedy"
>>>      >      >       "Liberal
>>>      >      >      >      >     Democrat:Kennedy"
>>>      >      >      >      >        [8,] "Labour:Europe"
>>>      >      >     "Liberal
>>>      >      >      >      >     Democrat:Europe"
>>>      >      >      >      >        [9,] "Labour:political.knowledge"
>>>      >      >       "Liberal
>>>      >      >      >      >     Democrat:political.knowledge"
>>>      >      >      >      >     [10,] "Labour:gendermale"
>>>      >        "Liberal
>>>      >      >      >      >     Democrat:gendermale"
>>>      >      >      >      >     [11,] "Liberal Democrat:(Intercept)"
>>>      >      >      >      >     "Conservative:(Intercept)"
>>>      >      >      >      >     [12,] "Liberal Democrat:age"
>>>      >      >      >       "Conservative:age"
>>>      >      >      >      >
>>>      >      >      >      >     [13,] "Liberal
>>>     Democrat:economic.cond.national"
>>>      >      >      >      >     "Conservative:economic.cond.national"
>>>      >      >      >      >     [14,] "Liberal
>>>     Democrat:economic.cond.household"
>>>      >      >      >      >     "Conservative:economic.cond.household"
>>>      >      >      >      >     [15,] "Liberal Democrat:Blair"
>>>      >      >      >       "Conservative:Blair"
>>>      >      >      >      >
>>>      >      >      >      >     [16,] "Liberal Democrat:Hague"
>>>      >      >      >       "Conservative:Hague"
>>>      >      >      >      >
>>>      >      >      >      >     [17,] "Liberal Democrat:Kennedy"
>>>      >      >      >       "Conservative:Kennedy"
>>>      >      >      >      >
>>>      >      >      >      >     [18,] "Liberal Democrat:Europe"
>>>      >      >      >     "Conservative:Europe"
>>>      >      >      >      >
>>>      >      >      >      >     [19,] "Liberal
>> Democrat:political.knowledge"
>>>      >      >      >      >     "Conservative:political.knowledge"
>>>      >      >      >      >     [20,] "Liberal Democrat:gendermale"
>>>      >      >      >      >     "Conservative:gendermale"
>>>      >      >      >      >
>>>      >      >      >      >       > int <- c(1, 11) # remove intercepts
>>>      >      >      >      >       > colnames(V)[int]
>>>      >      >      >      >     [1] "Labour:(Intercept)"
>>  "Liberal
>>>      >      >     Democrat:(Intercept)"
>>>      >      >      >      >
>>>      >      >      >      >       > colnames(V1)[int]
>>>      >      >      >      >     [1] "Liberal Democrat:(Intercept)"
>>>      >      >     "Conservative:(Intercept)"
>>>      >      >      >      >       > V <- V[-int, -int]
>>>      >      >      >      >       > V1 <- V1[-int, -int]
>>>      >      >      >      >
>>>      >      >      >      >       > age <- c(1, 10) # locate age
>>>     coefficients
>>>      >      >      >      >       > colnames(V)[age]
>>>      >      >      >      >     [1] "Labour:age"           "Liberal
>>>     Democrat:age"
>>>      >      >      >      >       > colnames(V1)[age]
>>>      >      >      >      >     [1] "Liberal Democrat:age"
>>>     "Conservative:age"
>>>      >      >      >      >
>>>      >      >      >      >       > V <- cov2cor(V) # compute coefficient
>>>      >     correlations
>>>      >      >      >      >       > V1 <- cov2cor(V1)
>>>      >      >      >      >
>>>      >      >      >      >       > # compare GVIFs:
>>>      >      >      >      >       > c(det(V[age, age])*det(V[-age,
>>>     -age])/det(V),
>>>      >      >      >      >     +   det(V1[age, age])*det(V1[-age,
>>>     -age])/det(V1))
>>>      >      >      >      >     [1] 1.046232 1.046229
>>>      >      >      >      >
>>>      >      >      >      >     --------- snip -----------
>>>      >      >      >      >
>>>      >      >      >      >     For curiosity, I applied car::vif() and
>>>      >      >      >      >     performance::check_collinearity() to
>> these
>>>      >     models to
>>>      >      >     see what
>>>      >      >      >     they
>>>      >      >      >      >     would
>>>      >      >      >      >     do. Both returned the wrong answer. vif()
>>>      >     produced a
>>>      >      >     warning, but
>>>      >      >      >      >     check_collinearity() didn't:
>>>      >      >      >      >
>>>      >      >      >      >     --------- snip -----------
>>>      >      >      >      >
>>>      >      >      >      >       > car::vif(m1)
>>>      >      >      >      >                           age
>>>     economic.cond.national
>>>      >      >      >      >     economic.cond.household
>>>      >      >      >      >                     15.461045
>>>       22.137772
>>>      >      >      >      >       16.693877
>>>      >      >      >      >                         Blair
>>>         Hague
>>>      >      >      >      >       Kennedy
>>>      >      >      >      >                     14.681562
>>>     7.483039
>>>      >      >      >      >       15.812067
>>>      >      >      >      >                        Europe
>>>       political.knowledge
>>>      >      >      >      >     gender
>>>      >      >      >      >                      6.502119
>>>     4.219507
>>>      >      >      >      >     2.313885
>>>      >      >      >      >     Warning message:
>>>      >      >      >      >     In vif.default(m1) : No intercept: vifs
>>>     may not be
>>>      >      >     sensible.
>>>      >      >      >      >
>>>      >      >      >      >       > performance::check_collinearity(m)
>>>      >      >      >      >     # Check for Multicollinearity
>>>      >      >      >      >
>>>      >      >      >      >     Low Correlation
>>>      >      >      >      >
>>>      >      >      >      >                           Term  VIF
>> Increased SE
>>>      >     Tolerance
>>>      >      >      >      >                            age 1.72
>>>       1.31
>>>      >        0.58
>>>      >      >      >      >         economic.cond.national 1.85
>>>       1.36
>>>      >        0.54
>>>      >      >      >      >        economic.cond.household 1.86
>>>       1.37
>>>      >        0.54
>>>      >      >      >      >                          Blair 1.63
>>>       1.28
>>>      >        0.61
>>>      >      >      >      >                          Hague 1.94
>>>       1.39
>>>      >        0.52
>>>      >      >      >      >                        Kennedy 1.70
>>>       1.30
>>>      >        0.59
>>>      >      >      >      >                         Europe 2.01
>>>       1.42
>>>      >        0.50
>>>      >      >      >      >            political.knowledge 1.94
>>>       1.39
>>>      >        0.52
>>>      >      >      >      >                         gender 1.78
>>>       1.33
>>>      >        0.56
>>>      >      >      >      >       > performance::check_collinearity(m1)
>>>      >      >      >      >     # Check for Multicollinearity
>>>      >      >      >      >
>>>      >      >      >      >     Low Correlation
>>>      >      >      >      >
>>>      >      >      >      >                           Term  VIF
>> Increased SE
>>>      >     Tolerance
>>>      >      >      >      >                            age 1.19
>>>       1.09
>>>      >        0.84
>>>      >      >      >      >         economic.cond.national 1.42
>>>       1.19
>>>      >        0.70
>>>      >      >      >      >        economic.cond.household 1.32
>>>       1.15
>>>      >        0.76
>>>      >      >      >      >                          Blair 1.50
>>>       1.22
>>>      >        0.67
>>>      >      >      >      >                          Hague 1.30
>>>       1.14
>>>      >        0.77
>>>      >      >      >      >                        Kennedy 1.19
>>>       1.09
>>>      >        0.84
>>>      >      >      >      >                         Europe 1.34
>>>       1.16
>>>      >        0.75
>>>      >      >      >      >            political.knowledge 1.30
>>>       1.14
>>>      >        0.77
>>>      >      >      >      >                         gender 1.23
>>>       1.11
>>>      >        0.81
>>>      >      >      >      >
>>>      >      >      >      >     --------- snip -----------
>>>      >      >      >      >
>>>      >      >      >      >     I looked at the code for vif() and
>>>      >     check_collinearity() to
>>>      >      >      >     see where
>>>      >      >      >      >     they went wrong. Both failed to handle
>>>     the two
>>>      >      >     intercepts in
>>>      >      >      >     the model
>>>      >      >      >      >     correctly -- vif() thought there was no
>>>      >     intercept and
>>>      >      >      >      >     check_collinearity() just removed the
>> first
>>>      >     intercept
>>>      >      >     but not the
>>>      >      >      >      >     second.
>>>      >      >      >      >
>>>      >      >      >      >     In examining the code for
>>>     check_collinearity(), I
>>>      >      >     discovered a
>>>      >      >      >      >     couple of
>>>      >      >      >      >     additional disconcerting facts. First,
>>>     part of the
>>>      >      >     code seems
>>>      >      >      >     to be
>>>      >      >      >      >     copied from vif.default(). Second, as a
>>>      >     consequence,
>>>      >      >      >      >     check_collinearity() actually computes
>>>     GVIFs rather
>>>      >      >     than VIFs
>>>      >      >      >     (and
>>>      >      >      >      >     doesn't reference either the Fox and
>>>     Monette paper
>>>      >      >      >     introducing GVIFs or
>>>      >      >      >      >     the car package) but doesn't seem to
>>>     understand
>>>      >     that, and,
>>>      >      >      >     for example,
>>>      >      >      >      >     takes the squareroot of the GVIF
>>>     (reported in the
>>>      >      >     column marked
>>>      >      >      >      >     "Increased SE") rather than the 2p root
>>>     (when there
>>>      >      >     are p > 1
>>>      >      >      >      >     coefficients in a term).
>>>      >      >      >      >
>>>      >      >      >      >     Here's the relevant code from the two
>>>     functions
>>>      >     (where
>>>      >      >     . . .
>>>      >      >      >     denotes
>>>      >      >      >      >     elided lines) -- the default method for
>>>     vif() and
>>>      >      >      >      >     .check_collinearity(),
>>>      >      >      >      >     which is called by
>>>     check_collinearity.default():
>>>      >      >      >      >
>>>      >      >      >      >     --------- snip -----------
>>>      >      >      >      >
>>>      >      >      >      >       > car:::vif.default
>>>      >      >      >      >     function (mod, ...)
>>>      >      >      >      >     {
>>>      >      >      >      >           . . .
>>>      >      >      >      >           v <- vcov(mod)
>>>      >      >      >      >           assign <- attr(model.matrix(mod),
>>>     "assign")
>>>      >      >      >      >           if (names(coefficients(mod)[1]) ==
>>>      >     "(Intercept)") {
>>>      >      >      >      >               v <- v[-1, -1]
>>>      >      >      >      >               assign <- assign[-1]
>>>      >      >      >      >           }
>>>      >      >      >      >           else warning("No intercept: vifs
>>>     may not be
>>>      >      >     sensible.")
>>>      >      >      >      >           terms <- labels(terms(mod))
>>>      >      >      >      >           n.terms <- length(terms)
>>>      >      >      >      >           if (n.terms < 2)
>>>      >      >      >      >               stop("model contains fewer
>>>     than 2 terms")
>>>      >      >      >      >           R <- cov2cor(v)
>>>      >      >      >      >           detR <- det(R)
>>>      >      >      >      >           . . .
>>>      >      >      >      >           for (term in 1:n.terms) {
>>>      >      >      >      >               subs <- which(assign == term)
>>>      >      >      >      >               result[term, 1] <-
>>>     det(as.matrix(R[subs,
>>>      >      >     subs])) *
>>>      >      >      >      >     det(as.matrix(R[-subs,
>>>      >      >      >      >                   -subs]))/detR
>>>      >      >      >      >               result[term, 2] <- length(subs)
>>>      >      >      >      >           }
>>>      >      >      >      >           . . .
>>>      >      >      >      >     }
>>>      >      >      >      >
>>>      >      >      >      >       > performance:::.check_collinearity
>>>      >      >      >      >     function (x, component, verbose = TRUE)
>>>      >      >      >      >     {
>>>      >      >      >      >           v <- insight::get_varcov(x,
>>>     component =
>>>      >     component,
>>>      >      >      >     verbose =
>>>      >      >      >      >     FALSE)
>>>      >      >      >      >           assign <- .term_assignments(x,
>>>     component,
>>>      >     verbose =
>>>      >      >      >     verbose)
>>>      >      >      >      >           . . .
>>>      >      >      >      >           if (insight::has_intercept(x)) {
>>>      >      >      >      >               v <- v[-1, -1]
>>>      >      >      >      >               assign <- assign[-1]
>>>      >      >      >      >           }
>>>      >      >      >      >           else {
>>>      >      >      >      >               if (isTRUE(verbose)) {
>>>      >      >      >      >                   warning("Model has no
>>>     intercept. VIFs
>>>      >      >     may not be
>>>      >      >      >      >     sensible.",
>>>      >      >      >      >                       call. = FALSE)
>>>      >      >      >      >               }
>>>      >      >      >      >           }
>>>      >      >      >      >               . . .
>>>      >      >      >      >               terms <-
>>>      >     labels(stats::terms(f[[component]]))
>>>      >      >      >      >               . . .
>>>      >      >      >      >           n.terms <- length(terms)
>>>      >      >      >      >           if (n.terms < 2) {
>>>      >      >      >      >               if (isTRUE(verbose)) {
>>>      >      >      >      >
>>>      >       warning(insight::format_message(sprintf("Not
>>>      >      >      >     enough model
>>>      >      >      >      >     terms in the %s part of the model to
>>>     check for
>>>      >      >      >     multicollinearity.",
>>>      >      >      >      >                       component)), call. =
>>>     FALSE)
>>>      >      >      >      >               }
>>>      >      >      >      >               return(NULL)
>>>      >      >      >      >           }
>>>      >      >      >      >           R <- stats::cov2cor(v)
>>>      >      >      >      >           detR <- det(R)
>>>      >      >      >      >           . . .
>>>      >      >      >      >           for (term in 1:n.terms) {
>>>      >      >      >      >               subs <- which(assign == term)
>>>      >      >      >      >                   . . .
>>>      >      >      >      >                   result <- c(result,
>>>      >      >     det(as.matrix(R[subs, subs])) *
>>>      >      >      >      >                       det(as.matrix(R[-subs,
>>>      >     -subs]))/detR)
>>>      >      >      >      >                   . . .
>>>      >      >      >      >           }
>>>      >      >      >      >           . . .
>>>      >      >      >      >     }
>>>      >      >      >      >
>>>      >      >      >      >     --------- snip -----------
>>>      >      >      >      >
>>>      >      >      >      >     So, the upshot of all this is that you
>>>     should
>>>      >     be able
>>>      >      >     to do
>>>      >      >      >     what you
>>>      >      >      >      >     want, but not with either car::vif() or
>>>      >      >      >      >     performance::check_collinearity().
>>>     Instead, either
>>>      >      >     write your own
>>>      >      >      >      >     function or do the computations in a
>> script.
>>>      >      >      >      >
>>>      >      >      >      >     There's also a lesson here about S3
>> default
>>>      >     methods:
>>>      >      >     The fact
>>>      >      >      >     that a
>>>      >      >      >      >     default method returns a result rather
>> than
>>>      >     throwing
>>>      >      >     an error
>>>      >      >      >     or a
>>>      >      >      >      >     warning doesn't mean that the result is
>> the
>>>      >     right answer.
>>>      >      >      >      >
>>>      >      >      >      >     I hope this helps,
>>>      >      >      >      >        John
>>>      >      >      >      >
>>>      >      >      >      >
>>>      >      >      >      >     On 2022-02-26 3:45 p.m., Juho Kristian
>>>     Ruohonen
>>>      >     wrote:
>>>      >      >      >      >      > Dear John W,
>>>      >      >      >      >      >
>>>      >      >      >      >      > Thank you very much for the tip-off!
>>>      >     Apologies for not
>>>      >      >      >     responding
>>>      >      >      >      >     earlier
>>>      >      >      >      >      > (gmail apparently decided to direct
>>>     your email
>>>      >      >     right into the
>>>      >      >      >      >     junk folder).
>>>      >      >      >      >      > I am very pleased to note that the
>>>     package you
>>>      >      >     mention does
>>>      >      >      >      >     indeed work
>>>      >      >      >      >      > with *brms* multinomial models!
>>>     Thanks again!
>>>      >      >      >      >      >
>>>      >      >      >      >      > Best,
>>>      >      >      >      >      >
>>>      >      >      >      >      > Juho
>>>      >      >      >      >      >
>>>      >      >      >      >      > pe 25. helmik. 2022 klo 19.23 John
>>>     Willoughby
>>>      >      >      >      >     (johnwillec at gmail.com
>>>     <mailto:johnwillec at gmail.com>
>>>      >     <mailto:johnwillec at gmail.com <mailto:johnwillec at gmail.com>>
>>>     <mailto:johnwillec at gmail.com <mailto:johnwillec at gmail.com>
>>>      >     <mailto:johnwillec at gmail.com <mailto:johnwillec at gmail.com>>>
>>>      >      >     <mailto:johnwillec at gmail.com
>>>     <mailto:johnwillec at gmail.com> <mailto:johnwillec at gmail.com
>>>     <mailto:johnwillec at gmail.com>>
>>>      >     <mailto:johnwillec at gmail.com <mailto:johnwillec at gmail.com>
>>>     <mailto:johnwillec at gmail.com <mailto:johnwillec at gmail.com>>>>
>>>      >      >      >     <mailto:johnwillec at gmail.com
>>>     <mailto:johnwillec at gmail.com>
>>>      >     <mailto:johnwillec at gmail.com <mailto:johnwillec at gmail.com>>
>>>     <mailto:johnwillec at gmail.com <mailto:johnwillec at gmail.com>
>>>      >     <mailto:johnwillec at gmail.com <mailto:johnwillec at gmail.com>>>
>>>      >      >     <mailto:johnwillec at gmail.com
>>>     <mailto:johnwillec at gmail.com> <mailto:johnwillec at gmail.com
>>>     <mailto:johnwillec at gmail.com>>
>>>      >     <mailto:johnwillec at gmail.com <mailto:johnwillec at gmail.com>
>>>     <mailto:johnwillec at gmail.com <mailto:johnwillec at gmail.com>>>>>)
>>>      >      >      >      >      > kirjoitti:
>>>      >      >      >      >      >
>>>      >      >      >      >      >> Have you tried the
>> check_collinearity()
>>>      >     function
>>>      >      >     in the
>>>      >      >      >     performance
>>>      >      >      >      >      >> package? It's supposed to work on
>> brms
>>>      >     models, but
>>>      >      >     whether it
>>>      >      >      >      >     will work on
>>>      >      >      >      >      >> a multinomial model I don't know.
>>>     It works
>>>      >     well
>>>      >      >     on mixed
>>>      >      >      >     models
>>>      >      >      >      >     generated
>>>      >      >      >      >      >> by glmmTMB().
>>>      >      >      >      >      >>
>>>      >      >      >      >      >> John Willoughby
>>>      >      >      >      >      >>
>>>      >      >      >      >      >>
>>>      >      >      >      >      >> On Fri, Feb 25, 2022 at 3:01 AM
>>>      >      >      >      >
>>>       <r-sig-mixed-models-request at r-project.org
>>>     <mailto:r-sig-mixed-models-request at r-project.org>
>>>      >     <mailto:r-sig-mixed-models-request at r-project.org
>>>     <mailto:r-sig-mixed-models-request at r-project.org>>
>>>      >      >     <mailto:r-sig-mixed-models-request at r-project.org
>>>     <mailto:r-sig-mixed-models-request at r-project.org>
>>>      >     <mailto:r-sig-mixed-models-request at r-project.org
>>>     <mailto:r-sig-mixed-models-request at r-project.org>>>
>>>      >      >      >
>>>       <mailto:r-sig-mixed-models-request at r-project.org
>>>     <mailto:r-sig-mixed-models-request at r-project.org>
>>>      >     <mailto:r-sig-mixed-models-request at r-project.org
>>>     <mailto:r-sig-mixed-models-request at r-project.org>>
>>>      >      >     <mailto:r-sig-mixed-models-request at r-project.org
>>>     <mailto:r-sig-mixed-models-request at r-project.org>
>>>      >     <mailto:r-sig-mixed-models-request at r-project.org
>>>     <mailto:r-sig-mixed-models-request at r-project.org>>>>
>>>      >      >      >      >
>>>      >       <mailto:r-sig-mixed-models-request at r-project.org
>>>     <mailto:r-sig-mixed-models-request at r-project.org>
>>>      >     <mailto:r-sig-mixed-models-request at r-project.org
>>>     <mailto:r-sig-mixed-models-request at r-project.org>>
>>>      >      >     <mailto:r-sig-mixed-models-request at r-project.org
>>>     <mailto:r-sig-mixed-models-request at r-project.org>
>>>      >     <mailto:r-sig-mixed-models-request at r-project.org
>>>     <mailto:r-sig-mixed-models-request at r-project.org>>>
>>>      >      >      >
>>>       <mailto:r-sig-mixed-models-request at r-project.org
>>>     <mailto:r-sig-mixed-models-request at r-project.org>
>>>      >     <mailto:r-sig-mixed-models-request at r-project.org
>>>     <mailto:r-sig-mixed-models-request at r-project.org>>
>>>      >      >     <mailto:r-sig-mixed-models-request at r-project.org
>>>     <mailto:r-sig-mixed-models-request at r-project.org>
>>>      >     <mailto:r-sig-mixed-models-request at r-project.org
>>>     <mailto:r-sig-mixed-models-request at r-project.org>>>>>>
>>>      >      >      >      >      >> wrote:
>>>      >      >      >      >      >>
>>>      >      >      >      >      >>> Send R-sig-mixed-models mailing list
>>>      >     submissions to
>>>      >      >      >      >      >>> r-sig-mixed-models at r-project.org
>>>     <mailto:r-sig-mixed-models at r-project.org>
>>>      >     <mailto:r-sig-mixed-models at r-project.org
>>>     <mailto:r-sig-mixed-models at r-project.org>>
>>>      >      >     <mailto:r-sig-mixed-models at r-project.org
>>>     <mailto:r-sig-mixed-models at r-project.org>
>>>      >     <mailto:r-sig-mixed-models at r-project.org
>>>     <mailto:r-sig-mixed-models at r-project.org>>>
>>>      >      >      >     <mailto:r-sig-mixed-models at r-project.org
>>>     <mailto:r-sig-mixed-models at r-project.org>
>>>      >     <mailto:r-sig-mixed-models at r-project.org
>>>     <mailto:r-sig-mixed-models at r-project.org>>
>>>      >      >     <mailto:r-sig-mixed-models at r-project.org
>>>     <mailto:r-sig-mixed-models at r-project.org>
>>>      >     <mailto:r-sig-mixed-models at r-project.org
>>>     <mailto:r-sig-mixed-models at r-project.org>>>>
>>>      >      >      >      >     <mailto:r-sig-mixed-models at r-project.org
>>>     <mailto:r-sig-mixed-models at r-project.org>
>>>      >     <mailto:r-sig-mixed-models at r-project.org
>>>     <mailto:r-sig-mixed-models at r-project.org>>
>>>      >      >     <mailto:r-sig-mixed-models at r-project.org
>>>     <mailto:r-sig-mixed-models at r-project.org>
>>>      >     <mailto:r-sig-mixed-models at r-project.org
>>>     <mailto:r-sig-mixed-models at r-project.org>>>
>>>      >      >      >     <mailto:r-sig-mixed-models at r-project.org
>>>     <mailto:r-sig-mixed-models at r-project.org>
>>>      >     <mailto:r-sig-mixed-models at r-project.org
>>>     <mailto:r-sig-mixed-models at r-project.org>>
>>>      >      >     <mailto:r-sig-mixed-models at r-project.org
>>>     <mailto:r-sig-mixed-models at r-project.org>
>>>      >     <mailto:r-sig-mixed-models at r-project.org
>>>     <mailto:r-sig-mixed-models at r-project.org>>>>>
>>>      >      >      >      >      >>>
>>>      >      >      >      >      >>> To subscribe or unsubscribe via the
>>>     World Wide
>>>      >      >     Web, visit
>>>      >      >      >      >      >>>
>>>      >      > https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>>>      >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>
>>>      >      >
>>>       <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>>>      >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>>
>>>      >      >      >
>>>      >       <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>>>      >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>
>>>      >      >
>>>       <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>>>      >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>>>
>>>      >      >      >      >
>>>      >      >
>>>       <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>>>      >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>
>>>      >      >
>>>       <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>>>      >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>>
>>>      >      >      >
>>>      >       <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>>>      >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>
>>>      >      >
>>>       <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>>>      >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>>>>
>>>      >      >      >      >      >>> or, via email, send a message with
>>>     subject or
>>>      >      >     body 'help' to
>>>      >      >      >      >      >>>
>>>     r-sig-mixed-models-request at r-project.org
>>>     <mailto:r-sig-mixed-models-request at r-project.org>
>>>      >     <mailto:r-sig-mixed-models-request at r-project.org
>>>     <mailto:r-sig-mixed-models-request at r-project.org>>
>>>      >      >     <mailto:r-sig-mixed-models-request at r-project.org
>>>     <mailto:r-sig-mixed-models-request at r-project.org>
>>>      >     <mailto:r-sig-mixed-models-request at r-project.org
>>>     <mailto:r-sig-mixed-models-request at r-project.org>>>
>>>      >      >      >
>>>       <mailto:r-sig-mixed-models-request at r-project.org
>>>     <mailto:r-sig-mixed-models-request at r-project.org>
>>>      >     <mailto:r-sig-mixed-models-request at r-project.org
>>>     <mailto:r-sig-mixed-models-request at r-project.org>>
>>>      >      >     <mailto:r-sig-mixed-models-request at r-project.org
>>>     <mailto:r-sig-mixed-models-request at r-project.org>
>>>      >     <mailto:r-sig-mixed-models-request at r-project.org
>>>     <mailto:r-sig-mixed-models-request at r-project.org>>>>
>>>      >      >      >      >
>>>      >       <mailto:r-sig-mixed-models-request at r-project.org
>>>     <mailto:r-sig-mixed-models-request at r-project.org>
>>>      >     <mailto:r-sig-mixed-models-request at r-project.org
>>>     <mailto:r-sig-mixed-models-request at r-project.org>>
>>>      >      >     <mailto:r-sig-mixed-models-request at r-project.org
>>>     <mailto:r-sig-mixed-models-request at r-project.org>
>>>      >     <mailto:r-sig-mixed-models-request at r-project.org
>>>     <mailto:r-sig-mixed-models-request at r-project.org>>>
>>>      >      >      >
>>>       <mailto:r-sig-mixed-models-request at r-project.org
>>>     <mailto:r-sig-mixed-models-request at r-project.org>
>>>      >     <mailto:r-sig-mixed-models-request at r-project.org
>>>     <mailto:r-sig-mixed-models-request at r-project.org>>
>>>      >      >     <mailto:r-sig-mixed-models-request at r-project.org
>>>     <mailto:r-sig-mixed-models-request at r-project.org>
>>>      >     <mailto:r-sig-mixed-models-request at r-project.org
>>>     <mailto:r-sig-mixed-models-request at r-project.org>>>>>
>>>      >      >      >      >      >>>
>>>      >      >      >      >      >>> You can reach the person managing
>>>     the list at
>>>      >      >      >      >      >>>
>>>     r-sig-mixed-models-owner at r-project.org
>>>     <mailto:r-sig-mixed-models-owner at r-project.org>
>>>      >     <mailto:r-sig-mixed-models-owner at r-project.org
>>>     <mailto:r-sig-mixed-models-owner at r-project.org>>
>>>      >      >     <mailto:r-sig-mixed-models-owner at r-project.org
>>>     <mailto:r-sig-mixed-models-owner at r-project.org>
>>>      >     <mailto:r-sig-mixed-models-owner at r-project.org
>>>     <mailto:r-sig-mixed-models-owner at r-project.org>>>
>>>      >      >      >     <mailto:r-sig-mixed-models-owner at r-project.org
>>>     <mailto:r-sig-mixed-models-owner at r-project.org>
>>>      >     <mailto:r-sig-mixed-models-owner at r-project.org
>>>     <mailto:r-sig-mixed-models-owner at r-project.org>>
>>>      >      >     <mailto:r-sig-mixed-models-owner at r-project.org
>>>     <mailto:r-sig-mixed-models-owner at r-project.org>
>>>      >     <mailto:r-sig-mixed-models-owner at r-project.org
>>>     <mailto:r-sig-mixed-models-owner at r-project.org>>>>
>>>      >      >      >      >
>>>       <mailto:r-sig-mixed-models-owner at r-project.org
>>>     <mailto:r-sig-mixed-models-owner at r-project.org>
>>>      >     <mailto:r-sig-mixed-models-owner at r-project.org
>>>     <mailto:r-sig-mixed-models-owner at r-project.org>>
>>>      >      >     <mailto:r-sig-mixed-models-owner at r-project.org
>>>     <mailto:r-sig-mixed-models-owner at r-project.org>
>>>      >     <mailto:r-sig-mixed-models-owner at r-project.org
>>>     <mailto:r-sig-mixed-models-owner at r-project.org>>>
>>>      >      >      >     <mailto:r-sig-mixed-models-owner at r-project.org
>>>     <mailto:r-sig-mixed-models-owner at r-project.org>
>>>      >     <mailto:r-sig-mixed-models-owner at r-project.org
>>>     <mailto:r-sig-mixed-models-owner at r-project.org>>
>>>      >      >     <mailto:r-sig-mixed-models-owner at r-project.org
>>>     <mailto:r-sig-mixed-models-owner at r-project.org>
>>>      >     <mailto:r-sig-mixed-models-owner at r-project.org
>>>     <mailto:r-sig-mixed-models-owner at r-project.org>>>>>
>>>      >      >      >      >      >>>
>>>      >      >      >      >      >>> When replying, please edit your
>> Subject
>>>      >     line so it is
>>>      >      >      >     more specific
>>>      >      >      >      >      >>> than "Re: Contents of
>>>     R-sig-mixed-models
>>>      >     digest..."
>>>      >      >      >      >      >>>
>>>      >      >      >      >      >>>
>>>      >      >      >      >      >>> Today's Topics:
>>>      >      >      >      >      >>>
>>>      >      >      >      >      >>>     1. Collinearity diagnostics for
>>>     (mixed)
>>>      >      >     multinomial
>>>      >      >      >     models
>>>      >      >      >      >      >>>        (Juho Kristian Ruohonen)
>>>      >      >      >      >      >>>
>>>      >      >      >      >      >>>
>>>      >      >      >      >
>>>      >      >      >
>>>      >      >
>>>      >
>>>
>>  ----------------------------------------------------------------------
>>>      >      >      >      >      >>>
>>>      >      >      >      >      >>> Message: 1
>>>      >      >      >      >      >>> Date: Fri, 25 Feb 2022 10:23:25
>> +0200
>>>      >      >      >      >      >>> From: Juho Kristian Ruohonen
>>>      >      >      >     <juho.kristian.ruohonen at gmail.com
>>>     <mailto:juho.kristian.ruohonen at gmail.com>
>>>      >     <mailto:juho.kristian.ruohonen at gmail.com
>>>     <mailto:juho.kristian.ruohonen at gmail.com>>
>>>      >      >     <mailto:juho.kristian.ruohonen at gmail.com
>>>     <mailto:juho.kristian.ruohonen at gmail.com>
>>>      >     <mailto:juho.kristian.ruohonen at gmail.com
>>>     <mailto:juho.kristian.ruohonen at gmail.com>>>
>>>      >      >      >     <mailto:juho.kristian.ruohonen at gmail.com
>>>     <mailto:juho.kristian.ruohonen at gmail.com>
>>>      >     <mailto:juho.kristian.ruohonen at gmail.com
>>>     <mailto:juho.kristian.ruohonen at gmail.com>>
>>>      >      >     <mailto:juho.kristian.ruohonen at gmail.com
>>>     <mailto:juho.kristian.ruohonen at gmail.com>
>>>      >     <mailto:juho.kristian.ruohonen at gmail.com
>>>     <mailto:juho.kristian.ruohonen at gmail.com>>>>
>>>      >      >      >      >     <mailto:juho.kristian.ruohonen at gmail.com
>>>     <mailto:juho.kristian.ruohonen at gmail.com>
>>>      >     <mailto:juho.kristian.ruohonen at gmail.com
>>>     <mailto:juho.kristian.ruohonen at gmail.com>>
>>>      >      >     <mailto:juho.kristian.ruohonen at gmail.com
>>>     <mailto:juho.kristian.ruohonen at gmail.com>
>>>      >     <mailto:juho.kristian.ruohonen at gmail.com
>>>     <mailto:juho.kristian.ruohonen at gmail.com>>>
>>>      >      >      >     <mailto:juho.kristian.ruohonen at gmail.com
>>>     <mailto:juho.kristian.ruohonen at gmail.com>
>>>      >     <mailto:juho.kristian.ruohonen at gmail.com
>>>     <mailto:juho.kristian.ruohonen at gmail.com>>
>>>      >      >     <mailto:juho.kristian.ruohonen at gmail.com
>>>     <mailto:juho.kristian.ruohonen at gmail.com>
>>>      >     <mailto:juho.kristian.ruohonen at gmail.com
>>>     <mailto:juho.kristian.ruohonen at gmail.com>>>>>>
>>>      >      >      >      >      >>> To: John Fox <jfox at mcmaster.ca
>>>     <mailto:jfox at mcmaster.ca>
>>>      >     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>
>>>      >      >     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
>>>     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>>
>>>      >     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
>>>     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>
>>>      >      >     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
>>>     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>>>
>>>      >      >      >     <mailto:jfox at mcmaster.ca
>>>     <mailto:jfox at mcmaster.ca> <mailto:jfox at mcmaster.ca
>>>     <mailto:jfox at mcmaster.ca>>
>>>      >     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
>>>     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>>
>>>      >      >     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
>>>     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>
>>>      >     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
>>>     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>>>>>
>>>      >      >      >      >      >>> Cc:
>>>     "r-sig-mixed-models at r-project.org
>>>     <mailto:r-sig-mixed-models at r-project.org>
>>>      >     <mailto:r-sig-mixed-models at r-project.org
>>>     <mailto:r-sig-mixed-models at r-project.org>>
>>>      >      >     <mailto:r-sig-mixed-models at r-project.org
>>>     <mailto:r-sig-mixed-models at r-project.org>
>>>      >     <mailto:r-sig-mixed-models at r-project.org
>>>     <mailto:r-sig-mixed-models at r-project.org>>>
>>>      >      >      >     <mailto:r-sig-mixed-models at r-project.org
>>>     <mailto:r-sig-mixed-models at r-project.org>
>>>      >     <mailto:r-sig-mixed-models at r-project.org
>>>     <mailto:r-sig-mixed-models at r-project.org>>
>>>      >      >     <mailto:r-sig-mixed-models at r-project.org
>>>     <mailto:r-sig-mixed-models at r-project.org>
>>>      >     <mailto:r-sig-mixed-models at r-project.org
>>>     <mailto:r-sig-mixed-models at r-project.org>>>>
>>>      >      >      >      >     <mailto:r-sig-mixed-models at r-project.org
>>>     <mailto:r-sig-mixed-models at r-project.org>
>>>      >     <mailto:r-sig-mixed-models at r-project.org
>>>     <mailto:r-sig-mixed-models at r-project.org>>
>>>      >      >     <mailto:r-sig-mixed-models at r-project.org
>>>     <mailto:r-sig-mixed-models at r-project.org>
>>>      >     <mailto:r-sig-mixed-models at r-project.org
>>>     <mailto:r-sig-mixed-models at r-project.org>>>
>>>      >      >      >     <mailto:r-sig-mixed-models at r-project.org
>>>     <mailto:r-sig-mixed-models at r-project.org>
>>>      >     <mailto:r-sig-mixed-models at r-project.org
>>>     <mailto:r-sig-mixed-models at r-project.org>>
>>>      >      >     <mailto:r-sig-mixed-models at r-project.org
>>>     <mailto:r-sig-mixed-models at r-project.org>
>>>      >     <mailto:r-sig-mixed-models at r-project.org
>>>     <mailto:r-sig-mixed-models at r-project.org>>>>>"
>>>      >      >      >      >      >>>
>>>     <r-sig-mixed-models at r-project.org
>>>     <mailto:r-sig-mixed-models at r-project.org>
>>>      >     <mailto:r-sig-mixed-models at r-project.org
>>>     <mailto:r-sig-mixed-models at r-project.org>>
>>>      >      >     <mailto:r-sig-mixed-models at r-project.org
>>>     <mailto:r-sig-mixed-models at r-project.org>
>>>      >     <mailto:r-sig-mixed-models at r-project.org
>>>     <mailto:r-sig-mixed-models at r-project.org>>>
>>>      >      >      >     <mailto:r-sig-mixed-models at r-project.org
>>>     <mailto:r-sig-mixed-models at r-project.org>
>>>      >     <mailto:r-sig-mixed-models at r-project.org
>>>     <mailto:r-sig-mixed-models at r-project.org>>
>>>      >      >     <mailto:r-sig-mixed-models at r-project.org
>>>     <mailto:r-sig-mixed-models at r-project.org>
>>>      >     <mailto:r-sig-mixed-models at r-project.org
>>>     <mailto:r-sig-mixed-models at r-project.org>>>>
>>>      >      >      >      >     <mailto:r-sig-mixed-models at r-project.org
>>>     <mailto:r-sig-mixed-models at r-project.org>
>>>      >     <mailto:r-sig-mixed-models at r-project.org
>>>     <mailto:r-sig-mixed-models at r-project.org>>
>>>      >      >     <mailto:r-sig-mixed-models at r-project.org
>>>     <mailto:r-sig-mixed-models at r-project.org>
>>>      >     <mailto:r-sig-mixed-models at r-project.org
>>>     <mailto:r-sig-mixed-models at r-project.org>>>
>>>      >      >      >     <mailto:r-sig-mixed-models at r-project.org
>>>     <mailto:r-sig-mixed-models at r-project.org>
>>>      >     <mailto:r-sig-mixed-models at r-project.org
>>>     <mailto:r-sig-mixed-models at r-project.org>>
>>>      >      >     <mailto:r-sig-mixed-models at r-project.org
>>>     <mailto:r-sig-mixed-models at r-project.org>
>>>      >     <mailto:r-sig-mixed-models at r-project.org
>>>     <mailto:r-sig-mixed-models at r-project.org>>>>>>
>>>      >      >      >      >      >>> Subject: [R-sig-ME] Collinearity
>>>      >     diagnostics for
>>>      >      >     (mixed)
>>>      >      >      >      >     multinomial
>>>      >      >      >      >      >>>          models
>>>      >      >      >      >      >>> Message-ID:
>>>      >      >      >      >      >>>          <
>>>      >      >      >      >      >>>
>>>      >      >      >      >
>>>      >      >      >
>>>      >      >
>>>      >
>>>     CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com
>>>     <mailto:
>> CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com>
>>>      >
>>>       <mailto:
>> CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com
>> <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com
>>>>
>>>      >      >
>>>      >
>>>       <mailto:
>> CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com
>> <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com>
>> <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com
>> <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com
>>>>>
>>>      >      >      >
>>>      >      >
>>>      >
>>>       <mailto:
>> CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com
>> <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com>
>> <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com
>> <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com>>
>> <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com
>> <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com>
>> <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com
>> <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com
>>>>>>
>>>      >      >      >      >
>>>      >      >      >
>>>      >      >
>>>      >
>>>       <mailto:
>> CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com
>> <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com>
>> <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com
>> <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com>>
>> <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com
>> <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com>
>> <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com
>> <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com>>>
>> <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com
>> <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com>
>> <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com
>> <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com>>
>> <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com
>> <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com>
>> <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com
>> <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com
>>>>>>>>
>>>      >      >      >      >      >>> Content-Type: text/plain;
>>>     charset="utf-8"
>>>      >      >      >      >      >>>
>>>      >      >      >      >      >>> Dear John (and anyone else
>> qualified to
>>>      >     comment),
>>>      >      >      >      >      >>>
>>>      >      >      >      >      >>> I fit lots of mixed-effects
>> multinomial
>>>      >     models in my
>>>      >      >      >     research,
>>>      >      >      >      >     and I
>>>      >      >      >      >      >> would
>>>      >      >      >      >      >>> like to see some (multi)collinearity
>>>      >     diagnostics
>>>      >      >     on the
>>>      >      >      >     fixed
>>>      >      >      >      >     effects, of
>>>      >      >      >      >      >>> which there are over 30. My models
>>>     are fit
>>>      >     using the
>>>      >      >      >     Bayesian
>>>      >      >      >      >     *brms*
>>>      >      >      >      >      >>> package because I know of no
>>>     frequentist
>>>      >     packages
>>>      >      >     with
>>>      >      >      >      >     multinomial GLMM
>>>      >      >      >      >      >>> compatibility.
>>>      >      >      >      >      >>>
>>>      >      >      >      >      >>> With continuous or dichotomous
>>>     outcomes,
>>>      >     my go-to
>>>      >      >      >     function for
>>>      >      >      >      >      >> calculating
>>>      >      >      >      >      >>> multicollinearity diagnostics is of
>>>     course
>>>      >      >     *vif()* from
>>>      >      >      >     the *car*
>>>      >      >      >      >      >> package.
>>>      >      >      >      >      >>> As expected, however, this function
>>>     does not
>>>      >      >     report sensible
>>>      >      >      >      >     diagnostics
>>>      >      >      >      >      >>> for multinomial models -- not even
>> for
>>>      >     standard
>>>      >      >     ones fit
>>>      >      >      >     by the
>>>      >      >      >      >     *nnet*
>>>      >      >      >      >      >>> package's *multinom()* function.
>>>     The reason, I
>>>      >      >     presume, is
>>>      >      >      >      >     because a
>>>      >      >      >      >      >>> multinomial model is not really one
>>>     but C-1
>>>      >      >     regression
>>>      >      >      >     models
>>>      >      >      >      >     (where C
>>>      >      >      >      >      >> is
>>>      >      >      >      >      >>> the number of response categories)
>>>     and the
>>>      >     *vif()*
>>>      >      >      >     function is not
>>>      >      >      >      >      >> designed
>>>      >      >      >      >      >>> to deal with this scenario.
>>>      >      >      >      >      >>>
>>>      >      >      >      >      >>> Therefore, in order to obtain
>>>     meaningful
>>>      >     collinearity
>>>      >      >      >     metrics,
>>>      >      >      >      >     my present
>>>      >      >      >      >      >>> plan is to write a simple helper
>>>     function
>>>      >     that uses
>>>      >      >      >     *vif() *to
>>>      >      >      >      >     calculate
>>>      >      >      >      >      >>> and present (generalized) variance
>>>     inflation
>>>      >      >     metrics for
>>>      >      >      >     the C-1
>>>      >      >      >      >      >>> sub-datasets to which the C-1
>> component
>>>      >     binomial
>>>      >      >     models
>>>      >      >      >     of the
>>>      >      >      >      >     overall
>>>      >      >      >      >      >>> multinomial model are fit. In other
>>>     words, it
>>>      >      >     will partition
>>>      >      >      >      >     the data
>>>      >      >      >      >      >> into
>>>      >      >      >      >      >>> those C-1 subsets, and then apply
>>>     *vif()*
>>>      >     to as
>>>      >      >     many linear
>>>      >      >      >      >     regressions
>>>      >      >      >      >      >>> using a made-up continuous response
>> and
>>>      >     the fixed
>>>      >      >     effects of
>>>      >      >      >      >     interest.
>>>      >      >      >      >      >>>
>>>      >      >      >      >      >>> Does this seem like a sensible
>>>     approach?
>>>      >      >      >      >      >>>
>>>      >      >      >      >      >>> Best,
>>>      >      >      >      >      >>>
>>>      >      >      >      >      >>> Juho
>>>      >      >      >      >      >>>
>>>      >      >      >      >      >>>
>>>      >      >      >      >      >>>
>>>      >      >      >      >      >>
>>>      >      >      >      >      >>          [[alternative HTML version
>>>     deleted]]
>>>      >      >      >      >      >>
>>>      >      >      >      >      >>
>>>     _______________________________________________
>>>      >      >      >      >      >> R-sig-mixed-models at r-project.org
>>>     <mailto:R-sig-mixed-models at r-project.org>
>>>      >     <mailto:R-sig-mixed-models at r-project.org
>>>     <mailto:R-sig-mixed-models at r-project.org>>
>>>      >      >     <mailto:R-sig-mixed-models at r-project.org
>>>     <mailto:R-sig-mixed-models at r-project.org>
>>>      >     <mailto:R-sig-mixed-models at r-project.org
>>>     <mailto:R-sig-mixed-models at r-project.org>>>
>>>      >      >      >     <mailto:R-sig-mixed-models at r-project.org
>>>     <mailto:R-sig-mixed-models at r-project.org>
>>>      >     <mailto:R-sig-mixed-models at r-project.org
>>>     <mailto:R-sig-mixed-models at r-project.org>>
>>>      >      >     <mailto:R-sig-mixed-models at r-project.org
>>>     <mailto:R-sig-mixed-models at r-project.org>
>>>      >     <mailto:R-sig-mixed-models at r-project.org
>>>     <mailto:R-sig-mixed-models at r-project.org>>>>
>>>      >      >      >      >     <mailto:R-sig-mixed-models at r-project.org
>>>     <mailto:R-sig-mixed-models at r-project.org>
>>>      >     <mailto:R-sig-mixed-models at r-project.org
>>>     <mailto:R-sig-mixed-models at r-project.org>>
>>>      >      >     <mailto:R-sig-mixed-models at r-project.org
>>>     <mailto:R-sig-mixed-models at r-project.org>
>>>      >     <mailto:R-sig-mixed-models at r-project.org
>>>     <mailto:R-sig-mixed-models at r-project.org>>>
>>>      >      >      >     <mailto:R-sig-mixed-models at r-project.org
>>>     <mailto:R-sig-mixed-models at r-project.org>
>>>      >     <mailto:R-sig-mixed-models at r-project.org
>>>     <mailto:R-sig-mixed-models at r-project.org>>
>>>      >      >     <mailto:R-sig-mixed-models at r-project.org
>>>     <mailto:R-sig-mixed-models at r-project.org>
>>>      >     <mailto:R-sig-mixed-models at r-project.org
>>>     <mailto:R-sig-mixed-models at r-project.org>>>>> mailing list
>>>      >      >      >      >      >>
>>>      >      > https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>>>      >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>
>>>      >      >
>>>       <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>>>      >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>>
>>>      >      >      >
>>>      >       <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>>>      >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>
>>>      >      >
>>>       <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>>>      >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>>>
>>>      >      >      >      >
>>>      >      >
>>>       <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>>>      >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>
>>>      >      >
>>>       <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>>>      >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>>
>>>      >      >      >
>>>      >       <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>>>      >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>
>>>      >      >
>>>       <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>>>      >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>>>>
>>>      >      >      >      >      >>
>>>      >      >      >      >      >
>>>      >      >      >      >      >       [[alternative HTML version
>>>     deleted]]
>>>      >      >      >      >      >
>>>      >      >      >      >      >
>>>     _______________________________________________
>>>      >      >      >      >      > R-sig-mixed-models at r-project.org
>>>     <mailto:R-sig-mixed-models at r-project.org>
>>>      >     <mailto:R-sig-mixed-models at r-project.org
>>>     <mailto:R-sig-mixed-models at r-project.org>>
>>>      >      >     <mailto:R-sig-mixed-models at r-project.org
>>>     <mailto:R-sig-mixed-models at r-project.org>
>>>      >     <mailto:R-sig-mixed-models at r-project.org
>>>     <mailto:R-sig-mixed-models at r-project.org>>>
>>>      >      >      >     <mailto:R-sig-mixed-models at r-project.org
>>>     <mailto:R-sig-mixed-models at r-project.org>
>>>      >     <mailto:R-sig-mixed-models at r-project.org
>>>     <mailto:R-sig-mixed-models at r-project.org>>
>>>      >      >     <mailto:R-sig-mixed-models at r-project.org
>>>     <mailto:R-sig-mixed-models at r-project.org>
>>>      >     <mailto:R-sig-mixed-models at r-project.org
>>>     <mailto:R-sig-mixed-models at r-project.org>>>>
>>>      >      >      >      >     <mailto:R-sig-mixed-models at r-project.org
>>>     <mailto:R-sig-mixed-models at r-project.org>
>>>      >     <mailto:R-sig-mixed-models at r-project.org
>>>     <mailto:R-sig-mixed-models at r-project.org>>
>>>      >      >     <mailto:R-sig-mixed-models at r-project.org
>>>     <mailto:R-sig-mixed-models at r-project.org>
>>>      >     <mailto:R-sig-mixed-models at r-project.org
>>>     <mailto:R-sig-mixed-models at r-project.org>>>
>>>      >      >      >     <mailto:R-sig-mixed-models at r-project.org
>>>     <mailto:R-sig-mixed-models at r-project.org>
>>>      >     <mailto:R-sig-mixed-models at r-project.org
>>>     <mailto:R-sig-mixed-models at r-project.org>>
>>>      >      >     <mailto:R-sig-mixed-models at r-project.org
>>>     <mailto:R-sig-mixed-models at r-project.org>
>>>      >     <mailto:R-sig-mixed-models at r-project.org
>>>     <mailto:R-sig-mixed-models at r-project.org>>>>> mailing list
>>>      >      >      >      >      >
>>>      >      > https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>>>      >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>
>>>      >      >
>>>       <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>>>      >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>>
>>>      >      >      >
>>>      >       <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>>>      >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>
>>>      >      >
>>>       <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>>>      >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>>>
>>>      >      >      >      >
>>>      >      >
>>>       <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>>>      >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>
>>>      >      >
>>>       <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>>>      >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>>
>>>      >      >      >
>>>      >       <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>>>      >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>
>>>      >      >
>>>       <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>>>      >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>>>>
>>>      >      >      >      >     --
>>>      >      >      >      >     John Fox, Professor Emeritus
>>>      >      >      >      >     McMaster University
>>>      >      >      >      >     Hamilton, Ontario, Canada
>>>      >      >      >      >     web:
>>>     https://socialsciences.mcmaster.ca/jfox/
>>>     <https://socialsciences.mcmaster.ca/jfox/>
>>>      >     <https://socialsciences.mcmaster.ca/jfox/
>>>     <https://socialsciences.mcmaster.ca/jfox/>>
>>>      >      >     <https://socialsciences.mcmaster.ca/jfox/
>>>     <https://socialsciences.mcmaster.ca/jfox/>
>>>      >     <https://socialsciences.mcmaster.ca/jfox/
>>>     <https://socialsciences.mcmaster.ca/jfox/>>>
>>>      >      >      >     <https://socialsciences.mcmaster.ca/jfox/
>>>     <https://socialsciences.mcmaster.ca/jfox/>
>>>      >     <https://socialsciences.mcmaster.ca/jfox/
>>>     <https://socialsciences.mcmaster.ca/jfox/>>
>>>      >      >     <https://socialsciences.mcmaster.ca/jfox/
>>>     <https://socialsciences.mcmaster.ca/jfox/>
>>>      >     <https://socialsciences.mcmaster.ca/jfox/
>>>     <https://socialsciences.mcmaster.ca/jfox/>>>>
>>>      >      >      >      >
>>>       <https://socialsciences.mcmaster.ca/jfox/
>>>     <https://socialsciences.mcmaster.ca/jfox/>
>>>      >     <https://socialsciences.mcmaster.ca/jfox/
>>>     <https://socialsciences.mcmaster.ca/jfox/>>
>>>      >      >     <https://socialsciences.mcmaster.ca/jfox/
>>>     <https://socialsciences.mcmaster.ca/jfox/>
>>>      >     <https://socialsciences.mcmaster.ca/jfox/
>>>     <https://socialsciences.mcmaster.ca/jfox/>>>
>>>      >      >      >     <https://socialsciences.mcmaster.ca/jfox/
>>>     <https://socialsciences.mcmaster.ca/jfox/>
>>>      >     <https://socialsciences.mcmaster.ca/jfox/
>>>     <https://socialsciences.mcmaster.ca/jfox/>>
>>>      >      >     <https://socialsciences.mcmaster.ca/jfox/
>>>     <https://socialsciences.mcmaster.ca/jfox/>
>>>      >     <https://socialsciences.mcmaster.ca/jfox/
>>>     <https://socialsciences.mcmaster.ca/jfox/>>>>>
>>>      >      >      >      >
>>>      >      >      >     --
>>>      >      >      >     John Fox, Professor Emeritus
>>>      >      >      >     McMaster University
>>>      >      >      >     Hamilton, Ontario, Canada
>>>      >      >      >     web: https://socialsciences.mcmaster.ca/jfox/
>>>     <https://socialsciences.mcmaster.ca/jfox/>
>>>      >     <https://socialsciences.mcmaster.ca/jfox/
>>>     <https://socialsciences.mcmaster.ca/jfox/>>
>>>      >      >     <https://socialsciences.mcmaster.ca/jfox/
>>>     <https://socialsciences.mcmaster.ca/jfox/>
>>>      >     <https://socialsciences.mcmaster.ca/jfox/
>>>     <https://socialsciences.mcmaster.ca/jfox/>>>
>>>      >      >      >     <https://socialsciences.mcmaster.ca/jfox/
>>>     <https://socialsciences.mcmaster.ca/jfox/>
>>>      >     <https://socialsciences.mcmaster.ca/jfox/
>>>     <https://socialsciences.mcmaster.ca/jfox/>>
>>>      >      >     <https://socialsciences.mcmaster.ca/jfox/
>>>     <https://socialsciences.mcmaster.ca/jfox/>
>>>      >     <https://socialsciences.mcmaster.ca/jfox/
>>>     <https://socialsciences.mcmaster.ca/jfox/>>>>
>>>      >      >      >
>>>      >      >     --
>>>      >      >     John Fox, Professor Emeritus
>>>      >      >     McMaster University
>>>      >      >     Hamilton, Ontario, Canada
>>>      >      >     web: https://socialsciences.mcmaster.ca/jfox/
>>>     <https://socialsciences.mcmaster.ca/jfox/>
>>>      >     <https://socialsciences.mcmaster.ca/jfox/
>>>     <https://socialsciences.mcmaster.ca/jfox/>>
>>>      >      >     <https://socialsciences.mcmaster.ca/jfox/
>>>     <https://socialsciences.mcmaster.ca/jfox/>
>>>      >     <https://socialsciences.mcmaster.ca/jfox/
>>>     <https://socialsciences.mcmaster.ca/jfox/>>>
>>>      >      >
>>>      >
>>>
>>  ------------------------------------------------------------------------
>>>      >     --
>>>      >     John Fox, Professor Emeritus
>>>      >     McMaster University
>>>      >     Hamilton, Ontario, Canada
>>>      >     web: https://socialsciences.mcmaster.ca/jfox/
>>>     <https://socialsciences.mcmaster.ca/jfox/>
>>>      >     <https://socialsciences.mcmaster.ca/jfox/
>>>     <https://socialsciences.mcmaster.ca/jfox/>>
>>>      >
>>>     --
>>>     John Fox, Professor Emeritus
>>>     McMaster University
>>>     Hamilton, Ontario, Canada
>>>     web: https://socialsciences.mcmaster.ca/jfox/
>>>     <https://socialsciences.mcmaster.ca/jfox/>
>>>
>> --
>> John Fox, Professor Emeritus
>> McMaster University
>> Hamilton, Ontario, Canada
>> web: https://socialsciences.mcmaster.ca/jfox/
>>
>>
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>


From j|ox @end|ng |rom mcm@@ter@c@  Wed Feb  1 17:19:24 2023
From: j|ox @end|ng |rom mcm@@ter@c@ (John Fox)
Date: Wed, 1 Feb 2023 11:19:24 -0500
Subject: [R-sig-ME] 
 Collinearity diagnostics for (mixed) multinomial models
In-Reply-To: <dfd31e31-511c-73c0-a8a4-dfc2a3e37b20@phillipalday.com>
References: <mailman.19600.5.1645786802.52378.r-sig-mixed-models@r-project.org>
 <24314_1645908336_21QKjZ8b017357_CAG_dBVfdOZmbLRsWOQ5f28Y32ZMtDsOVE2-6FZmUaQ0H8f0+EQ@mail.gmail.com>
 <ec746b24-eb5b-5579-2b24-3c3b492d55d9@mcmaster.ca>
 <CAG_dBVfcpzW5RAs9syWFdL+RvryeAppowexjX_a9zJqRu+PC4Q@mail.gmail.com>
 <7e05d26d-e8af-aa48-8fd4-543c9f3dc3a2@mcmaster.ca>
 <CAG_dBVenhHeF5-hmA7M6xfD2FAeLmqzwc6AL-xrVREZuKyyKpA@mail.gmail.com>
 <67a63dca-f3c0-d766-0a2a-bad1a5fed9c3@mcmaster.ca>
 <CAG_dBVcv+12Q6_dSdX7_2cBPR5PgQmJ5bqZgQoWh88ATCmT6GA@mail.gmail.com>
 <0f03187e-d848-ea43-e370-ead2d403b530@mcmaster.ca>
 <CAG_dBVfv2-8Z0VRvcK4QUP97oh5jOhPd2d=LUj0N_6Ec+appMw@mail.gmail.com>
 <f80557f3-35c7-7b22-ae9c-2f14ff0d7ac0@mcmaster.ca>
 <CAG_dBVe7f5aEB_hA5t-j2u9ZJw-bDQPOchxc3-QTX3VejqXQSQ@mail.gmail.com>
 <d8c397b8-fbec-6c39-fdf5-5047daf6f219@mcmaster.ca>
 <CAG_dBVc2Vw6mQ17ZvXM+vJvvON9D=jHsXp+_3gM7m1zukNAAuQ@mail.gmail.com>
 <dfd31e31-511c-73c0-a8a4-dfc2a3e37b20@phillipalday.com>
Message-ID: <6ffe007d-b9f4-5fd1-87f9-152697012047@mcmaster.ca>

Dear Phillip (and Juho),

You raise a reasonable point but, unfortunately, one that isn't really 
relevant to the problem at hand.

Applied to a linear model, which is the context in which generalized 
variance inflation was originally defined in the paper by me and Georges 
Monette cited in ?car::vif, the GVIF *is* invariant with respect to 
inessential changes to the model such as centering regressors or any 
change in the bases for the regressor subspaces of terms in the model. 
The GVIF compares the size of the joint confidence region for the set of 
coefficients for a term in the model to its size in a utopian situation 
in which the subspace for the term is orthogonal to the subspaces of the 
other terms, and reduces to the usual VIF when the term in one-dimensional.

Generalized variance inflation has subsequently been extended to some 
other regression models, such as generalized linear models, and it 
retains these essential invariances (although interpretation isn't as 
straightforward).

In response to Juho's original question, I conjectured an extension to 
multinomial logit models, tested some of its invariance properties, but 
unfortunately didn't test sufficiently extensively. (I did suggest 
additional tests that I didn't perform.) It's clear from Juho's example 
that my conjecture was wrong.

The reason that I hadn't yet responded to Juho's recent question is that 
Georges and I are still trying to understand why my proposed definition 
fails for multinomial logit models. It appears to work, for example, for 
multivariate linear models. Neither of us, at this point, has a solution 
to Juho's problem, and it's possible that there isn't one. We're 
continuing to discuss the problem, and one of us will post an update to 
the list if we come up with either a solution or a clear explanation of 
why my proposal failed.

Thank you for prompting me to reply, if only in a preliminary manner.

Best,
  John

-- 
John Fox, Professor Emeritus
McMaster University
Hamilton, Ontario, Canada
web: https://socialsciences.mcmaster.ca/jfox/

On 2023-02-01 12:19 a.m., Phillip Alday wrote:
> I haven't seen an answer go by yet, but here's a breadcrumb:
> 
> Iacobucci, D., Schneider, M.J., Popovich, D.L. et al. Mean centering
> helps alleviate ?micro? but not ?macro? multicollinearity. Behav Res 48,
> 1308?1317 (2016). https://doi.org/10.3758/s13428-015-0624-x
> 
> 
> 
> On 26/1/23 8:56 am, Juho Kristian Ruohonen wrote:
>> Dear all,
>>
>> I'm resurrecting this thread because a problem has come up which might need
>> fixing once someone gets around to writing a relevant R package.
>>
>> In this same thread last March, John Fox showed me how to compute GVIFs for
>> a *nnet* multinomial model. I then wrote a simple function that loops
>> through all predictors in such a model and applies John's code to them,
>> returning the GVIF, DF, and GVIF^(1/(2*Df)) statistic for each predictor.
>> Available here
>> <https://github.com/jkruohon/StatsMisc/blob/main/gvif_multinom.R>, the
>> function seems to work just fine, reproducing John's results exactly on the
>> carData examples. Likewise, applying this function to my own research data
>> yielded entirely plausible results.
>>
>> But to my horror, I now discover that *when I refit my multinomial model
>> with two quantitative predictors centered, the GVIF statistics change
>> considerably** -- *even though the model has the same fit and virtually
>> identical coefficients (except for the intercepts) as the original one. How
>> can this be? The only thing that changes between the two models is the set
>> of intercepts which, moreover, are specifically excluded from the GVIF
>> calculations.
>>
>> Below is a minimal example. The anonymized datafile is downloadable here
>> <https://github.com/jkruohon/StatsMisc/raw/main/d_anon.RData>.
>>
>>> mod1 <- multinom(y ~., data = d.anon, maxit = 999)
>>> gvif.multinom(mod1) # x6 and x26 top the collinearity list
>>              GVIF DF GVIF^(1/(2df))
>> x6  3.463522e+03  3       3.889732
>> x26 2.988396e+03  3       3.795244
>> x27 1.390830e+03  3       3.341019
>> x2  3.889656e+02  3       2.701792
>> x13 2.930026e+02  3       2.577183
>> x19 2.051250e+04  6       2.287362
>> x25 7.043339e+03  6       2.092417
>> x24 1.078212e+07 12       1.963493
>> x9  2.357662e+01  3       1.693351
>> x17 1.991744e+01  3       1.646413
>> x5  3.869759e+02  6       1.643010
>> x12 1.787075e+01  3       1.616927
>> x18 2.943991e+02  6       1.605997
>> x1  2.700175e+03  9       1.551075
>> x16 2.576739e+04 12       1.526844
>> x7  1.483341e+02  6       1.516829
>> x20 1.159374e+01  3       1.504425
>> x3  1.612637e+04 12       1.497318
>> x28 1.081693e+01  3       1.487136
>> x10 9.706880e+00  3       1.460539
>> x22 9.459035e+00  3       1.454257
>> x15 9.124519e+00  3       1.445556
>> x14 7.017242e+00  3       1.383655
>> x21 6.404687e+00  3       1.362750
>> x8  6.072614e+00  3       1.350712
>> x11 4.797251e+00  3       1.298670
>> x4  3.665742e+03 18       1.256043
>> x23 3.557201e+00  3       1.235525
>>
>> Now we refit the model with the quantitative predictors x6 and x26 centered:
>>
>>> d.anon$x6 <- d.anon$x6 - mean(d.anon$x6)
>>> d.anon$x26 <- d.anon$x26 - mean(d.anon$x26)
>>> mod2 <- update(mod1, data = d.anon, maxit = 999)
>>> c(logLik(mod1), logLik(mod2))  # same fit to the data
>> [1] -2074.133 -2074.134
>>
>>> gvif.multinom(mod2)
>>              GVIF DF GVIF^(1/(2df))
>> x2  6.196959e+04  3       6.290663
>> x13 3.031115e+04  3       5.583850
>> x27 2.552811e+04  3       5.426291
>> x14 1.642231e+04  3       5.041646
>> x6  1.573721e+04  3       5.005967
>> x26 1.464437e+04  3       4.946277
>> x9  1.262667e+04  3       4.825564
>> x10 5.714321e+03  3       4.228251
>> x19 2.255013e+07  6       4.099798
>> x25 1.227033e+07  6       3.897068
>> x12 3.394139e+03  3       3.876635
>> x15 1.938364e+03  3       3.531067
>> x11 1.685265e+03  3       3.449674
>> x21 8.429450e+02  3       3.073500
>> x23 7.639755e+02  3       3.023523
>> x22 6.887451e+02  3       2.971733
>> x17 5.640312e+02  3       2.874422
>> x20 3.855848e+02  3       2.697864
>> x24 1.444083e+10 12       2.650430
>> x7  7.148911e+04  6       2.538166
>> x18 1.674603e+04  6       2.249017
>> x5  9.662266e+03  6       2.148275
>> x16 6.264044e+07 12       2.112851
>> x1  6.634544e+05  9       2.105882
>> x3  1.558132e+07 12       1.993847
>> x8  6.168472e+01  3       1.987755
>> x4  4.256459e+06 18       1.528059
>> x28 9.783234e+00  3       1.462448
>>
>> And so I'm at my wits' end. The models are virtually identical, yet the
>> GVIF statistics are very different. I don't know which ones to trust.
>> Worse, the discrepancy makes me disinclined to trust either of them --
>> which is a return to Square One, i.e. the situation where GVIF statistics
>> for multinomial models did not exist. And I don't know which
>> multicollinearity metric I can present in my thesis, if any.
>>
>> I hope someone can help.
>>
>> Best,
>>
>> Juho
>>
>>
>>
>>
>>
>> ke 2. maalisk. 2022 klo 16.35 John Fox (jfox at mcmaster.ca) kirjoitti:
>>
>>> Dear Juho,
>>>
>>> On 2022-03-02 6:23 a.m., Juho Kristian Ruohonen wrote:
>>>> One last comment, John: Sorry if I seemed to be implying that you (or
>>>> anyone else) should debug my code for me. That wasn't the idea. I do
>>>> believe that the function locates the intended rows/columns
>>>> successfully. I just wasn't entirely positive what those intended
>>>> rows/columns should be when dealing with a multicategory factor.
>>>> Presently, it locates every row/column involving the multicategory
>>>> factor in question, so the number of rows/columns identified is the
>>>> number of factor levels minus one, times the number of response
>>>> categories minus one. I hope that's correct.
>>>
>>> OK, that's a fair remark. Yes, what you describe is correct.
>>>
>>> You can also reassure yourself that your function is working properly by:
>>>
>>> (1) If you haven't already done so, show that you get the same GVIFs
>>> from your function as from the one I sent you used directly.
>>>
>>> (2) Vary the baseline level of the response variable and confirm that
>>> you get the same GVIFs.
>>>
>>> (3) Vary the basis for the regressor subspace for a factor, e.g., either
>>> by using contr.sum() in place of the default contr.treatment() or by
>>> changing the baseline level of the factor for contr.treatment(), and
>>> again confirm that the GVIFs are unchanged.
>>>
>>> Best,
>>>    John
>>>
>>>>
>>>> My current plan is to present the output of the new function in my
>>>> thesis and credit you for the math. But if *vif()* gets a relevant
>>>> update before my project is finished, then I'll use that and cite the
>>>> /car /package instead.
>>>>
>>>> Thanks again for your help.
>>>>
>>>> Best,
>>>>
>>>> Juho
>>>>
>>>> ti 1. maalisk. 2022 klo 23.54 John Fox (jfox at mcmaster.ca
>>>> <mailto:jfox at mcmaster.ca>) kirjoitti:
>>>>
>>>>      Dear Juho,
>>>>
>>>>      On 2022-03-01 3:13 p.m., Juho Kristian Ruohonen wrote:
>>>>       > Dear John,
>>>>       >
>>>>       > Yes, my function uses your code for the math. I was just hoping to
>>>>       > verify that it is handling multicategory factors correctly (your
>>>>       > examples didn't involve any).
>>>>
>>>>      That's not really my point. Your code sets up computations for the
>>>>      various terms in the model automatically, while the function I sent
>>>>      requires that you locate the rows/columns for the intercepts and each
>>>>      focal term manually. If you haven't already done so, you could check
>>>>      that your function is identifying the correct columns and getting the
>>>>      corresponding GVIFs.
>>>>
>>>>       >
>>>>       > I guess interactions aren't that important after all, given that
>>> the
>>>>       > chief concern is usually collinearity among main effects.
>>>>
>>>>      I wouldn't say that, but it's not clear what collinearity means in
>>>>      models with interactions, and if you compute VIFs or GVIFs for "main
>>>>      effects" in models with interactions, you'll probably get nonsense.
>>>>
>>>>      As I said, I think that this might be a solvable problem, but one
>>> that
>>>>      requires thought about what needs to remain invariant.
>>>>
>>>>      I think that we've probably come to end for now.
>>>>
>>>>      John
>>>>
>>>>       >
>>>>       > Many thanks for all your help.
>>>>       >
>>>>       > Best,
>>>>       >
>>>>       > Juho
>>>>       >
>>>>       > ti 1. maalisk. 2022 klo 18.01 John Fox (jfox at mcmaster.ca
>>>>      <mailto:jfox at mcmaster.ca>
>>>>       > <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>) kirjoitti:
>>>>       >
>>>>       >     Dear Juho,
>>>>       >
>>>>       >     On 2022-03-01 8:24 a.m., Juho Kristian Ruohonen wrote:
>>>>       >      > Dear John (Fox, as well as other list members),
>>>>       >      >
>>>>       >      > I've now written a simple function to try and calculate
>>>>      GVIFS for
>>>>       >     all
>>>>       >      > predictors in a nnet::multinom() object based on John's
>>>>      example
>>>>       >     code. If
>>>>       >      > its results are correct (see below), I will proceed to
>>> write a
>>>>       >     version
>>>>       >      > that also works with mixed-effects multinomial models fit
>>> by
>>>>       >      > brms::brm(). Here's the code:
>>>>       >      >
>>>>       >      >     gvif.multinom <- function(model){
>>>>       >      >        (classes <- model$lev)
>>>>       >      >        (V.all <- vcov(model))
>>>>       >      >        (V.noIntercepts <- V.all[!grepl("\\(Intercept\\)$",
>>>>       >      >     rownames(V.all), perl = T),
>>>>       >      >                                 !grepl("\\(Intercept\\)$",
>>>>       >      >     colnames(V.all), perl = T)])
>>>>       >      >        (R <- cov2cor(V.noIntercepts))
>>>>       >      >        (terms <- attr(model$terms, "term.labels"))
>>>>       >      >        (gvif <- numeric(length = length(terms)))
>>>>       >      >        (names(gvif) <- terms)
>>>>       >      >        (SE.multiplier <- numeric(length = length(terms)))
>>>>       >      >        (names(SE.multiplier) <- terms)
>>>>       >      >        #The line below tries to capture all factor levels
>>>>      into a
>>>>       >     regex
>>>>       >      >     for coef name matching.
>>>>       >      >        (LevelsRegex <- paste0("(",
>>>>      paste(unlist(model$xlevels),
>>>>       >     collapse
>>>>       >      >     = "|"),")?"))
>>>>       >      >
>>>>       >      >        for(i in terms){
>>>>       >      >          #The regex stuff below tries to ensure all
>>>>      interaction
>>>>       >      >     coefficients are matched, including those involving
>>>>      factors.
>>>>       >      >          if(grepl(":", i)){
>>>>       >      >            (termname <- gsub(":", paste0(LevelsRegex,
>>> ":"), i,
>>>>       >     perl = T))
>>>>       >      >          }else{termname <- i}
>>>>       >      >          (RegexToMatch <- paste0("^(",
>>>>       >     paste(classes[2:length(classes)],
>>>>       >      >     collapse = "|") ,"):", termname, LevelsRegex, "$"))
>>>>       >      >
>>>>       >      >          #Now the actual calculation:
>>>>       >      >          (indices <- grep(RegexToMatch, rownames(R), perl
>>>>      = T))
>>>>       >      >          (gvif[i] <- det(R[indices, indices]) *
>>>>      det(R[-indices,
>>>>       >      >     -indices]) / det(R))
>>>>       >      >          (SE.multiplier[i] <-
>>> gvif[i]^(1/(2*length(indices))))
>>>>       >      >        }
>>>>       >      >        #Put the results together and order them by degree
>>>>      of SE
>>>>       >     inflation:
>>>>       >      >        (result <- cbind(GVIF = gvif, `GVIF^(1/(2df))` =
>>>>       >     SE.multiplier))
>>>>       >      >        return(result[order(result[,"GVIF^(1/(2df))"],
>>>>      decreasing
>>>>       >     = T),])}
>>>>       >      >
>>>>       >      >
>>>>       >      > The results seem correct to me when applied to John's
>>> example
>>>>       >     model fit
>>>>       >      > to the BEPS data. However, that dataset contains no
>>> multi-df
>>>>       >     factors, of
>>>>       >      > which my own models have many. Below is a maximally simple
>>>>       >     example with
>>>>       >      > one multi-df factor (/region/):
>>>>       >      >
>>>>       >      >     mod1 <- multinom(partic ~., data = carData::Womenlf)
>>>>       >      >     gvif.multinom(mod1)
>>>>       >      >
>>>>       >      >     GVIF GVIF^(1/(2df))
>>>>       >      >     children 1.298794       1.067542
>>>>       >      >     hincome  1.184215       1.043176
>>>>       >      >     region   1.381480       1.020403
>>>>       >      >
>>>>       >      >
>>>>       >      > These results look plausible to me. Finally, below is an
>>>>      example
>>>>       >      > involving both a multi-df factor and an interaction:
>>>>       >      >
>>>>       >      >     mod2 <- update(mod1, ~. +children:region)
>>>>       >      >     gvif.multinom(mod2)
>>>>       >      >
>>>>       >      >                              GVIF GVIF^(1/(2df))
>>>>       >      >     children:region 4.965762e+16      11.053482
>>>>       >      >     region          1.420418e+16      10.221768
>>>>       >      >     children        1.471412e+03       6.193463
>>>>       >      >     hincome         6.462161e+00       1.594390
>>>>       >      >
>>>>       >      >
>>>>       >      > These results look a bit more dubious. To be sure, it is
>>> to be
>>>>       >     expected
>>>>       >      > that interaction terms will introduce a lot of
>>>>      collinearity. But an
>>>>       >      > 11-fold increase in SE? I hope someone can tell me whether
>>>>      this is
>>>>       >      > correct or not!
>>>>       >
>>>>       >     You don't need someone else to check your work because you
>>>>      could just
>>>>       >     apply the simple function that I sent you yesterday, which,
>>>>      though not
>>>>       >     automatic, computes the GVIFs in a transparent manner.
>>>>       >
>>>>       >     A brief comment on GVIFs for models with interactions (this
>>>>      isn't the
>>>>       >     place to discuss the question in detail): The Fox and Monette
>>>>      JASA
>>>>       >     paper
>>>>       >     addresses the question briefly in the context of a two-way
>>>>      ANOVA, but I
>>>>       >     don't think that the approach suggested there is easily
>>>>      generalized.
>>>>       >
>>>>       >     The following simple approach pays attention to what's
>>>>      invariant under
>>>>       >     different parametrizations of the RHS side of the model:
>>>>      Simultaneously
>>>>       >     check the collinearity of all of the coefficients of an
>>>>      interaction
>>>>       >     together with the main effects and, potentially, lower-order
>>>>       >     interactions that are marginal to it. So, e.g., in the model
>>>>      y ~ a +
>>>>       >     b +
>>>>       >     a:b + c, you'd check all of the coefficients for a, b, and
>>>>      a:b together.
>>>>       >
>>>>       >     Alternatively, one could focus in turn on each explanatory
>>>>      variable and
>>>>       >     check the collinearity of all coefficients to which it is
>>>>      marginal. So
>>>>       >     in y ~ a + b + c + a:b + a:c + d, when you focus on a, you'd
>>>>      look at
>>>>       >     all
>>>>       >     of the coefficients for a, b, c, a:b, and a:c.
>>>>       >
>>>>       >     John
>>>>       >
>>>>       >      >
>>>>       >      > Best,
>>>>       >      >
>>>>       >      > Juho
>>>>       >      >
>>>>       >      >
>>>>       >      >
>>>>       >      >
>>>>       >      >
>>>>       >      >
>>>>       >      >
>>>>       >      >
>>>>       >      >
>>>>       >      >
>>>>       >      >
>>>>       >      > ti 1. maalisk. 2022 klo 0.05 John Fox (jfox at mcmaster.ca
>>>>      <mailto:jfox at mcmaster.ca>
>>>>       >     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>
>>>>       >      > <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
>>>>      <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>>) kirjoitti:
>>>>       >      >
>>>>       >      >     Dear Juha,
>>>>       >      >
>>>>       >      >     On 2022-02-28 5:00 p.m., Juho Kristian Ruohonen wrote:
>>>>       >      >      > Apologies for my misreading, John, and many thanks
>>>>      for showing
>>>>       >      >     how the
>>>>       >      >      > calculation is done for a single term.
>>>>       >      >      >
>>>>       >      >      > Do you think *vif()* might be updated in the near
>>>>      future
>>>>       >     with the
>>>>       >      >      > capability of auto-detecting a multinomial model
>>>>      and returning
>>>>       >      >      > mathematically correct GVIF statistics?
>>>>       >      >
>>>>       >      >     The thought crossed my mind, but I'd want to do it in a
>>>>       >     general way,
>>>>       >      >     not
>>>>       >      >     just for the multinom() function, and in a way that
>>> avoids
>>>>       >     incorrect
>>>>       >      >     results such as those currently produced for "multinom"
>>>>       >     models, albeit
>>>>       >      >     with a warning. I can't guarantee whether or when I'll
>>> be
>>>>       >     able to do
>>>>       >      >     that.
>>>>       >      >
>>>>       >      >     John
>>>>       >      >
>>>>       >      >      >
>>>>       >      >      > If not, I'll proceed to writing my own function
>>>>      based on your
>>>>       >      >     example.
>>>>       >      >      > However, /car/ is such an excellent and widely used
>>>>       >     package that the
>>>>       >      >      > greatest benefit to mankind would probably accrue
>>>>      if /car /was
>>>>       >      >     upgraded
>>>>       >      >      > with this feature sooner rather than later.
>>>>       >      >      >
>>>>       >      >      > Best,
>>>>       >      >      >
>>>>       >      >      > Juho
>>>>       >      >      >
>>>>       >      >      >
>>>>       >      >      >
>>>>       >      >      >
>>>>       >      >      >
>>>>       >      >      >
>>>>       >      >      >
>>>>       >      >      >
>>>>       >      >      >
>>>>       >      >      > ma 28. helmik. 2022 klo 17.08 John Fox
>>>>      (jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
>>>>       >     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>
>>>>       >      >     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
>>>>      <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>>
>>>>       >      >      > <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
>>>>      <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>
>>>>       >     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
>>>>      <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>>>) kirjoitti:
>>>>       >      >      >
>>>>       >      >      >     Dear Juho,
>>>>       >      >      >
>>>>       >      >      >     On 2022-02-28 2:06 a.m., Juho Kristian Ruohonen
>>>>      wrote:
>>>>       >      >      >      > Dear Professor Fox and other list members,
>>>>       >      >      >      >
>>>>       >      >      >      > Profuse thanks for doing that detective work
>>> for
>>>>       >     me! I myself
>>>>       >      >      >     thought
>>>>       >      >      >      > the inflation factors reported by
>>>>       >     check_collinearity() were
>>>>       >      >      >     suspiciously
>>>>       >      >      >      > high, but unlike you I lacked the expertise
>>>>      to identify
>>>>       >      >     what was
>>>>       >      >      >     going on.
>>>>       >      >      >      >
>>>>       >      >      >      > As for your suggested approach, have I
>>>>      understood this
>>>>       >      >     correctly:
>>>>       >      >      >      >
>>>>       >      >      >      > Since there doesn't yet exist an R function
>>>>      that will
>>>>       >      >     calculate the
>>>>       >      >      >      > (G)VIFS of multinomial models correctly, my
>>> best
>>>>       >     bet for
>>>>       >      >     now is
>>>>       >      >      >     just to
>>>>       >      >      >      > ignore the fact that such models partition
>>>>      the data
>>>>       >     into C-1
>>>>       >      >      >     subsets,
>>>>       >      >      >      > and to calculate approximate GVIFs from the
>>>>      entire
>>>>       >     dataset at
>>>>       >      >      >     once as if
>>>>       >      >      >      > the response were continuous? And a simple
>>>>      way to
>>>>       >     do this
>>>>       >      >     is to
>>>>       >      >      >      > construct a fake continuous response, call
>>>>       >      >     *lm(fakeresponse ~.)*,
>>>>       >      >      >     and
>>>>       >      >      >      > apply *car::vif()* on the result?
>>>>       >      >      >
>>>>       >      >      >     No, you misunderstand my suggestion, which
>>>>      perhaps isn't
>>>>       >      >     surprising
>>>>       >      >      >     given the length of my message. What you
>>>>      propose is what I
>>>>       >      >     suggested as
>>>>       >      >      >     a rough approximation *before* I confirmed that
>>> my
>>>>       >     guess of the
>>>>       >      >      >     solution
>>>>       >      >      >     was correct.
>>>>       >      >      >
>>>>       >      >      >     The R code that I sent yesterday showed how to
>>>>      compute the
>>>>       >      >     GVIF for a
>>>>       >      >      >     multinomial regression model, and I suggested
>>>>      that you
>>>>       >     write
>>>>       >      >     either a
>>>>       >      >      >     script or a simple function to do that. Here's
>>>>      a function
>>>>       >      >     that will
>>>>       >      >      >     work
>>>>       >      >      >     for a model object that responds to vcov():
>>>>       >      >      >
>>>>       >      >      >     GVIF <- function(model, intercepts, term){
>>>>       >      >      >         # model: regression model object
>>>>       >      >      >         # intercepts: row/column positions of
>>>>      intercepts
>>>>       >     in the
>>>>       >      >     coefficient
>>>>       >      >      >     covariance matrix
>>>>       >      >      >         # term: row/column positions of the
>>>>      coefficients
>>>>       >     for the
>>>>       >      >     focal term
>>>>       >      >      >         V <- vcov(model)
>>>>       >      >      >         term <- colnames(V)[term]
>>>>       >      >      >         V <- V[-intercepts, -intercepts]
>>>>       >      >      >         V <- cov2cor(V)
>>>>       >      >      >         term <- which(colnames(V) %in% term)
>>>>       >      >      >         gvif <- det(V[term, term])*det(V[-term,
>>>>      -term])/det(V)
>>>>       >      >      >         c(GVIF=gvif,
>>>>       >     "GVIF^(1/(2*p))"=gvif^(1/(2*length(term))))
>>>>       >      >      >     }
>>>>       >      >      >
>>>>       >      >      >     and here's an application to the multinom()
>>>>      example that I
>>>>       >      >     showed you
>>>>       >      >      >     yesterday:
>>>>       >      >      >
>>>>       >      >      >       > colnames(vcov(m)) # to get coefficient
>>>>      positions
>>>>       >      >      >        [1] "Labour:(Intercept)"
>>>>       >       "Labour:age"
>>>>       >      >      >
>>>>       >      >      >        [3] "Labour:economic.cond.national"
>>>>       >      >      >     "Labour:economic.cond.household"
>>>>       >      >      >        [5] "Labour:Blair"
>>>>       >       "Labour:Hague"
>>>>       >      >      >
>>>>       >      >      >        [7] "Labour:Kennedy"
>>>>       >       "Labour:Europe"
>>>>       >      >      >
>>>>       >      >      >        [9] "Labour:political.knowledge"
>>>>       >      >       "Labour:gendermale"
>>>>       >      >      >
>>>>       >      >      >     [11] "Liberal Democrat:(Intercept)"
>>>>        "Liberal
>>>>       >      >     Democrat:age"
>>>>       >      >      >
>>>>       >      >      >     [13] "Liberal Democrat:economic.cond.national"
>>>>      "Liberal
>>>>       >      >      >     Democrat:economic.cond.household"
>>>>       >      >      >     [15] "Liberal Democrat:Blair"
>>>>        "Liberal
>>>>       >      >      >     Democrat:Hague"
>>>>       >      >      >
>>>>       >      >      >     [17] "Liberal Democrat:Kennedy"
>>>>        "Liberal
>>>>       >      >      >     Democrat:Europe"
>>>>       >      >      >     [19] "Liberal Democrat:political.knowledge"
>>>>        "Liberal
>>>>       >      >      >     Democrat:gendermale"
>>>>       >      >      >
>>>>       >      >      >       > GVIF(m, intercepts=c(1, 11), term=c(2, 12))
>>>>      # GVIF
>>>>       >     for age
>>>>       >      >      >                 GVIF GVIF^(1/(2*p))
>>>>       >      >      >             1.046232       1.011363
>>>>       >      >      >
>>>>       >      >      >
>>>>       >      >      >     Finally, here's what you get for a linear model
>>>>      with
>>>>       >     the same RHS
>>>>       >      >      >     (where
>>>>       >      >      >     the sqrt(VIF) should be a rough approximation to
>>>>       >     GVIF^(1/4)
>>>>       >      >     reported by
>>>>       >      >      >     my GVIF() function):
>>>>       >      >      >
>>>>       >      >      >       > m.lm <- lm(as.numeric(vote) ~ . - vote1,
>>>>      data=BEPS)
>>>>       >      >      >       > sqrt(car::vif(m.lm))
>>>>       >      >      >                           age
>>> economic.cond.national
>>>>       >      >      >     economic.cond.household
>>>>       >      >      >                         Blair
>>>>       >      >      >                      1.006508
>>> 1.124132
>>>>       >      >      >     1.075656
>>>>       >      >      >                      1.118441
>>>>       >      >      >                         Hague
>>>   Kennedy
>>>>       >      >      >     Europe
>>>>       >      >      >           political.knowledge
>>>>       >      >      >                      1.066799
>>> 1.015532
>>>>       >      >      >     1.101741
>>>>       >      >      >                      1.028546
>>>>       >      >      >                        gender
>>>>       >      >      >                      1.017386
>>>>       >      >      >
>>>>       >      >      >
>>>>       >      >      >     John
>>>>       >      >      >
>>>>       >      >      >      >
>>>>       >      >      >      > Best,
>>>>       >      >      >      >
>>>>       >      >      >      > Juho
>>>>       >      >      >      >
>>>>       >      >      >      > ma 28. helmik. 2022 klo 2.23 John Fox
>>>>       >     (jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
>>>>      <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>
>>>>       >      >     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
>>>>      <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>>
>>>>       >      >      >     <mailto:jfox at mcmaster.ca
>>>>      <mailto:jfox at mcmaster.ca> <mailto:jfox at mcmaster.ca
>>>>      <mailto:jfox at mcmaster.ca>>
>>>>       >     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
>>>>      <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>>>
>>>>       >      >      >      > <mailto:jfox at mcmaster.ca
>>>>      <mailto:jfox at mcmaster.ca> <mailto:jfox at mcmaster.ca
>>>>      <mailto:jfox at mcmaster.ca>>
>>>>       >     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
>>>>      <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>>
>>>>       >      >     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
>>>>      <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>
>>>>       >     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
>>>>      <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>>>>) kirjoitti:
>>>>       >      >      >      >
>>>>       >      >      >      >     Dear Juho,
>>>>       >      >      >      >
>>>>       >      >      >      >     I've now had a chance to think about this
>>>>       >     problem some
>>>>       >      >     more,
>>>>       >      >      >     and I
>>>>       >      >      >      >     believe that the approach I suggested is
>>>>      correct. I
>>>>       >      >     also had an
>>>>       >      >      >      >     opportunity to talk the problem over a
>>>>      bit with
>>>>       >     Georges
>>>>       >      >      >     Monette, who
>>>>       >      >      >      >     coauthored the paper that introduced
>>>>       >     generalized variance
>>>>       >      >      >     inflation
>>>>       >      >      >      >     factors (GVIFs). On the other hand, the
>>>>      results
>>>>       >      >     produced by
>>>>       >      >      >      >     performance::check_collinearity() for
>>>>       >     multinomial logit
>>>>       >      >      >     models don't
>>>>       >      >      >      >     seem to be correct (see below).
>>>>       >      >      >      >
>>>>       >      >      >      >     Here's an example, using the
>>>>      nnet::multinom()
>>>>       >     function
>>>>       >      >     to fit a
>>>>       >      >      >      >     multinomial logit model, with alternative
>>>>       >      >     parametrizations of the
>>>>       >      >      >      >     LHS of
>>>>       >      >      >      >     the model:
>>>>       >      >      >      >
>>>>       >      >      >      >     --------- snip -----------
>>>>       >      >      >      >
>>>>       >      >      >      >       > library(nnet) # for multinom()
>>>>       >      >      >      >       > library(carData) # for BEPS data set
>>>>       >      >      >      >
>>>>       >      >      >      >       > # alternative ordering of the
>>>>      response levels:
>>>>       >      >      >      >       > BEPS$vote1 <- factor(BEPS$vote,
>>>>       >     levels=c("Labour",
>>>>       >      >     "Liberal
>>>>       >      >      >      >     Democrat", "Conservative"))
>>>>       >      >      >      >       > levels(BEPS$vote)
>>>>       >      >      >      >     [1] "Conservative"     "Labour"
>>>>        "Liberal
>>>>       >      >     Democrat"
>>>>       >      >      >      >       > levels(BEPS$vote1)
>>>>       >      >      >      >     [1] "Labour"           "Liberal Democrat"
>>>>       >     "Conservative"
>>>>       >      >      >      >
>>>>       >      >      >      >       > m <- multinom(vote ~ . - vote1,
>>>>      data=BEPS)
>>>>       >      >      >      >     # weights:  33 (20 variable)
>>>>       >      >      >      >     initial  value 1675.383740
>>>>       >      >      >      >     iter  10 value 1345.935273
>>>>       >      >      >      >     iter  20 value 1150.956807
>>>>       >      >      >      >     iter  30 value 1141.921662
>>>>       >      >      >      >     iter  30 value 1141.921661
>>>>       >      >      >      >     iter  30 value 1141.921661
>>>>       >      >      >      >     final  value 1141.921661
>>>>       >      >      >      >     converged
>>>>       >      >      >      >       > m1 <- multinom(vote1 ~ . - vote,
>>>>      data=BEPS)
>>>>       >      >      >      >     # weights:  33 (20 variable)
>>>>       >      >      >      >     initial  value 1675.383740
>>>>       >      >      >      >     iter  10 value 1280.439304
>>>>       >      >      >      >     iter  20 value 1165.513772
>>>>       >      >      >      >     final  value 1141.921662
>>>>       >      >      >      >     converged
>>>>       >      >      >      >
>>>>       >      >      >      >       > rbind(coef(m), coef(m1)) # compare
>>>>      coefficients
>>>>       >      >      >      >                        (Intercept)
>>> age
>>>>       >      >      >     economic.cond.national
>>>>       >      >      >      >     economic.cond.household
>>>>       >      >      >      >     Labour             0.9515214 -0.021913989
>>>>       >      >     0.5575707
>>>>       >      >      >      >            0.15839096
>>>>       >      >      >      >     Liberal Democrat   1.4119306 -0.016810735
>>>>       >      >     0.1810761
>>>>       >      >      >      >           -0.01196664
>>>>       >      >      >      >     Liberal Democrat   0.4604567  0.005102666
>>>>       >      >       -0.3764928
>>>>       >      >      >      >           -0.17036682
>>>>       >      >      >      >     Conservative      -0.9514466  0.021912305
>>>>       >      >       -0.5575644
>>>>       >      >      >      >           -0.15838744
>>>>       >      >      >      >                             Blair       Hague
>>>>       >     Kennedy
>>>>       >      >          Europe
>>>>       >      >      >      >     political.knowledge
>>>>       >      >      >      >     Labour            0.8371764 -0.90775585
>>>>      0.2513436
>>>>       >      >     -0.22781308
>>>>       >      >      >      >     -0.5370612
>>>>       >      >      >      >     Liberal Democrat  0.2937331 -0.82217625
>>>>      0.6710567
>>>>       >      >     -0.20004624
>>>>       >      >      >      >     -0.2034605
>>>>       >      >      >      >     Liberal Democrat -0.5434408  0.08559455
>>>>      0.4197027
>>>>       >      >     0.02776465
>>>>       >      >      >      >     0.3336068
>>>>       >      >      >      >     Conservative     -0.8371670  0.90778068
>>>>      -0.2513735
>>>>       >      >     0.22781092
>>>>       >      >      >      >     0.5370545
>>>>       >      >      >      >                         gendermale
>>>>       >      >      >      >     Labour            0.13765774
>>>>       >      >      >      >     Liberal Democrat  0.12640823
>>>>       >      >      >      >     Liberal Democrat -0.01125898
>>>>       >      >      >      >     Conservative     -0.13764849
>>>>       >      >      >      >
>>>>       >      >      >      >       > c(logLik(m), logLik(m1)) # same fit
>>>>      to the data
>>>>       >      >      >      >     [1] -1141.922 -1141.922
>>>>       >      >      >      >
>>>>       >      >      >      >       > # covariance matrices for
>>> coefficients:
>>>>       >      >      >      >       > V <- vcov(m)
>>>>       >      >      >      >       > V1 <- vcov(m1)
>>>>       >      >      >      >       > cbind(colnames(V), colnames(V1)) #
>>>>      compare
>>>>       >      >      >      >             [,1]
>>>>       >         [,2]
>>>>       >      >      >      >
>>>>       >      >      >      >        [1,] "Labour:(Intercept)"
>>>>       >      >       "Liberal
>>>>       >      >      >      >     Democrat:(Intercept)"
>>>>       >      >      >      >        [2,] "Labour:age"
>>>>       >      >       "Liberal
>>>>       >      >      >      >     Democrat:age"
>>>>       >      >      >      >
>>>>       >      >      >      >        [3,] "Labour:economic.cond.national"
>>>>       >      >     "Liberal
>>>>       >      >      >      >     Democrat:economic.cond.national"
>>>>       >      >      >      >        [4,] "Labour:economic.cond.household"
>>>>       >      >       "Liberal
>>>>       >      >      >      >     Democrat:economic.cond.household"
>>>>       >      >      >      >        [5,] "Labour:Blair"
>>>>       >      >       "Liberal
>>>>       >      >      >      >     Democrat:Blair"
>>>>       >      >      >      >        [6,] "Labour:Hague"
>>>>       >      >       "Liberal
>>>>       >      >      >      >     Democrat:Hague"
>>>>       >      >      >      >        [7,] "Labour:Kennedy"
>>>>       >      >       "Liberal
>>>>       >      >      >      >     Democrat:Kennedy"
>>>>       >      >      >      >        [8,] "Labour:Europe"
>>>>       >      >     "Liberal
>>>>       >      >      >      >     Democrat:Europe"
>>>>       >      >      >      >        [9,] "Labour:political.knowledge"
>>>>       >      >       "Liberal
>>>>       >      >      >      >     Democrat:political.knowledge"
>>>>       >      >      >      >     [10,] "Labour:gendermale"
>>>>       >        "Liberal
>>>>       >      >      >      >     Democrat:gendermale"
>>>>       >      >      >      >     [11,] "Liberal Democrat:(Intercept)"
>>>>       >      >      >      >     "Conservative:(Intercept)"
>>>>       >      >      >      >     [12,] "Liberal Democrat:age"
>>>>       >      >      >       "Conservative:age"
>>>>       >      >      >      >
>>>>       >      >      >      >     [13,] "Liberal
>>>>      Democrat:economic.cond.national"
>>>>       >      >      >      >     "Conservative:economic.cond.national"
>>>>       >      >      >      >     [14,] "Liberal
>>>>      Democrat:economic.cond.household"
>>>>       >      >      >      >     "Conservative:economic.cond.household"
>>>>       >      >      >      >     [15,] "Liberal Democrat:Blair"
>>>>       >      >      >       "Conservative:Blair"
>>>>       >      >      >      >
>>>>       >      >      >      >     [16,] "Liberal Democrat:Hague"
>>>>       >      >      >       "Conservative:Hague"
>>>>       >      >      >      >
>>>>       >      >      >      >     [17,] "Liberal Democrat:Kennedy"
>>>>       >      >      >       "Conservative:Kennedy"
>>>>       >      >      >      >
>>>>       >      >      >      >     [18,] "Liberal Democrat:Europe"
>>>>       >      >      >     "Conservative:Europe"
>>>>       >      >      >      >
>>>>       >      >      >      >     [19,] "Liberal
>>> Democrat:political.knowledge"
>>>>       >      >      >      >     "Conservative:political.knowledge"
>>>>       >      >      >      >     [20,] "Liberal Democrat:gendermale"
>>>>       >      >      >      >     "Conservative:gendermale"
>>>>       >      >      >      >
>>>>       >      >      >      >       > int <- c(1, 11) # remove intercepts
>>>>       >      >      >      >       > colnames(V)[int]
>>>>       >      >      >      >     [1] "Labour:(Intercept)"
>>>   "Liberal
>>>>       >      >     Democrat:(Intercept)"
>>>>       >      >      >      >
>>>>       >      >      >      >       > colnames(V1)[int]
>>>>       >      >      >      >     [1] "Liberal Democrat:(Intercept)"
>>>>       >      >     "Conservative:(Intercept)"
>>>>       >      >      >      >       > V <- V[-int, -int]
>>>>       >      >      >      >       > V1 <- V1[-int, -int]
>>>>       >      >      >      >
>>>>       >      >      >      >       > age <- c(1, 10) # locate age
>>>>      coefficients
>>>>       >      >      >      >       > colnames(V)[age]
>>>>       >      >      >      >     [1] "Labour:age"           "Liberal
>>>>      Democrat:age"
>>>>       >      >      >      >       > colnames(V1)[age]
>>>>       >      >      >      >     [1] "Liberal Democrat:age"
>>>>      "Conservative:age"
>>>>       >      >      >      >
>>>>       >      >      >      >       > V <- cov2cor(V) # compute coefficient
>>>>       >     correlations
>>>>       >      >      >      >       > V1 <- cov2cor(V1)
>>>>       >      >      >      >
>>>>       >      >      >      >       > # compare GVIFs:
>>>>       >      >      >      >       > c(det(V[age, age])*det(V[-age,
>>>>      -age])/det(V),
>>>>       >      >      >      >     +   det(V1[age, age])*det(V1[-age,
>>>>      -age])/det(V1))
>>>>       >      >      >      >     [1] 1.046232 1.046229
>>>>       >      >      >      >
>>>>       >      >      >      >     --------- snip -----------
>>>>       >      >      >      >
>>>>       >      >      >      >     For curiosity, I applied car::vif() and
>>>>       >      >      >      >     performance::check_collinearity() to
>>> these
>>>>       >     models to
>>>>       >      >     see what
>>>>       >      >      >     they
>>>>       >      >      >      >     would
>>>>       >      >      >      >     do. Both returned the wrong answer. vif()
>>>>       >     produced a
>>>>       >      >     warning, but
>>>>       >      >      >      >     check_collinearity() didn't:
>>>>       >      >      >      >
>>>>       >      >      >      >     --------- snip -----------
>>>>       >      >      >      >
>>>>       >      >      >      >       > car::vif(m1)
>>>>       >      >      >      >                           age
>>>>      economic.cond.national
>>>>       >      >      >      >     economic.cond.household
>>>>       >      >      >      >                     15.461045
>>>>        22.137772
>>>>       >      >      >      >       16.693877
>>>>       >      >      >      >                         Blair
>>>>          Hague
>>>>       >      >      >      >       Kennedy
>>>>       >      >      >      >                     14.681562
>>>>      7.483039
>>>>       >      >      >      >       15.812067
>>>>       >      >      >      >                        Europe
>>>>        political.knowledge
>>>>       >      >      >      >     gender
>>>>       >      >      >      >                      6.502119
>>>>      4.219507
>>>>       >      >      >      >     2.313885
>>>>       >      >      >      >     Warning message:
>>>>       >      >      >      >     In vif.default(m1) : No intercept: vifs
>>>>      may not be
>>>>       >      >     sensible.
>>>>       >      >      >      >
>>>>       >      >      >      >       > performance::check_collinearity(m)
>>>>       >      >      >      >     # Check for Multicollinearity
>>>>       >      >      >      >
>>>>       >      >      >      >     Low Correlation
>>>>       >      >      >      >
>>>>       >      >      >      >                           Term  VIF
>>> Increased SE
>>>>       >     Tolerance
>>>>       >      >      >      >                            age 1.72
>>>>        1.31
>>>>       >        0.58
>>>>       >      >      >      >         economic.cond.national 1.85
>>>>        1.36
>>>>       >        0.54
>>>>       >      >      >      >        economic.cond.household 1.86
>>>>        1.37
>>>>       >        0.54
>>>>       >      >      >      >                          Blair 1.63
>>>>        1.28
>>>>       >        0.61
>>>>       >      >      >      >                          Hague 1.94
>>>>        1.39
>>>>       >        0.52
>>>>       >      >      >      >                        Kennedy 1.70
>>>>        1.30
>>>>       >        0.59
>>>>       >      >      >      >                         Europe 2.01
>>>>        1.42
>>>>       >        0.50
>>>>       >      >      >      >            political.knowledge 1.94
>>>>        1.39
>>>>       >        0.52
>>>>       >      >      >      >                         gender 1.78
>>>>        1.33
>>>>       >        0.56
>>>>       >      >      >      >       > performance::check_collinearity(m1)
>>>>       >      >      >      >     # Check for Multicollinearity
>>>>       >      >      >      >
>>>>       >      >      >      >     Low Correlation
>>>>       >      >      >      >
>>>>       >      >      >      >                           Term  VIF
>>> Increased SE
>>>>       >     Tolerance
>>>>       >      >      >      >                            age 1.19
>>>>        1.09
>>>>       >        0.84
>>>>       >      >      >      >         economic.cond.national 1.42
>>>>        1.19
>>>>       >        0.70
>>>>       >      >      >      >        economic.cond.household 1.32
>>>>        1.15
>>>>       >        0.76
>>>>       >      >      >      >                          Blair 1.50
>>>>        1.22
>>>>       >        0.67
>>>>       >      >      >      >                          Hague 1.30
>>>>        1.14
>>>>       >        0.77
>>>>       >      >      >      >                        Kennedy 1.19
>>>>        1.09
>>>>       >        0.84
>>>>       >      >      >      >                         Europe 1.34
>>>>        1.16
>>>>       >        0.75
>>>>       >      >      >      >            political.knowledge 1.30
>>>>        1.14
>>>>       >        0.77
>>>>       >      >      >      >                         gender 1.23
>>>>        1.11
>>>>       >        0.81
>>>>       >      >      >      >
>>>>       >      >      >      >     --------- snip -----------
>>>>       >      >      >      >
>>>>       >      >      >      >     I looked at the code for vif() and
>>>>       >     check_collinearity() to
>>>>       >      >      >     see where
>>>>       >      >      >      >     they went wrong. Both failed to handle
>>>>      the two
>>>>       >      >     intercepts in
>>>>       >      >      >     the model
>>>>       >      >      >      >     correctly -- vif() thought there was no
>>>>       >     intercept and
>>>>       >      >      >      >     check_collinearity() just removed the
>>> first
>>>>       >     intercept
>>>>       >      >     but not the
>>>>       >      >      >      >     second.
>>>>       >      >      >      >
>>>>       >      >      >      >     In examining the code for
>>>>      check_collinearity(), I
>>>>       >      >     discovered a
>>>>       >      >      >      >     couple of
>>>>       >      >      >      >     additional disconcerting facts. First,
>>>>      part of the
>>>>       >      >     code seems
>>>>       >      >      >     to be
>>>>       >      >      >      >     copied from vif.default(). Second, as a
>>>>       >     consequence,
>>>>       >      >      >      >     check_collinearity() actually computes
>>>>      GVIFs rather
>>>>       >      >     than VIFs
>>>>       >      >      >     (and
>>>>       >      >      >      >     doesn't reference either the Fox and
>>>>      Monette paper
>>>>       >      >      >     introducing GVIFs or
>>>>       >      >      >      >     the car package) but doesn't seem to
>>>>      understand
>>>>       >     that, and,
>>>>       >      >      >     for example,
>>>>       >      >      >      >     takes the squareroot of the GVIF
>>>>      (reported in the
>>>>       >      >     column marked
>>>>       >      >      >      >     "Increased SE") rather than the 2p root
>>>>      (when there
>>>>       >      >     are p > 1
>>>>       >      >      >      >     coefficients in a term).
>>>>       >      >      >      >
>>>>       >      >      >      >     Here's the relevant code from the two
>>>>      functions
>>>>       >     (where
>>>>       >      >     . . .
>>>>       >      >      >     denotes
>>>>       >      >      >      >     elided lines) -- the default method for
>>>>      vif() and
>>>>       >      >      >      >     .check_collinearity(),
>>>>       >      >      >      >     which is called by
>>>>      check_collinearity.default():
>>>>       >      >      >      >
>>>>       >      >      >      >     --------- snip -----------
>>>>       >      >      >      >
>>>>       >      >      >      >       > car:::vif.default
>>>>       >      >      >      >     function (mod, ...)
>>>>       >      >      >      >     {
>>>>       >      >      >      >           . . .
>>>>       >      >      >      >           v <- vcov(mod)
>>>>       >      >      >      >           assign <- attr(model.matrix(mod),
>>>>      "assign")
>>>>       >      >      >      >           if (names(coefficients(mod)[1]) ==
>>>>       >     "(Intercept)") {
>>>>       >      >      >      >               v <- v[-1, -1]
>>>>       >      >      >      >               assign <- assign[-1]
>>>>       >      >      >      >           }
>>>>       >      >      >      >           else warning("No intercept: vifs
>>>>      may not be
>>>>       >      >     sensible.")
>>>>       >      >      >      >           terms <- labels(terms(mod))
>>>>       >      >      >      >           n.terms <- length(terms)
>>>>       >      >      >      >           if (n.terms < 2)
>>>>       >      >      >      >               stop("model contains fewer
>>>>      than 2 terms")
>>>>       >      >      >      >           R <- cov2cor(v)
>>>>       >      >      >      >           detR <- det(R)
>>>>       >      >      >      >           . . .
>>>>       >      >      >      >           for (term in 1:n.terms) {
>>>>       >      >      >      >               subs <- which(assign == term)
>>>>       >      >      >      >               result[term, 1] <-
>>>>      det(as.matrix(R[subs,
>>>>       >      >     subs])) *
>>>>       >      >      >      >     det(as.matrix(R[-subs,
>>>>       >      >      >      >                   -subs]))/detR
>>>>       >      >      >      >               result[term, 2] <- length(subs)
>>>>       >      >      >      >           }
>>>>       >      >      >      >           . . .
>>>>       >      >      >      >     }
>>>>       >      >      >      >
>>>>       >      >      >      >       > performance:::.check_collinearity
>>>>       >      >      >      >     function (x, component, verbose = TRUE)
>>>>       >      >      >      >     {
>>>>       >      >      >      >           v <- insight::get_varcov(x,
>>>>      component =
>>>>       >     component,
>>>>       >      >      >     verbose =
>>>>       >      >      >      >     FALSE)
>>>>       >      >      >      >           assign <- .term_assignments(x,
>>>>      component,
>>>>       >     verbose =
>>>>       >      >      >     verbose)
>>>>       >      >      >      >           . . .
>>>>       >      >      >      >           if (insight::has_intercept(x)) {
>>>>       >      >      >      >               v <- v[-1, -1]
>>>>       >      >      >      >               assign <- assign[-1]
>>>>       >      >      >      >           }
>>>>       >      >      >      >           else {
>>>>       >      >      >      >               if (isTRUE(verbose)) {
>>>>       >      >      >      >                   warning("Model has no
>>>>      intercept. VIFs
>>>>       >      >     may not be
>>>>       >      >      >      >     sensible.",
>>>>       >      >      >      >                       call. = FALSE)
>>>>       >      >      >      >               }
>>>>       >      >      >      >           }
>>>>       >      >      >      >               . . .
>>>>       >      >      >      >               terms <-
>>>>       >     labels(stats::terms(f[[component]]))
>>>>       >      >      >      >               . . .
>>>>       >      >      >      >           n.terms <- length(terms)
>>>>       >      >      >      >           if (n.terms < 2) {
>>>>       >      >      >      >               if (isTRUE(verbose)) {
>>>>       >      >      >      >
>>>>       >       warning(insight::format_message(sprintf("Not
>>>>       >      >      >     enough model
>>>>       >      >      >      >     terms in the %s part of the model to
>>>>      check for
>>>>       >      >      >     multicollinearity.",
>>>>       >      >      >      >                       component)), call. =
>>>>      FALSE)
>>>>       >      >      >      >               }
>>>>       >      >      >      >               return(NULL)
>>>>       >      >      >      >           }
>>>>       >      >      >      >           R <- stats::cov2cor(v)
>>>>       >      >      >      >           detR <- det(R)
>>>>       >      >      >      >           . . .
>>>>       >      >      >      >           for (term in 1:n.terms) {
>>>>       >      >      >      >               subs <- which(assign == term)
>>>>       >      >      >      >                   . . .
>>>>       >      >      >      >                   result <- c(result,
>>>>       >      >     det(as.matrix(R[subs, subs])) *
>>>>       >      >      >      >                       det(as.matrix(R[-subs,
>>>>       >     -subs]))/detR)
>>>>       >      >      >      >                   . . .
>>>>       >      >      >      >           }
>>>>       >      >      >      >           . . .
>>>>       >      >      >      >     }
>>>>       >      >      >      >
>>>>       >      >      >      >     --------- snip -----------
>>>>       >      >      >      >
>>>>       >      >      >      >     So, the upshot of all this is that you
>>>>      should
>>>>       >     be able
>>>>       >      >     to do
>>>>       >      >      >     what you
>>>>       >      >      >      >     want, but not with either car::vif() or
>>>>       >      >      >      >     performance::check_collinearity().
>>>>      Instead, either
>>>>       >      >     write your own
>>>>       >      >      >      >     function or do the computations in a
>>> script.
>>>>       >      >      >      >
>>>>       >      >      >      >     There's also a lesson here about S3
>>> default
>>>>       >     methods:
>>>>       >      >     The fact
>>>>       >      >      >     that a
>>>>       >      >      >      >     default method returns a result rather
>>> than
>>>>       >     throwing
>>>>       >      >     an error
>>>>       >      >      >     or a
>>>>       >      >      >      >     warning doesn't mean that the result is
>>> the
>>>>       >     right answer.
>>>>       >      >      >      >
>>>>       >      >      >      >     I hope this helps,
>>>>       >      >      >      >        John
>>>>       >      >      >      >
>>>>       >      >      >      >
>>>>       >      >      >      >     On 2022-02-26 3:45 p.m., Juho Kristian
>>>>      Ruohonen
>>>>       >     wrote:
>>>>       >      >      >      >      > Dear John W,
>>>>       >      >      >      >      >
>>>>       >      >      >      >      > Thank you very much for the tip-off!
>>>>       >     Apologies for not
>>>>       >      >      >     responding
>>>>       >      >      >      >     earlier
>>>>       >      >      >      >      > (gmail apparently decided to direct
>>>>      your email
>>>>       >      >     right into the
>>>>       >      >      >      >     junk folder).
>>>>       >      >      >      >      > I am very pleased to note that the
>>>>      package you
>>>>       >      >     mention does
>>>>       >      >      >      >     indeed work
>>>>       >      >      >      >      > with *brms* multinomial models!
>>>>      Thanks again!
>>>>       >      >      >      >      >
>>>>       >      >      >      >      > Best,
>>>>       >      >      >      >      >
>>>>       >      >      >      >      > Juho
>>>>       >      >      >      >      >
>>>>       >      >      >      >      > pe 25. helmik. 2022 klo 19.23 John
>>>>      Willoughby
>>>>       >      >      >      >     (johnwillec at gmail.com
>>>>      <mailto:johnwillec at gmail.com>
>>>>       >     <mailto:johnwillec at gmail.com <mailto:johnwillec at gmail.com>>
>>>>      <mailto:johnwillec at gmail.com <mailto:johnwillec at gmail.com>
>>>>       >     <mailto:johnwillec at gmail.com <mailto:johnwillec at gmail.com>>>
>>>>       >      >     <mailto:johnwillec at gmail.com
>>>>      <mailto:johnwillec at gmail.com> <mailto:johnwillec at gmail.com
>>>>      <mailto:johnwillec at gmail.com>>
>>>>       >     <mailto:johnwillec at gmail.com <mailto:johnwillec at gmail.com>
>>>>      <mailto:johnwillec at gmail.com <mailto:johnwillec at gmail.com>>>>
>>>>       >      >      >     <mailto:johnwillec at gmail.com
>>>>      <mailto:johnwillec at gmail.com>
>>>>       >     <mailto:johnwillec at gmail.com <mailto:johnwillec at gmail.com>>
>>>>      <mailto:johnwillec at gmail.com <mailto:johnwillec at gmail.com>
>>>>       >     <mailto:johnwillec at gmail.com <mailto:johnwillec at gmail.com>>>
>>>>       >      >     <mailto:johnwillec at gmail.com
>>>>      <mailto:johnwillec at gmail.com> <mailto:johnwillec at gmail.com
>>>>      <mailto:johnwillec at gmail.com>>
>>>>       >     <mailto:johnwillec at gmail.com <mailto:johnwillec at gmail.com>
>>>>      <mailto:johnwillec at gmail.com <mailto:johnwillec at gmail.com>>>>>)
>>>>       >      >      >      >      > kirjoitti:
>>>>       >      >      >      >      >
>>>>       >      >      >      >      >> Have you tried the
>>> check_collinearity()
>>>>       >     function
>>>>       >      >     in the
>>>>       >      >      >     performance
>>>>       >      >      >      >      >> package? It's supposed to work on
>>> brms
>>>>       >     models, but
>>>>       >      >     whether it
>>>>       >      >      >      >     will work on
>>>>       >      >      >      >      >> a multinomial model I don't know.
>>>>      It works
>>>>       >     well
>>>>       >      >     on mixed
>>>>       >      >      >     models
>>>>       >      >      >      >     generated
>>>>       >      >      >      >      >> by glmmTMB().
>>>>       >      >      >      >      >>
>>>>       >      >      >      >      >> John Willoughby
>>>>       >      >      >      >      >>
>>>>       >      >      >      >      >>
>>>>       >      >      >      >      >> On Fri, Feb 25, 2022 at 3:01 AM
>>>>       >      >      >      >
>>>>        <r-sig-mixed-models-request at r-project.org
>>>>      <mailto:r-sig-mixed-models-request at r-project.org>
>>>>       >     <mailto:r-sig-mixed-models-request at r-project.org
>>>>      <mailto:r-sig-mixed-models-request at r-project.org>>
>>>>       >      >     <mailto:r-sig-mixed-models-request at r-project.org
>>>>      <mailto:r-sig-mixed-models-request at r-project.org>
>>>>       >     <mailto:r-sig-mixed-models-request at r-project.org
>>>>      <mailto:r-sig-mixed-models-request at r-project.org>>>
>>>>       >      >      >
>>>>        <mailto:r-sig-mixed-models-request at r-project.org
>>>>      <mailto:r-sig-mixed-models-request at r-project.org>
>>>>       >     <mailto:r-sig-mixed-models-request at r-project.org
>>>>      <mailto:r-sig-mixed-models-request at r-project.org>>
>>>>       >      >     <mailto:r-sig-mixed-models-request at r-project.org
>>>>      <mailto:r-sig-mixed-models-request at r-project.org>
>>>>       >     <mailto:r-sig-mixed-models-request at r-project.org
>>>>      <mailto:r-sig-mixed-models-request at r-project.org>>>>
>>>>       >      >      >      >
>>>>       >       <mailto:r-sig-mixed-models-request at r-project.org
>>>>      <mailto:r-sig-mixed-models-request at r-project.org>
>>>>       >     <mailto:r-sig-mixed-models-request at r-project.org
>>>>      <mailto:r-sig-mixed-models-request at r-project.org>>
>>>>       >      >     <mailto:r-sig-mixed-models-request at r-project.org
>>>>      <mailto:r-sig-mixed-models-request at r-project.org>
>>>>       >     <mailto:r-sig-mixed-models-request at r-project.org
>>>>      <mailto:r-sig-mixed-models-request at r-project.org>>>
>>>>       >      >      >
>>>>        <mailto:r-sig-mixed-models-request at r-project.org
>>>>      <mailto:r-sig-mixed-models-request at r-project.org>
>>>>       >     <mailto:r-sig-mixed-models-request at r-project.org
>>>>      <mailto:r-sig-mixed-models-request at r-project.org>>
>>>>       >      >     <mailto:r-sig-mixed-models-request at r-project.org
>>>>      <mailto:r-sig-mixed-models-request at r-project.org>
>>>>       >     <mailto:r-sig-mixed-models-request at r-project.org
>>>>      <mailto:r-sig-mixed-models-request at r-project.org>>>>>>
>>>>       >      >      >      >      >> wrote:
>>>>       >      >      >      >      >>
>>>>       >      >      >      >      >>> Send R-sig-mixed-models mailing list
>>>>       >     submissions to
>>>>       >      >      >      >      >>> r-sig-mixed-models at r-project.org
>>>>      <mailto:r-sig-mixed-models at r-project.org>
>>>>       >     <mailto:r-sig-mixed-models at r-project.org
>>>>      <mailto:r-sig-mixed-models at r-project.org>>
>>>>       >      >     <mailto:r-sig-mixed-models at r-project.org
>>>>      <mailto:r-sig-mixed-models at r-project.org>
>>>>       >     <mailto:r-sig-mixed-models at r-project.org
>>>>      <mailto:r-sig-mixed-models at r-project.org>>>
>>>>       >      >      >     <mailto:r-sig-mixed-models at r-project.org
>>>>      <mailto:r-sig-mixed-models at r-project.org>
>>>>       >     <mailto:r-sig-mixed-models at r-project.org
>>>>      <mailto:r-sig-mixed-models at r-project.org>>
>>>>       >      >     <mailto:r-sig-mixed-models at r-project.org
>>>>      <mailto:r-sig-mixed-models at r-project.org>
>>>>       >     <mailto:r-sig-mixed-models at r-project.org
>>>>      <mailto:r-sig-mixed-models at r-project.org>>>>
>>>>       >      >      >      >     <mailto:r-sig-mixed-models at r-project.org
>>>>      <mailto:r-sig-mixed-models at r-project.org>
>>>>       >     <mailto:r-sig-mixed-models at r-project.org
>>>>      <mailto:r-sig-mixed-models at r-project.org>>
>>>>       >      >     <mailto:r-sig-mixed-models at r-project.org
>>>>      <mailto:r-sig-mixed-models at r-project.org>
>>>>       >     <mailto:r-sig-mixed-models at r-project.org
>>>>      <mailto:r-sig-mixed-models at r-project.org>>>
>>>>       >      >      >     <mailto:r-sig-mixed-models at r-project.org
>>>>      <mailto:r-sig-mixed-models at r-project.org>
>>>>       >     <mailto:r-sig-mixed-models at r-project.org
>>>>      <mailto:r-sig-mixed-models at r-project.org>>
>>>>       >      >     <mailto:r-sig-mixed-models at r-project.org
>>>>      <mailto:r-sig-mixed-models at r-project.org>
>>>>       >     <mailto:r-sig-mixed-models at r-project.org
>>>>      <mailto:r-sig-mixed-models at r-project.org>>>>>
>>>>       >      >      >      >      >>>
>>>>       >      >      >      >      >>> To subscribe or unsubscribe via the
>>>>      World Wide
>>>>       >      >     Web, visit
>>>>       >      >      >      >      >>>
>>>>       >      > https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>>      <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>>>>       >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>>      <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>
>>>>       >      >
>>>>        <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>>      <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>>>>       >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>>      <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>>
>>>>       >      >      >
>>>>       >       <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>>      <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>>>>       >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>>      <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>
>>>>       >      >
>>>>        <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>>      <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>>>>       >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>>      <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>>>
>>>>       >      >      >      >
>>>>       >      >
>>>>        <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>>      <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>>>>       >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>>      <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>
>>>>       >      >
>>>>        <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>>      <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>>>>       >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>>      <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>>
>>>>       >      >      >
>>>>       >       <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>>      <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>>>>       >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>>      <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>
>>>>       >      >
>>>>        <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>>      <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>>>>       >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>>      <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>>>>
>>>>       >      >      >      >      >>> or, via email, send a message with
>>>>      subject or
>>>>       >      >     body 'help' to
>>>>       >      >      >      >      >>>
>>>>      r-sig-mixed-models-request at r-project.org
>>>>      <mailto:r-sig-mixed-models-request at r-project.org>
>>>>       >     <mailto:r-sig-mixed-models-request at r-project.org
>>>>      <mailto:r-sig-mixed-models-request at r-project.org>>
>>>>       >      >     <mailto:r-sig-mixed-models-request at r-project.org
>>>>      <mailto:r-sig-mixed-models-request at r-project.org>
>>>>       >     <mailto:r-sig-mixed-models-request at r-project.org
>>>>      <mailto:r-sig-mixed-models-request at r-project.org>>>
>>>>       >      >      >
>>>>        <mailto:r-sig-mixed-models-request at r-project.org
>>>>      <mailto:r-sig-mixed-models-request at r-project.org>
>>>>       >     <mailto:r-sig-mixed-models-request at r-project.org
>>>>      <mailto:r-sig-mixed-models-request at r-project.org>>
>>>>       >      >     <mailto:r-sig-mixed-models-request at r-project.org
>>>>      <mailto:r-sig-mixed-models-request at r-project.org>
>>>>       >     <mailto:r-sig-mixed-models-request at r-project.org
>>>>      <mailto:r-sig-mixed-models-request at r-project.org>>>>
>>>>       >      >      >      >
>>>>       >       <mailto:r-sig-mixed-models-request at r-project.org
>>>>      <mailto:r-sig-mixed-models-request at r-project.org>
>>>>       >     <mailto:r-sig-mixed-models-request at r-project.org
>>>>      <mailto:r-sig-mixed-models-request at r-project.org>>
>>>>       >      >     <mailto:r-sig-mixed-models-request at r-project.org
>>>>      <mailto:r-sig-mixed-models-request at r-project.org>
>>>>       >     <mailto:r-sig-mixed-models-request at r-project.org
>>>>      <mailto:r-sig-mixed-models-request at r-project.org>>>
>>>>       >      >      >
>>>>        <mailto:r-sig-mixed-models-request at r-project.org
>>>>      <mailto:r-sig-mixed-models-request at r-project.org>
>>>>       >     <mailto:r-sig-mixed-models-request at r-project.org
>>>>      <mailto:r-sig-mixed-models-request at r-project.org>>
>>>>       >      >     <mailto:r-sig-mixed-models-request at r-project.org
>>>>      <mailto:r-sig-mixed-models-request at r-project.org>
>>>>       >     <mailto:r-sig-mixed-models-request at r-project.org
>>>>      <mailto:r-sig-mixed-models-request at r-project.org>>>>>
>>>>       >      >      >      >      >>>
>>>>       >      >      >      >      >>> You can reach the person managing
>>>>      the list at
>>>>       >      >      >      >      >>>
>>>>      r-sig-mixed-models-owner at r-project.org
>>>>      <mailto:r-sig-mixed-models-owner at r-project.org>
>>>>       >     <mailto:r-sig-mixed-models-owner at r-project.org
>>>>      <mailto:r-sig-mixed-models-owner at r-project.org>>
>>>>       >      >     <mailto:r-sig-mixed-models-owner at r-project.org
>>>>      <mailto:r-sig-mixed-models-owner at r-project.org>
>>>>       >     <mailto:r-sig-mixed-models-owner at r-project.org
>>>>      <mailto:r-sig-mixed-models-owner at r-project.org>>>
>>>>       >      >      >     <mailto:r-sig-mixed-models-owner at r-project.org
>>>>      <mailto:r-sig-mixed-models-owner at r-project.org>
>>>>       >     <mailto:r-sig-mixed-models-owner at r-project.org
>>>>      <mailto:r-sig-mixed-models-owner at r-project.org>>
>>>>       >      >     <mailto:r-sig-mixed-models-owner at r-project.org
>>>>      <mailto:r-sig-mixed-models-owner at r-project.org>
>>>>       >     <mailto:r-sig-mixed-models-owner at r-project.org
>>>>      <mailto:r-sig-mixed-models-owner at r-project.org>>>>
>>>>       >      >      >      >
>>>>        <mailto:r-sig-mixed-models-owner at r-project.org
>>>>      <mailto:r-sig-mixed-models-owner at r-project.org>
>>>>       >     <mailto:r-sig-mixed-models-owner at r-project.org
>>>>      <mailto:r-sig-mixed-models-owner at r-project.org>>
>>>>       >      >     <mailto:r-sig-mixed-models-owner at r-project.org
>>>>      <mailto:r-sig-mixed-models-owner at r-project.org>
>>>>       >     <mailto:r-sig-mixed-models-owner at r-project.org
>>>>      <mailto:r-sig-mixed-models-owner at r-project.org>>>
>>>>       >      >      >     <mailto:r-sig-mixed-models-owner at r-project.org
>>>>      <mailto:r-sig-mixed-models-owner at r-project.org>
>>>>       >     <mailto:r-sig-mixed-models-owner at r-project.org
>>>>      <mailto:r-sig-mixed-models-owner at r-project.org>>
>>>>       >      >     <mailto:r-sig-mixed-models-owner at r-project.org
>>>>      <mailto:r-sig-mixed-models-owner at r-project.org>
>>>>       >     <mailto:r-sig-mixed-models-owner at r-project.org
>>>>      <mailto:r-sig-mixed-models-owner at r-project.org>>>>>
>>>>       >      >      >      >      >>>
>>>>       >      >      >      >      >>> When replying, please edit your
>>> Subject
>>>>       >     line so it is
>>>>       >      >      >     more specific
>>>>       >      >      >      >      >>> than "Re: Contents of
>>>>      R-sig-mixed-models
>>>>       >     digest..."
>>>>       >      >      >      >      >>>
>>>>       >      >      >      >      >>>
>>>>       >      >      >      >      >>> Today's Topics:
>>>>       >      >      >      >      >>>
>>>>       >      >      >      >      >>>     1. Collinearity diagnostics for
>>>>      (mixed)
>>>>       >      >     multinomial
>>>>       >      >      >     models
>>>>       >      >      >      >      >>>        (Juho Kristian Ruohonen)
>>>>       >      >      >      >      >>>
>>>>       >      >      >      >      >>>
>>>>       >      >      >      >
>>>>       >      >      >
>>>>       >      >
>>>>       >
>>>>
>>>   ----------------------------------------------------------------------
>>>>       >      >      >      >      >>>
>>>>       >      >      >      >      >>> Message: 1
>>>>       >      >      >      >      >>> Date: Fri, 25 Feb 2022 10:23:25
>>> +0200
>>>>       >      >      >      >      >>> From: Juho Kristian Ruohonen
>>>>       >      >      >     <juho.kristian.ruohonen at gmail.com
>>>>      <mailto:juho.kristian.ruohonen at gmail.com>
>>>>       >     <mailto:juho.kristian.ruohonen at gmail.com
>>>>      <mailto:juho.kristian.ruohonen at gmail.com>>
>>>>       >      >     <mailto:juho.kristian.ruohonen at gmail.com
>>>>      <mailto:juho.kristian.ruohonen at gmail.com>
>>>>       >     <mailto:juho.kristian.ruohonen at gmail.com
>>>>      <mailto:juho.kristian.ruohonen at gmail.com>>>
>>>>       >      >      >     <mailto:juho.kristian.ruohonen at gmail.com
>>>>      <mailto:juho.kristian.ruohonen at gmail.com>
>>>>       >     <mailto:juho.kristian.ruohonen at gmail.com
>>>>      <mailto:juho.kristian.ruohonen at gmail.com>>
>>>>       >      >     <mailto:juho.kristian.ruohonen at gmail.com
>>>>      <mailto:juho.kristian.ruohonen at gmail.com>
>>>>       >     <mailto:juho.kristian.ruohonen at gmail.com
>>>>      <mailto:juho.kristian.ruohonen at gmail.com>>>>
>>>>       >      >      >      >     <mailto:juho.kristian.ruohonen at gmail.com
>>>>      <mailto:juho.kristian.ruohonen at gmail.com>
>>>>       >     <mailto:juho.kristian.ruohonen at gmail.com
>>>>      <mailto:juho.kristian.ruohonen at gmail.com>>
>>>>       >      >     <mailto:juho.kristian.ruohonen at gmail.com
>>>>      <mailto:juho.kristian.ruohonen at gmail.com>
>>>>       >     <mailto:juho.kristian.ruohonen at gmail.com
>>>>      <mailto:juho.kristian.ruohonen at gmail.com>>>
>>>>       >      >      >     <mailto:juho.kristian.ruohonen at gmail.com
>>>>      <mailto:juho.kristian.ruohonen at gmail.com>
>>>>       >     <mailto:juho.kristian.ruohonen at gmail.com
>>>>      <mailto:juho.kristian.ruohonen at gmail.com>>
>>>>       >      >     <mailto:juho.kristian.ruohonen at gmail.com
>>>>      <mailto:juho.kristian.ruohonen at gmail.com>
>>>>       >     <mailto:juho.kristian.ruohonen at gmail.com
>>>>      <mailto:juho.kristian.ruohonen at gmail.com>>>>>>
>>>>       >      >      >      >      >>> To: John Fox <jfox at mcmaster.ca
>>>>      <mailto:jfox at mcmaster.ca>
>>>>       >     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>
>>>>       >      >     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
>>>>      <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>>
>>>>       >     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
>>>>      <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>
>>>>       >      >     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
>>>>      <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>>>
>>>>       >      >      >     <mailto:jfox at mcmaster.ca
>>>>      <mailto:jfox at mcmaster.ca> <mailto:jfox at mcmaster.ca
>>>>      <mailto:jfox at mcmaster.ca>>
>>>>       >     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
>>>>      <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>>
>>>>       >      >     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
>>>>      <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>
>>>>       >     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
>>>>      <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>>>>>
>>>>       >      >      >      >      >>> Cc:
>>>>      "r-sig-mixed-models at r-project.org
>>>>      <mailto:r-sig-mixed-models at r-project.org>
>>>>       >     <mailto:r-sig-mixed-models at r-project.org
>>>>      <mailto:r-sig-mixed-models at r-project.org>>
>>>>       >      >     <mailto:r-sig-mixed-models at r-project.org
>>>>      <mailto:r-sig-mixed-models at r-project.org>
>>>>       >     <mailto:r-sig-mixed-models at r-project.org
>>>>      <mailto:r-sig-mixed-models at r-project.org>>>
>>>>       >      >      >     <mailto:r-sig-mixed-models at r-project.org
>>>>      <mailto:r-sig-mixed-models at r-project.org>
>>>>       >     <mailto:r-sig-mixed-models at r-project.org
>>>>      <mailto:r-sig-mixed-models at r-project.org>>
>>>>       >      >     <mailto:r-sig-mixed-models at r-project.org
>>>>      <mailto:r-sig-mixed-models at r-project.org>
>>>>       >     <mailto:r-sig-mixed-models at r-project.org
>>>>      <mailto:r-sig-mixed-models at r-project.org>>>>
>>>>       >      >      >      >     <mailto:r-sig-mixed-models at r-project.org
>>>>      <mailto:r-sig-mixed-models at r-project.org>
>>>>       >     <mailto:r-sig-mixed-models at r-project.org
>>>>      <mailto:r-sig-mixed-models at r-project.org>>
>>>>       >      >     <mailto:r-sig-mixed-models at r-project.org
>>>>      <mailto:r-sig-mixed-models at r-project.org>
>>>>       >     <mailto:r-sig-mixed-models at r-project.org
>>>>      <mailto:r-sig-mixed-models at r-project.org>>>
>>>>       >      >      >     <mailto:r-sig-mixed-models at r-project.org
>>>>      <mailto:r-sig-mixed-models at r-project.org>
>>>>       >     <mailto:r-sig-mixed-models at r-project.org
>>>>      <mailto:r-sig-mixed-models at r-project.org>>
>>>>       >      >     <mailto:r-sig-mixed-models at r-project.org
>>>>      <mailto:r-sig-mixed-models at r-project.org>
>>>>       >     <mailto:r-sig-mixed-models at r-project.org
>>>>      <mailto:r-sig-mixed-models at r-project.org>>>>>"
>>>>       >      >      >      >      >>>
>>>>      <r-sig-mixed-models at r-project.org
>>>>      <mailto:r-sig-mixed-models at r-project.org>
>>>>       >     <mailto:r-sig-mixed-models at r-project.org
>>>>      <mailto:r-sig-mixed-models at r-project.org>>
>>>>       >      >     <mailto:r-sig-mixed-models at r-project.org
>>>>      <mailto:r-sig-mixed-models at r-project.org>
>>>>       >     <mailto:r-sig-mixed-models at r-project.org
>>>>      <mailto:r-sig-mixed-models at r-project.org>>>
>>>>       >      >      >     <mailto:r-sig-mixed-models at r-project.org
>>>>      <mailto:r-sig-mixed-models at r-project.org>
>>>>       >     <mailto:r-sig-mixed-models at r-project.org
>>>>      <mailto:r-sig-mixed-models at r-project.org>>
>>>>       >      >     <mailto:r-sig-mixed-models at r-project.org
>>>>      <mailto:r-sig-mixed-models at r-project.org>
>>>>       >     <mailto:r-sig-mixed-models at r-project.org
>>>>      <mailto:r-sig-mixed-models at r-project.org>>>>
>>>>       >      >      >      >     <mailto:r-sig-mixed-models at r-project.org
>>>>      <mailto:r-sig-mixed-models at r-project.org>
>>>>       >     <mailto:r-sig-mixed-models at r-project.org
>>>>      <mailto:r-sig-mixed-models at r-project.org>>
>>>>       >      >     <mailto:r-sig-mixed-models at r-project.org
>>>>      <mailto:r-sig-mixed-models at r-project.org>
>>>>       >     <mailto:r-sig-mixed-models at r-project.org
>>>>      <mailto:r-sig-mixed-models at r-project.org>>>
>>>>       >      >      >     <mailto:r-sig-mixed-models at r-project.org
>>>>      <mailto:r-sig-mixed-models at r-project.org>
>>>>       >     <mailto:r-sig-mixed-models at r-project.org
>>>>      <mailto:r-sig-mixed-models at r-project.org>>
>>>>       >      >     <mailto:r-sig-mixed-models at r-project.org
>>>>      <mailto:r-sig-mixed-models at r-project.org>
>>>>       >     <mailto:r-sig-mixed-models at r-project.org
>>>>      <mailto:r-sig-mixed-models at r-project.org>>>>>>
>>>>       >      >      >      >      >>> Subject: [R-sig-ME] Collinearity
>>>>       >     diagnostics for
>>>>       >      >     (mixed)
>>>>       >      >      >      >     multinomial
>>>>       >      >      >      >      >>>          models
>>>>       >      >      >      >      >>> Message-ID:
>>>>       >      >      >      >      >>>          <
>>>>       >      >      >      >      >>>
>>>>       >      >      >      >
>>>>       >      >      >
>>>>       >      >
>>>>       >
>>>>      CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com
>>>>      <mailto:
>>> CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com>
>>>>       >
>>>>        <mailto:
>>> CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com
>>> <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com
>>>>>
>>>>       >      >
>>>>       >
>>>>        <mailto:
>>> CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com
>>> <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com>
>>> <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com
>>> <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com
>>>>>>
>>>>       >      >      >
>>>>       >      >
>>>>       >
>>>>        <mailto:
>>> CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com
>>> <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com>
>>> <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com
>>> <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com>>
>>> <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com
>>> <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com>
>>> <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com
>>> <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com
>>>>>>>
>>>>       >      >      >      >
>>>>       >      >      >
>>>>       >      >
>>>>       >
>>>>        <mailto:
>>> CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com
>>> <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com>
>>> <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com
>>> <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com>>
>>> <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com
>>> <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com>
>>> <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com
>>> <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com>>>
>>> <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com
>>> <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com>
>>> <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com
>>> <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com>>
>>> <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com
>>> <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com>
>>> <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com
>>> <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com
>>>>>>>>>
>>>>       >      >      >      >      >>> Content-Type: text/plain;
>>>>      charset="utf-8"
>>>>       >      >      >      >      >>>
>>>>       >      >      >      >      >>> Dear John (and anyone else
>>> qualified to
>>>>       >     comment),
>>>>       >      >      >      >      >>>
>>>>       >      >      >      >      >>> I fit lots of mixed-effects
>>> multinomial
>>>>       >     models in my
>>>>       >      >      >     research,
>>>>       >      >      >      >     and I
>>>>       >      >      >      >      >> would
>>>>       >      >      >      >      >>> like to see some (multi)collinearity
>>>>       >     diagnostics
>>>>       >      >     on the
>>>>       >      >      >     fixed
>>>>       >      >      >      >     effects, of
>>>>       >      >      >      >      >>> which there are over 30. My models
>>>>      are fit
>>>>       >     using the
>>>>       >      >      >     Bayesian
>>>>       >      >      >      >     *brms*
>>>>       >      >      >      >      >>> package because I know of no
>>>>      frequentist
>>>>       >     packages
>>>>       >      >     with
>>>>       >      >      >      >     multinomial GLMM
>>>>       >      >      >      >      >>> compatibility.
>>>>       >      >      >      >      >>>
>>>>       >      >      >      >      >>> With continuous or dichotomous
>>>>      outcomes,
>>>>       >     my go-to
>>>>       >      >      >     function for
>>>>       >      >      >      >      >> calculating
>>>>       >      >      >      >      >>> multicollinearity diagnostics is of
>>>>      course
>>>>       >      >     *vif()* from
>>>>       >      >      >     the *car*
>>>>       >      >      >      >      >> package.
>>>>       >      >      >      >      >>> As expected, however, this function
>>>>      does not
>>>>       >      >     report sensible
>>>>       >      >      >      >     diagnostics
>>>>       >      >      >      >      >>> for multinomial models -- not even
>>> for
>>>>       >     standard
>>>>       >      >     ones fit
>>>>       >      >      >     by the
>>>>       >      >      >      >     *nnet*
>>>>       >      >      >      >      >>> package's *multinom()* function.
>>>>      The reason, I
>>>>       >      >     presume, is
>>>>       >      >      >      >     because a
>>>>       >      >      >      >      >>> multinomial model is not really one
>>>>      but C-1
>>>>       >      >     regression
>>>>       >      >      >     models
>>>>       >      >      >      >     (where C
>>>>       >      >      >      >      >> is
>>>>       >      >      >      >      >>> the number of response categories)
>>>>      and the
>>>>       >     *vif()*
>>>>       >      >      >     function is not
>>>>       >      >      >      >      >> designed
>>>>       >      >      >      >      >>> to deal with this scenario.
>>>>       >      >      >      >      >>>
>>>>       >      >      >      >      >>> Therefore, in order to obtain
>>>>      meaningful
>>>>       >     collinearity
>>>>       >      >      >     metrics,
>>>>       >      >      >      >     my present
>>>>       >      >      >      >      >>> plan is to write a simple helper
>>>>      function
>>>>       >     that uses
>>>>       >      >      >     *vif() *to
>>>>       >      >      >      >     calculate
>>>>       >      >      >      >      >>> and present (generalized) variance
>>>>      inflation
>>>>       >      >     metrics for
>>>>       >      >      >     the C-1
>>>>       >      >      >      >      >>> sub-datasets to which the C-1
>>> component
>>>>       >     binomial
>>>>       >      >     models
>>>>       >      >      >     of the
>>>>       >      >      >      >     overall
>>>>       >      >      >      >      >>> multinomial model are fit. In other
>>>>      words, it
>>>>       >      >     will partition
>>>>       >      >      >      >     the data
>>>>       >      >      >      >      >> into
>>>>       >      >      >      >      >>> those C-1 subsets, and then apply
>>>>      *vif()*
>>>>       >     to as
>>>>       >      >     many linear
>>>>       >      >      >      >     regressions
>>>>       >      >      >      >      >>> using a made-up continuous response
>>> and
>>>>       >     the fixed
>>>>       >      >     effects of
>>>>       >      >      >      >     interest.
>>>>       >      >      >      >      >>>
>>>>       >      >      >      >      >>> Does this seem like a sensible
>>>>      approach?
>>>>       >      >      >      >      >>>
>>>>       >      >      >      >      >>> Best,
>>>>       >      >      >      >      >>>
>>>>       >      >      >      >      >>> Juho
>>>>       >      >      >      >      >>>
>>>>       >      >      >      >      >>>
>>>>       >      >      >      >      >>>
>>>>       >      >      >      >      >>
>>>>       >      >      >      >      >>          [[alternative HTML version
>>>>      deleted]]
>>>>       >      >      >      >      >>
>>>>       >      >      >      >      >>
>>>>      _______________________________________________
>>>>       >      >      >      >      >> R-sig-mixed-models at r-project.org
>>>>      <mailto:R-sig-mixed-models at r-project.org>
>>>>       >     <mailto:R-sig-mixed-models at r-project.org
>>>>      <mailto:R-sig-mixed-models at r-project.org>>
>>>>       >      >     <mailto:R-sig-mixed-models at r-project.org
>>>>      <mailto:R-sig-mixed-models at r-project.org>
>>>>       >     <mailto:R-sig-mixed-models at r-project.org
>>>>      <mailto:R-sig-mixed-models at r-project.org>>>
>>>>       >      >      >     <mailto:R-sig-mixed-models at r-project.org
>>>>      <mailto:R-sig-mixed-models at r-project.org>
>>>>       >     <mailto:R-sig-mixed-models at r-project.org
>>>>      <mailto:R-sig-mixed-models at r-project.org>>
>>>>       >      >     <mailto:R-sig-mixed-models at r-project.org
>>>>      <mailto:R-sig-mixed-models at r-project.org>
>>>>       >     <mailto:R-sig-mixed-models at r-project.org
>>>>      <mailto:R-sig-mixed-models at r-project.org>>>>
>>>>       >      >      >      >     <mailto:R-sig-mixed-models at r-project.org
>>>>      <mailto:R-sig-mixed-models at r-project.org>
>>>>       >     <mailto:R-sig-mixed-models at r-project.org
>>>>      <mailto:R-sig-mixed-models at r-project.org>>
>>>>       >      >     <mailto:R-sig-mixed-models at r-project.org
>>>>      <mailto:R-sig-mixed-models at r-project.org>
>>>>       >     <mailto:R-sig-mixed-models at r-project.org
>>>>      <mailto:R-sig-mixed-models at r-project.org>>>
>>>>       >      >      >     <mailto:R-sig-mixed-models at r-project.org
>>>>      <mailto:R-sig-mixed-models at r-project.org>
>>>>       >     <mailto:R-sig-mixed-models at r-project.org
>>>>      <mailto:R-sig-mixed-models at r-project.org>>
>>>>       >      >     <mailto:R-sig-mixed-models at r-project.org
>>>>      <mailto:R-sig-mixed-models at r-project.org>
>>>>       >     <mailto:R-sig-mixed-models at r-project.org
>>>>      <mailto:R-sig-mixed-models at r-project.org>>>>> mailing list
>>>>       >      >      >      >      >>
>>>>       >      > https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>>      <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>>>>       >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>>      <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>
>>>>       >      >
>>>>        <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>>      <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>>>>       >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>>      <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>>
>>>>       >      >      >
>>>>       >       <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>>      <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>>>>       >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>>      <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>
>>>>       >      >
>>>>        <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>>      <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>>>>       >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>>      <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>>>
>>>>       >      >      >      >
>>>>       >      >
>>>>        <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>>      <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>>>>       >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>>      <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>
>>>>       >      >
>>>>        <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>>      <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>>>>       >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>>      <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>>
>>>>       >      >      >
>>>>       >       <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>>      <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>>>>       >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>>      <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>
>>>>       >      >
>>>>        <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>>      <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>>>>       >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>>      <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>>>>
>>>>       >      >      >      >      >>
>>>>       >      >      >      >      >
>>>>       >      >      >      >      >       [[alternative HTML version
>>>>      deleted]]
>>>>       >      >      >      >      >
>>>>       >      >      >      >      >
>>>>      _______________________________________________
>>>>       >      >      >      >      > R-sig-mixed-models at r-project.org
>>>>      <mailto:R-sig-mixed-models at r-project.org>
>>>>       >     <mailto:R-sig-mixed-models at r-project.org
>>>>      <mailto:R-sig-mixed-models at r-project.org>>
>>>>       >      >     <mailto:R-sig-mixed-models at r-project.org
>>>>      <mailto:R-sig-mixed-models at r-project.org>
>>>>       >     <mailto:R-sig-mixed-models at r-project.org
>>>>      <mailto:R-sig-mixed-models at r-project.org>>>
>>>>       >      >      >     <mailto:R-sig-mixed-models at r-project.org
>>>>      <mailto:R-sig-mixed-models at r-project.org>
>>>>       >     <mailto:R-sig-mixed-models at r-project.org
>>>>      <mailto:R-sig-mixed-models at r-project.org>>
>>>>       >      >     <mailto:R-sig-mixed-models at r-project.org
>>>>      <mailto:R-sig-mixed-models at r-project.org>
>>>>       >     <mailto:R-sig-mixed-models at r-project.org
>>>>      <mailto:R-sig-mixed-models at r-project.org>>>>
>>>>       >      >      >      >     <mailto:R-sig-mixed-models at r-project.org
>>>>      <mailto:R-sig-mixed-models at r-project.org>
>>>>       >     <mailto:R-sig-mixed-models at r-project.org
>>>>      <mailto:R-sig-mixed-models at r-project.org>>
>>>>       >      >     <mailto:R-sig-mixed-models at r-project.org
>>>>      <mailto:R-sig-mixed-models at r-project.org>
>>>>       >     <mailto:R-sig-mixed-models at r-project.org
>>>>      <mailto:R-sig-mixed-models at r-project.org>>>
>>>>       >      >      >     <mailto:R-sig-mixed-models at r-project.org
>>>>      <mailto:R-sig-mixed-models at r-project.org>
>>>>       >     <mailto:R-sig-mixed-models at r-project.org
>>>>      <mailto:R-sig-mixed-models at r-project.org>>
>>>>       >      >     <mailto:R-sig-mixed-models at r-project.org
>>>>      <mailto:R-sig-mixed-models at r-project.org>
>>>>       >     <mailto:R-sig-mixed-models at r-project.org
>>>>      <mailto:R-sig-mixed-models at r-project.org>>>>> mailing list
>>>>       >      >      >      >      >
>>>>       >      > https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>>      <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>>>>       >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>>      <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>
>>>>       >      >
>>>>        <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>>      <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>>>>       >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>>      <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>>
>>>>       >      >      >
>>>>       >       <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>>      <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>>>>       >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>>      <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>
>>>>       >      >
>>>>        <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>>      <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>>>>       >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>>      <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>>>
>>>>       >      >      >      >
>>>>       >      >
>>>>        <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>>      <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>>>>       >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>>      <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>
>>>>       >      >
>>>>        <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>>      <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>>>>       >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>>      <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>>
>>>>       >      >      >
>>>>       >       <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>>      <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>>>>       >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>>      <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>
>>>>       >      >
>>>>        <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>>      <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>>>>       >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>>      <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>>>>
>>>>       >      >      >      >     --
>>>>       >      >      >      >     John Fox, Professor Emeritus
>>>>       >      >      >      >     McMaster University
>>>>       >      >      >      >     Hamilton, Ontario, Canada
>>>>       >      >      >      >     web:
>>>>      https://socialsciences.mcmaster.ca/jfox/
>>>>      <https://socialsciences.mcmaster.ca/jfox/>
>>>>       >     <https://socialsciences.mcmaster.ca/jfox/
>>>>      <https://socialsciences.mcmaster.ca/jfox/>>
>>>>       >      >     <https://socialsciences.mcmaster.ca/jfox/
>>>>      <https://socialsciences.mcmaster.ca/jfox/>
>>>>       >     <https://socialsciences.mcmaster.ca/jfox/
>>>>      <https://socialsciences.mcmaster.ca/jfox/>>>
>>>>       >      >      >     <https://socialsciences.mcmaster.ca/jfox/
>>>>      <https://socialsciences.mcmaster.ca/jfox/>
>>>>       >     <https://socialsciences.mcmaster.ca/jfox/
>>>>      <https://socialsciences.mcmaster.ca/jfox/>>
>>>>       >      >     <https://socialsciences.mcmaster.ca/jfox/
>>>>      <https://socialsciences.mcmaster.ca/jfox/>
>>>>       >     <https://socialsciences.mcmaster.ca/jfox/
>>>>      <https://socialsciences.mcmaster.ca/jfox/>>>>
>>>>       >      >      >      >
>>>>        <https://socialsciences.mcmaster.ca/jfox/
>>>>      <https://socialsciences.mcmaster.ca/jfox/>
>>>>       >     <https://socialsciences.mcmaster.ca/jfox/
>>>>      <https://socialsciences.mcmaster.ca/jfox/>>
>>>>       >      >     <https://socialsciences.mcmaster.ca/jfox/
>>>>      <https://socialsciences.mcmaster.ca/jfox/>
>>>>       >     <https://socialsciences.mcmaster.ca/jfox/
>>>>      <https://socialsciences.mcmaster.ca/jfox/>>>
>>>>       >      >      >     <https://socialsciences.mcmaster.ca/jfox/
>>>>      <https://socialsciences.mcmaster.ca/jfox/>
>>>>       >     <https://socialsciences.mcmaster.ca/jfox/
>>>>      <https://socialsciences.mcmaster.ca/jfox/>>
>>>>       >      >     <https://socialsciences.mcmaster.ca/jfox/
>>>>      <https://socialsciences.mcmaster.ca/jfox/>
>>>>       >     <https://socialsciences.mcmaster.ca/jfox/
>>>>      <https://socialsciences.mcmaster.ca/jfox/>>>>>
>>>>       >      >      >      >
>>>>       >      >      >     --
>>>>       >      >      >     John Fox, Professor Emeritus
>>>>       >      >      >     McMaster University
>>>>       >      >      >     Hamilton, Ontario, Canada
>>>>       >      >      >     web: https://socialsciences.mcmaster.ca/jfox/
>>>>      <https://socialsciences.mcmaster.ca/jfox/>
>>>>       >     <https://socialsciences.mcmaster.ca/jfox/
>>>>      <https://socialsciences.mcmaster.ca/jfox/>>
>>>>       >      >     <https://socialsciences.mcmaster.ca/jfox/
>>>>      <https://socialsciences.mcmaster.ca/jfox/>
>>>>       >     <https://socialsciences.mcmaster.ca/jfox/
>>>>      <https://socialsciences.mcmaster.ca/jfox/>>>
>>>>       >      >      >     <https://socialsciences.mcmaster.ca/jfox/
>>>>      <https://socialsciences.mcmaster.ca/jfox/>
>>>>       >     <https://socialsciences.mcmaster.ca/jfox/
>>>>      <https://socialsciences.mcmaster.ca/jfox/>>
>>>>       >      >     <https://socialsciences.mcmaster.ca/jfox/
>>>>      <https://socialsciences.mcmaster.ca/jfox/>
>>>>       >     <https://socialsciences.mcmaster.ca/jfox/
>>>>      <https://socialsciences.mcmaster.ca/jfox/>>>>
>>>>       >      >      >
>>>>       >      >     --
>>>>       >      >     John Fox, Professor Emeritus
>>>>       >      >     McMaster University
>>>>       >      >     Hamilton, Ontario, Canada
>>>>       >      >     web: https://socialsciences.mcmaster.ca/jfox/
>>>>      <https://socialsciences.mcmaster.ca/jfox/>
>>>>       >     <https://socialsciences.mcmaster.ca/jfox/
>>>>      <https://socialsciences.mcmaster.ca/jfox/>>
>>>>       >      >     <https://socialsciences.mcmaster.ca/jfox/
>>>>      <https://socialsciences.mcmaster.ca/jfox/>
>>>>       >     <https://socialsciences.mcmaster.ca/jfox/
>>>>      <https://socialsciences.mcmaster.ca/jfox/>>>
>>>>       >      >
>>>>       >
>>>>
>>>   ------------------------------------------------------------------------
>>>>       >     --
>>>>       >     John Fox, Professor Emeritus
>>>>       >     McMaster University
>>>>       >     Hamilton, Ontario, Canada
>>>>       >     web: https://socialsciences.mcmaster.ca/jfox/
>>>>      <https://socialsciences.mcmaster.ca/jfox/>
>>>>       >     <https://socialsciences.mcmaster.ca/jfox/
>>>>      <https://socialsciences.mcmaster.ca/jfox/>>
>>>>       >
>>>>      --
>>>>      John Fox, Professor Emeritus
>>>>      McMaster University
>>>>      Hamilton, Ontario, Canada
>>>>      web: https://socialsciences.mcmaster.ca/jfox/
>>>>      <https://socialsciences.mcmaster.ca/jfox/>
>>>>
>>> --
>>> John Fox, Professor Emeritus
>>> McMaster University
>>> Hamilton, Ontario, Canada
>>> web: https://socialsciences.mcmaster.ca/jfox/
>>>
>>>
>>
>> 	[[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-mixed-models at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>


From juho@kr|@t|@n@ruohonen @end|ng |rom gm@||@com  Thu Feb  2 22:08:24 2023
From: juho@kr|@t|@n@ruohonen @end|ng |rom gm@||@com (Juho Kristian Ruohonen)
Date: Thu, 2 Feb 2023 23:08:24 +0200
Subject: [R-sig-ME] 
 Collinearity diagnostics for (mixed) multinomial models
In-Reply-To: <6ffe007d-b9f4-5fd1-87f9-152697012047@mcmaster.ca>
References: <mailman.19600.5.1645786802.52378.r-sig-mixed-models@r-project.org>
 <24314_1645908336_21QKjZ8b017357_CAG_dBVfdOZmbLRsWOQ5f28Y32ZMtDsOVE2-6FZmUaQ0H8f0+EQ@mail.gmail.com>
 <ec746b24-eb5b-5579-2b24-3c3b492d55d9@mcmaster.ca>
 <CAG_dBVfcpzW5RAs9syWFdL+RvryeAppowexjX_a9zJqRu+PC4Q@mail.gmail.com>
 <7e05d26d-e8af-aa48-8fd4-543c9f3dc3a2@mcmaster.ca>
 <CAG_dBVenhHeF5-hmA7M6xfD2FAeLmqzwc6AL-xrVREZuKyyKpA@mail.gmail.com>
 <67a63dca-f3c0-d766-0a2a-bad1a5fed9c3@mcmaster.ca>
 <CAG_dBVcv+12Q6_dSdX7_2cBPR5PgQmJ5bqZgQoWh88ATCmT6GA@mail.gmail.com>
 <0f03187e-d848-ea43-e370-ead2d403b530@mcmaster.ca>
 <CAG_dBVfv2-8Z0VRvcK4QUP97oh5jOhPd2d=LUj0N_6Ec+appMw@mail.gmail.com>
 <f80557f3-35c7-7b22-ae9c-2f14ff0d7ac0@mcmaster.ca>
 <CAG_dBVe7f5aEB_hA5t-j2u9ZJw-bDQPOchxc3-QTX3VejqXQSQ@mail.gmail.com>
 <d8c397b8-fbec-6c39-fdf5-5047daf6f219@mcmaster.ca>
 <CAG_dBVc2Vw6mQ17ZvXM+vJvvON9D=jHsXp+_3gM7m1zukNAAuQ@mail.gmail.com>
 <dfd31e31-511c-73c0-a8a4-dfc2a3e37b20@phillipalday.com>
 <6ffe007d-b9f4-5fd1-87f9-152697012047@mcmaster.ca>
Message-ID: <CAG_dBVfUCfbVTpNjGRrn6pMjPw+_z_diy10pgy5dqnqvJsPz2Q@mail.gmail.com>

Many thanks to John and Philip (and Georges behind the scenes). I'll keep
an eye on this thread. If there's a solution before my thesis goes to
print, I'll certainly adopt it posthaste.

Otherwise, I might just end up reporting all C-1 GVIF^(1/(2*DF)) statistics
for each binary subregression for each predictor, as calculated by
car::vif(). It's a bit messy, but then multinomial models themselves are
messy with their C-1 sets of coefficients, and this would be no different.
At least it's maximally transparent.

That said, I hope our experts reach a breakthrough.

Best,

Juho





ke 1. helmik. 2023 klo 18.19 John Fox (jfox at mcmaster.ca) kirjoitti:

> Dear Phillip (and Juho),
>
> You raise a reasonable point but, unfortunately, one that isn't really
> relevant to the problem at hand.
>
> Applied to a linear model, which is the context in which generalized
> variance inflation was originally defined in the paper by me and Georges
> Monette cited in ?car::vif, the GVIF *is* invariant with respect to
> inessential changes to the model such as centering regressors or any
> change in the bases for the regressor subspaces of terms in the model.
> The GVIF compares the size of the joint confidence region for the set of
> coefficients for a term in the model to its size in a utopian situation
> in which the subspace for the term is orthogonal to the subspaces of the
> other terms, and reduces to the usual VIF when the term in one-dimensional.
>
> Generalized variance inflation has subsequently been extended to some
> other regression models, such as generalized linear models, and it
> retains these essential invariances (although interpretation isn't as
> straightforward).
>
> In response to Juho's original question, I conjectured an extension to
> multinomial logit models, tested some of its invariance properties, but
> unfortunately didn't test sufficiently extensively. (I did suggest
> additional tests that I didn't perform.) It's clear from Juho's example
> that my conjecture was wrong.
>
> The reason that I hadn't yet responded to Juho's recent question is that
> Georges and I are still trying to understand why my proposed definition
> fails for multinomial logit models. It appears to work, for example, for
> multivariate linear models. Neither of us, at this point, has a solution
> to Juho's problem, and it's possible that there isn't one. We're
> continuing to discuss the problem, and one of us will post an update to
> the list if we come up with either a solution or a clear explanation of
> why my proposal failed.
>
> Thank you for prompting me to reply, if only in a preliminary manner.
>
> Best,
>   John
>
> --
> John Fox, Professor Emeritus
> McMaster University
> Hamilton, Ontario, Canada
> web: https://socialsciences.mcmaster.ca/jfox/
>
> On 2023-02-01 12:19 a.m., Phillip Alday wrote:
> > I haven't seen an answer go by yet, but here's a breadcrumb:
> >
> > Iacobucci, D., Schneider, M.J., Popovich, D.L. et al. Mean centering
> > helps alleviate ?micro? but not ?macro? multicollinearity. Behav Res 48,
> > 1308?1317 (2016). https://doi.org/10.3758/s13428-015-0624-x
> >
> >
> >
> > On 26/1/23 8:56 am, Juho Kristian Ruohonen wrote:
> >> Dear all,
> >>
> >> I'm resurrecting this thread because a problem has come up which might
> need
> >> fixing once someone gets around to writing a relevant R package.
> >>
> >> In this same thread last March, John Fox showed me how to compute GVIFs
> for
> >> a *nnet* multinomial model. I then wrote a simple function that loops
> >> through all predictors in such a model and applies John's code to them,
> >> returning the GVIF, DF, and GVIF^(1/(2*Df)) statistic for each
> predictor.
> >> Available here
> >> <https://github.com/jkruohon/StatsMisc/blob/main/gvif_multinom.R>, the
> >> function seems to work just fine, reproducing John's results exactly on
> the
> >> carData examples. Likewise, applying this function to my own research
> data
> >> yielded entirely plausible results.
> >>
> >> But to my horror, I now discover that *when I refit my multinomial model
> >> with two quantitative predictors centered, the GVIF statistics change
> >> considerably** -- *even though the model has the same fit and virtually
> >> identical coefficients (except for the intercepts) as the original one.
> How
> >> can this be? The only thing that changes between the two models is the
> set
> >> of intercepts which, moreover, are specifically excluded from the GVIF
> >> calculations.
> >>
> >> Below is a minimal example. The anonymized datafile is downloadable here
> >> <https://github.com/jkruohon/StatsMisc/raw/main/d_anon.RData>.
> >>
> >>> mod1 <- multinom(y ~., data = d.anon, maxit = 999)
> >>> gvif.multinom(mod1) # x6 and x26 top the collinearity list
> >>              GVIF DF GVIF^(1/(2df))
> >> x6  3.463522e+03  3       3.889732
> >> x26 2.988396e+03  3       3.795244
> >> x27 1.390830e+03  3       3.341019
> >> x2  3.889656e+02  3       2.701792
> >> x13 2.930026e+02  3       2.577183
> >> x19 2.051250e+04  6       2.287362
> >> x25 7.043339e+03  6       2.092417
> >> x24 1.078212e+07 12       1.963493
> >> x9  2.357662e+01  3       1.693351
> >> x17 1.991744e+01  3       1.646413
> >> x5  3.869759e+02  6       1.643010
> >> x12 1.787075e+01  3       1.616927
> >> x18 2.943991e+02  6       1.605997
> >> x1  2.700175e+03  9       1.551075
> >> x16 2.576739e+04 12       1.526844
> >> x7  1.483341e+02  6       1.516829
> >> x20 1.159374e+01  3       1.504425
> >> x3  1.612637e+04 12       1.497318
> >> x28 1.081693e+01  3       1.487136
> >> x10 9.706880e+00  3       1.460539
> >> x22 9.459035e+00  3       1.454257
> >> x15 9.124519e+00  3       1.445556
> >> x14 7.017242e+00  3       1.383655
> >> x21 6.404687e+00  3       1.362750
> >> x8  6.072614e+00  3       1.350712
> >> x11 4.797251e+00  3       1.298670
> >> x4  3.665742e+03 18       1.256043
> >> x23 3.557201e+00  3       1.235525
> >>
> >> Now we refit the model with the quantitative predictors x6 and x26
> centered:
> >>
> >>> d.anon$x6 <- d.anon$x6 - mean(d.anon$x6)
> >>> d.anon$x26 <- d.anon$x26 - mean(d.anon$x26)
> >>> mod2 <- update(mod1, data = d.anon, maxit = 999)
> >>> c(logLik(mod1), logLik(mod2))  # same fit to the data
> >> [1] -2074.133 -2074.134
> >>
> >>> gvif.multinom(mod2)
> >>              GVIF DF GVIF^(1/(2df))
> >> x2  6.196959e+04  3       6.290663
> >> x13 3.031115e+04  3       5.583850
> >> x27 2.552811e+04  3       5.426291
> >> x14 1.642231e+04  3       5.041646
> >> x6  1.573721e+04  3       5.005967
> >> x26 1.464437e+04  3       4.946277
> >> x9  1.262667e+04  3       4.825564
> >> x10 5.714321e+03  3       4.228251
> >> x19 2.255013e+07  6       4.099798
> >> x25 1.227033e+07  6       3.897068
> >> x12 3.394139e+03  3       3.876635
> >> x15 1.938364e+03  3       3.531067
> >> x11 1.685265e+03  3       3.449674
> >> x21 8.429450e+02  3       3.073500
> >> x23 7.639755e+02  3       3.023523
> >> x22 6.887451e+02  3       2.971733
> >> x17 5.640312e+02  3       2.874422
> >> x20 3.855848e+02  3       2.697864
> >> x24 1.444083e+10 12       2.650430
> >> x7  7.148911e+04  6       2.538166
> >> x18 1.674603e+04  6       2.249017
> >> x5  9.662266e+03  6       2.148275
> >> x16 6.264044e+07 12       2.112851
> >> x1  6.634544e+05  9       2.105882
> >> x3  1.558132e+07 12       1.993847
> >> x8  6.168472e+01  3       1.987755
> >> x4  4.256459e+06 18       1.528059
> >> x28 9.783234e+00  3       1.462448
> >>
> >> And so I'm at my wits' end. The models are virtually identical, yet the
> >> GVIF statistics are very different. I don't know which ones to trust.
> >> Worse, the discrepancy makes me disinclined to trust either of them --
> >> which is a return to Square One, i.e. the situation where GVIF
> statistics
> >> for multinomial models did not exist. And I don't know which
> >> multicollinearity metric I can present in my thesis, if any.
> >>
> >> I hope someone can help.
> >>
> >> Best,
> >>
> >> Juho
> >>
> >>
> >>
> >>
> >>
> >> ke 2. maalisk. 2022 klo 16.35 John Fox (jfox at mcmaster.ca) kirjoitti:
> >>
> >>> Dear Juho,
> >>>
> >>> On 2022-03-02 6:23 a.m., Juho Kristian Ruohonen wrote:
> >>>> One last comment, John: Sorry if I seemed to be implying that you (or
> >>>> anyone else) should debug my code for me. That wasn't the idea. I do
> >>>> believe that the function locates the intended rows/columns
> >>>> successfully. I just wasn't entirely positive what those intended
> >>>> rows/columns should be when dealing with a multicategory factor.
> >>>> Presently, it locates every row/column involving the multicategory
> >>>> factor in question, so the number of rows/columns identified is the
> >>>> number of factor levels minus one, times the number of response
> >>>> categories minus one. I hope that's correct.
> >>>
> >>> OK, that's a fair remark. Yes, what you describe is correct.
> >>>
> >>> You can also reassure yourself that your function is working properly
> by:
> >>>
> >>> (1) If you haven't already done so, show that you get the same GVIFs
> >>> from your function as from the one I sent you used directly.
> >>>
> >>> (2) Vary the baseline level of the response variable and confirm that
> >>> you get the same GVIFs.
> >>>
> >>> (3) Vary the basis for the regressor subspace for a factor, e.g.,
> either
> >>> by using contr.sum() in place of the default contr.treatment() or by
> >>> changing the baseline level of the factor for contr.treatment(), and
> >>> again confirm that the GVIFs are unchanged.
> >>>
> >>> Best,
> >>>    John
> >>>
> >>>>
> >>>> My current plan is to present the output of the new function in my
> >>>> thesis and credit you for the math. But if *vif()* gets a relevant
> >>>> update before my project is finished, then I'll use that and cite the
> >>>> /car /package instead.
> >>>>
> >>>> Thanks again for your help.
> >>>>
> >>>> Best,
> >>>>
> >>>> Juho
> >>>>
> >>>> ti 1. maalisk. 2022 klo 23.54 John Fox (jfox at mcmaster.ca
> >>>> <mailto:jfox at mcmaster.ca>) kirjoitti:
> >>>>
> >>>>      Dear Juho,
> >>>>
> >>>>      On 2022-03-01 3:13 p.m., Juho Kristian Ruohonen wrote:
> >>>>       > Dear John,
> >>>>       >
> >>>>       > Yes, my function uses your code for the math. I was just
> hoping to
> >>>>       > verify that it is handling multicategory factors correctly
> (your
> >>>>       > examples didn't involve any).
> >>>>
> >>>>      That's not really my point. Your code sets up computations for
> the
> >>>>      various terms in the model automatically, while the function I
> sent
> >>>>      requires that you locate the rows/columns for the intercepts and
> each
> >>>>      focal term manually. If you haven't already done so, you could
> check
> >>>>      that your function is identifying the correct columns and
> getting the
> >>>>      corresponding GVIFs.
> >>>>
> >>>>       >
> >>>>       > I guess interactions aren't that important after all, given
> that
> >>> the
> >>>>       > chief concern is usually collinearity among main effects.
> >>>>
> >>>>      I wouldn't say that, but it's not clear what collinearity means
> in
> >>>>      models with interactions, and if you compute VIFs or GVIFs for
> "main
> >>>>      effects" in models with interactions, you'll probably get
> nonsense.
> >>>>
> >>>>      As I said, I think that this might be a solvable problem, but one
> >>> that
> >>>>      requires thought about what needs to remain invariant.
> >>>>
> >>>>      I think that we've probably come to end for now.
> >>>>
> >>>>      John
> >>>>
> >>>>       >
> >>>>       > Many thanks for all your help.
> >>>>       >
> >>>>       > Best,
> >>>>       >
> >>>>       > Juho
> >>>>       >
> >>>>       > ti 1. maalisk. 2022 klo 18.01 John Fox (jfox at mcmaster.ca
> >>>>      <mailto:jfox at mcmaster.ca>
> >>>>       > <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>)
> kirjoitti:
> >>>>       >
> >>>>       >     Dear Juho,
> >>>>       >
> >>>>       >     On 2022-03-01 8:24 a.m., Juho Kristian Ruohonen wrote:
> >>>>       >      > Dear John (Fox, as well as other list members),
> >>>>       >      >
> >>>>       >      > I've now written a simple function to try and calculate
> >>>>      GVIFS for
> >>>>       >     all
> >>>>       >      > predictors in a nnet::multinom() object based on John's
> >>>>      example
> >>>>       >     code. If
> >>>>       >      > its results are correct (see below), I will proceed to
> >>> write a
> >>>>       >     version
> >>>>       >      > that also works with mixed-effects multinomial models
> fit
> >>> by
> >>>>       >      > brms::brm(). Here's the code:
> >>>>       >      >
> >>>>       >      >     gvif.multinom <- function(model){
> >>>>       >      >        (classes <- model$lev)
> >>>>       >      >        (V.all <- vcov(model))
> >>>>       >      >        (V.noIntercepts <-
> V.all[!grepl("\\(Intercept\\)$",
> >>>>       >      >     rownames(V.all), perl = T),
> >>>>       >      >
>  !grepl("\\(Intercept\\)$",
> >>>>       >      >     colnames(V.all), perl = T)])
> >>>>       >      >        (R <- cov2cor(V.noIntercepts))
> >>>>       >      >        (terms <- attr(model$terms, "term.labels"))
> >>>>       >      >        (gvif <- numeric(length = length(terms)))
> >>>>       >      >        (names(gvif) <- terms)
> >>>>       >      >        (SE.multiplier <- numeric(length =
> length(terms)))
> >>>>       >      >        (names(SE.multiplier) <- terms)
> >>>>       >      >        #The line below tries to capture all factor
> levels
> >>>>      into a
> >>>>       >     regex
> >>>>       >      >     for coef name matching.
> >>>>       >      >        (LevelsRegex <- paste0("(",
> >>>>      paste(unlist(model$xlevels),
> >>>>       >     collapse
> >>>>       >      >     = "|"),")?"))
> >>>>       >      >
> >>>>       >      >        for(i in terms){
> >>>>       >      >          #The regex stuff below tries to ensure all
> >>>>      interaction
> >>>>       >      >     coefficients are matched, including those involving
> >>>>      factors.
> >>>>       >      >          if(grepl(":", i)){
> >>>>       >      >            (termname <- gsub(":", paste0(LevelsRegex,
> >>> ":"), i,
> >>>>       >     perl = T))
> >>>>       >      >          }else{termname <- i}
> >>>>       >      >          (RegexToMatch <- paste0("^(",
> >>>>       >     paste(classes[2:length(classes)],
> >>>>       >      >     collapse = "|") ,"):", termname, LevelsRegex, "$"))
> >>>>       >      >
> >>>>       >      >          #Now the actual calculation:
> >>>>       >      >          (indices <- grep(RegexToMatch, rownames(R),
> perl
> >>>>      = T))
> >>>>       >      >          (gvif[i] <- det(R[indices, indices]) *
> >>>>      det(R[-indices,
> >>>>       >      >     -indices]) / det(R))
> >>>>       >      >          (SE.multiplier[i] <-
> >>> gvif[i]^(1/(2*length(indices))))
> >>>>       >      >        }
> >>>>       >      >        #Put the results together and order them by
> degree
> >>>>      of SE
> >>>>       >     inflation:
> >>>>       >      >        (result <- cbind(GVIF = gvif, `GVIF^(1/(2df))` =
> >>>>       >     SE.multiplier))
> >>>>       >      >        return(result[order(result[,"GVIF^(1/(2df))"],
> >>>>      decreasing
> >>>>       >     = T),])}
> >>>>       >      >
> >>>>       >      >
> >>>>       >      > The results seem correct to me when applied to John's
> >>> example
> >>>>       >     model fit
> >>>>       >      > to the BEPS data. However, that dataset contains no
> >>> multi-df
> >>>>       >     factors, of
> >>>>       >      > which my own models have many. Below is a maximally
> simple
> >>>>       >     example with
> >>>>       >      > one multi-df factor (/region/):
> >>>>       >      >
> >>>>       >      >     mod1 <- multinom(partic ~., data =
> carData::Womenlf)
> >>>>       >      >     gvif.multinom(mod1)
> >>>>       >      >
> >>>>       >      >     GVIF GVIF^(1/(2df))
> >>>>       >      >     children 1.298794       1.067542
> >>>>       >      >     hincome  1.184215       1.043176
> >>>>       >      >     region   1.381480       1.020403
> >>>>       >      >
> >>>>       >      >
> >>>>       >      > These results look plausible to me. Finally, below is
> an
> >>>>      example
> >>>>       >      > involving both a multi-df factor and an interaction:
> >>>>       >      >
> >>>>       >      >     mod2 <- update(mod1, ~. +children:region)
> >>>>       >      >     gvif.multinom(mod2)
> >>>>       >      >
> >>>>       >      >                              GVIF GVIF^(1/(2df))
> >>>>       >      >     children:region 4.965762e+16      11.053482
> >>>>       >      >     region          1.420418e+16      10.221768
> >>>>       >      >     children        1.471412e+03       6.193463
> >>>>       >      >     hincome         6.462161e+00       1.594390
> >>>>       >      >
> >>>>       >      >
> >>>>       >      > These results look a bit more dubious. To be sure, it
> is
> >>> to be
> >>>>       >     expected
> >>>>       >      > that interaction terms will introduce a lot of
> >>>>      collinearity. But an
> >>>>       >      > 11-fold increase in SE? I hope someone can tell me
> whether
> >>>>      this is
> >>>>       >      > correct or not!
> >>>>       >
> >>>>       >     You don't need someone else to check your work because you
> >>>>      could just
> >>>>       >     apply the simple function that I sent you yesterday,
> which,
> >>>>      though not
> >>>>       >     automatic, computes the GVIFs in a transparent manner.
> >>>>       >
> >>>>       >     A brief comment on GVIFs for models with interactions
> (this
> >>>>      isn't the
> >>>>       >     place to discuss the question in detail): The Fox and
> Monette
> >>>>      JASA
> >>>>       >     paper
> >>>>       >     addresses the question briefly in the context of a two-way
> >>>>      ANOVA, but I
> >>>>       >     don't think that the approach suggested there is easily
> >>>>      generalized.
> >>>>       >
> >>>>       >     The following simple approach pays attention to what's
> >>>>      invariant under
> >>>>       >     different parametrizations of the RHS side of the model:
> >>>>      Simultaneously
> >>>>       >     check the collinearity of all of the coefficients of an
> >>>>      interaction
> >>>>       >     together with the main effects and, potentially,
> lower-order
> >>>>       >     interactions that are marginal to it. So, e.g., in the
> model
> >>>>      y ~ a +
> >>>>       >     b +
> >>>>       >     a:b + c, you'd check all of the coefficients for a, b, and
> >>>>      a:b together.
> >>>>       >
> >>>>       >     Alternatively, one could focus in turn on each explanatory
> >>>>      variable and
> >>>>       >     check the collinearity of all coefficients to which it is
> >>>>      marginal. So
> >>>>       >     in y ~ a + b + c + a:b + a:c + d, when you focus on a,
> you'd
> >>>>      look at
> >>>>       >     all
> >>>>       >     of the coefficients for a, b, c, a:b, and a:c.
> >>>>       >
> >>>>       >     John
> >>>>       >
> >>>>       >      >
> >>>>       >      > Best,
> >>>>       >      >
> >>>>       >      > Juho
> >>>>       >      >
> >>>>       >      >
> >>>>       >      >
> >>>>       >      >
> >>>>       >      >
> >>>>       >      >
> >>>>       >      >
> >>>>       >      >
> >>>>       >      >
> >>>>       >      >
> >>>>       >      >
> >>>>       >      > ti 1. maalisk. 2022 klo 0.05 John Fox (
> jfox at mcmaster.ca
> >>>>      <mailto:jfox at mcmaster.ca>
> >>>>       >     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>
> >>>>       >      > <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
> >>>>      <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>>) kirjoitti:
> >>>>       >      >
> >>>>       >      >     Dear Juha,
> >>>>       >      >
> >>>>       >      >     On 2022-02-28 5:00 p.m., Juho Kristian Ruohonen
> wrote:
> >>>>       >      >      > Apologies for my misreading, John, and many
> thanks
> >>>>      for showing
> >>>>       >      >     how the
> >>>>       >      >      > calculation is done for a single term.
> >>>>       >      >      >
> >>>>       >      >      > Do you think *vif()* might be updated in the
> near
> >>>>      future
> >>>>       >     with the
> >>>>       >      >      > capability of auto-detecting a multinomial model
> >>>>      and returning
> >>>>       >      >      > mathematically correct GVIF statistics?
> >>>>       >      >
> >>>>       >      >     The thought crossed my mind, but I'd want to do it
> in a
> >>>>       >     general way,
> >>>>       >      >     not
> >>>>       >      >     just for the multinom() function, and in a way that
> >>> avoids
> >>>>       >     incorrect
> >>>>       >      >     results such as those currently produced for
> "multinom"
> >>>>       >     models, albeit
> >>>>       >      >     with a warning. I can't guarantee whether or when
> I'll
> >>> be
> >>>>       >     able to do
> >>>>       >      >     that.
> >>>>       >      >
> >>>>       >      >     John
> >>>>       >      >
> >>>>       >      >      >
> >>>>       >      >      > If not, I'll proceed to writing my own function
> >>>>      based on your
> >>>>       >      >     example.
> >>>>       >      >      > However, /car/ is such an excellent and widely
> used
> >>>>       >     package that the
> >>>>       >      >      > greatest benefit to mankind would probably
> accrue
> >>>>      if /car /was
> >>>>       >      >     upgraded
> >>>>       >      >      > with this feature sooner rather than later.
> >>>>       >      >      >
> >>>>       >      >      > Best,
> >>>>       >      >      >
> >>>>       >      >      > Juho
> >>>>       >      >      >
> >>>>       >      >      >
> >>>>       >      >      >
> >>>>       >      >      >
> >>>>       >      >      >
> >>>>       >      >      >
> >>>>       >      >      >
> >>>>       >      >      >
> >>>>       >      >      >
> >>>>       >      >      > ma 28. helmik. 2022 klo 17.08 John Fox
> >>>>      (jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
> >>>>       >     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>
> >>>>       >      >     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
> >>>>      <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>>
> >>>>       >      >      > <mailto:jfox at mcmaster.ca <mailto:
> jfox at mcmaster.ca>
> >>>>      <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>
> >>>>       >     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
> >>>>      <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>>>)
> kirjoitti:
> >>>>       >      >      >
> >>>>       >      >      >     Dear Juho,
> >>>>       >      >      >
> >>>>       >      >      >     On 2022-02-28 2:06 a.m., Juho Kristian
> Ruohonen
> >>>>      wrote:
> >>>>       >      >      >      > Dear Professor Fox and other list
> members,
> >>>>       >      >      >      >
> >>>>       >      >      >      > Profuse thanks for doing that detective
> work
> >>> for
> >>>>       >     me! I myself
> >>>>       >      >      >     thought
> >>>>       >      >      >      > the inflation factors reported by
> >>>>       >     check_collinearity() were
> >>>>       >      >      >     suspiciously
> >>>>       >      >      >      > high, but unlike you I lacked the
> expertise
> >>>>      to identify
> >>>>       >      >     what was
> >>>>       >      >      >     going on.
> >>>>       >      >      >      >
> >>>>       >      >      >      > As for your suggested approach, have I
> >>>>      understood this
> >>>>       >      >     correctly:
> >>>>       >      >      >      >
> >>>>       >      >      >      > Since there doesn't yet exist an R
> function
> >>>>      that will
> >>>>       >      >     calculate the
> >>>>       >      >      >      > (G)VIFS of multinomial models correctly,
> my
> >>> best
> >>>>       >     bet for
> >>>>       >      >     now is
> >>>>       >      >      >     just to
> >>>>       >      >      >      > ignore the fact that such models
> partition
> >>>>      the data
> >>>>       >     into C-1
> >>>>       >      >      >     subsets,
> >>>>       >      >      >      > and to calculate approximate GVIFs from
> the
> >>>>      entire
> >>>>       >     dataset at
> >>>>       >      >      >     once as if
> >>>>       >      >      >      > the response were continuous? And a
> simple
> >>>>      way to
> >>>>       >     do this
> >>>>       >      >     is to
> >>>>       >      >      >      > construct a fake continuous response,
> call
> >>>>       >      >     *lm(fakeresponse ~.)*,
> >>>>       >      >      >     and
> >>>>       >      >      >      > apply *car::vif()* on the result?
> >>>>       >      >      >
> >>>>       >      >      >     No, you misunderstand my suggestion, which
> >>>>      perhaps isn't
> >>>>       >      >     surprising
> >>>>       >      >      >     given the length of my message. What you
> >>>>      propose is what I
> >>>>       >      >     suggested as
> >>>>       >      >      >     a rough approximation *before* I confirmed
> that
> >>> my
> >>>>       >     guess of the
> >>>>       >      >      >     solution
> >>>>       >      >      >     was correct.
> >>>>       >      >      >
> >>>>       >      >      >     The R code that I sent yesterday showed how
> to
> >>>>      compute the
> >>>>       >      >     GVIF for a
> >>>>       >      >      >     multinomial regression model, and I
> suggested
> >>>>      that you
> >>>>       >     write
> >>>>       >      >     either a
> >>>>       >      >      >     script or a simple function to do that.
> Here's
> >>>>      a function
> >>>>       >      >     that will
> >>>>       >      >      >     work
> >>>>       >      >      >     for a model object that responds to vcov():
> >>>>       >      >      >
> >>>>       >      >      >     GVIF <- function(model, intercepts, term){
> >>>>       >      >      >         # model: regression model object
> >>>>       >      >      >         # intercepts: row/column positions of
> >>>>      intercepts
> >>>>       >     in the
> >>>>       >      >     coefficient
> >>>>       >      >      >     covariance matrix
> >>>>       >      >      >         # term: row/column positions of the
> >>>>      coefficients
> >>>>       >     for the
> >>>>       >      >     focal term
> >>>>       >      >      >         V <- vcov(model)
> >>>>       >      >      >         term <- colnames(V)[term]
> >>>>       >      >      >         V <- V[-intercepts, -intercepts]
> >>>>       >      >      >         V <- cov2cor(V)
> >>>>       >      >      >         term <- which(colnames(V) %in% term)
> >>>>       >      >      >         gvif <- det(V[term, term])*det(V[-term,
> >>>>      -term])/det(V)
> >>>>       >      >      >         c(GVIF=gvif,
> >>>>       >     "GVIF^(1/(2*p))"=gvif^(1/(2*length(term))))
> >>>>       >      >      >     }
> >>>>       >      >      >
> >>>>       >      >      >     and here's an application to the multinom()
> >>>>      example that I
> >>>>       >      >     showed you
> >>>>       >      >      >     yesterday:
> >>>>       >      >      >
> >>>>       >      >      >       > colnames(vcov(m)) # to get coefficient
> >>>>      positions
> >>>>       >      >      >        [1] "Labour:(Intercept)"
> >>>>       >       "Labour:age"
> >>>>       >      >      >
> >>>>       >      >      >        [3] "Labour:economic.cond.national"
> >>>>       >      >      >     "Labour:economic.cond.household"
> >>>>       >      >      >        [5] "Labour:Blair"
> >>>>       >       "Labour:Hague"
> >>>>       >      >      >
> >>>>       >      >      >        [7] "Labour:Kennedy"
> >>>>       >       "Labour:Europe"
> >>>>       >      >      >
> >>>>       >      >      >        [9] "Labour:political.knowledge"
> >>>>       >      >       "Labour:gendermale"
> >>>>       >      >      >
> >>>>       >      >      >     [11] "Liberal Democrat:(Intercept)"
> >>>>        "Liberal
> >>>>       >      >     Democrat:age"
> >>>>       >      >      >
> >>>>       >      >      >     [13] "Liberal
> Democrat:economic.cond.national"
> >>>>      "Liberal
> >>>>       >      >      >     Democrat:economic.cond.household"
> >>>>       >      >      >     [15] "Liberal Democrat:Blair"
> >>>>        "Liberal
> >>>>       >      >      >     Democrat:Hague"
> >>>>       >      >      >
> >>>>       >      >      >     [17] "Liberal Democrat:Kennedy"
> >>>>        "Liberal
> >>>>       >      >      >     Democrat:Europe"
> >>>>       >      >      >     [19] "Liberal Democrat:political.knowledge"
> >>>>        "Liberal
> >>>>       >      >      >     Democrat:gendermale"
> >>>>       >      >      >
> >>>>       >      >      >       > GVIF(m, intercepts=c(1, 11), term=c(2,
> 12))
> >>>>      # GVIF
> >>>>       >     for age
> >>>>       >      >      >                 GVIF GVIF^(1/(2*p))
> >>>>       >      >      >             1.046232       1.011363
> >>>>       >      >      >
> >>>>       >      >      >
> >>>>       >      >      >     Finally, here's what you get for a linear
> model
> >>>>      with
> >>>>       >     the same RHS
> >>>>       >      >      >     (where
> >>>>       >      >      >     the sqrt(VIF) should be a rough
> approximation to
> >>>>       >     GVIF^(1/4)
> >>>>       >      >     reported by
> >>>>       >      >      >     my GVIF() function):
> >>>>       >      >      >
> >>>>       >      >      >       > m.lm <- lm(as.numeric(vote) ~ . - vote1,
> >>>>      data=BEPS)
> >>>>       >      >      >       > sqrt(car::vif(m.lm))
> >>>>       >      >      >                           age
> >>> economic.cond.national
> >>>>       >      >      >     economic.cond.household
> >>>>       >      >      >                         Blair
> >>>>       >      >      >                      1.006508
> >>> 1.124132
> >>>>       >      >      >     1.075656
> >>>>       >      >      >                      1.118441
> >>>>       >      >      >                         Hague
> >>>   Kennedy
> >>>>       >      >      >     Europe
> >>>>       >      >      >           political.knowledge
> >>>>       >      >      >                      1.066799
> >>> 1.015532
> >>>>       >      >      >     1.101741
> >>>>       >      >      >                      1.028546
> >>>>       >      >      >                        gender
> >>>>       >      >      >                      1.017386
> >>>>       >      >      >
> >>>>       >      >      >
> >>>>       >      >      >     John
> >>>>       >      >      >
> >>>>       >      >      >      >
> >>>>       >      >      >      > Best,
> >>>>       >      >      >      >
> >>>>       >      >      >      > Juho
> >>>>       >      >      >      >
> >>>>       >      >      >      > ma 28. helmik. 2022 klo 2.23 John Fox
> >>>>       >     (jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
> >>>>      <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>
> >>>>       >      >     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
> >>>>      <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>>
> >>>>       >      >      >     <mailto:jfox at mcmaster.ca
> >>>>      <mailto:jfox at mcmaster.ca> <mailto:jfox at mcmaster.ca
> >>>>      <mailto:jfox at mcmaster.ca>>
> >>>>       >     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
> >>>>      <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>>>
> >>>>       >      >      >      > <mailto:jfox at mcmaster.ca
> >>>>      <mailto:jfox at mcmaster.ca> <mailto:jfox at mcmaster.ca
> >>>>      <mailto:jfox at mcmaster.ca>>
> >>>>       >     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
> >>>>      <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>>
> >>>>       >      >     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
> >>>>      <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>
> >>>>       >     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
> >>>>      <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>>>>)
> kirjoitti:
> >>>>       >      >      >      >
> >>>>       >      >      >      >     Dear Juho,
> >>>>       >      >      >      >
> >>>>       >      >      >      >     I've now had a chance to think about
> this
> >>>>       >     problem some
> >>>>       >      >     more,
> >>>>       >      >      >     and I
> >>>>       >      >      >      >     believe that the approach I
> suggested is
> >>>>      correct. I
> >>>>       >      >     also had an
> >>>>       >      >      >      >     opportunity to talk the problem over
> a
> >>>>      bit with
> >>>>       >     Georges
> >>>>       >      >      >     Monette, who
> >>>>       >      >      >      >     coauthored the paper that introduced
> >>>>       >     generalized variance
> >>>>       >      >      >     inflation
> >>>>       >      >      >      >     factors (GVIFs). On the other hand,
> the
> >>>>      results
> >>>>       >      >     produced by
> >>>>       >      >      >      >     performance::check_collinearity() for
> >>>>       >     multinomial logit
> >>>>       >      >      >     models don't
> >>>>       >      >      >      >     seem to be correct (see below).
> >>>>       >      >      >      >
> >>>>       >      >      >      >     Here's an example, using the
> >>>>      nnet::multinom()
> >>>>       >     function
> >>>>       >      >     to fit a
> >>>>       >      >      >      >     multinomial logit model, with
> alternative
> >>>>       >      >     parametrizations of the
> >>>>       >      >      >      >     LHS of
> >>>>       >      >      >      >     the model:
> >>>>       >      >      >      >
> >>>>       >      >      >      >     --------- snip -----------
> >>>>       >      >      >      >
> >>>>       >      >      >      >       > library(nnet) # for multinom()
> >>>>       >      >      >      >       > library(carData) # for BEPS data
> set
> >>>>       >      >      >      >
> >>>>       >      >      >      >       > # alternative ordering of the
> >>>>      response levels:
> >>>>       >      >      >      >       > BEPS$vote1 <- factor(BEPS$vote,
> >>>>       >     levels=c("Labour",
> >>>>       >      >     "Liberal
> >>>>       >      >      >      >     Democrat", "Conservative"))
> >>>>       >      >      >      >       > levels(BEPS$vote)
> >>>>       >      >      >      >     [1] "Conservative"     "Labour"
> >>>>        "Liberal
> >>>>       >      >     Democrat"
> >>>>       >      >      >      >       > levels(BEPS$vote1)
> >>>>       >      >      >      >     [1] "Labour"           "Liberal
> Democrat"
> >>>>       >     "Conservative"
> >>>>       >      >      >      >
> >>>>       >      >      >      >       > m <- multinom(vote ~ . - vote1,
> >>>>      data=BEPS)
> >>>>       >      >      >      >     # weights:  33 (20 variable)
> >>>>       >      >      >      >     initial  value 1675.383740
> >>>>       >      >      >      >     iter  10 value 1345.935273
> >>>>       >      >      >      >     iter  20 value 1150.956807
> >>>>       >      >      >      >     iter  30 value 1141.921662
> >>>>       >      >      >      >     iter  30 value 1141.921661
> >>>>       >      >      >      >     iter  30 value 1141.921661
> >>>>       >      >      >      >     final  value 1141.921661
> >>>>       >      >      >      >     converged
> >>>>       >      >      >      >       > m1 <- multinom(vote1 ~ . - vote,
> >>>>      data=BEPS)
> >>>>       >      >      >      >     # weights:  33 (20 variable)
> >>>>       >      >      >      >     initial  value 1675.383740
> >>>>       >      >      >      >     iter  10 value 1280.439304
> >>>>       >      >      >      >     iter  20 value 1165.513772
> >>>>       >      >      >      >     final  value 1141.921662
> >>>>       >      >      >      >     converged
> >>>>       >      >      >      >
> >>>>       >      >      >      >       > rbind(coef(m), coef(m1)) #
> compare
> >>>>      coefficients
> >>>>       >      >      >      >                        (Intercept)
> >>> age
> >>>>       >      >      >     economic.cond.national
> >>>>       >      >      >      >     economic.cond.household
> >>>>       >      >      >      >     Labour             0.9515214
> -0.021913989
> >>>>       >      >     0.5575707
> >>>>       >      >      >      >            0.15839096
> >>>>       >      >      >      >     Liberal Democrat   1.4119306
> -0.016810735
> >>>>       >      >     0.1810761
> >>>>       >      >      >      >           -0.01196664
> >>>>       >      >      >      >     Liberal Democrat   0.4604567
> 0.005102666
> >>>>       >      >       -0.3764928
> >>>>       >      >      >      >           -0.17036682
> >>>>       >      >      >      >     Conservative      -0.9514466
> 0.021912305
> >>>>       >      >       -0.5575644
> >>>>       >      >      >      >           -0.15838744
> >>>>       >      >      >      >                             Blair
>  Hague
> >>>>       >     Kennedy
> >>>>       >      >          Europe
> >>>>       >      >      >      >     political.knowledge
> >>>>       >      >      >      >     Labour            0.8371764
> -0.90775585
> >>>>      0.2513436
> >>>>       >      >     -0.22781308
> >>>>       >      >      >      >     -0.5370612
> >>>>       >      >      >      >     Liberal Democrat  0.2937331
> -0.82217625
> >>>>      0.6710567
> >>>>       >      >     -0.20004624
> >>>>       >      >      >      >     -0.2034605
> >>>>       >      >      >      >     Liberal Democrat -0.5434408
> 0.08559455
> >>>>      0.4197027
> >>>>       >      >     0.02776465
> >>>>       >      >      >      >     0.3336068
> >>>>       >      >      >      >     Conservative     -0.8371670
> 0.90778068
> >>>>      -0.2513735
> >>>>       >      >     0.22781092
> >>>>       >      >      >      >     0.5370545
> >>>>       >      >      >      >                         gendermale
> >>>>       >      >      >      >     Labour            0.13765774
> >>>>       >      >      >      >     Liberal Democrat  0.12640823
> >>>>       >      >      >      >     Liberal Democrat -0.01125898
> >>>>       >      >      >      >     Conservative     -0.13764849
> >>>>       >      >      >      >
> >>>>       >      >      >      >       > c(logLik(m), logLik(m1)) # same
> fit
> >>>>      to the data
> >>>>       >      >      >      >     [1] -1141.922 -1141.922
> >>>>       >      >      >      >
> >>>>       >      >      >      >       > # covariance matrices for
> >>> coefficients:
> >>>>       >      >      >      >       > V <- vcov(m)
> >>>>       >      >      >      >       > V1 <- vcov(m1)
> >>>>       >      >      >      >       > cbind(colnames(V), colnames(V1))
> #
> >>>>      compare
> >>>>       >      >      >      >             [,1]
> >>>>       >         [,2]
> >>>>       >      >      >      >
> >>>>       >      >      >      >        [1,] "Labour:(Intercept)"
> >>>>       >      >       "Liberal
> >>>>       >      >      >      >     Democrat:(Intercept)"
> >>>>       >      >      >      >        [2,] "Labour:age"
> >>>>       >      >       "Liberal
> >>>>       >      >      >      >     Democrat:age"
> >>>>       >      >      >      >
> >>>>       >      >      >      >        [3,]
> "Labour:economic.cond.national"
> >>>>       >      >     "Liberal
> >>>>       >      >      >      >     Democrat:economic.cond.national"
> >>>>       >      >      >      >        [4,]
> "Labour:economic.cond.household"
> >>>>       >      >       "Liberal
> >>>>       >      >      >      >     Democrat:economic.cond.household"
> >>>>       >      >      >      >        [5,] "Labour:Blair"
> >>>>       >      >       "Liberal
> >>>>       >      >      >      >     Democrat:Blair"
> >>>>       >      >      >      >        [6,] "Labour:Hague"
> >>>>       >      >       "Liberal
> >>>>       >      >      >      >     Democrat:Hague"
> >>>>       >      >      >      >        [7,] "Labour:Kennedy"
> >>>>       >      >       "Liberal
> >>>>       >      >      >      >     Democrat:Kennedy"
> >>>>       >      >      >      >        [8,] "Labour:Europe"
> >>>>       >      >     "Liberal
> >>>>       >      >      >      >     Democrat:Europe"
> >>>>       >      >      >      >        [9,] "Labour:political.knowledge"
> >>>>       >      >       "Liberal
> >>>>       >      >      >      >     Democrat:political.knowledge"
> >>>>       >      >      >      >     [10,] "Labour:gendermale"
> >>>>       >        "Liberal
> >>>>       >      >      >      >     Democrat:gendermale"
> >>>>       >      >      >      >     [11,] "Liberal Democrat:(Intercept)"
> >>>>       >      >      >      >     "Conservative:(Intercept)"
> >>>>       >      >      >      >     [12,] "Liberal Democrat:age"
> >>>>       >      >      >       "Conservative:age"
> >>>>       >      >      >      >
> >>>>       >      >      >      >     [13,] "Liberal
> >>>>      Democrat:economic.cond.national"
> >>>>       >      >      >      >     "Conservative:economic.cond.national"
> >>>>       >      >      >      >     [14,] "Liberal
> >>>>      Democrat:economic.cond.household"
> >>>>       >      >      >      >
>  "Conservative:economic.cond.household"
> >>>>       >      >      >      >     [15,] "Liberal Democrat:Blair"
> >>>>       >      >      >       "Conservative:Blair"
> >>>>       >      >      >      >
> >>>>       >      >      >      >     [16,] "Liberal Democrat:Hague"
> >>>>       >      >      >       "Conservative:Hague"
> >>>>       >      >      >      >
> >>>>       >      >      >      >     [17,] "Liberal Democrat:Kennedy"
> >>>>       >      >      >       "Conservative:Kennedy"
> >>>>       >      >      >      >
> >>>>       >      >      >      >     [18,] "Liberal Democrat:Europe"
> >>>>       >      >      >     "Conservative:Europe"
> >>>>       >      >      >      >
> >>>>       >      >      >      >     [19,] "Liberal
> >>> Democrat:political.knowledge"
> >>>>       >      >      >      >     "Conservative:political.knowledge"
> >>>>       >      >      >      >     [20,] "Liberal Democrat:gendermale"
> >>>>       >      >      >      >     "Conservative:gendermale"
> >>>>       >      >      >      >
> >>>>       >      >      >      >       > int <- c(1, 11) # remove
> intercepts
> >>>>       >      >      >      >       > colnames(V)[int]
> >>>>       >      >      >      >     [1] "Labour:(Intercept)"
> >>>   "Liberal
> >>>>       >      >     Democrat:(Intercept)"
> >>>>       >      >      >      >
> >>>>       >      >      >      >       > colnames(V1)[int]
> >>>>       >      >      >      >     [1] "Liberal Democrat:(Intercept)"
> >>>>       >      >     "Conservative:(Intercept)"
> >>>>       >      >      >      >       > V <- V[-int, -int]
> >>>>       >      >      >      >       > V1 <- V1[-int, -int]
> >>>>       >      >      >      >
> >>>>       >      >      >      >       > age <- c(1, 10) # locate age
> >>>>      coefficients
> >>>>       >      >      >      >       > colnames(V)[age]
> >>>>       >      >      >      >     [1] "Labour:age"           "Liberal
> >>>>      Democrat:age"
> >>>>       >      >      >      >       > colnames(V1)[age]
> >>>>       >      >      >      >     [1] "Liberal Democrat:age"
> >>>>      "Conservative:age"
> >>>>       >      >      >      >
> >>>>       >      >      >      >       > V <- cov2cor(V) # compute
> coefficient
> >>>>       >     correlations
> >>>>       >      >      >      >       > V1 <- cov2cor(V1)
> >>>>       >      >      >      >
> >>>>       >      >      >      >       > # compare GVIFs:
> >>>>       >      >      >      >       > c(det(V[age, age])*det(V[-age,
> >>>>      -age])/det(V),
> >>>>       >      >      >      >     +   det(V1[age, age])*det(V1[-age,
> >>>>      -age])/det(V1))
> >>>>       >      >      >      >     [1] 1.046232 1.046229
> >>>>       >      >      >      >
> >>>>       >      >      >      >     --------- snip -----------
> >>>>       >      >      >      >
> >>>>       >      >      >      >     For curiosity, I applied car::vif()
> and
> >>>>       >      >      >      >     performance::check_collinearity() to
> >>> these
> >>>>       >     models to
> >>>>       >      >     see what
> >>>>       >      >      >     they
> >>>>       >      >      >      >     would
> >>>>       >      >      >      >     do. Both returned the wrong answer.
> vif()
> >>>>       >     produced a
> >>>>       >      >     warning, but
> >>>>       >      >      >      >     check_collinearity() didn't:
> >>>>       >      >      >      >
> >>>>       >      >      >      >     --------- snip -----------
> >>>>       >      >      >      >
> >>>>       >      >      >      >       > car::vif(m1)
> >>>>       >      >      >      >                           age
> >>>>      economic.cond.national
> >>>>       >      >      >      >     economic.cond.household
> >>>>       >      >      >      >                     15.461045
> >>>>        22.137772
> >>>>       >      >      >      >       16.693877
> >>>>       >      >      >      >                         Blair
> >>>>          Hague
> >>>>       >      >      >      >       Kennedy
> >>>>       >      >      >      >                     14.681562
> >>>>      7.483039
> >>>>       >      >      >      >       15.812067
> >>>>       >      >      >      >                        Europe
> >>>>        political.knowledge
> >>>>       >      >      >      >     gender
> >>>>       >      >      >      >                      6.502119
> >>>>      4.219507
> >>>>       >      >      >      >     2.313885
> >>>>       >      >      >      >     Warning message:
> >>>>       >      >      >      >     In vif.default(m1) : No intercept:
> vifs
> >>>>      may not be
> >>>>       >      >     sensible.
> >>>>       >      >      >      >
> >>>>       >      >      >      >       >
> performance::check_collinearity(m)
> >>>>       >      >      >      >     # Check for Multicollinearity
> >>>>       >      >      >      >
> >>>>       >      >      >      >     Low Correlation
> >>>>       >      >      >      >
> >>>>       >      >      >      >                           Term  VIF
> >>> Increased SE
> >>>>       >     Tolerance
> >>>>       >      >      >      >                            age 1.72
> >>>>        1.31
> >>>>       >        0.58
> >>>>       >      >      >      >         economic.cond.national 1.85
> >>>>        1.36
> >>>>       >        0.54
> >>>>       >      >      >      >        economic.cond.household 1.86
> >>>>        1.37
> >>>>       >        0.54
> >>>>       >      >      >      >                          Blair 1.63
> >>>>        1.28
> >>>>       >        0.61
> >>>>       >      >      >      >                          Hague 1.94
> >>>>        1.39
> >>>>       >        0.52
> >>>>       >      >      >      >                        Kennedy 1.70
> >>>>        1.30
> >>>>       >        0.59
> >>>>       >      >      >      >                         Europe 2.01
> >>>>        1.42
> >>>>       >        0.50
> >>>>       >      >      >      >            political.knowledge 1.94
> >>>>        1.39
> >>>>       >        0.52
> >>>>       >      >      >      >                         gender 1.78
> >>>>        1.33
> >>>>       >        0.56
> >>>>       >      >      >      >       >
> performance::check_collinearity(m1)
> >>>>       >      >      >      >     # Check for Multicollinearity
> >>>>       >      >      >      >
> >>>>       >      >      >      >     Low Correlation
> >>>>       >      >      >      >
> >>>>       >      >      >      >                           Term  VIF
> >>> Increased SE
> >>>>       >     Tolerance
> >>>>       >      >      >      >                            age 1.19
> >>>>        1.09
> >>>>       >        0.84
> >>>>       >      >      >      >         economic.cond.national 1.42
> >>>>        1.19
> >>>>       >        0.70
> >>>>       >      >      >      >        economic.cond.household 1.32
> >>>>        1.15
> >>>>       >        0.76
> >>>>       >      >      >      >                          Blair 1.50
> >>>>        1.22
> >>>>       >        0.67
> >>>>       >      >      >      >                          Hague 1.30
> >>>>        1.14
> >>>>       >        0.77
> >>>>       >      >      >      >                        Kennedy 1.19
> >>>>        1.09
> >>>>       >        0.84
> >>>>       >      >      >      >                         Europe 1.34
> >>>>        1.16
> >>>>       >        0.75
> >>>>       >      >      >      >            political.knowledge 1.30
> >>>>        1.14
> >>>>       >        0.77
> >>>>       >      >      >      >                         gender 1.23
> >>>>        1.11
> >>>>       >        0.81
> >>>>       >      >      >      >
> >>>>       >      >      >      >     --------- snip -----------
> >>>>       >      >      >      >
> >>>>       >      >      >      >     I looked at the code for vif() and
> >>>>       >     check_collinearity() to
> >>>>       >      >      >     see where
> >>>>       >      >      >      >     they went wrong. Both failed to
> handle
> >>>>      the two
> >>>>       >      >     intercepts in
> >>>>       >      >      >     the model
> >>>>       >      >      >      >     correctly -- vif() thought there was
> no
> >>>>       >     intercept and
> >>>>       >      >      >      >     check_collinearity() just removed the
> >>> first
> >>>>       >     intercept
> >>>>       >      >     but not the
> >>>>       >      >      >      >     second.
> >>>>       >      >      >      >
> >>>>       >      >      >      >     In examining the code for
> >>>>      check_collinearity(), I
> >>>>       >      >     discovered a
> >>>>       >      >      >      >     couple of
> >>>>       >      >      >      >     additional disconcerting facts.
> First,
> >>>>      part of the
> >>>>       >      >     code seems
> >>>>       >      >      >     to be
> >>>>       >      >      >      >     copied from vif.default(). Second,
> as a
> >>>>       >     consequence,
> >>>>       >      >      >      >     check_collinearity() actually
> computes
> >>>>      GVIFs rather
> >>>>       >      >     than VIFs
> >>>>       >      >      >     (and
> >>>>       >      >      >      >     doesn't reference either the Fox and
> >>>>      Monette paper
> >>>>       >      >      >     introducing GVIFs or
> >>>>       >      >      >      >     the car package) but doesn't seem to
> >>>>      understand
> >>>>       >     that, and,
> >>>>       >      >      >     for example,
> >>>>       >      >      >      >     takes the squareroot of the GVIF
> >>>>      (reported in the
> >>>>       >      >     column marked
> >>>>       >      >      >      >     "Increased SE") rather than the 2p
> root
> >>>>      (when there
> >>>>       >      >     are p > 1
> >>>>       >      >      >      >     coefficients in a term).
> >>>>       >      >      >      >
> >>>>       >      >      >      >     Here's the relevant code from the two
> >>>>      functions
> >>>>       >     (where
> >>>>       >      >     . . .
> >>>>       >      >      >     denotes
> >>>>       >      >      >      >     elided lines) -- the default method
> for
> >>>>      vif() and
> >>>>       >      >      >      >     .check_collinearity(),
> >>>>       >      >      >      >     which is called by
> >>>>      check_collinearity.default():
> >>>>       >      >      >      >
> >>>>       >      >      >      >     --------- snip -----------
> >>>>       >      >      >      >
> >>>>       >      >      >      >       > car:::vif.default
> >>>>       >      >      >      >     function (mod, ...)
> >>>>       >      >      >      >     {
> >>>>       >      >      >      >           . . .
> >>>>       >      >      >      >           v <- vcov(mod)
> >>>>       >      >      >      >           assign <-
> attr(model.matrix(mod),
> >>>>      "assign")
> >>>>       >      >      >      >           if
> (names(coefficients(mod)[1]) ==
> >>>>       >     "(Intercept)") {
> >>>>       >      >      >      >               v <- v[-1, -1]
> >>>>       >      >      >      >               assign <- assign[-1]
> >>>>       >      >      >      >           }
> >>>>       >      >      >      >           else warning("No intercept:
> vifs
> >>>>      may not be
> >>>>       >      >     sensible.")
> >>>>       >      >      >      >           terms <- labels(terms(mod))
> >>>>       >      >      >      >           n.terms <- length(terms)
> >>>>       >      >      >      >           if (n.terms < 2)
> >>>>       >      >      >      >               stop("model contains fewer
> >>>>      than 2 terms")
> >>>>       >      >      >      >           R <- cov2cor(v)
> >>>>       >      >      >      >           detR <- det(R)
> >>>>       >      >      >      >           . . .
> >>>>       >      >      >      >           for (term in 1:n.terms) {
> >>>>       >      >      >      >               subs <- which(assign ==
> term)
> >>>>       >      >      >      >               result[term, 1] <-
> >>>>      det(as.matrix(R[subs,
> >>>>       >      >     subs])) *
> >>>>       >      >      >      >     det(as.matrix(R[-subs,
> >>>>       >      >      >      >                   -subs]))/detR
> >>>>       >      >      >      >               result[term, 2] <-
> length(subs)
> >>>>       >      >      >      >           }
> >>>>       >      >      >      >           . . .
> >>>>       >      >      >      >     }
> >>>>       >      >      >      >
> >>>>       >      >      >      >       > performance:::.check_collinearity
> >>>>       >      >      >      >     function (x, component, verbose =
> TRUE)
> >>>>       >      >      >      >     {
> >>>>       >      >      >      >           v <- insight::get_varcov(x,
> >>>>      component =
> >>>>       >     component,
> >>>>       >      >      >     verbose =
> >>>>       >      >      >      >     FALSE)
> >>>>       >      >      >      >           assign <- .term_assignments(x,
> >>>>      component,
> >>>>       >     verbose =
> >>>>       >      >      >     verbose)
> >>>>       >      >      >      >           . . .
> >>>>       >      >      >      >           if (insight::has_intercept(x))
> {
> >>>>       >      >      >      >               v <- v[-1, -1]
> >>>>       >      >      >      >               assign <- assign[-1]
> >>>>       >      >      >      >           }
> >>>>       >      >      >      >           else {
> >>>>       >      >      >      >               if (isTRUE(verbose)) {
> >>>>       >      >      >      >                   warning("Model has no
> >>>>      intercept. VIFs
> >>>>       >      >     may not be
> >>>>       >      >      >      >     sensible.",
> >>>>       >      >      >      >                       call. = FALSE)
> >>>>       >      >      >      >               }
> >>>>       >      >      >      >           }
> >>>>       >      >      >      >               . . .
> >>>>       >      >      >      >               terms <-
> >>>>       >     labels(stats::terms(f[[component]]))
> >>>>       >      >      >      >               . . .
> >>>>       >      >      >      >           n.terms <- length(terms)
> >>>>       >      >      >      >           if (n.terms < 2) {
> >>>>       >      >      >      >               if (isTRUE(verbose)) {
> >>>>       >      >      >      >
> >>>>       >       warning(insight::format_message(sprintf("Not
> >>>>       >      >      >     enough model
> >>>>       >      >      >      >     terms in the %s part of the model to
> >>>>      check for
> >>>>       >      >      >     multicollinearity.",
> >>>>       >      >      >      >                       component)), call.
> =
> >>>>      FALSE)
> >>>>       >      >      >      >               }
> >>>>       >      >      >      >               return(NULL)
> >>>>       >      >      >      >           }
> >>>>       >      >      >      >           R <- stats::cov2cor(v)
> >>>>       >      >      >      >           detR <- det(R)
> >>>>       >      >      >      >           . . .
> >>>>       >      >      >      >           for (term in 1:n.terms) {
> >>>>       >      >      >      >               subs <- which(assign ==
> term)
> >>>>       >      >      >      >                   . . .
> >>>>       >      >      >      >                   result <- c(result,
> >>>>       >      >     det(as.matrix(R[subs, subs])) *
> >>>>       >      >      >      >
>  det(as.matrix(R[-subs,
> >>>>       >     -subs]))/detR)
> >>>>       >      >      >      >                   . . .
> >>>>       >      >      >      >           }
> >>>>       >      >      >      >           . . .
> >>>>       >      >      >      >     }
> >>>>       >      >      >      >
> >>>>       >      >      >      >     --------- snip -----------
> >>>>       >      >      >      >
> >>>>       >      >      >      >     So, the upshot of all this is that
> you
> >>>>      should
> >>>>       >     be able
> >>>>       >      >     to do
> >>>>       >      >      >     what you
> >>>>       >      >      >      >     want, but not with either car::vif()
> or
> >>>>       >      >      >      >     performance::check_collinearity().
> >>>>      Instead, either
> >>>>       >      >     write your own
> >>>>       >      >      >      >     function or do the computations in a
> >>> script.
> >>>>       >      >      >      >
> >>>>       >      >      >      >     There's also a lesson here about S3
> >>> default
> >>>>       >     methods:
> >>>>       >      >     The fact
> >>>>       >      >      >     that a
> >>>>       >      >      >      >     default method returns a result
> rather
> >>> than
> >>>>       >     throwing
> >>>>       >      >     an error
> >>>>       >      >      >     or a
> >>>>       >      >      >      >     warning doesn't mean that the result
> is
> >>> the
> >>>>       >     right answer.
> >>>>       >      >      >      >
> >>>>       >      >      >      >     I hope this helps,
> >>>>       >      >      >      >        John
> >>>>       >      >      >      >
> >>>>       >      >      >      >
> >>>>       >      >      >      >     On 2022-02-26 3:45 p.m., Juho
> Kristian
> >>>>      Ruohonen
> >>>>       >     wrote:
> >>>>       >      >      >      >      > Dear John W,
> >>>>       >      >      >      >      >
> >>>>       >      >      >      >      > Thank you very much for the
> tip-off!
> >>>>       >     Apologies for not
> >>>>       >      >      >     responding
> >>>>       >      >      >      >     earlier
> >>>>       >      >      >      >      > (gmail apparently decided to
> direct
> >>>>      your email
> >>>>       >      >     right into the
> >>>>       >      >      >      >     junk folder).
> >>>>       >      >      >      >      > I am very pleased to note that the
> >>>>      package you
> >>>>       >      >     mention does
> >>>>       >      >      >      >     indeed work
> >>>>       >      >      >      >      > with *brms* multinomial models!
> >>>>      Thanks again!
> >>>>       >      >      >      >      >
> >>>>       >      >      >      >      > Best,
> >>>>       >      >      >      >      >
> >>>>       >      >      >      >      > Juho
> >>>>       >      >      >      >      >
> >>>>       >      >      >      >      > pe 25. helmik. 2022 klo 19.23 John
> >>>>      Willoughby
> >>>>       >      >      >      >     (johnwillec at gmail.com
> >>>>      <mailto:johnwillec at gmail.com>
> >>>>       >     <mailto:johnwillec at gmail.com <mailto:johnwillec at gmail.com
> >>
> >>>>      <mailto:johnwillec at gmail.com <mailto:johnwillec at gmail.com>
> >>>>       >     <mailto:johnwillec at gmail.com <mailto:johnwillec at gmail.com
> >>>
> >>>>       >      >     <mailto:johnwillec at gmail.com
> >>>>      <mailto:johnwillec at gmail.com> <mailto:johnwillec at gmail.com
> >>>>      <mailto:johnwillec at gmail.com>>
> >>>>       >     <mailto:johnwillec at gmail.com <mailto:johnwillec at gmail.com
> >
> >>>>      <mailto:johnwillec at gmail.com <mailto:johnwillec at gmail.com>>>>
> >>>>       >      >      >     <mailto:johnwillec at gmail.com
> >>>>      <mailto:johnwillec at gmail.com>
> >>>>       >     <mailto:johnwillec at gmail.com <mailto:johnwillec at gmail.com
> >>
> >>>>      <mailto:johnwillec at gmail.com <mailto:johnwillec at gmail.com>
> >>>>       >     <mailto:johnwillec at gmail.com <mailto:johnwillec at gmail.com
> >>>
> >>>>       >      >     <mailto:johnwillec at gmail.com
> >>>>      <mailto:johnwillec at gmail.com> <mailto:johnwillec at gmail.com
> >>>>      <mailto:johnwillec at gmail.com>>
> >>>>       >     <mailto:johnwillec at gmail.com <mailto:johnwillec at gmail.com
> >
> >>>>      <mailto:johnwillec at gmail.com <mailto:johnwillec at gmail.com>>>>>)
> >>>>       >      >      >      >      > kirjoitti:
> >>>>       >      >      >      >      >
> >>>>       >      >      >      >      >> Have you tried the
> >>> check_collinearity()
> >>>>       >     function
> >>>>       >      >     in the
> >>>>       >      >      >     performance
> >>>>       >      >      >      >      >> package? It's supposed to work on
> >>> brms
> >>>>       >     models, but
> >>>>       >      >     whether it
> >>>>       >      >      >      >     will work on
> >>>>       >      >      >      >      >> a multinomial model I don't know.
> >>>>      It works
> >>>>       >     well
> >>>>       >      >     on mixed
> >>>>       >      >      >     models
> >>>>       >      >      >      >     generated
> >>>>       >      >      >      >      >> by glmmTMB().
> >>>>       >      >      >      >      >>
> >>>>       >      >      >      >      >> John Willoughby
> >>>>       >      >      >      >      >>
> >>>>       >      >      >      >      >>
> >>>>       >      >      >      >      >> On Fri, Feb 25, 2022 at 3:01 AM
> >>>>       >      >      >      >
> >>>>        <r-sig-mixed-models-request at r-project.org
> >>>>      <mailto:r-sig-mixed-models-request at r-project.org>
> >>>>       >     <mailto:r-sig-mixed-models-request at r-project.org
> >>>>      <mailto:r-sig-mixed-models-request at r-project.org>>
> >>>>       >      >     <mailto:r-sig-mixed-models-request at r-project.org
> >>>>      <mailto:r-sig-mixed-models-request at r-project.org>
> >>>>       >     <mailto:r-sig-mixed-models-request at r-project.org
> >>>>      <mailto:r-sig-mixed-models-request at r-project.org>>>
> >>>>       >      >      >
> >>>>        <mailto:r-sig-mixed-models-request at r-project.org
> >>>>      <mailto:r-sig-mixed-models-request at r-project.org>
> >>>>       >     <mailto:r-sig-mixed-models-request at r-project.org
> >>>>      <mailto:r-sig-mixed-models-request at r-project.org>>
> >>>>       >      >     <mailto:r-sig-mixed-models-request at r-project.org
> >>>>      <mailto:r-sig-mixed-models-request at r-project.org>
> >>>>       >     <mailto:r-sig-mixed-models-request at r-project.org
> >>>>      <mailto:r-sig-mixed-models-request at r-project.org>>>>
> >>>>       >      >      >      >
> >>>>       >       <mailto:r-sig-mixed-models-request at r-project.org
> >>>>      <mailto:r-sig-mixed-models-request at r-project.org>
> >>>>       >     <mailto:r-sig-mixed-models-request at r-project.org
> >>>>      <mailto:r-sig-mixed-models-request at r-project.org>>
> >>>>       >      >     <mailto:r-sig-mixed-models-request at r-project.org
> >>>>      <mailto:r-sig-mixed-models-request at r-project.org>
> >>>>       >     <mailto:r-sig-mixed-models-request at r-project.org
> >>>>      <mailto:r-sig-mixed-models-request at r-project.org>>>
> >>>>       >      >      >
> >>>>        <mailto:r-sig-mixed-models-request at r-project.org
> >>>>      <mailto:r-sig-mixed-models-request at r-project.org>
> >>>>       >     <mailto:r-sig-mixed-models-request at r-project.org
> >>>>      <mailto:r-sig-mixed-models-request at r-project.org>>
> >>>>       >      >     <mailto:r-sig-mixed-models-request at r-project.org
> >>>>      <mailto:r-sig-mixed-models-request at r-project.org>
> >>>>       >     <mailto:r-sig-mixed-models-request at r-project.org
> >>>>      <mailto:r-sig-mixed-models-request at r-project.org>>>>>>
> >>>>       >      >      >      >      >> wrote:
> >>>>       >      >      >      >      >>
> >>>>       >      >      >      >      >>> Send R-sig-mixed-models mailing
> list
> >>>>       >     submissions to
> >>>>       >      >      >      >      >>>
> r-sig-mixed-models at r-project.org
> >>>>      <mailto:r-sig-mixed-models at r-project.org>
> >>>>       >     <mailto:r-sig-mixed-models at r-project.org
> >>>>      <mailto:r-sig-mixed-models at r-project.org>>
> >>>>       >      >     <mailto:r-sig-mixed-models at r-project.org
> >>>>      <mailto:r-sig-mixed-models at r-project.org>
> >>>>       >     <mailto:r-sig-mixed-models at r-project.org
> >>>>      <mailto:r-sig-mixed-models at r-project.org>>>
> >>>>       >      >      >     <mailto:r-sig-mixed-models at r-project.org
> >>>>      <mailto:r-sig-mixed-models at r-project.org>
> >>>>       >     <mailto:r-sig-mixed-models at r-project.org
> >>>>      <mailto:r-sig-mixed-models at r-project.org>>
> >>>>       >      >     <mailto:r-sig-mixed-models at r-project.org
> >>>>      <mailto:r-sig-mixed-models at r-project.org>
> >>>>       >     <mailto:r-sig-mixed-models at r-project.org
> >>>>      <mailto:r-sig-mixed-models at r-project.org>>>>
> >>>>       >      >      >      >     <mailto:
> r-sig-mixed-models at r-project.org
> >>>>      <mailto:r-sig-mixed-models at r-project.org>
> >>>>       >     <mailto:r-sig-mixed-models at r-project.org
> >>>>      <mailto:r-sig-mixed-models at r-project.org>>
> >>>>       >      >     <mailto:r-sig-mixed-models at r-project.org
> >>>>      <mailto:r-sig-mixed-models at r-project.org>
> >>>>       >     <mailto:r-sig-mixed-models at r-project.org
> >>>>      <mailto:r-sig-mixed-models at r-project.org>>>
> >>>>       >      >      >     <mailto:r-sig-mixed-models at r-project.org
> >>>>      <mailto:r-sig-mixed-models at r-project.org>
> >>>>       >     <mailto:r-sig-mixed-models at r-project.org
> >>>>      <mailto:r-sig-mixed-models at r-project.org>>
> >>>>       >      >     <mailto:r-sig-mixed-models at r-project.org
> >>>>      <mailto:r-sig-mixed-models at r-project.org>
> >>>>       >     <mailto:r-sig-mixed-models at r-project.org
> >>>>      <mailto:r-sig-mixed-models at r-project.org>>>>>
> >>>>       >      >      >      >      >>>
> >>>>       >      >      >      >      >>> To subscribe or unsubscribe via
> the
> >>>>      World Wide
> >>>>       >      >     Web, visit
> >>>>       >      >      >      >      >>>
> >>>>       >      >
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >>>>      <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
> >>>>       >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >>>>      <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>
> >>>>       >      >
> >>>>        <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >>>>      <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
> >>>>       >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >>>>      <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>>
> >>>>       >      >      >
> >>>>       >       <
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >>>>      <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
> >>>>       >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >>>>      <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>
> >>>>       >      >
> >>>>        <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >>>>      <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
> >>>>       >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >>>>      <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>>>
> >>>>       >      >      >      >
> >>>>       >      >
> >>>>        <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >>>>      <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
> >>>>       >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >>>>      <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>
> >>>>       >      >
> >>>>        <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >>>>      <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
> >>>>       >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >>>>      <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>>
> >>>>       >      >      >
> >>>>       >       <
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >>>>      <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
> >>>>       >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >>>>      <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>
> >>>>       >      >
> >>>>        <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >>>>      <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
> >>>>       >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >>>>      <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>>>>
> >>>>       >      >      >      >      >>> or, via email, send a message
> with
> >>>>      subject or
> >>>>       >      >     body 'help' to
> >>>>       >      >      >      >      >>>
> >>>>      r-sig-mixed-models-request at r-project.org
> >>>>      <mailto:r-sig-mixed-models-request at r-project.org>
> >>>>       >     <mailto:r-sig-mixed-models-request at r-project.org
> >>>>      <mailto:r-sig-mixed-models-request at r-project.org>>
> >>>>       >      >     <mailto:r-sig-mixed-models-request at r-project.org
> >>>>      <mailto:r-sig-mixed-models-request at r-project.org>
> >>>>       >     <mailto:r-sig-mixed-models-request at r-project.org
> >>>>      <mailto:r-sig-mixed-models-request at r-project.org>>>
> >>>>       >      >      >
> >>>>        <mailto:r-sig-mixed-models-request at r-project.org
> >>>>      <mailto:r-sig-mixed-models-request at r-project.org>
> >>>>       >     <mailto:r-sig-mixed-models-request at r-project.org
> >>>>      <mailto:r-sig-mixed-models-request at r-project.org>>
> >>>>       >      >     <mailto:r-sig-mixed-models-request at r-project.org
> >>>>      <mailto:r-sig-mixed-models-request at r-project.org>
> >>>>       >     <mailto:r-sig-mixed-models-request at r-project.org
> >>>>      <mailto:r-sig-mixed-models-request at r-project.org>>>>
> >>>>       >      >      >      >
> >>>>       >       <mailto:r-sig-mixed-models-request at r-project.org
> >>>>      <mailto:r-sig-mixed-models-request at r-project.org>
> >>>>       >     <mailto:r-sig-mixed-models-request at r-project.org
> >>>>      <mailto:r-sig-mixed-models-request at r-project.org>>
> >>>>       >      >     <mailto:r-sig-mixed-models-request at r-project.org
> >>>>      <mailto:r-sig-mixed-models-request at r-project.org>
> >>>>       >     <mailto:r-sig-mixed-models-request at r-project.org
> >>>>      <mailto:r-sig-mixed-models-request at r-project.org>>>
> >>>>       >      >      >
> >>>>        <mailto:r-sig-mixed-models-request at r-project.org
> >>>>      <mailto:r-sig-mixed-models-request at r-project.org>
> >>>>       >     <mailto:r-sig-mixed-models-request at r-project.org
> >>>>      <mailto:r-sig-mixed-models-request at r-project.org>>
> >>>>       >      >     <mailto:r-sig-mixed-models-request at r-project.org
> >>>>      <mailto:r-sig-mixed-models-request at r-project.org>
> >>>>       >     <mailto:r-sig-mixed-models-request at r-project.org
> >>>>      <mailto:r-sig-mixed-models-request at r-project.org>>>>>
> >>>>       >      >      >      >      >>>
> >>>>       >      >      >      >      >>> You can reach the person
> managing
> >>>>      the list at
> >>>>       >      >      >      >      >>>
> >>>>      r-sig-mixed-models-owner at r-project.org
> >>>>      <mailto:r-sig-mixed-models-owner at r-project.org>
> >>>>       >     <mailto:r-sig-mixed-models-owner at r-project.org
> >>>>      <mailto:r-sig-mixed-models-owner at r-project.org>>
> >>>>       >      >     <mailto:r-sig-mixed-models-owner at r-project.org
> >>>>      <mailto:r-sig-mixed-models-owner at r-project.org>
> >>>>       >     <mailto:r-sig-mixed-models-owner at r-project.org
> >>>>      <mailto:r-sig-mixed-models-owner at r-project.org>>>
> >>>>       >      >      >     <mailto:
> r-sig-mixed-models-owner at r-project.org
> >>>>      <mailto:r-sig-mixed-models-owner at r-project.org>
> >>>>       >     <mailto:r-sig-mixed-models-owner at r-project.org
> >>>>      <mailto:r-sig-mixed-models-owner at r-project.org>>
> >>>>       >      >     <mailto:r-sig-mixed-models-owner at r-project.org
> >>>>      <mailto:r-sig-mixed-models-owner at r-project.org>
> >>>>       >     <mailto:r-sig-mixed-models-owner at r-project.org
> >>>>      <mailto:r-sig-mixed-models-owner at r-project.org>>>>
> >>>>       >      >      >      >
> >>>>        <mailto:r-sig-mixed-models-owner at r-project.org
> >>>>      <mailto:r-sig-mixed-models-owner at r-project.org>
> >>>>       >     <mailto:r-sig-mixed-models-owner at r-project.org
> >>>>      <mailto:r-sig-mixed-models-owner at r-project.org>>
> >>>>       >      >     <mailto:r-sig-mixed-models-owner at r-project.org
> >>>>      <mailto:r-sig-mixed-models-owner at r-project.org>
> >>>>       >     <mailto:r-sig-mixed-models-owner at r-project.org
> >>>>      <mailto:r-sig-mixed-models-owner at r-project.org>>>
> >>>>       >      >      >     <mailto:
> r-sig-mixed-models-owner at r-project.org
> >>>>      <mailto:r-sig-mixed-models-owner at r-project.org>
> >>>>       >     <mailto:r-sig-mixed-models-owner at r-project.org
> >>>>      <mailto:r-sig-mixed-models-owner at r-project.org>>
> >>>>       >      >     <mailto:r-sig-mixed-models-owner at r-project.org
> >>>>      <mailto:r-sig-mixed-models-owner at r-project.org>
> >>>>       >     <mailto:r-sig-mixed-models-owner at r-project.org
> >>>>      <mailto:r-sig-mixed-models-owner at r-project.org>>>>>
> >>>>       >      >      >      >      >>>
> >>>>       >      >      >      >      >>> When replying, please edit your
> >>> Subject
> >>>>       >     line so it is
> >>>>       >      >      >     more specific
> >>>>       >      >      >      >      >>> than "Re: Contents of
> >>>>      R-sig-mixed-models
> >>>>       >     digest..."
> >>>>       >      >      >      >      >>>
> >>>>       >      >      >      >      >>>
> >>>>       >      >      >      >      >>> Today's Topics:
> >>>>       >      >      >      >      >>>
> >>>>       >      >      >      >      >>>     1. Collinearity diagnostics
> for
> >>>>      (mixed)
> >>>>       >      >     multinomial
> >>>>       >      >      >     models
> >>>>       >      >      >      >      >>>        (Juho Kristian Ruohonen)
> >>>>       >      >      >      >      >>>
> >>>>       >      >      >      >      >>>
> >>>>       >      >      >      >
> >>>>       >      >      >
> >>>>       >      >
> >>>>       >
> >>>>
> >>>
>  ----------------------------------------------------------------------
> >>>>       >      >      >      >      >>>
> >>>>       >      >      >      >      >>> Message: 1
> >>>>       >      >      >      >      >>> Date: Fri, 25 Feb 2022 10:23:25
> >>> +0200
> >>>>       >      >      >      >      >>> From: Juho Kristian Ruohonen
> >>>>       >      >      >     <juho.kristian.ruohonen at gmail.com
> >>>>      <mailto:juho.kristian.ruohonen at gmail.com>
> >>>>       >     <mailto:juho.kristian.ruohonen at gmail.com
> >>>>      <mailto:juho.kristian.ruohonen at gmail.com>>
> >>>>       >      >     <mailto:juho.kristian.ruohonen at gmail.com
> >>>>      <mailto:juho.kristian.ruohonen at gmail.com>
> >>>>       >     <mailto:juho.kristian.ruohonen at gmail.com
> >>>>      <mailto:juho.kristian.ruohonen at gmail.com>>>
> >>>>       >      >      >     <mailto:juho.kristian.ruohonen at gmail.com
> >>>>      <mailto:juho.kristian.ruohonen at gmail.com>
> >>>>       >     <mailto:juho.kristian.ruohonen at gmail.com
> >>>>      <mailto:juho.kristian.ruohonen at gmail.com>>
> >>>>       >      >     <mailto:juho.kristian.ruohonen at gmail.com
> >>>>      <mailto:juho.kristian.ruohonen at gmail.com>
> >>>>       >     <mailto:juho.kristian.ruohonen at gmail.com
> >>>>      <mailto:juho.kristian.ruohonen at gmail.com>>>>
> >>>>       >      >      >      >     <mailto:
> juho.kristian.ruohonen at gmail.com
> >>>>      <mailto:juho.kristian.ruohonen at gmail.com>
> >>>>       >     <mailto:juho.kristian.ruohonen at gmail.com
> >>>>      <mailto:juho.kristian.ruohonen at gmail.com>>
> >>>>       >      >     <mailto:juho.kristian.ruohonen at gmail.com
> >>>>      <mailto:juho.kristian.ruohonen at gmail.com>
> >>>>       >     <mailto:juho.kristian.ruohonen at gmail.com
> >>>>      <mailto:juho.kristian.ruohonen at gmail.com>>>
> >>>>       >      >      >     <mailto:juho.kristian.ruohonen at gmail.com
> >>>>      <mailto:juho.kristian.ruohonen at gmail.com>
> >>>>       >     <mailto:juho.kristian.ruohonen at gmail.com
> >>>>      <mailto:juho.kristian.ruohonen at gmail.com>>
> >>>>       >      >     <mailto:juho.kristian.ruohonen at gmail.com
> >>>>      <mailto:juho.kristian.ruohonen at gmail.com>
> >>>>       >     <mailto:juho.kristian.ruohonen at gmail.com
> >>>>      <mailto:juho.kristian.ruohonen at gmail.com>>>>>>
> >>>>       >      >      >      >      >>> To: John Fox <jfox at mcmaster.ca
> >>>>      <mailto:jfox at mcmaster.ca>
> >>>>       >     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>
> >>>>       >      >     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
> >>>>      <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>>
> >>>>       >     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
> >>>>      <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>
> >>>>       >      >     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
> >>>>      <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>>>
> >>>>       >      >      >     <mailto:jfox at mcmaster.ca
> >>>>      <mailto:jfox at mcmaster.ca> <mailto:jfox at mcmaster.ca
> >>>>      <mailto:jfox at mcmaster.ca>>
> >>>>       >     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
> >>>>      <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>>
> >>>>       >      >     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
> >>>>      <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>
> >>>>       >     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
> >>>>      <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>>>>>
> >>>>       >      >      >      >      >>> Cc:
> >>>>      "r-sig-mixed-models at r-project.org
> >>>>      <mailto:r-sig-mixed-models at r-project.org>
> >>>>       >     <mailto:r-sig-mixed-models at r-project.org
> >>>>      <mailto:r-sig-mixed-models at r-project.org>>
> >>>>       >      >     <mailto:r-sig-mixed-models at r-project.org
> >>>>      <mailto:r-sig-mixed-models at r-project.org>
> >>>>       >     <mailto:r-sig-mixed-models at r-project.org
> >>>>      <mailto:r-sig-mixed-models at r-project.org>>>
> >>>>       >      >      >     <mailto:r-sig-mixed-models at r-project.org
> >>>>      <mailto:r-sig-mixed-models at r-project.org>
> >>>>       >     <mailto:r-sig-mixed-models at r-project.org
> >>>>      <mailto:r-sig-mixed-models at r-project.org>>
> >>>>       >      >     <mailto:r-sig-mixed-models at r-project.org
> >>>>      <mailto:r-sig-mixed-models at r-project.org>
> >>>>       >     <mailto:r-sig-mixed-models at r-project.org
> >>>>      <mailto:r-sig-mixed-models at r-project.org>>>>
> >>>>       >      >      >      >     <mailto:
> r-sig-mixed-models at r-project.org
> >>>>      <mailto:r-sig-mixed-models at r-project.org>
> >>>>       >     <mailto:r-sig-mixed-models at r-project.org
> >>>>      <mailto:r-sig-mixed-models at r-project.org>>
> >>>>       >      >     <mailto:r-sig-mixed-models at r-project.org
> >>>>      <mailto:r-sig-mixed-models at r-project.org>
> >>>>       >     <mailto:r-sig-mixed-models at r-project.org
> >>>>      <mailto:r-sig-mixed-models at r-project.org>>>
> >>>>       >      >      >     <mailto:r-sig-mixed-models at r-project.org
> >>>>      <mailto:r-sig-mixed-models at r-project.org>
> >>>>       >     <mailto:r-sig-mixed-models at r-project.org
> >>>>      <mailto:r-sig-mixed-models at r-project.org>>
> >>>>       >      >     <mailto:r-sig-mixed-models at r-project.org
> >>>>      <mailto:r-sig-mixed-models at r-project.org>
> >>>>       >     <mailto:r-sig-mixed-models at r-project.org
> >>>>      <mailto:r-sig-mixed-models at r-project.org>>>>>"
> >>>>       >      >      >      >      >>>
> >>>>      <r-sig-mixed-models at r-project.org
> >>>>      <mailto:r-sig-mixed-models at r-project.org>
> >>>>       >     <mailto:r-sig-mixed-models at r-project.org
> >>>>      <mailto:r-sig-mixed-models at r-project.org>>
> >>>>       >      >     <mailto:r-sig-mixed-models at r-project.org
> >>>>      <mailto:r-sig-mixed-models at r-project.org>
> >>>>       >     <mailto:r-sig-mixed-models at r-project.org
> >>>>      <mailto:r-sig-mixed-models at r-project.org>>>
> >>>>       >      >      >     <mailto:r-sig-mixed-models at r-project.org
> >>>>      <mailto:r-sig-mixed-models at r-project.org>
> >>>>       >     <mailto:r-sig-mixed-models at r-project.org
> >>>>      <mailto:r-sig-mixed-models at r-project.org>>
> >>>>       >      >     <mailto:r-sig-mixed-models at r-project.org
> >>>>      <mailto:r-sig-mixed-models at r-project.org>
> >>>>       >     <mailto:r-sig-mixed-models at r-project.org
> >>>>      <mailto:r-sig-mixed-models at r-project.org>>>>
> >>>>       >      >      >      >     <mailto:
> r-sig-mixed-models at r-project.org
> >>>>      <mailto:r-sig-mixed-models at r-project.org>
> >>>>       >     <mailto:r-sig-mixed-models at r-project.org
> >>>>      <mailto:r-sig-mixed-models at r-project.org>>
> >>>>       >      >     <mailto:r-sig-mixed-models at r-project.org
> >>>>      <mailto:r-sig-mixed-models at r-project.org>
> >>>>       >     <mailto:r-sig-mixed-models at r-project.org
> >>>>      <mailto:r-sig-mixed-models at r-project.org>>>
> >>>>       >      >      >     <mailto:r-sig-mixed-models at r-project.org
> >>>>      <mailto:r-sig-mixed-models at r-project.org>
> >>>>       >     <mailto:r-sig-mixed-models at r-project.org
> >>>>      <mailto:r-sig-mixed-models at r-project.org>>
> >>>>       >      >     <mailto:r-sig-mixed-models at r-project.org
> >>>>      <mailto:r-sig-mixed-models at r-project.org>
> >>>>       >     <mailto:r-sig-mixed-models at r-project.org
> >>>>      <mailto:r-sig-mixed-models at r-project.org>>>>>>
> >>>>       >      >      >      >      >>> Subject: [R-sig-ME] Collinearity
> >>>>       >     diagnostics for
> >>>>       >      >     (mixed)
> >>>>       >      >      >      >     multinomial
> >>>>       >      >      >      >      >>>          models
> >>>>       >      >      >      >      >>> Message-ID:
> >>>>       >      >      >      >      >>>          <
> >>>>       >      >      >      >      >>>
> >>>>       >      >      >      >
> >>>>       >      >      >
> >>>>       >      >
> >>>>       >
> >>>>
> CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com
> >>>>      <mailto:
> >>> CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com>
> >>>>       >
> >>>>        <mailto:
> >>> CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com
> >>> <mailto:
> CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com
> >>>>>
> >>>>       >      >
> >>>>       >
> >>>>        <mailto:
> >>> CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com
> >>> <mailto:
> CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com>
> >>> <mailto:
> CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com
> >>> <mailto:
> CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com
> >>>>>>
> >>>>       >      >      >
> >>>>       >      >
> >>>>       >
> >>>>        <mailto:
> >>> CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com
> >>> <mailto:
> CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com>
> >>> <mailto:
> CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com
> >>> <mailto:
> CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com>>
> >>> <mailto:
> CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com
> >>> <mailto:
> CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com>
> >>> <mailto:
> CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com
> >>> <mailto:
> CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com
> >>>>>>>
> >>>>       >      >      >      >
> >>>>       >      >      >
> >>>>       >      >
> >>>>       >
> >>>>        <mailto:
> >>> CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com
> >>> <mailto:
> CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com>
> >>> <mailto:
> CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com
> >>> <mailto:
> CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com>>
> >>> <mailto:
> CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com
> >>> <mailto:
> CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com>
> >>> <mailto:
> CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com
> >>> <mailto:
> CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com>>>
> >>> <mailto:
> CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com
> >>> <mailto:
> CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com>
> >>> <mailto:
> CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com
> >>> <mailto:
> CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com>>
> >>> <mailto:
> CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com
> >>> <mailto:
> CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com>
> >>> <mailto:
> CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com
> >>> <mailto:
> CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com
> >>>>>>>>>
> >>>>       >      >      >      >      >>> Content-Type: text/plain;
> >>>>      charset="utf-8"
> >>>>       >      >      >      >      >>>
> >>>>       >      >      >      >      >>> Dear John (and anyone else
> >>> qualified to
> >>>>       >     comment),
> >>>>       >      >      >      >      >>>
> >>>>       >      >      >      >      >>> I fit lots of mixed-effects
> >>> multinomial
> >>>>       >     models in my
> >>>>       >      >      >     research,
> >>>>       >      >      >      >     and I
> >>>>       >      >      >      >      >> would
> >>>>       >      >      >      >      >>> like to see some
> (multi)collinearity
> >>>>       >     diagnostics
> >>>>       >      >     on the
> >>>>       >      >      >     fixed
> >>>>       >      >      >      >     effects, of
> >>>>       >      >      >      >      >>> which there are over 30. My
> models
> >>>>      are fit
> >>>>       >     using the
> >>>>       >      >      >     Bayesian
> >>>>       >      >      >      >     *brms*
> >>>>       >      >      >      >      >>> package because I know of no
> >>>>      frequentist
> >>>>       >     packages
> >>>>       >      >     with
> >>>>       >      >      >      >     multinomial GLMM
> >>>>       >      >      >      >      >>> compatibility.
> >>>>       >      >      >      >      >>>
> >>>>       >      >      >      >      >>> With continuous or dichotomous
> >>>>      outcomes,
> >>>>       >     my go-to
> >>>>       >      >      >     function for
> >>>>       >      >      >      >      >> calculating
> >>>>       >      >      >      >      >>> multicollinearity diagnostics
> is of
> >>>>      course
> >>>>       >      >     *vif()* from
> >>>>       >      >      >     the *car*
> >>>>       >      >      >      >      >> package.
> >>>>       >      >      >      >      >>> As expected, however, this
> function
> >>>>      does not
> >>>>       >      >     report sensible
> >>>>       >      >      >      >     diagnostics
> >>>>       >      >      >      >      >>> for multinomial models -- not
> even
> >>> for
> >>>>       >     standard
> >>>>       >      >     ones fit
> >>>>       >      >      >     by the
> >>>>       >      >      >      >     *nnet*
> >>>>       >      >      >      >      >>> package's *multinom()* function.
> >>>>      The reason, I
> >>>>       >      >     presume, is
> >>>>       >      >      >      >     because a
> >>>>       >      >      >      >      >>> multinomial model is not really
> one
> >>>>      but C-1
> >>>>       >      >     regression
> >>>>       >      >      >     models
> >>>>       >      >      >      >     (where C
> >>>>       >      >      >      >      >> is
> >>>>       >      >      >      >      >>> the number of response
> categories)
> >>>>      and the
> >>>>       >     *vif()*
> >>>>       >      >      >     function is not
> >>>>       >      >      >      >      >> designed
> >>>>       >      >      >      >      >>> to deal with this scenario.
> >>>>       >      >      >      >      >>>
> >>>>       >      >      >      >      >>> Therefore, in order to obtain
> >>>>      meaningful
> >>>>       >     collinearity
> >>>>       >      >      >     metrics,
> >>>>       >      >      >      >     my present
> >>>>       >      >      >      >      >>> plan is to write a simple helper
> >>>>      function
> >>>>       >     that uses
> >>>>       >      >      >     *vif() *to
> >>>>       >      >      >      >     calculate
> >>>>       >      >      >      >      >>> and present (generalized)
> variance
> >>>>      inflation
> >>>>       >      >     metrics for
> >>>>       >      >      >     the C-1
> >>>>       >      >      >      >      >>> sub-datasets to which the C-1
> >>> component
> >>>>       >     binomial
> >>>>       >      >     models
> >>>>       >      >      >     of the
> >>>>       >      >      >      >     overall
> >>>>       >      >      >      >      >>> multinomial model are fit. In
> other
> >>>>      words, it
> >>>>       >      >     will partition
> >>>>       >      >      >      >     the data
> >>>>       >      >      >      >      >> into
> >>>>       >      >      >      >      >>> those C-1 subsets, and then
> apply
> >>>>      *vif()*
> >>>>       >     to as
> >>>>       >      >     many linear
> >>>>       >      >      >      >     regressions
> >>>>       >      >      >      >      >>> using a made-up continuous
> response
> >>> and
> >>>>       >     the fixed
> >>>>       >      >     effects of
> >>>>       >      >      >      >     interest.
> >>>>       >      >      >      >      >>>
> >>>>       >      >      >      >      >>> Does this seem like a sensible
> >>>>      approach?
> >>>>       >      >      >      >      >>>
> >>>>       >      >      >      >      >>> Best,
> >>>>       >      >      >      >      >>>
> >>>>       >      >      >      >      >>> Juho
> >>>>       >      >      >      >      >>>
> >>>>       >      >      >      >      >>>
> >>>>       >      >      >      >      >>>
> >>>>       >      >      >      >      >>
> >>>>       >      >      >      >      >>          [[alternative HTML
> version
> >>>>      deleted]]
> >>>>       >      >      >      >      >>
> >>>>       >      >      >      >      >>
> >>>>      _______________________________________________
> >>>>       >      >      >      >      >> R-sig-mixed-models at r-project.org
> >>>>      <mailto:R-sig-mixed-models at r-project.org>
> >>>>       >     <mailto:R-sig-mixed-models at r-project.org
> >>>>      <mailto:R-sig-mixed-models at r-project.org>>
> >>>>       >      >     <mailto:R-sig-mixed-models at r-project.org
> >>>>      <mailto:R-sig-mixed-models at r-project.org>
> >>>>       >     <mailto:R-sig-mixed-models at r-project.org
> >>>>      <mailto:R-sig-mixed-models at r-project.org>>>
> >>>>       >      >      >     <mailto:R-sig-mixed-models at r-project.org
> >>>>      <mailto:R-sig-mixed-models at r-project.org>
> >>>>       >     <mailto:R-sig-mixed-models at r-project.org
> >>>>      <mailto:R-sig-mixed-models at r-project.org>>
> >>>>       >      >     <mailto:R-sig-mixed-models at r-project.org
> >>>>      <mailto:R-sig-mixed-models at r-project.org>
> >>>>       >     <mailto:R-sig-mixed-models at r-project.org
> >>>>      <mailto:R-sig-mixed-models at r-project.org>>>>
> >>>>       >      >      >      >     <mailto:
> R-sig-mixed-models at r-project.org
> >>>>      <mailto:R-sig-mixed-models at r-project.org>
> >>>>       >     <mailto:R-sig-mixed-models at r-project.org
> >>>>      <mailto:R-sig-mixed-models at r-project.org>>
> >>>>       >      >     <mailto:R-sig-mixed-models at r-project.org
> >>>>      <mailto:R-sig-mixed-models at r-project.org>
> >>>>       >     <mailto:R-sig-mixed-models at r-project.org
> >>>>      <mailto:R-sig-mixed-models at r-project.org>>>
> >>>>       >      >      >     <mailto:R-sig-mixed-models at r-project.org
> >>>>      <mailto:R-sig-mixed-models at r-project.org>
> >>>>       >     <mailto:R-sig-mixed-models at r-project.org
> >>>>      <mailto:R-sig-mixed-models at r-project.org>>
> >>>>       >      >     <mailto:R-sig-mixed-models at r-project.org
> >>>>      <mailto:R-sig-mixed-models at r-project.org>
> >>>>       >     <mailto:R-sig-mixed-models at r-project.org
> >>>>      <mailto:R-sig-mixed-models at r-project.org>>>>> mailing list
> >>>>       >      >      >      >      >>
> >>>>       >      >
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >>>>      <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
> >>>>       >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >>>>      <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>
> >>>>       >      >
> >>>>        <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >>>>      <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
> >>>>       >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >>>>      <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>>
> >>>>       >      >      >
> >>>>       >       <
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >>>>      <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
> >>>>       >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >>>>      <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>
> >>>>       >      >
> >>>>        <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >>>>      <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
> >>>>       >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >>>>      <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>>>
> >>>>       >      >      >      >
> >>>>       >      >
> >>>>        <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >>>>      <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
> >>>>       >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >>>>      <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>
> >>>>       >      >
> >>>>        <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >>>>      <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
> >>>>       >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >>>>      <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>>
> >>>>       >      >      >
> >>>>       >       <
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >>>>      <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
> >>>>       >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >>>>      <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>
> >>>>       >      >
> >>>>        <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >>>>      <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
> >>>>       >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >>>>      <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>>>>
> >>>>       >      >      >      >      >>
> >>>>       >      >      >      >      >
> >>>>       >      >      >      >      >       [[alternative HTML version
> >>>>      deleted]]
> >>>>       >      >      >      >      >
> >>>>       >      >      >      >      >
> >>>>      _______________________________________________
> >>>>       >      >      >      >      > R-sig-mixed-models at r-project.org
> >>>>      <mailto:R-sig-mixed-models at r-project.org>
> >>>>       >     <mailto:R-sig-mixed-models at r-project.org
> >>>>      <mailto:R-sig-mixed-models at r-project.org>>
> >>>>       >      >     <mailto:R-sig-mixed-models at r-project.org
> >>>>      <mailto:R-sig-mixed-models at r-project.org>
> >>>>       >     <mailto:R-sig-mixed-models at r-project.org
> >>>>      <mailto:R-sig-mixed-models at r-project.org>>>
> >>>>       >      >      >     <mailto:R-sig-mixed-models at r-project.org
> >>>>      <mailto:R-sig-mixed-models at r-project.org>
> >>>>       >     <mailto:R-sig-mixed-models at r-project.org
> >>>>      <mailto:R-sig-mixed-models at r-project.org>>
> >>>>       >      >     <mailto:R-sig-mixed-models at r-project.org
> >>>>      <mailto:R-sig-mixed-models at r-project.org>
> >>>>       >     <mailto:R-sig-mixed-models at r-project.org
> >>>>      <mailto:R-sig-mixed-models at r-project.org>>>>
> >>>>       >      >      >      >     <mailto:
> R-sig-mixed-models at r-project.org
> >>>>      <mailto:R-sig-mixed-models at r-project.org>
> >>>>       >     <mailto:R-sig-mixed-models at r-project.org
> >>>>      <mailto:R-sig-mixed-models at r-project.org>>
> >>>>       >      >     <mailto:R-sig-mixed-models at r-project.org
> >>>>      <mailto:R-sig-mixed-models at r-project.org>
> >>>>       >     <mailto:R-sig-mixed-models at r-project.org
> >>>>      <mailto:R-sig-mixed-models at r-project.org>>>
> >>>>       >      >      >     <mailto:R-sig-mixed-models at r-project.org
> >>>>      <mailto:R-sig-mixed-models at r-project.org>
> >>>>       >     <mailto:R-sig-mixed-models at r-project.org
> >>>>      <mailto:R-sig-mixed-models at r-project.org>>
> >>>>       >      >     <mailto:R-sig-mixed-models at r-project.org
> >>>>      <mailto:R-sig-mixed-models at r-project.org>
> >>>>       >     <mailto:R-sig-mixed-models at r-project.org
> >>>>      <mailto:R-sig-mixed-models at r-project.org>>>>> mailing list
> >>>>       >      >      >      >      >
> >>>>       >      >
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >>>>      <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
> >>>>       >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >>>>      <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>
> >>>>       >      >
> >>>>        <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >>>>      <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
> >>>>       >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >>>>      <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>>
> >>>>       >      >      >
> >>>>       >       <
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >>>>      <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
> >>>>       >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >>>>      <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>
> >>>>       >      >
> >>>>        <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >>>>      <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
> >>>>       >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >>>>      <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>>>
> >>>>       >      >      >      >
> >>>>       >      >
> >>>>        <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >>>>      <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
> >>>>       >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >>>>      <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>
> >>>>       >      >
> >>>>        <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >>>>      <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
> >>>>       >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >>>>      <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>>
> >>>>       >      >      >
> >>>>       >       <
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >>>>      <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
> >>>>       >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >>>>      <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>
> >>>>       >      >
> >>>>        <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >>>>      <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
> >>>>       >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >>>>      <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>>>>
> >>>>       >      >      >      >     --
> >>>>       >      >      >      >     John Fox, Professor Emeritus
> >>>>       >      >      >      >     McMaster University
> >>>>       >      >      >      >     Hamilton, Ontario, Canada
> >>>>       >      >      >      >     web:
> >>>>      https://socialsciences.mcmaster.ca/jfox/
> >>>>      <https://socialsciences.mcmaster.ca/jfox/>
> >>>>       >     <https://socialsciences.mcmaster.ca/jfox/
> >>>>      <https://socialsciences.mcmaster.ca/jfox/>>
> >>>>       >      >     <https://socialsciences.mcmaster.ca/jfox/
> >>>>      <https://socialsciences.mcmaster.ca/jfox/>
> >>>>       >     <https://socialsciences.mcmaster.ca/jfox/
> >>>>      <https://socialsciences.mcmaster.ca/jfox/>>>
> >>>>       >      >      >     <https://socialsciences.mcmaster.ca/jfox/
> >>>>      <https://socialsciences.mcmaster.ca/jfox/>
> >>>>       >     <https://socialsciences.mcmaster.ca/jfox/
> >>>>      <https://socialsciences.mcmaster.ca/jfox/>>
> >>>>       >      >     <https://socialsciences.mcmaster.ca/jfox/
> >>>>      <https://socialsciences.mcmaster.ca/jfox/>
> >>>>       >     <https://socialsciences.mcmaster.ca/jfox/
> >>>>      <https://socialsciences.mcmaster.ca/jfox/>>>>
> >>>>       >      >      >      >
> >>>>        <https://socialsciences.mcmaster.ca/jfox/
> >>>>      <https://socialsciences.mcmaster.ca/jfox/>
> >>>>       >     <https://socialsciences.mcmaster.ca/jfox/
> >>>>      <https://socialsciences.mcmaster.ca/jfox/>>
> >>>>       >      >     <https://socialsciences.mcmaster.ca/jfox/
> >>>>      <https://socialsciences.mcmaster.ca/jfox/>
> >>>>       >     <https://socialsciences.mcmaster.ca/jfox/
> >>>>      <https://socialsciences.mcmaster.ca/jfox/>>>
> >>>>       >      >      >     <https://socialsciences.mcmaster.ca/jfox/
> >>>>      <https://socialsciences.mcmaster.ca/jfox/>
> >>>>       >     <https://socialsciences.mcmaster.ca/jfox/
> >>>>      <https://socialsciences.mcmaster.ca/jfox/>>
> >>>>       >      >     <https://socialsciences.mcmaster.ca/jfox/
> >>>>      <https://socialsciences.mcmaster.ca/jfox/>
> >>>>       >     <https://socialsciences.mcmaster.ca/jfox/
> >>>>      <https://socialsciences.mcmaster.ca/jfox/>>>>>
> >>>>       >      >      >      >
> >>>>       >      >      >     --
> >>>>       >      >      >     John Fox, Professor Emeritus
> >>>>       >      >      >     McMaster University
> >>>>       >      >      >     Hamilton, Ontario, Canada
> >>>>       >      >      >     web:
> https://socialsciences.mcmaster.ca/jfox/
> >>>>      <https://socialsciences.mcmaster.ca/jfox/>
> >>>>       >     <https://socialsciences.mcmaster.ca/jfox/
> >>>>      <https://socialsciences.mcmaster.ca/jfox/>>
> >>>>       >      >     <https://socialsciences.mcmaster.ca/jfox/
> >>>>      <https://socialsciences.mcmaster.ca/jfox/>
> >>>>       >     <https://socialsciences.mcmaster.ca/jfox/
> >>>>      <https://socialsciences.mcmaster.ca/jfox/>>>
> >>>>       >      >      >     <https://socialsciences.mcmaster.ca/jfox/
> >>>>      <https://socialsciences.mcmaster.ca/jfox/>
> >>>>       >     <https://socialsciences.mcmaster.ca/jfox/
> >>>>      <https://socialsciences.mcmaster.ca/jfox/>>
> >>>>       >      >     <https://socialsciences.mcmaster.ca/jfox/
> >>>>      <https://socialsciences.mcmaster.ca/jfox/>
> >>>>       >     <https://socialsciences.mcmaster.ca/jfox/
> >>>>      <https://socialsciences.mcmaster.ca/jfox/>>>>
> >>>>       >      >      >
> >>>>       >      >     --
> >>>>       >      >     John Fox, Professor Emeritus
> >>>>       >      >     McMaster University
> >>>>       >      >     Hamilton, Ontario, Canada
> >>>>       >      >     web: https://socialsciences.mcmaster.ca/jfox/
> >>>>      <https://socialsciences.mcmaster.ca/jfox/>
> >>>>       >     <https://socialsciences.mcmaster.ca/jfox/
> >>>>      <https://socialsciences.mcmaster.ca/jfox/>>
> >>>>       >      >     <https://socialsciences.mcmaster.ca/jfox/
> >>>>      <https://socialsciences.mcmaster.ca/jfox/>
> >>>>       >     <https://socialsciences.mcmaster.ca/jfox/
> >>>>      <https://socialsciences.mcmaster.ca/jfox/>>>
> >>>>       >      >
> >>>>       >
> >>>>
> >>>
>  ------------------------------------------------------------------------
> >>>>       >     --
> >>>>       >     John Fox, Professor Emeritus
> >>>>       >     McMaster University
> >>>>       >     Hamilton, Ontario, Canada
> >>>>       >     web: https://socialsciences.mcmaster.ca/jfox/
> >>>>      <https://socialsciences.mcmaster.ca/jfox/>
> >>>>       >     <https://socialsciences.mcmaster.ca/jfox/
> >>>>      <https://socialsciences.mcmaster.ca/jfox/>>
> >>>>       >
> >>>>      --
> >>>>      John Fox, Professor Emeritus
> >>>>      McMaster University
> >>>>      Hamilton, Ontario, Canada
> >>>>      web: https://socialsciences.mcmaster.ca/jfox/
> >>>>      <https://socialsciences.mcmaster.ca/jfox/>
> >>>>
> >>> --
> >>> John Fox, Professor Emeritus
> >>> McMaster University
> >>> Hamilton, Ontario, Canada
> >>> web: https://socialsciences.mcmaster.ca/jfox/
> >>>
> >>>
> >>
> >>      [[alternative HTML version deleted]]
> >>
> >> _______________________________________________
> >> R-sig-mixed-models at r-project.org mailing list
> >> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >>
>
>

	[[alternative HTML version deleted]]


From j|ox @end|ng |rom mcm@@ter@c@  Thu Feb  2 23:01:02 2023
From: j|ox @end|ng |rom mcm@@ter@c@ (John Fox)
Date: Thu, 2 Feb 2023 17:01:02 -0500
Subject: [R-sig-ME] 
 Collinearity diagnostics for (mixed) multinomial models
In-Reply-To: <CAG_dBVfUCfbVTpNjGRrn6pMjPw+_z_diy10pgy5dqnqvJsPz2Q@mail.gmail.com>
References: <mailman.19600.5.1645786802.52378.r-sig-mixed-models@r-project.org>
 <ec746b24-eb5b-5579-2b24-3c3b492d55d9@mcmaster.ca>
 <CAG_dBVfcpzW5RAs9syWFdL+RvryeAppowexjX_a9zJqRu+PC4Q@mail.gmail.com>
 <7e05d26d-e8af-aa48-8fd4-543c9f3dc3a2@mcmaster.ca>
 <CAG_dBVenhHeF5-hmA7M6xfD2FAeLmqzwc6AL-xrVREZuKyyKpA@mail.gmail.com>
 <67a63dca-f3c0-d766-0a2a-bad1a5fed9c3@mcmaster.ca>
 <CAG_dBVcv+12Q6_dSdX7_2cBPR5PgQmJ5bqZgQoWh88ATCmT6GA@mail.gmail.com>
 <0f03187e-d848-ea43-e370-ead2d403b530@mcmaster.ca>
 <CAG_dBVfv2-8Z0VRvcK4QUP97oh5jOhPd2d=LUj0N_6Ec+appMw@mail.gmail.com>
 <f80557f3-35c7-7b22-ae9c-2f14ff0d7ac0@mcmaster.ca>
 <CAG_dBVe7f5aEB_hA5t-j2u9ZJw-bDQPOchxc3-QTX3VejqXQSQ@mail.gmail.com>
 <d8c397b8-fbec-6c39-fdf5-5047daf6f219@mcmaster.ca>
 <CAG_dBVc2Vw6mQ17ZvXM+vJvvON9D=jHsXp+_3gM7m1zukNAAuQ@mail.gmail.com>
 <dfd31e31-511c-73c0-a8a4-dfc2a3e37b20@phillipalday.com>
 <6ffe007d-b9f4-5fd1-87f9-152697012047@mcmaster.ca>
 <CAG_dBVfUCfbVTpNjGRrn6pMjPw+_z_diy10pgy5dqnqvJsPz2Q@mail.gmail.com>
Message-ID: <95fa2733-b3ec-8c23-c71b-850720c7f3c7@mcmaster.ca>

Dear Juho,

On 2023-02-02 4:08 p.m., Juho Kristian Ruohonen wrote:
> Many thanks to John and Philip (and Georges behind the scenes). I'll 
> keep an eye on this thread. If there's a solution before my thesis goes 
> to print, I'll certainly adopt it posthaste.
> 
> Otherwise, I might just end up reporting all C-1 GVIF^(1/(2*DF)) 
> statistics for each binary subregression for each predictor, as 
> calculated by car::vif(). It's a bit messy, but then multinomial models 
> themselves are messy with their C-1 sets of coefficients, and this would 
> be no different. At least it's maximally transparent.

Georges made a similar suggestion in our discussions, but there's a 
problem: the multinomial logit model logits are for each other level of 
the response (say B, C, D) vs the baseline level (A), while the 
individual binary logits would be for, say, A vs. {B, C, D}, B vs. {A, 
C, D}, etc. One could fit binary logit models to subsets of the data, B 
vs. A for those for whom the response is A or B, etc., but I believe the 
coefficients would differ from those for the multinomial logit model.

> 
> That said, I hope our experts reach a breakthrough.

You're more optimistic than I am. Georges has a good explanation for why 
the GVIF works with the multivariate linear model, but the necessary 
properties aren't shared by the multinomial logit model.

Best,
  John

> 
> Best,
> 
> Juho
> 
> 
> 
> 
> 
> ke 1. helmik. 2023 klo 18.19 John Fox (jfox at mcmaster.ca 
> <mailto:jfox at mcmaster.ca>) kirjoitti:
> 
>     Dear Phillip (and Juho),
> 
>     You raise a reasonable point but, unfortunately, one that isn't really
>     relevant to the problem at hand.
> 
>     Applied to a linear model, which is the context in which generalized
>     variance inflation was originally defined in the paper by me and
>     Georges
>     Monette cited in ?car::vif, the GVIF *is* invariant with respect to
>     inessential changes to the model such as centering regressors or any
>     change in the bases for the regressor subspaces of terms in the model.
>     The GVIF compares the size of the joint confidence region for the
>     set of
>     coefficients for a term in the model to its size in a utopian situation
>     in which the subspace for the term is orthogonal to the subspaces of
>     the
>     other terms, and reduces to the usual VIF when the term in
>     one-dimensional.
> 
>     Generalized variance inflation has subsequently been extended to some
>     other regression models, such as generalized linear models, and it
>     retains these essential invariances (although interpretation isn't as
>     straightforward).
> 
>     In response to Juho's original question, I conjectured an extension to
>     multinomial logit models, tested some of its invariance properties, but
>     unfortunately didn't test sufficiently extensively. (I did suggest
>     additional tests that I didn't perform.) It's clear from Juho's example
>     that my conjecture was wrong.
> 
>     The reason that I hadn't yet responded to Juho's recent question is
>     that
>     Georges and I are still trying to understand why my proposed definition
>     fails for multinomial logit models. It appears to work, for example,
>     for
>     multivariate linear models. Neither of us, at this point, has a
>     solution
>     to Juho's problem, and it's possible that there isn't one. We're
>     continuing to discuss the problem, and one of us will post an update to
>     the list if we come up with either a solution or a clear explanation of
>     why my proposal failed.
> 
>     Thank you for prompting me to reply, if only in a preliminary manner.
> 
>     Best,
>      ? John
> 
>     -- 
>     John Fox, Professor Emeritus
>     McMaster University
>     Hamilton, Ontario, Canada
>     web: https://socialsciences.mcmaster.ca/jfox/
>     <https://socialsciences.mcmaster.ca/jfox/>
> 
>     On 2023-02-01 12:19 a.m., Phillip Alday wrote:
>      > I haven't seen an answer go by yet, but here's a breadcrumb:
>      >
>      > Iacobucci, D., Schneider, M.J., Popovich, D.L. et al. Mean centering
>      > helps alleviate ?micro? but not ?macro? multicollinearity. Behav
>     Res 48,
>      > 1308?1317 (2016). https://doi.org/10.3758/s13428-015-0624-x
>     <https://doi.org/10.3758/s13428-015-0624-x>
>      >
>      >
>      >
>      > On 26/1/23 8:56 am, Juho Kristian Ruohonen wrote:
>      >> Dear all,
>      >>
>      >> I'm resurrecting this thread because a problem has come up which
>     might need
>      >> fixing once someone gets around to writing a relevant R package.
>      >>
>      >> In this same thread last March, John Fox showed me how to
>     compute GVIFs for
>      >> a *nnet* multinomial model. I then wrote a simple function that
>     loops
>      >> through all predictors in such a model and applies John's code
>     to them,
>      >> returning the GVIF, DF, and GVIF^(1/(2*Df)) statistic for each
>     predictor.
>      >> Available here
>      >> <https://github.com/jkruohon/StatsMisc/blob/main/gvif_multinom.R
>     <https://github.com/jkruohon/StatsMisc/blob/main/gvif_multinom.R>>, the
>      >> function seems to work just fine, reproducing John's results
>     exactly on the
>      >> carData examples. Likewise, applying this function to my own
>     research data
>      >> yielded entirely plausible results.
>      >>
>      >> But to my horror, I now discover that *when I refit my
>     multinomial model
>      >> with two quantitative predictors centered, the GVIF statistics
>     change
>      >> considerably** -- *even though the model has the same fit and
>     virtually
>      >> identical coefficients (except for the intercepts) as the
>     original one. How
>      >> can this be? The only thing that changes between the two models
>     is the set
>      >> of intercepts which, moreover, are specifically excluded from
>     the GVIF
>      >> calculations.
>      >>
>      >> Below is a minimal example. The anonymized datafile is
>     downloadable here
>      >> <https://github.com/jkruohon/StatsMisc/raw/main/d_anon.RData
>     <https://github.com/jkruohon/StatsMisc/raw/main/d_anon.RData>>.
>      >>
>      >>> mod1 <- multinom(y ~., data = d.anon, maxit = 999)
>      >>> gvif.multinom(mod1) # x6 and x26 top the collinearity list
>      >>? ? ? ? ? ? ? GVIF DF GVIF^(1/(2df))
>      >> x6? 3.463522e+03? 3? ? ? ?3.889732
>      >> x26 2.988396e+03? 3? ? ? ?3.795244
>      >> x27 1.390830e+03? 3? ? ? ?3.341019
>      >> x2? 3.889656e+02? 3? ? ? ?2.701792
>      >> x13 2.930026e+02? 3? ? ? ?2.577183
>      >> x19 2.051250e+04? 6? ? ? ?2.287362
>      >> x25 7.043339e+03? 6? ? ? ?2.092417
>      >> x24 1.078212e+07 12? ? ? ?1.963493
>      >> x9? 2.357662e+01? 3? ? ? ?1.693351
>      >> x17 1.991744e+01? 3? ? ? ?1.646413
>      >> x5? 3.869759e+02? 6? ? ? ?1.643010
>      >> x12 1.787075e+01? 3? ? ? ?1.616927
>      >> x18 2.943991e+02? 6? ? ? ?1.605997
>      >> x1? 2.700175e+03? 9? ? ? ?1.551075
>      >> x16 2.576739e+04 12? ? ? ?1.526844
>      >> x7? 1.483341e+02? 6? ? ? ?1.516829
>      >> x20 1.159374e+01? 3? ? ? ?1.504425
>      >> x3? 1.612637e+04 12? ? ? ?1.497318
>      >> x28 1.081693e+01? 3? ? ? ?1.487136
>      >> x10 9.706880e+00? 3? ? ? ?1.460539
>      >> x22 9.459035e+00? 3? ? ? ?1.454257
>      >> x15 9.124519e+00? 3? ? ? ?1.445556
>      >> x14 7.017242e+00? 3? ? ? ?1.383655
>      >> x21 6.404687e+00? 3? ? ? ?1.362750
>      >> x8? 6.072614e+00? 3? ? ? ?1.350712
>      >> x11 4.797251e+00? 3? ? ? ?1.298670
>      >> x4? 3.665742e+03 18? ? ? ?1.256043
>      >> x23 3.557201e+00? 3? ? ? ?1.235525
>      >>
>      >> Now we refit the model with the quantitative predictors x6 and
>     x26 centered:
>      >>
>      >>> d.anon$x6 <- d.anon$x6 - mean(d.anon$x6)
>      >>> d.anon$x26 <- d.anon$x26 - mean(d.anon$x26)
>      >>> mod2 <- update(mod1, data = d.anon, maxit = 999)
>      >>> c(logLik(mod1), logLik(mod2))? # same fit to the data
>      >> [1] -2074.133 -2074.134
>      >>
>      >>> gvif.multinom(mod2)
>      >>? ? ? ? ? ? ? GVIF DF GVIF^(1/(2df))
>      >> x2? 6.196959e+04? 3? ? ? ?6.290663
>      >> x13 3.031115e+04? 3? ? ? ?5.583850
>      >> x27 2.552811e+04? 3? ? ? ?5.426291
>      >> x14 1.642231e+04? 3? ? ? ?5.041646
>      >> x6? 1.573721e+04? 3? ? ? ?5.005967
>      >> x26 1.464437e+04? 3? ? ? ?4.946277
>      >> x9? 1.262667e+04? 3? ? ? ?4.825564
>      >> x10 5.714321e+03? 3? ? ? ?4.228251
>      >> x19 2.255013e+07? 6? ? ? ?4.099798
>      >> x25 1.227033e+07? 6? ? ? ?3.897068
>      >> x12 3.394139e+03? 3? ? ? ?3.876635
>      >> x15 1.938364e+03? 3? ? ? ?3.531067
>      >> x11 1.685265e+03? 3? ? ? ?3.449674
>      >> x21 8.429450e+02? 3? ? ? ?3.073500
>      >> x23 7.639755e+02? 3? ? ? ?3.023523
>      >> x22 6.887451e+02? 3? ? ? ?2.971733
>      >> x17 5.640312e+02? 3? ? ? ?2.874422
>      >> x20 3.855848e+02? 3? ? ? ?2.697864
>      >> x24 1.444083e+10 12? ? ? ?2.650430
>      >> x7? 7.148911e+04? 6? ? ? ?2.538166
>      >> x18 1.674603e+04? 6? ? ? ?2.249017
>      >> x5? 9.662266e+03? 6? ? ? ?2.148275
>      >> x16 6.264044e+07 12? ? ? ?2.112851
>      >> x1? 6.634544e+05? 9? ? ? ?2.105882
>      >> x3? 1.558132e+07 12? ? ? ?1.993847
>      >> x8? 6.168472e+01? 3? ? ? ?1.987755
>      >> x4? 4.256459e+06 18? ? ? ?1.528059
>      >> x28 9.783234e+00? 3? ? ? ?1.462448
>      >>
>      >> And so I'm at my wits' end. The models are virtually identical,
>     yet the
>      >> GVIF statistics are very different. I don't know which ones to
>     trust.
>      >> Worse, the discrepancy makes me disinclined to trust either of
>     them --
>      >> which is a return to Square One, i.e. the situation where GVIF
>     statistics
>      >> for multinomial models did not exist. And I don't know which
>      >> multicollinearity metric I can present in my thesis, if any.
>      >>
>      >> I hope someone can help.
>      >>
>      >> Best,
>      >>
>      >> Juho
>      >>
>      >>
>      >>
>      >>
>      >>
>      >> ke 2. maalisk. 2022 klo 16.35 John Fox (jfox at mcmaster.ca
>     <mailto:jfox at mcmaster.ca>) kirjoitti:
>      >>
>      >>> Dear Juho,
>      >>>
>      >>> On 2022-03-02 6:23 a.m., Juho Kristian Ruohonen wrote:
>      >>>> One last comment, John: Sorry if I seemed to be implying that
>     you (or
>      >>>> anyone else) should debug my code for me. That wasn't the
>     idea. I do
>      >>>> believe that the function locates the intended rows/columns
>      >>>> successfully. I just wasn't entirely positive what those intended
>      >>>> rows/columns should be when dealing with a multicategory factor.
>      >>>> Presently, it locates every row/column involving the multicategory
>      >>>> factor in question, so the number of rows/columns identified
>     is the
>      >>>> number of factor levels minus one, times the number of response
>      >>>> categories minus one. I hope that's correct.
>      >>>
>      >>> OK, that's a fair remark. Yes, what you describe is correct.
>      >>>
>      >>> You can also reassure yourself that your function is working
>     properly by:
>      >>>
>      >>> (1) If you haven't already done so, show that you get the same
>     GVIFs
>      >>> from your function as from the one I sent you used directly.
>      >>>
>      >>> (2) Vary the baseline level of the response variable and
>     confirm that
>      >>> you get the same GVIFs.
>      >>>
>      >>> (3) Vary the basis for the regressor subspace for a factor,
>     e.g., either
>      >>> by using contr.sum() in place of the default contr.treatment()
>     or by
>      >>> changing the baseline level of the factor for
>     contr.treatment(), and
>      >>> again confirm that the GVIFs are unchanged.
>      >>>
>      >>> Best,
>      >>>? ? John
>      >>>
>      >>>>
>      >>>> My current plan is to present the output of the new function in my
>      >>>> thesis and credit you for the math. But if *vif()* gets a relevant
>      >>>> update before my project is finished, then I'll use that and
>     cite the
>      >>>> /car /package instead.
>      >>>>
>      >>>> Thanks again for your help.
>      >>>>
>      >>>> Best,
>      >>>>
>      >>>> Juho
>      >>>>
>      >>>> ti 1. maalisk. 2022 klo 23.54 John Fox (jfox at mcmaster.ca
>     <mailto:jfox at mcmaster.ca>
>      >>>> <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>) kirjoitti:
>      >>>>
>      >>>>? ? ? Dear Juho,
>      >>>>
>      >>>>? ? ? On 2022-03-01 3:13 p.m., Juho Kristian Ruohonen wrote:
>      >>>>? ? ? ?> Dear John,
>      >>>>? ? ? ?>
>      >>>>? ? ? ?> Yes, my function uses your code for the math. I was
>     just hoping to
>      >>>>? ? ? ?> verify that it is handling multicategory factors
>     correctly (your
>      >>>>? ? ? ?> examples didn't involve any).
>      >>>>
>      >>>>? ? ? That's not really my point. Your code sets up
>     computations for the
>      >>>>? ? ? various terms in the model automatically, while the
>     function I sent
>      >>>>? ? ? requires that you locate the rows/columns for the
>     intercepts and each
>      >>>>? ? ? focal term manually. If you haven't already done so, you
>     could check
>      >>>>? ? ? that your function is identifying the correct columns and
>     getting the
>      >>>>? ? ? corresponding GVIFs.
>      >>>>
>      >>>>? ? ? ?>
>      >>>>? ? ? ?> I guess interactions aren't that important after all,
>     given that
>      >>> the
>      >>>>? ? ? ?> chief concern is usually collinearity among main effects.
>      >>>>
>      >>>>? ? ? I wouldn't say that, but it's not clear what collinearity
>     means in
>      >>>>? ? ? models with interactions, and if you compute VIFs or
>     GVIFs for "main
>      >>>>? ? ? effects" in models with interactions, you'll probably get
>     nonsense.
>      >>>>
>      >>>>? ? ? As I said, I think that this might be a solvable problem,
>     but one
>      >>> that
>      >>>>? ? ? requires thought about what needs to remain invariant.
>      >>>>
>      >>>>? ? ? I think that we've probably come to end for now.
>      >>>>
>      >>>>? ? ? John
>      >>>>
>      >>>>? ? ? ?>
>      >>>>? ? ? ?> Many thanks for all your help.
>      >>>>? ? ? ?>
>      >>>>? ? ? ?> Best,
>      >>>>? ? ? ?>
>      >>>>? ? ? ?> Juho
>      >>>>? ? ? ?>
>      >>>>? ? ? ?> ti 1. maalisk. 2022 klo 18.01 John Fox
>     (jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
>      >>>>? ? ? <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>
>      >>>>? ? ? ?> <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
>     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>>) kirjoitti:
>      >>>>? ? ? ?>
>      >>>>? ? ? ?>? ? ?Dear Juho,
>      >>>>? ? ? ?>
>      >>>>? ? ? ?>? ? ?On 2022-03-01 8:24 a.m., Juho Kristian Ruohonen wrote:
>      >>>>? ? ? ?>? ? ? > Dear John (Fox, as well as other list members),
>      >>>>? ? ? ?>? ? ? >
>      >>>>? ? ? ?>? ? ? > I've now written a simple function to try and
>     calculate
>      >>>>? ? ? GVIFS for
>      >>>>? ? ? ?>? ? ?all
>      >>>>? ? ? ?>? ? ? > predictors in a nnet::multinom() object based
>     on John's
>      >>>>? ? ? example
>      >>>>? ? ? ?>? ? ?code. If
>      >>>>? ? ? ?>? ? ? > its results are correct (see below), I will
>     proceed to
>      >>> write a
>      >>>>? ? ? ?>? ? ?version
>      >>>>? ? ? ?>? ? ? > that also works with mixed-effects multinomial
>     models fit
>      >>> by
>      >>>>? ? ? ?>? ? ? > brms::brm(). Here's the code:
>      >>>>? ? ? ?>? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ?gvif.multinom <- function(model){
>      >>>>? ? ? ?>? ? ? >? ? ? ? (classes <- model$lev)
>      >>>>? ? ? ?>? ? ? >? ? ? ? (V.all <- vcov(model))
>      >>>>? ? ? ?>? ? ? >? ? ? ? (V.noIntercepts <-
>     V.all[!grepl("\\(Intercept\\)$",
>      >>>>? ? ? ?>? ? ? >? ? ?rownames(V.all), perl = T),
>      >>>>? ? ? ?>? ? ? >                               
>      ?!grepl("\\(Intercept\\)$",
>      >>>>? ? ? ?>? ? ? >? ? ?colnames(V.all), perl = T)])
>      >>>>? ? ? ?>? ? ? >? ? ? ? (R <- cov2cor(V.noIntercepts))
>      >>>>? ? ? ?>? ? ? >? ? ? ? (terms <- attr(model$terms, "term.labels"))
>      >>>>? ? ? ?>? ? ? >? ? ? ? (gvif <- numeric(length = length(terms)))
>      >>>>? ? ? ?>? ? ? >? ? ? ? (names(gvif) <- terms)
>      >>>>? ? ? ?>? ? ? >? ? ? ? (SE.multiplier <- numeric(length =
>     length(terms)))
>      >>>>? ? ? ?>? ? ? >? ? ? ? (names(SE.multiplier) <- terms)
>      >>>>? ? ? ?>? ? ? >? ? ? ? #The line below tries to capture all
>     factor levels
>      >>>>? ? ? into a
>      >>>>? ? ? ?>? ? ?regex
>      >>>>? ? ? ?>? ? ? >? ? ?for coef name matching.
>      >>>>? ? ? ?>? ? ? >? ? ? ? (LevelsRegex <- paste0("(",
>      >>>>? ? ? paste(unlist(model$xlevels),
>      >>>>? ? ? ?>? ? ?collapse
>      >>>>? ? ? ?>? ? ? >? ? ?= "|"),")?"))
>      >>>>? ? ? ?>? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ? ? for(i in terms){
>      >>>>? ? ? ?>? ? ? >? ? ? ? ? #The regex stuff below tries to ensure all
>      >>>>? ? ? interaction
>      >>>>? ? ? ?>? ? ? >? ? ?coefficients are matched, including those
>     involving
>      >>>>? ? ? factors.
>      >>>>? ? ? ?>? ? ? >? ? ? ? ? if(grepl(":", i)){
>      >>>>? ? ? ?>? ? ? >? ? ? ? ? ? (termname <- gsub(":",
>     paste0(LevelsRegex,
>      >>> ":"), i,
>      >>>>? ? ? ?>? ? ?perl = T))
>      >>>>? ? ? ?>? ? ? >? ? ? ? ? }else{termname <- i}
>      >>>>? ? ? ?>? ? ? >? ? ? ? ? (RegexToMatch <- paste0("^(",
>      >>>>? ? ? ?>? ? ?paste(classes[2:length(classes)],
>      >>>>? ? ? ?>? ? ? >? ? ?collapse = "|") ,"):", termname,
>     LevelsRegex, "$"))
>      >>>>? ? ? ?>? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ? ? ? #Now the actual calculation:
>      >>>>? ? ? ?>? ? ? >? ? ? ? ? (indices <- grep(RegexToMatch,
>     rownames(R), perl
>      >>>>? ? ? = T))
>      >>>>? ? ? ?>? ? ? >? ? ? ? ? (gvif[i] <- det(R[indices, indices]) *
>      >>>>? ? ? det(R[-indices,
>      >>>>? ? ? ?>? ? ? >? ? ?-indices]) / det(R))
>      >>>>? ? ? ?>? ? ? >? ? ? ? ? (SE.multiplier[i] <-
>      >>> gvif[i]^(1/(2*length(indices))))
>      >>>>? ? ? ?>? ? ? >? ? ? ? }
>      >>>>? ? ? ?>? ? ? >? ? ? ? #Put the results together and order them
>     by degree
>      >>>>? ? ? of SE
>      >>>>? ? ? ?>? ? ?inflation:
>      >>>>? ? ? ?>? ? ? >? ? ? ? (result <- cbind(GVIF = gvif,
>     `GVIF^(1/(2df))` =
>      >>>>? ? ? ?>? ? ?SE.multiplier))
>      >>>>? ? ? ?>? ? ? >       
>     return(result[order(result[,"GVIF^(1/(2df))"],
>      >>>>? ? ? decreasing
>      >>>>? ? ? ?>? ? ?= T),])}
>      >>>>? ? ? ?>? ? ? >
>      >>>>? ? ? ?>? ? ? >
>      >>>>? ? ? ?>? ? ? > The results seem correct to me when applied to
>     John's
>      >>> example
>      >>>>? ? ? ?>? ? ?model fit
>      >>>>? ? ? ?>? ? ? > to the BEPS data. However, that dataset contains no
>      >>> multi-df
>      >>>>? ? ? ?>? ? ?factors, of
>      >>>>? ? ? ?>? ? ? > which my own models have many. Below is a
>     maximally simple
>      >>>>? ? ? ?>? ? ?example with
>      >>>>? ? ? ?>? ? ? > one multi-df factor (/region/):
>      >>>>? ? ? ?>? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ?mod1 <- multinom(partic ~., data =
>     carData::Womenlf)
>      >>>>? ? ? ?>? ? ? >? ? ?gvif.multinom(mod1)
>      >>>>? ? ? ?>? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ?GVIF GVIF^(1/(2df))
>      >>>>? ? ? ?>? ? ? >? ? ?children 1.298794? ? ? ?1.067542
>      >>>>? ? ? ?>? ? ? >? ? ?hincome? 1.184215? ? ? ?1.043176
>      >>>>? ? ? ?>? ? ? >? ? ?region? ?1.381480? ? ? ?1.020403
>      >>>>? ? ? ?>? ? ? >
>      >>>>? ? ? ?>? ? ? >
>      >>>>? ? ? ?>? ? ? > These results look plausible to me. Finally,
>     below is an
>      >>>>? ? ? example
>      >>>>? ? ? ?>? ? ? > involving both a multi-df factor and an
>     interaction:
>      >>>>? ? ? ?>? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ?mod2 <- update(mod1, ~. +children:region)
>      >>>>? ? ? ?>? ? ? >? ? ?gvif.multinom(mod2)
>      >>>>? ? ? ?>? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ? ? ? ? ? ? ? ? ? ? ? ? ? GVIF GVIF^(1/(2df))
>      >>>>? ? ? ?>? ? ? >? ? ?children:region 4.965762e+16? ? ? 11.053482
>      >>>>? ? ? ?>? ? ? >? ? ?region? ? ? ? ? 1.420418e+16? ? ? 10.221768
>      >>>>? ? ? ?>? ? ? >? ? ?children? ? ? ? 1.471412e+03? ? ? ?6.193463
>      >>>>? ? ? ?>? ? ? >? ? ?hincome? ? ? ? ?6.462161e+00? ? ? ?1.594390
>      >>>>? ? ? ?>? ? ? >
>      >>>>? ? ? ?>? ? ? >
>      >>>>? ? ? ?>? ? ? > These results look a bit more dubious. To be
>     sure, it is
>      >>> to be
>      >>>>? ? ? ?>? ? ?expected
>      >>>>? ? ? ?>? ? ? > that interaction terms will introduce a lot of
>      >>>>? ? ? collinearity. But an
>      >>>>? ? ? ?>? ? ? > 11-fold increase in SE? I hope someone can tell
>     me whether
>      >>>>? ? ? this is
>      >>>>? ? ? ?>? ? ? > correct or not!
>      >>>>? ? ? ?>
>      >>>>? ? ? ?>? ? ?You don't need someone else to check your work
>     because you
>      >>>>? ? ? could just
>      >>>>? ? ? ?>? ? ?apply the simple function that I sent you
>     yesterday, which,
>      >>>>? ? ? though not
>      >>>>? ? ? ?>? ? ?automatic, computes the GVIFs in a transparent manner.
>      >>>>? ? ? ?>
>      >>>>? ? ? ?>? ? ?A brief comment on GVIFs for models with
>     interactions (this
>      >>>>? ? ? isn't the
>      >>>>? ? ? ?>? ? ?place to discuss the question in detail): The Fox
>     and Monette
>      >>>>? ? ? JASA
>      >>>>? ? ? ?>? ? ?paper
>      >>>>? ? ? ?>? ? ?addresses the question briefly in the context of a
>     two-way
>      >>>>? ? ? ANOVA, but I
>      >>>>? ? ? ?>? ? ?don't think that the approach suggested there is
>     easily
>      >>>>? ? ? generalized.
>      >>>>? ? ? ?>
>      >>>>? ? ? ?>? ? ?The following simple approach pays attention to what's
>      >>>>? ? ? invariant under
>      >>>>? ? ? ?>? ? ?different parametrizations of the RHS side of the
>     model:
>      >>>>? ? ? Simultaneously
>      >>>>? ? ? ?>? ? ?check the collinearity of all of the coefficients
>     of an
>      >>>>? ? ? interaction
>      >>>>? ? ? ?>? ? ?together with the main effects and, potentially,
>     lower-order
>      >>>>? ? ? ?>? ? ?interactions that are marginal to it. So, e.g., in
>     the model
>      >>>>? ? ? y ~ a +
>      >>>>? ? ? ?>? ? ?b +
>      >>>>? ? ? ?>? ? ?a:b + c, you'd check all of the coefficients for
>     a, b, and
>      >>>>? ? ? a:b together.
>      >>>>? ? ? ?>
>      >>>>? ? ? ?>? ? ?Alternatively, one could focus in turn on each
>     explanatory
>      >>>>? ? ? variable and
>      >>>>? ? ? ?>? ? ?check the collinearity of all coefficients to
>     which it is
>      >>>>? ? ? marginal. So
>      >>>>? ? ? ?>? ? ?in y ~ a + b + c + a:b + a:c + d, when you focus
>     on a, you'd
>      >>>>? ? ? look at
>      >>>>? ? ? ?>? ? ?all
>      >>>>? ? ? ?>? ? ?of the coefficients for a, b, c, a:b, and a:c.
>      >>>>? ? ? ?>
>      >>>>? ? ? ?>? ? ?John
>      >>>>? ? ? ?>
>      >>>>? ? ? ?>? ? ? >
>      >>>>? ? ? ?>? ? ? > Best,
>      >>>>? ? ? ?>? ? ? >
>      >>>>? ? ? ?>? ? ? > Juho
>      >>>>? ? ? ?>? ? ? >
>      >>>>? ? ? ?>? ? ? >
>      >>>>? ? ? ?>? ? ? >
>      >>>>? ? ? ?>? ? ? >
>      >>>>? ? ? ?>? ? ? >
>      >>>>? ? ? ?>? ? ? >
>      >>>>? ? ? ?>? ? ? >
>      >>>>? ? ? ?>? ? ? >
>      >>>>? ? ? ?>? ? ? >
>      >>>>? ? ? ?>? ? ? >
>      >>>>? ? ? ?>? ? ? >
>      >>>>? ? ? ?>? ? ? > ti 1. maalisk. 2022 klo 0.05 John Fox
>     (jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
>      >>>>? ? ? <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>
>      >>>>? ? ? ?>? ? ?<mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
>     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>>
>      >>>>? ? ? ?>? ? ? > <mailto:jfox at mcmaster.ca
>     <mailto:jfox at mcmaster.ca> <mailto:jfox at mcmaster.ca
>     <mailto:jfox at mcmaster.ca>>
>      >>>>? ? ? <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
>     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>>>) kirjoitti:
>      >>>>? ? ? ?>? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ?Dear Juha,
>      >>>>? ? ? ?>? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ?On 2022-02-28 5:00 p.m., Juho Kristian
>     Ruohonen wrote:
>      >>>>? ? ? ?>? ? ? >? ? ? > Apologies for my misreading, John, and
>     many thanks
>      >>>>? ? ? for showing
>      >>>>? ? ? ?>? ? ? >? ? ?how the
>      >>>>? ? ? ?>? ? ? >? ? ? > calculation is done for a single term.
>      >>>>? ? ? ?>? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ? > Do you think *vif()* might be updated in
>     the near
>      >>>>? ? ? future
>      >>>>? ? ? ?>? ? ?with the
>      >>>>? ? ? ?>? ? ? >? ? ? > capability of auto-detecting a
>     multinomial model
>      >>>>? ? ? and returning
>      >>>>? ? ? ?>? ? ? >? ? ? > mathematically correct GVIF statistics?
>      >>>>? ? ? ?>? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ?The thought crossed my mind, but I'd want
>     to do it in a
>      >>>>? ? ? ?>? ? ?general way,
>      >>>>? ? ? ?>? ? ? >? ? ?not
>      >>>>? ? ? ?>? ? ? >? ? ?just for the multinom() function, and in a
>     way that
>      >>> avoids
>      >>>>? ? ? ?>? ? ?incorrect
>      >>>>? ? ? ?>? ? ? >? ? ?results such as those currently produced
>     for "multinom"
>      >>>>? ? ? ?>? ? ?models, albeit
>      >>>>? ? ? ?>? ? ? >? ? ?with a warning. I can't guarantee whether
>     or when I'll
>      >>> be
>      >>>>? ? ? ?>? ? ?able to do
>      >>>>? ? ? ?>? ? ? >? ? ?that.
>      >>>>? ? ? ?>? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ?John
>      >>>>? ? ? ?>? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ? > If not, I'll proceed to writing my own
>     function
>      >>>>? ? ? based on your
>      >>>>? ? ? ?>? ? ? >? ? ?example.
>      >>>>? ? ? ?>? ? ? >? ? ? > However, /car/ is such an excellent and
>     widely used
>      >>>>? ? ? ?>? ? ?package that the
>      >>>>? ? ? ?>? ? ? >? ? ? > greatest benefit to mankind would
>     probably accrue
>      >>>>? ? ? if /car /was
>      >>>>? ? ? ?>? ? ? >? ? ?upgraded
>      >>>>? ? ? ?>? ? ? >? ? ? > with this feature sooner rather than later.
>      >>>>? ? ? ?>? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ? > Best,
>      >>>>? ? ? ?>? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ? > Juho
>      >>>>? ? ? ?>? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ? > ma 28. helmik. 2022 klo 17.08 John Fox
>      >>>>? ? ? (jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
>     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>
>      >>>>? ? ? ?>? ? ?<mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
>     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>>
>      >>>>? ? ? ?>? ? ? >? ? ?<mailto:jfox at mcmaster.ca
>     <mailto:jfox at mcmaster.ca> <mailto:jfox at mcmaster.ca
>     <mailto:jfox at mcmaster.ca>>
>      >>>>? ? ? <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
>     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>>>
>      >>>>? ? ? ?>? ? ? >? ? ? > <mailto:jfox at mcmaster.ca
>     <mailto:jfox at mcmaster.ca> <mailto:jfox at mcmaster.ca
>     <mailto:jfox at mcmaster.ca>>
>      >>>>? ? ? <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
>     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>>
>      >>>>? ? ? ?>? ? ?<mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
>     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>
>      >>>>? ? ? <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
>     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>>>>) kirjoitti:
>      >>>>? ? ? ?>? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ?Dear Juho,
>      >>>>? ? ? ?>? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ?On 2022-02-28 2:06 a.m., Juho
>     Kristian Ruohonen
>      >>>>? ? ? wrote:
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? > Dear Professor Fox and other list
>     members,
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? > Profuse thanks for doing that
>     detective work
>      >>> for
>      >>>>? ? ? ?>? ? ?me! I myself
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ?thought
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? > the inflation factors reported by
>      >>>>? ? ? ?>? ? ?check_collinearity() were
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ?suspiciously
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? > high, but unlike you I lacked the
>     expertise
>      >>>>? ? ? to identify
>      >>>>? ? ? ?>? ? ? >? ? ?what was
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ?going on.
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? > As for your suggested approach,
>     have I
>      >>>>? ? ? understood this
>      >>>>? ? ? ?>? ? ? >? ? ?correctly:
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? > Since there doesn't yet exist an
>     R function
>      >>>>? ? ? that will
>      >>>>? ? ? ?>? ? ? >? ? ?calculate the
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? > (G)VIFS of multinomial models
>     correctly, my
>      >>> best
>      >>>>? ? ? ?>? ? ?bet for
>      >>>>? ? ? ?>? ? ? >? ? ?now is
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ?just to
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? > ignore the fact that such models
>     partition
>      >>>>? ? ? the data
>      >>>>? ? ? ?>? ? ?into C-1
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ?subsets,
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? > and to calculate approximate
>     GVIFs from the
>      >>>>? ? ? entire
>      >>>>? ? ? ?>? ? ?dataset at
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ?once as if
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? > the response were continuous? And
>     a simple
>      >>>>? ? ? way to
>      >>>>? ? ? ?>? ? ?do this
>      >>>>? ? ? ?>? ? ? >? ? ?is to
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? > construct a fake continuous
>     response, call
>      >>>>? ? ? ?>? ? ? >? ? ?*lm(fakeresponse ~.)*,
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ?and
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? > apply *car::vif()* on the result?
>      >>>>? ? ? ?>? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ?No, you misunderstand my suggestion,
>     which
>      >>>>? ? ? perhaps isn't
>      >>>>? ? ? ?>? ? ? >? ? ?surprising
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ?given the length of my message. What you
>      >>>>? ? ? propose is what I
>      >>>>? ? ? ?>? ? ? >? ? ?suggested as
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ?a rough approximation *before* I
>     confirmed that
>      >>> my
>      >>>>? ? ? ?>? ? ?guess of the
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ?solution
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ?was correct.
>      >>>>? ? ? ?>? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ?The R code that I sent yesterday
>     showed how to
>      >>>>? ? ? compute the
>      >>>>? ? ? ?>? ? ? >? ? ?GVIF for a
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ?multinomial regression model, and I
>     suggested
>      >>>>? ? ? that you
>      >>>>? ? ? ?>? ? ?write
>      >>>>? ? ? ?>? ? ? >? ? ?either a
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ?script or a simple function to do
>     that. Here's
>      >>>>? ? ? a function
>      >>>>? ? ? ?>? ? ? >? ? ?that will
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ?work
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ?for a model object that responds to
>     vcov():
>      >>>>? ? ? ?>? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ?GVIF <- function(model, intercepts,
>     term){
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? ? ?# model: regression model object
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? ? ?# intercepts: row/column
>     positions of
>      >>>>? ? ? intercepts
>      >>>>? ? ? ?>? ? ?in the
>      >>>>? ? ? ?>? ? ? >? ? ?coefficient
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ?covariance matrix
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? ? ?# term: row/column positions of the
>      >>>>? ? ? coefficients
>      >>>>? ? ? ?>? ? ?for the
>      >>>>? ? ? ?>? ? ? >? ? ?focal term
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? ? ?V <- vcov(model)
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? ? ?term <- colnames(V)[term]
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? ? ?V <- V[-intercepts, -intercepts]
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? ? ?V <- cov2cor(V)
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? ? ?term <- which(colnames(V) %in% term)
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? ? ?gvif <- det(V[term,
>     term])*det(V[-term,
>      >>>>? ? ? -term])/det(V)
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? ? ?c(GVIF=gvif,
>      >>>>? ? ? ?>? ? ?"GVIF^(1/(2*p))"=gvif^(1/(2*length(term))))
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ?}
>      >>>>? ? ? ?>? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ?and here's an application to the
>     multinom()
>      >>>>? ? ? example that I
>      >>>>? ? ? ?>? ? ? >? ? ?showed you
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ?yesterday:
>      >>>>? ? ? ?>? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? ?> colnames(vcov(m)) # to get
>     coefficient
>      >>>>? ? ? positions
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? ? [1] "Labour:(Intercept)"
>      >>>>? ? ? ?>? ? ? ?"Labour:age"
>      >>>>? ? ? ?>? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? ? [3] "Labour:economic.cond.national"
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ?"Labour:economic.cond.household"
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? ? [5] "Labour:Blair"
>      >>>>? ? ? ?>? ? ? ?"Labour:Hague"
>      >>>>? ? ? ?>? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? ? [7] "Labour:Kennedy"
>      >>>>? ? ? ?>? ? ? ?"Labour:Europe"
>      >>>>? ? ? ?>? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? ? [9] "Labour:political.knowledge"
>      >>>>? ? ? ?>? ? ? >? ? ? ?"Labour:gendermale"
>      >>>>? ? ? ?>? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ?[11] "Liberal Democrat:(Intercept)"
>      >>>>? ? ? ? "Liberal
>      >>>>? ? ? ?>? ? ? >? ? ?Democrat:age"
>      >>>>? ? ? ?>? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ?[13] "Liberal
>     Democrat:economic.cond.national"
>      >>>>? ? ? "Liberal
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ?Democrat:economic.cond.household"
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ?[15] "Liberal Democrat:Blair"
>      >>>>? ? ? ? "Liberal
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ?Democrat:Hague"
>      >>>>? ? ? ?>? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ?[17] "Liberal Democrat:Kennedy"
>      >>>>? ? ? ? "Liberal
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ?Democrat:Europe"
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ?[19] "Liberal
>     Democrat:political.knowledge"
>      >>>>? ? ? ? "Liberal
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ?Democrat:gendermale"
>      >>>>? ? ? ?>? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? ?> GVIF(m, intercepts=c(1, 11),
>     term=c(2, 12))
>      >>>>? ? ? # GVIF
>      >>>>? ? ? ?>? ? ?for age
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? ? ? ? ? ? ?GVIF GVIF^(1/(2*p))
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? ? ? ? ?1.046232? ? ? ?1.011363
>      >>>>? ? ? ?>? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ?Finally, here's what you get for a
>     linear model
>      >>>>? ? ? with
>      >>>>? ? ? ?>? ? ?the same RHS
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ?(where
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ?the sqrt(VIF) should be a rough
>     approximation to
>      >>>>? ? ? ?>? ? ?GVIF^(1/4)
>      >>>>? ? ? ?>? ? ? >? ? ?reported by
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ?my GVIF() function):
>      >>>>? ? ? ?>? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? ?> m.lm <- lm(as.numeric(vote) ~ .
>     - vote1,
>      >>>>? ? ? data=BEPS)
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? ?> sqrt(car::vif(m.lm))
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? ? ? ? ? ? ? ? ? ? ? ?age
>      >>> economic.cond.national
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ?economic.cond.household
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? ? ? ? ? ? ? ? ? ? ?Blair
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? ? ? ? ? ? ? ? ? 1.006508
>      >>> 1.124132
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ?1.075656
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? ? ? ? ? ? ? ? ? 1.118441
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? ? ? ? ? ? ? ? ? ? ?Hague
>      >>>? ?Kennedy
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ?Europe
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? ? ? ?political.knowledge
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? ? ? ? ? ? ? ? ? 1.066799
>      >>> 1.015532
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ?1.101741
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? ? ? ? ? ? ? ? ? 1.028546
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? ? ? ? ? ? ? ? ? ? gender
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? ? ? ? ? ? ? ? ? 1.017386
>      >>>>? ? ? ?>? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ?John
>      >>>>? ? ? ?>? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? > Best,
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? > Juho
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? > ma 28. helmik. 2022 klo 2.23 John Fox
>      >>>>? ? ? ?>? ? ?(jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
>     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>
>      >>>>? ? ? <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
>     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>>
>      >>>>? ? ? ?>? ? ? >? ? ?<mailto:jfox at mcmaster.ca
>     <mailto:jfox at mcmaster.ca> <mailto:jfox at mcmaster.ca
>     <mailto:jfox at mcmaster.ca>>
>      >>>>? ? ? <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
>     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>>>
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ?<mailto:jfox at mcmaster.ca
>     <mailto:jfox at mcmaster.ca>
>      >>>>? ? ? <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>
>     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
>      >>>>? ? ? <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>>
>      >>>>? ? ? ?>? ? ?<mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
>     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>
>      >>>>? ? ? <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
>     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>>>>
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? > <mailto:jfox at mcmaster.ca
>     <mailto:jfox at mcmaster.ca>
>      >>>>? ? ? <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>
>     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
>      >>>>? ? ? <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>>
>      >>>>? ? ? ?>? ? ?<mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
>     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>
>      >>>>? ? ? <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
>     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>>>
>      >>>>? ? ? ?>? ? ? >? ? ?<mailto:jfox at mcmaster.ca
>     <mailto:jfox at mcmaster.ca> <mailto:jfox at mcmaster.ca
>     <mailto:jfox at mcmaster.ca>>
>      >>>>? ? ? <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
>     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>>
>      >>>>? ? ? ?>? ? ?<mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
>     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>
>      >>>>? ? ? <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
>     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>>>>>) kirjoitti:
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?Dear Juho,
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?I've now had a chance to
>     think about this
>      >>>>? ? ? ?>? ? ?problem some
>      >>>>? ? ? ?>? ? ? >? ? ?more,
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ?and I
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?believe that the approach I
>     suggested is
>      >>>>? ? ? correct. I
>      >>>>? ? ? ?>? ? ? >? ? ?also had an
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?opportunity to talk the
>     problem over a
>      >>>>? ? ? bit with
>      >>>>? ? ? ?>? ? ?Georges
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ?Monette, who
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?coauthored the paper that
>     introduced
>      >>>>? ? ? ?>? ? ?generalized variance
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ?inflation
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?factors (GVIFs). On the other
>     hand, the
>      >>>>? ? ? results
>      >>>>? ? ? ?>? ? ? >? ? ?produced by
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >   
>      ?performance::check_collinearity() for
>      >>>>? ? ? ?>? ? ?multinomial logit
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ?models don't
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?seem to be correct (see below).
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?Here's an example, using the
>      >>>>? ? ? nnet::multinom()
>      >>>>? ? ? ?>? ? ?function
>      >>>>? ? ? ?>? ? ? >? ? ?to fit a
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?multinomial logit model, with
>     alternative
>      >>>>? ? ? ?>? ? ? >? ? ?parametrizations of the
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?LHS of
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?the model:
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?--------- snip -----------
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ?> library(nnet) # for
>     multinom()
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ?> library(carData) # for
>     BEPS data set
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ?> # alternative ordering of the
>      >>>>? ? ? response levels:
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ?> BEPS$vote1 <-
>     factor(BEPS$vote,
>      >>>>? ? ? ?>? ? ?levels=c("Labour",
>      >>>>? ? ? ?>? ? ? >? ? ?"Liberal
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?Democrat", "Conservative"))
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ?> levels(BEPS$vote)
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?[1] "Conservative"? ? ?"Labour"
>      >>>>? ? ? ? "Liberal
>      >>>>? ? ? ?>? ? ? >? ? ?Democrat"
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ?> levels(BEPS$vote1)
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?[1] "Labour"         
>      ?"Liberal Democrat"
>      >>>>? ? ? ?>? ? ?"Conservative"
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ?> m <- multinom(vote ~ . -
>     vote1,
>      >>>>? ? ? data=BEPS)
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?# weights:? 33 (20 variable)
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?initial? value 1675.383740
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?iter? 10 value 1345.935273
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?iter? 20 value 1150.956807
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?iter? 30 value 1141.921662
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?iter? 30 value 1141.921661
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?iter? 30 value 1141.921661
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?final? value 1141.921661
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?converged
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ?> m1 <- multinom(vote1 ~ .
>     - vote,
>      >>>>? ? ? data=BEPS)
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?# weights:? 33 (20 variable)
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?initial? value 1675.383740
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?iter? 10 value 1280.439304
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?iter? 20 value 1165.513772
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?final? value 1141.921662
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?converged
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ?> rbind(coef(m), coef(m1))
>     # compare
>      >>>>? ? ? coefficients
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ? ? ? ? ? ? ? ? ? (Intercept)
>      >>> age
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ?economic.cond.national
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?economic.cond.household
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?Labour? ? ? ? ? ? ?0.9515214
>     -0.021913989
>      >>>>? ? ? ?>? ? ? >? ? ?0.5575707
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ? ? ? 0.15839096
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?Liberal Democrat? ?1.4119306
>     -0.016810735
>      >>>>? ? ? ?>? ? ? >? ? ?0.1810761
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ? ? ?-0.01196664
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?Liberal Democrat? ?0.4604567 
>     0.005102666
>      >>>>? ? ? ?>? ? ? >? ? ? ?-0.3764928
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ? ? ?-0.17036682
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?Conservative? ? ? -0.9514466 
>     0.021912305
>      >>>>? ? ? ?>? ? ? >? ? ? ?-0.5575644
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ? ? ?-0.15838744
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >                           
>      ?Blair? ? ? ?Hague
>      >>>>? ? ? ?>? ? ?Kennedy
>      >>>>? ? ? ?>? ? ? >? ? ? ? ? Europe
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?political.knowledge
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?Labour? ? ? ? ? ? 0.8371764
>     -0.90775585
>      >>>>? ? ? 0.2513436
>      >>>>? ? ? ?>? ? ? >? ? ?-0.22781308
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?-0.5370612
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?Liberal Democrat? 0.2937331
>     -0.82217625
>      >>>>? ? ? 0.6710567
>      >>>>? ? ? ?>? ? ? >? ? ?-0.20004624
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?-0.2034605
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?Liberal Democrat -0.5434408 
>     0.08559455
>      >>>>? ? ? 0.4197027
>      >>>>? ? ? ?>? ? ? >? ? ?0.02776465
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?0.3336068
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?Conservative? ? ?-0.8371670 
>     0.90778068
>      >>>>? ? ? -0.2513735
>      >>>>? ? ? ?>? ? ? >? ? ?0.22781092
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?0.5370545
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ? ? ? ? ? ? ? ? ? ?gendermale
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?Labour? ? ? ? ? ? 0.13765774
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?Liberal Democrat? 0.12640823
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?Liberal Democrat -0.01125898
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?Conservative? ? ?-0.13764849
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ?> c(logLik(m), logLik(m1))
>     # same fit
>      >>>>? ? ? to the data
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?[1] -1141.922 -1141.922
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ?> # covariance matrices for
>      >>> coefficients:
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ?> V <- vcov(m)
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ?> V1 <- vcov(m1)
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ?> cbind(colnames(V),
>     colnames(V1)) #
>      >>>>? ? ? compare
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ? ? ? ?[,1]
>      >>>>? ? ? ?>? ? ? ? ?[,2]
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ? [1,] "Labour:(Intercept)"
>      >>>>? ? ? ?>? ? ? >? ? ? ?"Liberal
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?Democrat:(Intercept)"
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ? [2,] "Labour:age"
>      >>>>? ? ? ?>? ? ? >? ? ? ?"Liberal
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?Democrat:age"
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ? [3,]
>     "Labour:economic.cond.national"
>      >>>>? ? ? ?>? ? ? >? ? ?"Liberal
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?Democrat:economic.cond.national"
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ? [4,]
>     "Labour:economic.cond.household"
>      >>>>? ? ? ?>? ? ? >? ? ? ?"Liberal
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?Democrat:economic.cond.household"
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ? [5,] "Labour:Blair"
>      >>>>? ? ? ?>? ? ? >? ? ? ?"Liberal
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?Democrat:Blair"
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ? [6,] "Labour:Hague"
>      >>>>? ? ? ?>? ? ? >? ? ? ?"Liberal
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?Democrat:Hague"
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ? [7,] "Labour:Kennedy"
>      >>>>? ? ? ?>? ? ? >? ? ? ?"Liberal
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?Democrat:Kennedy"
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ? [8,] "Labour:Europe"
>      >>>>? ? ? ?>? ? ? >? ? ?"Liberal
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?Democrat:Europe"
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ? [9,]
>     "Labour:political.knowledge"
>      >>>>? ? ? ?>? ? ? >? ? ? ?"Liberal
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?Democrat:political.knowledge"
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?[10,] "Labour:gendermale"
>      >>>>? ? ? ?>? ? ? ? "Liberal
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?Democrat:gendermale"
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?[11,] "Liberal
>     Democrat:(Intercept)"
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?"Conservative:(Intercept)"
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?[12,] "Liberal Democrat:age"
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? ?"Conservative:age"
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?[13,] "Liberal
>      >>>>? ? ? Democrat:economic.cond.national"
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >   
>      ?"Conservative:economic.cond.national"
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?[14,] "Liberal
>      >>>>? ? ? Democrat:economic.cond.household"
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >   
>      ?"Conservative:economic.cond.household"
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?[15,] "Liberal Democrat:Blair"
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? ?"Conservative:Blair"
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?[16,] "Liberal Democrat:Hague"
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? ?"Conservative:Hague"
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?[17,] "Liberal Democrat:Kennedy"
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? ?"Conservative:Kennedy"
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?[18,] "Liberal Democrat:Europe"
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ?"Conservative:Europe"
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?[19,] "Liberal
>      >>> Democrat:political.knowledge"
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >   
>      ?"Conservative:political.knowledge"
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?[20,] "Liberal
>     Democrat:gendermale"
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?"Conservative:gendermale"
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ?> int <- c(1, 11) # remove
>     intercepts
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ?> colnames(V)[int]
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?[1] "Labour:(Intercept)"
>      >>>? ?"Liberal
>      >>>>? ? ? ?>? ? ? >? ? ?Democrat:(Intercept)"
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ?> colnames(V1)[int]
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?[1] "Liberal
>     Democrat:(Intercept)"
>      >>>>? ? ? ?>? ? ? >? ? ?"Conservative:(Intercept)"
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ?> V <- V[-int, -int]
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ?> V1 <- V1[-int, -int]
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ?> age <- c(1, 10) # locate age
>      >>>>? ? ? coefficients
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ?> colnames(V)[age]
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?[1] "Labour:age"         
>      ?"Liberal
>      >>>>? ? ? Democrat:age"
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ?> colnames(V1)[age]
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?[1] "Liberal Democrat:age"
>      >>>>? ? ? "Conservative:age"
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ?> V <- cov2cor(V) # compute
>     coefficient
>      >>>>? ? ? ?>? ? ?correlations
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ?> V1 <- cov2cor(V1)
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ?> # compare GVIFs:
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ?> c(det(V[age,
>     age])*det(V[-age,
>      >>>>? ? ? -age])/det(V),
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?+? ?det(V1[age,
>     age])*det(V1[-age,
>      >>>>? ? ? -age])/det(V1))
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?[1] 1.046232 1.046229
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?--------- snip -----------
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?For curiosity, I applied
>     car::vif() and
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >   
>      ?performance::check_collinearity() to
>      >>> these
>      >>>>? ? ? ?>? ? ?models to
>      >>>>? ? ? ?>? ? ? >? ? ?see what
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ?they
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?would
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?do. Both returned the wrong
>     answer. vif()
>      >>>>? ? ? ?>? ? ?produced a
>      >>>>? ? ? ?>? ? ? >? ? ?warning, but
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?check_collinearity() didn't:
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?--------- snip -----------
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ?> car::vif(m1)
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ? ? ? ? ? ? ? ? ? ? ?age
>      >>>>? ? ? economic.cond.national
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?economic.cond.household
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ? ? ? ? ? ? ? ?15.461045
>      >>>>? ? ? ? 22.137772
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ?16.693877
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ? ? ? ? ? ? ? ? ? ?Blair
>      >>>>? ? ? ? ? Hague
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ?Kennedy
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ? ? ? ? ? ? ? ?14.681562
>      >>>>? ? ? 7.483039
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ?15.812067
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ? ? ? ? ? ? ? ? ? Europe
>      >>>>? ? ? ? political.knowledge
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?gender
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ? ? ? ? ? ? ? ? 6.502119
>      >>>>? ? ? 4.219507
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?2.313885
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?Warning message:
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?In vif.default(m1) : No
>     intercept: vifs
>      >>>>? ? ? may not be
>      >>>>? ? ? ?>? ? ? >? ? ?sensible.
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ?>
>     performance::check_collinearity(m)
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?# Check for Multicollinearity
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?Low Correlation
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ? ? ? ? ? ? ? ? ? ? ?Term? VIF
>      >>> Increased SE
>      >>>>? ? ? ?>? ? ?Tolerance
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ? ? ? ? ? ? ? ? ? ? ? age 1.72
>      >>>>? ? ? ? 1.31
>      >>>>? ? ? ?>? ? ? ? 0.58
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ? ?economic.cond.national 1.85
>      >>>>? ? ? ? 1.36
>      >>>>? ? ? ?>? ? ? ? 0.54
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ? economic.cond.household 1.86
>      >>>>? ? ? ? 1.37
>      >>>>? ? ? ?>? ? ? ? 0.54
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ? ? ? ? ? ? ? ? ? ? Blair 1.63
>      >>>>? ? ? ? 1.28
>      >>>>? ? ? ?>? ? ? ? 0.61
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ? ? ? ? ? ? ? ? ? ? Hague 1.94
>      >>>>? ? ? ? 1.39
>      >>>>? ? ? ?>? ? ? ? 0.52
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ? ? ? ? ? ? ? ? ? Kennedy 1.70
>      >>>>? ? ? ? 1.30
>      >>>>? ? ? ?>? ? ? ? 0.59
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ? ? ? ? ? ? ? ? ? ?Europe 2.01
>      >>>>? ? ? ? 1.42
>      >>>>? ? ? ?>? ? ? ? 0.50
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ? ? ? political.knowledge 1.94
>      >>>>? ? ? ? 1.39
>      >>>>? ? ? ?>? ? ? ? 0.52
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ? ? ? ? ? ? ? ? ? ?gender 1.78
>      >>>>? ? ? ? 1.33
>      >>>>? ? ? ?>? ? ? ? 0.56
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ?>
>     performance::check_collinearity(m1)
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?# Check for Multicollinearity
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?Low Correlation
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ? ? ? ? ? ? ? ? ? ? ?Term? VIF
>      >>> Increased SE
>      >>>>? ? ? ?>? ? ?Tolerance
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ? ? ? ? ? ? ? ? ? ? ? age 1.19
>      >>>>? ? ? ? 1.09
>      >>>>? ? ? ?>? ? ? ? 0.84
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ? ?economic.cond.national 1.42
>      >>>>? ? ? ? 1.19
>      >>>>? ? ? ?>? ? ? ? 0.70
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ? economic.cond.household 1.32
>      >>>>? ? ? ? 1.15
>      >>>>? ? ? ?>? ? ? ? 0.76
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ? ? ? ? ? ? ? ? ? ? Blair 1.50
>      >>>>? ? ? ? 1.22
>      >>>>? ? ? ?>? ? ? ? 0.67
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ? ? ? ? ? ? ? ? ? ? Hague 1.30
>      >>>>? ? ? ? 1.14
>      >>>>? ? ? ?>? ? ? ? 0.77
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ? ? ? ? ? ? ? ? ? Kennedy 1.19
>      >>>>? ? ? ? 1.09
>      >>>>? ? ? ?>? ? ? ? 0.84
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ? ? ? ? ? ? ? ? ? ?Europe 1.34
>      >>>>? ? ? ? 1.16
>      >>>>? ? ? ?>? ? ? ? 0.75
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ? ? ? political.knowledge 1.30
>      >>>>? ? ? ? 1.14
>      >>>>? ? ? ?>? ? ? ? 0.77
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ? ? ? ? ? ? ? ? ? ?gender 1.23
>      >>>>? ? ? ? 1.11
>      >>>>? ? ? ?>? ? ? ? 0.81
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?--------- snip -----------
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?I looked at the code for
>     vif() and
>      >>>>? ? ? ?>? ? ?check_collinearity() to
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ?see where
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?they went wrong. Both failed
>     to handle
>      >>>>? ? ? the two
>      >>>>? ? ? ?>? ? ? >? ? ?intercepts in
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ?the model
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?correctly -- vif() thought
>     there was no
>      >>>>? ? ? ?>? ? ?intercept and
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?check_collinearity() just
>     removed the
>      >>> first
>      >>>>? ? ? ?>? ? ?intercept
>      >>>>? ? ? ?>? ? ? >? ? ?but not the
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?second.
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?In examining the code for
>      >>>>? ? ? check_collinearity(), I
>      >>>>? ? ? ?>? ? ? >? ? ?discovered a
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?couple of
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?additional disconcerting
>     facts. First,
>      >>>>? ? ? part of the
>      >>>>? ? ? ?>? ? ? >? ? ?code seems
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ?to be
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?copied from vif.default().
>     Second, as a
>      >>>>? ? ? ?>? ? ?consequence,
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?check_collinearity() actually
>     computes
>      >>>>? ? ? GVIFs rather
>      >>>>? ? ? ?>? ? ? >? ? ?than VIFs
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ?(and
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?doesn't reference either the
>     Fox and
>      >>>>? ? ? Monette paper
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ?introducing GVIFs or
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?the car package) but doesn't
>     seem to
>      >>>>? ? ? understand
>      >>>>? ? ? ?>? ? ?that, and,
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ?for example,
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?takes the squareroot of the GVIF
>      >>>>? ? ? (reported in the
>      >>>>? ? ? ?>? ? ? >? ? ?column marked
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?"Increased SE") rather than
>     the 2p root
>      >>>>? ? ? (when there
>      >>>>? ? ? ?>? ? ? >? ? ?are p > 1
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?coefficients in a term).
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?Here's the relevant code from
>     the two
>      >>>>? ? ? functions
>      >>>>? ? ? ?>? ? ?(where
>      >>>>? ? ? ?>? ? ? >? ? ?. . .
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ?denotes
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?elided lines) -- the default
>     method for
>      >>>>? ? ? vif() and
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?.check_collinearity(),
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?which is called by
>      >>>>? ? ? check_collinearity.default():
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?--------- snip -----------
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ?> car:::vif.default
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?function (mod, ...)
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?{
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ? ? ?. . .
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ? ? ?v <- vcov(mod)
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ? ? ?assign <-
>     attr(model.matrix(mod),
>      >>>>? ? ? "assign")
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ? ? ?if
>     (names(coefficients(mod)[1]) ==
>      >>>>? ? ? ?>? ? ?"(Intercept)") {
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ? ? ? ? ?v <- v[-1, -1]
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ? ? ? ? ?assign <- assign[-1]
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ? ? ?}
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ? ? ?else warning("No
>     intercept: vifs
>      >>>>? ? ? may not be
>      >>>>? ? ? ?>? ? ? >? ? ?sensible.")
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ? ? ?terms <- labels(terms(mod))
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ? ? ?n.terms <- length(terms)
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ? ? ?if (n.terms < 2)
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ? ? ? ? ?stop("model
>     contains fewer
>      >>>>? ? ? than 2 terms")
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ? ? ?R <- cov2cor(v)
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ? ? ?detR <- det(R)
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ? ? ?. . .
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ? ? ?for (term in 1:n.terms) {
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ? ? ? ? ?subs <-
>     which(assign == term)
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ? ? ? ? ?result[term, 1] <-
>      >>>>? ? ? det(as.matrix(R[subs,
>      >>>>? ? ? ?>? ? ? >? ? ?subs])) *
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?det(as.matrix(R[-subs,
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ? ? ? ? ? ? ?-subs]))/detR
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ? ? ? ? ?result[term, 2] <-
>     length(subs)
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ? ? ?}
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ? ? ?. . .
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?}
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ?>
>     performance:::.check_collinearity
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?function (x, component,
>     verbose = TRUE)
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?{
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ? ? ?v <- insight::get_varcov(x,
>      >>>>? ? ? component =
>      >>>>? ? ? ?>? ? ?component,
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ?verbose =
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?FALSE)
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ? ? ?assign <-
>     .term_assignments(x,
>      >>>>? ? ? component,
>      >>>>? ? ? ?>? ? ?verbose =
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ?verbose)
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ? ? ?. . .
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ? ? ?if
>     (insight::has_intercept(x)) {
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ? ? ? ? ?v <- v[-1, -1]
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ? ? ? ? ?assign <- assign[-1]
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ? ? ?}
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ? ? ?else {
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ? ? ? ? ?if (isTRUE(verbose)) {
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ? ? ? ? ? ? ?warning("Model
>     has no
>      >>>>? ? ? intercept. VIFs
>      >>>>? ? ? ?>? ? ? >? ? ?may not be
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?sensible.",
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ? ? ? ? ? ? ? ? ?call. = FALSE)
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ? ? ? ? ?}
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ? ? ?}
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ? ? ? ? ?. . .
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ? ? ? ? ?terms <-
>      >>>>? ? ? ?>? ? ?labels(stats::terms(f[[component]]))
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ? ? ? ? ?. . .
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ? ? ?n.terms <- length(terms)
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ? ? ?if (n.terms < 2) {
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ? ? ? ? ?if (isTRUE(verbose)) {
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? ?warning(insight::format_message(sprintf("Not
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ?enough model
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?terms in the %s part of the
>     model to
>      >>>>? ? ? check for
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ?multicollinearity.",
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >                     
>      ?component)), call. =
>      >>>>? ? ? FALSE)
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ? ? ? ? ?}
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ? ? ? ? ?return(NULL)
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ? ? ?}
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ? ? ?R <- stats::cov2cor(v)
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ? ? ?detR <- det(R)
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ? ? ?. . .
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ? ? ?for (term in 1:n.terms) {
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ? ? ? ? ?subs <-
>     which(assign == term)
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ? ? ? ? ? ? ?. . .
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ? ? ? ? ? ? ?result <- c(result,
>      >>>>? ? ? ?>? ? ? >? ? ?det(as.matrix(R[subs, subs])) *
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >                     
>      ?det(as.matrix(R[-subs,
>      >>>>? ? ? ?>? ? ?-subs]))/detR)
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ? ? ? ? ? ? ?. . .
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ? ? ?}
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ? ? ?. . .
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?}
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?--------- snip -----------
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?So, the upshot of all this is
>     that you
>      >>>>? ? ? should
>      >>>>? ? ? ?>? ? ?be able
>      >>>>? ? ? ?>? ? ? >? ? ?to do
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ?what you
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?want, but not with either
>     car::vif() or
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >   
>      ?performance::check_collinearity().
>      >>>>? ? ? Instead, either
>      >>>>? ? ? ?>? ? ? >? ? ?write your own
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?function or do the
>     computations in a
>      >>> script.
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?There's also a lesson here
>     about S3
>      >>> default
>      >>>>? ? ? ?>? ? ?methods:
>      >>>>? ? ? ?>? ? ? >? ? ?The fact
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ?that a
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?default method returns a
>     result rather
>      >>> than
>      >>>>? ? ? ?>? ? ?throwing
>      >>>>? ? ? ?>? ? ? >? ? ?an error
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ?or a
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?warning doesn't mean that the
>     result is
>      >>> the
>      >>>>? ? ? ?>? ? ?right answer.
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?I hope this helps,
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? ? John
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?On 2022-02-26 3:45 p.m., Juho
>     Kristian
>      >>>>? ? ? Ruohonen
>      >>>>? ? ? ?>? ? ?wrote:
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? > Dear John W,
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? > Thank you very much for
>     the tip-off!
>      >>>>? ? ? ?>? ? ?Apologies for not
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ?responding
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?earlier
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? > (gmail apparently decided
>     to direct
>      >>>>? ? ? your email
>      >>>>? ? ? ?>? ? ? >? ? ?right into the
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?junk folder).
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? > I am very pleased to note
>     that the
>      >>>>? ? ? package you
>      >>>>? ? ? ?>? ? ? >? ? ?mention does
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?indeed work
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? > with *brms* multinomial
>     models!
>      >>>>? ? ? Thanks again!
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? > Best,
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? > Juho
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? > pe 25. helmik. 2022 klo
>     19.23 John
>      >>>>? ? ? Willoughby
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?(johnwillec at gmail.com
>     <mailto:johnwillec at gmail.com>
>      >>>>? ? ? <mailto:johnwillec at gmail.com <mailto:johnwillec at gmail.com>>
>      >>>>? ? ? ?>? ? ?<mailto:johnwillec at gmail.com
>     <mailto:johnwillec at gmail.com> <mailto:johnwillec at gmail.com
>     <mailto:johnwillec at gmail.com>>>
>      >>>>? ? ? <mailto:johnwillec at gmail.com
>     <mailto:johnwillec at gmail.com> <mailto:johnwillec at gmail.com
>     <mailto:johnwillec at gmail.com>>
>      >>>>? ? ? ?>? ? ?<mailto:johnwillec at gmail.com
>     <mailto:johnwillec at gmail.com> <mailto:johnwillec at gmail.com
>     <mailto:johnwillec at gmail.com>>>>
>      >>>>? ? ? ?>? ? ? >? ? ?<mailto:johnwillec at gmail.com
>     <mailto:johnwillec at gmail.com>
>      >>>>? ? ? <mailto:johnwillec at gmail.com
>     <mailto:johnwillec at gmail.com>> <mailto:johnwillec at gmail.com
>     <mailto:johnwillec at gmail.com>
>      >>>>? ? ? <mailto:johnwillec at gmail.com <mailto:johnwillec at gmail.com>>>
>      >>>>? ? ? ?>? ? ?<mailto:johnwillec at gmail.com
>     <mailto:johnwillec at gmail.com> <mailto:johnwillec at gmail.com
>     <mailto:johnwillec at gmail.com>>
>      >>>>? ? ? <mailto:johnwillec at gmail.com
>     <mailto:johnwillec at gmail.com> <mailto:johnwillec at gmail.com
>     <mailto:johnwillec at gmail.com>>>>>
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ?<mailto:johnwillec at gmail.com
>     <mailto:johnwillec at gmail.com>
>      >>>>? ? ? <mailto:johnwillec at gmail.com <mailto:johnwillec at gmail.com>>
>      >>>>? ? ? ?>? ? ?<mailto:johnwillec at gmail.com
>     <mailto:johnwillec at gmail.com> <mailto:johnwillec at gmail.com
>     <mailto:johnwillec at gmail.com>>>
>      >>>>? ? ? <mailto:johnwillec at gmail.com
>     <mailto:johnwillec at gmail.com> <mailto:johnwillec at gmail.com
>     <mailto:johnwillec at gmail.com>>
>      >>>>? ? ? ?>? ? ?<mailto:johnwillec at gmail.com
>     <mailto:johnwillec at gmail.com> <mailto:johnwillec at gmail.com
>     <mailto:johnwillec at gmail.com>>>>
>      >>>>? ? ? ?>? ? ? >? ? ?<mailto:johnwillec at gmail.com
>     <mailto:johnwillec at gmail.com>
>      >>>>? ? ? <mailto:johnwillec at gmail.com
>     <mailto:johnwillec at gmail.com>> <mailto:johnwillec at gmail.com
>     <mailto:johnwillec at gmail.com>
>      >>>>? ? ? <mailto:johnwillec at gmail.com <mailto:johnwillec at gmail.com>>>
>      >>>>? ? ? ?>? ? ?<mailto:johnwillec at gmail.com
>     <mailto:johnwillec at gmail.com> <mailto:johnwillec at gmail.com
>     <mailto:johnwillec at gmail.com>>
>      >>>>? ? ? <mailto:johnwillec at gmail.com
>     <mailto:johnwillec at gmail.com> <mailto:johnwillec at gmail.com
>     <mailto:johnwillec at gmail.com>>>>>>)
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? > kirjoitti:
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >> Have you tried the
>      >>> check_collinearity()
>      >>>>? ? ? ?>? ? ?function
>      >>>>? ? ? ?>? ? ? >? ? ?in the
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ?performance
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >> package? It's supposed to
>     work on
>      >>> brms
>      >>>>? ? ? ?>? ? ?models, but
>      >>>>? ? ? ?>? ? ? >? ? ?whether it
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?will work on
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >> a multinomial model I
>     don't know.
>      >>>>? ? ? It works
>      >>>>? ? ? ?>? ? ?well
>      >>>>? ? ? ?>? ? ? >? ? ?on mixed
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ?models
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?generated
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >> by glmmTMB().
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >>
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >> John Willoughby
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >>
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >>
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >> On Fri, Feb 25, 2022 at
>     3:01 AM
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >
>      >>>>? ? ? ? <r-sig-mixed-models-request at r-project.org
>     <mailto:r-sig-mixed-models-request at r-project.org>
>      >>>>? ? ? <mailto:r-sig-mixed-models-request at r-project.org
>     <mailto:r-sig-mixed-models-request at r-project.org>>
>      >>>>? ? ? ?>? ? ?<mailto:r-sig-mixed-models-request at r-project.org
>     <mailto:r-sig-mixed-models-request at r-project.org>
>      >>>>? ? ? <mailto:r-sig-mixed-models-request at r-project.org
>     <mailto:r-sig-mixed-models-request at r-project.org>>>
>      >>>>? ? ? ?>? ? ? >   
>      ?<mailto:r-sig-mixed-models-request at r-project.org
>     <mailto:r-sig-mixed-models-request at r-project.org>
>      >>>>? ? ? <mailto:r-sig-mixed-models-request at r-project.org
>     <mailto:r-sig-mixed-models-request at r-project.org>>
>      >>>>? ? ? ?>? ? ?<mailto:r-sig-mixed-models-request at r-project.org
>     <mailto:r-sig-mixed-models-request at r-project.org>
>      >>>>? ? ? <mailto:r-sig-mixed-models-request at r-project.org
>     <mailto:r-sig-mixed-models-request at r-project.org>>>>
>      >>>>? ? ? ?>? ? ? >? ? ? >
>      >>>>? ? ? ? <mailto:r-sig-mixed-models-request at r-project.org
>     <mailto:r-sig-mixed-models-request at r-project.org>
>      >>>>? ? ? <mailto:r-sig-mixed-models-request at r-project.org
>     <mailto:r-sig-mixed-models-request at r-project.org>>
>      >>>>? ? ? ?>? ? ?<mailto:r-sig-mixed-models-request at r-project.org
>     <mailto:r-sig-mixed-models-request at r-project.org>
>      >>>>? ? ? <mailto:r-sig-mixed-models-request at r-project.org
>     <mailto:r-sig-mixed-models-request at r-project.org>>>
>      >>>>? ? ? ?>? ? ? >   
>      ?<mailto:r-sig-mixed-models-request at r-project.org
>     <mailto:r-sig-mixed-models-request at r-project.org>
>      >>>>? ? ? <mailto:r-sig-mixed-models-request at r-project.org
>     <mailto:r-sig-mixed-models-request at r-project.org>>
>      >>>>? ? ? ?>? ? ?<mailto:r-sig-mixed-models-request at r-project.org
>     <mailto:r-sig-mixed-models-request at r-project.org>
>      >>>>? ? ? <mailto:r-sig-mixed-models-request at r-project.org
>     <mailto:r-sig-mixed-models-request at r-project.org>>>>>
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? ?<mailto:r-sig-mixed-models-request at r-project.org
>     <mailto:r-sig-mixed-models-request at r-project.org>
>      >>>>? ? ? <mailto:r-sig-mixed-models-request at r-project.org
>     <mailto:r-sig-mixed-models-request at r-project.org>>
>      >>>>? ? ? ?>? ? ?<mailto:r-sig-mixed-models-request at r-project.org
>     <mailto:r-sig-mixed-models-request at r-project.org>
>      >>>>? ? ? <mailto:r-sig-mixed-models-request at r-project.org
>     <mailto:r-sig-mixed-models-request at r-project.org>>>
>      >>>>? ? ? ?>? ? ? >   
>      ?<mailto:r-sig-mixed-models-request at r-project.org
>     <mailto:r-sig-mixed-models-request at r-project.org>
>      >>>>? ? ? <mailto:r-sig-mixed-models-request at r-project.org
>     <mailto:r-sig-mixed-models-request at r-project.org>>
>      >>>>? ? ? ?>? ? ?<mailto:r-sig-mixed-models-request at r-project.org
>     <mailto:r-sig-mixed-models-request at r-project.org>
>      >>>>? ? ? <mailto:r-sig-mixed-models-request at r-project.org
>     <mailto:r-sig-mixed-models-request at r-project.org>>>>
>      >>>>? ? ? ?>? ? ? >? ? ? >
>      >>>>? ? ? ? <mailto:r-sig-mixed-models-request at r-project.org
>     <mailto:r-sig-mixed-models-request at r-project.org>
>      >>>>? ? ? <mailto:r-sig-mixed-models-request at r-project.org
>     <mailto:r-sig-mixed-models-request at r-project.org>>
>      >>>>? ? ? ?>? ? ?<mailto:r-sig-mixed-models-request at r-project.org
>     <mailto:r-sig-mixed-models-request at r-project.org>
>      >>>>? ? ? <mailto:r-sig-mixed-models-request at r-project.org
>     <mailto:r-sig-mixed-models-request at r-project.org>>>
>      >>>>? ? ? ?>? ? ? >   
>      ?<mailto:r-sig-mixed-models-request at r-project.org
>     <mailto:r-sig-mixed-models-request at r-project.org>
>      >>>>? ? ? <mailto:r-sig-mixed-models-request at r-project.org
>     <mailto:r-sig-mixed-models-request at r-project.org>>
>      >>>>? ? ? ?>? ? ?<mailto:r-sig-mixed-models-request at r-project.org
>     <mailto:r-sig-mixed-models-request at r-project.org>
>      >>>>? ? ? <mailto:r-sig-mixed-models-request at r-project.org
>     <mailto:r-sig-mixed-models-request at r-project.org>>>>>>>
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >> wrote:
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >>
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >>> Send R-sig-mixed-models
>     mailing list
>      >>>>? ? ? ?>? ? ?submissions to
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >>>
>     r-sig-mixed-models at r-project.org
>     <mailto:r-sig-mixed-models at r-project.org>
>      >>>>? ? ? <mailto:r-sig-mixed-models at r-project.org
>     <mailto:r-sig-mixed-models at r-project.org>>
>      >>>>? ? ? ?>? ? ?<mailto:r-sig-mixed-models at r-project.org
>     <mailto:r-sig-mixed-models at r-project.org>
>      >>>>? ? ? <mailto:r-sig-mixed-models at r-project.org
>     <mailto:r-sig-mixed-models at r-project.org>>>
>      >>>>? ? ? ?>? ? ? >? ? ?<mailto:r-sig-mixed-models at r-project.org
>     <mailto:r-sig-mixed-models at r-project.org>
>      >>>>? ? ? <mailto:r-sig-mixed-models at r-project.org
>     <mailto:r-sig-mixed-models at r-project.org>>
>      >>>>? ? ? ?>? ? ?<mailto:r-sig-mixed-models at r-project.org
>     <mailto:r-sig-mixed-models at r-project.org>
>      >>>>? ? ? <mailto:r-sig-mixed-models at r-project.org
>     <mailto:r-sig-mixed-models at r-project.org>>>>
>      >>>>? ? ? ?>? ? ? >? ? ? >   
>      ?<mailto:r-sig-mixed-models at r-project.org
>     <mailto:r-sig-mixed-models at r-project.org>
>      >>>>? ? ? <mailto:r-sig-mixed-models at r-project.org
>     <mailto:r-sig-mixed-models at r-project.org>>
>      >>>>? ? ? ?>? ? ?<mailto:r-sig-mixed-models at r-project.org
>     <mailto:r-sig-mixed-models at r-project.org>
>      >>>>? ? ? <mailto:r-sig-mixed-models at r-project.org
>     <mailto:r-sig-mixed-models at r-project.org>>>
>      >>>>? ? ? ?>? ? ? >? ? ?<mailto:r-sig-mixed-models at r-project.org
>     <mailto:r-sig-mixed-models at r-project.org>
>      >>>>? ? ? <mailto:r-sig-mixed-models at r-project.org
>     <mailto:r-sig-mixed-models at r-project.org>>
>      >>>>? ? ? ?>? ? ?<mailto:r-sig-mixed-models at r-project.org
>     <mailto:r-sig-mixed-models at r-project.org>
>      >>>>? ? ? <mailto:r-sig-mixed-models at r-project.org
>     <mailto:r-sig-mixed-models at r-project.org>>>>>
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >   
>      ?<mailto:r-sig-mixed-models at r-project.org
>     <mailto:r-sig-mixed-models at r-project.org>
>      >>>>? ? ? <mailto:r-sig-mixed-models at r-project.org
>     <mailto:r-sig-mixed-models at r-project.org>>
>      >>>>? ? ? ?>? ? ?<mailto:r-sig-mixed-models at r-project.org
>     <mailto:r-sig-mixed-models at r-project.org>
>      >>>>? ? ? <mailto:r-sig-mixed-models at r-project.org
>     <mailto:r-sig-mixed-models at r-project.org>>>
>      >>>>? ? ? ?>? ? ? >? ? ?<mailto:r-sig-mixed-models at r-project.org
>     <mailto:r-sig-mixed-models at r-project.org>
>      >>>>? ? ? <mailto:r-sig-mixed-models at r-project.org
>     <mailto:r-sig-mixed-models at r-project.org>>
>      >>>>? ? ? ?>? ? ?<mailto:r-sig-mixed-models at r-project.org
>     <mailto:r-sig-mixed-models at r-project.org>
>      >>>>? ? ? <mailto:r-sig-mixed-models at r-project.org
>     <mailto:r-sig-mixed-models at r-project.org>>>>
>      >>>>? ? ? ?>? ? ? >? ? ? >   
>      ?<mailto:r-sig-mixed-models at r-project.org
>     <mailto:r-sig-mixed-models at r-project.org>
>      >>>>? ? ? <mailto:r-sig-mixed-models at r-project.org
>     <mailto:r-sig-mixed-models at r-project.org>>
>      >>>>? ? ? ?>? ? ?<mailto:r-sig-mixed-models at r-project.org
>     <mailto:r-sig-mixed-models at r-project.org>
>      >>>>? ? ? <mailto:r-sig-mixed-models at r-project.org
>     <mailto:r-sig-mixed-models at r-project.org>>>
>      >>>>? ? ? ?>? ? ? >? ? ?<mailto:r-sig-mixed-models at r-project.org
>     <mailto:r-sig-mixed-models at r-project.org>
>      >>>>? ? ? <mailto:r-sig-mixed-models at r-project.org
>     <mailto:r-sig-mixed-models at r-project.org>>
>      >>>>? ? ? ?>? ? ?<mailto:r-sig-mixed-models at r-project.org
>     <mailto:r-sig-mixed-models at r-project.org>
>      >>>>? ? ? <mailto:r-sig-mixed-models at r-project.org
>     <mailto:r-sig-mixed-models at r-project.org>>>>>>
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >>>
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >>> To subscribe or
>     unsubscribe via the
>      >>>>? ? ? World Wide
>      >>>>? ? ? ?>? ? ? >? ? ?Web, visit
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >>>
>      >>>>? ? ? ?>? ? ? >
>     https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>      >>>>? ? ? <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>
>      >>>>? ? ? ?>   
>      ?<https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>      >>>>? ? ? <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>>
>      >>>>? ? ? ?>? ? ? >
>      >>>>       
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>      >>>>? ? ? <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>
>      >>>>? ? ? ?>   
>      ?<https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>      >>>>? ? ? <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>>>
>      >>>>? ? ? ?>? ? ? >? ? ? >
>      >>>>? ? ? ?>     
>      ?<https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>      >>>>? ? ? <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>
>      >>>>? ? ? ?>   
>      ?<https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>      >>>>? ? ? <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>>
>      >>>>? ? ? ?>? ? ? >
>      >>>>       
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>      >>>>? ? ? <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>
>      >>>>? ? ? ?>   
>      ?<https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>      >>>>? ? ? <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>>>>
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >
>      >>>>       
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>      >>>>? ? ? <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>
>      >>>>? ? ? ?>   
>      ?<https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>      >>>>? ? ? <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>>
>      >>>>? ? ? ?>? ? ? >
>      >>>>       
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>      >>>>? ? ? <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>
>      >>>>? ? ? ?>   
>      ?<https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>      >>>>? ? ? <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>>>
>      >>>>? ? ? ?>? ? ? >? ? ? >
>      >>>>? ? ? ?>     
>      ?<https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>      >>>>? ? ? <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>
>      >>>>? ? ? ?>   
>      ?<https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>      >>>>? ? ? <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>>
>      >>>>? ? ? ?>? ? ? >
>      >>>>       
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>      >>>>? ? ? <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>
>      >>>>? ? ? ?>   
>      ?<https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>      >>>>? ? ? <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>>>>>
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >>> or, via email, send a
>     message with
>      >>>>? ? ? subject or
>      >>>>? ? ? ?>? ? ? >? ? ?body 'help' to
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >>>
>      >>>> r-sig-mixed-models-request at r-project.org
>     <mailto:r-sig-mixed-models-request at r-project.org>
>      >>>>? ? ? <mailto:r-sig-mixed-models-request at r-project.org
>     <mailto:r-sig-mixed-models-request at r-project.org>>
>      >>>>? ? ? ?>? ? ?<mailto:r-sig-mixed-models-request at r-project.org
>     <mailto:r-sig-mixed-models-request at r-project.org>
>      >>>>? ? ? <mailto:r-sig-mixed-models-request at r-project.org
>     <mailto:r-sig-mixed-models-request at r-project.org>>>
>      >>>>? ? ? ?>? ? ? >   
>      ?<mailto:r-sig-mixed-models-request at r-project.org
>     <mailto:r-sig-mixed-models-request at r-project.org>
>      >>>>? ? ? <mailto:r-sig-mixed-models-request at r-project.org
>     <mailto:r-sig-mixed-models-request at r-project.org>>
>      >>>>? ? ? ?>? ? ?<mailto:r-sig-mixed-models-request at r-project.org
>     <mailto:r-sig-mixed-models-request at r-project.org>
>      >>>>? ? ? <mailto:r-sig-mixed-models-request at r-project.org
>     <mailto:r-sig-mixed-models-request at r-project.org>>>>
>      >>>>? ? ? ?>? ? ? >? ? ? >
>      >>>>? ? ? ? <mailto:r-sig-mixed-models-request at r-project.org
>     <mailto:r-sig-mixed-models-request at r-project.org>
>      >>>>? ? ? <mailto:r-sig-mixed-models-request at r-project.org
>     <mailto:r-sig-mixed-models-request at r-project.org>>
>      >>>>? ? ? ?>? ? ?<mailto:r-sig-mixed-models-request at r-project.org
>     <mailto:r-sig-mixed-models-request at r-project.org>
>      >>>>? ? ? <mailto:r-sig-mixed-models-request at r-project.org
>     <mailto:r-sig-mixed-models-request at r-project.org>>>
>      >>>>? ? ? ?>? ? ? >   
>      ?<mailto:r-sig-mixed-models-request at r-project.org
>     <mailto:r-sig-mixed-models-request at r-project.org>
>      >>>>? ? ? <mailto:r-sig-mixed-models-request at r-project.org
>     <mailto:r-sig-mixed-models-request at r-project.org>>
>      >>>>? ? ? ?>? ? ?<mailto:r-sig-mixed-models-request at r-project.org
>     <mailto:r-sig-mixed-models-request at r-project.org>
>      >>>>? ? ? <mailto:r-sig-mixed-models-request at r-project.org
>     <mailto:r-sig-mixed-models-request at r-project.org>>>>>
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? ?<mailto:r-sig-mixed-models-request at r-project.org
>     <mailto:r-sig-mixed-models-request at r-project.org>
>      >>>>? ? ? <mailto:r-sig-mixed-models-request at r-project.org
>     <mailto:r-sig-mixed-models-request at r-project.org>>
>      >>>>? ? ? ?>? ? ?<mailto:r-sig-mixed-models-request at r-project.org
>     <mailto:r-sig-mixed-models-request at r-project.org>
>      >>>>? ? ? <mailto:r-sig-mixed-models-request at r-project.org
>     <mailto:r-sig-mixed-models-request at r-project.org>>>
>      >>>>? ? ? ?>? ? ? >   
>      ?<mailto:r-sig-mixed-models-request at r-project.org
>     <mailto:r-sig-mixed-models-request at r-project.org>
>      >>>>? ? ? <mailto:r-sig-mixed-models-request at r-project.org
>     <mailto:r-sig-mixed-models-request at r-project.org>>
>      >>>>? ? ? ?>? ? ?<mailto:r-sig-mixed-models-request at r-project.org
>     <mailto:r-sig-mixed-models-request at r-project.org>
>      >>>>? ? ? <mailto:r-sig-mixed-models-request at r-project.org
>     <mailto:r-sig-mixed-models-request at r-project.org>>>>
>      >>>>? ? ? ?>? ? ? >? ? ? >
>      >>>>? ? ? ? <mailto:r-sig-mixed-models-request at r-project.org
>     <mailto:r-sig-mixed-models-request at r-project.org>
>      >>>>? ? ? <mailto:r-sig-mixed-models-request at r-project.org
>     <mailto:r-sig-mixed-models-request at r-project.org>>
>      >>>>? ? ? ?>? ? ?<mailto:r-sig-mixed-models-request at r-project.org
>     <mailto:r-sig-mixed-models-request at r-project.org>
>      >>>>? ? ? <mailto:r-sig-mixed-models-request at r-project.org
>     <mailto:r-sig-mixed-models-request at r-project.org>>>
>      >>>>? ? ? ?>? ? ? >   
>      ?<mailto:r-sig-mixed-models-request at r-project.org
>     <mailto:r-sig-mixed-models-request at r-project.org>
>      >>>>? ? ? <mailto:r-sig-mixed-models-request at r-project.org
>     <mailto:r-sig-mixed-models-request at r-project.org>>
>      >>>>? ? ? ?>? ? ?<mailto:r-sig-mixed-models-request at r-project.org
>     <mailto:r-sig-mixed-models-request at r-project.org>
>      >>>>? ? ? <mailto:r-sig-mixed-models-request at r-project.org
>     <mailto:r-sig-mixed-models-request at r-project.org>>>>>>
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >>>
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >>> You can reach the person
>     managing
>      >>>>? ? ? the list at
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >>>
>      >>>> r-sig-mixed-models-owner at r-project.org
>     <mailto:r-sig-mixed-models-owner at r-project.org>
>      >>>>? ? ? <mailto:r-sig-mixed-models-owner at r-project.org
>     <mailto:r-sig-mixed-models-owner at r-project.org>>
>      >>>>? ? ? ?>? ? ?<mailto:r-sig-mixed-models-owner at r-project.org
>     <mailto:r-sig-mixed-models-owner at r-project.org>
>      >>>>? ? ? <mailto:r-sig-mixed-models-owner at r-project.org
>     <mailto:r-sig-mixed-models-owner at r-project.org>>>
>      >>>>? ? ? ?>? ? ? >   
>      ?<mailto:r-sig-mixed-models-owner at r-project.org
>     <mailto:r-sig-mixed-models-owner at r-project.org>
>      >>>>? ? ? <mailto:r-sig-mixed-models-owner at r-project.org
>     <mailto:r-sig-mixed-models-owner at r-project.org>>
>      >>>>? ? ? ?>? ? ?<mailto:r-sig-mixed-models-owner at r-project.org
>     <mailto:r-sig-mixed-models-owner at r-project.org>
>      >>>>? ? ? <mailto:r-sig-mixed-models-owner at r-project.org
>     <mailto:r-sig-mixed-models-owner at r-project.org>>>>
>      >>>>? ? ? ?>? ? ? >? ? ? >   
>      ?<mailto:r-sig-mixed-models-owner at r-project.org
>     <mailto:r-sig-mixed-models-owner at r-project.org>
>      >>>>? ? ? <mailto:r-sig-mixed-models-owner at r-project.org
>     <mailto:r-sig-mixed-models-owner at r-project.org>>
>      >>>>? ? ? ?>? ? ?<mailto:r-sig-mixed-models-owner at r-project.org
>     <mailto:r-sig-mixed-models-owner at r-project.org>
>      >>>>? ? ? <mailto:r-sig-mixed-models-owner at r-project.org
>     <mailto:r-sig-mixed-models-owner at r-project.org>>>
>      >>>>? ? ? ?>? ? ? >   
>      ?<mailto:r-sig-mixed-models-owner at r-project.org
>     <mailto:r-sig-mixed-models-owner at r-project.org>
>      >>>>? ? ? <mailto:r-sig-mixed-models-owner at r-project.org
>     <mailto:r-sig-mixed-models-owner at r-project.org>>
>      >>>>? ? ? ?>? ? ?<mailto:r-sig-mixed-models-owner at r-project.org
>     <mailto:r-sig-mixed-models-owner at r-project.org>
>      >>>>? ? ? <mailto:r-sig-mixed-models-owner at r-project.org
>     <mailto:r-sig-mixed-models-owner at r-project.org>>>>>
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >
>      >>>>? ? ? ? <mailto:r-sig-mixed-models-owner at r-project.org
>     <mailto:r-sig-mixed-models-owner at r-project.org>
>      >>>>? ? ? <mailto:r-sig-mixed-models-owner at r-project.org
>     <mailto:r-sig-mixed-models-owner at r-project.org>>
>      >>>>? ? ? ?>? ? ?<mailto:r-sig-mixed-models-owner at r-project.org
>     <mailto:r-sig-mixed-models-owner at r-project.org>
>      >>>>? ? ? <mailto:r-sig-mixed-models-owner at r-project.org
>     <mailto:r-sig-mixed-models-owner at r-project.org>>>
>      >>>>? ? ? ?>? ? ? >   
>      ?<mailto:r-sig-mixed-models-owner at r-project.org
>     <mailto:r-sig-mixed-models-owner at r-project.org>
>      >>>>? ? ? <mailto:r-sig-mixed-models-owner at r-project.org
>     <mailto:r-sig-mixed-models-owner at r-project.org>>
>      >>>>? ? ? ?>? ? ?<mailto:r-sig-mixed-models-owner at r-project.org
>     <mailto:r-sig-mixed-models-owner at r-project.org>
>      >>>>? ? ? <mailto:r-sig-mixed-models-owner at r-project.org
>     <mailto:r-sig-mixed-models-owner at r-project.org>>>>
>      >>>>? ? ? ?>? ? ? >? ? ? >   
>      ?<mailto:r-sig-mixed-models-owner at r-project.org
>     <mailto:r-sig-mixed-models-owner at r-project.org>
>      >>>>? ? ? <mailto:r-sig-mixed-models-owner at r-project.org
>     <mailto:r-sig-mixed-models-owner at r-project.org>>
>      >>>>? ? ? ?>? ? ?<mailto:r-sig-mixed-models-owner at r-project.org
>     <mailto:r-sig-mixed-models-owner at r-project.org>
>      >>>>? ? ? <mailto:r-sig-mixed-models-owner at r-project.org
>     <mailto:r-sig-mixed-models-owner at r-project.org>>>
>      >>>>? ? ? ?>? ? ? >   
>      ?<mailto:r-sig-mixed-models-owner at r-project.org
>     <mailto:r-sig-mixed-models-owner at r-project.org>
>      >>>>? ? ? <mailto:r-sig-mixed-models-owner at r-project.org
>     <mailto:r-sig-mixed-models-owner at r-project.org>>
>      >>>>? ? ? ?>? ? ?<mailto:r-sig-mixed-models-owner at r-project.org
>     <mailto:r-sig-mixed-models-owner at r-project.org>
>      >>>>? ? ? <mailto:r-sig-mixed-models-owner at r-project.org
>     <mailto:r-sig-mixed-models-owner at r-project.org>>>>>>
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >>>
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >>> When replying, please
>     edit your
>      >>> Subject
>      >>>>? ? ? ?>? ? ?line so it is
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ?more specific
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >>> than "Re: Contents of
>      >>>>? ? ? R-sig-mixed-models
>      >>>>? ? ? ?>? ? ?digest..."
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >>>
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >>>
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >>> Today's Topics:
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >>>
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >>>? ? ?1. Collinearity
>     diagnostics for
>      >>>>? ? ? (mixed)
>      >>>>? ? ? ?>? ? ? >? ? ?multinomial
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ?models
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >>>? ? ? ? (Juho Kristian
>     Ruohonen)
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >>>
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >>>
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >
>      >>>>? ? ? ?>
>      >>>>
>      >>> 
>      ?----------------------------------------------------------------------
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >>>
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >>> Message: 1
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >>> Date: Fri, 25 Feb 2022
>     10:23:25
>      >>> +0200
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >>> From: Juho Kristian Ruohonen
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ?<juho.kristian.ruohonen at gmail.com
>     <mailto:juho.kristian.ruohonen at gmail.com>
>      >>>>? ? ? <mailto:juho.kristian.ruohonen at gmail.com
>     <mailto:juho.kristian.ruohonen at gmail.com>>
>      >>>>? ? ? ?>? ? ?<mailto:juho.kristian.ruohonen at gmail.com
>     <mailto:juho.kristian.ruohonen at gmail.com>
>      >>>>? ? ? <mailto:juho.kristian.ruohonen at gmail.com
>     <mailto:juho.kristian.ruohonen at gmail.com>>>
>      >>>>? ? ? ?>? ? ? >? ? ?<mailto:juho.kristian.ruohonen at gmail.com
>     <mailto:juho.kristian.ruohonen at gmail.com>
>      >>>>? ? ? <mailto:juho.kristian.ruohonen at gmail.com
>     <mailto:juho.kristian.ruohonen at gmail.com>>
>      >>>>? ? ? ?>? ? ?<mailto:juho.kristian.ruohonen at gmail.com
>     <mailto:juho.kristian.ruohonen at gmail.com>
>      >>>>? ? ? <mailto:juho.kristian.ruohonen at gmail.com
>     <mailto:juho.kristian.ruohonen at gmail.com>>>>
>      >>>>? ? ? ?>? ? ? >? ? ? >   
>      ?<mailto:juho.kristian.ruohonen at gmail.com
>     <mailto:juho.kristian.ruohonen at gmail.com>
>      >>>>? ? ? <mailto:juho.kristian.ruohonen at gmail.com
>     <mailto:juho.kristian.ruohonen at gmail.com>>
>      >>>>? ? ? ?>? ? ?<mailto:juho.kristian.ruohonen at gmail.com
>     <mailto:juho.kristian.ruohonen at gmail.com>
>      >>>>? ? ? <mailto:juho.kristian.ruohonen at gmail.com
>     <mailto:juho.kristian.ruohonen at gmail.com>>>
>      >>>>? ? ? ?>? ? ? >? ? ?<mailto:juho.kristian.ruohonen at gmail.com
>     <mailto:juho.kristian.ruohonen at gmail.com>
>      >>>>? ? ? <mailto:juho.kristian.ruohonen at gmail.com
>     <mailto:juho.kristian.ruohonen at gmail.com>>
>      >>>>? ? ? ?>? ? ?<mailto:juho.kristian.ruohonen at gmail.com
>     <mailto:juho.kristian.ruohonen at gmail.com>
>      >>>>? ? ? <mailto:juho.kristian.ruohonen at gmail.com
>     <mailto:juho.kristian.ruohonen at gmail.com>>>>>
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >   
>      ?<mailto:juho.kristian.ruohonen at gmail.com
>     <mailto:juho.kristian.ruohonen at gmail.com>
>      >>>>? ? ? <mailto:juho.kristian.ruohonen at gmail.com
>     <mailto:juho.kristian.ruohonen at gmail.com>>
>      >>>>? ? ? ?>? ? ?<mailto:juho.kristian.ruohonen at gmail.com
>     <mailto:juho.kristian.ruohonen at gmail.com>
>      >>>>? ? ? <mailto:juho.kristian.ruohonen at gmail.com
>     <mailto:juho.kristian.ruohonen at gmail.com>>>
>      >>>>? ? ? ?>? ? ? >? ? ?<mailto:juho.kristian.ruohonen at gmail.com
>     <mailto:juho.kristian.ruohonen at gmail.com>
>      >>>>? ? ? <mailto:juho.kristian.ruohonen at gmail.com
>     <mailto:juho.kristian.ruohonen at gmail.com>>
>      >>>>? ? ? ?>? ? ?<mailto:juho.kristian.ruohonen at gmail.com
>     <mailto:juho.kristian.ruohonen at gmail.com>
>      >>>>? ? ? <mailto:juho.kristian.ruohonen at gmail.com
>     <mailto:juho.kristian.ruohonen at gmail.com>>>>
>      >>>>? ? ? ?>? ? ? >? ? ? >   
>      ?<mailto:juho.kristian.ruohonen at gmail.com
>     <mailto:juho.kristian.ruohonen at gmail.com>
>      >>>>? ? ? <mailto:juho.kristian.ruohonen at gmail.com
>     <mailto:juho.kristian.ruohonen at gmail.com>>
>      >>>>? ? ? ?>? ? ?<mailto:juho.kristian.ruohonen at gmail.com
>     <mailto:juho.kristian.ruohonen at gmail.com>
>      >>>>? ? ? <mailto:juho.kristian.ruohonen at gmail.com
>     <mailto:juho.kristian.ruohonen at gmail.com>>>
>      >>>>? ? ? ?>? ? ? >? ? ?<mailto:juho.kristian.ruohonen at gmail.com
>     <mailto:juho.kristian.ruohonen at gmail.com>
>      >>>>? ? ? <mailto:juho.kristian.ruohonen at gmail.com
>     <mailto:juho.kristian.ruohonen at gmail.com>>
>      >>>>? ? ? ?>? ? ?<mailto:juho.kristian.ruohonen at gmail.com
>     <mailto:juho.kristian.ruohonen at gmail.com>
>      >>>>? ? ? <mailto:juho.kristian.ruohonen at gmail.com
>     <mailto:juho.kristian.ruohonen at gmail.com>>>>>>>
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >>> To: John Fox
>     <jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
>      >>>>? ? ? <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>
>      >>>>? ? ? ?>? ? ?<mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
>     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>>
>      >>>>? ? ? ?>? ? ? >? ? ?<mailto:jfox at mcmaster.ca
>     <mailto:jfox at mcmaster.ca> <mailto:jfox at mcmaster.ca
>     <mailto:jfox at mcmaster.ca>>
>      >>>>? ? ? <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
>     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>>>
>      >>>>? ? ? ?>? ? ?<mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
>     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>
>      >>>>? ? ? <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
>     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>>
>      >>>>? ? ? ?>? ? ? >? ? ?<mailto:jfox at mcmaster.ca
>     <mailto:jfox at mcmaster.ca> <mailto:jfox at mcmaster.ca
>     <mailto:jfox at mcmaster.ca>>
>      >>>>? ? ? <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
>     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>>>>
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ?<mailto:jfox at mcmaster.ca
>     <mailto:jfox at mcmaster.ca>
>      >>>>? ? ? <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>
>     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
>      >>>>? ? ? <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>>
>      >>>>? ? ? ?>? ? ?<mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
>     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>
>      >>>>? ? ? <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
>     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>>>
>      >>>>? ? ? ?>? ? ? >? ? ?<mailto:jfox at mcmaster.ca
>     <mailto:jfox at mcmaster.ca> <mailto:jfox at mcmaster.ca
>     <mailto:jfox at mcmaster.ca>>
>      >>>>? ? ? <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
>     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>>
>      >>>>? ? ? ?>? ? ?<mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
>     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>
>      >>>>? ? ? <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>
>     <mailto:jfox at mcmaster.ca <mailto:jfox at mcmaster.ca>>>>>>>
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >>> Cc:
>      >>>>? ? ? "r-sig-mixed-models at r-project.org
>     <mailto:r-sig-mixed-models at r-project.org>
>      >>>>? ? ? <mailto:r-sig-mixed-models at r-project.org
>     <mailto:r-sig-mixed-models at r-project.org>>
>      >>>>? ? ? ?>? ? ?<mailto:r-sig-mixed-models at r-project.org
>     <mailto:r-sig-mixed-models at r-project.org>
>      >>>>? ? ? <mailto:r-sig-mixed-models at r-project.org
>     <mailto:r-sig-mixed-models at r-project.org>>>
>      >>>>? ? ? ?>? ? ? >? ? ?<mailto:r-sig-mixed-models at r-project.org
>     <mailto:r-sig-mixed-models at r-project.org>
>      >>>>? ? ? <mailto:r-sig-mixed-models at r-project.org
>     <mailto:r-sig-mixed-models at r-project.org>>
>      >>>>? ? ? ?>? ? ?<mailto:r-sig-mixed-models at r-project.org
>     <mailto:r-sig-mixed-models at r-project.org>
>      >>>>? ? ? <mailto:r-sig-mixed-models at r-project.org
>     <mailto:r-sig-mixed-models at r-project.org>>>>
>      >>>>? ? ? ?>? ? ? >? ? ? >   
>      ?<mailto:r-sig-mixed-models at r-project.org
>     <mailto:r-sig-mixed-models at r-project.org>
>      >>>>? ? ? <mailto:r-sig-mixed-models at r-project.org
>     <mailto:r-sig-mixed-models at r-project.org>>
>      >>>>? ? ? ?>? ? ?<mailto:r-sig-mixed-models at r-project.org
>     <mailto:r-sig-mixed-models at r-project.org>
>      >>>>? ? ? <mailto:r-sig-mixed-models at r-project.org
>     <mailto:r-sig-mixed-models at r-project.org>>>
>      >>>>? ? ? ?>? ? ? >? ? ?<mailto:r-sig-mixed-models at r-project.org
>     <mailto:r-sig-mixed-models at r-project.org>
>      >>>>? ? ? <mailto:r-sig-mixed-models at r-project.org
>     <mailto:r-sig-mixed-models at r-project.org>>
>      >>>>? ? ? ?>? ? ?<mailto:r-sig-mixed-models at r-project.org
>     <mailto:r-sig-mixed-models at r-project.org>
>      >>>>? ? ? <mailto:r-sig-mixed-models at r-project.org
>     <mailto:r-sig-mixed-models at r-project.org>>>>>
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >   
>      ?<mailto:r-sig-mixed-models at r-project.org
>     <mailto:r-sig-mixed-models at r-project.org>
>      >>>>? ? ? <mailto:r-sig-mixed-models at r-project.org
>     <mailto:r-sig-mixed-models at r-project.org>>
>      >>>>? ? ? ?>? ? ?<mailto:r-sig-mixed-models at r-project.org
>     <mailto:r-sig-mixed-models at r-project.org>
>      >>>>? ? ? <mailto:r-sig-mixed-models at r-project.org
>     <mailto:r-sig-mixed-models at r-project.org>>>
>      >>>>? ? ? ?>? ? ? >? ? ?<mailto:r-sig-mixed-models at r-project.org
>     <mailto:r-sig-mixed-models at r-project.org>
>      >>>>? ? ? <mailto:r-sig-mixed-models at r-project.org
>     <mailto:r-sig-mixed-models at r-project.org>>
>      >>>>? ? ? ?>? ? ?<mailto:r-sig-mixed-models at r-project.org
>     <mailto:r-sig-mixed-models at r-project.org>
>      >>>>? ? ? <mailto:r-sig-mixed-models at r-project.org
>     <mailto:r-sig-mixed-models at r-project.org>>>>
>      >>>>? ? ? ?>? ? ? >? ? ? >   
>      ?<mailto:r-sig-mixed-models at r-project.org
>     <mailto:r-sig-mixed-models at r-project.org>
>      >>>>? ? ? <mailto:r-sig-mixed-models at r-project.org
>     <mailto:r-sig-mixed-models at r-project.org>>
>      >>>>? ? ? ?>? ? ?<mailto:r-sig-mixed-models at r-project.org
>     <mailto:r-sig-mixed-models at r-project.org>
>      >>>>? ? ? <mailto:r-sig-mixed-models at r-project.org
>     <mailto:r-sig-mixed-models at r-project.org>>>
>      >>>>? ? ? ?>? ? ? >? ? ?<mailto:r-sig-mixed-models at r-project.org
>     <mailto:r-sig-mixed-models at r-project.org>
>      >>>>? ? ? <mailto:r-sig-mixed-models at r-project.org
>     <mailto:r-sig-mixed-models at r-project.org>>
>      >>>>? ? ? ?>? ? ?<mailto:r-sig-mixed-models at r-project.org
>     <mailto:r-sig-mixed-models at r-project.org>
>      >>>>? ? ? <mailto:r-sig-mixed-models at r-project.org
>     <mailto:r-sig-mixed-models at r-project.org>>>>>>"
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >>>
>      >>>>? ? ? <r-sig-mixed-models at r-project.org
>     <mailto:r-sig-mixed-models at r-project.org>
>      >>>>? ? ? <mailto:r-sig-mixed-models at r-project.org
>     <mailto:r-sig-mixed-models at r-project.org>>
>      >>>>? ? ? ?>? ? ?<mailto:r-sig-mixed-models at r-project.org
>     <mailto:r-sig-mixed-models at r-project.org>
>      >>>>? ? ? <mailto:r-sig-mixed-models at r-project.org
>     <mailto:r-sig-mixed-models at r-project.org>>>
>      >>>>? ? ? ?>? ? ? >? ? ?<mailto:r-sig-mixed-models at r-project.org
>     <mailto:r-sig-mixed-models at r-project.org>
>      >>>>? ? ? <mailto:r-sig-mixed-models at r-project.org
>     <mailto:r-sig-mixed-models at r-project.org>>
>      >>>>? ? ? ?>? ? ?<mailto:r-sig-mixed-models at r-project.org
>     <mailto:r-sig-mixed-models at r-project.org>
>      >>>>? ? ? <mailto:r-sig-mixed-models at r-project.org
>     <mailto:r-sig-mixed-models at r-project.org>>>>
>      >>>>? ? ? ?>? ? ? >? ? ? >   
>      ?<mailto:r-sig-mixed-models at r-project.org
>     <mailto:r-sig-mixed-models at r-project.org>
>      >>>>? ? ? <mailto:r-sig-mixed-models at r-project.org
>     <mailto:r-sig-mixed-models at r-project.org>>
>      >>>>? ? ? ?>? ? ?<mailto:r-sig-mixed-models at r-project.org
>     <mailto:r-sig-mixed-models at r-project.org>
>      >>>>? ? ? <mailto:r-sig-mixed-models at r-project.org
>     <mailto:r-sig-mixed-models at r-project.org>>>
>      >>>>? ? ? ?>? ? ? >? ? ?<mailto:r-sig-mixed-models at r-project.org
>     <mailto:r-sig-mixed-models at r-project.org>
>      >>>>? ? ? <mailto:r-sig-mixed-models at r-project.org
>     <mailto:r-sig-mixed-models at r-project.org>>
>      >>>>? ? ? ?>? ? ?<mailto:r-sig-mixed-models at r-project.org
>     <mailto:r-sig-mixed-models at r-project.org>
>      >>>>? ? ? <mailto:r-sig-mixed-models at r-project.org
>     <mailto:r-sig-mixed-models at r-project.org>>>>>
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >   
>      ?<mailto:r-sig-mixed-models at r-project.org
>     <mailto:r-sig-mixed-models at r-project.org>
>      >>>>? ? ? <mailto:r-sig-mixed-models at r-project.org
>     <mailto:r-sig-mixed-models at r-project.org>>
>      >>>>? ? ? ?>? ? ?<mailto:r-sig-mixed-models at r-project.org
>     <mailto:r-sig-mixed-models at r-project.org>
>      >>>>? ? ? <mailto:r-sig-mixed-models at r-project.org
>     <mailto:r-sig-mixed-models at r-project.org>>>
>      >>>>? ? ? ?>? ? ? >? ? ?<mailto:r-sig-mixed-models at r-project.org
>     <mailto:r-sig-mixed-models at r-project.org>
>      >>>>? ? ? <mailto:r-sig-mixed-models at r-project.org
>     <mailto:r-sig-mixed-models at r-project.org>>
>      >>>>? ? ? ?>? ? ?<mailto:r-sig-mixed-models at r-project.org
>     <mailto:r-sig-mixed-models at r-project.org>
>      >>>>? ? ? <mailto:r-sig-mixed-models at r-project.org
>     <mailto:r-sig-mixed-models at r-project.org>>>>
>      >>>>? ? ? ?>? ? ? >? ? ? >   
>      ?<mailto:r-sig-mixed-models at r-project.org
>     <mailto:r-sig-mixed-models at r-project.org>
>      >>>>? ? ? <mailto:r-sig-mixed-models at r-project.org
>     <mailto:r-sig-mixed-models at r-project.org>>
>      >>>>? ? ? ?>? ? ?<mailto:r-sig-mixed-models at r-project.org
>     <mailto:r-sig-mixed-models at r-project.org>
>      >>>>? ? ? <mailto:r-sig-mixed-models at r-project.org
>     <mailto:r-sig-mixed-models at r-project.org>>>
>      >>>>? ? ? ?>? ? ? >? ? ?<mailto:r-sig-mixed-models at r-project.org
>     <mailto:r-sig-mixed-models at r-project.org>
>      >>>>? ? ? <mailto:r-sig-mixed-models at r-project.org
>     <mailto:r-sig-mixed-models at r-project.org>>
>      >>>>? ? ? ?>? ? ?<mailto:r-sig-mixed-models at r-project.org
>     <mailto:r-sig-mixed-models at r-project.org>
>      >>>>? ? ? <mailto:r-sig-mixed-models at r-project.org
>     <mailto:r-sig-mixed-models at r-project.org>>>>>>>
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >>> Subject: [R-sig-ME]
>     Collinearity
>      >>>>? ? ? ?>? ? ?diagnostics for
>      >>>>? ? ? ?>? ? ? >? ? ?(mixed)
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?multinomial
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >>>? ? ? ? ? models
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >>> Message-ID:
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >>>? ? ? ? ? <
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >>>
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >
>      >>>>? ? ? ?>
>      >>>>
>     CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com
>     <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com>
>      >>>>? ? ? <mailto:
>      >>>
>     CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com
>     <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com>>
>      >>>>? ? ? ?>
>      >>>>? ? ? ? <mailto:
>      >>>
>     CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com
>     <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com>
>      >>>
>     <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com>
>      >>>>>
>      >>>>? ? ? ?>? ? ? >
>      >>>>? ? ? ?>
>      >>>>? ? ? ? <mailto:
>      >>>
>     CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com
>     <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com>
>      >>>
>     <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com>>
>      >>>
>     <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com>
>      >>>
>     <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com>
>      >>>>>>
>      >>>>? ? ? ?>? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >
>      >>>>? ? ? ?>
>      >>>>? ? ? ? <mailto:
>      >>>
>     CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com
>     <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com>
>      >>>
>     <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com>>
>      >>>
>     <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com>
>      >>>
>     <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com>>>
>      >>>
>     <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com>
>      >>>
>     <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com>>
>      >>>
>     <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com>
>      >>>
>     <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com>
>      >>>>>>>
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >
>      >>>>? ? ? ?>
>      >>>>? ? ? ? <mailto:
>      >>>
>     CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com
>     <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com>
>      >>>
>     <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com>>
>      >>>
>     <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com>
>      >>>
>     <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com>>>
>      >>>
>     <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com>
>      >>>
>     <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com>>
>      >>>
>     <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com>
>      >>>
>     <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com>>>>
>      >>>
>     <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com>
>      >>>
>     <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com>>
>      >>>
>     <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com>
>      >>>
>     <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com>>>
>      >>>
>     <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com>
>      >>>
>     <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com>>
>      >>>
>     <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com>
>      >>>
>     <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com <mailto:CAG_dBVfZr1-P7Q3kbE8TGPm-_2sJixdGCHCtWM9Q9PEnd8ftZw at mail.gmail.com>
>      >>>>>>>>>
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >>> Content-Type: text/plain;
>      >>>>? ? ? charset="utf-8"
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >>>
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >>> Dear John (and anyone else
>      >>> qualified to
>      >>>>? ? ? ?>? ? ?comment),
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >>>
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >>> I fit lots of mixed-effects
>      >>> multinomial
>      >>>>? ? ? ?>? ? ?models in my
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ?research,
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?and I
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >> would
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >>> like to see some
>     (multi)collinearity
>      >>>>? ? ? ?>? ? ?diagnostics
>      >>>>? ? ? ?>? ? ? >? ? ?on the
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ?fixed
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?effects, of
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >>> which there are over 30.
>     My models
>      >>>>? ? ? are fit
>      >>>>? ? ? ?>? ? ?using the
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ?Bayesian
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?*brms*
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >>> package because I know of no
>      >>>>? ? ? frequentist
>      >>>>? ? ? ?>? ? ?packages
>      >>>>? ? ? ?>? ? ? >? ? ?with
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?multinomial GLMM
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >>> compatibility.
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >>>
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >>> With continuous or
>     dichotomous
>      >>>>? ? ? outcomes,
>      >>>>? ? ? ?>? ? ?my go-to
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ?function for
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >> calculating
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >>> multicollinearity
>     diagnostics is of
>      >>>>? ? ? course
>      >>>>? ? ? ?>? ? ? >? ? ?*vif()* from
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ?the *car*
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >> package.
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >>> As expected, however,
>     this function
>      >>>>? ? ? does not
>      >>>>? ? ? ?>? ? ? >? ? ?report sensible
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?diagnostics
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >>> for multinomial models
>     -- not even
>      >>> for
>      >>>>? ? ? ?>? ? ?standard
>      >>>>? ? ? ?>? ? ? >? ? ?ones fit
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ?by the
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?*nnet*
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >>> package's *multinom()*
>     function.
>      >>>>? ? ? The reason, I
>      >>>>? ? ? ?>? ? ? >? ? ?presume, is
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?because a
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >>> multinomial model is not
>     really one
>      >>>>? ? ? but C-1
>      >>>>? ? ? ?>? ? ? >? ? ?regression
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ?models
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?(where C
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >> is
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >>> the number of response
>     categories)
>      >>>>? ? ? and the
>      >>>>? ? ? ?>? ? ?*vif()*
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ?function is not
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >> designed
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >>> to deal with this scenario.
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >>>
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >>> Therefore, in order to
>     obtain
>      >>>>? ? ? meaningful
>      >>>>? ? ? ?>? ? ?collinearity
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ?metrics,
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?my present
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >>> plan is to write a
>     simple helper
>      >>>>? ? ? function
>      >>>>? ? ? ?>? ? ?that uses
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ?*vif() *to
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?calculate
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >>> and present
>     (generalized) variance
>      >>>>? ? ? inflation
>      >>>>? ? ? ?>? ? ? >? ? ?metrics for
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ?the C-1
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >>> sub-datasets to which
>     the C-1
>      >>> component
>      >>>>? ? ? ?>? ? ?binomial
>      >>>>? ? ? ?>? ? ? >? ? ?models
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ?of the
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?overall
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >>> multinomial model are
>     fit. In other
>      >>>>? ? ? words, it
>      >>>>? ? ? ?>? ? ? >? ? ?will partition
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?the data
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >> into
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >>> those C-1 subsets, and
>     then apply
>      >>>>? ? ? *vif()*
>      >>>>? ? ? ?>? ? ?to as
>      >>>>? ? ? ?>? ? ? >? ? ?many linear
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?regressions
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >>> using a made-up
>     continuous response
>      >>> and
>      >>>>? ? ? ?>? ? ?the fixed
>      >>>>? ? ? ?>? ? ? >? ? ?effects of
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?interest.
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >>>
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >>> Does this seem like a
>     sensible
>      >>>>? ? ? approach?
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >>>
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >>> Best,
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >>>
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >>> Juho
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >>>
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >>>
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >>>
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >>
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >>? ? ? ? ? [[alternative
>     HTML version
>      >>>>? ? ? deleted]]
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >>
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >>
>      >>>>? ? ? _______________________________________________
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >>
>     R-sig-mixed-models at r-project.org
>     <mailto:R-sig-mixed-models at r-project.org>
>      >>>>? ? ? <mailto:R-sig-mixed-models at r-project.org
>     <mailto:R-sig-mixed-models at r-project.org>>
>      >>>>? ? ? ?>? ? ?<mailto:R-sig-mixed-models at r-project.org
>     <mailto:R-sig-mixed-models at r-project.org>
>      >>>>? ? ? <mailto:R-sig-mixed-models at r-project.org
>     <mailto:R-sig-mixed-models at r-project.org>>>
>      >>>>? ? ? ?>? ? ? >? ? ?<mailto:R-sig-mixed-models at r-project.org
>     <mailto:R-sig-mixed-models at r-project.org>
>      >>>>? ? ? <mailto:R-sig-mixed-models at r-project.org
>     <mailto:R-sig-mixed-models at r-project.org>>
>      >>>>? ? ? ?>? ? ?<mailto:R-sig-mixed-models at r-project.org
>     <mailto:R-sig-mixed-models at r-project.org>
>      >>>>? ? ? <mailto:R-sig-mixed-models at r-project.org
>     <mailto:R-sig-mixed-models at r-project.org>>>>
>      >>>>? ? ? ?>? ? ? >? ? ? >   
>      ?<mailto:R-sig-mixed-models at r-project.org
>     <mailto:R-sig-mixed-models at r-project.org>
>      >>>>? ? ? <mailto:R-sig-mixed-models at r-project.org
>     <mailto:R-sig-mixed-models at r-project.org>>
>      >>>>? ? ? ?>? ? ?<mailto:R-sig-mixed-models at r-project.org
>     <mailto:R-sig-mixed-models at r-project.org>
>      >>>>? ? ? <mailto:R-sig-mixed-models at r-project.org
>     <mailto:R-sig-mixed-models at r-project.org>>>
>      >>>>? ? ? ?>? ? ? >? ? ?<mailto:R-sig-mixed-models at r-project.org
>     <mailto:R-sig-mixed-models at r-project.org>
>      >>>>? ? ? <mailto:R-sig-mixed-models at r-project.org
>     <mailto:R-sig-mixed-models at r-project.org>>
>      >>>>? ? ? ?>? ? ?<mailto:R-sig-mixed-models at r-project.org
>     <mailto:R-sig-mixed-models at r-project.org>
>      >>>>? ? ? <mailto:R-sig-mixed-models at r-project.org
>     <mailto:R-sig-mixed-models at r-project.org>>>>>
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >   
>      ?<mailto:R-sig-mixed-models at r-project.org
>     <mailto:R-sig-mixed-models at r-project.org>
>      >>>>? ? ? <mailto:R-sig-mixed-models at r-project.org
>     <mailto:R-sig-mixed-models at r-project.org>>
>      >>>>? ? ? ?>? ? ?<mailto:R-sig-mixed-models at r-project.org
>     <mailto:R-sig-mixed-models at r-project.org>
>      >>>>? ? ? <mailto:R-sig-mixed-models at r-project.org
>     <mailto:R-sig-mixed-models at r-project.org>>>
>      >>>>? ? ? ?>? ? ? >? ? ?<mailto:R-sig-mixed-models at r-project.org
>     <mailto:R-sig-mixed-models at r-project.org>
>      >>>>? ? ? <mailto:R-sig-mixed-models at r-project.org
>     <mailto:R-sig-mixed-models at r-project.org>>
>      >>>>? ? ? ?>? ? ?<mailto:R-sig-mixed-models at r-project.org
>     <mailto:R-sig-mixed-models at r-project.org>
>      >>>>? ? ? <mailto:R-sig-mixed-models at r-project.org
>     <mailto:R-sig-mixed-models at r-project.org>>>>
>      >>>>? ? ? ?>? ? ? >? ? ? >   
>      ?<mailto:R-sig-mixed-models at r-project.org
>     <mailto:R-sig-mixed-models at r-project.org>
>      >>>>? ? ? <mailto:R-sig-mixed-models at r-project.org
>     <mailto:R-sig-mixed-models at r-project.org>>
>      >>>>? ? ? ?>? ? ?<mailto:R-sig-mixed-models at r-project.org
>     <mailto:R-sig-mixed-models at r-project.org>
>      >>>>? ? ? <mailto:R-sig-mixed-models at r-project.org
>     <mailto:R-sig-mixed-models at r-project.org>>>
>      >>>>? ? ? ?>? ? ? >? ? ?<mailto:R-sig-mixed-models at r-project.org
>     <mailto:R-sig-mixed-models at r-project.org>
>      >>>>? ? ? <mailto:R-sig-mixed-models at r-project.org
>     <mailto:R-sig-mixed-models at r-project.org>>
>      >>>>? ? ? ?>? ? ?<mailto:R-sig-mixed-models at r-project.org
>     <mailto:R-sig-mixed-models at r-project.org>
>      >>>>? ? ? <mailto:R-sig-mixed-models at r-project.org
>     <mailto:R-sig-mixed-models at r-project.org>>>>>> mailing list
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >>
>      >>>>? ? ? ?>? ? ? >
>     https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>      >>>>? ? ? <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>
>      >>>>? ? ? ?>   
>      ?<https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>      >>>>? ? ? <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>>
>      >>>>? ? ? ?>? ? ? >
>      >>>>       
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>      >>>>? ? ? <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>
>      >>>>? ? ? ?>   
>      ?<https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>      >>>>? ? ? <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>>>
>      >>>>? ? ? ?>? ? ? >? ? ? >
>      >>>>? ? ? ?>     
>      ?<https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>      >>>>? ? ? <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>
>      >>>>? ? ? ?>   
>      ?<https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>      >>>>? ? ? <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>>
>      >>>>? ? ? ?>? ? ? >
>      >>>>       
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>      >>>>? ? ? <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>
>      >>>>? ? ? ?>   
>      ?<https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>      >>>>? ? ? <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>>>>
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >
>      >>>>       
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>      >>>>? ? ? <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>
>      >>>>? ? ? ?>   
>      ?<https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>      >>>>? ? ? <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>>
>      >>>>? ? ? ?>? ? ? >
>      >>>>       
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>      >>>>? ? ? <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>
>      >>>>? ? ? ?>   
>      ?<https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>      >>>>? ? ? <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>>>
>      >>>>? ? ? ?>? ? ? >? ? ? >
>      >>>>? ? ? ?>     
>      ?<https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>      >>>>? ? ? <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>
>      >>>>? ? ? ?>   
>      ?<https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>      >>>>? ? ? <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>>
>      >>>>? ? ? ?>? ? ? >
>      >>>>       
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>      >>>>? ? ? <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>
>      >>>>? ? ? ?>   
>      ?<https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>      >>>>? ? ? <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>>>>>
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >>
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >? ? ? ?[[alternative HTML
>     version
>      >>>>? ? ? deleted]]
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >
>      >>>>? ? ? _______________________________________________
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >
>     R-sig-mixed-models at r-project.org
>     <mailto:R-sig-mixed-models at r-project.org>
>      >>>>? ? ? <mailto:R-sig-mixed-models at r-project.org
>     <mailto:R-sig-mixed-models at r-project.org>>
>      >>>>? ? ? ?>? ? ?<mailto:R-sig-mixed-models at r-project.org
>     <mailto:R-sig-mixed-models at r-project.org>
>      >>>>? ? ? <mailto:R-sig-mixed-models at r-project.org
>     <mailto:R-sig-mixed-models at r-project.org>>>
>      >>>>? ? ? ?>? ? ? >? ? ?<mailto:R-sig-mixed-models at r-project.org
>     <mailto:R-sig-mixed-models at r-project.org>
>      >>>>? ? ? <mailto:R-sig-mixed-models at r-project.org
>     <mailto:R-sig-mixed-models at r-project.org>>
>      >>>>? ? ? ?>? ? ?<mailto:R-sig-mixed-models at r-project.org
>     <mailto:R-sig-mixed-models at r-project.org>
>      >>>>? ? ? <mailto:R-sig-mixed-models at r-project.org
>     <mailto:R-sig-mixed-models at r-project.org>>>>
>      >>>>? ? ? ?>? ? ? >? ? ? >   
>      ?<mailto:R-sig-mixed-models at r-project.org
>     <mailto:R-sig-mixed-models at r-project.org>
>      >>>>? ? ? <mailto:R-sig-mixed-models at r-project.org
>     <mailto:R-sig-mixed-models at r-project.org>>
>      >>>>? ? ? ?>? ? ?<mailto:R-sig-mixed-models at r-project.org
>     <mailto:R-sig-mixed-models at r-project.org>
>      >>>>? ? ? <mailto:R-sig-mixed-models at r-project.org
>     <mailto:R-sig-mixed-models at r-project.org>>>
>      >>>>? ? ? ?>? ? ? >? ? ?<mailto:R-sig-mixed-models at r-project.org
>     <mailto:R-sig-mixed-models at r-project.org>
>      >>>>? ? ? <mailto:R-sig-mixed-models at r-project.org
>     <mailto:R-sig-mixed-models at r-project.org>>
>      >>>>? ? ? ?>? ? ?<mailto:R-sig-mixed-models at r-project.org
>     <mailto:R-sig-mixed-models at r-project.org>
>      >>>>? ? ? <mailto:R-sig-mixed-models at r-project.org
>     <mailto:R-sig-mixed-models at r-project.org>>>>>
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >   
>      ?<mailto:R-sig-mixed-models at r-project.org
>     <mailto:R-sig-mixed-models at r-project.org>
>      >>>>? ? ? <mailto:R-sig-mixed-models at r-project.org
>     <mailto:R-sig-mixed-models at r-project.org>>
>      >>>>? ? ? ?>? ? ?<mailto:R-sig-mixed-models at r-project.org
>     <mailto:R-sig-mixed-models at r-project.org>
>      >>>>? ? ? <mailto:R-sig-mixed-models at r-project.org
>     <mailto:R-sig-mixed-models at r-project.org>>>
>      >>>>? ? ? ?>? ? ? >? ? ?<mailto:R-sig-mixed-models at r-project.org
>     <mailto:R-sig-mixed-models at r-project.org>
>      >>>>? ? ? <mailto:R-sig-mixed-models at r-project.org
>     <mailto:R-sig-mixed-models at r-project.org>>
>      >>>>? ? ? ?>? ? ?<mailto:R-sig-mixed-models at r-project.org
>     <mailto:R-sig-mixed-models at r-project.org>
>      >>>>? ? ? <mailto:R-sig-mixed-models at r-project.org
>     <mailto:R-sig-mixed-models at r-project.org>>>>
>      >>>>? ? ? ?>? ? ? >? ? ? >   
>      ?<mailto:R-sig-mixed-models at r-project.org
>     <mailto:R-sig-mixed-models at r-project.org>
>      >>>>? ? ? <mailto:R-sig-mixed-models at r-project.org
>     <mailto:R-sig-mixed-models at r-project.org>>
>      >>>>? ? ? ?>? ? ?<mailto:R-sig-mixed-models at r-project.org
>     <mailto:R-sig-mixed-models at r-project.org>
>      >>>>? ? ? <mailto:R-sig-mixed-models at r-project.org
>     <mailto:R-sig-mixed-models at r-project.org>>>
>      >>>>? ? ? ?>? ? ? >? ? ?<mailto:R-sig-mixed-models at r-project.org
>     <mailto:R-sig-mixed-models at r-project.org>
>      >>>>? ? ? <mailto:R-sig-mixed-models at r-project.org
>     <mailto:R-sig-mixed-models at r-project.org>>
>      >>>>? ? ? ?>? ? ?<mailto:R-sig-mixed-models at r-project.org
>     <mailto:R-sig-mixed-models at r-project.org>
>      >>>>? ? ? <mailto:R-sig-mixed-models at r-project.org
>     <mailto:R-sig-mixed-models at r-project.org>>>>>> mailing list
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >
>     https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>      >>>>? ? ? <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>
>      >>>>? ? ? ?>   
>      ?<https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>      >>>>? ? ? <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>>
>      >>>>? ? ? ?>? ? ? >
>      >>>>       
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>      >>>>? ? ? <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>
>      >>>>? ? ? ?>   
>      ?<https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>      >>>>? ? ? <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>>>
>      >>>>? ? ? ?>? ? ? >? ? ? >
>      >>>>? ? ? ?>     
>      ?<https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>      >>>>? ? ? <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>
>      >>>>? ? ? ?>   
>      ?<https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>      >>>>? ? ? <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>>
>      >>>>? ? ? ?>? ? ? >
>      >>>>       
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>      >>>>? ? ? <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>
>      >>>>? ? ? ?>   
>      ?<https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>      >>>>? ? ? <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>>>>
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >
>      >>>>       
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>      >>>>? ? ? <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>
>      >>>>? ? ? ?>   
>      ?<https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>      >>>>? ? ? <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>>
>      >>>>? ? ? ?>? ? ? >
>      >>>>       
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>      >>>>? ? ? <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>
>      >>>>? ? ? ?>   
>      ?<https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>      >>>>? ? ? <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>>>
>      >>>>? ? ? ?>? ? ? >? ? ? >
>      >>>>? ? ? ?>     
>      ?<https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>      >>>>? ? ? <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>
>      >>>>? ? ? ?>   
>      ?<https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>      >>>>? ? ? <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>>
>      >>>>? ? ? ?>? ? ? >
>      >>>>       
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>      >>>>? ? ? <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>
>      >>>>? ? ? ?>   
>      ?<https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>      >>>>? ? ? <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>>>>>>
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?--
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?John Fox, Professor Emeritus
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?McMaster University
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?Hamilton, Ontario, Canada
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >? ? ?web:
>      >>>> https://socialsciences.mcmaster.ca/jfox/
>     <https://socialsciences.mcmaster.ca/jfox/>
>      >>>>? ? ? <https://socialsciences.mcmaster.ca/jfox/
>     <https://socialsciences.mcmaster.ca/jfox/>>
>      >>>>? ? ? ?>? ? ?<https://socialsciences.mcmaster.ca/jfox/
>     <https://socialsciences.mcmaster.ca/jfox/>
>      >>>>? ? ? <https://socialsciences.mcmaster.ca/jfox/
>     <https://socialsciences.mcmaster.ca/jfox/>>>
>      >>>>? ? ? ?>? ? ? >? ? ?<https://socialsciences.mcmaster.ca/jfox/
>     <https://socialsciences.mcmaster.ca/jfox/>
>      >>>>? ? ? <https://socialsciences.mcmaster.ca/jfox/
>     <https://socialsciences.mcmaster.ca/jfox/>>
>      >>>>? ? ? ?>? ? ?<https://socialsciences.mcmaster.ca/jfox/
>     <https://socialsciences.mcmaster.ca/jfox/>
>      >>>>? ? ? <https://socialsciences.mcmaster.ca/jfox/
>     <https://socialsciences.mcmaster.ca/jfox/>>>>
>      >>>>? ? ? ?>? ? ? >? ? ? >   
>      ?<https://socialsciences.mcmaster.ca/jfox/
>     <https://socialsciences.mcmaster.ca/jfox/>
>      >>>>? ? ? <https://socialsciences.mcmaster.ca/jfox/
>     <https://socialsciences.mcmaster.ca/jfox/>>
>      >>>>? ? ? ?>? ? ?<https://socialsciences.mcmaster.ca/jfox/
>     <https://socialsciences.mcmaster.ca/jfox/>
>      >>>>? ? ? <https://socialsciences.mcmaster.ca/jfox/
>     <https://socialsciences.mcmaster.ca/jfox/>>>
>      >>>>? ? ? ?>? ? ? >? ? ?<https://socialsciences.mcmaster.ca/jfox/
>     <https://socialsciences.mcmaster.ca/jfox/>
>      >>>>? ? ? <https://socialsciences.mcmaster.ca/jfox/
>     <https://socialsciences.mcmaster.ca/jfox/>>
>      >>>>? ? ? ?>? ? ?<https://socialsciences.mcmaster.ca/jfox/
>     <https://socialsciences.mcmaster.ca/jfox/>
>      >>>>? ? ? <https://socialsciences.mcmaster.ca/jfox/
>     <https://socialsciences.mcmaster.ca/jfox/>>>>>
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >
>      >>>>? ? ? ? <https://socialsciences.mcmaster.ca/jfox/
>     <https://socialsciences.mcmaster.ca/jfox/>
>      >>>>? ? ? <https://socialsciences.mcmaster.ca/jfox/
>     <https://socialsciences.mcmaster.ca/jfox/>>
>      >>>>? ? ? ?>? ? ?<https://socialsciences.mcmaster.ca/jfox/
>     <https://socialsciences.mcmaster.ca/jfox/>
>      >>>>? ? ? <https://socialsciences.mcmaster.ca/jfox/
>     <https://socialsciences.mcmaster.ca/jfox/>>>
>      >>>>? ? ? ?>? ? ? >? ? ?<https://socialsciences.mcmaster.ca/jfox/
>     <https://socialsciences.mcmaster.ca/jfox/>
>      >>>>? ? ? <https://socialsciences.mcmaster.ca/jfox/
>     <https://socialsciences.mcmaster.ca/jfox/>>
>      >>>>? ? ? ?>? ? ?<https://socialsciences.mcmaster.ca/jfox/
>     <https://socialsciences.mcmaster.ca/jfox/>
>      >>>>? ? ? <https://socialsciences.mcmaster.ca/jfox/
>     <https://socialsciences.mcmaster.ca/jfox/>>>>
>      >>>>? ? ? ?>? ? ? >? ? ? >   
>      ?<https://socialsciences.mcmaster.ca/jfox/
>     <https://socialsciences.mcmaster.ca/jfox/>
>      >>>>? ? ? <https://socialsciences.mcmaster.ca/jfox/
>     <https://socialsciences.mcmaster.ca/jfox/>>
>      >>>>? ? ? ?>? ? ?<https://socialsciences.mcmaster.ca/jfox/
>     <https://socialsciences.mcmaster.ca/jfox/>
>      >>>>? ? ? <https://socialsciences.mcmaster.ca/jfox/
>     <https://socialsciences.mcmaster.ca/jfox/>>>
>      >>>>? ? ? ?>? ? ? >? ? ?<https://socialsciences.mcmaster.ca/jfox/
>     <https://socialsciences.mcmaster.ca/jfox/>
>      >>>>? ? ? <https://socialsciences.mcmaster.ca/jfox/
>     <https://socialsciences.mcmaster.ca/jfox/>>
>      >>>>? ? ? ?>? ? ?<https://socialsciences.mcmaster.ca/jfox/
>     <https://socialsciences.mcmaster.ca/jfox/>
>      >>>>? ? ? <https://socialsciences.mcmaster.ca/jfox/
>     <https://socialsciences.mcmaster.ca/jfox/>>>>>>
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ?--
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ?John Fox, Professor Emeritus
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ?McMaster University
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ?Hamilton, Ontario, Canada
>      >>>>? ? ? ?>? ? ? >? ? ? >? ? ?web:
>     https://socialsciences.mcmaster.ca/jfox/
>     <https://socialsciences.mcmaster.ca/jfox/>
>      >>>>? ? ? <https://socialsciences.mcmaster.ca/jfox/
>     <https://socialsciences.mcmaster.ca/jfox/>>
>      >>>>? ? ? ?>? ? ?<https://socialsciences.mcmaster.ca/jfox/
>     <https://socialsciences.mcmaster.ca/jfox/>
>      >>>>? ? ? <https://socialsciences.mcmaster.ca/jfox/
>     <https://socialsciences.mcmaster.ca/jfox/>>>
>      >>>>? ? ? ?>? ? ? >? ? ?<https://socialsciences.mcmaster.ca/jfox/
>     <https://socialsciences.mcmaster.ca/jfox/>
>      >>>>? ? ? <https://socialsciences.mcmaster.ca/jfox/
>     <https://socialsciences.mcmaster.ca/jfox/>>
>      >>>>? ? ? ?>? ? ?<https://socialsciences.mcmaster.ca/jfox/
>     <https://socialsciences.mcmaster.ca/jfox/>
>      >>>>? ? ? <https://socialsciences.mcmaster.ca/jfox/
>     <https://socialsciences.mcmaster.ca/jfox/>>>>
>      >>>>? ? ? ?>? ? ? >? ? ? >   
>      ?<https://socialsciences.mcmaster.ca/jfox/
>     <https://socialsciences.mcmaster.ca/jfox/>
>      >>>>? ? ? <https://socialsciences.mcmaster.ca/jfox/
>     <https://socialsciences.mcmaster.ca/jfox/>>
>      >>>>? ? ? ?>? ? ?<https://socialsciences.mcmaster.ca/jfox/
>     <https://socialsciences.mcmaster.ca/jfox/>
>      >>>>? ? ? <https://socialsciences.mcmaster.ca/jfox/
>     <https://socialsciences.mcmaster.ca/jfox/>>>
>      >>>>? ? ? ?>? ? ? >? ? ?<https://socialsciences.mcmaster.ca/jfox/
>     <https://socialsciences.mcmaster.ca/jfox/>
>      >>>>? ? ? <https://socialsciences.mcmaster.ca/jfox/
>     <https://socialsciences.mcmaster.ca/jfox/>>
>      >>>>? ? ? ?>? ? ?<https://socialsciences.mcmaster.ca/jfox/
>     <https://socialsciences.mcmaster.ca/jfox/>
>      >>>>? ? ? <https://socialsciences.mcmaster.ca/jfox/
>     <https://socialsciences.mcmaster.ca/jfox/>>>>>
>      >>>>? ? ? ?>? ? ? >? ? ? >
>      >>>>? ? ? ?>? ? ? >? ? ?--
>      >>>>? ? ? ?>? ? ? >? ? ?John Fox, Professor Emeritus
>      >>>>? ? ? ?>? ? ? >? ? ?McMaster University
>      >>>>? ? ? ?>? ? ? >? ? ?Hamilton, Ontario, Canada
>      >>>>? ? ? ?>? ? ? >? ? ?web:
>     https://socialsciences.mcmaster.ca/jfox/
>     <https://socialsciences.mcmaster.ca/jfox/>
>      >>>>? ? ? <https://socialsciences.mcmaster.ca/jfox/
>     <https://socialsciences.mcmaster.ca/jfox/>>
>      >>>>? ? ? ?>? ? ?<https://socialsciences.mcmaster.ca/jfox/
>     <https://socialsciences.mcmaster.ca/jfox/>
>      >>>>? ? ? <https://socialsciences.mcmaster.ca/jfox/
>     <https://socialsciences.mcmaster.ca/jfox/>>>
>      >>>>? ? ? ?>? ? ? >? ? ?<https://socialsciences.mcmaster.ca/jfox/
>     <https://socialsciences.mcmaster.ca/jfox/>
>      >>>>? ? ? <https://socialsciences.mcmaster.ca/jfox/
>     <https://socialsciences.mcmaster.ca/jfox/>>
>      >>>>? ? ? ?>? ? ?<https://socialsciences.mcmaster.ca/jfox/
>     <https://socialsciences.mcmaster.ca/jfox/>
>      >>>>? ? ? <https://socialsciences.mcmaster.ca/jfox/
>     <https://socialsciences.mcmaster.ca/jfox/>>>>
>      >>>>? ? ? ?>? ? ? >
>      >>>>? ? ? ?>
>      >>>>
>      >>> 
>      ?------------------------------------------------------------------------
>      >>>>? ? ? ?>? ? ?--
>      >>>>? ? ? ?>? ? ?John Fox, Professor Emeritus
>      >>>>? ? ? ?>? ? ?McMaster University
>      >>>>? ? ? ?>? ? ?Hamilton, Ontario, Canada
>      >>>>? ? ? ?>? ? ?web: https://socialsciences.mcmaster.ca/jfox/
>     <https://socialsciences.mcmaster.ca/jfox/>
>      >>>>? ? ? <https://socialsciences.mcmaster.ca/jfox/
>     <https://socialsciences.mcmaster.ca/jfox/>>
>      >>>>? ? ? ?>? ? ?<https://socialsciences.mcmaster.ca/jfox/
>     <https://socialsciences.mcmaster.ca/jfox/>
>      >>>>? ? ? <https://socialsciences.mcmaster.ca/jfox/
>     <https://socialsciences.mcmaster.ca/jfox/>>>
>      >>>>? ? ? ?>
>      >>>>? ? ? --
>      >>>>? ? ? John Fox, Professor Emeritus
>      >>>>? ? ? McMaster University
>      >>>>? ? ? Hamilton, Ontario, Canada
>      >>>>? ? ? web: https://socialsciences.mcmaster.ca/jfox/
>     <https://socialsciences.mcmaster.ca/jfox/>
>      >>>>? ? ? <https://socialsciences.mcmaster.ca/jfox/
>     <https://socialsciences.mcmaster.ca/jfox/>>
>      >>>>
>      >>> --
>      >>> John Fox, Professor Emeritus
>      >>> McMaster University
>      >>> Hamilton, Ontario, Canada
>      >>> web: https://socialsciences.mcmaster.ca/jfox/
>     <https://socialsciences.mcmaster.ca/jfox/>
>      >>>
>      >>>
>      >>
>      >>? ? ? [[alternative HTML version deleted]]
>      >>
>      >> _______________________________________________
>      >> R-sig-mixed-models at r-project.org
>     <mailto:R-sig-mixed-models at r-project.org> mailing list
>      >> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>      >>
>


From @ndrebo|erb@rro@ @end|ng |rom gm@||@com  Fri Feb  3 01:15:44 2023
From: @ndrebo|erb@rro@ @end|ng |rom gm@||@com (=?UTF-8?Q?Andr=C3=A9_Boler_Barros?=)
Date: Fri, 3 Feb 2023 00:15:44 +0000
Subject: [R-sig-ME] glmmTMB ziformula accepts random effects
Message-ID: <CAFMs1J68rsNKqyOq1mnN_Qy51hiP9QEecuWOLX8Lhq=q2mFp5Q@mail.gmail.com>

Hi everyone,

Does anyone knows if, for a zero-inflated negative binomial model with
random effects, the glmmTMB function accepts a random effect structure in
the ziformula?

Thanks in advance,

Andr?

	[[alternative HTML version deleted]]


From bbo|ker @end|ng |rom gm@||@com  Fri Feb  3 01:25:12 2023
From: bbo|ker @end|ng |rom gm@||@com (Ben Bolker)
Date: Thu, 2 Feb 2023 19:25:12 -0500
Subject: [R-sig-ME] glmmTMB ziformula accepts random effects
In-Reply-To: <CAFMs1J68rsNKqyOq1mnN_Qy51hiP9QEecuWOLX8Lhq=q2mFp5Q@mail.gmail.com>
References: <CAFMs1J68rsNKqyOq1mnN_Qy51hiP9QEecuWOLX8Lhq=q2mFp5Q@mail.gmail.com>
Message-ID: <00bc1b60-1143-d029-7333-3be18d6d1bb3@gmail.com>

 ? Yes (I know) and yes (it does).

 ? The help page for ?glmmTMB says:

ziformula: a _one-sided_ (i.e., no response variable) formula for
 ????????? zero-inflation combining fixed and random effects:

 ?? The only caution is that you might need a fairly large data set to 
estimate these terms reliably ...

On 2023-02-02 7:15 p.m., Andr? Boler Barros wrote:
> Hi everyone,
>
> Does anyone knows if, for a zero-inflated negative binomial model with
> random effects, the glmmTMB function accepts a random effect structure in
> the ziformula?
>
> Thanks in advance,
>
> Andr?
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models


From @ndrebo|erb@rro@ @end|ng |rom gm@||@com  Fri Feb  3 15:06:15 2023
From: @ndrebo|erb@rro@ @end|ng |rom gm@||@com (=?UTF-8?Q?Andr=C3=A9_Boler_Barros?=)
Date: Fri, 3 Feb 2023 14:06:15 +0000
Subject: [R-sig-ME] glmmTMB ziformula accepts random effects
In-Reply-To: <CAFMs1J68rsNKqyOq1mnN_Qy51hiP9QEecuWOLX8Lhq=q2mFp5Q@mail.gmail.com>
References: <CAFMs1J68rsNKqyOq1mnN_Qy51hiP9QEecuWOLX8Lhq=q2mFp5Q@mail.gmail.com>
Message-ID: <CAFMs1J7sqvZYQ=jq1v+jst6qzfQ4wL2Dq4UJTAyt4n6HFRZAdQ@mail.gmail.com>

Hi everyone,

Does anyone knows if, for a zero-inflated negative binomial model with
random effects, the glmmTMB function accepts random effects in the
ziformula?

Thanks in advance,

Andr?

	[[alternative HTML version deleted]]


From jorgemmtte|xe|r@ @end|ng |rom gm@||@com  Sat Feb  4 13:35:41 2023
From: jorgemmtte|xe|r@ @end|ng |rom gm@||@com (Jorge Teixeira)
Date: Sat, 4 Feb 2023 12:35:41 +0000
Subject: [R-sig-ME] Question about random-effects
Message-ID: <CAOYO_yA0_ywgb2NvB5TSDJwaPXLujqX0H2BY0Y6tdQXNC-rBSQ@mail.gmail.com>

Hi everyone.

Context: Two groups (A and B) performed 30 treatment sessions. Each session
has 4 periods.

However, the wo groups did the intervention 6-months apart, with no overlap.

The model fit of both models is equal, but theoretically, one should make
more sense.

Q1: Is m2 or m22 that captures this the best?

Q2: the fact that I have fixed effect for group makes the previous question
irrelevant somehow?

Thanks!


m2 <- lmer(dp ~ session + period + group + (1 | id) + (1 | date /  session
/  period), data = dat_long )

summary(m22)

m22 <- lmer(dp ~ session + period + group + (1 | id) + (1 | session / date
/ period), data = dat_long )

summary(m22)

	[[alternative HTML version deleted]]


From th|erry@onke||nx @end|ng |rom |nbo@be  Mon Feb  6 21:07:41 2023
From: th|erry@onke||nx @end|ng |rom |nbo@be (Thierry Onkelinx)
Date: Mon, 6 Feb 2023 21:07:41 +0100
Subject: [R-sig-ME] Question about random-effects
In-Reply-To: <CAOYO_yA0_ywgb2NvB5TSDJwaPXLujqX0H2BY0Y6tdQXNC-rBSQ@mail.gmail.com>
References: <CAOYO_yA0_ywgb2NvB5TSDJwaPXLujqX0H2BY0Y6tdQXNC-rBSQ@mail.gmail.com>
Message-ID: <CAJuCY5ztpwP8Ry9VMKFdNmD-H5NTxvt02-ckg=GrtjPa+dmYtg@mail.gmail.com>

Dear Jorge,

It is more clear when you write the nested random effects explicitly
instead of the shorthand.

m2 has (1 | date) + (1 | date:session) + (1 | date:session:periode)
m22 has (1 | session) + (1 | date:session) + (1 | date:session:periode)

Both models have the same fit but a different parameterization.

See my blog post on this topic
https://www.muscardinus.be/2017/07/lme4-random-effects/

Best regards,

ir. Thierry Onkelinx
Statisticus / Statistician

Vlaamse Overheid / Government of Flanders
INSTITUUT VOOR NATUUR- EN BOSONDERZOEK / RESEARCH INSTITUTE FOR NATURE AND
FOREST
Team Biometrie & Kwaliteitszorg / Team Biometrics & Quality Assurance
thierry.onkelinx at inbo.be
Havenlaan 88 bus 73, 1000 Brussel
www.inbo.be

///////////////////////////////////////////////////////////////////////////////////////////
To call in the statistician after the experiment is done may be no more
than asking him to perform a post-mortem examination: he may be able to say
what the experiment died of. ~ Sir Ronald Aylmer Fisher
The plural of anecdote is not data. ~ Roger Brinner
The combination of some data and an aching desire for an answer does not
ensure that a reasonable answer can be extracted from a given body of data.
~ John Tukey
///////////////////////////////////////////////////////////////////////////////////////////

<https://www.inbo.be>


Op za 4 feb. 2023 om 13:36 schreef Jorge Teixeira <
jorgemmtteixeira at gmail.com>:

> Hi everyone.
>
> Context: Two groups (A and B) performed 30 treatment sessions. Each session
> has 4 periods.
>
> However, the wo groups did the intervention 6-months apart, with no
> overlap.
>
> The model fit of both models is equal, but theoretically, one should make
> more sense.
>
> Q1: Is m2 or m22 that captures this the best?
>
> Q2: the fact that I have fixed effect for group makes the previous question
> irrelevant somehow?
>
> Thanks!
>
>
> m2 <- lmer(dp ~ session + period + group + (1 | id) + (1 | date /  session
> /  period), data = dat_long )
>
> summary(m22)
>
> m22 <- lmer(dp ~ session + period + group + (1 | id) + (1 | session / date
> / period), data = dat_long )
>
> summary(m22)
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>

	[[alternative HTML version deleted]]


From jorgemmtte|xe|r@ @end|ng |rom gm@||@com  Tue Feb  7 22:03:40 2023
From: jorgemmtte|xe|r@ @end|ng |rom gm@||@com (Jorge Teixeira)
Date: Tue, 7 Feb 2023 21:03:40 +0000
Subject: [R-sig-ME] Question about random-effects
In-Reply-To: <CAJuCY5ztpwP8Ry9VMKFdNmD-H5NTxvt02-ckg=GrtjPa+dmYtg@mail.gmail.com>
References: <CAOYO_yA0_ywgb2NvB5TSDJwaPXLujqX0H2BY0Y6tdQXNC-rBSQ@mail.gmail.com>
 <CAJuCY5ztpwP8Ry9VMKFdNmD-H5NTxvt02-ckg=GrtjPa+dmYtg@mail.gmail.com>
Message-ID: <CAOYO_yDuDd0mk+42MM72eY+9FSQQnUk4H0zcTE8tHFJBeba5FA@mail.gmail.com>

Dear Thierry Onkelin, thanks for the reply.

Do you have an opinion about which model best represents the context I have
described? That's my main doubt.

Thank you.

Thierry Onkelinx <thierry.onkelinx at inbo.be> escreveu no dia segunda,
6/02/2023 ?(s) 20:07:

> Dear Jorge,
>
> It is more clear when you write the nested random effects explicitly
> instead of the shorthand.
>
> m2 has (1 | date) + (1 | date:session) + (1 | date:session:periode)
> m22 has (1 | session) + (1 | date:session) + (1 | date:session:periode)
>
> Both models have the same fit but a different parameterization.
>
> See my blog post on this topic
> https://www.muscardinus.be/2017/07/lme4-random-effects/
>
> Best regards,
>
> ir. Thierry Onkelinx
> Statisticus / Statistician
>
> Vlaamse Overheid / Government of Flanders
> INSTITUUT VOOR NATUUR- EN BOSONDERZOEK / RESEARCH INSTITUTE FOR NATURE AND
> FOREST
> Team Biometrie & Kwaliteitszorg / Team Biometrics & Quality Assurance
> thierry.onkelinx at inbo.be
> Havenlaan 88 bus 73, 1000 Brussel
> www.inbo.be
>
>
> ///////////////////////////////////////////////////////////////////////////////////////////
> To call in the statistician after the experiment is done may be no more
> than asking him to perform a post-mortem examination: he may be able to say
> what the experiment died of. ~ Sir Ronald Aylmer Fisher
> The plural of anecdote is not data. ~ Roger Brinner
> The combination of some data and an aching desire for an answer does not
> ensure that a reasonable answer can be extracted from a given body of data.
> ~ John Tukey
>
> ///////////////////////////////////////////////////////////////////////////////////////////
>
> <https://www.inbo.be>
>
>
> Op za 4 feb. 2023 om 13:36 schreef Jorge Teixeira <
> jorgemmtteixeira at gmail.com>:
>
>> Hi everyone.
>>
>> Context: Two groups (A and B) performed 30 treatment sessions. Each
>> session
>> has 4 periods.
>>
>> However, the wo groups did the intervention 6-months apart, with no
>> overlap.
>>
>> The model fit of both models is equal, but theoretically, one should make
>> more sense.
>>
>> Q1: Is m2 or m22 that captures this the best?
>>
>> Q2: the fact that I have fixed effect for group makes the previous
>> question
>> irrelevant somehow?
>>
>> Thanks!
>>
>>
>> m2 <- lmer(dp ~ session + period + group + (1 | id) + (1 | date /  session
>> /  period), data = dat_long )
>>
>> summary(m22)
>>
>> m22 <- lmer(dp ~ session + period + group + (1 | id) + (1 | session / date
>> / period), data = dat_long )
>>
>> summary(m22)
>>
>>         [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-mixed-models at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>
>

	[[alternative HTML version deleted]]


From th|erry@onke||nx @end|ng |rom |nbo@be  Wed Feb  8 08:50:43 2023
From: th|erry@onke||nx @end|ng |rom |nbo@be (Thierry Onkelinx)
Date: Wed, 8 Feb 2023 08:50:43 +0100
Subject: [R-sig-ME] Question about random-effects
In-Reply-To: <CAOYO_yDuDd0mk+42MM72eY+9FSQQnUk4H0zcTE8tHFJBeba5FA@mail.gmail.com>
References: <CAOYO_yA0_ywgb2NvB5TSDJwaPXLujqX0H2BY0Y6tdQXNC-rBSQ@mail.gmail.com>
 <CAJuCY5ztpwP8Ry9VMKFdNmD-H5NTxvt02-ckg=GrtjPa+dmYtg@mail.gmail.com>
 <CAOYO_yDuDd0mk+42MM72eY+9FSQQnUk4H0zcTE8tHFJBeba5FA@mail.gmail.com>
Message-ID: <CAJuCY5z6_nvUEc08213QczoZhRuqXD378NQNMM2=92ipfjRR+Q@mail.gmail.com>

Dear Jorge,

It is hard to give good advice without thorough insight in your case. I
recommend you consult a local statistician.

Best regards,

ir. Thierry Onkelinx
Statisticus / Statistician

Vlaamse Overheid / Government of Flanders
INSTITUUT VOOR NATUUR- EN BOSONDERZOEK / RESEARCH INSTITUTE FOR NATURE AND
FOREST
Team Biometrie & Kwaliteitszorg / Team Biometrics & Quality Assurance
thierry.onkelinx at inbo.be
Havenlaan 88 bus 73, 1000 Brussel
www.inbo.be

///////////////////////////////////////////////////////////////////////////////////////////
To call in the statistician after the experiment is done may be no more
than asking him to perform a post-mortem examination: he may be able to say
what the experiment died of. ~ Sir Ronald Aylmer Fisher
The plural of anecdote is not data. ~ Roger Brinner
The combination of some data and an aching desire for an answer does not
ensure that a reasonable answer can be extracted from a given body of data.
~ John Tukey
///////////////////////////////////////////////////////////////////////////////////////////

<https://www.inbo.be>


Op di 7 feb. 2023 om 22:04 schreef Jorge Teixeira <
jorgemmtteixeira at gmail.com>:

> Dear Thierry Onkelin, thanks for the reply.
>
> Do you have an opinion about which model best represents the context I
> have described? That's my main doubt.
>
> Thank you.
>
> Thierry Onkelinx <thierry.onkelinx at inbo.be> escreveu no dia segunda,
> 6/02/2023 ?(s) 20:07:
>
>> Dear Jorge,
>>
>> It is more clear when you write the nested random effects explicitly
>> instead of the shorthand.
>>
>> m2 has (1 | date) + (1 | date:session) + (1 | date:session:periode)
>> m22 has (1 | session) + (1 | date:session) + (1 | date:session:periode)
>>
>> Both models have the same fit but a different parameterization.
>>
>> See my blog post on this topic
>> https://www.muscardinus.be/2017/07/lme4-random-effects/
>>
>> Best regards,
>>
>> ir. Thierry Onkelinx
>> Statisticus / Statistician
>>
>> Vlaamse Overheid / Government of Flanders
>> INSTITUUT VOOR NATUUR- EN BOSONDERZOEK / RESEARCH INSTITUTE FOR NATURE
>> AND FOREST
>> Team Biometrie & Kwaliteitszorg / Team Biometrics & Quality Assurance
>> thierry.onkelinx at inbo.be
>> Havenlaan 88 bus 73, 1000 Brussel
>> www.inbo.be
>>
>>
>> ///////////////////////////////////////////////////////////////////////////////////////////
>> To call in the statistician after the experiment is done may be no more
>> than asking him to perform a post-mortem examination: he may be able to say
>> what the experiment died of. ~ Sir Ronald Aylmer Fisher
>> The plural of anecdote is not data. ~ Roger Brinner
>> The combination of some data and an aching desire for an answer does not
>> ensure that a reasonable answer can be extracted from a given body of data.
>> ~ John Tukey
>>
>> ///////////////////////////////////////////////////////////////////////////////////////////
>>
>> <https://www.inbo.be>
>>
>>
>> Op za 4 feb. 2023 om 13:36 schreef Jorge Teixeira <
>> jorgemmtteixeira at gmail.com>:
>>
>>> Hi everyone.
>>>
>>> Context: Two groups (A and B) performed 30 treatment sessions. Each
>>> session
>>> has 4 periods.
>>>
>>> However, the wo groups did the intervention 6-months apart, with no
>>> overlap.
>>>
>>> The model fit of both models is equal, but theoretically, one should make
>>> more sense.
>>>
>>> Q1: Is m2 or m22 that captures this the best?
>>>
>>> Q2: the fact that I have fixed effect for group makes the previous
>>> question
>>> irrelevant somehow?
>>>
>>> Thanks!
>>>
>>>
>>> m2 <- lmer(dp ~ session + period + group + (1 | id) + (1 | date /
>>> session
>>> /  period), data = dat_long )
>>>
>>> summary(m22)
>>>
>>> m22 <- lmer(dp ~ session + period + group + (1 | id) + (1 | session /
>>> date
>>> / period), data = dat_long )
>>>
>>> summary(m22)
>>>
>>>         [[alternative HTML version deleted]]
>>>
>>> _______________________________________________
>>> R-sig-mixed-models at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>
>>

	[[alternative HTML version deleted]]


From cort|n@c @end|ng |rom ||ve@unc@edu  Wed Mar  1 16:44:06 2023
From: cort|n@c @end|ng |rom ||ve@unc@edu (Cortina, Christopher Anibal)
Date: Wed, 1 Mar 2023 15:44:06 +0000
Subject: [R-sig-ME] Piecewise linear regression with lmer
Message-ID: <BN7PR03MB393788E6C42DC387EDF71FF6EFAD9@BN7PR03MB3937.namprd03.prod.outlook.com>

Hello!

I am working on a project and am looking for a way to run piecewise linear regression with lmer that will give me interpretable parameters for each piece. What is the best way to do this?

Thank you!

Christopher Cortina
MS Biostatistics c/o 2023
Gillings School of Global Public Health
The University of North Carolina at Chapel Hill
Pronouns: he/him/his
cortinac at live.unc.edu


	[[alternative HTML version deleted]]


From jh@|t|g@ @end|ng |rom gm@||@com  Thu Mar  2 02:48:56 2023
From: jh@|t|g@ @end|ng |rom gm@||@com (J.D. Haltigan)
Date: Wed, 1 Mar 2023 20:48:56 -0500
Subject: [R-sig-ME] HGLM object parameters
Message-ID: <CAH_7VOmeC3ihoqQjRb-U2QTHy6NLJbGsWfyfCAGZtFBfnYQ2Kw@mail.gmail.com>

Sent this request for information to the listed maintainer of the package,
but have not heard back and was wondering if anyone else might be able to
confirm:

In the returned class object of HGLM, is the pr > t value stored anywhere
in the fixed effect list of values? I don't see it, but perhaps I am
missing its location elsewhere in the returned object.

Thanks in advance for any insight.

	[[alternative HTML version deleted]]


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Thu Mar  2 02:58:51 2023
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Wed, 01 Mar 2023 17:58:51 -0800
Subject: [R-sig-ME] HGLM object parameters
In-Reply-To: <CAH_7VOmeC3ihoqQjRb-U2QTHy6NLJbGsWfyfCAGZtFBfnYQ2Kw@mail.gmail.com>
References: <CAH_7VOmeC3ihoqQjRb-U2QTHy6NLJbGsWfyfCAGZtFBfnYQ2Kw@mail.gmail.com>
Message-ID: <DA611FDB-C108-47EE-9EF2-CC839FC9CC6A@dcn.davis.ca.us>

No idea in this specific case, but normally such information is stored in the object you get back from the summary function when you give it the HGLM model object. Look at ?summary.HGLM.

On March 1, 2023 5:48:56 PM PST, "J.D. Haltigan" <jhaltiga at gmail.com> wrote:
>Sent this request for information to the listed maintainer of the package,
>but have not heard back and was wondering if anyone else might be able to
>confirm:
>
>In the returned class object of HGLM, is the pr > t value stored anywhere
>in the fixed effect list of values? I don't see it, but perhaps I am
>missing its location elsewhere in the returned object.
>
>Thanks in advance for any insight.
>
>	[[alternative HTML version deleted]]
>
>_______________________________________________
>R-sig-mixed-models at r-project.org mailing list
>https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models

-- 
Sent from my phone. Please excuse my brevity.


From bbo|ker @end|ng |rom gm@||@com  Thu Mar  2 03:01:54 2023
From: bbo|ker @end|ng |rom gm@||@com (Ben Bolker)
Date: Wed, 1 Mar 2023 21:01:54 -0500
Subject: [R-sig-ME] HGLM object parameters
In-Reply-To: <DA611FDB-C108-47EE-9EF2-CC839FC9CC6A@dcn.davis.ca.us>
References: <CAH_7VOmeC3ihoqQjRb-U2QTHy6NLJbGsWfyfCAGZtFBfnYQ2Kw@mail.gmail.com>
 <DA611FDB-C108-47EE-9EF2-CC839FC9CC6A@dcn.davis.ca.us>
Message-ID: <474c6350-3248-c6a4-5c30-76dff288ba8f@gmail.com>

 ?? If this is hglm::hglm(), then Jeff is right.? From the examples:


library(hglm)

data(semiconductor)
m11 <- hglm(fixed = y ~ x1 + x3 + x5 + x6,
 ???????????????? random = ~ 1|Device,
 ???????????????? family = Gamma(link = log),
 ???????????????? disp = ~ x2 + x3, data = semiconductor)

s <- summary(m11)

s$FixCoefMat
 ????????????? Estimate Std. Error??? t-value???? Pr(>|t|)
(Intercept) -4.7116845 0.06695731 -70.368491 3.009494e-53
x1?????????? 0.2097871 0.06638132?? 3.160333 2.627136e-03
x3?????????? 0.3289347 0.06695731?? 4.912604 9.343313e-06
x5????????? -0.1731428 0.06638132? -2.608306 1.185092e-02
x6????????? -0.3569009 0.06633464? -5.380311 1.796667e-06

 ? If this is a different HGLM package you'll have to specify ...

On 2023-03-01 8:58 p.m., Jeff Newmiller wrote:
> No idea in this specific case, but normally such information is stored in the object you get back from the summary function when you give it the HGLM model object. Look at ?summary.HGLM.
>
> On March 1, 2023 5:48:56 PM PST, "J.D. Haltigan" <jhaltiga at gmail.com> wrote:
>> Sent this request for information to the listed maintainer of the package,
>> but have not heard back and was wondering if anyone else might be able to
>> confirm:
>>
>> In the returned class object of HGLM, is the pr > t value stored anywhere
>> in the fixed effect list of values? I don't see it, but perhaps I am
>> missing its location elsewhere in the returned object.
>>
>> Thanks in advance for any insight.
>>
>> 	[[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-mixed-models at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models


From jh@|t|g@ @end|ng |rom gm@||@com  Thu Mar  2 03:20:25 2023
From: jh@|t|g@ @end|ng |rom gm@||@com (J.D. Haltigan)
Date: Wed, 1 Mar 2023 21:20:25 -0500
Subject: [R-sig-ME] HGLM object parameters
In-Reply-To: <474c6350-3248-c6a4-5c30-76dff288ba8f@gmail.com>
References: <CAH_7VOmeC3ihoqQjRb-U2QTHy6NLJbGsWfyfCAGZtFBfnYQ2Kw@mail.gmail.com>
 <DA611FDB-C108-47EE-9EF2-CC839FC9CC6A@dcn.davis.ca.us>
 <474c6350-3248-c6a4-5c30-76dff288ba8f@gmail.com>
Message-ID: <CAH_7VOkzNK=s_UOgRM7n48BofZ+ocq+NifxZXfV=sLZpO4KyBg@mail.gmail.com>

So in this case, if I want to extract the p > t value from the returned
object, I would need to create a separate object that pulls the summary
list from the object? I usually just run the code for summary to inspect
the values in the data editor, rather than using it to create a 2nd'ary
object.

When I inspect the object manually from within R, for the fixef list, there
are only the intercept + B estimates that I see. What I am doing is
creating a custom function where I need to pull that value for another
dataframe, so it was not immediately clear to me if I could pull that value
directly from the returned object which doesn't seem to include it.

On Wed, Mar 1, 2023 at 9:09?PM Ben Bolker <bbolker at gmail.com> wrote:

>     If this is hglm::hglm(), then Jeff is right.  From the examples:
>
>
> library(hglm)
>
> data(semiconductor)
> m11 <- hglm(fixed = y ~ x1 + x3 + x5 + x6,
>                   random = ~ 1|Device,
>                   family = Gamma(link = log),
>                   disp = ~ x2 + x3, data = semiconductor)
>
> s <- summary(m11)
>
> s$FixCoefMat
>                Estimate Std. Error    t-value     Pr(>|t|)
> (Intercept) -4.7116845 0.06695731 -70.368491 3.009494e-53
> x1           0.2097871 0.06638132   3.160333 2.627136e-03
> x3           0.3289347 0.06695731   4.912604 9.343313e-06
> x5          -0.1731428 0.06638132  -2.608306 1.185092e-02
> x6          -0.3569009 0.06633464  -5.380311 1.796667e-06
>
>    If this is a different HGLM package you'll have to specify ...
>
> On 2023-03-01 8:58 p.m., Jeff Newmiller wrote:
> > No idea in this specific case, but normally such information is stored
> in the object you get back from the summary function when you give it the
> HGLM model object. Look at ?summary.HGLM.
> >
> > On March 1, 2023 5:48:56 PM PST, "J.D. Haltigan" <jhaltiga at gmail.com>
> wrote:
> >> Sent this request for information to the listed maintainer of the
> package,
> >> but have not heard back and was wondering if anyone else might be able
> to
> >> confirm:
> >>
> >> In the returned class object of HGLM, is the pr > t value stored
> anywhere
> >> in the fixed effect list of values? I don't see it, but perhaps I am
> >> missing its location elsewhere in the returned object.
> >>
> >> Thanks in advance for any insight.
> >>
> >>      [[alternative HTML version deleted]]
> >>
> >> _______________________________________________
> >> R-sig-mixed-models at r-project.org mailing list
> >> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>

	[[alternative HTML version deleted]]


From bbo|ker @end|ng |rom gm@||@com  Thu Mar  2 03:28:35 2023
From: bbo|ker @end|ng |rom gm@||@com (Ben Bolker)
Date: Wed, 1 Mar 2023 21:28:35 -0500
Subject: [R-sig-ME] HGLM object parameters
In-Reply-To: <CAH_7VOkzNK=s_UOgRM7n48BofZ+ocq+NifxZXfV=sLZpO4KyBg@mail.gmail.com>
References: <CAH_7VOmeC3ihoqQjRb-U2QTHy6NLJbGsWfyfCAGZtFBfnYQ2Kw@mail.gmail.com>
 <DA611FDB-C108-47EE-9EF2-CC839FC9CC6A@dcn.davis.ca.us>
 <474c6350-3248-c6a4-5c30-76dff288ba8f@gmail.com>
 <CAH_7VOkzNK=s_UOgRM7n48BofZ+ocq+NifxZXfV=sLZpO4KyBg@mail.gmail.com>
Message-ID: <cf2d5022-d13e-f8c3-1d53-642cf2742e40@gmail.com>


On 2023-03-01 9:20 p.m., J.D. Haltigan wrote:
> So in this case, if I want to extract the p > t value from the 
> returned object, I would need to create a separate object that pulls 
> the summary list from the object? I usually just run the code for 
> summary to inspect the values in the data editor, rather than using it 
> to create a 2nd'ary object.


 ? You don't have to save the summary object, you can construct it and 
extract what you need on the fly. Continuing the example:


 ? get_p_values <- function(m) {

 ??? summary(m)$FixCoefMat[,"Pr(>|t|)"]

}


get_p_values(m11)

 ?(Intercept)?????????? x1?????????? x3?????????? x5?????????? x6
3.009494e-53 2.627136e-03 9.343313e-06 1.185092e-02 1.796667e-06

>
> When I inspect the object manually from within R, for the fixef list, 
> there are only the intercept + B estimates that I see. What I am doing 
> is creating a custom function where I need to pull that value for 
> another dataframe, so it was not immediately clear to me if I could 
> pull that value directly from the returned object which doesn't seem 
> to include it.
>
> On Wed, Mar 1, 2023 at 9:09?PM Ben Bolker <bbolker at gmail.com> wrote:
>
>     If this is hglm::hglm(), then Jeff is right.? From the examples:
>
>
>     library(hglm)
>
>     data(semiconductor)
>     m11 <- hglm(fixed = y ~ x1 + x3 + x5 + x6,
>     ????????????????? random = ~ 1|Device,
>     ????????????????? family = Gamma(link = log),
>     ????????????????? disp = ~ x2 + x3, data = semiconductor)
>
>     s <- summary(m11)
>
>     s$FixCoefMat
>     ?????????????? Estimate Std. Error??? t-value???? Pr(>|t|)
>     (Intercept) -4.7116845 0.06695731 -70.368491 3.009494e-53
>     x1?????????? 0.2097871 0.06638132?? 3.160333 2.627136e-03
>     x3?????????? 0.3289347 0.06695731?? 4.912604 9.343313e-06
>     x5????????? -0.1731428 0.06638132? -2.608306 1.185092e-02
>     x6????????? -0.3569009 0.06633464? -5.380311 1.796667e-06
>
>     ?? If this is a different HGLM package you'll have to specify ...
>
>     On 2023-03-01 8:58 p.m., Jeff Newmiller wrote:
>     > No idea in this specific case, but normally such information is
>     stored in the object you get back from the summary function when
>     you give it the HGLM model object. Look at ?summary.HGLM.
>     >
>     > On March 1, 2023 5:48:56 PM PST, "J.D. Haltigan"
>     <jhaltiga at gmail.com> wrote:
>     >> Sent this request for information to the listed maintainer of
>     the package,
>     >> but have not heard back and was wondering if anyone else might
>     be able to
>     >> confirm:
>     >>
>     >> In the returned class object of HGLM, is the pr > t value
>     stored anywhere
>     >> in the fixed effect list of values? I don't see it, but perhaps
>     I am
>     >> missing its location elsewhere in the returned object.
>     >>
>     >> Thanks in advance for any insight.
>     >>
>     >>? ? ? [[alternative HTML version deleted]]
>     >>
>     >> _______________________________________________
>     >> R-sig-mixed-models at r-project.org mailing list
>     >> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>
>     _______________________________________________
>     R-sig-mixed-models at r-project.org mailing list
>     https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>


From m@r||en@@bougou||@ @end|ng |rom ru@n|  Thu Mar  2 14:25:08 2023
From: m@r||en@@bougou||@ @end|ng |rom ru@n| (Bougoulia, M. (Marilena))
Date: Thu, 2 Mar 2023 13:25:08 +0000
Subject: [R-sig-ME] Send R-sig-mixed-models mailing list submissions
Message-ID: <PAVPR10MB71887189347F2847654B5BC58FB29@PAVPR10MB7188.EURPRD10.PROD.OUTLOOK.COM>

Send R-sig-mixed-models mailing list submissions.

	[[alternative HTML version deleted]]


From j|@ver|@@|mo @end|ng |rom gm@||@com  Fri Mar  3 19:41:15 2023
From: j|@ver|@@|mo @end|ng |rom gm@||@com (=?UTF-8?Q?Jo=c3=a3o_Ver=c3=adssimo?=)
Date: Fri, 3 Mar 2023 18:41:15 +0000
Subject: [R-sig-ME] Piecewise linear regression with lmer
In-Reply-To: <BN7PR03MB393788E6C42DC387EDF71FF6EFAD9@BN7PR03MB3937.namprd03.prod.outlook.com>
References: <BN7PR03MB393788E6C42DC387EDF71FF6EFAD9@BN7PR03MB3937.namprd03.prod.outlook.com>
Message-ID: <a7c99bfe-f49c-0d0d-b54e-207b17eee992@gmail.com>

Hi Christopher,

I think you'd do this in lmer in the same way as for any 
(non-mixed-effects) regression, with the only caveat being that you may 
want/need to include the relevant predictors as random slopes.

You'd start by determining a breakpoint, centering your variable of 
interest around it, and creating an indicator variable:

df$Shitfed.V1 <- df$V1 - breakpoint????????????????????????? # 'Shift' 
variable (i.e., center around the breakpoint)
df$post.breakpoint <- as.factor(df$Shitfed.V1 > 0)? # Create indicator 
variable (as factor)

Then the following lmer model formula would yield estimates for: (a) the 
'left' slope, i.e., for V1 smaller than the breakpoint; and (b) the 
difference between slopes:

DV ~ 1 +? Shitfed.V1 + Shitfed.V1:post.breakpoint + (1 + Shitfed.V1 + 
Shitfed.V1:post.breakpoint | RandomFactor)

Alternatively, this lmer formula would yield estimates for: (a) the 
'left' slope, i.e., for V1 smaller than the breakpoint; (b) the 'right' 
slope, i.e., for V1 larger than the breakpoint:

DV ~ 1 +? Shitfed.V1:post.breakpoint + (1 + Shitfed.V1:post.breakpoint | 
RandomFactor)


Jo?o


On 01/03/2023 15:44, Cortina, Christopher Anibal wrote:
> Hello!
>
> I am working on a project and am looking for a way to run piecewise linear regression with lmer that will give me interpretable parameters for each piece. What is the best way to do this?
>
> Thank you!
>
> Christopher Cortina
> MS Biostatistics c/o 2023
> Gillings School of Global Public Health
> The University of North Carolina at Chapel Hill
> Pronouns: he/him/his
> cortinac at live.unc.edu
>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models


From gkotech@ @end|ng |rom g@h@rv@rd@edu  Sat Mar  4 21:40:01 2023
From: gkotech@ @end|ng |rom g@h@rv@rd@edu (Kotecha, Gopal)
Date: Sat, 4 Mar 2023 15:40:01 -0500
Subject: [R-sig-ME] How does blme carry out estimation and inference.
Message-ID: <716db422-d5c6-84dd-9e0e-b1510de4fddc@g.harvard.edu>

Dear all,

I have two questions about blme.? Apologies if any of this has been 
asked before.

1. How does estimation occur?
2. How does inference occur for fixed effects parameters? Specifically 
when you use the ?summary? method on a bglmer object, how are standard 
errors estimated?

I have written up some more details below, and also pasted a LaTeX image 
here for easier reading:? https://imgur.com/a/syL1LWx

I am using the default settings and the following logistic model:

P(Y_{ij}=1|\beta, X_{ij},T_{ij},\theta_j) = F(X^T_{ij}? \beta + \theta_j)
individuals i, groups j, where scalar \theta_j is distributed 
Normal(0,\sigma_\theta), outcome Y_{ij} is binary, X_{ij} is a vector of 
binary covariates with corresponding fixed effect parameter vector \beta.
F(t) =(1+\exp(-t))^{-1}.

My understanding is the following:

 ?- BLME uses a penalized log likelihood approach, letting us place a 
prior on $\sigma_\theta$ to stabilize the inference and prevent zero 
values.? We can also place a prior on $\beta$

- Inference is first carried out on the marginal log posterior density
l(\sigma_\theta|Y_{ij}) where \beta and \theta_j are both integrated out 
to find the MAP estimate \hat\sigma_\theta.? This is then substituted 
into the original likelihood l(\hat\sigma_\theta,\theta|Y_{ij}) which is 
maximized to get \hat\beta. This is as far as I can tell from Chung 
et.a. 2013.? Is this correct?

- How does blme estimate the standard errors of fixed effect estimates 
\hat\beta (i.e. what does summary on a model object produce)?? I can't 
find anything relating to this in the documentation.? Am I correct in 
thinking the marginal likelihood with the MAP estimate of 
\hat\sigma_\theta plugged in is profiled (i.e. a profile likelihood 
approach on l(\theta,\hat\sigma_\theta|Y_{ij}))?

Any pointers, tips or references I have missed would be super useful!

Thanks in advance!
Gopal

Refs:

Chung, Yeojin, et al. "A nondegenerate penalized likelihood estimator 
for variance parameters in multilevel models." Psychometrika 78 (2013): 
685-709.
Bates, D., M?chler, M., Bolker, B., $\&$ Walker, S. (2015). Fitting 
Linear Mixed-Effects Models Using lme4. Journal of Statistical Software, 
67(1), 1?48. https://doi.org/10.18637/jss.v067.i01


From vdor|e @end|ng |rom gm@||@com  Sat Mar  4 22:14:57 2023
From: vdor|e @end|ng |rom gm@||@com (Vincent Dorie)
Date: Sat, 4 Mar 2023 16:14:57 -0500
Subject: [R-sig-ME] How does blme carry out estimation and inference.
In-Reply-To: <716db422-d5c6-84dd-9e0e-b1510de4fddc@g.harvard.edu>
References: <716db422-d5c6-84dd-9e0e-b1510de4fddc@g.harvard.edu>
Message-ID: <CA+++UwS_Ptu+ga9QuvCKvNgAk732_xjadoN+MKnJVKpadVimyA@mail.gmail.com>

Hi Gopal,

I apologize if I'm a little too informal in my answers - it's been a long
time since I've thought about these things.

1. For generalized linear models, beta isn't integrated out. The objective
function is a numerical approximation to the marginal likelihood - i.e.
with theta integrated - and is a function of sigma_theta and beta.
Estimation is accomplished by taking that objective function on the log
scale (deviance, actually) and adding to it the prior contribution.
2. It's not, not really. summary for glmms will return a normal
approximation based on the Hessian of the objective at its extremum, which
after fitting will include the prior's contribution. It's correct-ish*,
however people who are interested in posterior intervals are encouraged to
refit their model in a full Bayesian setting. blme was designed to rapidly
prototype parametric models and sits between lme4 and full Bayes - it can
avoid the boundary problem but is relatively fast.

Best,
Vince

*With a large sample size, the contribution of the prior vanishes and the
asymptotics hold. However, with a large sample size the boundary problem
should also go away. So for when blme might be useful in penalizing the
covariance of the random effects, there's pretty good reason to doubt the
uncertainty estimates are accurate. Technically one might be able to split
the difference by analyzing how much information the covariance parameters
contain about the fixed effects, but I've never looked into that myself.
However, if you just want to incorporate prior information on the fixed
effects or fix the residual standard deviation, the results should be
correct.

On Sat, Mar 4, 2023 at 3:40?PM Kotecha, Gopal <gkotecha at g.harvard.edu>
wrote:

> Dear all,
>
> I have two questions about blme.  Apologies if any of this has been
> asked before.
>
> 1. How does estimation occur?
> 2. How does inference occur for fixed effects parameters? Specifically
> when you use the ?summary? method on a bglmer object, how are standard
> errors estimated?
>
> I have written up some more details below, and also pasted a LaTeX image
> here for easier reading:  https://imgur.com/a/syL1LWx
>
> I am using the default settings and the following logistic model:
>
> P(Y_{ij}=1|\beta, X_{ij},T_{ij},\theta_j) = F(X^T_{ij}  \beta + \theta_j)
> individuals i, groups j, where scalar \theta_j is distributed
> Normal(0,\sigma_\theta), outcome Y_{ij} is binary, X_{ij} is a vector of
> binary covariates with corresponding fixed effect parameter vector \beta.
> F(t) =(1+\exp(-t))^{-1}.
>
> My understanding is the following:
>
>   - BLME uses a penalized log likelihood approach, letting us place a
> prior on $\sigma_\theta$ to stabilize the inference and prevent zero
> values.  We can also place a prior on $\beta$
>
> - Inference is first carried out on the marginal log posterior density
> l(\sigma_\theta|Y_{ij}) where \beta and \theta_j are both integrated out
> to find the MAP estimate \hat\sigma_\theta.  This is then substituted
> into the original likelihood l(\hat\sigma_\theta,\theta|Y_{ij}) which is
> maximized to get \hat\beta. This is as far as I can tell from Chung
> et.a. 2013.  Is this correct?
>
> - How does blme estimate the standard errors of fixed effect estimates
> \hat\beta (i.e. what does summary on a model object produce)?  I can't
> find anything relating to this in the documentation.  Am I correct in
> thinking the marginal likelihood with the MAP estimate of
> \hat\sigma_\theta plugged in is profiled (i.e. a profile likelihood
> approach on l(\theta,\hat\sigma_\theta|Y_{ij}))?
>
> Any pointers, tips or references I have missed would be super useful!
>
> Thanks in advance!
> Gopal
>
> Refs:
>
> Chung, Yeojin, et al. "A nondegenerate penalized likelihood estimator
> for variance parameters in multilevel models." Psychometrika 78 (2013):
> 685-709.
> Bates, D., M?chler, M., Bolker, B., $\&$ Walker, S. (2015). Fitting
> Linear Mixed-Effects Models Using lme4. Journal of Statistical Software,
> 67(1), 1?48. https://doi.org/10.18637/jss.v067.i01
>
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>

	[[alternative HTML version deleted]]


From re@|erm @end|ng |rom @@eon@nr|@@c@z@  Tue Mar  7 15:08:38 2023
From: re@|erm @end|ng |rom @@eon@nr|@@c@z@ (Rion Lerm)
Date: Tue, 7 Mar 2023 16:08:38 +0200
Subject: [R-sig-ME] glmmTMB deviance enquiry
In-Reply-To: <CALFw9un6LDpPpeJQdOCEipj8qh6xdX0mXdnRuu_U3PgkqQBsWw@mail.gmail.com>
References: <CALFw9un6LDpPpeJQdOCEipj8qh6xdX0mXdnRuu_U3PgkqQBsWw@mail.gmail.com>
Message-ID: <CALFw9umX_c4Q2SO0VucPf8NVGz9pi4Yfhqdn=iAegmgpg5XOWg@mail.gmail.com>

I reported, in a paper, on the *Deviance* value for model fit as produced
by the *glmmTMB* function.

Please explain how this value is computed, and what are the pros/cons of
this compared to e.g., AIC. I need to comprehend its use and explain the
how and why? to a reviewer and possibly the paper's readers.

Regards and thanks in advance,

*Rion Lerm*

SAEON Ndlovu

C: 076 913 8381

W: 013 735 3536

SAEON / Scientific Services, Kruger National Park Gate, Phalaborwa, South
Africa

South African Environmental Observation Network

Website <https://ndlovu.saeon.ac.za/> & Location of our offices
<https://www.google.co.za/maps/place/SAEON+Ndlovu+Node/@-23.9447244,31.164957,18z/data=!4m5!3m4!1s0x1ec36ec96261cfb7:0xb89a27144ba0ca2a!8m2!3d-23.9450103!4d31.1652626>



My research profiles:
*ResearchGate* <https://www.researchgate.net/profile/Rion-Lerm>

*ORCID <https://orcid.org/0000-0002-9992-2093>*
*Google Scholar
<https://scholar.google.com/citations?user=JV5d7E4AAAAJ&hl=en>*

-- 
http://www.nrf.ac.za/email-legal-notice.php 
<http://www.nrf.ac.za/email-legal-notice.php>

	[[alternative HTML version deleted]]


From bbo|ker @end|ng |rom gm@||@com  Tue Mar  7 15:32:16 2023
From: bbo|ker @end|ng |rom gm@||@com (Ben Bolker)
Date: Tue, 7 Mar 2023 09:32:16 -0500
Subject: [R-sig-ME] glmmTMB deviance enquiry
In-Reply-To: <CALFw9umX_c4Q2SO0VucPf8NVGz9pi4Yfhqdn=iAegmgpg5XOWg@mail.gmail.com>
References: <CALFw9un6LDpPpeJQdOCEipj8qh6xdX0mXdnRuu_U3PgkqQBsWw@mail.gmail.com>
 <CALFw9umX_c4Q2SO0VucPf8NVGz9pi4Yfhqdn=iAegmgpg5XOWg@mail.gmail.com>
Message-ID: <1c42c523-7880-f8b8-3413-ec6738ac7fea@gmail.com>

    The deviance is twice the negative log-likelihood; if the deviance 
is D for a model with p parameters, then AIC = D + 2*p.  The deviance is 
an *unpenalized* measure of goodness of fit (badness of fit actually - 
lower deviance means better fit).

    There's no need to report deviance in a paper if it's not useful to 
you or your readers. The deviance for a model alone is not particularly 
useful; you can use the deviances for several nested models to compute 
likelihood ratio rests (via anova()), or you can use deviance as the 
basis for computing AIC or BIC.

   Hope that helps.

   Ben Bolker

On 2023-03-07 9:08 a.m., Rion Lerm via R-sig-mixed-models wrote:
> I reported, in a paper, on the *Deviance* value for model fit as produced
> by the *glmmTMB* function.
> 
> Please explain how this value is computed, and what are the pros/cons of
> this compared to e.g., AIC. I need to comprehend its use and explain the
> how and why? to a reviewer and possibly the paper's readers.
> 
> Regards and thanks in advance,
> 
> *Rion Lerm*
> 
> SAEON Ndlovu
> 
> C: 076 913 8381
> 
> W: 013 735 3536
> 
> SAEON / Scientific Services, Kruger National Park Gate, Phalaborwa, South
> Africa
> 
> South African Environmental Observation Network
> 
> Website <https://ndlovu.saeon.ac.za/> & Location of our offices
> <https://www.google.co.za/maps/place/SAEON+Ndlovu+Node/@-23.9447244,31.164957,18z/data=!4m5!3m4!1s0x1ec36ec96261cfb7:0xb89a27144ba0ca2a!8m2!3d-23.9450103!4d31.1652626>
> 
> 
> 
> My research profiles:
> *ResearchGate* <https://www.researchgate.net/profile/Rion-Lerm>
> 
> *ORCID <https://orcid.org/0000-0002-9992-2093>*
> *Google Scholar
> <https://scholar.google.com/citations?user=JV5d7E4AAAAJ&hl=en>*
> 

-- 
Dr. Benjamin Bolker
Professor, Mathematics & Statistics and Biology, McMaster University
Director, School of Computational Science and Engineering
(Acting) Graduate chair, Mathematics & Statistics
 > E-mail is sent at my convenience; I don't expect replies outside of 
working hours.


From re@|erm @end|ng |rom @@eon@nr|@@c@z@  Wed Mar  8 09:56:35 2023
From: re@|erm @end|ng |rom @@eon@nr|@@c@z@ (Rion Lerm)
Date: Wed, 8 Mar 2023 10:56:35 +0200
Subject: [R-sig-ME] glmmTMB deviance enquiry
In-Reply-To: <1c42c523-7880-f8b8-3413-ec6738ac7fea@gmail.com>
References: <CALFw9un6LDpPpeJQdOCEipj8qh6xdX0mXdnRuu_U3PgkqQBsWw@mail.gmail.com>
 <CALFw9umX_c4Q2SO0VucPf8NVGz9pi4Yfhqdn=iAegmgpg5XOWg@mail.gmail.com>
 <1c42c523-7880-f8b8-3413-ec6738ac7fea@gmail.com>
Message-ID: <CALFw9umCT8uk8ARCGB-YW3JZejZTACxXy1i3p6_6RpYFs49tiA@mail.gmail.com>

Thank you @bbolker at gmail.com <bbolker at gmail.com> for your elaborate
response.

I am using the Deviance values in this manner to compare model fit. Here, I
selected for the model with second to smallest Deviance values. May it be
presented like this as I feel it is important to display how a model was
selected from various models (the reason for selecting the second to
smallest values aren't explained here as is the details of this work):

*Model predictor fixed effects*

*SR.asymp*

*SES.FRic*

*SES.PD*



Deviance



Tree + Shrub + Grass + Bare ground + Infrastructure + Seasonal water +
Permanent water

760.4 | 1,463.6

172.1 | 319.6

206.7 | 420.7

Tree + Shrub + Bare ground + Infrastructure + Seasonal water + Permanent
water

*766.3 | 1467.7*

*179.0 | 325.2*

*207.3 | 421.3*

Tree + Shrub + Grass + Bare ground

777.1 | 1,520.3

179.4 | 368.7

229.3 | 441.5

Tree + Shrub + Grass + Bare ground + Infrastructure

776.8 | 1,484.3

179.0 | 323.0

217.2 | 424.2

Tree + Shrub + Grass + Bare ground + Seasonal water + Permanent water

760.5 | 1,498.4

172.3 | 363.2

216.8 | 439.9









Importantly, is there any literature I can cite on Deviance and its use? If
so, please supply a DOI.

Regards/Groete,

*Rion Lerm*

SAEON Ndlovu

C: 076 913 8381

W: 013 735 3536

SAEON / Scientific Services, Kruger National Park Gate, Phalaborwa, South
Africa

South African Environmental Observation Network

Website <https://ndlovu.saeon.ac.za/> & Location of our offices
<https://www.google.co.za/maps/place/SAEON+Ndlovu+Node/@-23.9447244,31.164957,18z/data=!4m5!3m4!1s0x1ec36ec96261cfb7:0xb89a27144ba0ca2a!8m2!3d-23.9450103!4d31.1652626>



My research profiles:
*ResearchGate* <https://www.researchgate.net/profile/Rion-Lerm>

*ORCID <https://orcid.org/0000-0002-9992-2093>*
*Google Scholar
<https://scholar.google.com/citations?user=JV5d7E4AAAAJ&hl=en>*


On Tue, 7 Mar 2023 at 16:32, Ben Bolker <bbolker at gmail.com> wrote:

>     The deviance is twice the negative log-likelihood; if the deviance
> is D for a model with p parameters, then AIC = D + 2*p.  The deviance is
> an *unpenalized* measure of goodness of fit (badness of fit actually -
> lower deviance means better fit).
>
>     There's no need to report deviance in a paper if it's not useful to
> you or your readers. The deviance for a model alone is not particularly
> useful; you can use the deviances for several nested models to compute
> likelihood ratio rests (via anova()), or you can use deviance as the
> basis for computing AIC or BIC.
>
>    Hope that helps.
>
>    Ben Bolker
>
> On 2023-03-07 9:08 a.m., Rion Lerm via R-sig-mixed-models wrote:
> > I reported, in a paper, on the *Deviance* value for model fit as produced
> > by the *glmmTMB* function.
> >
> > Please explain how this value is computed, and what are the pros/cons of
> > this compared to e.g., AIC. I need to comprehend its use and explain the
> > how and why? to a reviewer and possibly the paper's readers.
> >
> > Regards and thanks in advance,
> >
> > *Rion Lerm*
> >
> > SAEON Ndlovu
> >
> > C: 076 913 8381
> >
> > W: 013 735 3536
> >
> > SAEON / Scientific Services, Kruger National Park Gate, Phalaborwa, South
> > Africa
> >
> > South African Environmental Observation Network
> >
> > Website <https://ndlovu.saeon.ac.za/> & Location of our offices
> > <
> https://www.google.co.za/maps/place/SAEON+Ndlovu+Node/@-23.9447244,31.164957,18z/data=!4m5!3m4!1s0x1ec36ec96261cfb7:0xb89a27144ba0ca2a!8m2!3d-23.9450103!4d31.1652626
> >
> >
> >
> >
> > My research profiles:
> > *ResearchGate* <https://www.researchgate.net/profile/Rion-Lerm>
> >
> > *ORCID <https://orcid.org/0000-0002-9992-2093>*
> > *Google Scholar
> > <https://scholar.google.com/citations?user=JV5d7E4AAAAJ&hl=en>*
> >
>
> --
> Dr. Benjamin Bolker
> Professor, Mathematics & Statistics and Biology, McMaster University
> Director, School of Computational Science and Engineering
> (Acting) Graduate chair, Mathematics & Statistics
>  > E-mail is sent at my convenience; I don't expect replies outside of
> working hours.
>
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>

-- 
http://www.nrf.ac.za/email-legal-notice.php 
<http://www.nrf.ac.za/email-legal-notice.php>

	[[alternative HTML version deleted]]


From bbo|ker @end|ng |rom gm@||@com  Fri Mar 10 15:19:54 2023
From: bbo|ker @end|ng |rom gm@||@com (Ben Bolker)
Date: Fri, 10 Mar 2023 09:19:54 -0500
Subject: [R-sig-ME] glmmTMB deviance enquiry
In-Reply-To: <CALFw9umCT8uk8ARCGB-YW3JZejZTACxXy1i3p6_6RpYFs49tiA@mail.gmail.com>
References: <CALFw9un6LDpPpeJQdOCEipj8qh6xdX0mXdnRuu_U3PgkqQBsWw@mail.gmail.com>
 <CALFw9umX_c4Q2SO0VucPf8NVGz9pi4Yfhqdn=iAegmgpg5XOWg@mail.gmail.com>
 <1c42c523-7880-f8b8-3413-ec6738ac7fea@gmail.com>
 <CALFw9umCT8uk8ARCGB-YW3JZejZTACxXy1i3p6_6RpYFs49tiA@mail.gmail.com>
Message-ID: <2eeb2e65-156e-46fa-e270-3934b376765f@gmail.com>

   I'm afraid this might be getting into more generic statistical 
territory, rather than anything specific to mixed models.  If you're 
going to rank models without regard to nesting you should probably use 
AIC rather than deviance.  Alain Zuur (Highland Statistics) has a whole 
series of books on ecological statistics that cover this topic ... 
maybe Symonds et al would be useful?


Symonds, Matthew R. E., and Adnan Moussalli. 2011. ?A Brief Guide to 
Model Selection, Multimodel Inference and Model Averaging in Behavioural 
Ecology Using Akaike?s Information Criterion.? Behavioral Ecology and 
Sociobiology 65 (1): 13?21. https://doi.org/10.1007/s00265-010-1037-6.


On 2023-03-08 3:56 a.m., Rion Lerm wrote:
> Thank you @bbolker at gmail.com <mailto:bbolker at gmail.com>?for your 
> elaborate response.
> 
> I am using the Deviance values in this manner to compare model fit. 
> Here, I selected for the model with second to smallest Deviance values. 
> May it be presented like this as I feel it is important to display how a 
> model was selected from various models (the reason for selecting the 
> second to smallest values aren't explained here as is the details of 
> this work):
> 
> *Model predictor fixed effects*
> 
> 	
> 
> */SR.asymp/*
> 
> 	
> 
> */SES.FRic/*
> 
> 	
> 
> */SES.PD/*
> 
> //
> 
> 	
> 
> Deviance
> 
> 	
> 
> //
> 
> Tree + Shrub + Grass + Bare ground + Infrastructure + Seasonal water + 
> Permanent water
> 
> 	
> 
> 760.4 | 1,463.6
> 
> 	
> 
> 172.1 | 319.6
> 
> 	
> 
> 206.7 | 420.7
> 
> Tree + Shrub + Bare ground + Infrastructure + Seasonal water + Permanent 
> water
> 
> 	
> 
> *766.3 | 1467.7*
> 
> 	
> 
> *179.0 | 325.2*
> 
> 	
> 
> *207.3 | 421.3*
> 
> Tree + Shrub + Grass + Bare ground
> 
> 	
> 
> 777.1 | 1,520.3
> 
> 	
> 
> 179.4 | 368.7
> 
> 	
> 
> 229.3 | 441.5
> 
> Tree + Shrub + Grass + Bare ground + Infrastructure
> 
> 	
> 
> 776.8 | 1,484.3
> 
> 	
> 
> 179.0 | 323.0
> 
> 	
> 
> 217.2 | 424.2
> 
> Tree + Shrub + Grass + Bare ground + Seasonal water + Permanent water
> 
> 	
> 
> 760.5 | 1,498.4
> 
> 	
> 
> 172.3 | 363.2
> 
> 	
> 
> 216.8 | 439.9
> 
> 	
> 
> 	
> 
> 	
> 
> 
> Importantly, is there any literature I can cite on Deviance and its use? 
> If so, please supply a DOI.
> 
> Regards/Groete,
> 
> *Rion Lerm*
> 
> SAEON Ndlovu
> 
> C: 076 913 8381
> 
> W: 013 735 3536
> 
> SAEON / Scientific Services, Kruger National Park Gate, Phalaborwa, 
> South Africa
> 
> South African Environmental Observation Network
> 
> Website <https://ndlovu.saeon.ac.za/>& Location of our offices 
> <https://www.google.co.za/maps/place/SAEON+Ndlovu+Node/@-23.9447244,31.164957,18z/data=!4m5!3m4!1s0x1ec36ec96261cfb7:0xb89a27144ba0ca2a!8m2!3d-23.9450103!4d31.1652626>
> 
> 
> 
> My research profiles:
> *ResearchGate* <https://www.researchgate.net/profile/Rion-Lerm>
> *ORCID <https://orcid.org/0000-0002-9992-2093>
> *
> *Google Scholar 
> <https://scholar.google.com/citations?user=JV5d7E4AAAAJ&hl=en>*
> 
> 
> On Tue, 7 Mar 2023 at 16:32, Ben Bolker <bbolker at gmail.com 
> <mailto:bbolker at gmail.com>> wrote:
> 
>      ? ? The deviance is twice the negative log-likelihood; if the deviance
>     is D for a model with p parameters, then AIC = D + 2*p.? The
>     deviance is
>     an *unpenalized* measure of goodness of fit (badness of fit actually -
>     lower deviance means better fit).
> 
>      ? ? There's no need to report deviance in a paper if it's not
>     useful to
>     you or your readers. The deviance for a model alone is not particularly
>     useful; you can use the deviances for several nested models to compute
>     likelihood ratio rests (via anova()), or you can use deviance as the
>     basis for computing AIC or BIC.
> 
>      ? ?Hope that helps.
> 
>      ? ?Ben Bolker
> 
>     On 2023-03-07 9:08 a.m., Rion Lerm via R-sig-mixed-models wrote:
>      > I reported, in a paper, on the *Deviance* value for model fit as
>     produced
>      > by the *glmmTMB* function.
>      >
>      > Please explain how this value is computed, and what are the
>     pros/cons of
>      > this compared to e.g., AIC. I need to comprehend its use and
>     explain the
>      > how and why? to a reviewer and possibly the paper's readers.
>      >
>      > Regards and thanks in advance,
>      >
>      > *Rion Lerm*
>      >
>      > SAEON Ndlovu
>      >
>      > C: 076 913 8381
>      >
>      > W: 013 735 3536
>      >
>      > SAEON / Scientific Services, Kruger National Park Gate,
>     Phalaborwa, South
>      > Africa
>      >
>      > South African Environmental Observation Network
>      >
>      > Website <https://ndlovu.saeon.ac.za/
>     <https://ndlovu.saeon.ac.za/>> & Location of our offices
>      >
>     <https://www.google.co.za/maps/place/SAEON+Ndlovu+Node/@-23.9447244,31.164957,18z/data=!4m5!3m4!1s0x1ec36ec96261cfb7:0xb89a27144ba0ca2a!8m2!3d-23.9450103!4d31.1652626 <https://www.google.co.za/maps/place/SAEON+Ndlovu+Node/@-23.9447244,31.164957,18z/data=!4m5!3m4!1s0x1ec36ec96261cfb7:0xb89a27144ba0ca2a!8m2!3d-23.9450103!4d31.1652626>>
>      >
>      >
>      >
>      > My research profiles:
>      > *ResearchGate* <https://www.researchgate.net/profile/Rion-Lerm
>     <https://www.researchgate.net/profile/Rion-Lerm>>
>      >
>      > *ORCID <https://orcid.org/0000-0002-9992-2093
>     <https://orcid.org/0000-0002-9992-2093>>*
>      > *Google Scholar
>      > <https://scholar.google.com/citations?user=JV5d7E4AAAAJ&hl=en
>     <https://scholar.google.com/citations?user=JV5d7E4AAAAJ&hl=en>>*
>      >
> 
>     -- 
>     Dr. Benjamin Bolker
>     Professor, Mathematics & Statistics and Biology, McMaster University
>     Director, School of Computational Science and Engineering
>     (Acting) Graduate chair, Mathematics & Statistics
>      ?> E-mail is sent at my convenience; I don't expect replies outside of
>     working hours.
> 
>     _______________________________________________
>     R-sig-mixed-models at r-project.org
>     <mailto:R-sig-mixed-models at r-project.org> mailing list
>     https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
> 
> 
> http://www.nrf.ac.za/email-legal-notice.php 
> <http://www.nrf.ac.za/email-legal-notice.php>

-- 
Dr. Benjamin Bolker
Professor, Mathematics & Statistics and Biology, McMaster University
Director, School of Computational Science and Engineering
(Acting) Graduate chair, Mathematics & Statistics
 > E-mail is sent at my convenience; I don't expect replies outside of 
working hours.


From re@|erm @end|ng |rom @@eon@nr|@@c@z@  Mon Mar 13 08:08:16 2023
From: re@|erm @end|ng |rom @@eon@nr|@@c@z@ (Rion Lerm)
Date: Mon, 13 Mar 2023 09:08:16 +0200
Subject: [R-sig-ME] glmmTMB deviance enquiry
In-Reply-To: <2eeb2e65-156e-46fa-e270-3934b376765f@gmail.com>
References: <CALFw9un6LDpPpeJQdOCEipj8qh6xdX0mXdnRuu_U3PgkqQBsWw@mail.gmail.com>
 <CALFw9umX_c4Q2SO0VucPf8NVGz9pi4Yfhqdn=iAegmgpg5XOWg@mail.gmail.com>
 <1c42c523-7880-f8b8-3413-ec6738ac7fea@gmail.com>
 <CALFw9umCT8uk8ARCGB-YW3JZejZTACxXy1i3p6_6RpYFs49tiA@mail.gmail.com>
 <2eeb2e65-156e-46fa-e270-3934b376765f@gmail.com>
Message-ID: <CALFw9u=LM0qj7YwyTrhsmEGet7L7ovuOmjb2DWMK5mzyrmJKBA@mail.gmail.com>

Thanks Ben!

Regards/Groete,

*Rion Lerm*

SAEON Ndlovu

C: 076 913 8381

W: 013 735 3536

SAEON / Scientific Services, Kruger National Park Gate, Phalaborwa, South
Africa

South African Environmental Observation Network

Website <https://ndlovu.saeon.ac.za/> & Location of our offices
<https://www.google.co.za/maps/place/SAEON+Ndlovu+Node/@-23.9447244,31.164957,18z/data=!4m5!3m4!1s0x1ec36ec96261cfb7:0xb89a27144ba0ca2a!8m2!3d-23.9450103!4d31.1652626>



My research profiles:
*ResearchGate* <https://www.researchgate.net/profile/Rion-Lerm>

*ORCID <https://orcid.org/0000-0002-9992-2093>*
*Google Scholar
<https://scholar.google.com/citations?user=JV5d7E4AAAAJ&hl=en>*


On Fri, 10 Mar 2023 at 16:19, Ben Bolker <bbolker at gmail.com> wrote:

>    I'm afraid this might be getting into more generic statistical
> territory, rather than anything specific to mixed models.  If you're
> going to rank models without regard to nesting you should probably use
> AIC rather than deviance.  Alain Zuur (Highland Statistics) has a whole
> series of books on ecological statistics that cover this topic ...
> maybe Symonds et al would be useful?
>
>
> Symonds, Matthew R. E., and Adnan Moussalli. 2011. ?A Brief Guide to
> Model Selection, Multimodel Inference and Model Averaging in Behavioural
> Ecology Using Akaike?s Information Criterion.? Behavioral Ecology and
> Sociobiology 65 (1): 13?21. https://doi.org/10.1007/s00265-010-1037-6.
>
>
> On 2023-03-08 3:56 a.m., Rion Lerm wrote:
> > Thank you @bbolker at gmail.com <mailto:bbolker at gmail.com> for your
> > elaborate response.
> >
> > I am using the Deviance values in this manner to compare model fit.
> > Here, I selected for the model with second to smallest Deviance values.
> > May it be presented like this as I feel it is important to display how a
> > model was selected from various models (the reason for selecting the
> > second to smallest values aren't explained here as is the details of
> > this work):
> >
> > *Model predictor fixed effects*
> >
> >
> >
> > */SR.asymp/*
> >
> >
> >
> > */SES.FRic/*
> >
> >
> >
> > */SES.PD/*
> >
> > //
> >
> >
> >
> > Deviance
> >
> >
> >
> > //
> >
> > Tree + Shrub + Grass + Bare ground + Infrastructure + Seasonal water +
> > Permanent water
> >
> >
> >
> > 760.4 | 1,463.6
> >
> >
> >
> > 172.1 | 319.6
> >
> >
> >
> > 206.7 | 420.7
> >
> > Tree + Shrub + Bare ground + Infrastructure + Seasonal water + Permanent
> > water
> >
> >
> >
> > *766.3 | 1467.7*
> >
> >
> >
> > *179.0 | 325.2*
> >
> >
> >
> > *207.3 | 421.3*
> >
> > Tree + Shrub + Grass + Bare ground
> >
> >
> >
> > 777.1 | 1,520.3
> >
> >
> >
> > 179.4 | 368.7
> >
> >
> >
> > 229.3 | 441.5
> >
> > Tree + Shrub + Grass + Bare ground + Infrastructure
> >
> >
> >
> > 776.8 | 1,484.3
> >
> >
> >
> > 179.0 | 323.0
> >
> >
> >
> > 217.2 | 424.2
> >
> > Tree + Shrub + Grass + Bare ground + Seasonal water + Permanent water
> >
> >
> >
> > 760.5 | 1,498.4
> >
> >
> >
> > 172.3 | 363.2
> >
> >
> >
> > 216.8 | 439.9
> >
> >
> >
> >
> >
> >
> >
> >
> > Importantly, is there any literature I can cite on Deviance and its use?
> > If so, please supply a DOI.
> >
> > Regards/Groete,
> >
> > *Rion Lerm*
> >
> > SAEON Ndlovu
> >
> > C: 076 913 8381
> >
> > W: 013 735 3536
> >
> > SAEON / Scientific Services, Kruger National Park Gate, Phalaborwa,
> > South Africa
> >
> > South African Environmental Observation Network
> >
> > Website <https://ndlovu.saeon.ac.za/>& Location of our offices
> > <
> https://www.google.co.za/maps/place/SAEON+Ndlovu+Node/@-23.9447244,31.164957,18z/data=!4m5!3m4!1s0x1ec36ec96261cfb7:0xb89a27144ba0ca2a!8m2!3d-23.9450103!4d31.1652626
> >
> >
> >
> >
> > My research profiles:
> > *ResearchGate* <https://www.researchgate.net/profile/Rion-Lerm>
> > *ORCID <https://orcid.org/0000-0002-9992-2093>
> > *
> > *Google Scholar
> > <https://scholar.google.com/citations?user=JV5d7E4AAAAJ&hl=en>*
> >
> >
> > On Tue, 7 Mar 2023 at 16:32, Ben Bolker <bbolker at gmail.com
> > <mailto:bbolker at gmail.com>> wrote:
> >
> >          The deviance is twice the negative log-likelihood; if the
> deviance
> >     is D for a model with p parameters, then AIC = D + 2*p.  The
> >     deviance is
> >     an *unpenalized* measure of goodness of fit (badness of fit actually
> -
> >     lower deviance means better fit).
> >
> >          There's no need to report deviance in a paper if it's not
> >     useful to
> >     you or your readers. The deviance for a model alone is not
> particularly
> >     useful; you can use the deviances for several nested models to
> compute
> >     likelihood ratio rests (via anova()), or you can use deviance as the
> >     basis for computing AIC or BIC.
> >
> >         Hope that helps.
> >
> >         Ben Bolker
> >
> >     On 2023-03-07 9:08 a.m., Rion Lerm via R-sig-mixed-models wrote:
> >      > I reported, in a paper, on the *Deviance* value for model fit as
> >     produced
> >      > by the *glmmTMB* function.
> >      >
> >      > Please explain how this value is computed, and what are the
> >     pros/cons of
> >      > this compared to e.g., AIC. I need to comprehend its use and
> >     explain the
> >      > how and why? to a reviewer and possibly the paper's readers.
> >      >
> >      > Regards and thanks in advance,
> >      >
> >      > *Rion Lerm*
> >      >
> >      > SAEON Ndlovu
> >      >
> >      > C: 076 913 8381
> >      >
> >      > W: 013 735 3536
> >      >
> >      > SAEON / Scientific Services, Kruger National Park Gate,
> >     Phalaborwa, South
> >      > Africa
> >      >
> >      > South African Environmental Observation Network
> >      >
> >      > Website <https://ndlovu.saeon.ac.za/
> >     <https://ndlovu.saeon.ac.za/>> & Location of our offices
> >      >
> >     <
> https://www.google.co.za/maps/place/SAEON+Ndlovu+Node/@-23.9447244,31.164957,18z/data=!4m5!3m4!1s0x1ec36ec96261cfb7:0xb89a27144ba0ca2a!8m2!3d-23.9450103!4d31.1652626
> <
> https://www.google.co.za/maps/place/SAEON+Ndlovu+Node/@-23.9447244,31.164957,18z/data=!4m5!3m4!1s0x1ec36ec96261cfb7:0xb89a27144ba0ca2a!8m2!3d-23.9450103!4d31.1652626
> >>
> >      >
> >      >
> >      >
> >      > My research profiles:
> >      > *ResearchGate* <https://www.researchgate.net/profile/Rion-Lerm
> >     <https://www.researchgate.net/profile/Rion-Lerm>>
> >      >
> >      > *ORCID <https://orcid.org/0000-0002-9992-2093
> >     <https://orcid.org/0000-0002-9992-2093>>*
> >      > *Google Scholar
> >      > <https://scholar.google.com/citations?user=JV5d7E4AAAAJ&hl=en
> >     <https://scholar.google.com/citations?user=JV5d7E4AAAAJ&hl=en>>*
> >      >
> >
> >     --
> >     Dr. Benjamin Bolker
> >     Professor, Mathematics & Statistics and Biology, McMaster University
> >     Director, School of Computational Science and Engineering
> >     (Acting) Graduate chair, Mathematics & Statistics
> >       > E-mail is sent at my convenience; I don't expect replies outside
> of
> >     working hours.
> >
> >     _______________________________________________
> >     R-sig-mixed-models at r-project.org
> >     <mailto:R-sig-mixed-models at r-project.org> mailing list
> >     https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >     <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
> >
> >
> > http://www.nrf.ac.za/email-legal-notice.php
> > <http://www.nrf.ac.za/email-legal-notice.php>
>
> --
> Dr. Benjamin Bolker
> Professor, Mathematics & Statistics and Biology, McMaster University
> Director, School of Computational Science and Engineering
> (Acting) Graduate chair, Mathematics & Statistics
>  > E-mail is sent at my convenience; I don't expect replies outside of
> working hours.
>

-- 
http://www.nrf.ac.za/email-legal-notice.php 
<http://www.nrf.ac.za/email-legal-notice.php>

	[[alternative HTML version deleted]]


From gu|||@ume@|mon@@2 @end|ng |rom gm@||@com  Wed Mar 15 09:11:42 2023
From: gu|||@ume@|mon@@2 @end|ng |rom gm@||@com (Guillaume Adeux)
Date: Wed, 15 Mar 2023 09:11:42 +0100
Subject: [R-sig-ME] hypothesis testing - full model doesn't converge
Message-ID: <CAENiVe88gvS=PFE2N_pfAVO2zr0m0RR3pDu7E0+Dfnsa2WEQFg@mail.gmail.com>

Hello everyone,
I'm currently trying to analyse the relationship between crop diversity and
pesticide use at a national scale (4k farms covering 7 climatic regions),
while accounting for crop identity effects (proportion of each crop in the
cropping system), in order to distinguish "true diversity" effects from
"dilution effects" (introducing a meadow in a cropping system necessarily
reduces pesticide use).
The most simple model would be something like:
*mod=glmmTMB(pesticide_use~climatic_region + crop_1 to crop_25 +
crop_diversity + (1|climatic_region:soil)+(1|year),
family=Tweedie(link="log"), data=pest)*
This model converges but doesn't account for the fact that - for a given
crop - pesticide use might be more important under certain weather
conditions (i.e. climatic regions), which is something well known for
ecologists and agronomists.
Hence, a more complete model would be :
*mod_inter=glmmTMB(pesticide_use~climatic_region * (crop_1 to crop_25 +
crop_diversity) + (1|climatic_region:soil)+(1|year),
family=Tweedie(link="log"), data=pest)*
However, this "full" model doesn't converge, even when I try to boost the
number of iterations or the fitting algorithm.
I was hence tempted to identify the most complete model that converges (for
example via the R buildmer package) but I understand from my reading that
model selection and hypothesis testing don't go well together (pvalues are
biased after model selection). I wasn't able to find whether or not it was
possible to correct these pvalues after model selection.
I was suggested (by Bert van der Veen) to look into variable selection
(glmmLasso for example) but it appears less flexible (Tweedie or gamma
families are not implemented and I will most likely have to correct for
spatial autocorrelation in my selected model, which is possible in glmmTMB
but not glmmLasso).
Because of multicollinearity problems including crop diversity, I was
thinking of identifying the most complete crop model (only interactions
between climatic region and crop proportions) and comparing it to the same
model including crop diversity and its interaction with crop region.
How would you more knowledgeable folks go about tackling this problem? Is
this procedure a little dubious ?
Thanks a lot for your feedback.
Have a great day.
GA2

	[[alternative HTML version deleted]]


From re@|erm @end|ng |rom @@eon@nr|@@c@z@  Fri Mar 17 10:04:06 2023
From: re@|erm @end|ng |rom @@eon@nr|@@c@z@ (Rion Lerm)
Date: Fri, 17 Mar 2023 11:04:06 +0200
Subject: [R-sig-ME] hypothesis testing - full model doesn't converge
In-Reply-To: <CAENiVe88gvS=PFE2N_pfAVO2zr0m0RR3pDu7E0+Dfnsa2WEQFg@mail.gmail.com>
References: <CAENiVe88gvS=PFE2N_pfAVO2zr0m0RR3pDu7E0+Dfnsa2WEQFg@mail.gmail.com>
Message-ID: <CALFw9unicp0qmY=vap5rEwhB2o0st5jWR1kvPowRKQfGVvksnA@mail.gmail.com>

I got one of two warnings depending on my response variable i.e.,:

Warning message:
In fitTMB(TMBStruc) :
  Model convergence problem; non-positive-definite Hessian matrix. See
vignette('troubleshooting')

or

Warning message:
In fitTMB(TMBStruc) :
  Model convergence problem; extreme or very small eigenvalues detected.
See vignette('troubleshooting')

Attached is the code I employed for scaling the predictor effects that
compare the successful and unsuccessful model runs. (Disclaimer: the steps
came from a vignette not built by me).

Run various models with different combos of predictor fixed effects and
compare AIC or BIC values and select the smallest or similar depending on
importance of predictor inclusion. (PS diversity measures also produced
large collinearity with most of my predictors; I inspected this issue by
running generliased pairs plots of the predictor fixed effects (see GGally
package's ggpairs() function)).

Regards/Groete and I hope this helps or I have addressed your query
successfully,

*Rion Lerm*

SAEON Ndlovu

C: 076 913 8381

W: 013 735 3536

SAEON / Scientific Services, Kruger National Park Gate, Phalaborwa, South
Africa

South African Environmental Observation Network

Website <https://ndlovu.saeon.ac.za/> & Location of our offices
<https://www.google.co.za/maps/place/SAEON+Ndlovu+Node/@-23.9447244,31.164957,18z/data=!4m5!3m4!1s0x1ec36ec96261cfb7:0xb89a27144ba0ca2a!8m2!3d-23.9450103!4d31.1652626>



My research profiles:
*ResearchGate* <https://www.researchgate.net/profile/Rion-Lerm>

*ORCID <https://orcid.org/0000-0002-9992-2093>*
*Google Scholar
<https://scholar.google.com/citations?user=JV5d7E4AAAAJ&hl=en>*


On Wed, 15 Mar 2023 at 10:12, Guillaume Adeux <guillaumesimon.a2 at gmail.com>
wrote:

> Hello everyone,
> I'm currently trying to analyse the relationship between crop diversity and
> pesticide use at a national scale (4k farms covering 7 climatic regions),
> while accounting for crop identity effects (proportion of each crop in the
> cropping system), in order to distinguish "true diversity" effects from
> "dilution effects" (introducing a meadow in a cropping system necessarily
> reduces pesticide use).
> The most simple model would be something like:
> *mod=glmmTMB(pesticide_use~climatic_region + crop_1 to crop_25 +
> crop_diversity + (1|climatic_region:soil)+(1|year),
> family=Tweedie(link="log"), data=pest)*
> This model converges but doesn't account for the fact that - for a given
> crop - pesticide use might be more important under certain weather
> conditions (i.e. climatic regions), which is something well known for
> ecologists and agronomists.
> Hence, a more complete model would be :
> *mod_inter=glmmTMB(pesticide_use~climatic_region * (crop_1 to crop_25 +
> crop_diversity) + (1|climatic_region:soil)+(1|year),
> family=Tweedie(link="log"), data=pest)*
> However, this "full" model doesn't converge, even when I try to boost the
> number of iterations or the fitting algorithm.
> I was hence tempted to identify the most complete model that converges (for
> example via the R buildmer package) but I understand from my reading that
> model selection and hypothesis testing don't go well together (pvalues are
> biased after model selection). I wasn't able to find whether or not it was
> possible to correct these pvalues after model selection.
> I was suggested (by Bert van der Veen) to look into variable selection
> (glmmLasso for example) but it appears less flexible (Tweedie or gamma
> families are not implemented and I will most likely have to correct for
> spatial autocorrelation in my selected model, which is possible in glmmTMB
> but not glmmLasso).
> Because of multicollinearity problems including crop diversity, I was
> thinking of identifying the most complete crop model (only interactions
> between climatic region and crop proportions) and comparing it to the same
> model including crop diversity and its interaction with crop region.
> How would you more knowledgeable folks go about tackling this problem? Is
> this procedure a little dubious ?
> Thanks a lot for your feedback.
> Have a great day.
> GA2
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>

-- 
http://www.nrf.ac.za/email-legal-notice.php 
<http://www.nrf.ac.za/email-legal-notice.php>

-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: glmmTMB and scaling predictors.txt
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20230317/b4c4c00b/attachment.txt>

From |brom@no77 @end|ng |rom gm@||@com  Sat Mar 18 15:44:00 2023
From: |brom@no77 @end|ng |rom gm@||@com (Francesco Romano)
Date: Sat, 18 Mar 2023 15:44:00 +0100
Subject: [R-sig-ME] Where to start: running multinomial analyses with LME4
Message-ID: <CABX-QoFwNrRXL5L4hsx9R7NOfYef7XO9hgyxdBzkXBycPf3S1Q@mail.gmail.com>

Dear all,


I am now for the first time needing to run ME analyses with
likert-scale-type data obtained from acceptability judgments in a
linguistic experiment. The responses range between 1 and 5, are ordered,
and will involve continuous predictors as well as dichotomous factors.
Gelman and Hill 2007's section on ordered logistic regression (p.119-124)
does not involve MEs nor are there any worked examples with R coding as far
as I can see in the book.

Thus, I would be very grateful to anyone who could point me to some
literature with worked examples involving coding for ordered logistic
regression, preferably in linguistics. Obviously, if anyone has alternative
ways of approaching this type of data, I am open to suggestions.

Thanks in advance,


Francesco Romano PhD

	[[alternative HTML version deleted]]


From j|@ver|@@|mo @end|ng |rom gm@||@com  Sat Mar 18 16:07:19 2023
From: j|@ver|@@|mo @end|ng |rom gm@||@com (=?UTF-8?Q?Jo=c3=a3o_Ver=c3=adssimo?=)
Date: Sat, 18 Mar 2023 15:07:19 +0000
Subject: [R-sig-ME] 
 Where to start: running multinomial analyses with LME4
In-Reply-To: <CABX-QoFwNrRXL5L4hsx9R7NOfYef7XO9hgyxdBzkXBycPf3S1Q@mail.gmail.com>
References: <CABX-QoFwNrRXL5L4hsx9R7NOfYef7XO9hgyxdBzkXBycPf3S1Q@mail.gmail.com>
Message-ID: <6e78e467-8915-9a95-e75a-46ed54ae6053@gmail.com>

Have a look at the ordinal package and its vignettes. You can fit fit 
mixed-effects ordinal models with the clmm() and clmm2() functions.

For Bayesian mixed-effects models (in brms), these papers will be helpful:
https://doi.org/10.1017/S1366728921000316
https://doi.org/10.1177/2515245918823199

Jo?o

On 18/03/2023 14:44, Francesco Romano wrote:
> Dear all,
>
>
> I am now for the first time needing to run ME analyses with
> likert-scale-type data obtained from acceptability judgments in a
> linguistic experiment. The responses range between 1 and 5, are ordered,
> and will involve continuous predictors as well as dichotomous factors.
> Gelman and Hill 2007's section on ordered logistic regression (p.119-124)
> does not involve MEs nor are there any worked examples with R coding as far
> as I can see in the book.
>
> Thus, I would be very grateful to anyone who could point me to some
> literature with worked examples involving coding for ordered logistic
> regression, preferably in linguistics. Obviously, if anyone has alternative
> ways of approaching this type of data, I am open to suggestions.
>
> Thanks in advance,
>
>
> Francesco Romano PhD
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models


From k@r| @end|ng |rom hu|t|@@org  Sun Mar 19 13:40:02 2023
From: k@r| @end|ng |rom hu|t|@@org (Karl Ove Hufthammer)
Date: Sun, 19 Mar 2023 13:40:02 +0100
Subject: [R-sig-ME] 
 Where to start: running multinomial analyses with LME4
In-Reply-To: <CABX-QoFwNrRXL5L4hsx9R7NOfYef7XO9hgyxdBzkXBycPf3S1Q@mail.gmail.com>
References: <CABX-QoFwNrRXL5L4hsx9R7NOfYef7XO9hgyxdBzkXBycPf3S1Q@mail.gmail.com>
Message-ID: <38b944c4-9777-55d2-64dd-d1edb51fd6a5@huftis.org>

Francesco Romano skreiv 18.03.2023 15:44:
> Thus, I would be very grateful to anyone who could point me to some
> literature with worked examples involving coding for ordered logistic
> regression, preferably in linguistics. Obviously, if anyone has alternative
> ways of approaching this type of data, I am open to suggestions.

You might find the vignette on the clmm2() function in the ?ordinal? 
package useful:
https://cran.r-project.org/web/packages/ordinal/vignettes/clmm2_tutorial.pdf

(But you should probably use the newer, though very similar, clmm() 
function in the same package instead.)


-- 
Karl Ove Hufthammer


From me @end|ng |rom ph||||p@|d@y@com  Sun Mar 19 16:17:21 2023
From: me @end|ng |rom ph||||p@|d@y@com (Phillip Alday)
Date: Sun, 19 Mar 2023 09:17:21 -0600
Subject: [R-sig-ME] 
 Where to start: running multinomial analyses with LME4
In-Reply-To: <38b944c4-9777-55d2-64dd-d1edb51fd6a5@huftis.org>
References: <CABX-QoFwNrRXL5L4hsx9R7NOfYef7XO9hgyxdBzkXBycPf3S1Q@mail.gmail.com>
 <38b944c4-9777-55d2-64dd-d1edb51fd6a5@huftis.org>
Message-ID: <c5bd8ab5-7816-c700-ca68-d70976432de1@phillipalday.com>

See also 
https://doingbayesiandataanalysis.blogspot.com/2018/09/analyzing-ordinal-data-with-metric.html

On 3/19/23 06:40, Karl Ove Hufthammer wrote:
> Francesco Romano skreiv 18.03.2023 15:44:
>> Thus, I would be very grateful to anyone who could point me to some
>> literature with worked examples involving coding for ordered logistic
>> regression, preferably in linguistics. Obviously, if anyone has 
>> alternative
>> ways of approaching this type of data, I am open to suggestions.
>
> You might find the vignette on the clmm2() function in the ?ordinal? 
> package useful:
> https://cran.r-project.org/web/packages/ordinal/vignettes/clmm2_tutorial.pdf 
>
>
> (But you should probably use the newer, though very similar, clmm() 
> function in the same package instead.)
>
>


From |brom@no77 @end|ng |rom gm@||@com  Sun Mar 19 17:00:07 2023
From: |brom@no77 @end|ng |rom gm@||@com (Francesco Romano)
Date: Sun, 19 Mar 2023 17:00:07 +0100
Subject: [R-sig-ME] 
 Where to start: running multinomial analyses with LME4
In-Reply-To: <c5bd8ab5-7816-c700-ca68-d70976432de1@phillipalday.com>
References: <CABX-QoFwNrRXL5L4hsx9R7NOfYef7XO9hgyxdBzkXBycPf3S1Q@mail.gmail.com>
 <38b944c4-9777-55d2-64dd-d1edb51fd6a5@huftis.org>
 <c5bd8ab5-7816-c700-ca68-d70976432de1@phillipalday.com>
Message-ID: <CABX-QoF5+J74D8NOXs9WYZF6s5uB=EdSMG-=icGB0dHpHOsfHw@mail.gmail.com>

Dear Joao and Phillip,

Thank you so much for your suggestions.
Please keep them coming everyone ?

Francesco

On Sun, 19 Mar 2023 at 16:17, Phillip Alday <me at phillipalday.com> wrote:

> See also
>
> https://doingbayesiandataanalysis.blogspot.com/2018/09/analyzing-ordinal-data-with-metric.html
>
> On 3/19/23 06:40, Karl Ove Hufthammer wrote:
> > Francesco Romano skreiv 18.03.2023 15:44:
> >> Thus, I would be very grateful to anyone who could point me to some
> >> literature with worked examples involving coding for ordered logistic
> >> regression, preferably in linguistics. Obviously, if anyone has
> >> alternative
> >> ways of approaching this type of data, I am open to suggestions.
> >
> > You might find the vignette on the clmm2() function in the ?ordinal?
> > package useful:
> >
> https://cran.r-project.org/web/packages/ordinal/vignettes/clmm2_tutorial.pdf
> >
> >
> > (But you should probably use the newer, though very similar, clmm()
> > function in the same package instead.)
> >
> >
>
-- 
Inviato da Gmail Mobile

	[[alternative HTML version deleted]]


From rt||ner @end|ng |rom gm@||@com  Fri Mar 24 02:38:45 2023
From: rt||ner @end|ng |rom gm@||@com (rtfiner)
Date: Thu, 23 Mar 2023 18:38:45 -0700
Subject: [R-sig-ME] Question about proportion data in binomial glmm
Message-ID: <CAM6yPO37yxSVhKLoiFH-JL3AAtq1D+4aAj8=XN0wc8f+N7r0tg@mail.gmail.com>

I have a question about how glmmtmb handles proportion data for the
purposes of a binomial glmm.

I combined my success and failure count data into a matrix using cbind(),
and used that as my response in my binomial glmm using glmmtmb.

However, despite there being a few instances of zero counts in both columns
and therefore an undefined proportion, the model doesn't seem to drop these
rows from my data set.

I don't get any errors or warnings when running the model, but I worry my
results might be biased because of this.

My question is: Is glmmtmb doing something like adding a tiny amount to
each value of my response in order to avoid dealing with undefined
proportion data?

Thank you for your help,

Robert

	[[alternative HTML version deleted]]


From th|erry@onke||nx @end|ng |rom |nbo@be  Fri Mar 24 09:12:07 2023
From: th|erry@onke||nx @end|ng |rom |nbo@be (Thierry Onkelinx)
Date: Fri, 24 Mar 2023 09:12:07 +0100
Subject: [R-sig-ME] Question about proportion data in binomial glmm
In-Reply-To: <CAM6yPO37yxSVhKLoiFH-JL3AAtq1D+4aAj8=XN0wc8f+N7r0tg@mail.gmail.com>
References: <CAM6yPO37yxSVhKLoiFH-JL3AAtq1D+4aAj8=XN0wc8f+N7r0tg@mail.gmail.com>
Message-ID: <CAJuCY5wBj8FZZJ+G8fw5Bbiuq=cUH7k9nUgDMPWsndN3QvMEEA@mail.gmail.com>

Dear Robert,

IMHO you should remove the cbind(0, 0) before fitting the model. There is
no reason to keep them in the dataset.

Best regards,

ir. Thierry Onkelinx
Statisticus / Statistician

Vlaamse Overheid / Government of Flanders
INSTITUUT VOOR NATUUR- EN BOSONDERZOEK / RESEARCH INSTITUTE FOR NATURE AND
FOREST
Team Biometrie & Kwaliteitszorg / Team Biometrics & Quality Assurance
thierry.onkelinx at inbo.be
Havenlaan 88 bus 73, 1000 Brussel
www.inbo.be

///////////////////////////////////////////////////////////////////////////////////////////
To call in the statistician after the experiment is done may be no more
than asking him to perform a post-mortem examination: he may be able to say
what the experiment died of. ~ Sir Ronald Aylmer Fisher
The plural of anecdote is not data. ~ Roger Brinner
The combination of some data and an aching desire for an answer does not
ensure that a reasonable answer can be extracted from a given body of data.
~ John Tukey
///////////////////////////////////////////////////////////////////////////////////////////

<https://www.inbo.be>


Op vr 24 mrt 2023 om 02:39 schreef rtfiner <rtfiner at gmail.com>:

> I have a question about how glmmtmb handles proportion data for the
> purposes of a binomial glmm.
>
> I combined my success and failure count data into a matrix using cbind(),
> and used that as my response in my binomial glmm using glmmtmb.
>
> However, despite there being a few instances of zero counts in both columns
> and therefore an undefined proportion, the model doesn't seem to drop these
> rows from my data set.
>
> I don't get any errors or warnings when running the model, but I worry my
> results might be biased because of this.
>
> My question is: Is glmmtmb doing something like adding a tiny amount to
> each value of my response in order to avoid dealing with undefined
> proportion data?
>
> Thank you for your help,
>
> Robert
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>

	[[alternative HTML version deleted]]


From mo|||eebrook@ @end|ng |rom gm@||@com  Fri Mar 24 11:36:42 2023
From: mo|||eebrook@ @end|ng |rom gm@||@com (Mollie Brooks)
Date: Fri, 24 Mar 2023 11:36:42 +0100
Subject: [R-sig-ME] Question about proportion data in binomial glmm
In-Reply-To: <CAJuCY5wBj8FZZJ+G8fw5Bbiuq=cUH7k9nUgDMPWsndN3QvMEEA@mail.gmail.com>
References: <CAM6yPO37yxSVhKLoiFH-JL3AAtq1D+4aAj8=XN0wc8f+N7r0tg@mail.gmail.com>
 <CAJuCY5wBj8FZZJ+G8fw5Bbiuq=cUH7k9nUgDMPWsndN3QvMEEA@mail.gmail.com>
Message-ID: <4E9521DF-59BB-43BA-9DBC-6097A97EB987@gmail.com>

They have zero contribution to the log-likelihood, so they shouldn?t affect the model.

> dbinom(0, 0, 0.1, log=TRUE)
[1] 0

I can?t say if they would affect any model evaluation functionality, but they shouldn't.

Best,
Mollie

> On 24 Mar 2023, at 09.12, Thierry Onkelinx via R-sig-mixed-models <r-sig-mixed-models at r-project.org> wrote:
> 
> Dear Robert,
> 
> IMHO you should remove the cbind(0, 0) before fitting the model. There is
> no reason to keep them in the dataset.
> 
> Best regards,
> 
> ir. Thierry Onkelinx
> Statisticus / Statistician
> 
> Vlaamse Overheid / Government of Flanders
> INSTITUUT VOOR NATUUR- EN BOSONDERZOEK / RESEARCH INSTITUTE FOR NATURE AND
> FOREST
> Team Biometrie & Kwaliteitszorg / Team Biometrics & Quality Assurance
> thierry.onkelinx at inbo.be
> Havenlaan 88 bus 73, 1000 Brussel
> www.inbo.be
> 
> ///////////////////////////////////////////////////////////////////////////////////////////
> To call in the statistician after the experiment is done may be no more
> than asking him to perform a post-mortem examination: he may be able to say
> what the experiment died of. ~ Sir Ronald Aylmer Fisher
> The plural of anecdote is not data. ~ Roger Brinner
> The combination of some data and an aching desire for an answer does not
> ensure that a reasonable answer can be extracted from a given body of data.
> ~ John Tukey
> ///////////////////////////////////////////////////////////////////////////////////////////
> 
> <https://www.inbo.be>
> 
> 
> Op vr 24 mrt 2023 om 02:39 schreef rtfiner <rtfiner at gmail.com>:
> 
>> I have a question about how glmmtmb handles proportion data for the
>> purposes of a binomial glmm.
>> 
>> I combined my success and failure count data into a matrix using cbind(),
>> and used that as my response in my binomial glmm using glmmtmb.
>> 
>> However, despite there being a few instances of zero counts in both columns
>> and therefore an undefined proportion, the model doesn't seem to drop these
>> rows from my data set.
>> 
>> I don't get any errors or warnings when running the model, but I worry my
>> results might be biased because of this.
>> 
>> My question is: Is glmmtmb doing something like adding a tiny amount to
>> each value of my response in order to avoid dealing with undefined
>> proportion data?
>> 
>> Thank you for your help,
>> 
>> Robert
>> 
>>        [[alternative HTML version deleted]]
>> 
>> _______________________________________________
>> R-sig-mixed-models at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>> 
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models


From bbo|ker @end|ng |rom gm@||@com  Mon Mar 27 18:17:51 2023
From: bbo|ker @end|ng |rom gm@||@com (Ben Bolker)
Date: Mon, 27 Mar 2023 12:17:51 -0400
Subject: [R-sig-ME] Question about proportion data in binomial glmm
In-Reply-To: <4E9521DF-59BB-43BA-9DBC-6097A97EB987@gmail.com>
References: <CAM6yPO37yxSVhKLoiFH-JL3AAtq1D+4aAj8=XN0wc8f+N7r0tg@mail.gmail.com>
 <CAJuCY5wBj8FZZJ+G8fw5Bbiuq=cUH7k9nUgDMPWsndN3QvMEEA@mail.gmail.com>
 <4E9521DF-59BB-43BA-9DBC-6097A97EB987@gmail.com>
Message-ID: <4c754bf9-4363-b700-a328-3aed19c31711@gmail.com>

 ?? The only further issue here is that the number of observations for 
the model will still be computed as including these null values. This 
should only matter if you're doing something like computing 
finite-size-corrected AICs (and to paraphrase _Numerical Recipes_, if 
this level of difference matters to you then you're on shaky ground 
anyway ...)

 ? The source code for the dbinom implementation in TMB:

https://kaskr.github.io/adcomp/distributions__R_8hpp_source.html

 ? illustrates that values with N=0, k = 0 will have no effect on the 
log-likelihood (while TMB mirrors R's behaviour most of the time, it's 
not 100% safe to assume that edge cases will work exactly the same in R 
and TMB)

On 2023-03-24 6:36 a.m., Mollie Brooks wrote:
> They have zero contribution to the log-likelihood, so they shouldn?t affect the model.
>
>> dbinom(0, 0, 0.1, log=TRUE)
> [1] 0
>
> I can?t say if they would affect any model evaluation functionality, but they shouldn't.
>
> Best,
> Mollie
>
>> On 24 Mar 2023, at 09.12, Thierry Onkelinx via R-sig-mixed-models <r-sig-mixed-models at r-project.org> wrote:
>>
>> Dear Robert,
>>
>> IMHO you should remove the cbind(0, 0) before fitting the model. There is
>> no reason to keep them in the dataset.
>>
>> Best regards,
>>
>> ir. Thierry Onkelinx
>> Statisticus / Statistician
>>
>> Vlaamse Overheid / Government of Flanders
>> INSTITUUT VOOR NATUUR- EN BOSONDERZOEK / RESEARCH INSTITUTE FOR NATURE AND
>> FOREST
>> Team Biometrie & Kwaliteitszorg / Team Biometrics & Quality Assurance
>> thierry.onkelinx at inbo.be
>> Havenlaan 88 bus 73, 1000 Brussel
>> www.inbo.be
>>
>> ///////////////////////////////////////////////////////////////////////////////////////////
>> To call in the statistician after the experiment is done may be no more
>> than asking him to perform a post-mortem examination: he may be able to say
>> what the experiment died of. ~ Sir Ronald Aylmer Fisher
>> The plural of anecdote is not data. ~ Roger Brinner
>> The combination of some data and an aching desire for an answer does not
>> ensure that a reasonable answer can be extracted from a given body of data.
>> ~ John Tukey
>> ///////////////////////////////////////////////////////////////////////////////////////////
>>
>> <https://www.inbo.be>
>>
>>
>> Op vr 24 mrt 2023 om 02:39 schreef rtfiner <rtfiner at gmail.com>:
>>
>>> I have a question about how glmmtmb handles proportion data for the
>>> purposes of a binomial glmm.
>>>
>>> I combined my success and failure count data into a matrix using cbind(),
>>> and used that as my response in my binomial glmm using glmmtmb.
>>>
>>> However, despite there being a few instances of zero counts in both columns
>>> and therefore an undefined proportion, the model doesn't seem to drop these
>>> rows from my data set.
>>>
>>> I don't get any errors or warnings when running the model, but I worry my
>>> results might be biased because of this.
>>>
>>> My question is: Is glmmtmb doing something like adding a tiny amount to
>>> each value of my response in order to avoid dealing with undefined
>>> proportion data?
>>>
>>> Thank you for your help,
>>>
>>> Robert
>>>
>>>         [[alternative HTML version deleted]]
>>>
>>> _______________________________________________
>>> R-sig-mixed-models at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>
>> 	[[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-mixed-models at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models


From k@|m@n@toth @end|ng |rom protonm@||@com  Wed Mar 29 15:40:50 2023
From: k@|m@n@toth @end|ng |rom protonm@||@com (kalman.toth)
Date: Wed, 29 Mar 2023 13:40:50 +0000
Subject: [R-sig-ME] lme4 to nlme translation
Message-ID: <jJiPjQzHOZ5zJ4jjVQJVTSfP5zD_WH9tJXdwafbydM0v3Sw3faF6-ulClq_hqgRXTRc7mWms7a6RexH_83SK2KEU1pGx358eSJaYoo4gXoA=@protonmail.com>

Dear All,

I am struggling to 'translate' this lme4 syntax to nlme:

lmer(response ~ (1|group1) + (1|group2) + (1|group1:group3), data)

Let's say that the general assumptions hold but actually the main reason of the 'translation' would be to study the effect of heteroscedasticity on the variance estimates.

Could someone help me?

Thanks,
Kalman
	[[alternative HTML version deleted]]


From dmb@te@ @end|ng |rom gm@||@com  Wed Mar 29 15:59:49 2023
From: dmb@te@ @end|ng |rom gm@||@com (Douglas Bates)
Date: Wed, 29 Mar 2023 08:59:49 -0500
Subject: [R-sig-ME] lme4 to nlme translation
In-Reply-To: <jJiPjQzHOZ5zJ4jjVQJVTSfP5zD_WH9tJXdwafbydM0v3Sw3faF6-ulClq_hqgRXTRc7mWms7a6RexH_83SK2KEU1pGx358eSJaYoo4gXoA=@protonmail.com>
References: <jJiPjQzHOZ5zJ4jjVQJVTSfP5zD_WH9tJXdwafbydM0v3Sw3faF6-ulClq_hqgRXTRc7mWms7a6RexH_83SK2KEU1pGx358eSJaYoo4gXoA=@protonmail.com>
Message-ID: <CAO7JsnR_EANK=1HY9aZjvPCrcHeLjBkRFMr7a2js+cy1OmtzQg@mail.gmail.com>

Unless group2 is nested within group1 it will be difficult to translate
such a model into nlme syntax.  We developed lme4 and its computational
methods specifically to be able to handle multiple non-nested grouping
factors, for which nlme was not well suited.  There is an example in
Pinheiro and Bates (2000) of fitting a model with crossed grouping factors
using the nlme package but the technique doesn't scale well.

Depending on the nature of the heteroscedasticity you may be better off
trying to transform the response, say with the Box-Cox family of
transformations.


On Wed, Mar 29, 2023 at 8:41?AM kalman.toth via R-sig-mixed-models <
r-sig-mixed-models at r-project.org> wrote:

> Dear All,
>
> I am struggling to 'translate' this lme4 syntax to nlme:
>
> lmer(response ~ (1|group1) + (1|group2) + (1|group1:group3), data)
>
> Let's say that the general assumptions hold but actually the main reason
> of the 'translation' would be to study the effect of heteroscedasticity on
> the variance estimates.
>
> Could someone help me?
>
> Thanks,
> Kalman
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>

	[[alternative HTML version deleted]]


From rt||ner @end|ng |rom gm@||@com  Wed Mar 29 19:04:45 2023
From: rt||ner @end|ng |rom gm@||@com (rtfiner)
Date: Wed, 29 Mar 2023 10:04:45 -0700
Subject: [R-sig-ME] Question about proportion data in binomial glmm
In-Reply-To: <4c754bf9-4363-b700-a328-3aed19c31711@gmail.com>
References: <CAM6yPO37yxSVhKLoiFH-JL3AAtq1D+4aAj8=XN0wc8f+N7r0tg@mail.gmail.com>
 <CAJuCY5wBj8FZZJ+G8fw5Bbiuq=cUH7k9nUgDMPWsndN3QvMEEA@mail.gmail.com>
 <4E9521DF-59BB-43BA-9DBC-6097A97EB987@gmail.com>
 <4c754bf9-4363-b700-a328-3aed19c31711@gmail.com>
Message-ID: <CAM6yPO3PKf0PO=htYHqEBZ6uVCzk-Ki9nsYS6eU_oO8GrnN5Nw@mail.gmail.com>

Thank you all for your input. I tried fitting the model with NaNs removed,
and output and evaluation were very similar, so perhaps I am okay?

-Robert

On Mon, Mar 27, 2023 at 9:18?AM Ben Bolker <bbolker at gmail.com> wrote:

>     The only further issue here is that the number of observations for
> the model will still be computed as including these null values. This
> should only matter if you're doing something like computing
> finite-size-corrected AICs (and to paraphrase _Numerical Recipes_, if
> this level of difference matters to you then you're on shaky ground
> anyway ...)
>
>    The source code for the dbinom implementation in TMB:
>
> https://kaskr.github.io/adcomp/distributions__R_8hpp_source.html
>
>    illustrates that values with N=0, k = 0 will have no effect on the
> log-likelihood (while TMB mirrors R's behaviour most of the time, it's
> not 100% safe to assume that edge cases will work exactly the same in R
> and TMB)
>
> On 2023-03-24 6:36 a.m., Mollie Brooks wrote:
> > They have zero contribution to the log-likelihood, so they shouldn?t
> affect the model.
> >
> >> dbinom(0, 0, 0.1, log=TRUE)
> > [1] 0
> >
> > I can?t say if they would affect any model evaluation functionality, but
> they shouldn't.
> >
> > Best,
> > Mollie
> >
> >> On 24 Mar 2023, at 09.12, Thierry Onkelinx via R-sig-mixed-models <
> r-sig-mixed-models at r-project.org> wrote:
> >>
> >> Dear Robert,
> >>
> >> IMHO you should remove the cbind(0, 0) before fitting the model. There
> is
> >> no reason to keep them in the dataset.
> >>
> >> Best regards,
> >>
> >> ir. Thierry Onkelinx
> >> Statisticus / Statistician
> >>
> >> Vlaamse Overheid / Government of Flanders
> >> INSTITUUT VOOR NATUUR- EN BOSONDERZOEK / RESEARCH INSTITUTE FOR NATURE
> AND
> >> FOREST
> >> Team Biometrie & Kwaliteitszorg / Team Biometrics & Quality Assurance
> >> thierry.onkelinx at inbo.be
> >> Havenlaan 88 bus 73, 1000 Brussel
> >> www.inbo.be
> >>
> >>
> ///////////////////////////////////////////////////////////////////////////////////////////
> >> To call in the statistician after the experiment is done may be no more
> >> than asking him to perform a post-mortem examination: he may be able to
> say
> >> what the experiment died of. ~ Sir Ronald Aylmer Fisher
> >> The plural of anecdote is not data. ~ Roger Brinner
> >> The combination of some data and an aching desire for an answer does not
> >> ensure that a reasonable answer can be extracted from a given body of
> data.
> >> ~ John Tukey
> >>
> ///////////////////////////////////////////////////////////////////////////////////////////
> >>
> >> <https://www.inbo.be>
> >>
> >>
> >> Op vr 24 mrt 2023 om 02:39 schreef rtfiner <rtfiner at gmail.com>:
> >>
> >>> I have a question about how glmmtmb handles proportion data for the
> >>> purposes of a binomial glmm.
> >>>
> >>> I combined my success and failure count data into a matrix using
> cbind(),
> >>> and used that as my response in my binomial glmm using glmmtmb.
> >>>
> >>> However, despite there being a few instances of zero counts in both
> columns
> >>> and therefore an undefined proportion, the model doesn't seem to drop
> these
> >>> rows from my data set.
> >>>
> >>> I don't get any errors or warnings when running the model, but I worry
> my
> >>> results might be biased because of this.
> >>>
> >>> My question is: Is glmmtmb doing something like adding a tiny amount to
> >>> each value of my response in order to avoid dealing with undefined
> >>> proportion data?
> >>>
> >>> Thank you for your help,
> >>>
> >>> Robert
> >>>
> >>>         [[alternative HTML version deleted]]
> >>>
> >>> _______________________________________________
> >>> R-sig-mixed-models at r-project.org mailing list
> >>> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >>>
> >>      [[alternative HTML version deleted]]
> >>
> >> _______________________________________________
> >> R-sig-mixed-models at r-project.org mailing list
> >> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> > _______________________________________________
> > R-sig-mixed-models at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>


-- 
*-Robert Finer*

	[[alternative HTML version deleted]]


From hedyeh@h @end|ng |rom u@c@edu  Fri Mar 31 01:11:18 2023
From: hedyeh@h @end|ng |rom u@c@edu (Hedyeh Ahmadi)
Date: Thu, 30 Mar 2023 23:11:18 +0000
Subject: [R-sig-ME] glmer() cluster sample size
Message-ID: <BYAPR07MB509479BACFB6CF2A2C61CEF9D18E9@BYAPR07MB5094.namprd07.prod.outlook.com>

Hello all,
I'm running a glmer() model with 3 levels where individuals are nested within 21 sites and each individual has 1 to 2 repeated measures. My model has the random effect structure (1|site/subjet_id).

So I have sample sizes in glmer() output for 3 levels as follows:
Site=21
Subject_id:site=9334
Total number of observations=17592

I was wondering how are these sample sizes calculated in R?

I was under impression that they are just unique number of site, subject_id, and total number of rows, for complete cases across all my varibles, respectively. This is true for my site and total sample sizes but the subject_id:site sample size is confusing me. Shouldn't this just be the number of unique subject ids? When I look at number rof unique ids, I get 9301 but the glmer() output for subject_id:site is 9334.

Thank you in advance for your time.


 Best,


Biostatistician?
Keck School of Medicine
Department of Preventive Medicine
University of Southern California

LinkedIn
www.linkedin.com/in/hedyeh-ahmadi<http://www.linkedin.com/in/hedyeh-ahmadi>



	[[alternative HTML version deleted]]


From th|erry@onke||nx @end|ng |rom |nbo@be  Fri Mar 31 09:42:32 2023
From: th|erry@onke||nx @end|ng |rom |nbo@be (Thierry Onkelinx)
Date: Fri, 31 Mar 2023 09:42:32 +0200
Subject: [R-sig-ME] glmer() cluster sample size
In-Reply-To: <BYAPR07MB509479BACFB6CF2A2C61CEF9D18E9@BYAPR07MB5094.namprd07.prod.outlook.com>
References: <BYAPR07MB509479BACFB6CF2A2C61CEF9D18E9@BYAPR07MB5094.namprd07.prod.outlook.com>
Message-ID: <CAJuCY5zoOTS6qEO667ketxno9H_Mz=-93p8-OPOSL5sjwzyHEw@mail.gmail.com>

It looks like some subjects were present at multiple locations. The number
of levels is the number of unique combinations of site and subject.

ir. Thierry Onkelinx
Statisticus / Statistician

Vlaamse Overheid / Government of Flanders
INSTITUUT VOOR NATUUR- EN BOSONDERZOEK / RESEARCH INSTITUTE FOR NATURE AND
FOREST
Team Biometrie & Kwaliteitszorg / Team Biometrics & Quality Assurance
thierry.onkelinx at inbo.be
Havenlaan 88 bus 73, 1000 Brussel
www.inbo.be

///////////////////////////////////////////////////////////////////////////////////////////
To call in the statistician after the experiment is done may be no more
than asking him to perform a post-mortem examination: he may be able to say
what the experiment died of. ~ Sir Ronald Aylmer Fisher
The plural of anecdote is not data. ~ Roger Brinner
The combination of some data and an aching desire for an answer does not
ensure that a reasonable answer can be extracted from a given body of data.
~ John Tukey
///////////////////////////////////////////////////////////////////////////////////////////

<https://www.inbo.be>


Op vr 31 mrt 2023 om 01:11 schreef Hedyeh Ahmadi <hedyehah at usc.edu>:

> Hello all,
> I'm running a glmer() model with 3 levels where individuals are nested
> within 21 sites and each individual has 1 to 2 repeated measures. My model
> has the random effect structure (1|site/subjet_id).
>
> So I have sample sizes in glmer() output for 3 levels as follows:
> Site=21
> Subject_id:site=9334
> Total number of observations=17592
>
> I was wondering how are these sample sizes calculated in R?
>
> I was under impression that they are just unique number of site,
> subject_id, and total number of rows, for complete cases across all my
> varibles, respectively. This is true for my site and total sample sizes but
> the subject_id:site sample size is confusing me. Shouldn't this just be the
> number of unique subject ids? When I look at number rof unique ids, I get
> 9301 but the glmer() output for subject_id:site is 9334.
>
> Thank you in advance for your time.
>
>
>  Best,
>
>
> Biostatistician?
> Keck School of Medicine
> Department of Preventive Medicine
> University of Southern California
>
> LinkedIn
> www.linkedin.com/in/hedyeh-ahmadi<http://www.linkedin.com/in/hedyeh-ahmadi
> >
>
>
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>

	[[alternative HTML version deleted]]


From hedyeh@h @end|ng |rom u@c@edu  Fri Mar 31 16:59:17 2023
From: hedyeh@h @end|ng |rom u@c@edu (Hedyeh Ahmadi)
Date: Fri, 31 Mar 2023 14:59:17 +0000
Subject: [R-sig-ME] glmer() cluster sample size
In-Reply-To: <CAJuCY5zoOTS6qEO667ketxno9H_Mz=-93p8-OPOSL5sjwzyHEw@mail.gmail.com>
References: <BYAPR07MB509479BACFB6CF2A2C61CEF9D18E9@BYAPR07MB5094.namprd07.prod.outlook.com>
 <CAJuCY5zoOTS6qEO667ketxno9H_Mz=-93p8-OPOSL5sjwzyHEw@mail.gmail.com>
Message-ID: <BYAPR07MB5094CFEE407725FDB9C0E5D4D18F9@BYAPR07MB5094.namprd07.prod.outlook.com>

Thank you Thierry! That was it...

Best,

Hedyeh Ahmadi, Ph.D.
Statistician
Keck School of Medicine
Department of Preventive Medicine
University of Southern California

LinkedIn
www.linkedin.com/in/hedyeh-ahmadi<http://www.linkedin.com/in/hedyeh-ahmadi>
<http://www.linkedin.com/in/hedyeh-ahmadi><http://www.linkedin.com/in/hedyeh-ahmadi>




________________________________
From: Thierry Onkelinx <thierry.onkelinx at inbo.be>
Sent: Friday, March 31, 2023 12:42 AM
To: Hedyeh Ahmadi <hedyehah at usc.edu>
Cc: R-mixed models mailing list <r-sig-mixed-models at r-project.org>
Subject: Re: [R-sig-ME] glmer() cluster sample size

It looks like some subjects were present at multiple locations. The number of levels is the number of unique combinations of site and subject.

ir. Thierry Onkelinx
Statisticus / Statistician

Vlaamse Overheid / Government of Flanders
INSTITUUT VOOR NATUUR- EN BOSONDERZOEK / RESEARCH INSTITUTE FOR NATURE AND FOREST
Team Biometrie & Kwaliteitszorg / Team Biometrics & Quality Assurance
thierry.onkelinx at inbo.be<mailto:thierry.onkelinx at inbo.be>
Havenlaan 88 bus 73, 1000 Brussel
www.inbo.be<https://urldefense.com/v3/__http://www.inbo.be__;!!LIr3w8kk_Xxm!s82DeZaDffD94Y8Lfu4B6gDYTMqFzNSom9FgEg-ZssQkXtGjbNKvwO63igeiw4Cy1X0ZfzEgwlXuEN8EkBBFomJLhiI$>

///////////////////////////////////////////////////////////////////////////////////////////
To call in the statistician after the experiment is done may be no more than asking him to perform a post-mortem examination: he may be able to say what the experiment died of. ~ Sir Ronald Aylmer Fisher
The plural of anecdote is not data. ~ Roger Brinner
The combination of some data and an aching desire for an answer does not ensure that a reasonable answer can be extracted from a given body of data. ~ John Tukey
///////////////////////////////////////////////////////////////////////////////////////////

[https://inbo-website-prd-532750756126.s3-eu-west-1.amazonaws.com/inbologoleeuw_nl.png]<https://urldefense.com/v3/__https://www.inbo.be__;!!LIr3w8kk_Xxm!s82DeZaDffD94Y8Lfu4B6gDYTMqFzNSom9FgEg-ZssQkXtGjbNKvwO63igeiw4Cy1X0ZfzEgwlXuEN8EkBBFcESLUDE$>


Op vr 31 mrt 2023 om 01:11 schreef Hedyeh Ahmadi <hedyehah at usc.edu<mailto:hedyehah at usc.edu>>:
Hello all,
I'm running a glmer() model with 3 levels where individuals are nested within 21 sites and each individual has 1 to 2 repeated measures. My model has the random effect structure (1|site/subjet_id).

So I have sample sizes in glmer() output for 3 levels as follows:
Site=21
Subject_id:site=9334
Total number of observations=17592

I was wondering how are these sample sizes calculated in R?

I was under impression that they are just unique number of site, subject_id, and total number of rows, for complete cases across all my varibles, respectively. This is true for my site and total sample sizes but the subject_id:site sample size is confusing me. Shouldn't this just be the number of unique subject ids? When I look at number rof unique ids, I get 9301 but the glmer() output for subject_id:site is 9334.

Thank you in advance for your time.


 Best,


Biostatistician?
Keck School of Medicine
Department of Preventive Medicine
University of Southern California

LinkedIn
www.linkedin.com/in/hedyeh-ahmadi<https://urldefense.com/v3/__http://www.linkedin.com/in/hedyeh-ahmadi__;!!LIr3w8kk_Xxm!s82DeZaDffD94Y8Lfu4B6gDYTMqFzNSom9FgEg-ZssQkXtGjbNKvwO63igeiw4Cy1X0ZfzEgwlXuEN8EkBBFTiPxn6s$><http://www.linkedin.com/in/hedyeh-ahmadi<https://urldefense.com/v3/__http://www.linkedin.com/in/hedyeh-ahmadi__;!!LIr3w8kk_Xxm!s82DeZaDffD94Y8Lfu4B6gDYTMqFzNSom9FgEg-ZssQkXtGjbNKvwO63igeiw4Cy1X0ZfzEgwlXuEN8EkBBFTiPxn6s$>>



        [[alternative HTML version deleted]]

_______________________________________________
R-sig-mixed-models at r-project.org<mailto:R-sig-mixed-models at r-project.org> mailing list
https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models<https://urldefense.com/v3/__https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models__;!!LIr3w8kk_Xxm!s82DeZaDffD94Y8Lfu4B6gDYTMqFzNSom9FgEg-ZssQkXtGjbNKvwO63igeiw4Cy1X0ZfzEgwlXuEN8EkBBFyZ4Ap_w$>

	[[alternative HTML version deleted]]


