From k|m@pe@rce @end|ng |rom newc@@t|e@@c@uk  Mon Jul  1 16:59:02 2024
From: k|m@pe@rce @end|ng |rom newc@@t|e@@c@uk (Kim Pearce)
Date: Mon, 1 Jul 2024 14:59:02 +0000
Subject: [R-sig-ME] lmer function in R for linear mixed models : syntax -
 check
Message-ID: <LO0P302MB02113D68B028F77952F47855D7D32@LO0P302MB0211.GBRP302.PROD.OUTLOOK.COM>

Dear Dr Bolker,

Many thanks for verifying last week that my syntax below was appropriate when we are considering a hypothetical situation where time (level 1) is nested within patient (level 2) and our hypothetical linear mixed model included random intercepts, fixed and random slopes for one continuous predictor (time), fixed and random slopes for another continuous predictor (dose) and  q-1 fixed slopes for the q category baseline severity group:

Modely <- lmer(Y ~ time + meddose + basesevgroupf + (time + meddose | subject), data=datafile)

Or equivalently:

Modely <- lmer(Y ~ time + meddose + basesevgroupf + (1+ time + meddose | subject), data=datafile)

You mentioned, "You would end up with a 3x3 covariance matrix (variation in intercept, slope with respect to time, and effect of dose across subjects, and 3 covariances)".

Am I correct in thinking that you mean that the syntax would allow us to look at : 

1. the estimate of the variance of the random intercepts (at position 1,1 in the covariance matrix),

2. the estimate of the variance of the random slopes for time (at position 2,2 in the covariance matrix),

3. the estimate of the variance of the random slopes for dose (at position 3,3 in the covariance matrix),

4. the estimate of the covariance (correlation) between the random intercepts and random slopes for time (at position 2,1 [and 1,2 due to symmetry] in the covariance matrix),

5. the estimate of the covariance (correlation) between the random intercepts and random slopes for dose (at position 3,1 [and 1,3 due to symmetry] in the covariance matrix), and

6. the estimate of the covariance (correlation) between the random slopes for time and random slopes for dose (at position 3,2 [and 2,3 due to symmetry] in the covariance matrix).

Many thanks again, in advance, for verifying that my thoughts are correct.
Best wishes,
Kim

Dr Kim Pearce PhD, CStat, Fellow HEA
Newcastle University


From bbo|ker @end|ng |rom gm@||@com  Tue Jul  2 15:03:53 2024
From: bbo|ker @end|ng |rom gm@||@com (Ben Bolker)
Date: Tue, 2 Jul 2024 09:03:53 -0400
Subject: [R-sig-ME] 
 lmer function in R for linear mixed models : syntax - check
In-Reply-To: <LO0P302MB02113D68B028F77952F47855D7D32@LO0P302MB0211.GBRP302.PROD.OUTLOOK.COM>
References: <LO0P302MB02113D68B028F77952F47855D7D32@LO0P302MB0211.GBRP302.PROD.OUTLOOK.COM>
Message-ID: <cd781cfe-8463-4ca5-a925-3d458373a45e@gmail.com>



On 2024-07-01 10:59 a.m., Kim Pearce via R-sig-mixed-models wrote:
> Dear Dr Bolker,
> 
> Many thanks for verifying last week that my syntax below was appropriate when we are considering a hypothetical situation where time (level 1) is nested within patient (level 2) and our hypothetical linear mixed model included random intercepts, fixed and random slopes for one continuous predictor (time), fixed and random slopes for another continuous predictor (dose) and  q-1 fixed slopes for the q category baseline severity group:
> 
> Modely <- lmer(Y ~ time + meddose + basesevgroupf + (time + meddose | subject), data=datafile)
> 
> Or equivalently:
> 
> Modely <- lmer(Y ~ time + meddose + basesevgroupf + (1+ time + meddose | subject), data=datafile)
> 
> You mentioned, "You would end up with a 3x3 covariance matrix (variation in intercept, slope with respect to time, and effect of dose across subjects, and 3 covariances)".
> 
> Am I correct in thinking that you mean that the syntax would allow us to look at :
> 
> 1. the estimate of the variance of the random intercepts (at position 1,1 in the covariance matrix),
> 
> 2. the estimate of the variance of the random slopes for time (at position 2,2 in the covariance matrix),
> 
> 3. the estimate of the variance of the random slopes for dose (at position 3,3 in the covariance matrix),
> 
> 4. the estimate of the covariance (correlation) between the random intercepts and random slopes for time (at position 2,1 [and 1,2 due to symmetry] in the covariance matrix),
> 
> 5. the estimate of the covariance (correlation) between the random intercepts and random slopes for dose (at position 3,1 [and 1,3 due to symmetry] in the covariance matrix), and
> 
> 6. the estimate of the covariance (correlation) between the random slopes for time and random slopes for dose (at position 3,2 [and 2,3 due to symmetry] in the covariance matrix).

   Yes, that's right.
> 
> Many thanks again, in advance, for verifying that my thoughts are correct.
> Best wishes,
> Kim
> 
> Dr Kim Pearce PhD, CStat, Fellow HEA
> Newcastle University
> 
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models

-- 
Dr. Benjamin Bolker
Professor, Mathematics & Statistics and Biology, McMaster University
Director, School of Computational Science and Engineering
(Acting) Graduate chair, Mathematics & Statistics
 > E-mail is sent at my convenience; I don't expect replies outside of 
working hours.


From Ro@@@Boy|@n @end|ng |rom uc@|@edu  Tue Jul  2 22:15:09 2024
From: Ro@@@Boy|@n @end|ng |rom uc@|@edu (Boylan, Ross)
Date: Tue, 2 Jul 2024 20:15:09 +0000
Subject: [R-sig-ME] 
 errors building lme4 from source: Indexis not a member
 of 'lme4::lme4CholmodDecomposition...
In-Reply-To: <BY3PR05MB81164AF3A4D3880AF094213B87D12@BY3PR05MB8116.namprd05.prod.outlook.com>
References: <BY3PR05MB81164AF3A4D3880AF094213B87D12@BY3PR05MB8116.namprd05.prod.outlook.com>
Message-ID: <BY3PR05MB8116CFCE4B2DC328B6F5F15C87DC2@BY3PR05MB8116.namprd05.prod.outlook.com>

Further news on this problem below.

-----Original Message-----
From: Boylan, Ross 
Sent: Friday, June 28, 2024 8:03 PM
To: r-mixed <r-sig-mixed-models at r-project.org>
Subject: errors building lme4 from source: Indexis not a member of 'lme4::lme4CholmodDecomposition...

While trying to build lme4 from source with current master (SHA a7239d63) on MS-Windows I get the errors shown at the bottom of this message; the first one is
----------------------------------------------
lme4CholmodDecomposition.h: In instantiation of 'lme4::lme4CholmodDecomposition<_MatrixType, _UpLo>::solveInPlaceonst Eigen::MatrixBase<OtherDerived>&, int) const [with OtherDerived = Eigen::Matrix<double, -1, -1>; _MatrixType = Eigen::SparseMatrix<double, 0, int>; int _UpLo = 1]
predModule.cpp:127:37: required from here
lme4CholmodDecomposition.h:59:39:error: Indexis not a member of 'lme4::lme4CholmodDecomposition<Eigen::SparseMatrix<double, 0, int> >::Base{aka 'Eigen::CholmodDecomposition<Eigen::SparseMatrix<double, 0, int>, 1>
   59 |             eigen_assert((Base::Index)(factor()->n)ther.rows());
      |                          ~~~~~~~~~~~~~^~~~~~~~~~~~~
------------------------------------------------
which looks as if I may have some version mismatch, but I'm not sure exactly where the culprit is or what to do about it.  Any ideas?
This particular build was triggered while requesting a run of the test suite in RStudio, but I got roughly the same when doing a straight build in RStudio.
[snip]
-------------------------------------------

This seems like a repeat of the situation and error a few months ago (https://stat.ethz.ch/pipermail/r-sig-mixed-models/2024q2/030610.html), except that this time I kinda do need to build from source.  As before, installing from the tarball outside of RStudio works fine.  Installing from my development directory works fine.  One peculiarity is that 3 binaries built on the first run (from the tarball) were not built the second time around: `external.o`, `glmFamily.o`, and `optimizer.o`.

And after this (as before), building seems fine inside of RStudio.

I do not understand what is causing this behavior, and don't even have a plausible theory.

BTW with LME4_TEST_LEVEL=2 there are enough test failures (in testthat) to produce:
Error ('test-methods.R:650:3'): (code run outside of `test_that()`)
<testthat_abort_reporter/rlang_error/error/condition>
Error in `stop_reporter(c("Maximum number of failures exceeded; quitting at end of file.",
i Increase this number with (e.g.) `testthat::set_max_fails(Inf)`

Many, but not all, relate to uses of deprecated or non-existent alternatives to re.form in simulate().


From pd@|gd @end|ng |rom gm@||@com  Wed Jul  3 13:34:50 2024
From: pd@|gd @end|ng |rom gm@||@com (peter dalgaard)
Date: Wed, 3 Jul 2024 13:34:50 +0200
Subject: [R-sig-ME] 
 errors building lme4 from source: Indexis not a member
 of 'lme4::lme4CholmodDecomposition...
In-Reply-To: <BY3PR05MB8116CFCE4B2DC328B6F5F15C87DC2@BY3PR05MB8116.namprd05.prod.outlook.com>
References: <BY3PR05MB81164AF3A4D3880AF094213B87D12@BY3PR05MB8116.namprd05.prod.outlook.com>
 <BY3PR05MB8116CFCE4B2DC328B6F5F15C87DC2@BY3PR05MB8116.namprd05.prod.outlook.com>
Message-ID: <BA81D2F8-2B4A-4E90-9217-2D1AAC089083@gmail.com>

I don't _really_ have a clue here, but source installs of lme4 work fine on Mac with both R-patched and R-devel.

I have seen RStudio get confused (seemingly and on students' machines) about what has been properly installed, so perhaps try reinstalling all relevant packages from R in a terminal? (or, I think, use utils::install.packages(....) to bypass RStudio's replacement). That would be the 5 packages below, RcppEigen being my main suspect.

---
also installing the dependencies ?minqa?, ?nloptr?, ?Rcpp?, ?RcppEigen?

trying URL 'https://cloud.r-project.org/src/contrib/minqa_1.2.7.tar.gz'
Content type 'application/x-gzip' length 54344 bytes (53 KB)
==================================================
downloaded 53 KB

trying URL 'https://cloud.r-project.org/src/contrib/nloptr_2.1.1.tar.gz'
Content type 'application/x-gzip' length 2236635 bytes (2.1 MB)
==================================================
downloaded 2.1 MB

trying URL 'https://cloud.r-project.org/src/contrib/Rcpp_1.0.12.tar.gz'
Content type 'application/x-gzip' length 3430494 bytes (3.3 MB)
==================================================
downloaded 3.3 MB

trying URL 'https://cloud.r-project.org/src/contrib/RcppEigen_0.3.4.0.0.tar.gz'
Content type 'application/x-gzip' length 1765714 bytes (1.7 MB)
==================================================
downloaded 1.7 MB

trying URL 'https://cloud.r-project.org/src/contrib/lme4_1.1-35.4.tar.gz'
Content type 'application/x-gzip' length 3308646 bytes (3.2 MB)
==================================================
downloaded 3.2 MB


-pd


> On 2 Jul 2024, at 22:15 , Boylan, Ross via R-sig-mixed-models <r-sig-mixed-models at r-project.org> wrote:
> 
> Further news on this problem below.
> 
> -----Original Message-----
> From: Boylan, Ross 
> Sent: Friday, June 28, 2024 8:03 PM
> To: r-mixed <r-sig-mixed-models at r-project.org>
> Subject: errors building lme4 from source: Indexis not a member of 'lme4::lme4CholmodDecomposition...
> 
> While trying to build lme4 from source with current master (SHA a7239d63) on MS-Windows I get the errors shown at the bottom of this message; the first one is
> ----------------------------------------------
> lme4CholmodDecomposition.h: In instantiation of 'lme4::lme4CholmodDecomposition<_MatrixType, _UpLo>::solveInPlaceonst Eigen::MatrixBase<OtherDerived>&, int) const [with OtherDerived = Eigen::Matrix<double, -1, -1>; _MatrixType = Eigen::SparseMatrix<double, 0, int>; int _UpLo = 1]
> predModule.cpp:127:37: required from here
> lme4CholmodDecomposition.h:59:39:error: Indexis not a member of 'lme4::lme4CholmodDecomposition<Eigen::SparseMatrix<double, 0, int> >::Base{aka 'Eigen::CholmodDecomposition<Eigen::SparseMatrix<double, 0, int>, 1>
>   59 |             eigen_assert((Base::Index)(factor()->n)ther.rows());
>      |                          ~~~~~~~~~~~~~^~~~~~~~~~~~~
> ------------------------------------------------
> which looks as if I may have some version mismatch, but I'm not sure exactly where the culprit is or what to do about it.  Any ideas?
> This particular build was triggered while requesting a run of the test suite in RStudio, but I got roughly the same when doing a straight build in RStudio.
> [snip]
> -------------------------------------------
> 
> This seems like a repeat of the situation and error a few months ago (https://stat.ethz.ch/pipermail/r-sig-mixed-models/2024q2/030610.html), except that this time I kinda do need to build from source.  As before, installing from the tarball outside of RStudio works fine.  Installing from my development directory works fine.  One peculiarity is that 3 binaries built on the first run (from the tarball) were not built the second time around: `external.o`, `glmFamily.o`, and `optimizer.o`.
> 
> And after this (as before), building seems fine inside of RStudio.
> 
> I do not understand what is causing this behavior, and don't even have a plausible theory.
> 
> BTW with LME4_TEST_LEVEL=2 there are enough test failures (in testthat) to produce:
> Error ('test-methods.R:650:3'): (code run outside of `test_that()`)
> <testthat_abort_reporter/rlang_error/error/condition>
> Error in `stop_reporter(c("Maximum number of failures exceeded; quitting at end of file.",
> i Increase this number with (e.g.) `testthat::set_max_fails(Inf)`
> 
> Many, but not all, relate to uses of deprecated or non-existent alternatives to re.form in simulate().
> 
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models

-- 
Peter Dalgaard, Professor,
Center for Statistics, Copenhagen Business School
Solbjerg Plads 3, 2000 Frederiksberg, Denmark
Phone: (+45)38153501
Office: A 4.23
Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com


From jdpoe223 @end|ng |rom gm@||@com  Sun Jul  7 03:52:27 2024
From: jdpoe223 @end|ng |rom gm@||@com (John Poe)
Date: Sat, 6 Jul 2024 20:52:27 -0500
Subject: [R-sig-ME] nAGQ
Message-ID: <CACDpxFBrceJ8SHDCv1WhLz6Z5tYbqV9jxhBNOU5WdrH1u4bbgQ@mail.gmail.com>

Hello all,

I'm getting ready to teach multilevel modeling and am putting together some
simulations to show relative accuracy of PIRLS, Laplace, and various
numbers of quadrature points in lme4 when true random effects distributions
aren't normal. Every bit of intuition I have says that nAGQ=100 should do
better than nAGQ=11 which should be better than Laplace. Every stats
article I've ever read on the subject also agrees with that intuition.
There was some debate over if it actually matters that some solutions are
more accurate but no debate that they are or are not actually more
accurate. But that's not what's showing up.

When I fit the models and predict Empirical Bayes means I look at
histograms and they look as close to identical as possible. When I use KL
Divergence and Gateaux derivatives to test for differences in the
distributions both show very low scores meaning the distributions are very
very similar.

Furthermore, when I tried a multimodal distribution they all did a bad job
of approximation of the true random effect. The exact same bad job.

I feel like I'm taking crazy pills. The only thing I can think that makes
any sense is lme4 is overriding my choices for approximation of the random
effects in the models themselves or the calculation of the EB means is
being done the same way regardless of the model.

Any ideas?

	[[alternative HTML version deleted]]


From bbo|ker @end|ng |rom gm@||@com  Sun Jul  7 21:29:17 2024
From: bbo|ker @end|ng |rom gm@||@com (Ben Bolker)
Date: Sun, 7 Jul 2024 15:29:17 -0400
Subject: [R-sig-ME] nAGQ
In-Reply-To: <CACDpxFBrceJ8SHDCv1WhLz6Z5tYbqV9jxhBNOU5WdrH1u4bbgQ@mail.gmail.com>
References: <CACDpxFBrceJ8SHDCv1WhLz6Z5tYbqV9jxhBNOU5WdrH1u4bbgQ@mail.gmail.com>
Message-ID: <CABghstQ-8hiRvk+KEpOTksdhCyZ-aWCaW-ucNsX_tA-cA_R6Lg@mail.gmail.com>

Can you give a few more details of your simulations? E.g. response
distribution, mean of the response, cluster size?

On Sat, Jul 6, 2024, 9:52 PM John Poe <jdpoe223 at gmail.com> wrote:

> Hello all,
>
> I'm getting ready to teach multilevel modeling and am putting together some
> simulations to show relative accuracy of PIRLS, Laplace, and various
> numbers of quadrature points in lme4 when true random effects distributions
> aren't normal. Every bit of intuition I have says that nAGQ=100 should do
> better than nAGQ=11 which should be better than Laplace. Every stats
> article I've ever read on the subject also agrees with that intuition.
> There was some debate over if it actually matters that some solutions are
> more accurate but no debate that they are or are not actually more
> accurate. But that's not what's showing up.
>
> When I fit the models and predict Empirical Bayes means I look at
> histograms and they look as close to identical as possible. When I use KL
> Divergence and Gateaux derivatives to test for differences in the
> distributions both show very low scores meaning the distributions are very
> very similar.
>
> Furthermore, when I tried a multimodal distribution they all did a bad job
> of approximation of the true random effect. The exact same bad job.
>
> I feel like I'm taking crazy pills. The only thing I can think that makes
> any sense is lme4 is overriding my choices for approximation of the random
> effects in the models themselves or the calculation of the EB means is
> being done the same way regardless of the model.
>
> Any ideas?
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>

	[[alternative HTML version deleted]]


From jdpoe223 @end|ng |rom gm@||@com  Sun Jul  7 21:49:48 2024
From: jdpoe223 @end|ng |rom gm@||@com (John Poe)
Date: Sun, 7 Jul 2024 14:49:48 -0500
Subject: [R-sig-ME] nAGQ
In-Reply-To: <CABghstQ-8hiRvk+KEpOTksdhCyZ-aWCaW-ucNsX_tA-cA_R6Lg@mail.gmail.com>
References: <CACDpxFBrceJ8SHDCv1WhLz6Z5tYbqV9jxhBNOU5WdrH1u4bbgQ@mail.gmail.com>
 <CABghstQ-8hiRvk+KEpOTksdhCyZ-aWCaW-ucNsX_tA-cA_R6Lg@mail.gmail.com>
Message-ID: <CACDpxFB2+pYFOp9j2khSDMEc8TPE-OH_XBSKQ6Wg-MZfeLAneA@mail.gmail.com>

Sure,

I wrote several different random effects distributions based mostly on
mixtures of normals. The main idea was that I was trying to break anything
that would assume normality of the random effects when trying to
approximate them.

One of the worst cases I could come up with was a random effect
distribution that had two modes surrounding the mean, one mode was for a
normal distribution and one was for a weibull with a long tail. So both
asymmetrical and multimodal.

All of the simulations had 5000 groups with 500 observations per group and
a binary outcome. I wanted to avoid shrinkage problems or distortions from
too few groups.

I used lme4 to fit the models and extract random effects estimates.


On Sun, Jul 7, 2024, 2:29?PM Ben Bolker <bbolker at gmail.com> wrote:

> Can you give a few more details of your simulations? E.g. response
> distribution, mean of the response, cluster size?
>
> On Sat, Jul 6, 2024, 9:52 PM John Poe <jdpoe223 at gmail.com> wrote:
>
>> Hello all,
>>
>> I'm getting ready to teach multilevel modeling and am putting together
>> some
>> simulations to show relative accuracy of PIRLS, Laplace, and various
>> numbers of quadrature points in lme4 when true random effects
>> distributions
>> aren't normal. Every bit of intuition I have says that nAGQ=100 should do
>> better than nAGQ=11 which should be better than Laplace. Every stats
>> article I've ever read on the subject also agrees with that intuition.
>> There was some debate over if it actually matters that some solutions are
>> more accurate but no debate that they are or are not actually more
>> accurate. But that's not what's showing up.
>>
>> When I fit the models and predict Empirical Bayes means I look at
>> histograms and they look as close to identical as possible. When I use KL
>> Divergence and Gateaux derivatives to test for differences in the
>> distributions both show very low scores meaning the distributions are very
>> very similar.
>>
>> Furthermore, when I tried a multimodal distribution they all did a bad job
>> of approximation of the true random effect. The exact same bad job.
>>
>> I feel like I'm taking crazy pills. The only thing I can think that makes
>> any sense is lme4 is overriding my choices for approximation of the random
>> effects in the models themselves or the calculation of the EB means is
>> being done the same way regardless of the model.
>>
>> Any ideas?
>>
>>         [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-mixed-models at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>
>

	[[alternative HTML version deleted]]


From bbo|ker @end|ng |rom gm@||@com  Sun Jul  7 21:58:31 2024
From: bbo|ker @end|ng |rom gm@||@com (Ben Bolker)
Date: Sun, 7 Jul 2024 15:58:31 -0400
Subject: [R-sig-ME] nAGQ
In-Reply-To: <CACDpxFB2+pYFOp9j2khSDMEc8TPE-OH_XBSKQ6Wg-MZfeLAneA@mail.gmail.com>
References: <CACDpxFBrceJ8SHDCv1WhLz6Z5tYbqV9jxhBNOU5WdrH1u4bbgQ@mail.gmail.com>
 <CABghstQ-8hiRvk+KEpOTksdhCyZ-aWCaW-ucNsX_tA-cA_R6Lg@mail.gmail.com>
 <CACDpxFB2+pYFOp9j2khSDMEc8TPE-OH_XBSKQ6Wg-MZfeLAneA@mail.gmail.com>
Message-ID: <CABghstQRD4Cmsa-wKy9VU3O4M4FgTnHBVUiB_KZCmDm+W=PA9w@mail.gmail.com>

In lme4 the agq stuff is only for GLMMs, ie for glmer not lmer. I'm not
sure of the theory in your case ...

On Sun, Jul 7, 2024, 3:50 PM John Poe <jdpoe223 at gmail.com> wrote:

> Sure,
>
> I wrote several different random effects distributions based mostly on
> mixtures of normals. The main idea was that I was trying to break anything
> that would assume normality of the random effects when trying to
> approximate them.
>
> One of the worst cases I could come up with was a random effect
> distribution that had two modes surrounding the mean, one mode was for a
> normal distribution and one was for a weibull with a long tail. So both
> asymmetrical and multimodal.
>
> All of the simulations had 5000 groups with 500 observations per group and
> a binary outcome. I wanted to avoid shrinkage problems or distortions from
> too few groups.
>
> I used lme4 to fit the models and extract random effects estimates.
>
>
> On Sun, Jul 7, 2024, 2:29?PM Ben Bolker <bbolker at gmail.com> wrote:
>
>> Can you give a few more details of your simulations? E.g. response
>> distribution, mean of the response, cluster size?
>>
>> On Sat, Jul 6, 2024, 9:52 PM John Poe <jdpoe223 at gmail.com> wrote:
>>
>>> Hello all,
>>>
>>> I'm getting ready to teach multilevel modeling and am putting together
>>> some
>>> simulations to show relative accuracy of PIRLS, Laplace, and various
>>> numbers of quadrature points in lme4 when true random effects
>>> distributions
>>> aren't normal. Every bit of intuition I have says that nAGQ=100 should do
>>> better than nAGQ=11 which should be better than Laplace. Every stats
>>> article I've ever read on the subject also agrees with that intuition.
>>> There was some debate over if it actually matters that some solutions are
>>> more accurate but no debate that they are or are not actually more
>>> accurate. But that's not what's showing up.
>>>
>>> When I fit the models and predict Empirical Bayes means I look at
>>> histograms and they look as close to identical as possible. When I use KL
>>> Divergence and Gateaux derivatives to test for differences in the
>>> distributions both show very low scores meaning the distributions are
>>> very
>>> very similar.
>>>
>>> Furthermore, when I tried a multimodal distribution they all did a bad
>>> job
>>> of approximation of the true random effect. The exact same bad job.
>>>
>>> I feel like I'm taking crazy pills. The only thing I can think that makes
>>> any sense is lme4 is overriding my choices for approximation of the
>>> random
>>> effects in the models themselves or the calculation of the EB means is
>>> being done the same way regardless of the model.
>>>
>>> Any ideas?
>>>
>>>         [[alternative HTML version deleted]]
>>>
>>> _______________________________________________
>>> R-sig-mixed-models at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>
>>

	[[alternative HTML version deleted]]


From jdpoe223 @end|ng |rom gm@||@com  Sun Jul  7 22:21:54 2024
From: jdpoe223 @end|ng |rom gm@||@com (John Poe)
Date: Sun, 7 Jul 2024 15:21:54 -0500
Subject: [R-sig-ME] nAGQ
In-Reply-To: <CABghstQRD4Cmsa-wKy9VU3O4M4FgTnHBVUiB_KZCmDm+W=PA9w@mail.gmail.com>
References: <CACDpxFBrceJ8SHDCv1WhLz6Z5tYbqV9jxhBNOU5WdrH1u4bbgQ@mail.gmail.com>
 <CABghstQ-8hiRvk+KEpOTksdhCyZ-aWCaW-ucNsX_tA-cA_R6Lg@mail.gmail.com>
 <CACDpxFB2+pYFOp9j2khSDMEc8TPE-OH_XBSKQ6Wg-MZfeLAneA@mail.gmail.com>
 <CABghstQRD4Cmsa-wKy9VU3O4M4FgTnHBVUiB_KZCmDm+W=PA9w@mail.gmail.com>
Message-ID: <CACDpxFCn_W-3qeQsXkjZCTy4gghFjOy6k8+v2R056rHT2KEOCg@mail.gmail.com>

Yes it's using glmer and not lmer. It's comparing Laplace, AGQ= 7, 11, 51,
and 101 quadrature points compared to the true distribution. Laplace and
the lower values of agq should perform poorly because they are banking on
normality. Higher levels of agq should be more accurate

On Sun, Jul 7, 2024, 2:58?PM Ben Bolker <bbolker at gmail.com> wrote:

> In lme4 the agq stuff is only for GLMMs, ie for glmer not lmer. I'm not
> sure of the theory in your case ...
>
> On Sun, Jul 7, 2024, 3:50 PM John Poe <jdpoe223 at gmail.com> wrote:
>
>> Sure,
>>
>> I wrote several different random effects distributions based mostly on
>> mixtures of normals. The main idea was that I was trying to break anything
>> that would assume normality of the random effects when trying to
>> approximate them.
>>
>> One of the worst cases I could come up with was a random effect
>> distribution that had two modes surrounding the mean, one mode was for a
>> normal distribution and one was for a weibull with a long tail. So both
>> asymmetrical and multimodal.
>>
>> All of the simulations had 5000 groups with 500 observations per group
>> and a binary outcome. I wanted to avoid shrinkage problems or distortions
>> from too few groups.
>>
>> I used lme4 to fit the models and extract random effects estimates.
>>
>>
>> On Sun, Jul 7, 2024, 2:29?PM Ben Bolker <bbolker at gmail.com> wrote:
>>
>>> Can you give a few more details of your simulations? E.g. response
>>> distribution, mean of the response, cluster size?
>>>
>>> On Sat, Jul 6, 2024, 9:52 PM John Poe <jdpoe223 at gmail.com> wrote:
>>>
>>>> Hello all,
>>>>
>>>> I'm getting ready to teach multilevel modeling and am putting together
>>>> some
>>>> simulations to show relative accuracy of PIRLS, Laplace, and various
>>>> numbers of quadrature points in lme4 when true random effects
>>>> distributions
>>>> aren't normal. Every bit of intuition I have says that nAGQ=100 should
>>>> do
>>>> better than nAGQ=11 which should be better than Laplace. Every stats
>>>> article I've ever read on the subject also agrees with that intuition.
>>>> There was some debate over if it actually matters that some solutions
>>>> are
>>>> more accurate but no debate that they are or are not actually more
>>>> accurate. But that's not what's showing up.
>>>>
>>>> When I fit the models and predict Empirical Bayes means I look at
>>>> histograms and they look as close to identical as possible. When I use
>>>> KL
>>>> Divergence and Gateaux derivatives to test for differences in the
>>>> distributions both show very low scores meaning the distributions are
>>>> very
>>>> very similar.
>>>>
>>>> Furthermore, when I tried a multimodal distribution they all did a bad
>>>> job
>>>> of approximation of the true random effect. The exact same bad job.
>>>>
>>>> I feel like I'm taking crazy pills. The only thing I can think that
>>>> makes
>>>> any sense is lme4 is overriding my choices for approximation of the
>>>> random
>>>> effects in the models themselves or the calculation of the EB means is
>>>> being done the same way regardless of the model.
>>>>
>>>> Any ideas?
>>>>
>>>>         [[alternative HTML version deleted]]
>>>>
>>>> _______________________________________________
>>>> R-sig-mixed-models at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>>
>>>

	[[alternative HTML version deleted]]


From d@r|zopou|o@ @end|ng |rom er@@mu@mc@n|  Sun Jul  7 22:27:04 2024
From: d@r|zopou|o@ @end|ng |rom er@@mu@mc@n| (Dimitris Rizopoulos)
Date: Sun, 7 Jul 2024 20:27:04 +0000
Subject: [R-sig-ME] nAGQ
In-Reply-To: <CACDpxFCn_W-3qeQsXkjZCTy4gghFjOy6k8+v2R056rHT2KEOCg@mail.gmail.com>
References: <CACDpxFBrceJ8SHDCv1WhLz6Z5tYbqV9jxhBNOU5WdrH1u4bbgQ@mail.gmail.com>
 <CABghstQ-8hiRvk+KEpOTksdhCyZ-aWCaW-ucNsX_tA-cA_R6Lg@mail.gmail.com>
 <CACDpxFB2+pYFOp9j2khSDMEc8TPE-OH_XBSKQ6Wg-MZfeLAneA@mail.gmail.com>
 <CABghstQRD4Cmsa-wKy9VU3O4M4FgTnHBVUiB_KZCmDm+W=PA9w@mail.gmail.com>
 <CACDpxFCn_W-3qeQsXkjZCTy4gghFjOy6k8+v2R056rHT2KEOCg@mail.gmail.com>
Message-ID: <DU0PR04MB93718DAF3D10831E07700BF6E8D92@DU0PR04MB9371.eurprd04.prod.outlook.com>

As the number of measurements per group increases, the conditional distribution of the random effects given the observed data (i.e., the posterior of the random effects) converges to a normal distribution, even if the marginal distribution of the random effects (prior) is not normal. See some arguments regarding this here for the related class of shared parameter models: https://doi.org/10.1093/biomet/asm087



??
Dimitris Rizopoulos
Professor of Biostatistics
Erasmus University Medical Center
The Netherlands
________________________________
From: R-sig-mixed-models <r-sig-mixed-models-bounces at r-project.org> on behalf of John Poe <jdpoe223 at gmail.com>
Sent: Sunday, July 7, 2024 10:21:54 PM
To: Ben Bolker <bbolker at gmail.com>
Cc: R SIG Mixed Models <r-sig-mixed-models at r-project.org>
Subject: Re: [R-sig-ME] nAGQ



Waarschuwing: Deze e-mail is afkomstig van buiten de organisatie. Klik niet op links en open geen bijlagen, tenzij u de afzender herkent en weet dat de inhoud veilig is.
Caution: This email originated from outside of the organization. Do not click links or open attachments unless you recognize the sender and know the content is safe.



Yes it's using glmer and not lmer. It's comparing Laplace, AGQ= 7, 11, 51,
and 101 quadrature points compared to the true distribution. Laplace and
the lower values of agq should perform poorly because they are banking on
normality. Higher levels of agq should be more accurate

On Sun, Jul 7, 2024, 2:58?PM Ben Bolker <bbolker at gmail.com> wrote:

> In lme4 the agq stuff is only for GLMMs, ie for glmer not lmer. I'm not
> sure of the theory in your case ...
>
> On Sun, Jul 7, 2024, 3:50 PM John Poe <jdpoe223 at gmail.com> wrote:
>
>> Sure,
>>
>> I wrote several different random effects distributions based mostly on
>> mixtures of normals. The main idea was that I was trying to break anything
>> that would assume normality of the random effects when trying to
>> approximate them.
>>
>> One of the worst cases I could come up with was a random effect
>> distribution that had two modes surrounding the mean, one mode was for a
>> normal distribution and one was for a weibull with a long tail. So both
>> asymmetrical and multimodal.
>>
>> All of the simulations had 5000 groups with 500 observations per group
>> and a binary outcome. I wanted to avoid shrinkage problems or distortions
>> from too few groups.
>>
>> I used lme4 to fit the models and extract random effects estimates.
>>
>>
>> On Sun, Jul 7, 2024, 2:29?PM Ben Bolker <bbolker at gmail.com> wrote:
>>
>>> Can you give a few more details of your simulations? E.g. response
>>> distribution, mean of the response, cluster size?
>>>
>>> On Sat, Jul 6, 2024, 9:52 PM John Poe <jdpoe223 at gmail.com> wrote:
>>>
>>>> Hello all,
>>>>
>>>> I'm getting ready to teach multilevel modeling and am putting together
>>>> some
>>>> simulations to show relative accuracy of PIRLS, Laplace, and various
>>>> numbers of quadrature points in lme4 when true random effects
>>>> distributions
>>>> aren't normal. Every bit of intuition I have says that nAGQ=100 should
>>>> do
>>>> better than nAGQ=11 which should be better than Laplace. Every stats
>>>> article I've ever read on the subject also agrees with that intuition.
>>>> There was some debate over if it actually matters that some solutions
>>>> are
>>>> more accurate but no debate that they are or are not actually more
>>>> accurate. But that's not what's showing up.
>>>>
>>>> When I fit the models and predict Empirical Bayes means I look at
>>>> histograms and they look as close to identical as possible. When I use
>>>> KL
>>>> Divergence and Gateaux derivatives to test for differences in the
>>>> distributions both show very low scores meaning the distributions are
>>>> very
>>>> very similar.
>>>>
>>>> Furthermore, when I tried a multimodal distribution they all did a bad
>>>> job
>>>> of approximation of the true random effect. The exact same bad job.
>>>>
>>>> I feel like I'm taking crazy pills. The only thing I can think that
>>>> makes
>>>> any sense is lme4 is overriding my choices for approximation of the
>>>> random
>>>> effects in the models themselves or the calculation of the EB means is
>>>> being done the same way regardless of the model.
>>>>
>>>> Any ideas?
>>>>
>>>>         [[alternative HTML version deleted]]
>>>>
>>>> _______________________________________________
>>>> R-sig-mixed-models at r-project.org mailing list
>>>> https://eur01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-sig-mixed-models&data=05%7C02%7Cd.rizopoulos%40erasmusmc.nl%7C944400495b934967798d08dc9ec287e8%7C526638ba6af34b0fa532a1a511f4ac80%7C0%7C0%7C638559805545437911%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C0%7C%7C%7C&sdata=4Sy9PJ1rfelxECCIj2e5%2BohcBR%2BPs8Y4%2FWZaWo%2FRIlo%3D&reserved=0<https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>>>>
>>>

        [[alternative HTML version deleted]]

_______________________________________________
R-sig-mixed-models at r-project.org mailing list
https://eur01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-sig-mixed-models&data=05%7C02%7Cd.rizopoulos%40erasmusmc.nl%7C944400495b934967798d08dc9ec287e8%7C526638ba6af34b0fa532a1a511f4ac80%7C0%7C0%7C638559805545447242%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C0%7C%7C%7C&sdata=Yc6LVvQgHO%2FnlQxVBs2fT1VcTVU%2Bo3nuDo6EZHep9GU%3D&reserved=0<https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>

	[[alternative HTML version deleted]]


From bbo|ker @end|ng |rom gm@||@com  Sun Jul  7 23:25:59 2024
From: bbo|ker @end|ng |rom gm@||@com (Ben Bolker)
Date: Sun, 7 Jul 2024 17:25:59 -0400
Subject: [R-sig-ME] nAGQ
In-Reply-To: <DU0PR04MB93718DAF3D10831E07700BF6E8D92@DU0PR04MB9371.eurprd04.prod.outlook.com>
References: <CACDpxFBrceJ8SHDCv1WhLz6Z5tYbqV9jxhBNOU5WdrH1u4bbgQ@mail.gmail.com>
 <CABghstQ-8hiRvk+KEpOTksdhCyZ-aWCaW-ucNsX_tA-cA_R6Lg@mail.gmail.com>
 <CACDpxFB2+pYFOp9j2khSDMEc8TPE-OH_XBSKQ6Wg-MZfeLAneA@mail.gmail.com>
 <CABghstQRD4Cmsa-wKy9VU3O4M4FgTnHBVUiB_KZCmDm+W=PA9w@mail.gmail.com>
 <CACDpxFCn_W-3qeQsXkjZCTy4gghFjOy6k8+v2R056rHT2KEOCg@mail.gmail.com>
 <DU0PR04MB93718DAF3D10831E07700BF6E8D92@DU0PR04MB9371.eurprd04.prod.outlook.com>
Message-ID: <CABghstTygezHa2e9nRKJCPkr0pXG9Yd-Rv9zV_pjr+kSmyHhuQ@mail.gmail.com>

John, try your examples in GLMMadaptive, which has an independent
implementation of AGQ

On Sun, Jul 7, 2024, 4:27 PM Dimitris Rizopoulos <d.rizopoulos at erasmusmc.nl>
wrote:

> As the number of measurements per group increases, the conditional distribution
> of the random effects given the observed data (i.e., the posterior of the
> random effects) converges to a normal distribution, even if the marginal
> distribution of the random effects (prior) is not normal. See some
> arguments regarding this here for the related class of shared parameter
> models: https://doi.org/10.1093/biomet/asm087
>
>
>
> ??
> Dimitris Rizopoulos
> Professor of Biostatistics
> Erasmus University Medical Center
> The Netherlands
> ------------------------------
> *From:* R-sig-mixed-models <r-sig-mixed-models-bounces at r-project.org> on
> behalf of John Poe <jdpoe223 at gmail.com>
> *Sent:* Sunday, July 7, 2024 10:21:54 PM
> *To:* Ben Bolker <bbolker at gmail.com>
> *Cc:* R SIG Mixed Models <r-sig-mixed-models at r-project.org>
> *Subject:* Re: [R-sig-ME] nAGQ
>
>
>
> Waarschuwing: Deze e-mail is afkomstig van buiten de organisatie. Klik
> niet op links en open geen bijlagen, tenzij u de afzender herkent en weet
> dat de inhoud veilig is.
> Caution: This email originated from outside of the organization. Do not
> click links or open attachments unless you recognize the sender and know
> the content is safe.
>
>
>
> Yes it's using glmer and not lmer. It's comparing Laplace, AGQ= 7, 11, 51,
> and 101 quadrature points compared to the true distribution. Laplace and
> the lower values of agq should perform poorly because they are banking on
> normality. Higher levels of agq should be more accurate
>
> On Sun, Jul 7, 2024, 2:58?PM Ben Bolker <bbolker at gmail.com> wrote:
>
> > In lme4 the agq stuff is only for GLMMs, ie for glmer not lmer. I'm not
> > sure of the theory in your case ...
> >
> > On Sun, Jul 7, 2024, 3:50 PM John Poe <jdpoe223 at gmail.com> wrote:
> >
> >> Sure,
> >>
> >> I wrote several different random effects distributions based mostly on
> >> mixtures of normals. The main idea was that I was trying to break
> anything
> >> that would assume normality of the random effects when trying to
> >> approximate them.
> >>
> >> One of the worst cases I could come up with was a random effect
> >> distribution that had two modes surrounding the mean, one mode was for a
> >> normal distribution and one was for a weibull with a long tail. So both
> >> asymmetrical and multimodal.
> >>
> >> All of the simulations had 5000 groups with 500 observations per group
> >> and a binary outcome. I wanted to avoid shrinkage problems or
> distortions
> >> from too few groups.
> >>
> >> I used lme4 to fit the models and extract random effects estimates.
> >>
> >>
> >> On Sun, Jul 7, 2024, 2:29?PM Ben Bolker <bbolker at gmail.com> wrote:
> >>
> >>> Can you give a few more details of your simulations? E.g. response
> >>> distribution, mean of the response, cluster size?
> >>>
> >>> On Sat, Jul 6, 2024, 9:52 PM John Poe <jdpoe223 at gmail.com> wrote:
> >>>
> >>>> Hello all,
> >>>>
> >>>> I'm getting ready to teach multilevel modeling and am putting together
> >>>> some
> >>>> simulations to show relative accuracy of PIRLS, Laplace, and various
> >>>> numbers of quadrature points in lme4 when true random effects
> >>>> distributions
> >>>> aren't normal. Every bit of intuition I have says that nAGQ=100 should
> >>>> do
> >>>> better than nAGQ=11 which should be better than Laplace. Every stats
> >>>> article I've ever read on the subject also agrees with that intuition.
> >>>> There was some debate over if it actually matters that some solutions
> >>>> are
> >>>> more accurate but no debate that they are or are not actually more
> >>>> accurate. But that's not what's showing up.
> >>>>
> >>>> When I fit the models and predict Empirical Bayes means I look at
> >>>> histograms and they look as close to identical as possible. When I use
> >>>> KL
> >>>> Divergence and Gateaux derivatives to test for differences in the
> >>>> distributions both show very low scores meaning the distributions are
> >>>> very
> >>>> very similar.
> >>>>
> >>>> Furthermore, when I tried a multimodal distribution they all did a bad
> >>>> job
> >>>> of approximation of the true random effect. The exact same bad job.
> >>>>
> >>>> I feel like I'm taking crazy pills. The only thing I can think that
> >>>> makes
> >>>> any sense is lme4 is overriding my choices for approximation of the
> >>>> random
> >>>> effects in the models themselves or the calculation of the EB means is
> >>>> being done the same way regardless of the model.
> >>>>
> >>>> Any ideas?
> >>>>
> >>>>         [[alternative HTML version deleted]]
> >>>>
> >>>> _______________________________________________
> >>>> R-sig-mixed-models at r-project.org mailing list
> >>>>
> https://eur01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-sig-mixed-models&data=05%7C02%7Cd.rizopoulos%40erasmusmc.nl%7C944400495b934967798d08dc9ec287e8%7C526638ba6af34b0fa532a1a511f4ac80%7C0%7C0%7C638559805545437911%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C0%7C%7C%7C&sdata=4Sy9PJ1rfelxECCIj2e5%2BohcBR%2BPs8Y4%2FWZaWo%2FRIlo%3D&reserved=0
> <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
> >>>>
> >>>
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
>
> https://eur01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-sig-mixed-models&data=05%7C02%7Cd.rizopoulos%40erasmusmc.nl%7C944400495b934967798d08dc9ec287e8%7C526638ba6af34b0fa532a1a511f4ac80%7C0%7C0%7C638559805545447242%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C0%7C%7C%7C&sdata=Yc6LVvQgHO%2FnlQxVBs2fT1VcTVU%2Bo3nuDo6EZHep9GU%3D&reserved=0
> <https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models>
>

	[[alternative HTML version deleted]]


From dmb@te@ @end|ng |rom gm@||@com  Mon Jul  8 00:01:52 2024
From: dmb@te@ @end|ng |rom gm@||@com (Douglas Bates)
Date: Sun, 7 Jul 2024 17:01:52 -0500
Subject: [R-sig-ME] nAGQ
In-Reply-To: <CABghstTygezHa2e9nRKJCPkr0pXG9Yd-Rv9zV_pjr+kSmyHhuQ@mail.gmail.com>
References: <CACDpxFBrceJ8SHDCv1WhLz6Z5tYbqV9jxhBNOU5WdrH1u4bbgQ@mail.gmail.com>
 <CABghstQ-8hiRvk+KEpOTksdhCyZ-aWCaW-ucNsX_tA-cA_R6Lg@mail.gmail.com>
 <CACDpxFB2+pYFOp9j2khSDMEc8TPE-OH_XBSKQ6Wg-MZfeLAneA@mail.gmail.com>
 <CABghstQRD4Cmsa-wKy9VU3O4M4FgTnHBVUiB_KZCmDm+W=PA9w@mail.gmail.com>
 <CACDpxFCn_W-3qeQsXkjZCTy4gghFjOy6k8+v2R056rHT2KEOCg@mail.gmail.com>
 <DU0PR04MB93718DAF3D10831E07700BF6E8D92@DU0PR04MB9371.eurprd04.prod.outlook.com>
 <CABghstTygezHa2e9nRKJCPkr0pXG9Yd-Rv9zV_pjr+kSmyHhuQ@mail.gmail.com>
Message-ID: <CAO7JsnTLpw3e16+o=gvLDJ0vf5rtgu6YDKJ3mFU3QSUx1NMpTQ@mail.gmail.com>

I agree with Dimitris.  Adaptive Gauss-Hermite quadrature is used to
approximate the integral of the conditional density of a random effect
given the observed data.  We go into some detail about the model and the
derivation of the integral in question in
https://embraceuncertaintybook.com/aGHQ.html.

With 500 binary observations for each of 5000 groups, the integral in
question will be very close to a scaled Gaussian density, and the Laplace
approximation will be more than adequate. I am not surprised that there are
almost no differences between the results from the Laplace approximation
and AGQ of different orders.  Bear in mind that, for high orders, the
weights drop dramatically for evaluations far from the mode of the
conditional distribution (see Fig. C1 and C2 in the above-mentioned book
for the case of nAGQ = 9).  For very large order, the Golub-Welsch
algorithm, which IIRC is the way the weights and abscissae for the
Gauss-Hermite rule are calculated in lme4, the weights for the remote
evaluations are actually zero.

The table of abscissae and weights for nAGQ=31 is enclosed.  You can see
that when you get beyond three or four standard deviations from the mean
(or "six sigma" for the Quality Control crowd) the additional evaluations
have very little effects on the value of the integral.

Is your simulation based on observed data or an actual study or
experiment?  I have never seen cases of that many observations per group,
especially over that number of groups.



On Sun, Jul 7, 2024 at 4:26?PM Ben Bolker <bbolker at gmail.com> wrote:

> John, try your examples in GLMMadaptive, which has an independent
> implementation of AGQ
>
> On Sun, Jul 7, 2024, 4:27 PM Dimitris Rizopoulos <
> d.rizopoulos at erasmusmc.nl>
> wrote:
>
> > As the number of measurements per group increases, the conditional
> distribution
> > of the random effects given the observed data (i.e., the posterior of the
> > random effects) converges to a normal distribution, even if the marginal
> > distribution of the random effects (prior) is not normal. See some
> > arguments regarding this here for the related class of shared parameter
> > models:
> https://urldefense.com/v3/__https://doi.org/10.1093/biomet/asm087__;!!Mak6IKo!JrToKq8wzb4OYiltJrxwAmplpWDJaRXkp4uKzXw5l6XPUbk7gQyfp8JvujOW1T129jeDr7G_AgblagIO$
> >
> >
> >
> > ??
> > Dimitris Rizopoulos
> > Professor of Biostatistics
> > Erasmus University Medical Center
> > The Netherlands
> > ------------------------------
> > *From:* R-sig-mixed-models <r-sig-mixed-models-bounces at r-project.org> on
> > behalf of John Poe <jdpoe223 at gmail.com>
> > *Sent:* Sunday, July 7, 2024 10:21:54 PM
> > *To:* Ben Bolker <bbolker at gmail.com>
> > *Cc:* R SIG Mixed Models <r-sig-mixed-models at r-project.org>
> > *Subject:* Re: [R-sig-ME] nAGQ
> >
> >
> >
> > Waarschuwing: Deze e-mail is afkomstig van buiten de organisatie. Klik
> > niet op links en open geen bijlagen, tenzij u de afzender herkent en weet
> > dat de inhoud veilig is.
> > Caution: This email originated from outside of the organization. Do not
> > click links or open attachments unless you recognize the sender and know
> > the content is safe.
> >
> >
> >
> > Yes it's using glmer and not lmer. It's comparing Laplace, AGQ= 7, 11,
> 51,
> > and 101 quadrature points compared to the true distribution. Laplace and
> > the lower values of agq should perform poorly because they are banking on
> > normality. Higher levels of agq should be more accurate
> >
> > On Sun, Jul 7, 2024, 2:58?PM Ben Bolker <bbolker at gmail.com> wrote:
> >
> > > In lme4 the agq stuff is only for GLMMs, ie for glmer not lmer. I'm not
> > > sure of the theory in your case ...
> > >
> > > On Sun, Jul 7, 2024, 3:50 PM John Poe <jdpoe223 at gmail.com> wrote:
> > >
> > >> Sure,
> > >>
> > >> I wrote several different random effects distributions based mostly on
> > >> mixtures of normals. The main idea was that I was trying to break
> > anything
> > >> that would assume normality of the random effects when trying to
> > >> approximate them.
> > >>
> > >> One of the worst cases I could come up with was a random effect
> > >> distribution that had two modes surrounding the mean, one mode was
> for a
> > >> normal distribution and one was for a weibull with a long tail. So
> both
> > >> asymmetrical and multimodal.
> > >>
> > >> All of the simulations had 5000 groups with 500 observations per group
> > >> and a binary outcome. I wanted to avoid shrinkage problems or
> > distortions
> > >> from too few groups.
> > >>
> > >> I used lme4 to fit the models and extract random effects estimates.
> > >>
> > >>
> > >> On Sun, Jul 7, 2024, 2:29?PM Ben Bolker <bbolker at gmail.com> wrote:
> > >>
> > >>> Can you give a few more details of your simulations? E.g. response
> > >>> distribution, mean of the response, cluster size?
> > >>>
> > >>> On Sat, Jul 6, 2024, 9:52 PM John Poe <jdpoe223 at gmail.com> wrote:
> > >>>
> > >>>> Hello all,
> > >>>>
> > >>>> I'm getting ready to teach multilevel modeling and am putting
> together
> > >>>> some
> > >>>> simulations to show relative accuracy of PIRLS, Laplace, and various
> > >>>> numbers of quadrature points in lme4 when true random effects
> > >>>> distributions
> > >>>> aren't normal. Every bit of intuition I have says that nAGQ=100
> should
> > >>>> do
> > >>>> better than nAGQ=11 which should be better than Laplace. Every stats
> > >>>> article I've ever read on the subject also agrees with that
> intuition.
> > >>>> There was some debate over if it actually matters that some
> solutions
> > >>>> are
> > >>>> more accurate but no debate that they are or are not actually more
> > >>>> accurate. But that's not what's showing up.
> > >>>>
> > >>>> When I fit the models and predict Empirical Bayes means I look at
> > >>>> histograms and they look as close to identical as possible. When I
> use
> > >>>> KL
> > >>>> Divergence and Gateaux derivatives to test for differences in the
> > >>>> distributions both show very low scores meaning the distributions
> are
> > >>>> very
> > >>>> very similar.
> > >>>>
> > >>>> Furthermore, when I tried a multimodal distribution they all did a
> bad
> > >>>> job
> > >>>> of approximation of the true random effect. The exact same bad job.
> > >>>>
> > >>>> I feel like I'm taking crazy pills. The only thing I can think that
> > >>>> makes
> > >>>> any sense is lme4 is overriding my choices for approximation of the
> > >>>> random
> > >>>> effects in the models themselves or the calculation of the EB means
> is
> > >>>> being done the same way regardless of the model.
> > >>>>
> > >>>> Any ideas?
> > >>>>
> > >>>>         [[alternative HTML version deleted]]
> > >>>>
> > >>>> _______________________________________________
> > >>>> R-sig-mixed-models at r-project.org mailing list
> > >>>>
> >
> https://urldefense.com/v3/__https://eur01.safelinks.protection.outlook.com/?url=https*3A*2F*2Fstat.ethz.ch*2Fmailman*2Flistinfo*2Fr-sig-mixed-models&data=05*7C02*7Cd.rizopoulos*40erasmusmc.nl*7C944400495b934967798d08dc9ec287e8*7C526638ba6af34b0fa532a1a511f4ac80*7C0*7C0*7C638559805545437911*7CUnknown*7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0*3D*7C0*7C*7C*7C&sdata=4Sy9PJ1rfelxECCIj2e5*2BohcBR*2BPs8Y4*2FWZaWo*2FRIlo*3D&reserved=0__;JSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSU!!Mak6IKo!JrToKq8wzb4OYiltJrxwAmplpWDJaRXkp4uKzXw5l6XPUbk7gQyfp8JvujOW1T129jeDr7G_Am-RRW73$
> > <
> https://urldefense.com/v3/__https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models__;!!Mak6IKo!JrToKq8wzb4OYiltJrxwAmplpWDJaRXkp4uKzXw5l6XPUbk7gQyfp8JvujOW1T129jeDr7G_Ai78aaVB$
> >
> > >>>>
> > >>>
> >
> >         [[alternative HTML version deleted]]
> >
> > _______________________________________________
> > R-sig-mixed-models at r-project.org mailing list
> >
> >
> https://urldefense.com/v3/__https://eur01.safelinks.protection.outlook.com/?url=https*3A*2F*2Fstat.ethz.ch*2Fmailman*2Flistinfo*2Fr-sig-mixed-models&data=05*7C02*7Cd.rizopoulos*40erasmusmc.nl*7C944400495b934967798d08dc9ec287e8*7C526638ba6af34b0fa532a1a511f4ac80*7C0*7C0*7C638559805545447242*7CUnknown*7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0*3D*7C0*7C*7C*7C&sdata=Yc6LVvQgHO*2FnlQxVBs2fT1VcTVU*2Bo3nuDo6EZHep9GU*3D&reserved=0__;JSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUl!!Mak6IKo!JrToKq8wzb4OYiltJrxwAmplpWDJaRXkp4uKzXw5l6XPUbk7gQyfp8JvujOW1T129jeDr7G_ApcVz5SI$
> > <
> https://urldefense.com/v3/__https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models__;!!Mak6IKo!JrToKq8wzb4OYiltJrxwAmplpWDJaRXkp4uKzXw5l6XPUbk7gQyfp8JvujOW1T129jeDr7G_Ai78aaVB$
> >
> >
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
>
> https://urldefense.com/v3/__https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models__;!!Mak6IKo!JrToKq8wzb4OYiltJrxwAmplpWDJaRXkp4uKzXw5l6XPUbk7gQyfp8JvujOW1T129jeDr7G_Ai78aaVB$
>

-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: nAGQ31.txt
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20240707/1f1da261/attachment.txt>

From gb@guerom@|ne @end|ng |rom gm@||@com  Sat Jul 13 12:30:11 2024
From: gb@guerom@|ne @end|ng |rom gm@||@com (Romaine TCHEDJI)
Date: Sat, 13 Jul 2024 11:30:11 +0100
Subject: [R-sig-ME] Mixed Multinomial model built with npmlt function:
 coefficients significance and Goodness of fit
Message-ID: <CALO7ZNGc2z3XvLCjtYMZNs937CSkQtn2QD7RfrZmEb1b2gzfEA@mail.gmail.com>

Hello all,
I fitted (using npmlt function) a mixte multinomial regression model which
ran without errors.
I expected that the outputs of the model include p-values that I didn't
find.
Please, find below the outputs of the model:

Call:  npmlt(formula = three levels categorical variable ~ variable1 +
variable2 ,
formula.npo = ~1 + variable1 , random = ~1, id = Patient_id, k = 2)

Coefficients:

```
|                             |Estimate |Std. Error|
---------------------------------------------------
| (Intercept) 1                   | -1.029e+01|2.995e+00  |
|(Intercept) 2                    |1.024e+01   |1.544e+00|
|(Intercept) 3                    |2.351e+01   |1.352e+00|
|variable1           level1 1      |-7.995e+00  | 2.444e+00|
|variable1           level1 2      |-2.711e+00  | 7.896e-01|
|variable1           level1 3    |-1.375e+01|   7.093e-01|
|variable1           level2 1    |-1.970e+01   |7.507e-07|
|variable1           level2 2    |-2.172e+01   |1.171e+00|
|variable1           level2 3    |-1.688e+01  | 9.573e-01|
|variable1           level3 1    |-1.976e+01   |5.782e-15|
|variable1           level3 2    |-2.835e+01   |3.827e-15|
|variable1           level3 3    |-4.295e+01   |8.260e-16|
|variable2 1                     | 1.527e+00   |7.733e-01|
|variable2 2                      |2.288e-01   |1.865e-01|
|variable2 3                      |2.760e-01   |2.915e-01|
```

Please, could someone here help me address the following concerns:
1)
 How do I know whether a coefficient (the outputs above) is significant or
not?  I mean, Retrieve p-values or calculate confidence intervals based on
the above output.
2)
How do I assess the Goodness of fit of such a model?
I unsuccessfully tried some common tools which seem not to support this
type of model.

Thanks in advance for your answers.
Best

	[[alternative HTML version deleted]]


From gb@guerom@|ne @end|ng |rom gm@||@com  Sat Jul 13 14:52:17 2024
From: gb@guerom@|ne @end|ng |rom gm@||@com (Romaine TCHEDJI)
Date: Sat, 13 Jul 2024 13:52:17 +0100
Subject: [R-sig-ME] Mixed Multinomial Model built with brms::brm: diagnostic
 and goodness of fit
Message-ID: <CALO7ZNG8_PM7zuVRO-07-8VdhzNyQritTR6w4My-8OFnn=j4kQ@mail.gmail.com>

 Hi, all.
I'm new at Bayesian modelling and I just fitted a Mixed Multinomial model
with brms::brm function.
The outputs look like follow:

Family: categorical
  Links: mu5059Kg = logit; mu6069Kg = logit; mu70Kg = logit
Formula: dependent.variable ~ Predictor1 + Predictor2 + Predictor3
+Predictor4 + (1 | grouping.variable)
   Data: QEP_df (Number of observations: 305)
  Draws: 4 chains, each with iter = 1000; warmup = 500; thin = 1;
         total post-warmup draws = 2000

Multilevel Hyperparameters:
~Patient_id (Number of levels: 302)
                       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
Tail_ESS
sd(mu5059Kg_Intercept)  3870.72   2237.74  1008.75  9990.76 1.86        6
    15
sd(mu6069Kg_Intercept)  2918.78   2119.11   723.89  8392.54 2.16        5
    11
sd(mu70Kg_Intercept)      65.00    127.51     2.65   446.45 1.23       14
    31

Regression Coefficients:
                                      Estimate Est.Error   l-95% CI  u-95%
CI Rhat Bulk_ESS Tail_ESS
mu5059Kg_Intercept                      930.06   1237.78   -1855.51
2999.83 1.21       16       28
mu6069Kg_Intercept                    -3528.80   3203.72  -11462.34
21.29 1.82        6       25
mu70Kg_Intercept                      -7167.48   7525.71  -23059.82
-490.98 2.30        5       26
mu5059Kg_Predictor1 level1             3680.97   1448.03    1503.36
6862.25 1.46        8       28
mu5059Kg_Predictor1 level2            -4249.19   8310.04  -22142.60
9823.92 2.28        5       19
mu5059Kg_Predictor1 level3            -46342.99  25341.93 -104113.23
 -6878.36 2.26        5       14
mu5059Kg_Predictor2                      -26.60    268.69    -603.03
 412.51 1.88        6       14
mu5059Kg_Predictor3                        0.15      3.19      -5.36
 8.39 1.19       20       31
mu5059Kg_Predictor4 level2              -199.51   1143.60   -1960.80
2663.52 1.23       15       36
mu6069Kg_Predictor1 level1              5299.62   2827.60    1867.48
 12239.12 1.98        6       11
mu6069Kg_Predictor1 level2              11270.73   9092.68    2558.59
 30427.83 2.30        5       20
mu6069Kg_Predictor1 level3                873.77  17756.14  -25351.15
 44191.74 2.04        6       13
mu6069Kg_Predictor2                     -294.70    247.52    -887.61
42.60 2.14        5       11
mu6069Kg_Predictor3                       -0.28      2.65      -5.60
 5.40 1.45        8       14
mu6069Kg_Predictor4 level2              -160.26   1019.22   -1888.31
1804.02 1.11       26       53
mu70Kg_Predictor1 level1                8548.41   8203.24    1256.54
 25529.99 2.67        5       19
mu70Kg_Predictor1 level2               12166.31  11819.17    1562.80
 37022.18 2.54        5       23
mu70Kg_Predictor1 level3               52159.88  53607.67    4477.90
169288.72 2.67        5       12
mu70Kg_Predictor2                        -40.10     64.78    -247.26
31.76 1.39        9       19
mu70Kg_Predictor3                          1.23      1.45      -0.70
 4.78 1.20       17       47
mu70Kg_Predictor4 level2               -1307.78   1123.37   -3664.23
 331.77 1.57        7       18
Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential

Please, help me answer the following questions:
1)
As you can see, most of the estimates have very large values: is this a
symptom of an issue?
If yes, how can I fix this issue?
In general, what tools can I use to make the diagnostic of such models
(built with brm or other bayesian modelling functions)
2)
Could you please suggest some tools to assess the goodness of fit for this
model (this type of models)?
3)
It was hard for me to find 02 functions to fit Mixed Multinomial
regression: one frequentist (mixcat::npmlt) and one Bayesian (brms::brm)
Any suggestion for other functions and/or documentation to build such
models will be much appreciated.

Thanks in advance for your answers.
Best regards.
Romaine

	[[alternative HTML version deleted]]


From @|ex@nder_@oko|ov@ky @end|ng |rom brown@edu  Mon Jul 15 20:27:13 2024
From: @|ex@nder_@oko|ov@ky @end|ng |rom brown@edu (Sokolovsky, Alexander)
Date: Mon, 15 Jul 2024 14:27:13 -0400
Subject: [R-sig-ME] Pointer in right direction
Message-ID: <CAK-pkDD4BjmBz9PMcRNDKO-BZRadTLHfBk6=vB+XNZ-Rfa2ULw@mail.gmail.com>

Hi all,

I am starting to work on a new analysis of nationally representative
longitudinal cohort data which uses a complex sampling strategy. There are
replicate weights included in the dataset constructed from ~ 100 variables.
I was planning on using a subset of the data (a subset for which specific
weights have already been computed) of individuals completing all waves.
The broad analytic plan was to regress a binary outcome onto a time
(indicated by *wave*) x moderator interaction to examine how a longitudinal
trend *x *in the prevalence of a behavior *y* are moderated by individual
characteristic *m. *I am happy to provide more details if it would be
helpful. My assumption was that I would still have to account for the
clustering of observations (weights are provided at the person-level)
within an individual to account for the covariance between these
observations, but I could not find a package that let me use BRR sampling
weights with a GLMM. So any help would be appreciated in terms of either:
a) pointing me in the right direction in terms of tools to undertake this
analysis, or b) correcting a potential misperception in the need to account
for the clustering given the other design characteristics of the survey.
Any advice would be helpful!

All the best,
-- Alex
-- 
*Alexander W. Sokolovsky, PhD*
Assistant Professor
Center for Alcohol and Addiction Studies
Department of Behavioral and Social Sciences
E: Alexander_Sokolovsky at Brown.edu
P: (401) 863-6629(401) 863-6697 (Fax)
A: Box G-S121-5, Providence, RI 02912
<https://maps.google.com/?q=Box%20G-S121-5%2C%20Providence%2C%20RI%2002912>
W: https://vivo.brown.edu/display/asokolo1
? @alexsokophd.bsky.social
<https://bsky.app/profile/alexsokophd.bsky.social>

?The greatest enemy of knowledge is not ignorance, it is the illusion of
knowledge.?
- Stephen Hawking

	[[alternative HTML version deleted]]


From mc@rrete @end|ng |rom upo@e@  Mon Jul 22 17:15:21 2024
From: mc@rrete @end|ng |rom upo@e@ (Martina Carrete)
Date: Mon, 22 Jul 2024 17:15:21 +0200
Subject: [R-sig-ME] glmmTMB with two phylogenies: this is possible?
In-Reply-To: <QB1PR01MB3971966E6863A17421E6FED7BBA82@QB1PR01MB3971.CANPRD01.PROD.OUTLOOK.COM>
References: <7c1dd824edb2dd493febb38a872cd00d@upo.es>
 <QB1PR01MB3971966E6863A17421E6FED7BBA82@QB1PR01MB3971.CANPRD01.PROD.OUTLOOK.COM>
Message-ID: <e039856de68fd42750ad18adc593e2fe@upo.es>



Hi all,

We are doing a paper in which we are exploring the variables that can 
explain the probability of occurrence of a particular behaviour 
(binomial model) between plants and birds (the independent variables are 
two continuous variables). Given that the literature gives an important 
weight to the phylogeny of both plants and birds and that the 
independent variables also have a phylogenetic signal, it was clear from 
the beginning that we had to include the phylogenies of both groups. 
This is only possible (to our knowledge) with MCMCglmm and we have done 
so. Bayesian statistics, frankly, escapes us a lot. The priors and such 
things are black boxes that we can't quite understand and, in addition, 
we are missing things that we are used to when assessing the results of 
a model: the explained variance (R2 or deviance), the posterior fit, the 
possibility of seeing if the models are inflated to 0, etc. The glmmTMBs 
are therefore a fantastic tool that we use all the time. However, in 
this case, we tried to do them including two phylogenies and there was 
no way. We don't know if it's something that hasn't been implemented or 
if we didn't know how to do it. We've looked in forums and we haven't 
been able to find anything either.

Below is the script we used, but considering only one phylogeny.

phyloZplant <- phylo.to.Z(pruned.tree.P)
q3_fylo_P <- datG %>% mutate(sp_plant = factor(sp_plant, levels = 
phyloZplant at Dimnames[[1]]))

phyloZbird <- phylo.to.Z(pruned.treeB)
q3_fylo_B <- datG %>% mutate(sp_bird = factor(sp_bird, levels = 
phyloZbird at Dimnames[[1]]))

glmmTMB_fit_gauss1 <- phylo_glmmTMB(binomial_variable~ continuous1 + 
continuous2 + (1|sp_bird)
                                     , data=q3_fylo_B
                                     , phyloZ = phyloZbird
                                     , phylonm = "sp_bird"
                                     , doFit = TRUE
                                     , REML = FALSE
                                     , ziformula=~0,
                                     , family = "binomial"
)

We are interested in a model where we can include the phylogeny of birds 
but also the phylogeny of plants.

Any suggestions would be very welcome,
Thank you very much!

Un abrazo

Martina
	[[alternative HTML version deleted]]


From mo|||eebrook@ @end|ng |rom gm@||@com  Mon Jul 22 18:18:41 2024
From: mo|||eebrook@ @end|ng |rom gm@||@com (Mollie Brooks)
Date: Mon, 22 Jul 2024 18:18:41 +0200
Subject: [R-sig-ME] glmmTMB with two phylogenies: this is possible?
In-Reply-To: <e039856de68fd42750ad18adc593e2fe@upo.es>
References: <7c1dd824edb2dd493febb38a872cd00d@upo.es>
 <QB1PR01MB3971966E6863A17421E6FED7BBA82@QB1PR01MB3971.CANPRD01.PROD.OUTLOOK.COM>
 <e039856de68fd42750ad18adc593e2fe@upo.es>
Message-ID: <43A72359-D869-432D-BE5A-BD6F8F810934@gmail.com>

Hi Martina,

Maeve McGuillycuddy is on vacation right now, but I was just talking to her about this last week. She implemented this capability for glmmTMB (here https://github.com/mmcgillycuddy/glmmTMB) and has a paper accepted for publication in Journal of Statistical Software. We plan to make it available in the main GitHub branch of glmmTMB as soon as possible when Maeve is back to work. One of us will follow up here as soon as possible. If you want to start now, install the branch at the link above and then look at vignette("covstruct") or see this test for a demonstration for how it?s intended to be used

https://github.com/glmmTMB/glmmTMB/commit/b785819c2a03bf7364e53210d092cfc89d4ceced

cheers,
Mollie

> On 22 Jul 2024, at 17.15, Martina Carrete <mcarrete at upo.es> wrote:
> 
> 
> 
> Hi all,
> 
> We are doing a paper in which we are exploring the variables that can 
> explain the probability of occurrence of a particular behaviour 
> (binomial model) between plants and birds (the independent variables are 
> two continuous variables). Given that the literature gives an important 
> weight to the phylogeny of both plants and birds and that the 
> independent variables also have a phylogenetic signal, it was clear from 
> the beginning that we had to include the phylogenies of both groups. 
> This is only possible (to our knowledge) with MCMCglmm and we have done 
> so. Bayesian statistics, frankly, escapes us a lot. The priors and such 
> things are black boxes that we can't quite understand and, in addition, 
> we are missing things that we are used to when assessing the results of 
> a model: the explained variance (R2 or deviance), the posterior fit, the 
> possibility of seeing if the models are inflated to 0, etc. The glmmTMBs 
> are therefore a fantastic tool that we use all the time. However, in 
> this case, we tried to do them including two phylogenies and there was 
> no way. We don't know if it's something that hasn't been implemented or 
> if we didn't know how to do it. We've looked in forums and we haven't 
> been able to find anything either.
> 
> Below is the script we used, but considering only one phylogeny.
> 
> phyloZplant <- phylo.to.Z(pruned.tree.P)
> q3_fylo_P <- datG %>% mutate(sp_plant = factor(sp_plant, levels = 
> phyloZplant at Dimnames[[1]]))
> 
> phyloZbird <- phylo.to.Z(pruned.treeB)
> q3_fylo_B <- datG %>% mutate(sp_bird = factor(sp_bird, levels = 
> phyloZbird at Dimnames[[1]]))
> 
> glmmTMB_fit_gauss1 <- phylo_glmmTMB(binomial_variable~ continuous1 + 
> continuous2 + (1|sp_bird)
>                                     , data=q3_fylo_B
>                                     , phyloZ = phyloZbird
>                                     , phylonm = "sp_bird"
>                                     , doFit = TRUE
>                                     , REML = FALSE
>                                     , ziformula=~0,
>                                     , family = "binomial"
> )
> 
> We are interested in a model where we can include the phylogeny of birds 
> but also the phylogeny of plants.
> 
> Any suggestions would be very welcome,
> Thank you very much!
> 
> Un abrazo
> 
> Martina
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models


	[[alternative HTML version deleted]]


From Luke@D@F@nn|n@GR @end|ng |rom d@rtmouth@edu  Tue Jul 23 18:27:16 2024
From: Luke@D@F@nn|n@GR @end|ng |rom d@rtmouth@edu (Luke D. Fannin)
Date: Tue, 23 Jul 2024 16:27:16 +0000
Subject: [R-sig-ME] glmmTMB question - diagnostic plots of model fit and
 effect sizes
Message-ID: <MN2PR03MB5199A314AAA303FDAC2BF75880A92@MN2PR03MB5199.namprd03.prod.outlook.com>

Dear Dr. Bolker,

I hope this email finds you well. My name is Luke Fannin; I?m an EEB  graduate student at Dartmouth College. I am wondering if I can ask for your advice on some analyses I?ve been running with glmmTMB.

Specifically, I have two questions. Is there a way within the package to: plot a diagnostic plot of model predictions against data to evaluate performance? Also, is there a handy way to calculate parameter effect sizes? I?ve been working with the zero-inflated NB models specifically, but I wanted to make sure I hadn?t missed any references to these issues in your helpful GLMM FAQ online. Any help would be most appreciated. Thank you in advance and I look  forward to hearing from you.

Best,  Luke

	[[alternative HTML version deleted]]


From bbo|ker @end|ng |rom gm@||@com  Tue Jul 23 20:10:25 2024
From: bbo|ker @end|ng |rom gm@||@com (Ben Bolker)
Date: Tue, 23 Jul 2024 14:10:25 -0400
Subject: [R-sig-ME] glmmTMB question - diagnostic plots of model fit and
 effect sizes
In-Reply-To: <MN2PR03MB5199A314AAA303FDAC2BF75880A92@MN2PR03MB5199.namprd03.prod.outlook.com>
References: <MN2PR03MB5199A314AAA303FDAC2BF75880A92@MN2PR03MB5199.namprd03.prod.outlook.com>
Message-ID: <a5b87979-e124-4ca3-a0ae-9e2ac1c57260@gmail.com>



On 2024-07-23 12:27 p.m., Luke D. Fannin wrote:
> Dear Dr. Bolker,
> 
> I hope this email finds you well. My name is Luke Fannin; I?m an EEB  graduate student at Dartmouth College. I am wondering if I can ask for your advice on some analyses I?ve been running with glmmTMB.
> 
> Specifically, I have two questions. Is there a way within the package to: plot a diagnostic plot of model predictions against data to evaluate performance? Also, is there a handy way to calculate parameter effect sizes? 

   The package itself doesn't have any built-in diagnostic plotting 
methods, but you can do something like

plot(fitted(m1), model.response(model.frame(m1)))

  If you're willing to use other packages, then 
performance::check_model() and the DHARMa packages generally are good 
places to start.


I?ve been working with the zero-inflated NB models specifically, but I 
wanted to make sure I hadn?t missed any references to these issues in 
your helpful GLMM FAQ online. Any help would be most appreciated. Thank 
you in advance and I look  forward to hearing from you.

   This depends very much what you mean by 'effect size'. I often like 
the scaled regression coefficients as a low-tech solution (e.g. see the 
`by_2sd()` function in the dotwhisker package, or you can scale your 
predictor variables yourself). Or take a look around at the helper 
packages listed at https://cran.r-project.org/web/views/MixedModels.html

   Ben Bolker
> 
> Best,  Luke
> 
> 	[[alternative HTML version deleted]]
> 
> 
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models

-- 
Dr. Benjamin Bolker
Professor, Mathematics & Statistics and Biology, McMaster University
Director, School of Computational Science and Engineering
(Acting) Graduate chair, Mathematics & Statistics
 > E-mail is sent at my convenience; I don't expect replies outside of 
working hours.


From |@ur@_|ee @end|ng |rom |w@@gov  Tue Jul 30 21:44:19 2024
From: |@ur@_|ee @end|ng |rom |w@@gov (Lee, Laura M)
Date: Tue, 30 Jul 2024 19:44:19 +0000
Subject: [R-sig-ME] partial effects plots
Message-ID: <MN2PR09MB4937A1E0238B0D03549B4F7590B02@MN2PR09MB4937.namprd09.prod.outlook.com>

Hello all,

I have fit a GLMM to presence/absence data (family = binomial) from an acoustic telemetry study. I have five fixed effects-Year (a factor), Day of Year, Hour of Day, Sex (a factor), and water temperature-and one random effect-Fish ID (a factor). I am looking to create partial effects plots for the covariates. Can anyone direct me to some sample code or suggest a package to help me get started. My Google searches haven't been very fruitful.

I would appreciate any assistance on this matter. Thank you for your time!


Best,

Laura


#############################
Laura M. Lee
USFWS - Northeast Fishery Center
P.O. Box 75
308 Washington Ave.
Lamar, PA  16848
Phone: 570-726-4247 x 50122
Laura_Lee at fws.gov<mailto:Laura_Lee at fws.gov>
#############################



	[[alternative HTML version deleted]]


From bbo|ker @end|ng |rom gm@||@com  Tue Jul 30 22:18:04 2024
From: bbo|ker @end|ng |rom gm@||@com (Ben Bolker)
Date: Tue, 30 Jul 2024 16:18:04 -0400
Subject: [R-sig-ME] partial effects plots
In-Reply-To: <MN2PR09MB4937A1E0238B0D03549B4F7590B02@MN2PR09MB4937.namprd09.prod.outlook.com>
References: <MN2PR09MB4937A1E0238B0D03549B4F7590B02@MN2PR09MB4937.namprd09.prod.outlook.com>
Message-ID: <c85f731f-22a7-4369-870f-bee559298a78@gmail.com>

 ? Start with emmeans or effects packages? In particular

library(effects)

plot(allEffects(fitted_model))

On 7/30/24 15:44, Lee, Laura M via R-sig-mixed-models wrote:
> Hello all,
>
> I have fit a GLMM to presence/absence data (family = binomial) from an acoustic telemetry study. I have five fixed effects-Year (a factor), Day of Year, Hour of Day, Sex (a factor), and water temperature-and one random effect-Fish ID (a factor). I am looking to create partial effects plots for the covariates. Can anyone direct me to some sample code or suggest a package to help me get started. My Google searches haven't been very fruitful.
>
> I would appreciate any assistance on this matter. Thank you for your time!
>
>
> Best,
>
> Laura
>
>
> #############################
> Laura M. Lee
> USFWS - Northeast Fishery Center
> P.O. Box 75
> 308 Washington Ave.
> Lamar, PA  16848
> Phone: 570-726-4247 x 50122
> Laura_Lee at fws.gov<mailto:Laura_Lee at fws.gov>
> #############################
>
>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models


From d@|uedecke @end|ng |rom uke@de  Tue Jul 30 22:30:09 2024
From: d@|uedecke @end|ng |rom uke@de (=?UTF-8?Q?Daniel_L=C3=BCdecke?=)
Date: Tue, 30 Jul 2024 22:30:09 +0200
Subject: [R-sig-ME] [EXT] Re:  partial effects plots
In-Reply-To: <c85f731f-22a7-4369-870f-bee559298a78@gmail.com>
References: <MN2PR09MB4937A1E0238B0D03549B4F7590B02@MN2PR09MB4937.namprd09.prod.outlook.com>
 <c85f731f-22a7-4369-870f-bee559298a78@gmail.com>
Message-ID: <00f301dae2bf$45bb61b0$d1322510$@uke.de>

I'm not sure if the partial effects plots differ from what emmeans, ggeffects, effects etc. plot by default.
Isn't another name for "partial effects plots" the "added variables plot", implemented in car::avPlot() / car::avPlots()?

Not sure if mixed models are supported, though.

-----Urspr?ngliche Nachricht-----
Von: R-sig-mixed-models <r-sig-mixed-models-bounces at r-project.org> Im Auftrag von Ben Bolker
Gesendet: Dienstag, 30. Juli 2024 22:18
An: r-sig-mixed-models at r-project.org
Betreff: [EXT] Re: [R-sig-ME] partial effects plots

   Start with emmeans or effects packages? In particular

library(effects)

plot(allEffects(fitted_model))

On 7/30/24 15:44, Lee, Laura M via R-sig-mixed-models wrote:
> Hello all,
>
> I have fit a GLMM to presence/absence data (family = binomial) from an acoustic telemetry study. I have five fixed effects-Year (a factor), Day of Year, Hour of Day, Sex (a factor), and water temperature-and one random effect-Fish ID (a factor). I am looking to create partial effects plots for the covariates. Can anyone direct me to some sample code or suggest a package to help me get started. My Google searches haven't been very fruitful.
>
> I would appreciate any assistance on this matter. Thank you for your time!
>
>
> Best,
>
> Laura
>
>
> #############################
> Laura M. Lee
> USFWS - Northeast Fishery Center
> P.O. Box 75
> 308 Washington Ave.
> Lamar, PA  16848
> Phone: 570-726-4247 x 50122
> Laura_Lee at fws.gov<mailto:Laura_Lee at fws.gov>
> #############################
>
>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list 
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models

_______________________________________________
R-sig-mixed-models at r-project.org mailing list https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models

--

_____________________________________________________________________

Universit?tsklinikum Hamburg-Eppendorf; K?rperschaft des ?ffentlichen Rechts; Gerichtsstand: Hamburg | www.uke.de
Vorstandsmitglieder: Prof. Dr. Christian Gerloff (Vorsitzender), Joachim Pr?l?, Prof. Dr. Blanche Schwappach-Pignataro, Corinna Wriedt
_____________________________________________________________________

From bbo|ker @end|ng |rom gm@||@com  Tue Jul 30 22:52:14 2024
From: bbo|ker @end|ng |rom gm@||@com (Ben Bolker)
Date: Tue, 30 Jul 2024 16:52:14 -0400
Subject: [R-sig-ME] [EXT] Re:  partial effects plots
In-Reply-To: <00f301dae2bf$45bb61b0$d1322510$@uke.de>
References: <MN2PR09MB4937A1E0238B0D03549B4F7590B02@MN2PR09MB4937.namprd09.prod.outlook.com>
 <c85f731f-22a7-4369-870f-bee559298a78@gmail.com>
 <00f301dae2bf$45bb61b0$d1322510$@uke.de>
Message-ID: <5e1613f0-94b2-45e3-9a93-ddfc2d7a8f7f@gmail.com>

 ? OK, in this case you'll need to be able to generate partial 
residuals, which may be doable via the package at 
https://github.com/hohenstein/remef

On 7/30/24 16:30, Daniel L?decke wrote:
> I'm not sure if the partial effects plots differ from what emmeans, ggeffects, effects etc. plot by default.
> Isn't another name for "partial effects plots" the "added variables plot", implemented in car::avPlot() / car::avPlots()?
>
> Not sure if mixed models are supported, though.
>
> -----Urspr?ngliche Nachricht-----
> Von: R-sig-mixed-models <r-sig-mixed-models-bounces at r-project.org> Im Auftrag von Ben Bolker
> Gesendet: Dienstag, 30. Juli 2024 22:18
> An: r-sig-mixed-models at r-project.org
> Betreff: [EXT] Re: [R-sig-ME] partial effects plots
>
>     Start with emmeans or effects packages? In particular
>
> library(effects)
>
> plot(allEffects(fitted_model))
>
> On 7/30/24 15:44, Lee, Laura M via R-sig-mixed-models wrote:
>> Hello all,
>>
>> I have fit a GLMM to presence/absence data (family = binomial) from an acoustic telemetry study. I have five fixed effects-Year (a factor), Day of Year, Hour of Day, Sex (a factor), and water temperature-and one random effect-Fish ID (a factor). I am looking to create partial effects plots for the covariates. Can anyone direct me to some sample code or suggest a package to help me get started. My Google searches haven't been very fruitful.
>>
>> I would appreciate any assistance on this matter. Thank you for your time!
>>
>>
>> Best,
>>
>> Laura
>>
>>
>> #############################
>> Laura M. Lee
>> USFWS - Northeast Fishery Center
>> P.O. Box 75
>> 308 Washington Ave.
>> Lamar, PA  16848
>> Phone: 570-726-4247 x 50122
>> Laura_Lee at fws.gov<mailto:Laura_Lee at fws.gov>
>> #############################
>>
>>
>>
>> 	[[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-mixed-models at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>
> --
>
> _____________________________________________________________________
>
> Universit?tsklinikum Hamburg-Eppendorf; K?rperschaft des ?ffentlichen Rechts; Gerichtsstand: Hamburg | www.uke.de
> Vorstandsmitglieder: Prof. Dr. Christian Gerloff (Vorsitzender), Joachim Pr?l?, Prof. Dr. Blanche Schwappach-Pignataro, Corinna Wriedt
> _____________________________________________________________________


From j|ox @end|ng |rom mcm@@ter@c@  Tue Jul 30 23:08:28 2024
From: j|ox @end|ng |rom mcm@@ter@c@ (John Fox)
Date: Tue, 30 Jul 2024 17:08:28 -0400
Subject: [R-sig-ME] [EXT] Re: partial effects plots
In-Reply-To: <5e1613f0-94b2-45e3-9a93-ddfc2d7a8f7f@gmail.com>
References: <MN2PR09MB4937A1E0238B0D03549B4F7590B02@MN2PR09MB4937.namprd09.prod.outlook.com>
 <c85f731f-22a7-4369-870f-bee559298a78@gmail.com>
 <00f301dae2bf$45bb61b0$d1322510$@uke.de>
 <5e1613f0-94b2-45e3-9a93-ddfc2d7a8f7f@gmail.com>
Message-ID: <6cc7ed9f-509a-4867-981f-4e22661d96fa@mcmaster.ca>

Dear Ben, Daniel, and Laura,

First, added-variable (partial-regression) plots are often confused with 
component + residuals (partial-residual) plots, but they are not the same.

Second, "effect" plots are essentially component + residuals plots 
(possibly without the residuals).

Finally, it's possible to show partial residuals in effect plots for 
mixed models constructed by the effects package.

I hope this helps,
  John

-- 
John Fox, Professor Emeritus
McMaster University
Hamilton, Ontario, Canada
web: https://www.john-fox.ca/
--

On 2024-07-30 4:52 p.m., Ben Bolker wrote:
> Caution: External email.
> 
> 
>  ? OK, in this case you'll need to be able to generate partial
> residuals, which may be doable via the package at
> https://github.com/hohenstein/remef
> 
> On 7/30/24 16:30, Daniel L?decke wrote:
>> I'm not sure if the partial effects plots differ from what emmeans, 
>> ggeffects, effects etc. plot by default.
>> Isn't another name for "partial effects plots" the "added variables 
>> plot", implemented in car::avPlot() / car::avPlots()?
>>
>> Not sure if mixed models are supported, though.
>>
>> -----Urspr?ngliche Nachricht-----
>> Von: R-sig-mixed-models <r-sig-mixed-models-bounces at r-project.org> Im 
>> Auftrag von Ben Bolker
>> Gesendet: Dienstag, 30. Juli 2024 22:18
>> An: r-sig-mixed-models at r-project.org
>> Betreff: [EXT] Re: [R-sig-ME] partial effects plots
>>
>> ??? Start with emmeans or effects packages? In particular
>>
>> library(effects)
>>
>> plot(allEffects(fitted_model))
>>
>> On 7/30/24 15:44, Lee, Laura M via R-sig-mixed-models wrote:
>>> Hello all,
>>>
>>> I have fit a GLMM to presence/absence data (family = binomial) from 
>>> an acoustic telemetry study. I have five fixed effects-Year (a 
>>> factor), Day of Year, Hour of Day, Sex (a factor), and water 
>>> temperature-and one random effect-Fish ID (a factor). I am looking to 
>>> create partial effects plots for the covariates. Can anyone direct me 
>>> to some sample code or suggest a package to help me get started. My 
>>> Google searches haven't been very fruitful.
>>>
>>> I would appreciate any assistance on this matter. Thank you for your 
>>> time!
>>>
>>>
>>> Best,
>>>
>>> Laura
>>>
>>>
>>> #############################
>>> Laura M. Lee
>>> USFWS - Northeast Fishery Center
>>> P.O. Box 75
>>> 308 Washington Ave.
>>> Lamar, PA? 16848
>>> Phone: 570-726-4247 x 50122
>>> Laura_Lee at fws.gov<mailto:Laura_Lee at fws.gov>
>>> #############################
>>>
>>>
>>>
>>> ???? [[alternative HTML version deleted]]
>>>
>>> _______________________________________________
>>> R-sig-mixed-models at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>> _______________________________________________
>> R-sig-mixed-models at r-project.org mailing list https://stat.ethz.ch/ 
>> mailman/listinfo/r-sig-mixed-models
>>
>> -- 
>>
>> _____________________________________________________________________
>>
>> Universit?tsklinikum Hamburg-Eppendorf; K?rperschaft des ?ffentlichen 
>> Rechts; Gerichtsstand: Hamburg | www.uke.de
>> Vorstandsmitglieder: Prof. Dr. Christian Gerloff (Vorsitzender), 
>> Joachim Pr?l?, Prof. Dr. Blanche Schwappach-Pignataro, Corinna Wriedt
>> _____________________________________________________________________
> 
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models


From d@|uedecke @end|ng |rom uke@de  Wed Jul 31 08:37:48 2024
From: d@|uedecke @end|ng |rom uke@de (=?utf-8?Q?Daniel_L=C3=BCdecke?=)
Date: Wed, 31 Jul 2024 08:37:48 +0200
Subject: [R-sig-ME] [EXT] Re:  Re: partial effects plots
In-Reply-To: <6cc7ed9f-509a-4867-981f-4e22661d96fa@mcmaster.ca>
References: <MN2PR09MB4937A1E0238B0D03549B4F7590B02@MN2PR09MB4937.namprd09.prod.outlook.com>
 <c85f731f-22a7-4369-870f-bee559298a78@gmail.com>
 <00f301dae2bf$45bb61b0$d1322510$@uke.de>
 <5e1613f0-94b2-45e3-9a93-ddfc2d7a8f7f@gmail.com>
 <6cc7ed9f-509a-4867-981f-4e22661d96fa@mcmaster.ca>
Message-ID: <001401dae314$29339b70$7b9ad250$@uke.de>

Dear all,
yes, partial *residuals* are possible with the effects package (see https://cran.r-project.org/web/packages/effects/vignettes/partial-residuals.pdf) or ggeffects (https://strengejacke.github.io/ggeffects/articles/introduction_partial_residuals.html).

I don't think partial *regression* plots are possible for any of those packages (maybe for the effects package, I'm not sure).

Laura, maybe you can clarify what kind of plots you would like to have? Terminology may be unclear here. I'm not sure if I confused partial *effects* with partial *regression* plots. Beside the mentioned functions in the car-package, this website describes partial-effects plots: https://rpubs.com/milesdwilliams15/328471

Best
Daniel

-----Urspr?ngliche Nachricht-----
Von: John Fox <jfox at mcmaster.ca> 
Gesendet: Dienstag, 30. Juli 2024 23:08
An: Ben Bolker <bbolker at gmail.com>; Daniel L?decke <d.luedecke at uke.de>; Laura_Lee at fws.gov
Cc: r-sig-mixed-models at r-project.org
Betreff: [EXT] Re: [R-sig-ME] Re: partial effects plots

Dear Ben, Daniel, and Laura,

First, added-variable (partial-regression) plots are often confused with component + residuals (partial-residual) plots, but they are not the same.

Second, "effect" plots are essentially component + residuals plots (possibly without the residuals).

Finally, it's possible to show partial residuals in effect plots for mixed models constructed by the effects package.

I hope this helps,
  John

--
John Fox, Professor Emeritus
McMaster University
Hamilton, Ontario, Canada
web: https://www.john-fox.ca/
--

On 2024-07-30 4:52 p.m., Ben Bolker wrote:
> Caution: External email.
> 
> 
>    OK, in this case you'll need to be able to generate partial 
> residuals, which may be doable via the package at 
> https://github.com/hohenstein/remef
> 
> On 7/30/24 16:30, Daniel L?decke wrote:
>> I'm not sure if the partial effects plots differ from what emmeans, 
>> ggeffects, effects etc. plot by default.
>> Isn't another name for "partial effects plots" the "added variables 
>> plot", implemented in car::avPlot() / car::avPlots()?
>>
>> Not sure if mixed models are supported, though.
>>
>> -----Urspr?ngliche Nachricht-----
>> Von: R-sig-mixed-models <r-sig-mixed-models-bounces at r-project.org> Im 
>> Auftrag von Ben Bolker
>> Gesendet: Dienstag, 30. Juli 2024 22:18
>> An: r-sig-mixed-models at r-project.org
>> Betreff: [EXT] Re: [R-sig-ME] partial effects plots
>>
>>     Start with emmeans or effects packages? In particular
>>
>> library(effects)
>>
>> plot(allEffects(fitted_model))
>>
>> On 7/30/24 15:44, Lee, Laura M via R-sig-mixed-models wrote:
>>> Hello all,
>>>
>>> I have fit a GLMM to presence/absence data (family = binomial) from 
>>> an acoustic telemetry study. I have five fixed effects-Year (a 
>>> factor), Day of Year, Hour of Day, Sex (a factor), and water 
>>> temperature-and one random effect-Fish ID (a factor). I am looking 
>>> to create partial effects plots for the covariates. Can anyone 
>>> direct me to some sample code or suggest a package to help me get 
>>> started. My Google searches haven't been very fruitful.
>>>
>>> I would appreciate any assistance on this matter. Thank you for your 
>>> time!
>>>
>>>
>>> Best,
>>>
>>> Laura
>>>
>>>
>>> #############################
>>> Laura M. Lee
>>> USFWS - Northeast Fishery Center
>>> P.O. Box 75
>>> 308 Washington Ave.
>>> Lamar, PA  16848
>>> Phone: 570-726-4247 x 50122
>>> Laura_Lee at fws.gov<mailto:Laura_Lee at fws.gov>
>>> #############################
>>>
>>>
>>>
>>>      [[alternative HTML version deleted]]
>>>
>>> _______________________________________________
>>> R-sig-mixed-models at r-project.org mailing list 
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>> _______________________________________________
>> R-sig-mixed-models at r-project.org mailing list https://stat.ethz.ch/ 
>> mailman/listinfo/r-sig-mixed-models
>>
>> --
>>
>> _____________________________________________________________________
>>
>> Universit?tsklinikum Hamburg-Eppendorf; K?rperschaft des ?ffentlichen 
>> Rechts; Gerichtsstand: Hamburg | www.uke.de
>> Vorstandsmitglieder: Prof. Dr. Christian Gerloff (Vorsitzender), 
>> Joachim Pr?l?, Prof. Dr. Blanche Schwappach-Pignataro, Corinna Wriedt 
>> _____________________________________________________________________
> 
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list 
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models


--

_____________________________________________________________________

Universit?tsklinikum Hamburg-Eppendorf; K?rperschaft des ?ffentlichen Rechts; Gerichtsstand: Hamburg | www.uke.de
Vorstandsmitglieder: Prof. Dr. Christian Gerloff (Vorsitzender), Joachim Pr?l?, Prof. Dr. Blanche Schwappach-Pignataro, Corinna Wriedt
_____________________________________________________________________

From j|ox @end|ng |rom mcm@@ter@c@  Wed Jul 31 13:37:50 2024
From: j|ox @end|ng |rom mcm@@ter@c@ (John Fox)
Date: Wed, 31 Jul 2024 07:37:50 -0400
Subject: [R-sig-ME] [EXT] Re:  Re: partial effects plots
In-Reply-To: <001401dae314$29339b70$7b9ad250$@uke.de>
References: <MN2PR09MB4937A1E0238B0D03549B4F7590B02@MN2PR09MB4937.namprd09.prod.outlook.com>
 <c85f731f-22a7-4369-870f-bee559298a78@gmail.com>
 <00f301dae2bf$45bb61b0$d1322510$@uke.de>
 <5e1613f0-94b2-45e3-9a93-ddfc2d7a8f7f@gmail.com>
 <6cc7ed9f-509a-4867-981f-4e22661d96fa@mcmaster.ca>
 <001401dae314$29339b70$7b9ad250$@uke.de>
Message-ID: <955bfac9-afc5-4dbe-a1b4-a20646266494@mcmaster.ca>

Dear Daniel,

On 2024-07-31 2:37 a.m., Daniel L?decke wrote:
> [You don't often get email from d.luedecke at uke.de. Learn why this is important at https://aka.ms/LearnAboutSenderIdentification ]
> 
> Caution: External email.
> 
> 
> Dear all,
> yes, partial *residuals* are possible with the effects package (see https://cran.r-project.org/web/packages/effects/vignettes/partial-residuals.pdf) or ggeffects (https://strengejacke.github.io/ggeffects/articles/introduction_partial_residuals.html).
> 
> I don't think partial *regression* plots are possible for any of those packages (maybe for the effects package, I'm not sure).
> 
> Laura, maybe you can clarify what kind of plots you would like to have? Terminology may be unclear here. I'm not sure if I confused partial *effects* with partial *regression* plots. Beside the mentioned functions in the car-package, this website describes partial-effects plots: https://rpubs.com/milesdwilliams15/328471

This document says that, "Partial effect plots go by serval [sic] names 
(partial residual plots, added variable plots, adjusted variable plots, 
etc.)."  "Partial residual plots" and "added variable plots" have 
conventional definitions, and they are not the same.

The document goes on to define a function that computes added-variable 
(partial-regression) plots for linear models fit by unweighted least 
squares. One can more generally compute AV plots for linear models fit 
by weighted least squares and for generalized linear models (see, e.g., 
the avPlots() function in the far package). I'm unaware of a 
generalization beyond that.

Best,
  John

> 
> Best
> Daniel
> 
> -----Urspr?ngliche Nachricht-----
> Von: John Fox <jfox at mcmaster.ca>
> Gesendet: Dienstag, 30. Juli 2024 23:08
> An: Ben Bolker <bbolker at gmail.com>; Daniel L?decke <d.luedecke at uke.de>; Laura_Lee at fws.gov
> Cc: r-sig-mixed-models at r-project.org
> Betreff: [EXT] Re: [R-sig-ME] Re: partial effects plots
> 
> Dear Ben, Daniel, and Laura,
> 
> First, added-variable (partial-regression) plots are often confused with component + residuals (partial-residual) plots, but they are not the same.
> 
> Second, "effect" plots are essentially component + residuals plots (possibly without the residuals).
> 
> Finally, it's possible to show partial residuals in effect plots for mixed models constructed by the effects package.
> 
> I hope this helps,
>    John
> 
> --
> John Fox, Professor Emeritus
> McMaster University
> Hamilton, Ontario, Canada
> web: https://www.john-fox.ca/
> --
> 
> On 2024-07-30 4:52 p.m., Ben Bolker wrote:
>> Caution: External email.
>>
>>
>>     OK, in this case you'll need to be able to generate partial
>> residuals, which may be doable via the package at
>> https://github.com/hohenstein/remef
>>
>> On 7/30/24 16:30, Daniel L?decke wrote:
>>> I'm not sure if the partial effects plots differ from what emmeans,
>>> ggeffects, effects etc. plot by default.
>>> Isn't another name for "partial effects plots" the "added variables
>>> plot", implemented in car::avPlot() / car::avPlots()?
>>>
>>> Not sure if mixed models are supported, though.
>>>
>>> -----Urspr?ngliche Nachricht-----
>>> Von: R-sig-mixed-models <r-sig-mixed-models-bounces at r-project.org> Im
>>> Auftrag von Ben Bolker
>>> Gesendet: Dienstag, 30. Juli 2024 22:18
>>> An: r-sig-mixed-models at r-project.org
>>> Betreff: [EXT] Re: [R-sig-ME] partial effects plots
>>>
>>>      Start with emmeans or effects packages? In particular
>>>
>>> library(effects)
>>>
>>> plot(allEffects(fitted_model))
>>>
>>> On 7/30/24 15:44, Lee, Laura M via R-sig-mixed-models wrote:
>>>> Hello all,
>>>>
>>>> I have fit a GLMM to presence/absence data (family = binomial) from
>>>> an acoustic telemetry study. I have five fixed effects-Year (a
>>>> factor), Day of Year, Hour of Day, Sex (a factor), and water
>>>> temperature-and one random effect-Fish ID (a factor). I am looking
>>>> to create partial effects plots for the covariates. Can anyone
>>>> direct me to some sample code or suggest a package to help me get
>>>> started. My Google searches haven't been very fruitful.
>>>>
>>>> I would appreciate any assistance on this matter. Thank you for your
>>>> time!
>>>>
>>>>
>>>> Best,
>>>>
>>>> Laura
>>>>
>>>>
>>>> #############################
>>>> Laura M. Lee
>>>> USFWS - Northeast Fishery Center
>>>> P.O. Box 75
>>>> 308 Washington Ave.
>>>> Lamar, PA  16848
>>>> Phone: 570-726-4247 x 50122
>>>> Laura_Lee at fws.gov<mailto:Laura_Lee at fws.gov>
>>>> #############################
>>>>
>>>>
>>>>
>>>>       [[alternative HTML version deleted]]
>>>>
>>>> _______________________________________________
>>>> R-sig-mixed-models at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>> _______________________________________________
>>> R-sig-mixed-models at r-project.org mailing list https://stat.ethz.ch/
>>> mailman/listinfo/r-sig-mixed-models
>>>
>>> --
>>>
>>> _____________________________________________________________________
>>>
>>> Universit?tsklinikum Hamburg-Eppendorf; K?rperschaft des ?ffentlichen
>>> Rechts; Gerichtsstand: Hamburg | www.uke.de
>>> Vorstandsmitglieder: Prof. Dr. Christian Gerloff (Vorsitzender),
>>> Joachim Pr?l?, Prof. Dr. Blanche Schwappach-Pignataro, Corinna Wriedt
>>> _____________________________________________________________________
>>
>> _______________________________________________
>> R-sig-mixed-models at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> 
> 
> --
> 
> _____________________________________________________________________
> 
> Universit?tsklinikum Hamburg-Eppendorf; K?rperschaft des ?ffentlichen Rechts; Gerichtsstand: Hamburg | www.uke.de
> Vorstandsmitglieder: Prof. Dr. Christian Gerloff (Vorsitzender), Joachim Pr?l?, Prof. Dr. Blanche Schwappach-Pignataro, Corinna Wriedt
> _____________________________________________________________________


From |@ur@_|ee @end|ng |rom |w@@gov  Wed Jul 31 15:08:59 2024
From: |@ur@_|ee @end|ng |rom |w@@gov (Lee, Laura M)
Date: Wed, 31 Jul 2024 13:08:59 +0000
Subject: [R-sig-ME] [EXTERNAL] AW: [EXT] Re:  Re: partial effects plots
In-Reply-To: <001401dae314$29339b70$7b9ad250$@uke.de>
References: <MN2PR09MB4937A1E0238B0D03549B4F7590B02@MN2PR09MB4937.namprd09.prod.outlook.com>
 <c85f731f-22a7-4369-870f-bee559298a78@gmail.com>
 <00f301dae2bf$45bb61b0$d1322510$@uke.de>
 <5e1613f0-94b2-45e3-9a93-ddfc2d7a8f7f@gmail.com>
 <6cc7ed9f-509a-4867-981f-4e22661d96fa@mcmaster.ca>
 <001401dae314$29339b70$7b9ad250$@uke.de>
Message-ID: <MN2PR09MB49370A3C1D86AB813E4BBA7C90B12@MN2PR09MB4937.namprd09.prod.outlook.com>

Thanks, everyone, for your quick response. I am interested in the relationship between the outcome and each explanatory variable. I am interested in creating plots similar to Figures 4a and 4b in the paper at  https://www.frontiersin.org/journals/marine-science/articles/10.3389/fmars.2023.1154689/full#h10.

I tried running peplot() using the code from the link Daniel (https://rpubs.com/milesdwilliams15/328471), but could not get it to work.

I was able to extract effects using the 'remef' package (https://github.com/hohenstein/remef), but I am not sure where to go from there.


Best,

Laura



-----Original Message-----
From: Daniel L?decke <d.luedecke at uke.de>
Sent: Wednesday, July 31, 2024 2:38 AM
To: 'John Fox' <jfox at mcmaster.ca>; 'Ben Bolker' <bbolker at gmail.com>; Lee, Laura M <laura_lee at fws.gov>
Cc: r-sig-mixed-models at r-project.org
Subject: [EXTERNAL] AW: [EXT] Re: [R-sig-ME] Re: partial effects plots



 This email has been received from outside of DOI - Use caution before clicking on links, opening attachments, or responding.



Dear all,
yes, partial *residuals* are possible with the effects package (see https://cran.r-project.org/web/packages/effects/vignettes/partial-residuals.pdf) or ggeffects (https://strengejacke.github.io/ggeffects/articles/introduction_partial_residuals.html).

I don't think partial *regression* plots are possible for any of those packages (maybe for the effects package, I'm not sure).

Laura, maybe you can clarify what kind of plots you would like to have? Terminology may be unclear here. I'm not sure if I confused partial *effects* with partial *regression* plots. Beside the mentioned functions in the car-package, this website describes partial-effects plots: https://rpubs.com/milesdwilliams15/328471

Best
Daniel

-----Urspr?ngliche Nachricht-----
Von: John Fox <jfox at mcmaster.ca>
Gesendet: Dienstag, 30. Juli 2024 23:08
An: Ben Bolker <bbolker at gmail.com>; Daniel L?decke <d.luedecke at uke.de>; Laura_Lee at fws.gov
Cc: r-sig-mixed-models at r-project.org
Betreff: [EXT] Re: [R-sig-ME] Re: partial effects plots

Dear Ben, Daniel, and Laura,

First, added-variable (partial-regression) plots are often confused with component + residuals (partial-residual) plots, but they are not the same.

Second, "effect" plots are essentially component + residuals plots (possibly without the residuals).

Finally, it's possible to show partial residuals in effect plots for mixed models constructed by the effects package.

I hope this helps,
  John

--
John Fox, Professor Emeritus
McMaster University
Hamilton, Ontario, Canada
web: https://www.john-fox.ca/
--

On 2024-07-30 4:52 p.m., Ben Bolker wrote:
> Caution: External email.
>
>
>    OK, in this case you'll need to be able to generate partial
> residuals, which may be doable via the package at
> https://gith/
> ub.com%2Fhohenstein%2Fremef&data=05%7C02%7CLaura_Lee%40fws.gov%7C9c1f9
> 42cac544a28211c08dcb12bdd0a%7C0693b5ba4b184d7b9341f32f400a5494%7C0%7C0
> %7C638580049186171278%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQ
> IjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C0%7C%7C%7C&sdata=cZEOirnq
> pSl%2BOiEfZJNbguKdfw2Szm7jznMZTDXi7X0%3D&reserved=0
>
> On 7/30/24 16:30, Daniel L?decke wrote:
>> I'm not sure if the partial effects plots differ from what emmeans,
>> ggeffects, effects etc. plot by default.
>> Isn't another name for "partial effects plots" the "added variables
>> plot", implemented in car::avPlot() / car::avPlots()?
>>
>> Not sure if mixed models are supported, though.
>>
>> -----Urspr?ngliche Nachricht-----
>> Von: R-sig-mixed-models <r-sig-mixed-models-bounces at r-project.org> Im
>> Auftrag von Ben Bolker
>> Gesendet: Dienstag, 30. Juli 2024 22:18
>> An: r-sig-mixed-models at r-project.org
>> Betreff: [EXT] Re: [R-sig-ME] partial effects plots
>>
>>     Start with emmeans or effects packages? In particular
>>
>> library(effects)
>>
>> plot(allEffects(fitted_model))
>>
>> On 7/30/24 15:44, Lee, Laura M via R-sig-mixed-models wrote:
>>> Hello all,
>>>
>>> I have fit a GLMM to presence/absence data (family = binomial) from
>>> an acoustic telemetry study. I have five fixed effects-Year (a
>>> factor), Day of Year, Hour of Day, Sex (a factor), and water
>>> temperature-and one random effect-Fish ID (a factor). I am looking
>>> to create partial effects plots for the covariates. Can anyone
>>> direct me to some sample code or suggest a package to help me get
>>> started. My Google searches haven't been very fruitful.
>>>
>>> I would appreciate any assistance on this matter. Thank you for your
>>> time!
>>>
>>>
>>> Best,
>>>
>>> Laura
>>>
>>>
>>> #############################
>>> Laura M. Lee
>>> USFWS - Northeast Fishery Center
>>> P.O. Box 75
>>> 308 Washington Ave.
>>> Lamar, PA  16848
>>> Phone: 570-726-4247 x 50122
>>> Laura_Lee at fws.gov<mailto:Laura_Lee at fws.gov>
>>> #############################
>>>
>>>
>>>
>>>      [[alternative HTML version deleted]]
>>>
>>> _______________________________________________
>>> R-sig-mixed-models at r-project.org mailing list
>>> https://st/
>>> at.ethz.ch%2Fmailman%2Flistinfo%2Fr-sig-mixed-models&data=05%7C02%7C
>>> Laura_Lee%40fws.gov%7C9c1f942cac544a28211c08dcb12bdd0a%7C0693b5ba4b1
>>> 84d7b9341f32f400a5494%7C0%7C0%7C638580049186175290%7CUnknown%7CTWFpb
>>> GZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6M
>>> n0%3D%7C0%7C%7C%7C&sdata=Iu%2F%2Fa6Lh6WVYhRuJztyjq5%2ByY2ogprNblZSpl
>>> taIFzA%3D&reserved=0
>> _______________________________________________
>> R-sig-mixed-models at r-project.org mailing list
>> https://sta/
>> t.ethz.ch%2F&data=05%7C02%7CLaura_Lee%40fws.gov%7C9c1f942cac544a28211
>> c08dcb12bdd0a%7C0693b5ba4b184d7b9341f32f400a5494%7C0%7C0%7C6385800491
>> 86180611%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIi
>> LCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C0%7C%7C%7C&sdata=W2RLKcok9vuM2pvmLCn
>> Q%2B6qQP4w%2BDsc1vcrGO2zf2x8%3D&reserved=0
>> mailman/listinfo/r-sig-mixed-models
>>
>> --
>>
>> _____________________________________________________________________
>>
>> Universit?tsklinikum Hamburg-Eppendorf; K?rperschaft des ?ffentlichen
>> Rechts; Gerichtsstand: Hamburg |
>> http://www/.
>> uke.de%2F&data=05%7C02%7CLaura_Lee%40fws.gov%7C9c1f942cac544a28211c08
>> dcb12bdd0a%7C0693b5ba4b184d7b9341f32f400a5494%7C0%7C0%7C6385800491861
>> 85163%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJ
>> BTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C0%7C%7C%7C&sdata=EWjIv5aRNzXBF8MGyZv%2F
>> cAZWAIZMYET46YxNThcXZrI%3D&reserved=0
>> Vorstandsmitglieder: Prof. Dr. Christian Gerloff (Vorsitzender),
>> Joachim Pr?l?, Prof. Dr. Blanche Schwappach-Pignataro, Corinna Wriedt
>> _____________________________________________________________________
>
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat/
> .ethz.ch%2Fmailman%2Flistinfo%2Fr-sig-mixed-models&data=05%7C02%7CLaur
> a_Lee%40fws.gov%7C9c1f942cac544a28211c08dcb12bdd0a%7C0693b5ba4b184d7b9
> 341f32f400a5494%7C0%7C0%7C638580049186189269%7CUnknown%7CTWFpbGZsb3d8e
> yJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C0%
> 7C%7C%7C&sdata=CYdI3J8r9MpBmF%2BuTxgOXut6TeuaVkIE1uyGpGTk8gM%3D&reserv
> ed=0


--

_____________________________________________________________________

Universit?tsklinikum Hamburg-Eppendorf; K?rperschaft des ?ffentlichen Rechts; Gerichtsstand: Hamburg | http://www.uke.de/
Vorstandsmitglieder: Prof. Dr. Christian Gerloff (Vorsitzender), Joachim Pr?l?, Prof. Dr. Blanche Schwappach-Pignataro, Corinna Wriedt ___________

From d@v|d@h@|pern @end|ng |rom nyu@edu  Wed Jul 31 19:49:02 2024
From: d@v|d@h@|pern @end|ng |rom nyu@edu (David Halpern)
Date: Wed, 31 Jul 2024 13:49:02 -0400
Subject: [R-sig-ME] Speeding up finding non-singular mixed effect models
Message-ID: <CAEkY-QFyNE+OYUaeeoRG89dC241=TSZtQRGY9UjhruYWxC-KwQ@mail.gmail.com>

Hello all,

Not sure if this is necessarily an appropriate venue for this but I wanted
to ask people's thoughts on some work Philip Greengard and I have been
doing on how to more efficiently select random effects in order to find a
parsimonious non-singular model based only on the data and not theoretical
concerns (i.e. the situation described in the Parsimonious Mixed Models
paper (https://arxiv.org/abs/1506.04967)).

We have been testing out the idea of using interpolative decomposition (
https://epubs.siam.org/doi/10.1137/030602678
<https://urldefense.proofpoint.com/v2/url?u=https-3A__epubs.siam.org_doi_10.1137_030602678&d=DwMFaQ&c=slrrB7dE8n7gBJbeO0g-IQ&r=1fI6tPTeZTtBK3UMOX1dxBGvjRjIAz3vir-OsKyH_TA&m=MM3jgHoRDStULujYcqcdTwPTyxlZ0rtlBxrUlqlUgo2_0adaJXDJXAOFyxj5X7CI&s=OwdbvLvQ_pyDTMBCi-u94EJbIiOwRR-2s-7TukE5vEQ&e=>)
as a way of selecting random effects in order to reduce a singular model
without refitting the model multiple times. Interpolative decomposition
finds the columns (or rows) of a matrix that approximately span the column
(or row) space. Our thinking is that this decomposition is a natural tool
for selecting which parameters to include in a non-maximal model.

We played around with data from Gann and Barr (2012) available in the
RePsychLing package (associated with the Parsimonious Mixed Models paper).
In the GB vignette from tthe package, the analysis started with a maximal
model that included four parameters varying by session and four varying by
item. PCA indicated "two dimensions with no variability in the random
effects for session and another two dimensions in the random effects for
item."
The original model is sottrunc2 ~ 1 + T + P + F + TP + TF + PF + TPF + (1 +
T + F + TF | session) + (1 + T + P + TP | item)
Using the algorithm described in the Parsimonious Mixed Models paper
requires fitting the model five times to arrive at a non-singular model.
The final model is:
sottrunc2 ~ 1 + T + P + F + TP + TF + PF + TPF + (1 + F | session) + (0 + T
| session) + (1 | item).

In our approach, after fitting the maximal model, we apply an interpolative
decomposition to both session and item random effects covariance matrices
to find the best 2x2 submatrices:
sottrunc2 ~ 1 + T + P + F + TP + TF + PF + TPF + (1 + F | session) + (1 + P
| item). However, when we refit, we find that the item random effects are
still not full rank. We run the process again and find a final model:
sottrunc2 ~ 1 + T + P + F + TP + TF + PF + TPF + (1 + F | session) + (1 |
item). Assuming that we do not allow for forcing off-diagonal elements to
be 0, this final model matches the model found previously with only three
model fits instead of five.

We also applied the same approach to the Kliegel et al. (2011) dataset
(from the same package) and were able to find the same final model as the
KWDYZ vignette (in the package) using only two model fits rather than three.

With large models, this method could potentially save a substantial amount
of time! But we don't fully understand why initial interpolative
decomposition based on PCA of the full maximal model still results in a
singular fit. We tried applying interpolative decomposition to each batch
of random effects iteratively but this still got us the same result. We'd
be very curious to hear thoughts on the overall approach and any intuition
people might have for why the rank of the random effects matrices seems to
change so much after refitting. Code for our experiments can be found here:
https://github.com/dhalpern/lmer_id/blob/main/lmer_id_experiment_GB.R,
https://github.com/dhalpern/lmer_id/blob/main/lmer_id_experiment_KWDYZ.R.

Thanks so much for any comments or ideas!

Best,
David

	[[alternative HTML version deleted]]


From @|ngm@nn @end|ng |rom gm@||@com  Wed Jul 31 22:10:49 2024
From: @|ngm@nn @end|ng |rom gm@||@com (Henrik Singmann)
Date: Wed, 31 Jul 2024 21:10:49 +0100
Subject: [R-sig-ME] [EXTERNAL] AW: [EXT] Re: Re: partial effects plots
In-Reply-To: <MN2PR09MB49370A3C1D86AB813E4BBA7C90B12@MN2PR09MB4937.namprd09.prod.outlook.com>
References: <MN2PR09MB4937A1E0238B0D03549B4F7590B02@MN2PR09MB4937.namprd09.prod.outlook.com>
 <c85f731f-22a7-4369-870f-bee559298a78@gmail.com>
 <00f301dae2bf$45bb61b0$d1322510$@uke.de>
 <5e1613f0-94b2-45e3-9a93-ddfc2d7a8f7f@gmail.com>
 <6cc7ed9f-509a-4867-981f-4e22661d96fa@mcmaster.ca>
 <001401dae314$29339b70$7b9ad250$@uke.de>
 <MN2PR09MB49370A3C1D86AB813E4BBA7C90B12@MN2PR09MB4937.namprd09.prod.outlook.com>
Message-ID: <CA+rDMKJU_iA+nP4NP62HWMg8aKzp5bm4hB2H7rJXbDpe2z85jQ@mail.gmail.com>

Hi Laura,

These plots can be produced with the gratia package:
https://gavinsimpson.github.io/gratia/

Please note that these plots are based on GAMMs and not GLMMs. The easiest
way to see this is that the effect of each variable on the x-axis does not
follow a simple parametric form (e.g., linear or curvilinear) but is
non-linear and recovered from the data (using a spline). If you want to
produce such a plot, you need to fit a GAM, which you can do using package
mgcv.

Best,
Henrik


Am Mi., 31. Juli 2024 um 14:09 Uhr schrieb Lee, Laura M via
R-sig-mixed-models <r-sig-mixed-models at r-project.org>:

> Thanks, everyone, for your quick response. I am interested in the
> relationship between the outcome and each explanatory variable. I am
> interested in creating plots similar to Figures 4a and 4b in the paper at
> https://www.frontiersin.org/journals/marine-science/articles/10.3389/fmars.2023.1154689/full#h10
> .
>
> I tried running peplot() using the code from the link Daniel (
> https://rpubs.com/milesdwilliams15/328471), but could not get it to work.
>
> I was able to extract effects using the 'remef' package (
> https://github.com/hohenstein/remef), but I am not sure where to go from
> there.
>
>
> Best,
>
> Laura
>
>
>
> -----Original Message-----
> From: Daniel L?decke <d.luedecke at uke.de>
> Sent: Wednesday, July 31, 2024 2:38 AM
> To: 'John Fox' <jfox at mcmaster.ca>; 'Ben Bolker' <bbolker at gmail.com>; Lee,
> Laura M <laura_lee at fws.gov>
> Cc: r-sig-mixed-models at r-project.org
> Subject: [EXTERNAL] AW: [EXT] Re: [R-sig-ME] Re: partial effects plots
>
>
>
>  This email has been received from outside of DOI - Use caution before
> clicking on links, opening attachments, or responding.
>
>
>
> Dear all,
> yes, partial *residuals* are possible with the effects package (see
> https://cran.r-project.org/web/packages/effects/vignettes/partial-residuals.pdf)
> or ggeffects (
> https://strengejacke.github.io/ggeffects/articles/introduction_partial_residuals.html
> ).
>
> I don't think partial *regression* plots are possible for any of those
> packages (maybe for the effects package, I'm not sure).
>
> Laura, maybe you can clarify what kind of plots you would like to have?
> Terminology may be unclear here. I'm not sure if I confused partial
> *effects* with partial *regression* plots. Beside the mentioned functions
> in the car-package, this website describes partial-effects plots:
> https://rpubs.com/milesdwilliams15/328471
>
> Best
> Daniel
>
> -----Urspr?ngliche Nachricht-----
> Von: John Fox <jfox at mcmaster.ca>
> Gesendet: Dienstag, 30. Juli 2024 23:08
> An: Ben Bolker <bbolker at gmail.com>; Daniel L?decke <d.luedecke at uke.de>;
> Laura_Lee at fws.gov
> Cc: r-sig-mixed-models at r-project.org
> Betreff: [EXT] Re: [R-sig-ME] Re: partial effects plots
>
> Dear Ben, Daniel, and Laura,
>
> First, added-variable (partial-regression) plots are often confused with
> component + residuals (partial-residual) plots, but they are not the same.
>
> Second, "effect" plots are essentially component + residuals plots
> (possibly without the residuals).
>
> Finally, it's possible to show partial residuals in effect plots for mixed
> models constructed by the effects package.
>
> I hope this helps,
>   John
>
> --
> John Fox, Professor Emeritus
> McMaster University
> Hamilton, Ontario, Canada
> web: https://www.john-fox.ca/
> --
>
> On 2024-07-30 4:52 p.m., Ben Bolker wrote:
> > Caution: External email.
> >
> >
> >    OK, in this case you'll need to be able to generate partial
> > residuals, which may be doable via the package at
> > https://gith/
> > ub.com%2Fhohenstein%2Fremef&data=05%7C02%7CLaura_Lee%40fws.gov%7C9c1f9
> > 42cac544a28211c08dcb12bdd0a%7C0693b5ba4b184d7b9341f32f400a5494%7C0%7C0
> > %7C638580049186171278%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQ
> > IjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C0%7C%7C%7C&sdata=cZEOirnq
> > pSl%2BOiEfZJNbguKdfw2Szm7jznMZTDXi7X0%3D&reserved=0
> >
> > On 7/30/24 16:30, Daniel L?decke wrote:
> >> I'm not sure if the partial effects plots differ from what emmeans,
> >> ggeffects, effects etc. plot by default.
> >> Isn't another name for "partial effects plots" the "added variables
> >> plot", implemented in car::avPlot() / car::avPlots()?
> >>
> >> Not sure if mixed models are supported, though.
> >>
> >> -----Urspr?ngliche Nachricht-----
> >> Von: R-sig-mixed-models <r-sig-mixed-models-bounces at r-project.org> Im
> >> Auftrag von Ben Bolker
> >> Gesendet: Dienstag, 30. Juli 2024 22:18
> >> An: r-sig-mixed-models at r-project.org
> >> Betreff: [EXT] Re: [R-sig-ME] partial effects plots
> >>
> >>     Start with emmeans or effects packages? In particular
> >>
> >> library(effects)
> >>
> >> plot(allEffects(fitted_model))
> >>
> >> On 7/30/24 15:44, Lee, Laura M via R-sig-mixed-models wrote:
> >>> Hello all,
> >>>
> >>> I have fit a GLMM to presence/absence data (family = binomial) from
> >>> an acoustic telemetry study. I have five fixed effects-Year (a
> >>> factor), Day of Year, Hour of Day, Sex (a factor), and water
> >>> temperature-and one random effect-Fish ID (a factor). I am looking
> >>> to create partial effects plots for the covariates. Can anyone
> >>> direct me to some sample code or suggest a package to help me get
> >>> started. My Google searches haven't been very fruitful.
> >>>
> >>> I would appreciate any assistance on this matter. Thank you for your
> >>> time!
> >>>
> >>>
> >>> Best,
> >>>
> >>> Laura
> >>>
> >>>
> >>> #############################
> >>> Laura M. Lee
> >>> USFWS - Northeast Fishery Center
> >>> P.O. Box 75
> >>> 308 Washington Ave.
> >>> Lamar, PA  16848
> >>> Phone: 570-726-4247 x 50122
> >>> Laura_Lee at fws.gov<mailto:Laura_Lee at fws.gov>
> >>> #############################
> >>>
> >>>
> >>>
> >>>      [[alternative HTML version deleted]]
> >>>
> >>> _______________________________________________
> >>> R-sig-mixed-models at r-project.org mailing list
> >>> https://st/
> >>> at.ethz.ch%2Fmailman%2Flistinfo%2Fr-sig-mixed-models&data=05%7C02%7C
> >>> Laura_Lee%40fws.gov%7C9c1f942cac544a28211c08dcb12bdd0a%7C0693b5ba4b1
> >>> 84d7b9341f32f400a5494%7C0%7C0%7C638580049186175290%7CUnknown%7CTWFpb
> >>> GZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6M
> >>> n0%3D%7C0%7C%7C%7C&sdata=Iu%2F%2Fa6Lh6WVYhRuJztyjq5%2ByY2ogprNblZSpl
> >>> taIFzA%3D&reserved=0
> >> _______________________________________________
> >> R-sig-mixed-models at r-project.org mailing list
> >> https://sta/
> >> t.ethz.ch%2F&data=05%7C02%7CLaura_Lee%40fws.gov%7C9c1f942cac544a28211
> >> c08dcb12bdd0a%7C0693b5ba4b184d7b9341f32f400a5494%7C0%7C0%7C6385800491
> >> 86180611%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIi
> >> LCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C0%7C%7C%7C&sdata=W2RLKcok9vuM2pvmLCn
> >> Q%2B6qQP4w%2BDsc1vcrGO2zf2x8%3D&reserved=0
> >> mailman/listinfo/r-sig-mixed-models
> >>
> >> --
> >>
> >> _____________________________________________________________________
> >>
> >> Universit?tsklinikum Hamburg-Eppendorf; K?rperschaft des ?ffentlichen
> >> Rechts; Gerichtsstand: Hamburg |
> >> http://www/.
> >> uke.de%2F&data=05%7C02%7CLaura_Lee%40fws.gov%7C9c1f942cac544a28211c08
> >> dcb12bdd0a%7C0693b5ba4b184d7b9341f32f400a5494%7C0%7C0%7C6385800491861
> >> 85163%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJ
> >> BTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C0%7C%7C%7C&sdata=EWjIv5aRNzXBF8MGyZv%2F
> >> cAZWAIZMYET46YxNThcXZrI%3D&reserved=0
> >> Vorstandsmitglieder: Prof. Dr. Christian Gerloff (Vorsitzender),
> >> Joachim Pr?l?, Prof. Dr. Blanche Schwappach-Pignataro, Corinna Wriedt
> >> _____________________________________________________________________
> >
> > _______________________________________________
> > R-sig-mixed-models at r-project.org mailing list
> > https://stat/
> > .ethz.ch%2Fmailman%2Flistinfo%2Fr-sig-mixed-models&data=05%7C02%7CLaur
> > a_Lee%40fws.gov%7C9c1f942cac544a28211c08dcb12bdd0a%7C0693b5ba4b184d7b9
> > 341f32f400a5494%7C0%7C0%7C638580049186189269%7CUnknown%7CTWFpbGZsb3d8e
> > yJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C0%
> > 7C%7C%7C&sdata=CYdI3J8r9MpBmF%2BuTxgOXut6TeuaVkIE1uyGpGTk8gM%3D&reserv
> > ed=0
>
>
> --
>
> _____________________________________________________________________
>
> Universit?tsklinikum Hamburg-Eppendorf; K?rperschaft des ?ffentlichen
> Rechts; Gerichtsstand: Hamburg | http://www.uke.de/
> Vorstandsmitglieder: Prof. Dr. Christian Gerloff (Vorsitzender), Joachim
> Pr?l?, Prof. Dr. Blanche Schwappach-Pignataro, Corinna Wriedt ___________
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>


-- 
Dr. Henrik Singmann
Associate Professor, Experimental Psychology
University College London (UCL), UK
http://singmann.org

	[[alternative HTML version deleted]]


From bbo|ker @end|ng |rom gm@||@com  Thu Aug  1 17:22:38 2024
From: bbo|ker @end|ng |rom gm@||@com (Ben Bolker)
Date: Thu, 1 Aug 2024 11:22:38 -0400
Subject: [R-sig-ME] Speeding up finding non-singular mixed effect models
In-Reply-To: <CAEkY-QFyNE+OYUaeeoRG89dC241=TSZtQRGY9UjhruYWxC-KwQ@mail.gmail.com>
References: <CAEkY-QFyNE+OYUaeeoRG89dC241=TSZtQRGY9UjhruYWxC-KwQ@mail.gmail.com>
Message-ID: <1c8e7b5f-2fbb-4730-9a35-e7118d90fdaf@gmail.com>

  Overall it seems like a cool idea and well worth pursuing!  There has 
also been increased interested in factor-analytic models as well, which 
represent another possible avenue (but, currently they're not 
implemented in lme4, and it would take quite a bit of work to port them 
over from their glmmTMB implementation ...)

   Unfortunately I don't have any intuitions about the answers to your 
questions - maybe if I were better at visualizing the geometry of 
five-dimensional positive definite subspaces ... (an idea suggested by 
Phillip Alday recently was thinking about the decomposition of the 
covariance matrix into a diagonal variance matrix and a correlation 
matrix, i.e. Sigma = D^{1/2} C D^{1/2}, and trying to understand when 
singularity was caused by zero elements in D vs. a rank-deficient C ...

   Hopefully Doug Bates will chime in ...

  cheers
    Ben Bolker


On 2024-07-31 1:49 p.m., David Halpern wrote:
> Hello all,
> 
> Not sure if this is necessarily an appropriate venue for this but I wanted
> to ask people's thoughts on some work Philip Greengard and I have been
> doing on how to more efficiently select random effects in order to find a
> parsimonious non-singular model based only on the data and not theoretical
> concerns (i.e. the situation described in the Parsimonious Mixed Models
> paper (https://arxiv.org/abs/1506.04967)).
> 
> We have been testing out the idea of using interpolative decomposition (
> https://epubs.siam.org/doi/10.1137/030602678
> <https://urldefense.proofpoint.com/v2/url?u=https-3A__epubs.siam.org_doi_10.1137_030602678&d=DwMFaQ&c=slrrB7dE8n7gBJbeO0g-IQ&r=1fI6tPTeZTtBK3UMOX1dxBGvjRjIAz3vir-OsKyH_TA&m=MM3jgHoRDStULujYcqcdTwPTyxlZ0rtlBxrUlqlUgo2_0adaJXDJXAOFyxj5X7CI&s=OwdbvLvQ_pyDTMBCi-u94EJbIiOwRR-2s-7TukE5vEQ&e=>)
> as a way of selecting random effects in order to reduce a singular model
> without refitting the model multiple times. Interpolative decomposition
> finds the columns (or rows) of a matrix that approximately span the column
> (or row) space. Our thinking is that this decomposition is a natural tool
> for selecting which parameters to include in a non-maximal model.
> 
> We played around with data from Gann and Barr (2012) available in the
> RePsychLing package (associated with the Parsimonious Mixed Models paper).
> In the GB vignette from tthe package, the analysis started with a maximal
> model that included four parameters varying by session and four varying by
> item. PCA indicated "two dimensions with no variability in the random
> effects for session and another two dimensions in the random effects for
> item."
> The original model is sottrunc2 ~ 1 + T + P + F + TP + TF + PF + TPF + (1 +
> T + F + TF | session) + (1 + T + P + TP | item)
> Using the algorithm described in the Parsimonious Mixed Models paper
> requires fitting the model five times to arrive at a non-singular model.
> The final model is:
> sottrunc2 ~ 1 + T + P + F + TP + TF + PF + TPF + (1 + F | session) + (0 + T
> | session) + (1 | item).
> 
> In our approach, after fitting the maximal model, we apply an interpolative
> decomposition to both session and item random effects covariance matrices
> to find the best 2x2 submatrices:
> sottrunc2 ~ 1 + T + P + F + TP + TF + PF + TPF + (1 + F | session) + (1 + P
> | item). However, when we refit, we find that the item random effects are
> still not full rank. We run the process again and find a final model:
> sottrunc2 ~ 1 + T + P + F + TP + TF + PF + TPF + (1 + F | session) + (1 |
> item). Assuming that we do not allow for forcing off-diagonal elements to
> be 0, this final model matches the model found previously with only three
> model fits instead of five.
> 
> We also applied the same approach to the Kliegel et al. (2011) dataset
> (from the same package) and were able to find the same final model as the
> KWDYZ vignette (in the package) using only two model fits rather than three.
> 
> With large models, this method could potentially save a substantial amount
> of time! But we don't fully understand why initial interpolative
> decomposition based on PCA of the full maximal model still results in a
> singular fit. We tried applying interpolative decomposition to each batch
> of random effects iteratively but this still got us the same result. We'd
> be very curious to hear thoughts on the overall approach and any intuition
> people might have for why the rank of the random effects matrices seems to
> change so much after refitting. Code for our experiments can be found here:
> https://github.com/dhalpern/lmer_id/blob/main/lmer_id_experiment_GB.R,
> https://github.com/dhalpern/lmer_id/blob/main/lmer_id_experiment_KWDYZ.R.
> 
> Thanks so much for any comments or ideas!
> 
> Best,
> David
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models

-- 
Dr. Benjamin Bolker
Professor, Mathematics & Statistics and Biology, McMaster University
Director, School of Computational Science and Engineering
(Acting) Graduate chair, Mathematics & Statistics
 > E-mail is sent at my convenience; I don't expect replies outside of 
working hours.


From |@ur@_|ee @end|ng |rom |w@@gov  Thu Aug  1 20:01:19 2024
From: |@ur@_|ee @end|ng |rom |w@@gov (Lee, Laura M)
Date: Thu, 1 Aug 2024 18:01:19 +0000
Subject: [R-sig-ME] specifying multiple random effects in glmmML
Message-ID: <MN2PR09MB493726857161CF6E6D8622D090B22@MN2PR09MB4937.namprd09.prod.outlook.com>

Hi all,

I need to run a model in glmmML due to a restriction in some companion code. Is it possible to specify multiple random effects in the glmmML function? I would appreciate if someone could provide an example.

Thanks so much for your time!


Best,

Laura



#############################
Laura M. Lee
USFWS - Northeast Fishery Center
P.O. Box 75
308 Washington Ave.
Lamar, PA  16848
Phone: 570-726-4247 x 50122
Laura_Lee at fws.gov<mailto:Laura_Lee at fws.gov>
#############################



	[[alternative HTML version deleted]]


From bbo|ker @end|ng |rom gm@||@com  Thu Aug  1 22:45:35 2024
From: bbo|ker @end|ng |rom gm@||@com (Ben Bolker)
Date: Thu, 1 Aug 2024 16:45:35 -0400
Subject: [R-sig-ME] specifying multiple random effects in glmmML
In-Reply-To: <MN2PR09MB493726857161CF6E6D8622D090B22@MN2PR09MB4937.namprd09.prod.outlook.com>
References: <MN2PR09MB493726857161CF6E6D8622D090B22@MN2PR09MB4937.namprd09.prod.outlook.com>
Message-ID: <3f16493a-b733-4abf-aa48-dc8c24fc6083@gmail.com>

 ?? It seems impossible.? From the vignette 
https://cran.r-project.org/web/packages/glmmML/vignettes/glmmML.pdf :

 > The package glmmML generalises in
other directions. First, **it is only implemented for the simple random
intercepts model** and the Binomial and Poisson distributions, but it al-
lows for other distributions than the Normal for the random intercepts

 ? I can't think of any way to work around this limitation.

 ? I would guess the only way you will get further confirmation of this 
would be to ask the maintainer (but I'm not sure it makes sense to waste 
their time, as the documentation seems clear ...)

 ? good luck,

 ??? Ben Bolker

On 8/1/24 14:01, Lee, Laura M via R-sig-mixed-models wrote:
> Hi all,
>
> I need to run a model in glmmML due to a restriction in some companion code. Is it possible to specify multiple random effects in the glmmML function? I would appreciate if someone could provide an example.
>
> Thanks so much for your time!
>
>
> Best,
>
> Laura
>
>
>
> #############################
> Laura M. Lee
> USFWS - Northeast Fishery Center
> P.O. Box 75
> 308 Washington Ave.
> Lamar, PA  16848
> Phone: 570-726-4247 x 50122
> Laura_Lee at fws.gov<mailto:Laura_Lee at fws.gov>
> #############################
>
>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models


From kenj|ro @end|ng |rom @ho|n@@c@jp  Tue Aug 27 11:09:36 2024
From: kenj|ro @end|ng |rom @ho|n@@c@jp (N o s t a l g i a)
Date: Tue, 27 Aug 2024 18:09:36 +0900
Subject: [R-sig-ME] How to interpret the output for nested random factors in
 glmer and what to write in a table
Message-ID: <574cb6e7-58e6-4583-aea5-b76968ff4d30@shoin.ac.jp>

Hi, this is something I posted on Cross Validated a few days ago, but 
since I failed to get any substantial answers, I am posting a question 
here, hoping someone could help me, as I am getting desperate.

I am looking at an alternation of a character in a word using a Japanese 
congressional record. I have a binary outcome dependent variable (kuni), 
the date of the meeting expressed as the standardized number of days 
since 1949/05/31 (days_cnt2) as the only fixed variable, and two random 
factors for meeting (meetid) and word (morphid). Because there are 
several meetings in a given day, and a meeting is specific to a specific 
day, the meeting variable is nested under days_cnt2. Thus, the model 
looks like kuni~days_cnt2+(1+days_cnt2|morphid)+(1|days_cnt2/meetid). I 
ran a binomial logistic regression with glmer and got the following output:

Command:
result <- 
glmer(kuni~days_cnt2+(1+days_cnt2|morphid)+(1|days_cnt2/meetid),data=glmmdata6,family=binomial, 
control=glmerControl(optimizer="bobyqa",optCtrl=list(maxfun=2e5))

A part of the output (summary):
Random effects:
  Groups           Name        Variance Std.Dev. Corr
  meetid:days_cnt2 (Intercept) 14.0795  3.7523
  days_cnt2        (Intercept) 26.7335  5.1704
  morphid          (Intercept)  3.3889  1.8409
                   days_cnt2    0.2283  0.4778   0.71
Number of obs: 748186, groups:
meetid:days_cnt2, 12034; days_cnt2, 1189; morphid, 301

Fixed effects:
             Estimate Std. Error z value Pr(>|z|)
(Intercept)  -9.2793     0.3416  -27.16   <2e-16 ***
days_cnt2   -11.8274     0.3045  -38.84   <2e-16 ***

The ICC values are:
Adjusted ICC: 0.931 Unadjusted ICC: 0.237

Now I have several questions for this result:

1. Am I right in saying word (morphid) has less effect than meeting 
(meetid) on kuni, based on the fact that the former has only about half 
SD (1.8409) of the latter (3.7523)?

2. How should I interpret the two days_cnt2 parameter values in the 
random effects section?

3. When publishing the result in a paper, should I include the values 
for all of the four effects (meetid:days_cnt2, days_cnt2, morphid, and 
days_cnt2) or should I skip days_cnt2?

Thanks in advance,

Kenjiro Matsuda


From rez@che|oe| @end|ng |rom y@hoo@com  Tue Sep  3 15:30:06 2024
From: rez@che|oe| @end|ng |rom y@hoo@com (reza cheloei)
Date: Tue, 3 Sep 2024 13:30:06 +0000 (UTC)
Subject: [R-sig-ME] Help
References: <2051608306.3019231.1725370206148.ref@mail.yahoo.com>
Message-ID: <2051608306.3019231.1725370206148@mail.yahoo.com>

Hello,I studied agriculture. I have data related to a number of genotypes cultivated under two different environmental conditions (stress and normal) and I want to analyze these data with the BLUPs method, but I have little information about the BLUPs method.It is possible for you to guide me and tell me with which of the functions of the "lme4" package that you prepared to perform my analysis.I am waiting for your reply and thank you in advance for your sincere help.
Best regards,
Reza

	[[alternative HTML version deleted]]


From bbo|ker @end|ng |rom gm@||@com  Tue Sep  3 18:12:55 2024
From: bbo|ker @end|ng |rom gm@||@com (Ben Bolker)
Date: Tue, 3 Sep 2024 12:12:55 -0400
Subject: [R-sig-ME] Help
In-Reply-To: <2051608306.3019231.1725370206148@mail.yahoo.com>
References: <2051608306.3019231.1725370206148.ref@mail.yahoo.com>
 <2051608306.3019231.1725370206148@mail.yahoo.com>
Message-ID: <74bcae6f-967b-4fb8-9fd0-f266b97fab34@gmail.com>

   Reza,

   You have to give us a lot more information before we can help you.
   By "BLUPs method" you probably mean a mixed model, but it's hard to 
tell.  Can you post a link or reference (presumably you found out about 
this method somewhere ...) ?  Typically a mixed model for genotypes 
cultivated under different conditions would look something like

lmer(trait ~ 1 + condition + (1 + condition | genotype), data = your_data)

  but the full process of fitting and interpreting a mixed model is 
complex. You might start with Pinheiro and Bates "Mixed-Effects Models 
in S and S-PLUS" (this uses an older, but perfectly functional, package 
called nlme).  Alternately, there are many, many blogs and resources online.



On 2024-09-03 9:30 a.m., reza cheloei via R-sig-mixed-models wrote:
> Hello,I studied agriculture. I have data related to a number of genotypes cultivated under two different environmental conditions (stress and normal) and I want to analyze these data with the BLUPs method, but I have little information about the BLUPs method.It is possible for you to guide me and tell me with which of the functions of the "lme4" package that you prepared to perform my analysis.I am waiting for your reply and thank you in advance for your sincere help.
> Best regards,
> Reza
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models

-- 
Dr. Benjamin Bolker
Professor, Mathematics & Statistics and Biology, McMaster University
Director, School of Computational Science and Engineering
 > E-mail is sent at my convenience; I don't expect replies outside of 
working hours.


From k|m@pe@rce @end|ng |rom newc@@t|e@@c@uk  Wed Sep  4 13:54:51 2024
From: k|m@pe@rce @end|ng |rom newc@@t|e@@c@uk (Kim Pearce)
Date: Wed, 4 Sep 2024 11:54:51 +0000
Subject: [R-sig-ME] lme4 for a 4 level hierarchy
Message-ID: <LO0P302MB02119CF704BE760C64EB44F2D79C2@LO0P302MB0211.GBRP302.PROD.OUTLOOK.COM>


Hello everyone,

If I may, I'd like to ask if I am visualising the correct syntax to use for a hypothetical situation using a mixed effects logistic regression with a 4 level hierarchy.

Say we have nurses which are nested within wards and the wards are nested within hospitals and hospitals are nested within regions of the UK. Each nurse has a binary response recorded (Y). Nurses are at level 1, wards at level 2, hospitals at level 3 and regions at level 4.  Say each ward has one category of an ordered 3 category intervention applied where a higher ordered category of intervention was hypothesised to affect a nurse's binary response.

Hypothetically, I wish to generate a model with a fixed effect for "Intervention" and random (and fixed) intercepts for (i) each region, (ii) each region x hospital combination and (iii) each region x hospital x ward combination.  Would the following syntax be appropriate?

Note intervention appears in the model as a factor below.

m1<-glmer(Y~interventionf+(1|region/hospital/ward),data=data,family=binomial,control=glmerControl(optimizer="bobyqa"))

Many thanks for your views.
Kind regards,
Kim

Dr Kim Pearce PhD, CStat, Fellow HEA
Newcastle University 


From th|erry@onke||nx @end|ng |rom |nbo@be  Wed Sep  4 14:48:05 2024
From: th|erry@onke||nx @end|ng |rom |nbo@be (Thierry Onkelinx)
Date: Wed, 4 Sep 2024 14:48:05 +0200
Subject: [R-sig-ME] lme4 for a 4 level hierarchy
In-Reply-To: <LO0P302MB02119CF704BE760C64EB44F2D79C2@LO0P302MB0211.GBRP302.PROD.OUTLOOK.COM>
References: <LO0P302MB02119CF704BE760C64EB44F2D79C2@LO0P302MB0211.GBRP302.PROD.OUTLOOK.COM>
Message-ID: <CAJuCY5yvgeCYJ83TNkg1BfTxSEOB=0LR+WntzSWWYb2ttSwm=g@mail.gmail.com>

Dear Kim,

Since every nurse has a single binary response, you can summarise the data
at the ward level
c(number of nurse success, number of nurses failure)
In this case the ward random effect would be an observation level random
effect. I'm not sure if you want that.

Best wishes,

ir. Thierry Onkelinx
Statisticus / Statistician

Vlaamse Overheid / Government of Flanders
INSTITUUT VOOR NATUUR- EN BOSONDERZOEK / RESEARCH INSTITUTE FOR NATURE AND
FOREST
Team Biometrie & Kwaliteitszorg / Team Biometrics & Quality Assurance
thierry.onkelinx at inbo.be
Havenlaan 88 bus 73, 1000 Brussel
*Postadres:* Koning Albert II-laan 15 bus 186, 1210 Brussel
*Poststukken die naar dit adres worden gestuurd, worden ingescand en
digitaal aan de geadresseerde bezorgd. Zo kan de Vlaamse overheid haar
dossiers volledig digitaal behandelen. Poststukken met de vermelding
?vertrouwelijk? worden niet ingescand, maar ongeopend aan de geadresseerde
bezorgd.*
www.inbo.be

///////////////////////////////////////////////////////////////////////////////////////////
To call in the statistician after the experiment is done may be no more
than asking him to perform a post-mortem examination: he may be able to say
what the experiment died of. ~ Sir Ronald Aylmer Fisher
The plural of anecdote is not data. ~ Roger Brinner
The combination of some data and an aching desire for an answer does not
ensure that a reasonable answer can be extracted from a given body of data.
~ John Tukey
///////////////////////////////////////////////////////////////////////////////////////////

<https://www.inbo.be>


Op wo 4 sep 2024 om 13:55 schreef Kim Pearce via R-sig-mixed-models <
r-sig-mixed-models at r-project.org>:

>
> Hello everyone,
>
> If I may, I'd like to ask if I am visualising the correct syntax to use
> for a hypothetical situation using a mixed effects logistic regression with
> a 4 level hierarchy.
>
> Say we have nurses which are nested within wards and the wards are nested
> within hospitals and hospitals are nested within regions of the UK. Each
> nurse has a binary response recorded (Y). Nurses are at level 1, wards at
> level 2, hospitals at level 3 and regions at level 4.  Say each ward has
> one category of an ordered 3 category intervention applied where a higher
> ordered category of intervention was hypothesised to affect a nurse's
> binary response.
>
> Hypothetically, I wish to generate a model with a fixed effect for
> "Intervention" and random (and fixed) intercepts for (i) each region, (ii)
> each region x hospital combination and (iii) each region x hospital x ward
> combination.  Would the following syntax be appropriate?
>
> Note intervention appears in the model as a factor below.
>
>
> m1<-glmer(Y~interventionf+(1|region/hospital/ward),data=data,family=binomial,control=glmerControl(optimizer="bobyqa"))
>
> Many thanks for your views.
> Kind regards,
> Kim
>
> Dr Kim Pearce PhD, CStat, Fellow HEA
> Newcastle University
>
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>

	[[alternative HTML version deleted]]


From noe||@@v@|derr@m@ @end|ng |rom @|r|c@mu@eum@be  Wed Sep  4 16:47:25 2024
From: noe||@@v@|derr@m@ @end|ng |rom @|r|c@mu@eum@be (Noelia Valderrama)
Date: Wed, 4 Sep 2024 14:47:25 +0000
Subject: [R-sig-ME] Logistic mixed model selection
Message-ID: <PR3P195MB06845C9A38CFCA26BDAAE91EE29C2@PR3P195MB0684.EURP195.PROD.OUTLOOK.COM>

Dear community,

I am currently evaluating the presence / absence of snails in the Southern part of Uganda. My study involves 56 water-contact sites, categorized into 4 types (lake, wetland, stream, spring). Each site has been sampled at least 20 times over the past 2 years and a half.

I built a logistic mixed-effect model with the following structure:

snail_pres ~ precipitation + temperature + Site.type * NDVI + elevation + flow_accumulation + slope_steepness + (1 | Watercontactsite)

For model selection, I generated all possible combinations of variables 2n-1 = 127 and ranked them by AIC. Based on the recommendation that models with an AIC difference of less than 2 are considered comparable, I selected all models within this interval. I then calculated the marginal and conditional R2  using the r.squaredGLMM() function from the MuMIn package. From this subset of models, I chose the one with the highest R2 values.

I have two datasets with the same variables, one sampled by citizen scientists and the other by an expert. My goal is to compare the best models for each dataset to determine if the same variables are significant.

Given the mixed opinions on the use of R? with mixed models, I want to ensure that my approach is correct. This paper [https://besjournals.onlinelibrary.wiley.com/doi/10.1111/j.2041-210x.2012.00261.x] suggests that using R? with binomial responses is acceptable, but I would appreciate any feedback or suggestions to refine my methodology.

Thank you so much for your suggestions!
Best regards,

Noelia

	[[alternative HTML version deleted]]


From k|m@pe@rce @end|ng |rom newc@@t|e@@c@uk  Thu Sep  5 09:16:00 2024
From: k|m@pe@rce @end|ng |rom newc@@t|e@@c@uk (Kim Pearce)
Date: Thu, 5 Sep 2024 07:16:00 +0000
Subject: [R-sig-ME] lme4 for a 4 level hierarchy : revisited
Message-ID: <LO0P302MB02119BED9D2CEA11BC97F471D79D2@LO0P302MB0211.GBRP302.PROD.OUTLOOK.COM>

Hello everyone,

I am rephrasing the question I sent to the list yesterday for clarity and wondered if anyone has any further views?  

My example yesterday was hypothetical and I was questioning whether the syntax I provide below (including the term (1|region/hospital/ward)) is appropriate for a 4 level hierarchical model.  This term is an extension of that detailed for a 3 level hierarchy in Table 2 (page 7) of the paper "Fitting Linear Mixed-Effects Models Using lme4" by Douglas Bates, Martin M?chler, Ben Bolker and Steve Walker. In this document, the authors stipulate that a term of the form (1|g1/g2) would mean that a model would be generated with the intercept varying among (i) g1 and (ii) g2 within g1  (i.e. intercepts would be generated (i) for each level of g1 and (ii) for each level produced by the g1 x g2 combination).

I discuss a mixed effects logistic regression below with a 4 level hierarchy but the term (1|region/hospital/ward) would be appropriate too if my response had been of a continuous nature and we were instead using lmer() rather than glmer().

In my hypothetical example, we have nurses which are nested within wards and the wards are nested within hospitals and hospitals are nested within regions of the UK. Each nurse has a binary response recorded (Y). Nurses are at level 1, wards at level 2, hospitals at level 3 and regions at level 4.  Say each ward has one category of an ordered 3 category intervention applied where a higher ordered category of intervention was hypothesised to affect a nurse's binary response.

Hypothetically, I wish to generate a model with a fixed effect for "Intervention" and intercepts for (i) each region, (ii) each region x hospital combination and (iii) each region x hospital x ward combination.  Additionally, an intercept would be included in the fixed-effects portion of the model by default.  Would the following syntax be appropriate?

Note intervention appears in the model as a factor below.

m1<-glmer(Y~interventionf+(1|region/hospital/ward),data=data,family=binomial,control=glmerControl(optimizer="bobyqa"))

Various online sources have hinted that we could approach an example such as this by considering this as a 2 level hierarchy with nurses (level 1) nested within wards (level 2) and having variables which identify hospitals and regions merely added as predictors in the model - but this seems suspect to me as we would not be considering the full nested nature of the design.

Many thanks for your views.
Kind regards,
Kim

Dr Kim Pearce PhD, CStat, Fellow HEA
Newcastle University


From o||verhooker @end|ng |rom pr@t@t|@t|c@@com  Wed Sep 25 13:53:00 2024
From: o||verhooker @end|ng |rom pr@t@t|@t|c@@com (Oliver Hooker)
Date: Wed, 25 Sep 2024 12:53:00 +0100
Subject: [R-sig-ME] =?utf-8?q?IN_PERSON_COURSE_=E2=80=93_Hierarchical_mod?=
	=?utf-8?q?elling_in_ecology_=28HMIE01=29_=28Universit=C3=A9_de_She?=
	=?utf-8?q?rbrooke=2C_Canada=29?=
Message-ID: <CAEsSYzyjX+AYGqFSaQkN86pfmrKjmF18_0KnH_vQJU-7-_8fvQ@mail.gmail.com>

IN PERSON COURSE ? Hierarchical modelling in ecology (HMIE01) (Universit?
de Sherbrooke, Canada)

https://www.prstats.org/course/hierarchical-modelling-in-ecology-hmie01/

Where - Longueuil Campus <https://tinyurl.com/y5pntkxc> of Universit? de
Sherbrooke

When - Monday 11th - Frtiday 15th November

Please feel free to share!


COURSE OVERVIEW - More than ever in biology and ecology we need statistical
modelling tools that go beyond the basic linear or generalized linear
models. The next evolution in statistical modelling are hierarchical
models, also known as mixed models. Hierarchical models are complex tools
that have the potential to bring your research to the next level. However,
to understand hierarchical models properly, in this course we will briefly
discuss probability theory, the frequentists and Bayesian paradigms and
(generalized) linear models before studying hierarchical models. The
discussions on hierarchical models will first focus on simple hierarchical
models and as we advance in the course, we will study the basis of
constrained hierarchical models (i.e. in space or time) and multivariate
hierarchical models. The course will be a mixed of theory and practice. To
implement the models we will discuss in the course, we will be using the
Stan programming language, a flexible programming infrastructure designed
to construct any hierarchical models from the simplest to the most complex
ones. Stan is a programming language that is typically used through a
higher-level programming language such as R, python or Julia. In this
respect, although all our examples and practical exercises will be carried
out using R, any language that can interface with Stan can be used.

By the end of the course, participants should have:

   - Learned statistical theory to better construct, apply and interpret
   different statistical models applied to biology and ecology.
   - Become familiar with primary research in statistical modelling in
   biology and ecology.
   - Gained experience in working collaboratively on issues related to the
   development and application of statistical methods.

Please email oliverhooker at prstatistics.com with any questions.

-- 
Best wishes,

Oliver

Oliver Hooker PhD.
PR stats

	[[alternative HTML version deleted]]


