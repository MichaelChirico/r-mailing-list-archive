From bbolker at gmail.com  Mon Oct  1 00:47:02 2012
From: bbolker at gmail.com (Ben Bolker)
Date: Sun, 30 Sep 2012 22:47:02 +0000 (UTC)
Subject: [R-sig-ME] Subject-wise log-likelihood gradient and hessian
References: <1349019834.24153.YahooMailNeo@web160702.mail.bf1.yahoo.com>
Message-ID: <loom.20121001T004255-34@post.gmane.org>

Rubem Kaipper Ceratti <rubem_ceratti at ...> writes:

> 
> Hi all,
> 
> I'd like to know if it's possible to extract the subject-wise 
> gradient and hessian of the marginal
> log-likelihood from a 'mer' object. 

  Can you explain in slightly greater detail?  What are the
parameters you're taking the gradient and hessian with respect
to -- sounds like the fixed-effect parameters (beta)?  How do
you define "subject-wise"?  The marginal likelihood is only
defined with respect to the full data set, isn't it?

> Using the 'cbpp' dataset as an example:
> 
> library(lme4)
> 
> (m1 <- glmer(size ~ period+(1|herd), cbpp, poisson))

 
> Since apparently there's no way to get what I need directly, I've
> thought about splitting the data frame by 'herd', updating m1 on
> each subset and then calling numDeriv::grad() and
> numDeriv::hessian() on the deviance function of each updated object
> at the estimates from m1, but I couldn't get this approach to work.
> Any input is appreciated. 

  I assume you're already using the development version, as
the deviance function is only available in the development version?

>  Thanks (and sorry for the broken english),

 English seems fine -- it's the technical description that's
eluding me a bit.


From bbolker at gmail.com  Mon Oct  1 00:51:50 2012
From: bbolker at gmail.com (Ben Bolker)
Date: Sun, 30 Sep 2012 22:51:50 +0000 (UTC)
Subject: [R-sig-ME] nlme vs nlmer
References: <k44h67$tcp$1@ger.gmane.org>
Message-ID: <loom.20121001T004722-180@post.gmane.org>

Christof Klu? <ckluss at ...> writes:

> can you give me a hint how to convert a nlme(..) like
> 
> nlme(Y ~ fun(X,a,b,c),
>      fixed  = list(a ~ 1, b ~ 1, c ~ 1),
>      random = list(a ~ 1, b ~ 1, c ~ 1),
>      groups = ~ location,
>      data   = measurements,
>      start  = c(a = 350, b = 0.2, c = 120))
> 
> to an equivalent nlmer(...)? The following seems to be wrong
> 
> nlmer(Y ~ fun(X,a,b,c) ~ (a  + b + c | location),
>               data = measurements,
>               start = c(a = 350, b = 0.2, c = 120))
> 
> it throws "gradient attribute of evaluated model must be a numeric matrix"

  I believe you need to define your own gradient function explicitly
(but you may  be able do it with the deriv() function) -- searching the archives
for examples gives e.g.

https://stat.ethz.ch/pipermail/r-sig-mixed-models/2011q4/006967.html
https://stat.ethz.ch/pipermail/r-sig-mixed-models/2011q1/005727.html


From bbolker at gmail.com  Mon Oct  1 01:00:02 2012
From: bbolker at gmail.com (Ben Bolker)
Date: Sun, 30 Sep 2012 23:00:02 +0000 (UTC)
Subject: [R-sig-ME] nlme-function: Step halving factor reduced below
	minimum in PNLS step
References: <k3uu8d$mg6$1@ger.gmane.org>
Message-ID: <loom.20121001T005224-411@post.gmane.org>

Christof Klu? <ckluss at ...> writes:

> 
> Hi
> 
> can I avoid the error "Step halving factor reduced below minimum in PNLS
> step" by setting a control parameter to a lower value?
> 

  I believe it's the minScale parameter in nlmeControl() (see ?nlmeControl).
However, there's generally a fairly narrow window between (on the one hand)
problems that work OK with the default parameters and (on the other hand)
problems that can be made to work by tweaking the parameters -- once you
start having to adjust the control parameters, the odds are reasonably
high that you're going to have lots of trouble fitting the model no
matter what you do ...
  You might check out AD Model Builder as an alternative, although there's
quite a learning curve ...

  Ben Bolker


From rubem_ceratti at yahoo.com.br  Mon Oct  1 14:18:00 2012
From: rubem_ceratti at yahoo.com.br (Rubem Kaipper Ceratti)
Date: Mon, 1 Oct 2012 05:18:00 -0700 (PDT)
Subject: [R-sig-ME] Subject-wise log-likelihood gradient and hessian
In-Reply-To: <loom.20121001T004255-34@post.gmane.org>
References: <1349019834.24153.YahooMailNeo@web160702.mail.bf1.yahoo.com>
	<loom.20121001T004255-34@post.gmane.org>
Message-ID: <1349093880.26836.YahooMailNeo@web160702.mail.bf1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121001/fc364cc9/attachment.pl>

From philippe.michel.fullsack at gmail.com  Mon Oct  1 14:58:29 2012
From: philippe.michel.fullsack at gmail.com (philippe fullsack)
Date: Mon, 1 Oct 2012 09:58:29 -0300
Subject: [R-sig-ME] user-defined covariance matrix for linear mixed models
Message-ID: <CAKryudea3WUV4uO8bJA1qedm9i7itLQETfvDRG1yD9aFTo2a_w@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121001/1d05d081/attachment.pl>

From vcareau at ucr.edu  Mon Oct  1 18:28:12 2012
From: vcareau at ucr.edu (Vincent Careau)
Date: Mon, 1 Oct 2012 09:28:12 -0700
Subject: [R-sig-ME] user-defined covariance matrix for linear mixed
	models
In-Reply-To: <CAKryudea3WUV4uO8bJA1qedm9i7itLQETfvDRG1yD9aFTo2a_w@mail.gmail.com>
References: <CAKryudea3WUV4uO8bJA1qedm9i7itLQETfvDRG1yD9aFTo2a_w@mail.gmail.com>
Message-ID: <F4BE9DC74ACC435B908CB3FFBF37714C@PCderobo>

Hi,
I would say ASReml-R. It is free for academics using Windows. I don't know
if someone else figured out how to do an animal model (that seems like what
you want to do - or something very similar) with other mixed model packages
in R.  ASReml-R uses the Average Information algorithm. Perhaps the typical
methods used for the R packages would take too long with as many random
effects as an animal model is trying to estimate. 

By the way, Matt Wolak just created the "nadiv" package that you can use to
include dominance in your animal model, given you have the pedigree links to
estimate it independently from additive genetic variance. 
Good luck,
vc

Vincent Careau
NSERC Postdoctoral fellow
Department of Biology
University of California
Riverside, CA, 92521
http://faculty.ucr.edu/~vcareau/


-----Original Message-----
From: r-sig-mixed-models-bounces at r-project.org
[mailto:r-sig-mixed-models-bounces at r-project.org] On Behalf Of philippe
fullsack
Sent: Monday, October 01, 2012 5:58 AM
To: r-sig-mixed-models at r-project.org
Subject: [R-sig-ME] user-defined covariance matrix for linear mixed models

I am looking for an R package or function that would estimate the
variance-covariance matrix of a linear mixed model.
I have used pedigreemm and lme4 for simple examples but I would like to
know how to provide my own covariance structure.
E.g. G, the variance-covariance matrix of a lmm model will typically be the
tensor product of a typically small matrix g (e.g. a 2 x2 matrix of 3
variance-covariance parameters to estimate : sigxx,sigxy,sigyy) with of a
known matrix A. I wish to read matrix A from a file, and ask the R function
to estimate g. I am not interested only in the case of diagonal g matrices.

Is anybody aware of an interface e.g. to lme4, that would allow users to
specify and fit their models in such, flexible, way?
Please specify in your answer the input format for A (i.e sparse CSR,
dense, trios, or any) - (g is in dense format).

Note that a package like Jarrod Hadfield's MCMCglmm allows such flexible
definitions. However, I am looking for a non MCMC estimator (e.g. REML).

P.Fullsack
Dalhousie University

	[[alternative HTML version deleted]]

_______________________________________________
R-sig-mixed-models at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models


From jwiley.psych at gmail.com  Mon Oct  1 18:36:49 2012
From: jwiley.psych at gmail.com (Joshua Wiley)
Date: Mon, 1 Oct 2012 09:36:49 -0700
Subject: [R-sig-ME] Two Questions re: Piecewise mixed effects models
In-Reply-To: <BF2CE7102E190B4FABEED85AB38539C403BB6BDC@ITS-MSXMBS3M.ad.unc.edu>
References: <BF2CE7102E190B4FABEED85AB38539C403BB6BDC@ITS-MSXMBS3M.ad.unc.edu>
Message-ID: <CANz9Z_LQgSb+XAVXZvPA6XYnton9ck68GoNEC1SuDszoeoa8TQ@mail.gmail.com>

I think this is a replicate of another email thread on the list already.

On Sun, Sep 30, 2012 at 2:08 AM, Lofgren, Eric <elofgren at email.unc.edu> wrote:
> I'm relatively new to mixed effects models, and have two fairly basic questions (I think) about a project I'm working on.
>
> Essentially, I'm working on a poisson regression problem where we're trying to estimate the impact of a change in a policy on the rate of an event X. There are N sites where this change has taken place, and we also happen to know another characteristic of each site Z. It's been suggested that I look a a piecewise mixed effects model (which I've also seen referred to as an interrupted time series or "broken stick" model).
>
> I've got two questions about this type of model:
>
> 1. As I understand it, you should have two time variables, a "Time Before" and a "Time After" variable, each of which equals 0 right at the point of the policy change. My question is what these variables should look like, specifically what they should look like after they reach zero. For example, with a simple series of 5 points and the policy change in the middle, should it look like this:
>
> Time Before: 2, 1, 0, NA, NA
> Time After: NA, NA, 0, 1, 2
>
> or this?
>
> Time Before: 2, 1, 0, -1, -2
> TIme After: -2, -1, 0, 1, 2
>
> Or something else entirely?
>
> 2. In terms of using something like glmer() to fit the model itself, I'm a little confused about the syntax (I normally use SAS, but am trying to get better at using R). Following some advice I've seen, I should be using something like this:
>
> model <- glmer( rate ~ policy + time.before + time.after + (1+ time.before + time.after + Z |Site) + offset(log(people)), data=data, family="poisson")
>
> First, is this correct? Second, what's accomplished by having the time variables in both the fixed and random effects sections - what does that produce? A fixed slope and random intercept? Something else?
>
> Thanks,
>
> Eric
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models



-- 
Joshua Wiley
Ph.D. Student, Health Psychology
Programmer Analyst II, Statistical Consulting Group
University of California, Los Angeles
https://joshuawiley.com/


From jmmartelo at fc.ul.pt  Mon Oct  1 20:10:39 2012
From: jmmartelo at fc.ul.pt (joana martelo)
Date: Mon, 1 Oct 2012 19:10:39 +0100
Subject: [R-sig-ME] fixed or random effects?
Message-ID: <004501cda000$10d103b0$32730b10$@ul.pt>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121001/a3b7c717/attachment.pl>

From bates at stat.wisc.edu  Mon Oct  1 21:03:27 2012
From: bates at stat.wisc.edu (Douglas Bates)
Date: Mon, 1 Oct 2012 14:03:27 -0500
Subject: [R-sig-ME] fixed or random effects?
In-Reply-To: <004501cda000$10d103b0$32730b10$@ul.pt>
References: <004501cda000$10d103b0$32730b10$@ul.pt>
Message-ID: <CAO7JsnSDygroQw2YeyeiXkYrt8tn2pLQ39ZVXKZtyTtp8C8Ocw@mail.gmail.com>

On Mon, Oct 1, 2012 at 1:10 PM, joana martelo <jmmartelo at fc.ul.pt> wrote:

> I'm modeling fish activity data with a gaussian distribution for scores
> obtained from Principal Component Analysis, and have a little problem,
> hopefully simple to resolve. My explanatory variables are group size, fish
> length and temperature and I sampled in two consecutive years, in spring. My
> problem is that I'm not sure whether I should consider year as a random or a
> fixed effect. I wonder if you could help me.

For you the year factor will have only two levels and that is too few
to model the effect of year as a random effect.  When you incorporate
a random-effects term in a model you end up estimating a variance
component instead of trying to estimate coefficients in a linear model
expression directly.  Having only two levels of year will not allow
for a precise estimate of a variance component.  In fact, it will be a
horribly imprecise estimate.

There are no hard and fast rules of how many levels are required to be
able to estimate a variance component but fewer than 5 is too few and
more than 10 is adequate.  I have used as few as 6 levels but that was
on nicely balanced data from a designed experiment.  Observational
data that is highly unbalanced requires more care.


From bbolker at gmail.com  Mon Oct  1 21:24:10 2012
From: bbolker at gmail.com (Ben Bolker)
Date: Mon, 1 Oct 2012 19:24:10 +0000 (UTC)
Subject: [R-sig-ME] fixed or random effects?
References: <004501cda000$10d103b0$32730b10$@ul.pt>
Message-ID: <loom.20121001T212223-765@post.gmane.org>

joana martelo <jmmartelo at ...> writes:

> 
> Hello R list
> 
> I'm modeling fish activity data with a gaussian distribution for scores
> obtained from Principal Component Analysis, and have a little problem,
> hopefully simple to resolve. My explanatory variables are group size, fish
> length and temperature and I sampled in two consecutive years, in spring. My
> problem is that I'm not sure whether I should consider year as a random or a
> fixed effect. I wonder if you could help me.
> 

  [snip]

  As hinted in private e-mail, http://glmm.wikidot.com/faq tells you that
while you may *philosophically* want to treat two years as a sample from
a larger population of years, it is not computationally practical 
(nor will it get you much in terms of inferential power) to treat a factor
with only two levels as random: you should make it fixed.  This then has
the added advantage that you have only fixed effects, and you can use
lm() instead of getting into any of the complexities of mixed models.


From bbolker at gmail.com  Mon Oct  1 21:27:34 2012
From: bbolker at gmail.com (Ben Bolker)
Date: Mon, 1 Oct 2012 19:27:34 +0000 (UTC)
Subject: [R-sig-ME] fixed or random effects?
References: <004501cda000$10d103b0$32730b10$@ul.pt>
	<CAO7JsnSDygroQw2YeyeiXkYrt8tn2pLQ39ZVXKZtyTtp8C8Ocw@mail.gmail.com>
Message-ID: <loom.20121001T212430-31@post.gmane.org>

Douglas Bates <bates at ...> writes:
 
> On Mon, Oct 1, 2012 at 1:10 PM, joana martelo <jmmartelo at ...> wrote:

[snip]
 
# For you the year factor will have only two levels and that is too few
# to model the effect of year as a random effect.  When you incorporate
# a random-effects term in a model you end up estimating a variance
# component instead of trying to estimate coefficients in a linear model
# expression directly.  Having only two levels of year will not allow
# for a precise estimate of a variance component.  In fact, it will be a
# horribly imprecise estimate.
> 
> There are no hard and fast rules of how many levels are required to be
> able to estimate a variance component but fewer than 5 is too few and
> more than 10 is adequate.  I have used as few as 6 levels but that was
> on nicely balanced data from a designed experiment.  Observational
> data that is highly unbalanced requires more care.
  
  jinx (snap):

http://separatedbyacommonlanguage.blogspot.ca/2006/10/jinx-and-snap.html

(making
   gmane
     happy
       with
         more
           stuff)


From philippe.michel.fullsack at gmail.com  Mon Oct  1 22:02:44 2012
From: philippe.michel.fullsack at gmail.com (philippe fullsack)
Date: Mon, 1 Oct 2012 17:02:44 -0300
Subject: [R-sig-ME] user-defined covariance matrix for linear mixed
	models
In-Reply-To: <F4BE9DC74ACC435B908CB3FFBF37714C@PCderobo>
References: <CAKryudea3WUV4uO8bJA1qedm9i7itLQETfvDRG1yD9aFTo2a_w@mail.gmail.com>
	<F4BE9DC74ACC435B908CB3FFBF37714C@PCderobo>
Message-ID: <CAKryudfx3WB9+T52Xy4o7B5BV2+FSrjQ5O1LwWROpGLiwszEMA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121001/9eec339a/attachment.pl>

From David.Duffy at qimr.edu.au  Tue Oct  2 02:14:40 2012
From: David.Duffy at qimr.edu.au (David Duffy)
Date: Tue, 2 Oct 2012 10:14:40 +1000
Subject: [R-sig-ME] user-defined covariance matrix for linear mixedmodels
In-Reply-To: <CAKryudfx3WB9+T52Xy4o7B5BV2+FSrjQ5O1LwWROpGLiwszEMA@mail.gmail.com>
References: <CAKryudea3WUV4uO8bJA1qedm9i7itLQETfvDRG1yD9aFTo2a_w@mail.gmail.com><F4BE9DC74ACC435B908CB3FFBF37714C@PCderobo>
	<CAKryudfx3WB9+T52Xy4o7B5BV2+FSrjQ5O1LwWROpGLiwszEMA@mail.gmail.com>
Message-ID: <Pine.LNX.4.64.1210021013210.12813@orpheus.qimr.edu.au>

On Mon, 1 Oct 2012, philippe fullsack wrote:

> Thank you very much Vincent,
> Your answer is completely acceptable. I have used (occasionally) ASReml and
> am aware of your solution. However, I would prefer staying within the R
> framework (i.e. use CRAN open source packages). Similar requests have been
> made in November 2011, but are still unanswered as far as I know.
>
> Philippe
>

  library(help=regress)


Version:              1.3-8
Date:                 2012-03-19
Title:                Gaussian linear models with linear covariance
                       structure
Author:               David Clifford and Peter McCullagh. Additional
                       contributions by HJ Auinger.
Maintainer:           David Clifford <david.clifford at csiro.au>
Description:          Functions to fit Gaussian linear model by
                       maximising the residual log likelihood where the
                       covariance structure can be written as a linear
                       combination of known matrices.  Can be used for
                       multivariate models and random effects models.
                       Easy straight forward manner to specify random
                       effects models, including random interactions.



-- 
| David Duffy (MBBS PhD)                                         ,-_|\
| email: davidD at qimr.edu.au  ph: INT+61+7+3362-0217 fax: -0101  /     *
| Epidemiology Unit, Queensland Institute of Medical Research   \_,-._/
| 300 Herston Rd, Brisbane, Queensland 4029, Australia  GPG 4D0B994A v


From philippe.michel.fullsack at gmail.com  Tue Oct  2 03:56:15 2012
From: philippe.michel.fullsack at gmail.com (philippe fullsack)
Date: Mon, 1 Oct 2012 22:56:15 -0300
Subject: [R-sig-ME] user-defined covariance matrix for linear mixedmodels
In-Reply-To: <Pine.LNX.4.64.1210021013210.12813@orpheus.qimr.edu.au>
References: <CAKryudea3WUV4uO8bJA1qedm9i7itLQETfvDRG1yD9aFTo2a_w@mail.gmail.com>
	<F4BE9DC74ACC435B908CB3FFBF37714C@PCderobo>
	<CAKryudfx3WB9+T52Xy4o7B5BV2+FSrjQ5O1LwWROpGLiwszEMA@mail.gmail.com>
	<Pine.LNX.4.64.1210021013210.12813@orpheus.qimr.edu.au>
Message-ID: <CAKryude2BJKoDtvghkHSrJbd4GpjpBaHv9Z9eZ-yd=jEh2X3pA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121001/a798d5cd/attachment.pl>

From dbebber at earthwatch.org.uk  Tue Oct  2 07:12:52 2012
From: dbebber at earthwatch.org.uk (Dan Bebber)
Date: Tue, 2 Oct 2012 05:12:52 +0000
Subject: [R-sig-ME] nlme: spatial autocorrelation on a sphere
Message-ID: <072A17AB8F352A418FEE8CE1C1D4763B2D540A14@EXCHANGE.earthwatchewe.lan>

I would like to write a spatial correlation structure function for nlme, that replicates the ability of such functions in the 'ramps' package to calculate great circle distances, e.g. corRSpher(form = ~ lat + lon, metric = "haversine").

The authors of the ramps package, Smith et al. (2008) write "The spatial correlation structures in nlme are not directly used because they do not allow great circle distance, which is very commonly needed for spatial data" so there may be a case for adding this functionality to nlme.

Unfortunately, I have been unable to locate the code to do this within nlme.
My question is: is this code accessible, and if so, how do I access it to modify it and then use it in functions like corSpher?

Spencer Graves on the r-help mailing list recommended I try here for an answer.

Many thanks,
Dan Bebber

Reference
Smith BJ, Yan J & Cowles MK 2008. Unified Geostatistical Modeling for Data Fusion and Spatial Heteroskedasticity with R Package ramps. Journal of Statistical Software 25(10)


From Davina.Hill at wits.ac.za  Tue Oct  2 10:06:09 2012
From: Davina.Hill at wits.ac.za (Davina Hill)
Date: Tue, 2 Oct 2012 08:06:09 +0000
Subject: [R-sig-ME] Combining MCMCglmm estimates
Message-ID: <0698B353E4527B4A906D141B68C088D93A5675@Elpis.ds.WITS.AC.ZA>

Dear list members,

I am using MCMCglmm to investigate the effects of an animal?s body mass, age and group size on its reproductive tactic (a factor with four levels), with individual identity and year in the model as random factors.  Some values of body mass and age were missing, so I used Amelia to impute ten datasets and then ran the following model on each dataset separately:  

k <- length(levels(ds1$tactic))
I <- diag(k-1)
J <- matrix(rep(1, (k-1)^2), c(k-1, k-1))
IJ <- (1/4) * (I+J)
prior = list(R = list(V = IJ, n=4, fix=1),G = list(G1 = list(V = IJ,n = 4), G2 = list(V = IJ,n=4)))

mousemodel <- MCMCglmm(tactic ~ trait-1+mass+age+groupsize, random = ~idh(trait):id + idh(trait):year, rcov = ~idh(trait):units, family = "categorical", burnin = 2000000, nitt = 3000000, thin = 10, data = ds1, prior = prior, verbose = FALSE)     

I would like to combine the ten sets of MCMCglmm estimates to get a single inference.  The most promising solution I?ve found so far is the mi.inference function in the mix package, which uses Rubin?s rule to combine estimates and SEs from a number of datasets.  I don?t know if the rule applies to MCMC objects and I was wondering if someone could advise me whether what I?ve done is appropriate.  I extracted the posterior mean and Time-series SE from summary(mousemodel$Sol) for each dataset and ran:

  mIest<-as.data.frame(mi.inference(est,std.err,confidence=0.95))

I used ?Time-series? SE but I?m unclear what the difference is between this and ?Na?ve? SE and couldn?t find a definition in the MCMCglmm literature.  I'd also like to obtain a single set of HPD intervals if this is possible.

Any help would be much appreciated.

Kind regards,
Davina Hill
<html><p><font face = "verdana" size = "0.8" color = "navy">This communication is intended for the addressee only. It is confidential. If you have received this communication in error, please notify us immediately and destroy the original message. You may not copy or disseminate this communication without the permission of the University. Only authorized signatories are competent to enter into agreements on behalf of the University and recipients are thus advised that the content of this message may not be legally binding on the University and may contain the personal views and opinions of the author, which are not necessarily the views and opinions of The University of the Witwatersrand, Johannesburg. All agreements between the University and outsiders are subject to South African Law unless the University agrees in writing to the contrary.</font></p></html>


From bbolker at gmail.com  Wed Oct  3 01:40:24 2012
From: bbolker at gmail.com (Ben Bolker)
Date: Tue, 2 Oct 2012 23:40:24 +0000 (UTC)
Subject: [R-sig-ME] nlme: spatial autocorrelation on a sphere
References: <072A17AB8F352A418FEE8CE1C1D4763B2D540A14@EXCHANGE.earthwatchewe.lan>
Message-ID: <loom.20121003T013542-919@post.gmane.org>

Dan Bebber <dbebber at ...> writes:

 
> I would like to write a spatial correlation structure function for
> nlme, that replicates the ability of such functions in the 'ramps'
> package to calculate great circle distances, e.g. corRSpher(form = ~
> lat + lon, metric = "haversine").
 
> The authors of the ramps package, Smith et al. (2008) write "The
> spatial correlation structures in nlme are not directly used because
> they do not allow great circle distance, which is very commonly
> needed for spatial data" so there may be a case for adding this
> functionality to nlme.
 
> Unfortunately, I have been unable to locate the code to do this
> within nlme.  My question is: is this code accessible, and if so,
> how do I access it to modify it and then use it in functions like
> corSpher?
 
 [snip snip snip]

  In my opinion, corRSpher *ought* to work -- this is exactly the
sort of situation that user-defined (or other-package-defined) 
corStructs are supposed to be designed for.  I confirmed, however,
that it doesn't work for gls() [I was feeling a little bit lazy
making up my example data, so I used gls() instead of [n]lme()].
I know that other 'pseudo-spatial' corStructs such as corBrownian etc.
(in the ape package) *do* work, so I'm not sure exactly why
corRSpher doesn't -- a quick look suggests that the problem *might*
be that it inherits from 'corSpatial', and there's some hard-coded
stuff in there.
  If I get a chance I will look further, but I don't think you're
missing something obvious (unfortunately).

  Ben Bolker


From j.hadfield at ed.ac.uk  Wed Oct  3 12:47:06 2012
From: j.hadfield at ed.ac.uk (Jarrod Hadfield)
Date: Wed, 03 Oct 2012 11:47:06 +0100
Subject: [R-sig-ME] examples of combining chains from MCMCglmm
In-Reply-To: <CANz9Z_+VQME+uyr2dxJr6GcQ3PCG9tMqScQ=M_xhb-TF=Tf1vQ@mail.gmail.com>
References: <CANz9Z_+VQME+uyr2dxJr6GcQ3PCG9tMqScQ=M_xhb-TF=Tf1vQ@mail.gmail.com>
Message-ID: <20121003114706.197166hu8m4ty7go@www.staffmail.ed.ac.uk>

Hi,

I would expect the run time to be linear if the thinning interval is  
set so that the number of iterations stored is equivalent in the two  
runs. It may be non-linear otherwise particularly the number of latent  
variabels/random effects to be stored is very large.  If this is not  
the case it suggests a memory leak. If you could provide sessionInfo()  
and a reproducible example that would be great?

Cheers,

Jarrod





Quoting Joshua Wiley <jwiley.psych at gmail.com> on Sun, 16 Sep 2012  
13:01:09 -0700:

> Hi All,
>
> Just wondering if anyone has examples lying around of combining chains
> from different runs of MCMCglmm on the same model?  If anyone does,
> I'd love to look at some.  Ideally they would be generalized (i.e.,
> able to combine an arbitrary number of chains).  If not, once I am
> done I will probably make a little example and post it somewhere.
>
> Also, the time to complete does not seem to be a linear function of
> the number of iterations.  Does anyone have comments on that?  I am
> saving a bunch of information (pr = TRUE, pl = TRUE, saveX = TRUE,
> saveZ = TRUE, saveXL = TRUE) so perhaps it has to do with that.  I ran
> 2e4 iterations and it took about 6.5 minutes.  6e4 iterations took
> 39.5 minutes, or nearly twice as long as would be expected from a
> linear increase.  I cannot share the actual data, but the general
> structure of the model is:
>
> MCMCglmm(outcome ~ 22 fixed predictors, family = "ordinal", data = dat,
>     random = ~ var1 + var2,
>     prior = list(
>       B = list(mu = rep(0, 23), V = diag(23) * (1 + 1)),
>       R = list(V = 1, fix = 1),
>       G = list(
>         G1 = list(V = 1, nu = .002),
>         G2 = list(V = 1, nu = .002)
>       )),
>     pr=TRUE, pl=TRUE, saveX = TRUE, saveZ = TRUE, saveXL = TRUE,
>     nitt = 4e5, thin = 1000, burnin = 1e4)
>
> The thinning is high because I had problems with autocorrelation on
> some parameters, possible mixing issues related to relatively
> unbalanced distribution of the outcome (approximately 80%, 10%, 10%
> for a three level ordered outcome).
>
> Thanks for any thoughts or tips,
>
> Josh
>
>
> --
> Joshua Wiley
> Ph.D. Student, Health Psychology
> Programmer Analyst II, Statistical Consulting Group
> University of California, Los Angeles
> https://joshuawiley.com/
>
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>
>



-- 
The University of Edinburgh is a charitable body, registered in
Scotland, with registration number SC005336.


From m.fairbrother at bristol.ac.uk  Wed Oct  3 12:49:55 2012
From: m.fairbrother at bristol.ac.uk (Malcolm Fairbrother)
Date: Wed, 3 Oct 2012 11:49:55 +0100
Subject: [R-sig-ME] nlme: spatial autocorrelation on a sphere
In-Reply-To: <mailman.3.1349258402.27737.r-sig-mixed-models@r-project.org>
References: <mailman.3.1349258402.27737.r-sig-mixed-models@r-project.org>
Message-ID: <417D6EE9-ACCD-4CE4-AE91-2B0CFE6CFA22@bristol.ac.uk>

I struggled with this a couple years ago, and the best solution I could find (or at least that I think I found) was to modify corStruct.R, gls.R, and lme.R, adding a new function "dist2" which can calculate distances using "rdist.earth" from the "fields" package. I re-compiled nlme with these modifications, to make dist2 load automatically with nlme (and "fields" loads when required). This makes rdist.earth a valid choice of metrics, for corSpatial and similar functions.

The only change to gls.R and lme.R is to replace:

      distance <- lapply(covar,
                         function(el, metric) dist(as.matrix(el), metric),
                         metric = metric)

with:

      distance <- lapply(covar,
                         function(el, metric) dist2(as.matrix(el), metric),
                         metric = metric)

In corStruct.R you just need to replace calls to "dist" with calls to "dist2", and add the code below to create the function dist2. Then the call looks like, for example:

lme(y ~ x, random = ~ 1 | group, correlation = corExp(form = ~ LONG + LAT | group, metric="rdist.earth"), data=dat)

There may be more elegant ways of doing this (and obviously so for more professional coders), but I believe this works. Maybe this will save you some time, Ben.

Cheers,
Malcolm



dist2 <- function (x, method = "euclidean", diag = FALSE, upper = FALSE, 
    p = 2) 
{
    if (!is.na(pmatch(method, "euclidian"))) 
        method <- "euclidean"
    METHODS <- c("euclidean", "maximum", "manhattan", "canberra", 
        "binary", "minkowski", "rdist.earth")
    method <- pmatch(method, METHODS)
    if (is.na(method)) 
        stop("invalid distance method")
    if (method == -1) 
        stop("ambiguous distance method")
    N <- nrow(x <- as.matrix(x))
    if (method == 7) {
        require(fields)
        d <- rdist.earth(x, miles=F, R=6371)[lower.tri(rdist.earth(x, miles=F, R=6371))]
        } else {
        d <- .C("R_distance", x = as.double(x), nr = N, nc = ncol(x), 
          d = double(N * (N - 1)/2), diag = as.integer(FALSE), 
          method = as.integer(method), p = as.double(p), DUP = FALSE, 
          NAOK = TRUE, PACKAGE = "stats")$d
        }
    attr(d, "Size") <- N
    attr(d, "Labels") <- dimnames(x)[[1L]]
    attr(d, "Diag") <- diag
    attr(d, "Upper") <- upper
    attr(d, "method") <- METHODS[method]
    if (method == 6) 
        attr(d, "p") <- p
    attr(d, "call") <- match.call()
    class(d) <- "dist"
    return(d)
}




> Date: Tue, 2 Oct 2012 23:40:24 +0000 (UTC)
> From: Ben Bolker <bbolker at gmail.com>
> To: r-sig-mixed-models at r-project.org
> Subject: Re: [R-sig-ME] nlme: spatial autocorrelation on a sphere
> 
> Dan Bebber <dbebber at ...> writes:
> 
> 
>> I would like to write a spatial correlation structure function for
>> nlme, that replicates the ability of such functions in the 'ramps'
>> package to calculate great circle distances, e.g. corRSpher(form = ~
>> lat + lon, metric = "haversine").
> 
>> The authors of the ramps package, Smith et al. (2008) write "The
>> spatial correlation structures in nlme are not directly used because
>> they do not allow great circle distance, which is very commonly
>> needed for spatial data" so there may be a case for adding this
>> functionality to nlme.
> 
>> Unfortunately, I have been unable to locate the code to do this
>> within nlme.  My question is: is this code accessible, and if so,
>> how do I access it to modify it and then use it in functions like
>> corSpher?
> 
> [snip snip snip]
> 
>  In my opinion, corRSpher *ought* to work -- this is exactly the
> sort of situation that user-defined (or other-package-defined) 
> corStructs are supposed to be designed for.  I confirmed, however,
> that it doesn't work for gls() [I was feeling a little bit lazy
> making up my example data, so I used gls() instead of [n]lme()].
> I know that other 'pseudo-spatial' corStructs such as corBrownian etc.
> (in the ape package) *do* work, so I'm not sure exactly why
> corRSpher doesn't -- a quick look suggests that the problem *might*
> be that it inherits from 'corSpatial', and there's some hard-coded
> stuff in there.
>  If I get a chance I will look further, but I don't think you're
> missing something obvious (unfortunately).
> 
>  Ben Bolker


From j.hadfield at ed.ac.uk  Wed Oct  3 12:53:42 2012
From: j.hadfield at ed.ac.uk (Jarrod Hadfield)
Date: Wed, 03 Oct 2012 11:53:42 +0100
Subject: [R-sig-ME] Multivariate mixed models
In-Reply-To: <FD6F6B8A5C87974AA3DC10E3656878B108269F@VMEXCHANGEMBS6A.isad.isadroot.ex.ac.uk>
References: <FD6F6B8A5C87974AA3DC10E3656878B108265C@VMEXCHANGEMBS6A.isad.isadroot.ex.ac.uk>,
	<FD6F6B8A5C87974AA3DC10E3656878B1082671@VMEXCHANGEMBS6A.isad.isadroot.ex.ac.uk>
	<FD6F6B8A5C87974AA3DC10E3656878B108269F@VMEXCHANGEMBS6A.isad.isadroot.ex.ac.uk>
Message-ID: <20121003115342.365254q3naxl6uko@www.staffmail.ed.ac.uk>

Hi,

The model cannot be fitted in lmer because a multivariate error  
structure cannot be fitted.  You can do it in asreml-R which I believe  
is now free to academic users on windows.

Cheers,

Jarrod


Quoting "Ingleby, Fiona" <fci201 at exeter.ac.uk> on Sat, 22 Sep 2012  
14:10:13 +0000:

> Hi everyone,
>
> I have a dataset with 3 trait measurements for individuals from  
> different families, like this:
>
> trait1      trait2      trait3      family
>  0.5        -0.2         0.2         A
>  0.2         0.7        -0.1         A
>  0.3        -0.3         0.5         A
>  0.1        -0.1         0.4         B
> -0.4         0.5        -0.6         B
> -0.1         0.8         0            B
> -0.2         0.7         0.5         C
>
> ...and so on (there are 80 families with 20 individuals measured from each).
>
> The model I want to fit is pretty straightforward, with the three  
> traits as a multivariate response, and family as a random effect. I  
> want to be able to extract the genetic variance-covariance matrix  
> for the set of 3 traits. I can do this quite easily with MCMCglmm,  
> and am aware of non-Bayesian methods in other programs (i.e. SAS),  
> but awkwardly, I want to fit a non-Bayesian model in R.
>
> I can run individual lmer models for each trait, e.g.:
>
> model <- lmer (trait1 ~ 1 + (1|family) )
>
> and extract the random effects variance for the family term, giving  
> me the genetic variance for each trait from each model individually.  
> But this doesn't allow me to model the genetic covariance between  
> traits, and so I'm wondering if there is a way to run lmer with a  
> multivariate response, or if there is another method I could use to  
> fit this kind of model?
>
> I did try re-arranging my dataset so that the 3 trait scores for  
> each individual were stacked into one variable (creating new  
> variables for trait.id (1, 2, or 3) and individual id within family)  
> like this:
>
> trait.score     trait.id     individual     family
>
> and then the model:
>
> model <- lmer (trait.score ~ 1 + (trait.id|family) + (individual|family) )
>
> but this model makes R crash and so I'm assuming there might be some  
> kind of convergence problem?! And I'm not even sure this model would  
> give me the genetic covariances between traits, it would probably  
> just give the genetic variances for each trait (as before but in one  
> model instead of 3 separately)?
>
> Any ideas/advice would be greatly appreciated.
>
> Thanks,
>
> Fiona Ingleby
>
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>
>



-- 
The University of Edinburgh is a charitable body, registered in
Scotland, with registration number SC005336.


From j.hadfield at ed.ac.uk  Wed Oct  3 13:07:32 2012
From: j.hadfield at ed.ac.uk (Jarrod Hadfield)
Date: Wed, 03 Oct 2012 12:07:32 +0100
Subject: [R-sig-ME] MCMCglmm: correctly estimating phylogenetic
 heritability
In-Reply-To: <B964ED738030624680E9A6D3182E934F049836@VMEXCHANGEMBS5A.isad.isadroot.ex.ac.uk>
References: <B964ED738030624680E9A6D3182E934F049836@VMEXCHANGEMBS5A.isad.isadroot.ex.ac.uk>
Message-ID: <20121003120732.13472l1h9jfwqc8w@www.staffmail.ed.ac.uk>

Hi Iain,

var(phylo)/(var(phylo)+var(residual)+var(random effects)) ?

is probably what you want to use. Presumably, you have multiple  
observations per species/population combination. In this case may want  
to interpret the residual variance as measurement error variance and  
exclude it from the denominator. Alternatively, you may interpret it  
as biological variation and include it. It depends on how you chose to  
interpret the residual variance and what you want the phylogentic  
heritability to refer to.  Note, that the fixed effects are also  
'removing' variance which may be phylogentic or not depending on the  
phylogenetic distribution of the predictors.

Cheers,

Jarrod


Quoting "Stott, Iain" <ims203 at exeter.ac.uk> on Fri, 28 Sep 2012  
15:31:49 +0000:

> Dear all,
>
> I am working with MCMCglmm models that include a phylogenetic  
> component. The aim of the study is to estimate the influence of  
> phylogeny on certain aspects of demography in plant populations.
>
> The models are constructed as follows:
> Univariate response
> One fixed factor (categorical, four levels)
> Two nested random grouping factors (Population nested within Species)
> Phylogenetic scaling of random effects (using a 'phylo' object and  
> the 'animal' argument)
> Default uninformative priors for fixed effects (mu=0, sigma^2=10^10)
> Uninformative priors for random effects and residuals (V=1, nu=0.001)
> Parameter expansion for random effects priors (I had some problems  
> with chains sticking at 0)
>
> DIC from models with phylogeny vs. without phylogeny are very  
> similar, hence there are two separate sets of rival models. The only  
> discernable effect that phylogeny has is to increase the credible  
> intervals on the fixed effect posteriors.
>
> Estimating a heritability factor (i.e. something akin to Pagel's  
> lambda) could clear up how important phylogeny actually is. Hadfield  
> & Nakagawa (2010) in J. Evol. Biol. state that this can be found  
> using:
>
> var(phylo)/(var(phylo)+var(residual)) .
>
> Fitted variance for phylogeny is very small compared to species,  
> population and residuals which could explain some of the strange  
> results we're getting: phylogeny may be statistically important, but  
> have a very small effect. BUT, the variance attributed to phylogeny  
> seems to be partitioned primarily into Species in non-phylogenetic  
> models (which makes sense). SO, is the above correct or should we  
> actually be using something like:
>
> var(phylo)/(var(phylo)+var(residual)+var(random effects)) ?
>
>
> Hope someone can shed some light,
>
> Iain
>
>
>
> - - - - - - - - - - - -
> Dr. Iain Stott
> Centre for Ecology and Conservation
> University of Exeter, Cornwall Campus
> Tremough, Treliever Road
> Penryn, Cornwall, TR10 9EZ, UK.
> Tel (office): 01326 371852
> http://biosciences.exeter.ac.uk/staff/postgradresearch/iainstott/
> - - - - - - - - - - - -
>
>
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>
>



-- 
The University of Edinburgh is a charitable body, registered in
Scotland, with registration number SC005336.


From datkins at u.washington.edu  Wed Oct  3 13:09:19 2012
From: datkins at u.washington.edu (David Atkins)
Date: Wed, 03 Oct 2012 13:09:19 +0200
Subject: [R-sig-ME] Multivariate mixed models
In-Reply-To: <20121003115342.365254q3naxl6uko@www.staffmail.ed.ac.uk>
References: <20121003115342.365254q3naxl6uko@www.staffmail.ed.ac.uk>
Message-ID: <506C1CDF.3040206@u.washington.edu>


Hi Fiona--

It is certainly possible to fit *some* multivariate mixed models using 
(g)lmer.  The major limitation that I am aware of is that you need to 
assume a common residual error term (though, this could be relaxed using 
lme() in the nlme package).

If I understand your model below:

 > model <- lmer (trait.score ~ 1 + (trait.id|family) + 
(individual|family) )
 >
 > but this model makes R crash and so I'm assuming there might be some
 > kind of convergence problem?! And I'm not even sure this model would
 > give me the genetic covariances between traits, it would probably
 > just give the genetic variances for each trait (as before but in one
 > model instead of 3 separately)?

I might try the following:

mult.lmer <- lmer (trait.score ~ -1 + traid.id + (-1 + trait.id | 
family), data = mydf)

This will fit mean levels of your 3 traits as fixed-effects along with 
variances (and covariances) among them over families (as random-effects).

If that doesn't work, you might try including a reproducible example.

cheers, Dave

[Begin forwarded msg]
Hi,

The model cannot be fitted in lmer because a multivariate error
structure cannot be fitted.  You can do it in asreml-R which I believe
is now free to academic users on windows.

Cheers,

Jarrod


Quoting "Ingleby, Fiona" <fci201 at exeter.ac.uk> on Sat, 22 Sep 2012
14:10:13 +0000:

 > Hi everyone,
 >
 > I have a dataset with 3 trait measurements for individuals from
 > different families, like this:
 >
 > trait1      trait2      trait3      family
 >  0.5        -0.2         0.2         A
 >  0.2         0.7        -0.1         A
 >  0.3        -0.3         0.5         A
 >  0.1        -0.1         0.4         B
 > -0.4         0.5        -0.6         B
 > -0.1         0.8         0            B
 > -0.2         0.7         0.5         C
 >
 > ...and so on (there are 80 families with 20 individuals measured from 
each).
 >
 > The model I want to fit is pretty straightforward, with the three
 > traits as a multivariate response, and family as a random effect. I
 > want to be able to extract the genetic variance-covariance matrix
 > for the set of 3 traits. I can do this quite easily with MCMCglmm,
 > and am aware of non-Bayesian methods in other programs (i.e. SAS),
 > but awkwardly, I want to fit a non-Bayesian model in R.
 >
 > I can run individual lmer models for each trait, e.g.:
 >
 > model <- lmer (trait1 ~ 1 + (1|family) )
 >
 > and extract the random effects variance for the family term, giving
 > me the genetic variance for each trait from each model individually.
 > But this doesn't allow me to model the genetic covariance between
 > traits, and so I'm wondering if there is a way to run lmer with a
 > multivariate response, or if there is another method I could use to
 > fit this kind of model?
 >
 > I did try re-arranging my dataset so that the 3 trait scores for
 > each individual were stacked into one variable (creating new
 > variables for trait.id (1, 2, or 3) and individual id within family)
 > like this:
 >
 > trait.score     trait.id     individual     family
 >
 > and then the model:
 >
 > model <- lmer (trait.score ~ 1 + (trait.id|family) + 
(individual|family) )
 >
 > but this model makes R crash and so I'm assuming there might be some
 > kind of convergence problem?! And I'm not even sure this model would
 > give me the genetic covariances between traits, it would probably
 > just give the genetic variances for each trait (as before but in one
 > model instead of 3 separately)?
 >
 > Any ideas/advice would be greatly appreciated.
 >
 > Thanks,
 >
 > Fiona Ingleby
 >
 > _______________________________________________
 > R-sig-mixed-models at r-project.org mailing list
 > https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
 >
 >



-- 
The University of Edinburgh is a charitable body, registered in
Scotland, with registration number SC005336.


-- 
Dave Atkins, PhD
University of Washington
datkins at u.washington.edu
http://depts.washington.edu/cshrb/

August 1 - October 30:

Universitat Zurich
Psychologisches Institut
Klinische Psychologie
Binzmuhlestrasse 14/23
CH-8050 Zurich

+41 44 635 71 75


From j.hadfield at ed.ac.uk  Wed Oct  3 13:25:49 2012
From: j.hadfield at ed.ac.uk (Jarrod Hadfield)
Date: Wed, 03 Oct 2012 12:25:49 +0100
Subject: [R-sig-ME] Sampling methods for MCMCglmm using cengaussian
 family
In-Reply-To: <CANz9Z_+s8BugosDJdi0+QtJakaC9TgUGOEwEYOWh9E_Hzr=p_A@mail.gmail.com>
References: <CAMt7gbP3Kbcvou1NM6z-X=71v_jrON1Gk8OPw2jY+nMjRPL-hg@mail.gmail.com>
	<CANz9Z_J3d2W6MHibLWJ5ekruEWWAd_gJiMijPittGsBsme_akg@mail.gmail.com>
	<CAMt7gbMhfSemXpJoqVmbd7xRJXGUFESZeQBW7xouAQvkSXgUaw@mail.gmail.com>
	<CANz9Z_+s8BugosDJdi0+QtJakaC9TgUGOEwEYOWh9E_Hzr=p_A@mail.gmail.com>
Message-ID: <20121003122549.14043ebrvb7o5lmg@www.staffmail.ed.ac.uk>

The censored gaussian latent variable is updated using MH steps  
(although I'm not sure now why I didn't use Gibbs updates - perhaps I  
wrote the truncated normal sampler after I'd implemented censored  
gaussian and it was easier just to use the general MH machinery used  
for other distributions).  For multitrait models that include a  
mixture of non-gaussian and censored gaussian traits, or multiple  
censored guassian traits,  the more general MH updates would be  
required in any case.

Candidate values for the latent variable are centered at the current  
value and sampled from a normal with variance V.  The candidate value  
can then be reflected at the censoring points (multiple times if  
necessary) and the symmetry required for detailed balance is  
maintained (I think and hope).  This means that a whole series of  
equally spaced proposal distributions can give optimal acceptance  
ratios but usually the adaptive MH samplers settles onto one of these  
quite quickly. The could get the variance printed to screen:

After

/***************/
/* Adaptive MH */
/***************/

on L1734-6 of MCMCglmm.cc you could put:

if(itt==burnin && AMtuneP[k]==1){
   cs_print(propC[k], FALSE);
}

which would print the variance of the proposal distribution at the end  
of adaptation. This could be passed to the tune argument in further  
runs of MCMCglmm.  I will include the adapted proposal distribution in  
the output of a MCMCglmm run in future releases.

Cheers,

Jarrod









Quoting Joshua Wiley <jwiley.psych at gmail.com> on Sun, 30 Sep 2012  
12:04:25 -0700:

> Hmm, that makes sense, but I am not sure how to go about doing it.
> Okay, I am sure because I can see the code where it is done in C++,
> but I do not know an easy way and really loathe the idea of hacking
> source code, recompiling, finding an error, and cycling through that
> process until it works.  I could be missing something because I am not
> the strongest at the theory underpinning these models.
>
> I did edit the R MCMCglmm function so I could look at all the output
> from the call to .C, but at least in the test case I created to try to
> mimic your example, there did not seem to be anything useful there.
>
> The process sounds like what the MICE package does, but in a  
> bayesian framework.
>
> I know Jarrod is a busy fellow, but he usually periodically gets to
> emails here, and if he sees this, I am sure he would have a better
> answer/direction for you to take as there is still the real
> possibility I am missing something silly.
>
> Good luck,
>
> Josh
>
> On Sun, Sep 30, 2012 at 11:50 AM, Robin Jeffries <rjeffries at ucla.edu> wrote:
>> Hi Joshua,
>>
>> Thank you for your response. I do have those Course Notes, but only skimmed
>> the technical details b/c I don't have any RE. I'll look further into it.
>>
>> Thank you for looking into extracting the proposal variance, I don't have
>> enough knowledge to look into or understand the guts of most programs,
>> especially if they're in C. I know I can provide a proposal distribution,
>> that's the entire point. I want to run this model for enough iterations such
>> that the proposal distribution is "good" in that the acceptance rate is ~25%
>> or so. Then I want to know what that proposal distribution is, so I can
>> restart the model using this good proposal distribution with no burnin.
>>
>> This probably sounds strange, but this model is only a step in a larger
>> cyclical algorithm (Sequential Regression Multiple Imputation (Raghunathan
>> 2001)) that models multiple variables, one iteration at a time. Y1 is
>> modeled, its results fed into the model for Y2, both those results are fed
>> into Y3.... until the results from Y2-Yp are fed back into a model for Y1.
>> So I need to draw 1 iteration at a time using a a constant proposal
>> distribution that does not adapt.
>>
>> I was just hoping to avoid those re-calculations this time and have MCMCglmm
>> just tell me what a good proposal variance was instead of having to figure
>> it out myself :)
>>
>> FYI, The small priors were not intentional, essentially a typo. Thank you
>> for pointing it out.
>>
>> Anyhow, thank you again for helping me figure out how I'm going to do what i
>> need to do. I appreciate the time you spent on it.
>>
>>
>> -Robin
>>
>>
>
>
>
> --
> Joshua Wiley
> Ph.D. Student, Health Psychology
> Programmer Analyst II, Statistical Consulting Group
> University of California, Los Angeles
> https://joshuawiley.com/
>
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>
>



-- 
The University of Edinburgh is a charitable body, registered in
Scotland, with registration number SC005336.


From jwiley.psych at gmail.com  Wed Oct  3 17:09:27 2012
From: jwiley.psych at gmail.com (Joshua Wiley)
Date: Wed, 3 Oct 2012 08:09:27 -0700
Subject: [R-sig-ME] examples of combining chains from MCMCglmm
In-Reply-To: <20121003114706.197166hu8m4ty7go@www.staffmail.ed.ac.uk>
References: <CANz9Z_+VQME+uyr2dxJr6GcQ3PCG9tMqScQ=M_xhb-TF=Tf1vQ@mail.gmail.com>
	<20121003114706.197166hu8m4ty7go@www.staffmail.ed.ac.uk>
Message-ID: <CANz9Z_L+k-p-HuwnSRH13m9xnqCJRN5iSXPVy-oWbKCu+H6bsA@mail.gmail.com>

Hi Jarrod,

Thanks so much for the reply.  I think it was actually issues with
faulty parallelization---I was doing test cases on a single core and
then scaling to a cluster.  There were quite a few (1000s) of levels
of the random effects which I was storing and had not taken into
account that when run in parallel, I would need to request 2-4GB of
RAM per core so I think I had the system thrashing.

Clearing that up brought it down to more or less linear.  I did still
wonder about combining the chains.  I've worked out a bunch of code
now and am thinking of putting it up on github, but if you have some
other centralized (public) place for content related to MCMCglmm, I'd
be happy to put it there with examples.  Do you have or would you
consider something like: https://github.com/hadley/ggplot2 ?  In
particular if you click the Wiki tab there is a bunch of stuff and the
community can contribute so you would just keep working on the code
base, but then others would have a central place to put examples,
citations to your package, FAQs, stuff like that.

Cheers,

Josh

On Wed, Oct 3, 2012 at 3:47 AM, Jarrod Hadfield <j.hadfield at ed.ac.uk> wrote:
> Hi,
>
> I would expect the run time to be linear if the thinning interval is set so
> that the number of iterations stored is equivalent in the two runs. It may
> be non-linear otherwise particularly the number of latent variabels/random
> effects to be stored is very large.  If this is not the case it suggests a
> memory leak. If you could provide sessionInfo() and a reproducible example
> that would be great?
>
> Cheers,
>
> Jarrod
>
>
>
>
>
>
> Quoting Joshua Wiley <jwiley.psych at gmail.com> on Sun, 16 Sep 2012 13:01:09
> -0700:
>
>> Hi All,
>>
>> Just wondering if anyone has examples lying around of combining chains
>> from different runs of MCMCglmm on the same model?  If anyone does,
>> I'd love to look at some.  Ideally they would be generalized (i.e.,
>> able to combine an arbitrary number of chains).  If not, once I am
>> done I will probably make a little example and post it somewhere.
>>
>> Also, the time to complete does not seem to be a linear function of
>> the number of iterations.  Does anyone have comments on that?  I am
>> saving a bunch of information (pr = TRUE, pl = TRUE, saveX = TRUE,
>> saveZ = TRUE, saveXL = TRUE) so perhaps it has to do with that.  I ran
>> 2e4 iterations and it took about 6.5 minutes.  6e4 iterations took
>> 39.5 minutes, or nearly twice as long as would be expected from a
>> linear increase.  I cannot share the actual data, but the general
>> structure of the model is:
>>
>> MCMCglmm(outcome ~ 22 fixed predictors, family = "ordinal", data = dat,
>>     random = ~ var1 + var2,
>>     prior = list(
>>       B = list(mu = rep(0, 23), V = diag(23) * (1 + 1)),
>>       R = list(V = 1, fix = 1),
>>       G = list(
>>         G1 = list(V = 1, nu = .002),
>>         G2 = list(V = 1, nu = .002)
>>       )),
>>     pr=TRUE, pl=TRUE, saveX = TRUE, saveZ = TRUE, saveXL = TRUE,
>>     nitt = 4e5, thin = 1000, burnin = 1e4)
>>
>> The thinning is high because I had problems with autocorrelation on
>> some parameters, possible mixing issues related to relatively
>> unbalanced distribution of the outcome (approximately 80%, 10%, 10%
>> for a three level ordered outcome).
>>
>> Thanks for any thoughts or tips,
>>
>> Josh
>>
>>
>> --
>> Joshua Wiley
>> Ph.D. Student, Health Psychology
>> Programmer Analyst II, Statistical Consulting Group
>> University of California, Los Angeles
>> https://joshuawiley.com/
>>
>> _______________________________________________
>> R-sig-mixed-models at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>
>>
>
>
>
> --
> The University of Edinburgh is a charitable body, registered in
> Scotland, with registration number SC005336.
>
>



-- 
Joshua Wiley
Ph.D. Student, Health Psychology
Programmer Analyst II, Statistical Consulting Group
University of California, Los Angeles
https://joshuawiley.com/


From basile.pinsard at imed.jussieu.fr  Wed Oct  3 18:55:47 2012
From: basile.pinsard at imed.jussieu.fr (basile pinsard)
Date: Wed, 3 Oct 2012 18:55:47 +0200
Subject: [R-sig-ME] lmer multivariate longitudinal model
In-Reply-To: <CADyNcx8hK_A28GV-UoKcNORnOcoJ-O1=EwStvKbfavkd5+Yowg@mail.gmail.com>
References: <CADyNcx8hK_A28GV-UoKcNORnOcoJ-O1=EwStvKbfavkd5+Yowg@mail.gmail.com>
Message-ID: <CADyNcx8S6Oy-SqK1DsL8OHzowUBLL23ZcM5HRpiPRovFxL5WAg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121003/2df17a60/attachment.pl>

From seth at swbigelow.net  Thu Oct  4 04:03:46 2012
From: seth at swbigelow.net (Seth W. Bigelow)
Date: Wed, 3 Oct 2012 22:03:46 -0400
Subject: [R-sig-ME] Mixed model and negative binomial distribution
Message-ID: <003b01cda1d4$7d9c0cd0$78d42670$@net>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121003/88c0ed85/attachment.pl>

From datkins at u.washington.edu  Thu Oct  4 07:20:59 2012
From: datkins at u.washington.edu (David Atkins)
Date: Thu, 04 Oct 2012 07:20:59 +0200
Subject: [R-sig-ME] Mixed model and negative binomial distribution
In-Reply-To: <003b01cda1d4$7d9c0cd0$78d42670$@net>
References: <003b01cda1d4$7d9c0cd0$78d42670$@net>
Message-ID: <506D1CBB.3080301@u.washington.edu>


Seth--

You might take a look at a paper we wrote that is a tutorial on mixed 
model "count regression" -- including negative binomial and various 
zero-altered models.  It also has a fairly extensive R code "appendix". 
  The draft / data / R code can be found:

http://depts.washington.edu/cshrb/newweb/statstutorials.html

It's the following paper:

Atkins, D. C., Baldwin, S., Zheng, C., Gallop, R. J., & Neighbors, C. 
(in press). A tutorial on count regression and zero-altered count models 
for longitudinal addictions data.

Finally, you can fit a type of over-dispersed Poisson model using 
glmer() in lme4, or a true negative binomial mixed model using glmmADMB 
package.  (I *think* an example of the latter is in the R code, though 
we focused mostly on lme4 and MCMCglmm.)

Hope that helps.

cheers, Dave

-- 
Dave Atkins, PhD
University of Washington
datkins at u.washington.edu
http://depts.washington.edu/cshrb/

August 1 - October 30:

Universitat Zurich
Psychologisches Institut
Klinische Psychologie
Binzmuhlestrasse 14/23
CH-8050 Zurich

+41 44 635 71 75


Dear mixed-model brain trust:



I am comparing snag (dead tree) densities 1 year and 5 years after
silvicultural treatment in forest plots to densities prior to treatment. In
nlme, my model is



lme(snagnum~treatment, random=(~1|plot), correlation=corExp(form=~year)).



{Treatment is a factor with values of Pre/1-year post/5-year post}. This
gives reasonable output, but I'm having a niggling doubt that I should be
using something akin to a negative binomial distribution, since about half
of the values are zeros (i.e., many plots had no snags prior to treatment,
and did not gain additional snags as a result of treatment). Can anyone
suggest an appropriate package and associated syntax for doing this mixed
model based on an alternative probability density function?



--Seth W. Bigelow


From S.Elias at umcutrecht.nl  Thu Oct  4 15:49:42 2012
From: S.Elias at umcutrecht.nl (Elias, S.G.)
Date: Thu, 4 Oct 2012 13:49:42 +0000
Subject: [R-sig-ME] Cochran's Q and I-squared for random-effects
 meta-analysis of proportions with lmer
Message-ID: <906253D2D3014D4F863497B8B72F1323174863@EXMB1501.ds.umcutrecht.nl>

Dear list,

I'm performing a binomial distribution random-effects meta-analysis of proportions using lmer(cbind(positives,negatives)~1|Study, data=d,family=binomial) [following Hamza TH et al J Clin Epidemiol 2008;61:41-51]. 

To go with the pooled estimate (after back transformation of the pooled logit(p)) and the 95% CIs I want to report measures of between-study heterogeneity. 

I know how to obtain the Tau^2 (variance of the random effects), but that is on the logit scale and thus not very well understandable for the average medical reader (the intended public of the paper). 

So I am struggling with obtaining Cochran's Q and following that the inconsistency index (I^2). 

Any thoughts or advice would be much appreciated.

Best,

Sjoerd Elias




------------------------------------------------------------------------------

De informatie opgenomen in dit bericht kan vertrouwelijk zijn en is
uitsluitend bestemd voor de geadresseerde. Indien u dit bericht onterecht
ontvangt, wordt u verzocht de inhoud niet te gebruiken en de afzender direct
te informeren door het bericht te retourneren. Het Universitair Medisch
Centrum Utrecht is een publiekrechtelijke rechtspersoon in de zin van de W.H.W.
(Wet Hoger Onderwijs en Wetenschappelijk Onderzoek) en staat geregistreerd bij
de Kamer van Koophandel voor Midden-Nederland onder nr. 30244197.

Denk s.v.p aan het milieu voor u deze e-mail afdrukt.

------------------------------------------------------------------------------

This message may contain confidential information and is...{{dropped:11}}


From basile.pinsard at imed.jussieu.fr  Wed Oct  3 10:45:09 2012
From: basile.pinsard at imed.jussieu.fr (basile pinsard)
Date: Wed, 3 Oct 2012 10:45:09 +0200
Subject: [R-sig-ME] lmer multivariate longitudinal model
Message-ID: <CADyNcx8hK_A28GV-UoKcNORnOcoJ-O1=EwStvKbfavkd5+Yowg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121003/81fef38a/attachment.pl>

From judith.riedel at ipw.agrl.ethz.ch  Thu Oct  4 11:41:17 2012
From: judith.riedel at ipw.agrl.ethz.ch (Riedel  Judith)
Date: Thu, 4 Oct 2012 09:41:17 +0000
Subject: [R-sig-ME] Difficulties in trying to do a mixed effects model using
 the lmer function
Message-ID: <29D19369-EFB3-4391-8B99-F5B54A3BAB6B@ethz.ch>

Dear people of the help list

I am drying to analyze my data using the 'lmer' function and I keep having problems.

This is the model:
> fm1<-lmer(dbh~spec+scheme+(1|Plot),data=d, REML=FALSE).

I analyse tree size (dbh) of  3 different species (spec) and  3 planting schemes (scheme). I have 5 plots, which I hope to model as a random factor. (However, the subsequent output is based on some simplified dummy data, which is based on only two plots and ha only few observations).

No I do:
> anova(fm1)
and I get some output, which I don't understand. Looks like this:

Analysis of Variance Table
       Df Sum Sq Mean Sq F value
spec    2  6.098  3.0490  0.6142
scheme  2 13.161  6.5803  1.3255

The problems I have are:
(1) How can I get the P-values?
(2) How can I get the overall model statistic?

Than I do:
> summary(fm1)

and get:
Linear mixed model fit by maximum likelihood
Formula: dbh ~ spec + scheme + (1 | Plot)
   Data: d
   AIC BIC logLik deviance REMLdev
 147.2 157  -66.6    133.2   125.8
Random effects:
 Groups   Name        Variance Std.Dev.
 Plot     (Intercept) 0.0000   0.0000
 Residual             4.9644   2.2281
Number of obs: 30, groups: Plot, 2

Fixed effects:
            Estimate Std. Error t value
(Intercept)   6.9074     0.9424   7.329
specCED       0.3859     1.0265   0.376
specTAB       0.8585     0.9828   0.874
schemeMON     0.6572     0.9554   0.688
schemePRO    -1.0344     1.1259  -0.919

Correlation of Fixed Effects:
          (Intr) spcCED spcTAB schMON
specCED   -0.537
specTAB   -0.529  0.500
schemeMON -0.588  0.002 -0.072
schemePRO -0.565  0.064  0.063  0.510

What is this? What does it tell me?

The statistics help advised me to do a second model, like this:
> fm2<-lmer(dbh~scheme+(1|Plot),data=d,REML=FALSE)
> anova(fm1,fm2)

But why would I compare the two models?

 What I get is:
Data: d
Models:
fm2: dbh ~ scheme + (1 | Plot)
fm1: dbh ~ spec + scheme + (1 | Plot)
    Df    AIC    BIC  logLik  Chisq Chi Df Pr(>Chisq)
fm2  5 143.96 150.97 -66.982
fm1  7 147.21 157.01 -66.602 0.7584      2     0.6844

What does this mean? Why Chi?

Finally I would like to do some LSD post hoc tests, but I have no idea how to do it.

In the end I would like to be able to report something like: 'DBH differed significantly between, species, planting schemes, and plots (Fx,xx = X; P = X). DBH of species 1 was significantly larger than DBH of species 2 (LSD post hoc test, P = X)'.

I greatly appreciate any suggestions! Thank You a lot for Your help!

Kind regards,

Judith
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
Judith Riedel
ETH Zurich
Institute of Agricultural Sciences
Applied Entomology
Schmelzbergstrasse 9/LFO
8092 Zurich
Switzerland

Tel:  ++41 44 632 3923
Fax: ++41 44 632 1171
judith.riedel at ipw.agrl.ethz.ch<mailto:judith.riedel at ipw.agrl.ethz.ch>
http://www.em.ipw.agrl.ethz.ch


From joerg.luedicke at gmail.com  Thu Oct  4 21:18:45 2012
From: joerg.luedicke at gmail.com (Joerg Luedicke)
Date: Thu, 4 Oct 2012 14:18:45 -0500
Subject: [R-sig-ME] lmer multivariate longitudinal model
In-Reply-To: <CADyNcx8S6Oy-SqK1DsL8OHzowUBLL23ZcM5HRpiPRovFxL5WAg@mail.gmail.com>
References: <CADyNcx8hK_A28GV-UoKcNORnOcoJ-O1=EwStvKbfavkd5+Yowg@mail.gmail.com>
	<CADyNcx8S6Oy-SqK1DsL8OHzowUBLL23ZcM5HRpiPRovFxL5WAg@mail.gmail.com>
Message-ID: <CAEn158QR5w9kG1hDpPt=sBPtBZoPAMftSNyej+TZ37jhMeZDTg@mail.gmail.com>

It is not clear to me how your data structure looks like, what your
outcome variables are, whether you got reasonable results from
separate model fits, what exactly you did by reshaping, and so on.
Thus I will only throw in some 2c regarding the two questions at the
bottom of your post (see below):

On Wed, Oct 3, 2012 at 3:45 AM, basile pinsard
<basile.pinsard at imed.jussieu.fr> wrote:
>
> -Does the first warning implies that the outputted estimate is wrong?
>
The warning message means what it says: your model did not converge.
The results in the mer object are (I would think) the estimates from
the last iteration. However, since your model did not converge, these
results are at least untrustworthy.

> -Why are the control arguments not taken into account? (sessionInfo outputs
> lme4_0.99999911-0 as version) Does it makes any sense trying to change
> these to remove the warning?

The fact that your model did not converge can have many reasons,
including data management issues. So your question should rather be
"Why is my model not converging?" instead of trying to "remove the
warning"! If you are unsure about what convergence means in this
context you should probably do some basic read-up.

Joerg


From basile.pinsard at imed.jussieu.fr  Thu Oct  4 22:36:11 2012
From: basile.pinsard at imed.jussieu.fr (basile pinsard)
Date: Thu, 4 Oct 2012 22:36:11 +0200
Subject: [R-sig-ME] lmer multivariate longitudinal model
In-Reply-To: <CAEn158QR5w9kG1hDpPt=sBPtBZoPAMftSNyej+TZ37jhMeZDTg@mail.gmail.com>
References: <CADyNcx8hK_A28GV-UoKcNORnOcoJ-O1=EwStvKbfavkd5+Yowg@mail.gmail.com>
	<CADyNcx8S6Oy-SqK1DsL8OHzowUBLL23ZcM5HRpiPRovFxL5WAg@mail.gmail.com>
	<CAEn158QR5w9kG1hDpPt=sBPtBZoPAMftSNyej+TZ37jhMeZDTg@mail.gmail.com>
Message-ID: <CADyNcx8DKzVo5jLVUnB9irUzpFSRgyyQrZhCF34iYJEo8xWC5g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121004/3ec2f000/attachment.pl>

From joerg.luedicke at gmail.com  Thu Oct  4 23:13:03 2012
From: joerg.luedicke at gmail.com (Joerg Luedicke)
Date: Thu, 4 Oct 2012 16:13:03 -0500
Subject: [R-sig-ME] lmer multivariate longitudinal model
In-Reply-To: <CADyNcx8DKzVo5jLVUnB9irUzpFSRgyyQrZhCF34iYJEo8xWC5g@mail.gmail.com>
References: <CADyNcx8hK_A28GV-UoKcNORnOcoJ-O1=EwStvKbfavkd5+Yowg@mail.gmail.com>
	<CADyNcx8S6Oy-SqK1DsL8OHzowUBLL23ZcM5HRpiPRovFxL5WAg@mail.gmail.com>
	<CAEn158QR5w9kG1hDpPt=sBPtBZoPAMftSNyej+TZ37jhMeZDTg@mail.gmail.com>
	<CADyNcx8DKzVo5jLVUnB9irUzpFSRgyyQrZhCF34iYJEo8xWC5g@mail.gmail.com>
Message-ID: <CAEn158QSQy_W2T+Syy1yt54As=-jHWvUUCbUz7JQB4yAmtMzuQ@mail.gmail.com>

Before checking out other packages, I would first try to figure out
the reason(s) for the convergence issues. More often than not the
reason is just some trivial issue with the data, but could of course
also be due to analyzing some complex data, a problem in the model
set-up itself etc. Did you fit separate models for each of your
outcome variables? Did you experience any convergence problems there?
Did the results made sense, based on your knowledge of the data?

Re multilevel/mixed-effects modeling in R, if you did not have
already, maybe have a look at this page:

http://glmm.wikidot.com/faq

Joerg


On Thu, Oct 4, 2012 at 3:36 PM, basile pinsard
<basile.pinsard at imed.jussieu.fr> wrote:
> Thanks for your answer.
>
> The outcome variables are correlations of measures from different regions of
> interest in images, which enables them to be regressed by common variables
> (that I named 'other_confounds' in the formula). The data is the original
> data reshaped (with melt from reshape package) so that 'variable' contains
> the name of the outcome and value it's value.
>
> About the non-convergence, being new to R, I was myself surprised that lmer
> returns result object event if this results does not makes sense, that is
> why I do asked about this warning.
> The second warning is independent of the convergence problem that have to be
> fixed and which is mainly due to the fact of having that many variables into
> the model.
> This second warning seems to say that the control parameters are not taken
> into account whatsoever.
>
> I have been looking at SabeR and exploring MCMCglmm today as multivariate
> support seems built-in, but there are so many packages that it is difficult
> as a newbie to make a choice.
>
> basile
>
>
> On Thu, Oct 4, 2012 at 9:18 PM, Joerg Luedicke <joerg.luedicke at gmail.com>
> wrote:
>>
>> It is not clear to me how your data structure looks like, what your
>> outcome variables are, whether you got reasonable results from
>> separate model fits, what exactly you did by reshaping, and so on.
>> Thus I will only throw in some 2c regarding the two questions at the
>> bottom of your post (see below):
>>
>> On Wed, Oct 3, 2012 at 3:45 AM, basile pinsard
>> <basile.pinsard at imed.jussieu.fr> wrote:
>> >
>> > -Does the first warning implies that the outputted estimate is wrong?
>> >
>> The warning message means what it says: your model did not converge.
>> The results in the mer object are (I would think) the estimates from
>> the last iteration. However, since your model did not converge, these
>> results are at least untrustworthy.
>>
>> > -Why are the control arguments not taken into account? (sessionInfo
>> > outputs
>> > lme4_0.99999911-0 as version) Does it makes any sense trying to change
>> > these to remove the warning?
>>
>> The fact that your model did not converge can have many reasons,
>> including data management issues. So your question should rather be
>> "Why is my model not converging?" instead of trying to "remove the
>> warning"! If you are unsure about what convergence means in this
>> context you should probably do some basic read-up.
>>
>> Joerg
>>
>> _______________________________________________
>> R-sig-mixed-models at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>
>


From torvon at gmail.com  Thu Oct  4 23:29:40 2012
From: torvon at gmail.com (Eiko Fried)
Date: Thu, 4 Oct 2012 17:29:40 -0400
Subject: [R-sig-ME] Mixed Effects Model with ordered dependent variable and
	random slopes
Message-ID: <CACm_P7rMs0+DCQ--HfVHTBQf=UekBfPT56T_4LxB09RDU8eS8Q@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121004/603eef4a/attachment.pl>

From bbolker at gmail.com  Fri Oct  5 06:32:36 2012
From: bbolker at gmail.com (Ben Bolker)
Date: Fri, 5 Oct 2012 04:32:36 +0000 (UTC)
Subject: [R-sig-ME] Mixed model and negative binomial distribution
References: <003b01cda1d4$7d9c0cd0$78d42670$@net>
Message-ID: <loom.20121005T062854-986@post.gmane.org>

Seth W. Bigelow <seth at ...> writes:

> 
> Dear mixed-model brain trust: 
> 
> I am comparing snag (dead tree) densities 1 year and 5 years after
> silvicultural treatment in forest plots to densities prior to treatment. In
> nlme, my model is 
> 
> lme(snagnum~treatment, random=(~1|plot), correlation=corExp(form=~year)). 
> 
> {Treatment is a factor with values of Pre/1-year post/5-year post}. This
> gives reasonable output, but I'm having a niggling doubt that I should be
> using something akin to a negative binomial distribution, since about half
> of the values are zeros (i.e., many plots had no snags prior to treatment,
> and did not gain additional snags as a result of treatment). Can anyone
> suggest an appropriate package and associated syntax for doing this mixed
> model based on an alternative probability density function?

  Negative binomial would be a reasonable distribution; the other
answer gives you some methods for doing this.  *However*, incorporating
both serial correlation and non-Gaussian errors in a model of this form
is a bit of a nuisance.
The model you want might be something like

  snagnum ~ Poisson(lambda)
  lambda ~ MVN(mean=treatment,Sigma=...)

where the variance-covariance matrix gives you both some extra-Poisson
variation (to handle overdispersion) and some correlation between
observations.  I'm hoping Alain Zuur will pop up shortly to point you
to a reference in his new book that will tell you how to do this in
WinBUGS ...

  You *might* be able to do this via glmmPQL in the MASS package ...
but I would check your answers particularly carefully to see that
they make sense.


From aghaynes at gmail.com  Fri Oct  5 08:47:42 2012
From: aghaynes at gmail.com (Alan Haynes)
Date: Fri, 5 Oct 2012 08:47:42 +0200
Subject: [R-sig-ME] Difficulties in trying to do a mixed effects model
 using the lmer function
In-Reply-To: <29D19369-EFB3-4391-8B99-F5B54A3BAB6B@ethz.ch>
References: <29D19369-EFB3-4391-8B99-F5B54A3BAB6B@ethz.ch>
Message-ID: <CAPdSD+6E=_7AmML-S87Q8vWQJd72QJ5uZsdWecP9ykgk6k1sVg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121005/77f64280/attachment.pl>

From rhbc at imm.dtu.dk  Fri Oct  5 08:53:54 2012
From: rhbc at imm.dtu.dk (Rune Haubo)
Date: Fri, 5 Oct 2012 08:53:54 +0200
Subject: [R-sig-ME] Mixed Effects Model with ordered dependent variable
 and random slopes
In-Reply-To: <CACm_P7rMs0+DCQ--HfVHTBQf=UekBfPT56T_4LxB09RDU8eS8Q@mail.gmail.com>
References: <CACm_P7rMs0+DCQ--HfVHTBQf=UekBfPT56T_4LxB09RDU8eS8Q@mail.gmail.com>
Message-ID: <CAG_uk921LWCChtDNh7ymSC_rqjMPHGJ+v8XB5LFqpVgLvV5Sxw@mail.gmail.com>

That is correct: clmm in package ordinal cannot fit random slope
models (or other types of vector-valued random-effects). Perhaps
MCMCglmm will be able to assist?

Cheers,
Rune

On 4 October 2012 23:29, Eiko Fried <torvon at gmail.com> wrote:
> Is there a plugin/toolbox for R that can handle 1) ordered dependent
> variables and 2) has both random intercept and random slope implemented (as
> far as I understand CLMM / ORDINAL doesn't do random slopes).
>
> Thanks
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models



-- 
Rune H B Christensen, PhD
DTU Informatics, Section for Statistics
Technical University of Denmark, Build. 305, Room 122,
DK-2800 Kgs. Lyngby, Denmark
Phone: (+45) 45 25 33 63
Mobile: (+45) 30 26 45 54


From basile.pinsard at imed.jussieu.fr  Fri Oct  5 11:37:05 2012
From: basile.pinsard at imed.jussieu.fr (basile pinsard)
Date: Fri, 5 Oct 2012 11:37:05 +0200
Subject: [R-sig-ME] lmer multivariate longitudinal model
In-Reply-To: <CAEn158QSQy_W2T+Syy1yt54As=-jHWvUUCbUz7JQB4yAmtMzuQ@mail.gmail.com>
References: <CADyNcx8hK_A28GV-UoKcNORnOcoJ-O1=EwStvKbfavkd5+Yowg@mail.gmail.com>
	<CADyNcx8S6Oy-SqK1DsL8OHzowUBLL23ZcM5HRpiPRovFxL5WAg@mail.gmail.com>
	<CAEn158QR5w9kG1hDpPt=sBPtBZoPAMftSNyej+TZ37jhMeZDTg@mail.gmail.com>
	<CADyNcx8DKzVo5jLVUnB9irUzpFSRgyyQrZhCF34iYJEo8xWC5g@mail.gmail.com>
	<CAEn158QSQy_W2T+Syy1yt54As=-jHWvUUCbUz7JQB4yAmtMzuQ@mail.gmail.com>
Message-ID: <CADyNcx_83=ksAvXVfwx9FGGY=0wzL8r88EWuknX=H3RR9qyDAQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121005/40f5e632/attachment.pl>

From ronnenberg at gmx.com  Fri Oct  5 12:31:12 2012
From: ronnenberg at gmx.com (Katrin Ronnenberg)
Date: Fri, 05 Oct 2012 12:31:12 +0200
Subject: [R-sig-ME] ZIP MCMCglmm
Message-ID: <20121005103112.81540@gmx.net>

Dear all,
I have several questions on a zero-inflated MCMCglmm model.

Data consist of 764 transects with porpoise counts ("sum_ppho"). On 304 transects zero porpoises were seen. Data come from several studies from the North Sea, they were all sampled in roughly the same area and from altogether 12 years. We are interested in a trend ("year"), seasonal effects ("dayofyear" quadratic (centered) Term + the simple term. Moreover we have a simple geographical variable "we"; a factor with two levels "West" and "east". The transect ID (EFF_Track) I integrated as random factor, assuming that transects are not independant of each other I used the us structure. Most transects were revisited over several years, but not all of them. Since Transects had differing length and visibility conditions, which affected the effective area sampled, I used the effective area ("sqkm") as random slope term. 



in MCMCglmm I tried the following: 

prior<-list(R=list(V=diag(2),nu=0.002), G=list(G1=list(V=diag(2),nu=0.002)))

Mz<-MCMCglmm(sum_ppho~at.level(trait,1):year*at.level(trait,1):we+
+           at.level(trait,1):(I(cdayofyear^2)+ at.level(trait,1):dayofyear), random= ~us(1+sqkm):EFF_Track, 
+              family="zipoisson",
+              data=encounter, rcov=~us(trait):units, prior=prior, verbose=FALSE,
+              nitt=100000,thin =1000, burnin = 5000)
> summary(Mz)

Iterations = 5001:99001
 Thinning interval  = 1000
 Sample size  = 95 

 DIC: 2843.102 

 G-structure:  ~us(1 + sqkm):EFF_Track

                                  post.mean l-95% CI u-95% CI eff.samp
(Intercept):(Intercept).EFF_Track   3.62368  1.21791  6.03721    6.215
sqkm:(Intercept).EFF_Track         -0.38983 -0.61860 -0.15801   14.857
(Intercept):sqkm.EFF_Track         -0.38983 -0.61860 -0.15801   14.857
sqkm:sqkm.EFF_Track                 0.05025  0.02699  0.07369   42.211

 R-structure:  ~us(trait):units

                              post.mean  l-95% CI u-95% CI eff.samp
sum_ppho:sum_ppho.units          0.8150  0.673652   1.0178   69.615
zi_sum_ppho:sum_ppho.units       0.1894 -0.472509   0.6914    7.978
sum_ppho:zi_sum_ppho.units       0.1894 -0.472509   0.6914    7.978
zi_sum_ppho:zi_sum_ppho.units    0.1561  0.001532   0.6305    8.428

 Location effects: sum_ppho ~ at.level(trait, 1):year * at.level(trait, 1):we + at.level(trait, 1):(I(cdayofyear^2) + at.level(trait, 1):dayofyear) 

                                    post.mean   l-95% CI   u-95% CI eff.samp  pMCMC  
(Intercept)                        -3.315e+00 -4.486e+00 -2.045e+00    1.993  <0.01 *
at.level(trait, 1):year             1.673e-03  1.111e-03  2.169e-03    3.976  <0.01 *
at.level(trait, 1):wew             -5.459e+02 -6.696e+02 -4.612e+02   40.273  <0.01 *
at.level(trait, 1):I(cdayofyear^2) -3.117e-05 -5.063e-05 -7.107e-06   95.000  <0.01 *
at.level(trait, 1):dayofyear       -1.726e-03 -3.851e-03  2.335e-05   59.665 0.0632 .
at.level(trait, 1):year:wew         2.727e-01  2.305e-01  3.343e-01   40.388  <0.01 *
---




In general I feel insecure if my assumptions are right and whether prior specifications make sense. But I have two main questions:
1. Question: Am I correct in the assumption, that, if the output for autocorr(M1$Sol) and autocorr(M1$VCV) are low, that spatial autocorrelation is no issue? If I specify a relatively simple model (only main effects), autocorrelation is no issue, however the more interaction terms I include the stronger the autocorrelation becomes. Increasing itterations by a factor of ten to: nitt=100000,thin =5000, burnin = 10000, hardly changed anything about that. Is there anything else I could try? I know that I can increase nitt... further and ask Malcolm about the sir() function. But I'm especially interested, if experimenting with the random term has a chance of improving things? 
2. Question: Following methods of distance sampling, a G(0) factor was estimated compensating for the diving porpoises, which escaped the surveyors. Originally we corrected the observations by dividing the counts by the G(0) factor. So, basically only the transects with counts were corrected. Am I right in the assumption that the latent variable in a ZIP model compensates for all values with false zeros i.e. also the false zero for the third animal in a transect with 2 counted animals? If that's the case, I would just not include any correction for g(0). But if the latent variable only compensates for false zeros of all zero values, but not for other values from the poisson distribution, then I would assume that the correction factor is needed. Is that the difference between a hurdle and a ZIP model? ZIP was in my case better than hurdle according to DIC.

I'm sorry, I hope you can understand my questions. I'm neither a statistician, nor a native speaker, so I would like to appologize for bad choice of words. And please let me know, if a representive sample of my data would help. 
Thank you for reading this, ideas and suggestions are very much appreciated. 

Katrin


From S.Ellison at LGCGroup.com  Fri Oct  5 14:54:05 2012
From: S.Ellison at LGCGroup.com (S Ellison)
Date: Fri, 5 Oct 2012 13:54:05 +0100
Subject: [R-sig-ME] Origins of difference in significance between
 lmer/pvals.fnc and aov?
In-Reply-To: <50573F9D.8020501@usc.edu>
References: <50573F9D.8020501@usc.edu>
Message-ID: <A4E5A0B016B8CB41A485FC629B633CED47A5ADAC43@GOLD.corp.lgc-group.com>

> I have a data set which seems amenable to analysis either 
> through lmer or aov, so I am comparing their results. I'm 
> finding small p-values for the fixed effect of interest in 
> either case, but they differ quite a bit

One contributing factor is that if I read your output correctly, aov() is doing an F test using some quite low degrees of freedom (1?) for the top line, while lmer is testing a coefficient's t-statistic using (iirc) only the density degrees of freedom which is typically, if not always (?) the same as the residual dof. 

S Ellison
 

*******************************************************************
This email and any attachments are confidential. Any use...{{dropped:8}}


From seth at swbigelow.net  Fri Oct  5 15:33:56 2012
From: seth at swbigelow.net (Seth W. Bigelow)
Date: Fri, 5 Oct 2012 09:33:56 -0400
Subject: [R-sig-ME] Mixed model and negative binomial distribution
In-Reply-To: <loom.20121005T062854-986@post.gmane.org>
References: <003b01cda1d4$7d9c0cd0$78d42670$@net>
	<loom.20121005T062854-986@post.gmane.org>
Message-ID: <002b01cda2fe$12c05580$38410080$@net>

Thank you, Ben Bolker (& David Atkins). I've begun experimenting with glmer
(family=Poisson) (without specifying a serial autocorrelation term, and
refamiliarizing myself with the poisson & negative binomial distributions
using 'Ecological Models and Data in R'. I will try your suggestion below,
and also hope for input from Alain Zuur re: mixed models with serial
correlation and non-Gaussian errors in WinBUGS.

--Seth W. Bigelow

-----Original Message-----
From: r-sig-mixed-models-bounces at r-project.org
[mailto:r-sig-mixed-models-bounces at r-project.org] On Behalf Of Ben Bolker
Sent: Friday, October 05, 2012 12:33 AM
To: r-sig-mixed-models at r-project.org
Subject: Re: [R-sig-ME] Mixed model and negative binomial distribution

Seth W. Bigelow <seth at ...> writes:

> 
> Dear mixed-model brain trust: 
> 
> I am comparing snag (dead tree) densities 1 year and 5 years after
> silvicultural treatment in forest plots to densities prior to treatment.
In
> nlme, my model is 
> 
> lme(snagnum~treatment, random=(~1|plot), correlation=corExp(form=~year)). 
> 
> {Treatment is a factor with values of Pre/1-year post/5-year post}. This
> gives reasonable output, but I'm having a niggling doubt that I should be
> using something akin to a negative binomial distribution, since about half
> of the values are zeros (i.e., many plots had no snags prior to treatment,
> and did not gain additional snags as a result of treatment). Can anyone
> suggest an appropriate package and associated syntax for doing this mixed
> model based on an alternative probability density function?

  Negative binomial would be a reasonable distribution; the other
answer gives you some methods for doing this.  *However*, incorporating
both serial correlation and non-Gaussian errors in a model of this form
is a bit of a nuisance.
The model you want might be something like

  snagnum ~ Poisson(lambda)
  lambda ~ MVN(mean=treatment,Sigma=...)

where the variance-covariance matrix gives you both some extra-Poisson
variation (to handle overdispersion) and some correlation between
observations.  I'm hoping Alain Zuur will pop up shortly to point you
to a reference in his new book that will tell you how to do this in
WinBUGS ...

  You *might* be able to do this via glmmPQL in the MASS package ...
but I would check your answers particularly carefully to see that
they make sense.

_______________________________________________
R-sig-mixed-models at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models


From atsuko.sato at zoo.ox.ac.uk  Fri Oct  5 17:45:42 2012
From: atsuko.sato at zoo.ox.ac.uk (Atsuko Sato)
Date: Fri, 5 Oct 2012 15:45:42 +0000
Subject: [R-sig-ME] all pair comparisons in proportion analysis
Message-ID: <81d246e7-0c77-4e63-b2c9-deba9bb76b5e@HUB03.ad.oak.ox.ac.uk>

Dear all,

I was wondering how we could compare thermal tolerance between genotypes using mixed effect model. Experimental data tell us that two closely related species of marine invertebrate have different sensitivities to temperature, specifically one is more resistant to higher water temperatures. The project is seeking to compare thermal tolerance between genotypes as follows:

*        We generate crosses of defined genotype. The two species are known as A and B, and offspring are: AA, BB, AB, BA (the last two are hybrids, AB =A mother and B father, BA the reverse). These have been replicated using different parents (batches) collected from from the field at least 7 times.

*        For each replicate the fertilised eggs (many 100s) are split in two. Half are maintained at constant temperature as a control. Half are heat shocked. Both cultures then allowed to develop to the same point.  Both the proportion of embryos developing normally in the heat treated sample and that in control are calculated.

By analysing the data using mixt effect model, batches as random effect, the test showed that interaction model of genotype and treatment is significantly better fit than non-interaction model.

Questions here is then which genotype makes the difference and where are the differences are. Since proportion of normal larvae is normally not 100%, thermal tolerance should be a proportion of normal larvae in heat treated section normalised by a proportion of normal larvae in control section. How can we conduct all pair comparison of such complex proportion (proportion/proportion) data? I have used
glht(model1,linfct=mcp(gen="Tukey"))
but it seems incorrect because the p-value does not matches with the plot I will get. In the plot of thermal tolerance (proportion of normal larvae in heat treated section devided by proportion of normal larvae in control section) AA (=1) and BB (=4) shows a large difference, for example, but the p=0.981.

Details of how I did these tests (using R) and the dataset and the plot of thermal tolerance are attached.
Numbering:
Treatment: 1, control; 2, heat shock
Genotype: AA=1, AB=2, BA=3, BB=4

Thank you very much.

Yours sincerely
Atsuko Sato


-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: results_17Aug12_24C.txt
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121005/02af072f/attachment-0001.txt>

From highstat at highstat.com  Fri Oct  5 19:04:11 2012
From: highstat at highstat.com (Highland Statistics Ltd)
Date: Fri, 05 Oct 2012 19:04:11 +0200
Subject: [R-sig-ME] Fwd: Re: Mixed model and negative binomial distribution
In-Reply-To: <506EB868.20200@highstat.com>
References: <506EB868.20200@highstat.com>
Message-ID: <506F130B.9020208@highstat.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121005/96a04144/attachment.pl>

From rjeffries at ucla.edu  Fri Oct  5 22:28:55 2012
From: rjeffries at ucla.edu (Robin Jeffries)
Date: Fri, 5 Oct 2012 13:28:55 -0700
Subject: [R-sig-ME] MCMCglmm Starting Value structure
In-Reply-To: <1307507204.12961.13.camel@sce-bio-c01600.bio.ed.ac.uk>
References: <BANLkTikYmhApcTeuD3r73RRwQuo+cX3NBg@mail.gmail.com>
	<1307507204.12961.13.camel@sce-bio-c01600.bio.ed.ac.uk>
Message-ID: <CAMt7gbMt_ibwtn3v9GydvOXep7kL-kqQH=H0GJBiUQH7HRj1xQ@mail.gmail.com>

I am encountering the same problem of defining the starting values,
yet for a different model. I am running a survival model with no
random effects on n subjects.

run1 <- MCMCglmm(cbind(low, up) ~ var1 + var2,
              family="cengaussian", data=sex,
              nitt=2100, thin=5, burnin=100,
              prior = prior1, tune=NULL, pl=TRUE)

prior1 <- list(R = list(V=1, n=0.002),
                       B = list(mu=rep(0,2), V=prior.var))

Since I have no random effects, there is no G matrix and  the
liabilities are just a single vector with a scalar variance.
So for example, say I want to start the liabilities at 1
prop.mean <- as.matrix(rep(1,n))
and a prior variance
prop.var <- 3

If I don't provide starting value for my residuals, R,
test2a <- MCMCglmm(cbind(low, up) ~ var1 + var2,
                 family="cengaussian", data=sex,
                 nitt=2100, thin=5, burnin=100,
                 prior = prior1, tune=prop.var,
                 start=list( liab=prop.mean, QUASI=FALSE),
                 pl=TRUE)

I get the error message: Error in if (dim(tune[[i]])[1] !=
dim(tune[[i]])[2] | dim(tune[[i]])[2] !=  :
  argument is of length zero

Since R is a scalar, I tried to use the same structure as the prior
run2b <- MCMCglmm(cbind(low, up) ~ var1 + var2,
                 family="cengaussian", data=sex,
                 nitt=2100, thin=5, burnin=100,
                 prior = prior1, tune=prop.var,
                 start=list(R=list(V=1),
                            liab=prop.mean,
                            QUASI=FALSE),
                 pl=TRUE)
but got the same dimension mis-match error.

If i use the error term from run1  as starting values for R,
run2c <- MCMCglmm(cbind(low, up) ~ var1 + var2,
                 family="cengaussian", data=sex,
                 nitt=2100, thin=5, burnin=100,
                 prior = prior1, tune=prop.var,
                 start=list(R=list(V=run1$error.term),
                            liab=prop.mean,
                            QUASI=FALSE),
                 pl=TRUE)

I get the error: Error in eigen(m, only.values = TRUE) :
  (list) object cannot be coerced to type 'double'

At this point I cannot decipher what it is I need to change to
properly provide starting values.

Thanks,
-Robin


On Tue, Jun 7, 2011 at 9:26 PM, Jarrod Hadfield <j.hadfield at ed.ac.uk> wrote:
>
> Hi,
>
> A bug has crept into MCMCglmm at some point when specifying starting
> values. The correct syntax should be start2c for which you get an error
> message. I will update as soon I have finished some of the other updates
> I am working on. As a work around you can add another matrix to the G
> element:
>
> start2c$G[[5]]<-diag(2)
>
> It will be ignored but will alow the code to run.
>
> Sorry,
>
> Jarrod
>
>
>
>
>
> On Tue, 2011-06-07 at 10:34 -0700, Robin Jeffries wrote:
> > I am having some difficulty defining the correct structure for the
> > starting values in MCMCglmm.
> > Several prior google searches for examples of starting values for
> > MCMCglmm resulted only in one unhelpful L-serv posting where the
> > poster was subsequently told to RTM and quit posting. I hope that I
> > show that I have spent time trying to find the answer on my own prior
> > to posting.
> >
> >
> > My prior structure is:
> >
> > prior1 = list(R = list(V = 1, nu = .002),
> >   G = list(
> >    G1 = list(V = diag(3), n=4),
> >    G2 = list(V = diag(3), n=4),
> >    G3 = list(V = 1, nu=1),
> >    G4 = list(V = 1, nu=1)
> > ))
> >
> >
> > To set up starting values I first set Rc and Gc to be vectors of
> > length 1 and 20 respectively. I then tried the starting value
> > structure as
> >
> > start2a = list( R = Rc,
> >   G = list(
> >    G1 = Gc[1:9],
> >    G2 = Gc[10:18],
> >    G3 = Gc[19],
> >    G4 = Gc[20]),
> > QUASI=FALSE)
> >
> > which gives me the error "V is the wrong dimension for some
> > startG/startR elements"
> > So I tried to structure it exactly as the priors (with lists and matricies)
> >
> > start2b = list(R = list(V =Rc),
> > G = list(
> >  G1 = list(V = matrix(Gc[1:9], nrow=3, ncol=3)),
> >  G2 = list(V = matrix(Gc[10:18], nrow=3, ncol=3)),
> >  G3 = list(V = Gc[19]),
> >  G4 = list(V = Gc[20])
> > ))
> >
> > and got the same error message.
> >
> > Since the help file/notes/vignette says that "the starting values is a
> > list of 4 possible elements, where G itself is also a list with as
> > many elements as RE components" I tried a combination of the above
> > two:
> >
> > start2c = list(
> > R = Rc,
> > G = list(
> >  G1 = matrix(Gc[1:9], nrow=3, ncol=3),
> >  G2 = matrix(Gc[10:18], nrow=3, ncol=3),
> >  G3 = Gc[19],
> >  G4 = Gc[20]),
> > QUASI=FALSE)
> >
> > but then was greeted with the error "Error in start$G[[r]] : subscript
> > out of bounds"
> >
> > If someone could help me out with what the structure of the starting
> > values is supposed to look like, it would be appreciated.
> >
> >
> > Robin Jeffries
> > MS, DrPH Candidate
> > Department of Biostatistics
> > UCLA
> > 530-633-STAT(7828)
> >
> > _______________________________________________
> > R-sig-mixed-models at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >
>
>
>
> --
> The University of Edinburgh is a charitable body, registered in
> Scotland, with registration number SC005336.
>


From dllanosx at gmail.com  Fri Oct  5 23:35:59 2012
From: dllanosx at gmail.com (David Llanos)
Date: Fri, 5 Oct 2012 16:35:59 -0500
Subject: [R-sig-ME] Random Effects on Linear Mixed Models
Message-ID: <CAK+VdJ9L3ux7imbd1pKWOgHCDMA78fDFyK57dDxtF4U-sx-GSg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121005/001cf5a0/attachment.pl>

From seth at swbigelow.net  Sat Oct  6 00:43:58 2012
From: seth at swbigelow.net (Seth W. Bigelow)
Date: Fri, 5 Oct 2012 18:43:58 -0400
Subject: [R-sig-ME] Fwd: Re: Mixed model and negative binomial
	distribution
In-Reply-To: <506F130B.9020208@highstat.com>
References: <506EB868.20200@highstat.com> <506F130B.9020208@highstat.com>
Message-ID: <001201cda34a$ea494470$bedbcd50$@net>

Alain, thank you very much for the advice regarding analysis of my (negative
binomial vs. poisson-distributed) snag data, and my warmest congratulations
on your nuptials
-Seth W. Bigelow

-----Original Message-----
From: r-sig-mixed-models-bounces at r-project.org
[mailto:r-sig-mixed-models-bounces at r-project.org] On Behalf Of Highland
Statistics Ltd
Sent: Friday, October 05, 2012 1:04 PM
To: r-sig-mixed-models at r-project.org
Subject: [R-sig-ME] Fwd: Re: Mixed model and negative binomial distribution




-------- Original Message --------
Subject: 	Re: Mixed model and negative binomial distribution
Date: 	Fri, 05 Oct 2012 12:37:28 +0200
From: 	Highland Statistics Ltd <highstat at highstat.com>
To: 	r-sig-mixed-models at r-project.org <r-sig-mixed-models at r-project.org>



------------------------------

Message: 2
Date: Fri, 5 Oct 2012 04:32:36 +0000 (UTC)
From: Ben Bolker <bbolker at gmail.com>
To: r-sig-mixed-models at r-project.org
Subject: Re: [R-sig-ME] Mixed model and negative binomial distribution
Message-ID: <loom.20121005T062854-986 at post.gmane.org>
Content-Type: text/plain; charset=us-ascii

Seth W. Bigelow <seth at ...> writes:

>
> Dear mixed-model brain trust:
>
> I am comparing snag (dead tree) densities 1 year and 5 years after
> silvicultural treatment in forest plots to densities prior to treatment.
In
> nlme, my model is
>
> lme(snagnum~treatment, random=(~1|plot), correlation=corExp(form=~year)).
>
> {Treatment is a factor with values of Pre/1-year post/5-year post}. This
> gives reasonable output, but I'm having a niggling doubt that I should be
> using something akin to a negative binomial distribution, since about half
> of the values are zeros (i.e., many plots had no snags prior to treatment,
> and did not gain additional snags as a result of treatment). Can anyone
> suggest an appropriate package and associated syntax for doing this mixed
> model based on an alternative probability density function?

>  Negative binomial would be a reasonable distribution; the other
>answer gives you some methods for doing this.  *However*, incorporating
>both serial correlation and non-Gaussian errors in a model of this form
>is a bit of a nuisance.
>The model you want might be something like

>  snagnum ~ Poisson(lambda)
>  lambda ~ MVN(mean=treatment,Sigma=...)

>where the variance-covariance matrix gives you both some extra-Poisson
>variation (to handle overdispersion) and some correlation between
>observations.  I'm hoping Alain Zuur will pop up shortly to point you
>to a reference in his new book that will tell you how to do this in
>WinBUGS ...



-----------
Yesterday, Alain was on a nice beach in the Caribbean enjoying his wedding.
Now he is close to the north pole.


Yes....this sounds MCMC. And code for NB GLMM with AR1 correlation and zero
inflation is indeed in the 2012 book.
However...if the zeros are sequential in time then the correlation and zero
inflation components may fight
for the same information. And the NB distribution may try to take its share
of zeros as well. Better start with
the Poisson version of it....and if a Poisson + correlation + ZIP still
shows problems, then consider the NB.
For irregular time series consider a CAR correlation.

As to the implementation..try WinBUGS, OpenBUGS, JAGS....code is nearly the
same. I recently downloaded STAN...looks promising too.

You may also want to have a look at "Generalized Additive Mixed Model
Analysis via gammSlice" by Pham and Wand.
GAMM is essentially a GLMM.... But I don;t think it can do zero
inflation....but perhaps it does NB GLMM. Not sure.



Alain

-- 

Dr. Alain F. Zuur
First author of:

1. Analysing Ecological Data (2007).
Zuur, AF, Ieno, EN and Smith, GM. Springer. 680 p.
URL: www.springer.com/0-387-45967-7


2. Mixed effects models and extensions in ecology with R. (2009).
Zuur, AF, Ieno, EN, Walker, N, Saveliev, AA, and Smith, GM. Springer.
http://www.springer.com/life+sci/ecology/book/978-0-387-87457-9


3. A Beginner's Guide to R (2009).
Zuur, AF, Ieno, EN, Meesters, EHWG. Springer
http://www.springer.com/statistics/computational/book/978-0-387-93836-3


4. Zero Inflated Models and Generalized Linear Mixed Models with R. (2012)
Zuur, Saveliev, Ieno.
http://www.highstat.com/book4.htm

Other books: http://www.highstat.com/books.htm


Statistical consultancy, courses, data analysis and software
Highland Statistics Ltd.
6 Laverock road
UK - AB41 6FN Newburgh
Tel: 0044 1358 788177
Email: highstat at highstat.com
URL: www.highstat.com
URL: www.brodgar.com
























	[[alternative HTML version deleted]]

_______________________________________________
R-sig-mixed-models at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models


From David.Duffy at qimr.edu.au  Sat Oct  6 05:30:48 2012
From: David.Duffy at qimr.edu.au (David Duffy)
Date: Sat, 6 Oct 2012 13:30:48 +1000
Subject: [R-sig-ME] all pair comparisons in proportion analysis
In-Reply-To: <81d246e7-0c77-4e63-b2c9-deba9bb76b5e@HUB03.ad.oak.ox.ac.uk>
References: <81d246e7-0c77-4e63-b2c9-deba9bb76b5e@HUB03.ad.oak.ox.ac.uk>
Message-ID: <Pine.LNX.4.64.1210061328470.12562@orpheus.qimr.edu.au>

Maybe

glmer(cbind(abnormal, normal) ~ treatment*genotype + (1|batch),
       data=x, family=binomial())


From j.hadfield at ed.ac.uk  Sat Oct  6 23:36:36 2012
From: j.hadfield at ed.ac.uk (Jarrod Hadfield)
Date: Sat, 06 Oct 2012 22:36:36 +0100
Subject: [R-sig-ME] MCMCglmm Starting Value structure
In-Reply-To: <CAMt7gbMt_ibwtn3v9GydvOXep7kL-kqQH=H0GJBiUQH7HRj1xQ@mail.gmail.com>
References: <BANLkTikYmhApcTeuD3r73RRwQuo+cX3NBg@mail.gmail.com>
	<1307507204.12961.13.camel@sce-bio-c01600.bio.ed.ac.uk>
	<CAMt7gbMt_ibwtn3v9GydvOXep7kL-kqQH=H0GJBiUQH7HRj1xQ@mail.gmail.com>
Message-ID: <20121006223636.39373n36z3niymis@www.staffmail.ed.ac.uk>

Hi,

Sorry - I should have a more useful error message. Th argument to tune  
needs to be a matrix.

Cheers,

Jarrod


Quoting Robin Jeffries <rjeffries at ucla.edu> on Fri, 5 Oct 2012 13:28:55 -0700:

> I am encountering the same problem of defining the starting values,
> yet for a different model. I am running a survival model with no
> random effects on n subjects.
>
> run1 <- MCMCglmm(cbind(low, up) ~ var1 + var2,
>               family="cengaussian", data=sex,
>               nitt=2100, thin=5, burnin=100,
>               prior = prior1, tune=NULL, pl=TRUE)
>
> prior1 <- list(R = list(V=1, n=0.002),
>                        B = list(mu=rep(0,2), V=prior.var))
>
> Since I have no random effects, there is no G matrix and  the
> liabilities are just a single vector with a scalar variance.
> So for example, say I want to start the liabilities at 1
> prop.mean <- as.matrix(rep(1,n))
> and a prior variance
> prop.var <- 3
>
> If I don't provide starting value for my residuals, R,
> test2a <- MCMCglmm(cbind(low, up) ~ var1 + var2,
>                  family="cengaussian", data=sex,
>                  nitt=2100, thin=5, burnin=100,
>                  prior = prior1, tune=prop.var,
>                  start=list( liab=prop.mean, QUASI=FALSE),
>                  pl=TRUE)
>
> I get the error message: Error in if (dim(tune[[i]])[1] !=
> dim(tune[[i]])[2] | dim(tune[[i]])[2] !=  :
>   argument is of length zero
>
> Since R is a scalar, I tried to use the same structure as the prior
> run2b <- MCMCglmm(cbind(low, up) ~ var1 + var2,
>                  family="cengaussian", data=sex,
>                  nitt=2100, thin=5, burnin=100,
>                  prior = prior1, tune=prop.var,
>                  start=list(R=list(V=1),
>                             liab=prop.mean,
>                             QUASI=FALSE),
>                  pl=TRUE)
> but got the same dimension mis-match error.
>
> If i use the error term from run1  as starting values for R,
> run2c <- MCMCglmm(cbind(low, up) ~ var1 + var2,
>                  family="cengaussian", data=sex,
>                  nitt=2100, thin=5, burnin=100,
>                  prior = prior1, tune=prop.var,
>                  start=list(R=list(V=run1$error.term),
>                             liab=prop.mean,
>                             QUASI=FALSE),
>                  pl=TRUE)
>
> I get the error: Error in eigen(m, only.values = TRUE) :
>   (list) object cannot be coerced to type 'double'
>
> At this point I cannot decipher what it is I need to change to
> properly provide starting values.
>
> Thanks,
> -Robin
>
>
> On Tue, Jun 7, 2011 at 9:26 PM, Jarrod Hadfield <j.hadfield at ed.ac.uk> wrote:
>>
>> Hi,
>>
>> A bug has crept into MCMCglmm at some point when specifying starting
>> values. The correct syntax should be start2c for which you get an error
>> message. I will update as soon I have finished some of the other updates
>> I am working on. As a work around you can add another matrix to the G
>> element:
>>
>> start2c$G[[5]]<-diag(2)
>>
>> It will be ignored but will alow the code to run.
>>
>> Sorry,
>>
>> Jarrod
>>
>>
>>
>>
>>
>> On Tue, 2011-06-07 at 10:34 -0700, Robin Jeffries wrote:
>> > I am having some difficulty defining the correct structure for the
>> > starting values in MCMCglmm.
>> > Several prior google searches for examples of starting values for
>> > MCMCglmm resulted only in one unhelpful L-serv posting where the
>> > poster was subsequently told to RTM and quit posting. I hope that I
>> > show that I have spent time trying to find the answer on my own prior
>> > to posting.
>> >
>> >
>> > My prior structure is:
>> >
>> > prior1 = list(R = list(V = 1, nu = .002),
>> >   G = list(
>> >    G1 = list(V = diag(3), n=4),
>> >    G2 = list(V = diag(3), n=4),
>> >    G3 = list(V = 1, nu=1),
>> >    G4 = list(V = 1, nu=1)
>> > ))
>> >
>> >
>> > To set up starting values I first set Rc and Gc to be vectors of
>> > length 1 and 20 respectively. I then tried the starting value
>> > structure as
>> >
>> > start2a = list( R = Rc,
>> >   G = list(
>> >    G1 = Gc[1:9],
>> >    G2 = Gc[10:18],
>> >    G3 = Gc[19],
>> >    G4 = Gc[20]),
>> > QUASI=FALSE)
>> >
>> > which gives me the error "V is the wrong dimension for some
>> > startG/startR elements"
>> > So I tried to structure it exactly as the priors (with lists and  
>> matricies)
>> >
>> > start2b = list(R = list(V =Rc),
>> > G = list(
>> >  G1 = list(V = matrix(Gc[1:9], nrow=3, ncol=3)),
>> >  G2 = list(V = matrix(Gc[10:18], nrow=3, ncol=3)),
>> >  G3 = list(V = Gc[19]),
>> >  G4 = list(V = Gc[20])
>> > ))
>> >
>> > and got the same error message.
>> >
>> > Since the help file/notes/vignette says that "the starting values is a
>> > list of 4 possible elements, where G itself is also a list with as
>> > many elements as RE components" I tried a combination of the above
>> > two:
>> >
>> > start2c = list(
>> > R = Rc,
>> > G = list(
>> >  G1 = matrix(Gc[1:9], nrow=3, ncol=3),
>> >  G2 = matrix(Gc[10:18], nrow=3, ncol=3),
>> >  G3 = Gc[19],
>> >  G4 = Gc[20]),
>> > QUASI=FALSE)
>> >
>> > but then was greeted with the error "Error in start$G[[r]] : subscript
>> > out of bounds"
>> >
>> > If someone could help me out with what the structure of the starting
>> > values is supposed to look like, it would be appreciated.
>> >
>> >
>> > Robin Jeffries
>> > MS, DrPH Candidate
>> > Department of Biostatistics
>> > UCLA
>> > 530-633-STAT(7828)
>> >
>> > _______________________________________________
>> > R-sig-mixed-models at r-project.org mailing list
>> > https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>> >
>>
>>
>>
>> --
>> The University of Edinburgh is a charitable body, registered in
>> Scotland, with registration number SC005336.
>>
>
>



-- 
The University of Edinburgh is a charitable body, registered in
Scotland, with registration number SC005336.


From rjeffries at ucla.edu  Sun Oct  7 00:58:34 2012
From: rjeffries at ucla.edu (Robin Jeffries)
Date: Sat, 6 Oct 2012 15:58:34 -0700
Subject: [R-sig-ME] MCMCglmm Starting Value structure
In-Reply-To: <20121006223636.39373n36z3niymis@www.staffmail.ed.ac.uk>
References: <BANLkTikYmhApcTeuD3r73RRwQuo+cX3NBg@mail.gmail.com>
	<1307507204.12961.13.camel@sce-bio-c01600.bio.ed.ac.uk>
	<CAMt7gbMt_ibwtn3v9GydvOXep7kL-kqQH=H0GJBiUQH7HRj1xQ@mail.gmail.com>
	<20121006223636.39373n36z3niymis@www.staffmail.ed.ac.uk>
Message-ID: <CAMt7gbMHL4GX=yN8SYvLHFq=gggaYdTb90Owsbv6XyQiLXuz2g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121006/a5b162df/attachment.pl>

From j.hadfield at ed.ac.uk  Sun Oct  7 01:07:49 2012
From: j.hadfield at ed.ac.uk (Jarrod Hadfield)
Date: Sun, 07 Oct 2012 00:07:49 +0100
Subject: [R-sig-ME] ZIP MCMCglmm
In-Reply-To: <20121005103112.81540@gmx.net>
References: <20121005103112.81540@gmx.net>
Message-ID: <20121007000749.973022vira937qo0@www.staffmail.ed.ac.uk>

Hi,

A) The residual variance for the zero-inflation is not identified nor  
is the residual covariation between the zero-inflation and the Poisson  
part. However, you are attempting to estimate both. Use:

rcov=idh(trait):units

and fix the [2,2] element of the covariance matrix at something (e.g  
1) in the prior (i.e. add fix=2 to your R prior).

B) you have no unique intercepts for the zero inflation and the  
Poisson part. You should have trait as a main effect in the fixed  
formula (or trait-1 might be easier to interpret).

C)

  random= ~us(1+sqkm):EFF_Track

assumes that the regression parameters (intercept and slope) of sqkm  
on log Poisson rate and logit zero-inflation are identical within  
EFF_Tracks, and that the slope=0 on average (because its not in the  
fixed formula). I would have one of the following in the fixed effects:

a) trait:sqkm
b) at.level(trait,1):sqkm
c) at.level(trait,2):sqkm

and one of the following in the random effects.

i) random= ~us(trait):EFF_Track
ii) random= ~idh(trait):EFF_Track
iii) random= ~us(at.level(trait,1)):EFF_Track
iv) random= ~us(at.level(trait,2)):EFF_Track

and make sure that if i) or ii) to have a),  if iii) to have a) or b)  
and if iv) to have a) or c).

If you use ZAP rather than ZIP then fixed=~sqkm and random= ~EFF_Track  
is OK too.

D) DIC should not be trusted.

E) Not sure, but it sounds like g(0) is correcting for missed  
sightings of individuals present (?) and therefore refers to the  
Poisson part of the model.  The zero-inflation part may also be due to  
missed sightings of individuals present (e.g. on some transects the  
observers had their eyes closed!) but it is possibly more likely to be  
due to absence of porpoises? I don't know.

Cheers,

Jarrod









Quoting Katrin Ronnenberg <ronnenberg at gmx.com> on Fri, 05 Oct 2012  
12:31:12 +0200:

> Dear all,
> I have several questions on a zero-inflated MCMCglmm model.
>
> Data consist of 764 transects with porpoise counts ("sum_ppho"). On  
> 304 transects zero porpoises were seen. Data come from several  
> studies from the North Sea, they were all sampled in roughly the  
> same area and from altogether 12 years. We are interested in a trend  
> ("year"), seasonal effects ("dayofyear" quadratic (centered) Term +  
> the simple term. Moreover we have a simple geographical variable  
> "we"; a factor with two levels "West" and "east". The transect ID  
> (EFF_Track) I integrated as random factor, assuming that transects  
> are not independant of each other I used the us structure. Most  
> transects were revisited over several years, but not all of them.  
> Since Transects had differing length and visibility conditions,  
> which affected the effective area sampled, I used the effective area  
> ("sqkm") as random slope term.
>
>
>
> in MCMCglmm I tried the following:
>
> prior<-list(R=list(V=diag(2),nu=0.002), G=list(G1=list(V=diag(2),nu=0.002)))
>
> Mz<-MCMCglmm(sum_ppho~at.level(trait,1):year*at.level(trait,1):we+
> +           at.level(trait,1):(I(cdayofyear^2)+  
> at.level(trait,1):dayofyear), random= ~us(1+sqkm):EFF_Track,
> +              family="zipoisson",
> +              data=encounter, rcov=~us(trait):units, prior=prior,  
> verbose=FALSE,
> +              nitt=100000,thin =1000, burnin = 5000)
>> summary(Mz)
>
> Iterations = 5001:99001
>  Thinning interval  = 1000
>  Sample size  = 95
>
>  DIC: 2843.102
>
>  G-structure:  ~us(1 + sqkm):EFF_Track
>
>                                   post.mean l-95% CI u-95% CI eff.samp
> (Intercept):(Intercept).EFF_Track   3.62368  1.21791  6.03721    6.215
> sqkm:(Intercept).EFF_Track         -0.38983 -0.61860 -0.15801   14.857
> (Intercept):sqkm.EFF_Track         -0.38983 -0.61860 -0.15801   14.857
> sqkm:sqkm.EFF_Track                 0.05025  0.02699  0.07369   42.211
>
>  R-structure:  ~us(trait):units
>
>                               post.mean  l-95% CI u-95% CI eff.samp
> sum_ppho:sum_ppho.units          0.8150  0.673652   1.0178   69.615
> zi_sum_ppho:sum_ppho.units       0.1894 -0.472509   0.6914    7.978
> sum_ppho:zi_sum_ppho.units       0.1894 -0.472509   0.6914    7.978
> zi_sum_ppho:zi_sum_ppho.units    0.1561  0.001532   0.6305    8.428
>
>  Location effects: sum_ppho ~ at.level(trait, 1):year *  
> at.level(trait, 1):we + at.level(trait, 1):(I(cdayofyear^2) +  
> at.level(trait, 1):dayofyear)
>
>                                     post.mean   l-95% CI   u-95% CI  
> eff.samp  pMCMC
> (Intercept)                        -3.315e+00 -4.486e+00 -2.045e+00   
>   1.993  <0.01 *
> at.level(trait, 1):year             1.673e-03  1.111e-03  2.169e-03   
>   3.976  <0.01 *
> at.level(trait, 1):wew             -5.459e+02 -6.696e+02 -4.612e+02   
>  40.273  <0.01 *
> at.level(trait, 1):I(cdayofyear^2) -3.117e-05 -5.063e-05 -7.107e-06   
>  95.000  <0.01 *
> at.level(trait, 1):dayofyear       -1.726e-03 -3.851e-03  2.335e-05   
>  59.665 0.0632 .
> at.level(trait, 1):year:wew         2.727e-01  2.305e-01  3.343e-01   
>  40.388  <0.01 *
> ---
>
>
>
>
> In general I feel insecure if my assumptions are right and whether  
> prior specifications make sense. But I have two main questions:
> 1. Question: Am I correct in the assumption, that, if the output for  
> autocorr(M1$Sol) and autocorr(M1$VCV) are low, that spatial  
> autocorrelation is no issue? If I specify a relatively simple model  
> (only main effects), autocorrelation is no issue, however the more  
> interaction terms I include the stronger the autocorrelation  
> becomes. Increasing itterations by a factor of ten to:  
> nitt=100000,thin =5000, burnin = 10000, hardly changed anything  
> about that. Is there anything else I could try? I know that I can  
> increase nitt... further and ask Malcolm about the sir() function.  
> But I'm especially interested, if experimenting with the random term  
> has a chance of improving things?
> 2. Question: Following methods of distance sampling, a G(0) factor  
> was estimated compensating for the diving porpoises, which escaped  
> the surveyors. Originally we corrected the observations by dividing  
> the counts by the G(0) factor. So, basically only the transects with  
> counts were corrected. Am I right in the assumption that the latent  
> variable in a ZIP model compensates for all values with false zeros  
> i.e. also the false zero for the third animal in a transect with 2  
> counted animals? If that's the case, I would just not include any  
> correction for g(0). But if the latent variable only compensates for  
> false zeros of all zero values, but not for other values from the  
> poisson distribution, then I would assume that the correction factor  
> is needed. Is that the difference between a hurdle and a ZIP model?  
> ZIP was in my case better than hurdle according to DIC.
>
> I'm sorry, I hope you can understand my questions. I'm neither a  
> statistician, nor a native speaker, so I would like to appologize  
> for bad choice of words. And please let me know, if a representive  
> sample of my data would help.
> Thank you for reading this, ideas and suggestions are very much appreciated.
>
> Katrin
>
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>
>

-- 
The University of Edinburgh is a charitable body, registered in
Scotland, with registration number SC005336.


From longrob604 at gmail.com  Sun Oct  7 12:35:12 2012
From: longrob604 at gmail.com (W Robert Long)
Date: Sun, 07 Oct 2012 11:35:12 +0100
Subject: [R-sig-ME] Parameter-expanded priors with MCMCglmm
In-Reply-To: <20121007000749.973022vira937qo0@www.staffmail.ed.ac.uk>
References: <20121005103112.81540@gmx.net>
	<20121007000749.973022vira937qo0@www.staffmail.ed.ac.uk>
Message-ID: <50715AE0.9040508@gmail.com>

I would be grateful if anyone can advise me on how to use parameter 
expanded priors in the following context.

With random=~idh(1+year):hospital I initially had:

prior3b <- list(R = list(V = 1, fix = 1), G=list(G1=list(V=diag(7), nu=1)))

which worked OK, but I would like to use parameter expanded prior. I 
have tried this:

prior3a <- list(R = list(V = 1, fix = 1), G = list(G1 = list(V=diag(7), 
nu = 1, alpha.mu = 0, alpha.V = diag(25^2,7,7)))

But this gives the error:
alpha.V is the wrong dimension for some prior$G/prior$R elements

Thanks
Robert Long
PhD Student
University of Leeds


From j.hadfield at ed.ac.uk  Sun Oct  7 12:56:32 2012
From: j.hadfield at ed.ac.uk (Jarrod Hadfield)
Date: Sun, 07 Oct 2012 11:56:32 +0100
Subject: [R-sig-ME] Parameter-expanded priors with MCMCglmm
In-Reply-To: <50715AE0.9040508@gmail.com>
References: <20121005103112.81540@gmx.net>
	<20121007000749.973022vira937qo0@www.staffmail.ed.ac.uk>
	<50715AE0.9040508@gmail.com>
Message-ID: <20121007115632.21361ik0fwm1u5es@www.staffmail.ed.ac.uk>

Hi,

You need alpha.mu = rep(0,7) too. Also, note that to obtain marginal  
priors on each variance that are scaled F(1,1) you need to have nu=7.   
What effect this has on the covariances, correlations etc I'm not  
sure. I haven't come across any work looking at the prior properties  
of multi-parameter expansion.

Cheers,

Jarrod


Quoting W Robert Long <longrob604 at gmail.com> on Sun, 07 Oct 2012  
11:35:12 +0100:

> I would be grateful if anyone can advise me on how to use parameter  
> expanded priors in the following context.
>
> With random=~idh(1+year):hospital I initially had:
>
> prior3b <- list(R = list(V = 1, fix = 1), G=list(G1=list(V=diag(7), nu=1)))
>
> which worked OK, but I would like to use parameter expanded prior. I  
> have tried this:
>
> prior3a <- list(R = list(V = 1, fix = 1), G = list(G1 =  
> list(V=diag(7), nu = 1, alpha.mu = 0, alpha.V = diag(25^2,7,7)))
>
> But this gives the error:
> alpha.V is the wrong dimension for some prior$G/prior$R elements
>
> Thanks
> Robert Long
> PhD Student
> University of Leeds
>
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>
>



-- 
The University of Edinburgh is a charitable body, registered in
Scotland, with registration number SC005336.


From longrob604 at gmail.com  Sun Oct  7 13:51:03 2012
From: longrob604 at gmail.com (W Robert Long)
Date: Sun, 07 Oct 2012 12:51:03 +0100
Subject: [R-sig-ME] Parameter-expanded priors with MCMCglmm
In-Reply-To: <20121007115632.21361ik0fwm1u5es@www.staffmail.ed.ac.uk>
References: <20121005103112.81540@gmx.net>
	<20121007000749.973022vira937qo0@www.staffmail.ed.ac.uk>
	<50715AE0.9040508@gmail.com>
	<20121007115632.21361ik0fwm1u5es@www.staffmail.ed.ac.uk>
Message-ID: <50716CA7.60605@gmail.com>

Hi Jarrod,

This has worked now, and gave results close to what I was expecting.

Thank you very much

Robert Long
PhD Student
University of Leeds


On 07/10/2012 11:56, Jarrod Hadfield wrote:
> Hi,
>
> You need alpha.mu = rep(0,7) too. Also, note that to obtain marginal
> priors on each variance that are scaled F(1,1) you need to have nu=7.
> What effect this has on the covariances, correlations etc I'm not sure.
> I haven't come across any work looking at the prior properties of
> multi-parameter expansion.
>
> Cheers,
>
> Jarrod
>
>
> Quoting W Robert Long <longrob604 at gmail.com> on Sun, 07 Oct 2012
> 11:35:12 +0100:
>
>> I would be grateful if anyone can advise me on how to use parameter
>> expanded priors in the following context.
>>
>> With random=~idh(1+year):hospital I initially had:
>>
>> prior3b <- list(R = list(V = 1, fix = 1), G=list(G1=list(V=diag(7),
>> nu=1)))
>>
>> which worked OK, but I would like to use parameter expanded prior. I
>> have tried this:
>>
>> prior3a <- list(R = list(V = 1, fix = 1), G = list(G1 =
>> list(V=diag(7), nu = 1, alpha.mu = 0, alpha.V = diag(25^2,7,7)))
>>
>> But this gives the error:
>> alpha.V is the wrong dimension for some prior$G/prior$R elements
>>
>> Thanks
>> Robert Long
>> PhD Student
>> University of Leeds
>>
>> _______________________________________________
>> R-sig-mixed-models at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>
>>
>
>
>


From bop11tef at shef.ac.uk  Sun Oct  7 16:13:25 2012
From: bop11tef at shef.ac.uk (Timothy Farkas)
Date: Sun, 7 Oct 2012 15:13:25 +0100
Subject: [R-sig-ME] visualizing effects of fixed factors and partial/whole
	model statistics
Message-ID: <CANNNwzSRB=Np_bzDrm7Us1BiUo3M=cEWTCoaX6bqn4EuYT4E3A@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121007/c71301bf/attachment.pl>

From jfox at mcmaster.ca  Sun Oct  7 18:18:48 2012
From: jfox at mcmaster.ca (John Fox)
Date: Sun, 7 Oct 2012 12:18:48 -0400
Subject: [R-sig-ME] visualizing effects of fixed factors and
	partial/whole	model statistics
In-Reply-To: <CANNNwzSRB=Np_bzDrm7Us1BiUo3M=cEWTCoaX6bqn4EuYT4E3A@mail.gmail.com>
References: <CANNNwzSRB=Np_bzDrm7Us1BiUo3M=cEWTCoaX6bqn4EuYT4E3A@mail.gmail.com>
Message-ID: <000701cda4a7$6ee15fd0$4ca41f70$@mcmaster.ca>

Dear Tim,

You might take a look at the effects package, which handles objects produced
by lmer(), and generalizes the idea of (the horribly named) "least-squares
means." The functions to use directly are allEffects(), effect(), and
Effect() -- see ?effect.

I hope this helps,
 John

-----------------------------------------------
John Fox
Senator McMaster Professor of Social Statistics
Department of Sociology
McMaster University
Hamilton, Ontario, Canada




> -----Original Message-----
> From: r-sig-mixed-models-bounces at r-project.org [mailto:r-sig-mixed-
> models-bounces at r-project.org] On Behalf Of Timothy Farkas
> Sent: Sunday, October 07, 2012 10:13 AM
> To: r-sig-mixed-models at r-project.org
> Subject: [R-sig-ME] visualizing effects of fixed factors and
> partial/whole model statistics
> 
> Hi All,
> 
> I have two related practical questions concerning GLMMs. I hope my
> questions aren't too simplistic for this list, but other forums have
> been
> not been responsive.
> 
> My model is specified as follows:
> 
> lmer(countData ~ 3LevelFactor + continuous + (1|5LevelFactor),
> family=poisson)
> 
> and there is some redundancy between the fixed components and between
> the
> continuous variable and random factor, but not loads.
> 
> 1) How can I visualize the effect of the fixed factor while accounting
> for
> the continuous variable and random factor?
> 
> I'm looking to make a column graph with standard error bars that would
> be
> the multiple-regression equivalent of a partial plot. I think some
> people
> would refer to this as a "least-squared means" plot? Ideally, I could
> obtain a vector of adjusted values for the dependent variable and plot
> them
> over levels of the factor. Because redundancy is low, I'm OK with
> plotting
> raw data, but on principle I like my visualizations to accurately
> reflect
> my analysis if possible.
> 
> 2) Are there statistics like the R-sq of linear regression that will
> denote
> how much variation in my dependent variable is explained by my model?
> What
> about statistics like partial-R-sq, that denote the amount of variation
> explained by individual fixed parameters?
> 
> Cheers,
> 
> tim
> --
> 
> Timothy E. Farkas
> Dept. Animal and Plant Sciences
> Alfred Denny Building
> University of Sheffield
> Western Bank
> Sheffield S10 2TN
> United Kingdom
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models


From Paul.Johnson at glasgow.ac.uk  Mon Oct  8 11:45:55 2012
From: Paul.Johnson at glasgow.ac.uk (Paul Johnson)
Date: Mon, 8 Oct 2012 10:45:55 +0100
Subject: [R-sig-ME] Combining MCMCglmm estimates
In-Reply-To: <0698B353E4527B4A906D141B68C088D93A5675@Elpis.ds.WITS.AC.ZA>
References: <0698B353E4527B4A906D141B68C088D93A5675@Elpis.ds.WITS.AC.ZA>
Message-ID: <156FA9B609FA8F409121FB91C13E93DB099BC9D728@rcb-exserv.rcbdomain.com>

Hi Davina,

I haven't actually merged runs, so the following isn't based on experience. I'm also not aware of the methods for combining SEs from different imputed data sets that you mention. However I have the feeling that you don't need them if you have MCMC output from each data set.

Leaving aside imputation for the moment...

Let's say you've run the same model 10 times from the same data set, giving 10 sets of MCMC output, where each output is a sample from the joint posterior distribution of the model parameters. If these are "good" samples from the posterior, then you can combine them and treat them as a single MCMC sample. By "good" I mean they have started from different starting value sets and burned in for long enough to forget these values, they are large enough (e.g. >=1000 independent samples), and they have converged (you can check this visually by plotting the chains over each other - see plot(mcmc.list(...)) in the coda package). This is a neater, more flexible and presumably more accurate way of combining SEs - you then have a direct sample from the posterior of the SEs (and all the other other parameters). (Strictly they don't need to be large and may not need to be independent but I think it's easier to assess their validity if they are.)

The next question is whether it's valid to do this with runs that come from data sets that differ due to imputation uncertainty. My intuitive feeling is that it would be. The imputed predicted data values are effectively parameters with distributions, so merging across 10 samples would be a natural way of importing the uncertainty due to sampling from this distribution into the final MCMC output. You'd ideally want more than 10 samples, especially if the missing values have a large impact, but I guess computational capacity is limiting.

Ideally you'd want to do the imputation and the inference in a single model, but I don't think this is possible in MCMCglmm.

I hope this is helpful, but note I'm not an expert in this stuff - you're likely to get much better-informed replies from this list.

Best wishes,
Paul

-----Original Message-----
From: r-sig-mixed-models-bounces at r-project.org [mailto:r-sig-mixed-models-bounces at r-project.org] On Behalf Of Davina Hill
Sent: 02 October 2012 09:06
To: r-sig-mixed-models at r-project.org
Subject: [R-sig-ME] Combining MCMCglmm estimates

Dear list members,

I am using MCMCglmm to investigate the effects of an animal's body mass, age and group size on its reproductive tactic (a factor with four levels), with individual identity and year in the model as random factors.  Some values of body mass and age were missing, so I used Amelia to impute ten datasets and then ran the following model on each dataset separately:

k <- length(levels(ds1$tactic))
I <- diag(k-1)
J <- matrix(rep(1, (k-1)^2), c(k-1, k-1)) IJ <- (1/4) * (I+J) prior = list(R = list(V = IJ, n=4, fix=1),G = list(G1 = list(V = IJ,n = 4), G2 = list(V = IJ,n=4)))

mousemodel <- MCMCglmm(tactic ~ trait-1+mass+age+groupsize, random = ~idh(trait):id + idh(trait):year, rcov = ~idh(trait):units, family = "categorical", burnin = 2000000, nitt = 3000000, thin = 10, data = ds1, prior = prior, verbose = FALSE)

I would like to combine the ten sets of MCMCglmm estimates to get a single inference.  The most promising solution I've found so far is the mi.inference function in the mix package, which uses Rubin's rule to combine estimates and SEs from a number of datasets.  I don't know if the rule applies to MCMC objects and I was wondering if someone could advise me whether what I've done is appropriate.  I extracted the posterior mean and Time-series SE from summary(mousemodel$Sol) for each dataset and ran:

  mIest<-as.data.frame(mi.inference(est,std.err,confidence=0.95))

I used 'Time-series' SE but I'm unclear what the difference is between this and 'Na?ve' SE and couldn't find a definition in the MCMCglmm literature.  I'd also like to obtain a single set of HPD intervals if this is possible.

Any help would be much appreciated.

Kind regards,
Davina Hill
<html><p><font face = "verdana" size = "0.8" color = "navy">This communication is intended for the addressee only. It is confidential. If you have received this communication in error, please notify us immediately and destroy the original message. You may not copy or disseminate this communication without the permission of the University. Only authorized signatories are competent to enter into agreements on behalf of the University and recipients are thus advised that the content of this message may not be legally binding on the University and may contain the personal views and opinions of the author, which are not necessarily the views and opinions of The University of the Witwatersrand, Johannesburg. All agreements between the University and outsiders are subject to South African Law unless the University agrees in writing to the contrary.</font></p></html>

_______________________________________________
R-sig-mixed-models at r-project.org mailing list https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models


The University of Glasgow, charity number SC004401


From jmmartelo at fc.ul.pt  Sun Oct  7 18:29:43 2012
From: jmmartelo at fc.ul.pt (joana martelo)
Date: Sun, 7 Oct 2012 17:29:43 +0100
Subject: [R-sig-ME] FW: random effect
Message-ID: <000001cda4a8$f61b7cf0$e25276d0$@ul.pt>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121007/57e46c10/attachment.pl>

From cortin08 at yahoo.com  Sun Oct  7 21:42:12 2012
From: cortin08 at yahoo.com (Cortin A. Zelaznog)
Date: Sun, 7 Oct 2012 14:42:12 -0500
Subject: [R-sig-ME] Linear Mixed Effects vs. Repeated Measures
Message-ID: <D3FCBA48-3B34-4BCC-A98F-06BD89406F4A@yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121007/2c351206/attachment.pl>

From mike.lwrnc at gmail.com  Mon Oct  8 17:46:09 2012
From: mike.lwrnc at gmail.com (Mike Lawrence)
Date: Mon, 8 Oct 2012 12:46:09 -0300
Subject: [R-sig-ME] Linear Mixed Effects vs. Repeated Measures
In-Reply-To: <D3FCBA48-3B34-4BCC-A98F-06BD89406F4A@yahoo.com>
References: <D3FCBA48-3B34-4BCC-A98F-06BD89406F4A@yahoo.com>
Message-ID: <CAB+QPJBWWpXwLJVM_Siap4fDvLV=YO0wHwnd8DoOzKpLtz9v9A@mail.gmail.com>

Using lme4 syntax, I believe you want:

lmer_fit1 = lmer(
    data = df
    , formula = Response ~ Year + (1+Year|Tree)
)

contrast this with a model that assumes a constant effect of Year
across levels of Tree:

lmer_fit2 = lmer(
    data = df
    , formula = Response ~ Year + (1|Tree)
)

anova(lmer_fit1,lmer_fit2)



On Sun, Oct 7, 2012 at 4:42 PM, Cortin A. Zelaznog <cortin08 at yahoo.com> wrote:
> Hi All,
>
> I have 46 replicate trees I sampled in a 2 year survey.
> My objective is: To estimate the proportion of variation among-trees w/in year, and proportion variation due to among year and tree interaction.
>
> Response        Year    Tree
> 23      A       1
> 12      A       2
> 54      A       3
> 23      B       1
> 12      B       2
> 9       B       3
> The above is an example of my dataset
>
>
> Circularity was violated, so instead of running a Repeated Measures I am running a mixed effects model. With trees as random and year as fixed. I'm then running a variance components analysis.
>
> Q1. Is this a good way to test the above questions?
>
> My model is this: lme <-lme(response~year,random=~1|tree/year,df)
>
> I am not getting an interaction term here, nor do I when I run an aov model using tree*year as a factor.
>
> Q2. I'm wondering why I'm not coming up with an interaction term for year and tree using aov or lme even though my variance comp. analysis says that most of the variation (55%) is due to year and tree interaction.
>
> Thanks!!
>
>
>
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models


From joerg.luedicke at gmail.com  Mon Oct  8 17:51:03 2012
From: joerg.luedicke at gmail.com (Joerg Luedicke)
Date: Mon, 8 Oct 2012 10:51:03 -0500
Subject: [R-sig-ME] FW: random effect
In-Reply-To: <000001cda4a8$f61b7cf0$e25276d0$@ul.pt>
References: <000001cda4a8$f61b7cf0$e25276d0$@ul.pt>
Message-ID: <CAEn158QBLd1ZWqXStRPbMwqYeHKgr_Viu=nDgpW-mL3EQviRQw@mail.gmail.com>

Joana Martelo asked:
"However, do you think that considering year a fixed effect will
affect the relationship between the other explanatory variables and
the response?"

Entering an additional variable in a regression model will always
change the effects of other predictor variables on the outcome that
were estimated in a previous model. In your case, entering year as a
binary predictor essentially means that you constrain your other
effects to be the same in both years. If you have reason to believe
that the effects are different across the two years, you can interact
year with your other predictor variables and thereby relax the
assumption that the effects are the same in both years.

Joerg

On Sun, Oct 7, 2012 at 11:29 AM, joana martelo <jmmartelo at fc.ul.pt> wrote:
> Dear list
>
>
>
> I?m modeling fish activity data with a gaussian distribution for scores
> obtained from Principal Component Analysis. My explanatory variables are
> group size, fish length, temperature and year. Because year has only two
> levels I know I can?t use it as a random effect. However, do you think that
> considering year a fixed effect will affect the relationship between the
> other explanatory variables and the response? If the answer is yes, do you
> know of other statistical technique I could use?
>
> Thank you
>
>
>
> All the best
>
> Joana
>
>
>
>
>
> Joana Martelo, PhD Student
>
> Centro de Biologia Ambiental
>
> Departamento de Biologia Animal
>
> Faculdade de Ci?ncias, Edificio C2,5?Piso,Sala 2.5.15B
>
> 1749-016 Lisboa, Portugal
>
> http://ffishgul.fc.ul.pt
>
>
>
>
>
>
>
>
>
>
>
>
>         [[alternative HTML version deleted]]
>
>
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>


From AhmadR at sbscibus.com.au  Tue Oct  9 05:32:28 2012
From: AhmadR at sbscibus.com.au (Ahmad Rabiee)
Date: Tue, 9 Oct 2012 03:32:28 +0000
Subject: [R-sig-ME] robust linear mixed model
Message-ID: <F82E4A0E5D9F0D44939AC32130AE0BF46B535E12@SBSSERVER.sbs.local>

Hi

 I have a dataset with some outliers or influential observations, and intend to do a mixed model regression. I am looking for procedures or   a package that can do "robust linear mixed model", to account for the outliers or influential observations or groups.
 There are similar functions for fixed models (rlm) in MASS package, but I haven't been able to find anything on mixed models.

Thanks

Ahmad


From i.m.s.white at ed.ac.uk  Tue Oct  9 10:55:05 2012
From: i.m.s.white at ed.ac.uk (i white)
Date: Tue, 09 Oct 2012 09:55:05 +0100
Subject: [R-sig-ME] Linear Mixed Effects vs. Repeated Measures
In-Reply-To: <D3FCBA48-3B34-4BCC-A98F-06BD89406F4A@yahoo.com>
References: <D3FCBA48-3B34-4BCC-A98F-06BD89406F4A@yahoo.com>
Message-ID: <5073E669.7030902@ed.ac.uk>

Cortin,

Won't a standard mixed model analysis be identical to a repeated 
measures analysis? The only way I can see that 'circularity' is violated 
here is that the residual variance differs in the two years.
This is possible with lme, I don't know about lmer.

Isn't tree x year the same as residual for your data?

On 10/07/2012 08:42 PM, Cortin A. Zelaznog wrote:
> Hi All,
>
> I have 46 replicate trees I sampled in a 2 year survey.
> My objective is: To estimate the proportion of variation among-trees w/in year, and proportion variation due to among year and tree interaction.
>
> Response	Year	Tree
> 23	A	1
> 12	A	2
> 54	A	3
> 23	B	1
> 12	B	2
> 9	B	3
> The above is an example of my dataset
>
>
> Circularity was violated, so instead of running a Repeated Measures I am running a mixed effects model. With trees as random and year as fixed. I'm then running a variance components analysis.
>
> Q1. Is this a good way to test the above questions?
>
> My model is this: lme<-lme(response~year,random=~1|tree/year,df)
>
> I am not getting an interaction term here, nor do I when I run an aov model using tree*year as a factor.
>
> Q2. I'm wondering why I'm not coming up with an interaction term for year and tree using aov or lme even though my variance comp. analysis says that most of the variation (55%) is due to year and tree interaction.
>
> Thanks!!
>
>
>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>

-- 
The University of Edinburgh is a charitable body, registered in
Scotland, with registration number SC005336.


From m.geraci at ucl.ac.uk  Tue Oct  9 12:12:12 2012
From: m.geraci at ucl.ac.uk (Geraci, Marco)
Date: Tue, 9 Oct 2012 10:12:12 +0000
Subject: [R-sig-ME] robust linear mixed model
In-Reply-To: <F82E4A0E5D9F0D44939AC32130AE0BF46B535E12@SBSSERVER.sbs.local>
References: <F82E4A0E5D9F0D44939AC32130AE0BF46B535E12@SBSSERVER.sbs.local>
Message-ID: <1C5C2DA4AB9170439BCB4632D98B59800BE74897@AMSPRD0104MB135.eurprd01.prod.exchangelabs.com>

You might want to consider a median regression with random effects. See the lqmm package http://cran.r-project.org/web/packages/lqmm/index.html. You can extend the analysis to other quantiles as well.

Marco

--
Marco Geraci PhD CStat
Lecturer in Biostatistics
Institute of Child Health, University College London



-----Original Message-----
From: r-sig-mixed-models-bounces at r-project.org [mailto:r-sig-mixed-models-bounces at r-project.org] On Behalf Of Ahmad Rabiee
Sent: 09 October 2012 04:32
To: r-sig-mixed-models at r-project.org
Subject: [R-sig-ME] robust linear mixed model

Hi

 I have a dataset with some outliers or influential observations, and intend to do a mixed model regression. I am looking for procedures or   a package that can do "robust linear mixed model", to account for the outliers or influential observations or groups.
 There are similar functions for fixed models (rlm) in MASS package, but I haven't been able to find anything on mixed models.

Thanks

Ahmad

_______________________________________________
R-sig-mixed-models at r-project.org mailing list https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models


From bbolker at gmail.com  Tue Oct  9 14:16:47 2012
From: bbolker at gmail.com (Ben Bolker)
Date: Tue, 9 Oct 2012 12:16:47 +0000 (UTC)
Subject: [R-sig-ME] robust linear mixed model
References: <F82E4A0E5D9F0D44939AC32130AE0BF46B535E12@SBSSERVER.sbs.local>
	<1C5C2DA4AB9170439BCB4632D98B59800BE74897@AMSPRD0104MB135.eurprd01.prod.exchangelabs.com>
Message-ID: <loom.20121009T141434-590@post.gmane.org>

Geraci, Marco <m.geraci at ...> writes:

>  You might want to consider a median regression with random
> effects. See the lqmm package
> http://cran.r-project.org/web/packages/lqmm/index.html. You can
> extend the analysis to other quantiles as well.
 
  This sounds like a good idea (better than anything I could come
up with).  I was going to suggest using WinBUGS or AD Model Builder
to construct a mixed model with t- rather than Gaussian-distributed
residuals (this could eventually be built into glmmADMB, but at
the moment you'd have to learn ADMB and build your own model
from scratch).


> -----Original Message-----
 
>  I have a dataset with some outliers or influential observations,
> and intend to do a mixed model regression.  I am looking for
> procedures or a package that can do "robust linear mixed model", to
> account for the outliers or influential observations or groups.
> There are similar functions for fixed models (rlm) in MASS package,
> but I haven't been able to find anything on mixed models.


From bbolker at gmail.com  Tue Oct  9 14:46:37 2012
From: bbolker at gmail.com (Ben Bolker)
Date: Tue, 09 Oct 2012 08:46:37 -0400
Subject: [R-sig-ME] Fwd: lme() and SAS proc mixed
In-Reply-To: <21415_1349713027_q98GH4F7008281_CEE776E35D147A43B4BB5C2F286B8A900D7347@UHEXMBSPR06.umhs.med.umich.edu>
References: <21415_1349713027_q98GH4F7008281_CEE776E35D147A43B4BB5C2F286B8A900D7347@UHEXMBSPR06.umhs.med.umich.edu>
Message-ID: <50741CAD.1030901@mcmaster.ca>


  [forwarding to r-sig-mixed-models .  If you forget your password you
  should be able to retrieve it online.  Or read the mailing lists via
  the Gmane or Nabble interfaces, which allow you to post as well as
  read.]

-------- Original Message --------
Subject: 	lme() and SAS proc mixed
Resent-Date: 	Mon, 08 Oct 2012 12:16:53 -0400
Date: 	Mon, 8 Oct 2012 16:13:40 +0000
From: 	Verchinina, Lilia <lverchin at med.umich.edu>
To: 	bolker at mcmaster.ca <bolker at mcmaster.ca>

> Hello Ben,
> 
> It seems you answered my question about translating proc mixed for 
> linear mixed model into R lme(). Thanks a lot for you answer, it
> helped! I forgot my password with R-help, so I was not able to
> answer through R-help. When I use your code:
> 
> lme(score~var2+score_base+var4+var5+var3+var6+var7+var1+time-1, 
> random=~time|subject, data=...)
> 
> I get estimates for both codes of Gender factor variable, while
> there is not thord reference level so I am not sure what is taken
> as a reference level for Gender.

  I'm not sure which variable corresponds to Gender?
  When you take out the intercept, there is no reference level
(i.e., zero is the reference value).

> I have the same problem with my SAS proc mix code:
> 
> proc mixed data = survey method=reml; class subject var1 var3 var2
> time; model score = var2 score_base var4 var5 var3 var6 var7 var1
> time/ noint solution; random intercept timecontinious /
> subject=subject type=un g gcorr v vcorr;
> 
> run;
> 
> 
> If I remove ?-1? in the formula than you kindly provided, I do not
> get estimates for both Gender categories and one of the gender
> levels is used as a reference. I am curious what ?-1? in the
> formula of your R code stands for? How can I fix this problem in
> SAS code, so I do not get estimates for both gender levels, but one
> of the two gender levels  is used as a reference?

  -1 is the same as "noint" in SAS-world, I believe. It specifies
that the model doesn't have an intercept.  There is a section in
the Introduction to R on R's modeling syntax.


From geralttee at gmail.com  Tue Oct  9 16:46:45 2012
From: geralttee at gmail.com (Szymek Drobniak)
Date: Tue, 9 Oct 2012 16:46:45 +0200
Subject: [R-sig-ME] ASReml - heritability errors
Message-ID: <CANXb-o5930Paf1BAsYss6Xy+0-1yZtGPgCuqtxGyd7Z14h7ZyQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121009/d0651ab3/attachment.pl>

From i.m.s.white at ed.ac.uk  Tue Oct  9 16:52:24 2012
From: i.m.s.white at ed.ac.uk (i white)
Date: Tue, 09 Oct 2012 15:52:24 +0100
Subject: [R-sig-ME] ASReml - heritability errors
In-Reply-To: <CANXb-o5930Paf1BAsYss6Xy+0-1yZtGPgCuqtxGyd7Z14h7ZyQ@mail.gmail.com>
References: <CANXb-o5930Paf1BAsYss6Xy+0-1yZtGPgCuqtxGyd7Z14h7ZyQ@mail.gmail.com>
Message-ID: <50743A28.5060800@ed.ac.uk>

There are some answers to this question on the asreml forum at

www.vsni.co.uk/forum

On 10/09/2012 03:46 PM, Szymek Drobniak wrote:
> Hi everyone,
>
> I'm starting to use ASReml-R in my analyses and I'm wondering if it's
> possible to compute using is's procedures approximate errors for variance
> functions such as heritability? Or - if the previous one isn't possible -
> to extract (co)variance matrix for random effects that could be used in
> delta method (e.g. inside the 'msm' library).
>
> Cheers,
> sz.
>
>
>
>
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models

-- 
The University of Edinburgh is a charitable body, registered in
Scotland, with registration number SC005336.


From j.hadfield at ed.ac.uk  Tue Oct  9 17:07:50 2012
From: j.hadfield at ed.ac.uk (Jarrod Hadfield)
Date: Tue, 09 Oct 2012 16:07:50 +0100
Subject: [R-sig-ME] ASReml - heritability errors
In-Reply-To: <CANXb-o5930Paf1BAsYss6Xy+0-1yZtGPgCuqtxGyd7Z14h7ZyQ@mail.gmail.com>
References: <CANXb-o5930Paf1BAsYss6Xy+0-1yZtGPgCuqtxGyd7Z14h7ZyQ@mail.gmail.com>
Message-ID: <20121009160750.42882p8c3tocjum8@www.staffmail.ed.ac.uk>

Hi,

Do you mean the `(co)variance matrix for random effects' or the  
approximate sampling (co)variance matrix of the estimates of the  
(co)variance parameters?  If the latter,  I think you can find it in  
asreml.model$ai

Cheers,

Jarrod



Quoting Szymek Drobniak <geralttee at gmail.com> on Tue, 9 Oct 2012  
16:46:45 +0200:

> Hi everyone,
>
> I'm starting to use ASReml-R in my analyses and I'm wondering if it's
> possible to compute using is's procedures approximate errors for variance
> functions such as heritability? Or - if the previous one isn't possible -
> to extract (co)variance matrix for random effects that could be used in
> delta method (e.g. inside the 'msm' library).
>
> Cheers,
> sz.
>
> --
> Szymon Drobniak, PhD. || Population Ecology Group
> Institute of Environmental Sciences, Jagiellonian University
> ul. Gronostajowa 7, 30-387 Krak?w, POLAND
> tel.: +48 12 664 51 79 fax: +48 12 664 69 12
> szymek.drobniak at uj.edu.pl
> www.eko.uj.edu.pl/drobniak
>
> 	[[alternative HTML version deleted]]
>
>



-- 
The University of Edinburgh is a charitable body, registered in
Scotland, with registration number SC005336.


From luke.mangaliso.duncan at gmail.com  Tue Oct  9 17:18:58 2012
From: luke.mangaliso.duncan at gmail.com (Luke Duncan)
Date: Tue, 9 Oct 2012 17:18:58 +0200
Subject: [R-sig-ME] 'Missing' tests for lmer models
In-Reply-To: <Pine.LNX.4.64.1209260717440.6759@orpheus.qimr.edu.au>
References: <CAE9UE+9pXiJcaCkJg+a7Bnv_QUyk-Vs01j34G-4ut_kzOOG=+w@mail.gmail.com>
	<Pine.LNX.4.64.1209260717440.6759@orpheus.qimr.edu.au>
Message-ID: <CAE9UE+_L9eOZfnoMjTbBuQWSBVGi9EOuYBPsmpCXz6f8fHrtqQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121009/e9f9746e/attachment.pl>

From koller at stat.math.ethz.ch  Tue Oct  9 17:01:35 2012
From: koller at stat.math.ethz.ch (Manuel Koller)
Date: Tue, 9 Oct 2012 17:01:35 +0200
Subject: [R-sig-ME] robust linear mixed model
In-Reply-To: <F82E4A0E5D9F0D44939AC32130AE0BF46B535E12@SBSSERVER.sbs.local>
References: <F82E4A0E5D9F0D44939AC32130AE0BF46B535E12@SBSSERVER.sbs.local>
Message-ID: <CAPUobv2c+KvjwY35VXnSm_DEdROu14dXZD0st_CXkbWxvm6V3Q@mail.gmail.com>

(forgot to cc the mailinglist)

Dear Ahmad,

I am currently working on a package - robustlmm - that does exactly
this. It is currently available via GitHub only
(https://github.com/kollerma/robustlmm). (It hasn't been released to
CRAN since it depends on the new lme4.)
It is a combination of Fellner's (1986) approach to estimate the fixed
and random effects and the Design Adaptive Scale estimate developed
for MM-estimates (available in the package robustbase). The
documentation is not great, but there are some slides on my website
(http://stat.ethz.ch/people/kollerma) - a vignette is due soon. The
package provides a function "rlmer" that can be used just like "lmer".

Best regards,

Manuel

On Tue, Oct 9, 2012 at 5:32 AM, Ahmad Rabiee <AhmadR at sbscibus.com.au> wrote:
> Hi
>
>  I have a dataset with some outliers or influential observations, and intend to do a mixed model regression. I am looking for procedures or   a package that can do "robust linear mixed model", to account for the outliers or influential observations or groups.
>  There are similar functions for fixed models (rlm) in MASS package, but I haven't been able to find anything on mixed models.
>
> Thanks
>
> Ahmad
>
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models



-- 
Manuel Koller <koller at stat.math.ethz.ch>
Seminar f?r Statistik, HG G 18, R?mistrasse 101
ETH Z?rich  8092 Z?rich  SWITZERLAND
phone: +41 44 632-4673 fax: ...-1228
http://stat.ethz.ch/people/kollerma/


From geralttee at gmail.com  Tue Oct  9 19:25:08 2012
From: geralttee at gmail.com (Szymek Drobniak)
Date: Tue, 9 Oct 2012 19:25:08 +0200
Subject: [R-sig-ME] ASReml - heritability errors
In-Reply-To: <20121009160750.42882p8c3tocjum8@www.staffmail.ed.ac.uk>
References: <CANXb-o5930Paf1BAsYss6Xy+0-1yZtGPgCuqtxGyd7Z14h7ZyQ@mail.gmail.com>
	<20121009160750.42882p8c3tocjum8@www.staffmail.ed.ac.uk>
Message-ID: <CANXb-o4p1xLRgUwuBLUL0HfvDfw_B1-khRjOE8QcgeyinO1otw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121009/245cc970/attachment.pl>

From servant.mathieu at gmail.com  Tue Oct  9 23:41:11 2012
From: servant.mathieu at gmail.com (servant mathieu)
Date: Tue, 9 Oct 2012 23:41:11 +0200
Subject: [R-sig-ME] problem with a mixed linear model interpretation
Message-ID: <CALnu5bMnmA1Hvy1xqdOxg2sWg5E5uh9FRvqVAk5+2aP04s5JEA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121009/c439e8a0/attachment.pl>

From David.Duffy at qimr.edu.au  Wed Oct 10 03:14:13 2012
From: David.Duffy at qimr.edu.au (David Duffy)
Date: Wed, 10 Oct 2012 11:14:13 +1000
Subject: [R-sig-ME] 'Missing' tests for lmer models
In-Reply-To: <CAE9UE+_L9eOZfnoMjTbBuQWSBVGi9EOuYBPsmpCXz6f8fHrtqQ@mail.gmail.com>
References: <CAE9UE+9pXiJcaCkJg+a7Bnv_QUyk-Vs01j34G-4ut_kzOOG=+w@mail.gmail.com>
	<Pine.LNX.4.64.1209260717440.6759@orpheus.qimr.edu.au>
	<CAE9UE+_L9eOZfnoMjTbBuQWSBVGi9EOuYBPsmpCXz6f8fHrtqQ@mail.gmail.com>
Message-ID: <Pine.LNX.4.64.1210101020180.10547@orpheus.qimr.edu.au>

On Tue, 9 Oct 2012, Luke Duncan wrote:

> New computer/32bit R:
>
> R version 2.15.1 (2012-06-22)
> Platform: i386-pc-mingw32/i386 (32-bit)
>
> other attached packages:
> [1] lme4_0.999999-0  Matrix_1.0-6  car_2.0-13
>
> Old computer/32bit R:
>
> R version 2.13.1 (2011-07-08)
> Platform: i386-pc-mingw32/i386 (32-bit)
>
> other attached packages:
> [1] lme4_0.999375-42   Matrix_0.9996875-3  car_2.0-11

Yes, these straddle a moderately large version change in lme4:
see the intro at http://lme4.r-forge.r-project.org/

The most recent versions of Anova.II.mer() only supports c("chisq", "F"). 
John Fox may reintroduce Wald tests, but you can always do them yourself.

Cheers, David Duffy.

-- 
| David Duffy (MBBS PhD)                                         ,-_|\
| email: davidD at qimr.edu.au  ph: INT+61+7+3362-0217 fax: -0101  /     *
| Epidemiology Unit, Queensland Institute of Medical Research   \_,-._/
| 300 Herston Rd, Brisbane, Queensland 4029, Australia  GPG 4D0B994A v


From jfox at mcmaster.ca  Wed Oct 10 04:52:30 2012
From: jfox at mcmaster.ca (John Fox)
Date: Tue, 09 Oct 2012 22:52:30 -0400
Subject: [R-sig-ME] 'Missing' tests for lmer models
In-Reply-To: <Pine.LNX.4.64.1210101020180.10547@orpheus.qimr.edu.au>
References: <CAE9UE+9pXiJcaCkJg+a7Bnv_QUyk-Vs01j34G-4ut_kzOOG=+w@mail.gmail.com>
	<Pine.LNX.4.64.1209260717440.6759@orpheus.qimr.edu.au>
	<CAE9UE+_L9eOZfnoMjTbBuQWSBVGi9EOuYBPsmpCXz6f8fHrtqQ@mail.gmail.com>
	<Pine.LNX.4.64.1210101020180.10547@orpheus.qimr.edu.au>
Message-ID: <web-426937519@cgpsrv2.cis.mcmaster.ca>

Dear David and Luke,

I missed the beginning of this thread and couldn't find it in the R-sig-ME list archive, so it's not clear to me what the issue is -- sorry -- but I should clarify that Anova() for mer objects only does Wald tests -- either Wald chisquare tests or F-tests, the latter with Kenward-Roger df computed via the pbkrtest package. I think that this could be clearer in ?Anova.

Best,
 John

------------------------------------------------
John Fox
Sen. William McMaster Prof. of Social Statistics
Department of Sociology
McMaster University
Hamilton, Ontario, Canada
http://socserv.mcmaster.ca/jfox/
	
On Wed, 10 Oct 2012 11:14:13 +1000
 David Duffy <David.Duffy at qimr.edu.au> wrote:
> On Tue, 9 Oct 2012, Luke Duncan wrote:
> 
> > New computer/32bit R:
> >
> > R version 2.15.1 (2012-06-22)
> > Platform: i386-pc-mingw32/i386 (32-bit)
> >
> > other attached packages:
> > [1] lme4_0.999999-0  Matrix_1.0-6  car_2.0-13
> >
> > Old computer/32bit R:
> >
> > R version 2.13.1 (2011-07-08)
> > Platform: i386-pc-mingw32/i386 (32-bit)
> >
> > other attached packages:
> > [1] lme4_0.999375-42   Matrix_0.9996875-3  car_2.0-11
> 
> Yes, these straddle a moderately large version change in lme4:
> see the intro at http://lme4.r-forge.r-project.org/
> 
> The most recent versions of Anova.II.mer() only supports c("chisq", "F"). John Fox may reintroduce Wald tests, but you can always do them yourself.
> 
> Cheers, David Duffy.
> 
> -- 
> | David Duffy (MBBS PhD)                                         ,-_|\
> | email: davidD at qimr.edu.au  ph: INT+61+7+3362-0217 fax: -0101  /     *
> | Epidemiology Unit, Queensland Institute of Medical Research   \_,-._/
> | 300 Herston Rd, Brisbane, Queensland 4029, Australia  GPG 4D0B994A v
> 
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models


From hans at sociologi.cjb.net  Wed Oct 10 12:03:53 2012
From: hans at sociologi.cjb.net (Hans Ekbrand)
Date: Wed, 10 Oct 2012 12:03:53 +0200
Subject: [R-sig-ME] examples of combining chains from MCMCglmm
In-Reply-To: <CANz9Z_L+k-p-HuwnSRH13m9xnqCJRN5iSXPVy-oWbKCu+H6bsA@mail.gmail.com>
References: <CANz9Z_+VQME+uyr2dxJr6GcQ3PCG9tMqScQ=M_xhb-TF=Tf1vQ@mail.gmail.com>
	<20121003114706.197166hu8m4ty7go@www.staffmail.ed.ac.uk>
	<CANz9Z_L+k-p-HuwnSRH13m9xnqCJRN5iSXPVy-oWbKCu+H6bsA@mail.gmail.com>
Message-ID: <20121010100353.GA4433@samir>

On Wed, Oct 03, 2012 at 08:09:27AM -0700, Joshua Wiley wrote:

> > Quoting Joshua Wiley <jwiley.psych at gmail.com> on Sun, 16 Sep 2012 13:01:09
> > -0700:
> >
> >> Hi All,
> >>
> >> Just wondering if anyone has examples lying around of combining chains
> >> from different runs of MCMCglmm on the same model?  If anyone does,
> >> I'd love to look at some.  Ideally they would be generalized (i.e.,
> >> able to combine an arbitrary number of chains).  If not, once I am
> >> done I will probably make a little example and post it somewhere.


> I did still wonder about combining the chains.  

Here is code that runs MCMCglmm on three hosts in a snow cluster
("hans-vita", "hans" and "ingers"), and combines the resulting chains.

library(MCMCglmm)
library(snow)
hosts <- c("hans-vita", "hans", "ingers")
cl <- makeCluster(hosts, type = "SOCK")
clusterEvalQ(cl, data(Traffic, package = 'MASS'))
clusterEvalQ(cl, Traffic$year <- as.factor(Traffic$year))
clusterEvalQ(cl, library(MCMCglmm))
prior <- list(R = list(V = 1, nu = 0.002), G = list(G1 = list(V = 1e+08, fix = 1)))
clusterExport(cl, "prior")
my.mcmc.lists <- parLapply(cl, rep(8000, length(hosts)), function(x) { MCMCglmm(y ~ limit + day, random = ~year, family = "poisson", data = Traffic, prior = prior, verbose = FALSE, pr = TRUE, nitt=x, thin=10, burnin=3000)$Sol })
stopCluster(cl)
library(coda)
summary(mcmc.list(my.mcmc.lists))$quantiles[2,]

-- 
Hans Ekbrand (http://sociologi.cjb.net) <hans at sociologi.cjb.net>


From hans at sociologi.cjb.net  Wed Oct 10 12:18:50 2012
From: hans at sociologi.cjb.net (Hans Ekbrand)
Date: Wed, 10 Oct 2012 12:18:50 +0200
Subject: [R-sig-ME] Combining MCMCglmm estimates
In-Reply-To: <156FA9B609FA8F409121FB91C13E93DB099BC9D728@rcb-exserv.rcbdomain.com>
References: <0698B353E4527B4A906D141B68C088D93A5675@Elpis.ds.WITS.AC.ZA>
	<156FA9B609FA8F409121FB91C13E93DB099BC9D728@rcb-exserv.rcbdomain.com>
Message-ID: <20121010101850.GB4433@samir>

On Mon, Oct 08, 2012 at 10:45:55AM +0100, Paul Johnson wrote:
> Hi Davina,
> 
> I haven't actually merged runs, so the following isn't based on experience. I'm also not aware of the methods for combining SEs from different imputed data sets that you mention. However I have the feeling that you don't need them if you have MCMC output from each data set.
> 
> Leaving aside imputation for the moment...
> 
> Let's say you've run the same model 10 times from the same data set, giving 10 sets of MCMC output, where each output is a sample from the joint posterior distribution of the model parameters. If these are "good" samples from the posterior, then you can combine them and treat them as a single MCMC sample. By "good" I mean they have started from different starting value sets and burned in for long enough to forget these values, they are large enough (e.g. >=1000 independent samples), and they have converged (you can check this visually by plotting the chains over each other - see plot(mcmc.list(...)) in the coda package). 

Why is different starting values important? Shouldn't burning make the 10 chains independent enough?

The reason I'm asking is because I want to know what you _have to_ do
in order to use chains that originates from running MCMC on clusters
or multicore processors.

Different starting points is not very hard to provide, but it would be
good to know if they are important or not.

The idea that different starting points are needed would, if I
understand the rationale correctly, imply that the chains are better
in the end than in the beginning. Is that the point?

-- 
Hans Ekbrand (http://sociologi.cjb.net) <hans at sociologi.cjb.net>


From Paul.Johnson at glasgow.ac.uk  Wed Oct 10 12:56:52 2012
From: Paul.Johnson at glasgow.ac.uk (Paul Johnson)
Date: Wed, 10 Oct 2012 11:56:52 +0100
Subject: [R-sig-ME] Combining MCMCglmm estimates
In-Reply-To: <20121010101850.GB4433@samir>
References: <0698B353E4527B4A906D141B68C088D93A5675@Elpis.ds.WITS.AC.ZA>
	<156FA9B609FA8F409121FB91C13E93DB099BC9D728@rcb-exserv.rcbdomain.com>
	<20121010101850.GB4433@samir>
Message-ID: <156FA9B609FA8F409121FB91C13E93DB099BC9D8E0@rcb-exserv.rcbdomain.com>

> Why is different starting values important?
> Shouldn't burning make the 10 chains independent enough?
...
> The idea that different starting points are needed would, if I
> understand the rationale correctly, imply that the chains are
> better in the end than in the beginning. Is that the point?

I think it's a precaution. Assuming that you have ended up with homogenous looking samples from different runs, you'll be more confident (but never certain of course) that they've converged if they started from different points in parameter space. E.g. there might be local optima where chains could get stuck, and this problem would be much more likely to be discovered starting from different values. I don't know how likely local optima are in practice with a typical MCMCglmm model.

However, I don't see that 10 samples of (effective) size 1000 from the same starting values, with sufficient burnin, are any worse than 10,000 samples from a single run. So my feeling is that using different starting values is always worthwhile (given how easy this is), but not strictly essential.

Cheers,
Paul



-----Original Message-----
From: r-sig-mixed-models-bounces at r-project.org [mailto:r-sig-mixed-models-bounces at r-project.org] On Behalf Of Hans Ekbrand
Sent: 10 October 2012 11:19
To: r-sig-mixed-models at r-project.org
Subject: Re: [R-sig-ME] Combining MCMCglmm estimates

On Mon, Oct 08, 2012 at 10:45:55AM +0100, Paul Johnson wrote:
> Hi Davina,
>
> I haven't actually merged runs, so the following isn't based on experience. I'm also not aware of the methods for combining SEs from different imputed data sets that you mention. However I have the feeling that you don't need them if you have MCMC output from each data set.
>
> Leaving aside imputation for the moment...
>
> Let's say you've run the same model 10 times from the same data set, giving 10 sets of MCMC output, where each output is a sample from the joint posterior distribution of the model parameters. If these are "good" samples from the posterior, then you can combine them and treat them as a single MCMC sample. By "good" I mean they have started from different starting value sets and burned in for long enough to forget these values, they are large enough (e.g. >=1000 independent samples), and they have converged (you can check this visually by plotting the chains over each other - see plot(mcmc.list(...)) in the coda package).

Why is different starting values important? Shouldn't burning make the 10 chains independent enough?

The reason I'm asking is because I want to know what you _have to_ do in order to use chains that originates from running MCMC on clusters or multicore processors.

Different starting points is not very hard to provide, but it would be good to know if they are important or not.

The idea that different starting points are needed would, if I understand the rationale correctly, imply that the chains are better in the end than in the beginning. Is that the point?

--
Hans Ekbrand (http://sociologi.cjb.net) <hans at sociologi.cjb.net>

_______________________________________________
R-sig-mixed-models at r-project.org mailing list https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models


The University of Glasgow, charity number SC004401


From hans at sociologi.cjb.net  Thu Oct 11 10:05:44 2012
From: hans at sociologi.cjb.net (Hans Ekbrand)
Date: Thu, 11 Oct 2012 10:05:44 +0200
Subject: [R-sig-ME] Combining MCMCglmm estimates
In-Reply-To: <156FA9B609FA8F409121FB91C13E93DB099BC9D8E0@rcb-exserv.rcbdomain.com>
References: <0698B353E4527B4A906D141B68C088D93A5675@Elpis.ds.WITS.AC.ZA>
	<156FA9B609FA8F409121FB91C13E93DB099BC9D728@rcb-exserv.rcbdomain.com>
	<20121010101850.GB4433@samir>
	<156FA9B609FA8F409121FB91C13E93DB099BC9D8E0@rcb-exserv.rcbdomain.com>
Message-ID: <20121011080543.GB24904@vardagsrummet>

On Wed, Oct 10, 2012 at 11:56:52AM +0100, Paul Johnson wrote:
> > Why is different starting values important?
> > Shouldn't burning make the 10 chains independent enough?
> ...
> > The idea that different starting points are needed would, if I
> > understand the rationale correctly, imply that the chains are
> > better in the end than in the beginning. Is that the point?
> 
> I think it's a precaution. Assuming that you have ended up with homogenous looking samples from different runs, you'll be more confident (but never certain of course) that they've converged if they started from different points in parameter space. E.g. there might be local optima where chains could get stuck, and this problem would be much more likely to be discovered starting from different values. I don't know how likely local optima are in practice with a typical MCMCglmm model.
> 
> However, I don't see that 10 samples of (effective) size 1000 from the same starting values, with sufficient burnin, are any worse than 10,000 samples from a single run. So my feeling is that using different starting values is always worthwhile (given how easy this is), but not strictly essential.

Thanks for your answer, Paul.

10 different runs with the same starting point would then be just as
good (or bad) as 1 run, while 10 different runs from different
starting points would be better. Is that a correct conclusion?


From jwiley.psych at gmail.com  Thu Oct 11 10:12:38 2012
From: jwiley.psych at gmail.com (Joshua Wiley)
Date: Thu, 11 Oct 2012 01:12:38 -0700
Subject: [R-sig-ME] Combining MCMCglmm estimates
In-Reply-To: <20121011080543.GB24904@vardagsrummet>
References: <0698B353E4527B4A906D141B68C088D93A5675@Elpis.ds.WITS.AC.ZA>
	<156FA9B609FA8F409121FB91C13E93DB099BC9D728@rcb-exserv.rcbdomain.com>
	<20121010101850.GB4433@samir>
	<156FA9B609FA8F409121FB91C13E93DB099BC9D8E0@rcb-exserv.rcbdomain.com>
	<20121011080543.GB24904@vardagsrummet>
Message-ID: <CANz9Z_L9KKqQ=SuAMtQ6mQt0Lc2hH2uT=3++dWZx1DhAnJK5pw@mail.gmail.com>

On Thu, Oct 11, 2012 at 1:05 AM, Hans Ekbrand <hans at sociologi.cjb.net> wrote:
> On Wed, Oct 10, 2012 at 11:56:52AM +0100, Paul Johnson wrote:
>> > Why is different starting values important?
>> > Shouldn't burning make the 10 chains independent enough?
>> ...
>> > The idea that different starting points are needed would, if I
>> > understand the rationale correctly, imply that the chains are
>> > better in the end than in the beginning. Is that the point?
>>
>> I think it's a precaution. Assuming that you have ended up with homogenous looking samples from different runs, you'll be more confident (but never certain of course) that they've converged if they started from different points in parameter space. E.g. there might be local optima where chains could get stuck, and this problem would be much more likely to be discovered starting from different values. I don't know how likely local optima are in practice with a typical MCMCglmm model.
>>
>> However, I don't see that 10 samples of (effective) size 1000 from the same starting values, with sufficient burnin, are any worse than 10,000 samples from a single run. So my feeling is that using different starting values is always worthwhile (given how easy this is), but not strictly essential.
>
> Thanks for your answer, Paul.
>
> 10 different runs with the same starting point would then be just as
> good (or bad) as 1 run, while 10 different runs from different
> starting points would be better. Is that a correct conclusion?

10 different runs would be just as good (or bad) as 1 run, if the
burnin is sufficient. If they are not independent, you gain little.
Using different starting values allows you to make some assessment of
convergence.  Gelman discusses this concept in detail here:
http://stat.columbia.edu/~gelman/research/published/brooksgelman.pdf


>
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models



-- 
Joshua Wiley
Ph.D. Student, Health Psychology
Programmer Analyst II, Statistical Consulting Group
University of California, Los Angeles
https://joshuawiley.com/


From jmmartelo at fc.ul.pt  Thu Oct 11 12:40:35 2012
From: jmmartelo at fc.ul.pt (joana martelo)
Date: Thu, 11 Oct 2012 11:40:35 +0100
Subject: [R-sig-ME] random as fixed effect
Message-ID: <000d01cda79c$d9e60680$8db21380$@ul.pt>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121011/24dbb9a8/attachment.pl>

From bbolker at gmail.com  Thu Oct 11 14:07:33 2012
From: bbolker at gmail.com (Ben Bolker)
Date: Thu, 11 Oct 2012 12:07:33 +0000 (UTC)
Subject: [R-sig-ME] random as fixed effect
References: <000d01cda79c$d9e60680$8db21380$@ul.pt>
Message-ID: <loom.20121011T140349-523@post.gmane.org>

joana martelo <jmmartelo at ...> writes:

> I?m modeling fish activity data with a gaussian distribution for scores
> obtained from Principal Component Analysis. My explanatory variables are
> group size, fish length, temperature and year. Because year has only two
> levels I know I can?t use it as a random effect. However, do you think that
> considering year a fixed effect will inflate the effect of the other
> explanatory variables? 

  No.  On the basis of what you've told us, using year as a fixed
effect seems perfectly sensible.  You might want to check whether
there are important interactions between year and the other explanatory
variables ...

  (Your title seems a bit odd.)

  Ben Bolker


From ronnenberg at gmx.com  Thu Oct 11 14:20:50 2012
From: ronnenberg at gmx.com (Katrin Ronnenberg)
Date: Thu, 11 Oct 2012 14:20:50 +0200
Subject: [R-sig-ME] ZIP MCMCglmm
Message-ID: <20121011122050.74210@gmx.net>

Hi Jarrod, 
Thank you very much for your detailed help! I made some silly mistakes and had to think about some of your answers for a while. Unfortunately, these raise more questions. 
This is my most recent "working" r-code:

prior<-list(R=list(V=diag(2),nu=0.002,fix=2), G=list(G1=list(V=diag(2),nu=0.002)))

Mz<-MCMCglmm(sum_ppho ~ trait-1 + at.level(trait,1):year*
      at.level(trait,1):we+
      at.level(trait,1):(I(cdayofyear^2)+at.level(trait,1):dayofyear)+
      trait:sqkm,
random=~us(trait):EFF_Track, family="zipoisson",pr=TRUE,pl=TRUE,
      data=encounter, rcov=~idh(trait):units, prior=prior, verbose=FALSE,
      nitt=10000,thin =100, burnin = 1000)
summary(Mz)

This gives more or less the expected results, however, I'm not content with its implications.
First, I'm not sure if I misunderstand something, as you can see, I'm still fairly inexperienced. But probably my explanation of "sqkm" was not clear in my last email. 
It is a correction factor, which specifies for each transect "Eff_Track" it's effective observation area. For example in suboptimal weather conditions, you are only able to detect porpoises in shorter distances than in the next year in perfect weather conditions. So you decrease the observed area of transects in the correction factor. So I thought putting it in the random slope term, would account for that. Putting it as a fixed factor is probably of minor interest, as everyone would assume, that you see more porpoises in bigger survey areas. So basically it was my purpose to have the overall slope=0. This still leaves the problem that I need to allow for different slopes and intercepts for the zero-inflation and the poisson part. I tried fitting several terms but could not get the dimensions of the prior right. 

Also, my explanation of g(0) was a very simplified version of the real assumptions, I'm sorry for that. Yes, g(0) both corrects for unavailability bias (that could not be seen, because porpoises were diving) and the perception bias of those missed because of "sleeping" surveyors. Typically g(0) = <0.5, so more than half of the porpoises are missed by surveyors. Which means, quite some zeros will be due to false zeros. 
Does the ZIP model include any assumptions on the probability that animals are missed on transects with detections? I understood, it only accounts for the probability that a zero is a zero from the poisson process or a false zero. 
In fact we have an estimate of g(0) derived from distance sampling methods. I was wondering if it would be possible to use the known/estimated g(0) as starting value for a zero-inflation prior? So far I wasn't able to find any information on how to integrate starting values for latent variables. It seems like a fancy way of dealing with that problem, but maybe that will also exceed my skills. Or is there another way of dealing with that problem?
I believe correcting our counts directly will give even worse results. We give up the ?nteger properties of our variable and herewith change the distribution of data. Even worse with our original methods, we only corrected the counts, but not the zeros (by dividing through correction factors)
cheers,
Katrin


-------- Original-Nachricht --------
> Datum: Sun, 07 Oct 2012 00:07:49 +0100
> Von: Jarrod Hadfield <j.hadfield at ed.ac.uk>
> An: Katrin Ronnenberg <ronnenberg at gmx.com>
> CC: r-sig-mixed-models at r-project.org
> Betreff: Re: [R-sig-ME] ZIP MCMCglmm

> Hi,
> 
> A) The residual variance for the zero-inflation is not identified nor  
> is the residual covariation between the zero-inflation and the Poisson  
> part. However, you are attempting to estimate both. Use:
> 
> rcov=idh(trait):units
> 
> and fix the [2,2] element of the covariance matrix at something (e.g  
> 1) in the prior (i.e. add fix=2 to your R prior).
> 
> B) you have no unique intercepts for the zero inflation and the  
> Poisson part. You should have trait as a main effect in the fixed  
> formula (or trait-1 might be easier to interpret).
> 
> C)
> 
>   random= ~us(1+sqkm):EFF_Track
> 
> assumes that the regression parameters (intercept and slope) of sqkm  
> on log Poisson rate and logit zero-inflation are identical within  
> EFF_Tracks, and that the slope=0 on average (because its not in the  
> fixed formula). I would have one of the following in the fixed effects:
> 
> a) trait:sqkm
> b) at.level(trait,1):sqkm
> c) at.level(trait,2):sqkm
> 
> and one of the following in the random effects.
> 
> i) random= ~us(trait):EFF_Track
> ii) random= ~idh(trait):EFF_Track
> iii) random= ~us(at.level(trait,1)):EFF_Track
> iv) random= ~us(at.level(trait,2)):EFF_Track
> 
> and make sure that if i) or ii) to have a),  if iii) to have a) or b)  
> and if iv) to have a) or c).
> 
> If you use ZAP rather than ZIP then fixed=~sqkm and random= ~EFF_Track  
> is OK too.
> 
> D) DIC should not be trusted.
> 
> E) Not sure, but it sounds like g(0) is correcting for missed  
> sightings of individuals present (?) and therefore refers to the  
> Poisson part of the model.  The zero-inflation part may also be due to  
> missed sightings of individuals present (e.g. on some transects the  
> observers had their eyes closed!) but it is possibly more likely to be  
> due to absence of porpoises? I don't know.
> 
> Cheers,
> 
> Jarrod
> 
> 
> 
> 
> 
> 
> 
> 
> 
> Quoting Katrin Ronnenberg <ronnenberg at gmx.com> on Fri, 05 Oct 2012  
> 12:31:12 +0200:
> 
> > Dear all,
> > I have several questions on a zero-inflated MCMCglmm model.
> >
> > Data consist of 764 transects with porpoise counts ("sum_ppho"). On  
> > 304 transects zero porpoises were seen. Data come from several  
> > studies from the North Sea, they were all sampled in roughly the  
> > same area and from altogether 12 years. We are interested in a trend  
> > ("year"), seasonal effects ("dayofyear" quadratic (centered) Term +  
> > the simple term. Moreover we have a simple geographical variable  
> > "we"; a factor with two levels "West" and "east". The transect ID  
> > (EFF_Track) I integrated as random factor, assuming that transects  
> > are not independant of each other I used the us structure. Most  
> > transects were revisited over several years, but not all of them.  
> > Since Transects had differing length and visibility conditions,  
> > which affected the effective area sampled, I used the effective area  
> > ("sqkm") as random slope term.
> >
> >
> >
> > in MCMCglmm I tried the following:
> >
> > prior<-list(R=list(V=diag(2),nu=0.002),
> G=list(G1=list(V=diag(2),nu=0.002)))
> >
> > Mz<-MCMCglmm(sum_ppho~at.level(trait,1):year*at.level(trait,1):we+
> > +           at.level(trait,1):(I(cdayofyear^2)+  
> > at.level(trait,1):dayofyear), random= ~us(1+sqkm):EFF_Track,
> > +              family="zipoisson",
> > +              data=encounter, rcov=~us(trait):units, prior=prior,  
> > verbose=FALSE,
> > +              nitt=100000,thin =1000, burnin = 5000)
> >> summary(Mz)
> >
> > Iterations = 5001:99001
> >  Thinning interval  = 1000
> >  Sample size  = 95
> >
> >  DIC: 2843.102
> >
> >  G-structure:  ~us(1 + sqkm):EFF_Track
> >
> >                                   post.mean l-95% CI u-95% CI eff.samp
> > (Intercept):(Intercept).EFF_Track   3.62368  1.21791  6.03721    6.215
> > sqkm:(Intercept).EFF_Track         -0.38983 -0.61860 -0.15801   14.857
> > (Intercept):sqkm.EFF_Track         -0.38983 -0.61860 -0.15801   14.857
> > sqkm:sqkm.EFF_Track                 0.05025  0.02699  0.07369   42.211
> >
> >  R-structure:  ~us(trait):units
> >
> >                               post.mean  l-95% CI u-95% CI eff.samp
> > sum_ppho:sum_ppho.units          0.8150  0.673652   1.0178   69.615
> > zi_sum_ppho:sum_ppho.units       0.1894 -0.472509   0.6914    7.978
> > sum_ppho:zi_sum_ppho.units       0.1894 -0.472509   0.6914    7.978
> > zi_sum_ppho:zi_sum_ppho.units    0.1561  0.001532   0.6305    8.428
> >
> >  Location effects: sum_ppho ~ at.level(trait, 1):year *  
> > at.level(trait, 1):we + at.level(trait, 1):(I(cdayofyear^2) +  
> > at.level(trait, 1):dayofyear)
> >
> >                                     post.mean   l-95% CI   u-95% CI  
> > eff.samp  pMCMC
> > (Intercept)                        -3.315e+00 -4.486e+00 -2.045e+00   
> >   1.993  <0.01 *
> > at.level(trait, 1):year             1.673e-03  1.111e-03  2.169e-03   
> >   3.976  <0.01 *
> > at.level(trait, 1):wew             -5.459e+02 -6.696e+02 -4.612e+02   
> >  40.273  <0.01 *
> > at.level(trait, 1):I(cdayofyear^2) -3.117e-05 -5.063e-05 -7.107e-06   
> >  95.000  <0.01 *
> > at.level(trait, 1):dayofyear       -1.726e-03 -3.851e-03  2.335e-05   
> >  59.665 0.0632 .
> > at.level(trait, 1):year:wew         2.727e-01  2.305e-01  3.343e-01   
> >  40.388  <0.01 *
> > ---
> >
> >
> >
> >
> > In general I feel insecure if my assumptions are right and whether  
> > prior specifications make sense. But I have two main questions:
> > 1. Question: Am I correct in the assumption, that, if the output for  
> > autocorr(M1$Sol) and autocorr(M1$VCV) are low, that spatial  
> > autocorrelation is no issue? If I specify a relatively simple model  
> > (only main effects), autocorrelation is no issue, however the more  
> > interaction terms I include the stronger the autocorrelation  
> > becomes. Increasing itterations by a factor of ten to:  
> > nitt=100000,thin =5000, burnin = 10000, hardly changed anything  
> > about that. Is there anything else I could try? I know that I can  
> > increase nitt... further and ask Malcolm about the sir() function.  
> > But I'm especially interested, if experimenting with the random term  
> > has a chance of improving things?
> > 2. Question: Following methods of distance sampling, a G(0) factor  
> > was estimated compensating for the diving porpoises, which escaped  
> > the surveyors. Originally we corrected the observations by dividing  
> > the counts by the G(0) factor. So, basically only the transects with  
> > counts were corrected. Am I right in the assumption that the latent  
> > variable in a ZIP model compensates for all values with false zeros  
> > i.e. also the false zero for the third animal in a transect with 2  
> > counted animals? If that's the case, I would just not include any  
> > correction for g(0). But if the latent variable only compensates for  
> > false zeros of all zero values, but not for other values from the  
> > poisson distribution, then I would assume that the correction factor  
> > is needed. Is that the difference between a hurdle and a ZIP model?  
> > ZIP was in my case better than hurdle according to DIC.
> >
> > I'm sorry, I hope you can understand my questions. I'm neither a  
> > statistician, nor a native speaker, so I would like to appologize  
> > for bad choice of words. And please let me know, if a representive  
> > sample of my data would help.
> > Thank you for reading this, ideas and suggestions are very much
> appreciated.
> >
> > Katrin
> >
> > _______________________________________________
> > R-sig-mixed-models at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >
> >
> 
> -- 
> The University of Edinburgh is a charitable body, registered in
> Scotland, with registration number SC005336.
> 
>


From nilsson.henric at gmail.com  Thu Oct 11 15:15:12 2012
From: nilsson.henric at gmail.com (Henric (Nilsson) Winell)
Date: Thu, 11 Oct 2012 15:15:12 +0200
Subject: [R-sig-ME] 'Missing' tests for lmer models
In-Reply-To: <web-426937519@cgpsrv2.cis.mcmaster.ca>
References: <CAE9UE+9pXiJcaCkJg+a7Bnv_QUyk-Vs01j34G-4ut_kzOOG=+w@mail.gmail.com>
	<Pine.LNX.4.64.1209260717440.6759@orpheus.qimr.edu.au>
	<CAE9UE+_L9eOZfnoMjTbBuQWSBVGi9EOuYBPsmpCXz6f8fHrtqQ@mail.gmail.com>
	<Pine.LNX.4.64.1210101020180.10547@orpheus.qimr.edu.au>
	<web-426937519@cgpsrv2.cis.mcmaster.ca>
Message-ID: <5076C660.4080000@gmail.com>

Dear John,

On 2012-10-10 04:52, John Fox wrote:

> Dear David and Luke,
>
> I missed the beginning of this thread and couldn't find it in the R-sig-ME list archive,

The thread started here:
https://stat.ethz.ch/pipermail/r-sig-mixed-models/2012q3/019141.html

and then continued here:
https://stat.ethz.ch/pipermail/r-sig-mixed-models/2012q4/019236.html


Best regards,
Henric



  so it's not clear to me what the issue is -- sorry -- but I should 
clarify that Anova() for mer objects only does Wald tests -- either Wald 
chisquare tests or F-tests, the latter with Kenward-Roger df computed 
via the pbkrtest package. I think that this could be clearer in ?Anova.
>
> Best,
>   John
>
> ------------------------------------------------
> John Fox
> Sen. William McMaster Prof. of Social Statistics
> Department of Sociology
> McMaster University
> Hamilton, Ontario, Canada
> http://socserv.mcmaster.ca/jfox/
> 	
> On Wed, 10 Oct 2012 11:14:13 +1000
>   David Duffy <David.Duffy at qimr.edu.au> wrote:
>> On Tue, 9 Oct 2012, Luke Duncan wrote:
>>
>>> New computer/32bit R:
>>>
>>> R version 2.15.1 (2012-06-22)
>>> Platform: i386-pc-mingw32/i386 (32-bit)
>>>
>>> other attached packages:
>>> [1] lme4_0.999999-0  Matrix_1.0-6  car_2.0-13
>>>
>>> Old computer/32bit R:
>>>
>>> R version 2.13.1 (2011-07-08)
>>> Platform: i386-pc-mingw32/i386 (32-bit)
>>>
>>> other attached packages:
>>> [1] lme4_0.999375-42   Matrix_0.9996875-3  car_2.0-11
>>
>> Yes, these straddle a moderately large version change in lme4:
>> see the intro at http://lme4.r-forge.r-project.org/
>>
>> The most recent versions of Anova.II.mer() only supports c("chisq", "F"). John Fox may reintroduce Wald tests, but you can always do them yourself.
>>
>> Cheers, David Duffy.
>>
>> --
>> | David Duffy (MBBS PhD)                                         ,-_|\
>> | email: davidD at qimr.edu.au  ph: INT+61+7+3362-0217 fax: -0101  /     *
>> | Epidemiology Unit, Queensland Institute of Medical Research   \_,-._/
>> | 300 Herston Rd, Brisbane, Queensland 4029, Australia  GPG 4D0B994A v
>>
>> _______________________________________________
>> R-sig-mixed-models at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>


From bbolker at gmail.com  Thu Oct 11 15:20:02 2012
From: bbolker at gmail.com (Ben Bolker)
Date: Thu, 11 Oct 2012 09:20:02 -0400
Subject: [R-sig-ME] random as fixed effect
In-Reply-To: <5076C4E7.5090900@yahoo.com>
References: <000d01cda79c$d9e60680$8db21380$@ul.pt>
	<loom.20121011T140349-523@post.gmane.org>
	<5076C4E7.5090900@yahoo.com>
Message-ID: <5076C782.6070403@gmail.com>


 [cc'ing back to r-sig-mixed]

On 12-10-11 09:08 AM, Andrew Koeser wrote:
> Ben,
> 
> I was going to expand on her question, but you beat me to the punch.
> 
> In agriculture, we typically run the same CRD, RCBD, etc (with all fixed
> effects) for 2 to 3 years. In doing this (given instruction from past
> biometry teachers), I would call year/trial random as I do not really
> care about what year/trial is best and I hope to be able to talk about
> the wider range of conditions seen outside of our time frame. I noticed
> in an archived post that you stated 2-3 years/varieties/etc are not
> enough to base an estimate of the variance of the population of effects.
> Is that ultimately the deciding factor in determining whether or not
> year/trial is fixed or random? In other words, is that sufficient
> justification for calling year/trial fixed?
> 
> This is my one major stumbling block in transitioning from SAS to R. I
> greatly appreciate you comments.

  I would argue this is not really a problem in transitioning from SAS
to R, but from classical method-of-moments ANOVA to modern mixed models;
you will have the same kinds of results with SAS PROC MIXED as you will
with nlme/lme4.  http://glmm.wikidot.com/faq#fixed_vs_random  goes into
more detail.  There is a distinction between _conceptual_ or
_philosophical_ random effects (we don't want to make inferences about
specific values, we want to make inferences about the population) and
_computational_ random effects (we want to estimate effects with
shrinkage, we have enough levels to estimate the variance reasonably
well). I would agree that in the best of all possible worlds you would
somehow be able to generalize from an experiment that was run in two
successive years to the performance of a crop variety across all
possible years (and estimate the variance among years accurately), but
that doesn't work particularly well on statistical grounds (the variance
is extremely poorly determined), and in the case of mixed models it
generally fails for computational reasons as well.

> 
> Andrew
> 
> 
> On 10/11/2012 7:07 AM, Ben Bolker wrote:
>> joana martelo <jmmartelo at ...> writes:
>>
>>> I?m modeling fish activity data with a gaussian distribution for scores
>>> obtained from Principal Component Analysis. My explanatory variables are
>>> group size, fish length, temperature and year. Because year has only two
>>> levels I know I can?t use it as a random effect. However, do you
>>> think that
>>> considering year a fixed effect will inflate the effect of the other
>>> explanatory variables?
>>    No.  On the basis of what you've told us, using year as a fixed
>> effect seems perfectly sensible.  You might want to check whether
>> there are important interactions between year and the other explanatory
>> variables ...
>>
>>    (Your title seems a bit odd.)
>>
>>    Ben Bolker
>>
>> _______________________________________________
>> R-sig-mixed-models at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> 
>


From joanamartelo at gmail.com  Thu Oct 11 15:09:25 2012
From: joanamartelo at gmail.com (Joana Martelo)
Date: Thu, 11 Oct 2012 14:09:25 +0100
Subject: [R-sig-ME] random effect
Message-ID: <001401cda7b1$a4f6f370$eee4da50$@com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121011/a7877438/attachment.pl>

From albrechj at staff.uni-marburg.de  Thu Oct 11 17:09:41 2012
From: albrechj at staff.uni-marburg.de (albrechj at staff.uni-marburg.de)
Date: Thu, 11 Oct 2012 17:09:41 +0200
Subject: [R-sig-ME] specification of conditional random effects in lme
Message-ID: <20121011170941.Horde.7KrGPIecwTlQduE1XXgUe_A@home.staff.uni-marburg.de>

Hello,

I have a question regarding the correct specification of the  
conditional random effects in the function lme in package nlme.

Consider the following dataset:

str(data1)
'data.frame':   18 obs. of  6 variables:
$ site      : Factor w/ 10 levels "a","b","c",...
$ year      : Factor w/ 2 levels "2011","2012"
$ covariate : num
$ FactorA   : Factor w/ 2 levels "0","1"
$ FactorB   : Factor w/ 2 levels "0","1"
$ Y         : num

I want to analyse the effect of the covariate and the main factors A  
and B and their interaction A x B on the response Y. The data has been  
collected in 10 study sites in 2011 and in 8 of these sites in 2012.
In the specification of the linear mixed effects model I would like to  
fit year as a conditional random effect on site.

So my question is, whether I have to include year in the specification  
of the "fixed effect" as well:

fit1 <- lme(fixed = Y ~ covariate + (A + B)^2 + year, random = ~  
year|site, data = data1)

or whether I can omit year from the fixed effects, when I am not  
interested in the effect of year, but just want to account for a  
potential effect of year:

fit2 <- lme(fixed = Y ~ covariate + (A + B)^2, random = ~ year|site,  
data = data1)

Is there anything fundamentally wrong in the second way of model  
specification?

Sincerely,

J?rg


From jfox at mcmaster.ca  Thu Oct 11 17:12:37 2012
From: jfox at mcmaster.ca (John Fox)
Date: Thu, 11 Oct 2012 11:12:37 -0400
Subject: [R-sig-ME] 'Missing' tests for lmer models
In-Reply-To: <5076C660.4080000@gmail.com>
References: <CAE9UE+9pXiJcaCkJg+a7Bnv_QUyk-Vs01j34G-4ut_kzOOG=+w@mail.gmail.com>
	<Pine.LNX.4.64.1209260717440.6759@orpheus.qimr.edu.au>
	<CAE9UE+_L9eOZfnoMjTbBuQWSBVGi9EOuYBPsmpCXz6f8fHrtqQ@mail.gmail.com>
	<Pine.LNX.4.64.1210101020180.10547@orpheus.qimr.edu.au>
	<web-426937519@cgpsrv2.cis.mcmaster.ca>
	<5076C660.4080000@gmail.com>
Message-ID: <web-427224187@cgpsrv2.cis.mcmaster.ca>

Dear Henric,

Thanks for this.

I think that what confused me was that the original message appears in a linked URL, not directly in the list archive.

Anyway, I believe that I effectively answered the question: test="chisq" is equivalent to the previous test="Wald", and test="F" will produce a Kenward-Roger F test. Both tests are Wald tests, hence the change in options. And, as I said, ?Anova could be clearer (and will be in the next release).

Best,
 John

On Thu, 11 Oct 2012 15:15:12 +0200
 "Henric (Nilsson) Winell" <nilsson.henric at gmail.com> wrote:
> Dear John,
> 
> On 2012-10-10 04:52, John Fox wrote:
> 
> > Dear David and Luke,
> >
> > I missed the beginning of this thread and couldn't find it in the R-sig-ME list archive,
> 
> The thread started here:
> https://stat.ethz.ch/pipermail/r-sig-mixed-models/2012q3/019141.html
> 
> and then continued here:
> https://stat.ethz.ch/pipermail/r-sig-mixed-models/2012q4/019236.html
> 
> 
> Best regards,
> Henric
> 
> 
> 
>   so it's not clear to me what the issue is -- sorry -- but I should 
> clarify that Anova() for mer objects only does Wald tests -- either Wald chisquare tests or F-tests, the latter with Kenward-Roger df computed via the pbkrtest package. I think that this could be clearer in ?Anova.
> >
> > Best,
> >   John
> >
> > ------------------------------------------------
> > John Fox
> > Sen. William McMaster Prof. of Social Statistics
> > Department of Sociology
> > McMaster University
> > Hamilton, Ontario, Canada
> > http://socserv.mcmaster.ca/jfox/
> > 	
> > On Wed, 10 Oct 2012 11:14:13 +1000
> >   David Duffy <David.Duffy at qimr.edu.au> wrote:
> >> On Tue, 9 Oct 2012, Luke Duncan wrote:
> >>
> >>> New computer/32bit R:
> >>>
> >>> R version 2.15.1 (2012-06-22)
> >>> Platform: i386-pc-mingw32/i386 (32-bit)
> >>>
> >>> other attached packages:
> >>> [1] lme4_0.999999-0  Matrix_1.0-6  car_2.0-13
> >>>
> >>> Old computer/32bit R:
> >>>
> >>> R version 2.13.1 (2011-07-08)
> >>> Platform: i386-pc-mingw32/i386 (32-bit)
> >>>
> >>> other attached packages:
> >>> [1] lme4_0.999375-42   Matrix_0.9996875-3  car_2.0-11
> >>
> >> Yes, these straddle a moderately large version change in lme4:
> >> see the intro at http://lme4.r-forge.r-project.org/
> >>
> >> The most recent versions of Anova.II.mer() only supports c("chisq", "F"). John Fox may reintroduce Wald tests, but you can always do them yourself.
> >>
> >> Cheers, David Duffy.
> >>
> >> --
> >> | David Duffy (MBBS PhD)                                         ,-_|\
> >> | email: davidD at qimr.edu.au  ph: INT+61+7+3362-0217 fax: -0101  /     *
> >> | Epidemiology Unit, Queensland Institute of Medical Research   \_,-._/
> >> | 300 Herston Rd, Brisbane, Queensland 4029, Australia  GPG 4D0B994A v
> >>
> >> _______________________________________________
> >> R-sig-mixed-models at r-project.org mailing list
> >> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >
> > _______________________________________________
> > R-sig-mixed-models at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >
> 

------------------------------------------------
John Fox
Sen. William McMaster Prof. of Social Statistics
Department of Sociology
McMaster University
Hamilton, Ontario, Canada
http://socserv.mcmaster.ca/jfox/


From elepaio44 at yahoo.com  Thu Oct 11 18:59:33 2012
From: elepaio44 at yahoo.com (Matthew Medeiros)
Date: Thu, 11 Oct 2012 09:59:33 -0700 (PDT)
Subject: [R-sig-ME] modeling with hierarchical data
Message-ID: <1349974773.71836.YahooMailNeo@web142301.mail.bf1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121011/a7708cb9/attachment.pl>

From john.maindonald at anu.edu.au  Fri Oct 12 00:46:58 2012
From: john.maindonald at anu.edu.au (John Maindonald)
Date: Fri, 12 Oct 2012 09:46:58 +1100
Subject: [R-sig-ME] random as fixed effect
In-Reply-To: <5076C782.6070403@gmail.com>
References: <000d01cda79c$d9e60680$8db21380$@ul.pt>
	<loom.20121011T140349-523@post.gmane.org>
	<5076C4E7.5090900@yahoo.com> <5076C782.6070403@gmail.com>
Message-ID: <EA326DF0-D9E1-4492-8969-DEB1A0D71B08@anu.edu.au>

1. "we want to make inferences about the population": 
Even making year a random effect is not really enough.  We are dealing with 
a time series, and modelling it as a random effect is a weak concession to that 
issue.  If one does nonetheless fit year as a fixed effect, one should at least 
examine the results for the separate years separately, and check on the extent 
to which they point in the same direction.  Published use of the analysis should 
acknowledge the consequent uncertainty.  

Note however that for certain types of balanced models, the estimates of treatment 
effects will be the same irrespective of whether one fits years as random or fixed.
The model is not allowing for a year by treatment interaction, just as the standard
form of analysis of block designs does not and cannot allow for a block x treatment
interaction.

2. "statistical grounds (the variance is extremely poorly determined)": 
but of course ignoring this component of variance, if it does affect treatment or other 
estimates, does not cause it to go away.

3. "computational reasons": 
The algorithms used in lme4 are general to the extent that they are able to handle
a huge variety of designs.  My experience is using Genstat, which uses quite a
different algorithm. was that it rarely failed for the balanced or approximately
balanced designs that are usual in field and suchlike experimentation.  ASREML
would no doubt perform similarly.

John Maindonald             email: john.maindonald at anu.edu.au
phone : +61 2 (6125)3473    fax  : +61 2(6125)5549
Centre for Mathematics & Its Applications, Room 1194,
John Dedman Mathematical Sciences Building (Building 27)
Australian National University, Canberra ACT 0200.
http://www.maths.anu.edu.au/~johnm

On 12/10/2012, at 12:20 AM, Ben Bolker <bbolker at gmail.com> wrote:

> 
> [cc'ing back to r-sig-mixed]
> 
> On 12-10-11 09:08 AM, Andrew Koeser wrote:
>> Ben,
>> 
>> I was going to expand on her question, but you beat me to the punch.
>> 
>> In agriculture, we typically run the same CRD, RCBD, etc (with all fixed
>> effects) for 2 to 3 years. In doing this (given instruction from past
>> biometry teachers), I would call year/trial random as I do not really
>> care about what year/trial is best and I hope to be able to talk about
>> the wider range of conditions seen outside of our time frame. I noticed
>> in an archived post that you stated 2-3 years/varieties/etc are not
>> enough to base an estimate of the variance of the population of effects.
>> Is that ultimately the deciding factor in determining whether or not
>> year/trial is fixed or random? In other words, is that sufficient
>> justification for calling year/trial fixed?
>> 
>> This is my one major stumbling block in transitioning from SAS to R. I
>> greatly appreciate you comments.
> 
>  I would argue this is not really a problem in transitioning from SAS
> to R, but from classical method-of-moments ANOVA to modern mixed models;
> you will have the same kinds of results with SAS PROC MIXED as you will
> with nlme/lme4.  http://glmm.wikidot.com/faq#fixed_vs_random  goes into
> more detail.  There is a distinction between _conceptual_ or
> _philosophical_ random effects (we don't want to make inferences about
> specific values, we want to make inferences about the population) and
> _computational_ random effects (we want to estimate effects with
> shrinkage, we have enough levels to estimate the variance reasonably
> well). I would agree that in the best of all possible worlds you would
> somehow be able to generalize from an experiment that was run in two
> successive years to the performance of a crop variety across all
> possible years (and estimate the variance among years accurately), but
> that doesn't work particularly well on statistical grounds (the variance
> is extremely poorly determined), and in the case of mixed models it
> generally fails for computational reasons as well.
> 
>> 
>> Andrew
>> 
>> 
>> On 10/11/2012 7:07 AM, Ben Bolker wrote:
>>> joana martelo <jmmartelo at ...> writes:
>>> 
>>>> I?m modeling fish activity data with a gaussian distribution for scores
>>>> obtained from Principal Component Analysis. My explanatory variables are
>>>> group size, fish length, temperature and year. Because year has only two
>>>> levels I know I can?t use it as a random effect. However, do you
>>>> think that
>>>> considering year a fixed effect will inflate the effect of the other
>>>> explanatory variables?
>>>   No.  On the basis of what you've told us, using year as a fixed
>>> effect seems perfectly sensible.  You might want to check whether
>>> there are important interactions between year and the other explanatory
>>> variables ...
>>> 
>>>   (Your title seems a bit odd.)
>>> 
>>>   Ben Bolker
>>> 
>>> _______________________________________________
>>> R-sig-mixed-models at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>> 
>> 
> 
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models


From A.Robinson at ms.unimelb.edu.au  Fri Oct 12 01:43:20 2012
From: A.Robinson at ms.unimelb.edu.au (Andrew Robinson)
Date: Fri, 12 Oct 2012 10:43:20 +1100
Subject: [R-sig-ME] random as fixed effect
In-Reply-To: <EA326DF0-D9E1-4492-8969-DEB1A0D71B08@anu.edu.au>
References: <000d01cda79c$d9e60680$8db21380$@ul.pt>
	<loom.20121011T140349-523@post.gmane.org>
	<5076C4E7.5090900@yahoo.com> <5076C782.6070403@gmail.com>
	<EA326DF0-D9E1-4492-8969-DEB1A0D71B08@anu.edu.au>
Message-ID: <20121011234320.GV546@ms.unimelb.edu.au>

On Fri, Oct 12, 2012 at 09:46:58AM +1100, John Maindonald wrote:
> 1. "we want to make inferences about the population": 

> Even making year a random effect is not really enough.  We are
> dealing with a time series, and modelling it as a random effect is a
> weak concession to that issue.  If one does nonetheless fit year as
> a fixed effect, one should at least examine the results for the
> separate years separately, and check on the extent to which they
> point in the same direction.  Published use of the analysis should
> acknowledge the consequent uncertainty.
> 
> Note however that for certain types of balanced models, the
> estimates of treatment effects will be the same irrespective of
> whether one fits years as random or fixed.  The model is not
> allowing for a year by treatment interaction, just as the standard
> form of analysis of block designs does not and cannot allow for a
> block x treatment interaction.
> 
> 2. "statistical grounds (the variance is extremely poorly
> determined)": but of course ignoring this component of variance, if
> it does affect treatment or other estimates, does not cause it to go
> away.

I echo John's concern.  I would argue that this component of variance
will always affect interval estimates, and it should not be ignored.
I feel uneasy about converting random effects into fixed effects
simply because they have few levels; in so doing we risk
over-confidence in our estimates and tests, because we're assuming
that the contribution is really 0.

My opinion is that the structure of the model should honestly reflect
the structure of the design, at very least.  In an ideal world we
should include the uncertainty around the random effects estimate,
but I do not see that being done.  Maybe two experimental units really
is too few for inference!

Best wishes

Andrew

> 3. "computational reasons": The algorithms used in lme4 are general
> to the extent that they are able to handle a huge variety of
> designs.  My experience is using Genstat, which uses quite a
> different algorithm. was that it rarely failed for the balanced or
> approximately balanced designs that are usual in field and suchlike
> experimentation.  ASREML would no doubt perform similarly.
> 
> John Maindonald             email: john.maindonald at anu.edu.au
> phone : +61 2 (6125)3473    fax  : +61 2(6125)5549
> Centre for Mathematics & Its Applications, Room 1194,
> John Dedman Mathematical Sciences Building (Building 27)
> Australian National University, Canberra ACT 0200.
> http://www.maths.anu.edu.au/~johnm
> 
> On 12/10/2012, at 12:20 AM, Ben Bolker <bbolker at gmail.com> wrote:
> 
> > 
> > [cc'ing back to r-sig-mixed]
> > 
> > On 12-10-11 09:08 AM, Andrew Koeser wrote:
> >> Ben,
> >> 
> >> I was going to expand on her question, but you beat me to the punch.
> >> 
> >> In agriculture, we typically run the same CRD, RCBD, etc (with all fixed
> >> effects) for 2 to 3 years. In doing this (given instruction from past
> >> biometry teachers), I would call year/trial random as I do not really
> >> care about what year/trial is best and I hope to be able to talk about
> >> the wider range of conditions seen outside of our time frame. I noticed
> >> in an archived post that you stated 2-3 years/varieties/etc are not
> >> enough to base an estimate of the variance of the population of effects.
> >> Is that ultimately the deciding factor in determining whether or not
> >> year/trial is fixed or random? In other words, is that sufficient
> >> justification for calling year/trial fixed?
> >> 
> >> This is my one major stumbling block in transitioning from SAS to R. I
> >> greatly appreciate you comments.
> > 
> >  I would argue this is not really a problem in transitioning from SAS
> > to R, but from classical method-of-moments ANOVA to modern mixed models;
> > you will have the same kinds of results with SAS PROC MIXED as you will
> > with nlme/lme4.  http://glmm.wikidot.com/faq#fixed_vs_random  goes into
> > more detail.  There is a distinction between _conceptual_ or
> > _philosophical_ random effects (we don't want to make inferences about
> > specific values, we want to make inferences about the population) and
> > _computational_ random effects (we want to estimate effects with
> > shrinkage, we have enough levels to estimate the variance reasonably
> > well). I would agree that in the best of all possible worlds you would
> > somehow be able to generalize from an experiment that was run in two
> > successive years to the performance of a crop variety across all
> > possible years (and estimate the variance among years accurately), but
> > that doesn't work particularly well on statistical grounds (the variance
> > is extremely poorly determined), and in the case of mixed models it
> > generally fails for computational reasons as well.
> > 
> >> 
> >> Andrew
> >> 
> >> 
> >> On 10/11/2012 7:07 AM, Ben Bolker wrote:
> >>> joana martelo <jmmartelo at ...> writes:
> >>> 
> >>>> I?m modeling fish activity data with a gaussian distribution for scores
> >>>> obtained from Principal Component Analysis. My explanatory variables are
> >>>> group size, fish length, temperature and year. Because year has only two
> >>>> levels I know I can?t use it as a random effect. However, do you
> >>>> think that
> >>>> considering year a fixed effect will inflate the effect of the other
> >>>> explanatory variables?
> >>>   No.  On the basis of what you've told us, using year as a fixed
> >>> effect seems perfectly sensible.  You might want to check whether
> >>> there are important interactions between year and the other explanatory
> >>> variables ...
> >>> 
> >>>   (Your title seems a bit odd.)
> >>> 
> >>>   Ben Bolker
> >>> 
> >>> _______________________________________________
> >>> R-sig-mixed-models at r-project.org mailing list
> >>> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >> 
> >> 
> > 
> > _______________________________________________
> > R-sig-mixed-models at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> 
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models

-- 
Andrew Robinson  
Deputy Director, ACERA 
Department of Mathematics and Statistics            Tel: +61-3-8344-6410
University of Melbourne, VIC 3010 Australia               (prefer email)
http://www.ms.unimelb.edu.au/~andrewpr              Fax: +61-3-8344-4599
http://www.acera.unimelb.edu.au/

Forest Analytics with R (Springer, 2011) 
http://www.ms.unimelb.edu.au/FAwR/
Introduction to Scientific Programming and Simulation using R (CRC, 2009): 
http://www.ms.unimelb.edu.au/spuRs/


From pseudotelphusa at gmail.com  Fri Oct 12 21:53:38 2012
From: pseudotelphusa at gmail.com (George Wang)
Date: Fri, 12 Oct 2012 15:53:38 -0400
Subject: [R-sig-ME] modeling with hierarchical data
In-Reply-To: <1349974773.71836.YahooMailNeo@web142301.mail.bf1.yahoo.com>
References: <1349974773.71836.YahooMailNeo@web142301.mail.bf1.yahoo.com>
Message-ID: <CAGNXmpM4etiLZMjPmMz-ATbMvBJkvz5DtUUZGSxOqoPpodngFQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121012/7251bb1b/attachment.pl>

From trea26 at gmail.com  Sun Oct 14 19:53:12 2012
From: trea26 at gmail.com (Antoine Tremblay)
Date: Sun, 14 Oct 2012 14:53:12 -0300
Subject: [R-sig-ME] R-sig-mixed-models Digest, Vol 70, Issue 19
In-Reply-To: <mailman.3.1350036001.7555.r-sig-mixed-models@r-project.org>
References: <mailman.3.1350036001.7555.r-sig-mixed-models@r-project.org>
Message-ID: <507AFC08.9070803@gmail.com>

No problem :-)

Antoine Tremblay, PhD
NeuroCognitive Imaging Laboratory
Dalhousie University
Halifax, NS B3H 4R2,
Canada

Tel.: (902) 494-1911
eom


On Fri 12 Oct 2012 07:00:01 AM ADT, 
r-sig-mixed-models-request at r-project.org wrote:
> Send R-sig-mixed-models mailing list submissions to
> 	r-sig-mixed-models at r-project.org
>
> To subscribe or unsubscribe via the World Wide Web, visit
> 	https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> or, via email, send a message with subject or body 'help' to
> 	r-sig-mixed-models-request at r-project.org
>
> You can reach the person managing the list at
> 	r-sig-mixed-models-owner at r-project.org
>
> When replying, please edit your Subject line so it is more specific
> than "Re: Contents of R-sig-mixed-models digest..."
>
>
> Today's Topics:
>
>     1. Re: random as fixed effect (Andrew Robinson)
>
>
> ----------------------------------------------------------------------
>
> Message: 1
> Date: Fri, 12 Oct 2012 10:43:20 +1100
> From: Andrew Robinson <A.Robinson at ms.unimelb.edu.au>
> To: John Maindonald <john.maindonald at anu.edu.au>
> Cc: "r-sig-mixed-models at r-project.org"
> 	<r-sig-mixed-models at r-project.org>,	Ben Bolker <bbolker at gmail.com>
> Subject: Re: [R-sig-ME] random as fixed effect
> Message-ID: <20121011234320.GV546 at ms.unimelb.edu.au>
> Content-Type: text/plain; charset=iso-8859-1
>
> On Fri, Oct 12, 2012 at 09:46:58AM +1100, John Maindonald wrote:
>> 1. "we want to make inferences about the population":
>
>> Even making year a random effect is not really enough.  We are
>> dealing with a time series, and modelling it as a random effect is a
>> weak concession to that issue.  If one does nonetheless fit year as
>> a fixed effect, one should at least examine the results for the
>> separate years separately, and check on the extent to which they
>> point in the same direction.  Published use of the analysis should
>> acknowledge the consequent uncertainty.
>>
>> Note however that for certain types of balanced models, the
>> estimates of treatment effects will be the same irrespective of
>> whether one fits years as random or fixed.  The model is not
>> allowing for a year by treatment interaction, just as the standard
>> form of analysis of block designs does not and cannot allow for a
>> block x treatment interaction.
>>
>> 2. "statistical grounds (the variance is extremely poorly
>> determined)": but of course ignoring this component of variance, if
>> it does affect treatment or other estimates, does not cause it to go
>> away.
>
> I echo John's concern.  I would argue that this component of variance
> will always affect interval estimates, and it should not be ignored.
> I feel uneasy about converting random effects into fixed effects
> simply because they have few levels; in so doing we risk
> over-confidence in our estimates and tests, because we're assuming
> that the contribution is really 0.
>
> My opinion is that the structure of the model should honestly reflect
> the structure of the design, at very least.  In an ideal world we
> should include the uncertainty around the random effects estimate,
> but I do not see that being done.  Maybe two experimental units really
> is too few for inference!
>
> Best wishes
>
> Andrew
>
>> 3. "computational reasons": The algorithms used in lme4 are general
>> to the extent that they are able to handle a huge variety of
>> designs.  My experience is using Genstat, which uses quite a
>> different algorithm. was that it rarely failed for the balanced or
>> approximately balanced designs that are usual in field and suchlike
>> experimentation.  ASREML would no doubt perform similarly.
>>
>> John Maindonald             email: john.maindonald at anu.edu.au
>> phone : +61 2 (6125)3473    fax  : +61 2(6125)5549
>> Centre for Mathematics & Its Applications, Room 1194,
>> John Dedman Mathematical Sciences Building (Building 27)
>> Australian National University, Canberra ACT 0200.
>> http://www.maths.anu.edu.au/~johnm
>>
>> On 12/10/2012, at 12:20 AM, Ben Bolker <bbolker at gmail.com> wrote:
>>
>>>
>>> [cc'ing back to r-sig-mixed]
>>>
>>> On 12-10-11 09:08 AM, Andrew Koeser wrote:
>>>> Ben,
>>>>
>>>> I was going to expand on her question, but you beat me to the punch.
>>>>
>>>> In agriculture, we typically run the same CRD, RCBD, etc (with all fixed
>>>> effects) for 2 to 3 years. In doing this (given instruction from past
>>>> biometry teachers), I would call year/trial random as I do not really
>>>> care about what year/trial is best and I hope to be able to talk about
>>>> the wider range of conditions seen outside of our time frame. I noticed
>>>> in an archived post that you stated 2-3 years/varieties/etc are not
>>>> enough to base an estimate of the variance of the population of effects.
>>>> Is that ultimately the deciding factor in determining whether or not
>>>> year/trial is fixed or random? In other words, is that sufficient
>>>> justification for calling year/trial fixed?
>>>>
>>>> This is my one major stumbling block in transitioning from SAS to R. I
>>>> greatly appreciate you comments.
>>>
>>>   I would argue this is not really a problem in transitioning from SAS
>>> to R, but from classical method-of-moments ANOVA to modern mixed models;
>>> you will have the same kinds of results with SAS PROC MIXED as you will
>>> with nlme/lme4.  http://glmm.wikidot.com/faq#fixed_vs_random  goes into
>>> more detail.  There is a distinction between _conceptual_ or
>>> _philosophical_ random effects (we don't want to make inferences about
>>> specific values, we want to make inferences about the population) and
>>> _computational_ random effects (we want to estimate effects with
>>> shrinkage, we have enough levels to estimate the variance reasonably
>>> well). I would agree that in the best of all possible worlds you would
>>> somehow be able to generalize from an experiment that was run in two
>>> successive years to the performance of a crop variety across all
>>> possible years (and estimate the variance among years accurately), but
>>> that doesn't work particularly well on statistical grounds (the variance
>>> is extremely poorly determined), and in the case of mixed models it
>>> generally fails for computational reasons as well.
>>>
>>>>
>>>> Andrew
>>>>
>>>>
>>>> On 10/11/2012 7:07 AM, Ben Bolker wrote:
>>>>> joana martelo <jmmartelo at ...> writes:
>>>>>
>>>>>> I?m modeling fish activity data with a gaussian distribution for scores
>>>>>> obtained from Principal Component Analysis. My explanatory variables are
>>>>>> group size, fish length, temperature and year. Because year has only two
>>>>>> levels I know I can?t use it as a random effect. However, do you
>>>>>> think that
>>>>>> considering year a fixed effect will inflate the effect of the other
>>>>>> explanatory variables?
>>>>>    No.  On the basis of what you've told us, using year as a fixed
>>>>> effect seems perfectly sensible.  You might want to check whether
>>>>> there are important interactions between year and the other explanatory
>>>>> variables ...
>>>>>
>>>>>    (Your title seems a bit odd.)
>>>>>
>>>>>    Ben Bolker
>>>>>
>>>>> _______________________________________________
>>>>> R-sig-mixed-models at r-project.org mailing list
>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>>
>>>>
>>>
>>> _______________________________________________
>>> R-sig-mixed-models at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>
>> _______________________________________________
>> R-sig-mixed-models at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>


From trea26 at gmail.com  Sun Oct 14 19:58:01 2012
From: trea26 at gmail.com (Antoine Tremblay)
Date: Sun, 14 Oct 2012 14:58:01 -0300
Subject: [R-sig-ME] R-sig-mixed-models Digest, Vol 70, Issue 19
In-Reply-To: <mailman.3.1350036001.7555.r-sig-mixed-models@r-project.org>
References: <mailman.3.1350036001.7555.r-sig-mixed-models@r-project.org>
Message-ID: <507AFD29.1090204@gmail.com>

Would Monday at 2:30--3:30-ish and Tuesday at 12:30--1:30-ish work?

Antoine Tremblay, PhD
NeuroCognitive Imaging Laboratory
Dalhousie University
Halifax, NS B3H 4R2,
Canada

Tel.: (902) 494-1911
eom


On Fri 12 Oct 2012 07:00:01 AM ADT, 
r-sig-mixed-models-request at r-project.org wrote:
> Send R-sig-mixed-models mailing list submissions to
> 	r-sig-mixed-models at r-project.org
>
> To subscribe or unsubscribe via the World Wide Web, visit
> 	https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> or, via email, send a message with subject or body 'help' to
> 	r-sig-mixed-models-request at r-project.org
>
> You can reach the person managing the list at
> 	r-sig-mixed-models-owner at r-project.org
>
> When replying, please edit your Subject line so it is more specific
> than "Re: Contents of R-sig-mixed-models digest..."
>
>
> Today's Topics:
>
>     1. Re: random as fixed effect (Andrew Robinson)
>
>
> ----------------------------------------------------------------------
>
> Message: 1
> Date: Fri, 12 Oct 2012 10:43:20 +1100
> From: Andrew Robinson <A.Robinson at ms.unimelb.edu.au>
> To: John Maindonald <john.maindonald at anu.edu.au>
> Cc: "r-sig-mixed-models at r-project.org"
> 	<r-sig-mixed-models at r-project.org>,	Ben Bolker <bbolker at gmail.com>
> Subject: Re: [R-sig-ME] random as fixed effect
> Message-ID: <20121011234320.GV546 at ms.unimelb.edu.au>
> Content-Type: text/plain; charset=iso-8859-1
>
> On Fri, Oct 12, 2012 at 09:46:58AM +1100, John Maindonald wrote:
>> 1. "we want to make inferences about the population":
>
>> Even making year a random effect is not really enough.  We are
>> dealing with a time series, and modelling it as a random effect is a
>> weak concession to that issue.  If one does nonetheless fit year as
>> a fixed effect, one should at least examine the results for the
>> separate years separately, and check on the extent to which they
>> point in the same direction.  Published use of the analysis should
>> acknowledge the consequent uncertainty.
>>
>> Note however that for certain types of balanced models, the
>> estimates of treatment effects will be the same irrespective of
>> whether one fits years as random or fixed.  The model is not
>> allowing for a year by treatment interaction, just as the standard
>> form of analysis of block designs does not and cannot allow for a
>> block x treatment interaction.
>>
>> 2. "statistical grounds (the variance is extremely poorly
>> determined)": but of course ignoring this component of variance, if
>> it does affect treatment or other estimates, does not cause it to go
>> away.
>
> I echo John's concern.  I would argue that this component of variance
> will always affect interval estimates, and it should not be ignored.
> I feel uneasy about converting random effects into fixed effects
> simply because they have few levels; in so doing we risk
> over-confidence in our estimates and tests, because we're assuming
> that the contribution is really 0.
>
> My opinion is that the structure of the model should honestly reflect
> the structure of the design, at very least.  In an ideal world we
> should include the uncertainty around the random effects estimate,
> but I do not see that being done.  Maybe two experimental units really
> is too few for inference!
>
> Best wishes
>
> Andrew
>
>> 3. "computational reasons": The algorithms used in lme4 are general
>> to the extent that they are able to handle a huge variety of
>> designs.  My experience is using Genstat, which uses quite a
>> different algorithm. was that it rarely failed for the balanced or
>> approximately balanced designs that are usual in field and suchlike
>> experimentation.  ASREML would no doubt perform similarly.
>>
>> John Maindonald             email: john.maindonald at anu.edu.au
>> phone : +61 2 (6125)3473    fax  : +61 2(6125)5549
>> Centre for Mathematics & Its Applications, Room 1194,
>> John Dedman Mathematical Sciences Building (Building 27)
>> Australian National University, Canberra ACT 0200.
>> http://www.maths.anu.edu.au/~johnm
>>
>> On 12/10/2012, at 12:20 AM, Ben Bolker <bbolker at gmail.com> wrote:
>>
>>>
>>> [cc'ing back to r-sig-mixed]
>>>
>>> On 12-10-11 09:08 AM, Andrew Koeser wrote:
>>>> Ben,
>>>>
>>>> I was going to expand on her question, but you beat me to the punch.
>>>>
>>>> In agriculture, we typically run the same CRD, RCBD, etc (with all fixed
>>>> effects) for 2 to 3 years. In doing this (given instruction from past
>>>> biometry teachers), I would call year/trial random as I do not really
>>>> care about what year/trial is best and I hope to be able to talk about
>>>> the wider range of conditions seen outside of our time frame. I noticed
>>>> in an archived post that you stated 2-3 years/varieties/etc are not
>>>> enough to base an estimate of the variance of the population of effects.
>>>> Is that ultimately the deciding factor in determining whether or not
>>>> year/trial is fixed or random? In other words, is that sufficient
>>>> justification for calling year/trial fixed?
>>>>
>>>> This is my one major stumbling block in transitioning from SAS to R. I
>>>> greatly appreciate you comments.
>>>
>>>   I would argue this is not really a problem in transitioning from SAS
>>> to R, but from classical method-of-moments ANOVA to modern mixed models;
>>> you will have the same kinds of results with SAS PROC MIXED as you will
>>> with nlme/lme4.  http://glmm.wikidot.com/faq#fixed_vs_random  goes into
>>> more detail.  There is a distinction between _conceptual_ or
>>> _philosophical_ random effects (we don't want to make inferences about
>>> specific values, we want to make inferences about the population) and
>>> _computational_ random effects (we want to estimate effects with
>>> shrinkage, we have enough levels to estimate the variance reasonably
>>> well). I would agree that in the best of all possible worlds you would
>>> somehow be able to generalize from an experiment that was run in two
>>> successive years to the performance of a crop variety across all
>>> possible years (and estimate the variance among years accurately), but
>>> that doesn't work particularly well on statistical grounds (the variance
>>> is extremely poorly determined), and in the case of mixed models it
>>> generally fails for computational reasons as well.
>>>
>>>>
>>>> Andrew
>>>>
>>>>
>>>> On 10/11/2012 7:07 AM, Ben Bolker wrote:
>>>>> joana martelo <jmmartelo at ...> writes:
>>>>>
>>>>>> I?m modeling fish activity data with a gaussian distribution for scores
>>>>>> obtained from Principal Component Analysis. My explanatory variables are
>>>>>> group size, fish length, temperature and year. Because year has only two
>>>>>> levels I know I can?t use it as a random effect. However, do you
>>>>>> think that
>>>>>> considering year a fixed effect will inflate the effect of the other
>>>>>> explanatory variables?
>>>>>    No.  On the basis of what you've told us, using year as a fixed
>>>>> effect seems perfectly sensible.  You might want to check whether
>>>>> there are important interactions between year and the other explanatory
>>>>> variables ...
>>>>>
>>>>>    (Your title seems a bit odd.)
>>>>>
>>>>>    Ben Bolker
>>>>>
>>>>> _______________________________________________
>>>>> R-sig-mixed-models at r-project.org mailing list
>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>>
>>>>
>>>
>>> _______________________________________________
>>> R-sig-mixed-models at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>
>> _______________________________________________
>> R-sig-mixed-models at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>


From trea26 at gmail.com  Sun Oct 14 20:57:31 2012
From: trea26 at gmail.com (Antoine Tremblay)
Date: Sun, 14 Oct 2012 15:57:31 -0300
Subject: [R-sig-ME] R-sig-mixed-models Digest, Vol 70, Issue 19
In-Reply-To: <mailman.3.1350036001.7555.r-sig-mixed-models@r-project.org>
References: <mailman.3.1350036001.7555.r-sig-mixed-models@r-project.org>
Message-ID: <507B0B1B.70302@gmail.com>

Oops! :-(

I don't know how this was sent to the R mailing list???

Sorry

Antoine Tremblay, PhD
NeuroCognitive Imaging Laboratory
Dalhousie University
Halifax, NS B3H 4R2,
Canada

Tel.: (902) 494-1911
eom


On Fri 12 Oct 2012 07:00:01 AM ADT, 
r-sig-mixed-models-request at r-project.org wrote:
> Send R-sig-mixed-models mailing list submissions to
> 	r-sig-mixed-models at r-project.org
>
> To subscribe or unsubscribe via the World Wide Web, visit
> 	https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> or, via email, send a message with subject or body 'help' to
> 	r-sig-mixed-models-request at r-project.org
>
> You can reach the person managing the list at
> 	r-sig-mixed-models-owner at r-project.org
>
> When replying, please edit your Subject line so it is more specific
> than "Re: Contents of R-sig-mixed-models digest..."
>
>
> Today's Topics:
>
>     1. Re: random as fixed effect (Andrew Robinson)
>
>
> ----------------------------------------------------------------------
>
> Message: 1
> Date: Fri, 12 Oct 2012 10:43:20 +1100
> From: Andrew Robinson <A.Robinson at ms.unimelb.edu.au>
> To: John Maindonald <john.maindonald at anu.edu.au>
> Cc: "r-sig-mixed-models at r-project.org"
> 	<r-sig-mixed-models at r-project.org>,	Ben Bolker <bbolker at gmail.com>
> Subject: Re: [R-sig-ME] random as fixed effect
> Message-ID: <20121011234320.GV546 at ms.unimelb.edu.au>
> Content-Type: text/plain; charset=iso-8859-1
>
> On Fri, Oct 12, 2012 at 09:46:58AM +1100, John Maindonald wrote:
>> 1. "we want to make inferences about the population":
>
>> Even making year a random effect is not really enough.  We are
>> dealing with a time series, and modelling it as a random effect is a
>> weak concession to that issue.  If one does nonetheless fit year as
>> a fixed effect, one should at least examine the results for the
>> separate years separately, and check on the extent to which they
>> point in the same direction.  Published use of the analysis should
>> acknowledge the consequent uncertainty.
>>
>> Note however that for certain types of balanced models, the
>> estimates of treatment effects will be the same irrespective of
>> whether one fits years as random or fixed.  The model is not
>> allowing for a year by treatment interaction, just as the standard
>> form of analysis of block designs does not and cannot allow for a
>> block x treatment interaction.
>>
>> 2. "statistical grounds (the variance is extremely poorly
>> determined)": but of course ignoring this component of variance, if
>> it does affect treatment or other estimates, does not cause it to go
>> away.
>
> I echo John's concern.  I would argue that this component of variance
> will always affect interval estimates, and it should not be ignored.
> I feel uneasy about converting random effects into fixed effects
> simply because they have few levels; in so doing we risk
> over-confidence in our estimates and tests, because we're assuming
> that the contribution is really 0.
>
> My opinion is that the structure of the model should honestly reflect
> the structure of the design, at very least.  In an ideal world we
> should include the uncertainty around the random effects estimate,
> but I do not see that being done.  Maybe two experimental units really
> is too few for inference!
>
> Best wishes
>
> Andrew
>
>> 3. "computational reasons": The algorithms used in lme4 are general
>> to the extent that they are able to handle a huge variety of
>> designs.  My experience is using Genstat, which uses quite a
>> different algorithm. was that it rarely failed for the balanced or
>> approximately balanced designs that are usual in field and suchlike
>> experimentation.  ASREML would no doubt perform similarly.
>>
>> John Maindonald             email: john.maindonald at anu.edu.au
>> phone : +61 2 (6125)3473    fax  : +61 2(6125)5549
>> Centre for Mathematics & Its Applications, Room 1194,
>> John Dedman Mathematical Sciences Building (Building 27)
>> Australian National University, Canberra ACT 0200.
>> http://www.maths.anu.edu.au/~johnm
>>
>> On 12/10/2012, at 12:20 AM, Ben Bolker <bbolker at gmail.com> wrote:
>>
>>>
>>> [cc'ing back to r-sig-mixed]
>>>
>>> On 12-10-11 09:08 AM, Andrew Koeser wrote:
>>>> Ben,
>>>>
>>>> I was going to expand on her question, but you beat me to the punch.
>>>>
>>>> In agriculture, we typically run the same CRD, RCBD, etc (with all fixed
>>>> effects) for 2 to 3 years. In doing this (given instruction from past
>>>> biometry teachers), I would call year/trial random as I do not really
>>>> care about what year/trial is best and I hope to be able to talk about
>>>> the wider range of conditions seen outside of our time frame. I noticed
>>>> in an archived post that you stated 2-3 years/varieties/etc are not
>>>> enough to base an estimate of the variance of the population of effects.
>>>> Is that ultimately the deciding factor in determining whether or not
>>>> year/trial is fixed or random? In other words, is that sufficient
>>>> justification for calling year/trial fixed?
>>>>
>>>> This is my one major stumbling block in transitioning from SAS to R. I
>>>> greatly appreciate you comments.
>>>
>>>   I would argue this is not really a problem in transitioning from SAS
>>> to R, but from classical method-of-moments ANOVA to modern mixed models;
>>> you will have the same kinds of results with SAS PROC MIXED as you will
>>> with nlme/lme4.  http://glmm.wikidot.com/faq#fixed_vs_random  goes into
>>> more detail.  There is a distinction between _conceptual_ or
>>> _philosophical_ random effects (we don't want to make inferences about
>>> specific values, we want to make inferences about the population) and
>>> _computational_ random effects (we want to estimate effects with
>>> shrinkage, we have enough levels to estimate the variance reasonably
>>> well). I would agree that in the best of all possible worlds you would
>>> somehow be able to generalize from an experiment that was run in two
>>> successive years to the performance of a crop variety across all
>>> possible years (and estimate the variance among years accurately), but
>>> that doesn't work particularly well on statistical grounds (the variance
>>> is extremely poorly determined), and in the case of mixed models it
>>> generally fails for computational reasons as well.
>>>
>>>>
>>>> Andrew
>>>>
>>>>
>>>> On 10/11/2012 7:07 AM, Ben Bolker wrote:
>>>>> joana martelo <jmmartelo at ...> writes:
>>>>>
>>>>>> I?m modeling fish activity data with a gaussian distribution for scores
>>>>>> obtained from Principal Component Analysis. My explanatory variables are
>>>>>> group size, fish length, temperature and year. Because year has only two
>>>>>> levels I know I can?t use it as a random effect. However, do you
>>>>>> think that
>>>>>> considering year a fixed effect will inflate the effect of the other
>>>>>> explanatory variables?
>>>>>    No.  On the basis of what you've told us, using year as a fixed
>>>>> effect seems perfectly sensible.  You might want to check whether
>>>>> there are important interactions between year and the other explanatory
>>>>> variables ...
>>>>>
>>>>>    (Your title seems a bit odd.)
>>>>>
>>>>>    Ben Bolker
>>>>>
>>>>> _______________________________________________
>>>>> R-sig-mixed-models at r-project.org mailing list
>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>>
>>>>
>>>
>>> _______________________________________________
>>> R-sig-mixed-models at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>
>> _______________________________________________
>> R-sig-mixed-models at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>


From trea26 at gmail.com  Sun Oct 14 20:58:01 2012
From: trea26 at gmail.com (Antoine Tremblay)
Date: Sun, 14 Oct 2012 15:58:01 -0300
Subject: [R-sig-ME] R-sig-mixed-models Digest, Vol 70, Issue 19
In-Reply-To: <mailman.3.1350036001.7555.r-sig-mixed-models@r-project.org>
References: <mailman.3.1350036001.7555.r-sig-mixed-models@r-project.org>
Message-ID: <507B0B39.8020700@gmail.com>

Would Monday at 2:30--3:30-ish and Tuesday at 12:30--1:30-ish work?

Antoine Tremblay, PhD
NeuroCognitive Imaging Laboratory
Dalhousie University
Halifax, NS B3H 4R2,
Canada

Tel.: (902) 494-1911
eom


On Fri 12 Oct 2012 07:00:01 AM ADT, 
r-sig-mixed-models-request at r-project.org wrote:
> Send R-sig-mixed-models mailing list submissions to
> 	r-sig-mixed-models at r-project.org
>
> To subscribe or unsubscribe via the World Wide Web, visit
> 	https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> or, via email, send a message with subject or body 'help' to
> 	r-sig-mixed-models-request at r-project.org
>
> You can reach the person managing the list at
> 	r-sig-mixed-models-owner at r-project.org
>
> When replying, please edit your Subject line so it is more specific
> than "Re: Contents of R-sig-mixed-models digest..."
>
>
> Today's Topics:
>
>     1. Re: random as fixed effect (Andrew Robinson)
>
>
> ----------------------------------------------------------------------
>
> Message: 1
> Date: Fri, 12 Oct 2012 10:43:20 +1100
> From: Andrew Robinson <A.Robinson at ms.unimelb.edu.au>
> To: John Maindonald <john.maindonald at anu.edu.au>
> Cc: "r-sig-mixed-models at r-project.org"
> 	<r-sig-mixed-models at r-project.org>,	Ben Bolker <bbolker at gmail.com>
> Subject: Re: [R-sig-ME] random as fixed effect
> Message-ID: <20121011234320.GV546 at ms.unimelb.edu.au>
> Content-Type: text/plain; charset=iso-8859-1
>
> On Fri, Oct 12, 2012 at 09:46:58AM +1100, John Maindonald wrote:
>> 1. "we want to make inferences about the population":
>
>> Even making year a random effect is not really enough.  We are
>> dealing with a time series, and modelling it as a random effect is a
>> weak concession to that issue.  If one does nonetheless fit year as
>> a fixed effect, one should at least examine the results for the
>> separate years separately, and check on the extent to which they
>> point in the same direction.  Published use of the analysis should
>> acknowledge the consequent uncertainty.
>>
>> Note however that for certain types of balanced models, the
>> estimates of treatment effects will be the same irrespective of
>> whether one fits years as random or fixed.  The model is not
>> allowing for a year by treatment interaction, just as the standard
>> form of analysis of block designs does not and cannot allow for a
>> block x treatment interaction.
>>
>> 2. "statistical grounds (the variance is extremely poorly
>> determined)": but of course ignoring this component of variance, if
>> it does affect treatment or other estimates, does not cause it to go
>> away.
>
> I echo John's concern.  I would argue that this component of variance
> will always affect interval estimates, and it should not be ignored.
> I feel uneasy about converting random effects into fixed effects
> simply because they have few levels; in so doing we risk
> over-confidence in our estimates and tests, because we're assuming
> that the contribution is really 0.
>
> My opinion is that the structure of the model should honestly reflect
> the structure of the design, at very least.  In an ideal world we
> should include the uncertainty around the random effects estimate,
> but I do not see that being done.  Maybe two experimental units really
> is too few for inference!
>
> Best wishes
>
> Andrew
>
>> 3. "computational reasons": The algorithms used in lme4 are general
>> to the extent that they are able to handle a huge variety of
>> designs.  My experience is using Genstat, which uses quite a
>> different algorithm. was that it rarely failed for the balanced or
>> approximately balanced designs that are usual in field and suchlike
>> experimentation.  ASREML would no doubt perform similarly.
>>
>> John Maindonald             email: john.maindonald at anu.edu.au
>> phone : +61 2 (6125)3473    fax  : +61 2(6125)5549
>> Centre for Mathematics & Its Applications, Room 1194,
>> John Dedman Mathematical Sciences Building (Building 27)
>> Australian National University, Canberra ACT 0200.
>> http://www.maths.anu.edu.au/~johnm
>>
>> On 12/10/2012, at 12:20 AM, Ben Bolker <bbolker at gmail.com> wrote:
>>
>>>
>>> [cc'ing back to r-sig-mixed]
>>>
>>> On 12-10-11 09:08 AM, Andrew Koeser wrote:
>>>> Ben,
>>>>
>>>> I was going to expand on her question, but you beat me to the punch.
>>>>
>>>> In agriculture, we typically run the same CRD, RCBD, etc (with all fixed
>>>> effects) for 2 to 3 years. In doing this (given instruction from past
>>>> biometry teachers), I would call year/trial random as I do not really
>>>> care about what year/trial is best and I hope to be able to talk about
>>>> the wider range of conditions seen outside of our time frame. I noticed
>>>> in an archived post that you stated 2-3 years/varieties/etc are not
>>>> enough to base an estimate of the variance of the population of effects.
>>>> Is that ultimately the deciding factor in determining whether or not
>>>> year/trial is fixed or random? In other words, is that sufficient
>>>> justification for calling year/trial fixed?
>>>>
>>>> This is my one major stumbling block in transitioning from SAS to R. I
>>>> greatly appreciate you comments.
>>>
>>>   I would argue this is not really a problem in transitioning from SAS
>>> to R, but from classical method-of-moments ANOVA to modern mixed models;
>>> you will have the same kinds of results with SAS PROC MIXED as you will
>>> with nlme/lme4.  http://glmm.wikidot.com/faq#fixed_vs_random  goes into
>>> more detail.  There is a distinction between _conceptual_ or
>>> _philosophical_ random effects (we don't want to make inferences about
>>> specific values, we want to make inferences about the population) and
>>> _computational_ random effects (we want to estimate effects with
>>> shrinkage, we have enough levels to estimate the variance reasonably
>>> well). I would agree that in the best of all possible worlds you would
>>> somehow be able to generalize from an experiment that was run in two
>>> successive years to the performance of a crop variety across all
>>> possible years (and estimate the variance among years accurately), but
>>> that doesn't work particularly well on statistical grounds (the variance
>>> is extremely poorly determined), and in the case of mixed models it
>>> generally fails for computational reasons as well.
>>>
>>>>
>>>> Andrew
>>>>
>>>>
>>>> On 10/11/2012 7:07 AM, Ben Bolker wrote:
>>>>> joana martelo <jmmartelo at ...> writes:
>>>>>
>>>>>> I?m modeling fish activity data with a gaussian distribution for scores
>>>>>> obtained from Principal Component Analysis. My explanatory variables are
>>>>>> group size, fish length, temperature and year. Because year has only two
>>>>>> levels I know I can?t use it as a random effect. However, do you
>>>>>> think that
>>>>>> considering year a fixed effect will inflate the effect of the other
>>>>>> explanatory variables?
>>>>>    No.  On the basis of what you've told us, using year as a fixed
>>>>> effect seems perfectly sensible.  You might want to check whether
>>>>> there are important interactions between year and the other explanatory
>>>>> variables ...
>>>>>
>>>>>    (Your title seems a bit odd.)
>>>>>
>>>>>    Ben Bolker
>>>>>
>>>>> _______________________________________________
>>>>> R-sig-mixed-models at r-project.org mailing list
>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>>>
>>>>
>>>
>>> _______________________________________________
>>> R-sig-mixed-models at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>
>> _______________________________________________
>> R-sig-mixed-models at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>


From andrewdigby at mac.com  Mon Oct 15 02:53:59 2012
From: andrewdigby at mac.com (Andrew Digby)
Date: Mon, 15 Oct 2012 13:53:59 +1300
Subject: [R-sig-ME] Which residuals to use for GEEs?
In-Reply-To: <mailman.1573.1350241068.4555.r-sig-mixed-models@r-project.org>
References: <mailman.1573.1350241068.4555.r-sig-mixed-models@r-project.org>
Message-ID: <DC7D0FD5-B43C-4C51-BECB-A69F6A89BE65@mac.com>


Apologies for what may be a naive question, but I'd appreciate some help with model validation diagnostics for generalized estimating equations. I've searched extensively for the answer to the following, with no luck.

** Question: which residuals should be used when checking model adequacy with GEEs? **

I understand from Hardin & Hilbe 2002 ("Generalized Estimating Equations", CRC press) that plots of raw residuals against observation number can be used to identify time dependence in the residuals. However, I'm confused by the use of _raw_ residuals here. Do they take into account the correlation structure?

In contrast, when fitting a (generalized) linear model with a correlation structure (e.g. with gls/glmmPQL), I understand that standardized residuals (resid(fit, type='normalized')) should be used to look for time dependence (e.g. with an ACF), since they account for the correlation structure used (see e.g. Zuur et al.'s 2009 book, chapter 6). 

So why use one type of residuals for assessing residual indepence in GEEs, and another for (G)LMMs? The only reference I can find to using residuals standardized by the working correlation in a GEE is here: http://www.ufz.de/export/data/1/22564_carl_kuehn_ECOMOD1458.pdf. All other references I've found use the raw residuals.

My data have an auto-regressive temporal dependence, so the Pearson/response residuals show temporal patterns, whether I use a GEE (AR1) or glmmPQL (AR1). However, the standardized residuals (accounting for the correlation structure), show no such patterns for the glmmPQL model. But there's no easy way of calculating the standardized residuals that account for the working correlation in the GEE, and, from my interpretation of the references I've found, I should be using the raw residuals anyway (which I think don't incorporate the correlation structure).

The following code demonstrates the problem I'm having. It creates GEE and glmmPQL models from the dietox dataset, each with an AR1 correlation structure. Patterns are evident in the Pearson and response (raw) residuals for both models. But when plotting the standardized (normalized) residuals for the glmmPQL model, the patterns are resolved. Why can't I plot standardized residuals for the GEE too?

I must be missing something; any clues would be much appreciated!

Thanks in advance for any help, and apologies if this is a stupid question.

Andrew





---------------------------------------------------------------

require(geeglm)
require(ggplot2)
require(gridExtra)
require(MASS)

data(dietox)
dietox$Cu     <- as.factor(dietox$Cu)
dietox$nobs <- row(dietox)[,1]

# GEE model
mf <- formula(Weight~Cu*(Time+I(Time^2)+I(Time^3)))
gee1 <- geeglm(mf, data=dietox, id=Pig, family=poisson("identity"),corstr="ar1")

# Plot GEE residuals (Pearson & response)
rp<-resid(gee1,type="pearson")
rr<-resid(gee1,type="response")
dietox2 <- cbind(dietox, rp, rr)
pigs<-data.frame(start=which(!duplicated(dietox$Pig)),  group=dietox$Pig[which(!duplicated(dietox$Pig))])
theme_set(theme_bw())
g1p<-ggplot(dietox2, aes(x=row(dietox)[,1])) + geom_point(aes(y=rp)) + geom_linerange(data=pigs, aes(x=start, ymin=min(rp), ymax=max(rp)), linetype="dotted", colour="red", show_guide=F) + geom_hline(yintercept=0, slope=0) + labs(list(title="Pearson residuals", x="Obs no"))
g1r<-ggplot(dietox2, aes(x=row(dietox)[,1])) + geom_point(aes(y=rr)) + geom_linerange(data=pigs, aes(x=start, ymin=min(rr), ymax=max(rr)), linetype="dotted", colour="red", show_guide=F) + geom_hline(yintercept=0, slope=0) + labs(list(title="Response residuals", x="Obs no"))
grid.arrange(g1p, g1r, nrow=2)


# glmmPQL model
pql <- glmmPQL(fixed=mf, random=~1|Pig, data=dietox, family=poisson, correlation = corAR1(form = ~Time))

# Plot glmmPQL residuals (Pearson, response and standardized)
rp<-resid(pql,type="pearson")
rr<-resid(pql,type="response")
rn<-resid(pql, type="normalized")
dietox3 <- cbind(dietox, rp, rr, rn)
gp<-ggplot(dietox3, aes(x=nobs)) + geom_point(aes(y=rp)) + geom_linerange(data=pigs, aes(x=start, ymin=min(rp), ymax=max(rp)), linetype="dotted", colour="red", show_guide=F) + geom_hline(yintercept=0, slope=0) + labs(list(title="Pearson residuals", x="Obs no"))
gr<-ggplot(dietox3, aes(x=nobs)) + geom_point(aes(y=rr)) + geom_linerange(data=pigs, aes(x=start, ymin=min(rr), ymax=max(rr)), linetype="dotted", colour="red", show_guide=F) + geom_hline(yintercept=0, slope=0) + labs(list(title="Response residuals", x="Obs no"))
gn<-ggplot(dietox3, aes(x=nobs)) + geom_point(aes(y=rn)) + geom_linerange(data=pigs, aes(x=start, ymin=min(rn), ymax=max(rn)), linetype="dotted", colour="red", show_guide=F) + geom_hline(yintercept=0, slope=0) + labs(list(title="Normalized residuals", x="Obs no"))
grid.arrange(gp,gr,gn,nrow=3)


From u28101104 at zoology.up.ac.za  Mon Oct 15 21:39:55 2012
From: u28101104 at zoology.up.ac.za (=?iso-8859-1?Q?=22Gerhard_G=F6ldner=22?=)
Date: Mon, 15 Oct 2012 21:39:55 +0200
Subject: [R-sig-ME] [Fwd: Errors in lme]
Message-ID: <44009b4682e5cd7e706ee4896b0daccb.squirrel@zoology.up.ac.za>

Good day,

I am trying to do analysis on a dataset using mixed models because I have
samples from repeated individual animals.  Please find attached my
dataset.  The question I would like to pose is if and what are the effects
of the variable of distances and time on the proportional mass
change(propmc).  I have included other factorial effects such as age sex
and phase as well as year, but I don't know if I am using them correctly
in the model.

I have also attached the codes that I use for the model and the error
messages I am getting.  I have done some internet searches and some
suggest missing data as the culprit or fixed effects that are correlated.
Even if I exclude correlated fixed effects and only include fixed effects
which are not correlated with each other, I still get the same message
"error in MEEM - singularity in backsolve, level 0, block 1".

In addition, if I use for example a simpler model with only one fixed
effect, the model runs, but the output doesn't have p-values.. it only
says NaN.  I also did a search on that and found that it means Not a
number, though I don't know why it is producing that.  I noticed that the
DF is negative however and that if I use less variables, the DF increases
and the p value is calculated.  Is there a statistical way of using
t-values, without using p-values, as someone told me using AIC and
p-values are two different methodologies or philosophies.  In other words,
is it correct to still use the AIC values even if I don't get p-values and
just use the AIC values.

Can you please help me by making any suggestions about how to correct
this.  The "missing" data in my dataset are not missing - the values are
actually 0!

Thank you for any help you can give me - if not, could you please refer me
elsewhere?  I have your book "Mixed effects models in S and S-plus" 2000,
but would appreciate any help you can give me.

I would appreciate it very much.

Gerhard





---------------------------------------------------------------------
This message and attachments are subject to a disclaimer. Please refer to http://www.it.up.ac.za/documentation/governance/disclaimer/ for full details. / Hierdie boodskap en aanhangsels is aan 'n vrywaringsklousule onderhewig. Volledige besonderhede is by http://www.it.up.ac.za/documentation/governance/disclaimer/ beskikbaar.
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: errors in lme.txt
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121015/d0c67d42/attachment.txt>

From bbolker at gmail.com  Mon Oct 15 22:51:33 2012
From: bbolker at gmail.com (Ben Bolker)
Date: Mon, 15 Oct 2012 20:51:33 +0000 (UTC)
Subject: [R-sig-ME] [Fwd: Errors in lme]
References: <44009b4682e5cd7e706ee4896b0daccb.squirrel@zoology.up.ac.za>
Message-ID: <loom.20121015T223925-426@post.gmane.org>

Gerhard G?ldner <u28101104 at ...> writes:

> I am trying to do analysis on a dataset using mixed models because I have
> samples from repeated individual animals.  Please find attached my
> dataset.  The question I would like to pose is if and what are the effects
> of the variable of distances and time on the proportional mass
> change(propmc).  I have included other factorial effects such as age sex
> and phase as well as year, but I don't know if I am using them correctly
> in the model.
> 
> I have also attached the codes that I use for the model and the error
> messages I am getting.  I have done some internet searches and some
> suggest missing data as the culprit or fixed effects that are correlated.
> Even if I exclude correlated fixed effects and only include fixed effects
> which are not correlated with each other, I still get the same message
> "error in MEEM - singularity in backsolve, level 0, block 1".
> 
> In addition, if I use for example a simpler model with only one fixed
> effect, the model runs, but the output doesn't have p-values.. it only
> says NaN.  I also did a search on that and found that it means Not a
> number, though I don't know why it is producing that.  I noticed that the
> DF is negative however and that if I use less variables, the DF increases
> and the p value is calculated.  Is there a statistical way of using
> t-values, without using p-values, as someone told me using AIC and
> p-values are two different methodologies or philosophies.  In other words,
> is it correct to still use the AIC values even if I don't get p-values and
> just use the AIC values.
> 
> Can you please help me by making any suggestions about how to correct
> this.  The "missing" data in my dataset are not missing - the values are
> actually 0!

  I don't quite know what this means. I see seven observations in the data set
below, none missing. Individual YY193 has a few of its predictor variables
equal to zero, but that shouldn't necessarily be a problem.

> Thank you for any help you can give me - if not, could you please refer me
> elsewhere?  I have your book "Mixed effects models in S and S-plus" 2000,
> but would appreciate any help you can give me.

[snip]

> 
> > library(nlme)
> > dataf<-read.table("C:/Documents and Settings/New
user.HOME-2DCF24A8DD/Desktop/analysis/pdataf.txt",header=T)
> > dataf
>     tag year sex phase age   mstart     mend        mc    propmc    kmtoF1
> 1 PO043 2009  AF    PM  10 373.4657 475.6858 102.22008 27.370676  420.2365
> 2 RR435 2009  AF    PM   4 270.0599 516.3509 246.29104 91.198685 2195.4183
> 3 RR435 2010  AF    PM   5 331.8893 531.0843 199.19494 60.018484 1623.7955
> 4 WR336 2008  AF    PB  11 418.6430 507.9936  89.35066 21.342926  781.5365
> 5 YY189 2009  AF    PM   5 300.1781 508.0098 207.83174 69.236153 1010.0676
> 6 YY193 2007  AF    PB   4 346.3593 430.2214  83.86210 24.212458    0.0000
> 7 YY240 2007  AF    PB   4 372.1941 406.9324  34.73827  9.333375 1268.4038
>   meankmtoF1 htoF1 durF1 meandurFpat totFtime tripdur propforage    farkm fx
> 1   394.4627   280   232    214.2222     1928    5632   34.23295 1476.228  9
> 2  2217.2725  1136   240    433.0000     3464    6480   53.45679 2268.101  8
> 3  1642.6462  1240   168    288.0000     2880    8064   35.71429 2022.378 10
> 4   896.8356   376   736    736.0000      736    1536   47.91667 1031.621  1
> 5  1011.0565   496    96    190.0000     1520    5832   26.06310 2201.082  8
> 6     0.0000     0     0      0.0000        0    1824    0.00000 1931.764  0
> 7  1324.0800   616   448    448.0000      448    2056   21.78988 1425.120  1
>           mv    febpm
> 1 0.20312652 30.80966
> 2 0.25818408 48.11111
> 3 0.07446295 32.14286
> 4 1.96484928 43.12500
> 5 0.07896997 23.45679
> 6 0.00000000  0.00000
> 7 2.71668110 19.61089

  is this really your full dataset (i.e. you have a *total* of 7 observations)?

> > attach(dataf)

  A minor note, it's generally better (more stable) to use data=dataf in
your lme() call rather than attach()/detach()


> > fm0f<-lme(propmc~kmtoF1+htoF1+tripdur+farkm,random=~1|tag,method="ML")


> > fm0f<-lme(propmc~kmtoF1+tripdur,random=~1|tag,method="ML")
> > summary(fm0f)
> Linear mixed-effects model fit by maximum likelihood
>  Data: NULL 
>        AIC      BIC    logLik
>   68.36043 68.08998 -29.18022
> 
> Random effects:
>  Formula: ~1 | tag
>          (Intercept) Residual
> StdDev: 0.0007653108 15.63737
> 
> Fixed effects: propmc ~ kmtoF1 + tripdur 
>                 Value Std.Error DF   t-value p-value
> (Intercept) -1.619729 17.010746  5 -0.095218  0.9278
> kmtoF1       0.014981  0.013920 -1  1.076211     NaN
> tripdur      0.006514  0.003898 -1  1.671239     NaN

  [snip]

> Number of Observations: 7
> Number of Groups: 6 
> Warning message:
> In pt(q, df, lower.tail, log.p) : NaNs produced
> > 


  It looks like all of your predictor variables are numeric, and that you
have a single individual (RR435) for which you have repeated measurement in
two different years.  A general rule of thumb is that you should have at
least ten (!!) data points per parameter you are trying to estimate, which
in this case means that even your simpler model is quite badly overfitted (you
are estimating 3 fixed-effect parameters, so you should hope for at least
30 data points ... even with 15 this would be a little bit optimistic).
lme() follows a set of rules (described in detail in Pinheiro & Bates for
calculating the residual degrees of freedom, and in this case they come
out negative, hence the NaN p-values in your simpler table.

   The bottom line is that I think you just don't have enough data to
do what you want.  In your situation I would probably do separate linear
regressions on each predictor variable you're interested in, showing the
data graphically and indicating to the reader that (1) two of the points were
repeated measurements from the same individual and (2) you are not considering
any collinearity or overlap in the predictive ability, nor any multiple
comparisons corrections for considering multiple predictors. In other
words, this is an *exploratory* analysis.

Your estimate of the among-tag standard deviation is very small 
relative to the residual standard deviation (about 4 orders of magnitude
smaller); although it's probably extremely imprecisely estimated, it
does somewhat support the procedure of ignoring the random effect.


From drmccloy at uw.edu  Tue Oct 16 00:33:15 2012
From: drmccloy at uw.edu (Dan McCloy)
Date: Mon, 15 Oct 2012 15:33:15 -0700
Subject: [R-sig-ME] lmer and truncated gaussian distributions
Message-ID: <CAOE0pYnRO5OoG9ZqoorLJnBNeBzvTcXWObW972-j31W_Wg++6w@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121015/7397842c/attachment.pl>

From rjadenham at gmail.com  Tue Oct 16 02:19:48 2012
From: rjadenham at gmail.com (robert denham)
Date: Tue, 16 Oct 2012 10:19:48 +1000
Subject: [R-sig-ME] help interpreting variance estimate in nlmer
Message-ID: <CAHMvJdSQDGQOcWNOf047mg+m_DsCsxizo1uuRT=6G+D9mXwwMw@mail.gmail.com>

Hi,
   just a quick question to try and help me understand the
interpretation of the variance part of a non-linear mixed effects
model.
If I use the orange tree example like:


nm1 <- nlmer(circumference ~ SSlogis(age,Asym, xmid, scal) ~ Asym|Tree,
             Orange, start=c(Asym=192,xmid=770, scal=120),
             corr=FALSE)

I get:

> summary(nm1)
Nonlinear mixed model fit by the Laplace approximation
Formula: circumference ~ SSlogis(age, Asym, xmid, scal) ~ Asym | Tree
   Data: Orange
  AIC  BIC logLik deviance
 1901 1908 -945.3     1891
Random effects:
 Groups   Name Variance  Std.Dev.
 Tree     Asym 53986.025 232.349
 Residual         52.868   7.271
Number of obs: 35, groups: Tree, 5

Fixed effects:
     Estimate Std. Error t value
Asym   192.04     104.09   1.845
xmid   727.89      31.97  22.771
scal   347.97      24.42  14.252

So a single random effect for the asymptote. The values of these for
each tree are:
> ranef(nm1)
$Tree
        Asym
3 -37.925218
1 -30.143951
5  -5.299054
2  32.352094
4  41.016208

But the estimated variance/sd of this seems very large (sd=232.349).
Should we be able to interpret the estimates as the random effect term
for the asymptote is distributed N(0,232.349) and that the estimated
random effects should look like they come from this distribution?

Basically, I don't really understand the relationship between the
distribution of ranef(nm1)$Tree and the estimated std.dev of the tree
(232.349). I would love it if someone could help explain it.

Thanks
Robert


From ukoether at uke.de  Tue Oct 16 10:56:32 2012
From: ukoether at uke.de (=?ISO-8859-15?Q?Ulf_K=F6ther?=)
Date: Tue, 16 Oct 2012 10:56:32 +0200
Subject: [R-sig-ME] Fwd: Question about truncated poisson vs. normal poisson
 "minus one" & Co. in winbugs or glmer
Message-ID: <507D2140.6000004@uke.de>

Ein eingebundener Text mit undefiniertem Zeichensatz wurde abgetrennt.
Name: nicht verf?gbar
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121016/a6cc1c19/attachment.pl>

From highstat at highstat.com  Tue Oct 16 11:28:36 2012
From: highstat at highstat.com (Highland Statistics Ltd)
Date: Tue, 16 Oct 2012 11:28:36 +0200
Subject: [R-sig-ME] Question about truncated poisson vs. normal poisson,
 "minus one" & Co. in winbugs or glmer
In-Reply-To: <mailman.1774.1350377971.4555.r-sig-mixed-models@r-project.org>
References: <mailman.1774.1350377971.4555.r-sig-mixed-models@r-project.org>
Message-ID: <507D28C4.6090608@highstat.com>


------------------------------

Message: 5
Date: Tue, 16 Oct 2012 10:56:32 +0200
From: Ulf K?ther <ukoether at uke.de>
To: <r-sig-mixed-models at r-project.org>
Subject: [R-sig-ME] Fwd: Question about truncated poisson vs. normal
	poisson "minus one" & Co. in winbugs or glmer
Message-ID: <507D2140.6000004 at uke.de>
Content-Type: text/plain

Yesterday I sent this email via the wrong email-adress, so it was not
confirmed. Sorry for the possible double posting!

Original message:

Hello altogether!

I just have one major question and one minor one, which I coudn't solve
for myself yet and I have to admit that both of these are really
becoming really a pain in the neck. I am not a statistician, so I do not
come from a backround where such "normal" problems do get discussed a
lot, accordingly I am a little bit stuck here. Any help would be really
appreciated. And sorry in advance for the long text in the following... :-(

1.) (Major Q.) I want to fit a (bayesian) hurdle poisson model (glmm
with no false zeros possible in this outcome variable) making use of
winbugs or openbugs via two separate models (one binomial, one truncated
poisson),


AFZ: Why not a ZIP? The hurdle model is based on the following question:
What drives presence-absence....and once present..what drives the numbers.
It is a more limited question as the one underlying a ZIP.




but as I can see until now the implementation via openbugs
(which allows truncation, winbugs not - I think?!?) with a truncated
pois-distribution (as coded as RESPONSES[i] ~ dpois(mu[i])T(1,36) )
brings the simluation time to almost something where I feel I am faster
by hand (5134 sec. for 10000 iterations burn in).


AFZ: Try implementation via the zero trick, and see whether it is any better.



  I think that I may do some mistakes regarding the uninformative priors
(maybe to wide?) or the starting values (maybe to far away?) or is the
"T(x,x)"-Coding wrong?



AFZ: That could be a cause. Also crucial is to center or normalize the continuous covariates.


Implementation via winbugs and openbugs just as a
poisson glmm (ignoring the truncation at one) is going fast and reveals
nearly the same estimates as in glmer for a poisson glmm (winbugs-coding
here is nearly the same as in chapter 4 of zuur et al 2012 for a poisson
glmm with one random group-factor).
Problem: Am I going to have a type-I-error-increase because of ignoring
the truncation? Would it be statistical okay to just incorporate the


AFZ: If the majority of the observed values are close to 0, yes.



  response-variable for the poisson-model as (RESPONSES-1), pushing the
whole variable one value lower, or does this implements something like
noise into the mean and sd-estimates or into something else I cannot see
from my "non-statistician"-perspective? Do I overestimate something at
an overall level, because I manually separate the data into "all" with
RESPONSES Zero vs. One and a minor data-set where the "Ones" of the
former data set are fitted as a truncated poisson?
Do I have to aim for the master goal, striktly speaking to aim at the
whole model all in once into one coding, making use of the
zero-ones-trick (an approach which maybe could give the opportunity to
implement a car-structure (time) later on for the whole datat set, too)?
I tried to work out how to set up something like a (literally-speaking)
"hurdle"-model as the one in pscl-package, but also accounting for a
random intercept (glm to glmm-"upgrade"), which is something I could not
find something similar of but gibs-sampling... I consultated zuur 2012,
kery 2010, ntzoufras 2009, neelon 2010 (journal article in "Statistical
Modelling"), gelman 2007 and more, but to summarize, I think many of
these books and many of the things I found on the net or in the mailing
list posts do not think of such an amateur question like mine, so I
didn't found an answer... Could anybody give me a hint? Neelon et al.
seem to incorporate all in once, but they are using a response variable
what I think is a kind of proportion and I didn't find out how to cope
with my own data in such a "coding environment" yet...

2.) (Minor Q.) When I try to implement a predictive check via a
replicated data set in the same model (like proposed by zuur, kery and
ntzoufras), I end up in a winbugs- or openbugs- crash at about 70% of
trials (all stucks at gen.inits)


AFZ: Difficult to comment on without code/details.


and I really think I have to specify
inits myself for the replicates, but firstly I do not find any examples
doing so (or I am blind) and secondly I am very insecure about how to
choose good inits here...anybody a hint for this? maybe it also depends
on how I choose the priors?

Thanks to everyone for any help, I really am a bit exhausted after
reading every bit of paper I could get a grip on in the last month to
learn R, LMMs and GLMMS from the scratch for myself alone, but at the
monent I stuck at these two problems for about two weeks and I do not
know where to look any further.

Kind Regards, Ulf

P.S. Would an implementation into JAGS or STAN be faster than winbugs or
openbugs regarding the slow mixing and simulation time or does this
mainly depends only on my choosen priors and inits?


AFZ: Yes....JAGS is considerable faster. Coding is nearly identical.

Good luck!

Alain Zuur






-- 

________________________________________

Dipl.-Psych. Ulf K?ther

AG Klinische Neuropsychologie
Klinik f?r Psychiatrie und Psychotherapie
Universit?tsklinikum Hamburg-Eppendorf
Martinistr. 52
20246 Hamburg

Tel.: +49 (0) 40 7410 55851
Fax:  +49 (0) 40 7410 57566

ukoether at uke.de <mailto:ukoether at uke.de>
www.uke.de/neuropsych <http://www.uke.de/neuropsych>


From datkins at u.washington.edu  Tue Oct 16 11:44:41 2012
From: datkins at u.washington.edu (David Atkins)
Date: Tue, 16 Oct 2012 11:44:41 +0200
Subject: [R-sig-ME] Question about truncated poisson vs. normal poisson,
 "minus one" & Co. in winbugs or glmer
In-Reply-To: <507D28C4.6090608@highstat.com>
References: <507D28C4.6090608@highstat.com>
Message-ID: <507D2C89.2040709@u.washington.edu>


Ulf--

In addition to Alain's comments, you might consider MCMCglmm -- it can 
fit a Bayesian hurdle mixed model, but uses syntax much closer to 
glmer() and other "standard" R formula-based regression models.

BUGS and cousins will be far more flexible if you need to add something 
"special" to your model (e.g., longitudinal or geographical 
correlation), but from your description, I think you could fit your 
model with MCMCglmm (which should also be much faster than BUGS, I believe).

Jarrod Hadfield (developer of MCMCglmm) has a JSS paper and course notes 
describing functions:

http://cran.r-project.org/web/packages/MCMCglmm/index.html

And, we included R code demonstrating how to fit hurdle mixed models to 
accompany the following paper:

Atkins, D. C., Baldwin, S., Zheng, C., Gallop, R. J., & Neighbors, C. 
(in press). A tutorial on count regression and zero-altered count models 
for longitudinal addictions data.

which can be found:

http://depts.washington.edu/cshrb/newweb/statstutorials.html

Finally, another option could be glmmADMB, which can fit hurdle models 
via its two sub-components: 1) logit mixed model, and 2) truncated count 
mixed model.

Hope that helps.

cheers, Dave

-- 
Dave Atkins, PhD
University of Washington
datkins at u.washington.edu
http://depts.washington.edu/cshrb/

August 1 - October 30:

Universitat Zurich
Psychologisches Institut
Klinische Psychologie
Binzmuhlestrasse 14/23
CH-8050 Zurich

+41 44 635 71 75


From hans.ekbrand at gmail.com  Tue Oct 16 12:11:24 2012
From: hans.ekbrand at gmail.com (Hans Ekbrand)
Date: Tue, 16 Oct 2012 12:11:24 +0200
Subject: [R-sig-ME] extracting fixed effect from lme4 objects (coefplot2 not
	available)
Message-ID: <20121016101124.GC12779@samir>

I have used the function coeftab() from the package coefplot2 for
extracting fixed effects with confidence intervals from lme4 objects.
However, for coefplot is currently not available from r-forge (the
last build, 2012-09-10 failed).

fixef() gives me the estimates, but how do I get the confidence
intervals too?

regards,

Hans Ekbrand


From gavin.simpson at ucl.ac.uk  Tue Oct 16 13:54:19 2012
From: gavin.simpson at ucl.ac.uk (Gavin Simpson)
Date: Tue, 16 Oct 2012 12:54:19 +0100
Subject: [R-sig-ME] Independence of residuals in a computer-based
 experiment/simulation analysed using a LME?
Message-ID: <1350388459.16868.16.camel@prometheus.geog.ucl.ac.uk>

Dear List

I know cross posting to multiple fora is "bad" but I have had little
response to a question I posted on the CrossValidated site yesterday and
I wondered if I might exploit the expertise on this list to solicit an
Answer to my query. CV Question is here (with nicer formatting):
http://stats.stackexchange.com/q/40459/1390

The R-related and Mixed-Model-related bit is that I am doing the all the
analysis in R and am using **lme4** and `lmer()`.

I conducted a computer-based assessment of different methods of fitting
a particular type of model used in the palaeo sciences. I had a
large-ish training set and so I randomly (stratified random sampling)
set aside a test set. I fitted m different methods to the training set
samples and using the m resulting models I predicted the response for
the test set samples and computed a RMSEP over the samples in the test
set. This is a single run.

I then repeated this process a large number of times, each time I chose
a different training set by randomly sampling a new test set.

Having done this I want to investigate if all methods have effectively
the same error performance and whether any of the m methods has better
or worse RMSEP performance via multiple pair-wise comparisons.

My approach has been to fit a linear mixed effects (LME) model, with a
single random effect for Run. I used lmer() from the lme4 package to fit
my model and functions from the multcomp package to perform the multiple
comparisons. My model was essentially

lmer(RMSEP ~ method + (1 | Run), data = FOO)

where method is a factor indicating which method was used to generate
the model predictions for the test set and Run is an indicator for each
particular Run of my "experiment". I used Tukey contrasts or coding from
the multcomp package to do the multiple comparisons.

My question is in regard to the residuals of the LME. Given the single
random effect for Run the model assumes that the RMSEP (response) values
(and hence residuals) for that run are correlated to some degree but are
uncorrelated between runs, on the basis of the induced correlation that
the random effect affords.

Is this assumption of independence between runs valid? If not is there a
way to account for this in the LME model or should I be looking to
employ another type of statical analysis to answer my question?

TIA

Gavin
-- 
%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%
 Dr. Gavin Simpson             [t] +44 (0)20 7679 0522
 ECRC, UCL Geography,          [f] +44 (0)20 7679 0565
 Pearson Building,             [e] gavin.simpsonATNOSPAMucl.ac.uk
 Gower Street, London          [w] http://www.ucl.ac.uk/~ucfagls/
 UK. WC1E 6BT.                 [w] http://www.freshwaters.org.uk
%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%


From gavin.simpson at ucl.ac.uk  Tue Oct 16 14:49:45 2012
From: gavin.simpson at ucl.ac.uk (Gavin Simpson)
Date: Tue, 16 Oct 2012 13:49:45 +0100
Subject: [R-sig-ME] GLMM with mgcv::gam
In-Reply-To: <503B4B13.9030307@tum.de>
References: <503B45DA.5050508@web.de> <503B4B13.9030307@tum.de>
Message-ID: <1350391785.16868.30.camel@prometheus.geog.ucl.ac.uk>

Apologies for the late response. see in-line.

On Mon, 2012-08-27 at 12:25 +0200, Andreas B?ck wrote:
> Dear Mixed-Model Experts,
> 
> my question is about the mgcv::gam function in a recent version (version
> 1.7-19 or 1.7-20).
> 
> Is it true, that gam(y ~ x1+ s(id, bs="re"), method ="REML",
> family=binomial) does the following:
> - setup the model
> - call MASS::glmmPQL where
>     glmmPQL somehow iterates between nlme::lme and glm.fit calls
> - make the results look like a gam object

No. Only `gamm()` in the mgcv package would do what you suggest. The
"re" basis derives from the linear mixed effect representation of the
penalised regression model that underlies the mgcv version of a GAM.
IIRC essentially the penalties on the smooth functions can be
represented as random effects in a LME. Simon's new "re" basis is
essentially exploiting this feature, again IIRC, by setting up a spline
basis that would produce a simple random effect when viewed from the LME
formulation of the model. (I speculate that this means that the "re"
basis is solely represented as a random effect, the other basis
functions in mgcv would be split into both fixed and random effects in
the LME representation).

> The method="REML" argument affects only the lme part in the fitting
> procedure ?

Nope, although it is related. The penalised regression underlying the
gam() can be fitted via ML or REML (amongst other methods). As the
penalties on the splines can be viewed as random effects, REML fitting
might be expected to get the best estimation of their variance. From
what I recall of Simon's papers, there is little to choose between ML
and REML fitting in terms of performance on simulated data exercises,
though REML may have the edge. This was not looked at in terms of "re"
basis smooths however, but in terms of more general s() smooths.

> If the above is true, is it prefarable to use glmer(y~x1 + (1|id),
> family="binomial") or gamm4, as the approach in the lme4 package is more
> reliable as the penalized-quasi-likelihood approach in package MASS,
> especially for binomial families?

If your problem involves a simple random effect then I don't think there
will be any major differences between the various approaches (other than
gamm() using glmmPQL() which you might want to avoid). You won't be able
to use glmer() with the same s() functions used in your gam() can't be
included in the glmer() formula. gamm4 does allow the s() from gam() to
be included (or most of them) so your options are gam() with a "re"
basis or gamm4 (which iterates gam() and glmer() IIRC). Do
read ?smooth.construct.re.smooth.spec from package mgcv which describes
where you might choose gamm4 over the "re" basis terms (essentially for
big problems with large numbers of random effects, the "re" basis in
gam() won't be as efficient as gamm4 because it doesn't exploit the
sparseness of the random effect structure).

HTH

G

> Thank you very much for clarification !
> 
> Best,
> Andi B?ck
> (PhD candidate, Munich)
> 
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> 

-- 
%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%
 Dr. Gavin Simpson             [t] +44 (0)20 7679 0522
 ECRC, UCL Geography,          [f] +44 (0)20 7679 0565
 Pearson Building,             [e] gavin.simpsonATNOSPAMucl.ac.uk
 Gower Street, London          [w] http://www.ucl.ac.uk/~ucfagls/
 UK. WC1E 6BT.                 [w] http://www.freshwaters.org.uk
%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%


From bbolker at gmail.com  Tue Oct 16 15:46:50 2012
From: bbolker at gmail.com (Ben Bolker)
Date: Tue, 16 Oct 2012 13:46:50 +0000 (UTC)
Subject: [R-sig-ME]
	=?utf-8?q?extracting_fixed_effect_from_lme4_objects_?=
	=?utf-8?q?=28coefplot2_not=09available=29?=
References: <20121016101124.GC12779@samir>
Message-ID: <loom.20121016T150249-646@post.gmane.org>

Hans Ekbrand <hans.ekbrand at ...> writes:

> 
> I have used the function coeftab() from the package coefplot2 for
> extracting fixed effects with confidence intervals from lme4 objects.
> However, for coefplot is currently not available from r-forge (the
> last build, 2012-09-10 failed).
> 
> fixef() gives me the estimates, but how do I get the confidence
> intervals too?

   Something like

transform(as.data.frame(coef(summary(fm1))),
     lwr=Estimate-1.96*`Std. Error`,upr=Estimate+1.96*`Std. Error`)

should work (these are the same confidence intervals as those
returned by coeftab).

  Thanks for calling my attention to the fact that coefplot2 was
broken on r-forge (due to recent changes in ggplot2).  A fixed version
is up and should be available shortly.

  Ben Bolker


From u.koether at uke.de  Tue Oct 16 02:14:30 2012
From: u.koether at uke.de (Koether, Ulf)
Date: Tue, 16 Oct 2012 00:14:30 +0000
Subject: [R-sig-ME] Question about truncated poisson vs. normal poisson
 "minus one" & Co. in winbugs or glmer
Message-ID: <FE8FC62EAFE1A5418BE867ACA0A9B31C1E84DED5@EXCMBX-2.mail.uke.ads>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121016/d64c434b/attachment.pl>

From Boris.Hejblum at isped.u-bordeaux2.fr  Tue Oct 16 19:39:36 2012
From: Boris.Hejblum at isped.u-bordeaux2.fr (Boris Hejblum)
Date: Tue, 16 Oct 2012 19:39:36 +0200
Subject: [R-sig-ME] lmer convergence parameters
Message-ID: <507D9BD8.6080808@isped.u-bordeaux2.fr>

Dear all,

Using the lmer function, I was not able to find a way to modify the 
convergence thresholds (used in optimization), with a 'tolerance' 
argument for instance. I expected it to be handled via the 'control' 
argument, but it does not appear like it. Is there a way to do so?

Thanks for your help,
Boris Hejblum


From jmmartelo at fc.ul.pt  Tue Oct 16 20:28:34 2012
From: jmmartelo at fc.ul.pt (joana martelo)
Date: Tue, 16 Oct 2012 19:28:34 +0100
Subject: [R-sig-ME] error in lmer: length(f1) == length(f2) is not TRUE
Message-ID: <006c01cdabcc$0e338d30$2a9aa790$@ul.pt>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121016/64393e76/attachment.pl>

From roby.joehanes at nih.gov  Tue Oct 16 20:57:38 2012
From: roby.joehanes at nih.gov (Joehanes, Roby (NIH/NHLBI) [F])
Date: Tue, 16 Oct 2012 14:57:38 -0400
Subject: [R-sig-ME] error in lmer: length(f1) == length(f2) is not TRUE
In-Reply-To: <006c01cdabcc$0e338d30$2a9aa790$@ul.pt>
Message-ID: <CCA32662.3CC8%joehanesr@mail.nih.gov>

Hi Joana,

Most likely, the problem is: length(trial) != length(reactive.dist).

Hope this helps,
Roby

On 10/16/12 2:28 PM, "joana martelo" <jmmartelo at fc.ul.pt> wrote:
> Dear list
> 
>  
> 
> I'm trying to model fish data with a gaussian distribution for prey reactive
> distance obtained in lab experiments. Each experimental trial consisted of
> giving 1 prey to fish every x min., for a total of 20 prey, and measuring
> the reactive distance of fish to the prey. My explanatory variables are
> current velocity (0, 8, 12, 26 cm/s), fish size (small, medium and large),
> density (2, 4 and 6 fish), trial and fish.id, and I did 3 replicates of each
> trial, using each fish only once. Because not all fish reacted to the prey,
> the number of reactive distances is not the same for each fish, and hence
> not the same for each trial. I wonder whether with this experimental design
> I can consider fish.ID and trial as random effects and treat the other
> variables as fixed effects.
> 
>  
> 
> I?m using lme4 and tried:
> 
>  
> 
> model<-lmer(reactive.dist~velocity+density+(1|trial/fish.id),family=gaussian
> )
> 
>  
> 
> but got this error and warning:
> 
>  
> 
> Error: length(f1) == length(f2) is not TRUE
> 
> In addition: Warning messages:
> 
> 1: In fish.id:trial :
> 
>   numerical expression has 2518 elements: only the first used
> 
> 2: In fish.id:trial :
> 
>   numerical expression has 2518 elements: only the first used
> 
>  
> 
> Is this because I don?t have the same number of reactive distances per fish?
> 
> 
>  
> 
> When I do:
> 
> model<-lmer(reactive.dist~velocity+density(1|fish.id),family=gaussian)
> 
> it works fine??.
> 
> Any suggestions would be greatly appreciated!
> 
> The best
> 
> Joana
> 
>  
> 
> Joana Martelo, PhD Student
> 
> Centro de Biologia Ambiental
> 
> Departamento de Biologia Animal
> 
> Faculdade de Ci?ncias, Edificio C2,5?Piso,Sala 2.5.15B
> 
> 1749-016 Lisboa, Portugal
> 
> http://ffishgul.fc.ul.pt
> 
>  
> 
>  
> 


From bbolker at gmail.com  Wed Oct 17 00:16:23 2012
From: bbolker at gmail.com (Ben Bolker)
Date: Tue, 16 Oct 2012 22:16:23 +0000 (UTC)
Subject: [R-sig-ME] error in lmer: length(f1) == length(f2) is not TRUE
References: <006c01cdabcc$0e338d30$2a9aa790$@ul.pt>
Message-ID: <loom.20121017T001458-513@post.gmane.org>

joana martelo <jmmartelo at ...> writes:

> 
> Dear list
> 
  
 [snip]

> 
> I?m using lme4 and tried:
> model<-lmer(reactive.dist~velocity+density+(1|trial/fish.id),family=gaussian
> )
> but got this error and warning:
> Error: length(f1) == length(f2) is not TRUE
> In addition: Warning messages:
> 1: In fish.id:trial :
>   numerical expression has 2518 elements: only the first used
> 2: In fish.id:trial :
>  numerical expression has 2518 elements: only the first used
> Is this because I don?t have the same number of reactive distances per fish?

> When I do:
> 
> model<-lmer(reactive.dist~velocity+density(1|fish.id),family=gaussian)
> 
> it works fine

.

  If you search for this error at http://glmm.wikidot.com/faq
I think you'll get the hint that you're using a numeric variable
as a grouping factor -- in this case I believe trial is numeric
and should be converted to a factor.

  Ben Bolker


From shyunuw at gmail.com  Wed Oct 17 03:08:37 2012
From: shyunuw at gmail.com (Saang-Yoon Hyun)
Date: Tue, 16 Oct 2012 21:08:37 -0400
Subject: [R-sig-ME] degrees of freedom for a mixed effect model
Message-ID: <CAFh292O6pbi0ObkDAfW=b5myOAbm1ifw=zoR6KLxX2rr966i+Q@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121016/2eb1d00f/attachment.pl>

From jmmartelo at fc.ul.pt  Wed Oct 17 17:18:55 2012
From: jmmartelo at fc.ul.pt (joana martelo)
Date: Wed, 17 Oct 2012 16:18:55 +0100
Subject: [R-sig-ME] error in lmer: length(f1) == length(f2) is not TRUE
In-Reply-To: <loom.20121017T001458-513@post.gmane.org>
References: <006c01cdabcc$0e338d30$2a9aa790$@ul.pt>
	<loom.20121017T001458-513@post.gmane.org>
Message-ID: <001b01cdac7a$ba238510$2e6a8f30$@ul.pt>

Thanks for your answers, but it still doesn't work. 
Trial and fish.id are factors, but I get the same error:

> Error: length(f1) == length(f2) is not TRUE In addition: Warning 
> messages:
> 1: In fish.id:trial :
>   numerical expression has 2518 elements: only the first used
> 2: In fish.id:trial :
>  numerical expression has 2518 elements: only the first used


I've tried to find the answer in other mailing lists, but they all give the same answer....

Any ideas of what the mistake might be?

Cheers
Joana



-----Mensagem original-----
De: r-sig-mixed-models-bounces at r-project.org [mailto:r-sig-mixed-models-bounces at r-project.org] Em nome de Ben Bolker
Enviada: ter?a-feira, 16 de Outubro de 2012 23:16
Para: r-sig-mixed-models at r-project.org
Assunto: Re: [R-sig-ME] error in lmer: length(f1) == length(f2) is not TRUE

joana martelo <jmmartelo at ...> writes:

> 
> Dear list
> 
  
 [snip]

> 
> I?m using lme4 and tried:
> model<-lmer(reactive.dist~velocity+density+(1|trial/fish.id),family=ga
> ussian
> )
> but got this error and warning:
> Error: length(f1) == length(f2) is not TRUE In addition: Warning 
> messages:
> 1: In fish.id:trial :
>   numerical expression has 2518 elements: only the first used
> 2: In fish.id:trial :
>  numerical expression has 2518 elements: only the first used Is this 
> because I don?t have the same number of reactive distances per fish?

> When I do:
> 
> model<-lmer(reactive.dist~velocity+density(1|fish.id),family=gaussian)
> 
> it works fine??.

  If you search for this error at http://glmm.wikidot.com/faq I think you'll get the hint that you're using a numeric variable as a grouping factor -- in this case I believe trial is numeric and should be converted to a factor.

  Ben Bolker

_______________________________________________
R-sig-mixed-models at r-project.org mailing list https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models

-----
N?o foram detectados v?rus nesta  mensagem.
Verificado por AVG - www.avg.com
Vers?o: 2012.0.2221 / Base de dados de V?rus: 2441/5336 - Data de Lan?amento: 10/16/12


From ims203 at exeter.ac.uk  Wed Oct 17 17:37:29 2012
From: ims203 at exeter.ac.uk (Stott, Iain)
Date: Wed, 17 Oct 2012 15:37:29 +0000
Subject: [R-sig-ME] MCMCglmm: correctly estimating phylogenetic
 heritability
In-Reply-To: <20121003120732.13472l1h9jfwqc8w@www.staffmail.ed.ac.uk>
References: <B964ED738030624680E9A6D3182E934F049836@VMEXCHANGEMBS5A.isad.isadroot.ex.ac.uk>,
	<20121003120732.13472l1h9jfwqc8w@www.staffmail.ed.ac.uk>
Message-ID: <B964ED738030624680E9A6D3182E934F050E81@VMEXCHANGEMBS5A.isad.isadroot.ex.ac.uk>

Hi Jarrod,

Thanks for your help! I've gone with your suggestion and included the residual variance in the denominator: multiple observations per species/population combination are probably more closely associated with temporal changes in the environment so I'm more comfortable to interpret it as biological variation.

Heritability turns out to be vanishingly small. Could the DIC result be attributed partly to a skewness in the posterior for phylogeny ('animal')? Variance is small and the mean is estimated to be larger than the mode. The heritability postierior is also skewed and modal heritability is also smaller than the mean. We weren't expecting to see phylogenetic signal, so the heritability estimate helps explain the DIC result.

Do you have any ideas as to why (or how) phylogeny increases credible intervals on the mean? We've been bugged by the interpretation of this for ages.

Iain



- - - - - - - - - - - -
Dr. Iain Stott
Centre for Ecology and Conservation
University of Exeter, Cornwall Campus
Tremough, Treliever Road
Penryn, Cornwall, TR10 9EZ, UK.
Tel (office): 01326 371852
http://biosciences.exeter.ac.uk/staff/postgradresearch/iainstott/
- - - - - - - - - - - -

________________________________________
From: Jarrod Hadfield [j.hadfield at ed.ac.uk]
Sent: 03 October 2012 12:07
To: Stott, Iain
Cc: r-sig-mixed-models at r-project.org
Subject: Re: [R-sig-ME] MCMCglmm: correctly estimating phylogenetic heritability

Hi Iain,

var(phylo)/(var(phylo)+var(residual)+var(random effects)) ?

is probably what you want to use. Presumably, you have multiple
observations per species/population combination. In this case may want
to interpret the residual variance as measurement error variance and
exclude it from the denominator. Alternatively, you may interpret it
as biological variation and include it. It depends on how you chose to
interpret the residual variance and what you want the phylogentic
heritability to refer to.  Note, that the fixed effects are also
'removing' variance which may be phylogentic or not depending on the
phylogenetic distribution of the predictors.

Cheers,

Jarrod


Quoting "Stott, Iain" <ims203 at exeter.ac.uk> on Fri, 28 Sep 2012
15:31:49 +0000:

> Dear all,
>
> I am working with MCMCglmm models that include a phylogenetic
> component. The aim of the study is to estimate the influence of
> phylogeny on certain aspects of demography in plant populations.
>
> The models are constructed as follows:
> Univariate response
> One fixed factor (categorical, four levels)
> Two nested random grouping factors (Population nested within Species)
> Phylogenetic scaling of random effects (using a 'phylo' object and
> the 'animal' argument)
> Default uninformative priors for fixed effects (mu=0, sigma^2=10^10)
> Uninformative priors for random effects and residuals (V=1, nu=0.001)
> Parameter expansion for random effects priors (I had some problems
> with chains sticking at 0)
>
> DIC from models with phylogeny vs. without phylogeny are very
> similar, hence there are two separate sets of rival models. The only
> discernable effect that phylogeny has is to increase the credible
> intervals on the fixed effect posteriors.
>
> Estimating a heritability factor (i.e. something akin to Pagel's
> lambda) could clear up how important phylogeny actually is. Hadfield
> & Nakagawa (2010) in J. Evol. Biol. state that this can be found
> using:
>
> var(phylo)/(var(phylo)+var(residual)) .
>
> Fitted variance for phylogeny is very small compared to species,
> population and residuals which could explain some of the strange
> results we're getting: phylogeny may be statistically important, but
> have a very small effect. BUT, the variance attributed to phylogeny
> seems to be partitioned primarily into Species in non-phylogenetic
> models (which makes sense). SO, is the above correct or should we
> actually be using something like:
>
> var(phylo)/(var(phylo)+var(residual)+var(random effects)) ?
>
>
> Hope someone can shed some light,
>
> Iain
>
>
>
> - - - - - - - - - - - -
> Dr. Iain Stott
> Centre for Ecology and Conservation
> University of Exeter, Cornwall Campus
> Tremough, Treliever Road
> Penryn, Cornwall, TR10 9EZ, UK.
> Tel (office): 01326 371852
> http://biosciences.exeter.ac.uk/staff/postgradresearch/iainstott/
> - - - - - - - - - - - -
>
>
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>
>



--
The University of Edinburgh is a charitable body, registered in
Scotland, with registration number SC005336.




From bbolker at gmail.com  Wed Oct 17 20:02:41 2012
From: bbolker at gmail.com (Ben Bolker)
Date: Wed, 17 Oct 2012 18:02:41 +0000 (UTC)
Subject: [R-sig-ME] error in lmer: length(f1) == length(f2) is not TRUE
References: <006c01cdabcc$0e338d30$2a9aa790$@ul.pt>
	<loom.20121017T001458-513@post.gmane.org>
	<001b01cdac7a$ba238510$2e6a8f30$@ul.pt>
Message-ID: <loom.20121017T195721-914@post.gmane.org>

joana martelo <jmmartelo at ...> writes:

> 
> Thanks for your answers, but it still doesn't work. 
> Trial and fish.id are factors, but I get the same error:
> 
> > Error: length(f1) == length(f2) is not TRUE In addition: Warning 
> > messages:
> > 1: In fish.id:trial :
> >   numerical expression has 2518 elements: only the first used
> > 2: In fish.id:trial :
> >  numerical expression has 2518 elements: only the first used
> 
> I've tried to find the answer in other mailing lists, but they all give the
same answer....
> 
> Any ideas of what the mistake might be?
> 

  Not sure, but I strongly recommend that you put your response
variable along with all of your predictor variables into a data frame
together and use the data= argument to glmer().  It's extremely easy
to have a modified version of one of the predictors floating around
in the workspace.  It's also possible (although I think this would
technically constitute a bug in lmer ...) that this is caused by NAs
somewhere in the dataset, although I couldn't provoke it with this
sample:

d <- data.frame(y=rnorm(200),f1=sample(LETTERS[1:5],200,replace=TRUE),
    f2=sample(letters[1:5],200,replace=TRUE))
d$f2[100] <- NA
lmer(y~1+(1|f1/f2),data=d)

  If putting your variables into a data frame and using na.omit()
on it don't make the problem go away, then we'll need a reproducible
example to get any farther ...


From bbolker at gmail.com  Wed Oct 17 20:25:15 2012
From: bbolker at gmail.com (Ben Bolker)
Date: Wed, 17 Oct 2012 18:25:15 +0000 (UTC)
Subject: [R-sig-ME] lmer and truncated gaussian distributions
References: <CAOE0pYnRO5OoG9ZqoorLJnBNeBzvTcXWObW972-j31W_Wg++6w@mail.gmail.com>
Message-ID: <loom.20121017T202027-899@post.gmane.org>

Dan McCloy <drmccloy at ...> writes:

> 
> Hello folks,
> Is it ok to use lmer() when the distribution of the response data resembles
> a truncated gaussian?  I have data where the response variable is
> constrained in [0,15] but has a mean of 12.63 and a S.D. of 2.25, based on
> 130 observations.  Graphs of dnorm() look symmetrical near the mean and
> log-transformation doesn't help; thus I think the data is best treated as
> truncated rather than skewed.


  (1) is your marginal distribution truncated normal or is it the
distribution of residuals that is truncated normal?  The latter is what
matters more ...

  (2) as a very vague general point, mild non-normality doesn't matter
as much as people seem to think it does.  It's very hard to say
whether "it's OK" in a particular case -- it depends how much accuracy
you need, how hard you are willing to work on alternatives, etc. etc.
(either JAGS/WinBUGS or AD Model Builder could handle this case, I
think).  The only way I can think of to know for sure would be to run
simulations of similar cases to see how much it matters, and decide
whether the size of the attendant error (bias, change in type I error
away from nominal, etc.)  is acceptable in your application.  Or you
may be able to bootstrap (but you have to be careful to preserve
the dependence structure, e.g. bootstrapping by groups (and
maybe individuals within groups rather than by individuals).


From jmmartelo at fc.ul.pt  Wed Oct 17 20:26:37 2012
From: jmmartelo at fc.ul.pt (joana martelo)
Date: Wed, 17 Oct 2012 19:26:37 +0100
Subject: [R-sig-ME] error in lmer: length(f1) == length(f2) is not TRUE
In-Reply-To: <loom.20121017T195721-914@post.gmane.org>
References: <006c01cdabcc$0e338d30$2a9aa790$@ul.pt>	<loom.20121017T001458-513@post.gmane.org>	<001b01cdac7a$ba238510$2e6a8f30$@ul.pt>
	<loom.20121017T195721-914@post.gmane.org>
Message-ID: <001f01cdac95$007e8a90$017b9fb0$@ul.pt>

I've changed the code of my factor levels to trial: A,B,C...... and fish.id:
A1,A2....B1,B2....., and used data=.... and it worked!

Thank you so much Ben!
Joana

-----Mensagem original-----
De: r-sig-mixed-models-bounces at r-project.org
[mailto:r-sig-mixed-models-bounces at r-project.org] Em nome de Ben Bolker
Enviada: quarta-feira, 17 de Outubro de 2012 19:03
Para: r-sig-mixed-models at r-project.org
Assunto: Re: [R-sig-ME] error in lmer: length(f1) == length(f2) is not TRUE

joana martelo <jmmartelo at ...> writes:

> 
> Thanks for your answers, but it still doesn't work. 
> Trial and fish.id are factors, but I get the same error:
> 
> > Error: length(f1) == length(f2) is not TRUE In addition: Warning
> > messages:
> > 1: In fish.id:trial :
> >   numerical expression has 2518 elements: only the first used
> > 2: In fish.id:trial :
> >  numerical expression has 2518 elements: only the first used
> 
> I've tried to find the answer in other mailing lists, but they all 
> give the
same answer....
> 
> Any ideas of what the mistake might be?
> 

  Not sure, but I strongly recommend that you put your response variable
along with all of your predictor variables into a data frame together and
use the data= argument to glmer().  It's extremely easy to have a modified
version of one of the predictors floating around in the workspace.  It's
also possible (although I think this would technically constitute a bug in
lmer ...) that this is caused by NAs somewhere in the dataset, although I
couldn't provoke it with this
sample:

d <- data.frame(y=rnorm(200),f1=sample(LETTERS[1:5],200,replace=TRUE),
    f2=sample(letters[1:5],200,replace=TRUE))
d$f2[100] <- NA
lmer(y~1+(1|f1/f2),data=d)

  If putting your variables into a data frame and using na.omit() on it
don't make the problem go away, then we'll need a reproducible example to
get any farther ...

_______________________________________________
R-sig-mixed-models at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models

-----
N?o foram detectados v?rus nesta  mensagem.
Verificado por AVG - www.avg.com
Vers?o: 2012.0.2221 / Base de dados de V?rus: 2441/5336 - Data de
Lan?amento: 10/16/12


From chantepie at mnhn.fr  Thu Oct 18 11:23:00 2012
From: chantepie at mnhn.fr (chantepie at mnhn.fr)
Date: Thu, 18 Oct 2012 11:23:00 +0200
Subject: [R-sig-ME] How to estimate assess significance of variance
	components
Message-ID: <20121018112300.17551qzre7ik5lys@dsiwebmail.mnhn.fr>


Dear all,

My question could appear trivial but I still have do not still have  
found a clear answer.

BasicallyFrom what I gathered, the Bayesian framework gives us two  
possible tools to estimate significance of variances, the DIC and  
Confidence Interval (CI) estimates

DIC allows to compare models and test for significance of variances.  
XXX Some papers mention that this approach is valid for all the  
exponential family distribution models, to the extent that it should  
even allow to test which distribution fits better the data. However,  
in a previous post Jarrod mentioned that DIC does not always answer  
the hypothesis we want to test and finished by saying that for non  
gaussian distribution, he?d never use DIC. And actually, The problem  
here is that when running some animal models with Poisson distribution  
I encountered strange results suggesting ,that DIC does not work at  
all. The lower CI of Va estimates are clearly greater than 0 which let  
me think that Va is different from 0 but DIC does not give substantial  
support for models with Va
On my view,I understand that assessing confidence interval is the  
great advantage of Bayesian models. But   as Variance variances range  
between [0:1], it is not possible to construct a Pvalue by counting  
the proportion of estimate below 0 (as we could do on with covariances  
ranged between [-1:1]). When the lower CI of a variance are is far  
from 0, it is quite easy to be sure that this variance is different  
from 0 but when the posterior modes are small and lower CI are close  
to 0, how we could can we decide? One approach could be to check  
whether the posterior mode is ncelywell defined or whether it  
?collapses? on zero but would that be enough?

So I am aware that Bayesian statistics are not frequentist statistics  
and statistical tools are different but in the context of scientist  
publication (reviewers who not always know Bayesian frameworknot  
appreciating no p values), a clear decision rule would be  
neededhelpful.  the possibility of having clear decision rules appear  
almost necessary.

It would be most helpful to know your thoughts about this and May  
someone have already thought about this issue and the decision rules  
they choosewhether there are other decision rules that could be  
applied..

Thanks to all


From chantepie at mnhn.fr  Thu Oct 18 11:52:19 2012
From: chantepie at mnhn.fr (chantepie at mnhn.fr)
Date: Thu, 18 Oct 2012 11:52:19 +0200
Subject: [R-sig-ME] How to assess significance of variance components
 (Please discard previous e mail... but read this one)
Message-ID: <20121018115219.60162drikv668spf@dsiwebmail.mnhn.fr>

Dear all,

My question could appear trivial but I still have not found a clear answer.

 From what I gathered, the Bayesian framework gives us two possible  
tools to estimate significance of variances, the DIC and Confidence  
Interval (CI) estimates

DIC allows to compare models and test for significance of variances.  
Some papers mention that this approach is valid for all the  
exponential family distribution models, to the extent that it should  
even allow to test which distribution fits better the data. However,  
in a previous post Jarrod mentioned that DIC does not always answer  
the hypothesis we want to test and finished by saying that for non  
gaussian distribution, he?d never use DIC. And actually, when running  
some animal models with Poisson distribution I encountered strange  
results suggesting that DIC does not work at all. The lower CI of Va  
estimates are clearly greater than 0 which let me think that Va is  
different from 0 but DIC does not give substantial support for models  
with Va
I understand that assessing confidence interval is the great advantage  
of Bayesian models. But as variances range between [0:1], it is not  
possible to construct a Pvalue by counting the proportion of estimate  
below 0 (as we could do with covariances). When the lower CI of a  
variance is far from 0, it is quite easy to be sure that this variance  
is different from 0 but when the posterior modes are small and lower  
CI are close to 0, how can we decide? One approach could be to check  
whether the posterior mode is well defined or whether it ?collapses?  
on zero but would that be enough?


I am aware that Bayesian statistics are not frequentist statistics and  
statistical tools are different but, a clear decision rule would be  
helpful.

It would be most helpful to know your thoughts about this and whether  
there are other decision rules that could be applied.

Thanks to all

Stephane


From 538280 at gmail.com  Thu Oct 18 19:02:01 2012
From: 538280 at gmail.com (Greg Snow)
Date: Thu, 18 Oct 2012 11:02:01 -0600
Subject: [R-sig-ME] How to assess significance of variance components
 (Please discard previous e mail... but read this one)
In-Reply-To: <20121018115219.60162drikv668spf@dsiwebmail.mnhn.fr>
References: <20121018115219.60162drikv668spf@dsiwebmail.mnhn.fr>
Message-ID: <CAFEqCdzgcrmNSR2qtj_4erY_n99GTU3ymcJ=8kmSkzJjvhkq8Q@mail.gmail.com>

First you should ask if you really need to test the variance
component.  sometimes we get in the rut of feeling that we need to
test everything, but if knowledge of the science suggested that you
include a random effect then that is probably more important than a
test and it should be left in.  Even if the variance component is
small it does not hurt to leave it in.

If the test on the variance component is still of interest then there
are a couple of options:

The ideal, theoretical option using Bayesian statistics is to use a
prior on the variance component with a point mass at 0, then the
posterior would also have a point mass at 0 and you could see how much
of the probability is there to decide (and confidence intervals may
then include or exclude 0 accordingly).  However, this is difficult on
a practical level since I don't know of any of the tools that make
Bayesian stats easy to do that are capable of dealing with priors
including a point mass.  You can do it by hand for simple problems,
but probably not for a mixed model approach.  A similar alternative is
to decide on a value greater than 0 that would still be considered
"practically" 0, i.e. any value of the variance component less than
that value will be considered to be 0.  Then you can create a prior
distribution that puts a fair amount of probability in the range from
0 to your bound (probably a mixture of 2 distributions), then if the
posterior CI is entirely below your bound you can treat the component
as having a value of 0, and this type of prior can be coded into
Bayesian tools.

A frequentist option would be to use a permutation test.  Under the
null hypothesis that the variance component is 0 the grouping for that
random effect is random rather than meaningful, so just permute the
group memberships and refit the model a bunch of times and see what
the distribution of the variance component is.  Then compare the
original variance component to this distribution.  Exactly how to do
the permutations will depend on the structure of the data and the
model being fit.  I think that I would prefer this method.

It might be fun to try and find a way to combine the Bayesian with the
permutation test, though there are probably people in both camps that
would call it heresy.


On Thu, Oct 18, 2012 at 3:52 AM,  <chantepie at mnhn.fr> wrote:
> Dear all,
>
> My question could appear trivial but I still have not found a clear answer.
>
> From what I gathered, the Bayesian framework gives us two possible tools to
> estimate significance of variances, the DIC and Confidence Interval (CI)
> estimates
>
> DIC allows to compare models and test for significance of variances. Some
> papers mention that this approach is valid for all the exponential family
> distribution models, to the extent that it should even allow to test which
> distribution fits better the data. However, in a previous post Jarrod
> mentioned that DIC does not always answer the hypothesis we want to test and
> finished by saying that for non gaussian distribution, he?d never use DIC.
> And actually, when running some animal models with Poisson distribution I
> encountered strange results suggesting that DIC does not work at all. The
> lower CI of Va estimates are clearly greater than 0 which let me think that
> Va is different from 0 but DIC does not give substantial support for models
> with Va
> I understand that assessing confidence interval is the great advantage of
> Bayesian models. But as variances range between [0:1], it is not possible to
> construct a Pvalue by counting the proportion of estimate below 0 (as we
> could do with covariances). When the lower CI of a variance is far from 0,
> it is quite easy to be sure that this variance is different from 0 but when
> the posterior modes are small and lower CI are close to 0, how can we
> decide? One approach could be to check whether the posterior mode is well
> defined or whether it ?collapses? on zero but would that be enough?
>
>
> I am aware that Bayesian statistics are not frequentist statistics and
> statistical tools are different but, a clear decision rule would be helpful.
>
> It would be most helpful to know your thoughts about this and whether there
> are other decision rules that could be applied.
>
> Thanks to all
>
> Stephane
>
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models



-- 
Gregory (Greg) L. Snow Ph.D.
538280 at gmail.com


From agus.camacho at gmail.com  Thu Oct 18 22:25:54 2012
From: agus.camacho at gmail.com (Agus Camacho)
Date: Thu, 18 Oct 2012 17:25:54 -0300
Subject: [R-sig-ME] model selection with ordered probit of three categories
Message-ID: <CALsJ7pTsoUwE_Z7F6mtjDXc7HCrATLaYk0Br4KGPOzKHKaWaDg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121018/7b4690c6/attachment.pl>

From pseudotelphusa at gmail.com  Thu Oct 18 22:32:31 2012
From: pseudotelphusa at gmail.com (George Wang)
Date: Thu, 18 Oct 2012 16:32:31 -0400
Subject: [R-sig-ME] modeling with hierarchical data
In-Reply-To: <1350485890.5642.YahooMailNeo@web142302.mail.bf1.yahoo.com>
References: <1350485890.5642.YahooMailNeo@web142302.mail.bf1.yahoo.com>
Message-ID: <CAGNXmpOfwVF8R55-GrsbVdmcmL+AfB=Q-Xq2Cy-Wn3uemZ4Leg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121018/cc1b7315/attachment.pl>

From seth at swbigelow.net  Sat Oct 20 17:01:11 2012
From: seth at swbigelow.net (Seth W. Bigelow)
Date: Sat, 20 Oct 2012 11:01:11 -0400
Subject: [R-sig-ME] Mixed model and negative binomial distribution
Message-ID: <000601cdaed3$bf7f5ce0$3e7e16a0$@net>

Dear list: this is a continuation of a previous question. To recap,after
input from several listserv members, I have been using glmmADMB to model
snag (dead tree) densities before, after, and 5 years after forest (factor
variable 'time'). (I apologize for disregarding the advice to use 'BUGS'
approaches -- I didn't have $ for new books or time for assimilation of new
paradigm). The data sampling was stratified by 'Ecozone' ('East' densities
are much lower than 'West'). Because there are many plots with no snags, I
evaluated use of Poisson vs. Negative binomial distribution by finding mean
& variance for each combination of time & Ecozone. AIC for the NB
distribution was vastly smaller (more favorable) than for the Poisson.
Variance tended to be much higher prior to treatment (because a few plots
have large numbers of snags and loggers are instructed to knock most of
these down and simply retain a few).

My statement is glmmadmb(snag~time+Ecozone + (1|SettingID), data=.,
family="nbinom1"). ('SettingID' is a plot identifier).

So, I have these observations/questions. First, when I experiment with
'family="poisson", AIC for the glmm is only 2 AIC units greater than for the
negative binomial model, yet with AIC estimated for individual cells, AIC
Poisson >> AIC NegBinom. Any idea why this might be? (I've tried
zero-inflation for poisson & NB, doesn't seem to make much difference)

It's tricky to interpret the log-transformed coefficients and associated
confidence intervals, but they don't seem to reflect the decrease in snags
after treatment that I see when I examine the cell means (e.g., mean East
density at time1 (pre-treatment) is 1.7, dropping to 0.7 at time2 (after
treatment).) Here's part of the summary statement:

Coefficients:
            Estimate Std. Error z value Pr(>|z|)   
(Intercept)     -0.764      0.359   -2.13   0.0334 * 
time2             -0.588    0.186   -3.16   0.0016 **
time3            -0.604     0.189   -3.20   0.0014 **
EcozoneW     1.249          0.487    2.57   0.0103 * 

>> exp(coef(.))
(Intercept)       time2       time3    EcozoneW 
      0.466       0.555       0.547       3.488

I have tried the full-interaction model ("time*Ecozone"), although it is not
justified from the standpoint of AIC values. This improves the situation
slightly, although confidence intervals do not indicate a significant
decrease in snags after treatment, contrary to what common sense suggests.
Do I need to somehow be modeling the big decrease in variance between time1
and time2 in order to make sense of these data? Data below.
--Seth W. Bigelow


"SettingID","Ecozone","time","snag"
"0506530270068","E","1",0
"0506530290166","E","1",0
"0506530290181","E","1",0
"0506530300115","E","1",0
"0506530300124","E","1",0
"0506530300136","E","1",2
"0506530380015","E","1",0
"0506530380037","E","1",0
"0506530390006","E","1",0
"0506530390119","E","1",0
"0506530400036","E","1",0
"0506530400049","E","1",0
"050653040280049","E","1",0
"0506530430040","E","1",0
"0506530430047","E","1",0
"0506530430065","E","1",0
"0506530430089","E","1",0
"0506580130060","E","1",2
"0506580130155","E","1",0
"0506580180062","E","1",2
"0506581900343","E","1",2
"0506581900346","E","1",4
"0511511060010","E","1",0
"0511511210049","E","1",0
"0511515070003","E","1",6
"0511515070018","E","1",0
"0511515070034","E","1",6
"0511515070054","E","1",0
"0511515160010","E","1",0
"0511515160013","E","1",4
"0511522070132","E","1",0
"0511522070151","E","1",1
"0511522070152","E","1",2
"0511525010008","E","1",0
"0511525010022","E","1",4
"0511525170005","E","1",4
"0517566200042","E","1",12
"0517566200044","E","1",2
"0517566300087","E","1",0
"0517566300095","E","1",4
"0517566350026","E","1",6
"0517566400015","E","1",8
"0517566400086","E","1",0
"0506512840152","W","1",0
"0506512840186","W","1",0
"0506513810068","W","1",0
"0511526022084","W","1",0
"0511526022085","W","1",0
"0511526030034","W","1",12
"0511526050084","W","1",12
"05115260516B0084","W","1",3
"05115260516G0084","W","1",7
"05115260516H0084","W","1",2
"051152605A0084","W","1",8
"0511526130477","W","1",0
"0511526130543","W","1",5
"0511526130619","W","1",2
"0511526190087","W","1",0
"0511534210306","W","1",0
"0511534210307","W","1",2
"0511534210308","W","1",2
"0511534210312","W","1",10
"0517567400160","W","1",4
"0517567400182","W","1",3
"0506530270068","E","2",0
"0506530290166","E","2",0
"0506530290181","E","2",0
"0506530300115","E","2",0
"0506530300124","E","2",0
"0506530300136","E","2",0
"0506530380015","E","2",0
"0506530380037","E","2",0
"0506530390006","E","2",0
"0506530390119","E","2",0
"0506530400036","E","2",0
"0506530400049","E","2",0
"050653040280049","E","2",0
"0506530430040","E","2",0
"0506530430047","E","2",0
"0506530430065","E","2",0
"0506530430089","E","2",0
"0506580130060","E","2",0
"0506580130155","E","2",0
"0506580180062","E","2",0
"0506581900343","E","2",0
"0506581900346","E","2",0
"0511511060010","E","2",0
"0511511210049","E","2",0
"0511515070003","E","2",4
"0511515070018","E","2",2
"0511515070034","E","2",4
"0511515070054","E","2",0
"0511515160010","E","2",0
"0511515160013","E","2",4
"0511522070132","E","2",0
"0511522070151","E","2",1
"0511522070152","E","2",2
"0511525010008","E","2",0
"0511525010022","E","2",2
"0511525170005","E","2",1
"0517566200042","E","2",2
"0517566200044","E","2",2
"0517566300087","E","2",0
"0517566300095","E","2",0
"0517566350026","E","2",0
"0517566400015","E","2",4
"0517566400086","E","2",0
"0506512840152","W","2",0
"0506512840186","W","2",0
"0506513810068","W","2",0
"0511526022084","W","2",0
"0511526022085","W","2",0
"0511526030034","W","2",4
"0511526050084","W","2",12
"05115260516B0084","W","2",2
"05115260516G0084","W","2",2
"05115260516H0084","W","2",2
"051152605A0084","W","2",2
"0511526130477","W","2",0
"0511526130543","W","2",5
"0511526130619","W","2",2
"0511526190087","W","2",0
"0511534210306","W","2",2
"0511534210307","W","2",0
"0511534210308","W","2",0
"0511534210312","W","2",8
"0517567400160","W","2",2
"0517567400182","W","2",4
"0506530270068","E","3",0
"0506530290166","E","3",0
"0506530290181","E","3",0
"0506530300115","E","3",0
"0506530300124","E","3",0
"0506530300136","E","3",0
"0506530380015","E","3",0
"0506530380037","E","3",0
"0506530390006","E","3",0
"0506530390119","E","3",0
"0506530400036","E","3",0
"0506530400049","E","3",0
"050653040280049","E","3",0
"0506530430040","E","3",2
"0506530430047","E","3",0
"0506530430065","E","3",0
"0506530430089","E","3",0
"0506580130060","E","3",0
"0506580130155","E","3",1
"0506580180062","E","3",0
"0506581900343","E","3",0
"0506581900346","E","3",0
"0511511060010","E","3",0
"0511511210049","E","3",0
"0511515070003","E","3",2
"0511515070018","E","3",0
"0511515070034","E","3",4
"0511515070054","E","3",0
"0511515160010","E","3",0
"0511515160013","E","3",4
"0511522070132","E","3",1
"0511522070151","E","3",0
"0511522070152","E","3",0
"0511525010008","E","3",3
"0511525010022","E","3",2
"0511525170005","E","3",0
"0517566200042","E","3",2
"0517566200044","E","3",0
"0517566300087","E","3",0
"0517566300095","E","3",0
"0517566350026","E","3",0
"0517566400015","E","3",4
"0517566400086","E","3",0
"0506512840152","W","3",0
"0506512840186","W","3",0
"0506513810068","W","3",0
"0511526022084","W","3",0
"0511526022085","W","3",0
"0511526030034","W","3",4
"0511526050084","W","3",10
"05115260516B0084","W","3",3
"05115260516G0084","W","3",0
"05115260516H0084","W","3",6
"051152605A0084","W","3",4
"0511526130477","W","3",0
"0511526130543","W","3",9
"0511526130619","W","3",0
"0511526190087","W","3",0
"0511534210306","W","3",0
"0511534210307","W","3",2
"0511534210308","W","3",0
"0511534210312","W","3",10
"0517567400160","W","3",2
"0517567400182","W","3",3

-----Original Message-----
From: Seth W. Bigelow [mailto:seth at swbigelow.net] 
Sent: Friday, October 05, 2012 6:44 PM
To: 'Highland Statistics Ltd'; 'r-sig-mixed-models at r-project.org'
Subject: RE: [R-sig-ME] Fwd: Re: Mixed model and negative binomial
distribution

Alain, thank you very much for the advice regarding analysis of my (negative
binomial vs. poisson-distributed) snag data, and my warmest congratulations
on your nuptials
-Seth W. Bigelow

-----Original Message-----
From: r-sig-mixed-models-bounces at r-project.org
[mailto:r-sig-mixed-models-bounces at r-project.org] On Behalf Of Highland
Statistics Ltd
Sent: Friday, October 05, 2012 1:04 PM
To: r-sig-mixed-models at r-project.org
Subject: [R-sig-ME] Fwd: Re: Mixed model and negative binomial distribution




-------- Original Message --------
Subject: 	Re: Mixed model and negative binomial distribution
Date: 	Fri, 05 Oct 2012 12:37:28 +0200
From: 	Highland Statistics Ltd <highstat at highstat.com>
To: 	r-sig-mixed-models at r-project.org <r-sig-mixed-models at r-project.org>



------------------------------

Message: 2
Date: Fri, 5 Oct 2012 04:32:36 +0000 (UTC)
From: Ben Bolker <bbolker at gmail.com>
To: r-sig-mixed-models at r-project.org
Subject: Re: [R-sig-ME] Mixed model and negative binomial distribution
Message-ID: <loom.20121005T062854-986 at post.gmane.org>
Content-Type: text/plain; charset=us-ascii

Seth W. Bigelow <seth at ...> writes:

>
> Dear mixed-model brain trust:
>
> I am comparing snag (dead tree) densities 1 year and 5 years after
> silvicultural treatment in forest plots to densities prior to treatment.
In
> nlme, my model is
>
> lme(snagnum~treatment, random=(~1|plot), correlation=corExp(form=~year)).
>
> {Treatment is a factor with values of Pre/1-year post/5-year post}. This
> gives reasonable output, but I'm having a niggling doubt that I should be
> using something akin to a negative binomial distribution, since about half
> of the values are zeros (i.e., many plots had no snags prior to treatment,
> and did not gain additional snags as a result of treatment). Can anyone
> suggest an appropriate package and associated syntax for doing this mixed
> model based on an alternative probability density function?

>  Negative binomial would be a reasonable distribution; the other
>answer gives you some methods for doing this.  *However*, incorporating
>both serial correlation and non-Gaussian errors in a model of this form
>is a bit of a nuisance.
>The model you want might be something like

>  snagnum ~ Poisson(lambda)
>  lambda ~ MVN(mean=treatment,Sigma=...)

>where the variance-covariance matrix gives you both some extra-Poisson
>variation (to handle overdispersion) and some correlation between
>observations.  I'm hoping Alain Zuur will pop up shortly to point you
>to a reference in his new book that will tell you how to do this in
>WinBUGS ...



-----------
Yesterday, Alain was on a nice beach in the Caribbean enjoying his wedding.
Now he is close to the north pole.


Yes....this sounds MCMC. And code for NB GLMM with AR1 correlation and zero
inflation is indeed in the 2012 book.
However...if the zeros are sequential in time then the correlation and zero
inflation components may fight
for the same information. And the NB distribution may try to take its share
of zeros as well. Better start with
the Poisson version of it....and if a Poisson + correlation + ZIP still
shows problems, then consider the NB.
For irregular time series consider a CAR correlation.

As to the implementation..try WinBUGS, OpenBUGS, JAGS....code is nearly the
same. I recently downloaded STAN...looks promising too.

You may also want to have a look at "Generalized Additive Mixed Model
Analysis via gammSlice" by Pham and Wand.
GAMM is essentially a GLMM.... But I don;t think it can do zero
inflation....but perhaps it does NB GLMM. Not sure.



Alain

-- 

Dr. Alain F. Zuur
First author of:

1. Analysing Ecological Data (2007).
Zuur, AF, Ieno, EN and Smith, GM. Springer. 680 p.
URL: www.springer.com/0-387-45967-7


2. Mixed effects models and extensions in ecology with R. (2009).
Zuur, AF, Ieno, EN, Walker, N, Saveliev, AA, and Smith, GM. Springer.
http://www.springer.com/life+sci/ecology/book/978-0-387-87457-9


3. A Beginner's Guide to R (2009).
Zuur, AF, Ieno, EN, Meesters, EHWG. Springer
http://www.springer.com/statistics/computational/book/978-0-387-93836-3


4. Zero Inflated Models and Generalized Linear Mixed Models with R. (2012)
Zuur, Saveliev, Ieno.
http://www.highstat.com/book4.htm

Other books: http://www.highstat.com/books.htm


Statistical consultancy, courses, data analysis and software
Highland Statistics Ltd.
6 Laverock road
UK - AB41 6FN Newburgh
Tel: 0044 1358 788177
Email: highstat at highstat.com
URL: www.highstat.com
URL: www.brodgar.com
























	[[alternative HTML version deleted]]

_______________________________________________
R-sig-mixed-models at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models


From d.afshartous at vanderbilt.edu  Sat Oct 20 20:24:55 2012
From: d.afshartous at vanderbilt.edu (Afshartous, David)
Date: Sat, 20 Oct 2012 18:24:55 +0000
Subject: [R-sig-ME] nlme, biexponential PK model simulation
Message-ID: <E7DFC74ED2DEAD47AFD38124459241CB0C140A@ITS-HCWNEM108.ds.vanderbilt.edu>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121020/036bf15e/attachment.pl>

From bates at stat.wisc.edu  Mon Oct 22 18:11:48 2012
From: bates at stat.wisc.edu (Douglas Bates)
Date: Mon, 22 Oct 2012 11:11:48 -0500
Subject: [R-sig-ME] glmer with dissimilarity values
In-Reply-To: <e2fce99f7a77d9b2608db60ab6377b27@upatras.gr>
References: <e2fce99f7a77d9b2608db60ab6377b27@upatras.gr>
Message-ID: <CAO7JsnRqFa4wok6bjBPy0uDWOQLrT2RfiK7Yi04NRGL+TgUgkg@mail.gmail.com>

Generally it is best to send questions like this to the
R-SIG-Mixed-Models at R-project.org mailing list (see instructions at
https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models).  Many of
those who read that list can reply and often much faster than I am
able to.


On Mon, Oct 22, 2012 at 4:22 AM, Eva Pitta <epitta at upatras.gr> wrote:
> Hello,
> I am a phd student in Greece using the lme4 package to fit generalized
> linear mixed-effects models.
> I have a question regarding the use of glmm on certain type of data.
> The problem is that my data are dissimilarity values calculated using the
> one-complement of the Jaccard index
> for each pair of islands in each archipelago. If an archipelago has 10
> islands I end up with 45 dissimilarity values.
> If a second archipelago has 5 islands I end up with 10 dissimilarity values.
> I know that dissimilartiy matrices are analysed using Mantel tests or
> multiple regression on distance matrices.
> The data are first in the form of a dissimilarity matrix for each
> archipelago. For each archipelago I used Mantel test to correlate the
> dissimilarity matrix with the geographical distance matrix (distance was
> calculated between all islands of an archipelago).
> However, this approach (or multiple regression on distance matrices) cannot
> be applied to many
> dissimilarity matrices from different areas (or archipelagos as is my case)
> at the same time.
> So I created a vector with the dissimilarity values between all island pairs
> and also another vector with the distances between the islands and
> I fitted a glmm with dissimilarity as a response variable, distance as a
> fixed effect and archipelago as random effect. I also included island type
> as a fixed effect beacuse I want to see if there are differences between
> oceanic and continental islands.
> I know that glmms allow for correlation betwen observations. Does this mean
> that I can use glmm to model dissimilarity values?
> Dissimilarity values from different archipelagos are independent from each
> other. I only calculate dissimilarity values between islands of the same
> archipelago.
>
> For example my data are in the form:
>
> Dissimilarity   Distance        Island_type     Archipelago
> 0               5259.157        continental     adriatic_islands
> 0.4285714       8967.4931       continental     adriatic_islands
> 0.5714286       261975.283      continental     adriatic_islands
> 0.5714286       25605.9319      continental     adriatic_islands
> 0.5714286       85230.7187      continental     adriatic_islands
> 0.7142857       298784.1031     continental     adriatic_islands
> 0.7142857       369245.918      continental     adriatic_islands
> 0.7142857       251044.0615     continental     adriatic_islands
> 0.8571429       231761.9685        continental     adriatic_islands
> 0.8571429       58223.7633      continental     adriatic_islands
> 0.8571429       253342.5877        continental     adriatic_islands
> 0.8571429       329540.3376     continental     adriatic_islands
> 0.4285714       20047.0762      continental     adriatic_islands
> 0.5714286       248763.7943        continental     adriatic_islands
> 0.5714286       21853.6469      continental     adriatic_islands
> 0.3             89478.116       continental     central_aegean_islands
> 0.5454545       74230.855       continental     central_aegean_islands
> 0.5454545       125774.88       continental     central_aegean_islands
> 0.5454545       155256.578      continental     central_aegean_islands
> 0.5454545       126187.824      continental     central_aegean_islands
> 0.5             180264.809      continental     central_aegean_islands
> 0.6363636       180998.609      continental     central_aegean_islands
> 0.6363636       147414.741      continental     central_aegean_islands
> 0.75            146702.402      continental     central_aegean_islands
> 0.6363636       174237.948      continental     central_aegean_islands
> 0.6             61902.301       continental     central_aegean_islands
> 0.6             48277.908       continental     central_aegean_islands
> 0.7272727       103213.926      continental     central_aegean_islands
> 0.7272727       134316.409      continental     central_aegean_islands
> 0.7272727       169854.705      continental     central_aegean_islands
> 0.5384615       542269.8027     oceanic         solomon_islands
> 0.5             523544.4758     oceanic         solomon_islands
> 0.5833333       8815.5537       oceanic         solomon_islands
> 0.5833333       276307.3533        oceanic         solomon_islands
> 0.6666667       111280.2721     oceanic         solomon_islands
> 0.5454545       211541.7332     oceanic         solomon_islands
> 0.6666667       706676.0145        oceanic         solomon_islands
> 0.6363636       143283.6463     oceanic         solomon_islands
> 0.75            44164.1395      oceanic         solomon_islands
> 0.7272727       293562.926      oceanic         solomon_islands
> 0.7272727       168887.5203     oceanic         solomon_islands
> 0.8333333       167874.4115     oceanic         solomon_islands
> 0.8181818       1273543.673     oceanic         solomon_islands
> 0.8181818       747544.6154        oceanic         solomon_islands
> 0.8181818       270851.9093        oceanic         solomon_islands
> 0.8181818       1178250.474     oceanic         solomon_islands
> 0.8181818       853046.0902     oceanic         solomon_islands
> ...
>
> The non-independence of dissimilarity values of the same archipelago is due
> to the fact that they are calculated using partly the same data. Is this is
> accounted for by the random factor?
> I would appreciate any help you can give me.
>
> Thank you for your time
>
> Eva Pitta
>


From seth at swbigelow.net  Mon Oct 22 19:24:56 2012
From: seth at swbigelow.net (Seth W. Bigelow)
Date: Mon, 22 Oct 2012 13:24:56 -0400
Subject: [R-sig-ME] Mixed model and negative binomial distribution
In-Reply-To: <50853DFC.6010006@otter-rsch.com>
References: <000601cdaed3$bf7f5ce0$3e7e16a0$@net>
	<508480E6.9040501@otter-rsch.com>
	<000001cdafe7$ee2d6130$ca882390$@net>
	<50853DFC.6010006@otter-rsch.com>
Message-ID: <003a01cdb07a$28cec2b0$7a6c4810$@net>

Dave, that's a very generous offer to modify admb, but I don't know whether
or how estimating separate overdispersion parameters before and after
treatment would affect the test of fixed effects. I will wait a bit to see
if any statisticians chime in on this before sending you the *.dat & *.pin
files.
--Seth

-----Original Message-----
From: dave fournier [mailto:davef at otter-rsch.com] 
Sent: Monday, October 22, 2012 8:37 AM
To: Seth W. Bigelow
Subject: Re: [R-sig-ME] Mixed model and negative binomial distribution

On 12-10-21 04:58 PM, Seth W. Bigelow wrote:

It is not difficult to parameterize the model with an overdispersion
parameter which depends on a number of covariates, but I odn't think
it has been done (you could ask Ben).  glmmadmb is written
using ad model builder which I created. I can easily modify the
program to do that if you want.  Creating an r interface is
the difficult part so I prefer to work just with admb.  If you want what
I need to test this out are the files  *.dat and *.pin which you can 
save using
the savedir option of glmmadmb.

       Dave

> Ah, ok, a light bulb just went on. It must be that the overdispersion
> parameter is equivalent to the 'k' parameter of the negative binomial, and
> that rather than estimating a different k for each cell mean, a single k
for
> the whole experiment is estimated in glmmadmb.
>
> Would it be possible, or logical, to estimate different overdispersion
> parameters before and after treatment?
>
> -Seth
>
> -----Original Message-----
> From: dave fournier [mailto:davef at otter-rsch.com]
> Sent: Sunday, October 21, 2012 7:10 PM
> To: seth at swbigelow.net
> Subject: Re: [R-sig-ME] Mixed model and negative binomial distribution
>
> Hi,
>
> Do you mean that you want to use different parameters for the
overdispersion
> before and after treatment?
>
>        Dave
>


From datkins at u.washington.edu  Tue Oct 23 07:35:11 2012
From: datkins at u.washington.edu (David Atkins)
Date: Tue, 23 Oct 2012 07:35:11 +0200
Subject: [R-sig-ME] Mixed model and negative binomial distribution
In-Reply-To: <000601cdaed3$bf7f5ce0$3e7e16a0$@net>
References: <000601cdaed3$bf7f5ce0$3e7e16a0$@net>
Message-ID: <50862C8F.7090901@u.washington.edu>


Seth--

It is not clear to me what the disconnect is between the GLMM results 
and what you expect?  For example:

"It's tricky to interpret the log-transformed coefficients and associated
confidence intervals, but they don't seem to reflect the decrease in snags
after treatment that I see when I examine the cell means (e.g., mean East
density at time1 (pre-treatment) is 1.7, dropping to 0.7 at time2 (after
treatment).)"

I fit your model, and here are the results including random-effects:

Coefficients:
                  Estimate Std. Error z value Pr(>|z|)
(Intercept)        -0.764      0.359   -2.13   0.0334 *
as.factor(time)2   -0.588      0.186   -3.16   0.0016 **
as.factor(time)3   -0.604      0.189   -3.20   0.0014 **
EcozoneW            1.249      0.487    2.57   0.0103 *
---
Signif. codes:  0 ?***? 0.001 ?**? 0.01 ?*? 0.05 ?.? 0.1 ? ? 1

Number of observations: total=192, SettingID=64
Random effect variance(s):
Group=SettingID
             Variance StdDev
(Intercept)     2.37   1.54
Negative binomial dispersion parameter: 1.812 (std. err.: 0.33774)

So, we can exponentiate these coefficients to get *conditional* rate 
ratios, or we can include the random-effects to get marginal predictions 
of snag from the model.

Conditional RR:

 > cbind(exp(fixef(my.admb)))
                       [,1]
(Intercept)      0.4660185
as.factor(time)2 0.5551761
as.factor(time)3 0.5467793
EcozoneW         3.4879006

Thus, conditional on the random-effects, there is a 45% decrease in 
snags at time 2.  That seems reasonable given the data, I think?

Marginal predictions:

 > exp(-0.764 + 2.37/2) # marginal intercept
[1] 1.523484

 > exp(-0.764 - 0.588 + 2.37/2) # marginal prediction at time2
[1] 0.8461996

Again, seem sort of reasonable, with the caveat that I am a psychologist 
who studies drug addiction and marital therapy... ;)

If some of your questions are general questions about how to interpret 
the output from Poisson / NB mixed models, then you might take a look at 
a tutorial article that we wrote (with R code), which also points to 
other resources:

http://depts.washington.edu/cshrb/newweb/statstutorials.html

Atkins, D. C., Baldwin, S., Zheng, C., Gallop, R. J., & Neighbors, C. 
(in press). A tutorial on count regression and zero-altered count models 
for longitudinal addictions data.

Granted, the example data come from alcohol focused studies (but 
interestingly enough, it seems the addictions researchers and ecologists 
have similar types of outcomes / models).

If I have missed your question, please let me know.

cheers, Dave

-- 
Dave Atkins, PhD
University of Washington
datkins at u.washington.edu
http://depts.washington.edu/cshrb/

August 1 - October 30:

Universitat Zurich
Psychologisches Institut
Klinische Psychologie
Binzmuhlestrasse 14/23
CH-8050 Zurich

+41 44 635 71 75

Original post:

Dear list: this is a continuation of a previous question. To recap,after
input from several listserv members, I have been using glmmADMB to model
snag (dead tree) densities before, after, and 5 years after forest (factor
variable 'time'). (I apologize for disregarding the advice to use 'BUGS'
approaches -- I didn't have $ for new books or time for assimilation of new
paradigm). The data sampling was stratified by 'Ecozone' ('East' densities
are much lower than 'West'). Because there are many plots with no snags, I
evaluated use of Poisson vs. Negative binomial distribution by finding mean
& variance for each combination of time & Ecozone. AIC for the NB
distribution was vastly smaller (more favorable) than for the Poisson.
Variance tended to be much higher prior to treatment (because a few plots
have large numbers of snags and loggers are instructed to knock most of
these down and simply retain a few).

My statement is glmmadmb(snag~time+Ecozone + (1|SettingID), data=.,
family="nbinom1"). ('SettingID' is a plot identifier).

So, I have these observations/questions. First, when I experiment with
'family="poisson", AIC for the glmm is only 2 AIC units greater than for the
negative binomial model, yet with AIC estimated for individual cells, AIC
Poisson >> AIC NegBinom. Any idea why this might be? (I've tried
zero-inflation for poisson & NB, doesn't seem to make much difference)

It's tricky to interpret the log-transformed coefficients and associated
confidence intervals, but they don't seem to reflect the decrease in snags
after treatment that I see when I examine the cell means (e.g., mean East
density at time1 (pre-treatment) is 1.7, dropping to 0.7 at time2 (after
treatment).) Here's part of the summary statement:

Coefficients:
             Estimate Std. Error z value Pr(>|z|)
(Intercept)     -0.764      0.359   -2.13   0.0334 *
time2             -0.588    0.186   -3.16   0.0016 **
time3            -0.604     0.189   -3.20   0.0014 **
EcozoneW     1.249          0.487    2.57   0.0103 *

 >> exp(coef(.))
(Intercept)       time2       time3    EcozoneW
       0.466       0.555       0.547       3.488

I have tried the full-interaction model ("time*Ecozone"), although it is not
justified from the standpoint of AIC values. This improves the situation
slightly, although confidence intervals do not indicate a significant
decrease in snags after treatment, contrary to what common sense suggests.
Do I need to somehow be modeling the big decrease in variance between time1
and time2 in order to make sense of these data? Data below.
--Seth W. Bigelow


From mcasals at aspb.cat  Tue Oct 23 14:54:58 2012
From: mcasals at aspb.cat (=?ISO-8859-1?Q?Mart=ED_Casals?=)
Date: Tue, 23 Oct 2012 14:54:58 +0200
Subject: [R-sig-ME] convergence in GLMM (lme4 package)
Message-ID: <CADtmEn5SjY2gqTfZ4JLZ5Wz=QcN+tvJMpC4RWkqGm9P5kaT9_A@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121023/3c435255/attachment.pl>

From Ammara.Mahmood at sbs.ox.ac.uk  Tue Oct 23 15:52:38 2012
From: Ammara.Mahmood at sbs.ox.ac.uk (Ammara Mahmood)
Date: Tue, 23 Oct 2012 14:52:38 +0100
Subject: [R-sig-ME] Maximizer failed
Message-ID: <423F9DEC-F454-483D-9AEF-40E15E9E473F@sbs.ox.ac.uk>

I tried extra.args="-ndi 60000" and still got the message to increase the calls. I increased the calls to 80000 and got the same error, however, at 90,000 and 100,000 the program freezes and R runs forever and does not respond.

Could you please suggest another solution.

Thanks


I am trying to use the Glmmadmb to model truncated negative
binomial with random effects in the count and zero part. The models
run fine when i I do not include the random effects. The data is on
page views per individual at a news paper website over a period of
1 month, hence I want to include person specific random effects.
And I create the group Id by person.

So I have been able to run the following successfully:


output <- glmmadmb(tot_pv~   time_last_visit + friends_residual+
number_friends + like_counter + avg_gap_activity + dum_local +
dum_sport + dum_more + dum_tvzap  + number_like +
tot_daily_visits_o + tot_daily_visits_reg + female + age  ,
data=(subset(facebook_merge,tot_pv>0)), zeroInflation=FALSE,
family="truncnbinom1")

However when I include a random effect on each individual in the
data set I get the following error message:

output <- glmmadmb(tot_pv~   time_last_visit + friends_residual+
number_friends + like_counter + avg_gap_activity + dum_local +
dum_sport + dum_more + dum_tvzap  + number_like +
tot_daily_visits_o + tot_daily_visits_reg + female + age ,
(1|group_id) , data=(subset(facebook_merge,tot_pv>0)),
zeroInflation=FALSE, family="truncnbinom1")

Error message

The function maximizer failed (couldn't find STD file) In addition:
Warning message: running command './glmmadmb -maxfn 500 -maxph 5
-noinit -shess' had status 1

Need to increase the maximum number of separable calls allowed to
at least 20001 Current value is 20000 Use the -ndi N command line
option


I am currently working on a MAC.

Could you please help me solve this issue?


 Well, try adding the argument

extra.args="-ndi 60000"

to your call and see if it works (if you get another complaint,
increase the
value further).

 If you have any more questions along these lines, could you please send
them via r-sig-mixed-models at r-project.org<mailto:r-sig-mixed-models at r-project.org>?

 Ben Bolker


From seth at swbigelow.net  Tue Oct 23 17:19:48 2012
From: seth at swbigelow.net (Seth W. Bigelow)
Date: Tue, 23 Oct 2012 11:19:48 -0400
Subject: [R-sig-ME] Mixed model and negative binomial distribution
In-Reply-To: <50862C8F.7090901@u.washington.edu>
References: <000601cdaed3$bf7f5ce0$3e7e16a0$@net>
	<50862C8F.7090901@u.washington.edu>
Message-ID: <002f01cdb131$d81d86e0$885894a0$@net>

Dave, 

I skimmed your tutorial after you first mentioned it but now am going
through line by line. It explains everything beautifully and simply, I
strongly recommend 

"Atkins, D. C., Baldwin, S., Zheng, C., Gallop, R. J., & Neighbors, C. (in
press). A tutorial on count regression and zero-altered count models for
longitudinal addictions data." 

...for anyone seeking a compact introduction to poisson & negative
binomial-based mixed models, regardless of the field they are in.

Thank you for running my snag data and explaining how to interpret
coefficients of mixed-models based on poisson and negative binomial
distributions.

--Seth W. Bigelow



-----Original Message-----
From: r-sig-mixed-models-bounces at r-project.org
[mailto:r-sig-mixed-models-bounces at r-project.org] On Behalf Of David Atkins
Sent: Tuesday, October 23, 2012 1:35 AM
To: r-sig-mixed-models at r-project.org
Subject: Re: [R-sig-ME] Mixed model and negative binomial distribution


Seth--

It is not clear to me what the disconnect is between the GLMM results 
and what you expect?  For example:

"It's tricky to interpret the log-transformed coefficients and associated
confidence intervals, but they don't seem to reflect the decrease in snags
after treatment that I see when I examine the cell means (e.g., mean East
density at time1 (pre-treatment) is 1.7, dropping to 0.7 at time2 (after
treatment).)"

I fit your model, and here are the results including random-effects:

Coefficients:
                  Estimate Std. Error z value Pr(>|z|)
(Intercept)        -0.764      0.359   -2.13   0.0334 *
as.factor(time)2   -0.588      0.186   -3.16   0.0016 **
as.factor(time)3   -0.604      0.189   -3.20   0.0014 **
EcozoneW            1.249      0.487    2.57   0.0103 *
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Number of observations: total=192, SettingID=64
Random effect variance(s):
Group=SettingID
             Variance StdDev
(Intercept)     2.37   1.54
Negative binomial dispersion parameter: 1.812 (std. err.: 0.33774)

So, we can exponentiate these coefficients to get *conditional* rate 
ratios, or we can include the random-effects to get marginal predictions 
of snag from the model.

Conditional RR:

 > cbind(exp(fixef(my.admb)))
                       [,1]
(Intercept)      0.4660185
as.factor(time)2 0.5551761
as.factor(time)3 0.5467793
EcozoneW         3.4879006

Thus, conditional on the random-effects, there is a 45% decrease in 
snags at time 2.  That seems reasonable given the data, I think?

Marginal predictions:

 > exp(-0.764 + 2.37/2) # marginal intercept
[1] 1.523484

 > exp(-0.764 - 0.588 + 2.37/2) # marginal prediction at time2
[1] 0.8461996

Again, seem sort of reasonable, with the caveat that I am a psychologist 
who studies drug addiction and marital therapy... ;)

If some of your questions are general questions about how to interpret 
the output from Poisson / NB mixed models, then you might take a look at 
a tutorial article that we wrote (with R code), which also points to 
other resources:

http://depts.washington.edu/cshrb/newweb/statstutorials.html

Atkins, D. C., Baldwin, S., Zheng, C., Gallop, R. J., & Neighbors, C. 
(in press). A tutorial on count regression and zero-altered count models 
for longitudinal addictions data.

Granted, the example data come from alcohol focused studies (but 
interestingly enough, it seems the addictions researchers and ecologists 
have similar types of outcomes / models).

If I have missed your question, please let me know.

cheers, Dave

-- 
Dave Atkins, PhD
University of Washington
datkins at u.washington.edu
http://depts.washington.edu/cshrb/

August 1 - October 30:

Universitat Zurich
Psychologisches Institut
Klinische Psychologie
Binzmuhlestrasse 14/23
CH-8050 Zurich

+41 44 635 71 75

Original post:

Dear list: this is a continuation of a previous question. To recap,after
input from several listserv members, I have been using glmmADMB to model
snag (dead tree) densities before, after, and 5 years after forest (factor
variable 'time'). (I apologize for disregarding the advice to use 'BUGS'
approaches -- I didn't have $ for new books or time for assimilation of new
paradigm). The data sampling was stratified by 'Ecozone' ('East' densities
are much lower than 'West'). Because there are many plots with no snags, I
evaluated use of Poisson vs. Negative binomial distribution by finding mean
& variance for each combination of time & Ecozone. AIC for the NB
distribution was vastly smaller (more favorable) than for the Poisson.
Variance tended to be much higher prior to treatment (because a few plots
have large numbers of snags and loggers are instructed to knock most of
these down and simply retain a few).

My statement is glmmadmb(snag~time+Ecozone + (1|SettingID), data=.,
family="nbinom1"). ('SettingID' is a plot identifier).

So, I have these observations/questions. First, when I experiment with
'family="poisson", AIC for the glmm is only 2 AIC units greater than for the
negative binomial model, yet with AIC estimated for individual cells, AIC
Poisson >> AIC NegBinom. Any idea why this might be? (I've tried
zero-inflation for poisson & NB, doesn't seem to make much difference)

It's tricky to interpret the log-transformed coefficients and associated
confidence intervals, but they don't seem to reflect the decrease in snags
after treatment that I see when I examine the cell means (e.g., mean East
density at time1 (pre-treatment) is 1.7, dropping to 0.7 at time2 (after
treatment).) Here's part of the summary statement:

Coefficients:
             Estimate Std. Error z value Pr(>|z|)
(Intercept)     -0.764      0.359   -2.13   0.0334 *
time2             -0.588    0.186   -3.16   0.0016 **
time3            -0.604     0.189   -3.20   0.0014 **
EcozoneW     1.249          0.487    2.57   0.0103 *

 >> exp(coef(.))
(Intercept)       time2       time3    EcozoneW
       0.466       0.555       0.547       3.488

I have tried the full-interaction model ("time*Ecozone"), although it is not
justified from the standpoint of AIC values. This improves the situation
slightly, although confidence intervals do not indicate a significant
decrease in snags after treatment, contrary to what common sense suggests.
Do I need to somehow be modeling the big decrease in variance between time1
and time2 in order to make sense of these data? Data below.
--Seth W. Bigelow

_______________________________________________
R-sig-mixed-models at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models


From bbolker at gmail.com  Tue Oct 23 19:53:45 2012
From: bbolker at gmail.com (Ben Bolker)
Date: Tue, 23 Oct 2012 17:53:45 +0000 (UTC)
Subject: [R-sig-ME] Maximizer failed
References: <423F9DEC-F454-483D-9AEF-40E15E9E473F@sbs.ox.ac.uk>
Message-ID: <loom.20121023T194419-614@post.gmane.org>

Ammara Mahmood <Ammara.Mahmood at ...> writes:

> I tried extra.args="-ndi 60000" and still got the message to
> increase the calls. I increased the calls to 80000 and got the same
> error, however, at 90,000 and 100,000 the program freezes and R runs
> forever and does not respond.

> Could you please suggest another solution.

  My best guess, in the absence of a reproducible example, is
that you are running out of memory.  Does the model work with
a subset of your data?  (How big is your full data set?)

  If you can't get glmmadmb to run, you *might* be able to
do a bit better with a full AD Model Builder model (although
that's more work to figure out).  Alternatively, you might
be able to use some kind of cluster correction for your 
confidence intervals ...

> I am trying to use the Glmmadmb to model truncated negative
> binomial with random effects in the count and zero part.

 (Note that at present there are no random effects in the
zero part ... and the current glmmADMB interface doesn't
make it easy to do this ...)

>  The models
> run fine when i I do not include the random effects. The data is on
> page views per individual at a news paper website over a period of
> 1 month, hence I want to include person specific random effects.
> And I create the group Id by person.
> 
> So I have been able to run the following successfully:
> 
> output <- glmmadmb(tot_pv~   time_last_visit + friends_residual+
> number_friends + like_counter + avg_gap_activity + dum_local +
> dum_sport + dum_more + dum_tvzap  + number_like +
> tot_daily_visits_o + tot_daily_visits_reg + female + age  ,
> data=(subset(facebook_merge,tot_pv>0)), zeroInflation=FALSE,
> family="truncnbinom1")
> 
> However when I include a random effect on each individual in the
> data set I get the following error message:
> 
> output <- glmmadmb(tot_pv~   time_last_visit + friends_residual+
> number_friends + like_counter + avg_gap_activity + dum_local +
> dum_sport + dum_more + dum_tvzap  + number_like +
> tot_daily_visits_o + tot_daily_visits_reg + female + age ,
> (1|group_id) , data=(subset(facebook_merge,tot_pv>0)),
> zeroInflation=FALSE, family="truncnbinom1")
> 
> Error message
> 
> The function maximizer failed (couldn't find STD file) In addition:
> Warning message: running command './glmmadmb -maxfn 500 -maxph 5
> -noinit -shess' had status 1
> 
> Need to increase the maximum number of separable calls allowed to
> at least 20001 Current value is 20000 Use the -ndi N command line
> option
> 

 [snip]


From bbolker at gmail.com  Tue Oct 23 20:15:46 2012
From: bbolker at gmail.com (Ben Bolker)
Date: Tue, 23 Oct 2012 18:15:46 +0000 (UTC)
Subject: [R-sig-ME] convergence in GLMM (lme4 package)
References: <CADtmEn5SjY2gqTfZ4JLZ5Wz=QcN+tvJMpC4RWkqGm9P5kaT9_A@mail.gmail.com>
Message-ID: <loom.20121023T195352-241@post.gmane.org>

Mart? Casals <mcasals at ...> writes:

> 
> I?m working on the simulation results and I would like to know the
> convergence of the GLMM model. For example, if I want to obtain the
> converge in the glm case with R, I can extract:
> 
> model1<-glm(................family=" ",data=)
> 
> *model1$converged*
> 
> [1] TRUE
> 
> I don?t know if exist a similar function in the lme4 package (glmer ).
> 

  I think not.
  I believe the only way to do this (it may have been discussed before)
is to use options(warning=2) to promote warnings to errors, then to use
tryCatch() etc. to intercept the errors and store the information somewhere.

http://comments.gmane.org/gmane.comp.lang.r.lme4.devel/8691
https://stat.ethz.ch/pipermail/r-help/2012-February/302767.html

  I've added a bit on this to http://glmm.wikidot.com/faq, since it's
not the first time it has come up ...

 Ben Bolker


From mcasals at aspb.cat  Tue Oct 23 21:57:24 2012
From: mcasals at aspb.cat (=?ISO-8859-1?Q?Mart=ED_Casals?=)
Date: Tue, 23 Oct 2012 21:57:24 +0200
Subject: [R-sig-ME] convergence in GLMM (lme4 package)
In-Reply-To: <loom.20121023T195352-241@post.gmane.org>
References: <CADtmEn5SjY2gqTfZ4JLZ5Wz=QcN+tvJMpC4RWkqGm9P5kaT9_A@mail.gmail.com>
	<loom.20121023T195352-241@post.gmane.org>
Message-ID: <CADtmEn4GJDbnT96dXtm+TFKnL3xG0M_mUKhqOX__-rHQtcgfHQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121023/f6f746a6/attachment.pl>

From andrewdigby at mac.com  Tue Oct 23 22:39:58 2012
From: andrewdigby at mac.com (Andrew Digby)
Date: Wed, 24 Oct 2012 09:39:58 +1300
Subject: [R-sig-ME] Simulate samples from glmmPQL
In-Reply-To: <mailman.3094.1351022253.4555.r-sig-mixed-models@r-project.org>
References: <mailman.3094.1351022253.4555.r-sig-mixed-models@r-project.org>
Message-ID: <DE3D6414-FD63-48FF-B611-9C91C9A75DBC@mac.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121024/0e8321c1/attachment.pl>

From bbolker at gmail.com  Tue Oct 23 23:35:52 2012
From: bbolker at gmail.com (Ben Bolker)
Date: Tue, 23 Oct 2012 21:35:52 +0000 (UTC)
Subject: [R-sig-ME] Simulate samples from glmmPQL
References: <mailman.3094.1351022253.4555.r-sig-mixed-models@r-project.org>
	<DE3D6414-FD63-48FF-B611-9C91C9A75DBC@mac.com>
Message-ID: <loom.20121023T232024-199@post.gmane.org>

Andrew Digby <andrewdigby at ...> writes:

>  I want to use a parametric bootstrap on a GLMM to to determine
> parameter bias
> (http://www.bris.ac.uk/cmm/team/hg/bias-correction.pdf) and
> hopefully to estimate effect confidence intervals
> (http://glmm.wikidot.com/faq).
 
> I'm using glmmPQL{MASS} since I need to include an AR1 correlation
> structure, but there are no existing parametric bootstrap routines
> for this. I'm writing my own, but am coming unstuck when trying to
> simulate a response from the model:
 
> m1<-glmmPQL(y ~ trt , random = ~ 1 | ID, correlation=corAR1(form=~week), 
>  family = binomial, data = bacteria)
> simulate(m1)
> 
> 	Error in simulate.lme(m1) : 
>   		Models with corStruct and/or varFunc objects not allowed.
 
> I'm trying to write my own simulation code by modifying that from
> lme4 [getMethod('simulate',signature='mer')]. I'm not sure if or how
> I should be including the correlation structure though, and guess
> there's a very good reason why simulate.lme doesn't work with a
> corStruct.

 > If anyone can give me an idea of how to simulate samples from a
> glmmPQL object with a corStruct, or if it's possible, then I'd be
> very grateful. Or just a way of obtaining a rough estimate of the
> bias would be great.  Would a non-parametric bootstrap be completely
> out of the question here
> (e.g.
> http://cran.r-project.org/doc/contrib/Fox-Companion/
>   appendix-bootstrapping.pdf)?

  This seems tricky to me.

1. generating correlated _Gaussian_ variables is no big deal (you can use
the RandomFields package, which is a bit of a sledgehammer/nutcracker scenario
for an AR(1) variable, or more simply construct your variance-covariance matrix
and use MASS::mvrnorm), but ...

2. Integrating this in order to write your own version of simulate.lme() that
did corStruct models might be hairy -- the internals of simulate.lme() are
a little complicated (but it still might be the best solution).

3. As Doug Bates has said here, it's not entirely clear whether the
model glmmPQL is fitting (essentially, a marginal model of the
variance-covariance structure) actually corresponds to anything you
could actually simulate.  A well-formed model of this sort would look
like:

   y ~ Binomial(plogis(X %*% beta + Z %*% b + eps))
   b ~ Sigma_b (from G-side/block structure)
   eps ~ MVN(AR(1))

this is a little crude, but the idea is that you actually break the model into 
well-defined hierarchical bits.  It's not clear (to me at least) whether the
model glmmPQL fits in this case actually corresponds to this statistical model
or not.  (INLA appears like it might be the best way forward on this front ...)
(The advantage of hacking simulate.lme is that you'd be taking advantage
of whatever simulate.lme is doing ...)

4. It turns out that corAR1 is not the only problem: even a 'plain' glmmPQL
call (without any correlations) uses a varStruct internally, which breaks
simulate.lme (there is no simulate.glmmPQL, so simulate falls back on
simulate.lme).  It seems to me that if you could hack simulate.lme you
could get a result with the right _variance-covariance structure_, but it
wouldn't be Bernoulli -- it would be normally distributed.  And, just
to add insult to injury, simulate.lme doesn't work the way simulate
methods work in the rest of R -- simulate.lme was written earlier,
and does a bunch of refitting (essentially, parametric bootstrapping!)
stuff rather than returning the raw simulation values.


From andrewdigby at mac.com  Thu Oct 25 05:43:04 2012
From: andrewdigby at mac.com (Andrew Digby)
Date: Thu, 25 Oct 2012 16:43:04 +1300
Subject: [R-sig-ME] R-sig-mixed-models Digest, Vol 70, Issue 33
In-Reply-To: <mailman.4.1351072802.16573.r-sig-mixed-models@r-project.org>
References: <mailman.4.1351072802.16573.r-sig-mixed-models@r-project.org>
Message-ID: <44F24E6D-C2F1-460D-BC36-ED8E7686EAD6@mac.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121025/29fc9b55/attachment.pl>

From jmmartelo at fc.ul.pt  Thu Oct 25 12:57:00 2012
From: jmmartelo at fc.ul.pt (joana martelo)
Date: Thu, 25 Oct 2012 11:57:00 +0100
Subject: [R-sig-ME] model averaging
Message-ID: <001a01cdb29f$76b092c0$6411b840$@ul.pt>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121025/73be6bd9/attachment.pl>

From aghaynes at gmail.com  Thu Oct 25 13:10:30 2012
From: aghaynes at gmail.com (Alan Haynes)
Date: Thu, 25 Oct 2012 13:10:30 +0200
Subject: [R-sig-ME] model averaging
In-Reply-To: <001a01cdb29f$76b092c0$6411b840$@ul.pt>
References: <001a01cdb29f$76b092c0$6411b840$@ul.pt>
Message-ID: <CAPdSD+4BjGomYU9gbtg5EbjPb2mA95+6GE-bQT6Cjc_0uP_Y+Q@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121025/34558243/attachment.pl>

From jmmartelo at fc.ul.pt  Thu Oct 25 14:33:29 2012
From: jmmartelo at fc.ul.pt (joana martelo)
Date: Thu, 25 Oct 2012 13:33:29 +0100
Subject: [R-sig-ME] model averaging
In-Reply-To: <CAPdSD+4BjGomYU9gbtg5EbjPb2mA95+6GE-bQT6Cjc_0uP_Y+Q@mail.gmail.com>
References: <001a01cdb29f$76b092c0$6411b840$@ul.pt>
	<CAPdSD+4BjGomYU9gbtg5EbjPb2mA95+6GE-bQT6Cjc_0uP_Y+Q@mail.gmail.com>
Message-ID: <002201cdb2ac$f0cc43d0$d264cb70$@ul.pt>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121025/9facccd3/attachment.pl>

From aghaynes at gmail.com  Thu Oct 25 14:59:17 2012
From: aghaynes at gmail.com (Alan Haynes)
Date: Thu, 25 Oct 2012 14:59:17 +0200
Subject: [R-sig-ME] model averaging
In-Reply-To: <002201cdb2ac$f0cc43d0$d264cb70$@ul.pt>
References: <001a01cdb29f$76b092c0$6411b840$@ul.pt>
	<CAPdSD+4BjGomYU9gbtg5EbjPb2mA95+6GE-bQT6Cjc_0uP_Y+Q@mail.gmail.com>
	<002201cdb2ac$f0cc43d0$d264cb70$@ul.pt>
Message-ID: <CAPdSD+6hAGMv=N2jDQhOVjWH1t22-1YkuVUMOZvayYqBjAssmg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121025/410f773f/attachment.pl>

From jmmartelo at fc.ul.pt  Thu Oct 25 15:02:26 2012
From: jmmartelo at fc.ul.pt (joana martelo)
Date: Thu, 25 Oct 2012 14:02:26 +0100
Subject: [R-sig-ME] model averaging
In-Reply-To: <CAPdSD+6hAGMv=N2jDQhOVjWH1t22-1YkuVUMOZvayYqBjAssmg@mail.gmail.com>
References: <001a01cdb29f$76b092c0$6411b840$@ul.pt>
	<CAPdSD+4BjGomYU9gbtg5EbjPb2mA95+6GE-bQT6Cjc_0uP_Y+Q@mail.gmail.com>
	<002201cdb2ac$f0cc43d0$d264cb70$@ul.pt>
	<CAPdSD+6hAGMv=N2jDQhOVjWH1t22-1YkuVUMOZvayYqBjAssmg@mail.gmail.com>
Message-ID: <002901cdb2b0$fc2c1cb0$f4845610$@ul.pt>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121025/b943ba9a/attachment.pl>

From mlilleeng at gmail.com  Fri Oct 26 13:57:57 2012
From: mlilleeng at gmail.com (Marte Lilleeng)
Date: Fri, 26 Oct 2012 13:57:57 +0200
Subject: [R-sig-ME] Plot lmer model with Effects package
Message-ID: <CAM-hW5f4gVhOySFO1wA+Sy+ne-9nPo4rB_O34cucbVWcvh15Zg@mail.gmail.com>

Hi everyone!
I have a simple model that i would like to plot with 95% CIs.
It is like follows:
m1<-lmer(Richness~Grazing+I(Grazing^2)+(1|Plot),family=poisson)

By using the effects package I get two plots, one for the linear term
and one for the squared term.
Q1: Can I get all in one? I.e. with one line for the whole model?
Q2: Can I also visualize the random effects?

I would be very happy for your answers!

--
Mvh Marte S. Lilleeng


From gcsadoti at yahoo.com  Mon Oct 29 05:25:58 2012
From: gcsadoti at yahoo.com (Giancarlo Sadoti)
Date: Sun, 28 Oct 2012 21:25:58 -0700 (PDT)
Subject: [R-sig-ME] weighting observations in a glmmadmb model?
In-Reply-To: <mailman.3.1351332002.17851.r-sig-mixed-models@r-project.org>
References: <mailman.3.1351332002.17851.r-sig-mixed-models@r-project.org>
Message-ID: <1351484758.30451.YahooMailNeo@web160605.mail.bf1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121028/0b9c56a9/attachment.pl>

From a.abrain at gmail.com  Mon Oct 29 13:46:48 2012
From: a.abrain at gmail.com (=?ISO-8859-1?Q?Alejandro_Mart=EDnez_Abra=EDn?=)
Date: Mon, 29 Oct 2012 13:46:48 +0100
Subject: [R-sig-ME] error question
Message-ID: <CAHrfa+xyhTLYgy0nD9hSX5yu2hujk6ccMgo3+aThfYbUKAcL2Q@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121029/f453ba5a/attachment.pl>

From bbolker at gmail.com  Mon Oct 29 15:17:20 2012
From: bbolker at gmail.com (Ben Bolker)
Date: Mon, 29 Oct 2012 14:17:20 +0000 (UTC)
Subject: [R-sig-ME] weighting observations in a glmmadmb model?
References: <mailman.3.1351332002.17851.r-sig-mixed-models@r-project.org>
	<1351484758.30451.YahooMailNeo@web160605.mail.bf1.yahoo.com>
Message-ID: <loom.20121029T122512-775@post.gmane.org>

Giancarlo Sadoti <gcsadoti at ...> writes:

> 
> Greetings list members,
> 
> Is there a way to weight observations in a glmmadmb model??
>  glm, lmer, etc. allow a "weights= ..."
> argument, but glmmadmb doesn't and I haven't found a work-around.? Many thanks.
> 
> Giancarlo
> 

  Not at present, no.  Can you give your use case so I can decide whether
I have time to implement this in glmmADMB?    

  Ben Bolker


From bbolker at gmail.com  Mon Oct 29 15:23:15 2012
From: bbolker at gmail.com (Ben Bolker)
Date: Mon, 29 Oct 2012 14:23:15 +0000 (UTC)
Subject: [R-sig-ME] error question
References: <CAHrfa+xyhTLYgy0nD9hSX5yu2hujk6ccMgo3+aThfYbUKAcL2Q@mail.gmail.com>
Message-ID: <loom.20121029T151731-449@post.gmane.org>

Alejandro Mart?nez Abra?n <a.abrain at ...> writes:

> 
> Hi everyone,
> 
> I am running Poisson mixed models in R and I get this error message:
> 
> Mensajes de aviso perdidos
> In aic(y, n, mu, weights, dev) : non-integer x = 2.500000
> 
> Any clues on what it means and how to solve it???
> 
> Thanks
> Alejandro


  To be precise, this is a warning rather than an error message, which
means that R should have given you an answer; it is just telling you there
might be something wrong with it.

  As a general rule of thumb, Poisson models only make sense with integer
responses (in particular, they assume that the variance is equal to the
mean: if your response variables are measured in units of (e.g.) individuals
**per m^2** rather than counts, you could nonsensically change the answers
simply by changing units to per cm^2 or per km^2.  There are situations
where running Poisson models with non-integer response values is OK, but
if you're not sure then you should assume it's not.
 
  If you have counts divided by some fixed area (or time), analyze the
raw counts rather than the densities.  If you have counts divided by
different fixed areas for different observations, then analyze the
counts and use a term
+offset(log(area)) in your model to account for the variation.


From seth at swbigelow.net  Mon Oct 29 15:30:03 2012
From: seth at swbigelow.net (Seth W. Bigelow)
Date: Mon, 29 Oct 2012 10:30:03 -0400
Subject: [R-sig-ME] error question
In-Reply-To: <CAHrfa+xyhTLYgy0nD9hSX5yu2hujk6ccMgo3+aThfYbUKAcL2Q@mail.gmail.com>
References: <CAHrfa+xyhTLYgy0nD9hSX5yu2hujk6ccMgo3+aThfYbUKAcL2Q@mail.gmail.com>
Message-ID: <001e01cdb5e1$e3d0bf70$ab723e50$@net>

This is a 'is the computer plugged in?' question, but...have you scrutinized
your input dataset to make sure all of your 'count' data are integers? 
--Seth W. Bigelow

-----Original Message-----
From: r-sig-mixed-models-bounces at r-project.org
[mailto:r-sig-mixed-models-bounces at r-project.org] On Behalf Of Alejandro
Mart?nez Abra?n
Sent: Monday, October 29, 2012 8:47 AM
To: r-sig-mixed-models-request at r-project.org;
r-sig-mixed-models at r-project.org
Subject: [R-sig-ME] error question

Hi everyone,

I am running Poisson mixed models in R and I get this error message:

Mensajes de aviso perdidos
In aic(y, n, mu, weights, dev) : non-integer x = 2.500000

Any clues on what it means and how to solve it???

Thanks
Alejandro

******************************
Dr. Alejandro Martmnez Abramn
Investigador postdoctoral Parga-Pondal
Universidade da Coruqa
Departamento de Bioloxma Animal, Bioloxma Vexetal e Ecoloxma Campus da
Zapateira s/n
 E-15071 A Coruqa, Spain
http://lapoesiadelconocimiento.blogspot.com/
_______________________
Population Ecology Group
IMEDEA (CSIC-UIB)
C/Miquel Marquhs 21
07190 Esporles (Mallorca), Spain
Voice: +34971611929
E-mail: a.abrain at uib.es
http://imedea.uib-csic.es/bc/gep
http://lapoesiadelconocimiento.blogspot.com/

Mientras el cerebro sea un misterio el universo entero seguira siendo un
misterio (Ramsn y Cajal)

	[[alternative HTML version deleted]]


From spatrick at cebc.cnrs.fr  Mon Oct 29 15:44:48 2012
From: spatrick at cebc.cnrs.fr (Samantha Patrick)
Date: Mon, 29 Oct 2012 15:44:48 +0100
Subject: [R-sig-ME] Heritability of ordinal data in MCMCglmm and estimating
	fixed effects
Message-ID: <508E9660.70307@cebc.cnrs.fr>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121029/2a846084/attachment.pl>

From Sylvia.Opriessnig at noe-lak.at  Tue Oct 30 10:46:03 2012
From: Sylvia.Opriessnig at noe-lak.at (Sylvia Opriessnig)
Date: Tue, 30 Oct 2012 10:46:03 +0100
Subject: [R-sig-ME] help with lme
In-Reply-To: <B6D5D22DF5E8C94B90086FC29BCFAF520CE77890E5@hosting-exch>
References: <B6D5D22DF5E8C94B90086FC29BCFAF520CE77890E5@hosting-exch>
Message-ID: <B6D5D22DF5E8C94B90086FC29BCFAF520CE77890ED@hosting-exch>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121030/92fa3ace/attachment.pl>

From Sylvia.Opriessnig at noe-lak.at  Tue Oct 30 15:31:18 2012
From: Sylvia.Opriessnig at noe-lak.at (Sylvia Opriessnig)
Date: Tue, 30 Oct 2012 15:31:18 +0100
Subject: [R-sig-ME] R-square in lme
Message-ID: <B6D5D22DF5E8C94B90086FC29BCFAF520CE7789100@hosting-exch>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121030/1eb07e4f/attachment.pl>

From aghaynes at gmail.com  Tue Oct 30 15:59:22 2012
From: aghaynes at gmail.com (Alan Haynes)
Date: Tue, 30 Oct 2012 15:59:22 +0100
Subject: [R-sig-ME] R-square in lme
In-Reply-To: <B6D5D22DF5E8C94B90086FC29BCFAF520CE7789100@hosting-exch>
References: <B6D5D22DF5E8C94B90086FC29BCFAF520CE7789100@hosting-exch>
Message-ID: <CAPdSD+5tt9aBhK7N9WYOKZmGfCe-mMpC6S5ndE_0c5R5wLvw6A@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121030/27672b1d/attachment.pl>

From m.fairbrother at bristol.ac.uk  Tue Oct 30 17:25:02 2012
From: m.fairbrother at bristol.ac.uk (Malcolm Fairbrother)
Date: Tue, 30 Oct 2012 16:25:02 +0000
Subject: [R-sig-ME] weighting observations in a MCMCglmm model?
In-Reply-To: <mailman.3.1351508401.17103.r-sig-mixed-models@r-project.org>
References: <mailman.3.1351508401.17103.r-sig-mixed-models@r-project.org>
Message-ID: <48E524BA-71C5-46EB-9766-817D8AF31DB7@bristol.ac.uk>

I have actually been wondering just the same thing about MCMCglmm. (This question came up once before: http://permalink.gmane.org/gmane.comp.lang.r.lme4.devel/6095.)

Among other things, weights would allow for ordinal models to be fit MUCH faster. Combinations of covariates and outcomes could each be listed by row, with the row's weight reflecting the number of cases with each unique combination (as Rune suggested for clmm: http://permalink.gmane.org/gmane.comp.lang.r.lme4.devel/8744).

Anybody (probably Jarrod) know? If this isn't possible now, it would be useful inclusion in a future version (though maybe this would be more difficult than I realise).

Cheers,
Malcolm





> Date: Sun, 28 Oct 2012 21:25:58 -0700 (PDT)
> From: Giancarlo Sadoti <gcsadoti at yahoo.com>
> To: "r-sig-mixed-models at r-project.org" <r-sig-mixed-models at r-project.org>
> Subject: [R-sig-ME] weighting observations in a glmmadmb model?
> 
> Greetings list members,
> 
> Is there a way to weight observations in a glmmadmb model?  glm, lmer, etc. allow a "weights= ..." argument, but glmmadmb doesn't and I haven't found a work-around.  Many thanks.
> 
> Giancarlo


From David.Duffy at qimr.edu.au  Wed Oct 31 05:49:04 2012
From: David.Duffy at qimr.edu.au (David Duffy)
Date: Wed, 31 Oct 2012 14:49:04 +1000
Subject: [R-sig-ME] Heritability of ordinal data in MCMCglmm and
 estimatingfixed effects
In-Reply-To: <508E9660.70307@cebc.cnrs.fr>
References: <508E9660.70307@cebc.cnrs.fr>
Message-ID: <Pine.LNX.4.64.1210311346450.7839@orpheus.qimr.edu.au>

On Tue, 30 Oct 2012, Samantha Patrick wrote:

> Hi
> I am estimating the heritability of an ordinal trait using MCMCglmm and
> have come across two problems: one regarding heritability and one
> specific to ordinal data sets.
>
> _My data_
> Trait1 = ordinal score from 0 - 4
> Colony = factor with 2 options
> ID = repeated measures per individual (818 individuals)
>
> So the heritability:
>
> /posterior.heritability1.1 <- model2.1$VCV[, "animal"]/(model2.1$VCV[,
> "animal"]+ model2.1$VCV[, "ID"] + model2.1$VCV[, "units"]+1)/
> /posterior.mode(posterior.heritability1.1)/
> /h^2 = 0.21 (0.05- 0.45)/

Why are there repeated measures?  Is the between-occasion variation of
interest, or a nuisance?  That is, is animal/(animal+units) a better 
measure of h2?

> /model2.2<-MCMCglmm(Trait1~ Colony , random =~animal + BYEAR + MOTHER +
> ID, pedigree = Ped3, data = Data, prior = prior2.1,
> family='ordinal',burnin = 20000, nitt = 500000, thin = 200, pr=TRUE)/

doesn't work.

How many levels of BYEAR, how many obs per year, do you 
want a random regression on BYEAR (ie do you expect a linear 
relationship?)

> My second question is specific to ordinal analyses
>
> I need to extract one score per individual and I wondered if
> anyone knows if there is any methods for doing this? I can fit ID as a
> random effect but I am not sure this changes anything, and is associated
> with the curse of BLUPS.

BLUPs are what you want, curse them ;)

-- 
| David Duffy (MBBS PhD)                                         ,-_|\
| email: davidD at qimr.edu.au  ph: INT+61+7+3362-0217 fax: -0101  /     *
| Epidemiology Unit, Queensland Institute of Medical Research   \_,-._/
| 300 Herston Rd, Brisbane, Queensland 4029, Australia  GPG 4D0B994A v


From spatrick at cebc.cnrs.fr  Wed Oct 31 10:36:01 2012
From: spatrick at cebc.cnrs.fr (Samantha Patrick)
Date: Wed, 31 Oct 2012 10:36:01 +0100
Subject: [R-sig-ME] Heritability of ordinal data in MCMCglmm and
 estimatingfixed effects
In-Reply-To: <Pine.LNX.4.64.1210311346450.7839@orpheus.qimr.edu.au>
References: <508E9660.70307@cebc.cnrs.fr>
	<Pine.LNX.4.64.1210311346450.7839@orpheus.qimr.edu.au>
Message-ID: <5090F101.1060507@cebc.cnrs.fr>

Hi David

Le 31/10/2012 05:49, David Duffy a ?crit :
> On Tue, 30 Oct 2012, Samantha Patrick wrote:
>
>> Hi
>> I am estimating the heritability of an ordinal trait using MCMCglmm and
>> have come across two problems: one regarding heritability and one
>> specific to ordinal data sets.
>>
>> _My data_
>> Trait1 = ordinal score from 0 - 4
>> Colony = factor with 2 options
>> ID = repeated measures per individual (818 individuals)
>>
>> So the heritability:
>>
>> /posterior.heritability1.1 <- model2.1$VCV[, "animal"]/(model2.1$VCV[,
>> "animal"]+ model2.1$VCV[, "ID"] + model2.1$VCV[, "units"]+1)/
>> /posterior.mode(posterior.heritability1.1)/
>> /h^2 = 0.21 (0.05- 0.45)/
>
> Why are there repeated measures?  Is the between-occasion variation of
> interest, or a nuisance?  That is, is animal/(animal+units) a better 
> measure of h2?

 >> There are between 1-4 measures of Trait 1 per individual.  I have 
run the model using only the first measure per individual  (as in h2 = 
animal/(animal+units)).  It has little effect on the heritability.  I 
have kept in the repeated measures as they allow as to calculate 
consistent environmentally induced differences ( see 
http://www.wildanimalmodels.org/tiki-index.php?page=repeated%20measures), and 
as I understand, it is better to use the full data set and control for 
any non independence.
>
>> /model2.2<-MCMCglmm(Trait1~ Colony , random =~animal + BYEAR + MOTHER +
>> ID, pedigree = Ped3, data = Data, prior = prior2.1,
>> family='ordinal',burnin = 20000, nitt = 500000, thin = 200, pr=TRUE)/
>
> doesn't work.

 >>> In what way? Sorry I don't quite understand this...
>
> How many levels of BYEAR, how many obs per year, do you want a random 
> regression on BYEAR (ie do you expect a linear relationship?)

 >>> BYEAR is a factor with 27 levels; a quick summary observations per 
level:
0-5 obs = 3 levels
5-10 obs = 2 levels
20-50 obs = 10 levels
50-85 obs = 12 levels

There is no reason to suppose it would be a linear relationship; instead 
it is likely to represent cohort effects as a result of similarities 
between birds born in the same year so I have not tried to fit it as a 
random regression.

>> My second question is specific to ordinal analyses
>>
>> I need to extract one score per individual and I wondered if
>> anyone knows if there is any methods for doing this? I can fit ID as a
>> random effect but I am not sure this changes anything, and is associated
>> with the curse of BLUPS.
>
> BLUPs are what you want, curse them ;)
>
 >>> The problem is for Gaussian data, Individual would be fitted as a 
fixed effect in the model, such that in its simplest form the model 
would be:

Trait1~ Colony + ID

and then the parameter estimates are extracted for ID and these are used 
as the individual measures.  This does not involve taking residuals from 
the model so seems to be statistically more sound than using BLUPs.  
While the two are normally highly correlated, there are differences and 
it seems unwise to go back to a method that has received much criticism.

Many thanks for your comments

Sam

-- 

Dr Samantha Patrick
Post Doctoral Fellow
Centre d'Etudes Biologiques de Chiz? - CNRS
79360 Villiers-en-Bois
France
T:+33 5 49 09 78 46
M:+33 6 75 06 34 51
Skype: sammy_patrick
http://www.cebc.cnrs.fr/Fidentite/patrick/patrick.htm
http://www.researchgate.net/profile/Samantha_Patrick/


From r-sig-mixed-models at gjyp.nl  Wed Oct 31 11:14:17 2012
From: r-sig-mixed-models at gjyp.nl (r-sig-mixed-models at gjyp.nl)
Date: Wed, 31 Oct 2012 11:14:17 +0100
Subject: [R-sig-ME] lmer: No significant coefficients,
	but significant improvement of model fit?
Message-ID: <E1TTVJR-0004lN-Vu@fertilehosting.nl>

Hey all,

This is my first post - but I assume that like at other lists, brevity is appreciated, so I have a short version and a long version:

SHORT VERSION, QUESTIONS ONLY:

1) how is it possible that using lmer, none of the fixed effects has significant coefficients, yet the model with those parameters fits significantly better than a model without those parameters? Is this an example of why lmer didn\'t use to report p-values for the coefficients?
2) what do the slash and the colon mean exactly when specifying lmer models?

LONG VERSION WITH BACKGROUND:

I am unexperienced with mixed models, but I have a dataset that has several levels that needs to be analysed - and I \'always\' wanted to learn multilevel analysis anyway, so I decided this was a good occasion. However, there are no courses at hand in the near future, so I\'m trying to get there with online resources and some books (such as \"discovering statistics using R\" by Andy Field, and in a slightly different category, the Multilevel Analysis book by Joop and the one by Snijders & Bosker. However, apparently, I lack what it takes to autodidactically learn this :-/ So I apologise, but I decided to draw on your wisdom. I\'m also kind of hoping that doing multilevel analyses is a good way of learning how to do them.

I must admit that I don\'t feel like I master the lmer model formulation, but I found a post by Harold Doran [1] where he explains the lmer syntax. My data file is structured the same as the one he models in fm3, fm4 and fm5. I have the following variables (of interest):
* cannabisUse_bi: a factor with two levels, \"0\" and \"1\". \'0\' indicates no cannabis use in the past week; \'1\' indicates cannabis use in the past week. This is the dependent variable (i.e. the criterion).
* moment: a factor with two levels, \'before\' and \'after\'
* id.factor: a factor with 444 levels, the identification of each participants (note that there are quite a lot of missing values, only about 276 cases without missings)
* school: a factor with 8 levels, each representing the school that the participants attend
* cannabisShow: a factor with 2 levels, \'control\' and \'intervention\' - this reflects whether a participant received the \'intervention\', aimed to decrease cannabis use, or not. Participants in five schools received the intervention; participants in three other schools didn\'t.

Every person provided two datapoints (one before the intervention took place, and one after); there are several persons in a school; and there are several school in each condition (level) of cannabisShow.

As far as I understand, this translates to \"Moment is nested within person (\'id.factor\'), which is nested within school, which is nested within cannabisShow\" (not sure about that last bit).

Harold\'s post has a structure where he has \'year\' within \'student\' within \'school\'. For the sake of convenience, here\'s his model:

fm5 <- lmer(math ~ year +(year|schoolid/childid), egsingle, control=list(gradient = FALSE, niterEM = 0))

if I translate that to my situation, I get (also based on a number of online sources [2]):

rep_measures.new.moment  <- lmer(usedCannabis_bi ~ 1 + moment + (moment|school/id.factor), family=binomial(link = \"logit\"), data=dat.long);

(I left out the control statement, since this causes R to complain about unused parameters; the post was from 2006, so I guess lmer changed or something?)

Now, this model doesn\'t include the effect of the intervention, and if I include that, I get:

rep_measures.new.model <- lmer(usedCannabis_bi ~ 1 + moment * cannabisShow + (moment|school/id.factor), family=binomial(link = \"logit\"), data=dat.long);

If I compare these two models using Anova, the second one fits better (logLik from -182.02 to -166.68, ChiSq = 30.681, Df = 2, p = 2.177e-07). However, when you look at rep_measures.new.model, none of the fixed effects is significant. I may be completely wrong, but doesn\'t this mean that the cannabisShow variable, nor its interaction with measurement moment (i.e. \'time\'), contributes to explaining the dependent variable (i.e. cannabisUse_bi)?

(in fact, I\'m also a bit confused as to the p-values that lmer provides for the fixed effects. I thought that there were good reasons not to - and that lmer wasn\'t supposed to? [3] (I don\'t understand the post - I\'m sadly not a statistician - but I thought I got the gist) Apparently this changed . . . ?)

And now that I\'m mailing anyway: what is the difference between these two models?

rep_measures.new.model.1 <- lmer(usedCannabis_bi ~ 1 + moment * cannabisShow + (moment|school/id.factor), family=binomial(link = \"logit\"), data=dat.long);
rep_measures.new.model.2 <- lmer(usedCannabis_bi ~ 1 + moment * cannabisShow + (moment|id.factor:school), family=binomial(link = \"logit\"), data=dat.long);

R gives slightly (but only slightly) different coefficient estimates; but on the first one, he seems to understand that school is a level (with 8 values), where for the second one, this is apparently not specified . . . What\'s the difference between the slash and the colon for indicating levels (the levels have to be \'the other way around\', apparently?)?

I\'m sorry to bother the list with such basic questions. I\'ve been looking for a tutorial or explanation, but I\'ve only been able to find little bits of information that I pieced together into my current (lack of :-)) understanding . . .

Thank you in advance!

Gjalt-Jorn Peters


PS: I\'ve put the R script at http://sciencerep.org/files/7/the%20cannabis%20show%20-%20analyses.r
(the part I\'m talking about now starts after the line with \"###### Behaviour\", line 195 - the real analyses I\'m talking about now start at line 314)
This .R file downloads the data from http://sciencerep.org/files/7/the%20cannabis%20show%20-%20data.tsv

The output you should get is at http://sciencerep.org/files/7/the%20cannabis%20show%20-%20output.txt
(but the output file is kind of hard to interpret without the analyses file, as I didn\'t \"cat\" all comments)


[1] http://tolstoy.newcastle.edu.au/R/e2/help/06/10/3345.html
[2] http://www.rensenieuwenhuis.nl/r-sessions-17-generalized-multilevel-lme4/
    http://www.talkstats.com/showthread.php/14393-Need-help-with-lmer-model-specification-syntax-for-nested-mixed-model
    http://www.bodowinter.com/tutorial/bw_LME_tutorial.pdf
[3] https://stat.ethz.ch/pipermail/r-help/2006-May/094765.html


From highstat at highstat.com  Wed Oct 31 12:26:18 2012
From: highstat at highstat.com (Highland Statistics Ltd)
Date: Wed, 31 Oct 2012 11:26:18 +0000
Subject: [R-sig-ME] R-square in lme
Message-ID: <50910ADA.4090000@highstat.com>

From: Sylvia Opriessnig<Sylvia.Opriessnig at noe-lak.at>
To:"r-sig-mixed-models at r-project.org"
	<r-sig-mixed-models at r-project.org>
Subject: [R-sig-ME] R-square in lme
Message-ID: <B6D5D22DF5E8C94B90086FC29BCFAF520CE7789100 at hosting-exch>
Content-Type: text/plain

Dear Madam or Sir

Thank you very much for your replies of my former question concerning the calculating of standard deviation/variance in lme.

I would have one further question, maybe anyone can give me an answer of it?

Do you know whether there exists a way to calculate a value similar to R? in R or do you also think, that this does not make sense for mixed linear models?

------


See:

Measuring explained variation in linear mixed effects models
Xu (2002)
Statist. Med. 2003; 22:3527?3541 (DOI: 10.1002/sim.1572)


Alain




-- 

Dr. Alain F. Zuur
First author of:

1. Analysing Ecological Data (2007).
Zuur, AF, Ieno, EN and Smith, GM. Springer. 680 p.
URL:www.springer.com/0-387-45967-7


2. Mixed effects models and extensions in ecology with R. (2009).
Zuur, AF, Ieno, EN, Walker, N, Saveliev, AA, and Smith, GM. Springer.
http://www.springer.com/life+sci/ecology/book/978-0-387-87457-9


3. A Beginner's Guide to R (2009).
Zuur, AF, Ieno, EN, Meesters, EHWG. Springer
http://www.springer.com/statistics/computational/book/978-0-387-93836-3


4. Zero Inflated Models and Generalized Linear Mixed Models with R. (2012) Zuur, Saveliev, Ieno.
http://www.highstat.com/book4.htm

Other books:http://www.highstat.com/books.htm


Statistical consultancy, courses, data analysis and software
Highland Statistics Ltd.
6 Laverock road
UK - AB41 6FN Newburgh
Tel: 0044 1358 788177
Email:highstat at highstat.com
URL:www.highstat.com
URL:www.brodgar.com


From pablo.inchausti.f at gmail.com  Wed Oct 31 18:00:39 2012
From: pablo.inchausti.f at gmail.com (Pablo Inchausti)
Date: Wed, 31 Oct 2012 15:00:39 -0200
Subject: [R-sig-ME] problems fitting GLMM poisson with cross random effects
	in lme4 and glmmADMB
Message-ID: <CAGdDvs2B+gx50bUSNj-qZtGvgc0Zi4G=AywWM6V1X_yUHH5wkg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121031/baa65e8d/attachment.pl>

From pablo.inchausti.f at gmail.com  Wed Oct 31 17:56:43 2012
From: pablo.inchausti.f at gmail.com (Pablo Inchausti)
Date: Wed, 31 Oct 2012 14:56:43 -0200
Subject: [R-sig-ME] problems in fitting GLMM Poisson with crossed random
 effects in both lme4 and glmmADMB
Message-ID: <CAGdDvs3d_Cxp51k4jMr-AX6WnzFtArCh3AnUFbjcrMVpbhZXug@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121031/208cf884/attachment.pl>

From bates at stat.wisc.edu  Wed Oct 31 18:29:05 2012
From: bates at stat.wisc.edu (Douglas Bates)
Date: Wed, 31 Oct 2012 12:29:05 -0500
Subject: [R-sig-ME] problems fitting GLMM poisson with cross random
 effects in lme4 and glmmADMB
In-Reply-To: <CAGdDvs2B+gx50bUSNj-qZtGvgc0Zi4G=AywWM6V1X_yUHH5wkg@mail.gmail.com>
References: <CAGdDvs2B+gx50bUSNj-qZtGvgc0Zi4G=AywWM6V1X_yUHH5wkg@mail.gmail.com>
Message-ID: <CAO7JsnQtri3rp6=fOpYo2DGtjZwDqehwCrUpQOwb-YvUzSf=1w@mail.gmail.com>

On Wed, Oct 31, 2012 at 12:00 PM, Pablo Inchausti
<pablo.inchausti.f at gmail.com> wrote:
> Dear all,
> I am experiencing problems when trying to fit the following GLMM with
> library lme4:
> m5=with(DF3,lmer(n.spp~log(hs.arrastre+1)+zona+prof+SSTA+zona*log(hs.arrastre+1)+zona*SSTA+zona*prof+
> (1|a?o) +(1|grado),weight=n.lances,family="poisson"))
>
> The response variable are counts (number of species), and there are four
> explanatory variables with fixed effects: three continuous variables (SSTA,
> arrastre, prof) and one is a three-level factor (zona). There are two
> crossed (uncorrelated random effects): (1|a?o) with a?o having 24 levels;
> the other random effect (1|grado) has by coincidence also 24 levels. The DF
> has 419 rows and no missing values.
> The numbers of cases for each of the random effects are unbalanced but not
> zero:
>> with(DF2, table(a?o))
> 1984 1985 1987 1988 1989 1991 1992 1993 1994 1995 1996 1997 1998 1999 2000
> 2001 2002 2003 2005 2006 2007 2008 2009 2010
>    3       4       3       29    12     23      8        8      40   31
>   9      12   12         6     14   32       7      8       28      31
> 35     26    26     12
>> with(DF2, table(grado))
> 333 342 343 344 345 352 353 354 355 356 363 364 365 366 374 375 376 385 386
> 387 395 396 397 398
>   7    35    22  18    9    22   31    25  18  17    28   32  10     6
> 22  26   11   13   18  13      9     9   12   6
>> with(DF2, table(grado, a?o)) is very sparse, which is why I am trying to
> fit uncorrelated random effects.
>
> I have used the very same dataset, with the same model structure) for other
> analyses with response variables having Gaussian distribution and have had
> no problems at all.
>
> I invariably obtain the error message:
> Error in mer_finalize(ans) : Downdated X'X is not positive definite, 1.
> In addition: Warning messages:
> 1: In mer_finalize(ans) :
>   Cholmod warning 'not positive definite' at
> file:../Cholesky/t_cholmod_rowfac.c, line 432
> 2: In mer_finalize(ans) :
>   Cholmod warning 'not positive definite' at
> file:../Cholesky/t_cholmod_rowfac.c, line 432

> I have absolutely no idea how to interpret this message or resolve the
> error.

The error messages are coming from the sparse matrix library CHOLMOD.
One of the disadvantages of adopting such code in the Matrix package
for R is that it wants to provide its own error messages and without
considerable effort at rewriting it, which would need to be repeated
every time a new version is released, these messages show up as R
error messages.

The best thing to do is to trace the progress of the iterations in the
optimization of the parameter estimates.  You will likely find that
the fixed-effects parameters or the random effects are heading to
extreme values.

> After trying to fit the same model with library glmmAMDB, I obtain another
> (equally cryptical) error message:
> Error in II[, ii] = II[, ii] + REmat$codes[[i]] :
>   number of items to replace is not a multiple of replacement length
> In addition: Warning messages:
> 1: In glmmadmb(n.spp ~ log(hs.arrastre + 1) + zona + prof + SSTA +  :
>   NAs removed in constructing fixed-effect model frame: you should probably
> remove them manually, e.g. with na.omit()
> 2: In II[, ii] + REmat$codes[[i]] :
>   longer object length is not a multiple of shorter object length:
>
> I have tried many of the control options of either library (i.e. changing
> the # of iterations, of evaluations, etc) but the error messages remain
> unchanged.
>
> I would really appreciate if any of you could possible spare some minutes
> and suggest some alternative.
> Many thanks in advance,
> Cheers
>
>         [[alternative HTML version deleted]]
>
>
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>


From pablo.inchausti.f at gmail.com  Wed Oct 31 18:40:44 2012
From: pablo.inchausti.f at gmail.com (Pablo Inchausti)
Date: Wed, 31 Oct 2012 15:40:44 -0200
Subject: [R-sig-ME] problems fitting GLMM poisson with cross random
 effects in lme4 and glmmADMB
In-Reply-To: <CAO7JsnQtri3rp6=fOpYo2DGtjZwDqehwCrUpQOwb-YvUzSf=1w@mail.gmail.com>
References: <CAGdDvs2B+gx50bUSNj-qZtGvgc0Zi4G=AywWM6V1X_yUHH5wkg@mail.gmail.com>
	<CAO7JsnQtri3rp6=fOpYo2DGtjZwDqehwCrUpQOwb-YvUzSf=1w@mail.gmail.com>
Message-ID: <CAGdDvs1Cf8ZtpGOWBRvboC2=EKARAQp6ih=Z7bsqH90nef3bHw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121031/bb7f6c95/attachment.pl>

From bates at stat.wisc.edu  Wed Oct 31 18:56:00 2012
From: bates at stat.wisc.edu (Douglas Bates)
Date: Wed, 31 Oct 2012 12:56:00 -0500
Subject: [R-sig-ME] problems fitting GLMM poisson with cross random
 effects in lme4 and glmmADMB
In-Reply-To: <CAGdDvs1Cf8ZtpGOWBRvboC2=EKARAQp6ih=Z7bsqH90nef3bHw@mail.gmail.com>
References: <CAGdDvs2B+gx50bUSNj-qZtGvgc0Zi4G=AywWM6V1X_yUHH5wkg@mail.gmail.com>
	<CAO7JsnQtri3rp6=fOpYo2DGtjZwDqehwCrUpQOwb-YvUzSf=1w@mail.gmail.com>
	<CAGdDvs1Cf8ZtpGOWBRvboC2=EKARAQp6ih=Z7bsqH90nef3bHw@mail.gmail.com>
Message-ID: <CAO7JsnQcYXU=frOAh4QxOxod0+t=2u77ZogSiyYQ-rSE0mreAQ@mail.gmail.com>

On Wed, Oct 31, 2012 at 12:40 PM, Pablo Inchausti
<pablo.inchausti.f at gmail.com> wrote:
> Douglas,
> Many thanks for the speedy response.
> When I tried:
> m5=with(DF3,lmer(n.spp~log(hs.arrastre+1)+zona+prof+SSTA+zona*log(hs.arrastre+1)+zona*SSTA+zona*prof+
> (1|a?o)+(1|grado),weight=n.lances,family="poisson", verbose=T))
>   0:     1150.8846: 0.396545 0.388196  2.44097 0.0156075 -0.221623
> -0.0492026 -0.000271677 0.0909335 -0.0106744 -0.00526810 -0.161031
> -0.0626493 -0.000706752 -0.000404302
>   1:     1150.8846: 0.396545 0.388196  2.44097 0.0156075 -0.221623
> -0.0492026 -0.000271677 0.0909335 -0.0106744 -0.00526810 -0.161031
> -0.0626493 -0.000706752 -0.000404302
> Error in mer_finalize(ans) : Downdated X'X is not positive definite, 1.
> In addition: Warning messages:
> 1: In mer_finalize(ans) :
>   Cholmod warning 'not positive definite' at
> file:../Cholesky/t_cholmod_rowfac.c, line 432
> 2: In mer_finalize(ans) :
>   Cholmod warning 'not positive definite' at
> file:../Cholesky/t_cholmod_rowfac.c, line 432

The value before the ':' is the objective function, in this case the
deviance.  The parameters are listed after the deviance.  If I recall
correctly they are in the order of the standard deviations of the
random effects (both around 0.39) and then the fixed-effects
parameters.

> I cannot tell to the correspondence of the parameter values in the first two
> iteractions with the parameters in the model. Guessing that the 1150.8846 (a
> huge value?) corresponds to the intercept, I suppose that I could provide
> other initial values? I added: start=rep(0.5,15) since there are 15 columns
> in the failed output above, but I could not change the initial values.
> Any suggestions?
>
> Thanks in advance
> Cheers
> Pablo
>
>
> On 31 October 2012 15:29, Douglas Bates <bates at stat.wisc.edu> wrote:
>>
>> On Wed, Oct 31, 2012 at 12:00 PM, Pablo Inchausti
>> <pablo.inchausti.f at gmail.com> wrote:
>> > Dear all,
>> > I am experiencing problems when trying to fit the following GLMM with
>> > library lme4:
>> >
>> > m5=with(DF3,lmer(n.spp~log(hs.arrastre+1)+zona+prof+SSTA+zona*log(hs.arrastre+1)+zona*SSTA+zona*prof+
>> > (1|a?o) +(1|grado),weight=n.lances,family="poisson"))
>> >
>> > The response variable are counts (number of species), and there are four
>> > explanatory variables with fixed effects: three continuous variables
>> > (SSTA,
>> > arrastre, prof) and one is a three-level factor (zona). There are two
>> > crossed (uncorrelated random effects): (1|a?o) with a?o having 24
>> > levels;
>> > the other random effect (1|grado) has by coincidence also 24 levels. The
>> > DF
>> > has 419 rows and no missing values.
>> > The numbers of cases for each of the random effects are unbalanced but
>> > not
>> > zero:
>> >> with(DF2, table(a?o))
>> > 1984 1985 1987 1988 1989 1991 1992 1993 1994 1995 1996 1997 1998 1999
>> > 2000
>> > 2001 2002 2003 2005 2006 2007 2008 2009 2010
>> >    3       4       3       29    12     23      8        8      40   31
>> >   9      12   12         6     14   32       7      8       28      31
>> > 35     26    26     12
>> >> with(DF2, table(grado))
>> > 333 342 343 344 345 352 353 354 355 356 363 364 365 366 374 375 376 385
>> > 386
>> > 387 395 396 397 398
>> >   7    35    22  18    9    22   31    25  18  17    28   32  10     6
>> > 22  26   11   13   18  13      9     9   12   6
>> >> with(DF2, table(grado, a?o)) is very sparse, which is why I am trying
>> >> to
>> > fit uncorrelated random effects.
>> >
>> > I have used the very same dataset, with the same model structure) for
>> > other
>> > analyses with response variables having Gaussian distribution and have
>> > had
>> > no problems at all.
>> >
>> > I invariably obtain the error message:
>> > Error in mer_finalize(ans) : Downdated X'X is not positive definite, 1.
>> > In addition: Warning messages:
>> > 1: In mer_finalize(ans) :
>> >   Cholmod warning 'not positive definite' at
>> > file:../Cholesky/t_cholmod_rowfac.c, line 432
>> > 2: In mer_finalize(ans) :
>> >   Cholmod warning 'not positive definite' at
>> > file:../Cholesky/t_cholmod_rowfac.c, line 432
>>
>> > I have absolutely no idea how to interpret this message or resolve the
>> > error.
>>
>> The error messages are coming from the sparse matrix library CHOLMOD.
>> One of the disadvantages of adopting such code in the Matrix package
>> for R is that it wants to provide its own error messages and without
>> considerable effort at rewriting it, which would need to be repeated
>> every time a new version is released, these messages show up as R
>> error messages.
>>
>> The best thing to do is to trace the progress of the iterations in the
>> optimization of the parameter estimates.  You will likely find that
>> the fixed-effects parameters or the random effects are heading to
>> extreme values.
>>
>> > After trying to fit the same model with library glmmAMDB, I obtain
>> > another
>> > (equally cryptical) error message:
>> > Error in II[, ii] = II[, ii] + REmat$codes[[i]] :
>> >   number of items to replace is not a multiple of replacement length
>> > In addition: Warning messages:
>> > 1: In glmmadmb(n.spp ~ log(hs.arrastre + 1) + zona + prof + SSTA +  :
>> >   NAs removed in constructing fixed-effect model frame: you should
>> > probably
>> > remove them manually, e.g. with na.omit()
>> > 2: In II[, ii] + REmat$codes[[i]] :
>> >   longer object length is not a multiple of shorter object length:
>> >
>> > I have tried many of the control options of either library (i.e.
>> > changing
>> > the # of iterations, of evaluations, etc) but the error messages remain
>> > unchanged.
>> >
>> > I would really appreciate if any of you could possible spare some
>> > minutes
>> > and suggest some alternative.
>> > Many thanks in advance,
>> > Cheers
>> >
>> >         [[alternative HTML version deleted]]
>> >
>> >
>> > _______________________________________________
>> > R-sig-mixed-models at r-project.org mailing list
>> > https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>> >
>
>


From hughsturrock at hotmail.com  Wed Oct 31 19:18:44 2012
From: hughsturrock at hotmail.com (Hugh Sturrock)
Date: Wed, 31 Oct 2012 18:18:44 +0000
Subject: [R-sig-ME] lmer and log link
Message-ID: <DUB116-W132D420926E4BE6A37450C1C8610@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121031/8b028031/attachment.pl>

From mcasals at aspb.cat  Wed Oct 31 19:27:31 2012
From: mcasals at aspb.cat (=?ISO-8859-1?Q?Mart=ED_Casals?=)
Date: Wed, 31 Oct 2012 19:27:31 +0100
Subject: [R-sig-ME] convergence in GLMM (lme4 package)
In-Reply-To: <CADtmEn4GJDbnT96dXtm+TFKnL3xG0M_mUKhqOX__-rHQtcgfHQ@mail.gmail.com>
References: <CADtmEn5SjY2gqTfZ4JLZ5Wz=QcN+tvJMpC4RWkqGm9P5kaT9_A@mail.gmail.com>
	<loom.20121023T195352-241@post.gmane.org>
	<CADtmEn4GJDbnT96dXtm+TFKnL3xG0M_mUKhqOX__-rHQtcgfHQ@mail.gmail.com>
Message-ID: <CADtmEn42Kh-ryV7TZ6Voi7RkAuM1tVdkxSpQ8cdkFTZjaB39iw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121031/c89db334/attachment.pl>

From bates at stat.wisc.edu  Wed Oct 31 19:29:26 2012
From: bates at stat.wisc.edu (Douglas Bates)
Date: Wed, 31 Oct 2012 13:29:26 -0500
Subject: [R-sig-ME] lmer and log link
In-Reply-To: <DUB116-W132D420926E4BE6A37450C1C8610@phx.gbl>
References: <DUB116-W132D420926E4BE6A37450C1C8610@phx.gbl>
Message-ID: <CAO7JsnRiE_1cJUS=ucM3_XNyXJ5VPZ1afh-=jjQ58imWWBPntg@mail.gmail.com>

On Wed, Oct 31, 2012 at 1:18 PM, Hugh Sturrock <hughsturrock at hotmail.com> wrote:

> Hello all,

> I am running a lmer model with two random effect levels, household nested in village, with two categorical predictors and a binomial outcome. I would like to obtain risk ratios and so am using the term family=binomial(link=log). However, using this link doesn?t allow the model to converge properly and I get the following message:

> Error in
> mer_finalize(ans) :
>
>   mu[i]
> must be in the range (0,1): mu = 18.3133, i = 166

> As I understand it from posts elsewhere, this is due to the fact that one or more observations producing a linear predictor that, when mapped to a predicted probability, falls outside the admissible range of [0,1]. Does anyone know of a way to overcome this?Thank you!Hugh

I hate to sound facetious but the simple solution is to use a link
such as the logit or probit or cloglog or ... that restricts the value
of inverse link function to the interval [0,1].  It is unusual to use
the log link for a binomial response unless the values of the linear
predictor stay very small, in which case the log link is almost the
same as the logit link.


From dwinsemius at comcast.net  Wed Oct 31 19:30:55 2012
From: dwinsemius at comcast.net (David Winsemius)
Date: Wed, 31 Oct 2012 11:30:55 -0700
Subject: [R-sig-ME] lmer and log link
In-Reply-To: <DUB116-W132D420926E4BE6A37450C1C8610@phx.gbl>
References: <DUB116-W132D420926E4BE6A37450C1C8610@phx.gbl>
Message-ID: <662DABE0-CA3A-4A43-8FE2-3E52AECCA0BD@comcast.net>


On Oct 31, 2012, at 11:18 AM, Hugh Sturrock wrote:

> 
> Hello all,
> 
> 
> 
> I am running a lmer model with two random effect levels, household nested in village, with two categorical predictors and a binomial outcome. I would like to obtain risk ratios and so am using the term family=binomial(link=log).

Couldn't you use Poisson errors with a log link. I would think that should give you risk ratios and be a canonical link-error pairing.

> However, using this link doesn?t allow the model to converge properly and I get the following message:
> 
> 
> 
> Error in
> mer_finalize(ans) : 
> 
>  mu[i]
> must be in the range (0,1): mu = 18.3133, i = 166
> 
> 
> 
> As I understand it from posts elsewhere, this is due to the fact that one or more observations producing a linear predictor that, when mapped to a predicted probability, falls outside the admissible range of [0,1]. Does anyone know of a way to overcome this?Thank you!Hugh
> Hugh Sturrock 
> 
-- 

David Winsemius, MD
Alameda, CA, USA


From pablo.inchausti.f at gmail.com  Wed Oct 31 21:15:38 2012
From: pablo.inchausti.f at gmail.com (Pablo Inchausti)
Date: Wed, 31 Oct 2012 18:15:38 -0200
Subject: [R-sig-ME] problems fitting GLMM poisson with cross random
 effects in lme4 and glmmADMB
In-Reply-To: <CAO7JsnQcYXU=frOAh4QxOxod0+t=2u77ZogSiyYQ-rSE0mreAQ@mail.gmail.com>
References: <CAGdDvs2B+gx50bUSNj-qZtGvgc0Zi4G=AywWM6V1X_yUHH5wkg@mail.gmail.com>
	<CAO7JsnQtri3rp6=fOpYo2DGtjZwDqehwCrUpQOwb-YvUzSf=1w@mail.gmail.com>
	<CAGdDvs1Cf8ZtpGOWBRvboC2=EKARAQp6ih=Z7bsqH90nef3bHw@mail.gmail.com>
	<CAO7JsnQcYXU=frOAh4QxOxod0+t=2u77ZogSiyYQ-rSE0mreAQ@mail.gmail.com>
Message-ID: <CAGdDvs0pFQcHGpdUH0BG7F52vcGf0gW0Nar0KT=WWgChNs+=UA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121031/71177b2c/attachment.pl>

From lborger at cebc.cnrs.fr  Wed Oct 31 21:26:20 2012
From: lborger at cebc.cnrs.fr (lborger)
Date: Wed, 31 Oct 2012 21:26:20 +0100
Subject: [R-sig-ME] problems fitting GLMM poisson with cross
	random	effects in lme4 and glmmADMB
In-Reply-To: <CAGdDvs0pFQcHGpdUH0BG7F52vcGf0gW0Nar0KT=WWgChNs+=UA@mail.gmail.com>
References: <CAGdDvs2B+gx50bUSNj-qZtGvgc0Zi4G=AywWM6V1X_yUHH5wkg@mail.gmail.com>
	<CAO7JsnQtri3rp6=fOpYo2DGtjZwDqehwCrUpQOwb-YvUzSf=1w@mail.gmail.com>
	<CAGdDvs1Cf8ZtpGOWBRvboC2=EKARAQp6ih=Z7bsqH90nef3bHw@mail.gmail.com>
	<CAO7JsnQcYXU=frOAh4QxOxod0+t=2u77ZogSiyYQ-rSE0mreAQ@mail.gmail.com>
	<CAGdDvs0pFQcHGpdUH0BG7F52vcGf0gW0Nar0KT=WWgChNs+=UA@mail.gmail.com>
Message-ID: <WC20121031202620.940046@cebc.cnrs.fr>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121031/d56c56de/attachment.pl>

From andrewdigby at mac.com  Thu Nov  1 06:28:23 2012
From: andrewdigby at mac.com (Andrew Digby)
Date: Thu, 01 Nov 2012 18:28:23 +1300
Subject: [R-sig-ME] BUGS/JAGS: prior for a 2D random effect
Message-ID: <B5FFD280-C3D6-4CD4-A530-7F303E974BB8@mac.com>


I'm writing a hierarchical BUGS/JAGS model with two 'for' loops, and want to include nested random effects, a1 & a2 (nested in a1). But I can't work out how to specify the prior for the nested random effect. This doesn't work:

model{
	for (i in 1:N){
		for (j in 1:M){
			...
			eta[j,i] <- alpha + b[1]*Var1[j,i] + ... + a1[i] + a2[j,i]
  		}
	}

	for (i in 1:N){a1[i] ~ dnorm(0.0, tau1}    # Prior for random effect a1
       # This next part, specifying the prior for random effect a2, is wrong, but what should it be:?
	for (i in 1:N){
		for (j in 1:M){
			a2[j, i] ~ dnorm(0.0, tau2}
		}
	}
}

inits <- function(){
	list ( ...
		a1 = rnorm(N, 0, 1),
		a2 = matrix(rnorm(N*M, 0, 1), nrow=M, ncol=N),
		...
	)
}


Apologies for the lack of reproducible example, but this is just a syntax issue. How do I specify the prior for the nested random effect a2? I can't find the answer to this anywhere. I know I can reduce this to just one 'for' loop, but don't want to for other reasons (I later want to introduce an AR1 structure within one loop).

Thanks very much,

Andrew


From bbolker at gmail.com  Thu Nov  1 13:06:24 2012
From: bbolker at gmail.com (Ben Bolker)
Date: Thu, 01 Nov 2012 08:06:24 -0400
Subject: [R-sig-ME] convergence in GLMM (lme4 package)
In-Reply-To: <CADtmEn42Kh-ryV7TZ6Voi7RkAuM1tVdkxSpQ8cdkFTZjaB39iw@mail.gmail.com>
References: <CADtmEn5SjY2gqTfZ4JLZ5Wz=QcN+tvJMpC4RWkqGm9P5kaT9_A@mail.gmail.com>
	<loom.20121023T195352-241@post.gmane.org>
	<CADtmEn4GJDbnT96dXtm+TFKnL3xG0M_mUKhqOX__-rHQtcgfHQ@mail.gmail.com>
	<CADtmEn42Kh-ryV7TZ6Voi7RkAuM1tVdkxSpQ8cdkFTZjaB39iw@mail.gmail.com>
Message-ID: <509265C0.90602@gmail.com>

On 12-10-31 02:27 PM, Mart? Casals wrote:
> Hi Ben,
> Thank you very much for all your help, so far. Nonetheless, there is
> still something not working. If you could have a look at the following
> code, I would highly appreciate it. It's about how to count convergence
> problems of function glmer within a simulation. I tried to adapt your
> proposal to my models, but something's not working, probably to me lack
> of knowledge of functions like tryCatch and withCallingHandlers.

  Here's my attempt.
  A reproducible example would have been slightly more convenient --
I'm guessing a bit here.

options(warn=2)
nsim <- 1000  ## BMB: setting this to a parameter
warn<-rep(NA,nsim)
estglmer<-vector('list',nsim)
## BMB: it is marginally more efficient to pre-allocate
## lists (although prob doesn't
##  matter in this much case, glmer() is the slow part)

## don't know why estglmer needs names?

## The model to be fitted (Y, Category, fallswinner & ncombat are
##  variables in data frame dd)
modfun <- function(dat) glmer(Y~Category+fallswinner+(1|id),
       offset=(log(ncombat)),nAGQ=50,family="poisson",data=dat)

for(i in 1:nsim){
     # The data to be used
   ## nAGQ=50 is a little surprising.  Do you really need that much?
     estglmer[[i]]<-withCallingHandlers(
              tryCatch(modfun(alldata[[i]]),
                 error = function(e) {
                      warn[i] <<- paste("ERROR:",e$message)
                       NA
                   }),
                   warning = function(w) {
                        warn[i] <<- w$message
                        invokeRestart("muffleWarning")
                   })
}


> 
> 
> I'm thinking about the topic and I don't know if it?s useful to obtain
> the warnings/errors, because I should  look at each error and then I
> should decide what I can do.
> 
> I only want to inform aboutpercentage of convergence of GLMM, that is
> the converge is true or false.  I understand that a model is considered
> as not convergent  either if the estimation process did not converge or
> if the estimate or its standard error was not provided. For example, in
> some cases the parameter can be estimated but the estimation process was
> unable to provide a positive definite variance-covariance matrix of the
> parameters (problems with Hessian), mainly due to the instability of the
> model.
> 
> Thank you very much in advance for your suggestions.
> 
> Mart?
> 
> 
> 
> 2012/10/23 Mart? Casals <mcasals at aspb.cat <mailto:mcasals at aspb.cat>>
> 
>     Thank you so much Ben!!
> 
>     Mart?
> 
> 
>     2012/10/23 Ben Bolker <bbolker at gmail.com <mailto:bbolker at gmail.com>>
> 
>         Mart? Casals <mcasals at ...> writes:
> 
>         >
>         > I?m working on the simulation results and I would like to know the
>         > convergence of the GLMM model. For example, if I want to
>         obtain the
>         > converge in the glm case with R, I can extract:
>         >
>         > model1<-glm(................family=" ",data=)
>         >
>         > *model1$converged*
>         >
>         > [1] TRUE
>         >
>         > I don?t know if exist a similar function in the lme4 package
>         (glmer ).
>         >
> 
>           I think not.
>           I believe the only way to do this (it may have been discussed
>         before)
>         is to use options(warning=2) to promote warnings to errors, then
>         to use
>         tryCatch() etc. to intercept the errors and store the
>         information somewhere.
> 
>         http://comments.gmane.org/gmane.comp.lang.r.lme4.devel/8691
>         https://stat.ethz.ch/pipermail/r-help/2012-February/302767.html
> 
>           I've added a bit on this to http://glmm.wikidot.com/faq, since
>         it's
>         not the first time it has come up ...
> 
>          Ben Bolker
> 
>         _______________________________________________
>         R-sig-mixed-models at r-project.org
>         <mailto:R-sig-mixed-models at r-project.org> mailing list
>         https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> 
> 
> 
> 
>     -- 
>     Mart? Casals Toquero
> 
>     Centre d' Investigaci? Biom?dica d'Epidemiolog?a i Salut P?blica
> 
>     Ag?ncia de Salut P?blica de Barcelona
> 
>     Servei d' Epidemiologia
> 
>     Tel. 932384545 extensi?: 391
> 
>     mcasals at aspb.es <mailto:mcasals at aspb.es>
> 
> 
> 
> 
> -- 
> Mart? Casals Toquero
> 
> Centre d' Investigaci? Biom?dica d'Epidemiolog?a i Salut P?blica
> 
> Ag?ncia de Salut P?blica de Barcelona
> 
> Servei d' Epidemiologia
> 
> Tel. 932384545 extensi?: 391
> 
> mcasals at aspb.es <mailto:mcasals at aspb.es>


From hughsturrock at hotmail.com  Thu Nov  1 15:46:05 2012
From: hughsturrock at hotmail.com (Hugh Sturrock)
Date: Thu, 1 Nov 2012 07:46:05 -0700
Subject: [R-sig-ME] lmer and log link
In-Reply-To: <662DABE0-CA3A-4A43-8FE2-3E52AECCA0BD@comcast.net>
References: <DUB116-W132D420926E4BE6A37450C1C8610@phx.gbl>
	<662DABE0-CA3A-4A43-8FE2-3E52AECCA0BD@comcast.net>
Message-ID: <BLU0-SMTP67398693EF37E3117C17A2C8600@phx.gbl>

Thank you both for your speedy replies. Very helpful.
Hugh




On Oct 31, 2012, at 11:30, David Winsemius <dwinsemius at comcast.net> wrote:

> 
> On Oct 31, 2012, at 11:18 AM, Hugh Sturrock wrote:
> 
>> 
>> Hello all,
>> 
>> 
>> 
>> I am running a lmer model with two random effect levels, household nested in village, with two categorical predictors and a binomial outcome. I would like to obtain risk ratios and so am using the term family=binomial(link=log).
> 
> Couldn't you use Poisson errors with a log link. I would think that should give you risk ratios and be a canonical link-error pairing.
> 
>> However, using this link doesn?t allow the model to converge properly and I get the following message:
>> 
>> 
>> 
>> Error in
>> mer_finalize(ans) : 
>> 
>> mu[i]
>> must be in the range (0,1): mu = 18.3133, i = 166
>> 
>> 
>> 
>> As I understand it from posts elsewhere, this is due to the fact that one or more observations producing a linear predictor that, when mapped to a predicted probability, falls outside the admissible range of [0,1]. Does anyone know of a way to overcome this?Thank you!Hugh
>> Hugh Sturrock 
>> 
> -- 
> 
> David Winsemius, MD
> Alameda, CA, USA
> 
> 


From seth at swbigelow.net  Thu Nov  1 16:06:44 2012
From: seth at swbigelow.net (Seth W. Bigelow)
Date: Thu, 1 Nov 2012 11:06:44 -0400
Subject: [R-sig-ME] Contrasts among estimates of fixed effects
Message-ID: <00d501cdb842$83480560$89d81020$@net>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121101/a508d1eb/attachment.pl>

From seth at swbigelow.net  Thu Nov  1 20:00:57 2012
From: seth at swbigelow.net (Seth W. Bigelow)
Date: Thu, 1 Nov 2012 15:00:57 -0400
Subject: [R-sig-ME] Contrasts among estimates of fixed effects
In-Reply-To: <9B75E7CF385CB94EAD6587DD96AC2D9747A5C870@SFPCEXMBX3.sanfordhealth.org>
References: <00d501cdb842$83480560$89d81020$@net>
	<9B75E7CF385CB94EAD6587DD96AC2D9747A5C870@SFPCEXMBX3.sanfordhealth.org>
Message-ID: <000a01cdb863$3ae19db0$b0a4d910$@net>

Aha. That makes a lot of sense. As it turns out, there is an a priori reason
for thinking that variance may differ among Exams -- this is a forestry
study, and one of the criticisms of the kind of treatment I am investigating
is that it may 'homogenize' the forest. I see now that this is reflected in
much smaller variance for P1 and P5 (i.e., post-treatment) than for the P0,
'pre-treatment' exam.

I set the random term to '~Exam|SettingID', thus estimating separate
variance for each level of Exam:

m1 <- lme(BA ~ Exam, data=s2, random = ~Exam|SettingID, method="ML")

Then compared the likelihood to that of the lumped-variance model --

m0 <- lme(BA ~ Exam, data=s2, random = ~1|SettingID, method="ML")
anova(m0,m1)
  Model df      AIC      BIC    logLik   Test  L.Ratio p-value
m0     1  5 1758.785 1775.072 -874.3924                        
m1     2 10 1678.630 1711.205 -829.3151 1 vs 2 90.15449  <.0001

Result is that the separate-variance model is massively more likely than the
pooled variance model. And when I rerun the separate-variance model under
restricted likelihood then apply the desired contrast statement, 

> contrast(m2, list(Exam='P1'),list(Exam='P5'))

lme model parameter contrast

   Contrast     S.E.     Lower     Upper    t  df Pr(>|t|)
1 -4.013438 1.179034 -6.324301 -1.702574 -3.4 182    8e-04

Voila! The contrast is significant! I feel that is a reasonably defensible
procedure. Thank you very much, Paul Thompson, for providing the insights to
set me in the right direction. --Seth W. Bigelow




-----Original Message-----
From: Thompson,Paul [mailto:Paul.Thompson at SanfordHealth.org] 
Sent: Thursday, November 01, 2012 11:23 AM
To: Seth W. Bigelow
Subject: RE: [R-sig-ME] Contrasts among estimates of fixed effects

I don't use R, but do a lot of stuff with contrasts in SAS. So, here are my
comments.

When you have a model with three levels like this, you construct an error
estimate from all 3. This error estimate is used to assess the significance
of the difference between levels. If you exclude a level as you do with a t
test involve P1-P5, you are constructing a different error term. My
suspicion in this case is that the within cell variability for P0 is higher
than for P1 and P5. If that is the case, then you would obtain the results
that you see. If the within cell variability is HUGELY greater, you may be
justified in looking at P1-P5 alone.

Otherwise, I think that the contrast approach is the better one. You
designed the experiment with 3 levels, and all should contribute to the
error term, as is the case with a contrast evaluation of the differences
between groups.

-----Original Message-----
From: r-sig-mixed-models-bounces at r-project.org
[mailto:r-sig-mixed-models-bounces at r-project.org] On Behalf Of Seth W.
Bigelow
Sent: Thursday, November 01, 2012 10:07 AM
To: r-sig-mixed-models at r-project.org
Subject: [R-sig-ME] Contrasts among estimates of fixed effects

Hello mixed-modelers:

 

I am confused about detection of differences among fixed effect estimates in
mixed models. I am using lme() to compare the effect of the factor Exam (3
levels: P0,P1,P5) on the continuous variable BA. Measurements were done on
64 Plots. This is modeled with the statement m0 <- BA~Exam, data.,
random=~1|plot.  Summary(m0) tells me that Exam has a highly significant
effect, and that both P1 and P5 differ highly significantly from P0, but not
whether P1 and P5 differ. If I use a contrast statement ("library(contrast),
contrast(m0, list(Exam='P1'), list(Exam='P5'), the contrast is not
significant (p=0.16).  However, if I just use a paired t-test, the
difference is significant at p=0.001. I also get significant results with
lme if I just delete the 'P0' level. I would be grateful if anyone could
point me in the right direction for making a robust (yet sensitive)
determination of whether these factor levels differ. I possess a copy of the
Ur-text for R mixed models (i.e., Pinheiro & Bates) but it has not yet
provided insight. Appreciatively, Seth W. Bigelow

 

 

Linear mixed-effects model fit by REML

 Data: s2 

       AIC      BIC    logLik

  1746.913 1763.122 -868.4565

 

Random effects:

 Formula: ~1 | Plot

        (Intercept) Residual

StdDev:      25.779 16.18827

 

Fixed effects: BA ~ Exam 

                Value                    Std.Error  DF   t-value p-value

(Intercept)  72.01422  3.805048 126 18.925968   0e+00

ExamP1      -15.01266  2.861708 126 -5.246047   0e+00

ExamP5      -10.99922  2.861708 126 -3.843585   2e-04

 Correlation: 

       (Intr) ExamP1

ExamP1 -0.376       

ExamP5 -0.376  0.500

 

Standardized Within-Group Residuals:

        Min          Q1         Med          Q3         Max 

-1.74478652 -0.54972545  0.02464379  0.41020121  3.24236603 

 

Number of Observations: 192

Number of Groups: 64 

 

CONTRAST statement

lme model parameter contrast

 

   Contrast     S.E.     Lower    Upper    t  df Pr(>|t|)

1 -4.013438 2.861708 -9.622282 1.595407 -1.4 187   0.1624


	[[alternative HTML version deleted]]

_______________________________________________
R-sig-mixed-models at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
-----------------------------------------------------------------------
Confidentiality Notice: This e-mail message, including a...{{dropped:7}}


From markpayneatwork at gmail.com  Fri Nov  2 10:23:02 2012
From: markpayneatwork at gmail.com (Mark Payne)
Date: Fri, 2 Nov 2012 10:23:02 +0100
Subject: [R-sig-ME] Specifying random effects structures (in mcgv::gamm)
Message-ID: <CAGBzUO_qmNvUeqH7kuOaOPBdWJmWYe1Fxc=m33h1Gp-RQY7sHg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121102/09bc8f27/attachment.pl>

From valerio.bartolino at gmail.com  Fri Nov  2 11:10:42 2012
From: valerio.bartolino at gmail.com (Valerio Bartolino)
Date: Fri, 2 Nov 2012 11:10:42 +0100
Subject: [R-sig-ME] Specifying random effects structures (in mcgv::gamm)
In-Reply-To: <CAGBzUO_qmNvUeqH7kuOaOPBdWJmWYe1Fxc=m33h1Gp-RQY7sHg@mail.gmail.com>
References: <CAGBzUO_qmNvUeqH7kuOaOPBdWJmWYe1Fxc=m33h1Gp-RQY7sHg@mail.gmail.com>
Message-ID: <CAKKTewyQec2qiV6MzWxPyQw24XVLYkMS0KYF4Nm=ZSr7fs3jsA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121102/bfa2798b/attachment.pl>

From spatrick at cebc.cnrs.fr  Fri Nov  2 11:43:15 2012
From: spatrick at cebc.cnrs.fr (Samantha Patrick)
Date: Fri, 02 Nov 2012 11:43:15 +0100
Subject: [R-sig-ME] Heritability of ordinal data in MCMCglmm and
 estimatingfixed effects
In-Reply-To: <WC20121102075011.02007E@cebc.cnrs.fr>
References: <WC20121102075011.02007E@cebc.cnrs.fr>
Message-ID: <5093A3C3.7040005@cebc.cnrs.fr>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121102/f9cd9009/attachment.pl>

From Julie.Black at jncc.gov.uk  Fri Nov  2 11:14:26 2012
From: Julie.Black at jncc.gov.uk (Julie Black)
Date: Fri, 2 Nov 2012 10:14:26 +0000
Subject: [R-sig-ME] unsubscribe please
Message-ID: <FBB9A1B00948744EA2F9958C8C0B0486CB9A@Ex2k10Ab.green.jncc.gov.uk>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121102/b34ef8d8/attachment.pl>

From smckinney at bccrc.ca  Fri Nov  2 18:56:00 2012
From: smckinney at bccrc.ca (Steven McKinney)
Date: Fri, 2 Nov 2012 10:56:00 -0700
Subject: [R-sig-ME] unsubscribe please
In-Reply-To: <FBB9A1B00948744EA2F9958C8C0B0486CB9A@Ex2k10Ab.green.jncc.gov.uk>
References: <FBB9A1B00948744EA2F9958C8C0B0486CB9A@Ex2k10Ab.green.jncc.gov.uk>
Message-ID: <DCE81E14EB74504B971DAD4D2DB0356B0CB437E145@crcmail4.BCCRC.CA>

Dear Dr. Black

To unsubscribe, visit URL

https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models

Look for the box at the bottom labeled

"To unsubscribe from R-sig-mixed-models, get a password reminder, or change your subscription options enter your subscription email address: "

drop your email address in there.

HTH

Steven McKinney

________________________________________
From: r-sig-mixed-models-bounces at r-project.org [r-sig-mixed-models-bounces at r-project.org] On Behalf Of Julie Black [Julie.Black at jncc.gov.uk]
Sent: November 2, 2012 3:14 AM
To: 'R-sig-mixed-models at r-project.org'
Subject: [R-sig-ME] unsubscribe please

Dr Julie Black
Seabirds and Cetaceans
Joint Nature Conservation Committee
Inverdee House
Baxter Street
Aberdeen AB11 9QA

Tel: +44(0)1224 266566
Email: julie.black at jncc.gov.uk
Website: http://jncc.defra.gov.uk/page-1414


_____________________________________________________________________
The Joint Nature Conservation Committee (JNCC) is the statutory adviser to Government on UK and international nature conservation, on behalf of the Council for Nature Conservation and the Countryside, the Countryside Council for Wales, Natural England and Scottish Natural Heritage.  Its work contributes to maintaining and enriching biological diversity, conserving geological features and sustaining natural systems.

JNCC SUPPORT CO. Registered in England and Wales, company no. 05380206. Registered office:  Monkstone House, City Road, Peterborough, Cambridgeshire PE1 1JY

If you have a Freedom of Information/Environmental Information request please refer to our website page

This message has been checked for all known viruses by JNCC delivered through the MessageLabs Virus Control Centre.
        [[alternative HTML version deleted]]

_______________________________________________
R-sig-mixed-models at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models


From David.Duffy at qimr.edu.au  Sun Nov  4 23:30:51 2012
From: David.Duffy at qimr.edu.au (David Duffy)
Date: Mon, 5 Nov 2012 08:30:51 +1000
Subject: [R-sig-ME] Heritability of ordinal data in MCMCglmm and
 estimatingfixed effects
In-Reply-To: <5093A3C3.7040005@cebc.cnrs.fr>
References: <WC20121102075011.02007E@cebc.cnrs.fr>
	<5093A3C3.7040005@cebc.cnrs.fr>
Message-ID: <Pine.LNX.4.64.1211050804300.32488@orpheus.qimr.edu.au>

On Fri, 2 Nov 2012, Samantha Patrick wrote:

> The pearson's correlations between observations ranges from 0.18 - 0.75, 
> depending on the year of testing (average 0.48; one year has a very low
> repeatability).
>
> One of the reasons why I question whether using a Gaussian distribution 
> (fitting a LMM) is correct is that the Mother- Offspring (M-O), father- 
> offspring (F-O) and sib-sib (S-S)regressions all have
> a Pearson's R2 <0.05.  Using polychoric correlations (I ran these in the 
> polycor package but as I understand it will run the same test?)

Yes.

> [polychoric r's compared to Pearson r's] are very different:
>
> M-O = 0.34
> F-O = 0.40
> S-S = 0.13
>
> The conclusions seems to be that the best model to estimate heritability 
> would be to fit the first observation per individual, such that:
>
> Trait1~ Colony, random =~animal + BYEAR
>
> and examine the models with and without BYEAR, fitted in MCMCglmm. I can then 
> use repeated measures to
> estimate the repeatabilities and extract the blups or single scores per 
> individual using an IRT model.

The alternative is the full multivariate genetic (or even genetic time 
series model[1]), where you could see if the between-occasion correlations 
are genetic or environmental (the latter may include measurement error). 
This should run in MCMCglmm as an ordinal model.  You can test if the 
covariances have a simple structure as under a straight measurement error 
model.  If the between-occasion correlations average ~0.5 you should have 
OK power I think.

[1] eg 
http://www.tweelingenregister.org/nederlands/verslaggeving/NTR_publicaties/Boomsma_BG_1987.pdf

-- 
| David Duffy (MBBS PhD)                                         ,-_|\
| email: davidD at qimr.edu.au  ph: INT+61+7+3362-0217 fax: -0101  /     *
| Epidemiology Unit, Queensland Institute of Medical Research   \_,-._/
| 300 Herston Rd, Brisbane, Queensland 4029, Australia  GPG 4D0B994A v


From gjalt-jorn at behaviorchange.eu  Mon Nov  5 16:03:27 2012
From: gjalt-jorn at behaviorchange.eu (Gjalt-Jorn Peters)
Date: Mon, 05 Nov 2012 16:03:27 +0100
Subject: [R-sig-ME] lmer formula specification
Message-ID: <5097D53F.8090804@behaviorchange.eu>

Dear all,

I posted a question last week, but I haven't received any replies - I'm 
not sure why (because there were no replies :-)), but hereby I try 
again, this time taking it one question at a time.

I don't manage to find a clear explanation of the lmer model 
specification syntax. I haven't been able to find a webpage explaining 
this. I did find some archived posts of this list, and a variety of 
webpages, but some resources seem outdated, and explanations often seem 
to assume proficiency with mixed models and/or prior knowledge of some 
parts of the specification. Which is a bit of an obstacle when you're 
new to both R and lmer :-)

Did I just overlook a resource, or does nothing exist yet and is this 
knowledge indeed kind of fragmented over the internet? I've been 
struggling with this for a few weeks now (not full-time though :-)), but 
perhaps I'm missing crucial search terms or something.

If no source like this exists yet, could somebody perhaps correct my 
inferences? If one or more of you are willing to provide some feedback, 
I can hopefully write a tutorial/webpage thing (similar to, e.g. 
http://www.rensenieuwenhuis.nl/r-sessions-16-multilevel-model-specification-lme4/, 
but a bit more complete, and similar to Douglas Bates' article at 
http://cran.r-project.org/doc/Rnews/Rnews_2005-1.pdf, but a bit more 
geared towards relative lay people). From a variety of sources, I pieced 
together the following.

The basic form is 'criterion ~ formula', where formula specifies the 
model you use to predict the criterion. This model consists of one or 
more terms separated by plusses (+). A term can be:
-- 1 -> specifies that the intercept should be estimated. Is in fact 
optional as the intercept is always estimated;
-- a variable name >- specifies that coefficient of that variable should 
be estimated (i.e. its slope);
-- an interaction term, consisting of two or more variable names 
separated by colons -> specifies that the interactions between all those 
variables should be estimated, as well as their regular coefficients;
-- a specification of random effects, which can take a number of forms:
---- (1 | variable name) -> for each level of variable name, random 
intercepts are estimated
---- (variable name 1 | variable name 2) -> for each level of variable 
name 2, random slopes are estimated for variable name 1, and random 
intercepts are estimated (note: '1 + ' implicit, see first bullet);
---- (0 + variable name 1 | variable name 2) -> for each level of 
variable name 2, random slopes are estimated for variable name 1, but 
only one (fixed) intercept is estimated;
---- (variable name 1 + variable 2 | variable name 3) -> for each level 
of variable name 3, random slopes are estimated for variable name 1 and 
variable name 2, and random intercepts are estimated;
---- (variable name 1 | variable name 3 : variable name 2) -> for each 
unique combination of levels of variable name 2 and variable name 3 
(where variable name 3 is the higher level), random slopes are estimated 
for variable name 1;
---- (variable name 1 | variable name 2 / variable name 3) -> for each 
level of variable name 2, which is nested within variable name 3, random 
slopes are estimated for variable name 1;

The next step would be to generate a series of potential scenarios and 
providing syntax for each scenario, like Rense Nieuwenhuis does at 
http://www.rensenieuwenhuis.nl/r-sessions-16-multilevel-model-specification-lme4/.

I hope somebody either knows a resource that roughly does this, or 
thinks it may be nice to help make something like this!

Kind regards, and thank you in advance,

Gjalt-Jorn Peters


From aghaynes at gmail.com  Mon Nov  5 16:50:56 2012
From: aghaynes at gmail.com (Alan Haynes)
Date: Mon, 5 Nov 2012 16:50:56 +0100
Subject: [R-sig-ME] lmer formula specification
In-Reply-To: <5097D53F.8090804@behaviorchange.eu>
References: <5097D53F.8090804@behaviorchange.eu>
Message-ID: <CAPdSD+6OHGEgj=3y1y0Y=QCpdk5AyK4omcmC3eM61eACkkd83Q@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121105/29a77d1d/attachment.pl>

From seth at swbigelow.net  Mon Nov  5 17:24:36 2012
From: seth at swbigelow.net (Seth W. Bigelow)
Date: Mon, 5 Nov 2012 11:24:36 -0500
Subject: [R-sig-ME] glmmADMB random interaction effects and likelihood
	estimates
Message-ID: <002501cdbb72$0cd00e40$26702ac0$@net>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121105/83805662/attachment.pl>

From mcasals at aspb.cat  Mon Nov  5 17:59:34 2012
From: mcasals at aspb.cat (=?ISO-8859-1?Q?Mart=ED_Casals?=)
Date: Mon, 5 Nov 2012 17:59:34 +0100
Subject: [R-sig-ME] convergence in GLMM (lme4 package)
In-Reply-To: <509265C0.90602@gmail.com>
References: <CADtmEn5SjY2gqTfZ4JLZ5Wz=QcN+tvJMpC4RWkqGm9P5kaT9_A@mail.gmail.com>
	<loom.20121023T195352-241@post.gmane.org>
	<CADtmEn4GJDbnT96dXtm+TFKnL3xG0M_mUKhqOX__-rHQtcgfHQ@mail.gmail.com>
	<CADtmEn42Kh-ryV7TZ6Voi7RkAuM1tVdkxSpQ8cdkFTZjaB39iw@mail.gmail.com>
	<509265C0.90602@gmail.com>
Message-ID: <CADtmEn7XxYn_D4zmL3MyMO6H=qXY4rVQvkYo3WPuUPPB5q804A@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121105/b9d97ade/attachment.pl>

From gjalt-jorn at behaviorchange.eu  Mon Nov  5 18:04:01 2012
From: gjalt-jorn at behaviorchange.eu (Gjalt-Jorn Peters)
Date: Mon, 05 Nov 2012 18:04:01 +0100
Subject: [R-sig-ME] lmer formula specification
In-Reply-To: <CAPdSD+6OHGEgj=3y1y0Y=QCpdk5AyK4omcmC3eM61eACkkd83Q@mail.gmail.com>
References: <5097D53F.8090804@behaviorchange.eu>
	<CAPdSD+6OHGEgj=3y1y0Y=QCpdk5AyK4omcmC3eM61eACkkd83Q@mail.gmail.com>
Message-ID: <5097F181.9050801@behaviorchange.eu>

Dear Alan,

this is great, thank you!!! I will add a comment to Nieuwenhuis' blog 
linking to that page to help future searchers. Thank you very much again!
Kind regards,

Gjalt-Jorn Peters

On 05-11-2012 16:50, Alan Haynes wrote:
> Gjalt-Jorn,
>
> You might want to check out the Model specification section of 
> http://glmm.wikidot.com/faq
>
> Between this and the Nieuwenhuis link you probably have everything you 
> need...
>
> HTH
>
> Alan
>
> --------------------------------------------------
> Email: aghaynes at gmail.com <mailto:aghaynes at gmail.com>
> Mobile: +41794385586
> Skype: aghaynes
>
>
> On 5 November 2012 16:03, Gjalt-Jorn Peters 
> <gjalt-jorn at behaviorchange.eu <mailto:gjalt-jorn at behaviorchange.eu>> 
> wrote:
>
>     Dear all,
>
>     I posted a question last week, but I haven't received any replies
>     - I'm not sure why (because there were no replies :-)), but hereby
>     I try again, this time taking it one question at a time.
>
>     I don't manage to find a clear explanation of the lmer model
>     specification syntax. I haven't been able to find a webpage
>     explaining this. I did find some archived posts of this list, and
>     a variety of webpages, but some resources seem outdated, and
>     explanations often seem to assume proficiency with mixed models
>     and/or prior knowledge of some parts of the specification. Which
>     is a bit of an obstacle when you're new to both R and lmer :-)
>
>     Did I just overlook a resource, or does nothing exist yet and is
>     this knowledge indeed kind of fragmented over the internet? I've
>     been struggling with this for a few weeks now (not full-time
>     though :-)), but perhaps I'm missing crucial search terms or
>     something.
>
>     If no source like this exists yet, could somebody perhaps correct
>     my inferences? If one or more of you are willing to provide some
>     feedback, I can hopefully write a tutorial/webpage thing (similar
>     to, e.g.
>     http://www.rensenieuwenhuis.nl/r-sessions-16-multilevel-model-specification-lme4/,
>     but a bit more complete, and similar to Douglas Bates' article at
>     http://cran.r-project.org/doc/Rnews/Rnews_2005-1.pdf, but a bit
>     more geared towards relative lay people). From a variety of
>     sources, I pieced together the following.
>
>     The basic form is 'criterion ~ formula', where formula specifies
>     the model you use to predict the criterion. This model consists of
>     one or more terms separated by plusses (+). A term can be:
>     -- 1 -> specifies that the intercept should be estimated. Is in
>     fact optional as the intercept is always estimated;
>     -- a variable name >- specifies that coefficient of that variable
>     should be estimated (i.e. its slope);
>     -- an interaction term, consisting of two or more variable names
>     separated by colons -> specifies that the interactions between all
>     those variables should be estimated, as well as their regular
>     coefficients;
>     -- a specification of random effects, which can take a number of
>     forms:
>     ---- (1 | variable name) -> for each level of variable name,
>     random intercepts are estimated
>     ---- (variable name 1 | variable name 2) -> for each level of
>     variable name 2, random slopes are estimated for variable name 1,
>     and random intercepts are estimated (note: '1 + ' implicit, see
>     first bullet);
>     ---- (0 + variable name 1 | variable name 2) -> for each level of
>     variable name 2, random slopes are estimated for variable name 1,
>     but only one (fixed) intercept is estimated;
>     ---- (variable name 1 + variable 2 | variable name 3) -> for each
>     level of variable name 3, random slopes are estimated for variable
>     name 1 and variable name 2, and random intercepts are estimated;
>     ---- (variable name 1 | variable name 3 : variable name 2) -> for
>     each unique combination of levels of variable name 2 and variable
>     name 3 (where variable name 3 is the higher level), random slopes
>     are estimated for variable name 1;
>     ---- (variable name 1 | variable name 2 / variable name 3) -> for
>     each level of variable name 2, which is nested within variable
>     name 3, random slopes are estimated for variable name 1;
>
>     The next step would be to generate a series of potential scenarios
>     and providing syntax for each scenario, like Rense Nieuwenhuis
>     does at
>     http://www.rensenieuwenhuis.nl/r-sessions-16-multilevel-model-specification-lme4/.
>
>     I hope somebody either knows a resource that roughly does this, or
>     thinks it may be nice to help make something like this!
>
>     Kind regards, and thank you in advance,
>
>     Gjalt-Jorn Peters
>
>     _______________________________________________
>     R-sig-mixed-models at r-project.org
>     <mailto:R-sig-mixed-models at r-project.org> mailing list
>     https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>
>


From highstat at highstat.com  Mon Nov  5 19:55:07 2012
From: highstat at highstat.com (Highland Statistics Ltd)
Date: Mon, 05 Nov 2012 20:55:07 +0200
Subject: [R-sig-ME] Mixed modelling course with R in Portugal
Message-ID: <50980B8B.5000408@highstat.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121105/50fd352f/attachment.pl>

From steve.taylor at aut.ac.nz  Tue Nov  6 03:21:28 2012
From: steve.taylor at aut.ac.nz (Steve Taylor)
Date: Tue, 6 Nov 2012 02:21:28 +0000
Subject: [R-sig-ME] EMMEANS - Estimated Marginal Means
Message-ID: <CCE952776B6679469977532BD863C39C2E3BA85B@Lewis.autuni.aut.ac.nz>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121106/0e46154e/attachment.pl>

From jfox at mcmaster.ca  Tue Nov  6 03:59:17 2012
From: jfox at mcmaster.ca (John Fox)
Date: Mon, 05 Nov 2012 21:59:17 -0500
Subject: [R-sig-ME] EMMEANS - Estimated Marginal Means
In-Reply-To: <CCE952776B6679469977532BD863C39C2E3BA85B@Lewis.autuni.aut.ac.nz>
References: <CCE952776B6679469977532BD863C39C2E3BA85B@Lewis.autuni.aut.ac.nz>
Message-ID: <web-431104263@cgpsrv2.cis.mcmaster.ca>

Dear Steve,

You might a look at the effect(), Effect(), and allEffects() functions in the effects package, and see whether they do what you want.

Best,
 John

------------------------------------------------
John Fox
Sen. William McMaster Prof. of Social Statistics
Department of Sociology
McMaster University
Hamilton, Ontario, Canada
http://socserv.mcmaster.ca/jfox/
	
On Tue, 6 Nov 2012 02:21:28 +0000
 Steve Taylor <steve.taylor at aut.ac.nz> wrote:
> Is there an easy way to get estimates of marginal means, with standard errors, from a model fitted using lmer?  i.e. something like the output of the EMMEANS option found in SAS and SPSS.
> 
> cheers,
>     Steve
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models


From bbolker at gmail.com  Tue Nov  6 14:32:15 2012
From: bbolker at gmail.com (Ben Bolker)
Date: Tue, 6 Nov 2012 13:32:15 +0000 (UTC)
Subject: [R-sig-ME]
	=?utf-8?q?glmmADMB_random_interaction_effects_and_like?=
	=?utf-8?q?lihood=09estimates?=
References: <002501cdbb72$0cd00e40$26702ac0$@net>
Message-ID: <loom.20121106T141321-996@post.gmane.org>

Seth W. Bigelow <seth at ...> writes:

> Dear list: I'm (still) working on a model of snag (dead tree) abundance
> before, after, & 5 yr after forest treatments using negative binomial
> distribution with glmmADMB. The data suggest that variance may differ
> sharply before and after treatment (factor variable 'time', values 1/2/3),
> so I have tried specifying the random term to model variance within time.
> e.g., glmmadmb(snag ~ time + Ecozone + (time|plot)), where Ecozone is a
> factor variable which takes values East or West, and 'plot' is a subject
> variable. The issue is that log-likelihood does not change whether I use
> (1|plot) or (time|plot). Am I missing something obvious, or is there a bug
> in the way likelihood is being calculated/reported?
> 
> Appreciatively, Seth W. Bigelow
> 
> glmmadmb(formula = snag ~ time + Ecozone + (1 | SettingID), data = l2, 
>     family = "nbinom1", zeroInflation = F)

  [snip]
 
> Number of observations: total=192, SettingID=64 
> Random effect variance(s):
> Group=SettingID

>             Variance StdDev
> (Intercept)     2.37   1.54
> 
> Negative binomial dispersion parameter: 1.812 (std. err.: 0.33774)
> 
> Log-likelihood: -255.758
> 
> glmmadmb(formula = snag ~ time + Ecozone + (time | SettingID), 
>     data = l2, family = "nbinom1", zeroInflation = F)
> 
  [snip]

> Random effect variance(s):
> 
> Group=SettingID
> 
>              Variance    StdDev
> (Intercept) 2.370e+00 1.5396428
> time2       1.765e-07 0.0004201
> time3       8.542e-08 0.0002923

> Negative binomial dispersion parameter: 1.812 (std. err.: 0.33774)
> 
> Log-likelihood: -255.758
> 

  My guess here is that the log-likelihood differs only by a tiny
amount, because the estimated variances for time2 and time3 are
about 7-8 orders of magnitude less than the intercept variance.
The basic issue is that in a data set of this size (not tiny, but
not huge and quite noisy), you just don't have much power to detect
differences in slope among plots.

  You got a bit lucky getting the models to fit at all; on my platform
(Ubuntu 10.04 32-bit) the models with a time:plot interaction (with
time either continuous or a factor) failed because the hessian was
non-positive-definite.

  You could compare logLik() for the two models to see if they differ
by some tiny amount, but it's also possible (because of the way
AD Model Builder returns its results) that the log-likelihoods will
have been rounded sufficiently that they appear identical.

  Ben Bolker


From seth at swbigelow.net  Tue Nov  6 14:43:54 2012
From: seth at swbigelow.net (Seth W. Bigelow)
Date: Tue, 6 Nov 2012 08:43:54 -0500
Subject: [R-sig-ME] glmmADMB random interaction effects and
	likelihood	estimates
In-Reply-To: <loom.20121106T141321-996@post.gmane.org>
References: <002501cdbb72$0cd00e40$26702ac0$@net>
	<loom.20121106T141321-996@post.gmane.org>
Message-ID: <002201cdbc24$c59763d0$50c62b70$@net>

Ben, 

your insights are greatly appreciated

--Seth

-----Original Message-----
From: r-sig-mixed-models-bounces at r-project.org
[mailto:r-sig-mixed-models-bounces at r-project.org] On Behalf Of Ben Bolker
Sent: Tuesday, November 06, 2012 8:32 AM
To: r-sig-mixed-models at r-project.org
Subject: Re: [R-sig-ME] glmmADMB random interaction effects and likelihood
estimates

Seth W. Bigelow <seth at ...> writes:

> Dear list: I'm (still) working on a model of snag (dead tree) abundance
> before, after, & 5 yr after forest treatments using negative binomial
> distribution with glmmADMB. The data suggest that variance may differ
> sharply before and after treatment (factor variable 'time', values 1/2/3),
> so I have tried specifying the random term to model variance within time.
> e.g., glmmadmb(snag ~ time + Ecozone + (time|plot)), where Ecozone is a
> factor variable which takes values East or West, and 'plot' is a subject
> variable. The issue is that log-likelihood does not change whether I use
> (1|plot) or (time|plot). Am I missing something obvious, or is there a bug
> in the way likelihood is being calculated/reported?
> 
> Appreciatively, Seth W. Bigelow
> 
> glmmadmb(formula = snag ~ time + Ecozone + (1 | SettingID), data = l2, 
>     family = "nbinom1", zeroInflation = F)

  [snip]
 
> Number of observations: total=192, SettingID=64 
> Random effect variance(s):
> Group=SettingID

>             Variance StdDev
> (Intercept)     2.37   1.54
> 
> Negative binomial dispersion parameter: 1.812 (std. err.: 0.33774)
> 
> Log-likelihood: -255.758
> 
> glmmadmb(formula = snag ~ time + Ecozone + (time | SettingID), 
>     data = l2, family = "nbinom1", zeroInflation = F)
> 
  [snip]

> Random effect variance(s):
> 
> Group=SettingID
> 
>              Variance    StdDev
> (Intercept) 2.370e+00 1.5396428
> time2       1.765e-07 0.0004201
> time3       8.542e-08 0.0002923

> Negative binomial dispersion parameter: 1.812 (std. err.: 0.33774)
> 
> Log-likelihood: -255.758
> 

  My guess here is that the log-likelihood differs only by a tiny
amount, because the estimated variances for time2 and time3 are
about 7-8 orders of magnitude less than the intercept variance.
The basic issue is that in a data set of this size (not tiny, but
not huge and quite noisy), you just don't have much power to detect
differences in slope among plots.

  You got a bit lucky getting the models to fit at all; on my platform
(Ubuntu 10.04 32-bit) the models with a time:plot interaction (with
time either continuous or a factor) failed because the hessian was
non-positive-definite.

  You could compare logLik() for the two models to see if they differ
by some tiny amount, but it's also possible (because of the way
AD Model Builder returns its results) that the log-likelihoods will
have been rounded sufficiently that they appear identical.

  Ben Bolker

_______________________________________________
R-sig-mixed-models at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models


From bbolker at gmail.com  Tue Nov  6 15:02:44 2012
From: bbolker at gmail.com (Ben Bolker)
Date: Tue, 6 Nov 2012 14:02:44 +0000 (UTC)
Subject: [R-sig-ME] convergence in GLMM (lme4 package)
References: <CADtmEn5SjY2gqTfZ4JLZ5Wz=QcN+tvJMpC4RWkqGm9P5kaT9_A@mail.gmail.com>
	<loom.20121023T195352-241@post.gmane.org>
	<CADtmEn4GJDbnT96dXtm+TFKnL3xG0M_mUKhqOX__-rHQtcgfHQ@mail.gmail.com>
	<CADtmEn42Kh-ryV7TZ6Voi7RkAuM1tVdkxSpQ8cdkFTZjaB39iw@mail.gmail.com>
	<509265C0.90602@gmail.com>
	<CADtmEn7XxYn_D4zmL3MyMO6H=qXY4rVQvkYo3WPuUPPB5q804A@mail.gmail.com>
Message-ID: <loom.20121106T150124-530@post.gmane.org>

Mart? Casals <mcasals at ...> writes:

> 
> Hello Ben,
> 
> Thank you so much again. We tried the function but we didn?t achieve to run
> it within our data. However, we found this post (see:
> https://stat.ethz.ch/pipermail/r-sig-mixed-models/2009q2/002413.html),
> which uses a similar function in the example (without an extra space at the
> end of "try-error"):

ok <- function(x,type= "try-error") class(x)!=type*
options(warn=2)*
fitmodel <- try(lmer(modelformula,data))*
ok(fitmodel)*
> 
> and it works in our data.
> 
> Now, we are basically interested in the probability of (non) convergence,
> that's why so far we only want to see how often convergence occurs. In the
> future, we may also want to study the different kinds of warning
> messages....
> 
> Best regards,
> 
> Mart? Casals.

  I'm glad you got something to work.  I would be willing to work
on the full problem more, but I can't do much without a reproducible
example ...

   Ben Bolker

 
> 2012/11/1 Ben Bolker <bbolker at ...>
> 
> > On 12-10-31 02:27 PM, Mart? Casals wrote:
> > > Hi Ben,
> > > Thank you very much for all your help, so far. Nonetheless, there is
> > > still something not working. If you could have a look at the following
> > > code, I would highly appreciate it. It's about how to count convergence
> > > problems of function glmer within a simulation. I tried to adapt your
> > > proposal to my models, but something's not working, probably to me lack
> > > of knowledge of functions like tryCatch and withCallingHandlers.
> >

  [snip]


From gjalt-jorn at behaviorchange.eu  Tue Nov  6 16:23:02 2012
From: gjalt-jorn at behaviorchange.eu (Gjalt-Jorn Peters)
Date: Tue, 06 Nov 2012 16:23:02 +0100
Subject: [R-sig-ME] lmer: effects of forcing fixed intercepts and slopes
Message-ID: <50992B56.4010707@behaviorchange.eu>

Dear all,

I run into something I don't understand: I update a model with some 
terms; none of the terms is significant; but the model suddenly fits A 
LOT better . . .

The background: I am running a model to test a relatively simple 
hypothesis: that an intervention aiming to reduce cannabis use is 
effective. It's a repeated measures design where we measured cannabis 
use of each student before and after the intervention. In addition to 
having repeated measures, students are nested in schools. A simple plot 
of the percentage of cannabis users before and after the intervention, 
in the control and the intervention groups, is at 
http://sciencerep.org/files/7/plot.png (this plot ignores the schools).

This is the datafile:

<R CODE>
   ### Load data
   dat.long <- 
read.table("http://sciencerep.org/files/7/the%20cannabis%20show%20-%20data%20in%20long%20format.tsv", 
header=TRUE, sep = "\t");

   ### Set 'participant' as factor
   dat.long$participant <- factor(dat.long$id);

   head(dat.long);
</R CODE>

This is what the head looks like:

   id moment   school cannabisShow gender age usedCannabis_bi participant
1  1 before Zuidoost Intervention      2  NA NA           1
2  2 before Zuidoost Intervention      2  NA 0           2
3  3 before Zuidoost Intervention      1  NA 1           3
4  4 before    Noord Intervention     NA  NA NA           4
5  5 before    Noord Intervention     NA  NA 1           5
6  6 before    Noord Intervention      1  NA NA           6

'school' has 8 levels;
'moment' has 2 levels ('before' and 'after');
'cannabisShow' has 2 levels, 'Intervention' and 'Control';
'usedCannabis_bi' has 2 levels, 0 and 1;
and participants is the participant identifyer.

I run a null model and a 'real' model, comparing the fit. These are the 
formulations I use:

<R CODE>
   rep_measures.1.null  <- lmer(formula = usedCannabis_bi ~
                                1 + moment + (1 + moment | school / 
participant),
                                family=binomial(link = "logit"), 
data=dat.long);
   rep_measures.1.model <- update(rep_measures.1.null, .~. + 
moment*cannabisShow);
   rep_measures.1.null;
   rep_measures.1.model;
   anova(rep_measures.1.null, rep_measures.1.model);
</R CODE>

The second model, where I introduce the interaction between measurement 
moment and whether participants received the intervention (this should 
reflect an effect of the intervention), fits considerably better than 
the original model. But, the interaction is not significant. In fact, 
none of the fixed effects is - so I added terms to the model, none of 
these terms significantly contributes to the prediction of cannabis use, 
yet the model fits a lot better.

This seems to be a paradox. Could anybody maybe explain how this is 
possible?

I also looked at the situation where I impose fixed intercepts and 
slopes on the participant level (so intercepts and slopes could only 
vary per school):

<R CODE>
   rep_measures.2.null  <- lmer(formula = usedCannabis_bi ~
                                1 + moment + (1 + moment | school),
                                family=binomial(link = "logit"), 
data=dat.long);
   rep_measures.2.model <- update(rep_measures.2.null, .~. + 
moment*cannabisShow);
   rep_measures.2.null;
   rep_measures.2.model;
   anova(rep_measures.2.null, rep_measures.2.model);
</R CODE>

Now the interaction between 'measurement moment' and 'intervention' is 
significant, as I expected; but the improvement in fit between the null 
model and the 'full model' is much, much smaller.

This is very counter-intuitive to me - I have the feeling I'm missing 
something basic, but I have no idea what. Any help is much appreciated!

Thank you very much in advance, kind regards,

Gjalt-Jorn


PS: the file with the analyses is at 
http://sciencerep.org/files/7/the%20cannabis%20show%20-%20analyses%20for%20mailing%20list.r


From Thierry.ONKELINX at inbo.be  Tue Nov  6 17:25:07 2012
From: Thierry.ONKELINX at inbo.be (ONKELINX, Thierry)
Date: Tue, 6 Nov 2012 16:25:07 +0000
Subject: [R-sig-ME] lmer: effects of forcing fixed intercepts and slopes
In-Reply-To: <50992B56.4010707@behaviorchange.eu>
References: <50992B56.4010707@behaviorchange.eu>
Message-ID: <AA818EAD2576BC488B4F623941DA742794728423@inbomail.inbo.be>

Dear Gjalt-Jorn,

Your null model is too complex for your data. Having only one measurement per participant per moment, you cannot fit a random 'slope' along moment per participant. Note the perfect correlation in your null model for the nested random effect.

Even at the school levels, the amount of data is not that larger and you end up with near perfect correlations in this random effect. So I would advise to drop moment as a random slope.

Don't forget that the summary of a model is testing different hypotheses than an LRT between two models! You might do some reading on that topic or get some local statistical advise.

Best regards,

Thierry

ir. Thierry Onkelinx
Instituut voor natuur- en bosonderzoek / Research Institute for Nature and Forest
team Biometrie & Kwaliteitszorg / team Biometrics & Quality Assurance
Kliniekstraat 25
1070 Anderlecht
Belgium
+ 32 2 525 02 51
+ 32 54 43 61 85
Thierry.Onkelinx at inbo.be
www.inbo.be

To call in the statistician after the experiment is done may be no more than asking him to perform a post-mortem examination: he may be able to say what the experiment died of.
~ Sir Ronald Aylmer Fisher

The plural of anecdote is not data.
~ Roger Brinner

The combination of some data and an aching desire for an answer does not ensure that a reasonable answer can be extracted from a given body of data.
~ John Tukey


-----Oorspronkelijk bericht-----
Van: r-sig-mixed-models-bounces at r-project.org [mailto:r-sig-mixed-models-bounces at r-project.org] Namens Gjalt-Jorn Peters
Verzonden: dinsdag 6 november 2012 16:23
Aan: r-sig-mixed-models at r-project.org
Onderwerp: [R-sig-ME] lmer: effects of forcing fixed intercepts and slopes

Dear all,

I run into something I don't understand: I update a model with some terms; none of the terms is significant; but the model suddenly fits A LOT better . . .

The background: I am running a model to test a relatively simple
hypothesis: that an intervention aiming to reduce cannabis use is effective. It's a repeated measures design where we measured cannabis use of each student before and after the intervention. In addition to having repeated measures, students are nested in schools. A simple plot of the percentage of cannabis users before and after the intervention, in the control and the intervention groups, is at http://sciencerep.org/files/7/plot.png (this plot ignores the schools).

This is the datafile:

<R CODE>
   ### Load data
   dat.long <-
read.table("http://sciencerep.org/files/7/the%20cannabis%20show%20-%20data%20in%20long%20format.tsv",
header=TRUE, sep = "\t");

   ### Set 'participant' as factor
   dat.long$participant <- factor(dat.long$id);

   head(dat.long);
</R CODE>

This is what the head looks like:

   id moment   school cannabisShow gender age usedCannabis_bi participant
1  1 before Zuidoost Intervention      2  NA NA           1
2  2 before Zuidoost Intervention      2  NA 0           2
3  3 before Zuidoost Intervention      1  NA 1           3
4  4 before    Noord Intervention     NA  NA NA           4
5  5 before    Noord Intervention     NA  NA 1           5
6  6 before    Noord Intervention      1  NA NA           6

'school' has 8 levels;
'moment' has 2 levels ('before' and 'after'); 'cannabisShow' has 2 levels, 'Intervention' and 'Control'; 'usedCannabis_bi' has 2 levels, 0 and 1; and participants is the participant identifyer.

I run a null model and a 'real' model, comparing the fit. These are the formulations I use:

<R CODE>
   rep_measures.1.null  <- lmer(formula = usedCannabis_bi ~
                                1 + moment + (1 + moment | school / participant),
                                family=binomial(link = "logit"), data=dat.long);
   rep_measures.1.model <- update(rep_measures.1.null, .~. + moment*cannabisShow);
   rep_measures.1.null;
   rep_measures.1.model;
   anova(rep_measures.1.null, rep_measures.1.model); </R CODE>

The second model, where I introduce the interaction between measurement moment and whether participants received the intervention (this should reflect an effect of the intervention), fits considerably better than the original model. But, the interaction is not significant. In fact, none of the fixed effects is - so I added terms to the model, none of these terms significantly contributes to the prediction of cannabis use, yet the model fits a lot better.

This seems to be a paradox. Could anybody maybe explain how this is possible?

I also looked at the situation where I impose fixed intercepts and slopes on the participant level (so intercepts and slopes could only vary per school):

<R CODE>
   rep_measures.2.null  <- lmer(formula = usedCannabis_bi ~
                                1 + moment + (1 + moment | school),
                                family=binomial(link = "logit"), data=dat.long);
   rep_measures.2.model <- update(rep_measures.2.null, .~. + moment*cannabisShow);
   rep_measures.2.null;
   rep_measures.2.model;
   anova(rep_measures.2.null, rep_measures.2.model); </R CODE>

Now the interaction between 'measurement moment' and 'intervention' is significant, as I expected; but the improvement in fit between the null model and the 'full model' is much, much smaller.

This is very counter-intuitive to me - I have the feeling I'm missing something basic, but I have no idea what. Any help is much appreciated!

Thank you very much in advance, kind regards,

Gjalt-Jorn


PS: the file with the analyses is at
http://sciencerep.org/files/7/the%20cannabis%20show%20-%20analyses%20for%20mailing%20list.r

_______________________________________________
R-sig-mixed-models at r-project.org mailing list https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
* * * * * * * * * * * * * D I S C L A I M E R * * * * * * * * * * * * *
Dit bericht en eventuele bijlagen geven enkel de visie van de schrijver weer en binden het INBO onder geen enkel beding, zolang dit bericht niet bevestigd is door een geldig ondertekend document.
The views expressed in this message and any annex are purely those of the writer and may not be regarded as stating an official position of INBO, as long as the message is not confirmed by a duly signed document.


From a.mosnier at gmail.com  Tue Nov  6 18:59:19 2012
From: a.mosnier at gmail.com (Arnaud Mosnier)
Date: Tue, 6 Nov 2012 12:59:19 -0500
Subject: [R-sig-ME] corARMA in lme
Message-ID: <CANkFkEd3ph3pLw-yUpRXCk3U=GMsgFqR-Qneh5BF8Xx4m1dFHg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121106/17378e05/attachment.pl>

From gjalt-jorn at behaviorchange.eu  Tue Nov  6 21:42:26 2012
From: gjalt-jorn at behaviorchange.eu (Gjalt-Jorn Peters)
Date: Tue, 06 Nov 2012 21:42:26 +0100
Subject: [R-sig-ME] lmer: effects of forcing fixed intercepts and slopes
In-Reply-To: <AA818EAD2576BC488B4F623941DA742794728423@inbomail.inbo.be>
References: <50992B56.4010707@behaviorchange.eu>
	<AA818EAD2576BC488B4F623941DA742794728423@inbomail.inbo.be>
Message-ID: <50997632.2080500@behaviorchange.eu>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121106/71edece5/attachment.pl>

From Thierry.ONKELINX at inbo.be  Wed Nov  7 10:00:52 2012
From: Thierry.ONKELINX at inbo.be (ONKELINX, Thierry)
Date: Wed, 7 Nov 2012 09:00:52 +0000
Subject: [R-sig-ME] lmer: effects of forcing fixed intercepts and slopes
In-Reply-To: <50997632.2080500@behaviorchange.eu>
References: <50992B56.4010707@behaviorchange.eu>
	<AA818EAD2576BC488B4F623941DA742794728423@inbomail.inbo.be>
	<50997632.2080500@behaviorchange.eu>
Message-ID: <AA818EAD2576BC488B4F623941DA74279473775C@inbomail.inbo.be>

Mixed models are not that scary. I would recommend to read Zuur et al (2009). It was written with 'mainstream researchers' (in ecology) in mind. It start with simple linear models and gradually adds complexity (glm, gam, lmm, glmm, gamm, ...)

@BOOK{ZuurMixedModels,
  title = {{M}ixed {E}ffects {M}odels and {E}xtensions in {E}cology with {R}},
  publisher = {Springer New York},
  year = {2009},
  author = {Zuur, Alain F. and Ieno, Elena N. and Walker, Neil J. and Saveliev, Anatoly A. and Smith, Graham M.},
  doi = {10.1007/978-0-387-87458-6}
}

ir. Thierry Onkelinx
Instituut voor natuur- en bosonderzoek / Research Institute for Nature and Forest
team Biometrie & Kwaliteitszorg / team Biometrics & Quality Assurance
Kliniekstraat 25
1070 Anderlecht
Belgium
+ 32 2 525 02 51
+ 32 54 43 61 85
Thierry.Onkelinx at inbo.be
www.inbo.be

To call in the statistician after the experiment is done may be no more than asking him to perform a post-mortem examination: he may be able to say what the experiment died of.
~ Sir Ronald Aylmer Fisher

The plural of anecdote is not data.
~ Roger Brinner

The combination of some data and an aching desire for an answer does not ensure that a reasonable answer can be extracted from a given body of data.
~ John Tukey

-----Oorspronkelijk bericht-----
Van: r-sig-mixed-models-bounces at r-project.org [mailto:r-sig-mixed-models-bounces at r-project.org] Namens Gjalt-Jorn Peters
Verzonden: dinsdag 6 november 2012 21:42
Aan: r-sig-mixed-models at r-project.org
Onderwerp: Re: [R-sig-ME] lmer: effects of forcing fixed intercepts and slopes

Dear list,

Thierry, great, thank you very much for your quick reply! I will drop moment as a random slope, and read up on the different hypotheses that are being tested.

I have one more question. Basically, I have no background in multilevel (as you may have guessed :-)). The reason I'm 'in over my head' like this, is because I basically want to 'use the proper analysis' for my data, and the only method is apparently mixed models. "All I want" is the simplest' statistically decent, way to test whether cannabis use at the second measurement moment is different in the group that received that intervention as compared to the group that didn't.

However, when I try to learn about mixed models, the sources I encounter approach the modelling practice very differently. They seem to be about much more advanced issues; whether random intercepts and slopes should be included, and for which variables, etc (to stick to those issues that I at least kind of understand). Apparently, either mixed models are only used by people who are statistically much more advanced (i.e. there's a gap between 'mainstream researchers' and the people who understand and use mixed models), or in fact these sources _do_ discuss the same things, but in mixed models the terminology just differs a lot from what you encounter in more basic statistical textbooks.

I basically have the idea that although my requirements are very basic, I have to learn lots of dark arcane issues to be able to do this properly. This is kind of 'scary', as, for example, matrix algebra is, well, scary :-)

What do people here think of this? Is mixed models just something you should avoid unless you're able & willing to really delve into its statistical innards?

Again, thank you very much, kind regards,

Gjalt-Jorn


On 06-11-2012 17:25, ONKELINX, Thierry wrote:
> Dear Gjalt-Jorn,
>
> Your null model is too complex for your data. Having only one measurement per participant per moment, you cannot fit a random 'slope' along moment per participant. Note the perfect correlation in your null model for the nested random effect.
>
> Even at the school levels, the amount of data is not that larger and you end up with near perfect correlations in this random effect. So I would advise to drop moment as a random slope.
>
> Don't forget that the summary of a model is testing different hypotheses than an LRT between two models! You might do some reading on that topic or get some local statistical advise.
>
> Best regards,
>
> Thierry
>
> ir. Thierry Onkelinx
> Instituut voor natuur- en bosonderzoek / Research Institute for Nature
> and Forest team Biometrie & Kwaliteitszorg / team Biometrics & Quality
> Assurance Kliniekstraat 25
> 1070 Anderlecht
> Belgium
> + 32 2 525 02 51
> + 32 54 43 61 85
> Thierry.Onkelinx at inbo.be
> www.inbo.be
>
> To call in the statistician after the experiment is done may be no more than asking him to perform a post-mortem examination: he may be able to say what the experiment died of.
> ~ Sir Ronald Aylmer Fisher
>
> The plural of anecdote is not data.
> ~ Roger Brinner
>
> The combination of some data and an aching desire for an answer does not ensure that a reasonable answer can be extracted from a given body of data.
> ~ John Tukey
>
>
> -----Oorspronkelijk bericht-----
> Van: r-sig-mixed-models-bounces at r-project.org
> [mailto:r-sig-mixed-models-bounces at r-project.org] Namens Gjalt-Jorn
> Peters
> Verzonden: dinsdag 6 november 2012 16:23
> Aan: r-sig-mixed-models at r-project.org
> Onderwerp: [R-sig-ME] lmer: effects of forcing fixed intercepts and
> slopes
>
> Dear all,
>
> I run into something I don't understand: I update a model with some terms; none of the terms is significant; but the model suddenly fits A LOT better . . .
>
> The background: I am running a model to test a relatively simple
> hypothesis: that an intervention aiming to reduce cannabis use is effective. It's a repeated measures design where we measured cannabis use of each student before and after the intervention. In addition to having repeated measures, students are nested in schools. A simple plot of the percentage of cannabis users before and after the intervention, in the control and the intervention groups, is at http://sciencerep.org/files/7/plot.png (this plot ignores the schools).
>
> This is the datafile:
>
> <R CODE>
>     ### Load data
>     dat.long <-
> read.table("http://sciencerep.org/files/7/the%20cannabis%20show%20-%20
> data%20in%20long%20format.tsv",
> header=TRUE, sep = "\t");
>
>     ### Set 'participant' as factor
>     dat.long$participant <- factor(dat.long$id);
>
>     head(dat.long);
> </R CODE>
>
> This is what the head looks like:
>
>     id moment   school cannabisShow gender age usedCannabis_bi participant
> 1  1 before Zuidoost Intervention      2  NA NA           1
> 2  2 before Zuidoost Intervention      2  NA 0           2
> 3  3 before Zuidoost Intervention      1  NA 1           3
> 4  4 before    Noord Intervention     NA  NA NA           4
> 5  5 before    Noord Intervention     NA  NA 1           5
> 6  6 before    Noord Intervention      1  NA NA           6
>
> 'school' has 8 levels;
> 'moment' has 2 levels ('before' and 'after'); 'cannabisShow' has 2 levels, 'Intervention' and 'Control'; 'usedCannabis_bi' has 2 levels, 0 and 1; and participants is the participant identifyer.
>
> I run a null model and a 'real' model, comparing the fit. These are the formulations I use:
>
> <R CODE>
>     rep_measures.1.null  <- lmer(formula = usedCannabis_bi ~
>                                  1 + moment + (1 + moment | school / participant),
>                                  family=binomial(link = "logit"), data=dat.long);
>     rep_measures.1.model <- update(rep_measures.1.null, .~. + moment*cannabisShow);
>     rep_measures.1.null;
>     rep_measures.1.model;
>     anova(rep_measures.1.null, rep_measures.1.model); </R CODE>
>
> The second model, where I introduce the interaction between measurement moment and whether participants received the intervention (this should reflect an effect of the intervention), fits considerably better than the original model. But, the interaction is not significant. In fact, none of the fixed effects is - so I added terms to the model, none of these terms significantly contributes to the prediction of cannabis use, yet the model fits a lot better.
>
> This seems to be a paradox. Could anybody maybe explain how this is possible?
>
> I also looked at the situation where I impose fixed intercepts and slopes on the participant level (so intercepts and slopes could only vary per school):
>
> <R CODE>
>     rep_measures.2.null  <- lmer(formula = usedCannabis_bi ~
>                                  1 + moment + (1 + moment | school),
>                                  family=binomial(link = "logit"), data=dat.long);
>     rep_measures.2.model <- update(rep_measures.2.null, .~. + moment*cannabisShow);
>     rep_measures.2.null;
>     rep_measures.2.model;
>     anova(rep_measures.2.null, rep_measures.2.model); </R CODE>
>
> Now the interaction between 'measurement moment' and 'intervention' is significant, as I expected; but the improvement in fit between the null model and the 'full model' is much, much smaller.
>
> This is very counter-intuitive to me - I have the feeling I'm missing something basic, but I have no idea what. Any help is much appreciated!
>
> Thank you very much in advance, kind regards,
>
> Gjalt-Jorn
>
>
> PS: the file with the analyses is at
> http://sciencerep.org/files/7/the%20cannabis%20show%20-%20analyses%20f
> or%20mailing%20list.r
>
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> * * * * * * * * * * * * * D I S C L A I M E R * * * * * * * * * * * *
> * Dit bericht en eventuele bijlagen geven enkel de visie van de schrijver weer en binden het INBO onder geen enkel beding, zolang dit bericht niet bevestigd is door een geldig ondertekend document.
> The views expressed in this message and any annex are purely those of the writer and may not be regarded as stating an official position of INBO, as long as the message is not confirmed by a duly signed document.


        [[alternative HTML version deleted]]

_______________________________________________
R-sig-mixed-models at r-project.org mailing list https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
* * * * * * * * * * * * * D I S C L A I M E R * * * * * * * * * * * * *
Dit bericht en eventuele bijlagen geven enkel de visie van de schrijver weer en binden het INBO onder geen enkel beding, zolang dit bericht niet bevestigd is door een geldig ondertekend document.
The views expressed in this message and any annex are purely those of the writer and may not be regarded as stating an official position of INBO, as long as the message is not confirmed by a duly signed document.


From pierces1 at msu.edu  Wed Nov  7 14:27:44 2012
From: pierces1 at msu.edu (Steven J. Pierce)
Date: Wed, 7 Nov 2012 08:27:44 -0500
Subject: [R-sig-ME] lmer: effects of forcing fixed intercepts and slopes
In-Reply-To: <50997632.2080500@behaviorchange.eu>
References: <50992B56.4010707@behaviorchange.eu>	<AA818EAD2576BC488B4F623941DA742794728423@inbomail.inbo.be>
	<50997632.2080500@behaviorchange.eu>
Message-ID: <002401cdbceb$ac6cf290$0546d7b0$@msu.edu>

For good intro coverage of how to use mixed models specifically for
longitudinal data, I recommend Singer & Willett (2003). It's a pretty
reader-friendly book. It doesn?t specifically cover the case of a binary
dependent variable, but that extension isn?t too hard if you already
understand the link between regression and logistic regression. 

Singer, J. D., & Willett, J. B. (2003). Applied longitudinal data analysis:
Modeling change and event occurrence. New York, NY: Oxford University Press.

Below is series of tutorial articles on multilevel modeling (i.e., one
application of mixed models). It's best to read them in the order listed
because each builds on the previous paper in the list. These are written
about cross-sectional analyses, but the foundations for cross-sectional and
longitudinal analyses with mixed models are pretty much the same. Just
remember that observations nested within person is very similar conceptually
to persons nested within neighborhood. The last paper in the series
specifically focuses on logistic variations of these models. 

Merlo, J. (2003). Multilevel analytical approaches in social epidemiology:
Measures of health variation compared with traditional measures of
association. Journal of Epidemiology and Community Health, 57(8), 550-552.
http://jech.bmj.com/cgi/content/extract/57/8/550   

Merlo, J., Chaix, B., Yang, M., Lynch, J., & R?stam, L. (2005). A brief
conceptual tutorial of multilevel analysis in social epidemiology: linking
the statistical concept of clustering to the idea of contextual phenomenon.
Journal of Epidemiology and Community Health, 59(6), 443-449.
http://jech.bmj.com/cgi/content/abstract/59/6/443  

Merlo, J., Yang, M., Chaix, B., Lynch, J., & R?stam, L. (2005). A brief
conceptual tutorial on multilevel analysis in social epidemiology:
investigating contextual phenomena in different groups of people. Journal of
Epidemiology and Community Health, 59(9), 729-736.
http://jech.bmj.com/cgi/content/abstract/59/9/729  

Merlo, J., Chaix, B., Yang, M., Lynch, J., & R?stam, L. (2005). A brief
conceptual tutorial on multilevel analysis in social epidemiology:
interpreting neighbourhood differences and the effect of neighbourhood
characteristics on individual health. Journal of Epidemiology and Community
Health, 59(12), 1022-1029.
http://jech.bmj.com/cgi/content/abstract/59/12/1022 
 
Merlo, J., Chaix, B., Ohlsson, H., Beckman, A., Johnell, K., Hjerpe, P., et
al. (2006). A brief conceptual tutorial of multilevel analysis in social
epidemiology: using measures of clustering in multilevel logistic regression
to investigate contextual phenomena. Journal of Epidemiology and Community
Health, 60(4), 290-297. http://jech.bmj.com/cgi/content/abstract/60/4/290 


As an alternative to a mixed model, you could also consider using GEE: 

Hanley, J. A., Negassa, A., deB. Edwardes, M. D., & Forrester, J. E. (2003).
Statistical analysis of correlated data using generalized estimating
equations: An orientation. American Journal of Epidemiology, 157(4),
364-375. doi: 10.1093/aje/kwf215
http://aje.oxfordjournals.org/cgi/content/full/157/4/364 

Ballinger, G. A. (2004). Using generalized estimating equations for
longitudinal data analysis. Organizational Research Methods, 7(2), 127-150.
doi: 10.1177/1094428104263672  http://orm.sagepub.com/content/7/2/127 


Steven J. Pierce, Ph.D. 
Associate Director 
Center for Statistical Training & Consulting (CSTAT) 
Michigan State University 
Giltner Hall
293 Farm Lane, Room 178 
East Lansing, MI 48824 
Office Phone: (517) 353-9288 
Office Fax: (517) 353-9307 
E-mail: pierces1 at msu.edu 
Web: http://www.cstat.msu.edu 

-----Original Message-----
From: Gjalt-Jorn Peters [mailto:gjalt-jorn at behaviorchange.eu] 
Sent: Tuesday, November 06, 2012 3:42 PM
To: r-sig-mixed-models at r-project.org
Subject: Re: [R-sig-ME] lmer: effects of forcing fixed intercepts and slopes

Dear list,

Thierry, great, thank you very much for your quick reply! I will drop 
moment as a random slope, and read up on the different hypotheses that 
are being tested.

I have one more question. Basically, I have no background in multilevel 
(as you may have guessed :-)). The reason I'm 'in over my head' like 
this, is because I basically want to 'use the proper analysis' for my 
data, and the only method is apparently mixed models. "All I want" is 
the simplest' statistically decent, way to test whether cannabis use at 
the second measurement moment is different in the group that received 
that intervention as compared to the group that didn't.

However, when I try to learn about mixed models, the sources I encounter 
approach the modelling practice very differently. They seem to be about 
much more advanced issues; whether random intercepts and slopes should 
be included, and for which variables, etc (to stick to those issues that 
I at least kind of understand). Apparently, either mixed models are only 
used by people who are statistically much more advanced (i.e. there's a 
gap between 'mainstream researchers' and the people who understand and 
use mixed models), or in fact these sources _do_ discuss the same 
things, but in mixed models the terminology just differs a lot from what 
you encounter in more basic statistical textbooks.

I basically have the idea that although my requirements are very basic, 
I have to learn lots of dark arcane issues to be able to do this 
properly. This is kind of 'scary', as, for example, matrix algebra is, 
well, scary :-)

What do people here think of this? Is mixed models just something you 
should avoid unless you're able & willing to really delve into its 
statistical innards?

Again, thank you very much, kind regards,

Gjalt-Jorn


On 06-11-2012 17:25, ONKELINX, Thierry wrote:
> Dear Gjalt-Jorn,
>
> Your null model is too complex for your data. Having only one measurement
per participant per moment, you cannot fit a random 'slope' along moment per
participant. Note the perfect correlation in your null model for the nested
random effect.
>
> Even at the school levels, the amount of data is not that larger and you
end up with near perfect correlations in this random effect. So I would
advise to drop moment as a random slope.
>
> Don't forget that the summary of a model is testing different hypotheses
than an LRT between two models! You might do some reading on that topic or
get some local statistical advise.
>
> Best regards,
>
> Thierry
>
> ir. Thierry Onkelinx
> Instituut voor natuur- en bosonderzoek / Research Institute for Nature and
Forest
> team Biometrie & Kwaliteitszorg / team Biometrics & Quality Assurance
> Kliniekstraat 25
> 1070 Anderlecht
> Belgium
> + 32 2 525 02 51
> + 32 54 43 61 85
> Thierry.Onkelinx at inbo.be
> www.inbo.be
>
> To call in the statistician after the experiment is done may be no more
than asking him to perform a post-mortem examination: he may be able to say
what the experiment died of.
> ~ Sir Ronald Aylmer Fisher
>
> The plural of anecdote is not data.
> ~ Roger Brinner
>
> The combination of some data and an aching desire for an answer does not
ensure that a reasonable answer can be extracted from a given body of data.
> ~ John Tukey
>
>
> -----Oorspronkelijk bericht-----
> Van: r-sig-mixed-models-bounces at r-project.org
[mailto:r-sig-mixed-models-bounces at r-project.org] Namens Gjalt-Jorn Peters
> Verzonden: dinsdag 6 november 2012 16:23
> Aan: r-sig-mixed-models at r-project.org
> Onderwerp: [R-sig-ME] lmer: effects of forcing fixed intercepts and slopes
>
> Dear all,
>
> I run into something I don't understand: I update a model with some terms;
none of the terms is significant; but the model suddenly fits A LOT better .
. .
>
> The background: I am running a model to test a relatively simple
> hypothesis: that an intervention aiming to reduce cannabis use is
effective. It's a repeated measures design where we measured cannabis use of
each student before and after the intervention. In addition to having
repeated measures, students are nested in schools. A simple plot of the
percentage of cannabis users before and after the intervention, in the
control and the intervention groups, is at
http://sciencerep.org/files/7/plot.png (this plot ignores the schools).
>
> This is the datafile:
>
> <R CODE>
>     ### Load data
>     dat.long <-
>
read.table("http://sciencerep.org/files/7/the%20cannabis%20show%20-%20data%2
0in%20long%20format.tsv",
> header=TRUE, sep = "\t");
>
>     ### Set 'participant' as factor
>     dat.long$participant <- factor(dat.long$id);
>
>     head(dat.long);
> </R CODE>
>
> This is what the head looks like:
>
>     id moment   school cannabisShow gender age usedCannabis_bi participant
> 1  1 before Zuidoost Intervention      2  NA NA           1
> 2  2 before Zuidoost Intervention      2  NA 0           2
> 3  3 before Zuidoost Intervention      1  NA 1           3
> 4  4 before    Noord Intervention     NA  NA NA           4
> 5  5 before    Noord Intervention     NA  NA 1           5
> 6  6 before    Noord Intervention      1  NA NA           6
>
> 'school' has 8 levels;
> 'moment' has 2 levels ('before' and 'after'); 'cannabisShow' has 2 levels,
'Intervention' and 'Control'; 'usedCannabis_bi' has 2 levels, 0 and 1; and
participants is the participant identifyer.
>
> I run a null model and a 'real' model, comparing the fit. These are the
formulations I use:
>
> <R CODE>
>     rep_measures.1.null  <- lmer(formula = usedCannabis_bi ~
>                                  1 + moment + (1 + moment | school /
participant),
>                                  family=binomial(link = "logit"),
data=dat.long);
>     rep_measures.1.model <- update(rep_measures.1.null, .~. +
moment*cannabisShow);
>     rep_measures.1.null;
>     rep_measures.1.model;
>     anova(rep_measures.1.null, rep_measures.1.model); </R CODE>
>
> The second model, where I introduce the interaction between measurement
moment and whether participants received the intervention (this should
reflect an effect of the intervention), fits considerably better than the
original model. But, the interaction is not significant. In fact, none of
the fixed effects is - so I added terms to the model, none of these terms
significantly contributes to the prediction of cannabis use, yet the model
fits a lot better.
>
> This seems to be a paradox. Could anybody maybe explain how this is
possible?
>
> I also looked at the situation where I impose fixed intercepts and slopes
on the participant level (so intercepts and slopes could only vary per
school):
>
> <R CODE>
>     rep_measures.2.null  <- lmer(formula = usedCannabis_bi ~
>                                  1 + moment + (1 + moment | school),
>                                  family=binomial(link = "logit"),
data=dat.long);
>     rep_measures.2.model <- update(rep_measures.2.null, .~. +
moment*cannabisShow);
>     rep_measures.2.null;
>     rep_measures.2.model;
>     anova(rep_measures.2.null, rep_measures.2.model); </R CODE>
>
> Now the interaction between 'measurement moment' and 'intervention' is
significant, as I expected; but the improvement in fit between the null
model and the 'full model' is much, much smaller.
>
> This is very counter-intuitive to me - I have the feeling I'm missing
something basic, but I have no idea what. Any help is much appreciated!
>
> Thank you very much in advance, kind regards,
>
> Gjalt-Jorn
>
>
> PS: the file with the analyses is at
>
http://sciencerep.org/files/7/the%20cannabis%20show%20-%20analyses%20for%20m
ailing%20list.r
>
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> * * * * * * * * * * * * * D I S C L A I M E R * * * * * * * * * * * * *
> Dit bericht en eventuele bijlagen geven enkel de visie van de schrijver
weer en binden het INBO onder geen enkel beding, zolang dit bericht niet
bevestigd is door een geldig ondertekend document.
> The views expressed in this message and any annex are purely those of the
writer and may not be regarded as stating an official position of INBO, as
long as the message is not confirmed by a duly signed document.


	[[alternative HTML version deleted]]


From seth at swbigelow.net  Wed Nov  7 15:22:48 2012
From: seth at swbigelow.net (Seth W. Bigelow)
Date: Wed, 7 Nov 2012 09:22:48 -0500
Subject: [R-sig-ME] lmer: effects of forcing fixed intercepts and slopes
In-Reply-To: <AA818EAD2576BC488B4F623941DA74279473775C@inbomail.inbo.be>
References: <50992B56.4010707@behaviorchange.eu>	<AA818EAD2576BC488B4F623941DA742794728423@inbomail.inbo.be>	<50997632.2080500@behaviorchange.eu>
	<AA818EAD2576BC488B4F623941DA74279473775C@inbomail.inbo.be>
Message-ID: <002d01cdbcf3$5dcaf7b0$1960e710$@net>

Let me slip in a word of praise for Simon Wood's book, 'Generalized Additive
Models', particularly chapter 6 on mixed models. The man is a genius for
explaining statistics, and his introduction to mixed models is the clearest
I've come across. It's canonical for me!
--Seth  


-----Original Message-----
From: r-sig-mixed-models-bounces at r-project.org
[mailto:r-sig-mixed-models-bounces at r-project.org] On Behalf Of ONKELINX,
Thierry
Sent: Wednesday, November 07, 2012 4:01 AM
To: Gjalt-Jorn Peters; r-sig-mixed-models at r-project.org
Subject: Re: [R-sig-ME] lmer: effects of forcing fixed intercepts and slopes

Mixed models are not that scary. I would recommend to read Zuur et al
(2009). It was written with 'mainstream researchers' (in ecology) in mind.
It start with simple linear models and gradually adds complexity (glm, gam,
lmm, glmm, gamm, ...)

@BOOK{ZuurMixedModels,
  title = {{M}ixed {E}ffects {M}odels and {E}xtensions in {E}cology with
{R}},
  publisher = {Springer New York},
  year = {2009},
  author = {Zuur, Alain F. and Ieno, Elena N. and Walker, Neil J. and
Saveliev, Anatoly A. and Smith, Graham M.},
  doi = {10.1007/978-0-387-87458-6}
}

ir. Thierry Onkelinx
Instituut voor natuur- en bosonderzoek / Research Institute for Nature and
Forest
team Biometrie & Kwaliteitszorg / team Biometrics & Quality Assurance
Kliniekstraat 25
1070 Anderlecht
Belgium
+ 32 2 525 02 51
+ 32 54 43 61 85
Thierry.Onkelinx at inbo.be
www.inbo.be

To call in the statistician after the experiment is done may be no more than
asking him to perform a post-mortem examination: he may be able to say what
the experiment died of.
~ Sir Ronald Aylmer Fisher

The plural of anecdote is not data.
~ Roger Brinner

The combination of some data and an aching desire for an answer does not
ensure that a reasonable answer can be extracted from a given body of data.
~ John Tukey

-----Oorspronkelijk bericht-----
Van: r-sig-mixed-models-bounces at r-project.org
[mailto:r-sig-mixed-models-bounces at r-project.org] Namens Gjalt-Jorn Peters
Verzonden: dinsdag 6 november 2012 21:42
Aan: r-sig-mixed-models at r-project.org
Onderwerp: Re: [R-sig-ME] lmer: effects of forcing fixed intercepts and
slopes

Dear list,

Thierry, great, thank you very much for your quick reply! I will drop moment
as a random slope, and read up on the different hypotheses that are being
tested.

I have one more question. Basically, I have no background in multilevel (as
you may have guessed :-)). The reason I'm 'in over my head' like this, is
because I basically want to 'use the proper analysis' for my data, and the
only method is apparently mixed models. "All I want" is the simplest'
statistically decent, way to test whether cannabis use at the second
measurement moment is different in the group that received that intervention
as compared to the group that didn't.

However, when I try to learn about mixed models, the sources I encounter
approach the modelling practice very differently. They seem to be about much
more advanced issues; whether random intercepts and slopes should be
included, and for which variables, etc (to stick to those issues that I at
least kind of understand). Apparently, either mixed models are only used by
people who are statistically much more advanced (i.e. there's a gap between
'mainstream researchers' and the people who understand and use mixed
models), or in fact these sources _do_ discuss the same things, but in mixed
models the terminology just differs a lot from what you encounter in more
basic statistical textbooks.

I basically have the idea that although my requirements are very basic, I
have to learn lots of dark arcane issues to be able to do this properly.
This is kind of 'scary', as, for example, matrix algebra is, well, scary :-)

What do people here think of this? Is mixed models just something you should
avoid unless you're able & willing to really delve into its statistical
innards?

Again, thank you very much, kind regards,

Gjalt-Jorn


On 06-11-2012 17:25, ONKELINX, Thierry wrote:
> Dear Gjalt-Jorn,
>
> Your null model is too complex for your data. Having only one measurement
per participant per moment, you cannot fit a random 'slope' along moment per
participant. Note the perfect correlation in your null model for the nested
random effect.
>
> Even at the school levels, the amount of data is not that larger and you
end up with near perfect correlations in this random effect. So I would
advise to drop moment as a random slope.
>
> Don't forget that the summary of a model is testing different hypotheses
than an LRT between two models! You might do some reading on that topic or
get some local statistical advise.
>
> Best regards,
>
> Thierry
>
> ir. Thierry Onkelinx
> Instituut voor natuur- en bosonderzoek / Research Institute for Nature
> and Forest team Biometrie & Kwaliteitszorg / team Biometrics & Quality
> Assurance Kliniekstraat 25
> 1070 Anderlecht
> Belgium
> + 32 2 525 02 51
> + 32 54 43 61 85
> Thierry.Onkelinx at inbo.be
> www.inbo.be
>
> To call in the statistician after the experiment is done may be no more
than asking him to perform a post-mortem examination: he may be able to say
what the experiment died of.
> ~ Sir Ronald Aylmer Fisher
>
> The plural of anecdote is not data.
> ~ Roger Brinner
>
> The combination of some data and an aching desire for an answer does not
ensure that a reasonable answer can be extracted from a given body of data.
> ~ John Tukey
>
>
> -----Oorspronkelijk bericht-----
> Van: r-sig-mixed-models-bounces at r-project.org
> [mailto:r-sig-mixed-models-bounces at r-project.org] Namens Gjalt-Jorn
> Peters
> Verzonden: dinsdag 6 november 2012 16:23
> Aan: r-sig-mixed-models at r-project.org
> Onderwerp: [R-sig-ME] lmer: effects of forcing fixed intercepts and
> slopes
>
> Dear all,
>
> I run into something I don't understand: I update a model with some terms;
none of the terms is significant; but the model suddenly fits A LOT better .
. .
>
> The background: I am running a model to test a relatively simple
> hypothesis: that an intervention aiming to reduce cannabis use is
effective. It's a repeated measures design where we measured cannabis use of
each student before and after the intervention. In addition to having
repeated measures, students are nested in schools. A simple plot of the
percentage of cannabis users before and after the intervention, in the
control and the intervention groups, is at
http://sciencerep.org/files/7/plot.png (this plot ignores the schools).
>
> This is the datafile:
>
> <R CODE>
>     ### Load data
>     dat.long <-
> read.table("http://sciencerep.org/files/7/the%20cannabis%20show%20-%20
> data%20in%20long%20format.tsv",
> header=TRUE, sep = "\t");
>
>     ### Set 'participant' as factor
>     dat.long$participant <- factor(dat.long$id);
>
>     head(dat.long);
> </R CODE>
>
> This is what the head looks like:
>
>     id moment   school cannabisShow gender age usedCannabis_bi participant
> 1  1 before Zuidoost Intervention      2  NA NA           1
> 2  2 before Zuidoost Intervention      2  NA 0           2
> 3  3 before Zuidoost Intervention      1  NA 1           3
> 4  4 before    Noord Intervention     NA  NA NA           4
> 5  5 before    Noord Intervention     NA  NA 1           5
> 6  6 before    Noord Intervention      1  NA NA           6
>
> 'school' has 8 levels;
> 'moment' has 2 levels ('before' and 'after'); 'cannabisShow' has 2 levels,
'Intervention' and 'Control'; 'usedCannabis_bi' has 2 levels, 0 and 1; and
participants is the participant identifyer.
>
> I run a null model and a 'real' model, comparing the fit. These are the
formulations I use:
>
> <R CODE>
>     rep_measures.1.null  <- lmer(formula = usedCannabis_bi ~
>                                  1 + moment + (1 + moment | school /
participant),
>                                  family=binomial(link = "logit"),
data=dat.long);
>     rep_measures.1.model <- update(rep_measures.1.null, .~. +
moment*cannabisShow);
>     rep_measures.1.null;
>     rep_measures.1.model;
>     anova(rep_measures.1.null, rep_measures.1.model); </R CODE>
>
> The second model, where I introduce the interaction between measurement
moment and whether participants received the intervention (this should
reflect an effect of the intervention), fits considerably better than the
original model. But, the interaction is not significant. In fact, none of
the fixed effects is - so I added terms to the model, none of these terms
significantly contributes to the prediction of cannabis use, yet the model
fits a lot better.
>
> This seems to be a paradox. Could anybody maybe explain how this is
possible?
>
> I also looked at the situation where I impose fixed intercepts and slopes
on the participant level (so intercepts and slopes could only vary per
school):
>
> <R CODE>
>     rep_measures.2.null  <- lmer(formula = usedCannabis_bi ~
>                                  1 + moment + (1 + moment | school),
>                                  family=binomial(link = "logit"),
data=dat.long);
>     rep_measures.2.model <- update(rep_measures.2.null, .~. +
moment*cannabisShow);
>     rep_measures.2.null;
>     rep_measures.2.model;
>     anova(rep_measures.2.null, rep_measures.2.model); </R CODE>
>
> Now the interaction between 'measurement moment' and 'intervention' is
significant, as I expected; but the improvement in fit between the null
model and the 'full model' is much, much smaller.
>
> This is very counter-intuitive to me - I have the feeling I'm missing
something basic, but I have no idea what. Any help is much appreciated!
>
> Thank you very much in advance, kind regards,
>
> Gjalt-Jorn
>
>
> PS: the file with the analyses is at
> http://sciencerep.org/files/7/the%20cannabis%20show%20-%20analyses%20f
> or%20mailing%20list.r
>
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> * * * * * * * * * * * * * D I S C L A I M E R * * * * * * * * * * * *
> * Dit bericht en eventuele bijlagen geven enkel de visie van de schrijver
weer en binden het INBO onder geen enkel beding, zolang dit bericht niet
bevestigd is door een geldig ondertekend document.
> The views expressed in this message and any annex are purely those of the
writer and may not be regarded as stating an official position of INBO, as
long as the message is not confirmed by a duly signed document.


        [[alternative HTML version deleted]]

_______________________________________________
R-sig-mixed-models at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
* * * * * * * * * * * * * D I S C L A I M E R * * * * * * * * * * * * *
Dit bericht en eventuele bijlagen geven enkel de visie van de schrijver weer
en binden het INBO onder geen enkel beding, zolang dit bericht niet
bevestigd is door een geldig ondertekend document.
The views expressed in this message and any annex are purely those of the
writer and may not be regarded as stating an official position of INBO, as
long as the message is not confirmed by a duly signed document.

_______________________________________________
R-sig-mixed-models at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models


From bbolker at gmail.com  Wed Nov  7 15:26:35 2012
From: bbolker at gmail.com (Ben Bolker)
Date: Wed, 7 Nov 2012 14:26:35 +0000 (UTC)
Subject: [R-sig-ME] corARMA in lme
References: <CANkFkEd3ph3pLw-yUpRXCk3U=GMsgFqR-Qneh5BF8Xx4m1dFHg@mail.gmail.com>
Message-ID: <loom.20121107T151538-495@post.gmane.org>

Arnaud Mosnier <a.mosnier at ...> writes:

> 
> Dear mixed-models useRs,
> 
> I made a mixed model of the form
> 
> lme(Distance ~ season, random = ~1|yearTagged/tag, correlation =
> corAR1(form= ~Time|yearTagged/tag), data = dat)
> 
> or
> 
> lme(Distance ~ season, random = ~1|yearTagged/tag, correlation =
> corARMA(form= ~Time|yearTagged/tag, p=1, q=1), data = dat)
> 
> In the AR1 model, the Phi value obtained for the corAR1 structure is 0.
> In the ARMA(1,1) model, both Phi1 and Theta1 are equal to 0.
> 
> I find this strange. I believed first that it was caused by the fact that
> yearTagegd and tag variables were not considered as factor, but it did not
> change anything if I convert them to factor.
> The temporal autocorrelation is not obvious in the residuals of the model
> without a temporal structure included (i.e. without corAR1 or corARMA), but
> can I conclude that there is not correlation based on Phi value ?

  A value of exactly zero does seem a little odd.  I don't have an
immediate answer, but in your position I would (1) try specifying
starting values (i.e., test whether lme simply got stuck immediately:
I suspect that 0 is the default starting value); (2) see about turning
on 'verbose' or 'trace' flags; (3) simulate some data with an
appropriate structure that does contain an AR term and see whether you
can recover it with this model fitting approach ...


From highstat at highstat.com  Wed Nov  7 15:33:29 2012
From: highstat at highstat.com (Highland Statistics Ltd)
Date: Wed, 07 Nov 2012 16:33:29 +0200
Subject: [R-sig-ME] corARMA in lme (Arnaud Mosnier)
In-Reply-To: <mailman.5.1352286002.6228.r-sig-mixed-models@r-project.org>
References: <mailman.5.1352286002.6228.r-sig-mixed-models@r-project.org>
Message-ID: <509A7139.9070508@highstat.com>

On 07/11/2012 13:00, r-sig-mixed-models-request at r-project.org wrote:
> Send R-sig-mixed-models mailing list submissions to
> 	r-sig-mixed-models at r-project.org
>
> To subscribe or unsubscribe via the World Wide Web, visit
> 	https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> or, via email, send a message with subject or body 'help' to
> 	r-sig-mixed-models-request at r-project.org
>
> You can reach the person managing the list at
> 	r-sig-mixed-models-owner at r-project.org
>
> When replying, please edit your Subject line so it is more specific
> than "Re: Contents of R-sig-mixed-models digest..."
>
>
> Today's Topics:
>
>     1. corARMA in lme (Arnaud Mosnier)
>     2. Re: lmer: effects of forcing fixed intercepts and slopes
>        (Gjalt-Jorn Peters)
>     3. Re: lmer: effects of forcing fixed intercepts and slopes
>        (ONKELINX, Thierry)
>
>
> ----------------------------------------------------------------------
>
> Message: 1
> Date: Tue, 6 Nov 2012 12:59:19 -0500
> From: Arnaud Mosnier <a.mosnier at gmail.com>
> To: "r-sig-mixed-models at r-project.org"
> 	<r-sig-mixed-models at r-project.org>
> Subject: [R-sig-ME] corARMA in lme
> Message-ID:
> 	<CANkFkEd3ph3pLw-yUpRXCk3U=GMsgFqR-Qneh5BF8Xx4m1dFHg at mail.gmail.com>
> Content-Type: text/plain
>
> Dear mixed-models useRs,
>
> I made a mixed model of the form
>
> lme(Distance ~ season, random = ~1|yearTagged/tag, correlation =
> corAR1(form= ~Time|yearTagged/tag), data = dat)
>
> or
>
> lme(Distance ~ season, random = ~1|yearTagged/tag, correlation =
> corARMA(form= ~Time|yearTagged/tag, p=1, q=1), data = dat)
>
> In the AR1 model, the Phi value obtained for the corAR1 structure is 0.
> In the ARMA(1,1) model, both Phi1 and Theta1 are equal to 0.
>
> I find this strange. I believed first that it was caused by the fact that
> yearTagegd and tag variables were not considered as factor, but it did not
> change anything if I convert them to factor.
> The temporal autocorrelation is not obvious in the residuals of the model
> without a temporal structure included (i.e. without corAR1 or corARMA), but
> can I conclude that there is not correlation based on Phi value ?

Arnaud...no you cannot conclude that. The random effect structure is 
already imposing a correlation on the data from the same tag, and also 
on data from the same yearTagged. Phi alone does not quantify your 
correlation. The ARMA is trying to add extra correlation. On top of 
that..the AR and ARMA correlation structures are quite specific.

If you think that there should be correlation, try different starting 
values for the phi.

Alain


> Thanks for your help,
>
> Arnaud
>
> 	[[alternative HTML version deleted]]
>
>





-- 

Dr. Alain F. Zuur
First author of:

1. Analysing Ecological Data (2007).
Zuur, AF, Ieno, EN and Smith, GM. Springer. 680 p.
URL: www.springer.com/0-387-45967-7


2. Mixed effects models and extensions in ecology with R. (2009).
Zuur, AF, Ieno, EN, Walker, N, Saveliev, AA, and Smith, GM. Springer.
http://www.springer.com/life+sci/ecology/book/978-0-387-87457-9


3. A Beginner's Guide to R (2009).
Zuur, AF, Ieno, EN, Meesters, EHWG. Springer
http://www.springer.com/statistics/computational/book/978-0-387-93836-3


4. Zero Inflated Models and Generalized Linear Mixed Models with R. (2012) Zuur, Saveliev, Ieno.
http://www.highstat.com/book4.htm

Other books: http://www.highstat.com/books.htm


Statistical consultancy, courses, data analysis and software
Highland Statistics Ltd.
6 Laverock road
UK - AB41 6FN Newburgh
Tel: 0044 1358 788177
Email: highstat at highstat.com
URL: www.highstat.com
URL: www.brodgar.com


From gjalt-jorn at behaviorchange.eu  Wed Nov  7 15:53:02 2012
From: gjalt-jorn at behaviorchange.eu (Gjalt-Jorn Peters)
Date: Wed, 07 Nov 2012 15:53:02 +0100
Subject: [R-sig-ME] lmer: effects of forcing fixed intercepts and slopes
In-Reply-To: <002d01cdbcf3$5dcaf7b0$1960e710$@net>
References: <50992B56.4010707@behaviorchange.eu>	<AA818EAD2576BC488B4F623941DA742794728423@inbomail.inbo.be>	<50997632.2080500@behaviorchange.eu>
	<AA818EAD2576BC488B4F623941DA74279473775C@inbomail.inbo.be>
	<002d01cdbcf3$5dcaf7b0$1960e710$@net>
Message-ID: <509A75CE.4080300@behaviorchange.eu>

Dear list,

Thierry, Steven and Seth: thank you so much for your references! These 
provide an excellent starting point. Steven, the articles references are 
great to get started until I obtained one or more of the books.

Regardless of how hard mixed models will prove, let it never be said 
that the community isn't helpful :-)

Again, thank you very much, kind regards,

Gjalt-Jorn


On 07-11-2012 15:22, Seth W. Bigelow wrote:
> Let me slip in a word of praise for Simon Wood's book, 'Generalized Additive
> Models', particularly chapter 6 on mixed models. The man is a genius for
> explaining statistics, and his introduction to mixed models is the clearest
> I've come across. It's canonical for me!
> --Seth
>
>
> -----Original Message-----
> From: r-sig-mixed-models-bounces at r-project.org
> [mailto:r-sig-mixed-models-bounces at r-project.org] On Behalf Of ONKELINX,
> Thierry
> Sent: Wednesday, November 07, 2012 4:01 AM
> To: Gjalt-Jorn Peters; r-sig-mixed-models at r-project.org
> Subject: Re: [R-sig-ME] lmer: effects of forcing fixed intercepts and slopes
>
> Mixed models are not that scary. I would recommend to read Zuur et al
> (2009). It was written with 'mainstream researchers' (in ecology) in mind.
> It start with simple linear models and gradually adds complexity (glm, gam,
> lmm, glmm, gamm, ...)
>
> @BOOK{ZuurMixedModels,
>    title = {{M}ixed {E}ffects {M}odels and {E}xtensions in {E}cology with
> {R}},
>    publisher = {Springer New York},
>    year = {2009},
>    author = {Zuur, Alain F. and Ieno, Elena N. and Walker, Neil J. and
> Saveliev, Anatoly A. and Smith, Graham M.},
>    doi = {10.1007/978-0-387-87458-6}
> }
>
> ir. Thierry Onkelinx
> Instituut voor natuur- en bosonderzoek / Research Institute for Nature and
> Forest
> team Biometrie & Kwaliteitszorg / team Biometrics & Quality Assurance
> Kliniekstraat 25
> 1070 Anderlecht
> Belgium
> + 32 2 525 02 51
> + 32 54 43 61 85
> Thierry.Onkelinx at inbo.be
> www.inbo.be
>
> To call in the statistician after the experiment is done may be no more than
> asking him to perform a post-mortem examination: he may be able to say what
> the experiment died of.
> ~ Sir Ronald Aylmer Fisher
>
> The plural of anecdote is not data.
> ~ Roger Brinner
>
> The combination of some data and an aching desire for an answer does not
> ensure that a reasonable answer can be extracted from a given body of data.
> ~ John Tukey
>
> -----Oorspronkelijk bericht-----
> Van: r-sig-mixed-models-bounces at r-project.org
> [mailto:r-sig-mixed-models-bounces at r-project.org] Namens Gjalt-Jorn Peters
> Verzonden: dinsdag 6 november 2012 21:42
> Aan: r-sig-mixed-models at r-project.org
> Onderwerp: Re: [R-sig-ME] lmer: effects of forcing fixed intercepts and
> slopes
>
> Dear list,
>
> Thierry, great, thank you very much for your quick reply! I will drop moment
> as a random slope, and read up on the different hypotheses that are being
> tested.
>
> I have one more question. Basically, I have no background in multilevel (as
> you may have guessed :-)). The reason I'm 'in over my head' like this, is
> because I basically want to 'use the proper analysis' for my data, and the
> only method is apparently mixed models. "All I want" is the simplest'
> statistically decent, way to test whether cannabis use at the second
> measurement moment is different in the group that received that intervention
> as compared to the group that didn't.
>
> However, when I try to learn about mixed models, the sources I encounter
> approach the modelling practice very differently. They seem to be about much
> more advanced issues; whether random intercepts and slopes should be
> included, and for which variables, etc (to stick to those issues that I at
> least kind of understand). Apparently, either mixed models are only used by
> people who are statistically much more advanced (i.e. there's a gap between
> 'mainstream researchers' and the people who understand and use mixed
> models), or in fact these sources _do_ discuss the same things, but in mixed
> models the terminology just differs a lot from what you encounter in more
> basic statistical textbooks.
>
> I basically have the idea that although my requirements are very basic, I
> have to learn lots of dark arcane issues to be able to do this properly.
> This is kind of 'scary', as, for example, matrix algebra is, well, scary :-)
>
> What do people here think of this? Is mixed models just something you should
> avoid unless you're able & willing to really delve into its statistical
> innards?
>
> Again, thank you very much, kind regards,
>
> Gjalt-Jorn
>
>
> On 06-11-2012 17:25, ONKELINX, Thierry wrote:
>> Dear Gjalt-Jorn,
>>
>> Your null model is too complex for your data. Having only one measurement
> per participant per moment, you cannot fit a random 'slope' along moment per
> participant. Note the perfect correlation in your null model for the nested
> random effect.
>> Even at the school levels, the amount of data is not that larger and you
> end up with near perfect correlations in this random effect. So I would
> advise to drop moment as a random slope.
>> Don't forget that the summary of a model is testing different hypotheses
> than an LRT between two models! You might do some reading on that topic or
> get some local statistical advise.
>> Best regards,
>>
>> Thierry
>>
>> ir. Thierry Onkelinx
>> Instituut voor natuur- en bosonderzoek / Research Institute for Nature
>> and Forest team Biometrie & Kwaliteitszorg / team Biometrics & Quality
>> Assurance Kliniekstraat 25
>> 1070 Anderlecht
>> Belgium
>> + 32 2 525 02 51
>> + 32 54 43 61 85
>> Thierry.Onkelinx at inbo.be
>> www.inbo.be
>>
>> To call in the statistician after the experiment is done may be no more
> than asking him to perform a post-mortem examination: he may be able to say
> what the experiment died of.
>> ~ Sir Ronald Aylmer Fisher
>>
>> The plural of anecdote is not data.
>> ~ Roger Brinner
>>
>> The combination of some data and an aching desire for an answer does not
> ensure that a reasonable answer can be extracted from a given body of data.
>> ~ John Tukey
>>
>>
>> -----Oorspronkelijk bericht-----
>> Van: r-sig-mixed-models-bounces at r-project.org
>> [mailto:r-sig-mixed-models-bounces at r-project.org] Namens Gjalt-Jorn
>> Peters
>> Verzonden: dinsdag 6 november 2012 16:23
>> Aan: r-sig-mixed-models at r-project.org
>> Onderwerp: [R-sig-ME] lmer: effects of forcing fixed intercepts and
>> slopes
>>
>> Dear all,
>>
>> I run into something I don't understand: I update a model with some terms;
> none of the terms is significant; but the model suddenly fits A LOT better .
> . .
>> The background: I am running a model to test a relatively simple
>> hypothesis: that an intervention aiming to reduce cannabis use is
> effective. It's a repeated measures design where we measured cannabis use of
> each student before and after the intervention. In addition to having
> repeated measures, students are nested in schools. A simple plot of the
> percentage of cannabis users before and after the intervention, in the
> control and the intervention groups, is at
> http://sciencerep.org/files/7/plot.png (this plot ignores the schools).
>> This is the datafile:
>>
>> <R CODE>
>>      ### Load data
>>      dat.long <-
>> read.table("http://sciencerep.org/files/7/the%20cannabis%20show%20-%20
>> data%20in%20long%20format.tsv",
>> header=TRUE, sep = "\t");
>>
>>      ### Set 'participant' as factor
>>      dat.long$participant <- factor(dat.long$id);
>>
>>      head(dat.long);
>> </R CODE>
>>
>> This is what the head looks like:
>>
>>      id moment   school cannabisShow gender age usedCannabis_bi participant
>> 1  1 before Zuidoost Intervention      2  NA NA           1
>> 2  2 before Zuidoost Intervention      2  NA 0           2
>> 3  3 before Zuidoost Intervention      1  NA 1           3
>> 4  4 before    Noord Intervention     NA  NA NA           4
>> 5  5 before    Noord Intervention     NA  NA 1           5
>> 6  6 before    Noord Intervention      1  NA NA           6
>>
>> 'school' has 8 levels;
>> 'moment' has 2 levels ('before' and 'after'); 'cannabisShow' has 2 levels,
> 'Intervention' and 'Control'; 'usedCannabis_bi' has 2 levels, 0 and 1; and
> participants is the participant identifyer.
>> I run a null model and a 'real' model, comparing the fit. These are the
> formulations I use:
>> <R CODE>
>>      rep_measures.1.null  <- lmer(formula = usedCannabis_bi ~
>>                                   1 + moment + (1 + moment | school /
> participant),
>>                                   family=binomial(link = "logit"),
> data=dat.long);
>>      rep_measures.1.model <- update(rep_measures.1.null, .~. +
> moment*cannabisShow);
>>      rep_measures.1.null;
>>      rep_measures.1.model;
>>      anova(rep_measures.1.null, rep_measures.1.model); </R CODE>
>>
>> The second model, where I introduce the interaction between measurement
> moment and whether participants received the intervention (this should
> reflect an effect of the intervention), fits considerably better than the
> original model. But, the interaction is not significant. In fact, none of
> the fixed effects is - so I added terms to the model, none of these terms
> significantly contributes to the prediction of cannabis use, yet the model
> fits a lot better.
>> This seems to be a paradox. Could anybody maybe explain how this is
> possible?
>> I also looked at the situation where I impose fixed intercepts and slopes
> on the participant level (so intercepts and slopes could only vary per
> school):
>> <R CODE>
>>      rep_measures.2.null  <- lmer(formula = usedCannabis_bi ~
>>                                   1 + moment + (1 + moment | school),
>>                                   family=binomial(link = "logit"),
> data=dat.long);
>>      rep_measures.2.model <- update(rep_measures.2.null, .~. +
> moment*cannabisShow);
>>      rep_measures.2.null;
>>      rep_measures.2.model;
>>      anova(rep_measures.2.null, rep_measures.2.model); </R CODE>
>>
>> Now the interaction between 'measurement moment' and 'intervention' is
> significant, as I expected; but the improvement in fit between the null
> model and the 'full model' is much, much smaller.
>> This is very counter-intuitive to me - I have the feeling I'm missing
> something basic, but I have no idea what. Any help is much appreciated!
>> Thank you very much in advance, kind regards,
>>
>> Gjalt-Jorn
>>
>>
>> PS: the file with the analyses is at
>> http://sciencerep.org/files/7/the%20cannabis%20show%20-%20analyses%20f
>> or%20mailing%20list.r
>>
>> _______________________________________________
>> R-sig-mixed-models at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>> * * * * * * * * * * * * * D I S C L A I M E R * * * * * * * * * * * *
>> * Dit bericht en eventuele bijlagen geven enkel de visie van de schrijver
> weer en binden het INBO onder geen enkel beding, zolang dit bericht niet
> bevestigd is door een geldig ondertekend document.
>> The views expressed in this message and any annex are purely those of the
> writer and may not be regarded as stating an official position of INBO, as
> long as the message is not confirmed by a duly signed document.
>
>
>          [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> * * * * * * * * * * * * * D I S C L A I M E R * * * * * * * * * * * * *
> Dit bericht en eventuele bijlagen geven enkel de visie van de schrijver weer
> en binden het INBO onder geen enkel beding, zolang dit bericht niet
> bevestigd is door een geldig ondertekend document.
> The views expressed in this message and any annex are purely those of the
> writer and may not be regarded as stating an official position of INBO, as
> long as the message is not confirmed by a duly signed document.
>
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models


From bbolker at gmail.com  Wed Nov  7 16:00:47 2012
From: bbolker at gmail.com (Ben Bolker)
Date: Wed, 7 Nov 2012 15:00:47 +0000 (UTC)
Subject: [R-sig-ME]
	=?utf-8?q?lmer=3A_No_significant_coefficients=2C=09but?=
	=?utf-8?q?_significant_improvement_of_model_fit=3F?=
References: <E1TTVJR-0004lN-Vu@fertilehosting.nl>
Message-ID: <loom.20121107T154025-737@post.gmane.org>

 <r-sig-mixed-models at ...> writes:

>  Hey all, This is my first post - but I assume that like at other
> lists, brevity is appreciated, so I have a short version and a long
> version:

  thanks.  I will answer the short version and see how far I get
with the long version.

> 
> SHORT VERSION, QUESTIONS ONLY:
 
> 1) how is it possible that using lmer, none of the fixed effects has
> significant coefficients, yet the model with those parameters fits
> significantly better than a model without those parameters? Is this
> an example of why lmer didn\'t use to report p-values for the
> coefficients?

  This is not really an lmer question, but a more general modeling
question.  There are a few things you could mean here, but I don't
think any of them have to do with the "p-value issue", which is
more one of how to deal with the unknown distribution of the test
statistic under the null hypothesis for not-large data sets
{see http://glmm.wikidot.com/faq for more links on the p-value stuff,
and others}

  * you could be asking about the difference between the results
of summary() [which uses Wald tests based on local curvature]
and anova() [which does a more precise test based on model comparison];
anova() is not perfect, but it's more accurate (and hence sometimes
different from) summary
  * you could be asking about multiple predictors, none of which
is individually significant at p<0.05, but their combined effects
(i.e. comparing a model with all predictors vs. none) are significant 
at p<0.05.  This is not really surprising, because the joint effect
of the predictors can be stronger than any one individually.  (Also,
if you're not working with a balanced, nested LMM, the effects of
the predictors can interact.)

> 2) what do the slash and the colon mean exactly when specifying lmer models?

  A colon refers to an interaction, a slash refers to nesting (so
~a/b is equivalent to ~a+a:b, or "b nested within a"): there's more
on this at the wikidot FAQ as well.


> LONG VERSION WITH BACKGROUND: I am unexperienced with mixed models,
> but I have a dataset that has several levels that needs to be
> analysed - and I \'always\' wanted to learn multilevel analysis
> anyway, so I decided this was a good occasion.  However, there are
> no courses at hand in the near future, so I\'m trying to get there
> with online resources and some books (such as \"discovering
> statistics using R\" by Andy Field, and in a slightly different
> category, the Multilevel Analysis book by Joop and the one by
> Snijders & Bosker. However, apparently, I lack what it takes to
> autodidactically learn this :-/ So I apologise, but I decided to
> draw on your wisdom.  I\'m also kind of hoping that doing multilevel
> analyses is a good way of learning how to do them.
 
> I must admit that I don\'t feel like I master the lmer model
> formulation, but I found a post by Harold Doran [1] where he
> explains the lmer syntax. My data file is structured the same as the
> one he models in fm3, fm4 and fm5. I have the following variables
> (of interest):

* cannabisUse_bi: a factor with two levels, \"0\" and \"1\". \'0\'
  indicates no cannabis use in the past week; \'1\' indicates cannabis
  use in the past week. This is the dependent variable (i.e. the
  criterion).
* moment: a factor with two levels, \'before\' and \'after\'
* id.factor: a factor with 444 levels, the identification of each
  participants (note that there are quite a lot of missing values,
  only about 276 cases without missings)
* school: a factor with 8 levels, each representing the school that
  the participants attend
* cannabisShow: a factor with 2 levels, \'control\' and
 \'intervention\' - this reflects whether a participant received the
 \'intervention\', aimed to decrease cannabis use, or
 not. Participants in five schools received the intervention;
 participants in three other schools didn\'t.
 
> Every person provided two datapoints (one before the intervention
> took place, and one after); there are several persons in a school;
> and there are several school in each condition (level) of
> cannabisShow.
 
> As far as I understand, this translates to \"Moment is nested within
> person (\'id.factor\'), which is nested within school, which is
> nested within cannabisShow\" (not sure about that last bit).

  Although others on this list disagree, I don't find "nesting" to be
very useful in the context of fixed effects, because the levels of
fixed effects almost always have identical meanings across different
levels of the random effect (i.e., "before" means the same for me as
for you)

 I would say the simplest sensible model would be

glmer(cannabisUse_bi ~ cannabisShow*moment + (1|school/id.factor), 
    family=binomial, data=dat.long)

which if your individuals are uniquely identified should be the same
as using (1|school) + (1|id.factor) as the random effects.

But I agree that you may very well want to try to take into account
whether the effects of the fixed effects differ among schools: you
might _like_ to see whether they differ among individuals as well, but
it is somewhere between impossible and very difficult to extract this
from binary data per individual (I'm sure you can't identify the
effects of cannabisShow, because each individual only gets one
intervention, and I'm pretty sure that you can't identify the effects
of before/after either, because all you have is binary data -- if you
had continuous data you *might* be able to detect variation in slope
among individuals, if it weren't confounded with residual error).

So I would try

glmer(cannabisUse_bi ~ cannabisShow*moment +
   (cannabisShow*moment|school) + (1|id.factor), family=binomial,
   data=dat.long)

(assuming that id.factor is unique across schools)


> Now, this model doesn\'t include the effect of the intervention, and
  if I include that, I get:
 
> rep_measures.new.model <- lmer(usedCannabis_bi ~ 1 + moment *
> cannabisShow + (moment|school/id.factor), family=binomial(link =
> \"logit\"), data=dat.long);
 
> If I compare these two models using Anova, the second one fits
> better (logLik from -182.02 to -166.68, ChiSq = 30.681, Df = 2, p =
> 2.177e-07). However, when you look at rep_measures.new.model, none
> of the fixed effects is significant. I may be completely wrong, but
> doesn\'t this mean that the cannabisShow variable, nor its
> interaction with measurement moment (i.e. \'time\'), contributes to
> explaining the dependent variable (i.e. cannabisUse_bi)?

  Maybe the before/after variation among schools (moment|school) is
  doing a lot?  Also, see my comment above about Wald tests.
 
> (in fact, I\'m also a bit confused as to the p-values that lmer
> provides for the fixed effects. I thought that there were good
> reasons not to - and that lmer wasn\'t supposed to? [3] (I don\'t
> understand the post - I\'m sadly not a statistician - but I thought
> I got the gist) Apparently this changed . . . ?)

  glmer provides likelihood ratio tests, which are good when the
sample size is large.  If you didn't have the school level I would say
not to worry about it, but 8 schools is not a large number ...

>  And now that I\'m mailing anyway: what is the difference between
> these two models?
 
> rep_measures.new.model.1 <- lmer(usedCannabis_bi ~ 1 + moment *
> cannabisShow + (moment|school/id.factor), family=binomial(link =
> \"logit\"), data=dat.long);

> rep_measures.new.model.2 <- lmer(usedCannabis_bi ~ 1 + moment *
> cannabisShow + (moment|id.factor:school), family=binomial(link =
> \"logit\"), data=dat.long);
 
> R gives slightly (but only slightly) different coefficient
> estimates; but on the first one, he seems to understand that school
> is a level (with 8 values), where for the second one, this is
> apparently not specified . . . What\'s the difference between the
> slash and the colon for indicating levels (the levels have to be
> \'the other way around\', apparently?)?

  The second leaves out the school effect, as specified above.

>  I\'m sorry to bother the list with such basic questions. I\'ve been
> looking for a tutorial or explanation, but I\'ve only been able to
> find little bits of information that I pieced together into my
> current (lack of ) understanding . . .
 
> Thank you in advance!
> 
> Gjalt-Jorn Peters
 
> PS: I\'ve put the R script at
> http://sciencerep.org/files/7/the%20cannabis%20show%20-%20analyses.r
> (the part I\'m talking about now starts after the line with \"######
> Behaviour\", line 195 - the real analyses I\'m talking about now
> start at line 314) This .R file downloads the data from
> http://sciencerep.org/files/7/the%20cannabis%20show%20-%20data.tsv
 
> The output you should get is at
> http://sciencerep.org/files/7/the%20cannabis%20show%20-%20output.txt
> (but the output file is kind of hard to interpret without the
> analyses file, as I didn\'t \"cat\" all comments)
 
> [1] http://tolstoy.newcastle.edu.au/R/e2/help/06/10/3345.html
> [2] http://www.rensenieuwenhuis.nl/r-sessions-17-generalized-multilevel-lme4/
>     http://www.talkstats.com/showthread.php/
    14393-Need-help-with-lmer-model-specification-syntax-for-nested-mixed-model
>     http://www.bodowinter.com/tutorial/bw_LME_tutorial.pdf
> [3] https://stat.ethz.ch/pipermail/r-help/2006-May/094765.html
> 
>


From a.mosnier at gmail.com  Wed Nov  7 17:18:29 2012
From: a.mosnier at gmail.com (Arnaud Mosnier)
Date: Wed, 7 Nov 2012 11:18:29 -0500
Subject: [R-sig-ME] R-sig-mixed-models Digest, Vol 71, Issue 11
In-Reply-To: <mailman.5199.1352300482.4555.r-sig-mixed-models@r-project.org>
References: <mailman.5199.1352300482.4555.r-sig-mixed-models@r-project.org>
Message-ID: <CANkFkEcrnH-qmYSy7hzwiwXSi3CQ623cp6Jv6WFOjQG=tv8A-A@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121107/a3d20804/attachment.pl>

From Ulrich.Halekoh at agrsci.dk  Wed Nov  7 17:27:17 2012
From: Ulrich.Halekoh at agrsci.dk (Ulrich Halekoh)
Date: Wed, 7 Nov 2012 16:27:17 +0000
Subject: [R-sig-ME] beta0 lmer (R-forge version)
Message-ID: <4CDE4D165154CE46A9B4330BE2D8819302135D@SRVUNIMBX08.uni.au.dk>

Dear,
I would like to know the meaning of the beta0 of a fitted lmer-object  using
the lme4 package from R-Forge version '0.99999911.0'

Example:
data(Orthodont,package='nlme')
library(lme4) #R-forge!
mot<-lmer(distance ~ Sex + (1|Subject),data=Orthodont)

mot at pp$beta0


Kind regards

Ulrich Halekoh
Associate Professor
Email: Ulrich.Halekoh at agrsci.dk
Aarhus University; Denmark


From bates at stat.wisc.edu  Wed Nov  7 18:20:06 2012
From: bates at stat.wisc.edu (Douglas Bates)
Date: Wed, 7 Nov 2012 11:20:06 -0600
Subject: [R-sig-ME] beta0 lmer (R-forge version)
In-Reply-To: <4CDE4D165154CE46A9B4330BE2D8819302135D@SRVUNIMBX08.uni.au.dk>
References: <4CDE4D165154CE46A9B4330BE2D8819302135D@SRVUNIMBX08.uni.au.dk>
Message-ID: <CAO7JsnQ9xPCWavVUeo=xsKA+xD5PG1YuAZXfQh8Tft_amDVBXg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121107/2cf0195b/attachment.pl>

From a.mosnier at gmail.com  Wed Nov  7 19:08:17 2012
From: a.mosnier at gmail.com (Arnaud Mosnier)
Date: Wed, 7 Nov 2012 13:08:17 -0500
Subject: [R-sig-ME] R-sig-mixed-models Digest, Vol 71, Issue 10
In-Reply-To: <mailman.5190.1352298422.4555.r-sig-mixed-models@r-project.org>
References: <mailman.5190.1352298422.4555.r-sig-mixed-models@r-project.org>
Message-ID: <CANkFkEdBZvUCTFHCi6jZg3=yjkuT1CfHweQxZ0OY-7KZPXO41w@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121107/a110cb10/attachment.pl>

From highstat at highstat.com  Wed Nov  7 21:07:32 2012
From: highstat at highstat.com (Highland Statistics Ltd)
Date: Wed, 07 Nov 2012 22:07:32 +0200
Subject: [R-sig-ME] R-sig-mixed-models Digest, Vol 71, Issue 11
In-Reply-To: <CANkFkEcrnH-qmYSy7hzwiwXSi3CQ623cp6Jv6WFOjQG=tv8A-A@mail.gmail.com>
References: <mailman.5199.1352300482.4555.r-sig-mixed-models@r-project.org>
	<CANkFkEcrnH-qmYSy7hzwiwXSi3CQ623cp6Jv6WFOjQG=tv8A-A@mail.gmail.com>
Message-ID: <509ABF84.4060206@highstat.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121107/b41833cd/attachment.pl>

From bbolker at gmail.com  Wed Nov  7 21:25:09 2012
From: bbolker at gmail.com (Ben Bolker)
Date: Wed, 7 Nov 2012 20:25:09 +0000 (UTC)
Subject: [R-sig-ME] phi values from corARMA etc. [was Re: R-sig-mixed-models
	Digest, Vol 71, Issue 10]
References: <mailman.5190.1352298422.4555.r-sig-mixed-models@r-project.org>
	<CANkFkEdBZvUCTFHCi6jZg3=yjkuT1CfHweQxZ0OY-7KZPXO41w@mail.gmail.com>
Message-ID: <loom.20121107T205114-416@post.gmane.org>

Arnaud Mosnier <a.mosnier at ...> writes:

> Thanks Ben, as I answer to Alain Zuur, I will try providing a starting
> value for Phi (different from the default value 0).
> I just need a way to decide what kind of value would be useful, i.e. as in
> viewing a plot of correlation vs time.
> My problem is that my data are taken at an irregular time step (Argos data).
> 
> Arnaud

  If you have irregularly spaced time steps, you probably want to
start with corCAR1.  I don't think lme has any built-in capability
to do more complex continuous-time correlation structures (i.e.
something like corCARMA).  If you really need it you might have to
write your own corStruct (ugh) ... but especially because you report
that there's not much going on, you might be able to get away with
corCAR1 ... ?

[snip]

> >
> > Arnaud Mosnier <a.mosnier at ...> writes:

 [snip]

> > > I made a mixed model of the form
> > >
> > > lme(Distance ~ season, random = ~1|yearTagged/tag, correlation =
> > > corAR1(form= ~Time|yearTagged/tag), data = dat)
> > >
> > > or
> > >
> > > lme(Distance ~ season, random = ~1|yearTagged/tag, correlation =
> > > corARMA(form= ~Time|yearTagged/tag, p=1, q=1), data = dat)
> > >
> > > In the AR1 model, the Phi value obtained for the corAR1 structure is 0.
> > > In the ARMA(1,1) model, both Phi1 and Theta1 are equal to 0.
> > >
> > > I find this strange. I believed first that it was caused by the fact that
> > > yearTagegd and tag variables were not considered as factor, but it did
> > not
> > > change anything if I convert them to factor.
> > > The temporal autocorrelation is not obvious in the residuals of the model
> > > without a temporal structure included (i.e. without corAR1 or corARMA),
> > but
> > > can I conclude that there is not correlation based on Phi value ?

 [trimmed to make Gmane happy]


From gjalt-jorn at behaviorchange.eu  Thu Nov  8 11:16:22 2012
From: gjalt-jorn at behaviorchange.eu (Gjalt-Jorn Peters)
Date: Thu, 08 Nov 2012 11:16:22 +0100
Subject: [R-sig-ME] lmer: No significant coefficients,
 but significant improvement of model fit?
In-Reply-To: <loom.20121107T154025-737@post.gmane.org>
References: <E1TTVJR-0004lN-Vu@fertilehosting.nl>
	<loom.20121107T154025-737@post.gmane.org>
Message-ID: <509B8676.4080101@behaviorchange.eu>

Dear Ben,

thank you very, very much for your extensive answer!

I have run both models you suggest, and they fit equally well (Chi^2 = 
.99). In addition, the effect of each predictor is the same in both 
models (which makes sense of course).

I will just look at each effects' significance level, as per your 
worries regarding the number of schools (i.e. 8 is not many school).

Before endeavoring more interpretation, though, I will first read up on 
mixed models using the valuable suggestions given earlier :-)

Again, thank you very, very much for your answer, kind regards,

Gjalt-Jorn

*Gjalt-Jorn Peters* | http://behaviorchange.eu

Behavior change research | Health psychology
Intervention development | Applied social psychology 	[ 	GG 
<http://greatergood.eu> 	OU <http://ou.nl> 	UM 
<http://maastrichtuniversity.nl> 	}


On 07-11-2012 16:00, Ben Bolker wrote:
>   <r-sig-mixed-models at ...> writes:
>
>>   Hey all, This is my first post - but I assume that like at other
>> lists, brevity is appreciated, so I have a short version and a long
>> version:
>    thanks.  I will answer the short version and see how far I get
> with the long version.
>
>> SHORT VERSION, QUESTIONS ONLY:
>   
>> 1) how is it possible that using lmer, none of the fixed effects has
>> significant coefficients, yet the model with those parameters fits
>> significantly better than a model without those parameters? Is this
>> an example of why lmer didn\'t use to report p-values for the
>> coefficients?
>    This is not really an lmer question, but a more general modeling
> question.  There are a few things you could mean here, but I don't
> think any of them have to do with the "p-value issue", which is
> more one of how to deal with the unknown distribution of the test
> statistic under the null hypothesis for not-large data sets
> {see http://glmm.wikidot.com/faq for more links on the p-value stuff,
> and others}
>
>    * you could be asking about the difference between the results
> of summary() [which uses Wald tests based on local curvature]
> and anova() [which does a more precise test based on model comparison];
> anova() is not perfect, but it's more accurate (and hence sometimes
> different from) summary
>    * you could be asking about multiple predictors, none of which
> is individually significant at p<0.05, but their combined effects
> (i.e. comparing a model with all predictors vs. none) are significant
> at p<0.05.  This is not really surprising, because the joint effect
> of the predictors can be stronger than any one individually.  (Also,
> if you're not working with a balanced, nested LMM, the effects of
> the predictors can interact.)
>
>> 2) what do the slash and the colon mean exactly when specifying lmer models?
>    A colon refers to an interaction, a slash refers to nesting (so
> ~a/b is equivalent to ~a+a:b, or "b nested within a"): there's more
> on this at the wikidot FAQ as well.
>
>
>> LONG VERSION WITH BACKGROUND: I am unexperienced with mixed models,
>> but I have a dataset that has several levels that needs to be
>> analysed - and I \'always\' wanted to learn multilevel analysis
>> anyway, so I decided this was a good occasion.  However, there are
>> no courses at hand in the near future, so I\'m trying to get there
>> with online resources and some books (such as \"discovering
>> statistics using R\" by Andy Field, and in a slightly different
>> category, the Multilevel Analysis book by Joop and the one by
>> Snijders & Bosker. However, apparently, I lack what it takes to
>> autodidactically learn this :-/ So I apologise, but I decided to
>> draw on your wisdom.  I\'m also kind of hoping that doing multilevel
>> analyses is a good way of learning how to do them.
>   
>> I must admit that I don\'t feel like I master the lmer model
>> formulation, but I found a post by Harold Doran [1] where he
>> explains the lmer syntax. My data file is structured the same as the
>> one he models in fm3, fm4 and fm5. I have the following variables
>> (of interest):
> * cannabisUse_bi: a factor with two levels, \"0\" and \"1\". \'0\'
>    indicates no cannabis use in the past week; \'1\' indicates cannabis
>    use in the past week. This is the dependent variable (i.e. the
>    criterion).
> * moment: a factor with two levels, \'before\' and \'after\'
> * id.factor: a factor with 444 levels, the identification of each
>    participants (note that there are quite a lot of missing values,
>    only about 276 cases without missings)
> * school: a factor with 8 levels, each representing the school that
>    the participants attend
> * cannabisShow: a factor with 2 levels, \'control\' and
>   \'intervention\' - this reflects whether a participant received the
>   \'intervention\', aimed to decrease cannabis use, or
>   not. Participants in five schools received the intervention;
>   participants in three other schools didn\'t.
>   
>> Every person provided two datapoints (one before the intervention
>> took place, and one after); there are several persons in a school;
>> and there are several school in each condition (level) of
>> cannabisShow.
>   
>> As far as I understand, this translates to \"Moment is nested within
>> person (\'id.factor\'), which is nested within school, which is
>> nested within cannabisShow\" (not sure about that last bit).
>    Although others on this list disagree, I don't find "nesting" to be
> very useful in the context of fixed effects, because the levels of
> fixed effects almost always have identical meanings across different
> levels of the random effect (i.e., "before" means the same for me as
> for you)
>
>   I would say the simplest sensible model would be
>
> glmer(cannabisUse_bi ~ cannabisShow*moment + (1|school/id.factor),
>      family=binomial, data=dat.long)
>
> which if your individuals are uniquely identified should be the same
> as using (1|school) + (1|id.factor) as the random effects.
>
> But I agree that you may very well want to try to take into account
> whether the effects of the fixed effects differ among schools: you
> might _like_ to see whether they differ among individuals as well, but
> it is somewhere between impossible and very difficult to extract this
> from binary data per individual (I'm sure you can't identify the
> effects of cannabisShow, because each individual only gets one
> intervention, and I'm pretty sure that you can't identify the effects
> of before/after either, because all you have is binary data -- if you
> had continuous data you *might* be able to detect variation in slope
> among individuals, if it weren't confounded with residual error).
>
> So I would try
>
> glmer(cannabisUse_bi ~ cannabisShow*moment +
>     (cannabisShow*moment|school) + (1|id.factor), family=binomial,
>     data=dat.long)
>
> (assuming that id.factor is unique across schools)
>
>
>> Now, this model doesn\'t include the effect of the intervention, and
>    if I include that, I get:
>   
>> rep_measures.new.model <- lmer(usedCannabis_bi ~ 1 + moment *
>> cannabisShow + (moment|school/id.factor), family=binomial(link =
>> \"logit\"), data=dat.long);
>   
>> If I compare these two models using Anova, the second one fits
>> better (logLik from -182.02 to -166.68, ChiSq = 30.681, Df = 2, p =
>> 2.177e-07). However, when you look at rep_measures.new.model, none
>> of the fixed effects is significant. I may be completely wrong, but
>> doesn\'t this mean that the cannabisShow variable, nor its
>> interaction with measurement moment (i.e. \'time\'), contributes to
>> explaining the dependent variable (i.e. cannabisUse_bi)?
>    Maybe the before/after variation among schools (moment|school) is
>    doing a lot?  Also, see my comment above about Wald tests.
>   
>> (in fact, I\'m also a bit confused as to the p-values that lmer
>> provides for the fixed effects. I thought that there were good
>> reasons not to - and that lmer wasn\'t supposed to? [3] (I don\'t
>> understand the post - I\'m sadly not a statistician - but I thought
>> I got the gist) Apparently this changed . . . ?)
>    glmer provides likelihood ratio tests, which are good when the
> sample size is large.  If you didn't have the school level I would say
> not to worry about it, but 8 schools is not a large number ...
>
>>   And now that I\'m mailing anyway: what is the difference between
>> these two models?
>   
>> rep_measures.new.model.1 <- lmer(usedCannabis_bi ~ 1 + moment *
>> cannabisShow + (moment|school/id.factor), family=binomial(link =
>> \"logit\"), data=dat.long);
>> rep_measures.new.model.2 <- lmer(usedCannabis_bi ~ 1 + moment *
>> cannabisShow + (moment|id.factor:school), family=binomial(link =
>> \"logit\"), data=dat.long);
>   
>> R gives slightly (but only slightly) different coefficient
>> estimates; but on the first one, he seems to understand that school
>> is a level (with 8 values), where for the second one, this is
>> apparently not specified . . . What\'s the difference between the
>> slash and the colon for indicating levels (the levels have to be
>> \'the other way around\', apparently?)?
>    The second leaves out the school effect, as specified above.
>
>>   I\'m sorry to bother the list with such basic questions. I\'ve been
>> looking for a tutorial or explanation, but I\'ve only been able to
>> find little bits of information that I pieced together into my
>> current (lack of ) understanding . . .
>   
>> Thank you in advance!
>>
>> Gjalt-Jorn Peters
>   
>> PS: I\'ve put the R script at
>> http://sciencerep.org/files/7/the%20cannabis%20show%20-%20analyses.r
>> (the part I\'m talking about now starts after the line with \"######
>> Behaviour\", line 195 - the real analyses I\'m talking about now
>> start at line 314) This .R file downloads the data from
>> http://sciencerep.org/files/7/the%20cannabis%20show%20-%20data.tsv
>   
>> The output you should get is at
>> http://sciencerep.org/files/7/the%20cannabis%20show%20-%20output.txt
>> (but the output file is kind of hard to interpret without the
>> analyses file, as I didn\'t \"cat\" all comments)
>   
>> [1] http://tolstoy.newcastle.edu.au/R/e2/help/06/10/3345.html
>> [2] http://www.rensenieuwenhuis.nl/r-sessions-17-generalized-multilevel-lme4/
>>      http://www.talkstats.com/showthread.php/
>      14393-Need-help-with-lmer-model-specification-syntax-for-nested-mixed-model
>>      http://www.bodowinter.com/tutorial/bw_LME_tutorial.pdf
>> [3] https://stat.ethz.ch/pipermail/r-help/2006-May/094765.html
>>
>>
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models


From j.hadfield at ed.ac.uk  Thu Nov  8 12:47:48 2012
From: j.hadfield at ed.ac.uk (Jarrod Hadfield)
Date: Thu, 08 Nov 2012 11:47:48 +0000
Subject: [R-sig-ME] New version of MCMCglmm
In-Reply-To: <509B8676.4080101@behaviorchange.eu>
References: <E1TTVJR-0004lN-Vu@fertilehosting.nl>
	<loom.20121107T154025-737@post.gmane.org>
	<509B8676.4080101@behaviorchange.eu>
Message-ID: <20121108114748.170630yo1ugfgr28@www.staffmail.ed.ac.uk>

Hi,

I've uploaded a new version of MCMCglmm to CRAN. Main additions are I)  
more flexible methods for multi-membership and related models II) bug  
fix for the predict function for certain types of random-effect  
marginalisation.  III) sir models reinstated  IV) proposal  
distribution for MH steps returned.

Cheers,

Jarrod



I) The addition of a linking.function that links different random  
effects together. For example imagine two random terms, mother and  
grandmother, for which some mothers also appear as grandmothers.  
Denoting the associated random effect for the mothers (m) and  
grandomothers (g)  we could:

a) fit the simple model ~mother+grandmother which estimates separate  
variances (VAR(m) and VAR(g)) and sets the covariance to zero  
(COV(m,g)=0)

b) use the linking function "str" to fit the model  
~str(mother+grandmother) which estimates separate variances (VAR(m)  
and VAR(g)) but also estimates the covariance (COV(m,g))

c) use the linking function "mm" to fit a multimembership model  
~mm(mother+grandmother) which forces the variances to be equal  
(VAR(m)= VAR(g)) and forces the correlation to be one  
(COV(m,g)=VAR(m)= VAR(g)). Multi-membership models can still be fit  
using idv(mult.memb(~mother+grandmother))

Terms within mm or str can be linked to a ginverse if the ginverse  
list name corresponds to the first term in the linking.function (i.e.  
ginverse=list(mother=A) in the models above). They can also be  
interacted with variance functions (i.e.  
us(sex):str(mother+grandmother) is possible)

II) The predict function did not obtain the correct contribution to  
the variance from the marginalised random effects when us(function)  
defined the marginalised terms and the function was such that a single  
datum was associated with >1 term. For example, in a random regression  
us(1+x) we have the variance for datum i as  
V[1,1]+2*x[i]*V[1,2]+(x[i]^2)*V[2,2]  where V[1,1] is the variance in  
intercept, V[2,2] is the variance in slopes and V[1,2] the covariance  
between intercept and slope.  The term 2*x[i]*V[1,2] was omitted in  
the older versions.  This may effect confidence intervals and fitted  
values on the data scale for non-gaussian data, and prediction  
intervals more generally.

III) sir models have gone back to a dense specification. This means  
that big data sets may run out of memory when setting up the  
equations, but at least it will run if this is not the case.

IV) Tune element in output gives the proposal distribution for the  
latent variables that was used (after the adaptive phase).







-- 
The University of Edinburgh is a charitable body, registered in
Scotland, with registration number SC005336.


From maciej.swat at gmail.com  Thu Nov  8 14:31:39 2012
From: maciej.swat at gmail.com (Maciej Swat)
Date: Thu, 8 Nov 2012 13:31:39 +0000
Subject: [R-sig-ME] discrete data model classification
Message-ID: <1BCFE81F-A127-41B8-858B-5E11C67E8EC5@gmail.com>


Hi,

I am interested in the classification of discrete data models.

The classification below I came up with is strongly based on Agresti (2002), Dobson (2002) and Plan et al. (2009), the last one compares different count-data models as used in pharmacometrics.

There are probably much more complex classifications, not only restricted to GLMs, out there but that's what I found out so far based on mentioned references.

Any comments, corrections and suggestions would be very appreciated.

Best Regards,
Maciej



1 Categorical data ? Logit models 

1.1 Binary response
1.1.1 Single explanatory variabel
e.g. Linear probability model, Logistic regression model 
1.1.2 Multiple explanatory variabels
e.g. General logistic regression model 

1.2 Multi-category response
1.2.1 Nominal response variables 
e.g. Reference category logit model
1.2.2 Ordinal response variables ? cumulative logit 
e.g. Cumulative logit model, Proportional odds model, Adjacent category logit model, Continuation ratio logit model 
1.2.3 Ordinal response variables ? cumulative link

2 Categorical data ? other models 
e.g. Probit model, Log-log model 

3 Count data
e.g. Poisson model, Poisson model with Markovian elements, Poisson model with mixture distribution, Negative Binomial model, Zero inflated model, Generalized Poisson model

4 Time-to-event
? Proportional hazard model, Weibull model



Agresti, A. (2002). Categorical data analysis. Wiley-Interscience, New York, 2nd ed edition.
Dobson, A. J. (2002). An introduction to generalized linear models. Chapman & Hall/CRC texts in statistical science	8 series. Chapman & Hall/CRC, Boca Raton, 2nd ed edition.
Plan, E. L., Maloney, A., Troc?niz, I. F., and Karlsson, M. O. (2009). Performance in population models for count	15 data, part i: maximum likelihood approximations. J Pharmacokinet Pharmacodyn, 36(4):353?66.


From dbebber at earthwatch.org.uk  Thu Nov  8 18:39:09 2012
From: dbebber at earthwatch.org.uk (Dan Bebber)
Date: Thu, 8 Nov 2012 17:39:09 +0000
Subject: [R-sig-ME] Error in lme.lmList (package nlme)
Message-ID: <072A17AB8F352A418FEE8CE1C1D4763B4180C2E9@EXCHANGE.earthwatchewe.lan>

I am receiving an unusual error message from lme.lmList in the nlme package.
The dataset is not huge (1265 observations of 31 groups), and I can send it to others to check if required.

The lmList call appears to work OK
fm1 <- lmList(equdist ~ year |pest,  data)

however, when I try
fm2 <- lme(fm1)
I get
Error in names(madRan) <- rNames : attempt to set an attribute on NULL

This is a new error (I ran the models successfully a few weeks ago).
When I try
example(lme.lmList)
the error does not appear, so seems to be something to do with my data.

Any clues gratefully received.
Thanks
Dan


From datkins at u.washington.edu  Fri Nov  9 01:18:36 2012
From: datkins at u.washington.edu (David Atkins)
Date: Thu, 08 Nov 2012 16:18:36 -0800
Subject: [R-sig-ME] predict with newdata -- New version of MCMCglmm
In-Reply-To: <20121108114748.170630yo1ugfgr28@www.staffmail.ed.ac.uk>
References: <20121108114748.170630yo1ugfgr28@www.staffmail.ed.ac.uk>
Message-ID: <509C4BDC.3050306@u.washington.edu>


[Posting to list as others might be interested...]

Jarrod--

Very cool to see the continued development of MCMCglmm.

My typical use of predict() functions (across various R regression-based 
commands) involves generating predictions on newdata -- typically to 
help interpret models involving non-linear terms and/or interactions. 
As far as I can tell, the predict function in v2.17 of MCMCglmm does not 
yet incorporate new data.

Any guess on when the newdata argument in predict.MCMCglmm might "come 
online"?

cheers, Dave

-- 
Dave Atkins, PhD

Department of Psychiatry and Behavioral Science
University of Washington
datkins at u.washington.edu
206-616-3879 	
http://depts.washington.edu/cshrb/

"We are drowning in information and starving for knowledge."
Rutherford Roger


From bbolker at gmail.com  Fri Nov  9 05:09:22 2012
From: bbolker at gmail.com (Ben Bolker)
Date: Fri, 9 Nov 2012 04:09:22 +0000 (UTC)
Subject: [R-sig-ME] Error in lme.lmList (package nlme)
References: <072A17AB8F352A418FEE8CE1C1D4763B4180C2E9@EXCHANGE.earthwatchewe.lan>
Message-ID: <loom.20121109T050757-758@post.gmane.org>

Dan Bebber <dbebber at ...> writes:

> I am receiving an unusual error message from lme.lmList in the nlme package.
> The dataset is not huge (1265 observations of 31 groups), and I can send it to
others to check if required.
> 
> The lmList call appears to work OK
> fm1 <- lmList(equdist ~ year |pest,  data)
> 
> however, when I try
> fm2 <- lme(fm1)
> I get
> Error in names(madRan) <- rNames : attempt to set an attribute on NULL
> 
> This is a new error (I ran the models successfully a few weeks ago).
> When I try
> example(lme.lmList)
> the error does not appear, so seems to be something to do with my data.

  A little hard to say without the data (or a small reproducible example).
I'm googlable if you want to send it to me.
  I think this method probably isn't very widely used so it's conceivable
(to me) that there's a bug, but it could be data that are messed up in
some way ... ?

  Ben Bolker


From marko.bachl at uni-hohenheim.de  Fri Nov  9 08:10:25 2012
From: marko.bachl at uni-hohenheim.de (Marko Bachl)
Date: Fri, 9 Nov 2012 08:10:25 +0100
Subject: [R-sig-ME] Fixed covariates in nlmer()
Message-ID: <CAE5vbrty=SuOeK1Gsc7g9B5Cc9r_4PKr683ieTf5h-=EfDcHrA@mail.gmail.com>

Dear all,
I have unsucessfully tried to figure out the syntax of nlmer() to
include fixed covariates in a nonlinear mixed-effects model.
This is how the syntax looks like in nlme() using the CO2 data.

m0.nlme = nlme(uptake ~ SSasympOff(conc, Asym, lrc, c0), fixed = Asym
+ lrc + c0 ~ 1, random = Asym + lrc + c0 ~ 1, data = CO2, start =
c(32.5, -4.7, 43.1)) # Model without fixed covariates
summary(m0.nlme)

m1.nlme = update(m0.nlme, fixed = Asym + lrc + c0 ~ Type * Treatment,
start = c(32.5, 0, 0, 0, -4.7, 0, 0, 0, 43.1, 0, 0, 0)) # Model with
fixed covariates
summary(m1.nlme) #does include estimates for fixed effects
anova(m0.nlme, m1.nlme) # Models are different

In nlmer(), the only model expression I could find without getting
syntax error messages looks like this:

m0.nlmer = nlmer(uptake ~ SSasympOff(conc, Asym, lrc, c0) ~ Asym + lrc
+ c0 | Plant, data = CO2, start = c(Asym = 32.5, lrc = -4.7, c0 =
43.1)) # Model without fixed covariates
summary(m0.nlmer)

m1.nlmer = nlmer(uptake ~ SSasympOff(conc, Asym, lrc, c0) ~ Asym *
Type * Treatment + (Asym + lrc + c0 | Plant), data = CO2, start =
c(Asym = 32.5, lrc = -4.7, c0 = 43.1)) # Model with fixed covariates;
Starting Values remain as in m0.
summary(m1.nlmer) #Does not include estimates for fixed effects
anova(m0.nlmer, m1.nlmer) # Models are excactly the same

Unfortunatelly, adding the fixed covariates into the model expression
does not change the model at all. Can anyone enlighten me how the
correct syntax should look like? As I am working on a nonlinear
mixed-effects model with cross-classified random effects, I really
want to use nlmer() instead of nlme().

I am very thankful for any advice
Best regards
Marko


--
www.komm.uni-hohenheim.de/bachl


From j.hadfield at ed.ac.uk  Fri Nov  9 09:50:16 2012
From: j.hadfield at ed.ac.uk (Jarrod Hadfield)
Date: Fri, 09 Nov 2012 08:50:16 +0000
Subject: [R-sig-ME] predict with newdata -- New version of MCMCglmm
In-Reply-To: <509C4BDC.3050306@u.washington.edu>
References: <20121108114748.170630yo1ugfgr28@www.staffmail.ed.ac.uk>
	<509C4BDC.3050306@u.washington.edu>
Message-ID: <20121109085016.65735uwoe30zdfs4@www.staffmail.ed.ac.uk>

Hi Dave,

I did intend to make it part of the current version. The difficulty is  
that if the fixed predictors in newdata have less levels than those in  
data, then things like the intercept will have a different  
interpretation. If data and newdata could be guaranteed to have the  
same levels for fixed terms (and terms within a variance.function)  
then it would be more straightforward. I guess I could return an error  
if this was not the case, and allow predictions on newdata when these  
conditions were satisfied....

Cheers,

Jarrod


Quoting David Atkins <datkins at u.washington.edu> on Thu, 08 Nov 2012  
16:18:36 -0800:

>
> [Posting to list as others might be interested...]
>
> Jarrod--
>
> Very cool to see the continued development of MCMCglmm.
>
> My typical use of predict() functions (across various R  
> regression-based commands) involves generating predictions on  
> newdata -- typically to help interpret models involving non-linear  
> terms and/or interactions. As far as I can tell, the predict  
> function in v2.17 of MCMCglmm does not yet incorporate new data.
>
> Any guess on when the newdata argument in predict.MCMCglmm might  
> "come online"?
>
> cheers, Dave
>
> -- 
> Dave Atkins, PhD
>
> Department of Psychiatry and Behavioral Science
> University of Washington
> datkins at u.washington.edu
> 206-616-3879
> http://depts.washington.edu/cshrb/
>
> "We are drowning in information and starving for knowledge."
> Rutherford Roger
>
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>
>



-- 
The University of Edinburgh is a charitable body, registered in
Scotland, with registration number SC005336.


From mariannestephan at hotmail.com  Fri Nov  9 14:39:39 2012
From: mariannestephan at hotmail.com (Marianne K.)
Date: Fri, 9 Nov 2012 14:39:39 +0100
Subject: [R-sig-ME] How do I check whether the assumptions of equal
 variances and normality are fulfilled for ezANOVA() ?
Message-ID: <DUB115-W19AA297B1609CA6BC8A5BBA9680@phx.gbl>

Ein eingebundener Text mit undefiniertem Zeichensatz wurde abgetrennt.
Name: nicht verf?gbar
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121109/ffab84b0/attachment.pl>

From mariannestephan at hotmail.com  Fri Nov  9 14:49:46 2012
From: mariannestephan at hotmail.com (Marianne K.)
Date: Fri, 9 Nov 2012 14:49:46 +0100
Subject: [R-sig-ME] Non-parametric 2x2 Mixed Factorial ANOVA in R?
Message-ID: <DUB115-W63869B67C8675309F75EB6A9680@phx.gbl>

Ein eingebundener Text mit undefiniertem Zeichensatz wurde abgetrennt.
Name: nicht verf?gbar
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121109/f264d026/attachment.pl>

From elepaio44 at yahoo.com  Fri Nov  9 16:23:51 2012
From: elepaio44 at yahoo.com (Matthew Medeiros)
Date: Fri, 9 Nov 2012 07:23:51 -0800 (PST)
Subject: [R-sig-ME] cross-level interactions and random effect structure
Message-ID: <1352474631.49174.YahooMailNeo@web142303.mail.bf1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121109/0707f74e/attachment.pl>

From asafw.at.wharton at gmail.com  Fri Nov  9 03:15:53 2012
From: asafw.at.wharton at gmail.com (Asaf Weinstein)
Date: Thu, 8 Nov 2012 21:15:53 -0500
Subject: [R-sig-ME] Getting started with lme4
Message-ID: <CAGG0PdBVQ9WqVwCzJ3QG0HxLSV-JESV7kW=j-n6wFsXFcr9t=A@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121108/5619e01e/attachment.pl>

From roby.joehanes at nih.gov  Fri Nov  9 17:16:01 2012
From: roby.joehanes at nih.gov (Joehanes, Roby (NIH/NHLBI) [F])
Date: Fri, 9 Nov 2012 11:16:01 -0500
Subject: [R-sig-ME] Getting started with lme4
In-Reply-To: <CAGG0PdBVQ9WqVwCzJ3QG0HxLSV-JESV7kW=j-n6wFsXFcr9t=A@mail.gmail.com>
Message-ID: <CCC29670.413E%joehanesr@mail.nih.gov>

Hi Asaf:

For Mac OS X (If I read you correctly), you should use the menu (Packages &
Data --> Package Installer). Then, click "Get List", navigate to lme4,
select "Install Dependencies" and click "Install Selected".

As far as I know, Penicilin data is not in lme4.

Sincerely,
Roby

On 11/8/12 9:15 PM, "Asaf Weinstein" <asafw.at.wharton at gmail.com> wrote:

> Hello all,
> 
> I am very new to lme4, and have a couple of technical questions.
> 
> 1) For Mac OS, is it true that I should use
> 
> install.packages("lme4",repos="http://lme4.r-forge.r-project.org/repos")
> 
> and not
> 
> install.packages("lme4",repos="http://r-forge.r-project.org")?
> 
> 2) Is the Penicillin data part of the lme4 package? data(Penicillin)
> does not work when I try it after loading the lme4 package..
> 
> 
> Thanks so much and sorry for the ignorance..
> 
> Asaf


From seth at swbigelow.net  Fri Nov  9 17:31:37 2012
From: seth at swbigelow.net (Seth W. Bigelow)
Date: Fri, 9 Nov 2012 11:31:37 -0500
Subject: [R-sig-ME] How do I check whether the assumptions of equal
	variances and normality are fulfilled for ezANOVA() ?
In-Reply-To: <DUB115-W19AA297B1609CA6BC8A5BBA9680@phx.gbl>
References: <DUB115-W19AA297B1609CA6BC8A5BBA9680@phx.gbl>
Message-ID: <000901cdbe97$b28ce650$17a6b2f0$@net>

Marianne:

I'm not an R or statistics expert, but I've gotten a lot of good advice from
those who are in this listserv, so I will attempt to pay it forward. (And I
don't know anything about EZ anova).

What you've said about your data suggests that a mixed model might be a good
way to analyze it. Group and Session would be fixed effects, and presumably
there is subject, let's say a person, on whom a response measurement is
taken at both sessions. Why start with a non-parametric model if you might
be able to use a parametric one?

There are two packages commonly used for r mixed models: nlme (older) and
lme4 (newer). Syntax for a simple analysis of your model in lme4 would look
like
 
m0 <- lmer(response~Group+Session+(1|PersonsName))  # this model does not
have an interaction effect
m1 <- lmer(response~Group*Session+(1|PersonsName))  # this model has an
interaction effect.

You can compare these models with a likelihood ratio test, e.g.
Anova(m0,m1)
It should give you a p value that will help to decide whether the
interaction model is justified.
Pinheiro & Bates (mixed effects models in S & S-Plus) is the standard mixed
models reference, it is more oriented toward nlme but is very useful.

I, and others on this listserv no doubt, would be happy to provide advice
re: residuals checking, if you decide to pursue the mixed models route.
Sincerely, Seth W. Bigelow 



-----Original Message-----
From: r-sig-mixed-models-bounces at r-project.org
[mailto:r-sig-mixed-models-bounces at r-project.org] On Behalf Of Marianne K.
Sent: Friday, November 09, 2012 8:40 AM
To: r-sig-mixed-models at r-project.org
Subject: [R-sig-ME] How do I check whether the assumptions of equal
variances and normality are fulfilled for ezANOVA() ?


Hello R and statistics experts,
(Sorry for this probably basic question. I know there is a lot written about
this topic, but it is still not clear to me.)

My data has one between-subject factor ("group", 2 levels, n=10 per group)
and one within-subject factor ("session", 2 levels). I would like to use the
ezANOVA function to test for main effects and interactions. 


Now, how do I check whether the assumptions of equal variance and normality
are fulfilled (which have to be fulfilled in order to use ezANOVA, right)?


As I understood, Mauchlys test (which would give me an information about
the equality of variances) is only calculated by ezANOVA if I have more than
two within-subject levels.


Do I have to check the normality of the residuals for each of the 4
condition combinations with e.g. the following functions: qqnorm(mpg),
qqline(mpg), shapiro.test(x)? How do I however get the residuals in order to
do this? Then, should I use for example the Fligner-Killeen test for
homogeneity of variances of all 4 condition combinations?

I would be grateful for any advice!
Thanks,Marianne 		 	   		  
	[[alternative HTML version deleted]]


From dwinsemius at comcast.net  Fri Nov  9 18:08:54 2012
From: dwinsemius at comcast.net (David Winsemius)
Date: Fri, 9 Nov 2012 09:08:54 -0800
Subject: [R-sig-ME] Getting started with lme4
In-Reply-To: <CCC29670.413E%joehanesr@mail.nih.gov>
References: <CCC29670.413E%joehanesr@mail.nih.gov>
Message-ID: <8AEFFAAD-5A5A-4D44-A74E-C7C7B504248E@comcast.net>


On Nov 9, 2012, at 8:16 AM, Joehanes, Roby (NIH/NHLBI) [F] wrote:

> Hi Asaf:
> 
> For Mac OS X (If I read you correctly), you should use the menu (Packages &
> Data --> Package Installer). Then, click "Get List", navigate to lme4,
> select "Install Dependencies" and click "Install Selected".
> 
> As far as I know, Penicilin data is not in lme4.

Asaf; 

I see problems with both paragraphs of this answer. The code you offered below did not specify the type of package and I am of the understanding that r-forge packages are usually of type="source". `install.packages` will default to type="mac.binary". Compiling packages from source on a Mac requires that you have the development tools for that purpose.

It is possible to install source packages with the GUI Package Installer, and it is possible to use the "Other Repository" dropdown choice, but that still requires that you have installed the needed development package.

I had no difficulty with this code:

data('Penicillin', package="lme4") 

... but got a warning with just data(Penicillin) because I did not have my copy of lme4 loaded at the time.

Generally questions about installing packages on a Mac should go to the proper R SIG mailing list. I would ask whether there is a reason you are not using the CRAN binary package? It would seem you are not quite ready for being on the bleeding edge.

-- 
David.

Running MacOS 10.6.8
R version 2.15.2 (2012-10-26) -- "Trick or Treat"
Copyright (C) 2012 The R Foundation for Statistical Computing
ISBN 3-900051-07-0
Platform: x86_64-apple-darwin9.8.0/x86_64 (64-bit)

> 
> Sincerely,
> Roby
> 
> On 11/8/12 9:15 PM, "Asaf Weinstein" <asafw.at.wharton at gmail.com> wrote:
> 
>> Hello all,
>> 
>> I am very new to lme4, and have a couple of technical questions.
>> 
>> 1) For Mac OS, is it true that I should use
>> 
>> install.packages("lme4",repos="http://lme4.r-forge.r-project.org/repos")
>> 
>> and not
>> 
>> install.packages("lme4",repos="http://r-forge.r-project.org")?
>> 
>> 2) Is the Penicillin data part of the lme4 package? data(Penicillin)
>> does not work when I try it after loading the lme4 package..
>> 
>> 
>> Thanks so much and sorry for the ignorance..
>> 
>> Asaf
> 
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models

David Winsemius, MD
Alameda, CA, USA


From anniehoen at gmail.com  Fri Nov  9 18:32:06 2012
From: anniehoen at gmail.com (Annie Hoen)
Date: Fri, 09 Nov 2012 12:32:06 -0500
Subject: [R-sig-ME] help with lme
Message-ID: <CCC2A846.19B58%anniehoen@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121109/bc27a7a1/attachment.pl>

From kw.stat at gmail.com  Fri Nov  9 19:37:27 2012
From: kw.stat at gmail.com (Kevin Wright)
Date: Fri, 9 Nov 2012 12:37:27 -0600
Subject: [R-sig-ME] help with lme
In-Reply-To: <CCC2A846.19B58%anniehoen@gmail.com>
References: <CCC2A846.19B58%anniehoen@gmail.com>
Message-ID: <CAKFxdiSv749-OXY-pFUiGvKX1knpS-vcmbPYs-Jjad7wH6i=Rw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121109/4ceff87c/attachment.pl>

From kw.stat at gmail.com  Fri Nov  9 20:06:39 2012
From: kw.stat at gmail.com (Kevin Wright)
Date: Fri, 9 Nov 2012 13:06:39 -0600
Subject: [R-sig-ME] help with lme
In-Reply-To: <CAKFxdiSv749-OXY-pFUiGvKX1knpS-vcmbPYs-Jjad7wH6i=Rw@mail.gmail.com>
References: <CCC2A846.19B58%anniehoen@gmail.com>
	<CAKFxdiSv749-OXY-pFUiGvKX1knpS-vcmbPYs-Jjad7wH6i=Rw@mail.gmail.com>
Message-ID: <CAKFxdiQTee-oOj1fPY-jS3q9+z=r-WfKjgPWWJPgA15CBTVKtw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121109/9d064726/attachment.pl>

From Ellen.Pape at ugent.be  Sun Nov 11 16:44:38 2012
From: Ellen.Pape at ugent.be (Ellen Pape)
Date: Sun, 11 Nov 2012 16:44:38 +0100
Subject: [R-sig-ME] relative importance of independendent variables in lm
	and lme models
Message-ID: <509FC7E6.5000907@ugent.be>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121111/754c4b38/attachment.pl>

From ellen.pape at gmail.com  Sun Nov 11 17:39:00 2012
From: ellen.pape at gmail.com (ellen pape)
Date: Sun, 11 Nov 2012 17:39:00 +0100
Subject: [R-sig-ME] Relative importance of independent variables for lm and
	lme models
Message-ID: <CANW5OGB2a_uOhr3sEBgD0p=BL2BJAbvJTnqB9-eSW=5BSiExGg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121111/6c036afd/attachment.pl>

From Thierry.ONKELINX at inbo.be  Mon Nov 12 11:47:58 2012
From: Thierry.ONKELINX at inbo.be (ONKELINX, Thierry)
Date: Mon, 12 Nov 2012 10:47:58 +0000
Subject: [R-sig-ME] relative importance of independendent variables in
 lm	and lme models
In-Reply-To: <509FC7E6.5000907@ugent.be>
References: <509FC7E6.5000907@ugent.be>
Message-ID: <AA818EAD2576BC488B4F623941DA742794746862@inbomail.inbo.be>

Dear Ellen,

Have a look at http://glmm.wikidot.com/faq and search for 'How can I test whether a random effect is significant?'

Best regards,

Thierry

ir. Thierry Onkelinx
Instituut voor natuur- en bosonderzoek / Research Institute for Nature and Forest
team Biometrie & Kwaliteitszorg / team Biometrics & Quality Assurance
Kliniekstraat 25
1070 Anderlecht
Belgium
+ 32 2 525 02 51
+ 32 54 43 61 85
Thierry.Onkelinx at inbo.be
www.inbo.be

To call in the statistician after the experiment is done may be no more than asking him to perform a post-mortem examination: he may be able to say what the experiment died of.
~ Sir Ronald Aylmer Fisher

The plural of anecdote is not data.
~ Roger Brinner

The combination of some data and an aching desire for an answer does not ensure that a reasonable answer can be extracted from a given body of data.
~ John Tukey

-----Oorspronkelijk bericht-----
Van: r-sig-mixed-models-bounces at r-project.org [mailto:r-sig-mixed-models-bounces at r-project.org] Namens Ellen Pape
Verzonden: zondag 11 november 2012 16:45
Aan: r-sig-mixed-models at r-project.org
Onderwerp: [R-sig-ME] relative importance of independendent variables in lm and lme models

Dear all,

I apologize if my question is a bit stupid, but I'm fairly new to the field of mixed effect modelling.

I have performed several regressions, during which I also tested for the significance of a random grouping variable. Most of the time, the random factor was not statistically significant but it was for some regressions.

I was wondering how to calculate the relative importance of the independent variables (I guess for the lme model I also need to look at the importance of the random variable?) for both lm and lme models?

Thanks!
Ellen
--
*/Ellen Pape (PhD student)/*

Ghent University
Marine Biology Research Group
Krijgslaan 281, S8
9000 Ghent (Belgium)

Email: Ellen.Pape at Ugent.be <mailto:Ellen.Pape at Ugent.be>
Tel: ++ 32 (0)9 264 85 23
Fax: ++ 32 (0)9 264 85 98


        [[alternative HTML version deleted]]

_______________________________________________
R-sig-mixed-models at r-project.org mailing list https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
* * * * * * * * * * * * * D I S C L A I M E R * * * * * * * * * * * * *
Dit bericht en eventuele bijlagen geven enkel de visie van de schrijver weer en binden het INBO onder geen enkel beding, zolang dit bericht niet bevestigd is door een geldig ondertekend document.
The views expressed in this message and any annex are purely those of the writer and may not be regarded as stating an official position of INBO, as long as the message is not confirmed by a duly signed document.


From antoine.paccard at unine.ch  Mon Nov 12 15:51:15 2012
From: antoine.paccard at unine.ch (Antoine PACCARD)
Date: Mon, 12 Nov 2012 15:51:15 +0100
Subject: [R-sig-ME] lme/lmer and random effects correlation parameters
Message-ID: <6C50350B-8BC6-427B-BEF0-CB2B2AD1A506@unine.ch>

Dear Mix modelers,

I am trying to run the following models:

m1 <- lme(A ~ treatment * lat, random= ~ 1 + treatment | population/family) 

or with lmer

m2 <- lmer(A ~ treatment * lat + (treatment |population/family))


Unfortunately m1 won't converge and I always get the following message: "iteration limit reached without convergence (10)". 
I understand this comes from random correlation parameters and this issue has been previously discussed in the past. However, I can't find a way to make it work and I was wondering if anybody had found a way to fix this problem.

lmer will work and converge properly. Unfortunately the following function to extract p-values won't work because of the same reason explained above:
pvals.fnc(m2, nsim = 10000)
"Error in pvals.fnc(m2, nsim = 10000) : MCMC sampling is not implemented in recent versions of lme4 for models with random correlation parameters"


I believe my models are correct since each family and each population have experienced treatment (when I get rid of "treatment" in the random parameters, the models work fine). Here is a sample of the data set:

population	lat		family	treatment	A
AA			37.724	35		AB			124
LLL			37.419	14		AB			249
AAJ			46.114	8		AB	
XXX		43.356	1		CD	
OOO		40.441	27		CD			244.5
FFF			36.418	6		CD			240
OOO		40.441	11		AB	
AA			37.724	28		AB	
AAF			46.114	17		CD			116.5
QQQ		39.491	19		CD			93.5
QQQ		39.491	21		AB			247
AAF			46.114	10		CD	
OOO		40.441	20		CD			227
UUU		42.996	25		AB			95.5
XXX		43.356	22		CD			209
AA			37.724	15		AB	
QQQ		39.491	29		AB			186
UUU		42.996	19		AB			110
UUU		42.996	3		AB			247


Any advice and help would be very appreciated. 

Many thanks,
Antoine

From bbolker at gmail.com  Mon Nov 12 15:59:54 2012
From: bbolker at gmail.com (Ben Bolker)
Date: Mon, 12 Nov 2012 14:59:54 +0000 (UTC)
Subject: [R-sig-ME] Non-parametric 2x2 Mixed Factorial ANOVA in R?
References: <DUB115-W63869B67C8675309F75EB6A9680@phx.gbl>
Message-ID: <loom.20121112T155117-900@post.gmane.org>

Marianne K. <mariannestephan at ...> writes:


> Hello!  My data has one between-subject factor ("group", 2 levels,
> n=10 per group) and one within-subject factor ("session", 2 levels).
> I am mainly interested in the interaction between group and
> session.Because of the small sample size (n=20 cases in total, 10
> per group), I though I should use a non-parametric test.  However,
> did I understand right that there doesn't exist any non-parametric
> mixed factorial ANOVA in R?

  Someone can correct me if I'm wrong, but as far as I'm aware
the problem is not so much "this method doesn't exist in R" as
"this method is hard to define in general" -- that is, controlling
for non-independence/grouping structure in nonparametrics is
not all that easy.

  A couple of thoughts:

 * robust methods may be an alternative -- someone posted about
this on the list recently
 * you could try bootstrapping or permutation testing (being careful
to respect the grouping structure of the data
 * two levels is not really enough to formally fit a random effect,
but depending on the details of your data structure you may be
able to do something much simpler.  For example, I'm going to guess
that your 20 observations represent paired observations (session 1,
session 2) on 5 individuals in each of two groups.  Compute the
within-subject differences between sessions for each individual:
now you have 5 differences in each group.  You can test the between-group
differences in response with an ordinary 1-way ANOVA on the
differences (for a single factor, the sums of squares etc. don't 
differ for random vs fixed effects, I think).  You can similarly
test differences in within-subject means etc.


From bbolker at gmail.com  Mon Nov 12 17:09:46 2012
From: bbolker at gmail.com (Ben Bolker)
Date: Mon, 12 Nov 2012 16:09:46 +0000 (UTC)
Subject: [R-sig-ME] lme/lmer and random effects correlation parameters
References: <6C50350B-8BC6-427B-BEF0-CB2B2AD1A506@unine.ch>
Message-ID: <loom.20121112T170344-535@post.gmane.org>

Antoine PACCARD <antoine.paccard at ...> writes:

> Dear Mix modelers,
> 
> I am trying to run the following models:
> 
> m1 <- lme(A ~ treatment * lat, random= ~ 1 + treatment | population/family) 
> 
> or with lmer
> 
> m2 <- lmer(A ~ treatment * lat + (treatment |population/family))

 
> Unfortunately m1 won't converge and I always get the following
> message: "iteration limit reached without convergence (10)".  I
> understand this comes from random correlation parameters and this
> issue has been previously discussed in the past. However, I can't
> find a way to make it work and I was wondering if anybody had found
> a way to fix this problem.

> lmer will work and converge properly. 

 I would be very careful about this statement.  Are you *sure* it
has converged properly?  Do the results make sense?  Do you get
non-trivial (not zero, not very very small, correlations not
equal to +/- 1.0) estimates for the variance-covariance matrix?

  Does centering the covariates help?

> Unfortunately the following function to extract p-values won't work
> because of the same reason explained above: pvals.fnc(m2, nsim =
> 10000) "Error in pvals.fnc(m2, nsim = 10000) : MCMC sampling is not
> implemented in recent versions of lme4 for models with random
> correlation parameters"

  http://glmm.wikidot.com/faq offers some alternatives.
I would consider parametric bootstrapping or Kenward-Roger
(perhaps using the functions in the pbkrtest package)
 
> I believe my models are correct since each family and each
> population have experienced treatment (when I get rid of "treatment"
> in the random parameters, the models work fine). Here is a sample of
> the data set:

  What are the missing (blank) values in the A column?
  Is that a glitch in the display, or are there really lots
of missing values?

> population	lat	family	treatment	A
> AA		37.724	35	AB		124
> LLL		37.419	14	AB		249
> AAJ		46.114	8	AB	
> XXX		43.356	1	CD	
> OOO		40.441	27	CD		244.5
> FFF		36.418	6	CD		240
> OOO		40.441	11	AB	
> AA		37.724	28	AB	
> AAF		46.114	17	CD		116.5
> QQQ		39.491	19	CD		93.5
> QQQ		39.491	21	AB		247
> AAF		46.114	10	CD	
> OOO		40.441	20	CD		227
> UUU		42.996	25	AB		95.5
> XXX		43.356	22	CD		209
> AA		37.724	15	AB	
> QQQ		39.491	29	AB		186
> UUU		42.996	19	AB		110
> UUU		42.996	3	AB		247


From Ellen.Pape at ugent.be  Mon Nov 12 13:00:50 2012
From: Ellen.Pape at ugent.be (Ellen Pape)
Date: Mon, 12 Nov 2012 13:00:50 +0100
Subject: [R-sig-ME] relative importance of independendent variables in
 lm	and lme models
In-Reply-To: <AA818EAD2576BC488B4F623941DA742794746862@inbomail.inbo.be>
References: <509FC7E6.5000907@ugent.be>
	<AA818EAD2576BC488B4F623941DA742794746862@inbomail.inbo.be>
Message-ID: <50A0E4F2.6020600@ugent.be>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121112/20372411/attachment.pl>

From asafw.at.wharton at gmail.com  Mon Nov 12 05:08:04 2012
From: asafw.at.wharton at gmail.com (Asaf Weinstein)
Date: Sun, 11 Nov 2012 23:08:04 -0500
Subject: [R-sig-ME] Random-effects model with known error variance
Message-ID: <CAGG0PdCzYwA+z7s9=r8gUk+2MDOLXJnWhHczXhK_JeuCY3rc9w@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121111/3b28934a/attachment.pl>

From antoinepaccard at gmail.com  Mon Nov 12 15:46:22 2012
From: antoinepaccard at gmail.com (Antoine PACCARD)
Date: Mon, 12 Nov 2012 15:46:22 +0100
Subject: [R-sig-ME] lme/lmer and random effects correlation parameters
Message-ID: <54C001BA-6232-4027-9BAC-BFC1337587F8@gmail.com>

Dear Mix modelers,

I am trying to run the following models:

m1 <- lme(A ~ treatment * lat, random= ~ 1 + treatment | population/family) 

or with lmer

m2 <- lmer(A ~ treatment * lat + (treatment |population/family))


Unfortunately m1 won't converge and I always get the following message: "iteration limit reached without convergence (10)". 
I understand this comes from random correlation parameters and this issue has been previously discussed in the past. However, I can't find a way to make it work and I was wondering if anybody had found a way to fix this problem.

lmer will work and converge properly. Unfortunately the following function to extract p-values won't work because of the same reason explained above:
pvals.fnc(m2, nsim = 10000)
"Error in pvals.fnc(m2, nsim = 10000) : MCMC sampling is not implemented in recent versions of lme4 for models with random correlation parameters"


I believe my models are correct since each family and each population have experienced treatment (when I get rid of "treatment" in the random parameters, the models work fine). Here is a sample of the data set:

population	lat		family	treatment	A
AA			37.724	35		AB			124
LLL			37.419	14		AB			249
AAJ			46.114	8		AB	
XXX		43.356	1		CD	
OOO		40.441	27		CD			244.5
FFF			36.418	6		CD			240
OOO		40.441	11		AB	
AA			37.724	28		AB	
AAF			46.114	17		CD			116.5
QQQ		39.491	19		CD			93.5
QQQ		39.491	21		AB			247
AAF			46.114	10		CD	
OOO		40.441	20		CD			227
UUU		42.996	25		AB			95.5
XXX		43.356	22		CD			209
AA			37.724	15		AB	
QQQ		39.491	29		AB			186
UUU		42.996	19		AB			110
UUU		42.996	3		AB			247


Any advice and help would be very appreciated. 

Many thanks,
Antoine

From HDoran at air.org  Mon Nov 12 21:44:35 2012
From: HDoran at air.org (Doran, Harold)
Date: Mon, 12 Nov 2012 15:44:35 -0500
Subject: [R-sig-ME] Random-effects model with known error variance
In-Reply-To: <CAGG0PdCzYwA+z7s9=r8gUk+2MDOLXJnWhHczXhK_JeuCY3rc9w@mail.gmail.com>
References: <CAGG0PdCzYwA+z7s9=r8gUk+2MDOLXJnWhHczXhK_JeuCY3rc9w@mail.gmail.com>
Message-ID: <686DF18D10EF1C428C2760321FB5B69E076C04D083@DC1VEX07MB001.air.org>

Yes, lmer can handle unbalanced data. No, you cannot constrain one of the variances to have a fixed value using lmer. Solutions for linear mixed models are well-known, and so if your grasp of R programming and matrix algebra is decent, then it is very easy to do this.  

> -----Original Message-----
> From: r-sig-mixed-models-bounces at r-project.org [mailto:r-sig-mixed-models-
> bounces at r-project.org] On Behalf Of Asaf Weinstein
> Sent: Sunday, November 11, 2012 11:08 PM
> To: r-sig-mixed-models at r-project.org
> Subject: [R-sig-ME] Random-effects model with known error variance
> 
> Hi there,
> 
> I am trying to fit a random effects two-way linear model with unbalanced data,
> and have two questions:
> 
>    1. Can someone verify that lmer() can indeed cope with an unbalanced
>    table?
>    2. This might be more difficult: I am looking to fit the same model with
>    a KNOWN value for the error variance (sigma sq). I wonder if this is
>    possible to do with current package, and if not, if it's a good idea to
>    look into the implementation and try to do it myself. I'm curious to know
>    how difficult that would be to a not-too-sophisticated R user.
> 
> Thanks so much,
> 
> Asaf
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models


From David.Duffy at qimr.edu.au  Mon Nov 12 22:50:05 2012
From: David.Duffy at qimr.edu.au (David Duffy)
Date: Tue, 13 Nov 2012 07:50:05 +1000
Subject: [R-sig-ME] Non-parametric 2x2 Mixed Factorial ANOVA in R?
In-Reply-To: <loom.20121112T155117-900@post.gmane.org>
References: <DUB115-W63869B67C8675309F75EB6A9680@phx.gbl>
	<loom.20121112T155117-900@post.gmane.org>
Message-ID: <alpine.LMD.2.00.1211130749100.25105@orpheus.qimr.edu.au>

On Tue, 13 Nov 2012, Ben Bolker wrote:

> * you could try bootstrapping or permutation testing (being careful
> to respect the grouping structure of the data

lmPerm package may be useful for this


From kevin.thorpe at utoronto.ca  Tue Nov 13 01:23:02 2012
From: kevin.thorpe at utoronto.ca (Kevin E. Thorpe)
Date: Mon, 12 Nov 2012 19:23:02 -0500
Subject: [R-sig-ME] Error in glmer fit
Message-ID: <50A192E6.5040705@utoronto.ca>

Hello.

I attempted the following command and got the resultant error.

glmer(InInt~speciality+position+stkperyr+conf+age+years+risk+stroke_type+(1|pid),data=dord4mod,family=binomial,verbose=TRUE)

Error in pwrssUpdate(pp, resp, tolPwrss, GQmat, compDev, fac, verbose) :
   PIRLS step failed

It seems to happen right off the bat.  Any idea what the source may be? 
  I don't want to post the data in the open, but will send it privately 
if requested.  Here also is my sessionInfo()

R version 2.14.0 Patched (2011-11-29 r57769)
Platform: x86_64-unknown-linux-gnu (64-bit)

locale:
  [1] LC_CTYPE=en_US       LC_NUMERIC=C         LC_TIME=en_US
  [4] LC_COLLATE=C         LC_MONETARY=en_US    LC_MESSAGES=en_US
  [7] LC_PAPER=C           LC_NAME=C            LC_ADDRESS=C
[10] LC_TELEPHONE=C       LC_MEASUREMENT=en_US LC_IDENTIFICATION=C

attached base packages:
  [1] grid      tcltk     splines   stats     graphics  grDevices utils
  [8] datasets  methods   base

other attached packages:
  [1] lme4_0.999902345-0  Matrix_1.0-2        ResearchMethods_1.4
  [4] ellipse_0.3-5       gplots_2.10.1       KernSmooth_2.23-7
  [7] caTools_1.12        bitops_1.0-4.1      gdata_2.8.2
[10] gtools_2.6.2        irr_0.83            lpSolve_5.6.6
[13] lattice_0.20-0      rms_3.3-2           Hmisc_3.9-0
[16] survival_2.36-10

loaded via a namespace (and not attached):
[1] MASS_7.3-16    Rcpp_0.9.10    cluster_1.14.1 minqa_1.1.18 
nlme_3.1-102
[6] tools_2.14.0

-- 
Kevin E. Thorpe
Biostatistician/Trialist,  Applied Health Research Centre (AHRC)
Li Ka Shing Knowledge Institute of St. Michael's
Assistant Professor, Dalla Lana School of Public Health
University of Toronto
email: kevin.thorpe at utoronto.ca  Tel: 416.864.5776  Fax: 416.864.3016


From aghaynes at gmail.com  Tue Nov 13 07:58:02 2012
From: aghaynes at gmail.com (Alan Haynes)
Date: Tue, 13 Nov 2012 07:58:02 +0100
Subject: [R-sig-ME] relative importance of independendent variables in
 lm and lme models
In-Reply-To: <50A0E4F2.6020600@ugent.be>
References: <509FC7E6.5000907@ugent.be>
	<AA818EAD2576BC488B4F623941DA742794746862@inbomail.inbo.be>
	<50A0E4F2.6020600@ugent.be>
Message-ID: <CAPdSD+4CGkwB-2qxnGKDQWYCEzSkU42HUgP_OOTubT+WGYZfJw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121113/a6337341/attachment.pl>

From Thierry.ONKELINX at inbo.be  Tue Nov 13 10:50:33 2012
From: Thierry.ONKELINX at inbo.be (ONKELINX, Thierry)
Date: Tue, 13 Nov 2012 09:50:33 +0000
Subject: [R-sig-ME] relative importance of independendent variables in
 lm and lme models
In-Reply-To: <CAPdSD+4CGkwB-2qxnGKDQWYCEzSkU42HUgP_OOTubT+WGYZfJw@mail.gmail.com>
References: <509FC7E6.5000907@ugent.be>
	<AA818EAD2576BC488B4F623941DA742794746862@inbomail.inbo.be>
	<50A0E4F2.6020600@ugent.be>
	<CAPdSD+4CGkwB-2qxnGKDQWYCEzSkU42HUgP_OOTubT+WGYZfJw@mail.gmail.com>
Message-ID: <AA818EAD2576BC488B4F623941DA742794756B66@inbomail.inbo.be>

Een ingesloten tekst met niet-gespecificeerde tekenset is gescrubt ...
Naam: niet beschikbaar
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121113/299c4d41/attachment.pl>

From Thierry.ONKELINX at inbo.be  Tue Nov 13 11:01:59 2012
From: Thierry.ONKELINX at inbo.be (ONKELINX, Thierry)
Date: Tue, 13 Nov 2012 10:01:59 +0000
Subject: [R-sig-ME] Error in glmer fit
In-Reply-To: <50A192E6.5040705@utoronto.ca>
References: <50A192E6.5040705@utoronto.ca>
Message-ID: <AA818EAD2576BC488B4F623941DA74279475AC2C@inbomail.inbo.be>

Dear Kevin,

I cannot give you answer on why this happens. You can try the lme4.0 package as a work around. It is an older version of lme4.

Best regards,

ir. Thierry Onkelinx
Instituut voor natuur- en bosonderzoek / Research Institute for Nature and Forest
team Biometrie & Kwaliteitszorg / team Biometrics & Quality Assurance
Kliniekstraat 25
1070 Anderlecht
Belgium
+ 32 2 525 02 51
+ 32 54 43 61 85
Thierry.Onkelinx at inbo.be
www.inbo.be

To call in the statistician after the experiment is done may be no more than asking him to perform a post-mortem examination: he may be able to say what the experiment died of.
~ Sir Ronald Aylmer Fisher

The plural of anecdote is not data.
~ Roger Brinner

The combination of some data and an aching desire for an answer does not ensure that a reasonable answer can be extracted from a given body of data.
~ John Tukey


-----Oorspronkelijk bericht-----
Van: r-sig-mixed-models-bounces at r-project.org [mailto:r-sig-mixed-models-bounces at r-project.org] Namens Kevin E. Thorpe
Verzonden: dinsdag 13 november 2012 1:23
Aan: r-sig-mixed-models at r-project.org
Onderwerp: [R-sig-ME] Error in glmer fit

Hello.

I attempted the following command and got the resultant error.

glmer(InInt~speciality+position+stkperyr+conf+age+years+risk+stroke_type+(1|pid),data=dord4mod,family=binomial,verbose=TRUE)

Error in pwrssUpdate(pp, resp, tolPwrss, GQmat, compDev, fac, verbose) :
   PIRLS step failed

It seems to happen right off the bat.  Any idea what the source may be?
  I don't want to post the data in the open, but will send it privately if requested.  Here also is my sessionInfo()

R version 2.14.0 Patched (2011-11-29 r57769)
Platform: x86_64-unknown-linux-gnu (64-bit)

locale:
  [1] LC_CTYPE=en_US       LC_NUMERIC=C         LC_TIME=en_US
  [4] LC_COLLATE=C         LC_MONETARY=en_US    LC_MESSAGES=en_US
  [7] LC_PAPER=C           LC_NAME=C            LC_ADDRESS=C
[10] LC_TELEPHONE=C       LC_MEASUREMENT=en_US LC_IDENTIFICATION=C

attached base packages:
  [1] grid      tcltk     splines   stats     graphics  grDevices utils
  [8] datasets  methods   base

other attached packages:
  [1] lme4_0.999902345-0  Matrix_1.0-2        ResearchMethods_1.4
  [4] ellipse_0.3-5       gplots_2.10.1       KernSmooth_2.23-7
  [7] caTools_1.12        bitops_1.0-4.1      gdata_2.8.2
[10] gtools_2.6.2        irr_0.83            lpSolve_5.6.6
[13] lattice_0.20-0      rms_3.3-2           Hmisc_3.9-0
[16] survival_2.36-10

loaded via a namespace (and not attached):
[1] MASS_7.3-16    Rcpp_0.9.10    cluster_1.14.1 minqa_1.1.18
nlme_3.1-102
[6] tools_2.14.0

--
Kevin E. Thorpe
Biostatistician/Trialist,  Applied Health Research Centre (AHRC) Li Ka Shing Knowledge Institute of St. Michael's Assistant Professor, Dalla Lana School of Public Health University of Toronto
email: kevin.thorpe at utoronto.ca  Tel: 416.864.5776  Fax: 416.864.3016

_______________________________________________
R-sig-mixed-models at r-project.org mailing list https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
* * * * * * * * * * * * * D I S C L A I M E R * * * * * * * * * * * * *
Dit bericht en eventuele bijlagen geven enkel de visie van de schrijver weer en binden het INBO onder geen enkel beding, zolang dit bericht niet bevestigd is door een geldig ondertekend document.
The views expressed in this message and any annex are purely those of the writer and may not be regarded as stating an official position of INBO, as long as the message is not confirmed by a duly signed document.


From Thierry.ONKELINX at inbo.be  Tue Nov 13 11:04:51 2012
From: Thierry.ONKELINX at inbo.be (ONKELINX, Thierry)
Date: Tue, 13 Nov 2012 10:04:51 +0000
Subject: [R-sig-ME] Random-effects model with known error variance
In-Reply-To: <686DF18D10EF1C428C2760321FB5B69E076C04D083@DC1VEX07MB001.air.org>
References: <CAGG0PdCzYwA+z7s9=r8gUk+2MDOLXJnWhHczXhK_JeuCY3rc9w@mail.gmail.com>
	<686DF18D10EF1C428C2760321FB5B69E076C04D083@DC1VEX07MB001.air.org>
Message-ID: <AA818EAD2576BC488B4F623941DA74279475AC52@inbomail.inbo.be>

If you are prepared to do it the Bayesian way, then you can fix the variance of the random effect. Have a look at the MCMCglmm package.

Best regards,

ir. Thierry Onkelinx
Instituut voor natuur- en bosonderzoek / Research Institute for Nature and Forest
team Biometrie & Kwaliteitszorg / team Biometrics & Quality Assurance
Kliniekstraat 25
1070 Anderlecht
Belgium
+ 32 2 525 02 51
+ 32 54 43 61 85
Thierry.Onkelinx at inbo.be
www.inbo.be

To call in the statistician after the experiment is done may be no more than asking him to perform a post-mortem examination: he may be able to say what the experiment died of.
~ Sir Ronald Aylmer Fisher

The plural of anecdote is not data.
~ Roger Brinner

The combination of some data and an aching desire for an answer does not ensure that a reasonable answer can be extracted from a given body of data.
~ John Tukey


-----Oorspronkelijk bericht-----
Van: r-sig-mixed-models-bounces at r-project.org [mailto:r-sig-mixed-models-bounces at r-project.org] Namens Doran, Harold
Verzonden: maandag 12 november 2012 21:45
Aan: Asaf Weinstein; r-sig-mixed-models at r-project.org
Onderwerp: Re: [R-sig-ME] Random-effects model with known error variance

Yes, lmer can handle unbalanced data. No, you cannot constrain one of the variances to have a fixed value using lmer. Solutions for linear mixed models are well-known, and so if your grasp of R programming and matrix algebra is decent, then it is very easy to do this.

> -----Original Message-----
> From: r-sig-mixed-models-bounces at r-project.org
> [mailto:r-sig-mixed-models- bounces at r-project.org] On Behalf Of Asaf
> Weinstein
> Sent: Sunday, November 11, 2012 11:08 PM
> To: r-sig-mixed-models at r-project.org
> Subject: [R-sig-ME] Random-effects model with known error variance
>
> Hi there,
>
> I am trying to fit a random effects two-way linear model with
> unbalanced data, and have two questions:
>
>    1. Can someone verify that lmer() can indeed cope with an unbalanced
>    table?
>    2. This might be more difficult: I am looking to fit the same model with
>    a KNOWN value for the error variance (sigma sq). I wonder if this is
>    possible to do with current package, and if not, if it's a good idea to
>    look into the implementation and try to do it myself. I'm curious to know
>    how difficult that would be to a not-too-sophisticated R user.
>
> Thanks so much,
>
> Asaf
>
>       [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models

_______________________________________________
R-sig-mixed-models at r-project.org mailing list https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
* * * * * * * * * * * * * D I S C L A I M E R * * * * * * * * * * * * *
Dit bericht en eventuele bijlagen geven enkel de visie van de schrijver weer en binden het INBO onder geen enkel beding, zolang dit bericht niet bevestigd is door een geldig ondertekend document.
The views expressed in this message and any annex are purely those of the writer and may not be regarded as stating an official position of INBO, as long as the message is not confirmed by a duly signed document.


From mcasals at aspb.cat  Wed Nov 14 12:57:24 2012
From: mcasals at aspb.cat (=?ISO-8859-1?Q?Mart=ED_Casals?=)
Date: Wed, 14 Nov 2012 12:57:24 +0100
Subject: [R-sig-ME] Error in glmer fit
In-Reply-To: <AA818EAD2576BC488B4F623941DA74279475AC2C@inbomail.inbo.be>
References: <50A192E6.5040705@utoronto.ca>
	<AA818EAD2576BC488B4F623941DA74279475AC2C@inbomail.inbo.be>
Message-ID: <CADtmEn432W6SkRbRsBtgwx3=ERtdOg7vgtKGhG1++6T=NisahA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121114/54d47830/attachment.pl>

From matthias.suter at art.admin.ch  Wed Nov 14 15:10:29 2012
From: matthias.suter at art.admin.ch (matthias.suter at art.admin.ch)
Date: Wed, 14 Nov 2012 15:10:29 +0100
Subject: [R-sig-ME] Variances and standard errors of predicted values
	following lmer()
Message-ID: <A546928D770F23429B20371B4D3B10F7EADD5B5F4E@EVD-C7000.bk.evdad.admin.ch>

Dear R users

Does anybody know how to receive the variances (and standard errors) of predicted values following a fit with lmer()? I should only consider the variance of predicted values corresponding to the fixed estimates (I need no prediction to the random part). To my knowledge, a predict() function to an lmer() object is not implemented yet?

Given a matrix of new predictors (matrix of new data corresponding to the fixed effects), and the variance-covariance matrices of fixed (vcov) and random (VarCorr) effects from the lmer.output, it should be possible the calculate the variances of predicted values. Can somebody help?

Matthias Suter,
Agroscope Reckenholz-T?nikon ART, Z?rich


From mariannestephan at hotmail.com  Wed Nov 14 16:00:11 2012
From: mariannestephan at hotmail.com (Marianne K.)
Date: Wed, 14 Nov 2012 16:00:11 +0100
Subject: [R-sig-ME] How do I check whether the assumptions of equal
 variances and normality are fulfilled for ezANOVA() ?
In-Reply-To: <BLU162-W2F879F5F5F91F5B4ACCE4E6530@phx.gbl>
References: <DUB115-W19AA297B1609CA6BC8A5BBA9680@phx.gbl>,
	<000901cdbe97$b28ce650$17a6b2f0$@net>,
	<BLU162-W2F879F5F5F91F5B4ACCE4E6530@phx.gbl>
Message-ID: <DUB115-W12092F8B1E97867FD55178EA9530@phx.gbl>

Ein eingebundener Text mit undefiniertem Zeichensatz wurde abgetrennt.
Name: nicht verf?gbar
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121114/75d07698/attachment.pl>

From chantepie at mnhn.fr  Wed Nov 14 17:04:57 2012
From: chantepie at mnhn.fr (Stephane Chantepie)
Date: Wed, 14 Nov 2012 17:04:57 +0100
Subject: [R-sig-ME] How to assess significance of variance components
	(Please discard previous e mail... but read this one)
In-Reply-To: <CAFEqCdzgcrmNSR2qtj_4erY_n99GTU3ymcJ=8kmSkzJjvhkq8Q@mail.gmail.com>
References: <20121018115219.60162drikv668spf@dsiwebmail.mnhn.fr>
	<CAFEqCdzgcrmNSR2qtj_4erY_n99GTU3ymcJ=8kmSkzJjvhkq8Q@mail.gmail.com>
Message-ID: <201211141704.57285.chantepie@mnhn.fr>

Hi all,

First, thank a lot Greg for the ideas you gave but I am not sure to 
understand really what mean a 'point mass' and to be honest I am really far 
from being a developer.
I think that the alternative approach which consist in defining a threshold 
and considering that all value below this threshold could be considered as 0 
appear to be really suggestive.
Even if I agree with you that testing everything is not always necessary,in 
some cases, it could be important.

For my case : 

I have done random regression animal models to test an increase in genetic 
variance across age. I have tested a VA by AGE interaction (which appear to 
fit the VA estimates I had with univariate animal models computed by 
age).Then, I have tested a quadratic interaction which also does not 'look' so 
bad compare to estimates from univariate models. So, I have then tested a 
cubic interaction (error interval appear pretty big) ... 
For all theses models,parameter posteriors are well shaped, but I am unable to 
know (or decide) if a model VAxAGE fit well my data, and which is the best 
models.
So, in the cases where random part of models is not just a correction, it 
could be interesting to know the significance of a random parameter in order 
to take a decision (and to justify it in a manuscript).

His someone had already been in front of this difficult choice?
How did you deal with this problem?

Thank a lot 
Stephane


From kevin.thorpe at utoronto.ca  Wed Nov 14 18:31:46 2012
From: kevin.thorpe at utoronto.ca (Kevin E. Thorpe)
Date: Wed, 14 Nov 2012 12:31:46 -0500
Subject: [R-sig-ME] Error in glmer fit
In-Reply-To: <CADtmEn432W6SkRbRsBtgwx3=ERtdOg7vgtKGhG1++6T=NisahA@mail.gmail.com>
References: <50A192E6.5040705@utoronto.ca>
	<AA818EAD2576BC488B4F623941DA74279475AC2C@inbomail.inbo.be>
	<CADtmEn432W6SkRbRsBtgwx3=ERtdOg7vgtKGhG1++6T=NisahA@mail.gmail.com>
Message-ID: <50A3D582.7090300@utoronto.ca>

Thank you both for your responses.  Unfortunately neither solves the 
problem.  Using nAGQ=5 with lme4 results in the same error as already shown.

At Thierry's suggestion, I tried lme4.0 and get a different error.

glmer(InInt~speciality+position+stkperyr+conf+age+years+risk+stktype+(1|pid),data=dord4mod,family=binomial)
Error in validObject(.Object) :
   invalid class "mer" object: invalid object for slot "resid" in class 
"mer": got class "labelled", should be or extend class "numeric"
 > sessionInfo()
R version 2.14.0 Patched (2011-11-29 r57769)
Platform: x86_64-unknown-linux-gnu (64-bit)

locale:
  [1] LC_CTYPE=en_US       LC_NUMERIC=C         LC_TIME=en_US
  [4] LC_COLLATE=C         LC_MONETARY=en_US    LC_MESSAGES=en_US
  [7] LC_PAPER=C           LC_NAME=C            LC_ADDRESS=C
[10] LC_TELEPHONE=C       LC_MEASUREMENT=en_US LC_IDENTIFICATION=C

attached base packages:
[1] splines   stats     graphics  grDevices utils     datasets  methods
[8] base

other attached packages:
[1] lme4.0_0.999999-1 Matrix_1.0-2      lattice_0.20-0    rms_3.3-2
[5] Hmisc_3.9-0       survival_2.36-10

loaded via a namespace (and not attached):
[1] cluster_1.14.1 grid_2.14.0    nlme_3.1-102   stats4_2.14.0


On 11/14/2012 06:57 AM, Mart? Casals wrote:
> Hello,
> I don't know if it is a good idea to include "nAGQ=5 orother points" in
> the options script!
> If you only use a unique random effect you can try to the AGQ method.
>
> glmer(InInt~speciality+position+stkperyr+conf+age+years+risk+stroke_type+(1|pid),data=dord4mod,nAGQ=5,family=binomial,verbose=TRUE)
>
> Best wishes,
>
> Mart?
>
> 2012/11/13 ONKELINX, Thierry <Thierry.ONKELINX at inbo.be
> <mailto:Thierry.ONKELINX at inbo.be>>
>
>     Dear Kevin,
>
>     I cannot give you answer on why this happens. You can try the lme4.0
>     package as a work around. It is an older version of lme4.
>
>     Best regards,
>
>     ir. Thierry Onkelinx
>     Instituut voor natuur- en bosonderzoek / Research Institute for
>     Nature and Forest
>     team Biometrie & Kwaliteitszorg / team Biometrics & Quality Assurance
>     Kliniekstraat 25
>     1070 Anderlecht
>     Belgium
>     + 32 2 525 02 51 <tel:%2B%2032%202%20525%2002%2051>
>     + 32 54 43 61 85 <tel:%2B%2032%2054%2043%2061%2085>
>     Thierry.Onkelinx at inbo.be <mailto:Thierry.Onkelinx at inbo.be>
>     www.inbo.be <http://www.inbo.be>
>
>     To call in the statistician after the experiment is done may be no
>     more than asking him to perform a post-mortem examination: he may be
>     able to say what the experiment died of.
>     ~ Sir Ronald Aylmer Fisher
>
>     The plural of anecdote is not data.
>     ~ Roger Brinner
>
>     The combination of some data and an aching desire for an answer does
>     not ensure that a reasonable answer can be extracted from a given
>     body of data.
>     ~ John Tukey
>
>
>     -----Oorspronkelijk bericht-----
>     Van: r-sig-mixed-models-bounces at r-project.org
>     <mailto:r-sig-mixed-models-bounces at r-project.org>
>     [mailto:r-sig-mixed-models-bounces at r-project.org
>     <mailto:r-sig-mixed-models-bounces at r-project.org>] Namens Kevin E.
>     Thorpe
>     Verzonden: dinsdag 13 november 2012 1:23
>     Aan: r-sig-mixed-models at r-project.org
>     <mailto:r-sig-mixed-models at r-project.org>
>     Onderwerp: [R-sig-ME] Error in glmer fit
>
>     Hello.
>
>     I attempted the following command and got the resultant error.
>
>     glmer(InInt~speciality+position+stkperyr+conf+age+years+risk+stroke_type+(1|pid),data=dord4mod,family=binomial,verbose=TRUE)
>
>     Error in pwrssUpdate(pp, resp, tolPwrss, GQmat, compDev, fac, verbose) :
>         PIRLS step failed
>
>     It seems to happen right off the bat.  Any idea what the source may be?
>        I don't want to post the data in the open, but will send it
>     privately if requested.  Here also is my sessionInfo()
>
>     R version 2.14.0 Patched (2011-11-29 r57769)
>     Platform: x86_64-unknown-linux-gnu (64-bit)
>
>     locale:
>        [1] LC_CTYPE=en_US       LC_NUMERIC=C         LC_TIME=en_US
>        [4] LC_COLLATE=C         LC_MONETARY=en_US    LC_MESSAGES=en_US
>        [7] LC_PAPER=C           LC_NAME=C            LC_ADDRESS=C
>     [10] LC_TELEPHONE=C       LC_MEASUREMENT=en_US LC_IDENTIFICATION=C
>
>     attached base packages:
>        [1] grid      tcltk     splines   stats     graphics  grDevices utils
>        [8] datasets  methods   base
>
>     other attached packages:
>        [1] lme4_0.999902345-0  Matrix_1.0-2        ResearchMethods_1.4
>        [4] ellipse_0.3-5       gplots_2.10.1       KernSmooth_2.23-7
>        [7] caTools_1.12        bitops_1.0-4.1      gdata_2.8.2
>     [10] gtools_2.6.2        irr_0.83            lpSolve_5.6.6
>     [13] lattice_0.20-0      rms_3.3-2           Hmisc_3.9-0
>     [16] survival_2.36-10
>
>     loaded via a namespace (and not attached):
>     [1] MASS_7.3-16    Rcpp_0.9.10    cluster_1.14.1 minqa_1.1.18
>     nlme_3.1-102
>     [6] tools_2.14.0
>


-- 
Kevin E. Thorpe
Biostatistician/Trialist,  Applied Health Research Centre (AHRC)
Li Ka Shing Knowledge Institute of St. Michael's
Assistant Professor, Dalla Lana School of Public Health
University of Toronto
email: kevin.thorpe at utoronto.ca  Tel: 416.864.5776  Fax: 416.864.3016


From bbolker at gmail.com  Thu Nov 15 01:12:32 2012
From: bbolker at gmail.com (Ben Bolker)
Date: Thu, 15 Nov 2012 00:12:32 +0000 (UTC)
Subject: [R-sig-ME] Error in glmer fit
References: <50A192E6.5040705@utoronto.ca>
	<AA818EAD2576BC488B4F623941DA74279475AC2C@inbomail.inbo.be>
	<CADtmEn432W6SkRbRsBtgwx3=ERtdOg7vgtKGhG1++6T=NisahA@mail.gmail.com>
	<50A3D582.7090300@utoronto.ca>
Message-ID: <loom.20121115T004458-676@post.gmane.org>

Kevin E. Thorpe <kevin.thorpe at ...> writes:

> 
> Thank you both for your responses.  Unfortunately neither solves the 
> problem.  Using nAGQ=5 with lme4 results in the same error as already shown.
> 
> At Thierry's suggestion, I tried lme4.0 and get a different error.
> 
> glmer(InInt~speciality+position+stkperyr+conf+
> age+years+risk+stktype+(1|pid),data=dord4mod,family=binomial)
> Error in validObject(.Object) :
>    invalid class "mer" object: invalid object for slot "resid" in class 
> "mer": got class "labelled", should be or extend class "numeric"

  This is a pretty weird error.  Is this from a clean session?
  Is there any chance you can provide a reproducible problem?
  (You could send me your data.)

  To provide a little bit more context for the general public about
lme4 development: at present there are three versions of lme4:

  stable-CRAN: 0.999999-0
  lme4 (R-forge): 0.99999911-0
  lme4.0 (R-forge): 0.999999-1

 As far as we know, lme4.0 is identical to the stable-CRAN version
(if not, please let us know!)

  lme4 is the development version: it has lots of goodies that
stable-lme4 doesn't (profiling, a predict method, a built-in
parametric bootstrap method, support for alternative optimizers, ...),
but at present it (1) doesn't work with all of the downstream
add-on packages (gamm4, blme, etc) and (2) has a somewhat unstable
GLMM fitting algorithm.  We are working hard to fix #2; once that's
done we will work on #1, and then release it (yes, we know you've
heard that before).  In the meantime, if you can live without the
goodies, the stable version represents the best bet.

  Things are a little more difficult if you don't have the
latest version, since install.packages() may not find the
right version.  You can try downloading the relevant binary
or source version from 

http://cran.r-project.org/web/packages/lme4//index.html

or

https://r-forge.r-project.org/R/?group_id=60

>  > sessionInfo()
> R version 2.14.0 Patched (2011-11-29 r57769)
> Platform: x86_64-unknown-linux-gnu (64-bit)
> 
> locale:
>   [1] LC_CTYPE=en_US       LC_NUMERIC=C         LC_TIME=en_US
>   [4] LC_COLLATE=C         LC_MONETARY=en_US    LC_MESSAGES=en_US
>   [7] LC_PAPER=C           LC_NAME=C            LC_ADDRESS=C
> [10] LC_TELEPHONE=C       LC_MEASUREMENT=en_US LC_IDENTIFICATION=C
> 
> attached base packages:
> [1] splines   stats     graphics  grDevices utils     datasets  methods
> [8] base
> 
> other attached packages:
> [1] lme4.0_0.999999-1 Matrix_1.0-2      lattice_0.20-0    rms_3.3-2
> [5] Hmisc_3.9-0       survival_2.36-10
> 
> loaded via a namespace (and not attached):
> [1] cluster_1.14.1 grid_2.14.0    nlme_3.1-102   stats4_2.14.0
> 
> > 2012/11/13 ONKELINX, Thierry <Thierry.ONKELINX at ...
> > <mailto:Thierry.ONKELINX at ...>>
> >
> >     Dear Kevin,
> >
> >     I cannot give you answer on why this happens. You can try the lme4.0
> >     package as a work around. It is an older version of lme4.
> >
> >     Best regards,
> >
> >     ir. Thierry Onkelinx
> >
> >     I attempted the following command and got the resultant error.
> >
> >     glmer(InInt~speciality+position+stkperyr+conf+
> >   age+years+risk+stroke_type+(1|pid),data=dord4mod,
> >    family=binomial,verbose=TRUE)
> >
> >     Error in pwrssUpdate(pp, resp, tolPwrss, GQmat, compDev, fac, verbose) :
> >         PIRLS step failed
> >
> >     It seems to happen right off the bat.  Any idea what the source may be?
> >        I don't want to post the data in the open, but will send it
> >     privately if requested.  Here also is my sessionInfo()
> >
> >     R version 2.14.0 Patched (2011-11-29 r57769)
> >     Platform: x86_64-unknown-linux-gnu (64-bit)
> >
> >     other attached packages:
> >        [1] lme4_0.999902345-0  Matrix_1.0-2        ResearchMethods_1.4
> >        [4] ellipse_0.3-5       gplots_2.10.1       KernSmooth_2.23-7
> >        [7] caTools_1.12        bitops_1.0-4.1      gdata_2.8.2
> >     [10] gtools_2.6.2        irr_0.83            lpSolve_5.6.6
> >     [13] lattice_0.20-0      rms_3.3-2           Hmisc_3.9-0
> >     [16] survival_2.36-10
> >


From seth at swbigelow.net  Thu Nov 15 01:43:33 2012
From: seth at swbigelow.net (Seth W. Bigelow)
Date: Wed, 14 Nov 2012 19:43:33 -0500
Subject: [R-sig-ME] How do I check whether the assumptions of equal
	variances and normality are fulfilled for ezANOVA() ?
In-Reply-To: <DUB115-W12092F8B1E97867FD55178EA9530@phx.gbl>
References: <DUB115-W19AA297B1609CA6BC8A5BBA9680@phx.gbl>,
	<000901cdbe97$b28ce650$17a6b2f0$@net>,
	<BLU162-W2F879F5F5F91F5B4ACCE4E6530@phx.gbl>
	<DUB115-W12092F8B1E97867FD55178EA9530@phx.gbl>
Message-ID: <003c01cdc2ca$3f4a2ae0$bdde80a0$@net>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121114/c34ac423/attachment.pl>

From David.Duffy at qimr.edu.au  Thu Nov 15 02:39:14 2012
From: David.Duffy at qimr.edu.au (David Duffy)
Date: Thu, 15 Nov 2012 11:39:14 +1000
Subject: [R-sig-ME] How to assess significance of variance
 components(Please discard previous e mail... but read this one)
In-Reply-To: <201211141704.57285.chantepie@mnhn.fr>
References: <20121018115219.60162drikv668spf@dsiwebmail.mnhn.fr><CAFEqCdzgcrmNSR2qtj_4erY_n99GTU3ymcJ=8kmSkzJjvhkq8Q@mail.gmail.com>
	<201211141704.57285.chantepie@mnhn.fr>
Message-ID: <Pine.LNX.4.64.1211151137130.30525@orpheus.qimr.edu.au>

On Thu, 15 Nov 2012, Stephane Chantepie wrote:

> Hi all,
>
> Even if I agree with you that testing everything is not always necessary,in
> some cases, it could be important.
>
> For my case :
>
> I have done random regression animal models to test an increase in genetic
> variance across age.

Did someone suggest the RLRsim package?  The example for exactRLRT runs:

   mA <- lmer(Reaction ~ I(Days-4.5) + (1|Subject) +
              (0 + I(Days-4.5)|Subject), sleepstudy)
   m0 <- update(mA, . ~ . - (0 + I(Days-4.5)|Subject))
   m.slope  <- update(mA, . ~ . - (1|Subject))
   #test for subject specific slopes:
   exactRLRT(m.slope, mA, m0)


From asafw.at.wharton at gmail.com  Tue Nov 13 17:23:17 2012
From: asafw.at.wharton at gmail.com (Asaf Weinstein)
Date: Tue, 13 Nov 2012 11:23:17 -0500
Subject: [R-sig-ME] Extracting model matrices used by lmer
Message-ID: <CAGG0PdAHnSG0_E+B2KYEtZE5Lzu-W=X5mjYaMz91hmT+VgsN9g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121113/ba1c8399/attachment.pl>

From asafw.at.wharton at gmail.com  Wed Nov 14 02:14:18 2012
From: asafw.at.wharton at gmail.com (Asaf Weinstein)
Date: Tue, 13 Nov 2012 20:14:18 -0500
Subject: [R-sig-ME] Estimation of variance component parameters under known
	error variance
Message-ID: <CAGG0PdA6tQbzrK7u6aZu77AiAMCm9dOQCAgv-YUcST0t5NpJRQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121113/7414da81/attachment.pl>

From Ellen.Pape at ugent.be  Tue Nov 13 09:11:30 2012
From: Ellen.Pape at ugent.be (Ellen Pape)
Date: Tue, 13 Nov 2012 09:11:30 +0100
Subject: [R-sig-ME] relative importance of independendent variables in
 lm and lme models
In-Reply-To: <CAPdSD+4CGkwB-2qxnGKDQWYCEzSkU42HUgP_OOTubT+WGYZfJw@mail.gmail.com>
References: <509FC7E6.5000907@ugent.be>
	<AA818EAD2576BC488B4F623941DA742794746862@inbomail.inbo.be>
	<50A0E4F2.6020600@ugent.be>
	<CAPdSD+4CGkwB-2qxnGKDQWYCEzSkU42HUgP_OOTubT+WGYZfJw@mail.gmail.com>
Message-ID: <50A200B2.6020409@ugent.be>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121113/97227e5b/attachment.pl>

From matthias.suter at art.admin.ch  Thu Nov 15 16:29:25 2012
From: matthias.suter at art.admin.ch (matthias.suter at art.admin.ch)
Date: Thu, 15 Nov 2012 16:29:25 +0100
Subject: [R-sig-ME] Estimated random correlations close to 0 or 1
Message-ID: <A546928D770F23429B20371B4D3B10F7EADD7665D4@EVD-C7000.bk.evdad.admin.ch>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121115/491991ac/attachment.pl>

From Christoph.Scherber at agr.uni-goettingen.de  Thu Nov 15 15:45:39 2012
From: Christoph.Scherber at agr.uni-goettingen.de (Christoph Scherber)
Date: Thu, 15 Nov 2012 15:45:39 +0100
Subject: [R-sig-ME] Treatment:Block interactions in lme (Schabenberger &
	Pierce 2002)
Message-ID: <50A50013.50309@agr.uni-goettingen.de>

Dear all,

I have tried to reproduce the SAS example from Schabenberger & Pierce (2002, p. 474 f.), but
couldn?t figure out so far how to fit a farm:treatment (tx) random interaction term.

The data are structured as follows:
- yield is the response variable
- tx (treatment) is the only fixed effect
- farm, block and tx are random effects

Schabenberger & Pierce fit the following model:

fixed effects: tx
random effects: block/farm plus *random interaction term for farm and treatment*

I?ve started with lme as follows:

farmdata=data.frame(farm,tx,block,yield)
m1=lme(yield~treatment,random=~1|farm/block/treatment,farmdata)

But this is obviously wrong as I?d be interested in the treatment:farm interaction.

I guess I?d need to set this up using the pdMat() classes (pdIdent, pdBlocked)?

Any help would be greatly appreciated!

Best wishes
Christoph

(using R 2.15.1 on Windows 7 Professional 32-bit).

####

farm	tx	block	yield
1	A	1	30.8601
1	A	2	30.3216
1	A	3	32.3135
1	B	1	33.3089
1	B	2	30.943
1	B	3	35.2381
2	A	1	31.3924
2	A	2	30.6227
2	A	3	29.9349
2	B	1	27.8756
2	B	2	25.2517
2	B	3	21.7799
3	A	1	39.216
3	A	2	38.9588
3	A	3	35.386
3	B	1	41.9458
3	B	2	43.3782
3	B	3	41.0985
4	A	1	37.1987
4	A	2	36.1024
4	A	3	35.8494
4	B	1	30.9673
4	B	2	32.5553
4	B	3	33.0424
5	A	1	24.9758
5	A	2	22.0432
5	A	3	22.9343
5	B	1	23.3903
5	B	2	24.5053
5	B	3	23.2413
6	A	1	28.059
6	A	2	27.9827
6	A	3	25.1334
6	B	1	28.6984
6	B	2	25.6783
6	B	3	25.8853
7	A	1	27.8232
7	A	2	25.3218
7	A	3	26.5197
7	B	1	37.2286
7	B	2	34.4472
7	B	3	32.4972
8	A	1	29.4101
8	A	2	26.6327
8	A	3	29.6004
8	B	1	30.9808
8	B	2	30.7152
8	B	3	30.6305




-- 
PD Dr Christoph Scherber
Georg-August University Goettingen
Department of Crop Science
Agroecology
Grisebachstrasse 6
D-37077 Goettingen
Germany
phone 0049 (0)551 39 8807
fax 0049 (0)551 39 8806
http://www.gwdg.de/~cscherb1


From Christoph.Scherber at agr.uni-goettingen.de  Thu Nov 15 15:57:59 2012
From: Christoph.Scherber at agr.uni-goettingen.de (Christoph Scherber)
Date: Thu, 15 Nov 2012 15:57:59 +0100
Subject: [R-sig-ME] Treatment:Block interactions in lme (Schabenberger &
	Pierce 2002)
Message-ID: <50A502F7.9080005@agr.uni-goettingen.de>

Dear all,

I have found the solution myself - it?s only possible using lmer and crossed random effects:

detach(package:nlme)
library(lme4)

farmdata$TRM=as.factor(farmdata$treatment)
farmdata$BL=as.factor(farmdata$block)
farmdata$FA=as.factor(farmdata$farm)

m2<-lmer(yield~TRM+
(1|FA/BL)+(1|FA/TRM),farmdata)

The results are exactly the same as in Schabenberger & Pierce (2002), output 7.8 (page 477).


Best wishes,
Christoph

(using R 2.15.1 on Windows 7 Professional 32-bit).

####

farm	tx	block	yield
1	A	1	30.8601
1	A	2	30.3216
1	A	3	32.3135
1	B	1	33.3089
1	B	2	30.943
1	B	3	35.2381
2	A	1	31.3924
2	A	2	30.6227
2	A	3	29.9349
2	B	1	27.8756
2	B	2	25.2517
2	B	3	21.7799
3	A	1	39.216
3	A	2	38.9588
3	A	3	35.386
3	B	1	41.9458
3	B	2	43.3782
3	B	3	41.0985
4	A	1	37.1987
4	A	2	36.1024
4	A	3	35.8494
4	B	1	30.9673
4	B	2	32.5553
4	B	3	33.0424
5	A	1	24.9758
5	A	2	22.0432
5	A	3	22.9343
5	B	1	23.3903
5	B	2	24.5053
5	B	3	23.2413
6	A	1	28.059
6	A	2	27.9827
6	A	3	25.1334
6	B	1	28.6984
6	B	2	25.6783
6	B	3	25.8853
7	A	1	27.8232
7	A	2	25.3218
7	A	3	26.5197
7	B	1	37.2286
7	B	2	34.4472
7	B	3	32.4972
8	A	1	29.4101
8	A	2	26.6327
8	A	3	29.6004
8	B	1	30.9808
8	B	2	30.7152
8	B	3	30.6305




-- 
PD Dr Christoph Scherber
Georg-August University Goettingen
Department of Crop Science
Agroecology
Grisebachstrasse 6
D-37077 Goettingen
Germany
phone 0049 (0)551 39 8807
fax 0049 (0)551 39 8806
http://www.gwdg.de/~cscherb1


From chantepie at mnhn.fr  Thu Nov 15 18:53:03 2012
From: chantepie at mnhn.fr (Stephane Chantepie)
Date: Thu, 15 Nov 2012 18:53:03 +0100
Subject: [R-sig-ME] How to assess significance of variance
	components(Please discard previous e mail... but read this one)
In-Reply-To: <Pine.LNX.4.64.1211151137130.30525@orpheus.qimr.edu.au>
References: <20121018115219.60162drikv668spf@dsiwebmail.mnhn.fr>
	<201211141704.57285.chantepie@mnhn.fr>
	<Pine.LNX.4.64.1211151137130.30525@orpheus.qimr.edu.au>
Message-ID: <201211151853.03444.chantepie@mnhn.fr>

Hi,

Thank David for the package reference. 

Sorry, I did not recall the context of my work but I am doing animal models on  
Poisson distributed traits. So I have to use MCMCglmm package -and 
consequently I am in a Bayesian framework).

I want to test an increased in genetic variance (VA) by AGE. The major issue 
come from the fact that univariate models using age-classes show a decrease 
with VA across age and the random regression show an increase with age. I want 
to test the accuracy of AGExVA parameter of the random regression.

-MCMCglmm give posterior distributions well shape for all parameters of each 
model, so it cannot be a criterion of rejecting a model. 
-According to Jarrod, DIC is not usable with Poisson distribution trait.

I am unable to decide if univariate or RR which provide the best explicable 
results. 

Have someone an idea to define a criterion? 

thank in advance


Stephane


From raptorbio at hotmail.com  Thu Nov 15 19:39:07 2012
From: raptorbio at hotmail.com (Adam Smith)
Date: Thu, 15 Nov 2012 13:39:07 -0500
Subject: [R-sig-ME] Discrepancy in residuals in equivalent glmer (lme4) and
 glmmadmb models
Message-ID: <BAY170-W510DAAC50187C1A8BCA127A1520@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121115/1bc530fd/attachment.pl>

From raptorbio at hotmail.com  Thu Nov 15 20:01:46 2012
From: raptorbio at hotmail.com (Adam Smith)
Date: Thu, 15 Nov 2012 14:01:46 -0500
Subject: [R-sig-ME] Repost in plain text: Discrepancy in residuals in
 equivalent glmer (lme4) and glmmadmb models
In-Reply-To: <BAY170-W510DAAC50187C1A8BCA127A1520@phx.gbl>
References: <BAY170-W510DAAC50187C1A8BCA127A1520@phx.gbl>
Message-ID: <BAY170-W2334133A793392258D95AA1520@phx.gbl>


Sorry all, here's a plain text version that is hopefully more user-friendly...

Original post follows:

All,

Can someone please clarify for me why lme4 (glmer) and glmmADMB would generate essentially identical estimate of fixed and random effects in a Poisson log-normal (individual-level random effect for overdispersion) but give (often dramatically) different residual values? ?It must have something to do with the way fitted values are estimated or SDs are calculated for each observation, yes??

Any reason I should favor one over the other?

For context, I was comparing the Poisson log-normal model with negative binomial models in glmmADMB, but I also like to compare the lme4 estimation with the glmmADMB version for peace of mind.

Thanks for any clarifications...

Adam Smith

# Loading required packages
toLoad <- c("glmmADMB", "lme4", "ggplot2", "gridExtra")
lapply(toLoad, library, character.only = TRUE)

> sessionInfo()
R version 2.14.1 (2011-12-22)
Platform: x86_64-pc-mingw32/x64 (64-bit)

attached base packages:
[1] grid ? ? ?stats4 ? ?stats ? ? graphics ?grDevices utils ? ? datasets ?methods ? base ? ??

attached base packages:
[1] grid ? ? ?stats4 ? ?stats ? ? graphics ?grDevices utils ? ? datasets ?methods ? base ? ??

other attached packages:
[1] gridExtra_0.9.1 ? ?ggplot2_0.9.1 ? ? ?numDeriv_2010.11-1 lme4_0.999375-42 ? Matrix_1.0-3 ? ? ? lattice_0.20-0 ? ?
[7] glmmADMB_0.7.2.5 ? R2admb_0.7.5 ? ? ? MASS_7.3-16 ? ? ??

# Data available here if you feel like messing with it:
# https://www.dropbox.com/s/9zzy5qb8y207os0/testdata
# NOTE: When downloaded, I think dropbox will attach a*.txt extension to the file
# Delete the extension before loading with dget()
testdata = dget("C:/temp/testdata") # Obviously, code assume you saved it to C:/temp
str(testdata)

# Code for lme4 and glmmADMB versions of the Poisson log-normal GLMM
oP_glmer <- glmer(passes ~ phen + nightWsp + nightMb + nightWp12 + nightWpSeas + deltaTemp +
? deltaRh + deltaMb + propPrecip + tempresid + skycov + vis + (1|site:year) + (1|obs),?
? ? ? ? ? ? ? ? ? family="poisson", data=testdata)

oP_admb <- glmmadmb(passes ~ phen + nightWsp + nightMb + nightWp12 + nightWpSeas + deltaTemp +
? deltaRh + deltaMb + propPrecip + tempresid + skycov + vis + (1|site:year) + (1|obs),
? ? ? ? ? ? ? ? ? ? family="poisson", data=testdata, admb.opts=admbControl(shess=FALSE,noinit=FALSE))

# Creating plots comparing fixed and random effects between models
fixed.df <- data.frame(glmer_fixed = fixef(oP_glmer), admb_fixed = fixef(oP_admb))
fixed_plot <- ggplot(fixed.df, aes(glmer_fixed, admb_fixed)) + geom_smooth() + geom_point()
site_year.df <- data.frame(ranef(oP_glmer)[[2]][,1], ranef(oP_admb)[[1]]); names(site_year.df) = c("glmer_re1", "admb_re1")
site_year_plot <- ggplot(site_year.df, aes(glmer_re1, admb_re1)) + geom_smooth() + geom_point()
obs.df <- data.frame(ranef(oP_glmer)[[1]][,1], ranef(oP_admb)[[2]]); names(obs.df) = c("glmer_re2", "admb_re2")
obs_plot <- ggplot(obs.df, aes(glmer_re2, admb_re2)) + geom_smooth() + geom_point()

# Creating plot comparing residuals between models
fitted.df <- data.frame(glmer_fitted = fitted(oP_glmer), admb_fitted = fitted(oP_admb))
fitted_plot <- ggplot(fitted.df, aes(glmer_fitted, admb_fitted)) + geom_smooth() + geom_point()
resids.df <- data.frame(glmer_resids = residuals(oP_glmer, type="pearson"), admb_resids = residuals(oP_admb, type = "pearson"))
resid_plot <- ggplot(resids.df, aes(glmer_resids, admb_resids)) + geom_smooth() + geom_point()

# Generating plot
grid.arrange(arrangeGrob(fixed_plot, site_year_plot, obs_plot, ncol = 3), fitted_plot, resid_plot)

 		 	   		  

From David.Duffy at qimr.edu.au  Fri Nov 16 00:06:21 2012
From: David.Duffy at qimr.edu.au (David Duffy)
Date: Fri, 16 Nov 2012 09:06:21 +1000
Subject: [R-sig-ME] How to assess significance of variance
 components(Please discard previous e mail... but read this one)
In-Reply-To: <201211151853.03444.chantepie@mnhn.fr>
References: <20121018115219.60162drikv668spf@dsiwebmail.mnhn.fr>
	<201211141704.57285.chantepie@mnhn.fr>
	<Pine.LNX.4.64.1211151137130.30525@orpheus.qimr.edu.au>
	<201211151853.03444.chantepie@mnhn.fr>
Message-ID: <alpine.LMD.2.00.1211160845210.22399@orpheus.qimr.edu.au>

On Fri, 16 Nov 2012, Stephane Chantepie wrote:

> The major issue come from the fact that univariate models using 
> age-classes show a decrease with VA across age and the random regression 
> show an increase with age.

I was going to suggest categorizing age ;), and doing likelihood ratio 
tests using pedigreemm.  It _sounds_ like your distributional assumptions 
might need checking, or maybe you have no power to estimate these kinds of 
models, or you have to centre age.  Does phenotypic variance fall off with 
age?  Have you done diagnostic plots for poissonness? What do simple 
correlations between different classes of relatives look like?

Just 2c. David.

| David Duffy (MBBS PhD)                                         ,-_|\
| email: davidD at qimr.edu.au  ph: INT+61+7+3362-0217 fax: -0101  /     *
| Epidemiology Unit, Queensland Institute of Medical Research   \_,-._/
| 300 Herston Rd, Brisbane, Queensland 4029, Australia  GPG 4D0B994A v


From bbolker at gmail.com  Fri Nov 16 05:04:34 2012
From: bbolker at gmail.com (Ben Bolker)
Date: Fri, 16 Nov 2012 04:04:34 +0000 (UTC)
Subject: [R-sig-ME] Extracting model matrices used by lmer
References: <CAGG0PdAHnSG0_E+B2KYEtZE5Lzu-W=X5mjYaMz91hmT+VgsN9g@mail.gmail.com>
Message-ID: <loom.20121116T050335-45@post.gmane.org>

Asaf Weinstein <asafw.at.wharton at ...> writes:

> 
> Hello again,
> 
> Is there an easy way of obtaining the X and Z model matrices in
> 
> *y = X*Beta + Z*u + eps*
> 
> with the lmer function? I am trying to extract these because I want to
> obtain maximum likelihood estimates for the case where sigma sq (error
> variance) is known.


See

?getME

As shown in the examples:

   (nmME <- eval(formals(getME)$name))
 [1] "X"       "Z"       "Zt"      "u"       "Gp"      "L"       "Lambda" 
 [8] "Lambdat" "A"       "flist"   "RX"      "RZX"     "beta"    "theta"  
[15] "REML"    "n_rtrms" "is_REML"


so getME(model,"X") and getME(model,"Z") should do what you want.


From bbolker at gmail.com  Fri Nov 16 23:18:27 2012
From: bbolker at gmail.com (Ben Bolker)
Date: Fri, 16 Nov 2012 22:18:27 +0000 (UTC)
Subject: [R-sig-ME] Repost in plain text: Discrepancy in residuals in
	equivalent glmer (lme4) and glmmadmb models
References: <BAY170-W510DAAC50187C1A8BCA127A1520@phx.gbl>
	<BAY170-W2334133A793392258D95AA1520@phx.gbl>
Message-ID: <loom.20121116T231706-268@post.gmane.org>

Adam Smith <raptorbio at ...> writes:

> 
> 
> Sorry all, here's a plain text version that is hopefully more user-friendly...
> 
> Original post follows:
> 

> Can someone please clarify for me why lme4 (glmer) and glmmADMB
> would generate essentially identical estimate of fixed and random
> effects in a Poisson log-normal (individual-level random effect for
> overdispersion) but give (often dramatically) different residual
> values? ?It must have something to do with the way fitted values are
> estimated or SDs are calculated for each observation, yes??
 
Looking into this.  It looks like there might be a bug in
the glmmADMB calculation, but I'm not sure yet.  In the example
I tried the fitted values as well as the residuals differed,
so it's not just a problem with the SDs.

  Ben Bolker


From bbolker at gmail.com  Sat Nov 17 22:09:00 2012
From: bbolker at gmail.com (Ben Bolker)
Date: Sat, 17 Nov 2012 21:09:00 +0000 (UTC)
Subject: [R-sig-ME] Repost in plain text: Discrepancy in residuals in
	equivalent glmer (lme4) and glmmadmb models
References: <BAY170-W510DAAC50187C1A8BCA127A1520@phx.gbl>
	<BAY170-W2334133A793392258D95AA1520@phx.gbl>
Message-ID: <loom.20121117T220726-190@post.gmane.org>

Adam Smith <raptorbio at ...> writes:

> Sorry all, here's a plain text version that is hopefully more user-friendly...
> 
> Original post follows:
> 
> All,
 
> Can someone please clarify for me why lme4 (glmer) and glmmADMB
> would generate essentially identical estimate of fixed and random
> effects in a Poisson log-normal (individual-level random effect for
> overdispersion) but give (often dramatically) different residual
> values? ?It must have something to do with the way fitted values are
> estimated or SDs are calculated for each observation, yes??

  This was a bug in glmmADMB (forgot to scale the random effects
values by their standard deviations when computing fitted values).
Fixed on R-forge version (0.7.3) now. Thanks!

  Ben Bolker


From mariannestephan at hotmail.com  Sun Nov 18 17:26:56 2012
From: mariannestephan at hotmail.com (Marianne Anke)
Date: Sun, 18 Nov 2012 17:26:56 +0100
Subject: [R-sig-ME] Non-parametric 2x2 Mixed Factorial ANOVA in R?
In-Reply-To: <BLU162-W28FBA810635505176CCA1E6530@phx.gbl>
References: <DUB115-W63869B67C8675309F75EB6A9680@phx.gbl>,
	<loom.20121112T155117-900@post.gmane.org>,
	<alpine.LMD.2.00.1211130749100.25105@orpheus.qimr.edu.au>,
	<BLU162-W28FBA810635505176CCA1E6530@phx.gbl>
Message-ID: <DUB115-W1145C9ED67410BD794DF7B1A9570@phx.gbl>

Ein eingebundener Text mit undefiniertem Zeichensatz wurde abgetrennt.
Name: nicht verf?gbar
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121118/3c73738b/attachment.pl>

From bbolker at gmail.com  Sun Nov 18 17:56:52 2012
From: bbolker at gmail.com (Ben Bolker)
Date: Sun, 18 Nov 2012 11:56:52 -0500
Subject: [R-sig-ME] Non-parametric 2x2 Mixed Factorial ANOVA in R?
In-Reply-To: <DUB115-W1145C9ED67410BD794DF7B1A9570@phx.gbl>
References: <DUB115-W63869B67C8675309F75EB6A9680@phx.gbl>,
	<loom.20121112T155117-900@post.gmane.org>,
	<alpine.LMD.2.00.1211130749100.25105@orpheus.qimr.edu.au>,
	<BLU162-W28FBA810635505176CCA1E6530@phx.gbl>
	<DUB115-W1145C9ED67410BD794DF7B1A9570@phx.gbl>
Message-ID: <50A91354.2010505@gmail.com>

On 12-11-18 11:26 AM, Marianne Anke wrote:
> Thanks Ben and David for your help!
> 
> 
> I have done permutation testing and the results I got were actually
> similar compared to the traditional ANOVA (see below).
> 
> How should I phrase the result of this permutation test in an article?
> Would you mind making a suggestion?

  I would probably just present the results of the traditional ANOVA and
state in passing (maybe parenthetically) that the p-values derived from
a permutation-based analogue of the test were similar (and thus the
results are robust to non-normality of the data).  Don't forget to cite
as in citation("lmPerm") ...

> 
> 
> Thanks and best regards,
> 
> Marianne
> 
> 
> #####################################################################
> 
> Traditionalaov()ANOVA: 
> 
> 
> Error:Subject
> 
>           DfSumSqMeanSqFvaluePr(>F)
> 
> Group      1  17784  17784  0.972  0.337
> 
> Residuals 18 329459   18303               
> 
> 
> Error:Within
> 
>               Df Sum Sq Mean Sq F value Pr(>F)  
> 
> Session        1    831     831   0.408 0.5311  
> 
> Group:Session  1  10530  10530  5.1660.0355*
> 
> Residuals     18  36693    2038                 
> 
> ---
> 
> Signif.codes:  0?***?0.001?**?0.01?*?0.05?.?0.1??1 
> 
> 
> 
> Permutationaovp()ANOVA: 
> 
> [1]"Settings:  unique SS "
> 
> 
> Error:Subject
> 
> Component1:
> 
>           DfRSumSqRMeanSqIterPr(Prob)
> 
> Group      1    17784     17784  403    0.201
> 
> Residuals 18   329459     18303              
> 
> 
> 
> Error:Within
> 
> Component1:
> 
>               Df R Sum Sq R Mean Sq Iter Pr(Prob)  
> 
> Session        1      831     831.4  158  0.39241  
> 
> Group:Session  1    10530  10530.43934  0.02491*
> 
> Residuals     18    36693    2038.5                
> 
> ---
> 
> Signif.codes:  0?***?0.001?**?0.01?*?0.05?.?0.1??1 
> 
> #####################################################################
> 
> 
>> Date: Tue, 13 Nov 2012 07:50:05 +1000
>> From: David.Duffy at qimr.edu.au
>> To: r-sig-mixed-models at r-project.org
>> Subject: Re: [R-sig-ME] Non-parametric 2x2 Mixed Factorial ANOVA in R?
>>
>> On Tue, 13 Nov 2012, Ben Bolker wrote:
>>
>> > * you could try bootstrapping or permutation testing (being careful
>> > to respect the grouping structure of the data
>>
>> lmPerm package may be useful for this
>>
>> _______________________________________________
>> R-sig-mixed-models at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models


From bbolker at gmail.com  Sun Nov 18 18:45:43 2012
From: bbolker at gmail.com (Ben Bolker)
Date: Sun, 18 Nov 2012 17:45:43 +0000 (UTC)
Subject: [R-sig-ME] Error in glmer fit
References: <50A192E6.5040705@utoronto.ca>
	<AA818EAD2576BC488B4F623941DA74279475AC2C@inbomail.inbo.be>
	<CADtmEn432W6SkRbRsBtgwx3=ERtdOg7vgtKGhG1++6T=NisahA@mail.gmail.com>
	<50A3D582.7090300@utoronto.ca>
	<loom.20121115T004458-676@post.gmane.org>
Message-ID: <loom.20121118T183928-428@post.gmane.org>

Ben Bolker <bbolker at ...> writes:

> 
> Kevin E. Thorpe <kevin.thorpe at ...> writes:
> 
> > 
> > Thank you both for your responses.  Unfortunately neither solves the 
> > problem.  Using nAGQ=5 with lme4 results in the same error as already shown.
> > 
> > At Thierry's suggestion, I tried lme4.0 and get a different error.
> > 
> > glmer(InInt~speciality+position+stkperyr+conf+
> > age+years+risk+stktype+(1|pid),data=dord4mod,family=binomial)
> > Error in validObject(.Object) :
> >    invalid class "mer" object: invalid object for slot "resid" in class 
> > "mer": got class "labelled", should be or extend class "numeric"
> 
>   This is a pretty weird error.  Is this from a clean session?
>   Is there any chance you can provide a reproducible problem?
>   (You could send me your data.)
> 

  OK, on closer inspection: the problem is simply that
lme4 is complaining that it's expecting the response to be
numeric: class "labelled" is not "numeric".

A simple workaround is
glmer(as.numeric(InInt)~speciality+position+stkperyr+conf+
   age+years+risk+stktype+(1|pid),data=dord4mod,family=binomial)

The development version of lme4 doesn't appear to hit the
same problem, but runs into a PIRLS problem at some point later
in the code you sent me (with ...

dord.glmer <- glmer(InInt~speciality+position+
 stkperyr+conf+age+years+risk+stktype+(1|pid),
   data=dord4mod,family=binomial)
)

  Ben Bolker


From benton at stat.berkeley.edu  Mon Nov 19 15:19:27 2012
From: benton at stat.berkeley.edu (Katie Colborn)
Date: Mon, 19 Nov 2012 09:19:27 -0500
Subject: [R-sig-ME] fixed effects (co)variance matrix from MCMCglmm
Message-ID: <4959FFBD-929C-4448-94BA-1E66C12534E9@stat.berkeley.edu>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121119/3e9f0efb/attachment.pl>

From chantepie at mnhn.fr  Fri Nov 16 14:20:55 2012
From: chantepie at mnhn.fr (Stephane Chantepie)
Date: Fri, 16 Nov 2012 14:20:55 +0100
Subject: [R-sig-ME] How to assess significance of variance
	components(Please discard previous e mail... but read this one)
In-Reply-To: <alpine.LMD.2.00.1211160845210.22399@orpheus.qimr.edu.au>
References: <20121018115219.60162drikv668spf@dsiwebmail.mnhn.fr>
	<201211151853.03444.chantepie@mnhn.fr>
	<alpine.LMD.2.00.1211160845210.22399@orpheus.qimr.edu.au>
Message-ID: <201211161420.55413.chantepie@mnhn.fr>

> maybe you have no power to estimate these kinds of models, or you have to 
centre age. 
For this trait, I have more than 100000 data on 1600 individuals with an 
exhaustive pedegree. It is huge. Clearly, the number of individuals decrease 
decrease with age so I decided to analyse from to 15 years (data until 22 year 
old). 

> Does phenotypic variance fall off with age? 


> Have you done diagnostic plots for poissonness?

Yes, I have. The distribution is poisson without any doubt. I tried to log the 
data 

> What do simple correlations between different classes of relatives look 
like?

Models are runnings




> 
> Just 2c. David.
> 
> | David Duffy (MBBS PhD)                                         ,-_|\
> | email: davidD at qimr.edu.au  ph: INT+61+7+3362-0217 fax: -0101  /     *
> | Epidemiology Unit, Queensland Institute of Medical Research   \_,-._/
> | 300 Herston Rd, Brisbane, Queensland 4029, Australia  GPG 4D0B994A v


From bbolker at gmail.com  Mon Nov 19 15:58:37 2012
From: bbolker at gmail.com (Ben Bolker)
Date: Mon, 19 Nov 2012 14:58:37 +0000 (UTC)
Subject: [R-sig-ME] fixed effects (co)variance matrix from MCMCglmm
References: <4959FFBD-929C-4448-94BA-1E66C12534E9@stat.berkeley.edu>
Message-ID: <loom.20121119T155411-843@post.gmane.org>

Katie Colborn <benton at ...> writes:

> 
> Hi:
> 
> How do I obtain the variances (and covariances) for the fixed effects 
> from an MCMCglmm object? In a
> frequentist setting I would simply use algebra to obtain it from 
> the confidence intervals if it was not
> provided; however, I'm not sure if this is equivalent in
>  Bayesian credible intervals. Is it as simple as:
> 
> coeff - 1.96*SE = lower 95% CI?
> 
> Or is it sd(model$Sol)[1:3]?
> 
> If you solve for SE in the equation above it is 
> not equal to sd(model$Sol) (even after dividing by root n).
> Thanks for your help!
> 

  You have to be careful to distinguish between the standard deviation
and the standard error in this case, and to be aware that the posterior
distributions may not be multivariate normal.

  *If* the posteriors are multivariate normal, then

v <- var(model$Sol)  should give the variance-covariance matrix,

and sqrt(diag(v)/nrow(model$Sol))  should give the standard errors.

  If they're not multivariate normal (or at least if the marginal
posteriors aren't normal) then the credible intervals won't line
up with +/- 1.96*SE ...

  If in doubt, take a look at some density plots and scatterplots
of the posterior densities to get a better sense of what's going on.


From j.hadfield at ed.ac.uk  Mon Nov 19 16:09:34 2012
From: j.hadfield at ed.ac.uk (Jarrod Hadfield)
Date: Mon, 19 Nov 2012 15:09:34 +0000
Subject: [R-sig-ME] fixed effects (co)variance matrix from MCMCglmm
In-Reply-To: <loom.20121119T155411-843@post.gmane.org>
References: <4959FFBD-929C-4448-94BA-1E66C12534E9@stat.berkeley.edu>
	<loom.20121119T155411-843@post.gmane.org>
Message-ID: <20121119150934.16663we2tu4f1aqs@www.staffmail.ed.ac.uk>

Hi,

sqrt(diag(v)) should give the posterior standard deviations (akin to  
the standard errors)

sqrt(diag(v))/nrow(model$Sol) gives the standard error on the  
posterior mean given independence of the stored MCMC samples. Its a  
measure of the Monte Carlo error due to finite chain length.

Cheers,

Jarrod.





Quoting Ben Bolker <bbolker at gmail.com> on Mon, 19 Nov 2012 14:58:37  
+0000 (UTC):

> Katie Colborn <benton at ...> writes:
>
>>
>> Hi:
>>
>> How do I obtain the variances (and covariances) for the fixed effects
>> from an MCMCglmm object? In a
>> frequentist setting I would simply use algebra to obtain it from
>> the confidence intervals if it was not
>> provided; however, I'm not sure if this is equivalent in
>>  Bayesian credible intervals. Is it as simple as:
>>
>> coeff - 1.96*SE = lower 95% CI?
>>
>> Or is it sd(model$Sol)[1:3]?
>>
>> If you solve for SE in the equation above it is
>> not equal to sd(model$Sol) (even after dividing by root n).
>> Thanks for your help!
>>
>
>   You have to be careful to distinguish between the standard deviation
> and the standard error in this case, and to be aware that the posterior
> distributions may not be multivariate normal.
>
>   *If* the posteriors are multivariate normal, then
>
> v <- var(model$Sol)  should give the variance-covariance matrix,
>
> and sqrt(diag(v)/nrow(model$Sol))  should give the standard errors.
>
>   If they're not multivariate normal (or at least if the marginal
> posteriors aren't normal) then the credible intervals won't line
> up with +/- 1.96*SE ...
>
>   If in doubt, take a look at some density plots and scatterplots
> of the posterior densities to get a better sense of what's going on.
>
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>
>



-- 
The University of Edinburgh is a charitable body, registered in
Scotland, with registration number SC005336.


From j.hadfield at ed.ac.uk  Mon Nov 19 16:18:43 2012
From: j.hadfield at ed.ac.uk (Jarrod Hadfield)
Date: Mon, 19 Nov 2012 15:18:43 +0000
Subject: [R-sig-ME] fixed effects (co)variance matrix from MCMCglmm
In-Reply-To: <20121119150934.16663we2tu4f1aqs@www.staffmail.ed.ac.uk>
References: <4959FFBD-929C-4448-94BA-1E66C12534E9@stat.berkeley.edu>
	<loom.20121119T155411-843@post.gmane.org>
	<20121119150934.16663we2tu4f1aqs@www.staffmail.ed.ac.uk>
Message-ID: <20121119151843.16532689ze2qd58g@www.staffmail.ed.ac.uk>

Hi,

Sorry - I made a typo too:

sqrt(diag(v))/nrow(model$Sol) should read sqrt(diag(v)/nrow(model$Sol))

Cheers,

Jarrod

Quoting Jarrod Hadfield <j.hadfield at ed.ac.uk> on Mon, 19 Nov 2012  
15:09:34 +0000:

> Hi,
>
> sqrt(diag(v)) should give the posterior standard deviations (akin to  
> the standard errors)
>
> sqrt(diag(v))/nrow(model$Sol) gives the standard error on the  
> posterior mean given independence of the stored MCMC samples. Its a  
> measure of the Monte Carlo error due to finite chain length.
>
> Cheers,
>
> Jarrod.
>
>
>
>
>
> Quoting Ben Bolker <bbolker at gmail.com> on Mon, 19 Nov 2012 14:58:37  
> +0000 (UTC):
>
>> Katie Colborn <benton at ...> writes:
>>
>>>
>>> Hi:
>>>
>>> How do I obtain the variances (and covariances) for the fixed effects
>>> from an MCMCglmm object? In a
>>> frequentist setting I would simply use algebra to obtain it from
>>> the confidence intervals if it was not
>>> provided; however, I'm not sure if this is equivalent in
>>> Bayesian credible intervals. Is it as simple as:
>>>
>>> coeff - 1.96*SE = lower 95% CI?
>>>
>>> Or is it sd(model$Sol)[1:3]?
>>>
>>> If you solve for SE in the equation above it is
>>> not equal to sd(model$Sol) (even after dividing by root n).
>>> Thanks for your help!
>>>
>>
>>  You have to be careful to distinguish between the standard deviation
>> and the standard error in this case, and to be aware that the posterior
>> distributions may not be multivariate normal.
>>
>>  *If* the posteriors are multivariate normal, then
>>
>> v <- var(model$Sol)  should give the variance-covariance matrix,
>>
>> and sqrt(diag(v)/nrow(model$Sol))  should give the standard errors.
>>
>>  If they're not multivariate normal (or at least if the marginal
>> posteriors aren't normal) then the credible intervals won't line
>> up with +/- 1.96*SE ...
>>
>>  If in doubt, take a look at some density plots and scatterplots
>> of the posterior densities to get a better sense of what's going on.
>>
>> _______________________________________________
>> R-sig-mixed-models at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>
>>
>
>
>
> -- 
> The University of Edinburgh is a charitable body, registered in
> Scotland, with registration number SC005336.
>
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>
>



-- 
The University of Edinburgh is a charitable body, registered in
Scotland, with registration number SC005336.


From chantepie at mnhn.fr  Mon Nov 19 18:05:37 2012
From: chantepie at mnhn.fr (Stephane Chantepie)
Date: Mon, 19 Nov 2012 18:05:37 +0100
Subject: [R-sig-ME] How to assess significance of variance
	components(Please discard previous e mail... but read this one)
In-Reply-To: <alpine.LMD.2.00.1211160845210.22399@orpheus.qimr.edu.au>
References: <20121018115219.60162drikv668spf@dsiwebmail.mnhn.fr>
	<201211151853.03444.chantepie@mnhn.fr>
	<alpine.LMD.2.00.1211160845210.22399@orpheus.qimr.edu.au>
Message-ID: <201211191805.37920.chantepie@mnhn.fr>

Sorry once again, I have problems with my e-mail software which send draft 
without my approbation...It is very annoying

First thank David for your response

So, I have tried to used "pedigreemm" but I am unable to run random regression 
models whith this package. I succeed in fitting "VA" and "permanent 
environment" model without interaction. 

m1<-pedigreemm(oeuf~as.factor(st_age)+(1|animal)+(1|
ID),data=oeuf,family="poisson",REML=TRUE,pedigree=list(animal=ped),verbose=TRUE)

But  when I try to add an interaction like 

m2<-pedigreemm(oeuf~as.factor(st_age)+(st_age|animal)+(st_age|
ID),data=oeuf,family="poisson",REML=TRUE,pedigree=list(animal=ped),verbose=TRUE)

it does not work. I do not find examples on the internet to help me...

if someone has already done this kind of models?

> or maybe you have no power to estimate these kinds of
> models, or you have to centre age. 

I use centered age for each model?

For the problematic trait (number of  spz), I have more than 100000 data 
(repeated measurment) on more than 1600 individuals with an exhaustive 
pedigree. The number of individuals decrease with age so I decided to use data 
until 15 years old (older 23 years old). 
To be more precise on the results I have for the spz trait, the univariate 
models tend to show a deacrease but when taking into account the 95% 
confidence intervals, it could be really acceptable for having no interaction. 
When I plot the results from random regression, the curve increase but the 
confidence interval is quite big and additive genetic variance appear bigger 
than phenotypic variance. So it looks like VAxAge is not significant without 
beeing able to test it (other than graphically).  

With another trait (number of eggs); Va is increasing and there is a perfect 
match between univariate and random regression models from  MCMCglmm. So, I 
think  that the power is not the problem. The problem is that random 
regression with MCMCglmm failed to catch the constant variance across age. 



> Does phenotypic variance fall off with
> age? 

Not at all


> Have you done diagnostic plots for poissonness? 

Yes, I have. The distribution is poisson without any doubt. I  have tried to 
log the data to have a gaussian distribution but it does not give perfect 
gaussian distribution.

> What do simple
> correlations between different classes of relatives look like?

I am not sure to understand your question! What do tou mean by "different 
classes of relatives"?


I will try to use the last version of asreml which seems (not sure) to perform 
animal model for poisson distribution and test the VaxAge interaction...

Stephane


From andrea.cantieni at phz.ch  Tue Nov 20 11:56:48 2012
From: andrea.cantieni at phz.ch (Cantieni Andrea PHZ Schwyz)
Date: Tue, 20 Nov 2012 11:56:48 +0100
Subject: [R-sig-ME] mer-class in lme4 package
Message-ID: <BB6D87C3-3B08-4C0D-9412-2C706033EE28@phz.ch>

Hi,

I'm trying to access the transpose of model matrix  (Zt) for the random effects of an object returned by lmer().

In lme4.0 v0.999999-1 that is easy done via the slots, e.g. fm01 at Zt, where fm01 is an object of class "mer".

Can someone explain why this slot (and others) disappeared, e.g. in lme4 v0.99999911-0? And how I can access this properties anyway?

Thanks,
Andrea


From bbolker at gmail.com  Tue Nov 20 14:41:51 2012
From: bbolker at gmail.com (Ben Bolker)
Date: Tue, 20 Nov 2012 13:41:51 +0000 (UTC)
Subject: [R-sig-ME] mer-class in lme4 package
References: <BB6D87C3-3B08-4C0D-9412-2C706033EE28@phz.ch>
Message-ID: <loom.20121120T144033-898@post.gmane.org>

Cantieni Andrea PHZ Schwyz <andrea.cantieni at ...> writes:

> 
> Hi,
> 
> I'm trying to access the transpose of model matrix 
> (Zt) for the random effects of an object returned by lmer().
> 
> In lme4.0 v0.999999-1 that is easy done via the slots, e.g.
> fm01 <at> Zt, where fm01 is an object of class "mer".
> 
> Can someone explain why this slot (and others) disappeared, e.g. in lme4
v0.99999911-0? And how I can
> access this properties anyway?

  To get the transpose of the model matrix in recent versions of
lme4 (either stable/CRAN or development/R-Forge), please use
getME(fm01,"Zt") ... we have instituted this accessor method because
it gives us more freedom to rearrange the internal storage format
of the models as we see fit, without breaking anyone's code going
forward.

  Ben Bolker


From andrea.cantieni at phz.ch  Tue Nov 20 15:26:16 2012
From: andrea.cantieni at phz.ch (Cantieni Andrea PHZ Schwyz)
Date: Tue, 20 Nov 2012 15:26:16 +0100
Subject: [R-sig-ME] mer-class in lme4 package
In-Reply-To: <loom.20121120T144033-898@post.gmane.org>
References: <BB6D87C3-3B08-4C0D-9412-2C706033EE28@phz.ch>
	<loom.20121120T144033-898@post.gmane.org>
Message-ID: <1995D034-A011-4327-B464-1BB7ACAD1DDD@phz.ch>

Thank you, Ben Bolker, for the explanations. It works...!

Andrea Cantieni


Am 20.11.2012 um 14:41 schrieb Ben Bolker:

> Cantieni Andrea PHZ Schwyz <andrea.cantieni at ...> writes:
> 
>> 
>> Hi,
>> 
>> I'm trying to access the transpose of model matrix 
>> (Zt) for the random effects of an object returned by lmer().
>> 
>> In lme4.0 v0.999999-1 that is easy done via the slots, e.g.
>> fm01 <at> Zt, where fm01 is an object of class "mer".
>> 
>> Can someone explain why this slot (and others) disappeared, e.g. in lme4
> v0.99999911-0? And how I can
>> access this properties anyway?
> 
>  To get the transpose of the model matrix in recent versions of
> lme4 (either stable/CRAN or development/R-Forge), please use
> getME(fm01,"Zt") ... we have instituted this accessor method because
> it gives us more freedom to rearrange the internal storage format
> of the models as we see fit, without breaking anyone's code going
> forward.
> 
>  Ben Bolker
> 
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models


From r01db11 at abdn.ac.uk  Tue Nov 20 16:18:05 2012
From: r01db11 at abdn.ac.uk (Brickhill, Daisy)
Date: Tue, 20 Nov 2012 15:18:05 +0000
Subject: [R-sig-ME]  False convergence lmer
Message-ID: <EF102B09CB7FCC43952890D497B467C9527B283F30@VMAILB.uoa.abdn.ac.uk>

Hi,
I am modelling how the movements of birds effects their reproductive success. I have 7 groups of nests which have differing mean brood sizes (e.g. group A: brood size 3.5, group B: brood size 3.0 etc). A bird dispersing from A to B therefore would lose 0.5 of a chick.What I want to know is if the difference in brood size gained (or lost) by movements varies with nest availability in 'better' areas (i.e. all those groups that have higher brood size than the group of origin). I have constructed a mixed model using lme4 with a gaussian distribution
Brood size difference between origin and destination~number of better nests available +number of nests available in the group of origin + (1|group of origin) + (1|group of destination).
However I get the warning message:
Warning message:
In mer_finalize(ans) : false convergence (8)
Looking at the mailing list I have tried standardising the predictor variables, I have tried dividing them by 100. The only thing that works on the model is removing either the random effect of  group of origin or group of destination (removing the fixed effects still gives the error message). I wondered if the problem is that the same combinations of groups of origin and destination always have the same difference between them?
The other thing that occured to me is that birds are quite likely to remain in their group of origin and for some groups this is as high as 67% - might that be a cause?
If it's not likely to be this can anyone give me any pointers as to what to look for, to work out what it is in my data that is causing this problem?
Many thanks,
Daisy


The University of Aberdeen is a charity registered in Scotland, No SC013683.


From Martin.Biuw at nina.no  Tue Nov 20 18:52:52 2012
From: Martin.Biuw at nina.no (Biuw, Martin)
Date: Tue, 20 Nov 2012 17:52:52 +0000
Subject: [R-sig-ME] Interpretation and use of parameters in beta glmmadmb
Message-ID: <32BF359C0C4F9446BEBFBB9FB405C61F61DCADF6@NINSRV05.nina.no>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121120/228914f3/attachment.pl>

From Martin.Biuw at nina.no  Tue Nov 20 20:36:53 2012
From: Martin.Biuw at nina.no (Biuw, Martin)
Date: Tue, 20 Nov 2012 19:36:53 +0000
Subject: [R-sig-ME] Interpretation and use of parameters from beta glmmadmb
Message-ID: <32BF359C0C4F9446BEBFBB9FB405C61F61DCAE6F@NINSRV05.nina.no>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121120/b72f423c/attachment.pl>

From Martin.Biuw at nina.no  Tue Nov 20 20:52:00 2012
From: Martin.Biuw at nina.no (Biuw, Martin)
Date: Tue, 20 Nov 2012 19:52:00 +0000
Subject: [R-sig-ME] INterpretation and use of parameters from beta glmmadmb
	- apology
Message-ID: <32BF359C0C4F9446BEBFBB9FB405C61F61DCAEB6@NINSRV05.nina.no>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121120/a0f55d3f/attachment.pl>

From bbolker at gmail.com  Wed Nov 21 04:54:48 2012
From: bbolker at gmail.com (Ben Bolker)
Date: Wed, 21 Nov 2012 03:54:48 +0000 (UTC)
Subject: [R-sig-ME]
	=?utf-8?q?INterpretation_and_use_of_parameters_from_be?=
	=?utf-8?q?ta_glmmadmb=09-_apology?=
References: <32BF359C0C4F9446BEBFBB9FB405C61F61DCAEB6@NINSRV05.nina.no>
Message-ID: <loom.20121121T044707-818@post.gmane.org>

Biuw, Martin <Martin.Biuw at ...> writes:

> Hi all, I??m using glmmADMB to fit a mixed model with a beta
> famiily, and I would like some clarification on how to interpret the
> parameter estimates. Specifically, I would like to use the results
> as input into the R function ??dbeta??, but I??m not sure what in
> the glmmadmb output corresponds to the shape1 and shape2 parameters
> of dbeta. I??m assuming the ??alpha??, ??b?? and ??stdbeta??
> components are the ones to go for. But which is which?

> According to the dbeta help page, shape1 and shape2 corresponds to
> alpha and beta respectively in the beta density function:
> gamma(alpha+beta)/(gamma(alpha)gamma(beta))x^(alpha-1)(1-x)^(beta-1)
> But how do these correspond to the ??alpha?? (dispersion parameter)
> and ??b?? in the glmmadmb output? I get the most realistic results
> (when comparing to the distribution of my data) if I let the the
> ??alpha?? corresponds to shape2 (i.e. ?? in the above expression)
> and ??b?? to shape1 (?? in the expression). Maybe I??m only being
> confused by the nomenclature? But if I??ve understood the maths
> behind the beta distribution properly, when shape1 is greater than
> shape2 the distribution is left-skewed, and the dispersion is
> determined by the ratio shape2/shape1. And vice versa for a
> right-skewed distribution. So how can I determine which goes in as
> shape1 and shape2 when calculating my beta densities?

We need a parameterization that separates the mean and the
variance, for example as in the parameterization underlying
the beta-binomial in Morris (1997), American Naturalist 150:299-327
(not quite the same thing but a parallel situation).

Looking at the guts of the TPL (model definition) file we find:

file.show(system.file("tpl","glmmadmb.tpl",package="glmmADMB"))

  df1b2variable ln_beta_density(double y,const df1b2variable & mu,
    const df1b2variable& phi)
  {
    df1b2variable omega=mu*phi;
    df1b2variable tau=phi-mu*phi;
    df1b2variable lb=betaln(omega,tau);
    df1b2variable d=(omega-1)*log(y)+(tau-1)*log(1.0-y)-lb;
    return d;
  }

Where mu is the mean (as determined from a logit-linked
linear model) and phi is the dispersion parameter.  Thus
omega and tau are the shape parameters ...


From Martin.Biuw at nina.no  Wed Nov 21 10:34:47 2012
From: Martin.Biuw at nina.no (Biuw, Martin)
Date: Wed, 21 Nov 2012 09:34:47 +0000
Subject: [R-sig-ME] INterpretation and use of parameters from beta
 glmmadmb	- apology
In-Reply-To: <loom.20121121T044707-818@post.gmane.org>
References: <32BF359C0C4F9446BEBFBB9FB405C61F61DCAEB6@NINSRV05.nina.no>
	<loom.20121121T044707-818@post.gmane.org>
Message-ID: <32BF359C0C4F9446BEBFBB9FB405C61F61DCC067@NINSRV05.nina.no>

Thanks very much Ben. That makes a lot of sense.
(And apologies again. I now know the R-sig-ME mailing list system doesn't like single quotes..)
Martin

-----Original Message-----
From: r-sig-mixed-models-bounces at r-project.org [mailto:r-sig-mixed-models-bounces at r-project.org] On Behalf Of Ben Bolker
Sent: 21 November 2012 04:55
To: r-sig-mixed-models at r-project.org
Subject: Re: [R-sig-ME] INterpretation and use of parameters from beta glmmadmb - apology

Biuw, Martin <Martin.Biuw at ...> writes:

> Hi all, I??m using glmmADMB to fit a mixed model with a beta famiily, 
> and I would like some clarification on how to interpret the parameter 
> estimates. Specifically, I would like to use the results as input into 
> the R function ??dbeta??, but I??m not sure what in the glmmadmb 
> output corresponds to the shape1 and shape2 parameters of dbeta. I??m 
> assuming the ??alpha??, ??b?? and ??stdbeta?? components are the ones 
> to go for. But which is which?

> According to the dbeta help page, shape1 and shape2 corresponds to 
> alpha and beta respectively in the beta density function:
> gamma(alpha+beta)/(gamma(alpha)gamma(beta))x^(alpha-1)(1-x)^(beta-1)
> But how do these correspond to the ??alpha?? (dispersion parameter) 
> and ??b?? in the glmmadmb output? I get the most realistic results 
> (when comparing to the distribution of my data) if I let the the 
> ??alpha?? corresponds to shape2 (i.e. ?? in the above expression) and 
> ??b?? to shape1 (?? in the expression). Maybe I??m only being confused 
> by the nomenclature? But if I??ve understood the maths behind the beta 
> distribution properly, when shape1 is greater than
> shape2 the distribution is left-skewed, and the dispersion is 
> determined by the ratio shape2/shape1. And vice versa for a 
> right-skewed distribution. So how can I determine which goes in as
> shape1 and shape2 when calculating my beta densities?

We need a parameterization that separates the mean and the variance, for example as in the parameterization underlying the beta-binomial in Morris (1997), American Naturalist 150:299-327 (not quite the same thing but a parallel situation).

Looking at the guts of the TPL (model definition) file we find:

file.show(system.file("tpl","glmmadmb.tpl",package="glmmADMB"))

  df1b2variable ln_beta_density(double y,const df1b2variable & mu,
    const df1b2variable& phi)
  {
    df1b2variable omega=mu*phi;
    df1b2variable tau=phi-mu*phi;
    df1b2variable lb=betaln(omega,tau);
    df1b2variable d=(omega-1)*log(y)+(tau-1)*log(1.0-y)-lb;
    return d;
  }

Where mu is the mean (as determined from a logit-linked linear model) and phi is the dispersion parameter.  Thus omega and tau are the shape parameters ...

_______________________________________________
R-sig-mixed-models at r-project.org mailing list https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models

From emm.charpentier at free.fr  Wed Nov 21 09:21:38 2012
From: emm.charpentier at free.fr (Emmanuel Charpentier)
Date: Wed, 21 Nov 2012 08:21:38 +0000 (UTC)
Subject: [R-sig-ME] INterpretation and use of parameters from beta
	glmmadmb	- apology
References: <32BF359C0C4F9446BEBFBB9FB405C61F61DCAEB6@NINSRV05.nina.no>
	<loom.20121121T044707-818@post.gmane.org>
Message-ID: <k8i2ui$hi1$1@ger.gmane.org>

By the way, the mean of a beta(a, b) is a/(a+b) (semi-obvious) and the 
variance is ab/((a+b)^2*(a+b+1)) (less obvious, but maxima dixit).

Still according to maxima, this pair of equations leads to:
a=m*(v+m*(1-m))/v and b=(m-1)*(v+m*(1-m))/v
after a slight cosmetic rearrangement.

HTH,

					Emmanuel Charpentier

Le Wed, 21 Nov 2012 03:54:48 +0000, Ben Bolker wrote:

> Biuw, Martin <Martin.Biuw at ...> writes:
> 
>> Hi all, I??m using glmmADMB to fit a mixed model with a beta famiily,
>> and I would like some clarification on how to interpret the parameter
>> estimates. Specifically, I would like to use the results as input into
>> the R function ??dbeta??, but I??m not sure what in the glmmadmb output
>> corresponds to the shape1 and shape2 parameters of dbeta. I??m assuming
>> the ??alpha??, ??b?? and ??stdbeta??
>> components are the ones to go for. But which is which?
> 
>> According to the dbeta help page, shape1 and shape2 corresponds to
>> alpha and beta respectively in the beta density function:
>> gamma(alpha+beta)/(gamma(alpha)gamma(beta))x^(alpha-1)(1-x)^(beta-1)
>> But how do these correspond to the ??alpha?? (dispersion parameter) and
>> ??b?? in the glmmadmb output? I get the most realistic results (when
>> comparing to the distribution of my data) if I let the the ??alpha??
>> corresponds to shape2 (i.e. ?? in the above expression) and ??b?? to
>> shape1 (?? in the expression). Maybe I??m only being confused by the
>> nomenclature? But if I??ve understood the maths behind the beta
>> distribution properly, when shape1 is greater than shape2 the
>> distribution is left-skewed, and the dispersion is determined by the
>> ratio shape2/shape1. And vice versa for a right-skewed distribution. So
>> how can I determine which goes in as shape1 and shape2 when calculating
>> my beta densities?
> 
> We need a parameterization that separates the mean and the variance, for
> example as in the parameterization underlying the beta-binomial in
> Morris (1997), American Naturalist 150:299-327 (not quite the same thing
> but a parallel situation).
> 
> Looking at the guts of the TPL (model definition) file we find:
> 
> file.show(system.file("tpl","glmmadmb.tpl",package="glmmADMB"))
> 
>   df1b2variable ln_beta_density(double y,const df1b2variable & mu,
>     const df1b2variable& phi)
>   {
>     df1b2variable omega=mu*phi;
>     df1b2variable tau=phi-mu*phi;
>     df1b2variable lb=betaln(omega,tau);
>     df1b2variable d=(omega-1)*log(y)+(tau-1)*log(1.0-y)-lb;
>     return d;
>   }
> 
> Where mu is the mean (as determined from a logit-linked linear model)
> and phi is the dispersion parameter.  Thus omega and tau are the shape
> parameters ...
> 
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models


From bates at stat.wisc.edu  Wed Nov 21 19:43:21 2012
From: bates at stat.wisc.edu (Douglas Bates)
Date: Wed, 21 Nov 2012 12:43:21 -0600
Subject: [R-sig-ME] help with a mixed effect
In-Reply-To: <CCA5FE0A67FDC344BFEEC356BCD8C067AA5A337C@exdb1.ad.skogoglandskap.no>
References: <CCA5FE0A67FDC344BFEEC356BCD8C067AA5A337C@exdb1.ad.skogoglandskap.no>
Message-ID: <CAO7JsnRTy7Yj8EndSn51PsxcUMpLxMoK1Cm3edKFaYhXyA3a3g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121121/0ab1ed9f/attachment.pl>

From jeffrey_warren at fws.gov  Thu Nov 22 00:09:20 2012
From: jeffrey_warren at fws.gov (Jeffrey Warren)
Date: Wed, 21 Nov 2012 16:09:20 -0700
Subject: [R-sig-ME] Multinomial mixed-effect model in nnet
Message-ID: <185d5468360903d3750139ee21267980@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121121/2f9d50d5/attachment.pl>

From GIO at skogoglandskap.no  Thu Nov 22 20:55:16 2012
From: GIO at skogoglandskap.no (Giovanna Ottaviani)
Date: Thu, 22 Nov 2012 19:55:16 +0000
Subject: [R-sig-ME] Mixed models and learning curves
Message-ID: <CCA5FE0A67FDC344BFEEC356BCD8C067AA5A9D67@exdb1.ad.skogoglandskap.no>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121122/bb6dcf3f/attachment.pl>

From ellen.pape at gmail.com  Thu Nov 22 21:01:50 2012
From: ellen.pape at gmail.com (ellen pape)
Date: Thu, 22 Nov 2012 21:01:50 +0100
Subject: [R-sig-ME] assumptions linear mixed models
Message-ID: <CANW5OGCXDK58oa_5Dc8rH0nKyL4HyZMZjAiHUKNEvAFJE2Q6XA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121122/92f0d912/attachment.pl>

From jmmartelo at fc.ul.pt  Thu Nov 22 21:30:59 2012
From: jmmartelo at fc.ul.pt (joana martelo)
Date: Thu, 22 Nov 2012 20:30:59 +0000
Subject: [R-sig-ME] Error in .local(object, n, verbose,
	...) : Update not yet written
Message-ID: <000801cdc8f0$4939e690$dbadb3b0$@ul.pt>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121122/9ea0c99e/attachment.pl>

From bbolker at gmail.com  Thu Nov 22 23:38:15 2012
From: bbolker at gmail.com (Ben Bolker)
Date: Thu, 22 Nov 2012 22:38:15 +0000 (UTC)
Subject: [R-sig-ME]
	=?utf-8?q?Error_in_=2Elocal=28object=2C_n=2C_verbose?=
	=?utf-8?b?LAkuLi4pIDogVXBkYXRlIG5vdCB5ZXQgd3JpdHRlbg==?=
References: <000801cdc8f0$4939e690$dbadb3b0$@ul.pt>
Message-ID: <loom.20121122T233510-327@post.gmane.org>

joana martelo <jmmartelo at ...> writes:

> 
> Dear list
> 
> I'm trying to model fish data with a binomial distribution for prey capture
> success, using GLMM. My models look like  this:
> 
> Model1<-glmer(capture~velocity+(1|fish.id.),family=binomial,data=cap)
> 
> I'm using lme4, however, when I use the function mcmcsamp to obtain the
> posterior distribution of the parameters I got this error:
> 
> Error in .local(object, n, verbose, ...) : Update not yet written
> 
> I'm using R version 2.15.2. Anyone knows what the problem might be?
> 
> Many thanks in advance!
> 
> Joana

  mcmcsamp has never worked for GLMMs and at this point probably
never will, because writing a reliable post-hoc MCMC sampler (i.e.,
one that doesn't get stuck at low parameter valuables or have
other undesirable behaviour) has turned out to be really, really
hard.

  If you really want the posterior distribution of the parameters,
it should be pretty easy to fit your model using MCMCglmm.  If you
want confidence intervals it's unfortunately harder than it should
be, but you might try parametric bootstrapping ... (the pbkrtest
package has parametric bootstrapping, but it is designed for
parameter testing via model comparison rather than for finding
posterior/sampling distributions of parameters).

  Ben Bolker


From bbolker at gmail.com  Thu Nov 22 23:39:05 2012
From: bbolker at gmail.com (Ben Bolker)
Date: Thu, 22 Nov 2012 22:39:05 +0000 (UTC)
Subject: [R-sig-ME] False convergence lmer
References: <EF102B09CB7FCC43952890D497B467C9527B283F30@VMAILB.uoa.abdn.ac.uk>
Message-ID: <loom.20121122T180334-829@post.gmane.org>

Brickhill, Daisy <r01db11 at ...> writes:

> I am modelling how the movements of birds effects their reproductive
> success. I have 7 groups of nests which have differing mean brood
> sizes (e.g. group A: brood size 3.5, group B: brood size 3.0 etc). A
> bird dispersing from A to B therefore would lose 0.5 of a chick.What
> I want to know is if the difference in brood size gained (or lost)
> by movements varies with nest availability in 'better' areas
> (i.e. all those groups that have higher brood size than the group of
> origin). I have constructed a mixed model using lme4 with a gaussian
> distribution:

Brood size difference between origin and  destination ~
  number of better nests available +number of nests available in the group of
origin + 
   (1|group of origin) + (1|group of destination).


> However I get the warning message:
> Warning message:
> In mer_finalize(ans) : false convergence (8)
> Looking at the mailing list I have tried standardising the predictor
variables, I have tried dividing them
> by 100. 

 (Dividing by 100 seems useless: why?)

> The only thing that works on the model is removing either the random effect of
 group of origin or
> group of destination (removing the fixed effects still gives the error
message). I wondered if the
> problem is that the same combinations of groups of origin and destination
always have the same difference
> between them?

  Offhand, it shouldn't.

> The other thing that occured to me is that birds are quite likely to
> remain in their group of origin and for some groups this is as high
> as 67% - might that be a cause?  If it's not likely to be this can
> anyone give me any pointers as to what to look for, to work out what
> it is in my data that is causing this problem?

  It's really hard to say precisely (unfortunately).  You might try the
development version of lme4 to see if it helps.

  Remember that this is a warning and not an error.  Do the answers look
reasonable?  Are some of the random effects variances set to zero?

  This is incomplete but I'm sending it before I forget about it.

  Ben Bolker


From mariannestephan at hotmail.com  Fri Nov 23 09:27:12 2012
From: mariannestephan at hotmail.com (Marianne Anke)
Date: Fri, 23 Nov 2012 09:27:12 +0100
Subject: [R-sig-ME] How do I check whether the assumptions of equal
 variances and normality are fulfilled for ezANOVA() ?
In-Reply-To: <003c01cdc2ca$3f4a2ae0$bdde80a0$@net>
References: <DUB115-W19AA297B1609CA6BC8A5BBA9680@phx.gbl>,
	<000901cdbe97$b28ce650$17a6b2f0$@net>,
	<BLU162-W2F879F5F5F91F5B4ACCE4E6530@phx.gbl>
	<DUB115-W12092F8B1E97867FD55178EA9530@phx.gbl>,
	<003c01cdc2ca$3f4a2ae0$bdde80a0$@net>
Message-ID: <DUB115-W114F0EBD055D5860EDF1223A95A0@phx.gbl>

Ein eingebundener Text mit undefiniertem Zeichensatz wurde abgetrennt.
Name: nicht verf?gbar
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121123/5d8ccaf4/attachment.pl>

From larodwyer at gmail.com  Fri Nov 23 10:11:12 2012
From: larodwyer at gmail.com (Laurence O'Dwyer)
Date: Fri, 23 Nov 2012 10:11:12 +0100
Subject: [R-sig-ME] mixed effects models and multiple explanatory variables
	that are correlated
Message-ID: <CACp2W9Azk5iGSSvUs1zN+p3aDw46aqKNY=ACM6gMrosaBJCn4A@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121123/51c7d627/attachment.pl>

From larodwyer at gmail.com  Fri Nov 23 10:31:27 2012
From: larodwyer at gmail.com (Laurence O'Dwyer)
Date: Fri, 23 Nov 2012 10:31:27 +0100
Subject: [R-sig-ME] mixed effects models and multiple explanatory variables
	that are correlated
In-Reply-To: <CACp2W9Azk5iGSSvUs1zN+p3aDw46aqKNY=ACM6gMrosaBJCn4A@mail.gmail.com>
References: <CACp2W9Azk5iGSSvUs1zN+p3aDw46aqKNY=ACM6gMrosaBJCn4A@mail.gmail.com>
Message-ID: <CACp2W9DxZMG5frP3gRcXJ4svsMWSiYP=Ox2EM3kpAWc0t61XVA@mail.gmail.com>

Hello to mixed-effects model experts,

                                                       I am currently
trying to run an analysis on structural MRI data and would like to use
glmer or MCMCglmm to model my data. I have basic statistical knowledge and
would appreciate any guidance in the use of these R-tools from experts in
mixed effects models.

                In a crude way, I am interested in a model that might look
something like the following:



moo = MCMCglmm(autism_spectrum_scores ~ Diagnosis + Striatum + Thalamus +
Amygdala + Hippocampus,

                                          random = ~ADHD_symptom_scores

                                                    + age

                                                    + scanner_type

                                                    + gender

                                                    + total_brain_volume,

                                          data=dat)



It is a study of ADHD and autism. I have data for ~170 children with ADHD,
~70 unaffected siblings, and ~80 controls - this is the fixed factor
"Diagnosis".

I have the volumes of particular structures in the brain. These are the
fixed factors Striatum, Thalamus, etc. I am interested to know their
relationship with a scale of autistic traits (NOT ADHD traits) within all
experimental groups. For example, smaller volumes in the Striatum may be
associated with increased autistic traits.

For the random effects, I want to control for differences in ADHD symptoms,
age, scanner type (two different scanners were used to collect the
volumetric data), gender and total brain volume.

A key point of the analysis would be to establish the relationship between
structural volumes and autistic scores, when levels of ADHD have been
controlled for.

One problem is that all the structural volumes are closely correlated.
Previously, when working with two structural volumes that were correlated,
I used the regression residuals of one structural volume relative to the
other to isolate the unique contribution of each explanatory variable,
independent from what was shared between them. But, I don't think I can use
this approach with four structures that are highly correlated.

                There are probably many other statistical flies in the
ointment relating to the above. If anyone has any pointers as to how to
deal with the situation when multiple explanatory variables are correlated,
in a mixed-effects models framework, they would be appreciated.

                Thanks; Larry


From highstat at highstat.com  Fri Nov 23 12:13:54 2012
From: highstat at highstat.com (Highland Statistics Ltd)
Date: Fri, 23 Nov 2012 11:13:54 +0000
Subject: [R-sig-ME] mixed effects models and multiple explanatory
 variables	that, are correlated
In-Reply-To: <mailman.5.1353668402.15902.r-sig-mixed-models@r-project.org>
References: <mailman.5.1353668402.15902.r-sig-mixed-models@r-project.org>
Message-ID: <50AF5A72.30704@highstat.com>

On 23/11/2012 11:00, r-sig-mixed-models-request at r-project.org wrote:
> Send R-sig-mixed-models mailing list submissions to
> 	r-sig-mixed-models at r-project.org
>
> To subscribe or unsubscribe via the World Wide Web, visit
> 	https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> or, via email, send a message with subject or body 'help' to
> 	r-sig-mixed-models-request at r-project.org
>
> You can reach the person managing the list at
> 	r-sig-mixed-models-owner at r-project.org
>
> When replying, please edit your Subject line so it is more specific
> than "Re: Contents of R-sig-mixed-models digest..."
>
>
> Today's Topics:
>
>     1. mixed effects models and multiple explanatory variables	that
>        are correlated (Laurence O'Dwyer)
>     2. mixed effects models and multiple explanatory variables	that
>        are correlated (Laurence O'Dwyer)
>
>
> ----------------------------------------------------------------------
>
> Message: 1
> Date: Fri, 23 Nov 2012 10:11:12 +0100
> From: "Laurence O'Dwyer" <larodwyer at gmail.com>
> To: r-sig-mixed-models at r-project.org
> Subject: [R-sig-ME] mixed effects models and multiple explanatory
> 	variables	that are correlated
> Message-ID:
> 	<CACp2W9Azk5iGSSvUs1zN+p3aDw46aqKNY=ACM6gMrosaBJCn4A at mail.gmail.com>
> Content-Type: text/plain
>
> Hello to mixed-effects model experts,
>
>                                                         I am currently
> trying to run an analysis on structural MRI data and would like to use
> glmer or MCMCglmm to model my data. I have basic statistical knowledge and
> would appreciate any guidance in the use of these R-tools from experts in
> mixed effects models.
>
>                  In a crude way, I am interested in a model that might look
> something like the following:
>
>
>
> moo = MCMCglmm(autism_spectrum_scores ~ Diagnosis + Striatum + Thalamus +
> Amygdala + Hippocampus,
>
>                                            random = ~ADHD_symptom_scores
>
>                                                      + age
>
>                                                      + scanner_type
>
>                                                      + gender
>
>                                                      + total_brain_volume,
>
>                                            data=dat)
>
>


Are you using gender as random effect?

> It is a study of ADHD and autism. I have data for ~170 children with ADHD,
> ~70 unaffected siblings, and ~80 controls - this is the fixed factor
> "Diagnosis".
>
> I have the volumes of particular structures in the brain. These are the
> fixed factors Striatum, Thalamus, etc. I am interested to know their
> relationship with a scale of autistic traits (NOT ADHD traits) within all
> experimental groups. For example, smaller volumes in the Striatum may be
> associated with increased autistic traits.
>
> For the random effects, I want to control for differences in ADHD symptoms,
> age, scanner type (two different scanners were used to collect the
> volumetric data), gender and total brain volume.

Yes you do. That is not a good idea. You may want to read a little bit 
on mixed modelling before doing this. Your model is overly complicated 
for 170 observations. I actually wonder whether this is mixed effects 
modelling; do you have multiple observations per child? If not...then it 
seems ordinary linear regression?

> A key point of the analysis would be to establish the relationship between
> structural volumes and autistic scores, when levels of ADHD have been
> controlled for.
>
> One problem is that all the structural volumes are closely correlated.
> Previously, when working with two structural volumes that were correlated,
> I used the regression residuals of one structural volume relative to the
> other to isolate the unique contribution of each explanatory variable,
> independent from what was shared between them. But, I don't think I can use
> this approach with four structures that are highly correlated.
>
>                  There are probably many other statistical flies in the
> ointment relating to the above. If anyone has any pointers as to how to
> deal with the situation when multiple explanatory variables are correlated,

dump some of them...after making scatterplots, and calculate VIF values. 
Or use them, and accept that SEs will be blown up.

Kind regards,

Alain
> in a mixed-effects models framework, they would be appreciated.
>
>                  Thanks; Larry
>
> 	[[alternative HTML version deleted]]
>
>
>
> ------------------------------
>
> Message: 2
> Date: Fri, 23 Nov 2012 10:31:27 +0100
> From: "Laurence O'Dwyer" <larodwyer at gmail.com>
> To: r-sig-mixed-models at r-project.org
> Subject: [R-sig-ME] mixed effects models and multiple explanatory
> 	variables	that are correlated
> Message-ID:
> 	<CACp2W9DxZMG5frP3gRcXJ4svsMWSiYP=Ox2EM3kpAWc0t61XVA at mail.gmail.com>
> Content-Type: text/plain; charset=ISO-8859-1
>
> Hello to mixed-effects model experts,
>
>                                                         I am currently
> trying to run an analysis on structural MRI data and would like to use
> glmer or MCMCglmm to model my data. I have basic statistical knowledge and
> would appreciate any guidance in the use of these R-tools from experts in
> mixed effects models.
>
>                  In a crude way, I am interested in a model that might look
> something like the following:
>
>
>
> moo = MCMCglmm(autism_spectrum_scores ~ Diagnosis + Striatum + Thalamus +
> Amygdala + Hippocampus,
>
>                                            random = ~ADHD_symptom_scores
>
>                                                      + age
>
>                                                      + scanner_type
>
>                                                      + gender
>
>                                                      + total_brain_volume,
>
>                                            data=dat)
>
>
>
> It is a study of ADHD and autism. I have data for ~170 children with ADHD,
> ~70 unaffected siblings, and ~80 controls - this is the fixed factor
> "Diagnosis".
>
> I have the volumes of particular structures in the brain. These are the
> fixed factors Striatum, Thalamus, etc. I am interested to know their
> relationship with a scale of autistic traits (NOT ADHD traits) within all
> experimental groups. For example, smaller volumes in the Striatum may be
> associated with increased autistic traits.
>
> For the random effects, I want to control for differences in ADHD symptoms,
> age, scanner type (two different scanners were used to collect the
> volumetric data), gender and total brain volume.
>
> A key point of the analysis would be to establish the relationship between
> structural volumes and autistic scores, when levels of ADHD have been
> controlled for.
>
> One problem is that all the structural volumes are closely correlated.
> Previously, when working with two structural volumes that were correlated,
> I used the regression residuals of one structural volume relative to the
> other to isolate the unique contribution of each explanatory variable,
> independent from what was shared between them. But, I don't think I can use
> this approach with four structures that are highly correlated.
>
>                  There are probably many other statistical flies in the
> ointment relating to the above. If anyone has any pointers as to how to
> deal with the situation when multiple explanatory variables are correlated,
> in a mixed-effects models framework, they would be appreciated.
>
>                  Thanks; Larry
>
>
>
> ------------------------------
>
> _______________________________________________
> R-sig-mixed-models mailing list
> R-sig-mixed-models at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>
>
> End of R-sig-mixed-models Digest, Vol 71, Issue 33
> **************************************************
>


-- 

Dr. Alain F. Zuur
First author of:

1. Analysing Ecological Data (2007).
Zuur, AF, Ieno, EN and Smith, GM. Springer. 680 p.
URL: www.springer.com/0-387-45967-7


2. Mixed effects models and extensions in ecology with R. (2009).
Zuur, AF, Ieno, EN, Walker, N, Saveliev, AA, and Smith, GM. Springer.
http://www.springer.com/life+sci/ecology/book/978-0-387-87457-9


3. A Beginner's Guide to R (2009).
Zuur, AF, Ieno, EN, Meesters, EHWG. Springer
http://www.springer.com/statistics/computational/book/978-0-387-93836-3


4. Zero Inflated Models and Generalized Linear Mixed Models with R. (2012) Zuur, Saveliev, Ieno.
http://www.highstat.com/book4.htm

Other books: http://www.highstat.com/books.htm


Statistical consultancy, courses, data analysis and software
Highland Statistics Ltd.
6 Laverock road
UK - AB41 6FN Newburgh
Tel: 0044 1358 788177
Email: highstat at highstat.com
URL: www.highstat.com
URL: www.brodgar.com


From jmmartelo at fc.ul.pt  Fri Nov 23 12:58:16 2012
From: jmmartelo at fc.ul.pt (joana martelo)
Date: Fri, 23 Nov 2012 11:58:16 +0000
Subject: [R-sig-ME] Error in .local(object, n, verbose,
	...) : Update not yet written
In-Reply-To: <loom.20121122T233510-327@post.gmane.org>
References: <000801cdc8f0$4939e690$dbadb3b0$@ul.pt>
	<loom.20121122T233510-327@post.gmane.org>
Message-ID: <001a01cdc971$d381f7d0$7a85e770$@ul.pt>

Many thanks Ben! 

What I would like is to get the parameter estimates and confidence intervals
based both on the fixed and random effects, and not just on the fixed
effects. Is parametric bootstrapping the only alternative?

Thanks again!

Joana

-----Mensagem original-----
De: r-sig-mixed-models-bounces at r-project.org
[mailto:r-sig-mixed-models-bounces at r-project.org] Em nome de Ben Bolker
Enviada: quinta-feira, 22 de Novembro de 2012 22:38
Para: r-sig-mixed-models at r-project.org
Assunto: Re: [R-sig-ME] Error in .local(object, n, verbose, ...) : Update
not yet written

joana martelo <jmmartelo at ...> writes:

> 
> Dear list
> 
> I'm trying to model fish data with a binomial distribution for prey 
> capture success, using GLMM. My models look like  this:
> 
> Model1<-glmer(capture~velocity+(1|fish.id.),family=binomial,data=cap)
> 
> I'm using lme4, however, when I use the function mcmcsamp to obtain 
> the posterior distribution of the parameters I got this error:
> 
> Error in .local(object, n, verbose, ...) : Update not yet written
> 
> I'm using R version 2.15.2. Anyone knows what the problem might be?
> 
> Many thanks in advance!
> 
> Joana

  mcmcsamp has never worked for GLMMs and at this point probably never will,
because writing a reliable post-hoc MCMC sampler (i.e., one that doesn't get
stuck at low parameter valuables or have other undesirable behaviour) has
turned out to be really, really hard.

  If you really want the posterior distribution of the parameters, it should
be pretty easy to fit your model using MCMCglmm.  If you want confidence
intervals it's unfortunately harder than it should be, but you might try
parametric bootstrapping ... (the pbkrtest package has parametric
bootstrapping, but it is designed for parameter testing via model comparison
rather than for finding posterior/sampling distributions of parameters).

  Ben Bolker

_______________________________________________
R-sig-mixed-models at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models

-----
N?o foram detectados v?rus nesta  mensagem.
Verificado por AVG - www.avg.com
Vers?o: 2013.0.2793 / Base de dados de V?rus: 2629/5911 - Data de
Lan?amento: 11/22/12


From bbolker at gmail.com  Fri Nov 23 13:54:06 2012
From: bbolker at gmail.com (Ben Bolker)
Date: Fri, 23 Nov 2012 12:54:06 +0000 (UTC)
Subject: [R-sig-ME]
	=?utf-8?q?Error_in_=2Elocal=28object=2C_n=2C_verbose?=
	=?utf-8?b?LAkuLi4pIDogVXBkYXRlIG5vdCB5ZXQgd3JpdHRlbg==?=
References: <000801cdc8f0$4939e690$dbadb3b0$@ul.pt>
	<loom.20121122T233510-327@post.gmane.org>
	<001a01cdc971$d381f7d0$7a85e770$@ul.pt>
Message-ID: <loom.20121123T135123-522@post.gmane.org>

joana martelo <jmmartelo at ...> writes:

> 
> Many thanks Ben! 
> 
> What I would like is to get the parameter estimates and confidence intervals
> based both on the fixed and random effects, and not just on the fixed
> effects. Is parametric bootstrapping the only alternative?
> 
> Thanks again!
> 
> Joana

  Yes, unless you use Bayesian methods (MCMCglmm etc.), or
glmmADMB with MCMC sampling ('pseudo-Bayesian'), or you
manage to get your GLMMs working with profiling in the
development version of lme4 (experimental!)

  (As always I would be happy for enlightenment from other
list readers if they have any ideas!  Is there a straightforward
way to do this in SAS or AS-REML?)

[snip]
> 
>   mcmcsamp has never worked for GLMMs and at this point probably never will,
> because writing a reliable post-hoc MCMC sampler (i.e., one that doesn't get
> stuck at low parameter valuables or have other undesirable behaviour) has
> turned out to be really, really hard.
> 
>   If you really want the posterior distribution of the parameters, it should
> be pretty easy to fit your model using MCMCglmm.  If you want confidence
> intervals it's unfortunately harder than it should be, but you might try
> parametric bootstrapping ... (the pbkrtest package has parametric
> bootstrapping, but it is designed for parameter testing via model comparison
> rather than for finding posterior/sampling distributions of parameters).
> 
>   Ben Bolker


From seth at swbigelow.net  Fri Nov 23 14:08:24 2012
From: seth at swbigelow.net (Seth W. Bigelow)
Date: Fri, 23 Nov 2012 08:08:24 -0500
Subject: [R-sig-ME] Mixed models and learning curves
In-Reply-To: <CCA5FE0A67FDC344BFEEC356BCD8C067AA5A9D67@exdb1.ad.skogoglandskap.no>
References: <CCA5FE0A67FDC344BFEEC356BCD8C067AA5A9D67@exdb1.ad.skogoglandskap.no>
Message-ID: <001801cdc97b$a042dfb0$e0c89f10$@net>

Giovanna:

your description suggests your dataset consists of 30 observations (5
students X 6 replications), but the degrees of freedom in your model output,
> 100, would seem to indicate that you are incorporating individual log
cycle times in your analysis...

As Douglas Bates said, with 1-2 students per 'previous experience' class, it
may be difficult to make a mixed-effects model. You may want to consider
doing a simple linear regression on each student (sum of logs' cycle time
vs. replication, and compare the confidence intervals around the slopes of
individual students' performance to make some inference about the effects of
previous experience. 

In theory, you could try fitting non-linear models to individual students'
performance to see if there was, e.g., exponential learning curve happening.
But with 6 replications you would probably be unable to demonstrate that a
non-linear model is an improvement over a linear one (e.g., with AIC).

Since you have recorded yarding times for individual logs, you may also want
to consider comparing the within-replication variance among students. I
would expect that variance would be much smaller for the trainer than for
the students with little previous experience (I can't advise on how to do
this, however).

Finally, are you using R graphics capability (lattice, ggplot2) to view your
data? For example:
Library(lattice)
xyplot(prod.time~Trial, data=YardingData, groups=Student, auto.key=TRUE)

Best,

Seth W. Bigelow, Ph.D.
Forest Ecologist
Landgrove VT USA

-----Original Message-----
From: r-sig-mixed-models-bounces at r-project.org
[mailto:r-sig-mixed-models-bounces at r-project.org] On Behalf Of Giovanna
Ottaviani
Sent: Thursday, November 22, 2012 2:55 PM
To: r-sig-mixed-models at r-project.org
Subject: [R-sig-ME] Mixed models and learning curves

My name is Giovanna and I am a PhD student in Norway.

I am a beginner with statistics and R,  hence my ignorance. Apologies from
now.....



I have been collecting data on time performances of 5 subjects using a 1:3
scale tower yarder. The task was consisting in yarding 5 small logs placed
on permanently marked course. Four subjects had different previous
experiences (None, Some) and the fifth was a trainer (Control).

Each cycle time per each log was registered, the sum of the 5 logs' cycle
time was giving the replication time. We had 6 replication per subject .

I would like to predict the time necessary to perform the task.



I have been modelling the time to perform the task (prod.time)versus the
replication number (Trial-in the dataset), the previous experience (factor)
and their interaction. As random effect I have been using the subjects.







> ma<-lme(prod.time~Trial+Previous.experience+Trial*Previous.experience,
data=  Data27_04, random=~1|Student, method="ML")

> summary(ma)

Linear mixed-effects model fit by maximum likelihood

Data: Data27_04

       AIC      BIC    logLik

  1517.445 1541.259 -750.7226



Random effects:

Formula: ~1 | Student

        (Intercept) Residual

StdDev:    7.337648 42.42332



Fixed effects: prod.time ~ Trial + Previous.experience + Trial *
Previous.experience

                               Value Std.Error  DF   t-value p-value

(Intercept)                102.44173  9.561987 137 10.713435  0.0000

Trial                       -6.48494  2.252271 137 -2.879291  0.0046

Previous.experience1       -37.36173 14.786033   2 -2.526826  0.1274

Previous.experience2        47.22627 12.451072   2  3.792948  0.0630

Trial:Previous.experience1   6.55351  3.496401 137  1.874360  0.0630

Trial:Previous.experience2  -7.55163  2.940879 137 -2.567813  0.0113

Correlation:

                           (Intr) Trial  Prvs.1 Prvs.2 Tr:P.1

Trial                      -0.841

Previous.experience1        0.253 -0.208

Previous.experience2       -0.234  0.199 -0.540

Trial:Previous.experience1 -0.207  0.264 -0.835  0.447

Trial:Previous.experience2  0.199 -0.226  0.447 -0.836 -0.550



Standardized Within-Group Residuals:

       Min         Q1        Med         Q3        Max

-2.3519731 -0.6903211 -0.1031114  0.6503216  4.6699702



Number of Observations: 145

Number of Groups: 5

>



Do you think this is good enough to demonstrate a learning effect.

Learning curves are exponential. I have been trying to log transform the
response variable but then p-values are saying that previous experience has
no significance.



>  mb<-lme(log.prodtime~Trial+Previous.experience+Trial*Previous.experience,
data=  Data27_04, random=~1|Student, method="ML")

> summary(mb)

Linear mixed-effects model fit by maximum likelihood

Data: Data27_04

       AIC      BIC    logLik

  225.1042 248.9181 -104.5521



Random effects:

Formula: ~1 | Student

        (Intercept) Residual

StdDev:  0.04484554 0.495812



Fixed effects: log.prodtime ~ Trial + Previous.experience + Trial *
Previous.experience

                               Value  Std.Error  DF  t-value p-value

(Intercept)                 4.448206 0.10593072 137 41.99165  0.0000

Trial                      -0.060150 0.02629765 137 -2.28726  0.0237

Previous.experience1       -0.333664 0.16351518   2 -2.04057  0.1781

Previous.experience2        0.368358 0.13776525   2  2.67381  0.1160

Trial:Previous.experience1  0.051714 0.04084708 137  1.26604  0.2076

Trial:Previous.experience2 -0.043036 0.03435150 137 -1.25282  0.2124

Correlation:

                           (Intr) Trial  Prvs.1 Prvs.2 Tr:P.1

Trial                      -0.886

Previous.experience1        0.248 -0.221

Previous.experience2       -0.237  0.209 -0.535

Trial:Previous.experience1 -0.220  0.266 -0.881  0.473

Trial:Previous.experience2  0.208 -0.225  0.474 -0.883 -0.551



Standardized Within-Group Residuals:

       Min         Q1        Med         Q3        Max

-2.7119095 -0.8005032  0.1127388  0.8621127  2.1988560



Number of Observations: 145

Number of Groups: 5

>



The model is surely better (AIC, BIC) also the residuals are looking better
but then should I reduce the model leaving only the Trial number?



How would you present the results in a clear way? I am still struggling to
figure it out. The concept of mixed models is clear in my head but it is
hard to present it.



How should I then plot the learning curve?

I have been plotting the data I have adding a smooth line. Is this good
enough?



Looking forward for your response

Best regards

Giovanna


Giovanna Ottaviani Aalmo
Stipendiat/Ph..D. Student
-------------------------------------------
Norsk institutt for skog og landskap
Pb 115, NO-1431 Es
T (+47) 64 94 9094
M(+47) 980 30 422
F(+47) 64 94  90 80
-------------------------------------------
www.skogoglandskap.no<http://www.skogoglandskap.no/>
-------------------------------------------


	[[alternative HTML version deleted]]


From joanamartelo at gmail.com  Thu Nov 22 21:21:15 2012
From: joanamartelo at gmail.com (Joana Martelo)
Date: Thu, 22 Nov 2012 20:21:15 -0000
Subject: [R-sig-ME] Error in .local(object, n, verbose,
	...) : Update not yet written
Message-ID: <000301cdc8ee$ee3980d0$caac8270$@com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121122/7f828073/attachment.pl>

From Ellen.Pape at ugent.be  Fri Nov 23 09:05:15 2012
From: Ellen.Pape at ugent.be (Ellen Pape)
Date: Fri, 23 Nov 2012 09:05:15 +0100
Subject: [R-sig-ME] assumptions of linear mixed models
Message-ID: <50AF2E3B.90309@ugent.be>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121123/f01f9a7e/attachment.pl>

From jeffrey_warren at fws.gov  Fri Nov 23 18:29:24 2012
From: jeffrey_warren at fws.gov (Jeffrey Warren)
Date: Fri, 23 Nov 2012 10:29:24 -0700
Subject: [R-sig-ME] Multinomial mixed-effect model in nnet
Message-ID: <96441a71513ea1a10450071049ae0f53@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121123/e2fbb978/attachment.pl>

From ibanerji at umail.iu.edu  Fri Nov 23 19:09:11 2012
From: ibanerji at umail.iu.edu (Ishani Banerji)
Date: Fri, 23 Nov 2012 13:09:11 -0500
Subject: [R-sig-ME] Getting the predicted fitted mean values for fixed
 effects from an lmer model
Message-ID: <CAJyJM8tY7N5Y3xCEoD7Z3LNeDaOreEe31bCVoevAhL8nDeFDrw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121123/f24241c3/attachment.pl>

From bbolker at gmail.com  Fri Nov 23 20:53:27 2012
From: bbolker at gmail.com (Ben Bolker)
Date: Fri, 23 Nov 2012 19:53:27 +0000 (UTC)
Subject: [R-sig-ME] Getting the predicted fitted mean values for fixed
	effects from an lmer model
References: <CAJyJM8tY7N5Y3xCEoD7Z3LNeDaOreEe31bCVoevAhL8nDeFDrw@mail.gmail.com>
Message-ID: <loom.20121123T205122-759@post.gmane.org>

Ishani Banerji <ibanerji at ...> writes:

> 
> Hi,
> 
> I am working on my dissertation currently, and have been using the lme4
> package to analyze the data. I have been able to use the lmer command to
> generate models just fine, but have been unable to find a way to get the
> predicted mean values for the fixed effects.

  [snip]

> So how do I go about getting the predicted means and standard deviations
> for the various effects? I am interested in the means for the "main
> effects" of each of the fixed variables, as well as the higher order
> interactions.
> 
> I have tried every method that I came across online (including using
> packages like MixMod, the plotLMER.fnc, etc.) but nothing seems to give me
> what I need.

  (1) For the predicted values: either (a) use the code posted
at http://glmm.wikidot.com/faq , or (b) use the predict() function
in the development version of lme4.  (2) For the standard deviations:
see 1(a).  (1b doesn't work because the solution in 1a only accounts
for error in the fixed effects ... see various other discussion
on this mailing list and the FAQ site.)


From jeffrey.warren.mt at gmail.com  Fri Nov 23 20:41:25 2012
From: jeffrey.warren.mt at gmail.com (Jeff Warren)
Date: Fri, 23 Nov 2012 12:41:25 -0700
Subject: [R-sig-ME] Multinomial mixed-effect model in nnet
Message-ID: <CAP-fkE4FJ3kTi_P+7iHiAmf53iihQJshB0CCOROoQjhdte7DEA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121123/b2939953/attachment.pl>

From willb2306 at hotmail.com  Mon Nov 26 01:05:37 2012
From: willb2306 at hotmail.com (William Butler)
Date: Mon, 26 Nov 2012 00:05:37 +0000
Subject: [R-sig-ME] Problem fitting multiple smoothers with gamm
Message-ID: <DUB102-W56A7D553DEFD719D4D3D71B45F0@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121126/d1dd3619/attachment.pl>

From larodwyer at gmail.com  Mon Nov 26 12:58:48 2012
From: larodwyer at gmail.com (Laurence O'Dwyer)
Date: Mon, 26 Nov 2012 12:58:48 +0100
Subject: [R-sig-ME] R-sig-mixed-models Digest, Vol 71, Issue 34
In-Reply-To: <mailman.7835.1353676125.4555.r-sig-mixed-models@r-project.org>
References: <mailman.7835.1353676125.4555.r-sig-mixed-models@r-project.org>
Message-ID: <CACp2W9AK=7q6c7POyNueW6PqGtz2HjFJNYpuhayCR_TDE0_rZw@mail.gmail.com>

Hi Alain,
             Thank you for the reply. As a follow-up, I have a
question or two relating to your pointers and suggestions.

>>
>> Hello to mixed-effects model experts,
>>
>>                                                         I am currently
>> trying to run an analysis on structural MRI data and would like to use
>> glmer or MCMCglmm to model my data. I have basic statistical knowledge and
>> would appreciate any guidance in the use of these R-tools from experts in
>> mixed effects models.
>>
>>                  In a crude way, I am interested in a model that might look
>> something like the following:
>>
>>
>>
>> moo = MCMCglmm(autism_spectrum_scores ~ Diagnosis + Striatum + Thalamus +
>> Amygdala + Hippocampus,
>>
>>                                            random = ~ADHD_symptom_scores
>>
>>                                                      + age
>>
>>                                                      + scanner_type
>>
>>                                                      + gender
>>
>>                                                      + total_brain_volume,
>>
>>                                            data=dat)
>>
>>
>
>
> Are you using gender as random effect?
>

Yes, I am using gender as a random variable, as there are differences
(although non-significant) in the ratio of Males:Females in each
experimental group.

>> It is a study of ADHD and autism. I have data for ~170 children with ADHD,
>> ~70 unaffected siblings, and ~80 controls - this is the fixed factor
>> "Diagnosis".
>>
>> I have the volumes of particular structures in the brain. These are the
>> fixed factors Striatum, Thalamus, etc. I am interested to know their
>> relationship with a scale of autistic traits (NOT ADHD traits) within all
>> experimental groups. For example, smaller volumes in the Striatum may be
>> associated with increased autistic traits.
>>
>> For the random effects, I want to control for differences in ADHD symptoms,
>> age, scanner type (two different scanners were used to collect the
>> volumetric data), gender and total brain volume.
>
> Yes you do. That is not a good idea. You may want to read a little bit
> on mixed modelling before doing this. Your model is overly complicated
> for 170 observations. I actually wonder whether this is mixed effects
> modelling; do you have multiple observations per child? If not...then it
> seems ordinary linear regression?


Sorry, I am not clear here on what you are referring to as "not a good idea"?
Each child underwent scanning. There are multiple observations (MRI
volumetrics,
as well as symptom counts from diagnostic questionnaires), for all children.
I felt mixed-effects models would be most effective and robust in this situation
as I am interested to know how the fixed effects influence the
response variable,
while controlling for a range of random effects that influence the
variance of the response.
This analysis also ties in with earlier work assessing the relationship between
autism scores and total brain white matter volume and total brain grey
matter volume,
for which mixed-effects models were quite informative. MCMC was used,
as the explanatory
variables are not normally distributed.


As suggested, I simplified the model and looked at the VIFs. I now
have 3 Fixed Effects with GVIFs:
Striatum    1.507092
Amygdala    1.281519
Hippocampus 1.557735


So, I would like to know if the resulting model could be considered
statistically sound, or if there are still gaping
holes in its statistical credibility:

try.5 = MCMCglmm(ASD_spectrum_VISK ~ Diagnosis_Simple + Striatum +
Amygdala + Hippocampus,
                                          random =
~Combined_Symptoms_inatt_plus_hyper
                                                    + age
                                                    + scanner_binary
                                                    + Gender
                                                    + TBV,
                                          data=dat)


This leads to a result that can be reasonably well interpreted
biologically and which is in line with
the study hypothesis: ADHD diagnosis has significant effect on the
autism score, and Striatal volume (p=0.078)
has a borderline significant effect on autism score.

I am particularly keen to know if my attempts to control for ADHD
symptoms, as well as age, scanner type, etc., are adequately
dealt with in the random effects section, or whether or not I need to
look into the specification of a prior which is noted in some of the
MCMCglmm documentation.

Any advice is greatly appreciated.

With thanks; Larry


>> A key point of the analysis would be to establish the relationship between
>> structural volumes and autistic scores, when levels of ADHD have been
>> controlled for.
>>
>> One problem is that all the structural volumes are closely correlated.
>> Previously, when working with two structural volumes that were correlated,
>> I used the regression residuals of one structural volume relative to the
>> other to isolate the unique contribution of each explanatory variable,
>> independent from what was shared between them. But, I don't think I can use
>> this approach with four structures that are highly correlated.
>>
>>                  There are probably many other statistical flies in the
>> ointment relating to the above. If anyone has any pointers as to how to
>> deal with the situation when multiple explanatory variables are correlated,
>
> dump some of them...after making scatterplots, and calculate VIF values.
> Or use them, and accept that SEs will be blown up.
>
> Kind regards,
>
> Alain
>> in a mixed-effects models framework, they would be appreciated.
>>
>>                  Thanks; Larry
>>


From aghaynes at gmail.com  Mon Nov 26 13:47:32 2012
From: aghaynes at gmail.com (Alan Haynes)
Date: Mon, 26 Nov 2012 13:47:32 +0100
Subject: [R-sig-ME] R-sig-mixed-models Digest, Vol 71, Issue 34
In-Reply-To: <CACp2W9AK=7q6c7POyNueW6PqGtz2HjFJNYpuhayCR_TDE0_rZw@mail.gmail.com>
References: <mailman.7835.1353676125.4555.r-sig-mixed-models@r-project.org>
	<CACp2W9AK=7q6c7POyNueW6PqGtz2HjFJNYpuhayCR_TDE0_rZw@mail.gmail.com>
Message-ID: <CAPdSD+6qygk1BnP9AfTtYBCTijU+OatN7d+bz2HQsQtR9cM2oQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121126/4995708d/attachment.pl>

From bbolker at gmail.com  Mon Nov 26 14:53:36 2012
From: bbolker at gmail.com (Ben Bolker)
Date: Mon, 26 Nov 2012 13:53:36 +0000 (UTC)
Subject: [R-sig-ME] R-sig-mixed-models Digest, Vol 71, Issue 34
References: <mailman.7835.1353676125.4555.r-sig-mixed-models@r-project.org>
	<CACp2W9AK=7q6c7POyNueW6PqGtz2HjFJNYpuhayCR_TDE0_rZw@mail.gmail.com>
	<CAPdSD+6qygk1BnP9AfTtYBCTijU+OatN7d+bz2HQsQtR9cM2oQ@mail.gmail.com>
Message-ID: <loom.20121126T145231-161@post.gmane.org>

Alan Haynes <aghaynes at ...> writes:

> 
> I think that part of what Alain was getting at was that random effects
> require quite a few levels to calculate the variance, so RE such as age are
> generally not recommended - you get a bad estimate of the variance from 2
> points.
> 
> I think he's also suggesting that with only 170 data points, the likelihood
> of overfitting is quite high when you have so many variables in your
> models. If you made a factor with one level for each combination of your
> random effects, how many datapoints would fall into each category? Ive
> heard it suggested that fewer than 10 and you'll probably start running
> into difficulty...dont remember where from though I'm afraid...

  Frank Harrell's _Regression Modeling Strategies_ book has an extensive
discussion of "how much data is enough" -- not in the specific context
of mixed models, but very clear.

  Ben


From larodwyer at gmail.com  Mon Nov 26 17:07:23 2012
From: larodwyer at gmail.com (Laurence O'Dwyer)
Date: Mon, 26 Nov 2012 17:07:23 +0100
Subject: [R-sig-ME] R-sig-mixed-models Digest, Vol 71, Issue 34
In-Reply-To: <CAPdSD+6qygk1BnP9AfTtYBCTijU+OatN7d+bz2HQsQtR9cM2oQ@mail.gmail.com>
References: <mailman.7835.1353676125.4555.r-sig-mixed-models@r-project.org>
	<CACp2W9AK=7q6c7POyNueW6PqGtz2HjFJNYpuhayCR_TDE0_rZw@mail.gmail.com>
	<CAPdSD+6qygk1BnP9AfTtYBCTijU+OatN7d+bz2HQsQtR9cM2oQ@mail.gmail.com>
Message-ID: <CACp2W9ARG5O5cQ+qJjr5iNVSdse0jDS8Yyb0K3666x8Rs0t42A@mail.gmail.com>

Hi Alan and Alain,
                          I see that you might want to have >10 subjects within
each level of a factor that is constructed by making one level for
each combination
of the random effects.
However, I have 3 REs that are continuous variables:
age, ADHD_symptom_scores, TBV[Total_Brain_Volume].
So, in that situation, I'm not sure how to calculate what you suggest
unless I transform them into categorical variables, e.g.:
dat$age_5_levels = cut(dat$age, 5)
In that situation I would most likely have <10 subjects in some
of the levels of a factor that is constructed by making levels from
each combination of the REs.

Age and gender, are not significantly different between experimental groups
in this dataset, so I experimented with excluding them from the REs.
I very much wanted to control for ADHD symptoms in the REs, as this
was the whole idea of the model; i.e. to try to isolate autistic traits
within ADHD subjects, and determine to what extent these traits
are influenced by particular anatomical structures when the ADHD
symptom levels are controlled for in the REs.

So, trying to eliminate unnecessary REs (age and gender), the model is:

another.moo = MCMCglmm(autism_spectrum_scores ~ Diagnosis + Striatum +
Amygdala + Hippocampus,
                                          random = ~ADHD_symptom_scores
                                                    + scanner_binary
                                                    + TBV,
                                          data=dat)

I would like to keep total brain volume (TBV: a continuous variable),
and scanner type (scanner_binary: 0 or 1, for two different scanner
types) as REs.
These variables are significantly different between experimental groups.

For the above model, again, I'd be grateful for any pointers regarding how to
assess or improve it's validity.
Apologies for the necessary hand holding.

Thanks; Larry


On Mon, Nov 26, 2012 at 1:47 PM, Alan Haynes <aghaynes at gmail.com> wrote:
> I think that part of what Alain was getting at was that random effects
> require quite a few levels to calculate the variance, so RE such as age are
> generally not recommended - you get a bad estimate of the variance from 2
> points.
>
> I think he's also suggesting that with only 170 data points, the likelihood
> of overfitting is quite high when you have so many variables in your models.
> If you made a factor with one level for each combination of your random
> effects, how many datapoints would fall into each category? Ive heard it
> suggested that fewer than 10 and you'll probably start running into
> difficulty...dont remember where from though I'm afraid...
>
> HTH
>
> Alan
>
> --------------------------------------------------
> Email: aghaynes at gmail.com
> Mobile: +41794385586
> Skype: aghaynes
>
>
> On 26 November 2012 12:58, Laurence O'Dwyer <larodwyer at gmail.com> wrote:
>>
>> Hi Alain,
>>              Thank you for the reply. As a follow-up, I have a
>> question or two relating to your pointers and suggestions.
>>
>> >>
>> >> Hello to mixed-effects model experts,
>> >>
>> >>                                                         I am currently
>> >> trying to run an analysis on structural MRI data and would like to use
>> >> glmer or MCMCglmm to model my data. I have basic statistical knowledge
>> >> and
>> >> would appreciate any guidance in the use of these R-tools from experts
>> >> in
>> >> mixed effects models.
>> >>
>> >>                  In a crude way, I am interested in a model that might
>> >> look
>> >> something like the following:
>> >>
>> >>
>> >>
>> >> moo = MCMCglmm(autism_spectrum_scores ~ Diagnosis + Striatum + Thalamus
>> >> +
>> >> Amygdala + Hippocampus,
>> >>
>> >>                                            random =
>> >> ~ADHD_symptom_scores
>> >>
>> >>                                                      + age
>> >>
>> >>                                                      + scanner_type
>> >>
>> >>                                                      + gender
>> >>
>> >>                                                      +
>> >> total_brain_volume,
>> >>
>> >>                                            data=dat)
>> >>
>> >>
>> >
>> >
>> > Are you using gender as random effect?
>> >
>>
>> Yes, I am using gender as a random variable, as there are differences
>> (although non-significant) in the ratio of Males:Females in each
>> experimental group.
>>
>> >> It is a study of ADHD and autism. I have data for ~170 children with
>> >> ADHD,
>> >> ~70 unaffected siblings, and ~80 controls - this is the fixed factor
>> >> "Diagnosis".
>> >>
>> >> I have the volumes of particular structures in the brain. These are the
>> >> fixed factors Striatum, Thalamus, etc. I am interested to know their
>> >> relationship with a scale of autistic traits (NOT ADHD traits) within
>> >> all
>> >> experimental groups. For example, smaller volumes in the Striatum may
>> >> be
>> >> associated with increased autistic traits.
>> >>
>> >> For the random effects, I want to control for differences in ADHD
>> >> symptoms,
>> >> age, scanner type (two different scanners were used to collect the
>> >> volumetric data), gender and total brain volume.
>> >
>> > Yes you do. That is not a good idea. You may want to read a little bit
>> > on mixed modelling before doing this. Your model is overly complicated
>> > for 170 observations. I actually wonder whether this is mixed effects
>> > modelling; do you have multiple observations per child? If not...then it
>> > seems ordinary linear regression?
>>
>>
>> Sorry, I am not clear here on what you are referring to as "not a good
>> idea"?
>> Each child underwent scanning. There are multiple observations (MRI
>> volumetrics,
>> as well as symptom counts from diagnostic questionnaires), for all
>> children.
>> I felt mixed-effects models would be most effective and robust in this
>> situation
>> as I am interested to know how the fixed effects influence the
>> response variable,
>> while controlling for a range of random effects that influence the
>> variance of the response.
>> This analysis also ties in with earlier work assessing the relationship
>> between
>> autism scores and total brain white matter volume and total brain grey
>> matter volume,
>> for which mixed-effects models were quite informative. MCMC was used,
>> as the explanatory
>> variables are not normally distributed.
>>
>>
>> As suggested, I simplified the model and looked at the VIFs. I now
>> have 3 Fixed Effects with GVIFs:
>> Striatum    1.507092
>> Amygdala    1.281519
>> Hippocampus 1.557735
>>
>>
>> So, I would like to know if the resulting model could be considered
>> statistically sound, or if there are still gaping
>> holes in its statistical credibility:
>>
>> try.5 = MCMCglmm(ASD_spectrum_VISK ~ Diagnosis_Simple + Striatum +
>> Amygdala + Hippocampus,
>>                                           random =
>> ~Combined_Symptoms_inatt_plus_hyper
>>                                                     + age
>>                                                     + scanner_binary
>>                                                     + Gender
>>                                                     + TBV,
>>                                           data=dat)
>>
>>
>> This leads to a result that can be reasonably well interpreted
>> biologically and which is in line with
>> the study hypothesis: ADHD diagnosis has significant effect on the
>> autism score, and Striatal volume (p=0.078)
>> has a borderline significant effect on autism score.
>>
>> I am particularly keen to know if my attempts to control for ADHD
>> symptoms, as well as age, scanner type, etc., are adequately
>> dealt with in the random effects section, or whether or not I need to
>> look into the specification of a prior which is noted in some of the
>> MCMCglmm documentation.
>>
>> Any advice is greatly appreciated.
>>
>> With thanks; Larry
>>
>>
>> >> A key point of the analysis would be to establish the relationship
>> >> between
>> >> structural volumes and autistic scores, when levels of ADHD have been
>> >> controlled for.
>> >>
>> >> One problem is that all the structural volumes are closely correlated.
>> >> Previously, when working with two structural volumes that were
>> >> correlated,
>> >> I used the regression residuals of one structural volume relative to
>> >> the
>> >> other to isolate the unique contribution of each explanatory variable,
>> >> independent from what was shared between them. But, I don't think I can
>> >> use
>> >> this approach with four structures that are highly correlated.
>> >>
>> >>                  There are probably many other statistical flies in the
>> >> ointment relating to the above. If anyone has any pointers as to how to
>> >> deal with the situation when multiple explanatory variables are
>> >> correlated,
>> >
>> > dump some of them...after making scatterplots, and calculate VIF values.
>> > Or use them, and accept that SEs will be blown up.
>> >
>> > Kind regards,
>> >
>> > Alain
>> >> in a mixed-effects models framework, they would be appreciated.
>> >>
>> >>                  Thanks; Larry
>> >>
>>
>> _______________________________________________
>> R-sig-mixed-models at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>
>


From highstat at highstat.com  Mon Nov 26 19:23:35 2012
From: highstat at highstat.com (Highland Statistics Ltd)
Date: Mon, 26 Nov 2012 19:23:35 +0100
Subject: [R-sig-ME] Problem fitting multiple smoothers with gamm
	(William Butler)
In-Reply-To: <mailman.5.1353927602.8489.r-sig-mixed-models@r-project.org>
References: <mailman.5.1353927602.8489.r-sig-mixed-models@r-project.org>
Message-ID: <50B3B3A7.9070406@highstat.com>

On 26/11/2012 12:00, r-sig-mixed-models-request at r-project.org wrote:
> Send R-sig-mixed-models mailing list submissions to
> 	r-sig-mixed-models at r-project.org
>
> To subscribe or unsubscribe via the World Wide Web, visit
> 	https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> or, via email, send a message with subject or body 'help' to
> 	r-sig-mixed-models-request at r-project.org
>
> You can reach the person managing the list at
> 	r-sig-mixed-models-owner at r-project.org
>
> When replying, please edit your Subject line so it is more specific
> than "Re: Contents of R-sig-mixed-models digest..."
>
>
> Today's Topics:
>
>     1. Problem fitting multiple smoothers with gamm (William Butler)
>
>
> ----------------------------------------------------------------------
>
> Message: 1
> Date: Mon, 26 Nov 2012 00:05:37 +0000
> From: William Butler <willb2306 at hotmail.com>
> To: <r-sig-mixed-models at r-project.org>
> Subject: [R-sig-ME] Problem fitting multiple smoothers with gamm
> Message-ID: <DUB102-W56A7D553DEFD719D4D3D71B45F0 at phx.gbl>
> Content-Type: text/plain
>
>
> Hi all,
>
>
> I'm analyzing egg density data for three species and I'm having some problems fitting multiple smooths with gamm. Here's what I?ve got:
>
>
> Three species (sp1, sp2, sp3)Differing number of females for each species (random effect, nested within species). 14, 9, 10 females for sp1, sp2, sp3 respectively.For each female, multiple measurements (between 20-100) of density on different days post fertilisation (DPF). Note, sp1 only has measurements for 4 females on day 9 as the rest hatched.
>
> Measurements were made on DPF 1,3,6,9 for sp1. DPF 1,3,6,9,12 for sp2. DPF 2,5,7,10,13 for sp3.
>
>
> I want to use GAMs to look at changes in density during the egg phase. I've done some linear mixed effects modeling with lme4, but some of the changes over time aren't linear and I want to try additive mixed effects models to see if it suits the data better.
>
>
> I started with each species separately and it worked fine. Then I tried to add in the species effect as follows:
> mod1 <- gamm(Density~f.species + s(DPF, by=f.species), random=list(female=~1), data=egg.data)
>
>
> The problem is this fits a smooths to day thirteen for all species and as they hatch at different times I want a smooth for each species till the hatch date.
>
>
> So I tried:
> mod2 <- gamm(Density~f.species + s(DPF, by=as.numeric(f.species=="sp1")) +
> s(DPF, by=as.numeric(f.species=="sp2")) +
> s(DPF, by=as.numeric(f.species=="sp3")),
> random=list(female=~1), data=egg.data)
>
>
> And I get the following error:
> Error in MEestimate(lmeSt, grps) : Singularity in backsolve at level 0, block 1
>
>
>
> I'm pretty new to GAMs and really don't understand this error, can anyone help with this?

Will...you need to remove the f.species as a main term. Smoothers with 
obtained with the above construction are not centered around zero.


> And does anyone have suggestions for fitting smooths till the hatch date for each species, all within the same model?

Yeap....fit a smoother as a mixed model...manually using MCMC. That for 
sure will do the trick. Having written these two sentences....that may 
not be the first thing you want to hear. I am not sure whether mgcv can 
use different ranges of the splines. If you go the MCMC route....there 
are lots of clear papers available, with dowloadable R code, that show 
you how to do it. Rupert et al. (2003) is the starting point.


>   Is it possible to have the smooths nested within species?

Not sure I understand this. Neither do I understand why you use 'female' 
as random effect...unless it refers to birds??

There's a book coming out in 2 weeks: A Beginner's Guide to Generalized 
Additive Models. Zuur AF. (2012). It answers some of your questions.

Alain
>   I've looked around the web but couldn't find much info (and didn't understand what I did!).
>
>
> Any help is appreciated.
>
>
> Kind regards
>
>
> Will
>
>
>
>
>   		 	   		
> 	[[alternative HTML version deleted]]
>
>
>
> ------------------------------
>
> _______________________________________________
> R-sig-mixed-models mailing list
> R-sig-mixed-models at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>
>
> End of R-sig-mixed-models Digest, Vol 71, Issue 36
> **************************************************
>


-- 

Dr. Alain F. Zuur
First author of:

1. Analysing Ecological Data (2007).
Zuur, AF, Ieno, EN and Smith, GM. Springer. 680 p.
URL: www.springer.com/0-387-45967-7


2. Mixed effects models and extensions in ecology with R. (2009).
Zuur, AF, Ieno, EN, Walker, N, Saveliev, AA, and Smith, GM. Springer.
http://www.springer.com/life+sci/ecology/book/978-0-387-87457-9


3. A Beginner's Guide to R (2009).
Zuur, AF, Ieno, EN, Meesters, EHWG. Springer
http://www.springer.com/statistics/computational/book/978-0-387-93836-3


4. Zero Inflated Models and Generalized Linear Mixed Models with R. (2012) Zuur, Saveliev, Ieno.
http://www.highstat.com/book4.htm

Other books: http://www.highstat.com/books.htm


Statistical consultancy, courses, data analysis and software
Highland Statistics Ltd.
6 Laverock road
UK - AB41 6FN Newburgh
Tel: 0044 1358 788177
Email: highstat at highstat.com
URL: www.highstat.com
URL: www.brodgar.com


From larodwyer at gmail.com  Tue Nov 27 09:00:09 2012
From: larodwyer at gmail.com (Laurence O'Dwyer)
Date: Tue, 27 Nov 2012 09:00:09 +0100
Subject: [R-sig-ME] Fwd: mixed effects models and multiple explanatory
	variables that are correlated
Message-ID: <CACp2W9DWBH0EeRz4G=toOmLfJvydLWAAO12Lj+ignrFV2t7SEA@mail.gmail.com>

Hi Alan and Alain,
                          I see that you might want to have >10 subjects within
each level of a factor that is constructed by making one level for
each combination of the random effects.
However, I have 3 REs that are continuous variables:
age, ADHD_symptom_scores, TBV[Total_Brain_Volume].
So, in that situation, I'm not sure how to calculate what you suggest
unless I transform them into categorical variables, e.g.:
dat$age_5_levels = cut(dat$age, 5)
In that situation I would most likely have <10 subjects in some
of the levels of a factor that is constructed by making levels from
each combination of the REs.

Age and gender, are not significantly different between experimental groups
in this dataset, so I experimented with excluding them from the REs.
I very much wanted to control for ADHD symptoms in the REs, as this
was the whole idea of the model; i.e. to try to isolate autistic traits
within ADHD subjects, and determine to what extent these traits
are influenced by particular anatomical structures when the ADHD
symptom levels are controlled for in the REs.

So, trying to eliminate unnecessary REs (age and gender), the model is:

another.moo = MCMCglmm(autism_spectrum_scores ~ Diagnosis + Striatum +
Amygdala + Hippocampus,
                                          random = ~ADHD_symptom_scores
                                                    + scanner_binary
                                                    + TBV,
                                          data=dat)

I would like to keep total brain volume (TBV: a continuous variable),
and scanner type (scanner_binary: 0 or 1, for two different scanner
types) as REs.
These variables are significantly different between experimental groups.

For the above model, again, I'd be grateful for any pointers regarding how to
assess or improve it's validity.
Apologies for the necessary hand holding.

Thanks; Larry


On Mon, Nov 26, 2012 at 1:47 PM, Alan Haynes <aghaynes at gmail.com> wrote:
> I think that part of what Alain was getting at was that random effects
> require quite a few levels to calculate the variance, so RE such as age are
> generally not recommended - you get a bad estimate of the variance from 2
> points.
>
> I think he's also suggesting that with only 170 data points, the likelihood
> of overfitting is quite high when you have so many variables in your models.
> If you made a factor with one level for each combination of your random
> effects, how many datapoints would fall into each category? Ive heard it
> suggested that fewer than 10 and you'll probably start running into
> difficulty...dont remember where from though I'm afraid...
>
> HTH
>
> Alan
>
> --------------------------------------------------
> Email: aghaynes at gmail.com
> Mobile: +41794385586
> Skype: aghaynes
>
>
> On 26 November 2012 12:58, Laurence O'Dwyer <larodwyer at gmail.com> wrote:
>>
>> Hi Alain,
>>              Thank you for the reply. As a follow-up, I have a
>> question or two relating to your pointers and suggestions.
>>
>> >>
>> >> Hello to mixed-effects model experts,
>> >>
>> >>                                                         I am currently
>> >> trying to run an analysis on structural MRI data and would like to use
>> >> glmer or MCMCglmm to model my data. I have basic statistical knowledge
>> >> and
>> >> would appreciate any guidance in the use of these R-tools from experts
>> >> in
>> >> mixed effects models.
>> >>
>> >>                  In a crude way, I am interested in a model that might
>> >> look
>> >> something like the following:
>> >>
>> >>
>> >>
>> >> moo = MCMCglmm(autism_spectrum_scores ~ Diagnosis + Striatum + Thalamus
>> >> +
>> >> Amygdala + Hippocampus,
>> >>
>> >>                                            random =
>> >> ~ADHD_symptom_scores
>> >>
>> >>                                                      + age
>> >>
>> >>                                                      + scanner_type
>> >>
>> >>                                                      + gender
>> >>
>> >>                                                      +
>> >> total_brain_volume,
>> >>
>> >>                                            data=dat)
>> >>
>> >>
>> >
>> >
>> > Are you using gender as random effect?
>> >
>>
>> Yes, I am using gender as a random variable, as there are differences
>> (although non-significant) in the ratio of Males:Females in each
>> experimental group.
>>
>> >> It is a study of ADHD and autism. I have data for ~170 children with
>> >> ADHD,
>> >> ~70 unaffected siblings, and ~80 controls - this is the fixed factor
>> >> "Diagnosis".
>> >>
>> >> I have the volumes of particular structures in the brain. These are the
>> >> fixed factors Striatum, Thalamus, etc. I am interested to know their
>> >> relationship with a scale of autistic traits (NOT ADHD traits) within
>> >> all
>> >> experimental groups. For example, smaller volumes in the Striatum may
>> >> be
>> >> associated with increased autistic traits.
>> >>
>> >> For the random effects, I want to control for differences in ADHD
>> >> symptoms,
>> >> age, scanner type (two different scanners were used to collect the
>> >> volumetric data), gender and total brain volume.
>> >
>> > Yes you do. That is not a good idea. You may want to read a little bit
>> > on mixed modelling before doing this. Your model is overly complicated
>> > for 170 observations. I actually wonder whether this is mixed effects
>> > modelling; do you have multiple observations per child? If not...then it
>> > seems ordinary linear regression?
>>
>>
>> Sorry, I am not clear here on what you are referring to as "not a good
>> idea"?
>> Each child underwent scanning. There are multiple observations (MRI
>> volumetrics,
>> as well as symptom counts from diagnostic questionnaires), for all
>> children.
>> I felt mixed-effects models would be most effective and robust in this
>> situation
>> as I am interested to know how the fixed effects influence the
>> response variable,
>> while controlling for a range of random effects that influence the
>> variance of the response.
>> This analysis also ties in with earlier work assessing the relationship
>> between
>> autism scores and total brain white matter volume and total brain grey
>> matter volume,
>> for which mixed-effects models were quite informative. MCMC was used,
>> as the explanatory
>> variables are not normally distributed.
>>
>>
>> As suggested, I simplified the model and looked at the VIFs. I now
>> have 3 Fixed Effects with GVIFs:
>> Striatum    1.507092
>> Amygdala    1.281519
>> Hippocampus 1.557735
>>
>>
>> So, I would like to know if the resulting model could be considered
>> statistically sound, or if there are still gaping
>> holes in its statistical credibility:
>>
>> try.5 = MCMCglmm(ASD_spectrum_VISK ~ Diagnosis_Simple + Striatum +
>> Amygdala + Hippocampus,
>>                                           random =
>> ~Combined_Symptoms_inatt_plus_hyper
>>                                                     + age
>>                                                     + scanner_binary
>>                                                     + Gender
>>                                                     + TBV,
>>                                           data=dat)
>>
>>
>> This leads to a result that can be reasonably well interpreted
>> biologically and which is in line with
>> the study hypothesis: ADHD diagnosis has significant effect on the
>> autism score, and Striatal volume (p=0.078)
>> has a borderline significant effect on autism score.
>>
>> I am particularly keen to know if my attempts to control for ADHD
>> symptoms, as well as age, scanner type, etc., are adequately
>> dealt with in the random effects section, or whether or not I need to
>> look into the specification of a prior which is noted in some of the
>> MCMCglmm documentation.
>>
>> Any advice is greatly appreciated.
>>
>> With thanks; Larry
>>
>>
>> >> A key point of the analysis would be to establish the relationship
>> >> between
>> >> structural volumes and autistic scores, when levels of ADHD have been
>> >> controlled for.
>> >>
>> >> One problem is that all the structural volumes are closely correlated.
>> >> Previously, when working with two structural volumes that were
>> >> correlated,
>> >> I used the regression residuals of one structural volume relative to
>> >> the
>> >> other to isolate the unique contribution of each explanatory variable,
>> >> independent from what was shared between them. But, I don't think I can
>> >> use
>> >> this approach with four structures that are highly correlated.
>> >>
>> >>                  There are probably many other statistical flies in the
>> >> ointment relating to the above. If anyone has any pointers as to how to
>> >> deal with the situation when multiple explanatory variables are
>> >> correlated,
>> >
>> > dump some of them...after making scatterplots, and calculate VIF values.
>> > Or use them, and accept that SEs will be blown up.
>> >
>> > Kind regards,
>> >
>> > Alain
>> >> in a mixed-effects models framework, they would be appreciated.
>> >>
>> >>                  Thanks; Larry
>> >>
>>
>> _______________________________________________
>> R-sig-mixed-models at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>
>


From aghaynes at gmail.com  Tue Nov 27 10:01:07 2012
From: aghaynes at gmail.com (Alan Haynes)
Date: Tue, 27 Nov 2012 10:01:07 +0100
Subject: [R-sig-ME] R-sig-mixed-models Digest, Vol 71, Issue 34
In-Reply-To: <CACp2W9ARG5O5cQ+qJjr5iNVSdse0jDS8Yyb0K3666x8Rs0t42A@mail.gmail.com>
References: <mailman.7835.1353676125.4555.r-sig-mixed-models@r-project.org>
	<CACp2W9AK=7q6c7POyNueW6PqGtz2HjFJNYpuhayCR_TDE0_rZw@mail.gmail.com>
	<CAPdSD+6qygk1BnP9AfTtYBCTijU+OatN7d+bz2HQsQtR9cM2oQ@mail.gmail.com>
	<CACp2W9ARG5O5cQ+qJjr5iNVSdse0jDS8Yyb0K3666x8Rs0t42A@mail.gmail.com>
Message-ID: <CAPdSD+5Ouad_Xdj8PyfAs4iwq2dQ_RidoD8VWWik=+GNoae9yg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121127/6473a639/attachment.pl>

From j.hadfield at ed.ac.uk  Tue Nov 27 11:07:59 2012
From: j.hadfield at ed.ac.uk (Jarrod Hadfield)
Date: Tue, 27 Nov 2012 10:07:59 +0000
Subject: [R-sig-ME] R-sig-mixed-models Digest, Vol 71, Issue 34
In-Reply-To: <CAPdSD+5Ouad_Xdj8PyfAs4iwq2dQ_RidoD8VWWik=+GNoae9yg@mail.gmail.com>
References: <mailman.7835.1353676125.4555.r-sig-mixed-models@r-project.org>
	<CACp2W9AK=7q6c7POyNueW6PqGtz2HjFJNYpuhayCR_TDE0_rZw@mail.gmail.com>
	<CAPdSD+6qygk1BnP9AfTtYBCTijU+OatN7d+bz2HQsQtR9cM2oQ@mail.gmail.com>
	<CACp2W9ARG5O5cQ+qJjr5iNVSdse0jDS8Yyb0K3666x8Rs0t42A@mail.gmail.com>
	<CAPdSD+5Ouad_Xdj8PyfAs4iwq2dQ_RidoD8VWWik=+GNoae9yg@mail.gmail.com>
Message-ID: <20121127100759.12042urvldg141e8@www.staffmail.ed.ac.uk>

HI Larry,

Its not clear to me exactly what you want the model to look like, but  
I'm fairly certain the model you have specified in MCMCglmm (or the  
lmer equivalent does) is not going to make much sense.

It is the effects that are random not the predictors. If you have a  
continuous predictor you have a single effect, and so estimating the  
variance of the effect is a non-starter. You should treat the effect  
as fixed. MCMCglmm (and lmer) I believe will convert your continuous  
variable into a factor if you specify it as ~ADHD_symptom_scores+...  
and then you will end up with as many effects as there are unique  
values. Estimating the variance of these effects is possible, but is  
it meaningful? Probably not.

Categorical predictors with 2 levels (e.g. scanner_binary) suffer the  
same problem - the precision on the variance component will be so poor  
(and presumably the replication for each level so high) that you might  
as well treat the effects as fixed.

Alan seems to think that you want to model the fact that the variance  
in the response is non-constant between groups (or as a function of a  
covariate). Is this true? If it is then  
rcov=~idh(scanner_binary):units will allow the residual variance to  
vary between the two groups.   
random=~idh(sqrt(ADHD_symptom_scores)):units  allows the residual  
variance to change according to v1+ADHD_symptom_scores*v2  where v1 is  
the units variance and v2 is the variance associated with the random  
term.

Cheers,

Jarrod



Quoting Alan Haynes <aghaynes at gmail.com> on Tue, 27 Nov 2012 10:01:07 +0100:

> Hi Larry,
>
> I dont know how MCMCglmm handles the REs in terms of random slopes and/or
> intercepts so others will be able to provide better advice with regards
> your continuous variables.
>
> Does your scanner actually affect the variance? You could visually check
> this and if not add it as a main effect...this is quite often recommended
> for factors with only a couple of levels. The same would go for age and
> gender.
>
> You might find http://glmm.wikidot.com/faq useful. This has sections on
> whether or not to use something as a fixed or RE, assessing REs and loads
> of other stuff relating to [G]LMMs.
>
> HTH
>
> Alan
>
>
>
> --------------------------------------------------
> Email: aghaynes at gmail.com
> Mobile: +41794385586
> Skype: aghaynes
>
>
> On 26 November 2012 17:07, Laurence O'Dwyer <larodwyer at gmail.com> wrote:
>
>> Hi Alan and Alain,
>>                           I see that you might want to have >10 subjects
>> within
>> each level of a factor that is constructed by making one level for
>> each combination
>> of the random effects.
>> However, I have 3 REs that are continuous variables:
>> age, ADHD_symptom_scores, TBV[Total_Brain_Volume].
>> So, in that situation, I'm not sure how to calculate what you suggest
>> unless I transform them into categorical variables, e.g.:
>> dat$age_5_levels = cut(dat$age, 5)
>> In that situation I would most likely have <10 subjects in some
>> of the levels of a factor that is constructed by making levels from
>> each combination of the REs.
>>
>> Age and gender, are not significantly different between experimental groups
>> in this dataset, so I experimented with excluding them from the REs.
>> I very much wanted to control for ADHD symptoms in the REs, as this
>> was the whole idea of the model; i.e. to try to isolate autistic traits
>> within ADHD subjects, and determine to what extent these traits
>> are influenced by particular anatomical structures when the ADHD
>> symptom levels are controlled for in the REs.
>>
>> So, trying to eliminate unnecessary REs (age and gender), the model is:
>>
>> another.moo = MCMCglmm(autism_spectrum_scores ~ Diagnosis + Striatum +
>> Amygdala + Hippocampus,
>>                                           random = ~ADHD_symptom_scores
>>                                                     + scanner_binary
>>                                                     + TBV,
>>                                           data=dat)
>>
>> I would like to keep total brain volume (TBV: a continuous variable),
>> and scanner type (scanner_binary: 0 or 1, for two different scanner
>> types) as REs.
>> These variables are significantly different between experimental groups.
>>
>> For the above model, again, I'd be grateful for any pointers regarding how
>> to
>> assess or improve it's validity.
>> Apologies for the necessary hand holding.
>>
>> Thanks; Larry
>>
>>
>> On Mon, Nov 26, 2012 at 1:47 PM, Alan Haynes <aghaynes at gmail.com> wrote:
>> > I think that part of what Alain was getting at was that random effects
>> > require quite a few levels to calculate the variance, so RE such as age
>> are
>> > generally not recommended - you get a bad estimate of the variance from 2
>> > points.
>> >
>> > I think he's also suggesting that with only 170 data points, the
>> likelihood
>> > of overfitting is quite high when you have so many variables in your
>> models.
>> > If you made a factor with one level for each combination of your random
>> > effects, how many datapoints would fall into each category? Ive heard it
>> > suggested that fewer than 10 and you'll probably start running into
>> > difficulty...dont remember where from though I'm afraid...
>> >
>> > HTH
>> >
>> > Alan
>> >
>> > --------------------------------------------------
>> > Email: aghaynes at gmail.com
>> > Mobile: +41794385586
>> > Skype: aghaynes
>> >
>> >
>> > On 26 November 2012 12:58, Laurence O'Dwyer <larodwyer at gmail.com> wrote:
>> >>
>> >> Hi Alain,
>> >>              Thank you for the reply. As a follow-up, I have a
>> >> question or two relating to your pointers and suggestions.
>> >>
>> >> >>
>> >> >> Hello to mixed-effects model experts,
>> >> >>
>> >> >>                                                         I am
>> currently
>> >> >> trying to run an analysis on structural MRI data and would like to
>> use
>> >> >> glmer or MCMCglmm to model my data. I have basic statistical
>> knowledge
>> >> >> and
>> >> >> would appreciate any guidance in the use of these R-tools from
>> experts
>> >> >> in
>> >> >> mixed effects models.
>> >> >>
>> >> >>                  In a crude way, I am interested in a model that
>> might
>> >> >> look
>> >> >> something like the following:
>> >> >>
>> >> >>
>> >> >>
>> >> >> moo = MCMCglmm(autism_spectrum_scores ~ Diagnosis + Striatum +
>> Thalamus
>> >> >> +
>> >> >> Amygdala + Hippocampus,
>> >> >>
>> >> >>                                            random =
>> >> >> ~ADHD_symptom_scores
>> >> >>
>> >> >>                                                      + age
>> >> >>
>> >> >>                                                      + scanner_type
>> >> >>
>> >> >>                                                      + gender
>> >> >>
>> >> >>                                                      +
>> >> >> total_brain_volume,
>> >> >>
>> >> >>                                            data=dat)
>> >> >>
>> >> >>
>> >> >
>> >> >
>> >> > Are you using gender as random effect?
>> >> >
>> >>
>> >> Yes, I am using gender as a random variable, as there are differences
>> >> (although non-significant) in the ratio of Males:Females in each
>> >> experimental group.
>> >>
>> >> >> It is a study of ADHD and autism. I have data for ~170 children with
>> >> >> ADHD,
>> >> >> ~70 unaffected siblings, and ~80 controls - this is the fixed factor
>> >> >> "Diagnosis".
>> >> >>
>> >> >> I have the volumes of particular structures in the brain. These are
>> the
>> >> >> fixed factors Striatum, Thalamus, etc. I am interested to know their
>> >> >> relationship with a scale of autistic traits (NOT ADHD traits) within
>> >> >> all
>> >> >> experimental groups. For example, smaller volumes in the Striatum may
>> >> >> be
>> >> >> associated with increased autistic traits.
>> >> >>
>> >> >> For the random effects, I want to control for differences in ADHD
>> >> >> symptoms,
>> >> >> age, scanner type (two different scanners were used to collect the
>> >> >> volumetric data), gender and total brain volume.
>> >> >
>> >> > Yes you do. That is not a good idea. You may want to read a little bit
>> >> > on mixed modelling before doing this. Your model is overly complicated
>> >> > for 170 observations. I actually wonder whether this is mixed effects
>> >> > modelling; do you have multiple observations per child? If not...then
>> it
>> >> > seems ordinary linear regression?
>> >>
>> >>
>> >> Sorry, I am not clear here on what you are referring to as "not a good
>> >> idea"?
>> >> Each child underwent scanning. There are multiple observations (MRI
>> >> volumetrics,
>> >> as well as symptom counts from diagnostic questionnaires), for all
>> >> children.
>> >> I felt mixed-effects models would be most effective and robust in this
>> >> situation
>> >> as I am interested to know how the fixed effects influence the
>> >> response variable,
>> >> while controlling for a range of random effects that influence the
>> >> variance of the response.
>> >> This analysis also ties in with earlier work assessing the relationship
>> >> between
>> >> autism scores and total brain white matter volume and total brain grey
>> >> matter volume,
>> >> for which mixed-effects models were quite informative. MCMC was used,
>> >> as the explanatory
>> >> variables are not normally distributed.
>> >>
>> >>
>> >> As suggested, I simplified the model and looked at the VIFs. I now
>> >> have 3 Fixed Effects with GVIFs:
>> >> Striatum    1.507092
>> >> Amygdala    1.281519
>> >> Hippocampus 1.557735
>> >>
>> >>
>> >> So, I would like to know if the resulting model could be considered
>> >> statistically sound, or if there are still gaping
>> >> holes in its statistical credibility:
>> >>
>> >> try.5 = MCMCglmm(ASD_spectrum_VISK ~ Diagnosis_Simple + Striatum +
>> >> Amygdala + Hippocampus,
>> >>                                           random =
>> >> ~Combined_Symptoms_inatt_plus_hyper
>> >>                                                     + age
>> >>                                                     + scanner_binary
>> >>                                                     + Gender
>> >>                                                     + TBV,
>> >>                                           data=dat)
>> >>
>> >>
>> >> This leads to a result that can be reasonably well interpreted
>> >> biologically and which is in line with
>> >> the study hypothesis: ADHD diagnosis has significant effect on the
>> >> autism score, and Striatal volume (p=0.078)
>> >> has a borderline significant effect on autism score.
>> >>
>> >> I am particularly keen to know if my attempts to control for ADHD
>> >> symptoms, as well as age, scanner type, etc., are adequately
>> >> dealt with in the random effects section, or whether or not I need to
>> >> look into the specification of a prior which is noted in some of the
>> >> MCMCglmm documentation.
>> >>
>> >> Any advice is greatly appreciated.
>> >>
>> >> With thanks; Larry
>> >>
>> >>
>> >> >> A key point of the analysis would be to establish the relationship
>> >> >> between
>> >> >> structural volumes and autistic scores, when levels of ADHD have been
>> >> >> controlled for.
>> >> >>
>> >> >> One problem is that all the structural volumes are closely
>> correlated.
>> >> >> Previously, when working with two structural volumes that were
>> >> >> correlated,
>> >> >> I used the regression residuals of one structural volume relative to
>> >> >> the
>> >> >> other to isolate the unique contribution of each explanatory
>> variable,
>> >> >> independent from what was shared between them. But, I don't think I
>> can
>> >> >> use
>> >> >> this approach with four structures that are highly correlated.
>> >> >>
>> >> >>                  There are probably many other statistical flies in
>> the
>> >> >> ointment relating to the above. If anyone has any pointers as to how
>> to
>> >> >> deal with the situation when multiple explanatory variables are
>> >> >> correlated,
>> >> >
>> >> > dump some of them...after making scatterplots, and calculate VIF
>> values.
>> >> > Or use them, and accept that SEs will be blown up.
>> >> >
>> >> > Kind regards,
>> >> >
>> >> > Alain
>> >> >> in a mixed-effects models framework, they would be appreciated.
>> >> >>
>> >> >>                  Thanks; Larry
>> >> >>
>> >>
>> >> _______________________________________________
>> >> R-sig-mixed-models at r-project.org mailing list
>> >> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>> >
>> >
>>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>
>



-- 
The University of Edinburgh is a charitable body, registered in
Scotland, with registration number SC005336.


From phuongcard at gmail.com  Tue Nov 27 13:35:28 2012
From: phuongcard at gmail.com (Ho Ngoc Phuong)
Date: Tue, 27 Nov 2012 13:35:28 +0100
Subject: [R-sig-ME] R-squared in mixed model using nlme package
Message-ID: <CAMJSuH3QJo1xYLagy5FxELMkGXL15-L4Zxck+9Q=jF6B2aH=9A@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121127/07a69780/attachment.pl>

From dsolrueda at gmail.com  Tue Nov 27 14:07:45 2012
From: dsolrueda at gmail.com (Daniel Sol)
Date: Tue, 27 Nov 2012 14:07:45 +0100
Subject: [R-sig-ME]  Zipoisson MCMCglmm for abundance data
Message-ID: <CAN3C_1A8mQGHA++tiz_qV_Q1jBjZy0hZ00kr0OonGdDH8jVUSw@mail.gmail.com>

Hi everybody,

I'm trying to model species abundances and I have some doubts about
how to fit my model with MCMCglmm.

My aim is to test whether the abundance of species in urban habitats
(variable "abund.urb") is associated with their density in the
surrounding habitats (variable "dens.surr", log+0.5 transformed) with
a dataset of 22 localities. The response variable (variable
"abund.urb") is zero-inflated, so a zipoisson stucture of errors seems
to be a good option. To model this response variable, I need to take
into account the likely non-independence of observations coming from
the same location (variable "location") and the same species (variable
"animal", as some species are found in more than one locality). I also
need to include phylogenetic corrections (phylo object "tree") and
take into account that the sampling effort (variable "effort") vary
between locations. The script is shown below.

zi.prior <-  list(R = list(V = diag(2), n = 1.002, fix = 2),
			  G = list(G1 = list(V = 1, n = 0.002),
		  	  G2 = list(V = 1, n = 0.002),
		              G3 = list(V = 1, n = 0.002)))
mev <-1/(effort)
mesd <- (mev)**0.5

   m2 <- MCMCglmm(abund.urb ~ -1 +
at.level(trait,1):log(dens.surr+0.5) +  	at.level(trait,1):location,
	random = ~idh(at.level(trait,1)):location +
idh(at.level(trait,1)):animal + us(mesd):units,
	rcov = ~ idh(trait):units,
	data = dat0.phyl, family = "zipoisson", prior = zi.prior,
	pedigree=tree,
	verbose = TRUE, pr = FALSE, pl = FALSE)

I would appreciate help in the following questions:

1. Does the model look appropriate?

2. How can I transform the model to allow slopes (in addition of
intercepts)  to vary at random within localities? I have made several
attempts but they do not work.

3. Is the use of "animal" as random factor enough to control for
repeated species data, or I also have to add an additional random
factor coding for each species.

3. Is the estimated of "med" correct?

3. Should I use trait-1 or simply -1?

4. Are there other priors that would be worth testing?

I'm new in using MCMCglmm so any help is appreciated.

Many thanks in advance,

Dani


-- 
Daniel Sol
CREAF (Centre for Ecological Research and Applied Forestries)
CSIC (Centre for Advanced Studies of Blanes-Spanish National Research Council)
Autonomous University of Barcelona, Bellaterra, Catalonia E-08193, Spain
TEL: +34 93-5814678
FAX: +34 93-5814151
E-MAIL: d.sol at creaf.uab.es


From benton at stat.berkeley.edu  Tue Nov 27 14:35:46 2012
From: benton at stat.berkeley.edu (Katie Colborn)
Date: Tue, 27 Nov 2012 08:35:46 -0500
Subject: [R-sig-ME] Bivariate Poisson MCMCglmm
Message-ID: <6429B6E5-F676-41CE-A111-65BAEA0ADBAE@stat.berkeley.edu>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121127/aef5d123/attachment.pl>

From j.hadfield at ed.ac.uk  Tue Nov 27 14:49:38 2012
From: j.hadfield at ed.ac.uk (Jarrod Hadfield)
Date: Tue, 27 Nov 2012 13:49:38 +0000
Subject: [R-sig-ME] Zipoisson MCMCglmm for abundance data
In-Reply-To: <CAN3C_1A8mQGHA++tiz_qV_Q1jBjZy0hZ00kr0OonGdDH8jVUSw@mail.gmail.com>
References: <CAN3C_1A8mQGHA++tiz_qV_Q1jBjZy0hZ00kr0OonGdDH8jVUSw@mail.gmail.com>
Message-ID: <20121127134938.75921unhyjbjchy8@www.staffmail.ed.ac.uk>

Dear Dani,

1/3b You need to drop at.level(trait,1):location from the fixed model  
as you have it in the random part of the model (although this may just  
be a typo).  I would also have trait-1 as you do not want the  
intercept for the Poisson process and the zero-inflation to be the same.

2. If you have many observations per species then I would put a  
non-phylogenetic species effect in too. If there are few (at the  
limit, only one) then it may be hard to separate the phylogenetic from  
the non-phylogenetic.

3a. this looks fine but make sure to put mesd in dat0.phyl (I presume  
this is the case otherwise MCMcglmm should spit an error, if it did  
not please tell me). Not sure how effort is measured, but you may not  
expect a linear relationship between 1/(effort) and the measurement  
error variance of the counts on the log scale. (I presume ** should be  
^ in your code)

4. With  the 2x2 "idh" structure on the residuals I would use nu=0.002  
rather than nu=1.002. Only with a 2x2 "us" structure is the degree of  
belief for the marginal distribution of a single variance 0.002 when  
specifying nu=1.002. Parameter expanded priors might also be  
entertained for the random effect variances. They will also improve  
mixing if the varinaces are close to zero.

Cheers,

Jarrod



Quoting Daniel Sol <dsolrueda at gmail.com> on Tue, 27 Nov 2012 14:07:45 +0100:

> Hi everybody,
>
> I'm trying to model species abundances and I have some doubts about
> how to fit my model with MCMCglmm.
>
> My aim is to test whether the abundance of species in urban habitats
> (variable "abund.urb") is associated with their density in the
> surrounding habitats (variable "dens.surr", log+0.5 transformed) with
> a dataset of 22 localities. The response variable (variable
> "abund.urb") is zero-inflated, so a zipoisson stucture of errors seems
> to be a good option. To model this response variable, I need to take
> into account the likely non-independence of observations coming from
> the same location (variable "location") and the same species (variable
> "animal", as some species are found in more than one locality). I also
> need to include phylogenetic corrections (phylo object "tree") and
> take into account that the sampling effort (variable "effort") vary
> between locations. The script is shown below.
>
> zi.prior <-  list(R = list(V = diag(2), n = 1.002, fix = 2),
> 			  G = list(G1 = list(V = 1, n = 0.002),
> 		  	  G2 = list(V = 1, n = 0.002),
> 		              G3 = list(V = 1, n = 0.002)))
> mev <-1/(effort)
> mesd <- (mev)**0.5
>
>    m2 <- MCMCglmm(abund.urb ~ -1 +
> at.level(trait,1):log(dens.surr+0.5) +  	at.level(trait,1):location,
> 	random = ~idh(at.level(trait,1)):location +
> idh(at.level(trait,1)):animal + us(mesd):units,
> 	rcov = ~ idh(trait):units,
> 	data = dat0.phyl, family = "zipoisson", prior = zi.prior,
> 	pedigree=tree,
> 	verbose = TRUE, pr = FALSE, pl = FALSE)
>
> I would appreciate help in the following questions:
>
> 1. Does the model look appropriate?
>
> 2. How can I transform the model to allow slopes (in addition of
> intercepts)  to vary at random within localities? I have made several
> attempts but they do not work.
>
> 3. Is the use of "animal" as random factor enough to control for
> repeated species data, or I also have to add an additional random
> factor coding for each species.
>
> 3. Is the estimated of "med" correct?
>
> 3. Should I use trait-1 or simply -1?
>
> 4. Are there other priors that would be worth testing?
>
> I'm new in using MCMCglmm so any help is appreciated.
>
> Many thanks in advance,
>
> Dani
>
>
> --
> Daniel Sol
> CREAF (Centre for Ecological Research and Applied Forestries)
> CSIC (Centre for Advanced Studies of Blanes-Spanish National  
> Research Council)
> Autonomous University of Barcelona, Bellaterra, Catalonia E-08193, Spain
> TEL: +34 93-5814678
> FAX: +34 93-5814151
> E-MAIL: d.sol at creaf.uab.es
>
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>
>



-- 
The University of Edinburgh is a charitable body, registered in
Scotland, with registration number SC005336.


From dsolrueda at gmail.com  Tue Nov 27 15:13:29 2012
From: dsolrueda at gmail.com (Daniel Sol)
Date: Tue, 27 Nov 2012 15:13:29 +0100
Subject: [R-sig-ME] Zipoisson MCMCglmm for abundance data
In-Reply-To: <20121127134938.75921unhyjbjchy8@www.staffmail.ed.ac.uk>
References: <CAN3C_1A8mQGHA++tiz_qV_Q1jBjZy0hZ00kr0OonGdDH8jVUSw@mail.gmail.com>
	<20121127134938.75921unhyjbjchy8@www.staffmail.ed.ac.uk>
Message-ID: <CAN3C_1C=Jt0M6bEJCwk-vHaOwotci_w9HujjTmZ0uxFUHGrhyQ@mail.gmail.com>

Dear Jarrod,

many thanks for the rapid answer and very useful advice. Following
your advice, I'm gonna use the following code.

zi.prior <-  list(R = list(V = diag(2), n = 0.002, fix = 2),
	      G = list(G1 = list(V = 1, n = 0.002),
	      G2 = list(V = 1, n = 0.002),
                   G3 = list(V = 1, n = 0.002),
                   G4 = list(V = 1, n = 0.002)))

m2 <- MCMCglmm(abund.urb ~ trait-1 + at.level(trait,1):dens.surr,
			 random = ~idh(at.level(trait,1)):location	+						
              idh(at.level(trait,1)):animal +
				       idh(at.level(trait,1)):sp2 +
				       us(mesd):units,
			                    rcov = ~ idh(trait):units,
				       prior = zi.prior,
				       pedigree=tr[[1]],
				       data = dat0.phyl, family = "zipoisson", verbose = TRUE,
				       pr = FALSE, pl = FALSE)

However, I'm still wondering how to run the same model allowing the
relationship between abundance in the city (abund.urb) and density in
the surrounding habitats (dens.surr) to vary across locations
(location) in both intercepts and slopes.

Many thanks again,

Dani


2012/11/27 Jarrod Hadfield <j.hadfield at ed.ac.uk>:
> 1/3b You need to drop at.level(trait,1):location from the fixed model as you
> have it in the random part of the model (although this may just be a typo).
> I would also have trait-1 as you do not want the intercept for the Poisson
> process and the zero-inflation to be the same.
>
> 2. If you have many observations per species then I would put a
> non-phylogenetic species effect in too. If there are few (at the limit, only
> one) then it may be hard to separate the phylogenetic from the
> non-phylogenetic.
>
> 3a. this looks fine but make sure to put mesd in dat0.phyl (I presume this
> is the case otherwise MCMcglmm should spit an error, if it did not please
> tell me). Not sure how effort is measured, but you may not expect a linear
> relationship between 1/(effort) and the measurement error variance of the
> counts on the log scale. (I presume ** should be ^ in your code)
>
> 4. With  the 2x2 "idh" structure on the residuals I would use nu=0.002
> rather than nu=1.002. Only with a 2x2 "us" structure
> is the degree of belief for the marginal distribution of a single variance
> 0.002 when specifying nu=1.002. Parameter expanded priors might also be
> entertained for the random effect variances. They will also improve mixing
> if the varinaces are close to zero.



-- 
Daniel Sol
CREAF (Centre for Ecological Research and Applied Forestries)
CSIC (Centre for Advanced Studies of Blanes-Spanish National Research Council)
Autonomous University of Barcelona, Bellaterra, Catalonia E-08193, Spain
TEL: +34 93-5814678
FAX: +34 93-5814151
E-MAIL: d.sol at creaf.uab.es


From j.hadfield at ed.ac.uk  Tue Nov 27 15:23:06 2012
From: j.hadfield at ed.ac.uk (Jarrod Hadfield)
Date: Tue, 27 Nov 2012 14:23:06 +0000
Subject: [R-sig-ME] Bivariate Poisson MCMCglmm
In-Reply-To: <6429B6E5-F676-41CE-A111-65BAEA0ADBAE@stat.berkeley.edu>
References: <6429B6E5-F676-41CE-A111-65BAEA0ADBAE@stat.berkeley.edu>
Message-ID: <20121127142306.134232l7dlr53hkw@www.staffmail.ed.ac.uk>

Hi Katie,

Your model makes sense. The different malaria species have different  
abundances (trait-1) and their abundances change with age at different  
rates (trait:Age). The 2x2 covariance matrices specified by  
us(trait):random.term capture how much variance there is in the counts  
of each species (along the diagonal) between villages, between  
children within villages, and between observations within children.  
The latter being the overdispersion (rcov). The off-diagonal elements  
measure the degree to which the counts of the two species covary  
(negatively) at these different levels.  However, you have fixed the  
overdispersion to one in the prior for each species, and fixed the  
residual correlation between species to zero. You need to remove the  
fix argument. Also nu=2 in your G-stricture priors may have quite a  
strong effect particularly for those groupings where there is little  
information (e.g. village). I tend to use parameter expanded priors  
instead.

Predicting "mixed clinical episodes" is a bit more tricky.  Since,  
E[PFepisodes*PVepisodes]  
=COV(PFepisodes,PVepisodes)-E[PFepisodes]*E[PVepisodes], your model  
already predicts the product. However,  COV(PFepisodes,PVepisodes) is  
a constant in your model (i.e. the between village covariance is not  
variable) so it is perhaps not as flexible as you would like.  I think  
you would like to add predictors for COV(PFepisodes,PVepisodes)(?) but  
this is not straightforward in MCMCglmm. Discretising cases into  
single and multiple infection and using a binary glmm might be easier.

Cheers,

Jarrod
Quoting Katie Colborn <benton at stat.berkeley.edu> on Tue, 27 Nov 2012  
08:35:46 -0500:

> Hi:
>
> Thanks for the helpful comments from my last post. I am writing  
> today with a new question.
>
> I'd like to specify a bivariate Poisson model with two random  
> effects. The responses are counts of clinical episodes of two  
> different malaria species during an 8-week interval. There are a  
> handful of time-dependent covariates that I would like to include on  
> the RHS of the equation as well as a random effect for child  
> (repeated measures) and one for village (clustering). There's also  
> the complication of needing to add an offset for time-at-risk which  
> subtracts off the time after treatment when a child is not at risk  
> of becoming ill (I will worry about that later). There are 1867  
> observations from 264 children nested within 11 villages.
>
> My question is, can I fit this model in MCMCglmm or GLMER? I don't  
> believe I can fit it in GLMER, but I should be able to fit it in  
> MCMCglmm. I'd like to fit a saturated model, so I'd like an estimate  
> of the effects of the covariates on "mixed clinical episodes", i.e.  
> the interaction between counts of episodes between the two species.  
> The two counts are negatively correlated, which I hope can be  
> estimated using this package as well. Does anyone know of a good  
> manuscript that has done something similar? I think what I am truly  
> stuck on is writing down the model. How many parameters should there  
> be on the RHS? An intercept and a slope for each fixed effect for  
> each species? For example, if there is simply age on the RHS, do I  
> end up with 4 parameters: 2 intercepts and 2 slopes for the two  
> response categories? What about Y1*Y2?
>
> My first attempt at analyzing this is below (which I obviously  
> should not do until I figure out how to write down the model, but  
> perhaps this will help to understand what I am trying to do):
>
> prior.bivar <- list(R = list(V = diag(2), nu = 0, fix=1),
> 		 G = list(G1 = list(V = diag(2), n=2),
> 		 G2 = list(V = diag(2), n=2)))
>
> model.bivar <- MCMCglmm(cbind(PFepisodes, PVepisodes) ~ -1 + trait +  
> trait:Age,
> 		random = ~ us(trait):child + us(trait):village,
> 		rcov = ~ us(trait):units, prior = prior.bivar,
> 		family = c("poisson", "poisson"),
> 		nitt = 60000, burnin = 10000,
> 		thin=25, data = MixedDat)
>
> summary(model.bivar)
>
> Thanks in advance!
>
> Katie Colborn
> benton at stat.berkeley.edu
>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>
>



-- 
The University of Edinburgh is a charitable body, registered in
Scotland, with registration number SC005336.


From j.hadfield at ed.ac.uk  Tue Nov 27 15:28:01 2012
From: j.hadfield at ed.ac.uk (Jarrod Hadfield)
Date: Tue, 27 Nov 2012 14:28:01 +0000
Subject: [R-sig-ME] Zipoisson MCMCglmm for abundance data
In-Reply-To: <CAN3C_1C=Jt0M6bEJCwk-vHaOwotci_w9HujjTmZ0uxFUHGrhyQ@mail.gmail.com>
References: <CAN3C_1A8mQGHA++tiz_qV_Q1jBjZy0hZ00kr0OonGdDH8jVUSw@mail.gmail.com>
	<20121127134938.75921unhyjbjchy8@www.staffmail.ed.ac.uk>
	<CAN3C_1C=Jt0M6bEJCwk-vHaOwotci_w9HujjTmZ0uxFUHGrhyQ@mail.gmail.com>
Message-ID: <20121127142801.51431vjqhu5n690k@www.staffmail.ed.ac.uk>

Hi,

Sorry forgot that one. Have,

us(at.level(trait,1)+at.level(trait,1):dens.surr):location

instead of

us(at.level(trait,1)):location

but be careful, this is a complicated model.

Cheers,

Jarrod






to the random model.
Quoting Daniel Sol <dsolrueda at gmail.com> on Tue, 27 Nov 2012 15:13:29 +0100:

> Dear Jarrod,
>
> many thanks for the rapid answer and very useful advice. Following
> your advice, I'm gonna use the following code.
>
> zi.prior <-  list(R = list(V = diag(2), n = 0.002, fix = 2),
> 	      G = list(G1 = list(V = 1, n = 0.002),
> 	      G2 = list(V = 1, n = 0.002),
>                    G3 = list(V = 1, n = 0.002),
>                    G4 = list(V = 1, n = 0.002)))
>
> m2 <- MCMCglmm(abund.urb ~ trait-1 + at.level(trait,1):dens.surr,
> 			 random = ~idh(at.level(trait,1)):location	+
>               idh(at.level(trait,1)):animal +
> 				       idh(at.level(trait,1)):sp2 +
> 				       us(mesd):units,
> 			                    rcov = ~ idh(trait):units,
> 				       prior = zi.prior,
> 				       pedigree=tr[[1]],
> 				       data = dat0.phyl, family = "zipoisson", verbose = TRUE,
> 				       pr = FALSE, pl = FALSE)
>
> However, I'm still wondering how to run the same model allowing the
> relationship between abundance in the city (abund.urb) and density in
> the surrounding habitats (dens.surr) to vary across locations
> (location) in both intercepts and slopes.
>
> Many thanks again,
>
> Dani
>
>
> 2012/11/27 Jarrod Hadfield <j.hadfield at ed.ac.uk>:
>> 1/3b You need to drop at.level(trait,1):location from the fixed model as you
>> have it in the random part of the model (although this may just be a typo).
>> I would also have trait-1 as you do not want the intercept for the Poisson
>> process and the zero-inflation to be the same.
>>
>> 2. If you have many observations per species then I would put a
>> non-phylogenetic species effect in too. If there are few (at the limit, only
>> one) then it may be hard to separate the phylogenetic from the
>> non-phylogenetic.
>>
>> 3a. this looks fine but make sure to put mesd in dat0.phyl (I presume this
>> is the case otherwise MCMcglmm should spit an error, if it did not please
>> tell me). Not sure how effort is measured, but you may not expect a linear
>> relationship between 1/(effort) and the measurement error variance of the
>> counts on the log scale. (I presume ** should be ^ in your code)
>>
>> 4. With  the 2x2 "idh" structure on the residuals I would use nu=0.002
>> rather than nu=1.002. Only with a 2x2 "us" structure
>> is the degree of belief for the marginal distribution of a single variance
>> 0.002 when specifying nu=1.002. Parameter expanded priors might also be
>> entertained for the random effect variances. They will also improve mixing
>> if the varinaces are close to zero.
>
>
>
> --
> Daniel Sol
> CREAF (Centre for Ecological Research and Applied Forestries)
> CSIC (Centre for Advanced Studies of Blanes-Spanish National  
> Research Council)
> Autonomous University of Barcelona, Bellaterra, Catalonia E-08193, Spain
> TEL: +34 93-5814678
> FAX: +34 93-5814151
> E-MAIL: d.sol at creaf.uab.es
>
>



-- 
The University of Edinburgh is a charitable body, registered in
Scotland, with registration number SC005336.


From dsolrueda at gmail.com  Tue Nov 27 15:32:21 2012
From: dsolrueda at gmail.com (Daniel Sol)
Date: Tue, 27 Nov 2012 15:32:21 +0100
Subject: [R-sig-ME] Zipoisson MCMCglmm for abundance data
In-Reply-To: <20121127142801.51431vjqhu5n690k@www.staffmail.ed.ac.uk>
References: <CAN3C_1A8mQGHA++tiz_qV_Q1jBjZy0hZ00kr0OonGdDH8jVUSw@mail.gmail.com>
	<20121127134938.75921unhyjbjchy8@www.staffmail.ed.ac.uk>
	<CAN3C_1C=Jt0M6bEJCwk-vHaOwotci_w9HujjTmZ0uxFUHGrhyQ@mail.gmail.com>
	<20121127142801.51431vjqhu5n690k@www.staffmail.ed.ac.uk>
Message-ID: <CAN3C_1AZ1TVrKy1m=QkDNeTgPMgiG_6SPkT7D6PZdsFAufCEhA@mail.gmail.com>

Great, Jarrod. Many thanks for all your help.

Cheers,

Dani

2012/11/27 Jarrod Hadfield <j.hadfield at ed.ac.uk>:
> Hi,
>
> Sorry forgot that one. Have,
>
> us(at.level(trait,1)+at.level(trait,1):dens.surr):location
>
> instead of
>
> us(at.level(trait,1)):location
>
> but be careful, this is a complicated model.
>
> Cheers,
>
> Jarrod
>
>
>
>
>
>
> to the random model.
>
> Quoting Daniel Sol <dsolrueda at gmail.com> on Tue, 27 Nov 2012 15:13:29 +0100:
>
>> Dear Jarrod,
>>
>> many thanks for the rapid answer and very useful advice. Following
>> your advice, I'm gonna use the following code.
>>
>> zi.prior <-  list(R = list(V = diag(2), n = 0.002, fix = 2),
>>               G = list(G1 = list(V = 1, n = 0.002),
>>               G2 = list(V = 1, n = 0.002),
>>                    G3 = list(V = 1, n = 0.002),
>>                    G4 = list(V = 1, n = 0.002)))
>>
>> m2 <- MCMCglmm(abund.urb ~ trait-1 + at.level(trait,1):dens.surr,
>>                          random = ~idh(at.level(trait,1)):location      +
>>               idh(at.level(trait,1)):animal +
>>                                        idh(at.level(trait,1)):sp2 +
>>                                        us(mesd):units,
>>                                             rcov = ~ idh(trait):units,
>>                                        prior = zi.prior,
>>                                        pedigree=tr[[1]],
>>                                        data = dat0.phyl, family =
>> "zipoisson", verbose = TRUE,
>>                                        pr = FALSE, pl = FALSE)
>>
>> However, I'm still wondering how to run the same model allowing the
>> relationship between abundance in the city (abund.urb) and density in
>> the surrounding habitats (dens.surr) to vary across locations
>> (location) in both intercepts and slopes.
>>
>> Many thanks again,
>>
>> Dani
>>
>>
>> 2012/11/27 Jarrod Hadfield <j.hadfield at ed.ac.uk>:
>>>
>>> 1/3b You need to drop at.level(trait,1):location from the fixed model as
>>> you
>>> have it in the random part of the model (although this may just be a
>>> typo).
>>> I would also have trait-1 as you do not want the intercept for the
>>> Poisson
>>> process and the zero-inflation to be the same.
>>>
>>> 2. If you have many observations per species then I would put a
>>> non-phylogenetic species effect in too. If there are few (at the limit,
>>> only
>>> one) then it may be hard to separate the phylogenetic from the
>>> non-phylogenetic.
>>>
>>> 3a. this looks fine but make sure to put mesd in dat0.phyl (I presume
>>> this
>>> is the case otherwise MCMcglmm should spit an error, if it did not please
>>> tell me). Not sure how effort is measured, but you may not expect a
>>> linear
>>> relationship between 1/(effort) and the measurement error variance of the
>>> counts on the log scale. (I presume ** should be ^ in your code)
>>>
>>> 4. With  the 2x2 "idh" structure on the residuals I would use nu=0.002
>>> rather than nu=1.002. Only with a 2x2 "us" structure
>>> is the degree of belief for the marginal distribution of a single
>>> variance
>>> 0.002 when specifying nu=1.002. Parameter expanded priors might also be
>>> entertained for the random effect variances. They will also improve
>>> mixing
>>> if the varinaces are close to zero.
>>
>>
>>
>>
>> --
>> Daniel Sol
>> CREAF (Centre for Ecological Research and Applied Forestries)
>> CSIC (Centre for Advanced Studies of Blanes-Spanish National Research
>> Council)
>> Autonomous University of Barcelona, Bellaterra, Catalonia E-08193, Spain
>> TEL: +34 93-5814678
>> FAX: +34 93-5814151
>> E-MAIL: d.sol at creaf.uab.es
>>
>>
>
>
>
> --
> The University of Edinburgh is a charitable body, registered in
> Scotland, with registration number SC005336.
>
>



-- 
Daniel Sol
CREAF (Centre for Ecological Research and Applied Forestries)
CSIC (Centre for Advanced Studies of Blanes-Spanish National Research Council)
Autonomous University of Barcelona, Bellaterra, Catalonia E-08193, Spain
TEL: +34 93-5814678
FAX: +34 93-5814151
E-MAIL: d.sol at creaf.uab.es


From j.hadfield at ed.ac.uk  Tue Nov 27 15:35:14 2012
From: j.hadfield at ed.ac.uk (Jarrod Hadfield)
Date: Tue, 27 Nov 2012 14:35:14 +0000
Subject: [R-sig-ME] Zipoisson MCMCglmm for abundance data
In-Reply-To: <CAN3C_1AZ1TVrKy1m=QkDNeTgPMgiG_6SPkT7D6PZdsFAufCEhA@mail.gmail.com>
References: <CAN3C_1A8mQGHA++tiz_qV_Q1jBjZy0hZ00kr0OonGdDH8jVUSw@mail.gmail.com>
	<20121127134938.75921unhyjbjchy8@www.staffmail.ed.ac.uk>
	<CAN3C_1C=Jt0M6bEJCwk-vHaOwotci_w9HujjTmZ0uxFUHGrhyQ@mail.gmail.com>
	<20121127142801.51431vjqhu5n690k@www.staffmail.ed.ac.uk>
	<CAN3C_1AZ1TVrKy1m=QkDNeTgPMgiG_6SPkT7D6PZdsFAufCEhA@mail.gmail.com>
Message-ID: <20121127143514.16396tvrxvnfgyw4@www.staffmail.ed.ac.uk>

No problem. I read the Science paper last night - a great paper!

Quoting Daniel Sol <dsolrueda at gmail.com> on Tue, 27 Nov 2012 15:32:21 +0100:

> Great, Jarrod. Many thanks for all your help.
>
> Cheers,
>
> Dani
>
> 2012/11/27 Jarrod Hadfield <j.hadfield at ed.ac.uk>:
>> Hi,
>>
>> Sorry forgot that one. Have,
>>
>> us(at.level(trait,1)+at.level(trait,1):dens.surr):location
>>
>> instead of
>>
>> us(at.level(trait,1)):location
>>
>> but be careful, this is a complicated model.
>>
>> Cheers,
>>
>> Jarrod
>>
>>
>>
>>
>>
>>
>> to the random model.
>>
>> Quoting Daniel Sol <dsolrueda at gmail.com> on Tue, 27 Nov 2012 15:13:29 +0100:
>>
>>> Dear Jarrod,
>>>
>>> many thanks for the rapid answer and very useful advice. Following
>>> your advice, I'm gonna use the following code.
>>>
>>> zi.prior <-  list(R = list(V = diag(2), n = 0.002, fix = 2),
>>>               G = list(G1 = list(V = 1, n = 0.002),
>>>               G2 = list(V = 1, n = 0.002),
>>>                    G3 = list(V = 1, n = 0.002),
>>>                    G4 = list(V = 1, n = 0.002)))
>>>
>>> m2 <- MCMCglmm(abund.urb ~ trait-1 + at.level(trait,1):dens.surr,
>>>                          random = ~idh(at.level(trait,1)):location      +
>>>               idh(at.level(trait,1)):animal +
>>>                                        idh(at.level(trait,1)):sp2 +
>>>                                        us(mesd):units,
>>>                                             rcov = ~ idh(trait):units,
>>>                                        prior = zi.prior,
>>>                                        pedigree=tr[[1]],
>>>                                        data = dat0.phyl, family =
>>> "zipoisson", verbose = TRUE,
>>>                                        pr = FALSE, pl = FALSE)
>>>
>>> However, I'm still wondering how to run the same model allowing the
>>> relationship between abundance in the city (abund.urb) and density in
>>> the surrounding habitats (dens.surr) to vary across locations
>>> (location) in both intercepts and slopes.
>>>
>>> Many thanks again,
>>>
>>> Dani
>>>
>>>
>>> 2012/11/27 Jarrod Hadfield <j.hadfield at ed.ac.uk>:
>>>>
>>>> 1/3b You need to drop at.level(trait,1):location from the fixed model as
>>>> you
>>>> have it in the random part of the model (although this may just be a
>>>> typo).
>>>> I would also have trait-1 as you do not want the intercept for the
>>>> Poisson
>>>> process and the zero-inflation to be the same.
>>>>
>>>> 2. If you have many observations per species then I would put a
>>>> non-phylogenetic species effect in too. If there are few (at the limit,
>>>> only
>>>> one) then it may be hard to separate the phylogenetic from the
>>>> non-phylogenetic.
>>>>
>>>> 3a. this looks fine but make sure to put mesd in dat0.phyl (I presume
>>>> this
>>>> is the case otherwise MCMcglmm should spit an error, if it did not please
>>>> tell me). Not sure how effort is measured, but you may not expect a
>>>> linear
>>>> relationship between 1/(effort) and the measurement error variance of the
>>>> counts on the log scale. (I presume ** should be ^ in your code)
>>>>
>>>> 4. With  the 2x2 "idh" structure on the residuals I would use nu=0.002
>>>> rather than nu=1.002. Only with a 2x2 "us" structure
>>>> is the degree of belief for the marginal distribution of a single
>>>> variance
>>>> 0.002 when specifying nu=1.002. Parameter expanded priors might also be
>>>> entertained for the random effect variances. They will also improve
>>>> mixing
>>>> if the varinaces are close to zero.
>>>
>>>
>>>
>>>
>>> --
>>> Daniel Sol
>>> CREAF (Centre for Ecological Research and Applied Forestries)
>>> CSIC (Centre for Advanced Studies of Blanes-Spanish National Research
>>> Council)
>>> Autonomous University of Barcelona, Bellaterra, Catalonia E-08193, Spain
>>> TEL: +34 93-5814678
>>> FAX: +34 93-5814151
>>> E-MAIL: d.sol at creaf.uab.es
>>>
>>>
>>
>>
>>
>> --
>> The University of Edinburgh is a charitable body, registered in
>> Scotland, with registration number SC005336.
>>
>>
>
>
>
> --
> Daniel Sol
> CREAF (Centre for Ecological Research and Applied Forestries)
> CSIC (Centre for Advanced Studies of Blanes-Spanish National  
> Research Council)
> Autonomous University of Barcelona, Bellaterra, Catalonia E-08193, Spain
> TEL: +34 93-5814678
> FAX: +34 93-5814151
> E-MAIL: d.sol at creaf.uab.es
>
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>
>



-- 
The University of Edinburgh is a charitable body, registered in
Scotland, with registration number SC005336.


From seth at swbigelow.net  Tue Nov 27 16:11:09 2012
From: seth at swbigelow.net (Seth W. Bigelow)
Date: Tue, 27 Nov 2012 10:11:09 -0500
Subject: [R-sig-ME] R-squared in mixed model using nlme package
In-Reply-To: <CAMJSuH3QJo1xYLagy5FxELMkGXL15-L4Zxck+9Q=jF6B2aH=9A@mail.gmail.com>
References: <CAMJSuH3QJo1xYLagy5FxELMkGXL15-L4Zxck+9Q=jF6B2aH=9A@mail.gmail.com>
Message-ID: <003501cdccb1$703d36b0$50b7a410$@net>

Phuong, have you looked yet at http://glmm.wikidot.com/faq, section on 
"How do I compute a coefficient of determination (R 2  ), or an analogue,
for (G)LMMs?"

That is usually the first stop for mixed model R2 questions.
Best,
Seth




-----Original Message-----
From: r-sig-mixed-models-bounces at r-project.org
[mailto:r-sig-mixed-models-bounces at r-project.org] On Behalf Of Ho Ngoc
Phuong
Sent: Tuesday, November 27, 2012 7:35 AM
To: r-sig-mixed-models at r-project.org
Subject: [R-sig-ME] R-squared in mixed model using nlme package

Dear all,

I am fitting my data using nlme package. The syntax is as follow:
model<-lme(Energy efficiency ~ADF + CP + DE, random =~1|Study, data=phuong).
Can someone tell me how to find the R-squared for this model?. I've found
the lmmfit package of Aleksandra Maj (2011):
http://cran.r-project.org/web/packages/lmmfit/lmmfit.pdf
But there are several function to estimate R-squared. Could you please tell
me which one should I apply.

Thanks!
Phuong

	[[alternative HTML version deleted]]

_______________________________________________
R-sig-mixed-models at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models


From sroman at umassd.edu  Tue Nov 27 16:43:30 2012
From: sroman at umassd.edu (Sally A Roman)
Date: Tue, 27 Nov 2012 10:43:30 -0500 (EST)
Subject: [R-sig-ME] question about confidence intervals with glmmPQL
Message-ID: <1532292699.579849.1354031010011.JavaMail.root@umassd.edu>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121127/e2392416/attachment.pl>

From klipkhoon at gmail.com  Tue Nov 27 07:42:16 2012
From: klipkhoon at gmail.com (Lip Khoon Kho)
Date: Tue, 27 Nov 2012 14:42:16 +0800
Subject: [R-sig-ME] error message
Message-ID: <CAAu37_JjFM8_BFA8bZYHX6=J_ez-556wnR-x+1z3pfz0CAmCTA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121127/f7fc9b8f/attachment.pl>

From g.czanner at googlemail.com  Mon Nov 26 12:13:29 2012
From: g.czanner at googlemail.com (Gabriela Czanner)
Date: Mon, 26 Nov 2012 11:13:29 +0000
Subject: [R-sig-ME] Heteroscedastic variances of random error in lmer
Message-ID: <CAOQoCVugUO_6EcfDbW_8TRYF_orGW7-=hbv53uH1XsoV+phR_A@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121126/100c05e1/attachment.pl>

From Carl.Lamote at ppw.kuleuven.be  Tue Nov 27 16:57:24 2012
From: Carl.Lamote at ppw.kuleuven.be (Carl Lamote)
Date: Tue, 27 Nov 2012 15:57:24 +0000
Subject: [R-sig-ME] contrasts in lmer to test difference in growth models
Message-ID: <B73FF2DF7DFE6D44B1F56DA4F7E88F77111B7381@ICTS-S-MBX3.luna.kuleuven.be>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121127/9caf5054/attachment.pl>

From david.r.afshartous at vanderbilt.edu  Tue Nov 27 17:14:55 2012
From: david.r.afshartous at vanderbilt.edu (David Afshartous)
Date: Tue, 27 Nov 2012 10:14:55 -0600
Subject: [R-sig-ME] Heteroscedastic variances of random error in lmer
In-Reply-To: <CAOQoCVugUO_6EcfDbW_8TRYF_orGW7-=hbv53uH1XsoV+phR_A@mail.gmail.com>
References: <CAOQoCVugUO_6EcfDbW_8TRYF_orGW7-=hbv53uH1XsoV+phR_A@mail.gmail.com>
Message-ID: <50B4E6FF.2050806@vanderbilt.edu>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121127/f72a8cc4/attachment.pl>

From mintoc at mathstat.dal.ca  Tue Nov 27 18:31:38 2012
From: mintoc at mathstat.dal.ca (mintoc at mathstat.dal.ca)
Date: Tue, 27 Nov 2012 13:31:38 -0400 (AST)
Subject: [R-sig-ME] question about confidence intervals with glmmPQL
In-Reply-To: <1532292699.579849.1354031010011.JavaMail.root@umassd.edu>
References: <1532292699.579849.1354031010011.JavaMail.root@umassd.edu>
Message-ID: <21169.193.1.57.1.1354037498.squirrel@webmail.mathstat.dal.ca>

Hi Sally,

> For two models the CIs are not symmetrical around the mean proportion
from the model

The confidence intervals, as implemented in the code you sent, are
symmetric on the linear predictor (logit) scale and not necessarily
symmetric on the response scale.

Also, see Bolker et al. (2009) for a discussion of the performance of PQL
with low numbers of successes and failures; and Zeger et al. (1988) for
extracting marginal parameters in a logistic mixed model such as yours.

Best regards,
Coilin

Bolker, B.M., Brooks, M.E., Clark, C.J., Geange, S.W., Poulsen, J.R.,
Stevens, M.H.H., and White, J.S. (2009). Generalized linear mixed models:
a practical guide for ecology and evolution. Trends in Ecology and
Evolution, 24(3), 127-135.

Zeger, S.L., Liang, K.-Y. and Albert, P.S. (1988). Models for longitudinal
data: a generalized estimating equation approach. Biometrics, 44,
1019-1031.

> Hi - I am using R version 2.13.0. I have run several GLMMs using the
> glmmPQL function in the MASS package to model the proportion of fish
> caught in one net to the total caught in both nets by length for 5
> different species. I started with a polynomial regression full model with
> three length terms: l, l^2, and l^3 (l=length). The length terms and
> intercept were the fixed effects and the random effect was a paired haul
> (n=18).
>
> For the majority of the models, I ended up with a constant model with no
> length effect. I used a step wise backward selection for length terms and
> terms were removed if they were not significant.
>
> The issue I am having is with the confidence intervals that were
> calculated. For two models the CIs are not symmetrical around the mean
> proportion from the model. The CIs for the other constant models are
> symmetrical around the mean. I was wondering if anyone has an idea why
> this would be or if anyone has any suggestions.
>
> I provided a small sample of data for one species along with the CI,
> model, and plotting codes. I used some code that was passed to me from a
> colleague who got it from someone else. I have gone through the code to
> understand it, but got stuck on a couple of areas. I did not hear back
> from the original person who wrote the code.
>
> #subsample of data
> Pair Species Length Experimental Control Proportion second third
> 2 Monkfish 23 0 1 0 529 12167
> 2 Monkfish 27 0 1 0 729 19683
> 7 Monkfish 27 0 2 0 729 19683
> 8 Monkfish 27 0 1 0 729 19683
> 14 Monkfish 28 1 0 1 784 21952
> 13 Monkfish 29 0 1 0 841 24389
> 14 Monkfish 29 0 1 0 841 24389
> 1 Monkfish 30 0 1 0 900 27000
> 5 Monkfish 30 0 2 0 900 27000
> 18 Monkfish 30 1 0 1 900 27000
> 4 Monkfish 31 1 0 1 961 29791
> 5 Monkfish 31 0 1 0 961 29791
> 11 Monkfish 31 0 1 0 961 29791
> 2 Monkfish 32 0 1 0 1024 32768
> 11 Monkfish 32 0 1 0 1024 32768
> 12 Monkfish 32 0 1 0 1024 32768
> 18 Monkfish 32 1 1 0.5 1024 32768
> 4 Monkfish 34 0 1 0 1156 39304
> 17 Monkfish 34 0 1 0 1156 39304
> 18 Monkfish 34 0 1 0 1156 39304
> 18 Monkfish 35 0 1 0 1225 42875
> 1 Monkfish 37 0 1 0 1369 50653
> 2 Monkfish 40 1 0 1 1600 64000
> 14 Monkfish 40 0 1 0 1600 64000
> 18 Monkfish 40 1 0 1 1600 64000
>
>
> This is my model code
> #Models
> #Select trip
> t<-t1
> #select species
> species<-subset(t,Species=="Monkfish")
> #define polynomials
> #2nd order poly
> second<-species$Length^2
> #3rd order poly
> third<-species$Length^3
> #combine species,second & third
> species<-cbind(species,second,third)
>
> #backward selection
> #full model
> m1<-glmmPQL(fixed=Proportion~1+Length+second+third,random=~1|Pair,family=binomial,data=species,verbose=T,niter=2,weight=(Experimental+Control))
> summary(m1)
> #2nd order
> m2<-update(m1, . ~. -third)
> summary(m2)
> #linear
> m3<-update(m2, . ~. -second)
> summary(m3)
> #constant
> m4<-update(m3, . ~. -Length)
> summary(m4)
>
>
> Here is the code for a constant model -
>
> #CIs
> get.sel.and.conf.band.catch=function(parm,varm,l.min,l.max,n=200){
> lgt<-seq(l.min,l.max,length=n)
> X=sapply(1:length(parm),function(i){lgt^(i-1)})
> reg.line=X%*%parm
> se=apply(X,1,function(x,varm){sqrt(t(x)%*%varm%*%x)},varm)
> cbind(lengtht=lgt,min.L50=reg.line-2*se,mean.L50=reg.line,max.L50=reg.line+2*se)
> }
>
> #plots model results
> plot.fit=function(glmm.fit,limx,Spec.Text){
> varm=glmm.fit$varFix
> coeff=glmm.fit$coeff$fixed
> eta.matrix=get.sel.and.conf.band.catch(coeff,varm,min(limx),max(limx))
> xxx=c(eta.matrix[,1],rev(eta.matrix[,1]))
> yyy=c(ilogit(eta.matrix[,2]),rev(ilogit(eta.matrix[,4])))
> plot(eta.matrix[,1],ilogit(eta.matrix[,3])
> ,type="l"
> ,xlab="Length (cm)"
> ,ylab="Proportion: exp/(exp+control)"
> ,ylim=c(0,1), xlim=limx
> ,col="black",lwd=2,las=1
> ,axes=FALSE
> ,family="serif")
> axis(1,labels=T,cex.axis=0.9)
> #axis(3,labels=TRUE,cex.axis=0.9)
> axis(2,labels=TRUE,las=2,cex.axis=0.9)
> box()
> lines(eta.matrix [,1],ilogit(eta.matrix [,2]),col=4)
> lines(eta.matrix[,1],ilogit(eta.matrix[,4]),col=2)
> polygon(xxx,yyy,col="grey",density=NULL,border="black")
> lines(eta.matrix[,1],ilogit(eta.matrix[,3]),col=1,lwd=2)
> abline(h=0.5,lty=2)
> text(sum(limx)/2,0.9,Spec.Text,cex=1)
> }
>
> #model plot code
> plot.fit(m4,c(min(species$Length),max(species$Length)),paste(unique(species$Species)))
>
> I looked at other code online from Daniel Hocking and Ben Bolker at
> glmm.wikidot.com. There are differences between what I received and the
> examples from Daniel and Ben.
>
> Any help would be appreciated.
> Thanks Sally
>
> --
>
> Sally Roman
> Fisheries Biologist
> University of Massachusetts Dartmouth
> School for Marine Science and Technology
> 200 Mill Road Suite 325
> Fairhaven, MA 02917
> phone 508-910-6379
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>


From bbonit at tin.it  Tue Nov 27 18:57:52 2012
From: bbonit at tin.it (Bonitta Gianluca)
Date: Tue, 27 Nov 2012 17:57:52 +0000 (UTC)
Subject: [R-sig-ME] Likelihood
Message-ID: <loom.20121127T155841-214@post.gmane.org>

Hello my names is Bonitta Gianluca a statistics student from Italy. 
Im starting C++ programming. I would ask if someone have modified lme4 R pack 
source code for returning likelihood or (loglike) function for linear mixed 
model. If yes, can show me this please. I will use this likelihood for build 
up posterior density for MCMC simulation. I need to calculate likelihood not 
only into maximum estimate paramer value, but i need calculation of likelihood 
for all value that MCMC sampling need. Thanks in advance, sorry for noise.
Best
Bonitta


From kw.stat at gmail.com  Tue Nov 27 21:27:08 2012
From: kw.stat at gmail.com (Kevin Wright)
Date: Tue, 27 Nov 2012 14:27:08 -0600
Subject: [R-sig-ME] Likelihood
In-Reply-To: <loom.20121127T155841-214@post.gmane.org>
References: <loom.20121127T155841-214@post.gmane.org>
Message-ID: <CAKFxdiRpNyd9s9-+FAU5VE09VExF+c-1ctPpZc=y60zsLvnjPQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121127/4a36a4d5/attachment.pl>

From bbonit at tin.it  Tue Nov 27 22:52:10 2012
From: bbonit at tin.it (Bonitta Gianluca)
Date: Tue, 27 Nov 2012 21:52:10 +0000 (UTC)
Subject: [R-sig-ME] Likelihood
References: <loom.20121127T155841-214@post.gmane.org>
	<CAKFxdiRpNyd9s9-+FAU5VE09VExF+c-1ctPpZc=y60zsLvnjPQ@mail.gmail.com>
Message-ID: <loom.20121127T224831-798@post.gmane.org>



Thank you for replay my proble is how to suite lme4 (that calculate loglike 
into maxium likelihood value) for have a flexible tool (wrote by professor 
Bates ( so an efficent tool) for build up the likelihood for posterior MCMC


From larodwyer at gmail.com  Wed Nov 28 00:10:39 2012
From: larodwyer at gmail.com (Laurence O'Dwyer)
Date: Wed, 28 Nov 2012 00:10:39 +0100
Subject: [R-sig-ME] mixed effects models and multiple explanatory
	variables that are correlated
In-Reply-To: <CACp2W9DWBH0EeRz4G=toOmLfJvydLWAAO12Lj+ignrFV2t7SEA@mail.gmail.com>
References: <CACp2W9DWBH0EeRz4G=toOmLfJvydLWAAO12Lj+ignrFV2t7SEA@mail.gmail.com>
Message-ID: <CACp2W9CeK5vMtPQpbegt=AVGK9ZipwgL7A2f+BsdzY8Nf2t56A@mail.gmail.com>

Hi Jarrod,
              Thanks for the notes.
Relating to what I want the model to look like; I am interested in modelling
autism scores (response variable) as a function of anatomical
structures (Striatum, Amygdala,
etc.), and ADHD diagnosis (with three levels for the Diagnosis factor:
con, unaffected sibling,
ADHD).

Autism scores are elevated in the ADHD group, and with the aid of an
MCMCglmm model,
I would like to identify the anatomical structures that may be
important in influencing
raised autism scores. In order to focus specifically on the autism
phenotype, I would
also like to control for the levels of ADHD within each subject
(ADHD_symptom_scores).

In light of the earlier suggestions, I now use Age and Gender as fixed effects.
Relating to Alan's comment about the "scanner_binary" - I was worried about
the variance in anatomical volumes that might be attributable to the
use of two different
scanners. Actually, it is negligible for structural volumes - but I
have data from another
imaging modality (diffusion tensor imaging) where there are
troublesome differences
in the diffusion values depending on the scanner type; for example,
the mean diffusion
of all controls scanned on scanner_1 is significantly higher than the
mean diffusion
of all controls scanned on scanner_2. For future models, I wanted to
know how best
to deal with these scanner differences.

So, trying to adapt the model, I am now looking at:


i.moo = MCMCglmm(Autism_score ~ Diagnosis + Striatum + Amygdala + Hippocampus

   + age + Gender,

random=~idh(sqrt(ADHD_symptom_score)):units +
                                          rcov=~idh(scanner_binary):units,
                                          data=dat)

As stated previously, the random effects term allows residual variance
to change according to
v1+ADHD_symptom_scores*v2  where v1 is the units variance and v2 is
the variance
associated with the random term.

This model produces a significant main effect of Striatum. However,
I'm not clear if the
random effect term means that differences in ADHD_symptom_scores
between subjects
are controlled for. If they are not controlled for, then a negative
correlation between the
volume of the Striatum and Autism_score may also be explained by the
high ADHD_score
in subjects that have a high Autism_score. I am particularly
interested in isolating
the structural correlates that are unique to Autism_score and was
hoping that an
appropriate random effects term would allow me to get at that point.

Any pointers are much appreciated as is your patience in dealing with
the beginner
nature of the questions.

Cheers; Larry


On Tue, Nov 27, 2012 at 11:07 AM, Jarrod Hadfield <j.hadfield at ed.ac.uk> wrote:
> HI Larry,
>
> Its not clear to me exactly what you want the model to look like, but I'm
> fairly certain the model you have specified in MCMCglmm (or the lmer
> equivalent does) is not going to make much sense.
>
> It is the effects that are random not the predictors. If you have a
> continuous predictor you have a single effect, and so estimating the
> variance of the effect is a non-starter. You should treat the effect as
> fixed. MCMCglmm (and lmer) I believe will convert your continuous variable
> into a factor if you specify it as ~ADHD_symptom_scores+... and then you
> will end up with as many effects as there are unique values. Estimating the
> variance of these effects is possible, but is it meaningful? Probably not.
>
> Categorical predictors with 2 levels (e.g. scanner_binary) suffer the same
> problem - the precision on the variance component will be so poor (and
> presumably the replication for each level so high) that you might as well
> treat the effects as fixed.
>
> Alan seems to think that you want to model the fact that the variance in the
> response is non-constant between groups (or as a function of a covariate).
> Is this true? If it is then rcov=~idh(scanner_binary):units will allow the
> residual variance to vary between the two groups.
> random=~idh(sqrt(ADHD_symptom_scores)):units  allows the residual variance
> to change according to v1+ADHD_symptom_scores*v2  where v1 is the units
> variance and v2 is the variance associated with the random term.
>
> Cheers,
>
> Jarrod
>
>
>
>
> Quoting Alan Haynes <aghaynes at gmail.com> on Tue, 27 Nov 2012 10:01:07 +0100:
>
>> Hi Larry,
>>
>> I dont know how MCMCglmm handles the REs in terms of random slopes and/or
>> intercepts so others will be able to provide better advice with regards
>> your continuous variables.
>>
>> Does your scanner actually affect the variance? You could visually check
>> this and if not add it as a main effect...this is quite often recommended
>> for factors with only a couple of levels. The same would go for age and
>> gender.
>>
>> You might find http://glmm.wikidot.com/faq useful. This has sections on
>> whether or not to use something as a fixed or RE, assessing REs and loads
>> of other stuff relating to [G]LMMs.
>>
>> HTH
>>
>> Alan
>>
>>
>>
>> --------------------------------------------------
>> Email: aghaynes at gmail.com
>> Mobile: +41794385586
>> Skype: aghaynes
>>
>>
>> On 26 November 2012 17:07, Laurence O'Dwyer <larodwyer at gmail.com> wrote:
>>
>>> Hi Alan and Alain,
>>>                           I see that you might want to have >10 subjects
>>> within
>>> each level of a factor that is constructed by making one level for
>>> each combination
>>> of the random effects.
>>> However, I have 3 REs that are continuous variables:
>>> age, ADHD_symptom_scores, TBV[Total_Brain_Volume].
>>> So, in that situation, I'm not sure how to calculate what you suggest
>>> unless I transform them into categorical variables, e.g.:
>>> dat$age_5_levels = cut(dat$age, 5)
>>> In that situation I would most likely have <10 subjects in some
>>> of the levels of a factor that is constructed by making levels from
>>> each combination of the REs.
>>>
>>> Age and gender, are not significantly different between experimental
>>> groups
>>> in this dataset, so I experimented with excluding them from the REs.
>>> I very much wanted to control for ADHD symptoms in the REs, as this
>>> was the whole idea of the model; i.e. to try to isolate autistic traits
>>> within ADHD subjects, and determine to what extent these traits
>>> are influenced by particular anatomical structures when the ADHD
>>> symptom levels are controlled for in the REs.
>>>
>>> So, trying to eliminate unnecessary REs (age and gender), the model is:
>>>
>>> another.moo = MCMCglmm(autism_spectrum_scores ~ Diagnosis + Striatum +
>>> Amygdala + Hippocampus,
>>>                                           random = ~ADHD_symptom_scores
>>>                                                     + scanner_binary
>>>                                                     + TBV,
>>>                                           data=dat)
>>>
>>> I would like to keep total brain volume (TBV: a continuous variable),
>>> and scanner type (scanner_binary: 0 or 1, for two different scanner
>>> types) as REs.
>>> These variables are significantly different between experimental groups.
>>>
>>> For the above model, again, I'd be grateful for any pointers regarding
>>> how
>>> to
>>> assess or improve it's validity.
>>> Apologies for the necessary hand holding.
>>>
>>> Thanks; Larry
>>>
>>>
>>> On Mon, Nov 26, 2012 at 1:47 PM, Alan Haynes <aghaynes at gmail.com> wrote:
>>> > I think that part of what Alain was getting at was that random effects
>>> > require quite a few levels to calculate the variance, so RE such as age
>>> are
>>> > generally not recommended - you get a bad estimate of the variance from
>>> > 2
>>> > points.
>>> >
>>> > I think he's also suggesting that with only 170 data points, the
>>> likelihood
>>> > of overfitting is quite high when you have so many variables in your
>>> models.
>>> > If you made a factor with one level for each combination of your random
>>> > effects, how many datapoints would fall into each category? Ive heard
>>> > it
>>> > suggested that fewer than 10 and you'll probably start running into
>>> > difficulty...dont remember where from though I'm afraid...
>>> >
>>> > HTH
>>> >
>>> > Alan
>>> >
>>> > --------------------------------------------------
>>> > Email: aghaynes at gmail.com
>>> > Mobile: +41794385586
>>> > Skype: aghaynes
>>> >
>>> >
>>> > On 26 November 2012 12:58, Laurence O'Dwyer <larodwyer at gmail.com>
>>> > wrote:
>>> >>
>>> >> Hi Alain,
>>> >>              Thank you for the reply. As a follow-up, I have a
>>> >> question or two relating to your pointers and suggestions.
>>> >>
>>> >> >>
>>> >> >> Hello to mixed-effects model experts,
>>> >> >>
>>> >> >>                                                         I am
>>> currently
>>> >> >> trying to run an analysis on structural MRI data and would like to
>>> use
>>> >> >> glmer or MCMCglmm to model my data. I have basic statistical
>>> knowledge
>>> >> >> and
>>> >> >> would appreciate any guidance in the use of these R-tools from
>>> experts
>>> >> >> in
>>> >> >> mixed effects models.
>>> >> >>
>>> >> >>                  In a crude way, I am interested in a model that
>>> might
>>> >> >> look
>>> >> >> something like the following:
>>> >> >>
>>> >> >>
>>> >> >>
>>> >> >> moo = MCMCglmm(autism_spectrum_scores ~ Diagnosis + Striatum +
>>> Thalamus
>>> >> >> +
>>> >> >> Amygdala + Hippocampus,
>>> >> >>
>>> >> >>                                            random =
>>> >> >> ~ADHD_symptom_scores
>>> >> >>
>>> >> >>                                                      + age
>>> >> >>
>>> >> >>                                                      + scanner_type
>>> >> >>
>>> >> >>                                                      + gender
>>> >> >>
>>> >> >>                                                      +
>>> >> >> total_brain_volume,
>>> >> >>
>>> >> >>                                            data=dat)
>>> >> >>
>>> >> >>
>>> >> >
>>> >> >
>>> >> > Are you using gender as random effect?
>>> >> >
>>> >>
>>> >> Yes, I am using gender as a random variable, as there are differences
>>> >> (although non-significant) in the ratio of Males:Females in each
>>> >> experimental group.
>>> >>
>>> >> >> It is a study of ADHD and autism. I have data for ~170 children
>>> >> >> with
>>> >> >> ADHD,
>>> >> >> ~70 unaffected siblings, and ~80 controls - this is the fixed
>>> >> >> factor
>>> >> >> "Diagnosis".
>>> >> >>
>>> >> >> I have the volumes of particular structures in the brain. These are
>>> the
>>> >> >> fixed factors Striatum, Thalamus, etc. I am interested to know
>>> >> >> their
>>> >> >> relationship with a scale of autistic traits (NOT ADHD traits)
>>> >> >> within
>>> >> >> all
>>> >> >> experimental groups. For example, smaller volumes in the Striatum
>>> >> >> may
>>> >> >> be
>>> >> >> associated with increased autistic traits.
>>> >> >>
>>> >> >> For the random effects, I want to control for differences in ADHD
>>> >> >> symptoms,
>>> >> >> age, scanner type (two different scanners were used to collect the
>>> >> >> volumetric data), gender and total brain volume.
>>> >> >
>>> >> > Yes you do. That is not a good idea. You may want to read a little
>>> >> > bit
>>> >> > on mixed modelling before doing this. Your model is overly
>>> >> > complicated
>>> >> > for 170 observations. I actually wonder whether this is mixed
>>> >> > effects
>>> >> > modelling; do you have multiple observations per child? If
>>> >> > not...then
>>> it
>>> >> > seems ordinary linear regression?
>>> >>
>>> >>
>>> >> Sorry, I am not clear here on what you are referring to as "not a good
>>> >> idea"?
>>> >> Each child underwent scanning. There are multiple observations (MRI
>>> >> volumetrics,
>>> >> as well as symptom counts from diagnostic questionnaires), for all
>>> >> children.
>>> >> I felt mixed-effects models would be most effective and robust in this
>>> >> situation
>>> >> as I am interested to know how the fixed effects influence the
>>> >> response variable,
>>> >> while controlling for a range of random effects that influence the
>>> >> variance of the response.
>>> >> This analysis also ties in with earlier work assessing the
>>> >> relationship
>>> >> between
>>> >> autism scores and total brain white matter volume and total brain grey
>>> >> matter volume,
>>> >> for which mixed-effects models were quite informative. MCMC was used,
>>> >> as the explanatory
>>> >> variables are not normally distributed.
>>> >>
>>> >>
>>> >> As suggested, I simplified the model and looked at the VIFs. I now
>>> >> have 3 Fixed Effects with GVIFs:
>>> >> Striatum    1.507092
>>> >> Amygdala    1.281519
>>> >> Hippocampus 1.557735
>>> >>
>>> >>
>>> >> So, I would like to know if the resulting model could be considered
>>> >> statistically sound, or if there are still gaping
>>> >> holes in its statistical credibility:
>>> >>
>>> >> try.5 = MCMCglmm(ASD_spectrum_VISK ~ Diagnosis_Simple + Striatum +
>>> >> Amygdala + Hippocampus,
>>> >>                                           random =
>>> >> ~Combined_Symptoms_inatt_plus_hyper
>>> >>                                                     + age
>>> >>                                                     + scanner_binary
>>> >>                                                     + Gender
>>> >>                                                     + TBV,
>>> >>                                           data=dat)
>>> >>
>>> >>
>>> >> This leads to a result that can be reasonably well interpreted
>>> >> biologically and which is in line with
>>> >> the study hypothesis: ADHD diagnosis has significant effect on the
>>> >> autism score, and Striatal volume (p=0.078)
>>> >> has a borderline significant effect on autism score.
>>> >>
>>> >> I am particularly keen to know if my attempts to control for ADHD
>>> >> symptoms, as well as age, scanner type, etc., are adequately
>>> >> dealt with in the random effects section, or whether or not I need to
>>> >> look into the specification of a prior which is noted in some of the
>>> >> MCMCglmm documentation.
>>> >>
>>> >> Any advice is greatly appreciated.
>>> >>
>>> >> With thanks; Larry
>>> >>
>>> >>
>>> >> >> A key point of the analysis would be to establish the relationship
>>> >> >> between
>>> >> >> structural volumes and autistic scores, when levels of ADHD have
>>> >> >> been
>>> >> >> controlled for.
>>> >> >>
>>> >> >> One problem is that all the structural volumes are closely
>>> correlated.
>>> >> >> Previously, when working with two structural volumes that were
>>> >> >> correlated,
>>> >> >> I used the regression residuals of one structural volume relative
>>> >> >> to
>>> >> >> the
>>> >> >> other to isolate the unique contribution of each explanatory
>>> variable,
>>> >> >> independent from what was shared between them. But, I don't think I
>>> can
>>> >> >> use
>>> >> >> this approach with four structures that are highly correlated.
>>> >> >>
>>> >> >>                  There are probably many other statistical flies in
>>> the
>>> >> >> ointment relating to the above. If anyone has any pointers as to
>>> >> >> how
>>> to
>>> >> >> deal with the situation when multiple explanatory variables are
>>> >> >> correlated,
>>> >> >
>>> >> > dump some of them...after making scatterplots, and calculate VIF
>>> values.
>>> >> > Or use them, and accept that SEs will be blown up.
>>> >> >
>>> >> > Kind regards,
>>> >> >
>>> >> > Alain
>>> >> >> in a mixed-effects models framework, they would be appreciated.
>>> >> >>
>>> >> >>                  Thanks; Larry
>>> >> >>
>>> >>
>>> >> _______________________________________________
>>> >> R-sig-mixed-models at r-project.org mailing list
>>> >> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>> >
>>> >
>>>
>>
>>         [[alternative HTML version deleted]]
>>
>>
>> _______________________________________________
>> R-sig-mixed-models at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>
>>
>
>
>
> --
> The University of Edinburgh is a charitable body, registered in
> Scotland, with registration number SC005336.
>
>


From bbolker at gmail.com  Wed Nov 28 05:02:39 2012
From: bbolker at gmail.com (Ben Bolker)
Date: Wed, 28 Nov 2012 04:02:39 +0000 (UTC)
Subject: [R-sig-ME] Likelihood
References: <loom.20121127T155841-214@post.gmane.org>
	<CAKFxdiRpNyd9s9-+FAU5VE09VExF+c-1ctPpZc=y60zsLvnjPQ@mail.gmail.com>
	<loom.20121127T224831-798@post.gmane.org>
Message-ID: <loom.20121128T050133-771@post.gmane.org>

Bonitta Gianluca <bbonit at ...> writes:

> 
> 
> Thank you for replay my proble is how to suite lme4 (that calculate loglike 
> into maxium likelihood value) for have a flexible tool (wrote by professor 
> Bates ( so an efficent tool) for build up the likelihood for posterior MCMC
> 

  Take a look at the development version of lme4 (on R-forge, very
most recent version on github), which has a 'devFunOnly' argument which
returns a deviance function ...


From bbolker at gmail.com  Wed Nov 28 05:12:09 2012
From: bbolker at gmail.com (Ben Bolker)
Date: Wed, 28 Nov 2012 04:12:09 +0000 (UTC)
Subject: [R-sig-ME] error message
References: <CAAu37_JjFM8_BFA8bZYHX6=J_ez-556wnR-x+1z3pfz0CAmCTA@mail.gmail.com>
Message-ID: <loom.20121128T050420-834@post.gmane.org>

Lip Khoon Kho <klipkhoon at ...> writes:

> 
> Hi all,
> 
> I've just started with glmm and have been working on my data for soil
> respiration. The data is a continuous soil respiration measured over time
> on different treatments (Control, Litter, Root, SOM, and Myc). I've made a
> reproducible sample subset of data.
> 
sample.glmm2<-structure(list(Rep = structure(c(1L, 1L, 2L, 3L, 2L, 3L, 2L,
1L, 1L, 1L, 2L, 3L, 3L, 2L, 1L, 1L, 1L, 1L, 1L, 1L), .Label = c("T1",
"T2", "T3"), class = "factor"), Port = c(4L, 4L, 3L, 2L, 1L,
4L, 4L, 1L, 3L, 4L, 2L, 2L, 4L, 4L, 3L, 4L, 3L, 1L, 3L, 3L),
    Time = c(40103.23538, 40196.53689, 40015.52118, 40191.30837,
    40131.5086, 40191.21449, 40130.82421, 40146.25, 40071.55473,
    40101.5565, 40132.45973, 40136.52361, 40065.7656, 40056.5364,
    40142.20439, 40032.0448, 40075.73726, 40011.48273, 40143.37164,
    40122.35059), Lin_Flux = c(4.69, 2.4, 7.87, 11.05, 6.94,
    7.2, 3.33, 7.92, 5.28, 4.83, 1.95, 8.29, 9.79, 6.74, 1.37,
    4.95, 2.37, 7.24, 1.73, 2.33), temp = c(24.661, 22.555, 25.993,
    24.59, 24.21, 23.784, 25.991, 22.719, 25.75, 24.992, 25.057,
    25.977, 26.015, 26.558, 23.837, 25.742, 22.652, 25.096, 24.186,
    25.561), Moist = c(53.12073034, 73.17318785, 10.85104703,
    32.32684789, 68.78023321, 47.22009228, 70.96981555, 252.2126268,
    60.74723213, 49.6945396, 61.99900286, 60.96778851, 45.67500636,
    48.84389487, 80.87678452, 43.51131005, 65.55899378, 3.546478647,
    77.23567152, 64.29384304), Lit = c(0L, 0L, 0L, 0L, 1L, 0L,
    0L, 1L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 1L, 0L, 0L),
    Root = c(1L, 1L, 0L, 0L, 1L, 1L, 1L, 1L, 0L, 1L, 0L, 0L,
    1L, 1L, 0L, 1L, 0L, 1L, 0L, 0L), SOM = c(1L, 1L, 1L, 1L,
    1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L,
    1L), Myc = c(1L, 1L, 1L, 0L, 1L, 1L, 1L, 1L, 1L, 1L, 0L,
    0L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L)), .Names = c("Rep", "Port",
"Time", "Lin_Flux", "temp", "Moist", "Lit", "Root", "SOM", "Myc"), 
row.names = c(7031L, 2139L, 28270L, 30410L, 18838L, 30448L,
19109L, 2343L, 10930L, 7714L, 18455L, 32126L, 36769L, 24979L,
3783L, 14847L, 9266L, 17254L, 3313L, 5315L), class = "data.frame")
> 
> As for the Litter, SOM, Myc, and Root - 1 denotes respiration contribution
> to Lin_Flux, while 0 denotes that the components does not contribute to
> Lin_Flux.
> 
> I've tried to fit a model for Rep (repilcate) and Time as random effects
> using lmer. For example:
>

library(lme4)
glmm.model1 <- lmer(Lin_Flux ~ temp + Moist + Port + Lit + Root +
 (Time|Rep), data=sample.glmm2)
 
> I obtained output. However, when i try to include SOM and Myc, as follow:
> 

glmm.model1 <- lmer(Lin_Flux ~ temp + Moist + Port + Lit + Root + SOM + Myc +
 (Time|Rep), data=sample.glmm2)

With the most recent development version:

  ## rank of X = 6 < ncol(X) = 8

mm <- model.matrix(~ temp + Moist + Port + Lit + Root + SOM + Myc - 1,
data=sample.glmm2)

image(cov2cor(var(mm[,-1])))

summary(mm[,"SOM"])

  All of your SOM values are identical!
  You may find svd() useful as well.

mm2 <- model.matrix(~ temp + Moist + Port + Lit + Root +  Myc ,
data=sample.glmm2)

  Works fine without SOM.
> 
> I get error message:
> Error in mer_finalize(ans) : Downdated X'X is not positive definite, 6.
> 
> Is this due to singularity?
> If so, is there a way to go around this? I've come across a few of these
> problems - and perhaps the way to do this is to remove the singularities?
> Does this mean, to remove the predictor?


  As a side point, you shouldn't use "family" with lmer.


From m.fairbrother at bristol.ac.uk  Wed Nov 28 13:15:40 2012
From: m.fairbrother at bristol.ac.uk (Malcolm Fairbrother)
Date: Wed, 28 Nov 2012 12:15:40 +0000
Subject: [R-sig-ME] contrasts in lmer to test difference in growth models
In-Reply-To: <mailman.8585.1354046704.4555.r-sig-mixed-models@r-project.org>
References: <mailman.8585.1354046704.4555.r-sig-mixed-models@r-project.org>
Message-ID: <7FD45476-5E97-4225-89B9-5B2768116307@bristol.ac.uk>

Dear Carl,

My instinct would be to use a parametric bootstrap on your model, then calculate/plot 95% confidence intervals for the expected performance of students with different treatments over time.

It's not hard, and wouldn't take long with your data and model. You can use the "refit" and "simulate" functions, calculate expected performance using the parameter estimates generated by each bootstrap, and then take the 2.5th and 97.5th percentiles. This would be good way to report your model results anyway.

Just as another observation, if you only have three time points, you might model time as a factor rather than a continuous variable. This will increase the number of interaction terms, but might reveal non-linear time effects.

Hope this helps.

Cheers,
Malcolm




> Date: Tue, 27 Nov 2012 15:57:24 +0000
> From: Carl Lamote <Carl.Lamote at ppw.kuleuven.be>
> To: "r-sig-mixed-models at r-project.org"
> 	<r-sig-mixed-models at r-project.org>
> Subject: [R-sig-ME] contrasts in lmer to test difference in growth
> 	models
> Message-ID:
> 	<B73FF2DF7DFE6D44B1F56DA4F7E88F77111B7381 at ICTS-S-MBX3.luna.kuleuven.be>
> 	
> Content-Type: text/plain
> 
> Dear R-mixed models members,
> 
> For my PhD, I'm working with multilevel models on educational data. However, I'm struggling with some basic concepts and implementations in R (I'm used to MLwiN). Basically, I'm trying to estimate the effect of grade retention on achievement in the years after grade retention. I split up the 'grade retention' into several conditions (reflecting the situation in Flanders, Belgium). A short summary of what I'm doing:
> 
> Dependent variable: NL (language achievement)
> Independent variable: TIME (0,1,2), treat (0,1,2,3).
> Following Singer & Willett (2003), I nested the 'time' into the students (IDlln) and students into schools (SCHOOL). The - very simple - example model looks as follows (I first did a propensity score matching and work with the weights of the MatchIt package, but that is not important in this example):
> 
> Model1=lmer(NL~1+TIME*factor(treat)+(1|IDlln)+(1|SCHOOL),data=datagroei.dat,REML=FALSE)
> 
> I get the following output:
> 
> Formula: NL ~ 1 + TIME * factor(treat) + (factor(treat)/TIME) + (1 | IDlln) +      (1 | SCHOOL)
>   Data: datagroei.dat
>  AIC  BIC logLik deviance REMLdev
> 7523 7592  -3750     7501    7536
> Random effects:
> Groups   Name        Variance Std.Dev.
> IDlln    (Intercept) 0.17087  0.41337
> SCHOOL   (Intercept) 0.21577  0.46451
> Residual             0.29760  0.54553
> Number of obs: 4144, groups: IDlln, 1595; SCHOOL, 48
> 
> Fixed effects:
>                    Estimate Std. Error t value
> (Intercept)         -0.75356    0.07910  -9.527
> TIME                -0.10915    0.02055  -5.311
> factor(treat)1      -0.24797    0.05480  -4.525
> factor(treat)2      -0.06242    0.07868  -0.793
> factor(treat)3      -0.22599    0.08254  -2.738
> TIME:factor(treat)1  0.10704    0.02474   4.326
> TIME:factor(treat)2 -0.24052    0.05300  -4.538
> TIME:factor(treat)3 -0.37148    0.06052  -6.139
> 
> Correlation of Fixed Effects:
>            (Intr) TIME   fct()1 fct()2 fct()3 TIME:()1 TIME:()2
> TIME        -0.241
> factr(trt)1 -0.374  0.347
> factr(trt)2 -0.267  0.243  0.399
> factr(trt)3 -0.251  0.233  0.347  0.244
> TIME:fct()1  0.199 -0.831 -0.409 -0.201 -0.192
> TIME:fct()2  0.093 -0.388 -0.134 -0.479 -0.086  0.322
> TIME:fct()3  0.090 -0.339 -0.122 -0.087 -0.395  0.282    0.131
> 
> My question now is very simple: although I know the difference in growth of the treatment-groups compared to the reference group and whether this growth is significant (which it is). But I also want to test whether these treatment group differ at the last time point (at time 2); whether treatment group 2 has a significantly higher score at Time 2 compared to treatment group 3 (or 1). This sounds like I'll need to test for contrasts, isn't it? For the last two days, I read a lot about these contrasts, but I have still no clue on how to implement these in my model. Or is there a more easy answer to my question?
> 
> The (example) data can be found at: https://perswww.kuleuven.be/~u0064197/Growth_upload.txt.
> 
> Thank you in advance!
> 
> Kind regards,
> Carl Lamote
> 
> PS: I hope I followed all the forum-rules in describing the situation and providing the dataset? If not, please say so!


From Paul.Johnson at glasgow.ac.uk  Wed Nov 28 13:34:01 2012
From: Paul.Johnson at glasgow.ac.uk (Paul Johnson)
Date: Wed, 28 Nov 2012 12:34:01 +0000
Subject: [R-sig-ME] A Unifying Model for the Analysis of Phenotypic, Genetic,
 and Geographic Data
In-Reply-To: <loom.20121128T050420-834@post.gmane.org>
References: <CAAu37_JjFM8_BFA8bZYHX6=J_ez-556wnR-x+1z3pfz0CAmCTA@mail.gmail.com>
	<loom.20121128T050420-834@post.gmane.org>
Message-ID: <156FA9B609FA8F409121FB91C13E93DB634EDF1CB3@rcb-exserv.rcbdomain.com>

This might interest some of the more genetic mixed modellers...



http://www.ncbi.nlm.nih.gov/pubmed/22398122

Syst Biol. 2012 Dec 1;61(6):897-911. Epub 2012 Mar 6.

A Unifying Model for the Analysis of Phenotypic, Genetic, and Geographic Data.

Guillot G, Renaud S, Ledevin R, Michaux J, Claude J.

Abstract

Recognition of evolutionary units (species, populations) requires integrating several kinds of data, such as genetic or phenotypic markers or spatial information in order to get a comprehensive view concerning the differentiation of the units. We propose a statistical model with a double original advantage: (i) it incorporates information about the spatial distribution of the samples, with the aim to increase inference power and to relate more explicitly observed patterns to geography and (ii) it allows one to analyze genetic and phenotypic data within a unified model and inference framework, thus opening the way to robust comparisons between markers and possibly combined analyses. We show from simulated data as well as real data that our method estimates parameters accurately and is an improvement over alternative approaches in many situations. The power of this method is exemplified using an intricate case of inter- and intraspecies differentiation based on an original data set of georeferenced genetic and morphometric markers obtained on Myodes voles from Sweden. A computer program is made available as an extension of the R package Geneland.

PMID: 22398122



The University of Glasgow, charity number SC004401


From bbonit at tin.it  Wed Nov 28 14:00:19 2012
From: bbonit at tin.it (Bonitta Gianluca)
Date: Wed, 28 Nov 2012 13:00:19 +0000 (UTC)
Subject: [R-sig-ME] Likelihood
References: <loom.20121127T155841-214@post.gmane.org>
	<CAKFxdiRpNyd9s9-+FAU5VE09VExF+c-1ctPpZc=y60zsLvnjPQ@mail.gmail.com>
	<loom.20121127T224831-798@post.gmane.org>
	<loom.20121128T050133-771@post.gmane.org>
Message-ID: <loom.20121128T135418-357@post.gmane.org>

First of all, thank You for all replay.
Ben could You so Gentle to produce a little silly example because i have use 
this code : 
fm1 <- lmer(Reaction ~ Days + (Days|Subject), sleepstudy, devFunOnly=TRUE)
but this message occurs...  could be a wrong pack version?
Best Bonitta


From bbolker at gmail.com  Wed Nov 28 15:14:26 2012
From: bbolker at gmail.com (Ben Bolker)
Date: Wed, 28 Nov 2012 14:14:26 +0000 (UTC)
Subject: [R-sig-ME] Likelihood
References: <loom.20121127T155841-214@post.gmane.org>
	<CAKFxdiRpNyd9s9-+FAU5VE09VExF+c-1ctPpZc=y60zsLvnjPQ@mail.gmail.com>
	<loom.20121127T224831-798@post.gmane.org>
	<loom.20121128T050133-771@post.gmane.org>
	<loom.20121128T135418-357@post.gmane.org>
Message-ID: <loom.20121128T151116-130@post.gmane.org>

Bonitta Gianluca <bbonit at ...> writes:

> 
> First of all, thank You for all replay.
> Ben could You so Gentle to produce a little silly example because i have use 
> this code : 
> fm1 <- lmer(Reaction ~ Days + (Days|Subject), sleepstudy, devFunOnly=TRUE)
> but this message occurs...  could be a wrong pack version?
> Best Bonitta
> 

   I don't see a message.  (Did you include it as an attachment which
got stripped by the mailing list software?)

  You definitely do need the development version. Try

install.packages("lme4",repos="http://r-forge.r-project.org")


From j.hadfield at ed.ac.uk  Wed Nov 28 18:53:44 2012
From: j.hadfield at ed.ac.uk (Jarrod Hadfield)
Date: Wed, 28 Nov 2012 17:53:44 +0000
Subject: [R-sig-ME] within-group averaging
Message-ID: <20121128175344.36981phipzwp45us@www.staffmail.ed.ac.uk>

Hi,

This is not really a specific question for mixed models but I was  
hoping someone might know the answer anyway.

To make things simple, imagine you have a chain of causality x->y->z  
with some error at each step:  x ~ N(0,1),  y ~ N(x,1) and z ~ N(y, 1).

Observations are made on individuals who are grouped by (this is the  
important bit) the intervals their y values fall between.

z is observed for each individual in a group. Although all x values  
are observed it is not possible to say which individual within a group  
the values belong too. Therefore, xbar is a vector the same length as  
x where each individual has the x value of its group mean

We also have a treatment which does not have a causal effect on x, y  
or z, but is associated with extreme values of x.

Both  lm(z~x+treatment) and lm(z~xbar+treatment) give an average  
treatment effect of zero and uniform p-values as expected.

However, imagine for individuals in the treated group that x values  
can be assigned such that xbar2 takes on values of xbar for the  
non-treated individuals and x for the treated individuals. In this  
case  lm(z~xbar2+treatment) provides strong evidence for a treatment  
effect!

I had an idea why this would be the case (based on differences in  
variances between xbar and x). However, the problem completely  
disappears if the groups are defined by which interval of x they occur  
in, rather than which interval of y, yet differences in variances  
between xbar and x persist under this scenario.

Some code is below. If anyone has any ideas what this type of problem  
is called, why it occurs and if there are known solutions I would be  
very glad to know.

Cheers,

Jarrod

x<-rnorm(100)
y<-rnorm(100, x)
z<-rnorm(100, y)

treatment<-rbinom(100,1, plogis(x-2))

cuty<-cut(y,10) # get 10 groups defined by y

xbar<-tapply(x, cuty, mean)[cuty]

xbar2<-xbar
xbar2[which(treatment==1)]<-x[which(treatment==1)]

summary(lm(z~x+treatment))
summary(lm(z~xbar+treatment))
summary(lm(z~xbar2+treatment))

# the treatment effect in model 3 is consistently negative and has  
high type I error.








-- 
The University of Edinburgh is a charitable body, registered in
Scotland, with registration number SC005336.


From klasen at mpipz.mpg.de  Wed Nov 28 22:17:04 2012
From: klasen at mpipz.mpg.de (Jonas Klasen)
Date: Wed, 28 Nov 2012 22:17:04 +0100
Subject: [R-sig-ME] within-group averaging
Message-ID: <fbe7f149c24.50b68d60@mpiz-koeln.mpg.de>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121128/02ee98a7/attachment.pl>

From David.Duffy at qimr.edu.au  Thu Nov 29 02:37:45 2012
From: David.Duffy at qimr.edu.au (David Duffy)
Date: Thu, 29 Nov 2012 11:37:45 +1000
Subject: [R-sig-ME] A Unifying Model for the Analysis of Phenotypic,
 Genetic, and Geographic Data
In-Reply-To: <156FA9B609FA8F409121FB91C13E93DB634EDF1CB3@rcb-exserv.rcbdomain.com>
References: <CAAu37_JjFM8_BFA8bZYHX6=J_ez-556wnR-x+1z3pfz0CAmCTA@mail.gmail.com><loom.20121128T050420-834@post.gmane.org>
	<156FA9B609FA8F409121FB91C13E93DB634EDF1CB3@rcb-exserv.rcbdomain.com>
Message-ID: <alpine.LMD.2.00.1211291137270.2350@orpheus.qimr.edu.au>

On Wed, 28 Nov 2012, Paul Johnson wrote:

> This might interest some of the more genetic mixed modellers...
>
> http://www.ncbi.nlm.nih.gov/pubmed/22398122

http://arxiv.org/abs/1112.5006

| David Duffy (MBBS PhD)                                         ,-_|\
| email: davidD at qimr.edu.au  ph: INT+61+7+3362-0217 fax: -0101  /     *
| Epidemiology Unit, Queensland Institute of Medical Research   \_,-._/
| 300 Herston Rd, Brisbane, Queensland 4029, Australia  GPG 4D0B994A v


From j.hadfield at ed.ac.uk  Thu Nov 29 10:02:13 2012
From: j.hadfield at ed.ac.uk (Jarrod Hadfield)
Date: Thu, 29 Nov 2012 09:02:13 +0000
Subject: [R-sig-ME] within-group averaging
In-Reply-To: <fbe7f149c24.50b68d60@mpiz-koeln.mpg.de>
References: <fbe7f149c24.50b68d60@mpiz-koeln.mpg.de>
Message-ID: <20121129090213.8076640ct8km32ck@www.staffmail.ed.ac.uk>

Hi Jonas,

Thanks for your reply. Initially, I thought it was solely to do with  
inhomogeneity too, and I agree that it plays a role. However, if you  
replace
cuty<-cut(y,10) with cuty<-cut(x,10) (i.e. define groups by bins of x  
rather than y) then the problems with bias and type-I error rate  
disappear despite the same pattern of inhomogeneity existing. This  
really surprised me. At the moment it is the bias that I would most  
like to fix, rather than the high type-I errors.

Cheers,

Jarrod



Quoting Jonas Klasen <klasen at mpipz.mpg.de> on Wed, 28 Nov 2012 22:17:04 +0100:

> Hi Jarrod,
> I'm not completely sure if I got you right.
>
> It is a combination of variance inhomogeneity and the unbalanced  
> treatment variable. In your case the bigger group has the smaller  
> variance, which makes the overall variance small and the effects  
> significant. If you switch the group sizes, (small group small  
> variance and big group large variance) the effect is not significant  
> anymore. The first two models differ in R^2 which is a indication  
> for the variance inhomogeneity too.
>
> A plot:
> plot(z[which(treatment==1)], x[which(treatment==1)])
> plot(z[which(treatment==0)], xbar[which(treatment==0)])
> #or
> plot(z[which(treatment==0)], x[which(treatment==0)])
> plot(z[which(treatment==1)], xbar[which(treatment==1)])
>
> Regards
> Jonas
>     Hi,  This is not really a specific question for mixed models but  
> I was   hoping someone might know the answer anyway.  To make things  
> simple, imagine you have a chain of causality x->y->z   with some  
> error at each step:  x ~ N(0,1),  y ~ N(x,1) and z ~ N(y, 1).   
> Observations are made on individuals who are grouped by (this is the  
>   important bit) the intervals their y values fall between.  z is  
> observed for each individual in a group. Although all x values   are  
> observed it is not possible to say which individual within a group    
> the values belong too. Therefore, xbar is a vector the same length  
> as   x where each individual has the x value of its group mean  We  
> also have a treatment which does not have a causal effect on x, y    
> or z, but is associated with extreme values of x.  Both   
> lm(z~x+treatment) and lm(z~xbar+treatment) give an average    
> treatment effect of zero and uniform p-values as expected.  However,  
> imagine for individuals in the treated group that x values   can be  
> assigned such that xbar2 takes on values of xbar for the    
> non-treated individuals and x for the treated individuals. In this    
> case  lm(z~xbar2+treatment) provides strong evidence for a treatment  
>   effect!  I had an idea why this would be the case (based on  
> differences in   variances between xbar and x). However, the problem  
> completely   disappears if the groups are defined by which interval  
> of x they occur   in, rather than which interval of y, yet  
> differences in variances   between xbar and x persist under this  
> scenario.  Some code is below. If anyone has any ideas what this  
> type of problem   is called, why it occurs and if there are known  
> solutions I would be   very glad to know.  Cheers,  Jarrod   
> x<-rnorm(100) y<-rnorm(100, x) z<-rnorm(100, y)   
> treatment<-rbinom(100,1, plogis(x-2))  cuty<-cut(y,10) # get 10  
> groups defined by y  xbar<-tapply(x, cuty, mean)[cuty]  xbar2<-xbar  
> xbar2[which(treatment==1)]<-x[which(treatment==1)]   
> summary(lm(z~x+treatment)) summary(lm(z~xbar+treatment))  
> summary(lm(z~xbar2+treatment))  # the treatment effect in model 3 is  
> consistently negative and has   high type I error.         --  The  
> University of Edinburgh is a charitable body, registered in  
> Scotland, with registration number SC0053
>
> ______________________________________________________
>
> Jonas Klasen
> PhD student
> Genome Plasticity and Computational Genetics
> Max Planck Institute for Plant Breeding Research
> ______________________________________________________
>
>
>



-- 
The University of Edinburgh is a charitable body, registered in
Scotland, with registration number SC005336.


From David.Duffy at qimr.edu.au  Thu Nov 29 11:01:39 2012
From: David.Duffy at qimr.edu.au (David Duffy)
Date: Thu, 29 Nov 2012 20:01:39 +1000
Subject: [R-sig-ME] within-group averaging
In-Reply-To: <20121129090213.8076640ct8km32ck@www.staffmail.ed.ac.uk>
References: <fbe7f149c24.50b68d60@mpiz-koeln.mpg.de>
	<20121129090213.8076640ct8km32ck@www.staffmail.ed.ac.uk>
Message-ID: <alpine.LMD.2.00.1211291950270.20550@orpheus.qimr.edu.au>

On Thu, 29 Nov 2012, Jarrod Hadfield wrote:

> Hi Jonas,
>
> Thanks for your reply. Initially, I thought it was solely to do with 
> inhomogeneity too, and I agree that it plays a role. However, if you replace
> cuty<-cut(y,10) with cuty<-cut(x,10) (i.e. define groups by bins of x rather 
> than y) then the problems with bias and type-I error rate disappear despite 
> the same pattern of inhomogeneity existing.

If you plot your xbar2_cuty v. xbar and xbar2_cutx v. xbar you will see 
the latter is symmetrical around the line of identity, while the former is 
biased in the direction of the y~x regression line. The nonrandom 
coarsening of a subset apparently can affect inference

(A quick google obtained 
http://biostatistics.oxfordjournals.org/content/8/4/722.full)



| David Duffy (MBBS PhD)                                         ,-_|\
| email: davidD at qimr.edu.au  ph: INT+61+7+3362-0217 fax: -0101  /     *
| Epidemiology Unit, Queensland Institute of Medical Research   \_,-._/
| 300 Herston Rd, Brisbane, Queensland 4029, Australia  GPG 4D0B994A v


From j.hadfield at ed.ac.uk  Thu Nov 29 11:13:57 2012
From: j.hadfield at ed.ac.uk (Jarrod Hadfield)
Date: Thu, 29 Nov 2012 10:13:57 +0000
Subject: [R-sig-ME] within-group averaging
In-Reply-To: <alpine.LMD.2.00.1211291950270.20550@orpheus.qimr.edu.au>
References: <fbe7f149c24.50b68d60@mpiz-koeln.mpg.de>
	<20121129090213.8076640ct8km32ck@www.staffmail.ed.ac.uk>
	<alpine.LMD.2.00.1211291950270.20550@orpheus.qimr.edu.au>
Message-ID: <20121129101357.91195dy0hnr3j688@www.staffmail.ed.ac.uk>

Hi David,

Thank you for the email. I hadn't come across the term coarsening  
before, but I see from the paper that you sent that what I described  
is nonignorable coarsening. Now to try and deal with it, without  
(hopefully) having to augment with the true values of x.

Cheers,

Jarrod




Quoting David Duffy <David.Duffy at qimr.edu.au> on Thu, 29 Nov 2012  
20:01:39 +1000:

> On Thu, 29 Nov 2012, Jarrod Hadfield wrote:
>
>> Hi Jonas,
>>
>> Thanks for your reply. Initially, I thought it was solely to do  
>> with inhomogeneity too, and I agree that it plays a role. However,  
>> if you replace
>> cuty<-cut(y,10) with cuty<-cut(x,10) (i.e. define groups by bins of  
>> x rather than y) then the problems with bias and type-I error rate  
>> disappear despite the same pattern of inhomogeneity existing.
>
> If you plot your xbar2_cuty v. xbar and xbar2_cutx v. xbar you will  
> see the latter is symmetrical around the line of identity, while the  
> former is biased in the direction of the y~x regression line. The  
> nonrandom coarsening of a subset apparently can affect inference
>
> (A quick google obtained  
> http://biostatistics.oxfordjournals.org/content/8/4/722.full)
>
>
>
> | David Duffy (MBBS PhD)                                         ,-_|\
> | email: davidD at qimr.edu.au  ph: INT+61+7+3362-0217 fax: -0101  /     *
> | Epidemiology Unit, Queensland Institute of Medical Research   \_,-._/
> | 300 Herston Rd, Brisbane, Queensland 4029, Australia  GPG 4D0B994A v
>
>



-- 
The University of Edinburgh is a charitable body, registered in
Scotland, with registration number SC005336.


From bbonit at tin.it  Thu Nov 29 13:19:31 2012
From: bbonit at tin.it (Bonitta Gianluca)
Date: Thu, 29 Nov 2012 12:19:31 +0000 (UTC)
Subject: [R-sig-ME] Likelihood
References: <loom.20121127T155841-214@post.gmane.org>
	<CAKFxdiRpNyd9s9-+FAU5VE09VExF+c-1ctPpZc=y60zsLvnjPQ@mail.gmail.com>
	<loom.20121127T224831-798@post.gmane.org>
	<loom.20121128T050133-771@post.gmane.org>
	<loom.20121128T135418-357@post.gmane.org>
	<loom.20121128T151116-130@post.gmane.org>
Message-ID: <loom.20121129T100222-989@post.gmane.org>

Thank professor Ben.  I think that i had used a wrong version..
ok all work...in right mode.
Is it possible to see this function in analytical form (oh yes his 
implementation )? Because i can see that devFunOnly=TRUE will use a .Call. 
the deviance is negative twice the log-likelihood  but when i use this function
For to have likelihook function  
                                            (oh yes inverse function of dev, 
but maby for metropolis ratio ( difference in case of log transformation) i 
can use also deviance because i'm appling on the top and on the bottom of 
ratio (difference)  the same (biunivocal)transformation for likelihood 
function that is dev)

i must set REML=F in 
fm1 <- lmer(Reaction ~ Days + (Days|Subject), sleepstudy, 
devFunOnly=TRUE,REML=T) 
My problem is that the fm1 model (or better his likelihood)  have more than 
3 params  ( vector theta labelled from lmer)  only the random intercept params 
are 18 if i dont wrong..  could be this function return the profile deviance..
sorry if i wrong the lme4 code is not "a walking" for me that i have just 
start to approach into this marvellous word .. dont schold me, i know that for 
you Ben and other developer into this list my request is silly
Sorry again for all noise 
thank list 
Best Bonitta


From bergh.thijsvanden at gmail.com  Thu Nov 29 14:03:12 2012
From: bergh.thijsvanden at gmail.com (Thijs vanden Bergh)
Date: Thu, 29 Nov 2012 14:03:12 +0100
Subject: [R-sig-ME] non nested random effects in nlme and lme4
Message-ID: <CAJkOg=xAPMC06ZZWybk7_Nix7QHZ0rGBmeJP4xbVLNWZMZg=mg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121129/c62d43d8/attachment.pl>

From lsuttle at princeton.edu  Thu Nov 29 16:14:12 2012
From: lsuttle at princeton.edu (Laura Suttle)
Date: Thu, 29 Nov 2012 10:14:12 -0500
Subject: [R-sig-ME] False Convergence in Mixed Logit Model
Message-ID: <CAPNJOOhRrY4F8+Qk6psKhB_8YznbR7-=EcgHdiYHi1gk4BosbA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121129/491fe106/attachment.pl>

From bates at stat.wisc.edu  Thu Nov 29 19:15:25 2012
From: bates at stat.wisc.edu (Douglas Bates)
Date: Thu, 29 Nov 2012 12:15:25 -0600
Subject: [R-sig-ME] installation problem with RcppEigen
In-Reply-To: <1354209036.12251.140661159777277.7A3FEAC8@webmail.messagingengine.com>
References: <1354209036.12251.140661159777277.7A3FEAC8@webmail.messagingengine.com>
Message-ID: <CAO7JsnQZFpNcZ5-xd-kGU0WXJKBtx0cXqp00fdX+NqP1kmmuQw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121129/10a681c3/attachment.pl>

From bbolker at gmail.com  Thu Nov 29 23:05:04 2012
From: bbolker at gmail.com (Ben Bolker)
Date: Thu, 29 Nov 2012 22:05:04 +0000 (UTC)
Subject: [R-sig-ME] Likelihood
References: <loom.20121127T155841-214@post.gmane.org>
	<CAKFxdiRpNyd9s9-+FAU5VE09VExF+c-1ctPpZc=y60zsLvnjPQ@mail.gmail.com>
	<loom.20121127T224831-798@post.gmane.org>
	<loom.20121128T050133-771@post.gmane.org>
	<loom.20121128T135418-357@post.gmane.org>
	<loom.20121128T151116-130@post.gmane.org>
	<loom.20121129T100222-989@post.gmane.org>
Message-ID: <loom.20121129T225954-535@post.gmane.org>

Bonitta Gianluca <bbonit at ...> writes:

> 
> Thank professor Ben. 

 (Probably "Professor Bolker" or "Ben" ...)

> I think that i had used a wrong version..
> ok all work...in right mode.
> Is it possible to see this function in analytical form (oh yes his 
> implementation )? Because i can see that devFunOnly=TRUE will use a .Call. 

  ?? Not really.  You can look in the code by browsing
https://github.com/lme4/lme4 , but it's not simple ...
  The book draft PDF linked from http://lme4.r-forge.r-project.org 
gives some of the computational details.

> the deviance is negative twice the log-likelihood  but when i use this 
> function
> For to have likelihook function  
>                                             (oh yes inverse function of dev, 
> but maby for metropolis ratio ( difference in case of log transformation) i 
> can use also deviance because i'm appling on the top and on the bottom of 
> ratio (difference)  the same (biunivocal)transformation for likelihood 
> function that is dev)

  If you need the likelihood, it's just exp(-deviance/2) ...

> i must set REML=F in 
> fm1 <- lmer(Reaction ~ Days + (Days|Subject), sleepstudy, 
> devFunOnly=TRUE,REML=T) 
> My problem is that the fm1 model (or better his likelihood)  have more than
> 3 params  ( vector theta labelled from lmer)  only the random intercept
>  params 
> are 18 if i dont wrong..  could be this function return the profile deviance.

  Yes.  There is no simple way at present to get the deviance conditional
on the random effects.

  If you're doing an MCMC approach anyway, have you considered any
of the MCMC-based packages in R (MCMCglmm) or elsewhere (JAGS, WinBUGS,
etc.)?

  Ben Bolker


From ivar.herfindal at ntnu.no  Fri Nov 30 14:57:09 2012
From: ivar.herfindal at ntnu.no (Ivar Herfindal)
Date: Fri, 30 Nov 2012 13:57:09 +0000
Subject: [R-sig-ME] mer_optimize
Message-ID: <D6C55C60CCF1AC44AF5805862F86F997022BA378@WAREHOUSE04.win.ntnu.no>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121130/1bc46a2a/attachment.pl>

From chico3 at sapo.pt  Fri Nov 30 20:33:41 2012
From: chico3 at sapo.pt (chico3 at sapo.pt)
Date: Fri, 30 Nov 2012 19:33:41 +0000
Subject: [R-sig-ME] glmer, split-plot design simple question
Message-ID: <20121130193341.Horde.p_32ZuanEAJQuQoVyXuT4aA@mail.sapo.pt>


Dear experts,

I have a question concerning the implementation of a mixed model in my  
specific experiment. I have search the archives and found no answer to  
my problem.

I have four luminaires randomly distributed. Two luminaires have light  
on and two luminaires have no light. Below the luminaires I have two  
treatments. Each treatment as four replicates that were randomly  
distributed below the luminaires. Moreover, I have made all the  
possible combinations of presence absence of light and treatments.

I want to check if there is a effect of each treatment and the  
interactions between all the combinations.The response variable is a  
proportion (number of specific specie/total number of species)

Treatment1<-as.factor(?Yes?,?No?)
Treatment2<- as.factor(?Yes?,?No?)
Light<- as.factor(?Yes?,?No?)
Response<-cbind(number_of_specific_species, total_species)

I have made this model,

  model<-glmer(Response ~ Treatmen1*Treatment2 + (1|Light), family=binomial)

However this doesn?t allow to see the effect of light or the  
interaction between light and treatments. Moreover, I don?t know how  
to include overdispersion, since glmer doesn?t allow quasi families  
such as glm.

I know this is a simple question, but I greatly would appreciate some  
clues on how to proceed.


From bbolker at gmail.com  Sat Dec  1 03:30:07 2012
From: bbolker at gmail.com (Ben Bolker)
Date: Sat, 1 Dec 2012 02:30:07 +0000 (UTC)
Subject: [R-sig-ME] glmer, split-plot design simple question
References: <20121130193341.Horde.p_32ZuanEAJQuQoVyXuT4aA@mail.sapo.pt>
Message-ID: <loom.20121201T032348-561@post.gmane.org>

 <chico3 at ...> writes:

>

[snip]

> I have four luminaires randomly distributed. Two luminaires have light  
> on and two luminaires have no light. Below the luminaires I have two  
> treatments. Each treatment has four replicates that were randomly  
> distributed below the luminaires. Moreover, I have made all the  
> possible combinations of presence absence of light and treatments.
> 
> I want to check if there is a effect of each treatment and the  
> interactions between all the combinations.The response variable is a  
> proportion (number of specific specie/total number of species)
> 
> Treatment1<-as.factor(?Yes?,?No?)
> Treatment2<- as.factor(?Yes?,?No?)
> Light<- as.factor(?Yes?,?No?)
> Response<-cbind(number_of_specific_species, total_species)
> 
> I have made this model,
> 
>   model<-glmer(Response ~ Treatment1*Treatment2 + (1|Light), family=binomial)
> 
> However this doesn?t allow to see the effect of light or the  
> interaction between light and treatments. Moreover, I don?t know how  
> to include overdispersion, since glmer doesn?t allow quasi families  
> such as glm.
> 
> I know this is a simple question, but I greatly would appreciate some  
> clues on how to proceed.

I may be missing something here, but it doesn't make sense to me
to treat Light as a random effect (one criterion -- the levels "Light"
and "No light" aren't *exchangeable*, i.e. you couldn't switch
the factor labels without changing the meaning of the experiment).
I would say you are looking for something more like

glmer(Response ~ Treatment1*Treatment2*Light + (1|luminaire), family=binomial)

where the luminaires are labeled uniquely (e.g.
"Light1","Light2","Nolight1","Nolight2")

It sounds like this is a randomized block design (i.e. every level of
Treat1*Treat2 is present at each luminaire), so you could test the
interaction between Treat1*Treat2 and luminaire via
(Treat1*Treat2|luminaire) instead of (1|luminaire) (see e.g.
Schielzeth 2009), although you may find that this leads to estimates
of zero variance (overfitting the data).


From chico3 at sapo.pt  Sat Dec  1 18:33:38 2012
From: chico3 at sapo.pt (chico3 at sapo.pt)
Date: Sat, 01 Dec 2012 17:33:38 +0000
Subject: [R-sig-ME] R-sig-mixed-models Digest, Vol 72, Issue 1
Message-ID: <20121201173338.Horde.1zTJTpUe0BVQuj9ylZdz-AA@mail.sapo.pt>

I Ben,


I think that you are right. Thank you so much for your answer. I was  
almost given up :).


Cheers,


Francisco




[snip]

> I have four luminaires randomly distributed. Two luminaires have  
> light  on and two luminaires have no light. Below the luminaires I  
> have two  treatments. Each treatment has four replicates that were  
> randomly  distributed below the luminaires. Moreover, I have made  
> all the  possible combinations of presence absence of light and  
> treatments.
>
> I want to check if there is a effect of each treatment and the   
> interactions between all the combinations.The response variable is a  
>  proportion (number of specific specie/total number of species)
>
> Treatment1<-as.factor(?Yes?,?No?)
> Treatment2<- as.factor(?Yes?,?No?)
> Light<- as.factor(?Yes?,?No?)
> Response<-cbind(number_of_specific_species, total_species)
>
> I have made this model,
>
>   model<-glmer(Response ~ Treatment1*Treatment2 + (1|Light), family=binomial)
>
> However this doesn?t allow to see the effect of light or the   
> interaction between light and treatments. Moreover, I don?t know how  
>  to include overdispersion, since glmer doesn?t allow quasi families  
>  such as glm.
>
> I know this is a simple question, but I greatly would appreciate  
> some  clues on how to proceed.

I may be missing something here, but it doesn't make sense to me
to treat Light as a random effect (one criterion -- the levels "Light"
and "No light" aren't *exchangeable*, i.e. you couldn't switch
the factor labels without changing the meaning of the experiment).
I would say you are looking for something more like

glmer(Response ~ Treatment1*Treatment2*Light + (1|luminaire), family=binomial)

where the luminaires are labeled uniquely (e.g.
"Light1","Light2","Nolight1","Nolight2")

It sounds like this is a randomized block design (i.e. every level of
Treat1*Treat2 is present at each luminaire), so you could test the
interaction between Treat1*Treat2 and luminaire via
(Treat1*Treat2|luminaire) instead of (1|luminaire) (see e.g.
Schielzeth 2009), although you may find that this leads to estimates
of zero variance (overfitting the data).


From chico3 at sapo.pt  Sat Dec  1 18:33:53 2012
From: chico3 at sapo.pt (chico3 at sapo.pt)
Date: Sat, 01 Dec 2012 17:33:53 +0000
Subject: [R-sig-ME] R-sig-mixed-models Digest, Vol 72, Issue 1
In-Reply-To: <mailman.5.1354359601.23898.r-sig-mixed-models@r-project.org>
References: <mailman.5.1354359601.23898.r-sig-mixed-models@r-project.org>
Message-ID: <20121201173353.Horde.chPQZIv3BfVQuj_BOfXnynA@mail.sapo.pt>




Quoting r-sig-mixed-models-request at r-project.org:

> Send R-sig-mixed-models mailing list submissions to
> 	r-sig-mixed-models at r-project.org
>
> To subscribe or unsubscribe via the World Wide Web, visit
> 	https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> or, via email, send a message with subject or body 'help' to
> 	r-sig-mixed-models-request at r-project.org
>
> You can reach the person managing the list at
> 	r-sig-mixed-models-owner at r-project.org
>
> When replying, please edit your Subject line so it is more specific
> than "Re: Contents of R-sig-mixed-models digest..."
>
>
> Today's Topics:
>
>    1. mer_optimize (Ivar Herfindal)
>    2. glmer, split-plot design simple question (chico3 at sapo.pt)
>    3. Re: glmer, split-plot design simple question (Ben Bolker)
>
>
> ----------------------------------------------------------------------
>
> Message: 1
> Date: Fri, 30 Nov 2012 13:57:09 +0000
> From: Ivar Herfindal <ivar.herfindal at ntnu.no>
> To: "r-sig-mixed-models at r-project.org"
> 	<r-sig-mixed-models at r-project.org>
> Subject: [R-sig-ME] mer_optimize
> Message-ID:
> 	<D6C55C60CCF1AC44AF5805862F86F997022BA378 at WAREHOUSE04.win.ntnu.no>
> Content-Type: text/plain
>
> Hi all
>
> Some time ago, I raised a question on this mailing list about using  
> .Call("mer_optimize", mymodel, PACKAGE="lme4") for a model that  
> failed to converge, see:
> https://stat.ethz.ch/pipermail/r-sig-mixed-models/2008q3/001354.html
>
> As a "horrible hack" solution to my problem, I added a few lines  
> with .Call("mer_optimize", mymodel, PACKAGE="lme4") in my script,  
> and was satisfied that the model seemed to converge after a few of  
> these runs. Then I forgot it all, until I recently ran the same  
> script but on a different model.
>
> This new model did not have problem with convergence (at least not  
> any problem that are reported), it is a simple linear mixed model  
> with one random factor. I was therefore surprised that the  
> log-likelihood and parameter estimates change after I run  
> .Call("mer_optimize"...) on the model. Since I use log-likelihoods  
> to compare models (likelihood-ratio tests or AICc), it is quite  
> important to have the most "correct" log-likelihood. The change is  
> quite big (change of 2 - 3 in AICc) and differs between candidate  
> models, such that it can have impact on the ranking of models. Also,  
> the parameter estimates and their SE change, which affect the  
> corresponding t-values. It seems that more complex models have the  
> largest change after calling mer_optimize.
>
> My question is then: Should I continue to use  
> .Call("mer_optimize"...) on my models until log-Likelihood not  
> change for a model, or can I trust the first run of lmer as long as  
> I do not get any warnings about convergence?
>
> I attach below example for a model summary before and after running  
> mer_optimize. Unfortunately, I have not been able to make a small,  
> reproducible example.
>
> Best regards
>
> Ivar
>
> ##########################################################################
>> mod <- lmer(LRS ~ Apr*ALR + I(ALR^2) + (1|Lok), data=LRStab, REML=FALSE)
>> mod
>> mod
> Linear mixed model fit by maximum likelihood
> Formula: LRS ~ Apr * ALR + I(ALR^2) + (1 | Lok)
>    Data: LRStab
>   AIC  BIC logLik deviance REMLdev
>  1724 1751   -855     1710    1730
> Random effects:
>  Groups     Name        Variance   Std.Dev.
>  Lok        (Intercept) 4.1578e-09 6.4481e-05
>  Residual               6.6801e+00 2.5846e+00
> Number of obs: 361, groups: Lok, 99
>
> Fixed effects:
>              Estimate Std. Error t value
> (Intercept) -1.611300   1.359076  -1.186
> Apr          0.075193   0.205390   0.366
> ALR          2.677924   0.365207   7.333
> I(ALR^2)     0.004942   0.013571   0.364
> Apr:ALR     -0.118061   0.049655  -2.378
>
>> .Call("mer_optimize", mod, PACKAGE="lme4")
> NULL
>> mod
> Linear mixed model fit by maximum likelihood
> Formula: LRS ~ Apr * ALR + I(ALR^2) + (1 | Lok)
>    Data: LRStab
>   AIC  BIC logLik deviance REMLdev
>  1723 1750 -854.3     1709    1728
> Random effects:
>  Groups     Name        Variance Std.Dev.
>  Lok        (Intercept) 0.33923  0.58243
>  Residual               6.34722  2.51937
> Number of obs: 361, groups: Lok, 99
>
> Fixed effects:
>              Estimate Std. Error t value
> (Intercept) -1.620101   1.355985  -1.195
> Apr          0.074193   0.204893   0.362
> ALR          2.714618   0.364657   7.444
> I(ALR^2)     0.004308   0.013566   0.318
> Apr:ALR     -0.121868   0.049614  -2.456
>
>
>> sessionInfo()
> R version 2.14.2 (2012-02-29)
> Platform: i386-pc-mingw32/i386 (32-bit)
>
> locale:
> [1] LC_COLLATE=Norwegian (Bokm?l)_Norway.1252  LC_CTYPE=Norwegian  
> (Bokm?l)_Norway.1252
> [3] LC_MONETARY=Norwegian (Bokm?l)_Norway.1252 LC_NUMERIC=C
> [5] LC_TIME=Norwegian (Bokm?l)_Norway.1252
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> other attached packages:
>  [1] arm_1.5-03       foreign_0.8-49   abind_1.4-0       
> R2WinBUGS_2.1-18 coda_0.14-6
>  [6] car_2.0-12       nnet_7.3-1       MASS_7.3-17       
> languageR_1.4    lme4_0.999375-42
> [11] Matrix_1.0-4     lattice_0.20-0
>
> loaded via a namespace (and not attached):
> [1] grid_2.14.2   nlme_3.1-103  stats4_2.14.2
>>
> ########################################################
>
> --------------------------------------------------
> Ivar Herfindal (PhD, Researcher)
> Centre for Conservation Biology
> Department of Biology
> Norwegian University for Science and Technology
> N-7491 Trondheim, Norway
>
> email:     Ivar.Herfindal at bio.ntnu.no
> web:       http://www.ntnu.no/employees/ivar.herfindal
> phone:     +47 73596253
> Cellphone: +47 91625333
> fax:       +47 73596090
> --------------------------------------------------
>
> 	[[alternative HTML version deleted]]
>
>
>
> ------------------------------
>
> Message: 2
> Date: Fri, 30 Nov 2012 19:33:41 +0000
> From: chico3 at sapo.pt
> To: r-sig-mixed-models at r-project.org
> Subject: [R-sig-ME] glmer, split-plot design simple question
> Message-ID:
> 	<20121130193341.Horde.p_32ZuanEAJQuQoVyXuT4aA at mail.sapo.pt>
> Content-Type: text/plain; charset=UTF-8; format=flowed; DelSp=Yes
>
>
> Dear experts,
>
> I have a question concerning the implementation of a mixed model in my
> specific experiment. I have search the archives and found no answer to
> my problem.
>
> I have four luminaires randomly distributed. Two luminaires have light
> on and two luminaires have no light. Below the luminaires I have two
> treatments. Each treatment as four replicates that were randomly
> distributed below the luminaires. Moreover, I have made all the
> possible combinations of presence absence of light and treatments.
>
> I want to check if there is a effect of each treatment and the
> interactions between all the combinations.The response variable is a
> proportion (number of specific specie/total number of species)
>
> Treatment1<-as.factor(?Yes?,?No?)
> Treatment2<- as.factor(?Yes?,?No?)
> Light<- as.factor(?Yes?,?No?)
> Response<-cbind(number_of_specific_species, total_species)
>
> I have made this model,
>
>   model<-glmer(Response ~ Treatmen1*Treatment2 + (1|Light), family=binomial)
>
> However this doesn?t allow to see the effect of light or the
> interaction between light and treatments. Moreover, I don?t know how
> to include overdispersion, since glmer doesn?t allow quasi families
> such as glm.
>
> I know this is a simple question, but I greatly would appreciate some
> clues on how to proceed.
>
>
>
> ------------------------------
>
> Message: 3
> Date: Sat, 1 Dec 2012 02:30:07 +0000 (UTC)
> From: Ben Bolker <bbolker at gmail.com>
> To: r-sig-mixed-models at r-project.org
> Subject: Re: [R-sig-ME] glmer, split-plot design simple question
> Message-ID: <loom.20121201T032348-561 at post.gmane.org>
> Content-Type: text/plain; charset=utf-8
>
>  <chico3 at ...> writes:
>
>>
>
> [snip]
>
>> I have four luminaires randomly distributed. Two luminaires have light
>> on and two luminaires have no light. Below the luminaires I have two
>> treatments. Each treatment has four replicates that were randomly
>> distributed below the luminaires. Moreover, I have made all the
>> possible combinations of presence absence of light and treatments.
>>
>> I want to check if there is a effect of each treatment and the
>> interactions between all the combinations.The response variable is a
>> proportion (number of specific specie/total number of species)
>>
>> Treatment1<-as.factor(?Yes?,?No?)
>> Treatment2<- as.factor(?Yes?,?No?)
>> Light<- as.factor(?Yes?,?No?)
>> Response<-cbind(number_of_specific_species, total_species)
>>
>> I have made this model,
>>
>>   model<-glmer(Response ~ Treatment1*Treatment2 + (1|Light),  
>> family=binomial)
>>
>> However this doesn?t allow to see the effect of light or the
>> interaction between light and treatments. Moreover, I don?t know how
>> to include overdispersion, since glmer doesn?t allow quasi families
>> such as glm.
>>
>> I know this is a simple question, but I greatly would appreciate some
>> clues on how to proceed.
>
> I may be missing something here, but it doesn't make sense to me
> to treat Light as a random effect (one criterion -- the levels "Light"
> and "No light" aren't *exchangeable*, i.e. you couldn't switch
> the factor labels without changing the meaning of the experiment).
> I would say you are looking for something more like
>
> glmer(Response ~ Treatment1*Treatment2*Light + (1|luminaire),  
> family=binomial)
>
> where the luminaires are labeled uniquely (e.g.
> "Light1","Light2","Nolight1","Nolight2")
>
> It sounds like this is a randomized block design (i.e. every level of
> Treat1*Treat2 is present at each luminaire), so you could test the
> interaction between Treat1*Treat2 and luminaire via
> (Treat1*Treat2|luminaire) instead of (1|luminaire) (see e.g.
> Schielzeth 2009), although you may find that this leads to estimates
> of zero variance (overfitting the data).
>
>
>
> ------------------------------
>
> _______________________________________________
> R-sig-mixed-models mailing list
> R-sig-mixed-models at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>
>
> End of R-sig-mixed-models Digest, Vol 72, Issue 1
> *************************************************


From bbolker at gmail.com  Sat Dec  1 23:00:30 2012
From: bbolker at gmail.com (Ben Bolker)
Date: Sat, 1 Dec 2012 22:00:30 +0000 (UTC)
Subject: [R-sig-ME] =?utf-8?q?mer=5Foptimize?=
References: <D6C55C60CCF1AC44AF5805862F86F997022BA378@WAREHOUSE04.win.ntnu.no>
Message-ID: <loom.20121201T225108-100@post.gmane.org>

Ivar Herfindal <ivar.herfindal at ...> writes:

> Some time ago, I raised a question on this mailing list about using
> .Call("mer_optimize", mymodel, PACKAGE="lme4") for a model that
> failed to converge, see:
> https://stat.ethz.ch/pipermail/r-sig-mixed-models/2008q3/001354.html
 
> As a "horrible hack" solution to my problem, I added a few lines
> with .Call("mer_optimize", mymodel, PACKAGE="lme4") in my script,
> and was satisfied that the model seemed to converge after a few of
> these runs. Then I forgot it all, until I recently ran the same
> script but on a different model.
 
> This new model did not have problem with convergence (at least not
> any problem that are reported), it is a simple linear mixed model
> with one random factor. I was therefore surprised that the
> log-likelihood and parameter estimates change after I run
> .Call("mer_optimize"...) on the model. Since I use log-likelihoods
> to compare models (likelihood-ratio tests or AICc), it is quite
> important to have the most "correct" log-likelihood. The change is
> quite big (change of 2 - 3 in AICc) and differs between candidate
> models, such that it can have impact on the ranking of models. Also,
> the parameter estimates and their SE change, which affect the
> corresponding t-values. It seems that more complex models have the
> largest change after calling mer_optimize.
 
> My question is then: Should I continue to use
> .Call("mer_optimize"...) on my models until log-Likelihood not
> change for a model, or can I trust the first run of lmer as long as
> I do not get any warnings about convergence?
 
> I attach below example for a model summary before and after running
> mer_optimize. Unfortunately, I have not been able to make a small,
> reproducible example.
 
> Best regards
> 
> Ivar
> 
# ##########################################################################
# > mod <- lmer(LRS ~ Apr*ALR + I(ALR^2) + (1|Lok), data=LRStab, REML=FALSE)
# > mod
# > mod
# Linear mixed model fit by maximum likelihood
# Formula: LRS ~ Apr * ALR + I(ALR^2) + (1 | Lok)
#    Data: LRStab
#   AIC  BIC logLik deviance REMLdev
#  1724 1751   -855     1710    1730
# Random effects:
#  Groups     Name        Variance   Std.Dev.
#  Lok        (Intercept) 4.1578e-09 6.4481e-05
#  Residual               6.6801e+00 2.5846e+00
# Number of obs: 361, groups: Lok, 99
# 
# Fixed effects:
#              Estimate Std. Error t value
# (Intercept) -1.611300   1.359076  -1.186
# Apr          0.075193   0.205390   0.366
# ALR          2.677924   0.365207   7.333
# I(ALR^2)     0.004942   0.013571   0.364
# Apr:ALR     -0.118061   0.049655  -2.378
# 
# > .Call("mer_optimize", mod, PACKAGE="lme4")
# NULL
# > mod
# Linear mixed model fit by maximum likelihood
# Formula: LRS ~ Apr * ALR + I(ALR^2) + (1 | Lok)
#    Data: LRStab
#   AIC  BIC logLik deviance REMLdev
#  1723 1750 -854.3     1709    1728
# Random effects:
#  Groups     Name        Variance Std.Dev.
#  Lok        (Intercept) 0.33923  0.58243
#  Residual               6.34722  2.51937
# Number of obs: 361, groups: Lok, 99
# 
# Fixed effects:
#              Estimate Std. Error t value
# (Intercept) -1.620101   1.355985  -1.195
# Apr          0.074193   0.204893   0.362
# ALR          2.714618   0.364657   7.444
# I(ALR^2)     0.004308   0.013566   0.318
# Apr:ALR     -0.121868   0.049614  -2.456


  Ivar, 

  I would say it is reasonable to be concerned, but I would
really only worry about this if you are specifically interested
in the variance decomposition between among-group and residual
error, because as you can see the fixed effects and their
standard errors only change by a tiny amount.  This is probably
a situation where the likelihood surface is very flat with
respect to the variance.

  If you feel up to a minor challenge, I might recommend that
you try the development version of lme4 (available from r-forge,
or the very most recent version can be installed from github
via the devtools package); it has more flexible optimization
choices, and more tools for computing and plotting likelihood
profiles and comparing likelihoods (deviances) for different
parameter values.  There are some stability issues with GLMMs
that we're still trying to fix, but as far as I know it
works as well or better on LMMs than the stable version.

  Ben Bolker


From chico3 at sapo.pt  Mon Dec  3 13:42:12 2012
From: chico3 at sapo.pt (chico3 at sapo.pt)
Date: Mon, 03 Dec 2012 12:42:12 +0000
Subject: [R-sig-ME] randomized block design glmer question
Message-ID: <20121203124212.Horde.wUNKO5IzaPJQvJ4kqb90bDA@mail.sapo.pt>


Dear experts,



My background with mixed models is very pour. However,With the  
precious help of this forum I have implement a glmer function to test  
the experiment described below (randomized block design)

I have four luminaires randomly distributed. Two luminaires have light  
on and two luminaires have no light. Below the luminaires I have two  
treatments. Each treatment as four replicates that were randomly  
distributed below the luminaires. Moreover, I have made all the  
possible combinations of presence absence of light and treatments.

I want to check if there is a effect of each treatment and the  
interactions between all the combinations.The response variable is a  
proportion (number of specific specie/total number of species)
#define factors

Treatment1<-as.factor("Yes","No")
Treatment2<-as.factor("Yes","No")
Light<-as.factor("Yes","No")
Luminaire<-as.factor("LightYes1","LightYes2","NoLight1", "NoLight2")
Response<-cbind(number_of_specific_species, total_species)

#including individual level variability to account for overdispersion

obs <- 1:nrow(Response)

#model
library(lme4)
model<-glmer(Response ~ Treatment1*Treatment2*Light + (1|Luminaire) +  
(1|obs), family=binomial)
summary(model)
Generalized linear mixed model fit by the Laplace approximation
Formula: Response ~ Treatment1 * Treatment2 * Light + (1 | Luminaire)  
+ (1 | obs)
    AIC   BIC logLik deviance
  180.2 194.9  -80.1    160.2
Random effects:
  Groups    Name        Variance Std.Dev.
  obs       (Intercept) 0.059638 0.24421
  Luminaire (Intercept) 0.000000 0.00000
Number of obs: 32, groups: obs, 32; Luminaire, 4

Fixed effects:
                                         Estimate Std. Error z value Pr(>|z|)
(Intercept)                             -0.9283     0.1236  -7.511  
5.88e-14 ***
Treatment1Yes                            0.2416     0.1743   1.386  0.16582
Treatment2Yes                           -0.2459     0.1747  -1.408  0.15921
LightYes                                -0.2069     0.1745  -1.186  0.23562
Treatment1Yes:Treatment2Yes             -0.7517     0.2468  -3.046  0.00232 **
Treatment1Yes:LightYes                  -0.3018     0.2464  -1.225  0.22071
Treatment2Yes:LightYes                   0.2126     0.2466   0.862  0.38866
Treatment1Yes:Treatment2Yes:LightYes     0.7520     0.3488   2.156  0.03110 *
---
Signif. codes:  0 ?***? 0.001 ?**? 0.01 ?*? 0.05 ?.? 0.1 ? ? 1

Correlation of Fixed Effects:
                               (Intr) Treatment1Yes Treatment2Yes   
LightYes  Treatment1Ys:Treatment2Y Treatment1Y:U Treatment2Y:Light
Treatment1Yes                 -0.709
Treatment2Yes                 -0.708    0.502
LightYes                      -0.708    0.502         0.501
Treatment1Yes:Treatment2Ys     0.501    -0.706       -0.708        -0.355
Treatment1Yes:LightYs          0.502    -0.707       -0.355         
-0.708               0.500
Treatment2Yes:LightYes         0.501    -0.355       -0.708         
-0.707               0.501               0.501
Treatment1Y:Treatment2Y:Light -0.354     0.500        0.501          
0.500               -0.707             -0.706         -0.707


-------------

The results are coherent with barplot and PCO analysis that I did  
previously, were combination of treatment1 and treatment2  have a  
greater effect than other combinations.


My question are

Is the model corrected?

How can I interpret the results, since I cannot do a Anova for example?


Cheers,

FranciscoR


From matthew.t.boden at gmail.com  Mon Dec  3 19:23:03 2012
From: matthew.t.boden at gmail.com (Matthew Boden)
Date: Mon, 3 Dec 2012 10:23:03 -0800
Subject: [R-sig-ME] Linear mixed modeling following multiple imputation.
Message-ID: <CAE10PCw6mCYh2-VxKBqo4e=H0bv=yS26vMGg7dGZrCR4ZJ8q_g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121203/62a4691c/attachment.pl>

From longrob604 at gmail.com  Mon Dec  3 20:06:28 2012
From: longrob604 at gmail.com (W Robert Long)
Date: Mon, 03 Dec 2012 19:06:28 +0000
Subject: [R-sig-ME] Linear mixed modeling following multiple imputation.
In-Reply-To: <CAE10PCw6mCYh2-VxKBqo4e=H0bv=yS26vMGg7dGZrCR4ZJ8q_g@mail.gmail.com>
References: <CAE10PCw6mCYh2-VxKBqo4e=H0bv=yS26vMGg7dGZrCR4ZJ8q_g@mail.gmail.com>
Message-ID: <50BCF834.4020501@gmail.com>

I haven't used Amelia before, but I have done multiple imputation, using 
the mice package, followed by linear mixed models. I see on p13 of 
http://r.iq.harvard.edu/docs/amelia/amelia.pdf that write.amelia() 
outputs a csv file of each completed dataset. There may be a more direct 
way to access the completed datasets but something like this should work:

write.amelia(obj=a.out, file.stem = "outdata")

diff <-list(m)  # a list to store each model

for (i in 1:m) {
	file.name <- paste("outdata", m ,".csv",sep="")
	data.to.use <- read.csv(file.name)
	diff[[m]] <- lmer(trans1 ~ time*negative + (time | Subject), +
	data = data.to.use )
}

Here m is the number of imputed datasets.

Does Amelia handle the multilevel/clustered aspect of your data ? mice 
has some basic multilevel imputation capabilities but perhaps I should 
take a closer look at Amelia. This is actually of great interest to me.

Hope it helps
Rob


On 03/12/2012 18:23, Matthew Boden wrote:
> Hello,
>
> I have a question that may require expertise outside of the domains covered
> by this listserve.  I apologize if this question is not relevant here. I
> would appreciate any help, or a suggestion of where to find an answer to
> this question.
>
> I was recently asked to conduct multiple imputation using the Amelia
> procedure in R on a longitudinal data set (102 human participants with data
> measured at 5 time-points for each participant). I would like to conduct
> linear mixed modeling on the imputed data sets and pool the results.
>
> My code for the linear mixed modeling is as follows:
>
> diff <- lmer(trans1 ~ time*negative + (time | Subject), data = set1)
> cftest (diff)
>
> Here, (I think) I am predicting the intercept and slope of trans1
> (=substance use over time) from the fixed effects of negative (=negative
> emotion at baseline - i.e., the first time-point).
>
> It is stated in the Amelia manual that to properly analyze data (e.g.,
> taking into account error variance associated with the imputation process
> itself), "...users could simply program a loop over the number of
> imputations and run the analysis model on each imputed dataset and combine
> the results using the rules described in King et al. (2001) and Schafer
> (1997)."  This is where I am stuck. I am able to obtain the imputed data
> sets using the Amelia code, but do not know how to write the code to
> program a loop over the imputed data sets and combine the results.  I have
> very little experience coding in R and do not know where to begin to look
> to find out how to do this.
>
> Any help is much appreciated.
>
> Thanks,
> Matt
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>


From djmuser at gmail.com  Mon Dec  3 21:45:38 2012
From: djmuser at gmail.com (Dennis Murphy)
Date: Mon, 3 Dec 2012 12:45:38 -0800
Subject: [R-sig-ME] Linear mixed modeling following multiple imputation.
In-Reply-To: <50BCF834.4020501@gmail.com>
References: <CAE10PCw6mCYh2-VxKBqo4e=H0bv=yS26vMGg7dGZrCR4ZJ8q_g@mail.gmail.com>
	<50BCF834.4020501@gmail.com>
Message-ID: <CADv2QyENKbR_r7b6xcM9pkgg-0RdTw0oK5TsO4t3h1ev9yDg5Q@mail.gmail.com>

Hi:

After imputation via amelia(), the output file is a list whose first
component, imputations, is a list containing the imputed data frames.
Given that the post-imputation object is named a.out, one can write
the list of imputed data frames as  a.out$imputations, from which the
models can be fit with

library(lme4)
mods <- lapply(a.out$imputations,
                function(d) lmer( trans1 ~ time*negative + (time | Subject),
                                                data = d ) )

This avoids the step of saving the individual imputed data sets to
disk and reading them back in.

Dennis

On Mon, Dec 3, 2012 at 11:06 AM, W Robert Long <longrob604 at gmail.com> wrote:
> I haven't used Amelia before, but I have done multiple imputation, using the
> mice package, followed by linear mixed models. I see on p13 of
> http://r.iq.harvard.edu/docs/amelia/amelia.pdf that write.amelia() outputs a
> csv file of each completed dataset. There may be a more direct way to access
> the completed datasets but something like this should work:
>
> write.amelia(obj=a.out, file.stem = "outdata")
>
> diff <-list(m)  # a list to store each model
>
> for (i in 1:m) {
>         file.name <- paste("outdata", m ,".csv",sep="")
>         data.to.use <- read.csv(file.name)
>         diff[[m]] <- lmer(trans1 ~ time*negative + (time | Subject), +
>         data = data.to.use )
> }
>
> Here m is the number of imputed datasets.
>
> Does Amelia handle the multilevel/clustered aspect of your data ? mice has
> some basic multilevel imputation capabilities but perhaps I should take a
> closer look at Amelia. This is actually of great interest to me.
>
> Hope it helps
> Rob
>
>
>
> On 03/12/2012 18:23, Matthew Boden wrote:
>>
>> Hello,
>>
>> I have a question that may require expertise outside of the domains
>> covered
>> by this listserve.  I apologize if this question is not relevant here. I
>> would appreciate any help, or a suggestion of where to find an answer to
>> this question.
>>
>> I was recently asked to conduct multiple imputation using the Amelia
>> procedure in R on a longitudinal data set (102 human participants with
>> data
>> measured at 5 time-points for each participant). I would like to conduct
>> linear mixed modeling on the imputed data sets and pool the results.
>>
>> My code for the linear mixed modeling is as follows:
>>
>> diff <- lmer(trans1 ~ time*negative + (time | Subject), data = set1)
>> cftest (diff)
>>
>> Here, (I think) I am predicting the intercept and slope of trans1
>> (=substance use over time) from the fixed effects of negative (=negative
>> emotion at baseline - i.e., the first time-point).
>>
>> It is stated in the Amelia manual that to properly analyze data (e.g.,
>> taking into account error variance associated with the imputation process
>> itself), "...users could simply program a loop over the number of
>> imputations and run the analysis model on each imputed dataset and combine
>> the results using the rules described in King et al. (2001) and Schafer
>> (1997)."  This is where I am stuck. I am able to obtain the imputed data
>> sets using the Amelia code, but do not know how to write the code to
>> program a loop over the imputed data sets and combine the results.  I have
>> very little experience coding in R and do not know where to begin to look
>> to find out how to do this.
>>
>> Any help is much appreciated.
>>
>> Thanks,
>> Matt
>>
>>         [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-mixed-models at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>
>
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models


From lborger at cebc.cnrs.fr  Tue Dec  4 09:48:05 2012
From: lborger at cebc.cnrs.fr (lborger)
Date: Tue, 04 Dec 2012 09:48:05 +0100
Subject: [R-sig-ME] A general and simple method for obtaining R2 from
	generalized linear	mixed-effects models
In-Reply-To: <CADv2QyENKbR_r7b6xcM9pkgg-0RdTw0oK5TsO4t3h1ev9yDg5Q@mail.gmail.com>
References: <CAE10PCw6mCYh2-VxKBqo4e=H0bv=yS26vMGg7dGZrCR4ZJ8q_g@mail.gmail.com>
	<50BCF834.4020501@gmail.com>
	<CADv2QyENKbR_r7b6xcM9pkgg-0RdTw0oK5TsO4t3h1ev9yDg5Q@mail.gmail.com>
Message-ID: <WC20121204084805.24044E@cebc.cnrs.fr>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121204/6a4d83cb/attachment.pl>

From gpagnoni at gmail.com  Tue Dec  4 14:28:10 2012
From: gpagnoni at gmail.com (Giuseppe Pagnoni)
Date: Tue, 4 Dec 2012 14:28:10 +0100
Subject: [R-sig-ME] Repeated-measures anova with a within-subject covariate
 (or varying-slopes mixed model?)
Message-ID: <CAAdktEw07Xyh6Kkm-BOKPcozmJDDeupi8rAr4QR3xR7F2UCMWA@mail.gmail.com>

Dear all,

I am having quite a hard time in trying to figure out how to correctly
spell out a model in R (a repeated-measures anova with a
within-subject covariate, I guess).  Even though I have read in the
posting guide that statistical advice may or may not get an answer on
this list, I decided to try it anyway, hoping not to incur in
somebody's ire for misusing the tool.

For the sake of clarity, I will explain the problem.

We conducted an experiment measuring average response times in a
cognitive task. The task has two types of stimuli (stim1, stim2) and
was performed in a 6-run session, where subjects performed the task
under condition A on odd-numbered runs and under condition B on
even-numbered runs.  Thus, the temporal sequence of the runs was the
following:

- run 1: cond A
- run 2: cond B
- run 3: cond A
- run 4: cond B
- run 5: cond A
- run 6: cond B

where for each run and for each subject, an average RT was collected
for stim1 and for stim2.

After collecting and plotting the data, an approximately linear
decrease in RT from run1 to run6 was apparent in most subjects
(practice effect: subjects become better and faster with time).

Now, I am struggling with how to properly specify a model to perform
the group analysis by taking into account this confounding practice
effect, so that the real effects of interest (the main effect of
condition, and the interaction of condition and stimulus type) can be
better assessed.

I used a dataframe in long format, with `subj', `rt' (response time),
`stim' (stim1, stim2), `cond' (A, B), and `run' (1 to 6) as columns,
where `run' is coded as an integer so that it can be used for modeling
a linear trend. The R command I tried is:

 rt.aov <- aov(rt ~ run + stim * cond + Error(subj /(run + stim *
cond)), data=rt.df)

but I am not at all sure that the error term is correctly specified.

Furthermore, we have also collected data on an additional batch of
subjects that performed the task in the 6-run session but with the
order of conditions A and B reversed (A on even-numbered runs and B on
odd-numbered runs); now, if we wanted to analyze the data from the two
groups of subjects together, by including a between-subjects group
factor (groupAB, groupBA), would the model specification become
something like the following?

   rt.aov <- aov(rt ~ run + group * stim * cond + Error(subj /(run +
stim * cond)), data=rt.df)

Perhaps should lme() be used instead (and with which formula?)?

Many thanks in advance to anybody who'd be so kind to offer their
advice or tip on this.  I have scoured the web and some textbooks for
a few days now, but to little avail.

very best

giuseppe

-- 
Giuseppe Pagnoni
Dip. Scienze Biomediche, Metaboliche e Neuroscienze
Sezione Fisiologia e Neuroscienze
Univ. di Modena e Reggio Emilia
Via Campi 287
I-41125 Modena, Italy
Tel: +39-059-205-5742
Fax: +39-059-205-5363


From andrea.cantieni at phsz.ch  Tue Dec  4 15:10:50 2012
From: andrea.cantieni at phsz.ch (Andrea Cantieni)
Date: Tue, 4 Dec 2012 14:10:50 +0000
Subject: [R-sig-ME] number of random-effects levels
Message-ID: <F4A166428041EA44893A6FF6AAC1AA36438838@ex01.phsz.loc>

Hello

I am fitting a classroom data set with lmer() with completely nested data, i.e. pupils are nested within classes, and classes are nested within schools. I have read about the random effects levels: "...there must be a reasonable number of random-effects levels (e.g. blocks) ? more than 5 or 6 at a minimum." (http://glmm.wikidot.com/faq).

The model looks like

fit0 <- lmer(theta ~ (1|CLASSID) + (1|SCHOOLID), data.ml)

and the contingency table looks like

xtabs(~ SCHOOLID, unique(subset(data.ml, select=c(SCHOOLID,CLASSID))))

SCHOOLID
1  2  3  5  6  7  8  9 10 12 13 14 15 16 
5  3  3  4  8  3  1  3  4  2  5  3  3  2 

My question is, whether the reasonable number of random-effects levels of 5 or 6 means the total number of levels (i.e. 49 for CLASSID, and 14 for SCHOOLID) or the numbers of levels for CLASSID within SCHOOLID (i.e. 1 to 8 for CLASSID).

Any idea?

Thanks a lot, 
Andrea

__________________________________________

Andrea Cantieni

Institut f?r Medien und Schule IMS
P?dagogische Hochschule Zentralschweiz
Hochschule Schwyz
Zaystrasse 42
CH-6410 Goldau

andrea.cantieni at phsz.ch
http://www.ims.phz.ch


From bbolker at gmail.com  Tue Dec  4 15:12:35 2012
From: bbolker at gmail.com (Ben Bolker)
Date: Tue, 04 Dec 2012 09:12:35 -0500
Subject: [R-sig-ME] Wald's test
In-Reply-To: <CAMkX5N8u23m8TU9MdMXOQEueCtbZ0WRGUikVLAVRKahr6ruTMQ@mail.gmail.com>
References: <CAMkX5N8u23m8TU9MdMXOQEueCtbZ0WRGUikVLAVRKahr6ruTMQ@mail.gmail.com>
Message-ID: <50BE04D3.80209@gmail.com>


[I'm taking the liberty of cc'ing r-sig-mixed-models ... I strongly
prefer *not* to answer mixed models questions offline, for a variety of
reasons.]

On 12-12-03 02:12 PM, Justin Chase wrote:
> Hi there Dr. Bolker.
> 
> I have a question regarding both your 2008 paper in TREE and your
> response to Helios de Rosario's mixed model question on the
> R-sig-mixed-models mailing list. I am analyzing count data (transformed
> for normality) from a slightly unbalanced split-plot lab experiment. I
> have two fixed factors, one whole-plot and one sub-plot, with "plot" as
> random factor. the model looks like this:
> 
> *y = ? + A_i + B_j + A*B_ij + C_k (B_i ) + A*C(B_i )_jk + e_l(ijk) *
> 
> I have been using the nlme package in R to test the significance of
> fixed factors and their interaction on my univariate data, following
> chapter 19 in The R Book (Crawley 2007). 

  I don't actually have Crawley's book (although I probably should, if
  only to find out what he's telling people to do).

> However, I'm not interested in
> analyzing coefficients of individual effects (treatment levels) like
> Bates does, but just want a significance test for whole factors. Because
> I don't want to prioritize either fixed factor, I prefer to generate
> type II SS estimates. Like Helios de Rosario, I used the Anova function
> in the car package to generate type II anova tables with Wald's Chi
> Square test and P values (because the F test is not available for this
> type of model). The results seem very reasonable and are fairly
> consistent with some least squares tests I've done on the same data
> using aov (reordering terms to get "type II" results). I've read your
> response to Helios's inquiry but unfortunately it was a bit over my
> head. According to your paper in TREE, my data should be analyzed with
> REML and F tests, but only Wald's X2 is available in R. Do you think I'm
> on the right track or should I just forget about using REML and analyze
> with aov on least squares fits (laboriously rearranging model terms to
> get type II tests)?

  Hmm.  Obviously I don't have your exact model, but I'm trying to
figure out what's wrong with, for example,

library(nlme)
fm1 <- lme(distance ~ age, data = Orthodont) # random is ~ age
anova(fm1,type="marginal")

##             numDF denDF  F-value p-value
## (Intercept)     1    80 467.4406  <.0001
## age             1    80  85.8464  <.0001

?  see anova.lme

Some of the complexity of the 2008 paper is due to the fact
that GLMMs are more challenging in several respects than LMMs.

> Also, should I be testing for overdispersion when using the Wald test,
> even though I'm just modelling Gaussian data with lme?

  No. The Gaussian family has an adjustable scale parameter (i.e.,
the variance is estimated from the data, rather than [as in the
binomial or Poisson families] fixed at a theoretical value)


From justinwchase1 at gmail.com  Tue Dec  4 16:15:56 2012
From: justinwchase1 at gmail.com (Justin Chase)
Date: Tue, 4 Dec 2012 11:15:56 -0400
Subject: [R-sig-ME] Wald's test
In-Reply-To: <50BE04D3.80209@gmail.com>
References: <CAMkX5N8u23m8TU9MdMXOQEueCtbZ0WRGUikVLAVRKahr6ruTMQ@mail.gmail.com>
	<50BE04D3.80209@gmail.com>
Message-ID: <CAMkX5N9fiU=HH71sx-DNuhn3Z=LLb77OAnKhK4EnfO=9wXVgwQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121204/2fdeaf6c/attachment.pl>

From gpagnoni at gmail.com  Mon Dec  3 09:03:30 2012
From: gpagnoni at gmail.com (Giuseppe Pagnoni)
Date: Mon, 3 Dec 2012 09:03:30 +0100
Subject: [R-sig-ME] Repeated-measures anova with a within-subject covariate
	(or varying slopes random-effects?)
Message-ID: <FE55500E-1EBF-4D44-90EA-F3077F6DF73E@gmail.com>

Dear all,

I am having quite a hard time in trying to figure out how to correctly
spell out a model in R (a repeated-measures anova with a
within-subject covariate, I guess).  Even though I have read in the
posting guide that statistical advice may or may not get an answer on
this list, I decided to try it anyway, hoping not to incur in
somebody's ire for misusing the tool.

For the sake of clarity, I will explain the problem.

We conducted an experiment measuring average response times in a
cognitive task. The task has two types of stimuli (stim1, stim2) and
was performed in a 6-run session, where subjects performed the task
under condition A on odd-numbered runs and under condition B on
even-numbered runs.  Thus, the temporal sequence of the runs was the
following:

- run 1: cond A
- run 2: cond B
- run 3: cond A
- run 4: cond B
- run 5: cond A
- run 6: cond B

where for each run and for each subject, an average RT was collected
for stim1 and for stim2.

After collecting and plotting the data, an approximately linear
decrease in RT from run1 to run6 was apparent in most subjects
(practice effect: subjects become better and faster with time).

Now, I am struggling with how to properly specify a model to perform
the group analysis by taking into account this confounding practice
effect, so that the real effects of interest (the main effect of
condition, and the interaction of condition and stimulus type) can be
better assessed.

I used a dataframe in long format, with `subj', `rt' (response time),
`stim' (stim1, stim2), `cond' (A, B), and `run' (1 to 6) as columns,
where `run' is coded as an integer so that it can be used for modeling
a linear trend. The R command I tried is:

 rt.aov <- aov(rt ~ run + stim * cond + Error(subj /(run + stim * cond)), data=rt.df)

but I am not at all sure that the error term is correctly specified.

Furthermore, we have also collected data on an additional batch of
subjects that performed the task in the 6-run session but with the
order of conditions A and B reversed (A on even-numbered runs and B on
odd-numbered runs); now, if we wanted to analyze the data from the two
groups of subjects together, by including a between-subjects group
factor (groupAB, groupBA), would the model specification become
something like the following?

   rt.aov <- aov(rt ~ run + group * stim * cond + Error(subj /(run + stim * cond)), data=rt.df)

Perhaps should lme() be used instead (and with which formula?)?

Many thanks in advance to anybody who'd be so kind to offer their
advice or tip on this.  I have scoured the web and some textbooks for
a few days now, but to little avail.

very best

giuseppe
 -- 
Giuseppe Pagnoni
Dip. Scienze Biomediche, Metaboliche e Neuroscienze
Sezione Fisiologia e Neuroscienze
Univ. di Modena e Reggio Emilia
Via Campi 287
I-41125 Modena, Italy
Tel: +39-059-205-5742
Fax: +39-059-205-5363


From m.paul at envt.fr  Tue Dec  4 09:05:11 2012
From: m.paul at envt.fr (PAUL, Mathilde)
Date: Tue, 4 Dec 2012 09:05:11 +0100 (CET)
Subject: [R-sig-ME] extracting qAIC or quasi-likelihood from glmmPQL
In-Reply-To: <50B8C7CA.8060302@mcmaster.ca>
References: <50B8C7CA.8060302@mcmaster.ca>
Message-ID: <20716690.25342.1354608312713.JavaMail.root@bnf3>

Hello,

I am an epidemiologist working with spatially correlated data. I am using glmmPQL to fit spatial generalized linear mixed models (and have no alternative options as this seems to be the only way to specify the spatial correlation as a random effect).
I read Ben Bolker's document online about quasi-AIC (http://cran.r-project.org/web/packages/bbmle/vignettes/quasi.pdf) but it seems that nothing has been implemented for glmmPQL.
Does anybody know how to extract quasi-likelihood from glmmPQL outputs ? (Or any way to get quasi-AIC from glmmPQL ?) I could not find any response in R-help archives.

Here is Ben Bolker's reply:
"The only thing I can think of is to hack the source of the glmmPQL function to remove the lines that explicitly erase the log-likelihood.
Even here I would want to be *very* careful and make sure that the AIC comparisons were roughly in line with those of other packages in cases where the functionality overlapped."

Many thanks,

Mathilde Paul
Epidemiologist
Toulouse Veterinary College (France)


From jfox at mcmaster.ca  Wed Dec  5 01:32:42 2012
From: jfox at mcmaster.ca (John Fox)
Date: Tue, 04 Dec 2012 19:32:42 -0500
Subject: [R-sig-ME] Wald's test
In-Reply-To: <CAMkX5N9fiU=HH71sx-DNuhn3Z=LLb77OAnKhK4EnfO=9wXVgwQ@mail.gmail.com>
References: <CAMkX5N8u23m8TU9MdMXOQEueCtbZ0WRGUikVLAVRKahr6ruTMQ@mail.gmail.com>
	<50BE04D3.80209@gmail.com>
	<CAMkX5N9fiU=HH71sx-DNuhn3Z=LLb77OAnKhK4EnfO=9wXVgwQ@mail.gmail.com>
Message-ID: <web-435327152@cgpsrv2.cis.mcmaster.ca>

Dear Justin,

The documentation in ?anova.lme seems very clear to me -- what is described for type="marginal" is what is often called type III tests, though for these to be sensible in models with interactions, careful attention has to be paid to contrast coding. The Anova() function in the car package has methods for type II tests for models fit by lme() in the nlme package and lmer() in the lme4 package.

I hope this helps,
 John

------------------------------------------------
John Fox
Sen. William McMaster Prof. of Social Statistics
Department of Sociology
McMaster University
Hamilton, Ontario, Canada
http://socserv.mcmaster.ca/jfox/

On Tue, 4 Dec 2012 11:15:56 -0400
 Justin Chase <justinwchase1 at gmail.com> wrote:
> Thanks Dr. Bolker!  I have one issue though: I was able to generate F tests
> for my lme models using your suggestion anova(fm1,type="marginal")   ,
> however, it is my understanding that "marginal" typically refers to Type 3
> sums-of-squares, which is discouraged. I'm looking to generate Type 2 tests
> (i.e., "conditional"). The help file for anova() does not explain what the
> word "marginal" means in the context of the function, thus I've cc'd John
> Fox, who may be able to confirm whether or not this is Type II SS.
> 
> Thanks!
> 
> Justin
> 
> On Tue, Dec 4, 2012 at 10:12 AM, Ben Bolker <bbolker at gmail.com> wrote:
> 
> >
> > [I'm taking the liberty of cc'ing r-sig-mixed-models ... I strongly
> > prefer *not* to answer mixed models questions offline, for a variety of
> > reasons.]
> >
> > On 12-12-03 02:12 PM, Justin Chase wrote:
> > > Hi there Dr. Bolker.
> > >
> > > I have a question regarding both your 2008 paper in TREE and your
> > > response to Helios de Rosario's mixed model question on the
> > > R-sig-mixed-models mailing list. I am analyzing count data (transformed
> > > for normality) from a slightly unbalanced split-plot lab experiment. I
> > > have two fixed factors, one whole-plot and one sub-plot, with "plot" as
> > > random factor. the model looks like this:
> > >
> > > *y = ? + A_i + B_j + A*B_ij + C_k (B_i ) + A*C(B_i )_jk + e_l(ijk) *
> > >
> > > I have been using the nlme package in R to test the significance of
> > > fixed factors and their interaction on my univariate data, following
> > > chapter 19 in The R Book (Crawley 2007).
> >
> >   I don't actually have Crawley's book (although I probably should, if
> >   only to find out what he's telling people to do).
> >
> > > However, I'm not interested in
> > > analyzing coefficients of individual effects (treatment levels) like
> > > Bates does, but just want a significance test for whole factors. Because
> > > I don't want to prioritize either fixed factor, I prefer to generate
> > > type II SS estimates. Like Helios de Rosario, I used the Anova function
> > > in the car package to generate type II anova tables with Wald's Chi
> > > Square test and P values (because the F test is not available for this
> > > type of model). The results seem very reasonable and are fairly
> > > consistent with some least squares tests I've done on the same data
> > > using aov (reordering terms to get "type II" results). I've read your
> > > response to Helios's inquiry but unfortunately it was a bit over my
> > > head. According to your paper in TREE, my data should be analyzed with
> > > REML and F tests, but only Wald's X2 is available in R. Do you think I'm
> > > on the right track or should I just forget about using REML and analyze
> > > with aov on least squares fits (laboriously rearranging model terms to
> > > get type II tests)?
> >
> >   Hmm.  Obviously I don't have your exact model, but I'm trying to
> > figure out what's wrong with, for example,
> >
> > library(nlme)
> > fm1 <- lme(distance ~ age, data = Orthodont) # random is ~ age
> > anova(fm1,type="marginal")
> >
> > ##             numDF denDF  F-value p-value
> > ## (Intercept)     1    80 467.4406  <.0001
> > ## age             1    80  85.8464  <.0001
> >
> > ?  see anova.lme
> >
> > Some of the complexity of the 2008 paper is due to the fact
> > that GLMMs are more challenging in several respects than LMMs.
> >
> > > Also, should I be testing for overdispersion when using the Wald test,
> > > even though I'm just modelling Gaussian data with lme?
> >
> >   No. The Gaussian family has an adjustable scale parameter (i.e.,
> > the variance is estimated from the data, rather than [as in the
> > binomial or Poisson families] fixed at a theoretical value)
> >
> >
> >
> 
> 
> -- 
> *Justin W. Chase*
> MSc Candidate
> Canadian Rivers Institute
> University of New Brunswick
> 506-452-7474 (home*)
> 506-453-4845 (office)
> justinwchase1 at gmail.com
> LinkedIn Profile <http://www.linkedin.com/in/justinwchase>
> 
> 	[[alternative HTML version deleted]]
>


From justinwchase1 at gmail.com  Wed Dec  5 02:19:54 2012
From: justinwchase1 at gmail.com (Justin Chase)
Date: Tue, 4 Dec 2012 21:19:54 -0400
Subject: [R-sig-ME] Wald's test
In-Reply-To: <web-435327152@cgpsrv2.cis.mcmaster.ca>
References: <CAMkX5N8u23m8TU9MdMXOQEueCtbZ0WRGUikVLAVRKahr6ruTMQ@mail.gmail.com>
	<50BE04D3.80209@gmail.com>
	<CAMkX5N9fiU=HH71sx-DNuhn3Z=LLb77OAnKhK4EnfO=9wXVgwQ@mail.gmail.com>
	<web-435327152@cgpsrv2.cis.mcmaster.ca>
Message-ID: <CAMkX5N_HNfyb+LmVSia+hwauv9twBDeEuj5_V=+9GOrwUCS-SA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121204/0dac40d6/attachment.pl>

From bbolker at gmail.com  Wed Dec  5 02:36:09 2012
From: bbolker at gmail.com (Ben Bolker)
Date: Tue, 04 Dec 2012 20:36:09 -0500
Subject: [R-sig-ME] Wald's test
In-Reply-To: <CAMkX5N_HNfyb+LmVSia+hwauv9twBDeEuj5_V=+9GOrwUCS-SA@mail.gmail.com>
References: <CAMkX5N8u23m8TU9MdMXOQEueCtbZ0WRGUikVLAVRKahr6ruTMQ@mail.gmail.com>
	<50BE04D3.80209@gmail.com>
	<CAMkX5N9fiU=HH71sx-DNuhn3Z=LLb77OAnKhK4EnfO=9wXVgwQ@mail.gmail.com>
	<web-435327152@cgpsrv2.cis.mcmaster.ca>
	<CAMkX5N_HNfyb+LmVSia+hwauv9twBDeEuj5_V=+9GOrwUCS-SA@mail.gmail.com>
Message-ID: <50BEA509.50903@gmail.com>

  It does appear however that (as Justin said in the first place) that
car::Anova.lme does only chi-squared and not F tests (car 2.0-15).  I
haven't looked to see how hard it would be to extract the information
from the lme object to get the relevant denominator df (and I don't know
if there are theoretical complications ...)
   Even the two-model anova.lme doesn't do F tests, only likelihood
ratio tests.  Again, don't know whether this is an oversight or whether
there's some reason *not* to provide the option.  (In contrast
anova.glm() *does* provide an F test, for testing nested models with
estimated scale parameters.)


On 12-12-04 08:19 PM, Justin Chase wrote:
> Thanks Dr. Fox.
> 
> I only just figured out today that there were specific help files like
> ?anova.lme. I was trying to figure out the function using only ?anova,
> which says very little.
> That said, I did come across the package "pbkrtest" today and found that
> it provides a nice approximate type II F test (the Kenward-Roger
> approximation) for mixed effects models from lme4. I may wait for the
> Halekoh and H?jsgaard paper to come out in the Journal of Statistical
> Software before I switch to this approach, but I would be interested to
> see what others in the R community think about the package and the K-R f
> test.
> 
> Thanks again!
> 
> Justin
> 
> On Tue, Dec 4, 2012 at 8:32 PM, John Fox <jfox at mcmaster.ca
> <mailto:jfox at mcmaster.ca>> wrote:
> 
>     Dear Justin,
> 
>     The documentation in ?anova.lme seems very clear to me -- what is
>     described for type="marginal" is what is often called type III
>     tests, though for these to be sensible in models with interactions,
>     careful attention has to be paid to contrast coding. The Anova()
>     function in the car package has methods for type II tests for models
>     fit by lme() in the nlme package and lmer() in the lme4 package.
> 
>     I hope this helps,
>      John
> 
>     ------------------------------------------------
>     John Fox
>     Sen. William McMaster Prof. of Social Statistics
>     Department of Sociology
>     McMaster University
>     Hamilton, Ontario, Canada
>     http://socserv.mcmaster.ca/jfox/
> 
>     On Tue, 4 Dec 2012 11:15:56 -0400
>      Justin Chase <justinwchase1 at gmail.com
>     <mailto:justinwchase1 at gmail.com>> wrote:
>     > Thanks Dr. Bolker!  I have one issue though: I was able to
>     generate F tests
>     > for my lme models using your suggestion anova(fm1,type="marginal")   ,
>     > however, it is my understanding that "marginal" typically refers
>     to Type 3
>     > sums-of-squares, which is discouraged. I'm looking to generate
>     Type 2 tests
>     > (i.e., "conditional"). The help file for anova() does not explain
>     what the
>     > word "marginal" means in the context of the function, thus I've
>     cc'd John
>     > Fox, who may be able to confirm whether or not this is Type II SS.
>     >
>     > Thanks!
>     >
>     > Justin
>     >
>     > On Tue, Dec 4, 2012 at 10:12 AM, Ben Bolker <bbolker at gmail.com
>     <mailto:bbolker at gmail.com>> wrote:
>     >
>     > >
>     > > [I'm taking the liberty of cc'ing r-sig-mixed-models ... I strongly
>     > > prefer *not* to answer mixed models questions offline, for a
>     variety of
>     > > reasons.]
>     > >
>     > > On 12-12-03 02:12 PM, Justin Chase wrote:
>     > > > Hi there Dr. Bolker.
>     > > >
>     > > > I have a question regarding both your 2008 paper in TREE and your
>     > > > response to Helios de Rosario's mixed model question on the
>     > > > R-sig-mixed-models mailing list. I am analyzing count data
>     (transformed
>     > > > for normality) from a slightly unbalanced split-plot lab
>     experiment. I
>     > > > have two fixed factors, one whole-plot and one sub-plot, with
>     "plot" as
>     > > > random factor. the model looks like this:
>     > > >
>     > > > *y = ? + A_i + B_j + A*B_ij + C_k (B_i ) + A*C(B_i )_jk +
>     e_l(ijk) *
>     > > >
>     > > > I have been using the nlme package in R to test the
>     significance of
>     > > > fixed factors and their interaction on my univariate data,
>     following
>     > > > chapter 19 in The R Book (Crawley 2007).
>     > >
>     > >   I don't actually have Crawley's book (although I probably
>     should, if
>     > >   only to find out what he's telling people to do).
>     > >
>     > > > However, I'm not interested in
>     > > > analyzing coefficients of individual effects (treatment
>     levels) like
>     > > > Bates does, but just want a significance test for whole
>     factors. Because
>     > > > I don't want to prioritize either fixed factor, I prefer to
>     generate
>     > > > type II SS estimates. Like Helios de Rosario, I used the Anova
>     function
>     > > > in the car package to generate type II anova tables with
>     Wald's Chi
>     > > > Square test and P values (because the F test is not available
>     for this
>     > > > type of model). The results seem very reasonable and are fairly
>     > > > consistent with some least squares tests I've done on the same
>     data
>     > > > using aov (reordering terms to get "type II" results). I've
>     read your
>     > > > response to Helios's inquiry but unfortunately it was a bit
>     over my
>     > > > head. According to your paper in TREE, my data should be
>     analyzed with
>     > > > REML and F tests, but only Wald's X2 is available in R. Do you
>     think I'm
>     > > > on the right track or should I just forget about using REML
>     and analyze
>     > > > with aov on least squares fits (laboriously rearranging model
>     terms to
>     > > > get type II tests)?
>     > >
>     > >   Hmm.  Obviously I don't have your exact model, but I'm trying to
>     > > figure out what's wrong with, for example,
>     > >
>     > > library(nlme)
>     > > fm1 <- lme(distance ~ age, data = Orthodont) # random is ~ age
>     > > anova(fm1,type="marginal")
>     > >
>     > > ##             numDF denDF  F-value p-value
>     > > ## (Intercept)     1    80 467.4406  <.0001
>     > > ## age             1    80  85.8464  <.0001
>     > >
>     > > ?  see anova.lme
>     > >
>     > > Some of the complexity of the 2008 paper is due to the fact
>     > > that GLMMs are more challenging in several respects than LMMs.
>     > >
>     > > > Also, should I be testing for overdispersion when using the
>     Wald test,
>     > > > even though I'm just modelling Gaussian data with lme?
>     > >
>     > >   No. The Gaussian family has an adjustable scale parameter (i.e.,
>     > > the variance is estimated from the data, rather than [as in the
>     > > binomial or Poisson families] fixed at a theoretical value)
>     > >
>     > >
>     > >
>     >
>     >
>     > --
>     > *Justin W. Chase*
>     > MSc Candidate
>     > Canadian Rivers Institute
>     > University of New Brunswick
>     > 506-452-7474 <tel:506-452-7474> (home*)
>     > 506-453-4845 <tel:506-453-4845> (office)
>     > justinwchase1 at gmail.com <mailto:justinwchase1 at gmail.com>
>     > LinkedIn Profile <http://www.linkedin.com/in/justinwchase>
>     >
>     >       [[alternative HTML version deleted]]
>     >
> 
> 
> 
> 
> 
> -- 
> *Justin W. Chase*
> MSc Candidate
> Canadian Rivers Institute
> University of New Brunswick
> 506-452-7474(home*)
> 506-453-4845(office)
> justinwchase1 at gmail.com <mailto:justinwchase1 at gmail.com>
> LinkedIn Profile <http://www.linkedin.com/in/justinwchase>
>


From jfox at mcmaster.ca  Wed Dec  5 03:27:32 2012
From: jfox at mcmaster.ca (John Fox)
Date: Tue, 04 Dec 2012 21:27:32 -0500
Subject: [R-sig-ME] Wald's test
In-Reply-To: <50BEA509.50903@gmail.com>
References: <CAMkX5N8u23m8TU9MdMXOQEueCtbZ0WRGUikVLAVRKahr6ruTMQ@mail.gmail.com>
	<50BE04D3.80209@gmail.com>
	<CAMkX5N9fiU=HH71sx-DNuhn3Z=LLb77OAnKhK4EnfO=9wXVgwQ@mail.gmail.com>
	<web-435327152@cgpsrv2.cis.mcmaster.ca>
	<CAMkX5N_HNfyb+LmVSia+hwauv9twBDeEuj5_V=+9GOrwUCS-SA@mail.gmail.com>
	<50BEA509.50903@gmail.com>
Message-ID: <web-435334758@cgpsrv2.cis.mcmaster.ca>

Dear Ben.

Anova.lme() in car does only chisquare tests, but Anova.lmer() also does F-tests using the KR df computed by the pbkrtest package only for models fit by lmer(). That package was also mentioned by Justin in his last posting.

Best,
 John

On Tue, 04 Dec 2012 20:36:09 -0500
 Ben Bolker <bbolker at gmail.com> wrote:
>   It does appear however that (as Justin said in the first place) that
> car::Anova.lme does only chi-squared and not F tests (car 2.0-15).  I
> haven't looked to see how hard it would be to extract the information
> from the lme object to get the relevant denominator df (and I don't know
> if there are theoretical complications ...)
>    Even the two-model anova.lme doesn't do F tests, only likelihood
> ratio tests.  Again, don't know whether this is an oversight or whether
> there's some reason *not* to provide the option.  (In contrast
> anova.glm() *does* provide an F test, for testing nested models with
> estimated scale parameters.)
> 
> 
> On 12-12-04 08:19 PM, Justin Chase wrote:
> > Thanks Dr. Fox.
> > 
> > I only just figured out today that there were specific help files like
> > ?anova.lme. I was trying to figure out the function using only ?anova,
> > which says very little.
> > That said, I did come across the package "pbkrtest" today and found that
> > it provides a nice approximate type II F test (the Kenward-Roger
> > approximation) for mixed effects models from lme4. I may wait for the
> > Halekoh and H?jsgaard paper to come out in the Journal of Statistical
> > Software before I switch to this approach, but I would be interested to
> > see what others in the R community think about the package and the K-R f
> > test.
> > 
> > Thanks again!
> > 
> > Justin
> > 
> > On Tue, Dec 4, 2012 at 8:32 PM, John Fox <jfox at mcmaster.ca
> > <mailto:jfox at mcmaster.ca>> wrote:
> > 
> >     Dear Justin,
> > 
> >     The documentation in ?anova.lme seems very clear to me -- what is
> >     described for type="marginal" is what is often called type III
> >     tests, though for these to be sensible in models with interactions,
> >     careful attention has to be paid to contrast coding. The Anova()
> >     function in the car package has methods for type II tests for models
> >     fit by lme() in the nlme package and lmer() in the lme4 package.
> > 
> >     I hope this helps,
> >      John
> > 
> >     ------------------------------------------------
> >     John Fox
> >     Sen. William McMaster Prof. of Social Statistics
> >     Department of Sociology
> >     McMaster University
> >     Hamilton, Ontario, Canada
> >     http://socserv.mcmaster.ca/jfox/
> > 
> >     On Tue, 4 Dec 2012 11:15:56 -0400
> >      Justin Chase <justinwchase1 at gmail.com
> >     <mailto:justinwchase1 at gmail.com>> wrote:
> >     > Thanks Dr. Bolker!  I have one issue though: I was able to
> >     generate F tests
> >     > for my lme models using your suggestion anova(fm1,type="marginal")   ,
> >     > however, it is my understanding that "marginal" typically refers
> >     to Type 3
> >     > sums-of-squares, which is discouraged. I'm looking to generate
> >     Type 2 tests
> >     > (i.e., "conditional"). The help file for anova() does not explain
> >     what the
> >     > word "marginal" means in the context of the function, thus I've
> >     cc'd John
> >     > Fox, who may be able to confirm whether or not this is Type II SS.
> >     >
> >     > Thanks!
> >     >
> >     > Justin
> >     >
> >     > On Tue, Dec 4, 2012 at 10:12 AM, Ben Bolker <bbolker at gmail.com
> >     <mailto:bbolker at gmail.com>> wrote:
> >     >
> >     > >
> >     > > [I'm taking the liberty of cc'ing r-sig-mixed-models ... I strongly
> >     > > prefer *not* to answer mixed models questions offline, for a
> >     variety of
> >     > > reasons.]
> >     > >
> >     > > On 12-12-03 02:12 PM, Justin Chase wrote:
> >     > > > Hi there Dr. Bolker.
> >     > > >
> >     > > > I have a question regarding both your 2008 paper in TREE and your
> >     > > > response to Helios de Rosario's mixed model question on the
> >     > > > R-sig-mixed-models mailing list. I am analyzing count data
> >     (transformed
> >     > > > for normality) from a slightly unbalanced split-plot lab
> >     experiment. I
> >     > > > have two fixed factors, one whole-plot and one sub-plot, with
> >     "plot" as
> >     > > > random factor. the model looks like this:
> >     > > >
> >     > > > *y = ? + A_i + B_j + A*B_ij + C_k (B_i ) + A*C(B_i )_jk +
> >     e_l(ijk) *
> >     > > >
> >     > > > I have been using the nlme package in R to test the
> >     significance of
> >     > > > fixed factors and their interaction on my univariate data,
> >     following
> >     > > > chapter 19 in The R Book (Crawley 2007).
> >     > >
> >     > >   I don't actually have Crawley's book (although I probably
> >     should, if
> >     > >   only to find out what he's telling people to do).
> >     > >
> >     > > > However, I'm not interested in
> >     > > > analyzing coefficients of individual effects (treatment
> >     levels) like
> >     > > > Bates does, but just want a significance test for whole
> >     factors. Because
> >     > > > I don't want to prioritize either fixed factor, I prefer to
> >     generate
> >     > > > type II SS estimates. Like Helios de Rosario, I used the Anova
> >     function
> >     > > > in the car package to generate type II anova tables with
> >     Wald's Chi
> >     > > > Square test and P values (because the F test is not available
> >     for this
> >     > > > type of model). The results seem very reasonable and are fairly
> >     > > > consistent with some least squares tests I've done on the same
> >     data
> >     > > > using aov (reordering terms to get "type II" results). I've
> >     read your
> >     > > > response to Helios's inquiry but unfortunately it was a bit
> >     over my
> >     > > > head. According to your paper in TREE, my data should be
> >     analyzed with
> >     > > > REML and F tests, but only Wald's X2 is available in R. Do you
> >     think I'm
> >     > > > on the right track or should I just forget about using REML
> >     and analyze
> >     > > > with aov on least squares fits (laboriously rearranging model
> >     terms to
> >     > > > get type II tests)?
> >     > >
> >     > >   Hmm.  Obviously I don't have your exact model, but I'm trying to
> >     > > figure out what's wrong with, for example,
> >     > >
> >     > > library(nlme)
> >     > > fm1 <- lme(distance ~ age, data = Orthodont) # random is ~ age
> >     > > anova(fm1,type="marginal")
> >     > >
> >     > > ##             numDF denDF  F-value p-value
> >     > > ## (Intercept)     1    80 467.4406  <.0001
> >     > > ## age             1    80  85.8464  <.0001
> >     > >
> >     > > ?  see anova.lme
> >     > >
> >     > > Some of the complexity of the 2008 paper is due to the fact
> >     > > that GLMMs are more challenging in several respects than LMMs.
> >     > >
> >     > > > Also, should I be testing for overdispersion when using the
> >     Wald test,
> >     > > > even though I'm just modelling Gaussian data with lme?
> >     > >
> >     > >   No. The Gaussian family has an adjustable scale parameter (i.e.,
> >     > > the variance is estimated from the data, rather than [as in the
> >     > > binomial or Poisson families] fixed at a theoretical value)
> >     > >
> >     > >
> >     > >
> >     >
> >     >
> >     > --
> >     > *Justin W. Chase*
> >     > MSc Candidate
> >     > Canadian Rivers Institute
> >     > University of New Brunswick
> >     > 506-452-7474 <tel:506-452-7474> (home*)
> >     > 506-453-4845 <tel:506-453-4845> (office)
> >     > justinwchase1 at gmail.com <mailto:justinwchase1 at gmail.com>
> >     > LinkedIn Profile <http://www.linkedin.com/in/justinwchase>
> >     >
> >     >       [[alternative HTML version deleted]]
> >     >
> > 
> > 
> > 
> > 
> > 
> > -- 
> > *Justin W. Chase*
> > MSc Candidate
> > Canadian Rivers Institute
> > University of New Brunswick
> > 506-452-7474(home*)
> > 506-453-4845(office)
> > justinwchase1 at gmail.com <mailto:justinwchase1 at gmail.com>
> > LinkedIn Profile <http://www.linkedin.com/in/justinwchase>
> > 
>


From bbolker at gmail.com  Wed Dec  5 04:56:25 2012
From: bbolker at gmail.com (Ben Bolker)
Date: Wed, 5 Dec 2012 03:56:25 +0000 (UTC)
Subject: [R-sig-ME] number of random-effects levels
References: <F4A166428041EA44893A6FF6AAC1AA36438838@ex01.phsz.loc>
Message-ID: <loom.20121205T045226-443@post.gmane.org>

Andrea Cantieni <andrea.cantieni at ...> writes:


> I am fitting a classroom data set with lmer() with completely nested
> data, i.e. pupils are nested within classes, and classes are nested
> within schools. I have read about the random effects levels:
> "...there must be a reasonable number of random-effects levels
> (e.g. blocks) ? more than 5 or 6 at a minimum."
> (http://glmm.wikidot.com/faq).

> 
> The model looks like
> 
> fit0 <- lmer(theta ~ (1|CLASSID) + (1|SCHOOLID), data.ml)
> 
> and the contingency table looks like
> 
> xtabs(~ SCHOOLID, unique(subset(data.ml, select=c(SCHOOLID,CLASSID))))
> 
> SCHOOLID
> 1  2  3  5  6  7  8  9 10 12 13 14 15 16 
> 5  3  3  4  8  3  1  3  4  2  5  3  3  2 
 
> My question is, whether the reasonable number of random-effects
> levels of 5 or 6 means the total number of levels (i.e. 49 for
> CLASSID, and 14 for SCHOOLID) or the numbers of levels for CLASSID
> within SCHOOLID (i.e. 1 to 8 for CLASSID).

  It's the former; it's the number of random-effects values from which you're
trying to estimate the relevant variances.  Since you're assuming that
the variance of classes within schools is the same for all schools,
you have all 49 classes with which to estimate the variance.
If you were trying to fit a model where the variance itself varied
from school to school, you'd probably be in trouble, because then
you'd be trying to fit the variance from very small numbers of
samples (although you could imagine making the variance itself
a random effect that varied among schools ... but (a) this would
be a bit hard to specify in lmer [I would probably try BUGS for that
model] and (b) you might still have trouble because of lack of
data for this model -- my guess would be that you'd end up with
an estimate of zero among-school variation in variance ...)


From andrea.cantieni at phsz.ch  Wed Dec  5 09:53:29 2012
From: andrea.cantieni at phsz.ch (Andrea Cantieni)
Date: Wed, 5 Dec 2012 08:53:29 +0000
Subject: [R-sig-ME] number of random-effects levels
In-Reply-To: <loom.20121205T045226-443@post.gmane.org>
References: <F4A166428041EA44893A6FF6AAC1AA36438838@ex01.phsz.loc>
	<loom.20121205T045226-443@post.gmane.org>
Message-ID: <F4A166428041EA44893A6FF6AAC1AA36438BC0@ex01.phsz.loc>

Dear Ben,

Thank you very much! That helps me.

Best, Andrea


Am 05.12.2012 um 04:56 schrieb Ben Bolker <bbolker at gmail.com>:

> Andrea Cantieni <andrea.cantieni at ...> writes:
> 
> 
>> I am fitting a classroom data set with lmer() with completely nested
>> data, i.e. pupils are nested within classes, and classes are nested
>> within schools. I have read about the random effects levels:
>> "...there must be a reasonable number of random-effects levels
>> (e.g. blocks) ? more than 5 or 6 at a minimum."
>> (http://glmm.wikidot.com/faq).
> 
>> 
>> The model looks like
>> 
>> fit0 <- lmer(theta ~ (1|CLASSID) + (1|SCHOOLID), data.ml)
>> 
>> and the contingency table looks like
>> 
>> xtabs(~ SCHOOLID, unique(subset(data.ml, select=c(SCHOOLID,CLASSID))))
>> 
>> SCHOOLID
>> 1  2  3  5  6  7  8  9 10 12 13 14 15 16 
>> 5  3  3  4  8  3  1  3  4  2  5  3  3  2 
> 
>> My question is, whether the reasonable number of random-effects
>> levels of 5 or 6 means the total number of levels (i.e. 49 for
>> CLASSID, and 14 for SCHOOLID) or the numbers of levels for CLASSID
>> within SCHOOLID (i.e. 1 to 8 for CLASSID).
> 
>  It's the former; it's the number of random-effects values from which you're
> trying to estimate the relevant variances.  Since you're assuming that
> the variance of classes within schools is the same for all schools,
> you have all 49 classes with which to estimate the variance.
> If you were trying to fit a model where the variance itself varied
> from school to school, you'd probably be in trouble, because then
> you'd be trying to fit the variance from very small numbers of
> samples (although you could imagine making the variance itself
> a random effect that varied among schools ... but (a) this would
> be a bit hard to specify in lmer [I would probably try BUGS for that
> model] and (b) you might still have trouble because of lack of
> data for this model -- my guess would be that you'd end up with
> an estimate of zero among-school variation in variance ...)
> 
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models


From Christoph.Scherber at agr.uni-goettingen.de  Wed Dec  5 10:12:54 2012
From: Christoph.Scherber at agr.uni-goettingen.de (Christoph Scherber)
Date: Wed, 05 Dec 2012 10:12:54 +0100
Subject: [R-sig-ME] Are mixed models a cure for pseudoreplication?
Message-ID: <50BF1016.20302@agr.uni-goettingen.de>

Dear all,

I have sampled grasshoppers from a set of 40 sites on 10 transects per site.

Now if I analyse the pooled data (N=40), the minimal adequate model is the null model.

However, if I account for non-independence and include site as a random effect ("pseudoreplicated"
N=400), I can see much clearer relationships, and the minimal adequate model contains three
explanatory variables plus a two-way interaction.

Which model is correct? The pooled (non-lme) one, or the lme?

I have the feeling that the pooled model gets it wrong in making me believe that "nothing happens"
in the data, while the mixed model is nicer but obviously inflates standard errors.

Any suggestions?

Best wishes,
Christoph



-- 
PD Dr Christoph Scherber
Georg-August University Goettingen
Department of Crop Science
Agroecology
Grisebachstrasse 6
D-37077 Goettingen
Germany
phone 0049 (0)551 39 8807
fax 0049 (0)551 39 8806
http://www.gwdg.de/~cscherb1

From logodall at yahoo.fr  Wed Dec  5 15:32:15 2012
From: logodall at yahoo.fr (logodall)
Date: Wed, 5 Dec 2012 14:32:15 +0000 (GMT)
Subject: [R-sig-ME] (no subject)
Message-ID: <1354717935.14632.BPMail_high_noncarrier@web133004.mail.ir2.yahoo.com>


http://ceramiccoatingsfl.com/www.ABCnews.newsreport.jobforyou35.php


From chunxuan at outlook.com  Wed Dec  5 14:25:33 2012
From: chunxuan at outlook.com (sh. chunxuan)
Date: Wed, 5 Dec 2012 13:25:33 +0000
Subject: [R-sig-ME] Suggestions on my analysis with longitudinal data?
Message-ID: <SNT002-W27732313378CA5FE2F657CCE460@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121205/e0672d68/attachment.pl>

From chunxuan at outlook.com  Wed Dec  5 21:09:00 2012
From: chunxuan at outlook.com (sh. chunxuan)
Date: Wed, 5 Dec 2012 21:09:00 +0100
Subject: [R-sig-ME] Suggestions on my analysis with longitudinal data?
In-Reply-To: <C6D620AD-4255-4ACF-8F5F-39C4210CC5AF@mail.nih.gov>
References: <SNT002-W27732313378CA5FE2F657CCE460@phx.gbl>,
	<C6D620AD-4255-4ACF-8F5F-39C4210CC5AF@mail.nih.gov>
Message-ID: <SNT002-W5218C8B99DDAF30A1CB69BCE460@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121205/53dbd389/attachment.pl>

From schaeffer.robert at gmail.com  Wed Dec  5 22:16:21 2012
From: schaeffer.robert at gmail.com (Robert Schaeffer)
Date: Wed, 5 Dec 2012 16:16:21 -0500
Subject: [R-sig-ME] =?windows-1252?q?Binomial_GLMM_-_Error_=28invalid_clas?=
	=?windows-1252?q?s_=93mer=94_object=29?=
Message-ID: <CAPTzKZk2fmAAugy-pmQaj=Y0tRcqdTRgyw=g+BffEN+a_154sw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121205/dac3a081/attachment.pl>

From chunxuan at outlook.com  Wed Dec  5 22:13:43 2012
From: chunxuan at outlook.com (sh. chunxuan)
Date: Wed, 5 Dec 2012 22:13:43 +0100
Subject: [R-sig-ME] Suggestions on my analysis with longitudinal data?
In-Reply-To: <D3DFA55B-1DC1-4BE5-982F-CF0C0E9E8F6A@mail.nih.gov>
References: <SNT002-W27732313378CA5FE2F657CCE460@phx.gbl>,
	<C6D620AD-4255-4ACF-8F5F-39C4210CC5AF@mail.nih.gov>,
	<SNT002-W5218C8B99DDAF30A1CB69BCE460@phx.gbl>,
	<D3DFA55B-1DC1-4BE5-982F-CF0C0E9E8F6A@mail.nih.gov>
Message-ID: <SNT002-W1146B68A83745D08A18F1C5CE460@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121205/7def7024/attachment.pl>

From Thierry.ONKELINX at inbo.be  Thu Dec  6 09:49:06 2012
From: Thierry.ONKELINX at inbo.be (ONKELINX, Thierry)
Date: Thu, 6 Dec 2012 08:49:06 +0000
Subject: [R-sig-ME]
 =?windows-1252?q?Binomial_GLMM_-_Error_=28invalid_clas?=
 =?windows-1252?q?s_=93mer=94_object=29?=
In-Reply-To: <CAPTzKZk2fmAAugy-pmQaj=Y0tRcqdTRgyw=g+BffEN+a_154sw@mail.gmail.com>
References: <CAPTzKZk2fmAAugy-pmQaj=Y0tRcqdTRgyw=g+BffEN+a_154sw@mail.gmail.com>
Message-ID: <AA818EAD2576BC488B4F623941DA742794778538@inbomail.inbo.be>

Hi Robert,

Try to clean up your code. Use the data argument instead of the $ notation. And use glmer instead of lmer for generalized models. Addingspacesmakesyourcodemuchmorereadable

glmm1 <- glmer(cbind(Probes, fail) ~ Treatment * Species + (1|Bee), data = p, family = binomial)

Which version of R and lme4 are you using? The output of sessionInfo() can be informative for the developers of lme4.

Best regards,

Thierry

ir. Thierry Onkelinx
Instituut voor natuur- en bosonderzoek / Research Institute for Nature and Forest
team Biometrie & Kwaliteitszorg / team Biometrics & Quality Assurance
Kliniekstraat 25
1070 Anderlecht
Belgium
+ 32 2 525 02 51
+ 32 54 43 61 85
Thierry.Onkelinx at inbo.be
www.inbo.be

To call in the statistician after the experiment is done may be no more than asking him to perform a post-mortem examination: he may be able to say what the experiment died of.
~ Sir Ronald Aylmer Fisher

The plural of anecdote is not data.
~ Roger Brinner

The combination of some data and an aching desire for an answer does not ensure that a reasonable answer can be extracted from a given body of data.
~ John Tukey

-----Oorspronkelijk bericht-----
Van: r-sig-mixed-models-bounces at r-project.org [mailto:r-sig-mixed-models-bounces at r-project.org] Namens Robert Schaeffer
Verzonden: woensdag 5 december 2012 22:16
Aan: r-sig-mixed-models at r-project.org
Onderwerp: [R-sig-ME] Binomial GLMM - Error (invalid class ?mer? object)

Hi All,

I'm relatively new to using GLMMs and am attempting to run an analysis, but have encountered an error that I am not sure how to handle.

Error invalidObject(.Object) : invalid class ?mer? object: Slot Zt must by dims['q']  by dims['n']*dims['s']

I am trying to examine the effect of a treatment on the proportion of flowers probed per foraging bout in an inflorescence. There are two different pollinator species and each pollinator individual varied in the number of bouts performed. The data are structured as follows....

     Bee Plant Flowers           Species Treatment Probes fail

1     1     1      14    Bombus appositus    Nectar      4  10

2     1     2      15    Bombus appositus   Control      2  13

4     1     4      12    Bombus appositus   Control      7    5

6     1     6      15    Bombus appositus    Nectar      2  13

7     1     7      10    Bombus appositus   Control      4    6

12    1    12      15  Bombus appositus   Control    11    4

13    2     1      14   Bombus flavifrons     Nectar    14    0

14    2     2      15   Bombus flavifrons    Control      8    7

15    2     3      15   Bombus flavifrons     Nectar      7    8

16    2     4      12   Bombus flavifrons    Control      4    8

17    2     5      16   Bombus flavifrons     Nectar      4  12

18    2     6      13   Bombus flavifrons    Control      5    8

19    2     8      14   Bombus flavifrons     Nectar      1  13

20    2     8      14   Bombus flavifrons     Nectar      5    9

21    2     9      15   Bombus flavifrons     Nectar      7    8

......

465 36    7      10   Bombus flavifrons     Control     1    9

The model structure is as follows:

glmm1<-lmer(cbind(p$Probes,p$fail)~p$Treatment*p$Species+(1|p$Bee), family=
"binomial")

I included Bee identity as a random term to account for pseudoreplication and differences amongst Bees in the number of bouts performed. At least, I think this is the correct way to do so. However, I get the error above and am not sure how to proceed. Any thoughts or suggestions would be greatly appreciated.


Cheers,

 Robert Schaeffer

        [[alternative HTML version deleted]]

* * * * * * * * * * * * * D I S C L A I M E R * * * * * * * * * * * * *
Dit bericht en eventuele bijlagen geven enkel de visie van de schrijver weer en binden het INBO onder geen enkel beding, zolang dit bericht niet bevestigd is door een geldig ondertekend document.
The views expressed in this message and any annex are purely those of the writer and may not be regarded as stating an official position of INBO, as long as the message is not confirmed by a duly signed document.


From v_coudrain at voila.fr  Thu Dec  6 12:08:54 2012
From: v_coudrain at voila.fr (Valerie)
Date: Thu, 6 Dec 2012 11:08:54 +0000 (UTC)
Subject: [R-sig-ME] =?utf-8?q?Binomial_GLMM_-_Error_=28invalid_class_?=
	=?utf-8?b?4oCcbWVy4oCdIG9iamVjdCk=?=
References: <CAPTzKZk2fmAAugy-pmQaj=Y0tRcqdTRgyw=g+BffEN+a_154sw@mail.gmail.com>
	<AA818EAD2576BC488B4F623941DA742794778538@inbomail.inbo.be>
Message-ID: <loom.20121206T120513-6@post.gmane.org>



Hi,

I have a question about your data, but not sure if it is related to the problem. 
"Species" and "Bee" are the same, isn't it? Can we then put species as fix 
faxtor and Bee as a random? 

Best,
Valerie


From roby.joehanes at nih.gov  Thu Dec  6 19:09:49 2012
From: roby.joehanes at nih.gov (Joehanes, Roby (NIH/NHLBI) [F])
Date: Thu, 6 Dec 2012 13:09:49 -0500
Subject: [R-sig-ME] Difference of lme4 between the CRAN version and the
 development version
Message-ID: <CCE6499D.4426%joehanesr@mail.nih.gov>

Hi all:

I am wondering if anyone could explain to me the difference of lme4 that is in the CRAN and of the development version. The mathematics and the method to compute the estimates for the development version are covered in the following document:
http://lme4.r-forge.r-project.org/lMMwR/lrgprt.pdf

However, I do not know any such manual for the CRAN version. Could anyone point to me to the right direction? Are the vignette documents in CRAN the right ones ( http://cran.r-project.org/web/packages/lme4/index.html )?

With this information, I hope I could troubleshoot the errors I am encountering with it and pedigreemm, primarily the dreaded Cholmod error of "Downdated X'X is not positive definite" that I am getting with the development version, but not with the CRAN version).

Thank you,
Roby


From schaeffer.robert at gmail.com  Thu Dec  6 19:24:17 2012
From: schaeffer.robert at gmail.com (Robert Schaeffer)
Date: Thu, 6 Dec 2012 13:24:17 -0500
Subject: [R-sig-ME]
	=?windows-1252?q?Binomial_GLMM_-_Error_=28invalid_clas?=
	=?windows-1252?q?s_=93mer=94_object=29?=
In-Reply-To: <AA818EAD2576BC488B4F623941DA742794778538@inbomail.inbo.be>
References: <CAPTzKZk2fmAAugy-pmQaj=Y0tRcqdTRgyw=g+BffEN+a_154sw@mail.gmail.com>
	<AA818EAD2576BC488B4F623941DA742794778538@inbomail.inbo.be>
Message-ID: <CAPTzKZmzBjU2jZ3hdEPA9iCZPo6pSW2S0uc6DWpT04+=CnTMmQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121206/db542188/attachment.pl>

From laurent_step at yahoo.fr  Thu Dec  6 22:18:50 2012
From: laurent_step at yahoo.fr (laurent stephane)
Date: Thu, 6 Dec 2012 21:18:50 +0000 (GMT)
Subject: [R-sig-ME] Difference of lme4 between the CRAN version and the
	development version
In-Reply-To: <CCE6499D.4426%joehanesr@mail.nih.gov>
References: <CCE6499D.4426%joehanesr@mail.nih.gov>
Message-ID: <1354828730.53221.YahooMailNeo@web171406.mail.ir2.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121206/0f615f1d/attachment.pl>

From kegurney at alaska.edu  Thu Dec  6 22:43:21 2012
From: kegurney at alaska.edu (Kirsty E. B. Gurney)
Date: Thu, 6 Dec 2012 12:43:21 -0900
Subject: [R-sig-ME] Excluding random intercepts?
Message-ID: <9F743AD1C32A4A2D8E90EB1401821A24@Wipflilatitude>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121206/0aded67e/attachment.pl>

From roby.joehanes at nih.gov  Thu Dec  6 22:48:01 2012
From: roby.joehanes at nih.gov (Joehanes, Roby (NIH/NHLBI) [F])
Date: Thu, 6 Dec 2012 16:48:01 -0500
Subject: [R-sig-ME] Difference of lme4 between the CRAN version and the
 development version
In-Reply-To: <1354828730.53221.YahooMailNeo@web171406.mail.ir2.yahoo.com>
Message-ID: <CCE67CC1.4435%joehanesr@mail.nih.gov>

Hi Stephan:

Yes, I do. Thanks for the suggestion. Unfortunately, the options do not help---the error persists:
In updateXwts(Xwts) :
  Cholmod warning 'not positive definite' at file:../Cholesky/t_cholmod_rowfac.c, line 431

The model I am running is:
y ~ Sex + Age + (...other fixed covariates...) + (1|patient_id)

where there is one observation per patient. I use pedigreemm to attach the pedigree information to the patient_id.

I understand that this model is an over-specified model because lme4 will normally throw an error. I bypassed that error by commenting the if statement that checks for it. The CRAN version of lme4 seems to run this model no problem, but the development lme4 seems to choke with CholMod complaint. Strangely enough, if I modify the model to:

y ~ Sex + Age + (...other fixed covariates...) + (1|Batch) + (1|patient_id)

then the model runs fine in both the CRAN version and the development version of lme4, to my surprise. To me, this suggests that the development version would not simply choke on over-specified model. I am thinking if there are any underlying technical problems behind the errors that I could somehow "fix" or get around.

I have read the theory and computational method for the development version of lme4. I found chapter 5 to be particularly helpful---the development lme4 also accommodates learners like me by having the parameters and variables named closely to the theory. I am in the process of reconstructing the deviance function in pure R for my learning purposes. I am digging for similar information in the CRAN version to do the same, but I have not been able to find some similar tutorial just yet. I hope that understanding the subtle nuances of the two implementations would shed lights toward the "fix".

Sincerely,
Roby

On 12/6/12 4:18 PM, "laurent stephane" <laurent_step at yahoo.fr> wrote:

Hi Roby,

With the development version do you use the options optimizer="bobyqa"  and  control=list(restart=TRUE)  when running lmer() ? Sometimes it solves some troubles.

St?phane





________________________________
 De : "Joehanes, Roby (NIH/NHLBI) [F]" <roby.joehanes at nih.gov>
 ? : "r-sig-mixed-models at r-project.org" <r-sig-mixed-models at r-project.org>
 Envoy? le : Jeudi 6 d?cembre 2012 19h09
 Objet : [R-sig-ME] Difference of lme4 between the CRAN version and the development version


Hi all:

I am wondering if anyone could explain to me the difference of lme4 that is in the CRAN and of the development version. The mathematics and the method to compute the estimates for the development version are covered in the following document:
http://lme4.r-forge.r-project.org/lMMwR/lrgprt.pdf

However, I do not know any such manual for the CRAN version. Could anyone point to me to the right direction? Are the vignette documents in CRAN the right ones ( http://cran.r-project.org/web/packages/lme4/index.html )?

With this information, I hope I could troubleshoot the errors I am encountering with it and pedigreemm, primarily the dreaded Cholmod error of "Downdated X'X is not positive definite" that I am getting with the development version, but not with the CRAN version).

Thank you,
Roby


From r.turner at auckland.ac.nz  Thu Dec  6 23:26:01 2012
From: r.turner at auckland.ac.nz (Rolf Turner)
Date: Fri, 07 Dec 2012 11:26:01 +1300
Subject: [R-sig-ME] Excluding random intercepts?
In-Reply-To: <9F743AD1C32A4A2D8E90EB1401821A24@Wipflilatitude>
References: <9F743AD1C32A4A2D8E90EB1401821A24@Wipflilatitude>
Message-ID: <50C11B79.9000001@auckland.ac.nz>

On 07/12/12 10:43, Kirsty E. B. Gurney wrote:
> Good afternoon;
>
> I have recently come across a *general question* about linear mixed models that I can't seem to find an answer for on my own.  I am hoping that one of the braintrust on this list might be willing / able to help.
>
> Specifically, I am analyzing a dataset that describes pond temperatures for a series (n = 25 ponds, 436 measurements).  Ponds were assigned to 1 of 4 treatments, and I want to find find out if temperature was affected by treatment.
>
> Pond-level inference, in general, is not of interest, so it seemed clear that POND should be included as a random effect.  However, I have good reason to believe that the change in temperature across the study was also variable by POND, and a model that includes a random slope term has good support, as determined by AIC.
>
> However, as it turns out, the covariance parameter estimate for the intercept term in the random slope model is pretty small (i.e., I think most ponds start out at a pretty similar temperature).
>
> I am just wondering if it makes good statistical sense to run a random slope model without the random intercept term?
>
> If so, does anyone know how one would one specify this in the model structure?
>
> Many thanks in advance.

This is definitely a case of the blind leading those who need glasses,  
but ....

Doing:

set.seed(42)
fake <- 
data.frame(y=rnorm(200),temp=runif(200,10,20),pond=factor(rep(letters[1:20],10)))
fit     <- lmer(y ~ temp + (0 + temp|pond),data=fake)

*seems* to give results that are compatible with the idea of fixed 
intercept and
random slope.

Almost surely someone younger and wiser will correct me if I am rong. ( 
:-) )

     cheers,

         Rolf Turner


From tom_philippi at nps.gov  Thu Dec  6 23:48:57 2012
From: tom_philippi at nps.gov (Philippi, Tom)
Date: Thu, 6 Dec 2012 14:48:57 -0800
Subject: [R-sig-ME] Excluding random intercepts?
In-Reply-To: <9F743AD1C32A4A2D8E90EB1401821A24@Wipflilatitude>
References: <9F743AD1C32A4A2D8E90EB1401821A24@Wipflilatitude>
Message-ID: <CAM9kYqgyQp5ze3qOWNNHPB+fxTOHFtuq_rVNYWj2TGZ3qf5+-Q@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121206/d5dd9409/attachment.pl>

From nebstah at hotmail.com  Thu Dec  6 22:23:23 2012
From: nebstah at hotmail.com (Ben Gillespie)
Date: Thu, 6 Dec 2012 21:23:23 +0000
Subject: [R-sig-ME] lme4 glmer general help wanted - code included
Message-ID: <DUB002-W101F4D9AE09D661E66C5239A8450@phx.gbl>

Hi guys,

I'm very new to R and have been teaching myself over the past few months -?
it's a great tool and I'm hoping to use it to analyse my PhD data.
As I'm a bit of a newb, I'd really appreciate any feedback and/or guidance?
with regards to the following questions that relate to generalized linear
mixed modelling (or, at least, I think they do!)(if there is a 'better',?
more appropriate way that I could attempt to answer my questions, please let me know).

I've spent a lot of time researching this approach on the internet, but can't
seem to find any directly applicable examples.

Thanks in advance, and, if you need any further information, please let me know.

# My experiment:
# I have 1 site on 3 different rivers (independent)(sites 1,2 and 3).?
# I visit each site 2 times (time 1 and 2).?
# On each visit, I take 5x replicate insect samples and calculate total abundance for each replicate.
# Site 1 is in an area called "yellow" and sites 2 and 3 are in an area called "blue".

# My data frame:


data=data.frame(
site=c(rep(1,10),rep(2,10),rep(3,10)),
replicate=c(rep(1:5,6)),
time=c(rep(1,5),rep(2,5),rep(1,5),rep(2,5),rep(1,5),rep(2,5)),
abundance=c(1,2,1,2,1,2,1,2,1,2,30,32,30,32,30,32,30,32,30,32,30,31,33,32,31,31,33,32,31,32),
sitetype=c(rep("yellow",10),rep("blue",20))
)

data$site=factor(data$site)
data$replicate=factor(data$replicate)
data$time=factor(data$time)

data


# Initial remarks:?
# As each replicate (1-5) was taken from within each site (1-3) on both sampling times (1-2),
# I figure that 'replicate' should be treated as nested within 'site' and that both should be treated as random factors??

# First question: Is there is difference in abundance between sites?
# Second question: Is there is difference in abundance between sitetypes (blue or yellow)?

	#If my 'initial remarks' statement is correct (please tell me if not), then I think a generalized linear mixed model is?appropriate?and would be something along these lines:

# Fitting the model:

		require(lme4)
			glmm1=glmer(abundance~time+sitetype+(1|site/replicate),family="poisson",data=data)	#I chose to use poisson as abundance is count data... is this recommended?
				summary(glmm1)
	#Output:

################################################################
Generalized linear mixed model fit by the Laplace approximation?
Formula: abundance ~ time + sitetype + (1 | site/replicate)?
? ?Data: data?
? ?AIC ? BIC logLik deviance
?12.31 19.31 -1.153 ? ?2.306
Random effects:
?Groups ? ? ? ? Name ? ? ? ?Variance Std.Dev.
?replicate:site (Intercept) ?0 ? ? ? ?0 ? ? ?
?site ? ? ? ? ? (Intercept) ?0 ? ? ? ?0 ? ? ?
Number of obs: 30, groups: replicate:site, 15; site, 3

Fixed effects:
? ? ? ? ? ? ? ?Estimate Std. Error z value Pr(>|z|) ? ?
(Intercept) ? ? 3.43579 ? ?0.05641 ? 60.91 ? <2e-16 ***
time2 ? ? ? ? ? 0.01560 ? ?0.07900 ? ?0.20 ? ?0.843 ? ?
sitetypeyellow -3.03815 ? ?0.26127 ?-11.63 ? <2e-16 ***
---
Signif. codes: ?0 ?***? 0.001 ?**? 0.01 ?*? 0.05 ?.? 0.1 ? ? 1?

Correlation of Fixed Effects:
? ? ? ? ? ? (Intr) time2?
time2 ? ? ? -0.706 ? ? ??
sitetypyllw -0.108 ?0.000
################################################################

# Inferences:

		#I'm unsure how to assess the variance and std dev scores for site... some guidance here would be appreciated....i.e. how do I answer my original question: Is there is difference in abundance between sites?
		#There is no statistically significant difference between the two time periods (P=>0.05)
		#Using the above output, the model suggests that there is a statistically significant difference between site types (p<0.05)

# Further questions:?

		#1 Are the above inferences correct?
		#2 I have read about overdispersion.... how would I test for this in this example?
		#3 How could I build an interaction term into the model and answer the following: "Is there a statistically significant site*time interaction?"
		#4 Finally, are there any obvious steps or things I should be doing in order to get a 'robust' or 'correct' answer from this problem? i.e. further tests... alternative models and comparisons...
	

Thanks again,

Rob 		 	   		  

From Thierry.ONKELINX at inbo.be  Fri Dec  7 10:49:14 2012
From: Thierry.ONKELINX at inbo.be (ONKELINX, Thierry)
Date: Fri, 7 Dec 2012 09:49:14 +0000
Subject: [R-sig-ME] lme4 glmer general help wanted - code included
In-Reply-To: <DUB002-W101F4D9AE09D661E66C5239A8450@phx.gbl>
References: <DUB002-W101F4D9AE09D661E66C5239A8450@phx.gbl>
Message-ID: <AA818EAD2576BC488B4F623941DA742794779BC2@inbomail.inbo.be>

Dear Ben,

Your dataset is to small for a mixed model. Just use a plain glm and glht() to test your hypotheses.

model <- glm(abundance ~ site + time, data = data, family = quasipoisson)
summary(model)

library(multcomp)
K <- rbind(
  SiteType = c(0, 0.5, 0.5, 0),
  Site23 = c(0, 1, -1, 0)
)
summary(glht(model, K))

Furthermore I would recommend that you do some reading (e.g. Mixed Effects Models and Extensions in Ecology with R by Zuur et al 2009) and get some local statistical advise.

Best regards,

ir. Thierry Onkelinx
Instituut voor natuur- en bosonderzoek / Research Institute for Nature and Forest
team Biometrie & Kwaliteitszorg / team Biometrics & Quality Assurance
Kliniekstraat 25
1070 Anderlecht
Belgium
+ 32 2 525 02 51
+ 32 54 43 61 85
Thierry.Onkelinx at inbo.be
www.inbo.be

To call in the statistician after the experiment is done may be no more than asking him to perform a post-mortem examination: he may be able to say what the experiment died of.
~ Sir Ronald Aylmer Fisher

The plural of anecdote is not data.
~ Roger Brinner

The combination of some data and an aching desire for an answer does not ensure that a reasonable answer can be extracted from a given body of data.
~ John Tukey

-----Oorspronkelijk bericht-----
Van: r-sig-mixed-models-bounces at r-project.org [mailto:r-sig-mixed-models-bounces at r-project.org] Namens Ben Gillespie
Verzonden: donderdag 6 december 2012 22:23
Aan: r-sig-mixed-models at r-project.org
Onderwerp: [R-sig-ME] lme4 glmer general help wanted - code included

Hi guys,

I'm very new to R and have been teaching myself over the past few months - it's a great tool and I'm hoping to use it to analyse my PhD data.
As I'm a bit of a newb, I'd really appreciate any feedback and/or guidance with regards to the following questions that relate to generalized linear mixed modelling (or, at least, I think they do!)(if there is a 'better', more appropriate way that I could attempt to answer my questions, please let me know).

I've spent a lot of time researching this approach on the internet, but can't seem to find any directly applicable examples.

Thanks in advance, and, if you need any further information, please let me know.

# My experiment:
# I have 1 site on 3 different rivers (independent)(sites 1,2 and 3). # I visit each site 2 times (time 1 and 2). # On each visit, I take 5x replicate insect samples and calculate total abundance for each replicate.
# Site 1 is in an area called "yellow" and sites 2 and 3 are in an area called "blue".

# My data frame:


data=data.frame(
site=c(rep(1,10),rep(2,10),rep(3,10)),
replicate=c(rep(1:5,6)),
time=c(rep(1,5),rep(2,5),rep(1,5),rep(2,5),rep(1,5),rep(2,5)),
abundance=c(1,2,1,2,1,2,1,2,1,2,30,32,30,32,30,32,30,32,30,32,30,31,33,32,31,31,33,32,31,32),
sitetype=c(rep("yellow",10),rep("blue",20))
)

data$site=factor(data$site)
data$replicate=factor(data$replicate)
data$time=factor(data$time)

data


# Initial remarks:
# As each replicate (1-5) was taken from within each site (1-3) on both sampling times (1-2), # I figure that 'replicate' should be treated as nested within 'site' and that both should be treated as random factors?

# First question: Is there is difference in abundance between sites?
# Second question: Is there is difference in abundance between sitetypes (blue or yellow)?

        #If my 'initial remarks' statement is correct (please tell me if not), then I think a generalized linear mixed model is appropriate and would be something along these lines:

# Fitting the model:

                require(lme4)
                        glmm1=glmer(abundance~time+sitetype+(1|site/replicate),family="poisson",data=data)      #I chose to use poisson as abundance is count data... is this recommended?
                                summary(glmm1)
        #Output:

################################################################
Generalized linear mixed model fit by the Laplace approximation
Formula: abundance ~ time + sitetype + (1 | site/replicate)
   Data: data
   AIC   BIC logLik deviance
 12.31 19.31 -1.153    2.306
Random effects:
 Groups         Name        Variance Std.Dev.
 replicate:site (Intercept)  0        0
 site           (Intercept)  0        0 Number of obs: 30, groups: replicate:site, 15; site, 3

Fixed effects:
               Estimate Std. Error z value Pr(>|z|)
(Intercept)     3.43579    0.05641   60.91   <2e-16 ***
time2           0.01560    0.07900    0.20    0.843
sitetypeyellow -3.03815    0.26127  -11.63   <2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
            (Intr) time2
time2       -0.706
sitetypyllw -0.108  0.000
################################################################

# Inferences:

                #I'm unsure how to assess the variance and std dev scores for site... some guidance here would be appreciated....i.e. how do I answer my original question: Is there is difference in abundance between sites?
                #There is no statistically significant difference between the two time periods (P=>0.05)
                #Using the above output, the model suggests that there is a statistically significant difference between site types (p<0.05)

# Further questions:

                #1 Are the above inferences correct?
                #2 I have read about overdispersion.... how would I test for this in this example?
                #3 How could I build an interaction term into the model and answer the following: "Is there a statistically significant site*time interaction?"
                #4 Finally, are there any obvious steps or things I should be doing in order to get a 'robust' or 'correct' answer from this problem? i.e. further tests... alternative models and comparisons...


Thanks again,

Rob
_______________________________________________
R-sig-mixed-models at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
* * * * * * * * * * * * * D I S C L A I M E R * * * * * * * * * * * * *
Dit bericht en eventuele bijlagen geven enkel de visie van de schrijver weer en binden het INBO onder geen enkel beding, zolang dit bericht niet bevestigd is door een geldig ondertekend document.
The views expressed in this message and any annex are purely those of the writer and may not be regarded as stating an official position of INBO, as long as the message is not confirmed by a duly signed document.


From Thierry.ONKELINX at inbo.be  Fri Dec  7 12:21:51 2012
From: Thierry.ONKELINX at inbo.be (ONKELINX, Thierry)
Date: Fri, 7 Dec 2012 11:21:51 +0000
Subject: [R-sig-ME] lme4 glmer general help wanted - code included
In-Reply-To: <DUB002-W6219DC6B0C44973F23EE90A8440@phx.gbl>
References: <DUB002-W101F4D9AE09D661E66C5239A8450@phx.gbl>,
	<AA818EAD2576BC488B4F623941DA742794779BC2@inbomail.inbo.be>
	<DUB002-W6219DC6B0C44973F23EE90A8440@phx.gbl>
Message-ID: <AA818EAD2576BC488B4F623941DA742794779D20@inbomail.inbo.be>

Have a look at http://glmm.wikidot.com/faq and look for (should I treat factor xxx as fixed or random).

Did you post your real data? Is so there is hardly any difference among the replicates. In that case I would aggregate the replicates prior to analysis.

ir. Thierry Onkelinx
Instituut voor natuur- en bosonderzoek / Research Institute for Nature and Forest
team Biometrie & Kwaliteitszorg / team Biometrics & Quality Assurance
Kliniekstraat 25
1070 Anderlecht
Belgium
+ 32 2 525 02 51
+ 32 54 43 61 85
Thierry.Onkelinx at inbo.be
www.inbo.be

To call in the statistician after the experiment is done may be no more than asking him to perform a post-mortem examination: he may be able to say what the experiment died of.
~ Sir Ronald Aylmer Fisher

The plural of anecdote is not data.
~ Roger Brinner

The combination of some data and an aching desire for an answer does not ensure that a reasonable answer can be extracted from a given body of data.
~ John Tukey


-----Oorspronkelijk bericht-----
Van: Rob Bodin [mailto:nebstah at hotmail.com]
Verzonden: vrijdag 7 december 2012 11:07
Aan: ONKELINX, Thierry; r-sig-mixed-models at r-project.org
Onderwerp: RE: [R-sig-ME] lme4 glmer general help wanted - code included

Thanks Thierry, that's very useful.

Just to clarify, I was under the impression that as my sites were sampled through time (and thus individual samples were not independent of each other), I would need to treat them as random factors - is this not the case?

Thanks again,

----------------------------------------
> From: Thierry.ONKELINX at inbo.be
> To: nebstah at hotmail.com; r-sig-mixed-models at r-project.org
> Subject: RE: [R-sig-ME] lme4 glmer general help wanted - code included
> Date: Fri, 7 Dec 2012 09:49:14 +0000
>
> Dear Ben,
>
> Your dataset is to small for a mixed model. Just use a plain glm and glht() to test your hypotheses.
>
> model <- glm(abundance ~ site + time, data = data, family =
> quasipoisson)
> summary(model)
>
> library(multcomp)
> K <- rbind(
> SiteType = c(0, 0.5, 0.5, 0),
> Site23 = c(0, 1, -1, 0)
> )
> summary(glht(model, K))
>
> Furthermore I would recommend that you do some reading (e.g. Mixed Effects Models and Extensions in Ecology with R by Zuur et al 2009) and get some local statistical advise.
>
> Best regards,
>
> ir. Thierry Onkelinx
> Instituut voor natuur- en bosonderzoek / Research Institute for Nature
> and Forest team Biometrie & Kwaliteitszorg / team Biometrics & Quality
> Assurance Kliniekstraat 25
> 1070 Anderlecht
> Belgium
> + 32 2 525 02 51
> + 32 54 43 61 85
> Thierry.Onkelinx at inbo.be
> www.inbo.be
>
> To call in the statistician after the experiment is done may be no more than asking him to perform a post-mortem examination: he may be able to say what the experiment died of.
> ~ Sir Ronald Aylmer Fisher
>
> The plural of anecdote is not data.
> ~ Roger Brinner
>
> The combination of some data and an aching desire for an answer does not ensure that a reasonable answer can be extracted from a given body of data.
> ~ John Tukey
>
> -----Oorspronkelijk bericht-----
> Van: r-sig-mixed-models-bounces at r-project.org
> [mailto:r-sig-mixed-models-bounces at r-project.org] Namens Ben Gillespie
> Verzonden: donderdag 6 december 2012 22:23
> Aan: r-sig-mixed-models at r-project.org
> Onderwerp: [R-sig-ME] lme4 glmer general help wanted - code included
>
> Hi guys,
>
> I'm very new to R and have been teaching myself over the past few months - it's a great tool and I'm hoping to use it to analyse my PhD data.
> As I'm a bit of a newb, I'd really appreciate any feedback and/or guidance with regards to the following questions that relate to generalized linear mixed modelling (or, at least, I think they do!)(if there is a 'better', more appropriate way that I could attempt to answer my questions, please let me know).
>
> I've spent a lot of time researching this approach on the internet, but can't seem to find any directly applicable examples.
>
> Thanks in advance, and, if you need any further information, please let me know.
>
> # My experiment:
> # I have 1 site on 3 different rivers (independent)(sites 1,2 and 3). # I visit each site 2 times (time 1 and 2). # On each visit, I take 5x replicate insect samples and calculate total abundance for each replicate.
> # Site 1 is in an area called "yellow" and sites 2 and 3 are in an area called "blue".
>
> # My data frame:
>
>
> data=data.frame(
> site=c(rep(1,10),rep(2,10),rep(3,10)),
> replicate=c(rep(1:5,6)),
> time=c(rep(1,5),rep(2,5),rep(1,5),rep(2,5),rep(1,5),rep(2,5)),
> abundance=c(1,2,1,2,1,2,1,2,1,2,30,32,30,32,30,32,30,32,30,32,30,31,33
> ,32,31,31,33,32,31,32),
> sitetype=c(rep("yellow",10),rep("blue",20))
> )
>
> data$site=factor(data$site)
> data$replicate=factor(data$replicate)
> data$time=factor(data$time)
>
> data
>
>
> # Initial remarks:
> # As each replicate (1-5) was taken from within each site (1-3) on both sampling times (1-2), # I figure that 'replicate' should be treated as nested within 'site' and that both should be treated as random factors?
>
> # First question: Is there is difference in abundance between sites?
> # Second question: Is there is difference in abundance between sitetypes (blue or yellow)?
>
> #If my 'initial remarks' statement is correct (please tell me if not), then I think a generalized linear mixed model is appropriate and would be something along these lines:
>
> # Fitting the model:
>
> require(lme4)
> glmm1=glmer(abundance~time+sitetype+(1|site/replicate),family="poisson",data=data) #I chose to use poisson as abundance is count data... is this recommended?
> summary(glmm1)
> #Output:
>
> ################################################################
> Generalized linear mixed model fit by the Laplace approximation
> Formula: abundance ~ time + sitetype + (1 | site/replicate)
> Data: data
> AIC BIC logLik deviance
> 12.31 19.31 -1.153 2.306
> Random effects:
> Groups Name Variance Std.Dev.
> replicate:site (Intercept) 0 0
> site (Intercept) 0 0 Number of obs: 30, groups: replicate:site, 15;
> site, 3
>
> Fixed effects:
> Estimate Std. Error z value Pr(>|z|)
> (Intercept) 3.43579 0.05641 60.91 <2e-16 ***
> time2 0.01560 0.07900 0.20 0.843
> sitetypeyellow -3.03815 0.26127 -11.63 <2e-16 ***
> ---
> Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
>
> Correlation of Fixed Effects:
> (Intr) time2
> time2 -0.706
> sitetypyllw -0.108 0.000
> ################################################################
>
> # Inferences:
>
> #I'm unsure how to assess the variance and std dev scores for site... some guidance here would be appreciated....i.e. how do I answer my original question: Is there is difference in abundance between sites?
> #There is no statistically significant difference between the two time
> periods (P=>0.05) #Using the above output, the model suggests that
> there is a statistically significant difference between site types
> (p<0.05)
>
> # Further questions:
>
> #1 Are the above inferences correct?
> #2 I have read about overdispersion.... how would I test for this in this example?
> #3 How could I build an interaction term into the model and answer the following: "Is there a statistically significant site*time interaction?"
> #4 Finally, are there any obvious steps or things I should be doing in order to get a 'robust' or 'correct' answer from this problem? i.e. further tests... alternative models and comparisons...
>
>
> Thanks again,
>
> Rob
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> * * * * * * * * * * * * * D I S C L A I M E R * * * * * * * * * * * *
> * Dit bericht en eventuele bijlagen geven enkel de visie van de schrijver weer en binden het INBO onder geen enkel beding, zolang dit bericht niet bevestigd is door een geldig ondertekend document.
> The views expressed in this message and any annex are purely those of the writer and may not be regarded as stating an official position of INBO, as long as the message is not confirmed by a duly signed document.
* * * * * * * * * * * * * D I S C L A I M E R * * * * * * * * * * * * *
Dit bericht en eventuele bijlagen geven enkel de visie van de schrijver weer en binden het INBO onder geen enkel beding, zolang dit bericht niet bevestigd is door een geldig ondertekend document.
The views expressed in this message and any annex are purely those of the writer and may not be regarded as stating an official position of INBO, as long as the message is not confirmed by a duly signed document.


From Thierry.ONKELINX at inbo.be  Fri Dec  7 14:37:13 2012
From: Thierry.ONKELINX at inbo.be (ONKELINX, Thierry)
Date: Fri, 7 Dec 2012 13:37:13 +0000
Subject: [R-sig-ME] lme4 glmer general help wanted - code included
In-Reply-To: <DUB002-W1014F7D54B5C2A7F3360145A8440@phx.gbl>
References: <DUB002-W101F4D9AE09D661E66C5239A8450@phx.gbl>,
	<AA818EAD2576BC488B4F623941DA742794779BC2@inbomail.inbo.be>,
	<DUB002-W6219DC6B0C44973F23EE90A8440@phx.gbl>,
	<AA818EAD2576BC488B4F623941DA742794779D20@inbomail.inbo.be>,
	<DUB002-W10E43AFFBF4DF22586EF84A8440@phx.gbl>
	<DUB002-W1014F7D54B5C2A7F3360145A8440@phx.gbl>
Message-ID: <AA818EAD2576BC488B4F623941DA742794779E84@inbomail.inbo.be>

That is described in the helpfile: ?multcomp::glht


ir. Thierry Onkelinx
Instituut voor natuur- en bosonderzoek / Research Institute for Nature and Forest
team Biometrie & Kwaliteitszorg / team Biometrics & Quality Assurance
Kliniekstraat 25
1070 Anderlecht
Belgium
+ 32 2 525 02 51
+ 32 54 43 61 85
Thierry.Onkelinx at inbo.be
www.inbo.be

To call in the statistician after the experiment is done may be no more than asking him to perform a post-mortem examination: he may be able to say what the experiment died of.
~ Sir Ronald Aylmer Fisher

The plural of anecdote is not data.
~ Roger Brinner

The combination of some data and an aching desire for an answer does not ensure that a reasonable answer can be extracted from a given body of data.
~ John Tukey


-----Oorspronkelijk bericht-----
Van: Rob Bodin [mailto:nebstah at hotmail.com]
Verzonden: vrijdag 7 december 2012 14:34
Aan: ONKELINX, Thierry; r-sig-mixed-models at r-project.org
Onderwerp: RE: [R-sig-ME] lme4 glmer general help wanted - code included

Hi Thierry,

One final question:

In my actual dataset, length(coef(model)) = 16 rather than 4 as in the example below.

When applying the glht argument, do you know how best to specify the linfct matrix argument if I just wanted to test my 'site' related hypothesis: is there a difference in abundance between sites?

Many thanks,

----------------------------------------
> From: nebstah at hotmail.com
> To: thierry.onkelinx at inbo.be; r-sig-mixed-models at r-project.org
> Subject: RE: [R-sig-ME] lme4 glmer general help wanted - code included
> Date: Fri, 7 Dec 2012 12:45:02 +0000
>
> Thanks again.
>
> No the data were not real; I simplified them for the list.
>
> Thanks for your assistance,
>
> ----------------------------------------
> > From: Thierry.ONKELINX at inbo.be
> > To: nebstah at hotmail.com; r-sig-mixed-models at r-project.org
> > Subject: RE: [R-sig-ME] lme4 glmer general help wanted - code
> > included
> > Date: Fri, 7 Dec 2012 11:21:51 +0000
> >
> > Have a look at http://glmm.wikidot.com/faq and look for (should I treat factor xxx as fixed or random).
> >
> > Did you post your real data? Is so there is hardly any difference among the replicates. In that case I would aggregate the replicates prior to analysis.
> >
> > ir. Thierry Onkelinx
> > Instituut voor natuur- en bosonderzoek / Research Institute for
> > Nature and Forest team Biometrie & Kwaliteitszorg / team Biometrics
> > & Quality Assurance Kliniekstraat 25
> > 1070 Anderlecht
> > Belgium
> > + 32 2 525 02 51
> > + 32 54 43 61 85
> > Thierry.Onkelinx at inbo.be
> > www.inbo.be
> >
> > To call in the statistician after the experiment is done may be no more than asking him to perform a post-mortem examination: he may be able to say what the experiment died of.
> > ~ Sir Ronald Aylmer Fisher
> >
> > The plural of anecdote is not data.
> > ~ Roger Brinner
> >
> > The combination of some data and an aching desire for an answer does not ensure that a reasonable answer can be extracted from a given body of data.
> > ~ John Tukey
> >
> >
> > -----Oorspronkelijk bericht-----
> > Van: Rob Bodin [mailto:nebstah at hotmail.com]
> > Verzonden: vrijdag 7 december 2012 11:07
> > Aan: ONKELINX, Thierry; r-sig-mixed-models at r-project.org
> > Onderwerp: RE: [R-sig-ME] lme4 glmer general help wanted - code
> > included
> >
> > Thanks Thierry, that's very useful.
> >
> > Just to clarify, I was under the impression that as my sites were sampled through time (and thus individual samples were not independent of each other), I would need to treat them as random factors - is this not the case?
> >
> > Thanks again,
> >
> > ----------------------------------------
> > > From: Thierry.ONKELINX at inbo.be
> > > To: nebstah at hotmail.com; r-sig-mixed-models at r-project.org
> > > Subject: RE: [R-sig-ME] lme4 glmer general help wanted - code
> > > included
> > > Date: Fri, 7 Dec 2012 09:49:14 +0000
> > >
> > > Dear Ben,
> > >
> > > Your dataset is to small for a mixed model. Just use a plain glm and glht() to test your hypotheses.
> > >
> > > model <- glm(abundance ~ site + time, data = data, family =
> > > quasipoisson)
> > > summary(model)
> > >
> > > library(multcomp)
> > > K <- rbind(
> > > SiteType = c(0, 0.5, 0.5, 0),
> > > Site23 = c(0, 1, -1, 0)
> > > )
> > > summary(glht(model, K))
> > >
> > > Furthermore I would recommend that you do some reading (e.g. Mixed Effects Models and Extensions in Ecology with R by Zuur et al 2009) and get some local statistical advise.
> > >
> > > Best regards,
> > >
> > > ir. Thierry Onkelinx
> > > Instituut voor natuur- en bosonderzoek / Research Institute for
> > > Nature and Forest team Biometrie & Kwaliteitszorg / team
> > > Biometrics & Quality Assurance Kliniekstraat 25
> > > 1070 Anderlecht
> > > Belgium
> > > + 32 2 525 02 51
> > > + 32 54 43 61 85
> > > Thierry.Onkelinx at inbo.be
> > > www.inbo.be
> > >
> > > To call in the statistician after the experiment is done may be no more than asking him to perform a post-mortem examination: he may be able to say what the experiment died of.
> > > ~ Sir Ronald Aylmer Fisher
> > >
> > > The plural of anecdote is not data.
> > > ~ Roger Brinner
> > >
> > > The combination of some data and an aching desire for an answer does not ensure that a reasonable answer can be extracted from a given body of data.
> > > ~ John Tukey
> > >
> > > -----Oorspronkelijk bericht-----
> > > Van: r-sig-mixed-models-bounces at r-project.org
> > > [mailto:r-sig-mixed-models-bounces at r-project.org] Namens Ben
> > > Gillespie
> > > Verzonden: donderdag 6 december 2012 22:23
> > > Aan: r-sig-mixed-models at r-project.org
> > > Onderwerp: [R-sig-ME] lme4 glmer general help wanted - code
> > > included
> > >
> > > Hi guys,
> > >
> > > I'm very new to R and have been teaching myself over the past few months - it's a great tool and I'm hoping to use it to analyse my PhD data.
> > > As I'm a bit of a newb, I'd really appreciate any feedback and/or guidance with regards to the following questions that relate to generalized linear mixed modelling (or, at least, I think they do!)(if there is a 'better', more appropriate way that I could attempt to answer my questions, please let me know).
> > >
> > > I've spent a lot of time researching this approach on the internet, but can't seem to find any directly applicable examples.
> > >
> > > Thanks in advance, and, if you need any further information, please let me know.
> > >
> > > # My experiment:
> > > # I have 1 site on 3 different rivers (independent)(sites 1,2 and 3). # I visit each site 2 times (time 1 and 2). # On each visit, I take 5x replicate insect samples and calculate total abundance for each replicate.
> > > # Site 1 is in an area called "yellow" and sites 2 and 3 are in an area called "blue".
> > >
> > > # My data frame:
> > >
> > >
> > > data=data.frame(
> > > site=c(rep(1,10),rep(2,10),rep(3,10)),
> > > replicate=c(rep(1:5,6)),
> > > time=c(rep(1,5),rep(2,5),rep(1,5),rep(2,5),rep(1,5),rep(2,5)),
> > > abundance=c(1,2,1,2,1,2,1,2,1,2,30,32,30,32,30,32,30,32,30,32,30,3
> > > 1,33
> > > ,32,31,31,33,32,31,32),
> > > sitetype=c(rep("yellow",10),rep("blue",20))
> > > )
> > >
> > > data$site=factor(data$site)
> > > data$replicate=factor(data$replicate)
> > > data$time=factor(data$time)
> > >
> > > data
> > >
> > >
> > > # Initial remarks:
> > > # As each replicate (1-5) was taken from within each site (1-3) on both sampling times (1-2), # I figure that 'replicate' should be treated as nested within 'site' and that both should be treated as random factors?
> > >
> > > # First question: Is there is difference in abundance between sites?
> > > # Second question: Is there is difference in abundance between sitetypes (blue or yellow)?
> > >
> > > #If my 'initial remarks' statement is correct (please tell me if not), then I think a generalized linear mixed model is appropriate and would be something along these lines:
> > >
> > > # Fitting the model:
> > >
> > > require(lme4)
> > > glmm1=glmer(abundance~time+sitetype+(1|site/replicate),family="poisson",data=data) #I chose to use poisson as abundance is count data... is this recommended?
> > > summary(glmm1)
> > > #Output:
> > >
> > > ################################################################
> > > Generalized linear mixed model fit by the Laplace approximation
> > > Formula: abundance ~ time + sitetype + (1 | site/replicate)
> > > Data: data
> > > AIC BIC logLik deviance
> > > 12.31 19.31 -1.153 2.306
> > > Random effects:
> > > Groups Name Variance Std.Dev.
> > > replicate:site (Intercept) 0 0
> > > site (Intercept) 0 0 Number of obs: 30, groups: replicate:site,
> > > 15; site, 3
> > >
> > > Fixed effects:
> > > Estimate Std. Error z value Pr(>|z|)
> > > (Intercept) 3.43579 0.05641 60.91 <2e-16 ***
> > > time2 0.01560 0.07900 0.20 0.843
> > > sitetypeyellow -3.03815 0.26127 -11.63 <2e-16 ***
> > > ---
> > > Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
> > >
> > > Correlation of Fixed Effects:
> > > (Intr) time2
> > > time2 -0.706
> > > sitetypyllw -0.108 0.000
> > > ################################################################
> > >
> > > # Inferences:
> > >
> > > #I'm unsure how to assess the variance and std dev scores for site... some guidance here would be appreciated....i.e. how do I answer my original question: Is there is difference in abundance between sites?
> > > #There is no statistically significant difference between the two
> > > time periods (P=>0.05) #Using the above output, the model suggests
> > > that there is a statistically significant difference between site
> > > types
> > > (p<0.05)
> > >
> > > # Further questions:
> > >
> > > #1 Are the above inferences correct?
> > > #2 I have read about overdispersion.... how would I test for this in this example?
> > > #3 How could I build an interaction term into the model and answer the following: "Is there a statistically significant site*time interaction?"
> > > #4 Finally, are there any obvious steps or things I should be doing in order to get a 'robust' or 'correct' answer from this problem? i.e. further tests... alternative models and comparisons...
> > >
> > >
> > > Thanks again,
> > >
> > > Rob
> > > _______________________________________________
> > > R-sig-mixed-models at r-project.org mailing list
> > > https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> > > * * * * * * * * * * * * * D I S C L A I M E R * * * * * * * * * *
> > > * *
> > > * Dit bericht en eventuele bijlagen geven enkel de visie van de schrijver weer en binden het INBO onder geen enkel beding, zolang dit bericht niet bevestigd is door een geldig ondertekend document.
> > > The views expressed in this message and any annex are purely those of the writer and may not be regarded as stating an official position of INBO, as long as the message is not confirmed by a duly signed document.
> > * * * * * * * * * * * * * D I S C L A I M E R * * * * * * * * * * *
> > * * Dit bericht en eventuele bijlagen geven enkel de visie van de schrijver weer en binden het INBO onder geen enkel beding, zolang dit bericht niet bevestigd is door een geldig ondertekend document.
> > The views expressed in this message and any annex are purely those of the writer and may not be regarded as stating an official position of INBO, as long as the message is not confirmed by a duly signed document.
* * * * * * * * * * * * * D I S C L A I M E R * * * * * * * * * * * * *
Dit bericht en eventuele bijlagen geven enkel de visie van de schrijver weer en binden het INBO onder geen enkel beding, zolang dit bericht niet bevestigd is door een geldig ondertekend document.
The views expressed in this message and any annex are purely those of the writer and may not be regarded as stating an official position of INBO, as long as the message is not confirmed by a duly signed document.


From ethomas at stanford.edu  Fri Dec  7 15:47:36 2012
From: ethomas at stanford.edu (Ewart Thomas)
Date: Fri, 7 Dec 2012 06:47:36 -0800
Subject: [R-sig-ME] Excluding random intercepts?
In-Reply-To: <9F743AD1C32A4A2D8E90EB1401821A24@Wipflilatitude>
References: <9F743AD1C32A4A2D8E90EB1401821A24@Wipflilatitude>
Message-ID: <EDAF2461-C8EF-4F46-9E0E-D9FA65CE584E@stanford.edu>

kirsty, in addition to tom's comments, with which i agree, i wanted to ask if, in "covariance parameter estimate for the intercept term in the random slope model", you meant "variance of intercept".  it seems that this is what you meant, but the correlation between intercept and slope might also be interesting if it is moderate (e.g., -.3 to -.6), depending on how you code 'time' (as tom has already said).
ewart

On Dec 6, 2012, at 1:43 PM, Kirsty E. B. Gurney wrote:

> Good afternoon;
> 
> I have recently come across a *general question* about linear mixed models that I can't seem to find an answer for on my own.  I am hoping that one of the braintrust on this list might be willing / able to help.
> 
> Specifically, I am analyzing a dataset that describes pond temperatures for a series (n = 25 ponds, 436 measurements).  Ponds were assigned to 1 of 4 treatments, and I want to find find out if temperature was affected by treatment.  
> 
> Pond-level inference, in general, is not of interest, so it seemed clear that POND should be included as a random effect.  However, I have good reason to believe that the change in temperature across the study was also variable by POND, and a model that includes a random slope term has good support, as determined by AIC.
> 
> However, as it turns out, the covariance parameter estimate for the intercept term in the random slope model is pretty small (i.e., I think most ponds start out at a pretty similar temperature).
> 
> I am just wondering if it makes good statistical sense to run a random slope model without the random intercept term?  
> 
> If so, does anyone know how one would one specify this in the model structure?
> 
> Many thanks in advance,
> kbg
> 
> -~-~-~-
> Kirsty E. B. Gurney, Ph.D.
> Alaska Cooperative Fish and Wildlife Research Unit
> Institute of Arctic Biology
> 209 Irving 1 Building
> University of Alaska Fairbanks
> Fairbanks, AK 99775
> T: (907) 474 - 7738
> -~-~-~-
> 
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models


From nebstah at hotmail.com  Fri Dec  7 11:06:30 2012
From: nebstah at hotmail.com (Rob Bodin)
Date: Fri, 7 Dec 2012 10:06:30 +0000
Subject: [R-sig-ME] lme4 glmer general help wanted - code included
In-Reply-To: <AA818EAD2576BC488B4F623941DA742794779BC2@inbomail.inbo.be>
References: <DUB002-W101F4D9AE09D661E66C5239A8450@phx.gbl>,
	<AA818EAD2576BC488B4F623941DA742794779BC2@inbomail.inbo.be>
Message-ID: <DUB002-W6219DC6B0C44973F23EE90A8440@phx.gbl>

Thanks Thierry, that's very useful.

Just to clarify, I was under the impression that as my sites were sampled through time (and thus individual samples were not independent of each other), I would need to treat them as random factors - is this not the case?

Thanks again,

----------------------------------------
> From: Thierry.ONKELINX at inbo.be
> To: nebstah at hotmail.com; r-sig-mixed-models at r-project.org
> Subject: RE: [R-sig-ME] lme4 glmer general help wanted - code included
> Date: Fri, 7 Dec 2012 09:49:14 +0000
>
> Dear Ben,
>
> Your dataset is to small for a mixed model. Just use a plain glm and glht() to test your hypotheses.
>
> model <- glm(abundance ~ site + time, data = data, family = quasipoisson)
> summary(model)
>
> library(multcomp)
> K <- rbind(
> SiteType = c(0, 0.5, 0.5, 0),
> Site23 = c(0, 1, -1, 0)
> )
> summary(glht(model, K))
>
> Furthermore I would recommend that you do some reading (e.g. Mixed Effects Models and Extensions in Ecology with R by Zuur et al 2009) and get some local statistical advise.
>
> Best regards,
>
> ir. Thierry Onkelinx
> Instituut voor natuur- en bosonderzoek / Research Institute for Nature and Forest
> team Biometrie & Kwaliteitszorg / team Biometrics & Quality Assurance
> Kliniekstraat 25
> 1070 Anderlecht
> Belgium
> + 32 2 525 02 51
> + 32 54 43 61 85
> Thierry.Onkelinx at inbo.be
> www.inbo.be
>
> To call in the statistician after the experiment is done may be no more than asking him to perform a post-mortem examination: he may be able to say what the experiment died of.
> ~ Sir Ronald Aylmer Fisher
>
> The plural of anecdote is not data.
> ~ Roger Brinner
>
> The combination of some data and an aching desire for an answer does not ensure that a reasonable answer can be extracted from a given body of data.
> ~ John Tukey
>
> -----Oorspronkelijk bericht-----
> Van: r-sig-mixed-models-bounces at r-project.org [mailto:r-sig-mixed-models-bounces at r-project.org] Namens Ben Gillespie
> Verzonden: donderdag 6 december 2012 22:23
> Aan: r-sig-mixed-models at r-project.org
> Onderwerp: [R-sig-ME] lme4 glmer general help wanted - code included
>
> Hi guys,
>
> I'm very new to R and have been teaching myself over the past few months - it's a great tool and I'm hoping to use it to analyse my PhD data.
> As I'm a bit of a newb, I'd really appreciate any feedback and/or guidance with regards to the following questions that relate to generalized linear mixed modelling (or, at least, I think they do!)(if there is a 'better', more appropriate way that I could attempt to answer my questions, please let me know).
>
> I've spent a lot of time researching this approach on the internet, but can't seem to find any directly applicable examples.
>
> Thanks in advance, and, if you need any further information, please let me know.
>
> # My experiment:
> # I have 1 site on 3 different rivers (independent)(sites 1,2 and 3). # I visit each site 2 times (time 1 and 2). # On each visit, I take 5x replicate insect samples and calculate total abundance for each replicate.
> # Site 1 is in an area called "yellow" and sites 2 and 3 are in an area called "blue".
>
> # My data frame:
>
>
> data=data.frame(
> site=c(rep(1,10),rep(2,10),rep(3,10)),
> replicate=c(rep(1:5,6)),
> time=c(rep(1,5),rep(2,5),rep(1,5),rep(2,5),rep(1,5),rep(2,5)),
> abundance=c(1,2,1,2,1,2,1,2,1,2,30,32,30,32,30,32,30,32,30,32,30,31,33,32,31,31,33,32,31,32),
> sitetype=c(rep("yellow",10),rep("blue",20))
> )
>
> data$site=factor(data$site)
> data$replicate=factor(data$replicate)
> data$time=factor(data$time)
>
> data
>
>
> # Initial remarks:
> # As each replicate (1-5) was taken from within each site (1-3) on both sampling times (1-2), # I figure that 'replicate' should be treated as nested within 'site' and that both should be treated as random factors?
>
> # First question: Is there is difference in abundance between sites?
> # Second question: Is there is difference in abundance between sitetypes (blue or yellow)?
>
> #If my 'initial remarks' statement is correct (please tell me if not), then I think a generalized linear mixed model is appropriate and would be something along these lines:
>
> # Fitting the model:
>
> require(lme4)
> glmm1=glmer(abundance~time+sitetype+(1|site/replicate),family="poisson",data=data) #I chose to use poisson as abundance is count data... is this recommended?
> summary(glmm1)
> #Output:
>
> ################################################################
> Generalized linear mixed model fit by the Laplace approximation
> Formula: abundance ~ time + sitetype + (1 | site/replicate)
> Data: data
> AIC BIC logLik deviance
> 12.31 19.31 -1.153 2.306
> Random effects:
> Groups Name Variance Std.Dev.
> replicate:site (Intercept) 0 0
> site (Intercept) 0 0 Number of obs: 30, groups: replicate:site, 15; site, 3
>
> Fixed effects:
> Estimate Std. Error z value Pr(>|z|)
> (Intercept) 3.43579 0.05641 60.91 <2e-16 ***
> time2 0.01560 0.07900 0.20 0.843
> sitetypeyellow -3.03815 0.26127 -11.63 <2e-16 ***
> ---
> Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
>
> Correlation of Fixed Effects:
> (Intr) time2
> time2 -0.706
> sitetypyllw -0.108 0.000
> ################################################################
>
> # Inferences:
>
> #I'm unsure how to assess the variance and std dev scores for site... some guidance here would be appreciated....i.e. how do I answer my original question: Is there is difference in abundance between sites?
> #There is no statistically significant difference between the two time periods (P=>0.05)
> #Using the above output, the model suggests that there is a statistically significant difference between site types (p<0.05)
>
> # Further questions:
>
> #1 Are the above inferences correct?
> #2 I have read about overdispersion.... how would I test for this in this example?
> #3 How could I build an interaction term into the model and answer the following: "Is there a statistically significant site*time interaction?"
> #4 Finally, are there any obvious steps or things I should be doing in order to get a 'robust' or 'correct' answer from this problem? i.e. further tests... alternative models and comparisons...
>
>
> Thanks again,
>
> Rob
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> * * * * * * * * * * * * * D I S C L A I M E R * * * * * * * * * * * * *
> Dit bericht en eventuele bijlagen geven enkel de visie van de schrijver weer en binden het INBO onder geen enkel beding, zolang dit bericht niet bevestigd is door een geldig ondertekend document.
> The views expressed in this message and any annex are purely those of the writer and may not be regarded as stating an official position of INBO, as long as the message is not confirmed by a duly signed document. 		 	   		  

From nebstah at hotmail.com  Fri Dec  7 13:45:02 2012
From: nebstah at hotmail.com (Rob Bodin)
Date: Fri, 7 Dec 2012 12:45:02 +0000
Subject: [R-sig-ME] lme4 glmer general help wanted - code included
In-Reply-To: <AA818EAD2576BC488B4F623941DA742794779D20@inbomail.inbo.be>
References: <DUB002-W101F4D9AE09D661E66C5239A8450@phx.gbl>,
	<AA818EAD2576BC488B4F623941DA742794779BC2@inbomail.inbo.be>,
	<DUB002-W6219DC6B0C44973F23EE90A8440@phx.gbl>,
	<AA818EAD2576BC488B4F623941DA742794779D20@inbomail.inbo.be>
Message-ID: <DUB002-W10E43AFFBF4DF22586EF84A8440@phx.gbl>

Thanks again.

No the data were not real; I simplified them for the list.

Thanks for your assistance,

----------------------------------------
> From: Thierry.ONKELINX at inbo.be
> To: nebstah at hotmail.com; r-sig-mixed-models at r-project.org
> Subject: RE: [R-sig-ME] lme4 glmer general help wanted - code included
> Date: Fri, 7 Dec 2012 11:21:51 +0000
>
> Have a look at http://glmm.wikidot.com/faq and look for (should I treat factor xxx as fixed or random).
>
> Did you post your real data? Is so there is hardly any difference among the replicates. In that case I would aggregate the replicates prior to analysis.
>
> ir. Thierry Onkelinx
> Instituut voor natuur- en bosonderzoek / Research Institute for Nature and Forest
> team Biometrie & Kwaliteitszorg / team Biometrics & Quality Assurance
> Kliniekstraat 25
> 1070 Anderlecht
> Belgium
> + 32 2 525 02 51
> + 32 54 43 61 85
> Thierry.Onkelinx at inbo.be
> www.inbo.be
>
> To call in the statistician after the experiment is done may be no more than asking him to perform a post-mortem examination: he may be able to say what the experiment died of.
> ~ Sir Ronald Aylmer Fisher
>
> The plural of anecdote is not data.
> ~ Roger Brinner
>
> The combination of some data and an aching desire for an answer does not ensure that a reasonable answer can be extracted from a given body of data.
> ~ John Tukey
>
>
> -----Oorspronkelijk bericht-----
> Van: Rob Bodin [mailto:nebstah at hotmail.com]
> Verzonden: vrijdag 7 december 2012 11:07
> Aan: ONKELINX, Thierry; r-sig-mixed-models at r-project.org
> Onderwerp: RE: [R-sig-ME] lme4 glmer general help wanted - code included
>
> Thanks Thierry, that's very useful.
>
> Just to clarify, I was under the impression that as my sites were sampled through time (and thus individual samples were not independent of each other), I would need to treat them as random factors - is this not the case?
>
> Thanks again,
>
> ----------------------------------------
> > From: Thierry.ONKELINX at inbo.be
> > To: nebstah at hotmail.com; r-sig-mixed-models at r-project.org
> > Subject: RE: [R-sig-ME] lme4 glmer general help wanted - code included
> > Date: Fri, 7 Dec 2012 09:49:14 +0000
> >
> > Dear Ben,
> >
> > Your dataset is to small for a mixed model. Just use a plain glm and glht() to test your hypotheses.
> >
> > model <- glm(abundance ~ site + time, data = data, family =
> > quasipoisson)
> > summary(model)
> >
> > library(multcomp)
> > K <- rbind(
> > SiteType = c(0, 0.5, 0.5, 0),
> > Site23 = c(0, 1, -1, 0)
> > )
> > summary(glht(model, K))
> >
> > Furthermore I would recommend that you do some reading (e.g. Mixed Effects Models and Extensions in Ecology with R by Zuur et al 2009) and get some local statistical advise.
> >
> > Best regards,
> >
> > ir. Thierry Onkelinx
> > Instituut voor natuur- en bosonderzoek / Research Institute for Nature
> > and Forest team Biometrie & Kwaliteitszorg / team Biometrics & Quality
> > Assurance Kliniekstraat 25
> > 1070 Anderlecht
> > Belgium
> > + 32 2 525 02 51
> > + 32 54 43 61 85
> > Thierry.Onkelinx at inbo.be
> > www.inbo.be
> >
> > To call in the statistician after the experiment is done may be no more than asking him to perform a post-mortem examination: he may be able to say what the experiment died of.
> > ~ Sir Ronald Aylmer Fisher
> >
> > The plural of anecdote is not data.
> > ~ Roger Brinner
> >
> > The combination of some data and an aching desire for an answer does not ensure that a reasonable answer can be extracted from a given body of data.
> > ~ John Tukey
> >
> > -----Oorspronkelijk bericht-----
> > Van: r-sig-mixed-models-bounces at r-project.org
> > [mailto:r-sig-mixed-models-bounces at r-project.org] Namens Ben Gillespie
> > Verzonden: donderdag 6 december 2012 22:23
> > Aan: r-sig-mixed-models at r-project.org
> > Onderwerp: [R-sig-ME] lme4 glmer general help wanted - code included
> >
> > Hi guys,
> >
> > I'm very new to R and have been teaching myself over the past few months - it's a great tool and I'm hoping to use it to analyse my PhD data.
> > As I'm a bit of a newb, I'd really appreciate any feedback and/or guidance with regards to the following questions that relate to generalized linear mixed modelling (or, at least, I think they do!)(if there is a 'better', more appropriate way that I could attempt to answer my questions, please let me know).
> >
> > I've spent a lot of time researching this approach on the internet, but can't seem to find any directly applicable examples.
> >
> > Thanks in advance, and, if you need any further information, please let me know.
> >
> > # My experiment:
> > # I have 1 site on 3 different rivers (independent)(sites 1,2 and 3). # I visit each site 2 times (time 1 and 2). # On each visit, I take 5x replicate insect samples and calculate total abundance for each replicate.
> > # Site 1 is in an area called "yellow" and sites 2 and 3 are in an area called "blue".
> >
> > # My data frame:
> >
> >
> > data=data.frame(
> > site=c(rep(1,10),rep(2,10),rep(3,10)),
> > replicate=c(rep(1:5,6)),
> > time=c(rep(1,5),rep(2,5),rep(1,5),rep(2,5),rep(1,5),rep(2,5)),
> > abundance=c(1,2,1,2,1,2,1,2,1,2,30,32,30,32,30,32,30,32,30,32,30,31,33
> > ,32,31,31,33,32,31,32),
> > sitetype=c(rep("yellow",10),rep("blue",20))
> > )
> >
> > data$site=factor(data$site)
> > data$replicate=factor(data$replicate)
> > data$time=factor(data$time)
> >
> > data
> >
> >
> > # Initial remarks:
> > # As each replicate (1-5) was taken from within each site (1-3) on both sampling times (1-2), # I figure that 'replicate' should be treated as nested within 'site' and that both should be treated as random factors?
> >
> > # First question: Is there is difference in abundance between sites?
> > # Second question: Is there is difference in abundance between sitetypes (blue or yellow)?
> >
> > #If my 'initial remarks' statement is correct (please tell me if not), then I think a generalized linear mixed model is appropriate and would be something along these lines:
> >
> > # Fitting the model:
> >
> > require(lme4)
> > glmm1=glmer(abundance~time+sitetype+(1|site/replicate),family="poisson",data=data) #I chose to use poisson as abundance is count data... is this recommended?
> > summary(glmm1)
> > #Output:
> >
> > ################################################################
> > Generalized linear mixed model fit by the Laplace approximation
> > Formula: abundance ~ time + sitetype + (1 | site/replicate)
> > Data: data
> > AIC BIC logLik deviance
> > 12.31 19.31 -1.153 2.306
> > Random effects:
> > Groups Name Variance Std.Dev.
> > replicate:site (Intercept) 0 0
> > site (Intercept) 0 0 Number of obs: 30, groups: replicate:site, 15;
> > site, 3
> >
> > Fixed effects:
> > Estimate Std. Error z value Pr(>|z|)
> > (Intercept) 3.43579 0.05641 60.91 <2e-16 ***
> > time2 0.01560 0.07900 0.20 0.843
> > sitetypeyellow -3.03815 0.26127 -11.63 <2e-16 ***
> > ---
> > Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
> >
> > Correlation of Fixed Effects:
> > (Intr) time2
> > time2 -0.706
> > sitetypyllw -0.108 0.000
> > ################################################################
> >
> > # Inferences:
> >
> > #I'm unsure how to assess the variance and std dev scores for site... some guidance here would be appreciated....i.e. how do I answer my original question: Is there is difference in abundance between sites?
> > #There is no statistically significant difference between the two time
> > periods (P=>0.05) #Using the above output, the model suggests that
> > there is a statistically significant difference between site types
> > (p<0.05)
> >
> > # Further questions:
> >
> > #1 Are the above inferences correct?
> > #2 I have read about overdispersion.... how would I test for this in this example?
> > #3 How could I build an interaction term into the model and answer the following: "Is there a statistically significant site*time interaction?"
> > #4 Finally, are there any obvious steps or things I should be doing in order to get a 'robust' or 'correct' answer from this problem? i.e. further tests... alternative models and comparisons...
> >
> >
> > Thanks again,
> >
> > Rob
> > _______________________________________________
> > R-sig-mixed-models at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> > * * * * * * * * * * * * * D I S C L A I M E R * * * * * * * * * * * *
> > * Dit bericht en eventuele bijlagen geven enkel de visie van de schrijver weer en binden het INBO onder geen enkel beding, zolang dit bericht niet bevestigd is door een geldig ondertekend document.
> > The views expressed in this message and any annex are purely those of the writer and may not be regarded as stating an official position of INBO, as long as the message is not confirmed by a duly signed document.
> * * * * * * * * * * * * * D I S C L A I M E R * * * * * * * * * * * * *
> Dit bericht en eventuele bijlagen geven enkel de visie van de schrijver weer en binden het INBO onder geen enkel beding, zolang dit bericht niet bevestigd is door een geldig ondertekend document.
> The views expressed in this message and any annex are purely those of the writer and may not be regarded as stating an official position of INBO, as long as the message is not confirmed by a duly signed document. 		 	   		  

From nebstah at hotmail.com  Fri Dec  7 14:34:17 2012
From: nebstah at hotmail.com (Rob Bodin)
Date: Fri, 7 Dec 2012 13:34:17 +0000
Subject: [R-sig-ME] lme4 glmer general help wanted - code included
In-Reply-To: <DUB002-W10E43AFFBF4DF22586EF84A8440@phx.gbl>
References: <DUB002-W101F4D9AE09D661E66C5239A8450@phx.gbl>,
	<AA818EAD2576BC488B4F623941DA742794779BC2@inbomail.inbo.be>,
	<DUB002-W6219DC6B0C44973F23EE90A8440@phx.gbl>,
	<AA818EAD2576BC488B4F623941DA742794779D20@inbomail.inbo.be>,
	<DUB002-W10E43AFFBF4DF22586EF84A8440@phx.gbl>
Message-ID: <DUB002-W1014F7D54B5C2A7F3360145A8440@phx.gbl>

Hi Thierry,

One final question:

In my actual dataset,?length(coef(model)) = 16 rather than 4 as in the example below.

When applying the glht argument, do you know how best to specify the?linfct matrix argument if I just wanted to test my 'site' related hypothesis: is there a difference in abundance between sites?

Many thanks,

----------------------------------------
> From: nebstah at hotmail.com
> To: thierry.onkelinx at inbo.be; r-sig-mixed-models at r-project.org
> Subject: RE: [R-sig-ME] lme4 glmer general help wanted - code included
> Date: Fri, 7 Dec 2012 12:45:02 +0000
>
> Thanks again.
>
> No the data were not real; I simplified them for the list.
>
> Thanks for your assistance,
>
> ----------------------------------------
> > From: Thierry.ONKELINX at inbo.be
> > To: nebstah at hotmail.com; r-sig-mixed-models at r-project.org
> > Subject: RE: [R-sig-ME] lme4 glmer general help wanted - code included
> > Date: Fri, 7 Dec 2012 11:21:51 +0000
> >
> > Have a look at http://glmm.wikidot.com/faq and look for (should I treat factor xxx as fixed or random).
> >
> > Did you post your real data? Is so there is hardly any difference among the replicates. In that case I would aggregate the replicates prior to analysis.
> >
> > ir. Thierry Onkelinx
> > Instituut voor natuur- en bosonderzoek / Research Institute for Nature and Forest
> > team Biometrie & Kwaliteitszorg / team Biometrics & Quality Assurance
> > Kliniekstraat 25
> > 1070 Anderlecht
> > Belgium
> > + 32 2 525 02 51
> > + 32 54 43 61 85
> > Thierry.Onkelinx at inbo.be
> > www.inbo.be
> >
> > To call in the statistician after the experiment is done may be no more than asking him to perform a post-mortem examination: he may be able to say what the experiment died of.
> > ~ Sir Ronald Aylmer Fisher
> >
> > The plural of anecdote is not data.
> > ~ Roger Brinner
> >
> > The combination of some data and an aching desire for an answer does not ensure that a reasonable answer can be extracted from a given body of data.
> > ~ John Tukey
> >
> >
> > -----Oorspronkelijk bericht-----
> > Van: Rob Bodin [mailto:nebstah at hotmail.com]
> > Verzonden: vrijdag 7 december 2012 11:07
> > Aan: ONKELINX, Thierry; r-sig-mixed-models at r-project.org
> > Onderwerp: RE: [R-sig-ME] lme4 glmer general help wanted - code included
> >
> > Thanks Thierry, that's very useful.
> >
> > Just to clarify, I was under the impression that as my sites were sampled through time (and thus individual samples were not independent of each other), I would need to treat them as random factors - is this not the case?
> >
> > Thanks again,
> >
> > ----------------------------------------
> > > From: Thierry.ONKELINX at inbo.be
> > > To: nebstah at hotmail.com; r-sig-mixed-models at r-project.org
> > > Subject: RE: [R-sig-ME] lme4 glmer general help wanted - code included
> > > Date: Fri, 7 Dec 2012 09:49:14 +0000
> > >
> > > Dear Ben,
> > >
> > > Your dataset is to small for a mixed model. Just use a plain glm and glht() to test your hypotheses.
> > >
> > > model <- glm(abundance ~ site + time, data = data, family =
> > > quasipoisson)
> > > summary(model)
> > >
> > > library(multcomp)
> > > K <- rbind(
> > > SiteType = c(0, 0.5, 0.5, 0),
> > > Site23 = c(0, 1, -1, 0)
> > > )
> > > summary(glht(model, K))
> > >
> > > Furthermore I would recommend that you do some reading (e.g. Mixed Effects Models and Extensions in Ecology with R by Zuur et al 2009) and get some local statistical advise.
> > >
> > > Best regards,
> > >
> > > ir. Thierry Onkelinx
> > > Instituut voor natuur- en bosonderzoek / Research Institute for Nature
> > > and Forest team Biometrie & Kwaliteitszorg / team Biometrics & Quality
> > > Assurance Kliniekstraat 25
> > > 1070 Anderlecht
> > > Belgium
> > > + 32 2 525 02 51
> > > + 32 54 43 61 85
> > > Thierry.Onkelinx at inbo.be
> > > www.inbo.be
> > >
> > > To call in the statistician after the experiment is done may be no more than asking him to perform a post-mortem examination: he may be able to say what the experiment died of.
> > > ~ Sir Ronald Aylmer Fisher
> > >
> > > The plural of anecdote is not data.
> > > ~ Roger Brinner
> > >
> > > The combination of some data and an aching desire for an answer does not ensure that a reasonable answer can be extracted from a given body of data.
> > > ~ John Tukey
> > >
> > > -----Oorspronkelijk bericht-----
> > > Van: r-sig-mixed-models-bounces at r-project.org
> > > [mailto:r-sig-mixed-models-bounces at r-project.org] Namens Ben Gillespie
> > > Verzonden: donderdag 6 december 2012 22:23
> > > Aan: r-sig-mixed-models at r-project.org
> > > Onderwerp: [R-sig-ME] lme4 glmer general help wanted - code included
> > >
> > > Hi guys,
> > >
> > > I'm very new to R and have been teaching myself over the past few months - it's a great tool and I'm hoping to use it to analyse my PhD data.
> > > As I'm a bit of a newb, I'd really appreciate any feedback and/or guidance with regards to the following questions that relate to generalized linear mixed modelling (or, at least, I think they do!)(if there is a 'better', more appropriate way that I could attempt to answer my questions, please let me know).
> > >
> > > I've spent a lot of time researching this approach on the internet, but can't seem to find any directly applicable examples.
> > >
> > > Thanks in advance, and, if you need any further information, please let me know.
> > >
> > > # My experiment:
> > > # I have 1 site on 3 different rivers (independent)(sites 1,2 and 3). # I visit each site 2 times (time 1 and 2). # On each visit, I take 5x replicate insect samples and calculate total abundance for each replicate.
> > > # Site 1 is in an area called "yellow" and sites 2 and 3 are in an area called "blue".
> > >
> > > # My data frame:
> > >
> > >
> > > data=data.frame(
> > > site=c(rep(1,10),rep(2,10),rep(3,10)),
> > > replicate=c(rep(1:5,6)),
> > > time=c(rep(1,5),rep(2,5),rep(1,5),rep(2,5),rep(1,5),rep(2,5)),
> > > abundance=c(1,2,1,2,1,2,1,2,1,2,30,32,30,32,30,32,30,32,30,32,30,31,33
> > > ,32,31,31,33,32,31,32),
> > > sitetype=c(rep("yellow",10),rep("blue",20))
> > > )
> > >
> > > data$site=factor(data$site)
> > > data$replicate=factor(data$replicate)
> > > data$time=factor(data$time)
> > >
> > > data
> > >
> > >
> > > # Initial remarks:
> > > # As each replicate (1-5) was taken from within each site (1-3) on both sampling times (1-2), # I figure that 'replicate' should be treated as nested within 'site' and that both should be treated as random factors?
> > >
> > > # First question: Is there is difference in abundance between sites?
> > > # Second question: Is there is difference in abundance between sitetypes (blue or yellow)?
> > >
> > > #If my 'initial remarks' statement is correct (please tell me if not), then I think a generalized linear mixed model is appropriate and would be something along these lines:
> > >
> > > # Fitting the model:
> > >
> > > require(lme4)
> > > glmm1=glmer(abundance~time+sitetype+(1|site/replicate),family="poisson",data=data) #I chose to use poisson as abundance is count data... is this recommended?
> > > summary(glmm1)
> > > #Output:
> > >
> > > ################################################################
> > > Generalized linear mixed model fit by the Laplace approximation
> > > Formula: abundance ~ time + sitetype + (1 | site/replicate)
> > > Data: data
> > > AIC BIC logLik deviance
> > > 12.31 19.31 -1.153 2.306
> > > Random effects:
> > > Groups Name Variance Std.Dev.
> > > replicate:site (Intercept) 0 0
> > > site (Intercept) 0 0 Number of obs: 30, groups: replicate:site, 15;
> > > site, 3
> > >
> > > Fixed effects:
> > > Estimate Std. Error z value Pr(>|z|)
> > > (Intercept) 3.43579 0.05641 60.91 <2e-16 ***
> > > time2 0.01560 0.07900 0.20 0.843
> > > sitetypeyellow -3.03815 0.26127 -11.63 <2e-16 ***
> > > ---
> > > Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
> > >
> > > Correlation of Fixed Effects:
> > > (Intr) time2
> > > time2 -0.706
> > > sitetypyllw -0.108 0.000
> > > ################################################################
> > >
> > > # Inferences:
> > >
> > > #I'm unsure how to assess the variance and std dev scores for site... some guidance here would be appreciated....i.e. how do I answer my original question: Is there is difference in abundance between sites?
> > > #There is no statistically significant difference between the two time
> > > periods (P=>0.05) #Using the above output, the model suggests that
> > > there is a statistically significant difference between site types
> > > (p<0.05)
> > >
> > > # Further questions:
> > >
> > > #1 Are the above inferences correct?
> > > #2 I have read about overdispersion.... how would I test for this in this example?
> > > #3 How could I build an interaction term into the model and answer the following: "Is there a statistically significant site*time interaction?"
> > > #4 Finally, are there any obvious steps or things I should be doing in order to get a 'robust' or 'correct' answer from this problem? i.e. further tests... alternative models and comparisons...
> > >
> > >
> > > Thanks again,
> > >
> > > Rob
> > > _______________________________________________
> > > R-sig-mixed-models at r-project.org mailing list
> > > https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> > > * * * * * * * * * * * * * D I S C L A I M E R * * * * * * * * * * * *
> > > * Dit bericht en eventuele bijlagen geven enkel de visie van de schrijver weer en binden het INBO onder geen enkel beding, zolang dit bericht niet bevestigd is door een geldig ondertekend document.
> > > The views expressed in this message and any annex are purely those of the writer and may not be regarded as stating an official position of INBO, as long as the message is not confirmed by a duly signed document.
> > * * * * * * * * * * * * * D I S C L A I M E R * * * * * * * * * * * * *
> > Dit bericht en eventuele bijlagen geven enkel de visie van de schrijver weer en binden het INBO onder geen enkel beding, zolang dit bericht niet bevestigd is door een geldig ondertekend document.
> > The views expressed in this message and any annex are purely those of the writer and may not be regarded as stating an official position of INBO, as long as the message is not confirmed by a duly signed document. 		 	   		  

From nebstah at hotmail.com  Fri Dec  7 15:43:25 2012
From: nebstah at hotmail.com (Rob Bodin)
Date: Fri, 7 Dec 2012 14:43:25 +0000
Subject: [R-sig-ME] lme4 glmer general help wanted - code included
In-Reply-To: <AA818EAD2576BC488B4F623941DA742794779E84@inbomail.inbo.be>
References: <DUB002-W101F4D9AE09D661E66C5239A8450@phx.gbl>,
	<AA818EAD2576BC488B4F623941DA742794779BC2@inbomail.inbo.be>,
	<DUB002-W6219DC6B0C44973F23EE90A8440@phx.gbl>,
	<AA818EAD2576BC488B4F623941DA742794779D20@inbomail.inbo.be>,
	<DUB002-W10E43AFFBF4DF22586EF84A8440@phx.gbl>,
	<DUB002-W1014F7D54B5C2A7F3360145A8440@phx.gbl>,
	<AA818EAD2576BC488B4F623941DA742794779E84@inbomail.inbo.be>
Message-ID: <DUB002-W122D5D2164A4814BCB31DB7A8440@phx.gbl>

Thanks,

I think I've got it:

> m.abund <- glm(abund ~ site + date, data = e, family = quasipoisson)

> coef(m.abund)
? ?(Intercept) ? ? ? ? ?site6 ? ? ? ? ?site9 date2012-02-01 date2012-03-01 date2012-04-01 date2012-04-04 date2012-05-01?
? ? 3.75325564 ? ?-0.19041316 ? ? 0.04171585 ? ?-0.01813735 ? ? 0.22965823 ? ? 0.92280541 ? ? 0.59628351 ? ?-0.01150382?
date2012-06-01 date2012-07-01 date2012-08-01 date2012-09-01 date2012-10-01 date2012-10-15 date2012-10-19 date2012-11-01?
? ? 0.67167650 ? ?-0.89127934 ? ? 0.18585561 ? ?-0.26826399 ? ?-0.71294981 ? ?-0.50476214 ? ?-0.47479735 ? ?-0.09956760?

> K = rbind(Site=c(0,1,-1,0,0, 0,0,0,0,0, 0,0,0,0,0,0))
> summary(glht(m.abund,K))

? ? ? ? ?Simultaneous Tests for General Linear Hypotheses

Fit: glm(formula = abund ~ site + date, family = quasipoisson, data = e)

Linear Hypotheses:
? ? ? ? ? Estimate Std. Error z value Pr(>|z|) ?
Site == 0 ?-0.2321 ? ? 0.1275 ?-1.821 ? 0.0686 .
---
Signif. codes: ?0 ?***? 0.001 ?**? 0.01 ?*? 0.05 ?.? 0.1 ? ? 1?
(Adjusted p values reported -- single-step method)

#I therefore conclude that there is no significant difference in abundance between sites.

Thanks again, you've been a great help,


----------------------------------------
> From: Thierry.ONKELINX at inbo.be
> To: nebstah at hotmail.com; r-sig-mixed-models at r-project.org
> Subject: RE: [R-sig-ME] lme4 glmer general help wanted - code included
> Date: Fri, 7 Dec 2012 13:37:13 +0000
>
> That is described in the helpfile: ?multcomp::glht
>
>
> ir. Thierry Onkelinx
> Instituut voor natuur- en bosonderzoek / Research Institute for Nature and Forest
> team Biometrie & Kwaliteitszorg / team Biometrics & Quality Assurance
> Kliniekstraat 25
> 1070 Anderlecht
> Belgium
> + 32 2 525 02 51
> + 32 54 43 61 85
> Thierry.Onkelinx at inbo.be
> www.inbo.be
>
> To call in the statistician after the experiment is done may be no more than asking him to perform a post-mortem examination: he may be able to say what the experiment died of.
> ~ Sir Ronald Aylmer Fisher
>
> The plural of anecdote is not data.
> ~ Roger Brinner
>
> The combination of some data and an aching desire for an answer does not ensure that a reasonable answer can be extracted from a given body of data.
> ~ John Tukey
>
>
> -----Oorspronkelijk bericht-----
> Van: Rob Bodin [mailto:nebstah at hotmail.com]
> Verzonden: vrijdag 7 december 2012 14:34
> Aan: ONKELINX, Thierry; r-sig-mixed-models at r-project.org
> Onderwerp: RE: [R-sig-ME] lme4 glmer general help wanted - code included
>
> Hi Thierry,
>
> One final question:
>
> In my actual dataset, length(coef(model)) = 16 rather than 4 as in the example below.
>
> When applying the glht argument, do you know how best to specify the linfct matrix argument if I just wanted to test my 'site' related hypothesis: is there a difference in abundance between sites?
>
> Many thanks,
>
> ----------------------------------------
> > From: nebstah at hotmail.com
> > To: thierry.onkelinx at inbo.be; r-sig-mixed-models at r-project.org
> > Subject: RE: [R-sig-ME] lme4 glmer general help wanted - code included
> > Date: Fri, 7 Dec 2012 12:45:02 +0000
> >
> > Thanks again.
> >
> > No the data were not real; I simplified them for the list.
> >
> > Thanks for your assistance,
> >
> > ----------------------------------------
> > > From: Thierry.ONKELINX at inbo.be
> > > To: nebstah at hotmail.com; r-sig-mixed-models at r-project.org
> > > Subject: RE: [R-sig-ME] lme4 glmer general help wanted - code
> > > included
> > > Date: Fri, 7 Dec 2012 11:21:51 +0000
> > >
> > > Have a look at http://glmm.wikidot.com/faq and look for (should I treat factor xxx as fixed or random).
> > >
> > > Did you post your real data? Is so there is hardly any difference among the replicates. In that case I would aggregate the replicates prior to analysis.
> > >
> > > ir. Thierry Onkelinx
> > > Instituut voor natuur- en bosonderzoek / Research Institute for
> > > Nature and Forest team Biometrie & Kwaliteitszorg / team Biometrics
> > > & Quality Assurance Kliniekstraat 25
> > > 1070 Anderlecht
> > > Belgium
> > > + 32 2 525 02 51
> > > + 32 54 43 61 85
> > > Thierry.Onkelinx at inbo.be
> > > www.inbo.be
> > >
> > > To call in the statistician after the experiment is done may be no more than asking him to perform a post-mortem examination: he may be able to say what the experiment died of.
> > > ~ Sir Ronald Aylmer Fisher
> > >
> > > The plural of anecdote is not data.
> > > ~ Roger Brinner
> > >
> > > The combination of some data and an aching desire for an answer does not ensure that a reasonable answer can be extracted from a given body of data.
> > > ~ John Tukey
> > >
> > >
> > > -----Oorspronkelijk bericht-----
> > > Van: Rob Bodin [mailto:nebstah at hotmail.com]
> > > Verzonden: vrijdag 7 december 2012 11:07
> > > Aan: ONKELINX, Thierry; r-sig-mixed-models at r-project.org
> > > Onderwerp: RE: [R-sig-ME] lme4 glmer general help wanted - code
> > > included
> > >
> > > Thanks Thierry, that's very useful.
> > >
> > > Just to clarify, I was under the impression that as my sites were sampled through time (and thus individual samples were not independent of each other), I would need to treat them as random factors - is this not the case?
> > >
> > > Thanks again,
> > >
> > > ----------------------------------------
> > > > From: Thierry.ONKELINX at inbo.be
> > > > To: nebstah at hotmail.com; r-sig-mixed-models at r-project.org
> > > > Subject: RE: [R-sig-ME] lme4 glmer general help wanted - code
> > > > included
> > > > Date: Fri, 7 Dec 2012 09:49:14 +0000
> > > >
> > > > Dear Ben,
> > > >
> > > > Your dataset is to small for a mixed model. Just use a plain glm and glht() to test your hypotheses.
> > > >
> > > > model <- glm(abundance ~ site + time, data = data, family =
> > > > quasipoisson)
> > > > summary(model)
> > > >
> > > > library(multcomp)
> > > > K <- rbind(
> > > > SiteType = c(0, 0.5, 0.5, 0),
> > > > Site23 = c(0, 1, -1, 0)
> > > > )
> > > > summary(glht(model, K))
> > > >
> > > > Furthermore I would recommend that you do some reading (e.g. Mixed Effects Models and Extensions in Ecology with R by Zuur et al 2009) and get some local statistical advise.
> > > >
> > > > Best regards,
> > > >
> > > > ir. Thierry Onkelinx
> > > > Instituut voor natuur- en bosonderzoek / Research Institute for
> > > > Nature and Forest team Biometrie & Kwaliteitszorg / team
> > > > Biometrics & Quality Assurance Kliniekstraat 25
> > > > 1070 Anderlecht
> > > > Belgium
> > > > + 32 2 525 02 51
> > > > + 32 54 43 61 85
> > > > Thierry.Onkelinx at inbo.be
> > > > www.inbo.be
> > > >
> > > > To call in the statistician after the experiment is done may be no more than asking him to perform a post-mortem examination: he may be able to say what the experiment died of.
> > > > ~ Sir Ronald Aylmer Fisher
> > > >
> > > > The plural of anecdote is not data.
> > > > ~ Roger Brinner
> > > >
> > > > The combination of some data and an aching desire for an answer does not ensure that a reasonable answer can be extracted from a given body of data.
> > > > ~ John Tukey
> > > >
> > > > -----Oorspronkelijk bericht-----
> > > > Van: r-sig-mixed-models-bounces at r-project.org
> > > > [mailto:r-sig-mixed-models-bounces at r-project.org] Namens Ben
> > > > Gillespie
> > > > Verzonden: donderdag 6 december 2012 22:23
> > > > Aan: r-sig-mixed-models at r-project.org
> > > > Onderwerp: [R-sig-ME] lme4 glmer general help wanted - code
> > > > included
> > > >
> > > > Hi guys,
> > > >
> > > > I'm very new to R and have been teaching myself over the past few months - it's a great tool and I'm hoping to use it to analyse my PhD data.
> > > > As I'm a bit of a newb, I'd really appreciate any feedback and/or guidance with regards to the following questions that relate to generalized linear mixed modelling (or, at least, I think they do!)(if there is a 'better', more appropriate way that I could attempt to answer my questions, please let me know).
> > > >
> > > > I've spent a lot of time researching this approach on the internet, but can't seem to find any directly applicable examples.
> > > >
> > > > Thanks in advance, and, if you need any further information, please let me know.
> > > >
> > > > # My experiment:
> > > > # I have 1 site on 3 different rivers (independent)(sites 1,2 and 3). # I visit each site 2 times (time 1 and 2). # On each visit, I take 5x replicate insect samples and calculate total abundance for each replicate.
> > > > # Site 1 is in an area called "yellow" and sites 2 and 3 are in an area called "blue".
> > > >
> > > > # My data frame:
> > > >
> > > >
> > > > data=data.frame(
> > > > site=c(rep(1,10),rep(2,10),rep(3,10)),
> > > > replicate=c(rep(1:5,6)),
> > > > time=c(rep(1,5),rep(2,5),rep(1,5),rep(2,5),rep(1,5),rep(2,5)),
> > > > abundance=c(1,2,1,2,1,2,1,2,1,2,30,32,30,32,30,32,30,32,30,32,30,3
> > > > 1,33
> > > > ,32,31,31,33,32,31,32),
> > > > sitetype=c(rep("yellow",10),rep("blue",20))
> > > > )
> > > >
> > > > data$site=factor(data$site)
> > > > data$replicate=factor(data$replicate)
> > > > data$time=factor(data$time)
> > > >
> > > > data
> > > >
> > > >
> > > > # Initial remarks:
> > > > # As each replicate (1-5) was taken from within each site (1-3) on both sampling times (1-2), # I figure that 'replicate' should be treated as nested within 'site' and that both should be treated as random factors?
> > > >
> > > > # First question: Is there is difference in abundance between sites?
> > > > # Second question: Is there is difference in abundance between sitetypes (blue or yellow)?
> > > >
> > > > #If my 'initial remarks' statement is correct (please tell me if not), then I think a generalized linear mixed model is appropriate and would be something along these lines:
> > > >
> > > > # Fitting the model:
> > > >
> > > > require(lme4)
> > > > glmm1=glmer(abundance~time+sitetype+(1|site/replicate),family="poisson",data=data) #I chose to use poisson as abundance is count data... is this recommended?
> > > > summary(glmm1)
> > > > #Output:
> > > >
> > > > ################################################################
> > > > Generalized linear mixed model fit by the Laplace approximation
> > > > Formula: abundance ~ time + sitetype + (1 | site/replicate)
> > > > Data: data
> > > > AIC BIC logLik deviance
> > > > 12.31 19.31 -1.153 2.306
> > > > Random effects:
> > > > Groups Name Variance Std.Dev.
> > > > replicate:site (Intercept) 0 0
> > > > site (Intercept) 0 0 Number of obs: 30, groups: replicate:site,
> > > > 15; site, 3
> > > >
> > > > Fixed effects:
> > > > Estimate Std. Error z value Pr(>|z|)
> > > > (Intercept) 3.43579 0.05641 60.91 <2e-16 ***
> > > > time2 0.01560 0.07900 0.20 0.843
> > > > sitetypeyellow -3.03815 0.26127 -11.63 <2e-16 ***
> > > > ---
> > > > Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
> > > >
> > > > Correlation of Fixed Effects:
> > > > (Intr) time2
> > > > time2 -0.706
> > > > sitetypyllw -0.108 0.000
> > > > ################################################################
> > > >
> > > > # Inferences:
> > > >
> > > > #I'm unsure how to assess the variance and std dev scores for site... some guidance here would be appreciated....i.e. how do I answer my original question: Is there is difference in abundance between sites?
> > > > #There is no statistically significant difference between the two
> > > > time periods (P=>0.05) #Using the above output, the model suggests
> > > > that there is a statistically significant difference between site
> > > > types
> > > > (p<0.05)
> > > >
> > > > # Further questions:
> > > >
> > > > #1 Are the above inferences correct?
> > > > #2 I have read about overdispersion.... how would I test for this in this example?
> > > > #3 How could I build an interaction term into the model and answer the following: "Is there a statistically significant site*time interaction?"
> > > > #4 Finally, are there any obvious steps or things I should be doing in order to get a 'robust' or 'correct' answer from this problem? i.e. further tests... alternative models and comparisons...
> > > >
> > > >
> > > > Thanks again,
> > > >
> > > > Rob
> > > > _______________________________________________
> > > > R-sig-mixed-models at r-project.org mailing list
> > > > https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> > > > * * * * * * * * * * * * * D I S C L A I M E R * * * * * * * * * *
> > > > * *
> > > > * Dit bericht en eventuele bijlagen geven enkel de visie van de schrijver weer en binden het INBO onder geen enkel beding, zolang dit bericht niet bevestigd is door een geldig ondertekend document.
> > > > The views expressed in this message and any annex are purely those of the writer and may not be regarded as stating an official position of INBO, as long as the message is not confirmed by a duly signed document.
> > > * * * * * * * * * * * * * D I S C L A I M E R * * * * * * * * * * *
> > > * * Dit bericht en eventuele bijlagen geven enkel de visie van de schrijver weer en binden het INBO onder geen enkel beding, zolang dit bericht niet bevestigd is door een geldig ondertekend document.
> > > The views expressed in this message and any annex are purely those of the writer and may not be regarded as stating an official position of INBO, as long as the message is not confirmed by a duly signed document.
> * * * * * * * * * * * * * D I S C L A I M E R * * * * * * * * * * * * *
> Dit bericht en eventuele bijlagen geven enkel de visie van de schrijver weer en binden het INBO onder geen enkel beding, zolang dit bericht niet bevestigd is door een geldig ondertekend document.
> The views expressed in this message and any annex are purely those of the writer and may not be regarded as stating an official position of INBO, as long as the message is not confirmed by a duly signed document. 		 	   		  

From rudy.garel at unil.ch  Fri Dec  7 12:40:01 2012
From: rudy.garel at unil.ch (Rudy Garel)
Date: Fri, 07 Dec 2012 12:40:01 +0100
Subject: [R-sig-ME] How to compute heritabilities on binomial response
	variables...
Message-ID: <50C1D591.3080803@unil.ch>

Hi everybody,

I am working on Atlantic salmon embryos and I wondered if anyone knows 
how to compute heritabilities on binomial response variables like survival?
Here is the model that I use to extract the variance components on a 
gaussian response variable (cf R book, p.640):

lmer(Bodylength~1+(1|Fem)+(1|factor(Mal))+(1|Fem:factor(Mal))+(1|factor(Inc)))

... where "Fem" is the female or mother effect, "Mal" the male or father 
effect and "Inc" the incubator effect.
And so I tried to extract the variance components on a binomial response 
variable drawing inspiration of this model as follows:

glmer(Survival~1+(1|Fem)+(1|factor(Mal))+(1|Fem:factor(Mal))+(1|factor(Inc)),family="binomial") 


The problem with this last model is that it does not give me the 
residual variance (which is normal with binomial data) and so I can not 
compute heritability.
Does anyone know an approach on R to compute heritabilities on binomial 
response variables?
Thanks in advance for paying attention to this mail.

Cheers,

-- 
Rudy Garel, PhD Student
Department of Ecology and Evolution, Biophore Building
University of Lausanne, CH-1015 Lausanne, Switzerland
Phone: +41 (0)21 692 41 76
http://www.unil.ch/dee/page90602.html

-------------- next part --------------
A non-text attachment was scrubbed...
Name: R book p640.pdf
Type: application/pdf
Size: 230985 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121207/46b20c31/attachment-0001.pdf>

From Lara.Reichmann at austin.utexas.edu  Fri Dec  7 18:53:12 2012
From: Lara.Reichmann at austin.utexas.edu (Lara Reichmann)
Date: Fri, 7 Dec 2012 17:53:12 +0000
Subject: [R-sig-ME] HELP on fixed effect model building with nlmer or nlme
Message-ID: <D9905D32A9F3464598EA5B14523DBCC604B3C88C@EXMBX03.austin.utexas.edu>

Dear R community,

I've been trying for a week to fit an non-linear mixed effect model where I want to estimate the fixed effect of two treatments on the parameters on the following equation Photo~(A*(1-exp(-C*PARi/A)))-B
I was able to fit a simple model without covariates following the nlme method described in "The R Book" by Crawley, p669

My data has the following structure "Subject" "Species" "Fert" "Photo" "PARi" , where several "Photo" measurements where taken on the same subject by changing "PARi", 4 Species levels and 2 Fert levels, there are 31 Subjects (one missing subject), and 323 observations

DATA extract

Subject	Species	Fert	Photo	PARi
1	bb	1	22.5389	1499.3307
1	bb	1	21.881	1248.913
1	bb	1	21.2862	999.3387
1	bb	1	20.5836	799.9308
1	bb	1	19.3758	601.1412
1	bb	1	15.5915	399.815
1	bb	1	8.7978	200.1087
1	bb	1	4.4347	99.686
1	bb	1	2.0387	49.7842
1	bb	1	-1.4854	0.0576
2	sw	0	6.782	1500.5337
2	sw	0	7.1432	1249.2749
2	sw	0	7.3319	1000.9891
2	sw	0	7.5848	799.1752
2	sw	0	7.1882	599.5544
2	sw	0	6.809	399.988
2	sw	0	5.3877	198.7574
2	sw	0	3.5104	100.7115
2	sw	0	0.8856	50.7015
2	sw	0	-1.121	0.0569
3	jg	1	16.0827	2000.4941
3	jg	1	16.0236	1501.1957
3	jg	1	16.3818	1248.9551
3	jg	1	16.7815	1499.6414
3	jg	1	17.175	2000.6851
3	jg	1	16.6529	1000.2707
3	jg	1	15.7987	799.676
3	jg	1	15.5437	598.9409
3	jg	1	11.7683	400.7715
3	jg	1	4.89	200.7468
3	jg	1	4.1294	100.9664
3	jg	1	1.6008	50.9254
3	jg	1	-0.89	0.5347
4	sw	1	25.2889	2000.1454
4	sw	1	24.7284	1499.6191
4	sw	1	24.3637	1249.7523
4	sw	1	23.3523	1000.0944
4	sw	1	21.6057	800.2209
4	sw	1	18.8926	599.7022
4	sw	1	14.6598	398.9366
4	sw	1	7.7182	201.5697
4	sw	1	3.4775	100.5139
4	sw	1	1.169	49.7045
4	sw	1	-1.3558	1.6914
5	jg	0	6.1626	2000.9351
5	jg	0	7.5573	1499.6581
5	jg	0	7.7129	1249.5073
5	jg	0	7.442	1000.7276
5	jg	0	7.5135	799.1286
5	jg	0	7.1559	599.5568
5	jg	0	6.8161	400.3576
5	jg	0	4.0097	199.7442
5	jg	0	2.7202	101.1253
5	jg	0	1.0746	51.1787
5	jg	0	-0.5913	0.975



This works so far:

lightresponse<-groupedData(Photo~PARi|Subject2,data=lightr,outer = ~ Species * Fert,labels = list(x = "PAR", y = "CO2 uptake rate"),units = list(x = "(photon s-1)", y = "(umol/m?2 s)"))  

model.ml1<-nlme(Photo~A*(1-exp(-C*PARi/A))-B,fixed=A+B+C~1,random=A+B+C~1|Subject2,data=lightresponse,start=c(A=24.89,B=1.78,C=0.02)) #from Crawley book, page 669
summary(model.ml1)
### model with no fixed effects

model.nlme<-nlme(Photo~A*(1-exp(-C*PARi/A))-B,fixed=A+B+C~Species,random=A+B+C~1|Subject2,data=lightresponse,start=c(24.89,0,0,0,1.78,0,0,0,0.06,0,0,0))
###model with Species as fixed effects, it works

                  Value Std.Error  DF   t-value p-value
A.(Intercept)  25.030590  1.857426 281 13.475959  0.0000
A.Species1     -0.898409  3.179607 281 -0.282554  0.7777
A.Species2     -5.131793  3.179135 281 -1.614211  0.1076
A.Species3      1.964169  3.179651 281  0.617731  0.5373
B.(Intercept)   1.788700  0.133278 281 13.420773  0.0000
B.Species1     -0.265424  0.228670 281 -1.160726  0.2467
B.Species2     -0.149737  0.229510 281 -0.652419  0.5147
B.Species3      0.204079  0.228995 281  0.891197  0.3736
C.(Intercept)  0.065034  0.002574 281 25.262323  0.0000
C.Species1     0.000662  0.004402 281  0.150301  0.8806
C.Species2    -0.008721  0.004413 281 -1.976211  0.0491
C.Species3     0.009666  0.004432 281  2.180979  0.0300

QUESTION 1: How do I know which species corresponds with the Intercept, Species1, 2, and 3? Values do not seem to match the means for "levels(Species)" [1] "bb" "jg" "lb" "sw"

##Now, I want to test the effect of Species* Fert, I don't fully understand how to modify the syntax and the start, as I tried several options and no one seems to be correct. Do the number of levels in each factor matter? In that case 4 Species and 2 Fert levels, I would need 6 initial parameters x 3? This didn't work either

Question 2: How do I compare the significance of parameter estimates between Species and Fertilizer Treatments? 

I hope someone out there has the answer!
Thanks!!!

In other desperate attempt to run non linear models, I followed the example from useR!2011, University of Warwick, and I cannot even get the example to run!
 Th.start <- c(lKe = -2.5, lKa = 0.5, lCl = -3)
> nm1 <- nlmer(conc ~ SSfol(Dose, Time,lKe, lKa, lCl) ~
+              0+lKe+lKa+lCl+(0+lKe|Subject)+(0+lKa|Subject)
+              +(0+lCl|Subject), nAGQ=0, Theoph,
+              start = Th.start, verbose=2L)
Error in FUN(X[[1L]], ...) : no loop for break/next, jumping to top level

I cannot load the lme4a package, just the lme4, is this the problem?

Any help with the nlme or nlmer syntax would be awesome. I don't really know the difference, but any of these that can give me fixed factor effects on the parameters of the nonlinear model would work for me.


Lara


From matlack at ohio.edu  Fri Dec  7 20:20:30 2012
From: matlack at ohio.edu (Matlack, Glenn)
Date: Fri, 7 Dec 2012 14:20:30 -0500
Subject: [R-sig-ME] Mixed model including spatially autocorrelated response
Message-ID: <21D4FC5FDE197F4D942D0CF404BE76A3307942A870@EXMAIL1.ohio.edu>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121207/519fc890/attachment.pl>

From bbolker at gmail.com  Sat Dec  8 17:19:33 2012
From: bbolker at gmail.com (Ben Bolker)
Date: Sat, 8 Dec 2012 16:19:33 +0000 (UTC)
Subject: [R-sig-ME] Mixed model including spatially autocorrelated
	response
References: <21D4FC5FDE197F4D942D0CF404BE76A3307942A870@EXMAIL1.ohio.edu>
Message-ID: <loom.20121208T170719-659@post.gmane.org>

Matlack, Glenn <matlack at ...> writes:

> 
> Dear R Sig Mixed,

> I am having difficulty using Variogram within GLS to examine spatial
> structure within a mixed model.  My data frame consists of
> ecological measurements of a forest, in which three landscape
> positions ("landposi") are compared.  Each landscape position is
> replicated five times ("replicat"), and the environment is measured
> ("canopy", "litdepth", etc.) one hundred times at 50-cm intervals
> along a transect ("distanc").  Thus, there are 1,500 rows of data.
> The raw data file begins:
 

[snip]
 
> # The general strategy follows Pinheiro and Bates' (2000;
> pp. 260-266) and Crawley's (2007; pp. 778-785) wheat-trials example:
> 1) groupedData is used to specify the nesting structure, 2) a GLS
> model is fit assuming no spatial autocorrelation, 3) spatial
> covariance is added using the Variogram function, and 4) # # #
> spatial correlation structures are compared.  Before beginning,
> "canopy" (a percentage) is arcsin sqareroot transformed to
> "trancano", and "replicat" is specified as a factor.
 
> smith<-read.table("C:\\Users\\matlack\\Desktop\\
>  Documents\\Undergrad Research\\Nicole Smith\\smith.txt",header=T)

  Right now this isn't reproducible.  Is there any chance you
can post the data somewhere, or extract a subset?
http://tinyurl.com/reproducible-000 is useful.

> attach(smith)

   I have a strong preference against attach(); it is generally
more coherent to add new variables or transform variables *within*
the data frame, as in

smith2 <- transform(smith,
    trancano=asin(sqrt(canopy/100)),
    replicat=factor(replicat))


> > library(nlme)

[snip]

> structure<-groupedData(trancano~landposi|landposi/replicat)

> "Trancano" is the response variable, "landposi" is the factor of
> interest, and "replicat" is a random effect nested within
> "landposi".
 
> > model<-gls(trancano~landposi,structure)

I have a couple of comments here.  I generally don't use
groupedData because I don't understand them; I prefer to 
specify random effects structures explicitly in the model.
I'm also a bit confused, because as far as I know gls()
doesn't handle random effects??  But maybe gls() just
ignores groupedData information?

  Also, it doesn't make sense to fit landposi as both
a fixed effect and a random effect.  You may want
landposi:replicat rather than landposi/replicat as your
grouping factor ...

> > summary(model)
> 
> Generalized least squares fit by REML
>                 Model: trancano ~ landposi
>                 Data: structure
>              AIC                  BIC                         logLik
>            -4968.469             -4947.224             2488.235
> 
> Coefficients:

[snip]

Here's my reproducible example:

library(nlme)
set.seed(101)
d <- expand.grid(landposi=c("bottom","mid","top"),
                 replicat=factor(1:5),
                 distanc=1:100)
d$z <- runif(nrow(d))
d <- transform(d,posrep=interaction(landposi,replicat))
m1 <- lme(z~landposi,random=~1|posrep,data=d)
plot(Variogram(m1,form=~distanc|posrep))


From bonamy at horus.ens.fr  Sat Dec  8 19:47:06 2012
From: bonamy at horus.ens.fr (Pierre de Villemereuil)
Date: Sat, 08 Dec 2012 19:47:06 +0100
Subject: [R-sig-ME] How to compute heritabilities on binomial response
 variables...
In-Reply-To: <50C1D591.3080803@unil.ch>
References: <50C1D591.3080803@unil.ch>
Message-ID: <50C38B2A.4000401@horus.ens.fr>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121208/2b4db533/attachment.pl>

From chico3 at sapo.pt  Sun Dec  9 20:58:15 2012
From: chico3 at sapo.pt (chico3 at sapo.pt)
Date: Sun, 09 Dec 2012 19:58:15 +0000
Subject: [R-sig-ME] split plot design glmer
Message-ID: <20121209195815.Horde.RL2Rb_anEAJQxO1Xkc52q1A@mail.sapo.pt>


Dear experts,



(This is the follow up of a previous question)


My background with mixed models is very pour. However,With the
precious help of this forum I have implement a glmer function to test
the experiment described below (randomized block design)

I have four luminaires randomly distributed. Two luminaires have light
on and two luminaires have no light. Below the luminaires I have two
treatments. Each treatment as four replicates that were randomly
distributed below the luminaires. Moreover, I have made all the
possible combinations of presence absence of light and treatments.

I want to check if there is a effect of each treatment and the
interactions between all the combinations.The response variable is a
proportion (number of specific specie/total number of species)
#define factors

Treatment1<-as.factor("Yes","No")
Treatment2<-as.factor("Yes","No")
Light<-as.factor("Yes","No")
Luminaire<-as.factor("LightYes1","LightYes2","NoLight1", "NoLight2")
Response<-cbind(number_of_specific_species, total_species)

#including individual level variability to account for overdispersion

obs <- 1:nrow(Response)

#model
library(lme4)
model<-glmer(Response ~ Treatment1*Treatment2*Light + (1|Luminaire) +
(1|obs), family=binomial)
summary(model)
Generalized linear mixed model fit by the Laplace approximation
Formula: Response ~ Treatment1 * Treatment2 * Light + (1 | Luminaire)
+ (1 | obs)
     AIC   BIC logLik deviance
   180.2 194.9  -80.1    160.2
Random effects:
   Groups    Name        Variance Std.Dev.
   obs       (Intercept) 0.059638 0.24421
   Luminaire (Intercept) 0.000000 0.00000
Number of obs: 32, groups: obs, 32; Luminaire, 4

Fixed effects:
                                          Estimate Std. Error z value Pr(>|z|)
(Intercept)                             -0.9283     0.1236  -7.511
5.88e-14 ***
Treatment1Yes                            0.2416     0.1743   1.386  0.16582
Treatment2Yes                           -0.2459     0.1747  -1.408  0.15921
LightYes                                -0.2069     0.1745  -1.186  0.23562
Treatment1Yes:Treatment2Yes             -0.7517     0.2468  -3.046  0.00232 **
Treatment1Yes:LightYes                  -0.3018     0.2464  -1.225  0.22071
Treatment2Yes:LightYes                   0.2126     0.2466   0.862  0.38866
Treatment1Yes:Treatment2Yes:LightYes     0.7520     0.3488   2.156  0.03110 *
---
Signif. codes:  0 ?***? 0.001 ?**? 0.01 ?*? 0.05 ?.? 0.1 ? ? 1

Correlation of Fixed Effects:
                                (Intr) Treatment1Yes Treatment2Yes
LightYes  Treatment1Ys:Treatment2Y Treatment1Y:U Treatment2Y:Light
Treatment1Yes                 -0.709
Treatment2Yes                 -0.708    0.502
LightYes                      -0.708    0.502         0.501
Treatment1Yes:Treatment2Ys     0.501    -0.706       -0.708        -0.355
Treatment1Yes:LightYs          0.502    -0.707       -0.355
-0.708               0.500
Treatment2Yes:LightYes         0.501    -0.355       -0.708
-0.707               0.501               0.501
Treatment1Y:Treatment2Y:Light -0.354     0.500        0.501
0.500               -0.707             -0.706         -0.707


-------------

The results are coherent with barplot and PCO analysis that I did
previously, were combination of treatment1 and treatment2  have a
greater effect than other combinations.


My question are

Is the model corrected?

How can I interpret the results, since I cannot do a Anova for example?


Cheers,

FranciscoR


From bosaylor at yahoo.com  Fri Dec  7 23:47:47 2012
From: bosaylor at yahoo.com (Bo Saylor)
Date: Fri, 7 Dec 2012 22:47:47 +0000 (UTC)
Subject: [R-sig-ME] Excluding random intercepts?
References: <9F743AD1C32A4A2D8E90EB1401821A24@Wipflilatitude>
Message-ID: <loom.20121207T133009-667@post.gmane.org>

Kirsty,

I think the comment from Tom is a good place to start thinking about your
question.  In addition, Gelman and Hill (2007) address your question
specifically on page 283.  Their short answer is that when a slope is allowed to
vary it makes sense to for the intercept to vary too, and that it is an
implausible scenario where intercepts do not vary but slopes for some x do. 
Nevertheless, they go on to provide an example (an experimental design) where it
does make sense. 

Bo


From jeffrey_warren at fws.gov  Tue Dec 11 01:00:53 2012
From: jeffrey_warren at fws.gov (Jeffrey Warren)
Date: Mon, 10 Dec 2012 17:00:53 -0700
Subject: [R-sig-ME] Multinomial mixed-effect model in nnet
In-Reply-To: 185d5468360903d3750139ee21267980@mail.gmail.com
References: 185d5468360903d3750139ee21267980@mail.gmail.com
Message-ID: <59c91690ea43456c72e535661ae99314@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121210/3d75c01d/attachment.pl>

From laurent_step at yahoo.fr  Tue Dec 11 10:54:17 2012
From: laurent_step at yahoo.fr (laurent stephane)
Date: Tue, 11 Dec 2012 09:54:17 +0000 (GMT)
Subject: [R-sig-ME] random effect with only one level
Message-ID: <1355219657.96199.YahooMailNeo@web171706.mail.ir2.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121211/15825b13/attachment.pl>

From v_coudrain at voila.fr  Tue Dec 11 12:18:00 2012
From: v_coudrain at voila.fr (v_coudrain at voila.fr)
Date: Tue, 11 Dec 2012 12:18:00 +0100 (CET)
Subject: [R-sig-ME] How to get dispersion parameter from a binomial mixed
	model?
Message-ID: <1706925795.281001355224680718.JavaMail.www@wwinf7139>

I am modelling data with a generalized mixed model with binomial error distribution and I am concerned about overdispersion. I know that dispersion parameter can 
be measured as deviance/df, but for mixed models (= with random effect), the number of degrees of freedom cannot be extracted (I am using the function lmer from 
R). Is there any way to find out if my data are overdispersed?

Thank you very much
Valerie
___________________________________________________________
Qui est Marine Lorphelin, la nouvelle Miss France ? Des infos ? lire sur Voila http://actu.voila.fr/actualites/documents/2012/12/09/marine-lorphelin-une-brillante-etudiante-en-medecine-devenue-miss-france_4556258.html


From maechler at stat.math.ethz.ch  Tue Dec 11 12:33:58 2012
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Tue, 11 Dec 2012 12:33:58 +0100
Subject: [R-sig-ME] Multinomial mixed-effect model in nnet
In-Reply-To: <59c91690ea43456c72e535661ae99314@mail.gmail.com>
References: <59c91690ea43456c72e535661ae99314@mail.gmail.com>
Message-ID: <20679.6694.460772.488840@stat.math.ethz.ch>

Can you  PLEASE  stop spamming the  r-sig-mixed-models
mailing list ?

Your question ... now the  FOURTH  time, unchanged AFAICS,
seems almost completely unrelated to the topics of this
SIG (= Special Interest Group) mailing list...
and that's why nobody has answered till now.

Maybe rather use R-help,
[ but first really change what you post: 
  Give much less R output of multinom() but possibly more detailed
  description of your data design...
  --> Read the posting guide,... which also mentions how to ask questions
      that do evoke answers]

Regards,
Martin Maechler

>>>>>     on Mon, 10 Dec 2012 17:00:53 -0700 writes:

    > Hello,
    > We?re exploring temporal change in summer range selection in radio-collared
    > elk during a 3 decade period. Elk are marked on the wintering grounds and
    > tracked back to one of 5 summer ranges. There are 180 individuals; most (n
    > = 121) individuals were monitored >=2 years, resulting in a total of 546
    > summer range observations from the 180 elk. We?ve run multinomial
    > regression models with year as a predictor in packages ?mlogit? and ?nnet?
    > using only the last summer range choice for each individual (n = 180):



    > m2.year<-multinom(summercategory~n.year, data=elk, Hess=T)

    > # weights:  15 (8 variable)

    > initial  value 289.698824

    > iter  10 value 237.592576

    > final  value 237.060236

    > converged

    >> summary(m2.year)

    > Call:

    > multinom(formula = summercategory ~ n.year, data = elk, Hess = T)



    > Coefficients:

    > (Intercept)       n.year

    > GTNPCEB   1.1306086  0.008673583

    > GTNPS    -2.7164924  0.128711359

    > TW       -0.4452291  0.007482690

    > YNP       0.8210785 -0.042043091



    > Std. Errors:

    > (Intercept)     n.year

    > GTNPCEB   0.3936527 0.01869625

    > GTNPS     0.9689580 0.03476211

    > TW        0.5450637 0.02550461

    > YNP       0.4229157 0.02325437



    > Residual Deviance: 474.1205

    > AIC: 490.1205



    > We?ve also run a mixed-effect model in nnet using the individual as a
    > random effect to account for the longitudinal data of repeated observations
    > through time for some individuals with all 546 observations.

....................
....................
....................

    > Thanks,

    > Jeff

    > [[alternative HTML version deleted]]

    > _______________________________________________
    > R-sig-mixed-models at r-project.org mailing list
    > https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models


From roby.joehanes at nih.gov  Tue Dec 11 19:06:59 2012
From: roby.joehanes at nih.gov (Joehanes, Roby (NIH/NHLBI) [F])
Date: Tue, 11 Dec 2012 13:06:59 -0500
Subject: [R-sig-ME] Multinomial mixed-effect model in nnet
In-Reply-To: <59c91690ea43456c72e535661ae99314@mail.gmail.com>
Message-ID: <CCECE073.44C4%joehanesr@mail.nih.gov>

Hi Jeffrey:

Your concern about lack of multiple observations on about half of the
samples is indeed valid, but nnet is not a mixed model package. I think you
should clarify what you would like to accomplish with your data and what
specifically you want out of the mixed model to your analysis. If you want
to establish association between "summercategory" and "n.year" after
accounting for the elkid, then you can apply mixed model analysis. You may
want to look into glmmADMB package for doing so.

Hope this helps,
Roby

On 12/10/12 7:00 PM, "Jeffrey Warren" <jeffrey_warren at fws.gov> wrote:

> Hello,
> 
> 
> 
> We?re exploring temporal change in summer range selection in radio-collared
> elk during a 3 decade period. Elk are marked on the wintering grounds and
> tracked back to one of 5 summer ranges. There are 180 individuals; most (n
> = 121) individuals were monitored >=2 years, resulting in a total of 546
> summer range observations from the 180 elk. We?ve run multinomial
> regression models with year as a predictor in packages ?mlogit? and ?nnet?
> using only the last summer range choice for each individual (n = 180):
...
[snip]


From bbolker at gmail.com  Tue Dec 11 22:12:56 2012
From: bbolker at gmail.com (Ben Bolker)
Date: Tue, 11 Dec 2012 21:12:56 +0000 (UTC)
Subject: [R-sig-ME]
	=?utf-8?q?How_to_get_dispersion_parameter_from_a_binom?=
	=?utf-8?q?ial_mixed=09model=3F?=
References: <1706925795.281001355224680718.JavaMail.www@wwinf7139>
Message-ID: <loom.20121211T221110-968@post.gmane.org>

 <v_coudrain at ...> writes:

>  I am modelling data with a generalized mixed model with binomial
> error distribution and I am concerned about overdispersion. I know
> that dispersion parameter can be measured as deviance/df, but for
> mixed models (= with random effect), the number of degrees of
> freedom cannot be extracted (I am using the function lmer from
> R). Is there any way to find out if my data are overdispersed?

  Have you searched for "overdispersion" at http://glmm.wikidot.com/faq
... ?  There is no perfect way to estimate the residual degrees of
freedom for a mixed model, it depends considerably on the question,
but since most estimates of overdispersion are approximations anyway
you can use (number of fixed-effect parameters + number of random-effect
parameters).


From bbolker at gmail.com  Wed Dec 12 03:58:05 2012
From: bbolker at gmail.com (Ben Bolker)
Date: Wed, 12 Dec 2012 02:58:05 +0000 (UTC)
Subject: [R-sig-ME] random effect with only one level
References: <1355219657.96199.YahooMailNeo@web171706.mail.ir2.yahoo.com>
Message-ID: <loom.20121212T033421-959@post.gmane.org>

laurent stephane <laurent_step at ...> writes:

> 
> Hi, 
> 
> ?The lmer() function seems to work well for a mixed model having a random
effect with only one level: it
> doesn't crash and there's not even a warning. I'm not a specialist about the
numerical mathematics behind
> lmer(), but isn't it possible to see somewhere in the output there's a problem
such as a convergence
> problem for instance ? (in such a situation SAS 9.2 returns a "note" about a
problem with some Hessian matrix).
> 
> St?phane
> 

  I tried out a trivial example.  I agree that it's a bit odd that
this doesn't break down anywhere, but the results are mostly sensible --
or at least not dangerous.  The random-effects variance reported
is meaningless, but the coefficients and residual variances are
correct (they match the results of lm()), and the BLUP/conditional
mode of the single random-effects level is essentially zero.

  Does that agree with your results?

  So it might be nice to have a warning, but it doesn't strike
me as really dangerous.


set.seed(101)
d <- data.frame(x=runif(200),f="A")
d <- within(d, y <- rnorm(nrow(d),mean=2*x+3))

library(lme4)
m2 <- lmer(y~x+(1|f),data=d)
m3 <- lm(y~x,data=d)
all.equal(fixef(m2),coef(m3)) ## TRUE
all.equal(attr(VarCorr(m2),"sc"),summary(m3)$sigma)  ## TRUE
ranef(m2)  ## 2e-12


From laurent_step at yahoo.fr  Wed Dec 12 10:30:28 2012
From: laurent_step at yahoo.fr (laurent stephane)
Date: Wed, 12 Dec 2012 09:30:28 +0000 (GMT)
Subject: [R-sig-ME] random effect with only one level
In-Reply-To: <loom.20121212T033421-959@post.gmane.org>
References: <1355219657.96199.YahooMailNeo@web171706.mail.ir2.yahoo.com>
	<loom.20121212T033421-959@post.gmane.org>
Message-ID: <1355304628.84922.YahooMailNeo@web171702.mail.ir2.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121212/2983d477/attachment.pl>

From wolfgang.viechtbauer at maastrichtuniversity.nl  Wed Dec 12 15:51:40 2012
From: wolfgang.viechtbauer at maastrichtuniversity.nl (Viechtbauer Wolfgang (STAT))
Date: Wed, 12 Dec 2012 15:51:40 +0100
Subject: [R-sig-ME] Mixed-Effects Models with Group or Covariate-Dependent
 Autocorrelation
Message-ID: <077E31A57DA26E46AB0D493C9966AC730D5FFED3B2@UM-MAIL4112.unimaas.nl>

Dear All,

I am currently working with some mixed-effects models for longitudinal data where I want to test hypotheses about the difference in the strength of the autocorrelation between two groups. In particular, let's say I have data of the form:

person  time  group  y
----------------------------
1       0     A      <value>
1       1     A      <value>
1       2     A      <value>
...     ...   ...    ...
2       0     A      <value>
2       1     A      <value>
2       2     A      <value>
...     ...   ...    ...

and I want to fit the model:

y_ij = beta_0 + beta_1 time_ij + u_0i + u_1i time + e_ij,

where i is the index for person, j is the index for time, u_0i ~ N(0, tau^2_0) is a random effect for the intercepts, u_1i ~ N(0, tau^2_1) is a random effect for the slopes, cov(u_0i, u_1i) = tau_01 is the covariance between these two random effects, and now I want to fit an AR(1) structure for the errors e_ij, where the autocorelation is rho_A for people from group A and rho_B for people from group B. In principle, I may also want to let the error variance to differ for the two groups (i.e., sigma^2_A and sigma^2_B).

In nlme, I can fit models with a common autocorrelation structure for the two groups, with:

lme(y ~ time, random = ~ time | person, correlation = corAR1(form = ~ time | person))

but as far as I can tell, it is not possible to allow the autocorrelation parameter to differ between the two groups.

Does anybody know of a package/function that would allow fitting such a model?

Moreover, the groups are actually created by dichotomizing a continuous measure. Ideally, I would like to fit a model, where rho depends on the continuous measure directly. Or, to avoid issues related to rho having to fall between -1 and 1, it would probably make more sense to assume that f(rho) depends on that continuous measure, where f() is the arctanh (inverse hyperbolic function or Fisher's r-to-z) transformation. Again, any ideas on packages/functions that may handle such a model?

Thanks in advance for any suggestions!

Best,
Wolfgang

--   
Wolfgang Viechtbauer, Ph.D., Statistician   
Department of Psychiatry and Psychology   
School for Mental Health and Neuroscience   
Faculty of Health, Medicine, and Life Sciences   
Maastricht University, P.O. Box 616 (VIJV1)   
6200 MD Maastricht, The Netherlands   
+31 (43) 388-4170 | http://www.wvbauer.com   


From laurent_step at yahoo.fr  Wed Dec 12 17:06:05 2012
From: laurent_step at yahoo.fr (laurent stephane)
Date: Wed, 12 Dec 2012 16:06:05 +0000 (GMT)
Subject: [R-sig-ME] matrix not positive definite with lmer()
Message-ID: <1355328365.93429.YahooMailNeo@web171701.mail.ir2.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121212/5311c2af/attachment.pl>

From bates at stat.wisc.edu  Thu Dec 13 00:36:21 2012
From: bates at stat.wisc.edu (Douglas Bates)
Date: Wed, 12 Dec 2012 17:36:21 -0600
Subject: [R-sig-ME] matrix not positive definite with lmer()
In-Reply-To: <1355328365.93429.YahooMailNeo@web171701.mail.ir2.yahoo.com>
References: <1355328365.93429.YahooMailNeo@web171701.mail.ir2.yahoo.com>
Message-ID: <CAO7JsnSrBiY78QpwPHQKziqNJ=M-6KeJjYAkq6Vmtd1-TWVWhg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121212/4f5f0b35/attachment.pl>

From bates at stat.wisc.edu  Thu Dec 13 00:46:26 2012
From: bates at stat.wisc.edu (Douglas Bates)
Date: Wed, 12 Dec 2012 17:46:26 -0600
Subject: [R-sig-ME] random effect with only one level
In-Reply-To: <1355304628.84922.YahooMailNeo@web171702.mail.ir2.yahoo.com>
References: <1355219657.96199.YahooMailNeo@web171706.mail.ir2.yahoo.com>
	<loom.20121212T033421-959@post.gmane.org>
	<1355304628.84922.YahooMailNeo@web171702.mail.ir2.yahoo.com>
Message-ID: <CAO7JsnSxYr0ZraqzXNxX5GNzLffmKO_Rpd4F8iCgYSGF-ouBwQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121212/ab0f6c97/attachment.pl>

From bates at stat.wisc.edu  Thu Dec 13 00:57:05 2012
From: bates at stat.wisc.edu (Douglas Bates)
Date: Wed, 12 Dec 2012 17:57:05 -0600
Subject: [R-sig-ME] random effect with only one level
In-Reply-To: <CAO7JsnSxYr0ZraqzXNxX5GNzLffmKO_Rpd4F8iCgYSGF-ouBwQ@mail.gmail.com>
References: <1355219657.96199.YahooMailNeo@web171706.mail.ir2.yahoo.com>
	<loom.20121212T033421-959@post.gmane.org>
	<1355304628.84922.YahooMailNeo@web171702.mail.ir2.yahoo.com>
	<CAO7JsnSxYr0ZraqzXNxX5GNzLffmKO_Rpd4F8iCgYSGF-ouBwQ@mail.gmail.com>
Message-ID: <CAO7JsnRCEX22dyjQgX_Sf_U6z0ky3Ko12D9yYka8gMFMQqeoBg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121212/d6af0330/attachment.pl>

From v_coudrain at voila.fr  Thu Dec 13 08:34:36 2012
From: v_coudrain at voila.fr (v_coudrain at voila.fr)
Date: Thu, 13 Dec 2012 08:34:36 +0100 (CET)
Subject: [R-sig-ME] How to get dispersion parameter from a binomial mixed
	model?
Message-ID: <1594602540.232011355384076494.JavaMail.www@wwinf7139>

Thank you very much for this link. The implemented function "overdisp_fun" allowed me to get what I want. 
My data are indeed overdispersed and I think about adding an individual random effect, since quasi-binomial distribution are not supported by lmer. I may use 
penalized quasi likelihood, but I know that it is quite controverse. Maybe someone could give me some advice?

Best wishes
Val?rie
___________________________________________________________
Achetez votre tablette num?rique au meilleur prix gr?ce ? Voila http://shopping.voila.fr/vitrine/tablettes-pc


From laurent_step at yahoo.fr  Thu Dec 13 10:09:36 2012
From: laurent_step at yahoo.fr (laurent stephane)
Date: Thu, 13 Dec 2012 09:09:36 +0000 (GMT)
Subject: [R-sig-ME] matrix not positive definite with lmer()
In-Reply-To: <CAO7JsnSrBiY78QpwPHQKziqNJ=M-6KeJjYAkq6Vmtd1-TWVWhg@mail.gmail.com>
References: <1355328365.93429.YahooMailNeo@web171701.mail.ir2.yahoo.com>
	<CAO7JsnSrBiY78QpwPHQKziqNJ=M-6KeJjYAkq6Vmtd1-TWVWhg@mail.gmail.com>
Message-ID: <1355389776.89288.YahooMailNeo@web171704.mail.ir2.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121213/eb09e76e/attachment.pl>

From laurent_step at yahoo.fr  Thu Dec 13 14:16:46 2012
From: laurent_step at yahoo.fr (laurent stephane)
Date: Thu, 13 Dec 2012 13:16:46 +0000 (GMT)
Subject: [R-sig-ME] are warnings not stored in the lmer() output ?
Message-ID: <1355404606.23291.YahooMailNeo@web171704.mail.ir2.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121213/78716823/attachment.pl>

From aghaynes at gmail.com  Thu Dec 13 14:46:50 2012
From: aghaynes at gmail.com (Alan Haynes)
Date: Thu, 13 Dec 2012 14:46:50 +0100
Subject: [R-sig-ME] are warnings not stored in the lmer() output ?
In-Reply-To: <1355404606.23291.YahooMailNeo@web171704.mail.ir2.yahoo.com>
References: <1355404606.23291.YahooMailNeo@web171704.mail.ir2.yahoo.com>
Message-ID: <CAPdSD+5muiZkjSzv2H-5ssV+XKVMG9yeh5OmsxryRVTd6R1VUw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121213/e24eb6b6/attachment.pl>

From smilodon2000 at hotmail.com  Thu Dec 13 15:08:46 2012
From: smilodon2000 at hotmail.com (john benson)
Date: Thu, 13 Dec 2012 14:08:46 +0000
Subject: [R-sig-ME] empirical standard errors for glmer in lme4?
Message-ID: <SNT118-W58F822DEB3FCC1EE9F9587DC4E0@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121213/d4a97027/attachment.pl>

From laurent_step at yahoo.fr  Thu Dec 13 15:31:46 2012
From: laurent_step at yahoo.fr (laurent stephane)
Date: Thu, 13 Dec 2012 14:31:46 +0000 (GMT)
Subject: [R-sig-ME] are warnings not stored in the lmer() output ?
In-Reply-To: <CAPdSD+5muiZkjSzv2H-5ssV+XKVMG9yeh5OmsxryRVTd6R1VUw@mail.gmail.com>
References: <1355404606.23291.YahooMailNeo@web171704.mail.ir2.yahoo.com>
	<CAPdSD+5muiZkjSzv2H-5ssV+XKVMG9yeh5OmsxryRVTd6R1VUw@mail.gmail.com>
Message-ID: <1355409106.4926.YahooMailNeo@web171706.mail.ir2.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121213/8616c9b4/attachment.pl>

From laurent_step at yahoo.fr  Thu Dec 13 21:57:33 2012
From: laurent_step at yahoo.fr (laurent stephane)
Date: Thu, 13 Dec 2012 20:57:33 +0000 (GMT)
Subject: [R-sig-ME] restart with estimates as starting values
Message-ID: <1355432253.7248.YahooMailNeo@web171706.mail.ir2.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121213/52cb3d17/attachment.pl>

From lars.dalby at gmail.com  Fri Dec 14 16:28:45 2012
From: lars.dalby at gmail.com (Lars Dalby)
Date: Fri, 14 Dec 2012 10:28:45 -0500
Subject: [R-sig-ME] Interpretation of numIter 0 in glsObject
Message-ID: <FDE2C525-878B-45AC-8C7F-2A785ECBA912@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121214/8f0ebb23/attachment.pl>

From bbolker at gmail.com  Sat Dec 15 04:13:30 2012
From: bbolker at gmail.com (Ben Bolker)
Date: Sat, 15 Dec 2012 03:13:30 +0000 (UTC)
Subject: [R-sig-ME] How to get dispersion parameter from a binomial
	mixed model?
References: <1594602540.232011355384076494.JavaMail.www@wwinf7139>
Message-ID: <loom.20121215T034220-681@post.gmane.org>

 <v_coudrain at ...> writes:

> Thank you very much for this link. The implemented function
>  "overdisp_fun" allowed me to get what I want. 
> My data are indeed overdispersed and I think about adding an 
> individual random effect, since
> quasi-binomial distribution are not supported by lmer. I may use 
> penalized quasi likelihood, but I know that it is quite controverse.
>  Maybe someone could give me some advice?

  It's hard to give completely general advice.  I don't know what
(for example) Zuur et al say in their books.  I generally have a mild
preference for observation-level random effects because they have
a well-defined likelihood etc etc..  PQL is not awful; it's just known
to be biased in some cases (see Breslow's _Whither PQL?_ paper, I think
the ref is on the FAQ page). I believe there are several papers in the
medical literature arguing that it's OK in some typical biostats/clinical
stats setting (I haven't looked carefully).  Note that the variance-mean
relationships are different for different choices:

standard quasibinomial:  var=phi*n*p*(1-p)
beta-binomial: see http://en.wikipedia.org/wiki/Beta-binomial_distribution'
logistic-normal-binomial (i.e. observation-level random effect): ??

  I worked out the comparison for the Poisson-overdispersion case at
one point and found that the Gamma-Poisson (neg binom) and lognormal-Poisson
have the same quadratic mean-variance relationship; my guess is that
there is a similar answer for this case but I'm not sure.


From v_coudrain at voila.fr  Sat Dec 15 12:35:18 2012
From: v_coudrain at voila.fr (v_coudrain at voila.fr)
Date: Sat, 15 Dec 2012 12:35:18 +0100 (CET)
Subject: [R-sig-ME] How to get dispersion parameter from a binomial mixed
	model?
Message-ID: <1863284355.228631355571318484.JavaMail.www@wwinf7130>

Thank you very much for these useful comments. I run my models with both penalized quasi likelihood and logistic-normal-binomial distribution and I found some 
differences suggesting that penalized quasi likelihood is more conservative, which is something that I already heard. I noticed that logistic-normal-binomial method is 
gaining importance in the recently published papers, so that it seems to be a good opportunity. Anyway it would be very useful to have good support from an in-
depth work-out of this method as you did for Poisson-overdispersion. I'm quite sure that it should appear in the next time. 
Best
___________________________________________________________
Achetez votre tablette num?rique au meilleur prix gr?ce ? Voila http://shopping.voila.fr/vitrine/tablettes-pc


From highstat at highstat.com  Sat Dec 15 21:50:59 2012
From: highstat at highstat.com (Highland Statistics Ltd)
Date: Sat, 15 Dec 2012 16:50:59 -0400
Subject: [R-sig-ME] How to get dispersion parameter from a
 binomial	mixed, model? (Ben Bolker)
In-Reply-To: <mailman.5.1355569202.19371.r-sig-mixed-models@r-project.org>
References: <mailman.5.1355569202.19371.r-sig-mixed-models@r-project.org>
Message-ID: <50CCE2B3.3060707@highstat.com>




------------------------------

Message: 2
Date: Sat, 15 Dec 2012 03:13:30 +0000 (UTC)
From: Ben Bolker <bbolker at gmail.com>
To: r-sig-mixed-models at r-project.org
Subject: Re: [R-sig-ME] How to get dispersion parameter from a
	binomial	mixed model?
Message-ID: <loom.20121215T034220-681 at post.gmane.org>
Content-Type: text/plain; charset=us-ascii

  <v_coudrain at ...> writes:

> Thank you very much for this link. The implemented function
>  "overdisp_fun" allowed me to get what I want.
> My data are indeed overdispersed and I think about adding an
> individual random effect, since
> quasi-binomial distribution are not supported by lmer. I may use
> penalized quasi likelihood, but I know that it is quite controverse.
>  Maybe someone could give me some advice?

   It's hard to give completely general advice.  I don't know what
(for example) Zuur et al say in their books.  I generally have a mild




AFZ: In our 2012 volume we carried out a simulation study (using the owl data) for a Poisson GLMM with
observation level random intercept epsilon. We were curious to see what happens if
the observation level random effect is much larger than the random effect that
was already in the model (for nests). Would it disappear...or would it stay as before?
And what happens if the observation level RE is the same magnitude, or smaller than the random
effect nest?

The method itself seems to perform ok. What I don't like of the observation level random intercept
is that quite often the observation level random intercept causes a perfect fit for the
model (assuming you use the fitted function...it includes the observation level RE). Well..
perhaps I should re-phrase this. I don't like that the fitted function in glmer includes
the observation level random intercept.

Because Pearson residuals are scaled you don't notice that you have a perfect fit.

My preference is to use an NB GLMM for overdispersed count data (assuming that the overdispersion
is not caused by something else). For binomial data, perhaps the beta-binomial?

Alain



  preference for observation-level random effects because they have
a well-defined likelihood etc etc..  PQL is not awful; it's just known
to be biased in some cases (see Breslow's _Whither PQL?_ paper, I think
the ref is on the FAQ page). I believe there are several papers in the
medical literature arguing that it's OK in some typical biostats/clinical
stats setting (I haven't looked carefully).  Note that the variance-mean
relationships are different for different choices:

standard quasibinomial:  var=phi*n*p*(1-p)
beta-binomial: see http://en.wikipedia.org/wiki/Beta-binomial_distribution'
logistic-normal-binomial (i.e. observation-level random effect): ??

   I worked out the comparison for the Poisson-overdispersion case at
one point and found that the Gamma-Poisson (neg binom) and lognormal-Poisson
have the same quadratic mean-variance relationship; my guess is that
there is a similar answer for this case but I'm not sure.


From v_coudrain at voila.fr  Sun Dec 16 11:34:59 2012
From: v_coudrain at voila.fr (v_coudrain at voila.fr)
Date: Sun, 16 Dec 2012 11:34:59 +0100 (CET)
Subject: [R-sig-ME] How to get dispersion parameter from a binomial	mixed,
	model?
Message-ID: <192717323.337561355654099452.JavaMail.www@wwinf7130>

Thank you. That's true that after including an individual-level random effect, the model seems to be "magically" perfect, which may be doubtful. But it is certainly still a 
better choice than the overdispersed binomial model. I do not know about beta-binomial. I will have a look at it. Is there a good R package for computing it? 
Kind regards
Val?rie
___________________________________________________________
Achetez votre tablette num?rique au meilleur prix gr?ce ? Voila http://shopping.voila.fr/vitrine/tablettes-pc


From bbolker at gmail.com  Sun Dec 16 20:49:22 2012
From: bbolker at gmail.com (Ben Bolker)
Date: Sun, 16 Dec 2012 19:49:22 +0000 (UTC)
Subject: [R-sig-ME] are warnings not stored in the lmer() output ?
References: <1355404606.23291.YahooMailNeo@web171704.mail.ir2.yahoo.com>
	<CAPdSD+5muiZkjSzv2H-5ssV+XKVMG9yeh5OmsxryRVTd6R1VUw@mail.gmail.com>
	<1355409106.4926.YahooMailNeo@web171706.mail.ir2.yahoo.com>
Message-ID: <loom.20121216T204831-150@post.gmane.org>

laurent stephane <laurent_step at ...> writes:

> 
> Thanks to Alan and Emmanuel for their help.
> 
> There is a very nice function tryCatch.W.E() available by typing
demo(error.catching). 
> 
> It returns a list with two components : the output and the warning.

  For what it's worth, the very latest (github) version of lme4 does
indeed catch warnings and store them in an @optinfo slot ...

  (Now we just need to fix the GLMM instabilities in that version ...)

  Ben Bolker


From jwiley.psych at gmail.com  Sun Dec 16 21:33:55 2012
From: jwiley.psych at gmail.com (Joshua Wiley)
Date: Sun, 16 Dec 2012 12:33:55 -0800
Subject: [R-sig-ME] Are there sampling methods for glmer objects?
Message-ID: <CANz9Z_Lv96sq26EQGDvFr9SoBeYatNEnqhsdPaf_mUA9Sg+A-Q@mail.gmail.com>

Hi All,

The subject pretty much says it all.  Using: lme4_0.999999-0

>From the archives, I have seen Ben Bolker mention a function "glmersim".

?mcmcsamp seems to indicate it can take model objects from glmer, but
when I try it with a simple random intercept logit, I get:
Error in validObject(.Object) :
  invalid class "merMCMC" object: Slot sigma must have length 1.

I also seem to recall something about a "bootMer" function to do
(faster) bootstrapping.

Thanks!

Josh

--
Joshua Wiley
Ph.D. Student, Health Psychology
Programmer Analyst II, Statistical Consulting Group
University of California, Los Angeles
https://joshuawiley.com/


From bbolker at gmail.com  Mon Dec 17 17:09:23 2012
From: bbolker at gmail.com (Ben Bolker)
Date: Mon, 17 Dec 2012 16:09:23 +0000 (UTC)
Subject: [R-sig-ME] Are there sampling methods for glmer objects?
References: <CANz9Z_Lv96sq26EQGDvFr9SoBeYatNEnqhsdPaf_mUA9Sg+A-Q@mail.gmail.com>
Message-ID: <loom.20121217T150807-286@post.gmane.org>

Joshua Wiley <jwiley.psych at ...> writes:

> 
> Hi All,
> 
> The subject pretty much says it all.  Using: lme4_0.999999-0
> 
> >From the archives, I have seen Ben Bolker mention a function "glmersim".
> 
> ?mcmcsamp seems to indicate it can take model objects from glmer, but
> when I try it with a simple random intercept logit, I get:
> Error in validObject(.Object) :
>   invalid class "merMCMC" object: Slot sigma must have length 1.
> 
> I also seem to recall something about a "bootMer" function to do
> (faster) bootstrapping.

  See ?"simulate-mer", which replaces glmersim.
  I've just added a note on the mcmcsamp status to the FAQ:

http://glmm.wikidot.com/faq#mcmcsamp_status

(That said, the error message you got does seem a bit odd -- but
I'm not motivated to pursue it since I don't think it will work
properly anyway).

  Note that arm::sim is also available (although I'm not sure
what algorithm it uses, and it only samples beta, not theta [variance
component] parameters).


From bbolker at gmail.com  Mon Dec 17 17:15:29 2012
From: bbolker at gmail.com (Ben Bolker)
Date: Mon, 17 Dec 2012 16:15:29 +0000 (UTC)
Subject: [R-sig-ME] empirical standard errors for glmer in lme4?
References: <SNT118-W58F822DEB3FCC1EE9F9587DC4E0@phx.gbl>
Message-ID: <loom.20121217T171020-973@post.gmane.org>

john benson <smilodon2000 at ...> writes:

> 

[quoting modified to trick gmane into letting me post]

# I am using generalized linear mixed models to investigate resource
# selection of animals in a wildlife population.  I've been using lme4
# and things have gone pretty well so far.  I'm exploring the
# selection/avoidance of landscape/environmental variables (fixed
# effects) based on locations that are used (coded 1) and available
# (coded 0) to/by the animals with logistic regression.  I've included
# random intercepts for individuals (to account for unbalanced sample
# size of telemetry locations) and social groups (to account for the
# fact that resource selection is likely similar between individuals
# within the groups).

> Basic model structure/code looks like this:

> M1<-glmer(y~x1+x2+....xn+(1|individual)+(1|group),data=data, 
>  family=binomial(link="logit"))

# I'm interested in using empirical standard errors for confidence
# intervals which I believe will be more conservative/appropriate than
# the model-based standard errors returned by lme4.  Additionally,
# previous researchers have noted concerns about the different
# correlation structure of used (spatially autocorrelated) and
# available (not autocorrelated) locations.  I was hoping to use HPD
# intervals for the model coefficients after generating MCMC samples.
# From extensive searching of the internet and reading many previous
# posts I'm confused about whether this is possible with the current
# version of lme4.  

[snip] 
> From reading previous posts it would appear that
> mcmcsamp function may not be currently enabled for lme4.

Correct (sort of): mcmcsamp has never worked (that I am aware)
for glmer models. See http://glmm.wikidot.com/faq#mcmcsamp_status

> My questions are these:

> 1. Is it possible to generate MCMC samples and HPD intervals with a
> glmer model using lme4?  If not, is it possible to this for a glmer
> in conjunction with another package, e.g. Coda?  Any help with
> packages and coding would be very helpful.

> 2. If it is not possible to get HPD intervals with glmer models does
> anyone have suggestions for other ways to generate empirical
> standard errors for glmer coefficients?  Its my understanding that
> Huber-White estimation is not possible with lme4....

> 3. Finally, if neither HPD or Huber-White is possible does anyone
> have any suggestions for generating confidence intervals around
> model coefficients of the fixed effects of a glmer model that would
> be both conservative/appropriate and help mitigate the problem of
> the different correlation structure of the used/available locations
> used as the response variable for my model.

  Have you exhausted the suggestions in the FAQ?  It sounds
like your problem might be suitable for many of the possibilities
listed there: switching to glmmADMB or MCMCglmm, or parametric
bootstrap, or ...  Perhaps you could try those, see how far you
get with one of them and re-post, or take a look at the options,
narrow down your choices, and re-post a more specific question?

  Ben Bolker


From bbolker at gmail.com  Mon Dec 17 17:21:11 2012
From: bbolker at gmail.com (Ben Bolker)
Date: Mon, 17 Dec 2012 16:21:11 +0000 (UTC)
Subject: [R-sig-ME]
	=?utf-8?q?How_to_get_dispersion_parameter_from_a_binom?=
	=?utf-8?q?ial=09mixed=2C_model=3F_=28Ben_Bolker=29?=
References: <mailman.5.1355569202.19371.r-sig-mixed-models@r-project.org>
	<50CCE2B3.3060707@highstat.com>
Message-ID: <loom.20121217T171725-244@post.gmane.org>

Highland Statistics Ltd <highstat at ...> writes:

> From: Ben Bolker <bbolker at ...>
>   <v_coudrain at ...> writes:
> 
> > Thank you very much for this link. The implemented function
> >  "overdisp_fun" allowed me to get what I want.
> > My data are indeed overdispersed and I think about adding an
> > individual random effect, since
> > quasi-binomial distribution are not supported by lmer. I may use
> > penalized quasi likelihood, but I know that it is quite controverse.
> >  Maybe someone could give me some advice?
> 
>    It's hard to give completely general advice.  I don't know what
> (for example) Zuur et al say in their books.  I generally have a mild

 
> AFZ: In our 2012 volume we carried out a simulation study (using the
> owl data) for a Poisson GLMM with observation level random intercept
> epsilon. We were curious to see what happens if the observation
> level random effect is much larger than the random effect that was
> already in the model (for nests). Would it disappear...or would it
> stay as before?  And what happens if the observation level RE is the
> same magnitude, or smaller than the random effect nest?
 
> The method itself seems to perform ok. What I don't like of the
> observation level random intercept is that quite often the
> observation level random intercept causes a perfect fit for the
> model (assuming you use the fitted function...it includes the
> observation level RE). Well..  perhaps I should re-phrase this. I
> don't like that the fitted function in glmer includes the
> observation level random intercept.

For what it's worth, the development version of lme4 includes a
predict() function that allows inclusion or exclusion of different
random effects in the prediction, so it would be easy enough
to generate the fitted value you wanted this way.
(I'm sorry to keep referring everyone to the development version,
but I really don't want to write all of these functions twice!)
 
> My preference is to use an NB GLMM for overdispersed count data
> (assuming that the overdispersion is not caused by something
> else). For binomial data, perhaps the beta-binomial?

glmmADMB (the best bet) doesn't currently include the beta-binomial
as an options although it wouldn't be awfully hard to add it.
Otherwise I guess you'd need something in the BUGS/JAGS/Stan,
or AD Model Builder, family to implement this ...


From jwiley.psych at gmail.com  Mon Dec 17 18:19:57 2012
From: jwiley.psych at gmail.com (Joshua Wiley)
Date: Mon, 17 Dec 2012 09:19:57 -0800
Subject: [R-sig-ME] Are there sampling methods for glmer objects?
In-Reply-To: <loom.20121217T150807-286@post.gmane.org>
References: <CANz9Z_Lv96sq26EQGDvFr9SoBeYatNEnqhsdPaf_mUA9Sg+A-Q@mail.gmail.com>
	<loom.20121217T150807-286@post.gmane.org>
Message-ID: <CANz9Z_Lk-mxifSzpqONCev7ph1KVa6q-4+6YLbCUOHc90S2brQ@mail.gmail.com>

 Hi Ben,

Thanks a lot!  I appreciate your comments.

Cheers,

Josh


On Mon, Dec 17, 2012 at 8:09 AM, Ben Bolker <bbolker at gmail.com> wrote:
> Joshua Wiley <jwiley.psych at ...> writes:
>
>>
>> Hi All,
>>
>> The subject pretty much says it all.  Using: lme4_0.999999-0
>>
>> >From the archives, I have seen Ben Bolker mention a function "glmersim".
>>
>> ?mcmcsamp seems to indicate it can take model objects from glmer, but
>> when I try it with a simple random intercept logit, I get:
>> Error in validObject(.Object) :
>>   invalid class "merMCMC" object: Slot sigma must have length 1.
>>
>> I also seem to recall something about a "bootMer" function to do
>> (faster) bootstrapping.
>
>   See ?"simulate-mer", which replaces glmersim.
>   I've just added a note on the mcmcsamp status to the FAQ:
>
> http://glmm.wikidot.com/faq#mcmcsamp_status
>
> (That said, the error message you got does seem a bit odd -- but
> I'm not motivated to pursue it since I don't think it will work
> properly anyway).
>
>   Note that arm::sim is also available (although I'm not sure
> what algorithm it uses, and it only samples beta, not theta [variance
> component] parameters).
>
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models



-- 
Joshua Wiley
Ph.D. Student, Health Psychology
Programmer Analyst II, Statistical Consulting Group
University of California, Los Angeles
https://joshuawiley.com/


From diegopujoni at gmail.com  Thu Dec 20 15:28:49 2012
From: diegopujoni at gmail.com (Diego Pujoni)
Date: Thu, 20 Dec 2012 12:28:49 -0200
Subject: [R-sig-ME] AIC model selection problem
Message-ID: <CANmSXjRsjSiot8-Zzs2-95ML9xQXy+4tm5GtK4CRKAwSgP4Zxw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121220/90eac8d7/attachment.pl>

From ealaca at ucdavis.edu  Thu Dec 20 17:37:20 2012
From: ealaca at ucdavis.edu (Emilio A. Laca)
Date: Thu, 20 Dec 2012 08:37:20 -0800
Subject: [R-sig-ME] glmm with correlated residuals
Message-ID: <EC6E1E38-6603-4D34-99C6-8265E93D1BEE@ucdavis.edu>

Fellow R users,

what package would you recommend for fitting a poisson glmm with one random effect and residuals that are correlated (most likely AR(1)) and have heterogeneity of variance?

I have successfully fitted the model without addressing the structured residuals in MCMCglmm.

I would appreciate it very much if you could point me in the direction of an example.

Emilio A. Laca, Professor
Department of Plant Sciences, MS 1
University of California, Davis
One Shields Ave.
Davis, CA 95616
ealaca at ucdavis.edu    (530) 754-4083


From jwiley.psych at gmail.com  Thu Dec 20 20:15:02 2012
From: jwiley.psych at gmail.com (Joshua Wiley)
Date: Thu, 20 Dec 2012 11:15:02 -0800
Subject: [R-sig-ME] glmm with correlated residuals
In-Reply-To: <EC6E1E38-6603-4D34-99C6-8265E93D1BEE@ucdavis.edu>
References: <EC6E1E38-6603-4D34-99C6-8265E93D1BEE@ucdavis.edu>
Message-ID: <CANz9Z_J5eqed7zjGZN5YeR7tDvSVm2e0ASbZt0X0oYkYQhFp2Q@mail.gmail.com>

Hi Emilio,

I would suggest doing it in MCMCglmm.  It can handle residual
structures too.  This is a nice starting guide:
http://cran.r-project.org/web/packages/MCMCglmm/vignettes/CourseNotes.pdf

Cheers,

Josh

On Thu, Dec 20, 2012 at 8:37 AM, Emilio A. Laca <ealaca at ucdavis.edu> wrote:
> Fellow R users,
>
> what package would you recommend for fitting a poisson glmm with one random effect and residuals that are correlated (most likely AR(1)) and have heterogeneity of variance?
>
> I have successfully fitted the model without addressing the structured residuals in MCMCglmm.
>
> I would appreciate it very much if you could point me in the direction of an example.
>
> Emilio A. Laca, Professor
> Department of Plant Sciences, MS 1
> University of California, Davis
> One Shields Ave.
> Davis, CA 95616
> ealaca at ucdavis.edu    (530) 754-4083
>
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models



-- 
Joshua Wiley
Ph.D. Student, Health Psychology
Programmer Analyst II, Statistical Consulting Group
University of California, Los Angeles
https://joshuawiley.com/


From jwiley.psych at gmail.com  Thu Dec 20 20:51:10 2012
From: jwiley.psych at gmail.com (Joshua Wiley)
Date: Thu, 20 Dec 2012 11:51:10 -0800
Subject: [R-sig-ME] glmm with correlated residuals
In-Reply-To: <663DDE2B-EC37-4C3D-8C1C-C5A2A3BD7CC6@ucdavis.edu>
References: <EC6E1E38-6603-4D34-99C6-8265E93D1BEE@ucdavis.edu>
	<CANz9Z_J5eqed7zjGZN5YeR7tDvSVm2e0ASbZt0X0oYkYQhFp2Q@mail.gmail.com>
	<663DDE2B-EC37-4C3D-8C1C-C5A2A3BD7CC6@ucdavis.edu>
Message-ID: <CANz9Z_JpuQ3Ws93ej18h4iZMJVj8z5Gwp7sp7aS-sfpZn+x2Kg@mail.gmail.com>

Hi Emilio,

Hmm, well correlated/heterogeneous residuals is relatively easy, but
the ar1 aspect turned out to be less straightforward than I thought.
I could not find an exact example (with a few quick searches), but you
can basically specify any matrix you want for the R matrix.

I have not given this much thought, but I think I would first try a
strong prior that the matrix would be ar1, but I do not know that I
would worry about enforcing that in the posterior.

Here is an example with spatial autocorrelation:
http://permalink.gmane.org/gmane.comp.lang.r.lme4.devel/8746
It will help to be facile with matrix algebra. In principle it should
be doable but may be rather tricky to specify exactly.

If you find a solution, would be great if you post back to the list
for future reference.

Cheers,

Josh

On Thu, Dec 20, 2012 at 11:39 AM, Emilio A. Laca <ealaca at ucdavis.edu> wrote:
> Josh,
> I appreciate your reply. Indeed the Course Notes by J. Hadfield are excellent.
>
> However, I have been unable to find an example to guide me in the construction/specification of the R matrix. I assume that the structure is declared in the code part that assigns the priors.  I can define an ar(1) matrix, but I am not sure how to incorporate the fact that there are repeated measurements over time in >30 subjects.
>
> Should R be a nxn matrix with (identical) non-zero blocks for each individual, or a single (n/30)x(n/30) matrix with some code to indicate that it is used for each individual?
> I have searched the March 2012 course notes (for a total of ~2 hours), but I may have missed the relevant part.
> Many thanks again,
>
> Emilio
>
>
> On Dec 20, 2012, at 11:15 AM, Joshua Wiley <jwiley.psych at gmail.com> wrote:
>
> Hi Emilio,
>
> I would suggest doing it in MCMCglmm.  It can handle residual
> structures too.  This is a nice starting guide:
> http://cran.r-project.org/web/packages/MCMCglmm/vignettes/CourseNotes.pdf
>
> Cheers,
>
> Josh
>
> On Thu, Dec 20, 2012 at 8:37 AM, Emilio A. Laca <ealaca at ucdavis.edu> wrote:
>> Fellow R users,
>>
>> what package would you recommend for fitting a poisson glmm with one random effect and residuals that are correlated (most likely AR(1)) and have heterogeneity of variance?
>>
>> I have successfully fitted the model without addressing the structured residuals in MCMCglmm.
>>
>> I would appreciate it very much if you could point me in the direction of an example.
>>
>> Emilio A. Laca, Professor
>> Department of Plant Sciences, MS 1
>> University of California, Davis
>> One Shields Ave.
>> Davis, CA 95616
>> ealaca at ucdavis.edu    (530) 754-4083
>>
>> _______________________________________________
>> R-sig-mixed-models at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>
>
>
> --
> Joshua Wiley
> Ph.D. Student, Health Psychology
> Programmer Analyst II, Statistical Consulting Group
> University of California, Los Angeles
> https://joshuawiley.com/
>



-- 
Joshua Wiley
Ph.D. Student, Health Psychology
Programmer Analyst II, Statistical Consulting Group
University of California, Los Angeles
https://joshuawiley.com/


From bbolker at gmail.com  Thu Dec 20 21:53:50 2012
From: bbolker at gmail.com (Ben Bolker)
Date: Thu, 20 Dec 2012 20:53:50 +0000 (UTC)
Subject: [R-sig-ME] glmm with correlated residuals
References: <EC6E1E38-6603-4D34-99C6-8265E93D1BEE@ucdavis.edu>
	<CANz9Z_J5eqed7zjGZN5YeR7tDvSVm2e0ASbZt0X0oYkYQhFp2Q@mail.gmail.com>
Message-ID: <loom.20121220T214242-75@post.gmane.org>

Joshua Wiley <jwiley.psych at ...> writes:

> 
> Hi Emilio,
> 
> I would suggest doing it in MCMCglmm.  It can handle residual
> structures too.  This is a nice starting guide:
> http://cran.r-project.org/web/packages/MCMCglmm/vignettes/CourseNotes.pdf
> 
> Cheers,
> 
> Josh

  Josh, are you sure?  I don't find "autoreg" anywhere in the course notes.
I don't personally know of an easy way to do this other than using INLA
(which I haven't tried much); glmmPQL (easy but perhaps dicey depending
on the circumstances, and sometimes hard to figure out whether it's
fitting a well-defined model); or hand-coding in WinBUGS/JAGS/Stan or
AD Model Builder ...  You could also give up on Poisson-ness (you said
there was heterogeneity of variance -- not quite sure what that means
in this context?) and fit a GLS model with appropriate variance
structure (using gls() with weights= and correlation= arguments set).

  I'd love to hear other answers.

  Ben


> 
> On Thu, Dec 20, 2012 at 8:37 AM, Emilio A. Laca <ealaca at ...> wrote:
> > Fellow R users,

> > what package would you recommend for fitting a poisson glmm with
    one random effect and residuals that are correlated (most likely
    AR(1)) and have heterogeneity of variance?  I have successfully
    fitted the model without addressing the structured residuals in
    MCMCglmm.  I would appreciate it very much if you could point me
    in the direction of an example.

> > Emilio A. Laca, Professor

 [snip]


From j.hadfield at ed.ac.uk  Thu Dec 20 23:02:23 2012
From: j.hadfield at ed.ac.uk (Jarrod Hadfield)
Date: Thu, 20 Dec 2012 22:02:23 +0000
Subject: [R-sig-ME] glmm with correlated residuals
In-Reply-To: <loom.20121220T214242-75@post.gmane.org>
References: <EC6E1E38-6603-4D34-99C6-8265E93D1BEE@ucdavis.edu>
	<CANz9Z_J5eqed7zjGZN5YeR7tDvSVm2e0ASbZt0X0oYkYQhFp2Q@mail.gmail.com>
	<loom.20121220T214242-75@post.gmane.org>
Message-ID: <20121220220223.16682a154dx8lxwk@www.staffmail.ed.ac.uk>

Hi Emilio,

asreml will fit such a model but the PQL method it uses for  
approximating the likelihood can give dodgy results in some cases. For  
Poisson data, particularly if it has high mean, it might be OK though.  
It is fast enough that you can check the degree of bias using  
simulation.

You can fit spatial simultaneous autoregressive lag models in MCMCglmm  
but only for Gaussian data. It would be very difficult for me to  
implement these for  non-Gaussian data.

AR(1) models with nugget effect could be fitted, but only if the  
correlation parameter is known. The inverse of the correlation matrix  
could then be passed to ginverse and the scale estimated, but this is  
not that much use I guess.


Cheers,

Jarrod





Quoting Ben Bolker <bbolker at gmail.com> on Thu, 20 Dec 2012 20:53:50  
+0000 (UTC):

> Joshua Wiley <jwiley.psych at ...> writes:
>
>>
>> Hi Emilio,
>>
>> I would suggest doing it in MCMCglmm.  It can handle residual
>> structures too.  This is a nice starting guide:
>> http://cran.r-project.org/web/packages/MCMCglmm/vignettes/CourseNotes.pdf
>>
>> Cheers,
>>
>> Josh
>
>   Josh, are you sure?  I don't find "autoreg" anywhere in the course notes.
> I don't personally know of an easy way to do this other than using INLA
> (which I haven't tried much); glmmPQL (easy but perhaps dicey depending
> on the circumstances, and sometimes hard to figure out whether it's
> fitting a well-defined model); or hand-coding in WinBUGS/JAGS/Stan or
> AD Model Builder ...  You could also give up on Poisson-ness (you said
> there was heterogeneity of variance -- not quite sure what that means
> in this context?) and fit a GLS model with appropriate variance
> structure (using gls() with weights= and correlation= arguments set).
>
>   I'd love to hear other answers.
>
>   Ben
>
>
>>
>> On Thu, Dec 20, 2012 at 8:37 AM, Emilio A. Laca <ealaca at ...> wrote:
>> > Fellow R users,
>
>> > what package would you recommend for fitting a poisson glmm with
>     one random effect and residuals that are correlated (most likely
>     AR(1)) and have heterogeneity of variance?  I have successfully
>     fitted the model without addressing the structured residuals in
>     MCMCglmm.  I would appreciate it very much if you could point me
>     in the direction of an example.
>
>> > Emilio A. Laca, Professor
>
>  [snip]
>
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>
>

-- 
The University of Edinburgh is a charitable body, registered in
Scotland, with registration number SC005336.


From j.hadfield at ed.ac.uk  Thu Dec 20 23:02:26 2012
From: j.hadfield at ed.ac.uk (Jarrod Hadfield)
Date: Thu, 20 Dec 2012 22:02:26 +0000
Subject: [R-sig-ME] glmm with correlated residuals
In-Reply-To: <loom.20121220T214242-75@post.gmane.org>
References: <EC6E1E38-6603-4D34-99C6-8265E93D1BEE@ucdavis.edu>
	<CANz9Z_J5eqed7zjGZN5YeR7tDvSVm2e0ASbZt0X0oYkYQhFp2Q@mail.gmail.com>
	<loom.20121220T214242-75@post.gmane.org>
Message-ID: <20121220220226.54587i60a2s3ya60@www.staffmail.ed.ac.uk>

Hi Emilio,

asreml will fit such a model but the PQL method it uses for  
approximating the likelihood can give dodgy results in some cases. For  
Poisson data, particularly if it has high mean, it might be OK though.  
It is fast enough that you can check the degree of bias using  
simulation.

You can fit spatial simultaneous autoregressive lag models in MCMCglmm  
but only for Gaussian data. It would be very difficult for me to  
implement these for  non-Gaussian data.

AR(1) models with nugget effect could be fitted, but only if the  
correlation parameter is known. The inverse of the correlation matrix  
could then be passed to ginverse and the scale estimated, but this is  
not that much use I guess.


Cheers,

Jarrod





Quoting Ben Bolker <bbolker at gmail.com> on Thu, 20 Dec 2012 20:53:50  
+0000 (UTC):

> Joshua Wiley <jwiley.psych at ...> writes:
>
>>
>> Hi Emilio,
>>
>> I would suggest doing it in MCMCglmm.  It can handle residual
>> structures too.  This is a nice starting guide:
>> http://cran.r-project.org/web/packages/MCMCglmm/vignettes/CourseNotes.pdf
>>
>> Cheers,
>>
>> Josh
>
>   Josh, are you sure?  I don't find "autoreg" anywhere in the course notes.
> I don't personally know of an easy way to do this other than using INLA
> (which I haven't tried much); glmmPQL (easy but perhaps dicey depending
> on the circumstances, and sometimes hard to figure out whether it's
> fitting a well-defined model); or hand-coding in WinBUGS/JAGS/Stan or
> AD Model Builder ...  You could also give up on Poisson-ness (you said
> there was heterogeneity of variance -- not quite sure what that means
> in this context?) and fit a GLS model with appropriate variance
> structure (using gls() with weights= and correlation= arguments set).
>
>   I'd love to hear other answers.
>
>   Ben
>
>
>>
>> On Thu, Dec 20, 2012 at 8:37 AM, Emilio A. Laca <ealaca at ...> wrote:
>> > Fellow R users,
>
>> > what package would you recommend for fitting a poisson glmm with
>     one random effect and residuals that are correlated (most likely
>     AR(1)) and have heterogeneity of variance?  I have successfully
>     fitted the model without addressing the structured residuals in
>     MCMCglmm.  I would appreciate it very much if you could point me
>     in the direction of an example.
>
>> > Emilio A. Laca, Professor
>
>  [snip]
>
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>
>

-- 
The University of Edinburgh is a charitable body, registered in
Scotland, with registration number SC005336.


From raptorbio at hotmail.com  Fri Dec 21 01:59:07 2012
From: raptorbio at hotmail.com (Adam Smith)
Date: Thu, 20 Dec 2012 19:59:07 -0500
Subject: [R-sig-ME] glmm with correlated residuals
In-Reply-To: <20121220220223.16682a154dx8lxwk@www.staffmail.ed.ac.uk>
References: <EC6E1E38-6603-4D34-99C6-8265E93D1BEE@ucdavis.edu>,
	<CANz9Z_J5eqed7zjGZN5YeR7tDvSVm2e0ASbZt0X0oYkYQhFp2Q@mail.gmail.com>,
	<loom.20121220T214242-75@post.gmane.org>,
	<20121220220223.16682a154dx8lxwk@www.staffmail.ed.ac.uk>
Message-ID: <BAY170-W511BBA494ED80BD48129D3A1360@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121220/3586ab47/attachment.pl>

From jwiley.psych at gmail.com  Fri Dec 21 09:00:16 2012
From: jwiley.psych at gmail.com (Joshua Wiley)
Date: Fri, 21 Dec 2012 00:00:16 -0800
Subject: [R-sig-ME] glmm with correlated residuals
In-Reply-To: <loom.20121220T214242-75@post.gmane.org>
References: <EC6E1E38-6603-4D34-99C6-8265E93D1BEE@ucdavis.edu>
	<CANz9Z_J5eqed7zjGZN5YeR7tDvSVm2e0ASbZt0X0oYkYQhFp2Q@mail.gmail.com>
	<loom.20121220T214242-75@post.gmane.org>
Message-ID: <CANz9Z_JZD7q8UcoTH+axtr735ekFLVJYse_ik0LmbRmir1rf4Q@mail.gmail.com>

Ben,

No I was way off on this one (as in my previous reply to the OP).  I
was thinking general residual structures (not AR in particular) and I
missed the Poisson part so I thought SIR for spatial autocorrelation
could be generalized.

Best,

Josh

On Thu, Dec 20, 2012 at 12:53 PM, Ben Bolker <bbolker at gmail.com> wrote:
> Joshua Wiley <jwiley.psych at ...> writes:
>
>>
>> Hi Emilio,
>>
>> I would suggest doing it in MCMCglmm.  It can handle residual
>> structures too.  This is a nice starting guide:
>> http://cran.r-project.org/web/packages/MCMCglmm/vignettes/CourseNotes.pdf
>>
>> Cheers,
>>
>> Josh
>
>   Josh, are you sure?  I don't find "autoreg" anywhere in the course notes.
> I don't personally know of an easy way to do this other than using INLA
> (which I haven't tried much); glmmPQL (easy but perhaps dicey depending
> on the circumstances, and sometimes hard to figure out whether it's
> fitting a well-defined model); or hand-coding in WinBUGS/JAGS/Stan or
> AD Model Builder ...  You could also give up on Poisson-ness (you said
> there was heterogeneity of variance -- not quite sure what that means
> in this context?) and fit a GLS model with appropriate variance
> structure (using gls() with weights= and correlation= arguments set).
>
>   I'd love to hear other answers.
>
>   Ben
>
>
>>
>> On Thu, Dec 20, 2012 at 8:37 AM, Emilio A. Laca <ealaca at ...> wrote:
>> > Fellow R users,
>
>> > what package would you recommend for fitting a poisson glmm with
>     one random effect and residuals that are correlated (most likely
>     AR(1)) and have heterogeneity of variance?  I have successfully
>     fitted the model without addressing the structured residuals in
>     MCMCglmm.  I would appreciate it very much if you could point me
>     in the direction of an example.
>
>> > Emilio A. Laca, Professor
>
>  [snip]
>
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models



-- 
Joshua Wiley
Ph.D. Student, Health Psychology
Programmer Analyst II, Statistical Consulting Group
University of California, Los Angeles
https://joshuawiley.com/


From bates at stat.wisc.edu  Fri Dec 21 20:31:05 2012
From: bates at stat.wisc.edu (Douglas Bates)
Date: Fri, 21 Dec 2012 13:31:05 -0600
Subject: [R-sig-ME] glmm with correlated residuals
In-Reply-To: <BAY170-W511BBA494ED80BD48129D3A1360@phx.gbl>
References: <EC6E1E38-6603-4D34-99C6-8265E93D1BEE@ucdavis.edu>
	<CANz9Z_J5eqed7zjGZN5YeR7tDvSVm2e0ASbZt0X0oYkYQhFp2Q@mail.gmail.com>
	<loom.20121220T214242-75@post.gmane.org>
	<20121220220223.16682a154dx8lxwk@www.staffmail.ed.ac.uk>
	<BAY170-W511BBA494ED80BD48129D3A1360@phx.gbl>
Message-ID: <CAO7JsnSjDSEcnTt_B7dDUVUgLR5rV529XOcvmhOZprbVM+CSXg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121221/c9307847/attachment.pl>

From bbolker at gmail.com  Fri Dec 21 21:05:58 2012
From: bbolker at gmail.com (Ben Bolker)
Date: Fri, 21 Dec 2012 15:05:58 -0500
Subject: [R-sig-ME] glmm with correlated residuals
In-Reply-To: <CAO7JsnSjDSEcnTt_B7dDUVUgLR5rV529XOcvmhOZprbVM+CSXg@mail.gmail.com>
References: <EC6E1E38-6603-4D34-99C6-8265E93D1BEE@ucdavis.edu>
	<CANz9Z_J5eqed7zjGZN5YeR7tDvSVm2e0ASbZt0X0oYkYQhFp2Q@mail.gmail.com>
	<loom.20121220T214242-75@post.gmane.org>
	<20121220220223.16682a154dx8lxwk@www.staffmail.ed.ac.uk>
	<BAY170-W511BBA494ED80BD48129D3A1360@phx.gbl>
	<CAO7JsnSjDSEcnTt_B7dDUVUgLR5rV529XOcvmhOZprbVM+CSXg@mail.gmail.com>
Message-ID: <50D4C126.9060704@gmail.com>

  The model I had in mind was hierarchical:

  Y_i ~ Poisson(lambda_i)
  lambda_i = exp(eta_i)
  eta ~ MVN(mu=X beta, Sigma=sigma^2*C(rho))

where C(rho) is [for example] the correlation matrix corresponding to an
AR1 model with correlation rho. So the variance-covariance structure of
Y is *not* AR1 (but presumably there's some reasonable one-to-one
relationship between the variance-covariance structures of eta and of Y
-- I'm guessing that the correlation is just diluted by the additional
Poisson variance; this might be reasonable to approach with a GEE for
the marginal variance-covariance structure).  It also captures (I think)
the *biological* goal, which is to characterize count data where there
is evidently serial autocorrelation [which may be of primary interest,
or a statistical nuisance to be accounted for].

  I think that's perfectly well-defined and sensible, and
straightforward to estimate with Bayesian or frequentist hierarchical
modeling tools, although I'm happy to be corrected ...

  I completely agree that it's not clear what glmmPQL and friends are
actually doing when one specifies a model like

glmmPQL(y~x,random=...,correlation=corAR1())  ;

I wish someone (not me!) would sit down and figure it out. Dormann et al
2007 suggest on the basis of simulation studies that one can use glmmPQL
in this way, but I don't recall that they offer much of a theoretical
justification of what model is *actually* being fitted ...

Dormann, Carsten F. et al. 2007. ?Methods to Account for Spatial
Autocorrelation in the Analysis of Species Distributional Data: a
Review.? Ecography 30 (5): 609?628.
doi:10.1111/j.2007.0906-7590.05171.x.
http://dx.doi.org/10.1111/j.2007.0906-7590.05171.x.

 Ben B.

On 12-12-21 02:31 PM, Douglas Bates wrote:
> <rant>
> I realize I am coming in late to the discussion and I may end up
> sounding like a grumpy old man spoiling everyone's fun, but I don't
> think there is a model with the properties being discussed.  For a model
> in which the conditional distribution of the response given the random
> effects is Gaussian (i.e. a linear mixed-effects model or certain types
> of nonlinear mixed-effects models as described in Pinheiro and Bates,
> 2000) it is possible to modify the variance-covariance structure
> separately from the conditional mean.  Doing so will also carry over to
> the marginal distribution of the response.  But this property is not
> general - it is quite specifically a property of the Gaussian (or
> "normal") distribution.
> 
> So, to me, there is no point in discussing whether the parameters in
> this model should be estimated by quasi-likelihood (i.e. something that
> sort-of, kind-of looks like a likelihood) or by defining a series of
> conditional distributions for an MCMC iterative scheme or ...  This may
> sound priggish or the argument of an abstracted theoretician with no
> connection to actual data analysis but, if you want to define maximum
> likelihood estimators or whatever criterion you want to use, you must
> first have a likelihood and to get a likelihood you need a probability
> model.  And, to the best of my knowledge, there is not probability model
> with these properties. 
> 
> When you don't have a probability model you have moved from statistical
> analysis to "data mining" algorithms, which is okay but you should be
> explicit about that and not couch is as if it were a generalized linear
> mixed model.  All you have is an algorithm - you put numbers in and you
> get numbers out and if you like the numbers you get out then more power
> to you
> 
> To me this is one of the big pitfalls of generalized linear mixed models
> - there is an assumption that they generalize all the properties of
> linear mixed models but they don't.  There are properties of the
> Gaussian distribution that do not generalize and for years people have
> concentrated on the details of how to fit or approximately fit models
> that don't exist.  Concentrating on the low-level details of the
> mechanism without considering whether such a model could even exist is
> bound to lead you into trouble.
> </rant>
> 
> 
> 
> 
> On Thu, Dec 20, 2012 at 6:59 PM, Adam Smith <raptorbio at hotmail.com
> <mailto:raptorbio at hotmail.com>> wrote:
> 
> 
>     I believe the gamm function in mgcv can also fit this model.  IIRC,
>     the function also permits use of the negative binomial distribution
>     (but you have to provide theta)...
>     It also uses PQL, so the same concerns apply.
>     Regards,
>     Adam
> 
>     > Date: Thu, 20 Dec 2012 22:02:23 +0000
>     > From: j.hadfield at ed.ac.uk <mailto:j.hadfield at ed.ac.uk>
>     > To: bbolker at gmail.com <mailto:bbolker at gmail.com>
>     > CC: r-sig-mixed-models at r-project.org
>     <mailto:r-sig-mixed-models at r-project.org>
>     > Subject: Re: [R-sig-ME] glmm with correlated residuals
>     >
>     > Hi Emilio,
>     >
>     > asreml will fit such a model but the PQL method it uses for
>     > approximating the likelihood can give dodgy results in some cases. For
>     > Poisson data, particularly if it has high mean, it might be OK though.
>     > It is fast enough that you can check the degree of bias using
>     > simulation.
>     >
>     > You can fit spatial simultaneous autoregressive lag models in MCMCglmm
>     > but only for Gaussian data. It would be very difficult for me to
>     > implement these for  non-Gaussian data.
>     >
>     > AR(1) models with nugget effect could be fitted, but only if the
>     > correlation parameter is known. The inverse of the correlation matrix
>     > could then be passed to ginverse and the scale estimated, but this is
>     > not that much use I guess.
>     >
>     >
>     > Cheers,
>     >
>     > Jarrod
>     >
>     >
>     >
>     >
>     >
>     > Quoting Ben Bolker <bbolker at gmail.com <mailto:bbolker at gmail.com>>
>     on Thu, 20 Dec 2012 20:53:50
>     > +0000 (UTC):
>     >
>     > > Joshua Wiley <jwiley.psych at ...> writes:
>     > >
>     > >>
>     > >> Hi Emilio,
>     > >>
>     > >> I would suggest doing it in MCMCglmm.  It can handle residual
>     > >> structures too.  This is a nice starting guide:
>     > >>
>     http://cran.r-project.org/web/packages/MCMCglmm/vignettes/CourseNotes.pdf
>     > >>
>     > >> Cheers,
>     > >>
>     > >> Josh
>     > >
>     > >   Josh, are you sure?  I don't find "autoreg" anywhere in the
>     course notes.
>     > > I don't personally know of an easy way to do this other than
>     using INLA
>     > > (which I haven't tried much); glmmPQL (easy but perhaps dicey
>     depending
>     > > on the circumstances, and sometimes hard to figure out whether it's
>     > > fitting a well-defined model); or hand-coding in
>     WinBUGS/JAGS/Stan or
>     > > AD Model Builder ...  You could also give up on Poisson-ness
>     (you said
>     > > there was heterogeneity of variance -- not quite sure what that
>     means
>     > > in this context?) and fit a GLS model with appropriate variance
>     > > structure (using gls() with weights= and correlation= arguments
>     set).
>     > >
>     > >   I'd love to hear other answers.
>     > >
>     > >   Ben
>     > >
>     > >
>     > >>
>     > >> On Thu, Dec 20, 2012 at 8:37 AM, Emilio A. Laca <ealaca at ...> wrote:
>     > >> > Fellow R users,
>     > >
>     > >> > what package would you recommend for fitting a poisson glmm with
>     > >     one random effect and residuals that are correlated (most likely
>     > >     AR(1)) and have heterogeneity of variance?  I have successfully
>     > >     fitted the model without addressing the structured residuals in
>     > >     MCMCglmm.  I would appreciate it very much if you could point me
>     > >     in the direction of an example.
>     > >
>     > >> > Emilio A. Laca, Professor
>     > >
>     > >  [snip]
>     > >
>     > > _______________________________________________
>     > > R-sig-mixed-models at r-project.org
>     <mailto:R-sig-mixed-models at r-project.org> mailing list
>     > > https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>     > >
>     > >
>     >
>     > --
>     > The University of Edinburgh is a charitable body, registered in
>     > Scotland, with registration number SC005336.
>     >
>     > _______________________________________________
>     > R-sig-mixed-models at r-project.org
>     <mailto:R-sig-mixed-models at r-project.org> mailing list
>     > https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> 
>             [[alternative HTML version deleted]]
> 
>     _______________________________________________
>     R-sig-mixed-models at r-project.org
>     <mailto:R-sig-mixed-models at r-project.org> mailing list
>     https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> 
>


From bates at stat.wisc.edu  Fri Dec 21 21:57:56 2012
From: bates at stat.wisc.edu (Douglas Bates)
Date: Fri, 21 Dec 2012 14:57:56 -0600
Subject: [R-sig-ME] glmm with correlated residuals
In-Reply-To: <50D4C126.9060704@gmail.com>
References: <EC6E1E38-6603-4D34-99C6-8265E93D1BEE@ucdavis.edu>
	<CANz9Z_J5eqed7zjGZN5YeR7tDvSVm2e0ASbZt0X0oYkYQhFp2Q@mail.gmail.com>
	<loom.20121220T214242-75@post.gmane.org>
	<20121220220223.16682a154dx8lxwk@www.staffmail.ed.ac.uk>
	<BAY170-W511BBA494ED80BD48129D3A1360@phx.gbl>
	<CAO7JsnSjDSEcnTt_B7dDUVUgLR5rV529XOcvmhOZprbVM+CSXg@mail.gmail.com>
	<50D4C126.9060704@gmail.com>
Message-ID: <CAO7JsnT6_7xF0cDOJqL4s5m6eRGkKqfPef6BjRFvOWL8AY9xeA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121221/226ce4cd/attachment.pl>

From j.hadfield at ed.ac.uk  Sat Dec 22 11:03:06 2012
From: j.hadfield at ed.ac.uk (Jarrod Hadfield)
Date: Sat, 22 Dec 2012 10:03:06 +0000
Subject: [R-sig-ME] glmm with correlated residuals
In-Reply-To: <50D4C126.9060704@gmail.com>
References: <EC6E1E38-6603-4D34-99C6-8265E93D1BEE@ucdavis.edu>
	<CANz9Z_J5eqed7zjGZN5YeR7tDvSVm2e0ASbZt0X0oYkYQhFp2Q@mail.gmail.com>
	<loom.20121220T214242-75@post.gmane.org>
	<20121220220223.16682a154dx8lxwk@www.staffmail.ed.ac.uk>
	<BAY170-W511BBA494ED80BD48129D3A1360@phx.gbl>
	<CAO7JsnSjDSEcnTt_B7dDUVUgLR5rV529XOcvmhOZprbVM+CSXg@mail.gmail.com>
	<50D4C126.9060704@gmail.com>
Message-ID: <20121222100306.34804h52q5zkgvsw@www.staffmail.ed.ac.uk>

Hi,

At least for asreml it is possible to fit the AR(1) process in the  
G-structure and hence fit the model described, but I agree that it is  
not clear what a glmmPQL model is fitting. asreml seems to  
underestimate sigma when rho is small, which is to be anticipated, but  
rho seems to be well estimated.

rAR1<-function(n,rho, sigma){

  # function for simulating from an AR1 process (think this works!)

L<-Diagonal(n)-bandSparse(n,n,-1,list(rep(rho,n-1)))
y<-rnorm(n, 0, sqrt(1-rho^2))

solve(L,y)@x*sigma

}

eta<-rAR1(1000,rho=0.5,sigma=1)
y<-rpois(1000, exp(eta))

m1<-asreml(y~1, random=~ar1v(units), family=asreml.poisson())

summary(m1)$varcomp
                     gamma component  std.error  z.ratio    constraint
units!units.cor 0.4854854 0.4854854 0.04923992  9.85959 Unconstrained
units!units.var 0.8077873 0.8077873 0.07291496 11.07849      Positive
R!variance      1.0000000 1.0000000         NA       NA         Fixed


Cheers,

Jarrod


Quoting Ben Bolker <bbolker at gmail.com> on Fri, 21 Dec 2012 15:05:58 -0500:

>   The model I had in mind was hierarchical:
>
>   Y_i ~ Poisson(lambda_i)
>   lambda_i = exp(eta_i)
>   eta ~ MVN(mu=X beta, Sigma=sigma^2*C(rho))
>
> where C(rho) is [for example] the correlation matrix corresponding to an
> AR1 model with correlation rho. So the variance-covariance structure of
> Y is *not* AR1 (but presumably there's some reasonable one-to-one
> relationship between the variance-covariance structures of eta and of Y
> -- I'm guessing that the correlation is just diluted by the additional
> Poisson variance; this might be reasonable to approach with a GEE for
> the marginal variance-covariance structure).  It also captures (I think)
> the *biological* goal, which is to characterize count data where there
> is evidently serial autocorrelation [which may be of primary interest,
> or a statistical nuisance to be accounted for].
>
>   I think that's perfectly well-defined and sensible, and
> straightforward to estimate with Bayesian or frequentist hierarchical
> modeling tools, although I'm happy to be corrected ...
>
>   I completely agree that it's not clear what glmmPQL and friends are
> actually doing when one specifies a model like
>
> glmmPQL(y~x,random=...,correlation=corAR1())  ;
>
> I wish someone (not me!) would sit down and figure it out. Dormann et al
> 2007 suggest on the basis of simulation studies that one can use glmmPQL
> in this way, but I don't recall that they offer much of a theoretical
> justification of what model is *actually* being fitted ...
>
> Dormann, Carsten F. et al. 2007. ?Methods to Account for Spatial
> Autocorrelation in the Analysis of Species Distributional Data: a
> Review.? Ecography 30 (5): 609?628.
> doi:10.1111/j.2007.0906-7590.05171.x.
> http://dx.doi.org/10.1111/j.2007.0906-7590.05171.x.
>
>  Ben B.
>
> On 12-12-21 02:31 PM, Douglas Bates wrote:
>> <rant>
>> I realize I am coming in late to the discussion and I may end up
>> sounding like a grumpy old man spoiling everyone's fun, but I don't
>> think there is a model with the properties being discussed.  For a model
>> in which the conditional distribution of the response given the random
>> effects is Gaussian (i.e. a linear mixed-effects model or certain types
>> of nonlinear mixed-effects models as described in Pinheiro and Bates,
>> 2000) it is possible to modify the variance-covariance structure
>> separately from the conditional mean.  Doing so will also carry over to
>> the marginal distribution of the response.  But this property is not
>> general - it is quite specifically a property of the Gaussian (or
>> "normal") distribution.
>>
>> So, to me, there is no point in discussing whether the parameters in
>> this model should be estimated by quasi-likelihood (i.e. something that
>> sort-of, kind-of looks like a likelihood) or by defining a series of
>> conditional distributions for an MCMC iterative scheme or ...  This may
>> sound priggish or the argument of an abstracted theoretician with no
>> connection to actual data analysis but, if you want to define maximum
>> likelihood estimators or whatever criterion you want to use, you must
>> first have a likelihood and to get a likelihood you need a probability
>> model.  And, to the best of my knowledge, there is not probability model
>> with these properties.
>>
>> When you don't have a probability model you have moved from statistical
>> analysis to "data mining" algorithms, which is okay but you should be
>> explicit about that and not couch is as if it were a generalized linear
>> mixed model.  All you have is an algorithm - you put numbers in and you
>> get numbers out and if you like the numbers you get out then more power
>> to you
>>
>> To me this is one of the big pitfalls of generalized linear mixed models
>> - there is an assumption that they generalize all the properties of
>> linear mixed models but they don't.  There are properties of the
>> Gaussian distribution that do not generalize and for years people have
>> concentrated on the details of how to fit or approximately fit models
>> that don't exist.  Concentrating on the low-level details of the
>> mechanism without considering whether such a model could even exist is
>> bound to lead you into trouble.
>> </rant>
>>
>>
>>
>>
>> On Thu, Dec 20, 2012 at 6:59 PM, Adam Smith <raptorbio at hotmail.com
>> <mailto:raptorbio at hotmail.com>> wrote:
>>
>>
>>     I believe the gamm function in mgcv can also fit this model.  IIRC,
>>     the function also permits use of the negative binomial distribution
>>     (but you have to provide theta)...
>>     It also uses PQL, so the same concerns apply.
>>     Regards,
>>     Adam
>>
>>     > Date: Thu, 20 Dec 2012 22:02:23 +0000
>>     > From: j.hadfield at ed.ac.uk <mailto:j.hadfield at ed.ac.uk>
>>     > To: bbolker at gmail.com <mailto:bbolker at gmail.com>
>>     > CC: r-sig-mixed-models at r-project.org
>>     <mailto:r-sig-mixed-models at r-project.org>
>>     > Subject: Re: [R-sig-ME] glmm with correlated residuals
>>     >
>>     > Hi Emilio,
>>     >
>>     > asreml will fit such a model but the PQL method it uses for
>>     > approximating the likelihood can give dodgy results in some cases. For
>>     > Poisson data, particularly if it has high mean, it might be OK though.
>>     > It is fast enough that you can check the degree of bias using
>>     > simulation.
>>     >
>>     > You can fit spatial simultaneous autoregressive lag models in MCMCglmm
>>     > but only for Gaussian data. It would be very difficult for me to
>>     > implement these for  non-Gaussian data.
>>     >
>>     > AR(1) models with nugget effect could be fitted, but only if the
>>     > correlation parameter is known. The inverse of the correlation matrix
>>     > could then be passed to ginverse and the scale estimated, but this is
>>     > not that much use I guess.
>>     >
>>     >
>>     > Cheers,
>>     >
>>     > Jarrod
>>     >
>>     >
>>     >
>>     >
>>     >
>>     > Quoting Ben Bolker <bbolker at gmail.com <mailto:bbolker at gmail.com>>
>>     on Thu, 20 Dec 2012 20:53:50
>>     > +0000 (UTC):
>>     >
>>     > > Joshua Wiley <jwiley.psych at ...> writes:
>>     > >
>>     > >>
>>     > >> Hi Emilio,
>>     > >>
>>     > >> I would suggest doing it in MCMCglmm.  It can handle residual
>>     > >> structures too.  This is a nice starting guide:
>>     > >>
>>      
>> http://cran.r-project.org/web/packages/MCMCglmm/vignettes/CourseNotes.pdf
>>     > >>
>>     > >> Cheers,
>>     > >>
>>     > >> Josh
>>     > >
>>     > >   Josh, are you sure?  I don't find "autoreg" anywhere in the
>>     course notes.
>>     > > I don't personally know of an easy way to do this other than
>>     using INLA
>>     > > (which I haven't tried much); glmmPQL (easy but perhaps dicey
>>     depending
>>     > > on the circumstances, and sometimes hard to figure out whether it's
>>     > > fitting a well-defined model); or hand-coding in
>>     WinBUGS/JAGS/Stan or
>>     > > AD Model Builder ...  You could also give up on Poisson-ness
>>     (you said
>>     > > there was heterogeneity of variance -- not quite sure what that
>>     means
>>     > > in this context?) and fit a GLS model with appropriate variance
>>     > > structure (using gls() with weights= and correlation= arguments
>>     set).
>>     > >
>>     > >   I'd love to hear other answers.
>>     > >
>>     > >   Ben
>>     > >
>>     > >
>>     > >>
>>     > >> On Thu, Dec 20, 2012 at 8:37 AM, Emilio A. Laca <ealaca at ...> wrote:
>>     > >> > Fellow R users,
>>     > >
>>     > >> > what package would you recommend for fitting a poisson glmm with
>>     > >     one random effect and residuals that are correlated (most likely
>>     > >     AR(1)) and have heterogeneity of variance?  I have successfully
>>     > >     fitted the model without addressing the structured residuals in
>>     > >     MCMCglmm.  I would appreciate it very much if you could point me
>>     > >     in the direction of an example.
>>     > >
>>     > >> > Emilio A. Laca, Professor
>>     > >
>>     > >  [snip]
>>     > >
>>     > > _______________________________________________
>>     > > R-sig-mixed-models at r-project.org
>>     <mailto:R-sig-mixed-models at r-project.org> mailing list
>>     > > https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>     > >
>>     > >
>>     >
>>     > --
>>     > The University of Edinburgh is a charitable body, registered in
>>     > Scotland, with registration number SC005336.
>>     >
>>     > _______________________________________________
>>     > R-sig-mixed-models at r-project.org
>>     <mailto:R-sig-mixed-models at r-project.org> mailing list
>>     > https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>
>>             [[alternative HTML version deleted]]
>>
>>     _______________________________________________
>>     R-sig-mixed-models at r-project.org
>>     <mailto:R-sig-mixed-models at r-project.org> mailing list
>>     https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>>
>>
>
>
>



-- 
The University of Edinburgh is a charitable body, registered in
Scotland, with registration number SC005336.


From mcasals at aspb.cat  Sat Dec 22 21:21:48 2012
From: mcasals at aspb.cat (=?ISO-8859-1?Q?Mart=ED_Casals?=)
Date: Sat, 22 Dec 2012 21:21:48 +0100
Subject: [R-sig-ME] number of cases required to satisfy the assumptions of
	mixed models
Message-ID: <CADtmEn6hhVub7jUNU1-0n0V7wqBW3ieb74GXSqPv+14oKcHo_A@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121222/d5473eed/attachment.pl>

From mikewlcheung at gmail.com  Wed Dec 26 05:00:41 2012
From: mikewlcheung at gmail.com (Mike Cheung)
Date: Wed, 26 Dec 2012 12:00:41 +0800
Subject: [R-sig-ME] Mixed-Effects Models with Group or
	Covariate-Dependent Autocorrelation
In-Reply-To: <077E31A57DA26E46AB0D493C9966AC730D5FFED3B2@UM-MAIL4112.unimaas.nl>
References: <077E31A57DA26E46AB0D493C9966AC730D5FFED3B2@UM-MAIL4112.unimaas.nl>
Message-ID: <CADF7-FMaZo9KjfK2f5k-zd1tNOtVC8y3_ss+OaamKuNejAwMzA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121226/74e80274/attachment.pl>

From bbolker at gmail.com  Wed Dec 26 05:29:56 2012
From: bbolker at gmail.com (Ben Bolker)
Date: Wed, 26 Dec 2012 04:29:56 +0000 (UTC)
Subject: [R-sig-ME]
	=?utf-8?q?number_of_cases_required_to_satisfy_the_assu?=
	=?utf-8?q?mptions_of=09mixed_models?=
References: <CADtmEn6hhVub7jUNU1-0n0V7wqBW3ieb74GXSqPv+14oKcHo_A@mail.gmail.com>
Message-ID: <loom.20121226T052907-408@post.gmane.org>

Mart? Casals <mcasals at ...> writes:

> 
> Hello,
> 
> I have a question. I worked with a study about performance on basketball.
> 
> The final data employed for the analysis were composed of 2187 cases (27
> players * 81 games), having followed a filtering process. I dealt with a
> balanced study design with repeated measurements given that each player was
> observed the same number of games, and therefore the player was considered
> as a random effect. We carried out two mixed models, a Linear Mixed Model
> (LMM) through the nlme library (Pinheiro) and a Poisson mixed model with
> lme4 package (Bates) .
> 
> *The reviewer  has one query about the number of cases required to satisfy
> the assumptions of the modelling technique.*
>

  I tried an example:

http://rpubs.com/bbolker/3324 

 You might want to redo this with input parameters that are more
realistic for your specific situation ...


From bates at stat.wisc.edu  Wed Dec 26 21:13:26 2012
From: bates at stat.wisc.edu (Douglas Bates)
Date: Wed, 26 Dec 2012 14:13:26 -0600
Subject: [R-sig-ME] number of cases required to satisfy the assumptions
 of mixed models
In-Reply-To: <loom.20121226T052907-408@post.gmane.org>
References: <CADtmEn6hhVub7jUNU1-0n0V7wqBW3ieb74GXSqPv+14oKcHo_A@mail.gmail.com>
	<loom.20121226T052907-408@post.gmane.org>
Message-ID: <CAO7JsnQm=2N0X_ppU+tcX16NeZ8BBQWmayHr9okexcgvbsy6+Q@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121226/332d500c/attachment.pl>

From bates at stat.wisc.edu  Wed Dec 26 21:18:26 2012
From: bates at stat.wisc.edu (Douglas Bates)
Date: Wed, 26 Dec 2012 14:18:26 -0600
Subject: [R-sig-ME] Mixed-Effects Models with Group or
	Covariate-Dependent Autocorrelation
In-Reply-To: <077E31A57DA26E46AB0D493C9966AC730D5FFED3B2@UM-MAIL4112.unimaas.nl>
References: <077E31A57DA26E46AB0D493C9966AC730D5FFED3B2@UM-MAIL4112.unimaas.nl>
Message-ID: <CAO7JsnR6XTXx+M2seNbrxiUezaDU_Ct8NvroeJEK6e1_chmEBg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121226/429011d2/attachment.pl>

From mcasals at aspb.cat  Thu Dec 27 08:34:04 2012
From: mcasals at aspb.cat (=?ISO-8859-1?Q?Mart=ED_Casals?=)
Date: Thu, 27 Dec 2012 08:34:04 +0100
Subject: [R-sig-ME] number of cases required to satisfy the assumptions
 of mixed models
In-Reply-To: <CAO7JsnQm=2N0X_ppU+tcX16NeZ8BBQWmayHr9okexcgvbsy6+Q@mail.gmail.com>
References: <CADtmEn6hhVub7jUNU1-0n0V7wqBW3ieb74GXSqPv+14oKcHo_A@mail.gmail.com>
	<loom.20121226T052907-408@post.gmane.org>
	<CAO7JsnQm=2N0X_ppU+tcX16NeZ8BBQWmayHr9okexcgvbsy6+Q@mail.gmail.com>
Message-ID: <CADtmEn5mKsUQTkNxhyFMXJ-o_DrhmQTtOv5j5PO8s8G-icw8=w@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121227/483de37e/attachment.pl>

From bburan at galenea.com  Thu Dec 27 15:05:47 2012
From: bburan at galenea.com (Brad Buran)
Date: Thu, 27 Dec 2012 14:05:47 +0000
Subject: [R-sig-ME] linear mixed model with non-monotonic longitudinal data
Message-ID: <3A447989F1B70245B88AF76E028FF8604D50E8@DAGN01A-E6.exg6.exghost.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121227/1d80555d/attachment.pl>

From bbolker at gmail.com  Thu Dec 27 16:49:59 2012
From: bbolker at gmail.com (Ben Bolker)
Date: Thu, 27 Dec 2012 15:49:59 +0000 (UTC)
Subject: [R-sig-ME] linear mixed model with non-monotonic longitudinal
	data
References: <3A447989F1B70245B88AF76E028FF8604D50E8@DAGN01A-E6.exg6.exghost.com>
Message-ID: <loom.20121227T164438-739@post.gmane.org>

Brad Buran <bburan at ...> writes:

>  I'm attempting to fit a linear mixed model to my dataset.  This
> data is the measure of stimulus-evoked power as a function of time.
> We have 32 subjects from two populations (broken down by genotype).
> The stimulus-evoked power is sampled at a high rate (one data-point
> every 5 msec) and reflects the "longitudinal" or "within-subjects"
> measure in my study.
 
> Right now I've defined the model as:
> 
> power ~ genotype * time + (1|subject_id)
> 
> I understand that one must also test additional models such as:
> 
> power ~ genotype * time + (time|subject_id)
> power ~ genotype * time + (1|subject_id) + (0+time|subject_id)
 
> However, power is not a linear function of time (i.e. it is
> non-monotonic).  Power rapidly increases over a few hundred
> milliseconds to a peak value then gradually declines afterwards.  In
> this situation, would it be inappropriate to use time for
> determining a slope for the random effect?
 
> I'm actually not even sure whether a linear mixed model is
> appropriate for this type of data (considering the power response is
> non-monotonic with respect to time).  However, this is how the
> original analysis was set up by a predecessor and I am currently
> trying to determine the validity of this approach.  Thanks, Brad

  Hard to answer completely in general.  The simplest approach
would probably be to make the response a quadratic function of
time; there are a few slightly complicating issues (whether to
use a boneheaded approach such as (genotype * (time + I(time^2))) or
to use poly(time,2) , which constructs orthogonal polynomials
by default, and how to get the time*subject interactions specified
correctly), but it's pretty easy and if it looks like it fits
your data well I might be satisfied with it.
  You could also fit generalized additive mixed
models (see the mgcv and gamm4 packages), again I'm not 100%
sure how to incorporate the time*subject interactions.  
  
  The bottom line is that linear models are actually pretty
flexible for modeling continuous, not necessarily linear,
responses (the assumption is that the model is a linear function
of the parameters, not necessarily that (e.g.) power is
a linear function of time).
  
  Ben Bolker


From bburan at galenea.com  Thu Dec 27 23:31:55 2012
From: bburan at galenea.com (Brad Buran)
Date: Thu, 27 Dec 2012 22:31:55 +0000
Subject: [R-sig-ME] linear mixed model with non-monotonic longitudinal
 data
Message-ID: <3A447989F1B70245B88AF76E028FF8604D541A@DAGN01A-E6.exg6.exghost.com>

That was very helpful.  It didn't occur to me that it was possible to use functions such as poly in the equation.  That said, it seems that none of the models (i.e. the ones I mentioned nor the ones you suggested) seem to be a good fit for the data based on the residuals.  Since the original model was defined in SPSS (using the genlinmixed function), I want to try to determine the actual model that SPSS uses (they make you step through a GUI to define your model rather than defining an equation like R does).  I haven't been able to find any documentation on how the inputs to the genlinmixed command are transformed into a model that I could try to create in R (so I can check it's validity).

Is anyone aware of how SPSS model GENLINMIXED with SUBJECTS=subject_id, REPEATED_MEASURES=time, FIXED_EFFECTS=genotype time genotype*time would translate to a R formula?

Thanks!
Brad
________________________________________
From: r-sig-mixed-models-bounces at r-project.org [r-sig-mixed-models-bounces at r-project.org] on behalf of Ben Bolker [bbolker at gmail.com]
Sent: Thursday, December 27, 2012 10:49 AM
To: r-sig-mixed-models at r-project.org
Subject: Re: [R-sig-ME] linear mixed model with non-monotonic longitudinal      data

Brad Buran <bburan at ...> writes:

>  I'm attempting to fit a linear mixed model to my dataset.  This
> data is the measure of stimulus-evoked power as a function of time.
> We have 32 subjects from two populations (broken down by genotype).
> The stimulus-evoked power is sampled at a high rate (one data-point
> every 5 msec) and reflects the "longitudinal" or "within-subjects"
> measure in my study.

> Right now I've defined the model as:
>
> power ~ genotype * time + (1|subject_id)
>
> I understand that one must also test additional models such as:
>
> power ~ genotype * time + (time|subject_id)
> power ~ genotype * time + (1|subject_id) + (0+time|subject_id)

> However, power is not a linear function of time (i.e. it is
> non-monotonic).  Power rapidly increases over a few hundred
> milliseconds to a peak value then gradually declines afterwards.  In
> this situation, would it be inappropriate to use time for
> determining a slope for the random effect?

> I'm actually not even sure whether a linear mixed model is
> appropriate for this type of data (considering the power response is
> non-monotonic with respect to time).  However, this is how the
> original analysis was set up by a predecessor and I am currently
> trying to determine the validity of this approach.  Thanks, Brad

  Hard to answer completely in general.  The simplest approach
would probably be to make the response a quadratic function of
time; there are a few slightly complicating issues (whether to
use a boneheaded approach such as (genotype * (time + I(time^2))) or
to use poly(time,2) , which constructs orthogonal polynomials
by default, and how to get the time*subject interactions specified
correctly), but it's pretty easy and if it looks like it fits
your data well I might be satisfied with it.
  You could also fit generalized additive mixed
models (see the mgcv and gamm4 packages), again I'm not 100%
sure how to incorporate the time*subject interactions.

  The bottom line is that linear models are actually pretty
flexible for modeling continuous, not necessarily linear,
responses (the assumption is that the model is a linear function
of the parameters, not necessarily that (e.g.) power is
a linear function of time).

  Ben Bolker

_______________________________________________
R-sig-mixed-models at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models


From lborger at cebc.cnrs.fr  Thu Dec 27 23:58:04 2012
From: lborger at cebc.cnrs.fr (lborger)
Date: Thu, 27 Dec 2012 23:58:04 +0100
Subject: [R-sig-ME] linear mixed model with non-monotonic
	longitudinal	data
In-Reply-To: <3A447989F1B70245B88AF76E028FF8604D541A@DAGN01A-E6.exg6.exghost.com>
References: <3A447989F1B70245B88AF76E028FF8604D541A@DAGN01A-E6.exg6.exghost.com>
Message-ID: <WC20121227225804.660079@cebc.cnrs.fr>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121227/37b888a7/attachment.pl>

From elebrija at hotmail.com  Fri Dec 28 05:07:43 2012
From: elebrija at hotmail.com (Edwin Lebrija Trejos)
Date: Fri, 28 Dec 2012 04:07:43 +0000
Subject: [R-sig-ME] what about "zero-inflated" predictors
Message-ID: <DUB108-W2796138D6F613C2BF2E5BDD13F0@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121228/bf86d3f4/attachment.pl>

From bbolker at gmail.com  Fri Dec 28 18:22:28 2012
From: bbolker at gmail.com (Ben Bolker)
Date: Fri, 28 Dec 2012 12:22:28 -0500
Subject: [R-sig-ME] linear mixed model with non-monotonic longitudinal
 data
In-Reply-To: <3A447989F1B70245B88AF76E028FF8604D541A@DAGN01A-E6.exg6.exghost.com>
References: <3A447989F1B70245B88AF76E028FF8604D541A@DAGN01A-E6.exg6.exghost.com>
Message-ID: <50DDD554.2080003@gmail.com>

On 12-12-27 05:31 PM, Brad Buran wrote:

> That was very helpful.  It didn't occur to me that it was possible
  to use functions such as poly in the equation.  That said, it seems
  that none of the models (i.e. the ones I mentioned nor the ones you
  suggested) seem to be a good fit for the data based on the
  residuals.  Since the original model was defined in SPSS (using the
  genlinmixed function), I want to try to determine the actual model
  that SPSS uses (they make you step through a GUI to define your
  model rather than defining an equation like R does).  I haven't been
  able to find any documentation on how the inputs to the genlinmixed
  command are transformed into a model that I could try to create in R
  (so I can check it's validity).

> Is anyone aware of how SPSS model GENLINMIXED with
  SUBJECTS=subject_id, REPEATED_MEASURES=time, FIXED_EFFECTS=genotype
  time genotype*time would translate to a R formula?

   I *think* this would be something like

 ~ genotype+time+genotype:time + (1|subject_id)

or equivalently

 ~ genotype*time + (1|subject_id)

  I assume that (1) there are multiple subjects per genotype
(otherwise subject_id and genotype would be confounded) and
perhaps only one sample per subject -- otherwise it would make
more sense to use (time|subject_id) to allow a time-by-subject
interaction.

  In the R specification it seems one doesn't need both
SUBJECTS and REPEATED_MEASURES (although maybe SPSS does
something else with the REPEATED_MEASURES specification, such
as allowing an R-side autoregressive model to be specified?)
Or else I'm missing something (quite likely).

  I'm also a little surprised that genotype is a fixed effect,
unless the sample size is small (or SPSS doesn't allow multiple,
nested random effects ...)  I would think a model like

 ~ time + (time|genotype/subject_id)

would be best in general?

  Re: time signal -- did you try a GAM? It's a little hard to
see how that could fail to fit a reasonably smooth signal, unless
the shape was really weird ... I can appreciate that quadratics
wouldn't do the job (there are more exotic options like Ricker,
power = a*time*exp(-b*time), which can be done if you are allowed
a logarithmic link and an offset:

  log(power) ~ offset(log(time)) + time



> Thanks!
> Brad
> ________________________________________
> From: r-sig-mixed-models-bounces at r-project.org [r-sig-mixed-models-bounces at r-project.org] on behalf of Ben Bolker [bbolker at gmail.com]
> Sent: Thursday, December 27, 2012 10:49 AM
> To: r-sig-mixed-models at r-project.org
> Subject: Re: [R-sig-ME] linear mixed model with non-monotonic longitudinal      data
> 
> Brad Buran <bburan at ...> writes:
> 
>>  I'm attempting to fit a linear mixed model to my dataset.  This
>> data is the measure of stimulus-evoked power as a function of time.
>> We have 32 subjects from two populations (broken down by genotype).
>> The stimulus-evoked power is sampled at a high rate (one data-point
>> every 5 msec) and reflects the "longitudinal" or "within-subjects"
>> measure in my study.
> 
>> Right now I've defined the model as:
>>
>> power ~ genotype * time + (1|subject_id)
>>
>> I understand that one must also test additional models such as:
>>
>> power ~ genotype * time + (time|subject_id)
>> power ~ genotype * time + (1|subject_id) + (0+time|subject_id)
> 
>> However, power is not a linear function of time (i.e. it is
>> non-monotonic).  Power rapidly increases over a few hundred
>> milliseconds to a peak value then gradually declines afterwards.  In
>> this situation, would it be inappropriate to use time for
>> determining a slope for the random effect?
> 
>> I'm actually not even sure whether a linear mixed model is
>> appropriate for this type of data (considering the power response is
>> non-monotonic with respect to time).  However, this is how the
>> original analysis was set up by a predecessor and I am currently
>> trying to determine the validity of this approach.  Thanks, Brad
> 
>   Hard to answer completely in general.  The simplest approach
> would probably be to make the response a quadratic function of
> time; there are a few slightly complicating issues (whether to
> use a boneheaded approach such as (genotype * (time + I(time^2))) or
> to use poly(time,2) , which constructs orthogonal polynomials
> by default, and how to get the time*subject interactions specified
> correctly), but it's pretty easy and if it looks like it fits
> your data well I might be satisfied with it.
>   You could also fit generalized additive mixed
> models (see the mgcv and gamm4 packages), again I'm not 100%
> sure how to incorporate the time*subject interactions.
> 
>   The bottom line is that linear models are actually pretty
> flexible for modeling continuous, not necessarily linear,
> responses (the assumption is that the model is a linear function
> of the parameters, not necessarily that (e.g.) power is
> a linear function of time).
> 
>   Ben Bolker
> 
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
>


From c.ryan.king at gmail.com  Fri Dec 28 19:56:09 2012
From: c.ryan.king at gmail.com (Ryan King)
Date: Fri, 28 Dec 2012 12:56:09 -0600
Subject: [R-sig-ME] call for lme4 with given Z?
Message-ID: <CAEQ+J243t004JtqODnR-bKNai5oupY05LTF_NmRZ3kez6daE7g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121228/8049ce68/attachment.pl>

From bbolker at gmail.com  Sat Dec 29 17:47:20 2012
From: bbolker at gmail.com (Ben Bolker)
Date: Sat, 29 Dec 2012 16:47:20 +0000 (UTC)
Subject: [R-sig-ME] what about "zero-inflated" predictors
References: <DUB108-W2796138D6F613C2BF2E5BDD13F0@phx.gbl>
Message-ID: <loom.20121229T173924-408@post.gmane.org>

Edwin Lebrija Trejos <elebrija at ...> writes:


> Dear mixed-modelers, I am analyzing seedling survival (0/1) as a
> function of the density of neighbors with a different level of
> relatedness to the focal species. This is, the density of neighbors
> of the same species, of the same genus, family and so on. Focal
> species rarely ocurr with neighbors of the same genus so 92% of the
> cases correspond to 0 neighbors of the same genus (the frequency
> table of the density of neighbors of the same genus is copies at the
> end).I have ran a model using glmer where both the Wald Z test and
> the likelihood ratio test of the models, with and without the fixed
> effect, show a significant increase of the seedling survival odds
> with an increase in the density of neighbors from the same genus.I
> have found lots of information discussing problems with response
> variables containing many zeroes but almost nothing about
> predictors with many zeroes. In a book by Simon Sheater (2009) on
> regression with R there is a brief section that discusses the
> transformation of predictors in logistic regression for binary
> data. Sheater (2009) shows how there is a need to transform skewed
> variables to mantain the linear relationship between the predictor
> and the log odds. He also shows that when the predictor variable has
> a poisson distribution the log odds remain a linear funtion of the
> predictor. My variable in question cannot be normalized with any
> transformation and does not precisely follows a poisson
> distribution.In classic regression my data would certainly
> invalidate the analysis but I am wondering if this is also the case
> for mixed models fit by glmer. Thank you very much for your
> attention to this problem,Edwin

  The reason that there's very little attention given to the
distribution of the predictors is that in general the definition
of standard statistical models such as GLMMs **does not say anything
about the distribution of the predictors**.  In particular, as far
as I am aware your statement that "in classic regression my data
would certainly invalidate the analysis" is not true -- at least
if we're only talking about the distribution of the predictor.

   The main importance of the distribution of the predictor is that
it affects the power of the test -- obviously if most of your
predictor data are zeros, they won't give you very much information
about how the response changes as a function of the response.
I haven't read Sheater's book, but the purpose of transforming the
predictor in this context is to take a response that is *not*
log-odds-linear on the original scale of the predictor, but (e.g.)
might be log-odds-linear when the predictor is on a log scale.
Thus the transformation is *not* fixing a problem with the
distribution of the predictor, but rather with the linearity
of the response.

  As always I'm happy to be corrected by others on the list ...


From bbolker at gmail.com  Sun Dec 30 19:25:27 2012
From: bbolker at gmail.com (Ben Bolker)
Date: Sun, 30 Dec 2012 18:25:27 +0000 (UTC)
Subject: [R-sig-ME] call for lme4 with given Z?
References: <CAEQ+J243t004JtqODnR-bKNai5oupY05LTF_NmRZ3kez6daE7g@mail.gmail.com>
Message-ID: <loom.20121230T192332-739@post.gmane.org>

Ryan King <c.ryan.king at ...> writes:

> I see that a similar question has been asked in the past, but I am
> not totally clear with the in-development status of lme4 if things
> have changed.
 
> Is there a way to call lmer (and glmer) where I have pre-computed
> random effect design matrices and residual covariances?  My design
> matrices are crossed and don't correspond to any of the easy formula
> interfaces that I know about.  I see in the belly of the lmer code
> where Zt's are stored, but am hesitant to jump in and change them;
> I'm hoping someone familiar with the package has a wrapper for this
> use-case.  I know how to do this in the "regress" package for LMMs,
> but would like to use lme4's superior fast methods for sparse
> matrices and have something reasonable for (binary) GLMMs.  I am
> aware of how to do this in MCMCglmm, but for a particularly
> large-scale project have found it unacceptably slow.

  This still hasn't happened, that I know of: Joehanes Roeby had
a patch that modularized some of this (for use with pedigreemm), at
https://stat.ethz.ch/pipermail/r-sig-mixed-models/2012q2/018199.html

  I am hoping to make a branch like this on github sometime Very Soon
(but past experience suggests you shouldn't hold your breath ...)

  Ben Bolker


From bbolker at gmail.com  Mon Dec 31 05:14:27 2012
From: bbolker at gmail.com (Ben Bolker)
Date: Sun, 30 Dec 2012 23:14:27 -0500
Subject: [R-sig-ME] algal nonlinear mixed effects problem
Message-ID: <50E11123.6090807@mcmaster.ca>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1


  Inspired by a recent question of Diego Pujoni's on the list
( http://article.gmane.org/gmane.comp.lang.r.lme4.devel/9363/match= ),
I started working on the problem, with two realizations:

 1. the problem really needs a nonlinear fit: see
http://rpubs.com/bbolker/3363

 2.  I have no idea how to do an nlmer fit with a non-trivial
fixed-effects model (e.g. in nlme we could do

nlmefit1 <- nlme(model = X ~ SSfpl(Day, asymp.L, asymp.R,
                                   xmid, scale),
   fixed = list(asymp.R ~ Group, xmid + scale + asymp.L ~ 1),
   random = asymp.R ~ 1 | Individual, ...)

  This was raised earlier on stack overflow:

http://stackoverflow.com/questions/11056625/how-to-add-fixed-effect-to-four-parameter-logistic-model-in-nlmer

  has anyone figured out if this is possible/how to do it ?

  Ben Bolker
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.10 (GNU/Linux)
Comment: Using GnuPG with undefined - http://www.enigmail.net/

iQEcBAEBAgAGBQJQ4REjAAoJEOCV5YRblxUHRkMH/iobDfLeDdWYoQaNYOBAf/Ab
iJkyO575aoO7XI+cjJdxZQHPdreX4Bdo/jiE/RT0WqiY3FvhmmWI7G6hm5M3fd6D
Kuboep4fsG8KlXYo+ighWnEW1MYs5y8toZWorlFFdBh+yG5v+1MSwVjeVXVLlmM/
haDmaftC3+BThQ8y/7bqRPh0Pr/sVWW48VbYxfVDeN9FyOm1FBEjRlMQmfbrpNBY
VKD3Nsm4P7I+J8jLVBjAfz79r3S+Uqcu/oq7Mr8hydxOFN6lljALgtWAHtUoPdi3
LxMQ+FWMOWgfG/zuvUIRY1Xd4SC4Q7faEgaN1+TdNq0O/A+iYcgPMhd5ZVwKQQw=
=FPuv
-----END PGP SIGNATURE-----


From lucianolasala at yahoo.com.ar  Mon Dec 31 16:20:13 2012
From: lucianolasala at yahoo.com.ar (Luciano La Sala)
Date: Mon, 31 Dec 2012 12:20:13 -0300
Subject: [R-sig-ME] Solution to missing ID??
Message-ID: <003301cde76a$56194a20$024bde60$@com.ar>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mixed-models/attachments/20121231/02c7a90f/attachment.pl>

From wolfgang.viechtbauer at maastrichtuniversity.nl  Mon Dec 31 17:12:47 2012
From: wolfgang.viechtbauer at maastrichtuniversity.nl (Viechtbauer Wolfgang (STAT))
Date: Mon, 31 Dec 2012 17:12:47 +0100
Subject: [R-sig-ME] Mixed-Effects Models with Group or
 Covariate-Dependent Autocorrelation
Message-ID: <077E31A57DA26E46AB0D493C9966AC730D624C8B05@UM-MAIL4112.unimaas.nl>

Dear Mike,

Thank you for the suggestion and the example. A latent growth model may indeed be a possibility, at least for the case where I want to let the autocorrelation differ between the two groups (instead of letting is depend smoothly on a covariate). I do have highly repeated measurements (40-60 obs per person), but that will just require a rather lengthy model statement. And I do have missingness, so I guess I have to switch to FIML to handle that.

Best,
Wolfgang

> -----Original Message-----
> From: r-sig-mixed-models-bounces at r-project.org [mailto:r-sig-mixed-models-
> bounces at r-project.org] On Behalf Of Mike Cheung
> Sent: Wednesday, December 26, 2012 05:01
> To: Mike Cheung
> Cc: r-sig-mixed-models at r-project.org
> Subject: Re: [R-sig-ME] Mixed-Effects Models with Group or Covariate-
> Dependent Autocorrelation
> 
> Hi Wolfgang,
> 
> One approach is to use latent growth model (SEM). The following sample
> code
> fits a model with AR(1) (labeled "c1" in the model). You may add a
> multiple-group analysis for groups A and B. Two models can be then
> fitted--one with the same AR(1) by using the same label, i.e., "c1", and
> another model with different AR(1) by using a different label, say "c2". A
> likelihood-ratio test may be used to compare these two models.
> 
> Hope it helps.
> 
> my.df <-
> structure(list(anti0 = c(2L, 1L, 0L, 1L, 2L, 3L, 5L, 0L, 0L,
> 4L, 2L, 2L, 4L, 1L, 0L, 3L, 1L, 0L, 1L, 1L), anti1 = c(5L, 2L,
> 1L, 0L, 3L, 2L, 0L, 0L, 0L, 2L, 2L, 3L, 3L, 1L, 3L, 5L, 0L, 0L,
> 0L, 3L), anti2 = c(1L, 1L, 1L, 2L, 2L, 3L, 5L, 0L, 0L, 2L, 0L,
> 6L, 3L, 0L, 4L, 0L, 3L, 2L, 1L, 3L), anti3 = c(5L, 1L, 2L, 4L,
> 2L, 4L, 3L, 0L, 1L, 2L, 0L, 5L, 2L, 1L, 1L, 0L, 0L, 0L, 0L, 2L
> )), .Names = c("anti0", "anti1", "anti2", "anti3"), row.names = c(134L,
> 76L, 145L, 83L, 53L, 12L, 21L, 177L, 151L, 152L, 96L, 91L, 132L,
> 198L, 38L, 160L, 101L, 37L, 197L, 31L), class = "data.frame")
> 
> library("lavaan")
> 
> my.model1 <- 'i =~ 1*anti0 + 1*anti1 + 1*anti2 + 1*anti3
>               s =~ 0*anti0 + 1*anti1 + 2*anti2 + 3*anti3
>               ## Equality on error variances
>               anti0 ~~ sigma*anti0
>               anti1 ~~ sigma*anti1
>               anti2 ~~ sigma*anti2
>               anti3 ~~ sigma*anti3
>               ## AR(1): Note that c1 is covariance, not correlation
>               anti0 ~~ c1*anti1
>               anti1 ~~ c1*anti2
>               anti2 ~~ c1*anti3'
> 
> my.fit1 <- growth(my.model1, data=my.df)
> summary(my.fit1, fit.measures=TRUE)
> 
> Cheers,
> Mike
> 
> --
> ---------------------------------------------------------------------
>  Mike W.L. Cheung               Phone: (65) 6516-3702
>  Department of Psychology       Fax:   (65) 6773-1843
>  National University of Singapore
>  http://courses.nus.edu.sg/course/psycwlm/internet/
> ---------------------------------------------------------------------
> 
> On Wed, Dec 12, 2012 at 10:51 PM, Viechtbauer Wolfgang (STAT) <
> wolfgang.viechtbauer at maastrichtuniversity.nl> wrote:
> 
> > Dear All,
> >
> > I am currently working with some mixed-effects models for longitudinal
> > data where I want to test hypotheses about the difference in the
> strength
> > of the autocorrelation between two groups. In particular, let's say I
> have
> > data of the form:
> >
> > person  time  group  y
> > ----------------------------
> > 1       0     A      <value>
> > 1       1     A      <value>
> > 1       2     A      <value>
> > ...     ...   ...    ...
> > 2       0     A      <value>
> > 2       1     A      <value>
> > 2       2     A      <value>
> > ...     ...   ...    ...
> >
> > and I want to fit the model:
> >
> > y_ij = beta_0 + beta_1 time_ij + u_0i + u_1i time + e_ij,
> >
> > where i is the index for person, j is the index for time, u_0i ~ N(0,
> > tau^2_0) is a random effect for the intercepts, u_1i ~ N(0, tau^2_1) is
> a
> > random effect for the slopes, cov(u_0i, u_1i) = tau_01 is the covariance
> > between these two random effects, and now I want to fit an AR(1)
> structure
> > for the errors e_ij, where the autocorelation is rho_A for people from
> > group A and rho_B for people from group B. In principle, I may also want
> to
> > let the error variance to differ for the two groups (i.e., sigma^2_A and
> > sigma^2_B).
> >
> > In nlme, I can fit models with a common autocorrelation structure for
> the
> > two groups, with:
> >
> > lme(y ~ time, random = ~ time | person, correlation = corAR1(form = ~
> time
> > | person))
> >
> > but as far as I can tell, it is not possible to allow the
> autocorrelation
> > parameter to differ between the two groups.
> >
> > Does anybody know of a package/function that would allow fitting such a
> > model?
> >
> > Moreover, the groups are actually created by dichotomizing a continuous
> > measure. Ideally, I would like to fit a model, where rho depends on the
> > continuous measure directly. Or, to avoid issues related to rho having
> to
> > fall between -1 and 1, it would probably make more sense to assume that
> > f(rho) depends on that continuous measure, where f() is the arctanh
> > (inverse hyperbolic function or Fisher's r-to-z) transformation. Again,
> any
> > ideas on packages/functions that may handle such a model?
> >
> > Thanks in advance for any suggestions!
> >
> > Best,
> > Wolfgang
> >
> > --
> > Wolfgang Viechtbauer, Ph.D., Statistician
> > Department of Psychiatry and Psychology
> > School for Mental Health and Neuroscience
> > Faculty of Health, Medicine, and Life Sciences
> > Maastricht University, P.O. Box 616 (VIJV1)
> > 6200 MD Maastricht, The Netherlands
> > +31 (43) 388-4170 | http://www.wvbauer.com
> >
> > _______________________________________________
> > R-sig-mixed-models at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models
> >
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models


From wolfgang.viechtbauer at maastrichtuniversity.nl  Mon Dec 31 17:17:05 2012
From: wolfgang.viechtbauer at maastrichtuniversity.nl (Viechtbauer Wolfgang (STAT))
Date: Mon, 31 Dec 2012 17:17:05 +0100
Subject: [R-sig-ME] Mixed-Effects Models with Group or
 Covariate-Dependent Autocorrelation
In-Reply-To: <CAO7JsnR6XTXx+M2seNbrxiUezaDU_Ct8NvroeJEK6e1_chmEBg@mail.gmail.com>
References: <077E31A57DA26E46AB0D493C9966AC730D5FFED3B2@UM-MAIL4112.unimaas.nl>
	<CAO7JsnR6XTXx+M2seNbrxiUezaDU_Ct8NvroeJEK6e1_chmEBg@mail.gmail.com>
Message-ID: <077E31A57DA26E46AB0D493C9966AC730D624C8B06@UM-MAIL4112.unimaas.nl>

Thank you for the feedback. Indeed, that is a concern. Fortunately, I have highly repeated measurements (40-60 obs per person) and quite a large n, so I think I have enough information to fit such a model.

Best,
Wolfgang

> -----Original Message-----
> From: dmbates at gmail.com [mailto:dmbates at gmail.com] On Behalf Of Douglas
> Bates
> Sent: Wednesday, December 26, 2012 21:18
> To: Viechtbauer Wolfgang (STAT)
> Cc: r-sig-mixed-models at r-project.org
> Subject: Re: [R-sig-ME] Mixed-Effects Models with Group or Covariate-
> Dependent Autocorrelation
> 
> You should be cautious of trying to incorporate both an random effect for
> time and an AR1 structure on the residuals in a mixed-effects model. ?The
> marginal covariance structures on the responses from those two model
> components, while not identical, are quite similar and the modeling will
> trade one off against the other, likely resulting in poor precision of the
> estimators for the parameters in both.
> 
> On Wed, Dec 12, 2012 at 8:51 AM, Viechtbauer Wolfgang (STAT)
> <wolfgang.viechtbauer at maastrichtuniversity.nl> wrote:
> Dear All,
> 
> I am currently working with some mixed-effects models for longitudinal
> data where I want to test hypotheses about the difference in the strength
> of the autocorrelation between two groups. In particular, let's say I have
> data of the form:
> 
> person ?time ?group ?y
> ----------------------------
> 1 ? ? ? 0 ? ? A ? ? ?<value>
> 1 ? ? ? 1 ? ? A ? ? ?<value>
> 1 ? ? ? 2 ? ? A ? ? ?<value>
> ... ? ? ... ? ... ? ?...
> 2 ? ? ? 0 ? ? A ? ? ?<value>
> 2 ? ? ? 1 ? ? A ? ? ?<value>
> 2 ? ? ? 2 ? ? A ? ? ?<value>
> ... ? ? ... ? ... ? ?...
> 
> and I want to fit the model:
> 
> y_ij = beta_0 + beta_1 time_ij + u_0i + u_1i time + e_ij,
> 
> where i is the index for person, j is the index for time, u_0i ~ N(0,
> tau^2_0) is a random effect for the intercepts, u_1i ~ N(0, tau^2_1) is a
> random effect for the slopes, cov(u_0i, u_1i) = tau_01 is the covariance
> between these two random effects, and now I want to fit an AR(1) structure
> for the errors e_ij, where the autocorelation is rho_A for people from
> group A and rho_B for people from group B. In principle, I may also want
> to let the error variance to differ for the two groups (i.e., sigma^2_A
> and sigma^2_B).
> 
> In nlme, I can fit models with a common autocorrelation structure for the
> two groups, with:
> 
> lme(y ~ time, random = ~ time | person, correlation = corAR1(form = ~ time
> | person))
> 
> but as far as I can tell, it is not possible to allow the autocorrelation
> parameter to differ between the two groups.
> 
> Does anybody know of a package/function that would allow fitting such a
> model?
> 
> Moreover, the groups are actually created by dichotomizing a continuous
> measure. Ideally, I would like to fit a model, where rho depends on the
> continuous measure directly. Or, to avoid issues related to rho having to
> fall between -1 and 1, it would probably make more sense to assume that
> f(rho) depends on that continuous measure, where f() is the arctanh
> (inverse hyperbolic function or Fisher's r-to-z) transformation. Again,
> any ideas on packages/functions that may handle such a model?
> 
> Thanks in advance for any suggestions!
> 
> Best,
> Wolfgang
> 
> --
> Wolfgang Viechtbauer, Ph.D., Statistician
> Department of Psychiatry and Psychology
> School for Mental Health and Neuroscience
> Faculty of Health, Medicine, and Life Sciences
> Maastricht University, P.O. Box 616 (VIJV1)
> 6200 MD Maastricht, The Netherlands
> +31 (43) 388-4170 | http://www.wvbauer.com
> 
> _______________________________________________
> R-sig-mixed-models at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-mixed-models


From David.Duffy at qimr.edu.au  Mon Dec 31 21:41:39 2012
From: David.Duffy at qimr.edu.au (David Duffy)
Date: Tue, 1 Jan 2013 06:41:39 +1000
Subject: [R-sig-ME] Solution to missing ID??
In-Reply-To: <003301cde76a$56194a20$024bde60$@com.ar>
References: <003301cde76a$56194a20$024bde60$@com.ar>
Message-ID: <alpine.LMD.2.00.1301010628090.2674@orpheus.qimr.edu.au>

On Tue, 1 Jan 2013, Luciano La Sala wrote:

> I have a dataset consisting of weights collected from two flocks of 
> chickens; treatments (infected with some bug) and controls (given a 
> placebo). The same two groups were followed over time and the weight of 
> each chicken was taken at seven equally spaced time points. I need to 
> assess the effect of treatment and time on body weight, but I may have 
> pseudo-replication problem here since seven measurements were collected 
> from each bird overtime the course of the experiment. Having said that, 
> I thought that including chicken ID as random intercept would help me 
> circumvent this issue, but unfortunately, the chickens were not 
> individually identified and the repeated measures can't be allocated to 
> each of the birds. I guess this will preclude me from implementing a 
> mixed effects model. Is there a way / analytical approach to circumvent 
> this problem, i.e. get rid the pseudo-replication issue?

You might consider a delete-d jackknife approach. This should 
help to improve your variance estimates even though you can't identify 
the true clustering in the data - presumably you have retained individual 
measurements even though you don't know who the individuals are.  An 
alternative might be to collect longitudinal data on a new subgroup, and 
fit to both datasets as a missing data type problem.

| David Duffy (MBBS PhD)                                         ,-_|\
| email: davidD at qimr.edu.au  ph: INT+61+7+3362-0217 fax: -0101  /     *
| Epidemiology Unit, Queensland Institute of Medical Research   \_,-._/
| 300 Herston Rd, Brisbane, Queensland 4029, Australia  GPG 4D0B994A v


From bbolker at gmail.com  Mon Dec 31 22:09:13 2012
From: bbolker at gmail.com (Ben Bolker)
Date: Mon, 31 Dec 2012 21:09:13 +0000 (UTC)
Subject: [R-sig-ME] algal nonlinear mixed effects problem
References: <50E11123.6090807@mcmaster.ca>
Message-ID: <loom.20121231T220104-102@post.gmane.org>

Ben Bolker <bbolker at ...> writes:

> 
> 
>   Inspired by a recent question of Diego Pujoni's on the list
> ( http://article.gmane.org/gmane.comp.lang.r.lme4.devel/9363/match= ),
> I started working on the problem, with two realizations:
> 
>  1. the problem really needs a nonlinear fit: see
> http://rpubs.com/bbolker/3363
> 
>  2.  I have no idea how to do an nlmer fit with a non-trivial
> fixed-effects model (e.g. in nlme we could do
> 
> nlmefit1 <- nlme(model = X ~ SSfpl(Day, asymp.L, asymp.R,
>                                    xmid, scale),
>    fixed = list(asymp.R ~ Group, xmid + scale + asymp.L ~ 1),
>    random = asymp.R ~ 1 | Individual, ...)
> 
>   This was raised earlier on stack overflow:
> 
>
http://stackoverflow.com/questions/11056625/how-to-add-fixed-effect-to-four-parameter-logistic-model-in-nlmer
> 

  Reinhold Kliegl e-mailed off-list to say that he was able to do 
it / had to do it by hacking up an objective function that accounts
for the grouping (i.e., more or less doing it by hand).  I have
implemented this and updated http://rpubs.com/bbolker/3363 , which
also shows a solution with AD Model Builder; it turns out that at
least the development version of nlmer is a little too fragile to
fit the model I wanted to fit (I haven't tested with the stable
version).


