From ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de  Tue Apr  1 10:26:35 2025
From: ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de (Uwe Ligges)
Date: Tue, 1 Apr 2025 10:26:35 +0200
Subject: [R-pkg-devel] 
 [CRAN-pretest-archived] CRAN Submission OPCreg 0.2.0
In-Reply-To: <513f1a07.73cc.195f03a36e2.Coremail.ggb11111111@163.com>
References: <20250401013307.D9595A01D4@xmpalantir.wu.ac.at>
 <01dba2ac$Blat.v3.2.24$40b54e1c$2604851e1@mail.statistik.tu-dortmund.de>
 <513f1a07.73cc.195f03a36e2.Coremail.ggb11111111@163.com>
Message-ID: <405d9027-1b87-4b80-a0ec-60cb501e9e97@statistik.tu-dortmund.de>

But we see

Author field differs from that derived from Authors at R
   Author:    'Guangbao Guo [aut, cre] 
https://orcid.org/0000-0002-4115-6218>), Chunjie Wei [aut]'
   Authors at R: 'Guangbao Guo [aut, cre] (ORCID: 
<https://orcid.org/0000-0002-4115-6218>), Chunjie Wei [aut]'


You have to build the package with R-devel or R-prerelease, then the 
field will be auto generated in the new form.

Best,
Uwe Ligges


On 01.04.2025 09:21, ??? wrote:
> Dear Uwe Ligges,
> 
>          The name "Guo" is correctly spelled. Guo is my family name.
> 
> 
> 
> 
> If you are fairly certain the rejection is a false positive.
> 
>   
> 
> 
> 
> 
> --
> 
> Sincerely yours,
> Guangbao Guo
> 
> 
> Wechat Number: ggb11111111
> 
> 
> 
> 
> 
> At 2025-04-01 10:17:44, ligges at statistik.tu-dortmund.de wrote:
>> Dear maintainer,
>>
>> package OPCreg_0.2.0.tar.gz does not pass the incoming checks automatically, please see the following pre-tests (additional issue checks):
>> Windows: <https://win-builder.r-project.org/incoming_pretest/OPCreg_0.2.0_20250401_033307/Windows/00check.log>
>> Status: 2 NOTEs
>> Debian: <https://win-builder.r-project.org/incoming_pretest/OPCreg_0.2.0_20250401_033307/Debian/00check.log>
>> Status: 2 NOTEs
>>
>>
>>
>> Please fix all problems and resubmit a fixed version via the webform.
>> If you are not sure how to fix the problems shown, please ask for help on the R-package-devel mailing list:
>> <https://stat.ethz.ch/mailman/listinfo/r-package-devel>
>> If you are fairly certain the rejection is a false positive, please reply-all to this message and explain.
>>
>> More details are given in the directory:
>> <https://win-builder.r-project.org/incoming_pretest/OPCreg_0.2.0_20250401_033307/>
>> The files will be removed after roughly 7 days.
>>
>> No strong reverse dependencies to be checked.
>>
>> Best regards,
>> CRAN teams' auto-check service
> 
> 	[[alternative HTML version deleted]]
> 


From @ergue|@@oko| @end|ng |rom gm@||@com  Tue Apr  1 10:26:44 2025
From: @ergue|@@oko| @end|ng |rom gm@||@com (Serguei Sokol)
Date: Tue, 1 Apr 2025 10:26:44 +0200
Subject: [R-pkg-devel] AlgDesign C Issue
In-Reply-To: <CAMUU=-+C8bMCUFOOD_FEGJLvSnVk+Ubjd+JEwHL86Th+8Mn7pw@mail.gmail.com>
References: <CAMUU=-Km46C8gMdnBQQ2VoHXLxKoi-=B-7i5u90PvRx9psXndQ@mail.gmail.com>
 <CAPRVBcy+LpPHQ9DAAOMFicZ7m-P7+fgc7oqD0jT0bK_XFrjQew@mail.gmail.com>
 <CAMUU=-LsEvLGvTbub0nKz2R-sG4HFgms2cxP_6bO5E9PxJHOJg@mail.gmail.com>
 <dcd2bc2b-c486-4532-962f-c04793ecb091@gmail.com>
 <CAMUU=-+C8bMCUFOOD_FEGJLvSnVk+Ubjd+JEwHL86Th+8Mn7pw@mail.gmail.com>
Message-ID: <fa95ce55-a249-45a8-be6e-167a808e0398@gmail.com>

Le 31/03/2025 ? 18:00, Jerome Braun a ?crit?:
> Hi Duncan!
> 
>>   Since the compiler will supply stdbool.h, it's safer to use that than to
> try to emulate it.
> 
> Understood. It seems like the definitions are exactly the same between the
> two.
Yes and no. Yes, true and false are the same. No, because there is also 
__bool_true_false_are_defined which is set to 1 and this can make the 
compiler react differently in various situations.

> 
> Currently there is no use of "bool" in any of the code (after having
> changed bool to int everywhere in the code).
> 
> So I think I can replace the two lines in the original code with a call to
> include the <stdbool.h> header --- does that seem reasonable?   Can I use
> an include statement there in place of those two lines?
I think it would be good and safe idea.

Best,
Serguei.

> 
> Thank you!


From th|erry@onke||nx @end|ng |rom |nbo@be  Tue Apr  1 14:28:04 2025
From: th|erry@onke||nx @end|ng |rom |nbo@be (Thierry Onkelinx)
Date: Tue, 1 Apr 2025 14:28:04 +0200
Subject: [R-pkg-devel] Connection time-out when checking a package
Message-ID: <CAJuCY5xfn7uykxM2JHPOWgkzUPrjXz8tpJ-3E_=GFw7XucuYfA@mail.gmail.com>

Dear all,

When checking a package via a GitHub action I often (but not always) get a
connection-time out for the GNU license page. The github actions runs the
code below

   Sys.setenv("R_DEFAULT_INTERNET_TIMEOUT" = 360)
   options(timeout = max(360, getOption("timeout")))
    rcmdcheck::rcmdcheck(
      path = x$get_path, args = c("--timings", "--as-cran", "--no-manual"),
      error_on = "never", timeout = Inf
    )

The resulting NOTE

Found the following (possibly) invalid URLs:
  URL: https://www.gnu.org/licenses/gpl-3.0.html
    From: README.md
    Status: Error
    Message: libcurl error code 28:
      Failed to connect to www.gnu.org port 443 after 136189 ms: Couldn't
connect to server

I'm guessing that https://www.gnu.org is blocking the request from the
GitHub Action. Any suggestions how to fix this note without removing the
URL for the README?

Best regards,

Thierry

ir. Thierry Onkelinx
Statisticus / Statistician

Vlaamse Overheid / Government of Flanders
INSTITUUT VOOR NATUUR- EN BOSONDERZOEK / RESEARCH INSTITUTE FOR NATURE AND
FOREST
Team Biometrie & Kwaliteitszorg / Team Biometrics & Quality Assurance
thierry.onkelinx at inbo.be
Havenlaan 88 bus 73, 1000 Brussel
*Postadres:* Koning Albert II-laan 15 bus 186, 1210 Brussel
*Poststukken die naar dit adres worden gestuurd, worden ingescand en
digitaal aan de geadresseerde bezorgd. Zo kan de Vlaamse overheid haar
dossiers volledig digitaal behandelen. Poststukken met de vermelding
?vertrouwelijk? worden niet ingescand, maar ongeopend aan de geadresseerde
bezorgd.*
www.inbo.be

///////////////////////////////////////////////////////////////////////////////////////////
To call in the statistician after the experiment is done may be no more
than asking him to perform a post-mortem examination: he may be able to say
what the experiment died of. ~ Sir Ronald Aylmer Fisher
The plural of anecdote is not data. ~ Roger Brinner
The combination of some data and an aching desire for an answer does not
ensure that a reasonable answer can be extracted from a given body of data.
~ John Tukey
///////////////////////////////////////////////////////////////////////////////////////////

<https://www.inbo.be>

	[[alternative HTML version deleted]]


From |kry|ov @end|ng |rom d|@root@org  Wed Apr  2 11:45:54 2025
From: |kry|ov @end|ng |rom d|@root@org (Ivan Krylov)
Date: Wed, 2 Apr 2025 12:45:54 +0300
Subject: [R-pkg-devel] Connection time-out when checking a package
In-Reply-To: <CAJuCY5xfn7uykxM2JHPOWgkzUPrjXz8tpJ-3E_=GFw7XucuYfA@mail.gmail.com>
References: <CAJuCY5xfn7uykxM2JHPOWgkzUPrjXz8tpJ-3E_=GFw7XucuYfA@mail.gmail.com>
Message-ID: <20250402124554.023fa302@arachnoid>

? Tue, 1 Apr 2025 14:28:04 +0200
Thierry Onkelinx <thierry.onkelinx at inbo.be> ?????:

> Any suggestions how to fix this note without removing the
> URL for the README?

I think it should be possible to set the environment variable
_R_CHECK_CRAN_INCOMING_REMOTE_=FALSE to disable the "remote" checks [*]
(including checks for repository content) or
_R_CHECK_CRAN_INCOMING_SKIP_URL_CHECKS_IF_REMOTE_=TRUE to only skip the
URL checks.

-- 
Best regards,
Ivan

[*]
https://cran.r-project.org/doc/manuals/r-devel/R-ints.html#index-_005fR_005fCHECK_005fCRAN_005fINCOMING_005fREMOTE_005f


From th|erry@onke||nx @end|ng |rom |nbo@be  Wed Apr  2 13:01:12 2025
From: th|erry@onke||nx @end|ng |rom |nbo@be (Thierry Onkelinx)
Date: Wed, 2 Apr 2025 13:01:12 +0200
Subject: [R-pkg-devel] Connection time-out when checking a package
In-Reply-To: <20250402124554.023fa302@arachnoid>
References: <CAJuCY5xfn7uykxM2JHPOWgkzUPrjXz8tpJ-3E_=GFw7XucuYfA@mail.gmail.com>
 <20250402124554.023fa302@arachnoid>
Message-ID: <CAJuCY5wdRwwmu_b1NZHPjTvBoDa+YFrBe8SsuawoXnxL0CYvLg@mail.gmail.com>

Dear Ivan,

Thanks for the feedback. Skipping all URL checks is not an ideal solution.
Getting a NOTE for a broken link is valuable. Given that the problem occurs
over several repositories but always with the gnu.org domain, I was hoping
for a more tailored solution.

Removing the problematic URL is probably the best solution for now.

Best regards,

Thierry

ir. Thierry Onkelinx
Statisticus / Statistician

Vlaamse Overheid / Government of Flanders
INSTITUUT VOOR NATUUR- EN BOSONDERZOEK / RESEARCH INSTITUTE FOR NATURE AND
FOREST
Team Biometrie & Kwaliteitszorg / Team Biometrics & Quality Assurance
thierry.onkelinx at inbo.be
Havenlaan 88 bus 73, 1000 Brussel
*Postadres:* Koning Albert II-laan 15 bus 186, 1210 Brussel
*Poststukken die naar dit adres worden gestuurd, worden ingescand en
digitaal aan de geadresseerde bezorgd. Zo kan de Vlaamse overheid haar
dossiers volledig digitaal behandelen. Poststukken met de vermelding
?vertrouwelijk? worden niet ingescand, maar ongeopend aan de geadresseerde
bezorgd.*
www.inbo.be

///////////////////////////////////////////////////////////////////////////////////////////
To call in the statistician after the experiment is done may be no more
than asking him to perform a post-mortem examination: he may be able to say
what the experiment died of. ~ Sir Ronald Aylmer Fisher
The plural of anecdote is not data. ~ Roger Brinner
The combination of some data and an aching desire for an answer does not
ensure that a reasonable answer can be extracted from a given body of data.
~ John Tukey
///////////////////////////////////////////////////////////////////////////////////////////

<https://www.inbo.be>


Op wo 2 apr 2025 om 11:45 schreef Ivan Krylov <ikrylov at disroot.org>:

> ? Tue, 1 Apr 2025 14:28:04 +0200
> Thierry Onkelinx <thierry.onkelinx at inbo.be> ?????:
>
> > Any suggestions how to fix this note without removing the
> > URL for the README?
>
> I think it should be possible to set the environment variable
> _R_CHECK_CRAN_INCOMING_REMOTE_=FALSE to disable the "remote" checks [*]
> (including checks for repository content) or
> _R_CHECK_CRAN_INCOMING_SKIP_URL_CHECKS_IF_REMOTE_=TRUE to only skip the
> URL checks.
>
> --
> Best regards,
> Ivan
>
> [*]
>
> https://cran.r-project.org/doc/manuals/r-devel/R-ints.html#index-_005fR_005fCHECK_005fCRAN_005fINCOMING_005fREMOTE_005f
>

	[[alternative HTML version deleted]]


From corne||o|d @end|ng |rom gm@||@com  Wed Apr  2 19:28:32 2025
From: corne||o|d @end|ng |rom gm@||@com (Jason Cory Brunson)
Date: Wed, 2 Apr 2025 13:28:32 -0400
Subject: [R-pkg-devel] proper way to cite an invalid URL
Message-ID: <cc4856a9-3a87-4f9b-a0f1-6ce40b1d5e45@gmail.com>

Hello,

I'm trying to submit a new version of a package to CRAN. Among the 
additions is an RMarkdown vignette that uses data from a website that is 
no longer active. For completeness, i'd still like to cite the invalid 
URL, but without formatting it as a hyperlink. What is the preferred way 
to do this?

One StackExchange answer is to surround the URL with <span></span>, but 
this did not remove the hyperlink when i rendered the vignette locally. 
Instead, i surrounded it with back-ticks, which works locally, but i've 
been unable to run Win-Builder checks to see whether this prevents the 
"invalid URLs" NOTE. And, even if the NOTE is prevented, i'm not sure 
this is preferred.

Thank you,

Cory Brunson


From murdoch@dunc@n @end|ng |rom gm@||@com  Wed Apr  2 23:42:35 2025
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Wed, 2 Apr 2025 17:42:35 -0400
Subject: [R-pkg-devel] proper way to cite an invalid URL
In-Reply-To: <cc4856a9-3a87-4f9b-a0f1-6ce40b1d5e45@gmail.com>
References: <cc4856a9-3a87-4f9b-a0f1-6ce40b1d5e45@gmail.com>
Message-ID: <f08930c4-6928-469c-ab27-1773004934ae@gmail.com>

On 2025-04-02 1:28 p.m., Jason Cory Brunson wrote:
> Hello,
> 
> I'm trying to submit a new version of a package to CRAN. Among the
> additions is an RMarkdown vignette that uses data from a website that is
> no longer active. For completeness, i'd still like to cite the invalid
> URL, but without formatting it as a hyperlink. What is the preferred way
> to do this?
> 
> One StackExchange answer is to surround the URL with <span></span>, but
> this did not remove the hyperlink when i rendered the vignette locally.
> Instead, i surrounded it with back-ticks, which works locally, but i've
> been unable to run Win-Builder checks to see whether this prevents the
> "invalid URLs" NOTE. And, even if the NOTE is prevented, i'm not sure
> this is preferred.

Why not leave off the scheme, e.g. "www.r-project.org" instead of 
"https://www.r-project.org".

Duncan Murdoch


From @|mon@urb@nek @end|ng |rom R-project@org  Thu Apr  3 00:01:03 2025
From: @|mon@urb@nek @end|ng |rom R-project@org (Simon Urbanek)
Date: Thu, 3 Apr 2025 11:01:03 +1300
Subject: [R-pkg-devel] Connection time-out when checking a package
In-Reply-To: <CAJuCY5wdRwwmu_b1NZHPjTvBoDa+YFrBe8SsuawoXnxL0CYvLg@mail.gmail.com>
References: <CAJuCY5xfn7uykxM2JHPOWgkzUPrjXz8tpJ-3E_=GFw7XucuYfA@mail.gmail.com>
 <20250402124554.023fa302@arachnoid>
 <CAJuCY5wdRwwmu_b1NZHPjTvBoDa+YFrBe8SsuawoXnxL0CYvLg@mail.gmail.com>
Message-ID: <C14FACC0-4361-4BFA-8EAA-DAE30D225C0D@R-project.org>

FWIW: connectivity from GH runners is notoriously patchy*, so I wouldn?t rely on those for URL checks, so I?d recommend using the solution by Ivan in actions and simply running a separate check without the option once in a while locally (e.g., before submission) to detect such issues. After all, the point of GHAs is to detect things you cannot detect locally (because of OS etc.) which this not the case here.

* - the failure rate is so high that pretty much all actions involving remote files include provisions for several retries, otherwise your actions will fail on a regular basis. That said, GNU servers are notoriously unreliable themselves, compounding the problem. Even in our macOS recipes I had to create a provision for automatic rewriting of gnu.org URLs to more reliable GNU mirrors as the master site is either slow or unresponsive very often, so this is not an unusual problem.

Cheers,
Simon


> On 3 Apr 2025, at 00:01, Thierry Onkelinx <thierry.onkelinx at inbo.be> wrote:
> 
> Dear Ivan,
> 
> Thanks for the feedback. Skipping all URL checks is not an ideal solution.
> Getting a NOTE for a broken link is valuable. Given that the problem occurs
> over several repositories but always with the gnu.org domain, I was hoping
> for a more tailored solution.
> 
> Removing the problematic URL is probably the best solution for now.
> 
> Best regards,
> 
> Thierry
> 
> ir. Thierry Onkelinx
> Statisticus / Statistician
> 
> Vlaamse Overheid / Government of Flanders
> INSTITUUT VOOR NATUUR- EN BOSONDERZOEK / RESEARCH INSTITUTE FOR NATURE AND
> FOREST
> Team Biometrie & Kwaliteitszorg / Team Biometrics & Quality Assurance
> thierry.onkelinx at inbo.be
> Havenlaan 88 bus 73, 1000 Brussel
> *Postadres:* Koning Albert II-laan 15 bus 186, 1210 Brussel
> *Poststukken die naar dit adres worden gestuurd, worden ingescand en
> digitaal aan de geadresseerde bezorgd. Zo kan de Vlaamse overheid haar
> dossiers volledig digitaal behandelen. Poststukken met de vermelding
> ?vertrouwelijk? worden niet ingescand, maar ongeopend aan de geadresseerde
> bezorgd.*
> www.inbo.be
> 
> ///////////////////////////////////////////////////////////////////////////////////////////
> To call in the statistician after the experiment is done may be no more
> than asking him to perform a post-mortem examination: he may be able to say
> what the experiment died of. ~ Sir Ronald Aylmer Fisher
> The plural of anecdote is not data. ~ Roger Brinner
> The combination of some data and an aching desire for an answer does not
> ensure that a reasonable answer can be extracted from a given body of data.
> ~ John Tukey
> ///////////////////////////////////////////////////////////////////////////////////////////
> 
> <https://www.inbo.be>
> 
> 
> Op wo 2 apr 2025 om 11:45 schreef Ivan Krylov <ikrylov at disroot.org>:
> 
>> ? Tue, 1 Apr 2025 14:28:04 +0200
>> Thierry Onkelinx <thierry.onkelinx at inbo.be> ?????:
>> 
>>> Any suggestions how to fix this note without removing the
>>> URL for the README?
>> 
>> I think it should be possible to set the environment variable
>> _R_CHECK_CRAN_INCOMING_REMOTE_=FALSE to disable the "remote" checks [*]
>> (including checks for repository content) or
>> _R_CHECK_CRAN_INCOMING_SKIP_URL_CHECKS_IF_REMOTE_=TRUE to only skip the
>> URL checks.
>> 
>> --
>> Best regards,
>> Ivan
>> 
>> [*]
>> 
>> https://cran.r-project.org/doc/manuals/r-devel/R-ints.html#index-_005fR_005fCHECK_005fCRAN_005fINCOMING_005fREMOTE_005f
>> 
> 
> [[alternative HTML version deleted]]
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
> 


From n|cho|@@@t|erney @end|ng |rom gm@||@com  Thu Apr  3 02:28:32 2025
From: n|cho|@@@t|erney @end|ng |rom gm@||@com (Nicholas Tierney)
Date: Thu, 3 Apr 2025 11:28:32 +1100
Subject: [R-pkg-devel] proper way to cite an invalid URL
In-Reply-To: <f08930c4-6928-469c-ab27-1773004934ae@gmail.com>
References: <cc4856a9-3a87-4f9b-a0f1-6ce40b1d5e45@gmail.com>
 <f08930c4-6928-469c-ab27-1773004934ae@gmail.com>
Message-ID: <CACrL82XTjtTHZRvz4YL2rPRfWvKvFE3rgAsDJSVUKbo2zY4QuA@mail.gmail.com>

Could you potentially look for the original website in the internet archive
/ wayback machine: https://web.archive.org/ and cite that instead?

On Thu, 3 Apr 2025 at 08:42, Duncan Murdoch <murdoch.duncan at gmail.com>
wrote:

> On 2025-04-02 1:28 p.m., Jason Cory Brunson wrote:
> > Hello,
> >
> > I'm trying to submit a new version of a package to CRAN. Among the
> > additions is an RMarkdown vignette that uses data from a website that is
> > no longer active. For completeness, i'd still like to cite the invalid
> > URL, but without formatting it as a hyperlink. What is the preferred way
> > to do this?
> >
> > One StackExchange answer is to surround the URL with <span></span>, but
> > this did not remove the hyperlink when i rendered the vignette locally.
> > Instead, i surrounded it with back-ticks, which works locally, but i've
> > been unable to run Win-Builder checks to see whether this prevents the
> > "invalid URLs" NOTE. And, even if the NOTE is prevented, i'm not sure
> > this is preferred.
>
> Why not leave off the scheme, e.g. "www.r-project.org" instead of
> "https://www.r-project.org".
>
> Duncan Murdoch
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From corne||o|d @end|ng |rom gm@||@com  Thu Apr  3 03:20:19 2025
From: corne||o|d @end|ng |rom gm@||@com (Jason Cory Brunson)
Date: Wed, 2 Apr 2025 21:20:19 -0400
Subject: [R-pkg-devel] proper way to cite an invalid URL
In-Reply-To: <CACrL82XTjtTHZRvz4YL2rPRfWvKvFE3rgAsDJSVUKbo2zY4QuA@mail.gmail.com>
References: <cc4856a9-3a87-4f9b-a0f1-6ce40b1d5e45@gmail.com>
 <f08930c4-6928-469c-ab27-1773004934ae@gmail.com>
 <CACrL82XTjtTHZRvz4YL2rPRfWvKvFE3rgAsDJSVUKbo2zY4QuA@mail.gmail.com>
Message-ID: <93131639-5472-4fdb-b5af-0091ead580aa@gmail.com>

Thank you both!

Nicholas, i did check the Wayback Machine; the URL was never archived, 
nor was the domain itself (in case you're curious, www.ibge.Goi?sv.br/).

Duncan, that worked at preventing the hyperlink locally; thank you. But 
i got a new error from Win-Builder (the development version via 
devtools::check_win_devel() but not the release version via 
devtools::check_win_release()). It seems to apply to all URLs and DOIs, 
though i did not get it on any previous check:

Checking URLs failed with message:
 ? there is no package called 'curl'

Checking DOIs failed with message:
 ? there is no package called 'curl'

Cory

On 4/2/25 20:28, Nicholas Tierney wrote:
> Could you potentially look for the original website in the internet 
> archive / wayback machine: https://web.archive.org/ and cite that instead?
>
> On Thu, 3 Apr 2025 at 08:42, Duncan Murdoch <murdoch.duncan at gmail.com> 
> wrote:
>
>     On 2025-04-02 1:28 p.m., Jason Cory Brunson wrote:
>     > Hello,
>     >
>     > I'm trying to submit a new version of a package to CRAN. Among the
>     > additions is an RMarkdown vignette that uses data from a website
>     that is
>     > no longer active. For completeness, i'd still like to cite the
>     invalid
>     > URL, but without formatting it as a hyperlink. What is the
>     preferred way
>     > to do this?
>     >
>     > One StackExchange answer is to surround the URL with
>     <span></span>, but
>     > this did not remove the hyperlink when i rendered the vignette
>     locally.
>     > Instead, i surrounded it with back-ticks, which works locally,
>     but i've
>     > been unable to run Win-Builder checks to see whether this
>     prevents the
>     > "invalid URLs" NOTE. And, even if the NOTE is prevented, i'm not
>     sure
>     > this is preferred.
>
>     Why not leave off the scheme, e.g. "www.r-project.org
>     <http://www.r-project.org>" instead of
>     "https://www.r-project.org".
>
>     Duncan Murdoch
>
>     ______________________________________________
>     R-package-devel at r-project.org mailing list
>     https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From |kry|ov @end|ng |rom d|@root@org  Thu Apr  3 07:54:33 2025
From: |kry|ov @end|ng |rom d|@root@org (Ivan Krylov)
Date: Thu, 3 Apr 2025 08:54:33 +0300
Subject: [R-pkg-devel] proper way to cite an invalid URL
In-Reply-To: <93131639-5472-4fdb-b5af-0091ead580aa@gmail.com>
References: <cc4856a9-3a87-4f9b-a0f1-6ce40b1d5e45@gmail.com>
 <f08930c4-6928-469c-ab27-1773004934ae@gmail.com>
 <CACrL82XTjtTHZRvz4YL2rPRfWvKvFE3rgAsDJSVUKbo2zY4QuA@mail.gmail.com>
 <93131639-5472-4fdb-b5af-0091ead580aa@gmail.com>
Message-ID: <20250403085433.52c99c01@Tarkus>

? Wed, 2 Apr 2025 21:20:19 -0400
Jason Cory Brunson <cornelioid at gmail.com> ?????:

> in case you're curious, www.ibge.Goi?sv.br/

I went looking for links to this domain on the Web, found the link in
the documentation for the 'ripserr' package, and then found what looks
like a domain where the desired page could be found. Could it be

https://www.ibge.gov.br/geociencias/organizacao-do-territorio/estrutura-territorial/15761-areas-dos-municipios.html?edicao=30133&t=acesso-ao-produto

instead of the original link?

https://www.ibge.Goiasv.br/geociencias/organizacao-do-territorio/estrutura-territorial/15761-areas-dos-municipios.html?edicao=30133&t=acesso-ao-produto?

> But i got a new error from Win-Builder (the development version via 
> devtools::check_win_devel() but not the release version via 
> devtools::check_win_release()). It seems to apply to all URLs and
> DOIs, though i did not get it on any previous check:
> 
> Checking URLs failed with message:
>  ? there is no package called 'curl'
> 
> Checking DOIs failed with message:
>  ? there is no package called 'curl'

Looks like Win-Builder for R-devel is having transient problems:
https://www.r-project.org/nosvn/R.check/r-devel-windows-x86_64/curl-00install.html

("ERROR: cannot remove earlier installation, is it in use?", and then
it fails to overwrite libs\x64\curl.dll with "Permission denied".)

-- 
Best regards,
Ivan


From corne||o|d @end|ng |rom gm@||@com  Thu Apr  3 14:34:30 2025
From: corne||o|d @end|ng |rom gm@||@com (Jason Cory Brunson)
Date: Thu, 3 Apr 2025 08:34:30 -0400
Subject: [R-pkg-devel] proper way to cite an invalid URL
In-Reply-To: <20250403085433.52c99c01@Tarkus>
References: <cc4856a9-3a87-4f9b-a0f1-6ce40b1d5e45@gmail.com>
 <f08930c4-6928-469c-ab27-1773004934ae@gmail.com>
 <CACrL82XTjtTHZRvz4YL2rPRfWvKvFE3rgAsDJSVUKbo2zY4QuA@mail.gmail.com>
 <93131639-5472-4fdb-b5af-0091ead580aa@gmail.com>
 <20250403085433.52c99c01@Tarkus>
Message-ID: <038242e6-9bdb-4dac-9088-f6bd2d67ecea@gmail.com>

Ivan, thank you! That seems to be correct. I'll replace the link.

For future reference in answer to the original question, it seems that 
Duncan's suggestion works best, assuming that the 'curl' problem was 
unrelated.

Cory

On 4/3/25 01:54, Ivan Krylov wrote:
> ? Wed, 2 Apr 2025 21:20:19 -0400
> Jason Cory Brunson <cornelioid at gmail.com> ?????:
>
>> in case you're curious, www.ibge.Goi?sv.br/
> I went looking for links to this domain on the Web, found the link in
> the documentation for the 'ripserr' package, and then found what looks
> like a domain where the desired page could be found. Could it be
>
> https://www.ibge.gov.br/geociencias/organizacao-do-territorio/estrutura-territorial/15761-areas-dos-municipios.html?edicao=30133&t=acesso-ao-produto
>
> instead of the original link?
>
> https://www.ibge.Goiasv.br/geociencias/organizacao-do-territorio/estrutura-territorial/15761-areas-dos-municipios.html?edicao=30133&t=acesso-ao-produto?
>
>> But i got a new error from Win-Builder (the development version via
>> devtools::check_win_devel() but not the release version via
>> devtools::check_win_release()). It seems to apply to all URLs and
>> DOIs, though i did not get it on any previous check:
>>
>> Checking URLs failed with message:
>>   ? there is no package called 'curl'
>>
>> Checking DOIs failed with message:
>>   ? there is no package called 'curl'
> Looks like Win-Builder for R-devel is having transient problems:
> https://www.r-project.org/nosvn/R.check/r-devel-windows-x86_64/curl-00install.html
>
> ("ERROR: cannot remove earlier installation, is it in use?", and then
> it fails to overwrite libs\x64\curl.dll with "Permission denied".)
>


From ||@t@ @end|ng |rom dewey@myzen@co@uk  Thu Apr  3 15:49:46 2025
From: ||@t@ @end|ng |rom dewey@myzen@co@uk (Michael Dewey)
Date: Thu, 3 Apr 2025 14:49:46 +0100
Subject: [R-pkg-devel] 
 [My solution] How and where do I document sysdata.rda
In-Reply-To: <6e48e8fa-2e36-4dbc-8fb9-8039e487ab55@dewey.myzen.co.uk>
References: <6e48e8fa-2e36-4dbc-8fb9-8039e487ab55@dewey.myzen.co.uk>
Message-ID: <3f84af97-544e-42d2-932b-35cca7bd6128@dewey.myzen.co.uk>

I promised I would update on this.

I now realise that what I was tryig to do was logically impossible. I 
was trying to hide the data set (achieved) but also hide the 
documentation. That makes no sense as anyone wanting to change the 
dataset would not know where to find the documentation. The probabiliy 
anyone would want to edit it is almost indsitinguishable from zero but 
it is as Charles suggests a good principle.

So the answer is to document it in the usual way and use the keyword 
internal. The main difference from a standard Rd file for data is the 
usage statement. As georgi pointed out this just consists of the dataset 
name not data(datasetname).

Thanks for all your help on this and sorry it took so long to respond.

Michael

On 20/03/2025 14:39, Lists wrote:
> I want to put a look-up table into sysdata.rda to avoid having to 
> compute it everytime. At the moment I create it and save the resulting 
> file and then manually copy it to sysdata.rda. This works but the 
> package now contains no documentation about the look-up table.
> 
> Most of the information which I turned up online involves doing it all 
> indirectly using various packages. I do not want to do that, I am quite 
> happy editing files by hand and moving them to where I want them by 
> hand. So what I need is to know where I should put the documentation and 
> what format it should be assuming it is not an Rd file.
> 
> Of course what I want may be impossible and I just need to document it 
> in the script which creates it but that seems messy.
> 
> Michael Dewey
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel

-- 
Michael Dewey


From r@c@rtwr|ght @end|ng |rom gm@||@com  Sat Apr  5 02:58:25 2025
From: r@c@rtwr|ght @end|ng |rom gm@||@com (Reed A. Cartwright)
Date: Fri, 4 Apr 2025 17:58:25 -0700
Subject: [R-pkg-devel] libc++ and abort function usage
Message-ID: <CALOkxuxkANWVyYeC1JFzVSjRwWG9ae=5CYN1Ze9SBL8jMBTz2g@mail.gmail.com>

I have updated my package, rbedrock [1-2], to remove a bundled
library's calls to abort() and stderr when compiled with -DNDEBUG
(which is the default). This has mostly worked; however, I have
uncovered that libc++ contains inline functions that call abort() if
exceptions are disabled.

My bundled library is a C++ library and is compiled with exceptions
turned off. I use its C-level interface in my package, so its C++ code
is mostly hidden from my package. When compiled on a platform with
libc++, libc++ introduces abort calls into the compiled package. This
is causing `R CMD check` to warn about abort() usage on those
platforms.

I am wondering what people on this list think I should do?

Should I enable exceptions in the bundled library and keep using the
C-level interface? (It doesn't throw any exceptions itself, but std
library calls might.)

If there is any other strategy that I should try, please let me know.

Thanks,
Reed

[1] https://github.com/reedacartwright/rbedrock
[2] https://cran.r-project.org/package=rbedrock
[3] https://github.com/llvm/llvm-project/blob/release/12.x/libcxx/include/any#L107-L116

--
Reed A. Cartwright, PhD
Associate Professor of Life Sciences
TEACh Representative - Evolution and Computational Courses
School of Life Sciences and The Biodesign Institute
Arizona State University
==================
Address: The Biodesign Institute, PO Box 876401, Tempe, AZ 85287-6401 USA
Packages: The Biodesign Institute, 1001 S. McAllister Ave, Tempe, AZ
85287-6401 USA
Office: Biodesign B-220C, 1-480-965-9949
Website: http://cartwrig.ht/


From @h3758 @end|ng |rom drexe|@edu  Sat Apr  5 00:29:40 2025
From: @h3758 @end|ng |rom drexe|@edu (Halder,Aritra)
Date: Fri, 4 Apr 2025 22:29:40 +0000
Subject: [R-pkg-devel] Warnings and notes while building package with nimble
Message-ID: <DM6PR01MB38971146EB7242086206CBDBA2A92@DM6PR01MB3897.prod.exchangelabs.com>

Hi,

I am trying to submit a package to CRAN built using nimble. It generates warnings like so:

: no visible global function definition for  'nimDim'

and fails automatic checks by CRAN. Any help is appreciated.

Thanks and regards,

Aritra

	[[alternative HTML version deleted]]


From p@cm@n|@p@z @end|ng |rom gm@||@com  Sat Apr  5 08:40:56 2025
From: p@cm@n|@p@z @end|ng |rom gm@||@com (Paul Angelo Manlapaz)
Date: Sat, 5 Apr 2025 14:40:56 +0800
Subject: [R-pkg-devel] R Package Submission
Message-ID: <CAB3e68C8KRW4TtHRDhd9-AfVeZisZAaajR3OcmajuciFStebpQ@mail.gmail.com>

Dear Sir / Ma'am,

Greetings.

I am but a newbie in R Package development and currently, I am trying to
submit my second package to CRAN and every time after submission, the
results for the pre-tests come back 'does not pass the incoming checks
automatically'.

The NOTE says;

  Possibly misspelled words in DESCRIPTION:
    ProteinPCA (9:45, 12:19)
    ggplot (12:5)

The name of the package is ProteinPCA and I have already checked multiple
times the Description files for any possible misspellings but I have not
found any. Same goes with ggplot2.

At this moment, I am really at loss on how to resolve this issue. Could you
perhaps enlighten me on this?

Thank you very much.

Sincerely,
*P. A. C. Manlapaz, RCh*

	[[alternative HTML version deleted]]


From ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de  Sat Apr  5 18:30:16 2025
From: ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de (Uwe Ligges)
Date: Sat, 5 Apr 2025 18:30:16 +0200
Subject: [R-pkg-devel] R Package Submission
In-Reply-To: <CAB3e68C8KRW4TtHRDhd9-AfVeZisZAaajR3OcmajuciFStebpQ@mail.gmail.com>
References: <CAB3e68C8KRW4TtHRDhd9-AfVeZisZAaajR3OcmajuciFStebpQ@mail.gmail.com>
Message-ID: <7918ce96-307d-484c-8896-c7738931fcc6@statistik.tu-dortmund.de>

See my response in the communication among you and CRAN.

Best,
Uwe Ligges




On 05.04.2025 08:40, Paul Angelo Manlapaz wrote:
> Dear Sir / Ma'am,
> 
> Greetings.
> 
> I am but a newbie in R Package development and currently, I am trying to
> submit my second package to CRAN and every time after submission, the
> results for the pre-tests come back 'does not pass the incoming checks
> automatically'.
> 
> The NOTE says;
> 
>    Possibly misspelled words in DESCRIPTION:
>      ProteinPCA (9:45, 12:19)
>      ggplot (12:5)
> 
> The name of the package is ProteinPCA and I have already checked multiple
> times the Description files for any possible misspellings but I have not
> found any. Same goes with ggplot2.
> 
> At this moment, I am really at loss on how to resolve this issue. Could you
> perhaps enlighten me on this?
> 
> Thank you very much.
> 
> Sincerely,
> *P. A. C. Manlapaz, RCh*
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From dw|n@em|u@ @end|ng |rom comc@@t@net  Sat Apr  5 23:31:38 2025
From: dw|n@em|u@ @end|ng |rom comc@@t@net (David Winsemius)
Date: Sat, 5 Apr 2025 15:31:38 -0600
Subject: [R-pkg-devel] R Package Submission
In-Reply-To: <CAB3e68C8KRW4TtHRDhd9-AfVeZisZAaajR3OcmajuciFStebpQ@mail.gmail.com>
References: <CAB3e68C8KRW4TtHRDhd9-AfVeZisZAaajR3OcmajuciFStebpQ@mail.gmail.com>
Message-ID: <294AB8A2-A6AE-4C15-8789-0F9CE15B5870@comcast.net>

It would be unusual these days to have pkg:ggplot as a dependency. 

? 
David. 
Sent from my iPhone

> On Apr 5, 2025, at 10:28?AM, Paul Angelo Manlapaz <pacmanlapaz at gmail.com> wrote:
> 
> ?Dear Sir / Ma'am,
> 
> Greetings.
> 
> I am but a newbie in R Package development and currently, I am trying to
> submit my second package to CRAN and every time after submission, the
> results for the pre-tests come back 'does not pass the incoming checks
> automatically'.
> 
> The NOTE says;
> 
>  Possibly misspelled words in DESCRIPTION:
>    ProteinPCA (9:45, 12:19)
>    ggplot (12:5)
> 
> The name of the package is ProteinPCA and I have already checked multiple
> times the Description files for any possible misspellings but I have not
> found any. Same goes with ggplot2.
> 
> At this moment, I am really at loss on how to resolve this issue. Could you
> perhaps enlighten me on this?
> 
> Thank you very much.
> 
> Sincerely,
> *P. A. C. Manlapaz, RCh*
> 
>    [[alternative HTML version deleted]]
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From ||u|@@rev|||@ @end|ng |rom gm@||@com  Sun Apr  6 01:25:09 2025
From: ||u|@@rev|||@ @end|ng |rom gm@||@com (=?UTF-8?Q?Llu=C3=ADs_Revilla?=)
Date: Sun, 6 Apr 2025 01:25:09 +0200
Subject: [R-pkg-devel] 
 Warnings and notes while building package with nimble
In-Reply-To: <DM6PR01MB38971146EB7242086206CBDBA2A92@DM6PR01MB3897.prod.exchangelabs.com>
References: <DM6PR01MB38971146EB7242086206CBDBA2A92@DM6PR01MB3897.prod.exchangelabs.com>
Message-ID: <CAN+W6_uVKhYy=Vz8oboRfGsHUMm8rLPcaN27tfYQ9F75Lx3-AA@mail.gmail.com>

Hi Aritra,

It would be helpful if we can explore the package source code. It helps to
provide a more accurate answer.

But you will find some other cases on the archive of the mailing list with
similar messages.
The message indicates that the static code analyzer hasn't detected the
definition of the object but detected it is used.
This is often the case if you use subset, within or dplyr, ggplot2,
data.table or other packages that use delayed evaluation.
To solve it, it might be as simple as writing nimDim <- NULL inside your
package or there might be a real issue there.

Best,

Llu?s

On Sat, 5 Apr 2025 at 18:25, Halder,Aritra <ah3758 at drexel.edu> wrote:

> Hi,
>
> I am trying to submit a package to CRAN built using nimble. It generates
> warnings like so:
>
> : no visible global function definition for  'nimDim'
>
> and fails automatic checks by CRAN. Any help is appreciated.
>
> Thanks and regards,
>
> Aritra
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From edd @end|ng |rom deb|@n@org  Sun Apr  6 01:31:54 2025
From: edd @end|ng |rom deb|@n@org (Dirk Eddelbuettel)
Date: Sat, 5 Apr 2025 18:31:54 -0500
Subject: [R-pkg-devel] 
 Warnings and notes while building package with nimble
In-Reply-To: <CAN+W6_uVKhYy=Vz8oboRfGsHUMm8rLPcaN27tfYQ9F75Lx3-AA@mail.gmail.com>
References: <DM6PR01MB38971146EB7242086206CBDBA2A92@DM6PR01MB3897.prod.exchangelabs.com>
 <CAN+W6_uVKhYy=Vz8oboRfGsHUMm8rLPcaN27tfYQ9F75Lx3-AA@mail.gmail.com>
Message-ID: <26609.48490.450936.846033@rob.eddelbuettel.com>


On 6 April 2025 at 01:25, Llu?s Revilla wrote:
| To solve it, it might be as simple as writing nimDim <- NULL inside your
| package or there might be a real issue there.

Or call utils::globalVariables(c("nimDim")) where, if needed, you could add
to that argument vector any other variables listed as global. 

Cheers, Dirk

-- 
dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From chr|@@br|en @end|ng |rom @de|@|de@edu@@u  Sun Apr  6 10:08:15 2025
From: chr|@@br|en @end|ng |rom @de|@|de@edu@@u (Chris Brien)
Date: Sun, 6 Apr 2025 08:08:15 +0000
Subject: [R-pkg-devel] Unreproducible error for CRAN submission on
 winbuilder using r-devel
Message-ID: <ME4P282MB1287D439FBAC309EC438D30EA0AB2@ME4P282MB1287.AUSP282.PROD.OUTLOOK.COM>

Hi all,

I submitted my package asremlPlus 4.4.47 to CRAN on Thurs 3/04/2025 and it generated an Error (and a NOTE) on Winbuilder using R version 4.5.0 RC (2025-04-04 r88102 ucrt):

package asremlPlus_4.4.47.tar.gz does not pass the incoming checks automatically, please see the following pre-tests (additional issue checks):
Windows: <https://win-builder.r-project.org/incoming_pretest/asremlPlus_4.4.47_20250403_120518/Windows/00check.log<https://win-builder.r-project.org/incoming_pretest/asremlPlus_4.4.47_20250403_120518/Windows/00check.log>>
Status: 1 ERROR, 1 NOTE

I ran R CMD check on the package using r-devel r88102 and was unable to generate the ERROR.

So, I submitted the package to Winbuilder r-devel and the package does not generate an error using R version 4.5.0 RC (2025-04-04 r88112 ucrt) - see https://win-builder.r-project.org/Ht2zyDE9N1Xx/00check.log.

Can I assume that the error was transitory and resubmit my package to CRAN?

Cheers,

 Chris



	[[alternative HTML version deleted]]


From ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de  Sun Apr  6 13:08:10 2025
From: ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de (Uwe Ligges)
Date: Sun, 6 Apr 2025 13:08:10 +0200
Subject: [R-pkg-devel] Unreproducible error for CRAN submission on
 winbuilder using r-devel
In-Reply-To: <ME4P282MB1287D439FBAC309EC438D30EA0AB2@ME4P282MB1287.AUSP282.PROD.OUTLOOK.COM>
References: <ME4P282MB1287D439FBAC309EC438D30EA0AB2@ME4P282MB1287.AUSP282.PROD.OUTLOOK.COM>
Message-ID: <421d4aaa-571d-40a6-a4cf-3fe773d5d0b0@statistik.tu-dortmund.de>

This is on so far strange as the winbuilder service and the CRAN 
incoming check happen actually on the same machine, same library and 
same version of R.

If this is not related to some randomness in generating your data, 
please simply resubmit.

Best,
Uwe Ligges




On 06.04.2025 10:08, Chris Brien wrote:
> Hi all,
> 
> I submitted my package asremlPlus 4.4.47 to CRAN on Thurs 3/04/2025 and it generated an Error (and a NOTE) on Winbuilder using R version 4.5.0 RC (2025-04-04 r88102 ucrt):
> 
> package asremlPlus_4.4.47.tar.gz does not pass the incoming checks automatically, please see the following pre-tests (additional issue checks):
> Windows: <https://win-builder.r-project.org/incoming_pretest/asremlPlus_4.4.47_20250403_120518/Windows/00check.log<https://win-builder.r-project.org/incoming_pretest/asremlPlus_4.4.47_20250403_120518/Windows/00check.log>>
> Status: 1 ERROR, 1 NOTE
> 
> I ran R CMD check on the package using r-devel r88102 and was unable to generate the ERROR.
> 
> So, I submitted the package to Winbuilder r-devel and the package does not generate an error using R version 4.5.0 RC (2025-04-04 r88112 ucrt) - see https://win-builder.r-project.org/Ht2zyDE9N1Xx/00check.log.
> 
> Can I assume that the error was transitory and resubmit my package to CRAN?
> 
> Cheers,
> 
>   Chris
> 
> 
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From murdoch@dunc@n @end|ng |rom gm@||@com  Sun Apr  6 15:33:19 2025
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Sun, 6 Apr 2025 09:33:19 -0400
Subject: [R-pkg-devel] Unreproducible error for CRAN submission on
 winbuilder using r-devel
In-Reply-To: <ME4P282MB1287D439FBAC309EC438D30EA0AB2@ME4P282MB1287.AUSP282.PROD.OUTLOOK.COM>
References: <ME4P282MB1287D439FBAC309EC438D30EA0AB2@ME4P282MB1287.AUSP282.PROD.OUTLOOK.COM>
Message-ID: <b29b0479-9569-440c-80f3-1558354aa7b9@gmail.com>

On 2025-04-06 4:08 a.m., Chris Brien wrote:
> Hi all,
> 
> I submitted my package asremlPlus 4.4.47 to CRAN on Thurs 3/04/2025 and it generated an Error (and a NOTE) on Winbuilder using R version 4.5.0 RC (2025-04-04 r88102 ucrt):
> 
> package asremlPlus_4.4.47.tar.gz does not pass the incoming checks automatically, please see the following pre-tests (additional issue checks):
> Windows: <https://win-builder.r-project.org/incoming_pretest/asremlPlus_4.4.47_20250403_120518/Windows/00check.log<https://win-builder.r-project.org/incoming_pretest/asremlPlus_4.4.47_20250403_120518/Windows/00check.log>>
> Status: 1 ERROR, 1 NOTE
> 
> I ran R CMD check on the package using r-devel r88102 and was unable to generate the ERROR.
> 
> So, I submitted the package to Winbuilder r-devel and the package does not generate an error using R version 4.5.0 RC (2025-04-04 r88112 ucrt) - see https://win-builder.r-project.org/Ht2zyDE9N1Xx/00check.log.
> 
> Can I assume that the error was transitory and resubmit my package to CRAN?
> 
> Cheers,

The error was

"Error in pf(q = Fvalue, df1 = ndf, df2 = ddf, lower.tail = FALSE) :
   Non-numeric argument to mathematical function"

That doesn't look like something that would be transitory.  If you are 
working with random data it might be hard to reproduce, but still worth 
worrying about.  Or it could be transitory because some package you're 
using was updated between the two runs, or some weird timing issue 
caused some value to be wrong.

Duncan Murdoch


From chr|@@br|en @end|ng |rom @de|@|de@edu@@u  Mon Apr  7 01:51:45 2025
From: chr|@@br|en @end|ng |rom @de|@|de@edu@@u (Chris Brien)
Date: Sun, 6 Apr 2025 23:51:45 +0000
Subject: [R-pkg-devel] Unreproducible error for CRAN submission on
 winbuilder using r-devel
In-Reply-To: <b29b0479-9569-440c-80f3-1558354aa7b9@gmail.com>
References: <ME4P282MB1287D439FBAC309EC438D30EA0AB2@ME4P282MB1287.AUSP282.PROD.OUTLOOK.COM>
 <b29b0479-9569-440c-80f3-1558354aa7b9@gmail.com>
Message-ID: <ME4P282MB12875D91379E8866C17C7AD7A0AB2@ME4P282MB1287.AUSP282.PROD.OUTLOOK.COM>

Hi Duncan,

Thanks for your comments.

"Error in pf(q = Fvalue, df1 = ndf, df2 = ddf, lower.tail = FALSE) :
Non-numeric argument to mathematical function"
Indeed, and the problem arises from a call to the anova function of lmerTest whose latest versions is 2020-10-23.


That doesn't look like something that would be transitory. If you are
working with random data it might be hard to reproduce, but still worth
worrying about. Or it could be transitory because some package you're
using was updated between the two runs, or some weird timing issue
caused some value to be wrong.

The data is a data set from asremlplus called Oat.dat, so not random at all.

It seems that the most likely explanation is that it is some weird transitory issue on the CRAN incoming check that caused some value to be wrong.

Anyway, asremlPlus has now been resubmitted and is on its way to CRAN.

Cheers,

 Chris



From: Duncan Murdoch <murdoch.duncan at gmail.com>
Sent: Sunday, 6 April 2025 11:03 PM
To: Chris Brien <chris.brien at adelaide.edu.au>; r-package-devel at r-project.org
Subject: Re: [R-pkg-devel] Unreproducible error for CRAN submission on winbuilder using r-devel

On 2025-04-06 4:08 a.m., Chris Brien wrote:
> Hi all,
>
> I submitted my package asremlPlus 4.4.47 to CRAN on Thurs 3/04/2025 and it generated an Error (and a NOTE) on Winbuilder using R version 4.5.0 RC (2025-04-04 r88102 ucrt):
>
> package asremlPlus_4.4.47.tar.gz does not pass the incoming checks automatically, please see the following pre-tests (additional issue checks):
> Windows: <https://win-builder.r-project.org/incoming_pretest/asremlPlus_4.4.47_20250403_120518/Windows/00check.log<https://win-builder.r-project.org/incoming_pretest/asremlPlus_4.4.47_20250403_120518/Windows/00check.log><https://win-builder.r-project.org/incoming_pretest/asremlPlus_4.4.47_20250403_120518/Windows/00check.log<https://win-builder.r-project.org/incoming_pretest/asremlPlus_4.4.47_20250403_120518/Windows/00check.log>>>
> Status: 1 ERROR, 1 NOTE
>
> I ran R CMD check on the package using r-devel r88102 and was unable to generate the ERROR.
>
> So, I submitted the package to Winbuilder r-devel and the package does not generate an error using R version 4.5.0 RC (2025-04-04 r88112 ucrt) - see https://win-builder.r-project.org/Ht2zyDE9N1Xx/00check.log<https://win-builder.r-project.org/Ht2zyDE9N1Xx/00check.log>.
>
> Can I assume that the error was transitory and resubmit my package to CRAN?
>
> Cheers,

The error was

"Error in pf(q = Fvalue, df1 = ndf, df2 = ddf, lower.tail = FALSE) :
Non-numeric argument to mathematical function"

That doesn't look like something that would be transitory. If you are
working with random data it might be hard to reproduce, but still worth
worrying about. Or it could be transitory because some package you're
using was updated between the two runs, or some weird timing issue
caused some value to be wrong.

Duncan Murdoch

	[[alternative HTML version deleted]]


From ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de  Mon Apr  7 10:24:13 2025
From: ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de (Uwe Ligges)
Date: Mon, 7 Apr 2025 10:24:13 +0200
Subject: [R-pkg-devel] 
 Warnings and notes while building package with nimble
In-Reply-To: <DM6PR01MB38971146EB7242086206CBDBA2A92@DM6PR01MB3897.prod.exchangelabs.com>
References: <DM6PR01MB38971146EB7242086206CBDBA2A92@DM6PR01MB3897.prod.exchangelabs.com>
Message-ID: <d0bf0977-d98b-4ba4-b161-8b6d7d730ff0@statistik.tu-dortmund.de>



On 05.04.2025 00:29, Halder,Aritra wrote:
> Hi,
> 
> I am trying to submit a package to CRAN built using nimble. It generates warnings like so:

Which package?


> : no visible global function definition for  'nimDim'

and you have not forgot to import nlmDim()?

Best,
Uwe Ligges






> and fails automatic checks by CRAN. Any help is appreciated.
> 
> Thanks and regards,
> 
> Aritra
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From kev|n@r@coombe@ @end|ng |rom gm@||@com  Mon Apr  7 17:10:21 2025
From: kev|n@r@coombe@ @end|ng |rom gm@||@com (Kevin R. Coombes)
Date: Mon, 7 Apr 2025 11:10:21 -0400
Subject: [R-pkg-devel] URLs in DESCRIPTION file
Message-ID: <412dd1c9-85e9-4786-b20d-109af5c96fc8@gmail.com>

Hi,

I am systematically going through the packages that I maintain on CRAN 
to clean up some administrative details. Specifically, I am (1) changing 
all DESCRIPTION files to use Authirs at R, (2) updating the links in man 
files to include package anchors, and (3) making sure that the output of 
calls to summary in test scripts don't break (i.e., mismatch the saved 
test output) in the 4.5.0 release candidate.

Not surprisingly, this process also finds other issues. Right now,I am 
looking at the package BimodalIndex. The version currently on CRAN (v. 
1.1.9) includes the following URL:
 ??? https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2730180/
On first checking the package, I get informed that this URL has 
"permanently moved" to:
 ??? https://pmc.ncbi.nlm.nih.gov/articles/PMC2730180/

The fix seems simple, so I edited the DESCRIPTION file to use the new 
URL instead of the old one. Then I submitted the newly built version 
(1.1.11) to both the current release and the development release at 
winbuilder before submitting the update to CRAN.? R version 4.4.3 comes 
back with a 00check.log that is absolutely "OK". No errors, warnings, or 
notes. But version R 4.5.0 RC comes back with;
 ??? (possibly) invalid URL. Status: 403? Message: Forbidden
I copied the URL as reported in the error message, pasted it into my 
browser, and it worked just fine.

Can I assume that this is just something weird about the corresponding 
winbuilder server at the moment, and go ahead and submit the package? Or 
is there some mysterious change in R 4.5 lurking somewhere that I need 
to deal with?

Thanks,
 ?? Kevin


From |kry|ov @end|ng |rom d|@root@org  Mon Apr  7 17:35:35 2025
From: |kry|ov @end|ng |rom d|@root@org (Ivan Krylov)
Date: Mon, 7 Apr 2025 18:35:35 +0300
Subject: [R-pkg-devel] URLs in DESCRIPTION file
In-Reply-To: <412dd1c9-85e9-4786-b20d-109af5c96fc8@gmail.com>
References: <412dd1c9-85e9-4786-b20d-109af5c96fc8@gmail.com>
Message-ID: <20250407183535.2f11ab7f@arachnoid>

? Mon, 7 Apr 2025 11:10:21 -0400
"Kevin R. Coombes" <kevin.r.coombes at gmail.com> ?????:

> But version R 4.5.0 RC comes back with;
>  ??? (possibly) invalid URL. Status: 403? Message: Forbidden
> I copied the URL as reported in the error message, pasted it into my 
> browser, and it worked just fine.
> 
> Can I assume that this is just something weird about the
> corresponding winbuilder server at the moment, and go ahead and
> submit the package?

This is a false positive. R CMD check sends automated requests to all
URLs it finds in the package. PubMed "protects" itself from automated
requests and returns an error code:

$ curl -I https://pmc.ncbi.nlm.nih.gov/articles/PMC2730180/
HTTP/2 403
content-length: 134
content-type: text/html; charset=UTF-8
date: Mon, 07 Apr 2025 15:14:59 GMT
alt-svc: clear

Using a browser instead results in subtly different behaviour visible
to the server, so the page loads successfully when clicking a link.

I see you're already linking to the article's DOI, 10.4137/cin.s2846,
and the article is not paywalled. Is it an option to remove the PubMed
link? There is code that is intended to recommend to only use the DOI,
but currently doesn't include a pattern for the new PubMed URLs:

if(length(y) &&
         any(ind <-
           (grepl(re_or(c("^https://pubmed.ncbi.nlm.nih.gov/[0-9]+",
              "^https://www.ncbi.nlm.nih.gov/pmc/articles/PMC[0-9]+/$",
              "^https://academic.oup.com/.*(/[0-9]*){4}$",
              "^https://www.sciencedirect.com/science/article")),
            y$URL)))) {
    ## <FIXME>
    ## Ideally we would complain about such URLs in general
    ## and not only when the URL checks were not OK.
    paste(c("Please use DOIs for the following publisher URLs:",
            paste0("  ", y$URL[ind])),
          collapse = "\n")
    ## </FIXME>
}

If you don't want to remove the PubMed link, you can explain the
"possibly invalid URL" as a false positive in the submission comment.

-- 
Best regards,
Ivan


From kev|n@r@coombe@ @end|ng |rom gm@||@com  Mon Apr  7 17:52:30 2025
From: kev|n@r@coombe@ @end|ng |rom gm@||@com (Kevin R. Coombes)
Date: Mon, 7 Apr 2025 11:52:30 -0400
Subject: [R-pkg-devel] URLs in DESCRIPTION file
In-Reply-To: <20250407183535.2f11ab7f@arachnoid>
References: <412dd1c9-85e9-4786-b20d-109af5c96fc8@gmail.com>
 <20250407183535.2f11ab7f@arachnoid>
Message-ID: <7a26a6a4-8501-44bf-baad-13885ed1a305@gmail.com>

Thanks. That's what I thought (though I was somewhat confused by the 
different behaviors of winbuilder on the current and development 
versions). I think the original DESCRIPTION file (from 2017?) just had 
the URL. Some time after that, CRAN asked for the inclusion of the DOI, 
but they didn't say to get rid of the URL. The code itself hasn't been 
touched since at least 2019 (since it still works exactly the way it is 
supposed to.)

And, becauseI have been both finding and losing things on the Internet 
for several decades, I am not particularly confident that the DOI is 
going to have a significantly longer stable lifetime than the NCBI URL. 
So, for now at least, I think I will leave them both.

Best,
 ?? Kevin

On 4/7/2025 11:35 AM, Ivan Krylov wrote:
> ? Mon, 7 Apr 2025 11:10:21 -0400
> "Kevin R. Coombes" <kevin.r.coombes at gmail.com> ?????:
>
>> But version R 4.5.0 RC comes back with;
>>   ??? (possibly) invalid URL. Status: 403? Message: Forbidden
>> I copied the URL as reported in the error message, pasted it into my
>> browser, and it worked just fine.
>>
>> Can I assume that this is just something weird about the
>> corresponding winbuilder server at the moment, and go ahead and
>> submit the package?
> This is a false positive. R CMD check sends automated requests to all
> URLs it finds in the package. PubMed "protects" itself from automated
> requests and returns an error code:
>
> $ curl -I https://pmc.ncbi.nlm.nih.gov/articles/PMC2730180/
> HTTP/2 403
> content-length: 134
> content-type: text/html; charset=UTF-8
> date: Mon, 07 Apr 2025 15:14:59 GMT
> alt-svc: clear
>
> Using a browser instead results in subtly different behaviour visible
> to the server, so the page loads successfully when clicking a link.
>
> I see you're already linking to the article's DOI, 10.4137/cin.s2846,
> and the article is not paywalled. Is it an option to remove the PubMed
> link? There is code that is intended to recommend to only use the DOI,
> but currently doesn't include a pattern for the new PubMed URLs:
>
> if(length(y) &&
>           any(ind <-
>             (grepl(re_or(c("^https://pubmed.ncbi.nlm.nih.gov/[0-9]+",
>                "^https://www.ncbi.nlm.nih.gov/pmc/articles/PMC[0-9]+/$",
>                "^https://academic.oup.com/.*(/[0-9]*){4}$",
>                "^https://www.sciencedirect.com/science/article")),
>              y$URL)))) {
>      ## <FIXME>
>      ## Ideally we would complain about such URLs in general
>      ## and not only when the URL checks were not OK.
>      paste(c("Please use DOIs for the following publisher URLs:",
>              paste0("  ", y$URL[ind])),
>            collapse = "\n")
>      ## </FIXME>
> }
>
> If you don't want to remove the PubMed link, you can explain the
> "possibly invalid URL" as a false positive in the submission comment.
>


From kev|nu@hey @end|ng |rom gm@||@com  Mon Apr  7 18:18:29 2025
From: kev|nu@hey @end|ng |rom gm@||@com (Kevin Ushey)
Date: Mon, 7 Apr 2025 09:18:29 -0700
Subject: [R-pkg-devel] libc++ and abort function usage
In-Reply-To: <CALOkxuxkANWVyYeC1JFzVSjRwWG9ae=5CYN1Ze9SBL8jMBTz2g@mail.gmail.com>
References: <CALOkxuxkANWVyYeC1JFzVSjRwWG9ae=5CYN1Ze9SBL8jMBTz2g@mail.gmail.com>
Message-ID: <CAJXgQP1N6qEKHBxRFnRZN593ycGq-WoZ=cu_eGkUiaRn2KMiCg@mail.gmail.com>

Hi Reed,

Unfortunately I don't think there is any other strategy here -- I
would agree that your best bet is to just enable exceptions in the
bundled library.

Best,
Kevin

On Fri, Apr 4, 2025 at 5:59?PM Reed A. Cartwright
<racartwright at gmail.com> wrote:
>
> I have updated my package, rbedrock [1-2], to remove a bundled
> library's calls to abort() and stderr when compiled with -DNDEBUG
> (which is the default). This has mostly worked; however, I have
> uncovered that libc++ contains inline functions that call abort() if
> exceptions are disabled.
>
> My bundled library is a C++ library and is compiled with exceptions
> turned off. I use its C-level interface in my package, so its C++ code
> is mostly hidden from my package. When compiled on a platform with
> libc++, libc++ introduces abort calls into the compiled package. This
> is causing `R CMD check` to warn about abort() usage on those
> platforms.
>
> I am wondering what people on this list think I should do?
>
> Should I enable exceptions in the bundled library and keep using the
> C-level interface? (It doesn't throw any exceptions itself, but std
> library calls might.)
>
> If there is any other strategy that I should try, please let me know.
>
> Thanks,
> Reed
>
> [1] https://github.com/reedacartwright/rbedrock
> [2] https://cran.r-project.org/package=rbedrock
> [3] https://github.com/llvm/llvm-project/blob/release/12.x/libcxx/include/any#L107-L116
>
> --
> Reed A. Cartwright, PhD
> Associate Professor of Life Sciences
> TEACh Representative - Evolution and Computational Courses
> School of Life Sciences and The Biodesign Institute
> Arizona State University
> ==================
> Address: The Biodesign Institute, PO Box 876401, Tempe, AZ 85287-6401 USA
> Packages: The Biodesign Institute, 1001 S. McAllister Ave, Tempe, AZ
> 85287-6401 USA
> Office: Biodesign B-220C, 1-480-965-9949
> Website: http://cartwrig.ht/
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From ch@r|e@-||@te@+rd @end|ng |rom p|e@@y@org  Tue Apr  8 06:49:29 2025
From: ch@r|e@-||@te@+rd @end|ng |rom p|e@@y@org (Charles Plessy)
Date: Tue, 8 Apr 2025 13:49:29 +0900
Subject: [R-pkg-devel] URLs in DESCRIPTION file
In-Reply-To: <20250407183535.2f11ab7f@arachnoid>
References: <412dd1c9-85e9-4786-b20d-109af5c96fc8@gmail.com>
 <20250407183535.2f11ab7f@arachnoid>
Message-ID: <Z_Sq2XEUnVi20Z6x@kumo.plessy.net>

Le Mon, Apr 07, 2025 at 06:35:35PM +0300, Ivan Krylov via R-package-devel a ?crit :
> 
> PubMed "protects" itself from automated requests and returns an error code:
> 
> $ curl -I https://pmc.ncbi.nlm.nih.gov/articles/PMC2730180/
> HTTP/2 403

Quick minor correction: this is PubMed Central, not PubMed.

A PubMed URL to the same article would work:

curl -I https://pubmed.ncbi.nlm.nih.gov/19718451/
HTTP/2 200 

Have a nice day,

Charles Plessy


From pro|jcn@@h @end|ng |rom gm@||@com  Thu Apr 10 01:52:05 2025
From: pro|jcn@@h @end|ng |rom gm@||@com (J C Nash)
Date: Wed, 9 Apr 2025 19:52:05 -0400
Subject: [R-pkg-devel] Procedure for dealing with reverse dependency that
 has gone bad on CRAN version of my package
Message-ID: <f9d824ef-2e0c-4d50-b754-e2b24849a5b7@gmail.com>

In correcting a minor bug in the optimx package, I submitted a new version today.
The existing CRAN version (2024-12.2) has all CRAN checks OK, and to my knowledge
no notifications of bugs. The new version has hit a FAIL with package phenofit revdep.
Wanting to have output from a "working" system, I (re-)installed the CRAN version
of optimx and ran R CMD check on phenofit, and also get the FAIL on one of its tests.

The failure is a solve error (singularity) in the called minimizer nlminb, so could be
a result of some alteration in something like the matrix routines. I've also seen
changes in tests due to use of M1 and similar processors, relaxed IEEE arithmetic
being the cause. Such differences in outcome are not really a surprise, but can
be a nuisance.

My query is how to proceed to resolve this situation. Since my existing package --
which was supposedly OK back in December -- also throws the test failure in phenofit,
I've no path to reverse changes in my code. It's also possible there's no error
in phenofit, just a test case that now trips up when it did not prior to some
external change.

Still, some resolution is needed, and it would be good to avoid too much fuss.

John Nash


From ph||||p@j@rrett1 @end|ng |rom gm@||@com  Thu Apr 10 01:57:36 2025
From: ph||||p@j@rrett1 @end|ng |rom gm@||@com (Jarrett Phillips)
Date: Wed, 9 Apr 2025 19:57:36 -0400
Subject: [R-pkg-devel] Lost Braces in R Markdown File
Message-ID: <CAMVrHdB1MD09exeXi1OLC7-fE7y2VEH0GW2wbEsR6gTw_efvBg@mail.gmail.com>

Hello!

I recently ran R CMD CHECK via devtools::check_built() on my CRAN package
'VLF'. See: https://cran.r-project.org/web/checks/check_results_VLF.html.

The notes I received pertain to the below, but I am unsure exactly how to
resolve the issue after googling a bit. Any ideas?

Thanks.

Cheers,

Jarrett

-----

Version: 1.1
Check: Rd files
Result: NOTE
  checkRd: (-1) aminoAcidFun.Rd:37: Lost braces
      37 | \item{ownVLFreduced}{ownVLFMatrix}{A matrix containing only
those specimen that have VLFs as well as the amino     acids at the
positions that contain VLFs and NAs in all other positions of the
sequence.  Only appears if own is not NULL.}
         |                                   ^
  checkRd: (-1) vlfFun.Rd:36: Lost braces
      36 | \item{ownVLFreduced}{ownVLFMatrix}{A matrix containing only
those specimen that have VLFs as well as the     nucleotides at the
positions that contain VLFs and NAs in all other positions of the
sequence.  Only appears if own is not NULL.}
         |

	[[alternative HTML version deleted]]


From murdoch@dunc@n @end|ng |rom gm@||@com  Thu Apr 10 04:41:07 2025
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Wed, 9 Apr 2025 22:41:07 -0400
Subject: [R-pkg-devel] Lost Braces in R Markdown File
In-Reply-To: <CAMVrHdB1MD09exeXi1OLC7-fE7y2VEH0GW2wbEsR6gTw_efvBg@mail.gmail.com>
References: <CAMVrHdB1MD09exeXi1OLC7-fE7y2VEH0GW2wbEsR6gTw_efvBg@mail.gmail.com>
Message-ID: <455645f1-3bc7-4da2-a9a8-47e49aa72906@gmail.com>

[I sent this only to Jarrett on my first attempt, this was meant to go 
to the list.]

The syntax for the \item macro has two arguments, so the text "A matrix
containing only those specimen that have ..." is in braces that are
unnecessary.  That's why you got the note, because check thinks that was
unintentional and wanted to point it out to you.  It's legal, so it's
not an error, just a note.

If I look at the display of the help page ?aminoAcidFun, I think it's
right that something is wrong.  The formatting near the end of the Value
section looks messed up.

Duncan Murdoch



On 2025-04-09 7:57 p.m., Jarrett Phillips wrote:
> Hello!
> 
> I recently ran R CMD CHECK via devtools::check_built() on my CRAN package
> 'VLF'. See: https://cran.r-project.org/web/checks/check_results_VLF.html.
> 
> The notes I received pertain to the below, but I am unsure exactly how to
> resolve the issue after googling a bit. Any ideas?
> 
> Thanks.
> 
> Cheers,
> 
> Jarrett
> 
> -----
> 
> Version: 1.1
> Check: Rd files
> Result: NOTE
>    checkRd: (-1) aminoAcidFun.Rd:37: Lost braces
>        37 | \item{ownVLFreduced}{ownVLFMatrix}{A matrix containing only
> those specimen that have VLFs as well as the amino     acids at the
> positions that contain VLFs and NAs in all other positions of the
> sequence.  Only appears if own is not NULL.}
>           |                                   ^
>    checkRd: (-1) vlfFun.Rd:36: Lost braces
>        36 | \item{ownVLFreduced}{ownVLFMatrix}{A matrix containing only
> those specimen that have VLFs as well as the     nucleotides at the
> positions that contain VLFs and NAs in all other positions of the
> sequence.  Only appears if own is not NULL.}
>           |
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From em@nue|e@cord@no @end|ng |rom gm@||@com  Thu Apr 10 11:24:31 2025
From: em@nue|e@cord@no @end|ng |rom gm@||@com (Emanuele Cordano)
Date: Thu, 10 Apr 2025 11:24:31 +0200
Subject: [R-pkg-devel] broken or outdaeted URLs
Message-ID: <CAKw81f_UYBRk8tvyF7B3UysvrXU3jY86PLwiHEWWsePeAZuStg@mail.gmail.com>

Dear all,

I'm submitting a new version of a package created and published on CRAN
since 2011. I'm the maintainer. CRAN checks highlight the presence of some
URLs link in the documentation that can be broken or outdated and CRAN
asked me to fix them. I'm fixing them following the list set by CRAN and
win-builder services.  Is there an option in R CMD check that I can use on
my server to directly verify all URLs and fix them on my server / RStudio
server?

Thank you
Best
Emanuele Cordano

-- 
Emanuele Cordano, PhD
Environmental Engineer / Ingegnere per l' Ambiente e il territorio nr.
3587 (Albo A - Provincia di Trento)
cell: +39 3282818564
email: emanuele.cordano at gmail.com,emanuele.cordano at rendena100.eu,
emanuele.cordano at eurac.edu
PEC: emanuele.cordano at ingpec.eu
URL: www.rendena100.eu
LinkedIn: https://www.linkedin.com/in/emanuele-cordano-31995333
GitHub: https://github.com/ecor

	[[alternative HTML version deleted]]


From @d@mhsp@rks m@iii@g oii tut@@com  Thu Apr 10 12:40:15 2025
From: @d@mhsp@rks m@iii@g oii tut@@com (@d@mhsp@rks m@iii@g oii tut@@com)
Date: Thu, 10 Apr 2025 12:40:15 +0200 (CEST)
Subject: [R-pkg-devel] broken or outdaeted URLs
In-Reply-To: <CAKw81f_UYBRk8tvyF7B3UysvrXU3jY86PLwiHEWWsePeAZuStg@mail.gmail.com>
References: <CAKw81f_UYBRk8tvyF7B3UysvrXU3jY86PLwiHEWWsePeAZuStg@mail.gmail.com>
Message-ID: <ONUH3zQ--J-9@tuta.com>

Hi Emanuele,
I usually use `urlchecker::url_check()` to start with. There is a `urlchecker::url_update()` option in the package as well. The check catches the errors, the update can fix some but not all errors.

--
best,
Adam
10 Apr 2025 at 17:25 by emanuele.cordano at gmail.com:

> Dear all,
>
> I'm submitting a new version of a package created and published on CRAN
> since 2011. I'm the maintainer. CRAN checks highlight the presence of some
> URLs link in the documentation that can be broken or outdated and CRAN
> asked me to fix them. I'm fixing them following the list set by CRAN and
> win-builder services.  Is there an option in R CMD check that I can use on
> my server to directly verify all URLs and fix them on my server / RStudio
> server?
>
> Thank you
> Best
> Emanuele Cordano
>
> --
> Emanuele Cordano, PhD
> Environmental Engineer / Ingegnere per l' Ambiente e il territorio nr.
> 3587 (Albo A - Provincia di Trento)
> cell: +39 3282818564
> email: emanuele.cordano at gmail.com,emanuele.cordano at rendena100.eu,
> emanuele.cordano at eurac.edu
> PEC: emanuele.cordano at ingpec.eu
> URL: www.rendena100.eu
> LinkedIn: https://www.linkedin.com/in/emanuele-cordano-31995333
> GitHub: https://github.com/ecor
>
> [[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


	[[alternative HTML version deleted]]


From |kry|ov @end|ng |rom d|@root@org  Thu Apr 10 12:52:08 2025
From: |kry|ov @end|ng |rom d|@root@org (Ivan Krylov)
Date: Thu, 10 Apr 2025 13:52:08 +0300
Subject: [R-pkg-devel] broken or outdaeted URLs
In-Reply-To: <CAKw81f_UYBRk8tvyF7B3UysvrXU3jY86PLwiHEWWsePeAZuStg@mail.gmail.com>
References: <CAKw81f_UYBRk8tvyF7B3UysvrXU3jY86PLwiHEWWsePeAZuStg@mail.gmail.com>
Message-ID: <20250410135208.157697c6@arachnoid>

? Thu, 10 Apr 2025 11:24:31 +0200
Emanuele Cordano <emanuele.cordano at gmail.com> ?????:

> Is there an option in R CMD check that I can use on
> my server to directly verify all URLs

Does R CMD check --as-cran help?

-- 
Best regards,
Ivan


From pro|jcn@@h @end|ng |rom gm@||@com  Thu Apr 10 13:47:51 2025
From: pro|jcn@@h @end|ng |rom gm@||@com (J C Nash)
Date: Thu, 10 Apr 2025 07:47:51 -0400
Subject: [R-pkg-devel] 
 Procedure for dealing with reverse dependency that
 has gone bad on CRAN version of my package
In-Reply-To: <f9d824ef-2e0c-4d50-b754-e2b24849a5b7@gmail.com>
References: <f9d824ef-2e0c-4d50-b754-e2b24849a5b7@gmail.com>
Message-ID: <7f2cda3e-cb44-41c9-b412-5d41201ad16f@gmail.com>


I've had an email from CRAN team that the revdep failure with phenofit is a known issue and
updated optimx package (fixing glitch in computing approximate Hessian when objective uses dot args)
is on its way to CRAN.

John Nash


From r@k||||ck @end|ng |rom |@nc@@ter@@c@uk  Fri Apr 11 18:00:16 2025
From: r@k||||ck @end|ng |rom |@nc@@ter@@c@uk (Killick, Rebecca)
Date: Fri, 11 Apr 2025 16:00:16 +0000
Subject: [R-pkg-devel] \linkS4class anchoring
In-Reply-To: <LNXP265MB1564D9993DE64BAFF2F4B957A8B72@LNXP265MB1564.GBRP265.PROD.OUTLOOK.COM>
References: <LNXP265MB1564D9993DE64BAFF2F4B957A8B72@LNXP265MB1564.GBRP265.PROD.OUTLOOK.COM>
Message-ID: <LNXP265MB15649B9DFEE0CB8839F6DFA9A8B62@LNXP265MB1564.GBRP265.PROD.OUTLOOK.COM>

Hi Fellow Package Maintainers,

I received the following helpful message from the CRAN maintainers about a new check that my EnvCpt package is failing:

"CRAN would like to move its package web pages to providing (static) HTML refmans instead of PDF refmans, which needs Rd cross-references to Rd \link{} targets not in the package itself nor in the base packages to use package anchors, i.e., use \link[PKG]{FOO} (see section "Cross-references" in "Writing R Extensions")."

The CRAN package checks here:
https://cran.r-project.org/web/checks/check_results_EnvCpt.html
note that:
"Found the following Rd file(s) with Rd \link{} targets missing package anchors: envcpt.Rd: cpt-class"

All of the \link uses within my package are anchored except for the \linkS4class{cpt} call so I think this is what it is referring to.? I've checked the writing R extensions "Cross-references" section and it just says to use \linkS4class{<class>} but does so in reference to a class within the current package - which is what has been working up until now.

The class is within the changepoint package so, I tried the obvious inference, \linkS4class[changepoint]{cpt} but this creates the following warning on check:
"prepare_Rd: ./man/envcpt.Rd:63: unexpected TEXT '[changepoint]', expecting '{'
checkRd: (7) envcpt.Rd:63: Tag LIST is invalid in a \code block"

Has anyone else come across this (needing to reference a class in another package) and knows how to anchor it?

I could be lazy and just delete the reference to solve the problem but, as the class is given as outputs, I think it is helpful to users who haven't come across the class before to have a direct link to the structure of it.

Thanks,
Rebecca

Pronouns: They/Them/Theirs
Please note:? Whilst I may choose to correspond by email during evenings and weekends as it fits best with my preferred working pattern, I do not expect responses outside your usual working pattern.

From |kry|ov @end|ng |rom d|@root@org  Fri Apr 11 21:45:03 2025
From: |kry|ov @end|ng |rom d|@root@org (Ivan Krylov)
Date: Fri, 11 Apr 2025 22:45:03 +0300
Subject: [R-pkg-devel] \linkS4class anchoring
In-Reply-To: <LNXP265MB15649B9DFEE0CB8839F6DFA9A8B62@LNXP265MB1564.GBRP265.PROD.OUTLOOK.COM>
References: <LNXP265MB1564D9993DE64BAFF2F4B957A8B72@LNXP265MB1564.GBRP265.PROD.OUTLOOK.COM>
 <LNXP265MB15649B9DFEE0CB8839F6DFA9A8B62@LNXP265MB1564.GBRP265.PROD.OUTLOOK.COM>
Message-ID: <20250411224503.4c763fcb@Tarkus>

? Fri, 11 Apr 2025 16:00:16 +0000
"Killick, Rebecca" <r.killick at lancaster.ac.uk> ?????:

> All of the \link uses within my package are anchored except for the
> \linkS4class{cpt} call so I think this is what it is referring to.
> I've checked the writing R extensions "Cross-references" section and
> it just says to use \linkS4class{<class>} but does so in reference to
> a class within the current package - which is what has been working
> up until now.
> 
> The class is within the changepoint package so, I tried the obvious
> inference, \linkS4class[changepoint]{cpt} but this creates the
> following warning on check:
> "prepare_Rd: ./man/envcpt.Rd:63: unexpected TEXT '[changepoint]',
> expecting '{' checkRd: (7)
> envcpt.Rd:63: Tag LIST is invalid in a \code block"

\linkS4class is a "primitive" Rd markup operation, included in the
grammar and implemented directly by the individual Rd converters.
Currently, the grammar says that \linkS4class{} takes no optional
arguments. The workaround used by ?stats::xtabs is:

>> \code{\link[Matrix:sparseMatrix-class]{sparseMatrix}}

(With \linkS4class{sparseMatrix} helpfully left commented out on the
same line.)

In your case, that would be \link[changepoint:cpt-class]{cpt}.

For the future packages depending on future R versions, the grammar and
one of the converters can be changed:

-----------------------------------8<-----------------------------------
Index: src/library/tools/R/Rd2HTML.R
===================================================================
--- src/library/tools/R/Rd2HTML.R	(revision 88138)
+++ src/library/tools/R/Rd2HTML.R	(working copy)
@@ -35,6 +35,8 @@
     option <- attr(arg, "Rd_option")
 
     topic <- dest <- paste(unlist(arg), collapse = "")
+    if (tag == "\\linkS4class") dest <- paste0(dest, "-class")
+
     targetfile <- NULL
     pkg <- NULL
     if (!is.null(option)) {
@@ -55,7 +57,6 @@
     } else if (!isTEXT)
         stopRd(arg, Rdfile, "Bad \\link topic -- must be text")
 
-    if (tag == "\\linkS4class") dest <- paste0(dest, "-class")
     list(topic = topic, dest = dest, pkg = pkg, targetfile = targetfile)
 }
 
Index: src/library/tools/src/gramRd.y
===================================================================
--- src/library/tools/src/gramRd.y	(revision 88138)
+++ src/library/tools/src/gramRd.y	(working copy)
@@ -1168,7 +1168,6 @@
     
     { "\\emph",    LATEXMACRO },    
     { "\\file",    LATEXMACRO },
-    { "\\linkS4class", LATEXMACRO },
     { "\\pkg",	   LATEXMACRO },
     { "\\sQuote",  LATEXMACRO },
     
@@ -1209,6 +1208,7 @@
        one LaTeX-like argument */
        
     { "\\link",    OPTMACRO },
+    { "\\linkS4class", OPTMACRO },
        
     /* These markup macros require an R-like text argument */
     
-----------------------------------8<-----------------------------------

With the patch applied, the output for \linkS4class[changepoint]{cpt}
and \link[changepoint:cpt-class]{cpt} will be the same:

library(tools)
r"{ \linkS4class[changepoint]{cpt} \link[changepoint:cpt-class]{cpt} }" |>
 textConnection() |> parse_Rd(fragment = TRUE) |>
 Rd2HTML(no_links = FALSE, fragment = TRUE)'
# <p><a href="../../changepoint/help/cpt-class.html">cpt</a>
# <a href="../../changepoint/help/cpt-class.html">cpt</a>

Rd2ex skips \linkS4class as before; Rd2txt prints the name on the link;
Rd2latex doesn't support the cross-package anchor; and Rd2HTML needs to
process the ...-class destination first, before the if (option) { ... }
branch sets targetfile based on it.

-- 
Best regards,
Ivan


From jo@|@h@p@rry @end|ng |rom gm@||@com  Sat Apr 12 17:03:11 2025
From: jo@|@h@p@rry @end|ng |rom gm@||@com (Josiah Parry)
Date: Sat, 12 Apr 2025 08:03:11 -0700
Subject: [R-pkg-devel] extendr packages on CRAN
Message-ID: <CAL3ufULDRrB74hQwxmw9bWKy4aDk1o4mvfzf1DLcJzRmwVuBFA@mail.gmail.com>

Hey folks,

extendr v0.8.0 was released which provides backports from R 4.2 and onwards
to address the solidifying C api.

A number of packages are slated for archival on 2025-04-14. We believe
we've provided a PR to each package to get it back in good standing. If you
have not received a PR, please let Mossa (on the TO line) and myself know
and we will assist with a PR.

Release notes with migration guide at:
https://github.com/extendr/extendr/releases/tag/extendr-api-v0.8.0

Thanks,

Josiah Parry

	[[alternative HTML version deleted]]


From em@nue|e@cord@no @end|ng |rom gm@||@com  Mon Apr 14 08:53:38 2025
From: em@nue|e@cord@no @end|ng |rom gm@||@com (Emanuele Cordano)
Date: Mon, 14 Apr 2025 08:53:38 +0200
Subject: [R-pkg-devel] cran check about examples time
In-Reply-To: <01dbac8d$Blat.v3.2.24$1fe6c315$2606c31f4@mail.statistik.tu-dortmund.de>
References: <20250413154815.D51ECA019C@xmpalantir.wu.ac.at>
 <01dbac8d$Blat.v3.2.24$1fe6c315$2606c31f4@mail.statistik.tu-dortmund.de>
Message-ID: <CAKw81f-M=RyFY5iaUh_r7nTkMRe7b4pRFByxqo43jP7xLe7VTw@mail.gmail.com>

Dear list,

I'm submitting the following package. CRAN check were OK (frorr Windows)
whereas in Debian a function example elapses   5.326 seconds.  I need to
fix this. Most lines in the examples are within \donttest{} brackets, so
they should not be executed by CRAN checks. The examples are useful to
understand the functions, as they are, should I include all examples lines
in \donttest{} or \dontrun{} ?
Do you have any suggestion or reference on this? CRAN message attached
below.

Thank you
Best
Emanuele Cordano

CRAN message:

Dear maintainer,

package geotopbricks_1.5.9.1.tar.gz does not pass the incoming checks
automatically, please see the following pre-tests (additional issue checks):
Windows: <
https://win-builder.r-project.org/incoming_pretest/geotopbricks_1.5.9.1_20250413_174815/Windows/00check.log
>
Status: OK
Debian: <
https://win-builder.r-project.org/incoming_pretest/geotopbricks_1.5.9.1_20250413_174815/Debian/00check.log
>
Status: 1 NOTE

Last released version's CRAN status: OK: 9, NOTE: 5
See: <https://CRAN.R-project.org/web/checks/check_results_geotopbricks.html>

CRAN Web: <https://cran.r-project.org/package=geotopbricks>

Please fix all problems and resubmit a fixed version via the webform.
If you are not sure how to fix the problems shown, please ask for help on
the R-package-devel mailing list:
<https://stat.ethz.ch/mailman/listinfo/r-package-devel>
If you are fairly certain the rejection is a false positive, please
reply-all to this message and explain.

More details are given in the directory:
<
https://win-builder.r-project.org/incoming_pretest/geotopbricks_1.5.9.1_20250413_174815/
>
The files will be removed after roughly 7 days.

No strong reverse dependencies to be checked.

Best regards,
CRAN teams' auto-check service
Flavor: r-devel-windows-x86_64
Check: *, Result: OK


Flavor: r-devel-linux-x86_64-debian-gcc
Check: examples, Result: NOTE
  Examples with CPU (user + system) or elapsed time > 5s
                                  user system elapsed
  get.geotop.inpts.keyword.value 1.406  0.027   5.326

	[[alternative HTML version deleted]]


From em@nue|e@cord@no @end|ng |rom gm@||@com  Mon Apr 14 08:57:49 2025
From: em@nue|e@cord@no @end|ng |rom gm@||@com (Emanuele Cordano)
Date: Mon, 14 Apr 2025 08:57:49 +0200
Subject: [R-pkg-devel] broken or outdaeted URLs
In-Reply-To: <20250410135208.157697c6@arachnoid>
References: <CAKw81f_UYBRk8tvyF7B3UysvrXU3jY86PLwiHEWWsePeAZuStg@mail.gmail.com>
 <20250410135208.157697c6@arachnoid>
Message-ID: <CAKw81f_uwOMtfqbbWq5DpYSoerxXbsAkb3A=DRQpjVRb5_Sa=Q@mail.gmail.com>

No,  R CMD check --as-cran on my machine did not help.

  `urlchecker::url_check()`  was very useful. It found most of broken URLs
and they were fixed.

Thank you for your feedback.

Best
Emanuele Cordano

Il giorno gio 10 apr 2025 alle ore 12:52 Ivan Krylov <ikrylov at disroot.org>
ha scritto:

> ? Thu, 10 Apr 2025 11:24:31 +0200
> Emanuele Cordano <emanuele.cordano at gmail.com> ?????:
>
> > Is there an option in R CMD check that I can use on
> > my server to directly verify all URLs
>
> Does R CMD check --as-cran help?
>
> --
> Best regards,
> Ivan
>


-- 
Emanuele Cordano, PhD
Environmental Engineer / Ingegnere per l' Ambiente e il territorio nr.
3587 (Albo A - Provincia di Trento)
cell: +39 3282818564
email: emanuele.cordano at gmail.com,emanuele.cordano at rendena100.eu,
emanuele.cordano at eurac.edu
PEC: emanuele.cordano at ingpec.eu
URL: www.rendena100.eu
LinkedIn: https://www.linkedin.com/in/emanuele-cordano-31995333
GitHub: https://github.com/ecor

	[[alternative HTML version deleted]]


From |kry|ov @end|ng |rom d|@root@org  Mon Apr 14 13:34:16 2025
From: |kry|ov @end|ng |rom d|@root@org (Ivan Krylov)
Date: Mon, 14 Apr 2025 14:34:16 +0300
Subject: [R-pkg-devel] broken or outdaeted URLs
In-Reply-To: <CAKw81f_uwOMtfqbbWq5DpYSoerxXbsAkb3A=DRQpjVRb5_Sa=Q@mail.gmail.com>
References: <CAKw81f_UYBRk8tvyF7B3UysvrXU3jY86PLwiHEWWsePeAZuStg@mail.gmail.com>
 <20250410135208.157697c6@arachnoid>
 <CAKw81f_uwOMtfqbbWq5DpYSoerxXbsAkb3A=DRQpjVRb5_Sa=Q@mail.gmail.com>
Message-ID: <20250414143416.6df84324@arachnoid>

? Mon, 14 Apr 2025 08:57:49 +0200
Emanuele Cordano <emanuele.cordano at gmail.com> ?????:

> R CMD check --as-cran on my machine did not help.

Strange, it should be doing the same thing as 'urlchecker'. I've tried
it with an old version of 'RMAWGEN' and saw the messages:

>> * checking CRAN incoming feasibility ... [6s/526s] WARNING
>> <...>
>> Found the following (possibly) invalid URLs:

Some of the URL checks in R CMD check do not work if 'xml2' is not
installed, but 'urlchecker' depends on it as well. Still, glad that
'urlchecker' helped you locate and fix the problematic URLs.

-- 
Best regards,
Ivan


From |kry|ov @end|ng |rom d|@root@org  Mon Apr 14 13:34:22 2025
From: |kry|ov @end|ng |rom d|@root@org (Ivan Krylov)
Date: Mon, 14 Apr 2025 14:34:22 +0300
Subject: [R-pkg-devel] cran check about examples time
In-Reply-To: <CAKw81f-M=RyFY5iaUh_r7nTkMRe7b4pRFByxqo43jP7xLe7VTw@mail.gmail.com>
References: <20250413154815.D51ECA019C@xmpalantir.wu.ac.at>
 <01dbac8d$Blat.v3.2.24$1fe6c315$2606c31f4@mail.statistik.tu-dortmund.de>
 <CAKw81f-M=RyFY5iaUh_r7nTkMRe7b4pRFByxqo43jP7xLe7VTw@mail.gmail.com>
Message-ID: <20250414143422.45918aac@arachnoid>

? Mon, 14 Apr 2025 08:53:38 +0200
Emanuele Cordano <emanuele.cordano at gmail.com> ?????:

> CRAN check were OK (frorr Windows) whereas in Debian a function
> example elapses   5.326 seconds.  I need to fix this. Most lines in
> the examples are within \donttest{} brackets, so they should not be
> executed by CRAN checks.

Nowadays, R CMD check --as-cran does run \donttest{} examples. (But not
without --as-cran or --run-donttest, and no automatic checks enable
--run-dontrun.)

>   Examples with CPU (user + system) or elapsed time > 5s
>                                   user system elapsed
>   get.geotop.inpts.keyword.value 1.406  0.027   5.326

It looks like most of the time was spent waiting to establish a new
connection (closer to 8 seconds on my computer). What does
system.time(example(get.geotop.inpts.keyword.value)) return for you? Is
it an option to download less files in the example?

Having examples that download data from the internet is somewhat
precarious for a CRAN package. One way to prevent intermittent
connectivity problems from failing your package checks is to make sure
that any time your package fails to download something from the Web, it
calls stop() with a classed error object (e.g. simpleError(...) with an
additional class "geotop_internet_error" attached). This makes it
possible to wrap your examples in tryCatch(..., geotop_internet_error =
function(e) { ... }), so that any connection errors do not cause your
examples to fail, but other errors are not swallowed.

-- 
Best regards,
Ivan


From @di@@o m@iii@g oii pdx@edu  Mon Apr 14 06:54:03 2025
From: @di@@o m@iii@g oii pdx@edu (@di@@o m@iii@g oii pdx@edu)
Date: Sun, 13 Apr 2025 21:54:03 -0700 (PDT)
Subject: [R-pkg-devel] How to resolve help files with \Sexpr{} warning?
Message-ID: <alpine.DEB.2.22.394.2504132150390.3328074@anzu.alexisdinno.com>



Dear R Devs,


I am unsure how to resolve this NOTE in my package build (I am 
comfortable with the possibly misspelled words part):

 Package has help file(s) containing install/render-stage \Sexpr{} 
 expressions but no prebuilt PDF manual.


I've dozens of files and no idea which one(s) offend, or if I am missing 
some other detail. (Aside: I am using mathjaxr... not sure if that is 
the issue.)


Links for winbuilder logs are here for the time being:

 https://win-builder.r-project.org/qG7LHs2Yf18p
 https://win-builder.r-project.org/BBXdLV7kDOuI
 https://win-builder.r-project.org/63RmX21pnrAw ?This check passes


Thank you very much,

Alexis Dinno


PS Am including the log from the R-release winbuilder check in case my 
links expire:


* using log directory 
'd:/RCompile/CRANguest/R-oldrelease/tost.suite.Rcheck'
* using R version 4.4.3 (2025-02-28 ucrt)
* using platform: x86_64-w64-mingw32
* R was compiled by
    gcc.exe (GCC) 13.3.0
    GNU Fortran (GCC) 13.3.0
* running under: Windows Server 2022 x64 (build 20348)
* using session charset: UTF-8
* checking for file 'tost.suite/DESCRIPTION' ... OK
* this is package 'tost.suite' version '3.15'
* package encoding: UTF-8
* checking CRAN incoming feasibility ... [8s] NOTE
Maintainer: 'Alexis Dinno <alexis.dinno at pdx.edu>'

New submission

Possibly misspelled words in DESCRIPTION:
  Kolmogorov (9:402)
  McNemar's (9:198)
  OLS (9:289)
  Smirnov (9:413)
  Stata (9:47)
  Wilcoxon (9:312, 9:340)
  nonparametric (9:546)
  rrp (9:842)
  rrpi (9:855)
  tost (9:18, 9:65, 9:837, 9:850)

Package has help file(s) containing install/render-stage \Sexpr{} 
expressions but no prebuilt PDF manual.
* checking package namespace information ... OK
* checking package dependencies ... OK
* checking if this is a source package ... OK
* checking if there is a namespace ... OK
* checking for hidden files and directories ... OK
* checking for portable file names ... OK
* checking whether package 'tost.suite' can be installed ... OK
* checking installed package size ... OK
* checking package directory ... OK
* checking for future file timestamps ... OK
* checking DESCRIPTION meta-information ... OK
* checking top-level files ... OK
* checking for left-over files ... OK
* checking index information ... OK
* checking package subdirectories ... OK
* checking code files for non-ASCII characters ... OK
* checking R files for syntax errors ... OK
* checking whether the package can be loaded ... [1s] OK
* checking whether the package can be loaded with stated dependencies 
... [1s] OK
* checking whether the package can be unloaded cleanly ... [1s] OK
* checking whether the namespace can be loaded with stated dependencies 
... [1s] OK
* checking whether the namespace can be unloaded cleanly ... [1s] OK
* checking loading without being on the library search path ... [1s] OK
* checking use of S3 registration ... OK
* checking dependencies in R code ... OK
* checking S3 generic/method consistency ... OK
* checking replacement functions ... OK
* checking foreign function calls ... OK
* checking R code for possible problems ... [16s] OK
* checking Rd files ... [1s] OK
* checking Rd metadata ... OK
* checking Rd line widths ... OK
* checking Rd cross-references ... OK
* checking for missing documentation entries ... OK
* checking for code/documentation mismatches ... OK
* checking Rd \usage sections ... OK
* checking Rd contents ... OK
* checking for unstated dependencies in examples ... OK
* checking contents of 'data' directory ... OK
* checking data for non-ASCII characters ... [0s] OK
* checking data for ASCII and uncompressed saves ... OK
* checking examples ... [7s] OK
* checking PDF version of manual ... [12s] OK
* checking HTML version of manual ... [5s] OK
* checking for detritus in the temp directory ... OK
* DONE
Status: 1 NOTE

From |kw@|mmo @end|ng |rom gm@||@com  Mon Apr 14 15:46:22 2025
From: |kw@|mmo @end|ng |rom gm@||@com (Iris Simmons)
Date: Mon, 14 Apr 2025 09:46:22 -0400
Subject: [R-pkg-devel] How to resolve help files with \Sexpr{} warning?
In-Reply-To: <alpine.DEB.2.22.394.2504132150390.3328074@anzu.alexisdinno.com>
References: <alpine.DEB.2.22.394.2504132150390.3328074@anzu.alexisdinno.com>
Message-ID: <CADNULg_spZZyKmHmYAbO0MW0xHuBTWZsb735E23X4a8=NZKrbA@mail.gmail.com>

I believe R CMD build changed the default from --manual to --no-manual, I'm
not sure why. You could add --manual when you build the tarball or you
could add

BuildManual: TRUE

to your DESCRIPTION.

On Mon, Apr 14, 2025, 09:41 <adinno at pdx.edu> wrote:

>
>
> Dear R Devs,
>
>
> I am unsure how to resolve this NOTE in my package build (I am
> comfortable with the possibly misspelled words part):
>
>  Package has help file(s) containing install/render-stage \Sexpr{}
>  expressions but no prebuilt PDF manual.
>
>
> I've dozens of files and no idea which one(s) offend, or if I am missing
> some other detail. (Aside: I am using mathjaxr... not sure if that is
> the issue.)
>
>
> Links for winbuilder logs are here for the time being:
>
>  https://win-builder.r-project.org/qG7LHs2Yf18p
>  https://win-builder.r-project.org/BBXdLV7kDOuI
>  https://win-builder.r-project.org/63RmX21pnrAw ?This check passes
>
>
> Thank you very much,
>
> Alexis Dinno
>
>
> PS Am including the log from the R-release winbuilder check in case my
> links expire:
>
>
> * using log directory
> 'd:/RCompile/CRANguest/R-oldrelease/tost.suite.Rcheck'
> * using R version 4.4.3 (2025-02-28 ucrt)
> * using platform: x86_64-w64-mingw32
> * R was compiled by
>     gcc.exe (GCC) 13.3.0
>     GNU Fortran (GCC) 13.3.0
> * running under: Windows Server 2022 x64 (build 20348)
> * using session charset: UTF-8
> * checking for file 'tost.suite/DESCRIPTION' ... OK
> * this is package 'tost.suite' version '3.15'
> * package encoding: UTF-8
> * checking CRAN incoming feasibility ... [8s] NOTE
> Maintainer: 'Alexis Dinno <alexis.dinno at pdx.edu>'
>
> New submission
>
> Possibly misspelled words in DESCRIPTION:
>   Kolmogorov (9:402)
>   McNemar's (9:198)
>   OLS (9:289)
>   Smirnov (9:413)
>   Stata (9:47)
>   Wilcoxon (9:312, 9:340)
>   nonparametric (9:546)
>   rrp (9:842)
>   rrpi (9:855)
>   tost (9:18, 9:65, 9:837, 9:850)
>
> Package has help file(s) containing install/render-stage \Sexpr{}
> expressions but no prebuilt PDF manual.
> * checking package namespace information ... OK
> * checking package dependencies ... OK
> * checking if this is a source package ... OK
> * checking if there is a namespace ... OK
> * checking for hidden files and directories ... OK
> * checking for portable file names ... OK
> * checking whether package 'tost.suite' can be installed ... OK
> * checking installed package size ... OK
> * checking package directory ... OK
> * checking for future file timestamps ... OK
> * checking DESCRIPTION meta-information ... OK
> * checking top-level files ... OK
> * checking for left-over files ... OK
> * checking index information ... OK
> * checking package subdirectories ... OK
> * checking code files for non-ASCII characters ... OK
> * checking R files for syntax errors ... OK
> * checking whether the package can be loaded ... [1s] OK
> * checking whether the package can be loaded with stated dependencies
> ... [1s] OK
> * checking whether the package can be unloaded cleanly ... [1s] OK
> * checking whether the namespace can be loaded with stated dependencies
> ... [1s] OK
> * checking whether the namespace can be unloaded cleanly ... [1s] OK
> * checking loading without being on the library search path ... [1s] OK
> * checking use of S3 registration ... OK
> * checking dependencies in R code ... OK
> * checking S3 generic/method consistency ... OK
> * checking replacement functions ... OK
> * checking foreign function calls ... OK
> * checking R code for possible problems ... [16s] OK
> * checking Rd files ... [1s] OK
> * checking Rd metadata ... OK
> * checking Rd line widths ... OK
> * checking Rd cross-references ... OK
> * checking for missing documentation entries ... OK
> * checking for code/documentation mismatches ... OK
> * checking Rd \usage sections ... OK
> * checking Rd contents ... OK
> * checking for unstated dependencies in examples ... OK
> * checking contents of 'data' directory ... OK
> * checking data for non-ASCII characters ... [0s] OK
> * checking data for ASCII and uncompressed saves ... OK
> * checking examples ... [7s] OK
> * checking PDF version of manual ... [12s] OK
> * checking HTML version of manual ... [5s] OK
> * checking for detritus in the temp directory ... OK
> * DONE
> Status: 1 NOTE
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From |kry|ov @end|ng |rom d|@root@org  Mon Apr 14 15:58:45 2025
From: |kry|ov @end|ng |rom d|@root@org (Ivan Krylov)
Date: Mon, 14 Apr 2025 16:58:45 +0300
Subject: [R-pkg-devel] How to resolve help files with \Sexpr{} warning?
In-Reply-To: <alpine.DEB.2.22.394.2504132150390.3328074@anzu.alexisdinno.com>
References: <alpine.DEB.2.22.394.2504132150390.3328074@anzu.alexisdinno.com>
Message-ID: <20250414165845.35899aa8@arachnoid>

? Sun, 13 Apr 2025 21:54:03 -0700 (PDT)
adinno at pdx.edu ?????:

> Package has help file(s) containing install/render-stage \Sexpr{} 
> expressions but no prebuilt PDF manual.

This is a relatively recent change (r85348, October 2023). Previously,
R CMD build detected non-build-time dynamic content in the package
documentation and built the manual automatically. Nowadays I think you
have to set BuildManual: yes in your DESCRIPTION before building the
package. (There's R CMD build --no-manual, but I'm not seeing a command
line option to override it from "no" to "yes".)

> (Aside: I am using mathjaxr... not sure if that is the issue.)

Correct, that must be what's producing the render-stage dynamic content:

https://github.com/wviechtb/mathjaxr/blob/8900cbbb2eda4dc45b776cc203c2942b6289fac3/man/macros/mathjax.Rd#L4

-- 
Best regards,
Ivan


From @di@@o m@iii@g oii pdx@edu  Mon Apr 14 18:37:20 2025
From: @di@@o m@iii@g oii pdx@edu (@di@@o m@iii@g oii pdx@edu)
Date: Mon, 14 Apr 2025 09:37:20 -0700 (PDT)
Subject: [R-pkg-devel] How to resolve help files with \Sexpr{} warning?
In-Reply-To: <20250414165845.35899aa8@arachnoid>
References: <alpine.DEB.2.22.394.2504132150390.3328074@anzu.alexisdinno.com>
 <20250414165845.35899aa8@arachnoid>
Message-ID: <alpine.DEB.2.22.394.2504140901090.3338421@anzu.alexisdinno.com>



Dear Iris and Ivan, 


Together both your comments were very helpful, and both pointed me at a 
solution to resolve my issue and to explain why this change in behavior 
emerged, and how my package was triggering the behavior.

Solution that worked:

 Editing the DESCRIPTION file to add the line BuildManual: TRUE

Solution that did *not* work (along with variations):
 
 R CMD build --manual  ?Resulted in: Warning: unknown option ?--manual?
 R CMD --manual build
 R --manual CMD build
 R CMD check --manual

Note: I am using R version 4.4.3 (2025-02-28) -- "Trophy Case" on Ubuntu 
24.04


Thank you both very much for this help!

Alexis Dinno

From em@nue|e@cord@no @end|ng |rom gm@||@com  Wed Apr 16 09:39:13 2025
From: em@nue|e@cord@no @end|ng |rom gm@||@com (Emanuele Cordano)
Date: Wed, 16 Apr 2025 09:39:13 +0200
Subject: [R-pkg-devel] cran check about examples time
In-Reply-To: <20250414143422.45918aac@arachnoid>
References: <20250413154815.D51ECA019C@xmpalantir.wu.ac.at>
 <01dbac8d$Blat.v3.2.24$1fe6c315$2606c31f4@mail.statistik.tu-dortmund.de>
 <CAKw81f-M=RyFY5iaUh_r7nTkMRe7b4pRFByxqo43jP7xLe7VTw@mail.gmail.com>
 <20250414143422.45918aac@arachnoid>
Message-ID: <CAKw81f_O3D2Dim=Tr-f37vx4DR=PZofRNWpyd5g5V1YRY59XQg@mail.gmail.com>

Thanks
I  checked  system.time(example(get.geotop.inpts.keyword.value)) .  Elapsed
time varies on my machines between 6 and 3 seconds (see below) , mostly
lesser than 5 seconds. It extracts information from a set-up directory of
the GEOtop model. I cannot put an  GEOtop simulation folder within
"geotopbricks" package for obvious reasons and function example refers to
example GEOtop simulation folder available on an external ad hoc Github
repository.   I'm looking for a solution. Thanks for suggestions.

Best
Emanuele

 user  system elapsed
  2.991   0.024   5.532 > > >
system.time(example(get.geotop.inpts.keyword.value))

 user  system elapsed
  2.846   0.001   3.796

>

Il giorno lun 14 apr 2025 alle ore 13:34 Ivan Krylov <ikrylov at disroot.org>
ha scritto:

> ? Mon, 14 Apr 2025 08:53:38 +0200
> Emanuele Cordano <emanuele.cordano at gmail.com> ?????:
>
> > CRAN check were OK (frorr Windows) whereas in Debian a function
> > example elapses   5.326 seconds.  I need to fix this. Most lines in
> > the examples are within \donttest{} brackets, so they should not be
> > executed by CRAN checks.
>
> Nowadays, R CMD check --as-cran does run \donttest{} examples. (But not
> without --as-cran or --run-donttest, and no automatic checks enable
> --run-dontrun.)
>
> >   Examples with CPU (user + system) or elapsed time > 5s
> >                                   user system elapsed
> >   get.geotop.inpts.keyword.value 1.406  0.027   5.326
>
> It looks like most of the time was spent waiting to establish a new
> connection (closer to 8 seconds on my computer). What does
> system.time(example(get.geotop.inpts.keyword.value)) return for you? Is
> it an option to download less files in the example?
>
> Having examples that download data from the internet is somewhat
> precarious for a CRAN package. One way to prevent intermittent
> connectivity problems from failing your package checks is to make sure
> that any time your package fails to download something from the Web, it
> calls stop() with a classed error object (e.g. simpleError(...) with an
> additional class "geotop_internet_error" attached). This makes it
> possible to wrap your examples in tryCatch(..., geotop_internet_error =
> function(e) { ... }), so that any connection errors do not cause your
> examples to fail, but other errors are not swallowed.
>
> --
> Best regards,
> Ivan
>


-- 
Emanuele Cordano, PhD
Environmental Engineer / Ingegnere per l' Ambiente e il territorio nr.
3587 (Albo A - Provincia di Trento)
cell: +39 3282818564
email: emanuele.cordano at gmail.com,emanuele.cordano at rendena100.eu,
emanuele.cordano at eurac.edu
PEC: emanuele.cordano at ingpec.eu
URL: www.rendena100.eu
LinkedIn: https://www.linkedin.com/in/emanuele-cordano-31995333
GitHub: https://github.com/ecor

	[[alternative HTML version deleted]]


From tob|@@@|e|||nger @end|ng |rom @ge@@@t  Thu Apr 17 09:27:49 2025
From: tob|@@@|e|||nger @end|ng |rom @ge@@@t (Fellinger Tobias)
Date: Thu, 17 Apr 2025 07:27:49 +0000
Subject: [R-pkg-devel] [EXTERN]  cran check about examples time
In-Reply-To: <CAKw81f-M=RyFY5iaUh_r7nTkMRe7b4pRFByxqo43jP7xLe7VTw@mail.gmail.com>
References: <20250413154815.D51ECA019C@xmpalantir.wu.ac.at>
 <01dbac8d$Blat.v3.2.24$1fe6c315$2606c31f4@mail.statistik.tu-dortmund.de>
 <CAKw81f-M=RyFY5iaUh_r7nTkMRe7b4pRFByxqo43jP7xLe7VTw@mail.gmail.com>
Message-ID: <VE1PR01MB56807EB8340E276B05CF2C6889BC2@VE1PR01MB5680.eurprd01.prod.exchangelabs.com>

Dear Emanuele,

I checked one of the Notes. One of the examples of get.geotop.inpts.keyword.value that throws a NOTE has parts outside of donttest that seem to load data from an url which can lead to varying execution times depending on the server. Moreover the url seems not to work. (https://raw.githubusercontent.com/ecor/geotopbricks_doc/master/simulations/panola13_run2xC_test3)

If you want to load the data from the web, I'd also put this in a donttest section.

An alternative would be (if this makes sense for the example) to include the file in the package and load it with system.file in the examples. This should run faster and more reliable and be independent of changes to URLs outside of the repository. Beware of maximum package sizes though.

(I checked this with the current default branch on github.)

Hope this helps, best regards, Tobias

-----Urspr?ngliche Nachricht-----
Von: R-package-devel <r-package-devel-bounces at r-project.org> Im Auftrag von Emanuele Cordano
Gesendet: Montag, 14. April 2025 08:54
An: r-package-devel at r-project.org
Betreff: [EXTERN] [R-pkg-devel] cran check about examples time

[You don't often get email from emanuele.cordano at gmail.com. Learn why this is important at https://aka.ms/LearnAboutSenderIdentification ]

Dear list,

I'm submitting the following package. CRAN check were OK (frorr Windows)
whereas in Debian a function example elapses   5.326 seconds.  I need to
fix this. Most lines in the examples are within \donttest{} brackets, so they should not be executed by CRAN checks. The examples are useful to understand the functions, as they are, should I include all examples lines in \donttest{} or \dontrun{} ?
Do you have any suggestion or reference on this? CRAN message attached below.

Thank you
Best
Emanuele Cordano

CRAN message:

Dear maintainer,

package geotopbricks_1.5.9.1.tar.gz does not pass the incoming checks automatically, please see the following pre-tests (additional issue checks):
Windows: <
https://win-builder.r-project.org/incoming_pretest/geotopbricks_1.5.9.1_20250413_174815/Windows/00check.log
>
Status: OK
Debian: <
https://win-builder.r-project.org/incoming_pretest/geotopbricks_1.5.9.1_20250413_174815/Debian/00check.log
>
Status: 1 NOTE

Last released version's CRAN status: OK: 9, NOTE: 5
See: <https://cran.r-project.org/web/checks/check_results_geotopbricks.html>

CRAN Web: <https://cran.r-project.org/package=geotopbricks>

Please fix all problems and resubmit a fixed version via the webform.
If you are not sure how to fix the problems shown, please ask for help on the R-package-devel mailing list:
<https://stat.ethz.ch/mailman/listinfo/r-package-devel>
If you are fairly certain the rejection is a false positive, please reply-all to this message and explain.

More details are given in the directory:
<
https://win-builder.r-project.org/incoming_pretest/geotopbricks_1.5.9.1_20250413_174815/
>
The files will be removed after roughly 7 days.

No strong reverse dependencies to be checked.

Best regards,
CRAN teams' auto-check service
Flavor: r-devel-windows-x86_64
Check: *, Result: OK


Flavor: r-devel-linux-x86_64-debian-gcc
Check: examples, Result: NOTE
  Examples with CPU (user + system) or elapsed time > 5s
                                  user system elapsed
  get.geotop.inpts.keyword.value 1.406  0.027   5.326

        [[alternative HTML version deleted]]

______________________________________________
R-package-devel at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-package-devel
[https://www.ages.at/fileadmin/Signatur/03_AGES_Mailsignatur2025_Zeichenflaeche_1-04.png]<https://www.ages.at/ages/one-health/one-health>

________________________________



Firma & Rechtsform: ?sterreichische Agentur f?r Gesundheit und Ern?hrungssicherheit GmbH

Sitz: Spargelfeldstra?e 191, 1220 Wien

Firmenbuchnummer: FN 223056z

Firmenbuchgericht: Handelsgericht Wien

Diese Nachricht und allf?llige angeh?ngte Dokumente sind vertraulich und nur f?r den/die Adressaten bestimmt. Sollten Sie nicht der beabsichtigte Adressat sein, ist jede Offenlegung, Weiterleitung oder sonstige Verwendung dieser Information nicht gestattet. In diesem Fall bitten wir, den Absender zu verst?ndigen und die Information zu vernichten. F?r ?bermittlungsfehler oder sonstige Irrt?mer bei ?bermittlung besteht keine Haftung.

Unsere Datenschutzerkl?rung finden Sie unter: Datenschutzerkl?rung<https://www.ages.at/datenschutzerklaerung>

This message and any attached files are confidential and intended solely for the addressee(s). Any publication, transmission or other use of the information by a person or entity other than the intended addressee is prohibited. If you receive this in error please contact the sender and delete the material. The sender does not accept liability for any errors or omissions as a result of the transmission.

You can find our privacy policy at: privacy policy<https://www.ages.at/en/privacy>


From ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de  Thu Apr 17 09:44:51 2025
From: ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de (Uwe Ligges)
Date: Thu, 17 Apr 2025 09:44:51 +0200
Subject: [R-pkg-devel] [EXTERN] cran check about examples time
In-Reply-To: <VE1PR01MB56807EB8340E276B05CF2C6889BC2@VE1PR01MB5680.eurprd01.prod.exchangelabs.com>
References: <20250413154815.D51ECA019C@xmpalantir.wu.ac.at>
 <01dbac8d$Blat.v3.2.24$1fe6c315$2606c31f4@mail.statistik.tu-dortmund.de>
 <CAKw81f-M=RyFY5iaUh_r7nTkMRe7b4pRFByxqo43jP7xLe7VTw@mail.gmail.com>
 <VE1PR01MB56807EB8340E276B05CF2C6889BC2@VE1PR01MB5680.eurprd01.prod.exchangelabs.com>
Message-ID: <dcdbf1c4-f4ad-41e7-92dc-d47f0ab09f96@statistik.tu-dortmund.de>

Or set a web timeout and if not downloaded succesfully not run the code 
(i.e. condiationalize).

Best,
Uwe Ligges


On 17.04.2025 09:27, Fellinger Tobias wrote:
> Dear Emanuele,
> 
> I checked one of the Notes. One of the examples of get.geotop.inpts.keyword.value that throws a NOTE has parts outside of donttest that seem to load data from an url which can lead to varying execution times depending on the server. Moreover the url seems not to work. (https://raw.githubusercontent.com/ecor/geotopbricks_doc/master/simulations/panola13_run2xC_test3)
> 
> If you want to load the data from the web, I'd also put this in a donttest section.
> 
> An alternative would be (if this makes sense for the example) to include the file in the package and load it with system.file in the examples. This should run faster and more reliable and be independent of changes to URLs outside of the repository. Beware of maximum package sizes though.
> 
> (I checked this with the current default branch on github.)
> 
> Hope this helps, best regards, Tobias
> 
> -----Urspr?ngliche Nachricht-----
> Von: R-package-devel <r-package-devel-bounces at r-project.org> Im Auftrag von Emanuele Cordano
> Gesendet: Montag, 14. April 2025 08:54
> An: r-package-devel at r-project.org
> Betreff: [EXTERN] [R-pkg-devel] cran check about examples time
> 
> [You don't often get email from emanuele.cordano at gmail.com. Learn why this is important at https://aka.ms/LearnAboutSenderIdentification ]
> 
> Dear list,
> 
> I'm submitting the following package. CRAN check were OK (frorr Windows)
> whereas in Debian a function example elapses   5.326 seconds.  I need to
> fix this. Most lines in the examples are within \donttest{} brackets, so they should not be executed by CRAN checks. The examples are useful to understand the functions, as they are, should I include all examples lines in \donttest{} or \dontrun{} ?
> Do you have any suggestion or reference on this? CRAN message attached below.
> 
> Thank you
> Best
> Emanuele Cordano
> 
> CRAN message:
> 
> Dear maintainer,
> 
> package geotopbricks_1.5.9.1.tar.gz does not pass the incoming checks automatically, please see the following pre-tests (additional issue checks):
> Windows: <
> https://win-builder.r-project.org/incoming_pretest/geotopbricks_1.5.9.1_20250413_174815/Windows/00check.log
>>
> Status: OK
> Debian: <
> https://win-builder.r-project.org/incoming_pretest/geotopbricks_1.5.9.1_20250413_174815/Debian/00check.log
>>
> Status: 1 NOTE
> 
> Last released version's CRAN status: OK: 9, NOTE: 5
> See: <https://cran.r-project.org/web/checks/check_results_geotopbricks.html>
> 
> CRAN Web: <https://cran.r-project.org/package=geotopbricks>
> 
> Please fix all problems and resubmit a fixed version via the webform.
> If you are not sure how to fix the problems shown, please ask for help on the R-package-devel mailing list:
> <https://stat.ethz.ch/mailman/listinfo/r-package-devel>
> If you are fairly certain the rejection is a false positive, please reply-all to this message and explain.
> 
> More details are given in the directory:
> <
> https://win-builder.r-project.org/incoming_pretest/geotopbricks_1.5.9.1_20250413_174815/
>>
> The files will be removed after roughly 7 days.
> 
> No strong reverse dependencies to be checked.
> 
> Best regards,
> CRAN teams' auto-check service
> Flavor: r-devel-windows-x86_64
> Check: *, Result: OK
> 
> 
> Flavor: r-devel-linux-x86_64-debian-gcc
> Check: examples, Result: NOTE
>    Examples with CPU (user + system) or elapsed time > 5s
>                                    user system elapsed
>    get.geotop.inpts.keyword.value 1.406  0.027   5.326
> 
>          [[alternative HTML version deleted]]
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
> [https://www.ages.at/fileadmin/Signatur/03_AGES_Mailsignatur2025_Zeichenflaeche_1-04.png]<https://www.ages.at/ages/one-health/one-health>
> 
> ________________________________
> 
> 
> 
> Firma & Rechtsform: ?sterreichische Agentur f?r Gesundheit und Ern?hrungssicherheit GmbH
> 
> Sitz: Spargelfeldstra?e 191, 1220 Wien
> 
> Firmenbuchnummer: FN 223056z
> 
> Firmenbuchgericht: Handelsgericht Wien
> 
> Diese Nachricht und allf?llige angeh?ngte Dokumente sind vertraulich und nur f?r den/die Adressaten bestimmt. Sollten Sie nicht der beabsichtigte Adressat sein, ist jede Offenlegung, Weiterleitung oder sonstige Verwendung dieser Information nicht gestattet. In diesem Fall bitten wir, den Absender zu verst?ndigen und die Information zu vernichten. F?r ?bermittlungsfehler oder sonstige Irrt?mer bei ?bermittlung besteht keine Haftung.
> 
> Unsere Datenschutzerkl?rung finden Sie unter: Datenschutzerkl?rung<https://www.ages.at/datenschutzerklaerung>
> 
> This message and any attached files are confidential and intended solely for the addressee(s). Any publication, transmission or other use of the information by a person or entity other than the intended addressee is prohibited. If you receive this in error please contact the sender and delete the material. The sender does not accept liability for any errors or omissions as a result of the transmission.
> 
> You can find our privacy policy at: privacy policy<https://www.ages.at/en/privacy>
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From tony_@_w||ke@ @end|ng |rom out|ook@com  Thu Apr 24 14:36:57 2025
From: tony_@_w||ke@ @end|ng |rom out|ook@com (Tony Wilkes)
Date: Thu, 24 Apr 2025 12:36:57 +0000
Subject: [R-pkg-devel] Check if any object pointing to a given address is
 locked
Message-ID: <AS4P195MB1430136E16DEA56418F69FCEBE852@AS4P195MB1430.EURP195.PROD.OUTLOOK.COM>

Hi everyone,

I have a question.

Given the address of an object ("address" in the sense given by, for example, "data.table::address()"), is it possible to check if any binding in any environment pointing to that address is locked?
So a function similar to "bindingIsLocked()", except the function checks all bindings sharing the same address, instead of checking a binding by name in a specific environment.

One use-case for this is to check if it's save to modify an object by reference.
For example, when saying x <- base::letters, x is not save to modify by reference:
Although the binding of x itself is not locked, the binding of base::letters is locked, and we obviously don't want to modify base::letters.

It should be possible, I think. R has a few pass-by-reference classes (like environments), so R should be able to check something like this. I just have no idea how exactly R checks this.

Thanks in advance for any response!

Kind regards,

Tony



	[[alternative HTML version deleted]]


From |kry|ov @end|ng |rom d|@root@org  Thu Apr 24 15:28:16 2025
From: |kry|ov @end|ng |rom d|@root@org (Ivan Krylov)
Date: Thu, 24 Apr 2025 16:28:16 +0300
Subject: [R-pkg-devel] 
 Check if any object pointing to a given address is locked
In-Reply-To: <AS4P195MB1430136E16DEA56418F69FCEBE852@AS4P195MB1430.EURP195.PROD.OUTLOOK.COM>
References: <AS4P195MB1430136E16DEA56418F69FCEBE852@AS4P195MB1430.EURP195.PROD.OUTLOOK.COM>
Message-ID: <20250424162816.43ce256c@arachnoid>

? Thu, 24 Apr 2025 12:36:57 +0000
Tony Wilkes <tony_a_wilkes at outlook.com> ?????:

> One use-case for this is to check if it's save to modify an object by
> reference.

I think you might need NOT_SHARED() for that, except it's far from
being simple, especially once you pass arbitrary expressions (not just
variable names) as arguments to your function:
https://developer.r-project.org/Refcnt.html

> For example, when saying x <- base::letters, x is not save
> to modify by reference: Although the binding of x itself is not
> locked, the binding of base::letters is locked, and we obviously
> don't want to modify base::letters.

The situation is more dangerous than that. When 'x' references the same
object as base::letters (which is a locked binding), you can still
modify this object from C code, given its SEXP address, and see the
changes from either binding; R won't be able to stop you. (That's the
danger of by-reference operations like those implemented in data.table.)

On the other hand, if you assign a new value to the 'x' binding inside
a given environment, base::letters and any other objects referencing it
will retain their original values; there is no need to worry about
other bindings being locked.

> R has a few pass-by-reference classes (like environments)

These are different. You can lock a _binding_ to an environment and
still change the _value_ of that environment precisely because it's a
mutable, pass-by-reference object:

x <- new.env()
y <- x
lockBinding('x', environment())
# x$foo <- 'bar' # would signal an error, but:
assign('foo', 'bar', envir = x) # works
x$foo # [1] "bar"
identical(x, y) # [1] TRUE

R switched to reference counting by default in version 4.0. One
downside of the reference counts as currently implemented is that when
an object containing references to other objects is garbage-collected,
the reference counts of the child objects are not decremented:

x <- 1
invisible(replicate(999, list(x)))
gc(full = TRUE)
.Internal(inspect(x))
# @5618cd515488 14 REALSXP g1c1 [MARK,REF(2000)] (len=1, tl=0) 1

'x' retains a reference count of 2000 despite the 999 lists that
previously referenced it no longer exist. This is possible to change,
but at the cost of slowing down the garbage collector.

-- 
Best regards,
Ivan


From tom@@@k@||ber@ @end|ng |rom gm@||@com  Thu Apr 24 16:38:13 2025
From: tom@@@k@||ber@ @end|ng |rom gm@||@com (Tomas Kalibera)
Date: Thu, 24 Apr 2025 16:38:13 +0200
Subject: [R-pkg-devel] 
 Check if any object pointing to a given address is locked
In-Reply-To: <AS4P195MB1430136E16DEA56418F69FCEBE852@AS4P195MB1430.EURP195.PROD.OUTLOOK.COM>
References: <AS4P195MB1430136E16DEA56418F69FCEBE852@AS4P195MB1430.EURP195.PROD.OUTLOOK.COM>
Message-ID: <df6fe1ad-b835-48e2-8d76-af3bdeca8c09@gmail.com>


On 4/24/25 14:36, Tony Wilkes wrote:
> Hi everyone,
>
> I have a question.
>
> Given the address of an object ("address" in the sense given by, for example, "data.table::address()"), is it possible to check if any binding in any environment pointing to that address is locked?
> So a function similar to "bindingIsLocked()", except the function checks all bindings sharing the same address, instead of checking a binding by name in a specific environment.
>
> One use-case for this is to check if it's save to modify an object by reference.
> For example, when saying x <- base::letters, x is not save to modify by reference:
> Although the binding of x itself is not locked, the binding of base::letters is locked, and we obviously don't want to modify base::letters.

The question seems to be mixing R-level abstractions with the underlying 
C-level abstractions. To answer whether one can modify a C-level R 
objects (an SEXP) in place or not, one should think in C-level R API 
abstractions. One can modify an R object (SEXP x) in place when 
NO_REFERENCES(x) is true.

If this doesn't answer your question, please try to clarify it, explain 
what is the problem you are trying to solve.

Best
Tomas

> It should be possible, I think. R has a few pass-by-reference classes (like environments), so R should be able to check something like this. I just have no idea how exactly R checks this.
>
> Thanks in advance for any response!
>
> Kind regards,
>
> Tony
>
>
>
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From t|m@t@y|or @end|ng |rom h|ddene|eph@nt@@co@uk  Wed Apr 30 10:25:51 2025
From: t|m@t@y|or @end|ng |rom h|ddene|eph@nt@@co@uk (Tim Taylor)
Date: Wed, 30 Apr 2025 09:25:51 +0100
Subject: [R-pkg-devel] Use of long double in configuration
Message-ID: <bc2d2752-547e-4b4d-ba53-86a66816d64c@app.fastmail.com>

Is it correct to say that R's conditional use of long double is around ensuring things work on platforms which have 'long double' identical to 'double' types, as opposed to there being an odd compiler targeted that does not even have any concept of 'long double' type?

As background this was motivated by a query raised in the matrixStats package:
https://github.com/HenrikBengtsson/matrixStats/issues/278


From ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de  Wed Apr 30 10:33:42 2025
From: ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de (Uwe Ligges)
Date: Wed, 30 Apr 2025 10:33:42 +0200
Subject: [R-pkg-devel] Use of long double in configuration
In-Reply-To: <bc2d2752-547e-4b4d-ba53-86a66816d64c@app.fastmail.com>
References: <bc2d2752-547e-4b4d-ba53-86a66816d64c@app.fastmail.com>
Message-ID: <e61ec7a1-4a15-475a-a0c0-624c0512fa1d@statistik.tu-dortmund.de>



On 30.04.2025 10:25, Tim Taylor wrote:
> Is it correct to say that R's conditional use of long double is around ensuring things work on platforms which have 'long double' identical to 'double' types, as opposed to there being an odd compiler targeted that does not even have any concept of 'long double' type?

a double is 64 bit and stored that way on all platforms, the concept of 
long doubles is CPU specific. x86 chips have 80bit in the floating point 
units for calculations before rounding (and normalizing) to a regular 
double.

Some chips, e.g. those ARM chips used in current M[123]Macs (hence very 
relevant topic), do not support long doubles. And compilers offer to 
compile without support for long doubles which e.g. CRAN uses to check 
in an additional (issues) check.

Best,
Uwe Ligges

> 
> As background this was motivated by a query raised in the matrixStats package:
> https://github.com/HenrikBengtsson/matrixStats/issues/278
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From @|mon@urb@nek @end|ng |rom R-project@org  Wed Apr 30 10:40:17 2025
From: @|mon@urb@nek @end|ng |rom R-project@org (Simon Urbanek)
Date: Wed, 30 Apr 2025 20:40:17 +1200
Subject: [R-pkg-devel] Use of long double in configuration
In-Reply-To: <bc2d2752-547e-4b4d-ba53-86a66816d64c@app.fastmail.com>
References: <bc2d2752-547e-4b4d-ba53-86a66816d64c@app.fastmail.com>
Message-ID: <B1E9136F-25A7-404B-9EE4-8FE2317DCC48@R-project.org>

Tim,

no, and as far as I can tell some of the claims in that thread are incorrect. Whether long double is identical to double is irrelevant and has nothing to do with it.

R has a configuration option --enable-long-double which governs whether R should use algorithms which can benefit from extended precision where applicable. However, that is entirely internal to R and has nothing to do with packages, it just changes algorithms used in R itself.

It is definitely a bug in matrixStats to assume that HAVE_LONG_DOUBLE  of LDOUBLE are somehow defined as they are not unless matrixStats does so.

Cheers,
Simon



> On Apr 30, 2025, at 8:25 PM, Tim Taylor <tim.taylor at hiddenelephants.co.uk> wrote:
> 
> Is it correct to say that R's conditional use of long double is around ensuring things work on platforms which have 'long double' identical to 'double' types, as opposed to there being an odd compiler targeted that does not even have any concept of 'long double' type?
> 
> As background this was motivated by a query raised in the matrixStats package:
> https://github.com/HenrikBengtsson/matrixStats/issues/278
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
> 


From t|m@t@y|or @end|ng |rom h|ddene|eph@nt@@co@uk  Wed Apr 30 10:43:24 2025
From: t|m@t@y|or @end|ng |rom h|ddene|eph@nt@@co@uk (Tim Taylor)
Date: Wed, 30 Apr 2025 09:43:24 +0100
Subject: [R-pkg-devel] Use of long double in configuration
In-Reply-To: <e61ec7a1-4a15-475a-a0c0-624c0512fa1d@statistik.tu-dortmund.de>
References: <bc2d2752-547e-4b4d-ba53-86a66816d64c@app.fastmail.com>
 <e61ec7a1-4a15-475a-a0c0-624c0512fa1d@statistik.tu-dortmund.de>
Message-ID: <4e0f4a5a-b2a6-4cdf-9918-067f52dc225f@app.fastmail.com>

Cheers for the quick response.

To clarify my question: Is it correct to say that as long as packages do not assume the greater precision provided by 'double' there is no reason they cannot use 'long double' to get *possible* advantages (e.g. in summations). AFAICT 'long double' is (and has always been) part of the C standard so it's use as a type should be unproblematic (this is the query relevant to matrixStats).

Apologies if this does not make much sense.

Tim



On Wed, 30 Apr 2025, at 9:33 AM, Uwe Ligges wrote:
> On 30.04.2025 10:25, Tim Taylor wrote:
>> Is it correct to say that R's conditional use of long double is around ensuring things work on platforms which have 'long double' identical to 'double' types, as opposed to there being an odd compiler targeted that does not even have any concept of 'long double' type?
>
> a double is 64 bit and stored that way on all platforms, the concept of 
> long doubles is CPU specific. x86 chips have 80bit in the floating point 
> units for calculations before rounding (and normalizing) to a regular 
> double.
>
> Some chips, e.g. those ARM chips used in current M[123]Macs (hence very 
> relevant topic), do not support long doubles. And compilers offer to 
> compile without support for long doubles which e.g. CRAN uses to check 
> in an additional (issues) check.
>
> Best,
> Uwe Ligges
>
>> 
>> As background this was motivated by a query raised in the matrixStats package:
>> https://github.com/HenrikBengtsson/matrixStats/issues/278
>> 
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>
>
> Attachments:
> * smime.p7s


From tom@@@k@||ber@ @end|ng |rom gm@||@com  Wed Apr 30 11:07:17 2025
From: tom@@@k@||ber@ @end|ng |rom gm@||@com (Tomas Kalibera)
Date: Wed, 30 Apr 2025 11:07:17 +0200
Subject: [R-pkg-devel] Use of long double in configuration
In-Reply-To: <4e0f4a5a-b2a6-4cdf-9918-067f52dc225f@app.fastmail.com>
References: <bc2d2752-547e-4b4d-ba53-86a66816d64c@app.fastmail.com>
 <e61ec7a1-4a15-475a-a0c0-624c0512fa1d@statistik.tu-dortmund.de>
 <4e0f4a5a-b2a6-4cdf-9918-067f52dc225f@app.fastmail.com>
Message-ID: <14a5bf54-f860-460b-a6c6-8be9d1905984@gmail.com>


On 4/30/25 10:43, Tim Taylor wrote:
> Cheers for the quick response.
>
> To clarify my question: Is it correct to say that as long as packages do not assume the greater precision provided by 'double' there is no reason they cannot use 'long double' to get *possible* advantages (e.g. in summations). AFAICT 'long double' is (and has always been) part of the C standard so it's use as a type should be unproblematic (this is the query relevant to matrixStats).

Probably already clear from previous answers, but yes, packages can use 
long double type.

Whenever using a long double type, one needs to be careful about making 
sure the algorithms work, and the tests pass (so have reasonable 
tolerances), even when the long double type happens to be just the same 
as double. This is the case on aarch64, and macOS/aarch64 is one of the 
platforms where packages have to work, anyway, so this shouldn't be too 
limiting anymore - but really one needs to test on such platform.

R itself has an option to disable use of long double to make such 
testing in R itself possible also on other platforms. In principle one 
could do something similar in a package, have some ifdefs to disable 
long doubles, but this is not required. And I probably wouldn't do that, 
I'd just test on aarch64 regularly.

See Writing R Extensions for more details.

Best
Tomas

> Apologies if this does not make much sense.
>
> Tim
>
>
>
> On Wed, 30 Apr 2025, at 9:33 AM, Uwe Ligges wrote:
>> On 30.04.2025 10:25, Tim Taylor wrote:
>>> Is it correct to say that R's conditional use of long double is around ensuring things work on platforms which have 'long double' identical to 'double' types, as opposed to there being an odd compiler targeted that does not even have any concept of 'long double' type?
>> a double is 64 bit and stored that way on all platforms, the concept of
>> long doubles is CPU specific. x86 chips have 80bit in the floating point
>> units for calculations before rounding (and normalizing) to a regular
>> double.
>>
>> Some chips, e.g. those ARM chips used in current M[123]Macs (hence very
>> relevant topic), do not support long doubles. And compilers offer to
>> compile without support for long doubles which e.g. CRAN uses to check
>> in an additional (issues) check.
>>
>> Best,
>> Uwe Ligges
>>
>>> As background this was motivated by a query raised in the matrixStats package:
>>> https://github.com/HenrikBengtsson/matrixStats/issues/278
>>>
>>> ______________________________________________
>>> R-package-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>
>> Attachments:
>> * smime.p7s
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From t|m@t@y|or @end|ng |rom h|ddene|eph@nt@@co@uk  Wed Apr 30 11:08:54 2025
From: t|m@t@y|or @end|ng |rom h|ddene|eph@nt@@co@uk (Tim Taylor)
Date: Wed, 30 Apr 2025 10:08:54 +0100
Subject: [R-pkg-devel] Use of long double in configuration
In-Reply-To: <14a5bf54-f860-460b-a6c6-8be9d1905984@gmail.com>
References: <bc2d2752-547e-4b4d-ba53-86a66816d64c@app.fastmail.com>
 <e61ec7a1-4a15-475a-a0c0-624c0512fa1d@statistik.tu-dortmund.de>
 <4e0f4a5a-b2a6-4cdf-9918-067f52dc225f@app.fastmail.com>
 <14a5bf54-f860-460b-a6c6-8be9d1905984@gmail.com>
Message-ID: <d3c4ea69-d835-45b3-ba39-1b5a950fcc29@app.fastmail.com>

Thank you all!

Everything is clear.

Tim

On Wed, 30 Apr 2025, at 10:07 AM, Tomas Kalibera wrote:
> On 4/30/25 10:43, Tim Taylor wrote:
>> Cheers for the quick response.
>>
>> To clarify my question: Is it correct to say that as long as packages do not assume the greater precision provided by 'double' there is no reason they cannot use 'long double' to get *possible* advantages (e.g. in summations). AFAICT 'long double' is (and has always been) part of the C standard so it's use as a type should be unproblematic (this is the query relevant to matrixStats).
>
> Probably already clear from previous answers, but yes, packages can use 
> long double type.
>
> Whenever using a long double type, one needs to be careful about making 
> sure the algorithms work, and the tests pass (so have reasonable 
> tolerances), even when the long double type happens to be just the same 
> as double. This is the case on aarch64, and macOS/aarch64 is one of the 
> platforms where packages have to work, anyway, so this shouldn't be too 
> limiting anymore - but really one needs to test on such platform.
>
> R itself has an option to disable use of long double to make such 
> testing in R itself possible also on other platforms. In principle one 
> could do something similar in a package, have some ifdefs to disable 
> long doubles, but this is not required. And I probably wouldn't do that, 
> I'd just test on aarch64 regularly.
>
> See Writing R Extensions for more details.
>
> Best
> Tomas
>
>> Apologies if this does not make much sense.
>>
>> Tim
>>
>>
>>
>> On Wed, 30 Apr 2025, at 9:33 AM, Uwe Ligges wrote:
>>> On 30.04.2025 10:25, Tim Taylor wrote:
>>>> Is it correct to say that R's conditional use of long double is around ensuring things work on platforms which have 'long double' identical to 'double' types, as opposed to there being an odd compiler targeted that does not even have any concept of 'long double' type?
>>> a double is 64 bit and stored that way on all platforms, the concept of
>>> long doubles is CPU specific. x86 chips have 80bit in the floating point
>>> units for calculations before rounding (and normalizing) to a regular
>>> double.
>>>
>>> Some chips, e.g. those ARM chips used in current M[123]Macs (hence very
>>> relevant topic), do not support long doubles. And compilers offer to
>>> compile without support for long doubles which e.g. CRAN uses to check
>>> in an additional (issues) check.
>>>
>>> Best,
>>> Uwe Ligges
>>>
>>>> As background this was motivated by a query raised in the matrixStats package:
>>>> https://github.com/HenrikBengtsson/matrixStats/issues/278
>>>>
>>>> ______________________________________________
>>>> R-package-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>
>>> Attachments:
>>> * smime.p7s
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From pro|jcn@@h @end|ng |rom gm@||@com  Wed Apr 30 12:29:43 2025
From: pro|jcn@@h @end|ng |rom gm@||@com (J C Nash)
Date: Wed, 30 Apr 2025 06:29:43 -0400
Subject: [R-pkg-devel] Use of long double in configuration
In-Reply-To: <d3c4ea69-d835-45b3-ba39-1b5a950fcc29@app.fastmail.com>
References: <bc2d2752-547e-4b4d-ba53-86a66816d64c@app.fastmail.com>
 <e61ec7a1-4a15-475a-a0c0-624c0512fa1d@statistik.tu-dortmund.de>
 <4e0f4a5a-b2a6-4cdf-9918-067f52dc225f@app.fastmail.com>
 <14a5bf54-f860-460b-a6c6-8be9d1905984@gmail.com>
 <d3c4ea69-d835-45b3-ba39-1b5a950fcc29@app.fastmail.com>
Message-ID: <8799192b-315b-423c-8e83-9d9412b48aa6@gmail.com>

As one of original 30-some members of 1985 IEEE 754, I find it discouraging that
we are treating long-double as the exception, when it is the introduction of
"short double" in M1 etc chips that have forced the issue. There are strong
commercial reasons, but they aren't computational ones.

JN


On 2025-04-30 05:08, Tim Taylor wrote:
> Thank you all!
> 
> Everything is clear.
> 
> Tim
> 
> On Wed, 30 Apr 2025, at 10:07 AM, Tomas Kalibera wrote:
>> On 4/30/25 10:43, Tim Taylor wrote:
>>> Cheers for the quick response.
>>>
>>> To clarify my question: Is it correct to say that as long as packages do not assume the greater precision provided by 'double' there is no reason they cannot use 'long double' to get *possible* advantages (e.g. in summations). AFAICT 'long double' is (and has always been) part of the C standard so it's use as a type should be unproblematic (this is the query relevant to matrixStats).
>>
>> Probably already clear from previous answers, but yes, packages can use
>> long double type.
>>
>> Whenever using a long double type, one needs to be careful about making
>> sure the algorithms work, and the tests pass (so have reasonable
>> tolerances), even when the long double type happens to be just the same
>> as double. This is the case on aarch64, and macOS/aarch64 is one of the
>> platforms where packages have to work, anyway, so this shouldn't be too
>> limiting anymore - but really one needs to test on such platform.
>>
>> R itself has an option to disable use of long double to make such
>> testing in R itself possible also on other platforms. In principle one
>> could do something similar in a package, have some ifdefs to disable
>> long doubles, but this is not required. And I probably wouldn't do that,
>> I'd just test on aarch64 regularly.
>>
>> See Writing R Extensions for more details.
>>
>> Best
>> Tomas
>>
>>> Apologies if this does not make much sense.
>>>
>>> Tim
>>>
>>>
>>>
>>> On Wed, 30 Apr 2025, at 9:33 AM, Uwe Ligges wrote:
>>>> On 30.04.2025 10:25, Tim Taylor wrote:
>>>>> Is it correct to say that R's conditional use of long double is around ensuring things work on platforms which have 'long double' identical to 'double' types, as opposed to there being an odd compiler targeted that does not even have any concept of 'long double' type?
>>>> a double is 64 bit and stored that way on all platforms, the concept of
>>>> long doubles is CPU specific. x86 chips have 80bit in the floating point
>>>> units for calculations before rounding (and normalizing) to a regular
>>>> double.
>>>>
>>>> Some chips, e.g. those ARM chips used in current M[123]Macs (hence very
>>>> relevant topic), do not support long doubles. And compilers offer to
>>>> compile without support for long doubles which e.g. CRAN uses to check
>>>> in an additional (issues) check.
>>>>
>>>> Best,
>>>> Uwe Ligges
>>>>
>>>>> As background this was motivated by a query raised in the matrixStats package:
>>>>> https://github.com/HenrikBengtsson/matrixStats/issues/278
>>>>>
>>>>> ______________________________________________
>>>>> R-package-devel at r-project.org mailing list
>>>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>>
>>>> Attachments:
>>>> * smime.p7s
>>> ______________________________________________
>>> R-package-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From N||@@Lue@chow @end|ng |rom un|-due@@e|dor|@de  Tue Apr 29 14:43:40 2025
From: N||@@Lue@chow @end|ng |rom un|-due@@e|dor|@de (=?UTF-8?Q?Nils_L=C3=BCschow?=)
Date: Tue, 29 Apr 2025 14:43:40 +0200
Subject: [R-pkg-devel] Problem building package depending on third party c++
 source library.
Message-ID: <ed3ae707af8e1af36f51e73581ee14af@uni-duesseldorf.de>

Hello everybody,

as a new feature for the anticlust package 
(https://cran.r-project.org/web/packages/anticlust/index.html) we are 
trying to include a constraint programming model, written in C++ 
utilizing the Gecode solver. While we generally got this feature to work 
when Gecode is pre-installed on the system, we would like to spare the 
users this step and include it with the package (or inside a 
supplementary package) to install through the regular R tooling. 
However, we run into a problem when it comes to compiling Gecode during 
the packages build-process, which I describe in this SO post:

https://stackoverflow.com/questions/79596214/configure-script-does-not-generate-makefile-properly-for-3rd-party-library-used

I strongly suspect the Makevars file to be incorrect, if you want to 
take a look or try to compile it yourself, I have uploaded the code of 
the new feature as well as the source files of the Gecode library to 
GitHub:

https://github.com/nilslueschow/Anticlust-Dispersion-Constraint-Model/tree/main/RcppTestPackage/src

Thanks for your help!

Best,
Nils L?schow


From @ergue|@@oko| @end|ng |rom gm@||@com  Wed Apr 30 15:31:37 2025
From: @ergue|@@oko| @end|ng |rom gm@||@com (Serguei Sokol)
Date: Wed, 30 Apr 2025 15:31:37 +0200
Subject: [R-pkg-devel] 
 Problem building package depending on third party c++
 source library.
In-Reply-To: <ed3ae707af8e1af36f51e73581ee14af@uni-duesseldorf.de>
References: <ed3ae707af8e1af36f51e73581ee14af@uni-duesseldorf.de>
Message-ID: <d0ec2d12-2dfb-4b13-9ff4-cae945ad4726@gmail.com>

Le 29/04/2025 ? 14:43, Nils L?schow a ?crit?:
> Hello everybody,
> 
> as a new feature for the anticlust package (https://cran.r-project.org/ 
> web/packages/anticlust/index.html) we are trying to include a constraint 
> programming model, written in C++ utilizing the Gecode solver. While we 
> generally got this feature to work when Gecode is pre-installed on the 
> system, we would like to spare the users this step and include it with 
> the package (or inside a supplementary package) to install through the 
> regular R tooling. However, we run into a problem when it comes to 
> compiling Gecode during the packages build-process, which I describe in 
> this SO post:
> 
> https://stackoverflow.com/questions/79596214/configure-script-does-not- 
> generate-makefile-properly-for-3rd-party-library-used
> 
> I strongly suspect the Makevars file to be incorrect, if you want to 
> take a look or try to compile it yourself, I have uploaded the code of 
> the new feature as well as the source files of the Gecode library to 
> GitHub:
> 
> https://github.com/nilslueschow/Anticlust-Dispersion-Constraint-Model/ 
> tree/main/RcppTestPackage/src
I don't know if it is the source of your problem but it's safer to use 
CC and CXX variables provided by R building process (they are already 
predefined when you are in Makevars) which minimize the risks of 
incompatibility between R and your library. So instead of

cd $(GECODE_DIR) && $(MAKE)

I'd use something like

$(MAKE) -C $(GECODE_DIR) CC="$(CC)" CXX="$(CXX)" CXXFLAGS="$(CXXFLAGS)"

Best,
Serguei.

> 
> Thanks for your help!
> 
> Best,
> Nils L?schow
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From |kry|ov @end|ng |rom d|@root@org  Wed Apr 30 20:57:41 2025
From: |kry|ov @end|ng |rom d|@root@org (Ivan Krylov)
Date: Wed, 30 Apr 2025 21:57:41 +0300
Subject: [R-pkg-devel] 
 Problem building package depending on third party c++
 source library.
In-Reply-To: <ed3ae707af8e1af36f51e73581ee14af@uni-duesseldorf.de>
References: <ed3ae707af8e1af36f51e73581ee14af@uni-duesseldorf.de>
Message-ID: <20250430215741.445338cd@Tarkus>

? Tue, 29 Apr 2025 14:43:40 +0200
Nils L?schow <Nils.Lueschow at uni-duesseldorf.de> ?????:

> While we generally got this feature to work when Gecode is
> pre-installed on the system, we would like to spare the users this
> step and include it with the package

It's probably a good idea to try to achieve both. If a system copy of
the package is available, link with it; otherwise build the bundled
copy. Unfortunately, this kind of user convenience involves a lot of
testing to make sure that both configurations work as intended.
Bundling dependencies also creates headaches for distro packagers.

> However, we run into a problem when it comes to compiling Gecode
> during the packages build-process, which I describe in this SO post

One problem is that when using $(MAKE) to compile gecode, various
variables used by gecode's Makefile are overridden through the
MAKEFLAGS variable. For example, $(CXX) ends up being defined as
$(CXX20) $(CXX20STD) without the variables CXX20 and CXX20STD being
available to the downstream Make process. What's worse is CXXFLAGS are
also overridden, losing the include paths in the process.

In order to build gecode from Makevars, you'll have to disable these
overrides by emptying MAKEFLAGS:

build_gecode:
        cd $(GECODE_DIR) && \
	./configure CC="$(CC)" CXX="$(CXX20) $(CXX20STD)" \
		--disable-examples --enable-static --disable-shared
	$(MAKE) -C $(GECODE_DIR) MAKEFLAGS=

(Alternatively, you can ./configure and build the library from the
./configure script of your package.)

Other changes are also needed to make the package build in a portable
manner:

 - Recipe lines in Makefiles must start with tabs, not groups of
   four spaces.
 - Don't use GNU Make append syntax (+=) without declaring
   SystemRequirements: GNU Make.
 - Don't set compiler-specific flags such as -mtune=native without at
   least testing that the compiler understands them.
 - With the current directory structure, GECODE_DIR must be just
   gecode, not $(CURDIR)/gecode-release-6.3.0.
 - Since the C++ source code already uses #include <gecode/...>, the
   include path must be -I$(GECODE_DIR), not -I$(GECODE_DIR)/gecode.
 - Don't hard-code compiler names. Instead of ./configure CC=gcc ...,
   use ./configure CC="$(CC)" CXX="$(CXX20) $(CXX20STD)".
 - Build gecode as a static library and link it into the package
   shared library. Otherwise you'll need to arrange for the gecode
   shared libraries to be installed together with the R package and
   properly loaded before your package shared library.
 - Provide a 'clean' target so that R CMD build doesn't include the
   binaries from the gecode subdirectory into the source package.

With that, we get the following Makevars:

all: $(SHLIB)

GECODE_DIR = gecode
PKG_CPPFLAGS = -I$(GECODE_DIR)
PKG_LIBS = -L$(GECODE_DIR) -lgecodesearch -lgecodeminimodel \
           -lgecodeint -lgecodekernel -lgecodesupport
CXX_STD = CXX20

$(SHLIB): gecode_built
# package code relies on header files only available after gecode is
# configured and probably built
$(OBJECTS): gecode_built

gecode_built:
	cd $(GECODE_DIR) && \
		./configure CC="$(CC)" CXX="$(CXX20) $(CXX20STD)" \
		--disable-examples --enable-static --disable-shared \
		--disable-flatzinc --disable-qt
	$(MAKE) -C $(GECODE_DIR) MAKEFLAGS=
	touch $@

clean:
	-cd $(GECODE_DIR) && make clean
	-rm -f gecode_built

Hopefully, the Makevars.win with same contents but
--with-host-os=windows added to the configure flags will work on
Windows. (It needs to be .win, not .ucrt, because your package declares
support for R > 3.6, which predates use of UCRT in R. To think of it,
R-3.6.0 also predates C++20...) You can probably give some more
--disable-... arguments to ./configure to remove some more components
that the R package doesn't use.

However, this is only the beginning of the troubles.

R packages are not allowed file path lengths above 100 bytes, and your
package has seven that are longer, e.g.,

>> RcppTestPackage/src/gecode/gecode/third-party/boost/numeric/interval/detail/x86gcc_rounding_control.hpp

Maybe you can unbundle the bits of Boost and rely on the 'BH' package
instead. Maybe there's a way to rename the files and patch the includes
in the source code.

The gecode library produces a lot of warnings, and R CMD check
considers some of them serious:

>> Found the following significant warnings:
>> ./gecode/kernel/core.hpp:4102:24: warning: array subscript -1 is
>> below array bounds of ?unsigned int [1]? [-Warray-bounds]
>> ./gecode/kernel/core.hpp:4109:17: warning: array subscript -1 is
>> below array bounds of ?unsigned int [1]? [-Warray-bounds]
>> ./gecode/support/allocator.hpp:88:11: warning: ?void free(void*)?
>> called on pointer returned from a mismatched allocation function
>> [-Wmismatched-new-delete]                 

The -Warray-bounds warnings might be false positives (could pc_max ever
be 0?), but -Wmismatched-new-delete is probably real; the compiler
shows a place where an object allocated using new(...) can be
deallocated using free(...).

Some parts of the gecode library contain references to std::cerr, and
the R package code calls rand(). These are not recommended in R
packages, because the standard error stream isn't necessarily connected
to the terminal and because rand() is disconnected from R's random
number generator.

Once you build the whole gecode yourself, be ready for it being tested
with AddressSanitizer and UndefinedBehaviorSanitizer. Things like
free(new(...)) that were previously invisible to them (due to the
third-party library being compiled without sanitizers) will now be
revealed (and become yours to fix instead of just something happening
upstream).

There are other problems noted by R CMD check, but they should be
easier to fix.

-- 
Best regards,
Ivan


From @m@||ep@||on @end|ng |rom proton@me  Fri May  2 02:21:50 2025
From: @m@||ep@||on @end|ng |rom proton@me (smallepsilon)
Date: Fri, 02 May 2025 00:21:50 +0000
Subject: [R-pkg-devel] advice for fixing MKL issues
Message-ID: <nUm987XUqdAVvDnpilVVweDdiYHbTCCECB4EAWdxKEvmnYNxcDdXRjqhpZCt-fWvEZeNdd1UrE0WyfM4KiAitODfwcusyR6oVbKOQQkGBp8=@proton.me>

I recently got an email from CRAN regarding MKL issues for an R package I submitted in November. Does anyone have any advice on fixing issues with MKL? I want to install it locally so I can test locally, instead of guessing at the problem and uploading to CRAN with the hope that I correctly identified the issues. I found an old post online (https://stackoverflow.com/questions/38090206/linking-intels-math-kernel-library-mkl-to-r-on-windows) with instructions for using MKL with R on Windows (which I am using), but these did not work for me. Any advice for what to try next?

Jesse
	[[alternative HTML version deleted]]


From tom@@@k@||ber@ @end|ng |rom gm@||@com  Fri May  2 09:54:57 2025
From: tom@@@k@||ber@ @end|ng |rom gm@||@com (Tomas Kalibera)
Date: Fri, 2 May 2025 09:54:57 +0200
Subject: [R-pkg-devel] advice for fixing MKL issues
In-Reply-To: <nUm987XUqdAVvDnpilVVweDdiYHbTCCECB4EAWdxKEvmnYNxcDdXRjqhpZCt-fWvEZeNdd1UrE0WyfM4KiAitODfwcusyR6oVbKOQQkGBp8=@proton.me>
References: <nUm987XUqdAVvDnpilVVweDdiYHbTCCECB4EAWdxKEvmnYNxcDdXRjqhpZCt-fWvEZeNdd1UrE0WyfM4KiAitODfwcusyR6oVbKOQQkGBp8=@proton.me>
Message-ID: <e79855b8-29a5-4124-92ae-ff11eab51c72@gmail.com>

I think it would be simplest to do this work on Linux. Getting a Linux 
installation/VM would probably be more staightforward than debugging the 
issues with MKL on Windows.

See "A.3.1.3 Intel MKL" in R Admin manual for more.

Best
Tomas

On 5/2/25 02:21, smallepsilon wrote:
> I recently got an email from CRAN regarding MKL issues for an R package I submitted in November. Does anyone have any advice on fixing issues with MKL? I want to install it locally so I can test locally, instead of guessing at the problem and uploading to CRAN with the hope that I correctly identified the issues. I found an old post online (https://stackoverflow.com/questions/38090206/linking-intels-math-kernel-library-mkl-to-r-on-windows) with instructions for using MKL with R on Windows (which I am using), but these did not work for me. Any advice for what to try next?
>
> Jesse
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From @|mon@urb@nek @end|ng |rom R-project@org  Mon May  5 01:25:06 2025
From: @|mon@urb@nek @end|ng |rom R-project@org (Simon Urbanek)
Date: Mon, 5 May 2025 11:25:06 +1200
Subject: [R-pkg-devel] Use of long double in configuration
In-Reply-To: <8799192b-315b-423c-8e83-9d9412b48aa6@gmail.com>
References: <bc2d2752-547e-4b4d-ba53-86a66816d64c@app.fastmail.com>
 <e61ec7a1-4a15-475a-a0c0-624c0512fa1d@statistik.tu-dortmund.de>
 <4e0f4a5a-b2a6-4cdf-9918-067f52dc225f@app.fastmail.com>
 <14a5bf54-f860-460b-a6c6-8be9d1905984@gmail.com>
 <d3c4ea69-d835-45b3-ba39-1b5a950fcc29@app.fastmail.com>
 <8799192b-315b-423c-8e83-9d9412b48aa6@gmail.com>
Message-ID: <1EE6948A-6F78-4306-8272-2AE79EB27282@R-project.org>

John,

it's sort of the other way around: because neither the implementation, format nor precision of "long double" are defined by the C standard (it's not even required to be based on IEEE 754/IEC 60559 at all), it is essentially left to the compilers+runtimes to do whatever they choose, making it a bit of a wild card. Historically, anything beyond double precision was emulated since most hardware was unable to natively deal with it, so that?s why you had to think hard if you wanted to use it as the penalty could be an order of magnitude or more. It wasn't until Intel?s math co-processor and its 80-bit extended precision format which reduced the penalty for such operations on that CPU and was mapped to long double - at the cost of results being hardware-specific, somewhat arbitrary and only 2.5x precision (while occupying 4x the space). So long double is just a simple way to say "do your best" without defining any specifics.

I?m not sure what you mean by "short double" as double precision is defined as 64-bit, so "short double" would be simply 32-bit = single precision. More recent introduction of varying floating point precisions such as fp8, f16 etc. (assuming that?s what you meant by "short double" on M1) are performance and memory usage optimizations for use-cases where the precision is less important than memory usage, such as in large NNs. M1 is just one of the modern chips that added co-processors specifically for matrix operations on different precisions like fp16, fp32, fp64 - with great performance gains (e.g., using AMX via Apple's BLAS/LAPACK with double precision in R on M1 is over 100x faster than the CPU-based reference version for some operations).

As for precision beyond doubles, Apple has asked few years ago the scientific community whether there is interest in fp128 (quad precision) and the response was no, it?s not a priority, so I would assume that?s why it has been left to emulations (it is interesting in retrospect, because at that point we had no idea that they were designing what became Apple Silicon). I presume it would be possible to leverage the Apple matrix co-processor for fp128 operations (e.g., PowerPC used double-double arithmetics implementation as a precedent), but given the low priority I have not seen it yet.

Cheers,
Simon


> On Apr 30, 2025, at 10:29 PM, J C Nash <profjcnash at gmail.com> wrote:
> 
> As one of original 30-some members of 1985 IEEE 754, I find it discouraging that we are treating long-double as the exception, when it is the introduction of "short double" in M1 etc chips that have forced the issue. There are strong commercial reasons, but they aren't computational ones.
> 
> JN
> 
> 
> On 2025-04-30 05:08, Tim Taylor wrote:
>> Thank you all!
>> Everything is clear.
>> Tim
>> On Wed, 30 Apr 2025, at 10:07 AM, Tomas Kalibera wrote:
>>> On 4/30/25 10:43, Tim Taylor wrote:
>>>> Cheers for the quick response.
>>>> 
>>>> To clarify my question: Is it correct to say that as long as packages do not assume the greater precision provided by 'double' there is no reason they cannot use 'long double' to get *possible* advantages (e.g. in summations). AFAICT 'long double' is (and has always been) part of the C standard so it's use as a type should be unproblematic (this is the query relevant to matrixStats).
>>> 
>>> Probably already clear from previous answers, but yes, packages can use
>>> long double type.
>>> 
>>> Whenever using a long double type, one needs to be careful about making
>>> sure the algorithms work, and the tests pass (so have reasonable
>>> tolerances), even when the long double type happens to be just the same
>>> as double. This is the case on aarch64, and macOS/aarch64 is one of the
>>> platforms where packages have to work, anyway, so this shouldn't be too
>>> limiting anymore - but really one needs to test on such platform.
>>> 
>>> R itself has an option to disable use of long double to make such
>>> testing in R itself possible also on other platforms. In principle one
>>> could do something similar in a package, have some ifdefs to disable
>>> long doubles, but this is not required. And I probably wouldn't do that,
>>> I'd just test on aarch64 regularly.
>>> 
>>> See Writing R Extensions for more details.
>>> 
>>> Best
>>> Tomas
>>> 
>>>> Apologies if this does not make much sense.
>>>> 
>>>> Tim
>>>> 
>>>> 
>>>> 
>>>> On Wed, 30 Apr 2025, at 9:33 AM, Uwe Ligges wrote:
>>>>> On 30.04.2025 10:25, Tim Taylor wrote:
>>>>>> Is it correct to say that R's conditional use of long double is around ensuring things work on platforms which have 'long double' identical to 'double' types, as opposed to there being an odd compiler targeted that does not even have any concept of 'long double' type?
>>>>> a double is 64 bit and stored that way on all platforms, the concept of
>>>>> long doubles is CPU specific. x86 chips have 80bit in the floating point
>>>>> units for calculations before rounding (and normalizing) to a regular
>>>>> double.
>>>>> 
>>>>> Some chips, e.g. those ARM chips used in current M[123]Macs (hence very
>>>>> relevant topic), do not support long doubles. And compilers offer to
>>>>> compile without support for long doubles which e.g. CRAN uses to check
>>>>> in an additional (issues) check.
>>>>> 
>>>>> Best,
>>>>> Uwe Ligges
>>>>> 
>>>>>> As background this was motivated by a query raised in the matrixStats package:
>>>>>> https://github.com/HenrikBengtsson/matrixStats/issues/278
>>>>>> 
>>>>>> ______________________________________________
>>>>>> R-package-devel at r-project.org mailing list
>>>>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>>> 
>>>>> Attachments:
>>>>> * smime.p7s
>>>> ______________________________________________
>>>> R-package-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
> 


From pro|jcn@@h @end|ng |rom gm@||@com  Mon May  5 03:23:25 2025
From: pro|jcn@@h @end|ng |rom gm@||@com (J C Nash)
Date: Sun, 4 May 2025 21:23:25 -0400
Subject: [R-pkg-devel] Use of long double in configuration
In-Reply-To: <1EE6948A-6F78-4306-8272-2AE79EB27282@R-project.org>
References: <bc2d2752-547e-4b4d-ba53-86a66816d64c@app.fastmail.com>
 <e61ec7a1-4a15-475a-a0c0-624c0512fa1d@statistik.tu-dortmund.de>
 <4e0f4a5a-b2a6-4cdf-9918-067f52dc225f@app.fastmail.com>
 <14a5bf54-f860-460b-a6c6-8be9d1905984@gmail.com>
 <d3c4ea69-d835-45b3-ba39-1b5a950fcc29@app.fastmail.com>
 <8799192b-315b-423c-8e83-9d9412b48aa6@gmail.com>
 <1EE6948A-6F78-4306-8272-2AE79EB27282@R-project.org>
Message-ID: <703303b3-0eff-42dd-b9bc-29181d3d3068@gmail.com>

By "short double" I simply meant the 64 bit double without the extended precision.
Wikipedia has a "long double" article, and is quite good in showing the diversity
of interpretations.

I've not spent much time looking at the standards since the 80s, except to note
the move to make the extended bits optional recently. As far as I am aware, any
precision above 64 bit storage but 80 bits in registers required special software
and hardware, but the 64/80 combination seemed to be more or less a given until
the M? chips came along.

For a while I recall there were all sorts of things with gate arrays to make
special hardware. They needed special compilers and were a nuisance to use.
Fortunately, not a great many computations require more than 64 bit doubles,
but there are some situations that need the extra precision for some of the time.
I remember Kahan saying it was like passing lanes added to two lane highways
to clear out the lines behind a slow truck.

The widespread adoption of IEEE 754 with the 80 bit extended was a great step
forward. For a while most hardware implemented it, but the M? chips don't
have registers, hence the push for changing the standard. It's a pity mechanical
calculators are no longer common, like the Monroe manual I gave away to a
charity last year. They had double width accumulator carriages for a reason,
and make the situation very obvious.

The burden for R developers is that a lot of the behind the screen computations
are done with pretty old codes that very likely were developed with extended
"thinking". Particularly if there are accumulations e.g., of inner products,
we can expect that there will be some surprises. My guess is that there
will need to be some adjustment of the internal routines, most likely to define
somewhat lower standards. My experience has been that results that are a bit
different cause lots of confusion, even if the reality isn't of great import,
and such confusion will be the main waste of time.

I built the "Compact numerical methods" on Data General machines, which had
32 bit floating point with I recall 24 bit mantissa. Later (worse!) the
DG Eclipse used 6 hex digits mantissa. The special functions were pretty
cruddy too. So my codes were incredibly defensive, making them quite reliable
but pretty slow. Also I had to fit program and data in 4K bytes, so the
codes left out bells and whistles. Then we got IEEE 754, which really
helped us out of the bog of weird and not wonderful floating point.
Look up "Fuzz" on Tektronix BASIC. Messed up a lot of my codes.

Cheers,

JN





On 2025-05-04 19:25, Simon Urbanek wrote:
> John,
> 
> it's sort of the other way around: because neither the implementation, format nor precision of "long double" are defined by the C standard (it's not even required to be based on IEEE 754/IEC 60559 at all), it is essentially left to the compilers+runtimes to do whatever they choose, making it a bit of a wild card. Historically, anything beyond double precision was emulated since most hardware was unable to natively deal with it, so that?s why you had to think hard if you wanted to use it as the penalty could be an order of magnitude or more. It wasn't until Intel?s math co-processor and its 80-bit extended precision format which reduced the penalty for such operations on that CPU and was mapped to long double - at the cost of results being hardware-specific, somewhat arbitrary and only 2.5x precision (while occupying 4x the space). So long double is just a simple way to say "do your best" without defining any specifics.
> 
> I?m not sure what you mean by "short double" as double precision is defined as 64-bit, so "short double" would be simply 32-bit = single precision. More recent introduction of varying floating point precisions such as fp8, f16 etc. (assuming that?s what you meant by "short double" on M1) are performance and memory usage optimizations for use-cases where the precision is less important than memory usage, such as in large NNs. M1 is just one of the modern chips that added co-processors specifically for matrix operations on different precisions like fp16, fp32, fp64 - with great performance gains (e.g., using AMX via Apple's BLAS/LAPACK with double precision in R on M1 is over 100x faster than the CPU-based reference version for some operations).
> 
> As for precision beyond doubles, Apple has asked few years ago the scientific community whether there is interest in fp128 (quad precision) and the response was no, it?s not a priority, so I would assume that?s why it has been left to emulations (it is interesting in retrospect, because at that point we had no idea that they were designing what became Apple Silicon). I presume it would be possible to leverage the Apple matrix co-processor for fp128 operations (e.g., PowerPC used double-double arithmetics implementation as a precedent), but given the low priority I have not seen it yet.
> 
> Cheers,
> Simon
> 
> 
>> On Apr 30, 2025, at 10:29 PM, J C Nash <profjcnash at gmail.com> wrote:
>>
>> As one of original 30-some members of 1985 IEEE 754, I find it discouraging that we are treating long-double as the exception, when it is the introduction of "short double" in M1 etc chips that have forced the issue. There are strong commercial reasons, but they aren't computational ones.
>>
>> JN
>>
>>
>> On 2025-04-30 05:08, Tim Taylor wrote:
>>> Thank you all!
>>> Everything is clear.
>>> Tim
>>> On Wed, 30 Apr 2025, at 10:07 AM, Tomas Kalibera wrote:
>>>> On 4/30/25 10:43, Tim Taylor wrote:
>>>>> Cheers for the quick response.
>>>>>
>>>>> To clarify my question: Is it correct to say that as long as packages do not assume the greater precision provided by 'double' there is no reason they cannot use 'long double' to get *possible* advantages (e.g. in summations). AFAICT 'long double' is (and has always been) part of the C standard so it's use as a type should be unproblematic (this is the query relevant to matrixStats).
>>>>
>>>> Probably already clear from previous answers, but yes, packages can use
>>>> long double type.
>>>>
>>>> Whenever using a long double type, one needs to be careful about making
>>>> sure the algorithms work, and the tests pass (so have reasonable
>>>> tolerances), even when the long double type happens to be just the same
>>>> as double. This is the case on aarch64, and macOS/aarch64 is one of the
>>>> platforms where packages have to work, anyway, so this shouldn't be too
>>>> limiting anymore - but really one needs to test on such platform.
>>>>
>>>> R itself has an option to disable use of long double to make such
>>>> testing in R itself possible also on other platforms. In principle one
>>>> could do something similar in a package, have some ifdefs to disable
>>>> long doubles, but this is not required. And I probably wouldn't do that,
>>>> I'd just test on aarch64 regularly.
>>>>
>>>> See Writing R Extensions for more details.
>>>>
>>>> Best
>>>> Tomas
>>>>
>>>>> Apologies if this does not make much sense.
>>>>>
>>>>> Tim
>>>>>
>>>>>
>>>>>
>>>>> On Wed, 30 Apr 2025, at 9:33 AM, Uwe Ligges wrote:
>>>>>> On 30.04.2025 10:25, Tim Taylor wrote:
>>>>>>> Is it correct to say that R's conditional use of long double is around ensuring things work on platforms which have 'long double' identical to 'double' types, as opposed to there being an odd compiler targeted that does not even have any concept of 'long double' type?
>>>>>> a double is 64 bit and stored that way on all platforms, the concept of
>>>>>> long doubles is CPU specific. x86 chips have 80bit in the floating point
>>>>>> units for calculations before rounding (and normalizing) to a regular
>>>>>> double.
>>>>>>
>>>>>> Some chips, e.g. those ARM chips used in current M[123]Macs (hence very
>>>>>> relevant topic), do not support long doubles. And compilers offer to
>>>>>> compile without support for long doubles which e.g. CRAN uses to check
>>>>>> in an additional (issues) check.
>>>>>>
>>>>>> Best,
>>>>>> Uwe Ligges
>>>>>>
>>>>>>> As background this was motivated by a query raised in the matrixStats package:
>>>>>>> https://github.com/HenrikBengtsson/matrixStats/issues/278
>>>>>>>
>>>>>>> ______________________________________________
>>>>>>> R-package-devel at r-project.org mailing list
>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>>>>
>>>>>> Attachments:
>>>>>> * smime.p7s
>>>>> ______________________________________________
>>>>> R-package-devel at r-project.org mailing list
>>>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>> ______________________________________________
>>> R-package-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>
>


From qu|k@||ver67213 @end|ng |rom y@hoo@com  Wed May  7 22:10:50 2025
From: qu|k@||ver67213 @end|ng |rom y@hoo@com (Mat Fok)
Date: Wed, 7 May 2025 20:10:50 +0000 (UTC)
Subject: [R-pkg-devel] Run Examples Not Found
References: <1856609866.1328592.1746648650371.ref@mail.yahoo.com>
Message-ID: <1856609866.1328592.1746648650371@mail.yahoo.com>

Hi,
My example sources data from olr/inst/extdata and I point to it in my example. I do not include the `dontrun{}` function around this @examples as I want to be able to click "Run Examples" in my Help documentation but I get the error /Example/olr not found. I was thinking maybe I should have a folder called Example, but ChatGPT said no. I have searched online for this but the most relevant thing I have found was?stackoverflow.com/questions/76365640/r-roxygen-examples-example-foo-bar-not-found,?but no one answered and it is over a year old.

| 
| 
| 
|  |  |

 |

 |
| 
|  | 
R Roxygen @examples /Example/foo_bar not found

I am creating an R package and can't run the examples when using devtools::load_all()I always get /Example/func...
 |

 |

 |

?

Here is my example:
#' @examples#' # Option 1: Manual loading from package (if preferred)#' # file <- system.file("extdata", "crudeoildata.csv", package = "olr", mustWork = TRUE)#' # crudeoildata <- read.csv(file, header = TRUE)#' # dataset <- crudeoildata[, -1]#'#' # Option 2: Preferred - using load_custom_data()#' dataset <- load_custom_data("crudeoildata.csv", exclude_first_column = TRUE)#'#' responseName <- "CrudeOil"#' predictorNames <- c("RigCount", "API", "FieldProduction", "RefinerNetInput",#'? ?"OperableCapacity", "Imports", "StocksExcludingSPR", "NonCommercialLong",#'? ?"NonCommercialShort", "CommercialLong", "CommercialShort", "OpenInterest")#'#' olr(dataset, responseName, predictorNames, adjr2 = FALSE)
Here is my file structure:
olr/??? DESCRIPTION??? NAMESPACE??? .Rhistory??? R/?? ???? olr_function.R?? ???? utils.R??? man/?? ???? olr.Rd?? ???? load_custom_data.Rd??? inst/? ? ??? extdata/? ? ? ? ??? crudeoildata.csv
How do I Run Examples properly?
Thanks,
Mathew Fok

	[[alternative HTML version deleted]]


From m|ch@e|ch|r|co4 @end|ng |rom gm@||@com  Wed May  7 23:18:06 2025
From: m|ch@e|ch|r|co4 @end|ng |rom gm@||@com (Michael Chirico)
Date: Wed, 7 May 2025 14:18:06 -0700
Subject: [R-pkg-devel] Run Examples Not Found
In-Reply-To: <1856609866.1328592.1746648650371@mail.yahoo.com>
References: <1856609866.1328592.1746648650371.ref@mail.yahoo.com>
 <1856609866.1328592.1746648650371@mail.yahoo.com>
Message-ID: <CAPRVBcyOBxqc_s5AeuemA9P9vkLQSRjtVXUXhQ7QbLKtFwngzQ@mail.gmail.com>

Hi Mat, glancing at what I believe to be your package sources [1]

You have non-R exposition in your \examples{...}. Examples are code --
you should be able to run them like any other code.

Moreover, they should be self-contained -- expecting the user to
create 'oildata' themselves won't work.

Why not use

oildata <- read.csv(system.file("extdata", "oildata.csv", package="olr"))

Inside the example instead?

You might also consider turning 'oildata' into a proper data object
exported by your package [2]

Mike C

PS your text got mangled, it's quite hard to read your message -- I've
made a best effort to do so. Look how it renders [3]. Please turn on
'Plain text mode' for messages to this list to avoid this issue.

[1] https://github.com/MatHatter/olr_r/blob/4eeca43a947823aadddd97cbc9bafc43401c2848/olr/man/olr.Rd#L38-L51
[2] https://cran.r-project.org/doc/manuals/r-release/R-exts.html#Data-in-packages
[3] https://stat.ethz.ch/pipermail/r-package-devel/2025q2/011641.html

On Wed, May 7, 2025 at 1:11?PM Mat Fok via R-package-devel
<r-package-devel at r-project.org> wrote:
>
> Hi,
> My example sources data from olr/inst/extdata and I point to it in my example. I do not include the `dontrun{}` function around this @examples as I want to be able to click "Run Examples" in my Help documentation but I get the error /Example/olr not found. I was thinking maybe I should have a folder called Example, but ChatGPT said no. I have searched online for this but the most relevant thing I have found was stackoverflow.com/questions/76365640/r-roxygen-examples-example-foo-bar-not-found, but no one answered and it is over a year old.
>
> |
> |
> |
> |  |  |
>
>  |
>
>  |
> |
> |  |
> R Roxygen @examples /Example/foo_bar not found
>
> I am creating an R package and can't run the examples when using devtools::load_all()I always get /Example/func...
>  |
>
>  |
>
>  |
>
>
>
> Here is my example:
> #' @examples#' # Option 1: Manual loading from package (if preferred)#' # file <- system.file("extdata", "crudeoildata.csv", package = "olr", mustWork = TRUE)#' # crudeoildata <- read.csv(file, header = TRUE)#' # dataset <- crudeoildata[, -1]#'#' # Option 2: Preferred - using load_custom_data()#' dataset <- load_custom_data("crudeoildata.csv", exclude_first_column = TRUE)#'#' responseName <- "CrudeOil"#' predictorNames <- c("RigCount", "API", "FieldProduction", "RefinerNetInput",#'   "OperableCapacity", "Imports", "StocksExcludingSPR", "NonCommercialLong",#'   "NonCommercialShort", "CommercialLong", "CommercialShort", "OpenInterest")#'#' olr(dataset, responseName, predictorNames, adjr2 = FALSE)
> Here is my file structure:
> olr/??? DESCRIPTION??? NAMESPACE??? .Rhistory??? R/?   ??? olr_function.R?   ??? utils.R??? man/?   ??? olr.Rd?   ??? load_custom_data.Rd??? inst/    ??? extdata/        ??? crudeoildata.csv
> How do I Run Examples properly?
> Thanks,
> Mathew Fok
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From |kry|ov @end|ng |rom d|@root@org  Thu May  8 16:49:35 2025
From: |kry|ov @end|ng |rom d|@root@org (Ivan Krylov)
Date: Thu, 8 May 2025 17:49:35 +0300
Subject: [R-pkg-devel] Run Examples Not Found
In-Reply-To: <1856609866.1328592.1746648650371@mail.yahoo.com>
References: <1856609866.1328592.1746648650371.ref@mail.yahoo.com>
 <1856609866.1328592.1746648650371@mail.yahoo.com>
Message-ID: <20250508174936.430b0818@trisector>

? Wed, 7 May 2025 20:10:50 +0000 (UTC)
Mat Fok via R-package-devel <r-package-devel at r-project.org> ?????:

> I want to be able to click "Run Examples" in my Help documentation
> but I get the error /Example/olr not found. 

> I have searched online for this but the most relevant thing I have
> found was
> stackoverflow.com/questions/76365640/r-roxygen-examples-example-foo-bar-not-found,
> but no one answered and it is over a year old.

Are you using load_all()? According to the documentation (see
?pkgload::load_all), example() is not one of the functions emulated by
load_all(). Without emulation, it needs an installed package with a
table of help pages and their aliases.

Does it also not work if you use R CMD build and R CMD INSTALL?

-- 
Best regards,
Ivan


From j@@g@rc|@ @end|ng |rom cnb@c@|c@e@  Thu May  8 15:37:11 2025
From: j@@g@rc|@ @end|ng |rom cnb@c@|c@e@ (Juan Antonio Garcia Martin)
Date: Thu, 8 May 2025 15:37:11 +0200
Subject: [R-pkg-devel] Functions requiring packages listed on Suggests
Message-ID: <068c8892-0b1f-4639-b40f-d2fc47ccba43@cnb.csic.es>

Dear mantainers,

I have a question, since one of my packages currently does not pass the 
onSuggest special check.

Two functions of my package require some of the suggested packages 
either in CRAN (DiagrammeR, DiagrammeRsvg and rsvg) or Bioconductor ( 
rtracklayer and GenomicRanges), also listed in the suggest section.

The functions detect whether the suggested packages are installed and 
available, and return an error message indicating that the packages 
required to use the function.

In fact DiagrammeR uses the same approach, the function export_graph 
requires both DiagrammeRsvg and rsvg, but they are not listed in the 
imports, it just returns a message when they are not installed.

I have the option of removing the examples, or printing the same 
messages but returning from the functions instead of using stop. What is 
the preferred behavior in these cases?

Best regards,
Juan Antonio



	

	

	

	

	[[alternative HTML version deleted]]


From m|ch@e|ch|r|co4 @end|ng |rom gm@||@com  Thu May  8 17:28:57 2025
From: m|ch@e|ch|r|co4 @end|ng |rom gm@||@com (Michael Chirico)
Date: Thu, 8 May 2025 08:28:57 -0700
Subject: [R-pkg-devel] Functions requiring packages listed on Suggests
In-Reply-To: <068c8892-0b1f-4639-b40f-d2fc47ccba43@cnb.csic.es>
References: <068c8892-0b1f-4639-b40f-d2fc47ccba43@cnb.csic.es>
Message-ID: <CAPRVBcwV6zzGQXBLHRgwVG0zu=0H8DPk1t8xYHS=AieKSTTb_Q@mail.gmail.com>

Just don't run those examples on machines lacking the Suggests packages.

With roxygen2 it's as easy as @examplesIf requireNamespace(p, quietly=TRUE).

On Thu, May 8, 2025, 8:19?AM Juan Antonio Garcia Martin <
ja.garcia at cnb.csic.es> wrote:

> Dear mantainers,
>
> I have a question, since one of my packages currently does not pass the
> onSuggest special check.
>
> Two functions of my package require some of the suggested packages
> either in CRAN (DiagrammeR, DiagrammeRsvg and rsvg) or Bioconductor (
> rtracklayer and GenomicRanges), also listed in the suggest section.
>
> The functions detect whether the suggested packages are installed and
> available, and return an error message indicating that the packages
> required to use the function.
>
> In fact DiagrammeR uses the same approach, the function export_graph
> requires both DiagrammeRsvg and rsvg, but they are not listed in the
> imports, it just returns a message when they are not installed.
>
> I have the option of removing the examples, or printing the same
> messages but returning from the functions instead of using stop. What is
> the preferred behavior in these cases?
>
> Best regards,
> Juan Antonio
>
>
>
>
>
>
>
>
>
>
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de  Thu May  8 18:24:34 2025
From: ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de (Uwe Ligges)
Date: Thu, 8 May 2025 18:24:34 +0200
Subject: [R-pkg-devel] Functions requiring packages listed on Suggests
In-Reply-To: <068c8892-0b1f-4639-b40f-d2fc47ccba43@cnb.csic.es>
References: <068c8892-0b1f-4639-b40f-d2fc47ccba43@cnb.csic.es>
Message-ID: <35e6b296-ae6a-45b7-aab0-e0f381fe9dc9@statistik.tu-dortmund.de>

Simply only run  the function conditionally in test, examples, vignettes:

if(requireNamespace(packageName)){

example / vignette / test code

}




On 08.05.2025 15:37, Juan Antonio Garcia Martin wrote:
> Dear mantainers,
> 
> I have a question, since one of my packages currently does not pass the
> onSuggest special check.
> 
> Two functions of my package require some of the suggested packages
> either in CRAN (DiagrammeR, DiagrammeRsvg and rsvg) or Bioconductor (
> rtracklayer and GenomicRanges), also listed in the suggest section.
> 
> The functions detect whether the suggested packages are installed and
> available, and return an error message indicating that the packages
> required to use the function.
> 
> In fact DiagrammeR uses the same approach, the function export_graph
> requires both DiagrammeRsvg and rsvg, but they are not listed in the
> imports, it just returns a message when they are not installed.
> 
> I have the option of removing the examples, or printing the same
> messages but returning from the functions instead of using stop. What is
> the preferred behavior in these cases?
> 
> Best regards,
> Juan Antonio
> 
> 
> 
> 	
> 
> 	
> 
> 	
> 
> 	
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From t@weet @end|ng |rom umd@edu  Thu May  8 18:01:47 2025
From: t@weet @end|ng |rom umd@edu (Tracy Morrison Sweet)
Date: Thu, 8 May 2025 12:01:47 -0400
Subject: [R-pkg-devel] Secondary Issues getting a package on cran
Message-ID: <AD40D6E8-08D2-456F-90FA-0589F4417A75@umd.edu>

Hi all,

I?m not sure how to fix the following issues with a package. When I run checks on my own computer, I only see a note that the package was previously removed from cran. 

So both of the checks have the same note: 
New submission 
Package was archived on CRAN

I?m not sure how to do anything to remove this note. I?m also not sure if this note is causing issues, but it seems like it is.

Then, they ran additional checks and a gave me link with a file directory clang-san, in which there are 4 files: ?outputs.txt?, ?package?, ?process.txt?, ?summary.txt?.  

In outputs.txt, there were 24 warnings in the  These are functions in other packages I?m guessing, but I don?t call them in my package. 
In the package link, I can see the install log and there are no errors.
In process.txt and summary.txt, it says 
"File: HLSM-Ex.Rout
vendor/cigraph/src/constructors/adjacency.c:87:34: runtime error: nan is outside the range of representable values of type ?long?"

I?m not sure how to fix any of these. When I check it on my computer, the file HLSM-Ex.Rout doesn?t have this information. 

The email from cran is copied below. 

Thanks for any suggestions,
Tracy



Dear maintainer,

package HLSM_0.9.1.tar.gz does not pass the incoming checks automatically, please see the following pre-tests (additional issue checks):
Windows: <https://win-builder.r-project.org/incoming_pretest/HLSM_0.9.1_20250508_154110/Windows/00check.log>
Status: 1 NOTE
Debian: <https://win-builder.r-project.org/incoming_pretest/HLSM_0.9.1_20250508_154110/Debian/00check.log>
Status: 1 NOTE

Additional issues checked: <https://win-builder.r-project.org/incoming_pretest/HLSM_0.9.1_20250508_154110/specialChecks/>
clang-san: Status: WARNING

Last released version's CRAN status: OK: 12
See: <https://cran-archive.r-project.org/web/checks/2024/2024-01-19_check_results_HLSM.html>

Last released version's additional issues:
clang-UBSAN <https://www.stats.ox.ac.uk/pub/bdr/memtests/clang-UBSAN/HLSM>

Please fix all problems and resubmit a fixed version via the webform.
If you are not sure how to fix the problems shown, please ask for help on the R-package-devel mailing list:
<https://stat.ethz.ch/mailman/listinfo/r-package-devel>
If you are fairly certain the rejection is a false positive, please reply-all to this message and explain.

More details are given in the directory:
<https://win-builder.r-project.org/incoming_pretest/HLSM_0.9.1_20250508_154110/>
The files will be removed after roughly 7 days.

No strong reverse dependencies to be checked.

Best regards,
CRAN teams' auto-check service
Flavor: r-devel-linux-x86_64-debian-gcc, r-devel-windows-x86_64
Check: CRAN incoming feasibility, Result: NOTE
Maintainer: 'Tracy Sweet <tsweet at umd.edu <mailto:tsweet at umd.edu> <mailto:tsweet at umd.edu>>'

New submission

Package was archived on CRAN

CRAN repository db overrides:
  X-CRAN-Comment: Archived on 2024-01-19 as issues were not corrected
    in time.

Flavor: r-devel-linux-x86_64-debian-special-clang-san
Check: *, Result: NA


Flavor: r-devel-linux-x86_64-debian-special-clang-san
Check: Post-processing issues found for clang-san, Result: WARNING
File: HLSM-Ex.Rout
vendor/cigraph/src/constructors/adjacency.c:87:34: runtime error: nan is outside the range of representable values of type 'long'






	[[alternative HTML version deleted]]


From j@@g@rc|@ @end|ng |rom cnb@c@|c@e@  Thu May  8 22:02:51 2025
From: j@@g@rc|@ @end|ng |rom cnb@c@|c@e@ (=?ISO-8859-1?Q?Juan_Antonio_Garc=EDa_Mart=EDn?=)
Date: Thu, 08 May 2025 22:02:51 +0200
Subject: [R-pkg-devel] Functions requiring packages listed on Suggests
In-Reply-To: <35e6b296-ae6a-45b7-aab0-e0f381fe9dc9@statistik.tu-dortmund.de>
References: <068c8892-0b1f-4639-b40f-d2fc47ccba43@cnb.csic.es>
 <35e6b296-ae6a-45b7-aab0-e0f381fe9dc9@statistik.tu-dortmund.de>
Message-ID: <4F1A7268-15AB-4E69-A762-1B4440983A54@cnb.csic.es>

Thank you for answering so soon, Michael and Uwe.

I think I will follow Uwe's approach, it is simple and will work on all cases. 

Best regards, 
Juan Antonio 



On May 8, 2025 6:24:34 PM GMT+02:00, Uwe Ligges <ligges at statistik.tu-dortmund.de> wrote:
>Simply only run  the function conditionally in test, examples, vignettes:
>
>if(requireNamespace(packageName)){
>
>example / vignette / test code
>
>}
>
>
>
>
>On 08.05.2025 15:37, Juan Antonio Garcia Martin wrote:
>> Dear mantainers,
>> 
>> I have a question, since one of my packages currently does not pass the
>> onSuggest special check.
>> 
>> Two functions of my package require some of the suggested packages
>> either in CRAN (DiagrammeR, DiagrammeRsvg and rsvg) or Bioconductor (
>> rtracklayer and GenomicRanges), also listed in the suggest section.
>> 
>> The functions detect whether the suggested packages are installed and
>> available, and return an error message indicating that the packages
>> required to use the function.
>> 
>> In fact DiagrammeR uses the same approach, the function export_graph
>> requires both DiagrammeRsvg and rsvg, but they are not listed in the
>> imports, it just returns a message when they are not installed.
>> 
>> I have the option of removing the examples, or printing the same
>> messages but returning from the functions instead of using stop. What is
>> the preferred behavior in these cases?
>> 
>> Best regards,
>> Juan Antonio
>> 
>> 
>> 
>> 	
>> 
>> 	
>> 
>> 	
>> 
>> 	
>> 
>> 	[[alternative HTML version deleted]]
>> 
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From |kry|ov @end|ng |rom d|@root@org  Fri May  9 00:30:25 2025
From: |kry|ov @end|ng |rom d|@root@org (Ivan Krylov)
Date: Fri, 9 May 2025 01:30:25 +0300
Subject: [R-pkg-devel] Secondary Issues getting a package on cran
In-Reply-To: <AD40D6E8-08D2-456F-90FA-0589F4417A75@umd.edu>
References: <AD40D6E8-08D2-456F-90FA-0589F4417A75@umd.edu>
Message-ID: <20250509013025.6b37bf30@trisector>

? Thu, 8 May 2025 12:01:47 -0400
Tracy Morrison Sweet <tsweet at umd.edu> ?????:

> New submission 
> Package was archived on CRAN
> 
> I?m not sure how to do anything to remove this note.

This note is to be expected.

> In process.txt and summary.txt, it says "File: HLSM-Ex.Rout
> vendor/cigraph/src/constructors/adjacency.c:87:34: runtime error: nan
> is outside the range of representable values of type ?long?"

The link to the original issue that got your package archived is more
informative because it contains the backtrace and shows the place in
your examples where the problem happens:

https://www.stats.ox.ac.uk/pub/bdr/memtests/clang-UBSAN/HLSM/HLSM-Ex.Rout

> > fixed.fit = HLSMfixedEF(Y = ps.advice.mat, senderCov=ps.node.df,
> + 	initialVals = initialVals,priors = priors,
> + 	tune = tune,tuneIn = FALSE,dd = 2,niter = niter)
> core/constructors/adjacency.c:47:26: runtime error: nan is outside
> the range of representable values of type 'long' #0 0x7f09504c6e4b in
> igraph_i_adjacency_directed
> /tmp/Rtmp9HF8V2/R.INSTALL659cd504fd46b/igraph/src/core/constructors/adjacency.c:47:26
> #1 0x7f09504c5715 in igraph_adjacency
> /tmp/Rtmp9HF8V2/R.INSTALL659cd504fd46b/igraph/src/core/constructors/adjacency.c:212:9
> #2 0x7f0950c654a3 in R_igraph_graph_adjacency
> /tmp/Rtmp9HF8V2/R.INSTALL659cd504fd46b/igraph/src/rinterface_extra.c:4861:3

The file path is now different, but the issue is most likely the same.
During a call to HLSMfixedEF(), a matrix containing a NaN value is
passed to the 'igraph' package, where the NaN is converted to an
integer:

https://github.com/igraph/rigraph/blob/9a2816248eb837077b5af28bad7b1b9c0713b128/src/vendor/cigraph/src/constructors/adjacency.c#L87

Unfortunately, converting a NaN into an integer is undefined behaviour
according to the C standard. The program is allowed to do literally
anything, so it caused your package to be archived.

Ideally, 'igraph' could produce an informative error message upon
detecting a NaN, but you can avoid the problem on your end by making
sure that all values in your adjacency matrices are finite before
calling igraph::graph.adjacency().

To see the problem for yourself, you'll need a "sanitized" build of R:
https://cran.r-project.org/doc/manuals/R-exts.html#Using-Undefined-Behaviour-Sanitizer

Sanitizers are somewhat finicky to use. The container images
docker.io/rocker/r-devel-ubsan-clang and
ghcr.io/r-hub/containers/clang-ubsan, or the R-hub service may help.

Good luck! If this wasn't detailed enough, don't hesitate to ask
follow-up questions.

-- 
Best regards,
Ivan


From jm@yu@n @end|ng |rom out|ook@com  Fri May  9 06:22:52 2025
From: jm@yu@n @end|ng |rom out|ook@com (jiaming yuan)
Date: Fri, 9 May 2025 04:22:52 +0000
Subject: [R-pkg-devel] CRAN Submission xgboost 1.7.11.1
In-Reply-To: <OS3PR01MB8068F43785E19BF9A1FFEAC5F68AA@OS3PR01MB8068.jpnprd01.prod.outlook.com>
References: <20250501105800.3FA5CA01B9@xmpalantir.wu.ac.at>
 <c8b1e3ed-bb68-4d29-b9e7-d33a20efd802@statistik.tu-dortmund.de>
 <OS3PR01MB8068DDDF251EA2D84352E2B2F68C2@OS3PR01MB8068.jpnprd01.prod.outlook.com>
 <51df8414-5cce-4eb4-a7f1-8499f52393af@statistik.tu-dortmund.de>
 <5d95cb36-dc9a-4a5b-b08a-182e1e321aad@statistik.tu-dortmund.de>
 <OS3PR01MB8068F43785E19BF9A1FFEAC5F68AA@OS3PR01MB8068.jpnprd01.prod.outlook.com>
Message-ID: <OS3PR01MB8068A259CA4381B339A21302F68AA@OS3PR01MB8068.jpnprd01.prod.outlook.com>

Hi CRAN,

May I ask if someone has tried to reproduce the openblas test environment from CRAN? We are trying to resolve the test failures of XGBoost but so far no one has managed to reproduce them locally. https://github.com/dmlc/xgboost/issues/11431

Would be great if you can share some guidance on how to reproduce that exact environment.

Cheers
Jiaming
________________________________
From: jiaming yuan <jm.yuan at outlook.com>
Sent: Friday, May 9, 2025 12:04:45 PM
To: Uwe Ligges <ligges at statistik.tu-dortmund.de>; CRAN <cran-submissions at r-project.org>
Cc: CRAN Package Submission Form <cransubmit at xmbombadil.wu.ac.at>
Subject: Re: CRAN Submission xgboost 1.7.11.1

Hi,

Others kindly provided help to reproduce the failure but so far no one has managed to do so.

Please see  https://github.com/dmlc/xgboost/issues/11431#issuecomment-2864947065  and related discussions the thread. Would be great if you can share something more precise.


Cheers
Jiaming

________________________________
From: Uwe Ligges <ligges at statistik.tu-dortmund.de>
Sent: Wednesday, May 7, 2025 9:48:56 PM
To: jiaming yuan <jm.yuan at outlook.com>; CRAN <cran-submissions at r-project.org>
Cc: CRAN Package Submission Form <cransubmit at xmbombadil.wu.ac.at>
Subject: Re: CRAN Submission xgboost 1.7.11.1

Note this is relevant, as most Linux clusters will have admis who will
link scientifiv software aagainst OpenBLAS for faster matriox operations.

Best,
Uwe Ligges

On 07.05.2025 15:48, Uwe Ligges wrote:
> I think any Liniux system with R linked against the system's default
> OpenBLAS installation will show this issue.
> I'd try it with a standard Ubuntu or Debian with OpenBLAS installed and
> link agasinst it.
>
> Best,
> Uwe Ligges
>
>
>
> On 03.05.2025 08:29, jiaming yuan wrote:
>> Thank you for reaching out. We can't really dive into it unless
>> there's an easier way to reproduce the environment (like a container
>> or using some deterministic package managers). It's very unlikely that
>> we can try to build that environment on our own then try to fix all
>> errors and verify all fixes.
>>
>>
>>
>> ________________________________
>> From: Uwe Ligges <ligges at statistik.tu-dortmund.de>
>> Sent: Friday, May 2, 2025 8:00:17 PM
>> To: Jiaming Yuan <jm.yuan at outlook.com>; CRAN <cran-submissions at r-
>> project.org>
>> Cc: CRAN Package Submission Form <cransubmit at xmbombadil.wu.ac.at>
>> Subject: Re: CRAN Submission xgboost 1.7.11.1
>>
>> Thanks, we see you removed lots of tests. Is this really sensible and
>> are you sure that users with OpenBLAS (as most Linux users and cluster
>> admins will use) will get correct results? Sensibly relaxing numerical
>> assumptions may be a better way to tweak the tests.?
>>
>> Best,
>> Uwe Ligges
>>
>>
>> On 01.05.2025 12:58, CRAN Package Submission Form via CRAN-submissions
>> wrote:
>>> [This was generated from CRAN.R-project.org/submit.html]
>>>
>>> The following package was uploaded to CRAN:
>>> ===========================================
>>>
>>> Package Information:
>>> Package: xgboost
>>> Version: 1.7.11.1
>>> Title: Extreme Gradient Boosting
>>> Author(s): Tianqi Chen [aut], Tong He [aut], Michael Benesty [aut],
>>> Vadim
>>> Khotilovich [aut], Yuan Tang [aut]
>>> (<https://orcid.org/0000-0001-5243-233X>), Hyunsu Cho [aut],
>>> Kailong Chen [aut], Rory Mitchell [aut], Ignacio Cano [aut],
>>> Tianyi Zhou [aut], Mu Li [aut], Junyuan Xie [aut], Min Lin
>>> [aut], Yifeng Geng [aut], Yutian Li [aut], Jiaming Yuan [aut,
>>> cre], XGBoost contributors [cph] (base XGBoost implementation)
>>> Maintainer: Jiaming Yuan <jm.yuan at outlook.com>
>>> Depends: R (>= 3.3.0)
>>> Suggests: knitr, rmarkdown, ggplot2 (>= 1.0.1), DiagrammeR (>= 0.9.0),
>>> Ckmeans.1d.dp (>= 3.3.1), vcd (>= 1.3), cplm, e1071, caret,
>>> testthat, lintr, igraph (>= 1.0.1), float, crayon, titanic
>>> Description: Extreme Gradient Boosting, which is an efficient
>>> implementation of the gradient boosting framework from Chen &
>>> Guestrin (2016) <doi:10.1145/2939672.2939785>. This package
>>> is its R interface. The package includes efficient linear
>>> model solver and tree learning algorithms. The package can
>>> automatically do parallel computation on a single machine
>>> which could be more than 10 times faster than existing
>>> gradient boosting packages. It supports various objective
>>> functions, including regression, classification and ranking.
>>> The package is made to be extensible, so that users are also
>>> allowed to define their own objectives easily.
>>> License: Apache License (== 2.0) | file LICENSE
>>> Imports: Matrix (>= 1.1-0), methods, data.table (>= 1.9.6), jsonlite
>>> (>= 1.0),
>>>
>>>
>>> The maintainer confirms that he or she
>>> has read and agrees to the CRAN policies.
>>>
>>> =================================================
>>>
>>> Original content of DESCRIPTION file:
>>>
>>> Package: xgboost
>>> Type: Package
>>> Title: Extreme Gradient Boosting
>>> Version: 1.7.11.1
>>> Date: 2025-05-01
>>> Authors at R: c(
>>> person("Tianqi", "Chen", role = c("aut"),
>>> email = "tianqi.tchen at gmail.com"),
>>> person("Tong", "He", role = c("aut"),
>>> email = "hetong007 at gmail.com"),
>>> person("Michael", "Benesty", role = c("aut"),
>>> email = "michael at benesty.fr"),
>>> person("Vadim", "Khotilovich", role = c("aut"),
>>> email = "khotilovich at gmail.com"),
>>> person("Yuan", "Tang", role = c("aut"),
>>> email = "terrytangyuan at gmail.com",
>>> comment = c(ORCID = "0000-0001-5243-233X")),
>>> person("Hyunsu", "Cho", role = c("aut"),
>>> email = "chohyu01 at cs.washington.edu"),
>>> person("Kailong", "Chen", role = c("aut")),
>>> person("Rory", "Mitchell", role = c("aut")),
>>> person("Ignacio", "Cano", role = c("aut")),
>>> person("Tianyi", "Zhou", role = c("aut")),
>>> person("Mu", "Li", role = c("aut")),
>>> person("Junyuan", "Xie", role = c("aut")),
>>> person("Min", "Lin", role = c("aut")),
>>> person("Yifeng", "Geng", role = c("aut")),
>>> person("Yutian", "Li", role = c("aut")),
>>> person("Jiaming", "Yuan", role = c("aut", "cre"),
>>> email = "jm.yuan at outlook.com"),
>>> person("XGBoost contributors", role = c("cph"),
>>> comment = "base XGBoost implementation")
>>> )
>>> Maintainer: Jiaming Yuan <jm.yuan at outlook.com>
>>> Description: Extreme Gradient Boosting, which is an efficient
>>> implementation
>>> of the gradient boosting framework from Chen & Guestrin (2016)
>>> <doi:10.1145/2939672.2939785>.
>>> This package is its R interface. The package includes efficient linear
>>> model solver and tree learning algorithms. The package can automatically
>>> do parallel computation on a single machine which could be more than 10
>>> times faster than existing gradient boosting packages. It supports
>>> various objective functions, including regression, classification and
>>> ranking.
>>> The package is made to be extensible, so that users are also allowed
>>> to define
>>> their own objectives easily.
>>> License: Apache License (== 2.0) | file LICENSE
>>> URL: https://github.com/dmlc/xgboost
>>> BugReports: https://github.com/dmlc/xgboost/issues
>>> NeedsCompilation: yes
>>> VignetteBuilder: knitr
>>> Suggests: knitr, rmarkdown, ggplot2 (>= 1.0.1), DiagrammeR (>= 0.9.0),
>>> Ckmeans.1d.dp (>= 3.3.1), vcd (>= 1.3), cplm, e1071, caret,
>>> testthat, lintr, igraph (>= 1.0.1), float, crayon, titanic
>>> Depends: R (>= 3.3.0)
>>> Imports: Matrix (>= 1.1-0), methods, data.table (>= 1.9.6), jsonlite
>>> (>= 1.0),
>>> RoxygenNote: 7.3.2
>>> Encoding: UTF-8
>>> SystemRequirements: GNU make, C++17
>>> Packaged: 2025-05-01 10:56:14 UTC; jiamingy
>>> Author: Tianqi Chen [aut],
>>> Tong He [aut],
>>> Michael Benesty [aut],
>>> Vadim Khotilovich [aut],
>>> Yuan Tang [aut] (<https://orcid.org/0000-0001-5243-233X>),
>>> Hyunsu Cho [aut],
>>> Kailong Chen [aut],
>>> Rory Mitchell [aut],
>>> Ignacio Cano [aut],
>>> Tianyi Zhou [aut],
>>> Mu Li [aut],
>>> Junyuan Xie [aut],
>>> Min Lin [aut],
>>> Yifeng Geng [aut],
>>> Yutian Li [aut],
>>> Jiaming Yuan [aut, cre],
>>> XGBoost contributors [cph] (base XGBoost implementation)
>>>
>>
>>
>>
>>     [[alternative HTML version deleted]]
>>
>



	[[alternative HTML version deleted]]


From t@weet @end|ng |rom umd@edu  Fri May  9 17:04:44 2025
From: t@weet @end|ng |rom umd@edu (Tracy Morrison Sweet)
Date: Fri, 9 May 2025 11:04:44 -0400
Subject: [R-pkg-devel] Secondary Issues getting a package on cran
In-Reply-To: <20250509013025.6b37bf30@trisector>
References: <AD40D6E8-08D2-456F-90FA-0589F4417A75@umd.edu>
 <20250509013025.6b37bf30@trisector>
Message-ID: <B43C4C57-27A2-440C-B39D-784035F3A0AD@umd.edu>

Hi Ivan,

This is extremely helpful! I appreciate your time and detailed explanation.

Tracy


> On May 8, 2025, at 6:30?PM, Ivan Krylov <ikrylov at disroot.org> wrote:
> 
> ? Thu, 8 May 2025 12:01:47 -0400
> Tracy Morrison Sweet <tsweet at umd.edu> ?????:
> 
>> New submission 
>> Package was archived on CRAN
>> 
>> I?m not sure how to do anything to remove this note.
> 
> This note is to be expected.
> 
>> In process.txt and summary.txt, it says "File: HLSM-Ex.Rout
>> vendor/cigraph/src/constructors/adjacency.c:87:34: runtime error: nan
>> is outside the range of representable values of type ?long?"
> 
> The link to the original issue that got your package archived is more
> informative because it contains the backtrace and shows the place in
> your examples where the problem happens:
> 
> https://www.stats.ox.ac.uk/pub/bdr/memtests/clang-UBSAN/HLSM/HLSM-Ex.Rout
> 
>>> fixed.fit = HLSMfixedEF(Y = ps.advice.mat, senderCov=ps.node.df,
>> + 	initialVals = initialVals,priors = priors,
>> + 	tune = tune,tuneIn = FALSE,dd = 2,niter = niter)
>> core/constructors/adjacency.c:47:26: runtime error: nan is outside
>> the range of representable values of type 'long' #0 0x7f09504c6e4b in
>> igraph_i_adjacency_directed
>> /tmp/Rtmp9HF8V2/R.INSTALL659cd504fd46b/igraph/src/core/constructors/adjacency.c:47:26
>> #1 0x7f09504c5715 in igraph_adjacency
>> /tmp/Rtmp9HF8V2/R.INSTALL659cd504fd46b/igraph/src/core/constructors/adjacency.c:212:9
>> #2 0x7f0950c654a3 in R_igraph_graph_adjacency
>> /tmp/Rtmp9HF8V2/R.INSTALL659cd504fd46b/igraph/src/rinterface_extra.c:4861:3
> 
> The file path is now different, but the issue is most likely the same.
> During a call to HLSMfixedEF(), a matrix containing a NaN value is
> passed to the 'igraph' package, where the NaN is converted to an
> integer:
> 
> https://github.com/igraph/rigraph/blob/9a2816248eb837077b5af28bad7b1b9c0713b128/src/vendor/cigraph/src/constructors/adjacency.c#L87
> 
> Unfortunately, converting a NaN into an integer is undefined behaviour
> according to the C standard. The program is allowed to do literally
> anything, so it caused your package to be archived.
> 
> Ideally, 'igraph' could produce an informative error message upon
> detecting a NaN, but you can avoid the problem on your end by making
> sure that all values in your adjacency matrices are finite before
> calling igraph::graph.adjacency().
> 
> To see the problem for yourself, you'll need a "sanitized" build of R:
> https://cran.r-project.org/doc/manuals/R-exts.html#Using-Undefined-Behaviour-Sanitizer
> 
> Sanitizers are somewhat finicky to use. The container images
> docker.io/rocker/r-devel-ubsan-clang and
> ghcr.io/r-hub/containers/clang-ubsan, or the R-hub service may help.
> 
> Good luck! If this wasn't detailed enough, don't hesitate to ask
> follow-up questions.
> 
> -- 
> Best regards,
> Ivan

Tracy M. Sweet
Associate Professor
HDQM
University of Maryland
tsweet at umd.edu
she/her/hers
UMD Land Acknowledgement <https://diversity.umd.edu/resources/land-acknowledgement>






	[[alternative HTML version deleted]]


From |kry|ov @end|ng |rom d|@root@org  Fri May  9 23:41:51 2025
From: |kry|ov @end|ng |rom d|@root@org (Ivan Krylov)
Date: Sat, 10 May 2025 00:41:51 +0300
Subject: [R-pkg-devel] CRAN Submission xgboost 1.7.11.1
In-Reply-To: <OS3PR01MB8068A259CA4381B339A21302F68AA@OS3PR01MB8068.jpnprd01.prod.outlook.com>
References: <20250501105800.3FA5CA01B9@xmpalantir.wu.ac.at>
 <c8b1e3ed-bb68-4d29-b9e7-d33a20efd802@statistik.tu-dortmund.de>
 <OS3PR01MB8068DDDF251EA2D84352E2B2F68C2@OS3PR01MB8068.jpnprd01.prod.outlook.com>
 <51df8414-5cce-4eb4-a7f1-8499f52393af@statistik.tu-dortmund.de>
 <5d95cb36-dc9a-4a5b-b08a-182e1e321aad@statistik.tu-dortmund.de>
 <OS3PR01MB8068F43785E19BF9A1FFEAC5F68AA@OS3PR01MB8068.jpnprd01.prod.outlook.com>
 <OS3PR01MB8068A259CA4381B339A21302F68AA@OS3PR01MB8068.jpnprd01.prod.outlook.com>
Message-ID: <20250510004151.79c43656@trisector>

? Fri, 9 May 2025 04:22:52 +0000
jiaming yuan <jm.yuan at outlook.com> ?????:

> We are trying to resolve the test failures of XGBoost but so far no
> one has managed to reproduce them locally.
> https://github.com/dmlc/xgboost/issues/11431

One test failure really stands out:

>   Error ('test_feature_weights.R:17:5'): training with feature
> weights works
>   Error in `setinfo.xgb.DMatrix(dmat, names(p), p[[1]])`:
> cannot get data pointer of 'double' objects

This is particularly strange because the internal CHKVEC() function is
supposed to check for REALSXP vectors and pass them through. Such
"impossible" errors could be signs of a protection error. (Well, any
memory corruption, but arbitrary memory corruption is harder to
diagnose, so let's hope it's something to do with the garbage
collector.) Let's run the test suite check using a build of R-devel
compiled with .../configure --enable-strict-barrier.


testthat::test_check("xgboost")
# <...>
# Fatal error: Wrong thread calling 'RunFinalizers'
# Fatal error: Wrong thread calling 'RunFinalizers'
# Fatal error: Wrong thread calling 'RunFinalizers'
# Fatal error: Wrong thread calling 'RunFinalizers'
# Fatal error: Wrong thread calling 'RunFinalizers'
# Segmentation fault

Hmm.

Setting a breakpoint in Rstd_Suicide reveals the mistake. It's not a
protection error; it's R API being called from an OpenMP thread:

#5  ALTVEC_DATAPTR (x=0x2d825f58) at ../../../R/src/main/altrep.c:376
#6  0x00007fbbd1e5ed98 in operator() (__closure=<synthetic pointer>,
    i=<optimized out>) at xgboost_R.cc:258
#7  dmlc::OMPException::Run<XGDMatrixSetInfo_R(SEXP, SEXP, SEXP)::<lambda(xgboost::omp_ulong)>, int> (this=0x7fffbfaef760, f=...)
    at ./dmlc-core/include/dmlc/common.h:67
#8  _ZN7xgboost6common11ParallelForIiZ18XGDMatrixSetInfo_REUlmE0_EEvT_iNS0_5SchedET0_._omp_fn.3(void) ()
    at ./dmlc-core/include/../../src/common/threading_utils.h:208
#9  0x00007fbbd4552a0e in gomp_thread_start (xdata=<optimized out>)
    at ../../../libgomp/team.c:129
(gdb) frame 5
#5  ALTVEC_DATAPTR (x=0x2d825f58) at ../../../R/src/main/altrep.c:376
376         return ALTVEC_DATAPTR_EX(x, TRUE);
(gdb) call R_inspect(x)
@2d825f58 14 REALSXP g0c0 [REF(65535)]  1 : 9 (expanded)

The code would be better served by calling REAL_RO / INTEGER_RO once
and then using the returned pointer inside the OpenMP threads.

-- 
Best regards,
Ivan


From jm@yu@n @end|ng |rom out|ook@com  Sat May 10 17:33:10 2025
From: jm@yu@n @end|ng |rom out|ook@com (jiaming yuan)
Date: Sat, 10 May 2025 15:33:10 +0000
Subject: [R-pkg-devel] [SPAM | WERBUNG] Re: CRAN Submission xgboost 1.7.11.1
In-Reply-To: <20250510004151.79c43656@trisector>
References: <20250501105800.3FA5CA01B9@xmpalantir.wu.ac.at>
 <c8b1e3ed-bb68-4d29-b9e7-d33a20efd802@statistik.tu-dortmund.de>
 <OS3PR01MB8068DDDF251EA2D84352E2B2F68C2@OS3PR01MB8068.jpnprd01.prod.outlook.com>
 <51df8414-5cce-4eb4-a7f1-8499f52393af@statistik.tu-dortmund.de>
 <5d95cb36-dc9a-4a5b-b08a-182e1e321aad@statistik.tu-dortmund.de>
 <OS3PR01MB8068F43785E19BF9A1FFEAC5F68AA@OS3PR01MB8068.jpnprd01.prod.outlook.com>
 <OS3PR01MB8068A259CA4381B339A21302F68AA@OS3PR01MB8068.jpnprd01.prod.outlook.com>
 <20250510004151.79c43656@trisector>
Message-ID: <OS3PR01MB8068A33A5AF7C7533594A157F695A@OS3PR01MB8068.jpnprd01.prod.outlook.com>

Thank you for sharing, Ivan! This is really helpful.
________________________________
From: Ivan Krylov <ikrylov at disroot.org>
Sent: Saturday, May 10, 2025 5:41:51 AM
To: jiaming yuan <jm.yuan at outlook.com>
Cc: r-package-devel at r-project.org <r-package-devel at r-project.org>
Subject: Re: [R-pkg-devel] CRAN Submission xgboost 1.7.11.1

? Fri, 9 May 2025 04:22:52 +0000
jiaming yuan <jm.yuan at outlook.com> ?????:

> We are trying to resolve the test failures of XGBoost but so far no
> one has managed to reproduce them locally.
> https://github.com/dmlc/xgboost/issues/11431

One test failure really stands out:

>   Error ('test_feature_weights.R:17:5'): training with feature
> weights works
>   Error in `setinfo.xgb.DMatrix(dmat, names(p), p[[1]])`:
> cannot get data pointer of 'double' objects

This is particularly strange because the internal CHKVEC() function is
supposed to check for REALSXP vectors and pass them through. Such
"impossible" errors could be signs of a protection error. (Well, any
memory corruption, but arbitrary memory corruption is harder to
diagnose, so let's hope it's something to do with the garbage
collector.) Let's run the test suite check using a build of R-devel
compiled with .../configure --enable-strict-barrier.


testthat::test_check("xgboost")
# <...>
# Fatal error: Wrong thread calling 'RunFinalizers'
# Fatal error: Wrong thread calling 'RunFinalizers'
# Fatal error: Wrong thread calling 'RunFinalizers'
# Fatal error: Wrong thread calling 'RunFinalizers'
# Fatal error: Wrong thread calling 'RunFinalizers'
# Segmentation fault

Hmm.

Setting a breakpoint in Rstd_Suicide reveals the mistake. It's not a
protection error; it's R API being called from an OpenMP thread:

#5  ALTVEC_DATAPTR (x=0x2d825f58) at ../../../R/src/main/altrep.c:376
#6  0x00007fbbd1e5ed98 in operator() (__closure=<synthetic pointer>,
    i=<optimized out>) at xgboost_R.cc:258
#7  dmlc::OMPException::Run<XGDMatrixSetInfo_R(SEXP, SEXP, SEXP)::<lambda(xgboost::omp_ulong)>, int> (this=0x7fffbfaef760, f=...)
    at ./dmlc-core/include/dmlc/common.h:67
#8  _ZN7xgboost6common11ParallelForIiZ18XGDMatrixSetInfo_REUlmE0_EEvT_iNS0_5SchedET0_._omp_fn.3(void) ()
    at ./dmlc-core/include/../../src/common/threading_utils.h:208
#9  0x00007fbbd4552a0e in gomp_thread_start (xdata=<optimized out>)
    at ../../../libgomp/team.c:129
(gdb) frame 5
#5  ALTVEC_DATAPTR (x=0x2d825f58) at ../../../R/src/main/altrep.c:376
376         return ALTVEC_DATAPTR_EX(x, TRUE);
(gdb) call R_inspect(x)
@2d825f58 14 REALSXP g0c0 [REF(65535)]  1 : 9 (expanded)

The code would be better served by calling REAL_RO / INTEGER_RO once
and then using the returned pointer inside the OpenMP threads.

--
Best regards,
Ivan

	[[alternative HTML version deleted]]


From ty|ermw @end|ng |rom gm@||@com  Sat May 10 18:34:40 2025
From: ty|ermw @end|ng |rom gm@||@com (Tyler)
Date: Sat, 10 May 2025 12:34:40 -0400
Subject: [R-pkg-devel] CMake not on the PATH on CRAN macOS build/check
 servers?
Message-ID: <CAJhwqzSAA65G=vRSt3+Zv_27RLgS9zVH4ZqtPa2SjLTDJcMtAg@mail.gmail.com>

I recently submitted the package `libdeflate`, which successfully made
its way to the CRAN
(https://cran.r-project.org/web/packages/libdeflate/index.html) but
has failed to install on macOS:

https://cran.r-project.org/web/checks/check_results_libdeflate.html

Specifically, installation requires CMake, which is checked for during
the configure step with Sys.which("cmake"). This returns "" on macOS,
indicating it was not found. Note that cmake is indeed listed as a
SystemRequirement in the DESCRIPTION.

https://www.r-project.org/nosvn/R.check/r-release-macos-arm64/libdeflate-00install.html

* installing *source* package ?libdeflate? ...
** this is package ?libdeflate? version ?1.23.0?
** package ?libdeflate? successfully unpacked and MD5 sums checked
** using staged installation
** preparing to configure package 'libdeflate' ...
sh: : command not found
Error in eval(parse(text = contents), envir = envir) :
  CMake configure step failed
Calls: source_file -> eval -> eval
In addition: Warning messages:
1: In normalizePath(Sys.which("cmake"), winslash = "/") :
  path[1]="": No such file or directory
2: In system2(CMAKE, cmake_cfg) : error in running command
Execution halted
ERROR: configuration failed for package ?libdeflate?

I see that WRE also recommends checking
"/Applications/CMake.app/Contents/bin/cmake" on macOS. Before
submitting an update, though, it would be nice if someone could
confirm where cmake is located on the CRAN macOS environment so I can
be sure the fix will be successful.

Tyler


From edd @end|ng |rom deb|@n@org  Sat May 10 19:29:59 2025
From: edd @end|ng |rom deb|@n@org (Dirk Eddelbuettel)
Date: Sat, 10 May 2025 12:29:59 -0500
Subject: [R-pkg-devel] CMake not on the PATH on CRAN macOS build/check
 servers?
In-Reply-To: <CAJhwqzSAA65G=vRSt3+Zv_27RLgS9zVH4ZqtPa2SjLTDJcMtAg@mail.gmail.com>
References: <CAJhwqzSAA65G=vRSt3+Zv_27RLgS9zVH4ZqtPa2SjLTDJcMtAg@mail.gmail.com>
Message-ID: <26655.36119.760105.939432@rob.eddelbuettel.com>


On 10 May 2025 at 12:34, Tyler wrote:
| I recently submitted the package `libdeflate`, which successfully made
| its way to the CRAN
| (https://cran.r-project.org/web/packages/libdeflate/index.html) but
| has failed to install on macOS:
[...]
| I see that WRE also recommends checking
| "/Applications/CMake.app/Contents/bin/cmake" on macOS. Before
| submitting an update, though, it would be nice if someone could
| confirm where cmake is located on the CRAN macOS environment so I can
| be sure the fix will be successful.

It's a common issue, it's documented, and a pothole I also fell into not that
long ago. So here is a very simple script `configure` I use to check, and
then adjust src/Makevars, in package crc32c (which wraps a small external
library of the same name). You will note it credits Reed from an earlier
discussion on this very list.

-----------------------------------------------------------------------------
#!/bin/sh

## With thanks to Reed A. Cartwright on r-package-devel on 2023-05-10
## Also end of Writing R Extensions, Section 1.2.6 'Using `cmake`'

if test -z "$CMAKE"; then
   # Look for a cmake binary in the current path
   CMAKE=`which cmake 2>/dev/null`
fi
if test -z "$CMAKE"; then
   # Check for a MacOS specific path
   CMAKE=`which /Applications/CMake.app/Contents/bin/cmake 2>/dev/null`
fi
if test -f "$CMAKE"; then
   echo "** cmake is ${CMAKE}"
else   
   echo "The 'cmake' program is required but not found."
   exit 1
fi   

sed -e "s|@cmake@|${CMAKE}|" src/Makevars.in > src/Makevars
-----------------------------------------------------------------------------


By the way, a hidden gem of documentation is the ability to search all
current CRAN packages with the mirror at https://github.com/cran/

Cheers, Dirk

-- 
dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From |orenzo@@o@tero @end|ng |rom un|b@@|t  Sat May 10 16:48:16 2025
From: |orenzo@@o@tero @end|ng |rom un|b@@|t (Lorenzo Sostero)
Date: Sat, 10 May 2025 16:48:16 +0200
Subject: [R-pkg-devel] Failed test automatic checks CRAN
Message-ID: <CAGeL3J3WWw=ZZPutC6G7fF0Wyf9johLqNa6b6fBxd261ZvpDnA@mail.gmail.com>

Dear experts,

In the automatic checks performed by CRAN, I obtain the following error:

====================================================

package EmiR_1.0.5.tar.gz does not pass the incoming checks automatically,
please see the following pre-tests (additional issue checks):
Windows: <
https://win-builder.r-project.org/incoming_pretest/EmiR_1.0.5_20250507_204028/Windows/00check.log
>
Status: 1 ERROR, 2 NOTEs
Debian: <
https://win-builder.r-project.org/incoming_pretest/EmiR_1.0.5_20250507_204028/Debian/00check.log
>
Status: 1 ERROR, 2 NOTEs

Last released version's CRAN status: NOTE: 13
See: <https://CRAN.R-project.org/web/checks/check_results_EmiR.html
<https://cran.r-project.org/web/checks/check_results_EmiR.html>
<https://cran.r-project.org/web/checks/check_results_EmiR.html>>

CRAN Web: <https://cran.r-project.org/package=EmiR>

More details are given in the directory:
<
https://win-builder.r-project.org/incoming_pretest/EmiR_1.0.5_20250507_204028/
>

Flavor: r-devel-windows-x86_64
Check: tests, Result: ERROR
    Running 'testthat.R'
  Running the tests in 'tests/testthat.R' failed.
  Complete output:
    > library(testthat)
    > library(EmiR)
    > test_check("EmiR")
    0%   10   20   30   40   50   60   70   80   90   100%
    [----|----|----|----|----|----|----|----|----|----|


Flavor: r-devel-linux-x86_64-debian-gcc
Check: tests, Result: ERROR
    Running 'testthat.R' [1s/1s]
  Running the tests in 'tests/testthat.R' failed.
  Complete output:
    > library(testthat)
    > library(EmiR)
    > test_check("EmiR")
    0%   10   20   30   40   50   60   70   80   90   100%
    [----|----|----|----|----|----|----|----|----|----|
    [ FAIL 2 | WARN 1 | SKIP 0 | PASS 96 ]

    ?? Failed tests
????????????????????????????????????????????????????????????????
    ?? Failure:
???????????????????????????????????????????????????????????????????
    C stack usage  316451980572 is too close to the limit
    ?? Error ('test-cpp.R:1:1'): (code run outside of `test_that()`)
???????????????
    Error in `path_to_connection(x)`: '' does not exist in current working
directory
    ('/srv/hornik/tmp/CRAN_pretest/EmiR.Rcheck/tests/testthat').
    Backtrace:
        ?
     1. ??testthat::run_cpp_tests("EmiR") at test-cpp.R:1:1
     2.   ??xml2::read_xml(paste(output, collapse = "\n"))
     3.   ??xml2:::read_xml.character(paste(output, collapse = "\n"))
     4.     ??xml2:::path_to_connection(x)
     5.       ??xml2:::check_path(path)
     6.         ??cli::cli_abort(msg, call = call)
     7.           ??rlang::abort(...)

    [ FAIL 2 | WARN 1 | SKIP 0 | PASS 96 ]
    Error: Test failures
    Execution halted
    Segmentation fault

====================================================

I cannot reproduce the same error by testing the package on a Windows and
macOS machine. Any suggestions on how to fix the error?

Best regards, Lorenzo.

-- 




Informativa sulla Privacy:?https://www.unibs.it/it/node/1452 
<https://www.unibs.it/it/node/1452>

	[[alternative HTML version deleted]]


From |kry|ov @end|ng |rom d|@root@org  Sun May 11 23:23:28 2025
From: |kry|ov @end|ng |rom d|@root@org (Ivan Krylov)
Date: Mon, 12 May 2025 00:23:28 +0300
Subject: [R-pkg-devel] Failed test automatic checks CRAN
In-Reply-To: <CAGeL3J3WWw=ZZPutC6G7fF0Wyf9johLqNa6b6fBxd261ZvpDnA@mail.gmail.com>
References: <CAGeL3J3WWw=ZZPutC6G7fF0Wyf9johLqNa6b6fBxd261ZvpDnA@mail.gmail.com>
Message-ID: <20250512002328.5825fe7a@Tarkus>

On Sat, 10 May 2025 16:48:16 +0200
Lorenzo Sostero <lorenzo.sostero at unibs.it> wrote:

> Flavor: r-devel-windows-x86_64
> Check: tests, Result: ERROR
>     Running 'testthat.R'
>   Running the tests in 'tests/testthat.R' failed.
>   Complete output:
>     > library(testthat)
>     > library(EmiR)
>     > test_check("EmiR")  
>     0%   10   20   30   40   50   60   70   80   90   100%
>     [----|----|----|----|----|----|----|----|----|----|

The process crashes trying to access the contents of a zero-length
vector:

Thread 1 received signal SIGSEGV, Segmentation fault.
[Switching to Thread 1564.0x634]
0x00007ff81e1409df in PSPopulation::init (this=this at entry=0xf243ff59d0)
(gdb) info locals
j = 0
i = 0
progress_bar = <optimized out>
delta = 10.4
pop_size = <optimized out>
d = 4
alpha = {<Rcpp::PreserveStorage<Rcpp::Vector<14,
Rcpp::PreserveStorage>>> = {
 data = 0x2d9ce6732e8, token = 0x2d9ce66d5c0}, <...>,
 cache = {start = 0x1, size = 0}}
(gdb) frame 1
#1  0x00007ff81e0f7b4c in ____C_A_T_C_H____T_E_S_T____0 ()
    at test-example.cpp:106
106       pop_noseed1.init();
(gdb) p (R_xlen_t)XLENGTH(pop_noseed1.m_config.m_alpha.data)
$7 = 0
(gdb) p (double*)REAL(pop_noseed1.m_config.m_alpha.data)
$8 = (double *) 0x1

This should be reproducible on R-4.5.0 or R-devel without extra
configuration flags. Previously this used to read some other memory
that didn't belong to the vector; now the data pointers of such vectors
are invalid, so dereferencing them causes a crash:
https://stat.ethz.ch/pipermail/r-devel/2025-April/083994.html
 
For your future questions: when asking for help with code, it's best to
provide a link to the code in question. This time, it was possible to
find the package at <https://cran.r-project.org/incoming/archive/>.

-- 
Best regards,
Ivan


From A@Comber @end|ng |rom |eed@@@c@uk  Mon May 12 14:01:24 2025
From: A@Comber @end|ng |rom |eed@@@c@uk (Alexis Comber)
Date: Mon, 12 May 2025 12:01:24 +0000
Subject: [R-pkg-devel] 
 [CRAN-pretest-archived] CRAN Submission stgam 1.0.0
In-Reply-To: <01dbc094$Blat.v3.2.24$5f9903a5$2f0804045@mail.statistik.tu-dortmund.de>
References: <20250509025337.33B8DA01D4@xmpalantir.wu.ac.at>
 <01dbc094$Blat.v3.2.24$5f9903a5$2f0804045@mail.statistik.tu-dortmund.de>
Message-ID: <60BF94D7-69EB-44B8-9F97-85EB578B9620@leeds.ac.uk>

I am new to creating R packages and would welcome some advice.

I am trying to update a package but my submission fails and am not sure how to proceed.
The old `stgam` package (v 0.0.1.2) is failing - see https://cran.r-project.org/web/checks/check_results_stgam.html
The new `stgam` package (v 1.0.0) is not failing - see  https://win-builder.r-project.org/incoming_pretest/stgam_1.0.0_20250509_045337/Windows/00check.log and https://win-builder.r-project.org/incoming_pretest/stgam_1.0.0_20250509_045337/Debian/00check.log

I would like to upload my v 1.0.0 to CRAN. How do I resolve this?

With thanks, Lex

Prof. Lex Comber | Professor of Spatial Data Analytics | School of Geography | University of Leeds | Leeds | LS2 9JT | UK | email: a.comber at leeds.ac.uk
(note: I work Monday to Thursday)

On 9 May 2025, at 04:42, ligges at statistik.tu-dortmund.de wrote:

CAUTION: External Message. Use caution opening links and attachments.

Dear maintainer,

package stgam_1.0.0.tar.gz does not pass the incoming checks automatically, please see the following pre-tests (additional issue checks):
Windows: https://win-builder.r-project.org/incoming_pretest/stgam_1.0.0_20250509_045337/Windows/00check.log
Status: OK
Debian: https://win-builder.r-project.org/incoming_pretest/stgam_1.0.0_20250509_045337/Debian/00check.log
Status: OK

Last released version's CRAN status: OK: 3, NOTE: 10
See: https://cran.r-project.org/web/checks/check_results_stgam.html

CRAN Web: https://cran.r-project.org/web/packages/stgam/index.html

More details are given in the directory:

https://win-builder.r-project.org/incoming_pretest/stgam_1.0.0_20250509_045337/

The files will be removed after roughly 7 days.

No strong reverse dependencies to be checked.

Best regards,
CRAN teams' auto-check service
Flavor: r-devel-windows-x86_64
Check: *, Result: NA


Flavor: r-devel-windows-x86_64
Check: Overall checktime, Result: NOTE
 Overall checktime 22 min > 10 min

Flavor: r-devel-linux-x86_64-debian-gcc
Check: *, Result: OK



	[[alternative HTML version deleted]]


From ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de  Mon May 12 16:13:26 2025
From: ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de (Uwe Ligges)
Date: Mon, 12 May 2025 16:13:26 +0200
Subject: [R-pkg-devel] 
 [CRAN-pretest-archived] CRAN Submission stgam 1.0.0
In-Reply-To: <60BF94D7-69EB-44B8-9F97-85EB578B9620@leeds.ac.uk>
References: <20250509025337.33B8DA01D4@xmpalantir.wu.ac.at>
 <01dbc094$Blat.v3.2.24$5f9903a5$2f0804045@mail.statistik.tu-dortmund.de>
 <60BF94D7-69EB-44B8-9F97-85EB578B9620@leeds.ac.uk>
Message-ID: <cfa38edd-248e-4bd8-8f5b-e1bb16db8896@statistik.tu-dortmund.de>

We see

* checking re-building of vignette outputs ... [20m] OK

and overall, checktime is limited to 10 min.

Please reduce the vignette build timings by using
  - small toy data only
  - few iterations
  - or by providing precomputed results for the most lengthy parts. 
Otherwise we cannot afford checking the vignette regularly on CRAN.

Best,
Uwe Ligges



On 12.05.2025 14:01, Alexis Comber wrote:
> I am new to creating R packages and would welcome some advice.
> 
> I am trying to update a package but my submission fails and am not sure how to proceed.
> The old `stgam` package (v 0.0.1.2) is failing - see https://cran.r-project.org/web/checks/check_results_stgam.html
> The new `stgam` package (v 1.0.0) is not failing - see  https://win-builder.r-project.org/incoming_pretest/stgam_1.0.0_20250509_045337/Windows/00check.log and https://win-builder.r-project.org/incoming_pretest/stgam_1.0.0_20250509_045337/Debian/00check.log
> 
> I would like to upload my v 1.0.0 to CRAN. How do I resolve this?
> 
> With thanks, Lex
> 
> Prof. Lex Comber | Professor of Spatial Data Analytics | School of Geography | University of Leeds | Leeds | LS2 9JT | UK | email: a.comber at leeds.ac.uk
> (note: I work Monday to Thursday)
> 
> On 9 May 2025, at 04:42, ligges at statistik.tu-dortmund.de wrote:
> 
> CAUTION: External Message. Use caution opening links and attachments.
> 
> Dear maintainer,
> 
> package stgam_1.0.0.tar.gz does not pass the incoming checks automatically, please see the following pre-tests (additional issue checks):
> Windows: https://win-builder.r-project.org/incoming_pretest/stgam_1.0.0_20250509_045337/Windows/00check.log
> Status: OK
> Debian: https://win-builder.r-project.org/incoming_pretest/stgam_1.0.0_20250509_045337/Debian/00check.log
> Status: OK
> 
> Last released version's CRAN status: OK: 3, NOTE: 10
> See: https://cran.r-project.org/web/checks/check_results_stgam.html
> 
> CRAN Web: https://cran.r-project.org/web/packages/stgam/index.html
> 
> More details are given in the directory:
> 
> https://win-builder.r-project.org/incoming_pretest/stgam_1.0.0_20250509_045337/
> 
> The files will be removed after roughly 7 days.
> 
> No strong reverse dependencies to be checked.
> 
> Best regards,
> CRAN teams' auto-check service
> Flavor: r-devel-windows-x86_64
> Check: *, Result: NA
> 
> 
> Flavor: r-devel-windows-x86_64
> Check: Overall checktime, Result: NOTE
>   Overall checktime 22 min > 10 min
> 
> Flavor: r-devel-linux-x86_64-debian-gcc
> Check: *, Result: OK
> 
> 
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From jm@yu@n @end|ng |rom out|ook@com  Mon May 12 21:49:43 2025
From: jm@yu@n @end|ng |rom out|ook@com (Jiaming Yuan)
Date: Tue, 13 May 2025 03:49:43 +0800
Subject: [R-pkg-devel] CRAN Submission xgboost 1.7.11.1
In-Reply-To: <15bad58d-fd1d-493e-bfb8-ea3dd6d026e0@statistik.tu-dortmund.de>
References: <20250501105800.3FA5CA01B9@xmpalantir.wu.ac.at>
 <c8b1e3ed-bb68-4d29-b9e7-d33a20efd802@statistik.tu-dortmund.de>
 <OS3PR01MB8068DDDF251EA2D84352E2B2F68C2@OS3PR01MB8068.jpnprd01.prod.outlook.com>
 <51df8414-5cce-4eb4-a7f1-8499f52393af@statistik.tu-dortmund.de>
 <5d95cb36-dc9a-4a5b-b08a-182e1e321aad@statistik.tu-dortmund.de>
 <OS3PR01MB8068F43785E19BF9A1FFEAC5F68AA@OS3PR01MB8068.jpnprd01.prod.outlook.com>
 <OS3PR01MB8068A259CA4381B339A21302F68AA@OS3PR01MB8068.jpnprd01.prod.outlook.com>
 <1fab099c-3403-40ad-8cdb-10f697243733@statistik.tu-dortmund.de>
 <15bad58d-fd1d-493e-bfb8-ea3dd6d026e0@statistik.tu-dortmund.de>
Message-ID: <OS3PR01MB80682AFFBE63FE5A61C32C5DF697A@OS3PR01MB8068.jpnprd01.prod.outlook.com>

Hi Uwe,


Please help take a look into reproducing the failure if possible. We 
really appreciate your help. Thanks to Ivan, we managed to reproduce the 
memory protection error. But we haven't reproduced other test failures.


Cheers!

Jiaming

On 5/12/25 17:23, Uwe Ligges wrote:
> We realized this has already been answered by Ivan Krylov on the 
> r-packages-devel list.
>
> Best,
> Uwe Ligges
>
>
> On 12.05.2025 11:07, Uwe Ligges wrote:
>> I'll try to reproduce this locally.
>>
>>
>>
>> On 09.05.2025 06:22, jiaming yuan wrote:
>>> Hi CRAN,
>>>
>>> May I ask if someone has tried to reproduce the openblas test 
>>> environment from CRAN? We are trying to resolve the test failures of 
>>> XGBoost but so far no one has managed to reproduce them locally. 
>>> https://github.com/dmlc/xgboost/issues/11431
>>>
>>> Would be great if you can share some guidance on how to reproduce 
>>> that exact environment.
>>>
>>> Cheers
>>> Jiaming
>>> ________________________________
>>> From: jiaming yuan <jm.yuan at outlook.com>
>>> Sent: Friday, May 9, 2025 12:04:45 PM
>>> To: Uwe Ligges <ligges at statistik.tu-dortmund.de>; CRAN <cran- 
>>> submissions at r-project.org>
>>> Cc: CRAN Package Submission Form <cransubmit at xmbombadil.wu.ac.at>
>>> Subject: Re: CRAN Submission xgboost 1.7.11.1
>>>
>>> Hi,
>>>
>>> Others kindly provided help to reproduce the failure but so far no 
>>> one has managed to do so.
>>>
>>> Please see? https://github.com/dmlc/xgboost/ 
>>> issues/11431#issuecomment-2864947065? and related discussions the 
>>> thread. Would be great if you can share something more precise.
>>>
>>>
>>> Cheers
>>> Jiaming
>>>
>>> ________________________________
>>> From: Uwe Ligges <ligges at statistik.tu-dortmund.de>
>>> Sent: Wednesday, May 7, 2025 9:48:56 PM
>>> To: jiaming yuan <jm.yuan at outlook.com>; CRAN <cran-submissions at r- 
>>> project.org>
>>> Cc: CRAN Package Submission Form <cransubmit at xmbombadil.wu.ac.at>
>>> Subject: Re: CRAN Submission xgboost 1.7.11.1
>>>
>>> Note this is relevant, as most Linux clusters will have admis who will
>>> link scientifiv software aagainst OpenBLAS for faster matriox 
>>> operations.
>>>
>>> Best,
>>> Uwe Ligges
>>>
>>> On 07.05.2025 15:48, Uwe Ligges wrote:
>>>> I think any Liniux system with R linked against the system's default
>>>> OpenBLAS installation will show this issue.
>>>> I'd try it with a standard Ubuntu or Debian with OpenBLAS installed 
>>>> and
>>>> link agasinst it.
>>>>
>>>> Best,
>>>> Uwe Ligges
>>>>
>>>>
>>>>
>>>> On 03.05.2025 08:29, jiaming yuan wrote:
>>>>> Thank you for reaching out. We can't really dive into it unless
>>>>> there's an easier way to reproduce the environment (like a container
>>>>> or using some deterministic package managers). It's very unlikely 
>>>>> that
>>>>> we can try to build that environment on our own then try to fix all
>>>>> errors and verify all fixes.
>>>>>
>>>>>
>>>>>
>>>>> ________________________________
>>>>> From: Uwe Ligges <ligges at statistik.tu-dortmund.de>
>>>>> Sent: Friday, May 2, 2025 8:00:17 PM
>>>>> To: Jiaming Yuan <jm.yuan at outlook.com>; CRAN <cran-submissions at r-
>>>>> project.org>
>>>>> Cc: CRAN Package Submission Form <cransubmit at xmbombadil.wu.ac.at>
>>>>> Subject: Re: CRAN Submission xgboost 1.7.11.1
>>>>>
>>>>> Thanks, we see you removed lots of tests. Is this really sensible and
>>>>> are you sure that users with OpenBLAS (as most Linux users and 
>>>>> cluster
>>>>> admins will use) will get correct results? Sensibly relaxing 
>>>>> numerical
>>>>> assumptions may be a better way to tweak the tests.?
>>>>>
>>>>> Best,
>>>>> Uwe Ligges
>>>>>
>>>>>
>>>>> On 01.05.2025 12:58, CRAN Package Submission Form via 
>>>>> CRAN-submissions
>>>>> wrote:
>>>>>> [This was generated from CRAN.R-project.org/submit.html]
>>>>>>
>>>>>> The following package was uploaded to CRAN:
>>>>>> ===========================================
>>>>>>
>>>>>> Package Information:
>>>>>> Package: xgboost
>>>>>> Version: 1.7.11.1
>>>>>> Title: Extreme Gradient Boosting
>>>>>> Author(s): Tianqi Chen [aut], Tong He [aut], Michael Benesty [aut],
>>>>>> Vadim
>>>>>> Khotilovich [aut], Yuan Tang [aut]
>>>>>> (<https://orcid.org/0000-0001-5243-233X>), Hyunsu Cho [aut],
>>>>>> Kailong Chen [aut], Rory Mitchell [aut], Ignacio Cano [aut],
>>>>>> Tianyi Zhou [aut], Mu Li [aut], Junyuan Xie [aut], Min Lin
>>>>>> [aut], Yifeng Geng [aut], Yutian Li [aut], Jiaming Yuan [aut,
>>>>>> cre], XGBoost contributors [cph] (base XGBoost implementation)
>>>>>> Maintainer: Jiaming Yuan <jm.yuan at outlook.com>
>>>>>> Depends: R (>= 3.3.0)
>>>>>> Suggests: knitr, rmarkdown, ggplot2 (>= 1.0.1), DiagrammeR (>= 
>>>>>> 0.9.0),
>>>>>> Ckmeans.1d.dp (>= 3.3.1), vcd (>= 1.3), cplm, e1071, caret,
>>>>>> testthat, lintr, igraph (>= 1.0.1), float, crayon, titanic
>>>>>> Description: Extreme Gradient Boosting, which is an efficient
>>>>>> implementation of the gradient boosting framework from Chen &
>>>>>> Guestrin (2016) <doi:10.1145/2939672.2939785>. This package
>>>>>> is its R interface. The package includes efficient linear
>>>>>> model solver and tree learning algorithms. The package can
>>>>>> automatically do parallel computation on a single machine
>>>>>> which could be more than 10 times faster than existing
>>>>>> gradient boosting packages. It supports various objective
>>>>>> functions, including regression, classification and ranking.
>>>>>> The package is made to be extensible, so that users are also
>>>>>> allowed to define their own objectives easily.
>>>>>> License: Apache License (== 2.0) | file LICENSE
>>>>>> Imports: Matrix (>= 1.1-0), methods, data.table (>= 1.9.6), jsonlite
>>>>>> (>= 1.0),
>>>>>>
>>>>>>
>>>>>> The maintainer confirms that he or she
>>>>>> has read and agrees to the CRAN policies.
>>>>>>
>>>>>> =================================================
>>>>>>
>>>>>> Original content of DESCRIPTION file:
>>>>>>
>>>>>> Package: xgboost
>>>>>> Type: Package
>>>>>> Title: Extreme Gradient Boosting
>>>>>> Version: 1.7.11.1
>>>>>> Date: 2025-05-01
>>>>>> Authors at R: c(
>>>>>> person("Tianqi", "Chen", role = c("aut"),
>>>>>> email = "tianqi.tchen at gmail.com"),
>>>>>> person("Tong", "He", role = c("aut"),
>>>>>> email = "hetong007 at gmail.com"),
>>>>>> person("Michael", "Benesty", role = c("aut"),
>>>>>> email = "michael at benesty.fr"),
>>>>>> person("Vadim", "Khotilovich", role = c("aut"),
>>>>>> email = "khotilovich at gmail.com"),
>>>>>> person("Yuan", "Tang", role = c("aut"),
>>>>>> email = "terrytangyuan at gmail.com",
>>>>>> comment = c(ORCID = "0000-0001-5243-233X")),
>>>>>> person("Hyunsu", "Cho", role = c("aut"),
>>>>>> email = "chohyu01 at cs.washington.edu"),
>>>>>> person("Kailong", "Chen", role = c("aut")),
>>>>>> person("Rory", "Mitchell", role = c("aut")),
>>>>>> person("Ignacio", "Cano", role = c("aut")),
>>>>>> person("Tianyi", "Zhou", role = c("aut")),
>>>>>> person("Mu", "Li", role = c("aut")),
>>>>>> person("Junyuan", "Xie", role = c("aut")),
>>>>>> person("Min", "Lin", role = c("aut")),
>>>>>> person("Yifeng", "Geng", role = c("aut")),
>>>>>> person("Yutian", "Li", role = c("aut")),
>>>>>> person("Jiaming", "Yuan", role = c("aut", "cre"),
>>>>>> email = "jm.yuan at outlook.com"),
>>>>>> person("XGBoost contributors", role = c("cph"),
>>>>>> comment = "base XGBoost implementation")
>>>>>> )
>>>>>> Maintainer: Jiaming Yuan <jm.yuan at outlook.com>
>>>>>> Description: Extreme Gradient Boosting, which is an efficient
>>>>>> implementation
>>>>>> of the gradient boosting framework from Chen & Guestrin (2016)
>>>>>> <doi:10.1145/2939672.2939785>.
>>>>>> This package is its R interface. The package includes efficient 
>>>>>> linear
>>>>>> model solver and tree learning algorithms. The package can 
>>>>>> automatically
>>>>>> do parallel computation on a single machine which could be more 
>>>>>> than 10
>>>>>> times faster than existing gradient boosting packages. It supports
>>>>>> various objective functions, including regression, classification 
>>>>>> and
>>>>>> ranking.
>>>>>> The package is made to be extensible, so that users are also allowed
>>>>>> to define
>>>>>> their own objectives easily.
>>>>>> License: Apache License (== 2.0) | file LICENSE
>>>>>> URL: https://github.com/dmlc/xgboost
>>>>>> BugReports: https://github.com/dmlc/xgboost/issues
>>>>>> NeedsCompilation: yes
>>>>>> VignetteBuilder: knitr
>>>>>> Suggests: knitr, rmarkdown, ggplot2 (>= 1.0.1), DiagrammeR (>= 
>>>>>> 0.9.0),
>>>>>> Ckmeans.1d.dp (>= 3.3.1), vcd (>= 1.3), cplm, e1071, caret,
>>>>>> testthat, lintr, igraph (>= 1.0.1), float, crayon, titanic
>>>>>> Depends: R (>= 3.3.0)
>>>>>> Imports: Matrix (>= 1.1-0), methods, data.table (>= 1.9.6), jsonlite
>>>>>> (>= 1.0),
>>>>>> RoxygenNote: 7.3.2
>>>>>> Encoding: UTF-8
>>>>>> SystemRequirements: GNU make, C++17
>>>>>> Packaged: 2025-05-01 10:56:14 UTC; jiamingy
>>>>>> Author: Tianqi Chen [aut],
>>>>>> Tong He [aut],
>>>>>> Michael Benesty [aut],
>>>>>> Vadim Khotilovich [aut],
>>>>>> Yuan Tang [aut] (<https://orcid.org/0000-0001-5243-233X>),
>>>>>> Hyunsu Cho [aut],
>>>>>> Kailong Chen [aut],
>>>>>> Rory Mitchell [aut],
>>>>>> Ignacio Cano [aut],
>>>>>> Tianyi Zhou [aut],
>>>>>> Mu Li [aut],
>>>>>> Junyuan Xie [aut],
>>>>>> Min Lin [aut],
>>>>>> Yifeng Geng [aut],
>>>>>> Yutian Li [aut],
>>>>>> Jiaming Yuan [aut, cre],
>>>>>> XGBoost contributors [cph] (base XGBoost implementation)
>>>>>>
>>>>>
>>>>>
>>>>>
>>>>> ???? [[alternative HTML version deleted]]
>>>>>
>>>>
>>>
>>>
>>>
>>> ????[[alternative HTML version deleted]]
>>>
>>
>


From |oy@d01 @end|ng |rom gm@||@com  Mon May 12 23:45:10 2025
From: |oy@d01 @end|ng |rom gm@||@com (Adam Loy)
Date: Mon, 12 May 2025 16:45:10 -0500
Subject: [R-pkg-devel] Help passing CRAN pre-checks
Message-ID: <CA+b-ys3PhzFpcZ9TtDCFfAShKiGVr6SpyNtFg1Jm=UTZ0FgygQ@mail.gmail.com>

Hi all,

I am having trouble getting past the pre-checks for CRAN, but things check
out in my testing localling in the cloud. I get this message on Debian:

Error: package or namespace load failed for ?HLMdiag? in
dyn.load(file, DLLpath = DLLpath, ...):
 unable to load shared object
'/srv/hornik/tmp/CRAN_pretest/HLMdiag.Rcheck/00LOCK-HLMdiag/00new/HLMdiag/libs/HLMdiag.so':

/srv/hornik/tmp/CRAN_pretest/HLMdiag.Rcheck/00LOCK-HLMdiag/00new/HLMdiag/libs/HLMdiag.so:
undefined symbol: dgetri_
Error: loading failed

The package uses RcppArmadillo so I thought the issue was an error in
the makefile, but I think that checks out.

Any help would be appreciated. My codebase is on github:
https://github.com/aloy/HLMdiag


Thank you,

Adam

	[[alternative HTML version deleted]]


From edd @end|ng |rom deb|@n@org  Tue May 13 00:29:14 2025
From: edd @end|ng |rom deb|@n@org (Dirk Eddelbuettel)
Date: Mon, 12 May 2025 17:29:14 -0500
Subject: [R-pkg-devel] Help passing CRAN pre-checks
In-Reply-To: <CA+b-ys3PhzFpcZ9TtDCFfAShKiGVr6SpyNtFg1Jm=UTZ0FgygQ@mail.gmail.com>
References: <CA+b-ys3PhzFpcZ9TtDCFfAShKiGVr6SpyNtFg1Jm=UTZ0FgygQ@mail.gmail.com>
Message-ID: <26658.30266.215125.849394@rob.eddelbuettel.com>


On 12 May 2025 at 16:45, Adam Loy wrote:
| Hi all,
| 
| I am having trouble getting past the pre-checks for CRAN, but things check
| out in my testing localling in the cloud. I get this message on Debian:
| 
| Error: package or namespace load failed for ?HLMdiag? in
| dyn.load(file, DLLpath = DLLpath, ...):
|  unable to load shared object
| '/srv/hornik/tmp/CRAN_pretest/HLMdiag.Rcheck/00LOCK-HLMdiag/00new/HLMdiag/libs/HLMdiag.so':
| 
| /srv/hornik/tmp/CRAN_pretest/HLMdiag.Rcheck/00LOCK-HLMdiag/00new/HLMdiag/libs/HLMdiag.so:
| undefined symbol: dgetri_
| Error: loading failed
| 
| The package uses RcppArmadillo so I thought the issue was an error in
| the makefile, but I think that checks out.
| 
| Any help would be appreciated. My codebase is on github:
| https://github.com/aloy/HLMdiag

Rename src/Makevars.txt (a file that will be ignored with that extension) to
src/Makevars and your linking will be complete, and the load error above is
likely going away.

Dirk

-- 
dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From @m@||ep@||on @end|ng |rom proton@me  Tue May 13 19:05:14 2025
From: @m@||ep@||on @end|ng |rom proton@me (smallepsilon)
Date: Tue, 13 May 2025 17:05:14 +0000
Subject: [R-pkg-devel] Advice for addressing CRAN rejection
Message-ID: <6Xgzv9HbaJrtioSMI2xyarWrdceEVdLuT4cdONaU5d5iofwNzI-9lHxGhPAJT7QJfWin6qgx7f96pCL4j9fFyRXet-sS7wKIu68SNJzkmhs=@proton.me>

I have been trying to fix some issues with my package's testing on CRAN, which culminated in a rejection email from a CRAN administrator that I am not sure how to address.

The first issues arose with MKL. (I got helpful information about that recently on r-help.) In many package tests, I want to verify that two ways of specifying something lead to the execution of exactly the same calculations. I use identical() as a proxy for this, but because numeric results are not necessarily reproducible when using parallel processing, this does not work on all platforms.

My initial attempts to address this involved replacing the offending identical() calls with all.equal() calls. After two or three such attempts, I realized that because all.equal() does not test (even as a proxy) that the same calculations were done, it is impractical and unnecessary to run these tests on all of the CRAN platforms. I moved the original test files to a separate folder on my computer so I can run them all locally. (My assumption is that if the logic is correct on my computer, then it is correct on all of them, and identical() helps verify this.) In the newest package version uploaded to CRAN, I included the tests that verify the essential functionality of the package so that the crucial output values are the same on all platforms, up to a reasonable number of significant digits. These are the tests that are clearly important to run on all platforms.

My submission was rejected, not because of test failures, but because I had "removed the failing tests which is not the idea of tests." No errors/warnings/notes were reported to me. The only option I have been given is to replace identical() with all.equal(), which defeats the purpose of these particular tests.

I replied to the administrator's email with a brief version of all of this, but have not gotten a response. Any advice on what else I could do would be appreciated.

Thanks,

Jesse


From bbo|ker @end|ng |rom gm@||@com  Tue May 13 20:41:19 2025
From: bbo|ker @end|ng |rom gm@||@com (Ben Bolker)
Date: Tue, 13 May 2025 14:41:19 -0400
Subject: [R-pkg-devel] Advice for addressing CRAN rejection
In-Reply-To: <6Xgzv9HbaJrtioSMI2xyarWrdceEVdLuT4cdONaU5d5iofwNzI-9lHxGhPAJT7QJfWin6qgx7f96pCL4j9fFyRXet-sS7wKIu68SNJzkmhs=@proton.me>
References: <6Xgzv9HbaJrtioSMI2xyarWrdceEVdLuT4cdONaU5d5iofwNzI-9lHxGhPAJT7QJfWin6qgx7f96pCL4j9fFyRXet-sS7wKIu68SNJzkmhs=@proton.me>
Message-ID: <CABghstTA+GpVwqGNUmNS944HMV4h3RBoAbTPDuWEV-JDV-Y5Xg@mail.gmail.com>

Can you please clarify (maybe by linking back to an earlier thread, don't
remember if you discussed this previously) what you mean by "I realized
that because all.equal() does not test (even as a proxy) that the same
calculations were done"?

On Tue, May 13, 2025, 1:05 PM smallepsilon <smallepsilon at proton.me> wrote:

> I have been trying to fix some issues with my package's testing on CRAN,
> which culminated in a rejection email from a CRAN administrator that I am
> not sure how to address.
>
> The first issues arose with MKL. (I got helpful information about that
> recently on r-help.) In many package tests, I want to verify that two ways
> of specifying something lead to the execution of exactly the same
> calculations. I use identical() as a proxy for this, but because numeric
> results are not necessarily reproducible when using parallel processing,
> this does not work on all platforms.
>
> My initial attempts to address this involved replacing the offending
> identical() calls with all.equal() calls. After two or three such attempts,
> I realized that because all.equal() does not test (even as a proxy) that
> the same calculations were done, it is impractical and unnecessary to run
> these tests on all of the CRAN platforms. I moved the original test files
> to a separate folder on my computer so I can run them all locally. (My
> assumption is that if the logic is correct on my computer, then it is
> correct on all of them, and identical() helps verify this.) In the newest
> package version uploaded to CRAN, I included the tests that verify the
> essential functionality of the package so that the crucial output values
> are the same on all platforms, up to a reasonable number of significant
> digits. These are the tests that are clearly important to run on all
> platforms.
>
> My submission was rejected, not because of test failures, but because I
> had "removed the failing tests which is not the idea of tests." No
> errors/warnings/notes were reported to me. The only option I have been
> given is to replace identical() with all.equal(), which defeats the purpose
> of these particular tests.
>
> I replied to the administrator's email with a brief version of all of
> this, but have not gotten a response. Any advice on what else I could do
> would be appreciated.
>
> Thanks,
>
> Jesse
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From @m@||ep@||on @end|ng |rom proton@me  Tue May 13 21:08:00 2025
From: @m@||ep@||on @end|ng |rom proton@me (smallepsilon)
Date: Tue, 13 May 2025 19:08:00 +0000
Subject: [R-pkg-devel] Advice for addressing CRAN rejection
In-Reply-To: <CABghstTA+GpVwqGNUmNS944HMV4h3RBoAbTPDuWEV-JDV-Y5Xg@mail.gmail.com>
References: <6Xgzv9HbaJrtioSMI2xyarWrdceEVdLuT4cdONaU5d5iofwNzI-9lHxGhPAJT7QJfWin6qgx7f96pCL4j9fFyRXet-sS7wKIu68SNJzkmhs=@proton.me>
 <CABghstTA+GpVwqGNUmNS944HMV4h3RBoAbTPDuWEV-JDV-Y5Xg@mail.gmail.com>
Message-ID: <ii8rfznsuStLO9wRzKlDbJIkcdR9fvDUtlOf4548fLxZuINIEATTafeuS6ZY29bUZH_F2uDLatGk5rWzAfp0vB8nAoSWy-s8dIZPFgZfR6A=@proton.me>

Ben,

The thread to which I alluded is here: https://stat.ethz.ch/pipermail/r-help/2025-May/480866.html

Further clarification: The package provides some convenience shortcuts for the user which should run the same calculations as their longer counterparts. I want to use identical() to provide strong evidence that this is happening. Suppose, for example, that X is a symmetric, positive definite matrix. Then identical() will usually distinguish between (X^1/2)^-1 and (X^-1)^1/2 (the kind of thing I want to be able to check) while all.equal() will generally not (unless I set the tolerance sufficiently low, but that is just making all.equal() behave more like identical()). Using all.equal() helps detect catastrophic errors, but those would be detected in other tests already.

Thanks,

Jesse


On Tuesday, May 13th, 2025 at 1:41 PM, Ben Bolker <bbolker at gmail.com> wrote:

> Can you please clarify (maybe by linking back to an earlier thread, don't remember if you discussed this previously) what you mean by "I realized that because all.equal() does not test (even as a proxy) that the same calculations were done"?
> 
> 
> On Tue, May 13, 2025, 1:05 PM smallepsilon <smallepsilon at proton.me> wrote:
> 
> > I have been trying to fix some issues with my package's testing on CRAN, which culminated in a rejection email from a CRAN administrator that I am not sure how to address.
> > 
> > The first issues arose with MKL. (I got helpful information about that recently on r-help.) In many package tests, I want to verify that two ways of specifying something lead to the execution of exactly the same calculations. I use identical() as a proxy for this, but because numeric results are not necessarily reproducible when using parallel processing, this does not work on all platforms.
> > 
> > My initial attempts to address this involved replacing the offending identical() calls with all.equal() calls. After two or three such attempts, I realized that because all.equal() does not test (even as a proxy) that the same calculations were done, it is impractical and unnecessary to run these tests on all of the CRAN platforms. I moved the original test files to a separate folder on my computer so I can run them all locally. (My assumption is that if the logic is correct on my computer, then it is correct on all of them, and identical() helps verify this.) In the newest package version uploaded to CRAN, I included the tests that verify the essential functionality of the package so that the crucial output values are the same on all platforms, up to a reasonable number of significant digits. These are the tests that are clearly important to run on all platforms.
> > 
> > My submission was rejected, not because of test failures, but because I had "removed the failing tests which is not the idea of tests." No errors/warnings/notes were reported to me. The only option I have been given is to replace identical() with all.equal(), which defeats the purpose of these particular tests.
> > 
> > I replied to the administrator's email with a brief version of all of this, but have not gotten a response. Any advice on what else I could do would be appreciated.
> > 
> > Thanks,
> > 
> > Jesse
> > 
> > ______________________________________________
> > R-package-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-package-devel


From bbo|ker @end|ng |rom gm@||@com  Wed May 14 03:07:43 2025
From: bbo|ker @end|ng |rom gm@||@com (Ben Bolker)
Date: Tue, 13 May 2025 21:07:43 -0400
Subject: [R-pkg-devel] Advice for addressing CRAN rejection
In-Reply-To: <ii8rfznsuStLO9wRzKlDbJIkcdR9fvDUtlOf4548fLxZuINIEATTafeuS6ZY29bUZH_F2uDLatGk5rWzAfp0vB8nAoSWy-s8dIZPFgZfR6A=@proton.me>
References: <6Xgzv9HbaJrtioSMI2xyarWrdceEVdLuT4cdONaU5d5iofwNzI-9lHxGhPAJT7QJfWin6qgx7f96pCL4j9fFyRXet-sS7wKIu68SNJzkmhs=@proton.me>
 <CABghstTA+GpVwqGNUmNS944HMV4h3RBoAbTPDuWEV-JDV-Y5Xg@mail.gmail.com>
 <ii8rfznsuStLO9wRzKlDbJIkcdR9fvDUtlOf4548fLxZuINIEATTafeuS6ZY29bUZH_F2uDLatGk5rWzAfp0vB8nAoSWy-s8dIZPFgZfR6A=@proton.me>
Message-ID: <57123dcb-8d51-4997-8b80-ebfbf6362b48@gmail.com>

    Hmm. The thread you linked to is specifically an issue with 
non-deterministic linear algebra, the solution to which is to disable 
threaded computations. I don't think CRAN multithreads by default (and I 
don't know if they test on MKL at all ...?)

   Can you provide more specific/concrete examples of the tests? (Again, 
I apologize if there were examples posted up-thread -- I'm too lazy to 
search for them.) I'm not quite sure I understand your comment about

 > Suppose, for example, that X is a symmetric, positive definite 
matrix. Then identical() will usually distinguish between (X^1/2)^-1 and 
(X^-1)^1/2 (the kind of thing I want to be able to check) while 
all.equal() will generally not


    What is X^1/2? (There are infinitely many ways to take a matrix 
square root ...) Interpreting X^(1/2) as chol(X) and X^(-1) as solve(X), 
these are not even close:

 > set.seed(101); m <- crossprod(matrix(rnorm(9), 3, 3))
 > all.equal(solve(chol(m)), chol(solve(m)))
[1] "Mean relative difference: 0.6655765"


   In general "convenience shortcuts" that do any kind of rearranging of 
a floating point computation **cannot** be guaranteed to be identical; 
this is a corollary of

https://cran.r-project.org/doc/FAQ/R-FAQ.html#Why-doesn_0027t-R-think-these-numbers-are-equal_003f

See also 
https://stackoverflow.com/questions/9508518/why-are-these-numbers-not-equal/9508558#9508558

(e.g., floating-point addition is not associative)

   I apologize if this sounds basic/is telling you something you already 
know, but from what I can understand of your questions so far, you are 
asking for something that is not possible in general.

   Can you clarify further please?

   cheers
    Ben Bolker



On 5/13/25 15:08, smallepsilon wrote:
> Ben,
> 
> The thread to which I alluded is here: https://stat.ethz.ch/pipermail/r-help/2025-May/480866.html
> 
> Further clarification: The package provides some convenience shortcuts for the user which should run the same calculations as their longer counterparts. I want to use identical() to provide strong evidence that this is happening. Suppose, for example, that X is a symmetric, positive definite matrix. Then identical() will usually distinguish between (X^1/2)^-1 and (X^-1)^1/2 (the kind of thing I want to be able to check) while all.equal() will generally not (unless I set the tolerance sufficiently low, but that is just making all.equal() behave more like identical()). Using all.equal() helps detect catastrophic errors, but those would be detected in other tests already.
> 
> Thanks,
> 
> Jesse
> 
> 
> On Tuesday, May 13th, 2025 at 1:41 PM, Ben Bolker <bbolker at gmail.com> wrote:
> 
>> Can you please clarify (maybe by linking back to an earlier thread, don't remember if you discussed this previously) what you mean by "I realized that because all.equal() does not test (even as a proxy) that the same calculations were done"?
>>
>>
>> On Tue, May 13, 2025, 1:05 PM smallepsilon <smallepsilon at proton.me> wrote:
>>
>>> I have been trying to fix some issues with my package's testing on CRAN, which culminated in a rejection email from a CRAN administrator that I am not sure how to address.
>>>
>>> The first issues arose with MKL. (I got helpful information about that recently on r-help.) In many package tests, I want to verify that two ways of specifying something lead to the execution of exactly the same calculations. I use identical() as a proxy for this, but because numeric results are not necessarily reproducible when using parallel processing, this does not work on all platforms.
>>>
>>> My initial attempts to address this involved replacing the offending identical() calls with all.equal() calls. After two or three such attempts, I realized that because all.equal() does not test (even as a proxy) that the same calculations were done, it is impractical and unnecessary to run these tests on all of the CRAN platforms. I moved the original test files to a separate folder on my computer so I can run them all locally. (My assumption is that if the logic is correct on my computer, then it is correct on all of them, and identical() helps verify this.) In the newest package version uploaded to CRAN, I included the tests that verify the essential functionality of the package so that the crucial output values are the same on all platforms, up to a reasonable number of significant digits. These are the tests that are clearly important to run on all platforms.
>>>
>>> My submission was rejected, not because of test failures, but because I had "removed the failing tests which is not the idea of tests." No errors/warnings/notes were reported to me. The only option I have been given is to replace identical() with all.equal(), which defeats the purpose of these particular tests.
>>>
>>> I replied to the administrator's email with a brief version of all of this, but have not gotten a response. Any advice on what else I could do would be appreciated.
>>>
>>> Thanks,
>>>
>>> Jesse
>>>
>>> ______________________________________________
>>> R-package-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel

-- 
Dr. Benjamin Bolker
Professor, Mathematics & Statistics and Biology, McMaster University
Director, School of Computational Science and Engineering
* E-mail is sent at my convenience; I don't expect replies outside of 
working hours.


From edd @end|ng |rom deb|@n@org  Wed May 14 03:20:46 2025
From: edd @end|ng |rom deb|@n@org (Dirk Eddelbuettel)
Date: Tue, 13 May 2025 20:20:46 -0500
Subject: [R-pkg-devel] Advice for addressing CRAN rejection
In-Reply-To: <57123dcb-8d51-4997-8b80-ebfbf6362b48@gmail.com>
References: <6Xgzv9HbaJrtioSMI2xyarWrdceEVdLuT4cdONaU5d5iofwNzI-9lHxGhPAJT7QJfWin6qgx7f96pCL4j9fFyRXet-sS7wKIu68SNJzkmhs=@proton.me>
 <CABghstTA+GpVwqGNUmNS944HMV4h3RBoAbTPDuWEV-JDV-Y5Xg@mail.gmail.com>
 <ii8rfznsuStLO9wRzKlDbJIkcdR9fvDUtlOf4548fLxZuINIEATTafeuS6ZY29bUZH_F2uDLatGk5rWzAfp0vB8nAoSWy-s8dIZPFgZfR6A=@proton.me>
 <57123dcb-8d51-4997-8b80-ebfbf6362b48@gmail.com>
Message-ID: <26659.61422.999636.466125@rob.eddelbuettel.com>


On 13 May 2025 at 21:07, Ben Bolker wrote:
| threaded computations. I don't think CRAN multithreads by default (and I 
| don't know if they test on MKL at all ...?)


CRAN itself writes at https://cran.r-project.org/CRAN_team.htm :

  CRAN QA

  CRAN package checks on combinations of various plattforms, R flavours, and for additional issues are provided by
  - Kurt Hornik (Debian)
  - Tomas Kalibera (additional issues: rchk, rcnst, rlibro)
  - Uwe Ligges (Windows)
  - Brian D. Ripley (Fedora; additional issues, including: ATLAS, BLAS, MKL, OpenBLAS, LTO, M1mac, clang-ASAN, clang-UBSAN, gcc-ASAN, gcc-UBSAN, noLD, noOMP, valgrind)
  - Simon Urbanek (macOS)
   
Sp MKL is one of several 'additional issues' tests done by Brian Ripley, see
the mirror at
  https://github.com/r-devel/r-dev-web/tree/main/CRAN/QA/BDR/gannet
There is a higher-level README linked from CRAN package pages but I can't
find it now :-/

Dirk

-- 
dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From t|m@t@y|or @end|ng |rom h|ddene|eph@nt@@co@uk  Wed May 14 10:04:25 2025
From: t|m@t@y|or @end|ng |rom h|ddene|eph@nt@@co@uk (Tim Taylor)
Date: Wed, 14 May 2025 09:04:25 +0100
Subject: [R-pkg-devel] Advice for addressing CRAN rejection
In-Reply-To: <26659.61422.999636.466125@rob.eddelbuettel.com>
References: <26659.61422.999636.466125@rob.eddelbuettel.com>
Message-ID: <E27F95DC-4276-41A0-A1CA-CCF39D15DA34@hiddenelephants.co.uk>



> On 14 May 2025, at 02:21, Dirk Eddelbuettel <edd at debian.org> wrote:
> 
?
> There is a higher-level README linked from CRAN package pages but I can't
> find it now :-/

https://cran.r-project.org/web/checks/check_issue_kinds.html I believe 

Tim
	[[alternative HTML version deleted]]


From @m@||ep@||on @end|ng |rom proton@me  Wed May 14 17:18:27 2025
From: @m@||ep@||on @end|ng |rom proton@me (smallepsilon)
Date: Wed, 14 May 2025 15:18:27 +0000
Subject: [R-pkg-devel] Advice for addressing CRAN rejection
In-Reply-To: <57123dcb-8d51-4997-8b80-ebfbf6362b48@gmail.com>
References: <6Xgzv9HbaJrtioSMI2xyarWrdceEVdLuT4cdONaU5d5iofwNzI-9lHxGhPAJT7QJfWin6qgx7f96pCL4j9fFyRXet-sS7wKIu68SNJzkmhs=@proton.me>
 <CABghstTA+GpVwqGNUmNS944HMV4h3RBoAbTPDuWEV-JDV-Y5Xg@mail.gmail.com>
 <ii8rfznsuStLO9wRzKlDbJIkcdR9fvDUtlOf4548fLxZuINIEATTafeuS6ZY29bUZH_F2uDLatGk5rWzAfp0vB8nAoSWy-s8dIZPFgZfR6A=@proton.me>
 <57123dcb-8d51-4997-8b80-ebfbf6362b48@gmail.com>
Message-ID: <N9bUhUZvgeH8PPIB3GIgPsGDemccWUenOPyfckOUmnpIcvF-r6F4oPwyW1eBWSijGMEMl6MM1cifnxYkpjmAtz4P3wjuYRGhuJuK9SwS9C8=@proton.me>

Ben,

No need to apologize. I hope the following example helps clarify what I mean. Suppose that modify_matrix(mat, other_args) is a function that, among other things, applies eigen() to mat. For good reasons, other_args has no default value. It is sometimes convenient, though, to supply the user with default values. Therefore, there is another function, convenient_modify_matrix():

convenient_modify_matrix(mat) <- function(mat) modify_matrix(mat, other_args = default).

To help verify that the code is correct, I want to check the result from identical() below:

set.seed(20250514)
A <- modify_matrix(mat, other_args = default)
set.seed(20250514)
B <- convenient_modify_matrix(mat)
identical(A, B)

In an ideal world, the result would be TRUE. The results can differ, though, because of multithreading (synonymous with parallel computation, yes?) used by the code underlying eigen(). As I understand it, this occurs when calling LAPACK/BLAS routines on some systems (e.g., MKL). Can that multithreading be turned off? Searching online shows that there is a lot of interest in turning it on; not so much in turning it off.

Thanks,
Jesse





On Tuesday, May 13th, 2025 at 8:07 PM, Ben Bolker <bbolker at gmail.com> wrote:

> 
> 
> Hmm. The thread you linked to is specifically an issue with
> non-deterministic linear algebra, the solution to which is to disable
> threaded computations. I don't think CRAN multithreads by default (and I
> don't know if they test on MKL at all ...?)
> 
> Can you provide more specific/concrete examples of the tests? (Again,
> I apologize if there were examples posted up-thread -- I'm too lazy to
> search for them.) I'm not quite sure I understand your comment about
> 
> > Suppose, for example, that X is a symmetric, positive definite
> 
> matrix. Then identical() will usually distinguish between (X^1/2)^-1 and
> (X^-1)^1/2 (the kind of thing I want to be able to check) while
> all.equal() will generally not
> 
> 
> What is X^1/2? (There are infinitely many ways to take a matrix
> square root ...) Interpreting X^(1/2) as chol(X) and X^(-1) as solve(X),
> these are not even close:
> 
> > set.seed(101); m <- crossprod(matrix(rnorm(9), 3, 3))
> 
> > all.equal(solve(chol(m)), chol(solve(m)))
> 
> [1] "Mean relative difference: 0.6655765"
> 
> 
> In general "convenience shortcuts" that do any kind of rearranging of
> a floating point computation cannot be guaranteed to be identical;
> this is a corollary of
> 
> https://cran.r-project.org/doc/FAQ/R-FAQ.html#Why-doesn_0027t-R-think-these-numbers-are-equal_003f
> 
> See also
> https://stackoverflow.com/questions/9508518/why-are-these-numbers-not-equal/9508558#9508558
> 
> (e.g., floating-point addition is not associative)
> 
> I apologize if this sounds basic/is telling you something you already
> know, but from what I can understand of your questions so far, you are
> asking for something that is not possible in general.
> 
> Can you clarify further please?
> 
> cheers
> Ben Bolker
> 
> 
> 
> On 5/13/25 15:08, smallepsilon wrote:
> 
> > Ben,
> > 
> > The thread to which I alluded is here: https://stat.ethz.ch/pipermail/r-help/2025-May/480866.html
> > 
> > Further clarification: The package provides some convenience shortcuts for the user which should run the same calculations as their longer counterparts. I want to use identical() to provide strong evidence that this is happening. Suppose, for example, that X is a symmetric, positive definite matrix. Then identical() will usually distinguish between (X^1/2)^-1 and (X^-1)^1/2 (the kind of thing I want to be able to check) while all.equal() will generally not (unless I set the tolerance sufficiently low, but that is just making all.equal() behave more like identical()). Using all.equal() helps detect catastrophic errors, but those would be detected in other tests already.
> > 
> > Thanks,
> > 
> > Jesse
> > 
> > On Tuesday, May 13th, 2025 at 1:41 PM, Ben Bolker bbolker at gmail.com wrote:
> > 
> > > Can you please clarify (maybe by linking back to an earlier thread, don't remember if you discussed this previously) what you mean by "I realized that because all.equal() does not test (even as a proxy) that the same calculations were done"?
> > > 
> > > On Tue, May 13, 2025, 1:05 PM smallepsilon smallepsilon at proton.me wrote:
> > > 
> > > > I have been trying to fix some issues with my package's testing on CRAN, which culminated in a rejection email from a CRAN administrator that I am not sure how to address.
> > > > 
> > > > The first issues arose with MKL. (I got helpful information about that recently on r-help.) In many package tests, I want to verify that two ways of specifying something lead to the execution of exactly the same calculations. I use identical() as a proxy for this, but because numeric results are not necessarily reproducible when using parallel processing, this does not work on all platforms.
> > > > 
> > > > My initial attempts to address this involved replacing the offending identical() calls with all.equal() calls. After two or three such attempts, I realized that because all.equal() does not test (even as a proxy) that the same calculations were done, it is impractical and unnecessary to run these tests on all of the CRAN platforms. I moved the original test files to a separate folder on my computer so I can run them all locally. (My assumption is that if the logic is correct on my computer, then it is correct on all of them, and identical() helps verify this.) In the newest package version uploaded to CRAN, I included the tests that verify the essential functionality of the package so that the crucial output values are the same on all platforms, up to a reasonable number of significant digits. These are the tests that are clearly important to run on all platforms.
> > > > 
> > > > My submission was rejected, not because of test failures, but because I had "removed the failing tests which is not the idea of tests." No errors/warnings/notes were reported to me. The only option I have been given is to replace identical() with all.equal(), which defeats the purpose of these particular tests.
> > > > 
> > > > I replied to the administrator's email with a brief version of all of this, but have not gotten a response. Any advice on what else I could do would be appreciated.
> > > > 
> > > > Thanks,
> > > > 
> > > > Jesse
> > > > 
> > > > ______________________________________________
> > > > R-package-devel at r-project.org mailing list
> > > > https://stat.ethz.ch/mailman/listinfo/r-package-devel
> 
> 
> --
> Dr. Benjamin Bolker
> Professor, Mathematics & Statistics and Biology, McMaster University
> Director, School of Computational Science and Engineering
> * E-mail is sent at my convenience; I don't expect replies outside of
> working hours.


From edd @end|ng |rom deb|@n@org  Wed May 14 17:33:04 2025
From: edd @end|ng |rom deb|@n@org (Dirk Eddelbuettel)
Date: Wed, 14 May 2025 10:33:04 -0500
Subject: [R-pkg-devel] Advice for addressing CRAN rejection
In-Reply-To: <N9bUhUZvgeH8PPIB3GIgPsGDemccWUenOPyfckOUmnpIcvF-r6F4oPwyW1eBWSijGMEMl6MM1cifnxYkpjmAtz4P3wjuYRGhuJuK9SwS9C8=@proton.me>
References: <6Xgzv9HbaJrtioSMI2xyarWrdceEVdLuT4cdONaU5d5iofwNzI-9lHxGhPAJT7QJfWin6qgx7f96pCL4j9fFyRXet-sS7wKIu68SNJzkmhs=@proton.me>
 <CABghstTA+GpVwqGNUmNS944HMV4h3RBoAbTPDuWEV-JDV-Y5Xg@mail.gmail.com>
 <ii8rfznsuStLO9wRzKlDbJIkcdR9fvDUtlOf4548fLxZuINIEATTafeuS6ZY29bUZH_F2uDLatGk5rWzAfp0vB8nAoSWy-s8dIZPFgZfR6A=@proton.me>
 <57123dcb-8d51-4997-8b80-ebfbf6362b48@gmail.com>
 <N9bUhUZvgeH8PPIB3GIgPsGDemccWUenOPyfckOUmnpIcvF-r6F4oPwyW1eBWSijGMEMl6MM1cifnxYkpjmAtz4P3wjuYRGhuJuK9SwS9C8=@proton.me>
Message-ID: <26660.47024.623391.863228@rob.eddelbuettel.com>


On 14 May 2025 at 15:18, smallepsilon wrote:
| Ben,
| 
| No need to apologize. I hope the following example helps clarify what I mean. Suppose that modify_matrix(mat, other_args) is a function that, among other things, applies eigen() to mat. For good reasons, other_args has no default value. It is sometimes convenient, though, to supply the user with default values. Therefore, there is another function, convenient_modify_matrix():
| 
| convenient_modify_matrix(mat) <- function(mat) modify_matrix(mat, other_args = default).
| 
| To help verify that the code is correct, I want to check the result from identical() below:
| 
| set.seed(20250514)
| A <- modify_matrix(mat, other_args = default)
| set.seed(20250514)
| B <- convenient_modify_matrix(mat)
| identical(A, B)
| 
| In an ideal world, the result would be TRUE. The results can differ, though, because of multithreading (synonymous with parallel computation, yes?) used by the code underlying eigen(). As I understand it, this occurs when calling LAPACK/BLAS routines on some systems (e.g., MKL). Can that multithreading be turned off? Searching online shows that there is a lot of interest in turning it on; not so much in turning it off.

Section 'A.3.1.3 Intel MKL' of the R Installation and Administration manual
covers that for the MKL case (and general OpenMP cases)

   The default number of threads will be chosen by the OpenMP software, but
   can be controlled by setting ?OMP_NUM_THREADS? or ?MKL_NUM_THREADS?, and
   in recent versions seems to default to a sensible value for sole use of
   the machine.

The entire section makes for good reading, it mixes 'how to install MKL' with
'how to use MKL' and touches upon the parellism issue you have here.

Dirk

-- 
dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From t|m@t@y|or @end|ng |rom h|ddene|eph@nt@@co@uk  Wed May 14 17:51:02 2025
From: t|m@t@y|or @end|ng |rom h|ddene|eph@nt@@co@uk (Tim Taylor)
Date: Wed, 14 May 2025 16:51:02 +0100
Subject: [R-pkg-devel] Advice for addressing CRAN rejection
In-Reply-To: <N9bUhUZvgeH8PPIB3GIgPsGDemccWUenOPyfckOUmnpIcvF-r6F4oPwyW1eBWSijGMEMl6MM1cifnxYkpjmAtz4P3wjuYRGhuJuK9SwS9C8=@proton.me>
References: <6Xgzv9HbaJrtioSMI2xyarWrdceEVdLuT4cdONaU5d5iofwNzI-9lHxGhPAJT7QJfWin6qgx7f96pCL4j9fFyRXet-sS7wKIu68SNJzkmhs=@proton.me>
 <CABghstTA+GpVwqGNUmNS944HMV4h3RBoAbTPDuWEV-JDV-Y5Xg@mail.gmail.com>
 <ii8rfznsuStLO9wRzKlDbJIkcdR9fvDUtlOf4548fLxZuINIEATTafeuS6ZY29bUZH_F2uDLatGk5rWzAfp0vB8nAoSWy-s8dIZPFgZfR6A=@proton.me>
 <57123dcb-8d51-4997-8b80-ebfbf6362b48@gmail.com>
 <N9bUhUZvgeH8PPIB3GIgPsGDemccWUenOPyfckOUmnpIcvF-r6F4oPwyW1eBWSijGMEMl6MM1cifnxYkpjmAtz4P3wjuYRGhuJuK9SwS9C8=@proton.me>
Message-ID: <7a0b0d01-a6f9-4b81-9299-eb50ee2de5c2@app.fastmail.com>

On Wed, 14 May 2025, at 4:18 PM, smallepsilon wrote:

> No need to apologize. I hope the following example helps clarify what I 
> mean. Suppose that modify_matrix(mat, other_args) is a function that, 
> among other things, applies eigen() to mat. For good reasons, 
> other_args has no default value. It is sometimes convenient, though, to 
> supply the user with default values. Therefore, there is another 
> function, convenient_modify_matrix():
>

I'd just use all.equal but I *think* you could just check the call is constructed correctly, e.g.

convenient_modify_matrix <- function(mat) modify_matrix(mat, other_args = default)

identical(
  body(convenient_modify_matrix),
  call("modify_matrix", quote(mat), other_args = quote(default))
)


From @m@||ep@||on @end|ng |rom proton@me  Wed May 14 18:26:31 2025
From: @m@||ep@||on @end|ng |rom proton@me (smallepsilon)
Date: Wed, 14 May 2025 16:26:31 +0000
Subject: [R-pkg-devel] Advice for addressing CRAN rejection
In-Reply-To: <26660.47024.623391.863228@rob.eddelbuettel.com>
References: <6Xgzv9HbaJrtioSMI2xyarWrdceEVdLuT4cdONaU5d5iofwNzI-9lHxGhPAJT7QJfWin6qgx7f96pCL4j9fFyRXet-sS7wKIu68SNJzkmhs=@proton.me>
 <CABghstTA+GpVwqGNUmNS944HMV4h3RBoAbTPDuWEV-JDV-Y5Xg@mail.gmail.com>
 <ii8rfznsuStLO9wRzKlDbJIkcdR9fvDUtlOf4548fLxZuINIEATTafeuS6ZY29bUZH_F2uDLatGk5rWzAfp0vB8nAoSWy-s8dIZPFgZfR6A=@proton.me>
 <57123dcb-8d51-4997-8b80-ebfbf6362b48@gmail.com>
 <N9bUhUZvgeH8PPIB3GIgPsGDemccWUenOPyfckOUmnpIcvF-r6F4oPwyW1eBWSijGMEMl6MM1cifnxYkpjmAtz4P3wjuYRGhuJuK9SwS9C8=@proton.me>
 <26660.47024.623391.863228@rob.eddelbuettel.com>
Message-ID: <l1UonlC4-5bmCbsrS8HbCYzKsLBHqSCUtXMBgAiGNxHAS4owB31kaI4i8xTyoLvOmAUgH5_rMRkDcZn04NzeYOTkgMdPP9NCGsMWL7dX7d0=@proton.me>






On Wednesday, May 14th, 2025 at 10:33 AM, Dirk Eddelbuettel <edd at debian.org> wrote:

> 
> 
> Section 'A.3.1.3 Intel MKL' of the R Installation and Administration manual
> covers that for the MKL case (and general OpenMP cases)
> 
> The default number of threads will be chosen by the OpenMP software, but
> can be controlled by setting ?OMP_NUM_THREADS? or ?MKL_NUM_THREADS?, and
> in recent versions seems to default to a sensible value for sole use of
> the machine.

Are these options to be set using Sys.setenv()? I tried that on a Linux machine, and it did not prevent the problem. I am not sure that is actually how these settings are controlled, though. Specifically,

Sys.setenv(MKL_NUM_THREADS = 1)
n <- 50
set.seed(20250504)
Sigma <- rWishart(1, df = n, Sigma = diag(n))[,,1]
e1 <- eigen(Sigma)
e2 <- eigen(Sigma)
identical(e1, e2)

results in FALSE. I am not sure whether the age of the hardware is relevant, but it is about 14 years old. If anyone tests this and generally gets TRUE, what happens when n is increased?

> 
> The entire section makes for good reading, it mixes 'how to install MKL' with
> 'how to use MKL' and touches upon the parellism issue you have here.
> 

A minor point, which might be relevant: the discussion I see in A.3 is about results differing across implementations, not within a given implementation.

> Dirk
> 
> --
> dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From edd @end|ng |rom deb|@n@org  Wed May 14 18:46:34 2025
From: edd @end|ng |rom deb|@n@org (Dirk Eddelbuettel)
Date: Wed, 14 May 2025 11:46:34 -0500
Subject: [R-pkg-devel] Advice for addressing CRAN rejection
In-Reply-To: <l1UonlC4-5bmCbsrS8HbCYzKsLBHqSCUtXMBgAiGNxHAS4owB31kaI4i8xTyoLvOmAUgH5_rMRkDcZn04NzeYOTkgMdPP9NCGsMWL7dX7d0=@proton.me>
References: <6Xgzv9HbaJrtioSMI2xyarWrdceEVdLuT4cdONaU5d5iofwNzI-9lHxGhPAJT7QJfWin6qgx7f96pCL4j9fFyRXet-sS7wKIu68SNJzkmhs=@proton.me>
 <CABghstTA+GpVwqGNUmNS944HMV4h3RBoAbTPDuWEV-JDV-Y5Xg@mail.gmail.com>
 <ii8rfznsuStLO9wRzKlDbJIkcdR9fvDUtlOf4548fLxZuINIEATTafeuS6ZY29bUZH_F2uDLatGk5rWzAfp0vB8nAoSWy-s8dIZPFgZfR6A=@proton.me>
 <57123dcb-8d51-4997-8b80-ebfbf6362b48@gmail.com>
 <N9bUhUZvgeH8PPIB3GIgPsGDemccWUenOPyfckOUmnpIcvF-r6F4oPwyW1eBWSijGMEMl6MM1cifnxYkpjmAtz4P3wjuYRGhuJuK9SwS9C8=@proton.me>
 <26660.47024.623391.863228@rob.eddelbuettel.com>
 <l1UonlC4-5bmCbsrS8HbCYzKsLBHqSCUtXMBgAiGNxHAS4owB31kaI4i8xTyoLvOmAUgH5_rMRkDcZn04NzeYOTkgMdPP9NCGsMWL7dX7d0=@proton.me>
Message-ID: <26660.51434.568786.952262@rob.eddelbuettel.com>


[ If you could, please set your email software up such that posts to a
  mailing lists are not signed, it makes reading them more cumbersome. It
  also means I can't reply (easily) inline now. ]

In most cases environment variables need to be set before the process
starts. Setting them inside the running R process likely has no effect.

Dirk

-- 
dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From bbo|ker @end|ng |rom gm@||@com  Wed May 14 19:59:07 2025
From: bbo|ker @end|ng |rom gm@||@com (Ben Bolker)
Date: Wed, 14 May 2025 13:59:07 -0400
Subject: [R-pkg-devel] Advice for addressing CRAN rejection
In-Reply-To: <26660.51434.568786.952262@rob.eddelbuettel.com>
References: <6Xgzv9HbaJrtioSMI2xyarWrdceEVdLuT4cdONaU5d5iofwNzI-9lHxGhPAJT7QJfWin6qgx7f96pCL4j9fFyRXet-sS7wKIu68SNJzkmhs=@proton.me>
 <CABghstTA+GpVwqGNUmNS944HMV4h3RBoAbTPDuWEV-JDV-Y5Xg@mail.gmail.com>
 <ii8rfznsuStLO9wRzKlDbJIkcdR9fvDUtlOf4548fLxZuINIEATTafeuS6ZY29bUZH_F2uDLatGk5rWzAfp0vB8nAoSWy-s8dIZPFgZfR6A=@proton.me>
 <57123dcb-8d51-4997-8b80-ebfbf6362b48@gmail.com>
 <N9bUhUZvgeH8PPIB3GIgPsGDemccWUenOPyfckOUmnpIcvF-r6F4oPwyW1eBWSijGMEMl6MM1cifnxYkpjmAtz4P3wjuYRGhuJuK9SwS9C8=@proton.me>
 <26660.47024.623391.863228@rob.eddelbuettel.com>
 <l1UonlC4-5bmCbsrS8HbCYzKsLBHqSCUtXMBgAiGNxHAS4owB31kaI4i8xTyoLvOmAUgH5_rMRkDcZn04NzeYOTkgMdPP9NCGsMWL7dX7d0=@proton.me>
 <26660.51434.568786.952262@rob.eddelbuettel.com>
Message-ID: <CABghstQ0F3nbWOVPrYzsHfQ0MF8O7TH5OYaY+1CNSnx7UCWsOg@mail.gmail.com>

On Wed, May 14, 2025 at 12:46?PM Dirk Eddelbuettel <edd at debian.org> wrote:
>
>
> [ If you could, please set your email software up such that posts to a
>   mailing lists are not signed, it makes reading them more cumbersome. It
>   also means I can't reply (easily) inline now. ]
>
> In most cases environment variables need to be set before the process
> starts. Setting them inside the running R process likely has no effect.

  That's what I thought, although it means then (I assume) that you
have to rely on whatever settings CRAN has determined for its testing
platforms.  The RhpcBLASctl package
<https://CRAN.R-project.org/package=RhpcBLASctl> can do some of these
settings within a running R process, I don't know if it does what you
need or not.


>
> Dirk
>
> --
> dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From |kry|ov @end|ng |rom d|@root@org  Wed May 14 21:51:35 2025
From: |kry|ov @end|ng |rom d|@root@org (Ivan Krylov)
Date: Wed, 14 May 2025 22:51:35 +0300
Subject: [R-pkg-devel] Advice for addressing CRAN rejection
In-Reply-To: <6Xgzv9HbaJrtioSMI2xyarWrdceEVdLuT4cdONaU5d5iofwNzI-9lHxGhPAJT7QJfWin6qgx7f96pCL4j9fFyRXet-sS7wKIu68SNJzkmhs=@proton.me>
References: <6Xgzv9HbaJrtioSMI2xyarWrdceEVdLuT4cdONaU5d5iofwNzI-9lHxGhPAJT7QJfWin6qgx7f96pCL4j9fFyRXet-sS7wKIu68SNJzkmhs=@proton.me>
Message-ID: <20250514225135.0ca39dca@Tarkus>

? Tue, 13 May 2025 17:05:14 +0000
smallepsilon <smallepsilon at proton.me> ?????:

> In many package tests, I want to verify that two ways of specifying
> something lead to the execution of exactly the same calculations.

Would you like to try tracing the linear algebra calculations
themselves (together with their arguments) instead of trying to trace
their results? I think it should be possible using the 'mockery'
package or even by hand (after a lot of effort) using base::trace().

> My submission was rejected, not because of test failures, but because
> I had "removed the failing tests which is not the idea of tests." No
> errors/warnings/notes were reported to me.

Try measuring the test coverage of your package before and after
removing the extraneous tests (the 'covr' package should the job).
Perhaps you may see a cheap way to increase the coverage. Offer the
increased coverage as an additional argument when resubmitting. After
all, tests are code and thus may also contain bugs, and sometimes it's
the right choice to remove the buggy code.

-- 
Best regards,
Ivan


From @m@||ep@||on @end|ng |rom proton@me  Wed May 14 22:33:04 2025
From: @m@||ep@||on @end|ng |rom proton@me (smallepsilon)
Date: Wed, 14 May 2025 20:33:04 +0000
Subject: [R-pkg-devel] Advice for addressing CRAN rejection
In-Reply-To: <7a0b0d01-a6f9-4b81-9299-eb50ee2de5c2@app.fastmail.com>
References: <6Xgzv9HbaJrtioSMI2xyarWrdceEVdLuT4cdONaU5d5iofwNzI-9lHxGhPAJT7QJfWin6qgx7f96pCL4j9fFyRXet-sS7wKIu68SNJzkmhs=@proton.me>
 <CABghstTA+GpVwqGNUmNS944HMV4h3RBoAbTPDuWEV-JDV-Y5Xg@mail.gmail.com>
 <ii8rfznsuStLO9wRzKlDbJIkcdR9fvDUtlOf4548fLxZuINIEATTafeuS6ZY29bUZH_F2uDLatGk5rWzAfp0vB8nAoSWy-s8dIZPFgZfR6A=@proton.me>
 <57123dcb-8d51-4997-8b80-ebfbf6362b48@gmail.com>
 <N9bUhUZvgeH8PPIB3GIgPsGDemccWUenOPyfckOUmnpIcvF-r6F4oPwyW1eBWSijGMEMl6MM1cifnxYkpjmAtz4P3wjuYRGhuJuK9SwS9C8=@proton.me>
 <7a0b0d01-a6f9-4b81-9299-eb50ee2de5c2@app.fastmail.com>
Message-ID: <y62BVkJ0AAG7xb4XD83nKllMIZU4E6dwGdLKM4hFqy96_4_Bg60c7Q6NQyXz4EUch6dZGkuWJQTBsli4vFPgW_YEQwhZNf1Liy7SF1QQr4g=@proton.me>

On Wednesday, May 14th, 2025 at 10:51 AM, Tim Taylor <tim.taylor at hiddenelephants.co.uk> wrote:

> I'd just use all.equal but I think you could just check the call is constructed correctly, e.g.
> 
> convenient_modify_matrix <- function(mat) modify_matrix(mat, other_args = default)
> 
> identical(
> body(convenient_modify_matrix),
> call("modify_matrix", quote(mat), other_args = quote(default))
> )

I wondered whether something such as that is possible, but unfortunately, in the actual package, the calls might be different. For example, a function might use an intermediate result saved in one object so the earlier calculations need not be repeated. The calculations in both cases should be exactly the same, though.


From @m@||ep@||on @end|ng |rom proton@me  Wed May 14 22:41:27 2025
From: @m@||ep@||on @end|ng |rom proton@me (smallepsilon)
Date: Wed, 14 May 2025 20:41:27 +0000
Subject: [R-pkg-devel] Advice for addressing CRAN rejection
In-Reply-To: <CABghstQ0F3nbWOVPrYzsHfQ0MF8O7TH5OYaY+1CNSnx7UCWsOg@mail.gmail.com>
References: <6Xgzv9HbaJrtioSMI2xyarWrdceEVdLuT4cdONaU5d5iofwNzI-9lHxGhPAJT7QJfWin6qgx7f96pCL4j9fFyRXet-sS7wKIu68SNJzkmhs=@proton.me>
 <CABghstTA+GpVwqGNUmNS944HMV4h3RBoAbTPDuWEV-JDV-Y5Xg@mail.gmail.com>
 <ii8rfznsuStLO9wRzKlDbJIkcdR9fvDUtlOf4548fLxZuINIEATTafeuS6ZY29bUZH_F2uDLatGk5rWzAfp0vB8nAoSWy-s8dIZPFgZfR6A=@proton.me>
 <57123dcb-8d51-4997-8b80-ebfbf6362b48@gmail.com>
 <N9bUhUZvgeH8PPIB3GIgPsGDemccWUenOPyfckOUmnpIcvF-r6F4oPwyW1eBWSijGMEMl6MM1cifnxYkpjmAtz4P3wjuYRGhuJuK9SwS9C8=@proton.me>
 <26660.47024.623391.863228@rob.eddelbuettel.com>
 <l1UonlC4-5bmCbsrS8HbCYzKsLBHqSCUtXMBgAiGNxHAS4owB31kaI4i8xTyoLvOmAUgH5_rMRkDcZn04NzeYOTkgMdPP9NCGsMWL7dX7d0=@proton.me>
 <26660.51434.568786.952262@rob.eddelbuettel.com>
 <CABghstQ0F3nbWOVPrYzsHfQ0MF8O7TH5OYaY+1CNSnx7UCWsOg@mail.gmail.com>
Message-ID: <35lv6M2CUx0NE9H1ysWKwDc3rkEY2Bl_r-Krgp1pUt3nq1138iH8eiKXt1h_CM16GC8CobJce16UQYynLwYUBPVDZlB8UgXk-YwYIWeZFm8=@proton.me>

On Wednesday, May 14th, 2025 at 12:59 PM, Ben Bolker <bbolker at gmail.com> wrote:

> 
> 
> On Wed, May 14, 2025 at 12:46?PM Dirk Eddelbuettel edd at debian.org wrote:
> 
> > [ If you could, please set your email software up such that posts to a
> > mailing lists are not signed, it makes reading them more cumbersome. It
> > also means I can't reply (easily) inline now. ]
> > 
> > In most cases environment variables need to be set before the process
> > starts. Setting them inside the running R process likely has no effect.
> 
> 
> That's what I thought, although it means then (I assume) that you
> have to rely on whatever settings CRAN has determined for its testing
> platforms. The RhpcBLASctl package
> https://CRAN.R-project.org/package=RhpcBLASctl can do some of these
> settings within a running R process, I don't know if it does what you
> need or not.

Thanks for the package reference. The description is promising, but using it still resulted in non-identical objects.

All of this leads me to think that the lack of control over the CRAN platforms and the difficulty (if not impossibility) of testing what I want to test mean that it is reasonable to remove my attempts to test it from the package that I upload to CRAN. Thoughts?


From @m@||ep@||on @end|ng |rom proton@me  Wed May 14 22:50:44 2025
From: @m@||ep@||on @end|ng |rom proton@me (smallepsilon)
Date: Wed, 14 May 2025 20:50:44 +0000
Subject: [R-pkg-devel] Advice for addressing CRAN rejection
In-Reply-To: <20250514225135.0ca39dca@Tarkus>
References: <6Xgzv9HbaJrtioSMI2xyarWrdceEVdLuT4cdONaU5d5iofwNzI-9lHxGhPAJT7QJfWin6qgx7f96pCL4j9fFyRXet-sS7wKIu68SNJzkmhs=@proton.me>
 <20250514225135.0ca39dca@Tarkus>
Message-ID: <OeV33ysw80bWS83M_XRYIZjXKuPeoeKm1xrsU2fRVim2UN0HSUyofSi0NuBeN_HIOX79S81QARtkq7wyAQMnA57wEa2HRwEViEH-utQM4-8=@proton.me>

On Wednesday, May 14th, 2025 at 2:51 PM, Ivan Krylov <ikrylov at disroot.org> wrote:

> > My submission was rejected, not because of test failures, but because
> > I had "removed the failing tests which is not the idea of tests." No
> > errors/warnings/notes were reported to me.
> 
> 
> Try measuring the test coverage of your package before and after
> removing the extraneous tests (the 'covr' package should the job).
> Perhaps you may see a cheap way to increase the coverage. Offer the
> increased coverage as an additional argument when resubmitting. After
> all, tests are code and thus may also contain bugs, and sometimes it's
> the right choice to remove the buggy code.
> 
> --
> Best regards,
> Ivan

Thanks - I have not used that package before now. It is currently running....


From jo@|@h@p@rry @end|ng |rom gm@||@com  Sun May 18 15:59:40 2025
From: jo@|@h@p@rry @end|ng |rom gm@||@com (Josiah Parry)
Date: Sun, 18 May 2025 06:59:40 -0700
Subject: [R-pkg-devel] Read CRAN package DESCRIPTION without downloading
 source
Message-ID: <CAL3ufUJknPPu-b-9mV370juUMc5+9gk5pV-PCgxx7WNLZd-P2A@mail.gmail.com>

Hey Folks,

Is there  a way to view the DESCRIPTION file for packages on CRAN _without_
downloading the source?

I'd like to identify packages with the field `Config/rextendr/version` in
order to be able to triage code changes in the future.

Thanks,

Josiah

	[[alternative HTML version deleted]]


From d|ego@hern@ngomezherrero @end|ng |rom gm@||@com  Sun May 18 16:07:11 2025
From: d|ego@hern@ngomezherrero @end|ng |rom gm@||@com (=?UTF-8?Q?Diego_Hernang=C3=B3mez_Herrero?=)
Date: Sun, 18 May 2025 16:07:11 +0200
Subject: [R-pkg-devel] Read CRAN package DESCRIPTION without downloading
 source
In-Reply-To: <CAL3ufUJknPPu-b-9mV370juUMc5+9gk5pV-PCgxx7WNLZd-P2A@mail.gmail.com>
References: <CAL3ufUJknPPu-b-9mV370juUMc5+9gk5pV-PCgxx7WNLZd-P2A@mail.gmail.com>
Message-ID: <CAA-ibaxTRYRcUswPj6KZ6NR6hr1Q56TWRgizg2hBOQz-LN=yWQ@mail.gmail.com>

Hi:

I often search in https://github.com/cran , each repo is a package on
CRAN. Combined with GitHub Code Search you can identify packages with
common DESCRIPTION features.

Try this link: https://github.com/search?q=org%3Acran%20path%3ADESCRIPTION%20Config%2Frextendr%2Fversion&type=code





Have a nice day!


El dom, 18 may 2025 a las 16:00, Josiah Parry
(<josiah.parry at gmail.com>) escribi?:
>
> Hey Folks,
>
> Is there  a way to view the DESCRIPTION file for packages on CRAN _without_
> downloading the source?
>
> I'd like to identify packages with the field `Config/rextendr/version` in
> order to be able to triage code changes in the future.
>
> Thanks,
>
> Josiah
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel



-- 



Have a nice day!


From chr|@topherkenny @end|ng |rom |@@@h@rv@rd@edu  Sun May 18 16:07:58 2025
From: chr|@topherkenny @end|ng |rom |@@@h@rv@rd@edu (Kenny, Christopher)
Date: Sun, 18 May 2025 14:07:58 +0000
Subject: [R-pkg-devel] Read CRAN package DESCRIPTION without downloading
 source
In-Reply-To: <CAL3ufUJknPPu-b-9mV370juUMc5+9gk5pV-PCgxx7WNLZd-P2A@mail.gmail.com>
References: <CAL3ufUJknPPu-b-9mV370juUMc5+9gk5pV-PCgxx7WNLZd-P2A@mail.gmail.com>
Message-ID: <BL0PR07MB54919C39CE006676A9554F59809DA@BL0PR07MB5491.namprd07.prod.outlook.com>

I think this is a good case for using the unofficial GitHub CRAN mirror. Then you can just use the search like so:

https://github.com/search?q=org%3Acran%20%22Config%2Frextendr%2Fversion%22%20&type=code

Best,
Chris

________________________________
From: R-package-devel <r-package-devel-bounces at r-project.org> on behalf of Josiah Parry <josiah.parry at gmail.com>
Sent: Sunday, May 18, 2025 9:59 AM
To: R Package Development <r-package-devel at r-project.org>
Subject: [R-pkg-devel] Read CRAN package DESCRIPTION without downloading source

Hey Folks,

Is there  a way to view the DESCRIPTION file for packages on CRAN _without_
downloading the source?

I'd like to identify packages with the field `Config/rextendr/version` in
order to be able to triage code changes in the future.

Thanks,

Josiah

        [[alternative HTML version deleted]]

______________________________________________
R-package-devel at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-package-devel

	[[alternative HTML version deleted]]


From jo@|@h@p@rry @end|ng |rom gm@||@com  Sun May 18 16:16:14 2025
From: jo@|@h@p@rry @end|ng |rom gm@||@com (Josiah Parry)
Date: Sun, 18 May 2025 07:16:14 -0700
Subject: [R-pkg-devel] Read CRAN package DESCRIPTION without downloading
 source
In-Reply-To: <BL0PR07MB54919C39CE006676A9554F59809DA@BL0PR07MB5491.namprd07.prod.outlook.com>
References: <CAL3ufUJknPPu-b-9mV370juUMc5+9gk5pV-PCgxx7WNLZd-P2A@mail.gmail.com>
 <BL0PR07MB54919C39CE006676A9554F59809DA@BL0PR07MB5491.namprd07.prod.outlook.com>
Message-ID: <CAL3ufU+0K1cA0NktWHcy34mtO+iQpP1rt1hUhsLYE11aJH4kDA@mail.gmail.com>

Ah, perfect! Thanks :)

On Sun, May 18, 2025 at 07:10 Kenny, Christopher <
christopherkenny at fas.harvard.edu> wrote:

> I think this is a good case for using the unofficial GitHub CRAN mirror.
> Then you can just use the search like so:
>
>
> https://github.com/search?q=org%3Acran%20%22Config%2Frextendr%2Fversion%22%20&type=code
>
> Best,
> Chris
>
> ________________________________
> From: R-package-devel <r-package-devel-bounces at r-project.org> on behalf
> of Josiah Parry <josiah.parry at gmail.com>
> Sent: Sunday, May 18, 2025 9:59 AM
> To: R Package Development <r-package-devel at r-project.org>
> Subject: [R-pkg-devel] Read CRAN package DESCRIPTION without downloading
> source
>
> Hey Folks,
>
> Is there  a way to view the DESCRIPTION file for packages on CRAN _without_
> downloading the source?
>
> I'd like to identify packages with the field `Config/rextendr/version` in
> order to be able to triage code changes in the future.
>
> Thanks,
>
> Josiah
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From henr|k@bengt@@on @end|ng |rom gm@||@com  Sun May 18 16:34:51 2025
From: henr|k@bengt@@on @end|ng |rom gm@||@com (Henrik Bengtsson)
Date: Sun, 18 May 2025 07:34:51 -0700
Subject: [R-pkg-devel] Read CRAN package DESCRIPTION without downloading
 source
In-Reply-To: <BL0PR07MB54919C39CE006676A9554F59809DA@BL0PR07MB5491.namprd07.prod.outlook.com>
References: <CAL3ufUJknPPu-b-9mV370juUMc5+9gk5pV-PCgxx7WNLZd-P2A@mail.gmail.com>
 <BL0PR07MB54919C39CE006676A9554F59809DA@BL0PR07MB5491.namprd07.prod.outlook.com>
Message-ID: <CAFDcVCTS3m8Bmb8-yrFNhW54npZDvfj0sBSuiMzwyUVy4u4brQ@mail.gmail.com>

All DESCRIPTION files are available as:

https://cran.r-project.org/web/packages/{pkg}/DESCRIPTION

For example, https://cran.r-project.org/web/packages/cli/DESCRIPTION.

So, you could manually iterate over all CRAN packages and download these
files one by one. An alternative is to rsync just the DESCRIPTION files,
cf. https://cran.r-project.org/mirror-howto.html.

FWIW, NAMESPACE files are available in the same way.

Henrik

On Sun, May 18, 2025, 07:10 Kenny, Christopher <
christopherkenny at fas.harvard.edu> wrote:

> I think this is a good case for using the unofficial GitHub CRAN mirror.
> Then you can just use the search like so:
>
>
> https://github.com/search?q=org%3Acran%20%22Config%2Frextendr%2Fversion%22%20&type=code
>
> Best,
> Chris
>
> ________________________________
> From: R-package-devel <r-package-devel-bounces at r-project.org> on behalf
> of Josiah Parry <josiah.parry at gmail.com>
> Sent: Sunday, May 18, 2025 9:59 AM
> To: R Package Development <r-package-devel at r-project.org>
> Subject: [R-pkg-devel] Read CRAN package DESCRIPTION without downloading
> source
>
> Hey Folks,
>
> Is there  a way to view the DESCRIPTION file for packages on CRAN _without_
> downloading the source?
>
> I'd like to identify packages with the field `Config/rextendr/version` in
> order to be able to triage code changes in the future.
>
> Thanks,
>
> Josiah
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From edd @end|ng |rom deb|@n@org  Sun May 18 16:59:23 2025
From: edd @end|ng |rom deb|@n@org (Dirk Eddelbuettel)
Date: Sun, 18 May 2025 09:59:23 -0500
Subject: [R-pkg-devel] Read CRAN package DESCRIPTION without downloading
 source
In-Reply-To: <CAFDcVCTS3m8Bmb8-yrFNhW54npZDvfj0sBSuiMzwyUVy4u4brQ@mail.gmail.com>
References: <CAL3ufUJknPPu-b-9mV370juUMc5+9gk5pV-PCgxx7WNLZd-P2A@mail.gmail.com>
 <BL0PR07MB54919C39CE006676A9554F59809DA@BL0PR07MB5491.namprd07.prod.outlook.com>
 <CAFDcVCTS3m8Bmb8-yrFNhW54npZDvfj0sBSuiMzwyUVy4u4brQ@mail.gmail.com>
Message-ID: <26665.62923.457577.560261@rob.eddelbuettel.com>


Also, and while it won't help for the non-standard field in question here,
the standard fields are all compiled into what tools::CRAN_package_db()
returns. Very handy for many use cases, and possibly not as well known as it
should be.

Dirk

-- 
dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From m|ch@e|ch|r|co4 @end|ng |rom gm@||@com  Sun May 18 18:23:29 2025
From: m|ch@e|ch|r|co4 @end|ng |rom gm@||@com (Michael Chirico)
Date: Sun, 18 May 2025 09:23:29 -0700
Subject: [R-pkg-devel] Read CRAN package DESCRIPTION without downloading
 source
In-Reply-To: <26665.62923.457577.560261@rob.eddelbuettel.com>
References: <CAL3ufUJknPPu-b-9mV370juUMc5+9gk5pV-PCgxx7WNLZd-P2A@mail.gmail.com>
 <BL0PR07MB54919C39CE006676A9554F59809DA@BL0PR07MB5491.namprd07.prod.outlook.com>
 <CAFDcVCTS3m8Bmb8-yrFNhW54npZDvfj0sBSuiMzwyUVy4u4brQ@mail.gmail.com>
 <26665.62923.457577.560261@rob.eddelbuettel.com>
Message-ID: <CAPRVBcyg3vOqHaX5kZ12tVpr3VJCZWbuck5hZ6gRR1NwO6UXsg@mail.gmail.com>

one thing to keep in mind for the GitHub mirror is that archived packages
are not marked any differently, e.g.

https://github.com/cran/rgeos

I typically use Henrik's URLs but you need to set up some retry logic. The
rsync approach sounds nice, think I'll try that next time :)

On Sun, May 18, 2025, 7:59?AM Dirk Eddelbuettel <edd at debian.org> wrote:

>
> Also, and while it won't help for the non-standard field in question here,
> the standard fields are all compiled into what tools::CRAN_package_db()
> returns. Very handy for many use cases, and possibly not as well known as
> it
> should be.
>
> Dirk
>
> --
> dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From edd @end|ng |rom deb|@n@org  Sun May 18 19:28:05 2025
From: edd @end|ng |rom deb|@n@org (Dirk Eddelbuettel)
Date: Sun, 18 May 2025 12:28:05 -0500
Subject: [R-pkg-devel] Read CRAN package DESCRIPTION without downloading
 source
In-Reply-To: <CAPRVBcyg3vOqHaX5kZ12tVpr3VJCZWbuck5hZ6gRR1NwO6UXsg@mail.gmail.com>
References: <CAL3ufUJknPPu-b-9mV370juUMc5+9gk5pV-PCgxx7WNLZd-P2A@mail.gmail.com>
 <BL0PR07MB54919C39CE006676A9554F59809DA@BL0PR07MB5491.namprd07.prod.outlook.com>
 <CAFDcVCTS3m8Bmb8-yrFNhW54npZDvfj0sBSuiMzwyUVy4u4brQ@mail.gmail.com>
 <26665.62923.457577.560261@rob.eddelbuettel.com>
 <CAPRVBcyg3vOqHaX5kZ12tVpr3VJCZWbuck5hZ6gRR1NwO6UXsg@mail.gmail.com>
Message-ID: <26666.6309.132840.243320@rob.eddelbuettel.com>


On 18 May 2025 at 09:23, Michael Chirico wrote:
| one thing to keep in mind for the GitHub mirror is that archived packages are
| not marked any differently, e.g.
| 
| https://github.com/cran/rgeos
| 
| I typically use Henrik's URLs but you need to set up some retry logic. The
| rsync approach sounds nice, think I'll try that next time :)

But you can 'inner join' with the package names from available.packages() or
the package name column from tools::CRAN_package_db().  And then again, for
the Rust packages he tries to help, maybe Josi even _wants to_ see these.

Dirk
 
| 
| On Sun, May 18, 2025, 7:59?AM Dirk Eddelbuettel <edd at debian.org> wrote:
| 
| 
|     Also, and while it won't help for the non-standard field in question here,
|     the standard fields are all compiled into what tools::CRAN_package_db()
|     returns. Very handy for many use cases, and possibly not as well known as
|     it
|     should be.
| 
|     Dirk
| 
|     --
|     dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org
| 
|     ______________________________________________
|     R-package-devel at r-project.org mailing list
|     https://stat.ethz.ch/mailman/listinfo/r-package-devel
| 

-- 
dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From g@ryzhubc @end|ng |rom gm@||@com  Wed May 21 04:39:47 2025
From: g@ryzhubc @end|ng |rom gm@||@com (Peiyuan Zhu)
Date: Tue, 20 May 2025 19:39:47 -0700
Subject: [R-pkg-devel] How to use O4 flag in an RCpp project?
Message-ID: <CALMBL3V+6GZ6HqJ7NUN3Hru=PKwpkDa-_xyJL0Ef1b0wGdpLvA@mail.gmail.com>

How to use the O4 flag in an RCpp project? Every time when I load_all it
starts using the O2 flag or the debug flag. What should I put into Makevar?
Can I still do remote::install.github(...)?

	[[alternative HTML version deleted]]


From @@drew m@iii@g oii robbi@s@@me  Wed May 21 14:48:16 2025
From: @@drew m@iii@g oii robbi@s@@me (@@drew m@iii@g oii robbi@s@@me)
Date: Wed, 21 May 2025 12:48:16 +0000
Subject: [R-pkg-devel] gcc-asan replication for armadillo
Message-ID: <BL0PR1701MB2612B9F595D1DB421FFEA518FA9EA@BL0PR1701MB2612.namprd17.prod.outlook.com>

Hi all,

I'm currently having difficulty replicating an ODR violation that is being raised by the gcc-asan check here: https://www.stats.ox.ac.uk/pub/bdr/memtests/gcc-ASAN/RcppPlanc/00install.out. Perhaps weirder, it seems to be triggered by an inclusion of armadillo_bits/constants.hpp in both my shared object and the Rcpp binding library-which seems like something that shouldn't be raising any issues.

Dirk, you wouldn't happen to have seen this before?

-Andrew Robbins

From edd @end|ng |rom deb|@n@org  Wed May 21 14:50:44 2025
From: edd @end|ng |rom deb|@n@org (Dirk Eddelbuettel)
Date: Wed, 21 May 2025 07:50:44 -0500
Subject: [R-pkg-devel] How to use O4 flag in an RCpp project?
In-Reply-To: <CALMBL3V+6GZ6HqJ7NUN3Hru=PKwpkDa-_xyJL0Ef1b0wGdpLvA@mail.gmail.com>
References: <CALMBL3V+6GZ6HqJ7NUN3Hru=PKwpkDa-_xyJL0Ef1b0wGdpLvA@mail.gmail.com>
Message-ID: <26669.52260.569090.49962@rob.eddelbuettel.com>


On 20 May 2025 at 19:39, Peiyuan Zhu wrote:
| How to use the O4 flag in an RCpp project? Every time when I load_all it
| starts using the O2 flag or the debug flag. What should I put into Makevar?
| Can I still do remote::install.github(...)?

Given that this mailing list can need explicit approval on eg initial posts,
your post here precedes these two follow-ups you posted since. So by now this
same question by you has also been asked

 - on Stackoverflow about twelve hours ago; you were told that it is not a
   genuinely well-formed question (and StackOverflow can be funny that way, I
   stop interacting there for that reason). The URL is at
   https://stackoverflow.com/questions/79631329/how-to-use-o4-flag-in-rcpp-project

 - on GitHub at the Rcpp repo also about twelve hours ago, and Kevin gave
   you fairly extensive feedback saying that it isn't really a Rcpp question,
   and also closed it,  see https://github.com/RcppCore/Rcpp/issues/1383
   I also gave you some feedback there six hours ago, in essence the issue is
   one that has nothing to do with Rcpp and is about how R calls make to
   generate the compilation, see
   https://github.com/RcppCore/Rcpp/issues/1383#issuecomment-2896674848 

The underlying issue ("how do I override compiler switches") has been
discussed elsewhere too, likely here and earlier on the (older) list r-devel.
In short, "no we cannot remove -O2" and "no it does not matter" because (if I
recall correctly) the right-most value wins. The documentation of `make`
probably has more. Otherwise you probably want to consult the "Writing R
Extensions" manual. 

Hope this helps.

Dirk

-- 
dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From @ergue|@@oko| @end|ng |rom gm@||@com  Wed May 21 15:21:58 2025
From: @ergue|@@oko| @end|ng |rom gm@||@com (Serguei Sokol)
Date: Wed, 21 May 2025 15:21:58 +0200
Subject: [R-pkg-devel] gcc-asan replication for armadillo
In-Reply-To: <BL0PR1701MB2612B9F595D1DB421FFEA518FA9EA@BL0PR1701MB2612.namprd17.prod.outlook.com>
References: <BL0PR1701MB2612B9F595D1DB421FFEA518FA9EA@BL0PR1701MB2612.namprd17.prod.outlook.com>
Message-ID: <85f4948c-4cd0-4c57-8360-3cbfe4a5856b@gmail.com>

Le 21/05/2025 ? 14:48, andrew--- via R-package-devel a ?crit?:
> Hi all,
> 
> I'm currently having difficulty replicating an ODR violation that is being raised by the gcc-asan check here: https://www.stats.ox.ac.uk/pub/bdr/memtests/gcc-ASAN/RcppPlanc/00install.out. Perhaps weirder, it seems to be triggered by an inclusion of armadillo_bits/constants.hpp in both my shared object and the Rcpp binding library-which seems like something that shouldn't be raising any issues.

Seemingly, yes. ODR stands for _One_ Definition Rule so if you define 
the same thing in two different libs then raising issue sounds legitimate.
I suppose one possible solution could be incorporating the content of 
libnmflib.so (and all other libs your build) directly in RcppPlanc.so 
and cleaning them afterward.

Hoping it helps,
Serguei.

> 
> Dirk, you wouldn't happen to have seen this before?
> 
> -Andrew Robbins
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From @@drew m@iii@g oii robbi@s@@me  Wed May 21 15:45:23 2025
From: @@drew m@iii@g oii robbi@s@@me (@@drew m@iii@g oii robbi@s@@me)
Date: Wed, 21 May 2025 13:45:23 +0000
Subject: [R-pkg-devel] gcc-asan replication for armadillo
In-Reply-To: <85f4948c-4cd0-4c57-8360-3cbfe4a5856b@gmail.com>
References: <BL0PR1701MB2612B9F595D1DB421FFEA518FA9EA@BL0PR1701MB2612.namprd17.prod.outlook.com>
 <85f4948c-4cd0-4c57-8360-3cbfe4a5856b@gmail.com>
Message-ID: <BL0PR1701MB261284F4FBF7EE936665FDC8FA9EA@BL0PR1701MB2612.namprd17.prod.outlook.com>

If this were the case I don't think that I'd be having problems replicating it.





________________________________________
From:?Serguei Sokol <serguei.sokol at gmail.com>
Sent:?Wednesday, May 21, 2025 9:21 AM
To:?andrew at robbinsa.me <andrew at robbinsa.me>; R Package Development <r-package-devel at r-project.org>
Subject:?Re: [R-pkg-devel] gcc-asan replication for armadillo


Le 21/05/2025 ? 14:48, andrew--- via R-package-devel a ?crit?:

> Hi all,

>

> I'm currently having difficulty replicating an ODR violation that is being raised by the gcc-asan check here: https://www.stats.ox.ac.uk/pub/bdr/memtests/gcc-ASAN/RcppPlanc/00install.out. Perhaps weirder, it seems to be triggered by an inclusion of armadillo_bits/constants.hpp in both my shared object and the Rcpp binding library-which seems like something that shouldn't be raising any issues.



Seemingly, yes. ODR stands for _One_ Definition Rule so if you define

the same thing in two different libs then raising issue sounds legitimate.

I suppose one possible solution could be incorporating the content of

libnmflib.so (and all other libs your build) directly in RcppPlanc.so

and cleaning them afterward.



Hoping it helps,

Serguei.



>

> Dirk, you wouldn't happen to have seen this before?

>

> -Andrew Robbins

> ______________________________________________

> R-package-devel at r-project.org mailing list

> https://stat.ethz.ch/mailman/listinfo/r-package-devel





From edd @end|ng |rom deb|@n@org  Wed May 21 15:47:15 2025
From: edd @end|ng |rom deb|@n@org (Dirk Eddelbuettel)
Date: Wed, 21 May 2025 08:47:15 -0500
Subject: [R-pkg-devel] gcc-asan replication for armadillo
In-Reply-To: <BL0PR1701MB2612B9F595D1DB421FFEA518FA9EA@BL0PR1701MB2612.namprd17.prod.outlook.com>
References: <BL0PR1701MB2612B9F595D1DB421FFEA518FA9EA@BL0PR1701MB2612.namprd17.prod.outlook.com>
Message-ID: <26669.55651.132119.52935@rob.eddelbuettel.com>


Andrew,

On 21 May 2025 at 12:48, andrew--- via R-package-devel wrote:
| I'm currently having difficulty replicating an ODR violation that is being raised by the gcc-asan check here: https://www.stats.ox.ac.uk/pub/bdr/memtests/gcc-ASAN/RcppPlanc/00install.out. Perhaps weirder, it seems to be triggered by an inclusion of armadillo_bits/constants.hpp in both my shared object and the Rcpp binding library-which seems like something that shouldn't be raising any issues.
| 
| Dirk, you wouldn't happen to have seen this before?

Sorry, have not. Could you possibly distill this out so that RcppPlanc is not
used, and possibly also avoid cmake.  A minimally complete verifiable example
would be great as the log you point at is a little long.

Cheers, Dirk

-- 
dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From g@ryzhubc @end|ng |rom gm@||@com  Wed May 21 18:34:06 2025
From: g@ryzhubc @end|ng |rom gm@||@com (Peiyuan Zhu)
Date: Wed, 21 May 2025 09:34:06 -0700
Subject: [R-pkg-devel] How to use O4 flag in an RCpp project?
In-Reply-To: <26669.52260.569090.49962@rob.eddelbuettel.com>
References: <CALMBL3V+6GZ6HqJ7NUN3Hru=PKwpkDa-_xyJL0Ef1b0wGdpLvA@mail.gmail.com>
 <26669.52260.569090.49962@rob.eddelbuettel.com>
Message-ID: <CALMBL3XWMwE_4XUWahC3R_YyqiAbG42385h4f2xTCKJG3Y1fSg@mail.gmail.com>

Hi Dirk,

I'm happy to just use O3 but it sounds like this isn't something doable in
C++.

Maybe I should just give up RCpp and move the program entirely to C++ from
now on.

Best regards,
Gary


On Wed, May 21, 2025 at 5:50?AM Dirk Eddelbuettel <edd at debian.org> wrote:

>
> On 20 May 2025 at 19:39, Peiyuan Zhu wrote:
> | How to use the O4 flag in an RCpp project? Every time when I load_all it
> | starts using the O2 flag or the debug flag. What should I put into
> Makevar?
> | Can I still do remote::install.github(...)?
>
> Given that this mailing list can need explicit approval on eg initial
> posts,
> your post here precedes these two follow-ups you posted since. So by now
> this
> same question by you has also been asked
>
>  - on Stackoverflow about twelve hours ago; you were told that it is not a
>    genuinely well-formed question (and StackOverflow can be funny that
> way, I
>    stop interacting there for that reason). The URL is at
>
> https://stackoverflow.com/questions/79631329/how-to-use-o4-flag-in-rcpp-project
>
>  - on GitHub at the Rcpp repo also about twelve hours ago, and Kevin gave
>    you fairly extensive feedback saying that it isn't really a Rcpp
> question,
>    and also closed it,  see https://github.com/RcppCore/Rcpp/issues/1383
>    I also gave you some feedback there six hours ago, in essence the issue
> is
>    one that has nothing to do with Rcpp and is about how R calls make to
>    generate the compilation, see
>    https://github.com/RcppCore/Rcpp/issues/1383#issuecomment-2896674848
>
> The underlying issue ("how do I override compiler switches") has been
> discussed elsewhere too, likely here and earlier on the (older) list
> r-devel.
> In short, "no we cannot remove -O2" and "no it does not matter" because
> (if I
> recall correctly) the right-most value wins. The documentation of `make`
> probably has more. Otherwise you probably want to consult the "Writing R
> Extensions" manual.
>
> Hope this helps.
>
> Dirk
>
> --
> dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org
>

	[[alternative HTML version deleted]]


From kev|nu@hey @end|ng |rom gm@||@com  Wed May 21 21:18:15 2025
From: kev|nu@hey @end|ng |rom gm@||@com (Kevin Ushey)
Date: Wed, 21 May 2025 12:18:15 -0700
Subject: [R-pkg-devel] gcc-asan replication for armadillo
In-Reply-To: <26669.55651.132119.52935@rob.eddelbuettel.com>
References: <BL0PR1701MB2612B9F595D1DB421FFEA518FA9EA@BL0PR1701MB2612.namprd17.prod.outlook.com>
 <26669.55651.132119.52935@rob.eddelbuettel.com>
Message-ID: <CAJXgQP3+3OSnxJtNJ82=AU+GozLriuuP6NvfZn7tmYyaotLiMA@mail.gmail.com>

Hi Andrew,

The relevant code defining the constant is here:

https://github.com/RcppCore/RcppArmadillo/blob/66dcdb5e878b391cd44a8c2854898abd002272ed/inst/include/armadillo_bits/constants.hpp#L176

If I understand correctly, that is effectively defining static
(global) values for a template class, so if that template class were
instantiated in two different libraries, then you might see this
issue. Indeed, if you inspect the shared objects built in your
package:

$ nm RcppPlanc.so | grep nan | c++filt
0000000000070a18 u guard variable for arma::Datum<double>::nan
0000000000070a20 u arma::Datum<double>::nan

$ nm libnmflib.so | grep nan | c++filt
0000000000160f40 u guard variable for arma::Datum<double>::nan
0000000000160f10 u guard variable for arma::Datum<int>::nan
0000000000160f20 u guard variable for arma::Datum<unsigned int>::nan
0000000000160f38 u guard variable for arma::Datum<unsigned long long>::nan
0000000000160f68 u arma::Datum<double>::nan
0000000000160f48 u arma::Datum<int>::nan
0000000000160f50 u arma::Datum<unsigned int>::nan
0000000000160f60 u arma::Datum<unsigned long long>::nan

you can see the two definitions for these objects. This also explains
why combining everything into a single library would be a solution, as
suggested by Serguei -- you'd then only have one instance of those
symbols.

For what it's worth, C++17 provides support for "static inline"
constants as a way to avoid these issues. This is discussed a bit in
https://en.cppreference.com/w/cpp/language/inline. If Armadillo (and
hence RcppArmadillo) were updated to take advantage of these features
when available, that might also alleviate the issue you're seeing.

Best,
Kevin

On Wed, May 21, 2025 at 6:55?AM Dirk Eddelbuettel <edd at debian.org> wrote:
>
>
> Andrew,
>
> On 21 May 2025 at 12:48, andrew--- via R-package-devel wrote:
> | I'm currently having difficulty replicating an ODR violation that is being raised by the gcc-asan check here: https://www.stats.ox.ac.uk/pub/bdr/memtests/gcc-ASAN/RcppPlanc/00install.out. Perhaps weirder, it seems to be triggered by an inclusion of armadillo_bits/constants.hpp in both my shared object and the Rcpp binding library-which seems like something that shouldn't be raising any issues.
> |
> | Dirk, you wouldn't happen to have seen this before?
>
> Sorry, have not. Could you possibly distill this out so that RcppPlanc is not
> used, and possibly also avoid cmake.  A minimally complete verifiable example
> would be great as the log you point at is a little long.
>
> Cheers, Dirk
>
> --
> dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From edd @end|ng |rom deb|@n@org  Wed May 21 21:57:45 2025
From: edd @end|ng |rom deb|@n@org (Dirk Eddelbuettel)
Date: Wed, 21 May 2025 14:57:45 -0500
Subject: [R-pkg-devel] How to use O4 flag in an RCpp project?
In-Reply-To: <CALMBL3XWMwE_4XUWahC3R_YyqiAbG42385h4f2xTCKJG3Y1fSg@mail.gmail.com>
References: <CALMBL3V+6GZ6HqJ7NUN3Hru=PKwpkDa-_xyJL0Ef1b0wGdpLvA@mail.gmail.com>
 <26669.52260.569090.49962@rob.eddelbuettel.com>
 <CALMBL3XWMwE_4XUWahC3R_YyqiAbG42385h4f2xTCKJG3Y1fSg@mail.gmail.com>
Message-ID: <26670.12345.711293.546404@rob.eddelbuettel.com>


On 21 May 2025 at 09:34, Peiyuan Zhu wrote:
| I'm happy to just use O3 but it sounds like this isn't something doable in C++.

It is called -O3, not 'O3'. (Also Rcpp, not RCpp.)

We do not know what you did because you never posted anything even remotely
close to reproducible.

| Maybe I should?just give up RCpp and move the program entirely to C++ from now
| on.?

Whatever works for you. You could also look at some existing projects and see
what they do; I just did a quick recursive search below my git directory on
the machine and saw at least two packages set -O3.  So it works for some of us.

Good luck either way.

Best, Dirk

-- 
dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From g@ryzhubc @end|ng |rom gm@||@com  Wed May 21 22:08:00 2025
From: g@ryzhubc @end|ng |rom gm@||@com (Peiyuan Zhu)
Date: Wed, 21 May 2025 13:08:00 -0700
Subject: [R-pkg-devel] How to use O4 flag in an RCpp project?
In-Reply-To: <26670.12345.711293.546404@rob.eddelbuettel.com>
References: <CALMBL3V+6GZ6HqJ7NUN3Hru=PKwpkDa-_xyJL0Ef1b0wGdpLvA@mail.gmail.com>
 <26669.52260.569090.49962@rob.eddelbuettel.com>
 <CALMBL3XWMwE_4XUWahC3R_YyqiAbG42385h4f2xTCKJG3Y1fSg@mail.gmail.com>
 <26670.12345.711293.546404@rob.eddelbuettel.com>
Message-ID: <CALMBL3XU9K0Rnwx__C2KutigJbaQU_ArU1Zh5VzqWL6wh_52Pg@mail.gmail.com>

The closest I got is the below after putting:

PKG_CXXFLAGS = -O3
PKG_CFLAGS = -O3

in Makevars. Still I'm seeing "-falign-functions=64 -Wall -g -O2" after -O3
so the last flag always wins.


> load_all(".")
? Loading dst
Exports from /Users/garyzhubc/Work/dst-1/src/belplauHFast.cpp:
   NumericMatrix belplauHFast(NumericVector MACC, const arma::sp_mat& W2,
NumericMatrix h, bool display_progress = false)

Exports from /Users/garyzhubc/Work/dst-1/src/closure.cpp:
   LogicalMatrix closure(IntegerMatrix ttx, bool computeJoin = true, bool
display_progress = false)

Exports from /Users/garyzhubc/Work/dst-1/src/closureSparse.cpp:
   arma::sp_mat closureSparse(arma::sp_mat ttx, bool computeJoin = true,
bool display_progress = false)

Exports from /Users/garyzhubc/Work/dst-1/src/commSparse.cpp:
   NumericVector commSparse(arma::sp_mat x, arma::sp_mat x_c, double a,
bool display_progress = false)

Exports from /Users/garyzhubc/Work/dst-1/src/iotaSparse.cpp:
   arma::sp_mat iotaSparse(arma::sp_mat tt, bool display_progress = false)

Exports from /Users/garyzhubc/Work/dst-1/src/treeFast.cpp:
   SEXP buildTreeFast(const arma::sp_mat& tt, const Rcpp::NumericVector& q,
bool display_progress = false, Rcpp::Nullable<Rcpp::IntegerVector> indices
= R_NilValue)
   SEXP updateTreeFast(SEXP tree_ptr, LogicalVector xx_vec, LogicalVector
s_vec)
   SEXP supersetFast(SEXP node_ptr, LogicalVector z_vec)
   NumericVector unravelTreeFast(SEXP tree_ptr)
   List inspectNode(SEXP tree_ptr)
   Rcpp::List inspectNodes(Rcpp::List trees)
   Rcpp::List buildTreesFast(const arma::sp_mat& tt, const
Rcpp::NumericVector& q)
   Rcpp::NumericVector unravelTreesFast(Rcpp::List trees)
   Rcpp::List updateTreesFast(Rcpp::List trees, Rcpp::NumericVector xx_vec,
Rcpp::NumericVector s_vec)

/Users/garyzhubc/Work/dst-1/src/RcppExports.cpp updated.
/Users/garyzhubc/Work/dst-1/R/RcppExports.R updated.
? Re-compiling dst
?? R CMD INSTALL
??????????????????????????????????????????????????????????????????????????????????????
?  installing *source* package ?dst? ... (1.4s)
   ** using staged installation
   ** libs
   using C++ compiler: ?Apple clang version 17.0.0 (clang-1700.0.13.3)?
   using SDK: ??
   clang++ -arch x86_64 -std=gnu++17
-I"/Library/Frameworks/R.framework/Resources/include" -DNDEBUG
 -I'/Library/Frameworks/R.framework/Versions/4.4-x86_64/Resources/library/Rcpp/include'
-I'/Library/Frameworks/R.framework/Versions/4.4-x86_64/Resources/library/BH/include'
-I'/Library/Frameworks/R.framework/Versions/4.4-x86_64/Resources/library/RcppProgress/include'
-I'/Library/Frameworks/R.framework/Versions/4.4-x86_64/Resources/library/RcppArmadillo/include'
-I/opt/R/x86_64/include   -O3 -fPIC  -falign-functions=64 -Wall -g -O2   -c
RcppExports.cpp -o RcppExports.o



On Wed, May 21, 2025 at 12:57?PM Dirk Eddelbuettel <edd at debian.org> wrote:

>
> On 21 May 2025 at 09:34, Peiyuan Zhu wrote:
> | I'm happy to just use O3 but it sounds like this isn't something doable
> in C++.
>
> It is called -O3, not 'O3'. (Also Rcpp, not RCpp.)
>
> We do not know what you did because you never posted anything even remotely
> close to reproducible.
>
> | Maybe I should just give up RCpp and move the program entirely to C++
> from now
> | on.
>
> Whatever works for you. You could also look at some existing projects and
> see
> what they do; I just did a quick recursive search below my git directory on
> the machine and saw at least two packages set -O3.  So it works for some
> of us.
>
> Good luck either way.
>
> Best, Dirk
>
> --
> dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org
>

	[[alternative HTML version deleted]]


From g@ryzhubc @end|ng |rom gm@||@com  Wed May 21 22:28:00 2025
From: g@ryzhubc @end|ng |rom gm@||@com (Peiyuan Zhu)
Date: Wed, 21 May 2025 13:28:00 -0700
Subject: [R-pkg-devel] How to use O4 flag in an RCpp project?
In-Reply-To: <CALMBL3XU9K0Rnwx__C2KutigJbaQU_ArU1Zh5VzqWL6wh_52Pg@mail.gmail.com>
References: <CALMBL3V+6GZ6HqJ7NUN3Hru=PKwpkDa-_xyJL0Ef1b0wGdpLvA@mail.gmail.com>
 <26669.52260.569090.49962@rob.eddelbuettel.com>
 <CALMBL3XWMwE_4XUWahC3R_YyqiAbG42385h4f2xTCKJG3Y1fSg@mail.gmail.com>
 <26670.12345.711293.546404@rob.eddelbuettel.com>
 <CALMBL3XU9K0Rnwx__C2KutigJbaQU_ArU1Zh5VzqWL6wh_52Pg@mail.gmail.com>
Message-ID: <CALMBL3Uco9k-FvsOHncPwgLDKFp6dopOggtxGRXSdp5B36SsXA@mail.gmail.com>

Ok now I replaced all -g -O2 with -O3 in Makeconf then it seems to have
worked. Not sure which line exactly that has led to it working tho.

> load_all(".")
? Loading dst
Exports from /Users/garyzhubc/Work/dst-1/src/belplauHFast.cpp:
   NumericMatrix belplauHFast(NumericVector MACC, const arma::sp_mat& W2,
NumericMatrix h, bool display_progress = false)

Exports from /Users/garyzhubc/Work/dst-1/src/closure.cpp:
   LogicalMatrix closure(IntegerMatrix ttx, bool computeJoin = true, bool
display_progress = false)

Exports from /Users/garyzhubc/Work/dst-1/src/closureSparse.cpp:
   arma::sp_mat closureSparse(arma::sp_mat ttx, bool computeJoin = true,
bool display_progress = false)

Exports from /Users/garyzhubc/Work/dst-1/src/commSparse.cpp:
   NumericVector commSparse(arma::sp_mat x, arma::sp_mat x_c, double a,
bool display_progress = false)

Exports from /Users/garyzhubc/Work/dst-1/src/iotaSparse.cpp:
   arma::sp_mat iotaSparse(arma::sp_mat tt, bool display_progress = false)

Exports from /Users/garyzhubc/Work/dst-1/src/treeFast.cpp:
   SEXP buildTreeFast(const arma::sp_mat& tt, const Rcpp::NumericVector& q,
bool display_progress = false, Rcpp::Nullable<Rcpp::IntegerVector> indices
= R_NilValue)
   SEXP updateTreeFast(SEXP tree_ptr, LogicalVector xx_vec, LogicalVector
s_vec)
   SEXP supersetFast(SEXP node_ptr, LogicalVector z_vec)
   NumericVector unravelTreeFast(SEXP tree_ptr)
   List inspectNode(SEXP tree_ptr)
   Rcpp::List inspectNodes(Rcpp::List trees)
   Rcpp::List buildTreesFast(const arma::sp_mat& tt, const
Rcpp::NumericVector& q)
   Rcpp::NumericVector unravelTreesFast(Rcpp::List trees)
   Rcpp::List updateTreesFast(Rcpp::List trees, Rcpp::NumericVector xx_vec,
Rcpp::NumericVector s_vec)

/Users/garyzhubc/Work/dst-1/src/RcppExports.cpp updated.
/Users/garyzhubc/Work/dst-1/R/RcppExports.R updated.
? Re-compiling dst
?? R CMD INSTALL
??????????????????????????????????????????????????????????????????????????????????????
?  installing *source* package ?dst? ...
   ** using staged installation
   ** libs
   using C++ compiler: ?Apple clang version 17.0.0 (clang-1700.0.13.3)?
   using SDK: ??
   clang++ -arch x86_64 -std=gnu++17
-I"/Library/Frameworks/R.framework/Resources/include" -DNDEBUG
 -I'/Library/Frameworks/R.framework/Versions/4.4-x86_64/Resources/library/Rcpp/include'
-I'/Library/Frameworks/R.framework/Versions/4.4-x86_64/Resources/library/BH/include'
-I'/Library/Frameworks/R.framework/Versions/4.4-x86_64/Resources/library/RcppProgress/include'
-I'/Library/Frameworks/R.framework/Versions/4.4-x86_64/Resources/library/RcppArmadillo/include'
-I/opt/R/x86_64/include   -O3 -fPIC  -falign-functions=64 -Wall -O3   -c
RcppExports.cpp -o RcppExports.o


On Wed, May 21, 2025 at 1:08?PM Peiyuan Zhu <garyzhubc at gmail.com> wrote:

> The closest I got is the below after putting:
>
> PKG_CXXFLAGS = -O3
> PKG_CFLAGS = -O3
>
> in Makevars. Still I'm seeing "-falign-functions=64 -Wall -g -O2" after
> -O3 so the last flag always wins.
>
>
> > load_all(".")
> ? Loading dst
> Exports from /Users/garyzhubc/Work/dst-1/src/belplauHFast.cpp:
>    NumericMatrix belplauHFast(NumericVector MACC, const arma::sp_mat& W2,
> NumericMatrix h, bool display_progress = false)
>
> Exports from /Users/garyzhubc/Work/dst-1/src/closure.cpp:
>    LogicalMatrix closure(IntegerMatrix ttx, bool computeJoin = true, bool
> display_progress = false)
>
> Exports from /Users/garyzhubc/Work/dst-1/src/closureSparse.cpp:
>    arma::sp_mat closureSparse(arma::sp_mat ttx, bool computeJoin = true,
> bool display_progress = false)
>
> Exports from /Users/garyzhubc/Work/dst-1/src/commSparse.cpp:
>    NumericVector commSparse(arma::sp_mat x, arma::sp_mat x_c, double a,
> bool display_progress = false)
>
> Exports from /Users/garyzhubc/Work/dst-1/src/iotaSparse.cpp:
>    arma::sp_mat iotaSparse(arma::sp_mat tt, bool display_progress = false)
>
> Exports from /Users/garyzhubc/Work/dst-1/src/treeFast.cpp:
>    SEXP buildTreeFast(const arma::sp_mat& tt, const Rcpp::NumericVector&
> q, bool display_progress = false, Rcpp::Nullable<Rcpp::IntegerVector>
> indices = R_NilValue)
>    SEXP updateTreeFast(SEXP tree_ptr, LogicalVector xx_vec, LogicalVector
> s_vec)
>    SEXP supersetFast(SEXP node_ptr, LogicalVector z_vec)
>    NumericVector unravelTreeFast(SEXP tree_ptr)
>    List inspectNode(SEXP tree_ptr)
>    Rcpp::List inspectNodes(Rcpp::List trees)
>    Rcpp::List buildTreesFast(const arma::sp_mat& tt, const
> Rcpp::NumericVector& q)
>    Rcpp::NumericVector unravelTreesFast(Rcpp::List trees)
>    Rcpp::List updateTreesFast(Rcpp::List trees, Rcpp::NumericVector
> xx_vec, Rcpp::NumericVector s_vec)
>
> /Users/garyzhubc/Work/dst-1/src/RcppExports.cpp updated.
> /Users/garyzhubc/Work/dst-1/R/RcppExports.R updated.
> ? Re-compiling dst
> ?? R CMD INSTALL
> ??????????????????????????????????????????????????????????????????????????????????????
> ?  installing *source* package ?dst? ... (1.4s)
>    ** using staged installation
>    ** libs
>    using C++ compiler: ?Apple clang version 17.0.0 (clang-1700.0.13.3)?
>    using SDK: ??
>    clang++ -arch x86_64 -std=gnu++17
> -I"/Library/Frameworks/R.framework/Resources/include" -DNDEBUG
>  -I'/Library/Frameworks/R.framework/Versions/4.4-x86_64/Resources/library/Rcpp/include'
> -I'/Library/Frameworks/R.framework/Versions/4.4-x86_64/Resources/library/BH/include'
> -I'/Library/Frameworks/R.framework/Versions/4.4-x86_64/Resources/library/RcppProgress/include'
> -I'/Library/Frameworks/R.framework/Versions/4.4-x86_64/Resources/library/RcppArmadillo/include'
> -I/opt/R/x86_64/include   -O3 -fPIC  -falign-functions=64 -Wall -g -O2   -c
> RcppExports.cpp -o RcppExports.o
>
>
>
> On Wed, May 21, 2025 at 12:57?PM Dirk Eddelbuettel <edd at debian.org> wrote:
>
>>
>> On 21 May 2025 at 09:34, Peiyuan Zhu wrote:
>> | I'm happy to just use O3 but it sounds like this isn't something doable
>> in C++.
>>
>> It is called -O3, not 'O3'. (Also Rcpp, not RCpp.)
>>
>> We do not know what you did because you never posted anything even
>> remotely
>> close to reproducible.
>>
>> | Maybe I should just give up RCpp and move the program entirely to C++
>> from now
>> | on.
>>
>> Whatever works for you. You could also look at some existing projects and
>> see
>> what they do; I just did a quick recursive search below my git directory
>> on
>> the machine and saw at least two packages set -O3.  So it works for some
>> of us.
>>
>> Good luck either way.
>>
>> Best, Dirk
>>
>> --
>> dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org
>>
>

	[[alternative HTML version deleted]]


From k@@perd@n|e|h@n@en @end|ng |rom gm@||@com  Wed May 21 22:48:03 2025
From: k@@perd@n|e|h@n@en @end|ng |rom gm@||@com (Kasper Daniel Hansen)
Date: Wed, 21 May 2025 15:48:03 -0500
Subject: [R-pkg-devel] How to use O4 flag in an RCpp project?
In-Reply-To: <CALMBL3Uco9k-FvsOHncPwgLDKFp6dopOggtxGRXSdp5B36SsXA@mail.gmail.com>
References: <CALMBL3V+6GZ6HqJ7NUN3Hru=PKwpkDa-_xyJL0Ef1b0wGdpLvA@mail.gmail.com>
 <26669.52260.569090.49962@rob.eddelbuettel.com>
 <CALMBL3XWMwE_4XUWahC3R_YyqiAbG42385h4f2xTCKJG3Y1fSg@mail.gmail.com>
 <26670.12345.711293.546404@rob.eddelbuettel.com>
 <CALMBL3XU9K0Rnwx__C2KutigJbaQU_ArU1Zh5VzqWL6wh_52Pg@mail.gmail.com>
 <CALMBL3Uco9k-FvsOHncPwgLDKFp6dopOggtxGRXSdp5B36SsXA@mail.gmail.com>
Message-ID: <CAC2h7ut7UXE5zzJSo-CHyMSHd0k_QehasXMuSYeiNiQAQ5F1qw@mail.gmail.com>

As a package writer, you should not in general (IMO) override the settings
made by whoever compiled R on your system

If you want to use -O4, you should really compile R from source using -O4
and check that it works. Then your package will use it as well.

Best,
Kasper

On Wed, May 21, 2025 at 3:30?PM Peiyuan Zhu <garyzhubc at gmail.com> wrote:

> Ok now I replaced all -g -O2 with -O3 in Makeconf then it seems to have
> worked. Not sure which line exactly that has led to it working tho.
>
> > load_all(".")
> ? Loading dst
> Exports from /Users/garyzhubc/Work/dst-1/src/belplauHFast.cpp:
>    NumericMatrix belplauHFast(NumericVector MACC, const arma::sp_mat& W2,
> NumericMatrix h, bool display_progress = false)
>
> Exports from /Users/garyzhubc/Work/dst-1/src/closure.cpp:
>    LogicalMatrix closure(IntegerMatrix ttx, bool computeJoin = true, bool
> display_progress = false)
>
> Exports from /Users/garyzhubc/Work/dst-1/src/closureSparse.cpp:
>    arma::sp_mat closureSparse(arma::sp_mat ttx, bool computeJoin = true,
> bool display_progress = false)
>
> Exports from /Users/garyzhubc/Work/dst-1/src/commSparse.cpp:
>    NumericVector commSparse(arma::sp_mat x, arma::sp_mat x_c, double a,
> bool display_progress = false)
>
> Exports from /Users/garyzhubc/Work/dst-1/src/iotaSparse.cpp:
>    arma::sp_mat iotaSparse(arma::sp_mat tt, bool display_progress = false)
>
> Exports from /Users/garyzhubc/Work/dst-1/src/treeFast.cpp:
>    SEXP buildTreeFast(const arma::sp_mat& tt, const Rcpp::NumericVector& q,
> bool display_progress = false, Rcpp::Nullable<Rcpp::IntegerVector> indices
> = R_NilValue)
>    SEXP updateTreeFast(SEXP tree_ptr, LogicalVector xx_vec, LogicalVector
> s_vec)
>    SEXP supersetFast(SEXP node_ptr, LogicalVector z_vec)
>    NumericVector unravelTreeFast(SEXP tree_ptr)
>    List inspectNode(SEXP tree_ptr)
>    Rcpp::List inspectNodes(Rcpp::List trees)
>    Rcpp::List buildTreesFast(const arma::sp_mat& tt, const
> Rcpp::NumericVector& q)
>    Rcpp::NumericVector unravelTreesFast(Rcpp::List trees)
>    Rcpp::List updateTreesFast(Rcpp::List trees, Rcpp::NumericVector xx_vec,
> Rcpp::NumericVector s_vec)
>
> /Users/garyzhubc/Work/dst-1/src/RcppExports.cpp updated.
> /Users/garyzhubc/Work/dst-1/R/RcppExports.R updated.
> ? Re-compiling dst
> ?? R CMD INSTALL
>
> ??????????????????????????????????????????????????????????????????????????????????????
> ?  installing *source* package ?dst? ...
>    ** using staged installation
>    ** libs
>    using C++ compiler: ?Apple clang version 17.0.0 (clang-1700.0.13.3)?
>    using SDK: ??
>    clang++ -arch x86_64 -std=gnu++17
> -I"/Library/Frameworks/R.framework/Resources/include" -DNDEBUG
>
>  -I'/Library/Frameworks/R.framework/Versions/4.4-x86_64/Resources/library/Rcpp/include'
>
> -I'/Library/Frameworks/R.framework/Versions/4.4-x86_64/Resources/library/BH/include'
>
> -I'/Library/Frameworks/R.framework/Versions/4.4-x86_64/Resources/library/RcppProgress/include'
>
> -I'/Library/Frameworks/R.framework/Versions/4.4-x86_64/Resources/library/RcppArmadillo/include'
> -I/opt/R/x86_64/include   -O3 -fPIC  -falign-functions=64 -Wall -O3   -c
> RcppExports.cpp -o RcppExports.o
>
>
> On Wed, May 21, 2025 at 1:08?PM Peiyuan Zhu <garyzhubc at gmail.com> wrote:
>
> > The closest I got is the below after putting:
> >
> > PKG_CXXFLAGS = -O3
> > PKG_CFLAGS = -O3
> >
> > in Makevars. Still I'm seeing "-falign-functions=64 -Wall -g -O2" after
> > -O3 so the last flag always wins.
> >
> >
> > > load_all(".")
> > ? Loading dst
> > Exports from /Users/garyzhubc/Work/dst-1/src/belplauHFast.cpp:
> >    NumericMatrix belplauHFast(NumericVector MACC, const arma::sp_mat& W2,
> > NumericMatrix h, bool display_progress = false)
> >
> > Exports from /Users/garyzhubc/Work/dst-1/src/closure.cpp:
> >    LogicalMatrix closure(IntegerMatrix ttx, bool computeJoin = true, bool
> > display_progress = false)
> >
> > Exports from /Users/garyzhubc/Work/dst-1/src/closureSparse.cpp:
> >    arma::sp_mat closureSparse(arma::sp_mat ttx, bool computeJoin = true,
> > bool display_progress = false)
> >
> > Exports from /Users/garyzhubc/Work/dst-1/src/commSparse.cpp:
> >    NumericVector commSparse(arma::sp_mat x, arma::sp_mat x_c, double a,
> > bool display_progress = false)
> >
> > Exports from /Users/garyzhubc/Work/dst-1/src/iotaSparse.cpp:
> >    arma::sp_mat iotaSparse(arma::sp_mat tt, bool display_progress =
> false)
> >
> > Exports from /Users/garyzhubc/Work/dst-1/src/treeFast.cpp:
> >    SEXP buildTreeFast(const arma::sp_mat& tt, const Rcpp::NumericVector&
> > q, bool display_progress = false, Rcpp::Nullable<Rcpp::IntegerVector>
> > indices = R_NilValue)
> >    SEXP updateTreeFast(SEXP tree_ptr, LogicalVector xx_vec, LogicalVector
> > s_vec)
> >    SEXP supersetFast(SEXP node_ptr, LogicalVector z_vec)
> >    NumericVector unravelTreeFast(SEXP tree_ptr)
> >    List inspectNode(SEXP tree_ptr)
> >    Rcpp::List inspectNodes(Rcpp::List trees)
> >    Rcpp::List buildTreesFast(const arma::sp_mat& tt, const
> > Rcpp::NumericVector& q)
> >    Rcpp::NumericVector unravelTreesFast(Rcpp::List trees)
> >    Rcpp::List updateTreesFast(Rcpp::List trees, Rcpp::NumericVector
> > xx_vec, Rcpp::NumericVector s_vec)
> >
> > /Users/garyzhubc/Work/dst-1/src/RcppExports.cpp updated.
> > /Users/garyzhubc/Work/dst-1/R/RcppExports.R updated.
> > ? Re-compiling dst
> > ?? R CMD INSTALL
> >
> ??????????????????????????????????????????????????????????????????????????????????????
> > ?  installing *source* package ?dst? ... (1.4s)
> >    ** using staged installation
> >    ** libs
> >    using C++ compiler: ?Apple clang version 17.0.0 (clang-1700.0.13.3)?
> >    using SDK: ??
> >    clang++ -arch x86_64 -std=gnu++17
> > -I"/Library/Frameworks/R.framework/Resources/include" -DNDEBUG
> >
> -I'/Library/Frameworks/R.framework/Versions/4.4-x86_64/Resources/library/Rcpp/include'
> >
> -I'/Library/Frameworks/R.framework/Versions/4.4-x86_64/Resources/library/BH/include'
> >
> -I'/Library/Frameworks/R.framework/Versions/4.4-x86_64/Resources/library/RcppProgress/include'
> >
> -I'/Library/Frameworks/R.framework/Versions/4.4-x86_64/Resources/library/RcppArmadillo/include'
> > -I/opt/R/x86_64/include   -O3 -fPIC  -falign-functions=64 -Wall -g -O2
>  -c
> > RcppExports.cpp -o RcppExports.o
> >
> >
> >
> > On Wed, May 21, 2025 at 12:57?PM Dirk Eddelbuettel <edd at debian.org>
> wrote:
> >
> >>
> >> On 21 May 2025 at 09:34, Peiyuan Zhu wrote:
> >> | I'm happy to just use O3 but it sounds like this isn't something
> doable
> >> in C++.
> >>
> >> It is called -O3, not 'O3'. (Also Rcpp, not RCpp.)
> >>
> >> We do not know what you did because you never posted anything even
> >> remotely
> >> close to reproducible.
> >>
> >> | Maybe I should just give up RCpp and move the program entirely to C++
> >> from now
> >> | on.
> >>
> >> Whatever works for you. You could also look at some existing projects
> and
> >> see
> >> what they do; I just did a quick recursive search below my git directory
> >> on
> >> the machine and saw at least two packages set -O3.  So it works for some
> >> of us.
> >>
> >> Good luck either way.
> >>
> >> Best, Dirk
> >>
> >> --
> >> dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org
> >>
> >
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


-- 
Best,
Kasper

	[[alternative HTML version deleted]]


From g@ryzhubc @end|ng |rom gm@||@com  Wed May 21 22:55:14 2025
From: g@ryzhubc @end|ng |rom gm@||@com (Peiyuan Zhu)
Date: Wed, 21 May 2025 13:55:14 -0700
Subject: [R-pkg-devel] How to use O4 flag in an RCpp project?
In-Reply-To: <CAC2h7ut7UXE5zzJSo-CHyMSHd0k_QehasXMuSYeiNiQAQ5F1qw@mail.gmail.com>
References: <CALMBL3V+6GZ6HqJ7NUN3Hru=PKwpkDa-_xyJL0Ef1b0wGdpLvA@mail.gmail.com>
 <26669.52260.569090.49962@rob.eddelbuettel.com>
 <CALMBL3XWMwE_4XUWahC3R_YyqiAbG42385h4f2xTCKJG3Y1fSg@mail.gmail.com>
 <26670.12345.711293.546404@rob.eddelbuettel.com>
 <CALMBL3XU9K0Rnwx__C2KutigJbaQU_ArU1Zh5VzqWL6wh_52Pg@mail.gmail.com>
 <CALMBL3Uco9k-FvsOHncPwgLDKFp6dopOggtxGRXSdp5B36SsXA@mail.gmail.com>
 <CAC2h7ut7UXE5zzJSo-CHyMSHd0k_QehasXMuSYeiNiQAQ5F1qw@mail.gmail.com>
Message-ID: <CALMBL3UL214ZK=zzbxdq3ETrKAgTGFwPA_7AHvWD7KzNH-0DGA@mail.gmail.com>

Thanks Kasper, but I don?t know how exactly to accomplish this. As Dirk
says the system overwrites it every time.

On Wednesday, May 21, 2025, Kasper Daniel Hansen <
kasperdanielhansen at gmail.com> wrote:

> As a package writer, you should not in general (IMO) override the settings
> made by whoever compiled R on your system
>
> If you want to use -O4, you should really compile R from source using -O4
> and check that it works. Then your package will use it as well.
>
> Best,
> Kasper
>
> On Wed, May 21, 2025 at 3:30?PM Peiyuan Zhu <garyzhubc at gmail.com> wrote:
>
>> Ok now I replaced all -g -O2 with -O3 in Makeconf then it seems to have
>> worked. Not sure which line exactly that has led to it working tho.
>>
>> > load_all(".")
>> ? Loading dst
>> Exports from /Users/garyzhubc/Work/dst-1/src/belplauHFast.cpp:
>>    NumericMatrix belplauHFast(NumericVector MACC, const arma::sp_mat& W2,
>> NumericMatrix h, bool display_progress = false)
>>
>> Exports from /Users/garyzhubc/Work/dst-1/src/closure.cpp:
>>    LogicalMatrix closure(IntegerMatrix ttx, bool computeJoin = true, bool
>> display_progress = false)
>>
>> Exports from /Users/garyzhubc/Work/dst-1/src/closureSparse.cpp:
>>    arma::sp_mat closureSparse(arma::sp_mat ttx, bool computeJoin = true,
>> bool display_progress = false)
>>
>> Exports from /Users/garyzhubc/Work/dst-1/src/commSparse.cpp:
>>    NumericVector commSparse(arma::sp_mat x, arma::sp_mat x_c, double a,
>> bool display_progress = false)
>>
>> Exports from /Users/garyzhubc/Work/dst-1/src/iotaSparse.cpp:
>>    arma::sp_mat iotaSparse(arma::sp_mat tt, bool display_progress = false)
>>
>> Exports from /Users/garyzhubc/Work/dst-1/src/treeFast.cpp:
>>    SEXP buildTreeFast(const arma::sp_mat& tt, const Rcpp::NumericVector&
>> q,
>> bool display_progress = false, Rcpp::Nullable<Rcpp::IntegerVector>
>> indices
>> = R_NilValue)
>>    SEXP updateTreeFast(SEXP tree_ptr, LogicalVector xx_vec, LogicalVector
>> s_vec)
>>    SEXP supersetFast(SEXP node_ptr, LogicalVector z_vec)
>>    NumericVector unravelTreeFast(SEXP tree_ptr)
>>    List inspectNode(SEXP tree_ptr)
>>    Rcpp::List inspectNodes(Rcpp::List trees)
>>    Rcpp::List buildTreesFast(const arma::sp_mat& tt, const
>> Rcpp::NumericVector& q)
>>    Rcpp::NumericVector unravelTreesFast(Rcpp::List trees)
>>    Rcpp::List updateTreesFast(Rcpp::List trees, Rcpp::NumericVector
>> xx_vec,
>> Rcpp::NumericVector s_vec)
>>
>> /Users/garyzhubc/Work/dst-1/src/RcppExports.cpp updated.
>> /Users/garyzhubc/Work/dst-1/R/RcppExports.R updated.
>> ? Re-compiling dst
>> ?? R CMD INSTALL
>> ????????????????????????????????????????????????????????????
>> ??????????????????????????
>> ?  installing *source* package ?dst? ...
>>    ** using staged installation
>>    ** libs
>>    using C++ compiler: ?Apple clang version 17.0.0 (clang-1700.0.13.3)?
>>    using SDK: ??
>>    clang++ -arch x86_64 -std=gnu++17
>> -I"/Library/Frameworks/R.framework/Resources/include" -DNDEBUG
>>  -I'/Library/Frameworks/R.framework/Versions/4.4-x86_64/
>> Resources/library/Rcpp/include'
>> -I'/Library/Frameworks/R.framework/Versions/4.4-x86_64/
>> Resources/library/BH/include'
>> -I'/Library/Frameworks/R.framework/Versions/4.4-x86_64/Resources/library/
>> RcppProgress/include'
>> -I'/Library/Frameworks/R.framework/Versions/4.4-x86_64/Resources/library/
>> RcppArmadillo/include'
>> -I/opt/R/x86_64/include   -O3 -fPIC  -falign-functions=64 -Wall -O3   -c
>> RcppExports.cpp -o RcppExports.o
>>
>>
>> On Wed, May 21, 2025 at 1:08?PM Peiyuan Zhu <garyzhubc at gmail.com> wrote:
>>
>> > The closest I got is the below after putting:
>> >
>> > PKG_CXXFLAGS = -O3
>> > PKG_CFLAGS = -O3
>> >
>> > in Makevars. Still I'm seeing "-falign-functions=64 -Wall -g -O2" after
>> > -O3 so the last flag always wins.
>> >
>> >
>> > > load_all(".")
>> > ? Loading dst
>> > Exports from /Users/garyzhubc/Work/dst-1/src/belplauHFast.cpp:
>> >    NumericMatrix belplauHFast(NumericVector MACC, const arma::sp_mat&
>> W2,
>> > NumericMatrix h, bool display_progress = false)
>> >
>> > Exports from /Users/garyzhubc/Work/dst-1/src/closure.cpp:
>> >    LogicalMatrix closure(IntegerMatrix ttx, bool computeJoin = true,
>> bool
>> > display_progress = false)
>> >
>> > Exports from /Users/garyzhubc/Work/dst-1/src/closureSparse.cpp:
>> >    arma::sp_mat closureSparse(arma::sp_mat ttx, bool computeJoin = true,
>> > bool display_progress = false)
>> >
>> > Exports from /Users/garyzhubc/Work/dst-1/src/commSparse.cpp:
>> >    NumericVector commSparse(arma::sp_mat x, arma::sp_mat x_c, double a,
>> > bool display_progress = false)
>> >
>> > Exports from /Users/garyzhubc/Work/dst-1/src/iotaSparse.cpp:
>> >    arma::sp_mat iotaSparse(arma::sp_mat tt, bool display_progress =
>> false)
>> >
>> > Exports from /Users/garyzhubc/Work/dst-1/src/treeFast.cpp:
>> >    SEXP buildTreeFast(const arma::sp_mat& tt, const Rcpp::NumericVector&
>> > q, bool display_progress = false, Rcpp::Nullable<Rcpp::IntegerVector>
>> > indices = R_NilValue)
>> >    SEXP updateTreeFast(SEXP tree_ptr, LogicalVector xx_vec,
>> LogicalVector
>> > s_vec)
>> >    SEXP supersetFast(SEXP node_ptr, LogicalVector z_vec)
>> >    NumericVector unravelTreeFast(SEXP tree_ptr)
>> >    List inspectNode(SEXP tree_ptr)
>> >    Rcpp::List inspectNodes(Rcpp::List trees)
>> >    Rcpp::List buildTreesFast(const arma::sp_mat& tt, const
>> > Rcpp::NumericVector& q)
>> >    Rcpp::NumericVector unravelTreesFast(Rcpp::List trees)
>> >    Rcpp::List updateTreesFast(Rcpp::List trees, Rcpp::NumericVector
>> > xx_vec, Rcpp::NumericVector s_vec)
>> >
>> > /Users/garyzhubc/Work/dst-1/src/RcppExports.cpp updated.
>> > /Users/garyzhubc/Work/dst-1/R/RcppExports.R updated.
>> > ? Re-compiling dst
>> > ?? R CMD INSTALL
>> > ????????????????????????????????????????????????????????????
>> ??????????????????????????
>> > ?  installing *source* package ?dst? ... (1.4s)
>> >    ** using staged installation
>> >    ** libs
>> >    using C++ compiler: ?Apple clang version 17.0.0 (clang-1700.0.13.3)?
>> >    using SDK: ??
>> >    clang++ -arch x86_64 -std=gnu++17
>> > -I"/Library/Frameworks/R.framework/Resources/include" -DNDEBUG
>> >  -I'/Library/Frameworks/R.framework/Versions/4.4-x86_64/
>> Resources/library/Rcpp/include'
>> > -I'/Library/Frameworks/R.framework/Versions/4.4-x86_64/
>> Resources/library/BH/include'
>> > -I'/Library/Frameworks/R.framework/Versions/4.4-x86_64/
>> Resources/library/RcppProgress/include'
>> > -I'/Library/Frameworks/R.framework/Versions/4.4-x86_64/
>> Resources/library/RcppArmadillo/include'
>> > -I/opt/R/x86_64/include   -O3 -fPIC  -falign-functions=64 -Wall -g -O2
>>  -c
>> > RcppExports.cpp -o RcppExports.o
>> >
>> >
>> >
>> > On Wed, May 21, 2025 at 12:57?PM Dirk Eddelbuettel <edd at debian.org>
>> wrote:
>> >
>> >>
>> >> On 21 May 2025 at 09:34, Peiyuan Zhu wrote:
>> >> | I'm happy to just use O3 but it sounds like this isn't something
>> doable
>> >> in C++.
>> >>
>> >> It is called -O3, not 'O3'. (Also Rcpp, not RCpp.)
>> >>
>> >> We do not know what you did because you never posted anything even
>> >> remotely
>> >> close to reproducible.
>> >>
>> >> | Maybe I should just give up RCpp and move the program entirely to C++
>> >> from now
>> >> | on.
>> >>
>> >> Whatever works for you. You could also look at some existing projects
>> and
>> >> see
>> >> what they do; I just did a quick recursive search below my git
>> directory
>> >> on
>> >> the machine and saw at least two packages set -O3.  So it works for
>> some
>> >> of us.
>> >>
>> >> Good luck either way.
>> >>
>> >> Best, Dirk
>> >>
>> >> --
>> >> dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org
>> >>
>> >
>>
>>         [[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>
>
>
> --
> Best,
> Kasper
>

	[[alternative HTML version deleted]]


From edd @end|ng |rom deb|@n@org  Wed May 21 23:11:58 2025
From: edd @end|ng |rom deb|@n@org (Dirk Eddelbuettel)
Date: Wed, 21 May 2025 16:11:58 -0500
Subject: [R-pkg-devel] How to use O4 flag in an RCpp project?
In-Reply-To: <CALMBL3UL214ZK=zzbxdq3ETrKAgTGFwPA_7AHvWD7KzNH-0DGA@mail.gmail.com>
References: <CALMBL3V+6GZ6HqJ7NUN3Hru=PKwpkDa-_xyJL0Ef1b0wGdpLvA@mail.gmail.com>
 <26669.52260.569090.49962@rob.eddelbuettel.com>
 <CALMBL3XWMwE_4XUWahC3R_YyqiAbG42385h4f2xTCKJG3Y1fSg@mail.gmail.com>
 <26670.12345.711293.546404@rob.eddelbuettel.com>
 <CALMBL3XU9K0Rnwx__C2KutigJbaQU_ArU1Zh5VzqWL6wh_52Pg@mail.gmail.com>
 <CALMBL3Uco9k-FvsOHncPwgLDKFp6dopOggtxGRXSdp5B36SsXA@mail.gmail.com>
 <CAC2h7ut7UXE5zzJSo-CHyMSHd0k_QehasXMuSYeiNiQAQ5F1qw@mail.gmail.com>
 <CALMBL3UL214ZK=zzbxdq3ETrKAgTGFwPA_7AHvWD7KzNH-0DGA@mail.gmail.com>
Message-ID: <26670.16798.749503.151209@rob.eddelbuettel.com>


On 21 May 2025 at 13:55, Peiyuan Zhu wrote:
| Thanks Kasper, but I don?t know how exactly to accomplish this. As Dirk says
| the system overwrites it every time.?

That is *not* what Dirk said.  

Dirk

-- 
dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From g@ryzhubc @end|ng |rom gm@||@com  Wed May 21 23:17:38 2025
From: g@ryzhubc @end|ng |rom gm@||@com (Peiyuan Zhu)
Date: Wed, 21 May 2025 14:17:38 -0700
Subject: [R-pkg-devel] How to use O4 flag in an RCpp project?
In-Reply-To: <26670.16798.749503.151209@rob.eddelbuettel.com>
References: <CALMBL3V+6GZ6HqJ7NUN3Hru=PKwpkDa-_xyJL0Ef1b0wGdpLvA@mail.gmail.com>
 <26669.52260.569090.49962@rob.eddelbuettel.com>
 <CALMBL3XWMwE_4XUWahC3R_YyqiAbG42385h4f2xTCKJG3Y1fSg@mail.gmail.com>
 <26670.12345.711293.546404@rob.eddelbuettel.com>
 <CALMBL3XU9K0Rnwx__C2KutigJbaQU_ArU1Zh5VzqWL6wh_52Pg@mail.gmail.com>
 <CALMBL3Uco9k-FvsOHncPwgLDKFp6dopOggtxGRXSdp5B36SsXA@mail.gmail.com>
 <CAC2h7ut7UXE5zzJSo-CHyMSHd0k_QehasXMuSYeiNiQAQ5F1qw@mail.gmail.com>
 <CALMBL3UL214ZK=zzbxdq3ETrKAgTGFwPA_7AHvWD7KzNH-0DGA@mail.gmail.com>
 <26670.16798.749503.151209@rob.eddelbuettel.com>
Message-ID: <CALMBL3VNg1Vq2wN_-xV6NKqLVGR3oLiX92tMhx4U9kR0YNHzmA@mail.gmail.com>

So are you suggesting to make a Make file that can skip the system?s
setting? I?m not sure what exactly is the solution you?re proposing.

On Wednesday, May 21, 2025, Dirk Eddelbuettel <edd at debian.org> wrote:

>
> On 21 May 2025 at 13:55, Peiyuan Zhu wrote:
> | Thanks Kasper, but I don?t know how exactly to accomplish this. As Dirk
> says
> | the system overwrites it every time.
>
> That is *not* what Dirk said.
>
> Dirk
>
> --
> dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org
>

	[[alternative HTML version deleted]]


From kev|nu@hey @end|ng |rom gm@||@com  Wed May 21 23:21:44 2025
From: kev|nu@hey @end|ng |rom gm@||@com (Kevin Ushey)
Date: Wed, 21 May 2025 14:21:44 -0700
Subject: [R-pkg-devel] How to use O4 flag in an RCpp project?
In-Reply-To: <26670.16798.749503.151209@rob.eddelbuettel.com>
References: <CALMBL3V+6GZ6HqJ7NUN3Hru=PKwpkDa-_xyJL0Ef1b0wGdpLvA@mail.gmail.com>
 <26669.52260.569090.49962@rob.eddelbuettel.com>
 <CALMBL3XWMwE_4XUWahC3R_YyqiAbG42385h4f2xTCKJG3Y1fSg@mail.gmail.com>
 <26670.12345.711293.546404@rob.eddelbuettel.com>
 <CALMBL3XU9K0Rnwx__C2KutigJbaQU_ArU1Zh5VzqWL6wh_52Pg@mail.gmail.com>
 <CALMBL3Uco9k-FvsOHncPwgLDKFp6dopOggtxGRXSdp5B36SsXA@mail.gmail.com>
 <CAC2h7ut7UXE5zzJSo-CHyMSHd0k_QehasXMuSYeiNiQAQ5F1qw@mail.gmail.com>
 <CALMBL3UL214ZK=zzbxdq3ETrKAgTGFwPA_7AHvWD7KzNH-0DGA@mail.gmail.com>
 <26670.16798.749503.151209@rob.eddelbuettel.com>
Message-ID: <CAJXgQP2tsngt7JE-B-KkB41_LG4qUQVReTeGrAsjmhNarZ_3pw@mail.gmail.com>

Peiyuan,

Respectfully -- RTFM.

https://cran.r-project.org/doc/manuals/R-exts.html#Using-Makevars
https://cran.r-project.org/doc/manuals/R-admin.html#Customizing-package-compilation

The compilation flags are coming either from your R installation's
etc/Makeconf, etc/Makevars.site, a user Makevars, or the package's
Makevars.

You can also use R CMD SHLIB --dry-run to figure out what `make`
invocation R is using, so you can know where these compiler flags are
coming from. For example:

$ R CMD SHLIB --dry-run example.cpp
make cmd is
  make -f 'Makevars' -f
'/Library/Frameworks/R.framework/Resources/etc/Makeconf' -f
'/Library/Frameworks/R.framework/Resources/share/make/shlib.mk' -f
'/Users/kevin/.R/Makevars' SHLIB_LDFLAGS='$(SHLIB_CXXLDFLAGS)'
SHLIB_LD='$(SHLIB_CXXLD)' SHLIB='example.so' OBJECTS='example.o'

Kevin

On Wed, May 21, 2025 at 2:12?PM Dirk Eddelbuettel <edd at debian.org> wrote:
>
>
> On 21 May 2025 at 13:55, Peiyuan Zhu wrote:
> | Thanks Kasper, but I don?t know how exactly to accomplish this. As Dirk says
> | the system overwrites it every time.
>
> That is *not* what Dirk said.
>
> Dirk
>
> --
> dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From k@@perd@n|e|h@n@en @end|ng |rom gm@||@com  Wed May 21 23:22:27 2025
From: k@@perd@n|e|h@n@en @end|ng |rom gm@||@com (Kasper Daniel Hansen)
Date: Wed, 21 May 2025 16:22:27 -0500
Subject: [R-pkg-devel] How to use O4 flag in an RCpp project?
In-Reply-To: <CALMBL3VNg1Vq2wN_-xV6NKqLVGR3oLiX92tMhx4U9kR0YNHzmA@mail.gmail.com>
References: <CALMBL3V+6GZ6HqJ7NUN3Hru=PKwpkDa-_xyJL0Ef1b0wGdpLvA@mail.gmail.com>
 <26669.52260.569090.49962@rob.eddelbuettel.com>
 <CALMBL3XWMwE_4XUWahC3R_YyqiAbG42385h4f2xTCKJG3Y1fSg@mail.gmail.com>
 <26670.12345.711293.546404@rob.eddelbuettel.com>
 <CALMBL3XU9K0Rnwx__C2KutigJbaQU_ArU1Zh5VzqWL6wh_52Pg@mail.gmail.com>
 <CALMBL3Uco9k-FvsOHncPwgLDKFp6dopOggtxGRXSdp5B36SsXA@mail.gmail.com>
 <CAC2h7ut7UXE5zzJSo-CHyMSHd0k_QehasXMuSYeiNiQAQ5F1qw@mail.gmail.com>
 <CALMBL3UL214ZK=zzbxdq3ETrKAgTGFwPA_7AHvWD7KzNH-0DGA@mail.gmail.com>
 <26670.16798.749503.151209@rob.eddelbuettel.com>
 <CALMBL3VNg1Vq2wN_-xV6NKqLVGR3oLiX92tMhx4U9kR0YNHzmA@mail.gmail.com>
Message-ID: <CAC2h7utfDLC795ij0yvR-ZHzmk2dYe9d_ZoR-XEgO=FdZzKsug@mail.gmail.com>

You set the systems compile options when you run configure for R. Like
  .configure \
     CFLAG="-O4"
and then you do the usual
  make
(you need to set a lot more stuff for this to work)

On Wed, May 21, 2025 at 4:17?PM Peiyuan Zhu <garyzhubc at gmail.com> wrote:

> So are you suggesting to make a Make file that can skip the system?s
> setting? I?m not sure what exactly is the solution you?re proposing.
>
> On Wednesday, May 21, 2025, Dirk Eddelbuettel <edd at debian.org> wrote:
>
>>
>> On 21 May 2025 at 13:55, Peiyuan Zhu wrote:
>> | Thanks Kasper, but I don?t know how exactly to accomplish this. As Dirk
>> says
>> | the system overwrites it every time.
>>
>> That is *not* what Dirk said.
>>
>> Dirk
>>
>> --
>> dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org
>>
>

-- 
Best,
Kasper

	[[alternative HTML version deleted]]


From g@ryzhubc @end|ng |rom gm@||@com  Thu May 22 04:46:42 2025
From: g@ryzhubc @end|ng |rom gm@||@com (Peiyuan Zhu)
Date: Wed, 21 May 2025 19:46:42 -0700
Subject: [R-pkg-devel] How to use O4 flag in an RCpp project?
In-Reply-To: <CALMBL3XBNkUBe0z-QKY6J3eXufLqGM21kAXQN1PmbQsK=NOxpA@mail.gmail.com>
References: <CALMBL3V+6GZ6HqJ7NUN3Hru=PKwpkDa-_xyJL0Ef1b0wGdpLvA@mail.gmail.com>
 <26669.52260.569090.49962@rob.eddelbuettel.com>
 <CALMBL3XWMwE_4XUWahC3R_YyqiAbG42385h4f2xTCKJG3Y1fSg@mail.gmail.com>
 <26670.12345.711293.546404@rob.eddelbuettel.com>
 <CALMBL3XU9K0Rnwx__C2KutigJbaQU_ArU1Zh5VzqWL6wh_52Pg@mail.gmail.com>
 <CALMBL3Uco9k-FvsOHncPwgLDKFp6dopOggtxGRXSdp5B36SsXA@mail.gmail.com>
 <CAC2h7ut7UXE5zzJSo-CHyMSHd0k_QehasXMuSYeiNiQAQ5F1qw@mail.gmail.com>
 <CALMBL3UL214ZK=zzbxdq3ETrKAgTGFwPA_7AHvWD7KzNH-0DGA@mail.gmail.com>
 <26670.16798.749503.151209@rob.eddelbuettel.com>
 <CAJXgQP2tsngt7JE-B-KkB41_LG4qUQVReTeGrAsjmhNarZ_3pw@mail.gmail.com>
 <CALMBL3X0mu1kHu6WLn2=bBsHBsvcs=kNFwOFMVH3dZ6WPY+eiw@mail.gmail.com>
 <CALMBL3USK5Yu_sdOX_Gjuv4FVHQ6n2Y_Y037n9gLS1jdHk+MNg@mail.gmail.com>
 <CALMBL3XBNkUBe0z-QKY6J3eXufLqGM21kAXQN1PmbQsK=NOxpA@mail.gmail.com>
Message-ID: <CALMBL3WGkPi2UjtjVLZt-_A7FZBTZnDTEzg95AHMAqCh_pe1sw@mail.gmail.com>

Doing dry-run gives:

[zhupy at cedar1 src]$ R CMD SHLIB --dry-run closure.cpp

[mii] *Please select a module to run *R*:*

*       MODULE       PARENT(S)*

    1  r/4.4.0      StdEnv/2023

    2  r/4.3.1      StdEnv/2023

    3  r/4.3.1      StdEnv/2020

    4  r/4.2.2      StdEnv/2020

    5  r/4.2.1      StdEnv/2020

    6  r/4.1.2      StdEnv/2020

    7  r/4.1.0      StdEnv/2020

    8  r/4.0.5      StdEnv/2020

    9  r/4.0.2      StdEnv/2020

    10 r/4.0.0      StdEnv/2020

    11 sagemath/9.3 StdEnv/2020

Make a selection (1-11, q aborts) [1]: 1

[mii] loading StdEnv/2023 r/4.4.0 ...

make cmd is

  make -f 'Makevars' -f '/cvmfs/
soft.computecanada.ca/easybuild/software/2023/x86-64-v3/Compiler/gcccore/r/4.4.0/lib64/R/etc/Makeconf'
-f '/cvmfs/
soft.computecanada.ca/easybuild/software/2023/x86-64-v3/Compiler/gcccore/r/4.4.0/lib64/R/share/make/shlib.mk'
SHLIB_LDFLAGS='$(SHLIB_CXXLDFLAGS)' SHLIB_LD='$(SHLIB_CXXLD)'
SHLIB='closure.so' OBJECTS='closure.o'


make would use

g++ -std=gnu++17 -I"/cvmfs/
soft.computecanada.ca/easybuild/software/2023/x86-64-v3/Compiler/gcccore/r/4.4.0/lib64/R/include"
-DNDEBUG   -I/cvmfs/
soft.computecanada.ca/easybuild/software/2023/x86-64-v3/Core/java/17.0.6/include
-I/cvmfs/
soft.computecanada.ca/easybuild/software/2023/x86-64-v3/Core/flexiblascore/3.3.1/include
-I/cvmfs/
soft.computecanada.ca/easybuild/software/2023/x86-64-v3/Core/flexiblascore/3.3.1/include/flexiblas
-O3 -fpic  -O2 -ftree-vectorize -march=x86-64-v3 -fno-math-errno   -c
closure.cpp -o closure.o

if test  "zclosure.o" != "z"; then \

  echo g++ -std=gnu++17 -shared -L"/cvmfs/
soft.computecanada.ca/easybuild/software/2023/x86-64-v3/Compiler/gcccore/r/4.4.0/lib64/R/lib
"  -o closure.so closure.o    -L"/cvmfs/
soft.computecanada.ca/easybuild/software/2023/x86-64-v3/Compiler/gcccore/r/4.4.0/lib64/R/lib"
-lR; \

  g++ -std=gnu++17 -shared -L"/cvmfs/
soft.computecanada.ca/easybuild/software/2023/x86-64-v3/Compiler/gcccore/r/4.4.0/lib64/R/lib
"  -o closure.so closure.o    -L"/cvmfs/
soft.computecanada.ca/easybuild/software/2023/x86-64-v3/Compiler/gcccore/r/4.4.0/lib64/R/lib"
-lR; \

fi


On Wed, May 21, 2025 at 6:59?PM Peiyuan Zhu <garyzhubc at gmail.com> wrote:

> Unfortunately this still doesn't work.
>
> > devtools::install("/home/zhupy/projects/def-kwalley/zhupy/dst-1")
>
> ?? R CMD build
> ?????????????????????????????????????????????????????????????????
>
> ?  checking for file ?/project/6046455/zhupy/dst-1/DESCRIPTION? (847ms)
>
> ?  preparing ?dst?: (17.8s)
>
> ?  checking DESCRIPTION meta-information ...
>
> ?  cleaning src
>
> ?  checking for LF line-endings in source and make files and shell scripts
> (638ms)
>
> ?  checking for empty or unneeded directories
>
>    Removed empty directory ?dst/.idea?
>
> ?  building ?dst_1.9.0.tar.gz?
>
>    Warning: invalid uid value replaced by that for user 'nobody'
>
>    Warning: invalid gid value replaced by that for user 'nobody'
>
>
>
> Running \
>
>   /cvmfs/
> soft.computecanada.ca/easybuild/software/2023/x86-64-v3/Compiler/gcccore/r/4.4.0/lib64/R/bin/R
> \
>
>   CMD INSTALL /tmp/RtmpwaSy51/dst_1.9.0.tar.gz --install-tests
>
> * installing to library ?/home/zhupy/R/x86_64-pc-linux-gnu-library/4.4?
>
> * installing *source* package ?dst? ...
>
> ** using staged installation
>
> ** libs
>
> using C++ compiler: ?g++ (Gentoo 12.3.1_p20230526 p2) 12.3.1 20230526?
>
> g++ -std=gnu++17 -I"/cvmfs/
> soft.computecanada.ca/easybuild/software/2023/x86-64-v3/Compiler/gcccore/r/4.4.0/lib64/R/include"
> -DNDEBUG  -I'/home/zhupy/R/x86_64-pc-linux-gnu-library/4.4/Rcpp/include'
> -I'/home/zhupy/R/x86_64-pc-linux-gnu-library/4.4/BH/include'
> -I'/home/zhupy/R/x86_64-pc-linux-gnu-library/4.4/RcppProgress/include'
> -I'/home/zhupy/R/x86_64-pc-linux-gnu-library/4.4/RcppArmadillo/include'
> -I/cvmfs/
> soft.computecanada.ca/easybuild/software/2023/x86-64-v3/Core/java/17.0.6/include
> -I/cvmfs/
> soft.computecanada.ca/easybuild/software/2023/x86-64-v3/Core/flexiblascore/3.3.1/include
> -I/cvmfs/
> soft.computecanada.ca/easybuild/software/2023/x86-64-v3/Core/flexiblascore/3.3.1/include/flexiblas
> -O3 -fpic  -O2 -ftree-vectorize -march=x86-64-v3 -fno-math-errno   -c
> RcppExports.cpp -o RcppExports.o
>
> g++ -std=gnu++17 -I"/cvmfs/
> soft.computecanada.ca/easybuild/software/2023/x86-64-v3/Compiler/gcccore/r/4.4.0/lib64/R/include"
> -DNDEBUG  -I'/home/zhupy/R/x86_64-pc-linux-gnu-library/4.4/Rcpp/include'
> -I'/home/zhupy/R/x86_64-pc-linux-gnu-library/4.4/BH/include'
> -I'/home/zhupy/R/x86_64-pc-linux-gnu-library/4.4/RcppProgress/include'
> -I'/home/zhupy/R/x86_64-pc-linux-gnu-library/4.4/RcppArmadillo/include'
> -I/cvmfs/
> soft.computecanada.ca/easybuild/software/2023/x86-64-v3/Core/java/17.0.6/include
> -I/cvmfs/
> soft.computecanada.ca/easybuild/software/2023/x86-64-v3/Core/flexiblascore/3.3.1/include
> -I/cvmfs/
> soft.computecanada.ca/easybuild/software/2023/x86-64-v3/Core/flexiblascore/3.3.1/include/flexiblas
> -O3 -fpic  -O2 -ftree-vectorize -march=x86-64-v3 -fno-math-errno   -c
> belplauHFast.cpp -o belplauHFast.o
>
>
>
> On Wed, May 21, 2025 at 6:50?PM Peiyuan Zhu <garyzhubc at gmail.com> wrote:
>
>> I saw this line from the manual:
>>
>> Flags that are already set (for example in file etcR_ARCH/Makeconf) can
>> be overridden by the environment variable MAKEFLAGS (at least for
>> systems using a POSIX-compliant make), as in (Bourne shell syntax)
>>
>> MAKEFLAGS="CFLAGS=-O3" R CMD SHLIB *.c
>>
>> I can give it a try.
>>
>>
>>
>> On Wed, May 21, 2025 at 6:44?PM Peiyuan Zhu <garyzhubc at gmail.com> wrote:
>>
>>> The manual seems unreadable at this point. Every sentence has at least
>>> two words which I don't understand.
>>>
>>> That said, I was able to find the compiler flags. They're still in
>>> Makeconf in the system. I don't know how I can control this in a package.
>>>
>>> dhcp-128-189-214-31:src garyzhubc$ R CMD SHLIB --dry-run closure.cpp
>>>
>>> make cmd is
>>>
>>>   make -f 'Makevars' -f
>>> '/Library/Frameworks/R.framework/Resources/etc/Makeconf' -f
>>> '/Library/Frameworks/R.framework/Resources/share/make/shlib.mk'
>>> SHLIB_LDFLAGS='$(SHLIB_CXXLDFLAGS)' SHLIB_LD='$(SHLIB_CXXLD)'
>>> SHLIB='closure.so' OBJECTS='closure.o'
>>>
>>>
>>> make would use
>>>
>>> if test  "zclosure.o" != "z"; then \
>>>
>>>   echo clang++ -arch x86_64 -std=gnu++17 -dynamiclib
>>> -Wl,-headerpad_max_install_names -undefined dynamic_lookup
>>> -L"/Library/Frameworks/R.framework/Resources/lib" -L/opt/R/x86_64/lib -o
>>> closure.so closure.o    -F/Library/Frameworks/R.framework/.. -framework
>>> R -Wl,-framework -Wl,CoreFoundation; \
>>>
>>>   clang++ -arch x86_64 -std=gnu++17 -dynamiclib
>>> -Wl,-headerpad_max_install_names -undefined dynamic_lookup
>>> -L"/Library/Frameworks/R.framework/Resources/lib" -L/opt/R/x86_64/lib -o
>>> closure.so closure.o    -F/Library/Frameworks/R.framework/.. -framework
>>> R -Wl,-framework -Wl,CoreFoundation; \
>>>
>>> fi
>>>
>>>
>>>
>>> On Wed, May 21, 2025 at 2:22?PM Kevin Ushey <kevinushey at gmail.com>
>>> wrote:
>>>
>>>> Peiyuan,
>>>>
>>>> Respectfully -- RTFM.
>>>>
>>>> https://cran.r-project.org/doc/manuals/R-exts.html#Using-Makevars
>>>>
>>>> https://cran.r-project.org/doc/manuals/R-admin.html#Customizing-package-compilation
>>>>
>>>> The compilation flags are coming either from your R installation's
>>>> etc/Makeconf, etc/Makevars.site, a user Makevars, or the package's
>>>> Makevars.
>>>>
>>>> You can also use R CMD SHLIB --dry-run to figure out what `make`
>>>> invocation R is using, so you can know where these compiler flags are
>>>> coming from. For example:
>>>>
>>>> $ R CMD SHLIB --dry-run example.cpp
>>>> make cmd is
>>>>   make -f 'Makevars' -f
>>>> '/Library/Frameworks/R.framework/Resources/etc/Makeconf' -f
>>>> '/Library/Frameworks/R.framework/Resources/share/make/shlib.mk' -f
>>>> '/Users/kevin/.R/Makevars' SHLIB_LDFLAGS='$(SHLIB_CXXLDFLAGS)'
>>>> SHLIB_LD='$(SHLIB_CXXLD)' SHLIB='example.so' OBJECTS='example.o'
>>>>
>>>> Kevin
>>>>
>>>> On Wed, May 21, 2025 at 2:12?PM Dirk Eddelbuettel <edd at debian.org>
>>>> wrote:
>>>> >
>>>> >
>>>> > On 21 May 2025 at 13:55, Peiyuan Zhu wrote:
>>>> > | Thanks Kasper, but I don?t know how exactly to accomplish this. As
>>>> Dirk says
>>>> > | the system overwrites it every time.
>>>> >
>>>> > That is *not* what Dirk said.
>>>> >
>>>> > Dirk
>>>> >
>>>> > --
>>>> > dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org
>>>> >
>>>> > ______________________________________________
>>>> > R-package-devel at r-project.org mailing list
>>>> > https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>>
>>>

	[[alternative HTML version deleted]]


From g@ryzhubc @end|ng |rom gm@||@com  Thu May 22 05:02:50 2025
From: g@ryzhubc @end|ng |rom gm@||@com (Peiyuan Zhu)
Date: Wed, 21 May 2025 20:02:50 -0700
Subject: [R-pkg-devel] How to use O4 flag in an RCpp project?
In-Reply-To: <CAJXgQP3fYcHS9rL8fE4xGpSCk+4xo3Whnhx3fnd=vYSwFUTa4A@mail.gmail.com>
References: <CALMBL3V+6GZ6HqJ7NUN3Hru=PKwpkDa-_xyJL0Ef1b0wGdpLvA@mail.gmail.com>
 <26669.52260.569090.49962@rob.eddelbuettel.com>
 <CALMBL3XWMwE_4XUWahC3R_YyqiAbG42385h4f2xTCKJG3Y1fSg@mail.gmail.com>
 <26670.12345.711293.546404@rob.eddelbuettel.com>
 <CALMBL3XU9K0Rnwx__C2KutigJbaQU_ArU1Zh5VzqWL6wh_52Pg@mail.gmail.com>
 <CALMBL3Uco9k-FvsOHncPwgLDKFp6dopOggtxGRXSdp5B36SsXA@mail.gmail.com>
 <CAC2h7ut7UXE5zzJSo-CHyMSHd0k_QehasXMuSYeiNiQAQ5F1qw@mail.gmail.com>
 <CALMBL3UL214ZK=zzbxdq3ETrKAgTGFwPA_7AHvWD7KzNH-0DGA@mail.gmail.com>
 <26670.16798.749503.151209@rob.eddelbuettel.com>
 <CAJXgQP2tsngt7JE-B-KkB41_LG4qUQVReTeGrAsjmhNarZ_3pw@mail.gmail.com>
 <CALMBL3X0mu1kHu6WLn2=bBsHBsvcs=kNFwOFMVH3dZ6WPY+eiw@mail.gmail.com>
 <CALMBL3USK5Yu_sdOX_Gjuv4FVHQ6n2Y_Y037n9gLS1jdHk+MNg@mail.gmail.com>
 <CALMBL3XBNkUBe0z-QKY6J3eXufLqGM21kAXQN1PmbQsK=NOxpA@mail.gmail.com>
 <CAJXgQP3fYcHS9rL8fE4xGpSCk+4xo3Whnhx3fnd=vYSwFUTa4A@mail.gmail.com>
Message-ID: <CALMBL3V+B4m0qNTa2dP9iuRYXV_awvZ1hzBDFnATpEDKu6o5FQ@mail.gmail.com>

Hi Kevin,

This is the package that I'm trying to build:
https://github.com/RAPLER/dst-1. The Makefile is in the src folder. I don't
think I have something like you said in Makevars and DESCRIPTION.

I tried CFLAGS and CXXFLAGS but still the Makeconf flags are used. I have
no control over this Makeconf file as this is read only on Compute Canada.
Same for ~/.R/Makevars.

Best regards,
Gary


On Wed, May 21, 2025 at 7:50?PM Kevin Ushey <kevinushey at gmail.com> wrote:

> > The manual seems unreadable at this point. Every sentence has at least
> two words which I don't understand.
>
> There's definitely a lot to learn if you haven't spent much time in
> this space before. The somewhat short description here is:
>
> - make is a (now somewhat older) program commonly used to build
> software projects; e.g. compile C / C++ sources to object files
> - It commonly accepts flags like CFLAGS, CXXFLAGS, and so on to
> control the flags used during compilation
> - R builds / extends on this by using things like etc/Makeconf +
> Makevars files to define / augment these compiler flags
>
> It will become more familiar with practice.
>
> All that said, I believe you should be able to override these flags by
> setting CFLAGS or CXXFLAGS, either in
>
> - your own ~/.R/Makevars, or
> - your package's src/Makevars
>
> The specific flag you need to set will depend on where the default
> optimization flags are being set, though. For example, in my R
> installation, I have:
>
> $ cat /Library/Frameworks/R.framework/Resources/etc/Makeconf | grep -- -O
> # configure  'FW_VERSION=4.5-arm64' 'CC=clang -arch arm64'
> 'CXX=clang++ -arch arm64' 'OBJC=clang -arch arm64'
> 'FC=/opt/gfortran/bin/gfortran -arch arm64'
> 'CFLAGS=-falign-functions=64 -Wall -g -O2'
> 'CXXFLAGS=-falign-functions=64 -Wall -g -O2'
> 'OBJCFLAGS=-falign-functions=64 -Wall -g -O2' 'FCFLAGS=-Wall -g -O2'
> 'F77FLAGS=-Wall -g -O2' 'LDFLAGS=-L/opt/R/arm64/lib'
> 'CPPFLAGS=-I/opt/R/arm64/include' '--enable-memory-profiling'
> '--enable-R-framework'
> '--with-tcl-config=/opt/R/arm64/lib/tclConfig.sh'
> '--with-tk-config=/opt/R/arm64/lib/tkConfig.sh'
> '--build=aarch64-apple-darwin20' 'build_alias=aarch64-apple-darwin20'
>
> 'PKG_CONFIG_PATH=/usr/lib/pkgconfig:/opt/R/arm64/lib/pkgconfig:/opt/R/arm64/share/pkgconfig:/opt/X11/lib/pkgconfig:/opt/X11/share/pkgconfig'
> CFLAGS = -falign-functions=64 -Wall -g -O2 $(LTO)
> C17FLAGS = -falign-functions=64 -Wall -g -O2 $(LTO)
> C90FLAGS = -falign-functions=64 -Wall -g -O2 $(LTO)
> C99FLAGS = -falign-functions=64 -Wall -g -O2 $(LTO)
> CXXFLAGS = -falign-functions=64 -Wall -g -O2 $(LTO)
> CXX11FLAGS = -falign-functions=64 -Wall -g -O2 $(LTO)
> CXX14FLAGS = -falign-functions=64 -Wall -g -O2 $(LTO)
> CXX17FLAGS = -falign-functions=64 -Wall -g -O2 $(LTO)
> CXX20FLAGS = -falign-functions=64 -Wall -g -O2 $(LTO)
> CXX23FLAGS = -falign-functions=64 -Wall -g -O2 $(LTO)
> FCFLAGS = -Wall -g -O2 $(LTO_FC)
> FFLAGS = -Wall -g -O2 $(LTO_FC)
> OBJCFLAGS = -falign-functions=64 -Wall -g -O2 -fobjc-exceptions $(LTO)
> SAFE_FFLAGS = -Wall -g -O2
>
> Unfortunately, there are a lot of different default flags set
> depending on the C (or C++) standard being used, and that could also
> affect the flags depending on the C / C++ standard required by the
> project you're compiling.
>
> In short, you should try doing something like:
>
>     CFLAGS = -g -O3
>     CXXFLAGS = -g -O3
>
> in either your own ~/.R/Makevars, or your package's src/Makevars.
>
> If that doesn't work, you may need to override one of the variants
> like CXX17FLAGS -- this would depend on if that package has something
> like CXX_STD = <...> in its src/Makevars file, or SystemRequirements:
> C++17 (or similar) in its DESCRIPTION file. (All of this is much
> easier to be concrete about if you can share the package you're trying
> to build.)
>
> Best,
> Kevin
>
> On Wed, May 21, 2025 at 7:00?PM Peiyuan Zhu <garyzhubc at gmail.com> wrote:
> >
> > Unfortunately this still doesn't work.
> >
> > > devtools::install("/home/zhupy/projects/def-kwalley/zhupy/dst-1")
> >
> > ?? R CMD build
> ?????????????????????????????????????????????????????????????????
> >
> > ?  checking for file ?/project/6046455/zhupy/dst-1/DESCRIPTION? (847ms)
> >
> > ?  preparing ?dst?: (17.8s)
> >
> > ?  checking DESCRIPTION meta-information ...
> >
> > ?  cleaning src
> >
> > ?  checking for LF line-endings in source and make files and shell
> scripts (638ms)
> >
> > ?  checking for empty or unneeded directories
> >
> >    Removed empty directory ?dst/.idea?
> >
> > ?  building ?dst_1.9.0.tar.gz?
> >
> >    Warning: invalid uid value replaced by that for user 'nobody'
> >
> >    Warning: invalid gid value replaced by that for user 'nobody'
> >
> >
> >
> > Running \
> >
> >   /cvmfs/
> soft.computecanada.ca/easybuild/software/2023/x86-64-v3/Compiler/gcccore/r/4.4.0/lib64/R/bin/R
> \
> >
> >   CMD INSTALL /tmp/RtmpwaSy51/dst_1.9.0.tar.gz --install-tests
> >
> > * installing to library ?/home/zhupy/R/x86_64-pc-linux-gnu-library/4.4?
> >
> > * installing *source* package ?dst? ...
> >
> > ** using staged installation
> >
> > ** libs
> >
> > using C++ compiler: ?g++ (Gentoo 12.3.1_p20230526 p2) 12.3.1 20230526?
> >
> > g++ -std=gnu++17 -I"/cvmfs/
> soft.computecanada.ca/easybuild/software/2023/x86-64-v3/Compiler/gcccore/r/4.4.0/lib64/R/include"
> -DNDEBUG  -I'/home/zhupy/R/x86_64-pc-linux-gnu-library/4.4/Rcpp/include'
> -I'/home/zhupy/R/x86_64-pc-linux-gnu-library/4.4/BH/include'
> -I'/home/zhupy/R/x86_64-pc-linux-gnu-library/4.4/RcppProgress/include'
> -I'/home/zhupy/R/x86_64-pc-linux-gnu-library/4.4/RcppArmadillo/include'
> -I/cvmfs/
> soft.computecanada.ca/easybuild/software/2023/x86-64-v3/Core/java/17.0.6/include
> -I/cvmfs/
> soft.computecanada.ca/easybuild/software/2023/x86-64-v3/Core/flexiblascore/3.3.1/include
> -I/cvmfs/
> soft.computecanada.ca/easybuild/software/2023/x86-64-v3/Core/flexiblascore/3.3.1/include/flexiblas
>  -O3 -fpic  -O2 -ftree-vectorize -march=x86-64-v3 -fno-math-errno   -c
> RcppExports.cpp -o RcppExports.o
> >
> > g++ -std=gnu++17 -I"/cvmfs/
> soft.computecanada.ca/easybuild/software/2023/x86-64-v3/Compiler/gcccore/r/4.4.0/lib64/R/include"
> -DNDEBUG  -I'/home/zhupy/R/x86_64-pc-linux-gnu-library/4.4/Rcpp/include'
> -I'/home/zhupy/R/x86_64-pc-linux-gnu-library/4.4/BH/include'
> -I'/home/zhupy/R/x86_64-pc-linux-gnu-library/4.4/RcppProgress/include'
> -I'/home/zhupy/R/x86_64-pc-linux-gnu-library/4.4/RcppArmadillo/include'
> -I/cvmfs/
> soft.computecanada.ca/easybuild/software/2023/x86-64-v3/Core/java/17.0.6/include
> -I/cvmfs/
> soft.computecanada.ca/easybuild/software/2023/x86-64-v3/Core/flexiblascore/3.3.1/include
> -I/cvmfs/
> soft.computecanada.ca/easybuild/software/2023/x86-64-v3/Core/flexiblascore/3.3.1/include/flexiblas
>  -O3 -fpic  -O2 -ftree-vectorize -march=x86-64-v3 -fno-math-errno   -c
> belplauHFast.cpp -o belplauHFast.o
> >
> >
> >
> > On Wed, May 21, 2025 at 6:50?PM Peiyuan Zhu <garyzhubc at gmail.com> wrote:
> >>
> >> I saw this line from the manual:
> >>
> >> Flags that are already set (for example in file etcR_ARCH/Makeconf) can
> be overridden by the environment variable MAKEFLAGS (at least for systems
> using a POSIX-compliant make), as in (Bourne shell syntax)
> >>
> >> MAKEFLAGS="CFLAGS=-O3" R CMD SHLIB *.c
> >>
> >> I can give it a try.
> >>
> >>
> >>
> >> On Wed, May 21, 2025 at 6:44?PM Peiyuan Zhu <garyzhubc at gmail.com>
> wrote:
> >>>
> >>> The manual seems unreadable at this point. Every sentence has at least
> two words which I don't understand.
> >>>
> >>> That said, I was able to find the compiler flags. They're still in
> Makeconf in the system. I don't know how I can control this in a package.
> >>>
> >>> dhcp-128-189-214-31:src garyzhubc$ R CMD SHLIB --dry-run closure.cpp
> >>>
> >>> make cmd is
> >>>
> >>>   make -f 'Makevars' -f
> '/Library/Frameworks/R.framework/Resources/etc/Makeconf' -f
> '/Library/Frameworks/R.framework/Resources/share/make/shlib.mk'
> SHLIB_LDFLAGS='$(SHLIB_CXXLDFLAGS)' SHLIB_LD='$(SHLIB_CXXLD)'
> SHLIB='closure.so' OBJECTS='closure.o'
> >>>
> >>>
> >>> make would use
> >>>
> >>> if test  "zclosure.o" != "z"; then \
> >>>
> >>>   echo clang++ -arch x86_64 -std=gnu++17 -dynamiclib
> -Wl,-headerpad_max_install_names -undefined dynamic_lookup
> -L"/Library/Frameworks/R.framework/Resources/lib" -L/opt/R/x86_64/lib -o
> closure.so closure.o    -F/Library/Frameworks/R.framework/.. -framework R
> -Wl,-framework -Wl,CoreFoundation; \
> >>>
> >>>   clang++ -arch x86_64 -std=gnu++17 -dynamiclib
> -Wl,-headerpad_max_install_names -undefined dynamic_lookup
> -L"/Library/Frameworks/R.framework/Resources/lib" -L/opt/R/x86_64/lib -o
> closure.so closure.o    -F/Library/Frameworks/R.framework/.. -framework R
> -Wl,-framework -Wl,CoreFoundation; \
> >>>
> >>> fi
> >>>
> >>>
> >>>
> >>>
> >>> On Wed, May 21, 2025 at 2:22?PM Kevin Ushey <kevinushey at gmail.com>
> wrote:
> >>>>
> >>>> Peiyuan,
> >>>>
> >>>> Respectfully -- RTFM.
> >>>>
> >>>> https://cran.r-project.org/doc/manuals/R-exts.html#Using-Makevars
> >>>>
> https://cran.r-project.org/doc/manuals/R-admin.html#Customizing-package-compilation
> >>>>
> >>>> The compilation flags are coming either from your R installation's
> >>>> etc/Makeconf, etc/Makevars.site, a user Makevars, or the package's
> >>>> Makevars.
> >>>>
> >>>> You can also use R CMD SHLIB --dry-run to figure out what `make`
> >>>> invocation R is using, so you can know where these compiler flags are
> >>>> coming from. For example:
> >>>>
> >>>> $ R CMD SHLIB --dry-run example.cpp
> >>>> make cmd is
> >>>>   make -f 'Makevars' -f
> >>>> '/Library/Frameworks/R.framework/Resources/etc/Makeconf' -f
> >>>> '/Library/Frameworks/R.framework/Resources/share/make/shlib.mk' -f
> >>>> '/Users/kevin/.R/Makevars' SHLIB_LDFLAGS='$(SHLIB_CXXLDFLAGS)'
> >>>> SHLIB_LD='$(SHLIB_CXXLD)' SHLIB='example.so' OBJECTS='example.o'
> >>>>
> >>>> Kevin
> >>>>
> >>>> On Wed, May 21, 2025 at 2:12?PM Dirk Eddelbuettel <edd at debian.org>
> wrote:
> >>>> >
> >>>> >
> >>>> > On 21 May 2025 at 13:55, Peiyuan Zhu wrote:
> >>>> > | Thanks Kasper, but I don?t know how exactly to accomplish this.
> As Dirk says
> >>>> > | the system overwrites it every time.
> >>>> >
> >>>> > That is *not* what Dirk said.
> >>>> >
> >>>> > Dirk
> >>>> >
> >>>> > --
> >>>> > dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org
> >>>> >
> >>>> > ______________________________________________
> >>>> > R-package-devel at r-project.org mailing list
> >>>> > https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From g@ryzhubc @end|ng |rom gm@||@com  Thu May 22 06:04:34 2025
From: g@ryzhubc @end|ng |rom gm@||@com (Peiyuan Zhu)
Date: Wed, 21 May 2025 21:04:34 -0700
Subject: [R-pkg-devel] Fwd:  How to use O4 flag in an RCpp project?
In-Reply-To: <CAJXgQP1fH6aKHEfCj5f=PyWQvAMGupyKTYa6aGs2gyyKUE+4jg@mail.gmail.com>
References: <CALMBL3V+6GZ6HqJ7NUN3Hru=PKwpkDa-_xyJL0Ef1b0wGdpLvA@mail.gmail.com>
 <26669.52260.569090.49962@rob.eddelbuettel.com>
 <CALMBL3XWMwE_4XUWahC3R_YyqiAbG42385h4f2xTCKJG3Y1fSg@mail.gmail.com>
 <26670.12345.711293.546404@rob.eddelbuettel.com>
 <CALMBL3XU9K0Rnwx__C2KutigJbaQU_ArU1Zh5VzqWL6wh_52Pg@mail.gmail.com>
 <CALMBL3Uco9k-FvsOHncPwgLDKFp6dopOggtxGRXSdp5B36SsXA@mail.gmail.com>
 <CAC2h7ut7UXE5zzJSo-CHyMSHd0k_QehasXMuSYeiNiQAQ5F1qw@mail.gmail.com>
 <CALMBL3UL214ZK=zzbxdq3ETrKAgTGFwPA_7AHvWD7KzNH-0DGA@mail.gmail.com>
 <26670.16798.749503.151209@rob.eddelbuettel.com>
 <CAJXgQP2tsngt7JE-B-KkB41_LG4qUQVReTeGrAsjmhNarZ_3pw@mail.gmail.com>
 <CALMBL3X0mu1kHu6WLn2=bBsHBsvcs=kNFwOFMVH3dZ6WPY+eiw@mail.gmail.com>
 <CALMBL3USK5Yu_sdOX_Gjuv4FVHQ6n2Y_Y037n9gLS1jdHk+MNg@mail.gmail.com>
 <CALMBL3XBNkUBe0z-QKY6J3eXufLqGM21kAXQN1PmbQsK=NOxpA@mail.gmail.com>
 <CAJXgQP3fYcHS9rL8fE4xGpSCk+4xo3Whnhx3fnd=vYSwFUTa4A@mail.gmail.com>
 <CALMBL3V+B4m0qNTa2dP9iuRYXV_awvZ1hzBDFnATpEDKu6o5FQ@mail.gmail.com>
 <CAJXgQP1fH6aKHEfCj5f=PyWQvAMGupyKTYa6aGs2gyyKUE+4jg@mail.gmail.com>
Message-ID: <CALMBL3XiFNhXS6G4y-Qes_Asgf=k3LqMncR8+P-JFP644diN2A@mail.gmail.com>

Thanks Kevin, I tried both options and it seems to have worked. Not sure
which one actually got it work.

Claude, Maybe now you can test the new Makevar on your end. Let me know how
it goes.

---------- Forwarded message ---------
From: Kevin Ushey <kevinushey at gmail.com>
Date: Wed, May 21, 2025 at 8:26?PM
Subject: Re: [R-pkg-devel] How to use O4 flag in an RCpp project?
To: Peiyuan Zhu <garyzhubc at gmail.com>


If that's the case, then I think you may need to set the requisite
flags in your own file at `~/.R/Makevars`. I had thought you would be
able to override CFLAGS and CXXFLAGS via a package's own src/Makevars,
but that seems to not be the case. Fortunately, you can override that
in your own user Makevars file.

Alternatively, you can try setting something like this in your
package's src/Makevars:

    CXX_DEFS = -O3

and those flags should be added after (rather than before) the default
compilation flags. I believe this would only work for recent versions
of R though.

Alternatively, you can manually force this by installing the package
with the MAKEFLAGS environment variable set appropriately; e.g.

> Sys.setenv(MAKEFLAGS = "CXXFLAGS+=-O3")
> remotes::install_github("RAPLER/dst-1")

Best,
Kevin

On Wed, May 21, 2025 at 8:03?PM Peiyuan Zhu <garyzhubc at gmail.com> wrote:
>
> Hi Kevin,
>
> This is the package that I'm trying to build:
https://github.com/RAPLER/dst-1. The Makefile is in the src folder. I don't
think I have something like you said in Makevars and DESCRIPTION.
>
> I tried CFLAGS and CXXFLAGS but still the Makeconf flags are used. I have
no control over this Makeconf file as this is read only on Compute Canada.
Same for ~/.R/Makevars.
>
> Best regards,
> Gary
>
>
> On Wed, May 21, 2025 at 7:50?PM Kevin Ushey <kevinushey at gmail.com> wrote:
>>
>> > The manual seems unreadable at this point. Every sentence has at least
two words which I don't understand.
>>
>> There's definitely a lot to learn if you haven't spent much time in
>> this space before. The somewhat short description here is:
>>
>> - make is a (now somewhat older) program commonly used to build
>> software projects; e.g. compile C / C++ sources to object files
>> - It commonly accepts flags like CFLAGS, CXXFLAGS, and so on to
>> control the flags used during compilation
>> - R builds / extends on this by using things like etc/Makeconf +
>> Makevars files to define / augment these compiler flags
>>
>> It will become more familiar with practice.
>>
>> All that said, I believe you should be able to override these flags by
>> setting CFLAGS or CXXFLAGS, either in
>>
>> - your own ~/.R/Makevars, or
>> - your package's src/Makevars
>>
>> The specific flag you need to set will depend on where the default
>> optimization flags are being set, though. For example, in my R
>> installation, I have:
>>
>> $ cat /Library/Frameworks/R.framework/Resources/etc/Makeconf | grep -- -O
>> # configure  'FW_VERSION=4.5-arm64' 'CC=clang -arch arm64'
>> 'CXX=clang++ -arch arm64' 'OBJC=clang -arch arm64'
>> 'FC=/opt/gfortran/bin/gfortran -arch arm64'
>> 'CFLAGS=-falign-functions=64 -Wall -g -O2'
>> 'CXXFLAGS=-falign-functions=64 -Wall -g -O2'
>> 'OBJCFLAGS=-falign-functions=64 -Wall -g -O2' 'FCFLAGS=-Wall -g -O2'
>> 'F77FLAGS=-Wall -g -O2' 'LDFLAGS=-L/opt/R/arm64/lib'
>> 'CPPFLAGS=-I/opt/R/arm64/include' '--enable-memory-profiling'
>> '--enable-R-framework'
>> '--with-tcl-config=/opt/R/arm64/lib/tclConfig.sh'
>> '--with-tk-config=/opt/R/arm64/lib/tkConfig.sh'
>> '--build=aarch64-apple-darwin20' 'build_alias=aarch64-apple-darwin20'
>>
'PKG_CONFIG_PATH=/usr/lib/pkgconfig:/opt/R/arm64/lib/pkgconfig:/opt/R/arm64/share/pkgconfig:/opt/X11/lib/pkgconfig:/opt/X11/share/pkgconfig'
>> CFLAGS = -falign-functions=64 -Wall -g -O2 $(LTO)
>> C17FLAGS = -falign-functions=64 -Wall -g -O2 $(LTO)
>> C90FLAGS = -falign-functions=64 -Wall -g -O2 $(LTO)
>> C99FLAGS = -falign-functions=64 -Wall -g -O2 $(LTO)
>> CXXFLAGS = -falign-functions=64 -Wall -g -O2 $(LTO)
>> CXX11FLAGS = -falign-functions=64 -Wall -g -O2 $(LTO)
>> CXX14FLAGS = -falign-functions=64 -Wall -g -O2 $(LTO)
>> CXX17FLAGS = -falign-functions=64 -Wall -g -O2 $(LTO)
>> CXX20FLAGS = -falign-functions=64 -Wall -g -O2 $(LTO)
>> CXX23FLAGS = -falign-functions=64 -Wall -g -O2 $(LTO)
>> FCFLAGS = -Wall -g -O2 $(LTO_FC)
>> FFLAGS = -Wall -g -O2 $(LTO_FC)
>> OBJCFLAGS = -falign-functions=64 -Wall -g -O2 -fobjc-exceptions $(LTO)
>> SAFE_FFLAGS = -Wall -g -O2
>>
>> Unfortunately, there are a lot of different default flags set
>> depending on the C (or C++) standard being used, and that could also
>> affect the flags depending on the C / C++ standard required by the
>> project you're compiling.
>>
>> In short, you should try doing something like:
>>
>>     CFLAGS = -g -O3
>>     CXXFLAGS = -g -O3
>>
>> in either your own ~/.R/Makevars, or your package's src/Makevars.
>>
>> If that doesn't work, you may need to override one of the variants
>> like CXX17FLAGS -- this would depend on if that package has something
>> like CXX_STD = <...> in its src/Makevars file, or SystemRequirements:
>> C++17 (or similar) in its DESCRIPTION file. (All of this is much
>> easier to be concrete about if you can share the package you're trying
>> to build.)
>>
>> Best,
>> Kevin
>>
>> On Wed, May 21, 2025 at 7:00?PM Peiyuan Zhu <garyzhubc at gmail.com> wrote:
>> >
>> > Unfortunately this still doesn't work.
>> >
>> > > devtools::install("/home/zhupy/projects/def-kwalley/zhupy/dst-1")
>> >
>> > ?? R CMD build
?????????????????????????????????????????????????????????????????
>> >
>> > ?  checking for file ?/project/6046455/zhupy/dst-1/DESCRIPTION? (847ms)
>> >
>> > ?  preparing ?dst?: (17.8s)
>> >
>> > ?  checking DESCRIPTION meta-information ...
>> >
>> > ?  cleaning src
>> >
>> > ?  checking for LF line-endings in source and make files and shell
scripts (638ms)
>> >
>> > ?  checking for empty or unneeded directories
>> >
>> >    Removed empty directory ?dst/.idea?
>> >
>> > ?  building ?dst_1.9.0.tar.gz?
>> >
>> >    Warning: invalid uid value replaced by that for user 'nobody'
>> >
>> >    Warning: invalid gid value replaced by that for user 'nobody'
>> >
>> >
>> >
>> > Running \
>> >
>> >   /cvmfs/
soft.computecanada.ca/easybuild/software/2023/x86-64-v3/Compiler/gcccore/r/4.4.0/lib64/R/bin/R
\
>> >
>> >   CMD INSTALL /tmp/RtmpwaSy51/dst_1.9.0.tar.gz --install-tests
>> >
>> > * installing to library ?/home/zhupy/R/x86_64-pc-linux-gnu-library/4.4?
>> >
>> > * installing *source* package ?dst? ...
>> >
>> > ** using staged installation
>> >
>> > ** libs
>> >
>> > using C++ compiler: ?g++ (Gentoo 12.3.1_p20230526 p2) 12.3.1 20230526?
>> >
>> > g++ -std=gnu++17 -I"/cvmfs/
soft.computecanada.ca/easybuild/software/2023/x86-64-v3/Compiler/gcccore/r/4.4.0/lib64/R/include"
-DNDEBUG  -I'/home/zhupy/R/x86_64-pc-linux-gnu-library/4.4/Rcpp/include'
-I'/home/zhupy/R/x86_64-pc-linux-gnu-library/4.4/BH/include'
-I'/home/zhupy/R/x86_64-pc-linux-gnu-library/4.4/RcppProgress/include'
-I'/home/zhupy/R/x86_64-pc-linux-gnu-library/4.4/RcppArmadillo/include'
-I/cvmfs/
soft.computecanada.ca/easybuild/software/2023/x86-64-v3/Core/java/17.0.6/include
-I/cvmfs/
soft.computecanada.ca/easybuild/software/2023/x86-64-v3/Core/flexiblascore/3.3.1/include
-I/cvmfs/
soft.computecanada.ca/easybuild/software/2023/x86-64-v3/Core/flexiblascore/3.3.1/include/flexiblas
 -O3 -fpic  -O2 -ftree-vectorize -march=x86-64-v3 -fno-math-errno   -c
RcppExports.cpp -o RcppExports.o
>> >
>> > g++ -std=gnu++17 -I"/cvmfs/
soft.computecanada.ca/easybuild/software/2023/x86-64-v3/Compiler/gcccore/r/4.4.0/lib64/R/include"
-DNDEBUG  -I'/home/zhupy/R/x86_64-pc-linux-gnu-library/4.4/Rcpp/include'
-I'/home/zhupy/R/x86_64-pc-linux-gnu-library/4.4/BH/include'
-I'/home/zhupy/R/x86_64-pc-linux-gnu-library/4.4/RcppProgress/include'
-I'/home/zhupy/R/x86_64-pc-linux-gnu-library/4.4/RcppArmadillo/include'
-I/cvmfs/
soft.computecanada.ca/easybuild/software/2023/x86-64-v3/Core/java/17.0.6/include
-I/cvmfs/
soft.computecanada.ca/easybuild/software/2023/x86-64-v3/Core/flexiblascore/3.3.1/include
-I/cvmfs/
soft.computecanada.ca/easybuild/software/2023/x86-64-v3/Core/flexiblascore/3.3.1/include/flexiblas
 -O3 -fpic  -O2 -ftree-vectorize -march=x86-64-v3 -fno-math-errno   -c
belplauHFast.cpp -o belplauHFast.o
>> >
>> >
>> >
>> > On Wed, May 21, 2025 at 6:50?PM Peiyuan Zhu <garyzhubc at gmail.com>
wrote:
>> >>
>> >> I saw this line from the manual:
>> >>
>> >> Flags that are already set (for example in file etcR_ARCH/Makeconf)
can be overridden by the environment variable MAKEFLAGS (at least for
systems using a POSIX-compliant make), as in (Bourne shell syntax)
>> >>
>> >> MAKEFLAGS="CFLAGS=-O3" R CMD SHLIB *.c
>> >>
>> >> I can give it a try.
>> >>
>> >>
>> >>
>> >> On Wed, May 21, 2025 at 6:44?PM Peiyuan Zhu <garyzhubc at gmail.com>
wrote:
>> >>>
>> >>> The manual seems unreadable at this point. Every sentence has at
least two words which I don't understand.
>> >>>
>> >>> That said, I was able to find the compiler flags. They're still in
Makeconf in the system. I don't know how I can control this in a package.
>> >>>
>> >>> dhcp-128-189-214-31:src garyzhubc$ R CMD SHLIB --dry-run closure.cpp
>> >>>
>> >>> make cmd is
>> >>>
>> >>>   make -f 'Makevars' -f
'/Library/Frameworks/R.framework/Resources/etc/Makeconf' -f
'/Library/Frameworks/R.framework/Resources/share/make/shlib.mk'
SHLIB_LDFLAGS='$(SHLIB_CXXLDFLAGS)' SHLIB_LD='$(SHLIB_CXXLD)'
SHLIB='closure.so' OBJECTS='closure.o'
>> >>>
>> >>>
>> >>> make would use
>> >>>
>> >>> if test  "zclosure.o" != "z"; then \
>> >>>
>> >>>   echo clang++ -arch x86_64 -std=gnu++17 -dynamiclib
-Wl,-headerpad_max_install_names -undefined dynamic_lookup
-L"/Library/Frameworks/R.framework/Resources/lib" -L/opt/R/x86_64/lib -o
closure.so closure.o    -F/Library/Frameworks/R.framework/.. -framework R
-Wl,-framework -Wl,CoreFoundation; \
>> >>>
>> >>>   clang++ -arch x86_64 -std=gnu++17 -dynamiclib
-Wl,-headerpad_max_install_names -undefined dynamic_lookup
-L"/Library/Frameworks/R.framework/Resources/lib" -L/opt/R/x86_64/lib -o
closure.so closure.o    -F/Library/Frameworks/R.framework/.. -framework R
-Wl,-framework -Wl,CoreFoundation; \
>> >>>
>> >>> fi
>> >>>
>> >>>
>> >>>
>> >>>
>> >>> On Wed, May 21, 2025 at 2:22?PM Kevin Ushey <kevinushey at gmail.com>
wrote:
>> >>>>
>> >>>> Peiyuan,
>> >>>>
>> >>>> Respectfully -- RTFM.
>> >>>>
>> >>>> https://cran.r-project.org/doc/manuals/R-exts.html#Using-Makevars
>> >>>>
https://cran.r-project.org/doc/manuals/R-admin.html#Customizing-package-compilation
>> >>>>
>> >>>> The compilation flags are coming either from your R installation's
>> >>>> etc/Makeconf, etc/Makevars.site, a user Makevars, or the package's
>> >>>> Makevars.
>> >>>>
>> >>>> You can also use R CMD SHLIB --dry-run to figure out what `make`
>> >>>> invocation R is using, so you can know where these compiler flags
are
>> >>>> coming from. For example:
>> >>>>
>> >>>> $ R CMD SHLIB --dry-run example.cpp
>> >>>> make cmd is
>> >>>>   make -f 'Makevars' -f
>> >>>> '/Library/Frameworks/R.framework/Resources/etc/Makeconf' -f
>> >>>> '/Library/Frameworks/R.framework/Resources/share/make/shlib.mk' -f
>> >>>> '/Users/kevin/.R/Makevars' SHLIB_LDFLAGS='$(SHLIB_CXXLDFLAGS)'
>> >>>> SHLIB_LD='$(SHLIB_CXXLD)' SHLIB='example.so' OBJECTS='example.o'
>> >>>>
>> >>>> Kevin
>> >>>>
>> >>>> On Wed, May 21, 2025 at 2:12?PM Dirk Eddelbuettel <edd at debian.org>
wrote:
>> >>>> >
>> >>>> >
>> >>>> > On 21 May 2025 at 13:55, Peiyuan Zhu wrote:
>> >>>> > | Thanks Kasper, but I don?t know how exactly to accomplish this.
As Dirk says
>> >>>> > | the system overwrites it every time.
>> >>>> >
>> >>>> > That is *not* what Dirk said.
>> >>>> >
>> >>>> > Dirk
>> >>>> >
>> >>>> > --
>> >>>> > dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org
>> >>>> >
>> >>>> > ______________________________________________
>> >>>> > R-package-devel at r-project.org mailing list
>> >>>> > https://stat.ethz.ch/mailman/listinfo/r-package-devel

	[[alternative HTML version deleted]]


From N||@@Lue@chow @end|ng |rom un|-due@@e|dor|@de  Sun May 25 14:18:34 2025
From: N||@@Lue@chow @end|ng |rom un|-due@@e|dor|@de (=?UTF-8?Q?Nils_L=C3=BCschow?=)
Date: Sun, 25 May 2025 14:18:34 +0200
Subject: [R-pkg-devel] 
 [Extern] Re: Problem building package depending on
 third party c++ source library.
Message-ID: <d53d856c-2ed8-415d-8cf2-b3d80747cff4@uni-duesseldorf.de>

Thank you very much for the very detailed response!

Using your Makevars I got Gecode to compile and the package to build on
windows. In my case I had to adjust a part of the configure script
responsible for choosing the thread-model used, as the script did not
directly check for the host-os but rather available libraries (which
lead to a problem in my case as the pthreads library itself was
available, however, it is not the correct choice for windows).

After that I ran the CRAN checks, interestingly not yielding the "array
subscript -1 is below array bounds" warning (which should, however,
indeed just be a false positive). Regarding the "mismatched-new-delete"
warning I am also relatively sure that this is actually a false
positive. Taking a look into the stack-trace, the new and delete
operators are actually overloaded with functions that internally use
malloc and free, hence, there is no mismatch:

void*
BoolExpr::Node::operatornew(size_tsize) {
returnheap.ralloc(size);
  ? }
void
BoolExpr::Node::operatordelete(void*p, size_t) {
heap.rfree(p);
  ? }

BoolExpr::BoolExpr(void) : n(newNode) {}

The methods on heap then refer to an allocator where malloc and free are
used. What would be the course of action with warnings like this, can I
just suppress them with something like|:|
|#pragma GCC diagnostic ignored "-Wmismatched-new-delete"|

- and would this still be tolerated by CRAN?

Best,
Nils

Am 30.04.2025 um 20:57 schrieb Ivan Krylov:

> ? Tue, 29 Apr 2025 14:43:40 +0200
> Nils L?schow<Nils.Lueschow at uni-duesseldorf.de> ?????:
>
>> While we generally got this feature to work when Gecode is
>> pre-installed on the system, we would like to spare the users this
>> step and include it with the package
> It's probably a good idea to try to achieve both. If a system copy of
> the package is available, link with it; otherwise build the bundled
> copy. Unfortunately, this kind of user convenience involves a lot of
> testing to make sure that both configurations work as intended.
> Bundling dependencies also creates headaches for distro packagers.
>
>> However, we run into a problem when it comes to compiling Gecode
>> during the packages build-process, which I describe in this SO post
> One problem is that when using $(MAKE) to compile gecode, various
> variables used by gecode's Makefile are overridden through the
> MAKEFLAGS variable. For example, $(CXX) ends up being defined as
> $(CXX20) $(CXX20STD) without the variables CXX20 and CXX20STD being
> available to the downstream Make process. What's worse is CXXFLAGS are
> also overridden, losing the include paths in the process.
>
> In order to build gecode from Makevars, you'll have to disable these
> overrides by emptying MAKEFLAGS:
>
> build_gecode:
>           cd $(GECODE_DIR) && \
> 	./configure CC="$(CC)" CXX="$(CXX20) $(CXX20STD)" \
> 		--disable-examples --enable-static --disable-shared
> 	$(MAKE) -C $(GECODE_DIR) MAKEFLAGS=
>
> (Alternatively, you can ./configure and build the library from the
> ./configure script of your package.)
>
> Other changes are also needed to make the package build in a portable
> manner:
>
>    - Recipe lines in Makefiles must start with tabs, not groups of
>      four spaces.
>    - Don't use GNU Make append syntax (+=) without declaring
>      SystemRequirements: GNU Make.
>    - Don't set compiler-specific flags such as -mtune=native without at
>      least testing that the compiler understands them.
>    - With the current directory structure, GECODE_DIR must be just
>      gecode, not $(CURDIR)/gecode-release-6.3.0.
>    - Since the C++ source code already uses #include <gecode/...>, the
>      include path must be -I$(GECODE_DIR), not -I$(GECODE_DIR)/gecode.
>    - Don't hard-code compiler names. Instead of ./configure CC=gcc ...,
>      use ./configure CC="$(CC)" CXX="$(CXX20) $(CXX20STD)".
>    - Build gecode as a static library and link it into the package
>      shared library. Otherwise you'll need to arrange for the gecode
>      shared libraries to be installed together with the R package and
>      properly loaded before your package shared library.
>    - Provide a 'clean' target so that R CMD build doesn't include the
>      binaries from the gecode subdirectory into the source package.
>
> With that, we get the following Makevars:
>
> all: $(SHLIB)
>
> GECODE_DIR = gecode
> PKG_CPPFLAGS = -I$(GECODE_DIR)
> PKG_LIBS = -L$(GECODE_DIR) -lgecodesearch -lgecodeminimodel \
>              -lgecodeint -lgecodekernel -lgecodesupport
> CXX_STD = CXX20
>
> $(SHLIB): gecode_built
> # package code relies on header files only available after gecode is
> # configured and probably built
> $(OBJECTS): gecode_built
>
> gecode_built:
> 	cd $(GECODE_DIR) && \
> 		./configure CC="$(CC)" CXX="$(CXX20) $(CXX20STD)" \
> 		--disable-examples --enable-static --disable-shared \
> 		--disable-flatzinc --disable-qt
> 	$(MAKE) -C $(GECODE_DIR) MAKEFLAGS=
> 	touch $@
>
> clean:
> 	-cd $(GECODE_DIR) && make clean
> 	-rm -f gecode_built
>
> Hopefully, the Makevars.win with same contents but
> --with-host-os=windows added to the configure flags will work on
> Windows. (It needs to be .win, not .ucrt, because your package declares
> support for R > 3.6, which predates use of UCRT in R. To think of it,
> R-3.6.0 also predates C++20...) You can probably give some more
> --disable-... arguments to ./configure to remove some more components
> that the R package doesn't use.
>
> However, this is only the beginning of the troubles.
>
> R packages are not allowed file path lengths above 100 bytes, and your
> package has seven that are longer, e.g.,
>
>>> RcppTestPackage/src/gecode/gecode/third-party/boost/numeric/interval/detail/x86gcc_rounding_control.hpp
> Maybe you can unbundle the bits of Boost and rely on the 'BH' package
> instead. Maybe there's a way to rename the files and patch the includes
> in the source code.
>
> The gecode library produces a lot of warnings, and R CMD check
> considers some of them serious:
>
>>> Found the following significant warnings:
>>> ./gecode/kernel/core.hpp:4102:24: warning: array subscript -1 is
>>> below array bounds of ?unsigned int [1]? [-Warray-bounds]
>>> ./gecode/kernel/core.hpp:4109:17: warning: array subscript -1 is
>>> below array bounds of ?unsigned int [1]? [-Warray-bounds]
>>> ./gecode/support/allocator.hpp:88:11: warning: ?void free(void*)?
>>> called on pointer returned from a mismatched allocation function
>>> [-Wmismatched-new-delete]
> The -Warray-bounds warnings might be false positives (could pc_max ever
> be 0?), but -Wmismatched-new-delete is probably real; the compiler
> shows a place where an object allocated using new(...) can be
> deallocated using free(...).
>
> Some parts of the gecode library contain references to std::cerr, and
> the R package code calls rand(). These are not recommended in R
> packages, because the standard error stream isn't necessarily connected
> to the terminal and because rand() is disconnected from R's random
> number generator.
>
> Once you build the whole gecode yourself, be ready for it being tested
> with AddressSanitizer and UndefinedBehaviorSanitizer. Things like
> free(new(...)) that were previously invisible to them (due to the
> third-party library being compiled without sanitizers) will now be
> revealed (and become yours to fix instead of just something happening
> upstream).
>
> There are other problems noted by R CMD check, but they should be
> easier to fix.
>
	[[alternative HTML version deleted]]


From m|ch@e|ch|r|co4 @end|ng |rom gm@||@com  Tue May 27 19:38:59 2025
From: m|ch@e|ch|r|co4 @end|ng |rom gm@||@com (Michael Chirico)
Date: Tue, 27 May 2025 10:38:59 -0700
Subject: [R-pkg-devel] Best practices for a contributor who prefers to be
 cited only by their GitHub ID?
Message-ID: <CAPRVBcwOxfnKH9HqwsKKeNN1WkNcKWU6gGAtvfdfiPbUDHfAKQ@mail.gmail.com>

Hello,

We recently started receiving contributions from a user who prefers to
only use their GitHub ID.

I tried this entry in DESCRIPTION (with their actual ID):

person(comment=c(github="@github_user_id"), role="ctb")

But R CMD check complains:

* checking DESCRIPTION meta-information ... NOTE
Authors at R field gives persons with no name:
  [ctb] (github: @github_user_id)

Is this actually disallowed for the 'ctb' role, which does not appear
in the package citation? I can see the need for more transparency
around the 'cre', 'aut', and especially 'cph' roles.

What is the best practice in this case? Should I just write fake
names, or do we require the user to divulge a real name? I don't see
this discussed in WRE or ?person.

Michael Chirico


From jo@|@h@p@rry @end|ng |rom gm@||@com  Wed May 28 00:06:56 2025
From: jo@|@h@p@rry @end|ng |rom gm@||@com (Josiah Parry)
Date: Tue, 27 May 2025 15:06:56 -0700
Subject: [R-pkg-devel] perl = TRUE fails on ubuntu
Message-ID: <CAL3ufUJg9DNVkFy7_oxuyXLXMEOpcj+OGeUpEC7bTiVgb+6ftg@mail.gmail.com>

Hi all,

I've encountered an issue where using `perl = TRUE` for regular expressions
with grepl() causes an error on ubuntu CI runners only.

Is this a known limitation of perl = TRUE for grep and family in base R? Or
is there a suggested workaround?

The issue is specifically with lookbehinds:

PCRE pattern compilation error
'lookbehind assertion is not fixed length'
at '(?<=(FeatureServer|MapServer)/)[0-9]+/?$'

Any guidance would be very much appreciated! I'd like to avoid adding a
stringi dependency if possible.

	[[alternative HTML version deleted]]


From bbo|ker @end|ng |rom gm@||@com  Wed May 28 00:23:08 2025
From: bbo|ker @end|ng |rom gm@||@com (Ben Bolker)
Date: Tue, 27 May 2025 16:23:08 -0600
Subject: [R-pkg-devel] perl = TRUE fails on ubuntu
In-Reply-To: <CAL3ufUJg9DNVkFy7_oxuyXLXMEOpcj+OGeUpEC7bTiVgb+6ftg@mail.gmail.com>
References: <CAL3ufUJg9DNVkFy7_oxuyXLXMEOpcj+OGeUpEC7bTiVgb+6ftg@mail.gmail.com>
Message-ID: <CABghstR+eV+=L1-BU+NY57MoFYPqEOiM+CRvGXy8+5YFavPHCQ@mail.gmail.com>

https://stackoverflow.com/questions/3796436/whats-the-technical-reason-for-lookbehind-assertion-must-be-fixed-length-in-r

On Tue, May 27, 2025, 4:07 PM Josiah Parry <josiah.parry at gmail.com> wrote:

> Hi all,
>
> I've encountered an issue where using `perl = TRUE` for regular expressions
> with grepl() causes an error on ubuntu CI runners only.
>
> Is this a known limitation of perl = TRUE for grep and family in base R? Or
> is there a suggested workaround?
>
> The issue is specifically with lookbehinds:
>
> PCRE pattern compilation error
> 'lookbehind assertion is not fixed length'
> at '(?<=(FeatureServer|MapServer)/)[0-9]+/?$'
>
> Any guidance would be very much appreciated! I'd like to avoid adding a
> stringi dependency if possible.
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From kev|nu@hey @end|ng |rom gm@||@com  Wed May 28 00:24:05 2025
From: kev|nu@hey @end|ng |rom gm@||@com (Kevin Ushey)
Date: Tue, 27 May 2025 15:24:05 -0700
Subject: [R-pkg-devel] perl = TRUE fails on ubuntu
In-Reply-To: <CAL3ufUJg9DNVkFy7_oxuyXLXMEOpcj+OGeUpEC7bTiVgb+6ftg@mail.gmail.com>
References: <CAL3ufUJg9DNVkFy7_oxuyXLXMEOpcj+OGeUpEC7bTiVgb+6ftg@mail.gmail.com>
Message-ID: <CAJXgQP10e0svG5YTsqypqcD+r1wc-ThL6ZN3KsCzPQb+QoMwCA@mail.gmail.com>

Hi Josiah,

Why not share a reprex / something we can copy and paste to directly
reproduce the issue?

In any case, I suspect this depends on the underlying PCRE
implementation, and so isn't really directly an R issue. You might
have luck if you rewrite your regular expression from:

    (?<=(FeatureServer|MapServer)/)[0-9]+/?$

to something like (I didn't count parentheses below so assume I made a mistake)

    (?:(?<=FeatureServer)|(?<=MapServer)))/)[0-9]+/?$

Or, alternatively -- does this really need to be a lookbehind? Can you
just match that text as-is and then capture whatever you happen to
find in front of it?

Best,
Kevin

On Tue, May 27, 2025 at 3:07?PM Josiah Parry <josiah.parry at gmail.com> wrote:
>
> Hi all,
>
> I've encountered an issue where using `perl = TRUE` for regular expressions
> with grepl() causes an error on ubuntu CI runners only.
>
> Is this a known limitation of perl = TRUE for grep and family in base R? Or
> is there a suggested workaround?
>
> The issue is specifically with lookbehinds:
>
> PCRE pattern compilation error
> 'lookbehind assertion is not fixed length'
> at '(?<=(FeatureServer|MapServer)/)[0-9]+/?$'
>
> Any guidance would be very much appreciated! I'd like to avoid adding a
> stringi dependency if possible.
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From jo@|@h@p@rry @end|ng |rom gm@||@com  Wed May 28 00:31:16 2025
From: jo@|@h@p@rry @end|ng |rom gm@||@com (Josiah Parry)
Date: Tue, 27 May 2025 15:31:16 -0700
Subject: [R-pkg-devel] perl = TRUE fails on ubuntu
In-Reply-To: <CAJXgQP10e0svG5YTsqypqcD+r1wc-ThL6ZN3KsCzPQb+QoMwCA@mail.gmail.com>
References: <CAL3ufUJg9DNVkFy7_oxuyXLXMEOpcj+OGeUpEC7bTiVgb+6ftg@mail.gmail.com>
 <CAJXgQP10e0svG5YTsqypqcD+r1wc-ThL6ZN3KsCzPQb+QoMwCA@mail.gmail.com>
Message-ID: <CAL3ufU+Nvfafm=nE4Ho6Sn9XJ0SX-xj2PJM-1v6GdfqU-nx+=Q@mail.gmail.com>

Thanks all!

Kevin, I think you make a really good point that the lookbehind isn't
necessary. If I'm checking for the termination of /[0-9]+$ that is
sufficient to know that the string ends with that pattern.

On Tue, May 27, 2025 at 3:24?PM Kevin Ushey <kevinushey at gmail.com> wrote:

> Hi Josiah,
>
> Why not share a reprex / something we can copy and paste to directly
> reproduce the issue?
>
> In any case, I suspect this depends on the underlying PCRE
> implementation, and so isn't really directly an R issue. You might
> have luck if you rewrite your regular expression from:
>
>     (?<=(FeatureServer|MapServer)/)[0-9]+/?$
>
> to something like (I didn't count parentheses below so assume I made a
> mistake)
>
>     (?:(?<=FeatureServer)|(?<=MapServer)))/)[0-9]+/?$
>
> Or, alternatively -- does this really need to be a lookbehind? Can you
> just match that text as-is and then capture whatever you happen to
> find in front of it?
>
> Best,
> Kevin
>
> On Tue, May 27, 2025 at 3:07?PM Josiah Parry <josiah.parry at gmail.com>
> wrote:
> >
> > Hi all,
> >
> > I've encountered an issue where using `perl = TRUE` for regular
> expressions
> > with grepl() causes an error on ubuntu CI runners only.
> >
> > Is this a known limitation of perl = TRUE for grep and family in base R?
> Or
> > is there a suggested workaround?
> >
> > The issue is specifically with lookbehinds:
> >
> > PCRE pattern compilation error
> > 'lookbehind assertion is not fixed length'
> > at '(?<=(FeatureServer|MapServer)/)[0-9]+/?$'
> >
> > Any guidance would be very much appreciated! I'd like to avoid adding a
> > stringi dependency if possible.
> >
> >         [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-package-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From j|r|@c@mor@vec @end|ng |rom gm@||@com  Wed May 28 01:38:23 2025
From: j|r|@c@mor@vec @end|ng |rom gm@||@com (=?UTF-8?B?SmnFmcOtIE1vcmF2ZWM=?=)
Date: Wed, 28 May 2025 11:38:23 +1200
Subject: [R-pkg-devel] perl = TRUE fails on ubuntu
In-Reply-To: <CAJXgQP10e0svG5YTsqypqcD+r1wc-ThL6ZN3KsCzPQb+QoMwCA@mail.gmail.com>
References: <CAL3ufUJg9DNVkFy7_oxuyXLXMEOpcj+OGeUpEC7bTiVgb+6ftg@mail.gmail.com>
 <CAJXgQP10e0svG5YTsqypqcD+r1wc-ThL6ZN3KsCzPQb+QoMwCA@mail.gmail.com>
Message-ID: <a4afa03a-cc5b-419c-a01d-a96c199beb3c@gmail.com>

I believe the mysterious underused `regexec` is for this:

s = c("foo/bar", "baz/bur", "baz", "bar")
m = regexec("(foo|baz)/(b[au]r)", s)
regmatches(s, m) |> sapply("[", 3)

The `?regex` have some examples for parsing URL using regexec.

-- Jirka

On 28/05/25 10:24, Kevin Ushey wrote:
> Hi Josiah,
>
> Why not share a reprex / something we can copy and paste to directly
> reproduce the issue?
>
> In any case, I suspect this depends on the underlying PCRE
> implementation, and so isn't really directly an R issue. You might
> have luck if you rewrite your regular expression from:
>
>      (?<=(FeatureServer|MapServer)/)[0-9]+/?$
>
> to something like (I didn't count parentheses below so assume I made a mistake)
>
>      (?:(?<=FeatureServer)|(?<=MapServer)))/)[0-9]+/?$
>
> Or, alternatively -- does this really need to be a lookbehind? Can you
> just match that text as-is and then capture whatever you happen to
> find in front of it?
>
> Best,
> Kevin
>
> On Tue, May 27, 2025 at 3:07?PM Josiah Parry <josiah.parry at gmail.com> wrote:
>> Hi all,
>>
>> I've encountered an issue where using `perl = TRUE` for regular expressions
>> with grepl() causes an error on ubuntu CI runners only.
>>
>> Is this a known limitation of perl = TRUE for grep and family in base R? Or
>> is there a suggested workaround?
>>
>> The issue is specifically with lookbehinds:
>>
>> PCRE pattern compilation error
>> 'lookbehind assertion is not fixed length'
>> at '(?<=(FeatureServer|MapServer)/)[0-9]+/?$'
>>
>> Any guidance would be very much appreciated! I'd like to avoid adding a
>> stringi dependency if possible.
>>
>>          [[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From m@ech|er @end|ng |rom @t@t@m@th@ethz@ch  Wed May 28 10:24:48 2025
From: m@ech|er @end|ng |rom @t@t@m@th@ethz@ch (Martin Maechler)
Date: Wed, 28 May 2025 10:24:48 +0200
Subject: [R-pkg-devel] 
 Best practices for a contributor who prefers to be
 cited only by their GitHub ID?
In-Reply-To: <CAPRVBcwOxfnKH9HqwsKKeNN1WkNcKWU6gGAtvfdfiPbUDHfAKQ@mail.gmail.com>
References: <CAPRVBcwOxfnKH9HqwsKKeNN1WkNcKWU6gGAtvfdfiPbUDHfAKQ@mail.gmail.com>
Message-ID: <26678.51280.794210.458395@stat.math.ethz.ch>

>>>>> Michael Chirico 
>>>>>     on Tue, 27 May 2025 10:38:59 -0700 writes:

    > Hello,
    > We recently started receiving contributions from a user who prefers to
    > only use their GitHub ID.

    > I tried this entry in DESCRIPTION (with their actual ID):

    > person(comment=c(github="@github_user_id"), role="ctb")

    > But R CMD check complains:

    > * checking DESCRIPTION meta-information ... NOTE
    > Authors at R field gives persons with no name:
    > [ctb] (github: @github_user_id)

    > Is this actually disallowed for the 'ctb' role, which does not appear
    > in the package citation? I can see the need for more transparency
    > around the 'cre', 'aut', and especially 'cph' roles.

    > What is the best practice in this case? Should I just write fake
    > names, or do we require the user to divulge a real name? I don't see
    > this discussed in WRE or ?person.

    > Michael Chirico

I think this is a very valid question,
and hopefully one we can resolve positively (unfortunately,
I'm not sure this will happen .. given past experiences and
world politic etc ..).

If there's nothing better, using
  "Anonymous", "Contributor",  (before the `comment=<....>` part) 
would work I think
and also not be misleading IMO.

Martin


From bbo|ker @end|ng |rom gm@||@com  Wed May 28 16:21:37 2025
From: bbo|ker @end|ng |rom gm@||@com (Ben Bolker)
Date: Wed, 28 May 2025 10:21:37 -0400
Subject: [R-pkg-devel] 
 Best practices for a contributor who prefers to be
 cited only by their GitHub ID?
In-Reply-To: <26678.51280.794210.458395@stat.math.ethz.ch>
References: <CAPRVBcwOxfnKH9HqwsKKeNN1WkNcKWU6gGAtvfdfiPbUDHfAKQ@mail.gmail.com>
 <26678.51280.794210.458395@stat.math.ethz.ch>
Message-ID: <219cd022-0ffb-40bf-aa0d-1be11ed80f38@gmail.com>

   Hmmm.  Why not

   person(given = "@github_user_id", role = "ctb") ?

   At least at a quick skim, I don't see anything in either _Writing R 
Extensions_ or the CRAN repository policies that gives detailed 
specifications about what's required/recommended in the 'person' field ...

   The closest I can get is ?person, which says

 > For persons which are not natural persons (e.g., institutions, 
companies, etc.) it is appropriate to use ?given? (but not ?family?) for 
the name, e.g., ?person("R Core Team", role = "aut")?.

   A github user presumably *usually* corresponds to a 'natural person' 
(but how would we know?), but it seems as though person() wants "given" 
only to be specified for mononyms <https://en.wikipedia.org/wiki/Mononym>

   I guess someone could dig through DESCRIPTION files on CRAN to see 
how many mononymous people are already listed as contributing to R packages?


On 5/28/25 04:24, Martin Maechler wrote:
>>>>>> Michael Chirico
>>>>>>      on Tue, 27 May 2025 10:38:59 -0700 writes:
> 
>      > Hello,
>      > We recently started receiving contributions from a user who prefers to
>      > only use their GitHub ID.
> 
>      > I tried this entry in DESCRIPTION (with their actual ID):
> 
>      > person(comment=c(github="@github_user_id"), role="ctb")
> 
>      > But R CMD check complains:
> 
>      > * checking DESCRIPTION meta-information ... NOTE
>      > Authors at R field gives persons with no name:
>      > [ctb] (github: @github_user_id)
> 
>      > Is this actually disallowed for the 'ctb' role, which does not appear
>      > in the package citation? I can see the need for more transparency
>      > around the 'cre', 'aut', and especially 'cph' roles.
> 
>      > What is the best practice in this case? Should I just write fake
>      > names, or do we require the user to divulge a real name? I don't see
>      > this discussed in WRE or ?person.
> 
>      > Michael Chirico
> 
> I think this is a very valid question,
> and hopefully one we can resolve positively (unfortunately,
> I'm not sure this will happen .. given past experiences and
> world politic etc ..).
> 
> If there's nothing better, using
>    "Anonymous", "Contributor",  (before the `comment=<....>` part)
> would work I think
> and also not be misleading IMO.
> 
> Martin
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel

-- 
Dr. Benjamin Bolker
Professor, Mathematics & Statistics and Biology, McMaster University
Director, School of Computational Science and Engineering
* E-mail is sent at my convenience; I don't expect replies outside of 
working hours.


From m|ch@e|ch|r|co4 @end|ng |rom gm@||@com  Wed May 28 19:44:55 2025
From: m|ch@e|ch|r|co4 @end|ng |rom gm@||@com (Michael Chirico)
Date: Wed, 28 May 2025 10:44:55 -0700
Subject: [R-pkg-devel] 
 Best practices for a contributor who prefers to be
 cited only by their GitHub ID?
In-Reply-To: <219cd022-0ffb-40bf-aa0d-1be11ed80f38@gmail.com>
References: <CAPRVBcwOxfnKH9HqwsKKeNN1WkNcKWU6gGAtvfdfiPbUDHfAKQ@mail.gmail.com>
 <26678.51280.794210.458395@stat.math.ethz.ch>
 <219cd022-0ffb-40bf-aa0d-1be11ed80f38@gmail.com>
Message-ID: <CAPRVBcwq6=885Kx_jgLnXwaKBgeO+KNYsL-tm6bZYr=PLis5CQ@mail.gmail.com>

Thanks all. I think once we agree (1) real names for 'ctb' are not
required ('encouraged' is probably more accurate) and (2) R CMD check
will continue to emit the 'NOTE', I think there are a few options,
Martin's and Ben's both seem OK.

Ben's suggestion to check the existing author list is good, thankfully
tools::CRAN_authors_db() makes this much simpler.

tools::CRAN_authors_db() |>
  subset(
    role == 'ctb'
    & is.na(family)
    & !given %in% c("R-Core", "R-core")
    & !grepl("[0-9]|\\b([Tt]eam|[Ff]oundation|[Dd]evelopers|[Cc]ontributors|[Aa]uthors)\\b",
given)
  ) |>
  subset(select = c("given", "email", "package"))

I only see one other likely equivalent, namely {wordPuzzleR} has
'@olivory' as 'ctb' [1] (itself a typo (: ).

[1] https://github.com/cran/wordPuzzleR/blob/d28961e0803e57700988f027c246ffb6e2c038ea/DESCRIPTION#L7

On Wed, May 28, 2025 at 7:22?AM Ben Bolker <bbolker at gmail.com> wrote:
>
>    Hmmm.  Why not
>
>    person(given = "@github_user_id", role = "ctb") ?
>
>    At least at a quick skim, I don't see anything in either _Writing R
> Extensions_ or the CRAN repository policies that gives detailed
> specifications about what's required/recommended in the 'person' field ...
>
>    The closest I can get is ?person, which says
>
>  > For persons which are not natural persons (e.g., institutions,
> companies, etc.) it is appropriate to use ?given? (but not ?family?) for
> the name, e.g., ?person("R Core Team", role = "aut")?.
>
>    A github user presumably *usually* corresponds to a 'natural person'
> (but how would we know?), but it seems as though person() wants "given"
> only to be specified for mononyms <https://en.wikipedia.org/wiki/Mononym>
>
>    I guess someone could dig through DESCRIPTION files on CRAN to see
> how many mononymous people are already listed as contributing to R packages?
>
>
> On 5/28/25 04:24, Martin Maechler wrote:
> >>>>>> Michael Chirico
> >>>>>>      on Tue, 27 May 2025 10:38:59 -0700 writes:
> >
> >      > Hello,
> >      > We recently started receiving contributions from a user who prefers to
> >      > only use their GitHub ID.
> >
> >      > I tried this entry in DESCRIPTION (with their actual ID):
> >
> >      > person(comment=c(github="@github_user_id"), role="ctb")
> >
> >      > But R CMD check complains:
> >
> >      > * checking DESCRIPTION meta-information ... NOTE
> >      > Authors at R field gives persons with no name:
> >      > [ctb] (github: @github_user_id)
> >
> >      > Is this actually disallowed for the 'ctb' role, which does not appear
> >      > in the package citation? I can see the need for more transparency
> >      > around the 'cre', 'aut', and especially 'cph' roles.
> >
> >      > What is the best practice in this case? Should I just write fake
> >      > names, or do we require the user to divulge a real name? I don't see
> >      > this discussed in WRE or ?person.
> >
> >      > Michael Chirico
> >
> > I think this is a very valid question,
> > and hopefully one we can resolve positively (unfortunately,
> > I'm not sure this will happen .. given past experiences and
> > world politic etc ..).
> >
> > If there's nothing better, using
> >    "Anonymous", "Contributor",  (before the `comment=<....>` part)
> > would work I think
> > and also not be misleading IMO.
> >
> > Martin
> >
> > ______________________________________________
> > R-package-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-package-devel
>
> --
> Dr. Benjamin Bolker
> Professor, Mathematics & Statistics and Biology, McMaster University
> Director, School of Computational Science and Engineering
> * E-mail is sent at my convenience; I don't expect replies outside of
> working hours.
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From edd @end|ng |rom deb|@n@org  Wed May 28 21:06:45 2025
From: edd @end|ng |rom deb|@n@org (Dirk Eddelbuettel)
Date: Wed, 28 May 2025 14:06:45 -0500
Subject: [R-pkg-devel] 
 Best practices for a contributor who prefers to be
 cited only by their GitHub ID?
In-Reply-To: <CAPRVBcwq6=885Kx_jgLnXwaKBgeO+KNYsL-tm6bZYr=PLis5CQ@mail.gmail.com>
References: <CAPRVBcwOxfnKH9HqwsKKeNN1WkNcKWU6gGAtvfdfiPbUDHfAKQ@mail.gmail.com>
 <26678.51280.794210.458395@stat.math.ethz.ch>
 <219cd022-0ffb-40bf-aa0d-1be11ed80f38@gmail.com>
 <CAPRVBcwq6=885Kx_jgLnXwaKBgeO+KNYsL-tm6bZYr=PLis5CQ@mail.gmail.com>
Message-ID: <26679.24261.271564.309172@rob.eddelbuettel.com>


Two meta-issues

- You as maintainer of a project are its steward; do you feel you can entrust
  the experience the users of your package will have to someone for whom you
  yourself have no email or name?

  Now, that question is rhetorical in the context of your repo as the thread
  demonstrates. However, other maintainers may choose differently.

- Given both the above, and that you know R CMD check will nag over a lack of
  (first and) family name, do you think you must add a contributor (who
  seemingly prefers to anonymous) to the DESCRIPTION file? You could simply
  decide not to.

All this is of course somewhat acadenmic as we have packages on CRAN with
author / contributor / creator tags of first and family name which ... are in
fact 'noms de plumes' i.e. not actually theirs so overall all this really is
a call to the shrug emoji. Turtles all the way down.

?\_(?)_/?

Dirk

-- 
dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From m|ch@e|ch|r|co4 @end|ng |rom gm@||@com  Wed May 28 21:29:24 2025
From: m|ch@e|ch|r|co4 @end|ng |rom gm@||@com (Michael Chirico)
Date: Wed, 28 May 2025 12:29:24 -0700
Subject: [R-pkg-devel] 
 Best practices for a contributor who prefers to be
 cited only by their GitHub ID?
In-Reply-To: <26679.24261.271564.309172@rob.eddelbuettel.com>
References: <CAPRVBcwOxfnKH9HqwsKKeNN1WkNcKWU6gGAtvfdfiPbUDHfAKQ@mail.gmail.com>
 <26678.51280.794210.458395@stat.math.ethz.ch>
 <219cd022-0ffb-40bf-aa0d-1be11ed80f38@gmail.com>
 <CAPRVBcwq6=885Kx_jgLnXwaKBgeO+KNYsL-tm6bZYr=PLis5CQ@mail.gmail.com>
 <26679.24261.271564.309172@rob.eddelbuettel.com>
Message-ID: <CAPRVBcyq0Q7=boHA4xRq73g8bsgMQQdDBfehJDL8E=6L7LgwDA@mail.gmail.com>

Thanks Dirk. Indeed, these are useful questions; ultimately, it's why
I'm emphasizing this is a 'ctb' role, from ?person

> Use for authors who have made smaller contributions (such as code patches etc.) but should not show up in the package citation.

I think anonymous/pseudonymous contributions in that role are fine.
Authors+maintainers still own responsibility for vetting such
contributions for potential security risks, etc.

For R CMD check, yes, there are ample false negatives on person()
entries, but false positives carry different weight. They should be
removed, modulo effort to implement, if we agree they're indeed false
positives.

Mike C

On Wed, May 28, 2025 at 12:06?PM Dirk Eddelbuettel <edd at debian.org> wrote:
>
>
> Two meta-issues
>
> - You as maintainer of a project are its steward; do you feel you can entrust
>   the experience the users of your package will have to someone for whom you
>   yourself have no email or name?
>
>   Now, that question is rhetorical in the context of your repo as the thread
>   demonstrates. However, other maintainers may choose differently.
>
> - Given both the above, and that you know R CMD check will nag over a lack of
>   (first and) family name, do you think you must add a contributor (who
>   seemingly prefers to anonymous) to the DESCRIPTION file? You could simply
>   decide not to.
>
> All this is of course somewhat acadenmic as we have packages on CRAN with
> author / contributor / creator tags of first and family name which ... are in
> fact 'noms de plumes' i.e. not actually theirs so overall all this really is
> a call to the shrug emoji. Turtles all the way down.
>
> ?\_(?)_/?
>
> Dirk
>
> --
> dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From hugh@p@r@on@ge @end|ng |rom gm@||@com  Wed May 28 23:02:06 2025
From: hugh@p@r@on@ge @end|ng |rom gm@||@com (Hugh Parsonage)
Date: Thu, 29 May 2025 07:02:06 +1000
Subject: [R-pkg-devel] 
 Best practices for a contributor who prefers to be
 cited only by their GitHub ID?
In-Reply-To: <CAPRVBcyq0Q7=boHA4xRq73g8bsgMQQdDBfehJDL8E=6L7LgwDA@mail.gmail.com>
References: <CAPRVBcwOxfnKH9HqwsKKeNN1WkNcKWU6gGAtvfdfiPbUDHfAKQ@mail.gmail.com>
 <26678.51280.794210.458395@stat.math.ethz.ch>
 <219cd022-0ffb-40bf-aa0d-1be11ed80f38@gmail.com>
 <CAPRVBcwq6=885Kx_jgLnXwaKBgeO+KNYsL-tm6bZYr=PLis5CQ@mail.gmail.com>
 <26679.24261.271564.309172@rob.eddelbuettel.com>
 <CAPRVBcyq0Q7=boHA4xRq73g8bsgMQQdDBfehJDL8E=6L7LgwDA@mail.gmail.com>
Message-ID: <CAJmOi+N1AvoKUGuPONaRNh5KNbARbtoui9w93hWzXr8EruzkSA@mail.gmail.com>

> - You as maintainer of a project are its steward; do you feel you can entrust
  the experience the users of your package will have to someone for whom you
  yourself have no email or name?

My initial reaction too. However, it's entirely possible that a GitHub
username is a more important form of reputation in this context than
their true name: it aggregates their code contributions and community
endorsements more readily and singularly. It may strengthen
accountability to use it (as opposed to omission entirely from the
author field), since any code lapses elsewhere would affect that
user's credentials. I agree it's not as strong as both a real name and
a username, however.

On Thu, 29 May 2025 at 05:30, Michael Chirico <michaelchirico4 at gmail.com> wrote:
>
> Thanks Dirk. Indeed, these are useful questions; ultimately, it's why
> I'm emphasizing this is a 'ctb' role, from ?person
>
> > Use for authors who have made smaller contributions (such as code patches etc.) but should not show up in the package citation.
>
> I think anonymous/pseudonymous contributions in that role are fine.
> Authors+maintainers still own responsibility for vetting such
> contributions for potential security risks, etc.
>
> For R CMD check, yes, there are ample false negatives on person()
> entries, but false positives carry different weight. They should be
> removed, modulo effort to implement, if we agree they're indeed false
> positives.
>
> Mike C
>
> On Wed, May 28, 2025 at 12:06?PM Dirk Eddelbuettel <edd at debian.org> wrote:
> >
> >
> > Two meta-issues
> >
> > - You as maintainer of a project are its steward; do you feel you can entrust
> >   the experience the users of your package will have to someone for whom you
> >   yourself have no email or name?
> >
> >   Now, that question is rhetorical in the context of your repo as the thread
> >   demonstrates. However, other maintainers may choose differently.
> >
> > - Given both the above, and that you know R CMD check will nag over a lack of
> >   (first and) family name, do you think you must add a contributor (who
> >   seemingly prefers to anonymous) to the DESCRIPTION file? You could simply
> >   decide not to.
> >
> > All this is of course somewhat acadenmic as we have packages on CRAN with
> > author / contributor / creator tags of first and family name which ... are in
> > fact 'noms de plumes' i.e. not actually theirs so overall all this really is
> > a call to the shrug emoji. Turtles all the way down.
> >
> > ?\_(?)_/?
> >
> > Dirk
> >
> > --
> > dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From @n248 @end|ng |rom corne||@edu  Sun Jun  1 01:15:12 2025
From: @n248 @end|ng |rom corne||@edu (SN248)
Date: Sat, 31 May 2025 19:15:12 -0400
Subject: [R-pkg-devel] How to handle CRAN warning regarding stdout/stderr
 coming from code in upstream C library
Message-ID: <CAP6q79HjbyKR5A+1u8rxRNEbsov_4rsO2pnkXnqXEoO5h0_29Q@mail.gmail.com>

Dear R package developers

I am getting the following errors in my package (sundialr -
https://github.com/sn248/sundialr) which is a wrapper around SUNDIALS C
library. The warnings are as follows:

? checking compiled code ...
> WARNING File ?sundialr/libs/sundialr.so?:
> Found ?abort?, possibly from ?abort? (C) Object:
> ?../inst/lib/libsundials_core.a?
> Found ?puts?, possibly from ?printf? (C), ?puts? (C) Object:
> ?../inst/lib/libsundials_core.a?
> Found ?stderr?, possibly from ?stderr? (C) Object:
> ?../inst/lib/libsundials_core.a?
> Found ?stdout?, possibly from ?stdout? (C) Objects:
> ?../inst/lib/libsundials_core.a?, ?../inst/lib/libsundials_cvodes.a?,
> ?../inst/lib/libsundials_idas.a?, ?../inst/lib/libsundials_nvecserial.a?
> Compiled code should not call entry points which might terminate R nor
> write to stdout/stderr instead of to the console, nor use Fortran I/O nor
> system RNGs nor [v]sprintf. See ?Writing portable packages? in the ?Writing
> R Extensions? manual.


See them at -
https://cran-archive.r-project.org/web/checks/2025/2025-05-12_check_results_sundialr.html

As far as I understand these warnings are coming from the following files:

1. 'abort' coming from -
https://github.com/sn248/sundialr/blob/ace6865ac0bc995190bc4c354a8823ea8d3bd358/src/sundials/sundials/sundials_errors.c#L87

2. I cannot find the file/line where 'puts' is coming from

3. stderr/stdout -- too many instances in SUNDIALS C code to list here,
e.g.,
https://github.com/sn248/sundialr/blob/ace6865ac0bc995190bc4c354a8823ea8d3bd358/src/sundials/arkode/arkode.c#L1285

In principle, I don't want to change anything in the upstream C library
code while including it in my package. Is this any other way to resolve
these warnings as the package has been archived because of these warnings
now.

Thanks
Satya

	[[alternative HTML version deleted]]


From edd @end|ng |rom deb|@n@org  Sun Jun  1 02:22:36 2025
From: edd @end|ng |rom deb|@n@org (Dirk Eddelbuettel)
Date: Sat, 31 May 2025 19:22:36 -0500
Subject: [R-pkg-devel] 
 How to handle CRAN warning regarding stdout/stderr
 coming from code in upstream C library
In-Reply-To: <CAP6q79HjbyKR5A+1u8rxRNEbsov_4rsO2pnkXnqXEoO5h0_29Q@mail.gmail.com>
References: <CAP6q79HjbyKR5A+1u8rxRNEbsov_4rsO2pnkXnqXEoO5h0_29Q@mail.gmail.com>
Message-ID: <26683.40268.596950.715227@rob.eddelbuettel.com>


On 31 May 2025 at 19:15, SN248 wrote:
| Dear R package developers
| 
| I am getting the following errors in my package (sundialr -
| https://github.com/sn248/sundialr) which is a wrapper around SUNDIALS C
| library. The warnings are as follows:
| 
| ? checking compiled code ...
| > WARNING File ?sundialr/libs/sundialr.so?:
| > Found ?abort?, possibly from ?abort? (C) Object:
| > ?../inst/lib/libsundials_core.a?
| > Found ?puts?, possibly from ?printf? (C), ?puts? (C) Object:
| > ?../inst/lib/libsundials_core.a?
| > Found ?stderr?, possibly from ?stderr? (C) Object:
| > ?../inst/lib/libsundials_core.a?
| > Found ?stdout?, possibly from ?stdout? (C) Objects:
| > ?../inst/lib/libsundials_core.a?, ?../inst/lib/libsundials_cvodes.a?,
| > ?../inst/lib/libsundials_idas.a?, ?../inst/lib/libsundials_nvecserial.a?
| > Compiled code should not call entry points which might terminate R nor
| > write to stdout/stderr instead of to the console, nor use Fortran I/O nor
| > system RNGs nor [v]sprintf. See ?Writing portable packages? in the ?Writing
| > R Extensions? manual.
| 
| 
| See them at -
| https://cran-archive.r-project.org/web/checks/2025/2025-05-12_check_results_sundialr.html
| 
| As far as I understand these warnings are coming from the following files:
| 
| 1. 'abort' coming from -
| https://github.com/sn248/sundialr/blob/ace6865ac0bc995190bc4c354a8823ea8d3bd358/src/sundials/sundials/sundials_errors.c#L87

You can get rid of `abort()` by using -DNDEBUG as a compiler flag.
 
| 2. I cannot find the file/line where 'puts' is coming from

You will have to locate it.

Bisection may help. It will likely be `(s(n))printf` as the message suggests.
 
| 3. stderr/stdout -- too many instances in SUNDIALS C code to list here,
| e.g.,
| https://github.com/sn248/sundialr/blob/ace6865ac0bc995190bc4c354a8823ea8d3bd358/src/sundials/arkode/arkode.c#L1285
| 
| In principle, I don't want to change anything in the upstream C library
| code while including it in my package. Is this any other way to resolve
| these warnings as the package has been archived because of these warnings
| now.

There is no other way. You will have to change it in the code.

Small local patches, or more elaborate accommodation (as eg RcppArmadillo
does with Armadillo by having a way to inject Rcpp::Rcout).

Uploading to CRAN and getting its 'stamp of approval', and with it world-wide
distribution is still a privilege. It may cost a 'tax': most package
maintainers are willing to pay it while others complain and would rather not.

It's a choice, and it is yours to make. But the rules are made by CRAN.

Cheers, Dirk

-- 
dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From @n248 @end|ng |rom corne||@edu  Sun Jun  1 14:23:23 2025
From: @n248 @end|ng |rom corne||@edu (SN248)
Date: Sun, 1 Jun 2025 08:23:23 -0400
Subject: [R-pkg-devel] 
 How to handle CRAN warning regarding stdout/stderr
 coming from code in upstream C library
In-Reply-To: <CAP6q79HjbyKR5A+1u8rxRNEbsov_4rsO2pnkXnqXEoO5h0_29Q@mail.gmail.com>
References: <CAP6q79HjbyKR5A+1u8rxRNEbsov_4rsO2pnkXnqXEoO5h0_29Q@mail.gmail.com>
Message-ID: <CAP6q79E3VhKcOtARvbGrznEwG_XmUZ=h89SNa0O_bdB_6Ni4Ew@mail.gmail.com>

Thank you Dirk for your detailed explanation. I will have to think if I
want to make the changes to get CRAN acceptance, but good to know that
those are the rules.

Best
Satya

On Sat, May 31, 2025 at 7:15?PM SN248 <sn248 at cornell.edu> wrote:

> Dear R package developers
>
> I am getting the following errors in my package (sundialr -
> https://github.com/sn248/sundialr) which is a wrapper around SUNDIALS C
> library. The warnings are as follows:
>
> ? checking compiled code ...
>> WARNING File ?sundialr/libs/sundialr.so?:
>> Found ?abort?, possibly from ?abort? (C) Object:
>> ?../inst/lib/libsundials_core.a?
>> Found ?puts?, possibly from ?printf? (C), ?puts? (C) Object:
>> ?../inst/lib/libsundials_core.a?
>> Found ?stderr?, possibly from ?stderr? (C) Object:
>> ?../inst/lib/libsundials_core.a?
>> Found ?stdout?, possibly from ?stdout? (C) Objects:
>> ?../inst/lib/libsundials_core.a?, ?../inst/lib/libsundials_cvodes.a?,
>> ?../inst/lib/libsundials_idas.a?, ?../inst/lib/libsundials_nvecserial.a?
>> Compiled code should not call entry points which might terminate R nor
>> write to stdout/stderr instead of to the console, nor use Fortran I/O nor
>> system RNGs nor [v]sprintf. See ?Writing portable packages? in the ?Writing
>> R Extensions? manual.
>
>
> See them at -
> https://cran-archive.r-project.org/web/checks/2025/2025-05-12_check_results_sundialr.html
>
> As far as I understand these warnings are coming from the following files:
>
> 1. 'abort' coming from -
> https://github.com/sn248/sundialr/blob/ace6865ac0bc995190bc4c354a8823ea8d3bd358/src/sundials/sundials/sundials_errors.c#L87
>
> 2. I cannot find the file/line where 'puts' is coming from
>
> 3. stderr/stdout -- too many instances in SUNDIALS C code to list here,
> e.g.,
> https://github.com/sn248/sundialr/blob/ace6865ac0bc995190bc4c354a8823ea8d3bd358/src/sundials/arkode/arkode.c#L1285
>
> In principle, I don't want to change anything in the upstream C library
> code while including it in my package. Is this any other way to resolve
> these warnings as the package has been archived because of these warnings
> now.
>
> Thanks
> Satya
>

	[[alternative HTML version deleted]]


From m@tthi@s-go@d@@ m@iii@g oii gmx@de  Sun Jun  1 15:17:11 2025
From: m@tthi@s-go@d@@ m@iii@g oii gmx@de (m@tthi@s-go@d@@ m@iii@g oii gmx@de)
Date: Sun, 1 Jun 2025 15:17:11 +0200
Subject: [R-pkg-devel] 
 How to handle CRAN warning regarding stdout/stderr
 coming from code in upstream C library
In-Reply-To: <26683.40268.596950.715227@rob.eddelbuettel.com>
References: <CAP6q79HjbyKR5A+1u8rxRNEbsov_4rsO2pnkXnqXEoO5h0_29Q@mail.gmail.com>
 <26683.40268.596950.715227@rob.eddelbuettel.com>
Message-ID: <000401dbd2f7$7c73a3b0$755aeb10$@gmx.de>

Dirk, can you elaborate this a bit:

> as eg RcppArmadillo does with Armadillo by having a way to inject Rcpp::Rcout

Might be useful elsewhere

-----Urspr?ngliche Nachricht-----
Von: R-package-devel <r-package-devel-bounces at r-project.org> Im Auftrag von Dirk Eddelbuettel
Gesendet: Sonntag, 1. Juni 2025 02:23
An: SN248 <sn248 at cornell.edu>
Cc: List r-package-devel <r-package-devel at r-project.org>
Betreff: Re: [R-pkg-devel] How to handle CRAN warning regarding stdout/stderr coming from code in upstream C library


On 31 May 2025 at 19:15, SN248 wrote:
| Dear R package developers
| 
| I am getting the following errors in my package (sundialr -
| https://github.com/sn248/sundialr) which is a wrapper around SUNDIALS 
| C library. The warnings are as follows:
| 
| ? checking compiled code ...
| > WARNING File ?sundialr/libs/sundialr.so?:
| > Found ?abort?, possibly from ?abort? (C) Object:
| > ?../inst/lib/libsundials_core.a?
| > Found ?puts?, possibly from ?printf? (C), ?puts? (C) Object:
| > ?../inst/lib/libsundials_core.a?
| > Found ?stderr?, possibly from ?stderr? (C) Object:
| > ?../inst/lib/libsundials_core.a?
| > Found ?stdout?, possibly from ?stdout? (C) Objects:
| > ?../inst/lib/libsundials_core.a?, 
| > ?../inst/lib/libsundials_cvodes.a?,
| > ?../inst/lib/libsundials_idas.a?, ?../inst/lib/libsundials_nvecserial.a?
| > Compiled code should not call entry points which might terminate R 
| > nor write to stdout/stderr instead of to the console, nor use 
| > Fortran I/O nor system RNGs nor [v]sprintf. See ?Writing portable 
| > packages? in the ?Writing R Extensions? manual.
| 
| 
| See them at -
| https://cran-archive.r-project.org/web/checks/2025/2025-05-12_check_re
| sults_sundialr.html
| 
| As far as I understand these warnings are coming from the following files:
| 
| 1. 'abort' coming from -
| https://github.com/sn248/sundialr/blob/ace6865ac0bc995190bc4c354a8823e
| a8d3bd358/src/sundials/sundials/sundials_errors.c#L87

You can get rid of `abort()` by using -DNDEBUG as a compiler flag.
 
| 2. I cannot find the file/line where 'puts' is coming from

You will have to locate it.

Bisection may help. It will likely be `(s(n))printf` as the message suggests.
 
| 3. stderr/stdout -- too many instances in SUNDIALS C code to list 
| here, e.g.,
| https://github.com/sn248/sundialr/blob/ace6865ac0bc995190bc4c354a8823e
| a8d3bd358/src/sundials/arkode/arkode.c#L1285
| 
| In principle, I don't want to change anything in the upstream C 
| library code while including it in my package. Is this any other way 
| to resolve these warnings as the package has been archived because of 
| these warnings now.

There is no other way. You will have to change it in the code.

Small local patches, or more elaborate accommodation (as eg RcppArmadillo does with Armadillo by having a way to inject Rcpp::Rcout).

Uploading to CRAN and getting its 'stamp of approval', and with it world-wide distribution is still a privilege. It may cost a 'tax': most package maintainers are willing to pay it while others complain and would rather not.

It's a choice, and it is yours to make. But the rules are made by CRAN.

Cheers, Dirk

--
dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org

______________________________________________
R-package-devel at r-project.org mailing list https://stat.ethz.ch/mailman/listinfo/r-package-devel


From edd @end|ng |rom deb|@n@org  Sun Jun  1 16:22:50 2025
From: edd @end|ng |rom deb|@n@org (Dirk Eddelbuettel)
Date: Sun, 1 Jun 2025 09:22:50 -0500
Subject: [R-pkg-devel] 
 How to handle CRAN warning regarding stdout/stderr
 coming from code in upstream C library
In-Reply-To: <000401dbd2f7$7c73a3b0$755aeb10$@gmx.de>
References: <CAP6q79HjbyKR5A+1u8rxRNEbsov_4rsO2pnkXnqXEoO5h0_29Q@mail.gmail.com>
 <26683.40268.596950.715227@rob.eddelbuettel.com>
 <000401dbd2f7$7c73a3b0$755aeb10$@gmx.de>
Message-ID: <26684.25146.567487.840036@rob.eddelbuettel.com>


On 1 June 2025 at 15:17, matthias-gondan at gmx.de wrote:
| Dirk, can you elaborate this a bit:
| 
| > as eg RcppArmadillo does with Armadillo by having a way to inject Rcpp::Rcout
| 
| Might be useful elsewhere

See the source and ChangeLog for the (brief) details.  In essence, a little
arm-twisting by us convinced Conrad upstream to have his stdout use be under
a preprocessor macro which, when building for R, injects Rcpp::Rcout (and
idem for Rcerr). See the code at

https://github.com/RcppCore/RcppArmadillo/blob/master/inst/include/RcppArmadillo/config/RcppArmadilloConfig.h#L76-L87

which (in essence) defines two identifiers with R's output sinks. By
including our headers before the upstream ones this is now defined, and then
used.

"Works great" and has been for thirteen years (!!) per my ChangeLog with an
occassional rename in-between.  Used by over 1200 (!!)  reverse-dependencies
too without them having to do anything. We actually do something similar for
the (main U(0,1)) RNG (but not N(0,1) as Armadillo has its own, longer story,
so keep using R's N(0,1)).

Hth,  Dirk

| -----Urspr?ngliche Nachricht-----
| Von: R-package-devel <r-package-devel-bounces at r-project.org> Im Auftrag von Dirk Eddelbuettel
| Gesendet: Sonntag, 1. Juni 2025 02:23
| An: SN248 <sn248 at cornell.edu>
| Cc: List r-package-devel <r-package-devel at r-project.org>
| Betreff: Re: [R-pkg-devel] How to handle CRAN warning regarding stdout/stderr coming from code in upstream C library
| 
| 
| On 31 May 2025 at 19:15, SN248 wrote:
| | Dear R package developers
| | 
| | I am getting the following errors in my package (sundialr -
| | https://github.com/sn248/sundialr) which is a wrapper around SUNDIALS 
| | C library. The warnings are as follows:
| | 
| | ? checking compiled code ...
| | > WARNING File ?sundialr/libs/sundialr.so?:
| | > Found ?abort?, possibly from ?abort? (C) Object:
| | > ?../inst/lib/libsundials_core.a?
| | > Found ?puts?, possibly from ?printf? (C), ?puts? (C) Object:
| | > ?../inst/lib/libsundials_core.a?
| | > Found ?stderr?, possibly from ?stderr? (C) Object:
| | > ?../inst/lib/libsundials_core.a?
| | > Found ?stdout?, possibly from ?stdout? (C) Objects:
| | > ?../inst/lib/libsundials_core.a?, 
| | > ?../inst/lib/libsundials_cvodes.a?,
| | > ?../inst/lib/libsundials_idas.a?, ?../inst/lib/libsundials_nvecserial.a?
| | > Compiled code should not call entry points which might terminate R 
| | > nor write to stdout/stderr instead of to the console, nor use 
| | > Fortran I/O nor system RNGs nor [v]sprintf. See ?Writing portable 
| | > packages? in the ?Writing R Extensions? manual.
| | 
| | 
| | See them at -
| | https://cran-archive.r-project.org/web/checks/2025/2025-05-12_check_re
| | sults_sundialr.html
| | 
| | As far as I understand these warnings are coming from the following files:
| | 
| | 1. 'abort' coming from -
| | https://github.com/sn248/sundialr/blob/ace6865ac0bc995190bc4c354a8823e
| | a8d3bd358/src/sundials/sundials/sundials_errors.c#L87
| 
| You can get rid of `abort()` by using -DNDEBUG as a compiler flag.
|  
| | 2. I cannot find the file/line where 'puts' is coming from
| 
| You will have to locate it.
| 
| Bisection may help. It will likely be `(s(n))printf` as the message suggests.
|  
| | 3. stderr/stdout -- too many instances in SUNDIALS C code to list 
| | here, e.g.,
| | https://github.com/sn248/sundialr/blob/ace6865ac0bc995190bc4c354a8823e
| | a8d3bd358/src/sundials/arkode/arkode.c#L1285
| | 
| | In principle, I don't want to change anything in the upstream C 
| | library code while including it in my package. Is this any other way 
| | to resolve these warnings as the package has been archived because of 
| | these warnings now.
| 
| There is no other way. You will have to change it in the code.
| 
| Small local patches, or more elaborate accommodation (as eg RcppArmadillo does with Armadillo by having a way to inject Rcpp::Rcout).
| 
| Uploading to CRAN and getting its 'stamp of approval', and with it world-wide distribution is still a privilege. It may cost a 'tax': most package maintainers are willing to pay it while others complain and would rather not.
| 
| It's a choice, and it is yours to make. But the rules are made by CRAN.
| 
| Cheers, Dirk
| 
| --
| dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org
| 
| ______________________________________________
| R-package-devel at r-project.org mailing list https://stat.ethz.ch/mailman/listinfo/r-package-devel
| 

-- 
dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From n@r@@ @end|ng |rom @t@n|ord@edu  Mon Jun  2 18:15:01 2025
From: n@r@@ @end|ng |rom @t@n|ord@edu (Balasubramanian Narasimhan)
Date: Mon, 2 Jun 2025 09:15:01 -0700
Subject: [R-pkg-devel] 
 How to handle CRAN warning regarding stdout/stderr
 coming from code in upstream C library
In-Reply-To: <CAP6q79HjbyKR5A+1u8rxRNEbsov_4rsO2pnkXnqXEoO5h0_29Q@mail.gmail.com>
References: <CAP6q79HjbyKR5A+1u8rxRNEbsov_4rsO2pnkXnqXEoO5h0_29Q@mail.gmail.com>
Message-ID: <b848ab8e-807e-4e3e-92ca-304603ab6e6e@stanford.edu>

While on the subject, one useful workflow I have adopted (e.g. package 
cubature) is to clone the underlying C library to a Github repo. (Always 
happy to hear of others!)

Then create a branch called `R_pkg` and make changes on this branch and 
use it as the source for your C library. Not only does it account for 
your changes, but also helps you keep abreast of future modifications to 
the original.

In fact, the problems you mention are exactly what I had to deal with 
recently.

-Naras

On 5/31/25 4:15 PM, SN248 wrote:
> Dear R package developers
>
> I am getting the following errors in my package (sundialr -
> https://github.com/sn248/sundialr) which is a wrapper around SUNDIALS C
> library. The warnings are as follows:
>
> ? checking compiled code ...
>> WARNING File ?sundialr/libs/sundialr.so?:
>> Found ?abort?, possibly from ?abort? (C) Object:
>> ?../inst/lib/libsundials_core.a?
>> Found ?puts?, possibly from ?printf? (C), ?puts? (C) Object:
>> ?../inst/lib/libsundials_core.a?
>> Found ?stderr?, possibly from ?stderr? (C) Object:
>> ?../inst/lib/libsundials_core.a?
>> Found ?stdout?, possibly from ?stdout? (C) Objects:
>> ?../inst/lib/libsundials_core.a?, ?../inst/lib/libsundials_cvodes.a?,
>> ?../inst/lib/libsundials_idas.a?, ?../inst/lib/libsundials_nvecserial.a?
>> Compiled code should not call entry points which might terminate R nor
>> write to stdout/stderr instead of to the console, nor use Fortran I/O nor
>> system RNGs nor [v]sprintf. See ?Writing portable packages? in the ?Writing
>> R Extensions? manual.
>
> See them at -
> https://cran-archive.r-project.org/web/checks/2025/2025-05-12_check_results_sundialr.html
>
> As far as I understand these warnings are coming from the following files:
>
> 1. 'abort' coming from -
> https://github.com/sn248/sundialr/blob/ace6865ac0bc995190bc4c354a8823ea8d3bd358/src/sundials/sundials/sundials_errors.c#L87
>
> 2. I cannot find the file/line where 'puts' is coming from
>
> 3. stderr/stdout -- too many instances in SUNDIALS C code to list here,
> e.g.,
> https://github.com/sn248/sundialr/blob/ace6865ac0bc995190bc4c354a8823ea8d3bd358/src/sundials/arkode/arkode.c#L1285
>
> In principle, I don't want to change anything in the upstream C library
> code while including it in my package. Is this any other way to resolve
> these warnings as the package has been archived because of these warnings
> now.
>
> Thanks
> Satya
>
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From n@r@@ @end|ng |rom @t@n|ord@edu  Mon Jun  2 18:16:19 2025
From: n@r@@ @end|ng |rom @t@n|ord@edu (Balasubramanian Narasimhan)
Date: Mon, 2 Jun 2025 09:16:19 -0700
Subject: [R-pkg-devel] 
 How to handle CRAN warning regarding stdout/stderr
 coming from code in upstream C library
In-Reply-To: <b848ab8e-807e-4e3e-92ca-304603ab6e6e@stanford.edu>
References: <CAP6q79HjbyKR5A+1u8rxRNEbsov_4rsO2pnkXnqXEoO5h0_29Q@mail.gmail.com>
 <b848ab8e-807e-4e3e-92ca-304603ab6e6e@stanford.edu>
Message-ID: <ee7f925e-36bb-460b-a7f5-517e5a161efa@stanford.edu>

"Github" -> "Git"

-N

On 6/2/25 9:15 AM, Balasubramanian Narasimhan wrote:
> While on the subject, one useful workflow I have adopted (e.g. package 
> cubature) is to clone the underlying C library to a Github repo. 
> (Always happy to hear of others!)
>
> Then create a branch called `R_pkg` and make changes on this branch 
> and use it as the source for your C library. Not only does it account 
> for your changes, but also helps you keep abreast of future 
> modifications to the original.
>
> In fact, the problems you mention are exactly what I had to deal with 
> recently.
>
> -Naras
>
> On 5/31/25 4:15 PM, SN248 wrote:
>> Dear R package developers
>>
>> I am getting the following errors in my package (sundialr -
>> https://github.com/sn248/sundialr) which is a wrapper around SUNDIALS C
>> library. The warnings are as follows:
>>
>> ? checking compiled code ...
>>> WARNING File ?sundialr/libs/sundialr.so?:
>>> Found ?abort?, possibly from ?abort? (C) Object:
>>> ?../inst/lib/libsundials_core.a?
>>> Found ?puts?, possibly from ?printf? (C), ?puts? (C) Object:
>>> ?../inst/lib/libsundials_core.a?
>>> Found ?stderr?, possibly from ?stderr? (C) Object:
>>> ?../inst/lib/libsundials_core.a?
>>> Found ?stdout?, possibly from ?stdout? (C) Objects:
>>> ?../inst/lib/libsundials_core.a?, ?../inst/lib/libsundials_cvodes.a?,
>>> ?../inst/lib/libsundials_idas.a?, 
>>> ?../inst/lib/libsundials_nvecserial.a?
>>> Compiled code should not call entry points which might terminate R nor
>>> write to stdout/stderr instead of to the console, nor use Fortran 
>>> I/O nor
>>> system RNGs nor [v]sprintf. See ?Writing portable packages? in the 
>>> ?Writing
>>> R Extensions? manual.
>>
>> See them at -
>> https://cran-archive.r-project.org/web/checks/2025/2025-05-12_check_results_sundialr.html 
>>
>>
>> As far as I understand these warnings are coming from the following 
>> files:
>>
>> 1. 'abort' coming from -
>> https://github.com/sn248/sundialr/blob/ace6865ac0bc995190bc4c354a8823ea8d3bd358/src/sundials/sundials/sundials_errors.c#L87 
>>
>>
>> 2. I cannot find the file/line where 'puts' is coming from
>>
>> 3. stderr/stdout -- too many instances in SUNDIALS C code to list here,
>> e.g.,
>> https://github.com/sn248/sundialr/blob/ace6865ac0bc995190bc4c354a8823ea8d3bd358/src/sundials/arkode/arkode.c#L1285 
>>
>>
>> In principle, I don't want to change anything in the upstream C library
>> code while including it in my package. Is this any other way to resolve
>> these warnings as the package has been archived because of these 
>> warnings
>> now.
>>
>> Thanks
>> Satya
>>
>> ????[[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From murr@y@e||ord @end|ng |rom ot@go@@c@nz  Tue Jun  3 02:12:48 2025
From: murr@y@e||ord @end|ng |rom ot@go@@c@nz (Murray Efford)
Date: Tue, 3 Jun 2025 00:12:48 +0000
Subject: [R-pkg-devel] Check time > 10min
Message-ID: <SY2PR01MB2539A7E395BB05E6720468D8AC62A@SY2PR01MB2539.ausprd01.prod.outlook.com>

My revision of package 'secr' fails CRAN pre-test on Windows (R 4.5.0) because total check time exceeds 10 min (it's 760 seconds or 13 min). I can't see how to fix this as none of the times listed in the log https://win-builder.r-project.org/incoming_pretest/secr_5.2.2_20250602_054847/Windows/00check.log seems exceptional:
* checking CRAN incoming feasibility ... [18s] OK
* checking R code for possible problems ... [116s] OK
* checking examples ... [87s] OK
* checking tests ... [59s] OK
* checking re-building of vignette outputs ... [42s] OK
* checking PDF version of manual ... [32s] OK
* checking HTML version of manual ... [42s] OK
and the total of these components is only 396 sec (6.6 min), so I must be missing something. I would appreciate any advice.  Not much was added in this release, and I don't like the idea of blindly hacking off bits.

	[[alternative HTML version deleted]]


From edd @end|ng |rom deb|@n@org  Tue Jun  3 02:54:27 2025
From: edd @end|ng |rom deb|@n@org (Dirk Eddelbuettel)
Date: Mon, 2 Jun 2025 19:54:27 -0500
Subject: [R-pkg-devel] Check time > 10min
In-Reply-To: <SY2PR01MB2539A7E395BB05E6720468D8AC62A@SY2PR01MB2539.ausprd01.prod.outlook.com>
References: <SY2PR01MB2539A7E395BB05E6720468D8AC62A@SY2PR01MB2539.ausprd01.prod.outlook.com>
Message-ID: <26686.18371.483249.269223@rob.eddelbuettel.com>


On 3 June 2025 at 00:12, Murray Efford via R-package-devel wrote:
| My revision of package 'secr' fails CRAN pre-test on Windows (R 4.5.0) because total check time exceeds 10 min (it's 760 seconds or 13 min). I can't see how to fix this as none of the times listed in the log https://win-builder.r-project.org/incoming_pretest/secr_5.2.2_20250602_054847/Windows/00check.log seems exceptional:
| * checking CRAN incoming feasibility ... [18s] OK
| * checking R code for possible problems ... [116s] OK
| * checking examples ... [87s] OK
| * checking tests ... [59s] OK
| * checking re-building of vignette outputs ... [42s] OK
| * checking PDF version of manual ... [32s] OK
| * checking HTML version of manual ... [42s] OK
| and the total of these components is only 396 sec (6.6 min), so I must be missing something. I would appreciate any advice.  Not much was added in this release, and I don't like the idea of blindly hacking off bits.

To a first approximation every tests is a function of some variable we can
describe as 'N' which you, as author of the package and the tests, understand
best.

Surely you must know a way to define a new N1 <- N/2, or some other
appropriate scaling. Then try running with N1 instead. And you can also make
both tests and examples _conditional_ on some other control variable.

It's all just code. Bend it like Beckham.

Dirk

| 
| 	[[alternative HTML version deleted]]
| 
| ______________________________________________
| R-package-devel at r-project.org mailing list
| https://stat.ethz.ch/mailman/listinfo/r-package-devel

-- 
dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From murr@y@e||ord @end|ng |rom ot@go@@c@nz  Tue Jun  3 03:41:08 2025
From: murr@y@e||ord @end|ng |rom ot@go@@c@nz (Murray Efford)
Date: Tue, 3 Jun 2025 01:41:08 +0000
Subject: [R-pkg-devel] Check time > 10min
In-Reply-To: <26686.18371.483249.269223@rob.eddelbuettel.com>
References: <SY2PR01MB2539A7E395BB05E6720468D8AC62A@SY2PR01MB2539.ausprd01.prod.outlook.com>
 <26686.18371.483249.269223@rob.eddelbuettel.com>
Message-ID: <SY2PR01MB2539E924236905372826D30CAC6DA@SY2PR01MB2539.ausprd01.prod.outlook.com>

On the face of it,  I would need to throw out all the examples, and all the tests. That can't be right. Am I wrong to take the times in the log at face value? Where did the other 6 minutes go? Please excuse my obtuseness.
________________________________
From: Dirk Eddelbuettel <edd at debian.org>
Sent: Tuesday, 3 June 2025 12:54
To: Murray Efford <murray.efford at otago.ac.nz>
Cc: R Package Development <r-package-devel at r-project.org>
Subject: Re: [R-pkg-devel] Check time > 10min


On 3 June 2025 at 00:12, Murray Efford via R-package-devel wrote:
| My revision of package 'secr' fails CRAN pre-test on Windows (R 4.5.0) because total check time exceeds 10 min (it's 760 seconds or 13 min). I can't see how to fix this as none of the times listed in the log https://win-builder.r-project.org/incoming_pretest/secr_5.2.2_20250602_054847/Windows/00check.log<https://win-builder.r-project.org/incoming_pretest/secr_5.2.2_20250602_054847/Windows/00check.log> seems exceptional:
| * checking CRAN incoming feasibility ... [18s] OK
| * checking R code for possible problems ... [116s] OK
| * checking examples ... [87s] OK
| * checking tests ... [59s] OK
| * checking re-building of vignette outputs ... [42s] OK
| * checking PDF version of manual ... [32s] OK
| * checking HTML version of manual ... [42s] OK
| and the total of these components is only 396 sec (6.6 min), so I must be missing something. I would appreciate any advice.  Not much was added in this release, and I don't like the idea of blindly hacking off bits.

To a first approximation every tests is a function of some variable we can
describe as 'N' which you, as author of the package and the tests, understand
best.

Surely you must know a way to define a new N1 <- N/2, or some other
appropriate scaling. Then try running with N1 instead. And you can also make
both tests and examples _conditional_ on some other control variable.

It's all just code. Bend it like Beckham.

Dirk

|
|        [[alternative HTML version deleted]]
|
| ______________________________________________
| R-package-devel at r-project.org mailing list
| https://stat.ethz.ch/mailman/listinfo/r-package-devel<https://stat.ethz.ch/mailman/listinfo/r-package-devel>

--
dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org

	[[alternative HTML version deleted]]


From greg @end|ng |rom ||rm@n@y@h@com  Tue Jun  3 03:45:21 2025
From: greg @end|ng |rom ||rm@n@y@h@com (Greg Hunt)
Date: Tue, 3 Jun 2025 11:45:21 +1000
Subject: [R-pkg-devel] Check time > 10min
In-Reply-To: <SY2PR01MB2539E924236905372826D30CAC6DA@SY2PR01MB2539.ausprd01.prod.outlook.com>
References: <SY2PR01MB2539A7E395BB05E6720468D8AC62A@SY2PR01MB2539.ausprd01.prod.outlook.com>
 <26686.18371.483249.269223@rob.eddelbuettel.com>
 <SY2PR01MB2539E924236905372826D30CAC6DA@SY2PR01MB2539.ausprd01.prod.outlook.com>
Message-ID: <CAAS8PAK0dXxJ_kCVm_L-EV+9B6+jLoQL_vAW0QCxU5k=YCHLnw@mail.gmail.com>

That log ends with status OK, so is that the run that had the problem?
Isn't that time exceeded message in the log somewhere?

On Tue, 3 Jun 2025 at 11:41, Murray Efford via R-package-devel <
r-package-devel at r-project.org> wrote:

> On the face of it,  I would need to throw out all the examples, and all
> the tests. That can't be right. Am I wrong to take the times in the log at
> face value? Where did the other 6 minutes go? Please excuse my obtuseness.
> ________________________________
> From: Dirk Eddelbuettel <edd at debian.org>
> Sent: Tuesday, 3 June 2025 12:54
> To: Murray Efford <murray.efford at otago.ac.nz>
> Cc: R Package Development <r-package-devel at r-project.org>
> Subject: Re: [R-pkg-devel] Check time > 10min
>
>
> On 3 June 2025 at 00:12, Murray Efford via R-package-devel wrote:
> | My revision of package 'secr' fails CRAN pre-test on Windows (R 4.5.0)
> because total check time exceeds 10 min (it's 760 seconds or 13 min). I
> can't see how to fix this as none of the times listed in the log
> https://win-builder.r-project.org/incoming_pretest/secr_5.2.2_20250602_054847/Windows/00check.log
> <
> https://win-builder.r-project.org/incoming_pretest/secr_5.2.2_20250602_054847/Windows/00check.log>
> seems exceptional:
> | * checking CRAN incoming feasibility ... [18s] OK
> | * checking R code for possible problems ... [116s] OK
> | * checking examples ... [87s] OK
> | * checking tests ... [59s] OK
> | * checking re-building of vignette outputs ... [42s] OK
> | * checking PDF version of manual ... [32s] OK
> | * checking HTML version of manual ... [42s] OK
> | and the total of these components is only 396 sec (6.6 min), so I must
> be missing something. I would appreciate any advice.  Not much was added in
> this release, and I don't like the idea of blindly hacking off bits.
>
> To a first approximation every tests is a function of some variable we can
> describe as 'N' which you, as author of the package and the tests,
> understand
> best.
>
> Surely you must know a way to define a new N1 <- N/2, or some other
> appropriate scaling. Then try running with N1 instead. And you can also
> make
> both tests and examples _conditional_ on some other control variable.
>
> It's all just code. Bend it like Beckham.
>
> Dirk
>
> |
> |        [[alternative HTML version deleted]]
> |
> | ______________________________________________
> | R-package-devel at r-project.org mailing list
> | https://stat.ethz.ch/mailman/listinfo/r-package-devel<
> https://stat.ethz.ch/mailman/listinfo/r-package-devel>
>
> --
> dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From murr@y@e||ord @end|ng |rom ot@go@@c@nz  Tue Jun  3 04:12:42 2025
From: murr@y@e||ord @end|ng |rom ot@go@@c@nz (Murray Efford)
Date: Tue, 3 Jun 2025 02:12:42 +0000
Subject: [R-pkg-devel] Check time > 10min
In-Reply-To: <CAAS8PAK0dXxJ_kCVm_L-EV+9B6+jLoQL_vAW0QCxU5k=YCHLnw@mail.gmail.com>
References: <SY2PR01MB2539A7E395BB05E6720468D8AC62A@SY2PR01MB2539.ausprd01.prod.outlook.com>
 <26686.18371.483249.269223@rob.eddelbuettel.com>
 <SY2PR01MB2539E924236905372826D30CAC6DA@SY2PR01MB2539.ausprd01.prod.outlook.com>
 <CAAS8PAK0dXxJ_kCVm_L-EV+9B6+jLoQL_vAW0QCxU5k=YCHLnw@mail.gmail.com>
Message-ID: <SY2PR01MB253930B4FE4738ADD9FA703DAC6DA@SY2PR01MB2539.ausprd01.prod.outlook.com>

Yes, that run is the problem. There is an attachment from CRAN-pretest with this NOTE that I take to be the issue:

Flavor: r-devel-windows-x86_64
Check: *, Result: NA

Flavor: r-devel-windows-x86_64
Check: Overall checktime, Result: NOTE
Overall checktime 13 min > 10 min

Flavor: r-devel-linux-x86_64-debian-gcc
Check: *, Result: OK

________________________________
From: Greg Hunt <greg at firmansyah.com>
Sent: Tuesday, 3 June 2025 13:45
To: Murray Efford <murray.efford at otago.ac.nz>
Cc: Dirk Eddelbuettel <edd at debian.org>; R Package Development <r-package-devel at r-project.org>
Subject: Re: [R-pkg-devel] Check time > 10min

That log ends with status OK, so is that the run that had the problem?  Isn't that time exceeded message in the log somewhere?

On Tue, 3 Jun 2025 at 11:41, Murray Efford via R-package-devel <r-package-devel at r-project.org<mailto:r-package-devel at r-project.org>> wrote:
On the face of it,  I would need to throw out all the examples, and all the tests. That can't be right. Am I wrong to take the times in the log at face value? Where did the other 6 minutes go? Please excuse my obtuseness.
________________________________
From: Dirk Eddelbuettel <edd at debian.org<mailto:edd at debian.org>>
Sent: Tuesday, 3 June 2025 12:54
To: Murray Efford <murray.efford at otago.ac.nz<mailto:murray.efford at otago.ac.nz>>
Cc: R Package Development <r-package-devel at r-project.org<mailto:r-package-devel at r-project.org>>
Subject: Re: [R-pkg-devel] Check time > 10min


On 3 June 2025 at 00:12, Murray Efford via R-package-devel wrote:
| My revision of package 'secr' fails CRAN pre-test on Windows (R 4.5.0) because total check time exceeds 10 min (it's 760 seconds or 13 min). I can't see how to fix this as none of the times listed in the log https://win-builder.r-project.org/incoming_pretest/secr_5.2.2_20250602_054847/Windows/00check.log<https://win-builder.r-project.org/incoming_pretest/secr_5.2.2_20250602_054847/Windows/00check.log> seems exceptional:
| * checking CRAN incoming feasibility ... [18s] OK
| * checking R code for possible problems ... [116s] OK
| * checking examples ... [87s] OK
| * checking tests ... [59s] OK
| * checking re-building of vignette outputs ... [42s] OK
| * checking PDF version of manual ... [32s] OK
| * checking HTML version of manual ... [42s] OK
| and the total of these components is only 396 sec (6.6 min), so I must be missing something. I would appreciate any advice.  Not much was added in this release, and I don't like the idea of blindly hacking off bits.

To a first approximation every tests is a function of some variable we can
describe as 'N' which you, as author of the package and the tests, understand
best.

Surely you must know a way to define a new N1 <- N/2, or some other
appropriate scaling. Then try running with N1 instead. And you can also make
both tests and examples _conditional_ on some other control variable.

It's all just code. Bend it like Beckham.

Dirk

|
|        [[alternative HTML version deleted]]
|
| ______________________________________________
| R-package-devel at r-project.org<mailto:R-package-devel at r-project.org> mailing list
| https://stat.ethz.ch/mailman/listinfo/r-package-devel<https://stat.ethz.ch/mailman/listinfo/r-package-devel>

--
dirk.eddelbuettel.com<http://dirk.eddelbuettel.com/> | @eddelbuettel | edd at debian.org<mailto:edd at debian.org>

        [[alternative HTML version deleted]]

______________________________________________
R-package-devel at r-project.org<mailto:R-package-devel at r-project.org> mailing list
https://stat.ethz.ch/mailman/listinfo/r-package-devel

	[[alternative HTML version deleted]]


From r@||@@tubner @end|ng |rom gm@||@com  Tue Jun  3 09:20:54 2025
From: r@||@@tubner @end|ng |rom gm@||@com (Ralf Stubner)
Date: Tue, 3 Jun 2025 09:20:54 +0200
Subject: [R-pkg-devel] 
 How to handle CRAN warning regarding stdout/stderr
 coming from code in upstream C library
In-Reply-To: <CAP6q79HjbyKR5A+1u8rxRNEbsov_4rsO2pnkXnqXEoO5h0_29Q@mail.gmail.com>
References: <CAP6q79HjbyKR5A+1u8rxRNEbsov_4rsO2pnkXnqXEoO5h0_29Q@mail.gmail.com>
Message-ID: <CAFQwRQzubP6wCPd5LmJL_4_+J-soHPZ8_62EWQSiB4YmYnneUg@mail.gmail.com>

On Sun, Jun 1, 2025 at 1:15?AM SN248 <sn248 at cornell.edu> wrote:
> ? checking compiled code ...
> > WARNING File ?sundialr/libs/sundialr.so?:
> > Found ?abort?, possibly from ?abort? (C) Object:
> > ?../inst/lib/libsundials_core.a?
> > Found ?puts?, possibly from ?printf? (C), ?puts? (C) Object:
> > ?../inst/lib/libsundials_core.a?

One interesting side aspect is that while one of the warnings comes
from the .so file that will be used by R, most of the other messages
come from the intermediate .a files. You absolutely have to fix the
former ones. However, it sometimes happens that code is present in the
library and therefore compiled into the .a file, but it is not used in
the code exposed to R and therefore does not end up in the .so file.
In that case it helps to delete the intermediate .a file once the .so
file has been built. In swephR I do this with the following
src/Makevars file:

PKG_LIBS=-L. -lswe
PKG_CPPFLAGS=-I./libswe/ -DSTRICT_R_HEADERS

all: $(SHLIB) purify

$(SHLIB): libswe.a

LIBSWE = libswe/swedate.o libswe/swehouse.o libswe/swejpl.o libswe/swemmoon.o \
         libswe/swemplan.o libswe/sweph.o \
         libswe/swephlib.o libswe/swecl.o libswe/swehel.o
libswe.a: $(LIBSWE)
        $(AR) rcs libswe.a $(LIBSWE)

purify: $(SHLIB)
        @rm -rf libswe.a || true


ralf


From |kry|ov @end|ng |rom d|@root@org  Tue Jun  3 10:04:06 2025
From: |kry|ov @end|ng |rom d|@root@org (Ivan Krylov)
Date: Tue, 3 Jun 2025 11:04:06 +0300
Subject: [R-pkg-devel] 
 [Extern] Re: Problem building package depending on
 third party c++ source library.
In-Reply-To: <63bbe5f7-e81a-4798-bb65-e18d785d32bc@hhu.de>
References: <ed3ae707af8e1af36f51e73581ee14af@uni-duesseldorf.de>
 <20250430215741.445338cd@Tarkus>
 <63bbe5f7-e81a-4798-bb65-e18d785d32bc@hhu.de>
Message-ID: <20250603110406.5993742f@Tarkus>

On Sat, 24 May 2025 17:07:06 +0200
Nils L?schow <nilue103 at hhu.de> wrote:

> Regarding the "mismatched-new-delete" warning I am also relatively
> sure that this is actually a false positive. Taking a look into the
> stack-trace, the new and delete operators are actually overloaded
> with functions that internally use malloc and free, hence, there is
> no mismatch

You're right, I see now that the call to free() is inlined into the
operator delete. This might be the same GCC bug as reported at
<https://gcc.gnu.org/bugzilla/show_bug.cgi?id=100485>, but I've been
wrong about finding the exact problem before.

Generally, R CMD check will produce a NOTE if it sees you disabling a
compiler warning, but the compiler is in the wrong here, and a NOTE is
better than a WARNING. Still, it's best to have a package pass R CMD
check without even NOTEs because those don't need to be re-checked by a
human upon updates. Perhaps you could ask on Libera.Chat's #gcc channel
about possible workarounds? Sorry for not giving a more definitive
answer.

I've tried compiling the package on a Debian testing container, which
is the OS that runs the incoming package checks, and encountered even
more problems. Now gecode doesn't build at all, manually with
'./configure && make' or as part of the R package:

In file included from gecode/set/rel.cpp:39:
In file included from ./gecode/set/int.hh:296:
./gecode/set/int/weights.hpp:127:14: error: no viable overloaded '='
  127 |     elements = elements0; weights = weights0;
      |     ~~~~~~~~ ^ ~~~~~~~~~
./gecode/kernel/data/shared-array.hpp:53:9: note: candidate function (the implicit copy assignment operator) not viable: 'this' argument has type 'const SharedArray<int>', but
 method is not marked const
   53 |   class SharedArray : public SharedHandle {
      |         ^
In file included from gecode/set/rel.cpp:39:
In file included from ./gecode/set/int.hh:296:
./gecode/set/int/weights.hpp:127:35: error: no viable overloaded '='
  127 |     elements = elements0; weights = weights0;
      |                           ~~~~~~~ ^ ~~~~~~~~
./gecode/kernel/data/shared-array.hpp:53:9: note: candidate function (the implicit copy assignment operator) not viable: 'this' argument has type 'const SharedArray<int>', but
 method is not marked const
   53 |   class SharedArray : public SharedHandle {
      |         ^

Additionally, gecode's ./configure wants to add --std=c++11 to the
compiler command line. I don't know if linking C++20 and C++11 code
would cause ABI problems, but it might better to configure gecode with
--enable-cpp11=no (since Makevars already gives the compatible standard
flag to ./configure).

-- 
Best regards,
Ivan


From greg @end|ng |rom ||rm@n@y@h@com  Tue Jun  3 13:22:50 2025
From: greg @end|ng |rom ||rm@n@y@h@com (Greg Hunt)
Date: Tue, 3 Jun 2025 21:22:50 +1000
Subject: [R-pkg-devel] Check time > 10min
In-Reply-To: <26686.18371.483249.269223@rob.eddelbuettel.com>
References: <SY2PR01MB2539A7E395BB05E6720468D8AC62A@SY2PR01MB2539.ausprd01.prod.outlook.com>
 <26686.18371.483249.269223@rob.eddelbuettel.com>
Message-ID: <CAAS8PAKZwX9RqGmAh5YanZ5he6bU72wT1uzrSbfOr+krNcPsFQ@mail.gmail.com>

Dirk,
Even if he gets the test and example times to zero, his total time in that
thirteen minute run is still above ten minutes.  In my view the incomplete
time reporting (we don't know what makes up the thirteen minutes) is a bug
in the build process.

Greg

On Tue, 3 Jun 2025 at 10:54, Dirk Eddelbuettel <edd at debian.org> wrote:

>
> On 3 June 2025 at 00:12, Murray Efford via R-package-devel wrote:
> | My revision of package 'secr' fails CRAN pre-test on Windows (R 4.5.0)
> because total check time exceeds 10 min (it's 760 seconds or 13 min). I
> can't see how to fix this as none of the times listed in the log
> https://win-builder.r-project.org/incoming_pretest/secr_5.2.2_20250602_054847/Windows/00check.log
> seems exceptional:
> | * checking CRAN incoming feasibility ... [18s] OK
> | * checking R code for possible problems ... [116s] OK
> | * checking examples ... [87s] OK
> | * checking tests ... [59s] OK
> | * checking re-building of vignette outputs ... [42s] OK
> | * checking PDF version of manual ... [32s] OK
> | * checking HTML version of manual ... [42s] OK
> | and the total of these components is only 396 sec (6.6 min), so I must
> be missing something. I would appreciate any advice.  Not much was added in
> this release, and I don't like the idea of blindly hacking off bits.
>
> To a first approximation every tests is a function of some variable we can
> describe as 'N' which you, as author of the package and the tests,
> understand
> best.
>
> Surely you must know a way to define a new N1 <- N/2, or some other
> appropriate scaling. Then try running with N1 instead. And you can also
> make
> both tests and examples _conditional_ on some other control variable.
>
> It's all just code. Bend it like Beckham.
>
> Dirk
>
> |
> |       [[alternative HTML version deleted]]
> |
> | ______________________________________________
> | R-package-devel at r-project.org mailing list
> | https://stat.ethz.ch/mailman/listinfo/r-package-devel
>
> --
> dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From edd @end|ng |rom deb|@n@org  Tue Jun  3 14:46:45 2025
From: edd @end|ng |rom deb|@n@org (Dirk Eddelbuettel)
Date: Tue, 3 Jun 2025 07:46:45 -0500
Subject: [R-pkg-devel] Check time > 10min
In-Reply-To: <CAAS8PAKZwX9RqGmAh5YanZ5he6bU72wT1uzrSbfOr+krNcPsFQ@mail.gmail.com>
References: <SY2PR01MB2539A7E395BB05E6720468D8AC62A@SY2PR01MB2539.ausprd01.prod.outlook.com>
 <26686.18371.483249.269223@rob.eddelbuettel.com>
 <CAAS8PAKZwX9RqGmAh5YanZ5he6bU72wT1uzrSbfOr+krNcPsFQ@mail.gmail.com>
Message-ID: <26686.61109.935429.678410@rob.eddelbuettel.com>


Greg,

On 3 June 2025 at 21:22, Greg Hunt wrote:
| Dirk,
| Even if he gets the test and example times to zero, his total time in that
| thirteen minute run is still above ten minutes.? In my view the incomplete time
| reporting (we don't know what makes up the thirteen minutes) is a bug in the
| build process.??

Are you aware of these (documented, if you know where to look) environment
variables?  (Copied from my ~/.R/check.Renviron, and 2 mins may be too tight.)

_R_CHECK_INSTALL_TIMING_CPU_TO_ELAPSED_THRESHOLD_=2
_R_CHECK_TIMINGS_=2
_R_CHECK_EXAMPLE_TIMING_CPU_TO_ELAPSED_THRESHOLD_=2
_R_CHECK_TEST_TIMING_CPU_TO_ELAPSED_THRESHOLD_=2

Also, I am lost between your dualing propositions 'test and example times
[are] zero' and 'still above ten minutes'. Can you re-explain? Generally zero
is in effect less than 10.  So I must be misunderstanding something.

Dirk

| 
| Greg?
| 
| On Tue, 3 Jun 2025 at 10:54, Dirk Eddelbuettel <edd at debian.org> wrote:
| 
| 
|     On 3 June 2025 at 00:12, Murray Efford via R-package-devel wrote:
|     | My revision of package 'secr' fails CRAN pre-test on Windows (R 4.5.0)
|     because total check time exceeds 10 min (it's 760 seconds or 13 min). I
|     can't see how to fix this as none of the times listed in the log https://
|     win-builder.r-project.org/incoming_pretest/secr_5.2.2_20250602_054847/
|     Windows/00check.log seems exceptional:
|     | * checking CRAN incoming feasibility ... [18s] OK
|     | * checking R code for possible problems ... [116s] OK
|     | * checking examples ... [87s] OK
|     | * checking tests ... [59s] OK
|     | * checking re-building of vignette outputs ... [42s] OK
|     | * checking PDF version of manual ... [32s] OK
|     | * checking HTML version of manual ... [42s] OK
|     | and the total of these components is only 396 sec (6.6 min), so I must be
|     missing something. I would appreciate any advice.? Not much was added in
|     this release, and I don't like the idea of blindly hacking off bits.
| 
|     To a first approximation every tests is a function of some variable we can
|     describe as 'N' which you, as author of the package and the tests,
|     understand
|     best.
| 
|     Surely you must know a way to define a new N1 <- N/2, or some other
|     appropriate scaling. Then try running with N1 instead. And you can also
|     make
|     both tests and examples _conditional_ on some other control variable.
| 
|     It's all just code. Bend it like Beckham.
| 
|     Dirk
| 
|     |
|     |? ? ? ?[[alternative HTML version deleted]]
|     |
|     | ______________________________________________
|     | R-package-devel at r-project.org mailing list
|     | https://stat.ethz.ch/mailman/listinfo/r-package-devel
| 
|     --
|     dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org
| 
|     ______________________________________________
|     R-package-devel at r-project.org mailing list
|     https://stat.ethz.ch/mailman/listinfo/r-package-devel
| 

-- 
dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From @eb@meyer @end|ng |rom |@u@de  Tue Jun  3 15:36:09 2025
From: @eb@meyer @end|ng |rom |@u@de (Sebastian Meyer)
Date: Tue, 3 Jun 2025 15:36:09 +0200
Subject: [R-pkg-devel] Check time > 10min
In-Reply-To: <CAAS8PAKZwX9RqGmAh5YanZ5he6bU72wT1uzrSbfOr+krNcPsFQ@mail.gmail.com>
References: <SY2PR01MB2539A7E395BB05E6720468D8AC62A@SY2PR01MB2539.ausprd01.prod.outlook.com>
 <26686.18371.483249.269223@rob.eddelbuettel.com>
 <CAAS8PAKZwX9RqGmAh5YanZ5he6bU72wT1uzrSbfOr+krNcPsFQ@mail.gmail.com>
Message-ID: <0657a2a0-d805-4d9d-a7b3-caaab068dc92@fau.de>

Am 03.06.25 um 13:22 schrieb Greg Hunt:
> Dirk,
> Even if he gets the test and example times to zero, his total time in that
> thirteen minute run is still above ten minutes.  In my view the incomplete
> time reporting (we don't know what makes up the thirteen minutes) is a bug
> in the build process.

It is indeed unfortunate and perhaps a bug that the Windows check log 
shows no runtime for

> * checking whether package 'secr' can be installed ... OK

(which on the Debian check machine was reported with 164s)

as well as for the following checks of package loading
(which takes relatively long for 'secr', even on Linux, ~5s each):

> * checking whether the package can be loaded ... OK
> * checking whether the package can be loaded with stated dependencies ... OK
> * checking whether the package can be unloaded cleanly ... OK
> * checking whether the namespace can be loaded with stated dependencies ... OK
> * checking whether the namespace can be unloaded cleanly ... OK
> * checking loading without being on the library search path ... OK
> * checking whether startup messages can be suppressed ... OK

Setting environment variable _R_CHECK_TIMINGS_=0 should reveal timings 
for these checks. (Check option --as-cran only shows timings above 10s 
by default.) I don't currently have a Windows machine at hand to test.

Best,

	Sebastian

> 
> Greg
> 
> On Tue, 3 Jun 2025 at 10:54, Dirk Eddelbuettel <edd at debian.org> wrote:
> 
>>
>> On 3 June 2025 at 00:12, Murray Efford via R-package-devel wrote:
>> | My revision of package 'secr' fails CRAN pre-test on Windows (R 4.5.0)
>> because total check time exceeds 10 min (it's 760 seconds or 13 min). I
>> can't see how to fix this as none of the times listed in the log
>> https://win-builder.r-project.org/incoming_pretest/secr_5.2.2_20250602_054847/Windows/00check.log
>> seems exceptional:
>> | * checking CRAN incoming feasibility ... [18s] OK
>> | * checking R code for possible problems ... [116s] OK
>> | * checking examples ... [87s] OK
>> | * checking tests ... [59s] OK
>> | * checking re-building of vignette outputs ... [42s] OK
>> | * checking PDF version of manual ... [32s] OK
>> | * checking HTML version of manual ... [42s] OK
>> | and the total of these components is only 396 sec (6.6 min), so I must
>> be missing something. I would appreciate any advice.  Not much was added in
>> this release, and I don't like the idea of blindly hacking off bits.
>>
>> To a first approximation every tests is a function of some variable we can
>> describe as 'N' which you, as author of the package and the tests,
>> understand
>> best.
>>
>> Surely you must know a way to define a new N1 <- N/2, or some other
>> appropriate scaling. Then try running with N1 instead. And you can also
>> make
>> both tests and examples _conditional_ on some other control variable.
>>
>> It's all just code. Bend it like Beckham.
>>
>> Dirk
>>
>> |
>> |       [[alternative HTML version deleted]]
>> |
>> | ______________________________________________
>> | R-package-devel at r-project.org mailing list
>> | https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>
>> --
>> dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From greg @end|ng |rom ||rm@n@y@h@com  Tue Jun  3 15:58:07 2025
From: greg @end|ng |rom ||rm@n@y@h@com (Greg Hunt)
Date: Tue, 3 Jun 2025 23:58:07 +1000
Subject: [R-pkg-devel] Check time > 10min
In-Reply-To: <26686.61109.935429.678410@rob.eddelbuettel.com>
References: <SY2PR01MB2539A7E395BB05E6720468D8AC62A@SY2PR01MB2539.ausprd01.prod.outlook.com>
 <26686.18371.483249.269223@rob.eddelbuettel.com>
 <CAAS8PAKZwX9RqGmAh5YanZ5he6bU72wT1uzrSbfOr+krNcPsFQ@mail.gmail.com>
 <26686.61109.935429.678410@rob.eddelbuettel.com>
Message-ID: <CAAS8PAJShxRsMqkfyCcoYAEE+B8=G8trXPzphLdfZDSXY2BhQQ@mail.gmail.com>

Dirk,
To clarify the reference to zero cost.

If Murray is being told that total time is thirteen minutes and that the
time needs to be less than ten, he might try to reduce the cost of tests
and examples, but they don't in total add up to the required three minutes.
Even if the combined cost of tests and examples is reduced to zero he is
still not below ten minutes.

Greg

On Tue, 3 Jun 2025 at 22:47, Dirk Eddelbuettel <edd at debian.org> wrote:

>
> Greg,
>
> On 3 June 2025 at 21:22, Greg Hunt wrote:
> | Dirk,
> | Even if he gets the test and example times to zero, his total time in
> that
> | thirteen minute run is still above ten minutes.  In my view the
> incomplete time
> | reporting (we don't know what makes up the thirteen minutes) is a bug in
> the
> | build process.
>
> Are you aware of these (documented, if you know where to look) environment
> variables?  (Copied from my ~/.R/check.Renviron, and 2 mins may be too
> tight.)
>
> _R_CHECK_INSTALL_TIMING_CPU_TO_ELAPSED_THRESHOLD_=2
> _R_CHECK_TIMINGS_=2
> _R_CHECK_EXAMPLE_TIMING_CPU_TO_ELAPSED_THRESHOLD_=2
> _R_CHECK_TEST_TIMING_CPU_TO_ELAPSED_THRESHOLD_=2
>
> Also, I am lost between your dualing propositions 'test and example times
> [are] zero' and 'still above ten minutes'. Can you re-explain? Generally
> zero
> is in effect less than 10.  So I must be misunderstanding something.
>
> Dirk
>
> |
> | Greg
> |
> | On Tue, 3 Jun 2025 at 10:54, Dirk Eddelbuettel <edd at debian.org> wrote:
> |
> |
> |     On 3 June 2025 at 00:12, Murray Efford via R-package-devel wrote:
> |     | My revision of package 'secr' fails CRAN pre-test on Windows (R
> 4.5.0)
> |     because total check time exceeds 10 min (it's 760 seconds or 13
> min). I
> |     can't see how to fix this as none of the times listed in the log
> https://
> |
> win-builder.r-project.org/incoming_pretest/secr_5.2.2_20250602_054847/
> |     Windows/00check.log seems exceptional:
> |     | * checking CRAN incoming feasibility ... [18s] OK
> |     | * checking R code for possible problems ... [116s] OK
> |     | * checking examples ... [87s] OK
> |     | * checking tests ... [59s] OK
> |     | * checking re-building of vignette outputs ... [42s] OK
> |     | * checking PDF version of manual ... [32s] OK
> |     | * checking HTML version of manual ... [42s] OK
> |     | and the total of these components is only 396 sec (6.6 min), so I
> must be
> |     missing something. I would appreciate any advice.  Not much was
> added in
> |     this release, and I don't like the idea of blindly hacking off bits.
> |
> |     To a first approximation every tests is a function of some variable
> we can
> |     describe as 'N' which you, as author of the package and the tests,
> |     understand
> |     best.
> |
> |     Surely you must know a way to define a new N1 <- N/2, or some other
> |     appropriate scaling. Then try running with N1 instead. And you can
> also
> |     make
> |     both tests and examples _conditional_ on some other control variable.
> |
> |     It's all just code. Bend it like Beckham.
> |
> |     Dirk
> |
> |     |
> |     |       [[alternative HTML version deleted]]
> |     |
> |     | ______________________________________________
> |     | R-package-devel at r-project.org mailing list
> |     | https://stat.ethz.ch/mailman/listinfo/r-package-devel
> |
> |     --
> |     dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org
> |
> |     ______________________________________________
> |     R-package-devel at r-project.org mailing list
> |     https://stat.ethz.ch/mailman/listinfo/r-package-devel
> |
>
> --
> dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org
>

	[[alternative HTML version deleted]]


From edd @end|ng |rom deb|@n@org  Tue Jun  3 16:06:02 2025
From: edd @end|ng |rom deb|@n@org (Dirk Eddelbuettel)
Date: Tue, 3 Jun 2025 09:06:02 -0500
Subject: [R-pkg-devel] Check time > 10min
In-Reply-To: <0657a2a0-d805-4d9d-a7b3-caaab068dc92@fau.de>
References: <SY2PR01MB2539A7E395BB05E6720468D8AC62A@SY2PR01MB2539.ausprd01.prod.outlook.com>
 <26686.18371.483249.269223@rob.eddelbuettel.com>
 <CAAS8PAKZwX9RqGmAh5YanZ5he6bU72wT1uzrSbfOr+krNcPsFQ@mail.gmail.com>
 <0657a2a0-d805-4d9d-a7b3-caaab068dc92@fau.de>
Message-ID: <26687.330.117944.869234@rob.eddelbuettel.com>


On 3 June 2025 at 15:36, Sebastian Meyer wrote:
| Am 03.06.25 um 13:22 schrieb Greg Hunt:
| > Dirk,
| > Even if he gets the test and example times to zero, his total time in that
| > thirteen minute run is still above ten minutes.  In my view the incomplete
| > time reporting (we don't know what makes up the thirteen minutes) is a bug
| > in the build process.
| 
| It is indeed unfortunate and perhaps a bug that the Windows check log 
| shows no runtime for

Oh I see.  Well I always took mine 'on another OS' as 'largely proportional'
which allowed me to, say, reduce overall test time by 50%.

It also helps that the testing framework I default to (tinytest, which I can
strongly recommend) defaults to showing test times so I generally have an
idea about relative 'cost' between different tests.

R itself adds timings to the test log but that is (arguably) rather hidden.
 
| > * checking whether package 'secr' can be installed ... OK
| 
| (which on the Debian check machine was reported with 164s)
| 
| as well as for the following checks of package loading
| (which takes relatively long for 'secr', even on Linux, ~5s each):
| 
| > * checking whether the package can be loaded ... OK
| > * checking whether the package can be loaded with stated dependencies ... OK
| > * checking whether the package can be unloaded cleanly ... OK
| > * checking whether the namespace can be loaded with stated dependencies ... OK
| > * checking whether the namespace can be unloaded cleanly ... OK
| > * checking loading without being on the library search path ... OK
| > * checking whether startup messages can be suppressed ... OK
| 
| Setting environment variable _R_CHECK_TIMINGS_=0 should reveal timings 
| for these checks. (Check option --as-cran only shows timings above 10s 
| by default.) I don't currently have a Windows machine at hand to test.

In general I think a policy of 'be more verbose' and 'have more generally
useful options on by default' would help.  This thread seems to show there
may be a need.

Cheers, Dirk

-- 
dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From edd @end|ng |rom deb|@n@org  Tue Jun  3 16:17:16 2025
From: edd @end|ng |rom deb|@n@org (Dirk Eddelbuettel)
Date: Tue, 3 Jun 2025 09:17:16 -0500
Subject: [R-pkg-devel] Check time > 10min
In-Reply-To: <CAAS8PAJShxRsMqkfyCcoYAEE+B8=G8trXPzphLdfZDSXY2BhQQ@mail.gmail.com>
References: <SY2PR01MB2539A7E395BB05E6720468D8AC62A@SY2PR01MB2539.ausprd01.prod.outlook.com>
 <26686.18371.483249.269223@rob.eddelbuettel.com>
 <CAAS8PAKZwX9RqGmAh5YanZ5he6bU72wT1uzrSbfOr+krNcPsFQ@mail.gmail.com>
 <26686.61109.935429.678410@rob.eddelbuettel.com>
 <CAAS8PAJShxRsMqkfyCcoYAEE+B8=G8trXPzphLdfZDSXY2BhQQ@mail.gmail.com>
Message-ID: <26687.1004.805489.563146@rob.eddelbuettel.com>


Greg,

On 3 June 2025 at 23:58, Greg Hunt wrote:
| To clarify the reference to zero cost.??
| 
| If Murray is being told that total time is thirteen minutes and that the time
| needs to be less than ten, he might try to reduce the cost of tests and
| examples, but they don't in total add up to the required three minutes. Even if
| the combined cost of tests and examples is reduced to zero he is still not
| below ten minutes.

It is my (possibly wrong) understanding that _total time_ is not limited, but
test and example time are. It is the latter two this thread is about, not the
total time. Total time is much higher for some packages (arrow, duckdb,
terra, my own RQuantLib, the various *stan* packages, ...).

Dirk

-- 
dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From greg @end|ng |rom ||rm@n@y@h@com  Tue Jun  3 16:19:25 2025
From: greg @end|ng |rom ||rm@n@y@h@com (Greg Hunt)
Date: Wed, 4 Jun 2025 00:19:25 +1000
Subject: [R-pkg-devel] Check time > 10min
In-Reply-To: <26687.1004.805489.563146@rob.eddelbuettel.com>
References: <SY2PR01MB2539A7E395BB05E6720468D8AC62A@SY2PR01MB2539.ausprd01.prod.outlook.com>
 <26686.18371.483249.269223@rob.eddelbuettel.com>
 <CAAS8PAKZwX9RqGmAh5YanZ5he6bU72wT1uzrSbfOr+krNcPsFQ@mail.gmail.com>
 <26686.61109.935429.678410@rob.eddelbuettel.com>
 <CAAS8PAJShxRsMqkfyCcoYAEE+B8=G8trXPzphLdfZDSXY2BhQQ@mail.gmail.com>
 <26687.1004.805489.563146@rob.eddelbuettel.com>
Message-ID: <CAAS8PA+Bpc2mEjBp0ranqN6Gr_7Ek0oUKf7EX7ntxTrAHSsCbw@mail.gmail.com>

Dirk,
In the original email, there was this:

* checking examples ... [87s] OK
* checking tests ... [59s] OK

Am I interpreting it wrong or are these numbers the elapsed times for
checking examples and tests?

Greg

On Wed, 4 Jun 2025 at 00:17, Dirk Eddelbuettel <edd at debian.org> wrote:

>
> Greg,
>
> On 3 June 2025 at 23:58, Greg Hunt wrote:
> | To clarify the reference to zero cost.
> |
> | If Murray is being told that total time is thirteen minutes and that the
> time
> | needs to be less than ten, he might try to reduce the cost of tests and
> | examples, but they don't in total add up to the required three minutes.
> Even if
> | the combined cost of tests and examples is reduced to zero he is still
> not
> | below ten minutes.
>
> It is my (possibly wrong) understanding that _total time_ is not limited,
> but
> test and example time are. It is the latter two this thread is about, not
> the
> total time. Total time is much higher for some packages (arrow, duckdb,
> terra, my own RQuantLib, the various *stan* packages, ...).
>
> Dirk
>
> --
> dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org
>

	[[alternative HTML version deleted]]


From edd @end|ng |rom deb|@n@org  Tue Jun  3 16:33:05 2025
From: edd @end|ng |rom deb|@n@org (Dirk Eddelbuettel)
Date: Tue, 3 Jun 2025 09:33:05 -0500
Subject: [R-pkg-devel] Check time > 10min
In-Reply-To: <CAAS8PA+Bpc2mEjBp0ranqN6Gr_7Ek0oUKf7EX7ntxTrAHSsCbw@mail.gmail.com>
References: <SY2PR01MB2539A7E395BB05E6720468D8AC62A@SY2PR01MB2539.ausprd01.prod.outlook.com>
 <26686.18371.483249.269223@rob.eddelbuettel.com>
 <CAAS8PAKZwX9RqGmAh5YanZ5he6bU72wT1uzrSbfOr+krNcPsFQ@mail.gmail.com>
 <26686.61109.935429.678410@rob.eddelbuettel.com>
 <CAAS8PAJShxRsMqkfyCcoYAEE+B8=G8trXPzphLdfZDSXY2BhQQ@mail.gmail.com>
 <26687.1004.805489.563146@rob.eddelbuettel.com>
 <CAAS8PA+Bpc2mEjBp0ranqN6Gr_7Ek0oUKf7EX7ntxTrAHSsCbw@mail.gmail.com>
Message-ID: <26687.1953.667043.581322@rob.eddelbuettel.com>


Greg,

On 4 June 2025 at 00:19, Greg Hunt wrote:
| In the original email, there was this:
| 
| * checking examples ... [87s] OK
| * checking tests ... [59s] OK
| 
| Am I interpreting it wrong or are these numbers the elapsed times for checking
| examples and tests???

If you follow the URL from the original post [1] you will see that it links
to a (Windows) check result ending in 'Status: OK'. No issue here.

Murray's original post also said '[it[ fails CRAN pre-test on Windows (R
4.5.0) because total check time exceeds 10 min (it's 760 seconds or 13 min)'.

So we are talking about two different checks.  As Seb alluded to, it is
unfortunate that the (failing) pre-check test does not give timings (whereas
the one you refer to does, but it did not fail).  Hth, and feel free to hit
me up off list with follow-ups as we may have gone on long enough on list.

Cheers, Dirk

[1] https://win-builder.r-project.org/incoming_pretest/secr_5.2.2_20250602_054847/Windows/00check.log

-- 
dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From murr@y@e||ord @end|ng |rom ot@go@@c@nz  Wed Jun  4 00:09:27 2025
From: murr@y@e||ord @end|ng |rom ot@go@@c@nz (Murray Efford)
Date: Tue, 3 Jun 2025 22:09:27 +0000
Subject: [R-pkg-devel] Check time > 10min
In-Reply-To: <26687.1953.667043.581322@rob.eddelbuettel.com>
References: <SY2PR01MB2539A7E395BB05E6720468D8AC62A@SY2PR01MB2539.ausprd01.prod.outlook.com>
 <26686.18371.483249.269223@rob.eddelbuettel.com>
 <CAAS8PAKZwX9RqGmAh5YanZ5he6bU72wT1uzrSbfOr+krNcPsFQ@mail.gmail.com>
 <26686.61109.935429.678410@rob.eddelbuettel.com>
 <CAAS8PAJShxRsMqkfyCcoYAEE+B8=G8trXPzphLdfZDSXY2BhQQ@mail.gmail.com>
 <26687.1004.805489.563146@rob.eddelbuettel.com>
 <CAAS8PA+Bpc2mEjBp0ranqN6Gr_7Ek0oUKf7EX7ntxTrAHSsCbw@mail.gmail.com>
 <26687.1953.667043.581322@rob.eddelbuettel.com>
Message-ID: <SY2PR01MB2539FB3F9750ED7807BDC139AC6DA@SY2PR01MB2539.ausprd01.prod.outlook.com>

Thanks to Dirk, Greg and Seb for grappling with this. The comments give me confidence to appeal to CRAN to wave this through as it stands - I think Uwe has obliged in the past, but I would rather not rely on that. More complete reporting of check times would be welcome.
Murray
________________________________
From: Dirk Eddelbuettel <edd at debian.org>
Sent: Wednesday, 4 June 2025 02:33
To: Greg Hunt <greg at firmansyah.com>
Cc: Dirk Eddelbuettel <edd at debian.org>; Murray Efford <murray.efford at otago.ac.nz>; R Package Development <r-package-devel at r-project.org>
Subject: Re: [R-pkg-devel] Check time > 10min


Greg,

On 4 June 2025 at 00:19, Greg Hunt wrote:
| In the original email, there was this:
|
| * checking examples ... [87s] OK
| * checking tests ... [59s] OK
|
| Am I interpreting it wrong or are these numbers the elapsed times for checking
| examples and tests?

If you follow the URL from the original post [1] you will see that it links
to a (Windows) check result ending in 'Status: OK'. No issue here.

Murray's original post also said '[it[ fails CRAN pre-test on Windows (R
4.5.0) because total check time exceeds 10 min (it's 760 seconds or 13 min)'.

So we are talking about two different checks.  As Seb alluded to, it is
unfortunate that the (failing) pre-check test does not give timings (whereas
the one you refer to does, but it did not fail).  Hth, and feel free to hit
me up off list with follow-ups as we may have gone on long enough on list.

Cheers, Dirk

[1] https://win-builder.r-project.org/incoming_pretest/secr_5.2.2_20250602_054847/Windows/00check.log<https://win-builder.r-project.org/incoming_pretest/secr_5.2.2_20250602_054847/Windows/00check.log>

--
dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org

	[[alternative HTML version deleted]]


From jo@h@m@u|r|ch @end|ng |rom gm@||@com  Wed Jun  4 03:13:02 2025
From: jo@h@m@u|r|ch @end|ng |rom gm@||@com (Joshua Ulrich)
Date: Tue, 3 Jun 2025 20:13:02 -0500
Subject: [R-pkg-devel] Check time > 10min
In-Reply-To: <SY2PR01MB2539FB3F9750ED7807BDC139AC6DA@SY2PR01MB2539.ausprd01.prod.outlook.com>
References: <SY2PR01MB2539A7E395BB05E6720468D8AC62A@SY2PR01MB2539.ausprd01.prod.outlook.com>
 <26686.18371.483249.269223@rob.eddelbuettel.com>
 <CAAS8PAKZwX9RqGmAh5YanZ5he6bU72wT1uzrSbfOr+krNcPsFQ@mail.gmail.com>
 <26686.61109.935429.678410@rob.eddelbuettel.com>
 <CAAS8PAJShxRsMqkfyCcoYAEE+B8=G8trXPzphLdfZDSXY2BhQQ@mail.gmail.com>
 <26687.1004.805489.563146@rob.eddelbuettel.com>
 <CAAS8PA+Bpc2mEjBp0ranqN6Gr_7Ek0oUKf7EX7ntxTrAHSsCbw@mail.gmail.com>
 <26687.1953.667043.581322@rob.eddelbuettel.com>
 <SY2PR01MB2539FB3F9750ED7807BDC139AC6DA@SY2PR01MB2539.ausprd01.prod.outlook.com>
Message-ID: <CAPPM_gSaKEjm=w2oib5LA20XfOi_taM8_GsD5BQVD6_q59dEsA@mail.gmail.com>

Hi Murray,

On Tue, Jun 3, 2025 at 5:09?PM Murray Efford via R-package-devel
<r-package-devel at r-project.org> wrote:
>
> Thanks to Dirk, Greg and Seb for grappling with this. The comments give me confidence to appeal to CRAN to wave this through as it stands - I think Uwe has obliged in the past, but I would rather not rely on that. More complete reporting of check times would be welcome.
> Murray
>
I ran `R CMD check secr` on my Ubuntu machine and just the install
took a couple minutes (on one core). That time isn't reported as a
line item in the win-builder check log, but was close to half my total
check time. You might not have noticed this if you use something like
ccache.

For what it's worth, I'm running a Ryzen 7 3700X w/64GB of RAM that
was otherwise mostly idle. Here's the command I ran, with a few of the
reported timings for reference.

#> time CCACHE_DISABLE=1 _R_CHECK_TIMINGS_=0 R CMD check secr_5.2.4.tar.gz
* checking whether package 'secr' can be installed ... [152s/152s] OK
...
* checking R code for possible problems ... [30s/30s] OK
...
* checking re-building of vignette outputs ... [13s/13s] OK
* checking PDF version of manual ... [9s/9s] OK
...
real    5m23.509s
user    4m57.181s
sys     0m23.679s

Obviously my machine isn't win-builder, but it does suggest
installation is a big part of the total check time.

Best,
Josh

> ________________________________
> From: Dirk Eddelbuettel <edd at debian.org>
> Sent: Wednesday, 4 June 2025 02:33
> To: Greg Hunt <greg at firmansyah.com>
> Cc: Dirk Eddelbuettel <edd at debian.org>; Murray Efford <murray.efford at otago.ac.nz>; R Package Development <r-package-devel at r-project.org>
> Subject: Re: [R-pkg-devel] Check time > 10min
>
>
> Greg,
>
> On 4 June 2025 at 00:19, Greg Hunt wrote:
> | In the original email, there was this:
> |
> | * checking examples ... [87s] OK
> | * checking tests ... [59s] OK
> |
> | Am I interpreting it wrong or are these numbers the elapsed times for checking
> | examples and tests?
>
> If you follow the URL from the original post [1] you will see that it links
> to a (Windows) check result ending in 'Status: OK'. No issue here.
>
> Murray's original post also said '[it[ fails CRAN pre-test on Windows (R
> 4.5.0) because total check time exceeds 10 min (it's 760 seconds or 13 min)'.
>
> So we are talking about two different checks.  As Seb alluded to, it is
> unfortunate that the (failing) pre-check test does not give timings (whereas
> the one you refer to does, but it did not fail).  Hth, and feel free to hit
> me up off list with follow-ups as we may have gone on long enough on list.
>
> Cheers, Dirk
>
> [1] https://win-builder.r-project.org/incoming_pretest/secr_5.2.2_20250602_054847/Windows/00check.log<https://win-builder.r-project.org/incoming_pretest/secr_5.2.2_20250602_054847/Windows/00check.log>
>
> --
> dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel



--
Joshua Ulrich  |  about.me/joshuaulrich
FOSS Trading  |  www.fosstrading.com


From |kry|ov @end|ng |rom d|@root@org  Wed Jun  4 13:40:08 2025
From: |kry|ov @end|ng |rom d|@root@org (Ivan Krylov)
Date: Wed, 4 Jun 2025 14:40:08 +0300
Subject: [R-pkg-devel] Check time > 10min
In-Reply-To: <0657a2a0-d805-4d9d-a7b3-caaab068dc92@fau.de>
References: <SY2PR01MB2539A7E395BB05E6720468D8AC62A@SY2PR01MB2539.ausprd01.prod.outlook.com>
 <26686.18371.483249.269223@rob.eddelbuettel.com>
 <CAAS8PAKZwX9RqGmAh5YanZ5he6bU72wT1uzrSbfOr+krNcPsFQ@mail.gmail.com>
 <0657a2a0-d805-4d9d-a7b3-caaab068dc92@fau.de>
Message-ID: <20250604144008.348d0540@arachnoid>

On Tue, 3 Jun 2025 15:36:09 +0200
Sebastian Meyer <seb.meyer at fau.de> wrote:

> It is indeed unfortunate and perhaps a bug that the Windows check log 
> shows no runtime for
> 
> > * checking whether package 'secr' can be installed ... OK  
> 
> (which on the Debian check machine was reported with 164s)

On the same computer, Windows 10 in a virtual machine reported 235s,
and a Debian testing container reported 174s, but that may well be due
to virtualisation overhead.

Adding PKG_CXXFLAGS=-pedantic makes g++ on Windows produce the same 69
MiB of warnings that can be seen in the incoming_pretest directory on
Win-Builder, mostly about non-standard suffixes on floating constants
in BOOST_MATH_BIG_CONSTANT(). As a result, installation takes 320s
instead of 235, although the increase in peak working set size of
cc1plus.exe is negligible.

-- 
Best regards,
Ivan


From ro||turner @end|ng |rom po@teo@net  Fri Jun  6 00:12:34 2025
From: ro||turner @end|ng |rom po@teo@net (Rolf Turner)
Date: Thu,  5 Jun 2025 22:12:34 +0000
Subject: [R-pkg-devel] Changing the title of a package.
Message-ID: <20250606101234.4f57f667@new-hp>



Currently the title line in the DESCRIPTION file for my kanova package
reads

    Title: Pseudo Anova for K-Functions

and I would like it to read

    Title: Quasi Anova for K-Functions

The reason I want to make this change is that I am writing, with a
co-author, a paper on the underlying ideas, and my co-author wants the
title of the paper to be "Quasi analysis of variance for K-Functions"
rather than "Pseudo analysis of variance for K-Functions" (as I
initially had it).  My co-author is of course quite right.

I would like the title in the DESCRIPTION file to be consistent with the
title of the paper.

To get to the point: can I just simply change the title in the
DESCRIPTION file, or will there be repercussions in the form of NOTEs
WARNINGs or ERRORs that I will somehow have to deal with?  (And if so,
how do I deal with them?)

Grateful for any advice.

cheers,

Rolf

-- 
Honorary Research Fellow
Department of Statistics
University of Auckland
Stats. Dep't. (secretaries) phone:
         +64-9-373-7599 ext. 89622
Home phone: +64-9-480-4619


From m|ch@e|ch|r|co4 @end|ng |rom gm@||@com  Fri Jun  6 00:21:53 2025
From: m|ch@e|ch|r|co4 @end|ng |rom gm@||@com (Michael Chirico)
Date: Thu, 5 Jun 2025 15:21:53 -0700
Subject: [R-pkg-devel] Changing the title of a package.
In-Reply-To: <20250606101234.4f57f667@new-hp>
References: <20250606101234.4f57f667@new-hp>
Message-ID: <CAPRVBcxxP53H5kLGb2F+hvFWUjWUm7psf59fQj68mHMKQ_6tSQ@mail.gmail.com>

Hi Rolf, the first step of course is "just do it" -- have you edited the
title, and run R CMD check --as-cran? What NOTE/WARNING/ERROR did you see?

Mike C

On Thu, Jun 5, 2025 at 3:12?PM Rolf Turner <rolfturner at posteo.net> wrote:

>
>
> Currently the title line in the DESCRIPTION file for my kanova package
> reads
>
>     Title: Pseudo Anova for K-Functions
>
> and I would like it to read
>
>     Title: Quasi Anova for K-Functions
>
> The reason I want to make this change is that I am writing, with a
> co-author, a paper on the underlying ideas, and my co-author wants the
> title of the paper to be "Quasi analysis of variance for K-Functions"
> rather than "Pseudo analysis of variance for K-Functions" (as I
> initially had it).  My co-author is of course quite right.
>
> I would like the title in the DESCRIPTION file to be consistent with the
> title of the paper.
>
> To get to the point: can I just simply change the title in the
> DESCRIPTION file, or will there be repercussions in the form of NOTEs
> WARNINGs or ERRORs that I will somehow have to deal with?  (And if so,
> how do I deal with them?)
>
> Grateful for any advice.
>
> cheers,
>
> Rolf
>
> --
> Honorary Research Fellow
> Department of Statistics
> University of Auckland
> Stats. Dep't. (secretaries) phone:
>          +64-9-373-7599 ext. 89622
> Home phone: +64-9-480-4619
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org  Fri Jun  6 01:02:30 2025
From: @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org (Spencer Graves)
Date: Thu, 5 Jun 2025 18:02:30 -0500
Subject: [R-pkg-devel] Changing the title of a package.
In-Reply-To: <CAPRVBcxxP53H5kLGb2F+hvFWUjWUm7psf59fQj68mHMKQ_6tSQ@mail.gmail.com>
References: <20250606101234.4f57f667@new-hp>
 <CAPRVBcxxP53H5kLGb2F+hvFWUjWUm7psf59fQj68mHMKQ_6tSQ@mail.gmail.com>
Message-ID: <5696641a-755c-4e40-8947-9a7693795ccb@effectivedefense.org>

I suggest you copy the package, give one the new name, and submit it. 
After it has been accepted and is on CRAN, replace the other with a 
something that says, "This package has been replaced by _______."


FYI, I did something like that. Prior to 2010 Sundar Dorai-Raj and I 
created a package called "RSiteSearch". I asked this group for 
suggestions for a better name. Someone suggested "sos". I do not 
remember exactly how I did it, but it was roughly like what I just 
described.


It worked ;-)


Hope this helps. sg


On 6/5/25 17:21, Michael Chirico wrote:
> Hi Rolf, the first step of course is "just do it" -- have you edited the
> title, and run R CMD check --as-cran? What NOTE/WARNING/ERROR did you see?
> 
> Mike C
> 
> On Thu, Jun 5, 2025 at 3:12?PM Rolf Turner <rolfturner at posteo.net> wrote:
> 
>>
>>
>> Currently the title line in the DESCRIPTION file for my kanova package
>> reads
>>
>>      Title: Pseudo Anova for K-Functions
>>
>> and I would like it to read
>>
>>      Title: Quasi Anova for K-Functions
>>
>> The reason I want to make this change is that I am writing, with a
>> co-author, a paper on the underlying ideas, and my co-author wants the
>> title of the paper to be "Quasi analysis of variance for K-Functions"
>> rather than "Pseudo analysis of variance for K-Functions" (as I
>> initially had it).  My co-author is of course quite right.
>>
>> I would like the title in the DESCRIPTION file to be consistent with the
>> title of the paper.
>>
>> To get to the point: can I just simply change the title in the
>> DESCRIPTION file, or will there be repercussions in the form of NOTEs
>> WARNINGs or ERRORs that I will somehow have to deal with?  (And if so,
>> how do I deal with them?)
>>
>> Grateful for any advice.
>>
>> cheers,
>>
>> Rolf
>>
>> --
>> Honorary Research Fellow
>> Department of Statistics
>> University of Auckland
>> Stats. Dep't. (secretaries) phone:
>>           +64-9-373-7599 ext. 89622
>> Home phone: +64-9-480-4619
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From ro||turner @end|ng |rom po@teo@net  Fri Jun  6 01:13:58 2025
From: ro||turner @end|ng |rom po@teo@net (Rolf Turner)
Date: Thu,  5 Jun 2025 23:13:58 +0000
Subject: [R-pkg-devel] Changing the title of a package.
In-Reply-To: <5696641a-755c-4e40-8947-9a7693795ccb@effectivedefense.org>
References: <20250606101234.4f57f667@new-hp>
 <CAPRVBcxxP53H5kLGb2F+hvFWUjWUm7psf59fQj68mHMKQ_6tSQ@mail.gmail.com>
 <5696641a-755c-4e40-8947-9a7693795ccb@effectivedefense.org>
Message-ID: <20250606111358.1d2343cb@new-hp>

On Thu, 5 Jun 2025 18:02:30 -0500
Spencer Graves <spencer.graves at effectivedefense.org> wrote:

> I suggest you copy the package, give one the new name, and submit it. 
> After it has been accepted and is on CRAN, replace the other with a 
> something that says, "This package has been replaced by _______."
> 
> 
> FYI, I did something like that. Prior to 2010 Sundar Dorai-Raj and I 
> created a package called "RSiteSearch". I asked this group for 
> suggestions for a better name. Someone suggested "sos". I do not 
> remember exactly how I did it, but it was roughly like what I just 
> described.
> 
> 
> It worked ;-)

Note that I am not trying to change the *NAME* of the package, but
rather the *title* (in the DESCRIPTION file).

cheers,

Rolf


-- 
Honorary Research Fellow
Department of Statistics
University of Auckland
Stats. Dep't. (secretaries) phone:
         +64-9-373-7599 ext. 89622
Home phone: +64-9-480-4619


From murdoch@dunc@n @end|ng |rom gm@||@com  Fri Jun  6 01:49:48 2025
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Thu, 5 Jun 2025 19:49:48 -0400
Subject: [R-pkg-devel] Changing the title of a package.
In-Reply-To: <20250606101234.4f57f667@new-hp>
References: <20250606101234.4f57f667@new-hp>
Message-ID: <e0e3f5b4-f541-4c44-984f-1bf2db422254@gmail.com>

I'm pretty sure CRAN doesn't care what is in the title, as long as

  - The new one follows their rules (re capitalization etc.)
  - The change doesn't follow the last package change too rapidly.

It would be best if you change the title at the same time as you are 
releasing other changes to the package.  If the title change is the only 
change in a resubmission, that wastes their time.

Duncan Murdoch

On 2025-06-05 6:12 p.m., Rolf Turner wrote:
> 
> 
> Currently the title line in the DESCRIPTION file for my kanova package
> reads
> 
>      Title: Pseudo Anova for K-Functions
> 
> and I would like it to read
> 
>      Title: Quasi Anova for K-Functions
> 
> The reason I want to make this change is that I am writing, with a
> co-author, a paper on the underlying ideas, and my co-author wants the
> title of the paper to be "Quasi analysis of variance for K-Functions"
> rather than "Pseudo analysis of variance for K-Functions" (as I
> initially had it).  My co-author is of course quite right.
> 
> I would like the title in the DESCRIPTION file to be consistent with the
> title of the paper.
> 
> To get to the point: can I just simply change the title in the
> DESCRIPTION file, or will there be repercussions in the form of NOTEs
> WARNINGs or ERRORs that I will somehow have to deal with?  (And if so,
> how do I deal with them?)
> 
> Grateful for any advice.
> 
> cheers,
> 
> Rolf
>


From ||u|@@rev|||@ @end|ng |rom gm@||@com  Fri Jun  6 08:00:00 2025
From: ||u|@@rev|||@ @end|ng |rom gm@||@com (=?UTF-8?Q?Llu=C3=ADs_Revilla?=)
Date: Fri, 6 Jun 2025 08:00:00 +0200
Subject: [R-pkg-devel] Cross-references and dependencies
Message-ID: <CAN+W6_vz+EPumExHuNLTM11zuT+NrEr7uFh961v6MKd+R4Ti7A@mail.gmail.com>

Dear package developers,

I was reading section 2.5 Cross-references of Writing R Extensions and I
found the following sentence.

The last sentence of the  section [1] is:
> Packages referred to by these ?other forms? should be declared in the
DESCRIPTION file, in the ?Depends?, ?Imports?, ?Suggests? or ?Enhances?
fields.

These "other forms" I understand are those not using a topic for anchoring
(\link[=topic]{text}), but using the package like \link[pkg]{text} or
\link[pkg:topic]{text}.
But my question is how to interpret this "declared in the DESCRIPTION
file". Should all packages be listed as  a direct dependency, or could they
also be on a recursive dependency?

As far as I could tell there is currently no check on R, or repositories
checks, for this and some R documentation files have cross-references to
packages outside their (recursive) dependency tree.
This results in the following error message (on my IDE) when following the
cross-reference: URL '/help/library/<pkg>/help/<topic> not found.

Best,

Llu?s

[1]:
https://cran.r-project.org/doc/manuals/r-devel/R-exts.html#Cross_002dreferences-1

	[[alternative HTML version deleted]]


From ro||turner @end|ng |rom po@teo@net  Sat Jun  7 01:16:26 2025
From: ro||turner @end|ng |rom po@teo@net (Rolf Turner)
Date: Fri,  6 Jun 2025 23:16:26 +0000
Subject: [R-pkg-devel] Changing the title of a package.
In-Reply-To: <e0e3f5b4-f541-4c44-984f-1bf2db422254@gmail.com>
References: <20250606101234.4f57f667@new-hp>
 <e0e3f5b4-f541-4c44-984f-1bf2db422254@gmail.com>
Message-ID: <20250607111626.2daf54ed@new-hp>


On Thu, 5 Jun 2025 19:49:48 -0400
Duncan Murdoch <murdoch.duncan at gmail.com> wrote:

> I'm pretty sure CRAN doesn't care what is in the title, as long as
> 
>   - The new one follows their rules (re capitalization etc.)
>   - The change doesn't follow the last package change too rapidly.
> 
> It would be best if you change the title at the same time as you are 
> releasing other changes to the package.  If the title change is the
> only change in a resubmission, that wastes their time.

That looks like wise counsel.  Thamks Duncan.

cheers,

Rolf

-- 
Honorary Research Fellow
Department of Statistics
University of Auckland
Stats. Dep't. (secretaries) phone:
         +64-9-373-7599 ext. 89622
Home phone: +64-9-480-4619


From rwo|d|ord @end|ng |rom uw@ter|oo@c@  Mon Jun  9 00:24:11 2025
From: rwo|d|ord @end|ng |rom uw@ter|oo@c@ (Wayne Oldford)
Date: Sun, 8 Jun 2025 22:24:11 +0000
Subject: [R-pkg-devel] Tcl/Tk version difficulty building loon package on
 Unix ??
Message-ID: <YT3PR01MB10313A0B4922E186A856A4718C768A@YT3PR01MB10313.CANPRD01.PROD.OUTLOOK.COM>

Hello

I am at my wit?s end trying to get the loon package to NOT generate an error under the various unix OS?s  (Debian etc.).
It passes on Mac and on Windows.

Loon depends on Tcl/Tk (and much of it is implemented in Tcl/Tk).

As I understand it, the problem appears to be that package testing under Unix uses an R built with Tcl/Tk version 9.0.1
Loon use to require Tcl 8.6. (the version bundled in R distribution).

I think I have excised the version number 8.6 everywhere in the package and am only asking that the version >= 8.6.
Nevertheless, the package cannot be installed under unix without error.

I?m hoping that someone has had a similar experience with an R package that uses tcl/tk and might have some suggestions that will save me some time.
(I am trying to avoid at this time building R from source with Tcl/Tk version 9.0.1 instead of the 8.6 bundled in distribution,  Will if I must ? though a new experience for me.)

Any help, suggestions, etc. would be appreciated.

The automatic message produced from testing the package appears at the end of this message.
Note that the errors appearing in the ?released? 1.4.2 loon are the ones I am trying to address with the changes I have made in 1.4.3.
If anyone feels the need to examine the current source, it is presently only available on my github (a fork of the released)
https://github.com/rwoldford/loon

Thanks in advance

Wayne Oldford

______________

R.W. Oldford
Professor of Statistics
University of Waterloo

math.uwaterloo.ca/~rwoldfor
______________





From: ligges at statistik.tu-dortmund.de<mailto:ligges at statistik.tu-dortmund.de> ligges at statistik.tu-dortmund.de<mailto:ligges at statistik.tu-dortmund.de>
Date: Sunday, June 8, 2025 at 5:59?PM
To: Wayne Oldford rwoldford at uwaterloo.ca<mailto:rwoldford at uwaterloo.ca>
Cc: CRAN-submissions at R-project.org<mailto:CRAN-submissions at R-project.org> CRAN-submissions at R-project.org<mailto:CRAN-submissions at R-project.org>
Subject: [CRAN-pretest-archived] CRAN Submission loon 1.4.3
Dear maintainer,

package loon_1.4.3.tar.gz does not pass the incoming checks automatically, please see the following pre-tests (additional issue checks):
Windows: <https://win-builder.r-project.org/incoming_pretest/loon_1.4.3_20250608_234922/Windows/00check.log>
Status: OK
Debian: <https://win-builder.r-project.org/incoming_pretest/loon_1.4.3_20250608_234922/Debian/00check.log>
Status: 1 ERROR

Last released version's CRAN status: OK: 9, ERROR: 4
See: <https://CRAN.R-project.org/web/checks/check_results_loon.html>

Last released version's additional issues:
  noSuggests <https://www.stats.ox.ac.uk/pub/bdr/noSuggests/loon.out>

CRAN Web: <https://cran.r-project.org/package=loon>

Please fix all problems and resubmit a fixed version via the webform.
If you are not sure how to fix the problems shown, please ask for help on the R-package-devel mailing list:
<https://stat.ethz.ch/mailman/listinfo/r-package-devel>
If you are fairly certain the rejection is a false positive, please reply-all to this message and explain.

More details are given in the directory:
<https://win-builder.r-project.org/incoming_pretest/loon_1.4.3_20250608_234922/>
The files will be removed after roughly 7 days.

*** Strong rev. depends ***: diveR loon.ggplot loon.shiny loon.tourr rfviz

Best regards,
CRAN teams' auto-check service

	[[alternative HTML version deleted]]


From murdoch@dunc@n @end|ng |rom gm@||@com  Mon Jun  9 13:40:49 2025
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Mon, 9 Jun 2025 07:40:49 -0400
Subject: [R-pkg-devel] 
 Tcl/Tk version difficulty building loon package on Unix ??
In-Reply-To: <YT3PR01MB10313A0B4922E186A856A4718C768A@YT3PR01MB10313.CANPRD01.PROD.OUTLOOK.COM>
References: <YT3PR01MB10313A0B4922E186A856A4718C768A@YT3PR01MB10313.CANPRD01.PROD.OUTLOOK.COM>
Message-ID: <f72d89ab-cf73-4b75-871c-ae4ac7d0327a@gmail.com>

I've had some private messages with Wayne; here's some info and a 
question in case someone else wants to follow this up:

  - I can install his new version of loon on Ubuntu without a problem, 
but my R build uses tcl/tk 8.6.
  - I haven't built tcl/tk 9.0.1, and like Wayne, would like to avoid 
that.  Is there a Github action that would install it?

Duncan Murdoch

On 2025-06-08 6:24 p.m., Wayne Oldford wrote:
> Hello
> 
> I am at my wit?s end trying to get the loon package to NOT generate an error under the various unix OS?s  (Debian etc.).
> It passes on Mac and on Windows.
> 
> Loon depends on Tcl/Tk (and much of it is implemented in Tcl/Tk).
> 
> As I understand it, the problem appears to be that package testing under Unix uses an R built with Tcl/Tk version 9.0.1
> Loon use to require Tcl 8.6. (the version bundled in R distribution).
> 
> I think I have excised the version number 8.6 everywhere in the package and am only asking that the version >= 8.6.
> Nevertheless, the package cannot be installed under unix without error.
> 
> I?m hoping that someone has had a similar experience with an R package that uses tcl/tk and might have some suggestions that will save me some time.
> (I am trying to avoid at this time building R from source with Tcl/Tk version 9.0.1 instead of the 8.6 bundled in distribution,  Will if I must ? though a new experience for me.)
> 
> Any help, suggestions, etc. would be appreciated.
> 
> The automatic message produced from testing the package appears at the end of this message.
> Note that the errors appearing in the ?released? 1.4.2 loon are the ones I am trying to address with the changes I have made in 1.4.3.
> If anyone feels the need to examine the current source, it is presently only available on my github (a fork of the released)
> https://github.com/rwoldford/loon
> 
> Thanks in advance
> 
> Wayne Oldford
> 
> ______________
> 
> R.W. Oldford
> Professor of Statistics
> University of Waterloo
> 
> math.uwaterloo.ca/~rwoldfor
> ______________
> 
> 
> 
> 
> 
> From: ligges at statistik.tu-dortmund.de<mailto:ligges at statistik.tu-dortmund.de> ligges at statistik.tu-dortmund.de<mailto:ligges at statistik.tu-dortmund.de>
> Date: Sunday, June 8, 2025 at 5:59?PM
> To: Wayne Oldford rwoldford at uwaterloo.ca<mailto:rwoldford at uwaterloo.ca>
> Cc: CRAN-submissions at R-project.org<mailto:CRAN-submissions at R-project.org> CRAN-submissions at R-project.org<mailto:CRAN-submissions at R-project.org>
> Subject: [CRAN-pretest-archived] CRAN Submission loon 1.4.3
> Dear maintainer,
> 
> package loon_1.4.3.tar.gz does not pass the incoming checks automatically, please see the following pre-tests (additional issue checks):
> Windows: <https://win-builder.r-project.org/incoming_pretest/loon_1.4.3_20250608_234922/Windows/00check.log>
> Status: OK
> Debian: <https://win-builder.r-project.org/incoming_pretest/loon_1.4.3_20250608_234922/Debian/00check.log>
> Status: 1 ERROR
> 
> Last released version's CRAN status: OK: 9, ERROR: 4
> See: <https://CRAN.R-project.org/web/checks/check_results_loon.html>
> 
> Last released version's additional issues:
>    noSuggests <https://www.stats.ox.ac.uk/pub/bdr/noSuggests/loon.out>
> 
> CRAN Web: <https://cran.r-project.org/package=loon>
> 
> Please fix all problems and resubmit a fixed version via the webform.
> If you are not sure how to fix the problems shown, please ask for help on the R-package-devel mailing list:
> <https://stat.ethz.ch/mailman/listinfo/r-package-devel>
> If you are fairly certain the rejection is a false positive, please reply-all to this message and explain.
> 
> More details are given in the directory:
> <https://win-builder.r-project.org/incoming_pretest/loon_1.4.3_20250608_234922/>
> The files will be removed after roughly 7 days.
> 
> *** Strong rev. depends ***: diveR loon.ggplot loon.shiny loon.tourr rfviz
> 
> Best regards,
> CRAN teams' auto-check service
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From |kry|ov @end|ng |rom d|@root@org  Mon Jun  9 13:45:35 2025
From: |kry|ov @end|ng |rom d|@root@org (Ivan Krylov)
Date: Mon, 9 Jun 2025 14:45:35 +0300
Subject: [R-pkg-devel] 
 Tcl/Tk version difficulty building loon package on Unix ??
In-Reply-To: <YT3PR01MB10313A0B4922E186A856A4718C768A@YT3PR01MB10313.CANPRD01.PROD.OUTLOOK.COM>
References: <YT3PR01MB10313A0B4922E186A856A4718C768A@YT3PR01MB10313.CANPRD01.PROD.OUTLOOK.COM>
Message-ID: <20250609144535.4a6c2865@arachnoid>

? Sun, 8 Jun 2025 22:24:11 +0000
Wayne Oldford <rwoldford at uwaterloo.ca> ?????:

> As I understand it, the problem appears to be that package testing
> under Unix uses an R built with Tcl/Tk version 9.0.1
<...>
> I think I have excised the version number 8.6 everywhere in the
> package and am only asking that the version >= 8.6.
> Nevertheless, the package cannot be installed under unix without
> error.

The failure happens on the Tcl side of the equation:

R> tcl('lappend', 'auto_path', 'loon/inst/tcl')
<Tcl> //zipfs:/lib/tcl/tcl_library //zipfs:/lib/tcl ./lib
REDACTED/tcl9.0.1/lib //zipfs:/lib/tk/tk_library
//zipfs:/lib/tk/tk_library/ttk REDACTED/library/tcltk/exec loon/inst/tcl
R> tcltk::.Tcl('package require loon')
Error in structure(.External(.C_dotTcl, ...), class = "tclObj") :
  [tcl] can't read "tcl_platform(os)": no such variable.

Since other places in the code already use $::tcl_platform to access
the global variable, patching the two remaining uses lets the package
pass .onLoad:

--- loon_1.4.3.orig/loon/inst/tcl/loon/library/optionDatabase.tcl	2021-04-09 17:58:00.000000000 +0300
+++ loon_1.4.3/loon/inst/tcl/loon/library/optionDatabase.tcl	2025-06-09 14:05:18.000000000 +0300
@@ -126,7 +126,7 @@
 
 
     ## Mouse Meta mapping
-    if {$tcl_platform(os) eq "Linux"} {
+    if {$::tcl_platform(os) eq "Linux"} {
 	# on my machine Option is always pressed if NumLock is on
 	set Options(metaKeys) {Command Shift Control Alt}
     } else {
@@ -134,7 +134,7 @@
     }
 
     set Options(metaMulSel) Shift
-    if {$tcl_platform(os) eq "Darwin"} {
+    if {$::tcl_platform(os) eq "Darwin"} {
 	set Options(metaTempMove) Control
     } else {
 	set Options(metaTempMove) Control


-- 
Best regards,
Ivan


From edd @end|ng |rom deb|@n@org  Mon Jun  9 14:09:45 2025
From: edd @end|ng |rom deb|@n@org (Dirk Eddelbuettel)
Date: Mon, 9 Jun 2025 07:09:45 -0500
Subject: [R-pkg-devel] 
 Tcl/Tk version difficulty building loon package on Unix ??
In-Reply-To: <f72d89ab-cf73-4b75-871c-ae4ac7d0327a@gmail.com>
References: <YT3PR01MB10313A0B4922E186A856A4718C768A@YT3PR01MB10313.CANPRD01.PROD.OUTLOOK.COM>
 <f72d89ab-cf73-4b75-871c-ae4ac7d0327a@gmail.com>
Message-ID: <26694.53001.991166.363734@rob.eddelbuettel.com>


On 9 June 2025 at 07:40, Duncan Murdoch wrote:
| I've had some private messages with Wayne; here's some info and a 
| question in case someone else wants to follow this up:
| 
|   - I can install his new version of loon on Ubuntu without a problem, 
| but my R build uses tcl/tk 8.6.

R 'records' its tcl/tk version chosen via 'configure' when building. To
differentiate between 8.6 and 9.0 here Wayne and/or you likely need to
rebuild R. For what it is worth, my sources for the Debian packaging are
still at 8.6 (explicitly selecting it) and hence are the Ubuntu binaries at
CRAN.  Debian does have tcl8.6-dev along with tcl9.0-dev.

|   - I haven't built tcl/tk 9.0.1, and like Wayne, would like to avoid 
| that.  Is there a Github action that would install it?

I would recommend a container, and starting from one of the standard 'how to
build R setups'. A possible one is my 'daily R patched' (drp) one at

  https://github.com/rocker-org/drp

which builds weekly. You would just have to change tcl (and presumably tk) to
9.0 in the Dockerfile at

  https://github.com/rocker-org/drp/blob/master/Dockerfile

in line 57 and 64 replacing, respectively, tcl-dev with tcl9.0-dev and tk-dev
with tk9.0-dev.  [ Debian tends to change such common infrastructure packages
in a coordinated wave (called 'transition'), and we have not had one yet for
tcl/tk 9.0. ]

Rebuilding the container (which one can do in an action) will get you
r-patched with the 9.0 versions of tck and tk which should allow some client
testing (in 'loon') to accommodate accordingly (which another action can
call). Of course just doing it locally also works and is easier. While at it,
it would be nice if the package could (just like 'rgl' does) work around a
missing x11 at package install, currently headless setups need to explicitly
wrap this in xvfb.

Hope this helps. Feel free to ping me off-list if the Docker use is unclear
yet is something you want to try.

Best, Dirk

-- 
dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From rwo|d|ord @end|ng |rom uw@ter|oo@c@  Tue Jun 10 22:07:47 2025
From: rwo|d|ord @end|ng |rom uw@ter|oo@c@ (Wayne Oldford)
Date: Tue, 10 Jun 2025 20:07:47 +0000
Subject: [R-pkg-devel] 
 Tcl/Tk version difficulty building loon package on Unix ??
In-Reply-To: <26694.53001.991166.363734@rob.eddelbuettel.com>
References: <YT3PR01MB10313A0B4922E186A856A4718C768A@YT3PR01MB10313.CANPRD01.PROD.OUTLOOK.COM>
 <f72d89ab-cf73-4b75-871c-ae4ac7d0327a@gmail.com>
 <26694.53001.991166.363734@rob.eddelbuettel.com>
Message-ID: <YT3PR01MB103139A0CAA0BAD565D8F433FC76AA@YT3PR01MB10313.CANPRD01.PROD.OUTLOOK.COM>

Thanks to everyone.  I think I have it fixed now ?

The (main) problem I was having was related to scoping changes from Tcl/Tk 8.6.x to  9.0.x.
Greater care in explicitly referencing some symbols as global (e.g. $::tcl_platform as opposed to  $tcl_platform) in my Tcl/Tk code now seems to have successfully addressed the issue.

Information from each of  Duncan Murdoch, Ivan Krylov, and Brian Ripley proved to be invaluable.
Much appreciated

Wayne

From: Dirk Eddelbuettel <edd at debian.org>
Date: Monday, June 9, 2025 at 8:09?AM
To: Duncan Murdoch <murdoch.duncan at gmail.com>
Cc: Wayne Oldford <rwoldford at uwaterloo.ca>, R-package-devel at r-project.org <R-package-devel at r-project.org>
Subject: Re: [R-pkg-devel] Tcl/Tk version difficulty building loon package on Unix ??

On 9 June 2025 at 07:40, Duncan Murdoch wrote:
| I've had some private messages with Wayne; here's some info and a
| question in case someone else wants to follow this up:
|
|   - I can install his new version of loon on Ubuntu without a problem,
| but my R build uses tcl/tk 8.6.

R 'records' its tcl/tk version chosen via 'configure' when building. To
differentiate between 8.6 and 9.0 here Wayne and/or you likely need to
rebuild R. For what it is worth, my sources for the Debian packaging are
still at 8.6 (explicitly selecting it) and hence are the Ubuntu binaries at
CRAN.  Debian does have tcl8.6-dev along with tcl9.0-dev.

|   - I haven't built tcl/tk 9.0.1, and like Wayne, would like to avoid
| that.  Is there a Github action that would install it?

I would recommend a container, and starting from one of the standard 'how to
build R setups'. A possible one is my 'daily R patched' (drp) one at

  https://github.com/rocker-org/drp

which builds weekly. You would just have to change tcl (and presumably tk) to
9.0 in the Dockerfile at

  https://github.com/rocker-org/drp/blob/master/Dockerfile

in line 57 and 64 replacing, respectively, tcl-dev with tcl9.0-dev and tk-dev
with tk9.0-dev.  [ Debian tends to change such common infrastructure packages
in a coordinated wave (called 'transition'), and we have not had one yet for
tcl/tk 9.0. ]

Rebuilding the container (which one can do in an action) will get you
r-patched with the 9.0 versions of tck and tk which should allow some client
testing (in 'loon') to accommodate accordingly (which another action can
call). Of course just doing it locally also works and is easier. While at it,
it would be nice if the package could (just like 'rgl' does) work around a
missing x11 at package install, currently headless setups need to explicitly
wrap this in xvfb.

Hope this helps. Feel free to ping me off-list if the Docker use is unclear
yet is something you want to try.

Best, Dirk

--
dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org

	[[alternative HTML version deleted]]


From A@Comber @end|ng |rom |eed@@@c@uk  Thu Jun 12 09:58:57 2025
From: A@Comber @end|ng |rom |eed@@@c@uk (Alexis Comber)
Date: Thu, 12 Jun 2025 07:58:57 +0000
Subject: [R-pkg-devel] CRAN package update submission
In-Reply-To: <60BF94D7-69EB-44B8-9F97-85EB578B9620@leeds.ac.uk>
References: <20250509025337.33B8DA01D4@xmpalantir.wu.ac.at>
 <01dbc094$Blat.v3.2.24$5f9903a5$2f0804045@mail.statistik.tu-dortmund.de>
 <60BF94D7-69EB-44B8-9F97-85EB578B9620@leeds.ac.uk>
Message-ID: <550EE033-1FFC-4E54-B53D-DEFE1A41B492@leeds.ac.uk>

Hi r-package-devel Community

I just tried to submit an update to a package - there was a minor issue with the vignette that I corrected.
I updated v.1.0.1 to v.1.0.2 to do this, perhaps incorrectly.

I got the following Note that I am not sure how to resolve.

* checking CRAN incoming feasibility ... [11s] NOTE
Maintainer: 'Lex Comber <a.comber at leeds.ac.uk>'
Days since last update: 5

Is it a matter of eating for a few days to update the package, or something else?

I am sorry if this is a daft question!  Lex

Prof. Lex Comber | Professor of Spatial Data Analytics | School of Geography | University of Leeds | Leeds | LS2 9JT | UK | email: a.comber at leeds.ac.uk
(note: I work Monday to Thursday)



	[[alternative HTML version deleted]]


From ||@t@ @end|ng |rom dewey@myzen@co@uk  Thu Jun 12 11:15:13 2025
From: ||@t@ @end|ng |rom dewey@myzen@co@uk (Michael Dewey)
Date: Thu, 12 Jun 2025 10:15:13 +0100
Subject: [R-pkg-devel] CRAN package update submission
In-Reply-To: <550EE033-1FFC-4E54-B53D-DEFE1A41B492@leeds.ac.uk>
References: <20250509025337.33B8DA01D4@xmpalantir.wu.ac.at>
 <01dbc094$Blat.v3.2.24$5f9903a5$2f0804045@mail.statistik.tu-dortmund.de>
 <60BF94D7-69EB-44B8-9F97-85EB578B9620@leeds.ac.uk>
 <550EE033-1FFC-4E54-B53D-DEFE1A41B492@leeds.ac.uk>
Message-ID: <0ecf22f8-d18d-4bfe-ad68-c783d4386671@dewey.myzen.co.uk>

Dear Alexis

It is only a NOTE so can be ignored but ...

Since you have updated recently it is giving you a friendly nudge not to 
do that too often. Add an explanation in your submission form and it 
should be OK.

Disclaimer: I am not CRAN, just another package author.

Michael

On 12/06/2025 08:58, Alexis Comber wrote:
> Hi r-package-devel Community
> 
> I just tried to submit an update to a package - there was a minor issue with the vignette that I corrected.
> I updated v.1.0.1 to v.1.0.2 to do this, perhaps incorrectly.
> 
> I got the following Note that I am not sure how to resolve.
> 
> * checking CRAN incoming feasibility ... [11s] NOTE
> Maintainer: 'Lex Comber <a.comber at leeds.ac.uk>'
> Days since last update: 5
> 
> Is it a matter of eating for a few days to update the package, or something else?
> 
> I am sorry if this is a daft question!  Lex
> 
> Prof. Lex Comber | Professor of Spatial Data Analytics | School of Geography | University of Leeds | Leeds | LS2 9JT | UK | email: a.comber at leeds.ac.uk
> (note: I work Monday to Thursday)
> 
> 
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel

-- 
Michael Dewey


From edd @end|ng |rom deb|@n@org  Thu Jun 12 18:07:10 2025
From: edd @end|ng |rom deb|@n@org (Dirk Eddelbuettel)
Date: Thu, 12 Jun 2025 11:07:10 -0500
Subject: [R-pkg-devel] 
 Best practices for a contributor who prefers to be
 cited only by their GitHub ID?
In-Reply-To: <CAJmOi+N1AvoKUGuPONaRNh5KNbARbtoui9w93hWzXr8EruzkSA@mail.gmail.com>
References: <CAPRVBcwOxfnKH9HqwsKKeNN1WkNcKWU6gGAtvfdfiPbUDHfAKQ@mail.gmail.com>
 <26678.51280.794210.458395@stat.math.ethz.ch>
 <219cd022-0ffb-40bf-aa0d-1be11ed80f38@gmail.com>
 <CAPRVBcwq6=885Kx_jgLnXwaKBgeO+KNYsL-tm6bZYr=PLis5CQ@mail.gmail.com>
 <26679.24261.271564.309172@rob.eddelbuettel.com>
 <CAPRVBcyq0Q7=boHA4xRq73g8bsgMQQdDBfehJDL8E=6L7LgwDA@mail.gmail.com>
 <CAJmOi+N1AvoKUGuPONaRNh5KNbARbtoui9w93hWzXr8EruzkSA@mail.gmail.com>
Message-ID: <26698.64302.695007.374972@rob.eddelbuettel.com>


As a follow-up, Kurt tells me [1] that Achim and he looked into this issue
and extended the 'person' class to support

   +## Example for a contributor whose real name is unknown and cannot be
   +## determined:
   +person(given = "@zeileis", role = "ctb", comment = "GitHub user")

which has now been committed as c88299.

Cheers,  Dirk

[1] With a nod to please post for him here for 'reasons' ...

-- 
dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From hugh@p@r@on@ge @end|ng |rom gm@||@com  Sat Jun 14 02:33:55 2025
From: hugh@p@r@on@ge @end|ng |rom gm@||@com (Hugh Parsonage)
Date: Sat, 14 Jun 2025 10:33:55 +1000
Subject: [R-pkg-devel] Automated checking defeated by website anti-scraping
 rules
Message-ID: <CAJmOi+NZ_8Xv080H_QePCtC-CkihfFpAhqSCC3+oXq6X0H-Asw@mail.gmail.com>

When checking a package on win-devel, I get the NOTE

Found the following (possibly) invalid URLs:
  URL: http://classic.austlii.edu.au/au/legis/cth/consol_act/itaa1997240/s4.10.html
    From: man/small_business_tax_offset.Rd
    Status: 410
    Message: Gone
  URL: http://classic.austlii.edu.au/au/legis/cth/consol_act/mla1986131/
    From: man/medicare_levy.Rd
    Status: 410
    Message: Gone
  URL: https://guides.dss.gov.au/social-security-guide/3/4/1/10
    From: man/age_pension_age.Rd
    Status: 403
    Message: Forbidden

The URLs exist (changing to https:// changes nothing) and are
accessible from a browser just fine. They appear to have those HTTP
statuses because of the servers' decision to block 'automated
requests'. As imbecilic as these rules might be (they can probably be
easily defeated), what should be the policy going forward?  I can wrap
these URLs in \code{} to get past the checks, but a better solution
might be available at the check stage.

I think the fact that a check fails when a URL really has failed or
moved is a good thing and should be preserved. I don't just want to
get past the check.


Hugh Parsonage.


From |kw@|mmo @end|ng |rom gm@||@com  Sat Jun 14 02:38:46 2025
From: |kw@|mmo @end|ng |rom gm@||@com (Iris Simmons)
Date: Fri, 13 Jun 2025 20:38:46 -0400
Subject: [R-pkg-devel] 
 Automated checking defeated by website anti-scraping rules
In-Reply-To: <CAJmOi+NZ_8Xv080H_QePCtC-CkihfFpAhqSCC3+oXq6X0H-Asw@mail.gmail.com>
References: <CAJmOi+NZ_8Xv080H_QePCtC-CkihfFpAhqSCC3+oXq6X0H-Asw@mail.gmail.com>
Message-ID: <CADNULg9wuCLXCYLswsifx9u5b=EpzBtAFEH4bZd5xWvhARx=-Q@mail.gmail.com>

I have a package that throws the same NOTE when checked, the CRAN
maintainers just let it pass every time. I wouldn't worry about it.

On Fri, Jun 13, 2025, 20:35 Hugh Parsonage <hugh.parsonage at gmail.com> wrote:

> When checking a package on win-devel, I get the NOTE
>
> Found the following (possibly) invalid URLs:
>   URL:
> http://classic.austlii.edu.au/au/legis/cth/consol_act/itaa1997240/s4.10.html
>     From: man/small_business_tax_offset.Rd
>     Status: 410
>     Message: Gone
>   URL: http://classic.austlii.edu.au/au/legis/cth/consol_act/mla1986131/
>     From: man/medicare_levy.Rd
>     Status: 410
>     Message: Gone
>   URL: https://guides.dss.gov.au/social-security-guide/3/4/1/10
>     From: man/age_pension_age.Rd
>     Status: 403
>     Message: Forbidden
>
> The URLs exist (changing to https:// changes nothing) and are
> accessible from a browser just fine. They appear to have those HTTP
> statuses because of the servers' decision to block 'automated
> requests'. As imbecilic as these rules might be (they can probably be
> easily defeated), what should be the policy going forward?  I can wrap
> these URLs in \code{} to get past the checks, but a better solution
> might be available at the check stage.
>
> I think the fact that a check fails when a URL really has failed or
> moved is a good thing and should be preserved. I don't just want to
> get past the check.
>
>
> Hugh Parsonage.
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


