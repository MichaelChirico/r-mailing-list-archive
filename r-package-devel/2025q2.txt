From ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de  Tue Apr  1 10:26:35 2025
From: ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de (Uwe Ligges)
Date: Tue, 1 Apr 2025 10:26:35 +0200
Subject: [R-pkg-devel] 
 [CRAN-pretest-archived] CRAN Submission OPCreg 0.2.0
In-Reply-To: <513f1a07.73cc.195f03a36e2.Coremail.ggb11111111@163.com>
References: <20250401013307.D9595A01D4@xmpalantir.wu.ac.at>
 <01dba2ac$Blat.v3.2.24$40b54e1c$2604851e1@mail.statistik.tu-dortmund.de>
 <513f1a07.73cc.195f03a36e2.Coremail.ggb11111111@163.com>
Message-ID: <405d9027-1b87-4b80-a0ec-60cb501e9e97@statistik.tu-dortmund.de>

But we see

Author field differs from that derived from Authors at R
   Author:    'Guangbao Guo [aut, cre] 
https://orcid.org/0000-0002-4115-6218>), Chunjie Wei [aut]'
   Authors at R: 'Guangbao Guo [aut, cre] (ORCID: 
<https://orcid.org/0000-0002-4115-6218>), Chunjie Wei [aut]'


You have to build the package with R-devel or R-prerelease, then the 
field will be auto generated in the new form.

Best,
Uwe Ligges


On 01.04.2025 09:21, ??? wrote:
> Dear Uwe Ligges,
> 
>          The name "Guo" is correctly spelled. Guo is my family name.
> 
> 
> 
> 
> If you are fairly certain the rejection is a false positive.
> 
>   
> 
> 
> 
> 
> --
> 
> Sincerely yours,
> Guangbao Guo
> 
> 
> Wechat Number: ggb11111111
> 
> 
> 
> 
> 
> At 2025-04-01 10:17:44, ligges at statistik.tu-dortmund.de wrote:
>> Dear maintainer,
>>
>> package OPCreg_0.2.0.tar.gz does not pass the incoming checks automatically, please see the following pre-tests (additional issue checks):
>> Windows: <https://win-builder.r-project.org/incoming_pretest/OPCreg_0.2.0_20250401_033307/Windows/00check.log>
>> Status: 2 NOTEs
>> Debian: <https://win-builder.r-project.org/incoming_pretest/OPCreg_0.2.0_20250401_033307/Debian/00check.log>
>> Status: 2 NOTEs
>>
>>
>>
>> Please fix all problems and resubmit a fixed version via the webform.
>> If you are not sure how to fix the problems shown, please ask for help on the R-package-devel mailing list:
>> <https://stat.ethz.ch/mailman/listinfo/r-package-devel>
>> If you are fairly certain the rejection is a false positive, please reply-all to this message and explain.
>>
>> More details are given in the directory:
>> <https://win-builder.r-project.org/incoming_pretest/OPCreg_0.2.0_20250401_033307/>
>> The files will be removed after roughly 7 days.
>>
>> No strong reverse dependencies to be checked.
>>
>> Best regards,
>> CRAN teams' auto-check service
> 
> 	[[alternative HTML version deleted]]
> 


From @ergue|@@oko| @end|ng |rom gm@||@com  Tue Apr  1 10:26:44 2025
From: @ergue|@@oko| @end|ng |rom gm@||@com (Serguei Sokol)
Date: Tue, 1 Apr 2025 10:26:44 +0200
Subject: [R-pkg-devel] AlgDesign C Issue
In-Reply-To: <CAMUU=-+C8bMCUFOOD_FEGJLvSnVk+Ubjd+JEwHL86Th+8Mn7pw@mail.gmail.com>
References: <CAMUU=-Km46C8gMdnBQQ2VoHXLxKoi-=B-7i5u90PvRx9psXndQ@mail.gmail.com>
 <CAPRVBcy+LpPHQ9DAAOMFicZ7m-P7+fgc7oqD0jT0bK_XFrjQew@mail.gmail.com>
 <CAMUU=-LsEvLGvTbub0nKz2R-sG4HFgms2cxP_6bO5E9PxJHOJg@mail.gmail.com>
 <dcd2bc2b-c486-4532-962f-c04793ecb091@gmail.com>
 <CAMUU=-+C8bMCUFOOD_FEGJLvSnVk+Ubjd+JEwHL86Th+8Mn7pw@mail.gmail.com>
Message-ID: <fa95ce55-a249-45a8-be6e-167a808e0398@gmail.com>

Le 31/03/2025 ? 18:00, Jerome Braun a ?crit?:
> Hi Duncan!
> 
>>   Since the compiler will supply stdbool.h, it's safer to use that than to
> try to emulate it.
> 
> Understood. It seems like the definitions are exactly the same between the
> two.
Yes and no. Yes, true and false are the same. No, because there is also 
__bool_true_false_are_defined which is set to 1 and this can make the 
compiler react differently in various situations.

> 
> Currently there is no use of "bool" in any of the code (after having
> changed bool to int everywhere in the code).
> 
> So I think I can replace the two lines in the original code with a call to
> include the <stdbool.h> header --- does that seem reasonable?   Can I use
> an include statement there in place of those two lines?
I think it would be good and safe idea.

Best,
Serguei.

> 
> Thank you!


From th|erry@onke||nx @end|ng |rom |nbo@be  Tue Apr  1 14:28:04 2025
From: th|erry@onke||nx @end|ng |rom |nbo@be (Thierry Onkelinx)
Date: Tue, 1 Apr 2025 14:28:04 +0200
Subject: [R-pkg-devel] Connection time-out when checking a package
Message-ID: <CAJuCY5xfn7uykxM2JHPOWgkzUPrjXz8tpJ-3E_=GFw7XucuYfA@mail.gmail.com>

Dear all,

When checking a package via a GitHub action I often (but not always) get a
connection-time out for the GNU license page. The github actions runs the
code below

   Sys.setenv("R_DEFAULT_INTERNET_TIMEOUT" = 360)
   options(timeout = max(360, getOption("timeout")))
    rcmdcheck::rcmdcheck(
      path = x$get_path, args = c("--timings", "--as-cran", "--no-manual"),
      error_on = "never", timeout = Inf
    )

The resulting NOTE

Found the following (possibly) invalid URLs:
  URL: https://www.gnu.org/licenses/gpl-3.0.html
    From: README.md
    Status: Error
    Message: libcurl error code 28:
      Failed to connect to www.gnu.org port 443 after 136189 ms: Couldn't
connect to server

I'm guessing that https://www.gnu.org is blocking the request from the
GitHub Action. Any suggestions how to fix this note without removing the
URL for the README?

Best regards,

Thierry

ir. Thierry Onkelinx
Statisticus / Statistician

Vlaamse Overheid / Government of Flanders
INSTITUUT VOOR NATUUR- EN BOSONDERZOEK / RESEARCH INSTITUTE FOR NATURE AND
FOREST
Team Biometrie & Kwaliteitszorg / Team Biometrics & Quality Assurance
thierry.onkelinx at inbo.be
Havenlaan 88 bus 73, 1000 Brussel
*Postadres:* Koning Albert II-laan 15 bus 186, 1210 Brussel
*Poststukken die naar dit adres worden gestuurd, worden ingescand en
digitaal aan de geadresseerde bezorgd. Zo kan de Vlaamse overheid haar
dossiers volledig digitaal behandelen. Poststukken met de vermelding
?vertrouwelijk? worden niet ingescand, maar ongeopend aan de geadresseerde
bezorgd.*
www.inbo.be

///////////////////////////////////////////////////////////////////////////////////////////
To call in the statistician after the experiment is done may be no more
than asking him to perform a post-mortem examination: he may be able to say
what the experiment died of. ~ Sir Ronald Aylmer Fisher
The plural of anecdote is not data. ~ Roger Brinner
The combination of some data and an aching desire for an answer does not
ensure that a reasonable answer can be extracted from a given body of data.
~ John Tukey
///////////////////////////////////////////////////////////////////////////////////////////

<https://www.inbo.be>

	[[alternative HTML version deleted]]


From |kry|ov @end|ng |rom d|@root@org  Wed Apr  2 11:45:54 2025
From: |kry|ov @end|ng |rom d|@root@org (Ivan Krylov)
Date: Wed, 2 Apr 2025 12:45:54 +0300
Subject: [R-pkg-devel] Connection time-out when checking a package
In-Reply-To: <CAJuCY5xfn7uykxM2JHPOWgkzUPrjXz8tpJ-3E_=GFw7XucuYfA@mail.gmail.com>
References: <CAJuCY5xfn7uykxM2JHPOWgkzUPrjXz8tpJ-3E_=GFw7XucuYfA@mail.gmail.com>
Message-ID: <20250402124554.023fa302@arachnoid>

? Tue, 1 Apr 2025 14:28:04 +0200
Thierry Onkelinx <thierry.onkelinx at inbo.be> ?????:

> Any suggestions how to fix this note without removing the
> URL for the README?

I think it should be possible to set the environment variable
_R_CHECK_CRAN_INCOMING_REMOTE_=FALSE to disable the "remote" checks [*]
(including checks for repository content) or
_R_CHECK_CRAN_INCOMING_SKIP_URL_CHECKS_IF_REMOTE_=TRUE to only skip the
URL checks.

-- 
Best regards,
Ivan

[*]
https://cran.r-project.org/doc/manuals/r-devel/R-ints.html#index-_005fR_005fCHECK_005fCRAN_005fINCOMING_005fREMOTE_005f


From th|erry@onke||nx @end|ng |rom |nbo@be  Wed Apr  2 13:01:12 2025
From: th|erry@onke||nx @end|ng |rom |nbo@be (Thierry Onkelinx)
Date: Wed, 2 Apr 2025 13:01:12 +0200
Subject: [R-pkg-devel] Connection time-out when checking a package
In-Reply-To: <20250402124554.023fa302@arachnoid>
References: <CAJuCY5xfn7uykxM2JHPOWgkzUPrjXz8tpJ-3E_=GFw7XucuYfA@mail.gmail.com>
 <20250402124554.023fa302@arachnoid>
Message-ID: <CAJuCY5wdRwwmu_b1NZHPjTvBoDa+YFrBe8SsuawoXnxL0CYvLg@mail.gmail.com>

Dear Ivan,

Thanks for the feedback. Skipping all URL checks is not an ideal solution.
Getting a NOTE for a broken link is valuable. Given that the problem occurs
over several repositories but always with the gnu.org domain, I was hoping
for a more tailored solution.

Removing the problematic URL is probably the best solution for now.

Best regards,

Thierry

ir. Thierry Onkelinx
Statisticus / Statistician

Vlaamse Overheid / Government of Flanders
INSTITUUT VOOR NATUUR- EN BOSONDERZOEK / RESEARCH INSTITUTE FOR NATURE AND
FOREST
Team Biometrie & Kwaliteitszorg / Team Biometrics & Quality Assurance
thierry.onkelinx at inbo.be
Havenlaan 88 bus 73, 1000 Brussel
*Postadres:* Koning Albert II-laan 15 bus 186, 1210 Brussel
*Poststukken die naar dit adres worden gestuurd, worden ingescand en
digitaal aan de geadresseerde bezorgd. Zo kan de Vlaamse overheid haar
dossiers volledig digitaal behandelen. Poststukken met de vermelding
?vertrouwelijk? worden niet ingescand, maar ongeopend aan de geadresseerde
bezorgd.*
www.inbo.be

///////////////////////////////////////////////////////////////////////////////////////////
To call in the statistician after the experiment is done may be no more
than asking him to perform a post-mortem examination: he may be able to say
what the experiment died of. ~ Sir Ronald Aylmer Fisher
The plural of anecdote is not data. ~ Roger Brinner
The combination of some data and an aching desire for an answer does not
ensure that a reasonable answer can be extracted from a given body of data.
~ John Tukey
///////////////////////////////////////////////////////////////////////////////////////////

<https://www.inbo.be>


Op wo 2 apr 2025 om 11:45 schreef Ivan Krylov <ikrylov at disroot.org>:

> ? Tue, 1 Apr 2025 14:28:04 +0200
> Thierry Onkelinx <thierry.onkelinx at inbo.be> ?????:
>
> > Any suggestions how to fix this note without removing the
> > URL for the README?
>
> I think it should be possible to set the environment variable
> _R_CHECK_CRAN_INCOMING_REMOTE_=FALSE to disable the "remote" checks [*]
> (including checks for repository content) or
> _R_CHECK_CRAN_INCOMING_SKIP_URL_CHECKS_IF_REMOTE_=TRUE to only skip the
> URL checks.
>
> --
> Best regards,
> Ivan
>
> [*]
>
> https://cran.r-project.org/doc/manuals/r-devel/R-ints.html#index-_005fR_005fCHECK_005fCRAN_005fINCOMING_005fREMOTE_005f
>

	[[alternative HTML version deleted]]


From corne||o|d @end|ng |rom gm@||@com  Wed Apr  2 19:28:32 2025
From: corne||o|d @end|ng |rom gm@||@com (Jason Cory Brunson)
Date: Wed, 2 Apr 2025 13:28:32 -0400
Subject: [R-pkg-devel] proper way to cite an invalid URL
Message-ID: <cc4856a9-3a87-4f9b-a0f1-6ce40b1d5e45@gmail.com>

Hello,

I'm trying to submit a new version of a package to CRAN. Among the 
additions is an RMarkdown vignette that uses data from a website that is 
no longer active. For completeness, i'd still like to cite the invalid 
URL, but without formatting it as a hyperlink. What is the preferred way 
to do this?

One StackExchange answer is to surround the URL with <span></span>, but 
this did not remove the hyperlink when i rendered the vignette locally. 
Instead, i surrounded it with back-ticks, which works locally, but i've 
been unable to run Win-Builder checks to see whether this prevents the 
"invalid URLs" NOTE. And, even if the NOTE is prevented, i'm not sure 
this is preferred.

Thank you,

Cory Brunson


From murdoch@dunc@n @end|ng |rom gm@||@com  Wed Apr  2 23:42:35 2025
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Wed, 2 Apr 2025 17:42:35 -0400
Subject: [R-pkg-devel] proper way to cite an invalid URL
In-Reply-To: <cc4856a9-3a87-4f9b-a0f1-6ce40b1d5e45@gmail.com>
References: <cc4856a9-3a87-4f9b-a0f1-6ce40b1d5e45@gmail.com>
Message-ID: <f08930c4-6928-469c-ab27-1773004934ae@gmail.com>

On 2025-04-02 1:28 p.m., Jason Cory Brunson wrote:
> Hello,
> 
> I'm trying to submit a new version of a package to CRAN. Among the
> additions is an RMarkdown vignette that uses data from a website that is
> no longer active. For completeness, i'd still like to cite the invalid
> URL, but without formatting it as a hyperlink. What is the preferred way
> to do this?
> 
> One StackExchange answer is to surround the URL with <span></span>, but
> this did not remove the hyperlink when i rendered the vignette locally.
> Instead, i surrounded it with back-ticks, which works locally, but i've
> been unable to run Win-Builder checks to see whether this prevents the
> "invalid URLs" NOTE. And, even if the NOTE is prevented, i'm not sure
> this is preferred.

Why not leave off the scheme, e.g. "www.r-project.org" instead of 
"https://www.r-project.org".

Duncan Murdoch


From @|mon@urb@nek @end|ng |rom R-project@org  Thu Apr  3 00:01:03 2025
From: @|mon@urb@nek @end|ng |rom R-project@org (Simon Urbanek)
Date: Thu, 3 Apr 2025 11:01:03 +1300
Subject: [R-pkg-devel] Connection time-out when checking a package
In-Reply-To: <CAJuCY5wdRwwmu_b1NZHPjTvBoDa+YFrBe8SsuawoXnxL0CYvLg@mail.gmail.com>
References: <CAJuCY5xfn7uykxM2JHPOWgkzUPrjXz8tpJ-3E_=GFw7XucuYfA@mail.gmail.com>
 <20250402124554.023fa302@arachnoid>
 <CAJuCY5wdRwwmu_b1NZHPjTvBoDa+YFrBe8SsuawoXnxL0CYvLg@mail.gmail.com>
Message-ID: <C14FACC0-4361-4BFA-8EAA-DAE30D225C0D@R-project.org>

FWIW: connectivity from GH runners is notoriously patchy*, so I wouldn?t rely on those for URL checks, so I?d recommend using the solution by Ivan in actions and simply running a separate check without the option once in a while locally (e.g., before submission) to detect such issues. After all, the point of GHAs is to detect things you cannot detect locally (because of OS etc.) which this not the case here.

* - the failure rate is so high that pretty much all actions involving remote files include provisions for several retries, otherwise your actions will fail on a regular basis. That said, GNU servers are notoriously unreliable themselves, compounding the problem. Even in our macOS recipes I had to create a provision for automatic rewriting of gnu.org URLs to more reliable GNU mirrors as the master site is either slow or unresponsive very often, so this is not an unusual problem.

Cheers,
Simon


> On 3 Apr 2025, at 00:01, Thierry Onkelinx <thierry.onkelinx at inbo.be> wrote:
> 
> Dear Ivan,
> 
> Thanks for the feedback. Skipping all URL checks is not an ideal solution.
> Getting a NOTE for a broken link is valuable. Given that the problem occurs
> over several repositories but always with the gnu.org domain, I was hoping
> for a more tailored solution.
> 
> Removing the problematic URL is probably the best solution for now.
> 
> Best regards,
> 
> Thierry
> 
> ir. Thierry Onkelinx
> Statisticus / Statistician
> 
> Vlaamse Overheid / Government of Flanders
> INSTITUUT VOOR NATUUR- EN BOSONDERZOEK / RESEARCH INSTITUTE FOR NATURE AND
> FOREST
> Team Biometrie & Kwaliteitszorg / Team Biometrics & Quality Assurance
> thierry.onkelinx at inbo.be
> Havenlaan 88 bus 73, 1000 Brussel
> *Postadres:* Koning Albert II-laan 15 bus 186, 1210 Brussel
> *Poststukken die naar dit adres worden gestuurd, worden ingescand en
> digitaal aan de geadresseerde bezorgd. Zo kan de Vlaamse overheid haar
> dossiers volledig digitaal behandelen. Poststukken met de vermelding
> ?vertrouwelijk? worden niet ingescand, maar ongeopend aan de geadresseerde
> bezorgd.*
> www.inbo.be
> 
> ///////////////////////////////////////////////////////////////////////////////////////////
> To call in the statistician after the experiment is done may be no more
> than asking him to perform a post-mortem examination: he may be able to say
> what the experiment died of. ~ Sir Ronald Aylmer Fisher
> The plural of anecdote is not data. ~ Roger Brinner
> The combination of some data and an aching desire for an answer does not
> ensure that a reasonable answer can be extracted from a given body of data.
> ~ John Tukey
> ///////////////////////////////////////////////////////////////////////////////////////////
> 
> <https://www.inbo.be>
> 
> 
> Op wo 2 apr 2025 om 11:45 schreef Ivan Krylov <ikrylov at disroot.org>:
> 
>> ? Tue, 1 Apr 2025 14:28:04 +0200
>> Thierry Onkelinx <thierry.onkelinx at inbo.be> ?????:
>> 
>>> Any suggestions how to fix this note without removing the
>>> URL for the README?
>> 
>> I think it should be possible to set the environment variable
>> _R_CHECK_CRAN_INCOMING_REMOTE_=FALSE to disable the "remote" checks [*]
>> (including checks for repository content) or
>> _R_CHECK_CRAN_INCOMING_SKIP_URL_CHECKS_IF_REMOTE_=TRUE to only skip the
>> URL checks.
>> 
>> --
>> Best regards,
>> Ivan
>> 
>> [*]
>> 
>> https://cran.r-project.org/doc/manuals/r-devel/R-ints.html#index-_005fR_005fCHECK_005fCRAN_005fINCOMING_005fREMOTE_005f
>> 
> 
> [[alternative HTML version deleted]]
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
> 


From n|cho|@@@t|erney @end|ng |rom gm@||@com  Thu Apr  3 02:28:32 2025
From: n|cho|@@@t|erney @end|ng |rom gm@||@com (Nicholas Tierney)
Date: Thu, 3 Apr 2025 11:28:32 +1100
Subject: [R-pkg-devel] proper way to cite an invalid URL
In-Reply-To: <f08930c4-6928-469c-ab27-1773004934ae@gmail.com>
References: <cc4856a9-3a87-4f9b-a0f1-6ce40b1d5e45@gmail.com>
 <f08930c4-6928-469c-ab27-1773004934ae@gmail.com>
Message-ID: <CACrL82XTjtTHZRvz4YL2rPRfWvKvFE3rgAsDJSVUKbo2zY4QuA@mail.gmail.com>

Could you potentially look for the original website in the internet archive
/ wayback machine: https://web.archive.org/ and cite that instead?

On Thu, 3 Apr 2025 at 08:42, Duncan Murdoch <murdoch.duncan at gmail.com>
wrote:

> On 2025-04-02 1:28 p.m., Jason Cory Brunson wrote:
> > Hello,
> >
> > I'm trying to submit a new version of a package to CRAN. Among the
> > additions is an RMarkdown vignette that uses data from a website that is
> > no longer active. For completeness, i'd still like to cite the invalid
> > URL, but without formatting it as a hyperlink. What is the preferred way
> > to do this?
> >
> > One StackExchange answer is to surround the URL with <span></span>, but
> > this did not remove the hyperlink when i rendered the vignette locally.
> > Instead, i surrounded it with back-ticks, which works locally, but i've
> > been unable to run Win-Builder checks to see whether this prevents the
> > "invalid URLs" NOTE. And, even if the NOTE is prevented, i'm not sure
> > this is preferred.
>
> Why not leave off the scheme, e.g. "www.r-project.org" instead of
> "https://www.r-project.org".
>
> Duncan Murdoch
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From corne||o|d @end|ng |rom gm@||@com  Thu Apr  3 03:20:19 2025
From: corne||o|d @end|ng |rom gm@||@com (Jason Cory Brunson)
Date: Wed, 2 Apr 2025 21:20:19 -0400
Subject: [R-pkg-devel] proper way to cite an invalid URL
In-Reply-To: <CACrL82XTjtTHZRvz4YL2rPRfWvKvFE3rgAsDJSVUKbo2zY4QuA@mail.gmail.com>
References: <cc4856a9-3a87-4f9b-a0f1-6ce40b1d5e45@gmail.com>
 <f08930c4-6928-469c-ab27-1773004934ae@gmail.com>
 <CACrL82XTjtTHZRvz4YL2rPRfWvKvFE3rgAsDJSVUKbo2zY4QuA@mail.gmail.com>
Message-ID: <93131639-5472-4fdb-b5af-0091ead580aa@gmail.com>

Thank you both!

Nicholas, i did check the Wayback Machine; the URL was never archived, 
nor was the domain itself (in case you're curious, www.ibge.Goi?sv.br/).

Duncan, that worked at preventing the hyperlink locally; thank you. But 
i got a new error from Win-Builder (the development version via 
devtools::check_win_devel() but not the release version via 
devtools::check_win_release()). It seems to apply to all URLs and DOIs, 
though i did not get it on any previous check:

Checking URLs failed with message:
 ? there is no package called 'curl'

Checking DOIs failed with message:
 ? there is no package called 'curl'

Cory

On 4/2/25 20:28, Nicholas Tierney wrote:
> Could you potentially look for the original website in the internet 
> archive / wayback machine: https://web.archive.org/ and cite that instead?
>
> On Thu, 3 Apr 2025 at 08:42, Duncan Murdoch <murdoch.duncan at gmail.com> 
> wrote:
>
>     On 2025-04-02 1:28 p.m., Jason Cory Brunson wrote:
>     > Hello,
>     >
>     > I'm trying to submit a new version of a package to CRAN. Among the
>     > additions is an RMarkdown vignette that uses data from a website
>     that is
>     > no longer active. For completeness, i'd still like to cite the
>     invalid
>     > URL, but without formatting it as a hyperlink. What is the
>     preferred way
>     > to do this?
>     >
>     > One StackExchange answer is to surround the URL with
>     <span></span>, but
>     > this did not remove the hyperlink when i rendered the vignette
>     locally.
>     > Instead, i surrounded it with back-ticks, which works locally,
>     but i've
>     > been unable to run Win-Builder checks to see whether this
>     prevents the
>     > "invalid URLs" NOTE. And, even if the NOTE is prevented, i'm not
>     sure
>     > this is preferred.
>
>     Why not leave off the scheme, e.g. "www.r-project.org
>     <http://www.r-project.org>" instead of
>     "https://www.r-project.org".
>
>     Duncan Murdoch
>
>     ______________________________________________
>     R-package-devel at r-project.org mailing list
>     https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From |kry|ov @end|ng |rom d|@root@org  Thu Apr  3 07:54:33 2025
From: |kry|ov @end|ng |rom d|@root@org (Ivan Krylov)
Date: Thu, 3 Apr 2025 08:54:33 +0300
Subject: [R-pkg-devel] proper way to cite an invalid URL
In-Reply-To: <93131639-5472-4fdb-b5af-0091ead580aa@gmail.com>
References: <cc4856a9-3a87-4f9b-a0f1-6ce40b1d5e45@gmail.com>
 <f08930c4-6928-469c-ab27-1773004934ae@gmail.com>
 <CACrL82XTjtTHZRvz4YL2rPRfWvKvFE3rgAsDJSVUKbo2zY4QuA@mail.gmail.com>
 <93131639-5472-4fdb-b5af-0091ead580aa@gmail.com>
Message-ID: <20250403085433.52c99c01@Tarkus>

? Wed, 2 Apr 2025 21:20:19 -0400
Jason Cory Brunson <cornelioid at gmail.com> ?????:

> in case you're curious, www.ibge.Goi?sv.br/

I went looking for links to this domain on the Web, found the link in
the documentation for the 'ripserr' package, and then found what looks
like a domain where the desired page could be found. Could it be

https://www.ibge.gov.br/geociencias/organizacao-do-territorio/estrutura-territorial/15761-areas-dos-municipios.html?edicao=30133&t=acesso-ao-produto

instead of the original link?

https://www.ibge.Goiasv.br/geociencias/organizacao-do-territorio/estrutura-territorial/15761-areas-dos-municipios.html?edicao=30133&t=acesso-ao-produto?

> But i got a new error from Win-Builder (the development version via 
> devtools::check_win_devel() but not the release version via 
> devtools::check_win_release()). It seems to apply to all URLs and
> DOIs, though i did not get it on any previous check:
> 
> Checking URLs failed with message:
>  ? there is no package called 'curl'
> 
> Checking DOIs failed with message:
>  ? there is no package called 'curl'

Looks like Win-Builder for R-devel is having transient problems:
https://www.r-project.org/nosvn/R.check/r-devel-windows-x86_64/curl-00install.html

("ERROR: cannot remove earlier installation, is it in use?", and then
it fails to overwrite libs\x64\curl.dll with "Permission denied".)

-- 
Best regards,
Ivan


From corne||o|d @end|ng |rom gm@||@com  Thu Apr  3 14:34:30 2025
From: corne||o|d @end|ng |rom gm@||@com (Jason Cory Brunson)
Date: Thu, 3 Apr 2025 08:34:30 -0400
Subject: [R-pkg-devel] proper way to cite an invalid URL
In-Reply-To: <20250403085433.52c99c01@Tarkus>
References: <cc4856a9-3a87-4f9b-a0f1-6ce40b1d5e45@gmail.com>
 <f08930c4-6928-469c-ab27-1773004934ae@gmail.com>
 <CACrL82XTjtTHZRvz4YL2rPRfWvKvFE3rgAsDJSVUKbo2zY4QuA@mail.gmail.com>
 <93131639-5472-4fdb-b5af-0091ead580aa@gmail.com>
 <20250403085433.52c99c01@Tarkus>
Message-ID: <038242e6-9bdb-4dac-9088-f6bd2d67ecea@gmail.com>

Ivan, thank you! That seems to be correct. I'll replace the link.

For future reference in answer to the original question, it seems that 
Duncan's suggestion works best, assuming that the 'curl' problem was 
unrelated.

Cory

On 4/3/25 01:54, Ivan Krylov wrote:
> ? Wed, 2 Apr 2025 21:20:19 -0400
> Jason Cory Brunson <cornelioid at gmail.com> ?????:
>
>> in case you're curious, www.ibge.Goi?sv.br/
> I went looking for links to this domain on the Web, found the link in
> the documentation for the 'ripserr' package, and then found what looks
> like a domain where the desired page could be found. Could it be
>
> https://www.ibge.gov.br/geociencias/organizacao-do-territorio/estrutura-territorial/15761-areas-dos-municipios.html?edicao=30133&t=acesso-ao-produto
>
> instead of the original link?
>
> https://www.ibge.Goiasv.br/geociencias/organizacao-do-territorio/estrutura-territorial/15761-areas-dos-municipios.html?edicao=30133&t=acesso-ao-produto?
>
>> But i got a new error from Win-Builder (the development version via
>> devtools::check_win_devel() but not the release version via
>> devtools::check_win_release()). It seems to apply to all URLs and
>> DOIs, though i did not get it on any previous check:
>>
>> Checking URLs failed with message:
>>   ? there is no package called 'curl'
>>
>> Checking DOIs failed with message:
>>   ? there is no package called 'curl'
> Looks like Win-Builder for R-devel is having transient problems:
> https://www.r-project.org/nosvn/R.check/r-devel-windows-x86_64/curl-00install.html
>
> ("ERROR: cannot remove earlier installation, is it in use?", and then
> it fails to overwrite libs\x64\curl.dll with "Permission denied".)
>


From ||@t@ @end|ng |rom dewey@myzen@co@uk  Thu Apr  3 15:49:46 2025
From: ||@t@ @end|ng |rom dewey@myzen@co@uk (Michael Dewey)
Date: Thu, 3 Apr 2025 14:49:46 +0100
Subject: [R-pkg-devel] 
 [My solution] How and where do I document sysdata.rda
In-Reply-To: <6e48e8fa-2e36-4dbc-8fb9-8039e487ab55@dewey.myzen.co.uk>
References: <6e48e8fa-2e36-4dbc-8fb9-8039e487ab55@dewey.myzen.co.uk>
Message-ID: <3f84af97-544e-42d2-932b-35cca7bd6128@dewey.myzen.co.uk>

I promised I would update on this.

I now realise that what I was tryig to do was logically impossible. I 
was trying to hide the data set (achieved) but also hide the 
documentation. That makes no sense as anyone wanting to change the 
dataset would not know where to find the documentation. The probabiliy 
anyone would want to edit it is almost indsitinguishable from zero but 
it is as Charles suggests a good principle.

So the answer is to document it in the usual way and use the keyword 
internal. The main difference from a standard Rd file for data is the 
usage statement. As georgi pointed out this just consists of the dataset 
name not data(datasetname).

Thanks for all your help on this and sorry it took so long to respond.

Michael

On 20/03/2025 14:39, Lists wrote:
> I want to put a look-up table into sysdata.rda to avoid having to 
> compute it everytime. At the moment I create it and save the resulting 
> file and then manually copy it to sysdata.rda. This works but the 
> package now contains no documentation about the look-up table.
> 
> Most of the information which I turned up online involves doing it all 
> indirectly using various packages. I do not want to do that, I am quite 
> happy editing files by hand and moving them to where I want them by 
> hand. So what I need is to know where I should put the documentation and 
> what format it should be assuming it is not an Rd file.
> 
> Of course what I want may be impossible and I just need to document it 
> in the script which creates it but that seems messy.
> 
> Michael Dewey
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel

-- 
Michael Dewey


From r@c@rtwr|ght @end|ng |rom gm@||@com  Sat Apr  5 02:58:25 2025
From: r@c@rtwr|ght @end|ng |rom gm@||@com (Reed A. Cartwright)
Date: Fri, 4 Apr 2025 17:58:25 -0700
Subject: [R-pkg-devel] libc++ and abort function usage
Message-ID: <CALOkxuxkANWVyYeC1JFzVSjRwWG9ae=5CYN1Ze9SBL8jMBTz2g@mail.gmail.com>

I have updated my package, rbedrock [1-2], to remove a bundled
library's calls to abort() and stderr when compiled with -DNDEBUG
(which is the default). This has mostly worked; however, I have
uncovered that libc++ contains inline functions that call abort() if
exceptions are disabled.

My bundled library is a C++ library and is compiled with exceptions
turned off. I use its C-level interface in my package, so its C++ code
is mostly hidden from my package. When compiled on a platform with
libc++, libc++ introduces abort calls into the compiled package. This
is causing `R CMD check` to warn about abort() usage on those
platforms.

I am wondering what people on this list think I should do?

Should I enable exceptions in the bundled library and keep using the
C-level interface? (It doesn't throw any exceptions itself, but std
library calls might.)

If there is any other strategy that I should try, please let me know.

Thanks,
Reed

[1] https://github.com/reedacartwright/rbedrock
[2] https://cran.r-project.org/package=rbedrock
[3] https://github.com/llvm/llvm-project/blob/release/12.x/libcxx/include/any#L107-L116

--
Reed A. Cartwright, PhD
Associate Professor of Life Sciences
TEACh Representative - Evolution and Computational Courses
School of Life Sciences and The Biodesign Institute
Arizona State University
==================
Address: The Biodesign Institute, PO Box 876401, Tempe, AZ 85287-6401 USA
Packages: The Biodesign Institute, 1001 S. McAllister Ave, Tempe, AZ
85287-6401 USA
Office: Biodesign B-220C, 1-480-965-9949
Website: http://cartwrig.ht/


From @h3758 @end|ng |rom drexe|@edu  Sat Apr  5 00:29:40 2025
From: @h3758 @end|ng |rom drexe|@edu (Halder,Aritra)
Date: Fri, 4 Apr 2025 22:29:40 +0000
Subject: [R-pkg-devel] Warnings and notes while building package with nimble
Message-ID: <DM6PR01MB38971146EB7242086206CBDBA2A92@DM6PR01MB3897.prod.exchangelabs.com>

Hi,

I am trying to submit a package to CRAN built using nimble. It generates warnings like so:

: no visible global function definition for  'nimDim'

and fails automatic checks by CRAN. Any help is appreciated.

Thanks and regards,

Aritra

	[[alternative HTML version deleted]]


From p@cm@n|@p@z @end|ng |rom gm@||@com  Sat Apr  5 08:40:56 2025
From: p@cm@n|@p@z @end|ng |rom gm@||@com (Paul Angelo Manlapaz)
Date: Sat, 5 Apr 2025 14:40:56 +0800
Subject: [R-pkg-devel] R Package Submission
Message-ID: <CAB3e68C8KRW4TtHRDhd9-AfVeZisZAaajR3OcmajuciFStebpQ@mail.gmail.com>

Dear Sir / Ma'am,

Greetings.

I am but a newbie in R Package development and currently, I am trying to
submit my second package to CRAN and every time after submission, the
results for the pre-tests come back 'does not pass the incoming checks
automatically'.

The NOTE says;

  Possibly misspelled words in DESCRIPTION:
    ProteinPCA (9:45, 12:19)
    ggplot (12:5)

The name of the package is ProteinPCA and I have already checked multiple
times the Description files for any possible misspellings but I have not
found any. Same goes with ggplot2.

At this moment, I am really at loss on how to resolve this issue. Could you
perhaps enlighten me on this?

Thank you very much.

Sincerely,
*P. A. C. Manlapaz, RCh*

	[[alternative HTML version deleted]]


From ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de  Sat Apr  5 18:30:16 2025
From: ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de (Uwe Ligges)
Date: Sat, 5 Apr 2025 18:30:16 +0200
Subject: [R-pkg-devel] R Package Submission
In-Reply-To: <CAB3e68C8KRW4TtHRDhd9-AfVeZisZAaajR3OcmajuciFStebpQ@mail.gmail.com>
References: <CAB3e68C8KRW4TtHRDhd9-AfVeZisZAaajR3OcmajuciFStebpQ@mail.gmail.com>
Message-ID: <7918ce96-307d-484c-8896-c7738931fcc6@statistik.tu-dortmund.de>

See my response in the communication among you and CRAN.

Best,
Uwe Ligges




On 05.04.2025 08:40, Paul Angelo Manlapaz wrote:
> Dear Sir / Ma'am,
> 
> Greetings.
> 
> I am but a newbie in R Package development and currently, I am trying to
> submit my second package to CRAN and every time after submission, the
> results for the pre-tests come back 'does not pass the incoming checks
> automatically'.
> 
> The NOTE says;
> 
>    Possibly misspelled words in DESCRIPTION:
>      ProteinPCA (9:45, 12:19)
>      ggplot (12:5)
> 
> The name of the package is ProteinPCA and I have already checked multiple
> times the Description files for any possible misspellings but I have not
> found any. Same goes with ggplot2.
> 
> At this moment, I am really at loss on how to resolve this issue. Could you
> perhaps enlighten me on this?
> 
> Thank you very much.
> 
> Sincerely,
> *P. A. C. Manlapaz, RCh*
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From dw|n@em|u@ @end|ng |rom comc@@t@net  Sat Apr  5 23:31:38 2025
From: dw|n@em|u@ @end|ng |rom comc@@t@net (David Winsemius)
Date: Sat, 5 Apr 2025 15:31:38 -0600
Subject: [R-pkg-devel] R Package Submission
In-Reply-To: <CAB3e68C8KRW4TtHRDhd9-AfVeZisZAaajR3OcmajuciFStebpQ@mail.gmail.com>
References: <CAB3e68C8KRW4TtHRDhd9-AfVeZisZAaajR3OcmajuciFStebpQ@mail.gmail.com>
Message-ID: <294AB8A2-A6AE-4C15-8789-0F9CE15B5870@comcast.net>

It would be unusual these days to have pkg:ggplot as a dependency. 

? 
David. 
Sent from my iPhone

> On Apr 5, 2025, at 10:28?AM, Paul Angelo Manlapaz <pacmanlapaz at gmail.com> wrote:
> 
> ?Dear Sir / Ma'am,
> 
> Greetings.
> 
> I am but a newbie in R Package development and currently, I am trying to
> submit my second package to CRAN and every time after submission, the
> results for the pre-tests come back 'does not pass the incoming checks
> automatically'.
> 
> The NOTE says;
> 
>  Possibly misspelled words in DESCRIPTION:
>    ProteinPCA (9:45, 12:19)
>    ggplot (12:5)
> 
> The name of the package is ProteinPCA and I have already checked multiple
> times the Description files for any possible misspellings but I have not
> found any. Same goes with ggplot2.
> 
> At this moment, I am really at loss on how to resolve this issue. Could you
> perhaps enlighten me on this?
> 
> Thank you very much.
> 
> Sincerely,
> *P. A. C. Manlapaz, RCh*
> 
>    [[alternative HTML version deleted]]
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From ||u|@@rev|||@ @end|ng |rom gm@||@com  Sun Apr  6 01:25:09 2025
From: ||u|@@rev|||@ @end|ng |rom gm@||@com (=?UTF-8?Q?Llu=C3=ADs_Revilla?=)
Date: Sun, 6 Apr 2025 01:25:09 +0200
Subject: [R-pkg-devel] 
 Warnings and notes while building package with nimble
In-Reply-To: <DM6PR01MB38971146EB7242086206CBDBA2A92@DM6PR01MB3897.prod.exchangelabs.com>
References: <DM6PR01MB38971146EB7242086206CBDBA2A92@DM6PR01MB3897.prod.exchangelabs.com>
Message-ID: <CAN+W6_uVKhYy=Vz8oboRfGsHUMm8rLPcaN27tfYQ9F75Lx3-AA@mail.gmail.com>

Hi Aritra,

It would be helpful if we can explore the package source code. It helps to
provide a more accurate answer.

But you will find some other cases on the archive of the mailing list with
similar messages.
The message indicates that the static code analyzer hasn't detected the
definition of the object but detected it is used.
This is often the case if you use subset, within or dplyr, ggplot2,
data.table or other packages that use delayed evaluation.
To solve it, it might be as simple as writing nimDim <- NULL inside your
package or there might be a real issue there.

Best,

Llu?s

On Sat, 5 Apr 2025 at 18:25, Halder,Aritra <ah3758 at drexel.edu> wrote:

> Hi,
>
> I am trying to submit a package to CRAN built using nimble. It generates
> warnings like so:
>
> : no visible global function definition for  'nimDim'
>
> and fails automatic checks by CRAN. Any help is appreciated.
>
> Thanks and regards,
>
> Aritra
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From edd @end|ng |rom deb|@n@org  Sun Apr  6 01:31:54 2025
From: edd @end|ng |rom deb|@n@org (Dirk Eddelbuettel)
Date: Sat, 5 Apr 2025 18:31:54 -0500
Subject: [R-pkg-devel] 
 Warnings and notes while building package with nimble
In-Reply-To: <CAN+W6_uVKhYy=Vz8oboRfGsHUMm8rLPcaN27tfYQ9F75Lx3-AA@mail.gmail.com>
References: <DM6PR01MB38971146EB7242086206CBDBA2A92@DM6PR01MB3897.prod.exchangelabs.com>
 <CAN+W6_uVKhYy=Vz8oboRfGsHUMm8rLPcaN27tfYQ9F75Lx3-AA@mail.gmail.com>
Message-ID: <26609.48490.450936.846033@rob.eddelbuettel.com>


On 6 April 2025 at 01:25, Llu?s Revilla wrote:
| To solve it, it might be as simple as writing nimDim <- NULL inside your
| package or there might be a real issue there.

Or call utils::globalVariables(c("nimDim")) where, if needed, you could add
to that argument vector any other variables listed as global. 

Cheers, Dirk

-- 
dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From chr|@@br|en @end|ng |rom @de|@|de@edu@@u  Sun Apr  6 10:08:15 2025
From: chr|@@br|en @end|ng |rom @de|@|de@edu@@u (Chris Brien)
Date: Sun, 6 Apr 2025 08:08:15 +0000
Subject: [R-pkg-devel] Unreproducible error for CRAN submission on
 winbuilder using r-devel
Message-ID: <ME4P282MB1287D439FBAC309EC438D30EA0AB2@ME4P282MB1287.AUSP282.PROD.OUTLOOK.COM>

Hi all,

I submitted my package asremlPlus 4.4.47 to CRAN on Thurs 3/04/2025 and it generated an Error (and a NOTE) on Winbuilder using R version 4.5.0 RC (2025-04-04 r88102 ucrt):

package asremlPlus_4.4.47.tar.gz does not pass the incoming checks automatically, please see the following pre-tests (additional issue checks):
Windows: <https://win-builder.r-project.org/incoming_pretest/asremlPlus_4.4.47_20250403_120518/Windows/00check.log<https://win-builder.r-project.org/incoming_pretest/asremlPlus_4.4.47_20250403_120518/Windows/00check.log>>
Status: 1 ERROR, 1 NOTE

I ran R CMD check on the package using r-devel r88102 and was unable to generate the ERROR.

So, I submitted the package to Winbuilder r-devel and the package does not generate an error using R version 4.5.0 RC (2025-04-04 r88112 ucrt) - see https://win-builder.r-project.org/Ht2zyDE9N1Xx/00check.log.

Can I assume that the error was transitory and resubmit my package to CRAN?

Cheers,

 Chris



	[[alternative HTML version deleted]]


From ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de  Sun Apr  6 13:08:10 2025
From: ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de (Uwe Ligges)
Date: Sun, 6 Apr 2025 13:08:10 +0200
Subject: [R-pkg-devel] Unreproducible error for CRAN submission on
 winbuilder using r-devel
In-Reply-To: <ME4P282MB1287D439FBAC309EC438D30EA0AB2@ME4P282MB1287.AUSP282.PROD.OUTLOOK.COM>
References: <ME4P282MB1287D439FBAC309EC438D30EA0AB2@ME4P282MB1287.AUSP282.PROD.OUTLOOK.COM>
Message-ID: <421d4aaa-571d-40a6-a4cf-3fe773d5d0b0@statistik.tu-dortmund.de>

This is on so far strange as the winbuilder service and the CRAN 
incoming check happen actually on the same machine, same library and 
same version of R.

If this is not related to some randomness in generating your data, 
please simply resubmit.

Best,
Uwe Ligges




On 06.04.2025 10:08, Chris Brien wrote:
> Hi all,
> 
> I submitted my package asremlPlus 4.4.47 to CRAN on Thurs 3/04/2025 and it generated an Error (and a NOTE) on Winbuilder using R version 4.5.0 RC (2025-04-04 r88102 ucrt):
> 
> package asremlPlus_4.4.47.tar.gz does not pass the incoming checks automatically, please see the following pre-tests (additional issue checks):
> Windows: <https://win-builder.r-project.org/incoming_pretest/asremlPlus_4.4.47_20250403_120518/Windows/00check.log<https://win-builder.r-project.org/incoming_pretest/asremlPlus_4.4.47_20250403_120518/Windows/00check.log>>
> Status: 1 ERROR, 1 NOTE
> 
> I ran R CMD check on the package using r-devel r88102 and was unable to generate the ERROR.
> 
> So, I submitted the package to Winbuilder r-devel and the package does not generate an error using R version 4.5.0 RC (2025-04-04 r88112 ucrt) - see https://win-builder.r-project.org/Ht2zyDE9N1Xx/00check.log.
> 
> Can I assume that the error was transitory and resubmit my package to CRAN?
> 
> Cheers,
> 
>   Chris
> 
> 
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From murdoch@dunc@n @end|ng |rom gm@||@com  Sun Apr  6 15:33:19 2025
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Sun, 6 Apr 2025 09:33:19 -0400
Subject: [R-pkg-devel] Unreproducible error for CRAN submission on
 winbuilder using r-devel
In-Reply-To: <ME4P282MB1287D439FBAC309EC438D30EA0AB2@ME4P282MB1287.AUSP282.PROD.OUTLOOK.COM>
References: <ME4P282MB1287D439FBAC309EC438D30EA0AB2@ME4P282MB1287.AUSP282.PROD.OUTLOOK.COM>
Message-ID: <b29b0479-9569-440c-80f3-1558354aa7b9@gmail.com>

On 2025-04-06 4:08 a.m., Chris Brien wrote:
> Hi all,
> 
> I submitted my package asremlPlus 4.4.47 to CRAN on Thurs 3/04/2025 and it generated an Error (and a NOTE) on Winbuilder using R version 4.5.0 RC (2025-04-04 r88102 ucrt):
> 
> package asremlPlus_4.4.47.tar.gz does not pass the incoming checks automatically, please see the following pre-tests (additional issue checks):
> Windows: <https://win-builder.r-project.org/incoming_pretest/asremlPlus_4.4.47_20250403_120518/Windows/00check.log<https://win-builder.r-project.org/incoming_pretest/asremlPlus_4.4.47_20250403_120518/Windows/00check.log>>
> Status: 1 ERROR, 1 NOTE
> 
> I ran R CMD check on the package using r-devel r88102 and was unable to generate the ERROR.
> 
> So, I submitted the package to Winbuilder r-devel and the package does not generate an error using R version 4.5.0 RC (2025-04-04 r88112 ucrt) - see https://win-builder.r-project.org/Ht2zyDE9N1Xx/00check.log.
> 
> Can I assume that the error was transitory and resubmit my package to CRAN?
> 
> Cheers,

The error was

"Error in pf(q = Fvalue, df1 = ndf, df2 = ddf, lower.tail = FALSE) :
   Non-numeric argument to mathematical function"

That doesn't look like something that would be transitory.  If you are 
working with random data it might be hard to reproduce, but still worth 
worrying about.  Or it could be transitory because some package you're 
using was updated between the two runs, or some weird timing issue 
caused some value to be wrong.

Duncan Murdoch


From chr|@@br|en @end|ng |rom @de|@|de@edu@@u  Mon Apr  7 01:51:45 2025
From: chr|@@br|en @end|ng |rom @de|@|de@edu@@u (Chris Brien)
Date: Sun, 6 Apr 2025 23:51:45 +0000
Subject: [R-pkg-devel] Unreproducible error for CRAN submission on
 winbuilder using r-devel
In-Reply-To: <b29b0479-9569-440c-80f3-1558354aa7b9@gmail.com>
References: <ME4P282MB1287D439FBAC309EC438D30EA0AB2@ME4P282MB1287.AUSP282.PROD.OUTLOOK.COM>
 <b29b0479-9569-440c-80f3-1558354aa7b9@gmail.com>
Message-ID: <ME4P282MB12875D91379E8866C17C7AD7A0AB2@ME4P282MB1287.AUSP282.PROD.OUTLOOK.COM>

Hi Duncan,

Thanks for your comments.

"Error in pf(q = Fvalue, df1 = ndf, df2 = ddf, lower.tail = FALSE) :
Non-numeric argument to mathematical function"
Indeed, and the problem arises from a call to the anova function of lmerTest whose latest versions is 2020-10-23.


That doesn't look like something that would be transitory. If you are
working with random data it might be hard to reproduce, but still worth
worrying about. Or it could be transitory because some package you're
using was updated between the two runs, or some weird timing issue
caused some value to be wrong.

The data is a data set from asremlplus called Oat.dat, so not random at all.

It seems that the most likely explanation is that it is some weird transitory issue on the CRAN incoming check that caused some value to be wrong.

Anyway, asremlPlus has now been resubmitted and is on its way to CRAN.

Cheers,

 Chris



From: Duncan Murdoch <murdoch.duncan at gmail.com>
Sent: Sunday, 6 April 2025 11:03 PM
To: Chris Brien <chris.brien at adelaide.edu.au>; r-package-devel at r-project.org
Subject: Re: [R-pkg-devel] Unreproducible error for CRAN submission on winbuilder using r-devel

On 2025-04-06 4:08 a.m., Chris Brien wrote:
> Hi all,
>
> I submitted my package asremlPlus 4.4.47 to CRAN on Thurs 3/04/2025 and it generated an Error (and a NOTE) on Winbuilder using R version 4.5.0 RC (2025-04-04 r88102 ucrt):
>
> package asremlPlus_4.4.47.tar.gz does not pass the incoming checks automatically, please see the following pre-tests (additional issue checks):
> Windows: <https://win-builder.r-project.org/incoming_pretest/asremlPlus_4.4.47_20250403_120518/Windows/00check.log<https://win-builder.r-project.org/incoming_pretest/asremlPlus_4.4.47_20250403_120518/Windows/00check.log><https://win-builder.r-project.org/incoming_pretest/asremlPlus_4.4.47_20250403_120518/Windows/00check.log<https://win-builder.r-project.org/incoming_pretest/asremlPlus_4.4.47_20250403_120518/Windows/00check.log>>>
> Status: 1 ERROR, 1 NOTE
>
> I ran R CMD check on the package using r-devel r88102 and was unable to generate the ERROR.
>
> So, I submitted the package to Winbuilder r-devel and the package does not generate an error using R version 4.5.0 RC (2025-04-04 r88112 ucrt) - see https://win-builder.r-project.org/Ht2zyDE9N1Xx/00check.log<https://win-builder.r-project.org/Ht2zyDE9N1Xx/00check.log>.
>
> Can I assume that the error was transitory and resubmit my package to CRAN?
>
> Cheers,

The error was

"Error in pf(q = Fvalue, df1 = ndf, df2 = ddf, lower.tail = FALSE) :
Non-numeric argument to mathematical function"

That doesn't look like something that would be transitory. If you are
working with random data it might be hard to reproduce, but still worth
worrying about. Or it could be transitory because some package you're
using was updated between the two runs, or some weird timing issue
caused some value to be wrong.

Duncan Murdoch

	[[alternative HTML version deleted]]


From ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de  Mon Apr  7 10:24:13 2025
From: ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de (Uwe Ligges)
Date: Mon, 7 Apr 2025 10:24:13 +0200
Subject: [R-pkg-devel] 
 Warnings and notes while building package with nimble
In-Reply-To: <DM6PR01MB38971146EB7242086206CBDBA2A92@DM6PR01MB3897.prod.exchangelabs.com>
References: <DM6PR01MB38971146EB7242086206CBDBA2A92@DM6PR01MB3897.prod.exchangelabs.com>
Message-ID: <d0bf0977-d98b-4ba4-b161-8b6d7d730ff0@statistik.tu-dortmund.de>



On 05.04.2025 00:29, Halder,Aritra wrote:
> Hi,
> 
> I am trying to submit a package to CRAN built using nimble. It generates warnings like so:

Which package?


> : no visible global function definition for  'nimDim'

and you have not forgot to import nlmDim()?

Best,
Uwe Ligges






> and fails automatic checks by CRAN. Any help is appreciated.
> 
> Thanks and regards,
> 
> Aritra
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From kev|n@r@coombe@ @end|ng |rom gm@||@com  Mon Apr  7 17:10:21 2025
From: kev|n@r@coombe@ @end|ng |rom gm@||@com (Kevin R. Coombes)
Date: Mon, 7 Apr 2025 11:10:21 -0400
Subject: [R-pkg-devel] URLs in DESCRIPTION file
Message-ID: <412dd1c9-85e9-4786-b20d-109af5c96fc8@gmail.com>

Hi,

I am systematically going through the packages that I maintain on CRAN 
to clean up some administrative details. Specifically, I am (1) changing 
all DESCRIPTION files to use Authirs at R, (2) updating the links in man 
files to include package anchors, and (3) making sure that the output of 
calls to summary in test scripts don't break (i.e., mismatch the saved 
test output) in the 4.5.0 release candidate.

Not surprisingly, this process also finds other issues. Right now,I am 
looking at the package BimodalIndex. The version currently on CRAN (v. 
1.1.9) includes the following URL:
 ??? https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2730180/
On first checking the package, I get informed that this URL has 
"permanently moved" to:
 ??? https://pmc.ncbi.nlm.nih.gov/articles/PMC2730180/

The fix seems simple, so I edited the DESCRIPTION file to use the new 
URL instead of the old one. Then I submitted the newly built version 
(1.1.11) to both the current release and the development release at 
winbuilder before submitting the update to CRAN.? R version 4.4.3 comes 
back with a 00check.log that is absolutely "OK". No errors, warnings, or 
notes. But version R 4.5.0 RC comes back with;
 ??? (possibly) invalid URL. Status: 403? Message: Forbidden
I copied the URL as reported in the error message, pasted it into my 
browser, and it worked just fine.

Can I assume that this is just something weird about the corresponding 
winbuilder server at the moment, and go ahead and submit the package? Or 
is there some mysterious change in R 4.5 lurking somewhere that I need 
to deal with?

Thanks,
 ?? Kevin


From |kry|ov @end|ng |rom d|@root@org  Mon Apr  7 17:35:35 2025
From: |kry|ov @end|ng |rom d|@root@org (Ivan Krylov)
Date: Mon, 7 Apr 2025 18:35:35 +0300
Subject: [R-pkg-devel] URLs in DESCRIPTION file
In-Reply-To: <412dd1c9-85e9-4786-b20d-109af5c96fc8@gmail.com>
References: <412dd1c9-85e9-4786-b20d-109af5c96fc8@gmail.com>
Message-ID: <20250407183535.2f11ab7f@arachnoid>

? Mon, 7 Apr 2025 11:10:21 -0400
"Kevin R. Coombes" <kevin.r.coombes at gmail.com> ?????:

> But version R 4.5.0 RC comes back with;
>  ??? (possibly) invalid URL. Status: 403? Message: Forbidden
> I copied the URL as reported in the error message, pasted it into my 
> browser, and it worked just fine.
> 
> Can I assume that this is just something weird about the
> corresponding winbuilder server at the moment, and go ahead and
> submit the package?

This is a false positive. R CMD check sends automated requests to all
URLs it finds in the package. PubMed "protects" itself from automated
requests and returns an error code:

$ curl -I https://pmc.ncbi.nlm.nih.gov/articles/PMC2730180/
HTTP/2 403
content-length: 134
content-type: text/html; charset=UTF-8
date: Mon, 07 Apr 2025 15:14:59 GMT
alt-svc: clear

Using a browser instead results in subtly different behaviour visible
to the server, so the page loads successfully when clicking a link.

I see you're already linking to the article's DOI, 10.4137/cin.s2846,
and the article is not paywalled. Is it an option to remove the PubMed
link? There is code that is intended to recommend to only use the DOI,
but currently doesn't include a pattern for the new PubMed URLs:

if(length(y) &&
         any(ind <-
           (grepl(re_or(c("^https://pubmed.ncbi.nlm.nih.gov/[0-9]+",
              "^https://www.ncbi.nlm.nih.gov/pmc/articles/PMC[0-9]+/$",
              "^https://academic.oup.com/.*(/[0-9]*){4}$",
              "^https://www.sciencedirect.com/science/article")),
            y$URL)))) {
    ## <FIXME>
    ## Ideally we would complain about such URLs in general
    ## and not only when the URL checks were not OK.
    paste(c("Please use DOIs for the following publisher URLs:",
            paste0("  ", y$URL[ind])),
          collapse = "\n")
    ## </FIXME>
}

If you don't want to remove the PubMed link, you can explain the
"possibly invalid URL" as a false positive in the submission comment.

-- 
Best regards,
Ivan


From kev|n@r@coombe@ @end|ng |rom gm@||@com  Mon Apr  7 17:52:30 2025
From: kev|n@r@coombe@ @end|ng |rom gm@||@com (Kevin R. Coombes)
Date: Mon, 7 Apr 2025 11:52:30 -0400
Subject: [R-pkg-devel] URLs in DESCRIPTION file
In-Reply-To: <20250407183535.2f11ab7f@arachnoid>
References: <412dd1c9-85e9-4786-b20d-109af5c96fc8@gmail.com>
 <20250407183535.2f11ab7f@arachnoid>
Message-ID: <7a26a6a4-8501-44bf-baad-13885ed1a305@gmail.com>

Thanks. That's what I thought (though I was somewhat confused by the 
different behaviors of winbuilder on the current and development 
versions). I think the original DESCRIPTION file (from 2017?) just had 
the URL. Some time after that, CRAN asked for the inclusion of the DOI, 
but they didn't say to get rid of the URL. The code itself hasn't been 
touched since at least 2019 (since it still works exactly the way it is 
supposed to.)

And, becauseI have been both finding and losing things on the Internet 
for several decades, I am not particularly confident that the DOI is 
going to have a significantly longer stable lifetime than the NCBI URL. 
So, for now at least, I think I will leave them both.

Best,
 ?? Kevin

On 4/7/2025 11:35 AM, Ivan Krylov wrote:
> ? Mon, 7 Apr 2025 11:10:21 -0400
> "Kevin R. Coombes" <kevin.r.coombes at gmail.com> ?????:
>
>> But version R 4.5.0 RC comes back with;
>>   ??? (possibly) invalid URL. Status: 403? Message: Forbidden
>> I copied the URL as reported in the error message, pasted it into my
>> browser, and it worked just fine.
>>
>> Can I assume that this is just something weird about the
>> corresponding winbuilder server at the moment, and go ahead and
>> submit the package?
> This is a false positive. R CMD check sends automated requests to all
> URLs it finds in the package. PubMed "protects" itself from automated
> requests and returns an error code:
>
> $ curl -I https://pmc.ncbi.nlm.nih.gov/articles/PMC2730180/
> HTTP/2 403
> content-length: 134
> content-type: text/html; charset=UTF-8
> date: Mon, 07 Apr 2025 15:14:59 GMT
> alt-svc: clear
>
> Using a browser instead results in subtly different behaviour visible
> to the server, so the page loads successfully when clicking a link.
>
> I see you're already linking to the article's DOI, 10.4137/cin.s2846,
> and the article is not paywalled. Is it an option to remove the PubMed
> link? There is code that is intended to recommend to only use the DOI,
> but currently doesn't include a pattern for the new PubMed URLs:
>
> if(length(y) &&
>           any(ind <-
>             (grepl(re_or(c("^https://pubmed.ncbi.nlm.nih.gov/[0-9]+",
>                "^https://www.ncbi.nlm.nih.gov/pmc/articles/PMC[0-9]+/$",
>                "^https://academic.oup.com/.*(/[0-9]*){4}$",
>                "^https://www.sciencedirect.com/science/article")),
>              y$URL)))) {
>      ## <FIXME>
>      ## Ideally we would complain about such URLs in general
>      ## and not only when the URL checks were not OK.
>      paste(c("Please use DOIs for the following publisher URLs:",
>              paste0("  ", y$URL[ind])),
>            collapse = "\n")
>      ## </FIXME>
> }
>
> If you don't want to remove the PubMed link, you can explain the
> "possibly invalid URL" as a false positive in the submission comment.
>


From kev|nu@hey @end|ng |rom gm@||@com  Mon Apr  7 18:18:29 2025
From: kev|nu@hey @end|ng |rom gm@||@com (Kevin Ushey)
Date: Mon, 7 Apr 2025 09:18:29 -0700
Subject: [R-pkg-devel] libc++ and abort function usage
In-Reply-To: <CALOkxuxkANWVyYeC1JFzVSjRwWG9ae=5CYN1Ze9SBL8jMBTz2g@mail.gmail.com>
References: <CALOkxuxkANWVyYeC1JFzVSjRwWG9ae=5CYN1Ze9SBL8jMBTz2g@mail.gmail.com>
Message-ID: <CAJXgQP1N6qEKHBxRFnRZN593ycGq-WoZ=cu_eGkUiaRn2KMiCg@mail.gmail.com>

Hi Reed,

Unfortunately I don't think there is any other strategy here -- I
would agree that your best bet is to just enable exceptions in the
bundled library.

Best,
Kevin

On Fri, Apr 4, 2025 at 5:59?PM Reed A. Cartwright
<racartwright at gmail.com> wrote:
>
> I have updated my package, rbedrock [1-2], to remove a bundled
> library's calls to abort() and stderr when compiled with -DNDEBUG
> (which is the default). This has mostly worked; however, I have
> uncovered that libc++ contains inline functions that call abort() if
> exceptions are disabled.
>
> My bundled library is a C++ library and is compiled with exceptions
> turned off. I use its C-level interface in my package, so its C++ code
> is mostly hidden from my package. When compiled on a platform with
> libc++, libc++ introduces abort calls into the compiled package. This
> is causing `R CMD check` to warn about abort() usage on those
> platforms.
>
> I am wondering what people on this list think I should do?
>
> Should I enable exceptions in the bundled library and keep using the
> C-level interface? (It doesn't throw any exceptions itself, but std
> library calls might.)
>
> If there is any other strategy that I should try, please let me know.
>
> Thanks,
> Reed
>
> [1] https://github.com/reedacartwright/rbedrock
> [2] https://cran.r-project.org/package=rbedrock
> [3] https://github.com/llvm/llvm-project/blob/release/12.x/libcxx/include/any#L107-L116
>
> --
> Reed A. Cartwright, PhD
> Associate Professor of Life Sciences
> TEACh Representative - Evolution and Computational Courses
> School of Life Sciences and The Biodesign Institute
> Arizona State University
> ==================
> Address: The Biodesign Institute, PO Box 876401, Tempe, AZ 85287-6401 USA
> Packages: The Biodesign Institute, 1001 S. McAllister Ave, Tempe, AZ
> 85287-6401 USA
> Office: Biodesign B-220C, 1-480-965-9949
> Website: http://cartwrig.ht/
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From ch@r|e@-||@te@+rd @end|ng |rom p|e@@y@org  Tue Apr  8 06:49:29 2025
From: ch@r|e@-||@te@+rd @end|ng |rom p|e@@y@org (Charles Plessy)
Date: Tue, 8 Apr 2025 13:49:29 +0900
Subject: [R-pkg-devel] URLs in DESCRIPTION file
In-Reply-To: <20250407183535.2f11ab7f@arachnoid>
References: <412dd1c9-85e9-4786-b20d-109af5c96fc8@gmail.com>
 <20250407183535.2f11ab7f@arachnoid>
Message-ID: <Z_Sq2XEUnVi20Z6x@kumo.plessy.net>

Le Mon, Apr 07, 2025 at 06:35:35PM +0300, Ivan Krylov via R-package-devel a ?crit :
> 
> PubMed "protects" itself from automated requests and returns an error code:
> 
> $ curl -I https://pmc.ncbi.nlm.nih.gov/articles/PMC2730180/
> HTTP/2 403

Quick minor correction: this is PubMed Central, not PubMed.

A PubMed URL to the same article would work:

curl -I https://pubmed.ncbi.nlm.nih.gov/19718451/
HTTP/2 200 

Have a nice day,

Charles Plessy


From pro|jcn@@h @end|ng |rom gm@||@com  Thu Apr 10 01:52:05 2025
From: pro|jcn@@h @end|ng |rom gm@||@com (J C Nash)
Date: Wed, 9 Apr 2025 19:52:05 -0400
Subject: [R-pkg-devel] Procedure for dealing with reverse dependency that
 has gone bad on CRAN version of my package
Message-ID: <f9d824ef-2e0c-4d50-b754-e2b24849a5b7@gmail.com>

In correcting a minor bug in the optimx package, I submitted a new version today.
The existing CRAN version (2024-12.2) has all CRAN checks OK, and to my knowledge
no notifications of bugs. The new version has hit a FAIL with package phenofit revdep.
Wanting to have output from a "working" system, I (re-)installed the CRAN version
of optimx and ran R CMD check on phenofit, and also get the FAIL on one of its tests.

The failure is a solve error (singularity) in the called minimizer nlminb, so could be
a result of some alteration in something like the matrix routines. I've also seen
changes in tests due to use of M1 and similar processors, relaxed IEEE arithmetic
being the cause. Such differences in outcome are not really a surprise, but can
be a nuisance.

My query is how to proceed to resolve this situation. Since my existing package --
which was supposedly OK back in December -- also throws the test failure in phenofit,
I've no path to reverse changes in my code. It's also possible there's no error
in phenofit, just a test case that now trips up when it did not prior to some
external change.

Still, some resolution is needed, and it would be good to avoid too much fuss.

John Nash


From ph||||p@j@rrett1 @end|ng |rom gm@||@com  Thu Apr 10 01:57:36 2025
From: ph||||p@j@rrett1 @end|ng |rom gm@||@com (Jarrett Phillips)
Date: Wed, 9 Apr 2025 19:57:36 -0400
Subject: [R-pkg-devel] Lost Braces in R Markdown File
Message-ID: <CAMVrHdB1MD09exeXi1OLC7-fE7y2VEH0GW2wbEsR6gTw_efvBg@mail.gmail.com>

Hello!

I recently ran R CMD CHECK via devtools::check_built() on my CRAN package
'VLF'. See: https://cran.r-project.org/web/checks/check_results_VLF.html.

The notes I received pertain to the below, but I am unsure exactly how to
resolve the issue after googling a bit. Any ideas?

Thanks.

Cheers,

Jarrett

-----

Version: 1.1
Check: Rd files
Result: NOTE
  checkRd: (-1) aminoAcidFun.Rd:37: Lost braces
      37 | \item{ownVLFreduced}{ownVLFMatrix}{A matrix containing only
those specimen that have VLFs as well as the amino     acids at the
positions that contain VLFs and NAs in all other positions of the
sequence.  Only appears if own is not NULL.}
         |                                   ^
  checkRd: (-1) vlfFun.Rd:36: Lost braces
      36 | \item{ownVLFreduced}{ownVLFMatrix}{A matrix containing only
those specimen that have VLFs as well as the     nucleotides at the
positions that contain VLFs and NAs in all other positions of the
sequence.  Only appears if own is not NULL.}
         |

	[[alternative HTML version deleted]]


From murdoch@dunc@n @end|ng |rom gm@||@com  Thu Apr 10 04:41:07 2025
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Wed, 9 Apr 2025 22:41:07 -0400
Subject: [R-pkg-devel] Lost Braces in R Markdown File
In-Reply-To: <CAMVrHdB1MD09exeXi1OLC7-fE7y2VEH0GW2wbEsR6gTw_efvBg@mail.gmail.com>
References: <CAMVrHdB1MD09exeXi1OLC7-fE7y2VEH0GW2wbEsR6gTw_efvBg@mail.gmail.com>
Message-ID: <455645f1-3bc7-4da2-a9a8-47e49aa72906@gmail.com>

[I sent this only to Jarrett on my first attempt, this was meant to go 
to the list.]

The syntax for the \item macro has two arguments, so the text "A matrix
containing only those specimen that have ..." is in braces that are
unnecessary.  That's why you got the note, because check thinks that was
unintentional and wanted to point it out to you.  It's legal, so it's
not an error, just a note.

If I look at the display of the help page ?aminoAcidFun, I think it's
right that something is wrong.  The formatting near the end of the Value
section looks messed up.

Duncan Murdoch



On 2025-04-09 7:57 p.m., Jarrett Phillips wrote:
> Hello!
> 
> I recently ran R CMD CHECK via devtools::check_built() on my CRAN package
> 'VLF'. See: https://cran.r-project.org/web/checks/check_results_VLF.html.
> 
> The notes I received pertain to the below, but I am unsure exactly how to
> resolve the issue after googling a bit. Any ideas?
> 
> Thanks.
> 
> Cheers,
> 
> Jarrett
> 
> -----
> 
> Version: 1.1
> Check: Rd files
> Result: NOTE
>    checkRd: (-1) aminoAcidFun.Rd:37: Lost braces
>        37 | \item{ownVLFreduced}{ownVLFMatrix}{A matrix containing only
> those specimen that have VLFs as well as the amino     acids at the
> positions that contain VLFs and NAs in all other positions of the
> sequence.  Only appears if own is not NULL.}
>           |                                   ^
>    checkRd: (-1) vlfFun.Rd:36: Lost braces
>        36 | \item{ownVLFreduced}{ownVLFMatrix}{A matrix containing only
> those specimen that have VLFs as well as the     nucleotides at the
> positions that contain VLFs and NAs in all other positions of the
> sequence.  Only appears if own is not NULL.}
>           |
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From em@nue|e@cord@no @end|ng |rom gm@||@com  Thu Apr 10 11:24:31 2025
From: em@nue|e@cord@no @end|ng |rom gm@||@com (Emanuele Cordano)
Date: Thu, 10 Apr 2025 11:24:31 +0200
Subject: [R-pkg-devel] broken or outdaeted URLs
Message-ID: <CAKw81f_UYBRk8tvyF7B3UysvrXU3jY86PLwiHEWWsePeAZuStg@mail.gmail.com>

Dear all,

I'm submitting a new version of a package created and published on CRAN
since 2011. I'm the maintainer. CRAN checks highlight the presence of some
URLs link in the documentation that can be broken or outdated and CRAN
asked me to fix them. I'm fixing them following the list set by CRAN and
win-builder services.  Is there an option in R CMD check that I can use on
my server to directly verify all URLs and fix them on my server / RStudio
server?

Thank you
Best
Emanuele Cordano

-- 
Emanuele Cordano, PhD
Environmental Engineer / Ingegnere per l' Ambiente e il territorio nr.
3587 (Albo A - Provincia di Trento)
cell: +39 3282818564
email: emanuele.cordano at gmail.com,emanuele.cordano at rendena100.eu,
emanuele.cordano at eurac.edu
PEC: emanuele.cordano at ingpec.eu
URL: www.rendena100.eu
LinkedIn: https://www.linkedin.com/in/emanuele-cordano-31995333
GitHub: https://github.com/ecor

	[[alternative HTML version deleted]]


From @d@mhsp@rks m@iii@g oii tut@@com  Thu Apr 10 12:40:15 2025
From: @d@mhsp@rks m@iii@g oii tut@@com (@d@mhsp@rks m@iii@g oii tut@@com)
Date: Thu, 10 Apr 2025 12:40:15 +0200 (CEST)
Subject: [R-pkg-devel] broken or outdaeted URLs
In-Reply-To: <CAKw81f_UYBRk8tvyF7B3UysvrXU3jY86PLwiHEWWsePeAZuStg@mail.gmail.com>
References: <CAKw81f_UYBRk8tvyF7B3UysvrXU3jY86PLwiHEWWsePeAZuStg@mail.gmail.com>
Message-ID: <ONUH3zQ--J-9@tuta.com>

Hi Emanuele,
I usually use `urlchecker::url_check()` to start with. There is a `urlchecker::url_update()` option in the package as well. The check catches the errors, the update can fix some but not all errors.

--
best,
Adam
10 Apr 2025 at 17:25 by emanuele.cordano at gmail.com:

> Dear all,
>
> I'm submitting a new version of a package created and published on CRAN
> since 2011. I'm the maintainer. CRAN checks highlight the presence of some
> URLs link in the documentation that can be broken or outdated and CRAN
> asked me to fix them. I'm fixing them following the list set by CRAN and
> win-builder services.  Is there an option in R CMD check that I can use on
> my server to directly verify all URLs and fix them on my server / RStudio
> server?
>
> Thank you
> Best
> Emanuele Cordano
>
> --
> Emanuele Cordano, PhD
> Environmental Engineer / Ingegnere per l' Ambiente e il territorio nr.
> 3587 (Albo A - Provincia di Trento)
> cell: +39 3282818564
> email: emanuele.cordano at gmail.com,emanuele.cordano at rendena100.eu,
> emanuele.cordano at eurac.edu
> PEC: emanuele.cordano at ingpec.eu
> URL: www.rendena100.eu
> LinkedIn: https://www.linkedin.com/in/emanuele-cordano-31995333
> GitHub: https://github.com/ecor
>
> [[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


	[[alternative HTML version deleted]]


From |kry|ov @end|ng |rom d|@root@org  Thu Apr 10 12:52:08 2025
From: |kry|ov @end|ng |rom d|@root@org (Ivan Krylov)
Date: Thu, 10 Apr 2025 13:52:08 +0300
Subject: [R-pkg-devel] broken or outdaeted URLs
In-Reply-To: <CAKw81f_UYBRk8tvyF7B3UysvrXU3jY86PLwiHEWWsePeAZuStg@mail.gmail.com>
References: <CAKw81f_UYBRk8tvyF7B3UysvrXU3jY86PLwiHEWWsePeAZuStg@mail.gmail.com>
Message-ID: <20250410135208.157697c6@arachnoid>

? Thu, 10 Apr 2025 11:24:31 +0200
Emanuele Cordano <emanuele.cordano at gmail.com> ?????:

> Is there an option in R CMD check that I can use on
> my server to directly verify all URLs

Does R CMD check --as-cran help?

-- 
Best regards,
Ivan


From pro|jcn@@h @end|ng |rom gm@||@com  Thu Apr 10 13:47:51 2025
From: pro|jcn@@h @end|ng |rom gm@||@com (J C Nash)
Date: Thu, 10 Apr 2025 07:47:51 -0400
Subject: [R-pkg-devel] 
 Procedure for dealing with reverse dependency that
 has gone bad on CRAN version of my package
In-Reply-To: <f9d824ef-2e0c-4d50-b754-e2b24849a5b7@gmail.com>
References: <f9d824ef-2e0c-4d50-b754-e2b24849a5b7@gmail.com>
Message-ID: <7f2cda3e-cb44-41c9-b412-5d41201ad16f@gmail.com>


I've had an email from CRAN team that the revdep failure with phenofit is a known issue and
updated optimx package (fixing glitch in computing approximate Hessian when objective uses dot args)
is on its way to CRAN.

John Nash


From r@k||||ck @end|ng |rom |@nc@@ter@@c@uk  Fri Apr 11 18:00:16 2025
From: r@k||||ck @end|ng |rom |@nc@@ter@@c@uk (Killick, Rebecca)
Date: Fri, 11 Apr 2025 16:00:16 +0000
Subject: [R-pkg-devel] \linkS4class anchoring
In-Reply-To: <LNXP265MB1564D9993DE64BAFF2F4B957A8B72@LNXP265MB1564.GBRP265.PROD.OUTLOOK.COM>
References: <LNXP265MB1564D9993DE64BAFF2F4B957A8B72@LNXP265MB1564.GBRP265.PROD.OUTLOOK.COM>
Message-ID: <LNXP265MB15649B9DFEE0CB8839F6DFA9A8B62@LNXP265MB1564.GBRP265.PROD.OUTLOOK.COM>

Hi Fellow Package Maintainers,

I received the following helpful message from the CRAN maintainers about a new check that my EnvCpt package is failing:

"CRAN would like to move its package web pages to providing (static) HTML refmans instead of PDF refmans, which needs Rd cross-references to Rd \link{} targets not in the package itself nor in the base packages to use package anchors, i.e., use \link[PKG]{FOO} (see section "Cross-references" in "Writing R Extensions")."

The CRAN package checks here:
https://cran.r-project.org/web/checks/check_results_EnvCpt.html
note that:
"Found the following Rd file(s) with Rd \link{} targets missing package anchors: envcpt.Rd: cpt-class"

All of the \link uses within my package are anchored except for the \linkS4class{cpt} call so I think this is what it is referring to.? I've checked the writing R extensions "Cross-references" section and it just says to use \linkS4class{<class>} but does so in reference to a class within the current package - which is what has been working up until now.

The class is within the changepoint package so, I tried the obvious inference, \linkS4class[changepoint]{cpt} but this creates the following warning on check:
"prepare_Rd: ./man/envcpt.Rd:63: unexpected TEXT '[changepoint]', expecting '{'
checkRd: (7) envcpt.Rd:63: Tag LIST is invalid in a \code block"

Has anyone else come across this (needing to reference a class in another package) and knows how to anchor it?

I could be lazy and just delete the reference to solve the problem but, as the class is given as outputs, I think it is helpful to users who haven't come across the class before to have a direct link to the structure of it.

Thanks,
Rebecca

Pronouns: They/Them/Theirs
Please note:? Whilst I may choose to correspond by email during evenings and weekends as it fits best with my preferred working pattern, I do not expect responses outside your usual working pattern.

From |kry|ov @end|ng |rom d|@root@org  Fri Apr 11 21:45:03 2025
From: |kry|ov @end|ng |rom d|@root@org (Ivan Krylov)
Date: Fri, 11 Apr 2025 22:45:03 +0300
Subject: [R-pkg-devel] \linkS4class anchoring
In-Reply-To: <LNXP265MB15649B9DFEE0CB8839F6DFA9A8B62@LNXP265MB1564.GBRP265.PROD.OUTLOOK.COM>
References: <LNXP265MB1564D9993DE64BAFF2F4B957A8B72@LNXP265MB1564.GBRP265.PROD.OUTLOOK.COM>
 <LNXP265MB15649B9DFEE0CB8839F6DFA9A8B62@LNXP265MB1564.GBRP265.PROD.OUTLOOK.COM>
Message-ID: <20250411224503.4c763fcb@Tarkus>

? Fri, 11 Apr 2025 16:00:16 +0000
"Killick, Rebecca" <r.killick at lancaster.ac.uk> ?????:

> All of the \link uses within my package are anchored except for the
> \linkS4class{cpt} call so I think this is what it is referring to.
> I've checked the writing R extensions "Cross-references" section and
> it just says to use \linkS4class{<class>} but does so in reference to
> a class within the current package - which is what has been working
> up until now.
> 
> The class is within the changepoint package so, I tried the obvious
> inference, \linkS4class[changepoint]{cpt} but this creates the
> following warning on check:
> "prepare_Rd: ./man/envcpt.Rd:63: unexpected TEXT '[changepoint]',
> expecting '{' checkRd: (7)
> envcpt.Rd:63: Tag LIST is invalid in a \code block"

\linkS4class is a "primitive" Rd markup operation, included in the
grammar and implemented directly by the individual Rd converters.
Currently, the grammar says that \linkS4class{} takes no optional
arguments. The workaround used by ?stats::xtabs is:

>> \code{\link[Matrix:sparseMatrix-class]{sparseMatrix}}

(With \linkS4class{sparseMatrix} helpfully left commented out on the
same line.)

In your case, that would be \link[changepoint:cpt-class]{cpt}.

For the future packages depending on future R versions, the grammar and
one of the converters can be changed:

-----------------------------------8<-----------------------------------
Index: src/library/tools/R/Rd2HTML.R
===================================================================
--- src/library/tools/R/Rd2HTML.R	(revision 88138)
+++ src/library/tools/R/Rd2HTML.R	(working copy)
@@ -35,6 +35,8 @@
     option <- attr(arg, "Rd_option")
 
     topic <- dest <- paste(unlist(arg), collapse = "")
+    if (tag == "\\linkS4class") dest <- paste0(dest, "-class")
+
     targetfile <- NULL
     pkg <- NULL
     if (!is.null(option)) {
@@ -55,7 +57,6 @@
     } else if (!isTEXT)
         stopRd(arg, Rdfile, "Bad \\link topic -- must be text")
 
-    if (tag == "\\linkS4class") dest <- paste0(dest, "-class")
     list(topic = topic, dest = dest, pkg = pkg, targetfile = targetfile)
 }
 
Index: src/library/tools/src/gramRd.y
===================================================================
--- src/library/tools/src/gramRd.y	(revision 88138)
+++ src/library/tools/src/gramRd.y	(working copy)
@@ -1168,7 +1168,6 @@
     
     { "\\emph",    LATEXMACRO },    
     { "\\file",    LATEXMACRO },
-    { "\\linkS4class", LATEXMACRO },
     { "\\pkg",	   LATEXMACRO },
     { "\\sQuote",  LATEXMACRO },
     
@@ -1209,6 +1208,7 @@
        one LaTeX-like argument */
        
     { "\\link",    OPTMACRO },
+    { "\\linkS4class", OPTMACRO },
        
     /* These markup macros require an R-like text argument */
     
-----------------------------------8<-----------------------------------

With the patch applied, the output for \linkS4class[changepoint]{cpt}
and \link[changepoint:cpt-class]{cpt} will be the same:

library(tools)
r"{ \linkS4class[changepoint]{cpt} \link[changepoint:cpt-class]{cpt} }" |>
 textConnection() |> parse_Rd(fragment = TRUE) |>
 Rd2HTML(no_links = FALSE, fragment = TRUE)'
# <p><a href="../../changepoint/help/cpt-class.html">cpt</a>
# <a href="../../changepoint/help/cpt-class.html">cpt</a>

Rd2ex skips \linkS4class as before; Rd2txt prints the name on the link;
Rd2latex doesn't support the cross-package anchor; and Rd2HTML needs to
process the ...-class destination first, before the if (option) { ... }
branch sets targetfile based on it.

-- 
Best regards,
Ivan


From jo@|@h@p@rry @end|ng |rom gm@||@com  Sat Apr 12 17:03:11 2025
From: jo@|@h@p@rry @end|ng |rom gm@||@com (Josiah Parry)
Date: Sat, 12 Apr 2025 08:03:11 -0700
Subject: [R-pkg-devel] extendr packages on CRAN
Message-ID: <CAL3ufULDRrB74hQwxmw9bWKy4aDk1o4mvfzf1DLcJzRmwVuBFA@mail.gmail.com>

Hey folks,

extendr v0.8.0 was released which provides backports from R 4.2 and onwards
to address the solidifying C api.

A number of packages are slated for archival on 2025-04-14. We believe
we've provided a PR to each package to get it back in good standing. If you
have not received a PR, please let Mossa (on the TO line) and myself know
and we will assist with a PR.

Release notes with migration guide at:
https://github.com/extendr/extendr/releases/tag/extendr-api-v0.8.0

Thanks,

Josiah Parry

	[[alternative HTML version deleted]]


From em@nue|e@cord@no @end|ng |rom gm@||@com  Mon Apr 14 08:53:38 2025
From: em@nue|e@cord@no @end|ng |rom gm@||@com (Emanuele Cordano)
Date: Mon, 14 Apr 2025 08:53:38 +0200
Subject: [R-pkg-devel] cran check about examples time
In-Reply-To: <01dbac8d$Blat.v3.2.24$1fe6c315$2606c31f4@mail.statistik.tu-dortmund.de>
References: <20250413154815.D51ECA019C@xmpalantir.wu.ac.at>
 <01dbac8d$Blat.v3.2.24$1fe6c315$2606c31f4@mail.statistik.tu-dortmund.de>
Message-ID: <CAKw81f-M=RyFY5iaUh_r7nTkMRe7b4pRFByxqo43jP7xLe7VTw@mail.gmail.com>

Dear list,

I'm submitting the following package. CRAN check were OK (frorr Windows)
whereas in Debian a function example elapses   5.326 seconds.  I need to
fix this. Most lines in the examples are within \donttest{} brackets, so
they should not be executed by CRAN checks. The examples are useful to
understand the functions, as they are, should I include all examples lines
in \donttest{} or \dontrun{} ?
Do you have any suggestion or reference on this? CRAN message attached
below.

Thank you
Best
Emanuele Cordano

CRAN message:

Dear maintainer,

package geotopbricks_1.5.9.1.tar.gz does not pass the incoming checks
automatically, please see the following pre-tests (additional issue checks):
Windows: <
https://win-builder.r-project.org/incoming_pretest/geotopbricks_1.5.9.1_20250413_174815/Windows/00check.log
>
Status: OK
Debian: <
https://win-builder.r-project.org/incoming_pretest/geotopbricks_1.5.9.1_20250413_174815/Debian/00check.log
>
Status: 1 NOTE

Last released version's CRAN status: OK: 9, NOTE: 5
See: <https://CRAN.R-project.org/web/checks/check_results_geotopbricks.html>

CRAN Web: <https://cran.r-project.org/package=geotopbricks>

Please fix all problems and resubmit a fixed version via the webform.
If you are not sure how to fix the problems shown, please ask for help on
the R-package-devel mailing list:
<https://stat.ethz.ch/mailman/listinfo/r-package-devel>
If you are fairly certain the rejection is a false positive, please
reply-all to this message and explain.

More details are given in the directory:
<
https://win-builder.r-project.org/incoming_pretest/geotopbricks_1.5.9.1_20250413_174815/
>
The files will be removed after roughly 7 days.

No strong reverse dependencies to be checked.

Best regards,
CRAN teams' auto-check service
Flavor: r-devel-windows-x86_64
Check: *, Result: OK


Flavor: r-devel-linux-x86_64-debian-gcc
Check: examples, Result: NOTE
  Examples with CPU (user + system) or elapsed time > 5s
                                  user system elapsed
  get.geotop.inpts.keyword.value 1.406  0.027   5.326

	[[alternative HTML version deleted]]


From em@nue|e@cord@no @end|ng |rom gm@||@com  Mon Apr 14 08:57:49 2025
From: em@nue|e@cord@no @end|ng |rom gm@||@com (Emanuele Cordano)
Date: Mon, 14 Apr 2025 08:57:49 +0200
Subject: [R-pkg-devel] broken or outdaeted URLs
In-Reply-To: <20250410135208.157697c6@arachnoid>
References: <CAKw81f_UYBRk8tvyF7B3UysvrXU3jY86PLwiHEWWsePeAZuStg@mail.gmail.com>
 <20250410135208.157697c6@arachnoid>
Message-ID: <CAKw81f_uwOMtfqbbWq5DpYSoerxXbsAkb3A=DRQpjVRb5_Sa=Q@mail.gmail.com>

No,  R CMD check --as-cran on my machine did not help.

  `urlchecker::url_check()`  was very useful. It found most of broken URLs
and they were fixed.

Thank you for your feedback.

Best
Emanuele Cordano

Il giorno gio 10 apr 2025 alle ore 12:52 Ivan Krylov <ikrylov at disroot.org>
ha scritto:

> ? Thu, 10 Apr 2025 11:24:31 +0200
> Emanuele Cordano <emanuele.cordano at gmail.com> ?????:
>
> > Is there an option in R CMD check that I can use on
> > my server to directly verify all URLs
>
> Does R CMD check --as-cran help?
>
> --
> Best regards,
> Ivan
>


-- 
Emanuele Cordano, PhD
Environmental Engineer / Ingegnere per l' Ambiente e il territorio nr.
3587 (Albo A - Provincia di Trento)
cell: +39 3282818564
email: emanuele.cordano at gmail.com,emanuele.cordano at rendena100.eu,
emanuele.cordano at eurac.edu
PEC: emanuele.cordano at ingpec.eu
URL: www.rendena100.eu
LinkedIn: https://www.linkedin.com/in/emanuele-cordano-31995333
GitHub: https://github.com/ecor

	[[alternative HTML version deleted]]


From |kry|ov @end|ng |rom d|@root@org  Mon Apr 14 13:34:16 2025
From: |kry|ov @end|ng |rom d|@root@org (Ivan Krylov)
Date: Mon, 14 Apr 2025 14:34:16 +0300
Subject: [R-pkg-devel] broken or outdaeted URLs
In-Reply-To: <CAKw81f_uwOMtfqbbWq5DpYSoerxXbsAkb3A=DRQpjVRb5_Sa=Q@mail.gmail.com>
References: <CAKw81f_UYBRk8tvyF7B3UysvrXU3jY86PLwiHEWWsePeAZuStg@mail.gmail.com>
 <20250410135208.157697c6@arachnoid>
 <CAKw81f_uwOMtfqbbWq5DpYSoerxXbsAkb3A=DRQpjVRb5_Sa=Q@mail.gmail.com>
Message-ID: <20250414143416.6df84324@arachnoid>

? Mon, 14 Apr 2025 08:57:49 +0200
Emanuele Cordano <emanuele.cordano at gmail.com> ?????:

> R CMD check --as-cran on my machine did not help.

Strange, it should be doing the same thing as 'urlchecker'. I've tried
it with an old version of 'RMAWGEN' and saw the messages:

>> * checking CRAN incoming feasibility ... [6s/526s] WARNING
>> <...>
>> Found the following (possibly) invalid URLs:

Some of the URL checks in R CMD check do not work if 'xml2' is not
installed, but 'urlchecker' depends on it as well. Still, glad that
'urlchecker' helped you locate and fix the problematic URLs.

-- 
Best regards,
Ivan


From |kry|ov @end|ng |rom d|@root@org  Mon Apr 14 13:34:22 2025
From: |kry|ov @end|ng |rom d|@root@org (Ivan Krylov)
Date: Mon, 14 Apr 2025 14:34:22 +0300
Subject: [R-pkg-devel] cran check about examples time
In-Reply-To: <CAKw81f-M=RyFY5iaUh_r7nTkMRe7b4pRFByxqo43jP7xLe7VTw@mail.gmail.com>
References: <20250413154815.D51ECA019C@xmpalantir.wu.ac.at>
 <01dbac8d$Blat.v3.2.24$1fe6c315$2606c31f4@mail.statistik.tu-dortmund.de>
 <CAKw81f-M=RyFY5iaUh_r7nTkMRe7b4pRFByxqo43jP7xLe7VTw@mail.gmail.com>
Message-ID: <20250414143422.45918aac@arachnoid>

? Mon, 14 Apr 2025 08:53:38 +0200
Emanuele Cordano <emanuele.cordano at gmail.com> ?????:

> CRAN check were OK (frorr Windows) whereas in Debian a function
> example elapses   5.326 seconds.  I need to fix this. Most lines in
> the examples are within \donttest{} brackets, so they should not be
> executed by CRAN checks.

Nowadays, R CMD check --as-cran does run \donttest{} examples. (But not
without --as-cran or --run-donttest, and no automatic checks enable
--run-dontrun.)

>   Examples with CPU (user + system) or elapsed time > 5s
>                                   user system elapsed
>   get.geotop.inpts.keyword.value 1.406  0.027   5.326

It looks like most of the time was spent waiting to establish a new
connection (closer to 8 seconds on my computer). What does
system.time(example(get.geotop.inpts.keyword.value)) return for you? Is
it an option to download less files in the example?

Having examples that download data from the internet is somewhat
precarious for a CRAN package. One way to prevent intermittent
connectivity problems from failing your package checks is to make sure
that any time your package fails to download something from the Web, it
calls stop() with a classed error object (e.g. simpleError(...) with an
additional class "geotop_internet_error" attached). This makes it
possible to wrap your examples in tryCatch(..., geotop_internet_error =
function(e) { ... }), so that any connection errors do not cause your
examples to fail, but other errors are not swallowed.

-- 
Best regards,
Ivan


From @di@@o m@iii@g oii pdx@edu  Mon Apr 14 06:54:03 2025
From: @di@@o m@iii@g oii pdx@edu (@di@@o m@iii@g oii pdx@edu)
Date: Sun, 13 Apr 2025 21:54:03 -0700 (PDT)
Subject: [R-pkg-devel] How to resolve help files with \Sexpr{} warning?
Message-ID: <alpine.DEB.2.22.394.2504132150390.3328074@anzu.alexisdinno.com>



Dear R Devs,


I am unsure how to resolve this NOTE in my package build (I am 
comfortable with the possibly misspelled words part):

 Package has help file(s) containing install/render-stage \Sexpr{} 
 expressions but no prebuilt PDF manual.


I've dozens of files and no idea which one(s) offend, or if I am missing 
some other detail. (Aside: I am using mathjaxr... not sure if that is 
the issue.)


Links for winbuilder logs are here for the time being:

 https://win-builder.r-project.org/qG7LHs2Yf18p
 https://win-builder.r-project.org/BBXdLV7kDOuI
 https://win-builder.r-project.org/63RmX21pnrAw ?This check passes


Thank you very much,

Alexis Dinno


PS Am including the log from the R-release winbuilder check in case my 
links expire:


* using log directory 
'd:/RCompile/CRANguest/R-oldrelease/tost.suite.Rcheck'
* using R version 4.4.3 (2025-02-28 ucrt)
* using platform: x86_64-w64-mingw32
* R was compiled by
    gcc.exe (GCC) 13.3.0
    GNU Fortran (GCC) 13.3.0
* running under: Windows Server 2022 x64 (build 20348)
* using session charset: UTF-8
* checking for file 'tost.suite/DESCRIPTION' ... OK
* this is package 'tost.suite' version '3.15'
* package encoding: UTF-8
* checking CRAN incoming feasibility ... [8s] NOTE
Maintainer: 'Alexis Dinno <alexis.dinno at pdx.edu>'

New submission

Possibly misspelled words in DESCRIPTION:
  Kolmogorov (9:402)
  McNemar's (9:198)
  OLS (9:289)
  Smirnov (9:413)
  Stata (9:47)
  Wilcoxon (9:312, 9:340)
  nonparametric (9:546)
  rrp (9:842)
  rrpi (9:855)
  tost (9:18, 9:65, 9:837, 9:850)

Package has help file(s) containing install/render-stage \Sexpr{} 
expressions but no prebuilt PDF manual.
* checking package namespace information ... OK
* checking package dependencies ... OK
* checking if this is a source package ... OK
* checking if there is a namespace ... OK
* checking for hidden files and directories ... OK
* checking for portable file names ... OK
* checking whether package 'tost.suite' can be installed ... OK
* checking installed package size ... OK
* checking package directory ... OK
* checking for future file timestamps ... OK
* checking DESCRIPTION meta-information ... OK
* checking top-level files ... OK
* checking for left-over files ... OK
* checking index information ... OK
* checking package subdirectories ... OK
* checking code files for non-ASCII characters ... OK
* checking R files for syntax errors ... OK
* checking whether the package can be loaded ... [1s] OK
* checking whether the package can be loaded with stated dependencies 
... [1s] OK
* checking whether the package can be unloaded cleanly ... [1s] OK
* checking whether the namespace can be loaded with stated dependencies 
... [1s] OK
* checking whether the namespace can be unloaded cleanly ... [1s] OK
* checking loading without being on the library search path ... [1s] OK
* checking use of S3 registration ... OK
* checking dependencies in R code ... OK
* checking S3 generic/method consistency ... OK
* checking replacement functions ... OK
* checking foreign function calls ... OK
* checking R code for possible problems ... [16s] OK
* checking Rd files ... [1s] OK
* checking Rd metadata ... OK
* checking Rd line widths ... OK
* checking Rd cross-references ... OK
* checking for missing documentation entries ... OK
* checking for code/documentation mismatches ... OK
* checking Rd \usage sections ... OK
* checking Rd contents ... OK
* checking for unstated dependencies in examples ... OK
* checking contents of 'data' directory ... OK
* checking data for non-ASCII characters ... [0s] OK
* checking data for ASCII and uncompressed saves ... OK
* checking examples ... [7s] OK
* checking PDF version of manual ... [12s] OK
* checking HTML version of manual ... [5s] OK
* checking for detritus in the temp directory ... OK
* DONE
Status: 1 NOTE

From |kw@|mmo @end|ng |rom gm@||@com  Mon Apr 14 15:46:22 2025
From: |kw@|mmo @end|ng |rom gm@||@com (Iris Simmons)
Date: Mon, 14 Apr 2025 09:46:22 -0400
Subject: [R-pkg-devel] How to resolve help files with \Sexpr{} warning?
In-Reply-To: <alpine.DEB.2.22.394.2504132150390.3328074@anzu.alexisdinno.com>
References: <alpine.DEB.2.22.394.2504132150390.3328074@anzu.alexisdinno.com>
Message-ID: <CADNULg_spZZyKmHmYAbO0MW0xHuBTWZsb735E23X4a8=NZKrbA@mail.gmail.com>

I believe R CMD build changed the default from --manual to --no-manual, I'm
not sure why. You could add --manual when you build the tarball or you
could add

BuildManual: TRUE

to your DESCRIPTION.

On Mon, Apr 14, 2025, 09:41 <adinno at pdx.edu> wrote:

>
>
> Dear R Devs,
>
>
> I am unsure how to resolve this NOTE in my package build (I am
> comfortable with the possibly misspelled words part):
>
>  Package has help file(s) containing install/render-stage \Sexpr{}
>  expressions but no prebuilt PDF manual.
>
>
> I've dozens of files and no idea which one(s) offend, or if I am missing
> some other detail. (Aside: I am using mathjaxr... not sure if that is
> the issue.)
>
>
> Links for winbuilder logs are here for the time being:
>
>  https://win-builder.r-project.org/qG7LHs2Yf18p
>  https://win-builder.r-project.org/BBXdLV7kDOuI
>  https://win-builder.r-project.org/63RmX21pnrAw ?This check passes
>
>
> Thank you very much,
>
> Alexis Dinno
>
>
> PS Am including the log from the R-release winbuilder check in case my
> links expire:
>
>
> * using log directory
> 'd:/RCompile/CRANguest/R-oldrelease/tost.suite.Rcheck'
> * using R version 4.4.3 (2025-02-28 ucrt)
> * using platform: x86_64-w64-mingw32
> * R was compiled by
>     gcc.exe (GCC) 13.3.0
>     GNU Fortran (GCC) 13.3.0
> * running under: Windows Server 2022 x64 (build 20348)
> * using session charset: UTF-8
> * checking for file 'tost.suite/DESCRIPTION' ... OK
> * this is package 'tost.suite' version '3.15'
> * package encoding: UTF-8
> * checking CRAN incoming feasibility ... [8s] NOTE
> Maintainer: 'Alexis Dinno <alexis.dinno at pdx.edu>'
>
> New submission
>
> Possibly misspelled words in DESCRIPTION:
>   Kolmogorov (9:402)
>   McNemar's (9:198)
>   OLS (9:289)
>   Smirnov (9:413)
>   Stata (9:47)
>   Wilcoxon (9:312, 9:340)
>   nonparametric (9:546)
>   rrp (9:842)
>   rrpi (9:855)
>   tost (9:18, 9:65, 9:837, 9:850)
>
> Package has help file(s) containing install/render-stage \Sexpr{}
> expressions but no prebuilt PDF manual.
> * checking package namespace information ... OK
> * checking package dependencies ... OK
> * checking if this is a source package ... OK
> * checking if there is a namespace ... OK
> * checking for hidden files and directories ... OK
> * checking for portable file names ... OK
> * checking whether package 'tost.suite' can be installed ... OK
> * checking installed package size ... OK
> * checking package directory ... OK
> * checking for future file timestamps ... OK
> * checking DESCRIPTION meta-information ... OK
> * checking top-level files ... OK
> * checking for left-over files ... OK
> * checking index information ... OK
> * checking package subdirectories ... OK
> * checking code files for non-ASCII characters ... OK
> * checking R files for syntax errors ... OK
> * checking whether the package can be loaded ... [1s] OK
> * checking whether the package can be loaded with stated dependencies
> ... [1s] OK
> * checking whether the package can be unloaded cleanly ... [1s] OK
> * checking whether the namespace can be loaded with stated dependencies
> ... [1s] OK
> * checking whether the namespace can be unloaded cleanly ... [1s] OK
> * checking loading without being on the library search path ... [1s] OK
> * checking use of S3 registration ... OK
> * checking dependencies in R code ... OK
> * checking S3 generic/method consistency ... OK
> * checking replacement functions ... OK
> * checking foreign function calls ... OK
> * checking R code for possible problems ... [16s] OK
> * checking Rd files ... [1s] OK
> * checking Rd metadata ... OK
> * checking Rd line widths ... OK
> * checking Rd cross-references ... OK
> * checking for missing documentation entries ... OK
> * checking for code/documentation mismatches ... OK
> * checking Rd \usage sections ... OK
> * checking Rd contents ... OK
> * checking for unstated dependencies in examples ... OK
> * checking contents of 'data' directory ... OK
> * checking data for non-ASCII characters ... [0s] OK
> * checking data for ASCII and uncompressed saves ... OK
> * checking examples ... [7s] OK
> * checking PDF version of manual ... [12s] OK
> * checking HTML version of manual ... [5s] OK
> * checking for detritus in the temp directory ... OK
> * DONE
> Status: 1 NOTE
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From |kry|ov @end|ng |rom d|@root@org  Mon Apr 14 15:58:45 2025
From: |kry|ov @end|ng |rom d|@root@org (Ivan Krylov)
Date: Mon, 14 Apr 2025 16:58:45 +0300
Subject: [R-pkg-devel] How to resolve help files with \Sexpr{} warning?
In-Reply-To: <alpine.DEB.2.22.394.2504132150390.3328074@anzu.alexisdinno.com>
References: <alpine.DEB.2.22.394.2504132150390.3328074@anzu.alexisdinno.com>
Message-ID: <20250414165845.35899aa8@arachnoid>

? Sun, 13 Apr 2025 21:54:03 -0700 (PDT)
adinno at pdx.edu ?????:

> Package has help file(s) containing install/render-stage \Sexpr{} 
> expressions but no prebuilt PDF manual.

This is a relatively recent change (r85348, October 2023). Previously,
R CMD build detected non-build-time dynamic content in the package
documentation and built the manual automatically. Nowadays I think you
have to set BuildManual: yes in your DESCRIPTION before building the
package. (There's R CMD build --no-manual, but I'm not seeing a command
line option to override it from "no" to "yes".)

> (Aside: I am using mathjaxr... not sure if that is the issue.)

Correct, that must be what's producing the render-stage dynamic content:

https://github.com/wviechtb/mathjaxr/blob/8900cbbb2eda4dc45b776cc203c2942b6289fac3/man/macros/mathjax.Rd#L4

-- 
Best regards,
Ivan


From @di@@o m@iii@g oii pdx@edu  Mon Apr 14 18:37:20 2025
From: @di@@o m@iii@g oii pdx@edu (@di@@o m@iii@g oii pdx@edu)
Date: Mon, 14 Apr 2025 09:37:20 -0700 (PDT)
Subject: [R-pkg-devel] How to resolve help files with \Sexpr{} warning?
In-Reply-To: <20250414165845.35899aa8@arachnoid>
References: <alpine.DEB.2.22.394.2504132150390.3328074@anzu.alexisdinno.com>
 <20250414165845.35899aa8@arachnoid>
Message-ID: <alpine.DEB.2.22.394.2504140901090.3338421@anzu.alexisdinno.com>



Dear Iris and Ivan, 


Together both your comments were very helpful, and both pointed me at a 
solution to resolve my issue and to explain why this change in behavior 
emerged, and how my package was triggering the behavior.

Solution that worked:

 Editing the DESCRIPTION file to add the line BuildManual: TRUE

Solution that did *not* work (along with variations):
 
 R CMD build --manual  ?Resulted in: Warning: unknown option ?--manual?
 R CMD --manual build
 R --manual CMD build
 R CMD check --manual

Note: I am using R version 4.4.3 (2025-02-28) -- "Trophy Case" on Ubuntu 
24.04


Thank you both very much for this help!

Alexis Dinno

From em@nue|e@cord@no @end|ng |rom gm@||@com  Wed Apr 16 09:39:13 2025
From: em@nue|e@cord@no @end|ng |rom gm@||@com (Emanuele Cordano)
Date: Wed, 16 Apr 2025 09:39:13 +0200
Subject: [R-pkg-devel] cran check about examples time
In-Reply-To: <20250414143422.45918aac@arachnoid>
References: <20250413154815.D51ECA019C@xmpalantir.wu.ac.at>
 <01dbac8d$Blat.v3.2.24$1fe6c315$2606c31f4@mail.statistik.tu-dortmund.de>
 <CAKw81f-M=RyFY5iaUh_r7nTkMRe7b4pRFByxqo43jP7xLe7VTw@mail.gmail.com>
 <20250414143422.45918aac@arachnoid>
Message-ID: <CAKw81f_O3D2Dim=Tr-f37vx4DR=PZofRNWpyd5g5V1YRY59XQg@mail.gmail.com>

Thanks
I  checked  system.time(example(get.geotop.inpts.keyword.value)) .  Elapsed
time varies on my machines between 6 and 3 seconds (see below) , mostly
lesser than 5 seconds. It extracts information from a set-up directory of
the GEOtop model. I cannot put an  GEOtop simulation folder within
"geotopbricks" package for obvious reasons and function example refers to
example GEOtop simulation folder available on an external ad hoc Github
repository.   I'm looking for a solution. Thanks for suggestions.

Best
Emanuele

 user  system elapsed
  2.991   0.024   5.532 > > >
system.time(example(get.geotop.inpts.keyword.value))

 user  system elapsed
  2.846   0.001   3.796

>

Il giorno lun 14 apr 2025 alle ore 13:34 Ivan Krylov <ikrylov at disroot.org>
ha scritto:

> ? Mon, 14 Apr 2025 08:53:38 +0200
> Emanuele Cordano <emanuele.cordano at gmail.com> ?????:
>
> > CRAN check were OK (frorr Windows) whereas in Debian a function
> > example elapses   5.326 seconds.  I need to fix this. Most lines in
> > the examples are within \donttest{} brackets, so they should not be
> > executed by CRAN checks.
>
> Nowadays, R CMD check --as-cran does run \donttest{} examples. (But not
> without --as-cran or --run-donttest, and no automatic checks enable
> --run-dontrun.)
>
> >   Examples with CPU (user + system) or elapsed time > 5s
> >                                   user system elapsed
> >   get.geotop.inpts.keyword.value 1.406  0.027   5.326
>
> It looks like most of the time was spent waiting to establish a new
> connection (closer to 8 seconds on my computer). What does
> system.time(example(get.geotop.inpts.keyword.value)) return for you? Is
> it an option to download less files in the example?
>
> Having examples that download data from the internet is somewhat
> precarious for a CRAN package. One way to prevent intermittent
> connectivity problems from failing your package checks is to make sure
> that any time your package fails to download something from the Web, it
> calls stop() with a classed error object (e.g. simpleError(...) with an
> additional class "geotop_internet_error" attached). This makes it
> possible to wrap your examples in tryCatch(..., geotop_internet_error =
> function(e) { ... }), so that any connection errors do not cause your
> examples to fail, but other errors are not swallowed.
>
> --
> Best regards,
> Ivan
>


-- 
Emanuele Cordano, PhD
Environmental Engineer / Ingegnere per l' Ambiente e il territorio nr.
3587 (Albo A - Provincia di Trento)
cell: +39 3282818564
email: emanuele.cordano at gmail.com,emanuele.cordano at rendena100.eu,
emanuele.cordano at eurac.edu
PEC: emanuele.cordano at ingpec.eu
URL: www.rendena100.eu
LinkedIn: https://www.linkedin.com/in/emanuele-cordano-31995333
GitHub: https://github.com/ecor

	[[alternative HTML version deleted]]


From tob|@@@|e|||nger @end|ng |rom @ge@@@t  Thu Apr 17 09:27:49 2025
From: tob|@@@|e|||nger @end|ng |rom @ge@@@t (Fellinger Tobias)
Date: Thu, 17 Apr 2025 07:27:49 +0000
Subject: [R-pkg-devel] [EXTERN]  cran check about examples time
In-Reply-To: <CAKw81f-M=RyFY5iaUh_r7nTkMRe7b4pRFByxqo43jP7xLe7VTw@mail.gmail.com>
References: <20250413154815.D51ECA019C@xmpalantir.wu.ac.at>
 <01dbac8d$Blat.v3.2.24$1fe6c315$2606c31f4@mail.statistik.tu-dortmund.de>
 <CAKw81f-M=RyFY5iaUh_r7nTkMRe7b4pRFByxqo43jP7xLe7VTw@mail.gmail.com>
Message-ID: <VE1PR01MB56807EB8340E276B05CF2C6889BC2@VE1PR01MB5680.eurprd01.prod.exchangelabs.com>

Dear Emanuele,

I checked one of the Notes. One of the examples of get.geotop.inpts.keyword.value that throws a NOTE has parts outside of donttest that seem to load data from an url which can lead to varying execution times depending on the server. Moreover the url seems not to work. (https://raw.githubusercontent.com/ecor/geotopbricks_doc/master/simulations/panola13_run2xC_test3)

If you want to load the data from the web, I'd also put this in a donttest section.

An alternative would be (if this makes sense for the example) to include the file in the package and load it with system.file in the examples. This should run faster and more reliable and be independent of changes to URLs outside of the repository. Beware of maximum package sizes though.

(I checked this with the current default branch on github.)

Hope this helps, best regards, Tobias

-----Urspr?ngliche Nachricht-----
Von: R-package-devel <r-package-devel-bounces at r-project.org> Im Auftrag von Emanuele Cordano
Gesendet: Montag, 14. April 2025 08:54
An: r-package-devel at r-project.org
Betreff: [EXTERN] [R-pkg-devel] cran check about examples time

[You don't often get email from emanuele.cordano at gmail.com. Learn why this is important at https://aka.ms/LearnAboutSenderIdentification ]

Dear list,

I'm submitting the following package. CRAN check were OK (frorr Windows)
whereas in Debian a function example elapses   5.326 seconds.  I need to
fix this. Most lines in the examples are within \donttest{} brackets, so they should not be executed by CRAN checks. The examples are useful to understand the functions, as they are, should I include all examples lines in \donttest{} or \dontrun{} ?
Do you have any suggestion or reference on this? CRAN message attached below.

Thank you
Best
Emanuele Cordano

CRAN message:

Dear maintainer,

package geotopbricks_1.5.9.1.tar.gz does not pass the incoming checks automatically, please see the following pre-tests (additional issue checks):
Windows: <
https://win-builder.r-project.org/incoming_pretest/geotopbricks_1.5.9.1_20250413_174815/Windows/00check.log
>
Status: OK
Debian: <
https://win-builder.r-project.org/incoming_pretest/geotopbricks_1.5.9.1_20250413_174815/Debian/00check.log
>
Status: 1 NOTE

Last released version's CRAN status: OK: 9, NOTE: 5
See: <https://cran.r-project.org/web/checks/check_results_geotopbricks.html>

CRAN Web: <https://cran.r-project.org/package=geotopbricks>

Please fix all problems and resubmit a fixed version via the webform.
If you are not sure how to fix the problems shown, please ask for help on the R-package-devel mailing list:
<https://stat.ethz.ch/mailman/listinfo/r-package-devel>
If you are fairly certain the rejection is a false positive, please reply-all to this message and explain.

More details are given in the directory:
<
https://win-builder.r-project.org/incoming_pretest/geotopbricks_1.5.9.1_20250413_174815/
>
The files will be removed after roughly 7 days.

No strong reverse dependencies to be checked.

Best regards,
CRAN teams' auto-check service
Flavor: r-devel-windows-x86_64
Check: *, Result: OK


Flavor: r-devel-linux-x86_64-debian-gcc
Check: examples, Result: NOTE
  Examples with CPU (user + system) or elapsed time > 5s
                                  user system elapsed
  get.geotop.inpts.keyword.value 1.406  0.027   5.326

        [[alternative HTML version deleted]]

______________________________________________
R-package-devel at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-package-devel
[https://www.ages.at/fileadmin/Signatur/03_AGES_Mailsignatur2025_Zeichenflaeche_1-04.png]<https://www.ages.at/ages/one-health/one-health>

________________________________



Firma & Rechtsform: ?sterreichische Agentur f?r Gesundheit und Ern?hrungssicherheit GmbH

Sitz: Spargelfeldstra?e 191, 1220 Wien

Firmenbuchnummer: FN 223056z

Firmenbuchgericht: Handelsgericht Wien

Diese Nachricht und allf?llige angeh?ngte Dokumente sind vertraulich und nur f?r den/die Adressaten bestimmt. Sollten Sie nicht der beabsichtigte Adressat sein, ist jede Offenlegung, Weiterleitung oder sonstige Verwendung dieser Information nicht gestattet. In diesem Fall bitten wir, den Absender zu verst?ndigen und die Information zu vernichten. F?r ?bermittlungsfehler oder sonstige Irrt?mer bei ?bermittlung besteht keine Haftung.

Unsere Datenschutzerkl?rung finden Sie unter: Datenschutzerkl?rung<https://www.ages.at/datenschutzerklaerung>

This message and any attached files are confidential and intended solely for the addressee(s). Any publication, transmission or other use of the information by a person or entity other than the intended addressee is prohibited. If you receive this in error please contact the sender and delete the material. The sender does not accept liability for any errors or omissions as a result of the transmission.

You can find our privacy policy at: privacy policy<https://www.ages.at/en/privacy>


From ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de  Thu Apr 17 09:44:51 2025
From: ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de (Uwe Ligges)
Date: Thu, 17 Apr 2025 09:44:51 +0200
Subject: [R-pkg-devel] [EXTERN] cran check about examples time
In-Reply-To: <VE1PR01MB56807EB8340E276B05CF2C6889BC2@VE1PR01MB5680.eurprd01.prod.exchangelabs.com>
References: <20250413154815.D51ECA019C@xmpalantir.wu.ac.at>
 <01dbac8d$Blat.v3.2.24$1fe6c315$2606c31f4@mail.statistik.tu-dortmund.de>
 <CAKw81f-M=RyFY5iaUh_r7nTkMRe7b4pRFByxqo43jP7xLe7VTw@mail.gmail.com>
 <VE1PR01MB56807EB8340E276B05CF2C6889BC2@VE1PR01MB5680.eurprd01.prod.exchangelabs.com>
Message-ID: <dcdbf1c4-f4ad-41e7-92dc-d47f0ab09f96@statistik.tu-dortmund.de>

Or set a web timeout and if not downloaded succesfully not run the code 
(i.e. condiationalize).

Best,
Uwe Ligges


On 17.04.2025 09:27, Fellinger Tobias wrote:
> Dear Emanuele,
> 
> I checked one of the Notes. One of the examples of get.geotop.inpts.keyword.value that throws a NOTE has parts outside of donttest that seem to load data from an url which can lead to varying execution times depending on the server. Moreover the url seems not to work. (https://raw.githubusercontent.com/ecor/geotopbricks_doc/master/simulations/panola13_run2xC_test3)
> 
> If you want to load the data from the web, I'd also put this in a donttest section.
> 
> An alternative would be (if this makes sense for the example) to include the file in the package and load it with system.file in the examples. This should run faster and more reliable and be independent of changes to URLs outside of the repository. Beware of maximum package sizes though.
> 
> (I checked this with the current default branch on github.)
> 
> Hope this helps, best regards, Tobias
> 
> -----Urspr?ngliche Nachricht-----
> Von: R-package-devel <r-package-devel-bounces at r-project.org> Im Auftrag von Emanuele Cordano
> Gesendet: Montag, 14. April 2025 08:54
> An: r-package-devel at r-project.org
> Betreff: [EXTERN] [R-pkg-devel] cran check about examples time
> 
> [You don't often get email from emanuele.cordano at gmail.com. Learn why this is important at https://aka.ms/LearnAboutSenderIdentification ]
> 
> Dear list,
> 
> I'm submitting the following package. CRAN check were OK (frorr Windows)
> whereas in Debian a function example elapses   5.326 seconds.  I need to
> fix this. Most lines in the examples are within \donttest{} brackets, so they should not be executed by CRAN checks. The examples are useful to understand the functions, as they are, should I include all examples lines in \donttest{} or \dontrun{} ?
> Do you have any suggestion or reference on this? CRAN message attached below.
> 
> Thank you
> Best
> Emanuele Cordano
> 
> CRAN message:
> 
> Dear maintainer,
> 
> package geotopbricks_1.5.9.1.tar.gz does not pass the incoming checks automatically, please see the following pre-tests (additional issue checks):
> Windows: <
> https://win-builder.r-project.org/incoming_pretest/geotopbricks_1.5.9.1_20250413_174815/Windows/00check.log
>>
> Status: OK
> Debian: <
> https://win-builder.r-project.org/incoming_pretest/geotopbricks_1.5.9.1_20250413_174815/Debian/00check.log
>>
> Status: 1 NOTE
> 
> Last released version's CRAN status: OK: 9, NOTE: 5
> See: <https://cran.r-project.org/web/checks/check_results_geotopbricks.html>
> 
> CRAN Web: <https://cran.r-project.org/package=geotopbricks>
> 
> Please fix all problems and resubmit a fixed version via the webform.
> If you are not sure how to fix the problems shown, please ask for help on the R-package-devel mailing list:
> <https://stat.ethz.ch/mailman/listinfo/r-package-devel>
> If you are fairly certain the rejection is a false positive, please reply-all to this message and explain.
> 
> More details are given in the directory:
> <
> https://win-builder.r-project.org/incoming_pretest/geotopbricks_1.5.9.1_20250413_174815/
>>
> The files will be removed after roughly 7 days.
> 
> No strong reverse dependencies to be checked.
> 
> Best regards,
> CRAN teams' auto-check service
> Flavor: r-devel-windows-x86_64
> Check: *, Result: OK
> 
> 
> Flavor: r-devel-linux-x86_64-debian-gcc
> Check: examples, Result: NOTE
>    Examples with CPU (user + system) or elapsed time > 5s
>                                    user system elapsed
>    get.geotop.inpts.keyword.value 1.406  0.027   5.326
> 
>          [[alternative HTML version deleted]]
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
> [https://www.ages.at/fileadmin/Signatur/03_AGES_Mailsignatur2025_Zeichenflaeche_1-04.png]<https://www.ages.at/ages/one-health/one-health>
> 
> ________________________________
> 
> 
> 
> Firma & Rechtsform: ?sterreichische Agentur f?r Gesundheit und Ern?hrungssicherheit GmbH
> 
> Sitz: Spargelfeldstra?e 191, 1220 Wien
> 
> Firmenbuchnummer: FN 223056z
> 
> Firmenbuchgericht: Handelsgericht Wien
> 
> Diese Nachricht und allf?llige angeh?ngte Dokumente sind vertraulich und nur f?r den/die Adressaten bestimmt. Sollten Sie nicht der beabsichtigte Adressat sein, ist jede Offenlegung, Weiterleitung oder sonstige Verwendung dieser Information nicht gestattet. In diesem Fall bitten wir, den Absender zu verst?ndigen und die Information zu vernichten. F?r ?bermittlungsfehler oder sonstige Irrt?mer bei ?bermittlung besteht keine Haftung.
> 
> Unsere Datenschutzerkl?rung finden Sie unter: Datenschutzerkl?rung<https://www.ages.at/datenschutzerklaerung>
> 
> This message and any attached files are confidential and intended solely for the addressee(s). Any publication, transmission or other use of the information by a person or entity other than the intended addressee is prohibited. If you receive this in error please contact the sender and delete the material. The sender does not accept liability for any errors or omissions as a result of the transmission.
> 
> You can find our privacy policy at: privacy policy<https://www.ages.at/en/privacy>
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From tony_@_w||ke@ @end|ng |rom out|ook@com  Thu Apr 24 14:36:57 2025
From: tony_@_w||ke@ @end|ng |rom out|ook@com (Tony Wilkes)
Date: Thu, 24 Apr 2025 12:36:57 +0000
Subject: [R-pkg-devel] Check if any object pointing to a given address is
 locked
Message-ID: <AS4P195MB1430136E16DEA56418F69FCEBE852@AS4P195MB1430.EURP195.PROD.OUTLOOK.COM>

Hi everyone,

I have a question.

Given the address of an object ("address" in the sense given by, for example, "data.table::address()"), is it possible to check if any binding in any environment pointing to that address is locked?
So a function similar to "bindingIsLocked()", except the function checks all bindings sharing the same address, instead of checking a binding by name in a specific environment.

One use-case for this is to check if it's save to modify an object by reference.
For example, when saying x <- base::letters, x is not save to modify by reference:
Although the binding of x itself is not locked, the binding of base::letters is locked, and we obviously don't want to modify base::letters.

It should be possible, I think. R has a few pass-by-reference classes (like environments), so R should be able to check something like this. I just have no idea how exactly R checks this.

Thanks in advance for any response!

Kind regards,

Tony



	[[alternative HTML version deleted]]


From |kry|ov @end|ng |rom d|@root@org  Thu Apr 24 15:28:16 2025
From: |kry|ov @end|ng |rom d|@root@org (Ivan Krylov)
Date: Thu, 24 Apr 2025 16:28:16 +0300
Subject: [R-pkg-devel] 
 Check if any object pointing to a given address is locked
In-Reply-To: <AS4P195MB1430136E16DEA56418F69FCEBE852@AS4P195MB1430.EURP195.PROD.OUTLOOK.COM>
References: <AS4P195MB1430136E16DEA56418F69FCEBE852@AS4P195MB1430.EURP195.PROD.OUTLOOK.COM>
Message-ID: <20250424162816.43ce256c@arachnoid>

? Thu, 24 Apr 2025 12:36:57 +0000
Tony Wilkes <tony_a_wilkes at outlook.com> ?????:

> One use-case for this is to check if it's save to modify an object by
> reference.

I think you might need NOT_SHARED() for that, except it's far from
being simple, especially once you pass arbitrary expressions (not just
variable names) as arguments to your function:
https://developer.r-project.org/Refcnt.html

> For example, when saying x <- base::letters, x is not save
> to modify by reference: Although the binding of x itself is not
> locked, the binding of base::letters is locked, and we obviously
> don't want to modify base::letters.

The situation is more dangerous than that. When 'x' references the same
object as base::letters (which is a locked binding), you can still
modify this object from C code, given its SEXP address, and see the
changes from either binding; R won't be able to stop you. (That's the
danger of by-reference operations like those implemented in data.table.)

On the other hand, if you assign a new value to the 'x' binding inside
a given environment, base::letters and any other objects referencing it
will retain their original values; there is no need to worry about
other bindings being locked.

> R has a few pass-by-reference classes (like environments)

These are different. You can lock a _binding_ to an environment and
still change the _value_ of that environment precisely because it's a
mutable, pass-by-reference object:

x <- new.env()
y <- x
lockBinding('x', environment())
# x$foo <- 'bar' # would signal an error, but:
assign('foo', 'bar', envir = x) # works
x$foo # [1] "bar"
identical(x, y) # [1] TRUE

R switched to reference counting by default in version 4.0. One
downside of the reference counts as currently implemented is that when
an object containing references to other objects is garbage-collected,
the reference counts of the child objects are not decremented:

x <- 1
invisible(replicate(999, list(x)))
gc(full = TRUE)
.Internal(inspect(x))
# @5618cd515488 14 REALSXP g1c1 [MARK,REF(2000)] (len=1, tl=0) 1

'x' retains a reference count of 2000 despite the 999 lists that
previously referenced it no longer exist. This is possible to change,
but at the cost of slowing down the garbage collector.

-- 
Best regards,
Ivan


From tom@@@k@||ber@ @end|ng |rom gm@||@com  Thu Apr 24 16:38:13 2025
From: tom@@@k@||ber@ @end|ng |rom gm@||@com (Tomas Kalibera)
Date: Thu, 24 Apr 2025 16:38:13 +0200
Subject: [R-pkg-devel] 
 Check if any object pointing to a given address is locked
In-Reply-To: <AS4P195MB1430136E16DEA56418F69FCEBE852@AS4P195MB1430.EURP195.PROD.OUTLOOK.COM>
References: <AS4P195MB1430136E16DEA56418F69FCEBE852@AS4P195MB1430.EURP195.PROD.OUTLOOK.COM>
Message-ID: <df6fe1ad-b835-48e2-8d76-af3bdeca8c09@gmail.com>


On 4/24/25 14:36, Tony Wilkes wrote:
> Hi everyone,
>
> I have a question.
>
> Given the address of an object ("address" in the sense given by, for example, "data.table::address()"), is it possible to check if any binding in any environment pointing to that address is locked?
> So a function similar to "bindingIsLocked()", except the function checks all bindings sharing the same address, instead of checking a binding by name in a specific environment.
>
> One use-case for this is to check if it's save to modify an object by reference.
> For example, when saying x <- base::letters, x is not save to modify by reference:
> Although the binding of x itself is not locked, the binding of base::letters is locked, and we obviously don't want to modify base::letters.

The question seems to be mixing R-level abstractions with the underlying 
C-level abstractions. To answer whether one can modify a C-level R 
objects (an SEXP) in place or not, one should think in C-level R API 
abstractions. One can modify an R object (SEXP x) in place when 
NO_REFERENCES(x) is true.

If this doesn't answer your question, please try to clarify it, explain 
what is the problem you are trying to solve.

Best
Tomas

> It should be possible, I think. R has a few pass-by-reference classes (like environments), so R should be able to check something like this. I just have no idea how exactly R checks this.
>
> Thanks in advance for any response!
>
> Kind regards,
>
> Tony
>
>
>
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From t|m@t@y|or @end|ng |rom h|ddene|eph@nt@@co@uk  Wed Apr 30 10:25:51 2025
From: t|m@t@y|or @end|ng |rom h|ddene|eph@nt@@co@uk (Tim Taylor)
Date: Wed, 30 Apr 2025 09:25:51 +0100
Subject: [R-pkg-devel] Use of long double in configuration
Message-ID: <bc2d2752-547e-4b4d-ba53-86a66816d64c@app.fastmail.com>

Is it correct to say that R's conditional use of long double is around ensuring things work on platforms which have 'long double' identical to 'double' types, as opposed to there being an odd compiler targeted that does not even have any concept of 'long double' type?

As background this was motivated by a query raised in the matrixStats package:
https://github.com/HenrikBengtsson/matrixStats/issues/278


From ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de  Wed Apr 30 10:33:42 2025
From: ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de (Uwe Ligges)
Date: Wed, 30 Apr 2025 10:33:42 +0200
Subject: [R-pkg-devel] Use of long double in configuration
In-Reply-To: <bc2d2752-547e-4b4d-ba53-86a66816d64c@app.fastmail.com>
References: <bc2d2752-547e-4b4d-ba53-86a66816d64c@app.fastmail.com>
Message-ID: <e61ec7a1-4a15-475a-a0c0-624c0512fa1d@statistik.tu-dortmund.de>



On 30.04.2025 10:25, Tim Taylor wrote:
> Is it correct to say that R's conditional use of long double is around ensuring things work on platforms which have 'long double' identical to 'double' types, as opposed to there being an odd compiler targeted that does not even have any concept of 'long double' type?

a double is 64 bit and stored that way on all platforms, the concept of 
long doubles is CPU specific. x86 chips have 80bit in the floating point 
units for calculations before rounding (and normalizing) to a regular 
double.

Some chips, e.g. those ARM chips used in current M[123]Macs (hence very 
relevant topic), do not support long doubles. And compilers offer to 
compile without support for long doubles which e.g. CRAN uses to check 
in an additional (issues) check.

Best,
Uwe Ligges

> 
> As background this was motivated by a query raised in the matrixStats package:
> https://github.com/HenrikBengtsson/matrixStats/issues/278
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From @|mon@urb@nek @end|ng |rom R-project@org  Wed Apr 30 10:40:17 2025
From: @|mon@urb@nek @end|ng |rom R-project@org (Simon Urbanek)
Date: Wed, 30 Apr 2025 20:40:17 +1200
Subject: [R-pkg-devel] Use of long double in configuration
In-Reply-To: <bc2d2752-547e-4b4d-ba53-86a66816d64c@app.fastmail.com>
References: <bc2d2752-547e-4b4d-ba53-86a66816d64c@app.fastmail.com>
Message-ID: <B1E9136F-25A7-404B-9EE4-8FE2317DCC48@R-project.org>

Tim,

no, and as far as I can tell some of the claims in that thread are incorrect. Whether long double is identical to double is irrelevant and has nothing to do with it.

R has a configuration option --enable-long-double which governs whether R should use algorithms which can benefit from extended precision where applicable. However, that is entirely internal to R and has nothing to do with packages, it just changes algorithms used in R itself.

It is definitely a bug in matrixStats to assume that HAVE_LONG_DOUBLE  of LDOUBLE are somehow defined as they are not unless matrixStats does so.

Cheers,
Simon



> On Apr 30, 2025, at 8:25 PM, Tim Taylor <tim.taylor at hiddenelephants.co.uk> wrote:
> 
> Is it correct to say that R's conditional use of long double is around ensuring things work on platforms which have 'long double' identical to 'double' types, as opposed to there being an odd compiler targeted that does not even have any concept of 'long double' type?
> 
> As background this was motivated by a query raised in the matrixStats package:
> https://github.com/HenrikBengtsson/matrixStats/issues/278
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
> 


From t|m@t@y|or @end|ng |rom h|ddene|eph@nt@@co@uk  Wed Apr 30 10:43:24 2025
From: t|m@t@y|or @end|ng |rom h|ddene|eph@nt@@co@uk (Tim Taylor)
Date: Wed, 30 Apr 2025 09:43:24 +0100
Subject: [R-pkg-devel] Use of long double in configuration
In-Reply-To: <e61ec7a1-4a15-475a-a0c0-624c0512fa1d@statistik.tu-dortmund.de>
References: <bc2d2752-547e-4b4d-ba53-86a66816d64c@app.fastmail.com>
 <e61ec7a1-4a15-475a-a0c0-624c0512fa1d@statistik.tu-dortmund.de>
Message-ID: <4e0f4a5a-b2a6-4cdf-9918-067f52dc225f@app.fastmail.com>

Cheers for the quick response.

To clarify my question: Is it correct to say that as long as packages do not assume the greater precision provided by 'double' there is no reason they cannot use 'long double' to get *possible* advantages (e.g. in summations). AFAICT 'long double' is (and has always been) part of the C standard so it's use as a type should be unproblematic (this is the query relevant to matrixStats).

Apologies if this does not make much sense.

Tim



On Wed, 30 Apr 2025, at 9:33 AM, Uwe Ligges wrote:
> On 30.04.2025 10:25, Tim Taylor wrote:
>> Is it correct to say that R's conditional use of long double is around ensuring things work on platforms which have 'long double' identical to 'double' types, as opposed to there being an odd compiler targeted that does not even have any concept of 'long double' type?
>
> a double is 64 bit and stored that way on all platforms, the concept of 
> long doubles is CPU specific. x86 chips have 80bit in the floating point 
> units for calculations before rounding (and normalizing) to a regular 
> double.
>
> Some chips, e.g. those ARM chips used in current M[123]Macs (hence very 
> relevant topic), do not support long doubles. And compilers offer to 
> compile without support for long doubles which e.g. CRAN uses to check 
> in an additional (issues) check.
>
> Best,
> Uwe Ligges
>
>> 
>> As background this was motivated by a query raised in the matrixStats package:
>> https://github.com/HenrikBengtsson/matrixStats/issues/278
>> 
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>
>
> Attachments:
> * smime.p7s


From tom@@@k@||ber@ @end|ng |rom gm@||@com  Wed Apr 30 11:07:17 2025
From: tom@@@k@||ber@ @end|ng |rom gm@||@com (Tomas Kalibera)
Date: Wed, 30 Apr 2025 11:07:17 +0200
Subject: [R-pkg-devel] Use of long double in configuration
In-Reply-To: <4e0f4a5a-b2a6-4cdf-9918-067f52dc225f@app.fastmail.com>
References: <bc2d2752-547e-4b4d-ba53-86a66816d64c@app.fastmail.com>
 <e61ec7a1-4a15-475a-a0c0-624c0512fa1d@statistik.tu-dortmund.de>
 <4e0f4a5a-b2a6-4cdf-9918-067f52dc225f@app.fastmail.com>
Message-ID: <14a5bf54-f860-460b-a6c6-8be9d1905984@gmail.com>


On 4/30/25 10:43, Tim Taylor wrote:
> Cheers for the quick response.
>
> To clarify my question: Is it correct to say that as long as packages do not assume the greater precision provided by 'double' there is no reason they cannot use 'long double' to get *possible* advantages (e.g. in summations). AFAICT 'long double' is (and has always been) part of the C standard so it's use as a type should be unproblematic (this is the query relevant to matrixStats).

Probably already clear from previous answers, but yes, packages can use 
long double type.

Whenever using a long double type, one needs to be careful about making 
sure the algorithms work, and the tests pass (so have reasonable 
tolerances), even when the long double type happens to be just the same 
as double. This is the case on aarch64, and macOS/aarch64 is one of the 
platforms where packages have to work, anyway, so this shouldn't be too 
limiting anymore - but really one needs to test on such platform.

R itself has an option to disable use of long double to make such 
testing in R itself possible also on other platforms. In principle one 
could do something similar in a package, have some ifdefs to disable 
long doubles, but this is not required. And I probably wouldn't do that, 
I'd just test on aarch64 regularly.

See Writing R Extensions for more details.

Best
Tomas

> Apologies if this does not make much sense.
>
> Tim
>
>
>
> On Wed, 30 Apr 2025, at 9:33 AM, Uwe Ligges wrote:
>> On 30.04.2025 10:25, Tim Taylor wrote:
>>> Is it correct to say that R's conditional use of long double is around ensuring things work on platforms which have 'long double' identical to 'double' types, as opposed to there being an odd compiler targeted that does not even have any concept of 'long double' type?
>> a double is 64 bit and stored that way on all platforms, the concept of
>> long doubles is CPU specific. x86 chips have 80bit in the floating point
>> units for calculations before rounding (and normalizing) to a regular
>> double.
>>
>> Some chips, e.g. those ARM chips used in current M[123]Macs (hence very
>> relevant topic), do not support long doubles. And compilers offer to
>> compile without support for long doubles which e.g. CRAN uses to check
>> in an additional (issues) check.
>>
>> Best,
>> Uwe Ligges
>>
>>> As background this was motivated by a query raised in the matrixStats package:
>>> https://github.com/HenrikBengtsson/matrixStats/issues/278
>>>
>>> ______________________________________________
>>> R-package-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>
>> Attachments:
>> * smime.p7s
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From t|m@t@y|or @end|ng |rom h|ddene|eph@nt@@co@uk  Wed Apr 30 11:08:54 2025
From: t|m@t@y|or @end|ng |rom h|ddene|eph@nt@@co@uk (Tim Taylor)
Date: Wed, 30 Apr 2025 10:08:54 +0100
Subject: [R-pkg-devel] Use of long double in configuration
In-Reply-To: <14a5bf54-f860-460b-a6c6-8be9d1905984@gmail.com>
References: <bc2d2752-547e-4b4d-ba53-86a66816d64c@app.fastmail.com>
 <e61ec7a1-4a15-475a-a0c0-624c0512fa1d@statistik.tu-dortmund.de>
 <4e0f4a5a-b2a6-4cdf-9918-067f52dc225f@app.fastmail.com>
 <14a5bf54-f860-460b-a6c6-8be9d1905984@gmail.com>
Message-ID: <d3c4ea69-d835-45b3-ba39-1b5a950fcc29@app.fastmail.com>

Thank you all!

Everything is clear.

Tim

On Wed, 30 Apr 2025, at 10:07 AM, Tomas Kalibera wrote:
> On 4/30/25 10:43, Tim Taylor wrote:
>> Cheers for the quick response.
>>
>> To clarify my question: Is it correct to say that as long as packages do not assume the greater precision provided by 'double' there is no reason they cannot use 'long double' to get *possible* advantages (e.g. in summations). AFAICT 'long double' is (and has always been) part of the C standard so it's use as a type should be unproblematic (this is the query relevant to matrixStats).
>
> Probably already clear from previous answers, but yes, packages can use 
> long double type.
>
> Whenever using a long double type, one needs to be careful about making 
> sure the algorithms work, and the tests pass (so have reasonable 
> tolerances), even when the long double type happens to be just the same 
> as double. This is the case on aarch64, and macOS/aarch64 is one of the 
> platforms where packages have to work, anyway, so this shouldn't be too 
> limiting anymore - but really one needs to test on such platform.
>
> R itself has an option to disable use of long double to make such 
> testing in R itself possible also on other platforms. In principle one 
> could do something similar in a package, have some ifdefs to disable 
> long doubles, but this is not required. And I probably wouldn't do that, 
> I'd just test on aarch64 regularly.
>
> See Writing R Extensions for more details.
>
> Best
> Tomas
>
>> Apologies if this does not make much sense.
>>
>> Tim
>>
>>
>>
>> On Wed, 30 Apr 2025, at 9:33 AM, Uwe Ligges wrote:
>>> On 30.04.2025 10:25, Tim Taylor wrote:
>>>> Is it correct to say that R's conditional use of long double is around ensuring things work on platforms which have 'long double' identical to 'double' types, as opposed to there being an odd compiler targeted that does not even have any concept of 'long double' type?
>>> a double is 64 bit and stored that way on all platforms, the concept of
>>> long doubles is CPU specific. x86 chips have 80bit in the floating point
>>> units for calculations before rounding (and normalizing) to a regular
>>> double.
>>>
>>> Some chips, e.g. those ARM chips used in current M[123]Macs (hence very
>>> relevant topic), do not support long doubles. And compilers offer to
>>> compile without support for long doubles which e.g. CRAN uses to check
>>> in an additional (issues) check.
>>>
>>> Best,
>>> Uwe Ligges
>>>
>>>> As background this was motivated by a query raised in the matrixStats package:
>>>> https://github.com/HenrikBengtsson/matrixStats/issues/278
>>>>
>>>> ______________________________________________
>>>> R-package-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>
>>> Attachments:
>>> * smime.p7s
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From pro|jcn@@h @end|ng |rom gm@||@com  Wed Apr 30 12:29:43 2025
From: pro|jcn@@h @end|ng |rom gm@||@com (J C Nash)
Date: Wed, 30 Apr 2025 06:29:43 -0400
Subject: [R-pkg-devel] Use of long double in configuration
In-Reply-To: <d3c4ea69-d835-45b3-ba39-1b5a950fcc29@app.fastmail.com>
References: <bc2d2752-547e-4b4d-ba53-86a66816d64c@app.fastmail.com>
 <e61ec7a1-4a15-475a-a0c0-624c0512fa1d@statistik.tu-dortmund.de>
 <4e0f4a5a-b2a6-4cdf-9918-067f52dc225f@app.fastmail.com>
 <14a5bf54-f860-460b-a6c6-8be9d1905984@gmail.com>
 <d3c4ea69-d835-45b3-ba39-1b5a950fcc29@app.fastmail.com>
Message-ID: <8799192b-315b-423c-8e83-9d9412b48aa6@gmail.com>

As one of original 30-some members of 1985 IEEE 754, I find it discouraging that
we are treating long-double as the exception, when it is the introduction of
"short double" in M1 etc chips that have forced the issue. There are strong
commercial reasons, but they aren't computational ones.

JN


On 2025-04-30 05:08, Tim Taylor wrote:
> Thank you all!
> 
> Everything is clear.
> 
> Tim
> 
> On Wed, 30 Apr 2025, at 10:07 AM, Tomas Kalibera wrote:
>> On 4/30/25 10:43, Tim Taylor wrote:
>>> Cheers for the quick response.
>>>
>>> To clarify my question: Is it correct to say that as long as packages do not assume the greater precision provided by 'double' there is no reason they cannot use 'long double' to get *possible* advantages (e.g. in summations). AFAICT 'long double' is (and has always been) part of the C standard so it's use as a type should be unproblematic (this is the query relevant to matrixStats).
>>
>> Probably already clear from previous answers, but yes, packages can use
>> long double type.
>>
>> Whenever using a long double type, one needs to be careful about making
>> sure the algorithms work, and the tests pass (so have reasonable
>> tolerances), even when the long double type happens to be just the same
>> as double. This is the case on aarch64, and macOS/aarch64 is one of the
>> platforms where packages have to work, anyway, so this shouldn't be too
>> limiting anymore - but really one needs to test on such platform.
>>
>> R itself has an option to disable use of long double to make such
>> testing in R itself possible also on other platforms. In principle one
>> could do something similar in a package, have some ifdefs to disable
>> long doubles, but this is not required. And I probably wouldn't do that,
>> I'd just test on aarch64 regularly.
>>
>> See Writing R Extensions for more details.
>>
>> Best
>> Tomas
>>
>>> Apologies if this does not make much sense.
>>>
>>> Tim
>>>
>>>
>>>
>>> On Wed, 30 Apr 2025, at 9:33 AM, Uwe Ligges wrote:
>>>> On 30.04.2025 10:25, Tim Taylor wrote:
>>>>> Is it correct to say that R's conditional use of long double is around ensuring things work on platforms which have 'long double' identical to 'double' types, as opposed to there being an odd compiler targeted that does not even have any concept of 'long double' type?
>>>> a double is 64 bit and stored that way on all platforms, the concept of
>>>> long doubles is CPU specific. x86 chips have 80bit in the floating point
>>>> units for calculations before rounding (and normalizing) to a regular
>>>> double.
>>>>
>>>> Some chips, e.g. those ARM chips used in current M[123]Macs (hence very
>>>> relevant topic), do not support long doubles. And compilers offer to
>>>> compile without support for long doubles which e.g. CRAN uses to check
>>>> in an additional (issues) check.
>>>>
>>>> Best,
>>>> Uwe Ligges
>>>>
>>>>> As background this was motivated by a query raised in the matrixStats package:
>>>>> https://github.com/HenrikBengtsson/matrixStats/issues/278
>>>>>
>>>>> ______________________________________________
>>>>> R-package-devel at r-project.org mailing list
>>>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>>
>>>> Attachments:
>>>> * smime.p7s
>>> ______________________________________________
>>> R-package-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From N||@@Lue@chow @end|ng |rom un|-due@@e|dor|@de  Tue Apr 29 14:43:40 2025
From: N||@@Lue@chow @end|ng |rom un|-due@@e|dor|@de (=?UTF-8?Q?Nils_L=C3=BCschow?=)
Date: Tue, 29 Apr 2025 14:43:40 +0200
Subject: [R-pkg-devel] Problem building package depending on third party c++
 source library.
Message-ID: <ed3ae707af8e1af36f51e73581ee14af@uni-duesseldorf.de>

Hello everybody,

as a new feature for the anticlust package 
(https://cran.r-project.org/web/packages/anticlust/index.html) we are 
trying to include a constraint programming model, written in C++ 
utilizing the Gecode solver. While we generally got this feature to work 
when Gecode is pre-installed on the system, we would like to spare the 
users this step and include it with the package (or inside a 
supplementary package) to install through the regular R tooling. 
However, we run into a problem when it comes to compiling Gecode during 
the packages build-process, which I describe in this SO post:

https://stackoverflow.com/questions/79596214/configure-script-does-not-generate-makefile-properly-for-3rd-party-library-used

I strongly suspect the Makevars file to be incorrect, if you want to 
take a look or try to compile it yourself, I have uploaded the code of 
the new feature as well as the source files of the Gecode library to 
GitHub:

https://github.com/nilslueschow/Anticlust-Dispersion-Constraint-Model/tree/main/RcppTestPackage/src

Thanks for your help!

Best,
Nils L?schow


From @ergue|@@oko| @end|ng |rom gm@||@com  Wed Apr 30 15:31:37 2025
From: @ergue|@@oko| @end|ng |rom gm@||@com (Serguei Sokol)
Date: Wed, 30 Apr 2025 15:31:37 +0200
Subject: [R-pkg-devel] 
 Problem building package depending on third party c++
 source library.
In-Reply-To: <ed3ae707af8e1af36f51e73581ee14af@uni-duesseldorf.de>
References: <ed3ae707af8e1af36f51e73581ee14af@uni-duesseldorf.de>
Message-ID: <d0ec2d12-2dfb-4b13-9ff4-cae945ad4726@gmail.com>

Le 29/04/2025 ? 14:43, Nils L?schow a ?crit?:
> Hello everybody,
> 
> as a new feature for the anticlust package (https://cran.r-project.org/ 
> web/packages/anticlust/index.html) we are trying to include a constraint 
> programming model, written in C++ utilizing the Gecode solver. While we 
> generally got this feature to work when Gecode is pre-installed on the 
> system, we would like to spare the users this step and include it with 
> the package (or inside a supplementary package) to install through the 
> regular R tooling. However, we run into a problem when it comes to 
> compiling Gecode during the packages build-process, which I describe in 
> this SO post:
> 
> https://stackoverflow.com/questions/79596214/configure-script-does-not- 
> generate-makefile-properly-for-3rd-party-library-used
> 
> I strongly suspect the Makevars file to be incorrect, if you want to 
> take a look or try to compile it yourself, I have uploaded the code of 
> the new feature as well as the source files of the Gecode library to 
> GitHub:
> 
> https://github.com/nilslueschow/Anticlust-Dispersion-Constraint-Model/ 
> tree/main/RcppTestPackage/src
I don't know if it is the source of your problem but it's safer to use 
CC and CXX variables provided by R building process (they are already 
predefined when you are in Makevars) which minimize the risks of 
incompatibility between R and your library. So instead of

cd $(GECODE_DIR) && $(MAKE)

I'd use something like

$(MAKE) -C $(GECODE_DIR) CC="$(CC)" CXX="$(CXX)" CXXFLAGS="$(CXXFLAGS)"

Best,
Serguei.

> 
> Thanks for your help!
> 
> Best,
> Nils L?schow
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From |kry|ov @end|ng |rom d|@root@org  Wed Apr 30 20:57:41 2025
From: |kry|ov @end|ng |rom d|@root@org (Ivan Krylov)
Date: Wed, 30 Apr 2025 21:57:41 +0300
Subject: [R-pkg-devel] 
 Problem building package depending on third party c++
 source library.
In-Reply-To: <ed3ae707af8e1af36f51e73581ee14af@uni-duesseldorf.de>
References: <ed3ae707af8e1af36f51e73581ee14af@uni-duesseldorf.de>
Message-ID: <20250430215741.445338cd@Tarkus>

? Tue, 29 Apr 2025 14:43:40 +0200
Nils L?schow <Nils.Lueschow at uni-duesseldorf.de> ?????:

> While we generally got this feature to work when Gecode is
> pre-installed on the system, we would like to spare the users this
> step and include it with the package

It's probably a good idea to try to achieve both. If a system copy of
the package is available, link with it; otherwise build the bundled
copy. Unfortunately, this kind of user convenience involves a lot of
testing to make sure that both configurations work as intended.
Bundling dependencies also creates headaches for distro packagers.

> However, we run into a problem when it comes to compiling Gecode
> during the packages build-process, which I describe in this SO post

One problem is that when using $(MAKE) to compile gecode, various
variables used by gecode's Makefile are overridden through the
MAKEFLAGS variable. For example, $(CXX) ends up being defined as
$(CXX20) $(CXX20STD) without the variables CXX20 and CXX20STD being
available to the downstream Make process. What's worse is CXXFLAGS are
also overridden, losing the include paths in the process.

In order to build gecode from Makevars, you'll have to disable these
overrides by emptying MAKEFLAGS:

build_gecode:
        cd $(GECODE_DIR) && \
	./configure CC="$(CC)" CXX="$(CXX20) $(CXX20STD)" \
		--disable-examples --enable-static --disable-shared
	$(MAKE) -C $(GECODE_DIR) MAKEFLAGS=

(Alternatively, you can ./configure and build the library from the
./configure script of your package.)

Other changes are also needed to make the package build in a portable
manner:

 - Recipe lines in Makefiles must start with tabs, not groups of
   four spaces.
 - Don't use GNU Make append syntax (+=) without declaring
   SystemRequirements: GNU Make.
 - Don't set compiler-specific flags such as -mtune=native without at
   least testing that the compiler understands them.
 - With the current directory structure, GECODE_DIR must be just
   gecode, not $(CURDIR)/gecode-release-6.3.0.
 - Since the C++ source code already uses #include <gecode/...>, the
   include path must be -I$(GECODE_DIR), not -I$(GECODE_DIR)/gecode.
 - Don't hard-code compiler names. Instead of ./configure CC=gcc ...,
   use ./configure CC="$(CC)" CXX="$(CXX20) $(CXX20STD)".
 - Build gecode as a static library and link it into the package
   shared library. Otherwise you'll need to arrange for the gecode
   shared libraries to be installed together with the R package and
   properly loaded before your package shared library.
 - Provide a 'clean' target so that R CMD build doesn't include the
   binaries from the gecode subdirectory into the source package.

With that, we get the following Makevars:

all: $(SHLIB)

GECODE_DIR = gecode
PKG_CPPFLAGS = -I$(GECODE_DIR)
PKG_LIBS = -L$(GECODE_DIR) -lgecodesearch -lgecodeminimodel \
           -lgecodeint -lgecodekernel -lgecodesupport
CXX_STD = CXX20

$(SHLIB): gecode_built
# package code relies on header files only available after gecode is
# configured and probably built
$(OBJECTS): gecode_built

gecode_built:
	cd $(GECODE_DIR) && \
		./configure CC="$(CC)" CXX="$(CXX20) $(CXX20STD)" \
		--disable-examples --enable-static --disable-shared \
		--disable-flatzinc --disable-qt
	$(MAKE) -C $(GECODE_DIR) MAKEFLAGS=
	touch $@

clean:
	-cd $(GECODE_DIR) && make clean
	-rm -f gecode_built

Hopefully, the Makevars.win with same contents but
--with-host-os=windows added to the configure flags will work on
Windows. (It needs to be .win, not .ucrt, because your package declares
support for R > 3.6, which predates use of UCRT in R. To think of it,
R-3.6.0 also predates C++20...) You can probably give some more
--disable-... arguments to ./configure to remove some more components
that the R package doesn't use.

However, this is only the beginning of the troubles.

R packages are not allowed file path lengths above 100 bytes, and your
package has seven that are longer, e.g.,

>> RcppTestPackage/src/gecode/gecode/third-party/boost/numeric/interval/detail/x86gcc_rounding_control.hpp

Maybe you can unbundle the bits of Boost and rely on the 'BH' package
instead. Maybe there's a way to rename the files and patch the includes
in the source code.

The gecode library produces a lot of warnings, and R CMD check
considers some of them serious:

>> Found the following significant warnings:
>> ./gecode/kernel/core.hpp:4102:24: warning: array subscript -1 is
>> below array bounds of ?unsigned int [1]? [-Warray-bounds]
>> ./gecode/kernel/core.hpp:4109:17: warning: array subscript -1 is
>> below array bounds of ?unsigned int [1]? [-Warray-bounds]
>> ./gecode/support/allocator.hpp:88:11: warning: ?void free(void*)?
>> called on pointer returned from a mismatched allocation function
>> [-Wmismatched-new-delete]                 

The -Warray-bounds warnings might be false positives (could pc_max ever
be 0?), but -Wmismatched-new-delete is probably real; the compiler
shows a place where an object allocated using new(...) can be
deallocated using free(...).

Some parts of the gecode library contain references to std::cerr, and
the R package code calls rand(). These are not recommended in R
packages, because the standard error stream isn't necessarily connected
to the terminal and because rand() is disconnected from R's random
number generator.

Once you build the whole gecode yourself, be ready for it being tested
with AddressSanitizer and UndefinedBehaviorSanitizer. Things like
free(new(...)) that were previously invisible to them (due to the
third-party library being compiled without sanitizers) will now be
revealed (and become yours to fix instead of just something happening
upstream).

There are other problems noted by R CMD check, but they should be
easier to fix.

-- 
Best regards,
Ivan


From @m@||ep@||on @end|ng |rom proton@me  Fri May  2 02:21:50 2025
From: @m@||ep@||on @end|ng |rom proton@me (smallepsilon)
Date: Fri, 02 May 2025 00:21:50 +0000
Subject: [R-pkg-devel] advice for fixing MKL issues
Message-ID: <nUm987XUqdAVvDnpilVVweDdiYHbTCCECB4EAWdxKEvmnYNxcDdXRjqhpZCt-fWvEZeNdd1UrE0WyfM4KiAitODfwcusyR6oVbKOQQkGBp8=@proton.me>

I recently got an email from CRAN regarding MKL issues for an R package I submitted in November. Does anyone have any advice on fixing issues with MKL? I want to install it locally so I can test locally, instead of guessing at the problem and uploading to CRAN with the hope that I correctly identified the issues. I found an old post online (https://stackoverflow.com/questions/38090206/linking-intels-math-kernel-library-mkl-to-r-on-windows) with instructions for using MKL with R on Windows (which I am using), but these did not work for me. Any advice for what to try next?

Jesse
	[[alternative HTML version deleted]]


From tom@@@k@||ber@ @end|ng |rom gm@||@com  Fri May  2 09:54:57 2025
From: tom@@@k@||ber@ @end|ng |rom gm@||@com (Tomas Kalibera)
Date: Fri, 2 May 2025 09:54:57 +0200
Subject: [R-pkg-devel] advice for fixing MKL issues
In-Reply-To: <nUm987XUqdAVvDnpilVVweDdiYHbTCCECB4EAWdxKEvmnYNxcDdXRjqhpZCt-fWvEZeNdd1UrE0WyfM4KiAitODfwcusyR6oVbKOQQkGBp8=@proton.me>
References: <nUm987XUqdAVvDnpilVVweDdiYHbTCCECB4EAWdxKEvmnYNxcDdXRjqhpZCt-fWvEZeNdd1UrE0WyfM4KiAitODfwcusyR6oVbKOQQkGBp8=@proton.me>
Message-ID: <e79855b8-29a5-4124-92ae-ff11eab51c72@gmail.com>

I think it would be simplest to do this work on Linux. Getting a Linux 
installation/VM would probably be more staightforward than debugging the 
issues with MKL on Windows.

See "A.3.1.3 Intel MKL" in R Admin manual for more.

Best
Tomas

On 5/2/25 02:21, smallepsilon wrote:
> I recently got an email from CRAN regarding MKL issues for an R package I submitted in November. Does anyone have any advice on fixing issues with MKL? I want to install it locally so I can test locally, instead of guessing at the problem and uploading to CRAN with the hope that I correctly identified the issues. I found an old post online (https://stackoverflow.com/questions/38090206/linking-intels-math-kernel-library-mkl-to-r-on-windows) with instructions for using MKL with R on Windows (which I am using), but these did not work for me. Any advice for what to try next?
>
> Jesse
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From @|mon@urb@nek @end|ng |rom R-project@org  Mon May  5 01:25:06 2025
From: @|mon@urb@nek @end|ng |rom R-project@org (Simon Urbanek)
Date: Mon, 5 May 2025 11:25:06 +1200
Subject: [R-pkg-devel] Use of long double in configuration
In-Reply-To: <8799192b-315b-423c-8e83-9d9412b48aa6@gmail.com>
References: <bc2d2752-547e-4b4d-ba53-86a66816d64c@app.fastmail.com>
 <e61ec7a1-4a15-475a-a0c0-624c0512fa1d@statistik.tu-dortmund.de>
 <4e0f4a5a-b2a6-4cdf-9918-067f52dc225f@app.fastmail.com>
 <14a5bf54-f860-460b-a6c6-8be9d1905984@gmail.com>
 <d3c4ea69-d835-45b3-ba39-1b5a950fcc29@app.fastmail.com>
 <8799192b-315b-423c-8e83-9d9412b48aa6@gmail.com>
Message-ID: <1EE6948A-6F78-4306-8272-2AE79EB27282@R-project.org>

John,

it's sort of the other way around: because neither the implementation, format nor precision of "long double" are defined by the C standard (it's not even required to be based on IEEE 754/IEC 60559 at all), it is essentially left to the compilers+runtimes to do whatever they choose, making it a bit of a wild card. Historically, anything beyond double precision was emulated since most hardware was unable to natively deal with it, so that?s why you had to think hard if you wanted to use it as the penalty could be an order of magnitude or more. It wasn't until Intel?s math co-processor and its 80-bit extended precision format which reduced the penalty for such operations on that CPU and was mapped to long double - at the cost of results being hardware-specific, somewhat arbitrary and only 2.5x precision (while occupying 4x the space). So long double is just a simple way to say "do your best" without defining any specifics.

I?m not sure what you mean by "short double" as double precision is defined as 64-bit, so "short double" would be simply 32-bit = single precision. More recent introduction of varying floating point precisions such as fp8, f16 etc. (assuming that?s what you meant by "short double" on M1) are performance and memory usage optimizations for use-cases where the precision is less important than memory usage, such as in large NNs. M1 is just one of the modern chips that added co-processors specifically for matrix operations on different precisions like fp16, fp32, fp64 - with great performance gains (e.g., using AMX via Apple's BLAS/LAPACK with double precision in R on M1 is over 100x faster than the CPU-based reference version for some operations).

As for precision beyond doubles, Apple has asked few years ago the scientific community whether there is interest in fp128 (quad precision) and the response was no, it?s not a priority, so I would assume that?s why it has been left to emulations (it is interesting in retrospect, because at that point we had no idea that they were designing what became Apple Silicon). I presume it would be possible to leverage the Apple matrix co-processor for fp128 operations (e.g., PowerPC used double-double arithmetics implementation as a precedent), but given the low priority I have not seen it yet.

Cheers,
Simon


> On Apr 30, 2025, at 10:29 PM, J C Nash <profjcnash at gmail.com> wrote:
> 
> As one of original 30-some members of 1985 IEEE 754, I find it discouraging that we are treating long-double as the exception, when it is the introduction of "short double" in M1 etc chips that have forced the issue. There are strong commercial reasons, but they aren't computational ones.
> 
> JN
> 
> 
> On 2025-04-30 05:08, Tim Taylor wrote:
>> Thank you all!
>> Everything is clear.
>> Tim
>> On Wed, 30 Apr 2025, at 10:07 AM, Tomas Kalibera wrote:
>>> On 4/30/25 10:43, Tim Taylor wrote:
>>>> Cheers for the quick response.
>>>> 
>>>> To clarify my question: Is it correct to say that as long as packages do not assume the greater precision provided by 'double' there is no reason they cannot use 'long double' to get *possible* advantages (e.g. in summations). AFAICT 'long double' is (and has always been) part of the C standard so it's use as a type should be unproblematic (this is the query relevant to matrixStats).
>>> 
>>> Probably already clear from previous answers, but yes, packages can use
>>> long double type.
>>> 
>>> Whenever using a long double type, one needs to be careful about making
>>> sure the algorithms work, and the tests pass (so have reasonable
>>> tolerances), even when the long double type happens to be just the same
>>> as double. This is the case on aarch64, and macOS/aarch64 is one of the
>>> platforms where packages have to work, anyway, so this shouldn't be too
>>> limiting anymore - but really one needs to test on such platform.
>>> 
>>> R itself has an option to disable use of long double to make such
>>> testing in R itself possible also on other platforms. In principle one
>>> could do something similar in a package, have some ifdefs to disable
>>> long doubles, but this is not required. And I probably wouldn't do that,
>>> I'd just test on aarch64 regularly.
>>> 
>>> See Writing R Extensions for more details.
>>> 
>>> Best
>>> Tomas
>>> 
>>>> Apologies if this does not make much sense.
>>>> 
>>>> Tim
>>>> 
>>>> 
>>>> 
>>>> On Wed, 30 Apr 2025, at 9:33 AM, Uwe Ligges wrote:
>>>>> On 30.04.2025 10:25, Tim Taylor wrote:
>>>>>> Is it correct to say that R's conditional use of long double is around ensuring things work on platforms which have 'long double' identical to 'double' types, as opposed to there being an odd compiler targeted that does not even have any concept of 'long double' type?
>>>>> a double is 64 bit and stored that way on all platforms, the concept of
>>>>> long doubles is CPU specific. x86 chips have 80bit in the floating point
>>>>> units for calculations before rounding (and normalizing) to a regular
>>>>> double.
>>>>> 
>>>>> Some chips, e.g. those ARM chips used in current M[123]Macs (hence very
>>>>> relevant topic), do not support long doubles. And compilers offer to
>>>>> compile without support for long doubles which e.g. CRAN uses to check
>>>>> in an additional (issues) check.
>>>>> 
>>>>> Best,
>>>>> Uwe Ligges
>>>>> 
>>>>>> As background this was motivated by a query raised in the matrixStats package:
>>>>>> https://github.com/HenrikBengtsson/matrixStats/issues/278
>>>>>> 
>>>>>> ______________________________________________
>>>>>> R-package-devel at r-project.org mailing list
>>>>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>>> 
>>>>> Attachments:
>>>>> * smime.p7s
>>>> ______________________________________________
>>>> R-package-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
> 


From pro|jcn@@h @end|ng |rom gm@||@com  Mon May  5 03:23:25 2025
From: pro|jcn@@h @end|ng |rom gm@||@com (J C Nash)
Date: Sun, 4 May 2025 21:23:25 -0400
Subject: [R-pkg-devel] Use of long double in configuration
In-Reply-To: <1EE6948A-6F78-4306-8272-2AE79EB27282@R-project.org>
References: <bc2d2752-547e-4b4d-ba53-86a66816d64c@app.fastmail.com>
 <e61ec7a1-4a15-475a-a0c0-624c0512fa1d@statistik.tu-dortmund.de>
 <4e0f4a5a-b2a6-4cdf-9918-067f52dc225f@app.fastmail.com>
 <14a5bf54-f860-460b-a6c6-8be9d1905984@gmail.com>
 <d3c4ea69-d835-45b3-ba39-1b5a950fcc29@app.fastmail.com>
 <8799192b-315b-423c-8e83-9d9412b48aa6@gmail.com>
 <1EE6948A-6F78-4306-8272-2AE79EB27282@R-project.org>
Message-ID: <703303b3-0eff-42dd-b9bc-29181d3d3068@gmail.com>

By "short double" I simply meant the 64 bit double without the extended precision.
Wikipedia has a "long double" article, and is quite good in showing the diversity
of interpretations.

I've not spent much time looking at the standards since the 80s, except to note
the move to make the extended bits optional recently. As far as I am aware, any
precision above 64 bit storage but 80 bits in registers required special software
and hardware, but the 64/80 combination seemed to be more or less a given until
the M? chips came along.

For a while I recall there were all sorts of things with gate arrays to make
special hardware. They needed special compilers and were a nuisance to use.
Fortunately, not a great many computations require more than 64 bit doubles,
but there are some situations that need the extra precision for some of the time.
I remember Kahan saying it was like passing lanes added to two lane highways
to clear out the lines behind a slow truck.

The widespread adoption of IEEE 754 with the 80 bit extended was a great step
forward. For a while most hardware implemented it, but the M? chips don't
have registers, hence the push for changing the standard. It's a pity mechanical
calculators are no longer common, like the Monroe manual I gave away to a
charity last year. They had double width accumulator carriages for a reason,
and make the situation very obvious.

The burden for R developers is that a lot of the behind the screen computations
are done with pretty old codes that very likely were developed with extended
"thinking". Particularly if there are accumulations e.g., of inner products,
we can expect that there will be some surprises. My guess is that there
will need to be some adjustment of the internal routines, most likely to define
somewhat lower standards. My experience has been that results that are a bit
different cause lots of confusion, even if the reality isn't of great import,
and such confusion will be the main waste of time.

I built the "Compact numerical methods" on Data General machines, which had
32 bit floating point with I recall 24 bit mantissa. Later (worse!) the
DG Eclipse used 6 hex digits mantissa. The special functions were pretty
cruddy too. So my codes were incredibly defensive, making them quite reliable
but pretty slow. Also I had to fit program and data in 4K bytes, so the
codes left out bells and whistles. Then we got IEEE 754, which really
helped us out of the bog of weird and not wonderful floating point.
Look up "Fuzz" on Tektronix BASIC. Messed up a lot of my codes.

Cheers,

JN





On 2025-05-04 19:25, Simon Urbanek wrote:
> John,
> 
> it's sort of the other way around: because neither the implementation, format nor precision of "long double" are defined by the C standard (it's not even required to be based on IEEE 754/IEC 60559 at all), it is essentially left to the compilers+runtimes to do whatever they choose, making it a bit of a wild card. Historically, anything beyond double precision was emulated since most hardware was unable to natively deal with it, so that?s why you had to think hard if you wanted to use it as the penalty could be an order of magnitude or more. It wasn't until Intel?s math co-processor and its 80-bit extended precision format which reduced the penalty for such operations on that CPU and was mapped to long double - at the cost of results being hardware-specific, somewhat arbitrary and only 2.5x precision (while occupying 4x the space). So long double is just a simple way to say "do your best" without defining any specifics.
> 
> I?m not sure what you mean by "short double" as double precision is defined as 64-bit, so "short double" would be simply 32-bit = single precision. More recent introduction of varying floating point precisions such as fp8, f16 etc. (assuming that?s what you meant by "short double" on M1) are performance and memory usage optimizations for use-cases where the precision is less important than memory usage, such as in large NNs. M1 is just one of the modern chips that added co-processors specifically for matrix operations on different precisions like fp16, fp32, fp64 - with great performance gains (e.g., using AMX via Apple's BLAS/LAPACK with double precision in R on M1 is over 100x faster than the CPU-based reference version for some operations).
> 
> As for precision beyond doubles, Apple has asked few years ago the scientific community whether there is interest in fp128 (quad precision) and the response was no, it?s not a priority, so I would assume that?s why it has been left to emulations (it is interesting in retrospect, because at that point we had no idea that they were designing what became Apple Silicon). I presume it would be possible to leverage the Apple matrix co-processor for fp128 operations (e.g., PowerPC used double-double arithmetics implementation as a precedent), but given the low priority I have not seen it yet.
> 
> Cheers,
> Simon
> 
> 
>> On Apr 30, 2025, at 10:29 PM, J C Nash <profjcnash at gmail.com> wrote:
>>
>> As one of original 30-some members of 1985 IEEE 754, I find it discouraging that we are treating long-double as the exception, when it is the introduction of "short double" in M1 etc chips that have forced the issue. There are strong commercial reasons, but they aren't computational ones.
>>
>> JN
>>
>>
>> On 2025-04-30 05:08, Tim Taylor wrote:
>>> Thank you all!
>>> Everything is clear.
>>> Tim
>>> On Wed, 30 Apr 2025, at 10:07 AM, Tomas Kalibera wrote:
>>>> On 4/30/25 10:43, Tim Taylor wrote:
>>>>> Cheers for the quick response.
>>>>>
>>>>> To clarify my question: Is it correct to say that as long as packages do not assume the greater precision provided by 'double' there is no reason they cannot use 'long double' to get *possible* advantages (e.g. in summations). AFAICT 'long double' is (and has always been) part of the C standard so it's use as a type should be unproblematic (this is the query relevant to matrixStats).
>>>>
>>>> Probably already clear from previous answers, but yes, packages can use
>>>> long double type.
>>>>
>>>> Whenever using a long double type, one needs to be careful about making
>>>> sure the algorithms work, and the tests pass (so have reasonable
>>>> tolerances), even when the long double type happens to be just the same
>>>> as double. This is the case on aarch64, and macOS/aarch64 is one of the
>>>> platforms where packages have to work, anyway, so this shouldn't be too
>>>> limiting anymore - but really one needs to test on such platform.
>>>>
>>>> R itself has an option to disable use of long double to make such
>>>> testing in R itself possible also on other platforms. In principle one
>>>> could do something similar in a package, have some ifdefs to disable
>>>> long doubles, but this is not required. And I probably wouldn't do that,
>>>> I'd just test on aarch64 regularly.
>>>>
>>>> See Writing R Extensions for more details.
>>>>
>>>> Best
>>>> Tomas
>>>>
>>>>> Apologies if this does not make much sense.
>>>>>
>>>>> Tim
>>>>>
>>>>>
>>>>>
>>>>> On Wed, 30 Apr 2025, at 9:33 AM, Uwe Ligges wrote:
>>>>>> On 30.04.2025 10:25, Tim Taylor wrote:
>>>>>>> Is it correct to say that R's conditional use of long double is around ensuring things work on platforms which have 'long double' identical to 'double' types, as opposed to there being an odd compiler targeted that does not even have any concept of 'long double' type?
>>>>>> a double is 64 bit and stored that way on all platforms, the concept of
>>>>>> long doubles is CPU specific. x86 chips have 80bit in the floating point
>>>>>> units for calculations before rounding (and normalizing) to a regular
>>>>>> double.
>>>>>>
>>>>>> Some chips, e.g. those ARM chips used in current M[123]Macs (hence very
>>>>>> relevant topic), do not support long doubles. And compilers offer to
>>>>>> compile without support for long doubles which e.g. CRAN uses to check
>>>>>> in an additional (issues) check.
>>>>>>
>>>>>> Best,
>>>>>> Uwe Ligges
>>>>>>
>>>>>>> As background this was motivated by a query raised in the matrixStats package:
>>>>>>> https://github.com/HenrikBengtsson/matrixStats/issues/278
>>>>>>>
>>>>>>> ______________________________________________
>>>>>>> R-package-devel at r-project.org mailing list
>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>>>>
>>>>>> Attachments:
>>>>>> * smime.p7s
>>>>> ______________________________________________
>>>>> R-package-devel at r-project.org mailing list
>>>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>> ______________________________________________
>>> R-package-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>
>


From qu|k@||ver67213 @end|ng |rom y@hoo@com  Wed May  7 22:10:50 2025
From: qu|k@||ver67213 @end|ng |rom y@hoo@com (Mat Fok)
Date: Wed, 7 May 2025 20:10:50 +0000 (UTC)
Subject: [R-pkg-devel] Run Examples Not Found
References: <1856609866.1328592.1746648650371.ref@mail.yahoo.com>
Message-ID: <1856609866.1328592.1746648650371@mail.yahoo.com>

Hi,
My example sources data from olr/inst/extdata and I point to it in my example. I do not include the `dontrun{}` function around this @examples as I want to be able to click "Run Examples" in my Help documentation but I get the error /Example/olr not found. I was thinking maybe I should have a folder called Example, but ChatGPT said no. I have searched online for this but the most relevant thing I have found was?stackoverflow.com/questions/76365640/r-roxygen-examples-example-foo-bar-not-found,?but no one answered and it is over a year old.

| 
| 
| 
|  |  |

 |

 |
| 
|  | 
R Roxygen @examples /Example/foo_bar not found

I am creating an R package and can't run the examples when using devtools::load_all()I always get /Example/func...
 |

 |

 |

?

Here is my example:
#' @examples#' # Option 1: Manual loading from package (if preferred)#' # file <- system.file("extdata", "crudeoildata.csv", package = "olr", mustWork = TRUE)#' # crudeoildata <- read.csv(file, header = TRUE)#' # dataset <- crudeoildata[, -1]#'#' # Option 2: Preferred - using load_custom_data()#' dataset <- load_custom_data("crudeoildata.csv", exclude_first_column = TRUE)#'#' responseName <- "CrudeOil"#' predictorNames <- c("RigCount", "API", "FieldProduction", "RefinerNetInput",#'? ?"OperableCapacity", "Imports", "StocksExcludingSPR", "NonCommercialLong",#'? ?"NonCommercialShort", "CommercialLong", "CommercialShort", "OpenInterest")#'#' olr(dataset, responseName, predictorNames, adjr2 = FALSE)
Here is my file structure:
olr/??? DESCRIPTION??? NAMESPACE??? .Rhistory??? R/?? ???? olr_function.R?? ???? utils.R??? man/?? ???? olr.Rd?? ???? load_custom_data.Rd??? inst/? ? ??? extdata/? ? ? ? ??? crudeoildata.csv
How do I Run Examples properly?
Thanks,
Mathew Fok

	[[alternative HTML version deleted]]


From m|ch@e|ch|r|co4 @end|ng |rom gm@||@com  Wed May  7 23:18:06 2025
From: m|ch@e|ch|r|co4 @end|ng |rom gm@||@com (Michael Chirico)
Date: Wed, 7 May 2025 14:18:06 -0700
Subject: [R-pkg-devel] Run Examples Not Found
In-Reply-To: <1856609866.1328592.1746648650371@mail.yahoo.com>
References: <1856609866.1328592.1746648650371.ref@mail.yahoo.com>
 <1856609866.1328592.1746648650371@mail.yahoo.com>
Message-ID: <CAPRVBcyOBxqc_s5AeuemA9P9vkLQSRjtVXUXhQ7QbLKtFwngzQ@mail.gmail.com>

Hi Mat, glancing at what I believe to be your package sources [1]

You have non-R exposition in your \examples{...}. Examples are code --
you should be able to run them like any other code.

Moreover, they should be self-contained -- expecting the user to
create 'oildata' themselves won't work.

Why not use

oildata <- read.csv(system.file("extdata", "oildata.csv", package="olr"))

Inside the example instead?

You might also consider turning 'oildata' into a proper data object
exported by your package [2]

Mike C

PS your text got mangled, it's quite hard to read your message -- I've
made a best effort to do so. Look how it renders [3]. Please turn on
'Plain text mode' for messages to this list to avoid this issue.

[1] https://github.com/MatHatter/olr_r/blob/4eeca43a947823aadddd97cbc9bafc43401c2848/olr/man/olr.Rd#L38-L51
[2] https://cran.r-project.org/doc/manuals/r-release/R-exts.html#Data-in-packages
[3] https://stat.ethz.ch/pipermail/r-package-devel/2025q2/011641.html

On Wed, May 7, 2025 at 1:11?PM Mat Fok via R-package-devel
<r-package-devel at r-project.org> wrote:
>
> Hi,
> My example sources data from olr/inst/extdata and I point to it in my example. I do not include the `dontrun{}` function around this @examples as I want to be able to click "Run Examples" in my Help documentation but I get the error /Example/olr not found. I was thinking maybe I should have a folder called Example, but ChatGPT said no. I have searched online for this but the most relevant thing I have found was stackoverflow.com/questions/76365640/r-roxygen-examples-example-foo-bar-not-found, but no one answered and it is over a year old.
>
> |
> |
> |
> |  |  |
>
>  |
>
>  |
> |
> |  |
> R Roxygen @examples /Example/foo_bar not found
>
> I am creating an R package and can't run the examples when using devtools::load_all()I always get /Example/func...
>  |
>
>  |
>
>  |
>
>
>
> Here is my example:
> #' @examples#' # Option 1: Manual loading from package (if preferred)#' # file <- system.file("extdata", "crudeoildata.csv", package = "olr", mustWork = TRUE)#' # crudeoildata <- read.csv(file, header = TRUE)#' # dataset <- crudeoildata[, -1]#'#' # Option 2: Preferred - using load_custom_data()#' dataset <- load_custom_data("crudeoildata.csv", exclude_first_column = TRUE)#'#' responseName <- "CrudeOil"#' predictorNames <- c("RigCount", "API", "FieldProduction", "RefinerNetInput",#'   "OperableCapacity", "Imports", "StocksExcludingSPR", "NonCommercialLong",#'   "NonCommercialShort", "CommercialLong", "CommercialShort", "OpenInterest")#'#' olr(dataset, responseName, predictorNames, adjr2 = FALSE)
> Here is my file structure:
> olr/??? DESCRIPTION??? NAMESPACE??? .Rhistory??? R/?   ??? olr_function.R?   ??? utils.R??? man/?   ??? olr.Rd?   ??? load_custom_data.Rd??? inst/    ??? extdata/        ??? crudeoildata.csv
> How do I Run Examples properly?
> Thanks,
> Mathew Fok
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From |kry|ov @end|ng |rom d|@root@org  Thu May  8 16:49:35 2025
From: |kry|ov @end|ng |rom d|@root@org (Ivan Krylov)
Date: Thu, 8 May 2025 17:49:35 +0300
Subject: [R-pkg-devel] Run Examples Not Found
In-Reply-To: <1856609866.1328592.1746648650371@mail.yahoo.com>
References: <1856609866.1328592.1746648650371.ref@mail.yahoo.com>
 <1856609866.1328592.1746648650371@mail.yahoo.com>
Message-ID: <20250508174936.430b0818@trisector>

? Wed, 7 May 2025 20:10:50 +0000 (UTC)
Mat Fok via R-package-devel <r-package-devel at r-project.org> ?????:

> I want to be able to click "Run Examples" in my Help documentation
> but I get the error /Example/olr not found. 

> I have searched online for this but the most relevant thing I have
> found was
> stackoverflow.com/questions/76365640/r-roxygen-examples-example-foo-bar-not-found,
> but no one answered and it is over a year old.

Are you using load_all()? According to the documentation (see
?pkgload::load_all), example() is not one of the functions emulated by
load_all(). Without emulation, it needs an installed package with a
table of help pages and their aliases.

Does it also not work if you use R CMD build and R CMD INSTALL?

-- 
Best regards,
Ivan


From j@@g@rc|@ @end|ng |rom cnb@c@|c@e@  Thu May  8 15:37:11 2025
From: j@@g@rc|@ @end|ng |rom cnb@c@|c@e@ (Juan Antonio Garcia Martin)
Date: Thu, 8 May 2025 15:37:11 +0200
Subject: [R-pkg-devel] Functions requiring packages listed on Suggests
Message-ID: <068c8892-0b1f-4639-b40f-d2fc47ccba43@cnb.csic.es>

Dear mantainers,

I have a question, since one of my packages currently does not pass the 
onSuggest special check.

Two functions of my package require some of the suggested packages 
either in CRAN (DiagrammeR, DiagrammeRsvg and rsvg) or Bioconductor ( 
rtracklayer and GenomicRanges), also listed in the suggest section.

The functions detect whether the suggested packages are installed and 
available, and return an error message indicating that the packages 
required to use the function.

In fact DiagrammeR uses the same approach, the function export_graph 
requires both DiagrammeRsvg and rsvg, but they are not listed in the 
imports, it just returns a message when they are not installed.

I have the option of removing the examples, or printing the same 
messages but returning from the functions instead of using stop. What is 
the preferred behavior in these cases?

Best regards,
Juan Antonio



	

	

	

	

	[[alternative HTML version deleted]]


From m|ch@e|ch|r|co4 @end|ng |rom gm@||@com  Thu May  8 17:28:57 2025
From: m|ch@e|ch|r|co4 @end|ng |rom gm@||@com (Michael Chirico)
Date: Thu, 8 May 2025 08:28:57 -0700
Subject: [R-pkg-devel] Functions requiring packages listed on Suggests
In-Reply-To: <068c8892-0b1f-4639-b40f-d2fc47ccba43@cnb.csic.es>
References: <068c8892-0b1f-4639-b40f-d2fc47ccba43@cnb.csic.es>
Message-ID: <CAPRVBcwV6zzGQXBLHRgwVG0zu=0H8DPk1t8xYHS=AieKSTTb_Q@mail.gmail.com>

Just don't run those examples on machines lacking the Suggests packages.

With roxygen2 it's as easy as @examplesIf requireNamespace(p, quietly=TRUE).

On Thu, May 8, 2025, 8:19?AM Juan Antonio Garcia Martin <
ja.garcia at cnb.csic.es> wrote:

> Dear mantainers,
>
> I have a question, since one of my packages currently does not pass the
> onSuggest special check.
>
> Two functions of my package require some of the suggested packages
> either in CRAN (DiagrammeR, DiagrammeRsvg and rsvg) or Bioconductor (
> rtracklayer and GenomicRanges), also listed in the suggest section.
>
> The functions detect whether the suggested packages are installed and
> available, and return an error message indicating that the packages
> required to use the function.
>
> In fact DiagrammeR uses the same approach, the function export_graph
> requires both DiagrammeRsvg and rsvg, but they are not listed in the
> imports, it just returns a message when they are not installed.
>
> I have the option of removing the examples, or printing the same
> messages but returning from the functions instead of using stop. What is
> the preferred behavior in these cases?
>
> Best regards,
> Juan Antonio
>
>
>
>
>
>
>
>
>
>
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de  Thu May  8 18:24:34 2025
From: ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de (Uwe Ligges)
Date: Thu, 8 May 2025 18:24:34 +0200
Subject: [R-pkg-devel] Functions requiring packages listed on Suggests
In-Reply-To: <068c8892-0b1f-4639-b40f-d2fc47ccba43@cnb.csic.es>
References: <068c8892-0b1f-4639-b40f-d2fc47ccba43@cnb.csic.es>
Message-ID: <35e6b296-ae6a-45b7-aab0-e0f381fe9dc9@statistik.tu-dortmund.de>

Simply only run  the function conditionally in test, examples, vignettes:

if(requireNamespace(packageName)){

example / vignette / test code

}




On 08.05.2025 15:37, Juan Antonio Garcia Martin wrote:
> Dear mantainers,
> 
> I have a question, since one of my packages currently does not pass the
> onSuggest special check.
> 
> Two functions of my package require some of the suggested packages
> either in CRAN (DiagrammeR, DiagrammeRsvg and rsvg) or Bioconductor (
> rtracklayer and GenomicRanges), also listed in the suggest section.
> 
> The functions detect whether the suggested packages are installed and
> available, and return an error message indicating that the packages
> required to use the function.
> 
> In fact DiagrammeR uses the same approach, the function export_graph
> requires both DiagrammeRsvg and rsvg, but they are not listed in the
> imports, it just returns a message when they are not installed.
> 
> I have the option of removing the examples, or printing the same
> messages but returning from the functions instead of using stop. What is
> the preferred behavior in these cases?
> 
> Best regards,
> Juan Antonio
> 
> 
> 
> 	
> 
> 	
> 
> 	
> 
> 	
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From t@weet @end|ng |rom umd@edu  Thu May  8 18:01:47 2025
From: t@weet @end|ng |rom umd@edu (Tracy Morrison Sweet)
Date: Thu, 8 May 2025 12:01:47 -0400
Subject: [R-pkg-devel] Secondary Issues getting a package on cran
Message-ID: <AD40D6E8-08D2-456F-90FA-0589F4417A75@umd.edu>

Hi all,

I?m not sure how to fix the following issues with a package. When I run checks on my own computer, I only see a note that the package was previously removed from cran. 

So both of the checks have the same note: 
New submission 
Package was archived on CRAN

I?m not sure how to do anything to remove this note. I?m also not sure if this note is causing issues, but it seems like it is.

Then, they ran additional checks and a gave me link with a file directory clang-san, in which there are 4 files: ?outputs.txt?, ?package?, ?process.txt?, ?summary.txt?.  

In outputs.txt, there were 24 warnings in the  These are functions in other packages I?m guessing, but I don?t call them in my package. 
In the package link, I can see the install log and there are no errors.
In process.txt and summary.txt, it says 
"File: HLSM-Ex.Rout
vendor/cigraph/src/constructors/adjacency.c:87:34: runtime error: nan is outside the range of representable values of type ?long?"

I?m not sure how to fix any of these. When I check it on my computer, the file HLSM-Ex.Rout doesn?t have this information. 

The email from cran is copied below. 

Thanks for any suggestions,
Tracy



Dear maintainer,

package HLSM_0.9.1.tar.gz does not pass the incoming checks automatically, please see the following pre-tests (additional issue checks):
Windows: <https://win-builder.r-project.org/incoming_pretest/HLSM_0.9.1_20250508_154110/Windows/00check.log>
Status: 1 NOTE
Debian: <https://win-builder.r-project.org/incoming_pretest/HLSM_0.9.1_20250508_154110/Debian/00check.log>
Status: 1 NOTE

Additional issues checked: <https://win-builder.r-project.org/incoming_pretest/HLSM_0.9.1_20250508_154110/specialChecks/>
clang-san: Status: WARNING

Last released version's CRAN status: OK: 12
See: <https://cran-archive.r-project.org/web/checks/2024/2024-01-19_check_results_HLSM.html>

Last released version's additional issues:
clang-UBSAN <https://www.stats.ox.ac.uk/pub/bdr/memtests/clang-UBSAN/HLSM>

Please fix all problems and resubmit a fixed version via the webform.
If you are not sure how to fix the problems shown, please ask for help on the R-package-devel mailing list:
<https://stat.ethz.ch/mailman/listinfo/r-package-devel>
If you are fairly certain the rejection is a false positive, please reply-all to this message and explain.

More details are given in the directory:
<https://win-builder.r-project.org/incoming_pretest/HLSM_0.9.1_20250508_154110/>
The files will be removed after roughly 7 days.

No strong reverse dependencies to be checked.

Best regards,
CRAN teams' auto-check service
Flavor: r-devel-linux-x86_64-debian-gcc, r-devel-windows-x86_64
Check: CRAN incoming feasibility, Result: NOTE
Maintainer: 'Tracy Sweet <tsweet at umd.edu <mailto:tsweet at umd.edu> <mailto:tsweet at umd.edu>>'

New submission

Package was archived on CRAN

CRAN repository db overrides:
  X-CRAN-Comment: Archived on 2024-01-19 as issues were not corrected
    in time.

Flavor: r-devel-linux-x86_64-debian-special-clang-san
Check: *, Result: NA


Flavor: r-devel-linux-x86_64-debian-special-clang-san
Check: Post-processing issues found for clang-san, Result: WARNING
File: HLSM-Ex.Rout
vendor/cigraph/src/constructors/adjacency.c:87:34: runtime error: nan is outside the range of representable values of type 'long'






	[[alternative HTML version deleted]]


From j@@g@rc|@ @end|ng |rom cnb@c@|c@e@  Thu May  8 22:02:51 2025
From: j@@g@rc|@ @end|ng |rom cnb@c@|c@e@ (=?ISO-8859-1?Q?Juan_Antonio_Garc=EDa_Mart=EDn?=)
Date: Thu, 08 May 2025 22:02:51 +0200
Subject: [R-pkg-devel] Functions requiring packages listed on Suggests
In-Reply-To: <35e6b296-ae6a-45b7-aab0-e0f381fe9dc9@statistik.tu-dortmund.de>
References: <068c8892-0b1f-4639-b40f-d2fc47ccba43@cnb.csic.es>
 <35e6b296-ae6a-45b7-aab0-e0f381fe9dc9@statistik.tu-dortmund.de>
Message-ID: <4F1A7268-15AB-4E69-A762-1B4440983A54@cnb.csic.es>

Thank you for answering so soon, Michael and Uwe.

I think I will follow Uwe's approach, it is simple and will work on all cases. 

Best regards, 
Juan Antonio 



On May 8, 2025 6:24:34 PM GMT+02:00, Uwe Ligges <ligges at statistik.tu-dortmund.de> wrote:
>Simply only run  the function conditionally in test, examples, vignettes:
>
>if(requireNamespace(packageName)){
>
>example / vignette / test code
>
>}
>
>
>
>
>On 08.05.2025 15:37, Juan Antonio Garcia Martin wrote:
>> Dear mantainers,
>> 
>> I have a question, since one of my packages currently does not pass the
>> onSuggest special check.
>> 
>> Two functions of my package require some of the suggested packages
>> either in CRAN (DiagrammeR, DiagrammeRsvg and rsvg) or Bioconductor (
>> rtracklayer and GenomicRanges), also listed in the suggest section.
>> 
>> The functions detect whether the suggested packages are installed and
>> available, and return an error message indicating that the packages
>> required to use the function.
>> 
>> In fact DiagrammeR uses the same approach, the function export_graph
>> requires both DiagrammeRsvg and rsvg, but they are not listed in the
>> imports, it just returns a message when they are not installed.
>> 
>> I have the option of removing the examples, or printing the same
>> messages but returning from the functions instead of using stop. What is
>> the preferred behavior in these cases?
>> 
>> Best regards,
>> Juan Antonio
>> 
>> 
>> 
>> 	
>> 
>> 	
>> 
>> 	
>> 
>> 	
>> 
>> 	[[alternative HTML version deleted]]
>> 
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From |kry|ov @end|ng |rom d|@root@org  Fri May  9 00:30:25 2025
From: |kry|ov @end|ng |rom d|@root@org (Ivan Krylov)
Date: Fri, 9 May 2025 01:30:25 +0300
Subject: [R-pkg-devel] Secondary Issues getting a package on cran
In-Reply-To: <AD40D6E8-08D2-456F-90FA-0589F4417A75@umd.edu>
References: <AD40D6E8-08D2-456F-90FA-0589F4417A75@umd.edu>
Message-ID: <20250509013025.6b37bf30@trisector>

? Thu, 8 May 2025 12:01:47 -0400
Tracy Morrison Sweet <tsweet at umd.edu> ?????:

> New submission 
> Package was archived on CRAN
> 
> I?m not sure how to do anything to remove this note.

This note is to be expected.

> In process.txt and summary.txt, it says "File: HLSM-Ex.Rout
> vendor/cigraph/src/constructors/adjacency.c:87:34: runtime error: nan
> is outside the range of representable values of type ?long?"

The link to the original issue that got your package archived is more
informative because it contains the backtrace and shows the place in
your examples where the problem happens:

https://www.stats.ox.ac.uk/pub/bdr/memtests/clang-UBSAN/HLSM/HLSM-Ex.Rout

> > fixed.fit = HLSMfixedEF(Y = ps.advice.mat, senderCov=ps.node.df,
> + 	initialVals = initialVals,priors = priors,
> + 	tune = tune,tuneIn = FALSE,dd = 2,niter = niter)
> core/constructors/adjacency.c:47:26: runtime error: nan is outside
> the range of representable values of type 'long' #0 0x7f09504c6e4b in
> igraph_i_adjacency_directed
> /tmp/Rtmp9HF8V2/R.INSTALL659cd504fd46b/igraph/src/core/constructors/adjacency.c:47:26
> #1 0x7f09504c5715 in igraph_adjacency
> /tmp/Rtmp9HF8V2/R.INSTALL659cd504fd46b/igraph/src/core/constructors/adjacency.c:212:9
> #2 0x7f0950c654a3 in R_igraph_graph_adjacency
> /tmp/Rtmp9HF8V2/R.INSTALL659cd504fd46b/igraph/src/rinterface_extra.c:4861:3

The file path is now different, but the issue is most likely the same.
During a call to HLSMfixedEF(), a matrix containing a NaN value is
passed to the 'igraph' package, where the NaN is converted to an
integer:

https://github.com/igraph/rigraph/blob/9a2816248eb837077b5af28bad7b1b9c0713b128/src/vendor/cigraph/src/constructors/adjacency.c#L87

Unfortunately, converting a NaN into an integer is undefined behaviour
according to the C standard. The program is allowed to do literally
anything, so it caused your package to be archived.

Ideally, 'igraph' could produce an informative error message upon
detecting a NaN, but you can avoid the problem on your end by making
sure that all values in your adjacency matrices are finite before
calling igraph::graph.adjacency().

To see the problem for yourself, you'll need a "sanitized" build of R:
https://cran.r-project.org/doc/manuals/R-exts.html#Using-Undefined-Behaviour-Sanitizer

Sanitizers are somewhat finicky to use. The container images
docker.io/rocker/r-devel-ubsan-clang and
ghcr.io/r-hub/containers/clang-ubsan, or the R-hub service may help.

Good luck! If this wasn't detailed enough, don't hesitate to ask
follow-up questions.

-- 
Best regards,
Ivan


From jm@yu@n @end|ng |rom out|ook@com  Fri May  9 06:22:52 2025
From: jm@yu@n @end|ng |rom out|ook@com (jiaming yuan)
Date: Fri, 9 May 2025 04:22:52 +0000
Subject: [R-pkg-devel] CRAN Submission xgboost 1.7.11.1
In-Reply-To: <OS3PR01MB8068F43785E19BF9A1FFEAC5F68AA@OS3PR01MB8068.jpnprd01.prod.outlook.com>
References: <20250501105800.3FA5CA01B9@xmpalantir.wu.ac.at>
 <c8b1e3ed-bb68-4d29-b9e7-d33a20efd802@statistik.tu-dortmund.de>
 <OS3PR01MB8068DDDF251EA2D84352E2B2F68C2@OS3PR01MB8068.jpnprd01.prod.outlook.com>
 <51df8414-5cce-4eb4-a7f1-8499f52393af@statistik.tu-dortmund.de>
 <5d95cb36-dc9a-4a5b-b08a-182e1e321aad@statistik.tu-dortmund.de>
 <OS3PR01MB8068F43785E19BF9A1FFEAC5F68AA@OS3PR01MB8068.jpnprd01.prod.outlook.com>
Message-ID: <OS3PR01MB8068A259CA4381B339A21302F68AA@OS3PR01MB8068.jpnprd01.prod.outlook.com>

Hi CRAN,

May I ask if someone has tried to reproduce the openblas test environment from CRAN? We are trying to resolve the test failures of XGBoost but so far no one has managed to reproduce them locally. https://github.com/dmlc/xgboost/issues/11431

Would be great if you can share some guidance on how to reproduce that exact environment.

Cheers
Jiaming
________________________________
From: jiaming yuan <jm.yuan at outlook.com>
Sent: Friday, May 9, 2025 12:04:45 PM
To: Uwe Ligges <ligges at statistik.tu-dortmund.de>; CRAN <cran-submissions at r-project.org>
Cc: CRAN Package Submission Form <cransubmit at xmbombadil.wu.ac.at>
Subject: Re: CRAN Submission xgboost 1.7.11.1

Hi,

Others kindly provided help to reproduce the failure but so far no one has managed to do so.

Please see  https://github.com/dmlc/xgboost/issues/11431#issuecomment-2864947065  and related discussions the thread. Would be great if you can share something more precise.


Cheers
Jiaming

________________________________
From: Uwe Ligges <ligges at statistik.tu-dortmund.de>
Sent: Wednesday, May 7, 2025 9:48:56 PM
To: jiaming yuan <jm.yuan at outlook.com>; CRAN <cran-submissions at r-project.org>
Cc: CRAN Package Submission Form <cransubmit at xmbombadil.wu.ac.at>
Subject: Re: CRAN Submission xgboost 1.7.11.1

Note this is relevant, as most Linux clusters will have admis who will
link scientifiv software aagainst OpenBLAS for faster matriox operations.

Best,
Uwe Ligges

On 07.05.2025 15:48, Uwe Ligges wrote:
> I think any Liniux system with R linked against the system's default
> OpenBLAS installation will show this issue.
> I'd try it with a standard Ubuntu or Debian with OpenBLAS installed and
> link agasinst it.
>
> Best,
> Uwe Ligges
>
>
>
> On 03.05.2025 08:29, jiaming yuan wrote:
>> Thank you for reaching out. We can't really dive into it unless
>> there's an easier way to reproduce the environment (like a container
>> or using some deterministic package managers). It's very unlikely that
>> we can try to build that environment on our own then try to fix all
>> errors and verify all fixes.
>>
>>
>>
>> ________________________________
>> From: Uwe Ligges <ligges at statistik.tu-dortmund.de>
>> Sent: Friday, May 2, 2025 8:00:17 PM
>> To: Jiaming Yuan <jm.yuan at outlook.com>; CRAN <cran-submissions at r-
>> project.org>
>> Cc: CRAN Package Submission Form <cransubmit at xmbombadil.wu.ac.at>
>> Subject: Re: CRAN Submission xgboost 1.7.11.1
>>
>> Thanks, we see you removed lots of tests. Is this really sensible and
>> are you sure that users with OpenBLAS (as most Linux users and cluster
>> admins will use) will get correct results? Sensibly relaxing numerical
>> assumptions may be a better way to tweak the tests.?
>>
>> Best,
>> Uwe Ligges
>>
>>
>> On 01.05.2025 12:58, CRAN Package Submission Form via CRAN-submissions
>> wrote:
>>> [This was generated from CRAN.R-project.org/submit.html]
>>>
>>> The following package was uploaded to CRAN:
>>> ===========================================
>>>
>>> Package Information:
>>> Package: xgboost
>>> Version: 1.7.11.1
>>> Title: Extreme Gradient Boosting
>>> Author(s): Tianqi Chen [aut], Tong He [aut], Michael Benesty [aut],
>>> Vadim
>>> Khotilovich [aut], Yuan Tang [aut]
>>> (<https://orcid.org/0000-0001-5243-233X>), Hyunsu Cho [aut],
>>> Kailong Chen [aut], Rory Mitchell [aut], Ignacio Cano [aut],
>>> Tianyi Zhou [aut], Mu Li [aut], Junyuan Xie [aut], Min Lin
>>> [aut], Yifeng Geng [aut], Yutian Li [aut], Jiaming Yuan [aut,
>>> cre], XGBoost contributors [cph] (base XGBoost implementation)
>>> Maintainer: Jiaming Yuan <jm.yuan at outlook.com>
>>> Depends: R (>= 3.3.0)
>>> Suggests: knitr, rmarkdown, ggplot2 (>= 1.0.1), DiagrammeR (>= 0.9.0),
>>> Ckmeans.1d.dp (>= 3.3.1), vcd (>= 1.3), cplm, e1071, caret,
>>> testthat, lintr, igraph (>= 1.0.1), float, crayon, titanic
>>> Description: Extreme Gradient Boosting, which is an efficient
>>> implementation of the gradient boosting framework from Chen &
>>> Guestrin (2016) <doi:10.1145/2939672.2939785>. This package
>>> is its R interface. The package includes efficient linear
>>> model solver and tree learning algorithms. The package can
>>> automatically do parallel computation on a single machine
>>> which could be more than 10 times faster than existing
>>> gradient boosting packages. It supports various objective
>>> functions, including regression, classification and ranking.
>>> The package is made to be extensible, so that users are also
>>> allowed to define their own objectives easily.
>>> License: Apache License (== 2.0) | file LICENSE
>>> Imports: Matrix (>= 1.1-0), methods, data.table (>= 1.9.6), jsonlite
>>> (>= 1.0),
>>>
>>>
>>> The maintainer confirms that he or she
>>> has read and agrees to the CRAN policies.
>>>
>>> =================================================
>>>
>>> Original content of DESCRIPTION file:
>>>
>>> Package: xgboost
>>> Type: Package
>>> Title: Extreme Gradient Boosting
>>> Version: 1.7.11.1
>>> Date: 2025-05-01
>>> Authors at R: c(
>>> person("Tianqi", "Chen", role = c("aut"),
>>> email = "tianqi.tchen at gmail.com"),
>>> person("Tong", "He", role = c("aut"),
>>> email = "hetong007 at gmail.com"),
>>> person("Michael", "Benesty", role = c("aut"),
>>> email = "michael at benesty.fr"),
>>> person("Vadim", "Khotilovich", role = c("aut"),
>>> email = "khotilovich at gmail.com"),
>>> person("Yuan", "Tang", role = c("aut"),
>>> email = "terrytangyuan at gmail.com",
>>> comment = c(ORCID = "0000-0001-5243-233X")),
>>> person("Hyunsu", "Cho", role = c("aut"),
>>> email = "chohyu01 at cs.washington.edu"),
>>> person("Kailong", "Chen", role = c("aut")),
>>> person("Rory", "Mitchell", role = c("aut")),
>>> person("Ignacio", "Cano", role = c("aut")),
>>> person("Tianyi", "Zhou", role = c("aut")),
>>> person("Mu", "Li", role = c("aut")),
>>> person("Junyuan", "Xie", role = c("aut")),
>>> person("Min", "Lin", role = c("aut")),
>>> person("Yifeng", "Geng", role = c("aut")),
>>> person("Yutian", "Li", role = c("aut")),
>>> person("Jiaming", "Yuan", role = c("aut", "cre"),
>>> email = "jm.yuan at outlook.com"),
>>> person("XGBoost contributors", role = c("cph"),
>>> comment = "base XGBoost implementation")
>>> )
>>> Maintainer: Jiaming Yuan <jm.yuan at outlook.com>
>>> Description: Extreme Gradient Boosting, which is an efficient
>>> implementation
>>> of the gradient boosting framework from Chen & Guestrin (2016)
>>> <doi:10.1145/2939672.2939785>.
>>> This package is its R interface. The package includes efficient linear
>>> model solver and tree learning algorithms. The package can automatically
>>> do parallel computation on a single machine which could be more than 10
>>> times faster than existing gradient boosting packages. It supports
>>> various objective functions, including regression, classification and
>>> ranking.
>>> The package is made to be extensible, so that users are also allowed
>>> to define
>>> their own objectives easily.
>>> License: Apache License (== 2.0) | file LICENSE
>>> URL: https://github.com/dmlc/xgboost
>>> BugReports: https://github.com/dmlc/xgboost/issues
>>> NeedsCompilation: yes
>>> VignetteBuilder: knitr
>>> Suggests: knitr, rmarkdown, ggplot2 (>= 1.0.1), DiagrammeR (>= 0.9.0),
>>> Ckmeans.1d.dp (>= 3.3.1), vcd (>= 1.3), cplm, e1071, caret,
>>> testthat, lintr, igraph (>= 1.0.1), float, crayon, titanic
>>> Depends: R (>= 3.3.0)
>>> Imports: Matrix (>= 1.1-0), methods, data.table (>= 1.9.6), jsonlite
>>> (>= 1.0),
>>> RoxygenNote: 7.3.2
>>> Encoding: UTF-8
>>> SystemRequirements: GNU make, C++17
>>> Packaged: 2025-05-01 10:56:14 UTC; jiamingy
>>> Author: Tianqi Chen [aut],
>>> Tong He [aut],
>>> Michael Benesty [aut],
>>> Vadim Khotilovich [aut],
>>> Yuan Tang [aut] (<https://orcid.org/0000-0001-5243-233X>),
>>> Hyunsu Cho [aut],
>>> Kailong Chen [aut],
>>> Rory Mitchell [aut],
>>> Ignacio Cano [aut],
>>> Tianyi Zhou [aut],
>>> Mu Li [aut],
>>> Junyuan Xie [aut],
>>> Min Lin [aut],
>>> Yifeng Geng [aut],
>>> Yutian Li [aut],
>>> Jiaming Yuan [aut, cre],
>>> XGBoost contributors [cph] (base XGBoost implementation)
>>>
>>
>>
>>
>>     [[alternative HTML version deleted]]
>>
>



	[[alternative HTML version deleted]]


From t@weet @end|ng |rom umd@edu  Fri May  9 17:04:44 2025
From: t@weet @end|ng |rom umd@edu (Tracy Morrison Sweet)
Date: Fri, 9 May 2025 11:04:44 -0400
Subject: [R-pkg-devel] Secondary Issues getting a package on cran
In-Reply-To: <20250509013025.6b37bf30@trisector>
References: <AD40D6E8-08D2-456F-90FA-0589F4417A75@umd.edu>
 <20250509013025.6b37bf30@trisector>
Message-ID: <B43C4C57-27A2-440C-B39D-784035F3A0AD@umd.edu>

Hi Ivan,

This is extremely helpful! I appreciate your time and detailed explanation.

Tracy


> On May 8, 2025, at 6:30?PM, Ivan Krylov <ikrylov at disroot.org> wrote:
> 
> ? Thu, 8 May 2025 12:01:47 -0400
> Tracy Morrison Sweet <tsweet at umd.edu> ?????:
> 
>> New submission 
>> Package was archived on CRAN
>> 
>> I?m not sure how to do anything to remove this note.
> 
> This note is to be expected.
> 
>> In process.txt and summary.txt, it says "File: HLSM-Ex.Rout
>> vendor/cigraph/src/constructors/adjacency.c:87:34: runtime error: nan
>> is outside the range of representable values of type ?long?"
> 
> The link to the original issue that got your package archived is more
> informative because it contains the backtrace and shows the place in
> your examples where the problem happens:
> 
> https://www.stats.ox.ac.uk/pub/bdr/memtests/clang-UBSAN/HLSM/HLSM-Ex.Rout
> 
>>> fixed.fit = HLSMfixedEF(Y = ps.advice.mat, senderCov=ps.node.df,
>> + 	initialVals = initialVals,priors = priors,
>> + 	tune = tune,tuneIn = FALSE,dd = 2,niter = niter)
>> core/constructors/adjacency.c:47:26: runtime error: nan is outside
>> the range of representable values of type 'long' #0 0x7f09504c6e4b in
>> igraph_i_adjacency_directed
>> /tmp/Rtmp9HF8V2/R.INSTALL659cd504fd46b/igraph/src/core/constructors/adjacency.c:47:26
>> #1 0x7f09504c5715 in igraph_adjacency
>> /tmp/Rtmp9HF8V2/R.INSTALL659cd504fd46b/igraph/src/core/constructors/adjacency.c:212:9
>> #2 0x7f0950c654a3 in R_igraph_graph_adjacency
>> /tmp/Rtmp9HF8V2/R.INSTALL659cd504fd46b/igraph/src/rinterface_extra.c:4861:3
> 
> The file path is now different, but the issue is most likely the same.
> During a call to HLSMfixedEF(), a matrix containing a NaN value is
> passed to the 'igraph' package, where the NaN is converted to an
> integer:
> 
> https://github.com/igraph/rigraph/blob/9a2816248eb837077b5af28bad7b1b9c0713b128/src/vendor/cigraph/src/constructors/adjacency.c#L87
> 
> Unfortunately, converting a NaN into an integer is undefined behaviour
> according to the C standard. The program is allowed to do literally
> anything, so it caused your package to be archived.
> 
> Ideally, 'igraph' could produce an informative error message upon
> detecting a NaN, but you can avoid the problem on your end by making
> sure that all values in your adjacency matrices are finite before
> calling igraph::graph.adjacency().
> 
> To see the problem for yourself, you'll need a "sanitized" build of R:
> https://cran.r-project.org/doc/manuals/R-exts.html#Using-Undefined-Behaviour-Sanitizer
> 
> Sanitizers are somewhat finicky to use. The container images
> docker.io/rocker/r-devel-ubsan-clang and
> ghcr.io/r-hub/containers/clang-ubsan, or the R-hub service may help.
> 
> Good luck! If this wasn't detailed enough, don't hesitate to ask
> follow-up questions.
> 
> -- 
> Best regards,
> Ivan

Tracy M. Sweet
Associate Professor
HDQM
University of Maryland
tsweet at umd.edu
she/her/hers
UMD Land Acknowledgement <https://diversity.umd.edu/resources/land-acknowledgement>






	[[alternative HTML version deleted]]


From |kry|ov @end|ng |rom d|@root@org  Fri May  9 23:41:51 2025
From: |kry|ov @end|ng |rom d|@root@org (Ivan Krylov)
Date: Sat, 10 May 2025 00:41:51 +0300
Subject: [R-pkg-devel] CRAN Submission xgboost 1.7.11.1
In-Reply-To: <OS3PR01MB8068A259CA4381B339A21302F68AA@OS3PR01MB8068.jpnprd01.prod.outlook.com>
References: <20250501105800.3FA5CA01B9@xmpalantir.wu.ac.at>
 <c8b1e3ed-bb68-4d29-b9e7-d33a20efd802@statistik.tu-dortmund.de>
 <OS3PR01MB8068DDDF251EA2D84352E2B2F68C2@OS3PR01MB8068.jpnprd01.prod.outlook.com>
 <51df8414-5cce-4eb4-a7f1-8499f52393af@statistik.tu-dortmund.de>
 <5d95cb36-dc9a-4a5b-b08a-182e1e321aad@statistik.tu-dortmund.de>
 <OS3PR01MB8068F43785E19BF9A1FFEAC5F68AA@OS3PR01MB8068.jpnprd01.prod.outlook.com>
 <OS3PR01MB8068A259CA4381B339A21302F68AA@OS3PR01MB8068.jpnprd01.prod.outlook.com>
Message-ID: <20250510004151.79c43656@trisector>

? Fri, 9 May 2025 04:22:52 +0000
jiaming yuan <jm.yuan at outlook.com> ?????:

> We are trying to resolve the test failures of XGBoost but so far no
> one has managed to reproduce them locally.
> https://github.com/dmlc/xgboost/issues/11431

One test failure really stands out:

>   Error ('test_feature_weights.R:17:5'): training with feature
> weights works
>   Error in `setinfo.xgb.DMatrix(dmat, names(p), p[[1]])`:
> cannot get data pointer of 'double' objects

This is particularly strange because the internal CHKVEC() function is
supposed to check for REALSXP vectors and pass them through. Such
"impossible" errors could be signs of a protection error. (Well, any
memory corruption, but arbitrary memory corruption is harder to
diagnose, so let's hope it's something to do with the garbage
collector.) Let's run the test suite check using a build of R-devel
compiled with .../configure --enable-strict-barrier.


testthat::test_check("xgboost")
# <...>
# Fatal error: Wrong thread calling 'RunFinalizers'
# Fatal error: Wrong thread calling 'RunFinalizers'
# Fatal error: Wrong thread calling 'RunFinalizers'
# Fatal error: Wrong thread calling 'RunFinalizers'
# Fatal error: Wrong thread calling 'RunFinalizers'
# Segmentation fault

Hmm.

Setting a breakpoint in Rstd_Suicide reveals the mistake. It's not a
protection error; it's R API being called from an OpenMP thread:

#5  ALTVEC_DATAPTR (x=0x2d825f58) at ../../../R/src/main/altrep.c:376
#6  0x00007fbbd1e5ed98 in operator() (__closure=<synthetic pointer>,
    i=<optimized out>) at xgboost_R.cc:258
#7  dmlc::OMPException::Run<XGDMatrixSetInfo_R(SEXP, SEXP, SEXP)::<lambda(xgboost::omp_ulong)>, int> (this=0x7fffbfaef760, f=...)
    at ./dmlc-core/include/dmlc/common.h:67
#8  _ZN7xgboost6common11ParallelForIiZ18XGDMatrixSetInfo_REUlmE0_EEvT_iNS0_5SchedET0_._omp_fn.3(void) ()
    at ./dmlc-core/include/../../src/common/threading_utils.h:208
#9  0x00007fbbd4552a0e in gomp_thread_start (xdata=<optimized out>)
    at ../../../libgomp/team.c:129
(gdb) frame 5
#5  ALTVEC_DATAPTR (x=0x2d825f58) at ../../../R/src/main/altrep.c:376
376         return ALTVEC_DATAPTR_EX(x, TRUE);
(gdb) call R_inspect(x)
@2d825f58 14 REALSXP g0c0 [REF(65535)]  1 : 9 (expanded)

The code would be better served by calling REAL_RO / INTEGER_RO once
and then using the returned pointer inside the OpenMP threads.

-- 
Best regards,
Ivan


From jm@yu@n @end|ng |rom out|ook@com  Sat May 10 17:33:10 2025
From: jm@yu@n @end|ng |rom out|ook@com (jiaming yuan)
Date: Sat, 10 May 2025 15:33:10 +0000
Subject: [R-pkg-devel] [SPAM | WERBUNG] Re: CRAN Submission xgboost 1.7.11.1
In-Reply-To: <20250510004151.79c43656@trisector>
References: <20250501105800.3FA5CA01B9@xmpalantir.wu.ac.at>
 <c8b1e3ed-bb68-4d29-b9e7-d33a20efd802@statistik.tu-dortmund.de>
 <OS3PR01MB8068DDDF251EA2D84352E2B2F68C2@OS3PR01MB8068.jpnprd01.prod.outlook.com>
 <51df8414-5cce-4eb4-a7f1-8499f52393af@statistik.tu-dortmund.de>
 <5d95cb36-dc9a-4a5b-b08a-182e1e321aad@statistik.tu-dortmund.de>
 <OS3PR01MB8068F43785E19BF9A1FFEAC5F68AA@OS3PR01MB8068.jpnprd01.prod.outlook.com>
 <OS3PR01MB8068A259CA4381B339A21302F68AA@OS3PR01MB8068.jpnprd01.prod.outlook.com>
 <20250510004151.79c43656@trisector>
Message-ID: <OS3PR01MB8068A33A5AF7C7533594A157F695A@OS3PR01MB8068.jpnprd01.prod.outlook.com>

Thank you for sharing, Ivan! This is really helpful.
________________________________
From: Ivan Krylov <ikrylov at disroot.org>
Sent: Saturday, May 10, 2025 5:41:51 AM
To: jiaming yuan <jm.yuan at outlook.com>
Cc: r-package-devel at r-project.org <r-package-devel at r-project.org>
Subject: Re: [R-pkg-devel] CRAN Submission xgboost 1.7.11.1

? Fri, 9 May 2025 04:22:52 +0000
jiaming yuan <jm.yuan at outlook.com> ?????:

> We are trying to resolve the test failures of XGBoost but so far no
> one has managed to reproduce them locally.
> https://github.com/dmlc/xgboost/issues/11431

One test failure really stands out:

>   Error ('test_feature_weights.R:17:5'): training with feature
> weights works
>   Error in `setinfo.xgb.DMatrix(dmat, names(p), p[[1]])`:
> cannot get data pointer of 'double' objects

This is particularly strange because the internal CHKVEC() function is
supposed to check for REALSXP vectors and pass them through. Such
"impossible" errors could be signs of a protection error. (Well, any
memory corruption, but arbitrary memory corruption is harder to
diagnose, so let's hope it's something to do with the garbage
collector.) Let's run the test suite check using a build of R-devel
compiled with .../configure --enable-strict-barrier.


testthat::test_check("xgboost")
# <...>
# Fatal error: Wrong thread calling 'RunFinalizers'
# Fatal error: Wrong thread calling 'RunFinalizers'
# Fatal error: Wrong thread calling 'RunFinalizers'
# Fatal error: Wrong thread calling 'RunFinalizers'
# Fatal error: Wrong thread calling 'RunFinalizers'
# Segmentation fault

Hmm.

Setting a breakpoint in Rstd_Suicide reveals the mistake. It's not a
protection error; it's R API being called from an OpenMP thread:

#5  ALTVEC_DATAPTR (x=0x2d825f58) at ../../../R/src/main/altrep.c:376
#6  0x00007fbbd1e5ed98 in operator() (__closure=<synthetic pointer>,
    i=<optimized out>) at xgboost_R.cc:258
#7  dmlc::OMPException::Run<XGDMatrixSetInfo_R(SEXP, SEXP, SEXP)::<lambda(xgboost::omp_ulong)>, int> (this=0x7fffbfaef760, f=...)
    at ./dmlc-core/include/dmlc/common.h:67
#8  _ZN7xgboost6common11ParallelForIiZ18XGDMatrixSetInfo_REUlmE0_EEvT_iNS0_5SchedET0_._omp_fn.3(void) ()
    at ./dmlc-core/include/../../src/common/threading_utils.h:208
#9  0x00007fbbd4552a0e in gomp_thread_start (xdata=<optimized out>)
    at ../../../libgomp/team.c:129
(gdb) frame 5
#5  ALTVEC_DATAPTR (x=0x2d825f58) at ../../../R/src/main/altrep.c:376
376         return ALTVEC_DATAPTR_EX(x, TRUE);
(gdb) call R_inspect(x)
@2d825f58 14 REALSXP g0c0 [REF(65535)]  1 : 9 (expanded)

The code would be better served by calling REAL_RO / INTEGER_RO once
and then using the returned pointer inside the OpenMP threads.

--
Best regards,
Ivan

	[[alternative HTML version deleted]]


From ty|ermw @end|ng |rom gm@||@com  Sat May 10 18:34:40 2025
From: ty|ermw @end|ng |rom gm@||@com (Tyler)
Date: Sat, 10 May 2025 12:34:40 -0400
Subject: [R-pkg-devel] CMake not on the PATH on CRAN macOS build/check
 servers?
Message-ID: <CAJhwqzSAA65G=vRSt3+Zv_27RLgS9zVH4ZqtPa2SjLTDJcMtAg@mail.gmail.com>

I recently submitted the package `libdeflate`, which successfully made
its way to the CRAN
(https://cran.r-project.org/web/packages/libdeflate/index.html) but
has failed to install on macOS:

https://cran.r-project.org/web/checks/check_results_libdeflate.html

Specifically, installation requires CMake, which is checked for during
the configure step with Sys.which("cmake"). This returns "" on macOS,
indicating it was not found. Note that cmake is indeed listed as a
SystemRequirement in the DESCRIPTION.

https://www.r-project.org/nosvn/R.check/r-release-macos-arm64/libdeflate-00install.html

* installing *source* package ?libdeflate? ...
** this is package ?libdeflate? version ?1.23.0?
** package ?libdeflate? successfully unpacked and MD5 sums checked
** using staged installation
** preparing to configure package 'libdeflate' ...
sh: : command not found
Error in eval(parse(text = contents), envir = envir) :
  CMake configure step failed
Calls: source_file -> eval -> eval
In addition: Warning messages:
1: In normalizePath(Sys.which("cmake"), winslash = "/") :
  path[1]="": No such file or directory
2: In system2(CMAKE, cmake_cfg) : error in running command
Execution halted
ERROR: configuration failed for package ?libdeflate?

I see that WRE also recommends checking
"/Applications/CMake.app/Contents/bin/cmake" on macOS. Before
submitting an update, though, it would be nice if someone could
confirm where cmake is located on the CRAN macOS environment so I can
be sure the fix will be successful.

Tyler


From edd @end|ng |rom deb|@n@org  Sat May 10 19:29:59 2025
From: edd @end|ng |rom deb|@n@org (Dirk Eddelbuettel)
Date: Sat, 10 May 2025 12:29:59 -0500
Subject: [R-pkg-devel] CMake not on the PATH on CRAN macOS build/check
 servers?
In-Reply-To: <CAJhwqzSAA65G=vRSt3+Zv_27RLgS9zVH4ZqtPa2SjLTDJcMtAg@mail.gmail.com>
References: <CAJhwqzSAA65G=vRSt3+Zv_27RLgS9zVH4ZqtPa2SjLTDJcMtAg@mail.gmail.com>
Message-ID: <26655.36119.760105.939432@rob.eddelbuettel.com>


On 10 May 2025 at 12:34, Tyler wrote:
| I recently submitted the package `libdeflate`, which successfully made
| its way to the CRAN
| (https://cran.r-project.org/web/packages/libdeflate/index.html) but
| has failed to install on macOS:
[...]
| I see that WRE also recommends checking
| "/Applications/CMake.app/Contents/bin/cmake" on macOS. Before
| submitting an update, though, it would be nice if someone could
| confirm where cmake is located on the CRAN macOS environment so I can
| be sure the fix will be successful.

It's a common issue, it's documented, and a pothole I also fell into not that
long ago. So here is a very simple script `configure` I use to check, and
then adjust src/Makevars, in package crc32c (which wraps a small external
library of the same name). You will note it credits Reed from an earlier
discussion on this very list.

-----------------------------------------------------------------------------
#!/bin/sh

## With thanks to Reed A. Cartwright on r-package-devel on 2023-05-10
## Also end of Writing R Extensions, Section 1.2.6 'Using `cmake`'

if test -z "$CMAKE"; then
   # Look for a cmake binary in the current path
   CMAKE=`which cmake 2>/dev/null`
fi
if test -z "$CMAKE"; then
   # Check for a MacOS specific path
   CMAKE=`which /Applications/CMake.app/Contents/bin/cmake 2>/dev/null`
fi
if test -f "$CMAKE"; then
   echo "** cmake is ${CMAKE}"
else   
   echo "The 'cmake' program is required but not found."
   exit 1
fi   

sed -e "s|@cmake@|${CMAKE}|" src/Makevars.in > src/Makevars
-----------------------------------------------------------------------------


By the way, a hidden gem of documentation is the ability to search all
current CRAN packages with the mirror at https://github.com/cran/

Cheers, Dirk

-- 
dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From |orenzo@@o@tero @end|ng |rom un|b@@|t  Sat May 10 16:48:16 2025
From: |orenzo@@o@tero @end|ng |rom un|b@@|t (Lorenzo Sostero)
Date: Sat, 10 May 2025 16:48:16 +0200
Subject: [R-pkg-devel] Failed test automatic checks CRAN
Message-ID: <CAGeL3J3WWw=ZZPutC6G7fF0Wyf9johLqNa6b6fBxd261ZvpDnA@mail.gmail.com>

Dear experts,

In the automatic checks performed by CRAN, I obtain the following error:

====================================================

package EmiR_1.0.5.tar.gz does not pass the incoming checks automatically,
please see the following pre-tests (additional issue checks):
Windows: <
https://win-builder.r-project.org/incoming_pretest/EmiR_1.0.5_20250507_204028/Windows/00check.log
>
Status: 1 ERROR, 2 NOTEs
Debian: <
https://win-builder.r-project.org/incoming_pretest/EmiR_1.0.5_20250507_204028/Debian/00check.log
>
Status: 1 ERROR, 2 NOTEs

Last released version's CRAN status: NOTE: 13
See: <https://CRAN.R-project.org/web/checks/check_results_EmiR.html
<https://cran.r-project.org/web/checks/check_results_EmiR.html>
<https://cran.r-project.org/web/checks/check_results_EmiR.html>>

CRAN Web: <https://cran.r-project.org/package=EmiR>

More details are given in the directory:
<
https://win-builder.r-project.org/incoming_pretest/EmiR_1.0.5_20250507_204028/
>

Flavor: r-devel-windows-x86_64
Check: tests, Result: ERROR
    Running 'testthat.R'
  Running the tests in 'tests/testthat.R' failed.
  Complete output:
    > library(testthat)
    > library(EmiR)
    > test_check("EmiR")
    0%   10   20   30   40   50   60   70   80   90   100%
    [----|----|----|----|----|----|----|----|----|----|


Flavor: r-devel-linux-x86_64-debian-gcc
Check: tests, Result: ERROR
    Running 'testthat.R' [1s/1s]
  Running the tests in 'tests/testthat.R' failed.
  Complete output:
    > library(testthat)
    > library(EmiR)
    > test_check("EmiR")
    0%   10   20   30   40   50   60   70   80   90   100%
    [----|----|----|----|----|----|----|----|----|----|
    [ FAIL 2 | WARN 1 | SKIP 0 | PASS 96 ]

    ?? Failed tests
????????????????????????????????????????????????????????????????
    ?? Failure:
???????????????????????????????????????????????????????????????????
    C stack usage  316451980572 is too close to the limit
    ?? Error ('test-cpp.R:1:1'): (code run outside of `test_that()`)
???????????????
    Error in `path_to_connection(x)`: '' does not exist in current working
directory
    ('/srv/hornik/tmp/CRAN_pretest/EmiR.Rcheck/tests/testthat').
    Backtrace:
        ?
     1. ??testthat::run_cpp_tests("EmiR") at test-cpp.R:1:1
     2.   ??xml2::read_xml(paste(output, collapse = "\n"))
     3.   ??xml2:::read_xml.character(paste(output, collapse = "\n"))
     4.     ??xml2:::path_to_connection(x)
     5.       ??xml2:::check_path(path)
     6.         ??cli::cli_abort(msg, call = call)
     7.           ??rlang::abort(...)

    [ FAIL 2 | WARN 1 | SKIP 0 | PASS 96 ]
    Error: Test failures
    Execution halted
    Segmentation fault

====================================================

I cannot reproduce the same error by testing the package on a Windows and
macOS machine. Any suggestions on how to fix the error?

Best regards, Lorenzo.

-- 




Informativa sulla Privacy:?https://www.unibs.it/it/node/1452 
<https://www.unibs.it/it/node/1452>

	[[alternative HTML version deleted]]


From |kry|ov @end|ng |rom d|@root@org  Sun May 11 23:23:28 2025
From: |kry|ov @end|ng |rom d|@root@org (Ivan Krylov)
Date: Mon, 12 May 2025 00:23:28 +0300
Subject: [R-pkg-devel] Failed test automatic checks CRAN
In-Reply-To: <CAGeL3J3WWw=ZZPutC6G7fF0Wyf9johLqNa6b6fBxd261ZvpDnA@mail.gmail.com>
References: <CAGeL3J3WWw=ZZPutC6G7fF0Wyf9johLqNa6b6fBxd261ZvpDnA@mail.gmail.com>
Message-ID: <20250512002328.5825fe7a@Tarkus>

On Sat, 10 May 2025 16:48:16 +0200
Lorenzo Sostero <lorenzo.sostero at unibs.it> wrote:

> Flavor: r-devel-windows-x86_64
> Check: tests, Result: ERROR
>     Running 'testthat.R'
>   Running the tests in 'tests/testthat.R' failed.
>   Complete output:
>     > library(testthat)
>     > library(EmiR)
>     > test_check("EmiR")  
>     0%   10   20   30   40   50   60   70   80   90   100%
>     [----|----|----|----|----|----|----|----|----|----|

The process crashes trying to access the contents of a zero-length
vector:

Thread 1 received signal SIGSEGV, Segmentation fault.
[Switching to Thread 1564.0x634]
0x00007ff81e1409df in PSPopulation::init (this=this at entry=0xf243ff59d0)
(gdb) info locals
j = 0
i = 0
progress_bar = <optimized out>
delta = 10.4
pop_size = <optimized out>
d = 4
alpha = {<Rcpp::PreserveStorage<Rcpp::Vector<14,
Rcpp::PreserveStorage>>> = {
 data = 0x2d9ce6732e8, token = 0x2d9ce66d5c0}, <...>,
 cache = {start = 0x1, size = 0}}
(gdb) frame 1
#1  0x00007ff81e0f7b4c in ____C_A_T_C_H____T_E_S_T____0 ()
    at test-example.cpp:106
106       pop_noseed1.init();
(gdb) p (R_xlen_t)XLENGTH(pop_noseed1.m_config.m_alpha.data)
$7 = 0
(gdb) p (double*)REAL(pop_noseed1.m_config.m_alpha.data)
$8 = (double *) 0x1

This should be reproducible on R-4.5.0 or R-devel without extra
configuration flags. Previously this used to read some other memory
that didn't belong to the vector; now the data pointers of such vectors
are invalid, so dereferencing them causes a crash:
https://stat.ethz.ch/pipermail/r-devel/2025-April/083994.html
 
For your future questions: when asking for help with code, it's best to
provide a link to the code in question. This time, it was possible to
find the package at <https://cran.r-project.org/incoming/archive/>.

-- 
Best regards,
Ivan


From A@Comber @end|ng |rom |eed@@@c@uk  Mon May 12 14:01:24 2025
From: A@Comber @end|ng |rom |eed@@@c@uk (Alexis Comber)
Date: Mon, 12 May 2025 12:01:24 +0000
Subject: [R-pkg-devel] 
 [CRAN-pretest-archived] CRAN Submission stgam 1.0.0
In-Reply-To: <01dbc094$Blat.v3.2.24$5f9903a5$2f0804045@mail.statistik.tu-dortmund.de>
References: <20250509025337.33B8DA01D4@xmpalantir.wu.ac.at>
 <01dbc094$Blat.v3.2.24$5f9903a5$2f0804045@mail.statistik.tu-dortmund.de>
Message-ID: <60BF94D7-69EB-44B8-9F97-85EB578B9620@leeds.ac.uk>

I am new to creating R packages and would welcome some advice.

I am trying to update a package but my submission fails and am not sure how to proceed.
The old `stgam` package (v 0.0.1.2) is failing - see https://cran.r-project.org/web/checks/check_results_stgam.html
The new `stgam` package (v 1.0.0) is not failing - see  https://win-builder.r-project.org/incoming_pretest/stgam_1.0.0_20250509_045337/Windows/00check.log and https://win-builder.r-project.org/incoming_pretest/stgam_1.0.0_20250509_045337/Debian/00check.log

I would like to upload my v 1.0.0 to CRAN. How do I resolve this?

With thanks, Lex

Prof. Lex Comber | Professor of Spatial Data Analytics | School of Geography | University of Leeds | Leeds | LS2 9JT | UK | email: a.comber at leeds.ac.uk
(note: I work Monday to Thursday)

On 9 May 2025, at 04:42, ligges at statistik.tu-dortmund.de wrote:

CAUTION: External Message. Use caution opening links and attachments.

Dear maintainer,

package stgam_1.0.0.tar.gz does not pass the incoming checks automatically, please see the following pre-tests (additional issue checks):
Windows: https://win-builder.r-project.org/incoming_pretest/stgam_1.0.0_20250509_045337/Windows/00check.log
Status: OK
Debian: https://win-builder.r-project.org/incoming_pretest/stgam_1.0.0_20250509_045337/Debian/00check.log
Status: OK

Last released version's CRAN status: OK: 3, NOTE: 10
See: https://cran.r-project.org/web/checks/check_results_stgam.html

CRAN Web: https://cran.r-project.org/web/packages/stgam/index.html

More details are given in the directory:

https://win-builder.r-project.org/incoming_pretest/stgam_1.0.0_20250509_045337/

The files will be removed after roughly 7 days.

No strong reverse dependencies to be checked.

Best regards,
CRAN teams' auto-check service
Flavor: r-devel-windows-x86_64
Check: *, Result: NA


Flavor: r-devel-windows-x86_64
Check: Overall checktime, Result: NOTE
 Overall checktime 22 min > 10 min

Flavor: r-devel-linux-x86_64-debian-gcc
Check: *, Result: OK



	[[alternative HTML version deleted]]


From ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de  Mon May 12 16:13:26 2025
From: ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de (Uwe Ligges)
Date: Mon, 12 May 2025 16:13:26 +0200
Subject: [R-pkg-devel] 
 [CRAN-pretest-archived] CRAN Submission stgam 1.0.0
In-Reply-To: <60BF94D7-69EB-44B8-9F97-85EB578B9620@leeds.ac.uk>
References: <20250509025337.33B8DA01D4@xmpalantir.wu.ac.at>
 <01dbc094$Blat.v3.2.24$5f9903a5$2f0804045@mail.statistik.tu-dortmund.de>
 <60BF94D7-69EB-44B8-9F97-85EB578B9620@leeds.ac.uk>
Message-ID: <cfa38edd-248e-4bd8-8f5b-e1bb16db8896@statistik.tu-dortmund.de>

We see

* checking re-building of vignette outputs ... [20m] OK

and overall, checktime is limited to 10 min.

Please reduce the vignette build timings by using
  - small toy data only
  - few iterations
  - or by providing precomputed results for the most lengthy parts. 
Otherwise we cannot afford checking the vignette regularly on CRAN.

Best,
Uwe Ligges



On 12.05.2025 14:01, Alexis Comber wrote:
> I am new to creating R packages and would welcome some advice.
> 
> I am trying to update a package but my submission fails and am not sure how to proceed.
> The old `stgam` package (v 0.0.1.2) is failing - see https://cran.r-project.org/web/checks/check_results_stgam.html
> The new `stgam` package (v 1.0.0) is not failing - see  https://win-builder.r-project.org/incoming_pretest/stgam_1.0.0_20250509_045337/Windows/00check.log and https://win-builder.r-project.org/incoming_pretest/stgam_1.0.0_20250509_045337/Debian/00check.log
> 
> I would like to upload my v 1.0.0 to CRAN. How do I resolve this?
> 
> With thanks, Lex
> 
> Prof. Lex Comber | Professor of Spatial Data Analytics | School of Geography | University of Leeds | Leeds | LS2 9JT | UK | email: a.comber at leeds.ac.uk
> (note: I work Monday to Thursday)
> 
> On 9 May 2025, at 04:42, ligges at statistik.tu-dortmund.de wrote:
> 
> CAUTION: External Message. Use caution opening links and attachments.
> 
> Dear maintainer,
> 
> package stgam_1.0.0.tar.gz does not pass the incoming checks automatically, please see the following pre-tests (additional issue checks):
> Windows: https://win-builder.r-project.org/incoming_pretest/stgam_1.0.0_20250509_045337/Windows/00check.log
> Status: OK
> Debian: https://win-builder.r-project.org/incoming_pretest/stgam_1.0.0_20250509_045337/Debian/00check.log
> Status: OK
> 
> Last released version's CRAN status: OK: 3, NOTE: 10
> See: https://cran.r-project.org/web/checks/check_results_stgam.html
> 
> CRAN Web: https://cran.r-project.org/web/packages/stgam/index.html
> 
> More details are given in the directory:
> 
> https://win-builder.r-project.org/incoming_pretest/stgam_1.0.0_20250509_045337/
> 
> The files will be removed after roughly 7 days.
> 
> No strong reverse dependencies to be checked.
> 
> Best regards,
> CRAN teams' auto-check service
> Flavor: r-devel-windows-x86_64
> Check: *, Result: NA
> 
> 
> Flavor: r-devel-windows-x86_64
> Check: Overall checktime, Result: NOTE
>   Overall checktime 22 min > 10 min
> 
> Flavor: r-devel-linux-x86_64-debian-gcc
> Check: *, Result: OK
> 
> 
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From jm@yu@n @end|ng |rom out|ook@com  Mon May 12 21:49:43 2025
From: jm@yu@n @end|ng |rom out|ook@com (Jiaming Yuan)
Date: Tue, 13 May 2025 03:49:43 +0800
Subject: [R-pkg-devel] CRAN Submission xgboost 1.7.11.1
In-Reply-To: <15bad58d-fd1d-493e-bfb8-ea3dd6d026e0@statistik.tu-dortmund.de>
References: <20250501105800.3FA5CA01B9@xmpalantir.wu.ac.at>
 <c8b1e3ed-bb68-4d29-b9e7-d33a20efd802@statistik.tu-dortmund.de>
 <OS3PR01MB8068DDDF251EA2D84352E2B2F68C2@OS3PR01MB8068.jpnprd01.prod.outlook.com>
 <51df8414-5cce-4eb4-a7f1-8499f52393af@statistik.tu-dortmund.de>
 <5d95cb36-dc9a-4a5b-b08a-182e1e321aad@statistik.tu-dortmund.de>
 <OS3PR01MB8068F43785E19BF9A1FFEAC5F68AA@OS3PR01MB8068.jpnprd01.prod.outlook.com>
 <OS3PR01MB8068A259CA4381B339A21302F68AA@OS3PR01MB8068.jpnprd01.prod.outlook.com>
 <1fab099c-3403-40ad-8cdb-10f697243733@statistik.tu-dortmund.de>
 <15bad58d-fd1d-493e-bfb8-ea3dd6d026e0@statistik.tu-dortmund.de>
Message-ID: <OS3PR01MB80682AFFBE63FE5A61C32C5DF697A@OS3PR01MB8068.jpnprd01.prod.outlook.com>

Hi Uwe,


Please help take a look into reproducing the failure if possible. We 
really appreciate your help. Thanks to Ivan, we managed to reproduce the 
memory protection error. But we haven't reproduced other test failures.


Cheers!

Jiaming

On 5/12/25 17:23, Uwe Ligges wrote:
> We realized this has already been answered by Ivan Krylov on the 
> r-packages-devel list.
>
> Best,
> Uwe Ligges
>
>
> On 12.05.2025 11:07, Uwe Ligges wrote:
>> I'll try to reproduce this locally.
>>
>>
>>
>> On 09.05.2025 06:22, jiaming yuan wrote:
>>> Hi CRAN,
>>>
>>> May I ask if someone has tried to reproduce the openblas test 
>>> environment from CRAN? We are trying to resolve the test failures of 
>>> XGBoost but so far no one has managed to reproduce them locally. 
>>> https://github.com/dmlc/xgboost/issues/11431
>>>
>>> Would be great if you can share some guidance on how to reproduce 
>>> that exact environment.
>>>
>>> Cheers
>>> Jiaming
>>> ________________________________
>>> From: jiaming yuan <jm.yuan at outlook.com>
>>> Sent: Friday, May 9, 2025 12:04:45 PM
>>> To: Uwe Ligges <ligges at statistik.tu-dortmund.de>; CRAN <cran- 
>>> submissions at r-project.org>
>>> Cc: CRAN Package Submission Form <cransubmit at xmbombadil.wu.ac.at>
>>> Subject: Re: CRAN Submission xgboost 1.7.11.1
>>>
>>> Hi,
>>>
>>> Others kindly provided help to reproduce the failure but so far no 
>>> one has managed to do so.
>>>
>>> Please see? https://github.com/dmlc/xgboost/ 
>>> issues/11431#issuecomment-2864947065? and related discussions the 
>>> thread. Would be great if you can share something more precise.
>>>
>>>
>>> Cheers
>>> Jiaming
>>>
>>> ________________________________
>>> From: Uwe Ligges <ligges at statistik.tu-dortmund.de>
>>> Sent: Wednesday, May 7, 2025 9:48:56 PM
>>> To: jiaming yuan <jm.yuan at outlook.com>; CRAN <cran-submissions at r- 
>>> project.org>
>>> Cc: CRAN Package Submission Form <cransubmit at xmbombadil.wu.ac.at>
>>> Subject: Re: CRAN Submission xgboost 1.7.11.1
>>>
>>> Note this is relevant, as most Linux clusters will have admis who will
>>> link scientifiv software aagainst OpenBLAS for faster matriox 
>>> operations.
>>>
>>> Best,
>>> Uwe Ligges
>>>
>>> On 07.05.2025 15:48, Uwe Ligges wrote:
>>>> I think any Liniux system with R linked against the system's default
>>>> OpenBLAS installation will show this issue.
>>>> I'd try it with a standard Ubuntu or Debian with OpenBLAS installed 
>>>> and
>>>> link agasinst it.
>>>>
>>>> Best,
>>>> Uwe Ligges
>>>>
>>>>
>>>>
>>>> On 03.05.2025 08:29, jiaming yuan wrote:
>>>>> Thank you for reaching out. We can't really dive into it unless
>>>>> there's an easier way to reproduce the environment (like a container
>>>>> or using some deterministic package managers). It's very unlikely 
>>>>> that
>>>>> we can try to build that environment on our own then try to fix all
>>>>> errors and verify all fixes.
>>>>>
>>>>>
>>>>>
>>>>> ________________________________
>>>>> From: Uwe Ligges <ligges at statistik.tu-dortmund.de>
>>>>> Sent: Friday, May 2, 2025 8:00:17 PM
>>>>> To: Jiaming Yuan <jm.yuan at outlook.com>; CRAN <cran-submissions at r-
>>>>> project.org>
>>>>> Cc: CRAN Package Submission Form <cransubmit at xmbombadil.wu.ac.at>
>>>>> Subject: Re: CRAN Submission xgboost 1.7.11.1
>>>>>
>>>>> Thanks, we see you removed lots of tests. Is this really sensible and
>>>>> are you sure that users with OpenBLAS (as most Linux users and 
>>>>> cluster
>>>>> admins will use) will get correct results? Sensibly relaxing 
>>>>> numerical
>>>>> assumptions may be a better way to tweak the tests.?
>>>>>
>>>>> Best,
>>>>> Uwe Ligges
>>>>>
>>>>>
>>>>> On 01.05.2025 12:58, CRAN Package Submission Form via 
>>>>> CRAN-submissions
>>>>> wrote:
>>>>>> [This was generated from CRAN.R-project.org/submit.html]
>>>>>>
>>>>>> The following package was uploaded to CRAN:
>>>>>> ===========================================
>>>>>>
>>>>>> Package Information:
>>>>>> Package: xgboost
>>>>>> Version: 1.7.11.1
>>>>>> Title: Extreme Gradient Boosting
>>>>>> Author(s): Tianqi Chen [aut], Tong He [aut], Michael Benesty [aut],
>>>>>> Vadim
>>>>>> Khotilovich [aut], Yuan Tang [aut]
>>>>>> (<https://orcid.org/0000-0001-5243-233X>), Hyunsu Cho [aut],
>>>>>> Kailong Chen [aut], Rory Mitchell [aut], Ignacio Cano [aut],
>>>>>> Tianyi Zhou [aut], Mu Li [aut], Junyuan Xie [aut], Min Lin
>>>>>> [aut], Yifeng Geng [aut], Yutian Li [aut], Jiaming Yuan [aut,
>>>>>> cre], XGBoost contributors [cph] (base XGBoost implementation)
>>>>>> Maintainer: Jiaming Yuan <jm.yuan at outlook.com>
>>>>>> Depends: R (>= 3.3.0)
>>>>>> Suggests: knitr, rmarkdown, ggplot2 (>= 1.0.1), DiagrammeR (>= 
>>>>>> 0.9.0),
>>>>>> Ckmeans.1d.dp (>= 3.3.1), vcd (>= 1.3), cplm, e1071, caret,
>>>>>> testthat, lintr, igraph (>= 1.0.1), float, crayon, titanic
>>>>>> Description: Extreme Gradient Boosting, which is an efficient
>>>>>> implementation of the gradient boosting framework from Chen &
>>>>>> Guestrin (2016) <doi:10.1145/2939672.2939785>. This package
>>>>>> is its R interface. The package includes efficient linear
>>>>>> model solver and tree learning algorithms. The package can
>>>>>> automatically do parallel computation on a single machine
>>>>>> which could be more than 10 times faster than existing
>>>>>> gradient boosting packages. It supports various objective
>>>>>> functions, including regression, classification and ranking.
>>>>>> The package is made to be extensible, so that users are also
>>>>>> allowed to define their own objectives easily.
>>>>>> License: Apache License (== 2.0) | file LICENSE
>>>>>> Imports: Matrix (>= 1.1-0), methods, data.table (>= 1.9.6), jsonlite
>>>>>> (>= 1.0),
>>>>>>
>>>>>>
>>>>>> The maintainer confirms that he or she
>>>>>> has read and agrees to the CRAN policies.
>>>>>>
>>>>>> =================================================
>>>>>>
>>>>>> Original content of DESCRIPTION file:
>>>>>>
>>>>>> Package: xgboost
>>>>>> Type: Package
>>>>>> Title: Extreme Gradient Boosting
>>>>>> Version: 1.7.11.1
>>>>>> Date: 2025-05-01
>>>>>> Authors at R: c(
>>>>>> person("Tianqi", "Chen", role = c("aut"),
>>>>>> email = "tianqi.tchen at gmail.com"),
>>>>>> person("Tong", "He", role = c("aut"),
>>>>>> email = "hetong007 at gmail.com"),
>>>>>> person("Michael", "Benesty", role = c("aut"),
>>>>>> email = "michael at benesty.fr"),
>>>>>> person("Vadim", "Khotilovich", role = c("aut"),
>>>>>> email = "khotilovich at gmail.com"),
>>>>>> person("Yuan", "Tang", role = c("aut"),
>>>>>> email = "terrytangyuan at gmail.com",
>>>>>> comment = c(ORCID = "0000-0001-5243-233X")),
>>>>>> person("Hyunsu", "Cho", role = c("aut"),
>>>>>> email = "chohyu01 at cs.washington.edu"),
>>>>>> person("Kailong", "Chen", role = c("aut")),
>>>>>> person("Rory", "Mitchell", role = c("aut")),
>>>>>> person("Ignacio", "Cano", role = c("aut")),
>>>>>> person("Tianyi", "Zhou", role = c("aut")),
>>>>>> person("Mu", "Li", role = c("aut")),
>>>>>> person("Junyuan", "Xie", role = c("aut")),
>>>>>> person("Min", "Lin", role = c("aut")),
>>>>>> person("Yifeng", "Geng", role = c("aut")),
>>>>>> person("Yutian", "Li", role = c("aut")),
>>>>>> person("Jiaming", "Yuan", role = c("aut", "cre"),
>>>>>> email = "jm.yuan at outlook.com"),
>>>>>> person("XGBoost contributors", role = c("cph"),
>>>>>> comment = "base XGBoost implementation")
>>>>>> )
>>>>>> Maintainer: Jiaming Yuan <jm.yuan at outlook.com>
>>>>>> Description: Extreme Gradient Boosting, which is an efficient
>>>>>> implementation
>>>>>> of the gradient boosting framework from Chen & Guestrin (2016)
>>>>>> <doi:10.1145/2939672.2939785>.
>>>>>> This package is its R interface. The package includes efficient 
>>>>>> linear
>>>>>> model solver and tree learning algorithms. The package can 
>>>>>> automatically
>>>>>> do parallel computation on a single machine which could be more 
>>>>>> than 10
>>>>>> times faster than existing gradient boosting packages. It supports
>>>>>> various objective functions, including regression, classification 
>>>>>> and
>>>>>> ranking.
>>>>>> The package is made to be extensible, so that users are also allowed
>>>>>> to define
>>>>>> their own objectives easily.
>>>>>> License: Apache License (== 2.0) | file LICENSE
>>>>>> URL: https://github.com/dmlc/xgboost
>>>>>> BugReports: https://github.com/dmlc/xgboost/issues
>>>>>> NeedsCompilation: yes
>>>>>> VignetteBuilder: knitr
>>>>>> Suggests: knitr, rmarkdown, ggplot2 (>= 1.0.1), DiagrammeR (>= 
>>>>>> 0.9.0),
>>>>>> Ckmeans.1d.dp (>= 3.3.1), vcd (>= 1.3), cplm, e1071, caret,
>>>>>> testthat, lintr, igraph (>= 1.0.1), float, crayon, titanic
>>>>>> Depends: R (>= 3.3.0)
>>>>>> Imports: Matrix (>= 1.1-0), methods, data.table (>= 1.9.6), jsonlite
>>>>>> (>= 1.0),
>>>>>> RoxygenNote: 7.3.2
>>>>>> Encoding: UTF-8
>>>>>> SystemRequirements: GNU make, C++17
>>>>>> Packaged: 2025-05-01 10:56:14 UTC; jiamingy
>>>>>> Author: Tianqi Chen [aut],
>>>>>> Tong He [aut],
>>>>>> Michael Benesty [aut],
>>>>>> Vadim Khotilovich [aut],
>>>>>> Yuan Tang [aut] (<https://orcid.org/0000-0001-5243-233X>),
>>>>>> Hyunsu Cho [aut],
>>>>>> Kailong Chen [aut],
>>>>>> Rory Mitchell [aut],
>>>>>> Ignacio Cano [aut],
>>>>>> Tianyi Zhou [aut],
>>>>>> Mu Li [aut],
>>>>>> Junyuan Xie [aut],
>>>>>> Min Lin [aut],
>>>>>> Yifeng Geng [aut],
>>>>>> Yutian Li [aut],
>>>>>> Jiaming Yuan [aut, cre],
>>>>>> XGBoost contributors [cph] (base XGBoost implementation)
>>>>>>
>>>>>
>>>>>
>>>>>
>>>>> ???? [[alternative HTML version deleted]]
>>>>>
>>>>
>>>
>>>
>>>
>>> ????[[alternative HTML version deleted]]
>>>
>>
>


From |oy@d01 @end|ng |rom gm@||@com  Mon May 12 23:45:10 2025
From: |oy@d01 @end|ng |rom gm@||@com (Adam Loy)
Date: Mon, 12 May 2025 16:45:10 -0500
Subject: [R-pkg-devel] Help passing CRAN pre-checks
Message-ID: <CA+b-ys3PhzFpcZ9TtDCFfAShKiGVr6SpyNtFg1Jm=UTZ0FgygQ@mail.gmail.com>

Hi all,

I am having trouble getting past the pre-checks for CRAN, but things check
out in my testing localling in the cloud. I get this message on Debian:

Error: package or namespace load failed for ?HLMdiag? in
dyn.load(file, DLLpath = DLLpath, ...):
 unable to load shared object
'/srv/hornik/tmp/CRAN_pretest/HLMdiag.Rcheck/00LOCK-HLMdiag/00new/HLMdiag/libs/HLMdiag.so':

/srv/hornik/tmp/CRAN_pretest/HLMdiag.Rcheck/00LOCK-HLMdiag/00new/HLMdiag/libs/HLMdiag.so:
undefined symbol: dgetri_
Error: loading failed

The package uses RcppArmadillo so I thought the issue was an error in
the makefile, but I think that checks out.

Any help would be appreciated. My codebase is on github:
https://github.com/aloy/HLMdiag


Thank you,

Adam

	[[alternative HTML version deleted]]


From edd @end|ng |rom deb|@n@org  Tue May 13 00:29:14 2025
From: edd @end|ng |rom deb|@n@org (Dirk Eddelbuettel)
Date: Mon, 12 May 2025 17:29:14 -0500
Subject: [R-pkg-devel] Help passing CRAN pre-checks
In-Reply-To: <CA+b-ys3PhzFpcZ9TtDCFfAShKiGVr6SpyNtFg1Jm=UTZ0FgygQ@mail.gmail.com>
References: <CA+b-ys3PhzFpcZ9TtDCFfAShKiGVr6SpyNtFg1Jm=UTZ0FgygQ@mail.gmail.com>
Message-ID: <26658.30266.215125.849394@rob.eddelbuettel.com>


On 12 May 2025 at 16:45, Adam Loy wrote:
| Hi all,
| 
| I am having trouble getting past the pre-checks for CRAN, but things check
| out in my testing localling in the cloud. I get this message on Debian:
| 
| Error: package or namespace load failed for ?HLMdiag? in
| dyn.load(file, DLLpath = DLLpath, ...):
|  unable to load shared object
| '/srv/hornik/tmp/CRAN_pretest/HLMdiag.Rcheck/00LOCK-HLMdiag/00new/HLMdiag/libs/HLMdiag.so':
| 
| /srv/hornik/tmp/CRAN_pretest/HLMdiag.Rcheck/00LOCK-HLMdiag/00new/HLMdiag/libs/HLMdiag.so:
| undefined symbol: dgetri_
| Error: loading failed
| 
| The package uses RcppArmadillo so I thought the issue was an error in
| the makefile, but I think that checks out.
| 
| Any help would be appreciated. My codebase is on github:
| https://github.com/aloy/HLMdiag

Rename src/Makevars.txt (a file that will be ignored with that extension) to
src/Makevars and your linking will be complete, and the load error above is
likely going away.

Dirk

-- 
dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From @m@||ep@||on @end|ng |rom proton@me  Tue May 13 19:05:14 2025
From: @m@||ep@||on @end|ng |rom proton@me (smallepsilon)
Date: Tue, 13 May 2025 17:05:14 +0000
Subject: [R-pkg-devel] Advice for addressing CRAN rejection
Message-ID: <6Xgzv9HbaJrtioSMI2xyarWrdceEVdLuT4cdONaU5d5iofwNzI-9lHxGhPAJT7QJfWin6qgx7f96pCL4j9fFyRXet-sS7wKIu68SNJzkmhs=@proton.me>

I have been trying to fix some issues with my package's testing on CRAN, which culminated in a rejection email from a CRAN administrator that I am not sure how to address.

The first issues arose with MKL. (I got helpful information about that recently on r-help.) In many package tests, I want to verify that two ways of specifying something lead to the execution of exactly the same calculations. I use identical() as a proxy for this, but because numeric results are not necessarily reproducible when using parallel processing, this does not work on all platforms.

My initial attempts to address this involved replacing the offending identical() calls with all.equal() calls. After two or three such attempts, I realized that because all.equal() does not test (even as a proxy) that the same calculations were done, it is impractical and unnecessary to run these tests on all of the CRAN platforms. I moved the original test files to a separate folder on my computer so I can run them all locally. (My assumption is that if the logic is correct on my computer, then it is correct on all of them, and identical() helps verify this.) In the newest package version uploaded to CRAN, I included the tests that verify the essential functionality of the package so that the crucial output values are the same on all platforms, up to a reasonable number of significant digits. These are the tests that are clearly important to run on all platforms.

My submission was rejected, not because of test failures, but because I had "removed the failing tests which is not the idea of tests." No errors/warnings/notes were reported to me. The only option I have been given is to replace identical() with all.equal(), which defeats the purpose of these particular tests.

I replied to the administrator's email with a brief version of all of this, but have not gotten a response. Any advice on what else I could do would be appreciated.

Thanks,

Jesse


From bbo|ker @end|ng |rom gm@||@com  Tue May 13 20:41:19 2025
From: bbo|ker @end|ng |rom gm@||@com (Ben Bolker)
Date: Tue, 13 May 2025 14:41:19 -0400
Subject: [R-pkg-devel] Advice for addressing CRAN rejection
In-Reply-To: <6Xgzv9HbaJrtioSMI2xyarWrdceEVdLuT4cdONaU5d5iofwNzI-9lHxGhPAJT7QJfWin6qgx7f96pCL4j9fFyRXet-sS7wKIu68SNJzkmhs=@proton.me>
References: <6Xgzv9HbaJrtioSMI2xyarWrdceEVdLuT4cdONaU5d5iofwNzI-9lHxGhPAJT7QJfWin6qgx7f96pCL4j9fFyRXet-sS7wKIu68SNJzkmhs=@proton.me>
Message-ID: <CABghstTA+GpVwqGNUmNS944HMV4h3RBoAbTPDuWEV-JDV-Y5Xg@mail.gmail.com>

Can you please clarify (maybe by linking back to an earlier thread, don't
remember if you discussed this previously) what you mean by "I realized
that because all.equal() does not test (even as a proxy) that the same
calculations were done"?

On Tue, May 13, 2025, 1:05 PM smallepsilon <smallepsilon at proton.me> wrote:

> I have been trying to fix some issues with my package's testing on CRAN,
> which culminated in a rejection email from a CRAN administrator that I am
> not sure how to address.
>
> The first issues arose with MKL. (I got helpful information about that
> recently on r-help.) In many package tests, I want to verify that two ways
> of specifying something lead to the execution of exactly the same
> calculations. I use identical() as a proxy for this, but because numeric
> results are not necessarily reproducible when using parallel processing,
> this does not work on all platforms.
>
> My initial attempts to address this involved replacing the offending
> identical() calls with all.equal() calls. After two or three such attempts,
> I realized that because all.equal() does not test (even as a proxy) that
> the same calculations were done, it is impractical and unnecessary to run
> these tests on all of the CRAN platforms. I moved the original test files
> to a separate folder on my computer so I can run them all locally. (My
> assumption is that if the logic is correct on my computer, then it is
> correct on all of them, and identical() helps verify this.) In the newest
> package version uploaded to CRAN, I included the tests that verify the
> essential functionality of the package so that the crucial output values
> are the same on all platforms, up to a reasonable number of significant
> digits. These are the tests that are clearly important to run on all
> platforms.
>
> My submission was rejected, not because of test failures, but because I
> had "removed the failing tests which is not the idea of tests." No
> errors/warnings/notes were reported to me. The only option I have been
> given is to replace identical() with all.equal(), which defeats the purpose
> of these particular tests.
>
> I replied to the administrator's email with a brief version of all of
> this, but have not gotten a response. Any advice on what else I could do
> would be appreciated.
>
> Thanks,
>
> Jesse
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From @m@||ep@||on @end|ng |rom proton@me  Tue May 13 21:08:00 2025
From: @m@||ep@||on @end|ng |rom proton@me (smallepsilon)
Date: Tue, 13 May 2025 19:08:00 +0000
Subject: [R-pkg-devel] Advice for addressing CRAN rejection
In-Reply-To: <CABghstTA+GpVwqGNUmNS944HMV4h3RBoAbTPDuWEV-JDV-Y5Xg@mail.gmail.com>
References: <6Xgzv9HbaJrtioSMI2xyarWrdceEVdLuT4cdONaU5d5iofwNzI-9lHxGhPAJT7QJfWin6qgx7f96pCL4j9fFyRXet-sS7wKIu68SNJzkmhs=@proton.me>
 <CABghstTA+GpVwqGNUmNS944HMV4h3RBoAbTPDuWEV-JDV-Y5Xg@mail.gmail.com>
Message-ID: <ii8rfznsuStLO9wRzKlDbJIkcdR9fvDUtlOf4548fLxZuINIEATTafeuS6ZY29bUZH_F2uDLatGk5rWzAfp0vB8nAoSWy-s8dIZPFgZfR6A=@proton.me>

Ben,

The thread to which I alluded is here: https://stat.ethz.ch/pipermail/r-help/2025-May/480866.html

Further clarification: The package provides some convenience shortcuts for the user which should run the same calculations as their longer counterparts. I want to use identical() to provide strong evidence that this is happening. Suppose, for example, that X is a symmetric, positive definite matrix. Then identical() will usually distinguish between (X^1/2)^-1 and (X^-1)^1/2 (the kind of thing I want to be able to check) while all.equal() will generally not (unless I set the tolerance sufficiently low, but that is just making all.equal() behave more like identical()). Using all.equal() helps detect catastrophic errors, but those would be detected in other tests already.

Thanks,

Jesse


On Tuesday, May 13th, 2025 at 1:41 PM, Ben Bolker <bbolker at gmail.com> wrote:

> Can you please clarify (maybe by linking back to an earlier thread, don't remember if you discussed this previously) what you mean by "I realized that because all.equal() does not test (even as a proxy) that the same calculations were done"?
> 
> 
> On Tue, May 13, 2025, 1:05 PM smallepsilon <smallepsilon at proton.me> wrote:
> 
> > I have been trying to fix some issues with my package's testing on CRAN, which culminated in a rejection email from a CRAN administrator that I am not sure how to address.
> > 
> > The first issues arose with MKL. (I got helpful information about that recently on r-help.) In many package tests, I want to verify that two ways of specifying something lead to the execution of exactly the same calculations. I use identical() as a proxy for this, but because numeric results are not necessarily reproducible when using parallel processing, this does not work on all platforms.
> > 
> > My initial attempts to address this involved replacing the offending identical() calls with all.equal() calls. After two or three such attempts, I realized that because all.equal() does not test (even as a proxy) that the same calculations were done, it is impractical and unnecessary to run these tests on all of the CRAN platforms. I moved the original test files to a separate folder on my computer so I can run them all locally. (My assumption is that if the logic is correct on my computer, then it is correct on all of them, and identical() helps verify this.) In the newest package version uploaded to CRAN, I included the tests that verify the essential functionality of the package so that the crucial output values are the same on all platforms, up to a reasonable number of significant digits. These are the tests that are clearly important to run on all platforms.
> > 
> > My submission was rejected, not because of test failures, but because I had "removed the failing tests which is not the idea of tests." No errors/warnings/notes were reported to me. The only option I have been given is to replace identical() with all.equal(), which defeats the purpose of these particular tests.
> > 
> > I replied to the administrator's email with a brief version of all of this, but have not gotten a response. Any advice on what else I could do would be appreciated.
> > 
> > Thanks,
> > 
> > Jesse
> > 
> > ______________________________________________
> > R-package-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-package-devel


From bbo|ker @end|ng |rom gm@||@com  Wed May 14 03:07:43 2025
From: bbo|ker @end|ng |rom gm@||@com (Ben Bolker)
Date: Tue, 13 May 2025 21:07:43 -0400
Subject: [R-pkg-devel] Advice for addressing CRAN rejection
In-Reply-To: <ii8rfznsuStLO9wRzKlDbJIkcdR9fvDUtlOf4548fLxZuINIEATTafeuS6ZY29bUZH_F2uDLatGk5rWzAfp0vB8nAoSWy-s8dIZPFgZfR6A=@proton.me>
References: <6Xgzv9HbaJrtioSMI2xyarWrdceEVdLuT4cdONaU5d5iofwNzI-9lHxGhPAJT7QJfWin6qgx7f96pCL4j9fFyRXet-sS7wKIu68SNJzkmhs=@proton.me>
 <CABghstTA+GpVwqGNUmNS944HMV4h3RBoAbTPDuWEV-JDV-Y5Xg@mail.gmail.com>
 <ii8rfznsuStLO9wRzKlDbJIkcdR9fvDUtlOf4548fLxZuINIEATTafeuS6ZY29bUZH_F2uDLatGk5rWzAfp0vB8nAoSWy-s8dIZPFgZfR6A=@proton.me>
Message-ID: <57123dcb-8d51-4997-8b80-ebfbf6362b48@gmail.com>

    Hmm. The thread you linked to is specifically an issue with 
non-deterministic linear algebra, the solution to which is to disable 
threaded computations. I don't think CRAN multithreads by default (and I 
don't know if they test on MKL at all ...?)

   Can you provide more specific/concrete examples of the tests? (Again, 
I apologize if there were examples posted up-thread -- I'm too lazy to 
search for them.) I'm not quite sure I understand your comment about

 > Suppose, for example, that X is a symmetric, positive definite 
matrix. Then identical() will usually distinguish between (X^1/2)^-1 and 
(X^-1)^1/2 (the kind of thing I want to be able to check) while 
all.equal() will generally not


    What is X^1/2? (There are infinitely many ways to take a matrix 
square root ...) Interpreting X^(1/2) as chol(X) and X^(-1) as solve(X), 
these are not even close:

 > set.seed(101); m <- crossprod(matrix(rnorm(9), 3, 3))
 > all.equal(solve(chol(m)), chol(solve(m)))
[1] "Mean relative difference: 0.6655765"


   In general "convenience shortcuts" that do any kind of rearranging of 
a floating point computation **cannot** be guaranteed to be identical; 
this is a corollary of

https://cran.r-project.org/doc/FAQ/R-FAQ.html#Why-doesn_0027t-R-think-these-numbers-are-equal_003f

See also 
https://stackoverflow.com/questions/9508518/why-are-these-numbers-not-equal/9508558#9508558

(e.g., floating-point addition is not associative)

   I apologize if this sounds basic/is telling you something you already 
know, but from what I can understand of your questions so far, you are 
asking for something that is not possible in general.

   Can you clarify further please?

   cheers
    Ben Bolker



On 5/13/25 15:08, smallepsilon wrote:
> Ben,
> 
> The thread to which I alluded is here: https://stat.ethz.ch/pipermail/r-help/2025-May/480866.html
> 
> Further clarification: The package provides some convenience shortcuts for the user which should run the same calculations as their longer counterparts. I want to use identical() to provide strong evidence that this is happening. Suppose, for example, that X is a symmetric, positive definite matrix. Then identical() will usually distinguish between (X^1/2)^-1 and (X^-1)^1/2 (the kind of thing I want to be able to check) while all.equal() will generally not (unless I set the tolerance sufficiently low, but that is just making all.equal() behave more like identical()). Using all.equal() helps detect catastrophic errors, but those would be detected in other tests already.
> 
> Thanks,
> 
> Jesse
> 
> 
> On Tuesday, May 13th, 2025 at 1:41 PM, Ben Bolker <bbolker at gmail.com> wrote:
> 
>> Can you please clarify (maybe by linking back to an earlier thread, don't remember if you discussed this previously) what you mean by "I realized that because all.equal() does not test (even as a proxy) that the same calculations were done"?
>>
>>
>> On Tue, May 13, 2025, 1:05 PM smallepsilon <smallepsilon at proton.me> wrote:
>>
>>> I have been trying to fix some issues with my package's testing on CRAN, which culminated in a rejection email from a CRAN administrator that I am not sure how to address.
>>>
>>> The first issues arose with MKL. (I got helpful information about that recently on r-help.) In many package tests, I want to verify that two ways of specifying something lead to the execution of exactly the same calculations. I use identical() as a proxy for this, but because numeric results are not necessarily reproducible when using parallel processing, this does not work on all platforms.
>>>
>>> My initial attempts to address this involved replacing the offending identical() calls with all.equal() calls. After two or three such attempts, I realized that because all.equal() does not test (even as a proxy) that the same calculations were done, it is impractical and unnecessary to run these tests on all of the CRAN platforms. I moved the original test files to a separate folder on my computer so I can run them all locally. (My assumption is that if the logic is correct on my computer, then it is correct on all of them, and identical() helps verify this.) In the newest package version uploaded to CRAN, I included the tests that verify the essential functionality of the package so that the crucial output values are the same on all platforms, up to a reasonable number of significant digits. These are the tests that are clearly important to run on all platforms.
>>>
>>> My submission was rejected, not because of test failures, but because I had "removed the failing tests which is not the idea of tests." No errors/warnings/notes were reported to me. The only option I have been given is to replace identical() with all.equal(), which defeats the purpose of these particular tests.
>>>
>>> I replied to the administrator's email with a brief version of all of this, but have not gotten a response. Any advice on what else I could do would be appreciated.
>>>
>>> Thanks,
>>>
>>> Jesse
>>>
>>> ______________________________________________
>>> R-package-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel

-- 
Dr. Benjamin Bolker
Professor, Mathematics & Statistics and Biology, McMaster University
Director, School of Computational Science and Engineering
* E-mail is sent at my convenience; I don't expect replies outside of 
working hours.


