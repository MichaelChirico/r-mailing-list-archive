From jr@| @end|ng |rom po@teo@no  Thu Apr  1 00:51:07 2021
From: jr@| @end|ng |rom po@teo@no (Rasmus Liland)
Date: Thu, 1 Apr 2021 00:51:07 +0200
Subject: [R-pkg-devel] Debugging RODBC installation problems on FreeBSD
 (unixodbc library path)
In-Reply-To: <24675.10843.893251.372051@rob.eddelbuettel.com>
References: <YGJGHehazrzCror7@posteo.no>
 <24674.20381.94259.3434@rob.eddelbuettel.com>
 <YGJd1Eg8G8VovS5h@posteo.no>
 <24675.10843.893251.372051@rob.eddelbuettel.com>
Message-ID: <YGT824c0H2e7N+Gt@posteo.no>

Hello there again,

I found (in --help) the `R CMD INSTALL` 
flag `--configure-args`, and were 
successfully able to install it:

	R CMD INSTALL RODBC --configure-args=--with-odbc-manager=odbc

Rasmus

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 833 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-package-devel/attachments/20210401/6766a0ba/attachment.sig>

From thu|@en @end|ng |rom gm@||@com  Thu Apr  1 07:55:51 2021
From: thu|@en @end|ng |rom gm@||@com (Tim Hulsen)
Date: Thu, 1 Apr 2021 07:55:51 +0200
Subject: [R-pkg-devel] 
 checking LazyData ... NOTE 'LazyData' is specified
 without a 'data' directory
In-Reply-To: <e0316015-f0e5-2600-4c84-ffdc5156b687@gmail.com>
References: <87bd6ba2-86b4-94f5-d7e9-fa18dc16bcbb@gmail.com>
 <13249B2D-8CA2-443F-A274-319A813403BF@gmail.com>
 <e0316015-f0e5-2600-4c84-ffdc5156b687@gmail.com>
Message-ID: <CAHMN1Py2_TG4zGtEH0J8MbiBm7voWZLf4q9SRt5zjzgjj82Y8g@mail.gmail.com>

r-release-windows-ix86+x86_64

Op wo 31 mrt. 2021 om 14:31 schreef Duncan Murdoch <murdoch.duncan at gmail.com
>:

> On 31/03/2021 8:28 a.m., Tim Hulsen wrote:
> > I don?t believe I do anything with lazydata.
>
> Your DESCRIPTION file specifies it is TRUE.
>
> Duncan Murdoch
>
> >
> > https://cran.r-project.org/web/checks/check_results_BioVenn.html
> > <https://cran.r-project.org/web/checks/check_results_BioVenn.html>
> >
> >
> >
> >> Op 31 mrt. 2021 om 14:24 heeft Duncan Murdoch
> >> <murdoch.duncan at gmail.com> het volgende geschreven:
> >>
> >> ?On 31/03/2021 5:55 a.m., Tim Hulsen wrote:
> >>> When submitting my package to CRAN, I get the message:
> >>> checking LazyData ... NOTE
> >>> 'LazyData' is specified without a 'data' directory
> >>> What can i do about this?
> >>
> >> Don't specify LazyData.  If that doesn't help, give us a bit more
> >> information, e.g. a link to your source.
> >>
> >> Duncan Murdoch
>
>

	[[alternative HTML version deleted]]


From peter@ruckde@che| @end|ng |rom web@de  Thu Apr  1 12:11:17 2021
From: peter@ruckde@che| @end|ng |rom web@de (Peter Ruckdeschel)
Date: Thu, 1 Apr 2021 12:11:17 +0200
Subject: [R-pkg-devel] Lazy data compression for packages without data folder
Message-ID: <e7ddc148-15b1-b798-1ba7-31a21eb4a2a0@web.de>

Hi,  

I just noticed that, last week-end, R CMD build was changed to remove ?LazyData? and
?LazyDataCompression? fields from the ?DESCRIPTION? file of packages without a ?data?
directory.

Now, in our package "RobAStRDA" published on CRAN in version 1.2.0 2019-03-11, we 
deliberately do have a ?LazyData? field in the ?DESCRIPTION? file of the package
without a ?data? folder.

This package just contains a sysdata.rda file with a large amount of interpolation grids
and functions not to be analyzed as statistical data but rather to be used for speed-ups
in our package "RobExtremes" (also on CRAN).

What is the recommended way to achieve this, i.e., use the sysdata.rda file in compressed
form and in lazy data format without placing it into a ?data? folder?

Any suggestions welcome,
best regards, Peter (Ruckdeschel)


From b@g@r|@@@|ddh@rth@ @end|ng |rom gm@||@com  Thu Apr  1 17:07:54 2021
From: b@g@r|@@@|ddh@rth@ @end|ng |rom gm@||@com (Siddhartha Bagaria)
Date: Thu, 1 Apr 2021 11:07:54 -0400
Subject: [R-pkg-devel] Best practices for PKG_LIBS and PKG_CPPFLAGS
Message-ID: <CAK68aVVU_V2uduNfEcjzL_KECgT5c2U_VgZ9WeZae1iwKEo=DA@mail.gmail.com>

Hello,

I have an atypical use case in which I have a build system
<https://github.com/grailbio/rules_r/> that can build C shared libraries
that will be used by the native code in an R package, and build both C
libraries and R packages in one user command. As these shared libraries are
specified by the build system itself, I do not want to assume their names
and locations in the R package src/Makevars. Going through the configure
script mechanism is not straightforward for arbitrary R packages that can
be used in the build system, because all user input is pre-specified before
the build steps are run, and so the shared library names and locations may
not be available when the user is specifying the build, or the configure
script may not be flexible enough to take such input from the user.

My question is if there is any guidance on what is the best way to set
PKG_LIBS and PKG_CPPFLAGS variables from the command line rather than
expecting them in the package src/Makevars? As part of my build system,
even if I create or edit the package src/Makevars, it could be replaced or
changed in arbitrary ways by the configure script.

So far, I have been exporting PKG_LIBS and PKG_CPPFLAGS as environment
variables before running R CMD INSTALL (my build script
<https://github.com/grailbio/rules_r/blob/d4b3a80bba49c5b540e72ca3a9fcc9ef1e5af93c/R/scripts/build.sh#L191>),
and then assuming that if the user has these variables in the package
src/Makevars, then they are appending to an existing list (e.g. by using
`+=`), rather than replacing it (by using `=`). But I am not sure if this
is the best way.

It could be that I am thinking about this all wrong, so would appreciate
some guidance.

There has been some discussion on how to do this best on Github
<https://github.com/RcppCore/RcppArmadillo/pull/331>, but we thought it
would be best if we started a discussion here.

Thank you.

Siddhartha

	[[alternative HTML version deleted]]


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Thu Apr  1 18:04:27 2021
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Thu, 01 Apr 2021 09:04:27 -0700
Subject: [R-pkg-devel] Lazy data compression for packages without data
 folder
In-Reply-To: <e7ddc148-15b1-b798-1ba7-31a21eb4a2a0@web.de>
References: <e7ddc148-15b1-b798-1ba7-31a21eb4a2a0@web.de>
Message-ID: <6102F11A-D802-480C-8A86-A1FFD1E60CF3@dcn.davis.ca.us>

I don't think those settings apply to that file. Search for "sysdata.rda" in [1].

[1] https://cran.r-project.org/doc/manuals/r-release/R-exts.html

On April 1, 2021 3:11:17 AM PDT, Peter Ruckdeschel <peter.ruckdeschel at web.de> wrote:
>Hi,  
>
>I just noticed that, last week-end, R CMD build was changed to remove
>?LazyData? and
>?LazyDataCompression? fields from the ?DESCRIPTION? file of packages
>without a ?data?
>directory.
>
>Now, in our package "RobAStRDA" published on CRAN in version 1.2.0
>2019-03-11, we 
>deliberately do have a ?LazyData? field in the ?DESCRIPTION? file of
>the package
>without a ?data? folder.
>
>This package just contains a sysdata.rda file with a large amount of
>interpolation grids
>and functions not to be analyzed as statistical data but rather to be
>used for speed-ups
>in our package "RobExtremes" (also on CRAN).
>
>What is the recommended way to achieve this, i.e., use the sysdata.rda
>file in compressed
>form and in lazy data format without placing it into a ?data? folder?
>
>Any suggestions welcome,
>best regards, Peter (Ruckdeschel)
>
>______________________________________________
>R-package-devel at r-project.org mailing list
>https://stat.ethz.ch/mailman/listinfo/r-package-devel

-- 
Sent from my phone. Please excuse my brevity.


From peter@ruckde@che| @end|ng |rom web@de  Thu Apr  1 18:40:33 2021
From: peter@ruckde@che| @end|ng |rom web@de (Peter Ruckdeschel)
Date: Thu, 1 Apr 2021 18:40:33 +0200
Subject: [R-pkg-devel] Lazy data compression for packages without data
 folder
In-Reply-To: <6102F11A-D802-480C-8A86-A1FFD1E60CF3@dcn.davis.ca.us>
References: <e7ddc148-15b1-b798-1ba7-31a21eb4a2a0@web.de>
 <6102F11A-D802-480C-8A86-A1FFD1E60CF3@dcn.davis.ca.us>
Message-ID: <89f88d61-1013-d562-feb7-f4bcf3383ebd@web.de>

Thanks, Jeff, that was helpful ... Best, Peter

Am 01.04.2021 um 18:04 schrieb Jeff Newmiller:
> I don't think those settings apply to that file. Search for "sysdata.rda" in [1].
>
> [1] https://cran.r-project.org/doc/manuals/r-release/R-exts.html
>
> On April 1, 2021 3:11:17 AM PDT, Peter Ruckdeschel <peter.ruckdeschel at web.de> wrote:
>> Hi,  
>>
>> I just noticed that, last week-end, R CMD build was changed to remove
>> ?LazyData? and
>> ?LazyDataCompression? fields from the ?DESCRIPTION? file of packages
>> without a ?data?
>> directory.
>>
>> Now, in our package "RobAStRDA" published on CRAN in version 1.2.0
>> 2019-03-11, we 
>> deliberately do have a ?LazyData? field in the ?DESCRIPTION? file of
>> the package
>> without a ?data? folder.
>>
>> This package just contains a sysdata.rda file with a large amount of
>> interpolation grids
>> and functions not to be analyzed as statistical data but rather to be
>> used for speed-ups
>> in our package "RobExtremes" (also on CRAN).
>>
>> What is the recommended way to achieve this, i.e., use the sysdata.rda
>> file in compressed
>> form and in lazy data format without placing it into a ?data? folder?
>>
>> Any suggestions welcome,
>> best regards, Peter (Ruckdeschel)
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From w@nz63 @end|ng |rom ||ve@unc@edu  Thu Apr  1 20:39:13 2021
From: w@nz63 @end|ng |rom ||ve@unc@edu (Zhang, Wan)
Date: Thu, 1 Apr 2021 18:39:13 +0000
Subject: [R-pkg-devel] Error on Solaris 10 'memory not mapped'
Message-ID: <MN2PR03MB5167D7560C8FE9488ABD86CBE77B9@MN2PR03MB5167.namprd03.prod.outlook.com>

Hello,

In our package ?BET? version 0.3.4 published on 2021-03-21, there is a ?memory not mapped? error on Solaris 10.

https://www.r-project.org/nosvn/R.check/r-patched-solaris-x86/BET-00check.html

I tried to replicate this error with R-hub but it works well. What can I do to simulate CRAN?s environment in S 10 and fix this problem?

Any help from you will be highly appreciated!

Best,
Wan

	[[alternative HTML version deleted]]


From edd @end|ng |rom deb|@n@org  Thu Apr  1 21:35:28 2021
From: edd @end|ng |rom deb|@n@org (Dirk Eddelbuettel)
Date: Thu, 1 Apr 2021 14:35:28 -0500
Subject: [R-pkg-devel] Error on Solaris 10 'memory not mapped'
In-Reply-To: <MN2PR03MB5167D7560C8FE9488ABD86CBE77B9@MN2PR03MB5167.namprd03.prod.outlook.com>
References: <MN2PR03MB5167D7560C8FE9488ABD86CBE77B9@MN2PR03MB5167.namprd03.prod.outlook.com>
Message-ID: <24678.8320.269315.352314@rob.eddelbuettel.com>


On 1 April 2021 at 18:39, Zhang, Wan wrote:
| Hello,
| 
| In our package ?BET? version 0.3.4 published on 2021-03-21, there is a ?memory not mapped? error on Solaris 10.
| 
| https://www.r-project.org/nosvn/R.check/r-patched-solaris-x86/BET-00check.html
| 
| I tried to replicate this error with R-hub but it works well. What can I do to simulate CRAN?s environment in S 10 and fix this problem?

It is difficult to say more than Dave and I said in comments to your post on
this at StackOverflow:
https://stackoverflow.com/questions/66894044/memory-not-mapped-error-in-r-on-solaris-10

None of us have access to the exact same configuration as that test machine.

Dirk

-- 
https://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From w||||@mwdun|@p @end|ng |rom gm@||@com  Thu Apr  1 22:22:43 2021
From: w||||@mwdun|@p @end|ng |rom gm@||@com (Bill Dunlap)
Date: Thu, 1 Apr 2021 13:22:43 -0700
Subject: [R-pkg-devel] Error on Solaris 10 'memory not mapped'
In-Reply-To: <MN2PR03MB5167D7560C8FE9488ABD86CBE77B9@MN2PR03MB5167.namprd03.prod.outlook.com>
References: <MN2PR03MB5167D7560C8FE9488ABD86CBE77B9@MN2PR03MB5167.namprd03.prod.outlook.com>
Message-ID: <CAHqSRuT9DfgnsZQAHRG4Y0xZwoydPws1ny=idEuDQ-=A3vnw1Q@mail.gmail.com>

Have you run the offending examples under valgrind on Linux with
gctorture(TRUE)?

-Bill

On Thu, Apr 1, 2021 at 11:51 AM Zhang, Wan <wanz63 at live.unc.edu> wrote:
>
> Hello,
>
> In our package ?BET? version 0.3.4 published on 2021-03-21, there is a ?memory not mapped? error on Solaris 10.
>
> https://www.r-project.org/nosvn/R.check/r-patched-solaris-x86/BET-00check.html
>
> I tried to replicate this error with R-hub but it works well. What can I do to simulate CRAN?s environment in S 10 and fix this problem?
>
> Any help from you will be highly appreciated!
>
> Best,
> Wan
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From D@n@Ke||ey @end|ng |rom D@|@C@  Fri Apr  2 13:05:52 2021
From: D@n@Ke||ey @end|ng |rom D@|@C@ (Daniel Kelley)
Date: Fri, 2 Apr 2021 11:05:52 +0000
Subject: [R-pkg-devel] how to address CRAN FAIL on
 r-devel-windows-x86_64-gcc10-UCRT?
Message-ID: <916FE36D-C70F-4E00-AC87-9335B4AA5A0C@dal.ca>

The "oce" package for oceanographic analysis is failing a check on the r-devel-windows-x86_64-gcc10-UCRT system (see
https://www.r-project.org/nosvn/R.check/r-devel-windows-x86_64-gcc10-UCRT/oce-00check.html). The problem seems to relate to the checking vignette outputs.

According to https://www.r-project.org/nosvn/winutf8/ucrt3/CRAN/checks/gcc10-UCRT/README.txt, that test setup is experimental.  Does that mean that I ought to I ignore the FAIL status for this machine, perhaps checking it once in a while to see if it changes?

Alternatively, if I am advised to fix the problem, I wonder whether there a way for me to run tests with rhub, winbuilder, or something similar?  (I do not have access to a windows machine.)

Thanks in advance for any help that can be provided.

Dan Kelley, Dept. Oceanography, Dalhousie University, Canada

From d@v|d@corte@@r|ver@ @end|ng |rom gm@||@com  Fri Apr  2 03:06:46 2021
From: d@v|d@corte@@r|ver@ @end|ng |rom gm@||@com (David Cortes)
Date: Thu, 01 Apr 2021 22:06:46 -0300
Subject: [R-pkg-devel] Using RC_fopen in a CRAN package
Message-ID: <b05557c3fa02b9da23b8e0809923f00c5ea64f88.camel@gmail.com>

I?d like to ask for clarification about CRAN policies regarding usage
of functions that start with "RC_*", such as "RC_fopen".

I'm trying to upload a package which is meant for reading and writing
data from text files in a certain format, for which I want to use a C
file pointer which I obtain through "RC_fopen". The R extensions manual
says the following:
"... there are other header files there that can be included too, but
many of the features they contain should be regarded as undocumented
and unstable."

Since "RC_fopen" is present in a header file, I would guess it should
be classified as "public" within the entry points classification
(between API/public/private/hidden). This is the description for such
entry points in the manual:
"Entry points declared in an installed header file that are exported on
all R platforms but are not documented and subject to change without
notice."

As I understand it, there is nothing that would forbid using public
entry points compared to the explicit point made about "private" entry
points. However, when I try to submit the package to CRAN, it doesn't
make it past the automated checks due to a NOTE:
Check: compiled code, Result: NOTE
  File 'readsparse/libs/readsparse.so':
    Found non-API call to R: 'RC_fopen'
  
  Compiled code should not call non-API entry points in R.
  
  See 'Writing portable packages' in the 'Writing R Extensions' manual.


Is it allowed to use such functions in packages? I see a few packages
currently in CRAN have the same note in the checks, such as "iotools",
and am wondering if I should just email the CRAN maintainer explaining
that I intend to use the function anyway, since it's just a note rather
than a warning or error.


From murdoch@dunc@n @end|ng |rom gm@||@com  Fri Apr  2 15:45:44 2021
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Fri, 2 Apr 2021 09:45:44 -0400
Subject: [R-pkg-devel] Using RC_fopen in a CRAN package
In-Reply-To: <b05557c3fa02b9da23b8e0809923f00c5ea64f88.camel@gmail.com>
References: <b05557c3fa02b9da23b8e0809923f00c5ea64f88.camel@gmail.com>
Message-ID: <5b929bd4-3cd5-94ab-94fe-09d7931baed1@gmail.com>

On 01/04/2021 9:06 p.m., David Cortes wrote:
> I?d like to ask for clarification about CRAN policies regarding usage
> of functions that start with "RC_*", such as "RC_fopen".
> 
> I'm trying to upload a package which is meant for reading and writing
> data from text files in a certain format, for which I want to use a C
> file pointer which I obtain through "RC_fopen". The R extensions manual
> says the following:
> "... there are other header files there that can be included too, but
> many of the features they contain should be regarded as undocumented
> and unstable."
> 
> Since "RC_fopen" is present in a header file, I would guess it should
> be classified as "public" within the entry points classification
> (between API/public/private/hidden). This is the description for such
> entry points in the manual:
> "Entry points declared in an installed header file that are exported on
> all R platforms but are not documented and subject to change without
> notice."
> 
> As I understand it, there is nothing that would forbid using public
> entry points compared to the explicit point made about "private" entry
> points. However, when I try to submit the package to CRAN, it doesn't
> make it past the automated checks due to a NOTE:
> Check: compiled code, Result: NOTE
>    File 'readsparse/libs/readsparse.so':
>      Found non-API call to R: 'RC_fopen'
>    
>    Compiled code should not call non-API entry points in R.
>    
>    See 'Writing portable packages' in the 'Writing R Extensions' manual.
> 
> 
> Is it allowed to use such functions in packages? I see a few packages
> currently in CRAN have the same note in the checks, such as "iotools",
> and am wondering if I should just email the CRAN maintainer explaining
> that I intend to use the function anyway, since it's just a note rather
> than a warning or error.

The CRAN policy document is quite clear on this: "CRAN packages should 
use only the public API. Hence they should not use entry points not 
declared as API in installed headers nor .Internal() nor .Call() etc 
calls to base packages. Also, ::: should not be used to access 
undocumented/internal objects in base packages (nor should other means 
of access be employed). Such usages can cause packages to break at any 
time, even in patched versions of R. "

So you are free to use that function, but CRAN won't publish your 
package if you do.

Duncan Murdoch

Duncan Murdoch


From edd @end|ng |rom deb|@n@org  Fri Apr  2 16:27:03 2021
From: edd @end|ng |rom deb|@n@org (Dirk Eddelbuettel)
Date: Fri, 2 Apr 2021 09:27:03 -0500
Subject: [R-pkg-devel] Using RC_fopen in a CRAN package
In-Reply-To: <5b929bd4-3cd5-94ab-94fe-09d7931baed1@gmail.com>
References: <b05557c3fa02b9da23b8e0809923f00c5ea64f88.camel@gmail.com>
 <5b929bd4-3cd5-94ab-94fe-09d7931baed1@gmail.com>
Message-ID: <24679.10679.21637.285419@rob.eddelbuettel.com>


On 2 April 2021 at 09:45, Duncan Murdoch wrote:
| On 01/04/2021 9:06 p.m., David Cortes wrote:
| > Is it allowed to use such functions in packages? I see a few packages
| > currently in CRAN have the same note in the checks, such as "iotools",
| > and am wondering if I should just email the CRAN maintainer explaining
| > that I intend to use the function anyway, since it's just a note rather
| > than a warning or error.
| 
| The CRAN policy document is quite clear on this: "CRAN packages should 
| use only the public API. Hence they should not use entry points not 
| declared as API in installed headers nor .Internal() nor .Call() etc 
| calls to base packages. Also, ::: should not be used to access 
| undocumented/internal objects in base packages (nor should other means 
| of access be employed). Such usages can cause packages to break at any 
| time, even in patched versions of R. "
| 
| So you are free to use that function, but CRAN won't publish your 
| package if you do.

What you can do is to republish the functions in a package you own and
maintain, and then export them from there. I have done that in RApiDatetime
for some date/time parsing code, and in RApiSerialize for serialization.

It is not ideal as your copies may become stale over time. But it gives you a
way forward as long as R Core exercises their right to have non-public APIs.
As R Core has demonstrated exemplary fidelity to the parts of the API that
are public, we should not be too grumpy that they reserve this option.

Dirk

-- 
https://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From dw|n@em|u@ @end|ng |rom comc@@t@net  Fri Apr  2 22:08:19 2021
From: dw|n@em|u@ @end|ng |rom comc@@t@net (David Winsemius)
Date: Fri, 2 Apr 2021 13:08:19 -0700
Subject: [R-pkg-devel] how to address CRAN FAIL on
 r-devel-windows-x86_64-gcc10-UCRT?
In-Reply-To: <916FE36D-C70F-4E00-AC87-9335B4AA5A0C@dal.ca>
References: <916FE36D-C70F-4E00-AC87-9335B4AA5A0C@dal.ca>
Message-ID: <bc01010e-b9cc-b561-fc2b-b2dd5c98a706@comcast.net>


On 4/2/21 4:05 AM, Daniel Kelley wrote:
> The "oce" package for oceanographic analysis is failing a check on the r-devel-windows-x86_64-gcc10-UCRT system (see
> https://www.r-project.org/nosvn/R.check/r-devel-windows-x86_64-gcc10-UCRT/oce-00check.html). The problem seems to relate to the checking vignette outputs.
>
> According to https://www.r-project.org/nosvn/winutf8/ucrt3/CRAN/checks/gcc10-UCRT/README.txt, that test setup is experimental.  Does that mean that I ought to I ignore the FAIL status for this machine, perhaps checking it once in a while to see if it changes?
Hello Daniel;

I'm not speaking for CRAN. I'm another maintainer whose current status 
page has a FAIL for that platform. But the FAIL notation is due at least 
in part to the fact that apparently the UCRT platform is less frequently 
run on the full CRAN package holdings. The note refers to a package that 
was updated a few days ago. The log file however has two other reports 
of failure relating to compiler warnings.

All the other platforms passed the newer versions. There is no mention 
of the UCRT platform at the CRAN Policies page: 
https://cran.r-project.org/web/packages/policies.html

I'm waiting to see whether the aging fortran code generates warnings 
whenever the UCRT platform gets fired up again.

-- 

David Winsemius

maintainer (but neither author or contributor) of "muhaz"

>
> Alternatively, if I am advised to fix the problem, I wonder whether there a way for me to run tests with rhub, winbuilder, or something similar?  (I do not have access to a windows machine.)
>
> Thanks in advance for any help that can be provided.
>
> Dan Kelley, Dept. Oceanography, Dalhousie University, Canada
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de  Fri Apr  2 23:13:11 2021
From: ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de (Uwe Ligges)
Date: Fri, 2 Apr 2021 23:13:11 +0200
Subject: [R-pkg-devel] 
 checking LazyData ... NOTE 'LazyData' is specified
 without a 'data' directory
In-Reply-To: <CAHMN1Py2_TG4zGtEH0J8MbiBm7voWZLf4q9SRt5zjzgjj82Y8g@mail.gmail.com>
References: <87bd6ba2-86b4-94f5-d7e9-fa18dc16bcbb@gmail.com>
 <13249B2D-8CA2-443F-A274-319A813403BF@gmail.com>
 <e0316015-f0e5-2600-4c84-ffdc5156b687@gmail.com>
 <CAHMN1Py2_TG4zGtEH0J8MbiBm7voWZLf4q9SRt5zjzgjj82Y8g@mail.gmail.com>
Message-ID: <d10d6764-a3db-b966-506a-e3a0e089198d@statistik.tu-dortmund.de>



On 01.04.2021 07:55, Tim Hulsen wrote:
> r-release-windows-ix86+x86_64

A new check, you declare LazyData in your DESCRIPTION file which is 
meaningless. So please simply omit that line.

Best,
Uwe Ligges

> Op wo 31 mrt. 2021 om 14:31 schreef Duncan Murdoch <murdoch.duncan at gmail.com
>> :
> 
>> On 31/03/2021 8:28 a.m., Tim Hulsen wrote:
>>> I don?t believe I do anything with lazydata.
>>
>> Your DESCRIPTION file specifies it is TRUE.
>>
>> Duncan Murdoch
>>
>>>
>>> https://cran.r-project.org/web/checks/check_results_BioVenn.html
>>> <https://cran.r-project.org/web/checks/check_results_BioVenn.html>
>>>
>>>
>>>
>>>> Op 31 mrt. 2021 om 14:24 heeft Duncan Murdoch
>>>> <murdoch.duncan at gmail.com> het volgende geschreven:
>>>>
>>>> ?On 31/03/2021 5:55 a.m., Tim Hulsen wrote:
>>>>> When submitting my package to CRAN, I get the message:
>>>>> checking LazyData ... NOTE
>>>>> 'LazyData' is specified without a 'data' directory
>>>>> What can i do about this?
>>>>
>>>> Don't specify LazyData.  If that doesn't help, give us a bit more
>>>> information, e.g. a link to your source.
>>>>
>>>> Duncan Murdoch
>>
>>
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


From tom@@@k@||ber@ @end|ng |rom gm@||@com  Sat Apr  3 10:48:47 2021
From: tom@@@k@||ber@ @end|ng |rom gm@||@com (Tomas Kalibera)
Date: Sat, 3 Apr 2021 10:48:47 +0200
Subject: [R-pkg-devel] how to address CRAN FAIL on
 r-devel-windows-x86_64-gcc10-UCRT?
In-Reply-To: <916FE36D-C70F-4E00-AC87-9335B4AA5A0C@dal.ca>
References: <916FE36D-C70F-4E00-AC87-9335B4AA5A0C@dal.ca>
Message-ID: <fedf43b0-4715-0373-1f95-fa9d404b36cf@gmail.com>

On 4/2/21 1:05 PM, Daniel Kelley wrote:
> The "oce" package for oceanographic analysis is failing a check on the r-devel-windows-x86_64-gcc10-UCRT system (see
> https://www.r-project.org/nosvn/R.check/r-devel-windows-x86_64-gcc10-UCRT/oce-00check.html). The problem seems to relate to the checking vignette outputs.
>
> According to https://www.r-project.org/nosvn/winutf8/ucrt3/CRAN/checks/gcc10-UCRT/README.txt, that test setup is experimental.  Does that mean that I ought to I ignore the FAIL status for this machine, perhaps checking it once in a while to see if it changes?

A similarly looking problem exists for multiple packages. It may be 
related to some setup on the checking system or some more general 
problem not specifically related to your package, I didn't yet have time 
to diagnose.

> Alternatively, if I am advised to fix the problem, I wonder whether there a way for me to run tests with rhub, winbuilder, or something similar?  (I do not have access to a windows machine.)
For now there is a virtual machine setup (you can install a 
free-for-testing Windows virtual machine). A link is in the README or here
https://developer.r-project.org/Blog/public/2021/03/18/virtual-windows-machine-for-checking-r-packages/index.html 


This is available for package developers to debug issues with their 
packages, but in this case it really may be something unrelated to your 
package, so unless you wanted to volunteer your time diagnosing this, 
please ignore.

Best
Tomas

>
> Thanks in advance for any help that can be provided.
>
> Dan Kelley, Dept. Oceanography, Dalhousie University, Canada
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From @dh@w@n @end|ng |rom qmed@c@  Tue Apr  6 16:27:21 2021
From: @dh@w@n @end|ng |rom qmed@c@ (Andrew Dhawan)
Date: Tue, 6 Apr 2021 10:27:21 -0400
Subject: [R-pkg-devel] Package Rejection Error Help
Message-ID: <CAOK8EzfgUK4jNtXE6zE4-Mxig=VoR5nAMXw517ypzJvRPd6Avg@mail.gmail.com>

Dear all,

I am a bit puzzled by this error for the sigQC package being uploaded to
CRAN. Checks on my end pass without issue. There is one error regarding the
bioConductor dependency RankProd that comes up only on the Debian OS when
checking. See here for further details:
https://win-builder.r-project.org/incoming_pretest/sigQC_0.1.22_20210406_110708/

I am not sure how to resolve this - it seems to me that the dependency
*should* be available across platforms, and short of removing the
dependency (which we rely on a fair bit), I'm not sure what  we can do.

Any thoughts or suggestions would be massively appreciated.

Thank you so kindly!
Andrew

	[[alternative HTML version deleted]]


From ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de  Tue Apr  6 17:33:00 2021
From: ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de (Uwe Ligges)
Date: Tue, 6 Apr 2021 17:33:00 +0200
Subject: [R-pkg-devel] Package Rejection Error Help
In-Reply-To: <CAOK8EzfgUK4jNtXE6zE4-Mxig=VoR5nAMXw517ypzJvRPd6Avg@mail.gmail.com>
References: <CAOK8EzfgUK4jNtXE6zE4-Mxig=VoR5nAMXw517ypzJvRPd6Avg@mail.gmail.com>
Message-ID: <d96ab7f7-b91e-b901-414e-7314c04c51f7@statistik.tu-dortmund.de>

Two Notes:


Found the following (possibly) invalid URLs:
   URL: http://imagemagick.org/script/download.php (moved to 
https://imagemagick.org/script/download.php)
     From: inst/doc/vignette.html
     Status: 200
     Message: OK


Please change http --> https, add trailing slashes, or follow moved 
content as appropriate.

* checking LazyData ... NOTE
   'LazyData' is specified without a 'data' directory

Simply omit the field if you have no data.

Best,
Uwe Ligges



On 06.04.2021 16:27, Andrew Dhawan wrote:
> Dear all,
> 
> I am a bit puzzled by this error for the sigQC package being uploaded to
> CRAN. Checks on my end pass without issue. There is one error regarding the
> bioConductor dependency RankProd that comes up only on the Debian OS when
> checking. See here for further details:
> https://win-builder.r-project.org/incoming_pretest/sigQC_0.1.22_20210406_110708/
> 
> I am not sure how to resolve this - it seems to me that the dependency
> *should* be available across platforms, and short of removing the
> dependency (which we rely on a fair bit), I'm not sure what  we can do.
> 
> Any thoughts or suggestions would be massively appreciated.
> 
> Thank you so kindly!
> Andrew
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


From ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de  Tue Apr  6 17:58:25 2021
From: ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de (Uwe Ligges)
Date: Tue, 6 Apr 2021 17:58:25 +0200
Subject: [R-pkg-devel] Package Rejection Error Help
In-Reply-To: <184d0c80-1223-508e-425f-e8df828892cf@univ-fcomte.fr>
References: <CAOK8EzfgUK4jNtXE6zE4-Mxig=VoR5nAMXw517ypzJvRPd6Avg@mail.gmail.com>
 <d96ab7f7-b91e-b901-414e-7314c04c51f7@statistik.tu-dortmund.de>
 <184d0c80-1223-508e-425f-e8df828892cf@univ-fcomte.fr>
Message-ID: <fb21bbc0-810c-995d-8c6a-cf4645379313@statistik.tu-dortmund.de>



On 06.04.2021 17:39, Patrick Giraudoux wrote:
> I had a similar problem with intepreting "notes" in pgirmess checks. 
> Some are lethal and lead to rejection and some not (just informative 
> comments). Fortunately Uwe has been kind enough to tell me what I missed 
> (I thought that all notes were just "informative").
> Would it be possible to call lethal notes "errors" to keep us aware that 
> we must really do something with them and fix what is actually a problem?

These are Notes as it may not be a serious issue or may be a false 
positive, nevertheless, we like to get clean packages to CRAN.

WARNINGs and ERRORs will never be accepted.

The policies clearly say that significant Notes have to be addressed.
The only Note that is always acceptable is the CRAN maintainer Note 
about the package maintainer's address. All other Notes should be fixed 
generally or need manual attention in case of the really very few 
exceptions.

Best,
Uwe Ligges




> Best,
> Patrick
> 
> 
> Le 06/04/2021 ? 17:33, Uwe Ligges a ?crit?:
>> Two Notes:
>>
>>
>> Found the following (possibly) invalid URLs:
>> ?URL: http://imagemagick.org/script/download.php (moved to 
>> https://imagemagick.org/script/download.php)
>> ?? From: inst/doc/vignette.html
>> ?? Status: 200
>> ?? Message: OK
>>
>>
>> Please change http --> https, add trailing slashes, or follow moved 
>> content as appropriate.
>>
>> * checking LazyData ... NOTE
>> ?'LazyData' is specified without a 'data' directory
>>
>> Simply omit the field if you have no data.
>>
>> Best,
>> Uwe Ligges
>>
>>
>>
>> On 06.04.2021 16:27, Andrew Dhawan wrote:
>>> Dear all,
>>>
>>> I am a bit puzzled by this error for the sigQC package being uploaded to
>>> CRAN. Checks on my end pass without issue. There is one error 
>>> regarding the
>>> bioConductor dependency RankProd that comes up only on the Debian OS 
>>> when
>>> checking. See here for further details:
>>> https://win-builder.r-project.org/incoming_pretest/sigQC_0.1.22_20210406_110708/ 
>>>
>>>
>>> I am not sure how to resolve this - it seems to me that the dependency
>>> *should* be available across platforms, and short of removing the
>>> dependency (which we rely on a fair bit), I'm not sure what? we can do.
>>>
>>> Any thoughts or suggestions would be massively appreciated.
>>>
>>> Thank you so kindly!
>>> Andrew
>>>
>>> ????[[alternative HTML version deleted]]
>>>
>>> ______________________________________________
>>> R-package-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
> 
>


From @dh@w@n @end|ng |rom qmed@c@  Tue Apr  6 19:13:28 2021
From: @dh@w@n @end|ng |rom qmed@c@ (Andrew Dhawan)
Date: Tue, 6 Apr 2021 13:13:28 -0400
Subject: [R-pkg-devel] Package Rejection Error Help
In-Reply-To: <fb21bbc0-810c-995d-8c6a-cf4645379313@statistik.tu-dortmund.de>
References: <CAOK8EzfgUK4jNtXE6zE4-Mxig=VoR5nAMXw517ypzJvRPd6Avg@mail.gmail.com>
 <d96ab7f7-b91e-b901-414e-7314c04c51f7@statistik.tu-dortmund.de>
 <184d0c80-1223-508e-425f-e8df828892cf@univ-fcomte.fr>
 <fb21bbc0-810c-995d-8c6a-cf4645379313@statistik.tu-dortmund.de>
Message-ID: <CAOK8EzcGv=ktad0AjtjOcQa5706WAy+zsAk3gkwOjeV-NUqPLA@mail.gmail.com>

Thank you both very kindly - I have addressed both notes. I am still
wondering though about the RankProd dependency error - any insight into
this?

Thanks!
Andrew

On Tue, Apr 6, 2021 at 11:58 AM Uwe Ligges <ligges at statistik.tu-dortmund.de>
wrote:

>
>
> On 06.04.2021 17:39, Patrick Giraudoux wrote:
> > I had a similar problem with intepreting "notes" in pgirmess checks.
> > Some are lethal and lead to rejection and some not (just informative
> > comments). Fortunately Uwe has been kind enough to tell me what I missed
> > (I thought that all notes were just "informative").
> > Would it be possible to call lethal notes "errors" to keep us aware that
> > we must really do something with them and fix what is actually a problem?
>
> These are Notes as it may not be a serious issue or may be a false
> positive, nevertheless, we like to get clean packages to CRAN.
>
> WARNINGs and ERRORs will never be accepted.
>
> The policies clearly say that significant Notes have to be addressed.
> The only Note that is always acceptable is the CRAN maintainer Note
> about the package maintainer's address. All other Notes should be fixed
> generally or need manual attention in case of the really very few
> exceptions.
>
> Best,
> Uwe Ligges
>
>
>
>
> > Best,
> > Patrick
> >
> >
> > Le 06/04/2021 ? 17:33, Uwe Ligges a ?crit :
> >> Two Notes:
> >>
> >>
> >> Found the following (possibly) invalid URLs:
> >>  URL: http://imagemagick.org/script/download.php (moved to
> >> https://imagemagick.org/script/download.php)
> >>    From: inst/doc/vignette.html
> >>    Status: 200
> >>    Message: OK
> >>
> >>
> >> Please change http --> https, add trailing slashes, or follow moved
> >> content as appropriate.
> >>
> >> * checking LazyData ... NOTE
> >>  'LazyData' is specified without a 'data' directory
> >>
> >> Simply omit the field if you have no data.
> >>
> >> Best,
> >> Uwe Ligges
> >>
> >>
> >>
> >> On 06.04.2021 16:27, Andrew Dhawan wrote:
> >>> Dear all,
> >>>
> >>> I am a bit puzzled by this error for the sigQC package being uploaded
> to
> >>> CRAN. Checks on my end pass without issue. There is one error
> >>> regarding the
> >>> bioConductor dependency RankProd that comes up only on the Debian OS
> >>> when
> >>> checking. See here for further details:
> >>>
> https://win-builder.r-project.org/incoming_pretest/sigQC_0.1.22_20210406_110708/
> >>>
> >>>
> >>> I am not sure how to resolve this - it seems to me that the dependency
> >>> *should* be available across platforms, and short of removing the
> >>> dependency (which we rely on a fair bit), I'm not sure what  we can do.
> >>>
> >>> Any thoughts or suggestions would be massively appreciated.
> >>>
> >>> Thank you so kindly!
> >>> Andrew
> >>>
> >>>     [[alternative HTML version deleted]]
> >>>
> >>> ______________________________________________
> >>> R-package-devel at r-project.org mailing list
> >>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
> >>>
> >>
> >> ______________________________________________
> >> R-package-devel at r-project.org mailing list
> >> https://stat.ethz.ch/mailman/listinfo/r-package-devel
> >
> >
>

	[[alternative HTML version deleted]]


From r|||ght79 @end|ng |rom gm@||@com  Tue Apr  6 19:26:34 2021
From: r|||ght79 @end|ng |rom gm@||@com (Robert M. Flight)
Date: Tue, 6 Apr 2021 13:26:34 -0400
Subject: [R-pkg-devel] Package Rejection Error Help
In-Reply-To: <CAOK8EzcGv=ktad0AjtjOcQa5706WAy+zsAk3gkwOjeV-NUqPLA@mail.gmail.com>
References: <CAOK8EzfgUK4jNtXE6zE4-Mxig=VoR5nAMXw517ypzJvRPd6Avg@mail.gmail.com>
 <d96ab7f7-b91e-b901-414e-7314c04c51f7@statistik.tu-dortmund.de>
 <184d0c80-1223-508e-425f-e8df828892cf@univ-fcomte.fr>
 <fb21bbc0-810c-995d-8c6a-cf4645379313@statistik.tu-dortmund.de>
 <CAOK8EzcGv=ktad0AjtjOcQa5706WAy+zsAk3gkwOjeV-NUqPLA@mail.gmail.com>
Message-ID: <CAJLyBTUoRvY7xZDVjswE_r8wsg_E0-DTS78__zi6dUmtu=yhTw@mail.gmail.com>

Andrew,

I think if you want to include a Bioconductor dependency, then I think you
add the "biocViews:" line to your description file to enable bioconductor
package installation.

See this answer on Bioinformatics stackexchange:
https://bioinformatics.stackexchange.com/a/3375/51

Hope that helps!

-Robert

On Tue, Apr 6, 2021 at 1:14 PM Andrew Dhawan <adhawan at qmed.ca> wrote:

> Thank you both very kindly - I have addressed both notes. I am still
> wondering though about the RankProd dependency error - any insight into
> this?
>
> Thanks!
> Andrew
>
> On Tue, Apr 6, 2021 at 11:58 AM Uwe Ligges <
> ligges at statistik.tu-dortmund.de>
> wrote:
>
> >
> >
> > On 06.04.2021 17:39, Patrick Giraudoux wrote:
> > > I had a similar problem with intepreting "notes" in pgirmess checks.
> > > Some are lethal and lead to rejection and some not (just informative
> > > comments). Fortunately Uwe has been kind enough to tell me what I
> missed
> > > (I thought that all notes were just "informative").
> > > Would it be possible to call lethal notes "errors" to keep us aware
> that
> > > we must really do something with them and fix what is actually a
> problem?
> >
> > These are Notes as it may not be a serious issue or may be a false
> > positive, nevertheless, we like to get clean packages to CRAN.
> >
> > WARNINGs and ERRORs will never be accepted.
> >
> > The policies clearly say that significant Notes have to be addressed.
> > The only Note that is always acceptable is the CRAN maintainer Note
> > about the package maintainer's address. All other Notes should be fixed
> > generally or need manual attention in case of the really very few
> > exceptions.
> >
> > Best,
> > Uwe Ligges
> >
> >
> >
> >
> > > Best,
> > > Patrick
> > >
> > >
> > > Le 06/04/2021 ? 17:33, Uwe Ligges a ?crit :
> > >> Two Notes:
> > >>
> > >>
> > >> Found the following (possibly) invalid URLs:
> > >>  URL: http://imagemagick.org/script/download.php (moved to
> > >> https://imagemagick.org/script/download.php)
> > >>    From: inst/doc/vignette.html
> > >>    Status: 200
> > >>    Message: OK
> > >>
> > >>
> > >> Please change http --> https, add trailing slashes, or follow moved
> > >> content as appropriate.
> > >>
> > >> * checking LazyData ... NOTE
> > >>  'LazyData' is specified without a 'data' directory
> > >>
> > >> Simply omit the field if you have no data.
> > >>
> > >> Best,
> > >> Uwe Ligges
> > >>
> > >>
> > >>
> > >> On 06.04.2021 16:27, Andrew Dhawan wrote:
> > >>> Dear all,
> > >>>
> > >>> I am a bit puzzled by this error for the sigQC package being uploaded
> > to
> > >>> CRAN. Checks on my end pass without issue. There is one error
> > >>> regarding the
> > >>> bioConductor dependency RankProd that comes up only on the Debian OS
> > >>> when
> > >>> checking. See here for further details:
> > >>>
> >
> https://win-builder.r-project.org/incoming_pretest/sigQC_0.1.22_20210406_110708/
> > >>>
> > >>>
> > >>> I am not sure how to resolve this - it seems to me that the
> dependency
> > >>> *should* be available across platforms, and short of removing the
> > >>> dependency (which we rely on a fair bit), I'm not sure what  we can
> do.
> > >>>
> > >>> Any thoughts or suggestions would be massively appreciated.
> > >>>
> > >>> Thank you so kindly!
> > >>> Andrew
> > >>>
> > >>>     [[alternative HTML version deleted]]
> > >>>
> > >>> ______________________________________________
> > >>> R-package-devel at r-project.org mailing list
> > >>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
> > >>>
> > >>
> > >> ______________________________________________
> > >> R-package-devel at r-project.org mailing list
> > >> https://stat.ethz.ch/mailman/listinfo/r-package-devel
> > >
> > >
> >
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From p@tr|ck@g|r@udoux @end|ng |rom un|v-|comte@|r  Tue Apr  6 17:39:40 2021
From: p@tr|ck@g|r@udoux @end|ng |rom un|v-|comte@|r (Patrick Giraudoux)
Date: Tue, 6 Apr 2021 17:39:40 +0200
Subject: [R-pkg-devel] Package Rejection Error Help
In-Reply-To: <d96ab7f7-b91e-b901-414e-7314c04c51f7@statistik.tu-dortmund.de>
References: <CAOK8EzfgUK4jNtXE6zE4-Mxig=VoR5nAMXw517ypzJvRPd6Avg@mail.gmail.com>
 <d96ab7f7-b91e-b901-414e-7314c04c51f7@statistik.tu-dortmund.de>
Message-ID: <184d0c80-1223-508e-425f-e8df828892cf@univ-fcomte.fr>

I had a similar problem with intepreting "notes" in pgirmess checks. 
Some are lethal and lead to rejection and some not (just informative 
comments). Fortunately Uwe has been kind enough to tell me what I missed 
(I thought that all notes were just "informative").
Would it be possible to call lethal notes "errors" to keep us aware that 
we must really do something with them and fix what is actually a problem?
Best,
Patrick


Le 06/04/2021 ? 17:33, Uwe Ligges a ?crit?:
> Two Notes:
>
>
> Found the following (possibly) invalid URLs:
> ?URL: http://imagemagick.org/script/download.php (moved to 
> https://imagemagick.org/script/download.php)
> ?? From: inst/doc/vignette.html
> ?? Status: 200
> ?? Message: OK
>
>
> Please change http --> https, add trailing slashes, or follow moved 
> content as appropriate.
>
> * checking LazyData ... NOTE
> ?'LazyData' is specified without a 'data' directory
>
> Simply omit the field if you have no data.
>
> Best,
> Uwe Ligges
>
>
>
> On 06.04.2021 16:27, Andrew Dhawan wrote:
>> Dear all,
>>
>> I am a bit puzzled by this error for the sigQC package being uploaded to
>> CRAN. Checks on my end pass without issue. There is one error 
>> regarding the
>> bioConductor dependency RankProd that comes up only on the Debian OS 
>> when
>> checking. See here for further details:
>> https://win-builder.r-project.org/incoming_pretest/sigQC_0.1.22_20210406_110708/ 
>>
>>
>> I am not sure how to resolve this - it seems to me that the dependency
>> *should* be available across platforms, and short of removing the
>> dependency (which we rely on a fair bit), I'm not sure what? we can do.
>>
>> Any thoughts or suggestions would be massively appreciated.
>>
>> Thank you so kindly!
>> Andrew
>>
>> ????[[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel



	[[alternative HTML version deleted]]


From d@v|d @end|ng |rom prec|@|onmethod@@guru  Tue Apr  6 21:09:02 2021
From: d@v|d @end|ng |rom prec|@|onmethod@@guru (David Norris)
Date: Tue, 6 Apr 2021 19:09:02 +0000
Subject: [R-pkg-devel] Win-builder not finding binaries provided by
 LinkingTo: cargo?
Message-ID: <DD27B476-6D93-4F8A-9A59-A0B21E24747E@precisionmethods.guru>

For version 0.2-2 of my ?precautionary? package, I have added fast numerical routines implemented in Rust.
In my DESCRIPTION file, I am ?LinkingTo: cargo (>= 0.1.28)?, but fail incoming check on Win-builder as follows:
https://win-builder.r-project.org/incoming_pretest/precautionary_0.2-2_20210406_142130/Windows/00install.out

* installing *source* package 'precautionary' ...
** using staged installation
** libs

*** arch - i386
rm -Rf precautionary.dll ./rust/target/i686-pc-windows-gnu/release/libprecautionary.a entrypoint.o
d:/Compiler/rtools40/mingw32/bin/gcc  -I"D:/RCompile/recent/R/include" -DNDEBUG  -I'd:/RCompile/CRANpkg/lib/4.1/cargo/include'   -I"d:/Compiler/gcc-4.9.3/local330/include"     -pedantic -O2 -Wall  -std=gnu99 -mfpmath=sse -msse2 -mstackrealign  -c entrypoint.c -o entrypoint.o
cargo build --target=i686-pc-windows-gnu --lib --release --manifest-path=./rust/Cargo.toml
make: cargo: Command not found
make: *** [Makevars.win:11: rust/target/-pc-windows-gnu/release/libprecautionary.a] Error 127
ERROR: compilation failed for package 'precautionary'
* removing 'd:/RCompile/CRANincoming/R-devel/lib/precautionary'

As I understand the intention of package cargo https://CRAN.R-project.org/package=cargo, it aims to solve precisely this problem.
Other platforms check my package just fine.
Is the solution to be found in configuration of Win-builder, in my Makevars.win, or elsewhere?
I have taken my Makevars.win straight from https://github.com/extendr/helloextendr/blob/main/src/Makevars.win as follows:


TARGET = $(subst 64,x86_64,$(subst 32,i686,$(WIN)))-pc-windows-gnu

LIBDIR = ./rust/target/$(TARGET)/release

STATLIB = $(LIBDIR)/libprecautionary.a

PKG_LIBS = -L$(LIBDIR) -lprecautionary -lws2_32 -ladvapi32 -luserenv



all: C_clean



$(SHLIB): $(STATLIB)



$(STATLIB):

        cargo build --target=$(TARGET) --lib --release --manifest-path=./rust/Cargo.toml



C_clean:

        rm -Rf $(SHLIB) $(STATLIB) $(OBJECTS)



clean:

        rm -Rf $(SHLIB) $(STATLIB) $(OBJECTS) rust/target


	[[alternative HTML version deleted]]


From @dh@w@n @end|ng |rom qmed@c@  Tue Apr  6 22:18:42 2021
From: @dh@w@n @end|ng |rom qmed@c@ (Andrew Dhawan)
Date: Tue, 6 Apr 2021 16:18:42 -0400
Subject: [R-pkg-devel] Package Rejection Error Help
In-Reply-To: <CAJLyBTUoRvY7xZDVjswE_r8wsg_E0-DTS78__zi6dUmtu=yhTw@mail.gmail.com>
References: <CAOK8EzfgUK4jNtXE6zE4-Mxig=VoR5nAMXw517ypzJvRPd6Avg@mail.gmail.com>
 <d96ab7f7-b91e-b901-414e-7314c04c51f7@statistik.tu-dortmund.de>
 <184d0c80-1223-508e-425f-e8df828892cf@univ-fcomte.fr>
 <fb21bbc0-810c-995d-8c6a-cf4645379313@statistik.tu-dortmund.de>
 <CAOK8EzcGv=ktad0AjtjOcQa5706WAy+zsAk3gkwOjeV-NUqPLA@mail.gmail.com>
 <CAJLyBTUoRvY7xZDVjswE_r8wsg_E0-DTS78__zi6dUmtu=yhTw@mail.gmail.com>
Message-ID: <CAOK8EzfLTkE8DiXxeUnV_TOBSHu33z86Jpap3nknzgkiZ2iScw@mail.gmail.com>

Hi Robert,

Thank you for replying! I already had the biocViews: line on my description
file - it seems it must be something else contributing to the issue.

Andrew

On Tue, Apr 6, 2021 at 13:26 Robert M. Flight <rflight79 at gmail.com> wrote:

> Andrew,
>
> I think if you want to include a Bioconductor dependency, then I think you
> add the "biocViews:" line to your description file to enable bioconductor
> package installation.
>
> See this answer on Bioinformatics stackexchange:
> https://bioinformatics.stackexchange.com/a/3375/51
>
> Hope that helps!
>
> -Robert
>
> On Tue, Apr 6, 2021 at 1:14 PM Andrew Dhawan <adhawan at qmed.ca> wrote:
>
>> Thank you both very kindly - I have addressed both notes. I am still
>> wondering though about the RankProd dependency error - any insight into
>> this?
>>
>> Thanks!
>> Andrew
>>
>> On Tue, Apr 6, 2021 at 11:58 AM Uwe Ligges <
>> ligges at statistik.tu-dortmund.de>
>> wrote:
>>
>> >
>> >
>> > On 06.04.2021 17:39, Patrick Giraudoux wrote:
>> > > I had a similar problem with intepreting "notes" in pgirmess checks.
>> > > Some are lethal and lead to rejection and some not (just informative
>> > > comments). Fortunately Uwe has been kind enough to tell me what I
>> missed
>> > > (I thought that all notes were just "informative").
>> > > Would it be possible to call lethal notes "errors" to keep us aware
>> that
>> > > we must really do something with them and fix what is actually a
>> problem?
>> >
>> > These are Notes as it may not be a serious issue or may be a false
>> > positive, nevertheless, we like to get clean packages to CRAN.
>> >
>> > WARNINGs and ERRORs will never be accepted.
>> >
>> > The policies clearly say that significant Notes have to be addressed.
>> > The only Note that is always acceptable is the CRAN maintainer Note
>> > about the package maintainer's address. All other Notes should be fixed
>> > generally or need manual attention in case of the really very few
>> > exceptions.
>> >
>> > Best,
>> > Uwe Ligges
>> >
>> >
>> >
>> >
>> > > Best,
>> > > Patrick
>> > >
>> > >
>> > > Le 06/04/2021 ? 17:33, Uwe Ligges a ?crit :
>> > >> Two Notes:
>> > >>
>> > >>
>> > >> Found the following (possibly) invalid URLs:
>> > >>  URL: http://imagemagick.org/script/download.php (moved to
>> > >> https://imagemagick.org/script/download.php)
>> > >>    From: inst/doc/vignette.html
>> > >>    Status: 200
>> > >>    Message: OK
>> > >>
>> > >>
>> > >> Please change http --> https, add trailing slashes, or follow moved
>> > >> content as appropriate.
>> > >>
>> > >> * checking LazyData ... NOTE
>> > >>  'LazyData' is specified without a 'data' directory
>> > >>
>> > >> Simply omit the field if you have no data.
>> > >>
>> > >> Best,
>> > >> Uwe Ligges
>> > >>
>> > >>
>> > >>
>> > >> On 06.04.2021 16:27, Andrew Dhawan wrote:
>> > >>> Dear all,
>> > >>>
>> > >>> I am a bit puzzled by this error for the sigQC package being
>> uploaded
>> > to
>> > >>> CRAN. Checks on my end pass without issue. There is one error
>> > >>> regarding the
>> > >>> bioConductor dependency RankProd that comes up only on the Debian OS
>> > >>> when
>> > >>> checking. See here for further details:
>> > >>>
>> >
>> https://win-builder.r-project.org/incoming_pretest/sigQC_0.1.22_20210406_110708/
>> > >>>
>> > >>>
>> > >>> I am not sure how to resolve this - it seems to me that the
>> dependency
>> > >>> *should* be available across platforms, and short of removing the
>> > >>> dependency (which we rely on a fair bit), I'm not sure what  we can
>> do.
>> > >>>
>> > >>> Any thoughts or suggestions would be massively appreciated.
>> > >>>
>> > >>> Thank you so kindly!
>> > >>> Andrew
>> > >>>
>> > >>>     [[alternative HTML version deleted]]
>> > >>>
>> > >>> ______________________________________________
>> > >>> R-package-devel at r-project.org mailing list
>> > >>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>> > >>>
>> > >>
>> > >> ______________________________________________
>> > >> R-package-devel at r-project.org mailing list
>> > >> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>> > >
>> > >
>> >
>>
>>         [[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>
> --
*Andrew Dhawan, MD, **DPhil, **B.Math*

	[[alternative HTML version deleted]]


From kev|nu@hey @end|ng |rom gm@||@com  Wed Apr  7 00:41:16 2021
From: kev|nu@hey @end|ng |rom gm@||@com (Kevin Ushey)
Date: Tue, 6 Apr 2021 15:41:16 -0700
Subject: [R-pkg-devel] Win-builder not finding binaries provided by
 LinkingTo: cargo?
In-Reply-To: <DD27B476-6D93-4F8A-9A59-A0B21E24747E@precisionmethods.guru>
References: <DD27B476-6D93-4F8A-9A59-A0B21E24747E@precisionmethods.guru>
Message-ID: <CAJXgQP3CeaRiH9Ci0TD0+0EWjayiJ5g7OKASLoM2DwHq91hGeg@mail.gmail.com>

I think this is the pertinent error:

> make: cargo: Command not found

That is, make is assuming that the cargo utility is installed and
available on the PATH, but that doesn't appear to be true on the CRAN
winbuilder machine.

The salso package (https://cran.r-project.org/package=salso)
explicitly requires cargo to be already available, per
SystemRequirements:

SystemRequirements: Cargo (>= 1.42.0) for installation from sources:
see file INSTALL

so you probably need to do something similar. I'd also recommend
downloading the 'salso' package to see how they resolve this, or
contacting the 'salso' maintainer to see what steps they took to
ensure their package could build on CRAN.

Best,
Kevin

On Tue, Apr 6, 2021 at 12:10 PM David Norris
<david at precisionmethods.guru> wrote:
>
> For version 0.2-2 of my ?precautionary? package, I have added fast numerical routines implemented in Rust.
> In my DESCRIPTION file, I am ?LinkingTo: cargo (>= 0.1.28)?, but fail incoming check on Win-builder as follows:
> https://win-builder.r-project.org/incoming_pretest/precautionary_0.2-2_20210406_142130/Windows/00install.out
>
> * installing *source* package 'precautionary' ...
> ** using staged installation
> ** libs
>
> *** arch - i386
> rm -Rf precautionary.dll ./rust/target/i686-pc-windows-gnu/release/libprecautionary.a entrypoint.o
> d:/Compiler/rtools40/mingw32/bin/gcc  -I"D:/RCompile/recent/R/include" -DNDEBUG  -I'd:/RCompile/CRANpkg/lib/4.1/cargo/include'   -I"d:/Compiler/gcc-4.9.3/local330/include"     -pedantic -O2 -Wall  -std=gnu99 -mfpmath=sse -msse2 -mstackrealign  -c entrypoint.c -o entrypoint.o
> cargo build --target=i686-pc-windows-gnu --lib --release --manifest-path=./rust/Cargo.toml
> make: cargo: Command not found
> make: *** [Makevars.win:11: rust/target/-pc-windows-gnu/release/libprecautionary.a] Error 127
> ERROR: compilation failed for package 'precautionary'
> * removing 'd:/RCompile/CRANincoming/R-devel/lib/precautionary'
>
> As I understand the intention of package cargo https://CRAN.R-project.org/package=cargo, it aims to solve precisely this problem.
> Other platforms check my package just fine.
> Is the solution to be found in configuration of Win-builder, in my Makevars.win, or elsewhere?
> I have taken my Makevars.win straight from https://github.com/extendr/helloextendr/blob/main/src/Makevars.win as follows:
>
>
> TARGET = $(subst 64,x86_64,$(subst 32,i686,$(WIN)))-pc-windows-gnu
>
> LIBDIR = ./rust/target/$(TARGET)/release
>
> STATLIB = $(LIBDIR)/libprecautionary.a
>
> PKG_LIBS = -L$(LIBDIR) -lprecautionary -lws2_32 -ladvapi32 -luserenv
>
>
>
> all: C_clean
>
>
>
> $(SHLIB): $(STATLIB)
>
>
>
> $(STATLIB):
>
>         cargo build --target=$(TARGET) --lib --release --manifest-path=./rust/Cargo.toml
>
>
>
> C_clean:
>
>         rm -Rf $(SHLIB) $(STATLIB) $(OBJECTS)
>
>
>
> clean:
>
>         rm -Rf $(SHLIB) $(STATLIB) $(OBJECTS) rust/target
>
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From d@v|d @end|ng |rom prec|@|onmethod@@guru  Wed Apr  7 11:39:53 2021
From: d@v|d @end|ng |rom prec|@|onmethod@@guru (David Norris)
Date: Wed, 7 Apr 2021 09:39:53 +0000
Subject: [R-pkg-devel] Win-builder not finding binaries provided by
 LinkingTo: cargo?
In-Reply-To: <CAJXgQP3CeaRiH9Ci0TD0+0EWjayiJ5g7OKASLoM2DwHq91hGeg@mail.gmail.com>
References: <DD27B476-6D93-4F8A-9A59-A0B21E24747E@precisionmethods.guru>
 <CAJXgQP3CeaRiH9Ci0TD0+0EWjayiJ5g7OKASLoM2DwHq91hGeg@mail.gmail.com>
Message-ID: <5098C871-09BB-4B51-AACE-2FB373B612C0@precisionmethods.guru>

My DESCRIPTION has the same ?SystemRequirements: ?? line as salso?from which I probably copied it.

I had briefly reached out to ?cargo? author (who is also ?salso? author), who indicated I might need to supply binaries.
Indeed, on closer look, salso appears to include the binaries, rather than asking CRAN to do the build:
https://www.r-project.org/nosvn/R.check/r-devel-windows-x86_64-gcc10-UCRT/salso-00check.html

Thus, it seems ?precautionary? presents an opportunity to get Rust compilation working on Win-builder.
Rust is such a fine language that it would be a shame not to smooth this out for the community.

OTOH, crucial calculations in ?precautionary? parallelize so nicely with mclapply() that it would not be inappropriate to bypass (forkless) Win by setting OS_type to unix.

From: Kevin Ushey <kevinushey at gmail.com>
Date: Tuesday, April 6, 2021 at 6:41 PM
To: David Norris <david at precisionmethods.guru>
Cc: "r-package-devel at r-project.org" <r-package-devel at r-project.org>
Subject: Re: [R-pkg-devel] Win-builder not finding binaries provided by LinkingTo: cargo?

I think this is the pertinent error:

make: cargo: Command not found

That is, make is assuming that the cargo utility is installed and
available on the PATH, but that doesn't appear to be true on the CRAN
winbuilder machine.

The salso package (https://cran.r-project.org/package=salso)
explicitly requires cargo to be already available, per
SystemRequirements:

SystemRequirements: Cargo (>= 1.42.0) for installation from sources:
see file INSTALL

so you probably need to do something similar. I'd also recommend
downloading the 'salso' package to see how they resolve this, or
contacting the 'salso' maintainer to see what steps they took to
ensure their package could build on CRAN.

Best,
Kevin

On Tue, Apr 6, 2021 at 12:10 PM David Norris
<david at precisionmethods.guru<mailto:david at precisionmethods.guru>> wrote:

For version 0.2-2 of my ?precautionary? package, I have added fast numerical routines implemented in Rust.
In my DESCRIPTION file, I am ?LinkingTo: cargo (>= 0.1.28)?, but fail incoming check on Win-builder as follows:
https://win-builder.r-project.org/incoming_pretest/precautionary_0.2-2_20210406_142130/Windows/00install.out

* installing *source* package 'precautionary' ...
** using staged installation
** libs

*** arch - i386
rm -Rf precautionary.dll ./rust/target/i686-pc-windows-gnu/release/libprecautionary.a entrypoint.o
d:/Compiler/rtools40/mingw32/bin/gcc  -I"D:/RCompile/recent/R/include" -DNDEBUG  -I'd:/RCompile/CRANpkg/lib/4.1/cargo/include'   -I"d:/Compiler/gcc-4.9.3/local330/include"     -pedantic -O2 -Wall  -std=gnu99 -mfpmath=sse -msse2 -mstackrealign  -c entrypoint.c -o entrypoint.o
cargo build --target=i686-pc-windows-gnu --lib --release --manifest-path=./rust/Cargo.toml
make: cargo: Command not found
make: *** [Makevars.win:11: rust/target/-pc-windows-gnu/release/libprecautionary.a] Error 127
ERROR: compilation failed for package 'precautionary'
* removing 'd:/RCompile/CRANincoming/R-devel/lib/precautionary'

As I understand the intention of package cargo https://CRAN.R-project.org/package=cargo, it aims to solve precisely this problem.
Other platforms check my package just fine.
Is the solution to be found in configuration of Win-builder, in my Makevars.win, or elsewhere?
I have taken my Makevars.win straight from https://github.com/extendr/helloextendr/blob/main/src/Makevars.win as follows:


TARGET = $(subst 64,x86_64,$(subst 32,i686,$(WIN)))-pc-windows-gnu

LIBDIR = ./rust/target/$(TARGET)/release

STATLIB = $(LIBDIR)/libprecautionary.a

PKG_LIBS = -L$(LIBDIR) -lprecautionary -lws2_32 -ladvapi32 -luserenv



all: C_clean



$(SHLIB): $(STATLIB)



$(STATLIB):

         cargo build --target=$(TARGET) --lib --release --manifest-path=./rust/Cargo.toml



C_clean:

         rm -Rf $(SHLIB) $(STATLIB) $(OBJECTS)



clean:

         rm -Rf $(SHLIB) $(STATLIB) $(OBJECTS) rust/target


         [[alternative HTML version deleted]]

______________________________________________
R-package-devel at r-project.org<mailto:R-package-devel at r-project.org> mailing list
https://stat.ethz.ch/mailman/listinfo/r-package-devel


	[[alternative HTML version deleted]]


From ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de  Wed Apr  7 11:45:36 2021
From: ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de (Uwe Ligges)
Date: Wed, 7 Apr 2021 11:45:36 +0200
Subject: [R-pkg-devel] Package Rejection Error Help
In-Reply-To: <CAJLyBTUoRvY7xZDVjswE_r8wsg_E0-DTS78__zi6dUmtu=yhTw@mail.gmail.com>
References: <CAOK8EzfgUK4jNtXE6zE4-Mxig=VoR5nAMXw517ypzJvRPd6Avg@mail.gmail.com>
 <d96ab7f7-b91e-b901-414e-7314c04c51f7@statistik.tu-dortmund.de>
 <184d0c80-1223-508e-425f-e8df828892cf@univ-fcomte.fr>
 <fb21bbc0-810c-995d-8c6a-cf4645379313@statistik.tu-dortmund.de>
 <CAOK8EzcGv=ktad0AjtjOcQa5706WAy+zsAk3gkwOjeV-NUqPLA@mail.gmail.com>
 <CAJLyBTUoRvY7xZDVjswE_r8wsg_E0-DTS78__zi6dUmtu=yhTw@mail.gmail.com>
Message-ID: <54a5e644-3d17-be4a-c0bf-082d0ea5a59f@statistik.tu-dortmund.de>



On 06.04.2021 19:26, Robert M. Flight wrote:
> Andrew,
> 
> I think if you want to include a Bioconductor dependency, then I think you
> add the "biocViews:" line to your description file to enable bioconductor

Not needed for CRAN.

You simply need to declare the dependency, but BioC 3.13 is what we 
should use to check with R-devel and that was recetnly still pretty 
iunstable.

Best,
Uwe Ligges

> package installation.
> 
> See this answer on Bioinformatics stackexchange:
> https://bioinformatics.stackexchange.com/a/3375/51
> 
> Hope that helps!
> 
> -Robert
> 
> On Tue, Apr 6, 2021 at 1:14 PM Andrew Dhawan <adhawan at qmed.ca> wrote:
> 
>> Thank you both very kindly - I have addressed both notes. I am still
>> wondering though about the RankProd dependency error - any insight into
>> this?
>>
>> Thanks!
>> Andrew
>>
>> On Tue, Apr 6, 2021 at 11:58 AM Uwe Ligges <
>> ligges at statistik.tu-dortmund.de>
>> wrote:
>>
>>>
>>>
>>> On 06.04.2021 17:39, Patrick Giraudoux wrote:
>>>> I had a similar problem with intepreting "notes" in pgirmess checks.
>>>> Some are lethal and lead to rejection and some not (just informative
>>>> comments). Fortunately Uwe has been kind enough to tell me what I
>> missed
>>>> (I thought that all notes were just "informative").
>>>> Would it be possible to call lethal notes "errors" to keep us aware
>> that
>>>> we must really do something with them and fix what is actually a
>> problem?
>>>
>>> These are Notes as it may not be a serious issue or may be a false
>>> positive, nevertheless, we like to get clean packages to CRAN.
>>>
>>> WARNINGs and ERRORs will never be accepted.
>>>
>>> The policies clearly say that significant Notes have to be addressed.
>>> The only Note that is always acceptable is the CRAN maintainer Note
>>> about the package maintainer's address. All other Notes should be fixed
>>> generally or need manual attention in case of the really very few
>>> exceptions.
>>>
>>> Best,
>>> Uwe Ligges
>>>
>>>
>>>
>>>
>>>> Best,
>>>> Patrick
>>>>
>>>>
>>>> Le 06/04/2021 ? 17:33, Uwe Ligges a ?crit :
>>>>> Two Notes:
>>>>>
>>>>>
>>>>> Found the following (possibly) invalid URLs:
>>>>>   URL: http://imagemagick.org/script/download.php (moved to
>>>>> https://imagemagick.org/script/download.php)
>>>>>     From: inst/doc/vignette.html
>>>>>     Status: 200
>>>>>     Message: OK
>>>>>
>>>>>
>>>>> Please change http --> https, add trailing slashes, or follow moved
>>>>> content as appropriate.
>>>>>
>>>>> * checking LazyData ... NOTE
>>>>>   'LazyData' is specified without a 'data' directory
>>>>>
>>>>> Simply omit the field if you have no data.
>>>>>
>>>>> Best,
>>>>> Uwe Ligges
>>>>>
>>>>>
>>>>>
>>>>> On 06.04.2021 16:27, Andrew Dhawan wrote:
>>>>>> Dear all,
>>>>>>
>>>>>> I am a bit puzzled by this error for the sigQC package being uploaded
>>> to
>>>>>> CRAN. Checks on my end pass without issue. There is one error
>>>>>> regarding the
>>>>>> bioConductor dependency RankProd that comes up only on the Debian OS
>>>>>> when
>>>>>> checking. See here for further details:
>>>>>>
>>>
>> https://win-builder.r-project.org/incoming_pretest/sigQC_0.1.22_20210406_110708/
>>>>>>
>>>>>>
>>>>>> I am not sure how to resolve this - it seems to me that the
>> dependency
>>>>>> *should* be available across platforms, and short of removing the
>>>>>> dependency (which we rely on a fair bit), I'm not sure what  we can
>> do.
>>>>>>
>>>>>> Any thoughts or suggestions would be massively appreciated.
>>>>>>
>>>>>> Thank you so kindly!
>>>>>> Andrew
>>>>>>
>>>>>>      [[alternative HTML version deleted]]
>>>>>>
>>>>>> ______________________________________________
>>>>>> R-package-devel at r-project.org mailing list
>>>>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>>>>
>>>>>
>>>>> ______________________________________________
>>>>> R-package-devel at r-project.org mailing list
>>>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>>
>>>>
>>>
>>
>>          [[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


From ros@rio@@voiio m@iii@g oii u@i@@@it  Wed Apr  7 10:49:03 2021
From: ros@rio@@voiio m@iii@g oii u@i@@@it (ros@rio@@voiio m@iii@g oii u@i@@@it)
Date: Wed, 7 Apr 2021 10:49:03 +0200
Subject: [R-pkg-devel] rtracklayer installation problems
Message-ID: <006301d72b8a$dc59c1b0$950d4510$@unina.it>

Hi everyone,

 

I hope this is the right e-mail I should have used; this is the first time
that I ask for help with R!

Yesterday, I installed the devel version of R (4.1) as I need to use a
package (RiboDiPa) which only works for this version.

The package requires, among the others, the package "rtracklayer". Since
yesterday I am struggling trying to install rtracklayer for devel version
without success.

Below you can find the final message I got before the installation stops.
Any idea of what might be the reason why I cannot install rtracklayer? 

 

ucsc/udc.c:46:10: fatal error: sys/mman.h: No such file or directory

#include <sys/mman.h>

          ^~~~~~~~~~~~

compilation terminated.

make: *** [Makevars.win:16: ucsc/udc.o] Error 1

ERROR: compilation failed for package 'rtracklayer'

* removing 'C:/Users/Rosario/Documents/R/win-library/4.1/rtracklayer'

 

If you need any other information please, do not hesitate to ask.

Thank you in advance for your help!

 

Best,

Rosario

 

 

Rosario Avolio, PhD

Researcher

Department of Molecular Medicine and Medical Biotechnology

Via Pansini, 5

19/A Building

80131 Napoli, Italy

email:  <mailto:rosario.avolio at unina.it> rosario.avolio at unina.it

phone: +39 081 746 31 39

 


	[[alternative HTML version deleted]]


From murdoch@dunc@n @end|ng |rom gm@||@com  Wed Apr  7 12:12:33 2021
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Wed, 7 Apr 2021 06:12:33 -0400
Subject: [R-pkg-devel] rtracklayer installation problems
In-Reply-To: <006301d72b8a$dc59c1b0$950d4510$@unina.it>
References: <006301d72b8a$dc59c1b0$950d4510$@unina.it>
Message-ID: <9d7a55a7-1eb9-d6ff-b472-c13d10e6cf8e@gmail.com>

On 07/04/2021 4:49 a.m., rosario.avolio at unina.it wrote:
> Hi everyone,
> 
>   
> 
> I hope this is the right e-mail I should have used; this is the first time
> that I ask for help with R!
> 
> Yesterday, I installed the devel version of R (4.1) as I need to use a
> package (RiboDiPa) which only works for this version.
> 
> The package requires, among the others, the package "rtracklayer". Since
> yesterday I am struggling trying to install rtracklayer for devel version
> without success.
> 
> Below you can find the final message I got before the installation stops.
> Any idea of what might be the reason why I cannot install rtracklayer?
> 
>   
> 
> ucsc/udc.c:46:10: fatal error: sys/mman.h: No such file or directory
> 
> #include <sys/mman.h>
> 
>            ^~~~~~~~~~~~
> 
> compilation terminated.
> 
> make: *** [Makevars.win:16: ucsc/udc.o] Error 1
> 
> ERROR: compilation failed for package 'rtracklayer'
> 
> * removing 'C:/Users/Rosario/Documents/R/win-library/4.1/rtracklayer'
> 
>   
> 
> If you need any other information please, do not hesitate to ask.
> 
> Thank you in advance for your help!

rtracklayer is a Bioconductor package, so you're probably better off 
asking on their support site https://support.bioconductor.org/.  When 
you do, please show the command you used for the install; it's possible 
a simple change there will fix things.

Duncan Murdoch


From Gordon@Brown @end|ng |rom cruk@c@m@@c@uk  Wed Apr  7 12:32:27 2021
From: Gordon@Brown @end|ng |rom cruk@c@m@@c@uk (Gordon Brown)
Date: Wed, 7 Apr 2021 10:32:27 +0000
Subject: [R-pkg-devel] rtracklayer installation problems
In-Reply-To: <006301d72b8a$dc59c1b0$950d4510$@unina.it>
References: <006301d72b8a$dc59c1b0$950d4510$@unina.it>
Message-ID: <58FFB999-57BA-4815-9B8E-2FB9DD8104C5@cruk.cam.ac.uk>

Hi, Rosario,

The message is telling you that you need to install the development header files for glibc on your computer.  This is a set of files that are needed for building some kinds of software, but are not installed by default.  Are you working on some sort of Linux machine?  On Centos 8, the relevant package to install is called "glibc-headers".  On Ubuntu 20.04 it's "libc6-dev".  You'd need to run a command in the shell, something like:

Centos:
> sudo dnf install glibc-headers
or
> sudo yum install glibc-headers

Ubuntu/Debian:
> sudo apt install libc6-dev

If it's Windows or Mac, I can't help...

If you don't have root access on your host, or the above doesn't make sense to you, you will need to talk to whoever administers your computing environment, asking them to install the relevant package.

Hope this helps.

 - Gord


?On 20210407, 11:03, "R-package-devel on behalf of rosario.avolio at unina.it" <r-package-devel-bounces at r-project.org on behalf of rosario.avolio at unina.it> wrote:

    Hi everyone,



    I hope this is the right e-mail I should have used; this is the first time
    that I ask for help with R!

    Yesterday, I installed the devel version of R (4.1) as I need to use a
    package (RiboDiPa) which only works for this version.

    The package requires, among the others, the package "rtracklayer". Since
    yesterday I am struggling trying to install rtracklayer for devel version
    without success.

    Below you can find the final message I got before the installation stops.
    Any idea of what might be the reason why I cannot install rtracklayer? 



    ucsc/udc.c:46:10: fatal error: sys/mman.h: No such file or directory

    #include <sys/mman.h>

              ^~~~~~~~~~~~

    compilation terminated.

    make: *** [https://linkprotect.cudasvc.com/url?a=https%3a%2f%2fMakevars.win%3a16&c=E,1,aB4mtmdcaXh3y_rFcDWiXKtEvYZoLA3GcTOtz2EAwNVyTaBV0cLYVfIMvPNYj-c9QK7LiaHqut3FcMfCLlVShgqSAdXj_xGXP8nS49zX7vVKE9rNPhmLmWDTnyU,&typo=1: ucsc/udc.o] Error 1

    ERROR: compilation failed for package 'rtracklayer'

    * removing 'C:/Users/Rosario/Documents/R/win-library/4.1/rtracklayer'



    If you need any other information please, do not hesitate to ask.

    Thank you in advance for your help!



    Best,

    Rosario





    Rosario Avolio, PhD

    Researcher

    Department of Molecular Medicine and Medical Biotechnology

    Via Pansini, 5

    19/A Building

    80131 Napoli, Italy

    email:  <mailto:rosario.avolio at unina.it> rosario.avolio at unina.it

    phone: +39 081 746 31 39




    	[[alternative HTML version deleted]]

    ______________________________________________
    R-package-devel at r-project.org mailing list
    https://stat.ethz.ch/mailman/listinfo/r-package-devel


From r|@e|@mp| @end|ng |rom gm@||@com  Wed Apr  7 12:18:33 2021
From: r|@e|@mp| @end|ng |rom gm@||@com (Rafael CM)
Date: Wed, 7 Apr 2021 12:18:33 +0200
Subject: [R-pkg-devel] R package depends on Bioconductor packages RTIGER
Message-ID: <CA+NKSawVGMTNd_bK0Eo460Td7AbMenxXQ8yf8bL84dgjk12fmQ@mail.gmail.com>

Dear all,
I am trying to submit a package to CRAN that depends on Bioconductor
packages. On debian, I do not have any problems so far. But when checking
for windows I get several errors:

Error: package or namespace load failed for 'Gviz' in loadNamespace(j
<- i[[1L]], c(lib.loc, .libPaths()), versionCheck = vI[[j]]):
 namespace 'rtracklayer' 1.48.0 is already loaded, but >= 1.51.5 is required
Error: package 'Gviz' could not be loaded
In addition: Warning message:
multiple methods tables found for 'export'
Execution halted
ERROR: lazy loading failed for package 'RTIGER'
* removing 'd:/RCompile/CRANincoming/R-devel/lib/RTIGER'
* restoring previous 'd:/RCompile/CRANincoming/R-devel/lib/RTIGER'

Could someone help me?

Thank you very much,

Rafael

	[[alternative HTML version deleted]]


From mtmorg@n@b|oc @end|ng |rom gm@||@com  Wed Apr  7 13:29:05 2021
From: mtmorg@n@b|oc @end|ng |rom gm@||@com (Martin Morgan)
Date: Wed, 7 Apr 2021 11:29:05 +0000
Subject: [R-pkg-devel] rtracklayer installation problems
In-Reply-To: <58FFB999-57BA-4815-9B8E-2FB9DD8104C5@cruk.cam.ac.uk>
References: <006301d72b8a$dc59c1b0$950d4510$@unina.it>
 <58FFB999-57BA-4815-9B8E-2FB9DD8104C5@cruk.cam.ac.uk>
Message-ID: <MN2PR04MB6256AB784F6BA72D066F6335F9759@MN2PR04MB6256.namprd04.prod.outlook.com>

From the Bioconductor 'devel' (3.13, used with R-devel) 'landing page' for rtracklayer

https://bioconductor.org/packages/devel/rtracklayer

The 'build' badge is red; clicking on it shows a build system problem with rtracklayer on Windows. Scrolling on the landing page to the bottom shows

Source Package	rtracklayer_1.51.5.tar.gz
Windows Binary	
macOS 10.13 (High Sierra)	rtracklayer_1.51.5.tgz
Source Repository	



?On 4/7/21, 6:32 AM, "R-package-devel on behalf of Gordon Brown" <r-package-devel-bounces at r-project.org on behalf of Gordon.Brown at cruk.cam.ac.uk> wrote:

    Hi, Rosario,

    The message is telling you that you need to install the development header files for glibc on your computer.  This is a set of files that are needed for building some kinds of software, but are not installed by default.  Are you working on some sort of Linux machine?  On Centos 8, the relevant package to install is called "glibc-headers".  On Ubuntu 20.04 it's "libc6-dev".  You'd need to run a command in the shell, something like:

    Centos:
    > sudo dnf install glibc-headers
    or
    > sudo yum install glibc-headers

    Ubuntu/Debian:
    > sudo apt install libc6-dev

    If it's Windows or Mac, I can't help...

    If you don't have root access on your host, or the above doesn't make sense to you, you will need to talk to whoever administers your computing environment, asking them to install the relevant package.

    Hope this helps.

     - Gord


    ?On 20210407, 11:03, "R-package-devel on behalf of rosario.avolio at unina.it" <r-package-devel-bounces at r-project.org on behalf of rosario.avolio at unina.it> wrote:

        Hi everyone,



        I hope this is the right e-mail I should have used; this is the first time
        that I ask for help with R!

        Yesterday, I installed the devel version of R (4.1) as I need to use a
        package (RiboDiPa) which only works for this version.

        The package requires, among the others, the package "rtracklayer". Since
        yesterday I am struggling trying to install rtracklayer for devel version
        without success.

        Below you can find the final message I got before the installation stops.
        Any idea of what might be the reason why I cannot install rtracklayer? 



        ucsc/udc.c:46:10: fatal error: sys/mman.h: No such file or directory

        #include <sys/mman.h>

                  ^~~~~~~~~~~~

        compilation terminated.

        make: *** [https://linkprotect.cudasvc.com/url?a=https%3a%2f%2fMakevars.win%3a16&c=E,1,aB4mtmdcaXh3y_rFcDWiXKtEvYZoLA3GcTOtz2EAwNVyTaBV0cLYVfIMvPNYj-c9QK7LiaHqut3FcMfCLlVShgqSAdXj_xGXP8nS49zX7vVKE9rNPhmLmWDTnyU,&typo=1: ucsc/udc.o] Error 1

        ERROR: compilation failed for package 'rtracklayer'

        * removing 'C:/Users/Rosario/Documents/R/win-library/4.1/rtracklayer'



        If you need any other information please, do not hesitate to ask.

        Thank you in advance for your help!



        Best,

        Rosario





        Rosario Avolio, PhD

        Researcher

        Department of Molecular Medicine and Medical Biotechnology

        Via Pansini, 5

        19/A Building

        80131 Napoli, Italy

        email:  <mailto:rosario.avolio at unina.it> rosario.avolio at unina.it

        phone: +39 081 746 31 39




        	[[alternative HTML version deleted]]

        ______________________________________________
        R-package-devel at r-project.org mailing list
        https://stat.ethz.ch/mailman/listinfo/r-package-devel

    ______________________________________________
    R-package-devel at r-project.org mailing list
    https://stat.ethz.ch/mailman/listinfo/r-package-devel

From mtmorg@n@b|oc @end|ng |rom gm@||@com  Wed Apr  7 13:33:37 2021
From: mtmorg@n@b|oc @end|ng |rom gm@||@com (Martin Morgan)
Date: Wed, 7 Apr 2021 11:33:37 +0000
Subject: [R-pkg-devel] rtracklayer installation problems
In-Reply-To: <58FFB999-57BA-4815-9B8E-2FB9DD8104C5@cruk.cam.ac.uk>
References: <006301d72b8a$dc59c1b0$950d4510$@unina.it>,
 <58FFB999-57BA-4815-9B8E-2FB9DD8104C5@cruk.cam.ac.uk>
Message-ID: <MN2PR04MB625689B3F0C1050D6805EBBBF9759@MN2PR04MB6256.namprd04.prod.outlook.com>

(sorry, too quick on the return key)

?From the Bioconductor 'devel' (3.13, used with R-devel) 'landing page' for rtracklayer

https://bioconductor.org/packages/devel/rtracklayer

The 'build' badge is red; clicking on it shows a build system problem with rtracklayer on Windows. Scrolling on the landing page to the bottom shows

Source Package	rtracklayer_1.51.5.tar.gz
Windows Binary	
macOS 10.13 (High Sierra)	rtracklayer_1.51.5.tgz

so there is currently no Windows binary available. This is in the hands of the rtracklayer maintainer; there is a very high likelihood that it will be fixed, so either be patient or ask the rtracklayer maintainer directly to address this by, e.g., opening an issue at https://github.com/lawremi/rtracklayer

Martin Morgan


?On 4/7/21, 6:32 AM, "R-package-devel on behalf of Gordon Brown" <r-package-devel-bounces at r-project.org on behalf of Gordon.Brown at cruk.cam.ac.uk> wrote:

    Hi, Rosario,

    The message is telling you that you need to install the development header files for glibc on your computer.  This is a set of files that are needed for building some kinds of software, but are not installed by default.  Are you working on some sort of Linux machine?  On Centos 8, the relevant package to install is called "glibc-headers".  On Ubuntu 20.04 it's "libc6-dev".  You'd need to run a command in the shell, something like:

    Centos:
    > sudo dnf install glibc-headers
    or
    > sudo yum install glibc-headers

    Ubuntu/Debian:
    > sudo apt install libc6-dev

    If it's Windows or Mac, I can't help...

    If you don't have root access on your host, or the above doesn't make sense to you, you will need to talk to whoever administers your computing environment, asking them to install the relevant package.

    Hope this helps.

     - Gord


    ?On 20210407, 11:03, "R-package-devel on behalf of rosario.avolio at unina.it" <r-package-devel-bounces at r-project.org on behalf of rosario.avolio at unina.it> wrote:

        Hi everyone,



        I hope this is the right e-mail I should have used; this is the first time
        that I ask for help with R!

        Yesterday, I installed the devel version of R (4.1) as I need to use a
        package (RiboDiPa) which only works for this version.

        The package requires, among the others, the package "rtracklayer". Since
        yesterday I am struggling trying to install rtracklayer for devel version
        without success.

        Below you can find the final message I got before the installation stops.
        Any idea of what might be the reason why I cannot install rtracklayer? 



        ucsc/udc.c:46:10: fatal error: sys/mman.h: No such file or directory

        #include <sys/mman.h>

                  ^~~~~~~~~~~~

        compilation terminated.

        make: *** [https://linkprotect.cudasvc.com/url?a=https%3a%2f%2fMakevars.win%3a16&c=E,1,aB4mtmdcaXh3y_rFcDWiXKtEvYZoLA3GcTOtz2EAwNVyTaBV0cLYVfIMvPNYj-c9QK7LiaHqut3FcMfCLlVShgqSAdXj_xGXP8nS49zX7vVKE9rNPhmLmWDTnyU,&typo=1: ucsc/udc.o] Error 1

        ERROR: compilation failed for package 'rtracklayer'

        * removing 'C:/Users/Rosario/Documents/R/win-library/4.1/rtracklayer'



        If you need any other information please, do not hesitate to ask.

        Thank you in advance for your help!



        Best,

        Rosario





        Rosario Avolio, PhD

        Researcher

        Department of Molecular Medicine and Medical Biotechnology

        Via Pansini, 5

        19/A Building

        80131 Napoli, Italy

        email:  <mailto:rosario.avolio at unina.it> rosario.avolio at unina.it

        phone: +39 081 746 31 39




        	[[alternative HTML version deleted]]

        ______________________________________________
        R-package-devel at r-project.org mailing list
        https://stat.ethz.ch/mailman/listinfo/r-package-devel

    ______________________________________________
    R-package-devel at r-project.org mailing list
    https://stat.ethz.ch/mailman/listinfo/r-package-devel

From ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de  Wed Apr  7 16:19:28 2021
From: ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de (Uwe Ligges)
Date: Wed, 7 Apr 2021 16:19:28 +0200
Subject: [R-pkg-devel] R package depends on Bioconductor packages RTIGER
In-Reply-To: <CA+NKSawVGMTNd_bK0Eo460Td7AbMenxXQ8yf8bL84dgjk12fmQ@mail.gmail.com>
References: <CA+NKSawVGMTNd_bK0Eo460Td7AbMenxXQ8yf8bL84dgjk12fmQ@mail.gmail.com>
Message-ID: <7aa2b51b-d095-cd01-c60f-39ff31d5e249@statistik.tu-dortmund.de>

Reason is that BioC 3.13 does not offer a new rtracklayer binary which 
the winbuilder machine typically uses.
As this also does not install from sources for me. So this seems hard to 
set up.


Best,
Uwe Ligges








On 07.04.2021 12:18, Rafael CM wrote:
> Dear all,
> I am trying to submit a package to CRAN that depends on Bioconductor
> packages. On debian, I do not have any problems so far. But when checking
> for windows I get several errors:
> 
> Error: package or namespace load failed for 'Gviz' in loadNamespace(j
> <- i[[1L]], c(lib.loc, .libPaths()), versionCheck = vI[[j]]):
>   namespace 'rtracklayer' 1.48.0 is already loaded, but >= 1.51.5 is required
> Error: package 'Gviz' could not be loaded
> In addition: Warning message:
> multiple methods tables found for 'export'
> Execution halted
> ERROR: lazy loading failed for package 'RTIGER'
> * removing 'd:/RCompile/CRANincoming/R-devel/lib/RTIGER'
> * restoring previous 'd:/RCompile/CRANincoming/R-devel/lib/RTIGER'
> 
> Could someone help me?
> 
> Thank you very much,
> 
> Rafael
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


From @dh@w@n @end|ng |rom qmed@c@  Wed Apr  7 16:50:07 2021
From: @dh@w@n @end|ng |rom qmed@c@ (Andrew Dhawan)
Date: Wed, 7 Apr 2021 10:50:07 -0400
Subject: [R-pkg-devel] Package Rejection Error Help
In-Reply-To: <54a5e644-3d17-be4a-c0bf-082d0ea5a59f@statistik.tu-dortmund.de>
References: <CAOK8EzfgUK4jNtXE6zE4-Mxig=VoR5nAMXw517ypzJvRPd6Avg@mail.gmail.com>
 <d96ab7f7-b91e-b901-414e-7314c04c51f7@statistik.tu-dortmund.de>
 <184d0c80-1223-508e-425f-e8df828892cf@univ-fcomte.fr>
 <fb21bbc0-810c-995d-8c6a-cf4645379313@statistik.tu-dortmund.de>
 <CAOK8EzcGv=ktad0AjtjOcQa5706WAy+zsAk3gkwOjeV-NUqPLA@mail.gmail.com>
 <CAJLyBTUoRvY7xZDVjswE_r8wsg_E0-DTS78__zi6dUmtu=yhTw@mail.gmail.com>
 <54a5e644-3d17-be4a-c0bf-082d0ea5a59f@statistik.tu-dortmund.de>
Message-ID: <CAOK8EzdRYv_FtaaOA8W6shqJv6-0Ov69TMQ+eWA8=Sacj7w+Fw@mail.gmail.com>

Thank you again Uwe,

So, to clarify - is the error occurring because RankProd is not found in
BioC 3.13 (current release is 3.12)?  If so, I'm not sure how I can fix
this...

Thanks
Andrew


On Wed, Apr 7, 2021 at 5:45 AM Uwe Ligges <ligges at statistik.tu-dortmund.de>
wrote:

>
>
> On 06.04.2021 19:26, Robert M. Flight wrote:
> > Andrew,
> >
> > I think if you want to include a Bioconductor dependency, then I think
> you
> > add the "biocViews:" line to your description file to enable bioconductor
>
> Not needed for CRAN.
>
> You simply need to declare the dependency, but BioC 3.13 is what we
> should use to check with R-devel and that was recetnly still pretty
> iunstable.
>
> Best,
> Uwe Ligges
>
> > package installation.
> >
> > See this answer on Bioinformatics stackexchange:
> > https://bioinformatics.stackexchange.com/a/3375/51
> >
> > Hope that helps!
> >
> > -Robert
> >
> > On Tue, Apr 6, 2021 at 1:14 PM Andrew Dhawan <adhawan at qmed.ca> wrote:
> >
> >> Thank you both very kindly - I have addressed both notes. I am still
> >> wondering though about the RankProd dependency error - any insight into
> >> this?
> >>
> >> Thanks!
> >> Andrew
> >>
> >> On Tue, Apr 6, 2021 at 11:58 AM Uwe Ligges <
> >> ligges at statistik.tu-dortmund.de>
> >> wrote:
> >>
> >>>
> >>>
> >>> On 06.04.2021 17:39, Patrick Giraudoux wrote:
> >>>> I had a similar problem with intepreting "notes" in pgirmess checks.
> >>>> Some are lethal and lead to rejection and some not (just informative
> >>>> comments). Fortunately Uwe has been kind enough to tell me what I
> >> missed
> >>>> (I thought that all notes were just "informative").
> >>>> Would it be possible to call lethal notes "errors" to keep us aware
> >> that
> >>>> we must really do something with them and fix what is actually a
> >> problem?
> >>>
> >>> These are Notes as it may not be a serious issue or may be a false
> >>> positive, nevertheless, we like to get clean packages to CRAN.
> >>>
> >>> WARNINGs and ERRORs will never be accepted.
> >>>
> >>> The policies clearly say that significant Notes have to be addressed.
> >>> The only Note that is always acceptable is the CRAN maintainer Note
> >>> about the package maintainer's address. All other Notes should be fixed
> >>> generally or need manual attention in case of the really very few
> >>> exceptions.
> >>>
> >>> Best,
> >>> Uwe Ligges
> >>>
> >>>
> >>>
> >>>
> >>>> Best,
> >>>> Patrick
> >>>>
> >>>>
> >>>> Le 06/04/2021 ? 17:33, Uwe Ligges a ?crit :
> >>>>> Two Notes:
> >>>>>
> >>>>>
> >>>>> Found the following (possibly) invalid URLs:
> >>>>>   URL: http://imagemagick.org/script/download.php (moved to
> >>>>> https://imagemagick.org/script/download.php)
> >>>>>     From: inst/doc/vignette.html
> >>>>>     Status: 200
> >>>>>     Message: OK
> >>>>>
> >>>>>
> >>>>> Please change http --> https, add trailing slashes, or follow moved
> >>>>> content as appropriate.
> >>>>>
> >>>>> * checking LazyData ... NOTE
> >>>>>   'LazyData' is specified without a 'data' directory
> >>>>>
> >>>>> Simply omit the field if you have no data.
> >>>>>
> >>>>> Best,
> >>>>> Uwe Ligges
> >>>>>
> >>>>>
> >>>>>
> >>>>> On 06.04.2021 16:27, Andrew Dhawan wrote:
> >>>>>> Dear all,
> >>>>>>
> >>>>>> I am a bit puzzled by this error for the sigQC package being
> uploaded
> >>> to
> >>>>>> CRAN. Checks on my end pass without issue. There is one error
> >>>>>> regarding the
> >>>>>> bioConductor dependency RankProd that comes up only on the Debian OS
> >>>>>> when
> >>>>>> checking. See here for further details:
> >>>>>>
> >>>
> >>
> https://win-builder.r-project.org/incoming_pretest/sigQC_0.1.22_20210406_110708/
> >>>>>>
> >>>>>>
> >>>>>> I am not sure how to resolve this - it seems to me that the
> >> dependency
> >>>>>> *should* be available across platforms, and short of removing the
> >>>>>> dependency (which we rely on a fair bit), I'm not sure what  we can
> >> do.
> >>>>>>
> >>>>>> Any thoughts or suggestions would be massively appreciated.
> >>>>>>
> >>>>>> Thank you so kindly!
> >>>>>> Andrew
> >>>>>>
> >>>>>>      [[alternative HTML version deleted]]
> >>>>>>
> >>>>>> ______________________________________________
> >>>>>> R-package-devel at r-project.org mailing list
> >>>>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
> >>>>>>
> >>>>>
> >>>>> ______________________________________________
> >>>>> R-package-devel at r-project.org mailing list
> >>>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
> >>>>
> >>>>
> >>>
> >>
> >>          [[alternative HTML version deleted]]
> >>
> >> ______________________________________________
> >> R-package-devel at r-project.org mailing list
> >> https://stat.ethz.ch/mailman/listinfo/r-package-devel
> >>
> >
> >       [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-package-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-package-devel
> >
>

	[[alternative HTML version deleted]]


From murdoch@dunc@n @end|ng |rom gm@||@com  Wed Apr  7 18:21:23 2021
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Wed, 7 Apr 2021 12:21:23 -0400
Subject: [R-pkg-devel] Package Rejection Error Help
In-Reply-To: <CAOK8EzdRYv_FtaaOA8W6shqJv6-0Ov69TMQ+eWA8=Sacj7w+Fw@mail.gmail.com>
References: <CAOK8EzfgUK4jNtXE6zE4-Mxig=VoR5nAMXw517ypzJvRPd6Avg@mail.gmail.com>
 <d96ab7f7-b91e-b901-414e-7314c04c51f7@statistik.tu-dortmund.de>
 <184d0c80-1223-508e-425f-e8df828892cf@univ-fcomte.fr>
 <fb21bbc0-810c-995d-8c6a-cf4645379313@statistik.tu-dortmund.de>
 <CAOK8EzcGv=ktad0AjtjOcQa5706WAy+zsAk3gkwOjeV-NUqPLA@mail.gmail.com>
 <CAJLyBTUoRvY7xZDVjswE_r8wsg_E0-DTS78__zi6dUmtu=yhTw@mail.gmail.com>
 <54a5e644-3d17-be4a-c0bf-082d0ea5a59f@statistik.tu-dortmund.de>
 <CAOK8EzdRYv_FtaaOA8W6shqJv6-0Ov69TMQ+eWA8=Sacj7w+Fw@mail.gmail.com>
Message-ID: <f3b12a58-2a29-d335-4f71-361bb07505ca@gmail.com>

On 07/04/2021 10:50 a.m., Andrew Dhawan wrote:
> Thank you again Uwe,
> 
> So, to clarify - is the error occurring because RankProd is not found in
> BioC 3.13 (current release is 3.12)?  If so, I'm not sure how I can fix
> this...

I suspect the only thing you could do in the short term is to remove 
that dependency (or move it to Suggests, and check for it before using). 
  If that's not feasible, then you just need to wait for it to become 
available.  Based on its status page, it shouldn't be long.  Try 
submitting again tomorrow?

Duncan Murdoch


> 
> Thanks
> Andrew
> 
> 
> On Wed, Apr 7, 2021 at 5:45 AM Uwe Ligges <ligges at statistik.tu-dortmund.de>
> wrote:
> 
>>
>>
>> On 06.04.2021 19:26, Robert M. Flight wrote:
>>> Andrew,
>>>
>>> I think if you want to include a Bioconductor dependency, then I think
>> you
>>> add the "biocViews:" line to your description file to enable bioconductor
>>
>> Not needed for CRAN.
>>
>> You simply need to declare the dependency, but BioC 3.13 is what we
>> should use to check with R-devel and that was recetnly still pretty
>> iunstable.
>>
>> Best,
>> Uwe Ligges
>>
>>> package installation.
>>>
>>> See this answer on Bioinformatics stackexchange:
>>> https://bioinformatics.stackexchange.com/a/3375/51
>>>
>>> Hope that helps!
>>>
>>> -Robert
>>>
>>> On Tue, Apr 6, 2021 at 1:14 PM Andrew Dhawan <adhawan at qmed.ca> wrote:
>>>
>>>> Thank you both very kindly - I have addressed both notes. I am still
>>>> wondering though about the RankProd dependency error - any insight into
>>>> this?
>>>>
>>>> Thanks!
>>>> Andrew
>>>>
>>>> On Tue, Apr 6, 2021 at 11:58 AM Uwe Ligges <
>>>> ligges at statistik.tu-dortmund.de>
>>>> wrote:
>>>>
>>>>>
>>>>>
>>>>> On 06.04.2021 17:39, Patrick Giraudoux wrote:
>>>>>> I had a similar problem with intepreting "notes" in pgirmess checks.
>>>>>> Some are lethal and lead to rejection and some not (just informative
>>>>>> comments). Fortunately Uwe has been kind enough to tell me what I
>>>> missed
>>>>>> (I thought that all notes were just "informative").
>>>>>> Would it be possible to call lethal notes "errors" to keep us aware
>>>> that
>>>>>> we must really do something with them and fix what is actually a
>>>> problem?
>>>>>
>>>>> These are Notes as it may not be a serious issue or may be a false
>>>>> positive, nevertheless, we like to get clean packages to CRAN.
>>>>>
>>>>> WARNINGs and ERRORs will never be accepted.
>>>>>
>>>>> The policies clearly say that significant Notes have to be addressed.
>>>>> The only Note that is always acceptable is the CRAN maintainer Note
>>>>> about the package maintainer's address. All other Notes should be fixed
>>>>> generally or need manual attention in case of the really very few
>>>>> exceptions.
>>>>>
>>>>> Best,
>>>>> Uwe Ligges
>>>>>
>>>>>
>>>>>
>>>>>
>>>>>> Best,
>>>>>> Patrick
>>>>>>
>>>>>>
>>>>>> Le 06/04/2021 ? 17:33, Uwe Ligges a ?crit :
>>>>>>> Two Notes:
>>>>>>>
>>>>>>>
>>>>>>> Found the following (possibly) invalid URLs:
>>>>>>>    URL: http://imagemagick.org/script/download.php (moved to
>>>>>>> https://imagemagick.org/script/download.php)
>>>>>>>      From: inst/doc/vignette.html
>>>>>>>      Status: 200
>>>>>>>      Message: OK
>>>>>>>
>>>>>>>
>>>>>>> Please change http --> https, add trailing slashes, or follow moved
>>>>>>> content as appropriate.
>>>>>>>
>>>>>>> * checking LazyData ... NOTE
>>>>>>>    'LazyData' is specified without a 'data' directory
>>>>>>>
>>>>>>> Simply omit the field if you have no data.
>>>>>>>
>>>>>>> Best,
>>>>>>> Uwe Ligges
>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>> On 06.04.2021 16:27, Andrew Dhawan wrote:
>>>>>>>> Dear all,
>>>>>>>>
>>>>>>>> I am a bit puzzled by this error for the sigQC package being
>> uploaded
>>>>> to
>>>>>>>> CRAN. Checks on my end pass without issue. There is one error
>>>>>>>> regarding the
>>>>>>>> bioConductor dependency RankProd that comes up only on the Debian OS
>>>>>>>> when
>>>>>>>> checking. See here for further details:
>>>>>>>>
>>>>>
>>>>
>> https://win-builder.r-project.org/incoming_pretest/sigQC_0.1.22_20210406_110708/
>>>>>>>>
>>>>>>>>
>>>>>>>> I am not sure how to resolve this - it seems to me that the
>>>> dependency
>>>>>>>> *should* be available across platforms, and short of removing the
>>>>>>>> dependency (which we rely on a fair bit), I'm not sure what  we can
>>>> do.
>>>>>>>>
>>>>>>>> Any thoughts or suggestions would be massively appreciated.
>>>>>>>>
>>>>>>>> Thank you so kindly!
>>>>>>>> Andrew
>>>>>>>>
>>>>>>>>       [[alternative HTML version deleted]]
>>>>>>>>
>>>>>>>> ______________________________________________
>>>>>>>> R-package-devel at r-project.org mailing list
>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>>>>>>
>>>>>>>
>>>>>>> ______________________________________________
>>>>>>> R-package-devel at r-project.org mailing list
>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>>>>
>>>>>>
>>>>>
>>>>
>>>>           [[alternative HTML version deleted]]
>>>>
>>>> ______________________________________________
>>>> R-package-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>>
>>>
>>>        [[alternative HTML version deleted]]
>>>
>>> ______________________________________________
>>> R-package-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>
>>
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


From dw|n@em|u@ @end|ng |rom comc@@t@net  Thu Apr  8 02:14:17 2021
From: dw|n@em|u@ @end|ng |rom comc@@t@net (David Winsemius)
Date: Wed, 7 Apr 2021 17:14:17 -0700
Subject: [R-pkg-devel] how to address CRAN FAIL on
 r-devel-windows-x86_64-gcc10-UCRT?
In-Reply-To: <bc01010e-b9cc-b561-fc2b-b2dd5c98a706@comcast.net>
References: <916FE36D-C70F-4E00-AC87-9335B4AA5A0C@dal.ca>
 <bc01010e-b9cc-b561-fc2b-b2dd5c98a706@comcast.net>
Message-ID: <07278af2-1e19-f4bf-2df6-fb2d60d2cdfc@comcast.net>


On 4/2/21 1:08 PM, David Winsemius wrote:
>
> On 4/2/21 4:05 AM, Daniel Kelley wrote:
>> The "oce" package for oceanographic analysis is failing a check on 
>> the r-devel-windows-x86_64-gcc10-UCRT system (see
>> https://www.r-project.org/nosvn/R.check/r-devel-windows-x86_64-gcc10-UCRT/oce-00check.html). 
>> The problem seems to relate to the checking vignette outputs.
>>
>> According to 
>> https://www.r-project.org/nosvn/winutf8/ucrt3/CRAN/checks/gcc10-UCRT/README.txt, 
>> that test setup is experimental.? Does that mean that I ought to I 
>> ignore the FAIL status for this machine, perhaps checking it once in 
>> a while to see if it changes?
> Hello Daniel;
>
> I'm not speaking for CRAN. I'm another maintainer whose current status 
> page has a FAIL for that platform. But the FAIL notation is due at 
> least in part to the fact that apparently the UCRT platform is less 
> frequently run on the full CRAN package holdings. The note refers to a 
> package that was updated a few days ago. The log file however has two 
> other reports of failure relating to compiler warnings.
>
> All the other platforms passed the newer versions. There is no mention 
> of the UCRT platform at the CRAN Policies page: 
> https://cran.r-project.org/web/packages/policies.html
>
> I'm waiting to see whether the aging fortran code generates warnings 
> whenever the UCRT platform gets fired up again.


Follow-up on UCRT package checks for muhaz package. When the version 
that corrected R code errors was eventually run, it now has a status of 
"OK". Apparently the warnings about the Fortran code are not 
sufficiently worrisome. It still have an LTO link but the status page 
doesn't even consider the warnings contained therein to be worthy of 
being called warnings or notes.


-- 

David Winsemius


From roy@mende|@@ohn @end|ng |rom no@@@gov  Thu Apr  8 06:48:49 2021
From: roy@mende|@@ohn @end|ng |rom no@@@gov (Roy Mendelssohn - NOAA Federal)
Date: Wed, 7 Apr 2021 21:48:49 -0700
Subject: [R-pkg-devel] Checking on Debian on RHub
Message-ID: <CECC916B-ADFF-48D0-A88C-622AAF240703@noaa.gov>

Hi All:

I still have problems with checking one of my packages on RHub running Debian,  as the Preprocessing fails in building in some of the needed spatial packages.  This problem was reported quite awhile ago,  and never appears to have been completely fixed.  Is there an alternate place I can test a package under Debian that is consistent with CRAN.

Thanks,

-Roy

**********************
"The contents of this message do not reflect any position of the U.S. Government or NOAA."
**********************
Roy Mendelssohn
Supervisory Operations Research Analyst
NOAA/NMFS
Environmental Research Division
Southwest Fisheries Science Center
***Note new street address***
110 McAllister Way
Santa Cruz, CA 95060
Phone: (831)-420-3666
Fax: (831) 420-3980
e-mail: Roy.Mendelssohn at noaa.gov www: https://www.pfeg.noaa.gov/

"Old age and treachery will overcome youth and skill."
"From those who have been given much, much will be expected" 
"the arc of the moral universe is long, but it bends toward justice" -MLK Jr.


From c@@rd|@g@bor @end|ng |rom gm@||@com  Thu Apr  8 09:22:57 2021
From: c@@rd|@g@bor @end|ng |rom gm@||@com (=?UTF-8?B?R8OhYm9yIENzw6FyZGk=?=)
Date: Thu, 8 Apr 2021 09:22:57 +0200
Subject: [R-pkg-devel] Checking on Debian on RHub
In-Reply-To: <CECC916B-ADFF-48D0-A88C-622AAF240703@noaa.gov>
References: <CECC916B-ADFF-48D0-A88C-622AAF240703@noaa.gov>
Message-ID: <CABtg=K=EKNu17NZDW2qH5M-+DMz_+RrL6xBMbsmW8mT=Mw+7Ew@mail.gmail.com>

Hi,

Which one is your package? Which spatial package fails? Can you link
to an issue in the issue tracker, if there is one?

As for an alternative, you can run a Docker container. This works on
Linux, Windows and macOS, on any recent enough machine. You can run
one of the R-hub containers, e.g.
https://hub.docker.com/repository/docker/rhub/debian-gcc-devel and
then try to fix the installation issue. Or you can try a bigger
container that tries to mirror CRAN exactly:
https://hub.docker.com/r/cran/debian

Gabor

On Thu, Apr 8, 2021 at 6:49 AM Roy Mendelssohn - NOAA Federal via
R-package-devel <r-package-devel at r-project.org> wrote:
>
> Hi All:
>
> I still have problems with checking one of my packages on RHub running Debian,  as the Preprocessing fails in building in some of the needed spatial packages.  This problem was reported quite awhile ago,  and never appears to have been completely fixed.  Is there an alternate place I can test a package under Debian that is consistent with CRAN.
>
> Thanks,
>
> -Roy
>
> **********************
> "The contents of this message do not reflect any position of the U.S. Government or NOAA."
> **********************
> Roy Mendelssohn
> Supervisory Operations Research Analyst
> NOAA/NMFS
> Environmental Research Division
> Southwest Fisheries Science Center
> ***Note new street address***
> 110 McAllister Way
> Santa Cruz, CA 95060
> Phone: (831)-420-3666
> Fax: (831) 420-3980
> e-mail: Roy.Mendelssohn at noaa.gov www: https://www.pfeg.noaa.gov/
>
> "Old age and treachery will overcome youth and skill."
> "From those who have been given much, much will be expected"
> "the arc of the moral universe is long, but it bends toward justice" -MLK Jr.
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From roy@mende|@@ohn @end|ng |rom no@@@gov  Thu Apr  8 16:35:40 2021
From: roy@mende|@@ohn @end|ng |rom no@@@gov (Roy Mendelssohn - NOAA Federal)
Date: Thu, 8 Apr 2021 07:35:40 -0700
Subject: [R-pkg-devel] Checking on Debian on RHub
In-Reply-To: <CABtg=K=EKNu17NZDW2qH5M-+DMz_+RrL6xBMbsmW8mT=Mw+7Ew@mail.gmail.com>
References: <CECC916B-ADFF-48D0-A88C-622AAF240703@noaa.gov>
 <CABtg=K=EKNu17NZDW2qH5M-+DMz_+RrL6xBMbsmW8mT=Mw+7Ew@mail.gmail.com>
Message-ID: <218565F1-D623-48AB-B4F9-5AFA3E4BF81A@noaa.gov>

Thanks Gabor.  I will post more information later today when I get a chance.  I actually put something on issue tracker a year or two ago,  after posting here and having suggested that I raise an issue.

I really appreciate the work going into RHub - the reason I am having this problem is I use RHub to check my submissions.  I just keep failing in my CRAN submissions on Debian while passing on Windows and Mac, sort of frustrating.

-Roy

> On Apr 8, 2021, at 12:22 AM, G?bor Cs?rdi <csardi.gabor at gmail.com> wrote:
> 
> Hi,
> 
> Which one is your package? Which spatial package fails? Can you link
> to an issue in the issue tracker, if there is one?
> 
> As for an alternative, you can run a Docker container. This works on
> Linux, Windows and macOS, on any recent enough machine. You can run
> one of the R-hub containers, e.g.
> https://hub.docker.com/repository/docker/rhub/debian-gcc-devel and
> then try to fix the installation issue. Or you can try a bigger
> container that tries to mirror CRAN exactly:
> https://hub.docker.com/r/cran/debian
> 
> Gabor
> 
> On Thu, Apr 8, 2021 at 6:49 AM Roy Mendelssohn - NOAA Federal via
> R-package-devel <r-package-devel at r-project.org> wrote:
>> 
>> Hi All:
>> 
>> I still have problems with checking one of my packages on RHub running Debian,  as the Preprocessing fails in building in some of the needed spatial packages.  This problem was reported quite awhile ago,  and never appears to have been completely fixed.  Is there an alternate place I can test a package under Debian that is consistent with CRAN.
>> 
>> Thanks,
>> 
>> -Roy
>> 
>> **********************
>> "The contents of this message do not reflect any position of the U.S. Government or NOAA."
>> **********************
>> Roy Mendelssohn
>> Supervisory Operations Research Analyst
>> NOAA/NMFS
>> Environmental Research Division
>> Southwest Fisheries Science Center
>> ***Note new street address***
>> 110 McAllister Way
>> Santa Cruz, CA 95060
>> Phone: (831)-420-3666
>> Fax: (831) 420-3980
>> e-mail: Roy.Mendelssohn at noaa.gov www: https://www.pfeg.noaa.gov/
>> 
>> "Old age and treachery will overcome youth and skill."
>> "From those who have been given much, much will be expected"
>> "the arc of the moral universe is long, but it bends toward justice" -MLK Jr.
>> 
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel

**********************
"The contents of this message do not reflect any position of the U.S. Government or NOAA."
**********************
Roy Mendelssohn
Supervisory Operations Research Analyst
NOAA/NMFS
Environmental Research Division
Southwest Fisheries Science Center
***Note new street address***
110 McAllister Way
Santa Cruz, CA 95060
Phone: (831)-420-3666
Fax: (831) 420-3980
e-mail: Roy.Mendelssohn at noaa.gov www: https://www.pfeg.noaa.gov/

"Old age and treachery will overcome youth and skill."
"From those who have been given much, much will be expected" 
"the arc of the moral universe is long, but it bends toward justice" -MLK Jr.


From roy@mende|@@ohn @end|ng |rom no@@@gov  Thu Apr  8 17:58:46 2021
From: roy@mende|@@ohn @end|ng |rom no@@@gov (Roy Mendelssohn - NOAA Federal)
Date: Thu, 8 Apr 2021 08:58:46 -0700
Subject: [R-pkg-devel] Checking on Debian on RHub
In-Reply-To: <218565F1-D623-48AB-B4F9-5AFA3E4BF81A@noaa.gov>
References: <CECC916B-ADFF-48D0-A88C-622AAF240703@noaa.gov>
 <CABtg=K=EKNu17NZDW2qH5M-+DMz_+RrL6xBMbsmW8mT=Mw+7Ew@mail.gmail.com>
 <218565F1-D623-48AB-B4F9-5AFA3E4BF81A@noaa.gov>
Message-ID: <2CA8D539-A282-4770-9B93-DE825D44F288@noaa.gov>

My apologies, it is the Fedora instance.  Short version summary:

Warning messages:
5558#> 1: In i.p(...) : installation of package ?rgdal? had non-zero exit status
5559#> 2: In i.p(...) : installation of package ?sf? had non-zero exit status
5560#> 3: In i.p(...) :
5561#> installation of package ?plotdap? had non-zero exit status

'plotdap' depends on sf which is why it fails.  Long version is at https://builder.r-hub.io/status/rerddapXtracto_1.1.0.tar.gz-f3facfb7e282436c98dce8b5014de474

Thanks,

-Roy

> On Apr 8, 2021, at 7:35 AM, Roy Mendelssohn - NOAA Federal <roy.mendelssohn at noaa.gov> wrote:
> 
> Thanks Gabor.  I will post more information later today when I get a chance.  I actually put something on issue tracker a year or two ago,  after posting here and having suggested that I raise an issue.
> 
> I really appreciate the work going into RHub - the reason I am having this problem is I use RHub to check my submissions.  I just keep failing in my CRAN submissions on Debian while passing on Windows and Mac, sort of frustrating.
> 
> -Roy
> 
>> On Apr 8, 2021, at 12:22 AM, G?bor Cs?rdi <csardi.gabor at gmail.com> wrote:
>> 
>> Hi,
>> 
>> Which one is your package? Which spatial package fails? Can you link
>> to an issue in the issue tracker, if there is one?
>> 
>> As for an alternative, you can run a Docker container. This works on
>> Linux, Windows and macOS, on any recent enough machine. You can run
>> one of the R-hub containers, e.g.
>> https://hub.docker.com/repository/docker/rhub/debian-gcc-devel and
>> then try to fix the installation issue. Or you can try a bigger
>> container that tries to mirror CRAN exactly:
>> https://hub.docker.com/r/cran/debian
>> 
>> Gabor
>> 
>> On Thu, Apr 8, 2021 at 6:49 AM Roy Mendelssohn - NOAA Federal via
>> R-package-devel <r-package-devel at r-project.org> wrote:
>>> 
>>> Hi All:
>>> 
>>> I still have problems with checking one of my packages on RHub running Debian,  as the Preprocessing fails in building in some of the needed spatial packages.  This problem was reported quite awhile ago,  and never appears to have been completely fixed.  Is there an alternate place I can test a package under Debian that is consistent with CRAN.
>>> 
>>> Thanks,
>>> 
>>> -Roy
>>> 
>>> **********************
>>> "The contents of this message do not reflect any position of the U.S. Government or NOAA."
>>> **********************
>>> Roy Mendelssohn
>>> Supervisory Operations Research Analyst
>>> NOAA/NMFS
>>> Environmental Research Division
>>> Southwest Fisheries Science Center
>>> ***Note new street address***
>>> 110 McAllister Way
>>> Santa Cruz, CA 95060
>>> Phone: (831)-420-3666
>>> Fax: (831) 420-3980
>>> e-mail: Roy.Mendelssohn at noaa.gov www: https://www.pfeg.noaa.gov/
>>> 
>>> "Old age and treachery will overcome youth and skill."
>>> "From those who have been given much, much will be expected"
>>> "the arc of the moral universe is long, but it bends toward justice" -MLK Jr.
>>> 
>>> ______________________________________________
>>> R-package-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
> 
> **********************
> "The contents of this message do not reflect any position of the U.S. Government or NOAA."
> **********************
> Roy Mendelssohn
> Supervisory Operations Research Analyst
> NOAA/NMFS
> Environmental Research Division
> Southwest Fisheries Science Center
> ***Note new street address***
> 110 McAllister Way
> Santa Cruz, CA 95060
> Phone: (831)-420-3666
> Fax: (831) 420-3980
> e-mail: Roy.Mendelssohn at noaa.gov www: https://www.pfeg.noaa.gov/
> 
> "Old age and treachery will overcome youth and skill."
> "From those who have been given much, much will be expected" 
> "the arc of the moral universe is long, but it bends toward justice" -MLK Jr.
> 

**********************
"The contents of this message do not reflect any position of the U.S. Government or NOAA."
**********************
Roy Mendelssohn
Supervisory Operations Research Analyst
NOAA/NMFS
Environmental Research Division
Southwest Fisheries Science Center
***Note new street address***
110 McAllister Way
Santa Cruz, CA 95060
Phone: (831)-420-3666
Fax: (831) 420-3980
e-mail: Roy.Mendelssohn at noaa.gov www: https://www.pfeg.noaa.gov/

"Old age and treachery will overcome youth and skill."
"From those who have been given much, much will be expected" 
"the arc of the moral universe is long, but it bends toward justice" -MLK Jr.


From c@@rd|@g@bor @end|ng |rom gm@||@com  Thu Apr  8 18:12:38 2021
From: c@@rd|@g@bor @end|ng |rom gm@||@com (=?UTF-8?B?R8OhYm9yIENzw6FyZGk=?=)
Date: Thu, 8 Apr 2021 18:12:38 +0200
Subject: [R-pkg-devel] Checking on Debian on RHub
In-Reply-To: <2CA8D539-A282-4770-9B93-DE825D44F288@noaa.gov>
References: <CECC916B-ADFF-48D0-A88C-622AAF240703@noaa.gov>
 <CABtg=K=EKNu17NZDW2qH5M-+DMz_+RrL6xBMbsmW8mT=Mw+7Ew@mail.gmail.com>
 <218565F1-D623-48AB-B4F9-5AFA3E4BF81A@noaa.gov>
 <2CA8D539-A282-4770-9B93-DE825D44F288@noaa.gov>
Message-ID: <CABtg=Kk+xdwrgp-mzGgRYJS1Ja-qoDSiUC23J-92iwxkGrDHBw@mail.gmail.com>

Should be fixed in e4dd4d6c240407317abb67e156d99ef738a7e73c and
88718aad52df59b7e76c2db563991558a168b05e

I haven't yet tested it, though....

G.

On Thu, Apr 8, 2021 at 5:58 PM Roy Mendelssohn - NOAA Federal
<roy.mendelssohn at noaa.gov> wrote:
>
> My apologies, it is the Fedora instance.  Short version summary:
>
> Warning messages:
> 5558#> 1: In i.p(...) : installation of package ?rgdal? had non-zero exit status
> 5559#> 2: In i.p(...) : installation of package ?sf? had non-zero exit status
> 5560#> 3: In i.p(...) :
> 5561#> installation of package ?plotdap? had non-zero exit status
>
> 'plotdap' depends on sf which is why it fails.  Long version is at https://builder.r-hub.io/status/rerddapXtracto_1.1.0.tar.gz-f3facfb7e282436c98dce8b5014de474
>
> Thanks,
>
> -Roy
>
> > On Apr 8, 2021, at 7:35 AM, Roy Mendelssohn - NOAA Federal <roy.mendelssohn at noaa.gov> wrote:
> >
> > Thanks Gabor.  I will post more information later today when I get a chance.  I actually put something on issue tracker a year or two ago,  after posting here and having suggested that I raise an issue.
> >
> > I really appreciate the work going into RHub - the reason I am having this problem is I use RHub to check my submissions.  I just keep failing in my CRAN submissions on Debian while passing on Windows and Mac, sort of frustrating.
> >
> > -Roy
> >
> >> On Apr 8, 2021, at 12:22 AM, G?bor Cs?rdi <csardi.gabor at gmail.com> wrote:
> >>
> >> Hi,
> >>
> >> Which one is your package? Which spatial package fails? Can you link
> >> to an issue in the issue tracker, if there is one?
> >>
> >> As for an alternative, you can run a Docker container. This works on
> >> Linux, Windows and macOS, on any recent enough machine. You can run
> >> one of the R-hub containers, e.g.
> >> https://hub.docker.com/repository/docker/rhub/debian-gcc-devel and
> >> then try to fix the installation issue. Or you can try a bigger
> >> container that tries to mirror CRAN exactly:
> >> https://hub.docker.com/r/cran/debian
> >>
> >> Gabor
> >>
> >> On Thu, Apr 8, 2021 at 6:49 AM Roy Mendelssohn - NOAA Federal via
> >> R-package-devel <r-package-devel at r-project.org> wrote:
> >>>
> >>> Hi All:
> >>>
> >>> I still have problems with checking one of my packages on RHub running Debian,  as the Preprocessing fails in building in some of the needed spatial packages.  This problem was reported quite awhile ago,  and never appears to have been completely fixed.  Is there an alternate place I can test a package under Debian that is consistent with CRAN.
> >>>
> >>> Thanks,
> >>>
> >>> -Roy
> >>>
> >>> **********************
> >>> "The contents of this message do not reflect any position of the U.S. Government or NOAA."
> >>> **********************
> >>> Roy Mendelssohn
> >>> Supervisory Operations Research Analyst
> >>> NOAA/NMFS
> >>> Environmental Research Division
> >>> Southwest Fisheries Science Center
> >>> ***Note new street address***
> >>> 110 McAllister Way
> >>> Santa Cruz, CA 95060
> >>> Phone: (831)-420-3666
> >>> Fax: (831) 420-3980
> >>> e-mail: Roy.Mendelssohn at noaa.gov www: https://www.pfeg.noaa.gov/
> >>>
> >>> "Old age and treachery will overcome youth and skill."
> >>> "From those who have been given much, much will be expected"
> >>> "the arc of the moral universe is long, but it bends toward justice" -MLK Jr.
> >>>
> >>> ______________________________________________
> >>> R-package-devel at r-project.org mailing list
> >>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
> >
> > **********************
> > "The contents of this message do not reflect any position of the U.S. Government or NOAA."
> > **********************
> > Roy Mendelssohn
> > Supervisory Operations Research Analyst
> > NOAA/NMFS
> > Environmental Research Division
> > Southwest Fisheries Science Center
> > ***Note new street address***
> > 110 McAllister Way
> > Santa Cruz, CA 95060
> > Phone: (831)-420-3666
> > Fax: (831) 420-3980
> > e-mail: Roy.Mendelssohn at noaa.gov www: https://www.pfeg.noaa.gov/
> >
> > "Old age and treachery will overcome youth and skill."
> > "From those who have been given much, much will be expected"
> > "the arc of the moral universe is long, but it bends toward justice" -MLK Jr.
> >
>
> **********************
> "The contents of this message do not reflect any position of the U.S. Government or NOAA."
> **********************
> Roy Mendelssohn
> Supervisory Operations Research Analyst
> NOAA/NMFS
> Environmental Research Division
> Southwest Fisheries Science Center
> ***Note new street address***
> 110 McAllister Way
> Santa Cruz, CA 95060
> Phone: (831)-420-3666
> Fax: (831) 420-3980
> e-mail: Roy.Mendelssohn at noaa.gov www: https://www.pfeg.noaa.gov/
>
> "Old age and treachery will overcome youth and skill."
> "From those who have been given much, much will be expected"
> "the arc of the moral universe is long, but it bends toward justice" -MLK Jr.
>


From c@@rd|@g@bor @end|ng |rom gm@||@com  Thu Apr  8 18:13:16 2021
From: c@@rd|@g@bor @end|ng |rom gm@||@com (=?UTF-8?B?R8OhYm9yIENzw6FyZGk=?=)
Date: Thu, 8 Apr 2021 18:13:16 +0200
Subject: [R-pkg-devel] Checking on Debian on RHub
In-Reply-To: <CABtg=Kk+xdwrgp-mzGgRYJS1Ja-qoDSiUC23J-92iwxkGrDHBw@mail.gmail.com>
References: <CECC916B-ADFF-48D0-A88C-622AAF240703@noaa.gov>
 <CABtg=K=EKNu17NZDW2qH5M-+DMz_+RrL6xBMbsmW8mT=Mw+7Ew@mail.gmail.com>
 <218565F1-D623-48AB-B4F9-5AFA3E4BF81A@noaa.gov>
 <2CA8D539-A282-4770-9B93-DE825D44F288@noaa.gov>
 <CABtg=Kk+xdwrgp-mzGgRYJS1Ja-qoDSiUC23J-92iwxkGrDHBw@mail.gmail.com>
Message-ID: <CABtg=KnqgO47chTyBCP6UzB4h3ww_==nekfwh1O+eFYTEmV5Yg@mail.gmail.com>

I mean, here:
https://github.com/r-hub/sysreqsdb/commit/e4dd4d6c240407317abb67e156d99ef738a7e73c
https://github.com/r-hub/sysreqsdb/commit/88718aad52df59b7e76c2db563991558a168b05e

G.

On Thu, Apr 8, 2021 at 6:12 PM G?bor Cs?rdi <csardi.gabor at gmail.com> wrote:
>
> Should be fixed in e4dd4d6c240407317abb67e156d99ef738a7e73c and
> 88718aad52df59b7e76c2db563991558a168b05e
>
> I haven't yet tested it, though....
>
> G.
>
> On Thu, Apr 8, 2021 at 5:58 PM Roy Mendelssohn - NOAA Federal
> <roy.mendelssohn at noaa.gov> wrote:
> >
> > My apologies, it is the Fedora instance.  Short version summary:
> >
> > Warning messages:
> > 5558#> 1: In i.p(...) : installation of package ?rgdal? had non-zero exit status
> > 5559#> 2: In i.p(...) : installation of package ?sf? had non-zero exit status
> > 5560#> 3: In i.p(...) :
> > 5561#> installation of package ?plotdap? had non-zero exit status
> >
> > 'plotdap' depends on sf which is why it fails.  Long version is at https://builder.r-hub.io/status/rerddapXtracto_1.1.0.tar.gz-f3facfb7e282436c98dce8b5014de474
> >
> > Thanks,
> >
> > -Roy
> >
> > > On Apr 8, 2021, at 7:35 AM, Roy Mendelssohn - NOAA Federal <roy.mendelssohn at noaa.gov> wrote:
> > >
> > > Thanks Gabor.  I will post more information later today when I get a chance.  I actually put something on issue tracker a year or two ago,  after posting here and having suggested that I raise an issue.
> > >
> > > I really appreciate the work going into RHub - the reason I am having this problem is I use RHub to check my submissions.  I just keep failing in my CRAN submissions on Debian while passing on Windows and Mac, sort of frustrating.
> > >
> > > -Roy
> > >
> > >> On Apr 8, 2021, at 12:22 AM, G?bor Cs?rdi <csardi.gabor at gmail.com> wrote:
> > >>
> > >> Hi,
> > >>
> > >> Which one is your package? Which spatial package fails? Can you link
> > >> to an issue in the issue tracker, if there is one?
> > >>
> > >> As for an alternative, you can run a Docker container. This works on
> > >> Linux, Windows and macOS, on any recent enough machine. You can run
> > >> one of the R-hub containers, e.g.
> > >> https://hub.docker.com/repository/docker/rhub/debian-gcc-devel and
> > >> then try to fix the installation issue. Or you can try a bigger
> > >> container that tries to mirror CRAN exactly:
> > >> https://hub.docker.com/r/cran/debian
> > >>
> > >> Gabor
> > >>
> > >> On Thu, Apr 8, 2021 at 6:49 AM Roy Mendelssohn - NOAA Federal via
> > >> R-package-devel <r-package-devel at r-project.org> wrote:
> > >>>
> > >>> Hi All:
> > >>>
> > >>> I still have problems with checking one of my packages on RHub running Debian,  as the Preprocessing fails in building in some of the needed spatial packages.  This problem was reported quite awhile ago,  and never appears to have been completely fixed.  Is there an alternate place I can test a package under Debian that is consistent with CRAN.
> > >>>
> > >>> Thanks,
> > >>>
> > >>> -Roy
> > >>>
> > >>> **********************
> > >>> "The contents of this message do not reflect any position of the U.S. Government or NOAA."
> > >>> **********************
> > >>> Roy Mendelssohn
> > >>> Supervisory Operations Research Analyst
> > >>> NOAA/NMFS
> > >>> Environmental Research Division
> > >>> Southwest Fisheries Science Center
> > >>> ***Note new street address***
> > >>> 110 McAllister Way
> > >>> Santa Cruz, CA 95060
> > >>> Phone: (831)-420-3666
> > >>> Fax: (831) 420-3980
> > >>> e-mail: Roy.Mendelssohn at noaa.gov www: https://www.pfeg.noaa.gov/
> > >>>
> > >>> "Old age and treachery will overcome youth and skill."
> > >>> "From those who have been given much, much will be expected"
> > >>> "the arc of the moral universe is long, but it bends toward justice" -MLK Jr.
> > >>>
> > >>> ______________________________________________
> > >>> R-package-devel at r-project.org mailing list
> > >>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
> > >
> > > **********************
> > > "The contents of this message do not reflect any position of the U.S. Government or NOAA."
> > > **********************
> > > Roy Mendelssohn
> > > Supervisory Operations Research Analyst
> > > NOAA/NMFS
> > > Environmental Research Division
> > > Southwest Fisheries Science Center
> > > ***Note new street address***
> > > 110 McAllister Way
> > > Santa Cruz, CA 95060
> > > Phone: (831)-420-3666
> > > Fax: (831) 420-3980
> > > e-mail: Roy.Mendelssohn at noaa.gov www: https://www.pfeg.noaa.gov/
> > >
> > > "Old age and treachery will overcome youth and skill."
> > > "From those who have been given much, much will be expected"
> > > "the arc of the moral universe is long, but it bends toward justice" -MLK Jr.
> > >
> >
> > **********************
> > "The contents of this message do not reflect any position of the U.S. Government or NOAA."
> > **********************
> > Roy Mendelssohn
> > Supervisory Operations Research Analyst
> > NOAA/NMFS
> > Environmental Research Division
> > Southwest Fisheries Science Center
> > ***Note new street address***
> > 110 McAllister Way
> > Santa Cruz, CA 95060
> > Phone: (831)-420-3666
> > Fax: (831) 420-3980
> > e-mail: Roy.Mendelssohn at noaa.gov www: https://www.pfeg.noaa.gov/
> >
> > "Old age and treachery will overcome youth and skill."
> > "From those who have been given much, much will be expected"
> > "the arc of the moral universe is long, but it bends toward justice" -MLK Jr.
> >


From conn|e @end|ng |rom @ggreg@te-gen|u@@com  Thu Apr  8 21:39:20 2021
From: conn|e @end|ng |rom @ggreg@te-gen|u@@com (Dr. Connie Brett)
Date: Thu, 8 Apr 2021 12:39:20 -0700
Subject: [R-pkg-devel] Package Vignette depends on Ensembl,
 server certificate issue?
Message-ID: <6791A218-1632-49B0-B4CE-33E9306B9EA8@aggregate-genius.com>

Hello,
I have a package (DGEobj) that depends on the Ensembl service to look up information used to build the vignette.  My builds work fine on Travis, locally and on R-hub.  Occasionally I have seen blips with regard to internet-based resources not being available, and my vignette depends on a number of internet resources to get example datasets.  However when I submitted my package to CRAN today the failures Windows and Debian were that the server certificate verification failed ( SSL certificate problem: unable to get local issuer certificate).
I?m not sure if there is something I can do about this or if this is considered a "false positive" per the email - it seems like a "wait and retry" issue.  I don?t want to be rude uploading the package again without a change or erroneously emailing in response to the rejection. 
How should this be handled properly now and into the future?  It isn?t feasible to not use Ensembl for this vignette.
Thanks for your insight and feedback!

Flavor: r-devel-windows-ix86+x86_64
Check: re-building of vignette outputs, Result: WARNING
 Error(s) in re-building vignettes:
 --- re-building 'DGEobj_Overview.Rmd' using rmarkdown

 Ensembl site unresponsive, trying asia mirror
 Quitting from lines 259-280 (DGEobj_Overview.Rmd) 
 Error: processing vignette 'DGEobj_Overview.Rmd' failed with diagnostics:
 SSL certificate problem: unable to get local issuer certificate
 --- failed re-building 'DGEobj_Overview.Rmd'

 SUMMARY: processing the following file failed:
   'DGEobj_Overview.Rmd'

 Error: Vignette re-building failed.
 Execution halted


Flavor: r-devel-linux-x86_64-debian-gcc
Check: re-building of vignette outputs, Result: WARNING
 Error(s) in re-building vignettes:
 --- re-building 'DGEobj_Overview.Rmd' using rmarkdown

 Ensembl site unresponsive, trying asia mirror
 Quitting from lines 235-256 (DGEobj_Overview.Rmd) 
 Error: processing vignette 'DGEobj_Overview.Rmd' failed with diagnostics:
 server certificate verification failed. CAfile: none CRLfile: none
 --- failed re-building 'DGEobj_Overview.Rmd'

 SUMMARY: processing the following file failed:
   'DGEobj_Overview.Rmd'

 Error: Vignette re-building failed.
 Execution halted
	[[alternative HTML version deleted]]


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Fri Apr  9 09:14:38 2021
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Fri, 09 Apr 2021 00:14:38 -0700
Subject: [R-pkg-devel] Package Vignette depends on Ensembl,
 server certificate issue?
In-Reply-To: <6791A218-1632-49B0-B4CE-33E9306B9EA8@aggregate-genius.com>
References: <6791A218-1632-49B0-B4CE-33E9306B9EA8@aggregate-genius.com>
Message-ID: <0EA40466-1242-4B1C-A69A-6DC6EB6CF5CE@dcn.davis.ca.us>

Maybe use r.rsp?

https://blog.r-hub.io/2020/06/03/vignettes/
How to include my pre-print / cheatsheet as a PDF vignette?



On April 8, 2021 12:39:20 PM PDT, "Dr. Connie Brett" <connie at aggregate-genius.com> wrote:
>Hello,
>I have a package (DGEobj) that depends on the Ensembl service to look
>up information used to build the vignette.  My builds work fine on
>Travis, locally and on R-hub.  Occasionally I have seen blips with
>regard to internet-based resources not being available, and my vignette
>depends on a number of internet resources to get example datasets. 
>However when I submitted my package to CRAN today the failures Windows
>and Debian were that the server certificate verification failed ( SSL
>certificate problem: unable to get local issuer certificate).
>I?m not sure if there is something I can do about this or if this is
>considered a "false positive" per the email - it seems like a "wait and
>retry" issue.  I don?t want to be rude uploading the package again
>without a change or erroneously emailing in response to the rejection. 
>How should this be handled properly now and into the future?  It isn?t
>feasible to not use Ensembl for this vignette.
>Thanks for your insight and feedback!
>
>Flavor: r-devel-windows-ix86+x86_64
>Check: re-building of vignette outputs, Result: WARNING
> Error(s) in re-building vignettes:
> --- re-building 'DGEobj_Overview.Rmd' using rmarkdown
>
> Ensembl site unresponsive, trying asia mirror
> Quitting from lines 259-280 (DGEobj_Overview.Rmd) 
>Error: processing vignette 'DGEobj_Overview.Rmd' failed with
>diagnostics:
> SSL certificate problem: unable to get local issuer certificate
> --- failed re-building 'DGEobj_Overview.Rmd'
>
> SUMMARY: processing the following file failed:
>   'DGEobj_Overview.Rmd'
>
> Error: Vignette re-building failed.
> Execution halted
>
>
>Flavor: r-devel-linux-x86_64-debian-gcc
>Check: re-building of vignette outputs, Result: WARNING
> Error(s) in re-building vignettes:
> --- re-building 'DGEobj_Overview.Rmd' using rmarkdown
>
> Ensembl site unresponsive, trying asia mirror
> Quitting from lines 235-256 (DGEobj_Overview.Rmd) 
>Error: processing vignette 'DGEobj_Overview.Rmd' failed with
>diagnostics:
> server certificate verification failed. CAfile: none CRLfile: none
> --- failed re-building 'DGEobj_Overview.Rmd'
>
> SUMMARY: processing the following file failed:
>   'DGEobj_Overview.Rmd'
>
> Error: Vignette re-building failed.
> Execution halted
>	[[alternative HTML version deleted]]
>
>______________________________________________
>R-package-devel at r-project.org mailing list
>https://stat.ethz.ch/mailman/listinfo/r-package-devel

-- 
Sent from my phone. Please excuse my brevity.


From |kry|ov @end|ng |rom |@@er@chem@m@u@ru  Fri Apr  9 11:11:53 2021
From: |kry|ov @end|ng |rom |@@er@chem@m@u@ru (Ivan Krylov)
Date: Fri, 9 Apr 2021 12:11:53 +0300
Subject: [R-pkg-devel] Debugging M1mac problems [solved]
In-Reply-To: <20210327172616.0a16ed30@Tarkus>
References: <20210327172616.0a16ed30@Tarkus>
Message-ID: <20210409121153.39f28ce9@Tarkus>

On Sat, 27 Mar 2021 17:26:16 +0300
Ivan Krylov <ikrylov at laser.chem.msu.ru> wrote:

> I'm probably doing something stupid with the file names that usually
> works but isn't guaranteed to work in all cases, but I cannot figure
> it out.

Long story short, the problem turned out to be that I called basename()
and dirname() on paths not guaranteed to exist. Thanks to Tomas
Kalibera for pointing me in the right direction!

I'd wager a guess that I would have reproduced the same issue on an
Intel macOS machine with Big Sur installed (this being the other main
difference between Intel/High Sierra machines where all tests passed
and the M1/Big Sur machine where they failed). The "package check
results" page now shows all "OK" for the updated version, so I must
have fixed it.

I guess the moral of the story is that sometimes, it's easier to fix a
problem than reproduce it for oneself.

-- 
Best,
Ivan


From R@R@E@J@n@@en-10 @end|ng |rom umcutrecht@n|  Fri Apr  9 10:26:52 2021
From: R@R@E@J@n@@en-10 @end|ng |rom umcutrecht@n| (Janssen-10, R.R.E. (Roel))
Date: Fri, 9 Apr 2021 08:26:52 +0000
Subject: [R-pkg-devel] Problem with building with libcurl on Windows
Message-ID: <defcdd886d3b41b597af2946ebad81e4@umcutrecht.nl>

Dear all,


The package I've tried to submit uses HTSlib, which in turn uses libcurl.  >From the build logs, I think there is a version mismatch, or configuration problem with libcurl:

https://win-builder.r-project.org/incoming_pretest/USCDtools_0.0.1_20210409_093124/Windows/00install.out

The problem seems to boil down to:
<https://win-builder.r-project.org/incoming_pretest/USCDtools_0.0.1_20210409_093124/Windows/00install.out>

undefined reference to `_imp__CertEnumCertificatesInStore at 8'

Can I do anything about it in my package?

Kind regards,
Roel Janssen


------------------------------------------------------------------------------

De informatie opgenomen in dit bericht kan vertrouwelijk zijn en is
uitsluitend bestemd voor de geadresseerde. Indien u dit bericht onterecht
ontvangt, wordt u verzocht de inhoud niet te gebruiken en de afzender direct
te informeren door het bericht te retourneren. Het Universitair Medisch
Centrum Utrecht is een publiekrechtelijke rechtspersoon in de zin van de W.H.W.
(Wet Hoger Onderwijs en Wetenschappelijk Onderzoek) en staat geregistreerd bij
de Kamer van Koophandel voor Midden-Nederland onder nr. 30244197.

Denk s.v.p aan het milieu voor u deze e-mail afdrukt.

------------------------------------------------------------------------------

This message may contain confidential information and is...{{dropped:14}}


From conn|e @end|ng |rom @ggreg@te-gen|u@@com  Fri Apr  9 20:01:35 2021
From: conn|e @end|ng |rom @ggreg@te-gen|u@@com (Dr. Connie Brett)
Date: Fri, 9 Apr 2021 11:01:35 -0700
Subject: [R-pkg-devel] Package Vignette depends on Ensembl,
 server certificate issue?
In-Reply-To: <0EA40466-1242-4B1C-A69A-6DC6EB6CF5CE@dcn.davis.ca.us>
References: <6791A218-1632-49B0-B4CE-33E9306B9EA8@aggregate-genius.com>
 <0EA40466-1242-4B1C-A69A-6DC6EB6CF5CE@dcn.davis.ca.us>
Message-ID: <1E33246B-230F-4E59-9E0C-DE96AA16839E@aggregate-genius.com>

Thank you for pointing me to this resource, works like a charm!

> On Apr 9, 2021, at 12:14 AM, Jeff Newmiller <jdnewmil at dcn.davis.ca.us> wrote:
> 
> Maybe use r.rsp?
> 
> https://blog.r-hub.io/2020/06/03/vignettes/
> How to include my pre-print / cheatsheet as a PDF vignette?
> 
> 
> 
> On April 8, 2021 12:39:20 PM PDT, "Dr. Connie Brett" <connie at aggregate-genius.com> wrote:
>> Hello,
>> I have a package (DGEobj) that depends on the Ensembl service to look
>> up information used to build the vignette.  My builds work fine on
>> Travis, locally and on R-hub.  Occasionally I have seen blips with
>> regard to internet-based resources not being available, and my vignette
>> depends on a number of internet resources to get example datasets. 
>> However when I submitted my package to CRAN today the failures Windows
>> and Debian were that the server certificate verification failed ( SSL
>> certificate problem: unable to get local issuer certificate).
>> I?m not sure if there is something I can do about this or if this is
>> considered a "false positive" per the email - it seems like a "wait and
>> retry" issue.  I don?t want to be rude uploading the package again
>> without a change or erroneously emailing in response to the rejection. 
>> How should this be handled properly now and into the future?  It isn?t
>> feasible to not use Ensembl for this vignette.
>> Thanks for your insight and feedback!
>> 
>> Flavor: r-devel-windows-ix86+x86_64
>> Check: re-building of vignette outputs, Result: WARNING
>> Error(s) in re-building vignettes:
>> --- re-building 'DGEobj_Overview.Rmd' using rmarkdown
>> 
>> Ensembl site unresponsive, trying asia mirror
>> Quitting from lines 259-280 (DGEobj_Overview.Rmd) 
>> Error: processing vignette 'DGEobj_Overview.Rmd' failed with
>> diagnostics:
>> SSL certificate problem: unable to get local issuer certificate
>> --- failed re-building 'DGEobj_Overview.Rmd'
>> 
>> SUMMARY: processing the following file failed:
>>  'DGEobj_Overview.Rmd'
>> 
>> Error: Vignette re-building failed.
>> Execution halted
>> 
>> 
>> Flavor: r-devel-linux-x86_64-debian-gcc
>> Check: re-building of vignette outputs, Result: WARNING
>> Error(s) in re-building vignettes:
>> --- re-building 'DGEobj_Overview.Rmd' using rmarkdown
>> 
>> Ensembl site unresponsive, trying asia mirror
>> Quitting from lines 235-256 (DGEobj_Overview.Rmd) 
>> Error: processing vignette 'DGEobj_Overview.Rmd' failed with
>> diagnostics:
>> server certificate verification failed. CAfile: none CRLfile: none
>> --- failed re-building 'DGEobj_Overview.Rmd'
>> 
>> SUMMARY: processing the following file failed:
>>  'DGEobj_Overview.Rmd'
>> 
>> Error: Vignette re-building failed.
>> Execution halted
>> 	[[alternative HTML version deleted]]
>> 
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
> 
> -- 
> Sent from my phone. Please excuse my brevity.


From roy@mende|@@ohn @end|ng |rom no@@@gov  Fri Apr  9 21:02:06 2021
From: roy@mende|@@ohn @end|ng |rom no@@@gov (Roy Mendelssohn - NOAA Federal)
Date: Fri, 9 Apr 2021 12:02:06 -0700
Subject: [R-pkg-devel] CRAN nightly tests
Message-ID: <757E575C-1B69-4889-A0C8-6D99B7697563@noaa.gov>

Just trying to get some information about the CRAN nightly tests.  Are all the tests for a particular package run a the same time?  If not,  is there any way to determine when a particular test was last run (there is a time at the top of the page,  but it may or may not apply to all of the OSes).  Also can I get the IP address of the the machine that runs the Solaris test?  I am befuddled that the Solaris test can not access our server at all.  We did have to block a number of IP addresses recently,  my concerned is that th Solaris test machine may hav been blocked.

Thanks,

-Roy



**********************
"The contents of this message do not reflect any position of the U.S. Government or NOAA."
**********************
Roy Mendelssohn
Supervisory Operations Research Analyst
NOAA/NMFS
Environmental Research Division
Southwest Fisheries Science Center
***Note new street address***
110 McAllister Way
Santa Cruz, CA 95060
Phone: (831)-420-3666
Fax: (831) 420-3980
e-mail: Roy.Mendelssohn at noaa.gov www: https://www.pfeg.noaa.gov/

"Old age and treachery will overcome youth and skill."
"From those who have been given much, much will be expected" 
"the arc of the moral universe is long, but it bends toward justice" -MLK Jr.


From ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de  Sat Apr 10 01:23:46 2021
From: ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de (Uwe Ligges)
Date: Sat, 10 Apr 2021 01:23:46 +0200
Subject: [R-pkg-devel] CRAN nightly tests
In-Reply-To: <757E575C-1B69-4889-A0C8-6D99B7697563@noaa.gov>
References: <757E575C-1B69-4889-A0C8-6D99B7697563@noaa.gov>
Message-ID: <dc771367-3a2f-8f91-ec0f-ac99820b1cfb@statistik.tu-dortmund.de>



On 09.04.2021 21:02, Roy Mendelssohn - NOAA Federal via R-package-devel 
wrote:
> Just trying to get some information about the CRAN nightly tests.  Are all the tests for a particular package run a the same time?  

No.

> If not,  is there any way to determine when a particular test was last run (there is a time at the top of the page,  but it may or may not apply to all of the OSes).  

No.


Also can I get the IP address of the the machine that runs the Solaris 
test?  I am befuddled that the Solaris test can not access our server at 
all.  We did have to block a number of IP addresses recently,  my 
concerned is that th Solaris test machine may hav been blocked.


The list does not know. Even the CRAN team does not know the IP address. 
Professor Ripley runs that machine, so you may ask him via 
CRAN at R-project.org.

Best,
Uwe Ligges

> Thanks,
> 
> -Roy
> 
> 
> 
> **********************
> "The contents of this message do not reflect any position of the U.S. Government or NOAA."
> **********************
> Roy Mendelssohn
> Supervisory Operations Research Analyst
> NOAA/NMFS
> Environmental Research Division
> Southwest Fisheries Science Center
> ***Note new street address***
> 110 McAllister Way
> Santa Cruz, CA 95060
> Phone: (831)-420-3666
> Fax: (831) 420-3980
> e-mail: Roy.Mendelssohn at noaa.gov www: https://www.pfeg.noaa.gov/
> 
> "Old age and treachery will overcome youth and skill."
> "From those who have been given much, much will be expected"
> "the arc of the moral universe is long, but it bends toward justice" -MLK Jr.
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


From roy@mende|@@ohn @end|ng |rom no@@@gov  Sat Apr 10 01:26:23 2021
From: roy@mende|@@ohn @end|ng |rom no@@@gov (Roy Mendelssohn - NOAA Federal)
Date: Fri, 9 Apr 2021 16:26:23 -0700
Subject: [R-pkg-devel] CRAN nightly tests
In-Reply-To: <dc771367-3a2f-8f91-ec0f-ac99820b1cfb@statistik.tu-dortmund.de>
References: <757E575C-1B69-4889-A0C8-6D99B7697563@noaa.gov>
 <dc771367-3a2f-8f91-ec0f-ac99820b1cfb@statistik.tu-dortmund.de>
Message-ID: <C6229F37-C54B-4559-88BE-8C6183B569E6@noaa.gov>

Thanks.    Will do so,

-Roy

> On Apr 9, 2021, at 4:23 PM, Uwe Ligges <ligges at statistik.tu-dortmund.de> wrote:
> 
> 
> 
> On 09.04.2021 21:02, Roy Mendelssohn - NOAA Federal via R-package-devel wrote:
>> Just trying to get some information about the CRAN nightly tests.  Are all the tests for a particular package run a the same time?  
> 
> No.
> 
>> If not,  is there any way to determine when a particular test was last run (there is a time at the top of the page,  but it may or may not apply to all of the OSes).  
> 
> No.
> 
> 
> Also can I get the IP address of the the machine that runs the Solaris test?  I am befuddled that the Solaris test can not access our server at all.  We did have to block a number of IP addresses recently,  my concerned is that th Solaris test machine may hav been blocked.
> 
> 
> The list does not know. Even the CRAN team does not know the IP address. Professor Ripley runs that machine, so you may ask him via CRAN at R-project.org.
> 
> Best,
> Uwe Ligges
> 
>> Thanks,
>> -Roy
>> **********************
>> "The contents of this message do not reflect any position of the U.S. Government or NOAA."
>> **********************
>> Roy Mendelssohn
>> Supervisory Operations Research Analyst
>> NOAA/NMFS
>> Environmental Research Division
>> Southwest Fisheries Science Center
>> ***Note new street address***
>> 110 McAllister Way
>> Santa Cruz, CA 95060
>> Phone: (831)-420-3666
>> Fax: (831) 420-3980
>> e-mail: Roy.Mendelssohn at noaa.gov www: https://www.pfeg.noaa.gov/
>> "Old age and treachery will overcome youth and skill."
>> "From those who have been given much, much will be expected"
>> "the arc of the moral universe is long, but it bends toward justice" -MLK Jr.
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel

**********************
"The contents of this message do not reflect any position of the U.S. Government or NOAA."
**********************
Roy Mendelssohn
Supervisory Operations Research Analyst
NOAA/NMFS
Environmental Research Division
Southwest Fisheries Science Center
***Note new street address***
110 McAllister Way
Santa Cruz, CA 95060
Phone: (831)-420-3666
Fax: (831) 420-3980
e-mail: Roy.Mendelssohn at noaa.gov www: https://www.pfeg.noaa.gov/

"Old age and treachery will overcome youth and skill."
"From those who have been given much, much will be expected" 
"the arc of the moral universe is long, but it bends toward justice" -MLK Jr.


From chr|@ho|d @end|ng |rom p@yctc@org  Sat Apr 10 21:28:02 2021
From: chr|@ho|d @end|ng |rom p@yctc@org (Chris Evans)
Date: Sat, 10 Apr 2021 20:28:02 +0100 (BST)
Subject: [R-pkg-devel] Advice on identifying parsing failures with examples
 when trying to pkgdown my package
Message-ID: <1519420434.4858511.1618082882884.JavaMail.zimbra@psyctc.org>

My beginner package https://github.com/cpsyctc/CECPfuns is evolving slowly and I had no problems (that I could see)
with the help pages created through roxygen.  Today I came back to try using pkgdown to ... pkgdown the package.  
So I used a copy of the package directory and ran:

usethis::use_pkgdown()

and then

pkgdown::build_site()

That produced the start of exactly what I wanted as a nicely pkgdown'ed site.  However, the console showed error 
messages for three examples (which, as I say, all seem to produce OK html help pages through the usual roxygen 
processing).  The error message was

   Failed to parse example for topic 

and sure enough the examples section in the pkgdown docs html was empty.  If anyone wants to look at one of
the functions, checkAllUnique was one of the three that threw the errors.

I tried some searching and the most pertinent seeming page I hit was this:

   https://github.com/r-lib/pkgdown/issues/1149

where Hadley Wickham says "That's not valid .Rd code because you didn't escape the Rd comment symbol" which may
well be my problem too ... but I don't understand the advice (sorry!)

When I tried to tweak one of those functions by inserting a lot of "#" to mask results, i.e. replaced

#' [1] something

with:

#' # [1] something

(as I probably should have done that in the examples I have, they are dontrun examples so I hadn't noticed).

However, when I reran pkgdown::build_site() I got a new error message that is, to me, thoroughly confusing:

Error in utils::modifyList(meta, override) : is.list(x) is not TRUE

At that point I decided to back out and come here and ask the question in the subject line!

TIA,


Chris

-- 
Chris Evans (he/him) <chris at psyctc.org> Visiting Professor, University of Sheffield <chris.evans at sheffield.ac.uk>
I do some consultation work for the University of Roehampton <chris.evans at roehampton.ac.uk> and other places
but <chris at psyctc.org> remains my main Email address.  I have a work web site at:
   https://www.psyctc.org/psyctc/
and a site I manage for CORE and CORE system trust at:
   http://www.coresystemtrust.org.uk/
I have "semigrated" to France, see: 
   https://www.psyctc.org/pelerinage2016/semigrating-to-france/ 
   https://www.psyctc.org/pelerinage2016/register-to-get-updates-from-pelerinage2016/

If you want an Emeeting, I am trying to keep them to Thursdays and my diary is at:
   https://www.psyctc.org/pelerinage2016/ceworkdiary/
Beware: French time, generally an hour ahead of UK.


From murdoch@dunc@n @end|ng |rom gm@||@com  Sat Apr 10 22:01:03 2021
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Sat, 10 Apr 2021 16:01:03 -0400
Subject: [R-pkg-devel] 
 Advice on identifying parsing failures with examples
 when trying to pkgdown my package
In-Reply-To: <1519420434.4858511.1618082882884.JavaMail.zimbra@psyctc.org>
References: <1519420434.4858511.1618082882884.JavaMail.zimbra@psyctc.org>
Message-ID: <b60bff7e-d094-87eb-fbfe-90daa21ae776@gmail.com>

On 10/04/2021 3:28 p.m., Chris Evans wrote:
> My beginner package https://github.com/cpsyctc/CECPfuns is evolving slowly and I had no problems (that I could see)
> with the help pages created through roxygen.  Today I came back to try using pkgdown to ... pkgdown the package.
> So I used a copy of the package directory and ran:
> 
> usethis::use_pkgdown()
> 
> and then
> 
> pkgdown::build_site()
> 
> That produced the start of exactly what I wanted as a nicely pkgdown'ed site.  However, the console showed error
> messages for three examples (which, as I say, all seem to produce OK html help pages through the usual roxygen
> processing).  The error message was
> 
>     Failed to parse example for topic
> 
> and sure enough the examples section in the pkgdown docs html was empty.  If anyone wants to look at one of
> the functions, checkAllUnique was one of the three that threw the errors.
> 
> I tried some searching and the most pertinent seeming page I hit was this:
> 
>     https://github.com/r-lib/pkgdown/issues/1149
> 
> where Hadley Wickham says "That's not valid .Rd code because you didn't escape the Rd comment symbol" which may
> well be my problem too ... but I don't understand the advice (sorry!)

In Example code, % needs to be escaped, or it will be interpreted as a 
comment.  Sometimes that means the examples just compute the wrong 
thing, e.g.

A %*% b

is parsed as A when the rest of the line is ignored as a comment. 
Sometimes it makes the code illegal.  I don't know which you're seeing.

> 
> When I tried to tweak one of those functions by inserting a lot of "#" to mask results, i.e. replaced
> 
> #' [1] something
> 
> with:
> 
> #' # [1] something
> 
> (as I probably should have done that in the examples I have, they are dontrun examples so I hadn't noticed).

pkgdown tries to parse \dontrun examples, so this was a good thing, but 
I think you missed some:  e.g. in checkAllUnique.Rd, I see this around 
lines 55-60:

\examples{
\dontrun{
### letters gets us the 26 lower case letters of the English alphabet so 
should test OK
checkAllUnique(letters)
[1] TRUE
### good!

That line containing TRUE is not legal R code, so should be commented. 
You can find these one by one by copying the text from the Rd example 
section into a file, and trying to parse that file, e.g.

Put this in "test.R":

   ### letters gets us the 26 lower case letters of the English alphabet 
so should test OK
   checkAllUnique(letters)
   [1] TRUE
   ### good!

then run parse("test.R"):

Error in parse("test.R") : test.R:3:1: unexpected '['
2: checkAllUnique(letters)
3: [
    ^

You can do it for a file at a time by loading the test.R file into 
RStudio; it'll put markers beside each syntax error.  Unfortunately, it 
thinks

checkAllUnique(tmpTib \%>\% pull(1))

is a syntax error:  those escapes are required in Rd, but are illegal in R.

I don't know if there's a way to do it directly from the Roxygen source.

Duncan Murdoch

> 
> However, when I reran pkgdown::build_site() I got a new error message that is, to me, thoroughly confusing:
> 
> Error in utils::modifyList(meta, override) : is.list(x) is not TRUE
> 
> At that point I decided to back out and come here and ask the question in the subject line!


From murdoch@dunc@n @end|ng |rom gm@||@com  Sat Apr 10 22:20:40 2021
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Sat, 10 Apr 2021 16:20:40 -0400
Subject: [R-pkg-devel] 
 Advice on identifying parsing failures with examples
 when trying to pkgdown my package
In-Reply-To: <b60bff7e-d094-87eb-fbfe-90daa21ae776@gmail.com>
References: <1519420434.4858511.1618082882884.JavaMail.zimbra@psyctc.org>
 <b60bff7e-d094-87eb-fbfe-90daa21ae776@gmail.com>
Message-ID: <93485a83-6af3-708c-a534-48f5cdb231dd@gmail.com>

Here's a better way to do the file-at-a-time check:

Load the .Rd file in RStudio, and click on Preview.  Copy the whole 
examples section to a test.R file.  RStudio will mark all the syntax 
errors, but won't be fooled by the \% escapes, since the Preview handled 
them.

Duncan Murdoch

On 10/04/2021 4:01 p.m., Duncan Murdoch wrote:
> On 10/04/2021 3:28 p.m., Chris Evans wrote:
>> My beginner package https://github.com/cpsyctc/CECPfuns is evolving slowly and I had no problems (that I could see)
>> with the help pages created through roxygen.  Today I came back to try using pkgdown to ... pkgdown the package.
>> So I used a copy of the package directory and ran:
>>
>> usethis::use_pkgdown()
>>
>> and then
>>
>> pkgdown::build_site()
>>
>> That produced the start of exactly what I wanted as a nicely pkgdown'ed site.  However, the console showed error
>> messages for three examples (which, as I say, all seem to produce OK html help pages through the usual roxygen
>> processing).  The error message was
>>
>>      Failed to parse example for topic
>>
>> and sure enough the examples section in the pkgdown docs html was empty.  If anyone wants to look at one of
>> the functions, checkAllUnique was one of the three that threw the errors.
>>
>> I tried some searching and the most pertinent seeming page I hit was this:
>>
>>      https://github.com/r-lib/pkgdown/issues/1149
>>
>> where Hadley Wickham says "That's not valid .Rd code because you didn't escape the Rd comment symbol" which may
>> well be my problem too ... but I don't understand the advice (sorry!)
> 
> In Example code, % needs to be escaped, or it will be interpreted as a
> comment.  Sometimes that means the examples just compute the wrong
> thing, e.g.
> 
> A %*% b
> 
> is parsed as A when the rest of the line is ignored as a comment.
> Sometimes it makes the code illegal.  I don't know which you're seeing.
> 
>>
>> When I tried to tweak one of those functions by inserting a lot of "#" to mask results, i.e. replaced
>>
>> #' [1] something
>>
>> with:
>>
>> #' # [1] something
>>
>> (as I probably should have done that in the examples I have, they are dontrun examples so I hadn't noticed).
> 
> pkgdown tries to parse \dontrun examples, so this was a good thing, but
> I think you missed some:  e.g. in checkAllUnique.Rd, I see this around
> lines 55-60:
> 
> \examples{
> \dontrun{
> ### letters gets us the 26 lower case letters of the English alphabet so
> should test OK
> checkAllUnique(letters)
> [1] TRUE
> ### good!
> 
> That line containing TRUE is not legal R code, so should be commented.
> You can find these one by one by copying the text from the Rd example
> section into a file, and trying to parse that file, e.g.
> 
> Put this in "test.R":
> 
>     ### letters gets us the 26 lower case letters of the English alphabet
> so should test OK
>     checkAllUnique(letters)
>     [1] TRUE
>     ### good!
> 
> then run parse("test.R"):
> 
> Error in parse("test.R") : test.R:3:1: unexpected '['
> 2: checkAllUnique(letters)
> 3: [
>      ^
> 
> You can do it for a file at a time by loading the test.R file into
> RStudio; it'll put markers beside each syntax error.  Unfortunately, it
> thinks
> 
> checkAllUnique(tmpTib \%>\% pull(1))
> 
> is a syntax error:  those escapes are required in Rd, but are illegal in R.
> 
> I don't know if there's a way to do it directly from the Roxygen source.
> 
> Duncan Murdoch
> 
>>
>> However, when I reran pkgdown::build_site() I got a new error message that is, to me, thoroughly confusing:
>>
>> Error in utils::modifyList(meta, override) : is.list(x) is not TRUE
>>
>> At that point I decided to back out and come here and ask the question in the subject line!
> 
>


From chr|@ho|d @end|ng |rom p@yctc@org  Sat Apr 10 22:23:54 2021
From: chr|@ho|d @end|ng |rom p@yctc@org (Chris Evans)
Date: Sat, 10 Apr 2021 21:23:54 +0100 (BST)
Subject: [R-pkg-devel] 
 Advice on identifying parsing failures with examples
 when trying to pkgdown my package
In-Reply-To: <93485a83-6af3-708c-a534-48f5cdb231dd@gmail.com>
References: <1519420434.4858511.1618082882884.JavaMail.zimbra@psyctc.org>
 <b60bff7e-d094-87eb-fbfe-90daa21ae776@gmail.com>
 <93485a83-6af3-708c-a534-48f5cdb231dd@gmail.com>
Message-ID: <181682423.4874130.1618086234094.JavaMail.zimbra@psyctc.org>

Brilliant: exactly what I needed.  I see a happy hour tomorrow morning sorting those.

Many thanks (again) Duncan and very best to all here!

Chris

----- Original Message -----
> From: "Duncan Murdoch" <murdoch.duncan at gmail.com>
> To: "Chris Evans" <chrishold at psyctc.org>, "r-package-devel" <r-package-devel at r-project.org>
> Sent: Saturday, 10 April, 2021 21:20:40
> Subject: Re: [R-pkg-devel] Advice on identifying parsing failures with examples when trying to pkgdown my package

> Here's a better way to do the file-at-a-time check:
> 
> Load the .Rd file in RStudio, and click on Preview.  Copy the whole
> examples section to a test.R file.  RStudio will mark all the syntax
> errors, but won't be fooled by the \% escapes, since the Preview handled
> them.
> 
> Duncan Murdoch
> 
> On 10/04/2021 4:01 p.m., Duncan Murdoch wrote:
>> On 10/04/2021 3:28 p.m., Chris Evans wrote:
>>> My beginner package https://github.com/cpsyctc/CECPfuns is evolving slowly and I
>>> had no problems (that I could see)
>>> with the help pages created through roxygen.  Today I came back to try using
>>> pkgdown to ... pkgdown the package.
>>> So I used a copy of the package directory and ran:
>>>
>>> usethis::use_pkgdown()
>>>
>>> and then
>>>
>>> pkgdown::build_site()
>>>
>>> That produced the start of exactly what I wanted as a nicely pkgdown'ed site.
>>> However, the console showed error
>>> messages for three examples (which, as I say, all seem to produce OK html help
>>> pages through the usual roxygen
>>> processing).  The error message was
>>>
>>>      Failed to parse example for topic
>>>
>>> and sure enough the examples section in the pkgdown docs html was empty.  If
>>> anyone wants to look at one of
>>> the functions, checkAllUnique was one of the three that threw the errors.
>>>
>>> I tried some searching and the most pertinent seeming page I hit was this:
>>>
>>>      https://github.com/r-lib/pkgdown/issues/1149
>>>
>>> where Hadley Wickham says "That's not valid .Rd code because you didn't escape
>>> the Rd comment symbol" which may
>>> well be my problem too ... but I don't understand the advice (sorry!)
>> 
>> In Example code, % needs to be escaped, or it will be interpreted as a
>> comment.  Sometimes that means the examples just compute the wrong
>> thing, e.g.
>> 
>> A %*% b
>> 
>> is parsed as A when the rest of the line is ignored as a comment.
>> Sometimes it makes the code illegal.  I don't know which you're seeing.
>> 
>>>
>>> When I tried to tweak one of those functions by inserting a lot of "#" to mask
>>> results, i.e. replaced
>>>
>>> #' [1] something
>>>
>>> with:
>>>
>>> #' # [1] something
>>>
>>> (as I probably should have done that in the examples I have, they are dontrun
>>> examples so I hadn't noticed).
>> 
>> pkgdown tries to parse \dontrun examples, so this was a good thing, but
>> I think you missed some:  e.g. in checkAllUnique.Rd, I see this around
>> lines 55-60:
>> 
>> \examples{
>> \dontrun{
>> ### letters gets us the 26 lower case letters of the English alphabet so
>> should test OK
>> checkAllUnique(letters)
>> [1] TRUE
>> ### good!
>> 
>> That line containing TRUE is not legal R code, so should be commented.
>> You can find these one by one by copying the text from the Rd example
>> section into a file, and trying to parse that file, e.g.
>> 
>> Put this in "test.R":
>> 
>>     ### letters gets us the 26 lower case letters of the English alphabet
>> so should test OK
>>     checkAllUnique(letters)
>>     [1] TRUE
>>     ### good!
>> 
>> then run parse("test.R"):
>> 
>> Error in parse("test.R") : test.R:3:1: unexpected '['
>> 2: checkAllUnique(letters)
>> 3: [
>>      ^
>> 
>> You can do it for a file at a time by loading the test.R file into
>> RStudio; it'll put markers beside each syntax error.  Unfortunately, it
>> thinks
>> 
>> checkAllUnique(tmpTib \%>\% pull(1))
>> 
>> is a syntax error:  those escapes are required in Rd, but are illegal in R.
>> 
>> I don't know if there's a way to do it directly from the Roxygen source.
>> 
>> Duncan Murdoch
>> 
>>>
>>> However, when I reran pkgdown::build_site() I got a new error message that is,
>>> to me, thoroughly confusing:
>>>
>>> Error in utils::modifyList(meta, override) : is.list(x) is not TRUE
>>>
>>> At that point I decided to back out and come here and ask the question in the
>>> subject line!
>> 

-- 
Chris Evans (he/him) <chris at psyctc.org> Visiting Professor, University of Sheffield <chris.evans at sheffield.ac.uk>
I do some consultation work for the University of Roehampton <chris.evans at roehampton.ac.uk> and other places
but <chris at psyctc.org> remains my main Email address.  I have a work web site at:
   https://www.psyctc.org/psyctc/
and a site I manage for CORE and CORE system trust at:
   http://www.coresystemtrust.org.uk/
I have "semigrated" to France, see: 
   https://www.psyctc.org/pelerinage2016/semigrating-to-france/ 
   https://www.psyctc.org/pelerinage2016/register-to-get-updates-from-pelerinage2016/

If you want an Emeeting, I am trying to keep them to Thursdays and my diary is at:
   https://www.psyctc.org/pelerinage2016/ceworkdiary/
Beware: French time, generally an hour ahead of UK.


From chr|@ho|d @end|ng |rom p@yctc@org  Sun Apr 11 14:08:09 2021
From: chr|@ho|d @end|ng |rom p@yctc@org (Chris Evans)
Date: Sun, 11 Apr 2021 13:08:09 +0100 (BST)
Subject: [R-pkg-devel] 
 Advice on identifying parsing failures with examples
 when trying to pkgdown my package
In-Reply-To: <93485a83-6af3-708c-a534-48f5cdb231dd@gmail.com>
References: <1519420434.4858511.1618082882884.JavaMail.zimbra@psyctc.org>
 <b60bff7e-d094-87eb-fbfe-90daa21ae776@gmail.com>
 <93485a83-6af3-708c-a534-48f5cdb231dd@gmail.com>
Message-ID: <771796712.5089260.1618142889417.JavaMail.zimbra@psyctc.org>

Just a quick follow-up on this to have a clarification in the thread.  Duncan's suggestions put me straight 
but it seems that at least in my current set up (Rstudio 1.4.1103, R 4.0.5 on Ubuntu 20.04) the preview 
of the Rd file doesn't remove the "\" escapes if I put them into the Roxygen code examples.  However, it also 
seems that if I leave "%>%" as is there (and sort out my other messes that Duncan pointed out!) that 
everything goes fine so I now I have very pleasing (at least to me!) pkgdown site for my package at
https://cecpfuns.psyctc.org.  

At times the learning curve involved in developing the package has seemed tough but, with help from this list,
it is really starting to feel useful, and I'm sure that it was absolutely the right thing to do.

Very best all,

Chris

----- Original Message -----
> From: "Duncan Murdoch" <murdoch.duncan at gmail.com>
> To: "Chris Evans" <chrishold at psyctc.org>, "r-package-devel" <r-package-devel at r-project.org>
> Sent: Saturday, 10 April, 2021 21:20:40
> Subject: Re: [R-pkg-devel] Advice on identifying parsing failures with examples when trying to pkgdown my package

> Here's a better way to do the file-at-a-time check:
> 
> Load the .Rd file in RStudio, and click on Preview.  Copy the whole
> examples section to a test.R file.  RStudio will mark all the syntax
> errors, but won't be fooled by the \% escapes, since the Preview handled
> them.
> 
> Duncan Murdoch
> 
> On 10/04/2021 4:01 p.m., Duncan Murdoch wrote:
>> On 10/04/2021 3:28 p.m., Chris Evans wrote:
>>> My beginner package https://github.com/cpsyctc/CECPfuns is evolving slowly and I
>>> had no problems (that I could see)
>>> with the help pages created through roxygen.  Today I came back to try using
>>> pkgdown to ... pkgdown the package.
>>> So I used a copy of the package directory and ran:
>>>
>>> usethis::use_pkgdown()
>>>
>>> and then
>>>
>>> pkgdown::build_site()
>>>
>>> That produced the start of exactly what I wanted as a nicely pkgdown'ed site.
>>> However, the console showed error
>>> messages for three examples (which, as I say, all seem to produce OK html help
>>> pages through the usual roxygen
>>> processing).  The error message was
>>>
>>>      Failed to parse example for topic
>>>
>>> and sure enough the examples section in the pkgdown docs html was empty.  If
>>> anyone wants to look at one of
>>> the functions, checkAllUnique was one of the three that threw the errors.
>>>
>>> I tried some searching and the most pertinent seeming page I hit was this:
>>>
>>>      https://github.com/r-lib/pkgdown/issues/1149
>>>
>>> where Hadley Wickham says "That's not valid .Rd code because you didn't escape
>>> the Rd comment symbol" which may
>>> well be my problem too ... but I don't understand the advice (sorry!)
>> 
>> In Example code, % needs to be escaped, or it will be interpreted as a
>> comment.  Sometimes that means the examples just compute the wrong
>> thing, e.g.
>> 
>> A %*% b
>> 
>> is parsed as A when the rest of the line is ignored as a comment.
>> Sometimes it makes the code illegal.  I don't know which you're seeing.
>> 
>>>
>>> When I tried to tweak one of those functions by inserting a lot of "#" to mask
>>> results, i.e. replaced
>>>
>>> #' [1] something
>>>
>>> with:
>>>
>>> #' # [1] something
>>>
>>> (as I probably should have done that in the examples I have, they are dontrun
>>> examples so I hadn't noticed).
>> 
>> pkgdown tries to parse \dontrun examples, so this was a good thing, but
>> I think you missed some:  e.g. in checkAllUnique.Rd, I see this around
>> lines 55-60:
>> 
>> \examples{
>> \dontrun{
>> ### letters gets us the 26 lower case letters of the English alphabet so
>> should test OK
>> checkAllUnique(letters)
>> [1] TRUE
>> ### good!
>> 
>> That line containing TRUE is not legal R code, so should be commented.
>> You can find these one by one by copying the text from the Rd example
>> section into a file, and trying to parse that file, e.g.
>> 
>> Put this in "test.R":
>> 
>>     ### letters gets us the 26 lower case letters of the English alphabet
>> so should test OK
>>     checkAllUnique(letters)
>>     [1] TRUE
>>     ### good!
>> 
>> then run parse("test.R"):
>> 
>> Error in parse("test.R") : test.R:3:1: unexpected '['
>> 2: checkAllUnique(letters)
>> 3: [
>>      ^
>> 
>> You can do it for a file at a time by loading the test.R file into
>> RStudio; it'll put markers beside each syntax error.  Unfortunately, it
>> thinks
>> 
>> checkAllUnique(tmpTib \%>\% pull(1))
>> 
>> is a syntax error:  those escapes are required in Rd, but are illegal in R.
>> 
>> I don't know if there's a way to do it directly from the Roxygen source.
>> 
>> Duncan Murdoch
>> 
>>>
>>> However, when I reran pkgdown::build_site() I got a new error message that is,
>>> to me, thoroughly confusing:
>>>
>>> Error in utils::modifyList(meta, override) : is.list(x) is not TRUE
>>>
>>> At that point I decided to back out and come here and ask the question in the
>>> subject line!
>> 

-- 
Chris Evans (he/him) <chris at psyctc.org> Visiting Professor, University of Sheffield <chris.evans at sheffield.ac.uk>
I do some consultation work for the University of Roehampton <chris.evans at roehampton.ac.uk> and other places
but <chris at psyctc.org> remains my main Email address.  I have a work web site at:
   https://www.psyctc.org/psyctc/
and a site I manage for CORE and CORE system trust at:
   http://www.coresystemtrust.org.uk/
I have "semigrated" to France, see: 
   https://www.psyctc.org/pelerinage2016/semigrating-to-france/ 
   https://www.psyctc.org/pelerinage2016/register-to-get-updates-from-pelerinage2016/

If you want an Emeeting, I am trying to keep them to Thursdays and my diary is at:
   https://www.psyctc.org/pelerinage2016/ceworkdiary/
Beware: French time, generally an hour ahead of UK.


From m@rk@hogue@chp @end|ng |rom gm@||@com  Mon Apr 12 15:37:25 2021
From: m@rk@hogue@chp @end|ng |rom gm@||@com (Mark Hogue)
Date: Mon, 12 Apr 2021 09:37:25 -0400
Subject: [R-pkg-devel] Checks on wrong package?
Message-ID: <CAHPRF8czbtKOWGGwFdFmOSyAtLEMcuo2wYccqLLoWmovAAnMQg@mail.gmail.com>

Package submission is failing based on RadData 1.0.0, not present
submission, 1.0.1. This submission is to correct a data compression issue
identified by email from Prof Brian Ripley. The warnings are all about what
I'm trying to fix. It doesn't seem possible for a fix on my end.

Please advise.
Thanks,

Mark Hogue

	[[alternative HTML version deleted]]


From murdoch@dunc@n @end|ng |rom gm@||@com  Mon Apr 12 15:40:32 2021
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Mon, 12 Apr 2021 09:40:32 -0400
Subject: [R-pkg-devel] Checks on wrong package?
In-Reply-To: <CAHPRF8czbtKOWGGwFdFmOSyAtLEMcuo2wYccqLLoWmovAAnMQg@mail.gmail.com>
References: <CAHPRF8czbtKOWGGwFdFmOSyAtLEMcuo2wYccqLLoWmovAAnMQg@mail.gmail.com>
Message-ID: <fda445ee-42b6-891e-f30b-c9e1d5adf8c1@gmail.com>

On 12/04/2021 9:37 a.m., Mark Hogue wrote:
> Package submission is failing based on RadData 1.0.0, not present
> submission, 1.0.1. This submission is to correct a data compression issue
> identified by email from Prof Brian Ripley. The warnings are all about what
> I'm trying to fix. It doesn't seem possible for a fix on my end.

You need to let us see the message about the submission failure if you 
want us to give you advice about it.

Duncan Murdoch


From ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de  Mon Apr 12 18:06:50 2021
From: ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de (Uwe Ligges)
Date: Mon, 12 Apr 2021 18:06:50 +0200
Subject: [R-pkg-devel] Checks on wrong package?
In-Reply-To: <fda445ee-42b6-891e-f30b-c9e1d5adf8c1@gmail.com>
References: <CAHPRF8czbtKOWGGwFdFmOSyAtLEMcuo2wYccqLLoWmovAAnMQg@mail.gmail.com>
 <fda445ee-42b6-891e-f30b-c9e1d5adf8c1@gmail.com>
Message-ID: <3df992d2-719e-9b16-c751-9b0b4a5ef6a3@statistik.tu-dortmund.de>

Actually you got

Flavor: r-devel-linux-x86_64-debian-gcc, r-devel-windows-ix86+x86_64
Check: top-level files, Result: NOTE
   Non-standard files/directories found at top level:
     'News.md' 'README.Rmd' 'cran-comments.md'

which shold be fixed.

Best,
Uwe Ligges



On 12.04.2021 15:40, Duncan Murdoch wrote:
> On 12/04/2021 9:37 a.m., Mark Hogue wrote:
>> Package submission is failing based on RadData 1.0.0, not present
>> submission, 1.0.1. This submission is to correct a data compression issue
>> identified by email from Prof Brian Ripley. The warnings are all about 
>> what
>> I'm trying to fix. It doesn't seem possible for a fix on my end.
> 
> You need to let us see the message about the submission failure if you 
> want us to give you advice about it.
> 
> Duncan Murdoch
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From R@R@E@J@n@@en-10 @end|ng |rom umcutrecht@n|  Tue Apr 13 14:09:50 2021
From: R@R@E@J@n@@en-10 @end|ng |rom umcutrecht@n| (Janssen-10, R.R.E. (Roel))
Date: Tue, 13 Apr 2021 12:09:50 +0000
Subject: [R-pkg-devel] Problem with building with libcurl on Windows
In-Reply-To: <defcdd886d3b41b597af2946ebad81e4@umcutrecht.nl>
References: <defcdd886d3b41b597af2946ebad81e4@umcutrecht.nl>
Message-ID: <6af147440553417f98e87cec7adc1998@umcutrecht.nl>

Could it be that "-lcrypt32" is missing in the compile command?
If so, how can I conditionally include it for Windows 32-bit builds?

________________________________
From: R-package-devel <r-package-devel-bounces at r-project.org> on behalf of Janssen-10, R.R.E. (Roel) <R.R.E.Janssen-10 at umcutrecht.nl>
Sent: Friday, April 9, 2021 10:26:52 AM
To: r-package-devel at r-project.org
Subject: [R-pkg-devel] Problem with building with libcurl on Windows

Dear all,


The package I've tried to submit uses HTSlib, which in turn uses libcurl.  >From the build logs, I think there is a version mismatch, or configuration problem with libcurl:

https://win-builder.r-project.org/incoming_pretest/USCDtools_0.0.1_20210409_093124/Windows/00install.out

The problem seems to boil down to:
<https://win-builder.r-project.org/incoming_pretest/USCDtools_0.0.1_20210409_093124/Windows/00install.out>

undefined reference to `_imp__CertEnumCertificatesInStore at 8'

Can I do anything about it in my package?

Kind regards,
Roel Janssen


------------------------------------------------------------------------------

De informatie opgenomen in dit bericht kan vertrouwelijk zijn en is
uitsluitend bestemd voor de geadresseerde. Indien u dit bericht onterecht
ontvangt, wordt u verzocht de inhoud niet te gebruiken en de afzender direct
te informeren door het bericht te retourneren. Het Universitair Medisch
Centrum Utrecht is een publiekrechtelijke rechtspersoon in de zin van de W.H.W.
(Wet Hoger Onderwijs en Wetenschappelijk Onderzoek) en staat geregistreerd bij
de Kamer van Koophandel voor Midden-Nederland onder nr. 30244197.

Denk s.v.p aan het milieu voor u deze e-mail afdrukt.

------------------------------------------------------------------------------

This message may contain confidential information and is...{{dropped:9}}


From e|corteg@no @end|ng |rom gm@||@com  Tue Apr 13 17:48:54 2021
From: e|corteg@no @end|ng |rom gm@||@com (=?UTF-8?Q?Eugenio_L=C3=B3pez_Cortegano?=)
Date: Tue, 13 Apr 2021 16:48:54 +0100
Subject: [R-pkg-devel] WARNING: ISO C forbids an empty translation unit
Message-ID: <CAGjgynZRG1CYjcGXQF=c1rh=4z59SrQwTRU5caU2+P+x5BD9TA@mail.gmail.com>

Hi all,

I just started a submission to CRAN, but got the following WARNING from
win-builder:

Found the following significant warnings: init.c:1: warning: ISO C forbids
an empty translation unit [-Wpedantic]

To the best of my knowledge, -pedantic is a recommended compilation flag
for C++ and relates to the use of strict ISO C++ code. However, the file
pointed (init.c) is not a file I have written, and do not know exactly
where this comes from, or how to fix it. Package uses C++ code and Rcpp,
but nothing like a configure or Makevars is included.

This warning does not appear when  R CMD check --as-cran is run in my home
Linux (Ubuntu 20.04).

Is this a big issue? does anybody have an idea on how to prevent it?

Thank you,
Eugenio

	[[alternative HTML version deleted]]


From c@m@ty| @end|ng |rom protonm@||@com  Tue Apr 13 22:04:36 2021
From: c@m@ty| @end|ng |rom protonm@||@com (csmatyi)
Date: Tue, 13 Apr 2021 20:04:36 +0000
Subject: [R-pkg-devel] how to provide an example for my package when I want
 to generate a figure
Message-ID: <SHAs3o5nTohyDmKI-DFJa75V6RTV4Pl_DPEvsiw4ozaxdg84rQmlqu-9BMU3A25WWThOREE7GHFDrGxIcmq-1Mo1xeGFVTKe4btcwikAUxI=@protonmail.com>

Hello all,

I have a fairly simple package I want to make. It takes two dataframes and then creates a jpeg (a heat map) based on the info in the dataframes.

I know how to put the code in the vignette.
But as to how to make an example, I don't know that. Would I put the code in the R code for the heat map?

How can I do this, it seems very foggy to me.

Thanks, Matthew

Sent with [ProtonMail](https://protonmail.com) Secure Email.
	[[alternative HTML version deleted]]


From berryboe@@enkoo| @end|ng |rom hotm@||@com  Tue Apr 13 22:19:36 2021
From: berryboe@@enkoo| @end|ng |rom hotm@||@com (Berry Boessenkool)
Date: Tue, 13 Apr 2021 20:19:36 +0000
Subject: [R-pkg-devel] 
 how to provide an example for my package when I want
 to generate a figure
In-Reply-To: <SHAs3o5nTohyDmKI-DFJa75V6RTV4Pl_DPEvsiw4ozaxdg84rQmlqu-9BMU3A25WWThOREE7GHFDrGxIcmq-1Mo1xeGFVTKe4btcwikAUxI=@protonmail.com>
References: <SHAs3o5nTohyDmKI-DFJa75V6RTV4Pl_DPEvsiw4ozaxdg84rQmlqu-9BMU3A25WWThOREE7GHFDrGxIcmq-1Mo1xeGFVTKe4btcwikAUxI=@protonmail.com>
Message-ID: <AM0PR01MB40336B00D36EE71D2929E1D3D54F9@AM0PR01MB4033.eurprd01.prod.exchangelabs.com>


Hi Matthew,

see the notes on examples in function documentations here:
https://r-pkgs.org/man.html#man-functions
if you use the Roxygen setup (which I recommend)
or the corresponding info in WRE:
https://cran.r-project.org/doc/manuals/r-release/R-exts.html#Writing-R-documentation-files

Regards,
Berry


________________________________
From: R-package-devel <r-package-devel-bounces at r-project.org> on behalf of csmatyi <csmatyi at protonmail.com>
Sent: Tuesday, April 13, 2021 22:04
To: R-package-devel at r-project.org <R-package-devel at r-project.org>
Subject: [R-pkg-devel] how to provide an example for my package when I want to generate a figure

Hello all,

I have a fairly simple package I want to make. It takes two dataframes and then creates a jpeg (a heat map) based on the info in the dataframes.

I know how to put the code in the vignette.
But as to how to make an example, I don't know that. Would I put the code in the R code for the heat map?

How can I do this, it seems very foggy to me.

Thanks, Matthew

Sent with [ProtonMail](https://protonmail.com) Secure Email.
        [[alternative HTML version deleted]]

______________________________________________
R-package-devel at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-package-devel

	[[alternative HTML version deleted]]


From r|@e|@mp| @end|ng |rom gm@||@com  Wed Apr 14 00:43:07 2021
From: r|@e|@mp| @end|ng |rom gm@||@com (Rafael CM)
Date: Wed, 14 Apr 2021 00:43:07 +0200
Subject: [R-pkg-devel] checking LazyData ... WARNING
Message-ID: <CA+NKSayES+hzx+c-8x19ZNQq6jPgsjmxAQ5NvcqDYMzcyd1Lbg@mail.gmail.com>

Dear all,
I am submitting the RTIGER package and I have the following warning:
checking LazyData ... WARNING
I have saved the data with the optimal compression format. Could someone
help me?
Best,
Rafael

	[[alternative HTML version deleted]]


From c@m@ty| @end|ng |rom protonm@||@com  Wed Apr 14 03:03:14 2021
From: c@m@ty| @end|ng |rom protonm@||@com (csmatyi)
Date: Wed, 14 Apr 2021 01:03:14 +0000
Subject: [R-pkg-devel] error messages
Message-ID: <auni1_V4SBAtFK72qIACQVakA_M0HbQhQ8C-gQpkqJ6c4FkP0hK0IiYVZUaOQjYQsUUCgPJC9MPRR7tk6xlSqnLqHAXch8xAh8ZmLnpaFqI=@protonmail.com>

Hello R package developers,

I tried sending in my package for the fifth time or so, but it still says that it has errors. I read the error messages but I cannot figure out what the error could be. Does anyone know?

Thanks, Matthew

------------------
Windows

* using log directory 'd:/RCompile/CRANincoming/R-devel/hybridogram.Rcheck'
* using R Under development (unstable) (2021-04-11 r80157)
* using platform: x86_64-w64-mingw32 (64-bit)
* using session charset: ISO8859-1
* checking for file 'hybridogram/DESCRIPTION' ... OK
* checking extension type ... Package
* this is package 'hybridogram' version '0.2.0'
* package encoding: UTF-8
* checking CRAN incoming feasibility ... NOTE
Maintainer: 'Matthew Cserhati <
csmatyi at protonmail.com
>'

New submission
* checking package namespace information ... OK
* checking package dependencies ... OK
* checking if this is a source package ... OK
* checking if there is a namespace ... OK
* checking for hidden files and directories ... OK
* checking for portable file names ... OK
* checking serialization versions ... OK
* checking whether package 'hybridogram' can be installed ... OK
* checking installed package size ... OK
* checking package directory ... OK
* checking for future file timestamps ... OK
* checking 'build' directory ... OK
* checking DESCRIPTION meta-information ... OK
* checking top-level files ... OK
* checking for left-over files ... OK
* checking index information ... OK
* checking package subdirectories ... OK
* checking R files for non-ASCII characters ... OK
* checking R files for syntax errors ... OK
* loading checks for arch 'i386'
** checking whether the package can be loaded ... OK
** checking whether the package can be loaded with stated dependencies ... OK
** checking whether the package can be unloaded cleanly ... OK
** checking whether the namespace can be loaded with stated dependencies ... OK
** checking whether the namespace can be unloaded cleanly ... OK
** checking loading without being on the library search path ... OK
** checking use of S3 registration ... OK
* loading checks for arch 'x64'
** checking whether the package can be loaded ... OK
** checking whether the package can be loaded with stated dependencies ... OK
** checking whether the package can be unloaded cleanly ... OK
** checking whether the namespace can be loaded with stated dependencies ... OK
** checking whether the namespace can be unloaded cleanly ... OK
** checking loading without being on the library search path ... OK
** checking use of S3 registration ... OK
* checking dependencies in R code ... OK
* checking S3 generic/method consistency ... OK
* checking replacement functions ... OK
* checking foreign function calls ... OK
* checking R code for possible problems ... [4s] OK
* checking for missing documentation entries ... OK
* checking installed files from 'inst/doc' ... OK
* checking files in 'vignettes' ... OK
* checking examples ... NONE
* checking for unstated dependencies in vignettes ... OK
* checking package vignettes in 'inst/doc' ... OK
* checking re-building of vignette outputs ... [1s] OK
* checking PDF version of manual ... OK
* checking for detritus in the temp directory ... OK
* DONE
Status: 1 NOTE

Debian

* using log directory ?/srv/hornik/tmp/CRAN/hybridogram.Rcheck?
* using R Under development (unstable) (2021-04-12 r80161)
* using platform: x86_64-pc-linux-gnu (64-bit)
* using session charset: UTF-8
* checking for file ?hybridogram/DESCRIPTION? ... OK
* checking extension type ... Package
* this is package ?hybridogram? version ?0.2.0?
* package encoding: UTF-8
* checking CRAN incoming feasibility ... NOTE
Maintainer: ?Matthew Cserhati <
csmatyi at protonmail.com
>?

New submission
* checking package namespace information ... OK
* checking package dependencies ... OK
* checking if this is a source package ... OK
* checking if there is a namespace ... OK
* checking for executable files ... OK
* checking for hidden files and directories ... OK
* checking for portable file names ... OK
* checking for sufficient/correct file permissions ... OK
* checking serialization versions ... OK
* checking whether package ?hybridogram? can be installed ... [0s/0s] ERROR
Installation failed.
See ?/srv/hornik/tmp/CRAN/
hybridogram.Rcheck/00install.out
? for details.
* DONE
Status: 1 ERROR, 1 NOTE
	[[alternative HTML version deleted]]


From edd @end|ng |rom deb|@n@org  Wed Apr 14 03:47:45 2021
From: edd @end|ng |rom deb|@n@org (Dirk Eddelbuettel)
Date: Tue, 13 Apr 2021 20:47:45 -0500
Subject: [R-pkg-devel] error messages
In-Reply-To: <auni1_V4SBAtFK72qIACQVakA_M0HbQhQ8C-gQpkqJ6c4FkP0hK0IiYVZUaOQjYQsUUCgPJC9MPRR7tk6xlSqnLqHAXch8xAh8ZmLnpaFqI=@protonmail.com>
References: <auni1_V4SBAtFK72qIACQVakA_M0HbQhQ8C-gQpkqJ6c4FkP0hK0IiYVZUaOQjYQsUUCgPJC9MPRR7tk6xlSqnLqHAXch8xAh8ZmLnpaFqI=@protonmail.com>
Message-ID: <24694.18881.72856.449782@rob.eddelbuettel.com>


On 14 April 2021 at 01:03, csmatyi wrote:
| Debian
| 
| * using log directory ?/srv/hornik/tmp/CRAN/hybridogram.Rcheck?
| * using R Under development (unstable) (2021-04-12 r80161)
| * using platform: x86_64-pc-linux-gnu (64-bit)
| * using session charset: UTF-8
| * checking for file ?hybridogram/DESCRIPTION? ... OK
| * checking extension type ... Package
| * this is package ?hybridogram? version ?0.2.0?
| * package encoding: UTF-8
| * checking CRAN incoming feasibility ... NOTE
| Maintainer: ?Matthew Cserhati <
| csmatyi at protonmail.com
| >?
| 
| New submission
| * checking package namespace information ... OK
| * checking package dependencies ... OK
| * checking if this is a source package ... OK
| * checking if there is a namespace ... OK
| * checking for executable files ... OK
| * checking for hidden files and directories ... OK
| * checking for portable file names ... OK
| * checking for sufficient/correct file permissions ... OK
| * checking serialization versions ... OK
| * checking whether package ?hybridogram? can be installed ... [0s/0s] ERROR
| Installation failed.
| See ?/srv/hornik/tmp/CRAN/
| hybridogram.Rcheck/00install.out
| ? for details.
| * DONE
| Status: 1 ERROR, 1 NOTE

You need to figure out why it does not install.

RHub (http://builder.r-hub.io/) may help if you do not have a suitable
machine nearby.

Dirk

-- 
https://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de  Wed Apr 14 10:53:24 2021
From: ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de (Uwe Ligges)
Date: Wed, 14 Apr 2021 10:53:24 +0200
Subject: [R-pkg-devel] error messages
In-Reply-To: <24694.18881.72856.449782@rob.eddelbuettel.com>
References: <auni1_V4SBAtFK72qIACQVakA_M0HbQhQ8C-gQpkqJ6c4FkP0hK0IiYVZUaOQjYQsUUCgPJC9MPRR7tk6xlSqnLqHAXch8xAh8ZmLnpaFqI=@protonmail.com>
 <24694.18881.72856.449782@rob.eddelbuettel.com>
Message-ID: <143922e7-eb70-19b6-0b11-6e90df700f97@statistik.tu-dortmund.de>

Or simply navigate to the install log which is avaiable from the links 
you got.

Best,
Uwe Ligges

On 14.04.2021 03:47, Dirk Eddelbuettel wrote:
> 
> On 14 April 2021 at 01:03, csmatyi wrote:
> | Debian
> |
> | * using log directory ?/srv/hornik/tmp/CRAN/hybridogram.Rcheck?
> | * using R Under development (unstable) (2021-04-12 r80161)
> | * using platform: x86_64-pc-linux-gnu (64-bit)
> | * using session charset: UTF-8
> | * checking for file ?hybridogram/DESCRIPTION? ... OK
> | * checking extension type ... Package
> | * this is package ?hybridogram? version ?0.2.0?
> | * package encoding: UTF-8
> | * checking CRAN incoming feasibility ... NOTE
> | Maintainer: ?Matthew Cserhati <
> | csmatyi at protonmail.com
> | >?
> |
> | New submission
> | * checking package namespace information ... OK
> | * checking package dependencies ... OK
> | * checking if this is a source package ... OK
> | * checking if there is a namespace ... OK
> | * checking for executable files ... OK
> | * checking for hidden files and directories ... OK
> | * checking for portable file names ... OK
> | * checking for sufficient/correct file permissions ... OK
> | * checking serialization versions ... OK
> | * checking whether package ?hybridogram? can be installed ... [0s/0s] ERROR
> | Installation failed.
> | See ?/srv/hornik/tmp/CRAN/
> | hybridogram.Rcheck/00install.out
> | ? for details.
> | * DONE
> | Status: 1 ERROR, 1 NOTE
> 
> You need to figure out why it does not install.
> 
> RHub (http://builder.r-hub.io/) may help if you do not have a suitable
> machine nearby.
> 
> Dirk
>


From r|@e|@mp| @end|ng |rom gm@||@com  Wed Apr 14 13:11:09 2021
From: r|@e|@mp| @end|ng |rom gm@||@com (Rafael CM)
Date: Wed, 14 Apr 2021 13:11:09 +0200
Subject: [R-pkg-devel] checking LazyData ... WARNING
Message-ID: <CA+NKSayuveA0o55X9E-oQRow1gZ78n7O6+hGJNHVk1BBDhw-yw@mail.gmail.com>

Dear all,
I am having the following warning when loading my rpackage:

* checking LazyData ... WARNING
  LazyData DB of 62.1 MB without LazyDataCompression set


I can't get to fix this problem. I have tried the tools option to optimize
saving. I used different types of compressions. I also have set LazyDate:
true to my DESCRIPTION file.
Any ideas?
Thank you in advance,
Rafael

	[[alternative HTML version deleted]]


From ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de  Wed Apr 14 13:37:54 2021
From: ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de (Uwe Ligges)
Date: Wed, 14 Apr 2021 13:37:54 +0200
Subject: [R-pkg-devel] checking LazyData ... WARNING
In-Reply-To: <CA+NKSayES+hzx+c-8x19ZNQq6jPgsjmxAQ5NvcqDYMzcyd1Lbg@mail.gmail.com>
References: <CA+NKSayES+hzx+c-8x19ZNQq6jPgsjmxAQ5NvcqDYMzcyd1Lbg@mail.gmail.com>
Message-ID: <c91454b6-ec07-b37e-ac70-142bb0cf1ea6@statistik.tu-dortmund.de>



On 14.04.2021 00:43, Rafael CM wrote:
> Dear all,
> I am submitting the RTIGER package and I have the following warning:
> checking LazyData ... WARNING

A full message would be needed ....

Best,
Uwe Ligges



> I have saved the data with the optimal compression format. Could someone
> help me?
> Best,
> Rafael
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


From r|@e|@mp| @end|ng |rom gm@||@com  Wed Apr 14 13:39:31 2021
From: r|@e|@mp| @end|ng |rom gm@||@com (Rafael CM)
Date: Wed, 14 Apr 2021 13:39:31 +0200
Subject: [R-pkg-devel] checking LazyData ... WARNING
In-Reply-To: <c91454b6-ec07-b37e-ac70-142bb0cf1ea6@statistik.tu-dortmund.de>
References: <CA+NKSayES+hzx+c-8x19ZNQq6jPgsjmxAQ5NvcqDYMzcyd1Lbg@mail.gmail.com>
 <c91454b6-ec07-b37e-ac70-142bb0cf1ea6@statistik.tu-dortmund.de>
Message-ID: <CA+NKSay+TzQ-AjphU7=iTZs3u7nxnSw8QuO2JA6Oa5j0P=9xJw@mail.gmail.com>

 checking LazyData ... WARNING
  LazyData DB of 62.1 MB without LazyDataCompression set
  See ?1.1.6 of 'Writing R Extensions'


On Wed, Apr 14, 2021 at 1:38 PM Uwe Ligges <ligges at statistik.tu-dortmund.de>
wrote:

>
>
> On 14.04.2021 00:43, Rafael CM wrote:
> > Dear all,
> > I am submitting the RTIGER package and I have the following warning:
> > checking LazyData ... WARNING
>
> A full message would be needed ....
>
> Best,
> Uwe Ligges
>
>
>
> > I have saved the data with the optimal compression format. Could someone
> > help me?
> > Best,
> > Rafael
> >
> >       [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-package-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-package-devel
> >
>

	[[alternative HTML version deleted]]


From @eb@meyer @end|ng |rom |@u@de  Wed Apr 14 13:42:30 2021
From: @eb@meyer @end|ng |rom |@u@de (Sebastian Meyer)
Date: Wed, 14 Apr 2021 13:42:30 +0200
Subject: [R-pkg-devel] checking LazyData ... WARNING
In-Reply-To: <CA+NKSayuveA0o55X9E-oQRow1gZ78n7O6+hGJNHVk1BBDhw-yw@mail.gmail.com>
References: <CA+NKSayuveA0o55X9E-oQRow1gZ78n7O6+hGJNHVk1BBDhw-yw@mail.gmail.com>
Message-ID: <8768a290-b8b1-c11e-f976-ff42b359c76f@fau.de>

Am 14.04.21 um 13:11 schrieb Rafael CM:
> Dear all,
> I am having the following warning when loading my rpackage:
> 
> * checking LazyData ... WARNING
>   LazyData DB of 62.1 MB without LazyDataCompression set
> 
> 
> I can't get to fix this problem. I have tried the tools option to optimize
> saving. I used different types of compressions. I also have set LazyDate:
> true to my DESCRIPTION file.
> Any ideas?

Have you already tried also setting LazyDataCompression as the warning
suggests?

You should try all of bzip2, xz and gzip in turn and look at the size of
the installed lazy-loading database to find the best compression format.
The development version of the WRE manual at

https://cran.r-project.org/doc/manuals/r-devel/R-exts.html#Data-in-packages

gives a function CheckLazyDataCompression, which can be used to do that.

Best regards,

	Sebastian


> Thank you in advance,
> Rafael
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


From jnn @end|ng |rom b|o@@@u@dk  Wed Apr 14 11:41:28 2021
From: jnn @end|ng |rom b|o@@@u@dk (Jacob Nabe-Nielsen)
Date: Wed, 14 Apr 2021 09:41:28 +0000
Subject: [R-pkg-devel] Problem with S4 method for plotting a raster file
Message-ID: <A39314C5-E914-464E-AC54-CC93CC25CE0A@bios.au.dk>

Dear all,

I have just discovered an error in a package that I have already uploaded to
CRAN, and cannot figure out how to fix it. All help will be greatly appreciated.
The package is called DEPONS2R, and is available from:
https://cran.r-project.org/web/packages/DEPONS2R/index.html

The problem is related to one of the included examples, where I plot the coastline
on top of a raster file. In the example, where the plotting is embedded in
an S4 method called plot.DeponsRaster, the coastline does not show. But if
I run the functions that the method is composed of, everything works fine (see
below). So I am wondering if the graphics devise is not passed on correctly
within the package, or what actually happens.

The example that does not run correctly is available from ?plot.DeponsRaster:

library(DEPONS2R)

data("bathymetry")
plot(bathymetry)
data("coastline")
library(rgdal)
# Change projection of coastline to match that of bathymetry data
coastline2 <- spTransform(coastline, crs(bathymetry))
plot(coastline2, add=TRUE, col="lightyellow2")


Here the coastline is not plotted. The method is defined as:


setMethod("plot", signature("DeponsRaster", "ANY"),
          function(x, y, maxpixels=500000, col, alpha=NULL, colNA=NA, add=FALSE,
                   ext=NULL, useRaster=TRUE, interpolate=FALSE, addfun=NULL,
                   nc, nr, maxnl=16, main, npretty=0, axes=TRUE,
                   legend=TRUE, trackToPlot=1, ...)  {
            oldpar <- graphics::par(no.readonly = TRUE)
            on.exit(graphics::par(oldpar))
            if (missing(main)) {
              main <- paste(x at landscape, x at type, sep=" - ")
            }
            # Define colours specific or 'type'
            if(missing(col) && x at type=="bathymetry") {
              tmp.col <- grDevices::rainbow(1000)[501:800]
              col <- c(tmp.col[1:100], rep(tmp.col[101:250], each=5))
            }
            # Use {raster}-package for plotting
            if(x at crs=="NA") {
              crs2 <- sp::CRS(as.character(NA))
            } else {
              crs2 <- sp::CRS(x at crs)
            }
            rdata <- raster::raster(x=x at data, xmn=x at ext$xleft, xmx=x at ext$xright,
                                    ymn=x at ext$ybottom, ymx=x at ext$ytop,
                                    crs=crs2)
            raster::plot(rdata, col=col, main=main,
                         alpha=alpha, add=add, ext=ext, axes=axes, legend=legend)
          }
)


But when I use the functions that are at the core of this method it is
not a problem adding the coastline correctly:

x <- bathymetry
crs2 <- raster::crs(x at crs)
rdata <- raster::raster(x = x at data, xmn = x at ext$xleft,
xmx = x at ext$xright, ymn = x at ext$ybottom, ymx = x at ext$ytop,
crs = crs2)
raster::plot(rdata)
plot(coastline2, add=TRUE, col="lightyellow2")

If would be fantastic if someone can figure out how I should modify the method
to plot the coastline correctly on top of the map.


Best regards,
Jacob

	[[alternative HTML version deleted]]


From murdoch@dunc@n @end|ng |rom gm@||@com  Wed Apr 14 14:44:40 2021
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Wed, 14 Apr 2021 08:44:40 -0400
Subject: [R-pkg-devel] Problem with S4 method for plotting a raster file
In-Reply-To: <A39314C5-E914-464E-AC54-CC93CC25CE0A@bios.au.dk>
References: <A39314C5-E914-464E-AC54-CC93CC25CE0A@bios.au.dk>
Message-ID: <b70acce2-9c19-18a4-5efb-3ff6324e6101@gmail.com>

On 14/04/2021 5:41 a.m., Jacob Nabe-Nielsen wrote:
> Dear all,
> 
> I have just discovered an error in a package that I have already uploaded to
> CRAN, and cannot figure out how to fix it. All help will be greatly appreciated.
> The package is called DEPONS2R, and is available from:
> https://cran.r-project.org/web/packages/DEPONS2R/index.html
> 
> The problem is related to one of the included examples, where I plot the coastline
> on top of a raster file. In the example, where the plotting is embedded in
> an S4 method called plot.DeponsRaster, the coastline does not show. But if
> I run the functions that the method is composed of, everything works fine (see
> below). So I am wondering if the graphics devise is not passed on correctly
> within the package, or what actually happens.
> 
> The example that does not run correctly is available from ?plot.DeponsRaster:
> 
> library(DEPONS2R)
> 
> data("bathymetry")
> plot(bathymetry)
> data("coastline")
> library(rgdal)
> # Change projection of coastline to match that of bathymetry data
> coastline2 <- spTransform(coastline, crs(bathymetry))
> plot(coastline2, add=TRUE, col="lightyellow2")
> 
> 
> Here the coastline is not plotted. The method is defined as:
> 
> 
> setMethod("plot", signature("DeponsRaster", "ANY"),
>            function(x, y, maxpixels=500000, col, alpha=NULL, colNA=NA, add=FALSE,
>                     ext=NULL, useRaster=TRUE, interpolate=FALSE, addfun=NULL,
>                     nc, nr, maxnl=16, main, npretty=0, axes=TRUE,
>                     legend=TRUE, trackToPlot=1, ...)  {
>              oldpar <- graphics::par(no.readonly = TRUE)
>              on.exit(graphics::par(oldpar))
>              if (missing(main)) {
>                main <- paste(x at landscape, x at type, sep=" - ")
>              }
>              # Define colours specific or 'type'
>              if(missing(col) && x at type=="bathymetry") {
>                tmp.col <- grDevices::rainbow(1000)[501:800]
>                col <- c(tmp.col[1:100], rep(tmp.col[101:250], each=5))
>              }
>              # Use {raster}-package for plotting
>              if(x at crs=="NA") {
>                crs2 <- sp::CRS(as.character(NA))
>              } else {
>                crs2 <- sp::CRS(x at crs)
>              }
>              rdata <- raster::raster(x=x at data, xmn=x at ext$xleft, xmx=x at ext$xright,
>                                      ymn=x at ext$ybottom, ymx=x at ext$ytop,
>                                      crs=crs2)
>              raster::plot(rdata, col=col, main=main,
>                           alpha=alpha, add=add, ext=ext, axes=axes, legend=legend)
>            }
> )
> 
> 
> But when I use the functions that are at the core of this method it is
> not a problem adding the coastline correctly:
> 
> x <- bathymetry
> crs2 <- raster::crs(x at crs)
> rdata <- raster::raster(x = x at data, xmn = x at ext$xleft,
> xmx = x at ext$xright, ymn = x at ext$ybottom, ymx = x at ext$ytop,
> crs = crs2)
> raster::plot(rdata)
> plot(coastline2, add=TRUE, col="lightyellow2")
> 
> If would be fantastic if someone can figure out how I should modify the method
> to plot the coastline correctly on top of the map.
> 
> 

I'm not sure exactly what is going wrong, but if you plot the coastline 
first and the bathymetry second, things do show up.  Maybe that's enough 
of a hint for you:

library(DEPONS2R)
data("coastline")
library(rgdal)
coastline2 <- spTransform(coastline, crs(bathymetry))
plot(coastline2, col="lightyellow2")

data("bathymetry")
plot(bathymetry, add=TRUE)

This puts the legend on top of the plotted coastline data, so my guess 
is that the limits of the bathymetry plot aren't being made available to 
the coastline plot when you do things in the original order.

Duncan Murdoch


From georg|@bo@hn@kov @end|ng |rom m@nche@ter@@c@uk  Wed Apr 14 15:24:45 2021
From: georg|@bo@hn@kov @end|ng |rom m@nche@ter@@c@uk (Georgi Boshnakov)
Date: Wed, 14 Apr 2021 13:24:45 +0000
Subject: [R-pkg-devel] Problem with S4 method for plotting a raster file
In-Reply-To: <b70acce2-9c19-18a4-5efb-3ff6324e6101@gmail.com>
References: <A39314C5-E914-464E-AC54-CC93CC25CE0A@bios.au.dk>
 <b70acce2-9c19-18a4-5efb-3ff6324e6101@gmail.com>
Message-ID: <LOYP265MB2015CD1981F9DF7F99D55C1BAE4E9@LOYP265MB2015.GBRP265.PROD.OUTLOOK.COM>

> library(DEPONS2R)
> 
> data("bathymetry")
> plot(bathymetry)
> data("coastline")
> library(rgdal)
> # Change projection of coastline to match that of bathymetry data
> coastline2 <- spTransform(coastline, crs(bathymetry)) plot(coastline2, 
> add=TRUE, col="lightyellow2")

The inclusion of 'library(rgdal)' above suggests that your plot method needs something from 'rgdal'. If that something is a plot method from that package, it may not be visible from your function (due to changes introduced in R-4.0.0, search NEWS for R-4.0.0 'plot'), you would need to import plot methods from rgdal if that is the case (and maybe move rgdal from Suggests to Imports). 

Georgi Boshnakov


-----Original Message-----
From: R-package-devel <r-package-devel-bounces at r-project.org> On Behalf Of Duncan Murdoch
Sent: 14 April 2021 13:45
To: Jacob Nabe-Nielsen <jnn at bios.au.dk>; r-package-devel at r-project.org
Subject: Re: [R-pkg-devel] Problem with S4 method for plotting a raster file

On 14/04/2021 5:41 a.m., Jacob Nabe-Nielsen wrote:
> Dear all,
> 
> I have just discovered an error in a package that I have already 
> uploaded to CRAN, and cannot figure out how to fix it. All help will be greatly appreciated.
> The package is called DEPONS2R, and is available from:
> https://cran.r-project.org/web/packages/DEPONS2R/index.html
> 
> The problem is related to one of the included examples, where I plot 
> the coastline on top of a raster file. In the example, where the 
> plotting is embedded in an S4 method called plot.DeponsRaster, the 
> coastline does not show. But if I run the functions that the method is 
> composed of, everything works fine (see below). So I am wondering if 
> the graphics devise is not passed on correctly within the package, or what actually happens.
> 
> The example that does not run correctly is available from ?plot.DeponsRaster:
> 
> library(DEPONS2R)
> 
> data("bathymetry")
> plot(bathymetry)
> data("coastline")
> library(rgdal)
> # Change projection of coastline to match that of bathymetry data
> coastline2 <- spTransform(coastline, crs(bathymetry)) plot(coastline2, 
> add=TRUE, col="lightyellow2")
> 
> 
> Here the coastline is not plotted. The method is defined as:
> 
> 
> setMethod("plot", signature("DeponsRaster", "ANY"),
>            function(x, y, maxpixels=500000, col, alpha=NULL, colNA=NA, add=FALSE,
>                     ext=NULL, useRaster=TRUE, interpolate=FALSE, addfun=NULL,
>                     nc, nr, maxnl=16, main, npretty=0, axes=TRUE,
>                     legend=TRUE, trackToPlot=1, ...)  {
>              oldpar <- graphics::par(no.readonly = TRUE)
>              on.exit(graphics::par(oldpar))
>              if (missing(main)) {
>                main <- paste(x at landscape, x at type, sep=" - ")
>              }
>              # Define colours specific or 'type'
>              if(missing(col) && x at type=="bathymetry") {
>                tmp.col <- grDevices::rainbow(1000)[501:800]
>                col <- c(tmp.col[1:100], rep(tmp.col[101:250], each=5))
>              }
>              # Use {raster}-package for plotting
>              if(x at crs=="NA") {
>                crs2 <- sp::CRS(as.character(NA))
>              } else {
>                crs2 <- sp::CRS(x at crs)
>              }
>              rdata <- raster::raster(x=x at data, xmn=x at ext$xleft, xmx=x at ext$xright,
>                                      ymn=x at ext$ybottom, ymx=x at ext$ytop,
>                                      crs=crs2)
>              raster::plot(rdata, col=col, main=main,
>                           alpha=alpha, add=add, ext=ext, axes=axes, legend=legend)
>            }
> )
> 
> 
> But when I use the functions that are at the core of this method it is 
> not a problem adding the coastline correctly:
> 
> x <- bathymetry
> crs2 <- raster::crs(x at crs)
> rdata <- raster::raster(x = x at data, xmn = x at ext$xleft, xmx = 
> x at ext$xright, ymn = x at ext$ybottom, ymx = x at ext$ytop, crs = crs2)
> raster::plot(rdata)
> plot(coastline2, add=TRUE, col="lightyellow2")
> 
> If would be fantastic if someone can figure out how I should modify 
> the method to plot the coastline correctly on top of the map.
> 
> 

I'm not sure exactly what is going wrong, but if you plot the coastline first and the bathymetry second, things do show up.  Maybe that's enough of a hint for you:

library(DEPONS2R)
data("coastline")
library(rgdal)
coastline2 <- spTransform(coastline, crs(bathymetry)) plot(coastline2, col="lightyellow2")

data("bathymetry")
plot(bathymetry, add=TRUE)

This puts the legend on top of the plotted coastline data, so my guess is that the limits of the bathymetry plot aren't being made available to the coastline plot when you do things in the original order.

Duncan Murdoch

______________________________________________
R-package-devel at r-project.org mailing list https://stat.ethz.ch/mailman/listinfo/r-package-devel


From jnn @end|ng |rom b|o@@@u@dk  Wed Apr 14 15:26:58 2021
From: jnn @end|ng |rom b|o@@@u@dk (Jacob Nabe-Nielsen)
Date: Wed, 14 Apr 2021 13:26:58 +0000
Subject: [R-pkg-devel] Problem with S4 method for plotting a raster file
In-Reply-To: <b70acce2-9c19-18a4-5efb-3ff6324e6101@gmail.com>
References: <A39314C5-E914-464E-AC54-CC93CC25CE0A@bios.au.dk>
 <b70acce2-9c19-18a4-5efb-3ff6324e6101@gmail.com>
Message-ID: <962B2433-9D85-49FD-8099-F93E16359AA6@bios.au.dk>

Hi Duncan

Thanks a lot for the help. This works, but unfortunately it does not result in a landscape which is cropped to the extent of the bathymetry raster file... it would be nice to be able to do that as well (as you can if you use the 'raster' and 'sp' packages).

Best wishes,
Jacob


On 14 Apr 2021, at 14.44, Duncan Murdoch <murdoch.duncan at gmail.com<mailto:murdoch.duncan at gmail.com>> wrote:

On 14/04/2021 5:41 a.m., Jacob Nabe-Nielsen wrote:
Dear all,
I have just discovered an error in a package that I have already uploaded to
CRAN, and cannot figure out how to fix it. All help will be greatly appreciated.
The package is called DEPONS2R, and is available from:
https://cran.r-project.org/web/packages/DEPONS2R/index.html
The problem is related to one of the included examples, where I plot the coastline
on top of a raster file. In the example, where the plotting is embedded in
an S4 method called plot.DeponsRaster, the coastline does not show. But if
I run the functions that the method is composed of, everything works fine (see
below). So I am wondering if the graphics devise is not passed on correctly
within the package, or what actually happens.
The example that does not run correctly is available from ?plot.DeponsRaster:
library(DEPONS2R)
data("bathymetry")
plot(bathymetry)
data("coastline")
library(rgdal)
# Change projection of coastline to match that of bathymetry data
coastline2 <- spTransform(coastline, crs(bathymetry))
plot(coastline2, add=TRUE, col="lightyellow2")
Here the coastline is not plotted. The method is defined as:
setMethod("plot", signature("DeponsRaster", "ANY"),
          function(x, y, maxpixels=500000, col, alpha=NULL, colNA=NA, add=FALSE,
                   ext=NULL, useRaster=TRUE, interpolate=FALSE, addfun=NULL,
                   nc, nr, maxnl=16, main, npretty=0, axes=TRUE,
                   legend=TRUE, trackToPlot=1, ...)  {
            oldpar <- graphics::par(no.readonly = TRUE)
            on.exit(graphics::par(oldpar))
            if (missing(main)) {
              main <- paste(x at landscape, x at type, sep=" - ")
            }
            # Define colours specific or 'type'
            if(missing(col) && x at type=="bathymetry") {
              tmp.col <- grDevices::rainbow(1000)[501:800]
              col <- c(tmp.col[1:100], rep(tmp.col[101:250], each=5))
            }
            # Use {raster}-package for plotting
            if(x at crs=="NA") {
              crs2 <- sp::CRS(as.character(NA))
            } else {
              crs2 <- sp::CRS(x at crs)
            }
            rdata <- raster::raster(x=x at data, xmn=x at ext$xleft, xmx=x at ext$xright,
                                    ymn=x at ext$ybottom, ymx=x at ext$ytop,
                                    crs=crs2)
            raster::plot(rdata, col=col, main=main,
                         alpha=alpha, add=add, ext=ext, axes=axes, legend=legend)
          }
)
But when I use the functions that are at the core of this method it is
not a problem adding the coastline correctly:
x <- bathymetry
crs2 <- raster::crs(x at crs)
rdata <- raster::raster(x = x at data, xmn = x at ext$xleft,
xmx = x at ext$xright, ymn = x at ext$ybottom, ymx = x at ext$ytop,
crs = crs2)
raster::plot(rdata)
plot(coastline2, add=TRUE, col="lightyellow2")
If would be fantastic if someone can figure out how I should modify the method
to plot the coastline correctly on top of the map.

I'm not sure exactly what is going wrong, but if you plot the coastline first and the bathymetry second, things do show up.  Maybe that's enough of a hint for you:

library(DEPONS2R)
data("coastline")
library(rgdal)
coastline2 <- spTransform(coastline, crs(bathymetry))
plot(coastline2, col="lightyellow2")

data("bathymetry")
plot(bathymetry, add=TRUE)

This puts the legend on top of the plotted coastline data, so my guess is that the limits of the bathymetry plot aren't being made available to the coastline plot when you do things in the original order.

Duncan Murdoch


	[[alternative HTML version deleted]]


From jnn @end|ng |rom b|o@@@u@dk  Wed Apr 14 16:00:04 2021
From: jnn @end|ng |rom b|o@@@u@dk (Jacob Nabe-Nielsen)
Date: Wed, 14 Apr 2021 14:00:04 +0000
Subject: [R-pkg-devel] Problem with S4 method for plotting a raster file
In-Reply-To: <LOYP265MB2015CD1981F9DF7F99D55C1BAE4E9@LOYP265MB2015.GBRP265.PROD.OUTLOOK.COM>
References: <A39314C5-E914-464E-AC54-CC93CC25CE0A@bios.au.dk>
 <b70acce2-9c19-18a4-5efb-3ff6324e6101@gmail.com>
 <LOYP265MB2015CD1981F9DF7F99D55C1BAE4E9@LOYP265MB2015.GBRP265.PROD.OUTLOOK.COM>
Message-ID: <6DC401C4-6857-4A67-BD4B-65ACD35CF865@bios.au.dk>

Dear Georgi

Thanks a lot for the suggestion. I have now imported rgdal and moved it from Suggests of Imports. However, this did not solve my problem.
I also tried importing 'plot' directly from rgdal, but then I got the error: object ?plot? is not exported by 'namespace:rgdal'

Best,
Jacob


> On 14 Apr 2021, at 15.24, Georgi Boshnakov <georgi.boshnakov at manchester.ac.uk> wrote:
> 
>> library(DEPONS2R)
>> 
>> data("bathymetry")
>> plot(bathymetry)
>> data("coastline")
>> library(rgdal)
>> # Change projection of coastline to match that of bathymetry data
>> coastline2 <- spTransform(coastline, crs(bathymetry)) plot(coastline2, 
>> add=TRUE, col="lightyellow2")
> 
> The inclusion of 'library(rgdal)' above suggests that your plot method needs something from 'rgdal'. If that something is a plot method from that package, it may not be visible from your function (due to changes introduced in R-4.0.0, search NEWS for R-4.0.0 'plot'), you would need to import plot methods from rgdal if that is the case (and maybe move rgdal from Suggests to Imports). 
> 
> Georgi Boshnakov
> 
> 
> -----Original Message-----
> From: R-package-devel <r-package-devel-bounces at r-project.org> On Behalf Of Duncan Murdoch
> Sent: 14 April 2021 13:45
> To: Jacob Nabe-Nielsen <jnn at bios.au.dk>; r-package-devel at r-project.org
> Subject: Re: [R-pkg-devel] Problem with S4 method for plotting a raster file
> 
> On 14/04/2021 5:41 a.m., Jacob Nabe-Nielsen wrote:
>> Dear all,
>> 
>> I have just discovered an error in a package that I have already 
>> uploaded to CRAN, and cannot figure out how to fix it. All help will be greatly appreciated.
>> The package is called DEPONS2R, and is available from:
>> https://cran.r-project.org/web/packages/DEPONS2R/index.html
>> 
>> The problem is related to one of the included examples, where I plot 
>> the coastline on top of a raster file. In the example, where the 
>> plotting is embedded in an S4 method called plot.DeponsRaster, the 
>> coastline does not show. But if I run the functions that the method is 
>> composed of, everything works fine (see below). So I am wondering if 
>> the graphics devise is not passed on correctly within the package, or what actually happens.
>> 
>> The example that does not run correctly is available from ?plot.DeponsRaster:
>> 
>> library(DEPONS2R)
>> 
>> data("bathymetry")
>> plot(bathymetry)
>> data("coastline")
>> library(rgdal)
>> # Change projection of coastline to match that of bathymetry data
>> coastline2 <- spTransform(coastline, crs(bathymetry)) plot(coastline2, 
>> add=TRUE, col="lightyellow2")
>> 
>> 
>> Here the coastline is not plotted. The method is defined as:
>> 
>> 
>> setMethod("plot", signature("DeponsRaster", "ANY"),
>>           function(x, y, maxpixels=500000, col, alpha=NULL, colNA=NA, add=FALSE,
>>                    ext=NULL, useRaster=TRUE, interpolate=FALSE, addfun=NULL,
>>                    nc, nr, maxnl=16, main, npretty=0, axes=TRUE,
>>                    legend=TRUE, trackToPlot=1, ...)  {
>>             oldpar <- graphics::par(no.readonly = TRUE)
>>             on.exit(graphics::par(oldpar))
>>             if (missing(main)) {
>>               main <- paste(x at landscape, x at type, sep=" - ")
>>             }
>>             # Define colours specific or 'type'
>>             if(missing(col) && x at type=="bathymetry") {
>>               tmp.col <- grDevices::rainbow(1000)[501:800]
>>               col <- c(tmp.col[1:100], rep(tmp.col[101:250], each=5))
>>             }
>>             # Use {raster}-package for plotting
>>             if(x at crs=="NA") {
>>               crs2 <- sp::CRS(as.character(NA))
>>             } else {
>>               crs2 <- sp::CRS(x at crs)
>>             }
>>             rdata <- raster::raster(x=x at data, xmn=x at ext$xleft, xmx=x at ext$xright,
>>                                     ymn=x at ext$ybottom, ymx=x at ext$ytop,
>>                                     crs=crs2)
>>             raster::plot(rdata, col=col, main=main,
>>                          alpha=alpha, add=add, ext=ext, axes=axes, legend=legend)
>>           }
>> )
>> 
>> 
>> But when I use the functions that are at the core of this method it is 
>> not a problem adding the coastline correctly:
>> 
>> x <- bathymetry
>> crs2 <- raster::crs(x at crs)
>> rdata <- raster::raster(x = x at data, xmn = x at ext$xleft, xmx = 
>> x at ext$xright, ymn = x at ext$ybottom, ymx = x at ext$ytop, crs = crs2)
>> raster::plot(rdata)
>> plot(coastline2, add=TRUE, col="lightyellow2")
>> 
>> If would be fantastic if someone can figure out how I should modify 
>> the method to plot the coastline correctly on top of the map.
>> 
>> 
> 
> I'm not sure exactly what is going wrong, but if you plot the coastline first and the bathymetry second, things do show up.  Maybe that's enough of a hint for you:
> 
> library(DEPONS2R)
> data("coastline")
> library(rgdal)
> coastline2 <- spTransform(coastline, crs(bathymetry)) plot(coastline2, col="lightyellow2")
> 
> data("bathymetry")
> plot(bathymetry, add=TRUE)
> 
> This puts the legend on top of the plotted coastline data, so my guess is that the limits of the bathymetry plot aren't being made available to the coastline plot when you do things in the original order.
> 
> Duncan Murdoch
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list https://stat.ethz.ch/mailman/listinfo/r-package-devel


From murdoch@dunc@n @end|ng |rom gm@||@com  Wed Apr 14 16:21:16 2021
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Wed, 14 Apr 2021 10:21:16 -0400
Subject: [R-pkg-devel] Problem with S4 method for plotting a raster file
In-Reply-To: <962B2433-9D85-49FD-8099-F93E16359AA6@bios.au.dk>
References: <A39314C5-E914-464E-AC54-CC93CC25CE0A@bios.au.dk>
 <b70acce2-9c19-18a4-5efb-3ff6324e6101@gmail.com>
 <962B2433-9D85-49FD-8099-F93E16359AA6@bios.au.dk>
Message-ID: <05256be8-de09-9a18-da71-ea3910a1c73b@gmail.com>

On 14/04/2021 9:26 a.m., Jacob Nabe-Nielsen wrote:
> Hi Duncan
> 
> Thanks a lot for the help. This works, but unfortunately it does not 
> result in a landscape which is cropped to the extent of the bathymetry 
> raster file... it would be nice to be able to do that as well (as you 
> can if you use the 'raster' and 'sp' packages).
> 

I wasn't suggesting that my code was a solution, it's just a hint about 
what is going wrong.  I don't know how the coastline plot determines the 
bounds of the plot region, but if that isn't working, then you'd have 
problems similar to what you saw.

Duncan Murdoch


> Best wishes,
> Jacob
> 
> 
>> On 14 Apr 2021, at 14.44, Duncan Murdoch <murdoch.duncan at gmail.com 
>> <mailto:murdoch.duncan at gmail.com>> wrote:
>>
>> On 14/04/2021 5:41 a.m., Jacob Nabe-Nielsen wrote:
>>> Dear all,
>>> I have just discovered an error in a package that I have already 
>>> uploaded to
>>> CRAN, and cannot figure out how to fix it. All help will be greatly 
>>> appreciated.
>>> The package is called DEPONS2R, and is available from:
>>> https://cran.r-project.org/web/packages/DEPONS2R/index.html 
>>> <https://cran.r-project.org/web/packages/DEPONS2R/index.html>
>>> The problem is related to one of the included examples, where I plot 
>>> the coastline
>>> on top of a raster file. In the example, where the plotting is 
>>> embedded in
>>> an S4 method called plot.DeponsRaster, the coastline does not show. 
>>> But if
>>> I run the functions that the method is composed of, everything works 
>>> fine (see
>>> below). So I am wondering if the graphics devise is not passed on 
>>> correctly
>>> within the package, or what actually happens.
>>> The example that does not run correctly is available from 
>>> ?plot.DeponsRaster:
>>> library(DEPONS2R)
>>> data("bathymetry")
>>> plot(bathymetry)
>>> data("coastline")
>>> library(rgdal)
>>> # Change projection of coastline to match that of bathymetry data
>>> coastline2 <- spTransform(coastline, crs(bathymetry))
>>> plot(coastline2, add=TRUE, col="lightyellow2")
>>> Here the coastline is not plotted. The method is defined as:
>>> setMethod("plot", signature("DeponsRaster", "ANY"),
>>> ??????????function(x, y, maxpixels=500000, col, alpha=NULL, colNA=NA, 
>>> add=FALSE,
>>> ???????????????????ext=NULL, useRaster=TRUE, interpolate=FALSE, 
>>> addfun=NULL,
>>> ???????????????????nc, nr, maxnl=16, main, npretty=0, axes=TRUE,
>>> ???????????????????legend=TRUE, trackToPlot=1, ...) ?{
>>> ????????????oldpar <- graphics::par(no.readonly = TRUE)
>>> ????????????on.exit(graphics::par(oldpar))
>>> ????????????if (missing(main)) {
>>> ??????????????main <- paste(x at landscape, x at type, sep=" - ")
>>> ????????????}
>>> ????????????# Define colours specific or 'type'
>>> ????????????if(missing(col) && x at type=="bathymetry") {
>>> ??????????????tmp.col <- grDevices::rainbow(1000)[501:800]
>>> ??????????????col <- c(tmp.col[1:100], rep(tmp.col[101:250], each=5))
>>> ????????????}
>>> ????????????# Use {raster}-package for plotting
>>> ????????????if(x at crs=="NA") {
>>> ??????????????crs2 <- sp::CRS(as.character(NA))
>>> ????????????} else {
>>> ??????????????crs2 <- sp::CRS(x at crs)
>>> ????????????}
>>> ????????????rdata <- raster::raster(x=x at data, xmn=x at ext$xleft, 
>>> xmx=x at ext$xright,
>>> ????????????????????????????????????ymn=x at ext$ybottom, ymx=x at ext$ytop,
>>> ????????????????????????????????????crs=crs2)
>>> ????????????raster::plot(rdata, col=col, main=main,
>>> ?????????????????????????alpha=alpha, add=add, ext=ext, axes=axes, 
>>> legend=legend)
>>> ??????????}
>>> )
>>> But when I use the functions that are at the core of this method it is
>>> not a problem adding the coastline correctly:
>>> x <- bathymetry
>>> crs2 <- raster::crs(x at crs)
>>> rdata <- raster::raster(x = x at data, xmn = x at ext$xleft,
>>> xmx = x at ext$xright, ymn = x at ext$ybottom, ymx = x at ext$ytop,
>>> crs = crs2)
>>> raster::plot(rdata)
>>> plot(coastline2, add=TRUE, col="lightyellow2")
>>> If would be fantastic if someone can figure out how I should modify 
>>> the method
>>> to plot the coastline correctly on top of the map.
>>
>> I'm not sure exactly what is going wrong, but if you plot the 
>> coastline first and the bathymetry second, things do show up. ?Maybe 
>> that's enough of a hint for you:
>>
>> library(DEPONS2R)
>> data("coastline")
>> library(rgdal)
>> coastline2 <- spTransform(coastline, crs(bathymetry))
>> plot(coastline2, col="lightyellow2")
>>
>> data("bathymetry")
>> plot(bathymetry, add=TRUE)
>>
>> This puts the legend on top of the plotted coastline data, so my guess 
>> is that the limits of the bathymetry plot aren't being made available 
>> to the coastline plot when you do things in the original order.
>>
>> Duncan Murdoch
>


From |eder|co@z@ngh|@11 @end|ng |rom gm@||@com  Wed Apr 14 18:11:39 2021
From: |eder|co@z@ngh|@11 @end|ng |rom gm@||@com (Federico Zanghi)
Date: Wed, 14 Apr 2021 18:11:39 +0200
Subject: [R-pkg-devel] Question "no visible binding for '<<-' assignment"
Message-ID: <CANTQg_dx-Nih4UWXzhVHdySjsXKZ_kFdc51k69V79fVxKfDY3w@mail.gmail.com>

Hi :)

I'm here because i have a problem with my package...i have the function
"SARMAX.refinement", clearly the problem is that i can't assign a variable
on global environment from a function.
So when i CHECK the package it gives me 1 Note that doesn't make me publish
the package :(

The Note is this:

* checking R code for possible problems ... [20s] NOTE
SARMAX.refinement: no visible binding for '<<-' assignment to 'xreg'


The fact is that the function
"model <- Arima(fit$data, order = arima_order,seasonal =
list(order=seasonal_order,period=period), xreg = xreg)"

works only if i define xreg on the glob.env...

I tried  using fitted(fit) instead of xreg but i cannot use predict because
the function doesn't find "fitted(fit)" or xreg (even if i define xreg only
inside the function with xreg <- fitted(fit)).

Anyone has any suggestions?
(without completely change the function or the class...i'd like to
maintain the current class to use all its functions)

Thank you,
Federico



P.S.

In order to being as clear as possible i paste the code i need to use:

arimaGGM <- SARMAX.refinement(GGM,arima_order = c(2,0,1),seasonal_order =
c(1,0,0), period=4,display = F)
predict(arimaGGM,newxreg = 1:100)

the data is also attached to the mail :)

From chr|@ho|d @end|ng |rom p@yctc@org  Wed Apr 14 18:53:10 2021
From: chr|@ho|d @end|ng |rom p@yctc@org (Chris Evans)
Date: Wed, 14 Apr 2021 17:53:10 +0100 (BST)
Subject: [R-pkg-devel] Another newbie question: vignettes not appearing in
 GitHub hosted package
Message-ID: <2073689205.1245013.1618419190285.JavaMail.zimbra@psyctc.org>

As ever, my package is https://github.com/cpsyctc/CECPfuns and I am building withing Rstudio 1.4.1103 

I am aiming for the package to have fairly comprehensive vignettes and there are four now, but two are very incomplete. 

The problem I have may relate to https://github.com/Kenkleinman/clusterPower/issues/113 and to 
https://github.com/rstudio/rstudio/issues/1766 or it may not. I have a nasty feeling that I am just looking 
straight through something obvious. 

When I run 
browseVignettes(package = "CECPfuns") 
within Rstudio working on the package I see the vignettes and I have now got pkgdown working to compile the 
lovely web site around the package (at https://cecpfuns.psyctc.org/) and I see the vignettes there and they 
update. 

The bizarre thing that is beating me is that when I pull the package down to any machine with 
remotes::install_github("cpsyctc/CECPfuns") 
gets the function but no vignettes! Here's an example from my little Pi machine: 

> remotes::install_github("cpsyctc/CECPfuns") 
Downloading GitHub repo cpsyctc/CECPfuns at HEAD 
? checking for file ?/tmp/RtmpPhD1Rg/remotes294e1d1ff9d6/cpsyctc-CECPfuns-ab23518/DESCRIPTION? (722ms) 
? preparing ?CECPfuns?: 
? checking DESCRIPTION meta-information ... 
? installing the package to process help pages 
? checking for LF line-endings in source and make files and shell scripts (13.7s) 
? checking for empty or unneeded directories 
? looking to see if a ?data/datalist? file should be added 
? building ?CECPfuns_0.0.0.9041.tar.gz? 

* installing *source* package ?CECPfuns? ... 
** using staged installation 
** R 
** inst 
** byte-compile and prepare package for lazy loading 
** help 
*** installing help indices 
** building package indices 
** installing vignettes 
** testing if installed package can be loaded from temporary location 
** testing if installed package can be loaded from final location 
** testing if installed package keeps a record of temporary installation path 
* DONE (CECPfuns) 
> browseVignettes(package = "CECPfuns") 
No vignettes found by browseVignettes(package = "CECPfuns") 

I hope someone can see what I'm doing wrong! As ever, TIA, 

Chris 

-- 
Chris Evans (he/him) <chris at psyctc.org> Visiting Professor, University of Sheffield <chris.evans at sheffield.ac.uk> 
I do some consultation work for the University of Roehampton <chris.evans at roehampton.ac.uk> and other places 
but <chris at psyctc.org> remains my main Email address. I have a work web site at: 
https://www.psyctc.org/psyctc/ 
and a site I manage for CORE and CORE system trust at: 
http://www.coresystemtrust.org.uk/ 
I have "semigrated" to France, see: 
https://www.psyctc.org/pelerinage2016/semigrating-to-france/ 
https://www.psyctc.org/pelerinage2016/register-to-get-updates-from-pelerinage2016/ 

If you want an Emeeting, I am trying to keep them to Thursdays and my diary is at: 
https://www.psyctc.org/pelerinage2016/ceworkdiary/ 
Beware: French time, generally an hour ahead of UK. 


From zk@mv@r @end|ng |rom gm@||@com  Wed Apr 14 18:57:11 2021
From: zk@mv@r @end|ng |rom gm@||@com (Zhian N. Kamvar)
Date: Wed, 14 Apr 2021 09:57:11 -0700
Subject: [R-pkg-devel] 
 Another newbie question: vignettes not appearing in
 GitHub hosted package
In-Reply-To: <2073689205.1245013.1618419190285.JavaMail.zimbra@psyctc.org>
References: <2073689205.1245013.1618419190285.JavaMail.zimbra@psyctc.org>
Message-ID: <35b1d60b-89a9-cec0-6675-f4407ff40a92@gmail.com>

Hi Chris,

You need to add the `build_vignettes = TRUE` argument to `install_github()`.

On 4/14/21 9:53 AM, Chris Evans wrote:
> As ever, my package is https://github.com/cpsyctc/CECPfuns and I am building withing Rstudio 1.4.1103
>
> I am aiming for the package to have fairly comprehensive vignettes and there are four now, but two are very incomplete.
>
> The problem I have may relate to https://github.com/Kenkleinman/clusterPower/issues/113 and to
> https://github.com/rstudio/rstudio/issues/1766 or it may not. I have a nasty feeling that I am just looking
> straight through something obvious.
>
> When I run
> browseVignettes(package = "CECPfuns")
> within Rstudio working on the package I see the vignettes and I have now got pkgdown working to compile the
> lovely web site around the package (at https://cecpfuns.psyctc.org/) and I see the vignettes there and they
> update.
>
> The bizarre thing that is beating me is that when I pull the package down to any machine with
> remotes::install_github("cpsyctc/CECPfuns")
> gets the function but no vignettes! Here's an example from my little Pi machine:
>
>> remotes::install_github("cpsyctc/CECPfuns")
> Downloading GitHub repo cpsyctc/CECPfuns at HEAD
> ? checking for file ?/tmp/RtmpPhD1Rg/remotes294e1d1ff9d6/cpsyctc-CECPfuns-ab23518/DESCRIPTION? (722ms)
> ? preparing ?CECPfuns?:
> ? checking DESCRIPTION meta-information ...
> ? installing the package to process help pages
> ? checking for LF line-endings in source and make files and shell scripts (13.7s)
> ? checking for empty or unneeded directories
> ? looking to see if a ?data/datalist? file should be added
> ? building ?CECPfuns_0.0.0.9041.tar.gz?
>
> * installing *source* package ?CECPfuns? ...
> ** using staged installation
> ** R
> ** inst
> ** byte-compile and prepare package for lazy loading
> ** help
> *** installing help indices
> ** building package indices
> ** installing vignettes
> ** testing if installed package can be loaded from temporary location
> ** testing if installed package can be loaded from final location
> ** testing if installed package keeps a record of temporary installation path
> * DONE (CECPfuns)
>> browseVignettes(package = "CECPfuns")
> No vignettes found by browseVignettes(package = "CECPfuns")
>
> I hope someone can see what I'm doing wrong! As ever, TIA,
>
> Chris
>


From c@@rd|@g@bor @end|ng |rom gm@||@com  Wed Apr 14 18:57:03 2021
From: c@@rd|@g@bor @end|ng |rom gm@||@com (=?UTF-8?B?R8OhYm9yIENzw6FyZGk=?=)
Date: Wed, 14 Apr 2021 18:57:03 +0200
Subject: [R-pkg-devel] 
 Another newbie question: vignettes not appearing in
 GitHub hosted package
In-Reply-To: <2073689205.1245013.1618419190285.JavaMail.zimbra@psyctc.org>
References: <2073689205.1245013.1618419190285.JavaMail.zimbra@psyctc.org>
Message-ID: <CABtg=KnP9-jAdcBVtdZAFO1x4z9fE9SqYDazDfvkNi54Qij3bw@mail.gmail.com>

remotes::install_github() does not build the vignettes by default, you
can use the build_opts argument to change this.

Gabor

On Wed, Apr 14, 2021 at 6:53 PM Chris Evans <chrishold at psyctc.org> wrote:
>
> As ever, my package is https://github.com/cpsyctc/CECPfuns and I am building withing Rstudio 1.4.1103
>
> I am aiming for the package to have fairly comprehensive vignettes and there are four now, but two are very incomplete.
>
> The problem I have may relate to https://github.com/Kenkleinman/clusterPower/issues/113 and to
> https://github.com/rstudio/rstudio/issues/1766 or it may not. I have a nasty feeling that I am just looking
> straight through something obvious.
>
> When I run
> browseVignettes(package = "CECPfuns")
> within Rstudio working on the package I see the vignettes and I have now got pkgdown working to compile the
> lovely web site around the package (at https://cecpfuns.psyctc.org/) and I see the vignettes there and they
> update.
>
> The bizarre thing that is beating me is that when I pull the package down to any machine with
> remotes::install_github("cpsyctc/CECPfuns")
> gets the function but no vignettes! Here's an example from my little Pi machine:
>
> > remotes::install_github("cpsyctc/CECPfuns")
> Downloading GitHub repo cpsyctc/CECPfuns at HEAD
> ? checking for file ?/tmp/RtmpPhD1Rg/remotes294e1d1ff9d6/cpsyctc-CECPfuns-ab23518/DESCRIPTION? (722ms)
> ? preparing ?CECPfuns?:
> ? checking DESCRIPTION meta-information ...
> ? installing the package to process help pages
> ? checking for LF line-endings in source and make files and shell scripts (13.7s)
> ? checking for empty or unneeded directories
> ? looking to see if a ?data/datalist? file should be added
> ? building ?CECPfuns_0.0.0.9041.tar.gz?
>
> * installing *source* package ?CECPfuns? ...
> ** using staged installation
> ** R
> ** inst
> ** byte-compile and prepare package for lazy loading
> ** help
> *** installing help indices
> ** building package indices
> ** installing vignettes
> ** testing if installed package can be loaded from temporary location
> ** testing if installed package can be loaded from final location
> ** testing if installed package keeps a record of temporary installation path
> * DONE (CECPfuns)
> > browseVignettes(package = "CECPfuns")
> No vignettes found by browseVignettes(package = "CECPfuns")
>
> I hope someone can see what I'm doing wrong! As ever, TIA,
>
> Chris
>
> --
> Chris Evans (he/him) <chris at psyctc.org> Visiting Professor, University of Sheffield <chris.evans at sheffield.ac.uk>
> I do some consultation work for the University of Roehampton <chris.evans at roehampton.ac.uk> and other places
> but <chris at psyctc.org> remains my main Email address. I have a work web site at:
> https://www.psyctc.org/psyctc/
> and a site I manage for CORE and CORE system trust at:
> http://www.coresystemtrust.org.uk/
> I have "semigrated" to France, see:
> https://www.psyctc.org/pelerinage2016/semigrating-to-france/
> https://www.psyctc.org/pelerinage2016/register-to-get-updates-from-pelerinage2016/
>
> If you want an Emeeting, I am trying to keep them to Thursdays and my diary is at:
> https://www.psyctc.org/pelerinage2016/ceworkdiary/
> Beware: French time, generally an hour ahead of UK.
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From chr|@ho|d @end|ng |rom p@yctc@org  Wed Apr 14 20:17:02 2021
From: chr|@ho|d @end|ng |rom p@yctc@org (Chris Evans)
Date: Wed, 14 Apr 2021 19:17:02 +0100 (BST)
Subject: [R-pkg-devel] 
 Another newbie question: vignettes not appearing in
 GitHub hosted package
In-Reply-To: <35b1d60b-89a9-cec0-6675-f4407ff40a92@gmail.com>
References: <2073689205.1245013.1618419190285.JavaMail.zimbra@psyctc.org>
 <35b1d60b-89a9-cec0-6675-f4407ff40a92@gmail.com>
Message-ID: <303534426.1302005.1618424222330.JavaMail.zimbra@psyctc.org>

Oh no, how embarrassing!  

But in my defence, am I the only one who thinks having build_vignettes = FALSE as default is a bit anti-vignettes?!

Many thanks both, 

Chris

----- Original Message -----
> From: "Zhian N. Kamvar" <zkamvar at gmail.com>
> To: "r-package-devel" <r-package-devel at r-project.org>
> Sent: Wednesday, 14 April, 2021 17:57:11
> Subject: Re: [R-pkg-devel] Another newbie question: vignettes not appearing in GitHub hosted package

> Hi Chris,
> 
> You need to add the `build_vignettes = TRUE` argument to `install_github()`.
> 
> On 4/14/21 9:53 AM, Chris Evans wrote:
>> As ever, my package is https://github.com/cpsyctc/CECPfuns and I am building
>> withing Rstudio 1.4.1103
>>
>> I am aiming for the package to have fairly comprehensive vignettes and there are
>> four now, but two are very incomplete.
>>
>> The problem I have may relate to
>> https://github.com/Kenkleinman/clusterPower/issues/113 and to
>> https://github.com/rstudio/rstudio/issues/1766 or it may not. I have a nasty
>> feeling that I am just looking
>> straight through something obvious.
>>
>> When I run
>> browseVignettes(package = "CECPfuns")
>> within Rstudio working on the package I see the vignettes and I have now got
>> pkgdown working to compile the
>> lovely web site around the package (at https://cecpfuns.psyctc.org/) and I see
>> the vignettes there and they
>> update.
>>
>> The bizarre thing that is beating me is that when I pull the package down to any
>> machine with
>> remotes::install_github("cpsyctc/CECPfuns")
>> gets the function but no vignettes! Here's an example from my little Pi machine:
>>
>>> remotes::install_github("cpsyctc/CECPfuns")
>> Downloading GitHub repo cpsyctc/CECPfuns at HEAD
>> ? checking for file
>> ?/tmp/RtmpPhD1Rg/remotes294e1d1ff9d6/cpsyctc-CECPfuns-ab23518/DESCRIPTION?
>> (722ms)
>> ? preparing ?CECPfuns?:
>> ? checking DESCRIPTION meta-information ...
>> ? installing the package to process help pages
>> ? checking for LF line-endings in source and make files and shell scripts
>> (13.7s)
>> ? checking for empty or unneeded directories
>> ? looking to see if a ?data/datalist? file should be added
>> ? building ?CECPfuns_0.0.0.9041.tar.gz?
>>
>> * installing *source* package ?CECPfuns? ...
>> ** using staged installation
>> ** R
>> ** inst
>> ** byte-compile and prepare package for lazy loading
>> ** help
>> *** installing help indices
>> ** building package indices
>> ** installing vignettes
>> ** testing if installed package can be loaded from temporary location
>> ** testing if installed package can be loaded from final location
>> ** testing if installed package keeps a record of temporary installation path
>> * DONE (CECPfuns)
>>> browseVignettes(package = "CECPfuns")
>> No vignettes found by browseVignettes(package = "CECPfuns")
>>
>> I hope someone can see what I'm doing wrong! As ever, TIA,
>>
>> Chris
>>
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel

-- 
Chris Evans (he/him) <chris at psyctc.org> Visiting Professor, University of Sheffield <chris.evans at sheffield.ac.uk>
I do some consultation work for the University of Roehampton <chris.evans at roehampton.ac.uk> and other places
but <chris at psyctc.org> remains my main Email address.  I have a work web site at:
   https://www.psyctc.org/psyctc/
and a site I manage for CORE and CORE system trust at:
   http://www.coresystemtrust.org.uk/
I have "semigrated" to France, see: 
   https://www.psyctc.org/pelerinage2016/semigrating-to-france/ 
   https://www.psyctc.org/pelerinage2016/register-to-get-updates-from-pelerinage2016/

If you want an Emeeting, I am trying to keep them to Thursdays and my diary is at:
   https://www.psyctc.org/pelerinage2016/ceworkdiary/
Beware: French time, generally an hour ahead of UK.


From c@@rd|@g@bor @end|ng |rom gm@||@com  Wed Apr 14 20:40:39 2021
From: c@@rd|@g@bor @end|ng |rom gm@||@com (=?UTF-8?B?R8OhYm9yIENzw6FyZGk=?=)
Date: Wed, 14 Apr 2021 20:40:39 +0200
Subject: [R-pkg-devel] 
 Another newbie question: vignettes not appearing in
 GitHub hosted package
In-Reply-To: <303534426.1302005.1618424222330.JavaMail.zimbra@psyctc.org>
References: <2073689205.1245013.1618419190285.JavaMail.zimbra@psyctc.org>
 <35b1d60b-89a9-cec0-6675-f4407ff40a92@gmail.com>
 <303534426.1302005.1618424222330.JavaMail.zimbra@psyctc.org>
Message-ID: <CABtg=K=91aR1pDhhTsfqK_Vu1VSUe658QnFSmcMg71WCoOAq8Q@mail.gmail.com>

remotes::install_github() is a function aimed at developers that need
the unreleased version of a package for testing or other dev purposes.
In these cases you don't usually need the vignettes. hence the
default.

Gabor

On Wed, Apr 14, 2021 at 8:17 PM Chris Evans <chrishold at psyctc.org> wrote:
>
> Oh no, how embarrassing!
>
> But in my defence, am I the only one who thinks having build_vignettes = FALSE as default is a bit anti-vignettes?!
>
> Many thanks both,
>
> Chris
>
> ----- Original Message -----
> > From: "Zhian N. Kamvar" <zkamvar at gmail.com>
> > To: "r-package-devel" <r-package-devel at r-project.org>
> > Sent: Wednesday, 14 April, 2021 17:57:11
> > Subject: Re: [R-pkg-devel] Another newbie question: vignettes not appearing in GitHub hosted package
>
> > Hi Chris,
> >
> > You need to add the `build_vignettes = TRUE` argument to `install_github()`.
> >
> > On 4/14/21 9:53 AM, Chris Evans wrote:
> >> As ever, my package is https://github.com/cpsyctc/CECPfuns and I am building
> >> withing Rstudio 1.4.1103
> >>
> >> I am aiming for the package to have fairly comprehensive vignettes and there are
> >> four now, but two are very incomplete.
> >>
> >> The problem I have may relate to
> >> https://github.com/Kenkleinman/clusterPower/issues/113 and to
> >> https://github.com/rstudio/rstudio/issues/1766 or it may not. I have a nasty
> >> feeling that I am just looking
> >> straight through something obvious.
> >>
> >> When I run
> >> browseVignettes(package = "CECPfuns")
> >> within Rstudio working on the package I see the vignettes and I have now got
> >> pkgdown working to compile the
> >> lovely web site around the package (at https://cecpfuns.psyctc.org/) and I see
> >> the vignettes there and they
> >> update.
> >>
> >> The bizarre thing that is beating me is that when I pull the package down to any
> >> machine with
> >> remotes::install_github("cpsyctc/CECPfuns")
> >> gets the function but no vignettes! Here's an example from my little Pi machine:
> >>
> >>> remotes::install_github("cpsyctc/CECPfuns")
> >> Downloading GitHub repo cpsyctc/CECPfuns at HEAD
> >> ? checking for file
> >> ?/tmp/RtmpPhD1Rg/remotes294e1d1ff9d6/cpsyctc-CECPfuns-ab23518/DESCRIPTION?
> >> (722ms)
> >> ? preparing ?CECPfuns?:
> >> ? checking DESCRIPTION meta-information ...
> >> ? installing the package to process help pages
> >> ? checking for LF line-endings in source and make files and shell scripts
> >> (13.7s)
> >> ? checking for empty or unneeded directories
> >> ? looking to see if a ?data/datalist? file should be added
> >> ? building ?CECPfuns_0.0.0.9041.tar.gz?
> >>
> >> * installing *source* package ?CECPfuns? ...
> >> ** using staged installation
> >> ** R
> >> ** inst
> >> ** byte-compile and prepare package for lazy loading
> >> ** help
> >> *** installing help indices
> >> ** building package indices
> >> ** installing vignettes
> >> ** testing if installed package can be loaded from temporary location
> >> ** testing if installed package can be loaded from final location
> >> ** testing if installed package keeps a record of temporary installation path
> >> * DONE (CECPfuns)
> >>> browseVignettes(package = "CECPfuns")
> >> No vignettes found by browseVignettes(package = "CECPfuns")
> >>
> >> I hope someone can see what I'm doing wrong! As ever, TIA,
> >>
> >> Chris
> >>
> >
> > ______________________________________________
> > R-package-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-package-devel
>
> --
> Chris Evans (he/him) <chris at psyctc.org> Visiting Professor, University of Sheffield <chris.evans at sheffield.ac.uk>
> I do some consultation work for the University of Roehampton <chris.evans at roehampton.ac.uk> and other places
> but <chris at psyctc.org> remains my main Email address.  I have a work web site at:
>    https://www.psyctc.org/psyctc/
> and a site I manage for CORE and CORE system trust at:
>    http://www.coresystemtrust.org.uk/
> I have "semigrated" to France, see:
>    https://www.psyctc.org/pelerinage2016/semigrating-to-france/
>    https://www.psyctc.org/pelerinage2016/register-to-get-updates-from-pelerinage2016/
>
> If you want an Emeeting, I am trying to keep them to Thursdays and my diary is at:
>    https://www.psyctc.org/pelerinage2016/ceworkdiary/
> Beware: French time, generally an hour ahead of UK.
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From murdoch@dunc@n @end|ng |rom gm@||@com  Thu Apr 15 00:07:43 2021
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Wed, 14 Apr 2021 18:07:43 -0400
Subject: [R-pkg-devel] 
 Question "no visible binding for '<<-' assignment"
In-Reply-To: <CANTQg_dx-Nih4UWXzhVHdySjsXKZ_kFdc51k69V79fVxKfDY3w@mail.gmail.com>
References: <CANTQg_dx-Nih4UWXzhVHdySjsXKZ_kFdc51k69V79fVxKfDY3w@mail.gmail.com>
Message-ID: <7b5e671d-9c87-c736-dc3d-dc0f4378f411@gmail.com>

On 14/04/2021 12:11 p.m., Federico Zanghi wrote:
> Hi :)
> 
> I'm here because i have a problem with my package...i have the function
> "SARMAX.refinement", clearly the problem is that i can't assign a variable
> on global environment from a function.
> So when i CHECK the package it gives me 1 Note that doesn't make me publish
> the package :(
> 
> The Note is this:
> 
> * checking R code for possible problems ... [20s] NOTE
> SARMAX.refinement: no visible binding for '<<-' assignment to 'xreg'
> 
> 
> The fact is that the function
> "model <- Arima(fit$data, order = arima_order,seasonal =
> list(order=seasonal_order,period=period), xreg = xreg)"
> 
> works only if i define xreg on the glob.env...

Then something is broken.  You need to change things: packages shouldn't 
be writing directly to the global environment.

I don't know the Arima function, but it's where I'd start looking.
> 
> I tried  using fitted(fit) instead of xreg but i cannot use predict because
> the function doesn't find "fitted(fit)" or xreg (even if i define xreg only
> inside the function with xreg <- fitted(fit)).
> 
> Anyone has any suggestions?
> (without completely change the function or the class...i'd like to
> maintain the current class to use all its functions)

Scoping for modelling functions is quite tricky.  The standard rules are 
that model variables are looked for in the data argument first, then the 
environment of the model formula.  "Model variables" include those 
referenced in the model formula, but also some others.


> P.S.
> 
> In order to being as clear as possible i paste the code i need to use:
> 
> arimaGGM <- SARMAX.refinement(GGM,arima_order = c(2,0,1),seasonal_order =
> c(1,0,0), period=4,display = F)
> predict(arimaGGM,newxreg = 1:100)
> 
> the data is also attached to the mail :)

No, it wasn't.  If you want more specific help, you should include a 
self-contained example in the text of your message.

Duncan Murdoch


From georg|@bo@hn@kov @end|ng |rom m@nche@ter@@c@uk  Thu Apr 15 11:11:27 2021
From: georg|@bo@hn@kov @end|ng |rom m@nche@ter@@c@uk (Georgi Boshnakov)
Date: Thu, 15 Apr 2021 09:11:27 +0000
Subject: [R-pkg-devel] 
 Another newbie question: vignettes not appearing in
 GitHub hosted package
In-Reply-To: <2073689205.1245013.1618419190285.JavaMail.zimbra@psyctc.org>
References: <2073689205.1245013.1618419190285.JavaMail.zimbra@psyctc.org>
Message-ID: <CWXP265MB20082BC416C43418F094F23AAE4D9@CWXP265MB2008.GBRP265.PROD.OUTLOOK.COM>

Vignettes are not built by default when using remotes::install_github, request it explicitly:

remotes::install_github("cpsyctc/CECPfuns", build_vignettes = TRUE)

Georgi Boshnakov


-----Original Message-----
From: R-package-devel <r-package-devel-bounces at r-project.org> On Behalf Of Chris Evans
Sent: 14 April 2021 17:53
To: r-package-devel <r-package-devel at r-project.org>
Subject: [R-pkg-devel] Another newbie question: vignettes not appearing in GitHub hosted package

As ever, my package is https://github.com/cpsyctc/CECPfuns and I am building withing Rstudio 1.4.1103 

I am aiming for the package to have fairly comprehensive vignettes and there are four now, but two are very incomplete. 

The problem I have may relate to https://github.com/Kenkleinman/clusterPower/issues/113 and to
https://github.com/rstudio/rstudio/issues/1766 or it may not. I have a nasty feeling that I am just looking straight through something obvious. 

When I run
browseVignettes(package = "CECPfuns")
within Rstudio working on the package I see the vignettes and I have now got pkgdown working to compile the lovely web site around the package (at https://cecpfuns.psyctc.org/) and I see the vignettes there and they update. 

The bizarre thing that is beating me is that when I pull the package down to any machine with
remotes::install_github("cpsyctc/CECPfuns")
gets the function but no vignettes! Here's an example from my little Pi machine: 

> remotes::install_github("cpsyctc/CECPfuns")
Downloading GitHub repo cpsyctc/CECPfuns at HEAD ? checking for file ?/tmp/RtmpPhD1Rg/remotes294e1d1ff9d6/cpsyctc-CECPfuns-ab23518/DESCRIPTION? (722ms) ? preparing ?CECPfuns?: 
? checking DESCRIPTION meta-information ... 
? installing the package to process help pages ? checking for LF line-endings in source and make files and shell scripts (13.7s) ? checking for empty or unneeded directories ? looking to see if a ?data/datalist? file should be added ? building ?CECPfuns_0.0.0.9041.tar.gz? 

* installing *source* package ?CECPfuns? ... 
** using staged installation
** R
** inst
** byte-compile and prepare package for lazy loading
** help
*** installing help indices
** building package indices
** installing vignettes
** testing if installed package can be loaded from temporary location
** testing if installed package can be loaded from final location
** testing if installed package keeps a record of temporary installation path
* DONE (CECPfuns) 
> browseVignettes(package = "CECPfuns")
No vignettes found by browseVignettes(package = "CECPfuns") 

I hope someone can see what I'm doing wrong! As ever, TIA, 

Chris 

-- 
Chris Evans (he/him) <chris at psyctc.org> Visiting Professor, University of Sheffield <chris.evans at sheffield.ac.uk> 
I do some consultation work for the University of Roehampton <chris.evans at roehampton.ac.uk> and other places 
but <chris at psyctc.org> remains my main Email address. I have a work web site at: 
https://www.psyctc.org/psyctc/ 
and a site I manage for CORE and CORE system trust at: 
http://www.coresystemtrust.org.uk/ 
I have "semigrated" to France, see: 
https://www.psyctc.org/pelerinage2016/semigrating-to-france/ 
https://www.psyctc.org/pelerinage2016/register-to-get-updates-from-pelerinage2016/ 

If you want an Emeeting, I am trying to keep them to Thursdays and my diary is at: 
https://www.psyctc.org/pelerinage2016/ceworkdiary/ 
Beware: French time, generally an hour ahead of UK. 

______________________________________________
R-package-devel at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-package-devel

From chr|@ho|d @end|ng |rom p@yctc@org  Thu Apr 15 14:34:46 2021
From: chr|@ho|d @end|ng |rom p@yctc@org (Chris Evans)
Date: Thu, 15 Apr 2021 13:34:46 +0100 (BST)
Subject: [R-pkg-devel] 
 Another newbie question: vignettes not appearing in
 GitHub hosted package
In-Reply-To: <CABtg=K=91aR1pDhhTsfqK_Vu1VSUe658QnFSmcMg71WCoOAq8Q@mail.gmail.com>
References: <2073689205.1245013.1618419190285.JavaMail.zimbra@psyctc.org>
 <35b1d60b-89a9-cec0-6675-f4407ff40a92@gmail.com>
 <303534426.1302005.1618424222330.JavaMail.zimbra@psyctc.org>
 <CABtg=K=91aR1pDhhTsfqK_Vu1VSUe658QnFSmcMg71WCoOAq8Q@mail.gmail.com>
Message-ID: <1518231283.2235088.1618490086188.JavaMail.zimbra@psyctc.org>

Thanks G?bor, Zhian, Georgi,

Clearly I should read the help pages more carefully!  I guess I had come to see GitHub less as a developer resource
and more as a subsidiary repository for people whose packages wouldn't meet CRAN standards (hey ho, perhaps one day!)
So I had assumed that when you install from there you get everything: clearly not the case and now I do see the logic.

Thanks to all. This list is wonderful!!

Chris

----- Original Message -----
> From: "G?bor Cs?rdi" <csardi.gabor at gmail.com>
> To: "Chris Evans" <chrishold at psyctc.org>
> Cc: "Zhian N. Kamvar" <zkamvar at gmail.com>, "r-package-devel" <r-package-devel at r-project.org>
> Sent: Wednesday, 14 April, 2021 19:40:39
> Subject: Re: [R-pkg-devel] Another newbie question: vignettes not appearing in GitHub hosted package

> remotes::install_github() is a function aimed at developers that need
> the unreleased version of a package for testing or other dev purposes.
> In these cases you don't usually need the vignettes. hence the
> default.
> 
> Gabor
> 
> On Wed, Apr 14, 2021 at 8:17 PM Chris Evans <chrishold at psyctc.org> wrote:
>>
>> Oh no, how embarrassing!
>>
>> But in my defence, am I the only one who thinks having build_vignettes = FALSE
>> as default is a bit anti-vignettes?!
>>
>> Many thanks both,
>>
>> Chris
>>
>> ----- Original Message -----
>> > From: "Zhian N. Kamvar" <zkamvar at gmail.com>
>> > To: "r-package-devel" <r-package-devel at r-project.org>
>> > Sent: Wednesday, 14 April, 2021 17:57:11
>> > Subject: Re: [R-pkg-devel] Another newbie question: vignettes not appearing in
>> > GitHub hosted package
>>
>> > Hi Chris,
>> >
>> > You need to add the `build_vignettes = TRUE` argument to `install_github()`.
>> >
>> > On 4/14/21 9:53 AM, Chris Evans wrote:
>> >> As ever, my package is https://github.com/cpsyctc/CECPfuns and I am building
>> >> withing Rstudio 1.4.1103
>> >>
>> >> I am aiming for the package to have fairly comprehensive vignettes and there are
>> >> four now, but two are very incomplete.
>> >>
>> >> The problem I have may relate to
>> >> https://github.com/Kenkleinman/clusterPower/issues/113 and to
>> >> https://github.com/rstudio/rstudio/issues/1766 or it may not. I have a nasty
>> >> feeling that I am just looking
>> >> straight through something obvious.
>> >>
>> >> When I run
>> >> browseVignettes(package = "CECPfuns")
>> >> within Rstudio working on the package I see the vignettes and I have now got
>> >> pkgdown working to compile the
>> >> lovely web site around the package (at https://cecpfuns.psyctc.org/) and I see
>> >> the vignettes there and they
>> >> update.
>> >>
>> >> The bizarre thing that is beating me is that when I pull the package down to any
>> >> machine with
>> >> remotes::install_github("cpsyctc/CECPfuns")
>> >> gets the function but no vignettes! Here's an example from my little Pi machine:
>> >>
>> >>> remotes::install_github("cpsyctc/CECPfuns")
>> >> Downloading GitHub repo cpsyctc/CECPfuns at HEAD
>> >> ? checking for file
>> >> ?/tmp/RtmpPhD1Rg/remotes294e1d1ff9d6/cpsyctc-CECPfuns-ab23518/DESCRIPTION?
>> >> (722ms)
>> >> ? preparing ?CECPfuns?:
>> >> ? checking DESCRIPTION meta-information ...
>> >> ? installing the package to process help pages
>> >> ? checking for LF line-endings in source and make files and shell scripts
>> >> (13.7s)
>> >> ? checking for empty or unneeded directories
>> >> ? looking to see if a ?data/datalist? file should be added
>> >> ? building ?CECPfuns_0.0.0.9041.tar.gz?
>> >>
>> >> * installing *source* package ?CECPfuns? ...
>> >> ** using staged installation
>> >> ** R
>> >> ** inst
>> >> ** byte-compile and prepare package for lazy loading
>> >> ** help
>> >> *** installing help indices
>> >> ** building package indices
>> >> ** installing vignettes
>> >> ** testing if installed package can be loaded from temporary location
>> >> ** testing if installed package can be loaded from final location
>> >> ** testing if installed package keeps a record of temporary installation path
>> >> * DONE (CECPfuns)
>> >>> browseVignettes(package = "CECPfuns")
>> >> No vignettes found by browseVignettes(package = "CECPfuns")
>> >>
>> >> I hope someone can see what I'm doing wrong! As ever, TIA,
>> >>
>> >> Chris
>> >>
>> >
>> > ______________________________________________
>> > R-package-devel at r-project.org mailing list
>> > https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>
>> --
>> Chris Evans (he/him) <chris at psyctc.org> Visiting Professor, University of
>> Sheffield <chris.evans at sheffield.ac.uk>
>> I do some consultation work for the University of Roehampton
>> <chris.evans at roehampton.ac.uk> and other places
>> but <chris at psyctc.org> remains my main Email address.  I have a work web site
>> at:
>>    https://www.psyctc.org/psyctc/
>> and a site I manage for CORE and CORE system trust at:
>>    http://www.coresystemtrust.org.uk/
>> I have "semigrated" to France, see:
>>    https://www.psyctc.org/pelerinage2016/semigrating-to-france/
>>    https://www.psyctc.org/pelerinage2016/register-to-get-updates-from-pelerinage2016/
>>
>> If you want an Emeeting, I am trying to keep them to Thursdays and my diary is
>> at:
>>    https://www.psyctc.org/pelerinage2016/ceworkdiary/
>> Beware: French time, generally an hour ahead of UK.
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-package-devel

-- 
Chris Evans (he/him) <chris at psyctc.org> Visiting Professor, University of Sheffield <chris.evans at sheffield.ac.uk>
I do some consultation work for the University of Roehampton <chris.evans at roehampton.ac.uk> and other places
but <chris at psyctc.org> remains my main Email address.  I have a work web site at:
   https://www.psyctc.org/psyctc/
and a site I manage for CORE and CORE system trust at:
   http://www.coresystemtrust.org.uk/
I have "semigrated" to France, see: 
   https://www.psyctc.org/pelerinage2016/semigrating-to-france/ 
   https://www.psyctc.org/pelerinage2016/register-to-get-updates-from-pelerinage2016/

If you want an Emeeting, I am trying to keep them to Thursdays and my diary is at:
   https://www.psyctc.org/pelerinage2016/ceworkdiary/
Beware: French time, generally an hour ahead of UK.


From murdoch@dunc@n @end|ng |rom gm@||@com  Fri Apr 16 12:08:58 2021
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Fri, 16 Apr 2021 06:08:58 -0400
Subject: [R-pkg-devel] Problems with too much testing
Message-ID: <1df17415-0a48-a1a2-6498-6af12419f346@gmail.com>

I'm updating the rgl package, and have come across the following problem.

Some packages that depend on rgl and do careful testing are detecting 
inconsequential changes.  A typical case is the nat package, which has 
extensive testing, some of which comes down to checking results from rgl 
functions using testthat::is_equal().  I rewrote some parts of the rgl 
code, and so some rgl objects differ in irrelevant ways.  For example,

   obj <- list(x = NULL)

differs from

   obj <- list()
   obj[["x"]] <- NULL

(the first is length 1, the second ends up with no entries).  All tests 
in rgl would be like

   if (is.null(obj[["x"]])) ...

so the tests evaluate the same, but testthat::is_equal() doesn't return 
TRUE, because the objects are different.

Another example would be

   obj <- list()
   obj$a <- 1
   obj$b <- 2

which differs from

   obj <- list()
   obj$b <- 2
   obj$a <- 1

in the order of the components, but since rgl always accessed them by 
name, that makes no difference.

So what I'm looking for is a strategy to hide internal implementation 
details.  (I'm using a compare_proxy() method now which standardizes the 
objects, but that seems very specific to testthat version 3.  I'd like 
ideas for something more robust.)

Duncan Murdoch


From brod|e@g@@|@m @end|ng |rom y@hoo@com  Fri Apr 16 13:40:32 2021
From: brod|e@g@@|@m @end|ng |rom y@hoo@com (brodie gaslam)
Date: Fri, 16 Apr 2021 11:40:32 +0000 (UTC)
Subject: [R-pkg-devel] Problems with too much testing
In-Reply-To: <1df17415-0a48-a1a2-6498-6af12419f346@gmail.com>
References: <1df17415-0a48-a1a2-6498-6af12419f346@gmail.com>
Message-ID: <2084128630.2944994.1618573232348@mail.yahoo.com>

An all.equal method?? This might not work with 3rd edition though
(untested), and I'm not sure what method registration requirements
would exist for the user.

Best,

B.

On Friday, April 16, 2021, 6:09:24 AM EDT, Duncan Murdoch <murdoch.duncan at gmail.com> wrote: 





I'm updating the rgl package, and have come across the following problem.

Some packages that depend on rgl and do careful testing are detecting 
inconsequential changes.? A typical case is the nat package, which has 
extensive testing, some of which comes down to checking results from rgl 
functions using testthat::is_equal().? I rewrote some parts of the rgl 
code, and so some rgl objects differ in irrelevant ways.? For example,

? obj <- list(x = NULL)

differs from

? obj <- list()
? obj[["x"]] <- NULL

(the first is length 1, the second ends up with no entries).? All tests 
in rgl would be like

? if (is.null(obj[["x"]])) ...

so the tests evaluate the same, but testthat::is_equal() doesn't return 
TRUE, because the objects are different.

Another example would be

? obj <- list()
? obj$a <- 1
? obj$b <- 2

which differs from

? obj <- list()
? obj$b <- 2
? obj$a <- 1

in the order of the components, but since rgl always accessed them by 
name, that makes no difference.

So what I'm looking for is a strategy to hide internal implementation 
details.? (I'm using a compare_proxy() method now which standardizes the 
objects, but that seems very specific to testthat version 3.? I'd like 
ideas for something more robust.)

Duncan Murdoch

______________________________________________
R-package-devel at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-package-devel


From @ntguz06 @end|ng |rom gm@||@com  Thu Apr 15 18:05:39 2021
From: @ntguz06 @end|ng |rom gm@||@com (=?UTF-8?B?Si4gQW50b25pbyBHdXptw6FuIFEu?=)
Date: Thu, 15 Apr 2021 10:05:39 -0600
Subject: [R-pkg-devel] gcc-ASAN issue
Message-ID: <CAF4cKStcm42=Mz+hCj-KOLLXFeo62MtAgKPfkag_cAjrkXkuLQ@mail.gmail.com>

Hello,

We publish in CRAN our package rTLS [1]. The package passed the test
without problems. However, at some point, additional testing suggests that
it has issues with 'gcc-ASAN' [2]. For me this error is not informative,
and thus, I do not have an idea how to start. I have been looking for
guides or help on the web and unsure of this issue's reason or meaning. It
is not clear to me what to do based on Writing R Extensions in section
4.3.3.

When I see the log files [2], the issue seems to be located in a specific
function. However, not sure why this is in a specific function since the
based code is also shared with other functions.

Can you guide me or help me with this? I know that my message is not so
informative, but I do not know how to start to ask about this issue. Here
is the code development repository for this package [3].
Antonio,

[1]
https://cran-archive.r-project.org/web/checks/2021/2021-03-30_check_results_rTLS.html
[2] https://www.stats.ox.ac.uk/pub/bdr/memtests/gcc-ASAN/rTLS/00check.log
[3] https://github.com/Antguz/rTLS

-- 
_______________________
J. Antonio Guzm?n Q., Ph.D.
Alberta Centre for Earth Observation Sciences
University of Alberta, Canada
jaguzmanq.com
Look my work in Google Scholar
<https://scholar.google.es/citations?user=Ev3ofxwAAAAJ&hl=es> and/or
ResearchGate <https://www.researchgate.net/profile/J_Antonio_Guzman_Q>

	[[alternative HTML version deleted]]


From hugh@p@r@on@ge @end|ng |rom gm@||@com  Fri Apr 16 13:54:31 2021
From: hugh@p@r@on@ge @end|ng |rom gm@||@com (Hugh Parsonage)
Date: Fri, 16 Apr 2021 21:54:31 +1000
Subject: [R-pkg-devel] Problems with too much testing
In-Reply-To: <1df17415-0a48-a1a2-6498-6af12419f346@gmail.com>
References: <1df17415-0a48-a1a2-6498-6af12419f346@gmail.com>
Message-ID: <CAJmOi+MSZhvEaCRKgxCMYLp6syBcLW8KdAoxKPK+eFhm6Fkhiw@mail.gmail.com>

My 2c is that if a package has actually tested something like that
(say, the ordering of a list's elements), then it is 100% likely that
a script out there depends on that behaviour too.  In other words, the
change is not inconsequential.  R users are in debt to package
developers but I think it behoves us to take special care not to
underestimate the work involved when a package's behaviour changes.

On Fri, 16 Apr 2021 at 20:09, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
>
> I'm updating the rgl package, and have come across the following problem.
>
> Some packages that depend on rgl and do careful testing are detecting
> inconsequential changes.  A typical case is the nat package, which has
> extensive testing, some of which comes down to checking results from rgl
> functions using testthat::is_equal().  I rewrote some parts of the rgl
> code, and so some rgl objects differ in irrelevant ways.  For example,
>
>    obj <- list(x = NULL)
>
> differs from
>
>    obj <- list()
>    obj[["x"]] <- NULL
>
> (the first is length 1, the second ends up with no entries).  All tests
> in rgl would be like
>
>    if (is.null(obj[["x"]])) ...
>
> so the tests evaluate the same, but testthat::is_equal() doesn't return
> TRUE, because the objects are different.
>
> Another example would be
>
>    obj <- list()
>    obj$a <- 1
>    obj$b <- 2
>
> which differs from
>
>    obj <- list()
>    obj$b <- 2
>    obj$a <- 1
>
> in the order of the components, but since rgl always accessed them by
> name, that makes no difference.
>
> So what I'm looking for is a strategy to hide internal implementation
> details.  (I'm using a compare_proxy() method now which standardizes the
> objects, but that seems very specific to testthat version 3.  I'd like
> ideas for something more robust.)
>
> Duncan Murdoch
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From murdoch@dunc@n @end|ng |rom gm@||@com  Fri Apr 16 14:00:43 2021
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Fri, 16 Apr 2021 08:00:43 -0400
Subject: [R-pkg-devel] Problems with too much testing
In-Reply-To: <2084128630.2944994.1618573232348@mail.yahoo.com>
References: <1df17415-0a48-a1a2-6498-6af12419f346@gmail.com>
 <2084128630.2944994.1618573232348@mail.yahoo.com>
Message-ID: <9b265292-19eb-7d9d-10f1-a162797fda63@gmail.com>

On 16/04/2021 7:40 a.m., brodie gaslam wrote:
> An all.equal method?? This might not work with 3rd edition though
> (untested), and I'm not sure what method registration requirements
> would exist for the user.

It already has one, but it isn't used by testthat 3.

Duncan Murdoch


From murdoch@dunc@n @end|ng |rom gm@||@com  Fri Apr 16 14:06:19 2021
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Fri, 16 Apr 2021 08:06:19 -0400
Subject: [R-pkg-devel] Problems with too much testing
In-Reply-To: <CAJmOi+MSZhvEaCRKgxCMYLp6syBcLW8KdAoxKPK+eFhm6Fkhiw@mail.gmail.com>
References: <1df17415-0a48-a1a2-6498-6af12419f346@gmail.com>
 <CAJmOi+MSZhvEaCRKgxCMYLp6syBcLW8KdAoxKPK+eFhm6Fkhiw@mail.gmail.com>
Message-ID: <15ff321a-740d-7f7e-3d11-a197ed24ddd1@gmail.com>

On 16/04/2021 7:54 a.m., Hugh Parsonage wrote:
> My 2c is that if a package has actually tested something like that
> (say, the ordering of a list's elements), then it is 100% likely that
> a script out there depends on that behaviour too. 

I suspect this test is not intentional, and it really wouldn't make 
sense for a package to depend on the order of named list components.

  In other words, the
> change is not inconsequential.  R users are in debt to package
> developers but I think it behoves us to take special care not to
> underestimate the work involved when a package's behaviour changes.

There's a difference between internal implementation changes and 
external behaviour changes.  For example, there are clear warnings not 
to use un-exported functions (via :::), and a package that did that 
would not be accepted on CRAN.

What I'm asking for are suggestions for ways to hide internal layouts of 
objects from users.  That seems a lot harder.

Duncan Murdoch


From R@|ner @end|ng |rom krug@@de  Fri Apr 16 14:36:10 2021
From: R@|ner @end|ng |rom krug@@de (Rainer Krug)
Date: Fri, 16 Apr 2021 14:36:10 +0200
Subject: [R-pkg-devel] Problems with too much testing
In-Reply-To: <15ff321a-740d-7f7e-3d11-a197ed24ddd1@gmail.com>
References: <1df17415-0a48-a1a2-6498-6af12419f346@gmail.com>
 <CAJmOi+MSZhvEaCRKgxCMYLp6syBcLW8KdAoxKPK+eFhm6Fkhiw@mail.gmail.com>
 <15ff321a-740d-7f7e-3d11-a197ed24ddd1@gmail.com>
Message-ID: <84C659EC-6D87-44EF-90E2-F410B96B9FCC@krugs.de>



> On 16 Apr 2021, at 14:06, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
> 
> On 16/04/2021 7:54 a.m., Hugh Parsonage wrote:
>> My 2c is that if a package has actually tested something like that
>> (say, the ordering of a list's elements), then it is 100% likely that
>> a script out there depends on that behaviour too. 
> 
> I suspect this test is not intentional, and it really wouldn't make sense for a package to depend on the order of named list components.

You could randomise the order?.


> 
> In other words, the
>> change is not inconsequential.  R users are in debt to package
>> developers but I think it behoves us to take special care not to
>> underestimate the work involved when a package's behaviour changes.
> 
> There's a difference between internal implementation changes and external behaviour changes.  For example, there are clear warnings not to use un-exported functions (via :::), and a package that did that would not be accepted on CRAN.
> 
> What I'm asking for are suggestions for ways to hide internal layouts of objects from users.  That seems a lot harder.
> 
> Duncan Murdoch
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel



From murdoch@dunc@n @end|ng |rom gm@||@com  Fri Apr 16 15:08:28 2021
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Fri, 16 Apr 2021 09:08:28 -0400
Subject: [R-pkg-devel] Problems with too much testing
In-Reply-To: <1df17415-0a48-a1a2-6498-6af12419f346@gmail.com>
References: <1df17415-0a48-a1a2-6498-6af12419f346@gmail.com>
Message-ID: <3f10c951-4171-42dd-5f64-86b9a6a619fa@gmail.com>

An offline message said

"Oh, you mean you're asking for an actual object-oriented language that
hides the internal representations of objects from users of a package.
Unfortunately for all of us, that isn't R....."

Actually, I don't think that's what I want.  We already have lots of 
languages like that (and it's not too hard to integrate C++ with R, for 
example), but I'm not tempted to move code from R to C++ unnecessarily: 
  there's too much mental overhead (for me) in handling the extra formality.

What I think I'd like is something closer to the :: versus ::: 
difference in R.  In practice, it's purely a convention that ::: isn't 
used.  The package writer declares (via the NAMESPACE) that certain 
functions are fair game and will tend to be stable over time, but can't 
block access to the internal functions that aren't:  users are free to 
take chances and use :::.

I'd like to be able to declare that the order of components in a list 
doesn't matter.  I think the NULL component versus missing component is 
basically a bug in the language, but it's such an old one that I don't 
think it could be changed:  so I'd like to be able to declare that it's 
not a distinction anyone should depend on.

Both of these things could easily be handled by the existing S3 
machinery.  Instead of declaring my object to have class "mesh3d", I 
could declare it to have class c("mesh3d", "unorderedList", 
"ignoreNULL"), and comparison methods like base::all.equal() or 
waldo::compare() would ignore the unimportant differences.

The hardest thing here would be to agree on the class names and what 
they imply.

Duncan Murdoch


From pro|jcn@@h @end|ng |rom gm@||@com  Fri Apr 16 15:49:14 2021
From: pro|jcn@@h @end|ng |rom gm@||@com (J C Nash)
Date: Fri, 16 Apr 2021 09:49:14 -0400
Subject: [R-pkg-devel] Problems with too much testing
In-Reply-To: <3f10c951-4171-42dd-5f64-86b9a6a619fa@gmail.com>
References: <1df17415-0a48-a1a2-6498-6af12419f346@gmail.com>
 <3f10c951-4171-42dd-5f64-86b9a6a619fa@gmail.com>
Message-ID: <732d669d-83de-4895-409f-42c24e29c06e@gmail.com>

Another approach is to change the responsibility.

My feeling is that tests in the TESTING package should be modifiable by the maintainer of
the TESTED package, with both packages suspended if the two maintainers cannot agree. We
need to be able to move forward when legacy behaviour is outdated or just plain wrong. Or,
in the case that I find affects me, when improvements in iterative schemes change iterates
slightly. My guess is that Duncan's example is a case in point.

I doubt this will ever occur, as it doesn't seem to be the R way. However, I do know that
improvements in methods are not going to CRAN in some cases.

JN


From murdoch@dunc@n @end|ng |rom gm@||@com  Fri Apr 16 16:18:10 2021
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Fri, 16 Apr 2021 10:18:10 -0400
Subject: [R-pkg-devel] Problems with too much testing
In-Reply-To: <732d669d-83de-4895-409f-42c24e29c06e@gmail.com>
References: <1df17415-0a48-a1a2-6498-6af12419f346@gmail.com>
 <3f10c951-4171-42dd-5f64-86b9a6a619fa@gmail.com>
 <732d669d-83de-4895-409f-42c24e29c06e@gmail.com>
Message-ID: <1eefe35f-4f63-92a7-f7d1-5da214a2559b@gmail.com>

On 16/04/2021 9:49 a.m., J C Nash wrote:
> Another approach is to change the responsibility.
> 
> My feeling is that tests in the TESTING package should be modifiable by the maintainer of
> the TESTED package, with both packages suspended if the two maintainers cannot agree. We
> need to be able to move forward when legacy behaviour is outdated or just plain wrong. Or,
> in the case that I find affects me, when improvements in iterative schemes change iterates
> slightly. My guess is that Duncan's example is a case in point.
> 
> I doubt this will ever occur, as it doesn't seem to be the R way. However, I do know that
> improvements in methods are not going to CRAN in some cases.

In the cases I've been involved with the authors of the testing package 
have accepted suggested changes when I've made them:  I think that's 
also part of "the R way".  However, this takes time for both of us:  I 
need to understand what they are intending to test before I can suggest 
a change to it, and they need to understand my change before they can 
decide if it is acceptable, or whether further changes would also be 
necessary.

Github helps a lot with this:  if the testing package is there, I can 
quickly reproduce the issue, produce a fix, and send it to the author, 
who can tweak it if I've set things up properly.

For the kinds of changes you're making, I suspect relaxing a tolerance 
would often be enough, though if you switch algorithms and record that 
in your results, the testing package may need to replace reference 
values.  I think I'd be uncomfortable doing that.

Duncan Murdoch


From pro|jcn@@h @end|ng |rom gm@||@com  Fri Apr 16 16:50:53 2021
From: pro|jcn@@h @end|ng |rom gm@||@com (J C Nash)
Date: Fri, 16 Apr 2021 10:50:53 -0400
Subject: [R-pkg-devel] Problems with too much testing
In-Reply-To: <1eefe35f-4f63-92a7-f7d1-5da214a2559b@gmail.com>
References: <1df17415-0a48-a1a2-6498-6af12419f346@gmail.com>
 <3f10c951-4171-42dd-5f64-86b9a6a619fa@gmail.com>
 <732d669d-83de-4895-409f-42c24e29c06e@gmail.com>
 <1eefe35f-4f63-92a7-f7d1-5da214a2559b@gmail.com>
Message-ID: <2df8db36-01e9-763d-4f1b-53c704648cce@gmail.com>

I'm generally in accord with Duncan on this. There are inevitably situations where general
rules don't apply. Our challenge is to find practical ways to keep the overall workload of
all participants in the process to a minimum.

JN

On 2021-04-16 10:18 a.m., Duncan Murdoch wrote:
> On 16/04/2021 9:49 a.m., J C Nash wrote:
>> Another approach is to change the responsibility.
>>
>> My feeling is that tests in the TESTING package should be modifiable by the maintainer of
>> the TESTED package, with both packages suspended if the two maintainers cannot agree. We
>> need to be able to move forward when legacy behaviour is outdated or just plain wrong. Or,
>> in the case that I find affects me, when improvements in iterative schemes change iterates
>> slightly. My guess is that Duncan's example is a case in point.
>>
>> I doubt this will ever occur, as it doesn't seem to be the R way. However, I do know that
>> improvements in methods are not going to CRAN in some cases.
> 
> In the cases I've been involved with the authors of the testing package have accepted suggested changes when I've made
> them:? I think that's also part of "the R way".? However, this takes time for both of us:? I need to understand what
> they are intending to test before I can suggest a change to it, and they need to understand my change before they can
> decide if it is acceptable, or whether further changes would also be necessary.
> 
> Github helps a lot with this:? if the testing package is there, I can quickly reproduce the issue, produce a fix, and
> send it to the author, who can tweak it if I've set things up properly.
> 
> For the kinds of changes you're making, I suspect relaxing a tolerance would often be enough, though if you switch
> algorithms and record that in your results, the testing package may need to replace reference values.? I think I'd be
> uncomfortable doing that.
> 
> Duncan Murdoch
>


From @teve@the@b@ye@|@n @end|ng |rom gm@||@com  Fri Apr 16 17:32:38 2021
From: @teve@the@b@ye@|@n @end|ng |rom gm@||@com (Steven Scott)
Date: Fri, 16 Apr 2021 08:32:38 -0700
Subject: [R-pkg-devel] Problems with too much testing
In-Reply-To: <2df8db36-01e9-763d-4f1b-53c704648cce@gmail.com>
References: <1df17415-0a48-a1a2-6498-6af12419f346@gmail.com>
 <3f10c951-4171-42dd-5f64-86b9a6a619fa@gmail.com>
 <732d669d-83de-4895-409f-42c24e29c06e@gmail.com>
 <1eefe35f-4f63-92a7-f7d1-5da214a2559b@gmail.com>
 <2df8db36-01e9-763d-4f1b-53c704648cce@gmail.com>
Message-ID: <CAJqTW476jduUfYoadxGR3a6r-AEWLmsRD016CMfb6JCQDBOGSw@mail.gmail.com>

One of the basic principles of testing is "test interface, not
implementation."  Tests that violate this principle become "change detector
tests" instead of "correctness tests" and essentially prevent any
improvements to the code.  In C++ objects have "public" and "private"
methods, and the testing diktat is to test the public ones.  I hit this
issue a lot at Google when internal clients wrote change detector tests
effectively fencing in my tools.  My solution was to point out the
problematic tests and ask them not to do that.

The intent of R as a language is to be fast, lightweight, and flexible.  In
the interest of keeping it that way for users, it has grown large and
cumbersome for package authors.  If we try to tack on a "public/private"
object layout I'm afraid that would be yet another burden on package
authors.  The most obvious place I see to do this is in the NAMESPACE file,
which is already an ugly beast.  So while I agree with Duncan's
characterization of the problem, to my ears the "social solution" is the
cleanest one available, if we're talking about formal mechanisms.

Informally, both C++ and python use underscores in variable names to
suggest private data members.  You could just prefix "PRIVATE" to the name
of all the data members you don't want tested, where "PRIVATE" might become
"." or "_", or some other character.  I would argue against using
underscores, but I think I've already lost that battle.

On Fri, Apr 16, 2021 at 7:53 AM J C Nash <profjcnash at gmail.com> wrote:

> I'm generally in accord with Duncan on this. There are inevitably
> situations where general
> rules don't apply. Our challenge is to find practical ways to keep the
> overall workload of
> all participants in the process to a minimum.
>
> JN
>
> On 2021-04-16 10:18 a.m., Duncan Murdoch wrote:
> > On 16/04/2021 9:49 a.m., J C Nash wrote:
> >> Another approach is to change the responsibility.
> >>
> >> My feeling is that tests in the TESTING package should be modifiable by
> the maintainer of
> >> the TESTED package, with both packages suspended if the two maintainers
> cannot agree. We
> >> need to be able to move forward when legacy behaviour is outdated or
> just plain wrong. Or,
> >> in the case that I find affects me, when improvements in iterative
> schemes change iterates
> >> slightly. My guess is that Duncan's example is a case in point.
> >>
> >> I doubt this will ever occur, as it doesn't seem to be the R way.
> However, I do know that
> >> improvements in methods are not going to CRAN in some cases.
> >
> > In the cases I've been involved with the authors of the testing package
> have accepted suggested changes when I've made
> > them:  I think that's also part of "the R way".  However, this takes
> time for both of us:  I need to understand what
> > they are intending to test before I can suggest a change to it, and they
> need to understand my change before they can
> > decide if it is acceptable, or whether further changes would also be
> necessary.
> >
> > Github helps a lot with this:  if the testing package is there, I can
> quickly reproduce the issue, produce a fix, and
> > send it to the author, who can tweak it if I've set things up properly.
> >
> > For the kinds of changes you're making, I suspect relaxing a tolerance
> would often be enough, though if you switch
> > algorithms and record that in your results, the testing package may need
> to replace reference values.  I think I'd be
> > uncomfortable doing that.
> >
> > Duncan Murdoch
> >
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From @ntguz06 @end|ng |rom gm@||@com  Fri Apr 16 17:35:25 2021
From: @ntguz06 @end|ng |rom gm@||@com (=?UTF-8?B?Si4gQW50b25pbyBHdXptw6FuIFEu?=)
Date: Fri, 16 Apr 2021 09:35:25 -0600
Subject: [R-pkg-devel] Package gcc-ASAN issue
Message-ID: <CAF4cKSs+wMyC4=16jPN7WoYv5zAqQV+D9XDLwQtVoJYS6pFxKw@mail.gmail.com>

Hello,

We publish in CRAN our package rTLS [1]. The package passed the test
without problems. However, at some point, additional testing suggests that
it has issues with 'gcc-ASAN' [2]. For me this error is not informative,
and thus, I do not have an idea how to start. I have been looking for
guides or help on the web and unsure of this issue's reason or meaning. It
is not clear to me what to do based on Writing R Extensions in section
4.3.3.

When I see the log files [2], the issue seems to be located in a specific
function. However, not sure why this is in a specific function since the
based code is also shared with other functions.

Can you guide me or help me with this? I know that my message is not so
informative, but I do not know how to start to ask about this issue or
reproduce the error. Here is the code development repository for this
package [3].

Antonio,

[1]
https://cran-archive.r-project.org/web/checks/2021/2021-03-30_check_results_rTLS.html
[2] https://www.stats.ox.ac.uk/pub/bdr/memtests/gcc-ASAN/rTLS/00check.log
[3] https://github.com/Antguz/rTLS

-- 
_______________________
J. Antonio Guzm?n Q., Ph.D.
Alberta Centre for Earth Observation Sciences
University of Alberta, Canada
jaguzmanq.com
Look my work in Google Scholar
<https://scholar.google.es/citations?user=Ev3ofxwAAAAJ&hl=es> and/or
ResearchGate <https://www.researchgate.net/profile/J_Antonio_Guzman_Q>

	[[alternative HTML version deleted]]


From kev|nu@hey @end|ng |rom gm@||@com  Fri Apr 16 19:27:24 2021
From: kev|nu@hey @end|ng |rom gm@||@com (Kevin Ushey)
Date: Fri, 16 Apr 2021 10:27:24 -0700
Subject: [R-pkg-devel] Package gcc-ASAN issue
In-Reply-To: <CAF4cKSs+wMyC4=16jPN7WoYv5zAqQV+D9XDLwQtVoJYS6pFxKw@mail.gmail.com>
References: <CAF4cKSs+wMyC4=16jPN7WoYv5zAqQV+D9XDLwQtVoJYS6pFxKw@mail.gmail.com>
Message-ID: <CAJXgQP3W7pHzM4ZvNgX1LZBTgnfE2hga7qN96rWNqGmWkS-Yhw@mail.gmail.com>

>From https://www.stats.ox.ac.uk/pub/bdr/memtests/gcc-ASAN/rTLS/00check.log,
you can see errors of the form:

==3566104==ERROR: AddressSanitizer: stack-use-after-scope on address
0x7fffc2651f80 at pc 0x7f7ba5b635de bp 0x7fffc2651eb0 sp
0x7fffc2651ea0
< ... >

The slides here explain what that means in more detail:
https://llvm.org/devmtg/2016-11/Slides/Buka-StackUseAfterScope.pdf

But, in short, it usually means you took a reference to a variable on
the stack, and then tried to access memory via that reference after
that variable went out-of-scope.

Based on the associated code here:

https://github.com/Antguz/rTLS/blob/449b5c98942a37d4d98d4d2d27ac04caf3cc2cb6/src/knn_rcpp.cpp#L20-L48

A guess is that the issue is related to your use of the non-copying
arma::mat constructors + attempts to transpose them. Could you use
.inplace_trans() instead?

You can also try to verify locally using e.g. Docker; the rocker
images here are immensely helpful:

https://github.com/rocker-org/r-devel-san

Best,
Kevin


On Fri, Apr 16, 2021 at 8:43 AM J. Antonio Guzm?n Q. <antguz06 at gmail.com> wrote:
>
> Hello,
>
> We publish in CRAN our package rTLS [1]. The package passed the test
> without problems. However, at some point, additional testing suggests that
> it has issues with 'gcc-ASAN' [2]. For me this error is not informative,
> and thus, I do not have an idea how to start. I have been looking for
> guides or help on the web and unsure of this issue's reason or meaning. It
> is not clear to me what to do based on Writing R Extensions in section
> 4.3.3.
>
> When I see the log files [2], the issue seems to be located in a specific
> function. However, not sure why this is in a specific function since the
> based code is also shared with other functions.
>
> Can you guide me or help me with this? I know that my message is not so
> informative, but I do not know how to start to ask about this issue or
> reproduce the error. Here is the code development repository for this
> package [3].
>
> Antonio,
>
> [1]
> https://cran-archive.r-project.org/web/checks/2021/2021-03-30_check_results_rTLS.html
> [2] https://www.stats.ox.ac.uk/pub/bdr/memtests/gcc-ASAN/rTLS/00check.log
> [3] https://github.com/Antguz/rTLS
>
> --
> _______________________
> J. Antonio Guzm?n Q., Ph.D.
> Alberta Centre for Earth Observation Sciences
> University of Alberta, Canada
> jaguzmanq.com
> Look my work in Google Scholar
> <https://scholar.google.es/citations?user=Ev3ofxwAAAAJ&hl=es> and/or
> ResearchGate <https://www.researchgate.net/profile/J_Antonio_Guzman_Q>
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From t@tu@rt @end|ng |rom nygenome@org  Fri Apr 16 22:45:26 2021
From: t@tu@rt @end|ng |rom nygenome@org (Tim Stuart)
Date: Fri, 16 Apr 2021 16:45:26 -0400
Subject: [R-pkg-devel] Package fails to build on CRAN Windows server:
 rtracklayer version too new
Message-ID: <CAKT0KkevvP-7Z1oLbZNtYryzeh=zqNocNAxVUbEzqjnUOuGnoA@mail.gmail.com>

Hi all,

I am trying to submit an update to my package
(https://cran.r-project.org/package=Signac) to CRAN, but it is
currently failing to install on the Windows server. I see the
following installation error: "namespace 'rtracklayer' 1.48.0 is being
loaded, but >= 1.51.5 is required."

The current release version for rtracklayer is 1.50.0
(https://www.bioconductor.org/packages/release/bioc/html/rtracklayer.html).
My package does not set a version requirement for rtracklayer, so this
installation error must be caused by having a pre-release version of
one of my bioconductor dependencies installed on the windows server.

Does anyone know how I might be able to solve this issue? I have tried
contacting the CRAN team a few times by reply-all to the CRAN emails,
but have not had any response from them. This seems like an issue that
could only be solved by fixing the installation of packages on the
CRAN Windows server.

Incoming test results:
https://win-builder.r-project.org/incoming_pretest/Signac_1.1.2_20210415_225235/

Thanks,
Tim

-- 

This message is for the recipient?s use only, and may contain 
confidential, privileged or protected information. Any unauthorized use or 
dissemination of this communication is prohibited. If you received this 
message in error, please immediately notify the sender and destroy all 
copies of this message. The recipient should check this email and any 
attachments for the presence of viruses, as we accept no liability for any 
damage caused by any virus transmitted by this email.


From edd @end|ng |rom deb|@n@org  Sat Apr 17 01:00:35 2021
From: edd @end|ng |rom deb|@n@org (Dirk Eddelbuettel)
Date: Fri, 16 Apr 2021 18:00:35 -0500
Subject: [R-pkg-devel] Package gcc-ASAN issue
In-Reply-To: <CAJXgQP3W7pHzM4ZvNgX1LZBTgnfE2hga7qN96rWNqGmWkS-Yhw@mail.gmail.com>
References: <CAF4cKSs+wMyC4=16jPN7WoYv5zAqQV+D9XDLwQtVoJYS6pFxKw@mail.gmail.com>
 <CAJXgQP3W7pHzM4ZvNgX1LZBTgnfE2hga7qN96rWNqGmWkS-Yhw@mail.gmail.com>
Message-ID: <24698.5907.972597.833668@rob.eddelbuettel.com>


On 16 April 2021 at 10:27, Kevin Ushey wrote:
| You can also try to verify locally using e.g. Docker; the rocker
| images here are immensely helpful:
| 
| https://github.com/rocker-org/r-devel-san

Thanks but that container image may be stale at times. The daily rebuilds by
Kevin's colleague Winston of his (mega) container r-debug may be better:

   https://github.com/wch/r-debug

Dirk

-- 
https://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From edd @end|ng |rom deb|@n@org  Sat Apr 17 01:05:51 2021
From: edd @end|ng |rom deb|@n@org (Dirk Eddelbuettel)
Date: Fri, 16 Apr 2021 18:05:51 -0500
Subject: [R-pkg-devel] Does a file in tests/ know which package it is being
 run from?
Message-ID: <24698.6223.179670.434248@rob.eddelbuettel.com>


When a script in tests/ is being run by R CMD check and friends, can we know
what package it is currently being part of?  I want to access some package
files via system.file(..., package=pkg) which works just fine, but it feels
redundant to assign the package name to the pkg variable.  

Case in point is that I once again forgot to update the inst/NEWS.Rd file for
an upload today.  As I use a structured format, I can fairly reliably extract
the most recent version therein, and DESCRIPTION has the current version. So
what follows works fine , but per the preceding paragraph, do I need really
need 'pkg <- "RcppAPT"' here or can I do better?

Thanks for any pointers,  Dirk

---- tests/version.R for RcppAPT follows  -----------------------------------
pkg <- "RcppAPT"
nrdfile <- system.file("NEWS.Rd", package = pkg)
if (file.exists(nrdfile)) {
    nrd <- readLines(nrdfile)
    ver <- as.package_version(gsub(".* ([0-9\\.]+) .*", "\\1", nrd[grepl("\\{Changes", nrd)]))
    dcf <- read.dcf(system.file("DESCRIPTION", package = pkg))
    cur <- as.package_version(dcf[[1,"Version"]])
    if (cur != ver[1]) stop("Expected NEWS entry for ", cur, " but saw ", ver[1], call. = FALSE)
}
-----------------------------------------------------------------------------


-- 
https://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From @ntguz06 @end|ng |rom gm@||@com  Sat Apr 17 06:52:43 2021
From: @ntguz06 @end|ng |rom gm@||@com (=?UTF-8?B?Si4gQW50b25pbyBHdXptw6FuIFEu?=)
Date: Fri, 16 Apr 2021 22:52:43 -0600
Subject: [R-pkg-devel] Package gcc-ASAN issue
In-Reply-To: <24698.5907.972597.833668@rob.eddelbuettel.com>
References: <CAF4cKSs+wMyC4=16jPN7WoYv5zAqQV+D9XDLwQtVoJYS6pFxKw@mail.gmail.com>
 <CAJXgQP3W7pHzM4ZvNgX1LZBTgnfE2hga7qN96rWNqGmWkS-Yhw@mail.gmail.com>
 <24698.5907.972597.833668@rob.eddelbuettel.com>
Message-ID: <CAF4cKSs-Y22X-c8okzEXsxbcgKd0RH2S7cJMyDmN0E9sqJJLAg@mail.gmail.com>

Hello,

Thanks for your response Kevin. It works using 'inplace_trans()', but it
takes a long time to solve.

I will try to reproduce the error using Dirk's suggestion.

Your guides are appreciated.

AG.

El vie, 16 abr 2021 a las 17:00, Dirk Eddelbuettel (<edd at debian.org>)
escribi?:

>
> On 16 April 2021 at 10:27, Kevin Ushey wrote:
> | You can also try to verify locally using e.g. Docker; the rocker
> | images here are immensely helpful:
> |
> | https://github.com/rocker-org/r-devel-san
>
> Thanks but that container image may be stale at times. The daily rebuilds
> by
> Kevin's colleague Winston of his (mega) container r-debug may be better:
>
>    https://github.com/wch/r-debug
>
> Dirk
>
> --
> https://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org
>


-- 
_______________________
J. Antonio Guzm?n Q., Ph.D.
Alberta Centre for Earth Observation Sciences
University of Alberta, Canada
jaguzmanq.com
Look my work in Google Scholar
<https://scholar.google.es/citations?user=Ev3ofxwAAAAJ&hl=es> and/or
ResearchGate <https://www.researchgate.net/profile/J_Antonio_Guzman_Q>

	[[alternative HTML version deleted]]


From br@d|eyjeck @end|ng |rom gm@||@com  Mon Apr 19 11:14:13 2021
From: br@d|eyjeck @end|ng |rom gm@||@com (Brad Eck)
Date: Mon, 19 Apr 2021 10:14:13 +0100
Subject: [R-pkg-devel] compiling C sources on windows
Message-ID: <CALECgPap8LHmiFsO=eJpXGq_vR7LMvmmSuuGbO_a8XZYK5VLSA@mail.gmail.com>

Dear List -

I'm working to get a package of mine that was archived last year back on to
CRAN.
The epanet2toolkit provides an R interface to the EPANET simulation engine
that is written in C.

The latest development version of the package builds and checks ok on mac
and linux but fails to
compile and install on windows with a bunch of errors like:

undefined reference to `_imp__*`

where * is some function defined in a header file and implemented in the
corresponding source file.

Am i missing a compiler flag or something?

Current output from winbuilder :
https://win-builder.r-project.org/9aIcl8Fxu7w1/00install.out
or https://pastebin.com/8JQNpNKp

source code: https://github.com/bradleyjeck/epanet2toolkit/tree/v22dev

Any insights appreciated.

Brad

	[[alternative HTML version deleted]]


From kev|nu@hey @end|ng |rom gm@||@com  Mon Apr 19 18:06:22 2021
From: kev|nu@hey @end|ng |rom gm@||@com (Kevin Ushey)
Date: Mon, 19 Apr 2021 09:06:22 -0700
Subject: [R-pkg-devel] compiling C sources on windows
In-Reply-To: <CALECgPap8LHmiFsO=eJpXGq_vR7LMvmmSuuGbO_a8XZYK5VLSA@mail.gmail.com>
References: <CALECgPap8LHmiFsO=eJpXGq_vR7LMvmmSuuGbO_a8XZYK5VLSA@mail.gmail.com>
Message-ID: <CAJXgQP1uVyeeTcmGTvmMf29dYJpwqdU11tQEOstt-=M0X=TPiA@mail.gmail.com>

I suspect the cause is this:

https://github.com/bradleyjeck/epanet2toolkit/blob/aa698568ab85db133f8634928e8cfe661b41ed57/src/epanet2.h#L42-L61

Usually, you only need to explicitly use __declspec if you're
compiling with MSVC -- it shouldn't be necessary when using a MinGW
toolchain (as R's toolchain is). You could try adding something like:

#ifdef __MINGW32__
#define DLLEXPORT
#endif

If you need to test locally on Windows, there are free virtual
machines available here:
https://developer.microsoft.com/en-us/microsoft-edge/tools/vms/

Best,
Kevin

On Mon, Apr 19, 2021 at 2:14 AM Brad Eck <bradleyjeck at gmail.com> wrote:
>
> Dear List -
>
> I'm working to get a package of mine that was archived last year back on to
> CRAN.
> The epanet2toolkit provides an R interface to the EPANET simulation engine
> that is written in C.
>
> The latest development version of the package builds and checks ok on mac
> and linux but fails to
> compile and install on windows with a bunch of errors like:
>
> undefined reference to `_imp__*`
>
> where * is some function defined in a header file and implemented in the
> corresponding source file.
>
> Am i missing a compiler flag or something?
>
> Current output from winbuilder :
> https://win-builder.r-project.org/9aIcl8Fxu7w1/00install.out
> or https://pastebin.com/8JQNpNKp
>
> source code: https://github.com/bradleyjeck/epanet2toolkit/tree/v22dev
>
> Any insights appreciated.
>
> Brad
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From br@d|eyjeck @end|ng |rom gm@||@com  Mon Apr 19 21:54:18 2021
From: br@d|eyjeck @end|ng |rom gm@||@com (Brad Eck)
Date: Mon, 19 Apr 2021 20:54:18 +0100
Subject: [R-pkg-devel] compiling C sources on windows
In-Reply-To: <CAJXgQP1uVyeeTcmGTvmMf29dYJpwqdU11tQEOstt-=M0X=TPiA@mail.gmail.com>
References: <CALECgPap8LHmiFsO=eJpXGq_vR7LMvmmSuuGbO_a8XZYK5VLSA@mail.gmail.com>
 <CAJXgQP1uVyeeTcmGTvmMf29dYJpwqdU11tQEOstt-=M0X=TPiA@mail.gmail.com>
Message-ID: <CALECgPY2jHnDN=0=wGPTxr2=tGiXFH-10BmfnZVNrk=QrseV9A@mail.gmail.com>

Thanks Kevin, that fixed the compilation issue.  On to the next!

Brad

On Mon, Apr 19, 2021 at 5:06 PM Kevin Ushey <kevinushey at gmail.com> wrote:

> I suspect the cause is this:
>
>
> https://github.com/bradleyjeck/epanet2toolkit/blob/aa698568ab85db133f8634928e8cfe661b41ed57/src/epanet2.h#L42-L61
>
> Usually, you only need to explicitly use __declspec if you're
> compiling with MSVC -- it shouldn't be necessary when using a MinGW
> toolchain (as R's toolchain is). You could try adding something like:
>
> #ifdef __MINGW32__
> #define DLLEXPORT
> #endif
>
> If you need to test locally on Windows, there are free virtual
> machines available here:
> https://developer.microsoft.com/en-us/microsoft-edge/tools/vms/
>
> Best,
> Kevin
>
> On Mon, Apr 19, 2021 at 2:14 AM Brad Eck <bradleyjeck at gmail.com> wrote:
> >
> > Dear List -
> >
> > I'm working to get a package of mine that was archived last year back on
> to
> > CRAN.
> > The epanet2toolkit provides an R interface to the EPANET simulation
> engine
> > that is written in C.
> >
> > The latest development version of the package builds and checks ok on mac
> > and linux but fails to
> > compile and install on windows with a bunch of errors like:
> >
> > undefined reference to `_imp__*`
> >
> > where * is some function defined in a header file and implemented in the
> > corresponding source file.
> >
> > Am i missing a compiler flag or something?
> >
> > Current output from winbuilder :
> > https://win-builder.r-project.org/9aIcl8Fxu7w1/00install.out
> > or https://pastebin.com/8JQNpNKp
> >
> > source code: https://github.com/bradleyjeck/epanet2toolkit/tree/v22dev
> >
> > Any insights appreciated.
> >
> > Brad
> >
> >         [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-package-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From henr|k@bengt@@on @end|ng |rom gm@||@com  Tue Apr 20 03:47:04 2021
From: henr|k@bengt@@on @end|ng |rom gm@||@com (Henrik Bengtsson)
Date: Mon, 19 Apr 2021 18:47:04 -0700
Subject: [R-pkg-devel] Package fails to build on CRAN Windows server:
 rtracklayer version too new
In-Reply-To: <CAKT0KkevvP-7Z1oLbZNtYryzeh=zqNocNAxVUbEzqjnUOuGnoA@mail.gmail.com>
References: <CAKT0KkevvP-7Z1oLbZNtYryzeh=zqNocNAxVUbEzqjnUOuGnoA@mail.gmail.com>
Message-ID: <CAFDcVCQ3QT=5sYqVa_giaBzsonyEni8MdwqfuSutt_r9Z5hCQA@mail.gmail.com>

Not that it solves your problem per se, but here's what I think CRAN
only has rtracklayer 1.48.0 installed on WIndows, i.e. why you get
error "namespace 'rtracklayer' 1.48.0 is being loaded, but >= 1.51.5
is required.":

* The current Bioconductor "release" is version 3.12
* As you say, Bioconductor 3.12 provides rtracklayer 1.50.0
(https://www.bioconductor.org/packages/3.12/bioc/html/rtracklayer.html)
* However, if you look at that page, for Windows it only provides
rtracklayer 1.49.5 (this is because rtracklayer never successfully
checked on Bioconductor 3.12)
* Since the minor version component of rtracklayer 1.49.5 is _odd_, it
means it's from a Bioconductor 'devel' branch, i.e. when Bioconductor
3.12 was in devel.
* Thus, the most recent Bioconductor "release" where rtracklayer was
successfully distributed on Windows is Bioconductor 3.11.
* Bioconductor 3.11 provides rtracklayer 1.48.0
(https://www.bioconductor.org/packages/3.11/bioc/html/rtracklayer.html)

Clear as mud?

I suspect you're using Suggest: rtracklayer
(https://github.com/timoast/signac/blob/develop/DESCRIPTION) in your
new version.  If so, that's good.  I also don't think you're doing
anything wrong here.  Instead, I think it's one of your other
Bioconductor dependencies under 'Imports:', or possibly under
'Suggests:', that depend on 'rtracklayer'.  The fact that error says
"namespace 'rtracklayer' 1.48.0 is being loaded, but >= 1.51.5 is
required.", means that one of those Bioconductor dependencies, or
their dependencies, has an explicit 'rtracklayer (>= 1.51.5)' under
either Depends: or Imports:.  My recommendation is that you start
identifying that Bioconductor package, and in what way your 'Signac'
depends on that package.  That will help you decide on what to do
next.

/Henrik

PS. This can happen because Bioconductor allows a package to propagate
to a new "release" branch even if it fails on one of the operating
systems.

On Fri, Apr 16, 2021 at 1:59 PM Tim Stuart <tstuart at nygenome.org> wrote:
>
> Hi all,
>
> I am trying to submit an update to my package
> (https://cran.r-project.org/package=Signac) to CRAN, but it is
> currently failing to install on the Windows server. I see the
> following installation error: "namespace 'rtracklayer' 1.48.0 is being
> loaded, but >= 1.51.5 is required."
>
> The current release version for rtracklayer is 1.50.0
> (https://www.bioconductor.org/packages/release/bioc/html/rtracklayer.html).
> My package does not set a version requirement for rtracklayer, so this
> installation error must be caused by having a pre-release version of
> one of my bioconductor dependencies installed on the windows server.
>
> Does anyone know how I might be able to solve this issue? I have tried
> contacting the CRAN team a few times by reply-all to the CRAN emails,
> but have not had any response from them. This seems like an issue that
> could only be solved by fixing the installation of packages on the
> CRAN Windows server.
>
> Incoming test results:
> https://win-builder.r-project.org/incoming_pretest/Signac_1.1.2_20210415_225235/
>
> Thanks,
> Tim
>
> --
>
> This message is for the recipient?s use only, and may contain
> confidential, privileged or protected information. Any unauthorized use or
> dissemination of this communication is prohibited. If you received this
> message in error, please immediately notify the sender and destroy all
> copies of this message. The recipient should check this email and any
> attachments for the presence of viruses, as we accept no liability for any
> damage caused by any virus transmitted by this email.
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From b|erner @end|ng |rom mtho|yoke@edu  Wed Apr 21 00:02:07 2021
From: b|erner @end|ng |rom mtho|yoke@edu (Barbara Lerner)
Date: Tue, 20 Apr 2021 18:02:07 -0400
Subject: [R-pkg-devel] Package from non-mainstream repository
Message-ID: <2e3a337e-71d4-d993-f896-38274d67389f@mtholyoke.edu>

When checking my package with R-devel, I get the following notes.? In 
the current and earlier versions of R, I got the same note concerning 
incoming feasibility, but the NOTE about the package not being available 
for checking did not occur.? What do I need to do to get rid of that note?

* checking CRAN incoming feasibility ... NOTE
Maintainer: 'Barbara Lerner <blerner at mtholyoke.edu>'

Suggests or Enhances not in mainstream repositories:
   rdt
Availability using Additional_repositories specification:
   rdt   yes   https://end-to-end-provenance.github.io/drat/
* checking package namespace information ... OK
* checking package dependencies ... NOTE
Package suggested but not available for checking: 'rdt'

Thanks for your help!
Barbara

-- 
<http://www.getpostbox.com>Barbara Lerner (she / her)
Professor
Computer Science Department
Mount Holyoke College

<http://www.getpostbox.com>

	[[alternative HTML version deleted]]


From m@rce|o@27 @end|ng |rom gm@||@com  Wed Apr 21 05:18:33 2021
From: m@rce|o@27 @end|ng |rom gm@||@com (Marcelo Araya Salas)
Date: Tue, 20 Apr 2021 21:18:33 -0600
Subject: [R-pkg-devel] Warning: Vignettes missing from index
In-Reply-To: <mailman.6859.9.1618912802.36355.r-package-devel@r-project.org>
References: <mailman.6859.9.1618912802.36355.r-package-devel@r-project.org>
Message-ID: <CABJVSXRtJ8EErptwj_YH_oCEhkMzxgdNS5h8ZpeZPT=_PXEOzw@mail.gmail.com>

I am trying to build the website for my NatureSounds package with pkgdown
but I got the following error message:

Warning: Vignettes missing from index:


I already have this metadata in the vignette:

vignette: >
   %\VignetteIndexEntry{Acoustic data sets in NatureSounds}
   %\usepackage[utf8]{inputenc}
   %\VignetteEncoding{UTF-8}
   %\VignetteEngine{knitr::rmarkdown}

I cannot find any thing about it when searching online. Any help would be
appreciated!

thanks!
Marcelo

	[[alternative HTML version deleted]]


From otoomet @end|ng |rom gm@||@com  Wed Apr 21 07:16:40 2021
From: otoomet @end|ng |rom gm@||@com (Ott Toomet)
Date: Tue, 20 Apr 2021 22:16:40 -0700
Subject: [R-pkg-devel] Skipping tests on CRAN
Message-ID: <CAMMJQ0ZkcKv9Gri-7TVtjgCf1RsS=gex-B9LNkNV-y7YGVgQkA@mail.gmail.com>

Hi packagers,

what is the best way to skip certain tests on CRAN?  So far I have included
certain test files in .Rbuildignore and run the tests on the package
directory.  But now when moving to Authors at R format, I get errors about
missing maintainer etc.

I know there are options in testthat, tinytest and such, are these the best
options with least dependencies and assumptions built in?

I sort of remember something in base R but cannot find anything when
looking for it now.

Cheers,
Ott

	[[alternative HTML version deleted]]


From m@rk@v@nder|oo @end|ng |rom gm@||@com  Wed Apr 21 08:35:14 2021
From: m@rk@v@nder|oo @end|ng |rom gm@||@com (Mark van der Loo)
Date: Wed, 21 Apr 2021 08:35:14 +0200
Subject: [R-pkg-devel] Skipping tests on CRAN
In-Reply-To: <CAMMJQ0ZkcKv9Gri-7TVtjgCf1RsS=gex-B9LNkNV-y7YGVgQkA@mail.gmail.com>
References: <CAMMJQ0ZkcKv9Gri-7TVtjgCf1RsS=gex-B9LNkNV-y7YGVgQkA@mail.gmail.com>
Message-ID: <CAOKDuOjqt1h=TQ_i6h6TYMHs679BUJkU5q4EkB6-w+iVXCArMw@mail.gmail.com>

Hi Ott,

There is no documented way to detect whether you are running on CRAN. So
there is nothing to rely on, on that side.

You can only make your own machine detectable by the test code. For example
by setting an environment variable that identifies your machine and make
test execution depend on the value of that environment variable. This is
what tinytest does under the hood.

Best,
Mark





On Wed, Apr 21, 2021 at 7:17 AM Ott Toomet <otoomet at gmail.com> wrote:

> Hi packagers,
>
> what is the best way to skip certain tests on CRAN?  So far I have included
> certain test files in .Rbuildignore and run the tests on the package
> directory.  But now when moving to Authors at R format, I get errors about
> missing maintainer etc.
>
> I know there are options in testthat, tinytest and such, are these the best
> options with least dependencies and assumptions built in?
>
> I sort of remember something in base R but cannot find anything when
> looking for it now.
>
> Cheers,
> Ott
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From murdoch@dunc@n @end|ng |rom gm@||@com  Wed Apr 21 09:44:31 2021
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Wed, 21 Apr 2021 03:44:31 -0400
Subject: [R-pkg-devel] Warning: Vignettes missing from index
In-Reply-To: <CABJVSXRtJ8EErptwj_YH_oCEhkMzxgdNS5h8ZpeZPT=_PXEOzw@mail.gmail.com>
References: <mailman.6859.9.1618912802.36355.r-package-devel@r-project.org>
 <CABJVSXRtJ8EErptwj_YH_oCEhkMzxgdNS5h8ZpeZPT=_PXEOzw@mail.gmail.com>
Message-ID: <07727456-7a4a-bc6c-0418-7976a90e48fe@gmail.com>

On 20/04/2021 11:18 p.m., Marcelo Araya Salas wrote:
> I am trying to build the website for my NatureSounds package with pkgdown
> but I got the following error message:
> 
> Warning: Vignettes missing from index:

That probably means you have an "articles:" section in your _pkgdown.yml 
file, but you aren't listing all the articles.

Duncan Murdoch

> 
> 
> I already have this metadata in the vignette:
> 
> vignette: >
>     %\VignetteIndexEntry{Acoustic data sets in NatureSounds}
>     %\usepackage[utf8]{inputenc}
>     %\VignetteEncoding{UTF-8}
>     %\VignetteEngine{knitr::rmarkdown}
> 
> I cannot find any thing about it when searching online. Any help would be
> appreciated!
> 
> thanks!
> Marcelo
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


From murdoch@dunc@n @end|ng |rom gm@||@com  Wed Apr 21 09:47:44 2021
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Wed, 21 Apr 2021 03:47:44 -0400
Subject: [R-pkg-devel] Skipping tests on CRAN
In-Reply-To: <CAMMJQ0ZkcKv9Gri-7TVtjgCf1RsS=gex-B9LNkNV-y7YGVgQkA@mail.gmail.com>
References: <CAMMJQ0ZkcKv9Gri-7TVtjgCf1RsS=gex-B9LNkNV-y7YGVgQkA@mail.gmail.com>
Message-ID: <625cf3ea-6e1d-a805-3847-85e18af9d2fe@gmail.com>

On 21/04/2021 1:16 a.m., Ott Toomet wrote:
> Hi packagers,
> 
> what is the best way to skip certain tests on CRAN?  So far I have included
> certain test files in .Rbuildignore and run the tests on the package
> directory.  But now when moving to Authors at R format, I get errors about
> missing maintainer etc.
> 
> I know there are options in testthat, tinytest and such, are these the best
> options with least dependencies and assumptions built in?
> 
> I sort of remember something in base R but cannot find anything when
> looking for it now.

The base solution is to put your local-only tests in another directory, 
and specify it using "--test-dir=".  One of the scripts there can run 
the files in the regular tests directory, so you get both sets with that 
option, but CRAN will only run the regular ones.

Duncan Murdoch


From @eb@meyer @end|ng |rom |@u@de  Wed Apr 21 12:03:02 2021
From: @eb@meyer @end|ng |rom |@u@de (Sebastian Meyer)
Date: Wed, 21 Apr 2021 12:03:02 +0200
Subject: [R-pkg-devel] Skipping tests on CRAN
In-Reply-To: <CAOKDuOjqt1h=TQ_i6h6TYMHs679BUJkU5q4EkB6-w+iVXCArMw@mail.gmail.com>
References: <CAMMJQ0ZkcKv9Gri-7TVtjgCf1RsS=gex-B9LNkNV-y7YGVgQkA@mail.gmail.com>
 <CAOKDuOjqt1h=TQ_i6h6TYMHs679BUJkU5q4EkB6-w+iVXCArMw@mail.gmail.com>
Message-ID: <80df9200-3922-ed55-8e2f-90a002dc082f@fau.de>

Am 21.04.21 um 08:35 schrieb Mark van der Loo:
> Hi Ott,
> 
> There is no documented way to detect whether you are running on CRAN. So
> there is nothing to rely on, on that side.
> 
> You can only make your own machine detectable by the test code. For example
> by setting an environment variable that identifies your machine and make
> test execution depend on the value of that environment variable. This is
> what tinytest does under the hood.

You could add the following at the start of a script containing slow tests:

if (!identical(Sys.getenv("NOT_CRAN"), "true")) {
    message("skipping slow tests")
    q("no")
}
## slow tests follow here ...

Of course, you could use a different name for the environment variable,
e.g., "R_PKGNAME_ALL_TESTS", or test with as.logical() to allow both
"TRUE" and "true" values:

if (!isTRUE(as.logical(Sys.getenv("R_PKGNAME_ALL_TESTS")))) q("no")

Quitting from test scripts as above is frequently used in R's own test
suite, for example in the regression tests for message translations:

if (!capabilities("NLS")) {
    message("no natural language support")
    q("no")
}

Don't run such code in an interactive session if you don't want to quit
R. ;)

An alternative is the R CMD check --test-dir=inst/slowTests approach
mentioned in the WRE manual at
https://CRAN.R-project.org/doc/manuals/r-devel/R-exts.html#Checking-packages
.

Best regards,

	Sebastian

> 
> Best,
> Mark
> 
> 
> 
> 
> 
> On Wed, Apr 21, 2021 at 7:17 AM Ott Toomet <otoomet at gmail.com> wrote:
> 
>> Hi packagers,
>>
>> what is the best way to skip certain tests on CRAN?  So far I have included
>> certain test files in .Rbuildignore and run the tests on the package
>> directory.  But now when moving to Authors at R format, I get errors about
>> missing maintainer etc.
>>
>> I know there are options in testthat, tinytest and such, are these the best
>> options with least dependencies and assumptions built in?
>>
>> I sort of remember something in base R but cannot find anything when
>> looking for it now.
>>
>> Cheers,
>> Ott
>>
>>         [[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


From edd @end|ng |rom deb|@n@org  Wed Apr 21 17:10:54 2021
From: edd @end|ng |rom deb|@n@org (Dirk Eddelbuettel)
Date: Wed, 21 Apr 2021 10:10:54 -0500
Subject: [R-pkg-devel] Skipping tests on CRAN
In-Reply-To: <80df9200-3922-ed55-8e2f-90a002dc082f@fau.de>
References: <CAMMJQ0ZkcKv9Gri-7TVtjgCf1RsS=gex-B9LNkNV-y7YGVgQkA@mail.gmail.com>
 <CAOKDuOjqt1h=TQ_i6h6TYMHs679BUJkU5q4EkB6-w+iVXCArMw@mail.gmail.com>
 <80df9200-3922-ed55-8e2f-90a002dc082f@fau.de>
Message-ID: <24704.16510.571277.651818@rob.eddelbuettel.com>


You can default to have 'few tests'. That then happens at CRAN too when
nothing else is set (as there simply is no variable to rely upon).

You can then try to detect when you would want to run 'more tests'. Placing
the tests somewhere else (as Duncan suggested) to explicitly opt in is one
way (though you may forget to opt in...), making it depend on an extra
variable you set for more tests is another (though you may forget to set
this).

So like to automate this via a 'testable condition' in the loader script in
tests/ that sets that environment variable for me. E.g. in Rcpp _if_ it sees
a version number such as 1.0.6.6 which signals (via the fourth component)
that this is a 'development / interim' version it sets the controlling
environment variable run 'full / all tests'. Whereas at CRAN, the next
release will be 1.0.7, which is a release version and only the (default) few
tests run.

Hope this helps, Dirk

-- 
https://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de  Wed Apr 21 17:12:23 2021
From: ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de (Uwe Ligges)
Date: Wed, 21 Apr 2021 17:12:23 +0200
Subject: [R-pkg-devel] Package from non-mainstream repository
In-Reply-To: <2e3a337e-71d4-d993-f896-38274d67389f@mtholyoke.edu>
References: <2e3a337e-71d4-d993-f896-38274d67389f@mtholyoke.edu>
Message-ID: <2034879d-df7c-19cc-80ad-78d7c08ec31f@statistik.tu-dortmund.de>



On 21.04.2021 00:02, Barbara Lerner wrote:
> When checking my package with R-devel, I get the following notes.? In
> the current and earlier versions of R, I got the same note concerning
> incoming feasibility, but the NOTE about the package not being available
> for checking did not occur.? What do I need to do to get rid of that note?

You cannot do anything, this note is fine and a CRAN team member can 
install the package if needed.

Best,
Uwe Ligges


> * checking CRAN incoming feasibility ... NOTE
> Maintainer: 'Barbara Lerner <blerner at mtholyoke.edu>'
> 
> Suggests or Enhances not in mainstream repositories:
>     rdt
> Availability using Additional_repositories specification:
>     rdt   yes   https://end-to-end-provenance.github.io/drat/
> * checking package namespace information ... OK
> * checking package dependencies ... NOTE
> Package suggested but not available for checking: 'rdt'
> 
> Thanks for your help!
> Barbara
>


From otoomet @end|ng |rom gm@||@com  Wed Apr 21 17:22:25 2021
From: otoomet @end|ng |rom gm@||@com (Ott Toomet)
Date: Wed, 21 Apr 2021 08:22:25 -0700
Subject: [R-pkg-devel] Skipping tests on CRAN
In-Reply-To: <80df9200-3922-ed55-8e2f-90a002dc082f@fau.de>
References: <CAMMJQ0ZkcKv9Gri-7TVtjgCf1RsS=gex-B9LNkNV-y7YGVgQkA@mail.gmail.com>
 <CAOKDuOjqt1h=TQ_i6h6TYMHs679BUJkU5q4EkB6-w+iVXCArMw@mail.gmail.com>
 <80df9200-3922-ed55-8e2f-90a002dc082f@fau.de>
Message-ID: <CAMMJQ0ZTT7DO0-rc1Nd6cRg-RKPtnWaxGJiUqx1pqJf8C9nd3A@mail.gmail.com>

Thanks everyone!

I'd like to follow the Duncan's approach but I am not sure if it solves the
issue:
* if I put the private tests into a separate folder and ignore it when
building the package, then I still cannot run these checks without creating
the tarball (Maintainer, Author not built into DESCRIPTION)
* If I do not ignore this folder and build it into a tarball, then both
private and public tests work, but now check-as-cran complains about
non-standard directories.

I do not see an option like --do-not-test-description which would skip the
issues with authors and maintainers.  Obviously, I can replicate authors
both in @R and plain format but then again, what is the point of @R format?

So for now I'll probably go with the Dirk's suggestion to default to "few
tests" and set up an environment variable just for myself.

BTW, Mark, I really like your tinytest vignettes :-)  I should maybe move
my tests over to this one day.

Best,
Ott



On Wed, Apr 21, 2021 at 3:03 AM Sebastian Meyer <seb.meyer at fau.de> wrote:

> Am 21.04.21 um 08:35 schrieb Mark van der Loo:
> > Hi Ott,
> >
> > There is no documented way to detect whether you are running on CRAN. So
> > there is nothing to rely on, on that side.
> >
> > You can only make your own machine detectable by the test code. For
> example
> > by setting an environment variable that identifies your machine and make
> > test execution depend on the value of that environment variable. This is
> > what tinytest does under the hood.
>
> You could add the following at the start of a script containing slow tests:
>
> if (!identical(Sys.getenv("NOT_CRAN"), "true")) {
>     message("skipping slow tests")
>     q("no")
> }
> ## slow tests follow here ...
>
> Of course, you could use a different name for the environment variable,
> e.g., "R_PKGNAME_ALL_TESTS", or test with as.logical() to allow both
> "TRUE" and "true" values:
>
> if (!isTRUE(as.logical(Sys.getenv("R_PKGNAME_ALL_TESTS")))) q("no")
>
> Quitting from test scripts as above is frequently used in R's own test
> suite, for example in the regression tests for message translations:
>
> if (!capabilities("NLS")) {
>     message("no natural language support")
>     q("no")
> }
>
> Don't run such code in an interactive session if you don't want to quit
> R. ;)
>
> An alternative is the R CMD check --test-dir=inst/slowTests approach
> mentioned in the WRE manual at
>
> https://CRAN.R-project.org/doc/manuals/r-devel/R-exts.html#Checking-packages
> .
>
> Best regards,
>
>         Sebastian
>
> >
> > Best,
> > Mark
> >
> >
> >
> >
> >
> > On Wed, Apr 21, 2021 at 7:17 AM Ott Toomet <otoomet at gmail.com> wrote:
> >
> >> Hi packagers,
> >>
> >> what is the best way to skip certain tests on CRAN?  So far I have
> included
> >> certain test files in .Rbuildignore and run the tests on the package
> >> directory.  But now when moving to Authors at R format, I get errors about
> >> missing maintainer etc.
> >>
> >> I know there are options in testthat, tinytest and such, are these the
> best
> >> options with least dependencies and assumptions built in?
> >>
> >> I sort of remember something in base R but cannot find anything when
> >> looking for it now.
> >>
> >> Cheers,
> >> Ott
> >>
> >>         [[alternative HTML version deleted]]
> >>
> >> ______________________________________________
> >> R-package-devel at r-project.org mailing list
> >> https://stat.ethz.ch/mailman/listinfo/r-package-devel
> >>
> >
> >       [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-package-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-package-devel
> >
>

	[[alternative HTML version deleted]]


From kev|n@r@coombe@ @end|ng |rom gm@||@com  Thu Apr 22 22:28:55 2021
From: kev|n@r@coombe@ @end|ng |rom gm@||@com (Kevin R. Coombes)
Date: Thu, 22 Apr 2021 16:28:55 -0400
Subject: [R-pkg-devel] Using ggplot2 within another package
Message-ID: <b59d4e81-51aa-1f8a-975c-b1e87408d61f@gmail.com>

Hi,

I'm trying to help clean up an R package for someone else to submit to 
CRAN. He has used ggplot2 to implement a plotting function for the kinds 
of things that his packages generates. His plotting routine basically 
looks like (after changing names to protect the innocent):

myPlot <- fucntion(myData, ...) {
 ?? # get ready
 ?? ggplot(myData, aes(x = myX, y = myY)) +
 ????? # add my decorations
 ????? theme_bw()
}

Of course, "R CMD check --as-cran" complains that there is no global 
binding for "myX" or "myY" since they are columns defined in the 
data.frame "myData".

What is the best way to work around this issue?

Of course, dinosaurs like myself might be tempted to suggest just using 
plain old "plot", so I don't need to see those suggestions.

Do I just ignore the usual ggplot conventions and write "myData$myX" 
inside "aes"? in order to appease the CRAN checker? Or is there some 
tidy-er way to solve this problem?

Thanks,
 ? Kevin


From p@u|@@@v@ry @end|ng |rom un|v-|comte@|r  Thu Apr 22 22:34:33 2021
From: p@u|@@@v@ry @end|ng |rom un|v-|comte@|r (Paul SAVARY)
Date: Thu, 22 Apr 2021 22:34:33 +0200 (CEST)
Subject: [R-pkg-devel] Using ggplot2 within another package
In-Reply-To: <b59d4e81-51aa-1f8a-975c-b1e87408d61f@gmail.com>
References: <b59d4e81-51aa-1f8a-975c-b1e87408d61f@gmail.com>
Message-ID: <1286449999.9275892.1619123673948.JavaMail.zimbra@univ-fcomte.fr>

Hi Kevin,

I was faced to the same problem and I used 'aes_string()' instead of 'aes()'. You can then just write the name of the columns containing the data to plot as character strings.

Example:

myPlot <- function(myData, ...) {
    # get ready
    ggplot(myData, aes_string(x = "myX", y = "myY")) +
       # add my decorations
       theme_bw()
}

It is probably already the case for your function but you need to include #' @import ggplot2 in your function preamble (if I am not wrong).

Kind regards
Paul

----- Mail original -----
De: "Kevin R. Coombes" <kevin.r.coombes at gmail.com>
?: "r-package-devel" <r-package-devel at r-project.org>
Envoy?: Jeudi 22 Avril 2021 22:28:55
Objet: [R-pkg-devel] Using ggplot2 within another package

Hi,

I'm trying to help clean up an R package for someone else to submit to 
CRAN. He has used ggplot2 to implement a plotting function for the kinds 
of things that his packages generates. His plotting routine basically 
looks like (after changing names to protect the innocent):

myPlot <- fucntion(myData, ...) {
 ?? # get ready
 ?? ggplot(myData, aes(x = myX, y = myY)) +
 ????? # add my decorations
 ????? theme_bw()
}

Of course, "R CMD check --as-cran" complains that there is no global 
binding for "myX" or "myY" since they are columns defined in the 
data.frame "myData".

What is the best way to work around this issue?

Of course, dinosaurs like myself might be tempted to suggest just using 
plain old "plot", so I don't need to see those suggestions.

Do I just ignore the usual ggplot conventions and write "myData$myX" 
inside "aes"? in order to appease the CRAN checker? Or is there some 
tidy-er way to solve this problem?

Thanks,
 ? Kevin

______________________________________________
R-package-devel at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-package-devel


From r|||ght79 @end|ng |rom gm@||@com  Thu Apr 22 22:45:19 2021
From: r|||ght79 @end|ng |rom gm@||@com (Robert M. Flight)
Date: Thu, 22 Apr 2021 16:45:19 -0400
Subject: [R-pkg-devel] Using ggplot2 within another package
In-Reply-To: <1286449999.9275892.1619123673948.JavaMail.zimbra@univ-fcomte.fr>
References: <b59d4e81-51aa-1f8a-975c-b1e87408d61f@gmail.com>
 <1286449999.9275892.1619123673948.JavaMail.zimbra@univ-fcomte.fr>
Message-ID: <CAJLyBTWRjGC5nk2k0q9jbna2cv-6EaYPY7m5QR+HCtEG1gF4+A@mail.gmail.com>

Kevin,

This vignette from ggplot2 itself gives the "officially recommended" ways
to avoid the warnings from R CMD check

https://ggplot2.tidyverse.org/articles/ggplot2-in-packages.html

Cheers,

-Robert

On Thu, Apr 22, 2021 at 4:39 PM Paul SAVARY <paul.savary at univ-fcomte.fr>
wrote:

> Hi Kevin,
>
> I was faced to the same problem and I used 'aes_string()' instead of
> 'aes()'. You can then just write the name of the columns containing the
> data to plot as character strings.
>
> Example:
>
> myPlot <- function(myData, ...) {
>     # get ready
>     ggplot(myData, aes_string(x = "myX", y = "myY")) +
>        # add my decorations
>        theme_bw()
> }
>
> It is probably already the case for your function but you need to include
> #' @import ggplot2 in your function preamble (if I am not wrong).
>
> Kind regards
> Paul
>
> ----- Mail original -----
> De: "Kevin R. Coombes" <kevin.r.coombes at gmail.com>
> ?: "r-package-devel" <r-package-devel at r-project.org>
> Envoy?: Jeudi 22 Avril 2021 22:28:55
> Objet: [R-pkg-devel] Using ggplot2 within another package
>
> Hi,
>
> I'm trying to help clean up an R package for someone else to submit to
> CRAN. He has used ggplot2 to implement a plotting function for the kinds
> of things that his packages generates. His plotting routine basically
> looks like (after changing names to protect the innocent):
>
> myPlot <- fucntion(myData, ...) {
>     # get ready
>     ggplot(myData, aes(x = myX, y = myY)) +
>        # add my decorations
>        theme_bw()
> }
>
> Of course, "R CMD check --as-cran" complains that there is no global
> binding for "myX" or "myY" since they are columns defined in the
> data.frame "myData".
>
> What is the best way to work around this issue?
>
> Of course, dinosaurs like myself might be tempted to suggest just using
> plain old "plot", so I don't need to see those suggestions.
>
> Do I just ignore the usual ggplot conventions and write "myData$myX"
> inside "aes"  in order to appease the CRAN checker? Or is there some
> tidy-er way to solve this problem?
>
> Thanks,
>    Kevin
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From edd @end|ng |rom deb|@n@org  Thu Apr 22 22:54:45 2021
From: edd @end|ng |rom deb|@n@org (Dirk Eddelbuettel)
Date: Thu, 22 Apr 2021 15:54:45 -0500
Subject: [R-pkg-devel] Using ggplot2 within another package
In-Reply-To: <b59d4e81-51aa-1f8a-975c-b1e87408d61f@gmail.com>
References: <b59d4e81-51aa-1f8a-975c-b1e87408d61f@gmail.com>
Message-ID: <24705.58005.767014.871937@rob.eddelbuettel.com>


On 22 April 2021 at 16:28, Kevin R. Coombes wrote:
| I'm trying to help clean up an R package for someone else to submit to 
| CRAN. He has used ggplot2 to implement a plotting function for the kinds 
| of things that his packages generates. His plotting routine basically 
| looks like (after changing names to protect the innocent):
| 
| myPlot <- fucntion(myData, ...) {
|  ?? # get ready
|  ?? ggplot(myData, aes(x = myX, y = myY)) +
|  ????? # add my decorations
|  ????? theme_bw()
| }
| 
| Of course, "R CMD check --as-cran" complains that there is no global 
| binding for "myX" or "myY" since they are columns defined in the 
| data.frame "myData".
| 
| What is the best way to work around this issue?

You can use the globalVariables() function to tell R about them:

   utils::globalVariables(c("myX", "myY"))

Dirk

-- 
https://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From kev|n@r@coombe@ @end|ng |rom gm@||@com  Thu Apr 22 23:19:35 2021
From: kev|n@r@coombe@ @end|ng |rom gm@||@com (Kevin R. Coombes)
Date: Thu, 22 Apr 2021 17:19:35 -0400
Subject: [R-pkg-devel] Using ggplot2 within another package
In-Reply-To: <CAJLyBTWRjGC5nk2k0q9jbna2cv-6EaYPY7m5QR+HCtEG1gF4+A@mail.gmail.com>
References: <b59d4e81-51aa-1f8a-975c-b1e87408d61f@gmail.com>
 <1286449999.9275892.1619123673948.JavaMail.zimbra@univ-fcomte.fr>
 <CAJLyBTWRjGC5nk2k0q9jbna2cv-6EaYPY7m5QR+HCtEG1gF4+A@mail.gmail.com>
Message-ID: <effee07d-f1aa-dade-dfb2-c228061d8a8a@gmail.com>

Thanks.

Obviously, long. long ago, (in a galaxy not far enough away), Paul's 
suggestion of using "aes_string" was the correct one, since "aes" uses 
non-standard evaluation. (And to quote somebody from an R fortune 
cookie, "The problem with non-standard evaluation is that it is 
non-standard.") But teh documentation at the end oft he link provided by 
Robert explivityl tells you not to do that, since "aes_string is 
deprecated".? And reading more carefully into the manual page for 
aes_string, one does indeed find the statement that the function is 
"soft deprecated". I'm not sure what that means, other than someone on 
the development team doesn't like it.

Instead, the vignette says you should
 ?? importFrom("rlang", ".data")
in your NAMESPACE, and write
 ?? ggplot(myData, aes(x = .data$myX, y = .data$myY))

And now my dinosaur question: That looks like using one non-standard 
hack to cover up the problems with another non-standard hack. Why the 
heck? is that any better for the developer than writing
 ?? ggplot(myData, aes(x = myData$myX, y = myData$myY))

or using Dirk Eddelbuettel's suggestion of calling utils::globalVariables ??

It's time to tell those kids to get off of my lawn.
 ? Kevin

On 4/22/2021 4:45 PM, Robert M. Flight wrote:
> Kevin,
>
> This vignette from ggplot2 itself gives the "officially recommended" 
> ways to avoid the warnings from R CMD check
>
> https://ggplot2.tidyverse.org/articles/ggplot2-in-packages.html 
> <https://ggplot2.tidyverse.org/articles/ggplot2-in-packages.html>
>
> Cheers,
>
> -Robert
>
> On Thu, Apr 22, 2021 at 4:39 PM Paul SAVARY 
> <paul.savary at univ-fcomte.fr <mailto:paul.savary at univ-fcomte.fr>> wrote:
>
>     Hi Kevin,
>
>     I was faced to the same problem and I used 'aes_string()' instead
>     of 'aes()'. You can then just write the name of the columns
>     containing the data to plot as character strings.
>
>     Example:
>
>     myPlot <- function(myData, ...) {
>     ? ? # get ready
>     ? ? ggplot(myData, aes_string(x = "myX", y = "myY")) +
>     ? ? ? ?# add my decorations
>     ? ? ? ?theme_bw()
>     }
>
>     It is probably already the case for your function but you need to
>     include #' @import ggplot2 in your function preamble (if I am not
>     wrong).
>
>     Kind regards
>     Paul
>
>     ----- Mail original -----
>     De: "Kevin R. Coombes" <kevin.r.coombes at gmail.com
>     <mailto:kevin.r.coombes at gmail.com>>
>     ?: "r-package-devel" <r-package-devel at r-project.org
>     <mailto:r-package-devel at r-project.org>>
>     Envoy?: Jeudi 22 Avril 2021 22:28:55
>     Objet: [R-pkg-devel] Using ggplot2 within another package
>
>     Hi,
>
>     I'm trying to help clean up an R package for someone else to
>     submit to
>     CRAN. He has used ggplot2 to implement a plotting function for the
>     kinds
>     of things that his packages generates. His plotting routine basically
>     looks like (after changing names to protect the innocent):
>
>     myPlot <- fucntion(myData, ...) {
>     ??? # get ready
>     ??? ggplot(myData, aes(x = myX, y = myY)) +
>     ?????? # add my decorations
>     ?????? theme_bw()
>     }
>
>     Of course, "R CMD check --as-cran" complains that there is no global
>     binding for "myX" or "myY" since they are columns defined in the
>     data.frame "myData".
>
>     What is the best way to work around this issue?
>
>     Of course, dinosaurs like myself might be tempted to suggest just
>     using
>     plain old "plot", so I don't need to see those suggestions.
>
>     Do I just ignore the usual ggplot conventions and write "myData$myX"
>     inside "aes"? in order to appease the CRAN checker? Or is there some
>     tidy-er way to solve this problem?
>
>     Thanks,
>     ?? Kevin
>
>     ______________________________________________
>     R-package-devel at r-project.org
>     <mailto:R-package-devel at r-project.org> mailing list
>     https://stat.ethz.ch/mailman/listinfo/r-package-devel
>     <https://stat.ethz.ch/mailman/listinfo/r-package-devel>
>
>     ______________________________________________
>     R-package-devel at r-project.org
>     <mailto:R-package-devel at r-project.org> mailing list
>     https://stat.ethz.ch/mailman/listinfo/r-package-devel
>     <https://stat.ethz.ch/mailman/listinfo/r-package-devel>
>


	[[alternative HTML version deleted]]


From bbo|ker @end|ng |rom gm@||@com  Thu Apr 22 23:27:49 2021
From: bbo|ker @end|ng |rom gm@||@com (Ben Bolker)
Date: Thu, 22 Apr 2021 17:27:49 -0400
Subject: [R-pkg-devel] Using ggplot2 within another package
In-Reply-To: <effee07d-f1aa-dade-dfb2-c228061d8a8a@gmail.com>
References: <b59d4e81-51aa-1f8a-975c-b1e87408d61f@gmail.com>
 <1286449999.9275892.1619123673948.JavaMail.zimbra@univ-fcomte.fr>
 <CAJLyBTWRjGC5nk2k0q9jbna2cv-6EaYPY7m5QR+HCtEG1gF4+A@mail.gmail.com>
 <effee07d-f1aa-dade-dfb2-c228061d8a8a@gmail.com>
Message-ID: <c493507f-4735-b5ce-5494-fefc5c9445ab@gmail.com>

   For some reason that I don't remember, an R core member once told me 
that they prefer x <- y <- NULL to utils::globalVariables(c("x","y")) - 
although I have also encountered problems with that strategy in edge cases.

  Here's an example from StackOverflow from today where for some reason 
I don't understand, evaluation of function arguments interacts with 
non-standard/lazy evaluation within a dplyr function such that 'foo' 
works while 'x$foo' doesn't ... don't know if it's a similar case.

https://stackoverflow.com/questions/67218258/getting-error-error-in-usemethodfilter-no-applicable-method-for-filter/67220198#67220198

On 4/22/21 5:19 PM, Kevin R. Coombes wrote:
> Thanks.
> 
> Obviously, long. long ago, (in a galaxy not far enough away), Paul's
> suggestion of using "aes_string" was the correct one, since "aes" uses
> non-standard evaluation. (And to quote somebody from an R fortune
> cookie, "The problem with non-standard evaluation is that it is
> non-standard.") But teh documentation at the end oft he link provided by
> Robert explivityl tells you not to do that, since "aes_string is
> deprecated".? And reading more carefully into the manual page for
> aes_string, one does indeed find the statement that the function is
> "soft deprecated". I'm not sure what that means, other than someone on
> the development team doesn't like it.
> 
> Instead, the vignette says you should
>   ?? importFrom("rlang", ".data")
> in your NAMESPACE, and write
>   ?? ggplot(myData, aes(x = .data$myX, y = .data$myY))
> 
> And now my dinosaur question: That looks like using one non-standard
> hack to cover up the problems with another non-standard hack. Why the
> heck? is that any better for the developer than writing
>   ?? ggplot(myData, aes(x = myData$myX, y = myData$myY))
> 
> or using Dirk Eddelbuettel's suggestion of calling utils::globalVariables ??
> 
> It's time to tell those kids to get off of my lawn.
>   ? Kevin
> 
> On 4/22/2021 4:45 PM, Robert M. Flight wrote:
>> Kevin,
>>
>> This vignette from ggplot2 itself gives the "officially recommended"
>> ways to avoid the warnings from R CMD check
>>
>> https://ggplot2.tidyverse.org/articles/ggplot2-in-packages.html
>> <https://ggplot2.tidyverse.org/articles/ggplot2-in-packages.html>
>>
>> Cheers,
>>
>> -Robert
>>
>> On Thu, Apr 22, 2021 at 4:39 PM Paul SAVARY
>> <paul.savary at univ-fcomte.fr <mailto:paul.savary at univ-fcomte.fr>> wrote:
>>
>>      Hi Kevin,
>>
>>      I was faced to the same problem and I used 'aes_string()' instead
>>      of 'aes()'. You can then just write the name of the columns
>>      containing the data to plot as character strings.
>>
>>      Example:
>>
>>      myPlot <- function(myData, ...) {
>>      ? ? # get ready
>>      ? ? ggplot(myData, aes_string(x = "myX", y = "myY")) +
>>      ? ? ? ?# add my decorations
>>      ? ? ? ?theme_bw()
>>      }
>>
>>      It is probably already the case for your function but you need to
>>      include #' @import ggplot2 in your function preamble (if I am not
>>      wrong).
>>
>>      Kind regards
>>      Paul
>>
>>      ----- Mail original -----
>>      De: "Kevin R. Coombes" <kevin.r.coombes at gmail.com
>>      <mailto:kevin.r.coombes at gmail.com>>
>>      ?: "r-package-devel" <r-package-devel at r-project.org
>>      <mailto:r-package-devel at r-project.org>>
>>      Envoy?: Jeudi 22 Avril 2021 22:28:55
>>      Objet: [R-pkg-devel] Using ggplot2 within another package
>>
>>      Hi,
>>
>>      I'm trying to help clean up an R package for someone else to
>>      submit to
>>      CRAN. He has used ggplot2 to implement a plotting function for the
>>      kinds
>>      of things that his packages generates. His plotting routine basically
>>      looks like (after changing names to protect the innocent):
>>
>>      myPlot <- fucntion(myData, ...) {
>>      ??? # get ready
>>      ??? ggplot(myData, aes(x = myX, y = myY)) +
>>      ?????? # add my decorations
>>      ?????? theme_bw()
>>      }
>>
>>      Of course, "R CMD check --as-cran" complains that there is no global
>>      binding for "myX" or "myY" since they are columns defined in the
>>      data.frame "myData".
>>
>>      What is the best way to work around this issue?
>>
>>      Of course, dinosaurs like myself might be tempted to suggest just
>>      using
>>      plain old "plot", so I don't need to see those suggestions.
>>
>>      Do I just ignore the usual ggplot conventions and write "myData$myX"
>>      inside "aes"? in order to appease the CRAN checker? Or is there some
>>      tidy-er way to solve this problem?
>>
>>      Thanks,
>>      ?? Kevin
>>
>>      ______________________________________________
>>      R-package-devel at r-project.org
>>      <mailto:R-package-devel at r-project.org> mailing list
>>      https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>      <https://stat.ethz.ch/mailman/listinfo/r-package-devel>
>>
>>      ______________________________________________
>>      R-package-devel at r-project.org
>>      <mailto:R-package-devel at r-project.org> mailing list
>>      https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>      <https://stat.ethz.ch/mailman/listinfo/r-package-devel>
>>
> 
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


From c@@rd|@g@bor @end|ng |rom gm@||@com  Thu Apr 22 23:58:00 2021
From: c@@rd|@g@bor @end|ng |rom gm@||@com (=?UTF-8?B?R8OhYm9yIENzw6FyZGk=?=)
Date: Thu, 22 Apr 2021 23:58:00 +0200
Subject: [R-pkg-devel] Using ggplot2 within another package
In-Reply-To: <effee07d-f1aa-dade-dfb2-c228061d8a8a@gmail.com>
References: <b59d4e81-51aa-1f8a-975c-b1e87408d61f@gmail.com>
 <1286449999.9275892.1619123673948.JavaMail.zimbra@univ-fcomte.fr>
 <CAJLyBTWRjGC5nk2k0q9jbna2cv-6EaYPY7m5QR+HCtEG1gF4+A@mail.gmail.com>
 <effee07d-f1aa-dade-dfb2-c228061d8a8a@gmail.com>
Message-ID: <CABtg=KnUCbSvJCM8ABurfre85v2TUJQNDTLvdNeJdp0VeKMdqQ@mail.gmail.com>

On Thu, Apr 22, 2021 at 11:19 PM Kevin R. Coombes
<kevin.r.coombes at gmail.com> wrote:
[...]
> Instead, the vignette says you should
>     importFrom("rlang", ".data")
> in your NAMESPACE, and write
>     ggplot(myData, aes(x = .data$myX, y = .data$myY))
>
> And now my dinosaur question: That looks like using one non-standard
> hack to cover up the problems with another non-standard hack. Why the
> heck  is that any better for the developer than writing
>     ggplot(myData, aes(x = myData$myX, y = myData$myY))

Well, for one, because it does not always work, see e.g. the examples
and links here:
https://github.com/tidyverse/ggplot2/issues/2693

> or using Dirk Eddelbuettel's suggestion of calling utils::globalVariables ??

Because if you refer to a hundred different columns in your plots, then
you'll need to add all of them to globalVariables(), and this is error prone
and cumbersome to update. If you only refer a handful of columns, then sure,
this will work as well.

Gabor

[...]


From m|co||yer @end|ng |rom gm@||@com  Thu Apr 22 22:47:56 2021
From: m|co||yer @end|ng |rom gm@||@com (Mike Collyer)
Date: Thu, 22 Apr 2021 16:47:56 -0400
Subject: [R-pkg-devel] Using ggplot2 within another package
In-Reply-To: <b59d4e81-51aa-1f8a-975c-b1e87408d61f@gmail.com>
References: <b59d4e81-51aa-1f8a-975c-b1e87408d61f@gmail.com>
Message-ID: <E32C86C0-4BC4-43EC-A5C2-D0BC0B7AFE44@gmail.com>

Hi Kevin,

I recently developed a plot function in a package that used ggplot and ran into the same problem.  I overcame the problem with a first line of (useless) code as

myX <- myY <- NULL

I found the solution inelegant but it worked.

cheers!
Mike

> On Apr 22, 2021, at 4:28 PM, Kevin R. Coombes <kevin.r.coombes at gmail.com> wrote:
> 
> Hi,
> 
> I'm trying to help clean up an R package for someone else to submit to CRAN. He has used ggplot2 to implement a plotting function for the kinds of things that his packages generates. His plotting routine basically looks like (after changing names to protect the innocent):
> 
> myPlot <- fucntion(myData, ...) {
>    # get ready
>    ggplot(myData, aes(x = myX, y = myY)) +
>       # add my decorations
>       theme_bw()
> }
> 
> Of course, "R CMD check --as-cran" complains that there is no global binding for "myX" or "myY" since they are columns defined in the data.frame "myData".
> 
> What is the best way to work around this issue?
> 
> Of course, dinosaurs like myself might be tempted to suggest just using plain old "plot", so I don't need to see those suggestions.
> 
> Do I just ignore the usual ggplot conventions and write "myData$myX" inside "aes"  in order to appease the CRAN checker? Or is there some tidy-er way to solve this problem?
> 
> Thanks,
>   Kevin
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From t|@goo||voto @end|ng |rom gm@||@com  Fri Apr 23 17:13:44 2021
From: t|@goo||voto @end|ng |rom gm@||@com (Tiago Olivoto)
Date: Fri, 23 Apr 2021 12:13:44 -0300
Subject: [R-pkg-devel] Using ggplot2 within another package
In-Reply-To: <E32C86C0-4BC4-43EC-A5C2-D0BC0B7AFE44@gmail.com>
References: <b59d4e81-51aa-1f8a-975c-b1e87408d61f@gmail.com>
 <E32C86C0-4BC4-43EC-A5C2-D0BC0B7AFE44@gmail.com>
Message-ID: <CAMyz+tXhttMZBJrnRVq8+ep7hui2_q+mM8KVwzasKNurdah5fw@mail.gmail.com>

Hi everyone,
One suggestion would be import ggplot2 and using tidy eval operators to
create a function. One simple reproducible example would be

library(ggplot2)
my_hist <- function(df, var){
  ggplot(df, aes({{var}})) +
    geom_histogram()
}

df <- data.frame(my_var = rnorm(400, 10, 2))
my_hist(df = df, var = my_var)

All the best
Tiago

Em sex., 23 de abr. de 2021 ?s 09:04, Mike Collyer <mlcollyer at gmail.com>
escreveu:

> Hi Kevin,
>
> I recently developed a plot function in a package that used ggplot and ran
> into the same problem.  I overcame the problem with a first line of
> (useless) code as
>
> myX <- myY <- NULL
>
> I found the solution inelegant but it worked.
>
> cheers!
> Mike
>
> > On Apr 22, 2021, at 4:28 PM, Kevin R. Coombes <kevin.r.coombes at gmail.com>
> wrote:
> >
> > Hi,
> >
> > I'm trying to help clean up an R package for someone else to submit to
> CRAN. He has used ggplot2 to implement a plotting function for the kinds of
> things that his packages generates. His plotting routine basically looks
> like (after changing names to protect the innocent):
> >
> > myPlot <- fucntion(myData, ...) {
> >    # get ready
> >    ggplot(myData, aes(x = myX, y = myY)) +
> >       # add my decorations
> >       theme_bw()
> > }
> >
> > Of course, "R CMD check --as-cran" complains that there is no global
> binding for "myX" or "myY" since they are columns defined in the data.frame
> "myData".
> >
> > What is the best way to work around this issue?
> >
> > Of course, dinosaurs like myself might be tempted to suggest just using
> plain old "plot", so I don't need to see those suggestions.
> >
> > Do I just ignore the usual ggplot conventions and write "myData$myX"
> inside "aes"  in order to appease the CRAN checker? Or is there some
> tidy-er way to solve this problem?
> >
> > Thanks,
> >   Kevin
> >
> > ______________________________________________
> > R-package-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-package-devel
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From t@tu@rt @end|ng |rom nygenome@org  Fri Apr 23 19:17:41 2021
From: t@tu@rt @end|ng |rom nygenome@org (Tim Stuart)
Date: Fri, 23 Apr 2021 13:17:41 -0400
Subject: [R-pkg-devel] Package fails to build on CRAN Windows server:
 rtracklayer version too new
In-Reply-To: <CAFDcVCQ3QT=5sYqVa_giaBzsonyEni8MdwqfuSutt_r9Z5hCQA@mail.gmail.com>
References: <CAKT0KkevvP-7Z1oLbZNtYryzeh=zqNocNAxVUbEzqjnUOuGnoA@mail.gmail.com>
 <CAFDcVCQ3QT=5sYqVa_giaBzsonyEni8MdwqfuSutt_r9Z5hCQA@mail.gmail.com>
Message-ID: <CAKT0KkfMkZv-Yp5r=Unyh6hPrmWDYEHN8eHdT9O-9e7Fj+ppKg@mail.gmail.com>

Hi Henrik,

Thanks for your explanation, that does indeed make sense. I will try
to track down the bioc package dependency that's setting the explicit
rtracklayer version dependency and go from there...

The fact that Bioconductor allows packages to be released without
successfully building on Windows does create some interesting
downstream issues for CRAN packages with bioc dependencies, and raises
a larger question for me about whether I should really host this
package on CRAN or if I should try to move it to Bioconductor.

Anyway, thanks again for your help (also I'm a big fan of your future package)

Cheers,
Tim


On Mon, Apr 19, 2021 at 9:47 PM Henrik Bengtsson
<henrik.bengtsson at gmail.com> wrote:
>
> Not that it solves your problem per se, but here's what I think CRAN
> only has rtracklayer 1.48.0 installed on WIndows, i.e. why you get
> error "namespace 'rtracklayer' 1.48.0 is being loaded, but >= 1.51.5
> is required.":
>
> * The current Bioconductor "release" is version 3.12
> * As you say, Bioconductor 3.12 provides rtracklayer 1.50.0
> (https://www.bioconductor.org/packages/3.12/bioc/html/rtracklayer.html)
> * However, if you look at that page, for Windows it only provides
> rtracklayer 1.49.5 (this is because rtracklayer never successfully
> checked on Bioconductor 3.12)
> * Since the minor version component of rtracklayer 1.49.5 is _odd_, it
> means it's from a Bioconductor 'devel' branch, i.e. when Bioconductor
> 3.12 was in devel.
> * Thus, the most recent Bioconductor "release" where rtracklayer was
> successfully distributed on Windows is Bioconductor 3.11.
> * Bioconductor 3.11 provides rtracklayer 1.48.0
> (https://www.bioconductor.org/packages/3.11/bioc/html/rtracklayer.html)
>
> Clear as mud?
>
> I suspect you're using Suggest: rtracklayer
> (https://github.com/timoast/signac/blob/develop/DESCRIPTION) in your
> new version.  If so, that's good.  I also don't think you're doing
> anything wrong here.  Instead, I think it's one of your other
> Bioconductor dependencies under 'Imports:', or possibly under
> 'Suggests:', that depend on 'rtracklayer'.  The fact that error says
> "namespace 'rtracklayer' 1.48.0 is being loaded, but >= 1.51.5 is
> required.", means that one of those Bioconductor dependencies, or
> their dependencies, has an explicit 'rtracklayer (>= 1.51.5)' under
> either Depends: or Imports:.  My recommendation is that you start
> identifying that Bioconductor package, and in what way your 'Signac'
> depends on that package.  That will help you decide on what to do
> next.
>
> /Henrik
>
> PS. This can happen because Bioconductor allows a package to propagate
> to a new "release" branch even if it fails on one of the operating
> systems.
>
> On Fri, Apr 16, 2021 at 1:59 PM Tim Stuart <tstuart at nygenome.org> wrote:
> >
> > Hi all,
> >
> > I am trying to submit an update to my package
> > (https://cran.r-project.org/package=Signac) to CRAN, but it is
> > currently failing to install on the Windows server. I see the
> > following installation error: "namespace 'rtracklayer' 1.48.0 is being
> > loaded, but >= 1.51.5 is required."
> >
> > The current release version for rtracklayer is 1.50.0
> > (https://www.bioconductor.org/packages/release/bioc/html/rtracklayer.html).
> > My package does not set a version requirement for rtracklayer, so this
> > installation error must be caused by having a pre-release version of
> > one of my bioconductor dependencies installed on the windows server.
> >
> > Does anyone know how I might be able to solve this issue? I have tried
> > contacting the CRAN team a few times by reply-all to the CRAN emails,
> > but have not had any response from them. This seems like an issue that
> > could only be solved by fixing the installation of packages on the
> > CRAN Windows server.
> >
> > Incoming test results:
> > https://win-builder.r-project.org/incoming_pretest/Signac_1.1.2_20210415_225235/
> >
> > Thanks,
> > Tim
> >
> > --
> >
> > This message is for the recipient?s use only, and may contain
> > confidential, privileged or protected information. Any unauthorized use or
> > dissemination of this communication is prohibited. If you received this
> > message in error, please immediately notify the sender and destroy all
> > copies of this message. The recipient should check this email and any
> > attachments for the presence of viruses, as we accept no liability for any
> > damage caused by any virus transmitted by this email.
> >
> > ______________________________________________
> > R-package-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-package-devel

-- 

This message is for the recipient?s use only, and may contain 
confidential, privileged or protected information. Any unauthorized use or 
dissemination of this communication is prohibited. If you received this 
message in error, please immediately notify the sender and destroy all 
copies of this message. The recipient should check this email and any 
attachments for the presence of viruses, as we accept no liability for any 
damage caused by any virus transmitted by this email.


From m@ech|er @end|ng |rom @t@t@m@th@ethz@ch  Sat Apr 24 15:18:23 2021
From: m@ech|er @end|ng |rom @t@t@m@th@ethz@ch (Martin Maechler)
Date: Sat, 24 Apr 2021 15:18:23 +0200
Subject: [R-pkg-devel] Using ggplot2 within another package
In-Reply-To: <c493507f-4735-b5ce-5494-fefc5c9445ab@gmail.com>
References: <b59d4e81-51aa-1f8a-975c-b1e87408d61f@gmail.com>
 <1286449999.9275892.1619123673948.JavaMail.zimbra@univ-fcomte.fr>
 <CAJLyBTWRjGC5nk2k0q9jbna2cv-6EaYPY7m5QR+HCtEG1gF4+A@mail.gmail.com>
 <effee07d-f1aa-dade-dfb2-c228061d8a8a@gmail.com>
 <c493507f-4735-b5ce-5494-fefc5c9445ab@gmail.com>
Message-ID: <24708.6815.361687.206681@stat.math.ethz.ch>

>>>>> Ben Bolker 
>>>>>     on Thu, 22 Apr 2021 17:27:49 -0400 writes:

    > For some reason that I don't remember, an R core member once told me 
    > that they prefer x <- y <- NULL to utils::globalVariables(c("x","y")) - 

That could have been me.  Even though I think I still have some
globalVariables() statements in some of my package sources, I've
decided that it *harms* really, notably for relatively common variable names such
as "x":   It declares them "global"
{ for the purpose of codetools::globalVariables() } everywhere,
i.e. for all functions in the package namespace and that
basically kills the reliability of  globalVariables() checking
for the whole package.


    > although I have also encountered problems with that strategy in edge cases.

well, when?

    > Here's an example from StackOverflow from today where for some reason 
    > I don't understand, evaluation of function arguments interacts with 
    > non-standard/lazy evaluation within a dplyr function such that 'foo' 
    > works while 'x$foo' doesn't ... don't know if it's a similar case.

    > https://stackoverflow.com/questions/67218258/getting-error-error-in-usemethodfilter-no-applicable-method-for-filter/67220198#67220198


{ ceterum censeo ... to use NSE (non-standard-evaluation) for
  user convenience and to call this (together with really good
  ideas)  "tidy" has been one of the biggest euphemisms in the history of
  statistical computing ...  but yes, that's just my personal opinon  }

    > On 4/22/21 5:19 PM, Kevin R. Coombes wrote:
    >> Thanks.
    >> 
    >> Obviously, long. long ago, (in a galaxy not far enough away), Paul's
    >> suggestion of using "aes_string" was the correct one, since "aes" uses
    >> non-standard evaluation. (And to quote somebody from an R fortune
    >> cookie, "The problem with non-standard evaluation is that it is
    >> non-standard.") But teh documentation at the end oft he link provided by
    >> Robert explivityl tells you not to do that, since "aes_string is
    >> deprecated".? And reading more carefully into the manual page for
    >> aes_string, one does indeed find the statement that the function is
    >> "soft deprecated". I'm not sure what that means, other than someone on
    >> the development team doesn't like it.
    >> 
    >> Instead, the vignette says you should
    >> ?? importFrom("rlang", ".data")
    >> in your NAMESPACE, and write
    >> ?? ggplot(myData, aes(x = .data$myX, y = .data$myY))
    >> 
    >> And now my dinosaur question: That looks like using one non-standard
    >> hack to cover up the problems with another non-standard hack. Why the
    >> heck? is that any better for the developer than writing
    >> ?? ggplot(myData, aes(x = myData$myX, y = myData$myY))
    >> 
    >> or using Dirk Eddelbuettel's suggestion of calling utils::globalVariables ??
    >> 
    >> It's time to tell those kids to get off of my lawn.
    >> ? Kevin
    >> 
    >> On 4/22/2021 4:45 PM, Robert M. Flight wrote:
    >>> Kevin,
    >>> 
    >>> This vignette from ggplot2 itself gives the "officially recommended"
    >>> ways to avoid the warnings from R CMD check
    >>> 
    >>> https://ggplot2.tidyverse.org/articles/ggplot2-in-packages.html
    >>> <https://ggplot2.tidyverse.org/articles/ggplot2-in-packages.html>
    >>> 
    >>> Cheers,
    >>> 
    >>> -Robert
    >>> 
    >>> On Thu, Apr 22, 2021 at 4:39 PM Paul SAVARY
    >>> <paul.savary at univ-fcomte.fr <mailto:paul.savary at univ-fcomte.fr>> wrote:
    >>> 
    >>> Hi Kevin,
    >>> 
    >>> I was faced to the same problem and I used 'aes_string()' instead
    >>> of 'aes()'. You can then just write the name of the columns
    >>> containing the data to plot as character strings.
    >>> 
    >>> Example:
    >>> 
    >>> myPlot <- function(myData, ...) {
    >>> ? ? # get ready
    >>> ? ? ggplot(myData, aes_string(x = "myX", y = "myY")) +
    >>> ? ? ? ?# add my decorations
    >>> ? ? ? ?theme_bw()
    >>> }
    >>> 
    >>> It is probably already the case for your function but you need to
    >>> include #' @import ggplot2 in your function preamble (if I am not
    >>> wrong).
    >>> 
    >>> Kind regards
    >>> Paul
    >>> 
    >>> ----- Mail original -----
    >>> De: "Kevin R. Coombes" <kevin.r.coombes at gmail.com
    >>> <mailto:kevin.r.coombes at gmail.com>>
    >>> ?: "r-package-devel" <r-package-devel at r-project.org
    >>> <mailto:r-package-devel at r-project.org>>
    >>> Envoy?: Jeudi 22 Avril 2021 22:28:55
    >>> Objet: [R-pkg-devel] Using ggplot2 within another package
    >>> 
    >>> Hi,
    >>> 
    >>> I'm trying to help clean up an R package for someone else to
    >>> submit to
    >>> CRAN. He has used ggplot2 to implement a plotting function for the
    >>> kinds
    >>> of things that his packages generates. His plotting routine basically
    >>> looks like (after changing names to protect the innocent):
    >>> 
    >>> myPlot <- fucntion(myData, ...) {
    >>> ??? # get ready
    >>> ??? ggplot(myData, aes(x = myX, y = myY)) +
    >>> ?????? # add my decorations
    >>> ?????? theme_bw()
    >>> }
    >>> 
    >>> Of course, "R CMD check --as-cran" complains that there is no global
    >>> binding for "myX" or "myY" since they are columns defined in the
    >>> data.frame "myData".
    >>> 
    >>> What is the best way to work around this issue?
    >>> 
    >>> Of course, dinosaurs like myself might be tempted to suggest just
    >>> using
    >>> plain old "plot", so I don't need to see those suggestions.
    >>> 
    >>> Do I just ignore the usual ggplot conventions and write "myData$myX"
    >>> inside "aes"? in order to appease the CRAN checker? Or is there some
    >>> tidy-er way to solve this problem?
    >>> 
    >>> Thanks,
    >>> ?? Kevin
    >>> 
    >>> ______________________________________________
    >>> R-package-devel at r-project.org
    >>> <mailto:R-package-devel at r-project.org> mailing list
    >>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
    >>> <https://stat.ethz.ch/mailman/listinfo/r-package-devel>
    >>> 
    >>> ______________________________________________
    >>> R-package-devel at r-project.org
    >>> <mailto:R-package-devel at r-project.org> mailing list
    >>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
    >>> <https://stat.ethz.ch/mailman/listinfo/r-package-devel>
    >>> 
    >> 
    >> 
    >> [[alternative HTML version deleted]]
    >> 
    >> ______________________________________________
    >> R-package-devel at r-project.org mailing list
    >> https://stat.ethz.ch/mailman/listinfo/r-package-devel
    >> 

    > ______________________________________________
    > R-package-devel at r-project.org mailing list
    > https://stat.ethz.ch/mailman/listinfo/r-package-devel


From w||||@mwdun|@p @end|ng |rom gm@||@com  Sat Apr 24 22:56:39 2021
From: w||||@mwdun|@p @end|ng |rom gm@||@com (Bill Dunlap)
Date: Sat, 24 Apr 2021 13:56:39 -0700
Subject: [R-pkg-devel] Using ggplot2 within another package
In-Reply-To: <24708.6815.361687.206681@stat.math.ethz.ch>
References: <b59d4e81-51aa-1f8a-975c-b1e87408d61f@gmail.com>
 <1286449999.9275892.1619123673948.JavaMail.zimbra@univ-fcomte.fr>
 <CAJLyBTWRjGC5nk2k0q9jbna2cv-6EaYPY7m5QR+HCtEG1gF4+A@mail.gmail.com>
 <effee07d-f1aa-dade-dfb2-c228061d8a8a@gmail.com>
 <c493507f-4735-b5ce-5494-fefc5c9445ab@gmail.com>
 <24708.6815.361687.206681@stat.math.ethz.ch>
Message-ID: <CAHqSRuSOon4-Z7nDcPtQCnj1Xo8CG0yJA2bwg00JDeR6PMJHUA@mail.gmail.com>

Has there been any thought given to an alternative to globalVariables that
would flag certain arguments to certain functions as being evaluated in a
non-standard way.  E.g.,
    usesNSE(FUN="with.default", ARGUMENTS="expr")
    usesNSE(FUN="lm", ARGUMENTS=c("weights","subset","offset"))
    usesNSE(FUN="~") # missing ARGUMENTS means all args are NSE
This information would be stored in the environment that contains FUN.

-Bill

On Sat, Apr 24, 2021 at 6:18 AM Martin Maechler <maechler at stat.math.ethz.ch>
wrote:

> >>>>> Ben Bolker
> >>>>>     on Thu, 22 Apr 2021 17:27:49 -0400 writes:
>
>     > For some reason that I don't remember, an R core member once told me
>     > that they prefer x <- y <- NULL to
> utils::globalVariables(c("x","y")) -
>
> That could have been me.  Even though I think I still have some
> globalVariables() statements in some of my package sources, I've
> decided that it *harms* really, notably for relatively common variable
> names such
> as "x":   It declares them "global"
> { for the purpose of codetools::globalVariables() } everywhere,
> i.e. for all functions in the package namespace and that
> basically kills the reliability of  globalVariables() checking
> for the whole package.
>
>
>     > although I have also encountered problems with that strategy in edge
> cases.
>
> well, when?
>
>     > Here's an example from StackOverflow from today where for some
> reason
>     > I don't understand, evaluation of function arguments interacts with
>     > non-standard/lazy evaluation within a dplyr function such that 'foo'
>     > works while 'x$foo' doesn't ... don't know if it's a similar case.
>
>     >
> https://stackoverflow.com/questions/67218258/getting-error-error-in-usemethodfilter-no-applicable-method-for-filter/67220198#67220198
>
>
> { ceterum censeo ... to use NSE (non-standard-evaluation) for
>   user convenience and to call this (together with really good
>   ideas)  "tidy" has been one of the biggest euphemisms in the history of
>   statistical computing ...  but yes, that's just my personal opinon  }
>
>     > On 4/22/21 5:19 PM, Kevin R. Coombes wrote:
>     >> Thanks.
>     >>
>     >> Obviously, long. long ago, (in a galaxy not far enough away), Paul's
>     >> suggestion of using "aes_string" was the correct one, since "aes"
> uses
>     >> non-standard evaluation. (And to quote somebody from an R fortune
>     >> cookie, "The problem with non-standard evaluation is that it is
>     >> non-standard.") But teh documentation at the end oft he link
> provided by
>     >> Robert explivityl tells you not to do that, since "aes_string is
>     >> deprecated".  And reading more carefully into the manual page for
>     >> aes_string, one does indeed find the statement that the function is
>     >> "soft deprecated". I'm not sure what that means, other than someone
> on
>     >> the development team doesn't like it.
>     >>
>     >> Instead, the vignette says you should
>     >>    importFrom("rlang", ".data")
>     >> in your NAMESPACE, and write
>     >>    ggplot(myData, aes(x = .data$myX, y = .data$myY))
>     >>
>     >> And now my dinosaur question: That looks like using one non-standard
>     >> hack to cover up the problems with another non-standard hack. Why
> the
>     >> heck  is that any better for the developer than writing
>     >>    ggplot(myData, aes(x = myData$myX, y = myData$myY))
>     >>
>     >> or using Dirk Eddelbuettel's suggestion of calling
> utils::globalVariables ??
>     >>
>     >> It's time to tell those kids to get off of my lawn.
>     >>   Kevin
>     >>
>     >> On 4/22/2021 4:45 PM, Robert M. Flight wrote:
>     >>> Kevin,
>     >>>
>     >>> This vignette from ggplot2 itself gives the "officially
> recommended"
>     >>> ways to avoid the warnings from R CMD check
>     >>>
>     >>> https://ggplot2.tidyverse.org/articles/ggplot2-in-packages.html
>     >>> <https://ggplot2.tidyverse.org/articles/ggplot2-in-packages.html>
>     >>>
>     >>> Cheers,
>     >>>
>     >>> -Robert
>     >>>
>     >>> On Thu, Apr 22, 2021 at 4:39 PM Paul SAVARY
>     >>> <paul.savary at univ-fcomte.fr <mailto:paul.savary at univ-fcomte.fr>>
> wrote:
>     >>>
>     >>> Hi Kevin,
>     >>>
>     >>> I was faced to the same problem and I used 'aes_string()' instead
>     >>> of 'aes()'. You can then just write the name of the columns
>     >>> containing the data to plot as character strings.
>     >>>
>     >>> Example:
>     >>>
>     >>> myPlot <- function(myData, ...) {
>     >>>     # get ready
>     >>>     ggplot(myData, aes_string(x = "myX", y = "myY")) +
>     >>>        # add my decorations
>     >>>        theme_bw()
>     >>> }
>     >>>
>     >>> It is probably already the case for your function but you need to
>     >>> include #' @import ggplot2 in your function preamble (if I am not
>     >>> wrong).
>     >>>
>     >>> Kind regards
>     >>> Paul
>     >>>
>     >>> ----- Mail original -----
>     >>> De: "Kevin R. Coombes" <kevin.r.coombes at gmail.com
>     >>> <mailto:kevin.r.coombes at gmail.com>>
>     >>> ?: "r-package-devel" <r-package-devel at r-project.org
>     >>> <mailto:r-package-devel at r-project.org>>
>     >>> Envoy?: Jeudi 22 Avril 2021 22:28:55
>     >>> Objet: [R-pkg-devel] Using ggplot2 within another package
>     >>>
>     >>> Hi,
>     >>>
>     >>> I'm trying to help clean up an R package for someone else to
>     >>> submit to
>     >>> CRAN. He has used ggplot2 to implement a plotting function for the
>     >>> kinds
>     >>> of things that his packages generates. His plotting routine
> basically
>     >>> looks like (after changing names to protect the innocent):
>     >>>
>     >>> myPlot <- fucntion(myData, ...) {
>     >>>     # get ready
>     >>>     ggplot(myData, aes(x = myX, y = myY)) +
>     >>>        # add my decorations
>     >>>        theme_bw()
>     >>> }
>     >>>
>     >>> Of course, "R CMD check --as-cran" complains that there is no
> global
>     >>> binding for "myX" or "myY" since they are columns defined in the
>     >>> data.frame "myData".
>     >>>
>     >>> What is the best way to work around this issue?
>     >>>
>     >>> Of course, dinosaurs like myself might be tempted to suggest just
>     >>> using
>     >>> plain old "plot", so I don't need to see those suggestions.
>     >>>
>     >>> Do I just ignore the usual ggplot conventions and write
> "myData$myX"
>     >>> inside "aes"  in order to appease the CRAN checker? Or is there
> some
>     >>> tidy-er way to solve this problem?
>     >>>
>     >>> Thanks,
>     >>>    Kevin
>     >>>
>     >>> ______________________________________________
>     >>> R-package-devel at r-project.org
>     >>> <mailto:R-package-devel at r-project.org> mailing list
>     >>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>     >>> <https://stat.ethz.ch/mailman/listinfo/r-package-devel>
>     >>>
>     >>> ______________________________________________
>     >>> R-package-devel at r-project.org
>     >>> <mailto:R-package-devel at r-project.org> mailing list
>     >>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>     >>> <https://stat.ethz.ch/mailman/listinfo/r-package-devel>
>     >>>
>     >>
>     >>
>     >> [[alternative HTML version deleted]]
>     >>
>     >> ______________________________________________
>     >> R-package-devel at r-project.org mailing list
>     >> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>     >>
>
>     > ______________________________________________
>     > R-package-devel at r-project.org mailing list
>     > https://stat.ethz.ch/mailman/listinfo/r-package-devel
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From bbo|ker @end|ng |rom gm@||@com  Sun Apr 25 00:34:17 2021
From: bbo|ker @end|ng |rom gm@||@com (Ben Bolker)
Date: Sat, 24 Apr 2021 18:34:17 -0400
Subject: [R-pkg-devel] Using ggplot2 within another package
In-Reply-To: <CAHqSRuSOon4-Z7nDcPtQCnj1Xo8CG0yJA2bwg00JDeR6PMJHUA@mail.gmail.com>
References: <b59d4e81-51aa-1f8a-975c-b1e87408d61f@gmail.com>
 <1286449999.9275892.1619123673948.JavaMail.zimbra@univ-fcomte.fr>
 <CAJLyBTWRjGC5nk2k0q9jbna2cv-6EaYPY7m5QR+HCtEG1gF4+A@mail.gmail.com>
 <effee07d-f1aa-dade-dfb2-c228061d8a8a@gmail.com>
 <c493507f-4735-b5ce-5494-fefc5c9445ab@gmail.com>
 <24708.6815.361687.206681@stat.math.ethz.ch>
 <CAHqSRuSOon4-Z7nDcPtQCnj1Xo8CG0yJA2bwg00JDeR6PMJHUA@mail.gmail.com>
Message-ID: <6e0b0690-3537-53b1-2089-1b0e4fb9231c@gmail.com>

   It seems that what we need is really ignoreLocalVariables() rather 
than globalVariables() ... ?

On 4/24/21 4:56 PM, Bill Dunlap wrote:
> Has there been any thought given to an alternative to globalVariables 
> that would flag certain arguments to certain functions as being 
> evaluated in a non-standard way.? E.g.,
>  ? ? usesNSE(FUN="with.default", ARGUMENTS="expr")
>  ? ? usesNSE(FUN="lm", ARGUMENTS=c("weights","subset","offset"))
>  ? ? usesNSE(FUN="~") # missing ARGUMENTS means all args are NSE
> This information would be stored in the environment that contains FUN.
> 
> -Bill
> 
> On Sat, Apr 24, 2021 at 6:18 AM Martin Maechler 
> <maechler at stat.math.ethz.ch <mailto:maechler at stat.math.ethz.ch>> wrote:
> 
>      >>>>> Ben Bolker
>      >>>>>? ? ?on Thu, 22 Apr 2021 17:27:49 -0400 writes:
> 
>      ? ? > For some reason that I don't remember, an R core member once
>     told me
>      ? ? > that they prefer x <- y <- NULL to
>     utils::globalVariables(c("x","y")) -
> 
>     That could have been me.? Even though I think I still have some
>     globalVariables() statements in some of my package sources, I've
>     decided that it *harms* really, notably for relatively common
>     variable names such
>     as "x":? ?It declares them "global"
>     { for the purpose of codetools::globalVariables() } everywhere,
>     i.e. for all functions in the package namespace and that
>     basically kills the reliability of? globalVariables() checking
>     for the whole package.
> 
> 
>      ? ? > although I have also encountered problems with that strategy
>     in edge cases.
> 
>     well, when?

   Honestly, I don't remember. Something with order of evaluation and 
the fact that a variable existed and was set to NULL in the package 
namespace screwing things up.

> 
>      ? ? > Here's an example from StackOverflow from today where for
>     some reason
>      ? ? > I don't understand, evaluation of function arguments
>     interacts with
>      ? ? > non-standard/lazy evaluation within a dplyr function such
>     that 'foo'
>      ? ? > works while 'x$foo' doesn't ... don't know if it's a similar
>     case.
> 
>      ? ? >
>     https://stackoverflow.com/questions/67218258/getting-error-error-in-usemethodfilter-no-applicable-method-for-filter/67220198#67220198
>     <https://stackoverflow.com/questions/67218258/getting-error-error-in-usemethodfilter-no-applicable-method-for-filter/67220198#67220198>
> 
> 
>     { ceterum censeo ... to use NSE (non-standard-evaluation) for
>      ? user convenience and to call this (together with really good
>      ? ideas)? "tidy" has been one of the biggest euphemisms in the
>     history of
>      ? statistical computing ...? but yes, that's just my personal opinon? }
> 
>      ? ? > On 4/22/21 5:19 PM, Kevin R. Coombes wrote:
>      ? ? >> Thanks.
>      ? ? >>
>      ? ? >> Obviously, long. long ago, (in a galaxy not far enough
>     away), Paul's
>      ? ? >> suggestion of using "aes_string" was the correct one, since
>     "aes" uses
>      ? ? >> non-standard evaluation. (And to quote somebody from an R
>     fortune
>      ? ? >> cookie, "The problem with non-standard evaluation is that it is
>      ? ? >> non-standard.") But teh documentation at the end oft he link
>     provided by
>      ? ? >> Robert explivityl tells you not to do that, since "aes_string is
>      ? ? >> deprecated".? And reading more carefully into the manual
>     page for
>      ? ? >> aes_string, one does indeed find the statement that the
>     function is
>      ? ? >> "soft deprecated". I'm not sure what that means, other than
>     someone on
>      ? ? >> the development team doesn't like it.
>      ? ? >>
>      ? ? >> Instead, the vignette says you should
>      ? ? >> ?? importFrom("rlang", ".data")
>      ? ? >> in your NAMESPACE, and write
>      ? ? >> ?? ggplot(myData, aes(x = .data$myX, y = .data$myY))
>      ? ? >>
>      ? ? >> And now my dinosaur question: That looks like using one
>     non-standard
>      ? ? >> hack to cover up the problems with another non-standard
>     hack. Why the
>      ? ? >> heck? is that any better for the developer than writing
>      ? ? >> ?? ggplot(myData, aes(x = myData$myX, y = myData$myY))
>      ? ? >>
>      ? ? >> or using Dirk Eddelbuettel's suggestion of calling
>     utils::globalVariables ??
>      ? ? >>
>      ? ? >> It's time to tell those kids to get off of my lawn.
>      ? ? >> ? Kevin
>      ? ? >>
>      ? ? >> On 4/22/2021 4:45 PM, Robert M. Flight wrote:
>      ? ? >>> Kevin,
>      ? ? >>>
>      ? ? >>> This vignette from ggplot2 itself gives the "officially
>     recommended"
>      ? ? >>> ways to avoid the warnings from R CMD check
>      ? ? >>>
>      ? ? >>>
>     https://ggplot2.tidyverse.org/articles/ggplot2-in-packages.html
>     <https://ggplot2.tidyverse.org/articles/ggplot2-in-packages.html>
>      ? ? >>>
>     <https://ggplot2.tidyverse.org/articles/ggplot2-in-packages.html
>     <https://ggplot2.tidyverse.org/articles/ggplot2-in-packages.html>>
>      ? ? >>>
>      ? ? >>> Cheers,
>      ? ? >>>
>      ? ? >>> -Robert
>      ? ? >>>
>      ? ? >>> On Thu, Apr 22, 2021 at 4:39 PM Paul SAVARY
>      ? ? >>> <paul.savary at univ-fcomte.fr
>     <mailto:paul.savary at univ-fcomte.fr>
>     <mailto:paul.savary at univ-fcomte.fr
>     <mailto:paul.savary at univ-fcomte.fr>>> wrote:
>      ? ? >>>
>      ? ? >>> Hi Kevin,
>      ? ? >>>
>      ? ? >>> I was faced to the same problem and I used 'aes_string()'
>     instead
>      ? ? >>> of 'aes()'. You can then just write the name of the columns
>      ? ? >>> containing the data to plot as character strings.
>      ? ? >>>
>      ? ? >>> Example:
>      ? ? >>>
>      ? ? >>> myPlot <- function(myData, ...) {
>      ? ? >>> ? ? # get ready
>      ? ? >>> ? ? ggplot(myData, aes_string(x = "myX", y = "myY")) +
>      ? ? >>> ? ? ? ?# add my decorations
>      ? ? >>> ? ? ? ?theme_bw()
>      ? ? >>> }
>      ? ? >>>
>      ? ? >>> It is probably already the case for your function but you
>     need to
>      ? ? >>> include #' @import ggplot2 in your function preamble (if I
>     am not
>      ? ? >>> wrong).
>      ? ? >>>
>      ? ? >>> Kind regards
>      ? ? >>> Paul
>      ? ? >>>
>      ? ? >>> ----- Mail original -----
>      ? ? >>> De: "Kevin R. Coombes" <kevin.r.coombes at gmail.com
>     <mailto:kevin.r.coombes at gmail.com>
>      ? ? >>> <mailto:kevin.r.coombes at gmail.com
>     <mailto:kevin.r.coombes at gmail.com>>>
>      ? ? >>> ?: "r-package-devel" <r-package-devel at r-project.org
>     <mailto:r-package-devel at r-project.org>
>      ? ? >>> <mailto:r-package-devel at r-project.org
>     <mailto:r-package-devel at r-project.org>>>
>      ? ? >>> Envoy?: Jeudi 22 Avril 2021 22:28:55
>      ? ? >>> Objet: [R-pkg-devel] Using ggplot2 within another package
>      ? ? >>>
>      ? ? >>> Hi,
>      ? ? >>>
>      ? ? >>> I'm trying to help clean up an R package for someone else to
>      ? ? >>> submit to
>      ? ? >>> CRAN. He has used ggplot2 to implement a plotting function
>     for the
>      ? ? >>> kinds
>      ? ? >>> of things that his packages generates. His plotting routine
>     basically
>      ? ? >>> looks like (after changing names to protect the innocent):
>      ? ? >>>
>      ? ? >>> myPlot <- fucntion(myData, ...) {
>      ? ? >>> ??? # get ready
>      ? ? >>> ??? ggplot(myData, aes(x = myX, y = myY)) +
>      ? ? >>> ?????? # add my decorations
>      ? ? >>> ?????? theme_bw()
>      ? ? >>> }
>      ? ? >>>
>      ? ? >>> Of course, "R CMD check --as-cran" complains that there is
>     no global
>      ? ? >>> binding for "myX" or "myY" since they are columns defined
>     in the
>      ? ? >>> data.frame "myData".
>      ? ? >>>
>      ? ? >>> What is the best way to work around this issue?
>      ? ? >>>
>      ? ? >>> Of course, dinosaurs like myself might be tempted to
>     suggest just
>      ? ? >>> using
>      ? ? >>> plain old "plot", so I don't need to see those suggestions.
>      ? ? >>>
>      ? ? >>> Do I just ignore the usual ggplot conventions and write
>     "myData$myX"
>      ? ? >>> inside "aes"? in order to appease the CRAN checker? Or is
>     there some
>      ? ? >>> tidy-er way to solve this problem?
>      ? ? >>>
>      ? ? >>> Thanks,
>      ? ? >>> ?? Kevin
>      ? ? >>>
>      ? ? >>> ______________________________________________
>      ? ? >>> R-package-devel at r-project.org
>     <mailto:R-package-devel at r-project.org>
>      ? ? >>> <mailto:R-package-devel at r-project.org
>     <mailto:R-package-devel at r-project.org>> mailing list
>      ? ? >>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>     <https://stat.ethz.ch/mailman/listinfo/r-package-devel>
>      ? ? >>> <https://stat.ethz.ch/mailman/listinfo/r-package-devel
>     <https://stat.ethz.ch/mailman/listinfo/r-package-devel>>
>      ? ? >>>
>      ? ? >>> ______________________________________________
>      ? ? >>> R-package-devel at r-project.org
>     <mailto:R-package-devel at r-project.org>
>      ? ? >>> <mailto:R-package-devel at r-project.org
>     <mailto:R-package-devel at r-project.org>> mailing list
>      ? ? >>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>     <https://stat.ethz.ch/mailman/listinfo/r-package-devel>
>      ? ? >>> <https://stat.ethz.ch/mailman/listinfo/r-package-devel
>     <https://stat.ethz.ch/mailman/listinfo/r-package-devel>>
>      ? ? >>>
>      ? ? >>
>      ? ? >>
>      ? ? >> [[alternative HTML version deleted]]
>      ? ? >>
>      ? ? >> ______________________________________________
>      ? ? >> R-package-devel at r-project.org
>     <mailto:R-package-devel at r-project.org> mailing list
>      ? ? >> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>     <https://stat.ethz.ch/mailman/listinfo/r-package-devel>
>      ? ? >>
> 
>      ? ? > ______________________________________________
>      ? ? > R-package-devel at r-project.org
>     <mailto:R-package-devel at r-project.org> mailing list
>      ? ? > https://stat.ethz.ch/mailman/listinfo/r-package-devel
>     <https://stat.ethz.ch/mailman/listinfo/r-package-devel>
> 
>     ______________________________________________
>     R-package-devel at r-project.org <mailto:R-package-devel at r-project.org>
>     mailing list
>     https://stat.ethz.ch/mailman/listinfo/r-package-devel
>     <https://stat.ethz.ch/mailman/listinfo/r-package-devel>
>


From murdoch@dunc@n @end|ng |rom gm@||@com  Sun Apr 25 14:49:55 2021
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Sun, 25 Apr 2021 08:49:55 -0400
Subject: [R-pkg-devel] winUCRT failures
Message-ID: <e978e10f-c1db-6f86-fcde-1c2316f9de02@gmail.com>

The current CRAN release of rgl fails on winUCRT because of missing 
dependencies:

'htmlwidgets', 'htmltools', 'knitr', 'jsonlite', 'shiny', 'magrittr', 
'crosstalk', 'manipulateWidget'.

Tracing `htmlwidgets` shows it also fails because of missing dependencies:

'htmltools', 'jsonlite', 'yaml'

and 'htmltools' fails because of missing dependencies

'digest', 'base64enc', 'rlang'

but 'digest' only gets a warning (congratulations, Dirk!), 'base64enc' 
gets a NOTE (hurray Simon!).  'rlang' is failing a test because of a 
missing suggested dependency on 'glue'.  At that point I stopped searching.

Does anyone have a list of packages that actually need fixes?  I'd like 
to help those maintainers with the necessary updates.

Duncan Murdoch


From w|||@|@nd@u @end|ng |rom gm@||@com  Sun Apr 25 16:45:56 2021
From: w|||@|@nd@u @end|ng |rom gm@||@com (Will L)
Date: Sun, 25 Apr 2021 10:45:56 -0400
Subject: [R-pkg-devel] Cannot reproduce errors of archived CRAN package
Message-ID: <CAC-MUvtUA4sHY2r7viiGZGDjU6BuVjT5-h5=nv02SS3S4OPUjQ@mail.gmail.com>

All,


I was just informed that the {targets} package was archived.

Version 0.4-1 is still failing on macOS so it and tarchetypes have been
> archived.
> A recheck on my own Intel Mac today gives the same check ERRORs as
> reported on the CRAN results page.
> Do not submit again without reproducing this error and confirming it has
> been corrected.


The CRAN check errors (all unique to {targets} version 0.4.1) are at
https://cran-archive.r-project.org/web/checks/2021/2021-04-25_check_results_targets.html,
and I have been unable to reproduce them. I tried a fresh installation of R
4.0.2 and packages on my own Intel Mac, as well as GitHub Actions and both
Mac builds at https://builder.r-hub.io/. All those checks pass.

The error is somehow related to a very simple internal R6 class:
https://github.com/ropensci/targets/blob/4deba948b8d6ecf82511a5a58b1eb9a0addcf2bd/R/class_config.R.
The elusive failing tests are ostensibly in
https://github.com/ropensci/targets/blob/4deba948b8d6ecf82511a5a58b1eb9a0addcf2bd/tests/testthat/test-class_config.R,
but they always pass for me.

Will

	[[alternative HTML version deleted]]


From murdoch@dunc@n @end|ng |rom gm@||@com  Sun Apr 25 17:14:16 2021
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Sun, 25 Apr 2021 11:14:16 -0400
Subject: [R-pkg-devel] winUCRT failures
In-Reply-To: <e978e10f-c1db-6f86-fcde-1c2316f9de02@gmail.com>
References: <e978e10f-c1db-6f86-fcde-1c2316f9de02@gmail.com>
Message-ID: <f410c151-b6e2-34fc-e1c8-6c999ad7410a@gmail.com>

On 25/04/2021 8:49 a.m., Duncan Murdoch wrote:
> The current CRAN release of rgl fails on winUCRT because of missing
> dependencies:
> 
> 'htmlwidgets', 'htmltools', 'knitr', 'jsonlite', 'shiny', 'magrittr',
> 'crosstalk', 'manipulateWidget'.
> 
> Tracing `htmlwidgets` shows it also fails because of missing dependencies:
> 
> 'htmltools', 'jsonlite', 'yaml'
> 
> and 'htmltools' fails because of missing dependencies
> 
> 'digest', 'base64enc', 'rlang'
> 
> but 'digest' only gets a warning (congratulations, Dirk!), 'base64enc'
> gets a NOTE (hurray Simon!).  'rlang' is failing a test because of a
> missing suggested dependency on 'glue'.  At that point I stopped searching.
> 
> Does anyone have a list of packages that actually need fixes?  I'd like
> to help those maintainers with the necessary updates.
> 

I still haven't found any of the packages at the very root of this 
cascade of errors, but I've submitted patches to rlang, glue, and 
magrittr that should allow them to have less severe check issues even if 
some of their suggested dependencies are missing.

What I haven't tried to do is check any of them if *none* of the 
suggested packages is available.  Packages should still build and check 
without ERRORs in this case, though I'd expect NOTEs and/or WARNINGs.

This is an old issue:  what packages should be present during CRAN 
checks?  Currently CRAN tries to check with everything present; perhaps 
it should also try to check with the minimal set.

Duncan Murdoch


From edd @end|ng |rom deb|@n@org  Sun Apr 25 17:35:47 2021
From: edd @end|ng |rom deb|@n@org (Dirk Eddelbuettel)
Date: Sun, 25 Apr 2021 10:35:47 -0500
Subject: [R-pkg-devel] winUCRT failures
In-Reply-To: <f410c151-b6e2-34fc-e1c8-6c999ad7410a@gmail.com>
References: <e978e10f-c1db-6f86-fcde-1c2316f9de02@gmail.com>
 <f410c151-b6e2-34fc-e1c8-6c999ad7410a@gmail.com>
Message-ID: <24709.35923.477640.332909@rob.eddelbuettel.com>


On 25 April 2021 at 11:14, Duncan Murdoch wrote:
| What I haven't tried to do is check any of them if *none* of the 
| suggested packages is available.  Packages should still build and check 
| without ERRORs in this case, though I'd expect NOTEs and/or WARNINGs.
| 
| This is an old issue:  what packages should be present during CRAN 
| checks?  Currently CRAN tries to check with everything present; perhaps 
| it should also try to check with the minimal set.

I last wrote about that four years ago under the title "Suggests != Depends"
http://dirk.eddelbuettel.com/blog/2017/03/22#suggests_is_not_depends

Of course, nothing changed.

So when helping a R Core member last weekend by checking his package against
just over 1000 reverse dependencies, I again had to manually wade through
dozens of false errors of packages failing tests when packages they did NOT
declare a dependency on were used unconditionally. That is still a very clear
error to me, but I no longer expect these windmills will ever stop turning.

Dirk

-- 
https://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From w|||@|@nd@u @end|ng |rom gm@||@com  Sun Apr 25 18:02:40 2021
From: w|||@|@nd@u @end|ng |rom gm@||@com (Will L)
Date: Sun, 25 Apr 2021 12:02:40 -0400
Subject: [R-pkg-devel] Cannot reproduce errors of archived CRAN package
In-Reply-To: <CAC-MUvtUA4sHY2r7viiGZGDjU6BuVjT5-h5=nv02SS3S4OPUjQ@mail.gmail.com>
References: <CAC-MUvtUA4sHY2r7viiGZGDjU6BuVjT5-h5=nv02SS3S4OPUjQ@mail.gmail.com>
Message-ID: <CAC-MUvucYpiuqhvXuhTFSp-dBDJeuDYmK1+Oc0=p+yECp2Affw@mail.gmail.com>

On reflection, I strongly suspect the errors come from the way I was using
file modification time stamps to manage a user-side configuration file.
{targets} was using a time stamp to decide whether it needs to read the
file, but the precision of time stamps varies from system to system. I
implemented a workaround that avoids time stamps.

On Sun, Apr 25, 2021 at 10:45 AM Will L <will.landau at gmail.com> wrote:

> All,
>
>
> I was just informed that the {targets} package was archived.
>
> Version 0.4-1 is still failing on macOS so it and tarchetypes have been
>> archived.
>> A recheck on my own Intel Mac today gives the same check ERRORs as
>> reported on the CRAN results page.
>> Do not submit again without reproducing this error and confirming it has
>> been corrected.
>
>
> The CRAN check errors (all unique to {targets} version 0.4.1) are at
> https://cran-archive.r-project.org/web/checks/2021/2021-04-25_check_results_targets.html,
> and I have been unable to reproduce them. I tried a fresh installation of R
> 4.0.2 and packages on my own Intel Mac, as well as GitHub Actions and both
> Mac builds at https://builder.r-hub.io/. All those checks pass.
>
> The error is somehow related to a very simple internal R6 class:
> https://github.com/ropensci/targets/blob/4deba948b8d6ecf82511a5a58b1eb9a0addcf2bd/R/class_config.R.
> The elusive failing tests are ostensibly in
> https://github.com/ropensci/targets/blob/4deba948b8d6ecf82511a5a58b1eb9a0addcf2bd/tests/testthat/test-class_config.R,
> but they always pass for me.
>
> Will
>


-- 
wlandau.github.io
linkedin.com/in/wlandau
github.com/wlandau

	[[alternative HTML version deleted]]


From murdoch@dunc@n @end|ng |rom gm@||@com  Sun Apr 25 18:27:12 2021
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Sun, 25 Apr 2021 12:27:12 -0400
Subject: [R-pkg-devel] winUCRT failures
In-Reply-To: <24709.35923.477640.332909@rob.eddelbuettel.com>
References: <e978e10f-c1db-6f86-fcde-1c2316f9de02@gmail.com>
 <f410c151-b6e2-34fc-e1c8-6c999ad7410a@gmail.com>
 <24709.35923.477640.332909@rob.eddelbuettel.com>
Message-ID: <7715bf23-ecf8-87ad-a0c5-8520f707afac@gmail.com>

On 25/04/2021 11:35 a.m., Dirk Eddelbuettel wrote:
> 
> On 25 April 2021 at 11:14, Duncan Murdoch wrote:
> | What I haven't tried to do is check any of them if *none* of the
> | suggested packages is available.  Packages should still build and check
> | without ERRORs in this case, though I'd expect NOTEs and/or WARNINGs.
> |
> | This is an old issue:  what packages should be present during CRAN
> | checks?  Currently CRAN tries to check with everything present; perhaps
> | it should also try to check with the minimal set.
> 
> I last wrote about that four years ago under the title "Suggests != Depends"
> http://dirk.eddelbuettel.com/blog/2017/03/22#suggests_is_not_depends
> 
> Of course, nothing changed.
> 
> So when helping a R Core member last weekend by checking his package against
> just over 1000 reverse dependencies, I again had to manually wade through
> dozens of false errors of packages failing tests when packages they did NOT
> declare a dependency on were used unconditionally. That is still a very clear
> error to me, but I no longer expect these windmills will ever stop turning.

I agree it's an error.  Back when we had one of those discussions it 
seemed too resource-intensive to do both kinds of tests, and it's much 
easier to do the "install everything" tests if you are always working 
with a fixed library.

Nowadays I think it's easier to run the tests on a VM that has exactly 
the packages you specify, so people have less excuse not to do that on 
their own.  I have a Github "workflow" here that does it for rgl:

https://github.com/dmurdoch/rgl/actions/workflows/R-CMD-nosoft-check.yml

BTW, I've just submitted another patch, this time for the usethis 
package, which added "Suggests: testthat" and then used testthat 
unconditionally.  That won't help any other existing packages, but if it 
is accepted it might help in the future.

Duncan


From edd @end|ng |rom deb|@n@org  Sun Apr 25 18:46:42 2021
From: edd @end|ng |rom deb|@n@org (Dirk Eddelbuettel)
Date: Sun, 25 Apr 2021 11:46:42 -0500
Subject: [R-pkg-devel] winUCRT failures
In-Reply-To: <7715bf23-ecf8-87ad-a0c5-8520f707afac@gmail.com>
References: <e978e10f-c1db-6f86-fcde-1c2316f9de02@gmail.com>
 <f410c151-b6e2-34fc-e1c8-6c999ad7410a@gmail.com>
 <24709.35923.477640.332909@rob.eddelbuettel.com>
 <7715bf23-ecf8-87ad-a0c5-8520f707afac@gmail.com>
Message-ID: <24709.40178.637940.842353@rob.eddelbuettel.com>


On 25 April 2021 at 12:27, Duncan Murdoch wrote:
| On 25/04/2021 11:35 a.m., Dirk Eddelbuettel wrote:
| > I last wrote about that four years ago under the title "Suggests != Depends"
| > http://dirk.eddelbuettel.com/blog/2017/03/22#suggests_is_not_depends
| > 
| > Of course, nothing changed.
| > 
| > So when helping a R Core member last weekend by checking his package against
| > just over 1000 reverse dependencies, I again had to manually wade through
| > dozens of false errors of packages failing tests when packages they did NOT
| > declare a dependency on were used unconditionally. That is still a very clear
| > error to me, but I no longer expect these windmills will ever stop turning.
| 
| I agree it's an error.  Back when we had one of those discussions it 
| seemed too resource-intensive to do both kinds of tests, and it's much 
| easier to do the "install everything" tests if you are always working 
| with a fixed library.
| 
| Nowadays I think it's easier to run the tests on a VM that has exactly 
| the packages you specify, so people have less excuse not to do that on 

That is an ooooold problem, and I argued about this (with you and others) for
a decade or longer. And I often mentioned that e.g. _every_ Debian (or
Ubuntu, I am sure the others distris do the same) build installs _excactly_
what is listed, and omitted packages _will_ cause an error.  That was already
easy to implement (on Unix system) several decades ago via chroot and related
tricks; it is now trivial due to VMs or container use (which GH Actions
approximates too, though it may start with 'too fat a container).

So yes, it is technically easy, and we could pool the resources. But nobody
is driving it so (as has been the case for years) nothing changes. Ever.

| their own.  I have a Github "workflow" here that does it for rgl:
| 
| https://github.com/dmurdoch/rgl/actions/workflows/R-CMD-nosoft-check.yml
| 
| BTW, I've just submitted another patch, this time for the usethis 
| package, which added "Suggests: testthat" and then used testthat 
| unconditionally.  That won't help any other existing packages, but if it 
| is accepted it might help in the future.

It has long been true that the main test runners (RUnit, testthat, now also
tinytest) are automagically included, which is a defensible (if undocumented)
special rule.

Dirk

-- 
https://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From edd @end|ng |rom deb|@n@org  Sun Apr 25 18:52:21 2021
From: edd @end|ng |rom deb|@n@org (Dirk Eddelbuettel)
Date: Sun, 25 Apr 2021 11:52:21 -0500
Subject: [R-pkg-devel] winUCRT failures
In-Reply-To: <24709.40178.637940.842353@rob.eddelbuettel.com>
References: <e978e10f-c1db-6f86-fcde-1c2316f9de02@gmail.com>
 <f410c151-b6e2-34fc-e1c8-6c999ad7410a@gmail.com>
 <24709.35923.477640.332909@rob.eddelbuettel.com>
 <7715bf23-ecf8-87ad-a0c5-8520f707afac@gmail.com>
 <24709.40178.637940.842353@rob.eddelbuettel.com>
Message-ID: <24709.40517.649092.283125@rob.eddelbuettel.com>


On 25 April 2021 at 11:46, Dirk Eddelbuettel wrote:
| So yes, it is technically easy, and we could pool the resources. But nobody
| is driving it so (as has been the case for years) nothing changes. Ever.

Sorry, "nothing changes" is too harsh. We have in the last year or two gotten
a new test or two in R CMD check. But it is still true that what should be an
error still leads to needless failure and added confusion (c.f. beginning of
this thread).  We could do better, but won't as long as it isn't enforced.

Dirk

-- 
https://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From murdoch@dunc@n @end|ng |rom gm@||@com  Sun Apr 25 18:56:31 2021
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Sun, 25 Apr 2021 12:56:31 -0400
Subject: [R-pkg-devel] winUCRT failures
In-Reply-To: <24709.40178.637940.842353@rob.eddelbuettel.com>
References: <e978e10f-c1db-6f86-fcde-1c2316f9de02@gmail.com>
 <f410c151-b6e2-34fc-e1c8-6c999ad7410a@gmail.com>
 <24709.35923.477640.332909@rob.eddelbuettel.com>
 <7715bf23-ecf8-87ad-a0c5-8520f707afac@gmail.com>
 <24709.40178.637940.842353@rob.eddelbuettel.com>
Message-ID: <5bc94ba1-6fa1-2e1a-59e0-bbdda794096f@gmail.com>

On 25/04/2021 12:46 p.m., Dirk Eddelbuettel wrote:
> 
> On 25 April 2021 at 12:27, Duncan Murdoch wrote:
> | On 25/04/2021 11:35 a.m., Dirk Eddelbuettel wrote:
> | > I last wrote about that four years ago under the title "Suggests != Depends"
> | > http://dirk.eddelbuettel.com/blog/2017/03/22#suggests_is_not_depends
> | >
> | > Of course, nothing changed.
> | >
> | > So when helping a R Core member last weekend by checking his package against
> | > just over 1000 reverse dependencies, I again had to manually wade through
> | > dozens of false errors of packages failing tests when packages they did NOT
> | > declare a dependency on were used unconditionally. That is still a very clear
> | > error to me, but I no longer expect these windmills will ever stop turning.
> |
> | I agree it's an error.  Back when we had one of those discussions it
> | seemed too resource-intensive to do both kinds of tests, and it's much
> | easier to do the "install everything" tests if you are always working
> | with a fixed library.
> |
> | Nowadays I think it's easier to run the tests on a VM that has exactly
> | the packages you specify, so people have less excuse not to do that on
> 
> That is an ooooold problem, and I argued about this (with you and others) for
> a decade or longer. And I often mentioned that e.g. _every_ Debian (or
> Ubuntu, I am sure the others distris do the same) build installs _excactly_
> what is listed, and omitted packages _will_ cause an error.  That was already
> easy to implement (on Unix system) several decades ago via chroot and related
> tricks; it is now trivial due to VMs or container use (which GH Actions
> approximates too, though it may start with 'too fat a container).
> 
> So yes, it is technically easy, and we could pool the resources. But nobody
> is driving it so (as has been the case for years) nothing changes. Ever.
> 
> | their own.  I have a Github "workflow" here that does it for rgl:
> |
> | https://github.com/dmurdoch/rgl/actions/workflows/R-CMD-nosoft-check.yml
> |
> | BTW, I've just submitted another patch, this time for the usethis
> | package, which added "Suggests: testthat" and then used testthat
> | unconditionally.  That won't help any other existing packages, but if it
> | is accepted it might help in the future.
> 
> It has long been true that the main test runners (RUnit, testthat, now also
> tinytest) are automagically included, which is a defensible (if undocumented)
> special rule.

It's a bad rule.  It's causing thousands of packages to fail now, 
because testthat won't pass checks on the winUCRT system.  It's making 
the pain of winUCRT last much longer than it should, because nobody 
knows what problems exist in their own package if they can't install it 
because of missing dependencies.

For example, as I said in the first message in this thread,

> The current CRAN release of rgl fails on winUCRT because of missing 
> dependencies:
> 
> 'htmlwidgets', 'htmltools', 'knitr', 'jsonlite', 'shiny', 'magrittr', 
> 'crosstalk', 'manipulateWidget'.
> 
> Tracing `htmlwidgets` shows it also fails because of missing dependencies:
> 
> 'htmltools', 'jsonlite', 'yaml'
> 
> and 'htmltools' fails because of missing dependencies
> 
> 'digest', 'base64enc', 'rlang'

A lot of those failures are ultimately caused by magrittr failing, and 
as far as I can see the only thing causing it to fail was that it used 
testthat unconditionally even though its DESCRIPTION file promised it 
would never do that.

Duncan Murdoch


From murdoch@dunc@n @end|ng |rom gm@||@com  Sun Apr 25 21:29:46 2021
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Sun, 25 Apr 2021 15:29:46 -0400
Subject: [R-pkg-devel] winUCRT failures
In-Reply-To: <5bc94ba1-6fa1-2e1a-59e0-bbdda794096f@gmail.com>
References: <e978e10f-c1db-6f86-fcde-1c2316f9de02@gmail.com>
 <f410c151-b6e2-34fc-e1c8-6c999ad7410a@gmail.com>
 <24709.35923.477640.332909@rob.eddelbuettel.com>
 <7715bf23-ecf8-87ad-a0c5-8520f707afac@gmail.com>
 <24709.40178.637940.842353@rob.eddelbuettel.com>
 <5bc94ba1-6fa1-2e1a-59e0-bbdda794096f@gmail.com>
Message-ID: <510c7294-8a64-90da-cbc9-4038133079bf@gmail.com>

On 25/04/2021 12:56 p.m., Duncan Murdoch wrote:
> On 25/04/2021 12:46 p.m., Dirk Eddelbuettel wrote:

  ...

>> It has long been true that the main test runners (RUnit, testthat, now also
>> tinytest) are automagically included, which is a defensible (if undocumented)
>> special rule.
> 
> It's a bad rule.  It's causing thousands of packages to fail now,
> because testthat won't pass checks on the winUCRT system.  It's making
> the pain of winUCRT last much longer than it should, because nobody
> knows what problems exist in their own package if they can't install it
> because of missing dependencies.
> 
> For example, as I said in the first message in this thread,
> 
>> The current CRAN release of rgl fails on winUCRT because of missing
>> dependencies:
>>
>> 'htmlwidgets', 'htmltools', 'knitr', 'jsonlite', 'shiny', 'magrittr',
>> 'crosstalk', 'manipulateWidget'.
>>
>> Tracing `htmlwidgets` shows it also fails because of missing dependencies:
>>
>> 'htmltools', 'jsonlite', 'yaml'
>>
>> and 'htmltools' fails because of missing dependencies
>>
>> 'digest', 'base64enc', 'rlang'
> 
> A lot of those failures are ultimately caused by magrittr failing, and
> as far as I can see the only thing causing it to fail was that it used
> testthat unconditionally even though its DESCRIPTION file promised it
> would never do that.

One additional thought:

If the testing package (i.e. testthat in this case) had been available 
but other suggested packages were not, it would be worth running tests 
with just testthat present:  that might be why you called the decision 
defensible.  I'd agree with that.

However, it's still true that the fact that testthat has to be present 
to make magrittr available is a pretty serious flaw in magrittr and/or 
the CRAN processes.  Hopefully magrittr's authors are less stubborn than 
R Core/CRAN, and will make their package more resilient.

Duncan Murdoch


From h@w|ckh@m @end|ng |rom gm@||@com  Mon Apr 26 01:23:27 2021
From: h@w|ckh@m @end|ng |rom gm@||@com (Hadley Wickham)
Date: Sun, 25 Apr 2021 18:23:27 -0500
Subject: [R-pkg-devel] winUCRT failures
In-Reply-To: <510c7294-8a64-90da-cbc9-4038133079bf@gmail.com>
References: <e978e10f-c1db-6f86-fcde-1c2316f9de02@gmail.com>
 <f410c151-b6e2-34fc-e1c8-6c999ad7410a@gmail.com>
 <24709.35923.477640.332909@rob.eddelbuettel.com>
 <7715bf23-ecf8-87ad-a0c5-8520f707afac@gmail.com>
 <24709.40178.637940.842353@rob.eddelbuettel.com>
 <5bc94ba1-6fa1-2e1a-59e0-bbdda794096f@gmail.com>
 <510c7294-8a64-90da-cbc9-4038133079bf@gmail.com>
Message-ID: <CABdHhvGrEkM5wfxoNSmRjfcLLDByMu=FmkyOU85yJWj0_QXEHw@mail.gmail.com>

> One additional thought:
>
> If the testing package (i.e. testthat in this case) had been available
> but other suggested packages were not, it would be worth running tests
> with just testthat present:  that might be why you called the decision
> defensible.  I'd agree with that.
>
> However, it's still true that the fact that testthat has to be present
> to make magrittr available is a pretty serious flaw in magrittr and/or
> the CRAN processes.  Hopefully magrittr's authors are less stubborn than
> R Core/CRAN, and will make their package more resilient.

Isn't this a 0/0 problem? If there are zero failures from zero tests,
do we really want to declare that the package is ok?

I'm not interested in participating in another debate about whether or
not one should assume that suggested packages are available when
checking a package. Some time ago, we decided to install all suggested
packages when running reverse dependency checks and it has caused us
few problems (especially since linux binaries for all CRAN packages
are now readily available). Either way, isn't it easier for the
handful of experienced developers who perform many R CMD check runs to
install all suggested packages, rather than trying to get thousands of
individual package maintainers to change their behaviour?

Hadley



-- 
http://hadley.nz


From h@w|ckh@m @end|ng |rom gm@||@com  Mon Apr 26 01:25:57 2021
From: h@w|ckh@m @end|ng |rom gm@||@com (Hadley Wickham)
Date: Sun, 25 Apr 2021 18:25:57 -0500
Subject: [R-pkg-devel] winUCRT failures
In-Reply-To: <e978e10f-c1db-6f86-fcde-1c2316f9de02@gmail.com>
References: <e978e10f-c1db-6f86-fcde-1c2316f9de02@gmail.com>
Message-ID: <CABdHhvGt++tXW8tb=NK4NmPJHcEKf506=vcNKk+k7GF0tsNpnQ@mail.gmail.com>

Who is responsible for the winUCRT checks? Perhaps that person could
provide us with a list of root causes behind the testthat failures,
and we could look into resolving them.

Hadley

On Sun, Apr 25, 2021 at 7:50 AM Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
>
> The current CRAN release of rgl fails on winUCRT because of missing
> dependencies:
>
> 'htmlwidgets', 'htmltools', 'knitr', 'jsonlite', 'shiny', 'magrittr',
> 'crosstalk', 'manipulateWidget'.
>
> Tracing `htmlwidgets` shows it also fails because of missing dependencies:
>
> 'htmltools', 'jsonlite', 'yaml'
>
> and 'htmltools' fails because of missing dependencies
>
> 'digest', 'base64enc', 'rlang'
>
> but 'digest' only gets a warning (congratulations, Dirk!), 'base64enc'
> gets a NOTE (hurray Simon!).  'rlang' is failing a test because of a
> missing suggested dependency on 'glue'.  At that point I stopped searching.
>
> Does anyone have a list of packages that actually need fixes?  I'd like
> to help those maintainers with the necessary updates.
>
> Duncan Murdoch
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel



-- 
http://hadley.nz


From c||9 @end|ng |rom nc@u@edu  Mon Apr 26 01:23:35 2021
From: c||9 @end|ng |rom nc@u@edu (Cai Li)
Date: Sun, 25 Apr 2021 19:23:35 -0400
Subject: [R-pkg-devel] Call internal R functions in C
Message-ID: <CAC5yOjiga0hf8a4GNGSLygmoHtiJQRPyiRUw4RX-_7cDrTJvOg@mail.gmail.com>

Hello All,

I'm developing a package with C code. My question may be naive: I have
several internal R functions that need to be called by C, but I cannot get
it to work or find a solution. It can work if I export those internal
functions in namespace, but it fails if I just want to keep them as
internal functions without exporting them. I guess I need some flags to
indicate the "internal" R internal functions? Could you please share your
thoughts on how to fix this? Much appreciated in advance!

//   set up call to R function "R_function"
    SEXP func_R;
    PROTECT(func_R=lang2(install("R_function"), func_data));

Thanks,
C

	[[alternative HTML version deleted]]


From murdoch@dunc@n @end|ng |rom gm@||@com  Mon Apr 26 02:46:27 2021
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Sun, 25 Apr 2021 20:46:27 -0400
Subject: [R-pkg-devel] Call internal R functions in C
In-Reply-To: <CAC5yOjiga0hf8a4GNGSLygmoHtiJQRPyiRUw4RX-_7cDrTJvOg@mail.gmail.com>
References: <CAC5yOjiga0hf8a4GNGSLygmoHtiJQRPyiRUw4RX-_7cDrTJvOg@mail.gmail.com>
Message-ID: <e028cf6d-3bda-feef-4830-77c265c2c95c@gmail.com>

On 25/04/2021 7:23 p.m., Cai Li wrote:
> Hello All,
> 
> I'm developing a package with C code. My question may be naive: I have
> several internal R functions that need to be called by C, but I cannot get
> it to work or find a solution. It can work if I export those internal
> functions in namespace, but it fails if I just want to keep them as
> internal functions without exporting them. I guess I need some flags to
> indicate the "internal" R internal functions? Could you please share your
> thoughts on how to fix this? Much appreciated in advance!
> 
> //   set up call to R function "R_function"
>      SEXP func_R;
>      PROTECT(func_R=lang2(install("R_function"), func_data));
> 

It all depends on the environment where you evaluate that expression, 
just as it would if it was R code.  You can't see internal package 
functions from the global environment, you need to evaluate them in the 
package namespace environment.

Duncan Murdoch


From c||9 @end|ng |rom nc@u@edu  Mon Apr 26 04:30:08 2021
From: c||9 @end|ng |rom nc@u@edu (Cai Li)
Date: Sun, 25 Apr 2021 22:30:08 -0400
Subject: [R-pkg-devel] Call internal R functions in C
In-Reply-To: <e028cf6d-3bda-feef-4830-77c265c2c95c@gmail.com>
References: <CAC5yOjiga0hf8a4GNGSLygmoHtiJQRPyiRUw4RX-_7cDrTJvOg@mail.gmail.com>
 <e028cf6d-3bda-feef-4830-77c265c2c95c@gmail.com>
Message-ID: <CAC5yOjifUj3-oS5m53K5=-cJKBHNVzmcdpUro1JNJjyUvjmCVQ@mail.gmail.com>

Thanks Duncan! I was advised not to export those functions in the namespace
and keep them as internals. In terms of this, could you advise what
specific changes should I make to the C code so that I can evaluate them in
a suitable environment? I tried something like
"PROTECT(func_R=lang2(install("Package:::R_function"), func_data))," but it
did not work. Sorry this may be too naive and thanks again.

Cai

On Sun, Apr 25, 2021 at 8:46 PM Duncan Murdoch <murdoch.duncan at gmail.com>
wrote:

> On 25/04/2021 7:23 p.m., Cai Li wrote:
> > Hello All,
> >
> > I'm developing a package with C code. My question may be naive: I have
> > several internal R functions that need to be called by C, but I cannot
> get
> > it to work or find a solution. It can work if I export those internal
> > functions in namespace, but it fails if I just want to keep them as
> > internal functions without exporting them. I guess I need some flags to
> > indicate the "internal" R internal functions? Could you please share your
> > thoughts on how to fix this? Much appreciated in advance!
> >
> > //   set up call to R function "R_function"
> >      SEXP func_R;
> >      PROTECT(func_R=lang2(install("R_function"), func_data));
> >
>
> It all depends on the environment where you evaluate that expression,
> just as it would if it was R code.  You can't see internal package
> functions from the global environment, you need to evaluate them in the
> package namespace environment.
>
> Duncan Murdoch
>

	[[alternative HTML version deleted]]


From murdoch@dunc@n @end|ng |rom gm@||@com  Mon Apr 26 11:30:48 2021
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Mon, 26 Apr 2021 05:30:48 -0400
Subject: [R-pkg-devel] Call internal R functions in C
In-Reply-To: <CAC5yOjifUj3-oS5m53K5=-cJKBHNVzmcdpUro1JNJjyUvjmCVQ@mail.gmail.com>
References: <CAC5yOjiga0hf8a4GNGSLygmoHtiJQRPyiRUw4RX-_7cDrTJvOg@mail.gmail.com>
 <e028cf6d-3bda-feef-4830-77c265c2c95c@gmail.com>
 <CAC5yOjifUj3-oS5m53K5=-cJKBHNVzmcdpUro1JNJjyUvjmCVQ@mail.gmail.com>
Message-ID: <ecee6aa1-8193-b881-dacb-576c41f2fde9@gmail.com>

On 25/04/2021 10:30 p.m., Cai Li wrote:
> Thanks Duncan! I was advised not to export those functions in the 
> namespace and keep them as internals. In terms of this, could you advise 
> what specific changes should I make to the C code so that I can evaluate 
> them in a suitable environment? I tried something like 
> "PROTECT(func_R=lang2(install("Package:::R_function"), func_data))," but 
> it did not work. Sorry this may be too naive and thanks again.

That line creates the expression to evaluate, it doesn't evaluate it. 
You need to call eval() (the C function) on the result.  Here's some 
code from rgl that does something similar:

R code to initialize:

rgl.init <- function(initValue = 0, onlyNULL = FALSE, debug = 
getOption("rgl.debug", FALSE))
   .Call( rgl_init,
     initValue, onlyNULL, environment(rgl.init), debug )

The important thing here is "environment(rgl.init)", which is the 
private environment within the package.

Then in C code, save that environment:

   rglNamespace = in_namespace;

and use it later:

   result = eval(PROTECT(lang2(PROTECT(install("rglFonts")),
 
PROTECT(ScalarString(mkChar(family))))), rglNamespace);

Duncan Murdoch

> 
> Cai
> 
> On Sun, Apr 25, 2021 at 8:46 PM Duncan Murdoch <murdoch.duncan at gmail.com 
> <mailto:murdoch.duncan at gmail.com>> wrote:
> 
>     On 25/04/2021 7:23 p.m., Cai Li wrote:
>      > Hello All,
>      >
>      > I'm developing a package with C code. My question may be naive: I
>     have
>      > several internal R functions that need to be called by C, but I
>     cannot get
>      > it to work or find a solution. It can work if I export those internal
>      > functions in namespace, but it fails if I just want to keep them as
>      > internal functions without exporting them. I guess I need some
>     flags to
>      > indicate the "internal" R internal functions? Could you please
>     share your
>      > thoughts on how to fix this? Much appreciated in advance!
>      >
>      > //? ?set up call to R function "R_function"
>      >? ? ? SEXP func_R;
>      >? ? ? PROTECT(func_R=lang2(install("R_function"), func_data));
>      >
> 
>     It all depends on the environment where you evaluate that expression,
>     just as it would if it was R code.? You can't see internal package
>     functions from the global environment, you need to evaluate them in the
>     package namespace environment.
> 
>     Duncan Murdoch
>


From tom@@@k@||ber@ @end|ng |rom gm@||@com  Mon Apr 26 14:21:56 2021
From: tom@@@k@||ber@ @end|ng |rom gm@||@com (Tomas Kalibera)
Date: Mon, 26 Apr 2021 14:21:56 +0200
Subject: [R-pkg-devel] winUCRT failures
In-Reply-To: <e978e10f-c1db-6f86-fcde-1c2316f9de02@gmail.com>
References: <e978e10f-c1db-6f86-fcde-1c2316f9de02@gmail.com>
Message-ID: <8e53c23c-81ce-819d-0d32-784db1487f21@gmail.com>


On 4/25/21 2:49 PM, Duncan Murdoch wrote:
> The current CRAN release of rgl fails on winUCRT because of missing 
> dependencies:
>
> 'htmlwidgets', 'htmltools', 'knitr', 'jsonlite', 'shiny', 'magrittr', 
> 'crosstalk', 'manipulateWidget'.
>
> Tracing `htmlwidgets` shows it also fails because of missing 
> dependencies:
>
> 'htmltools', 'jsonlite', 'yaml'
>
> and 'htmltools' fails because of missing dependencies
>
> 'digest', 'base64enc', 'rlang'
>
> but 'digest' only gets a warning (congratulations, Dirk!), 'base64enc' 
> gets a NOTE (hurray Simon!).? 'rlang' is failing a test because of a 
> missing suggested dependency on 'glue'.? At that point I stopped 
> searching.
>
> Does anyone have a list of packages that actually need fixes?? I'd 
> like to help those maintainers with the necessary updates.

Hi Duncan,

thanks for helping with the fixes to packages needed for this toolchain 
(and for having UTF-8 as native encoding on Windows). Fixing packages to 
properly declare their dependencies will be useful in general.

And thanks for asking about the missing dependencies, it turns out that 
the checks broke during transition of R-devel to 4.2. I've fixed my 
scripts now and if I got it right, correct results should appear in 
about 1.5 days from now. The numbers were about 10x better before this 
happened.

A number of packages will still need fixing. I can help searching the 
logs for the root issues (packages failing for other reasons than 
missing dependencies) once the results are correct again. And I can also 
make the logs downloadable in tarball etc (rather than one-by-one).

Best
Tomas

>
> Duncan Murdoch
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From dom|n|kr@|@cz @end|ng |rom gm@||@com  Mon Apr 26 14:29:10 2021
From: dom|n|kr@|@cz @end|ng |rom gm@||@com (Dominik Rafacz)
Date: Mon, 26 Apr 2021 14:29:10 +0200
Subject: [R-pkg-devel] Build fails on R-devel due to Bioconductor version
 mismatch
Message-ID: <CAOHQ5A+t7wLwNyup80DwbOfqvuxn2PkKYeQ7Nm2SPSMAzcHmHw@mail.gmail.com>

Hi all,

I am the maintainer of the deepdep package. It has recently been archived
on CRAN because I did not have time to make the necessary corrections. Now
the package passes most tests and builds on most configurations, however
there is a problem on r-devel.

I'm attaching logs from builds on R-release (successful) and R-devel
(failed) from R-hub.

Here is repository of my package on GitHub:
https://github.com/DominikRafacz/deepdep

My package uses BiocManager to get a list of packages available on the
Bioconductor repository. However, the log indicates that calling the
BiocManager::available() function results in an error related to the R
version being too new for the Bioconductor version. I'm guessing this is
related to the test environment configuration, which I have no control over
(have I?).

Is there any way to resolve the versioning issue? Or should I apply version
checking to the tests and examples in my package and catch errors if
unavailable?

With regards,
Dominik Rafacz

-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: r-devel.txt
URL: <https://stat.ethz.ch/pipermail/r-package-devel/attachments/20210426/e60fafb2/attachment.txt>

-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: r-release.txt
URL: <https://stat.ethz.ch/pipermail/r-package-devel/attachments/20210426/e60fafb2/attachment-0001.txt>

From murdoch@dunc@n @end|ng |rom gm@||@com  Mon Apr 26 14:55:15 2021
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Mon, 26 Apr 2021 08:55:15 -0400
Subject: [R-pkg-devel] Get WARNING in R CMD check from warning in test code?
Message-ID: <37f55142-ae2d-853b-8f66-9748ce418ee7@gmail.com>

I had been under the mistaken impression that warnings in test code 
would lead to NOTEs or WARNINGs in R CMD check, but they are ignored.

I think the only outcomes from running test code are OK or ERROR, the 
latter happening when R exits with a non-zero status, as it does by 
default when there's a call to stop() in the test code.

Am I wrong about this?  Is there a way to put something executable in 
the test script that will generate a WARNING in R CMD check when executed?

The closest I can seem to get is to include *.Rout.save, which generates 
a NOTE if it doesn't match, and is fairly inconvenient to keep up to date.

Duncan Murdoch


From murdoch@dunc@n @end|ng |rom gm@||@com  Mon Apr 26 15:02:06 2021
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Mon, 26 Apr 2021 09:02:06 -0400
Subject: [R-pkg-devel] 
 Get WARNING in R CMD check from warning in test code?
In-Reply-To: <37f55142-ae2d-853b-8f66-9748ce418ee7@gmail.com>
References: <37f55142-ae2d-853b-8f66-9748ce418ee7@gmail.com>
Message-ID: <4d9eaee8-9248-a3bc-f28d-a95092ea3551@gmail.com>

On 26/04/2021 8:55 a.m., Duncan Murdoch wrote:
> I had been under the mistaken impression that warnings in test code
> would lead to NOTEs or WARNINGs in R CMD check, but they are ignored.
> 
> I think the only outcomes from running test code are OK or ERROR, the
> latter happening when R exits with a non-zero status, as it does by
> default when there's a call to stop() in the test code.
> 
> Am I wrong about this?  Is there a way to put something executable in
> the test script that will generate a WARNING in R CMD check when executed?
> 
> The closest I can seem to get is to include *.Rout.save, which generates
> a NOTE if it doesn't match, and is fairly inconvenient to keep up to date.

Oops, wrong again.  It's a message in the check log, but it leaves the 
status as OK.

> 
> Duncan Murdoch
>


From otoomet @end|ng |rom gm@||@com  Mon Apr 26 15:20:53 2021
From: otoomet @end|ng |rom gm@||@com (Ott Toomet)
Date: Mon, 26 Apr 2021 06:20:53 -0700
Subject: [R-pkg-devel] winUCRT failures
In-Reply-To: <24709.35923.477640.332909@rob.eddelbuettel.com>
References: <e978e10f-c1db-6f86-fcde-1c2316f9de02@gmail.com>
 <f410c151-b6e2-34fc-e1c8-6c999ad7410a@gmail.com>
 <24709.35923.477640.332909@rob.eddelbuettel.com>
Message-ID: <CAMMJQ0ZNv5g9DjTUMZnvMp4JZScvWaH7kuQn71F11QvA3sDnAA@mail.gmail.com>

I think part of the problem is that the corresponding section in "Writing R
extensions" is not very clear for newcomers.  I admit I have read it
several times as I have been confused about the difference between suggest,
imports and depends, and so combed section 1.1.3 repeatedly.  But from this
email thread I realize that I have overlooked some of the basics.

I would like to have an authoritative document (preferably WRE) that
provides some sort of clear distinction between these concepts, including a
few examples.  In particular, the fact that one should wrap the suggested
packages in "requireNamespace" has escaped me.  I guess it is not just me
as a large chunk of package authors are applied researchers and not
professional software developers.

Not sure if one should rewrite the docs here, or maybe alternatively create
some sort of simplified version of the document.

Cheers,
Ott

On Sun, Apr 25, 2021 at 8:36 AM Dirk Eddelbuettel <edd at debian.org> wrote:

>
> On 25 April 2021 at 11:14, Duncan Murdoch wrote:
> | What I haven't tried to do is check any of them if *none* of the
> | suggested packages is available.  Packages should still build and check
> | without ERRORs in this case, though I'd expect NOTEs and/or WARNINGs.
> |
> | This is an old issue:  what packages should be present during CRAN
> | checks?  Currently CRAN tries to check with everything present; perhaps
> | it should also try to check with the minimal set.
>
> I last wrote about that four years ago under the title "Suggests !=
> Depends"
> http://dirk.eddelbuettel.com/blog/2017/03/22#suggests_is_not_depends
>
> Of course, nothing changed.
>
> So when helping a R Core member last weekend by checking his package
> against
> just over 1000 reverse dependencies, I again had to manually wade through
> dozens of false errors of packages failing tests when packages they did NOT
> declare a dependency on were used unconditionally. That is still a very
> clear
> error to me, but I no longer expect these windmills will ever stop turning.
>
> Dirk
>
> --
> https://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From murdoch@dunc@n @end|ng |rom gm@||@com  Mon Apr 26 15:48:24 2021
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Mon, 26 Apr 2021 09:48:24 -0400
Subject: [R-pkg-devel] winUCRT failures
In-Reply-To: <CAMMJQ0ZNv5g9DjTUMZnvMp4JZScvWaH7kuQn71F11QvA3sDnAA@mail.gmail.com>
References: <e978e10f-c1db-6f86-fcde-1c2316f9de02@gmail.com>
 <f410c151-b6e2-34fc-e1c8-6c999ad7410a@gmail.com>
 <24709.35923.477640.332909@rob.eddelbuettel.com>
 <CAMMJQ0ZNv5g9DjTUMZnvMp4JZScvWaH7kuQn71F11QvA3sDnAA@mail.gmail.com>
Message-ID: <0a9a63d7-dbbc-c23a-873d-6be9c48458f8@gmail.com>

On 26/04/2021 9:20 a.m., Ott Toomet wrote:
> I think part of the problem is that the corresponding section in 
> "Writing R extensions" is not very clear for newcomers.? I admit I have 
> read it several times as I have been confused about the difference 
> between suggest, imports and depends, and so combed section 1.1.3 
> repeatedly.? But from this email thread I realize that I have overlooked 
> some of the basics.
> 
> I would like to have an authoritative document (preferably WRE) that 
> provides some sort of clear distinction between these concepts, 
> including a few examples.? In particular, the fact that one should wrap 
> the suggested packages in "requireNamespace" has escaped me.? I guess it 
> is not just me as a large chunk of package authors are applied 
> researchers and not professional software developers.
> 
> Not sure if one should rewrite the docs here, or maybe alternatively 
> create some sort of simplified version of the document.

There are tons of simplified versions of the document (in blogs, books, 
mailing list postings, etc.), but many of them also contain errors or 
make up different versions of the advice, so a rewrite or simplified 
version that had the support of R Core would be valuable.

Unfortunately, even if someone else wrote it, it would take a lot of R 
Core work to check it.  And if it was a separate simplified version, 
there'd be likely divergence over time from the full technical version.

"R CMD check" raising issues which beginners can ask about seems like a 
reasonable solution to this problem, as long as there are people willing 
to help them.  It offloads the writing work to the people who are giving 
the responses.  It's still hard for beginners to choose between 
conflicting versions of the advice, but that will always be true, even 
if one version is "endorsed by R Core".

Duncan Murdoch


From t@+code @end|ng |rom rcmd@org  Mon Apr 26 20:32:01 2021
From: t@+code @end|ng |rom rcmd@org (=?UTF-8?Q?Tim_Sch=C3=A4fer?=)
Date: Mon, 26 Apr 2021 20:32:01 +0200 (CEST)
Subject: [R-pkg-devel] Winbuilder error for rgl on R 3.6.3
Message-ID: <744913706.118570.1619461921550@ox.hosteurope.de>

Dear R experts,

I am testing my R package 'fsbrain' using the Winbuilder service [1] before submitting a new version to CRAN.

All checks pass under R versions 4.0.5 and 4.1.0 alpha, but the installation fails under R 3.6.3 because of a problem related to rgl, which is a dependency of my package.

The file 00check.log says 'installation failed' and refers to '00install.log', which contains the following message:

------------------Message start-------------------------
* installing *source* package 'fsbrain' ...
** using staged installation
** R
** inst
** byte-compile and prepare package for lazy loading
Error in system.file(paste0(dir, "/rgl", .Platform$dynlib.ext), package = pkg,  : 
  no file found
Warning: 	Loading rgl's DLL failed. 
Warning: Trying without OpenGL...
Error in system.file(paste0(dir, "/rgl", .Platform$dynlib.ext), package = pkg,  : 
  no file found
Error: .onLoad failed in loadNamespace() for 'rgl', details:
  call: fun(libname, pkgname)
  error: Loading failed.
Execution halted
ERROR: lazy loading failed for package 'fsbrain'
* removing 'd:/RCompile/CRANguest/R-oldrelease/lib/fsbrain'
* restoring previous 'd:/RCompile/CRANguest/R-oldrelease/lib/fsbrain'
------------------end-------------------------

The full output of the build process can currently be found at https://win-builder.r-project.org/5Mr7luWmfUNL/

To me it seems that rgl cannot be loaded on the test system, but I do not fully understand the message and what to do about it. I hope somebody here can comment on the message and suggest a solution.

The source code for my package is at https://github.com/dfsp-spirit/fsbrain.

Thanks for your time,

Tim

[1] https://win-builder.r-project.org

--
Dr. Tim Sch?fer
Postdoc Computational Neuroimaging
Department of Child and Adolescent Psychiatry, Psychosomatics and Psychotherapy
University Hospital Frankfurt, Goethe University Frankfurt am Main, Germany


From ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de  Mon Apr 26 23:18:14 2021
From: ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de (Uwe Ligges)
Date: Mon, 26 Apr 2021 23:18:14 +0200
Subject: [R-pkg-devel] Winbuilder error for rgl on R 3.6.3
In-Reply-To: <744913706.118570.1619461921550@ox.hosteurope.de>
References: <744913706.118570.1619461921550@ox.hosteurope.de>
Message-ID: <8ec4ea54-fd78-0996-bc18-5860c5e4d586@statistik.tu-dortmund.de>

What happens if you simply try again?

Best,
Uwe Ligges

On 26.04.2021 20:32, Tim Sch?fer wrote:
> Dear R experts,
> 
> I am testing my R package 'fsbrain' using the Winbuilder service [1] before submitting a new version to CRAN.
> 
> All checks pass under R versions 4.0.5 and 4.1.0 alpha, but the installation fails under R 3.6.3 because of a problem related to rgl, which is a dependency of my package.
> 
> The file 00check.log says 'installation failed' and refers to '00install.log', which contains the following message:
> 
> ------------------Message start-------------------------
> * installing *source* package 'fsbrain' ...
> ** using staged installation
> ** R
> ** inst
> ** byte-compile and prepare package for lazy loading
> Error in system.file(paste0(dir, "/rgl", .Platform$dynlib.ext), package = pkg,  :
>    no file found
> Warning: 	Loading rgl's DLL failed.
> Warning: Trying without OpenGL...
> Error in system.file(paste0(dir, "/rgl", .Platform$dynlib.ext), package = pkg,  :
>    no file found
> Error: .onLoad failed in loadNamespace() for 'rgl', details:
>    call: fun(libname, pkgname)
>    error: Loading failed.
> Execution halted
> ERROR: lazy loading failed for package 'fsbrain'
> * removing 'd:/RCompile/CRANguest/R-oldrelease/lib/fsbrain'
> * restoring previous 'd:/RCompile/CRANguest/R-oldrelease/lib/fsbrain'
> ------------------end-------------------------
> 
> The full output of the build process can currently be found at https://win-builder.r-project.org/5Mr7luWmfUNL/
> 
> To me it seems that rgl cannot be loaded on the test system, but I do not fully understand the message and what to do about it. I hope somebody here can comment on the message and suggest a solution.
> 
> The source code for my package is at https://github.com/dfsp-spirit/fsbrain.
> 
> Thanks for your time,
> 
> Tim
> 
> [1] https://win-builder.r-project.org
> 
> --
> Dr. Tim Sch?fer
> Postdoc Computational Neuroimaging
> Department of Child and Adolescent Psychiatry, Psychosomatics and Psychotherapy
> University Hospital Frankfurt, Goethe University Frankfurt am Main, Germany
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


From r@@y@|@14 @end|ng |rom |mper|@|@@c@uk  Tue Apr 27 12:26:25 2021
From: r@@y@|@14 @end|ng |rom |mper|@|@@c@uk (Ayala Hernandez, Rafael)
Date: Tue, 27 Apr 2021 10:26:25 +0000
Subject: [R-pkg-devel] Large data package
Message-ID: <D786E655-A45E-4C6B-A7ED-6070DF954739@imperial.ac.uk>

Dear all,

I am in the process of including a large update for my package asteRisk, that will require the usage of large data files (amounting in total to ~100 MB).

Given the CRAN package size limits of 5 MB, I am wondering what is the preferred solution in these cases? I have read multiple possibilities, such as requesting to CRAN to host a data-only package that would be updated very infrequently, or hosting the data in another repository and providing functions in the main package to retrieve the required files.

Thanks a lot in advance for your comments

Best wishes,

Rafa

From t@+code @end|ng |rom rcmd@org  Tue Apr 27 12:28:23 2021
From: t@+code @end|ng |rom rcmd@org (=?UTF-8?Q?Tim_Sch=C3=A4fer?=)
Date: Tue, 27 Apr 2021 12:28:23 +0200 (CEST)
Subject: [R-pkg-devel] Winbuilder error for rgl on R 3.6.3
In-Reply-To: <8ec4ea54-fd78-0996-bc18-5860c5e4d586@statistik.tu-dortmund.de>
References: <744913706.118570.1619461921550@ox.hosteurope.de>
 <8ec4ea54-fd78-0996-bc18-5860c5e4d586@statistik.tu-dortmund.de>
Message-ID: <2123588975.128764.1619519303792@ox.hosteurope.de>

Dear Uwe,

It worked this time, thanks. Apparently just a hiccup.

Best,

Tim

> On 04/26/2021 11:18 PM Uwe Ligges <ligges at statistik.tu-dortmund.de> wrote:
> 
>  
> What happens if you simply try again?
> 
> Best,
> Uwe Ligges
> 
> On 26.04.2021 20:32, Tim Sch?fer wrote:
> > Dear R experts,
> > 
> > I am testing my R package 'fsbrain' using the Winbuilder service [1] before submitting a new version to CRAN.
> > 
> > All checks pass under R versions 4.0.5 and 4.1.0 alpha, but the installation fails under R 3.6.3 because of a problem related to rgl, which is a dependency of my package.
> > 
> > The file 00check.log says 'installation failed' and refers to '00install.log', which contains the following message:
> > 
> > ------------------Message start-------------------------
> > * installing *source* package 'fsbrain' ...
> > ** using staged installation
> > ** R
> > ** inst
> > ** byte-compile and prepare package for lazy loading
> > Error in system.file(paste0(dir, "/rgl", .Platform$dynlib.ext), package = pkg,  :
> >    no file found
> > Warning: 	Loading rgl's DLL failed.
> > Warning: Trying without OpenGL...
> > Error in system.file(paste0(dir, "/rgl", .Platform$dynlib.ext), package = pkg,  :
> >    no file found
> > Error: .onLoad failed in loadNamespace() for 'rgl', details:
> >    call: fun(libname, pkgname)
> >    error: Loading failed.
> > Execution halted
> > ERROR: lazy loading failed for package 'fsbrain'
> > * removing 'd:/RCompile/CRANguest/R-oldrelease/lib/fsbrain'
> > * restoring previous 'd:/RCompile/CRANguest/R-oldrelease/lib/fsbrain'
> > ------------------end-------------------------
> > 
> > The full output of the build process can currently be found at https://win-builder.r-project.org/5Mr7luWmfUNL/
> > 
> > To me it seems that rgl cannot be loaded on the test system, but I do not fully understand the message and what to do about it. I hope somebody here can comment on the message and suggest a solution.
> > 
> > The source code for my package is at https://github.com/dfsp-spirit/fsbrain.
> > 
> > Thanks for your time,
> > 
> > Tim
> > 
> > [1] https://win-builder.r-project.org
> > 
> > --
> > Dr. Tim Sch?fer
> > Postdoc Computational Neuroimaging
> > Department of Child and Adolescent Psychiatry, Psychosomatics and Psychotherapy
> > University Hospital Frankfurt, Goethe University Frankfurt am Main, Germany
> > 
> > ______________________________________________
> > R-package-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-package-devel
> >

--
Dr. Tim Sch?fer
Postdoc Computational Neuroimaging
Department of Child and Adolescent Psychiatry, Psychosomatics and Psychotherapy
University Hospital Frankfurt, Goethe University Frankfurt am Main, Germany


From c||9 @end|ng |rom nc@u@edu  Tue Apr 27 18:34:22 2021
From: c||9 @end|ng |rom nc@u@edu (Cai Li)
Date: Tue, 27 Apr 2021 12:34:22 -0400
Subject: [R-pkg-devel] Call internal R functions in C
In-Reply-To: <ecee6aa1-8193-b881-dacb-576c41f2fde9@gmail.com>
References: <CAC5yOjiga0hf8a4GNGSLygmoHtiJQRPyiRUw4RX-_7cDrTJvOg@mail.gmail.com>
 <e028cf6d-3bda-feef-4830-77c265c2c95c@gmail.com>
 <CAC5yOjifUj3-oS5m53K5=-cJKBHNVzmcdpUro1JNJjyUvjmCVQ@mail.gmail.com>
 <ecee6aa1-8193-b881-dacb-576c41f2fde9@gmail.com>
Message-ID: <CAC5yOjif5oLEXSNoYR1OgbZdMRTcOi516H-gCquJnnTASquG+g@mail.gmail.com>

 *Dear Duncan, Thank you very much for your helpful advice! In addition,
could you kindly help answer my follow-up questions below? *

*Instead of passing the private R package environment to C, is there a way
to alter the namespace so that files in the "R" directory of the package
can be read by the C code but not exported to users? There are specialized
export and import functions in the "roxygen2" package that can be used to
alter the namespace, and I'm wondering whether altering the namespace would
work as well
(https://cran.r-project.org/web/packages/roxygen2/vignettes/namespace.html
<https://nam12.safelinks.protection.outlook.com/?url=https%3A%2F%2Fcran.r-project.org%2Fweb%2Fpackages%2Froxygen2%2Fvignettes%2Fnamespace.html&data=04%7C01%7Ccai.li%40yale.edu%7Cfef92ea6326d4803577808d909969553%7Cdd8cbebb21394df8b4114e3e87abeb5c%7C0%7C0%7C637551364617695111%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C1000&sdata=PKtQPhcpncRWSzSY5FrYR2Pcbn6LaYDDX0GhEgVtLtA%3D&reserved=0>).*

*However, if passing the private R package environment to C is the
only/best way for the R functions to be read by C without getting exported,
could you kindly offer additional advice for how to do this? I can pass an
"environment" object from R to C within an SEXP object in C. However, I'm
not sure how to pass the "environment" object between C functions. For
instance, in the following function, could I declare a "char" object and
save the "environment" object as a "char" within the C code?*












*void maketree_diff(int n,               int nc,               double *y,
            double **data,               int *types,               int
*ncat,               int *treat,               struct node *tree,
    int nmin2,               int maxdepth,               int method)*

On Mon, Apr 26, 2021 at 5:30 AM Duncan Murdoch <murdoch.duncan at gmail.com>
wrote:

> On 25/04/2021 10:30 p.m., Cai Li wrote:
> > Thanks Duncan! I was advised not to export those functions in the
> > namespace and keep them as internals. In terms of this, could you advise
> > what specific changes should I make to the C code so that I can evaluate
> > them in a suitable environment? I tried something like
> > "PROTECT(func_R=lang2(install("Package:::R_function"), func_data))," but
> > it did not work. Sorry this may be too naive and thanks again.
>
> That line creates the expression to evaluate, it doesn't evaluate it.
> You need to call eval() (the C function) on the result.  Here's some
> code from rgl that does something similar:
>
> R code to initialize:
>
> rgl.init <- function(initValue = 0, onlyNULL = FALSE, debug =
> getOption("rgl.debug", FALSE))
>    .Call( rgl_init,
>      initValue, onlyNULL, environment(rgl.init), debug )
>
> The important thing here is "environment(rgl.init)", which is the
> private environment within the package.
>
> Then in C code, save that environment:
>
>    rglNamespace = in_namespace;
>
> and use it later:
>
>    result = eval(PROTECT(lang2(PROTECT(install("rglFonts")),
>
> PROTECT(ScalarString(mkChar(family))))), rglNamespace);
>
> Duncan Murdoch
>
> >
> > Cai
> >
> > On Sun, Apr 25, 2021 at 8:46 PM Duncan Murdoch <murdoch.duncan at gmail.com
> > <mailto:murdoch.duncan at gmail.com>> wrote:
> >
> >     On 25/04/2021 7:23 p.m., Cai Li wrote:
> >      > Hello All,
> >      >
> >      > I'm developing a package with C code. My question may be naive: I
> >     have
> >      > several internal R functions that need to be called by C, but I
> >     cannot get
> >      > it to work or find a solution. It can work if I export those
> internal
> >      > functions in namespace, but it fails if I just want to keep them
> as
> >      > internal functions without exporting them. I guess I need some
> >     flags to
> >      > indicate the "internal" R internal functions? Could you please
> >     share your
> >      > thoughts on how to fix this? Much appreciated in advance!
> >      >
> >      > //   set up call to R function "R_function"
> >      >      SEXP func_R;
> >      >      PROTECT(func_R=lang2(install("R_function"), func_data));
> >      >
> >
> >     It all depends on the environment where you evaluate that expression,
> >     just as it would if it was R code.  You can't see internal package
> >     functions from the global environment, you need to evaluate them in
> the
> >     package namespace environment.
> >
> >     Duncan Murdoch
> >
>
>

	[[alternative HTML version deleted]]


From edd @end|ng |rom deb|@n@org  Wed Apr 28 00:04:44 2021
From: edd @end|ng |rom deb|@n@org (Dirk Eddelbuettel)
Date: Tue, 27 Apr 2021 17:04:44 -0500
Subject: [R-pkg-devel] Large data package
In-Reply-To: <D786E655-A45E-4C6B-A7ED-6070DF954739@imperial.ac.uk>
References: <D786E655-A45E-4C6B-A7ED-6070DF954739@imperial.ac.uk>
Message-ID: <24712.35452.971015.959559@rob.eddelbuettel.com>


On 27 April 2021 at 10:26, Ayala Hernandez, Rafael wrote:
| I am in the process of including a large update for my package asteRisk, that will require the usage of large data files (amounting in total to ~100 MB).
| 
| Given the CRAN package size limits of 5 MB, I am wondering what is the preferred solution in these cases? I have read multiple possibilities, such as requesting to CRAN to host a data-only package that would be updated very infrequently, or hosting the data in another repository and providing functions in the main package to retrieve the required files.

In case you have not seen it yet, the R Journal article Brooke and I wrote a
few years ago covers exactly this use case, and walks through how to cover it
in a fairly detailed way.

https://journal.r-project.org/archive/2017/RJ-2017-026/index.html

@article{RJ-2017-026,
  author = {G. Brooke Anderson and Dirk Eddelbuettel},
  title = {{Hosting Data Packages via drat: A Case Study with Hurricane
          Exposure Data}},
  year = {2017},
  journal = {{The R Journal}},
  doi = {10.32614/RJ-2017-026},
  url = {https://doi.org/10.32614/RJ-2017-026},
  pages = {486--497},
  volume = {9},
  number = {1}
}

Hope this helps, Dirk

-- 
https://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From r@@y@|@14 @end|ng |rom |mper|@|@@c@uk  Wed Apr 28 00:09:18 2021
From: r@@y@|@14 @end|ng |rom |mper|@|@@c@uk (Ayala Hernandez, Rafael)
Date: Tue, 27 Apr 2021 22:09:18 +0000
Subject: [R-pkg-devel] Large data package
In-Reply-To: <24712.35452.971015.959559@rob.eddelbuettel.com>
References: <D786E655-A45E-4C6B-A7ED-6070DF954739@imperial.ac.uk>
 <24712.35452.971015.959559@rob.eddelbuettel.com>
Message-ID: <DC9EDCE6-A900-438F-B3FD-2F9896F40201@imperial.ac.uk>

Dear Dirk and Berry,

Thanks a lot for your input and for pointing me to the very nice article on the R Journal. It seems to me that hosting the data via GitHub and 

> El 28 abr 2021, a las 0:04, Dirk Eddelbuettel <edd at debian.org> escribi?:
> 
> 
> *******************
> This email originates from outside Imperial. Do not click on links and attachments unless you recognise the sender. 
> If you trust the sender, add them to your safe senders list https://spam.ic.ac.uk/SpamConsole/Senders.aspx to disable email stamping for this address.
> *******************
> 
> On 27 April 2021 at 10:26, Ayala Hernandez, Rafael wrote:
> | I am in the process of including a large update for my package asteRisk, that will require the usage of large data files (amounting in total to ~100 MB).
> | 
> | Given the CRAN package size limits of 5 MB, I am wondering what is the preferred solution in these cases? I have read multiple possibilities, such as requesting to CRAN to host a data-only package that would be updated very infrequently, or hosting the data in another repository and providing functions in the main package to retrieve the required files.
> 
> In case you have not seen it yet, the R Journal article Brooke and I wrote a
> few years ago covers exactly this use case, and walks through how to cover it
> in a fairly detailed way.
> 
> https://journal.r-project.org/archive/2017/RJ-2017-026/index.html
> 
> @article{RJ-2017-026,
>  author = {G. Brooke Anderson and Dirk Eddelbuettel},
>  title = {{Hosting Data Packages via drat: A Case Study with Hurricane
>          Exposure Data}},
>  year = {2017},
>  journal = {{The R Journal}},
>  doi = {10.32614/RJ-2017-026},
>  url = {https://doi.org/10.32614/RJ-2017-026},
>  pages = {486--497},
>  volume = {9},
>  number = {1}
> }
> 
> Hope this helps, Dirk
> 
> -- 
> https://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From r@@y@|@14 @end|ng |rom |mper|@|@@c@uk  Wed Apr 28 00:10:23 2021
From: r@@y@|@14 @end|ng |rom |mper|@|@@c@uk (Ayala Hernandez, Rafael)
Date: Tue, 27 Apr 2021 22:10:23 +0000
Subject: [R-pkg-devel] Large data package
In-Reply-To: <24712.35452.971015.959559@rob.eddelbuettel.com>
References: <D786E655-A45E-4C6B-A7ED-6070DF954739@imperial.ac.uk>
 <24712.35452.971015.959559@rob.eddelbuettel.com>
Message-ID: <11523683-D13B-45AD-B11E-F800E767863E@imperial.ac.uk>

Dear Dirk and Berry,

Thanks a lot for your input and for pointing me to the very nice article on the R Journal. It seems to me that hosting the data via GitHub by using the drat package is the best solution. I will work towards this implementation.

Best wishes,

Rafa

> El 28 abr 2021, a las 0:04, Dirk Eddelbuettel <edd at debian.org> escribi?:
> 
> 
> *******************
> This email originates from outside Imperial. Do not click on links and attachments unless you recognise the sender. 
> If you trust the sender, add them to your safe senders list https://spam.ic.ac.uk/SpamConsole/Senders.aspx to disable email stamping for this address.
> *******************
> 
> On 27 April 2021 at 10:26, Ayala Hernandez, Rafael wrote:
> | I am in the process of including a large update for my package asteRisk, that will require the usage of large data files (amounting in total to ~100 MB).
> | 
> | Given the CRAN package size limits of 5 MB, I am wondering what is the preferred solution in these cases? I have read multiple possibilities, such as requesting to CRAN to host a data-only package that would be updated very infrequently, or hosting the data in another repository and providing functions in the main package to retrieve the required files.
> 
> In case you have not seen it yet, the R Journal article Brooke and I wrote a
> few years ago covers exactly this use case, and walks through how to cover it
> in a fairly detailed way.
> 
> https://journal.r-project.org/archive/2017/RJ-2017-026/index.html
> 
> @article{RJ-2017-026,
>  author = {G. Brooke Anderson and Dirk Eddelbuettel},
>  title = {{Hosting Data Packages via drat: A Case Study with Hurricane
>          Exposure Data}},
>  year = {2017},
>  journal = {{The R Journal}},
>  doi = {10.32614/RJ-2017-026},
>  url = {https://doi.org/10.32614/RJ-2017-026},
>  pages = {486--497},
>  volume = {9},
>  number = {1}
> }
> 
> Hope this helps, Dirk
> 
> -- 
> https://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From h@n@on @end|ng |rom dep@uw@edu  Wed Apr 28 00:29:00 2021
From: h@n@on @end|ng |rom dep@uw@edu (Bryan Hanson)
Date: Tue, 27 Apr 2021 15:29:00 -0700
Subject: [R-pkg-devel] Large data package
In-Reply-To: <DC9EDCE6-A900-438F-B3FD-2F9896F40201@imperial.ac.uk>
References: <D786E655-A45E-4C6B-A7ED-6070DF954739@imperial.ac.uk>
 <24712.35452.971015.959559@rob.eddelbuettel.com>
 <DC9EDCE6-A900-438F-B3FD-2F9896F40201@imperial.ac.uk>
Message-ID: <BEC71D6E-F3DA-4A15-A7CE-55C5C761FC3D@depauw.edu>

Here?s a blog post on using drat with github actions to make data deployment to drat automatic.  Maybe more than you need.

Disclaimer, I?m the post author.  Bryan

https://chemospec.org/2021/04/11/p19/ <https://chemospec.org/2021/04/11/p19/>


> On Apr 27, 2021, at 3:09 PM, Ayala Hernandez, Rafael <r.ayala14 at imperial.ac.uk> wrote:
> 
> Dear Dirk and Berry,
> 
> Thanks a lot for your input and for pointing me to the very nice article on the R Journal. It seems to me that hosting the data via GitHub and 
> 
>> El 28 abr 2021, a las 0:04, Dirk Eddelbuettel <edd at debian.org> escribi?:
>> 
>> 
>> *******************
>> This email originates from outside Imperial. Do not click on links and attachments unless you recognise the sender. 
>> If you trust the sender, add them to your safe senders list https://spam.ic.ac.uk/SpamConsole/Senders.aspx to disable email stamping for this address.
>> *******************
>> 
>> On 27 April 2021 at 10:26, Ayala Hernandez, Rafael wrote:
>> | I am in the process of including a large update for my package asteRisk, that will require the usage of large data files (amounting in total to ~100 MB).
>> | 
>> | Given the CRAN package size limits of 5 MB, I am wondering what is the preferred solution in these cases? I have read multiple possibilities, such as requesting to CRAN to host a data-only package that would be updated very infrequently, or hosting the data in another repository and providing functions in the main package to retrieve the required files.
>> 
>> In case you have not seen it yet, the R Journal article Brooke and I wrote a
>> few years ago covers exactly this use case, and walks through how to cover it
>> in a fairly detailed way.
>> 
>> https://journal.r-project.org/archive/2017/RJ-2017-026/index.html
>> 
>> @article{RJ-2017-026,
>> author = {G. Brooke Anderson and Dirk Eddelbuettel},
>> title = {{Hosting Data Packages via drat: A Case Study with Hurricane
>>         Exposure Data}},
>> year = {2017},
>> journal = {{The R Journal}},
>> doi = {10.32614/RJ-2017-026},
>> url = {https://doi.org/10.32614/RJ-2017-026},
>> pages = {486--497},
>> volume = {9},
>> number = {1}
>> }
>> 
>> Hope this helps, Dirk
>> 
>> -- 
>> https://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


	[[alternative HTML version deleted]]


From c@m@ty| @end|ng |rom protonm@||@com  Wed Apr 28 07:11:24 2021
From: c@m@ty| @end|ng |rom protonm@||@com (csmatyi)
Date: Wed, 28 Apr 2021 05:11:24 +0000
Subject: [R-pkg-devel] creating a function that creates a figure
Message-ID: <Nxzrm9-bg1IPz7ubqYaBgtNa49eNH228HzbLxSEaU7NPcSRN9CRJhrwbI_u9XcXFa9moE1iGBL-SQQijrTeLCIXX6KZaIpICoDfY-bQK3LI=@protonmail.com>

Hello all,

Normally, when you write a function in R, it returns a value. That way it is easy to write an .Rd file for this function.

However, I have written a function that does no such thing. Rather, it takes as input two data frames, and creates a figure. But doesn't return anything.

In R package language, how do I write the examples in the .R file when I need to define the input variable first as a data frame? I can't just write it as

add(1,2) which returns 3.

Any help?

Thanks so much,
Matthew

Sent with [ProtonMail](https://protonmail.com) Secure Email.
	[[alternative HTML version deleted]]


From o||ver@p@m@d@en @end|ng |rom gm@||@com  Wed Apr 28 07:20:26 2021
From: o||ver@p@m@d@en @end|ng |rom gm@||@com (Oliver Madsen)
Date: Wed, 28 Apr 2021 07:20:26 +0200
Subject: [R-pkg-devel] creating a function that creates a figure
In-Reply-To: <Nxzrm9-bg1IPz7ubqYaBgtNa49eNH228HzbLxSEaU7NPcSRN9CRJhrwbI_u9XcXFa9moE1iGBL-SQQijrTeLCIXX6KZaIpICoDfY-bQK3LI=@protonmail.com>
References: <Nxzrm9-bg1IPz7ubqYaBgtNa49eNH228HzbLxSEaU7NPcSRN9CRJhrwbI_u9XcXFa9moE1iGBL-SQQijrTeLCIXX6KZaIpICoDfY-bQK3LI=@protonmail.com>
Message-ID: <CAFL8AHr2jBePpc3AzftTAK46TpvTZ=79QfugeNr-RpkZnn=EmQ@mail.gmail.com>

2 standard options are to either use an example dataset (eg. data(mtcars))
that fits your function. help(glm) has an example using the anorexia
dataset. A second option is to create toy data in the example itself. Both
help(lm) and help(glm) has examples doing so.

Br
Oliver P. M.

On Wed, 28 Apr 2021, 07:11 csmatyi, <csmatyi at protonmail.com> wrote:

> Hello all,
>
> Normally, when you write a function in R, it returns a value. That way it
> is easy to write an .Rd file for this function.
>
> However, I have written a function that does no such thing. Rather, it
> takes as input two data frames, and creates a figure. But doesn't return
> anything.
>
> In R package language, how do I write the examples in the .R file when I
> need to define the input variable first as a data frame? I can't just write
> it as
>
> add(1,2) which returns 3.
>
> Any help?
>
> Thanks so much,
> Matthew
>
> Sent with [ProtonMail](https://protonmail.com) Secure Email.
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From m@e@e005 @end|ng |rom umn@edu  Wed Apr 28 20:44:00 2021
From: m@e@e005 @end|ng |rom umn@edu (Danielle Maeser)
Date: Wed, 28 Apr 2021 13:44:00 -0500
Subject: [R-pkg-devel] R vignettes
Message-ID: <CA+YOmB8Hj6LLV=2=iYL-ASTN_iv-K4TEqexNdk32d+Ehu8Xnbg@mail.gmail.com>

Hello,

I am doing a R CMD check on an R package I have developed. However, I keep
receiving the warning below:

*Files in the 'vignettes' directory but no files in 'inst/doc':*

And

*Files named as vignettes but with no recognized vignette engine:*

I am pretty sure I have the correct YAML header for my vignettes, and also
inst/docs is an older convention for vignettes that's no longer
recommended.

Do you have an idea of what's going wrong? I have attached my YAML header
below as reference.

Sincerely,
Danielle







*title: "title of this vignette"author: "name"output:
markdown::html_vignettevignette: >  %\VignetteIndexEntry{vignette title}
%\VignetteEngine{knitr::markdown}  %\VignetteEncoding{UTF-8}*
-- 
Ph.D. Student
Bioinformatics and Computational Biology
University of Minnesota

	[[alternative HTML version deleted]]


From murdoch@dunc@n @end|ng |rom gm@||@com  Wed Apr 28 21:27:02 2021
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Wed, 28 Apr 2021 15:27:02 -0400
Subject: [R-pkg-devel] R vignettes
In-Reply-To: <CA+YOmB8Hj6LLV=2=iYL-ASTN_iv-K4TEqexNdk32d+Ehu8Xnbg@mail.gmail.com>
References: <CA+YOmB8Hj6LLV=2=iYL-ASTN_iv-K4TEqexNdk32d+Ehu8Xnbg@mail.gmail.com>
Message-ID: <a6b82f33-ca3e-06dd-8558-13d415669abc@gmail.com>

On 28/04/2021 2:44 p.m., Danielle Maeser wrote:
> Hello,
> 
> I am doing a R CMD check on an R package I have developed. However, I keep
> receiving the warning below:
> 
> *Files in the 'vignettes' directory but no files in 'inst/doc':*
> 
> And
> 
> *Files named as vignettes but with no recognized vignette engine:*
> 
> I am pretty sure I have the correct YAML header for my vignettes, and also
> inst/docs is an older convention for vignettes that's no longer
> recommended.
> 
> Do you have an idea of what's going wrong? I have attached my YAML header
> below as reference.

You may be missing the line

   VignetteBuilder: knitr

in your DESCRIPTION file.  Without that, R won't know how to interpret 
your vignette.

It's also a little unusual to use

   %\VignetteEngine{knitr::markdown}

nowadays; the more common engine is knitr::rmarkdown (but I believe both 
are still supported).  If you make this change you should also have

   rmarkdown::html_vignette

as the output format.

Finally, since a recent update of knitr, you need to make sure that 
package holding the output format (i.e. markdown currently, rmarkdown if 
you make the change above) is declared as a Suggested package in your 
DESCRIPTION file.

Duncan Murdoch

> 
> Sincerely,
> Danielle
> 
> 
> 
> 
> 
> 
> 
> *title: "title of this vignette"author: "name"output:
> markdown::html_vignettevignette: >  %\VignetteIndexEntry{vignette title}
> %\VignetteEngine{knitr::markdown}  %\VignetteEncoding{UTF-8}*
>


From m@e@e005 @end|ng |rom umn@edu  Wed Apr 28 22:41:27 2021
From: m@e@e005 @end|ng |rom umn@edu (Danielle Maeser)
Date: Wed, 28 Apr 2021 15:41:27 -0500
Subject: [R-pkg-devel] R vignettes
In-Reply-To: <a6b82f33-ca3e-06dd-8558-13d415669abc@gmail.com>
References: <CA+YOmB8Hj6LLV=2=iYL-ASTN_iv-K4TEqexNdk32d+Ehu8Xnbg@mail.gmail.com>
 <a6b82f33-ca3e-06dd-8558-13d415669abc@gmail.com>
Message-ID: <CA+YOmB8_vfMigZ2JBnHBR+6LTpU_qgS6r1aXqStSbDKq08tzmw@mail.gmail.com>

Hi Duncan,

Thank you for your feedback!

Unfortunately, when I made the changes recommended I have a new error:


*trying to use CRAN without setting a mirror*

And:
*Error: 'col_ed' is not an exported object from 'namespace:cli'*

My description file includes:







*VignetteBuilder: knitrDepends: R (>= 4.0), knitrLicense: GPL-2Encoding:
UTF-8Roxygen: list(rmarkdown = TRUE)RoxygenNote: 7.1.1  LazyData:
trueSuggests: knitr, rmarkdown*

And my vignette includes:






*title: "title"author: "name"output: rmarkdown::html_vignettevignette: >
%\VignetteIndexEntry{title}  %\VignetteEngine{knitr::rmarkdown}
%\VignetteEncoding{UTF-8}*

I'd appreciate any advice!

Danielle

On Wed, Apr 28, 2021 at 2:27 PM Duncan Murdoch <murdoch.duncan at gmail.com>
wrote:

> On 28/04/2021 2:44 p.m., Danielle Maeser wrote:
> > Hello,
> >
> > I am doing a R CMD check on an R package I have developed. However, I
> keep
> > receiving the warning below:
> >
> > *Files in the 'vignettes' directory but no files in 'inst/doc':*
> >
> > And
> >
> > *Files named as vignettes but with no recognized vignette engine:*
> >
> > I am pretty sure I have the correct YAML header for my vignettes, and
> also
> > inst/docs is an older convention for vignettes that's no longer
> > recommended.
> >
> > Do you have an idea of what's going wrong? I have attached my YAML header
> > below as reference.
>
> You may be missing the line
>
>    VignetteBuilder: knitr
>
> in your DESCRIPTION file.  Without that, R won't know how to interpret
> your vignette.
>
> It's also a little unusual to use
>
>    %\VignetteEngine{knitr::markdown}
>
> nowadays; the more common engine is knitr::rmarkdown (but I believe both
> are still supported).  If you make this change you should also have
>
>    rmarkdown::html_vignette
>
> as the output format.
>
> Finally, since a recent update of knitr, you need to make sure that
> package holding the output format (i.e. markdown currently, rmarkdown if
> you make the change above) is declared as a Suggested package in your
> DESCRIPTION file.
>
> Duncan Murdoch
>
> >
> > Sincerely,
> > Danielle
> >
> >
> >
> >
> >
> >
> >
> > *title: "title of this vignette"author: "name"output:
> > markdown::html_vignettevignette: >  %\VignetteIndexEntry{vignette title}
> > %\VignetteEngine{knitr::markdown}  %\VignetteEncoding{UTF-8}*
> >
>
>

-- 
Ph.D. Student
Bioinformatics and Computational Biology
University of Minnesota

	[[alternative HTML version deleted]]


From murdoch@dunc@n @end|ng |rom gm@||@com  Thu Apr 29 02:32:53 2021
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Wed, 28 Apr 2021 20:32:53 -0400
Subject: [R-pkg-devel] R vignettes
In-Reply-To: <CA+YOmB8_vfMigZ2JBnHBR+6LTpU_qgS6r1aXqStSbDKq08tzmw@mail.gmail.com>
References: <CA+YOmB8Hj6LLV=2=iYL-ASTN_iv-K4TEqexNdk32d+Ehu8Xnbg@mail.gmail.com>
 <a6b82f33-ca3e-06dd-8558-13d415669abc@gmail.com>
 <CA+YOmB8_vfMigZ2JBnHBR+6LTpU_qgS6r1aXqStSbDKq08tzmw@mail.gmail.com>
Message-ID: <fedc3733-d8aa-123d-caf7-293df149d214@gmail.com>

On 28/04/2021 4:41 p.m., Danielle Maeser wrote:
> Hi Duncan,
> 
> Thank you for your feedback!
> 
> Unfortunately, when I made the changes recommended I have a new error:
> 
> *trying to use CRAN without setting a mirror

That would be a result of your code.  Do you call install.packages() in 
one of your functions?  Normally you shouldn't do that.

> *
> 
> And:
> *Error: 'col_ed' is not an exported object from 'namespace:cli'*

Similarly, something in your code or NAMESPACE file.  Do you refer to 
cli::col_ed, or try to import col_ed from cli?

> *
> *
> My description file includes:
> *VignetteBuilder: knitr
> Depends: R (>= 4.0), knitr
> License: GPL-2
> Encoding: UTF-8
> Roxygen: list(rmarkdown = TRUE)
> RoxygenNote: 7.1.1
> LazyData: true

Do you really have a data subdir in your package? You shouldn't have the 
LazyData line without one.

> Suggests: knitr, rmarkdown*

You shouldn't list knitr in both Depends and Suggests.

Duncan Murdoch

> *
> *
> And my vignette includes:
> *title: "title"
> author: "name"
> output: rmarkdown::html_vignette
> vignette: >
>  ? %\VignetteIndexEntry{title}
>  ? %\VignetteEngine{knitr::rmarkdown}
>  ? %\VignetteEncoding{UTF-8}*
> *
> *
> I'd appreciate any advice!
> 
> Danielle
> 
> On Wed, Apr 28, 2021 at 2:27 PM Duncan Murdoch <murdoch.duncan at gmail.com 
> <mailto:murdoch.duncan at gmail.com>> wrote:
> 
>     On 28/04/2021 2:44 p.m., Danielle Maeser wrote:
>      > Hello,
>      >
>      > I am doing a R CMD check on an R package I have developed.
>     However, I keep
>      > receiving the warning below:
>      >
>      > *Files in the 'vignettes' directory but no files in 'inst/doc':*
>      >
>      > And
>      >
>      > *Files named as vignettes but with no recognized vignette engine:*
>      >
>      > I am pretty sure I have the correct YAML header for my vignettes,
>     and also
>      > inst/docs is an older convention for vignettes that's no longer
>      > recommended.
>      >
>      > Do you have an idea of what's going wrong? I have attached my
>     YAML header
>      > below as reference.
> 
>     You may be missing the line
> 
>      ? ?VignetteBuilder: knitr
> 
>     in your DESCRIPTION file.? Without that, R won't know how to interpret
>     your vignette.
> 
>     It's also a little unusual to use
> 
>      ? ?%\VignetteEngine{knitr::markdown}
> 
>     nowadays; the more common engine is knitr::rmarkdown (but I believe
>     both
>     are still supported).? If you make this change you should also have
> 
>      ? ?rmarkdown::html_vignette
> 
>     as the output format.
> 
>     Finally, since a recent update of knitr, you need to make sure that
>     package holding the output format (i.e. markdown currently,
>     rmarkdown if
>     you make the change above) is declared as a Suggested package in your
>     DESCRIPTION file.
> 
>     Duncan Murdoch
> 
>      >
>      > Sincerely,
>      > Danielle
>      >
>      >
>      >
>      >
>      >
>      >
>      >
>      > *title: "title of this vignette"author: "name"output:
>      > markdown::html_vignettevignette: >? %\VignetteIndexEntry{vignette
>     title}
>      > %\VignetteEngine{knitr::markdown}? %\VignetteEncoding{UTF-8}*
>      >
> 
> 
> 
> -- 
> Ph.D. Student
> Bioinformatics and?Computational?Biology
> University of Minnesota
>


From e|corteg@no @end|ng |rom gm@||@com  Thu Apr 29 15:45:21 2021
From: e|corteg@no @end|ng |rom gm@||@com (=?UTF-8?Q?Eugenio_L=C3=B3pez_Cortegano?=)
Date: Thu, 29 Apr 2021 14:45:21 +0100
Subject: [R-pkg-devel] Including references in the DESCRIPTION file
Message-ID: <CAGjgynbru2443zo+0iSu6AniZ9En_ZLAxKHA=T2T57keAZDvbg@mail.gmail.com>

Hi all,

I have been asked by a CRAN member to add references for methods used in
the package, in the description file of DESCRIPTION.

The format to do so seems to be:

authors (year) <doi...>
authors (year) <arXiv:...>
authors (year, ISBN:...)

However, I feel a bit unconfident about how to properly include these
changes, since I haven't find any other examples providing this information
in DESCRIPTION, and what I have read in 'Writing R extensions' is that the
Description field should be just one paragraph. Including these references
at the end of that field seems to break that rule to me.

Does anyone have experience with this or could provide a little more advice
about how to implement these changes?

Thank you,
Eugenio

	[[alternative HTML version deleted]]


From e|corteg@no @end|ng |rom gm@||@com  Thu Apr 29 15:58:29 2021
From: e|corteg@no @end|ng |rom gm@||@com (=?UTF-8?Q?Eugenio_L=C3=B3pez_Cortegano?=)
Date: Thu, 29 Apr 2021 14:58:29 +0100
Subject: [R-pkg-devel] Including references in the DESCRIPTION file
In-Reply-To: <2D8E2813-5F90-494C-9D32-6E2F870A449B@oist.jp>
References: <CAGjgynbru2443zo+0iSu6AniZ9En_ZLAxKHA=T2T57keAZDvbg@mail.gmail.com>
 <2D8E2813-5F90-494C-9D32-6E2F870A449B@oist.jp>
Message-ID: <CAGjgynbAgC8k2LTy7xjORxpxjo_toQD2rJckx4ny6Q9c69LZOA@mail.gmail.com>

Hi Rafa,

Thank you very much for the feedback, appreciate the help, it is very clear
that way!

Best,
Eugenio

On Thu, 29 Apr 2021 at 14:53, Rafael Ayala Hernandez <
Rafael.AyalaHernandez at oist.jp> wrote:

> Hi Eugenio,
>
> I was recently asked a similar addition from the CRAN team for my package
> asteRisk (https://cran.r-project.org/web/packages/asteRisk/index.html)
>
> I just added some of the main references, since including all references
> would have made the Description field too long.
> I was not asked this previously for other packages, so it might be it only
> applies for lesser known fields, or it might be a new policy
>
> Best wishes,
>
> Rafa
>
> > El 29 abr 2021, a las 15:45, Eugenio L?pez Cortegano <
> elcortegano at gmail.com> escribi?:
> >
> > Hi all,
> >
> > I have been asked by a CRAN member to add references for methods used in
> > the package, in the description file of DESCRIPTION.
> >
> > The format to do so seems to be:
> >
> > authors (year) <doi...>
> > authors (year) <arXiv:...>
> > authors (year, ISBN:...)
> >
> > However, I feel a bit unconfident about how to properly include these
> > changes, since I haven't find any other examples providing this
> information
> > in DESCRIPTION, and what I have read in 'Writing R extensions' is that
> the
> > Description field should be just one paragraph. Including these
> references
> > at the end of that field seems to break that rule to me.
> >
> > Does anyone have experience with this or could provide a little more
> advice
> > about how to implement these changes?
> >
> > Thank you,
> > Eugenio
> >
> >       [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-package-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-package-devel
>
>

	[[alternative HTML version deleted]]


From bett|n@@gruen @end|ng |rom wu@@c@@t  Thu Apr 29 16:04:44 2021
From: bett|n@@gruen @end|ng |rom wu@@c@@t (=?utf-8?B?R3LDvG4sIEJldHRpbmE=?=)
Date: Thu, 29 Apr 2021 14:04:44 +0000
Subject: [R-pkg-devel] Including references in the DESCRIPTION file
In-Reply-To: <CAGjgynbru2443zo+0iSu6AniZ9En_ZLAxKHA=T2T57keAZDvbg@mail.gmail.com>
References: <CAGjgynbru2443zo+0iSu6AniZ9En_ZLAxKHA=T2T57keAZDvbg@mail.gmail.com>
Message-ID: <b8ae8087-106e-b559-1d4a-e8bfeca65cc9@wu.ac.at>

Eugenio,

the CRAN submission checklist available at

https://cran.r-project.org/web/packages/submission_checklist.html

contains some information on how to write a suitable Description entry in 
the DESCRIPTION file for CRAN packages.

This contains:

o Make the Description as informative as possible for potential new users 
of your package. If in doubt, make the Description longer rather than 
shorter, but try to avoid redundancies such as repetitions of the package name.

as well as

o Relevant citations should be included in the description. These should be 
in author-year style, preferably followed by an identifier such as DOI, 
arXiv id, or ISBN for published materials.

Best,
Bettina

On 4/29/21 3:45 PM, Eugenio L?pez Cortegano wrote:
> Hi all,
> 
> I have been asked by a CRAN member to add references for methods used in
> the package, in the description file of DESCRIPTION.
> 
> The format to do so seems to be:
> 
> authors (year) <doi...>
> authors (year) <arXiv:...>
> authors (year, ISBN:...)
> 
> However, I feel a bit unconfident about how to properly include these
> changes, since I haven't find any other examples providing this information
> in DESCRIPTION, and what I have read in 'Writing R extensions' is that the
> Description field should be just one paragraph. Including these references
> at the end of that field seems to break that rule to me.
> 
> Does anyone have experience with this or could provide a little more advice
> about how to implement these changes?
> 
> Thank you,
> Eugenio
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
> 



From m@e@e005 @end|ng |rom umn@edu  Thu Apr 29 18:28:56 2021
From: m@e@e005 @end|ng |rom umn@edu (Danielle Maeser)
Date: Thu, 29 Apr 2021 11:28:56 -0500
Subject: [R-pkg-devel] R vignettes
In-Reply-To: <fedc3733-d8aa-123d-caf7-293df149d214@gmail.com>
References: <CA+YOmB8Hj6LLV=2=iYL-ASTN_iv-K4TEqexNdk32d+Ehu8Xnbg@mail.gmail.com>
 <a6b82f33-ca3e-06dd-8558-13d415669abc@gmail.com>
 <CA+YOmB8_vfMigZ2JBnHBR+6LTpU_qgS6r1aXqStSbDKq08tzmw@mail.gmail.com>
 <fedc3733-d8aa-123d-caf7-293df149d214@gmail.com>
Message-ID: <CA+YOmB-onC0cCj=sO0ANDTL+KBNrOCZBg42mjP-WeedeVQ2WiA@mail.gmail.com>

Hi Duncan,

I really appreciate your response. Unfortunately, I am still receiving the
error below.

If anyone has ideas, I'd appreciate it!

This is the only online forum I can find that discusses the error, but I
have not found it helpful: https://github.com/r-lib/cli/issues/94




*   ERROR: package installation failedError: 'col_ed' is not an exported
object from 'namespace:cli'Execution halted*

On Wed, Apr 28, 2021 at 7:32 PM Duncan Murdoch <murdoch.duncan at gmail.com>
wrote:

> On 28/04/2021 4:41 p.m., Danielle Maeser wrote:
> > Hi Duncan,
> >
> > Thank you for your feedback!
> >
> > Unfortunately, when I made the changes recommended I have a new error:
> >
> > *trying to use CRAN without setting a mirror
>
> That would be a result of your code.  Do you call install.packages() in
> one of your functions?  Normally you shouldn't do that.
>
> > *
> >
> > And:
> > *Error: 'col_ed' is not an exported object from 'namespace:cli'*
>
> Similarly, something in your code or NAMESPACE file.  Do you refer to
> cli::col_ed, or try to import col_ed from cli?
>
> > *
> > *
> > My description file includes:
> > *VignetteBuilder: knitr
> > Depends: R (>= 4.0), knitr
> > License: GPL-2
> > Encoding: UTF-8
> > Roxygen: list(rmarkdown = TRUE)
> > RoxygenNote: 7.1.1
> > LazyData: true
>
> Do you really have a data subdir in your package? You shouldn't have the
> LazyData line without one.
>
> > Suggests: knitr, rmarkdown*
>
> You shouldn't list knitr in both Depends and Suggests.
>
> Duncan Murdoch
>
> > *
> > *
> > And my vignette includes:
> > *title: "title"
> > author: "name"
> > output: rmarkdown::html_vignette
> > vignette: >
> >    %\VignetteIndexEntry{title}
> >    %\VignetteEngine{knitr::rmarkdown}
> >    %\VignetteEncoding{UTF-8}*
> > *
> > *
> > I'd appreciate any advice!
> >
> > Danielle
> >
> > On Wed, Apr 28, 2021 at 2:27 PM Duncan Murdoch <murdoch.duncan at gmail.com
> > <mailto:murdoch.duncan at gmail.com>> wrote:
> >
> >     On 28/04/2021 2:44 p.m., Danielle Maeser wrote:
> >      > Hello,
> >      >
> >      > I am doing a R CMD check on an R package I have developed.
> >     However, I keep
> >      > receiving the warning below:
> >      >
> >      > *Files in the 'vignettes' directory but no files in 'inst/doc':*
> >      >
> >      > And
> >      >
> >      > *Files named as vignettes but with no recognized vignette engine:*
> >      >
> >      > I am pretty sure I have the correct YAML header for my vignettes,
> >     and also
> >      > inst/docs is an older convention for vignettes that's no longer
> >      > recommended.
> >      >
> >      > Do you have an idea of what's going wrong? I have attached my
> >     YAML header
> >      > below as reference.
> >
> >     You may be missing the line
> >
> >         VignetteBuilder: knitr
> >
> >     in your DESCRIPTION file.  Without that, R won't know how to
> interpret
> >     your vignette.
> >
> >     It's also a little unusual to use
> >
> >         %\VignetteEngine{knitr::markdown}
> >
> >     nowadays; the more common engine is knitr::rmarkdown (but I believe
> >     both
> >     are still supported).  If you make this change you should also have
> >
> >         rmarkdown::html_vignette
> >
> >     as the output format.
> >
> >     Finally, since a recent update of knitr, you need to make sure that
> >     package holding the output format (i.e. markdown currently,
> >     rmarkdown if
> >     you make the change above) is declared as a Suggested package in your
> >     DESCRIPTION file.
> >
> >     Duncan Murdoch
> >
> >      >
> >      > Sincerely,
> >      > Danielle
> >      >
> >      >
> >      >
> >      >
> >      >
> >      >
> >      >
> >      > *title: "title of this vignette"author: "name"output:
> >      > markdown::html_vignettevignette: >  %\VignetteIndexEntry{vignette
> >     title}
> >      > %\VignetteEngine{knitr::markdown}  %\VignetteEncoding{UTF-8}*
> >      >
> >
> >
> >
> > --
> > Ph.D. Student
> > Bioinformatics and Computational Biology
> > University of Minnesota
> >
>
>

-- 
Ph.D. Student
Bioinformatics and Computational Biology
University of Minnesota

	[[alternative HTML version deleted]]


From c@@rd|@g@bor @end|ng |rom gm@||@com  Thu Apr 29 18:41:36 2021
From: c@@rd|@g@bor @end|ng |rom gm@||@com (=?UTF-8?B?R8OhYm9yIENzw6FyZGk=?=)
Date: Thu, 29 Apr 2021 18:41:36 +0200
Subject: [R-pkg-devel] R vignettes
In-Reply-To: <CA+YOmB-onC0cCj=sO0ANDTL+KBNrOCZBg42mjP-WeedeVQ2WiA@mail.gmail.com>
References: <CA+YOmB8Hj6LLV=2=iYL-ASTN_iv-K4TEqexNdk32d+Ehu8Xnbg@mail.gmail.com>
 <a6b82f33-ca3e-06dd-8558-13d415669abc@gmail.com>
 <CA+YOmB8_vfMigZ2JBnHBR+6LTpU_qgS6r1aXqStSbDKq08tzmw@mail.gmail.com>
 <fedc3733-d8aa-123d-caf7-293df149d214@gmail.com>
 <CA+YOmB-onC0cCj=sO0ANDTL+KBNrOCZBg42mjP-WeedeVQ2WiA@mail.gmail.com>
Message-ID: <CABtg=KmnUunjpSZVWTG3+yH65uH=RK7E5aVuJsyHjE80L-+PZw@mail.gmail.com>

If you could share a reproducible example with us, and/or you could
show the full output, then we could probably help you better.

Gabor

On Thu, Apr 29, 2021 at 6:29 PM Danielle Maeser <maese005 at umn.edu> wrote:
>
> Hi Duncan,
>
> I really appreciate your response. Unfortunately, I am still receiving the
> error below.
>
> If anyone has ideas, I'd appreciate it!
>
> This is the only online forum I can find that discusses the error, but I
> have not found it helpful: https://github.com/r-lib/cli/issues/94
>
>
>
>
> *   ERROR: package installation failedError: 'col_ed' is not an exported
> object from 'namespace:cli'Execution halted*
>
> On Wed, Apr 28, 2021 at 7:32 PM Duncan Murdoch <murdoch.duncan at gmail.com>
> wrote:
>
> > On 28/04/2021 4:41 p.m., Danielle Maeser wrote:
> > > Hi Duncan,
> > >
> > > Thank you for your feedback!
> > >
> > > Unfortunately, when I made the changes recommended I have a new error:
> > >
> > > *trying to use CRAN without setting a mirror
> >
> > That would be a result of your code.  Do you call install.packages() in
> > one of your functions?  Normally you shouldn't do that.
> >
> > > *
> > >
> > > And:
> > > *Error: 'col_ed' is not an exported object from 'namespace:cli'*
> >
> > Similarly, something in your code or NAMESPACE file.  Do you refer to
> > cli::col_ed, or try to import col_ed from cli?
> >
> > > *
> > > *
> > > My description file includes:
> > > *VignetteBuilder: knitr
> > > Depends: R (>= 4.0), knitr
> > > License: GPL-2
> > > Encoding: UTF-8
> > > Roxygen: list(rmarkdown = TRUE)
> > > RoxygenNote: 7.1.1
> > > LazyData: true
> >
> > Do you really have a data subdir in your package? You shouldn't have the
> > LazyData line without one.
> >
> > > Suggests: knitr, rmarkdown*
> >
> > You shouldn't list knitr in both Depends and Suggests.
> >
> > Duncan Murdoch
> >
> > > *
> > > *
> > > And my vignette includes:
> > > *title: "title"
> > > author: "name"
> > > output: rmarkdown::html_vignette
> > > vignette: >
> > >    %\VignetteIndexEntry{title}
> > >    %\VignetteEngine{knitr::rmarkdown}
> > >    %\VignetteEncoding{UTF-8}*
> > > *
> > > *
> > > I'd appreciate any advice!
> > >
> > > Danielle
> > >
> > > On Wed, Apr 28, 2021 at 2:27 PM Duncan Murdoch <murdoch.duncan at gmail.com
> > > <mailto:murdoch.duncan at gmail.com>> wrote:
> > >
> > >     On 28/04/2021 2:44 p.m., Danielle Maeser wrote:
> > >      > Hello,
> > >      >
> > >      > I am doing a R CMD check on an R package I have developed.
> > >     However, I keep
> > >      > receiving the warning below:
> > >      >
> > >      > *Files in the 'vignettes' directory but no files in 'inst/doc':*
> > >      >
> > >      > And
> > >      >
> > >      > *Files named as vignettes but with no recognized vignette engine:*
> > >      >
> > >      > I am pretty sure I have the correct YAML header for my vignettes,
> > >     and also
> > >      > inst/docs is an older convention for vignettes that's no longer
> > >      > recommended.
> > >      >
> > >      > Do you have an idea of what's going wrong? I have attached my
> > >     YAML header
> > >      > below as reference.
> > >
> > >     You may be missing the line
> > >
> > >         VignetteBuilder: knitr
> > >
> > >     in your DESCRIPTION file.  Without that, R won't know how to
> > interpret
> > >     your vignette.
> > >
> > >     It's also a little unusual to use
> > >
> > >         %\VignetteEngine{knitr::markdown}
> > >
> > >     nowadays; the more common engine is knitr::rmarkdown (but I believe
> > >     both
> > >     are still supported).  If you make this change you should also have
> > >
> > >         rmarkdown::html_vignette
> > >
> > >     as the output format.
> > >
> > >     Finally, since a recent update of knitr, you need to make sure that
> > >     package holding the output format (i.e. markdown currently,
> > >     rmarkdown if
> > >     you make the change above) is declared as a Suggested package in your
> > >     DESCRIPTION file.
> > >
> > >     Duncan Murdoch
> > >
> > >      >
> > >      > Sincerely,
> > >      > Danielle
> > >      >
> > >      >
> > >      >
> > >      >
> > >      >
> > >      >
> > >      >
> > >      > *title: "title of this vignette"author: "name"output:
> > >      > markdown::html_vignettevignette: >  %\VignetteIndexEntry{vignette
> > >     title}
> > >      > %\VignetteEngine{knitr::markdown}  %\VignetteEncoding{UTF-8}*
> > >      >
> > >
> > >
> > >
> > > --
> > > Ph.D. Student
> > > Bioinformatics and Computational Biology
> > > University of Minnesota
> > >
> >
> >
>
> --
> Ph.D. Student
> Bioinformatics and Computational Biology
> University of Minnesota
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From m@e@e005 @end|ng |rom umn@edu  Thu Apr 29 19:34:15 2021
From: m@e@e005 @end|ng |rom umn@edu (Danielle Maeser)
Date: Thu, 29 Apr 2021 12:34:15 -0500
Subject: [R-pkg-devel] R vignettes
In-Reply-To: <CABtg=KmnUunjpSZVWTG3+yH65uH=RK7E5aVuJsyHjE80L-+PZw@mail.gmail.com>
References: <CA+YOmB8Hj6LLV=2=iYL-ASTN_iv-K4TEqexNdk32d+Ehu8Xnbg@mail.gmail.com>
 <a6b82f33-ca3e-06dd-8558-13d415669abc@gmail.com>
 <CA+YOmB8_vfMigZ2JBnHBR+6LTpU_qgS6r1aXqStSbDKq08tzmw@mail.gmail.com>
 <fedc3733-d8aa-123d-caf7-293df149d214@gmail.com>
 <CA+YOmB-onC0cCj=sO0ANDTL+KBNrOCZBg42mjP-WeedeVQ2WiA@mail.gmail.com>
 <CABtg=KmnUunjpSZVWTG3+yH65uH=RK7E5aVuJsyHjE80L-+PZw@mail.gmail.com>
Message-ID: <CA+YOmB_BMr8gYe+Cbhf=Y-uv=VU6GQQ0zm0tfrAf67hHYaWwPQ@mail.gmail.com>

Hi Gabor,

My full output is below:









*   Error: object 'col_ed' is not exported by 'namespace:cli'   Execution
halted   ERROR: lazy loading failed for package 'packagename'
 -----------------------------------   ERROR: package installation
failedError: 'col_ed' is not an exported object from
'namespace:cli'Execution haltedExited with status 1.*

Unfortunately, I can't share a full reproducible example since this package
is also included in a manuscript for publication.

I don't export any objects named 'col_ed' so I am quite perplexed by this
error message.

I'd appreciate any advice!

Danielle

On Thu, Apr 29, 2021 at 11:42 AM G?bor Cs?rdi <csardi.gabor at gmail.com>
wrote:

> If you could share a reproducible example with us, and/or you could
> show the full output, then we could probably help you better.
>
> Gabor
>
> On Thu, Apr 29, 2021 at 6:29 PM Danielle Maeser <maese005 at umn.edu> wrote:
> >
> > Hi Duncan,
> >
> > I really appreciate your response. Unfortunately, I am still receiving
> the
> > error below.
> >
> > If anyone has ideas, I'd appreciate it!
> >
> > This is the only online forum I can find that discusses the error, but I
> > have not found it helpful: https://github.com/r-lib/cli/issues/94
> >
> >
> >
> >
> > *   ERROR: package installation failedError: 'col_ed' is not an exported
> > object from 'namespace:cli'Execution halted*
> >
> > On Wed, Apr 28, 2021 at 7:32 PM Duncan Murdoch <murdoch.duncan at gmail.com
> >
> > wrote:
> >
> > > On 28/04/2021 4:41 p.m., Danielle Maeser wrote:
> > > > Hi Duncan,
> > > >
> > > > Thank you for your feedback!
> > > >
> > > > Unfortunately, when I made the changes recommended I have a new
> error:
> > > >
> > > > *trying to use CRAN without setting a mirror
> > >
> > > That would be a result of your code.  Do you call install.packages() in
> > > one of your functions?  Normally you shouldn't do that.
> > >
> > > > *
> > > >
> > > > And:
> > > > *Error: 'col_ed' is not an exported object from 'namespace:cli'*
> > >
> > > Similarly, something in your code or NAMESPACE file.  Do you refer to
> > > cli::col_ed, or try to import col_ed from cli?
> > >
> > > > *
> > > > *
> > > > My description file includes:
> > > > *VignetteBuilder: knitr
> > > > Depends: R (>= 4.0), knitr
> > > > License: GPL-2
> > > > Encoding: UTF-8
> > > > Roxygen: list(rmarkdown = TRUE)
> > > > RoxygenNote: 7.1.1
> > > > LazyData: true
> > >
> > > Do you really have a data subdir in your package? You shouldn't have
> the
> > > LazyData line without one.
> > >
> > > > Suggests: knitr, rmarkdown*
> > >
> > > You shouldn't list knitr in both Depends and Suggests.
> > >
> > > Duncan Murdoch
> > >
> > > > *
> > > > *
> > > > And my vignette includes:
> > > > *title: "title"
> > > > author: "name"
> > > > output: rmarkdown::html_vignette
> > > > vignette: >
> > > >    %\VignetteIndexEntry{title}
> > > >    %\VignetteEngine{knitr::rmarkdown}
> > > >    %\VignetteEncoding{UTF-8}*
> > > > *
> > > > *
> > > > I'd appreciate any advice!
> > > >
> > > > Danielle
> > > >
> > > > On Wed, Apr 28, 2021 at 2:27 PM Duncan Murdoch <
> murdoch.duncan at gmail.com
> > > > <mailto:murdoch.duncan at gmail.com>> wrote:
> > > >
> > > >     On 28/04/2021 2:44 p.m., Danielle Maeser wrote:
> > > >      > Hello,
> > > >      >
> > > >      > I am doing a R CMD check on an R package I have developed.
> > > >     However, I keep
> > > >      > receiving the warning below:
> > > >      >
> > > >      > *Files in the 'vignettes' directory but no files in
> 'inst/doc':*
> > > >      >
> > > >      > And
> > > >      >
> > > >      > *Files named as vignettes but with no recognized vignette
> engine:*
> > > >      >
> > > >      > I am pretty sure I have the correct YAML header for my
> vignettes,
> > > >     and also
> > > >      > inst/docs is an older convention for vignettes that's no
> longer
> > > >      > recommended.
> > > >      >
> > > >      > Do you have an idea of what's going wrong? I have attached my
> > > >     YAML header
> > > >      > below as reference.
> > > >
> > > >     You may be missing the line
> > > >
> > > >         VignetteBuilder: knitr
> > > >
> > > >     in your DESCRIPTION file.  Without that, R won't know how to
> > > interpret
> > > >     your vignette.
> > > >
> > > >     It's also a little unusual to use
> > > >
> > > >         %\VignetteEngine{knitr::markdown}
> > > >
> > > >     nowadays; the more common engine is knitr::rmarkdown (but I
> believe
> > > >     both
> > > >     are still supported).  If you make this change you should also
> have
> > > >
> > > >         rmarkdown::html_vignette
> > > >
> > > >     as the output format.
> > > >
> > > >     Finally, since a recent update of knitr, you need to make sure
> that
> > > >     package holding the output format (i.e. markdown currently,
> > > >     rmarkdown if
> > > >     you make the change above) is declared as a Suggested package in
> your
> > > >     DESCRIPTION file.
> > > >
> > > >     Duncan Murdoch
> > > >
> > > >      >
> > > >      > Sincerely,
> > > >      > Danielle
> > > >      >
> > > >      >
> > > >      >
> > > >      >
> > > >      >
> > > >      >
> > > >      >
> > > >      > *title: "title of this vignette"author: "name"output:
> > > >      > markdown::html_vignettevignette: >
> %\VignetteIndexEntry{vignette
> > > >     title}
> > > >      > %\VignetteEngine{knitr::markdown}  %\VignetteEncoding{UTF-8}*
> > > >      >
> > > >
> > > >
> > > >
> > > > --
> > > > Ph.D. Student
> > > > Bioinformatics and Computational Biology
> > > > University of Minnesota
> > > >
> > >
> > >
> >
> > --
> > Ph.D. Student
> > Bioinformatics and Computational Biology
> > University of Minnesota
> >
> >         [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-package-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


-- 
Ph.D. Student
Bioinformatics and Computational Biology
University of Minnesota

	[[alternative HTML version deleted]]


From c@@rd|@g@bor @end|ng |rom gm@||@com  Thu Apr 29 19:39:28 2021
From: c@@rd|@g@bor @end|ng |rom gm@||@com (=?UTF-8?B?R8OhYm9yIENzw6FyZGk=?=)
Date: Thu, 29 Apr 2021 19:39:28 +0200
Subject: [R-pkg-devel] R vignettes
In-Reply-To: <CA+YOmB_BMr8gYe+Cbhf=Y-uv=VU6GQQ0zm0tfrAf67hHYaWwPQ@mail.gmail.com>
References: <CA+YOmB8Hj6LLV=2=iYL-ASTN_iv-K4TEqexNdk32d+Ehu8Xnbg@mail.gmail.com>
 <a6b82f33-ca3e-06dd-8558-13d415669abc@gmail.com>
 <CA+YOmB8_vfMigZ2JBnHBR+6LTpU_qgS6r1aXqStSbDKq08tzmw@mail.gmail.com>
 <fedc3733-d8aa-123d-caf7-293df149d214@gmail.com>
 <CA+YOmB-onC0cCj=sO0ANDTL+KBNrOCZBg42mjP-WeedeVQ2WiA@mail.gmail.com>
 <CABtg=KmnUunjpSZVWTG3+yH65uH=RK7E5aVuJsyHjE80L-+PZw@mail.gmail.com>
 <CA+YOmB_BMr8gYe+Cbhf=Y-uv=VU6GQQ0zm0tfrAf67hHYaWwPQ@mail.gmail.com>
Message-ID: <CABtg=KnJQ+c97FO4D=b5GF4mN+rV3Rb76CeFog7iuG2t2_k6zA@mail.gmail.com>

That's not the _full_ output, unfortunately. And if you can't share a
file that reproduces this (not necessarily your original file!), then
Duncan's advice is all we can tell you: don't install packages in
vignettes.

Gabor

On Thu, Apr 29, 2021 at 7:34 PM Danielle Maeser <maese005 at umn.edu> wrote:
>
> Hi Gabor,
>
> My full output is below:
>    Error: object 'col_ed' is not exported by 'namespace:cli'
>    Execution halted
>    ERROR: lazy loading failed for package 'packagename'
>          -----------------------------------
>    ERROR: package installation failed
>
> Error: 'col_ed' is not an exported object from 'namespace:cli'
> Execution halted
>
> Exited with status 1.
>
> Unfortunately, I can't share a full reproducible example since this package is also included in a manuscript for publication.
>
> I don't export any objects named 'col_ed' so I am quite perplexed by this error message.
>
> I'd appreciate any advice!
>
> Danielle
>
> On Thu, Apr 29, 2021 at 11:42 AM G?bor Cs?rdi <csardi.gabor at gmail.com> wrote:
>>
>> If you could share a reproducible example with us, and/or you could
>> show the full output, then we could probably help you better.
>>
>> Gabor
>>
>> On Thu, Apr 29, 2021 at 6:29 PM Danielle Maeser <maese005 at umn.edu> wrote:
>> >
>> > Hi Duncan,
>> >
>> > I really appreciate your response. Unfortunately, I am still receiving the
>> > error below.
>> >
>> > If anyone has ideas, I'd appreciate it!
>> >
>> > This is the only online forum I can find that discusses the error, but I
>> > have not found it helpful: https://github.com/r-lib/cli/issues/94
>> >
>> >
>> >
>> >
>> > *   ERROR: package installation failedError: 'col_ed' is not an exported
>> > object from 'namespace:cli'Execution halted*
>> >
>> > On Wed, Apr 28, 2021 at 7:32 PM Duncan Murdoch <murdoch.duncan at gmail.com>
>> > wrote:
>> >
>> > > On 28/04/2021 4:41 p.m., Danielle Maeser wrote:
>> > > > Hi Duncan,
>> > > >
>> > > > Thank you for your feedback!
>> > > >
>> > > > Unfortunately, when I made the changes recommended I have a new error:
>> > > >
>> > > > *trying to use CRAN without setting a mirror
>> > >
>> > > That would be a result of your code.  Do you call install.packages() in
>> > > one of your functions?  Normally you shouldn't do that.
>> > >
>> > > > *
>> > > >
>> > > > And:
>> > > > *Error: 'col_ed' is not an exported object from 'namespace:cli'*
>> > >
>> > > Similarly, something in your code or NAMESPACE file.  Do you refer to
>> > > cli::col_ed, or try to import col_ed from cli?
>> > >
>> > > > *
>> > > > *
>> > > > My description file includes:
>> > > > *VignetteBuilder: knitr
>> > > > Depends: R (>= 4.0), knitr
>> > > > License: GPL-2
>> > > > Encoding: UTF-8
>> > > > Roxygen: list(rmarkdown = TRUE)
>> > > > RoxygenNote: 7.1.1
>> > > > LazyData: true
>> > >
>> > > Do you really have a data subdir in your package? You shouldn't have the
>> > > LazyData line without one.
>> > >
>> > > > Suggests: knitr, rmarkdown*
>> > >
>> > > You shouldn't list knitr in both Depends and Suggests.
>> > >
>> > > Duncan Murdoch
>> > >
>> > > > *
>> > > > *
>> > > > And my vignette includes:
>> > > > *title: "title"
>> > > > author: "name"
>> > > > output: rmarkdown::html_vignette
>> > > > vignette: >
>> > > >    %\VignetteIndexEntry{title}
>> > > >    %\VignetteEngine{knitr::rmarkdown}
>> > > >    %\VignetteEncoding{UTF-8}*
>> > > > *
>> > > > *
>> > > > I'd appreciate any advice!
>> > > >
>> > > > Danielle
>> > > >
>> > > > On Wed, Apr 28, 2021 at 2:27 PM Duncan Murdoch <murdoch.duncan at gmail.com
>> > > > <mailto:murdoch.duncan at gmail.com>> wrote:
>> > > >
>> > > >     On 28/04/2021 2:44 p.m., Danielle Maeser wrote:
>> > > >      > Hello,
>> > > >      >
>> > > >      > I am doing a R CMD check on an R package I have developed.
>> > > >     However, I keep
>> > > >      > receiving the warning below:
>> > > >      >
>> > > >      > *Files in the 'vignettes' directory but no files in 'inst/doc':*
>> > > >      >
>> > > >      > And
>> > > >      >
>> > > >      > *Files named as vignettes but with no recognized vignette engine:*
>> > > >      >
>> > > >      > I am pretty sure I have the correct YAML header for my vignettes,
>> > > >     and also
>> > > >      > inst/docs is an older convention for vignettes that's no longer
>> > > >      > recommended.
>> > > >      >
>> > > >      > Do you have an idea of what's going wrong? I have attached my
>> > > >     YAML header
>> > > >      > below as reference.
>> > > >
>> > > >     You may be missing the line
>> > > >
>> > > >         VignetteBuilder: knitr
>> > > >
>> > > >     in your DESCRIPTION file.  Without that, R won't know how to
>> > > interpret
>> > > >     your vignette.
>> > > >
>> > > >     It's also a little unusual to use
>> > > >
>> > > >         %\VignetteEngine{knitr::markdown}
>> > > >
>> > > >     nowadays; the more common engine is knitr::rmarkdown (but I believe
>> > > >     both
>> > > >     are still supported).  If you make this change you should also have
>> > > >
>> > > >         rmarkdown::html_vignette
>> > > >
>> > > >     as the output format.
>> > > >
>> > > >     Finally, since a recent update of knitr, you need to make sure that
>> > > >     package holding the output format (i.e. markdown currently,
>> > > >     rmarkdown if
>> > > >     you make the change above) is declared as a Suggested package in your
>> > > >     DESCRIPTION file.
>> > > >
>> > > >     Duncan Murdoch
>> > > >
>> > > >      >
>> > > >      > Sincerely,
>> > > >      > Danielle
>> > > >      >
>> > > >      >
>> > > >      >
>> > > >      >
>> > > >      >
>> > > >      >
>> > > >      >
>> > > >      > *title: "title of this vignette"author: "name"output:
>> > > >      > markdown::html_vignettevignette: >  %\VignetteIndexEntry{vignette
>> > > >     title}
>> > > >      > %\VignetteEngine{knitr::markdown}  %\VignetteEncoding{UTF-8}*
>> > > >      >
>> > > >
>> > > >
>> > > >
>> > > > --
>> > > > Ph.D. Student
>> > > > Bioinformatics and Computational Biology
>> > > > University of Minnesota
>> > > >
>> > >
>> > >
>> >
>> > --
>> > Ph.D. Student
>> > Bioinformatics and Computational Biology
>> > University of Minnesota
>> >
>> >         [[alternative HTML version deleted]]
>> >
>> > ______________________________________________
>> > R-package-devel at r-project.org mailing list
>> > https://stat.ethz.ch/mailman/listinfo/r-package-devel
>
>
>
> --
> Ph.D. Student
> Bioinformatics and Computational Biology
> University of Minnesota
>


From murdoch@dunc@n @end|ng |rom gm@||@com  Thu Apr 29 19:41:05 2021
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Thu, 29 Apr 2021 13:41:05 -0400
Subject: [R-pkg-devel] R vignettes
In-Reply-To: <CA+YOmB_BMr8gYe+Cbhf=Y-uv=VU6GQQ0zm0tfrAf67hHYaWwPQ@mail.gmail.com>
References: <CA+YOmB8Hj6LLV=2=iYL-ASTN_iv-K4TEqexNdk32d+Ehu8Xnbg@mail.gmail.com>
 <a6b82f33-ca3e-06dd-8558-13d415669abc@gmail.com>
 <CA+YOmB8_vfMigZ2JBnHBR+6LTpU_qgS6r1aXqStSbDKq08tzmw@mail.gmail.com>
 <fedc3733-d8aa-123d-caf7-293df149d214@gmail.com>
 <CA+YOmB-onC0cCj=sO0ANDTL+KBNrOCZBg42mjP-WeedeVQ2WiA@mail.gmail.com>
 <CABtg=KmnUunjpSZVWTG3+yH65uH=RK7E5aVuJsyHjE80L-+PZw@mail.gmail.com>
 <CA+YOmB_BMr8gYe+Cbhf=Y-uv=VU6GQQ0zm0tfrAf67hHYaWwPQ@mail.gmail.com>
Message-ID: <1f90666d-35a3-31e9-5bd8-3a0c5f944c82@gmail.com>

On 29/04/2021 1:34 p.m., Danielle Maeser wrote:
> Hi Gabor,
> 
> My full output is below:
> *? ?Error: object 'col_ed' is not exported by 'namespace:cli'
>  ? ?Execution halted
>  ? ?ERROR: lazy loading failed for package 'packagename'
>  ? ? ? ? ?-----------------------------------
>  ? ?ERROR: package installation failed
> 
> Error: 'col_ed' is not an exported object from 'namespace:cli'
> Execution halted
> 
> Exited with status 1.*
> *
> *
> Unfortunately, I can't share a full reproducible example since this 
> package is also included in a manuscript for publication.
> 
> I don't export any objects named 'col_ed' so I am quite perplexed?by 
> this error message.
> 

This isn't about exports, it's about imports.  R thinks you are trying 
to use an object named col_ed from the cli package.

What I would do is search all source files in your package for "col_ed" 
to see where it is being used.  Then figure out why R thinks you are 
trying to get it from the cli package.

Duncan Murdoch


From w||||@mwdun|@p @end|ng |rom gm@||@com  Thu Apr 29 20:35:35 2021
From: w||||@mwdun|@p @end|ng |rom gm@||@com (Bill Dunlap)
Date: Thu, 29 Apr 2021 11:35:35 -0700
Subject: [R-pkg-devel] R vignettes
In-Reply-To: <CA+YOmB-onC0cCj=sO0ANDTL+KBNrOCZBg42mjP-WeedeVQ2WiA@mail.gmail.com>
References: <CA+YOmB8Hj6LLV=2=iYL-ASTN_iv-K4TEqexNdk32d+Ehu8Xnbg@mail.gmail.com>
 <a6b82f33-ca3e-06dd-8558-13d415669abc@gmail.com>
 <CA+YOmB8_vfMigZ2JBnHBR+6LTpU_qgS6r1aXqStSbDKq08tzmw@mail.gmail.com>
 <fedc3733-d8aa-123d-caf7-293df149d214@gmail.com>
 <CA+YOmB-onC0cCj=sO0ANDTL+KBNrOCZBg42mjP-WeedeVQ2WiA@mail.gmail.com>
Message-ID: <CAHqSRuR03vkXetenEv=iGjTa1-A=56wT7wo3d+vX_sSsozUUeQ@mail.gmail.com>

cli does export col_red - did you omit the 'r' when calling it from your
package or vignette?

On Thu, Apr 29, 2021 at 9:29 AM Danielle Maeser <maese005 at umn.edu> wrote:

> Hi Duncan,
>
> I really appreciate your response. Unfortunately, I am still receiving the
> error below.
>
> If anyone has ideas, I'd appreciate it!
>
> This is the only online forum I can find that discusses the error, but I
> have not found it helpful: https://github.com/r-lib/cli/issues/94
>
>
>
>
> *   ERROR: package installation failedError: 'col_ed' is not an exported
> object from 'namespace:cli'Execution halted*
>
> On Wed, Apr 28, 2021 at 7:32 PM Duncan Murdoch <murdoch.duncan at gmail.com>
> wrote:
>
> > On 28/04/2021 4:41 p.m., Danielle Maeser wrote:
> > > Hi Duncan,
> > >
> > > Thank you for your feedback!
> > >
> > > Unfortunately, when I made the changes recommended I have a new error:
> > >
> > > *trying to use CRAN without setting a mirror
> >
> > That would be a result of your code.  Do you call install.packages() in
> > one of your functions?  Normally you shouldn't do that.
> >
> > > *
> > >
> > > And:
> > > *Error: 'col_ed' is not an exported object from 'namespace:cli'*
> >
> > Similarly, something in your code or NAMESPACE file.  Do you refer to
> > cli::col_ed, or try to import col_ed from cli?
> >
> > > *
> > > *
> > > My description file includes:
> > > *VignetteBuilder: knitr
> > > Depends: R (>= 4.0), knitr
> > > License: GPL-2
> > > Encoding: UTF-8
> > > Roxygen: list(rmarkdown = TRUE)
> > > RoxygenNote: 7.1.1
> > > LazyData: true
> >
> > Do you really have a data subdir in your package? You shouldn't have the
> > LazyData line without one.
> >
> > > Suggests: knitr, rmarkdown*
> >
> > You shouldn't list knitr in both Depends and Suggests.
> >
> > Duncan Murdoch
> >
> > > *
> > > *
> > > And my vignette includes:
> > > *title: "title"
> > > author: "name"
> > > output: rmarkdown::html_vignette
> > > vignette: >
> > >    %\VignetteIndexEntry{title}
> > >    %\VignetteEngine{knitr::rmarkdown}
> > >    %\VignetteEncoding{UTF-8}*
> > > *
> > > *
> > > I'd appreciate any advice!
> > >
> > > Danielle
> > >
> > > On Wed, Apr 28, 2021 at 2:27 PM Duncan Murdoch <
> murdoch.duncan at gmail.com
> > > <mailto:murdoch.duncan at gmail.com>> wrote:
> > >
> > >     On 28/04/2021 2:44 p.m., Danielle Maeser wrote:
> > >      > Hello,
> > >      >
> > >      > I am doing a R CMD check on an R package I have developed.
> > >     However, I keep
> > >      > receiving the warning below:
> > >      >
> > >      > *Files in the 'vignettes' directory but no files in 'inst/doc':*
> > >      >
> > >      > And
> > >      >
> > >      > *Files named as vignettes but with no recognized vignette
> engine:*
> > >      >
> > >      > I am pretty sure I have the correct YAML header for my
> vignettes,
> > >     and also
> > >      > inst/docs is an older convention for vignettes that's no longer
> > >      > recommended.
> > >      >
> > >      > Do you have an idea of what's going wrong? I have attached my
> > >     YAML header
> > >      > below as reference.
> > >
> > >     You may be missing the line
> > >
> > >         VignetteBuilder: knitr
> > >
> > >     in your DESCRIPTION file.  Without that, R won't know how to
> > interpret
> > >     your vignette.
> > >
> > >     It's also a little unusual to use
> > >
> > >         %\VignetteEngine{knitr::markdown}
> > >
> > >     nowadays; the more common engine is knitr::rmarkdown (but I believe
> > >     both
> > >     are still supported).  If you make this change you should also have
> > >
> > >         rmarkdown::html_vignette
> > >
> > >     as the output format.
> > >
> > >     Finally, since a recent update of knitr, you need to make sure that
> > >     package holding the output format (i.e. markdown currently,
> > >     rmarkdown if
> > >     you make the change above) is declared as a Suggested package in
> your
> > >     DESCRIPTION file.
> > >
> > >     Duncan Murdoch
> > >
> > >      >
> > >      > Sincerely,
> > >      > Danielle
> > >      >
> > >      >
> > >      >
> > >      >
> > >      >
> > >      >
> > >      >
> > >      > *title: "title of this vignette"author: "name"output:
> > >      > markdown::html_vignettevignette: >
> %\VignetteIndexEntry{vignette
> > >     title}
> > >      > %\VignetteEngine{knitr::markdown}  %\VignetteEncoding{UTF-8}*
> > >      >
> > >
> > >
> > >
> > > --
> > > Ph.D. Student
> > > Bioinformatics and Computational Biology
> > > University of Minnesota
> > >
> >
> >
>
> --
> Ph.D. Student
> Bioinformatics and Computational Biology
> University of Minnesota
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From ph|||p@|e||e|d @end|ng |rom e@@ex@@c@uk  Sat May  1 11:18:23 2021
From: ph|||p@|e||e|d @end|ng |rom e@@ex@@c@uk (Leifeld, Philip)
Date: Sat, 1 May 2021 09:18:23 +0000
Subject: [R-pkg-devel] Best practice for accessing fat JAR Java application
 in R package
Message-ID: <6829cb32-1da5-7d8e-c79f-ab61b30b3fdb@essex.ac.uk>

Dear all,

I wrote an open-source Java software, which I release as a stand-alone 
JAR file. I also wrote an R package, which adds functionality and some 
wrapper functions for the JAR for use without GUI from R. It uses rJava 
for this purpose. So far, I released both the JAR and the R package on 
GitHub and included a function in the R package that would allow the 
user to download the latest JAR and store it in the package installation 
directory under java/.

But this causes unreliability for several reasons. GitHub allows only so 
many downloads per time unit, which occasionally messes up testing and 
end user experience; users sometimes end up with incompatible versions; 
it adds an inconvenient step for the user etc. I was thinking it may be 
more reliable to bundle the two pieces together by including the JAR 
file in the /inst/java directory of the package sources. This would also 
allow me to initialize Java with the JAR file upon loading the package 
without asking the user to download or initialize anything.

However, the JAR file depends on other open-source software in the form 
of JAR files packaged into my JAR file (so my JAR file is a "fat" JAR 
file). For example, I access SQLite databases as part of my Java 
program, and for this I need the SQLite JDBC JAR, which has about 7MB. 
This leads to a note during R CMD check, which, I guess, will prevent 
CRAN submission:

N  checking installed package size ...
      installed size is  9.1Mb
      sub-directories of 1Mb or more:
        java   8.1Mb

As an alternative solution, I wrote a function that would download the 
correct version of the JAR file and store it in inst/java. This function 
would be executed in R/zzz.R during installation. I was hoping the 
freshly downloaded JAR file would then be copied from inst/java to java/ 
in the installation directory of the package in the library path, but 
this does not seem to be the case. Even if it were copied to the desired 
location, the installed package size would still be too large and would 
yield a note.

I would be grateful if somebody could suggest a best practice to deal 
with this problem. Should I aim to include the JAR or store it online? 
If include, how do I deal with the size limitation of the R package for 
CRAN? If store online, how do I deal with the unreliability of GitHub 
and other issues?

Many thanks in advance,

Philip

-- 
Philip Leifeld
Professor, Department of Government
University of Essex
http://www.philipleifeld.com

From morg@n@em@||box @end|ng |rom gm@||@com  Sat May  1 19:19:25 2021
From: morg@n@em@||box @end|ng |rom gm@||@com (Morgan Morgan)
Date: Sat, 1 May 2021 18:19:25 +0100
Subject: [R-pkg-devel] 
 Best practice for accessing fat JAR Java application in R package
In-Reply-To: <6829cb32-1da5-7d8e-c79f-ab61b30b3fdb@essex.ac.uk>
References: <6829cb32-1da5-7d8e-c79f-ab61b30b3fdb@essex.ac.uk>
Message-ID: <CAL0QV_P0ufx77JsY1byDtOYipowqgB7DnAiNj6YY=BtqpWK5uQ@mail.gmail.com>

Hi,

I am not knowledgeable on the topic but if it helps you I know the h2o
package as one pretty fat file(s):
https://cran.r-project.org/web/checks/check_results_h2o.html

It requires java as well.

Also found the following link on google:
https://thecoatlessprofessor.com/programming/r/size-and-limitations-of-packages-on-cran/

Hopefully someone else will be able to provide you with better guidance.

Best regards
Morgan

On Sat, 1 May 2021, 13:40 Leifeld, Philip, <philip.leifeld at essex.ac.uk>
wrote:

> Dear all,
>
> I wrote an open-source Java software, which I release as a stand-alone
> JAR file. I also wrote an R package, which adds functionality and some
> wrapper functions for the JAR for use without GUI from R. It uses rJava
> for this purpose. So far, I released both the JAR and the R package on
> GitHub and included a function in the R package that would allow the
> user to download the latest JAR and store it in the package installation
> directory under java/.
>
> But this causes unreliability for several reasons. GitHub allows only so
> many downloads per time unit, which occasionally messes up testing and
> end user experience; users sometimes end up with incompatible versions;
> it adds an inconvenient step for the user etc. I was thinking it may be
> more reliable to bundle the two pieces together by including the JAR
> file in the /inst/java directory of the package sources. This would also
> allow me to initialize Java with the JAR file upon loading the package
> without asking the user to download or initialize anything.
>
> However, the JAR file depends on other open-source software in the form
> of JAR files packaged into my JAR file (so my JAR file is a "fat" JAR
> file). For example, I access SQLite databases as part of my Java
> program, and for this I need the SQLite JDBC JAR, which has about 7MB.
> This leads to a note during R CMD check, which, I guess, will prevent
> CRAN submission:
>
> N  checking installed package size ...
>       installed size is  9.1Mb
>       sub-directories of 1Mb or more:
>         java   8.1Mb
>
> As an alternative solution, I wrote a function that would download the
> correct version of the JAR file and store it in inst/java. This function
> would be executed in R/zzz.R during installation. I was hoping the
> freshly downloaded JAR file would then be copied from inst/java to java/
> in the installation directory of the package in the library path, but
> this does not seem to be the case. Even if it were copied to the desired
> location, the installed package size would still be too large and would
> yield a note.
>
> I would be grateful if somebody could suggest a best practice to deal
> with this problem. Should I aim to include the JAR or store it online?
> If include, how do I deal with the size limitation of the R package for
> CRAN? If store online, how do I deal with the unreliability of GitHub
> and other issues?
>
> Many thanks in advance,
>
> Philip
>
> --
> Philip Leifeld
> Professor, Department of Government
> University of Essex
> http://www.philipleifeld.com
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From r@@y@|@14 @end|ng |rom |mper|@|@@c@uk  Sun May  2 12:12:14 2021
From: r@@y@|@14 @end|ng |rom |mper|@|@@c@uk (Ayala Hernandez, Rafael)
Date: Sun, 2 May 2021 10:12:14 +0000
Subject: [R-pkg-devel] Large data package
In-Reply-To: <24712.35452.971015.959559@rob.eddelbuettel.com>
References: <D786E655-A45E-4C6B-A7ED-6070DF954739@imperial.ac.uk>
 <24712.35452.971015.959559@rob.eddelbuettel.com>
Message-ID: <77E0A411-7ECB-4AED-B05C-3E513891D6F7@imperial.ac.uk>

Dear All,

Following Dirk's suggestion below, I have recently added a data package as a drat repository for my asteRisk package, placing it under Suggests in the main package.
In order to keep the code tidy and know exactly when I?m accessing the data in the data package, I access all the data in the data package as asteRiskData:::Item

This seems to be working fine, but upon CHECK I am getting the following NOTE: 

  Unavailable namespace imported from by a ':::' call: ?asteRiskData?
    See the note in ?`:::` about the use of this operator.

The mentioned Note says:

It is typically a design mistake to use ::: in your code since the corresponding object has probably been kept internal for a good reason. Consider contacting the packagemaintainer if you feel the need to access the object for anything but mere inspection.

Here I have decided by design to keep the objects internal in the data package, since they are only meant to be accessed by functions of the main package. 
I am wondering if anyone has had any experience with this NOTE before? Is it acceptable to leave it for submission of the updated version to CRAN?

Thanks a lot in advance

Best wishes,

Rafa

> El 28 abr 2021, a las 0:04, Dirk Eddelbuettel <edd at debian.org> escribi?:
> 
> 
> *******************
> This email originates from outside Imperial. Do not click on links and attachments unless you recognise the sender. 
> If you trust the sender, add them to your safe senders list https://spam.ic.ac.uk/SpamConsole/Senders.aspx to disable email stamping for this address.
> *******************
> 
> On 27 April 2021 at 10:26, Ayala Hernandez, Rafael wrote:
> | I am in the process of including a large update for my package asteRisk, that will require the usage of large data files (amounting in total to ~100 MB).
> | 
> | Given the CRAN package size limits of 5 MB, I am wondering what is the preferred solution in these cases? I have read multiple possibilities, such as requesting to CRAN to host a data-only package that would be updated very infrequently, or hosting the data in another repository and providing functions in the main package to retrieve the required files.
> 
> In case you have not seen it yet, the R Journal article Brooke and I wrote a
> few years ago covers exactly this use case, and walks through how to cover it
> in a fairly detailed way.
> 
> https://journal.r-project.org/archive/2017/RJ-2017-026/index.html
> 
> @article{RJ-2017-026,
>  author = {G. Brooke Anderson and Dirk Eddelbuettel},
>  title = {{Hosting Data Packages via drat: A Case Study with Hurricane
>          Exposure Data}},
>  year = {2017},
>  journal = {{The R Journal}},
>  doi = {10.32614/RJ-2017-026},
>  url = {https://doi.org/10.32614/RJ-2017-026},
>  pages = {486--497},
>  volume = {9},
>  number = {1}
> }
> 
> Hope this helps, Dirk
> 
> -- 
> https://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From edd @end|ng |rom deb|@n@org  Sun May  2 14:44:10 2021
From: edd @end|ng |rom deb|@n@org (Dirk Eddelbuettel)
Date: Sun, 2 May 2021 07:44:10 -0500
Subject: [R-pkg-devel] Large data package
In-Reply-To: <77E0A411-7ECB-4AED-B05C-3E513891D6F7@imperial.ac.uk>
References: <D786E655-A45E-4C6B-A7ED-6070DF954739@imperial.ac.uk>
 <24712.35452.971015.959559@rob.eddelbuettel.com>
 <77E0A411-7ECB-4AED-B05C-3E513891D6F7@imperial.ac.uk>
Message-ID: <24718.40602.671410.739255@rob.eddelbuettel.com>


On 2 May 2021 at 10:12, Ayala Hernandez, Rafael wrote:
| Following Dirk's suggestion below, I have recently added a data package as a drat repository for my asteRisk package, placing it under Suggests in the main package.
| In order to keep the code tidy and know exactly when I?m accessing the data in the data package, I access all the data in the data package as asteRiskData:::Item

Why would that be 'tidy'?

Just use two colons as usual for things exported from your data package, and
export everythng that your code package uses from it. The ':::' idiom is not
to be used across package, ie don;t use in package B to access content from
A. Which is what R CMD check is telling your here: "don't do this".

Dirk

-- 
https://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From murdoch@dunc@n @end|ng |rom gm@||@com  Sun May  2 16:29:05 2021
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Sun, 2 May 2021 10:29:05 -0400
Subject: [R-pkg-devel] Large data package
In-Reply-To: <24718.40602.671410.739255@rob.eddelbuettel.com>
References: <D786E655-A45E-4C6B-A7ED-6070DF954739@imperial.ac.uk>
 <24712.35452.971015.959559@rob.eddelbuettel.com>
 <77E0A411-7ECB-4AED-B05C-3E513891D6F7@imperial.ac.uk>
 <24718.40602.671410.739255@rob.eddelbuettel.com>
Message-ID: <e3dc07c2-2270-d1cb-8d46-fd6d727bd367@gmail.com>

On 02/05/2021 8:44 a.m., Dirk Eddelbuettel wrote:
> 
> On 2 May 2021 at 10:12, Ayala Hernandez, Rafael wrote:
> | Following Dirk's suggestion below, I have recently added a data package as a drat repository for my asteRisk package, placing it under Suggests in the main package.
> | In order to keep the code tidy and know exactly when I?m accessing the data in the data package, I access all the data in the data package as asteRiskData:::Item
> 
> Why would that be 'tidy'?
> 
> Just use two colons as usual for things exported from your data package, and
> export everythng that your code package uses from it. The ':::' idiom is not
> to be used across package, ie don;t use in package B to access content from
> A. Which is what R CMD check is telling your here: "don't do this".
> 

I wouldn't call it "tidy", but there are some possible reasons to do 
this.  One may apply here:

  - You may not want other packages to depend on the data, because you 
would like to be able to change it without notice.  Normally you'd do 
this by making it a private part of the main package, but if it's really 
big, that's discouraged.  So the use described here may be reasonable.

I can't spot it in the docs right now, but I believe CRAN will allow the 
use of ::: if the package it is importing from has the same maintainer 
as the main package.

The problem here is that CRAN doesn't know who is the maintainer for 
asteRiskData.  That package is not on CRAN, and they don't look on other 
repositories to figure it out.

So the answer to Rafael's original question is that I think CRAN would 
agree to this use if you have a good reason for it, but you'll need to 
explain that reason in your submission message, and it will need manual 
intervention to ignore the automatic rejection.

Following Dirk's advice is thus advisable (passing the auto checks is 
better than requiring manual intervention on every update), but not 
strictly necessary.

Duncan Murdoch


From r@@y@|@14 @end|ng |rom |mper|@|@@c@uk  Sun May  2 17:00:34 2021
From: r@@y@|@14 @end|ng |rom |mper|@|@@c@uk (Ayala Hernandez, Rafael)
Date: Sun, 2 May 2021 15:00:34 +0000
Subject: [R-pkg-devel] Large data package
In-Reply-To: <e3dc07c2-2270-d1cb-8d46-fd6d727bd367@gmail.com>
References: <D786E655-A45E-4C6B-A7ED-6070DF954739@imperial.ac.uk>
 <24712.35452.971015.959559@rob.eddelbuettel.com>
 <77E0A411-7ECB-4AED-B05C-3E513891D6F7@imperial.ac.uk>
 <24718.40602.671410.739255@rob.eddelbuettel.com>
 <e3dc07c2-2270-d1cb-8d46-fd6d727bd367@gmail.com>
Message-ID: <FE880B36-C958-4EC0-9500-E5B69DC67F9F@imperial.ac.uk>

Dear Dirk and Duncan,

Thanks a lot for your clarifications. Both of your explanations make sense. Indeed, I would rather not have any other packages depend on the data package, at least not for the time being, in case I find good reasons to make modifications in the data package.

But it makes sense to try to pass the auto checks as much as possible. I will work towards trying to avoid :::

Best wishes,

Rafa

> El 2 may 2021, a las 16:29, Duncan Murdoch <murdoch.duncan at gmail.com> escribi?:
> 
> On 02/05/2021 8:44 a.m., Dirk Eddelbuettel wrote:
>> On 2 May 2021 at 10:12, Ayala Hernandez, Rafael wrote:
>> | Following Dirk's suggestion below, I have recently added a data package as a drat repository for my asteRisk package, placing it under Suggests in the main package.
>> | In order to keep the code tidy and know exactly when I?m accessing the data in the data package, I access all the data in the data package as asteRiskData:::Item
>> Why would that be 'tidy'?
>> Just use two colons as usual for things exported from your data package, and
>> export everythng that your code package uses from it. The ':::' idiom is not
>> to be used across package, ie don;t use in package B to access content from
>> A. Which is what R CMD check is telling your here: "don't do this".
> 
> I wouldn't call it "tidy", but there are some possible reasons to do this.  One may apply here:
> 
> - You may not want other packages to depend on the data, because you would like to be able to change it without notice.  Normally you'd do this by making it a private part of the main package, but if it's really big, that's discouraged.  So the use described here may be reasonable.
> 
> I can't spot it in the docs right now, but I believe CRAN will allow the use of ::: if the package it is importing from has the same maintainer as the main package.
> 
> The problem here is that CRAN doesn't know who is the maintainer for asteRiskData.  That package is not on CRAN, and they don't look on other repositories to figure it out.
> 
> So the answer to Rafael's original question is that I think CRAN would agree to this use if you have a good reason for it, but you'll need to explain that reason in your submission message, and it will need manual intervention to ignore the automatic rejection.
> 
> Following Dirk's advice is thus advisable (passing the auto checks is better than requiring manual intervention on every update), but not strictly necessary.
> 
> Duncan Murdoch
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From edd @end|ng |rom deb|@n@org  Sun May  2 17:27:34 2021
From: edd @end|ng |rom deb|@n@org (Dirk Eddelbuettel)
Date: Sun, 2 May 2021 10:27:34 -0500
Subject: [R-pkg-devel] Large data package
In-Reply-To: <FE880B36-C958-4EC0-9500-E5B69DC67F9F@imperial.ac.uk>
References: <D786E655-A45E-4C6B-A7ED-6070DF954739@imperial.ac.uk>
 <24712.35452.971015.959559@rob.eddelbuettel.com>
 <77E0A411-7ECB-4AED-B05C-3E513891D6F7@imperial.ac.uk>
 <24718.40602.671410.739255@rob.eddelbuettel.com>
 <e3dc07c2-2270-d1cb-8d46-fd6d727bd367@gmail.com>
 <FE880B36-C958-4EC0-9500-E5B69DC67F9F@imperial.ac.uk>
Message-ID: <24718.50406.118181.389201@rob.eddelbuettel.com>


On 2 May 2021 at 15:00, Ayala Hernandez, Rafael wrote:
| Thanks a lot for your clarifications. Both of your explanations make sense. Indeed, I would rather not have any other packages depend on the data package, at least not for the time being, in case I find good reasons to make modifications in the data package.
| 
| But it makes sense to try to pass the auto checks as much as possible. I will work towards trying to avoid :::

I fear you are still looking at the wrong windmill, longing for a fight.

There is _nothing_ wrong with a :: for package you have a Suggests: on, and
having a _conditional dependence_ on a large data package is where we
started. You could just use :: in your package, as long as it is inside
blocks of the form
  if (requireNamespace(nameOfDataPackage, quietly=TRUE)) { ... }
or if you really dislike ::,  use a library(nameOfDataPackage).

The key is to use the conditional dependence via such a test in the code.

And the CRAN Repo Policy and Writing R Extensions are moving ever so slowly
in this direction. It is not something that can be enforced yet given both
the number of packages still doing it wrong, and the number of people who
continue repeating that this is a good or acceptable practice. We can and
will do better, just how we moved to using NAMESPACES for a reason.

Dirk

-- 
https://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From r@@y@|@14 @end|ng |rom |mper|@|@@c@uk  Sun May  2 18:01:52 2021
From: r@@y@|@14 @end|ng |rom |mper|@|@@c@uk (Ayala Hernandez, Rafael)
Date: Sun, 2 May 2021 16:01:52 +0000
Subject: [R-pkg-devel] Large data package
In-Reply-To: <24718.50406.118181.389201@rob.eddelbuettel.com>
References: <D786E655-A45E-4C6B-A7ED-6070DF954739@imperial.ac.uk>
 <24712.35452.971015.959559@rob.eddelbuettel.com>
 <77E0A411-7ECB-4AED-B05C-3E513891D6F7@imperial.ac.uk>
 <24718.40602.671410.739255@rob.eddelbuettel.com>
 <e3dc07c2-2270-d1cb-8d46-fd6d727bd367@gmail.com>
 <FE880B36-C958-4EC0-9500-E5B69DC67F9F@imperial.ac.uk>
 <24718.50406.118181.389201@rob.eddelbuettel.com>
Message-ID: <DB45541C-D6A8-4371-A48B-B91F9EBDA18D@imperial.ac.uk>

Dear Dirk,

Thanks a lot for your detailed explanation. This is indeed the solution that I have found to work nicely, and indeed keeps the code equally tidy.
In fact, I am finding that using :: to access exported objects instead of ::: to access any object in the data package even helps me organize the code better, since I have a clear record of the interaction between the 2 packages (in the form of exports in the NAMESPACE of the Data package).
Together with conditional checks to ensure that the data package is available before running code that requires it, it seems to be the best solution to me.

Best wishes,

Rafa

> El 2 may 2021, a las 17:27, Dirk Eddelbuettel <edd at debian.org> escribi?:
> 
> 
> On 2 May 2021 at 15:00, Ayala Hernandez, Rafael wrote:
> | Thanks a lot for your clarifications. Both of your explanations make sense. Indeed, I would rather not have any other packages depend on the data package, at least not for the time being, in case I find good reasons to make modifications in the data package.
> | 
> | But it makes sense to try to pass the auto checks as much as possible. I will work towards trying to avoid :::
> 
> I fear you are still looking at the wrong windmill, longing for a fight.
> 
> There is _nothing_ wrong with a :: for package you have a Suggests: on, and
> having a _conditional dependence_ on a large data package is where we
> started. You could just use :: in your package, as long as it is inside
> blocks of the form
>  if (requireNamespace(nameOfDataPackage, quietly=TRUE)) { ... }
> or if you really dislike ::,  use a library(nameOfDataPackage).
> 
> The key is to use the conditional dependence via such a test in the code.
> 
> And the CRAN Repo Policy and Writing R Extensions are moving ever so slowly
> in this direction. It is not something that can be enforced yet given both
> the number of packages still doing it wrong, and the number of people who
> continue repeating that this is a good or acceptable practice. We can and
> will do better, just how we moved to using NAMESPACES for a reason.
> 
> Dirk
> 
> -- 
> https://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From murdoch@dunc@n @end|ng |rom gm@||@com  Wed Apr 28 12:05:10 2021
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Wed, 28 Apr 2021 06:05:10 -0400
Subject: [R-pkg-devel] Call internal R functions in C
In-Reply-To: <CAC5yOjif5oLEXSNoYR1OgbZdMRTcOi516H-gCquJnnTASquG+g@mail.gmail.com>
References: <CAC5yOjiga0hf8a4GNGSLygmoHtiJQRPyiRUw4RX-_7cDrTJvOg@mail.gmail.com>
 <e028cf6d-3bda-feef-4830-77c265c2c95c@gmail.com>
 <CAC5yOjifUj3-oS5m53K5=-cJKBHNVzmcdpUro1JNJjyUvjmCVQ@mail.gmail.com>
 <ecee6aa1-8193-b881-dacb-576c41f2fde9@gmail.com>
 <CAC5yOjif5oLEXSNoYR1OgbZdMRTcOi516H-gCquJnnTASquG+g@mail.gmail.com>
Message-ID: <d24e7fbc-f9cd-548b-553d-0ab191d0bb74-1083@gmail.com>


On 27/04/2021 12:34 p.m., Cai Li wrote:
> /Dear Duncan, Thank you very much for your helpful?advice! In addition, 
> could you kindly help answer my follow-up questions below? /

Sorry, I showed you how I did it.  There are certainly other ways, but 
you'll have to dig around in the manuals to find them.

Duncan Murdoch

> /
> /
> /Instead of passing the private R package environment to C, is there a 
> way to alter the namespace so that files in the "R" directory of the 
> package can be read by the C code but not exported to users? There are 
> specialized export and import functions in the "roxygen2" package that 
> can be used to alter the namespace, and I'm wondering whether altering 
> the namespace would work as well 
> (https://cran.r-project.org/web/packages/roxygen2/vignettes/namespace.html 
> <https://nam12.safelinks.protection.outlook.com/?url=https%3A%2F%2Fcran.r-project.org%2Fweb%2Fpackages%2Froxygen2%2Fvignettes%2Fnamespace.html&data=04%7C01%7Ccai.li%40yale.edu%7Cfef92ea6326d4803577808d909969553%7Cdd8cbebb21394df8b4114e3e87abeb5c%7C0%7C0%7C637551364617695111%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C1000&sdata=PKtQPhcpncRWSzSY5FrYR2Pcbn6LaYDDX0GhEgVtLtA%3D&reserved=0>)./
> /
> /
> /However, if passing the private R package environment to C is the 
> only/best way for the R functions to be read by C without getting 
> exported, could you kindly offer additional advice for how to do this? I 
> can pass an "environment" object from R to C within an SEXP object in C. 
> However, I'm not sure how to pass the "environment" object between C 
> functions. For instance, in the following function, could I declare a 
> "char" object and save the "environment" object as a "char" within the C 
> code?/
> /
> /
> /void
> maketree_diff(int n,
>  ? ? ? ? ? ? ? int nc,
>  ? ? ? ? ? ? ? double *y,
>  ? ? ? ? ? ? ? double **data,
>  ? ? ? ? ? ? ? int *types,
>  ? ? ? ? ? ? ? int *ncat,
>  ? ? ? ? ? ? ? int *treat,
>  ? ? ? ? ? ? ? struct node *tree,
>  ? ? ? ? ? ? ? int nmin2,
>  ? ? ? ? ? ? ? int maxdepth,
>  ? ? ? ? ? ? ? int method)/
> 
> On Mon, Apr 26, 2021 at 5:30 AM Duncan Murdoch <murdoch.duncan at gmail.com 
> <mailto:murdoch.duncan at gmail.com>> wrote:
> 
>     On 25/04/2021 10:30 p.m., Cai Li wrote:
>      > Thanks Duncan! I was advised not to export those functions in the
>      > namespace and keep them as internals. In terms of this, could you
>     advise
>      > what specific changes should I make to the C code so that I can
>     evaluate
>      > them in a suitable environment? I tried something like
>      > "PROTECT(func_R=lang2(install("Package:::R_function"),
>     func_data))," but
>      > it did not work. Sorry this may be too naive and thanks again.
> 
>     That line creates the expression to evaluate, it doesn't evaluate it.
>     You need to call eval() (the C function) on the result.? Here's some
>     code from rgl that does something similar:
> 
>     R code to initialize:
> 
>     rgl.init <- function(initValue = 0, onlyNULL = FALSE, debug =
>     getOption("rgl.debug", FALSE))
>      ? ?.Call( rgl_init,
>      ? ? ?initValue, onlyNULL, environment(rgl.init), debug )
> 
>     The important thing here is "environment(rgl.init)", which is the
>     private environment within the package.
> 
>     Then in C code, save that environment:
> 
>      ? ?rglNamespace = in_namespace;
> 
>     and use it later:
> 
>      ? ?result = eval(PROTECT(lang2(PROTECT(install("rglFonts")),
> 
>     PROTECT(ScalarString(mkChar(family))))), rglNamespace);
> 
>     Duncan Murdoch
> 
>      >
>      > Cai
>      >
>      > On Sun, Apr 25, 2021 at 8:46 PM Duncan Murdoch
>     <murdoch.duncan at gmail.com <mailto:murdoch.duncan at gmail.com>
>      > <mailto:murdoch.duncan at gmail.com
>     <mailto:murdoch.duncan at gmail.com>>> wrote:
>      >
>      >? ? ?On 25/04/2021 7:23 p.m., Cai Li wrote:
>      >? ? ? > Hello All,
>      >? ? ? >
>      >? ? ? > I'm developing a package with C code. My question may be
>     naive: I
>      >? ? ?have
>      >? ? ? > several internal R functions that need to be called by C,
>     but I
>      >? ? ?cannot get
>      >? ? ? > it to work or find a solution. It can work if I export
>     those internal
>      >? ? ? > functions in namespace, but it fails if I just want to
>     keep them as
>      >? ? ? > internal functions without exporting them. I guess I need some
>      >? ? ?flags to
>      >? ? ? > indicate the "internal" R internal functions? Could you please
>      >? ? ?share your
>      >? ? ? > thoughts on how to fix this? Much appreciated in advance!
>      >? ? ? >
>      >? ? ? > //? ?set up call to R function "R_function"
>      >? ? ? >? ? ? SEXP func_R;
>      >? ? ? >? ? ? PROTECT(func_R=lang2(install("R_function"), func_data));
>      >? ? ? >
>      >
>      >? ? ?It all depends on the environment where you evaluate that
>     expression,
>      >? ? ?just as it would if it was R code.? You can't see internal
>     package
>      >? ? ?functions from the global environment, you need to evaluate
>     them in the
>      >? ? ?package namespace environment.
>      >
>      >? ? ?Duncan Murdoch
>      >
>


From d@v|d @end|ng |rom prec|@|onmethod@@guru  Mon May  3 20:43:48 2021
From: d@v|d @end|ng |rom prec|@|onmethod@@guru (David Norris)
Date: Mon, 3 May 2021 18:43:48 +0000
Subject: [R-pkg-devel] Best way to build CRAN packages that include Rust
 source?
Message-ID: <3E54163E-1DAC-4016-905C-84411A26711A@precisionmethods.guru>

I am appreciating 2 distinct approaches currently used to compile Rust code in R packages:

1. LinkingTo: cargo, as done in https://CRAN.R-project.org/package=salso

2. A more ?traditional?-looking approach built on Autoconf & Automake https://CRAN.R-project.org/package=gifski

Is there any reason why one or the other would be preferred for a CRAN submission?
Would one or the other design better facilitate Rust?s eventual elevation to ?first-class? status (like C++, Fortran) for compiling code in R packages?

In favor of (1), it seems to me that the ?Reverse linking to:? entry at https://CRAN.R-project.org/package=cargo nicely advertises packages that use Rust, which could be useful for example code, etc.
In favor of (2), it seems completely idiomatic?and so potentially more conducive to achieving first-class status for Rust.


	[[alternative HTML version deleted]]


From m|keh1 @end|ng |rom uw@edu  Tue May  4 22:03:07 2021
From: m|keh1 @end|ng |rom uw@edu (Michael Hellstern)
Date: Tue, 4 May 2021 13:03:07 -0700
Subject: [R-pkg-devel] Resubmitting archived package with new maintainer
Message-ID: <CAEYsH0YA000AO9CSt29awSgtQw+3X-F1XEfGWTv_XGO6+OdTOg@mail.gmail.com>

Hi,

I'm trying to resubmit a package to CRAN that was archived about 1 month
ago. The archived package has a different maintainer. We discussed and they
are OK with me taking over as the new maintainer. Do we need to email CRAN
confirming the change in maintainers even though the package was archived?

The new submission was rejected from CRAN with the note:

Check: CRAN incoming feasibility, Result: NA
  Maintainer: 'Michael Hellstern <mikeh1 at uw.edu>'
  New submission
  Package was archived on CRAN
  CRAN repository db overrides:
    X-CRAN-Comment: Archived on 2021-04-08 as check problems were not
      corrected in time.
  The Date field is over a month old.
  Size of tarball: 5111516 bytes

Thank you for the help!

Mike

	[[alternative HTML version deleted]]


From edd @end|ng |rom deb|@n@org  Tue May  4 23:41:29 2021
From: edd @end|ng |rom deb|@n@org (Dirk Eddelbuettel)
Date: Tue, 4 May 2021 16:41:29 -0500
Subject: [R-pkg-devel] Resubmitting archived package with new maintainer
In-Reply-To: <CAEYsH0YA000AO9CSt29awSgtQw+3X-F1XEfGWTv_XGO6+OdTOg@mail.gmail.com>
References: <CAEYsH0YA000AO9CSt29awSgtQw+3X-F1XEfGWTv_XGO6+OdTOg@mail.gmail.com>
Message-ID: <24721.49033.356946.572256@rob.eddelbuettel.com>


On 4 May 2021 at 13:03, Michael Hellstern wrote:
| I'm trying to resubmit a package to CRAN that was archived about 1 month
| ago. The archived package has a different maintainer. We discussed and they
| are OK with me taking over as the new maintainer. Do we need to email CRAN
| confirming the change in maintainers even though the package was archived?

I think so. See the short discussion in the CRAN Repository Policy document.
Ideally the previous maintainer would signal approval of the change to CRAN
as well.

| The new submission was rejected from CRAN with the note:
| 
| Check: CRAN incoming feasibility, Result: NA
|   Maintainer: 'Michael Hellstern <mikeh1 at uw.edu>'
|   New submission
|   Package was archived on CRAN
|   CRAN repository db overrides:
|     X-CRAN-Comment: Archived on 2021-04-08 as check problems were not
|       corrected in time.
|   The Date field is over a month old.

You should update the date field too.

Dirk

-- 
https://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From n|co|@@@bennett @end|ng |rom @t@t@m@th@ethz@ch  Wed May  5 14:41:03 2021
From: n|co|@@@bennett @end|ng |rom @t@t@m@th@ethz@ch (Bennett  Nicolas)
Date: Wed, 5 May 2021 12:41:03 +0000
Subject: [R-pkg-devel] JSS article as package vignette introduces a
 dependency on R >= 4.0.4
Message-ID: <B9A9562D-C0A9-46CA-9EDA-BCBD0D35E868@stat.math.ethz.ch>

Dear all

First, the underlying problem is explained in rstudio/rticles#399<https://github.com/rstudio/rticles/issues/399> (along with a reproducible example), but I?ll try to summarize the issue:

As discussed in rstudio/rticles#329<https://github.com/rstudio/rticles/issues/329>, a change in hook management for LaTeX (see this comment<https://github.com/rstudio/rticles/issues/329#issuecomment-705713973>) broke the jss.cls file included with R (share/texmf/tex/latex/jss.cls). This was fixed in R 4.0.4 but as far as I can tell, leaves us with a slightly unsatisfying situation for any R package that include a JSS article as vignette (and is being built with LaTeX newer than fall 2020):

- either you add a recent copy of jss.cls to the package source and do not build-ignore this file; for this you incur a note saying that ?The following files are already in R ... Please remove them from your package.?
- or the package now depends on R >= 4.0.4

Does anyone know of a way out of this? Or am I missing something?

Thanks,
Nicolas

	[[alternative HTML version deleted]]


From ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de  Thu May  6 08:09:54 2021
From: ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de (Uwe Ligges)
Date: Thu, 6 May 2021 08:09:54 +0200
Subject: [R-pkg-devel] JSS article as package vignette introduces a
 dependency on R >= 4.0.4
In-Reply-To: <B9A9562D-C0A9-46CA-9EDA-BCBD0D35E868@stat.math.ethz.ch>
References: <B9A9562D-C0A9-46CA-9EDA-BCBD0D35E868@stat.math.ethz.ch>
Message-ID: <deaa8883-20cb-09ee-e80f-06e75fc95dcd@statistik.tu-dortmund.de>



On 05.05.2021 14:41, Bennett  Nicolas wrote:
> Dear all
> 
> First, the underlying problem is explained in rstudio/rticles#399<https://github.com/rstudio/rticles/issues/399> (along with a reproducible example), but I?ll try to summarize the issue:
> 
> As discussed in rstudio/rticles#329<https://github.com/rstudio/rticles/issues/329>, a change in hook management for LaTeX (see this comment<https://github.com/rstudio/rticles/issues/329#issuecomment-705713973>) broke the jss.cls file included with R (share/texmf/tex/latex/jss.cls). This was fixed in R 4.0.4 but as far as I can tell, leaves us with a slightly unsatisfying situation for any R package that include a JSS article as vignette (and is being built with LaTeX newer than fall 2020):
> 
> - either you add a recent copy of jss.cls to the package source and do not build-ignore this file; for this you incur a note saying that ?The following files are already in R ... Please remove them from your package.?
> - or the package now depends on R >= 4.0.4
As the package is shipped with the already built vignette, this does not 
induce the version requirement.

Best,
Uwe Ligges

> 
> Does anyone know of a way out of this? Or am I missing something?
> 
> Thanks,
> Nicolas
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


From m@e@e005 @end|ng |rom umn@edu  Thu May  6 23:59:16 2021
From: m@e@e005 @end|ng |rom umn@edu (Danielle Maeser)
Date: Thu, 6 May 2021 16:59:16 -0500
Subject: [R-pkg-devel] Error
Message-ID: <CA+YOmB8LFp2MDugx3RQpGjfXKF4tNzkDxLXRXbcqjKFcYiK0xw@mail.gmail.com>

Hello,

The R CMD check passed with 0 errors and warnings, so I proceeded to submit
to CRAN. However, CRAN reported 1 error (see below). If you have any
insight as to what this error means, please let me know.

I'm perplexed because *rtracklayer *is not a package dependency, and
I'm not sure where it came from. Perhaps this is a false positive?

** installing *source* package 'oncoPredict' ...
** using staged installation
** R
** inst
** byte-compile and prepare package for lazy loading
Error in loadNamespace(j <- i[[1L]], c(lib.loc, .libPaths()),
versionCheck = vI[[j]]) :
  namespace 'rtracklayer' 1.48.0 is being loaded, but >= 1.51.5 is required
Calls: <Anonymous> ... namespaceImportFrom -> asNamespace -> loadNamespace
Execution halted
ERROR: lazy loading failed for package 'oncoPredict'
* removing 'd:/RCompile/CRANincoming/R-devel/lib/oncoPredict'
* restoring previous 'd:/RCompile/CRANincoming/R-devel/lib/oncoPredict'*

	[[alternative HTML version deleted]]


From ||@t@ @end|ng |rom dewey@myzen@co@uk  Fri May  7 14:48:31 2021
From: ||@t@ @end|ng |rom dewey@myzen@co@uk (Michael Dewey)
Date: Fri, 7 May 2021 13:48:31 +0100
Subject: [R-pkg-devel] Error concerning rtracklayer
In-Reply-To: <CA+YOmB8LFp2MDugx3RQpGjfXKF4tNzkDxLXRXbcqjKFcYiK0xw@mail.gmail.com>
References: <CA+YOmB8LFp2MDugx3RQpGjfXKF4tNzkDxLXRXbcqjKFcYiK0xw@mail.gmail.com>
Message-ID: <57311621-e4fa-b602-46c1-9b3730f207f3@dewey.myzen.co.uk>

Dear Danielle

If you search the most recent postings on this list
https://stat.ethz.ch/pipermail/r-package-devel/2021q2/subject.html
you will see that several of them have rtracklayer in their title. Does 
any of them help you?

Note that if they had used an uninformative title as you do it would be 
harder to find them so I have added that to your title.

Michael

On 06/05/2021 22:59, Danielle Maeser wrote:
> Hello,
> 
> The R CMD check passed with 0 errors and warnings, so I proceeded to submit
> to CRAN. However, CRAN reported 1 error (see below). If you have any
> insight as to what this error means, please let me know.
> 
> I'm perplexed because *rtracklayer *is not a package dependency, and
> I'm not sure where it came from. Perhaps this is a false positive?
> 
> ** installing *source* package 'oncoPredict' ...
> ** using staged installation
> ** R
> ** inst
> ** byte-compile and prepare package for lazy loading
> Error in loadNamespace(j <- i[[1L]], c(lib.loc, .libPaths()),
> versionCheck = vI[[j]]) :
>    namespace 'rtracklayer' 1.48.0 is being loaded, but >= 1.51.5 is required
> Calls: <Anonymous> ... namespaceImportFrom -> asNamespace -> loadNamespace
> Execution halted
> ERROR: lazy loading failed for package 'oncoPredict'
> * removing 'd:/RCompile/CRANincoming/R-devel/lib/oncoPredict'
> * restoring previous 'd:/RCompile/CRANincoming/R-devel/lib/oncoPredict'*
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
> 

-- 
Michael
http://www.dewey.myzen.co.uk/home.html


From n@r@@ @end|ng |rom @t@n|ord@edu  Mon May 10 22:01:13 2021
From: n@r@@ @end|ng |rom @t@n|ord@edu (Balasubramanian Narasimhan)
Date: Mon, 10 May 2021 13:01:13 -0700
Subject: [R-pkg-devel] Unable to get past CRAN submission checks for package
 cubature
Message-ID: <5babd6d0-4db4-fb95-877e-300e4c570b2a@stanford.edu>

I submitted a minor update of cubature (suggesting rmarkdown for 
vignettes) and received a message that the package generated warnings. 
However, the warnings were noted to be untrustworthy (see email below). 
I noted this in the submission comments as well as the reply to the 
auto-check email.

It appears that I am unable to get beyond the auto-check service. Any 
suggestions?

-Naras

-------- Forwarded Message --------

Subject: 	Re: [CRAN-pretest-archived] CRAN submission cubature 2.0.4.2
Date: 	Thu, 6 May 2021 12:51:37 -0700
From: 	Balasubramanian Narasimhan <naras at stanford.edu>
To: 	CRAN-submissions at R-project.org, naras at stat.stanford.edu



Dear CRAN,

As explained in my submission comment, the warning is noted to be flaky 
in the message below.

Thank you.

-Naras

On 18/03/2021 13:05, Kurt Hornik wrote:

>>>>>> Uwe Ligges writes:
>
>> Dear Naras,
>> your package cubature shows compiler warnings under Windows:
>> <https://cran.r-project.org/web/checks/check_results_cubature.html>
>
>> Any chance getting rid of these? Please try and resubmit.
>
> Interestingly, r-release-macos shows this too ...

I think -Warray-bounds is known to be flaky in earlier compilers.? I do 
not see this on macOS with Apple Clang 11.5 (latest for High Sierra) or 
12.4 (current) and nor does Tomas for GCC 10 on Windows.


-- 
Brian D. Ripley, ripley at stats.ox.ac.uk
Emeritus Professor of Applied Statistics, University of Oxford
On 5/6/21 12:27 PM, ligges at statistik.tu-dortmund.de wrote:
> Dear maintainer,
>   
> package cubature_2.0.4.2.tar.gz does not pass the incoming checks automatically, please see the following pre-tests:
> Windows:<https://win-builder.r-project.org/incoming_pretest/cubature_2.0.4.2_20210506_211603/Windows/00check.log>
> Status: 1 WARNING
> Debian:<https://win-builder.r-project.org/incoming_pretest/cubature_2.0.4.2_20210506_211603/Debian/00check.log>
> Status: OK
>   
> Last released version's CRAN status: WARN: 3, NOTE: 10
> See:<https://CRAN.R-project.org/web/checks/check_results_cubature.html>
>   
> CRAN Web:<https://cran.r-project.org/package=cubature>
>   
> Please fix all problems and resubmit a fixed version via the webform.
> If you are not sure how to fix the problems shown, please ask for help on the R-package-devel mailing list:
> <https://stat.ethz.ch/mailman/listinfo/r-package-devel>
> If you are fairly certain the rejection is a false positive, please reply-all to this message and explain.
>   
> More details are given in the directory:
> <https://win-builder.r-project.org/incoming_pretest/cubature_2.0.4.2_20210506_211603/>
> The files will be removed after roughly 7 days.
>   
> *** Strong rev. depends ***: ALTopt apTreeshape bivquant BNSP calibrator clusteredinterference coga cold dbmss DRAYL dvmisc ei equivalenceTest fMultivar GAS GB2 GPCMlasso GRCdata highfrequency hyper2 ICAOD inctools MCMCglmm MIRES MMDCopula MWright NonNorMvtDist np OBASpatial ODS optimStrat PCMRS planar pooling Power2Stage PowerTOST ProFit QGglmm robustlmm skedastic SphericalCubature spNetwork statsr SurvDisc symmoments TCIU tseriesEntropy UPCM vines WLinfer yuima
>   
> Best regards,
> CRAN teams' auto-check service
>
> Flavor: r-devel-linux-x86_64-debian-gcc, r-devel-windows-ix86+x86_64
> Check: CRAN incoming feasibility, Result: Note_to_CRAN_maintainers
>    Maintainer: 'Balasubramanian Narasimhan<naras at stat.stanford.edu>'
>
> Flavor: r-devel-windows-ix86+x86_64
> Check: whether package can be installed, Result: WARNING
>    Found the following significant warnings:
>      ./src/common/Random.c:105:5: warning: 'memcpy' pointer overflow between offset 0 and size [4294967292, 2147483647] [-Warray-bounds]
>      ./src/common/Random.c:105:5: warning: 'memcpy' pointer overflow between offset 0 and size [-4, 9223372036854775807] [-Warray-bounds]
>    See 'd:/RCompile/CRANincoming/R-devel/cubature.Rcheck/00install.out' for details.

	[[alternative HTML version deleted]]


From edd @end|ng |rom deb|@n@org  Mon May 10 22:44:26 2021
From: edd @end|ng |rom deb|@n@org (Dirk Eddelbuettel)
Date: Mon, 10 May 2021 15:44:26 -0500
Subject: [R-pkg-devel] 
 Unable to get past CRAN submission checks for package cubature
In-Reply-To: <5babd6d0-4db4-fb95-877e-300e4c570b2a@stanford.edu>
References: <5babd6d0-4db4-fb95-877e-300e4c570b2a@stanford.edu>
Message-ID: <24729.39722.994917.854566@rob.eddelbuettel.com>


On 10 May 2021 at 13:01, Balasubramanian Narasimhan wrote:
| It appears that I am unable to get beyond the auto-check service. Any 
| suggestions?

I have tried for several weeks, and four emails, to get an answer concerning
an auto-archived submission. Ironically, it aimed to address the very 'error
on one platform' issue over which it was archived.

I still haven't heard back.

Dirk

-- 
https://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From t|@goo||voto @end|ng |rom gm@||@com  Tue May 11 22:45:37 2021
From: t|@goo||voto @end|ng |rom gm@||@com (Tiago Olivoto)
Date: Tue, 11 May 2021 17:45:37 -0300
Subject: [R-pkg-devel] Installed image not found in Debian
Message-ID: <CAMyz+tXC83T_zPM4h4brZawETtx=ja0x9YmObfL7nG8QyJfx+g@mail.gmail.com>

Dear all,
I just submitted a new package 'pliman' (
https://github.com/TiagoOlivoto/pliman) and it does not pass the incoming
checks automatically.
I have some images that are under '/inst/tmp_images' to be installed with
the package. In some examples and Vignettes, I use the helper function
image_pliman() <
https://github.com/TiagoOlivoto/pliman/blob/master/R/utils_imagem.R#L125>
to get the patch of a given image

Then, I use image_import() <
https://github.com/TiagoOlivoto/pliman/blob/master/R/utils_imagem.R#L69> to
import the image into R.

All tests passed in Windows <
https://win-builder.r-project.org/incoming_pretest/pliman_0.1.0_20210511_212904/Windows/00check.log>
but an error was got in Debian <
https://win-builder.r-project.org/incoming_pretest/pliman_0.1.0_20210511_212904/Debian/00check.log
>
The error occurs when image_import () has been called, for example

image_import(image_pliman("soybean_touch.jpg"))
Error:  'soybean_touch' not found in
.//srv/hornik/tmp/CRAN/pliman.Rcheck/pliman/tmp_images

It seems that this error comes from this check <
https://github.com/TiagoOlivoto/pliman/blob/master/R/utils_imagem.R#L92-L97>
that checks if the image name is available in the directory. Please, see a
toy example with my data.

# Get the patch of the image
image <- image_pliman("soybean_touch.jpg")
image
[1] "E:/Documents/R/win-library/4.0/pliman/tmp_images/soybean_touch.jpg"

# Get the directory of the image
img_dir <- file_dir(image)
> img_dir
[1] "E:/Documents/R/win-library/4.0/pliman/tmp_images"

# Get all files in the directory
> all_files <- sapply(list.files(img_dir), file_name)
> all_files
    background.jpg        la_back.jpg        la_leaf.jpg      la_leaves.JPG
      "background"          "la_back"          "la_leaf"        "la_leaves"
    la_pattern.JPG        la_temp.jpg objects_300dpi.jpg       sev_back.jpg
      "la_pattern"          "la_temp"   "objects_300dpi"         "sev_back"
   sev_healthy.jpg       sev_leaf.jpg    sev_leaf_nb.jpg      sev_sympt.jpg
     "sev_healthy"         "sev_leaf"      "sev_leaf_nb"        "sev_sympt"
     soy_green.jpg  soybean_grain.jpg  soybean_touch.jpg
       "soy_green"    "soybean_grain"    "soybean_touch"

# Get the name of the image and check if it is in the directory
> img_name <- file_name(image)
> img_name
[1] "soybean_touch"

if(!grepl("http", img_dir, fixed = TRUE) & !img_name %in% all_files){
  stop(" '", img_name, "' not found in ", img_dir,  call. = FALSE)
}

In this case, there is no error since  "soybean_touch" is in 'all_files'

I have no idea how to fix this issue and why this error occurs only on
Debian and not on Windows. Any suggestion to fix the error and/or improve
the code will be welcome!
Thanks in advance,
Tiago

	[[alternative HTML version deleted]]


From brod|e@g@@|@m @end|ng |rom y@hoo@com  Wed May 12 00:02:58 2021
From: brod|e@g@@|@m @end|ng |rom y@hoo@com (brodie gaslam)
Date: Tue, 11 May 2021 22:02:58 +0000 (UTC)
Subject: [R-pkg-devel] 
 Unable to get past CRAN submission checks for package cubature
In-Reply-To: <5babd6d0-4db4-fb95-877e-300e4c570b2a@stanford.edu>
References: <5babd6d0-4db4-fb95-877e-300e4c570b2a@stanford.edu>
Message-ID: <1292146705.1350575.1620770578390@mail.yahoo.com>

At the risk of only being mildly (if at all) helpful, I was able
to reproduce your warnings on Rhub, which has the same compiler,
with:

??? rhub::check('cubature_2.0.4.1.tar.gz', platform='windows-x86_64-release')

Absent feedback from CRAN you could try tweaking your code so that
it does not produce those warnings while no changing behavior.
Obviously, iterating with rhub is not the easiest way to do this,
but might be easier than trying to get GCC 8.3.

For reference, you might be hitting:

https://gcc.gnu.org/bugzilla/show_bug.cgi?id=88273

Maybe you knew that already but it might be useful for others to be
aware there is an actual bug that at least is in the general area
that affects GCC 8.2-8.3.

Best,

B.




On Monday, May 10, 2021, 4:01:36 PM EDT, Balasubramanian Narasimhan <naras at stanford.edu> wrote: 





I submitted a minor update of cubature (suggesting rmarkdown for 
vignettes) and received a message that the package generated warnings. 
However, the warnings were noted to be untrustworthy (see email below). 
I noted this in the submission comments as well as the reply to the 
auto-check email.

It appears that I am unable to get beyond the auto-check service. Any 
suggestions?

-Naras

-------- Forwarded Message --------

Subject: ??? Re: [CRAN-pretest-archived] CRAN submission cubature 2.0.4.2
Date: ??? Thu, 6 May 2021 12:51:37 -0700
From: ??? Balasubramanian Narasimhan <naras at stanford.edu>
To: ??? CRAN-submissions at R-project.org, naras at stat.stanford.edu



Dear CRAN,

As explained in my submission comment, the warning is noted to be flaky 
in the message below.

Thank you.

-Naras

On 18/03/2021 13:05, Kurt Hornik wrote:

>>>>>> Uwe Ligges writes:
>
>> Dear Naras,
>> your package cubature shows compiler warnings under Windows:
>> <https://cran.r-project.org/web/checks/check_results_cubature.html>
>
>> Any chance getting rid of these? Please try and resubmit.
>
> Interestingly, r-release-macos shows this too ...

I think -Warray-bounds is known to be flaky in earlier compilers.? I do 
not see this on macOS with Apple Clang 11.5 (latest for High Sierra) or 
12.4 (current) and nor does Tomas for GCC 10 on Windows.


-- 
Brian D. Ripley, ripley at stats.ox.ac.uk
Emeritus Professor of Applied Statistics, University of Oxford
On 5/6/21 12:27 PM, ligges at statistik.tu-dortmund.de wrote:
> Dear maintainer,
>? 
> package cubature_2.0.4.2.tar.gz does not pass the incoming checks automatically, please see the following pre-tests:
> Windows:<https://win-builder.r-project.org/incoming_pretest/cubature_2.0.4.2_20210506_211603/Windows/00check.log>
> Status: 1 WARNING
> Debian:<https://win-builder.r-project.org/incoming_pretest/cubature_2.0.4.2_20210506_211603/Debian/00check.log>
> Status: OK
>? 
> Last released version's CRAN status: WARN: 3, NOTE: 10
> See:<https://CRAN.R-project.org/web/checks/check_results_cubature.html>
>? 
> CRAN Web:<https://cran.r-project.org/package=cubature>
>? 
> Please fix all problems and resubmit a fixed version via the webform.
> If you are not sure how to fix the problems shown, please ask for help on the R-package-devel mailing list:
> <https://stat.ethz.ch/mailman/listinfo/r-package-devel>
> If you are fairly certain the rejection is a false positive, please reply-all to this message and explain.
>? 
> More details are given in the directory:
> <https://win-builder.r-project.org/incoming_pretest/cubature_2.0.4.2_20210506_211603/>
> The files will be removed after roughly 7 days.
>? 
> *** Strong rev. depends ***: ALTopt apTreeshape bivquant BNSP calibrator clusteredinterference coga cold dbmss DRAYL dvmisc ei equivalenceTest fMultivar GAS GB2 GPCMlasso GRCdata highfrequency hyper2 ICAOD inctools MCMCglmm MIRES MMDCopula MWright NonNorMvtDist np OBASpatial ODS optimStrat PCMRS planar pooling Power2Stage PowerTOST ProFit QGglmm robustlmm skedastic SphericalCubature spNetwork statsr SurvDisc symmoments TCIU tseriesEntropy UPCM vines WLinfer yuima
>? 
> Best regards,
> CRAN teams' auto-check service
>
> Flavor: r-devel-linux-x86_64-debian-gcc, r-devel-windows-ix86+x86_64
> Check: CRAN incoming feasibility, Result: Note_to_CRAN_maintainers
>? ? Maintainer: 'Balasubramanian Narasimhan<naras at stat.stanford.edu>'
>
> Flavor: r-devel-windows-ix86+x86_64
> Check: whether package can be installed, Result: WARNING
>? ? Found the following significant warnings:
>? ? ? ./src/common/Random.c:105:5: warning: 'memcpy' pointer overflow between offset 0 and size [4294967292, 2147483647] [-Warray-bounds]
>? ? ? ./src/common/Random.c:105:5: warning: 'memcpy' pointer overflow between offset 0 and size [-4, 9223372036854775807] [-Warray-bounds]
>? ? See 'd:/RCompile/CRANincoming/R-devel/cubature.Rcheck/00install.out' for details.

??? [[alternative HTML version deleted]]

______________________________________________
R-package-devel at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-package-devel


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Wed May 12 00:06:26 2021
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Tue, 11 May 2021 15:06:26 -0700
Subject: [R-pkg-devel] Installed image not found in Debian
In-Reply-To: <CAMyz+tXC83T_zPM4h4brZawETtx=ja0x9YmObfL7nG8QyJfx+g@mail.gmail.com>
References: <CAMyz+tXC83T_zPM4h4brZawETtx=ja0x9YmObfL7nG8QyJfx+g@mail.gmail.com>
Message-ID: <2DD54211-52A8-4938-B830-9884BAFBB159@dcn.davis.ca.us>

Why aren't you using system.file()?

On May 11, 2021 1:45:37 PM PDT, Tiago Olivoto <tiagoolivoto at gmail.com> wrote:
>Dear all,
>I just submitted a new package 'pliman' (
>https://github.com/TiagoOlivoto/pliman) and it does not pass the
>incoming
>checks automatically.
>I have some images that are under '/inst/tmp_images' to be installed
>with
>the package. In some examples and Vignettes, I use the helper function
>image_pliman() <
>https://github.com/TiagoOlivoto/pliman/blob/master/R/utils_imagem.R#L125>
>to get the patch of a given image
>
>Then, I use image_import() <
>https://github.com/TiagoOlivoto/pliman/blob/master/R/utils_imagem.R#L69>
>to
>import the image into R.
>
>All tests passed in Windows <
>https://win-builder.r-project.org/incoming_pretest/pliman_0.1.0_20210511_212904/Windows/00check.log>
>but an error was got in Debian <
>https://win-builder.r-project.org/incoming_pretest/pliman_0.1.0_20210511_212904/Debian/00check.log
>>
>The error occurs when image_import () has been called, for example
>
>image_import(image_pliman("soybean_touch.jpg"))
>Error:  'soybean_touch' not found in
>.//srv/hornik/tmp/CRAN/pliman.Rcheck/pliman/tmp_images
>
>It seems that this error comes from this check <
>https://github.com/TiagoOlivoto/pliman/blob/master/R/utils_imagem.R#L92-L97>
>that checks if the image name is available in the directory. Please,
>see a
>toy example with my data.
>
># Get the patch of the image
>image <- image_pliman("soybean_touch.jpg")
>image
>[1]
>"E:/Documents/R/win-library/4.0/pliman/tmp_images/soybean_touch.jpg"
>
># Get the directory of the image
>img_dir <- file_dir(image)
>> img_dir
>[1] "E:/Documents/R/win-library/4.0/pliman/tmp_images"
>
># Get all files in the directory
>> all_files <- sapply(list.files(img_dir), file_name)
>> all_files
>background.jpg        la_back.jpg        la_leaf.jpg      la_leaves.JPG
>  "background"          "la_back"          "la_leaf"        "la_leaves"
>la_pattern.JPG        la_temp.jpg objects_300dpi.jpg       sev_back.jpg
>  "la_pattern"          "la_temp"   "objects_300dpi"         "sev_back"
>sev_healthy.jpg       sev_leaf.jpg    sev_leaf_nb.jpg     
>sev_sympt.jpg
> "sev_healthy"         "sev_leaf"      "sev_leaf_nb"        "sev_sympt"
>     soy_green.jpg  soybean_grain.jpg  soybean_touch.jpg
>       "soy_green"    "soybean_grain"    "soybean_touch"
>
># Get the name of the image and check if it is in the directory
>> img_name <- file_name(image)
>> img_name
>[1] "soybean_touch"
>
>if(!grepl("http", img_dir, fixed = TRUE) & !img_name %in% all_files){
>  stop(" '", img_name, "' not found in ", img_dir,  call. = FALSE)
>}
>
>In this case, there is no error since  "soybean_touch" is in
>'all_files'
>
>I have no idea how to fix this issue and why this error occurs only on
>Debian and not on Windows. Any suggestion to fix the error and/or
>improve
>the code will be welcome!
>Thanks in advance,
>Tiago
>
>	[[alternative HTML version deleted]]
>
>______________________________________________
>R-package-devel at r-project.org mailing list
>https://stat.ethz.ch/mailman/listinfo/r-package-devel

-- 
Sent from my phone. Please excuse my brevity.


From edun|p@ce @end|ng |rom m@||@h@rv@rd@edu  Wed May 12 20:03:38 2021
From: edun|p@ce @end|ng |rom m@||@h@rv@rd@edu (Eric Dunipace)
Date: Wed, 12 May 2021 11:03:38 -0700
Subject: [R-pkg-devel] Including header files with long filenames in an R
 pacakge
References: <81e2dc9a-51d3-46b2-b060-8650a0ce2c39@Spark>
Message-ID: <364493b2-b642-4fa3-a515-2678d7695059@Spark>

Hello,

I did some searching and wasn?t able to find a good answer to my question, so I hope that someone here has knowledge of how to fix the problem.

I?m currently trying to create an R package that bundles the CGAL header files (http://www.cgal.org) for easy linking by other packages?that will be in an inst/include directory. Unfortunately, the names of the header files with their directory/subdirectory structures exceed the filename limit for R packages on CRAN. Is there a way to bundle these into the R package without changing their names?

Since these are simply a reproduction of the CGAL header files, I don?t want to change their filenames since that will make their usage different than users would expect, and also make it more difficult to reference documentation on the CGAL website.

For reference, I?m building with R 4.0.3 and have a git repository with the package at <https://github.com/ericdunipace/RcppCGAL>.

Thanks in advance,
Eric Dunipace

	[[alternative HTML version deleted]]


From edd @end|ng |rom deb|@n@org  Wed May 12 21:03:53 2021
From: edd @end|ng |rom deb|@n@org (Dirk Eddelbuettel)
Date: Wed, 12 May 2021 14:03:53 -0500
Subject: [R-pkg-devel] 
 Including header files with long filenames in an R pacakge
In-Reply-To: <364493b2-b642-4fa3-a515-2678d7695059@Spark>
References: <81e2dc9a-51d3-46b2-b060-8650a0ce2c39@Spark>
 <364493b2-b642-4fa3-a515-2678d7695059@Spark>
Message-ID: <24732.9881.408625.808736@rob.eddelbuettel.com>


On 12 May 2021 at 11:03, Eric Dunipace wrote:
| I did some searching and wasn?t able to find a good answer to my question, so I hope that someone here has knowledge of how to fix the problem.
| 
| I?m currently trying to create an R package that bundles the CGAL header files (http://www.cgal.org) for easy linking by other packages?that will be in an inst/include directory. Unfortunately, the names of the header files with their directory/subdirectory structures exceed the filename limit for R packages on CRAN. Is there a way to bundle these into the R package without changing their names?
| 
| Since these are simply a reproduction of the CGAL header files, I don?t want to change their filenames since that will make their usage different than users would expect, and also make it more difficult to reference documentation on the CGAL website.

CRAN will request that you change the filenames to shorten them.

I have done so each time for the BH package as you will see in its GitHub
repo and the patch files.

Dirk

-- 
https://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From edun|p@ce @end|ng |rom m@||@h@rv@rd@edu  Wed May 12 21:13:29 2021
From: edun|p@ce @end|ng |rom m@||@h@rv@rd@edu (Eric Dunipace)
Date: Wed, 12 May 2021 12:13:29 -0700
Subject: [R-pkg-devel] 
 Including header files with long filenames in an R pacakge
In-Reply-To: <24732.9881.408625.808736@rob.eddelbuettel.com>
References: <81e2dc9a-51d3-46b2-b060-8650a0ce2c39@Spark>
 <364493b2-b642-4fa3-a515-2678d7695059@Spark>
 <24732.9881.408625.808736@rob.eddelbuettel.com>
Message-ID: <0be682cf-77d3-4119-877a-186e8096e6d8@Spark>

Ok, thank you for the info.
On May 12, 2021, 12:03 PM -0700, Dirk Eddelbuettel <edd at debian.org>, wrote:
>
> On 12 May 2021 at 11:03, Eric Dunipace wrote:
> | I did some searching and wasn?t able to find a good answer to my question, so I hope that someone here has knowledge of how to fix the problem.
> |
> | I?m currently trying to create an R package that bundles the CGAL header files (http://www.cgal.org) for easy linking by other packages?that will be in an inst/include directory. Unfortunately, the names of the header files with their directory/subdirectory structures exceed the filename limit for R packages on CRAN. Is there a way to bundle these into the R package without changing their names?
> |
> | Since these are simply a reproduction of the CGAL header files, I don?t want to change their filenames since that will make their usage different than users would expect, and also make it more difficult to reference documentation on the CGAL website.
>
> CRAN will request that you change the filenames to shorten them.
>
> I have done so each time for the BH package as you will see in its GitHub
> repo and the patch files.
>
> Dirk
>
> --
> https://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org

	[[alternative HTML version deleted]]


From @n248 @end|ng |rom corne||@edu  Thu May 13 07:06:32 2021
From: @n248 @end|ng |rom corne||@edu (SN248)
Date: Thu, 13 May 2021 01:06:32 -0400
Subject: [R-pkg-devel] Passing CRAN checks for a package linking to a system
 library on CRAN machines
Message-ID: <CAP6q79G7KPwQisw8PubEuovhUZGijy1VT6Q91WbQ7MAQpFxmhw@mail.gmail.com>

I am working on a package which provides an interface to the libsbml C++
library (http://sbml.org/Software/libSBML) in R. The source code of this
package (r2sbml) can be found at the following link

https://github.com/sn248/r2sbml

The package passes CRAN checks with `R CMD check` on my machine, but I do
have dependency (libsbml library) installed on my machine (OSX) with
headers and static libs at the usual locations, i.e., /usr/local/include
and /usr/local/lib. The package also passes CRAN check on a Windows machine
with libsbml installed using Rtools40 and msys2. The DESCRIPTION file lists
libsbml in SystemRequirements but `R CMD check` obviously fails on rhub
machines because there are no instructions to install libsbml first. As I
understand, I have the following options to pass checks on CRAN

1. Bundle the source code of libsbml into the package and make the static
libs on the fly. I don't really want to try this approach even though I
have used this approach before in another package as I think creating the
static lib is not as straightforward for this library because of the large
number of files and complex dependency chart.

2. Include header files in the `inst` folder and pull the static libs from
rwinlib github (assuming the libs can be posted there). I am not sure if
this approach will work on all platforms on which CRAN checks take place.

3. Somehow include instructions to install libsbml on CRAN machines (I have
no idea how to do this), or request CRAN maintainers to install libsbml
with header files and libs at usual locations (i.e., /usr/local/include and
/usr/local/lib).

I am sure some version of this question has been asked before as there are
many packages which interface with C/C++ libraries listed as
SystemRequirements, but I could not find a clear answer to this aspect,
i.e., passing checks on CRAN machines.

Any guidance here and pros/cons of the above mentioned approaches will be
very helpful.

Thanks
Satya

	[[alternative HTML version deleted]]


From @ergue|@@oko| @end|ng |rom gm@||@com  Thu May 13 07:29:01 2021
From: @ergue|@@oko| @end|ng |rom gm@||@com (Sokol Serguei)
Date: Thu, 13 May 2021 07:29:01 +0200
Subject: [R-pkg-devel] Fwd: Passing CRAN checks for a package linking to a
 system library on CRAN machines
In-Reply-To: <60a4e5e6-2b09-fccf-b49e-ea7190747d27@insa-toulouse.fr>
References: <60a4e5e6-2b09-fccf-b49e-ea7190747d27@insa-toulouse.fr>
Message-ID: <56ab6aa6-47ac-b1fe-4da8-310a8d0bffa8@gmail.com>

Le 13/05/2021 ? 07:06, SN248 a ?crit?:
> I am working on a package which provides an interface to the libsbml C++
> library (http://sbml.org/Software/libSBML) in R. The source code of this
> package (r2sbml) can be found at the following link
>
> https://github.com/sn248/r2sbml
>
> The package passes CRAN checks with `R CMD check` on my machine, but I do
> have dependency (libsbml library) installed on my machine (OSX) with
> headers and static libs at the usual locations, i.e., /usr/local/include
> and /usr/local/lib. The package also passes CRAN check on a Windows 
> machine
> with libsbml installed using Rtools40 and msys2. The DESCRIPTION file 
> lists
> libsbml in SystemRequirements but `R CMD check` obviously fails on rhub
> machines because there are no instructions to install libsbml first. As I
> understand, I have the following options to pass checks on CRAN
>
> 1. Bundle the source code of libsbml into the package and make the static
> libs on the fly. I don't really want to try this approach even though I
> have used this approach before in another package as I think creating the
> static lib is not as straightforward for this library because of the large
> number of files and complex dependency chart.
>
> 2. Include header files in the `inst` folder and pull the static libs from
> rwinlib github (assuming the libs can be posted there). I am not sure if
> this approach will work on all platforms on which CRAN checks take place.
>
> 3. Somehow include instructions to install libsbml on CRAN machines (I 
> have
> no idea how to do this), or request CRAN maintainers to install libsbml
> with header files and libs at usual locations (i.e., 
> /usr/local/include and
> /usr/local/lib).

I faced the same problem for my package r2sundials and in the end, I 
have opted for including the third-party source code into the package. 
However, a CRAN team member told me later that such kind of request 
(i.e. install third-party software on CRAN machines) can be sent to the 
CRAN team. Not sure that they accept but I think you can start by asking 
it and if the request is rejected, you can try other options.

Best,
Serguei.

>
> I am sure some version of this question has been asked before as there are
> many packages which interface with C/C++ libraries listed as
> SystemRequirements, but I could not find a clear answer to this aspect,
> i.e., passing checks on CRAN machines.
>
> Any guidance here and pros/cons of the above mentioned approaches will be
> very helpful.
>
> Thanks
> Satya
>
> [[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From tom@@@k@||ber@ @end|ng |rom gm@||@com  Thu May 13 08:28:11 2021
From: tom@@@k@||ber@ @end|ng |rom gm@||@com (Tomas Kalibera)
Date: Thu, 13 May 2021 08:28:11 +0200
Subject: [R-pkg-devel] 
 Passing CRAN checks for a package linking to a system
 library on CRAN machines
In-Reply-To: <CAP6q79G7KPwQisw8PubEuovhUZGijy1VT6Q91WbQ7MAQpFxmhw@mail.gmail.com>
References: <CAP6q79G7KPwQisw8PubEuovhUZGijy1VT6Q91WbQ7MAQpFxmhw@mail.gmail.com>
Message-ID: <dd0be7de-65f1-18a2-72bf-6835d6cc8f14@gmail.com>


On 5/13/21 7:06 AM, SN248 wrote:
> I am working on a package which provides an interface to the libsbml C++
> library (http://sbml.org/Software/libSBML) in R. The source code of this
> package (r2sbml) can be found at the following link
>
> https://github.com/sn248/r2sbml
>
> The package passes CRAN checks with `R CMD check` on my machine, but I do
> have dependency (libsbml library) installed on my machine (OSX) with
> headers and static libs at the usual locations, i.e., /usr/local/include
> and /usr/local/lib. The package also passes CRAN check on a Windows machine
> with libsbml installed using Rtools40 and msys2. The DESCRIPTION file lists
> libsbml in SystemRequirements but `R CMD check` obviously fails on rhub
> machines because there are no instructions to install libsbml first. As I
> understand, I have the following options to pass checks on CRAN
>
> 1. Bundle the source code of libsbml into the package and make the static
> libs on the fly. I don't really want to try this approach even though I
> have used this approach before in another package as I think creating the
> static lib is not as straightforward for this library because of the large
> number of files and complex dependency chart.
>
> 2. Include header files in the `inst` folder and pull the static libs from
> rwinlib github (assuming the libs can be posted there). I am not sure if
> this approach will work on all platforms on which CRAN checks take place.
>
> 3. Somehow include instructions to install libsbml on CRAN machines (I have
> no idea how to do this), or request CRAN maintainers to install libsbml
> with header files and libs at usual locations (i.e., /usr/local/include and
> /usr/local/lib).
>
> I am sure some version of this question has been asked before as there are
> many packages which interface with C/C++ libraries listed as
> SystemRequirements, but I could not find a clear answer to this aspect,
> i.e., passing checks on CRAN machines.
>
> Any guidance here and pros/cons of the above mentioned approaches will be
> very helpful.

I think the best way for maintenance and end users is when the libraries 
are part of common software distributions R is used with on each 
platforms, which are also installed on CRAN machines. For Linux these 
are popular distributions including Debian, Ubuntu, Fedora. For Windows 
this is customized msys2 (rtools) and customized mxe. For macOS this is 
a custom distribution ("recipes").

So, if your library is already present in those distributions, but not 
installed on some of the CRAN machines, I'd simply ask for it to be 
installed - the installation is trivial in that case, this is what the 
distributions are for.

If the library is not present in those distributions, the next best I 
think is to contribute it to them. In case of Windows, ideally 
contribute also to the upstream vanilla distributions, not just to the 
customized versions for R. This would allow most people to benefit from 
your contribution, and the additional burden on CRAN maintainers (who 
have to deal with many thousands of packages) would be minimized.

If all that failed, and the license allows, one can include the source 
code of the library into the package, but that creates burden on users 
as well as maintainers (of the package, but also the repository). It may 
create confusion about the configuration due to duplication between 
packages. It creates burden for repository maintainers. It takes 
additional time on installation (particularly some libraries heavily 
using C++ take forever to build, and repository maintainers do that very 
often).

Downloading pre-compiled binaries (static libraries) at installation 
time is the worst option in my view. It is non-transparent, 
non-repeatable, and the binaries may be incompatible (e.g. on Windows 
all object files have to be built for the same C runtime). It makes 
maintenance of R much harder, currently the transition from MSVCRT to 
UCRT on Windows.

Best
Tomas

>
> Thanks
> Satya
>
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From tom@@@k@||ber@ @end|ng |rom gm@||@com  Thu May 13 10:41:14 2021
From: tom@@@k@||ber@ @end|ng |rom gm@||@com (Tomas Kalibera)
Date: Thu, 13 May 2021 10:41:14 +0200
Subject: [R-pkg-devel] 
 Fwd: Passing CRAN checks for a package linking to a
 system library on CRAN machines
In-Reply-To: <56ab6aa6-47ac-b1fe-4da8-310a8d0bffa8@gmail.com>
References: <60a4e5e6-2b09-fccf-b49e-ea7190747d27@insa-toulouse.fr>
 <56ab6aa6-47ac-b1fe-4da8-310a8d0bffa8@gmail.com>
Message-ID: <5540f1e3-2fc7-3008-4edf-6fbca07330b7@gmail.com>


On 5/13/21 7:29 AM, Sokol Serguei wrote:
> Le 13/05/2021 ? 07:06, SN248 a ?crit?:
>> I am working on a package which provides an interface to the libsbml C++
>> library (http://sbml.org/Software/libSBML) in R. The source code of this
>> package (r2sbml) can be found at the following link
>>
>> https://github.com/sn248/r2sbml
>>
>> The package passes CRAN checks with `R CMD check` on my machine, but 
>> I do
>> have dependency (libsbml library) installed on my machine (OSX) with
>> headers and static libs at the usual locations, i.e., /usr/local/include
>> and /usr/local/lib. The package also passes CRAN check on a Windows 
>> machine
>> with libsbml installed using Rtools40 and msys2. The DESCRIPTION file 
>> lists
>> libsbml in SystemRequirements but `R CMD check` obviously fails on rhub
>> machines because there are no instructions to install libsbml first. 
>> As I
>> understand, I have the following options to pass checks on CRAN
>>
>> 1. Bundle the source code of libsbml into the package and make the 
>> static
>> libs on the fly. I don't really want to try this approach even though I
>> have used this approach before in another package as I think creating 
>> the
>> static lib is not as straightforward for this library because of the 
>> large
>> number of files and complex dependency chart.
>>
>> 2. Include header files in the `inst` folder and pull the static libs 
>> from
>> rwinlib github (assuming the libs can be posted there). I am not sure if
>> this approach will work on all platforms on which CRAN checks take 
>> place.
>>
>> 3. Somehow include instructions to install libsbml on CRAN machines 
>> (I have
>> no idea how to do this), or request CRAN maintainers to install libsbml
>> with header files and libs at usual locations (i.e., 
>> /usr/local/include and
>> /usr/local/lib).
>
> I faced the same problem for my package r2sundials and in the end, I 
> have opted for including the third-party source code into the package. 
> However, a CRAN team member told me later that such kind of request 
> (i.e. install third-party software on CRAN machines) can be sent to 
> the CRAN team. Not sure that they accept but I think you can start by 
> asking it and if the request is rejected, you can try other options.

I think that sundials is a good example why trying the other options 
first is a good suggestion. It is now included in three CRAN packages 
(paropt, r2sundials, sundialr). Apart from the duplication (build time), 
it has a problem of multiply defined symbols (tentative definitions, 
issues with -fno-common, which is the default in GCC 10), which now has 
to be handled in the three packages separately.

Best
Tomas
>
> Best,
> Serguei.
>
>>
>> I am sure some version of this question has been asked before as 
>> there are
>> many packages which interface with C/C++ libraries listed as
>> SystemRequirements, but I could not find a clear answer to this aspect,
>> i.e., passing checks on CRAN machines.
>>
>> Any guidance here and pros/cons of the above mentioned approaches 
>> will be
>> very helpful.
>>
>> Thanks
>> Satya
>>
>> [[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From n@r@@ @end|ng |rom @t@n|ord@edu  Thu May 13 16:39:14 2021
From: n@r@@ @end|ng |rom @t@n|ord@edu (Balasubramanian Narasimhan)
Date: Thu, 13 May 2021 07:39:14 -0700
Subject: [R-pkg-devel] 
 Unable to get past CRAN submission checks for package cubature
In-Reply-To: <1292146705.1350575.1620770578390@mail.yahoo.com>
References: <5babd6d0-4db4-fb95-877e-300e4c570b2a@stanford.edu>
 <1292146705.1350575.1620770578390@mail.yahoo.com>
Message-ID: <8a2fc97e-7371-c48e-afd8-325817d34890@stanford.edu>

Thanks to the encouragement of Brodie Gaslam and Tomas Kalibera (private 
email), I was able to hack the code to avoid the warnings.

The code in question had the following structure:

 ??? int inibits = -1, bit;
 ??? for( j = powers; j; j >>= 1 ) ++inibits;
 ??? memcpy(pv, pini, inibits*sizeof(*pini));


which I changed to:

 ??? int inibits = -1, bit;
 ??? for( j = powers; j; j >>= 1 ) ++inibits;

 ??? int sz = inibits * sizeof(*pini);
 ??? sz = (sz > 0) ? sz : 0;

 ??? memcpy(pv, pini, sz);

to guard against the erroneous gcc 8.3 inference that inibits could 
remain at -1 if powers is zero, known to be not possible.

Best,

-Naras

On 5/11/21 3:02 PM, brodie gaslam wrote:
> At the risk of only being mildly (if at all) helpful, I was able
> to reproduce your warnings on Rhub, which has the same compiler,
> with:
>
>  ??? rhub::check('cubature_2.0.4.1.tar.gz', platform='windows-x86_64-release')
>
> Absent feedback from CRAN you could try tweaking your code so that
> it does not produce those warnings while no changing behavior.
> Obviously, iterating with rhub is not the easiest way to do this,
> but might be easier than trying to get GCC 8.3.
>
> For reference, you might be hitting:
>
> https://gcc.gnu.org/bugzilla/show_bug.cgi?id=88273
>
> Maybe you knew that already but it might be useful for others to be
> aware there is an actual bug that at least is in the general area
> that affects GCC 8.2-8.3.
>
> Best,
>
> B.
>
>
>
>
> On Monday, May 10, 2021, 4:01:36 PM EDT, Balasubramanian Narasimhan <naras at stanford.edu> wrote:
>
>
>
>
>
> I submitted a minor update of cubature (suggesting rmarkdown for
> vignettes) and received a message that the package generated warnings.
> However, the warnings were noted to be untrustworthy (see email below).
> I noted this in the submission comments as well as the reply to the
> auto-check email.
>
> It appears that I am unable to get beyond the auto-check service. Any
> suggestions?
>
> -Naras
>
> -------- Forwarded Message --------
>
> Subject: ??? Re: [CRAN-pretest-archived] CRAN submission cubature 2.0.4.2
> Date: ??? Thu, 6 May 2021 12:51:37 -0700
> From: ??? Balasubramanian Narasimhan <naras at stanford.edu>
> To: ??? CRAN-submissions at R-project.org, naras at stat.stanford.edu
>
>
>
> Dear CRAN,
>
> As explained in my submission comment, the warning is noted to be flaky
> in the message below.
>
> Thank you.
>
> -Naras
>
> On 18/03/2021 13:05, Kurt Hornik wrote:
>
>>>>>>> Uwe Ligges writes:
>>> Dear Naras,
>>> your package cubature shows compiler warnings under Windows:
>>> <https://cran.r-project.org/web/checks/check_results_cubature.html>
>>> Any chance getting rid of these? Please try and resubmit.
>> Interestingly, r-release-macos shows this too ...
> I think -Warray-bounds is known to be flaky in earlier compilers.? I do
> not see this on macOS with Apple Clang 11.5 (latest for High Sierra) or
> 12.4 (current) and nor does Tomas for GCC 10 on Windows.
>
>


From @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org  Fri May 14 02:00:10 2021
From: @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org (Spencer Graves)
Date: Thu, 13 May 2021 19:00:10 -0500
Subject: [R-pkg-devel] autotesting on GitHub with Travis or ...?
Message-ID: <39bc47b9-c911-e8f6-e07d-fcf83574a041@effectivedefense.org>

Hello, All:


	  What are the current recommendations for automatic testing of an R 
package on GitHub?


	  Section 19.3 in the current version of "R Packages" describes 
"Checking after every commit with Travis".  It recommends Travis.  It 
says to use Travis, first "Run usethis::use_travis()".[1]


	  However, 'help("use_travis", package="usethis")' says it's 
deprecated, but I don't understand what is recommended as an alternative.


	  What do you suggest?


	  Thanks,
	  Spencer Graves


[1]
https://r-pkgs.org/r-cmd-check.html?q=travis#travis


From bbo|ker @end|ng |rom gm@||@com  Fri May 14 02:04:24 2021
From: bbo|ker @end|ng |rom gm@||@com (Ben Bolker)
Date: Thu, 13 May 2021 20:04:24 -0400
Subject: [R-pkg-devel] autotesting on GitHub with Travis or ...?
In-Reply-To: <39bc47b9-c911-e8f6-e07d-fcf83574a041@effectivedefense.org>
References: <39bc47b9-c911-e8f6-e07d-fcf83574a041@effectivedefense.org>
Message-ID: <ca5a6f26-3571-4958-5b41-efd74894de8e@gmail.com>

   GitHub Actions

   ?usethis::use_github_action

   Probably start here if you are moving from Travis: 
https://deanattali.com/blog/migrating-travis-to-github/

On 5/13/21 8:00 PM, Spencer Graves wrote:
> Hello, All:
> 
> 
>  ????? What are the current recommendations for automatic testing of an 
> R package on GitHub?
> 
> 
>  ????? Section 19.3 in the current version of "R Packages" describes 
> "Checking after every commit with Travis".? It recommends Travis.? It 
> says to use Travis, first "Run usethis::use_travis()".[1]
> 
> 
>  ????? However, 'help("use_travis", package="usethis")' says it's 
> deprecated, but I don't understand what is recommended as an alternative.
> 
> 
>  ????? What do you suggest?
> 
> 
>  ????? Thanks,
>  ????? Spencer Graves
> 
> 
> [1]
> https://r-pkgs.org/r-cmd-check.html?q=travis#travis
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From murr@y@e||ord @end|ng |rom ot@go@@c@nz  Fri May 14 02:32:12 2021
From: murr@y@e||ord @end|ng |rom ot@go@@c@nz (Murray Efford)
Date: Fri, 14 May 2021 00:32:12 +0000
Subject: [R-pkg-devel] State of stringi and stringr
Message-ID: <SY4PR01MB56589D7F8604072D94852C41AC509@SY4PR01MB5658.ausprd01.prod.outlook.com>

CRAN checks of 'secr' 4.4.1 (https://CRAN.R-project.org/package=secr) show an error on r-oldrel-windows-ix86+x86_64 :

** byte-compile and prepare package for lazy loading
Error in loadNamespace(i, c(lib.loc, .libPaths()), versionCheck = vI[[i]]) : 
  there is no package called 'stringi'

'secr' imports from 'stringr' that imports 'stringi', that was updated 10 May. 'secr' does not use 'stringi' directly.  The error also appears on current CRAN tests of 'openCR' 2.0.1 with r-devel-windows-ix86+x86_64.

Can I assume this is a transient problem and advise CRAN accordingly when I update my own package?





From ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de  Fri May 14 03:12:44 2021
From: ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de (Uwe Ligges)
Date: Fri, 14 May 2021 03:12:44 +0200
Subject: [R-pkg-devel] State of stringi and stringr
In-Reply-To: <SY4PR01MB56589D7F8604072D94852C41AC509@SY4PR01MB5658.ausprd01.prod.outlook.com>
References: <SY4PR01MB56589D7F8604072D94852C41AC509@SY4PR01MB5658.ausprd01.prod.outlook.com>
Message-ID: <d08fa9bc-c4c0-be2d-95aa-bdd13369441c@statistik.tu-dortmund.de>



On 14.05.2021 02:32, Murray Efford wrote:
> CRAN checks of 'secr' 4.4.1 (https://CRAN.R-project.org/package=secr) show an error on r-oldrel-windows-ix86+x86_64 :
> 
> ** byte-compile and prepare package for lazy loading
> Error in loadNamespace(i, c(lib.loc, .libPaths()), versionCheck = vI[[i]]) :
>    there is no package called 'stringi'
> 
> 'secr' imports from 'stringr' that imports 'stringi', that was updated 10 May. 'secr' does not use 'stringi' directly.  The error also appears on current CRAN tests of 'openCR' 2.0.1 with r-devel-windows-ix86+x86_64.
> 
> Can I assume this is a transient problem and advise CRAN accordingly when I update my own package?


Yes.

Best,
Uwe Ligges
> 
> 
> 
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


From murr@y@e||ord @end|ng |rom ot@go@@c@nz  Fri May 14 04:07:26 2021
From: murr@y@e||ord @end|ng |rom ot@go@@c@nz (Murray Efford)
Date: Fri, 14 May 2021 02:07:26 +0000
Subject: [R-pkg-devel] State of stringi and stringr
In-Reply-To: <d08fa9bc-c4c0-be2d-95aa-bdd13369441c@statistik.tu-dortmund.de>
References: <SY4PR01MB56589D7F8604072D94852C41AC509@SY4PR01MB5658.ausprd01.prod.outlook.com>,
 <d08fa9bc-c4c0-be2d-95aa-bdd13369441c@statistik.tu-dortmund.de>
Message-ID: <SY4PR01MB5658562B554047F7A16A755BAC509@SY4PR01MB5658.ausprd01.prod.outlook.com>

Thanks for clearing that up so quickly.
Murray

________________________________________
From: Uwe Ligges <ligges at statistik.tu-dortmund.de>
Sent: 14 May 2021 13:12
To: Murray Efford; r-package-devel at r-project.org
Subject: Re: [R-pkg-devel] State of stringi and stringr



On 14.05.2021 02:32, Murray Efford wrote:
> CRAN checks of 'secr' 4.4.1 (https://apc01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fcran.r-project.org%2Fpackage%3Dsecr&amp;data=04%7C01%7Cmurray.efford%40otago.ac.nz%7C09a27360247948b3b76c08d916755da4%7C0225efc578fe4928b1579ef24809e9ba%7C1%7C0%7C637565515645165196%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C1000&amp;sdata=fCVHjLUvJe%2FNFyERnO2S3onBe3skleZhgzsKS1NYNdk%3D&amp;reserved=0) show an error on r-oldrel-windows-ix86+x86_64 :
>
> ** byte-compile and prepare package for lazy loading
> Error in loadNamespace(i, c(lib.loc, .libPaths()), versionCheck = vI[[i]]) :
>    there is no package called 'stringi'
>
> 'secr' imports from 'stringr' that imports 'stringi', that was updated 10 May. 'secr' does not use 'stringi' directly.  The error also appears on current CRAN tests of 'openCR' 2.0.1 with r-devel-windows-ix86+x86_64.
>
> Can I assume this is a transient problem and advise CRAN accordingly when I update my own package?


Yes.

Best,
Uwe Ligges
>
>
>
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://apc01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-package-devel&amp;data=04%7C01%7Cmurray.efford%40otago.ac.nz%7C09a27360247948b3b76c08d916755da4%7C0225efc578fe4928b1579ef24809e9ba%7C1%7C0%7C637565515645165196%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C1000&amp;sdata=U5Mu4ZnlvZS%2FkKVrWrR02t9SU8mfy935qUcsJruf9fo%3D&amp;reserved=0
>


From @n248 @end|ng |rom corne||@edu  Fri May 14 04:19:44 2021
From: @n248 @end|ng |rom corne||@edu (SN248)
Date: Thu, 13 May 2021 22:19:44 -0400
Subject: [R-pkg-devel] 
 Passing CRAN checks for a package linking to a system
 library on CRAN machines
In-Reply-To: <dd0be7de-65f1-18a2-72bf-6835d6cc8f14@gmail.com>
References: <CAP6q79G7KPwQisw8PubEuovhUZGijy1VT6Q91WbQ7MAQpFxmhw@mail.gmail.com>
 <dd0be7de-65f1-18a2-72bf-6835d6cc8f14@gmail.com>
Message-ID: <CAP6q79HhCSr8G+B0wZD=-gMLxQWnfA6EU8dg2zazzA9UaD+iXA@mail.gmail.com>

Thank you Tomas and Sokol for your suggestions.

Based on Tomas' suggestion, it seems the best way forward would be to first
request CRAN maintainers to install libsbml on the CRAN machines. It is
quite straightforward to install the library from the instructions provided
online. If the installation fails on a particular architecture, I should
try bundling the source code and creating the static libraries.

Thanks again for your help.
Satya

On Thu, May 13, 2021 at 2:28 AM Tomas Kalibera <tomas.kalibera at gmail.com>
wrote:

>
> On 5/13/21 7:06 AM, SN248 wrote:
> > I am working on a package which provides an interface to the libsbml C++
> > library (http://sbml.org/Software/libSBML) in R. The source code of this
> > package (r2sbml) can be found at the following link
> >
> > https://github.com/sn248/r2sbml
> >
> > The package passes CRAN checks with `R CMD check` on my machine, but I do
> > have dependency (libsbml library) installed on my machine (OSX) with
> > headers and static libs at the usual locations, i.e., /usr/local/include
> > and /usr/local/lib. The package also passes CRAN check on a Windows
> machine
> > with libsbml installed using Rtools40 and msys2. The DESCRIPTION file
> lists
> > libsbml in SystemRequirements but `R CMD check` obviously fails on rhub
> > machines because there are no instructions to install libsbml first. As I
> > understand, I have the following options to pass checks on CRAN
> >
> > 1. Bundle the source code of libsbml into the package and make the static
> > libs on the fly. I don't really want to try this approach even though I
> > have used this approach before in another package as I think creating the
> > static lib is not as straightforward for this library because of the
> large
> > number of files and complex dependency chart.
> >
> > 2. Include header files in the `inst` folder and pull the static libs
> from
> > rwinlib github (assuming the libs can be posted there). I am not sure if
> > this approach will work on all platforms on which CRAN checks take place.
> >
> > 3. Somehow include instructions to install libsbml on CRAN machines (I
> have
> > no idea how to do this), or request CRAN maintainers to install libsbml
> > with header files and libs at usual locations (i.e., /usr/local/include
> and
> > /usr/local/lib).
> >
> > I am sure some version of this question has been asked before as there
> are
> > many packages which interface with C/C++ libraries listed as
> > SystemRequirements, but I could not find a clear answer to this aspect,
> > i.e., passing checks on CRAN machines.
> >
> > Any guidance here and pros/cons of the above mentioned approaches will be
> > very helpful.
>
> I think the best way for maintenance and end users is when the libraries
> are part of common software distributions R is used with on each
> platforms, which are also installed on CRAN machines. For Linux these
> are popular distributions including Debian, Ubuntu, Fedora. For Windows
> this is customized msys2 (rtools) and customized mxe. For macOS this is
> a custom distribution ("recipes").
>
> So, if your library is already present in those distributions, but not
> installed on some of the CRAN machines, I'd simply ask for it to be
> installed - the installation is trivial in that case, this is what the
> distributions are for.
>
> If the library is not present in those distributions, the next best I
> think is to contribute it to them. In case of Windows, ideally
> contribute also to the upstream vanilla distributions, not just to the
> customized versions for R. This would allow most people to benefit from
> your contribution, and the additional burden on CRAN maintainers (who
> have to deal with many thousands of packages) would be minimized.
>
> If all that failed, and the license allows, one can include the source
> code of the library into the package, but that creates burden on users
> as well as maintainers (of the package, but also the repository). It may
> create confusion about the configuration due to duplication between
> packages. It creates burden for repository maintainers. It takes
> additional time on installation (particularly some libraries heavily
> using C++ take forever to build, and repository maintainers do that very
> often).
>
> Downloading pre-compiled binaries (static libraries) at installation
> time is the worst option in my view. It is non-transparent,
> non-repeatable, and the binaries may be incompatible (e.g. on Windows
> all object files have to be built for the same C runtime). It makes
> maintenance of R much harder, currently the transition from MSVCRT to
> UCRT on Windows.
>
> Best
> Tomas
>
> >
> > Thanks
> > Satya
> >
> >       [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-package-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From tom@@@k@||ber@ @end|ng |rom gm@||@com  Fri May 14 09:59:20 2021
From: tom@@@k@||ber@ @end|ng |rom gm@||@com (Tomas Kalibera)
Date: Fri, 14 May 2021 09:59:20 +0200
Subject: [R-pkg-devel] 
 Passing CRAN checks for a package linking to a system
 library on CRAN machines
In-Reply-To: <CAP6q79HhCSr8G+B0wZD=-gMLxQWnfA6EU8dg2zazzA9UaD+iXA@mail.gmail.com>
References: <CAP6q79G7KPwQisw8PubEuovhUZGijy1VT6Q91WbQ7MAQpFxmhw@mail.gmail.com>
 <dd0be7de-65f1-18a2-72bf-6835d6cc8f14@gmail.com>
 <CAP6q79HhCSr8G+B0wZD=-gMLxQWnfA6EU8dg2zazzA9UaD+iXA@mail.gmail.com>
Message-ID: <2f9d0f4c-654e-795b-f4f1-61ad72ec7aa4@gmail.com>


On 5/14/21 4:19 AM, SN248 wrote:
> Thank you Tomas and Sokol for your suggestions.
>
> Based on Tomas' suggestion, it seems the best way forward would be to 
> first request CRAN maintainers to install libsbml on the CRAN 
> machines. It is quite straightforward to install the library from the 
> instructions provided online. If the installation fails on a 
> particular architecture, I should try bundling the source code and 
> creating the static libraries.

Please let me clarify, I am not suggesting that you ask CRAN team to 
create the distribution packages for you, but only to install an 
existing distribution package (in case they are not doing that already).

The distribution package is usually a script which automatically 
downloads the software, builds it, picks up the results, adds some 
meta-data about dependencies, and archives them in a supported format. 
Someone has to create the distribution package, and I am suggesting that 
you as R package maintainer should do that, possibly getting help from 
other volunteers e.g even on the R-devel mailing list. The CRAN team 
would only add that package name to their list of installed packages (in 
case it is not there implicitly, i.e. they possibly won't have to do 
anything).

So first, I would should check for existing distribution packages. Most 
distributions have their own indexing/search support, but you can also 
look online as follows.

For Linux distributions, there is e.g. pkgs.org for the first quick 
search (libsml-devel, libsbml-dev might be what you are looking for).

For Windows, msys2 packages are here 
https://github.com/msys2/MINGW-packages/, rtools packages are here 
https://github.com/r-windows/rtools-packages (so there is 
mingw-w64-libsbml). MXE packages are here 
https://github.com/mxe/mxe/tree/master/src and the customized version 
for R is here 
https://svn.r-project.org/R-dev-web/trunk/WindowsBuilds/winutf8/ucrt3/toolchain_libs/mxe/src/ 
(so upstream MXE doesn't have sbml, but the customized has libsbml).

For macOS, recipes for R are here 
https://github.com/R-macos/recipes/tree/master/recipes and it does not 
have sbml library as far as I can see.

So, if you wanted your package to use sbml, the best way would be to 
test it with the sbml package from all the distributions mentioned above 
(from Linux, at least the ones used by CRAN - Debian/Ubuntu, Fedora). 
Then, you would create a recipe (distribution package) for macOS, test 
it with your package, and contribute to the "recipes" above. When 
creating the recipe, look at other recipes to get the form, and look at 
sbml in the previously mentioned distributions to see how to 
download/build it (in addition to the online manual you mentioned).

Once that is in, you could submit your package to CRAN, following the 
usual checks you do when submitting packages. And then, in case it 
failed on some of the CRAN machines, you could contact the individual 
maintainer and ask for installing that distribution package of the given 
name. In some cases it won't be necessary (the machines would already 
have the package, they may be installing all available packages 
automatically).

This may sound like a bit of work, but that is the price for adding 
dependencies on native libraries, and someone has to do this work. 
Installing libraries manually on the check machines is not going to 
scale and may be too much burden for many end users, apart from 
difficulties with repeatability, maintenance, etc.

Best
Tomas

>
> Thanks again for your help.
> Satya
>
> On Thu, May 13, 2021 at 2:28 AM Tomas Kalibera 
> <tomas.kalibera at gmail.com <mailto:tomas.kalibera at gmail.com>> wrote:
>
>
>     On 5/13/21 7:06 AM, SN248 wrote:
>     > I am working on a package which provides an interface to the
>     libsbml C++
>     > library (http://sbml.org/Software/libSBML
>     <http://sbml.org/Software/libSBML>) in R. The source code of this
>     > package (r2sbml) can be found at the following link
>     >
>     > https://github.com/sn248/r2sbml <https://github.com/sn248/r2sbml>
>     >
>     > The package passes CRAN checks with `R CMD check` on my machine,
>     but I do
>     > have dependency (libsbml library) installed on my machine (OSX) with
>     > headers and static libs at the usual locations, i.e.,
>     /usr/local/include
>     > and /usr/local/lib. The package also passes CRAN check on a
>     Windows machine
>     > with libsbml installed using Rtools40 and msys2. The DESCRIPTION
>     file lists
>     > libsbml in SystemRequirements but `R CMD check` obviously fails
>     on rhub
>     > machines because there are no instructions to install libsbml
>     first. As I
>     > understand, I have the following options to pass checks on CRAN
>     >
>     > 1. Bundle the source code of libsbml into the package and make
>     the static
>     > libs on the fly. I don't really want to try this approach even
>     though I
>     > have used this approach before in another package as I think
>     creating the
>     > static lib is not as straightforward for this library because of
>     the large
>     > number of files and complex dependency chart.
>     >
>     > 2. Include header files in the `inst` folder and pull the static
>     libs from
>     > rwinlib github (assuming the libs can be posted there). I am not
>     sure if
>     > this approach will work on all platforms on which CRAN checks
>     take place.
>     >
>     > 3. Somehow include instructions to install libsbml on CRAN
>     machines (I have
>     > no idea how to do this), or request CRAN maintainers to install
>     libsbml
>     > with header files and libs at usual locations (i.e.,
>     /usr/local/include and
>     > /usr/local/lib).
>     >
>     > I am sure some version of this question has been asked before as
>     there are
>     > many packages which interface with C/C++ libraries listed as
>     > SystemRequirements, but I could not find a clear answer to this
>     aspect,
>     > i.e., passing checks on CRAN machines.
>     >
>     > Any guidance here and pros/cons of the above mentioned
>     approaches will be
>     > very helpful.
>
>     I think the best way for maintenance and end users is when the
>     libraries
>     are part of common software distributions R is used with on each
>     platforms, which are also installed on CRAN machines. For Linux these
>     are popular distributions including Debian, Ubuntu, Fedora. For
>     Windows
>     this is customized msys2 (rtools) and customized mxe. For macOS
>     this is
>     a custom distribution ("recipes").
>
>     So, if your library is already present in those distributions, but
>     not
>     installed on some of the CRAN machines, I'd simply ask for it to be
>     installed - the installation is trivial in that case, this is what
>     the
>     distributions are for.
>
>     If the library is not present in those distributions, the next best I
>     think is to contribute it to them. In case of Windows, ideally
>     contribute also to the upstream vanilla distributions, not just to
>     the
>     customized versions for R. This would allow most people to benefit
>     from
>     your contribution, and the additional burden on CRAN maintainers (who
>     have to deal with many thousands of packages) would be minimized.
>
>     If all that failed, and the license allows, one can include the
>     source
>     code of the library into the package, but that creates burden on
>     users
>     as well as maintainers (of the package, but also the repository).
>     It may
>     create confusion about the configuration due to duplication between
>     packages. It creates burden for repository maintainers. It takes
>     additional time on installation (particularly some libraries heavily
>     using C++ take forever to build, and repository maintainers do
>     that very
>     often).
>
>     Downloading pre-compiled binaries (static libraries) at installation
>     time is the worst option in my view. It is non-transparent,
>     non-repeatable, and the binaries may be incompatible (e.g. on Windows
>     all object files have to be built for the same C runtime). It makes
>     maintenance of R much harder, currently the transition from MSVCRT to
>     UCRT on Windows.
>
>     Best
>     Tomas
>
>     >
>     > Thanks
>     > Satya
>     >
>     >? ? ? ?[[alternative HTML version deleted]]
>     >
>     > ______________________________________________
>     > R-package-devel at r-project.org
>     <mailto:R-package-devel at r-project.org> mailing list
>     > https://stat.ethz.ch/mailman/listinfo/r-package-devel
>     <https://stat.ethz.ch/mailman/listinfo/r-package-devel>
>

	[[alternative HTML version deleted]]


From d@v|d@corte@@r|ver@ @end|ng |rom gm@||@com  Sun May 16 00:09:05 2021
From: d@v|d@corte@@r|ver@ @end|ng |rom gm@||@com (David Cortes)
Date: Sat, 15 May 2021 18:09:05 -0400
Subject: [R-pkg-devel] Package not building for i386 after adding
 configure.win
Message-ID: <13e06e4ac6e0a369c7fa6049b1aca4fe3d63dddf.camel@gmail.com>

I recently tried adding a configure.win file to a package
(https://github.com/david-cortes/MatrixExtra/blob/master/configure.win)
. This file calls the Rscript executable in order to extract
information about the R build and prepare a Makevars.win file:

------
HAS_LD=`${R_HOME}/bin${R_ARCH_BIN}/Rscript.exe -e
"cat(unname(as.integer(capabilities('long.double'))))"`
sed -e \
    "s/@HAS_LD@/$HAS_LD/" \
    < src/Makevars.win.in > src/Makevars.win
------

The configure script works correctly on my setup and does not produce
any errors when checking the package locally, nor when checking it in
r-hub, but when I upload it to Winbuilder or to CRAN, it will fail to
install for i386, with the following message:

------
** checking whether the package can be loaded ... ERROR
Loading this package had a fatal error status code 1
Loading log:
Error: package 'MatrixExtra' is not installed for 'arch = i386'
Execution halted
------

The file '00install.out' does not seem to show traces of having
compiled the package for i386, only for x64:
https://win-builder.r-project.org/P7PlL54vlGah/00install.out

Removing the configure.win file and modifying Makevars accordingly will
make it work correctly in Winbuilder.

What step am I missing?


From vn|j@ @end|ng |rom uc@d@edu  Sun May 16 08:16:06 2021
From: vn|j@ @end|ng |rom uc@d@edu (Vincent Nijs)
Date: Sat, 15 May 2021 23:16:06 -0700
Subject: [R-pkg-devel] InvalidUrlException for fontawesome icons in
 Rmarkdown vignette
Message-ID: <CAHu4znAz1fvgVqPNkgzO=jAdzQUwNWBfAQGJc07LSWsSxNTZpA@mail.gmail.com>

Hi,

I submitted a minor update to a package and ran into the vignette
warning/error shown. FYI the package change had nothing to do with the
vignette.

Flavor: r-devel-windows-ix86+x86_64
Check: re-building of vignette outputs, Result: WARNING
  Error(s) in re-building vignettes:
  --- re-building 'programming.Rmd' using rmarkdown
  pandoc.exe: Could not fetch
https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css
<https://urldefense.com/v3/__https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css__;!!Mih3wA!QDKkOEM4b68jQTdP9_B69YPFnkWW3hUKU0TnKHzueExJp5xLhyR22STQL1kQ0BZLBY0$>
  InvalidUrlException "
https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css
<https://urldefense.com/v3/__https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css__;!!Mih3wA!QDKkOEM4b68jQTdP9_B69YPFnkWW3hUKU0TnKHzueExJp5xLhyR22STQL1kQ0BZLBY0$>"
"URL must be absolute"
  Error: processing vignette 'programming.Rmd' failed with diagnostics:
  pandoc document conversion failed with error 67
  --- failed re-building 'programming.Rmd'

I have used the Rmarkdown header below for this package for a number of
years and it has never caused an issue. The URL is absolute and links
properly. The vignette also builds fine locally.

I'm stuck and hope you can shed some light on this problem.

Thanks,

Vincent

---
title: Programming with Radiant
author: "Vincent R. Nijs, Rady School of Management (UCSD)"
date: "`r Sys.Date()`"
output:
  rmarkdown::html_vignette:
    css:
https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css
vignette: >
  %\VignetteIndexEntry{Programming with Radiant}
  %\VignetteEngine{knitr::rmarkdown}
  \usepackage[utf8]{inputenc}
---

	[[alternative HTML version deleted]]


From kev|nu@hey @end|ng |rom gm@||@com  Mon May 17 01:47:02 2021
From: kev|nu@hey @end|ng |rom gm@||@com (Kevin Ushey)
Date: Sun, 16 May 2021 16:47:02 -0700
Subject: [R-pkg-devel] Package not building for i386 after adding
 configure.win
In-Reply-To: <13e06e4ac6e0a369c7fa6049b1aca4fe3d63dddf.camel@gmail.com>
References: <13e06e4ac6e0a369c7fa6049b1aca4fe3d63dddf.camel@gmail.com>
Message-ID: <CAJXgQP1dR91AzNLiqRSarZKF4WKRhCgduCon_sgOAGDeKP8Zyw@mail.gmail.com>

Based on this output:

** libs
Warning: this package has a non-empty 'configure.win' file,
so building only the main architecture

Does adding Biarch: TRUE to your package DESCRIPTION file help?

Best,
Kevin

On Sun, May 16, 2021 at 2:47 PM David Cortes
<david.cortes.rivera at gmail.com> wrote:
>
> I recently tried adding a configure.win file to a package
> (https://github.com/david-cortes/MatrixExtra/blob/master/configure.win)
> . This file calls the Rscript executable in order to extract
> information about the R build and prepare a Makevars.win file:
>
> ------
> HAS_LD=`${R_HOME}/bin${R_ARCH_BIN}/Rscript.exe -e
> "cat(unname(as.integer(capabilities('long.double'))))"`
> sed -e \
>     "s/@HAS_LD@/$HAS_LD/" \
>     < src/Makevars.win.in > src/Makevars.win
> ------
>
> The configure script works correctly on my setup and does not produce
> any errors when checking the package locally, nor when checking it in
> r-hub, but when I upload it to Winbuilder or to CRAN, it will fail to
> install for i386, with the following message:
>
> ------
> ** checking whether the package can be loaded ... ERROR
> Loading this package had a fatal error status code 1
> Loading log:
> Error: package 'MatrixExtra' is not installed for 'arch = i386'
> Execution halted
> ------
>
> The file '00install.out' does not seem to show traces of having
> compiled the package for i386, only for x64:
> https://win-builder.r-project.org/P7PlL54vlGah/00install.out
>
> Removing the configure.win file and modifying Makevars accordingly will
> make it work correctly in Winbuilder.
>
> What step am I missing?
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From d@v|d@corte@@r|ver@ @end|ng |rom gm@||@com  Mon May 17 03:32:41 2021
From: d@v|d@corte@@r|ver@ @end|ng |rom gm@||@com (David Cortes)
Date: Sun, 16 May 2021 21:32:41 -0400
Subject: [R-pkg-devel] Package not building for i386 after adding
 configure.win
In-Reply-To: <CAJXgQP1dR91AzNLiqRSarZKF4WKRhCgduCon_sgOAGDeKP8Zyw@mail.gmail.com>
References: <13e06e4ac6e0a369c7fa6049b1aca4fe3d63dddf.camel@gmail.com>
 <CAJXgQP1dR91AzNLiqRSarZKF4WKRhCgduCon_sgOAGDeKP8Zyw@mail.gmail.com>
Message-ID: <57f3de6b43bf6dcac9b205b41e5d72d0652b3f7d.camel@gmail.com>

That solves it, thank you!

Best regards,
David Cortes
On Sun, 2021-05-16 at 16:47 -0700, Kevin Ushey wrote:
> Based on this output:
> 
> ** libs
> Warning: this package has a non-empty 'configure.win' file,
> so building only the main architecture
> 
> Does adding Biarch: TRUE to your package DESCRIPTION file help?
> 
> Best,
> Kevin
> 
> On Sun, May 16, 2021 at 2:47 PM David Cortes
> <david.cortes.rivera at gmail.com> wrote:
> > 
> > I recently tried adding a configure.win file to a package
> > (https://github.com/david-cortes/MatrixExtra/blob/master/configure.win
> > )
> > . This file calls the Rscript executable in order to extract
> > information about the R build and prepare a Makevars.win file:
> > 
> > ------
> > HAS_LD=`${R_HOME}/bin${R_ARCH_BIN}/Rscript.exe -e
> > "cat(unname(as.integer(capabilities('long.double'))))"`
> > sed -e \
> > ??? "s/@HAS_LD@/$HAS_LD/" \
> > ??? < src/Makevars.win.in > src/Makevars.win
> > ------
> > 
> > The configure script works correctly on my setup and does not
> > produce
> > any errors when checking the package locally, nor when checking it
> > in
> > r-hub, but when I upload it to Winbuilder or to CRAN, it will fail
> > to
> > install for i386, with the following message:
> > 
> > ------
> > ** checking whether the package can be loaded ... ERROR
> > Loading this package had a fatal error status code 1
> > Loading log:
> > Error: package 'MatrixExtra' is not installed for 'arch = i386'
> > Execution halted
> > ------
> > 
> > The file '00install.out' does not seem to show traces of having
> > compiled the package for i386, only for x64:
> > https://win-builder.r-project.org/P7PlL54vlGah/00install.out
> > 
> > Removing the configure.win file and modifying Makevars accordingly
> > will
> > make it work correctly in Winbuilder.
> > 
> > What step am I missing?
> > 
> > ______________________________________________
> > R-package-devel at r-project.org?mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-package-devel


From he|mut@@chuetz @end|ng |rom beb@c@@t  Mon May 17 11:35:14 2021
From: he|mut@@chuetz @end|ng |rom beb@c@@t (=?UTF-8?Q?Helmut_Sch=c3=bctz?=)
Date: Mon, 17 May 2021 11:35:14 +0200
Subject: [R-pkg-devel] Transient (?) error on r-devel-windows-ix86+x86_64
Message-ID: <4bddb9ee-727b-0007-4e7d-f747bcd1c1df@bebac.at>

Dear all,

I'm facing an error: 
https://cran.r-project.org/web/checks/check_results_replicateBE.html

As usual the link on the bottom of
https://www.r-project.org/nosvn/R.check/r-devel-windows-ix86+x86_64/replicateBE-00check.html
is not helpful because it leads to an empty page.

No errors/warnings were thrown in the pre-check on winbuilder.
If I try it again, I get - as expected - a warning "Insufficient package 
version (submitted: 1.0.17, existing: 1.0.17)" but again no error.

Are these different machines / installations? Is this error transient or 
- if not - what can I do?

Best regards,
Helmut

-- 
Ing. Helmut Sch?tz
BEBAC?? Consultancy Services for
Bioequivalence and Bioavailability Studies
Neubaugasse 36/11
1070 Vienna, Austria
W https://bebac.at/
F https://forum.bebac.at/


From murdoch@dunc@n @end|ng |rom gm@||@com  Mon May 17 13:17:05 2021
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Mon, 17 May 2021 07:17:05 -0400
Subject: [R-pkg-devel] 
 Transient (?) error on r-devel-windows-ix86+x86_64
In-Reply-To: <4bddb9ee-727b-0007-4e7d-f747bcd1c1df@bebac.at>
References: <4bddb9ee-727b-0007-4e7d-f747bcd1c1df@bebac.at>
Message-ID: <62dd870c-d07f-03cf-168d-555d8be50efd@gmail.com>

On 17/05/2021 5:35 a.m., Helmut Sch?tz wrote:
> Dear all,
> 
> I'm facing an error:
> https://cran.r-project.org/web/checks/check_results_replicateBE.html
> 
> As usual the link on the bottom of
> https://www.r-project.org/nosvn/R.check/r-devel-windows-ix86+x86_64/replicateBE-00check.html
> is not helpful because it leads to an empty page.
> 
> No errors/warnings were thrown in the pre-check on winbuilder.
> If I try it again, I get - as expected - a warning "Insufficient package
> version (submitted: 1.0.17, existing: 1.0.17)" but again no error.
> 
> Are these different machines / installations? Is this error transient or
> - if not - what can I do?

I don't see an empty page, I see an explanation for the problem:

Error in loadNamespace(j <- i[[1L]], c(lib.loc, .libPaths()), 
versionCheck = vI[[j]]) :
   there is no package called 'lme4'
Calls: <Anonymous> ... loadNamespace -> withRestarts -> withOneRestart 
-> doWithOneRestart
Execution halted
ERROR: lazy loading failed for package 'replicateBE'

If you look at the lme4 page, you'll see it succeeded, so this was 
probably a transient error while it was being rebuilt.

If you see nothing "as usual", there may be a problem at your end 
stopping you from downloading the info.

Duncan Murdoch


From he|mut@@chuetz @end|ng |rom beb@c@@t  Mon May 17 13:23:16 2021
From: he|mut@@chuetz @end|ng |rom beb@c@@t (=?UTF-8?Q?Helmut_Sch=c3=bctz?=)
Date: Mon, 17 May 2021 13:23:16 +0200
Subject: [R-pkg-devel] 
 Transient (?) error on r-devel-windows-ix86+x86_64
In-Reply-To: <62dd870c-d07f-03cf-168d-555d8be50efd@gmail.com>
References: <4bddb9ee-727b-0007-4e7d-f747bcd1c1df@bebac.at>
 <62dd870c-d07f-03cf-168d-555d8be50efd@gmail.com>
Message-ID: <d3e7cfee-dd7c-7de9-7a09-2e81afad6452@bebac.at>

Dear Duncan,

Duncan Murdoch wrote on 2021-05-17 13:17:
> On 17/05/2021 5:35 a.m., Helmut Sch?tz wrote:
>> Dear all,
>>
>> I'm facing an error:
>> https://cran.r-project.org/web/checks/check_results_replicateBE.html
>>
>> As usual the link on the bottom of
>> https://www.r-project.org/nosvn/R.check/r-devel-windows-ix86+x86_64/replicateBE-00check.html 
>>
>> is not helpful because it leads to an empty page.
>>
>> No errors/warnings were thrown in the pre-check on winbuilder.
>> If I try it again, I get - as expected - a warning "Insufficient package
>> version (submitted: 1.0.17, existing: 1.0.17)" but again no error.
>>
>> Are these different machines / installations? Is this error transient or
>> - if not - what can I do?
>
> I don't see an empty page, I see an explanation for the problem:
>
> Error in loadNamespace(j <- i[[1L]], c(lib.loc, .libPaths()), 
> versionCheck = vI[[j]]) :
> ? there is no package called 'lme4'
> Calls: <Anonymous> ... loadNamespace -> withRestarts -> withOneRestart 
> -> doWithOneRestart
> Execution halted
> ERROR: lazy loading failed for package 'replicateBE'
>
> If you look at the lme4 page, you'll see it succeeded, so this was 
> probably a transient error while it was being rebuilt.

I see. I'm not importing lme4 _directly_ - it is a dependency of lmerTest.

> If you see nothing "as usual", there may be a problem at your end 
> stopping you from downloading the info.

Oh dear, Chrome was over-cautious...

Helmut

-- 
Ing. Helmut Sch?tz
BEBAC?? Consultancy Services for
Bioequivalence and Bioavailability Studies
Neubaugasse 36/11
1070 Vienna, Austria
W https://bebac.at/
F https://forum.bebac.at/


From d@n|e|d@@joberg @end|ng |rom gm@||@com  Mon May 17 14:34:19 2021
From: d@n|e|d@@joberg @end|ng |rom gm@||@com (Daniel Sjoberg)
Date: Mon, 17 May 2021 08:34:19 -0400
Subject: [R-pkg-devel] Package required and available but unsuitable
 version: 'gt'
Message-ID: <CAG5xu54Xi7vdVViVzV-CPOiSQTbZapnewMCv5a_fDXcKT=xmyA@mail.gmail.com>

Hello,

I maintain a package that depends on the gt package. Last week, the gt
package released a new version, v0.3.0; all the Windows binaries for the
new version have been built and are available (and they have been available
for quite a few days now)
https://cran.r-project.org/web/packages/gt/index.html .

I am trying to make a release that depends on gt v0.3.0, but I get an error
when I test the package on Windows Dev `devtools::check_win_devel()` that
the gt package is available but it's an unsuitable version.  Does anyone
know why the gt v0.3.0 is unavailable?

Here are the Win Dev check results, and link to the package GitHub repo.
https://win-builder.r-project.org/awcX6m6yvo7o/
https://github.com/ddsjoberg/gtsummary

Thank you so much,
Daniel

	[[alternative HTML version deleted]]


From ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de  Mon May 17 15:06:54 2021
From: ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de (Uwe Ligges)
Date: Mon, 17 May 2021 15:06:54 +0200
Subject: [R-pkg-devel] Package required and available but unsuitable
 version: 'gt'
In-Reply-To: <CAG5xu54Xi7vdVViVzV-CPOiSQTbZapnewMCv5a_fDXcKT=xmyA@mail.gmail.com>
References: <CAG5xu54Xi7vdVViVzV-CPOiSQTbZapnewMCv5a_fDXcKT=xmyA@mail.gmail.com>
Message-ID: <27c67cb2-77f3-c43c-a318-3e2f9ee8a3f5@statistik.tu-dortmund.de>

Pls try again, it shoudl work.
Best,
Uwe Ligges

On 17.05.2021 14:34, Daniel Sjoberg wrote:
> Hello,
> 
> I maintain a package that depends on the gt package. Last week, the gt
> package released a new version, v0.3.0; all the Windows binaries for the
> new version have been built and are available (and they have been available
> for quite a few days now)
> https://cran.r-project.org/web/packages/gt/index.html .
> 
> I am trying to make a release that depends on gt v0.3.0, but I get an error
> when I test the package on Windows Dev `devtools::check_win_devel()` that
> the gt package is available but it's an unsuitable version.  Does anyone
> know why the gt v0.3.0 is unavailable?
> 
> Here are the Win Dev check results, and link to the package GitHub repo.
> https://win-builder.r-project.org/awcX6m6yvo7o/
> https://github.com/ddsjoberg/gtsummary
> 
> Thank you so much,
> Daniel
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


From ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de  Mon May 17 15:10:31 2021
From: ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de (Uwe Ligges)
Date: Mon, 17 May 2021 15:10:31 +0200
Subject: [R-pkg-devel] InvalidUrlException for fontawesome icons in
 Rmarkdown vignette
In-Reply-To: <CAHu4znAz1fvgVqPNkgzO=jAdzQUwNWBfAQGJc07LSWsSxNTZpA@mail.gmail.com>
References: <CAHu4znAz1fvgVqPNkgzO=jAdzQUwNWBfAQGJc07LSWsSxNTZpA@mail.gmail.com>
Message-ID: <71c22540-bc5a-6eab-ae63-1ac9cadf841c@statistik.tu-dortmund.de>

Perhaps simply ask the CRAN crew to run the checks again, but as you do 
not say which package this is about etc, we can hardly help.

Best,
Uwe Ligges

On 16.05.2021 08:16, Vincent Nijs wrote:
> Hi,
> 
> I submitted a minor update to a package and ran into the vignette
> warning/error shown. FYI the package change had nothing to do with the
> vignette.
> 
> Flavor: r-devel-windows-ix86+x86_64
> Check: re-building of vignette outputs, Result: WARNING
>    Error(s) in re-building vignettes:
>    --- re-building 'programming.Rmd' using rmarkdown
>    pandoc.exe: Could not fetch
> https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css
> <https://urldefense.com/v3/__https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css__;!!Mih3wA!QDKkOEM4b68jQTdP9_B69YPFnkWW3hUKU0TnKHzueExJp5xLhyR22STQL1kQ0BZLBY0$>
>    InvalidUrlException "
> https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css
> <https://urldefense.com/v3/__https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css__;!!Mih3wA!QDKkOEM4b68jQTdP9_B69YPFnkWW3hUKU0TnKHzueExJp5xLhyR22STQL1kQ0BZLBY0$>"
> "URL must be absolute"
>    Error: processing vignette 'programming.Rmd' failed with diagnostics:
>    pandoc document conversion failed with error 67
>    --- failed re-building 'programming.Rmd'
> 
> I have used the Rmarkdown header below for this package for a number of
> years and it has never caused an issue. The URL is absolute and links
> properly. The vignette also builds fine locally.
> 
> I'm stuck and hope you can shed some light on this problem.
> 
> Thanks,
> 
> Vincent
> 
> ---
> title: Programming with Radiant
> author: "Vincent R. Nijs, Rady School of Management (UCSD)"
> date: "`r Sys.Date()`"
> output:
>    rmarkdown::html_vignette:
>      css:
> https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css
> vignette: >
>    %\VignetteIndexEntry{Programming with Radiant}
>    %\VignetteEngine{knitr::rmarkdown}
>    \usepackage[utf8]{inputenc}
> ---
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


From d@n|e|d@@joberg @end|ng |rom gm@||@com  Mon May 17 15:26:47 2021
From: d@n|e|d@@joberg @end|ng |rom gm@||@com (Daniel Sjoberg)
Date: Mon, 17 May 2021 09:26:47 -0400
Subject: [R-pkg-devel] Package required and available but unsuitable
 version: 'gt'
In-Reply-To: <27c67cb2-77f3-c43c-a318-3e2f9ee8a3f5@statistik.tu-dortmund.de>
References: <CAG5xu54Xi7vdVViVzV-CPOiSQTbZapnewMCv5a_fDXcKT=xmyA@mail.gmail.com>
 <27c67cb2-77f3-c43c-a318-3e2f9ee8a3f5@statistik.tu-dortmund.de>
Message-ID: <CAG5xu57LSppP2W9c4tPYM60WHMRRWTMR5S31RZ2W=KUCrM8yNw@mail.gmail.com>

Thank you, Uwe, for the response!

I submitted the checks again and was returned the same error that the gt
package v0.3.0 us not available. Here is the most recent check result.
https://win-builder.r-project.org/yTpN5f31KNvy/

Best,
Daniel




On Mon, May 17, 2021 at 9:06 AM Uwe Ligges <ligges at statistik.tu-dortmund.de>
wrote:

> Pls try again, it shoudl work.
> Best,
> Uwe Ligges
>
> On 17.05.2021 14:34, Daniel Sjoberg wrote:
> > Hello,
> >
> > I maintain a package that depends on the gt package. Last week, the gt
> > package released a new version, v0.3.0; all the Windows binaries for the
> > new version have been built and are available (and they have been
> available
> > for quite a few days now)
> > https://cran.r-project.org/web/packages/gt/index.html .
> >
> > I am trying to make a release that depends on gt v0.3.0, but I get an
> error
> > when I test the package on Windows Dev `devtools::check_win_devel()` that
> > the gt package is available but it's an unsuitable version.  Does anyone
> > know why the gt v0.3.0 is unavailable?
> >
> > Here are the Win Dev check results, and link to the package GitHub repo.
> > https://win-builder.r-project.org/awcX6m6yvo7o/
> > https://github.com/ddsjoberg/gtsummary
> >
> > Thank you so much,
> > Daniel
> >
> >       [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-package-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-package-devel
> >
>

	[[alternative HTML version deleted]]


From vn|j@ @end|ng |rom uc@d@edu  Tue May 18 06:40:42 2021
From: vn|j@ @end|ng |rom uc@d@edu (Vincent Nijs)
Date: Mon, 17 May 2021 21:40:42 -0700
Subject: [R-pkg-devel] InvalidUrlException for fontawesome icons in
 Rmarkdown vignette
In-Reply-To: <031e0cb75e93451bb6ff0823239144f4@BYAPR04MB5671.namprd04.prod.outlook.com>
References: <CAHu4znAz1fvgVqPNkgzO=jAdzQUwNWBfAQGJc07LSWsSxNTZpA@mail.gmail.com>
 <031e0cb75e93451bb6ff0823239144f4@BYAPR04MB5671.namprd04.prod.outlook.com>
Message-ID: <CAHu4znCRa-JMOjwBTY0yx=G-Pro9NfoC8VZj-xTpKMKmf5x_Fg@mail.gmail.com>

I see the same issue come up on rhub and the issue has also started showing
up for the previous version of the package. See results link below.

https://cran.r-project.org/web/checks/check_results_radiant.html

On Mon, May 17, 2021 at 6:10 AM Uwe Ligges <ligges at statistik.tu-dortmund.de>
wrote:

> Perhaps simply ask the CRAN crew to run the checks again, but as you do
> not say which package this is about etc, we can hardly help.
>
> Best,
> Uwe Ligges
>
> On 16.05.2021 08:16, Vincent Nijs wrote:
> > Hi,
> >
> > I submitted a minor update to a package and ran into the vignette
> > warning/error shown. FYI the package change had nothing to do with the
> > vignette.
> >
> > Flavor: r-devel-windows-ix86+x86_64
> > Check: re-building of vignette outputs, Result: WARNING
> >    Error(s) in re-building vignettes:
> >    --- re-building 'programming.Rmd' using rmarkdown
> >    pandoc.exe: Could not fetch
> >
> https://urldefense.com/v3/__https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css__;!!Mih3wA!RgyNlE6MVL47VVcjFz5JmMHpLjgnleTMV8PUzdHRhLsF840eotO4MEE4Up6Lwg$
> > <
> https://urldefense.com/v3/__https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css__;!!Mih3wA!QDKkOEM4b68jQTdP9_B69YPFnkWW3hUKU0TnKHzueExJp5xLhyR22STQL1kQ0BZLBY0$
> >
> >    InvalidUrlException "
> >
> https://urldefense.com/v3/__https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css__;!!Mih3wA!RgyNlE6MVL47VVcjFz5JmMHpLjgnleTMV8PUzdHRhLsF840eotO4MEE4Up6Lwg$
> > <
> https://urldefense.com/v3/__https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css__;!!Mih3wA!QDKkOEM4b68jQTdP9_B69YPFnkWW3hUKU0TnKHzueExJp5xLhyR22STQL1kQ0BZLBY0$
> >"
> > "URL must be absolute"
> >    Error: processing vignette 'programming.Rmd' failed with diagnostics:
> >    pandoc document conversion failed with error 67
> >    --- failed re-building 'programming.Rmd'
> >
> > I have used the Rmarkdown header below for this package for a number of
> > years and it has never caused an issue. The URL is absolute and links
> > properly. The vignette also builds fine locally.
> >
> > I'm stuck and hope you can shed some light on this problem.
> >
> > Thanks,
> >
> > Vincent
> >
> > ---
> > title: Programming with Radiant
> > author: "Vincent R. Nijs, Rady School of Management (UCSD)"
> > date: "`r Sys.Date()`"
> > output:
> >    rmarkdown::html_vignette:
> >      css:
> >
> https://urldefense.com/v3/__https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css__;!!Mih3wA!RgyNlE6MVL47VVcjFz5JmMHpLjgnleTMV8PUzdHRhLsF840eotO4MEE4Up6Lwg$
> > vignette: >
> >    %\VignetteIndexEntry{Programming with Radiant}
> >    %\VignetteEngine{knitr::rmarkdown}
> >    \usepackage[utf8]{inputenc}
> > ---
> >
> >       [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-package-devel at r-project.org mailing list
> >
> https://urldefense.com/v3/__https://stat.ethz.ch/mailman/listinfo/r-package-devel__;!!Mih3wA!RgyNlE6MVL47VVcjFz5JmMHpLjgnleTMV8PUzdHRhLsF840eotO4MEEPPgZZbg$
> >
>

	[[alternative HTML version deleted]]


From j@me@@d@|g|e|@h @end|ng |rom n|h@gov  Tue May 18 13:33:27 2021
From: j@me@@d@|g|e|@h @end|ng |rom n|h@gov (Dalgleish, James (NIH/NCI) [F])
Date: Tue, 18 May 2021 11:33:27 +0000
Subject: [R-pkg-devel] Old version of rtracklayer on a single check server
Message-ID: <DM8PR09MB6439BF93873E0CBAEB19F458EE2C9@DM8PR09MB6439.namprd09.prod.outlook.com>

To any who might have an idea:

I've been reading several posts in the digest about dependency version issues on the check servers and I'm having my own issue, which I can't solve because I can't upgrade the check server's package version:
* installing *source* package 'CNVScope' ...
** using staged installation
** R
** data
*** moving datasets to lazyload DB
** inst
** byte-compile and prepare package for lazy loading
Warning: multiple methods tables found for 'export'
Error in loadNamespace(j <- i[[1L]], c(lib.loc, .libPaths()), versionCheck = vI[[j]]) :
  namespace 'rtracklayer' 1.48.0 is already loaded, but >= 1.51.5 is required
Calls: <Anonymous> ... namespaceImportFrom -> asNamespace -> loadNamespace
Execution halted
ERROR: lazy loading failed for package 'CNVScope'
* removing 'd:/RCompile/CRANguest/R-devel/lib/CNVScope'

These errors tend to be check server dependent (only occurs on r-devel-windows-ix86+x86_64<https://cran.r-project.org/web/checks/check_flavors.html#r-devel-windows-ix86_x86_64>) and I'm just trying to make the small change to closeAllConnections() that was asked earlier of maintainers by Kurt Hornik and the CRAN team, but I can't because of this old package version on the devel check server, which has the same error:
https://win-builder.r-project.org/incoming_pretest/CNVScope_3.5.7_20210518_062953/Windows/00check.log
https://win-builder.r-project.org/incoming_pretest/CNVScope_3.5.7_20210518_062953/Windows/00install.out

Is there any way around this? I notice the maintainer of the 'gtsummary' package had a similar issue:

"> I am trying to make a release that depends on gt v0.3.0, but I get an error

> when I test the package on Windows Dev `devtools::check_win_devel()` that

> the gt package is available but it's an unsuitable version.  Does anyone

> know why the gt v0.3.0 is unavailable?"



I'm open to any suggestions, but can't see a way around this issue from my end without the ability to service the check server.


Thanks,
James Dalgleish
Cancer Genetics Branch,
Center for Cancer Research,
National Cancer Institute,
National Institutes of Health,
Bethesda, MD


	[[alternative HTML version deleted]]


From henr|k@bengt@@on @end|ng |rom gm@||@com  Tue May 18 17:49:01 2021
From: henr|k@bengt@@on @end|ng |rom gm@||@com (Henrik Bengtsson)
Date: Tue, 18 May 2021 08:49:01 -0700
Subject: [R-pkg-devel] 
 Old version of rtracklayer on a single check server
In-Reply-To: <DM8PR09MB6439BF93873E0CBAEB19F458EE2C9@DM8PR09MB6439.namprd09.prod.outlook.com>
References: <DM8PR09MB6439BF93873E0CBAEB19F458EE2C9@DM8PR09MB6439.namprd09.prod.outlook.com>
Message-ID: <CAFDcVCS4y52swZdmEMDpQNmhQ-zmZ7OWx2ppQbGc5XD_dyvm+w@mail.gmail.com>

It's a problem with Bioconductor and a broken release history of
'rtracklayer' on MS Windows (e.g.
https://bioconductor.org/packages/3.12/bioc/html/rtracklayer.html)
plus how each Bioconductor version is tied to a specific R version.
In other words, even if they fix it in Bioconductor 3.13 (for R
4.1.0), it can't be fixed in Bioconductor 3.12 (for R 4.0.0), so
you're package will keep failing on Windows for R 4.0.0.  The reason
why it can't be fixed in Bioconductor 3.12 is that they have now
frozen that release forever.

Because of this, I suspect the only solution is to make 'rtracklayer'
an optional package, i.e. move it to Suggests: and update all your
code to run conditionally of that package being available. I recommend
you reach out to the bioc-devel mailing list for advice.

/Henrik

On Tue, May 18, 2021 at 4:33 AM Dalgleish, James (NIH/NCI) [F] via
R-package-devel <r-package-devel at r-project.org> wrote:
>
> To any who might have an idea:
>
> I've been reading several posts in the digest about dependency version issues on the check servers and I'm having my own issue, which I can't solve because I can't upgrade the check server's package version:
> * installing *source* package 'CNVScope' ...
> ** using staged installation
> ** R
> ** data
> *** moving datasets to lazyload DB
> ** inst
> ** byte-compile and prepare package for lazy loading
> Warning: multiple methods tables found for 'export'
> Error in loadNamespace(j <- i[[1L]], c(lib.loc, .libPaths()), versionCheck = vI[[j]]) :
>   namespace 'rtracklayer' 1.48.0 is already loaded, but >= 1.51.5 is required
> Calls: <Anonymous> ... namespaceImportFrom -> asNamespace -> loadNamespace
> Execution halted
> ERROR: lazy loading failed for package 'CNVScope'
> * removing 'd:/RCompile/CRANguest/R-devel/lib/CNVScope'
>
> These errors tend to be check server dependent (only occurs on r-devel-windows-ix86+x86_64<https://cran.r-project.org/web/checks/check_flavors.html#r-devel-windows-ix86_x86_64>) and I'm just trying to make the small change to closeAllConnections() that was asked earlier of maintainers by Kurt Hornik and the CRAN team, but I can't because of this old package version on the devel check server, which has the same error:
> https://win-builder.r-project.org/incoming_pretest/CNVScope_3.5.7_20210518_062953/Windows/00check.log
> https://win-builder.r-project.org/incoming_pretest/CNVScope_3.5.7_20210518_062953/Windows/00install.out
>
> Is there any way around this? I notice the maintainer of the 'gtsummary' package had a similar issue:
>
> "> I am trying to make a release that depends on gt v0.3.0, but I get an error
>
> > when I test the package on Windows Dev `devtools::check_win_devel()` that
>
> > the gt package is available but it's an unsuitable version.  Does anyone
>
> > know why the gt v0.3.0 is unavailable?"
>
>
>
> I'm open to any suggestions, but can't see a way around this issue from my end without the ability to service the check server.
>
>
> Thanks,
> James Dalgleish
> Cancer Genetics Branch,
> Center for Cancer Research,
> National Cancer Institute,
> National Institutes of Health,
> Bethesda, MD
>
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From mtmorg@n@b|oc @end|ng |rom gm@||@com  Tue May 18 18:08:40 2021
From: mtmorg@n@b|oc @end|ng |rom gm@||@com (Martin Morgan)
Date: Tue, 18 May 2021 16:08:40 +0000
Subject: [R-pkg-devel] 
 Old version of rtracklayer on a single check server
In-Reply-To: <CAFDcVCS4y52swZdmEMDpQNmhQ-zmZ7OWx2ppQbGc5XD_dyvm+w@mail.gmail.com>
References: <DM8PR09MB6439BF93873E0CBAEB19F458EE2C9@DM8PR09MB6439.namprd09.prod.outlook.com>
 <CAFDcVCS4y52swZdmEMDpQNmhQ-zmZ7OWx2ppQbGc5XD_dyvm+w@mail.gmail.com>
Message-ID: <BN8PR04MB624162B1AC8C40772DD12A8FF92C9@BN8PR04MB6241.namprd04.prod.outlook.com>

That?s not correct Henrik.

CRAN follows CRAN rules for installing packages, so uses tools:::BioC_version_for_R_version(). For R-devel we have

> R.version.string
[1] "R Under development (unstable) (2021-05-18 r80323)"
> tools:::.BioC_version_associated_with_R_version()
[1] '3.13'

For this version of Bioconductor, the rtracklayer version (from https://bioconductor.org/packages/3.13/rtracklayer, or `available.packages(repos = "https://bioconductor.org/packages/3.13/bioc")["rtracklayer", "Version"]`) is 1.51.5. 

So the r-devel-windows-ix86+x86_64 builder mentioned in the post has the wrong version of rtracklayer for R-devel.

Martin Morgan

?On 5/18/21, 11:49 AM, "R-package-devel on behalf of Henrik Bengtsson" <r-package-devel-bounces at r-project.org on behalf of henrik.bengtsson at gmail.com> wrote:

    It's a problem with Bioconductor and a broken release history of
    'rtracklayer' on MS Windows (e.g.
    https://bioconductor.org/packages/3.12/bioc/html/rtracklayer.html)
    plus how each Bioconductor version is tied to a specific R version.
    In other words, even if they fix it in Bioconductor 3.13 (for R
    4.1.0), it can't be fixed in Bioconductor 3.12 (for R 4.0.0), so
    you're package will keep failing on Windows for R 4.0.0.  The reason
    why it can't be fixed in Bioconductor 3.12 is that they have now
    frozen that release forever.

    Because of this, I suspect the only solution is to make 'rtracklayer'
    an optional package, i.e. move it to Suggests: and update all your
    code to run conditionally of that package being available. I recommend
    you reach out to the bioc-devel mailing list for advice.

    /Henrik

    On Tue, May 18, 2021 at 4:33 AM Dalgleish, James (NIH/NCI) [F] via
    R-package-devel <r-package-devel at r-project.org> wrote:
    >
    > To any who might have an idea:
    >
    > I've been reading several posts in the digest about dependency version issues on the check servers and I'm having my own issue, which I can't solve because I can't upgrade the check server's package version:
    > * installing *source* package 'CNVScope' ...
    > ** using staged installation
    > ** R
    > ** data
    > *** moving datasets to lazyload DB
    > ** inst
    > ** byte-compile and prepare package for lazy loading
    > Warning: multiple methods tables found for 'export'
    > Error in loadNamespace(j <- i[[1L]], c(lib.loc, .libPaths()), versionCheck = vI[[j]]) :
    >   namespace 'rtracklayer' 1.48.0 is already loaded, but >= 1.51.5 is required
    > Calls: <Anonymous> ... namespaceImportFrom -> asNamespace -> loadNamespace
    > Execution halted
    > ERROR: lazy loading failed for package 'CNVScope'
    > * removing 'd:/RCompile/CRANguest/R-devel/lib/CNVScope'
    >
    > These errors tend to be check server dependent (only occurs on r-devel-windows-ix86+x86_64<https://cran.r-project.org/web/checks/check_flavors.html#r-devel-windows-ix86_x86_64>) and I'm just trying to make the small change to closeAllConnections() that was asked earlier of maintainers by Kurt Hornik and the CRAN team, but I can't because of this old package version on the devel check server, which has the same error:
    > https://win-builder.r-project.org/incoming_pretest/CNVScope_3.5.7_20210518_062953/Windows/00check.log
    > https://win-builder.r-project.org/incoming_pretest/CNVScope_3.5.7_20210518_062953/Windows/00install.out
    >
    > Is there any way around this? I notice the maintainer of the 'gtsummary' package had a similar issue:
    >
    > "> I am trying to make a release that depends on gt v0.3.0, but I get an error
    >
    > > when I test the package on Windows Dev `devtools::check_win_devel()` that
    >
    > > the gt package is available but it's an unsuitable version.  Does anyone
    >
    > > know why the gt v0.3.0 is unavailable?"
    >
    >
    >
    > I'm open to any suggestions, but can't see a way around this issue from my end without the ability to service the check server.
    >
    >
    > Thanks,
    > James Dalgleish
    > Cancer Genetics Branch,
    > Center for Cancer Research,
    > National Cancer Institute,
    > National Institutes of Health,
    > Bethesda, MD
    >
    >
    >         [[alternative HTML version deleted]]
    >
    > ______________________________________________
    > R-package-devel at r-project.org mailing list
    > https://stat.ethz.ch/mailman/listinfo/r-package-devel

    ______________________________________________
    R-package-devel at r-project.org mailing list
    https://stat.ethz.ch/mailman/listinfo/r-package-devel

From tdhock5 @end|ng |rom gm@||@com  Tue May 18 19:54:55 2021
From: tdhock5 @end|ng |rom gm@||@com (Toby Hocking)
Date: Tue, 18 May 2021 13:54:55 -0400
Subject: [R-pkg-devel] 
 Passing CRAN checks for a package linking to a system
 library on CRAN machines
In-Reply-To: <2f9d0f4c-654e-795b-f4f1-61ad72ec7aa4@gmail.com>
References: <CAP6q79G7KPwQisw8PubEuovhUZGijy1VT6Q91WbQ7MAQpFxmhw@mail.gmail.com>
 <dd0be7de-65f1-18a2-72bf-6835d6cc8f14@gmail.com>
 <CAP6q79HhCSr8G+B0wZD=-gMLxQWnfA6EU8dg2zazzA9UaD+iXA@mail.gmail.com>
 <2f9d0f4c-654e-795b-f4f1-61ad72ec7aa4@gmail.com>
Message-ID: <CALK03d32K9VbLhC7n=26GatJfcog1O5jw1+n+20Eyqc1bafUfQ@mail.gmail.com>

Hi Tomas, these are really helpful suggestions, which are not at all
discussed in the current Writing R Extensions, nor in CRAN Repository
Policy. Would you please consider adding this information to one of these
official sources of documentation?

On Fri, May 14, 2021 at 3:59 AM Tomas Kalibera <tomas.kalibera at gmail.com>
wrote:

>
> On 5/14/21 4:19 AM, SN248 wrote:
> > Thank you Tomas and Sokol for your suggestions.
> >
> > Based on Tomas' suggestion, it seems the best way forward would be to
> > first request CRAN maintainers to install libsbml on the CRAN
> > machines. It is quite straightforward to install the library from the
> > instructions provided online. If the installation fails on a
> > particular architecture, I should try bundling the source code and
> > creating the static libraries.
>
> Please let me clarify, I am not suggesting that you ask CRAN team to
> create the distribution packages for you, but only to install an
> existing distribution package (in case they are not doing that already).
>
> The distribution package is usually a script which automatically
> downloads the software, builds it, picks up the results, adds some
> meta-data about dependencies, and archives them in a supported format.
> Someone has to create the distribution package, and I am suggesting that
> you as R package maintainer should do that, possibly getting help from
> other volunteers e.g even on the R-devel mailing list. The CRAN team
> would only add that package name to their list of installed packages (in
> case it is not there implicitly, i.e. they possibly won't have to do
> anything).
>
> So first, I would should check for existing distribution packages. Most
> distributions have their own indexing/search support, but you can also
> look online as follows.
>
> For Linux distributions, there is e.g. pkgs.org for the first quick
> search (libsml-devel, libsbml-dev might be what you are looking for).
>
> For Windows, msys2 packages are here
> https://github.com/msys2/MINGW-packages/, rtools packages are here
> https://github.com/r-windows/rtools-packages (so there is
> mingw-w64-libsbml). MXE packages are here
> https://github.com/mxe/mxe/tree/master/src and the customized version
> for R is here
>
> https://svn.r-project.org/R-dev-web/trunk/WindowsBuilds/winutf8/ucrt3/toolchain_libs/mxe/src/
> (so upstream MXE doesn't have sbml, but the customized has libsbml).
>
> For macOS, recipes for R are here
> https://github.com/R-macos/recipes/tree/master/recipes and it does not
> have sbml library as far as I can see.
>
> So, if you wanted your package to use sbml, the best way would be to
> test it with the sbml package from all the distributions mentioned above
> (from Linux, at least the ones used by CRAN - Debian/Ubuntu, Fedora).
> Then, you would create a recipe (distribution package) for macOS, test
> it with your package, and contribute to the "recipes" above. When
> creating the recipe, look at other recipes to get the form, and look at
> sbml in the previously mentioned distributions to see how to
> download/build it (in addition to the online manual you mentioned).
>
> Once that is in, you could submit your package to CRAN, following the
> usual checks you do when submitting packages. And then, in case it
> failed on some of the CRAN machines, you could contact the individual
> maintainer and ask for installing that distribution package of the given
> name. In some cases it won't be necessary (the machines would already
> have the package, they may be installing all available packages
> automatically).
>
> This may sound like a bit of work, but that is the price for adding
> dependencies on native libraries, and someone has to do this work.
> Installing libraries manually on the check machines is not going to
> scale and may be too much burden for many end users, apart from
> difficulties with repeatability, maintenance, etc.
>
> Best
> Tomas
>
> >
> > Thanks again for your help.
> > Satya
> >
> > On Thu, May 13, 2021 at 2:28 AM Tomas Kalibera
> > <tomas.kalibera at gmail.com <mailto:tomas.kalibera at gmail.com>> wrote:
> >
> >
> >     On 5/13/21 7:06 AM, SN248 wrote:
> >     > I am working on a package which provides an interface to the
> >     libsbml C++
> >     > library (http://sbml.org/Software/libSBML
> >     <http://sbml.org/Software/libSBML>) in R. The source code of this
> >     > package (r2sbml) can be found at the following link
> >     >
> >     > https://github.com/sn248/r2sbml <https://github.com/sn248/r2sbml>
> >     >
> >     > The package passes CRAN checks with `R CMD check` on my machine,
> >     but I do
> >     > have dependency (libsbml library) installed on my machine (OSX)
> with
> >     > headers and static libs at the usual locations, i.e.,
> >     /usr/local/include
> >     > and /usr/local/lib. The package also passes CRAN check on a
> >     Windows machine
> >     > with libsbml installed using Rtools40 and msys2. The DESCRIPTION
> >     file lists
> >     > libsbml in SystemRequirements but `R CMD check` obviously fails
> >     on rhub
> >     > machines because there are no instructions to install libsbml
> >     first. As I
> >     > understand, I have the following options to pass checks on CRAN
> >     >
> >     > 1. Bundle the source code of libsbml into the package and make
> >     the static
> >     > libs on the fly. I don't really want to try this approach even
> >     though I
> >     > have used this approach before in another package as I think
> >     creating the
> >     > static lib is not as straightforward for this library because of
> >     the large
> >     > number of files and complex dependency chart.
> >     >
> >     > 2. Include header files in the `inst` folder and pull the static
> >     libs from
> >     > rwinlib github (assuming the libs can be posted there). I am not
> >     sure if
> >     > this approach will work on all platforms on which CRAN checks
> >     take place.
> >     >
> >     > 3. Somehow include instructions to install libsbml on CRAN
> >     machines (I have
> >     > no idea how to do this), or request CRAN maintainers to install
> >     libsbml
> >     > with header files and libs at usual locations (i.e.,
> >     /usr/local/include and
> >     > /usr/local/lib).
> >     >
> >     > I am sure some version of this question has been asked before as
> >     there are
> >     > many packages which interface with C/C++ libraries listed as
> >     > SystemRequirements, but I could not find a clear answer to this
> >     aspect,
> >     > i.e., passing checks on CRAN machines.
> >     >
> >     > Any guidance here and pros/cons of the above mentioned
> >     approaches will be
> >     > very helpful.
> >
> >     I think the best way for maintenance and end users is when the
> >     libraries
> >     are part of common software distributions R is used with on each
> >     platforms, which are also installed on CRAN machines. For Linux these
> >     are popular distributions including Debian, Ubuntu, Fedora. For
> >     Windows
> >     this is customized msys2 (rtools) and customized mxe. For macOS
> >     this is
> >     a custom distribution ("recipes").
> >
> >     So, if your library is already present in those distributions, but
> >     not
> >     installed on some of the CRAN machines, I'd simply ask for it to be
> >     installed - the installation is trivial in that case, this is what
> >     the
> >     distributions are for.
> >
> >     If the library is not present in those distributions, the next best I
> >     think is to contribute it to them. In case of Windows, ideally
> >     contribute also to the upstream vanilla distributions, not just to
> >     the
> >     customized versions for R. This would allow most people to benefit
> >     from
> >     your contribution, and the additional burden on CRAN maintainers (who
> >     have to deal with many thousands of packages) would be minimized.
> >
> >     If all that failed, and the license allows, one can include the
> >     source
> >     code of the library into the package, but that creates burden on
> >     users
> >     as well as maintainers (of the package, but also the repository).
> >     It may
> >     create confusion about the configuration due to duplication between
> >     packages. It creates burden for repository maintainers. It takes
> >     additional time on installation (particularly some libraries heavily
> >     using C++ take forever to build, and repository maintainers do
> >     that very
> >     often).
> >
> >     Downloading pre-compiled binaries (static libraries) at installation
> >     time is the worst option in my view. It is non-transparent,
> >     non-repeatable, and the binaries may be incompatible (e.g. on Windows
> >     all object files have to be built for the same C runtime). It makes
> >     maintenance of R much harder, currently the transition from MSVCRT to
> >     UCRT on Windows.
> >
> >     Best
> >     Tomas
> >
> >     >
> >     > Thanks
> >     > Satya
> >     >
> >     >       [[alternative HTML version deleted]]
> >     >
> >     > ______________________________________________
> >     > R-package-devel at r-project.org
> >     <mailto:R-package-devel at r-project.org> mailing list
> >     > https://stat.ethz.ch/mailman/listinfo/r-package-devel
> >     <https://stat.ethz.ch/mailman/listinfo/r-package-devel>
> >
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From henr|k@bengt@@on @end|ng |rom gm@||@com  Tue May 18 20:41:47 2021
From: henr|k@bengt@@on @end|ng |rom gm@||@com (Henrik Bengtsson)
Date: Tue, 18 May 2021 11:41:47 -0700
Subject: [R-pkg-devel] 
 Old version of rtracklayer on a single check server
In-Reply-To: <BN8PR04MB624162B1AC8C40772DD12A8FF92C9@BN8PR04MB6241.namprd04.prod.outlook.com>
References: <DM8PR09MB6439BF93873E0CBAEB19F458EE2C9@DM8PR09MB6439.namprd09.prod.outlook.com>
 <CAFDcVCS4y52swZdmEMDpQNmhQ-zmZ7OWx2ppQbGc5XD_dyvm+w@mail.gmail.com>
 <BN8PR04MB624162B1AC8C40772DD12A8FF92C9@BN8PR04MB6241.namprd04.prod.outlook.com>
Message-ID: <CAFDcVCSFBpsp0cv6smUvJYmyvoY4t8yL_oqxF_JNdJuorayB9A@mail.gmail.com>

I stand corrected about the R-devel version (and now R 4.1.0) on CRAN.

However, isn't it the case that it will never be solved for R 4.0.0 (to
become R-oldrel on CRAN) and CRAN will keep reporting an error on MS
Windows there because
https://bioconductor.org/packages/3.12/bioc/html/rtracklayer.html provides
only an older version for MS Windows?

If so, an alternative to relying on Suggests is to make the package depend
on R (>= 4.1.0).

/Henrik

On Tue, May 18, 2021, 09:08 Martin Morgan <mtmorgan.bioc at gmail.com> wrote:

> That?s not correct Henrik.
>
> CRAN follows CRAN rules for installing packages, so uses
> tools:::BioC_version_for_R_version(). For R-devel we have
>
> > R.version.string
> [1] "R Under development (unstable) (2021-05-18 r80323)"
> > tools:::.BioC_version_associated_with_R_version()
> [1] '3.13'
>
> For this version of Bioconductor, the rtracklayer version (from
> https://bioconductor.org/packages/3.13/rtracklayer, or
> `available.packages(repos = "https://bioconductor.org/packages/3.13/bioc")["rtracklayer",
> "Version"]`) is 1.51.5.
>
> So the r-devel-windows-ix86+x86_64 builder mentioned in the post has the
> wrong version of rtracklayer for R-devel.
>
> Martin Morgan
>
> ?On 5/18/21, 11:49 AM, "R-package-devel on behalf of Henrik Bengtsson" <
> r-package-devel-bounces at r-project.org on behalf of
> henrik.bengtsson at gmail.com> wrote:
>
>     It's a problem with Bioconductor and a broken release history of
>     'rtracklayer' on MS Windows (e.g.
>     https://bioconductor.org/packages/3.12/bioc/html/rtracklayer.html)
>     plus how each Bioconductor version is tied to a specific R version.
>     In other words, even if they fix it in Bioconductor 3.13 (for R
>     4.1.0), it can't be fixed in Bioconductor 3.12 (for R 4.0.0), so
>     you're package will keep failing on Windows for R 4.0.0.  The reason
>     why it can't be fixed in Bioconductor 3.12 is that they have now
>     frozen that release forever.
>
>     Because of this, I suspect the only solution is to make 'rtracklayer'
>     an optional package, i.e. move it to Suggests: and update all your
>     code to run conditionally of that package being available. I recommend
>     you reach out to the bioc-devel mailing list for advice.
>
>     /Henrik
>
>     On Tue, May 18, 2021 at 4:33 AM Dalgleish, James (NIH/NCI) [F] via
>     R-package-devel <r-package-devel at r-project.org> wrote:
>     >
>     > To any who might have an idea:
>     >
>     > I've been reading several posts in the digest about dependency
> version issues on the check servers and I'm having my own issue, which I
> can't solve because I can't upgrade the check server's package version:
>     > * installing *source* package 'CNVScope' ...
>     > ** using staged installation
>     > ** R
>     > ** data
>     > *** moving datasets to lazyload DB
>     > ** inst
>     > ** byte-compile and prepare package for lazy loading
>     > Warning: multiple methods tables found for 'export'
>     > Error in loadNamespace(j <- i[[1L]], c(lib.loc, .libPaths()),
> versionCheck = vI[[j]]) :
>     >   namespace 'rtracklayer' 1.48.0 is already loaded, but >= 1.51.5 is
> required
>     > Calls: <Anonymous> ... namespaceImportFrom -> asNamespace ->
> loadNamespace
>     > Execution halted
>     > ERROR: lazy loading failed for package 'CNVScope'
>     > * removing 'd:/RCompile/CRANguest/R-devel/lib/CNVScope'
>     >
>     > These errors tend to be check server dependent (only occurs on
> r-devel-windows-ix86+x86_64<
> https://cran.r-project.org/web/checks/check_flavors.html#r-devel-windows-ix86_x86_64>)
> and I'm just trying to make the small change to closeAllConnections() that
> was asked earlier of maintainers by Kurt Hornik and the CRAN team, but I
> can't because of this old package version on the devel check server, which
> has the same error:
>     >
> https://win-builder.r-project.org/incoming_pretest/CNVScope_3.5.7_20210518_062953/Windows/00check.log
>     >
> https://win-builder.r-project.org/incoming_pretest/CNVScope_3.5.7_20210518_062953/Windows/00install.out
>     >
>     > Is there any way around this? I notice the maintainer of the
> 'gtsummary' package had a similar issue:
>     >
>     > "> I am trying to make a release that depends on gt v0.3.0, but I
> get an error
>     >
>     > > when I test the package on Windows Dev
> `devtools::check_win_devel()` that
>     >
>     > > the gt package is available but it's an unsuitable version.  Does
> anyone
>     >
>     > > know why the gt v0.3.0 is unavailable?"
>     >
>     >
>     >
>     > I'm open to any suggestions, but can't see a way around this issue
> from my end without the ability to service the check server.
>     >
>     >
>     > Thanks,
>     > James Dalgleish
>     > Cancer Genetics Branch,
>     > Center for Cancer Research,
>     > National Cancer Institute,
>     > National Institutes of Health,
>     > Bethesda, MD
>     >
>     >
>     >         [[alternative HTML version deleted]]
>     >
>     > ______________________________________________
>     > R-package-devel at r-project.org mailing list
>     > https://stat.ethz.ch/mailman/listinfo/r-package-devel
>
>     ______________________________________________
>     R-package-devel at r-project.org mailing list
>     https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From mtmorg@n@b|oc @end|ng |rom gm@||@com  Tue May 18 21:34:07 2021
From: mtmorg@n@b|oc @end|ng |rom gm@||@com (Martin Morgan)
Date: Tue, 18 May 2021 19:34:07 +0000
Subject: [R-pkg-devel] 
 Old version of rtracklayer on a single check server
In-Reply-To: <CAFDcVCSFBpsp0cv6smUvJYmyvoY4t8yL_oqxF_JNdJuorayB9A@mail.gmail.com>
References: <DM8PR09MB6439BF93873E0CBAEB19F458EE2C9@DM8PR09MB6439.namprd09.prod.outlook.com>
 <CAFDcVCS4y52swZdmEMDpQNmhQ-zmZ7OWx2ppQbGc5XD_dyvm+w@mail.gmail.com>
 <BN8PR04MB624162B1AC8C40772DD12A8FF92C9@BN8PR04MB6241.namprd04.prod.outlook.com>
 <CAFDcVCSFBpsp0cv6smUvJYmyvoY4t8yL_oqxF_JNdJuorayB9A@mail.gmail.com>
Message-ID: <BN8PR04MB6241C2614F637EFDACE545C1F92C9@BN8PR04MB6241.namprd04.prod.outlook.com>

It is wrong to say that ?it will never be solved for R.4.0.0?. Rather, ?it will never be a problem for R.4.0.0?.

rtracklayer 1.51.5 was only ever built, checked, distributed (and installed in a correctly configured system, using the rules of install.packages and tools:::.BioC_version_associated_with_R_version(), or of BiocManager::install()) on R-devel (now R-4-1-0-branch). So R-4.0.* has never supported version 1.51.5 of rtracklayer.

No Bioconductor package built on R-4.0.* would propagate (be visible to install.packages()) with a dependency on rtracklayer-1.51.5. A CRAN package with a dependency on rtracklayer-1.51.5 (this is hypothetical, I do not believe it is the case for CNVScope), would be correctly flagged as an error ? this version of rtracklayer will never be available on R-4.0.*, and the CRAN package author would have to re-assess the reasons for specifying the dependency for that version of R.

Bioconductor does rarely produce ?impossible? dependencies particularly in the Bioconductor ?devel? branch (when a package builds and checks even though one of its dependencies builds but does not pass check), but these are transient and an artifact of the Bioconductor  build system ? the lagging package Is usually promptly updated so the published dependency is satisfied.


From: Henrik Bengtsson <henrik.bengtsson at gmail.com>
Date: Tuesday, May 18, 2021 at 2:41 PM
To: Martin Morgan <mtmorgan.bioc at gmail.com>
Cc: "Dalgleish, James (NIH/NCI) [F]" <james.dalgleish at nih.gov>, "r-package-devel at r-project.org" <r-package-devel at r-project.org>
Subject: Re: [R-pkg-devel] Old version of rtracklayer on a single check server

I stand corrected about the R-devel version (and now R 4.1.0) on CRAN.

However, isn't it the case that it will never be solved for R 4.0.0 (to become R-oldrel on CRAN) and CRAN will keep reporting an error on MS Windows there because https://bioconductor.org/packages/3.12/bioc/html/rtracklayer.html provides only an older version for MS Windows?

If so, an alternative to relying on Suggests is to make the package depend on R (>= 4.1.0).

/Henrik

On Tue, May 18, 2021, 09:08 Martin Morgan <mtmorgan.bioc at gmail.com<mailto:mtmorgan.bioc at gmail.com>> wrote:
That?s not correct Henrik.

CRAN follows CRAN rules for installing packages, so uses tools:::BioC_version_for_R_version(). For R-devel we have

> R.version.string
[1] "R Under development (unstable) (2021-05-18 r80323)"
> tools:::.BioC_version_associated_with_R_version()
[1] '3.13'

For this version of Bioconductor, the rtracklayer version (from https://bioconductor.org/packages/3.13/rtracklayer, or `available.packages(repos = "https://bioconductor.org/packages/3.13/bioc")["rtracklayer", "Version"]`) is 1.51.5.

So the r-devel-windows-ix86+x86_64 builder mentioned in the post has the wrong version of rtracklayer for R-devel.

Martin Morgan

?On 5/18/21, 11:49 AM, "R-package-devel on behalf of Henrik Bengtsson" <r-package-devel-bounces at r-project.org<mailto:r-package-devel-bounces at r-project.org> on behalf of henrik.bengtsson at gmail.com<mailto:henrik.bengtsson at gmail.com>> wrote:

    It's a problem with Bioconductor and a broken release history of
    'rtracklayer' on MS Windows (e.g.
    https://bioconductor.org/packages/3.12/bioc/html/rtracklayer.html)
    plus how each Bioconductor version is tied to a specific R version.
    In other words, even if they fix it in Bioconductor 3.13 (for R
    4.1.0), it can't be fixed in Bioconductor 3.12 (for R 4.0.0), so
    you're package will keep failing on Windows for R 4.0.0.  The reason
    why it can't be fixed in Bioconductor 3.12 is that they have now
    frozen that release forever.

    Because of this, I suspect the only solution is to make 'rtracklayer'
    an optional package, i.e. move it to Suggests: and update all your
    code to run conditionally of that package being available. I recommend
    you reach out to the bioc-devel mailing list for advice.

    /Henrik

    On Tue, May 18, 2021 at 4:33 AM Dalgleish, James (NIH/NCI) [F] via
    R-package-devel <r-package-devel at r-project.org<mailto:r-package-devel at r-project.org>> wrote:
    >
    > To any who might have an idea:
    >
    > I've been reading several posts in the digest about dependency version issues on the check servers and I'm having my own issue, which I can't solve because I can't upgrade the check server's package version:
    > * installing *source* package 'CNVScope' ...
    > ** using staged installation
    > ** R
    > ** data
    > *** moving datasets to lazyload DB
    > ** inst
    > ** byte-compile and prepare package for lazy loading
    > Warning: multiple methods tables found for 'export'
    > Error in loadNamespace(j <- i[[1L]], c(lib.loc, .libPaths()), versionCheck = vI[[j]]) :
    >   namespace 'rtracklayer' 1.48.0 is already loaded, but >= 1.51.5 is required
    > Calls: <Anonymous> ... namespaceImportFrom -> asNamespace -> loadNamespace
    > Execution halted
    > ERROR: lazy loading failed for package 'CNVScope'
    > * removing 'd:/RCompile/CRANguest/R-devel/lib/CNVScope'
    >
    > These errors tend to be check server dependent (only occurs on r-devel-windows-ix86+x86_64<https://cran.r-project.org/web/checks/check_flavors.html#r-devel-windows-ix86_x86_64>) and I'm just trying to make the small change to closeAllConnections() that was asked earlier of maintainers by Kurt Hornik and the CRAN team, but I can't because of this old package version on the devel check server, which has the same error:
    > https://win-builder.r-project.org/incoming_pretest/CNVScope_3.5.7_20210518_062953/Windows/00check.log
    > https://win-builder.r-project.org/incoming_pretest/CNVScope_3.5.7_20210518_062953/Windows/00install.out
    >
    > Is there any way around this? I notice the maintainer of the 'gtsummary' package had a similar issue:
    >
    > "> I am trying to make a release that depends on gt v0.3.0, but I get an error
    >
    > > when I test the package on Windows Dev `devtools::check_win_devel()` that
    >
    > > the gt package is available but it's an unsuitable version.  Does anyone
    >
    > > know why the gt v0.3.0 is unavailable?"
    >
    >
    >
    > I'm open to any suggestions, but can't see a way around this issue from my end without the ability to service the check server.
    >
    >
    > Thanks,
    > James Dalgleish
    > Cancer Genetics Branch,
    > Center for Cancer Research,
    > National Cancer Institute,
    > National Institutes of Health,
    > Bethesda, MD
    >
    >
    >         [[alternative HTML version deleted]]
    >
    > ______________________________________________
    > R-package-devel at r-project.org<mailto:R-package-devel at r-project.org> mailing list
    > https://stat.ethz.ch/mailman/listinfo/r-package-devel

    ______________________________________________
    R-package-devel at r-project.org<mailto:R-package-devel at r-project.org> mailing list
    https://stat.ethz.ch/mailman/listinfo/r-package-devel

	[[alternative HTML version deleted]]


From vn|j@ @end|ng |rom uc@d@edu  Wed May 19 20:49:00 2021
From: vn|j@ @end|ng |rom uc@d@edu (Vincent Nijs)
Date: Wed, 19 May 2021 11:49:00 -0700
Subject: [R-pkg-devel] InvalidUrlException for fontawesome icons in
 Rmarkdown vignette
In-Reply-To: <CAHu4znCRa-JMOjwBTY0yx=G-Pro9NfoC8VZj-xTpKMKmf5x_Fg@mail.gmail.com>
References: <CAHu4znAz1fvgVqPNkgzO=jAdzQUwNWBfAQGJc07LSWsSxNTZpA@mail.gmail.com>
 <031e0cb75e93451bb6ff0823239144f4@BYAPR04MB5671.namprd04.prod.outlook.com>
 <CAHu4znCRa-JMOjwBTY0yx=G-Pro9NfoC8VZj-xTpKMKmf5x_Fg@mail.gmail.com>
Message-ID: <CAHu4znA48mbOVPHG-4FtDmN0BsHOP85Gsxkdy0+UCte4uNAzsw@mail.gmail.com>

Is it possible this is a windows build issue? Based on the below, it seems
the InvalidUrlException only affects windows checks. These problems were
not present when radiant version 1.3.2 was submitted, else it wouldn't have
gotten on CRAN in the first place.

https://cran.r-project.org/web/checks/check_results_radiant.html

Version: 1.3.2
Check: re-building of vignette outputs
Result: WARN
    Error(s) in re-building vignettes:
    --- re-building 'programming.Rmd' using rmarkdown
    `geom_smooth()` using formula 'y ~ x'
    `geom_smooth()` using formula 'y ~ x'
    pandoc.exe: Could not fetch http:/
netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css
    InvalidUrlException "http:/
netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" "URL must
be absolute"
    Error: processing vignette 'programming.Rmd' failed with diagnostics:
    pandoc document conversion failed with error 67
    --- failed re-building 'programming.Rmd'

    SUMMARY: processing the following file failed:
     'programming.Rmd'

    Error: Vignette re-building failed.
    Execution halted
Flavors: r-devel-windows-ix86+x86_64
<https://www.r-project.org/nosvn/R.check/r-devel-windows-ix86+x86_64/radiant-00check.html>
, r-release-windows-ix86+x86_64
<https://www.r-project.org/nosvn/R.check/r-release-windows-ix86+x86_64/radiant-00check.html>
, r-oldrel-windows-ix86+x86_64
<https://www.r-project.org/nosvn/R.check/r-oldrel-windows-ix86+x86_64/radiant-00check.html>

Version: 1.3.2
Check: re-building of vignette outputs
Result: WARN
    Error(s) in re-building vignettes:
     ...
    --- re-building 'programming.Rmd' using rmarkdown
    `geom_smooth()` using formula 'y ~ x'
    `geom_smooth()` using formula 'y ~ x'
    Could not fetch http:/
netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css
    InvalidUrlException "http:/
netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" "URL must
be absolute"
    Error: processing vignette 'programming.Rmd' failed with diagnostics:
    pandoc document conversion failed with error 61
    --- failed re-building 'programming.Rmd'

    SUMMARY: processing the following file failed:
     'programming.Rmd'

    Error: Vignette re-building failed.
    Execution halted
Flavor: r-devel-windows-x86_64-gcc10-UCRT
<https://www.r-project.org/nosvn/R.check/r-devel-windows-x86_64-gcc10-UCRT/radiant-00check.html>

On Mon, May 17, 2021 at 9:40 PM Vincent Nijs <vnijs at ucsd.edu> wrote:

> I see the same issue come up on rhub and the issue has also started
> showing up for the previous version of the package. See results link below.
>
> https://cran.r-project.org/web/checks/check_results_radiant.html
>
> On Mon, May 17, 2021 at 6:10 AM Uwe Ligges <
> ligges at statistik.tu-dortmund.de> wrote:
>
>> Perhaps simply ask the CRAN crew to run the checks again, but as you do
>> not say which package this is about etc, we can hardly help.
>>
>> Best,
>> Uwe Ligges
>>
>> On 16.05.2021 08:16, Vincent Nijs wrote:
>> > Hi,
>> >
>> > I submitted a minor update to a package and ran into the vignette
>> > warning/error shown. FYI the package change had nothing to do with the
>> > vignette.
>> >
>> > Flavor: r-devel-windows-ix86+x86_64
>> > Check: re-building of vignette outputs, Result: WARNING
>> >    Error(s) in re-building vignettes:
>> >    --- re-building 'programming.Rmd' using rmarkdown
>> >    pandoc.exe: Could not fetch
>> >
>> https://urldefense.com/v3/__https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css__;!!Mih3wA!RgyNlE6MVL47VVcjFz5JmMHpLjgnleTMV8PUzdHRhLsF840eotO4MEE4Up6Lwg$
>> > <
>> https://urldefense.com/v3/__https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css__;!!Mih3wA!QDKkOEM4b68jQTdP9_B69YPFnkWW3hUKU0TnKHzueExJp5xLhyR22STQL1kQ0BZLBY0$
>> >
>> >    InvalidUrlException "
>> >
>> https://urldefense.com/v3/__https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css__;!!Mih3wA!RgyNlE6MVL47VVcjFz5JmMHpLjgnleTMV8PUzdHRhLsF840eotO4MEE4Up6Lwg$
>> > <
>> https://urldefense.com/v3/__https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css__;!!Mih3wA!QDKkOEM4b68jQTdP9_B69YPFnkWW3hUKU0TnKHzueExJp5xLhyR22STQL1kQ0BZLBY0$
>> >"
>> > "URL must be absolute"
>> >    Error: processing vignette 'programming.Rmd' failed with diagnostics:
>> >    pandoc document conversion failed with error 67
>> >    --- failed re-building 'programming.Rmd'
>> >
>> > I have used the Rmarkdown header below for this package for a number of
>> > years and it has never caused an issue. The URL is absolute and links
>> > properly. The vignette also builds fine locally.
>> >
>> > I'm stuck and hope you can shed some light on this problem.
>> >
>> > Thanks,
>> >
>> > Vincent
>> >
>> > ---
>> > title: Programming with Radiant
>> > author: "Vincent R. Nijs, Rady School of Management (UCSD)"
>> > date: "`r Sys.Date()`"
>> > output:
>> >    rmarkdown::html_vignette:
>> >      css:
>> >
>> https://urldefense.com/v3/__https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css__;!!Mih3wA!RgyNlE6MVL47VVcjFz5JmMHpLjgnleTMV8PUzdHRhLsF840eotO4MEE4Up6Lwg$
>> > vignette: >
>> >    %\VignetteIndexEntry{Programming with Radiant}
>> >    %\VignetteEngine{knitr::rmarkdown}
>> >    \usepackage[utf8]{inputenc}
>> > ---
>> >
>> >       [[alternative HTML version deleted]]
>> >
>> > ______________________________________________
>> > R-package-devel at r-project.org mailing list
>> >
>> https://urldefense.com/v3/__https://stat.ethz.ch/mailman/listinfo/r-package-devel__;!!Mih3wA!RgyNlE6MVL47VVcjFz5JmMHpLjgnleTMV8PUzdHRhLsF840eotO4MEEPPgZZbg$
>> >
>>
>

	[[alternative HTML version deleted]]


From j@me@@d@|g|e|@h @end|ng |rom n|h@gov  Thu May 20 06:20:38 2021
From: j@me@@d@|g|e|@h @end|ng |rom n|h@gov (Dalgleish, James (NIH/NCI) [F])
Date: Thu, 20 May 2021 04:20:38 +0000
Subject: [R-pkg-devel] 
 Old version of rtracklayer on a single check server
In-Reply-To: <BN8PR04MB6241C2614F637EFDACE545C1F92C9@BN8PR04MB6241.namprd04.prod.outlook.com>
References: <DM8PR09MB6439BF93873E0CBAEB19F458EE2C9@DM8PR09MB6439.namprd09.prod.outlook.com>
 <CAFDcVCS4y52swZdmEMDpQNmhQ-zmZ7OWx2ppQbGc5XD_dyvm+w@mail.gmail.com>
 <BN8PR04MB624162B1AC8C40772DD12A8FF92C9@BN8PR04MB6241.namprd04.prod.outlook.com>
 <CAFDcVCSFBpsp0cv6smUvJYmyvoY4t8yL_oqxF_JNdJuorayB9A@mail.gmail.com>
 <BN8PR04MB6241C2614F637EFDACE545C1F92C9@BN8PR04MB6241.namprd04.prod.outlook.com>
Message-ID: <DM8PR09MB643953296082BB03878025D3EE2A9@DM8PR09MB6439.namprd09.prod.outlook.com>

Thanks to Martin and Henrik for an in-depth discussion that really helped me quite a bit.

Requiring R-4.1.0 made it CRAN compliant and stopped the installation issues on both check servers.

Considering the number of packages that use rtracklayer (it?s one of the most used packages on Bioconductor), this will help a lot of users as well.

Thanks again!

Best,
James Dalgleish
From: Martin Morgan <mtmorgan.bioc at gmail.com>
Sent: Tuesday, May 18, 2021 3:34 PM
To: Henrik Bengtsson <henrik.bengtsson at gmail.com>
Cc: Dalgleish, James (NIH/NCI) [F] <james.dalgleish at nih.gov>; r-package-devel at r-project.org
Subject: Re: [R-pkg-devel] Old version of rtracklayer on a single check server

It is wrong to say that ?it will never be solved for R.4.0.0?. Rather, ?it will never be a problem for R.4.0.0?.

rtracklayer 1.51.5 was only ever built, checked, distributed (and installed in a correctly configured system, using the rules of install.packages and tools:::.BioC_version_associated_with_R_version(), or of BiocManager::install()) on R-devel (now R-4-1-0-branch). So R-4.0.* has never supported version 1.51.5 of rtracklayer.

No Bioconductor package built on R-4.0.* would propagate (be visible to install.packages()) with a dependency on rtracklayer-1.51.5. A CRAN package with a dependency on rtracklayer-1.51.5 (this is hypothetical, I do not believe it is the case for CNVScope), would be correctly flagged as an error ? this version of rtracklayer will never be available on R-4.0.*, and the CRAN package author would have to re-assess the reasons for specifying the dependency for that version of R.

Bioconductor does rarely produce ?impossible? dependencies particularly in the Bioconductor ?devel? branch (when a package builds and checks even though one of its dependencies builds but does not pass check), but these are transient and an artifact of the Bioconductor  build system ? the lagging package Is usually promptly updated so the published dependency is satisfied.


From: Henrik Bengtsson <henrik.bengtsson at gmail.com<mailto:henrik.bengtsson at gmail.com>>
Date: Tuesday, May 18, 2021 at 2:41 PM
To: Martin Morgan <mtmorgan.bioc at gmail.com<mailto:mtmorgan.bioc at gmail.com>>
Cc: "Dalgleish, James (NIH/NCI) [F]" <james.dalgleish at nih.gov<mailto:james.dalgleish at nih.gov>>, "r-package-devel at r-project.org<mailto:r-package-devel at r-project.org>" <r-package-devel at r-project.org<mailto:r-package-devel at r-project.org>>
Subject: Re: [R-pkg-devel] Old version of rtracklayer on a single check server

I stand corrected about the R-devel version (and now R 4.1.0) on CRAN.

However, isn't it the case that it will never be solved for R 4.0.0 (to become R-oldrel on CRAN) and CRAN will keep reporting an error on MS Windows there because https://bioconductor.org/packages/3.12/bioc/html/rtracklayer.html provides only an older version for MS Windows?

If so, an alternative to relying on Suggests is to make the package depend on R (>= 4.1.0).

/Henrik

On Tue, May 18, 2021, 09:08 Martin Morgan <mtmorgan.bioc at gmail.com<mailto:mtmorgan.bioc at gmail.com>> wrote:
That?s not correct Henrik.

CRAN follows CRAN rules for installing packages, so uses tools:::BioC_version_for_R_version(). For R-devel we have

> R.version.string
[1] "R Under development (unstable) (2021-05-18 r80323)"
> tools:::.BioC_version_associated_with_R_version()
[1] '3.13'

For this version of Bioconductor, the rtracklayer version (from https://bioconductor.org/packages/3.13/rtracklayer, or `available.packages(repos = "https://bioconductor.org/packages/3.13/bioc")["rtracklayer", "Version"]`) is 1.51.5.

So the r-devel-windows-ix86+x86_64 builder mentioned in the post has the wrong version of rtracklayer for R-devel.

Martin Morgan

?On 5/18/21, 11:49 AM, "R-package-devel on behalf of Henrik Bengtsson" <r-package-devel-bounces at r-project.org<mailto:r-package-devel-bounces at r-project.org> on behalf of henrik.bengtsson at gmail.com<mailto:henrik.bengtsson at gmail.com>> wrote:

    It's a problem with Bioconductor and a broken release history of
    'rtracklayer' on MS Windows (e.g.
    https://bioconductor.org/packages/3.12/bioc/html/rtracklayer.html)
    plus how each Bioconductor version is tied to a specific R version.
    In other words, even if they fix it in Bioconductor 3.13 (for R
    4.1.0), it can't be fixed in Bioconductor 3.12 (for R 4.0.0), so
    you're package will keep failing on Windows for R 4.0.0.  The reason
    why it can't be fixed in Bioconductor 3.12 is that they have now
    frozen that release forever.

    Because of this, I suspect the only solution is to make 'rtracklayer'
    an optional package, i.e. move it to Suggests: and update all your
    code to run conditionally of that package being available. I recommend
    you reach out to the bioc-devel mailing list for advice.

    /Henrik

    On Tue, May 18, 2021 at 4:33 AM Dalgleish, James (NIH/NCI) [F] via
    R-package-devel <r-package-devel at r-project.org<mailto:r-package-devel at r-project.org>> wrote:
    >
    > To any who might have an idea:
    >
    > I've been reading several posts in the digest about dependency version issues on the check servers and I'm having my own issue, which I can't solve because I can't upgrade the check server's package version:
    > * installing *source* package 'CNVScope' ...
    > ** using staged installation
    > ** R
    > ** data
    > *** moving datasets to lazyload DB
    > ** inst
    > ** byte-compile and prepare package for lazy loading
    > Warning: multiple methods tables found for 'export'
    > Error in loadNamespace(j <- i[[1L]], c(lib.loc, .libPaths()), versionCheck = vI[[j]]) :
    >   namespace 'rtracklayer' 1.48.0 is already loaded, but >= 1.51.5 is required
    > Calls: <Anonymous> ... namespaceImportFrom -> asNamespace -> loadNamespace
    > Execution halted
    > ERROR: lazy loading failed for package 'CNVScope'
    > * removing 'd:/RCompile/CRANguest/R-devel/lib/CNVScope'
    >
    > These errors tend to be check server dependent (only occurs on r-devel-windows-ix86+x86_64<https://cran.r-project.org/web/checks/check_flavors.html#r-devel-windows-ix86_x86_64>) and I'm just trying to make the small change to closeAllConnections() that was asked earlier of maintainers by Kurt Hornik and the CRAN team, but I can't because of this old package version on the devel check server, which has the same error:
    > https://win-builder.r-project.org/incoming_pretest/CNVScope_3.5.7_20210518_062953/Windows/00check.log
    > https://win-builder.r-project.org/incoming_pretest/CNVScope_3.5.7_20210518_062953/Windows/00install.out
    >
    > Is there any way around this? I notice the maintainer of the 'gtsummary' package had a similar issue:
    >
    > "> I am trying to make a release that depends on gt v0.3.0, but I get an error
    >
    > > when I test the package on Windows Dev `devtools::check_win_devel()` that
    >
    > > the gt package is available but it's an unsuitable version.  Does anyone
    >
    > > know why the gt v0.3.0 is unavailable?"
    >
    >
    >
    > I'm open to any suggestions, but can't see a way around this issue from my end without the ability to service the check server.
    >
    >
    > Thanks,
    > James Dalgleish
    > Cancer Genetics Branch,
    > Center for Cancer Research,
    > National Cancer Institute,
    > National Institutes of Health,
    > Bethesda, MD
    >
    >
    >         [[alternative HTML version deleted]]
    >
    > ______________________________________________
    > R-package-devel at r-project.org<mailto:R-package-devel at r-project.org> mailing list
    > https://stat.ethz.ch/mailman/listinfo/r-package-devel

    ______________________________________________
    R-package-devel at r-project.org<mailto:R-package-devel at r-project.org> mailing list
    https://stat.ethz.ch/mailman/listinfo/r-package-devel

	[[alternative HTML version deleted]]


From @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org  Fri May 21 04:32:45 2021
From: @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org (Spencer Graves)
Date: Thu, 20 May 2021 21:32:45 -0500
Subject: [R-pkg-devel] autotesting on GitHub with Travis or ...?
In-Reply-To: <ca5a6f26-3571-4958-5b41-efd74894de8e@gmail.com>
References: <39bc47b9-c911-e8f6-e07d-fcf83574a041@effectivedefense.org>
 <ca5a6f26-3571-4958-5b41-efd74894de8e@gmail.com>
Message-ID: <c717c8d9-7319-b22b-7fa9-885b94b95a4c@effectivedefense.org>

Hi, Ben:


	  Thanks very much.


	  This fixed my problem.


	  For others who may be reading this later, I missed a couple of points 
when first working through 
"https://deanattali.com/blog/migrating-travis-to-github/":


* On first pass, I missed the need to "git add" and "git commit" .github".


* And when using "usethis::use_readme_rmd()", I initially missed the 
need to "knit" the file to produce the README.md.


	  Spencer Graves


On 5/13/21 7:04 PM, Ben Bolker wrote:
>  ? GitHub Actions
> 
>  ? ?usethis::use_github_action
> 
>  ? Probably start here if you are moving from Travis: 
> https://deanattali.com/blog/migrating-travis-to-github/
> 
> On 5/13/21 8:00 PM, Spencer Graves wrote:
>> Hello, All:
>>
>>
>> ?????? What are the current recommendations for automatic testing of 
>> an R package on GitHub?
>>
>>
>> ?????? Section 19.3 in the current version of "R Packages" describes 
>> "Checking after every commit with Travis".? It recommends Travis.? It 
>> says to use Travis, first "Run usethis::use_travis()".[1]
>>
>>
>> ?????? However, 'help("use_travis", package="usethis")' says it's 
>> deprecated, but I don't understand what is recommended as an alternative.
>>
>>
>> ?????? What do you suggest?
>>
>>
>> ?????? Thanks,
>> ?????? Spencer Graves
>>
>>
>> [1]
>> https://r-pkgs.org/r-cmd-check.html?q=travis#travis
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From |p@|om@re@ @end|ng |rom correo@ugr@e@  Sat May 22 12:38:12 2021
From: |p@|om@re@ @end|ng |rom correo@ugr@e@ (Francisco Palomares)
Date: Sat, 22 May 2021 12:38:12 +0200
Subject: [R-pkg-devel] Error  in methods::getMethod(name,
 eval(call$signature), where = env)
Message-ID: <c95e8f6ff25ddf6065999190761c0dc4@correo.ugr.es>

Hi,
I have this problem:

Error in methods::getMethod(name, eval(call$signature), where = env) :
   no method found for function 'predict_inputs' and signature 
DecisionTreeClassifier
Calls: suppressPackageStartupMessages ... object_from_call -> 
parser_setMethod -> <Anonymous>


Code:
#' An S4 method to predict inputs.
#' @param object DecisionTree object
#' @param ... This parameter is included for compatibility reasons.
setGeneric("predict_inputs", function(object,...)
   standardGeneric("predict_inputs") )

#' @title Predict inputs Decision Tree
#' @description Function to predict one input in Decision Tree
#' @param object DecisionTree object
#' @param inputs inputs to be predicted
#' @param type type prediction, class or prob
#' @export
setMethod(f="predict_inputs",
           signature="DecisionTreeClassifier",
           definition=function(object,inputs,type = "class")
           {
................


What is the problem?
Thanks


From @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org  Sun May 23 04:05:33 2021
From: @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org (Spencer Graves)
Date: Sat, 22 May 2021 21:05:33 -0500
Subject: [R-pkg-devel] GitHub Action failed re-building 'sos.Rnw'
Message-ID: <c081bdbd-b868-203e-5c6c-d99594368c84@effectivedefense.org>

Hello:


	  What do you suggest I do to enable GitHub Action to process "sos.Rnw" 
properly?


	  The development version of my "sos" package passes "R CMD check" on 
my Mac but fails in all four platforms under GitHub Action on


https://github.com/sbgraves237/sos


	  The error messages on macOS and Ubuntu release and devel all seems 
the same:


		    * Error: processing vignette 'sos.Rnw' failed with diagnostics: 
Running 'texi2dvi' on 'sos.tex' failed.  Messages: You don't have a 
working TeX binary (tex) installed anywhere in your PATH, and texi2dvi 
cannot proceed without one.


	  The error message under Windows seemed crudely similar but different:


		    * Error: processing vignette 'sos.Rnw' failed with diagnostics: 
pdflatex is not available


	  What do you suggest?
	  Thanks,
	  Spencer Graves


From murdoch@dunc@n @end|ng |rom gm@||@com  Sun May 23 11:43:06 2021
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Sun, 23 May 2021 05:43:06 -0400
Subject: [R-pkg-devel] GitHub Action failed re-building 'sos.Rnw'
In-Reply-To: <c081bdbd-b868-203e-5c6c-d99594368c84@effectivedefense.org>
References: <c081bdbd-b868-203e-5c6c-d99594368c84@effectivedefense.org>
Message-ID: <22dc99e0-7f15-dfc6-65ad-05aa106c3873@gmail.com>

On 22/05/2021 10:05 p.m., Spencer Graves wrote:
> Hello:
> 
> 
> 	  What do you suggest I do to enable GitHub Action to process "sos.Rnw"
> properly?
> 
> 
> 	  The development version of my "sos" package passes "R CMD check" on
> my Mac but fails in all four platforms under GitHub Action on
> 
> 
> https://github.com/sbgraves237/sos
> 
> 
> 	  The error messages on macOS and Ubuntu release and devel all seems
> the same:
> 
> 
> 		    * Error: processing vignette 'sos.Rnw' failed with diagnostics:
> Running 'texi2dvi' on 'sos.tex' failed.  Messages: You don't have a
> working TeX binary (tex) installed anywhere in your PATH, and texi2dvi
> cannot proceed without one.
> 
> 
> 	  The error message under Windows seemed crudely similar but different:
> 
> 
> 		    * Error: processing vignette 'sos.Rnw' failed with diagnostics:
> pdflatex is not available
> 
> 
> 	  What do you suggest?

The virtual machines that run Github actions have lots of tools 
installed, but apparently not LaTeX.  So you need to figure out the 
"step" to install it.  I'm not currently using Rnw with Github actions, 
but by looking at the README for https://github.com/r-lib/actions, I'm 
pretty sure all you need is to add

   - uses: r-lib/actions/setup-tinytex at v1

somewhere after

   - uses: actions/checkout at master


From @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org  Sun May 23 17:28:11 2021
From: @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org (Spencer Graves)
Date: Sun, 23 May 2021 10:28:11 -0500
Subject: [R-pkg-devel] GitHub Action failed re-building 'sos.Rnw'
In-Reply-To: <22dc99e0-7f15-dfc6-65ad-05aa106c3873@gmail.com>
References: <c081bdbd-b868-203e-5c6c-d99594368c84@effectivedefense.org>
 <22dc99e0-7f15-dfc6-65ad-05aa106c3873@gmail.com>
Message-ID: <573846fd-2b56-2ceb-3f6a-08436bf82879@effectivedefense.org>

Hi, Duncan et al.:


	  Thanks very much to Duncan for his suggestion.  I did added the line 
Duncan suggested in three slightly different places.  That fixed the 
problems with missing tex and pdflatex, but exposed two new problems:


	  On Windows and ubuntu (both release and devel) I now get:


LaTeX Error: File `tikz.sty' not found.


	  On macOS, I got a different error:


there is no package called 'ks'


	  I added "ks" to "suggests" in DESCRIPTON but still got "no package 
called 'ks'.  And I studied README in https://github.com/r-lib/actions, 
and I did some other searches without figuring out how to fix 
"`tikz.sty' not found."


	  For more details, see:


https://github.com/sbgraves237/sos


	  Suggestions?
	  Thanks,
	  Spencer


On 5/23/21 4:43 AM, Duncan Murdoch wrote:
> On 22/05/2021 10:05 p.m., Spencer Graves wrote:
>> Hello:
>>
>>
>> ????? What do you suggest I do to enable GitHub Action to process 
>> "sos.Rnw"
>> properly?
>>
>>
>> ????? The development version of my "sos" package passes "R CMD check" on
>> my Mac but fails in all four platforms under GitHub Action on
>>
>>
>> https://github.com/sbgraves237/sos
>>
>>
>> ????? The error messages on macOS and Ubuntu release and devel all seems
>> the same:
>>
>>
>> ??????????? * Error: processing vignette 'sos.Rnw' failed with 
>> diagnostics:
>> Running 'texi2dvi' on 'sos.tex' failed.? Messages: You don't have a
>> working TeX binary (tex) installed anywhere in your PATH, and texi2dvi
>> cannot proceed without one.
>>
>>
>> ????? The error message under Windows seemed crudely similar but 
>> different:
>>
>>
>> ??????????? * Error: processing vignette 'sos.Rnw' failed with 
>> diagnostics:
>> pdflatex is not available
>>
>>
>> ????? What do you suggest?
> 
> The virtual machines that run Github actions have lots of tools 
> installed, but apparently not LaTeX.? So you need to figure out the 
> "step" to install it.? I'm not currently using Rnw with Github actions, 
> but by looking at the README for https://github.com/r-lib/actions, I'm 
> pretty sure all you need is to add
> 
>  ? - uses: r-lib/actions/setup-tinytex at v1
> 
> somewhere after
> 
>  ? - uses: actions/checkout at master


From murdoch@dunc@n @end|ng |rom gm@||@com  Sun May 23 18:03:39 2021
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Sun, 23 May 2021 12:03:39 -0400
Subject: [R-pkg-devel] GitHub Action failed re-building 'sos.Rnw'
In-Reply-To: <573846fd-2b56-2ceb-3f6a-08436bf82879@effectivedefense.org>
References: <c081bdbd-b868-203e-5c6c-d99594368c84@effectivedefense.org>
 <22dc99e0-7f15-dfc6-65ad-05aa106c3873@gmail.com>
 <573846fd-2b56-2ceb-3f6a-08436bf82879@effectivedefense.org>
Message-ID: <fac57f63-30a3-493b-a4df-a876e34af17f@gmail.com>

This page

https://bookdown.org/yihui/rmarkdown-cookbook/install-latex-pkgs.html

suggests that executing this in R should fix the tikz issue:

tinytex::parse_install(
   text = "! LaTeX Error: File `tikz.sty' not found."
)

The "ks" message looks like a missing R package rather than a missing 
LaTeX package, so running install.packages("ks") would fix it.

So the only question is how to do these things in a Github action.  I 
don't know if there's a pre-made recipe for this, but this one should do it:

       - name: Install tikz.tex and ks
         run: |
           install.packages(c('tinytex', 'ks')) # Maybe tinytex is 
already there?
           tinytex::parse_install(
              text = "! LaTeX Error: File `tikz.sty' not found."
           )
         shell: Rscript {0}

Duncan Murdoch

On 23/05/2021 11:28 a.m., Spencer Graves wrote:
> Hi, Duncan et al.:
> 
> 
> 	  Thanks very much to Duncan for his suggestion.  I did added the line
> Duncan suggested in three slightly different places.  That fixed the
> problems with missing tex and pdflatex, but exposed two new problems:
> 
> 
> 	  On Windows and ubuntu (both release and devel) I now get:
> 
> 
> LaTeX Error: File `tikz.sty' not found.
> 
> 
> 	  On macOS, I got a different error:
> 
> 
> there is no package called 'ks'
> 
> 
> 	  I added "ks" to "suggests" in DESCRIPTON but still got "no package
> called 'ks'.  And I studied README in https://github.com/r-lib/actions,
> and I did some other searches without figuring out how to fix
> "`tikz.sty' not found."
> 
> 
> 	  For more details, see:
> 
> 
> https://github.com/sbgraves237/sos
> 
> 
> 	  Suggestions?
> 	  Thanks,
> 	  Spencer
> 
> 
> On 5/23/21 4:43 AM, Duncan Murdoch wrote:
>> On 22/05/2021 10:05 p.m., Spencer Graves wrote:
>>> Hello:
>>>
>>>
>>>  ????? What do you suggest I do to enable GitHub Action to process
>>> "sos.Rnw"
>>> properly?
>>>
>>>
>>>  ????? The development version of my "sos" package passes "R CMD check" on
>>> my Mac but fails in all four platforms under GitHub Action on
>>>
>>>
>>> https://github.com/sbgraves237/sos
>>>
>>>
>>>  ????? The error messages on macOS and Ubuntu release and devel all seems
>>> the same:
>>>
>>>
>>>  ??????????? * Error: processing vignette 'sos.Rnw' failed with
>>> diagnostics:
>>> Running 'texi2dvi' on 'sos.tex' failed.? Messages: You don't have a
>>> working TeX binary (tex) installed anywhere in your PATH, and texi2dvi
>>> cannot proceed without one.
>>>
>>>
>>>  ????? The error message under Windows seemed crudely similar but
>>> different:
>>>
>>>
>>>  ??????????? * Error: processing vignette 'sos.Rnw' failed with
>>> diagnostics:
>>> pdflatex is not available
>>>
>>>
>>>  ????? What do you suggest?
>>
>> The virtual machines that run Github actions have lots of tools
>> installed, but apparently not LaTeX.? So you need to figure out the
>> "step" to install it.? I'm not currently using Rnw with Github actions,
>> but by looking at the README for https://github.com/r-lib/actions, I'm
>> pretty sure all you need is to add
>>
>>   ? - uses: r-lib/actions/setup-tinytex at v1
>>
>> somewhere after
>>
>>   ? - uses: actions/checkout at master


From @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org  Sun May 23 21:09:10 2021
From: @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org (Spencer Graves)
Date: Sun, 23 May 2021 14:09:10 -0500
Subject: [R-pkg-devel] GitHub Action failed re-building 'sos.Rnw'
In-Reply-To: <fac57f63-30a3-493b-a4df-a876e34af17f@gmail.com>
References: <c081bdbd-b868-203e-5c6c-d99594368c84@effectivedefense.org>
 <22dc99e0-7f15-dfc6-65ad-05aa106c3873@gmail.com>
 <573846fd-2b56-2ceb-3f6a-08436bf82879@effectivedefense.org>
 <fac57f63-30a3-493b-a4df-a876e34af17f@gmail.com>
Message-ID: <f05eb4f3-9844-db2b-5113-d510bf01b43b@effectivedefense.org>

Hi, Duncan et al.:


	  Thanks again to Duncan.  Your suggestions worked for the LaTeX 
problem, though it required multiple iterations, adding a total of 7 
different "tinytex::parse_install" clauses to overcome other LaTeX and 
pdfTeX errors.


	  However, macOS still says, "there is no package called 'ks'", even 
though I added 'install.packages("ks")' as you suggested -- to three 
different places, all without solving the problem.  I posted this 
question to 
"https://community.rstudio.com/new-topic?category=Package%20development&tags=github-actions", 
as suggested in line 2 of "~/.github/workflows/R-CMD-check.yaml".  See:


	  Spencer


On 5/23/21 11:03 AM, Duncan Murdoch wrote:
> This page
> 
> https://bookdown.org/yihui/rmarkdown-cookbook/install-latex-pkgs.html
> 
> suggests that executing this in R should fix the tikz issue:
> 
> tinytex::parse_install(
>  ? text = "! LaTeX Error: File `tikz.sty' not found."
> )
> 
> The "ks" message looks like a missing R package rather than a missing 
> LaTeX package, so running install.packages("ks") would fix it.
> 
> So the only question is how to do these things in a Github action.? I 
> don't know if there's a pre-made recipe for this, but this one should do 
> it:
> 
>  ????? - name: Install tikz.tex and ks
>  ??????? run: |
>  ????????? install.packages(c('tinytex', 'ks')) # Maybe tinytex is 
> already there?
>  ????????? tinytex::parse_install(
>  ???????????? text = "! LaTeX Error: File `tikz.sty' not found."
>  ????????? )
>  ??????? shell: Rscript {0}
> 
> Duncan Murdoch
> 
> On 23/05/2021 11:28 a.m., Spencer Graves wrote:
>> Hi, Duncan et al.:
>>
>>
>> ????? Thanks very much to Duncan for his suggestion.? I did added the 
>> line
>> Duncan suggested in three slightly different places.? That fixed the
>> problems with missing tex and pdflatex, but exposed two new problems:
>>
>>
>> ????? On Windows and ubuntu (both release and devel) I now get:
>>
>>
>> LaTeX Error: File `tikz.sty' not found.
>>
>>
>> ????? On macOS, I got a different error:
>>
>>
>> there is no package called 'ks'
>>
>>
>> ????? I added "ks" to "suggests" in DESCRIPTON but still got "no package
>> called 'ks'.? And I studied README in https://github.com/r-lib/actions,
>> and I did some other searches without figuring out how to fix
>> "`tikz.sty' not found."
>>
>>
>> ????? For more details, see:
>>
>>
>> https://github.com/sbgraves237/sos
>>
>>
>> ????? Suggestions?
>> ????? Thanks,
>> ????? Spencer
>>
>>
>> On 5/23/21 4:43 AM, Duncan Murdoch wrote:
>>> On 22/05/2021 10:05 p.m., Spencer Graves wrote:
>>>> Hello:
>>>>
>>>>
>>>> ?????? What do you suggest I do to enable GitHub Action to process
>>>> "sos.Rnw"
>>>> properly?
>>>>
>>>>
>>>> ?????? The development version of my "sos" package passes "R CMD 
>>>> check" on
>>>> my Mac but fails in all four platforms under GitHub Action on
>>>>
>>>>
>>>> https://github.com/sbgraves237/sos
>>>>
>>>>
>>>> ?????? The error messages on macOS and Ubuntu release and devel all 
>>>> seems
>>>> the same:
>>>>
>>>>
>>>> ???????????? * Error: processing vignette 'sos.Rnw' failed with
>>>> diagnostics:
>>>> Running 'texi2dvi' on 'sos.tex' failed.? Messages: You don't have a
>>>> working TeX binary (tex) installed anywhere in your PATH, and texi2dvi
>>>> cannot proceed without one.
>>>>
>>>>
>>>> ?????? The error message under Windows seemed crudely similar but
>>>> different:
>>>>
>>>>
>>>> ???????????? * Error: processing vignette 'sos.Rnw' failed with
>>>> diagnostics:
>>>> pdflatex is not available
>>>>
>>>>
>>>> ?????? What do you suggest?
>>>
>>> The virtual machines that run Github actions have lots of tools
>>> installed, but apparently not LaTeX.? So you need to figure out the
>>> "step" to install it.? I'm not currently using Rnw with Github actions,
>>> but by looking at the README for https://github.com/r-lib/actions, I'm
>>> pretty sure all you need is to add
>>>
>>> ? ? - uses: r-lib/actions/setup-tinytex at v1
>>>
>>> somewhere after
>>>
>>> ? ? - uses: actions/checkout at master
>


From @r@v|ndj@y@r@m@n@gr| @end|ng |rom gm@||@com  Sun May 23 21:21:13 2021
From: @r@v|ndj@y@r@m@n@gr| @end|ng |rom gm@||@com (Aravind J.)
Date: Sun, 23 May 2021 21:21:13 +0200
Subject: [R-pkg-devel] Troubleshoot unknown macro '\backslashemph' warning
Message-ID: <CA+0rMg=mL0+qVDgXbEdirUvYCD_3iTdRS6BAPTmVD58Xamo1hA@mail.gmail.com>

Hi,

While checking two of my packages
(https://github.com/aravind-j/EvaluateCore and
https://github.com/aravind-j/augmentedRCBD)with winbuilder while
preparing for submitting an updated version, I am getting the
following warning.


* checking Rd files ... [4s] WARNING
prepare_Rd: <connection>:2: unknown macro '\backslashemph'
prepare_Rd: <connection>:6: unknown macro '\backslashemph'
prepare_Rd: <connection>:2: unknown macro '\backslashemph'
prepare_Rd: <connection>:4: unknown macro '\backslashemph

I am not able to find the offending macros anywhere in the Rd files being
generated. I am using two RdMacros, mathjaxr and Rdpack.

How to troubleshoot?

-- 

J.Aravind
Scientist,
Division of Germplasm Conservation,
ICAR-National Bureau of Plant Genetic Resources,
New Delhi - 110 012

	[[alternative HTML version deleted]]


From murdoch@dunc@n @end|ng |rom gm@||@com  Sun May 23 21:36:54 2021
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Sun, 23 May 2021 15:36:54 -0400
Subject: [R-pkg-devel] GitHub Action failed re-building 'sos.Rnw'
In-Reply-To: <f05eb4f3-9844-db2b-5113-d510bf01b43b@effectivedefense.org>
References: <c081bdbd-b868-203e-5c6c-d99594368c84@effectivedefense.org>
 <22dc99e0-7f15-dfc6-65ad-05aa106c3873@gmail.com>
 <573846fd-2b56-2ceb-3f6a-08436bf82879@effectivedefense.org>
 <fac57f63-30a3-493b-a4df-a876e34af17f@gmail.com>
 <f05eb4f3-9844-db2b-5113-d510bf01b43b@effectivedefense.org>
Message-ID: <9fa2cd7a-3ec6-eb88-f810-d54192afe767@gmail.com>

For ks, if you look here: 
https://github.com/sbgraves237/sos/runs/2650960959?check_suite_focus=true

in the "Install Dependencies" section, you'll see these errors:

trying URL 'https://cloud.r-project.org/src/contrib/ks_1.13.0.tar.gz'
Content type 'application/x-gzip' length 1076044 bytes (1.0 MB)
==================================================
downloaded 1.0 MB

* installing *source* package ?plot3D? ...
** package ?plot3D? successfully unpacked and MD5 sums checked
** using staged installation
** R
** data
*** moving datasets to lazyload DB
** inst
** byte-compile and prepare package for lazy loading
Error: Error: .onLoad failed in loadNamespace() for 'tcltk', details:
ERROR: lazy loading failed for package ?plot3D?
   call: fun(libname, pkgname)
* removing ?/Users/runner/work/_temp/Library/plot3D?
   error: X11 library is missing: install XQuartz from www.xquartz.org
Execution halted
ERROR: dependency ?plot3D? is not available for package ?ks?
* removing ?/Users/runner/work/_temp/Library/ks?

so the problem is really with plot3D, and indirectly with rgl and tcltk. 
I'm familiar with problems like that!  Here are the lines from the rgl 
workflow to work around the XQuartz issues:

     env:
       R_REMOTES_NO_ERRORS_FROM_WARNINGS: true
       _R_CHECK_FORCE_SUGGESTS_: false
       RSPM: ${{ matrix.config.rspm }}
       GITHUB_PAT: ${{ secrets.GITHUB_TOKEN }}
       RGL_USE_NULL: true

The last line might be enough for you, but I think the 2nd line

_R_CHECK_FORCE_SUGGESTS_: false

may be more important:  you use ks, it imports plot3D, plot3D imports 
misc3d, but it only suggests rgl and tkrplot:  so that would let ks load 
without XQuartz support.

Duncan Murdoch

On 23/05/2021 3:09 p.m., Spencer Graves wrote:
> Hi, Duncan et al.:
> 
> 
> 	  Thanks again to Duncan.  Your suggestions worked for the LaTeX
> problem, though it required multiple iterations, adding a total of 7
> different "tinytex::parse_install" clauses to overcome other LaTeX and
> pdfTeX errors.
> 
> 
> 	  However, macOS still says, "there is no package called 'ks'", even
> though I added 'install.packages("ks")' as you suggested -- to three
> different places, all without solving the problem.  I posted this
> question to
> "https://community.rstudio.com/new-topic?category=Package%20development&tags=github-actions",
> as suggested in line 2 of "~/.github/workflows/R-CMD-check.yaml".  See:
> 
> 
> 	  Spencer
> 
> 
> On 5/23/21 11:03 AM, Duncan Murdoch wrote:
>> This page
>>
>> https://bookdown.org/yihui/rmarkdown-cookbook/install-latex-pkgs.html
>>
>> suggests that executing this in R should fix the tikz issue:
>>
>> tinytex::parse_install(
>>   ? text = "! LaTeX Error: File `tikz.sty' not found."
>> )
>>
>> The "ks" message looks like a missing R package rather than a missing
>> LaTeX package, so running install.packages("ks") would fix it.
>>
>> So the only question is how to do these things in a Github action.? I
>> don't know if there's a pre-made recipe for this, but this one should do
>> it:
>>
>>   ????? - name: Install tikz.tex and ks
>>   ??????? run: |
>>   ????????? install.packages(c('tinytex', 'ks')) # Maybe tinytex is
>> already there?
>>   ????????? tinytex::parse_install(
>>   ???????????? text = "! LaTeX Error: File `tikz.sty' not found."
>>   ????????? )
>>   ??????? shell: Rscript {0}
>>
>> Duncan Murdoch
>>
>> On 23/05/2021 11:28 a.m., Spencer Graves wrote:
>>> Hi, Duncan et al.:
>>>
>>>
>>>  ????? Thanks very much to Duncan for his suggestion.? I did added the
>>> line
>>> Duncan suggested in three slightly different places.? That fixed the
>>> problems with missing tex and pdflatex, but exposed two new problems:
>>>
>>>
>>>  ????? On Windows and ubuntu (both release and devel) I now get:
>>>
>>>
>>> LaTeX Error: File `tikz.sty' not found.
>>>
>>>
>>>  ????? On macOS, I got a different error:
>>>
>>>
>>> there is no package called 'ks'
>>>
>>>
>>>  ????? I added "ks" to "suggests" in DESCRIPTON but still got "no package
>>> called 'ks'.? And I studied README in https://github.com/r-lib/actions,
>>> and I did some other searches without figuring out how to fix
>>> "`tikz.sty' not found."
>>>
>>>
>>>  ????? For more details, see:
>>>
>>>
>>> https://github.com/sbgraves237/sos
>>>
>>>
>>>  ????? Suggestions?
>>>  ????? Thanks,
>>>  ????? Spencer
>>>
>>>
>>> On 5/23/21 4:43 AM, Duncan Murdoch wrote:
>>>> On 22/05/2021 10:05 p.m., Spencer Graves wrote:
>>>>> Hello:
>>>>>
>>>>>
>>>>>  ?????? What do you suggest I do to enable GitHub Action to process
>>>>> "sos.Rnw"
>>>>> properly?
>>>>>
>>>>>
>>>>>  ?????? The development version of my "sos" package passes "R CMD
>>>>> check" on
>>>>> my Mac but fails in all four platforms under GitHub Action on
>>>>>
>>>>>
>>>>> https://github.com/sbgraves237/sos
>>>>>
>>>>>
>>>>>  ?????? The error messages on macOS and Ubuntu release and devel all
>>>>> seems
>>>>> the same:
>>>>>
>>>>>
>>>>>  ???????????? * Error: processing vignette 'sos.Rnw' failed with
>>>>> diagnostics:
>>>>> Running 'texi2dvi' on 'sos.tex' failed.? Messages: You don't have a
>>>>> working TeX binary (tex) installed anywhere in your PATH, and texi2dvi
>>>>> cannot proceed without one.
>>>>>
>>>>>
>>>>>  ?????? The error message under Windows seemed crudely similar but
>>>>> different:
>>>>>
>>>>>
>>>>>  ???????????? * Error: processing vignette 'sos.Rnw' failed with
>>>>> diagnostics:
>>>>> pdflatex is not available
>>>>>
>>>>>
>>>>>  ?????? What do you suggest?
>>>>
>>>> The virtual machines that run Github actions have lots of tools
>>>> installed, but apparently not LaTeX.? So you need to figure out the
>>>> "step" to install it.? I'm not currently using Rnw with Github actions,
>>>> but by looking at the README for https://github.com/r-lib/actions, I'm
>>>> pretty sure all you need is to add
>>>>
>>>>  ? ? - uses: r-lib/actions/setup-tinytex at v1
>>>>
>>>> somewhere after
>>>>
>>>>  ? ? - uses: actions/checkout at master
>>


From @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org  Sun May 23 23:25:55 2021
From: @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org (Spencer Graves)
Date: Sun, 23 May 2021 16:25:55 -0500
Subject: [R-pkg-devel] GitHub Action failed re-building 'sos.Rnw'
In-Reply-To: <9fa2cd7a-3ec6-eb88-f810-d54192afe767@gmail.com>
References: <c081bdbd-b868-203e-5c6c-d99594368c84@effectivedefense.org>
 <22dc99e0-7f15-dfc6-65ad-05aa106c3873@gmail.com>
 <573846fd-2b56-2ceb-3f6a-08436bf82879@effectivedefense.org>
 <fac57f63-30a3-493b-a4df-a876e34af17f@gmail.com>
 <f05eb4f3-9844-db2b-5113-d510bf01b43b@effectivedefense.org>
 <9fa2cd7a-3ec6-eb88-f810-d54192afe767@gmail.com>
Message-ID: <d3bfac9c-9c7a-2ec9-71fd-676ac0bf1335@effectivedefense.org>

Hi, Duncan et al.:


	  I inserted "the lines from the rgl workflow to work around the 
XQuartz issues" that Duncan provided after "env" in TWO places in 
R-CMD-check.yaml with the same result:  GitHub Action worked fine on 
Windows and ubuntu (both release and devel) but failed on macOS 
complaining, "there is no package called 'ks'".


	  HOWEVER, I can NOT see how I even ask for ks.  The error message says:


processing the following file failed: 'sos.Rnw'
Error: Error: Vignette re-building failed.
Execution halted
Error: Error in proc$get_built_file() : Build process failed
Calls: <Anonymous> ... build_package -> with_envvar -> force -> <Anonymous>
Execution halted
Error: Process completed with exit code 1.


	  I can NOT find it with "grep 'ks' sos.Rnw".  It's NOT in DESCRIPTION 
nor NAMESPACE.


	  I do NOT see how I am even asking for it.


	  PROPOSED NEXT STEP:  Do as outlined in 
"https://github.com/ThinkR-open/prepare-for-cran" and submit to CRAN 
with a note on this problem in cran-comments.md if the package passes 
all other tests.


	  Other suggestions?
	  Thanks again, Duncan.
	  Spencer


On 5/23/21 2:36 PM, Duncan Murdoch wrote:
> For ks, if you look here: 
> https://github.com/sbgraves237/sos/runs/2650960959?check_suite_focus=true
> 
> in the "Install Dependencies" section, you'll see these errors:
> 
> trying URL 'https://cloud.r-project.org/src/contrib/ks_1.13.0.tar.gz'
> Content type 'application/x-gzip' length 1076044 bytes (1.0 MB)
> ==================================================
> downloaded 1.0 MB
> 
> * installing *source* package ?plot3D? ...
> ** package ?plot3D? successfully unpacked and MD5 sums checked
> ** using staged installation
> ** R
> ** data
> *** moving datasets to lazyload DB
> ** inst
> ** byte-compile and prepare package for lazy loading
> Error: Error: .onLoad failed in loadNamespace() for 'tcltk', details:
> ERROR: lazy loading failed for package ?plot3D?
>  ? call: fun(libname, pkgname)
> * removing ?/Users/runner/work/_temp/Library/plot3D?
>  ? error: X11 library is missing: install XQuartz from www.xquartz.org
> Execution halted
> ERROR: dependency ?plot3D? is not available for package ?ks?
> * removing ?/Users/runner/work/_temp/Library/ks?
> 
> so the problem is really with plot3D, and indirectly with rgl and tcltk. 
> I'm familiar with problems like that!? Here are the lines from the rgl 
> workflow to work around the XQuartz issues:
> 
>  ??? env:
>  ????? R_REMOTES_NO_ERRORS_FROM_WARNINGS: true
>  ????? _R_CHECK_FORCE_SUGGESTS_: false
>  ????? RSPM: ${{ matrix.config.rspm }}
>  ????? GITHUB_PAT: ${{ secrets.GITHUB_TOKEN }}
>  ????? RGL_USE_NULL: true
> 
> The last line might be enough for you, but I think the 2nd line
> 
> _R_CHECK_FORCE_SUGGESTS_: false
> 
> may be more important:? you use ks, it imports plot3D, plot3D imports 
> misc3d, but it only suggests rgl and tkrplot:? so that would let ks load 
> without XQuartz support.
> 
> Duncan Murdoch
> 
> On 23/05/2021 3:09 p.m., Spencer Graves wrote:
>> Hi, Duncan et al.:
>>
>>
>> ????? Thanks again to Duncan.? Your suggestions worked for the LaTeX
>> problem, though it required multiple iterations, adding a total of 7
>> different "tinytex::parse_install" clauses to overcome other LaTeX and
>> pdfTeX errors.
>>
>>
>> ????? However, macOS still says, "there is no package called 'ks'", even
>> though I added 'install.packages("ks")' as you suggested -- to three
>> different places, all without solving the problem.? I posted this
>> question to
>> "https://community.rstudio.com/new-topic?category=Package%20development&tags=github-actions", 
>>
>> as suggested in line 2 of "~/.github/workflows/R-CMD-check.yaml".? See:
>>
>>
>> ????? Spencer
>>
>>
>> On 5/23/21 11:03 AM, Duncan Murdoch wrote:
>>> This page
>>>
>>> https://bookdown.org/yihui/rmarkdown-cookbook/install-latex-pkgs.html
>>>
>>> suggests that executing this in R should fix the tikz issue:
>>>
>>> tinytex::parse_install(
>>> ? ? text = "! LaTeX Error: File `tikz.sty' not found."
>>> )
>>>
>>> The "ks" message looks like a missing R package rather than a missing
>>> LaTeX package, so running install.packages("ks") would fix it.
>>>
>>> So the only question is how to do these things in a Github action.? I
>>> don't know if there's a pre-made recipe for this, but this one should do
>>> it:
>>>
>>> ? ????? - name: Install tikz.tex and ks
>>> ? ??????? run: |
>>> ? ????????? install.packages(c('tinytex', 'ks')) # Maybe tinytex is
>>> already there?
>>> ? ????????? tinytex::parse_install(
>>> ? ???????????? text = "! LaTeX Error: File `tikz.sty' not found."
>>> ? ????????? )
>>> ? ??????? shell: Rscript {0}
>>>
>>> Duncan Murdoch
>>>
>>> On 23/05/2021 11:28 a.m., Spencer Graves wrote:
>>>> Hi, Duncan et al.:
>>>>
>>>>
>>>> ?????? Thanks very much to Duncan for his suggestion.? I did added the
>>>> line
>>>> Duncan suggested in three slightly different places.? That fixed the
>>>> problems with missing tex and pdflatex, but exposed two new problems:
>>>>
>>>>
>>>> ?????? On Windows and ubuntu (both release and devel) I now get:
>>>>
>>>>
>>>> LaTeX Error: File `tikz.sty' not found.
>>>>
>>>>
>>>> ?????? On macOS, I got a different error:
>>>>
>>>>
>>>> there is no package called 'ks'
>>>>
>>>>
>>>> ?????? I added "ks" to "suggests" in DESCRIPTON but still got "no 
>>>> package
>>>> called 'ks'.? And I studied README in https://github.com/r-lib/actions,
>>>> and I did some other searches without figuring out how to fix
>>>> "`tikz.sty' not found."
>>>>
>>>>
>>>> ?????? For more details, see:
>>>>
>>>>
>>>> https://github.com/sbgraves237/sos
>>>>
>>>>
>>>> ?????? Suggestions?
>>>> ?????? Thanks,
>>>> ?????? Spencer
>>>>
>>>>
>>>> On 5/23/21 4:43 AM, Duncan Murdoch wrote:
>>>>> On 22/05/2021 10:05 p.m., Spencer Graves wrote:
>>>>>> Hello:
>>>>>>
>>>>>>
>>>>>> ??????? What do you suggest I do to enable GitHub Action to process
>>>>>> "sos.Rnw"
>>>>>> properly?
>>>>>>
>>>>>>
>>>>>> ??????? The development version of my "sos" package passes "R CMD
>>>>>> check" on
>>>>>> my Mac but fails in all four platforms under GitHub Action on
>>>>>>
>>>>>>
>>>>>> https://github.com/sbgraves237/sos
>>>>>>
>>>>>>
>>>>>> ??????? The error messages on macOS and Ubuntu release and devel all
>>>>>> seems
>>>>>> the same:
>>>>>>
>>>>>>
>>>>>> ????????????? * Error: processing vignette 'sos.Rnw' failed with
>>>>>> diagnostics:
>>>>>> Running 'texi2dvi' on 'sos.tex' failed.? Messages: You don't have a
>>>>>> working TeX binary (tex) installed anywhere in your PATH, and 
>>>>>> texi2dvi
>>>>>> cannot proceed without one.
>>>>>>
>>>>>>
>>>>>> ??????? The error message under Windows seemed crudely similar but
>>>>>> different:
>>>>>>
>>>>>>
>>>>>> ????????????? * Error: processing vignette 'sos.Rnw' failed with
>>>>>> diagnostics:
>>>>>> pdflatex is not available
>>>>>>
>>>>>>
>>>>>> ??????? What do you suggest?
>>>>>
>>>>> The virtual machines that run Github actions have lots of tools
>>>>> installed, but apparently not LaTeX.? So you need to figure out the
>>>>> "step" to install it.? I'm not currently using Rnw with Github 
>>>>> actions,
>>>>> but by looking at the README for https://github.com/r-lib/actions, I'm
>>>>> pretty sure all you need is to add
>>>>>
>>>>> ?? ? - uses: r-lib/actions/setup-tinytex at v1
>>>>>
>>>>> somewhere after
>>>>>
>>>>> ?? ? - uses: actions/checkout at master
>>>
>


From murdoch@dunc@n @end|ng |rom gm@||@com  Sun May 23 23:44:21 2021
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Sun, 23 May 2021 17:44:21 -0400
Subject: [R-pkg-devel] GitHub Action failed re-building 'sos.Rnw'
In-Reply-To: <d3bfac9c-9c7a-2ec9-71fd-676ac0bf1335@effectivedefense.org>
References: <c081bdbd-b868-203e-5c6c-d99594368c84@effectivedefense.org>
 <22dc99e0-7f15-dfc6-65ad-05aa106c3873@gmail.com>
 <573846fd-2b56-2ceb-3f6a-08436bf82879@effectivedefense.org>
 <fac57f63-30a3-493b-a4df-a876e34af17f@gmail.com>
 <f05eb4f3-9844-db2b-5113-d510bf01b43b@effectivedefense.org>
 <9fa2cd7a-3ec6-eb88-f810-d54192afe767@gmail.com>
 <d3bfac9c-9c7a-2ec9-71fd-676ac0bf1335@effectivedefense.org>
Message-ID: <347aed7a-78d0-9262-33e2-6d3175d50ba7@gmail.com>

I don't see where the connection is, but it's almost certainly coming in 
through your unconditional use of "fda::CRAN()".  Since "fda" is not a 
hard requirement, this should be conditional on having it installed.

Duncan Murdoch

On 23/05/2021 5:25 p.m., Spencer Graves wrote:
> Hi, Duncan et al.:
> 
> 
> 	  I inserted "the lines from the rgl workflow to work around the
> XQuartz issues" that Duncan provided after "env" in TWO places in
> R-CMD-check.yaml with the same result:  GitHub Action worked fine on
> Windows and ubuntu (both release and devel) but failed on macOS
> complaining, "there is no package called 'ks'".
> 
> 
> 	  HOWEVER, I can NOT see how I even ask for ks.  The error message says:
> 
> 
> processing the following file failed: 'sos.Rnw'
> Error: Error: Vignette re-building failed.
> Execution halted
> Error: Error in proc$get_built_file() : Build process failed
> Calls: <Anonymous> ... build_package -> with_envvar -> force -> <Anonymous>
> Execution halted
> Error: Process completed with exit code 1.
> 
> 
> 	  I can NOT find it with "grep 'ks' sos.Rnw".  It's NOT in DESCRIPTION
> nor NAMESPACE.
> 
> 
> 	  I do NOT see how I am even asking for it.
> 
> 
> 	  PROPOSED NEXT STEP:  Do as outlined in
> "https://github.com/ThinkR-open/prepare-for-cran" and submit to CRAN
> with a note on this problem in cran-comments.md if the package passes
> all other tests.
> 
> 
> 	  Other suggestions?
> 	  Thanks again, Duncan.
> 	  Spencer
> 
> 
> On 5/23/21 2:36 PM, Duncan Murdoch wrote:
>> For ks, if you look here:
>> https://github.com/sbgraves237/sos/runs/2650960959?check_suite_focus=true
>>
>> in the "Install Dependencies" section, you'll see these errors:
>>
>> trying URL 'https://cloud.r-project.org/src/contrib/ks_1.13.0.tar.gz'
>> Content type 'application/x-gzip' length 1076044 bytes (1.0 MB)
>> ==================================================
>> downloaded 1.0 MB
>>
>> * installing *source* package ?plot3D? ...
>> ** package ?plot3D? successfully unpacked and MD5 sums checked
>> ** using staged installation
>> ** R
>> ** data
>> *** moving datasets to lazyload DB
>> ** inst
>> ** byte-compile and prepare package for lazy loading
>> Error: Error: .onLoad failed in loadNamespace() for 'tcltk', details:
>> ERROR: lazy loading failed for package ?plot3D?
>>   ? call: fun(libname, pkgname)
>> * removing ?/Users/runner/work/_temp/Library/plot3D?
>>   ? error: X11 library is missing: install XQuartz from www.xquartz.org
>> Execution halted
>> ERROR: dependency ?plot3D? is not available for package ?ks?
>> * removing ?/Users/runner/work/_temp/Library/ks?
>>
>> so the problem is really with plot3D, and indirectly with rgl and tcltk.
>> I'm familiar with problems like that!? Here are the lines from the rgl
>> workflow to work around the XQuartz issues:
>>
>>   ??? env:
>>   ????? R_REMOTES_NO_ERRORS_FROM_WARNINGS: true
>>   ????? _R_CHECK_FORCE_SUGGESTS_: false
>>   ????? RSPM: ${{ matrix.config.rspm }}
>>   ????? GITHUB_PAT: ${{ secrets.GITHUB_TOKEN }}
>>   ????? RGL_USE_NULL: true
>>
>> The last line might be enough for you, but I think the 2nd line
>>
>> _R_CHECK_FORCE_SUGGESTS_: false
>>
>> may be more important:? you use ks, it imports plot3D, plot3D imports
>> misc3d, but it only suggests rgl and tkrplot:? so that would let ks load
>> without XQuartz support.
>>
>> Duncan Murdoch
>>
>> On 23/05/2021 3:09 p.m., Spencer Graves wrote:
>>> Hi, Duncan et al.:
>>>
>>>
>>>  ????? Thanks again to Duncan.? Your suggestions worked for the LaTeX
>>> problem, though it required multiple iterations, adding a total of 7
>>> different "tinytex::parse_install" clauses to overcome other LaTeX and
>>> pdfTeX errors.
>>>
>>>
>>>  ????? However, macOS still says, "there is no package called 'ks'", even
>>> though I added 'install.packages("ks")' as you suggested -- to three
>>> different places, all without solving the problem.? I posted this
>>> question to
>>> "https://community.rstudio.com/new-topic?category=Package%20development&tags=github-actions",
>>>
>>> as suggested in line 2 of "~/.github/workflows/R-CMD-check.yaml".? See:
>>>
>>>
>>>  ????? Spencer
>>>
>>>
>>> On 5/23/21 11:03 AM, Duncan Murdoch wrote:
>>>> This page
>>>>
>>>> https://bookdown.org/yihui/rmarkdown-cookbook/install-latex-pkgs.html
>>>>
>>>> suggests that executing this in R should fix the tikz issue:
>>>>
>>>> tinytex::parse_install(
>>>>  ? ? text = "! LaTeX Error: File `tikz.sty' not found."
>>>> )
>>>>
>>>> The "ks" message looks like a missing R package rather than a missing
>>>> LaTeX package, so running install.packages("ks") would fix it.
>>>>
>>>> So the only question is how to do these things in a Github action.? I
>>>> don't know if there's a pre-made recipe for this, but this one should do
>>>> it:
>>>>
>>>>  ? ????? - name: Install tikz.tex and ks
>>>>  ? ??????? run: |
>>>>  ? ????????? install.packages(c('tinytex', 'ks')) # Maybe tinytex is
>>>> already there?
>>>>  ? ????????? tinytex::parse_install(
>>>>  ? ???????????? text = "! LaTeX Error: File `tikz.sty' not found."
>>>>  ? ????????? )
>>>>  ? ??????? shell: Rscript {0}
>>>>
>>>> Duncan Murdoch
>>>>
>>>> On 23/05/2021 11:28 a.m., Spencer Graves wrote:
>>>>> Hi, Duncan et al.:
>>>>>
>>>>>
>>>>>  ?????? Thanks very much to Duncan for his suggestion.? I did added the
>>>>> line
>>>>> Duncan suggested in three slightly different places.? That fixed the
>>>>> problems with missing tex and pdflatex, but exposed two new problems:
>>>>>
>>>>>
>>>>>  ?????? On Windows and ubuntu (both release and devel) I now get:
>>>>>
>>>>>
>>>>> LaTeX Error: File `tikz.sty' not found.
>>>>>
>>>>>
>>>>>  ?????? On macOS, I got a different error:
>>>>>
>>>>>
>>>>> there is no package called 'ks'
>>>>>
>>>>>
>>>>>  ?????? I added "ks" to "suggests" in DESCRIPTON but still got "no
>>>>> package
>>>>> called 'ks'.? And I studied README in https://github.com/r-lib/actions,
>>>>> and I did some other searches without figuring out how to fix
>>>>> "`tikz.sty' not found."
>>>>>
>>>>>
>>>>>  ?????? For more details, see:
>>>>>
>>>>>
>>>>> https://github.com/sbgraves237/sos
>>>>>
>>>>>
>>>>>  ?????? Suggestions?
>>>>>  ?????? Thanks,
>>>>>  ?????? Spencer
>>>>>
>>>>>
>>>>> On 5/23/21 4:43 AM, Duncan Murdoch wrote:
>>>>>> On 22/05/2021 10:05 p.m., Spencer Graves wrote:
>>>>>>> Hello:
>>>>>>>
>>>>>>>
>>>>>>>  ??????? What do you suggest I do to enable GitHub Action to process
>>>>>>> "sos.Rnw"
>>>>>>> properly?
>>>>>>>
>>>>>>>
>>>>>>>  ??????? The development version of my "sos" package passes "R CMD
>>>>>>> check" on
>>>>>>> my Mac but fails in all four platforms under GitHub Action on
>>>>>>>
>>>>>>>
>>>>>>> https://github.com/sbgraves237/sos
>>>>>>>
>>>>>>>
>>>>>>>  ??????? The error messages on macOS and Ubuntu release and devel all
>>>>>>> seems
>>>>>>> the same:
>>>>>>>
>>>>>>>
>>>>>>>  ????????????? * Error: processing vignette 'sos.Rnw' failed with
>>>>>>> diagnostics:
>>>>>>> Running 'texi2dvi' on 'sos.tex' failed.? Messages: You don't have a
>>>>>>> working TeX binary (tex) installed anywhere in your PATH, and
>>>>>>> texi2dvi
>>>>>>> cannot proceed without one.
>>>>>>>
>>>>>>>
>>>>>>>  ??????? The error message under Windows seemed crudely similar but
>>>>>>> different:
>>>>>>>
>>>>>>>
>>>>>>>  ????????????? * Error: processing vignette 'sos.Rnw' failed with
>>>>>>> diagnostics:
>>>>>>> pdflatex is not available
>>>>>>>
>>>>>>>
>>>>>>>  ??????? What do you suggest?
>>>>>>
>>>>>> The virtual machines that run Github actions have lots of tools
>>>>>> installed, but apparently not LaTeX.? So you need to figure out the
>>>>>> "step" to install it.? I'm not currently using Rnw with Github
>>>>>> actions,
>>>>>> but by looking at the README for https://github.com/r-lib/actions, I'm
>>>>>> pretty sure all you need is to add
>>>>>>
>>>>>>  ?? ? - uses: r-lib/actions/setup-tinytex at v1
>>>>>>
>>>>>> somewhere after
>>>>>>
>>>>>>  ?? ? - uses: actions/checkout at master
>>>>
>>


From @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org  Mon May 24 00:49:51 2021
From: @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org (Spencer Graves)
Date: Sun, 23 May 2021 17:49:51 -0500
Subject: [R-pkg-devel] GitHub Action failed re-building 'sos.Rnw'
In-Reply-To: <347aed7a-78d0-9262-33e2-6d3175d50ba7@gmail.com>
References: <c081bdbd-b868-203e-5c6c-d99594368c84@effectivedefense.org>
 <22dc99e0-7f15-dfc6-65ad-05aa106c3873@gmail.com>
 <573846fd-2b56-2ceb-3f6a-08436bf82879@effectivedefense.org>
 <fac57f63-30a3-493b-a4df-a876e34af17f@gmail.com>
 <f05eb4f3-9844-db2b-5113-d510bf01b43b@effectivedefense.org>
 <9fa2cd7a-3ec6-eb88-f810-d54192afe767@gmail.com>
 <d3bfac9c-9c7a-2ec9-71fd-676ac0bf1335@effectivedefense.org>
 <347aed7a-78d0-9262-33e2-6d3175d50ba7@gmail.com>
Message-ID: <e3d57838-a2ac-af8b-30d0-100acfde9387@effectivedefense.org>

Hi, Duncan et al.:


	  Thanks again.  I removed fda from "suggests" and added it to 
"imports" in DESCRIPTION.  I also added "importFrom('fda', 'CRAN')" to 
NAMESPACE.  Sadly, the result was the same:  It passed "R CMD check" on 
Windows, ubuntu, and my local Mac but not macOS on GitHub Action.


	  How do you suggest I proceed from here?


	  You may recall that I started using "if(fda::CRAN())" as a way to 
keep checks for routine testing that take too much time on CRAN.  I've 
looked at Wickham's "skip_on_cran" but concluded, perhaps incorrectly, 
that it was not self contained and required more work to use than 
"if(fda::CRAN())".  If I'm incorrect in that assessment, I will happily 
accept instructions on how to convert "if(fda::CRAN())" to use 
"skip_on_cran".


	  Again, I really appreciate the help.
	  Spencer


On 5/23/21 4:44 PM, Duncan Murdoch wrote:
> I don't see where the connection is, but it's almost certainly coming in 
> through your unconditional use of "fda::CRAN()".? Since "fda" is not a 
> hard requirement, this should be conditional on having it installed.
> 
> Duncan Murdoch
> 
> On 23/05/2021 5:25 p.m., Spencer Graves wrote:
>> Hi, Duncan et al.:
>>
>>
>> ????? I inserted "the lines from the rgl workflow to work around the
>> XQuartz issues" that Duncan provided after "env" in TWO places in
>> R-CMD-check.yaml with the same result:? GitHub Action worked fine on
>> Windows and ubuntu (both release and devel) but failed on macOS
>> complaining, "there is no package called 'ks'".
>>
>>
>> ????? HOWEVER, I can NOT see how I even ask for ks.? The error message 
>> says:
>>
>>
>> processing the following file failed: 'sos.Rnw'
>> Error: Error: Vignette re-building failed.
>> Execution halted
>> Error: Error in proc$get_built_file() : Build process failed
>> Calls: <Anonymous> ... build_package -> with_envvar -> force -> 
>> <Anonymous>
>> Execution halted
>> Error: Process completed with exit code 1.
>>
>>
>> ????? I can NOT find it with "grep 'ks' sos.Rnw".? It's NOT in 
>> DESCRIPTION
>> nor NAMESPACE.
>>
>>
>> ????? I do NOT see how I am even asking for it.
>>
>>
>> ????? PROPOSED NEXT STEP:? Do as outlined in
>> "https://github.com/ThinkR-open/prepare-for-cran" and submit to CRAN
>> with a note on this problem in cran-comments.md if the package passes
>> all other tests.
>>
>>
>> ????? Other suggestions?
>> ????? Thanks again, Duncan.
>> ????? Spencer
>>
>>
>> On 5/23/21 2:36 PM, Duncan Murdoch wrote:
>>> For ks, if you look here:
>>> https://github.com/sbgraves237/sos/runs/2650960959?check_suite_focus=true 
>>>
>>>
>>> in the "Install Dependencies" section, you'll see these errors:
>>>
>>> trying URL 'https://cloud.r-project.org/src/contrib/ks_1.13.0.tar.gz'
>>> Content type 'application/x-gzip' length 1076044 bytes (1.0 MB)
>>> ==================================================
>>> downloaded 1.0 MB
>>>
>>> * installing *source* package ?plot3D? ...
>>> ** package ?plot3D? successfully unpacked and MD5 sums checked
>>> ** using staged installation
>>> ** R
>>> ** data
>>> *** moving datasets to lazyload DB
>>> ** inst
>>> ** byte-compile and prepare package for lazy loading
>>> Error: Error: .onLoad failed in loadNamespace() for 'tcltk', details:
>>> ERROR: lazy loading failed for package ?plot3D?
>>> ? ? call: fun(libname, pkgname)
>>> * removing ?/Users/runner/work/_temp/Library/plot3D?
>>> ? ? error: X11 library is missing: install XQuartz from www.xquartz.org
>>> Execution halted
>>> ERROR: dependency ?plot3D? is not available for package ?ks?
>>> * removing ?/Users/runner/work/_temp/Library/ks?
>>>
>>> so the problem is really with plot3D, and indirectly with rgl and tcltk.
>>> I'm familiar with problems like that!? Here are the lines from the rgl
>>> workflow to work around the XQuartz issues:
>>>
>>> ? ??? env:
>>> ? ????? R_REMOTES_NO_ERRORS_FROM_WARNINGS: true
>>> ? ????? _R_CHECK_FORCE_SUGGESTS_: false
>>> ? ????? RSPM: ${{ matrix.config.rspm }}
>>> ? ????? GITHUB_PAT: ${{ secrets.GITHUB_TOKEN }}
>>> ? ????? RGL_USE_NULL: true
>>>
>>> The last line might be enough for you, but I think the 2nd line
>>>
>>> _R_CHECK_FORCE_SUGGESTS_: false
>>>
>>> may be more important:? you use ks, it imports plot3D, plot3D imports
>>> misc3d, but it only suggests rgl and tkrplot:? so that would let ks load
>>> without XQuartz support.
>>>
>>> Duncan Murdoch
>>>
>>> On 23/05/2021 3:09 p.m., Spencer Graves wrote:
>>>> Hi, Duncan et al.:
>>>>
>>>>
>>>> ?????? Thanks again to Duncan.? Your suggestions worked for the LaTeX
>>>> problem, though it required multiple iterations, adding a total of 7
>>>> different "tinytex::parse_install" clauses to overcome other LaTeX and
>>>> pdfTeX errors.
>>>>
>>>>
>>>> ?????? However, macOS still says, "there is no package called 'ks'", 
>>>> even
>>>> though I added 'install.packages("ks")' as you suggested -- to three
>>>> different places, all without solving the problem.? I posted this
>>>> question to
>>>> "https://community.rstudio.com/new-topic?category=Package%20development&tags=github-actions", 
>>>>
>>>>
>>>> as suggested in line 2 of "~/.github/workflows/R-CMD-check.yaml".? See:
>>>>
>>>>
>>>> ?????? Spencer
>>>>
>>>>
>>>> On 5/23/21 11:03 AM, Duncan Murdoch wrote:
>>>>> This page
>>>>>
>>>>> https://bookdown.org/yihui/rmarkdown-cookbook/install-latex-pkgs.html
>>>>>
>>>>> suggests that executing this in R should fix the tikz issue:
>>>>>
>>>>> tinytex::parse_install(
>>>>> ?? ? text = "! LaTeX Error: File `tikz.sty' not found."
>>>>> )
>>>>>
>>>>> The "ks" message looks like a missing R package rather than a missing
>>>>> LaTeX package, so running install.packages("ks") would fix it.
>>>>>
>>>>> So the only question is how to do these things in a Github action.? I
>>>>> don't know if there's a pre-made recipe for this, but this one 
>>>>> should do
>>>>> it:
>>>>>
>>>>> ?? ????? - name: Install tikz.tex and ks
>>>>> ?? ??????? run: |
>>>>> ?? ????????? install.packages(c('tinytex', 'ks')) # Maybe tinytex is
>>>>> already there?
>>>>> ?? ????????? tinytex::parse_install(
>>>>> ?? ???????????? text = "! LaTeX Error: File `tikz.sty' not found."
>>>>> ?? ????????? )
>>>>> ?? ??????? shell: Rscript {0}
>>>>>
>>>>> Duncan Murdoch
>>>>>
>>>>> On 23/05/2021 11:28 a.m., Spencer Graves wrote:
>>>>>> Hi, Duncan et al.:
>>>>>>
>>>>>>
>>>>>> ??????? Thanks very much to Duncan for his suggestion.? I did 
>>>>>> added the
>>>>>> line
>>>>>> Duncan suggested in three slightly different places.? That fixed the
>>>>>> problems with missing tex and pdflatex, but exposed two new problems:
>>>>>>
>>>>>>
>>>>>> ??????? On Windows and ubuntu (both release and devel) I now get:
>>>>>>
>>>>>>
>>>>>> LaTeX Error: File `tikz.sty' not found.
>>>>>>
>>>>>>
>>>>>> ??????? On macOS, I got a different error:
>>>>>>
>>>>>>
>>>>>> there is no package called 'ks'
>>>>>>
>>>>>>
>>>>>> ??????? I added "ks" to "suggests" in DESCRIPTON but still got "no
>>>>>> package
>>>>>> called 'ks'.? And I studied README in 
>>>>>> https://github.com/r-lib/actions,
>>>>>> and I did some other searches without figuring out how to fix
>>>>>> "`tikz.sty' not found."
>>>>>>
>>>>>>
>>>>>> ??????? For more details, see:
>>>>>>
>>>>>>
>>>>>> https://github.com/sbgraves237/sos
>>>>>>
>>>>>>
>>>>>> ??????? Suggestions?
>>>>>> ??????? Thanks,
>>>>>> ??????? Spencer
>>>>>>
>>>>>>
>>>>>> On 5/23/21 4:43 AM, Duncan Murdoch wrote:
>>>>>>> On 22/05/2021 10:05 p.m., Spencer Graves wrote:
>>>>>>>> Hello:
>>>>>>>>
>>>>>>>>
>>>>>>>> ???????? What do you suggest I do to enable GitHub Action to 
>>>>>>>> process
>>>>>>>> "sos.Rnw"
>>>>>>>> properly?
>>>>>>>>
>>>>>>>>
>>>>>>>> ???????? The development version of my "sos" package passes "R CMD
>>>>>>>> check" on
>>>>>>>> my Mac but fails in all four platforms under GitHub Action on
>>>>>>>>
>>>>>>>>
>>>>>>>> https://github.com/sbgraves237/sos
>>>>>>>>
>>>>>>>>
>>>>>>>> ???????? The error messages on macOS and Ubuntu release and 
>>>>>>>> devel all
>>>>>>>> seems
>>>>>>>> the same:
>>>>>>>>
>>>>>>>>
>>>>>>>> ?????????????? * Error: processing vignette 'sos.Rnw' failed with
>>>>>>>> diagnostics:
>>>>>>>> Running 'texi2dvi' on 'sos.tex' failed.? Messages: You don't have a
>>>>>>>> working TeX binary (tex) installed anywhere in your PATH, and
>>>>>>>> texi2dvi
>>>>>>>> cannot proceed without one.
>>>>>>>>
>>>>>>>>
>>>>>>>> ???????? The error message under Windows seemed crudely similar but
>>>>>>>> different:
>>>>>>>>
>>>>>>>>
>>>>>>>> ?????????????? * Error: processing vignette 'sos.Rnw' failed with
>>>>>>>> diagnostics:
>>>>>>>> pdflatex is not available
>>>>>>>>
>>>>>>>>
>>>>>>>> ???????? What do you suggest?
>>>>>>>
>>>>>>> The virtual machines that run Github actions have lots of tools
>>>>>>> installed, but apparently not LaTeX.? So you need to figure out the
>>>>>>> "step" to install it.? I'm not currently using Rnw with Github
>>>>>>> actions,
>>>>>>> but by looking at the README for 
>>>>>>> https://github.com/r-lib/actions, I'm
>>>>>>> pretty sure all you need is to add
>>>>>>>
>>>>>>> ??? ? - uses: r-lib/actions/setup-tinytex at v1
>>>>>>>
>>>>>>> somewhere after
>>>>>>>
>>>>>>> ??? ? - uses: actions/checkout at master
>>>>>
>>>
>


From murdoch@dunc@n @end|ng |rom gm@||@com  Mon May 24 02:03:29 2021
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Sun, 23 May 2021 20:03:29 -0400
Subject: [R-pkg-devel] GitHub Action failed re-building 'sos.Rnw'
In-Reply-To: <e3d57838-a2ac-af8b-30d0-100acfde9387@effectivedefense.org>
References: <c081bdbd-b868-203e-5c6c-d99594368c84@effectivedefense.org>
 <22dc99e0-7f15-dfc6-65ad-05aa106c3873@gmail.com>
 <573846fd-2b56-2ceb-3f6a-08436bf82879@effectivedefense.org>
 <fac57f63-30a3-493b-a4df-a876e34af17f@gmail.com>
 <f05eb4f3-9844-db2b-5113-d510bf01b43b@effectivedefense.org>
 <9fa2cd7a-3ec6-eb88-f810-d54192afe767@gmail.com>
 <d3bfac9c-9c7a-2ec9-71fd-676ac0bf1335@effectivedefense.org>
 <347aed7a-78d0-9262-33e2-6d3175d50ba7@gmail.com>
 <e3d57838-a2ac-af8b-30d0-100acfde9387@effectivedefense.org>
Message-ID: <d76b6c78-92c4-9583-4014-6309ba6aa35e@gmail.com>

Okay, I just worked out the chain:  The fda package depends on fds.  fds 
depends on rainbow. rainbow imports ks. ks imports plot3D. plot3D 
imports misc3d.  misc3d imports tcltk.  tcltk on macOS needs XQuartz.

I saw this item online: 
https://github.com/actions/virtual-environments/issues/771 .  It's a 
suggestion to add this to the default macOS VM, but apparently they 
didn't act on it.  You could try adding it to yours:

  if: runner.os == 'macOS'
         run: |
           wget https://dl.bintray.com/xquartz/downloads/XQuartz-2.7.11.dmg
           sudo hdiutil attach XQuartz-2.7.11.dmg
           sudo installer -package /Volumes/XQuartz-2.7.11/XQuartz.pkg 
-target /


(Though the current XQuartz version is 2.8.1, and the URL above doesn't 
work for me, so you'll probably have to spend some time finding one that 
does.)

What should you do?  I can suggest a couple of things other than 
installing XQuartz:

1.  Drop the fda dependency, and work around the lack of fda::CRAN.  It 
seems you're pulling in an awful lot of stuff for that one function. 
The on_cran function in testthat has this definition:

function ()
!identical(Sys.getenv("NOT_CRAN"), "true")

so I'd copy that to your package and then define environment variable 
NOT_CRAN=true on your Github machine (in the "env:" section).  But this 
might be inconvenient working on your own machine, where you'll also 
need to define NOT_CRAN=true.

2.  Leave in the fda dependency, but make the test conditional, i.e. change

  if (fda::CRAN())

to

  if (requireNamespace("fda") && fda::CRAN())


I'd do number 1, or just assume everything is being run on CRAN.

Duncan Murdoch

On 23/05/2021 6:49 p.m., Spencer Graves wrote:
> Hi, Duncan et al.:
> 
> 
> 	  Thanks again.  I removed fda from "suggests" and added it to
> "imports" in DESCRIPTION.  I also added "importFrom('fda', 'CRAN')" to
> NAMESPACE.  Sadly, the result was the same:  It passed "R CMD check" on
> Windows, ubuntu, and my local Mac but not macOS on GitHub Action.
> 
> 
> 	  How do you suggest I proceed from here?
> 
> 
> 	  You may recall that I started using "if(fda::CRAN())" as a way to
> keep checks for routine testing that take too much time on CRAN.  I've
> looked at Wickham's "skip_on_cran" but concluded, perhaps incorrectly,
> that it was not self contained and required more work to use than
> "if(fda::CRAN())".  If I'm incorrect in that assessment, I will happily
> accept instructions on how to convert "if(fda::CRAN())" to use
> "skip_on_cran".
> 
> 
> 	  Again, I really appreciate the help.
> 	  Spencer
> 
> 
> On 5/23/21 4:44 PM, Duncan Murdoch wrote:
>> I don't see where the connection is, but it's almost certainly coming in
>> through your unconditional use of "fda::CRAN()".? Since "fda" is not a
>> hard requirement, this should be conditional on having it installed.
>>
>> Duncan Murdoch
>>
>> On 23/05/2021 5:25 p.m., Spencer Graves wrote:
>>> Hi, Duncan et al.:
>>>
>>>
>>>  ????? I inserted "the lines from the rgl workflow to work around the
>>> XQuartz issues" that Duncan provided after "env" in TWO places in
>>> R-CMD-check.yaml with the same result:? GitHub Action worked fine on
>>> Windows and ubuntu (both release and devel) but failed on macOS
>>> complaining, "there is no package called 'ks'".
>>>
>>>
>>>  ????? HOWEVER, I can NOT see how I even ask for ks.? The error message
>>> says:
>>>
>>>
>>> processing the following file failed: 'sos.Rnw'
>>> Error: Error: Vignette re-building failed.
>>> Execution halted
>>> Error: Error in proc$get_built_file() : Build process failed
>>> Calls: <Anonymous> ... build_package -> with_envvar -> force ->
>>> <Anonymous>
>>> Execution halted
>>> Error: Process completed with exit code 1.
>>>
>>>
>>>  ????? I can NOT find it with "grep 'ks' sos.Rnw".? It's NOT in
>>> DESCRIPTION
>>> nor NAMESPACE.
>>>
>>>
>>>  ????? I do NOT see how I am even asking for it.
>>>
>>>
>>>  ????? PROPOSED NEXT STEP:? Do as outlined in
>>> "https://github.com/ThinkR-open/prepare-for-cran" and submit to CRAN
>>> with a note on this problem in cran-comments.md if the package passes
>>> all other tests.
>>>
>>>
>>>  ????? Other suggestions?
>>>  ????? Thanks again, Duncan.
>>>  ????? Spencer
>>>
>>>
>>> On 5/23/21 2:36 PM, Duncan Murdoch wrote:
>>>> For ks, if you look here:
>>>> https://github.com/sbgraves237/sos/runs/2650960959?check_suite_focus=true
>>>>
>>>>
>>>> in the "Install Dependencies" section, you'll see these errors:
>>>>
>>>> trying URL 'https://cloud.r-project.org/src/contrib/ks_1.13.0.tar.gz'
>>>> Content type 'application/x-gzip' length 1076044 bytes (1.0 MB)
>>>> ==================================================
>>>> downloaded 1.0 MB
>>>>
>>>> * installing *source* package ?plot3D? ...
>>>> ** package ?plot3D? successfully unpacked and MD5 sums checked
>>>> ** using staged installation
>>>> ** R
>>>> ** data
>>>> *** moving datasets to lazyload DB
>>>> ** inst
>>>> ** byte-compile and prepare package for lazy loading
>>>> Error: Error: .onLoad failed in loadNamespace() for 'tcltk', details:
>>>> ERROR: lazy loading failed for package ?plot3D?
>>>>  ? ? call: fun(libname, pkgname)
>>>> * removing ?/Users/runner/work/_temp/Library/plot3D?
>>>>  ? ? error: X11 library is missing: install XQuartz from www.xquartz.org
>>>> Execution halted
>>>> ERROR: dependency ?plot3D? is not available for package ?ks?
>>>> * removing ?/Users/runner/work/_temp/Library/ks?
>>>>
>>>> so the problem is really with plot3D, and indirectly with rgl and tcltk.
>>>> I'm familiar with problems like that!? Here are the lines from the rgl
>>>> workflow to work around the XQuartz issues:
>>>>
>>>>  ? ??? env:
>>>>  ? ????? R_REMOTES_NO_ERRORS_FROM_WARNINGS: true
>>>>  ? ????? _R_CHECK_FORCE_SUGGESTS_: false
>>>>  ? ????? RSPM: ${{ matrix.config.rspm }}
>>>>  ? ????? GITHUB_PAT: ${{ secrets.GITHUB_TOKEN }}
>>>>  ? ????? RGL_USE_NULL: true
>>>>
>>>> The last line might be enough for you, but I think the 2nd line
>>>>
>>>> _R_CHECK_FORCE_SUGGESTS_: false
>>>>
>>>> may be more important:? you use ks, it imports plot3D, plot3D imports
>>>> misc3d, but it only suggests rgl and tkrplot:? so that would let ks load
>>>> without XQuartz support.
>>>>
>>>> Duncan Murdoch
>>>>
>>>> On 23/05/2021 3:09 p.m., Spencer Graves wrote:
>>>>> Hi, Duncan et al.:
>>>>>
>>>>>
>>>>>  ?????? Thanks again to Duncan.? Your suggestions worked for the LaTeX
>>>>> problem, though it required multiple iterations, adding a total of 7
>>>>> different "tinytex::parse_install" clauses to overcome other LaTeX and
>>>>> pdfTeX errors.
>>>>>
>>>>>
>>>>>  ?????? However, macOS still says, "there is no package called 'ks'",
>>>>> even
>>>>> though I added 'install.packages("ks")' as you suggested -- to three
>>>>> different places, all without solving the problem.? I posted this
>>>>> question to
>>>>> "https://community.rstudio.com/new-topic?category=Package%20development&tags=github-actions",
>>>>>
>>>>>
>>>>> as suggested in line 2 of "~/.github/workflows/R-CMD-check.yaml".? See:
>>>>>
>>>>>
>>>>>  ?????? Spencer
>>>>>
>>>>>
>>>>> On 5/23/21 11:03 AM, Duncan Murdoch wrote:
>>>>>> This page
>>>>>>
>>>>>> https://bookdown.org/yihui/rmarkdown-cookbook/install-latex-pkgs.html
>>>>>>
>>>>>> suggests that executing this in R should fix the tikz issue:
>>>>>>
>>>>>> tinytex::parse_install(
>>>>>>  ?? ? text = "! LaTeX Error: File `tikz.sty' not found."
>>>>>> )
>>>>>>
>>>>>> The "ks" message looks like a missing R package rather than a missing
>>>>>> LaTeX package, so running install.packages("ks") would fix it.
>>>>>>
>>>>>> So the only question is how to do these things in a Github action.? I
>>>>>> don't know if there's a pre-made recipe for this, but this one
>>>>>> should do
>>>>>> it:
>>>>>>
>>>>>>  ?? ????? - name: Install tikz.tex and ks
>>>>>>  ?? ??????? run: |
>>>>>>  ?? ????????? install.packages(c('tinytex', 'ks')) # Maybe tinytex is
>>>>>> already there?
>>>>>>  ?? ????????? tinytex::parse_install(
>>>>>>  ?? ???????????? text = "! LaTeX Error: File `tikz.sty' not found."
>>>>>>  ?? ????????? )
>>>>>>  ?? ??????? shell: Rscript {0}
>>>>>>
>>>>>> Duncan Murdoch
>>>>>>
>>>>>> On 23/05/2021 11:28 a.m., Spencer Graves wrote:
>>>>>>> Hi, Duncan et al.:
>>>>>>>
>>>>>>>
>>>>>>>  ??????? Thanks very much to Duncan for his suggestion.? I did
>>>>>>> added the
>>>>>>> line
>>>>>>> Duncan suggested in three slightly different places.? That fixed the
>>>>>>> problems with missing tex and pdflatex, but exposed two new problems:
>>>>>>>
>>>>>>>
>>>>>>>  ??????? On Windows and ubuntu (both release and devel) I now get:
>>>>>>>
>>>>>>>
>>>>>>> LaTeX Error: File `tikz.sty' not found.
>>>>>>>
>>>>>>>
>>>>>>>  ??????? On macOS, I got a different error:
>>>>>>>
>>>>>>>
>>>>>>> there is no package called 'ks'
>>>>>>>
>>>>>>>
>>>>>>>  ??????? I added "ks" to "suggests" in DESCRIPTON but still got "no
>>>>>>> package
>>>>>>> called 'ks'.? And I studied README in
>>>>>>> https://github.com/r-lib/actions,
>>>>>>> and I did some other searches without figuring out how to fix
>>>>>>> "`tikz.sty' not found."
>>>>>>>
>>>>>>>
>>>>>>>  ??????? For more details, see:
>>>>>>>
>>>>>>>
>>>>>>> https://github.com/sbgraves237/sos
>>>>>>>
>>>>>>>
>>>>>>>  ??????? Suggestions?
>>>>>>>  ??????? Thanks,
>>>>>>>  ??????? Spencer
>>>>>>>
>>>>>>>
>>>>>>> On 5/23/21 4:43 AM, Duncan Murdoch wrote:
>>>>>>>> On 22/05/2021 10:05 p.m., Spencer Graves wrote:
>>>>>>>>> Hello:
>>>>>>>>>
>>>>>>>>>
>>>>>>>>>  ???????? What do you suggest I do to enable GitHub Action to
>>>>>>>>> process
>>>>>>>>> "sos.Rnw"
>>>>>>>>> properly?
>>>>>>>>>
>>>>>>>>>
>>>>>>>>>  ???????? The development version of my "sos" package passes "R CMD
>>>>>>>>> check" on
>>>>>>>>> my Mac but fails in all four platforms under GitHub Action on
>>>>>>>>>
>>>>>>>>>
>>>>>>>>> https://github.com/sbgraves237/sos
>>>>>>>>>
>>>>>>>>>
>>>>>>>>>  ???????? The error messages on macOS and Ubuntu release and
>>>>>>>>> devel all
>>>>>>>>> seems
>>>>>>>>> the same:
>>>>>>>>>
>>>>>>>>>
>>>>>>>>>  ?????????????? * Error: processing vignette 'sos.Rnw' failed with
>>>>>>>>> diagnostics:
>>>>>>>>> Running 'texi2dvi' on 'sos.tex' failed.? Messages: You don't have a
>>>>>>>>> working TeX binary (tex) installed anywhere in your PATH, and
>>>>>>>>> texi2dvi
>>>>>>>>> cannot proceed without one.
>>>>>>>>>
>>>>>>>>>
>>>>>>>>>  ???????? The error message under Windows seemed crudely similar but
>>>>>>>>> different:
>>>>>>>>>
>>>>>>>>>
>>>>>>>>>  ?????????????? * Error: processing vignette 'sos.Rnw' failed with
>>>>>>>>> diagnostics:
>>>>>>>>> pdflatex is not available
>>>>>>>>>
>>>>>>>>>
>>>>>>>>>  ???????? What do you suggest?
>>>>>>>>
>>>>>>>> The virtual machines that run Github actions have lots of tools
>>>>>>>> installed, but apparently not LaTeX.? So you need to figure out the
>>>>>>>> "step" to install it.? I'm not currently using Rnw with Github
>>>>>>>> actions,
>>>>>>>> but by looking at the README for
>>>>>>>> https://github.com/r-lib/actions, I'm
>>>>>>>> pretty sure all you need is to add
>>>>>>>>
>>>>>>>>  ??? ? - uses: r-lib/actions/setup-tinytex at v1
>>>>>>>>
>>>>>>>> somewhere after
>>>>>>>>
>>>>>>>>  ??? ? - uses: actions/checkout at master
>>>>>>
>>>>
>>


From georg|@bo@hn@kov @end|ng |rom m@nche@ter@@c@uk  Mon May 24 15:29:22 2021
From: georg|@bo@hn@kov @end|ng |rom m@nche@ter@@c@uk (Georgi Boshnakov)
Date: Mon, 24 May 2021 13:29:22 +0000
Subject: [R-pkg-devel] 
 Troubleshoot unknown macro '\backslashemph' warning
In-Reply-To: <CA+0rMg=mL0+qVDgXbEdirUvYCD_3iTdRS6BAPTmVD58Xamo1hA@mail.gmail.com>
References: <CA+0rMg=mL0+qVDgXbEdirUvYCD_3iTdRS6BAPTmVD58Xamo1hA@mail.gmail.com>
Message-ID: <LOYP265MB201500D0AF95A1572CC895EBAE269@LOYP265MB2015.GBRP265.PROD.OUTLOOK.COM>

This is probably from Rdpack (actually, 'rbibutils', see below). Several references in your REFERENCES.bib contain \emph In 'title' fields. The backslash in \emph is converted to \backslash, resulting in \backslashemph. 

This looks like a bug, please open an issue on github (for Rdpack or rbibutils).

Georgi Boshnakov

===
diwan <- "@article{diwan_methods_1995,
title = {Methods of developing a core collection of annual \\emph{{Medicago}} species}, volume = {90}, language = {en}, number = {6}, journal = {Theoretical and Applied Genetics}, author = {Diwan, N. and McIntosh, M. S. and Bauchan, G. R.}, month = may, year = {1995}, keywords = {Annual Medicago species, Core collection, Germplasm collection, Relative Diversity method}, pages = {755--761} }"

rbibutils::charToBib(diwan) # devel version on github, otherwise use readBib(() to read from file.

## Diwan N, McIntosh MS, Bauchan GR (1995). "Methods of developing a core ## collection of annual \backslashemph{{Medicago}} species." _Theoretical ## and Applied Genetics_, *90*(6), 755-761.



-----Original Message-----
From: R-package-devel <r-package-devel-bounces at r-project.org> On Behalf Of Aravind J.
Sent: 23 May 2021 20:21
To: r-package-devel at r-project.org
Subject: [R-pkg-devel] Troubleshoot unknown macro '\backslashemph' warning

Hi,

While checking two of my packages
(https://github.com/aravind-j/EvaluateCore and https://github.com/aravind-j/augmentedRCBD)with winbuilder while preparing for submitting an updated version, I am getting the following warning.


* checking Rd files ... [4s] WARNING
prepare_Rd: <connection>:2: unknown macro '\backslashemph'
prepare_Rd: <connection>:6: unknown macro '\backslashemph'
prepare_Rd: <connection>:2: unknown macro '\backslashemph'
prepare_Rd: <connection>:4: unknown macro '\backslashemph

I am not able to find the offending macros anywhere in the Rd files being generated. I am using two RdMacros, mathjaxr and Rdpack.

How to troubleshoot?

-- 

J.Aravind
Scientist,
Division of Germplasm Conservation,
ICAR-National Bureau of Plant Genetic Resources, New Delhi - 110 012

	[[alternative HTML version deleted]]

______________________________________________
R-package-devel at r-project.org mailing list https://stat.ethz.ch/mailman/listinfo/r-package-devel


From @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org  Mon May 24 16:17:47 2021
From: @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org (Spencer Graves)
Date: Mon, 24 May 2021 09:17:47 -0500
Subject: [R-pkg-devel] GitHub Action failed re-building 'sos.Rnw'
In-Reply-To: <d76b6c78-92c4-9583-4014-6309ba6aa35e@gmail.com>
References: <c081bdbd-b868-203e-5c6c-d99594368c84@effectivedefense.org>
 <22dc99e0-7f15-dfc6-65ad-05aa106c3873@gmail.com>
 <573846fd-2b56-2ceb-3f6a-08436bf82879@effectivedefense.org>
 <fac57f63-30a3-493b-a4df-a876e34af17f@gmail.com>
 <f05eb4f3-9844-db2b-5113-d510bf01b43b@effectivedefense.org>
 <9fa2cd7a-3ec6-eb88-f810-d54192afe767@gmail.com>
 <d3bfac9c-9c7a-2ec9-71fd-676ac0bf1335@effectivedefense.org>
 <347aed7a-78d0-9262-33e2-6d3175d50ba7@gmail.com>
 <e3d57838-a2ac-af8b-30d0-100acfde9387@effectivedefense.org>
 <d76b6c78-92c4-9583-4014-6309ba6aa35e@gmail.com>
Message-ID: <aafa6c91-5b6a-85d7-9224-c413f7cc3b6a@effectivedefense.org>

Hi, Duncan:


	  Thanks again.


	  I found XQuartz-2.8.1.dmg and added the 5 lines you suggested 
(modified to 2.8.1) to "R-CMD-check.yaml".  However, the "GitHub Action" 
status symbols disappeared, so I deleted them.


	  I copied the "CRAN" function from fda to sos and deleted the 
reference to fda from sos.


	  Now I'm getting, 'could not find function "CRAN"' in "processing 
vignette 'sos.Rnw'", even though CRAN is in the NAMESPACE for sos.


	  Suggestions?


	  Thanks,
	  Spencer


p.s.  To use Sys.getenv("NOT_CRAN"), I'd have to set the environment 
variable "NOT_CRAN" on all the test platforms other than CRAN, and 
that's a level of complexity I'd rather not get into.


On 5/23/21 7:03 PM, Duncan Murdoch wrote:
> Okay, I just worked out the chain:? The fda package depends on fds.? fds 
> depends on rainbow. rainbow imports ks. ks imports plot3D. plot3D 
> imports misc3d.? misc3d imports tcltk.? tcltk on macOS needs XQuartz.
> 
> I saw this item online: 
> https://github.com/actions/virtual-environments/issues/771 .? It's a 
> suggestion to add this to the default macOS VM, but apparently they 
> didn't act on it.? You could try adding it to yours:
> 
>  ?if: runner.os == 'macOS'
>  ??????? run: |
>  ????????? wget https://dl.bintray.com/xquartz/downloads/XQuartz-2.7.11.dmg
>  ????????? sudo hdiutil attach XQuartz-2.7.11.dmg
>  ????????? sudo installer -package /Volumes/XQuartz-2.7.11/XQuartz.pkg 
> -target /
> 
> 
> (Though the current XQuartz version is 2.8.1, and the URL above doesn't 
> work for me, so you'll probably have to spend some time finding one that 
> does.)
> 
> What should you do?? I can suggest a couple of things other than 
> installing XQuartz:
> 
> 1.? Drop the fda dependency, and work around the lack of fda::CRAN.? It 
> seems you're pulling in an awful lot of stuff for that one function. The 
> on_cran function in testthat has this definition:
> 
> function ()
> !identical(Sys.getenv("NOT_CRAN"), "true")
> 
> so I'd copy that to your package and then define environment variable 
> NOT_CRAN=true on your Github machine (in the "env:" section).? But this 
> might be inconvenient working on your own machine, where you'll also 
> need to define NOT_CRAN=true.
> 
> 2.? Leave in the fda dependency, but make the test conditional, i.e. change
> 
>  ?if (fda::CRAN())
> 
> to
> 
>  ?if (requireNamespace("fda") && fda::CRAN())
> 
> 
> I'd do number 1, or just assume everything is being run on CRAN.
> 
> Duncan Murdoch
> 
> On 23/05/2021 6:49 p.m., Spencer Graves wrote:
>> Hi, Duncan et al.:
>>
>>
>> ????? Thanks again.? I removed fda from "suggests" and added it to
>> "imports" in DESCRIPTION.? I also added "importFrom('fda', 'CRAN')" to
>> NAMESPACE.? Sadly, the result was the same:? It passed "R CMD check" on
>> Windows, ubuntu, and my local Mac but not macOS on GitHub Action.
>>
>>
>> ????? How do you suggest I proceed from here?
>>
>>
>> ????? You may recall that I started using "if(fda::CRAN())" as a way to
>> keep checks for routine testing that take too much time on CRAN.? I've
>> looked at Wickham's "skip_on_cran" but concluded, perhaps incorrectly,
>> that it was not self contained and required more work to use than
>> "if(fda::CRAN())".? If I'm incorrect in that assessment, I will happily
>> accept instructions on how to convert "if(fda::CRAN())" to use
>> "skip_on_cran".
>>
>>
>> ????? Again, I really appreciate the help.
>> ????? Spencer
>>
>>
>> On 5/23/21 4:44 PM, Duncan Murdoch wrote:
>>> I don't see where the connection is, but it's almost certainly coming in
>>> through your unconditional use of "fda::CRAN()".? Since "fda" is not a
>>> hard requirement, this should be conditional on having it installed.
>>>
>>> Duncan Murdoch
>>>
>>> On 23/05/2021 5:25 p.m., Spencer Graves wrote:
>>>> Hi, Duncan et al.:
>>>>
>>>>
>>>> ?????? I inserted "the lines from the rgl workflow to work around the
>>>> XQuartz issues" that Duncan provided after "env" in TWO places in
>>>> R-CMD-check.yaml with the same result:? GitHub Action worked fine on
>>>> Windows and ubuntu (both release and devel) but failed on macOS
>>>> complaining, "there is no package called 'ks'".
>>>>
>>>>
>>>> ?????? HOWEVER, I can NOT see how I even ask for ks.? The error message
>>>> says:
>>>>
>>>>
>>>> processing the following file failed: 'sos.Rnw'
>>>> Error: Error: Vignette re-building failed.
>>>> Execution halted
>>>> Error: Error in proc$get_built_file() : Build process failed
>>>> Calls: <Anonymous> ... build_package -> with_envvar -> force ->
>>>> <Anonymous>
>>>> Execution halted
>>>> Error: Process completed with exit code 1.
>>>>
>>>>
>>>> ?????? I can NOT find it with "grep 'ks' sos.Rnw".? It's NOT in
>>>> DESCRIPTION
>>>> nor NAMESPACE.
>>>>
>>>>
>>>> ?????? I do NOT see how I am even asking for it.
>>>>
>>>>
>>>> ?????? PROPOSED NEXT STEP:? Do as outlined in
>>>> "https://github.com/ThinkR-open/prepare-for-cran" and submit to CRAN
>>>> with a note on this problem in cran-comments.md if the package passes
>>>> all other tests.
>>>>
>>>>
>>>> ?????? Other suggestions?
>>>> ?????? Thanks again, Duncan.
>>>> ?????? Spencer
>>>>
>>>>
>>>> On 5/23/21 2:36 PM, Duncan Murdoch wrote:
>>>>> For ks, if you look here:
>>>>> https://github.com/sbgraves237/sos/runs/2650960959?check_suite_focus=true 
>>>>>
>>>>>
>>>>>
>>>>> in the "Install Dependencies" section, you'll see these errors:
>>>>>
>>>>> trying URL 'https://cloud.r-project.org/src/contrib/ks_1.13.0.tar.gz'
>>>>> Content type 'application/x-gzip' length 1076044 bytes (1.0 MB)
>>>>> ==================================================
>>>>> downloaded 1.0 MB
>>>>>
>>>>> * installing *source* package ?plot3D? ...
>>>>> ** package ?plot3D? successfully unpacked and MD5 sums checked
>>>>> ** using staged installation
>>>>> ** R
>>>>> ** data
>>>>> *** moving datasets to lazyload DB
>>>>> ** inst
>>>>> ** byte-compile and prepare package for lazy loading
>>>>> Error: Error: .onLoad failed in loadNamespace() for 'tcltk', details:
>>>>> ERROR: lazy loading failed for package ?plot3D?
>>>>> ?? ? call: fun(libname, pkgname)
>>>>> * removing ?/Users/runner/work/_temp/Library/plot3D?
>>>>> ?? ? error: X11 library is missing: install XQuartz from 
>>>>> www.xquartz.org
>>>>> Execution halted
>>>>> ERROR: dependency ?plot3D? is not available for package ?ks?
>>>>> * removing ?/Users/runner/work/_temp/Library/ks?
>>>>>
>>>>> so the problem is really with plot3D, and indirectly with rgl and 
>>>>> tcltk.
>>>>> I'm familiar with problems like that!? Here are the lines from the rgl
>>>>> workflow to work around the XQuartz issues:
>>>>>
>>>>> ?? ??? env:
>>>>> ?? ????? R_REMOTES_NO_ERRORS_FROM_WARNINGS: true
>>>>> ?? ????? _R_CHECK_FORCE_SUGGESTS_: false
>>>>> ?? ????? RSPM: ${{ matrix.config.rspm }}
>>>>> ?? ????? GITHUB_PAT: ${{ secrets.GITHUB_TOKEN }}
>>>>> ?? ????? RGL_USE_NULL: true
>>>>>
>>>>> The last line might be enough for you, but I think the 2nd line
>>>>>
>>>>> _R_CHECK_FORCE_SUGGESTS_: false
>>>>>
>>>>> may be more important:? you use ks, it imports plot3D, plot3D imports
>>>>> misc3d, but it only suggests rgl and tkrplot:? so that would let ks 
>>>>> load
>>>>> without XQuartz support.
>>>>>
>>>>> Duncan Murdoch
>>>>>
>>>>> On 23/05/2021 3:09 p.m., Spencer Graves wrote:
>>>>>> Hi, Duncan et al.:
>>>>>>
>>>>>>
>>>>>> ??????? Thanks again to Duncan.? Your suggestions worked for the 
>>>>>> LaTeX
>>>>>> problem, though it required multiple iterations, adding a total of 7
>>>>>> different "tinytex::parse_install" clauses to overcome other LaTeX 
>>>>>> and
>>>>>> pdfTeX errors.
>>>>>>
>>>>>>
>>>>>> ??????? However, macOS still says, "there is no package called 'ks'",
>>>>>> even
>>>>>> though I added 'install.packages("ks")' as you suggested -- to three
>>>>>> different places, all without solving the problem.? I posted this
>>>>>> question to
>>>>>> "https://community.rstudio.com/new-topic?category=Package%20development&tags=github-actions", 
>>>>>>
>>>>>>
>>>>>>
>>>>>> as suggested in line 2 of "~/.github/workflows/R-CMD-check.yaml".  
>>>>>> See:
>>>>>>
>>>>>>
>>>>>> ??????? Spencer
>>>>>>
>>>>>>
>>>>>> On 5/23/21 11:03 AM, Duncan Murdoch wrote:
>>>>>>> This page
>>>>>>>
>>>>>>> https://bookdown.org/yihui/rmarkdown-cookbook/install-latex-pkgs.html 
>>>>>>>
>>>>>>>
>>>>>>> suggests that executing this in R should fix the tikz issue:
>>>>>>>
>>>>>>> tinytex::parse_install(
>>>>>>> ??? ? text = "! LaTeX Error: File `tikz.sty' not found."
>>>>>>> )
>>>>>>>
>>>>>>> The "ks" message looks like a missing R package rather than a 
>>>>>>> missing
>>>>>>> LaTeX package, so running install.packages("ks") would fix it.
>>>>>>>
>>>>>>> So the only question is how to do these things in a Github 
>>>>>>> action.? I
>>>>>>> don't know if there's a pre-made recipe for this, but this one
>>>>>>> should do
>>>>>>> it:
>>>>>>>
>>>>>>> ??? ????? - name: Install tikz.tex and ks
>>>>>>> ??? ??????? run: |
>>>>>>> ??? ????????? install.packages(c('tinytex', 'ks')) # Maybe 
>>>>>>> tinytex is
>>>>>>> already there?
>>>>>>> ??? ????????? tinytex::parse_install(
>>>>>>> ??? ???????????? text = "! LaTeX Error: File `tikz.sty' not found."
>>>>>>> ??? ????????? )
>>>>>>> ??? ??????? shell: Rscript {0}
>>>>>>>
>>>>>>> Duncan Murdoch
>>>>>>>
>>>>>>> On 23/05/2021 11:28 a.m., Spencer Graves wrote:
>>>>>>>> Hi, Duncan et al.:
>>>>>>>>
>>>>>>>>
>>>>>>>> ???????? Thanks very much to Duncan for his suggestion.? I did
>>>>>>>> added the
>>>>>>>> line
>>>>>>>> Duncan suggested in three slightly different places.? That fixed 
>>>>>>>> the
>>>>>>>> problems with missing tex and pdflatex, but exposed two new 
>>>>>>>> problems:
>>>>>>>>
>>>>>>>>
>>>>>>>> ???????? On Windows and ubuntu (both release and devel) I now get:
>>>>>>>>
>>>>>>>>
>>>>>>>> LaTeX Error: File `tikz.sty' not found.
>>>>>>>>
>>>>>>>>
>>>>>>>> ???????? On macOS, I got a different error:
>>>>>>>>
>>>>>>>>
>>>>>>>> there is no package called 'ks'
>>>>>>>>
>>>>>>>>
>>>>>>>> ???????? I added "ks" to "suggests" in DESCRIPTON but still got "no
>>>>>>>> package
>>>>>>>> called 'ks'.? And I studied README in
>>>>>>>> https://github.com/r-lib/actions,
>>>>>>>> and I did some other searches without figuring out how to fix
>>>>>>>> "`tikz.sty' not found."
>>>>>>>>
>>>>>>>>
>>>>>>>> ???????? For more details, see:
>>>>>>>>
>>>>>>>>
>>>>>>>> https://github.com/sbgraves237/sos
>>>>>>>>
>>>>>>>>
>>>>>>>> ???????? Suggestions?
>>>>>>>> ???????? Thanks,
>>>>>>>> ???????? Spencer
>>>>>>>>
>>>>>>>>
>>>>>>>> On 5/23/21 4:43 AM, Duncan Murdoch wrote:
>>>>>>>>> On 22/05/2021 10:05 p.m., Spencer Graves wrote:
>>>>>>>>>> Hello:
>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>> ????????? What do you suggest I do to enable GitHub Action to
>>>>>>>>>> process
>>>>>>>>>> "sos.Rnw"
>>>>>>>>>> properly?
>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>> ????????? The development version of my "sos" package passes 
>>>>>>>>>> "R CMD
>>>>>>>>>> check" on
>>>>>>>>>> my Mac but fails in all four platforms under GitHub Action on
>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>> https://github.com/sbgraves237/sos
>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>> ????????? The error messages on macOS and Ubuntu release and
>>>>>>>>>> devel all
>>>>>>>>>> seems
>>>>>>>>>> the same:
>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>> ??????????????? * Error: processing vignette 'sos.Rnw' failed 
>>>>>>>>>> with
>>>>>>>>>> diagnostics:
>>>>>>>>>> Running 'texi2dvi' on 'sos.tex' failed.? Messages: You don't 
>>>>>>>>>> have a
>>>>>>>>>> working TeX binary (tex) installed anywhere in your PATH, and
>>>>>>>>>> texi2dvi
>>>>>>>>>> cannot proceed without one.
>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>> ????????? The error message under Windows seemed crudely 
>>>>>>>>>> similar but
>>>>>>>>>> different:
>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>> ??????????????? * Error: processing vignette 'sos.Rnw' failed 
>>>>>>>>>> with
>>>>>>>>>> diagnostics:
>>>>>>>>>> pdflatex is not available
>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>> ????????? What do you suggest?
>>>>>>>>>
>>>>>>>>> The virtual machines that run Github actions have lots of tools
>>>>>>>>> installed, but apparently not LaTeX.? So you need to figure out 
>>>>>>>>> the
>>>>>>>>> "step" to install it.? I'm not currently using Rnw with Github
>>>>>>>>> actions,
>>>>>>>>> but by looking at the README for
>>>>>>>>> https://github.com/r-lib/actions, I'm
>>>>>>>>> pretty sure all you need is to add
>>>>>>>>>
>>>>>>>>> ???? ? - uses: r-lib/actions/setup-tinytex at v1
>>>>>>>>>
>>>>>>>>> somewhere after
>>>>>>>>>
>>>>>>>>> ???? ? - uses: actions/checkout at master
>>>>>>>
>>>>>
>>>
>


From murdoch@dunc@n @end|ng |rom gm@||@com  Mon May 24 17:35:02 2021
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Mon, 24 May 2021 11:35:02 -0400
Subject: [R-pkg-devel] GitHub Action failed re-building 'sos.Rnw'
In-Reply-To: <aafa6c91-5b6a-85d7-9224-c413f7cc3b6a@effectivedefense.org>
References: <c081bdbd-b868-203e-5c6c-d99594368c84@effectivedefense.org>
 <22dc99e0-7f15-dfc6-65ad-05aa106c3873@gmail.com>
 <573846fd-2b56-2ceb-3f6a-08436bf82879@effectivedefense.org>
 <fac57f63-30a3-493b-a4df-a876e34af17f@gmail.com>
 <f05eb4f3-9844-db2b-5113-d510bf01b43b@effectivedefense.org>
 <9fa2cd7a-3ec6-eb88-f810-d54192afe767@gmail.com>
 <d3bfac9c-9c7a-2ec9-71fd-676ac0bf1335@effectivedefense.org>
 <347aed7a-78d0-9262-33e2-6d3175d50ba7@gmail.com>
 <e3d57838-a2ac-af8b-30d0-100acfde9387@effectivedefense.org>
 <d76b6c78-92c4-9583-4014-6309ba6aa35e@gmail.com>
 <aafa6c91-5b6a-85d7-9224-c413f7cc3b6a@effectivedefense.org>
Message-ID: <712ff25a-858f-d21c-7ea5-d4bf9d266577@gmail.com>

On 24/05/2021 10:17 a.m., Spencer Graves wrote:
> Hi, Duncan:
> 
> 
> 	  Thanks again.
> 
> 
> 	  I found XQuartz-2.8.1.dmg and added the 5 lines you suggested
> (modified to 2.8.1) to "R-CMD-check.yaml".  However, the "GitHub Action"
> status symbols disappeared, so I deleted them.
> 
> 
> 	  I copied the "CRAN" function from fda to sos and deleted the
> reference to fda from sos.
> 
> 
> 	  Now I'm getting, 'could not find function "CRAN"' in "processing
> vignette 'sos.Rnw'", even though CRAN is in the NAMESPACE for sos.
> 
> 
> 	  Suggestions?

This one is easy.  You use CRAN() before library(sos).

> 
> 
> 	  Thanks,
> 	  Spencer
> 
> 
> p.s.  To use Sys.getenv("NOT_CRAN"), I'd have to set the environment
> variable "NOT_CRAN" on all the test platforms other than CRAN, and
> that's a level of complexity I'd rather not get into.
I wouldn't call it "complex", but it could be tedious.

Duncan Murdoch


From ru@@e||-|enth @end|ng |rom u|ow@@edu  Tue May 25 22:52:28 2021
From: ru@@e||-|enth @end|ng |rom u|ow@@edu (Lenth, Russell V)
Date: Tue, 25 May 2021 20:52:28 +0000
Subject: [R-pkg-devel] Redirect error in .Rd file
Message-ID: <DM6PR04MB44746CA4EBF185A4C6FCE42EF1259@DM6PR04MB4474.namprd04.prod.outlook.com>

Hello package developers,

I just upgraded to R version 4.1.0, and now get a new error when I re-build my package. Among the messages about converting help files, I now get:

    ...
        update.emmGrid                          html  
    REDIRECT:topic	 levels<-.emmGrid -> update.emmGrid.html [ FAIL ]
    ...

But I don't see anything wrong. In my source code, I have ROxygen tags like this:

    #' @rdname update.emmGrid
    #' @export
    #' @param x an \code{emmGrid} object
    ...
    #' 
    "levels<-.emmGrid" = function(x, value) {
        update.emmGrid(x, levels = value)
    }

And the file update.emmGrid.Rd starts like this:

    % Generated by roxygen2: do not edit by hand
    % Please edit documentation in R/emmGrid-methods.R
    \name{update.emmGrid}
    \alias{update.emmGrid}
    \alias{levels<-.emmGrid}
    \title{Update an \code{emmGrid} object}
    \usage{
    \method{update}{emmGrid}(object, ..., silent = FALSE)

    \method{levels}{emmGrid}(x) <- value
    }
    ...

This all looks right to me. The help page documents both functions and shows parameters, details, and examples for both functions. If I ask for help for either function, it brings up this page. The only thing I see wrong is the message from building it. Any suggestions?


Russell V. Lenth? -? Professor Emeritus
Department of Statistics and Actuarial Science?? 
The University of Iowa ?-? Iowa City, IA 52242? USA?? 
Voice (319)335-0712 (Dept. office)? -? FAX (319)335-3017



From @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org  Tue May 25 23:06:25 2021
From: @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org (Spencer Graves)
Date: Tue, 25 May 2021 16:06:25 -0500
Subject: [R-pkg-devel] GitHub Action failed re-building 'sos.Rnw'
In-Reply-To: <712ff25a-858f-d21c-7ea5-d4bf9d266577@gmail.com>
References: <c081bdbd-b868-203e-5c6c-d99594368c84@effectivedefense.org>
 <22dc99e0-7f15-dfc6-65ad-05aa106c3873@gmail.com>
 <573846fd-2b56-2ceb-3f6a-08436bf82879@effectivedefense.org>
 <fac57f63-30a3-493b-a4df-a876e34af17f@gmail.com>
 <f05eb4f3-9844-db2b-5113-d510bf01b43b@effectivedefense.org>
 <9fa2cd7a-3ec6-eb88-f810-d54192afe767@gmail.com>
 <d3bfac9c-9c7a-2ec9-71fd-676ac0bf1335@effectivedefense.org>
 <347aed7a-78d0-9262-33e2-6d3175d50ba7@gmail.com>
 <e3d57838-a2ac-af8b-30d0-100acfde9387@effectivedefense.org>
 <d76b6c78-92c4-9583-4014-6309ba6aa35e@gmail.com>
 <aafa6c91-5b6a-85d7-9224-c413f7cc3b6a@effectivedefense.org>
 <712ff25a-858f-d21c-7ea5-d4bf9d266577@gmail.com>
Message-ID: <125a9262-7a71-8b4b-ea31-74641b9292b7@effectivedefense.org>

Hi, Duncan:


	  I apologize for bothering you with such an obvious thing as using 
"CRAN() before library(sos)".


	  Now I have another problem:  "zq <- ???spline(2)" now retrieves the 
default 100 pages, not the 2 requested.


	  I think the processing of "???" has changed between 4.0.3 and 4.1.0. 
  I've done "debug(`?`)" in both 4.0.3 and 4.1.0:  The condition 
(!is.call(topicExpr1) || length(topicExpr1) != 2 || topicExpr1[[1]] !=
     "?" || !is.call(topicExpr1[[2]]) || length(topicExpr1[[2]]) !=
     2 || topicExpr1[[2]][[1]] != "?") evaluates initially to FALSE in 
4.0.3 but TRUE in 4.1.0.


	  You graciously contributed that code several years ago when I changed 
the name of the package from RSiteSearch to sos, and it has worked 
wonderfully ... until now.  If you don't have time to look at this, I 
will try to understand it and fix it myself.  However, I really don't 
understand the code, and you certainly did when you wrote it ;-)


	  Thanks,
	  Spencer Graves


On 5/24/21 10:35 AM, Duncan Murdoch wrote:
> On 24/05/2021 10:17 a.m., Spencer Graves wrote:
>> Hi, Duncan:
>>
>>
>> ????? Thanks again.
>>
>>
>> ????? I found XQuartz-2.8.1.dmg and added the 5 lines you suggested
>> (modified to 2.8.1) to "R-CMD-check.yaml".? However, the "GitHub Action"
>> status symbols disappeared, so I deleted them.
>>
>>
>> ????? I copied the "CRAN" function from fda to sos and deleted the
>> reference to fda from sos.
>>
>>
>> ????? Now I'm getting, 'could not find function "CRAN"' in "processing
>> vignette 'sos.Rnw'", even though CRAN is in the NAMESPACE for sos.
>>
>>
>> ????? Suggestions?
> 
> This one is easy.? You use CRAN() before library(sos).
> 
>>
>>
>> ????? Thanks,
>> ????? Spencer
>>
>>
>> p.s.? To use Sys.getenv("NOT_CRAN"), I'd have to set the environment
>> variable "NOT_CRAN" on all the test platforms other than CRAN, and
>> that's a level of complexity I'd rather not get into.
> I wouldn't call it "complex", but it could be tedious.
> 
> Duncan Murdoch


From jon@th@n@g||||g@n @end|ng |rom gm@||@com  Wed May 26 23:12:39 2021
From: jon@th@n@g||||g@n @end|ng |rom gm@||@com (Jonathan Gilligan)
Date: Wed, 26 May 2021 16:12:39 -0500
Subject: [R-pkg-devel] Puzzling error from win-builder
Message-ID: <4e9a0f9d-f951-eeda-a4fa-bce2cee1fd18@gmail.com>

I have a puzzling error from win-builder for a package.

My package is https://github.com/jonathan-g/datafsm, also 
https://cran.r-project.org/web/packages/datafsm. I am preparing a 
bug-fix release to CRAN to fix an error that CRAN recently identified in 
the previous release of this package (see 
https://cran.r-project.org/web/checks/check_results_datafsm.html).

The package passes R CMD check with no errors or warnings, and one note 
(harmless) on win-builder for R-devel 
(https://win-builder.r-project.org/8mp9LN00YVw4/00check.log) and 
R-oldrelease 
(https://win-builder.r-project.org/1K21X458WtYt/00check.log), but for 
R-release, win-builder has two errors in running tests and building a 
vignette (https://win-builder.r-project.org/exK86Fkyir2s/00check.log), 
all of which say the CRAN caret package is not available for Windows x64:

> * checking for unstated dependencies in 'tests' ... OK
> * checking tests ...
> ** running tests for arch 'i386' ... [7s] OK
> ?? Running 'testthat.R' [6s]
> ** running tests for arch 'x64' ... [6s] ERROR
> ?? Running 'testthat.R' [6s]
> Running the tests in 'tests/testthat.R' failed.
> Complete output:
> ?? > library(testthat)
> ?? > library(datafsm)
> ?? >
> ?? > test_check("datafsm")
> ?? == Failed tests 
> ================================================================
> ?? -- Error (test_mainfunc.R:7:9): evolve_model() returns correct type 
> of object --
> ?? Error: DLL 'caret' not found: maybe not installed for this 
> architecture?
> ?? Backtrace:
> ?????? x
> ??? 1. +-datafsm::evolve_model(cdata, cv = FALSE) test_mainfunc.R:7:8
> ??? 2. \-base::loadNamespace(x)
> ??? 3.?? \-base::library.dynam(lib, package, package.lib)
> ?? -- Error (test_mainfunc.R:14:3): evolve_model() returns warnings 
> and errors ----
> ?? Error: DLL 'caret' not found: maybe not installed for this 
> architecture?
> ?? Backtrace:
> ?????? x
> ??? 1. +-testthat::expect_warning(evolve_model(cdata, cv = FALSE), 
> "did not supply a data.frame") test_mainfunc.R:14:2
> ??? 2. | \-testthat:::quasi_capture(enquo(object), label, 
> capture_warnings)
> ??? 3. |?? +-testthat:::.capture(...)
> ??? 4. |?? | \-base::withCallingHandlers(...)
> ??? 5. |?? \-rlang::eval_bare(quo_get_expr(.quo), quo_get_env(.quo))
> ??? 6. +-datafsm::evolve_model(cdata, cv = FALSE)
> ??? 7. \-base::loadNamespace(x)
> ??? 8.?? \-base::library.dynam(lib, package, package.lib)
> ?? ?? [ FAIL 2 | WARN 0 | SKIP 0 | PASS 3 ]
> ?? Error: Test failures
> ?? Execution halted
> * checking for unstated dependencies in vignettes ... OK
> * checking package vignettes in 'inst/doc' ... OK
> * checking re-building of vignette outputs ... [10s] WARNING
> Error(s) in re-building vignettes:
> --- re-building 'datafsm_introduction.Rmd' using rmarkdown
> Quitting from lines 173-175 (datafsm_introduction.Rmd)
> Error: processing vignette 'datafsm_introduction.Rmd' failed with 
> diagnostics:
> DLL 'caret' not found: maybe not installed for this architecture?
> --- failed re-building 'datafsm_introduction.Rmd'
>
> --- re-building 'FRD_vignette.Rmd' using rmarkdown_notangle
> --- finished re-building 'FRD_vignette.Rmd'
>
> SUMMARY: processing the following file failed:
> ?? 'datafsm_introduction.Rmd'
>
> Error: Vignette re-building failed.
> Execution halted

My package declares the "caret" package as an import in DESCRIPTION, so 
I am puzzled what this error from win-builder means and how to fix it. 
If R CMD check got this far, and installed the package for testing 
without reporting missing dependencies, why is it suddenly unable to use 
the caret package for testing the package, but only for the x64 
architecture? Is this something I am doing wrong, or is it a bug in 
win-builder?

Is anyone else finding problems with win-builder reporting errors about 
CRAN packages not being available?

For what it's worth, the package passes R CMD check with no errors or 
warnings or notes under GitHub actions (Windows, MacOS, and Ubuntu), on 
rhub (Debian, Fedora, Ubuntu, MacOS, and Windows except for R-devel 
under Windows, where R CMD check fails with a message about BioConductor 
not having binaries for R 4.2, even though my package doesn't use any 
BioConductor packages), and on my local Windows and Ubuntu boxes, so 
this seems to be a problem specific to R-release under win-builder.

If anyone has any suggestions for how I can fix this problem and submit 
the new release of my package to CRAN, I would be grateful.


From bbo|ker @end|ng |rom gm@||@com  Wed May 26 23:25:42 2021
From: bbo|ker @end|ng |rom gm@||@com (Ben Bolker)
Date: Wed, 26 May 2021 17:25:42 -0400
Subject: [R-pkg-devel] Puzzling error from win-builder
In-Reply-To: <4e9a0f9d-f951-eeda-a4fa-bce2cee1fd18@gmail.com>
References: <4e9a0f9d-f951-eeda-a4fa-bce2cee1fd18@gmail.com>
Message-ID: <bdf031fd-87fa-3ad4-2fd5-9ec7424a3361@gmail.com>

    Without thinking about it very much, my first guess would be that 
this is a transient problem on win-builder, i.e. the caret package is 
temporarily unavailable for some reason (e.g. because some update step 
hung); a new version of the package was published *fairly* recently 
(2021-05-15), although I would find my explanation more compelling if 
the update was more recent (and if the CRAN page for caret wasn't 
showing that the Windows binaries have all been updated to the current 
version).

   As a hackish way to explore this further, you could find a different 
CRAN package that depends on caret, edit the DESCRIPTION file to 
substitute your e-mail address as maintainer, and submit it to 
win-builder (if you don't edit the DESCRIPTION then the package 
maintainer, not you, will get the e-mail saying that the build is done; 
I don't know if this is allowed by win-builder rules but even if not it 
seems like a minor transgression).

On 5/26/21 5:12 PM, Jonathan Gilligan wrote:
> I have a puzzling error from win-builder for a package.
> 
> My package is https://github.com/jonathan-g/datafsm, also 
> https://cran.r-project.org/web/packages/datafsm. I am preparing a 
> bug-fix release to CRAN to fix an error that CRAN recently identified in 
> the previous release of this package (see 
> https://cran.r-project.org/web/checks/check_results_datafsm.html).
> 
> The package passes R CMD check with no errors or warnings, and one note 
> (harmless) on win-builder for R-devel 
> (https://win-builder.r-project.org/8mp9LN00YVw4/00check.log) and 
> R-oldrelease 
> (https://win-builder.r-project.org/1K21X458WtYt/00check.log), but for 
> R-release, win-builder has two errors in running tests and building a 
> vignette (https://win-builder.r-project.org/exK86Fkyir2s/00check.log), 
> all of which say the CRAN caret package is not available for Windows x64:
> 
>> * checking for unstated dependencies in 'tests' ... OK
>> * checking tests ...
>> ** running tests for arch 'i386' ... [7s] OK
>> ?? Running 'testthat.R' [6s]
>> ** running tests for arch 'x64' ... [6s] ERROR
>> ?? Running 'testthat.R' [6s]
>> Running the tests in 'tests/testthat.R' failed.
>> Complete output:
>> ?? > library(testthat)
>> ?? > library(datafsm)
>> ?? >
>> ?? > test_check("datafsm")
>> ?? == Failed tests 
>> ================================================================
>> ?? -- Error (test_mainfunc.R:7:9): evolve_model() returns correct type 
>> of object --
>> ?? Error: DLL 'caret' not found: maybe not installed for this 
>> architecture?
>> ?? Backtrace:
>> ?????? x
>> ??? 1. +-datafsm::evolve_model(cdata, cv = FALSE) test_mainfunc.R:7:8
>> ??? 2. \-base::loadNamespace(x)
>> ??? 3.?? \-base::library.dynam(lib, package, package.lib)
>> ?? -- Error (test_mainfunc.R:14:3): evolve_model() returns warnings 
>> and errors ----
>> ?? Error: DLL 'caret' not found: maybe not installed for this 
>> architecture?
>> ?? Backtrace:
>> ?????? x
>> ??? 1. +-testthat::expect_warning(evolve_model(cdata, cv = FALSE), 
>> "did not supply a data.frame") test_mainfunc.R:14:2
>> ??? 2. | \-testthat:::quasi_capture(enquo(object), label, 
>> capture_warnings)
>> ??? 3. |?? +-testthat:::.capture(...)
>> ??? 4. |?? | \-base::withCallingHandlers(...)
>> ??? 5. |?? \-rlang::eval_bare(quo_get_expr(.quo), quo_get_env(.quo))
>> ??? 6. +-datafsm::evolve_model(cdata, cv = FALSE)
>> ??? 7. \-base::loadNamespace(x)
>> ??? 8.?? \-base::library.dynam(lib, package, package.lib)
>> ?? ?? [ FAIL 2 | WARN 0 | SKIP 0 | PASS 3 ]
>> ?? Error: Test failures
>> ?? Execution halted
>> * checking for unstated dependencies in vignettes ... OK
>> * checking package vignettes in 'inst/doc' ... OK
>> * checking re-building of vignette outputs ... [10s] WARNING
>> Error(s) in re-building vignettes:
>> --- re-building 'datafsm_introduction.Rmd' using rmarkdown
>> Quitting from lines 173-175 (datafsm_introduction.Rmd)
>> Error: processing vignette 'datafsm_introduction.Rmd' failed with 
>> diagnostics:
>> DLL 'caret' not found: maybe not installed for this architecture?
>> --- failed re-building 'datafsm_introduction.Rmd'
>>
>> --- re-building 'FRD_vignette.Rmd' using rmarkdown_notangle
>> --- finished re-building 'FRD_vignette.Rmd'
>>
>> SUMMARY: processing the following file failed:
>> ?? 'datafsm_introduction.Rmd'
>>
>> Error: Vignette re-building failed.
>> Execution halted
> 
> My package declares the "caret" package as an import in DESCRIPTION, so 
> I am puzzled what this error from win-builder means and how to fix it. 
> If R CMD check got this far, and installed the package for testing 
> without reporting missing dependencies, why is it suddenly unable to use 
> the caret package for testing the package, but only for the x64 
> architecture? Is this something I am doing wrong, or is it a bug in 
> win-builder?
> 
> Is anyone else finding problems with win-builder reporting errors about 
> CRAN packages not being available?
> 
> For what it's worth, the package passes R CMD check with no errors or 
> warnings or notes under GitHub actions (Windows, MacOS, and Ubuntu), on 
> rhub (Debian, Fedora, Ubuntu, MacOS, and Windows except for R-devel 
> under Windows, where R CMD check fails with a message about BioConductor 
> not having binaries for R 4.2, even though my package doesn't use any 
> BioConductor packages), and on my local Windows and Ubuntu boxes, so 
> this seems to be a problem specific to R-release under win-builder.
> 
> If anyone has any suggestions for how I can fix this problem and submit 
> the new release of my package to CRAN, I would be grateful.
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From m@e@e005 @end|ng |rom umn@edu  Thu May 27 04:23:11 2021
From: m@e@e005 @end|ng |rom umn@edu (Danielle Maeser)
Date: Wed, 26 May 2021 21:23:11 -0500
Subject: [R-pkg-devel] What To Include In \donttest{}
Message-ID: <CA+YOmB9vYNxvo3ZMY0D6=-h1o6iveywb2pf8D6x-JXytbFqhTw@mail.gmail.com>

Hello,

Please excuse the very simple question, but I received the following
message from a CRAN maintainer, and I am not sure what code to include
inside of the \donttest{}. This is meant to enclose code that typically
should be run, but not during package checking, and I do not have any such
code.

Here is the message from the CRAN maintainter:




*Please add small executable examples in your Rd-files to illustrate theuse
of the exported function but also enable automatic testing.Otherwise, you
can also write some tests. Lengthy examples (> 5 sec) canbe wrapped in
\donttest{}.*

I'd appreciate any assistance you can provide.

-- 
Ph.D. Student
Bioinformatics and Computational Biology
University of Minnesota

	[[alternative HTML version deleted]]


From edd @end|ng |rom deb|@n@org  Thu May 27 04:37:02 2021
From: edd @end|ng |rom deb|@n@org (Dirk Eddelbuettel)
Date: Wed, 26 May 2021 21:37:02 -0500
Subject: [R-pkg-devel] What To Include In \donttest{}
In-Reply-To: <CA+YOmB9vYNxvo3ZMY0D6=-h1o6iveywb2pf8D6x-JXytbFqhTw@mail.gmail.com>
References: <CA+YOmB9vYNxvo3ZMY0D6=-h1o6iveywb2pf8D6x-JXytbFqhTw@mail.gmail.com>
Message-ID: <24751.1486.275005.474592@rob.eddelbuettel.com>


Danielle,

On 26 May 2021 at 21:23, Danielle Maeser wrote:
| Please excuse the very simple question, but I received the following
| message from a CRAN maintainer, and I am not sure what code to include
| inside of the \donttest{}. This is meant to enclose code that typically
| should be run, but not during package checking, and I do not have any such
| code.
| 
| Here is the message from the CRAN maintainter:
| 
| *Please add small executable examples in your Rd-files to illustrate theuse
| of the exported function but also enable automatic testing.Otherwise, you
| can also write some tests. Lengthy examples (> 5 sec) canbe wrapped in
| \donttest{}.*
| 
| I'd appreciate any assistance you can provide.

The quote contains three distinct sentences--with three distinct messages:

  1. Please add examples, for both illustration and tests.
  2. You can also add tests directly (i.e. via directory tests/)
  3. Should examples run long, consider wrapping them in \donttest{}

We can narrow this down to 'please add examples'.

(Otherwise, a good trick is to search at GitHub in the (unofficial,
contributed) cran organization (mirroring CRAN) for terms you are interested
in, here "\donttest" -- and this link claims 11k hits
  https://github.com/search?q=org%3Acran+%5Cdonttest&type=code
you can probably browse a few of these to get an idea.

Hope this helps,  Dirk

-- 
https://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From th|erry@denoeux @end|ng |rom utc@|r  Thu May 27 04:53:28 2021
From: th|erry@denoeux @end|ng |rom utc@|r (Thierry Denoeux)
Date: Thu, 27 May 2021 09:53:28 +0700
Subject: [R-pkg-devel] New version of 'evlust' package no longer passes
 incoming checks after ony very minor change
Message-ID: <D2B03D95-ADBA-4520-9E4A-B028FCB16553@utc.fr>

Dear all,

Two weeks ago, I successfully uploaded version 2.01 of package ?evclust? on the CRAN website. Earlier this week I received a message telling me that a problem had been detected in the Linux-based checks for r-devel. The error message was:

> print(opt$par,opt$value)
    Error in print.default(opt$par, opt$value) : invalid printing digits 0
    Calls: print -> print.default
    Execution halted 

It was easily fixed by replacing the faulty instruction 'print(opt$par,opt$value)? by ?print(c(opt$par,opt$value))?. This is the only change I made in the code. After resubmitting the new version 2.02, I now have a completely different error:

---
Flavor: r-devel-windows-ix86+x86_64
Check: package dependencies, Result: NOTE
 Package suggested but not available for checking: 'kernlab'

Flavor: r-devel-windows-ix86+x86_64
Check: whether package can be installed, Result: ERROR
 Installation failed.
 See 'd:/RCompile/CRANincoming/R-devel/evclust.Rcheck/00install.out' for details.
---

The file ?00install.out' contains this:

?
* installing *source* package 'evclust' ...
** using staged installation
** R
** data
*** moving datasets to lazyload DB
** inst
** byte-compile and prepare package for lazy loading
Error in loadNamespace(j <- i[[1L]], c(lib.loc, .libPaths()), versionCheck = vI[[j]]) : 
  there is no package called 'Rcpp'
Calls: <Anonymous> ... loadNamespace -> withRestarts -> withOneRestart -> doWithOneRestart
Execution halted
ERROR: lazy loading failed for package 'evclust'
* removing 'd:/RCompile/CRANincoming/R-devel/lib/evclust?
?

Why is package ?kernalb? no longer available for checking? Is this the cause of the error? And what is that package ?Rcpp? mentioned in the ?00install.out? file ? (there is no mention of such package in my code).

I don?t have a clue how I could fix this error. Any help would be greatly appreciated!

Best regards,

Thierry



----------
Prof. Thierry Denoeux
Universit? de technologie de Compi?gne
Institut universitaire de France
Rue Roger Couttolenc, CS 60319
60203 Compi?gne cedex, France
https://www.hds.utc.fr/~tdenoeux


From m@e@e005 @end|ng |rom umn@edu  Thu May 27 06:10:13 2021
From: m@e@e005 @end|ng |rom umn@edu (Danielle Maeser)
Date: Wed, 26 May 2021 23:10:13 -0500
Subject: [R-pkg-devel] What To Include In \donttest{}
In-Reply-To: <24751.1486.275005.474592@rob.eddelbuettel.com>
References: <CA+YOmB9vYNxvo3ZMY0D6=-h1o6iveywb2pf8D6x-JXytbFqhTw@mail.gmail.com>
 <24751.1486.275005.474592@rob.eddelbuettel.com>
Message-ID: <CA+YOmB9TjbEnqNAb6MNdCO2jSG8J-vx+XXmiZ2jxcqXUzFx0og@mail.gmail.com>

Thank you for your assistance. The link is very helpful.

However, I am still not sure what the difference is between the example
provided with \donttest{} and a vignette. It seems both display an example
of the function. For instance: the example below seems not too different
from a vignette:

\donttest{
name_of_function(parameters...)
}

Additionally, in order to set the parameters for this example in
\donttest{}, it seems I must include data for this function inside of the
man folder, which seems odd. I thought CRAN would ignore whatever code is
provided in \donttest{} (therefore, I wouldn't have to provide the data
here); however, the CRAN check complains that it does not know what these
parameters are (aka object 'parameters' is not known).

I'd appreciate any assistance you can provide.



On Wed, May 26, 2021 at 9:37 PM Dirk Eddelbuettel <edd at debian.org> wrote:

>
> Danielle,
>
> On 26 May 2021 at 21:23, Danielle Maeser wrote:
> | Please excuse the very simple question, but I received the following
> | message from a CRAN maintainer, and I am not sure what code to include
> | inside of the \donttest{}. This is meant to enclose code that typically
> | should be run, but not during package checking, and I do not have any
> such
> | code.
> |
> | Here is the message from the CRAN maintainter:
> |
> | *Please add small executable examples in your Rd-files to illustrate
> theuse
> | of the exported function but also enable automatic testing.Otherwise, you
> | can also write some tests. Lengthy examples (> 5 sec) canbe wrapped in
> | \donttest{}.*
> |
> | I'd appreciate any assistance you can provide.
>
> The quote contains three distinct sentences--with three distinct messages:
>
>   1. Please add examples, for both illustration and tests.
>   2. You can also add tests directly (i.e. via directory tests/)
>   3. Should examples run long, consider wrapping them in \donttest{}
>
> We can narrow this down to 'please add examples'.
>
> (Otherwise, a good trick is to search at GitHub in the (unofficial,
> contributed) cran organization (mirroring CRAN) for terms you are
> interested
> in, here "\donttest" -- and this link claims 11k hits
>   https://github.com/search?q=org%3Acran+%5Cdonttest&type=code
> you can probably browse a few of these to get an idea.
>
> Hope this helps,  Dirk
>
> --
> https://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org
>


-- 
Ph.D. Student
Bioinformatics and Computational Biology
University of Minnesota

	[[alternative HTML version deleted]]


From deep@y@n@@@rk@r @end|ng |rom gm@||@com  Thu May 27 07:07:36 2021
From: deep@y@n@@@rk@r @end|ng |rom gm@||@com (Deepayan Sarkar)
Date: Thu, 27 May 2021 10:37:36 +0530
Subject: [R-pkg-devel] Redirect error in .Rd file
In-Reply-To: <DM6PR04MB44746CA4EBF185A4C6FCE42EF1259@DM6PR04MB4474.namprd04.prod.outlook.com>
References: <DM6PR04MB44746CA4EBF185A4C6FCE42EF1259@DM6PR04MB4474.namprd04.prod.outlook.com>
Message-ID: <CADfFDC7+cHeG48DRF=tUhWmkZJHqLz99XcQu+Ko_3X2M5g4sZQ@mail.gmail.com>

On Wed, May 26, 2021 at 2:23 AM Lenth, Russell V
<russell-lenth at uiowa.edu> wrote:
>
> Hello package developers,
>
> I just upgraded to R version 4.1.0, and now get a new error when I re-build my package. Among the messages about converting help files, I now get:
>
>     ...
>         update.emmGrid                          html
>     REDIRECT:topic       levels<-.emmGrid -> update.emmGrid.html [ FAIL ]
>     ...
>
> But I don't see anything wrong. In my source code, I have ROxygen tags like this:

You can ignore this; the message just tells you that an attempt to
create a file named "levels<-.emmGrid.html" has failed (because < is
not allowed in file names in Windows).

This will not impact anything _unless_ another package has a
documentation link of the form \link[pkg:levels<-.emmGrid], in which
case the link will fail (but only for static HTML help, which is
rarely used any more).

Best,
-Deepayan

>     #' @rdname update.emmGrid
>     #' @export
>     #' @param x an \code{emmGrid} object
>     ...
>     #'
>     "levels<-.emmGrid" = function(x, value) {
>         update.emmGrid(x, levels = value)
>     }
>
> And the file update.emmGrid.Rd starts like this:
>
>     % Generated by roxygen2: do not edit by hand
>     % Please edit documentation in R/emmGrid-methods.R
>     \name{update.emmGrid}
>     \alias{update.emmGrid}
>     \alias{levels<-.emmGrid}
>     \title{Update an \code{emmGrid} object}
>     \usage{
>     \method{update}{emmGrid}(object, ..., silent = FALSE)
>
>     \method{levels}{emmGrid}(x) <- value
>     }
>     ...
>
> This all looks right to me. The help page documents both functions and shows parameters, details, and examples for both functions. If I ask for help for either function, it brings up this page. The only thing I see wrong is the message from building it. Any suggestions?
>
>
> Russell V. Lenth  -  Professor Emeritus
> Department of Statistics and Actuarial Science
> The University of Iowa  -  Iowa City, IA 52242  USA
> Voice (319)335-0712 (Dept. office)  -  FAX (319)335-3017
>
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From |uc@r @end|ng |rom |edor@project@org  Thu May 27 10:07:28 2021
From: |uc@r @end|ng |rom |edor@project@org (=?UTF-8?Q?I=C3=B1aki_Ucar?=)
Date: Thu, 27 May 2021 10:07:28 +0200
Subject: [R-pkg-devel] What To Include In \donttest{}
In-Reply-To: <CA+YOmB9TjbEnqNAb6MNdCO2jSG8J-vx+XXmiZ2jxcqXUzFx0og@mail.gmail.com>
References: <CA+YOmB9vYNxvo3ZMY0D6=-h1o6iveywb2pf8D6x-JXytbFqhTw@mail.gmail.com>
 <24751.1486.275005.474592@rob.eddelbuettel.com>
 <CA+YOmB9TjbEnqNAb6MNdCO2jSG8J-vx+XXmiZ2jxcqXUzFx0og@mail.gmail.com>
Message-ID: <CALEXWq38tKQ7L-VYNkQXS4EjnR4TvLXzL31pv_daFWw6-ATOrw@mail.gmail.com>

On Thu, 27 May 2021 at 06:10, Danielle Maeser <maese005 at umn.edu> wrote:
>
> Thank you for your assistance. The link is very helpful.
>
> However, I am still not sure what the difference is between the example
> provided with \donttest{} and a vignette. It seems both display an example
> of the function. For instance: the example below seems not too different
> from a vignette:
>
> \donttest{
> name_of_function(parameters...)
> }

Vignettes constitute a complex form of documentation in which you
provide use cases, and thus demonstrate the interrelation between
several functions in your package to solve them with a lot of context.
Examples in the manual are very short and focused, and show how to run
a particular function in a minimal setup, usually without much
context. And you shouldn't use \donttest in general, unless a
particular example needs a long time to run.

CRAN is simply asking you to add examples in your manual pages for all
the functions in your package.

> Additionally, in order to set the parameters for this example in
> \donttest{}, it seems I must include data for this function inside of the
> man folder, which seems odd. I thought CRAN would ignore whatever code is
> provided in \donttest{} (therefore, I wouldn't have to provide the data
> here); however, the CRAN check complains that it does not know what these
> parameters are (aka object 'parameters' is not known).

All the examples must be runable and must succeed, even those enclosed
in \donttest. If your functions require some data to run, then the
most sensible thing to do is to include a small sample of data in your
package that you can then use in your examples. See "1.1.6 Data in
packages" in the "Writing R Exensions" manual on how to do this.

I?aki

> On Wed, May 26, 2021 at 9:37 PM Dirk Eddelbuettel <edd at debian.org> wrote:
>
> >
> > Danielle,
> >
> > On 26 May 2021 at 21:23, Danielle Maeser wrote:
> > | Please excuse the very simple question, but I received the following
> > | message from a CRAN maintainer, and I am not sure what code to include
> > | inside of the \donttest{}. This is meant to enclose code that typically
> > | should be run, but not during package checking, and I do not have any
> > such
> > | code.
> > |
> > | Here is the message from the CRAN maintainter:
> > |
> > | *Please add small executable examples in your Rd-files to illustrate
> > theuse
> > | of the exported function but also enable automatic testing.Otherwise, you
> > | can also write some tests. Lengthy examples (> 5 sec) canbe wrapped in
> > | \donttest{}.*
> > |
> > | I'd appreciate any assistance you can provide.
> >
> > The quote contains three distinct sentences--with three distinct messages:
> >
> >   1. Please add examples, for both illustration and tests.
> >   2. You can also add tests directly (i.e. via directory tests/)
> >   3. Should examples run long, consider wrapping them in \donttest{}
> >
> > We can narrow this down to 'please add examples'.
> >
> > (Otherwise, a good trick is to search at GitHub in the (unofficial,
> > contributed) cran organization (mirroring CRAN) for terms you are
> > interested
> > in, here "\donttest" -- and this link claims 11k hits
> >   https://github.com/search?q=org%3Acran+%5Cdonttest&type=code
> > you can probably browse a few of these to get an idea.
> >
> > Hope this helps,  Dirk
> >
> > --
> > https://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org
> >
>
>
> --
> Ph.D. Student
> Bioinformatics and Computational Biology
> University of Minnesota
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel



-- 
I?aki ?car


From |uc@r @end|ng |rom |edor@project@org  Thu May 27 10:15:37 2021
From: |uc@r @end|ng |rom |edor@project@org (=?UTF-8?Q?I=C3=B1aki_Ucar?=)
Date: Thu, 27 May 2021 10:15:37 +0200
Subject: [R-pkg-devel] New version of 'evlust' package no longer passes
 incoming checks after ony very minor change
In-Reply-To: <D2B03D95-ADBA-4520-9E4A-B028FCB16553@utc.fr>
References: <D2B03D95-ADBA-4520-9E4A-B028FCB16553@utc.fr>
Message-ID: <CALEXWq3+LxxjLRXSXPS2H0vC6Z+p16F6Ni=fLVfXA7DOJs9DkQ@mail.gmail.com>

On Thu, 27 May 2021 at 04:54, Thierry Denoeux <thierry.denoeux at utc.fr> wrote:
>
> Dear all,
>
> Two weeks ago, I successfully uploaded version 2.01 of package ?evclust? on the CRAN website. Earlier this week I received a message telling me that a problem had been detected in the Linux-based checks for r-devel. The error message was:
>
> > print(opt$par,opt$value)
>     Error in print.default(opt$par, opt$value) : invalid printing digits 0
>     Calls: print -> print.default
>     Execution halted
>
> It was easily fixed by replacing the faulty instruction 'print(opt$par,opt$value)? by ?print(c(opt$par,opt$value))?. This is the only change I made in the code. After resubmitting the new version 2.02, I now have a completely different error:
>
> ---
> Flavor: r-devel-windows-ix86+x86_64
> Check: package dependencies, Result: NOTE
>  Package suggested but not available for checking: 'kernlab'
>
> Flavor: r-devel-windows-ix86+x86_64
> Check: whether package can be installed, Result: ERROR
>  Installation failed.
>  See 'd:/RCompile/CRANincoming/R-devel/evclust.Rcheck/00install.out' for details.
> ---
>
> The file ?00install.out' contains this:
>
> ?
> * installing *source* package 'evclust' ...
> ** using staged installation
> ** R
> ** data
> *** moving datasets to lazyload DB
> ** inst
> ** byte-compile and prepare package for lazy loading
> Error in loadNamespace(j <- i[[1L]], c(lib.loc, .libPaths()), versionCheck = vI[[j]]) :
>   there is no package called 'Rcpp'
> Calls: <Anonymous> ... loadNamespace -> withRestarts -> withOneRestart -> doWithOneRestart
> Execution halted
> ERROR: lazy loading failed for package 'evclust'
> * removing 'd:/RCompile/CRANincoming/R-devel/lib/evclust?
> ?
>
> Why is package ?kernalb? no longer available for checking? Is this the cause of the error?

Errors about missing packages that you see on CRAN are temporary
problems due to an inconsistent state in some builder, not your fault.
I assume you received this in an automated message. Just reply
pointing to the problem and asking for a re-check.

> And what is that package ?Rcpp? mentioned in the ?00install.out? file ? (there is no mention of such package in my code).

Same issue here. This time, you import plyr, plyr imports Rcpp.

I?aki

>
> I don?t have a clue how I could fix this error. Any help would be greatly appreciated!
>
> Best regards,
>
> Thierry
>
>
>
> ----------
> Prof. Thierry Denoeux
> Universit? de technologie de Compi?gne
> Institut universitaire de France
> Rue Roger Couttolenc, CS 60319
> 60203 Compi?gne cedex, France
> https://www.hds.utc.fr/~tdenoeux
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel



-- 
I?aki ?car


From hugh@p@r@on@ge @end|ng |rom gm@||@com  Wed Jun  2 03:01:37 2021
From: hugh@p@r@on@ge @end|ng |rom gm@||@com (Hugh Parsonage)
Date: Wed, 2 Jun 2021 11:01:37 +1000
Subject: [R-pkg-devel] Valgrind warning: invalid size of 4,
 is it due to a simple overrun?
Message-ID: <CAJmOi+P+345JTPLrX0N-=MwNzeXc+wMwkv+JiVdUZtjJEdR8Gg@mail.gmail.com>

Hello,

I received a valgrind warning about my package, hutilscpp, from CRAN
(thank you).  I believe I've tracked down and fixed the problem, but I
wasn't able to reproduce the error on rhub (including with
--leak-check=full etc) so I'd like to know if I'm missing something.

The valgrind warning is "Invalid write of size 4" and refers to this
line https://github.com/HughParsonage/hutilscpp/blob/508f134b3f388653985eca372ed5f4f8b8eb3471/src/Cwhich_even.c#L43

the context for this line is:

const double * xp = REAL(xx);
for (R_xlen_t i = 0, j = 0; i < N; ++i) {
  int is_even = R_finite(xp[i]) && (fmod(xp[i], 2) == 0);
  ansp[j] = (int)(i + 1);        // # <-------- line 43
  j += is_even;
}

where ansp is a pointer to an integer vector whose length is the
number of "even" doubles in xx.  I can see that the problem arises
when the last even number occurs before the end of the vector xx, at
which point j == length(ansp), yet the loop continues.  I've amended
the i < N in the for loop to (i < N && j < n_even) which I believe is
sufficient, but obviously I thought it was ok before.

I'd rather not resubmit only to discover that I've overlooked something else.

As a supplementary question, does the valgrind check depend on the
runtime values in the test suite or does it perform fuzz testing?  In
other words, do I need to add tests to reproduce?

Best,


Hugh.


From m@e@e005 @end|ng |rom umn@edu  Wed Jun  2 06:39:43 2021
From: m@e@e005 @end|ng |rom umn@edu (Danielle Maeser)
Date: Tue, 1 Jun 2021 23:39:43 -0500
Subject: [R-pkg-devel] \donttest{} and writing outputs to tempdir()
Message-ID: <CA+YOmB_eS1yax7jE0h0JBM2_f9DZuFUMawZ+LNHuyuhMvX8zWw@mail.gmail.com>

Hello,

I received the following comments from a CRAN maintainer, and I don't
understand why they were an issue. I'd appreciate any insight you can
provide.

Danielle







*All your examples are wrapped in \donttest{} and therefore do not
gettested.Please unwrap the examples if that is feasible and if they can
beexecuted in < 5 sec for each Rd file or create additionally small
toyexamples to allow automatic testing.*

I don't think I can unwrap the examples in \donttest{} because they cannot
be executed in <5 seconds for each Rd file, and the automatic testing of
toy data is satisfied in the vignettes I provide for each function.
Therefore, I am not sure what change to make here.




*Please ensure that your functions do not write by default or in
yourexamples/vignettes/tests in the user's home filespace (including
thepackage directory and getwd()). This is not allowed by CRAN policies.In
your examples/vignettes/tests you can write to tempdir().*

Additionally, all of my vignettes write the output of each function to
tempdir(). Therefore, I am not sure why this is a problem.
-- 
Ph.D. Student
Bioinformatics and Computational Biology
University of Minnesota

	[[alternative HTML version deleted]]


From hugh@p@r@on@ge @end|ng |rom gm@||@com  Wed Jun  2 07:16:36 2021
From: hugh@p@r@on@ge @end|ng |rom gm@||@com (Hugh Parsonage)
Date: Wed, 2 Jun 2021 15:16:36 +1000
Subject: [R-pkg-devel] \donttest{} and writing outputs to tempdir()
In-Reply-To: <CA+YOmB_eS1yax7jE0h0JBM2_f9DZuFUMawZ+LNHuyuhMvX8zWw@mail.gmail.com>
References: <CA+YOmB_eS1yax7jE0h0JBM2_f9DZuFUMawZ+LNHuyuhMvX8zWw@mail.gmail.com>
Message-ID: <CAJmOi+PXY1Hm8aDBkyxd6Yo0MHeMf37cX60XzxQk-KJ-GZ4f+g@mail.gmail.com>

Are you able to provide a link to your package?  It's a bit hard to
guess what's causing your examples etc to have these problems.

On Wed, 2 Jun 2021 at 14:40, Danielle Maeser <maese005 at umn.edu> wrote:
>
> Hello,
>
> I received the following comments from a CRAN maintainer, and I don't
> understand why they were an issue. I'd appreciate any insight you can
> provide.
>
> Danielle
>
>
>
>
>
>
>
> *All your examples are wrapped in \donttest{} and therefore do not
> gettested.Please unwrap the examples if that is feasible and if they can
> beexecuted in < 5 sec for each Rd file or create additionally small
> toyexamples to allow automatic testing.*
>
> I don't think I can unwrap the examples in \donttest{} because they cannot
> be executed in <5 seconds for each Rd file, and the automatic testing of
> toy data is satisfied in the vignettes I provide for each function.
> Therefore, I am not sure what change to make here.
>
>
>
>
> *Please ensure that your functions do not write by default or in
> yourexamples/vignettes/tests in the user's home filespace (including
> thepackage directory and getwd()). This is not allowed by CRAN policies.In
> your examples/vignettes/tests you can write to tempdir().*
>
> Additionally, all of my vignettes write the output of each function to
> tempdir(). Therefore, I am not sure why this is a problem.
> --
> Ph.D. Student
> Bioinformatics and Computational Biology
> University of Minnesota
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Wed Jun  2 07:29:01 2021
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Tue, 01 Jun 2021 22:29:01 -0700
Subject: [R-pkg-devel] \donttest{} and writing outputs to tempdir()
In-Reply-To: <CA+YOmB_eS1yax7jE0h0JBM2_f9DZuFUMawZ+LNHuyuhMvX8zWw@mail.gmail.com>
References: <CA+YOmB_eS1yax7jE0h0JBM2_f9DZuFUMawZ+LNHuyuhMvX8zWw@mail.gmail.com>
Message-ID: <0581FB9D-ECD8-42A3-B0D7-8E38A113BB61@dcn.davis.ca.us>

Make examples shorter so they can run faster. Wrapping everything in donttest means that running examples() does nothing, which is counterproductive.

Techinically, vignettes are not tests or examples... but they do have the advantage that they don't have to run quickly. But that doesn't make a vignette a substitute for either examples or tests.

As for writing to the wrong place, you should probably just double check. 

On June 1, 2021 9:39:43 PM PDT, Danielle Maeser <maese005 at umn.edu> wrote:
>Hello,
>
>I received the following comments from a CRAN maintainer, and I don't
>understand why they were an issue. I'd appreciate any insight you can
>provide.
>
>Danielle
>
>
>
>
>
>
>
>*All your examples are wrapped in \donttest{} and therefore do not
>gettested.Please unwrap the examples if that is feasible and if they
>can
>beexecuted in < 5 sec for each Rd file or create additionally small
>toyexamples to allow automatic testing.*
>
>I don't think I can unwrap the examples in \donttest{} because they
>cannot
>be executed in <5 seconds for each Rd file, and the automatic testing
>of
>toy data is satisfied in the vignettes I provide for each function.
>Therefore, I am not sure what change to make here.
>
>
>
>
>*Please ensure that your functions do not write by default or in
>yourexamples/vignettes/tests in the user's home filespace (including
>thepackage directory and getwd()). This is not allowed by CRAN
>policies.In
>your examples/vignettes/tests you can write to tempdir().*
>
>Additionally, all of my vignettes write the output of each function to
>tempdir(). Therefore, I am not sure why this is a problem.

-- 
Sent from my phone. Please excuse my brevity.


From krzb@r @end|ng |rom protonm@||@ch  Wed Jun  2 12:17:12 2021
From: krzb@r @end|ng |rom protonm@||@ch (Krzysztof Bartoszek)
Date: Wed, 02 Jun 2021 10:17:12 +0000
Subject: [R-pkg-devel] problem with submitting to CRAN (windows)
Message-ID: <j8f36bZnehgNAAj2UFCc8jK7wT0lVx0udA_8uE_EzmkJbnJlZB4jIcPb4-fEpMhzz3MXCooCHcz89ZLA1RfYW3zAZedSpYmY2HZyDN_udlk=@protonmail.ch>

Dear all,
I am trying to submit an update of my mvSLOUCH package to CRAN an am getting the following problem from the automatic pretest:
Dear maintainer,

package mvSLOUCH_2.6.5.tar.gz does not pass (yesterday and today) the incoming checks automatically, please see the following pre-tests:
Windows: <https://win-builder.r-project.org/incoming_pretest/mvSLOUCH_2.6.5_20210602_103000/Windows/00check.log>
Status: 1 ERROR
Debian: <https://win-builder.r-project.org/incoming_pretest/mvSLOUCH_2.6.5_20210602_103000/Debian/00check.log>
Status: OK

The windows error in https://win-builder.r-project.org/incoming_pretest/mvSLOUCH_2.6.5_20210602_103000/Windows/00install.out
is
** byte-compile and prepare package for lazy loading
Error: object 'combinations' is not exported by 'namespace:gtools'
Execution halted
ERROR: lazy loading failed for package 'mvSLOUCH'

Interestingly when I today submited to winbuilder (devel) no such issues are raised (yesterday the same issue was raised by winbuilder-devel):
https://win-builder.r-project.org/Ou1tDLkY8HVB/

It feels a bit strange that this package dependency fails only for Windows, especially as neither mvSLOUCH nor any of the packages it imports from depend on gtools.

I would be very grateful for assistance.

Best wishes
Krzysztof Bartoszek

Sent with ProtonMail Secure Email.
	[[alternative HTML version deleted]]


From hugh@p@r@on@ge @end|ng |rom gm@||@com  Wed Jun  2 12:25:13 2021
From: hugh@p@r@on@ge @end|ng |rom gm@||@com (Hugh Parsonage)
Date: Wed, 2 Jun 2021 20:25:13 +1000
Subject: [R-pkg-devel] problem with submitting to CRAN (windows)
In-Reply-To: <j8f36bZnehgNAAj2UFCc8jK7wT0lVx0udA_8uE_EzmkJbnJlZB4jIcPb4-fEpMhzz3MXCooCHcz89ZLA1RfYW3zAZedSpYmY2HZyDN_udlk=@protonmail.ch>
References: <j8f36bZnehgNAAj2UFCc8jK7wT0lVx0udA_8uE_EzmkJbnJlZB4jIcPb4-fEpMhzz3MXCooCHcz89ZLA1RfYW3zAZedSpYmY2HZyDN_udlk=@protonmail.ch>
Message-ID: <CAJmOi+MZgQjdfiGPWd52u+3D8UfDQ9EZNV1Cb_qjQMLyMoD+dA@mail.gmail.com>

Probably a consequence of gtools having build errors
(https://cran.r-project.org/web/checks/check_results_gtools.html)

I'd recommend reconsidering use of the package until the problems are
resolved.  In the meantime, put gtools is Suggests for the use of
combinations().  Note the base R functions choose and combn that might
be sufficient (and certainly more available).

On Wed, 2 Jun 2021 at 20:17, Krzysztof Bartoszek <krzbar at protonmail.ch> wrote:
>
> Dear all,
> I am trying to submit an update of my mvSLOUCH package to CRAN an am getting the following problem from the automatic pretest:
> Dear maintainer,
>
> package mvSLOUCH_2.6.5.tar.gz does not pass (yesterday and today) the incoming checks automatically, please see the following pre-tests:
> Windows: <https://win-builder.r-project.org/incoming_pretest/mvSLOUCH_2.6.5_20210602_103000/Windows/00check.log>
> Status: 1 ERROR
> Debian: <https://win-builder.r-project.org/incoming_pretest/mvSLOUCH_2.6.5_20210602_103000/Debian/00check.log>
> Status: OK
>
> The windows error in https://win-builder.r-project.org/incoming_pretest/mvSLOUCH_2.6.5_20210602_103000/Windows/00install.out
> is
> ** byte-compile and prepare package for lazy loading
> Error: object 'combinations' is not exported by 'namespace:gtools'
> Execution halted
> ERROR: lazy loading failed for package 'mvSLOUCH'
>
> Interestingly when I today submited to winbuilder (devel) no such issues are raised (yesterday the same issue was raised by winbuilder-devel):
> https://win-builder.r-project.org/Ou1tDLkY8HVB/
>
> It feels a bit strange that this package dependency fails only for Windows, especially as neither mvSLOUCH nor any of the packages it imports from depend on gtools.
>
> I would be very grateful for assistance.
>
> Best wishes
> Krzysztof Bartoszek
>
> Sent with ProtonMail Secure Email.
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From krzb@r @end|ng |rom protonm@||@ch  Wed Jun  2 12:35:05 2021
From: krzb@r @end|ng |rom protonm@||@ch (Krzysztof Bartoszek)
Date: Wed, 02 Jun 2021 10:35:05 +0000
Subject: [R-pkg-devel] problem with submitting to CRAN (windows)
In-Reply-To: <CAJmOi+MZgQjdfiGPWd52u+3D8UfDQ9EZNV1Cb_qjQMLyMoD+dA@mail.gmail.com>
References: <j8f36bZnehgNAAj2UFCc8jK7wT0lVx0udA_8uE_EzmkJbnJlZB4jIcPb4-fEpMhzz3MXCooCHcz89ZLA1RfYW3zAZedSpYmY2HZyDN_udlk=@protonmail.ch>
 <CAJmOi+MZgQjdfiGPWd52u+3D8UfDQ9EZNV1Cb_qjQMLyMoD+dA@mail.gmail.com>
Message-ID: <tmyMe9iO6veBJ293927C8UkXVpukT5LADgJIDpmQi9TcBLQjwDb6tDoIfY9ONuTVLaOxc0pjNHKxWWAP4nreWCLTH0Jt319Iuyx9jM_9yzI=@protonmail.ch>

Thank you. The only problem, as I wrote, is that neither my package, mvSLOUCH, nor any package that mvSLOUCH imports from depends on gtools.
In particular nowhere in mvSLOUCH do I use any call to anything from gtools nor to any function called combinations.

Best wishes
Krzysztof Bartoszek


Sent with ProtonMail Secure Email.

??????? Original Message ???????
On Wednesday, June 2, 2021 10:25 AM, Hugh Parsonage <hugh.parsonage at gmail.com> wrote:

> Probably a consequence of gtools having build errors
> (https://cran.r-project.org/web/checks/check_results_gtools.html)
>
> I'd recommend reconsidering use of the package until the problems are
> resolved. In the meantime, put gtools is Suggests for the use of
> combinations(). Note the base R functions choose and combn that might
> be sufficient (and certainly more available).
>
> On Wed, 2 Jun 2021 at 20:17, Krzysztof Bartoszek krzbar at protonmail.ch wrote:
>
> > Dear all,
> > I am trying to submit an update of my mvSLOUCH package to CRAN an am getting the following problem from the automatic pretest:
> > Dear maintainer,
> > package mvSLOUCH_2.6.5.tar.gz does not pass (yesterday and today) the incoming checks automatically, please see the following pre-tests:
> > Windows: https://win-builder.r-project.org/incoming_pretest/mvSLOUCH_2.6.5_20210602_103000/Windows/00check.log
> > Status: 1 ERROR
> > Debian: https://win-builder.r-project.org/incoming_pretest/mvSLOUCH_2.6.5_20210602_103000/Debian/00check.log
> > Status: OK
> > The windows error in https://win-builder.r-project.org/incoming_pretest/mvSLOUCH_2.6.5_20210602_103000/Windows/00install.out
> > is
> > ** byte-compile and prepare package for lazy loading
> > Error: object 'combinations' is not exported by 'namespace:gtools'
> > Execution halted
> > ERROR: lazy loading failed for package 'mvSLOUCH'
> > Interestingly when I today submited to winbuilder (devel) no such issues are raised (yesterday the same issue was raised by winbuilder-devel):
> > https://win-builder.r-project.org/Ou1tDLkY8HVB/
> > It feels a bit strange that this package dependency fails only for Windows, especially as neither mvSLOUCH nor any of the packages it imports from depend on gtools.
> > I would be very grateful for assistance.
> > Best wishes
> > Krzysztof Bartoszek
> > Sent with ProtonMail Secure Email.
> > [[alternative HTML version deleted]]
> >
> > R-package-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-package-devel


From hugh@p@r@on@ge @end|ng |rom gm@||@com  Wed Jun  2 12:57:40 2021
From: hugh@p@r@on@ge @end|ng |rom gm@||@com (Hugh Parsonage)
Date: Wed, 2 Jun 2021 20:57:40 +1000
Subject: [R-pkg-devel] problem with submitting to CRAN (windows)
In-Reply-To: <tmyMe9iO6veBJ293927C8UkXVpukT5LADgJIDpmQi9TcBLQjwDb6tDoIfY9ONuTVLaOxc0pjNHKxWWAP4nreWCLTH0Jt319Iuyx9jM_9yzI=@protonmail.ch>
References: <j8f36bZnehgNAAj2UFCc8jK7wT0lVx0udA_8uE_EzmkJbnJlZB4jIcPb4-fEpMhzz3MXCooCHcz89ZLA1RfYW3zAZedSpYmY2HZyDN_udlk=@protonmail.ch>
 <CAJmOi+MZgQjdfiGPWd52u+3D8UfDQ9EZNV1Cb_qjQMLyMoD+dA@mail.gmail.com>
 <tmyMe9iO6veBJ293927C8UkXVpukT5LADgJIDpmQi9TcBLQjwDb6tDoIfY9ONuTVLaOxc0pjNHKxWWAP4nreWCLTH0Jt319Iuyx9jM_9yzI=@protonmail.ch>
Message-ID: <CAJmOi+OR-uyUfyefn+Zu8Doqb7X8NTK2Bm-uLraU1W00dJz6dA@mail.gmail.com>

mvSLOUCH <--- TreeSim <-- phytools <-- gtools

On Wed, 2 Jun 2021 at 20:35, Krzysztof Bartoszek <krzbar at protonmail.ch> wrote:
>
> Thank you. The only problem, as I wrote, is that neither my package, mvSLOUCH, nor any package that mvSLOUCH imports from depends on gtools.
> In particular nowhere in mvSLOUCH do I use any call to anything from gtools nor to any function called combinations.
>
> Best wishes
> Krzysztof Bartoszek
>
>
> Sent with ProtonMail Secure Email.
>
> ??????? Original Message ???????
> On Wednesday, June 2, 2021 10:25 AM, Hugh Parsonage <hugh.parsonage at gmail.com> wrote:
>
> > Probably a consequence of gtools having build errors
> > (https://cran.r-project.org/web/checks/check_results_gtools.html)
> >
> > I'd recommend reconsidering use of the package until the problems are
> > resolved. In the meantime, put gtools is Suggests for the use of
> > combinations(). Note the base R functions choose and combn that might
> > be sufficient (and certainly more available).
> >
> > On Wed, 2 Jun 2021 at 20:17, Krzysztof Bartoszek krzbar at protonmail.ch wrote:
> >
> > > Dear all,
> > > I am trying to submit an update of my mvSLOUCH package to CRAN an am getting the following problem from the automatic pretest:
> > > Dear maintainer,
> > > package mvSLOUCH_2.6.5.tar.gz does not pass (yesterday and today) the incoming checks automatically, please see the following pre-tests:
> > > Windows: https://win-builder.r-project.org/incoming_pretest/mvSLOUCH_2.6.5_20210602_103000/Windows/00check.log
> > > Status: 1 ERROR
> > > Debian: https://win-builder.r-project.org/incoming_pretest/mvSLOUCH_2.6.5_20210602_103000/Debian/00check.log
> > > Status: OK
> > > The windows error in https://win-builder.r-project.org/incoming_pretest/mvSLOUCH_2.6.5_20210602_103000/Windows/00install.out
> > > is
> > > ** byte-compile and prepare package for lazy loading
> > > Error: object 'combinations' is not exported by 'namespace:gtools'
> > > Execution halted
> > > ERROR: lazy loading failed for package 'mvSLOUCH'
> > > Interestingly when I today submited to winbuilder (devel) no such issues are raised (yesterday the same issue was raised by winbuilder-devel):
> > > https://win-builder.r-project.org/Ou1tDLkY8HVB/
> > > It feels a bit strange that this package dependency fails only for Windows, especially as neither mvSLOUCH nor any of the packages it imports from depend on gtools.
> > > I would be very grateful for assistance.
> > > Best wishes
> > > Krzysztof Bartoszek
> > > Sent with ProtonMail Secure Email.
> > > [[alternative HTML version deleted]]
> > >
> > > R-package-devel at r-project.org mailing list
> > > https://stat.ethz.ch/mailman/listinfo/r-package-devel
>
>


From murdoch@dunc@n @end|ng |rom gm@||@com  Wed Jun  2 13:08:50 2021
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Wed, 2 Jun 2021 07:08:50 -0400
Subject: [R-pkg-devel] Finding dependencies (Was: problem with submitting to
 CRAN (windows))
In-Reply-To: <CAJmOi+OR-uyUfyefn+Zu8Doqb7X8NTK2Bm-uLraU1W00dJz6dA@mail.gmail.com>
References: <j8f36bZnehgNAAj2UFCc8jK7wT0lVx0udA_8uE_EzmkJbnJlZB4jIcPb4-fEpMhzz3MXCooCHcz89ZLA1RfYW3zAZedSpYmY2HZyDN_udlk=@protonmail.ch>
 <CAJmOi+MZgQjdfiGPWd52u+3D8UfDQ9EZNV1Cb_qjQMLyMoD+dA@mail.gmail.com>
 <tmyMe9iO6veBJ293927C8UkXVpukT5LADgJIDpmQi9TcBLQjwDb6tDoIfY9ONuTVLaOxc0pjNHKxWWAP4nreWCLTH0Jt319Iuyx9jM_9yzI=@protonmail.ch>
 <CAJmOi+OR-uyUfyefn+Zu8Doqb7X8NTK2Bm-uLraU1W00dJz6dA@mail.gmail.com>
Message-ID: <e6506d0f-31ee-7340-c2dc-a9ff15776f63@gmail.com>

On 02/06/2021 6:57 a.m., Hugh Parsonage wrote:
> mvSLOUCH <--- TreeSim <-- phytools <-- gtools
> 
> On Wed, 2 Jun 2021 at 20:35, Krzysztof Bartoszek <krzbar at protonmail.ch> wrote:
>>
>> Thank you. The only problem, as I wrote, is that neither my package, mvSLOUCH, nor any package that mvSLOUCH imports from depends on gtools.
>> In particular nowhere in mvSLOUCH do I use any call to anything from gtools nor to any function called combinations.

Hugh, could you describe how you found this dependency chain?  This sort 
of problem comes up now and then, and I've always used a slow manual 
search.  It would be nice to know if there's an automatic way to answer 
the question

"Why does package xxx appear to require yyy?"

Duncan Murdoch


From hugh@p@r@on@ge @end|ng |rom gm@||@com  Wed Jun  2 13:10:16 2021
From: hugh@p@r@on@ge @end|ng |rom gm@||@com (Hugh Parsonage)
Date: Wed, 2 Jun 2021 21:10:16 +1000
Subject: [R-pkg-devel] 
 Finding dependencies (Was: problem with submitting to
 CRAN (windows))
In-Reply-To: <e6506d0f-31ee-7340-c2dc-a9ff15776f63@gmail.com>
References: <j8f36bZnehgNAAj2UFCc8jK7wT0lVx0udA_8uE_EzmkJbnJlZB4jIcPb4-fEpMhzz3MXCooCHcz89ZLA1RfYW3zAZedSpYmY2HZyDN_udlk=@protonmail.ch>
 <CAJmOi+MZgQjdfiGPWd52u+3D8UfDQ9EZNV1Cb_qjQMLyMoD+dA@mail.gmail.com>
 <tmyMe9iO6veBJ293927C8UkXVpukT5LADgJIDpmQi9TcBLQjwDb6tDoIfY9ONuTVLaOxc0pjNHKxWWAP4nreWCLTH0Jt319Iuyx9jM_9yzI=@protonmail.ch>
 <CAJmOi+OR-uyUfyefn+Zu8Doqb7X8NTK2Bm-uLraU1W00dJz6dA@mail.gmail.com>
 <e6506d0f-31ee-7340-c2dc-a9ff15776f63@gmail.com>
Message-ID: <CAJmOi+OJkMXGSFhKSjzGxmTpgr1iBtxy4ep+gny+1Cys1CyhkA@mail.gmail.com>

First I confirmed "gtools" %in% tools::package_dependencies("mvSLOUCH")[[1]]

then

lapply(tools::package_dependencies("mvSLOUCH"),
tools::package_dependencies, recursive = TRUE)

was sufficient to identify the chain.

On Wed, 2 Jun 2021 at 21:08, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
>
> On 02/06/2021 6:57 a.m., Hugh Parsonage wrote:
> > mvSLOUCH <--- TreeSim <-- phytools <-- gtools
> >
> > On Wed, 2 Jun 2021 at 20:35, Krzysztof Bartoszek <krzbar at protonmail.ch> wrote:
> >>
> >> Thank you. The only problem, as I wrote, is that neither my package, mvSLOUCH, nor any package that mvSLOUCH imports from depends on gtools.
> >> In particular nowhere in mvSLOUCH do I use any call to anything from gtools nor to any function called combinations.
>
> Hugh, could you describe how you found this dependency chain?  This sort
> of problem comes up now and then, and I've always used a slow manual
> search.  It would be nice to know if there's an automatic way to answer
> the question
>
> "Why does package xxx appear to require yyy?"
>
> Duncan Murdoch


From krzb@r @end|ng |rom protonm@||@ch  Wed Jun  2 13:16:10 2021
From: krzb@r @end|ng |rom protonm@||@ch (Krzysztof Bartoszek)
Date: Wed, 02 Jun 2021 11:16:10 +0000
Subject: [R-pkg-devel] 
 Finding dependencies (Was: problem with submitting to
 CRAN (windows))
In-Reply-To: <CAJmOi+OJkMXGSFhKSjzGxmTpgr1iBtxy4ep+gny+1Cys1CyhkA@mail.gmail.com>
References: <j8f36bZnehgNAAj2UFCc8jK7wT0lVx0udA_8uE_EzmkJbnJlZB4jIcPb4-fEpMhzz3MXCooCHcz89ZLA1RfYW3zAZedSpYmY2HZyDN_udlk=@protonmail.ch>
 <CAJmOi+MZgQjdfiGPWd52u+3D8UfDQ9EZNV1Cb_qjQMLyMoD+dA@mail.gmail.com>
 <tmyMe9iO6veBJ293927C8UkXVpukT5LADgJIDpmQi9TcBLQjwDb6tDoIfY9ONuTVLaOxc0pjNHKxWWAP4nreWCLTH0Jt319Iuyx9jM_9yzI=@protonmail.ch>
 <CAJmOi+OR-uyUfyefn+Zu8Doqb7X8NTK2Bm-uLraU1W00dJz6dA@mail.gmail.com>
 <e6506d0f-31ee-7340-c2dc-a9ff15776f63@gmail.com>
 <CAJmOi+OJkMXGSFhKSjzGxmTpgr1iBtxy4ep+gny+1Cys1CyhkA@mail.gmail.com>
Message-ID: <SwBiNsNmBpaUUzlvvcuTxNwKOaGyT40oWSvnUSkshI1vD6ZtM5XIAiEfkkcsWVppi7vllnfWCo6CvtfLSyNXmQjspABoNsIV0QnDOHf9JfM=@protonmail.ch>

Looking manually the chain is actually different
mvSLOUCH <--- TreeSim <-- geiger <-- phytools <-- gtools
TreeSim does not import anything directly from phytools

But given the amount of packages that depend on gtools and seeing how long the above path is, I wonder how many packages on CRAN are experiencing some sort of issues.
Best wishes
Krzysztof Bartoszek


Sent with ProtonMail Secure Email.

??????? Original Message ???????
On Wednesday, June 2, 2021 11:10 AM, Hugh Parsonage <hugh.parsonage at gmail.com> wrote:

> First I confirmed "gtools" %in% tools::package_dependencies("mvSLOUCH")[[1]]
>
> then
>
> lapply(tools::package_dependencies("mvSLOUCH"),
> tools::package_dependencies, recursive = TRUE)
>
> was sufficient to identify the chain.
>
> On Wed, 2 Jun 2021 at 21:08, Duncan Murdoch murdoch.duncan at gmail.com wrote:
>
> > On 02/06/2021 6:57 a.m., Hugh Parsonage wrote:
> >
> > > mvSLOUCH <--- TreeSim <-- phytools <-- gtools
> > > On Wed, 2 Jun 2021 at 20:35, Krzysztof Bartoszek krzbar at protonmail.ch wrote:
> > >
> > > > Thank you. The only problem, as I wrote, is that neither my package, mvSLOUCH, nor any package that mvSLOUCH imports from depends on gtools.
> > > > In particular nowhere in mvSLOUCH do I use any call to anything from gtools nor to any function called combinations.
> >
> > Hugh, could you describe how you found this dependency chain? This sort
> > of problem comes up now and then, and I've always used a slow manual
> > search. It would be nice to know if there's an automatic way to answer
> > the question
> > "Why does package xxx appear to require yyy?"
> > Duncan Murdoch


From c@@rd|@g@bor @end|ng |rom gm@||@com  Wed Jun  2 13:16:55 2021
From: c@@rd|@g@bor @end|ng |rom gm@||@com (=?UTF-8?B?R8OhYm9yIENzw6FyZGk=?=)
Date: Wed, 2 Jun 2021 13:16:55 +0200
Subject: [R-pkg-devel] 
 Finding dependencies (Was: problem with submitting to
 CRAN (windows))
In-Reply-To: <e6506d0f-31ee-7340-c2dc-a9ff15776f63@gmail.com>
References: <j8f36bZnehgNAAj2UFCc8jK7wT0lVx0udA_8uE_EzmkJbnJlZB4jIcPb4-fEpMhzz3MXCooCHcz89ZLA1RfYW3zAZedSpYmY2HZyDN_udlk=@protonmail.ch>
 <CAJmOi+MZgQjdfiGPWd52u+3D8UfDQ9EZNV1Cb_qjQMLyMoD+dA@mail.gmail.com>
 <tmyMe9iO6veBJ293927C8UkXVpukT5LADgJIDpmQi9TcBLQjwDb6tDoIfY9ONuTVLaOxc0pjNHKxWWAP4nreWCLTH0Jt319Iuyx9jM_9yzI=@protonmail.ch>
 <CAJmOi+OR-uyUfyefn+Zu8Doqb7X8NTK2Bm-uLraU1W00dJz6dA@mail.gmail.com>
 <e6506d0f-31ee-7340-c2dc-a9ff15776f63@gmail.com>
Message-ID: <CABtg=K=fVR=TfNk3nL=wgySzp7gFkRYjN7B_ia5Ab+kan3kjbg@mail.gmail.com>

On Wed, Jun 2, 2021 at 1:08 PM Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
[...]
> search.  It would be nice to know if there's an automatic way to answer
> the question
>
> "Why does package xxx appear to require yyy?"

One quick way with the dev version of pak:

install.packages("pak", repos = "https://r-lib.github.io/p/pak/dev/")
pak::pkg_deps_explain("mvSLOUCH", "gtools")
#> mvSLOUCH -> TreeSim -> geiger -> phytools -> gtools

Gabor


From murdoch@dunc@n @end|ng |rom gm@||@com  Wed Jun  2 13:33:13 2021
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Wed, 2 Jun 2021 07:33:13 -0400
Subject: [R-pkg-devel] 
 Finding dependencies (Was: problem with submitting to
 CRAN (windows))
In-Reply-To: <CAJmOi+OJkMXGSFhKSjzGxmTpgr1iBtxy4ep+gny+1Cys1CyhkA@mail.gmail.com>
References: <j8f36bZnehgNAAj2UFCc8jK7wT0lVx0udA_8uE_EzmkJbnJlZB4jIcPb4-fEpMhzz3MXCooCHcz89ZLA1RfYW3zAZedSpYmY2HZyDN_udlk=@protonmail.ch>
 <CAJmOi+MZgQjdfiGPWd52u+3D8UfDQ9EZNV1Cb_qjQMLyMoD+dA@mail.gmail.com>
 <tmyMe9iO6veBJ293927C8UkXVpukT5LADgJIDpmQi9TcBLQjwDb6tDoIfY9ONuTVLaOxc0pjNHKxWWAP4nreWCLTH0Jt319Iuyx9jM_9yzI=@protonmail.ch>
 <CAJmOi+OR-uyUfyefn+Zu8Doqb7X8NTK2Bm-uLraU1W00dJz6dA@mail.gmail.com>
 <e6506d0f-31ee-7340-c2dc-a9ff15776f63@gmail.com>
 <CAJmOi+OJkMXGSFhKSjzGxmTpgr1iBtxy4ep+gny+1Cys1CyhkA@mail.gmail.com>
Message-ID: <0ed8baf1-5c00-17ee-11ed-7441c405102b@gmail.com>

Thanks!

 > On Wed, Jun 2, 2021 at 1:08 PM Duncan Murdoch 
<murdoch.duncan at gmail.com> wrote:
 > [...]
 >> > search.  It would be nice to know if there's an automatic way to 
answer
 >> > the question
 >> >
 >> > "Why does package xxx appear to require yyy?"

On 02/06/2021 7:10 a.m., Hugh Parsonage wrote:
> First I confirmed "gtools" %in% tools::package_dependencies("mvSLOUCH")[[1]]
> 
> then
> 
> lapply(tools::package_dependencies("mvSLOUCH"),
> tools::package_dependencies, recursive = TRUE)
> 
> was sufficient to identify the chain.

On 02/06/2021 7:16 a.m., G?bor Cs?rdi wrote:
> 
> One quick way with the dev version of pak:
> 
> install.packages("pak", repos = "https://r-lib.github.io/p/pak/dev/")
> pak::pkg_deps_explain("mvSLOUCH", "gtools")
> #> mvSLOUCH -> TreeSim -> geiger -> phytools -> gtools
> 
> Gabor


From m|n@h@|| @end|ng |rom um|ch@edu  Wed Jun  2 14:48:42 2021
From: m|n@h@|| @end|ng |rom um|ch@edu (Greg Minshall)
Date: Wed, 02 Jun 2021 15:48:42 +0300
Subject: [R-pkg-devel] 
 Finding dependencies (Was: problem with submitting to
 CRAN (windows))
In-Reply-To: Your message of "Wed, 02 Jun 2021 07:08:50 -0400."
 <e6506d0f-31ee-7340-c2dc-a9ff15776f63@gmail.com>
Message-ID: <975563.1622638122@apollo2.minshall.org>

Duncan,

probably you know this one, but as we're sharing, and as i'm a fan, the
=miniCRAN= package has some such functionality, and the results can be
graphed.  e.g.,
----
require(miniCRAN)
pdb <- pkgAvail()
dg <- makeDepGraph(c("acs", "cdlTools", "maps"), enhances=TRUE,availPkgs=pdb)
plot(dg, legendPosition=c(-1,1),vertex.size=10,cex=0.7)
----

(though following the arrows, you may need better eyesight than i
possess! :)

cheers, Greg


From @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org  Wed Jun  2 17:08:48 2021
From: @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org (Spencer Graves)
Date: Wed, 2 Jun 2021 10:08:48 -0500
Subject: [R-pkg-devel] \donttest{} and writing outputs to tempdir()
In-Reply-To: <0581FB9D-ECD8-42A3-B0D7-8E38A113BB61@dcn.davis.ca.us>
References: <CA+YOmB_eS1yax7jE0h0JBM2_f9DZuFUMawZ+LNHuyuhMvX8zWw@mail.gmail.com>
 <0581FB9D-ECD8-42A3-B0D7-8E38A113BB61@dcn.davis.ca.us>
Message-ID: <d80f0ca2-31af-4ab2-4ee0-7b7963c25ecd@effectivedefense.org>



	  You surely should be able to have some examples that would run in 
less than 5 seconds.


	  I almost never use "donttest".  Instead I use conditional skips, and 
those only on examples that I believe are likely to run too long.  In 
those cases, I believe the standard recommendation is:


		    testthat::skip_on_cran


https://testthat.r-lib.org/reference/skip.html


HOWEVER:  To use this, users must manually set Sys.getenv("NOT_CRAN") to 
"true" if they want the tests to run in environments that are not CRAN. 
  I don't perceive the documentation on this to be adequate;  I'd rather 
not have to set an environment variable in every new environment that 
I'd like to have run all the tests.  Therefore, some years ago, I added 
a CRAN function to the fda package, which I use as follows:


if(!fda::CRAN()){

# code I don't want to run on CRAN
# but do want to run elsewhere.
# You can use:
# R CMD check --as-cran
# to see if it works OK on CRAN


}


	  Spencer


On 6/2/21 12:29 AM, Jeff Newmiller wrote:
> Make examples shorter so they can run faster. Wrapping everything in donttest means that running examples() does nothing, which is counterproductive.
> 
> Techinically, vignettes are not tests or examples... but they do have the advantage that they don't have to run quickly. But that doesn't make a vignette a substitute for either examples or tests.
> 
> As for writing to the wrong place, you should probably just double check.
> 
> On June 1, 2021 9:39:43 PM PDT, Danielle Maeser <maese005 at umn.edu> wrote:
>> Hello,
>>
>> I received the following comments from a CRAN maintainer, and I don't
>> understand why they were an issue. I'd appreciate any insight you can
>> provide.
>>
>> Danielle
>>
>>
>>
>>
>>
>>
>>
>> *All your examples are wrapped in \donttest{} and therefore do not
>> gettested.Please unwrap the examples if that is feasible and if they
>> can
>> beexecuted in < 5 sec for each Rd file or create additionally small
>> toyexamples to allow automatic testing.*
>>
>> I don't think I can unwrap the examples in \donttest{} because they
>> cannot
>> be executed in <5 seconds for each Rd file, and the automatic testing
>> of
>> toy data is satisfied in the vignettes I provide for each function.
>> Therefore, I am not sure what change to make here.
>>
>>
>>
>>
>> *Please ensure that your functions do not write by default or in
>> yourexamples/vignettes/tests in the user's home filespace (including
>> thepackage directory and getwd()). This is not allowed by CRAN
>> policies.In
>> your examples/vignettes/tests you can write to tempdir().*
>>
>> Additionally, all of my vignettes write the output of each function to
>> tempdir(). Therefore, I am not sure why this is a problem.
>


From @t@tonbe @end|ng |rom gm@||@com  Wed Jun  2 18:13:32 2021
From: @t@tonbe @end|ng |rom gm@||@com (Ben Staton)
Date: Wed, 2 Jun 2021 09:13:32 -0700
Subject: [R-pkg-devel] Question about preventing CRAN package archival
Message-ID: <CAH4d-wc4mWJBtu62tjBN1UOcoVXOAyHfVZbxKt8fXchzsqiRZg@mail.gmail.com>

Hello,

I received an email notice from CRAN indicating that my R package
('postpack') will be archived soon if I do not take any action and I want
to avoid that outcome. The issue is not caused by my package, but instead a
package that my package depends on:

"... package 'matrixcalc' is now scheduled for archival on 2021-06-09,
and archiving this will necessitate also archiving its strong reverse
dependencies."

Evidently, xyz has been returning errors on new R builds prompting CRAN to
list it as a package to be archived. My package, 'postpack' has
'matrixcalc' listed in the Imports field, which I assume is why I received
this email.

I want to keep 'postpack' active and don't want it to be archived. I still
need package 'matrixcalc' for my package, but not for most functions. Could
I simply move package 'matrixcalc' to the Suggests list and submit the new
version to CRAN to remove the "Strong Reverse Dependency" issue that
triggered this email to avoid CRAN from archiving my package?

Thanks in advance for any advice you can provide!

	[[alternative HTML version deleted]]


From murdoch@dunc@n @end|ng |rom gm@||@com  Wed Jun  2 18:37:21 2021
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Wed, 2 Jun 2021 12:37:21 -0400
Subject: [R-pkg-devel] Question about preventing CRAN package archival
In-Reply-To: <CAH4d-wc4mWJBtu62tjBN1UOcoVXOAyHfVZbxKt8fXchzsqiRZg@mail.gmail.com>
References: <CAH4d-wc4mWJBtu62tjBN1UOcoVXOAyHfVZbxKt8fXchzsqiRZg@mail.gmail.com>
Message-ID: <bee0fa79-f930-aba1-21e4-80168eba6ef4@gmail.com>

On 02/06/2021 12:13 p.m., Ben Staton wrote:
> Hello,
> 
> I received an email notice from CRAN indicating that my R package
> ('postpack') will be archived soon if I do not take any action and I want
> to avoid that outcome. The issue is not caused by my package, but instead a
> package that my package depends on:
> 
> "... package 'matrixcalc' is now scheduled for archival on 2021-06-09,
> and archiving this will necessitate also archiving its strong reverse
> dependencies."
> 
> Evidently, xyz has been returning errors on new R builds prompting CRAN to
> list it as a package to be archived. My package, 'postpack' has
> 'matrixcalc' listed in the Imports field, which I assume is why I received
> this email.
> 
> I want to keep 'postpack' active and don't want it to be archived. I still
> need package 'matrixcalc' for my package, but not for most functions. Could
> I simply move package 'matrixcalc' to the Suggests list and submit the new
> version to CRAN to remove the "Strong Reverse Dependency" issue that
> triggered this email to avoid CRAN from archiving my package?

That's part of one solution, but not the best solution.

If you move it to Suggests, you should make sure that your package 
checks for it before every use, and falls back to some other calculation 
if it is not present.  Be aware that once it is archived, almost none of 
your users will have it available, so this is kind of like dropping the 
functions that it supports.

Another solution which would be great for the community might be for you 
to offer to take over as maintainer of matrixcalc.  Then you'd fix 
whatever problems it has, and you wouldn't need to worry about it.  I 
haven't looked at the issues so I don't know if this is feasible.

A third choice would be for you to copy the functions you need from 
matrixcalc into your own package so you can drop the dependency.  This 
is generally legal under the licenses that CRAN accepts, but you should 
check anyway.

A fourth choice would be for you to contact the matrixcalc maintainer, 
and help them to fix the issues so that matrixcalc doesn't get archived. 
  They may or may not be willing to work with you.

I'd say my third choice is the best choice in the short term, and 2nd or 
4th would be good long term solutions.

Duncan Murdoch


From pro|jcn@@h @end|ng |rom gm@||@com  Wed Jun  2 18:52:09 2021
From: pro|jcn@@h @end|ng |rom gm@||@com (J C Nash)
Date: Wed, 2 Jun 2021 12:52:09 -0400
Subject: [R-pkg-devel] Question about preventing CRAN package archival
In-Reply-To: <bee0fa79-f930-aba1-21e4-80168eba6ef4@gmail.com>
References: <CAH4d-wc4mWJBtu62tjBN1UOcoVXOAyHfVZbxKt8fXchzsqiRZg@mail.gmail.com>
 <bee0fa79-f930-aba1-21e4-80168eba6ef4@gmail.com>
Message-ID: <bb739be4-7311-b770-3fef-a8124f4a489f@gmail.com>

I just downloaded the source matrixcalc package to see what it contained. The functions
I looked at seem fairly straightforward and the OP could likely develop equivalent features
in his own code, possibly avoiding a function call. Avoiding the function
call means NAMESPACE etc. are not involved, so fewer places for getting into
trouble, assuming the inline code works properly.

JN


On 2021-06-02 12:37 p.m., Duncan Murdoch wrote:
> On 02/06/2021 12:13 p.m., Ben Staton wrote:
>> Hello,
>>
>> I received an email notice from CRAN indicating that my R package
>> ('postpack') will be archived soon if I do not take any action and I want
>> to avoid that outcome. The issue is not caused by my package, but instead a
>> package that my package depends on:
>>
>> "... package 'matrixcalc' is now scheduled for archival on 2021-06-09,
>> and archiving this will necessitate also archiving its strong reverse
>> dependencies."
>>
>> Evidently, xyz has been returning errors on new R builds prompting CRAN to
>> list it as a package to be archived. My package, 'postpack' has
>> 'matrixcalc' listed in the Imports field, which I assume is why I received
>> this email.
>>
>> I want to keep 'postpack' active and don't want it to be archived. I still
>> need package 'matrixcalc' for my package, but not for most functions. Could
>> I simply move package 'matrixcalc' to the Suggests list and submit the new
>> version to CRAN to remove the "Strong Reverse Dependency" issue that
>> triggered this email to avoid CRAN from archiving my package?
> 
> That's part of one solution, but not the best solution.
> 
> If you move it to Suggests, you should make sure that your package checks for it before every use, and falls back to
> some other calculation if it is not present.? Be aware that once it is archived, almost none of your users will have it
> available, so this is kind of like dropping the functions that it supports.
> 
> Another solution which would be great for the community might be for you to offer to take over as maintainer of
> matrixcalc.? Then you'd fix whatever problems it has, and you wouldn't need to worry about it.? I haven't looked at the
> issues so I don't know if this is feasible.
> 
> A third choice would be for you to copy the functions you need from matrixcalc into your own package so you can drop the
> dependency.? This is generally legal under the licenses that CRAN accepts, but you should check anyway.
> 
> A fourth choice would be for you to contact the matrixcalc maintainer, and help them to fix the issues so that
> matrixcalc doesn't get archived. ?They may or may not be willing to work with you.
> 
> I'd say my third choice is the best choice in the short term, and 2nd or 4th would be good long term solutions.
> 
> Duncan Murdoch
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From @t@tonbe @end|ng |rom gm@||@com  Wed Jun  2 19:15:06 2021
From: @t@tonbe @end|ng |rom gm@||@com (Ben Staton)
Date: Wed, 2 Jun 2021 10:15:06 -0700
Subject: [R-pkg-devel] Question about preventing CRAN package archival
In-Reply-To: <bb739be4-7311-b770-3fef-a8124f4a489f@gmail.com>
References: <CAH4d-wc4mWJBtu62tjBN1UOcoVXOAyHfVZbxKt8fXchzsqiRZg@mail.gmail.com>
 <bee0fa79-f930-aba1-21e4-80168eba6ef4@gmail.com>
 <bb739be4-7311-b770-3fef-a8124f4a489f@gmail.com>
Message-ID: <CAH4d-wfVS6xdSBUiCiwxe=Bge4mS6tJnLxH43pOXgMf+WVCkuw@mail.gmail.com>

Hello,

Thank you for your detailed list of solutions.

I was initially tempted to go with option 1 (move matrixcalc to suggests
and check for its existence before using functions that rely on it), but as
mentioned, this is not a long term fix.

I unfortunately can't take on the responsibilities of option 2 (becoming
the package maintainer) -- there is much that this package does that I do
not understand, and do not wish to feign authority!

I plan to take option 3 (copy the needed functions into my package). There
are only three functions I need from matrixcalc, and all three are fairly
simple (is.square.matrix
<https://rdrr.io/cran/matrixcalc/src/R/is.square.matrix.R>,
is.symmetric.matrix
<https://rdrr.io/cran/matrixcalc/src/R/is.symmetric.matrix.R>, and
is.positive.definite
<https://rdrr.io/cran/matrixcalc/src/R/is.positive.definite.R>) and there
is only one function in postpack that needs them. I plan to define them
within the postpack function. matrixcalc is licensed under GPL >= 2 and
based on my scan of the license text, this is allowed. Is that correct?

Regarding option 4 (contacting the matrixcalc maintainer), the original
email from CRAN mentioned that they have attempted to contact the package
author with no response.

Thank you!

On Wed, Jun 2, 2021 at 9:52 AM J C Nash <profjcnash at gmail.com> wrote:

> I just downloaded the source matrixcalc package to see what it contained.
> The functions
> I looked at seem fairly straightforward and the OP could likely develop
> equivalent features
> in his own code, possibly avoiding a function call. Avoiding the function
> call means NAMESPACE etc. are not involved, so fewer places for getting
> into
> trouble, assuming the inline code works properly.
>
> JN
>
>
> On 2021-06-02 12:37 p.m., Duncan Murdoch wrote:
> > On 02/06/2021 12:13 p.m., Ben Staton wrote:
> >> Hello,
> >>
> >> I received an email notice from CRAN indicating that my R package
> >> ('postpack') will be archived soon if I do not take any action and I
> want
> >> to avoid that outcome. The issue is not caused by my package, but
> instead a
> >> package that my package depends on:
> >>
> >> "... package 'matrixcalc' is now scheduled for archival on 2021-06-09,
> >> and archiving this will necessitate also archiving its strong reverse
> >> dependencies."
> >>
> >> Evidently, xyz has been returning errors on new R builds prompting CRAN
> to
> >> list it as a package to be archived. My package, 'postpack' has
> >> 'matrixcalc' listed in the Imports field, which I assume is why I
> received
> >> this email.
> >>
> >> I want to keep 'postpack' active and don't want it to be archived. I
> still
> >> need package 'matrixcalc' for my package, but not for most functions.
> Could
> >> I simply move package 'matrixcalc' to the Suggests list and submit the
> new
> >> version to CRAN to remove the "Strong Reverse Dependency" issue that
> >> triggered this email to avoid CRAN from archiving my package?
> >
> > That's part of one solution, but not the best solution.
> >
> > If you move it to Suggests, you should make sure that your package
> checks for it before every use, and falls back to
> > some other calculation if it is not present.  Be aware that once it is
> archived, almost none of your users will have it
> > available, so this is kind of like dropping the functions that it
> supports.
> >
> > Another solution which would be great for the community might be for you
> to offer to take over as maintainer of
> > matrixcalc.  Then you'd fix whatever problems it has, and you wouldn't
> need to worry about it.  I haven't looked at the
> > issues so I don't know if this is feasible.
> >
> > A third choice would be for you to copy the functions you need from
> matrixcalc into your own package so you can drop the
> > dependency.  This is generally legal under the licenses that CRAN
> accepts, but you should check anyway.
> >
> > A fourth choice would be for you to contact the matrixcalc maintainer,
> and help them to fix the issues so that
> > matrixcalc doesn't get archived.  They may or may not be willing to work
> with you.
> >
> > I'd say my third choice is the best choice in the short term, and 2nd or
> 4th would be good long term solutions.
> >
> > Duncan Murdoch
> >
> > ______________________________________________
> > R-package-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From bbo|ker @end|ng |rom gm@||@com  Wed Jun  2 19:25:05 2021
From: bbo|ker @end|ng |rom gm@||@com (Ben Bolker)
Date: Wed, 2 Jun 2021 13:25:05 -0400
Subject: [R-pkg-devel] Question about preventing CRAN package archival
In-Reply-To: <CAH4d-wfVS6xdSBUiCiwxe=Bge4mS6tJnLxH43pOXgMf+WVCkuw@mail.gmail.com>
References: <CAH4d-wc4mWJBtu62tjBN1UOcoVXOAyHfVZbxKt8fXchzsqiRZg@mail.gmail.com>
 <bee0fa79-f930-aba1-21e4-80168eba6ef4@gmail.com>
 <bb739be4-7311-b770-3fef-a8124f4a489f@gmail.com>
 <CAH4d-wfVS6xdSBUiCiwxe=Bge4mS6tJnLxH43pOXgMf+WVCkuw@mail.gmail.com>
Message-ID: <198da970-8073-bbda-ed52-39eafc5c85df@gmail.com>

    That all sounds exactly right.
   GPL >= 2 allows you to use the material without asking permission as 
long as your package is compatibly licensed (e.g. also GPL).
   Under normal circumstances it would be polite to ask permission, but 
if the reason for doing this is that the maintainer is unreachable in 
the first place ...

  If you want to try a little harder, it seems quite possible that you 
can reach the matrixcalc maintainer at the (personal) e-mail address 
shown in this page:

https://www.facebook.com/photo/?fbid=10208324530363130&set=ecnf.1000413042

   (Possibly an identity confusion, but I rate that as unlikely based on 
other facebook snooping)

   I don't think a short, polite e-mail request would be out of bounds, 
they can always ignore it or tell you to go away.

   cheers
    Ben Bolker

On 6/2/21 1:15 PM, Ben Staton wrote:
> Hello,
> 
> Thank you for your detailed list of solutions.
> 
> I was initially tempted to go with option 1 (move matrixcalc to suggests
> and check for its existence before using functions that rely on it), but as
> mentioned, this is not a long term fix.
> 
> I unfortunately can't take on the responsibilities of option 2 (becoming
> the package maintainer) -- there is much that this package does that I do
> not understand, and do not wish to feign authority!
> 
> I plan to take option 3 (copy the needed functions into my package). There
> are only three functions I need from matrixcalc, and all three are fairly
> simple (is.square.matrix
> <https://rdrr.io/cran/matrixcalc/src/R/is.square.matrix.R>,
> is.symmetric.matrix
> <https://rdrr.io/cran/matrixcalc/src/R/is.symmetric.matrix.R>, and
> is.positive.definite
> <https://rdrr.io/cran/matrixcalc/src/R/is.positive.definite.R>) and there
> is only one function in postpack that needs them. I plan to define them
> within the postpack function. matrixcalc is licensed under GPL >= 2 and
> based on my scan of the license text, this is allowed. Is that correct?
> 
> Regarding option 4 (contacting the matrixcalc maintainer), the original
> email from CRAN mentioned that they have attempted to contact the package
> author with no response.
> 
> Thank you!
> 
> On Wed, Jun 2, 2021 at 9:52 AM J C Nash <profjcnash at gmail.com> wrote:
> 
>> I just downloaded the source matrixcalc package to see what it contained.
>> The functions
>> I looked at seem fairly straightforward and the OP could likely develop
>> equivalent features
>> in his own code, possibly avoiding a function call. Avoiding the function
>> call means NAMESPACE etc. are not involved, so fewer places for getting
>> into
>> trouble, assuming the inline code works properly.
>>
>> JN
>>
>>
>> On 2021-06-02 12:37 p.m., Duncan Murdoch wrote:
>>> On 02/06/2021 12:13 p.m., Ben Staton wrote:
>>>> Hello,
>>>>
>>>> I received an email notice from CRAN indicating that my R package
>>>> ('postpack') will be archived soon if I do not take any action and I
>> want
>>>> to avoid that outcome. The issue is not caused by my package, but
>> instead a
>>>> package that my package depends on:
>>>>
>>>> "... package 'matrixcalc' is now scheduled for archival on 2021-06-09,
>>>> and archiving this will necessitate also archiving its strong reverse
>>>> dependencies."
>>>>
>>>> Evidently, xyz has been returning errors on new R builds prompting CRAN
>> to
>>>> list it as a package to be archived. My package, 'postpack' has
>>>> 'matrixcalc' listed in the Imports field, which I assume is why I
>> received
>>>> this email.
>>>>
>>>> I want to keep 'postpack' active and don't want it to be archived. I
>> still
>>>> need package 'matrixcalc' for my package, but not for most functions.
>> Could
>>>> I simply move package 'matrixcalc' to the Suggests list and submit the
>> new
>>>> version to CRAN to remove the "Strong Reverse Dependency" issue that
>>>> triggered this email to avoid CRAN from archiving my package?
>>>
>>> That's part of one solution, but not the best solution.
>>>
>>> If you move it to Suggests, you should make sure that your package
>> checks for it before every use, and falls back to
>>> some other calculation if it is not present.  Be aware that once it is
>> archived, almost none of your users will have it
>>> available, so this is kind of like dropping the functions that it
>> supports.
>>>
>>> Another solution which would be great for the community might be for you
>> to offer to take over as maintainer of
>>> matrixcalc.  Then you'd fix whatever problems it has, and you wouldn't
>> need to worry about it.  I haven't looked at the
>>> issues so I don't know if this is feasible.
>>>
>>> A third choice would be for you to copy the functions you need from
>> matrixcalc into your own package so you can drop the
>>> dependency.  This is generally legal under the licenses that CRAN
>> accepts, but you should check anyway.
>>>
>>> A fourth choice would be for you to contact the matrixcalc maintainer,
>> and help them to fix the issues so that
>>> matrixcalc doesn't get archived.  They may or may not be willing to work
>> with you.
>>>
>>> I'd say my third choice is the best choice in the short term, and 2nd or
>> 4th would be good long term solutions.
>>>
>>> Duncan Murdoch
>>>
>>> ______________________________________________
>>> R-package-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


From @t@tonbe @end|ng |rom gm@||@com  Wed Jun  2 19:36:00 2021
From: @t@tonbe @end|ng |rom gm@||@com (Ben Staton)
Date: Wed, 2 Jun 2021 10:36:00 -0700
Subject: [R-pkg-devel] Question about preventing CRAN package archival
In-Reply-To: <198da970-8073-bbda-ed52-39eafc5c85df@gmail.com>
References: <CAH4d-wc4mWJBtu62tjBN1UOcoVXOAyHfVZbxKt8fXchzsqiRZg@mail.gmail.com>
 <bee0fa79-f930-aba1-21e4-80168eba6ef4@gmail.com>
 <bb739be4-7311-b770-3fef-a8124f4a489f@gmail.com>
 <CAH4d-wfVS6xdSBUiCiwxe=Bge4mS6tJnLxH43pOXgMf+WVCkuw@mail.gmail.com>
 <198da970-8073-bbda-ed52-39eafc5c85df@gmail.com>
Message-ID: <CAH4d-we12i5GTJ_O_YNHSwpZzZUnf7kD=QpCzpEJSdvgW9wPiA@mail.gmail.com>

My package uses the MIT license, so would that not meet the compatibility
requirements?

I will attempt to reach out to the package author - thanks for your help!

On Wed, Jun 2, 2021 at 10:31 AM Ben Bolker <bbolker at gmail.com> wrote:

>     That all sounds exactly right.
>    GPL >= 2 allows you to use the material without asking permission as
> long as your package is compatibly licensed (e.g. also GPL).
>    Under normal circumstances it would be polite to ask permission, but
> if the reason for doing this is that the maintainer is unreachable in
> the first place ...
>
>   If you want to try a little harder, it seems quite possible that you
> can reach the matrixcalc maintainer at the (personal) e-mail address
> shown in this page:
>
> https://www.facebook.com/photo/?fbid=10208324530363130&set=ecnf.1000413042
>
>    (Possibly an identity confusion, but I rate that as unlikely based on
> other facebook snooping)
>
>    I don't think a short, polite e-mail request would be out of bounds,
> they can always ignore it or tell you to go away.
>
>    cheers
>     Ben Bolker
>
> On 6/2/21 1:15 PM, Ben Staton wrote:
> > Hello,
> >
> > Thank you for your detailed list of solutions.
> >
> > I was initially tempted to go with option 1 (move matrixcalc to suggests
> > and check for its existence before using functions that rely on it), but
> as
> > mentioned, this is not a long term fix.
> >
> > I unfortunately can't take on the responsibilities of option 2 (becoming
> > the package maintainer) -- there is much that this package does that I do
> > not understand, and do not wish to feign authority!
> >
> > I plan to take option 3 (copy the needed functions into my package).
> There
> > are only three functions I need from matrixcalc, and all three are fairly
> > simple (is.square.matrix
> > <https://rdrr.io/cran/matrixcalc/src/R/is.square.matrix.R>,
> > is.symmetric.matrix
> > <https://rdrr.io/cran/matrixcalc/src/R/is.symmetric.matrix.R>, and
> > is.positive.definite
> > <https://rdrr.io/cran/matrixcalc/src/R/is.positive.definite.R>) and
> there
> > is only one function in postpack that needs them. I plan to define them
> > within the postpack function. matrixcalc is licensed under GPL >= 2 and
> > based on my scan of the license text, this is allowed. Is that correct?
> >
> > Regarding option 4 (contacting the matrixcalc maintainer), the original
> > email from CRAN mentioned that they have attempted to contact the package
> > author with no response.
> >
> > Thank you!
> >
> > On Wed, Jun 2, 2021 at 9:52 AM J C Nash <profjcnash at gmail.com> wrote:
> >
> >> I just downloaded the source matrixcalc package to see what it
> contained.
> >> The functions
> >> I looked at seem fairly straightforward and the OP could likely develop
> >> equivalent features
> >> in his own code, possibly avoiding a function call. Avoiding the
> function
> >> call means NAMESPACE etc. are not involved, so fewer places for getting
> >> into
> >> trouble, assuming the inline code works properly.
> >>
> >> JN
> >>
> >>
> >> On 2021-06-02 12:37 p.m., Duncan Murdoch wrote:
> >>> On 02/06/2021 12:13 p.m., Ben Staton wrote:
> >>>> Hello,
> >>>>
> >>>> I received an email notice from CRAN indicating that my R package
> >>>> ('postpack') will be archived soon if I do not take any action and I
> >> want
> >>>> to avoid that outcome. The issue is not caused by my package, but
> >> instead a
> >>>> package that my package depends on:
> >>>>
> >>>> "... package 'matrixcalc' is now scheduled for archival on 2021-06-09,
> >>>> and archiving this will necessitate also archiving its strong reverse
> >>>> dependencies."
> >>>>
> >>>> Evidently, xyz has been returning errors on new R builds prompting
> CRAN
> >> to
> >>>> list it as a package to be archived. My package, 'postpack' has
> >>>> 'matrixcalc' listed in the Imports field, which I assume is why I
> >> received
> >>>> this email.
> >>>>
> >>>> I want to keep 'postpack' active and don't want it to be archived. I
> >> still
> >>>> need package 'matrixcalc' for my package, but not for most functions.
> >> Could
> >>>> I simply move package 'matrixcalc' to the Suggests list and submit the
> >> new
> >>>> version to CRAN to remove the "Strong Reverse Dependency" issue that
> >>>> triggered this email to avoid CRAN from archiving my package?
> >>>
> >>> That's part of one solution, but not the best solution.
> >>>
> >>> If you move it to Suggests, you should make sure that your package
> >> checks for it before every use, and falls back to
> >>> some other calculation if it is not present.  Be aware that once it is
> >> archived, almost none of your users will have it
> >>> available, so this is kind of like dropping the functions that it
> >> supports.
> >>>
> >>> Another solution which would be great for the community might be for
> you
> >> to offer to take over as maintainer of
> >>> matrixcalc.  Then you'd fix whatever problems it has, and you wouldn't
> >> need to worry about it.  I haven't looked at the
> >>> issues so I don't know if this is feasible.
> >>>
> >>> A third choice would be for you to copy the functions you need from
> >> matrixcalc into your own package so you can drop the
> >>> dependency.  This is generally legal under the licenses that CRAN
> >> accepts, but you should check anyway.
> >>>
> >>> A fourth choice would be for you to contact the matrixcalc maintainer,
> >> and help them to fix the issues so that
> >>> matrixcalc doesn't get archived.  They may or may not be willing to
> work
> >> with you.
> >>>
> >>> I'd say my third choice is the best choice in the short term, and 2nd
> or
> >> 4th would be good long term solutions.
> >>>
> >>> Duncan Murdoch
> >>>
> >>> ______________________________________________
> >>> R-package-devel at r-project.org mailing list
> >>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
> >>
> >
> >       [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-package-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-package-devel
> >
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Wed Jun  2 20:34:21 2021
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Wed, 02 Jun 2021 11:34:21 -0700
Subject: [R-pkg-devel] Question about preventing CRAN package archival
In-Reply-To: <CAH4d-we12i5GTJ_O_YNHSwpZzZUnf7kD=QpCzpEJSdvgW9wPiA@mail.gmail.com>
References: <CAH4d-wc4mWJBtu62tjBN1UOcoVXOAyHfVZbxKt8fXchzsqiRZg@mail.gmail.com>
 <bee0fa79-f930-aba1-21e4-80168eba6ef4@gmail.com>
 <bb739be4-7311-b770-3fef-a8124f4a489f@gmail.com>
 <CAH4d-wfVS6xdSBUiCiwxe=Bge4mS6tJnLxH43pOXgMf+WVCkuw@mail.gmail.com>
 <198da970-8073-bbda-ed52-39eafc5c85df@gmail.com>
 <CAH4d-we12i5GTJ_O_YNHSwpZzZUnf7kD=QpCzpEJSdvgW9wPiA@mail.gmail.com>
Message-ID: <4AC540CC-010F-4F1D-A004-B676D45DB0D3@dcn.davis.ca.us>

MIT is more permissive than GPL2, so there is a collision there. But you may be able to work it out with the author?

On June 2, 2021 10:36:00 AM PDT, Ben Staton <statonbe at gmail.com> wrote:
>My package uses the MIT license, so would that not meet the
>compatibility
>requirements?
>
>I will attempt to reach out to the package author - thanks for your
>help!
>
>On Wed, Jun 2, 2021 at 10:31 AM Ben Bolker <bbolker at gmail.com> wrote:
>
>>     That all sounds exactly right.
>>    GPL >= 2 allows you to use the material without asking permission
>as
>> long as your package is compatibly licensed (e.g. also GPL).
>>    Under normal circumstances it would be polite to ask permission,
>but
>> if the reason for doing this is that the maintainer is unreachable in
>> the first place ...
>>
>>   If you want to try a little harder, it seems quite possible that
>you
>> can reach the matrixcalc maintainer at the (personal) e-mail address
>> shown in this page:
>>
>>
>https://www.facebook.com/photo/?fbid=10208324530363130&set=ecnf.1000413042
>>
>>    (Possibly an identity confusion, but I rate that as unlikely based
>on
>> other facebook snooping)
>>
>>    I don't think a short, polite e-mail request would be out of
>bounds,
>> they can always ignore it or tell you to go away.
>>
>>    cheers
>>     Ben Bolker
>>
>> On 6/2/21 1:15 PM, Ben Staton wrote:
>> > Hello,
>> >
>> > Thank you for your detailed list of solutions.
>> >
>> > I was initially tempted to go with option 1 (move matrixcalc to
>suggests
>> > and check for its existence before using functions that rely on
>it), but
>> as
>> > mentioned, this is not a long term fix.
>> >
>> > I unfortunately can't take on the responsibilities of option 2
>(becoming
>> > the package maintainer) -- there is much that this package does
>that I do
>> > not understand, and do not wish to feign authority!
>> >
>> > I plan to take option 3 (copy the needed functions into my
>package).
>> There
>> > are only three functions I need from matrixcalc, and all three are
>fairly
>> > simple (is.square.matrix
>> > <https://rdrr.io/cran/matrixcalc/src/R/is.square.matrix.R>,
>> > is.symmetric.matrix
>> > <https://rdrr.io/cran/matrixcalc/src/R/is.symmetric.matrix.R>, and
>> > is.positive.definite
>> > <https://rdrr.io/cran/matrixcalc/src/R/is.positive.definite.R>) and
>> there
>> > is only one function in postpack that needs them. I plan to define
>them
>> > within the postpack function. matrixcalc is licensed under GPL >= 2
>and
>> > based on my scan of the license text, this is allowed. Is that
>correct?
>> >
>> > Regarding option 4 (contacting the matrixcalc maintainer), the
>original
>> > email from CRAN mentioned that they have attempted to contact the
>package
>> > author with no response.
>> >
>> > Thank you!
>> >
>> > On Wed, Jun 2, 2021 at 9:52 AM J C Nash <profjcnash at gmail.com>
>wrote:
>> >
>> >> I just downloaded the source matrixcalc package to see what it
>> contained.
>> >> The functions
>> >> I looked at seem fairly straightforward and the OP could likely
>develop
>> >> equivalent features
>> >> in his own code, possibly avoiding a function call. Avoiding the
>> function
>> >> call means NAMESPACE etc. are not involved, so fewer places for
>getting
>> >> into
>> >> trouble, assuming the inline code works properly.
>> >>
>> >> JN
>> >>
>> >>
>> >> On 2021-06-02 12:37 p.m., Duncan Murdoch wrote:
>> >>> On 02/06/2021 12:13 p.m., Ben Staton wrote:
>> >>>> Hello,
>> >>>>
>> >>>> I received an email notice from CRAN indicating that my R
>package
>> >>>> ('postpack') will be archived soon if I do not take any action
>and I
>> >> want
>> >>>> to avoid that outcome. The issue is not caused by my package,
>but
>> >> instead a
>> >>>> package that my package depends on:
>> >>>>
>> >>>> "... package 'matrixcalc' is now scheduled for archival on
>2021-06-09,
>> >>>> and archiving this will necessitate also archiving its strong
>reverse
>> >>>> dependencies."
>> >>>>
>> >>>> Evidently, xyz has been returning errors on new R builds
>prompting
>> CRAN
>> >> to
>> >>>> list it as a package to be archived. My package, 'postpack' has
>> >>>> 'matrixcalc' listed in the Imports field, which I assume is why
>I
>> >> received
>> >>>> this email.
>> >>>>
>> >>>> I want to keep 'postpack' active and don't want it to be
>archived. I
>> >> still
>> >>>> need package 'matrixcalc' for my package, but not for most
>functions.
>> >> Could
>> >>>> I simply move package 'matrixcalc' to the Suggests list and
>submit the
>> >> new
>> >>>> version to CRAN to remove the "Strong Reverse Dependency" issue
>that
>> >>>> triggered this email to avoid CRAN from archiving my package?
>> >>>
>> >>> That's part of one solution, but not the best solution.
>> >>>
>> >>> If you move it to Suggests, you should make sure that your
>package
>> >> checks for it before every use, and falls back to
>> >>> some other calculation if it is not present.  Be aware that once
>it is
>> >> archived, almost none of your users will have it
>> >>> available, so this is kind of like dropping the functions that it
>> >> supports.
>> >>>
>> >>> Another solution which would be great for the community might be
>for
>> you
>> >> to offer to take over as maintainer of
>> >>> matrixcalc.  Then you'd fix whatever problems it has, and you
>wouldn't
>> >> need to worry about it.  I haven't looked at the
>> >>> issues so I don't know if this is feasible.
>> >>>
>> >>> A third choice would be for you to copy the functions you need
>from
>> >> matrixcalc into your own package so you can drop the
>> >>> dependency.  This is generally legal under the licenses that CRAN
>> >> accepts, but you should check anyway.
>> >>>
>> >>> A fourth choice would be for you to contact the matrixcalc
>maintainer,
>> >> and help them to fix the issues so that
>> >>> matrixcalc doesn't get archived.  They may or may not be willing
>to
>> work
>> >> with you.
>> >>>
>> >>> I'd say my third choice is the best choice in the short term, and
>2nd
>> or
>> >> 4th would be good long term solutions.
>> >>>
>> >>> Duncan Murdoch
>> >>>
>> >>> ______________________________________________
>> >>> R-package-devel at r-project.org mailing list
>> >>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>> >>
>> >
>> >       [[alternative HTML version deleted]]
>> >
>> > ______________________________________________
>> > R-package-devel at r-project.org mailing list
>> > https://stat.ethz.ch/mailman/listinfo/r-package-devel
>> >
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>
>
>	[[alternative HTML version deleted]]
>
>______________________________________________
>R-package-devel at r-project.org mailing list
>https://stat.ethz.ch/mailman/listinfo/r-package-devel

-- 
Sent from my phone. Please excuse my brevity.


From john@m@h@rro|d @end|ng |rom gm@||@com  Wed Jun  2 21:15:04 2021
From: john@m@h@rro|d @end|ng |rom gm@||@com (John Harrold)
Date: Wed, 2 Jun 2021 12:15:04 -0700
Subject: [R-pkg-devel] Question about preventing CRAN package archival
In-Reply-To: <CAH4d-we12i5GTJ_O_YNHSwpZzZUnf7kD=QpCzpEJSdvgW9wPiA@mail.gmail.com>
References: <CAH4d-wc4mWJBtu62tjBN1UOcoVXOAyHfVZbxKt8fXchzsqiRZg@mail.gmail.com>
 <bee0fa79-f930-aba1-21e4-80168eba6ef4@gmail.com>
 <bb739be4-7311-b770-3fef-a8124f4a489f@gmail.com>
 <CAH4d-wfVS6xdSBUiCiwxe=Bge4mS6tJnLxH43pOXgMf+WVCkuw@mail.gmail.com>
 <198da970-8073-bbda-ed52-39eafc5c85df@gmail.com>
 <CAH4d-we12i5GTJ_O_YNHSwpZzZUnf7kD=QpCzpEJSdvgW9wPiA@mail.gmail.com>
Message-ID: <CANAiAiWgd20=JRgeqJC65ESPHnT1Ge=HeiFWaPRJmzcNjZQHmQ@mail.gmail.com>

To add another option. In the past when this has happened to me I've found
other packages that provide similar functionality.

I'm assuming that is.square just checks the number of columns == number of
rows? And the others can probably be implemented pretty easily.

On Wed, Jun 2, 2021 at 10:41 AM Ben Staton <statonbe at gmail.com> wrote:

> My package uses the MIT license, so would that not meet the compatibility
> requirements?
>
> I will attempt to reach out to the package author - thanks for your help!
>
> On Wed, Jun 2, 2021 at 10:31 AM Ben Bolker <bbolker at gmail.com> wrote:
>
> >     That all sounds exactly right.
> >    GPL >= 2 allows you to use the material without asking permission as
> > long as your package is compatibly licensed (e.g. also GPL).
> >    Under normal circumstances it would be polite to ask permission, but
> > if the reason for doing this is that the maintainer is unreachable in
> > the first place ...
> >
> >   If you want to try a little harder, it seems quite possible that you
> > can reach the matrixcalc maintainer at the (personal) e-mail address
> > shown in this page:
> >
> >
> https://www.facebook.com/photo/?fbid=10208324530363130&set=ecnf.1000413042
> >
> >    (Possibly an identity confusion, but I rate that as unlikely based on
> > other facebook snooping)
> >
> >    I don't think a short, polite e-mail request would be out of bounds,
> > they can always ignore it or tell you to go away.
> >
> >    cheers
> >     Ben Bolker
> >
> > On 6/2/21 1:15 PM, Ben Staton wrote:
> > > Hello,
> > >
> > > Thank you for your detailed list of solutions.
> > >
> > > I was initially tempted to go with option 1 (move matrixcalc to
> suggests
> > > and check for its existence before using functions that rely on it),
> but
> > as
> > > mentioned, this is not a long term fix.
> > >
> > > I unfortunately can't take on the responsibilities of option 2
> (becoming
> > > the package maintainer) -- there is much that this package does that I
> do
> > > not understand, and do not wish to feign authority!
> > >
> > > I plan to take option 3 (copy the needed functions into my package).
> > There
> > > are only three functions I need from matrixcalc, and all three are
> fairly
> > > simple (is.square.matrix
> > > <https://rdrr.io/cran/matrixcalc/src/R/is.square.matrix.R>,
> > > is.symmetric.matrix
> > > <https://rdrr.io/cran/matrixcalc/src/R/is.symmetric.matrix.R>, and
> > > is.positive.definite
> > > <https://rdrr.io/cran/matrixcalc/src/R/is.positive.definite.R>) and
> > there
> > > is only one function in postpack that needs them. I plan to define them
> > > within the postpack function. matrixcalc is licensed under GPL >= 2 and
> > > based on my scan of the license text, this is allowed. Is that correct?
> > >
> > > Regarding option 4 (contacting the matrixcalc maintainer), the original
> > > email from CRAN mentioned that they have attempted to contact the
> package
> > > author with no response.
> > >
> > > Thank you!
> > >
> > > On Wed, Jun 2, 2021 at 9:52 AM J C Nash <profjcnash at gmail.com> wrote:
> > >
> > >> I just downloaded the source matrixcalc package to see what it
> > contained.
> > >> The functions
> > >> I looked at seem fairly straightforward and the OP could likely
> develop
> > >> equivalent features
> > >> in his own code, possibly avoiding a function call. Avoiding the
> > function
> > >> call means NAMESPACE etc. are not involved, so fewer places for
> getting
> > >> into
> > >> trouble, assuming the inline code works properly.
> > >>
> > >> JN
> > >>
> > >>
> > >> On 2021-06-02 12:37 p.m., Duncan Murdoch wrote:
> > >>> On 02/06/2021 12:13 p.m., Ben Staton wrote:
> > >>>> Hello,
> > >>>>
> > >>>> I received an email notice from CRAN indicating that my R package
> > >>>> ('postpack') will be archived soon if I do not take any action and I
> > >> want
> > >>>> to avoid that outcome. The issue is not caused by my package, but
> > >> instead a
> > >>>> package that my package depends on:
> > >>>>
> > >>>> "... package 'matrixcalc' is now scheduled for archival on
> 2021-06-09,
> > >>>> and archiving this will necessitate also archiving its strong
> reverse
> > >>>> dependencies."
> > >>>>
> > >>>> Evidently, xyz has been returning errors on new R builds prompting
> > CRAN
> > >> to
> > >>>> list it as a package to be archived. My package, 'postpack' has
> > >>>> 'matrixcalc' listed in the Imports field, which I assume is why I
> > >> received
> > >>>> this email.
> > >>>>
> > >>>> I want to keep 'postpack' active and don't want it to be archived. I
> > >> still
> > >>>> need package 'matrixcalc' for my package, but not for most
> functions.
> > >> Could
> > >>>> I simply move package 'matrixcalc' to the Suggests list and submit
> the
> > >> new
> > >>>> version to CRAN to remove the "Strong Reverse Dependency" issue that
> > >>>> triggered this email to avoid CRAN from archiving my package?
> > >>>
> > >>> That's part of one solution, but not the best solution.
> > >>>
> > >>> If you move it to Suggests, you should make sure that your package
> > >> checks for it before every use, and falls back to
> > >>> some other calculation if it is not present.  Be aware that once it
> is
> > >> archived, almost none of your users will have it
> > >>> available, so this is kind of like dropping the functions that it
> > >> supports.
> > >>>
> > >>> Another solution which would be great for the community might be for
> > you
> > >> to offer to take over as maintainer of
> > >>> matrixcalc.  Then you'd fix whatever problems it has, and you
> wouldn't
> > >> need to worry about it.  I haven't looked at the
> > >>> issues so I don't know if this is feasible.
> > >>>
> > >>> A third choice would be for you to copy the functions you need from
> > >> matrixcalc into your own package so you can drop the
> > >>> dependency.  This is generally legal under the licenses that CRAN
> > >> accepts, but you should check anyway.
> > >>>
> > >>> A fourth choice would be for you to contact the matrixcalc
> maintainer,
> > >> and help them to fix the issues so that
> > >>> matrixcalc doesn't get archived.  They may or may not be willing to
> > work
> > >> with you.
> > >>>
> > >>> I'd say my third choice is the best choice in the short term, and 2nd
> > or
> > >> 4th would be good long term solutions.
> > >>>
> > >>> Duncan Murdoch
> > >>>
> > >>> ______________________________________________
> > >>> R-package-devel at r-project.org mailing list
> > >>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
> > >>
> > >
> > >       [[alternative HTML version deleted]]
> > >
> > > ______________________________________________
> > > R-package-devel at r-project.org mailing list
> > > https://stat.ethz.ch/mailman/listinfo/r-package-devel
> > >
> >
> > ______________________________________________
> > R-package-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-package-devel
> >
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


-- 
John
:wq

	[[alternative HTML version deleted]]


From pro|jcn@@h @end|ng |rom gm@||@com  Wed Jun  2 21:28:13 2021
From: pro|jcn@@h @end|ng |rom gm@||@com (J C Nash)
Date: Wed, 2 Jun 2021 15:28:13 -0400
Subject: [R-pkg-devel] Question about preventing CRAN package archival
In-Reply-To: <CANAiAiWgd20=JRgeqJC65ESPHnT1Ge=HeiFWaPRJmzcNjZQHmQ@mail.gmail.com>
References: <CAH4d-wc4mWJBtu62tjBN1UOcoVXOAyHfVZbxKt8fXchzsqiRZg@mail.gmail.com>
 <bee0fa79-f930-aba1-21e4-80168eba6ef4@gmail.com>
 <bb739be4-7311-b770-3fef-a8124f4a489f@gmail.com>
 <CAH4d-wfVS6xdSBUiCiwxe=Bge4mS6tJnLxH43pOXgMf+WVCkuw@mail.gmail.com>
 <198da970-8073-bbda-ed52-39eafc5c85df@gmail.com>
 <CAH4d-we12i5GTJ_O_YNHSwpZzZUnf7kD=QpCzpEJSdvgW9wPiA@mail.gmail.com>
 <CANAiAiWgd20=JRgeqJC65ESPHnT1Ge=HeiFWaPRJmzcNjZQHmQ@mail.gmail.com>
Message-ID: <5780625b-49a8-9117-fcd6-dd3d2b8ea043@gmail.com>

As noted by John Harrold and my previous posting, these are not monster codes.
I'd check what I needed and simply work out enough R to make my package work.
Most of these matrix functions are pretty much old-fashioned math translated
into R. I can't see that R will engage lawyers if the OP translates the variable
names to the ones he is using and more or less mimics the bits of code needed.

Cheers, JN


On 2021-06-02 3:15 p.m., John Harrold wrote:
> To add another option. In the past when this has happened to me I've found
> other packages that provide similar functionality.
> 
> I'm assuming that is.square just checks the number of columns == number of
> rows? And the others can probably be implemented pretty easily.
> 
> On Wed, Jun 2, 2021 at 10:41 AM Ben Staton <statonbe at gmail.com> wrote:
> 
>> My package uses the MIT license, so would that not meet the compatibility
>> requirements?
>>
>> I will attempt to reach out to the package author - thanks for your help!
>>
>> On Wed, Jun 2, 2021 at 10:31 AM Ben Bolker <bbolker at gmail.com> wrote:
>>
>>>     That all sounds exactly right.
>>>    GPL >= 2 allows you to use the material without asking permission as
>>> long as your package is compatibly licensed (e.g. also GPL).
>>>    Under normal circumstances it would be polite to ask permission, but
>>> if the reason for doing this is that the maintainer is unreachable in
>>> the first place ...
>>>
>>>   If you want to try a little harder, it seems quite possible that you
>>> can reach the matrixcalc maintainer at the (personal) e-mail address
>>> shown in this page:
>>>
>>>
>> https://www.facebook.com/photo/?fbid=10208324530363130&set=ecnf.1000413042
>>>
>>>    (Possibly an identity confusion, but I rate that as unlikely based on
>>> other facebook snooping)
>>>
>>>    I don't think a short, polite e-mail request would be out of bounds,
>>> they can always ignore it or tell you to go away.
>>>
>>>    cheers
>>>     Ben Bolker
>>>
>>> On 6/2/21 1:15 PM, Ben Staton wrote:
>>>> Hello,
>>>>
>>>> Thank you for your detailed list of solutions.
>>>>
>>>> I was initially tempted to go with option 1 (move matrixcalc to
>> suggests
>>>> and check for its existence before using functions that rely on it),
>> but
>>> as
>>>> mentioned, this is not a long term fix.
>>>>
>>>> I unfortunately can't take on the responsibilities of option 2
>> (becoming
>>>> the package maintainer) -- there is much that this package does that I
>> do
>>>> not understand, and do not wish to feign authority!
>>>>
>>>> I plan to take option 3 (copy the needed functions into my package).
>>> There
>>>> are only three functions I need from matrixcalc, and all three are
>> fairly
>>>> simple (is.square.matrix
>>>> <https://rdrr.io/cran/matrixcalc/src/R/is.square.matrix.R>,
>>>> is.symmetric.matrix
>>>> <https://rdrr.io/cran/matrixcalc/src/R/is.symmetric.matrix.R>, and
>>>> is.positive.definite
>>>> <https://rdrr.io/cran/matrixcalc/src/R/is.positive.definite.R>) and
>>> there
>>>> is only one function in postpack that needs them. I plan to define them
>>>> within the postpack function. matrixcalc is licensed under GPL >= 2 and
>>>> based on my scan of the license text, this is allowed. Is that correct?
>>>>
>>>> Regarding option 4 (contacting the matrixcalc maintainer), the original
>>>> email from CRAN mentioned that they have attempted to contact the
>> package
>>>> author with no response.
>>>>
>>>> Thank you!
>>>>
>>>> On Wed, Jun 2, 2021 at 9:52 AM J C Nash <profjcnash at gmail.com> wrote:
>>>>
>>>>> I just downloaded the source matrixcalc package to see what it
>>> contained.
>>>>> The functions
>>>>> I looked at seem fairly straightforward and the OP could likely
>> develop
>>>>> equivalent features
>>>>> in his own code, possibly avoiding a function call. Avoiding the
>>> function
>>>>> call means NAMESPACE etc. are not involved, so fewer places for
>> getting
>>>>> into
>>>>> trouble, assuming the inline code works properly.
>>>>>
>>>>> JN
>>>>>
>>>>>
>>>>> On 2021-06-02 12:37 p.m., Duncan Murdoch wrote:
>>>>>> On 02/06/2021 12:13 p.m., Ben Staton wrote:
>>>>>>> Hello,
>>>>>>>
>>>>>>> I received an email notice from CRAN indicating that my R package
>>>>>>> ('postpack') will be archived soon if I do not take any action and I
>>>>> want
>>>>>>> to avoid that outcome. The issue is not caused by my package, but
>>>>> instead a
>>>>>>> package that my package depends on:
>>>>>>>
>>>>>>> "... package 'matrixcalc' is now scheduled for archival on
>> 2021-06-09,
>>>>>>> and archiving this will necessitate also archiving its strong
>> reverse
>>>>>>> dependencies."
>>>>>>>
>>>>>>> Evidently, xyz has been returning errors on new R builds prompting
>>> CRAN
>>>>> to
>>>>>>> list it as a package to be archived. My package, 'postpack' has
>>>>>>> 'matrixcalc' listed in the Imports field, which I assume is why I
>>>>> received
>>>>>>> this email.
>>>>>>>
>>>>>>> I want to keep 'postpack' active and don't want it to be archived. I
>>>>> still
>>>>>>> need package 'matrixcalc' for my package, but not for most
>> functions.
>>>>> Could
>>>>>>> I simply move package 'matrixcalc' to the Suggests list and submit
>> the
>>>>> new
>>>>>>> version to CRAN to remove the "Strong Reverse Dependency" issue that
>>>>>>> triggered this email to avoid CRAN from archiving my package?
>>>>>>
>>>>>> That's part of one solution, but not the best solution.
>>>>>>
>>>>>> If you move it to Suggests, you should make sure that your package
>>>>> checks for it before every use, and falls back to
>>>>>> some other calculation if it is not present.  Be aware that once it
>> is
>>>>> archived, almost none of your users will have it
>>>>>> available, so this is kind of like dropping the functions that it
>>>>> supports.
>>>>>>
>>>>>> Another solution which would be great for the community might be for
>>> you
>>>>> to offer to take over as maintainer of
>>>>>> matrixcalc.  Then you'd fix whatever problems it has, and you
>> wouldn't
>>>>> need to worry about it.  I haven't looked at the
>>>>>> issues so I don't know if this is feasible.
>>>>>>
>>>>>> A third choice would be for you to copy the functions you need from
>>>>> matrixcalc into your own package so you can drop the
>>>>>> dependency.  This is generally legal under the licenses that CRAN
>>>>> accepts, but you should check anyway.
>>>>>>
>>>>>> A fourth choice would be for you to contact the matrixcalc
>> maintainer,
>>>>> and help them to fix the issues so that
>>>>>> matrixcalc doesn't get archived.  They may or may not be willing to
>>> work
>>>>> with you.
>>>>>>
>>>>>> I'd say my third choice is the best choice in the short term, and 2nd
>>> or
>>>>> 4th would be good long term solutions.
>>>>>>
>>>>>> Duncan Murdoch
>>>>>>
>>>>>> ______________________________________________
>>>>>> R-package-devel at r-project.org mailing list
>>>>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>>>
>>>>
>>>>       [[alternative HTML version deleted]]
>>>>
>>>> ______________________________________________
>>>> R-package-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>>
>>>
>>> ______________________________________________
>>> R-package-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>
>>
>>         [[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>
> 
>


From @vr@h@m@@d|er @end|ng |rom gm@||@com  Wed Jun  2 21:28:25 2021
From: @vr@h@m@@d|er @end|ng |rom gm@||@com (Avraham Adler)
Date: Wed, 2 Jun 2021 15:28:25 -0400
Subject: [R-pkg-devel] Question about preventing CRAN package archival
In-Reply-To: <CANAiAiWgd20=JRgeqJC65ESPHnT1Ge=HeiFWaPRJmzcNjZQHmQ@mail.gmail.com>
References: <CAH4d-wc4mWJBtu62tjBN1UOcoVXOAyHfVZbxKt8fXchzsqiRZg@mail.gmail.com>
 <bee0fa79-f930-aba1-21e4-80168eba6ef4@gmail.com>
 <bb739be4-7311-b770-3fef-a8124f4a489f@gmail.com>
 <CAH4d-wfVS6xdSBUiCiwxe=Bge4mS6tJnLxH43pOXgMf+WVCkuw@mail.gmail.com>
 <198da970-8073-bbda-ed52-39eafc5c85df@gmail.com>
 <CAH4d-we12i5GTJ_O_YNHSwpZzZUnf7kD=QpCzpEJSdvgW9wPiA@mail.gmail.com>
 <CANAiAiWgd20=JRgeqJC65ESPHnT1Ge=HeiFWaPRJmzcNjZQHmQ@mail.gmail.com>
Message-ID: <CAL6gwnJjVPWs5rhB68knT-b=nOK=40ZOAFN2Rzx+WFUq2+ZFAg@mail.gmail.com>

Exactly. Is square is just brow=ncol, is positive definite can be
implemented as a check that all eigenvalues > 0, which can be done with
base, and is.symmetric can be simply brute forced in a loop comparing i,j
with j,i.

The fewer dependencies a package has, the more robust it is. It?s a fine
balance between not reinventing the wheel and ceding too much stability to
other packages.

Thanks,

Avi

On Wed, Jun 2, 2021 at 3:15 PM John Harrold <john.m.harrold at gmail.com>
wrote:

> To add another option. In the past when this has happened to me I've found
> other packages that provide similar functionality.
>
> I'm assuming that is.square just checks the number of columns == number of
> rows? And the others can probably be implemented pretty easily.
>
> On Wed, Jun 2, 2021 at 10:41 AM Ben Staton <statonbe at gmail.com> wrote:
>
> > My package uses the MIT license, so would that not meet the compatibility
> > requirements?
> >
> > I will attempt to reach out to the package author - thanks for your help!
> >
> > On Wed, Jun 2, 2021 at 10:31 AM Ben Bolker <bbolker at gmail.com> wrote:
> >
> > >     That all sounds exactly right.
> > >    GPL >= 2 allows you to use the material without asking permission as
> > > long as your package is compatibly licensed (e.g. also GPL).
> > >    Under normal circumstances it would be polite to ask permission, but
> > > if the reason for doing this is that the maintainer is unreachable in
> > > the first place ...
> > >
> > >   If you want to try a little harder, it seems quite possible that you
> > > can reach the matrixcalc maintainer at the (personal) e-mail address
> > > shown in this page:
> > >
> > >
> >
> https://www.facebook.com/photo/?fbid=10208324530363130&set=ecnf.1000413042
> > >
> > >    (Possibly an identity confusion, but I rate that as unlikely based
> on
> > > other facebook snooping)
> > >
> > >    I don't think a short, polite e-mail request would be out of bounds,
> > > they can always ignore it or tell you to go away.
> > >
> > >    cheers
> > >     Ben Bolker
> > >
> > > On 6/2/21 1:15 PM, Ben Staton wrote:
> > > > Hello,
> > > >
> > > > Thank you for your detailed list of solutions.
> > > >
> > > > I was initially tempted to go with option 1 (move matrixcalc to
> > suggests
> > > > and check for its existence before using functions that rely on it),
> > but
> > > as
> > > > mentioned, this is not a long term fix.
> > > >
> > > > I unfortunately can't take on the responsibilities of option 2
> > (becoming
> > > > the package maintainer) -- there is much that this package does that
> I
> > do
> > > > not understand, and do not wish to feign authority!
> > > >
> > > > I plan to take option 3 (copy the needed functions into my package).
> > > There
> > > > are only three functions I need from matrixcalc, and all three are
> > fairly
> > > > simple (is.square.matrix
> > > > <https://rdrr.io/cran/matrixcalc/src/R/is.square.matrix.R>,
> > > > is.symmetric.matrix
> > > > <https://rdrr.io/cran/matrixcalc/src/R/is.symmetric.matrix.R>, and
> > > > is.positive.definite
> > > > <https://rdrr.io/cran/matrixcalc/src/R/is.positive.definite.R>) and
> > > there
> > > > is only one function in postpack that needs them. I plan to define
> them
> > > > within the postpack function. matrixcalc is licensed under GPL >= 2
> and
> > > > based on my scan of the license text, this is allowed. Is that
> correct?
> > > >
> > > > Regarding option 4 (contacting the matrixcalc maintainer), the
> original
> > > > email from CRAN mentioned that they have attempted to contact the
> > package
> > > > author with no response.
> > > >
> > > > Thank you!
> > > >
> > > > On Wed, Jun 2, 2021 at 9:52 AM J C Nash <profjcnash at gmail.com>
> wrote:
> > > >
> > > >> I just downloaded the source matrixcalc package to see what it
> > > contained.
> > > >> The functions
> > > >> I looked at seem fairly straightforward and the OP could likely
> > develop
> > > >> equivalent features
> > > >> in his own code, possibly avoiding a function call. Avoiding the
> > > function
> > > >> call means NAMESPACE etc. are not involved, so fewer places for
> > getting
> > > >> into
> > > >> trouble, assuming the inline code works properly.
> > > >>
> > > >> JN
> > > >>
> > > >>
> > > >> On 2021-06-02 12:37 p.m., Duncan Murdoch wrote:
> > > >>> On 02/06/2021 12:13 p.m., Ben Staton wrote:
> > > >>>> Hello,
> > > >>>>
> > > >>>> I received an email notice from CRAN indicating that my R package
> > > >>>> ('postpack') will be archived soon if I do not take any action
> and I
> > > >> want
> > > >>>> to avoid that outcome. The issue is not caused by my package, but
> > > >> instead a
> > > >>>> package that my package depends on:
> > > >>>>
> > > >>>> "... package 'matrixcalc' is now scheduled for archival on
> > 2021-06-09,
> > > >>>> and archiving this will necessitate also archiving its strong
> > reverse
> > > >>>> dependencies."
> > > >>>>
> > > >>>> Evidently, xyz has been returning errors on new R builds prompting
> > > CRAN
> > > >> to
> > > >>>> list it as a package to be archived. My package, 'postpack' has
> > > >>>> 'matrixcalc' listed in the Imports field, which I assume is why I
> > > >> received
> > > >>>> this email.
> > > >>>>
> > > >>>> I want to keep 'postpack' active and don't want it to be
> archived. I
> > > >> still
> > > >>>> need package 'matrixcalc' for my package, but not for most
> > functions.
> > > >> Could
> > > >>>> I simply move package 'matrixcalc' to the Suggests list and submit
> > the
> > > >> new
> > > >>>> version to CRAN to remove the "Strong Reverse Dependency" issue
> that
> > > >>>> triggered this email to avoid CRAN from archiving my package?
> > > >>>
> > > >>> That's part of one solution, but not the best solution.
> > > >>>
> > > >>> If you move it to Suggests, you should make sure that your package
> > > >> checks for it before every use, and falls back to
> > > >>> some other calculation if it is not present.  Be aware that once it
> > is
> > > >> archived, almost none of your users will have it
> > > >>> available, so this is kind of like dropping the functions that it
> > > >> supports.
> > > >>>
> > > >>> Another solution which would be great for the community might be
> for
> > > you
> > > >> to offer to take over as maintainer of
> > > >>> matrixcalc.  Then you'd fix whatever problems it has, and you
> > wouldn't
> > > >> need to worry about it.  I haven't looked at the
> > > >>> issues so I don't know if this is feasible.
> > > >>>
> > > >>> A third choice would be for you to copy the functions you need from
> > > >> matrixcalc into your own package so you can drop the
> > > >>> dependency.  This is generally legal under the licenses that CRAN
> > > >> accepts, but you should check anyway.
> > > >>>
> > > >>> A fourth choice would be for you to contact the matrixcalc
> > maintainer,
> > > >> and help them to fix the issues so that
> > > >>> matrixcalc doesn't get archived.  They may or may not be willing to
> > > work
> > > >> with you.
> > > >>>
> > > >>> I'd say my third choice is the best choice in the short term, and
> 2nd
> > > or
> > > >> 4th would be good long term solutions.
> > > >>>
> > > >>> Duncan Murdoch
> > > >>>
> > > >>> ______________________________________________
> > > >>> R-package-devel at r-project.org mailing list
> > > >>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
> > > >>
> > > >
> > > >       [[alternative HTML version deleted]]
> > > >
> > > > ______________________________________________
> > > > R-package-devel at r-project.org mailing list
> > > > https://stat.ethz.ch/mailman/listinfo/r-package-devel
> > > >
> > >
> > > ______________________________________________
> > > R-package-devel at r-project.org mailing list
> > > https://stat.ethz.ch/mailman/listinfo/r-package-devel
> > >
> >
> >         [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-package-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-package-devel
> >
>
>
> --
> John
> :wq
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>
-- 
Sent from Gmail Mobile

	[[alternative HTML version deleted]]


From roy@mende|@@ohn @end|ng |rom no@@@gov  Wed Jun  2 21:41:58 2021
From: roy@mende|@@ohn @end|ng |rom no@@@gov (Roy Mendelssohn - NOAA Federal)
Date: Wed, 2 Jun 2021 12:41:58 -0700
Subject: [R-pkg-devel] Question about preventing CRAN package archival
In-Reply-To: <CAH4d-we12i5GTJ_O_YNHSwpZzZUnf7kD=QpCzpEJSdvgW9wPiA@mail.gmail.com>
References: <CAH4d-wc4mWJBtu62tjBN1UOcoVXOAyHfVZbxKt8fXchzsqiRZg@mail.gmail.com>
 <bee0fa79-f930-aba1-21e4-80168eba6ef4@gmail.com>
 <bb739be4-7311-b770-3fef-a8124f4a489f@gmail.com>
 <CAH4d-wfVS6xdSBUiCiwxe=Bge4mS6tJnLxH43pOXgMf+WVCkuw@mail.gmail.com>
 <198da970-8073-bbda-ed52-39eafc5c85df@gmail.com>
 <CAH4d-we12i5GTJ_O_YNHSwpZzZUnf7kD=QpCzpEJSdvgW9wPiA@mail.gmail.com>
Message-ID: <CA723C2A-1C65-4A5E-A9AF-D3C05BB6D8D6@noaa.gov>

After looking up matrixcalc on CRAN,  I would recommend contacting the maintainer,  who is listed as:

> Frederick Novomestky <fnovomes at poly.edu>


The reason I say this is what is blowing up the package in the nightly builds is a careless error in one Example:

>   > x <- matrix( c( 2, 4, 2, 1, 3, 1, 5, 2, 1, 2, 3, 3 ), nrow=4, ncol=4, byrow=TRUE )
>     Error in matrix(c(2, 4, 2, 1, 3, 1, 5, 2, 1, 2, 3, 3), nrow = 4, ncol = 4, : 
>      data length differs from size of matrix: [12 != 4 x 4]
> 

That should be pretty easy for the maintainer to fix and to resubmit.

-Roy


> On Jun 2, 2021, at 10:36 AM, Ben Staton <statonbe at gmail.com> wrote:
> 
> My package uses the MIT license, so would that not meet the compatibility
> requirements?
> 
> I will attempt to reach out to the package author - thanks for your help!
> 
> On Wed, Jun 2, 2021 at 10:31 AM Ben Bolker <bbolker at gmail.com> wrote:
> 
>>    That all sounds exactly right.
>>   GPL >= 2 allows you to use the material without asking permission as
>> long as your package is compatibly licensed (e.g. also GPL).
>>   Under normal circumstances it would be polite to ask permission, but
>> if the reason for doing this is that the maintainer is unreachable in
>> the first place ...
>> 
>>  If you want to try a little harder, it seems quite possible that you
>> can reach the matrixcalc maintainer at the (personal) e-mail address
>> shown in this page:
>> 
>> https://www.facebook.com/photo/?fbid=10208324530363130&set=ecnf.1000413042
>> 
>>   (Possibly an identity confusion, but I rate that as unlikely based on
>> other facebook snooping)
>> 
>>   I don't think a short, polite e-mail request would be out of bounds,
>> they can always ignore it or tell you to go away.
>> 
>>   cheers
>>    Ben Bolker
>> 
>> On 6/2/21 1:15 PM, Ben Staton wrote:
>>> Hello,
>>> 
>>> Thank you for your detailed list of solutions.
>>> 
>>> I was initially tempted to go with option 1 (move matrixcalc to suggests
>>> and check for its existence before using functions that rely on it), but
>> as
>>> mentioned, this is not a long term fix.
>>> 
>>> I unfortunately can't take on the responsibilities of option 2 (becoming
>>> the package maintainer) -- there is much that this package does that I do
>>> not understand, and do not wish to feign authority!
>>> 
>>> I plan to take option 3 (copy the needed functions into my package).
>> There
>>> are only three functions I need from matrixcalc, and all three are fairly
>>> simple (is.square.matrix
>>> <https://rdrr.io/cran/matrixcalc/src/R/is.square.matrix.R>,
>>> is.symmetric.matrix
>>> <https://rdrr.io/cran/matrixcalc/src/R/is.symmetric.matrix.R>, and
>>> is.positive.definite
>>> <https://rdrr.io/cran/matrixcalc/src/R/is.positive.definite.R>) and
>> there
>>> is only one function in postpack that needs them. I plan to define them
>>> within the postpack function. matrixcalc is licensed under GPL >= 2 and
>>> based on my scan of the license text, this is allowed. Is that correct?
>>> 
>>> Regarding option 4 (contacting the matrixcalc maintainer), the original
>>> email from CRAN mentioned that they have attempted to contact the package
>>> author with no response.
>>> 
>>> Thank you!
>>> 
>>> On Wed, Jun 2, 2021 at 9:52 AM J C Nash <profjcnash at gmail.com> wrote:
>>> 
>>>> I just downloaded the source matrixcalc package to see what it
>> contained.
>>>> The functions
>>>> I looked at seem fairly straightforward and the OP could likely develop
>>>> equivalent features
>>>> in his own code, possibly avoiding a function call. Avoiding the
>> function
>>>> call means NAMESPACE etc. are not involved, so fewer places for getting
>>>> into
>>>> trouble, assuming the inline code works properly.
>>>> 
>>>> JN
>>>> 
>>>> 
>>>> On 2021-06-02 12:37 p.m., Duncan Murdoch wrote:
>>>>> On 02/06/2021 12:13 p.m., Ben Staton wrote:
>>>>>> Hello,
>>>>>> 
>>>>>> I received an email notice from CRAN indicating that my R package
>>>>>> ('postpack') will be archived soon if I do not take any action and I
>>>> want
>>>>>> to avoid that outcome. The issue is not caused by my package, but
>>>> instead a
>>>>>> package that my package depends on:
>>>>>> 
>>>>>> "... package 'matrixcalc' is now scheduled for archival on 2021-06-09,
>>>>>> and archiving this will necessitate also archiving its strong reverse
>>>>>> dependencies."
>>>>>> 
>>>>>> Evidently, xyz has been returning errors on new R builds prompting
>> CRAN
>>>> to
>>>>>> list it as a package to be archived. My package, 'postpack' has
>>>>>> 'matrixcalc' listed in the Imports field, which I assume is why I
>>>> received
>>>>>> this email.
>>>>>> 
>>>>>> I want to keep 'postpack' active and don't want it to be archived. I
>>>> still
>>>>>> need package 'matrixcalc' for my package, but not for most functions.
>>>> Could
>>>>>> I simply move package 'matrixcalc' to the Suggests list and submit the
>>>> new
>>>>>> version to CRAN to remove the "Strong Reverse Dependency" issue that
>>>>>> triggered this email to avoid CRAN from archiving my package?
>>>>> 
>>>>> That's part of one solution, but not the best solution.
>>>>> 
>>>>> If you move it to Suggests, you should make sure that your package
>>>> checks for it before every use, and falls back to
>>>>> some other calculation if it is not present.  Be aware that once it is
>>>> archived, almost none of your users will have it
>>>>> available, so this is kind of like dropping the functions that it
>>>> supports.
>>>>> 
>>>>> Another solution which would be great for the community might be for
>> you
>>>> to offer to take over as maintainer of
>>>>> matrixcalc.  Then you'd fix whatever problems it has, and you wouldn't
>>>> need to worry about it.  I haven't looked at the
>>>>> issues so I don't know if this is feasible.
>>>>> 
>>>>> A third choice would be for you to copy the functions you need from
>>>> matrixcalc into your own package so you can drop the
>>>>> dependency.  This is generally legal under the licenses that CRAN
>>>> accepts, but you should check anyway.
>>>>> 
>>>>> A fourth choice would be for you to contact the matrixcalc maintainer,
>>>> and help them to fix the issues so that
>>>>> matrixcalc doesn't get archived.  They may or may not be willing to
>> work
>>>> with you.
>>>>> 
>>>>> I'd say my third choice is the best choice in the short term, and 2nd
>> or
>>>> 4th would be good long term solutions.
>>>>> 
>>>>> Duncan Murdoch
>>>>> 
>>>>> ______________________________________________
>>>>> R-package-devel at r-project.org mailing list
>>>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>> 
>>> 
>>>      [[alternative HTML version deleted]]
>>> 
>>> ______________________________________________
>>> R-package-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>> 
>> 
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>> 
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel

**********************
"The contents of this message do not reflect any position of the U.S. Government or NOAA."
**********************
Roy Mendelssohn
Supervisory Operations Research Analyst
NOAA/NMFS
Environmental Research Division
Southwest Fisheries Science Center
***Note new street address***
110 McAllister Way
Santa Cruz, CA 95060
Phone: (831)-420-3666
Fax: (831) 420-3980
e-mail: Roy.Mendelssohn at noaa.gov www: https://www.pfeg.noaa.gov/

"Old age and treachery will overcome youth and skill."
"From those who have been given much, much will be expected" 
"the arc of the moral universe is long, but it bends toward justice" -MLK Jr.


From @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org  Wed Jun  2 21:48:12 2021
From: @pencer@gr@ve@ @end|ng |rom e||ect|vede|en@e@org (Spencer Graves)
Date: Wed, 2 Jun 2021 14:48:12 -0500
Subject: [R-pkg-devel] Question about preventing CRAN package archival
In-Reply-To: <CA723C2A-1C65-4A5E-A9AF-D3C05BB6D8D6@noaa.gov>
References: <CAH4d-wc4mWJBtu62tjBN1UOcoVXOAyHfVZbxKt8fXchzsqiRZg@mail.gmail.com>
 <bee0fa79-f930-aba1-21e4-80168eba6ef4@gmail.com>
 <bb739be4-7311-b770-3fef-a8124f4a489f@gmail.com>
 <CAH4d-wfVS6xdSBUiCiwxe=Bge4mS6tJnLxH43pOXgMf+WVCkuw@mail.gmail.com>
 <198da970-8073-bbda-ed52-39eafc5c85df@gmail.com>
 <CAH4d-we12i5GTJ_O_YNHSwpZzZUnf7kD=QpCzpEJSdvgW9wPiA@mail.gmail.com>
 <CA723C2A-1C65-4A5E-A9AF-D3C05BB6D8D6@noaa.gov>
Message-ID: <059d1e81-0dbd-3516-ec14-37d1538aebc1@effectivedefense.org>

	  The CRAN maintainers almost certainly have tried to contact the 
maintainer.  You can ask if he plans to fix the bug.  If not, if it's 
that easy to fix, you could offer to both the maintainers of both 
matrixcalc and CRAN to take over maintenance.


	  Spencer


On 6/2/21 2:41 PM, Roy Mendelssohn - NOAA Federal via R-package-devel wrote:
> After looking up matrixcalc on CRAN,  I would recommend contacting the maintainer,  who is listed as:
> 
>> Frederick Novomestky <fnovomes at poly.edu>
> 
> 
> The reason I say this is what is blowing up the package in the nightly builds is a careless error in one Example:
> 
>>    > x <- matrix( c( 2, 4, 2, 1, 3, 1, 5, 2, 1, 2, 3, 3 ), nrow=4, ncol=4, byrow=TRUE )
>>      Error in matrix(c(2, 4, 2, 1, 3, 1, 5, 2, 1, 2, 3, 3), nrow = 4, ncol = 4, :
>>       data length differs from size of matrix: [12 != 4 x 4]
>>
> 
> That should be pretty easy for the maintainer to fix and to resubmit.
> 
> -Roy
> 
> 
>> On Jun 2, 2021, at 10:36 AM, Ben Staton <statonbe at gmail.com> wrote:
>>
>> My package uses the MIT license, so would that not meet the compatibility
>> requirements?
>>
>> I will attempt to reach out to the package author - thanks for your help!
>>
>> On Wed, Jun 2, 2021 at 10:31 AM Ben Bolker <bbolker at gmail.com> wrote:
>>
>>>     That all sounds exactly right.
>>>    GPL >= 2 allows you to use the material without asking permission as
>>> long as your package is compatibly licensed (e.g. also GPL).
>>>    Under normal circumstances it would be polite to ask permission, but
>>> if the reason for doing this is that the maintainer is unreachable in
>>> the first place ...
>>>
>>>   If you want to try a little harder, it seems quite possible that you
>>> can reach the matrixcalc maintainer at the (personal) e-mail address
>>> shown in this page:
>>>
>>> https://www.facebook.com/photo/?fbid=10208324530363130&set=ecnf.1000413042
>>>
>>>    (Possibly an identity confusion, but I rate that as unlikely based on
>>> other facebook snooping)
>>>
>>>    I don't think a short, polite e-mail request would be out of bounds,
>>> they can always ignore it or tell you to go away.
>>>
>>>    cheers
>>>     Ben Bolker
>>>
>>> On 6/2/21 1:15 PM, Ben Staton wrote:
>>>> Hello,
>>>>
>>>> Thank you for your detailed list of solutions.
>>>>
>>>> I was initially tempted to go with option 1 (move matrixcalc to suggests
>>>> and check for its existence before using functions that rely on it), but
>>> as
>>>> mentioned, this is not a long term fix.
>>>>
>>>> I unfortunately can't take on the responsibilities of option 2 (becoming
>>>> the package maintainer) -- there is much that this package does that I do
>>>> not understand, and do not wish to feign authority!
>>>>
>>>> I plan to take option 3 (copy the needed functions into my package).
>>> There
>>>> are only three functions I need from matrixcalc, and all three are fairly
>>>> simple (is.square.matrix
>>>> <https://rdrr.io/cran/matrixcalc/src/R/is.square.matrix.R>,
>>>> is.symmetric.matrix
>>>> <https://rdrr.io/cran/matrixcalc/src/R/is.symmetric.matrix.R>, and
>>>> is.positive.definite
>>>> <https://rdrr.io/cran/matrixcalc/src/R/is.positive.definite.R>) and
>>> there
>>>> is only one function in postpack that needs them. I plan to define them
>>>> within the postpack function. matrixcalc is licensed under GPL >= 2 and
>>>> based on my scan of the license text, this is allowed. Is that correct?
>>>>
>>>> Regarding option 4 (contacting the matrixcalc maintainer), the original
>>>> email from CRAN mentioned that they have attempted to contact the package
>>>> author with no response.
>>>>
>>>> Thank you!
>>>>
>>>> On Wed, Jun 2, 2021 at 9:52 AM J C Nash <profjcnash at gmail.com> wrote:
>>>>
>>>>> I just downloaded the source matrixcalc package to see what it
>>> contained.
>>>>> The functions
>>>>> I looked at seem fairly straightforward and the OP could likely develop
>>>>> equivalent features
>>>>> in his own code, possibly avoiding a function call. Avoiding the
>>> function
>>>>> call means NAMESPACE etc. are not involved, so fewer places for getting
>>>>> into
>>>>> trouble, assuming the inline code works properly.
>>>>>
>>>>> JN
>>>>>
>>>>>
>>>>> On 2021-06-02 12:37 p.m., Duncan Murdoch wrote:
>>>>>> On 02/06/2021 12:13 p.m., Ben Staton wrote:
>>>>>>> Hello,
>>>>>>>
>>>>>>> I received an email notice from CRAN indicating that my R package
>>>>>>> ('postpack') will be archived soon if I do not take any action and I
>>>>> want
>>>>>>> to avoid that outcome. The issue is not caused by my package, but
>>>>> instead a
>>>>>>> package that my package depends on:
>>>>>>>
>>>>>>> "... package 'matrixcalc' is now scheduled for archival on 2021-06-09,
>>>>>>> and archiving this will necessitate also archiving its strong reverse
>>>>>>> dependencies."
>>>>>>>
>>>>>>> Evidently, xyz has been returning errors on new R builds prompting
>>> CRAN
>>>>> to
>>>>>>> list it as a package to be archived. My package, 'postpack' has
>>>>>>> 'matrixcalc' listed in the Imports field, which I assume is why I
>>>>> received
>>>>>>> this email.
>>>>>>>
>>>>>>> I want to keep 'postpack' active and don't want it to be archived. I
>>>>> still
>>>>>>> need package 'matrixcalc' for my package, but not for most functions.
>>>>> Could
>>>>>>> I simply move package 'matrixcalc' to the Suggests list and submit the
>>>>> new
>>>>>>> version to CRAN to remove the "Strong Reverse Dependency" issue that
>>>>>>> triggered this email to avoid CRAN from archiving my package?
>>>>>>
>>>>>> That's part of one solution, but not the best solution.
>>>>>>
>>>>>> If you move it to Suggests, you should make sure that your package
>>>>> checks for it before every use, and falls back to
>>>>>> some other calculation if it is not present.  Be aware that once it is
>>>>> archived, almost none of your users will have it
>>>>>> available, so this is kind of like dropping the functions that it
>>>>> supports.
>>>>>>
>>>>>> Another solution which would be great for the community might be for
>>> you
>>>>> to offer to take over as maintainer of
>>>>>> matrixcalc.  Then you'd fix whatever problems it has, and you wouldn't
>>>>> need to worry about it.  I haven't looked at the
>>>>>> issues so I don't know if this is feasible.
>>>>>>
>>>>>> A third choice would be for you to copy the functions you need from
>>>>> matrixcalc into your own package so you can drop the
>>>>>> dependency.  This is generally legal under the licenses that CRAN
>>>>> accepts, but you should check anyway.
>>>>>>
>>>>>> A fourth choice would be for you to contact the matrixcalc maintainer,
>>>>> and help them to fix the issues so that
>>>>>> matrixcalc doesn't get archived.  They may or may not be willing to
>>> work
>>>>> with you.
>>>>>>
>>>>>> I'd say my third choice is the best choice in the short term, and 2nd
>>> or
>>>>> 4th would be good long term solutions.
>>>>>>
>>>>>> Duncan Murdoch
>>>>>>
>>>>>> ______________________________________________
>>>>>> R-package-devel at r-project.org mailing list
>>>>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>>>
>>>>
>>>>       [[alternative HTML version deleted]]
>>>>
>>>> ______________________________________________
>>>> R-package-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>>
>>>
>>> ______________________________________________
>>> R-package-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>
>>
>> 	[[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
> 
> **********************
> "The contents of this message do not reflect any position of the U.S. Government or NOAA."
> **********************
> Roy Mendelssohn
> Supervisory Operations Research Analyst
> NOAA/NMFS
> Environmental Research Division
> Southwest Fisheries Science Center
> ***Note new street address***
> 110 McAllister Way
> Santa Cruz, CA 95060
> Phone: (831)-420-3666
> Fax: (831) 420-3980
> e-mail: Roy.Mendelssohn at noaa.gov www: https://www.pfeg.noaa.gov/
> 
> "Old age and treachery will overcome youth and skill."
> "From those who have been given much, much will be expected"
> "the arc of the moral universe is long, but it bends toward justice" -MLK Jr.
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


From @t@tonbe @end|ng |rom gm@||@com  Wed Jun  2 22:16:16 2021
From: @t@tonbe @end|ng |rom gm@||@com (Ben Staton)
Date: Wed, 2 Jun 2021 13:16:16 -0700
Subject: [R-pkg-devel] Question about preventing CRAN package archival
In-Reply-To: <059d1e81-0dbd-3516-ec14-37d1538aebc1@effectivedefense.org>
References: <CAH4d-wc4mWJBtu62tjBN1UOcoVXOAyHfVZbxKt8fXchzsqiRZg@mail.gmail.com>
 <bee0fa79-f930-aba1-21e4-80168eba6ef4@gmail.com>
 <bb739be4-7311-b770-3fef-a8124f4a489f@gmail.com>
 <CAH4d-wfVS6xdSBUiCiwxe=Bge4mS6tJnLxH43pOXgMf+WVCkuw@mail.gmail.com>
 <198da970-8073-bbda-ed52-39eafc5c85df@gmail.com>
 <CAH4d-we12i5GTJ_O_YNHSwpZzZUnf7kD=QpCzpEJSdvgW9wPiA@mail.gmail.com>
 <CA723C2A-1C65-4A5E-A9AF-D3C05BB6D8D6@noaa.gov>
 <059d1e81-0dbd-3516-ec14-37d1538aebc1@effectivedefense.org>
Message-ID: <CAH4d-wefmqxYmZPEvPxQBaSROjDTB43tPKXn8180SK1Cs70N1w@mail.gmail.com>

Hi Everyone, thank you all for your responses.

I agree that I can replicate the three functions within matrixcalc that I
need with ease, even without copying and pasting the original code found in
that package and thus not creating any licensing issues.

I have checked the CRAN incoming boards (here
<https://lockedata.github.io/cransays/articles/dashboard.html>), and they
actually have a new version of matrixcalc coming through so hopefully this
issue will be resolved without my intervention.

On a related note, suppose that this issue does not get resolved before the
archival date, and my package gets archived. What would be the path for me
to have CRAN remove it from the archived list? Is it basically (1) fix the
issue that caused initial archival and (2) resubmit?

Thank you,
Ben

On Wed, Jun 2, 2021 at 12:48 PM Spencer Graves <
spencer.graves at effectivedefense.org> wrote:

>           The CRAN maintainers almost certainly have tried to contact the
> maintainer.  You can ask if he plans to fix the bug.  If not, if it's
> that easy to fix, you could offer to both the maintainers of both
> matrixcalc and CRAN to take over maintenance.
>
>
>           Spencer
>
>
> On 6/2/21 2:41 PM, Roy Mendelssohn - NOAA Federal via R-package-devel
> wrote:
> > After looking up matrixcalc on CRAN,  I would recommend contacting the
> maintainer,  who is listed as:
> >
> >> Frederick Novomestky <fnovomes at poly.edu>
> >
> >
> > The reason I say this is what is blowing up the package in the nightly
> builds is a careless error in one Example:
> >
> >>    > x <- matrix( c( 2, 4, 2, 1, 3, 1, 5, 2, 1, 2, 3, 3 ), nrow=4,
> ncol=4, byrow=TRUE )
> >>      Error in matrix(c(2, 4, 2, 1, 3, 1, 5, 2, 1, 2, 3, 3), nrow = 4,
> ncol = 4, :
> >>       data length differs from size of matrix: [12 != 4 x 4]
> >>
> >
> > That should be pretty easy for the maintainer to fix and to resubmit.
> >
> > -Roy
> >
> >
> >> On Jun 2, 2021, at 10:36 AM, Ben Staton <statonbe at gmail.com> wrote:
> >>
> >> My package uses the MIT license, so would that not meet the
> compatibility
> >> requirements?
> >>
> >> I will attempt to reach out to the package author - thanks for your
> help!
> >>
> >> On Wed, Jun 2, 2021 at 10:31 AM Ben Bolker <bbolker at gmail.com> wrote:
> >>
> >>>     That all sounds exactly right.
> >>>    GPL >= 2 allows you to use the material without asking permission as
> >>> long as your package is compatibly licensed (e.g. also GPL).
> >>>    Under normal circumstances it would be polite to ask permission, but
> >>> if the reason for doing this is that the maintainer is unreachable in
> >>> the first place ...
> >>>
> >>>   If you want to try a little harder, it seems quite possible that you
> >>> can reach the matrixcalc maintainer at the (personal) e-mail address
> >>> shown in this page:
> >>>
> >>>
> https://www.facebook.com/photo/?fbid=10208324530363130&set=ecnf.1000413042
> >>>
> >>>    (Possibly an identity confusion, but I rate that as unlikely based
> on
> >>> other facebook snooping)
> >>>
> >>>    I don't think a short, polite e-mail request would be out of bounds,
> >>> they can always ignore it or tell you to go away.
> >>>
> >>>    cheers
> >>>     Ben Bolker
> >>>
> >>> On 6/2/21 1:15 PM, Ben Staton wrote:
> >>>> Hello,
> >>>>
> >>>> Thank you for your detailed list of solutions.
> >>>>
> >>>> I was initially tempted to go with option 1 (move matrixcalc to
> suggests
> >>>> and check for its existence before using functions that rely on it),
> but
> >>> as
> >>>> mentioned, this is not a long term fix.
> >>>>
> >>>> I unfortunately can't take on the responsibilities of option 2
> (becoming
> >>>> the package maintainer) -- there is much that this package does that
> I do
> >>>> not understand, and do not wish to feign authority!
> >>>>
> >>>> I plan to take option 3 (copy the needed functions into my package).
> >>> There
> >>>> are only three functions I need from matrixcalc, and all three are
> fairly
> >>>> simple (is.square.matrix
> >>>> <https://rdrr.io/cran/matrixcalc/src/R/is.square.matrix.R>,
> >>>> is.symmetric.matrix
> >>>> <https://rdrr.io/cran/matrixcalc/src/R/is.symmetric.matrix.R>, and
> >>>> is.positive.definite
> >>>> <https://rdrr.io/cran/matrixcalc/src/R/is.positive.definite.R>) and
> >>> there
> >>>> is only one function in postpack that needs them. I plan to define
> them
> >>>> within the postpack function. matrixcalc is licensed under GPL >= 2
> and
> >>>> based on my scan of the license text, this is allowed. Is that
> correct?
> >>>>
> >>>> Regarding option 4 (contacting the matrixcalc maintainer), the
> original
> >>>> email from CRAN mentioned that they have attempted to contact the
> package
> >>>> author with no response.
> >>>>
> >>>> Thank you!
> >>>>
> >>>> On Wed, Jun 2, 2021 at 9:52 AM J C Nash <profjcnash at gmail.com> wrote:
> >>>>
> >>>>> I just downloaded the source matrixcalc package to see what it
> >>> contained.
> >>>>> The functions
> >>>>> I looked at seem fairly straightforward and the OP could likely
> develop
> >>>>> equivalent features
> >>>>> in his own code, possibly avoiding a function call. Avoiding the
> >>> function
> >>>>> call means NAMESPACE etc. are not involved, so fewer places for
> getting
> >>>>> into
> >>>>> trouble, assuming the inline code works properly.
> >>>>>
> >>>>> JN
> >>>>>
> >>>>>
> >>>>> On 2021-06-02 12:37 p.m., Duncan Murdoch wrote:
> >>>>>> On 02/06/2021 12:13 p.m., Ben Staton wrote:
> >>>>>>> Hello,
> >>>>>>>
> >>>>>>> I received an email notice from CRAN indicating that my R package
> >>>>>>> ('postpack') will be archived soon if I do not take any action and
> I
> >>>>> want
> >>>>>>> to avoid that outcome. The issue is not caused by my package, but
> >>>>> instead a
> >>>>>>> package that my package depends on:
> >>>>>>>
> >>>>>>> "... package 'matrixcalc' is now scheduled for archival on
> 2021-06-09,
> >>>>>>> and archiving this will necessitate also archiving its strong
> reverse
> >>>>>>> dependencies."
> >>>>>>>
> >>>>>>> Evidently, xyz has been returning errors on new R builds prompting
> >>> CRAN
> >>>>> to
> >>>>>>> list it as a package to be archived. My package, 'postpack' has
> >>>>>>> 'matrixcalc' listed in the Imports field, which I assume is why I
> >>>>> received
> >>>>>>> this email.
> >>>>>>>
> >>>>>>> I want to keep 'postpack' active and don't want it to be archived.
> I
> >>>>> still
> >>>>>>> need package 'matrixcalc' for my package, but not for most
> functions.
> >>>>> Could
> >>>>>>> I simply move package 'matrixcalc' to the Suggests list and submit
> the
> >>>>> new
> >>>>>>> version to CRAN to remove the "Strong Reverse Dependency" issue
> that
> >>>>>>> triggered this email to avoid CRAN from archiving my package?
> >>>>>>
> >>>>>> That's part of one solution, but not the best solution.
> >>>>>>
> >>>>>> If you move it to Suggests, you should make sure that your package
> >>>>> checks for it before every use, and falls back to
> >>>>>> some other calculation if it is not present.  Be aware that once it
> is
> >>>>> archived, almost none of your users will have it
> >>>>>> available, so this is kind of like dropping the functions that it
> >>>>> supports.
> >>>>>>
> >>>>>> Another solution which would be great for the community might be for
> >>> you
> >>>>> to offer to take over as maintainer of
> >>>>>> matrixcalc.  Then you'd fix whatever problems it has, and you
> wouldn't
> >>>>> need to worry about it.  I haven't looked at the
> >>>>>> issues so I don't know if this is feasible.
> >>>>>>
> >>>>>> A third choice would be for you to copy the functions you need from
> >>>>> matrixcalc into your own package so you can drop the
> >>>>>> dependency.  This is generally legal under the licenses that CRAN
> >>>>> accepts, but you should check anyway.
> >>>>>>
> >>>>>> A fourth choice would be for you to contact the matrixcalc
> maintainer,
> >>>>> and help them to fix the issues so that
> >>>>>> matrixcalc doesn't get archived.  They may or may not be willing to
> >>> work
> >>>>> with you.
> >>>>>>
> >>>>>> I'd say my third choice is the best choice in the short term, and
> 2nd
> >>> or
> >>>>> 4th would be good long term solutions.
> >>>>>>
> >>>>>> Duncan Murdoch
> >>>>>>
> >>>>>> ______________________________________________
> >>>>>> R-package-devel at r-project.org mailing list
> >>>>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
> >>>>>
> >>>>
> >>>>       [[alternative HTML version deleted]]
> >>>>
> >>>> ______________________________________________
> >>>> R-package-devel at r-project.org mailing list
> >>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
> >>>>
> >>>
> >>> ______________________________________________
> >>> R-package-devel at r-project.org mailing list
> >>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
> >>>
> >>
> >>      [[alternative HTML version deleted]]
> >>
> >> ______________________________________________
> >> R-package-devel at r-project.org mailing list
> >> https://stat.ethz.ch/mailman/listinfo/r-package-devel
> >
> > **********************
> > "The contents of this message do not reflect any position of the U.S.
> Government or NOAA."
> > **********************
> > Roy Mendelssohn
> > Supervisory Operations Research Analyst
> > NOAA/NMFS
> > Environmental Research Division
> > Southwest Fisheries Science Center
> > ***Note new street address***
> > 110 McAllister Way
> > Santa Cruz, CA 95060
> > Phone: (831)-420-3666
> > Fax: (831) 420-3980
> > e-mail: Roy.Mendelssohn at noaa.gov www: https://www.pfeg.noaa.gov/
> >
> > "Old age and treachery will overcome youth and skill."
> > "From those who have been given much, much will be expected"
> > "the arc of the moral universe is long, but it bends toward justice"
> -MLK Jr.
> >
> > ______________________________________________
> > R-package-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-package-devel
> >
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From bbo|ker @end|ng |rom gm@||@com  Wed Jun  2 22:30:43 2021
From: bbo|ker @end|ng |rom gm@||@com (Ben Bolker)
Date: Wed, 2 Jun 2021 16:30:43 -0400
Subject: [R-pkg-devel] Question about preventing CRAN package archival
In-Reply-To: <CAH4d-wefmqxYmZPEvPxQBaSROjDTB43tPKXn8180SK1Cs70N1w@mail.gmail.com>
References: <CAH4d-wc4mWJBtu62tjBN1UOcoVXOAyHfVZbxKt8fXchzsqiRZg@mail.gmail.com>
 <bee0fa79-f930-aba1-21e4-80168eba6ef4@gmail.com>
 <bb739be4-7311-b770-3fef-a8124f4a489f@gmail.com>
 <CAH4d-wfVS6xdSBUiCiwxe=Bge4mS6tJnLxH43pOXgMf+WVCkuw@mail.gmail.com>
 <198da970-8073-bbda-ed52-39eafc5c85df@gmail.com>
 <CAH4d-we12i5GTJ_O_YNHSwpZzZUnf7kD=QpCzpEJSdvgW9wPiA@mail.gmail.com>
 <CA723C2A-1C65-4A5E-A9AF-D3C05BB6D8D6@noaa.gov>
 <059d1e81-0dbd-3516-ec14-37d1538aebc1@effectivedefense.org>
 <CAH4d-wefmqxYmZPEvPxQBaSROjDTB43tPKXn8180SK1Cs70N1w@mail.gmail.com>
Message-ID: <77662188-6425-4290-0083-be1cd4e6a1fe@gmail.com>

   Write to the CRAN maintainers and let them know about the situation, 
hopefully that would prevent archiving.

On 6/2/21 4:16 PM, Ben Staton wrote:
> Hi Everyone, thank you all for your responses.
> 
> I agree that I can replicate the three functions within matrixcalc that I
> need with ease, even without copying and pasting the original code found in
> that package and thus not creating any licensing issues.
> 
> I have checked the CRAN incoming boards (here
> <https://lockedata.github.io/cransays/articles/dashboard.html>), and they
> actually have a new version of matrixcalc coming through so hopefully this
> issue will be resolved without my intervention.
> 
> On a related note, suppose that this issue does not get resolved before the
> archival date, and my package gets archived. What would be the path for me
> to have CRAN remove it from the archived list? Is it basically (1) fix the
> issue that caused initial archival and (2) resubmit?
> 
> Thank you,
> Ben
> 
> On Wed, Jun 2, 2021 at 12:48 PM Spencer Graves <
> spencer.graves at effectivedefense.org> wrote:
> 
>>            The CRAN maintainers almost certainly have tried to contact the
>> maintainer.  You can ask if he plans to fix the bug.  If not, if it's
>> that easy to fix, you could offer to both the maintainers of both
>> matrixcalc and CRAN to take over maintenance.
>>
>>
>>            Spencer
>>
>>
>> On 6/2/21 2:41 PM, Roy Mendelssohn - NOAA Federal via R-package-devel
>> wrote:
>>> After looking up matrixcalc on CRAN,  I would recommend contacting the
>> maintainer,  who is listed as:
>>>
>>>> Frederick Novomestky <fnovomes at poly.edu>
>>>
>>>
>>> The reason I say this is what is blowing up the package in the nightly
>> builds is a careless error in one Example:
>>>
>>>>     > x <- matrix( c( 2, 4, 2, 1, 3, 1, 5, 2, 1, 2, 3, 3 ), nrow=4,
>> ncol=4, byrow=TRUE )
>>>>       Error in matrix(c(2, 4, 2, 1, 3, 1, 5, 2, 1, 2, 3, 3), nrow = 4,
>> ncol = 4, :
>>>>        data length differs from size of matrix: [12 != 4 x 4]
>>>>
>>>
>>> That should be pretty easy for the maintainer to fix and to resubmit.
>>>
>>> -Roy
>>>
>>>
>>>> On Jun 2, 2021, at 10:36 AM, Ben Staton <statonbe at gmail.com> wrote:
>>>>
>>>> My package uses the MIT license, so would that not meet the
>> compatibility
>>>> requirements?
>>>>
>>>> I will attempt to reach out to the package author - thanks for your
>> help!
>>>>
>>>> On Wed, Jun 2, 2021 at 10:31 AM Ben Bolker <bbolker at gmail.com> wrote:
>>>>
>>>>>      That all sounds exactly right.
>>>>>     GPL >= 2 allows you to use the material without asking permission as
>>>>> long as your package is compatibly licensed (e.g. also GPL).
>>>>>     Under normal circumstances it would be polite to ask permission, but
>>>>> if the reason for doing this is that the maintainer is unreachable in
>>>>> the first place ...
>>>>>
>>>>>    If you want to try a little harder, it seems quite possible that you
>>>>> can reach the matrixcalc maintainer at the (personal) e-mail address
>>>>> shown in this page:
>>>>>
>>>>>
>> https://www.facebook.com/photo/?fbid=10208324530363130&set=ecnf.1000413042
>>>>>
>>>>>     (Possibly an identity confusion, but I rate that as unlikely based
>> on
>>>>> other facebook snooping)
>>>>>
>>>>>     I don't think a short, polite e-mail request would be out of bounds,
>>>>> they can always ignore it or tell you to go away.
>>>>>
>>>>>     cheers
>>>>>      Ben Bolker
>>>>>
>>>>> On 6/2/21 1:15 PM, Ben Staton wrote:
>>>>>> Hello,
>>>>>>
>>>>>> Thank you for your detailed list of solutions.
>>>>>>
>>>>>> I was initially tempted to go with option 1 (move matrixcalc to
>> suggests
>>>>>> and check for its existence before using functions that rely on it),
>> but
>>>>> as
>>>>>> mentioned, this is not a long term fix.
>>>>>>
>>>>>> I unfortunately can't take on the responsibilities of option 2
>> (becoming
>>>>>> the package maintainer) -- there is much that this package does that
>> I do
>>>>>> not understand, and do not wish to feign authority!
>>>>>>
>>>>>> I plan to take option 3 (copy the needed functions into my package).
>>>>> There
>>>>>> are only three functions I need from matrixcalc, and all three are
>> fairly
>>>>>> simple (is.square.matrix
>>>>>> <https://rdrr.io/cran/matrixcalc/src/R/is.square.matrix.R>,
>>>>>> is.symmetric.matrix
>>>>>> <https://rdrr.io/cran/matrixcalc/src/R/is.symmetric.matrix.R>, and
>>>>>> is.positive.definite
>>>>>> <https://rdrr.io/cran/matrixcalc/src/R/is.positive.definite.R>) and
>>>>> there
>>>>>> is only one function in postpack that needs them. I plan to define
>> them
>>>>>> within the postpack function. matrixcalc is licensed under GPL >= 2
>> and
>>>>>> based on my scan of the license text, this is allowed. Is that
>> correct?
>>>>>>
>>>>>> Regarding option 4 (contacting the matrixcalc maintainer), the
>> original
>>>>>> email from CRAN mentioned that they have attempted to contact the
>> package
>>>>>> author with no response.
>>>>>>
>>>>>> Thank you!
>>>>>>
>>>>>> On Wed, Jun 2, 2021 at 9:52 AM J C Nash <profjcnash at gmail.com> wrote:
>>>>>>
>>>>>>> I just downloaded the source matrixcalc package to see what it
>>>>> contained.
>>>>>>> The functions
>>>>>>> I looked at seem fairly straightforward and the OP could likely
>> develop
>>>>>>> equivalent features
>>>>>>> in his own code, possibly avoiding a function call. Avoiding the
>>>>> function
>>>>>>> call means NAMESPACE etc. are not involved, so fewer places for
>> getting
>>>>>>> into
>>>>>>> trouble, assuming the inline code works properly.
>>>>>>>
>>>>>>> JN
>>>>>>>
>>>>>>>
>>>>>>> On 2021-06-02 12:37 p.m., Duncan Murdoch wrote:
>>>>>>>> On 02/06/2021 12:13 p.m., Ben Staton wrote:
>>>>>>>>> Hello,
>>>>>>>>>
>>>>>>>>> I received an email notice from CRAN indicating that my R package
>>>>>>>>> ('postpack') will be archived soon if I do not take any action and
>> I
>>>>>>> want
>>>>>>>>> to avoid that outcome. The issue is not caused by my package, but
>>>>>>> instead a
>>>>>>>>> package that my package depends on:
>>>>>>>>>
>>>>>>>>> "... package 'matrixcalc' is now scheduled for archival on
>> 2021-06-09,
>>>>>>>>> and archiving this will necessitate also archiving its strong
>> reverse
>>>>>>>>> dependencies."
>>>>>>>>>
>>>>>>>>> Evidently, xyz has been returning errors on new R builds prompting
>>>>> CRAN
>>>>>>> to
>>>>>>>>> list it as a package to be archived. My package, 'postpack' has
>>>>>>>>> 'matrixcalc' listed in the Imports field, which I assume is why I
>>>>>>> received
>>>>>>>>> this email.
>>>>>>>>>
>>>>>>>>> I want to keep 'postpack' active and don't want it to be archived.
>> I
>>>>>>> still
>>>>>>>>> need package 'matrixcalc' for my package, but not for most
>> functions.
>>>>>>> Could
>>>>>>>>> I simply move package 'matrixcalc' to the Suggests list and submit
>> the
>>>>>>> new
>>>>>>>>> version to CRAN to remove the "Strong Reverse Dependency" issue
>> that
>>>>>>>>> triggered this email to avoid CRAN from archiving my package?
>>>>>>>>
>>>>>>>> That's part of one solution, but not the best solution.
>>>>>>>>
>>>>>>>> If you move it to Suggests, you should make sure that your package
>>>>>>> checks for it before every use, and falls back to
>>>>>>>> some other calculation if it is not present.  Be aware that once it
>> is
>>>>>>> archived, almost none of your users will have it
>>>>>>>> available, so this is kind of like dropping the functions that it
>>>>>>> supports.
>>>>>>>>
>>>>>>>> Another solution which would be great for the community might be for
>>>>> you
>>>>>>> to offer to take over as maintainer of
>>>>>>>> matrixcalc.  Then you'd fix whatever problems it has, and you
>> wouldn't
>>>>>>> need to worry about it.  I haven't looked at the
>>>>>>>> issues so I don't know if this is feasible.
>>>>>>>>
>>>>>>>> A third choice would be for you to copy the functions you need from
>>>>>>> matrixcalc into your own package so you can drop the
>>>>>>>> dependency.  This is generally legal under the licenses that CRAN
>>>>>>> accepts, but you should check anyway.
>>>>>>>>
>>>>>>>> A fourth choice would be for you to contact the matrixcalc
>> maintainer,
>>>>>>> and help them to fix the issues so that
>>>>>>>> matrixcalc doesn't get archived.  They may or may not be willing to
>>>>> work
>>>>>>> with you.
>>>>>>>>
>>>>>>>> I'd say my third choice is the best choice in the short term, and
>> 2nd
>>>>> or
>>>>>>> 4th would be good long term solutions.
>>>>>>>>
>>>>>>>> Duncan Murdoch
>>>>>>>>
>>>>>>>> ______________________________________________
>>>>>>>> R-package-devel at r-project.org mailing list
>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>>>>>
>>>>>>
>>>>>>        [[alternative HTML version deleted]]
>>>>>>
>>>>>> ______________________________________________
>>>>>> R-package-devel at r-project.org mailing list
>>>>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>>>>
>>>>>
>>>>> ______________________________________________
>>>>> R-package-devel at r-project.org mailing list
>>>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>>>
>>>>
>>>>       [[alternative HTML version deleted]]
>>>>
>>>> ______________________________________________
>>>> R-package-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>
>>> **********************
>>> "The contents of this message do not reflect any position of the U.S.
>> Government or NOAA."
>>> **********************
>>> Roy Mendelssohn
>>> Supervisory Operations Research Analyst
>>> NOAA/NMFS
>>> Environmental Research Division
>>> Southwest Fisheries Science Center
>>> ***Note new street address***
>>> 110 McAllister Way
>>> Santa Cruz, CA 95060
>>> Phone: (831)-420-3666
>>> Fax: (831) 420-3980
>>> e-mail: Roy.Mendelssohn at noaa.gov www: https://www.pfeg.noaa.gov/
>>>
>>> "Old age and treachery will overcome youth and skill."
>>> "From those who have been given much, much will be expected"
>>> "the arc of the moral universe is long, but it bends toward justice"
>> -MLK Jr.
>>>
>>> ______________________________________________
>>> R-package-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


From berw|n@tur|@ch @end|ng |rom gm@||@com  Thu Jun  3 08:51:01 2021
From: berw|n@tur|@ch @end|ng |rom gm@||@com (Berwin A Turlach)
Date: Thu, 3 Jun 2021 14:51:01 +0800
Subject: [R-pkg-devel] Question about preventing CRAN package archival
In-Reply-To: <4AC540CC-010F-4F1D-A004-B676D45DB0D3@dcn.davis.ca.us>
References: <CAH4d-wc4mWJBtu62tjBN1UOcoVXOAyHfVZbxKt8fXchzsqiRZg@mail.gmail.com>
 <bee0fa79-f930-aba1-21e4-80168eba6ef4@gmail.com>
 <bb739be4-7311-b770-3fef-a8124f4a489f@gmail.com>
 <CAH4d-wfVS6xdSBUiCiwxe=Bge4mS6tJnLxH43pOXgMf+WVCkuw@mail.gmail.com>
 <198da970-8073-bbda-ed52-39eafc5c85df@gmail.com>
 <CAH4d-we12i5GTJ_O_YNHSwpZzZUnf7kD=QpCzpEJSdvgW9wPiA@mail.gmail.com>
 <4AC540CC-010F-4F1D-A004-B676D45DB0D3@dcn.davis.ca.us>
Message-ID: <20210603145101.4310ed5d@ECM-DTC-716.uniwa.uwa.edu.au>

G'day Jeff,

On Wed, 02 Jun 2021 11:34:21 -0700
Jeff Newmiller <jdnewmil at dcn.davis.ca.us> wrote:

Not that I want to get involved in old discussions :), but...

> MIT is more permissive than GPL2,

... this statement depends on how one defines "permissive".

MIT requires that you fulfil: "The above copyright notice and this
permission notice shall be included in all copies or substantial
portions of the Software." (https://opensource.org/licenses/MIT)

Whereas GPL 2 merely requires that you "[...] conspicuously and
appropriately publish on each copy an appropriate copyright notice and
disclaimer of warranty [...]".

Thus, arguably, GPL 2 is more permissive.

>  so there is a collision there. 

Well, luckily the FSF does not think that the MIT license is
incompatible with the GPL license, though it finds the term "MIT
license" misleading and discourages its use, see
https://www.gnu.org/licenses/license-list.html

Cheers,

	Berwin


From @vr@h@m@@d|er @end|ng |rom gm@||@com  Thu Jun  3 09:07:41 2021
From: @vr@h@m@@d|er @end|ng |rom gm@||@com (Avraham Adler)
Date: Thu, 3 Jun 2021 07:07:41 +0000
Subject: [R-pkg-devel] Question about preventing CRAN package archival
In-Reply-To: <20210603145101.4310ed5d@ECM-DTC-716.uniwa.uwa.edu.au>
References: <CAH4d-wc4mWJBtu62tjBN1UOcoVXOAyHfVZbxKt8fXchzsqiRZg@mail.gmail.com>
 <bee0fa79-f930-aba1-21e4-80168eba6ef4@gmail.com>
 <bb739be4-7311-b770-3fef-a8124f4a489f@gmail.com>
 <CAH4d-wfVS6xdSBUiCiwxe=Bge4mS6tJnLxH43pOXgMf+WVCkuw@mail.gmail.com>
 <198da970-8073-bbda-ed52-39eafc5c85df@gmail.com>
 <CAH4d-we12i5GTJ_O_YNHSwpZzZUnf7kD=QpCzpEJSdvgW9wPiA@mail.gmail.com>
 <4AC540CC-010F-4F1D-A004-B676D45DB0D3@dcn.davis.ca.us>
 <20210603145101.4310ed5d@ECM-DTC-716.uniwa.uwa.edu.au>
Message-ID: <CAL6gwnK4AWqBo99GBX7frck7CMWvX9ie+76v5Bts2hPahaYR1Q@mail.gmail.com>

On the other hand, MIT does not restrict what you do with your own
contributions, just the included code. GPL restricts rights on
redistributing your own work if a component is GPL as well.

Avi

On Thu, Jun 3, 2021 at 6:51 AM Berwin A Turlach
<berwin.turlach at gmail.com> wrote:
>
> G'day Jeff,
>
> On Wed, 02 Jun 2021 11:34:21 -0700
> Jeff Newmiller <jdnewmil at dcn.davis.ca.us> wrote:
>
> Not that I want to get involved in old discussions :), but...
>
> > MIT is more permissive than GPL2,
>
> ... this statement depends on how one defines "permissive".
>
> MIT requires that you fulfil: "The above copyright notice and this
> permission notice shall be included in all copies or substantial
> portions of the Software." (https://opensource.org/licenses/MIT)
>
> Whereas GPL 2 merely requires that you "[...] conspicuously and
> appropriately publish on each copy an appropriate copyright notice and
> disclaimer of warranty [...]".
>
> Thus, arguably, GPL 2 is more permissive.
>
> >  so there is a collision there.
>
> Well, luckily the FSF does not think that the MIT license is
> incompatible with the GPL license, though it finds the term "MIT
> license" misleading and discourages its use, see
> https://www.gnu.org/licenses/license-list.html
>
> Cheers,
>
>         Berwin
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Thu Jun  3 09:23:59 2021
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Thu, 03 Jun 2021 00:23:59 -0700
Subject: [R-pkg-devel] Question about preventing CRAN package archival
In-Reply-To: <20210603145101.4310ed5d@ECM-DTC-716.uniwa.uwa.edu.au>
References: <CAH4d-wc4mWJBtu62tjBN1UOcoVXOAyHfVZbxKt8fXchzsqiRZg@mail.gmail.com>
 <bee0fa79-f930-aba1-21e4-80168eba6ef4@gmail.com>
 <bb739be4-7311-b770-3fef-a8124f4a489f@gmail.com>
 <CAH4d-wfVS6xdSBUiCiwxe=Bge4mS6tJnLxH43pOXgMf+WVCkuw@mail.gmail.com>
 <198da970-8073-bbda-ed52-39eafc5c85df@gmail.com>
 <CAH4d-we12i5GTJ_O_YNHSwpZzZUnf7kD=QpCzpEJSdvgW9wPiA@mail.gmail.com>
 <4AC540CC-010F-4F1D-A004-B676D45DB0D3@dcn.davis.ca.us>
 <20210603145101.4310ed5d@ECM-DTC-716.uniwa.uwa.edu.au>
Message-ID: <E65EE9A1-7FE6-4077-B019-C4A4CF73ED96@dcn.davis.ca.us>

... but you went ahead and did it anyway.

MIT software can be absorbed by GPL2 software, but not vice versa since MIT allows the code to be further incorporated into and distributed as non-free software, a permission not granted by GPL2.

I am opposed to people snarfing GPL2 code up for their non-free software tarpits, and transferring GPL2 code to MIT without the GPL2 author explicitly re-releasing as MIT would allow that.

On June 2, 2021 11:51:01 PM PDT, Berwin A Turlach <berwin.turlach at gmail.com> wrote:
>G'day Jeff,
>
>On Wed, 02 Jun 2021 11:34:21 -0700
>Jeff Newmiller <jdnewmil at dcn.davis.ca.us> wrote:
>
>Not that I want to get involved in old discussions :), but...
>
>> MIT is more permissive than GPL2,
>
>... this statement depends on how one defines "permissive".
>
>MIT requires that you fulfil: "The above copyright notice and this
>permission notice shall be included in all copies or substantial
>portions of the Software." (https://opensource.org/licenses/MIT)
>
>Whereas GPL 2 merely requires that you "[...] conspicuously and
>appropriately publish on each copy an appropriate copyright notice and
>disclaimer of warranty [...]".
>
>Thus, arguably, GPL 2 is more permissive.
>
>>  so there is a collision there. 
>
>Well, luckily the FSF does not think that the MIT license is
>incompatible with the GPL license, though it finds the term "MIT
>license" misleading and discourages its use, see
>https://www.gnu.org/licenses/license-list.html
>
>Cheers,
>
>	Berwin

-- 
Sent from my phone. Please excuse my brevity.


From m@ech|er @end|ng |rom @t@t@m@th@ethz@ch  Thu Jun  3 09:55:12 2021
From: m@ech|er @end|ng |rom @t@t@m@th@ethz@ch (Martin Maechler)
Date: Thu, 3 Jun 2021 09:55:12 +0200
Subject: [R-pkg-devel] Question about preventing CRAN package archival
In-Reply-To: <CAL6gwnJjVPWs5rhB68knT-b=nOK=40ZOAFN2Rzx+WFUq2+ZFAg@mail.gmail.com>
References: <CAH4d-wc4mWJBtu62tjBN1UOcoVXOAyHfVZbxKt8fXchzsqiRZg@mail.gmail.com>
 <bee0fa79-f930-aba1-21e4-80168eba6ef4@gmail.com>
 <bb739be4-7311-b770-3fef-a8124f4a489f@gmail.com>
 <CAH4d-wfVS6xdSBUiCiwxe=Bge4mS6tJnLxH43pOXgMf+WVCkuw@mail.gmail.com>
 <198da970-8073-bbda-ed52-39eafc5c85df@gmail.com>
 <CAH4d-we12i5GTJ_O_YNHSwpZzZUnf7kD=QpCzpEJSdvgW9wPiA@mail.gmail.com>
 <CANAiAiWgd20=JRgeqJC65ESPHnT1Ge=HeiFWaPRJmzcNjZQHmQ@mail.gmail.com>
 <CAL6gwnJjVPWs5rhB68knT-b=nOK=40ZOAFN2Rzx+WFUq2+ZFAg@mail.gmail.com>
Message-ID: <24760.35552.537109.238299@stat.math.ethz.ch>

>>>>> Avraham Adler 
>>>>>     on Wed, 2 Jun 2021 15:28:25 -0400 writes:

    > Exactly. Is square is just brow=ncol, is positive definite can be
    > implemented as a check that all eigenvalues > 0, which can be done with
    > base, and is.symmetric can be simply brute forced in a loop comparing i,j
    > with j,i.

    > The fewer dependencies a package has, the more robust it is. It?s a fine
    > balance between not reinventing the wheel and ceding too much stability to
    > other packages.

    > Thanks,
    > Avi

Indeed.  Further,

-  isSymmetric()  has been part of base for a long time
   so the definition of an alternative in matrixcalc  had been @_*#^$%
   It's also supported by methods in the Matrix package
   e.g. for sparse matrices etc  so definitely something you
   "should" use instead.

-  is.square() is trivial and I think an explicit check such as
   { d <- dim(x);  d[1] == d[2] }
   is often more sensical, notably as in many of your functions
   you'd need either nrow(.) or ncol(.) of your matrix anyway.

- A remark on Positive Definiteness (or also, often what you really want,
   "Positive Semi-definitness", allowing 0 eigen values):
  The  Matrix  package has an (S4) class  "dpoMatrix"
  of dense positive-definite (actually 'positive semi-definite') matrices.
  In its validation method (yes, formal classes have validation!), we
  use a cheap test instead of an expensive test with eigenvalues
  (which is "too expensive": there are faster ones at least in theory,
   e.g., trying an  LDL' Cholesky decomposition and returning as soon as
   a non-positive / negative entry in D would appear).

  The really cheap "pre-test" you may want to use  before or instead
  of doing one of the more expensive ones is simply checking the diagonal:

   if(any(diag(<matrix>)) <  0) "not positive-semidefinite"
   if(any(diag(<matrix>)) <= 0) "not positive-definite"

Martin Maechler
(Maintainer of 'Matrix').


    > On Wed, Jun 2, 2021 at 3:15 PM John Harrold <john.m.harrold at gmail.com>
    > wrote:

    >> To add another option. In the past when this has happened to me I've found
    >> other packages that provide similar functionality.
    >> 
    >> I'm assuming that is.square just checks the number of columns == number of
    >> rows? And the others can probably be implemented pretty easily.
    >> 
    >> On Wed, Jun 2, 2021 at 10:41 AM Ben Staton <statonbe at gmail.com> wrote:
    >> 
    >> > My package uses the MIT license, so would that not meet the compatibility
    >> > requirements?
    >> >
    >> > I will attempt to reach out to the package author - thanks for your help!
    >> >
    >> > On Wed, Jun 2, 2021 at 10:31 AM Ben Bolker <bbolker at gmail.com> wrote:
    >> >
    >> > >     That all sounds exactly right.
    >> > >    GPL >= 2 allows you to use the material without asking permission as
    >> > > long as your package is compatibly licensed (e.g. also GPL).
    >> > >    Under normal circumstances it would be polite to ask permission, but
    >> > > if the reason for doing this is that the maintainer is unreachable in
    >> > > the first place ...
    >> > >
    >> > >   If you want to try a little harder, it seems quite possible that you
    >> > > can reach the matrixcalc maintainer at the (personal) e-mail address
    >> > > shown in this page:
    >> > >
    >> > >
    >> >
    >> https://www.facebook.com/photo/?fbid=10208324530363130&set=ecnf.1000413042
    >> > >
    >> > >    (Possibly an identity confusion, but I rate that as unlikely based
    >> on
    >> > > other facebook snooping)
    >> > >
    >> > >    I don't think a short, polite e-mail request would be out of bounds,
    >> > > they can always ignore it or tell you to go away.
    >> > >
    >> > >    cheers
    >> > >     Ben Bolker
    >> > >
    >> > > On 6/2/21 1:15 PM, Ben Staton wrote:
    >> > > > Hello,
    >> > > >
    >> > > > Thank you for your detailed list of solutions.
    >> > > >
    >> > > > I was initially tempted to go with option 1 (move matrixcalc to
    >> > suggests
    >> > > > and check for its existence before using functions that rely on it),
    >> > but
    >> > > as
    >> > > > mentioned, this is not a long term fix.
    >> > > >
    >> > > > I unfortunately can't take on the responsibilities of option 2
    >> > (becoming
    >> > > > the package maintainer) -- there is much that this package does that
    >> I
    >> > do
    >> > > > not understand, and do not wish to feign authority!
    >> > > >
    >> > > > I plan to take option 3 (copy the needed functions into my package).
    >> > > There
    >> > > > are only three functions I need from matrixcalc, and all three are
    >> > fairly
    >> > > > simple (is.square.matrix
    >> > > > <https://rdrr.io/cran/matrixcalc/src/R/is.square.matrix.R>,
    >> > > > is.symmetric.matrix
    >> > > > <https://rdrr.io/cran/matrixcalc/src/R/is.symmetric.matrix.R>, and
    >> > > > is.positive.definite
    >> > > > <https://rdrr.io/cran/matrixcalc/src/R/is.positive.definite.R>) and
    >> > > there
    >> > > > is only one function in postpack that needs them. I plan to define
    >> them
    >> > > > within the postpack function. matrixcalc is licensed under GPL >= 2
    >> and
    >> > > > based on my scan of the license text, this is allowed. Is that
    >> correct?
    >> > > >
    >> > > > Regarding option 4 (contacting the matrixcalc maintainer), the
    >> original
    >> > > > email from CRAN mentioned that they have attempted to contact the
    >> > package
    >> > > > author with no response.
    >> > > >
    >> > > > Thank you!
    >> > > >
    >> > > > On Wed, Jun 2, 2021 at 9:52 AM J C Nash <profjcnash at gmail.com>
    >> wrote:
    >> > > >
    >> > > >> I just downloaded the source matrixcalc package to see what it
    >> > > contained.
    >> > > >> The functions
    >> > > >> I looked at seem fairly straightforward and the OP could likely
    >> > develop
    >> > > >> equivalent features
    >> > > >> in his own code, possibly avoiding a function call. Avoiding the
    >> > > function
    >> > > >> call means NAMESPACE etc. are not involved, so fewer places for
    >> > getting
    >> > > >> into
    >> > > >> trouble, assuming the inline code works properly.
    >> > > >>
    >> > > >> JN
    >> > > >>
    >> > > >>
    >> > > >> On 2021-06-02 12:37 p.m., Duncan Murdoch wrote:
    >> > > >>> On 02/06/2021 12:13 p.m., Ben Staton wrote:
    >> > > >>>> Hello,
    >> > > >>>>
    >> > > >>>> I received an email notice from CRAN indicating that my R package
    >> > > >>>> ('postpack') will be archived soon if I do not take any action
    >> and I
    >> > > >> want
    >> > > >>>> to avoid that outcome. The issue is not caused by my package, but
    >> > > >> instead a
    >> > > >>>> package that my package depends on:
    >> > > >>>>
    >> > > >>>> "... package 'matrixcalc' is now scheduled for archival on
    >> > 2021-06-09,
    >> > > >>>> and archiving this will necessitate also archiving its strong
    >> > reverse
    >> > > >>>> dependencies."
    >> > > >>>>
    >> > > >>>> Evidently, xyz has been returning errors on new R builds prompting
    >> > > CRAN
    >> > > >> to
    >> > > >>>> list it as a package to be archived. My package, 'postpack' has
    >> > > >>>> 'matrixcalc' listed in the Imports field, which I assume is why I
    >> > > >> received
    >> > > >>>> this email.
    >> > > >>>>
    >> > > >>>> I want to keep 'postpack' active and don't want it to be
    >> archived. I
    >> > > >> still
    >> > > >>>> need package 'matrixcalc' for my package, but not for most
    >> > functions.
    >> > > >> Could
    >> > > >>>> I simply move package 'matrixcalc' to the Suggests list and submit
    >> > the
    >> > > >> new
    >> > > >>>> version to CRAN to remove the "Strong Reverse Dependency" issue
    >> that
    >> > > >>>> triggered this email to avoid CRAN from archiving my package?
    >> > > >>>
    >> > > >>> That's part of one solution, but not the best solution.
    >> > > >>>
    >> > > >>> If you move it to Suggests, you should make sure that your package
    >> > > >> checks for it before every use, and falls back to
    >> > > >>> some other calculation if it is not present.  Be aware that once it
    >> > is
    >> > > >> archived, almost none of your users will have it
    >> > > >>> available, so this is kind of like dropping the functions that it
    >> > > >> supports.
    >> > > >>>
    >> > > >>> Another solution which would be great for the community might be
    >> for
    >> > > you
    >> > > >> to offer to take over as maintainer of
    >> > > >>> matrixcalc.  Then you'd fix whatever problems it has, and you
    >> > wouldn't
    >> > > >> need to worry about it.  I haven't looked at the
    >> > > >>> issues so I don't know if this is feasible.
    >> > > >>>
    >> > > >>> A third choice would be for you to copy the functions you need from
    >> > > >> matrixcalc into your own package so you can drop the
    >> > > >>> dependency.  This is generally legal under the licenses that CRAN
    >> > > >> accepts, but you should check anyway.
    >> > > >>>
    >> > > >>> A fourth choice would be for you to contact the matrixcalc
    >> > maintainer,
    >> > > >> and help them to fix the issues so that
    >> > > >>> matrixcalc doesn't get archived.  They may or may not be willing to
    >> > > work
    >> > > >> with you.
    >> > > >>>
    >> > > >>> I'd say my third choice is the best choice in the short term, and
    >> 2nd
    >> > > or
    >> > > >> 4th would be good long term solutions.
    >> > > >>>
    >> > > >>> Duncan Murdoch
    >> > > >>>
    >> > > >>> ______________________________________________
    >> > > >>> R-package-devel at r-project.org mailing list
    >> > > >>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
    >> > > >>
    >> > > >
    >> > > >       [[alternative HTML version deleted]]
    >> > > >
    >> > > > ______________________________________________
    >> > > > R-package-devel at r-project.org mailing list
    >> > > > https://stat.ethz.ch/mailman/listinfo/r-package-devel
    >> > > >
    >> > >
    >> > > ______________________________________________
    >> > > R-package-devel at r-project.org mailing list
    >> > > https://stat.ethz.ch/mailman/listinfo/r-package-devel
    >> > >
    >> >
    >> >         [[alternative HTML version deleted]]
    >> >
    >> > ______________________________________________
    >> > R-package-devel at r-project.org mailing list
    >> > https://stat.ethz.ch/mailman/listinfo/r-package-devel
    >> >
    >> 
    >> 
    >> --
    >> John
    >> :wq
    >> 
    >> [[alternative HTML version deleted]]
    >> 
    >> ______________________________________________
    >> R-package-devel at r-project.org mailing list
    >> https://stat.ethz.ch/mailman/listinfo/r-package-devel
    >> 
    > -- 
    > Sent from Gmail Mobile

    > [[alternative HTML version deleted]]

    > ______________________________________________
    > R-package-devel at r-project.org mailing list
    > https://stat.ethz.ch/mailman/listinfo/r-package-devel


From @t@tonbe @end|ng |rom gm@||@com  Thu Jun  3 19:35:07 2021
From: @t@tonbe @end|ng |rom gm@||@com (Ben Staton)
Date: Thu, 3 Jun 2021 10:35:07 -0700
Subject: [R-pkg-devel] Question about preventing CRAN package archival
In-Reply-To: <24760.35552.537109.238299@stat.math.ethz.ch>
References: <CAH4d-wc4mWJBtu62tjBN1UOcoVXOAyHfVZbxKt8fXchzsqiRZg@mail.gmail.com>
 <bee0fa79-f930-aba1-21e4-80168eba6ef4@gmail.com>
 <bb739be4-7311-b770-3fef-a8124f4a489f@gmail.com>
 <CAH4d-wfVS6xdSBUiCiwxe=Bge4mS6tJnLxH43pOXgMf+WVCkuw@mail.gmail.com>
 <198da970-8073-bbda-ed52-39eafc5c85df@gmail.com>
 <CAH4d-we12i5GTJ_O_YNHSwpZzZUnf7kD=QpCzpEJSdvgW9wPiA@mail.gmail.com>
 <CANAiAiWgd20=JRgeqJC65ESPHnT1Ge=HeiFWaPRJmzcNjZQHmQ@mail.gmail.com>
 <CAL6gwnJjVPWs5rhB68knT-b=nOK=40ZOAFN2Rzx+WFUq2+ZFAg@mail.gmail.com>
 <24760.35552.537109.238299@stat.math.ethz.ch>
Message-ID: <CAH4d-we_Z40SURUmXDUCx7E1RV08EfrnrLFQ0wk1m6JT06e6Cg@mail.gmail.com>

Hi Everyone,

Thank you all for your input and thoughts on this topic. I've learned much
from this thread. I have arrived at a solution so we can now consider this
topic closed.

I ended up removing the dependency on 'matrixcalc' by (a) replacing
matrixcalc::is.square.matrix() with a basic check for nrow(x) == ncol(x),
(b) replacing matrixcalc::is.symmetric.matrix() with base::isSymmetric(),
and (c) replacing matrixcalc::is.positive.definite() with some basic custom
code that checks eigenvalues for >= 0 (thus checking for semi-positive
definiteness), as pointed out by Martin above. I have submitted the updated
version to CRAN and it is now available there.

Side note -- someone else ended up taking over as maintainer of the
orphaned 'matrixcalc' package and has had it successfully accepted to CRAN,
so it will continue to be available going forward. I'm still happy with the
solution that I used, as fewer dependencies the better -- a point also
raised earlier in this thread.

Thank you all,
Ben

On Thu, Jun 3, 2021 at 12:55 AM Martin Maechler <maechler at stat.math.ethz.ch>
wrote:

> >>>>> Avraham Adler
> >>>>>     on Wed, 2 Jun 2021 15:28:25 -0400 writes:
>
>     > Exactly. Is square is just brow=ncol, is positive definite can be
>     > implemented as a check that all eigenvalues > 0, which can be done
> with
>     > base, and is.symmetric can be simply brute forced in a loop
> comparing i,j
>     > with j,i.
>
>     > The fewer dependencies a package has, the more robust it is. It?s a
> fine
>     > balance between not reinventing the wheel and ceding too much
> stability to
>     > other packages.
>
>     > Thanks,
>     > Avi
>
> Indeed.  Further,
>
> -  isSymmetric()  has been part of base for a long time
>    so the definition of an alternative in matrixcalc  had been @_*#^$%
>    It's also supported by methods in the Matrix package
>    e.g. for sparse matrices etc  so definitely something you
>    "should" use instead.
>
> -  is.square() is trivial and I think an explicit check such as
>    { d <- dim(x);  d[1] == d[2] }
>    is often more sensical, notably as in many of your functions
>    you'd need either nrow(.) or ncol(.) of your matrix anyway.
>
> - A remark on Positive Definiteness (or also, often what you really want,
>    "Positive Semi-definitness", allowing 0 eigen values):
>   The  Matrix  package has an (S4) class  "dpoMatrix"
>   of dense positive-definite (actually 'positive semi-definite') matrices.
>   In its validation method (yes, formal classes have validation!), we
>   use a cheap test instead of an expensive test with eigenvalues
>   (which is "too expensive": there are faster ones at least in theory,
>    e.g., trying an  LDL' Cholesky decomposition and returning as soon as
>    a non-positive / negative entry in D would appear).
>
>   The really cheap "pre-test" you may want to use  before or instead
>   of doing one of the more expensive ones is simply checking the diagonal:
>
>    if(any(diag(<matrix>)) <  0) "not positive-semidefinite"
>    if(any(diag(<matrix>)) <= 0) "not positive-definite"
>
> Martin Maechler
> (Maintainer of 'Matrix').
>
>
>     > On Wed, Jun 2, 2021 at 3:15 PM John Harrold <
> john.m.harrold at gmail.com>
>     > wrote:
>
>     >> To add another option. In the past when this has happened to me
> I've found
>     >> other packages that provide similar functionality.
>     >>
>     >> I'm assuming that is.square just checks the number of columns ==
> number of
>     >> rows? And the others can probably be implemented pretty easily.
>     >>
>     >> On Wed, Jun 2, 2021 at 10:41 AM Ben Staton <statonbe at gmail.com>
> wrote:
>     >>
>     >> > My package uses the MIT license, so would that not meet the
> compatibility
>     >> > requirements?
>     >> >
>     >> > I will attempt to reach out to the package author - thanks for
> your help!
>     >> >
>     >> > On Wed, Jun 2, 2021 at 10:31 AM Ben Bolker <bbolker at gmail.com>
> wrote:
>     >> >
>     >> > >     That all sounds exactly right.
>     >> > >    GPL >= 2 allows you to use the material without asking
> permission as
>     >> > > long as your package is compatibly licensed (e.g. also GPL).
>     >> > >    Under normal circumstances it would be polite to ask
> permission, but
>     >> > > if the reason for doing this is that the maintainer is
> unreachable in
>     >> > > the first place ...
>     >> > >
>     >> > >   If you want to try a little harder, it seems quite possible
> that you
>     >> > > can reach the matrixcalc maintainer at the (personal) e-mail
> address
>     >> > > shown in this page:
>     >> > >
>     >> > >
>     >> >
>     >>
> https://www.facebook.com/photo/?fbid=10208324530363130&set=ecnf.1000413042
>     >> > >
>     >> > >    (Possibly an identity confusion, but I rate that as unlikely
> based
>     >> on
>     >> > > other facebook snooping)
>     >> > >
>     >> > >    I don't think a short, polite e-mail request would be out of
> bounds,
>     >> > > they can always ignore it or tell you to go away.
>     >> > >
>     >> > >    cheers
>     >> > >     Ben Bolker
>     >> > >
>     >> > > On 6/2/21 1:15 PM, Ben Staton wrote:
>     >> > > > Hello,
>     >> > > >
>     >> > > > Thank you for your detailed list of solutions.
>     >> > > >
>     >> > > > I was initially tempted to go with option 1 (move matrixcalc
> to
>     >> > suggests
>     >> > > > and check for its existence before using functions that rely
> on it),
>     >> > but
>     >> > > as
>     >> > > > mentioned, this is not a long term fix.
>     >> > > >
>     >> > > > I unfortunately can't take on the responsibilities of option 2
>     >> > (becoming
>     >> > > > the package maintainer) -- there is much that this package
> does that
>     >> I
>     >> > do
>     >> > > > not understand, and do not wish to feign authority!
>     >> > > >
>     >> > > > I plan to take option 3 (copy the needed functions into my
> package).
>     >> > > There
>     >> > > > are only three functions I need from matrixcalc, and all
> three are
>     >> > fairly
>     >> > > > simple (is.square.matrix
>     >> > > > <https://rdrr.io/cran/matrixcalc/src/R/is.square.matrix.R>,
>     >> > > > is.symmetric.matrix
>     >> > > > <https://rdrr.io/cran/matrixcalc/src/R/is.symmetric.matrix.R>,
> and
>     >> > > > is.positive.definite
>     >> > > > <https://rdrr.io/cran/matrixcalc/src/R/is.positive.definite.R>)
> and
>     >> > > there
>     >> > > > is only one function in postpack that needs them. I plan to
> define
>     >> them
>     >> > > > within the postpack function. matrixcalc is licensed under
> GPL >= 2
>     >> and
>     >> > > > based on my scan of the license text, this is allowed. Is that
>     >> correct?
>     >> > > >
>     >> > > > Regarding option 4 (contacting the matrixcalc maintainer), the
>     >> original
>     >> > > > email from CRAN mentioned that they have attempted to contact
> the
>     >> > package
>     >> > > > author with no response.
>     >> > > >
>     >> > > > Thank you!
>     >> > > >
>     >> > > > On Wed, Jun 2, 2021 at 9:52 AM J C Nash <profjcnash at gmail.com
> >
>     >> wrote:
>     >> > > >
>     >> > > >> I just downloaded the source matrixcalc package to see what
> it
>     >> > > contained.
>     >> > > >> The functions
>     >> > > >> I looked at seem fairly straightforward and the OP could
> likely
>     >> > develop
>     >> > > >> equivalent features
>     >> > > >> in his own code, possibly avoiding a function call. Avoiding
> the
>     >> > > function
>     >> > > >> call means NAMESPACE etc. are not involved, so fewer places
> for
>     >> > getting
>     >> > > >> into
>     >> > > >> trouble, assuming the inline code works properly.
>     >> > > >>
>     >> > > >> JN
>     >> > > >>
>     >> > > >>
>     >> > > >> On 2021-06-02 12:37 p.m., Duncan Murdoch wrote:
>     >> > > >>> On 02/06/2021 12:13 p.m., Ben Staton wrote:
>     >> > > >>>> Hello,
>     >> > > >>>>
>     >> > > >>>> I received an email notice from CRAN indicating that my R
> package
>     >> > > >>>> ('postpack') will be archived soon if I do not take any
> action
>     >> and I
>     >> > > >> want
>     >> > > >>>> to avoid that outcome. The issue is not caused by my
> package, but
>     >> > > >> instead a
>     >> > > >>>> package that my package depends on:
>     >> > > >>>>
>     >> > > >>>> "... package 'matrixcalc' is now scheduled for archival on
>     >> > 2021-06-09,
>     >> > > >>>> and archiving this will necessitate also archiving its
> strong
>     >> > reverse
>     >> > > >>>> dependencies."
>     >> > > >>>>
>     >> > > >>>> Evidently, xyz has been returning errors on new R builds
> prompting
>     >> > > CRAN
>     >> > > >> to
>     >> > > >>>> list it as a package to be archived. My package,
> 'postpack' has
>     >> > > >>>> 'matrixcalc' listed in the Imports field, which I assume
> is why I
>     >> > > >> received
>     >> > > >>>> this email.
>     >> > > >>>>
>     >> > > >>>> I want to keep 'postpack' active and don't want it to be
>     >> archived. I
>     >> > > >> still
>     >> > > >>>> need package 'matrixcalc' for my package, but not for most
>     >> > functions.
>     >> > > >> Could
>     >> > > >>>> I simply move package 'matrixcalc' to the Suggests list
> and submit
>     >> > the
>     >> > > >> new
>     >> > > >>>> version to CRAN to remove the "Strong Reverse Dependency"
> issue
>     >> that
>     >> > > >>>> triggered this email to avoid CRAN from archiving my
> package?
>     >> > > >>>
>     >> > > >>> That's part of one solution, but not the best solution.
>     >> > > >>>
>     >> > > >>> If you move it to Suggests, you should make sure that your
> package
>     >> > > >> checks for it before every use, and falls back to
>     >> > > >>> some other calculation if it is not present.  Be aware that
> once it
>     >> > is
>     >> > > >> archived, almost none of your users will have it
>     >> > > >>> available, so this is kind of like dropping the functions
> that it
>     >> > > >> supports.
>     >> > > >>>
>     >> > > >>> Another solution which would be great for the community
> might be
>     >> for
>     >> > > you
>     >> > > >> to offer to take over as maintainer of
>     >> > > >>> matrixcalc.  Then you'd fix whatever problems it has, and
> you
>     >> > wouldn't
>     >> > > >> need to worry about it.  I haven't looked at the
>     >> > > >>> issues so I don't know if this is feasible.
>     >> > > >>>
>     >> > > >>> A third choice would be for you to copy the functions you
> need from
>     >> > > >> matrixcalc into your own package so you can drop the
>     >> > > >>> dependency.  This is generally legal under the licenses
> that CRAN
>     >> > > >> accepts, but you should check anyway.
>     >> > > >>>
>     >> > > >>> A fourth choice would be for you to contact the matrixcalc
>     >> > maintainer,
>     >> > > >> and help them to fix the issues so that
>     >> > > >>> matrixcalc doesn't get archived.  They may or may not be
> willing to
>     >> > > work
>     >> > > >> with you.
>     >> > > >>>
>     >> > > >>> I'd say my third choice is the best choice in the short
> term, and
>     >> 2nd
>     >> > > or
>     >> > > >> 4th would be good long term solutions.
>     >> > > >>>
>     >> > > >>> Duncan Murdoch
>     >> > > >>>
>     >> > > >>> ______________________________________________
>     >> > > >>> R-package-devel at r-project.org mailing list
>     >> > > >>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>     >> > > >>
>     >> > > >
>     >> > > >       [[alternative HTML version deleted]]
>     >> > > >
>     >> > > > ______________________________________________
>     >> > > > R-package-devel at r-project.org mailing list
>     >> > > > https://stat.ethz.ch/mailman/listinfo/r-package-devel
>     >> > > >
>     >> > >
>     >> > > ______________________________________________
>     >> > > R-package-devel at r-project.org mailing list
>     >> > > https://stat.ethz.ch/mailman/listinfo/r-package-devel
>     >> > >
>     >> >
>     >> >         [[alternative HTML version deleted]]
>     >> >
>     >> > ______________________________________________
>     >> > R-package-devel at r-project.org mailing list
>     >> > https://stat.ethz.ch/mailman/listinfo/r-package-devel
>     >> >
>     >>
>     >>
>     >> --
>     >> John
>     >> :wq
>     >>
>     >> [[alternative HTML version deleted]]
>     >>
>     >> ______________________________________________
>     >> R-package-devel at r-project.org mailing list
>     >> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>     >>
>     > --
>     > Sent from Gmail Mobile
>
>     > [[alternative HTML version deleted]]
>
>     > ______________________________________________
>     > R-package-devel at r-project.org mailing list
>     > https://stat.ethz.ch/mailman/listinfo/r-package-devel
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From t|@goo||voto @end|ng |rom gm@||@com  Fri Jun  4 02:56:41 2021
From: t|@goo||voto @end|ng |rom gm@||@com (Tiago Olivoto)
Date: Thu, 3 Jun 2021 21:56:41 -0300
Subject: [R-pkg-devel] [Error] data length differs from size of matrix
Message-ID: <CAMyz+tWyDMJuFA1r4Uzf8dVgDOqwn+gLP+BBgw_XuNzReyUS4A@mail.gmail.com>

Dear all,
I have received an email from the CRAN team to fix a problem with my R
package metan <https://CRAN.R-project.org/package=metan
<https://cran.r-project.org/package=metan>> to safely retain it on CRAN.

The error is given at <https://www.stats.ox.ac.uk/pub/bdr/donttest/metan.out>
and seems to be related to data different from size of matrix.

The question is that and I cannot reproduce the error locally and thus not
able to fix anything. By googling the error I've seen similar issues with a
lot of other packages. Could be this be a temporary issue?

Thanks in advance!
Tiago

	[[alternative HTML version deleted]]


From M@x@Turgeon @end|ng |rom um@n|tob@@c@  Fri Jun  4 16:35:16 2021
From: M@x@Turgeon @end|ng |rom um@n|tob@@c@ (Max Turgeon)
Date: Fri, 4 Jun 2021 14:35:16 +0000
Subject: [R-pkg-devel] [Error] data length differs from size of matrix
In-Reply-To: <CAMyz+tWyDMJuFA1r4Uzf8dVgDOqwn+gLP+BBgw_XuNzReyUS4A@mail.gmail.com>
References: <CAMyz+tWyDMJuFA1r4Uzf8dVgDOqwn+gLP+BBgw_XuNzReyUS4A@mail.gmail.com>
Message-ID: <YQXPR01MB4579C2B477C576EA33246D9A9A3B9@YQXPR01MB4579.CANPRD01.PROD.OUTLOOK.COM>

Hi Tiago,

Which version of R are you using? You will probably need to use the R-devel version to reproduce the error AND set a flag, as described here: https://cran.r-project.org/

Best,


Max Turgeon<https://www.name-coach.com/maxime-turgeon>
Assistant Professor
Department of Statistics
Department of Computer Science
University of Manitoba
maxturgeon.ca<http://maxturgeon.ca>


________________________________
From: R-package-devel <r-package-devel-bounces at r-project.org> on behalf of Tiago Olivoto <tiagoolivoto at gmail.com>
Sent: Thursday, June 3, 2021 7:56 PM
To: R Package Devel <r-package-devel at r-project.org>
Subject: [R-pkg-devel] [Error] data length differs from size of matrix

********************************************************
Caution: This message was sent from outside the University of Manitoba.
********************************************************

Dear all,
I have received an email from the CRAN team to fix a problem with my R
package metan <https://CRAN.R-project.org/package=metan
<https://cran.r-project.org/package=metan>> to safely retain it on CRAN.

The error is given at <https://www.stats.ox.ac.uk/pub/bdr/donttest/metan.out>
and seems to be related to data different from size of matrix.

The question is that and I cannot reproduce the error locally and thus not
able to fix anything. By googling the error I've seen similar issues with a
lot of other packages. Could be this be a temporary issue?

Thanks in advance!
Tiago

        [[alternative HTML version deleted]]

______________________________________________
R-package-devel at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-package-devel


	[[alternative HTML version deleted]]


From M@x@Turgeon @end|ng |rom um@n|tob@@c@  Fri Jun  4 16:37:05 2021
From: M@x@Turgeon @end|ng |rom um@n|tob@@c@ (Max Turgeon)
Date: Fri, 4 Jun 2021 14:37:05 +0000
Subject: [R-pkg-devel] [Error] data length differs from size of matrix
In-Reply-To: <YQXPR01MB4579C2B477C576EA33246D9A9A3B9@YQXPR01MB4579.CANPRD01.PROD.OUTLOOK.COM>
References: <CAMyz+tWyDMJuFA1r4Uzf8dVgDOqwn+gLP+BBgw_XuNzReyUS4A@mail.gmail.com>,
 <YQXPR01MB4579C2B477C576EA33246D9A9A3B9@YQXPR01MB4579.CANPRD01.PROD.OUTLOOK.COM>
Message-ID: <YQXPR01MB457923D89A575515E65E5BB09A3B9@YQXPR01MB4579.CANPRD01.PROD.OUTLOOK.COM>

I apologize for the wrong link below; as described here: https://cran.r-project.org/doc/manuals/r-devel/NEWS.html



Max Turgeon<https://www.name-coach.com/maxime-turgeon>
Assistant Professor
Department of Statistics
Department of Computer Science
University of Manitoba
maxturgeon.ca<http://maxturgeon.ca>


________________________________
From: R-package-devel <r-package-devel-bounces at r-project.org> on behalf of Max Turgeon <Max.Turgeon at umanitoba.ca>
Sent: Friday, June 4, 2021 9:35 AM
To: Tiago Olivoto <tiagoolivoto at gmail.com>; R Package Devel <r-package-devel at r-project.org>
Subject: Re: [R-pkg-devel] [Error] data length differs from size of matrix

********************************************************
Caution: This message was sent from outside the University of Manitoba.
********************************************************

Hi Tiago,

Which version of R are you using? You will probably need to use the R-devel version to reproduce the error AND set a flag, as described here: https://cran.r-project.org/

Best,


Max Turgeon<https://www.name-coach.com/maxime-turgeon>
Assistant Professor
Department of Statistics
Department of Computer Science
University of Manitoba
maxturgeon.ca<http://maxturgeon.ca>


________________________________
From: R-package-devel <r-package-devel-bounces at r-project.org> on behalf of Tiago Olivoto <tiagoolivoto at gmail.com>
Sent: Thursday, June 3, 2021 7:56 PM
To: R Package Devel <r-package-devel at r-project.org>
Subject: [R-pkg-devel] [Error] data length differs from size of matrix

********************************************************
Caution: This message was sent from outside the University of Manitoba.
********************************************************

Dear all,
I have received an email from the CRAN team to fix a problem with my R
package metan <https://CRAN.R-project.org/package=metan
<https://cran.r-project.org/package=metan>> to safely retain it on CRAN.

The error is given at <https://www.stats.ox.ac.uk/pub/bdr/donttest/metan.out>
and seems to be related to data different from size of matrix.

The question is that and I cannot reproduce the error locally and thus not
able to fix anything. By googling the error I've seen similar issues with a
lot of other packages. Could be this be a temporary issue?

Thanks in advance!
Tiago

        [[alternative HTML version deleted]]

______________________________________________
R-package-devel at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-package-devel


        [[alternative HTML version deleted]]

______________________________________________
R-package-devel at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-package-devel


	[[alternative HTML version deleted]]


From w||||@mwdun|@p @end|ng |rom gm@||@com  Fri Jun  4 16:39:41 2021
From: w||||@mwdun|@p @end|ng |rom gm@||@com (Bill Dunlap)
Date: Fri, 4 Jun 2021 07:39:41 -0700
Subject: [R-pkg-devel] [Error] data length differs from size of matrix
In-Reply-To: <CAMyz+tWyDMJuFA1r4Uzf8dVgDOqwn+gLP+BBgw_XuNzReyUS4A@mail.gmail.com>
References: <CAMyz+tWyDMJuFA1r4Uzf8dVgDOqwn+gLP+BBgw_XuNzReyUS4A@mail.gmail.com>
Message-ID: <CAHqSRuSuizvQ9AAtbxKNz16v3fRwG1-SADmfwkV4VuBaCGRRiA@mail.gmail.com>

That log file includes the line
    using R Under development (unstable) (2021-05-30 r80413)
and later says

The error most likely occurred in:

> ### Name: path_coeff
> ### Title: Path coefficients with minimal multicollinearity
> ### Aliases: path_coeff path_coeff_mat
>
> ### ** Examples
>
> ## No test:
> library(metan)
>
> # Using KW as the response variable and all other ones as predictors
> pcoeff <- path_coeff(data_ge2, resp = KW)
Error in matrix(value, n, p) :
  data length differs from size of matrix: [196 != 1 x 14]
Calls: path_coeff -> [<- -> [<-.data.frame -> matrix
Execution halted

In the current R-devel the matrix command matrix(value, nrow, ncol)
complains if length(value)>nrow*ncol, so you need to truncate 'value'.
(Previously matrix() would silently truncate value.)


-Bill


On Thu, Jun 3, 2021 at 5:57 PM Tiago Olivoto <tiagoolivoto at gmail.com> wrote:

> Dear all,
> I have received an email from the CRAN team to fix a problem with my R
> package metan <https://CRAN.R-project.org/package=metan
> <https://cran.r-project.org/package=metan>> to safely retain it on CRAN.
>
> The error is given at <
> https://www.stats.ox.ac.uk/pub/bdr/donttest/metan.out>
> and seems to be related to data different from size of matrix.
>
> The question is that and I cannot reproduce the error locally and thus not
> able to fix anything. By googling the error I've seen similar issues with a
> lot of other packages. Could be this be a temporary issue?
>
> Thanks in advance!
> Tiago
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From w||||@mwdun|@p @end|ng |rom gm@||@com  Fri Jun  4 17:41:41 2021
From: w||||@mwdun|@p @end|ng |rom gm@||@com (Bill Dunlap)
Date: Fri, 4 Jun 2021 08:41:41 -0700
Subject: [R-pkg-devel] [Error] data length differs from size of matrix
In-Reply-To: <CAHqSRuSuizvQ9AAtbxKNz16v3fRwG1-SADmfwkV4VuBaCGRRiA@mail.gmail.com>
References: <CAMyz+tWyDMJuFA1r4Uzf8dVgDOqwn+gLP+BBgw_XuNzReyUS4A@mail.gmail.com>
 <CAHqSRuSuizvQ9AAtbxKNz16v3fRwG1-SADmfwkV4VuBaCGRRiA@mail.gmail.com>
Message-ID: <CAHqSRuSq6_Z2H7ZNc2zQnkAY9q9nqnrEEjcKj8z+qVQVGenYeA@mail.gmail.com>

The offending line in path_coeff seems to be
   betas[i, 2:nvar] <- t(solve_svd(cor.x2, cor.y))
where i is a single integer, nvar is 15, and the right hand side is a 14 by
14 matrix.  What is this line trying to do?  Did it ever give the correct
result?

-Bill


On Fri, Jun 4, 2021 at 7:39 AM Bill Dunlap <williamwdunlap at gmail.com> wrote:

> That log file includes the line
>     using R Under development (unstable) (2021-05-30 r80413)
> and later says
>
> The error most likely occurred in:
>
> > ### Name: path_coeff
> > ### Title: Path coefficients with minimal multicollinearity
> > ### Aliases: path_coeff path_coeff_mat
> >
> > ### ** Examples
> >
> > ## No test:
> > library(metan)
> >
> > # Using KW as the response variable and all other ones as predictors
> > pcoeff <- path_coeff(data_ge2, resp = KW)
> Error in matrix(value, n, p) :
>   data length differs from size of matrix: [196 != 1 x 14]
> Calls: path_coeff -> [<- -> [<-.data.frame -> matrix
> Execution halted
>
> In the current R-devel the matrix command matrix(value, nrow, ncol) complains if length(value)>nrow*ncol, so you need to truncate 'value'.  (Previously matrix() would silently truncate value.)
>
>
> -Bill
>
>
> On Thu, Jun 3, 2021 at 5:57 PM Tiago Olivoto <tiagoolivoto at gmail.com>
> wrote:
>
>> Dear all,
>> I have received an email from the CRAN team to fix a problem with my R
>> package metan <https://CRAN.R-project.org/package=metan
>> <https://cran.r-project.org/package=metan>> to safely retain it on CRAN.
>>
>> The error is given at <
>> https://www.stats.ox.ac.uk/pub/bdr/donttest/metan.out>
>> and seems to be related to data different from size of matrix.
>>
>> The question is that and I cannot reproduce the error locally and thus not
>> able to fix anything. By googling the error I've seen similar issues with
>> a
>> lot of other packages. Could be this be a temporary issue?
>>
>> Thanks in advance!
>> Tiago
>>
>>         [[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>
>

	[[alternative HTML version deleted]]


From t|@goo||voto @end|ng |rom gm@||@com  Fri Jun  4 20:11:41 2021
From: t|@goo||voto @end|ng |rom gm@||@com (Tiago Olivoto)
Date: Fri, 4 Jun 2021 15:11:41 -0300
Subject: [R-pkg-devel] [Error] data length differs from size of matrix
In-Reply-To: <CAHqSRuSq6_Z2H7ZNc2zQnkAY9q9nqnrEEjcKj8z+qVQVGenYeA@mail.gmail.com>
References: <CAMyz+tWyDMJuFA1r4Uzf8dVgDOqwn+gLP+BBgw_XuNzReyUS4A@mail.gmail.com>
 <CAHqSRuSuizvQ9AAtbxKNz16v3fRwG1-SADmfwkV4VuBaCGRRiA@mail.gmail.com>
 <CAHqSRuSq6_Z2H7ZNc2zQnkAY9q9nqnrEEjcKj8z+qVQVGenYeA@mail.gmail.com>
Message-ID: <CAMyz+tUYSr_TpLaeA_eiCnXzRXd4NSP9EppT73SdmaLqgU2cjw@mail.gmail.com>

Thanks, Bill and Max for your suggestions.
I was using R 4.1.0. After updating to R-devel I was able to reproduce the
error, which was just fixed by using solve() instead solve_svd() in the
line suggested by Bill.

Best regards,
Tiago

Em sex., 4 de jun. de 2021 ?s 12:41, Bill Dunlap <williamwdunlap at gmail.com>
escreveu:

> The offending line in path_coeff seems to be
>    betas[i, 2:nvar] <- t(solve_svd(cor.x2, cor.y))
> where i is a single integer, nvar is 15, and the right hand side is a 14
> by 14 matrix.  What is this line trying to do?  Did it ever give the
> correct result?
>
> -Bill
>
>
> On Fri, Jun 4, 2021 at 7:39 AM Bill Dunlap <williamwdunlap at gmail.com>
> wrote:
>
>> That log file includes the line
>>     using R Under development (unstable) (2021-05-30 r80413)
>> and later says
>>
>> The error most likely occurred in:
>>
>> > ### Name: path_coeff
>> > ### Title: Path coefficients with minimal multicollinearity
>> > ### Aliases: path_coeff path_coeff_mat
>> >
>> > ### ** Examples
>> >
>> > ## No test:
>> > library(metan)
>> >
>> > # Using KW as the response variable and all other ones as predictors
>> > pcoeff <- path_coeff(data_ge2, resp = KW)
>> Error in matrix(value, n, p) :
>>   data length differs from size of matrix: [196 != 1 x 14]
>> Calls: path_coeff -> [<- -> [<-.data.frame -> matrix
>> Execution halted
>>
>> In the current R-devel the matrix command matrix(value, nrow, ncol) complains if length(value)>nrow*ncol, so you need to truncate 'value'.  (Previously matrix() would silently truncate value.)
>>
>>
>> -Bill
>>
>>
>> On Thu, Jun 3, 2021 at 5:57 PM Tiago Olivoto <tiagoolivoto at gmail.com>
>> wrote:
>>
>>> Dear all,
>>> I have received an email from the CRAN team to fix a problem with my R
>>> package metan <https://CRAN.R-project.org/package=metan
>>> <https://cran.r-project.org/package=metan>> to safely retain it on CRAN.
>>>
>>> The error is given at <
>>> https://www.stats.ox.ac.uk/pub/bdr/donttest/metan.out>
>>> and seems to be related to data different from size of matrix.
>>>
>>> The question is that and I cannot reproduce the error locally and thus
>>> not
>>> able to fix anything. By googling the error I've seen similar issues
>>> with a
>>> lot of other packages. Could be this be a temporary issue?
>>>
>>> Thanks in advance!
>>> Tiago
>>>
>>>         [[alternative HTML version deleted]]
>>>
>>> ______________________________________________
>>> R-package-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>
>>

	[[alternative HTML version deleted]]


From w||||@mwdun|@p @end|ng |rom gm@||@com  Fri Jun  4 20:12:47 2021
From: w||||@mwdun|@p @end|ng |rom gm@||@com (Bill Dunlap)
Date: Fri, 4 Jun 2021 11:12:47 -0700
Subject: [R-pkg-devel] [Error] data length differs from size of matrix
In-Reply-To: <CAHqSRuSq6_Z2H7ZNc2zQnkAY9q9nqnrEEjcKj8z+qVQVGenYeA@mail.gmail.com>
References: <CAMyz+tWyDMJuFA1r4Uzf8dVgDOqwn+gLP+BBgw_XuNzReyUS4A@mail.gmail.com>
 <CAHqSRuSuizvQ9AAtbxKNz16v3fRwG1-SADmfwkV4VuBaCGRRiA@mail.gmail.com>
 <CAHqSRuSq6_Z2H7ZNc2zQnkAY9q9nqnrEEjcKj8z+qVQVGenYeA@mail.gmail.com>
Message-ID: <CAHqSRuRqN98jbsMnHrGZnwZOQBcDEn2a-zSHtHcZL_EOdf+hHQ@mail.gmail.com>

solve_svd's second argument is 'tolerance', a small scalar value, not the
right hand side of X %*% beta == Y.  It returns the [approximate] inverse
of X, not beta.

solve_svd(cor.x2,cor.y) should probably be solve_svd(cor.x2)%*%cor.y (or
just solve(cor.x2,cor.y)).

-Bill

On Fri, Jun 4, 2021 at 8:41 AM Bill Dunlap <williamwdunlap at gmail.com> wrote:

> The offending line in path_coeff seems to be
>    betas[i, 2:nvar] <- t(solve_svd(cor.x2, cor.y))
> where i is a single integer, nvar is 15, and the right hand side is a 14
> by 14 matrix.  What is this line trying to do?  Did it ever give the
> correct result?
>
> -Bill
>
>
> On Fri, Jun 4, 2021 at 7:39 AM Bill Dunlap <williamwdunlap at gmail.com>
> wrote:
>
>> That log file includes the line
>>     using R Under development (unstable) (2021-05-30 r80413)
>> and later says
>>
>> The error most likely occurred in:
>>
>> > ### Name: path_coeff
>> > ### Title: Path coefficients with minimal multicollinearity
>> > ### Aliases: path_coeff path_coeff_mat
>> >
>> > ### ** Examples
>> >
>> > ## No test:
>> > library(metan)
>> >
>> > # Using KW as the response variable and all other ones as predictors
>> > pcoeff <- path_coeff(data_ge2, resp = KW)
>> Error in matrix(value, n, p) :
>>   data length differs from size of matrix: [196 != 1 x 14]
>> Calls: path_coeff -> [<- -> [<-.data.frame -> matrix
>> Execution halted
>>
>> In the current R-devel the matrix command matrix(value, nrow, ncol) complains if length(value)>nrow*ncol, so you need to truncate 'value'.  (Previously matrix() would silently truncate value.)
>>
>>
>> -Bill
>>
>>
>> On Thu, Jun 3, 2021 at 5:57 PM Tiago Olivoto <tiagoolivoto at gmail.com>
>> wrote:
>>
>>> Dear all,
>>> I have received an email from the CRAN team to fix a problem with my R
>>> package metan <https://CRAN.R-project.org/package=metan
>>> <https://cran.r-project.org/package=metan>> to safely retain it on CRAN.
>>>
>>> The error is given at <
>>> https://www.stats.ox.ac.uk/pub/bdr/donttest/metan.out>
>>> and seems to be related to data different from size of matrix.
>>>
>>> The question is that and I cannot reproduce the error locally and thus
>>> not
>>> able to fix anything. By googling the error I've seen similar issues
>>> with a
>>> lot of other packages. Could be this be a temporary issue?
>>>
>>> Thanks in advance!
>>> Tiago
>>>
>>>         [[alternative HTML version deleted]]
>>>
>>> ______________________________________________
>>> R-package-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>
>>

	[[alternative HTML version deleted]]


From t|@goo||voto @end|ng |rom gm@||@com  Fri Jun  4 20:26:26 2021
From: t|@goo||voto @end|ng |rom gm@||@com (Tiago Olivoto)
Date: Fri, 4 Jun 2021 15:26:26 -0300
Subject: [R-pkg-devel] [Error] data length differs from size of matrix
In-Reply-To: <CAHqSRuRqN98jbsMnHrGZnwZOQBcDEn2a-zSHtHcZL_EOdf+hHQ@mail.gmail.com>
References: <CAMyz+tWyDMJuFA1r4Uzf8dVgDOqwn+gLP+BBgw_XuNzReyUS4A@mail.gmail.com>
 <CAHqSRuSuizvQ9AAtbxKNz16v3fRwG1-SADmfwkV4VuBaCGRRiA@mail.gmail.com>
 <CAHqSRuSq6_Z2H7ZNc2zQnkAY9q9nqnrEEjcKj8z+qVQVGenYeA@mail.gmail.com>
 <CAHqSRuRqN98jbsMnHrGZnwZOQBcDEn2a-zSHtHcZL_EOdf+hHQ@mail.gmail.com>
Message-ID: <CAMyz+tXndjo3q+jWwaoGjT43=cXvTeV+F5A9y5rFZAfMqpPOJA@mail.gmail.com>

Exactly Bill!
I'll implement your suggestion (solve_svd(cor.x2)%*%cor.y), to return betas.
Best!
Tiago


Em sex., 4 de jun. de 2021 ?s 15:12, Bill Dunlap <williamwdunlap at gmail.com>
escreveu:

> solve_svd's second argument is 'tolerance', a small scalar value, not the
> right hand side of X %*% beta == Y.  It returns the [approximate] inverse
> of X, not beta.
>
> solve_svd(cor.x2,cor.y) should probably be solve_svd(cor.x2)%*%cor.y (or
> just solve(cor.x2,cor.y)).
>
> -Bill
>
> On Fri, Jun 4, 2021 at 8:41 AM Bill Dunlap <williamwdunlap at gmail.com>
> wrote:
>
>> The offending line in path_coeff seems to be
>>    betas[i, 2:nvar] <- t(solve_svd(cor.x2, cor.y))
>> where i is a single integer, nvar is 15, and the right hand side is a 14
>> by 14 matrix.  What is this line trying to do?  Did it ever give the
>> correct result?
>>
>> -Bill
>>
>>
>> On Fri, Jun 4, 2021 at 7:39 AM Bill Dunlap <williamwdunlap at gmail.com>
>> wrote:
>>
>>> That log file includes the line
>>>     using R Under development (unstable) (2021-05-30 r80413)
>>> and later says
>>>
>>> The error most likely occurred in:
>>>
>>> > ### Name: path_coeff
>>> > ### Title: Path coefficients with minimal multicollinearity
>>> > ### Aliases: path_coeff path_coeff_mat
>>> >
>>> > ### ** Examples
>>> >
>>> > ## No test:
>>> > library(metan)
>>> >
>>> > # Using KW as the response variable and all other ones as predictors
>>> > pcoeff <- path_coeff(data_ge2, resp = KW)
>>> Error in matrix(value, n, p) :
>>>   data length differs from size of matrix: [196 != 1 x 14]
>>> Calls: path_coeff -> [<- -> [<-.data.frame -> matrix
>>> Execution halted
>>>
>>> In the current R-devel the matrix command matrix(value, nrow, ncol) complains if length(value)>nrow*ncol, so you need to truncate 'value'.  (Previously matrix() would silently truncate value.)
>>>
>>>
>>> -Bill
>>>
>>>
>>> On Thu, Jun 3, 2021 at 5:57 PM Tiago Olivoto <tiagoolivoto at gmail.com>
>>> wrote:
>>>
>>>> Dear all,
>>>> I have received an email from the CRAN team to fix a problem with my R
>>>> package metan <https://CRAN.R-project.org/package=metan
>>>> <https://cran.r-project.org/package=metan>> to safely retain it on
>>>> CRAN.
>>>>
>>>> The error is given at <
>>>> https://www.stats.ox.ac.uk/pub/bdr/donttest/metan.out>
>>>> and seems to be related to data different from size of matrix.
>>>>
>>>> The question is that and I cannot reproduce the error locally and thus
>>>> not
>>>> able to fix anything. By googling the error I've seen similar issues
>>>> with a
>>>> lot of other packages. Could be this be a temporary issue?
>>>>
>>>> Thanks in advance!
>>>> Tiago
>>>>
>>>>         [[alternative HTML version deleted]]
>>>>
>>>> ______________________________________________
>>>> R-package-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>>
>>>

	[[alternative HTML version deleted]]


From no@h@gre||er @end|ng |rom gm@||@com  Fri Jun  4 21:35:53 2021
From: no@h@gre||er @end|ng |rom gm@||@com (Noah Greifer)
Date: Fri, 4 Jun 2021 15:35:53 -0400
Subject: [R-pkg-devel] Suggesting gurobi
Message-ID: <CAPhhD8m-X9K68jOyK0Yi1tA8+i7aPRETrU5pCc2JB0qUhAgXZg@mail.gmail.com>

Hello,

I have been working on adding an option for my users to use integer
programming (a method of optimization) to enhance the results of a function
in my package. There are several R packages on CRAN that perform integer
programming, including Rglpk and Rsymphony. However, there is a commercial
solver called Gurobi that dramatically outperforms all open-source solvers,
and it comes with an R interface through the gurobi package. I want to
allow my users to use Gurobi to perform the package actions.

A potential issue is that the gurobi package is not on CRAN; it comes with
an installation of the Gurobi software, which requires a license. I am not
sure how to add gurobi to my Description file to satisfy CRAN's
requirements. In CMD CHECK, I get the warning that the package is not
available for checking. However, I have noticed some other packages do use
gurobi just as I want to (i.e., as an option), such as CVXR
<https://cran.r-project.org/package=CVXR> and designmatch
<https://cran.r-project.org/package=designmatch>, which put gurobi in
Enhances (though I would have thought it would belong in Suggests). It
seems that neither of these packages passes the CRAN checks, though.

I'm wondering what the best practices are for including gurobi in my
package. To be clear, its use is optional and the package can be functional
without it, but it greatly enhances performance so I want my users to be
able to use it. Thank you!

Noah Greifer

	[[alternative HTML version deleted]]


From n@r@@ @end|ng |rom @t@n|ord@edu  Sat Jun  5 01:21:36 2021
From: n@r@@ @end|ng |rom @t@n|ord@edu (Balasubramanian Narasimhan)
Date: Fri, 4 Jun 2021 16:21:36 -0700
Subject: [R-pkg-devel] Suggesting gurobi
In-Reply-To: <CAPhhD8m-X9K68jOyK0Yi1tA8+i7aPRETrU5pCc2JB0qUhAgXZg@mail.gmail.com>
References: <CAPhhD8m-X9K68jOyK0Yi1tA8+i7aPRETrU5pCc2JB0qUhAgXZg@mail.gmail.com>
Message-ID: <48a1ae20-cd79-571c-2ed6-8499c1964ef0@stanford.edu>

Suggests" would trigger an attempt to install gurobi, which is not on CRAN.

We used "Enhances" for our CVXR? because

(1) None of the functionality in the package requires gurobi;

(2) Packages in "Enhances" are not required to check the package by CRAN.

Your package mirrors ours in these respects and so I would suggest going 
with "Enhances".

-Naras

On 6/4/21 12:35 PM, Noah Greifer wrote:
> Hello,
>
> I have been working on adding an option for my users to use integer
> programming (a method of optimization) to enhance the results of a function
> in my package. There are several R packages on CRAN that perform integer
> programming, including Rglpk and Rsymphony. However, there is a commercial
> solver called Gurobi that dramatically outperforms all open-source solvers,
> and it comes with an R interface through the gurobi package. I want to
> allow my users to use Gurobi to perform the package actions.
>
> A potential issue is that the gurobi package is not on CRAN; it comes with
> an installation of the Gurobi software, which requires a license. I am not
> sure how to add gurobi to my Description file to satisfy CRAN's
> requirements. In CMD CHECK, I get the warning that the package is not
> available for checking. However, I have noticed some other packages do use
> gurobi just as I want to (i.e., as an option), such as CVXR
> <https://cran.r-project.org/package=CVXR> and designmatch
> <https://cran.r-project.org/package=designmatch>, which put gurobi in
> Enhances (though I would have thought it would belong in Suggests). It
> seems that neither of these packages passes the CRAN checks, though.
>
> I'm wondering what the best practices are for including gurobi in my
> package. To be clear, its use is optional and the package can be functional
> without it, but it greatly enhances performance so I want my users to be
> able to use it. Thank you!
>
> Noah Greifer
>
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From edd @end|ng |rom deb|@n@org  Sat Jun  5 01:47:13 2021
From: edd @end|ng |rom deb|@n@org (Dirk Eddelbuettel)
Date: Fri, 4 Jun 2021 18:47:13 -0500
Subject: [R-pkg-devel] Suggesting gurobi
In-Reply-To: <48a1ae20-cd79-571c-2ed6-8499c1964ef0@stanford.edu>
References: <CAPhhD8m-X9K68jOyK0Yi1tA8+i7aPRETrU5pCc2JB0qUhAgXZg@mail.gmail.com>
 <48a1ae20-cd79-571c-2ed6-8499c1964ef0@stanford.edu>
Message-ID: <24762.48001.894354.108932@rob.eddelbuettel.com>


On 4 June 2021 at 16:21, Balasubramanian Narasimhan wrote:
| Suggests" would trigger an attempt to install gurobi, which is not on CRAN.

To my understanding that is not the case. It would only do so if and when
install.packages() is asked to also install packages in Suggests:. And point
of Suggests: is that that is not automagic.

I actually Suggests, together with Additional_Repositories: (for which Noah
may have to set the repo up, I have not checked if gurobi has one) may be the
correct call.

Dirk

-- 
https://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From konr@d_kr@emer @end|ng |rom y@hoo@de  Mon Jun  7 12:54:00 2021
From: konr@d_kr@emer @end|ng |rom y@hoo@de (=?UTF-8?Q?Konrad_Kr=C3=A4mer?=)
Date: Mon, 7 Jun 2021 10:54:00 +0000 (UTC)
Subject: [R-pkg-devel] OpenMP on MacOS
References: <278942375.6142737.1623063240992.ref@mail.yahoo.com>
Message-ID: <278942375.6142737.1623063240992@mail.yahoo.com>

Dear all,
I have a problem regarding OpenMP on Mac OS. Recently I submitted my package to CRAN (https://cran.r-project.org/web/packages/paropt/index.html). However, there seems to be a problem with 'fopenmp' on Mac OS using clang++. I have read many forums regarding the topic. Thus, I know that there is no support for OpenMp on Mac OS (at least using the default clang compiler).?
The error was:?clang: error: unsupported option '-fopenmp'
Is it possible to detect the operating system and set according to this the compile flags and use also a sequentiell version of the code?
Or is there a better way to cope with this problem?
Many thanks in advance for your help.
Regards,
Konrad?
	[[alternative HTML version deleted]]


From d@v|d@kepp||nger @end|ng |rom gm@||@com  Mon Jun  7 15:07:00 2021
From: d@v|d@kepp||nger @end|ng |rom gm@||@com (David Kepplinger)
Date: Mon, 7 Jun 2021 09:07:00 -0400
Subject: [R-pkg-devel] OpenMP on MacOS
In-Reply-To: <278942375.6142737.1623063240992@mail.yahoo.com>
References: <278942375.6142737.1623063240992.ref@mail.yahoo.com>
 <278942375.6142737.1623063240992@mail.yahoo.com>
Message-ID: <CAGmyFCGYbWnG-BD+4SF0XtwjzyeHKYmF=0jpPcg7e4w0x902MQ@mail.gmail.com>

See
https://cran.r-project.org/doc/manuals/r-release/R-exts.html#OpenMP-support
for a way to enable OpenMP when it's available. If you need more detailed
checks for the OpenMP support in the toolchain, you would need to use a
configure script. For example, I'm using an autoconf configure script for
the pense package (
https://github.com/dakep/pense-rpkg/blob/main/configure.ac) to detect if
(and how) OpenMP is supported and whether the toolchain supports parts of
more recent OpenMP versions.

Best,
David


On Mon, Jun 7, 2021 at 7:52 AM Konrad Kr?mer via R-package-devel <
r-package-devel at r-project.org> wrote:

> Dear all,
> I have a problem regarding OpenMP on Mac OS. Recently I submitted my
> package to CRAN (https://cran.r-project.org/web/packages/paropt/index.html).
> However, there seems to be a problem with 'fopenmp' on Mac OS using
> clang++. I have read many forums regarding the topic. Thus, I know that
> there is no support for OpenMp on Mac OS (at least using the default clang
> compiler).
> The error was: clang: error: unsupported option '-fopenmp'
> Is it possible to detect the operating system and set according to this
> the compile flags and use also a sequentiell version of the code?
> Or is there a better way to cope with this problem?
> Many thanks in advance for your help.
> Regards,
> Konrad
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


-- 
David Kepplinger, PhD
https://www.dkepplinger.org

	[[alternative HTML version deleted]]


From hugh@p@r@on@ge @end|ng |rom gm@||@com  Mon Jun  7 16:28:30 2021
From: hugh@p@r@on@ge @end|ng |rom gm@||@com (Hugh Parsonage)
Date: Tue, 8 Jun 2021 00:28:30 +1000
Subject: [R-pkg-devel] OpenMP on MacOS
In-Reply-To: <278942375.6142737.1623063240992@mail.yahoo.com>
References: <278942375.6142737.1623063240992.ref@mail.yahoo.com>
 <278942375.6142737.1623063240992@mail.yahoo.com>
Message-ID: <CAJmOi+PD3vonBDTa9TuvLS_UYEe8qwhWYxKCRshKvoYVdFkkYA@mail.gmail.com>

Ensure you surround all your omp pragmas like so:

#ifdef _OPENMP
#pragma omp parallel ...
#endif

Essentially, detecting the operating system is not enough -- you need
to condition your use of OpenMP if and only if _OPENMP is available.

You should also do the same for

#if _OPENMP
#include <omp.h>
#endif

Note that this will also make your loops sequential when OpenMP is not
available.

On Mon, 7 Jun 2021 at 21:52, Konrad Kr?mer via R-package-devel
<r-package-devel at r-project.org> wrote:
>
> Dear all,
> I have a problem regarding OpenMP on Mac OS. Recently I submitted my package to CRAN (https://cran.r-project.org/web/packages/paropt/index.html). However, there seems to be a problem with 'fopenmp' on Mac OS using clang++. I have read many forums regarding the topic. Thus, I know that there is no support for OpenMp on Mac OS (at least using the default clang compiler).
> The error was: clang: error: unsupported option '-fopenmp'
> Is it possible to detect the operating system and set according to this the compile flags and use also a sequentiell version of the code?
> Or is there a better way to cope with this problem?
> Many thanks in advance for your help.
> Regards,
> Konrad
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de  Mon Jun  7 18:30:34 2021
From: ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de (Uwe Ligges)
Date: Mon, 7 Jun 2021 18:30:34 +0200
Subject: [R-pkg-devel] Suggesting gurobi
In-Reply-To: <24762.48001.894354.108932@rob.eddelbuettel.com>
References: <CAPhhD8m-X9K68jOyK0Yi1tA8+i7aPRETrU5pCc2JB0qUhAgXZg@mail.gmail.com>
 <48a1ae20-cd79-571c-2ed6-8499c1964ef0@stanford.edu>
 <24762.48001.894354.108932@rob.eddelbuettel.com>
Message-ID: <36cd8b1c-07e2-98ea-92a2-ea63d06173e3@statistik.tu-dortmund.de>



On 05.06.2021 01:47, Dirk Eddelbuettel wrote:
> 
> On 4 June 2021 at 16:21, Balasubramanian Narasimhan wrote:
> | Suggests" would trigger an attempt to install gurobi, which is not on CRAN.
> 
> To my understanding that is not the case. It would only do so if and when
> install.packages() is asked to also install packages in Suggests:. And point
> of Suggests: is that that is not automagic.
> 
> I actually Suggests, together with Additional_Repositories: (for which Noah
> may have to set the repo up, I have not checked if gurobi has one) may be the
> correct call.

That would indeed be ideal. As far as I know there is not CRAN-like repo 
with gurobi. Following the CRAN policies you can exolain in the 
Description field of the DESCRIPTION file how to get that package to 
your users.

Best,
Uwe Ligges

> Dirk
>


From no@h@gre||er @end|ng |rom gm@||@com  Wed Jun  9 04:16:59 2021
From: no@h@gre||er @end|ng |rom gm@||@com (Noah Greifer)
Date: Tue, 8 Jun 2021 22:16:59 -0400
Subject: [R-pkg-devel] Suggesting gurobi
In-Reply-To: <36cd8b1c-07e2-98ea-92a2-ea63d06173e3@statistik.tu-dortmund.de>
References: <CAPhhD8m-X9K68jOyK0Yi1tA8+i7aPRETrU5pCc2JB0qUhAgXZg@mail.gmail.com>
 <48a1ae20-cd79-571c-2ed6-8499c1964ef0@stanford.edu>
 <24762.48001.894354.108932@rob.eddelbuettel.com>
 <36cd8b1c-07e2-98ea-92a2-ea63d06173e3@statistik.tu-dortmund.de>
Message-ID: <CAPhhD8=cWpwmkg5S8qntxQ5RAH5+Vu-23Ndpqn2Lz7enh3Js0A@mail.gmail.com>

Thank you all for your help. I won't set up a repo for gurobi because I
don't have the authority to do that. It seems like I should include gurobi
in Suggests, even though it cannot be automatically installed from any
repository, include instructions for installing it in Description, and just
deal with the fact that cmd check will always flag it as a problem. It does
seem more convenient to just put it in Enhances so it is not flagged on a
check since it is not used in any examples and the code that uses its
functions has alternative options.

Noah

On Mon, Jun 7, 2021 at 12:30 PM Uwe Ligges <ligges at statistik.tu-dortmund.de>
wrote:

>
>
> On 05.06.2021 01:47, Dirk Eddelbuettel wrote:
> >
> > On 4 June 2021 at 16:21, Balasubramanian Narasimhan wrote:
> > | Suggests" would trigger an attempt to install gurobi, which is not on
> CRAN.
> >
> > To my understanding that is not the case. It would only do so if and when
> > install.packages() is asked to also install packages in Suggests:. And
> point
> > of Suggests: is that that is not automagic.
> >
> > I actually Suggests, together with Additional_Repositories: (for which
> Noah
> > may have to set the repo up, I have not checked if gurobi has one) may
> be the
> > correct call.
>
> That would indeed be ideal. As far as I know there is not CRAN-like repo
> with gurobi. Following the CRAN policies you can exolain in the
> Description field of the DESCRIPTION file how to get that package to
> your users.
>
> Best,
> Uwe Ligges
>
> > Dirk
> >
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>

	[[alternative HTML version deleted]]


From tom@@@k@||ber@ @end|ng |rom gm@||@com  Thu Jun 10 12:27:08 2021
From: tom@@@k@||ber@ @end|ng |rom gm@||@com (Tomas Kalibera)
Date: Thu, 10 Jun 2021 12:27:08 +0200
Subject: [R-pkg-devel] Valgrind warning: invalid size of 4,
 is it due to a simple overrun?
In-Reply-To: <CAJmOi+P+345JTPLrX0N-=MwNzeXc+wMwkv+JiVdUZtjJEdR8Gg@mail.gmail.com>
References: <CAJmOi+P+345JTPLrX0N-=MwNzeXc+wMwkv+JiVdUZtjJEdR8Gg@mail.gmail.com>
Message-ID: <b46552c7-43c7-646f-fcc1-a6085c5cde40@gmail.com>


On 6/2/21 3:01 AM, Hugh Parsonage wrote:
> Hello,
>
> I received a valgrind warning about my package, hutilscpp, from CRAN
> (thank you).  I believe I've tracked down and fixed the problem, but I
> wasn't able to reproduce the error on rhub (including with
> --leak-check=full etc) so I'd like to know if I'm missing something.
>
> The valgrind warning is "Invalid write of size 4" and refers to this
> line https://github.com/HughParsonage/hutilscpp/blob/508f134b3f388653985eca372ed5f4f8b8eb3471/src/Cwhich_even.c#L43
>
> the context for this line is:
>
> const double * xp = REAL(xx);
> for (R_xlen_t i = 0, j = 0; i < N; ++i) {
>    int is_even = R_finite(xp[i]) && (fmod(xp[i], 2) == 0);
>    ansp[j] = (int)(i + 1);        // # <-------- line 43
>    j += is_even;
> }
I would simply use an explicit branch, store the index into ansp only 
when the element is even, and increment an index for ansp in that case. 
That would make the code clearer and easy to see potential errors in it.
> where ansp is a pointer to an integer vector whose length is the
> number of "even" doubles in xx.  I can see that the problem arises
> when the last even number occurs before the end of the vector xx, at
> which point j == length(ansp), yet the loop continues.  I've amended
> the i < N in the for loop to (i < N && j < n_even) which I believe is
> sufficient, but obviously I thought it was ok before.
>
> I'd rather not resubmit only to discover that I've overlooked something else.
>
> As a supplementary question, does the valgrind check depend on the
> runtime values in the test suite or does it perform fuzz testing?  In
> other words, do I need to add tests to reproduce?

With valgrind, the code is ran deterministically.

I would not worry about trying to reproduce if the code is rewritten in 
the way suggested, because that's easy to validate visually.

In principle, if you wanted still to reproduce, you could add an 
explicit runtime check that the identified write is in bounds, run the 
original code, hopefully see it fail. And then do the same with the 
fixed code and see it pass. And then remove the runtime check and submit.

Best
Tomas

>
> Best,
>
>
> Hugh.
>
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel


From pro|jcn@@h @end|ng |rom gm@||@com  Thu Jun 10 15:22:19 2021
From: pro|jcn@@h @end|ng |rom gm@||@com (J C Nash)
Date: Thu, 10 Jun 2021 09:22:19 -0400
Subject: [R-pkg-devel] Windows load error installing package
Message-ID: <6a9a0755-31e2-d340-daa1-2c76baf77d15@gmail.com>

Hi,

I'm mentoring Arkajyoti Bhattacharjee for the Google Summer of Code project "Improvements to nls()".

Thanks to help from Duncan Murdoch, we have extracted the nls() functionality to a package nlspkg and are building
an nlsalt package. We can then run nlspkg::AFunction() and nlsalt::AFunction() in a single script to compare.
This works great in Linux, with the packages building and installing under the command line or in Rstudio.
But in Windows CMD the "R CMD build" works, but "R CMD INSTALL" gives a number of errors of the type

*** arch - i386
C:/RBuildTools/4.0/mingw32/bin/../lib/gcc/i686-w64-mingw32/8.3.0/../../../../i686-w64-mingw32/bin/ld.exe:
loessf.o:loessf.f:(.text+0x650): undefined reference to `idamax_'

The reference is to a BLAS function, so I am fairly certain there is some failed pointer, possibly a
makevars.win entry, that we need. So far my searches and (possibly silly) attempts to provide links
have failed.

Can anyone provide suggestions?

John Nash


From edd @end|ng |rom deb|@n@org  Thu Jun 10 15:37:00 2021
From: edd @end|ng |rom deb|@n@org (Dirk Eddelbuettel)
Date: Thu, 10 Jun 2021 08:37:00 -0500
Subject: [R-pkg-devel] Windows load error installing package
In-Reply-To: <6a9a0755-31e2-d340-daa1-2c76baf77d15@gmail.com>
References: <6a9a0755-31e2-d340-daa1-2c76baf77d15@gmail.com>
Message-ID: <24770.5500.172953.813924@rob.eddelbuettel.com>


On 10 June 2021 at 09:22, J C Nash wrote:
| Thanks to help from Duncan Murdoch, we have extracted the nls() functionality to a package nlspkg and are building
| an nlsalt package. We can then run nlspkg::AFunction() and nlsalt::AFunction() in a single script to compare.
| This works great in Linux, with the packages building and installing under the command line or in Rstudio.
| But in Windows CMD the "R CMD build" works, but "R CMD INSTALL" gives a number of errors of the type
| 
| *** arch - i386
| C:/RBuildTools/4.0/mingw32/bin/../lib/gcc/i686-w64-mingw32/8.3.0/../../../../i686-w64-mingw32/bin/ld.exe:
| loessf.o:loessf.f:(.text+0x650): undefined reference to `idamax_'
| 
| The reference is to a BLAS function, so I am fairly certain there is some failed pointer, possibly a
| makevars.win entry, that we need. So far my searches and (possibly silly) attempts to provide links
| have failed.
| 
| Can anyone provide suggestions?

Guess: On Linux you use a complete (external) BLAS, on Windows you use the
(subset) BLAS provided by R which may not have the desired function rending
your approach less portable.  See what sessionInfo() has to say on both.

Dirk

-- 
https://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From pro|jcn@@h @end|ng |rom gm@||@com  Thu Jun 10 15:51:42 2021
From: pro|jcn@@h @end|ng |rom gm@||@com (J C Nash)
Date: Thu, 10 Jun 2021 09:51:42 -0400
Subject: [R-pkg-devel] Windows load error installing package
In-Reply-To: <24770.5500.172953.813924@rob.eddelbuettel.com>
References: <6a9a0755-31e2-d340-daa1-2c76baf77d15@gmail.com>
 <24770.5500.172953.813924@rob.eddelbuettel.com>
Message-ID: <a6032787-8cf4-9c76-2237-551e125ecc30@gmail.com>

Thanks Dirk:

It looks like R_Windows isn't setting any BLAS or LAPACK. Here is the output from sessionInfo() on
my Win10 (VirtualBox VM) and Linux Mint 20.1 systems. However, I've not got any idea how to fix
this.

JN


>> sessionInfo()
> R version 4.1.0 (2021-05-18)
> Platform: x86_64-w64-mingw32/x64 (64-bit)
> Running under: Windows 10 x64 (build 19042)
> 
> Matrix products: default
> 
> locale:
> [1] LC_COLLATE=English_United States.1252
> [2] LC_CTYPE=English_United States.1252
> [3] LC_MONETARY=English_United States.1252
> [4] LC_NUMERIC=C
> [5] LC_TIME=English_United States.1252
> 
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
> 
> loaded via a namespace (and not attached):
> [1] compiler_4.1.0
>>
> 
> 
>> sessionInfo()
> R version 4.1.0 (2021-05-18)
> Platform: x86_64-pc-linux-gnu (64-bit)
> Running under: Linux Mint 20.1
> 
> Matrix products: default
> BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3
> LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/liblapack.so.3
> 
> locale:
>  [1] LC_CTYPE=en_CA.UTF-8       LC_NUMERIC=C              
>  [3] LC_TIME=en_CA.UTF-8        LC_COLLATE=en_CA.UTF-8    
>  [5] LC_MONETARY=en_CA.UTF-8    LC_MESSAGES=en_CA.UTF-8   
>  [7] LC_PAPER=en_CA.UTF-8       LC_NAME=C                 
>  [9] LC_ADDRESS=C               LC_TELEPHONE=C            
> [11] LC_MEASUREMENT=en_CA.UTF-8 LC_IDENTIFICATION=C       
> 
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base     
> 
> loaded via a namespace (and not attached):
> [1] compiler_4.1.0
>> 


On 2021-06-10 9:37 a.m., Dirk Eddelbuettel wrote:
> 
> On 10 June 2021 at 09:22, J C Nash wrote:
> | Thanks to help from Duncan Murdoch, we have extracted the nls() functionality to a package nlspkg and are building
> | an nlsalt package. We can then run nlspkg::AFunction() and nlsalt::AFunction() in a single script to compare.
> | This works great in Linux, with the packages building and installing under the command line or in Rstudio.
> | But in Windows CMD the "R CMD build" works, but "R CMD INSTALL" gives a number of errors of the type
> | 
> | *** arch - i386
> | C:/RBuildTools/4.0/mingw32/bin/../lib/gcc/i686-w64-mingw32/8.3.0/../../../../i686-w64-mingw32/bin/ld.exe:
> | loessf.o:loessf.f:(.text+0x650): undefined reference to `idamax_'
> | 
> | The reference is to a BLAS function, so I am fairly certain there is some failed pointer, possibly a
> | makevars.win entry, that we need. So far my searches and (possibly silly) attempts to provide links
> | have failed.
> | 
> | Can anyone provide suggestions?
> 
> Guess: On Linux you use a complete (external) BLAS, on Windows you use the
> (subset) BLAS provided by R which may not have the desired function rending
> your approach less portable.  See what sessionInfo() has to say on both.
> 
> Dirk
>


From pro|jcn@@h @end|ng |rom gm@||@com  Fri Jun 11 17:16:55 2021
From: pro|jcn@@h @end|ng |rom gm@||@com (J C Nash)
Date: Fri, 11 Jun 2021 11:16:55 -0400
Subject: [R-pkg-devel] Windows load error installing package SOLVED
In-Reply-To: <24770.5500.172953.813924@rob.eddelbuettel.com>
References: <6a9a0755-31e2-d340-daa1-2c76baf77d15@gmail.com>
 <24770.5500.172953.813924@rob.eddelbuettel.com>
Message-ID: <1a54b8d7-be01-dac3-2448-567d1f0c66fa@gmail.com>

After some flailing around, discovered a posting

https://stackoverflow.com/questions/42118561/error-in-r-cmd-shlib-compiling-c-code

which showed a makevars.win file containing

PKG_LIBS = $(LAPACK_LIBS) $(BLAS_LIBS) $(FLIBS)

I had tried several similar such makevars.win files, but trying PKG_LIBS+= and
no spaces. There is mention of the libraries in Writing R Extensions, but given
the heavy use of LAPACK, BLAS and FLIBS, perhaps this example should be there
in the documentation. I've separately noted that Linux sessionInfo() shows
BLAS and LAPACK but Windows does not.

Cheers, JN

On 2021-06-10 9:37 a.m., Dirk Eddelbuettel wrote:
> 
> On 10 June 2021 at 09:22, J C Nash wrote:
> | Thanks to help from Duncan Murdoch, we have extracted the nls() functionality to a package nlspkg and are building
> | an nlsalt package. We can then run nlspkg::AFunction() and nlsalt::AFunction() in a single script to compare.
> | This works great in Linux, with the packages building and installing under the command line or in Rstudio.
> | But in Windows CMD the "R CMD build" works, but "R CMD INSTALL" gives a number of errors of the type
> | 
> | *** arch - i386
> | C:/RBuildTools/4.0/mingw32/bin/../lib/gcc/i686-w64-mingw32/8.3.0/../../../../i686-w64-mingw32/bin/ld.exe:
> | loessf.o:loessf.f:(.text+0x650): undefined reference to `idamax_'
> | 
> | The reference is to a BLAS function, so I am fairly certain there is some failed pointer, possibly a
> | makevars.win entry, that we need. So far my searches and (possibly silly) attempts to provide links
> | have failed.
> | 
> | Can anyone provide suggestions?
> 
> Guess: On Linux you use a complete (external) BLAS, on Windows you use the
> (subset) BLAS provided by R which may not have the desired function rending
> your approach less portable.  See what sessionInfo() has to say on both.
> 
> Dirk
>


From pro|jcn@@h @end|ng |rom gm@||@com  Sat Jun 12 16:39:07 2021
From: pro|jcn@@h @end|ng |rom gm@||@com (J C Nash)
Date: Sat, 12 Jun 2021 10:39:07 -0400
Subject: [R-pkg-devel] Windows load error installing package SOLVED -
 additional note
In-Reply-To: <1a54b8d7-be01-dac3-2448-567d1f0c66fa@gmail.com>
References: <6a9a0755-31e2-d340-daa1-2c76baf77d15@gmail.com>
 <24770.5500.172953.813924@rob.eddelbuettel.com>
 <1a54b8d7-be01-dac3-2448-567d1f0c66fa@gmail.com>
Message-ID: <13482e4b-cd1d-a37f-3662-00fa2ae46350@gmail.com>

Two minor notes:

1) The Writing R Extensions manual, as far as I can determine, does not inform package
developers that Makevars.win needs to be in the src/ subdirectory. I followed the example
of some other packages to choose where to put it.

2) Also, while I managed to get my package to install with "makevars.win", I got a
WARNING on running a CHECK until I replaced it with "Makevars.win", i.e., Camel-case
name.

Do these observations merit edits in the manual?

JN


On 2021-06-11 11:16 a.m., J C Nash wrote:
> After some flailing around, discovered a posting
> 
> https://stackoverflow.com/questions/42118561/error-in-r-cmd-shlib-compiling-c-code
> 
> which showed a makevars.win file containing
> 
> PKG_LIBS = $(LAPACK_LIBS) $(BLAS_LIBS) $(FLIBS)
> 
> I had tried several similar such makevars.win files, but trying PKG_LIBS+= and
> no spaces. There is mention of the libraries in Writing R Extensions, but given
> the heavy use of LAPACK, BLAS and FLIBS, perhaps this example should be there
> in the documentation. I've separately noted that Linux sessionInfo() shows
> BLAS and LAPACK but Windows does not.
> 
> Cheers, JN
>


From ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de  Sun Jun 13 01:27:54 2021
From: ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de (Uwe Ligges)
Date: Sun, 13 Jun 2021 01:27:54 +0200
Subject: [R-pkg-devel] Windows load error installing package SOLVED -
 additional note
In-Reply-To: <13482e4b-cd1d-a37f-3662-00fa2ae46350@gmail.com>
References: <6a9a0755-31e2-d340-daa1-2c76baf77d15@gmail.com>
 <24770.5500.172953.813924@rob.eddelbuettel.com>
 <1a54b8d7-be01-dac3-2448-567d1f0c66fa@gmail.com>
 <13482e4b-cd1d-a37f-3662-00fa2ae46350@gmail.com>
Message-ID: <ec42658f-c8e0-3af3-0dad-7525b32e1be2@statistik.tu-dortmund.de>



On 12.06.2021 16:39, J C Nash wrote:
> Two minor notes:
> 
> 1) The Writing R Extensions manual, as far as I can determine, does not inform package
> developers that Makevars.win needs to be in the src/ subdirectory. I followed the example
> of some other packages to choose where to put it.

I just searched for Makevars.win in Writing R Extensions and the first 
occurence is:
"There are platform-specific file names on Windows: src/Makevars.win"

So tells you both it should be in src and how to capitlize.

Best,
Uwe


> 
> 2) Also, while I managed to get my package to install with "makevars.win", I got a
> WARNING on running a CHECK until I replaced it with "Makevars.win", i.e., Camel-case
> name.
> 
> Do these observations merit edits in the manual?
> 
> JN
> 
> 
> On 2021-06-11 11:16 a.m., J C Nash wrote:
>> After some flailing around, discovered a posting
>>
>> https://stackoverflow.com/questions/42118561/error-in-r-cmd-shlib-compiling-c-code
>>
>> which showed a makevars.win file containing
>>
>> PKG_LIBS = $(LAPACK_LIBS) $(BLAS_LIBS) $(FLIBS)
>>
>> I had tried several similar such makevars.win files, but trying PKG_LIBS+= and
>> no spaces. There is mention of the libraries in Writing R Extensions, but given
>> the heavy use of LAPACK, BLAS and FLIBS, perhaps this example should be there
>> in the documentation. I've separately noted that Linux sessionInfo() shows
>> BLAS and LAPACK but Windows does not.
>>
>> Cheers, JN
>>
> 
> ______________________________________________
> R-package-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>


From pro|jcn@@h @end|ng |rom gm@||@com  Sun Jun 13 12:49:19 2021
From: pro|jcn@@h @end|ng |rom gm@||@com (J C Nash)
Date: Sun, 13 Jun 2021 06:49:19 -0400
Subject: [R-pkg-devel] Windows load error installing package SOLVED -
 additional note
In-Reply-To: <ec42658f-c8e0-3af3-0dad-7525b32e1be2@statistik.tu-dortmund.de>
References: <6a9a0755-31e2-d340-daa1-2c76baf77d15@gmail.com>
 <24770.5500.172953.813924@rob.eddelbuettel.com>
 <1a54b8d7-be01-dac3-2448-567d1f0c66fa@gmail.com>
 <13482e4b-cd1d-a37f-3662-00fa2ae46350@gmail.com>
 <ec42658f-c8e0-3af3-0dad-7525b32e1be2@statistik.tu-dortmund.de>
Message-ID: <ce4d3b4e-ca9e-da60-cb6b-c5044e4ac72a@gmail.com>

Thanks Uwe.

My misunderstanding. I thought the reference was to one of the
"src/" directories in the base R tree. However, I found examples in
some packages for the location.

Windows is alien territory for me, unfortunately.

JN


On 2021-06-12 7:27 p.m., Uwe Ligges wrote:
> 
> 
> On 12.06.2021 16:39, J C Nash wrote:
>> Two minor notes:
>>
>> 1) The Writing R Extensions manual, as far as I can determine, does not inform package
>> developers that Makevars.win needs to be in the src/ subdirectory. I followed the example
>> of some other packages to choose where to put it.
> 
> I just searched for Makevars.win in Writing R Extensions and the first occurence is:
> "There are platform-specific file names on Windows: src/Makevars.win"
> 
> So tells you both it should be in src and how to capitlize.
> 
> Best,
> Uwe
> 
> 
>>
>> 2) Also, while I managed to get my package to install with "makevars.win", I got a
>> WARNING on running a CHECK until I replaced it with "Makevars.win", i.e., Camel-case
>> name.
>>
>> Do these observations merit edits in the manual?
>>
>> JN
>>
>>
>> On 2021-06-11 11:16 a.m., J C Nash wrote:
>>> After some flailing around, discovered a posting
>>>
>>> https://stackoverflow.com/questions/42118561/error-in-r-cmd-shlib-compiling-c-code
>>>
>>> which showed a makevars.win file containing
>>>
>>> PKG_LIBS = $(LAPACK_LIBS) $(BLAS_LIBS) $(FLIBS)
>>>
>>> I had tried several similar such makevars.win files, but trying PKG_LIBS+= and
>>> no spaces. There is mention of the libraries in Writing R Extensions, but given
>>> the heavy use of LAPACK, BLAS and FLIBS, perhaps this example should be there
>>> in the documentation. I've separately noted that Linux sessionInfo() shows
>>> BLAS and LAPACK but Windows does not.
>>>
>>> Cheers, JN
>>>
>>
>> ______________________________________________
>> R-package-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>


From ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de  Mon Jun 14 00:00:45 2021
From: ||gge@ @end|ng |rom @t@t|@t|k@tu-dortmund@de (Uwe Ligges)
Date: Mon, 14 Jun 2021 00:00:45 +0200
Subject: [R-pkg-devel] Windows load error installing package SOLVED -
 additional note
In-Reply-To: <ce4d3b4e-ca9e-da60-cb6b-c5044e4ac72a@gmail.com>
References: <6a9a0755-31e2-d340-daa1-2c76baf77d15@gmail.com>
 <24770.5500.172953.813924@rob.eddelbuettel.com>
 <1a54b8d7-be01-dac3-2448-567d1f0c66fa@gmail.com>
 <13482e4b-cd1d-a37f-3662-00fa2ae46350@gmail.com>
 <ec42658f-c8e0-3af3-0dad-7525b32e1be2@statistik.tu-dortmund.de>
 <ce4d3b4e-ca9e-da60-cb6b-c5044e4ac72a@gmail.com>
Message-ID: <98c7c395-efd9-d030-ba6c-8d290b24ed4e@statistik.tu-dortmund.de>



On 13.06.2021 12:49, J C Nash wrote:
> Thanks Uwe.

You are welcome.


> My misunderstanding. I thought the reference was to one of the
> "src/" directories in the base R tree. However, I found examples in
> some packages for the location.
> 
> Windows is alien territory for me, unfortunately.

I see. Note the Makevars file for non Windows OS should be in the same 
place.

Best,
Uwe

> 
> JN
> 
> 
> On 2021-06-12 7:27 p.m., Uwe Ligges wrote:
>>
>>
>> On 12.06.2021 16:39, J C Nash wrote:
>>> Two minor notes:
>>>
>>> 1) The Writing R Extensions manual, as far as I can determine, does not inform package
>>> developers that Makevars.win needs to be in the src/ subdirectory. I followed the example
>>> of some other packages to choose where to put it.
>>
>> I just searched for Makevars.win in Writing R Extensions and the first occurence is:
>> "There are platform-specific file names on Windows: src/Makevars.win"
>>
>> So tells you both it should be in src and how to capitlize.
>>
>> Best,
>> Uwe
>>
>>
>>>
>>> 2) Also, while I managed to get my package to install with "makevars.win", I got a
>>> WARNING on running a CHECK until I replaced it with "Makevars.win", i.e., Camel-case
>>> name.
>>>
>>> Do these observations merit edits in the manual?
>>>
>>> JN
>>>
>>>
>>> On 2021-06-11 11:16 a.m., J C Nash wrote:
>>>> After some flailing around, discovered a posting
>>>>
>>>> https://stackoverflow.com/questions/42118561/error-in-r-cmd-shlib-compiling-c-code
>>>>
>>>> which showed a makevars.win file containing
>>>>
>>>> PKG_LIBS = $(LAPACK_LIBS) $(BLAS_LIBS) $(FLIBS)
>>>>
>>>> I had tried several similar such makevars.win files, but trying PKG_LIBS+= and
>>>> no spaces. There is mention of the libraries in Writing R Extensions, but given
>>>> the heavy use of LAPACK, BLAS and FLIBS, perhaps this example should be there
>>>> in the documentation. I've separately noted that Linux sessionInfo() shows
>>>> BLAS and LAPACK but Windows does not.
>>>>
>>>> Cheers, JN
>>>>
>>>
>>> ______________________________________________
>>> R-package-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-package-devel
>>>


