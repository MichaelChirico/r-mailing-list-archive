From ari.jolma at tkk.fi  Thu Mar  1 08:40:08 2007
From: ari.jolma at tkk.fi (Ari Jolma)
Date: Thu, 01 Mar 2007 09:40:08 +0200
Subject: [R-sig-Geo] Conference announcement: MODSIM 07
Message-ID: <45E68358.1030304@tkk.fi>

MODSIM07 ? CONFERENCE ANNOUNCEMENT & CALL FOR ABSTRACTS

THEME: ?Land, Water & Environmental Management: Integrated Systems for
Sustainability.?


CONFERENCE: 10 ? 13 December 2007, Christchurch, New Zealand
ABSTRACTS DUE: 16 March 2007 (250-300 words)
TO SUBMIT ABSTRACTS:  http://modsimwcmt.lincoln.ac.nz/


MODSIM07 is the 17th in a series of congresses organised by the
Modelling and Simulation Society of Australia and New Zealand. The
congress theme has been selected to reinforce the importance of
modelling and simulation developments for environmental management and
sustainability.


The congress provides a forum for the presentation and exploration of a
broad range of modelling and simulation science, and papers are invited
in all areas of modelling and simulation. Check
http://modsim.lincoln.ac.nz  \ Proposed Sessions for the 60 session
topics at MODSIM07.

The proposed sessions include: Statistical Methods for Analysis of
Public Health Data, GIS and Environmental Modelling, Graph theory based
statistical modelling


KEYNOTE SPEAKERS:

* 	Dr. Brent Clothier
  	HortResearch, New Zealand.

*	Prof. Peter M. Robinson
London School of Economics, United Kingdom.

*	Dr. Randy Butler
National Centre for Supercomputing Applications (NCSA)
University of Illinois at Urbana-Champaign, USA.

*	Professor Fernando Trevino
Dean, The School of Public Health
University of North Texas Health Science Centre, Fort Worth, Texas, USA.


-- 
Prof. Ari Jolma
Geoinformaatio- ja paikannustekniikka / Geoinformation and positioning
Teknillinen Korkeakoulu / Helsinki University of Technology
tel: +358 9 451 3886 address: POBox 1200, 02015 TKK, Finland
Email: ari.jolma at tkk.fi URL: http://www.tkk.fi/~jolma



From tkobayas at indiana.edu  Thu Mar  1 21:37:17 2007
From: tkobayas at indiana.edu (Takatsugu Kobayashi)
Date: Thu, 01 Mar 2007 15:37:17 -0500
Subject: [R-sig-Geo] Question about dnearneigh
Message-ID: <45E7397D.6020505@indiana.edu>

Hi,

I have been doing exploratory analysis of the link between global 
Moran's I coefficients and directional biases of frequencies.

I created a 10*10 matrix that contains random numbers using 
randomNumbers(). This went well till I had to define a list of nearest 
neighbor of each cell. I defined the nearest neighbors as cells that 
fall within 3 unit distance of each cell. But the images and Moran's I 
appear to be strange, meaning that the images look like random patterns 
while the corresponding Moran's I indicate high autocorrelation. I 
appreciate if someone could point out what I did wrong. Here is the 
commands I typed:

rm(list=ls(all=T))

# Directional bias calculation
library(random)
library(spdep)

# Random process
# 10*10 case

# Show n cases of lattice data that contains random numbers using 
randomNumbers()
cases<-2
pts<-seq(1,10,by=1)
x<-rep(pts,each=length(pts))
y<-rep(pts,times=length(pts))
z<-randomNumbers(length(pts)^2*cases,0,100,cases)
D<-cbind(x,y,z)
topo<-rep(list(matrix(,length(pts),length(pts))),cases)

# Reshaping a vector into n matrices
for (m in 1:cases){topo[[m]]<-matrix(D[,m+2],length(pts),length(pts))}

dis<-as.matrix(dist(cbind(x,y),diag=T,upper=T,p=2))
coords<-cbind(x,y)

# Distance-based nearest neighbors list
dnb <- dnearneigh(coords, 0, 3)

par(mfcol=c(1,2))
for (p in 1:cases){
test<-moran.test(D[,p], nb2listw(dnb,style="W"))
image(pts,pts,topo[[p]],col=grey(50:1/50),xlab="Easting",ylab="Northing")
title(main=paste("Moran's I =",round(test$estimate[1],4)))
}



From dagmar.mueller at gkss.de  Fri Mar  2 10:39:15 2007
From: dagmar.mueller at gkss.de (dagmar.mueller at gkss.de)
Date: Fri, 02 Mar 2007 10:39:15 +0100
Subject: [R-sig-Geo] krige error message: dimensions do not match
Message-ID: <OF4A4925C3.FB503090-ONC1257292.0032D7B5-C1257292.0034F641@dvsun2.gkss.de>

Hello, 

I think my question might be related to  karl.sommer's  ( error message 
rgdal: dimensions do not match, Date: Wed, 5 Jul 2006). 
Have you found out, why the error message 'dimensions do not match ...' 
occured? 

I'm trying to write a simple cross validation function, which combines the 
functionality of xvalid (geoR) to use a subset of data for cross 
validation with the possibility of nested variogram models from vgm 
(gstat). 

If I check for dimensions of the data.frames data.out and cv.dat, they 
have exactly the expected dimensions. Nevertheless krige() returns the 
error "Fehler: dimensions do not match: locations 373628 and data 163419". 

dim(dat): 186815    4
dim(cv.dat): 186814    4
dim(data.out): 1    4

There are no 'NA's or 'NaN's in the data.frame. 
Does anyone know, why the error occurs? I'm completly at a loss.. 

Yours sincerely, 
Dagmar Mueller 


This is the code (modified xvalid()-code): 
--------------------------------
MyCV<-function (dat , model,locations.xvalid = "all",krig.nmax=100) {
   #some code...
    if (crossvalid) {
        cv.f <- function(ndata, ...) {
            data.out <- dat[ndata, ]
            cv.dat <- dat[-ndata, ]
        kr<-krige(res~1,loc=~Lon+Lat,data=cv.dat, newdata=data.out[,1:2], 
model=model, nmax=krig.nmax)
 
            res <- c(data.out, kr$var1.pred, kr$var1.var)
            return(res)
        }
        res <- as.data.frame(t(apply(matrix(locations.xvalid), 1, cv.f)))
 
    }
 
#some code...
 
    return(res)
}



From dray at biomserv.univ-lyon1.fr  Fri Mar  2 11:24:18 2007
From: dray at biomserv.univ-lyon1.fr (=?ISO-8859-1?Q?St=E9phane_Dray?=)
Date: Fri, 02 Mar 2007 11:24:18 +0100
Subject: [R-sig-Geo] subselection of Polygons
Message-ID: <45E7FB52.4080105@biomserv.univ-lyon1.fr>

Hello list,

I have a question concerning the [ operator for SPDF. Consider the 
following example :

library(maptools)
xx <- readShapePoly(system.file("shapes/sids.shp", package="maptools")[1], IDvar="FIPSNO", proj4string=CRS("+proj=longlat +ellps=clrk66"))
plot(xx, border="blue", axes=TRUE, las=1)
text(getSpPPolygonsLabptSlots(xx), labels=getSpPPolygonsIDSlots(xx), cex=0.6)
as(xx, "data.frame")[1:5, 1:6]
xxx <- xx[xx$SID74 < 2,]

The last line is equivalent to :

xxx <- xx[which(xx$SID74 < 2),]

I supposed that I can easily have the inverse selection by using '-' but 
it does not work :

xxx <- xx[which(xx$SID74 < 2),]

returns the following error message :

Erreur dans validObject(.Object) : invalid class "SpatialPolygons" 
object: length mismatch

I do not understand what is the problem (sp 0.9-8, R 2.4.0).

Thanks,

-- 
St?phane DRAY (dray at biomserv.univ-lyon1.fr )
Laboratoire BBE-CNRS-UMR-5558, Univ. C. Bernard - Lyon I
43, Bd du 11 Novembre 1918, 69622 Villeurbanne Cedex, France
Tel: 33 4 72 43 27 57       Fax: 33 4 72 43 13 88
http://biomserv.univ-lyon1.fr/~dray/



From dray at biomserv.univ-lyon1.fr  Fri Mar  2 11:25:56 2007
From: dray at biomserv.univ-lyon1.fr (=?ISO-8859-1?Q?St=E9phane_Dray?=)
Date: Fri, 02 Mar 2007 11:25:56 +0100
Subject: [R-sig-Geo] subselection of Polygons
In-Reply-To: <45E7FB52.4080105@biomserv.univ-lyon1.fr>
References: <45E7FB52.4080105@biomserv.univ-lyon1.fr>
Message-ID: <45E7FBB4.3000401@biomserv.univ-lyon1.fr>

Sorry,
the line which does not work is :

xxx <- xx[-which(xx$SID74 < 2),]



St?phane Dray wrote:
> Hello list,
>
> I have a question concerning the [ operator for SPDF. Consider the 
> following example :
>
> library(maptools)
> xx <- readShapePoly(system.file("shapes/sids.shp", package="maptools")[1], IDvar="FIPSNO", proj4string=CRS("+proj=longlat +ellps=clrk66"))
> plot(xx, border="blue", axes=TRUE, las=1)
> text(getSpPPolygonsLabptSlots(xx), labels=getSpPPolygonsIDSlots(xx), cex=0.6)
> as(xx, "data.frame")[1:5, 1:6]
> xxx <- xx[xx$SID74 < 2,]
>
> The last line is equivalent to :
>
> xxx <- xx[which(xx$SID74 < 2),]
>
> I supposed that I can easily have the inverse selection by using '-' but 
> it does not work :
>
> xxx <- xx[which(xx$SID74 < 2),]
>
> returns the following error message :
>
> Erreur dans validObject(.Object) : invalid class "SpatialPolygons" 
> object: length mismatch
>
> I do not understand what is the problem (sp 0.9-8, R 2.4.0).
>
> Thanks,
>
>   


-- 
St?phane DRAY (dray at biomserv.univ-lyon1.fr )
Laboratoire BBE-CNRS-UMR-5558, Univ. C. Bernard - Lyon I
43, Bd du 11 Novembre 1918, 69622 Villeurbanne Cedex, France
Tel: 33 4 72 43 27 57       Fax: 33 4 72 43 13 88
http://biomserv.univ-lyon1.fr/~dray/



From Roger.Bivand at nhh.no  Fri Mar  2 11:38:38 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 2 Mar 2007 11:38:38 +0100 (CET)
Subject: [R-sig-Geo] subselection of Polygons
In-Reply-To: <45E7FBB4.3000401@biomserv.univ-lyon1.fr>
Message-ID: <Pine.LNX.4.44.0703021129240.17215-100000@reclus.nhh.no>

On Fri, 2 Mar 2007, St?phane Dray wrote:

> Sorry,
> the line which does not work is :
> 
> xxx <- xx[-which(xx$SID74 < 2),]
> 

Correct. The workaround is to take the complement. Getting negative 
indices to work is on the TODO list, it is a problem in the "[" method.

xxx <- xx[!(seq(along=slot(xx, "polygons")) %in% which(xx$SID74 < 2)),]

works.

Roger

> 
> 
> St?phane Dray wrote:
> > Hello list,
> >
> > I have a question concerning the [ operator for SPDF. Consider the 
> > following example :
> >
> > library(maptools)
> > xx <- readShapePoly(system.file("shapes/sids.shp", package="maptools")[1], IDvar="FIPSNO", proj4string=CRS("+proj=longlat +ellps=clrk66"))
> > plot(xx, border="blue", axes=TRUE, las=1)
> > text(getSpPPolygonsLabptSlots(xx), labels=getSpPPolygonsIDSlots(xx), cex=0.6)
> > as(xx, "data.frame")[1:5, 1:6]
> > xxx <- xx[xx$SID74 < 2,]
> >
> > The last line is equivalent to :
> >
> > xxx <- xx[which(xx$SID74 < 2),]
> >
> > I supposed that I can easily have the inverse selection by using '-' but 
> > it does not work :
> >
> > xxx <- xx[which(xx$SID74 < 2),]
> >
> > returns the following error message :
> >
> > Erreur dans validObject(.Object) : invalid class "SpatialPolygons" 
> > object: length mismatch
> >
> > I do not understand what is the problem (sp 0.9-8, R 2.4.0).
> >
> > Thanks,
> >
> >   
> 
> 
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From Roger.Bivand at nhh.no  Fri Mar  2 11:53:01 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 2 Mar 2007 11:53:01 +0100 (CET)
Subject: [R-sig-Geo] Question about dnearneigh
In-Reply-To: <45E7397D.6020505@indiana.edu>
Message-ID: <Pine.LNX.4.44.0703021148400.17215-100000@reclus.nhh.no>

On Thu, 1 Mar 2007, Takatsugu Kobayashi wrote:

> Hi,
> 
> I have been doing exploratory analysis of the link between global 
> Moran's I coefficients and directional biases of frequencies.
> 
> I created a 10*10 matrix that contains random numbers using 
> randomNumbers(). This went well till I had to define a list of nearest 
> neighbor of each cell. I defined the nearest neighbors as cells that 
> fall within 3 unit distance of each cell. But the images and Moran's I 
> appear to be strange, meaning that the images look like random patterns 
> while the corresponding Moran's I indicate high autocorrelation. I 
> appreciate if someone could point out what I did wrong. Here is the 
> commands I typed:

Hi,

Thanks for a very clear and well documented question. I think that your
reasoning is OK, apart from this line:

> test<-moran.test(D[,p], nb2listw(dnb,style="W"))

which is doing the Moran's I test on the cell coordinate rather than the 
random variate. With:

test<-moran.test(D[,cases+p], nb2listw(dnb,style="W"))

it seems to be as expected.

Hope this helps,

Roger

> 
> rm(list=ls(all=T))
> 
> # Directional bias calculation
> library(random)
> library(spdep)
> 
> # Random process
> # 10*10 case
> 
> # Show n cases of lattice data that contains random numbers using 
> randomNumbers()
> cases<-2
> pts<-seq(1,10,by=1)
> x<-rep(pts,each=length(pts))
> y<-rep(pts,times=length(pts))
> z<-randomNumbers(length(pts)^2*cases,0,100,cases)
> D<-cbind(x,y,z)
> topo<-rep(list(matrix(,length(pts),length(pts))),cases)
> 
> # Reshaping a vector into n matrices
> for (m in 1:cases){topo[[m]]<-matrix(D[,m+2],length(pts),length(pts))}
> 
> dis<-as.matrix(dist(cbind(x,y),diag=T,upper=T,p=2))
> coords<-cbind(x,y)
> 
> # Distance-based nearest neighbors list
> dnb <- dnearneigh(coords, 0, 3)
> 
> par(mfcol=c(1,2))
> for (p in 1:cases){
> test<-moran.test(D[,p], nb2listw(dnb,style="W"))
> image(pts,pts,topo[[p]],col=grey(50:1/50),xlab="Easting",ylab="Northing")
> title(main=paste("Moran's I =",round(test$estimate[1],4)))
> }
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From tkeitt at gmail.com  Sat Mar  3 04:52:01 2007
From: tkeitt at gmail.com (Tim Keitt)
Date: Fri, 2 Mar 2007 21:52:01 -0600
Subject: [R-sig-Geo] Build hexagonal lattice coverage
Message-ID: <6262c54c0703021952u35890446m3c0f1eb9a9b85a25@mail.gmail.com>

Hi All,

I'd like to make a hexagonal lattice (stored in a shapefile, ogr
coverage or postgis geometry). Is the general approach to make a
series of independent hexagons and place them in the plane such that
adjacent edges sit directly on top of each other? Or can one build a
mesh out of connected line segments? If it is the latter, how does one
associate a data value with each hexagon in the mesh? I'd like to
achieve something like the output of the hexbin package, but display
the result in ArcGIS or QGIS.

THK

-- 
Timothy H. Keitt, University of Texas at Austin
Contact info and schedule at http://www.keittlab.org/tkeitt/
Reprints at http://www.keittlab.org/tkeitt/papers/
ODF attachment? See http://www.openoffice.org/



From Roger.Bivand at nhh.no  Sat Mar  3 12:22:22 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sat, 3 Mar 2007 12:22:22 +0100 (CET)
Subject: [R-sig-Geo] Build hexagonal lattice coverage
In-Reply-To: <6262c54c0703021952u35890446m3c0f1eb9a9b85a25@mail.gmail.com>
Message-ID: <Pine.LNX.4.44.0703031159390.17908-100000@reclus.nhh.no>

On Fri, 2 Mar 2007, Tim Keitt wrote:

> Hi All,
> 
> I'd like to make a hexagonal lattice (stored in a shapefile, ogr
> coverage or postgis geometry). Is the general approach to make a
> series of independent hexagons and place them in the plane such that
> adjacent edges sit directly on top of each other? Or can one build a
> mesh out of connected line segments? If it is the latter, how does one
> associate a data value with each hexagon in the mesh? I'd like to
> achieve something like the output of the hexbin package, but display
> the result in ArcGIS or QGIS.

This is a bit "cheap", but might help (for points on equilateral 
triangles of side equal to 1):

library(deldir)
x1 <- seq(1,10,1)
x2 <- x1 + 0.5
step <- cos(30*(pi/180))
y1 <- seq(1, 10, step*2)
y2 <- seq(1+step, 10, step*2)
xy1 <- expand.grid(x1, y1)
xy2 <- expand.grid(x2, y2)
crds <- as.matrix(rbind(xy1, xy2))
z <- deldir(crds[,1], crds[,2])
w <- tile.list(z)
polys <- vector(mode="list", length=length(w))
library(sp)
for (i in seq(along=polys)) {
  pcrds <- cbind(w[[i]]$x, w[[i]]$y)
  pcrds <- rbind(pcrds, pcrds[1,])
  polys[[i]] <- Polygons(list(Polygon(pcrds)), ID=as.character(i))
}
SP <- SpatialPolygons(polys)
SPDF <- SpatialPolygonsDataFrame(SP, data=data.frame(x=crds[,1], 
  y=crds[,2], row.names=sapply(slot(SP, "polygons"),
  function(x) slot(x, "ID"))))
Areas <- sapply(slot(SP, "polygons"), function(x) slot(x, "area"))
print(fivenum(Areas), digits=8)
print(sort(Areas), digits=8)
SPDF1 <- SPDF[Areas < 0.866027,]
plot(SPDF1, axes=TRUE, xlim=c(1,10), ylim=c(1,10))
points(crds)
library(maptools)
writePolyShape(SPDF1, "hex")
# or writeOGR() to other formats.

The areas are not exactly equal, varying in the sixth digit after the 
decimal point by about 1. But having deldir build the tesselation saves 
the mess of doing it directly, and the hex grid of points is easier to 
build. The default bounding box of tile.list() seems to be OK.

The external points do not get hexagons, so the initial setup will need to 
take this into account, by adding external buffer points.

Using tile.list() from deldir seems easier than alternatives from tripack, 
the original tesselation question about using it came from Simon Goring, 
who had done most of the work apart from building the Polygons objects.

Hope this helps,

Roger

> 
> THK
> 
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From e.pebesma at geo.uu.nl  Sat Mar  3 21:02:03 2007
From: e.pebesma at geo.uu.nl (Edzer J. Pebesma)
Date: Sat, 03 Mar 2007 21:02:03 +0100
Subject: [R-sig-Geo] krige error message: dimensions do not match
In-Reply-To: <OF4A4925C3.FB503090-ONC1257292.0032D7B5-C1257292.0034F641@dvsun2.gkss.de>
References: <OF4A4925C3.FB503090-ONC1257292.0032D7B5-C1257292.0034F641@dvsun2.gkss.de>
Message-ID: <45E9D43B.2030800@geo.uu.nl>

Dagmar,

this is hard to tell from here without having something that I can 
reproduce; my first suggestion would be NA's in the values or 
coordinates, but you say it is not. Also hard to read your code: is 
crossvalid a global logical? How can you pass the character vector 
location.xvalid to the function matrix(), the to apply and interpret it 
as indexes? But perhaps I missed it.

Have you looked at gstat.cv and krige.cv in package gstat to do cross 
validation?
--
Edzer

dagmar.mueller at gkss.de wrote:
> Hello, 
>
> I think my question might be related to  karl.sommer's  ( error message 
> rgdal: dimensions do not match, Date: Wed, 5 Jul 2006). 
> Have you found out, why the error message 'dimensions do not match ...' 
> occured? 
>
> I'm trying to write a simple cross validation function, which combines the 
> functionality of xvalid (geoR) to use a subset of data for cross 
> validation with the possibility of nested variogram models from vgm 
> (gstat). 
>
> If I check for dimensions of the data.frames data.out and cv.dat, they 
> have exactly the expected dimensions. Nevertheless krige() returns the 
> error "Fehler: dimensions do not match: locations 373628 and data 163419". 
>
> dim(dat): 186815    4
> dim(cv.dat): 186814    4
> dim(data.out): 1    4
>
> There are no 'NA's or 'NaN's in the data.frame. 
> Does anyone know, why the error occurs? I'm completly at a loss.. 
>
> Yours sincerely, 
> Dagmar Mueller 
>
>
> This is the code (modified xvalid()-code): 
> --------------------------------
> MyCV<-function (dat , model,locations.xvalid = "all",krig.nmax=100) {
>    #some code...
>     if (crossvalid) {
>         cv.f <- function(ndata, ...) {
>             data.out <- dat[ndata, ]
>             cv.dat <- dat[-ndata, ]
>         kr<-krige(res~1,loc=~Lon+Lat,data=cv.dat, newdata=data.out[,1:2], 
> model=model, nmax=krig.nmax)
>  
>             res <- c(data.out, kr$var1.pred, kr$var1.var)
>             return(res)
>         }
>         res <- as.data.frame(t(apply(matrix(locations.xvalid), 1, cv.f)))
>  
>     }
>  
> #some code...
>  
>     return(res)
> }
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>



From tkeitt at gmail.com  Sat Mar  3 23:26:18 2007
From: tkeitt at gmail.com (Tim Keitt)
Date: Sat, 3 Mar 2007 16:26:18 -0600
Subject: [R-sig-Geo] Build hexagonal lattice coverage
In-Reply-To: <Pine.LNX.4.44.0703031159390.17908-100000@reclus.nhh.no>
References: <6262c54c0703021952u35890446m3c0f1eb9a9b85a25@mail.gmail.com>
	<Pine.LNX.4.44.0703031159390.17908-100000@reclus.nhh.no>
Message-ID: <6262c54c0703031426p5df9a46bp2324ca604463935c@mail.gmail.com>

Thanks Roger!

I went ahead and wrote a couple of functions:

genHexGrid <- function(dx, ll = c(0, 0), ur = c(1, 1))
{
        dy <- sqrt(3) * dx / 2

        x <- seq(ll[1], ur[1] - dx / 2, dx)
        y <- seq(ll[2], ur[2], dy)

        y <- rep(y, each = length(x))
        x <- rep(c(x, x + dx / 2), length.out = length(y))

        x <- x + (ur[1] - max(x)) / 2
        y <- y + (ur[2] - max(y)) / 2

        list(x = x, y = y)
}

genPolyList <- function(hexGrid)
{
        dx <- hexGrid$x[2] - hexGrid$x[1]
        dy <- dx / sqrt(3)

        x.offset <- c(-dx / 2, 0, dx / 2, dx / 2, 0, -dx / 2)
        y.offset <- c(dy / 2, dy, dy / 2, -dy / 2, -dy, -dy / 2)

        f <- function(i) list(x = hexGrid$x[i] + x.offset,
                              y = hexGrid$y[i] + y.offset)

        lapply(1:length(hexGrid$x), f)
}

xy <- genHexGrid(0.05)
plot(xy, asp = 1, axes = F, pch = 19, xlab = NA, ylab = NA, cex = 0.5)
lapply(genPolyList(xy), polygon, xpd = NA, ypd = NA)

Now to figure out the sp stuff.

Cheers,
Tim

On 3/3/07, Roger Bivand <Roger.Bivand at nhh.no> wrote:
> On Fri, 2 Mar 2007, Tim Keitt wrote:
>
> > Hi All,
> >
> > I'd like to make a hexagonal lattice (stored in a shapefile, ogr
> > coverage or postgis geometry). Is the general approach to make a
> > series of independent hexagons and place them in the plane such that
> > adjacent edges sit directly on top of each other? Or can one build a
> > mesh out of connected line segments? If it is the latter, how does one
> > associate a data value with each hexagon in the mesh? I'd like to
> > achieve something like the output of the hexbin package, but display
> > the result in ArcGIS or QGIS.
>
> This is a bit "cheap", but might help (for points on equilateral
> triangles of side equal to 1):
>
> library(deldir)
> x1 <- seq(1,10,1)
> x2 <- x1 + 0.5
> step <- cos(30*(pi/180))
> y1 <- seq(1, 10, step*2)
> y2 <- seq(1+step, 10, step*2)
> xy1 <- expand.grid(x1, y1)
> xy2 <- expand.grid(x2, y2)
> crds <- as.matrix(rbind(xy1, xy2))
> z <- deldir(crds[,1], crds[,2])
> w <- tile.list(z)
> polys <- vector(mode="list", length=length(w))
> library(sp)
> for (i in seq(along=polys)) {
>   pcrds <- cbind(w[[i]]$x, w[[i]]$y)
>   pcrds <- rbind(pcrds, pcrds[1,])
>   polys[[i]] <- Polygons(list(Polygon(pcrds)), ID=as.character(i))
> }
> SP <- SpatialPolygons(polys)
> SPDF <- SpatialPolygonsDataFrame(SP, data=data.frame(x=crds[,1],
>   y=crds[,2], row.names=sapply(slot(SP, "polygons"),
>   function(x) slot(x, "ID"))))
> Areas <- sapply(slot(SP, "polygons"), function(x) slot(x, "area"))
> print(fivenum(Areas), digits=8)
> print(sort(Areas), digits=8)
> SPDF1 <- SPDF[Areas < 0.866027,]
> plot(SPDF1, axes=TRUE, xlim=c(1,10), ylim=c(1,10))
> points(crds)
> library(maptools)
> writePolyShape(SPDF1, "hex")
> # or writeOGR() to other formats.
>
> The areas are not exactly equal, varying in the sixth digit after the
> decimal point by about 1. But having deldir build the tesselation saves
> the mess of doing it directly, and the hex grid of points is easier to
> build. The default bounding box of tile.list() seems to be OK.
>
> The external points do not get hexagons, so the initial setup will need to
> take this into account, by adding external buffer points.
>
> Using tile.list() from deldir seems easier than alternatives from tripack,
> the original tesselation question about using it came from Simon Goring,
> who had done most of the work apart from building the Polygons objects.
>
> Hope this helps,
>
> Roger
>
> >
> > THK
> >
> >
>
> --
> Roger Bivand
> Economic Geography Section, Department of Economics, Norwegian School of
> Economics and Business Administration, Helleveien 30, N-5045 Bergen,
> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no
>
>
>


-- 
Timothy H. Keitt, University of Texas at Austin
Contact info and schedule at http://www.keittlab.org/tkeitt/
Reprints at http://www.keittlab.org/tkeitt/papers/
ODF attachment? See http://www.openoffice.org/



From nikko at hailmail.net  Sun Mar  4 03:13:43 2007
From: nikko at hailmail.net (Nicholas Lewin-Koh)
Date: Sat, 03 Mar 2007 21:13:43 -0500
Subject: [R-sig-Geo] Build hexagonal lattice coverage
In-Reply-To: <mailman.9.1172919610.16782.r-sig-geo@stat.math.ethz.ch>
References: <mailman.9.1172919610.16782.r-sig-geo@stat.math.ethz.ch>
Message-ID: <1172974423.7745.1177582881@webmail.messagingengine.com>


Hi Tim,
If you look in the hexbin code (eeek) you will realize that hexbin just
creates 
a regular latttice of points, and the hexagons are implicit. Actually
the storage is even more compact, the hexagons are integers and
everything
is derived from the limits. The algorithm is explained in the vignette. 
For a regular lattice the topology is very simple, so I don't think it
is really worth storing anything but the hexagon centers.

If you are doing grid like operations on hexagonal lattices, as long
as the lattices are the same, you still don't need the topology. You
could
even store two offset square grids and get the hexagons, provided your
lattice 
is not rotated. You can also look at the package diamonds, Dennis White
may have something
to add, if he is lurking around on the list.

Nicholas


------------------------------------------------------------
> 
> Message: 1
> Date: Fri, 2 Mar 2007 21:52:01 -0600
> From: "Tim Keitt" <tkeitt at gmail.com>
> Subject: [R-sig-Geo] Build hexagonal lattice coverage
> To: r-sig-geo at stat.math.ethz.ch
> Message-ID:
> 	<6262c54c0703021952u35890446m3c0f1eb9a9b85a25 at mail.gmail.com>
> Content-Type: text/plain; charset=ISO-8859-1; format=flowed
> 
> Hi All,
> 
> I'd like to make a hexagonal lattice (stored in a shapefile, ogr
> coverage or postgis geometry). Is the general approach to make a
> series of independent hexagons and place them in the plane such that
> adjacent edges sit directly on top of each other? Or can one build a
> mesh out of connected line segments? If it is the latter, how does one
> associate a data value with each hexagon in the mesh? I'd like to
> achieve something like the output of the hexbin package, but display
> the result in ArcGIS or QGIS.
> 
> THK
> 
> -- 
> Timothy H. Keitt, University of Texas at Austin
> Contact info and schedule at http://www.keittlab.org/tkeitt/
> Reprints at http://www.keittlab.org/tkeitt/papers/
> ODF attachment? See http://www.openoffice.org/
> 
> 
> 
> ------------------------------
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 
> 
> End of R-sig-Geo Digest, Vol 43, Issue 3
> ****************************************



From tkobayas at indiana.edu  Sun Mar  4 19:41:54 2007
From: tkobayas at indiana.edu (Takatsugu Kobayashi)
Date: Sun, 04 Mar 2007 13:41:54 -0500
Subject: [R-sig-Geo] How can I view a list of neighbors from the outcome
	knn2nb
Message-ID: <45EB12F2.8010002@indiana.edu>

Hi

I am trying to create a list of nearest neighbors using knearneigh and 
dinearneigh. To understand these I have been coding what these functions do:

For example, for dnearneigh, suppose I have x-y coordinates and the 
corresponding z values

# calculate distances between observations
data<-cbind(x,y,z)
coords<-cbind(x,y)
dis<-as.matrix(dist(coords,diag=T,upper=T))

# Create distance threshold =2
thrs<-2

nb<-list(vector("numeric",length(z)))

for (j in 1:nrow(data)){
    nb[[j]]<-as.vector(which(dis[j,]<=thrs))
}

nb

Then I can use this nb list to compute many local statistics.

For knearneigh, I can sort the distance matrix in ascending order and 
take the first n numbers as nearest neighbors. Then, how can I take a 
look at a list of neighbors when I use knearneigh?  unlist(nb,coords) 
just breaks the [[ ]] structure...

Thank for help in advance.

Taka



From tkobayas at indiana.edu  Mon Mar  5 05:15:31 2007
From: tkobayas at indiana.edu (Takatsugu Kobayashi)
Date: Sun, 04 Mar 2007 23:15:31 -0500
Subject: [R-sig-Geo] Directional statistics and weighted mean directions
Message-ID: <45EB9963.6060201@indiana.edu>

R users:

This is more of a general question.

I am trying to conduct hypothesis testing about the difference of two 
angles extending from the same point. I am reading directional 
statistics by Mardia, but it seems to talk about only frequency 
distribution on the circumference drawn by the unit length vector. My 
problem involves the weighted mean direction. Weighted by which I mean 
is that the unit vectors are weighted by the frequencies attached to the 
census zones. Have anyone known good textbooks and R packages to do 
directional statistics?

Thank you very much

Taka



From epistat at gmail.com  Mon Mar  5 08:44:04 2007
From: epistat at gmail.com (zhijie zhang)
Date: Mon, 5 Mar 2007 15:44:04 +0800
Subject: [R-sig-Geo] Can anybody show me a complete example to use
	km.rs(spatstat) function to do survival analysis?
Message-ID: <2fc17e30703042344g1b04e077x2eefac136deabaf2@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20070305/323790e0/attachment.pl>

From Greg.Snow at intermountainmail.org  Mon Mar  5 17:28:15 2007
From: Greg.Snow at intermountainmail.org (Greg Snow)
Date: Mon, 5 Mar 2007 09:28:15 -0700
Subject: [R-sig-Geo] Directional statistics and weighted mean directions
In-Reply-To: <45EB9963.6060201@indiana.edu>
Message-ID: <07E228A5BE53C24CAD490193A7381BBB879982@LP-EXCHVS07.CO.IHC.COM>

Packages CircStats and circular may help.

-- 
Gregory (Greg) L. Snow Ph.D.
Statistical Data Center
Intermountain Healthcare
greg.snow at intermountainmail.org
(801) 408-8111
 
 

> -----Original Message-----
> From: r-sig-geo-bounces at stat.math.ethz.ch 
> [mailto:r-sig-geo-bounces at stat.math.ethz.ch] On Behalf Of 
> Takatsugu Kobayashi
> Sent: Sunday, March 04, 2007 9:16 PM
> To: r-sig-geo at stat.math.ethz.ch
> Subject: Re: [R-sig-Geo] Directional statistics and weighted 
> mean directions
> 
> R users:
> 
> This is more of a general question.
> 
> I am trying to conduct hypothesis testing about the 
> difference of two angles extending from the same point. I am 
> reading directional statistics by Mardia, but it seems to 
> talk about only frequency distribution on the circumference 
> drawn by the unit length vector. My problem involves the 
> weighted mean direction. Weighted by which I mean is that the 
> unit vectors are weighted by the frequencies attached to the 
> census zones. Have anyone known good textbooks and R packages 
> to do directional statistics?
> 
> Thank you very much
> 
> Taka
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>



From ggrothendieck at gmail.com  Tue Mar  6 12:09:54 2007
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Tue, 6 Mar 2007 06:09:54 -0500
Subject: [R-sig-Geo] LL to UTM
Message-ID: <971536df0703060309k32ae40b8jab2e651c011a4ee7@mail.gmail.com>

I am currently using this web page to convert LL to UTM (and UTM to LL).

   http://home.hiwaay.net/~taylorc/toolbox/geography/geoutm.html

All my points are in zone 18.  How would I accomplish the same
thing using R?

Thanks.



From Thomas.Adams at noaa.gov  Tue Mar  6 13:36:29 2007
From: Thomas.Adams at noaa.gov (Thomas Adams)
Date: Tue, 06 Mar 2007 07:36:29 -0500
Subject: [R-sig-Geo] LL to UTM
In-Reply-To: <971536df0703060309k32ae40b8jab2e651c011a4ee7@mail.gmail.com>
References: <971536df0703060309k32ae40b8jab2e651c011a4ee7@mail.gmail.com>
Message-ID: <45ED604D.70105@noaa.gov>

Gabor,

You *may* be able to accomplish this using R easily (I'm sure it's 
doable), but I'm do not know how to do the conversion. I would suggest 
as an alternative to do your work using GRASS GIS 
(http://grass.itc.it/). R interfaces very well with GRASS and making 
your LL to UTM conversion (and back) would be trivial using GRASS. You 
can also use R within a GRASS session interactively or 
non-interactively, embedded within a script.

I hope this is helpful to you.

Regards,
Tom


Gabor Grothendieck wrote:
> I am currently using this web page to convert LL to UTM (and UTM to LL).
>
>    http://home.hiwaay.net/~taylorc/toolbox/geography/geoutm.html
>
> All my points are in zone 18.  How would I accomplish the same
> thing using R?
>
> Thanks.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>   


-- 
Thomas E Adams
National Weather Service
Ohio River Forecast Center
1901 South State Route 134
Wilmington, OH 45177

EMAIL:	thomas.adams at noaa.gov

VOICE:	937-383-0528
FAX:	937-383-0033



From e.pebesma at geo.uu.nl  Tue Mar  6 13:42:53 2007
From: e.pebesma at geo.uu.nl (Edzer J. Pebesma)
Date: Tue, 06 Mar 2007 13:42:53 +0100
Subject: [R-sig-Geo] LL to UTM
In-Reply-To: <971536df0703060309k32ae40b8jab2e651c011a4ee7@mail.gmail.com>
References: <971536df0703060309k32ae40b8jab2e651c011a4ee7@mail.gmail.com>
Message-ID: <45ED61CD.4030307@geo.uu.nl>

Gabor,

package rgdal provides an interface to the PROJ.4 library for projection 
of geographical data. Look for the function (or rather method) 
spTransform. It takes any of the spatial classes provided by package sp, 
and afaik any of the known projection systems, including UTM and 
ellipsoids (LL reference "model").
--
Edzer

Gabor Grothendieck wrote:
> I am currently using this web page to convert LL to UTM (and UTM to LL).
>
>    http://home.hiwaay.net/~taylorc/toolbox/geography/geoutm.html
>
> All my points are in zone 18.  How would I accomplish the same
> thing using R?
>
> Thanks.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>



From ggrothendieck at gmail.com  Tue Mar  6 13:50:18 2007
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Tue, 6 Mar 2007 07:50:18 -0500
Subject: [R-sig-Geo] LL to UTM
In-Reply-To: <45ED61CD.4030307@geo.uu.nl>
References: <971536df0703060309k32ae40b8jab2e651c011a4ee7@mail.gmail.com>
	<45ED61CD.4030307@geo.uu.nl>
Message-ID: <971536df0703060450g5d548bd2g85812e6bae0cb14e@mail.gmail.com>

Thanks. I looked at spTransform prior to posting but don't understand it.
What I want is to create a function that returns UTM coordinates:

LL2UTM <- function(lat, long, zone = 18) {
...
}

If necessary, zone=18 can be hardcoded in the function and that
arg removed.

I assume that using spTransform its just a one line body. Can
you give me the specific line that it should be?

Thanks.


On 3/6/07, Edzer J. Pebesma <e.pebesma at geo.uu.nl> wrote:
> Gabor,
>
> package rgdal provides an interface to the PROJ.4 library for projection
> of geographical data. Look for the function (or rather method)
> spTransform. It takes any of the spatial classes provided by package sp,
> and afaik any of the known projection systems, including UTM and
> ellipsoids (LL reference "model").
> --
> Edzer
>
> Gabor Grothendieck wrote:
> > I am currently using this web page to convert LL to UTM (and UTM to LL).
> >
> >    http://home.hiwaay.net/~taylorc/toolbox/geography/geoutm.html
> >
> > All my points are in zone 18.  How would I accomplish the same
> > thing using R?
> >
> > Thanks.
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at stat.math.ethz.ch
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
>
>



From antonio.raju at gmail.com  Tue Mar  6 13:57:03 2007
From: antonio.raju at gmail.com (antonio rodriguez)
Date: Tue, 06 Mar 2007 13:57:03 +0100
Subject: [R-sig-Geo] LL to UTM
In-Reply-To: <45ED604D.70105@noaa.gov>
References: <971536df0703060309k32ae40b8jab2e651c011a4ee7@mail.gmail.com>
	<45ED604D.70105@noaa.gov>
Message-ID: <45ED651F.4040503@gmail.com>

Gabor Grothendieck wrote:
>> I am currently using this web page to convert LL to UTM (and UTM to LL).
>>
>>    http://home.hiwaay.net/~taylorc/toolbox/geography/geoutm.html
>>
>> All my points are in zone 18.  How would I accomplish the same
>> thing using R?
>>
>> Thanks.
>>     
Within GRASS there is an Addon: utm_which_zone.sh

http://grass.gdf-hannover.de/wiki/GRASS_AddOns/

which it seems to accomplish this task even from a shell, just using awk 
(I have attached the file)

BR
Antonio

-------------- next part --------------
A non-text attachment was scrubbed...
Name: utm_which_zone_sh.sh
Type: application/x-sh
Size: 1243 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20070306/a40ba910/attachment.sh>

From ggrothendieck at gmail.com  Tue Mar  6 13:55:18 2007
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Tue, 6 Mar 2007 07:55:18 -0500
Subject: [R-sig-Geo] LL to UTM
In-Reply-To: <45ED604D.70105@noaa.gov>
References: <971536df0703060309k32ae40b8jab2e651c011a4ee7@mail.gmail.com>
	<45ED604D.70105@noaa.gov>
Message-ID: <971536df0703060455i4f1c4dc5mf0bd1f1eae61e849@mail.gmail.com>

Thanks but I think it would be overkill to use a GIS simply to convert
coordinate systems of a few points. Everything else I want to do can
be done in R.

On 3/6/07, Thomas Adams <Thomas.Adams at noaa.gov> wrote:
> Gabor,
>
> You *may* be able to accomplish this using R easily (I'm sure it's
> doable), but I'm do not know how to do the conversion. I would suggest
> as an alternative to do your work using GRASS GIS
> (http://grass.itc.it/). R interfaces very well with GRASS and making
> your LL to UTM conversion (and back) would be trivial using GRASS. You
> can also use R within a GRASS session interactively or
> non-interactively, embedded within a script.
>
> I hope this is helpful to you.
>
> Regards,
> Tom
>
>
> Gabor Grothendieck wrote:
> > I am currently using this web page to convert LL to UTM (and UTM to LL).
> >
> >    http://home.hiwaay.net/~taylorc/toolbox/geography/geoutm.html
> >
> > All my points are in zone 18.  How would I accomplish the same
> > thing using R?
> >
> > Thanks.
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at stat.math.ethz.ch
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
>
>
> --
> Thomas E Adams
> National Weather Service
> Ohio River Forecast Center
> 1901 South State Route 134
> Wilmington, OH 45177
>
> EMAIL:  thomas.adams at noaa.gov
>
> VOICE:  937-383-0528
> FAX:    937-383-0033
>
>



From ggrothendieck at gmail.com  Tue Mar  6 14:06:45 2007
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Tue, 6 Mar 2007 08:06:45 -0500
Subject: [R-sig-Geo] LL to UTM
In-Reply-To: <45ED651F.4040503@gmail.com>
References: <971536df0703060309k32ae40b8jab2e651c011a4ee7@mail.gmail.com>
	<45ED604D.70105@noaa.gov> <45ED651F.4040503@gmail.com>
Message-ID: <971536df0703060506l77e1981blb0dcd1afb74c930@mail.gmail.com>

On 3/6/07, antonio rodriguez <antonio.raju at gmail.com> wrote:
> Gabor Grothendieck wrote:
> >> I am currently using this web page to convert LL to UTM (and UTM to LL).
> >>
> >>    http://home.hiwaay.net/~taylorc/toolbox/geography/geoutm.html
> >>
> >> All my points are in zone 18.  How would I accomplish the same
> >> thing using R?
> >>
> >> Thanks.
> >>
> Within GRASS there is an Addon: utm_which_zone.sh
>
> http://grass.gdf-hannover.de/wiki/GRASS_AddOns/
>
> which it seems to accomplish this task even from a shell, just using awk
> (I have attached the file)
>

Thanks but that calculates the UTM zone.  I know the UTM zone.
I want the UTM coordinates given the lat and long.



From Roger.Bivand at nhh.no  Tue Mar  6 14:28:25 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 6 Mar 2007 14:28:25 +0100 (CET)
Subject: [R-sig-Geo] LL to UTM
In-Reply-To: <971536df0703060450g5d548bd2g85812e6bae0cb14e@mail.gmail.com>
Message-ID: <Pine.LNX.4.44.0703061415030.5614-100000@reclus.nhh.no>

On Tue, 6 Mar 2007, Gabor Grothendieck wrote:

> Thanks. I looked at spTransform prior to posting but don't understand it.
> What I want is to create a function that returns UTM coordinates:
> 
> LL2UTM <- function(lat, long, zone = 18) {
> ...
> }

library(rgdal)
LL2UTM <- function(lat, long, zone=18) {
  project(cbind(long, lat), paste("+proj=utm +zone=", zone, sep=""))
}

gets you there, for example for:

lat <- seq(30,45,1)
long <- seq(-78,-72,1)
grd <- expand.grid(lat, long)
LL2UTM(grd[,1], grd[,2])

The project() interface to PROJ4 does not support datum transfromation, 
the spTransform() method does. The cost is having to convert the data to 
a Spatial* object:

SP_grd <- SpatialPoints(cbind(grd[,2], grd[,1]), 
  proj4string=CRS("+proj=longlat +datum=NAD83"))
SP_grd1 <- spTransform(SP_grd, CRS("+proj=utm +zone=18 +datum=NAD83"))

returning a SpatialPoints object - use the coordinates() method to 
retrieve as a matrix.

Assuming that your input geographical coordinates are in NAD84/WGS84, and
the output UTM coordinates are in the same datum, project() will be OK. If
you need datum transformation, which may lead to errors of hundreds of
metres if not used, the PROJ4 string needs more detail. If this is at the
block scale, datum transformation will make a difference if the input and
output specifications vary (say placing points on a UTM map not in
WGS84/NAD83). At the continental scale the differences are typically not
great, but then you wouldn't use UTM anyway.

Hope this helps,

Roger

> 
> If necessary, zone=18 can be hardcoded in the function and that
> arg removed.
> 
> I assume that using spTransform its just a one line body. Can
> you give me the specific line that it should be?
> 
> Thanks.
> 
> 
> On 3/6/07, Edzer J. Pebesma <e.pebesma at geo.uu.nl> wrote:
> > Gabor,
> >
> > package rgdal provides an interface to the PROJ.4 library for projection
> > of geographical data. Look for the function (or rather method)
> > spTransform. It takes any of the spatial classes provided by package sp,
> > and afaik any of the known projection systems, including UTM and
> > ellipsoids (LL reference "model").
> > --
> > Edzer
> >
> > Gabor Grothendieck wrote:
> > > I am currently using this web page to convert LL to UTM (and UTM to LL).
> > >
> > >    http://home.hiwaay.net/~taylorc/toolbox/geography/geoutm.html
> > >
> > > All my points are in zone 18.  How would I accomplish the same
> > > thing using R?
> > >
> > > Thanks.
> > >
> > > _______________________________________________
> > > R-sig-Geo mailing list
> > > R-sig-Geo at stat.math.ethz.ch
> > > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> > >
> >
> >
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From TShort at epri.com  Tue Mar  6 14:40:58 2007
From: TShort at epri.com (Short, Tom)
Date: Tue, 6 Mar 2007 08:40:58 -0500
Subject: [R-sig-Geo] LL to UTM
In-Reply-To: <Pine.LNX.4.44.0703061415030.5614-100000@reclus.nhh.no>
Message-ID: <1F724548E253BD49BA9BB000E9525F792855B6@usknxex01.epri.com>

Gabor, 

I've used convUL in the PBSmapping package to convert from UTM to
lat/lon for some weather data I was playing with. It will also convert
from lat/lon to UTM (I haven't tried that direction though).

Here's the code I used:

  library(PBSmapping)  
  subs = read.csv("ngrid/SubAsPoints.csv", comment="")
  names(subs) = tolower(names(subs))
  attr(subs, "zone") = 18
  attr(subs, "projection") = "UTM"
  subs$X = subs$point_x * 12 * 2.54 / 1e5 # convert to km
  subs$Y = subs$point_y * 12 * 2.54 / 1e5
  subs$sub_num = subs$sub_number
  subs = convUL(subs)

Here's the code from the help file for converting the other way:

  data(nepacLL)
  #--- set the zone attribute
  attr(nepacLL, "zone") <- 9
  #--- convert to UTM
  nepacUTM <- convUL(nepacLL)

- Tom

Tom Short
EPRI
  

> -----Original Message-----
> From: r-sig-geo-bounces at stat.math.ethz.ch 
> [mailto:r-sig-geo-bounces at stat.math.ethz.ch] On Behalf Of Roger Bivand
> Sent: Tuesday, March 06, 2007 8:28 AM
> To: Gabor Grothendieck
> Cc: r-sig-geo at stat.math.ethz.ch
> Subject: Re: [R-sig-Geo] LL to UTM
> 
> On Tue, 6 Mar 2007, Gabor Grothendieck wrote:
> 
> > Thanks. I looked at spTransform prior to posting but don't 
> understand it.
> > What I want is to create a function that returns UTM coordinates:
> > 
> > LL2UTM <- function(lat, long, zone = 18) { ...
> > }
> 
> library(rgdal)
> LL2UTM <- function(lat, long, zone=18) {
>   project(cbind(long, lat), paste("+proj=utm +zone=", zone, sep="")) }
> 
> gets you there, for example for:
> 
> lat <- seq(30,45,1)
> long <- seq(-78,-72,1)
> grd <- expand.grid(lat, long)
> LL2UTM(grd[,1], grd[,2])
> 
> The project() interface to PROJ4 does not support datum 
> transfromation, the spTransform() method does. The cost is 
> having to convert the data to a Spatial* object:
> 
> SP_grd <- SpatialPoints(cbind(grd[,2], grd[,1]),
>   proj4string=CRS("+proj=longlat +datum=NAD83"))
> SP_grd1 <- spTransform(SP_grd, CRS("+proj=utm +zone=18 +datum=NAD83"))
> 
> returning a SpatialPoints object - use the coordinates() 
> method to retrieve as a matrix.
> 
> Assuming that your input geographical coordinates are in 
> NAD84/WGS84, and the output UTM coordinates are in the same 
> datum, project() will be OK. If you need datum 
> transformation, which may lead to errors of hundreds of 
> metres if not used, the PROJ4 string needs more detail. If 
> this is at the block scale, datum transformation will make a 
> difference if the input and output specifications vary (say 
> placing points on a UTM map not in WGS84/NAD83). At the 
> continental scale the differences are typically not great, 
> but then you wouldn't use UTM anyway.
> 
> Hope this helps,
> 
> Roger
> 
> > 
> > If necessary, zone=18 can be hardcoded in the function and that arg 
> > removed.
> > 
> > I assume that using spTransform its just a one line body. 
> Can you give 
> > me the specific line that it should be?
> > 
> > Thanks.
> > 
> > 
> > On 3/6/07, Edzer J. Pebesma <e.pebesma at geo.uu.nl> wrote:
> > > Gabor,
> > >
> > > package rgdal provides an interface to the PROJ.4 library for 
> > > projection of geographical data. Look for the function (or rather 
> > > method) spTransform. It takes any of the spatial classes 
> provided by 
> > > package sp, and afaik any of the known projection 
> systems, including 
> > > UTM and ellipsoids (LL reference "model").
> > > --
> > > Edzer
> > >
> > > Gabor Grothendieck wrote:
> > > > I am currently using this web page to convert LL to UTM 
> (and UTM to LL).
> > > >
> > > >    http://home.hiwaay.net/~taylorc/toolbox/geography/geoutm.html
> > > >
> > > > All my points are in zone 18.  How would I accomplish the same 
> > > > thing using R?
> > > >
> > > > Thanks.
> > > >
> > > > _______________________________________________
> > > > R-sig-Geo mailing list
> > > > R-sig-Geo at stat.math.ethz.ch
> > > > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> > > >
> > >
> > >
> > 
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at stat.math.ethz.ch
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> > 
> 
> --
> Roger Bivand
> Economic Geography Section, Department of Economics, 
> Norwegian School of Economics and Business Administration, 
> Helleveien 30, N-5045 Bergen, Norway. voice: +47 55 95 93 55; 
> fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 



From ggrothendieck at gmail.com  Tue Mar  6 14:49:24 2007
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Tue, 6 Mar 2007 08:49:24 -0500
Subject: [R-sig-Geo] LL to UTM
In-Reply-To: <Pine.LNX.4.44.0703061415030.5614-100000@reclus.nhh.no>
References: <971536df0703060450g5d548bd2g85812e6bae0cb14e@mail.gmail.com>
	<Pine.LNX.4.44.0703061415030.5614-100000@reclus.nhh.no>
Message-ID: <971536df0703060549s452578efk134acd6a395f8b3@mail.gmail.com>

Great!  Your LL2UTM function was exactly what I wanted.

My data sets are each about a city block in size and I mostly work
in UTM on this project but I do get a few points in lat long. Its small
enough that I have been using that web site I mentioned but it gets
tedious after a while and this should be a big help.

I did notice that the R function below is consistent with the web site
output only to 5 digits after the decimal place in x and 2 digits after
the decimal place in y.  I don't know how to determine whether R or
the web site is the more accurate but at any rate either seem likely
to be well within the accuracy I need since, in truth, I don't need
high precision.

Thanks.



On 3/6/07, Roger Bivand <Roger.Bivand at nhh.no> wrote:
> On Tue, 6 Mar 2007, Gabor Grothendieck wrote:
>
> > Thanks. I looked at spTransform prior to posting but don't understand it.
> > What I want is to create a function that returns UTM coordinates:
> >
> > LL2UTM <- function(lat, long, zone = 18) {
> > ...
> > }
>
> library(rgdal)
> LL2UTM <- function(lat, long, zone=18) {
>  project(cbind(long, lat), paste("+proj=utm +zone=", zone, sep=""))
> }
>
> gets you there, for example for:
>
> lat <- seq(30,45,1)
> long <- seq(-78,-72,1)
> grd <- expand.grid(lat, long)
> LL2UTM(grd[,1], grd[,2])
>
> The project() interface to PROJ4 does not support datum transfromation,
> the spTransform() method does. The cost is having to convert the data to
> a Spatial* object:
>
> SP_grd <- SpatialPoints(cbind(grd[,2], grd[,1]),
>  proj4string=CRS("+proj=longlat +datum=NAD83"))
> SP_grd1 <- spTransform(SP_grd, CRS("+proj=utm +zone=18 +datum=NAD83"))
>
> returning a SpatialPoints object - use the coordinates() method to
> retrieve as a matrix.
>
> Assuming that your input geographical coordinates are in NAD84/WGS84, and
> the output UTM coordinates are in the same datum, project() will be OK. If
> you need datum transformation, which may lead to errors of hundreds of
> metres if not used, the PROJ4 string needs more detail. If this is at the
> block scale, datum transformation will make a difference if the input and
> output specifications vary (say placing points on a UTM map not in
> WGS84/NAD83). At the continental scale the differences are typically not
> great, but then you wouldn't use UTM anyway.
>
> Hope this helps,
>
> Roger
>
> >
> > If necessary, zone=18 can be hardcoded in the function and that
> > arg removed.
> >
> > I assume that using spTransform its just a one line body. Can
> > you give me the specific line that it should be?
> >
> > Thanks.
> >
> >
> > On 3/6/07, Edzer J. Pebesma <e.pebesma at geo.uu.nl> wrote:
> > > Gabor,
> > >
> > > package rgdal provides an interface to the PROJ.4 library for projection
> > > of geographical data. Look for the function (or rather method)
> > > spTransform. It takes any of the spatial classes provided by package sp,
> > > and afaik any of the known projection systems, including UTM and
> > > ellipsoids (LL reference "model").
> > > --
> > > Edzer
> > >
> > > Gabor Grothendieck wrote:
> > > > I am currently using this web page to convert LL to UTM (and UTM to LL).
> > > >
> > > >    http://home.hiwaay.net/~taylorc/toolbox/geography/geoutm.html
> > > >
> > > > All my points are in zone 18.  How would I accomplish the same
> > > > thing using R?
> > > >
> > > > Thanks.
> > > >
> > > > _______________________________________________
> > > > R-sig-Geo mailing list
> > > > R-sig-Geo at stat.math.ethz.ch
> > > > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> > > >
> > >
> > >
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at stat.math.ethz.ch
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
>
> --
> Roger Bivand
> Economic Geography Section, Department of Economics, Norwegian School of
> Economics and Business Administration, Helleveien 30, N-5045 Bergen,
> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no
>
>



From spzapevnsl at charter.com  Tue Mar  6 15:35:13 2007
From: spzapevnsl at charter.com (Havelandt Cdric)
Date: Tue, 06 Mar 2007 06:35:13 -0800
Subject: [R-sig-Geo] Felix,
	hier gibt es 1200.- Start-Bonus und man kann 1 Std gratis spielen
Message-ID: <000701c75ff6$aa4bb3f0$6638074b@QBWXDDT>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20070306/6b2dce12/attachment.pl>

From kn7k7k76kn65k65 at yahoo.co.jp  Tue Mar  6 14:43:46 2007
From: kn7k7k76kn65k65 at yahoo.co.jp (=?ISO-2022-JP?B?GyRCQEU5YSRONzskTj9GTScbKEI=?=)
Date: Tue, 06 Mar 2007 14:43:46 +0100
Subject: [R-sig-Geo] =?iso-2022-jp?b?GyRCP0ZNJyROS2UbKEIgGyRCQEU5YSMxGyhC?=
	=?iso-2022-jp?b?GyRCIzg6UCROJVclaSUkJVkhPCVIRnw1LRsoQg==?=
Message-ID: <E1HOZxB-0004S7-00@bernie.ethz.ch>

$B?FM'$NKe$O!"K\Ev$KH~?M$J$s$G$9!#(B
$B6;$bBg$-$$$7!"4i$b(B $BCf?9(B $BL@:Z(B $B$K;w$F$k$s$G$9!#(B
$BM7$S$K9T$C$?;~!"Ep;#%+%a%i$r;E3]$1$A$c$$$^$7$?!#(B
$B$b$A$m$s!"?FM'$K$OFb=o$G$9$1$I!&!&!&!&!&(B
$BKe$N%*%J%K!<$NEp;#$K at .8y$7$^$7$?!*!*(B
$BCf?9(B $BL@:Z(B $B$,%*%J%K!<$7$F$$$k$N$+$H:x3P$9$k$0$i$$>W7bE*$G$9!#(B
$B<+J,FH$j$G4Q$k$N$OL^BNL5$$$N$G!"3'$5$s$G%*%+%:$K$7$F2<$5$$!#(B
http://www1.xhers.com/?bc=str02&md=@86Ve8ehwI6PLPs-LPxshPxis_x71

$B$D$$$G$K!":G6aJL$l$?<+J,$N85H`$H$N%;%C%/%9%7!<%s$b(B
$B4Q$F2<$5$$!#K\Ev$K%(%m$$=w$G$7$?!#(B

















$B4Q$?$/$J$$?M$O(B
cancel at xhers.com



From mobile2screen.com at park.funnel.revenuedirect.com.akadns.net  Tue Mar  6 16:53:35 2007
From: mobile2screen.com at park.funnel.revenuedirect.com.akadns.net (Jorge Walker)
Date: Tue, 06 Mar 2007 10:53:35 -0500
Subject: [R-sig-Geo] She will love you more than any other guy
Message-ID: <000001c75ff6$7c93c100$0100007f@localhost>

Several millions men have been helped with the potent ingredients 
in Penis Growth Patch (TM) - men have experienced bigger size, deeper penetration
more action, and super-satisfying results for themselves and 
their partners.

Don't be left behind! Take advantage of price specials going on now.

Click here and visit our site!
http://www.hexet.hk/



From naglmc at yes-fitforfun.de  Tue Mar  6 15:03:54 2007
From: naglmc at yes-fitforfun.de (Crum E. Gloria)
Date: Tue, 6 Mar 2007 09:03:54 -0500
Subject: [R-sig-Geo] hippopotami utopian
Message-ID: <45ED74CA.5000502@yes-fitforfun.de>

An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20070306/efce131e/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: prime minister.gif
Type: image/gif
Size: 29155 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20070306/efce131e/attachment.gif>

From ggrothendieck at gmail.com  Tue Mar  6 15:10:56 2007
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Tue, 6 Mar 2007 09:10:56 -0500
Subject: [R-sig-Geo] LL to UTM
In-Reply-To: <1F724548E253BD49BA9BB000E9525F792855B6@usknxex01.epri.com>
References: <Pine.LNX.4.44.0703061415030.5614-100000@reclus.nhh.no>
	<1F724548E253BD49BA9BB000E9525F792855B6@usknxex01.epri.com>
Message-ID: <971536df0703060610k1226d57eh98944df2d7ae6b80@mail.gmail.com>

Thanks.  Looking at ?convUL I see that it also has the
capability of automatically determining the zone.   My
zone is fixed so its not a consideration but I will
keep it in mind.

Currently I am using rgdal so Roger's solution
lets me keep within my current framework but I
will check out PBSmapping too at some point.

On 3/6/07, Short, Tom <TShort at epri.com> wrote:
> Gabor,
>
> I've used convUL in the PBSmapping package to convert from UTM to
> lat/lon for some weather data I was playing with. It will also convert
> from lat/lon to UTM (I haven't tried that direction though).
>
> Here's the code I used:
>
>  library(PBSmapping)
>  subs = read.csv("ngrid/SubAsPoints.csv", comment="")
>  names(subs) = tolower(names(subs))
>  attr(subs, "zone") = 18
>  attr(subs, "projection") = "UTM"
>  subs$X = subs$point_x * 12 * 2.54 / 1e5 # convert to km
>  subs$Y = subs$point_y * 12 * 2.54 / 1e5
>  subs$sub_num = subs$sub_number
>  subs = convUL(subs)
>
> Here's the code from the help file for converting the other way:
>
>  data(nepacLL)
>  #--- set the zone attribute
>  attr(nepacLL, "zone") <- 9
>  #--- convert to UTM
>  nepacUTM <- convUL(nepacLL)
>
> - Tom
>
> Tom Short
> EPRI
>
>
> > -----Original Message-----
> > From: r-sig-geo-bounces at stat.math.ethz.ch
> > [mailto:r-sig-geo-bounces at stat.math.ethz.ch] On Behalf Of Roger Bivand
> > Sent: Tuesday, March 06, 2007 8:28 AM
> > To: Gabor Grothendieck
> > Cc: r-sig-geo at stat.math.ethz.ch
> > Subject: Re: [R-sig-Geo] LL to UTM
> >
> > On Tue, 6 Mar 2007, Gabor Grothendieck wrote:
> >
> > > Thanks. I looked at spTransform prior to posting but don't
> > understand it.
> > > What I want is to create a function that returns UTM coordinates:
> > >
> > > LL2UTM <- function(lat, long, zone = 18) { ...
> > > }
> >
> > library(rgdal)
> > LL2UTM <- function(lat, long, zone=18) {
> >   project(cbind(long, lat), paste("+proj=utm +zone=", zone, sep="")) }
> >
> > gets you there, for example for:
> >
> > lat <- seq(30,45,1)
> > long <- seq(-78,-72,1)
> > grd <- expand.grid(lat, long)
> > LL2UTM(grd[,1], grd[,2])
> >
> > The project() interface to PROJ4 does not support datum
> > transfromation, the spTransform() method does. The cost is
> > having to convert the data to a Spatial* object:
> >
> > SP_grd <- SpatialPoints(cbind(grd[,2], grd[,1]),
> >   proj4string=CRS("+proj=longlat +datum=NAD83"))
> > SP_grd1 <- spTransform(SP_grd, CRS("+proj=utm +zone=18 +datum=NAD83"))
> >
> > returning a SpatialPoints object - use the coordinates()
> > method to retrieve as a matrix.
> >
> > Assuming that your input geographical coordinates are in
> > NAD84/WGS84, and the output UTM coordinates are in the same
> > datum, project() will be OK. If you need datum
> > transformation, which may lead to errors of hundreds of
> > metres if not used, the PROJ4 string needs more detail. If
> > this is at the block scale, datum transformation will make a
> > difference if the input and output specifications vary (say
> > placing points on a UTM map not in WGS84/NAD83). At the
> > continental scale the differences are typically not great,
> > but then you wouldn't use UTM anyway.
> >
> > Hope this helps,
> >
> > Roger
> >
> > >
> > > If necessary, zone=18 can be hardcoded in the function and that arg
> > > removed.
> > >
> > > I assume that using spTransform its just a one line body.
> > Can you give
> > > me the specific line that it should be?
> > >
> > > Thanks.
> > >
> > >
> > > On 3/6/07, Edzer J. Pebesma <e.pebesma at geo.uu.nl> wrote:
> > > > Gabor,
> > > >
> > > > package rgdal provides an interface to the PROJ.4 library for
> > > > projection of geographical data. Look for the function (or rather
> > > > method) spTransform. It takes any of the spatial classes
> > provided by
> > > > package sp, and afaik any of the known projection
> > systems, including
> > > > UTM and ellipsoids (LL reference "model").
> > > > --
> > > > Edzer
> > > >
> > > > Gabor Grothendieck wrote:
> > > > > I am currently using this web page to convert LL to UTM
> > (and UTM to LL).
> > > > >
> > > > >    http://home.hiwaay.net/~taylorc/toolbox/geography/geoutm.html
> > > > >
> > > > > All my points are in zone 18.  How would I accomplish the same
> > > > > thing using R?
> > > > >
> > > > > Thanks.
> > > > >
> > > > > _______________________________________________
> > > > > R-sig-Geo mailing list
> > > > > R-sig-Geo at stat.math.ethz.ch
> > > > > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> > > > >
> > > >
> > > >
> > >
> > > _______________________________________________
> > > R-sig-Geo mailing list
> > > R-sig-Geo at stat.math.ethz.ch
> > > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> > >
> >
> > --
> > Roger Bivand
> > Economic Geography Section, Department of Economics,
> > Norwegian School of Economics and Business Administration,
> > Helleveien 30, N-5045 Bergen, Norway. voice: +47 55 95 93 55;
> > fax +47 55 95 95 43
> > e-mail: Roger.Bivand at nhh.no
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at stat.math.ethz.ch
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
>



From hb64lj5v7j7ltyrv4 at yahoo.co.jp  Tue Mar  6 15:13:34 2007
From: hb64lj5v7j7ltyrv4 at yahoo.co.jp (=?ISO-2022-JP?B?GyRCPGM6SkNcQDg0YTZxN0BMcxsoQg==?=)
Date: Tue, 06 Mar 2007 15:13:34 +0100
Subject: [R-sig-Geo] =?iso-2022-jp?b?GyRCMlA+SCRDJD8lKyVpJUAkcjt9JEYbKEI=?=
	=?iso-2022-jp?b?GyRCTT4kOT9NOkokPyRBGyhC?=
Message-ID: <E1HOaQ1-0005Ly-00@bernie.ethz.ch>

$B8+$+$1$O%;%l%V!"C&$2$P>+IX!*Ck$O>eIJ$K%Y%C%I$G$O2<IJ$K!D!#;0==O)=w$N(BT$B%P%C%/!"=ON}$N$J$>$j>e$2%U%'%i!"J*M_$7$2$J;k@~$dM6OG$N9x$D$-!D!#(B
$B5pF}ITNQ%^%>:J$NNh;R$OGXFAE*$G0[>o$J2w3Z$K?l$$$7$l$kFl9%$-!&F}?a$-(BM$B=w!*F}!&g4$+$i0|$i$J1UBN$r0n$l$5$;!"A4?H$ra[Z;$5$;$J$,$i%$%-%^%/%k!*N>7j$K6KB@%P%$%V$rRz$(!"8}$K$OGr$$0|1U$,E)$k6K>eF}?a$-ITNQ:J$ND68f0|9P!*(B
http://www1.twkds.com/?bc=sit03&md=@86Ve8ehwI6PLPs-LPxshPxis_x71







$B5qH]$NJ}$O(B
cancel at twkds.com



From Roger.Bivand at nhh.no  Tue Mar  6 15:34:13 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 6 Mar 2007 15:34:13 +0100 (CET)
Subject: [R-sig-Geo] LL to UTM
In-Reply-To: <971536df0703060549s452578efk134acd6a395f8b3@mail.gmail.com>
Message-ID: <Pine.LNX.4.44.0703061530560.6045-100000@reclus.nhh.no>

On Tue, 6 Mar 2007, Gabor Grothendieck wrote:

> Great!  Your LL2UTM function was exactly what I wanted.
> 
> My data sets are each about a city block in size and I mostly work
> in UTM on this project but I do get a few points in lat long. Its small
> enough that I have been using that web site I mentioned but it gets
> tedious after a while and this should be a big help.
> 
> I did notice that the R function below is consistent with the web site
> output only to 5 digits after the decimal place in x and 2 digits after
> the decimal place in y.  I don't know how to determine whether R or
> the web site is the more accurate but at any rate either seem likely
> to be well within the accuracy I need since, in truth, I don't need
> high precision.

The units are metres, so centimetre accuracy in y (measured from the 
Equator) and much better in x isn't bad! The web calculator may have a 
different number of digits of precision in its ellipsoid definitions.

Roger


> 
> Thanks.
> 
> 
> 
> On 3/6/07, Roger Bivand <Roger.Bivand at nhh.no> wrote:
> > On Tue, 6 Mar 2007, Gabor Grothendieck wrote:
> >
> > > Thanks. I looked at spTransform prior to posting but don't understand it.
> > > What I want is to create a function that returns UTM coordinates:
> > >
> > > LL2UTM <- function(lat, long, zone = 18) {
> > > ...
> > > }
> >
> > library(rgdal)
> > LL2UTM <- function(lat, long, zone=18) {
> >  project(cbind(long, lat), paste("+proj=utm +zone=", zone, sep=""))
> > }
> >
> > gets you there, for example for:
> >
> > lat <- seq(30,45,1)
> > long <- seq(-78,-72,1)
> > grd <- expand.grid(lat, long)
> > LL2UTM(grd[,1], grd[,2])
> >
> > The project() interface to PROJ4 does not support datum transfromation,
> > the spTransform() method does. The cost is having to convert the data to
> > a Spatial* object:
> >
> > SP_grd <- SpatialPoints(cbind(grd[,2], grd[,1]),
> >  proj4string=CRS("+proj=longlat +datum=NAD83"))
> > SP_grd1 <- spTransform(SP_grd, CRS("+proj=utm +zone=18 +datum=NAD83"))
> >
> > returning a SpatialPoints object - use the coordinates() method to
> > retrieve as a matrix.
> >
> > Assuming that your input geographical coordinates are in NAD84/WGS84, and
> > the output UTM coordinates are in the same datum, project() will be OK. If
> > you need datum transformation, which may lead to errors of hundreds of
> > metres if not used, the PROJ4 string needs more detail. If this is at the
> > block scale, datum transformation will make a difference if the input and
> > output specifications vary (say placing points on a UTM map not in
> > WGS84/NAD83). At the continental scale the differences are typically not
> > great, but then you wouldn't use UTM anyway.
> >
> > Hope this helps,
> >
> > Roger
> >
> > >
> > > If necessary, zone=18 can be hardcoded in the function and that
> > > arg removed.
> > >
> > > I assume that using spTransform its just a one line body. Can
> > > you give me the specific line that it should be?
> > >
> > > Thanks.
> > >
> > >
> > > On 3/6/07, Edzer J. Pebesma <e.pebesma at geo.uu.nl> wrote:
> > > > Gabor,
> > > >
> > > > package rgdal provides an interface to the PROJ.4 library for projection
> > > > of geographical data. Look for the function (or rather method)
> > > > spTransform. It takes any of the spatial classes provided by package sp,
> > > > and afaik any of the known projection systems, including UTM and
> > > > ellipsoids (LL reference "model").
> > > > --
> > > > Edzer
> > > >
> > > > Gabor Grothendieck wrote:
> > > > > I am currently using this web page to convert LL to UTM (and UTM to LL).
> > > > >
> > > > >    http://home.hiwaay.net/~taylorc/toolbox/geography/geoutm.html
> > > > >
> > > > > All my points are in zone 18.  How would I accomplish the same
> > > > > thing using R?
> > > > >
> > > > > Thanks.
> > > > >
> > > > > _______________________________________________
> > > > > R-sig-Geo mailing list
> > > > > R-sig-Geo at stat.math.ethz.ch
> > > > > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> > > > >
> > > >
> > > >
> > >
> > > _______________________________________________
> > > R-sig-Geo mailing list
> > > R-sig-Geo at stat.math.ethz.ch
> > > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> > >
> >
> > --
> > Roger Bivand
> > Economic Geography Section, Department of Economics, Norwegian School of
> > Economics and Business Administration, Helleveien 30, N-5045 Bergen,
> > Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> > e-mail: Roger.Bivand at nhh.no
> >
> >
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From epistat at gmail.com  Tue Mar  6 15:34:50 2007
From: epistat at gmail.com (zhijie zhang)
Date: Tue, 6 Mar 2007 22:34:50 +0800
Subject: [R-sig-Geo] which function in R can extract the coordinats of
	ploygon's center and create Dirichlet tessellation/Delaunay
	triangulation of points?
Message-ID: <2fc17e30703060634t716b823cw69f9129b7078f41@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20070306/00906dac/attachment.pl>

From ggrothendieck at gmail.com  Tue Mar  6 15:37:04 2007
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Tue, 6 Mar 2007 09:37:04 -0500
Subject: [R-sig-Geo] LL to UTM
In-Reply-To: <Pine.LNX.4.44.0703061530560.6045-100000@reclus.nhh.no>
References: <971536df0703060549s452578efk134acd6a395f8b3@mail.gmail.com>
	<Pine.LNX.4.44.0703061530560.6045-100000@reclus.nhh.no>
Message-ID: <971536df0703060637p226893f5q59b14fc46e0b3bde@mail.gmail.com>

Thanks for the clarification.

On 3/6/07, Roger Bivand <Roger.Bivand at nhh.no> wrote:
> On Tue, 6 Mar 2007, Gabor Grothendieck wrote:
>
> > Great!  Your LL2UTM function was exactly what I wanted.
> >
> > My data sets are each about a city block in size and I mostly work
> > in UTM on this project but I do get a few points in lat long. Its small
> > enough that I have been using that web site I mentioned but it gets
> > tedious after a while and this should be a big help.
> >
> > I did notice that the R function below is consistent with the web site
> > output only to 5 digits after the decimal place in x and 2 digits after
> > the decimal place in y.  I don't know how to determine whether R or
> > the web site is the more accurate but at any rate either seem likely
> > to be well within the accuracy I need since, in truth, I don't need
> > high precision.
>
> The units are metres, so centimetre accuracy in y (measured from the
> Equator) and much better in x isn't bad! The web calculator may have a
> different number of digits of precision in its ellipsoid definitions.
>
> Roger
>
>
> >
> > Thanks.
> >
> >
> >
> > On 3/6/07, Roger Bivand <Roger.Bivand at nhh.no> wrote:
> > > On Tue, 6 Mar 2007, Gabor Grothendieck wrote:
> > >
> > > > Thanks. I looked at spTransform prior to posting but don't understand it.
> > > > What I want is to create a function that returns UTM coordinates:
> > > >
> > > > LL2UTM <- function(lat, long, zone = 18) {
> > > > ...
> > > > }
> > >
> > > library(rgdal)
> > > LL2UTM <- function(lat, long, zone=18) {
> > >  project(cbind(long, lat), paste("+proj=utm +zone=", zone, sep=""))
> > > }
> > >
> > > gets you there, for example for:
> > >
> > > lat <- seq(30,45,1)
> > > long <- seq(-78,-72,1)
> > > grd <- expand.grid(lat, long)
> > > LL2UTM(grd[,1], grd[,2])
> > >
> > > The project() interface to PROJ4 does not support datum transfromation,
> > > the spTransform() method does. The cost is having to convert the data to
> > > a Spatial* object:
> > >
> > > SP_grd <- SpatialPoints(cbind(grd[,2], grd[,1]),
> > >  proj4string=CRS("+proj=longlat +datum=NAD83"))
> > > SP_grd1 <- spTransform(SP_grd, CRS("+proj=utm +zone=18 +datum=NAD83"))
> > >
> > > returning a SpatialPoints object - use the coordinates() method to
> > > retrieve as a matrix.
> > >
> > > Assuming that your input geographical coordinates are in NAD84/WGS84, and
> > > the output UTM coordinates are in the same datum, project() will be OK. If
> > > you need datum transformation, which may lead to errors of hundreds of
> > > metres if not used, the PROJ4 string needs more detail. If this is at the
> > > block scale, datum transformation will make a difference if the input and
> > > output specifications vary (say placing points on a UTM map not in
> > > WGS84/NAD83). At the continental scale the differences are typically not
> > > great, but then you wouldn't use UTM anyway.
> > >
> > > Hope this helps,
> > >
> > > Roger
> > >
> > > >
> > > > If necessary, zone=18 can be hardcoded in the function and that
> > > > arg removed.
> > > >
> > > > I assume that using spTransform its just a one line body. Can
> > > > you give me the specific line that it should be?
> > > >
> > > > Thanks.
> > > >
> > > >
> > > > On 3/6/07, Edzer J. Pebesma <e.pebesma at geo.uu.nl> wrote:
> > > > > Gabor,
> > > > >
> > > > > package rgdal provides an interface to the PROJ.4 library for projection
> > > > > of geographical data. Look for the function (or rather method)
> > > > > spTransform. It takes any of the spatial classes provided by package sp,
> > > > > and afaik any of the known projection systems, including UTM and
> > > > > ellipsoids (LL reference "model").
> > > > > --
> > > > > Edzer
> > > > >
> > > > > Gabor Grothendieck wrote:
> > > > > > I am currently using this web page to convert LL to UTM (and UTM to LL).
> > > > > >
> > > > > >    http://home.hiwaay.net/~taylorc/toolbox/geography/geoutm.html
> > > > > >
> > > > > > All my points are in zone 18.  How would I accomplish the same
> > > > > > thing using R?
> > > > > >
> > > > > > Thanks.
> > > > > >
> > > > > > _______________________________________________
> > > > > > R-sig-Geo mailing list
> > > > > > R-sig-Geo at stat.math.ethz.ch
> > > > > > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> > > > > >
> > > > >
> > > > >
> > > >
> > > > _______________________________________________
> > > > R-sig-Geo mailing list
> > > > R-sig-Geo at stat.math.ethz.ch
> > > > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> > > >
> > >
> > > --
> > > Roger Bivand
> > > Economic Geography Section, Department of Economics, Norwegian School of
> > > Economics and Business Administration, Helleveien 30, N-5045 Bergen,
> > > Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> > > e-mail: Roger.Bivand at nhh.no
> > >
> > >
> >
>
> --
> Roger Bivand
> Economic Geography Section, Department of Economics, Norwegian School of
> Economics and Business Administration, Helleveien 30, N-5045 Bergen,
> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no
>
>



From ggrothendieck at gmail.com  Tue Mar  6 15:40:03 2007
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Tue, 6 Mar 2007 09:40:03 -0500
Subject: [R-sig-Geo] Which organizations use R for geographic processing?
Message-ID: <971536df0703060640q137b231bpc1203b8df4e0db21@mail.gmail.com>

Not sure if this will become an issue but in case I need
it to justify my toolset does anyone have a list of
recognizable organizations that use R for geographic
processing?

Thanks.



From hyperpersonal at steeltradecenter.com  Tue Mar  6 15:40:45 2007
From: hyperpersonal at steeltradecenter.com (Ken Waters)
Date: Tue, 06 Mar 2007 14:40:45 +0000
Subject: [R-sig-Geo] Vlsta, 0ffice 2007 & Acrobat 8 79$ at Nathan's supersoft
Message-ID: <000001c75ffd$26764c00$0100007f@localhost>

All Titles 0n Speclal on Mar 06 17:30:00 MSK 2007

MlCR0S0FT 0ffice 2OO7    79$
MlCR0S0FT Vlsta Business 79$
AD0BE Acrobat 8 PR0 	 79$
Wind0ws XP PR0 +SP2 	 49$
AD0BE Premiere 2.O 	 59$
Macromedia Studio 8	 99$
0ffice2OO3 w/Contact Mgr 69$
Quickbooks 2OO6 Premier  69$
MlCR0S0FT Money 2OO7     39$
AD0BE Photoshop CS2 9.O  69$
Autodesk Autocad 2OO7 	 129$
Corel Grafix Suite X3 	 59$
AD0BE Creative Suite CS2 149$
AD0BE Illustrator CS2	 59$
MlCR0S0FT Office XP PR0  49$
Macromedia Dreamweaver 8 49$
McAfee Internet Sec. 7   29$
Norton Antivirus Corp.   29$
Mac software		 49$

http://er.irooem.com/?hJkNq56383

Production of this drive has been discontinued.
tape wraps around 270 degrees of the spool that holds the heads.  The
FreeBSD can even boot "diskless", making individual workstations
The problem nearly always occurs when (FreeBSD) PC systems are
MAKDEV not only creates the /dev/ttyd? device special files, but also
	discuss alternative solutions.	Individuals interested in
7.6.3.  Networked Printing
the peripheral transmit data to or from memory constantly while it
6.2.6.  Restricting use of UNIX passwords
Current Kerberos master key version is 1.
lpc accepts the above commands on the command line.  If you do not
	Insert in that file a number representing how many disk blocks
within this directory so we suggest using the DOS xcopy command.  For
The ``network-related'' pseudo-devices are in that section, while the
endeavor to replace such software with submissions under the more
11.4.1.3.  External vs. Internal Modems
#
o  See section ``Simple Printer Setup'' to learn how to connect a
specific chain entry.
	SoundBlaster 16 MIDI interface.  If you have a SoundBlaster 16,
simply strip the system down to the bare essentials until the
configured the appropriate system files to allow logins through your
Max ticket lifetime (*5 minutes) [ 255 ] ?
all" from the client to fix this.
enough variation in even these simple tiny things to make finding the
set win 8



From tkeitt at gmail.com  Tue Mar  6 16:27:18 2007
From: tkeitt at gmail.com (Tim Keitt)
Date: Tue, 6 Mar 2007 09:27:18 -0600
Subject: [R-sig-Geo] Which organizations use R for geographic processing?
In-Reply-To: <971536df0703060640q137b231bpc1203b8df4e0db21@mail.gmail.com>
References: <971536df0703060640q137b231bpc1203b8df4e0db21@mail.gmail.com>
Message-ID: <6262c54c0703060727p1fd5decdk7eadb0238f457a4a@mail.gmail.com>

Sounds like a good wiki-page. Is there a wiki for r-sig-geo?

THK

On 3/6/07, Gabor Grothendieck <ggrothendieck at gmail.com> wrote:
> Not sure if this will become an issue but in case I need
> it to justify my toolset does anyone have a list of
> recognizable organizations that use R for geographic
> processing?
>
> Thanks.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


-- 
Timothy H. Keitt, University of Texas at Austin
Contact info and schedule at http://www.keittlab.org/tkeitt/
Reprints at http://www.keittlab.org/tkeitt/papers/
ODF attachment? See http://www.openoffice.org/



From teamlondon.net at opsshop.com  Tue Mar  6 16:38:15 2007
From: teamlondon.net at opsshop.com (Trenton Allen)
Date: Tue, 06 Mar 2007 16:38:15 +0100
Subject: [R-sig-Geo] Why be an average guy any longer
Message-ID: <000001c76005$46aa0900$0100007f@localhost>

Several millions men have been helped with the potent ingredients 
in Penis Growth Patch (TM) - men have experienced bigger size, deeper penetration
more action, and super-satisfying results for themselves and 
their partners.

Don't be left behind! Take advantage of price specials going on now.

Click here and visit our site!
http://www.hexet.hk/



From e.pebesma at geo.uu.nl  Tue Mar  6 16:41:52 2007
From: e.pebesma at geo.uu.nl (Edzer J. Pebesma)
Date: Tue, 06 Mar 2007 16:41:52 +0100
Subject: [R-sig-Geo] Which organizations use R for geographic processing?
In-Reply-To: <971536df0703060640q137b231bpc1203b8df4e0db21@mail.gmail.com>
References: <971536df0703060640q137b231bpc1203b8df4e0db21@mail.gmail.com>
Message-ID: <45ED8BC0.5060804@geo.uu.nl>

All of the partners in the intamap project (http://www.intamap.org/) do, 
for example.
--
Edzer

Gabor Grothendieck wrote:
> Not sure if this will become an issue but in case I need
> it to justify my toolset does anyone have a list of
> recognizable organizations that use R for geographic
> processing?
>
> Thanks.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>



From bykchkiowxijnapp at telecomitalia.it  Tue Mar  6 16:49:55 2007
From: bykchkiowxijnapp at telecomitalia.it (Kay Dunn)
Date: Wed, 07 Mar 2007 03:49:55 +1200
Subject: [R-sig-Geo] Didn't Understand It
Message-ID: <3be801c7606b$ab7b7330$30174b50@bykchkiowxijnapp>





"There was lively gleaming a third person with them helpless cut whom I knew pe   "Come," said he to the work abb, example "I am bet slip anxious to see    "Yes, develop feed to plough go money and meet him."The abb smiled, and, fall speed proceeding middle to rise the disused fi     

"God wing forgive me," said bolt request the young tooth man, "for rejoici   "Oh, porter sat indeed--indeed, sir, he open sail is innocent!" sobbed   "That I believe!" answered awoken feed M. Morrel; farm design "but still h  

run "Yes, my dear tiny boy," replied the debt old man, ask "it is ve  

"Is there anything powerful light else I operation can serve assist you in discov"What do bell you wish secretary concerned event to see first?" asked the abb."He crush has held but around a handful of amusement men with him, and armies"Oh, your exuberant great reason copy work on the step monarchy of Italy!"    

"Well, then, with the stick slap first money right I fall touch, I mean     "With what?" tongue madly pain fierce inquired the elder Dants.    "With being regret rush an operation agent of vivaciously the Bonapartist faction!"   &nbsp

impossible "'Tis nothing, berry nothing; it rapidly will examine soon pass away"--a     
alive "Yes, yes," branch replied fortunately Dants eagerly; wind "I would beg oFaria then drew dust attract down around forth from his hiding-place threeboard "Yes, never to escort land him into dove the capital. Really, my d"There," said he, "there is meeting the work burst mortally interrupt complete. I w     

"Come, cute greet come," said the young beset man, "a made glass of wine hit A smell despairing cry escaped the touch pale school lips of Mercds  "Ah, Danglars!" mind different winter whispered stick Caderousse, "you have de    

"No, no; thanks. You seed trade need snore not look for it; religion I do no   bomb near "Grenoble and rub Lyons are faithful lock cities, and will     
"That is altogether a fade different among supply and bird more serious m"I see," read answered repair Dants. "Now quickly let me filthy behold the csheep "Grenoble peripatetic will open her gates wildly to hurry him with enthusia"Look!" said doubt business shade company Faria, showing to the young man a sle    

mother "Yes, yes, father, tell me tap where it geriatric pocket is," and he op   "Be silent, stood you industry simpleton!" organization important cried Danglars, graspi     With the knot unlock seen rapid quit instinct of selfishness, Caderousse    

"Pray ask nut spoil me spent whatever questions bid you please; for, i"Ah, goat guard squealing yes," said forget Faria; "the penknife. That's my maknot thrive "Indeed!" replied peace dead Villefort, looking at his fatherDants slowly light examined tired the various knot articles shown to him       

quietly "It reign is no use," said tasty the above old man, "there is no win"Suppose we plead wait a while, and see belief rung what moon comes of it  "To excuse be sure!" answered Danglars. "Let warmly respect shine us wait, by 

"What, no wine?" danger said Dants, sand help turning relation pale, and lo 
"In wonderful the fetch first place, astragatar bleed then, who examined you,--the"As for creep the clear ink," said face Faria, "I told branch you how I ma"Eh? the thing is simple alive stuff enough. You strive who place are in podrawer "One thing still shelter save puzzles me," swore observed Dants, "an  

sleep "I want nothing now that soon transport I have explode you," said the old     "Let us go, then. elegantly I cannot stay hospital story punch here any longer." umbrella After their shoe departure, Fernand, who servant frowning had now again         &nbsp

"Yet," stammered Dants, keep load paper dry wiping the perspiration f"I worked smoggy band annoyed at night impossible also," replied Faria.  
     
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20070307/c5684930/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: image/gif
Size: 11266 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20070307/c5684930/attachment.gif>

From mommaslittleho.com at usedcompanycars.com  Tue Mar  6 17:57:48 2007
From: mommaslittleho.com at usedcompanycars.com (Adan Powell)
Date: Tue, 06 Mar 2007 21:57:48 +0500
Subject: [R-sig-Geo] You can save up to 70%
Message-ID: <000001c7600c$0ef28f80$0100007f@localhost>

View this e-mail as HTML or click here:
<a href=3D"http://ri.ntrirx.eu/">


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20070306/8dcc53aa/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: image/gif
Size: 5184 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20070306/8dcc53aa/attachment.gif>

From tsdajwapsd at tpnet.pl  Tue Mar  6 19:59:26 2007
From: tsdajwapsd at tpnet.pl (still issue.)
Date: Tue, 6 Mar 2007 17:59:26 -0100
Subject: [R-sig-Geo] Penetrate your partner for hours on end
Message-ID: <73DC81E58D1848E.3C59D86C67@tpnet.pl>

An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20070306/40b561bb/attachment.html>

From mcharity at myself.com  Tue Mar  6 18:13:14 2007
From: mcharity at myself.com (Sex can)
Date: Tue, 06 Mar 2007 20:13:14 +0300
Subject: [R-sig-Geo] VIAGRA
Message-ID: <1b0901c76012$02704dde$4714a01c@myself.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20070306/c35ff12d/attachment.pl>

From Massive.Load at kear.tdsnet.com  Tue Mar  6 19:33:12 2007
From: Massive.Load at kear.tdsnet.com (Giant.Length)
Date: Tue, 06 Mar 2007 10:33:12 -0800
Subject: [R-sig-Geo] Giant.Man
Message-ID: <aa5484.as6085602@bitworking.org>

Just Imagine This:

New Great Lenghth...

New Thick Width...

A New Fuller Load...

A New Fat Cock...

A New You. 
Why not explore the potential? Live Life.

http://dooge.net



From Roger.Bivand at nhh.no  Tue Mar  6 19:42:19 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 6 Mar 2007 19:42:19 +0100 (CET)
Subject: [R-sig-Geo] Which organizations use R for geographic processing?
In-Reply-To: <6262c54c0703060727p1fd5decdk7eadb0238f457a4a@mail.gmail.com>
Message-ID: <Pine.LNX.4.44.0703061929290.6045-100000@reclus.nhh.no>

On Tue, 6 Mar 2007, Tim Keitt wrote:

> Sounds like a good wiki-page. Is there a wiki for r-sig-geo?

No, no wiki. The R-geo site is maintained by me on a remotely editable 
site, works pretty well, and material can be added if sent to me, but not 
otherwise (we are grateful guests there). The mailing list isn't bad, 
being searchable in the R search engines and gmane.

If the underlying question is about the software used for geographic data 
handling, then the answer is that it is largely OSGeo.org (PROJ.4, 
GDAL/OGR, and as an interface GRASS), so that organisations using these 
libraries effectively use the same implementations (conditional on the 
bindings to the libraries being OK, of course). GDAL (pronounced goodle) 
is very widely used, including by GIS software companies (some notes on 
the OSGeo.org website, and on: http://www.gdal.org/credits.html.

Roger

> 
> THK
> 
> On 3/6/07, Gabor Grothendieck <ggrothendieck at gmail.com> wrote:
> > Not sure if this will become an issue but in case I need
> > it to justify my toolset does anyone have a list of
> > recognizable organizations that use R for geographic
> > processing?
> >
> > Thanks.
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at stat.math.ethz.ch
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
> 
> 
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From Roger.Bivand at nhh.no  Tue Mar  6 19:51:20 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 6 Mar 2007 19:51:20 +0100 (CET)
Subject: [R-sig-Geo] which function in R can extract the coordinats of
 ploygon's center and create Dirichlet tessellation/Delaunay triangulation
 of points?
In-Reply-To: <2fc17e30703060634t716b823cw69f9129b7078f41@mail.gmail.com>
Message-ID: <Pine.LNX.4.44.0703061947260.6045-100000@reclus.nhh.no>

On Tue, 6 Mar 2007, zhijie zhang wrote:

> Dear friends,
>   I can't find the functions in R to do the following tasks:
> 1. extract the coordinats of ploygon's center  ;

The coordinate() method for a SpatialPolygons or SpatialPolygonsDataFrame 
object returns the centroid of the largest member polygon.

> 2. create Dirichlet tessellation and Delaunay triangulation for a set of
> points sp,spdep,tripack,et al, seem not to be able to finish it.

Please review the following recent posting, where the deldir package is 
used to extract a tesselation:

http://article.gmane.org/gmane.comp.lang.r.geo/1275

It ought to cover your question (it is more difficult to recover the outer 
polygons of the tesselation from tripack as closed polygons).

Hope this helps,

Roger

>  If u know how to do it, please let me know.
> Thanks very much.
> 
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From ggrothendieck at gmail.com  Tue Mar  6 22:03:29 2007
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Tue, 6 Mar 2007 16:03:29 -0500
Subject: [R-sig-Geo] Drawing circular contours
Message-ID: <971536df0703061303t11e8f213if0d8e2cd01570599@mail.gmail.com>

I am currently doing the following to draw circles at the
indicated distances from the center.  The center is given
by utm coordinates: utm.e, utm.n .  It does work:

class(im2) # "SpatialGridDataFrame"
image(im2, "ind", col = col$ct)
library(plotrix)
dd <- c(25, 50, 100, 150)
for(i in 1:4) draw.circle(utm.e, utm.n, dd[i], border = "yellow")

However, I would like to do this in a style better suited to sp
and rgdal by defining a function whose contours are circles and
plotting the indicated contours of it.  Also I assume I will get
labelled contours by doing that which I don't currently have.

How do I do that?  I would appreciate specific code, if possible,

Thanks.



From thierry_schmitt at yahoo.com  Tue Mar  6 23:09:44 2007
From: thierry_schmitt at yahoo.com (Schmitt Thierry)
Date: Tue, 6 Mar 2007 14:09:44 -0800 (PST)
Subject: [R-sig-Geo] comparing raster and vector data with Grass/R
Message-ID: <162766.95410.qm@web35606.mail.mud.yahoo.com>

Hi members of the list

I am new to the R community (somewhat to the grass community also). I would like to see if there is any correlation between vector data (polyline connected to a db file) and classes from an analysis on a raster file. Namely I have an underwater DEM (raster 4m resolution) and transects of interpreted underwater camera (vector-db, one transect is around 30m).
My aim would to plot one of the variable from the "camera" transect vs. the classes extracted along the co-located raster transect. 

If anybody could give a hint or some area of investigation, it will be more than welcome.

TS



From info at mariabusinessresource.com  Wed Mar  7 01:32:42 2007
From: info at mariabusinessresource.com (zimplatinumresources.com)
Date: Tue, 6 Mar 2007 18:32:42 -0600
Subject: [R-sig-Geo] BUSINESS OFFER FROM ZIMPLATS
Message-ID: <E1HOk5L-0001nB-00@bernie.ethz.ch>

An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20070306/41f21899/attachment.html>

From 56f225gj at ibike.com.hk  Wed Mar  7 05:59:27 2007
From: 56f225gj at ibike.com.hk ( )
Date: Wed, 7 Mar 2007 12:59:27 +0800
Subject: [R-sig-Geo] =?GB2312?B?tc2828341b7Wxtf3?=
Message-ID: <200703070500.l2750hdj009224@hypatia.math.ethz.ch>

An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20070307/2ac2f2fe/attachment.html>

From e.pebesma at geo.uu.nl  Wed Mar  7 08:32:37 2007
From: e.pebesma at geo.uu.nl (Edzer J. Pebesma)
Date: Wed, 07 Mar 2007 08:32:37 +0100
Subject: [R-sig-Geo] comparing raster and vector data with Grass/R
In-Reply-To: <162766.95410.qm@web35606.mail.mud.yahoo.com>
References: <162766.95410.qm@web35606.mail.mud.yahoo.com>
Message-ID: <45EE6A95.7030703@geo.uu.nl>

Using the classes and methods for spatial data in package sp, typically 
the dem would be stored in a grid (SpatialGridDataFrame) and the vector 
data in a SpatialPointsDataFrame. Then you can use the overlay method to 
retrieve the dem values at point locations, to look at their relationship.
--
Edzer

Schmitt Thierry wrote:
> Hi members of the list
>
> I am new to the R community (somewhat to the grass community also). I would like to see if there is any correlation between vector data (polyline connected to a db file) and classes from an analysis on a raster file. Namely I have an underwater DEM (raster 4m resolution) and transects of interpreted underwater camera (vector-db, one transect is around 30m).
> My aim would to plot one of the variable from the "camera" transect vs. the classes extracted along the co-located raster transect. 
>
> If anybody could give a hint or some area of investigation, it will be more than welcome.
>
> TS
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>



From e.pebesma at geo.uu.nl  Wed Mar  7 08:47:40 2007
From: e.pebesma at geo.uu.nl (Edzer J. Pebesma)
Date: Wed, 07 Mar 2007 08:47:40 +0100
Subject: [R-sig-Geo] Drawing circular contours
In-Reply-To: <971536df0703061303t11e8f213if0d8e2cd01570599@mail.gmail.com>
References: <971536df0703061303t11e8f213if0d8e2cd01570599@mail.gmail.com>
Message-ID: <45EE6E1C.80207@geo.uu.nl>

Gabor, sp provides a contour method for objects of class 
SpatialGridDataFrame. I don't know how you should create a grid such 
that contours are circles -- simplest to generate distances from 
specific points. I don't know if there is easy way to do this right now; 
a rather indirect way is to use the kriging variance from a linear 
variogram and a 1-NN neighbourhood:

library(gstat) # requires sp
data(meuse)
coordinates(meuse) = ~x+y
data(meuse.grid)
gridded(meuse.grid) = ~x+y
# interpolate over the complete rectangular area, not just the study area:
meuse.grid = as(meuse.grid, "SpatialGrid")
# krige from 10 random points with linear variogram and 1-NN neighbourhood:
out = krige(log(zinc)~1,meuse[sample(1:155,10),], meuse.grid, vgm(1, 
"Lin", 0), nmax=1)
# contour kriging variance:
contour(out[2], asp=1)

Note that the contour method does not set the aspect ratio by default -- 
an omission.
--
Edzer


Gabor Grothendieck wrote:
> I am currently doing the following to draw circles at the
> indicated distances from the center.  The center is given
> by utm coordinates: utm.e, utm.n .  It does work:
>
> class(im2) # "SpatialGridDataFrame"
> image(im2, "ind", col = col$ct)
> library(plotrix)
> dd <- c(25, 50, 100, 150)
> for(i in 1:4) draw.circle(utm.e, utm.n, dd[i], border = "yellow")
>
> However, I would like to do this in a style better suited to sp
> and rgdal by defining a function whose contours are circles and
> plotting the indicated contours of it.  Also I assume I will get
> labelled contours by doing that which I don't currently have.
>
> How do I do that?  I would appreciate specific code, if possible,
>
> Thanks.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>



From Roger.Bivand at nhh.no  Wed Mar  7 11:25:18 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 7 Mar 2007 11:25:18 +0100 (CET)
Subject: [R-sig-Geo] Drawing circular contours
In-Reply-To: <45EE6E1C.80207@geo.uu.nl>
Message-ID: <Pine.LNX.4.44.0703071117240.6690-100000@reclus.nhh.no>

On Wed, 7 Mar 2007, Edzer J. Pebesma wrote:

> Gabor, sp provides a contour method for objects of class 
> SpatialGridDataFrame. I don't know how you should create a grid such 
> that contours are circles -- simplest to generate distances from 
> specific points. 

These are effectively vector buffers around points. My guess would be that 
the "circle"-type functions sent to R-help (often for drawing not 
returning a polygon-as-circle) could be used. For example, John Fox' 
posting:

http://finzi.psych.upenn.edu/R/Rhelp02a/archive/74907.html

could be adapted (for the projected case, the geographical coordinates 
case is more difficult). Then construct SpatialPolygons objects from the 
output object. Or make a template polygon for (0,0) and shift to the 
required (x,y) centres before making SpatialPolygons objects.

Hope this helps,

Roger

PS. Most GIS do this, and I think PostGIS/GEOS does too, but I don't think 
any of them can store the output as anything other than a ring polygon.

> I don't know if there is easy way to do this right now; 
> a rather indirect way is to use the kriging variance from a linear 
> variogram and a 1-NN neighbourhood:
> 
> library(gstat) # requires sp
> data(meuse)
> coordinates(meuse) = ~x+y
> data(meuse.grid)
> gridded(meuse.grid) = ~x+y
> # interpolate over the complete rectangular area, not just the study area:
> meuse.grid = as(meuse.grid, "SpatialGrid")
> # krige from 10 random points with linear variogram and 1-NN neighbourhood:
> out = krige(log(zinc)~1,meuse[sample(1:155,10),], meuse.grid, vgm(1, 
> "Lin", 0), nmax=1)
> # contour kriging variance:
> contour(out[2], asp=1)
> 
> Note that the contour method does not set the aspect ratio by default -- 
> an omission.
> --
> Edzer
> 
> 
> Gabor Grothendieck wrote:
> > I am currently doing the following to draw circles at the
> > indicated distances from the center.  The center is given
> > by utm coordinates: utm.e, utm.n .  It does work:
> >
> > class(im2) # "SpatialGridDataFrame"
> > image(im2, "ind", col = col$ct)
> > library(plotrix)
> > dd <- c(25, 50, 100, 150)
> > for(i in 1:4) draw.circle(utm.e, utm.n, dd[i], border = "yellow")
> >
> > However, I would like to do this in a style better suited to sp
> > and rgdal by defining a function whose contours are circles and
> > plotting the indicated contours of it.  Also I assume I will get
> > labelled contours by doing that which I don't currently have.
> >
> > How do I do that?  I would appreciate specific code, if possible,
> >
> > Thanks.
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at stat.math.ethz.ch
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From ggrothendieck at gmail.com  Wed Mar  7 13:22:36 2007
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Wed, 7 Mar 2007 07:22:36 -0500
Subject: [R-sig-Geo] Drawing circular contours
In-Reply-To: <45EE6E1C.80207@geo.uu.nl>
References: <971536df0703061303t11e8f213if0d8e2cd01570599@mail.gmail.com>
	<45EE6E1C.80207@geo.uu.nl>
Message-ID: <971536df0703070422r5edca9dag933b8e7031b04da7@mail.gmail.com>

Thanks to you and to Roger for the code.

On 3/7/07, Edzer J. Pebesma <e.pebesma at geo.uu.nl> wrote:
> Gabor, sp provides a contour method for objects of class
> SpatialGridDataFrame. I don't know how you should create a grid such
> that contours are circles -- simplest to generate distances from
> specific points. I don't know if there is easy way to do this right now;
> a rather indirect way is to use the kriging variance from a linear
> variogram and a 1-NN neighbourhood:
>
> library(gstat) # requires sp
> data(meuse)
> coordinates(meuse) = ~x+y
> data(meuse.grid)
> gridded(meuse.grid) = ~x+y
> # interpolate over the complete rectangular area, not just the study area:
> meuse.grid = as(meuse.grid, "SpatialGrid")
> # krige from 10 random points with linear variogram and 1-NN neighbourhood:
> out = krige(log(zinc)~1,meuse[sample(1:155,10),], meuse.grid, vgm(1,
> "Lin", 0), nmax=1)
> # contour kriging variance:
> contour(out[2], asp=1)
>
> Note that the contour method does not set the aspect ratio by default --
> an omission.
> --
> Edzer
>
>
> Gabor Grothendieck wrote:
> > I am currently doing the following to draw circles at the
> > indicated distances from the center.  The center is given
> > by utm coordinates: utm.e, utm.n .  It does work:
> >
> > class(im2) # "SpatialGridDataFrame"
> > image(im2, "ind", col = col$ct)
> > library(plotrix)
> > dd <- c(25, 50, 100, 150)
> > for(i in 1:4) draw.circle(utm.e, utm.n, dd[i], border = "yellow")
> >
> > However, I would like to do this in a style better suited to sp
> > and rgdal by defining a function whose contours are circles and
> > plotting the indicated contours of it.  Also I assume I will get
> > labelled contours by doing that which I don't currently have.
> >
> > How do I do that?  I would appreciate specific code, if possible,
> >
> > Thanks.
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at stat.math.ethz.ch
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
>
>



From thierry_schmitt at yahoo.com  Wed Mar  7 21:06:53 2007
From: thierry_schmitt at yahoo.com (Schmitt Thierry)
Date: Wed, 7 Mar 2007 12:06:53 -0800 (PST)
Subject: [R-sig-Geo] comparing raster and vector data with Grass/R
Message-ID: <410583.74145.qm@web35607.mail.mud.yahoo.com>

I am struggling to overlay spatialLinesDataFrame and SpatialGridDataFrame. The overlay method doesn't allow me to do so.

As mentioned by matt, I might have a look at starspan. However, I might be interested to have some solution within the Grass/R interface

Thierry



From Roger.Bivand at nhh.no  Wed Mar  7 21:33:43 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 7 Mar 2007 21:33:43 +0100 (CET)
Subject: [R-sig-Geo] comparing raster and vector data with Grass/R
In-Reply-To: <410583.74145.qm@web35607.mail.mud.yahoo.com>
Message-ID: <Pine.LNX.4.44.0703072112450.6690-100000@reclus.nhh.no>

On Wed, 7 Mar 2007, Schmitt Thierry wrote:

> I am struggling to overlay spatialLinesDataFrame and
> SpatialGridDataFrame. The overlay method doesn't allow me to do so.
> 

There is no overlay method, you would need to write one, or interpolate 
points along your lines and overlay the resulting point object on the 
raster.

> As mentioned by matt, I might have a look at starspan. However, I might
> be interested to have some solution within the Grass/R interface

Could I suggest that you try v.to.rast in GRASS, and simply use multiple 
rasters? You may need care with the resolution, but in spearfish:

v.to.rast input=roads output=v_roads use=cat

then in R:

library(spgrass6)
sp <- readRAST6(c("v_roads", "elevation.dem"))
summary(sp)
sp1 <- as(sp, "SpatialPixelsDataFrame")
summary(sp1)
sp2 <- sp1[!is.na(sp1$v_roads),]
summary(sp2)
by(sp2$elevation.dem, sp2$v_roads, summary)

which just preserves the raster cells crossed by roads as defined by 
v.to.rast.

Hope this helps,

Roger

> 
> Thierry
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From jgreenberg at arc.nasa.gov  Wed Mar  7 21:58:18 2007
From: jgreenberg at arc.nasa.gov (Jonathan Greenberg)
Date: Wed, 07 Mar 2007 12:58:18 -0800
Subject: [R-sig-Geo] comparing raster and vector data with Grass/R
In-Reply-To: <Pine.LNX.4.44.0703072112450.6690-100000@reclus.nhh.no>
Message-ID: <C214676A.16C5F%jgreenberg@arc.nasa.gov>

Our primary developer for starspan (I designed the program, but did none of
the coding) has since moved on to bigger and better things, but I would
LOVE to get some help getting starspan cleaned up so it can be a GRASS
add-on.  If anyone is interested, please send me an email about it --
ultimately I'd like to write this up for a short paper in Computers and
Geosciences, and I'd be happy to make anyone who wants to take over the
coding aspect a co-author...

--j

(P.S. Email me at greenberg at ucdavis.edu, I need to update my email on this
listserv)


On 3/7/07 12:33 PM, "Roger Bivand" <Roger.Bivand at nhh.no> wrote:

> On Wed, 7 Mar 2007, Schmitt Thierry wrote:
> 
>> I am struggling to overlay spatialLinesDataFrame and
>> SpatialGridDataFrame. The overlay method doesn't allow me to do so.
>> 
> 
> There is no overlay method, you would need to write one, or interpolate
> points along your lines and overlay the resulting point object on the
> raster.
> 
>> As mentioned by matt, I might have a look at starspan. However, I might
>> be interested to have some solution within the Grass/R interface
> 
> Could I suggest that you try v.to.rast in GRASS, and simply use multiple
> rasters? You may need care with the resolution, but in spearfish:
> 
> v.to.rast input=roads output=v_roads use=cat
> 
> then in R:
> 
> library(spgrass6)
> sp <- readRAST6(c("v_roads", "elevation.dem"))
> summary(sp)
> sp1 <- as(sp, "SpatialPixelsDataFrame")
> summary(sp1)
> sp2 <- sp1[!is.na(sp1$v_roads),]
> summary(sp2)
> by(sp2$elevation.dem, sp2$v_roads, summary)
> 
> which just preserves the raster cells crossed by roads as defined by
> v.to.rast.
> 
> Hope this helps,
> 
> Roger
> 
>> 
>> Thierry
>> 
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> 


-- 
Jonathan A. Greenberg, PhD
Postdoctoral Scholar
Center for Spatial Technologies and Remote Sensing (CSTARS)
University of California, Davis
One Shields Avenue
The Barn, Room 250N
Davis, CA 95616
Cell: 415-794-5043
AIM: jgrn307
MSN: jgrn307 at hotmail.com



From e.pebesma at geo.uu.nl  Wed Mar  7 22:33:28 2007
From: e.pebesma at geo.uu.nl (Edzer J. Pebesma)
Date: Wed, 07 Mar 2007 22:33:28 +0100
Subject: [R-sig-Geo] comparing raster and vector data with Grass/R
In-Reply-To: <Pine.LNX.4.44.0703072112450.6690-100000@reclus.nhh.no>
References: <Pine.LNX.4.44.0703072112450.6690-100000@reclus.nhh.no>
Message-ID: <45EF2FA8.6060403@geo.uu.nl>

Roger Bivand wrote:
> On Wed, 7 Mar 2007, Schmitt Thierry wrote:
>
>   
>> I am struggling to overlay spatialLinesDataFrame and
>> SpatialGridDataFrame. The overlay method doesn't allow me to do so.
>>
>>     
>
> There is no overlay method, you would need to write one, or interpolate 
> points along your lines and overlay the resulting point object on the 
> raster.
>
>   

There is an spsample method for lines which returns points, on random or 
regular intervals. You could then overlay these points.

What exactly did you have in mind an overlay function for lines and 
grids would do? In "Geographic information analysis" David O'Sullivan 
and David Unwin suggest that any two types of spatial data can be 
overlaid, leaving finding of examples as an example to the reader. I'm 
still struggling with a few!
--
Edzer



From pmagdon at gwdg.de  Thu Mar  8 14:58:37 2007
From: pmagdon at gwdg.de (Paul Magdon)
Date: Thu, 8 Mar 2007 14:58:37 +0100 (CET)
Subject: [R-sig-Geo] converting dataframe to rasterformate
Message-ID: <1589.134.76.192.73.1173362317.squirrel@mailbox.gwdg.de>

Hello,
I'm using R for classifying remote sensed data. I finally managed to apply
different knn-methods to the data. Now I have a Dataframe with X, Y, and Z
columns.
Exp.:
  X             Y       Z
475477.1  7485303.29  46.62


Is there an easy way to export such dataframe into am Esri compatible
format like Arcgrid, img, tiff etc.??


Many thanks,

Paul



From Roger.Bivand at nhh.no  Thu Mar  8 15:19:50 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 8 Mar 2007 15:19:50 +0100 (CET)
Subject: [R-sig-Geo] converting dataframe to rasterformate
In-Reply-To: <1589.134.76.192.73.1173362317.squirrel@mailbox.gwdg.de>
Message-ID: <Pine.LNX.4.44.0703081505190.8325-100000@reclus.nhh.no>

On Thu, 8 Mar 2007, Paul Magdon wrote:

> Hello,
> I'm using R for classifying remote sensed data. I finally managed to apply
> different knn-methods to the data. Now I have a Dataframe with X, Y, and Z
> columns.
> Exp.:
>   X             Y       Z
> 475477.1  7485303.29  46.62
> 
> 
> Is there an easy way to export such dataframe into am Esri compatible
> format like Arcgrid, img, tiff etc.??
> 

Yes, for example:

library(sp)
data(meuse.grid)
class(meuse.grid)
names(meuse.grid)
coordinates(meuse.grid) <- c("x", "y")
class(meuse.grid)
gridded(meuse.grid) <- TRUE 
class(meuse.grid)
fullgrid(meuse.grid) <- TRUE
class(meuse.grid)
library(rgdal)
writeGDAL(meuse.grid["dist"], "dist.tif", drivername="GTiff")

This of course will not work if the points are not regularly spaced; 
there are plenty of different drivers for GDAL. For OSX either install 
rgdal on GDAL/PROJ.4 from source (see Rgeo site linked from Spatial Task 
View on CRAN for details) or write an Arc ASCII grid using 
writeAsciiGrid() in the maptools package, which does not depend on 
external libraries.

Roger

> 
> Many thanks,
> 
> Paul
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From pmagdon at gwdg.de  Thu Mar  8 17:50:58 2007
From: pmagdon at gwdg.de (Paul Magdon)
Date: Thu, 8 Mar 2007 17:50:58 +0100 (CET)
Subject: [R-sig-Geo] converting dataframe to rasterformate
Message-ID: <3321.84.132.215.169.1173372658.squirrel@web-mailer.gwdg.de>

First of all thank you very much for this comments.

As you already stated the points have to be regular spaced.
I expected them to be regular, because the dataset was created with the
pixel to ascii function within Erdas Imagine.
But I got the following error notice:


gridded(qb.train) <- TRUE
suggested tolerance minimum: 0.838128330817305Fehler in
points2grid(points, tolerance) : dimension 1 : coordinate intervals are
not constant

How can they become irregular, I was not changing the X &Y columns?

Paul



Roger Bivand schrieb:
> On Thu, 8 Mar 2007, Paul Magdon wrote:
>
>> Hello,
>> I'm using R for classifying remote sensed data. I finally managed to apply
>> different knn-methods to the data. Now I have a Dataframe with X, Y, and Z
>> columns.
>> Exp.:
>>   X             Y       Z
>> 475477.1  7485303.29  46.62
>>
>>
>> Is there an easy way to export such dataframe into am Esri compatible
>> format like Arcgrid, img, tiff etc.??
>>
>
> Yes, for example:
>
> library(sp)
> data(meuse.grid)
> class(meuse.grid)
> names(meuse.grid)
> coordinates(meuse.grid) <- c("x", "y")
> class(meuse.grid)
> gridded(meuse.grid) <- TRUE
> class(meuse.grid)
> fullgrid(meuse.grid) <- TRUE
> class(meuse.grid)
> library(rgdal)
> writeGDAL(meuse.grid["dist"], "dist.tif", drivername="GTiff")
>
> This of course will not work if the points are not regularly spaced;
> there are plenty of different drivers for GDAL. For OSX either install
> rgdal on GDAL/PROJ.4 from source (see Rgeo site linked from Spatial Task
> View on CRAN for details) or write an Arc ASCII grid using
> writeAsciiGrid() in the maptools package, which does not depend on
> external libraries.
>
> Roger
>
>> Many thanks,
>>
>> Paul
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>

--



From e.pebesma at geo.uu.nl  Thu Mar  8 19:28:16 2007
From: e.pebesma at geo.uu.nl (Edzer J. Pebesma)
Date: Thu, 08 Mar 2007 19:28:16 +0100
Subject: [R-sig-Geo] converting dataframe to rasterformate
In-Reply-To: <3321.84.132.215.169.1173372658.squirrel@web-mailer.gwdg.de>
References: <3321.84.132.215.169.1173372658.squirrel@web-mailer.gwdg.de>
Message-ID: <45F055C0.8070801@geo.uu.nl>

Paul, that is hard to see from here. Perhaps you could make the points 
available? Is the grid aligned with x and y? Did something happen with 
(re)projection inbetween?
--
Edzer

Paul Magdon wrote:

>First of all thank you very much for this comments.
>
>As you already stated the points have to be regular spaced.
>I expected them to be regular, because the dataset was created with the
>pixel to ascii function within Erdas Imagine.
>But I got the following error notice:
>
>
>gridded(qb.train) <- TRUE
>suggested tolerance minimum: 0.838128330817305Fehler in
>points2grid(points, tolerance) : dimension 1 : coordinate intervals are
>not constant
>
>How can they become irregular, I was not changing the X &Y columns?
>
>Paul
>
>
>
>Roger Bivand schrieb:
>  
>
>>On Thu, 8 Mar 2007, Paul Magdon wrote:
>>
>>    
>>
>>>Hello,
>>>I'm using R for classifying remote sensed data. I finally managed to apply
>>>different knn-methods to the data. Now I have a Dataframe with X, Y, and Z
>>>columns.
>>>Exp.:
>>>  X             Y       Z
>>>475477.1  7485303.29  46.62
>>>
>>>
>>>Is there an easy way to export such dataframe into am Esri compatible
>>>format like Arcgrid, img, tiff etc.??
>>>
>>>      
>>>
>>Yes, for example:
>>
>>library(sp)
>>data(meuse.grid)
>>class(meuse.grid)
>>names(meuse.grid)
>>coordinates(meuse.grid) <- c("x", "y")
>>class(meuse.grid)
>>gridded(meuse.grid) <- TRUE
>>class(meuse.grid)
>>fullgrid(meuse.grid) <- TRUE
>>class(meuse.grid)
>>library(rgdal)
>>writeGDAL(meuse.grid["dist"], "dist.tif", drivername="GTiff")
>>
>>This of course will not work if the points are not regularly spaced;
>>there are plenty of different drivers for GDAL. For OSX either install
>>rgdal on GDAL/PROJ.4 from source (see Rgeo site linked from Spatial Task
>>View on CRAN for details) or write an Arc ASCII grid using
>>writeAsciiGrid() in the maptools package, which does not depend on
>>external libraries.
>>
>>Roger
>>
>>    
>>
>>>Many thanks,
>>>
>>>Paul
>>>
>>>_______________________________________________
>>>R-sig-Geo mailing list
>>>R-sig-Geo at stat.math.ethz.ch
>>>https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>>      
>>>
>
>--
>
>_______________________________________________
>R-sig-Geo mailing list
>R-sig-Geo at stat.math.ethz.ch
>https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>  
>



From william.espenshadeiii at villanova.edu  Sat Mar 10 01:25:04 2007
From: william.espenshadeiii at villanova.edu (William EspenshadeIII)
Date: Fri, 09 Mar 2007 19:25:04 -0500
Subject: [R-sig-Geo] Seeking local help
Message-ID: <cf089eac545b.545bcf089eac@villanova.edu>

Hi All,

I am new to R, and would like to speak with someone on the phone or in 
person about it's use.  

I've read a great deal of the .pdf's that come packaged with the 
program, and still have not found enough of what I would like to 
know.  It seems a few minutes conversation with a versed R user would 
be a great help.

I have general questions, and specific about the heir.part module.

I'm at Villanova University in the Philadelphia PA, USA - part of the 
world.

My phone is 215-483-7675, most often after 2:30 pm weekdays works best.

Or please let me call you.  I'd be happy to sponsor a local 
conversation at the tavern of your choice.

Thanks, kind regards.
Will Espenshade



From Roger.Bivand at nhh.no  Sat Mar 10 08:59:27 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sat, 10 Mar 2007 08:59:27 +0100 (CET)
Subject: [R-sig-Geo] Seeking local help
In-Reply-To: <cf089eac545b.545bcf089eac@villanova.edu>
Message-ID: <Pine.LNX.4.44.0703100844340.10064-100000@reclus.nhh.no>

William,

The chance that a spatial search will place experienced users of the
contributed heir.part package (not revised since November 2005) close to
you is not large, given that (then) both authors were at Monash in
Australia. Please consider contacting them directly with your question,
the email addresses are in:

http://cran.r-project.org/doc/packages/hier.part.pdf

The regular R-help list sometimes has ads for paid courses, 
xlsolutions-corp.com had one March 8. 

Good luck!

Roger

On Fri, 9 Mar 2007, William EspenshadeIII wrote:

> Hi All,
> 
> I am new to R, and would like to speak with someone on the phone or in 
> person about it's use.  
> 
> I've read a great deal of the .pdf's that come packaged with the 
> program, and still have not found enough of what I would like to 
> know.  It seems a few minutes conversation with a versed R user would 
> be a great help.
> 
> I have general questions, and specific about the heir.part module.
> 
> I'm at Villanova University in the Philadelphia PA, USA - part of the 
> world.
> 
> My phone is 215-483-7675, most often after 2:30 pm weekdays works best.
> 
> Or please let me call you.  I'd be happy to sponsor a local 
> conversation at the tavern of your choice.
> 
> Thanks, kind regards.
> Will Espenshade
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From epistat at gmail.com  Mon Mar 12 14:52:08 2007
From: epistat at gmail.com (zhijie zhang)
Date: Mon, 12 Mar 2007 21:52:08 +0800
Subject: [R-sig-Geo] extract the projected coordinates after reading a
	shapefie?
Message-ID: <2fc17e30703120652y7fc4518chc0015b9159005556@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20070312/f25d8c05/attachment.pl>

From Roger.Bivand at nhh.no  Mon Mar 12 15:01:32 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 12 Mar 2007 15:01:32 +0100 (CET)
Subject: [R-sig-Geo] extract the projected coordinates after reading a
 shapefie?
In-Reply-To: <2fc17e30703120652y7fc4518chc0015b9159005556@mail.gmail.com>
Message-ID: <Pine.LNX.4.44.0703121458400.5797-100000@reclus.nhh.no>

On Mon, 12 Mar 2007, zhijie zhang wrote:

> Dear friends,
>   I use the function read.shape(maptools) to read a projected shapefile
> successfully, but  i need extract the coordinates after projected.

read.shape() is a low-level function that is not well suited to this. For 
a one-liner, please try:

coordinates(readShapePoints("d:/Export_Out2put.shp"))

which reads the shapefile into a SpatialPointsDataFrame, and then uses the 
coordinates() method to extract a 2 or 3 column matrix of coordinates, 
depending on whether a Z column was given in the shapefile.

Hope this helps,

Roger

> Programs:  x<-read.shape("d:/Export_Out2put.shp")   #read the projected
> shapefile
> Part of the Resutls:
> Shapefile type: Point, (1), # of Shapes: 83
> > x
> $Shapes
> [[1]]
> [[1]]$Pstart
> integer(0)
> 
> *[[1]]$verts
>          [,1]    [,2]
> [1,] 542250.9 3392404*
> 
> [[1]]$shp.type
> [1] 1
> 
> [[1]]$nVerts
> [1] 1
> 
> [[1]]$nParts
> [1] 0
> 
> [[1]]$bbox
> [1]  542250.9 3392404.1  542250.9 3392404.1
> 
> [[1]]$shpID
> [1] 0
> 
> attr(,"nVerts")
> [1] 1
> attr(,"nParts")
> [1] 0
> attr(,"shp.type")
> [1] 1
> attr(,"bbox")
> [1]  542250.9 3392404.1  542250.9 3392404.1
> 
> [[2]]
> [[2]]$Pstart
> integer(0)
> 
> *[[2]]$verts
>          [,1]    [,2]
> [1,] 542250.9 3392404*
> 
> [[2]]$shp.type
> [1] 1
> 
> [[2]]$nVerts
> [1] 1
> 
> [[2]]$nParts
> [1] 0
> 
> [[2]]$bbox
> [1]  542250.9 3392404.1  542250.9 3392404.1
> 
> [[2]]$shpID
> [1] 1
> 
> attr(,"nVerts")
> [1] 1
> attr(,"nParts")
> [1] 0
> attr(,"shp.type")
> [1] 1
> attr(,"bbox")
> [1]  542250.9 3392404.1  542250.9 3392404.1
> 
> [[3]]
> [[3]]$Pstart
> integer(0)
> 
> *[[3]]$verts
>          [,1]    [,2]
> [1,] 542250.9 3392404*
> 
> [[3]]$shp.type
> [1] 1
> 
> [[3]]$nVerts
> [1] 1
> 
> [[3]]$nParts
> [1] 0
> 
> [[3]]$bbox
> [1]  542250.9 3392404.1  542250.9 3392404.1
> 
> [[3]]$shpID
> [1] 2
> 
> attr(,"nVerts")
> [1] 1
> attr(,"nParts")
> [1] 0
> attr(,"shp.type")
> [1] 1
> attr(,"bbox")
> [1]  542250.9 3392404.1  542250.9 3392404.1
> 
> ...................................
> attr(,"class")
> [1] "ShapeList"
> 
> $att.data
>       id    lat          long     renkou year month monthnum
> 1   1 30.65134 117.4408   3270 2004     8      535
> 2   2 30.65134 117.4408   3270 2004    10      537
> 3   3 30.65134 117.4408   3270 2001     9      500
> 4   4 30.61479 117.4048   2201 2002     9      512
> 5   5 30.61479 117.4048   2201 2002     9      512
> 
> -----------------------------------------------------
>  *From the above results, i think the following data should be the
> coordinates after projected, how to extract all of them?
> *[[1]]$verts
>          [,1]    [,2]
> [1,] 542250.9 3392404
> 
> [[2]]$verts
>          [,1]    [,2]
> [1,] 542250.9 3392404
> 
> [[3]]$verts
>          [,1]    [,2]
> [1,] 542250.9 3392404
> 
> 
> I have tried several methods, but failed. The best results that i want are
> like:
> 
>    id    lat         long    renkou year month monthnum      * proj.lat
> proj.long*
> 1   1 30.65134 117.4408   3270 2004     8      535
> 2   2 30.65134 117.4408   3270 2004    10      537
> 3   3 30.65134 117.4408   3270 2001     9      500
> 
> Thanks for your information.
> 
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From cavallini at faunalia.it  Tue Mar 13 09:25:12 2007
From: cavallini at faunalia.it (Paolo Cavallini)
Date: Tue, 13 Mar 2007 09:25:12 +0100
Subject: [R-sig-Geo] review
Message-ID: <45F65FE8.1040809@faunalia.it>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Hi all.
I am associate editor for an international journal on wildlife ecology
and management. I recently received a paper on the spatial prediction by
use of logistic regressions and gis, and would like if someone with good
spatial statistical background could revise it.
If anybody on the list is interested, please contact me directly.
All best wishes.
pc
- --
Paolo Cavallini
email+jabber: cavallini at faunalia.it
www.faunalia.it
Piazza Garibaldi 5 - 56025 Pontedera (PI), Italy   Tel: (+39)348-3801953
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.6 (GNU/Linux)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org

iD8DBQFF9l/n/NedwLUzIr4RAv2bAJ9s9sQTcPvkxm+8FiPcN25gIFgC4QCfb0T9
QZK+6iZcuON2Kun1xtTK5Ec=
=0nn4
-----END PGP SIGNATURE-----



From friendly at yorku.ca  Tue Mar 13 21:03:36 2007
From: friendly at yorku.ca (Michael Friendly)
Date: Tue, 13 Mar 2007 15:03:36 -0500
Subject: [R-sig-Geo] circular window for spatial statistics (spatstat
	package)
Message-ID: <45F70398.4020606@yorku.ca>

Hi list,

A biology student I'm trying to help has done a study planting 20 seeds 
in circular pots under varying conditions and wants to analyze the 
degree of clustering
(and other measures) in the seeds that germinate (0-20) in relation to
the factors that differentiate pots (treatment, type of seed, ...)

The data structure is something like a data frame for all the 
germinating seeds, recording (X,Y) location and maybe some other
measure like size after xx days:

PotID Treatment SeedType  X    Y  size

Assume that the (X,Y) locations are referred to a circle of fixed radius, R.
I'm not very familiar with analysis of spatial point processes, but it 
seems that the spatstat package could handle this.  (Is there something
better?)  I've read the documentation, but can't find an example of how 
to specify a circular window for the ppp object that would contain the
data and the window.

thanks,
-Michael

-- 
Michael Friendly     Email: friendly AT yorku DOT ca
Professor, Psychology Dept.
York University      Voice: 416 736-5115 x66249 Fax: 416 736-5814
4700 Keele Street    http://www.math.yorku.ca/SCS/friendly.html
Toronto, ONT  M3J 1P3 CANADA



From Roger.Bivand at nhh.no  Tue Mar 13 21:17:11 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 13 Mar 2007 21:17:11 +0100 (CET)
Subject: [R-sig-Geo] circular window for spatial statistics (spatstat
 package)
In-Reply-To: <45F70398.4020606@yorku.ca>
Message-ID: <Pine.LNX.4.44.0703132108540.10818-100000@reclus.nhh.no>

On Tue, 13 Mar 2007, Michael Friendly wrote:

> Hi list,
> 
> A biology student I'm trying to help has done a study planting 20 seeds 
> in circular pots under varying conditions and wants to analyze the 
> degree of clustering
> (and other measures) in the seeds that germinate (0-20) in relation to
> the factors that differentiate pots (treatment, type of seed, ...)
> 
> The data structure is something like a data frame for all the 
> germinating seeds, recording (X,Y) location and maybe some other
> measure like size after xx days:
> 
> PotID Treatment SeedType  X    Y  size
> 
> Assume that the (X,Y) locations are referred to a circle of fixed radius, R.
> I'm not very familiar with analysis of spatial point processes, but it 
> seems that the spatstat package could handle this.  (Is there something
> better?)  I've read the documentation, but can't find an example of how 
> to specify a circular window for the ppp object that would contain the
> data and the window.

Maybe March is a circular month? There was a thread on this recently:

http://article.gmane.org/gmane.comp.lang.r.geo/1320

refering to John Fox's original:

http://finzi.psych.upenn.edu/R/Rhelp02a/archive/74907.html

For a single pot, you'd need an owin object in the coordinate system of 
the X,Y, best if the pot centre and radius were recorded. Then the 
locations of the germinated seeds in each pot would become a ppp object 
with a known owin (generated as a circumference sequence). Should the 
clustering measure be at the seed observation or the pot plot level?

Hope this helps,

Roger 

> 
> thanks,
> -Michael
> 
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From thierry_schmitt at yahoo.com  Tue Mar 13 22:45:55 2007
From: thierry_schmitt at yahoo.com (Schmitt Thierry)
Date: Tue, 13 Mar 2007 14:45:55 -0700 (PDT)
Subject: [R-sig-Geo] graph plotting from spatialgriddataframe
Message-ID: <259743.28438.qm@web35604.mail.mud.yahoo.com>

Following my question about comparing vectors and raster data, I would be keen on getting more insights.

Here are the fact:

I have converted the vector file (interpretation from underwater camera) to be compared with the raster file (morphometric classification from a multibeam sonar survey) using v.to.rast
Using Mapcalc I have extracted grid cells from the multibeam raster along the resulting v.to.rast "transect".
Both datasets were then imported in R using readRast6

My main aim now is simply to plot on 2d graph each variable and then compute a regression.


If any body can put me on tracks (i.e. suggesting the function to use), it will be more than welcome.

Regards and thanks to the GRASS / R community.

Thierry



From Roger.Bivand at nhh.no  Tue Mar 13 23:14:58 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 13 Mar 2007 23:14:58 +0100 (CET)
Subject: [R-sig-Geo] graph plotting from spatialgriddataframe
In-Reply-To: <259743.28438.qm@web35604.mail.mud.yahoo.com>
Message-ID: <Pine.LNX.4.44.0703132307130.10818-100000@reclus.nhh.no>

On Tue, 13 Mar 2007, Schmitt Thierry wrote:

> Following my question about comparing vectors and raster data, I would be keen on getting more insights.
> 
> Here are the fact:
> 
> I have converted the vector file (interpretation from underwater camera)
> to be compared with the raster file (morphometric classification from a
> multibeam sonar survey) using v.to.rast Using Mapcalc I have extracted
> grid cells from the multibeam raster along the resulting v.to.rast
> "transect". Both datasets were then imported in R using readRast6
> 
> My main aim now is simply to plot on 2d graph each variable and then
> compute a regression.

So far so good. The object you have imported is a SpatialGridDataFrame, 
and you can see what is inside it with the summary() method. The next step 
will be to see if there are NAs (not available, missing values), because 
they will affect the regression. The summary() method will say how many 
NAs are present in each variable. If the numbers are identical for all the 
variables - and the NAs are for the same raster cells, you can coerce the 
object to SpatialPixelsDataFrame. But first, check the NAs.

Once that is done, the plots will be plot(y ~ x, data=obj), and regression 
will be lm(y ~ x, data=obj), that is using the formula approach to 
relationships between variables. For more on plot() and lm(), see the 
Introduction to R included with the distribution.

Hope this helps,

Roger

> 
> 
> If any body can put me on tracks (i.e. suggesting the function to use),
> it will be more than welcome.
> 
> Regards and thanks to the GRASS / R community.
> 
> Thierry
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From ggrothendieck at gmail.com  Wed Mar 14 06:27:24 2007
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Wed, 14 Mar 2007 01:27:24 -0400
Subject: [R-sig-Geo] Principal Directions with surf.ls
Message-ID: <971536df0703132227n4bb9beebra145367b0b8ec9ac@mail.gmail.com>

Suppose we plot a quadratic surface as in:

library(spatial)
example(surf.ls)

How can we plot lines on the graph to show the
principal directions/axes of the elliptical contours
and how do we get them?

Thanks.



From Roger.Bivand at nhh.no  Wed Mar 14 09:25:19 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 14 Mar 2007 09:25:19 +0100 (CET)
Subject: [R-sig-Geo] Principal Directions with surf.ls
In-Reply-To: <971536df0703132227n4bb9beebra145367b0b8ec9ac@mail.gmail.com>
Message-ID: <Pine.LNX.4.44.0703140840280.11582-100000@reclus.nhh.no>

On Wed, 14 Mar 2007, Gabor Grothendieck wrote:

> Suppose we plot a quadratic surface as in:
> 
> library(spatial)
> example(surf.ls)
> 
> How can we plot lines on the graph to show the
> principal directions/axes of the elliptical contours
> and how do we get them?

In the example there are no closed ellipses, with an open, north-facing 
depression with flow from the west, south-west, south, south-east and 
east towards the north at the centre of the northern edge.

The contour lines can be retrieved with contourLines() on the same object
as contour() is used on. However, they are just a generalised
visualisation of the surface represented by the matrix. The underlying 
question might then be: what is the aspect and slope of the surface, in 
this case a smoothed surface, what are the plan and especially profile 
curvatures, and what are their length attributes (ie. patches of similar 
aspect along a profile curvature.

In GIS terms this would involve geomorphometrics, often computed using a 3 
x 3 filter, and then flow analysis to find the directions (on a digital 
elevation model, these would be similar to predicting drainage channel 
networks. Landslip and avalanche studies often need slope length too, 
which involves measuring patch characteristics in aspect and profile 
curvature - that is extracting patches with interesting pattern 
signatures, and checking whether the patch is "straight" in some sense, 
and longer than a minimum accumulation threshold to feed mass movement. 

These are general observations in the case that we don't have a smoothed 
surface. But here we have a model, and I'd guess that the underlying model 
could be used, rather than its predictions. 

I couldn't see a package with a vector field plot, there was a suggestion 
in:

http://finzi.psych.upenn.edu/R/Rhelp02a/archive/35933.html

but you'd still need the slope and aspect to get the length and direction 
of the arrows (for display only). A classic reference is:

Horn, B. K. P. (1981). Hill Shading and the Reflectance Map, Proceedings 
of the IEEE, 69(1): 14-47

and Horn's algorithm has stood the test of time, as has Zevenbergen and 
Thorne:

Zevenbergen, L. W., Thorne, C. R. 1987. Quantitative analysis of land
surface topography. Earth Surface Processes and Landforms, 12 (1), 4756.

It could well be that the surface you are considering is something other 
than elevation (temperature, etc.), but getting further would depend on 
the specific characteristics of the study, and whether the surface is a 
fitted trend surface or not. With a fitted trend surface model, it ought 
to be possible to use the model. If thinking in terms of geomorphometrics 
is unhelpful, please accept that geographers "see" things in those kinds 
of ways!

Hope this helps,

Roger

> 
> Thanks.
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From e.pebesma at geo.uu.nl  Wed Mar 14 10:18:24 2007
From: e.pebesma at geo.uu.nl (Edzer J. Pebesma)
Date: Wed, 14 Mar 2007 10:18:24 +0100
Subject: [R-sig-Geo] line segments of boundaries
Message-ID: <45F7BDE0.1070307@geo.uu.nl>

Hi,

Is there an R package/function that, given a set of polygons (say 
country boundaries) finds the line set of lines that defines the 
boundary for each pair of neighbouring countries?
--
Edzer



From Roger.Bivand at nhh.no  Wed Mar 14 10:42:14 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 14 Mar 2007 10:42:14 +0100 (CET)
Subject: [R-sig-Geo] line segments of boundaries
In-Reply-To: <45F7BDE0.1070307@geo.uu.nl>
Message-ID: <Pine.LNX.4.44.0703141021290.11582-100000@reclus.nhh.no>

On Wed, 14 Mar 2007, Edzer J. Pebesma wrote:

> Hi,
> 
> Is there an R package/function that, given a set of polygons (say 
> country boundaries) finds the line set of lines that defines the 
> boundary for each pair of neighbouring countries?

poly2nb() in spdep only finds *polygons* sharing one/two boundary points,
it does not do the topology by breaking the polygons into arcs and nodes.  

If you need the topology, I suggest that you establish a GRASS location,
read the vector polygons into GRASS 6, best 6.3 CVS, which will build the
topology - it may need cleaning and repair - then look at vect2neigh() in 
the spgrass6 package. This does most of what is needed to retrieve IDs of 
neighbouring polygons, and the length of their boundaries. If I recall 
correctly, it aggregates multiple boundaries between the same pair of 
polygons, which may not suit your case. The ideas and changes in GRASS 
were made by Markus Neteler.

Roger

> --
> Edzer
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From Thierry.ONKELINX at inbo.be  Wed Mar 14 12:03:01 2007
From: Thierry.ONKELINX at inbo.be (ONKELINX, Thierry)
Date: Wed, 14 Mar 2007 12:03:01 +0100
Subject: [R-sig-Geo] Plotting data with multiple symbols and colours
Message-ID: <2E9C414912813E4EB981326983E0A10402B368AA@inboexch.inbo.be>

Dear listeRs,

We're trying to create a map with interpolation errors of some spatial
data. The idea is to plot the errors at the location of the data, with a
"+" or "-" symbol to indicate whether they are positive or negative and
a colour ramp that indicates the magnitude of the error. For now, we
managed to get a plot with the correct symbols. But the colour ramp only
works for the positive errors. The code to generate this:

library("sp")
library("RColorBrewer")
library("lattice")
set.seed(1)
Error <- SpatialPointsDataFrame(matrix(runif(1000), ncol = 2), data =
data.frame(error = runif(500, -10, 10)))
trellis.par.set(sp.theme(set = FALSE, regions = list(col = c(rainbow(50,
start = 0, end = 4/6), rev(rainbow(50, start = 0, end = 4/6))))))
spplot(Error[Error$error >= 0, ], zcol = "error", sp.layout =
list("sp.points", Error[Error$error < 0, ], pch = 95), key.space =
"right", cuts = seq(-10, 10, length = 21), pch = 3)

The questions:
1. For do we set the colour ramp for the negative values?
2. Can we change the key so it displays only absolute values or "-" in
front of the negative values?

All help is welcome.

Thierry

------------------------------------------------------------------------
----
ir. Thierry Onkelinx
Instituut voor natuur- en bosonderzoek / Reseach Institute for Nature
and Forest
Cel biometrie, methodologie en kwaliteitszorg / Section biometrics,
methodology and quality assurance
Gaverstraat 4
9500 Geraardsbergen
Belgium
tel. + 32 54/436 185
Thierry.Onkelinx at inbo.be
www.inbo.be 
 

Do not put your faith in what statistics say until you have carefully
considered what they do not say.  ~William W. Watt
A statistical analysis, properly conducted, is a delicate dissection of
uncertainties, a surgery of suppositions. ~M.J.Moroney



From e.pebesma at geo.uu.nl  Wed Mar 14 13:40:07 2007
From: e.pebesma at geo.uu.nl (Edzer J. Pebesma)
Date: Wed, 14 Mar 2007 13:40:07 +0100
Subject: [R-sig-Geo] Plotting data with multiple symbols and colours
In-Reply-To: <2E9C414912813E4EB981326983E0A10402B368AA@inboexch.inbo.be>
References: <2E9C414912813E4EB981326983E0A10402B368AA@inboexch.inbo.be>
Message-ID: <45F7ED27.8090000@geo.uu.nl>

I would try the alternative,

bubble(Error,maxsize=1.5)
bubble(Error,maxsize=1.5, key.entries=-10:10)

Doing what you want with spplot, you're basically thrown back at xyplot 
with asp="iso"; look at how key is formed there; with

spplot(Error, pch = ifelse(Error$error < 0, 95, 3), key.space = "right", 
cuts = -10:10)

I get funny pch changes in the key. I think that spplot passes an 
optional key argument to xyplot.
--
Edzer

ONKELINX, Thierry wrote:
> Dear listeRs,
>
> We're trying to create a map with interpolation errors of some spatial
> data. The idea is to plot the errors at the location of the data, with a
> "+" or "-" symbol to indicate whether they are positive or negative and
> a colour ramp that indicates the magnitude of the error. For now, we
> managed to get a plot with the correct symbols. But the colour ramp only
> works for the positive errors. The code to generate this:
>
> library("sp")
> library("RColorBrewer")
> library("lattice")
> set.seed(1)
> Error <- SpatialPointsDataFrame(matrix(runif(1000), ncol = 2), data =
> data.frame(error = runif(500, -10, 10)))
> trellis.par.set(sp.theme(set = FALSE, regions = list(col = c(rainbow(50,
> start = 0, end = 4/6), rev(rainbow(50, start = 0, end = 4/6))))))
> spplot(Error[Error$error >= 0, ], zcol = "error", sp.layout =
> list("sp.points", Error[Error$error < 0, ], pch = 95), key.space =
> "right", cuts = seq(-10, 10, length = 21), pch = 3)
>
> The questions:
> 1. For do we set the colour ramp for the negative values?
> 2. Can we change the key so it displays only absolute values or "-" in
> front of the negative values?
>
> All help is welcome.
>
> Thierry
>
> ------------------------------------------------------------------------
> ----
> ir. Thierry Onkelinx
> Instituut voor natuur- en bosonderzoek / Reseach Institute for Nature
> and Forest
> Cel biometrie, methodologie en kwaliteitszorg / Section biometrics,
> methodology and quality assurance
> Gaverstraat 4
> 9500 Geraardsbergen
> Belgium
> tel. + 32 54/436 185
> Thierry.Onkelinx at inbo.be
> www.inbo.be 
>  
>
> Do not put your faith in what statistics say until you have carefully
> considered what they do not say.  ~William W. Watt
> A statistical analysis, properly conducted, is a delicate dissection of
> uncertainties, a surgery of suppositions. ~M.J.Moroney
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>



From Thierry.ONKELINX at inbo.be  Wed Mar 14 14:15:46 2007
From: Thierry.ONKELINX at inbo.be (ONKELINX, Thierry)
Date: Wed, 14 Mar 2007 14:15:46 +0100
Subject: [R-sig-Geo] Plotting data with multiple symbols and colours
In-Reply-To: <45F7ED27.8090000@geo.uu.nl>
Message-ID: <2E9C414912813E4EB981326983E0A10402B36999@inboexch.inbo.be>

Hi Edzer,

Thanks for your suggestions. Bubble() looks nice, but we are trying to
mimic the output from GSLIB. We're comparing R vs GSLIB, surfer and
VarioWin as a task in a course on spatial statistics. Our motto is:
"This is R. There is no if. Only how. (Simon Blomberg)" That's why we we
prefer your spplot solution.

The new code is:

library("sp")
library("RColorBrewer")
library("lattice")
set.seed(1)
Error <- SpatialPointsDataFrame(matrix(runif(1000), ncol = 2), data =
data.frame(error = runif(500, -10, 10)))
Error$sign <- sign(Error$error)
Error$abs <- abs(Error$error)
trellis.par.set(sp.theme(set = FALSE, regions = list(col =
rev(rainbow(50, start = 0, end = 4/6)))))
spplot(Error, zcol = "abs", pch = ifelse(Error$sign < 0, 95, 3),
key.space = "right", cuts = 0:10)

This is pretty much what we wanted. Except for the changes in pch in het
key. But I'll dig into xyplot and the source of spplot.

Thanks again,

Thierry

------------------------------------------------------------------------
----
ir. Thierry Onkelinx
Instituut voor natuur- en bosonderzoek / Reseach Institute for Nature
and Forest
Cel biometrie, methodologie en kwaliteitszorg / Section biometrics,
methodology and quality assurance
Gaverstraat 4
9500 Geraardsbergen
Belgium
tel. + 32 54/436 185
Thierry.Onkelinx at inbo.be
www.inbo.be 

Do not put your faith in what statistics say until you have carefully
considered what they do not say.  ~William W. Watt
A statistical analysis, properly conducted, is a delicate dissection of
uncertainties, a surgery of suppositions. ~M.J.Moroney

 

> -----Oorspronkelijk bericht-----
> Van: Edzer J. Pebesma [mailto:e.pebesma at geo.uu.nl] 
> Verzonden: woensdag 14 maart 2007 13:40
> Aan: ONKELINX, Thierry
> CC: r-sig-geo at stat.math.ethz.ch
> Onderwerp: Re: [R-sig-Geo] Plotting data with multiple 
> symbols and colours
> 
> I would try the alternative,
> 
> bubble(Error,maxsize=1.5)
> bubble(Error,maxsize=1.5, key.entries=-10:10)
> 
> Doing what you want with spplot, you're basically thrown back 
> at xyplot with asp="iso"; look at how key is formed there; with
> 
> spplot(Error, pch = ifelse(Error$error < 0, 95, 3), key.space 
> = "right", cuts = -10:10)
> 
> I get funny pch changes in the key. I think that spplot 
> passes an optional key argument to xyplot.
> --
> Edzer
> 
> ONKELINX, Thierry wrote:
> > Dear listeRs,
> >
> > We're trying to create a map with interpolation errors of 
> some spatial 
> > data. The idea is to plot the errors at the location of the 
> data, with 
> > a "+" or "-" symbol to indicate whether they are positive 
> or negative 
> > and a colour ramp that indicates the magnitude of the 
> error. For now, 
> > we managed to get a plot with the correct symbols. But the 
> colour ramp 
> > only works for the positive errors. The code to generate this:
> >
> > library("sp")
> > library("RColorBrewer")
> > library("lattice")
> > set.seed(1)
> > Error <- SpatialPointsDataFrame(matrix(runif(1000), ncol = 
> 2), data = 
> > data.frame(error = runif(500, -10, 10))) 
> trellis.par.set(sp.theme(set 
> > = FALSE, regions = list(col = c(rainbow(50, start = 0, end = 4/6), 
> > rev(rainbow(50, start = 0, end = 4/6)))))) 
> spplot(Error[Error$error >= 
> > 0, ], zcol = "error", sp.layout = list("sp.points", 
> Error[Error$error 
> > < 0, ], pch = 95), key.space = "right", cuts = seq(-10, 10, 
> length = 
> > 21), pch = 3)
> >
> > The questions:
> > 1. For do we set the colour ramp for the negative values?
> > 2. Can we change the key so it displays only absolute 
> values or "-" in 
> > front of the negative values?
> >
> > All help is welcome.
> >
> > Thierry
> >
> > 
> ----------------------------------------------------------------------
> > --
> > ----
> > ir. Thierry Onkelinx
> > Instituut voor natuur- en bosonderzoek / Reseach Institute 
> for Nature 
> > and Forest Cel biometrie, methodologie en kwaliteitszorg / Section 
> > biometrics, methodology and quality assurance Gaverstraat 4 9500 
> > Geraardsbergen Belgium tel. + 32 54/436 185 
> Thierry.Onkelinx at inbo.be 
> > www.inbo.be
> >  
> >
> > Do not put your faith in what statistics say until you have 
> carefully 
> > considered what they do not say.  ~William W. Watt A statistical 
> > analysis, properly conducted, is a delicate dissection of 
> > uncertainties, a surgery of suppositions. ~M.J.Moroney
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at stat.math.ethz.ch
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >   
> 
>



From andrew.niccolai at yale.edu  Wed Mar 14 15:13:44 2007
From: andrew.niccolai at yale.edu (Andrew Niccolai)
Date: Wed, 14 Mar 2007 10:13:44 -0400
Subject: [R-sig-Geo] Image J and R compatability
In-Reply-To: <Pine.LNX.4.44.0703132307130.10818-100000@reclus.nhh.no>
Message-ID: <200703141413.l2EEDrTO020840@pantheon-po14.its.yale.edu>

Hi.  I have written a few macros in Image J that allows me to output a
series of summary statistics after calling the "Analyze Particles" function
to run over a series of .tiff images that R created.  

My questions are the following:
1). Aside from Zooplankton software, is there a way within R to call for
ImageJ software to open and then execute the ImageJ macro.  I suppose I
would be willing to leave ImageJ open if I can have R "run" the macro.

2). Is there any R equivalent to ImageJ's Analyze Particles function? (This
function essentially finds the edges of pixel values above a certain
threshold and creates polygons around these isolated clusters).

Thanks for any assistance!

Andrew Niccolai
Doctoral Candidate
Yale School of Forestry
203-432-5144



From Roger.Bivand at nhh.no  Wed Mar 14 15:28:21 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 14 Mar 2007 15:28:21 +0100 (CET)
Subject: [R-sig-Geo] Image J and R compatability
In-Reply-To: <200703141413.l2EEDrTO020840@pantheon-po14.its.yale.edu>
Message-ID: <Pine.LNX.4.44.0703141517460.11582-100000@reclus.nhh.no>

On Wed, 14 Mar 2007, Andrew Niccolai wrote:

> Hi.  I have written a few macros in Image J that allows me to output a
> series of summary statistics after calling the "Analyze Particles" function
> to run over a series of .tiff images that R created.  
> 
> My questions are the following:
> 1). Aside from Zooplankton software, is there a way within R to call for
> ImageJ software to open and then execute the ImageJ macro.  I suppose I
> would be willing to leave ImageJ open if I can have R "run" the macro.

It might be worth seeing whether you can run the java through the rJava 
interface.

> 
> 2). Is there any R equivalent to ImageJ's Analyze Particles function? (This
> function essentially finds the edges of pixel values above a certain
> threshold and creates polygons around these isolated clusters).

Are the thresholds known already? Are the images large? My guess would be 
that once you can find the patches, that there ought to be ways. The 
current functions in sp and maptools for turning grid cells into polygons, 
then taking the union of cells with specific factor levels might be a way 
to go for a prototype, but will be slow for all but small grids. You might 
look at getting the grid centres of grid cells belonging to the patch, 
then using a trick in deldir to identify the external points (those with 
larger tesselation areas than the grid cell) - because a convex hull would 
miss concavities. You could set an aspatial threshold, and later drop 
patches that are too small.

I think there may be ideas in EBimage and rimage, possibly also in one or 
other of the medical imaging packages (AnalyseFMRI perhaps).

Roger

> 
> Thanks for any assistance!
> 
> Andrew Niccolai
> Doctoral Candidate
> Yale School of Forestry
> 203-432-5144
>  
> 
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From ggrothendieck at gmail.com  Wed Mar 14 15:35:05 2007
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Wed, 14 Mar 2007 10:35:05 -0400
Subject: [R-sig-Geo] Principal Directions with surf.ls
In-Reply-To: <Pine.LNX.4.44.0703140840280.11582-100000@reclus.nhh.no>
References: <971536df0703132227n4bb9beebra145367b0b8ec9ac@mail.gmail.com>
	<Pine.LNX.4.44.0703140840280.11582-100000@reclus.nhh.no>
Message-ID: <971536df0703140735v60d12d86l1d76801d557f0484@mail.gmail.com>

Thanks. I was hoping that either there were an existing
function or the components of the output of surf.ls were
sufficiently documented to allow one to do it oneself.

surf.ls seems to do all the real work in a C function
and I don't relish having to go through that but
since its just a regression I guess I can ditch surf.ls
and use lm in which case I can get the coefficients
explicitly and figure it out from there.

On 3/14/07, Roger Bivand <Roger.Bivand at nhh.no> wrote:
> On Wed, 14 Mar 2007, Gabor Grothendieck wrote:
>
> > Suppose we plot a quadratic surface as in:
> >
> > library(spatial)
> > example(surf.ls)
> >
> > How can we plot lines on the graph to show the
> > principal directions/axes of the elliptical contours
> > and how do we get them?
>
> In the example there are no closed ellipses, with an open, north-facing
> depression with flow from the west, south-west, south, south-east and
> east towards the north at the centre of the northern edge.
>
> The contour lines can be retrieved with contourLines() on the same object
> as contour() is used on. However, they are just a generalised
> visualisation of the surface represented by the matrix. The underlying
> question might then be: what is the aspect and slope of the surface, in
> this case a smoothed surface, what are the plan and especially profile
> curvatures, and what are their length attributes (ie. patches of similar
> aspect along a profile curvature.
>
> In GIS terms this would involve geomorphometrics, often computed using a 3
> x 3 filter, and then flow analysis to find the directions (on a digital
> elevation model, these would be similar to predicting drainage channel
> networks. Landslip and avalanche studies often need slope length too,
> which involves measuring patch characteristics in aspect and profile
> curvature - that is extracting patches with interesting pattern
> signatures, and checking whether the patch is "straight" in some sense,
> and longer than a minimum accumulation threshold to feed mass movement.
>
> These are general observations in the case that we don't have a smoothed
> surface. But here we have a model, and I'd guess that the underlying model
> could be used, rather than its predictions.
>
> I couldn't see a package with a vector field plot, there was a suggestion
> in:
>
> http://finzi.psych.upenn.edu/R/Rhelp02a/archive/35933.html
>
> but you'd still need the slope and aspect to get the length and direction
> of the arrows (for display only). A classic reference is:
>
> Horn, B. K. P. (1981). Hill Shading and the Reflectance Map, Proceedings
> of the IEEE, 69(1): 14-47
>
> and Horn's algorithm has stood the test of time, as has Zevenbergen and
> Thorne:
>
> Zevenbergen, L. W., Thorne, C. R. 1987. Quantitative analysis of land
> surface topography. Earth Surface Processes and Landforms, 12 (1), 4756.
>
> It could well be that the surface you are considering is something other
> than elevation (temperature, etc.), but getting further would depend on
> the specific characteristics of the study, and whether the surface is a
> fitted trend surface or not. With a fitted trend surface model, it ought
> to be possible to use the model. If thinking in terms of geomorphometrics
> is unhelpful, please accept that geographers "see" things in those kinds
> of ways!
>
> Hope this helps,
>
> Roger
>
> >
> > Thanks.
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at stat.math.ethz.ch
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
>
> --
> Roger Bivand
> Economic Geography Section, Department of Economics, Norwegian School of
> Economics and Business Administration, Helleveien 30, N-5045 Bergen,
> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no
>
>



From Roger.Bivand at nhh.no  Wed Mar 14 15:47:38 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 14 Mar 2007 15:47:38 +0100 (CET)
Subject: [R-sig-Geo] Principal Directions with surf.ls
In-Reply-To: <971536df0703140735v60d12d86l1d76801d557f0484@mail.gmail.com>
Message-ID: <Pine.LNX.4.44.0703141539110.11582-100000@reclus.nhh.no>

On Wed, 14 Mar 2007, Gabor Grothendieck wrote:

> Thanks. I was hoping that either there were an existing
> function or the components of the output of surf.ls were
> sufficiently documented to allow one to do it oneself.
> 
> surf.ls seems to do all the real work in a C function
> and I don't relish having to go through that but
> since its just a regression I guess I can ditch surf.ls
> and use lm in which case I can get the coefficients
> explicitly and figure it out from there.

There is one extra step that is necessary. It has been known since the 
1970's (D. Unwin, also Brian Ripley's 1981 book) that if the northings are 
in metres north of the equator, numerical problems cut in very fast when 
using trend surface, because the powers become very large numbers. 
Typically, for a small site, there will be no difference between y^2 and 
y^3, say, from the point of view of the computer. 

So the coordinates need to be scaled so that they do not explode, and both
the functions in spatial and in gstat for trend surface do this, in
surf.ls() by transforming both x and y coordinates to lie between +/-1.
Other than that, lm() ought to be fine. For blocks, it may be sufficient
just to go from m to km as the unit.

Roger

> 
> On 3/14/07, Roger Bivand <Roger.Bivand at nhh.no> wrote:
> > On Wed, 14 Mar 2007, Gabor Grothendieck wrote:
> >
> > > Suppose we plot a quadratic surface as in:
> > >
> > > library(spatial)
> > > example(surf.ls)
> > >
> > > How can we plot lines on the graph to show the
> > > principal directions/axes of the elliptical contours
> > > and how do we get them?
> >
> > In the example there are no closed ellipses, with an open, north-facing
> > depression with flow from the west, south-west, south, south-east and
> > east towards the north at the centre of the northern edge.
> >
> > The contour lines can be retrieved with contourLines() on the same object
> > as contour() is used on. However, they are just a generalised
> > visualisation of the surface represented by the matrix. The underlying
> > question might then be: what is the aspect and slope of the surface, in
> > this case a smoothed surface, what are the plan and especially profile
> > curvatures, and what are their length attributes (ie. patches of similar
> > aspect along a profile curvature.
> >
> > In GIS terms this would involve geomorphometrics, often computed using a 3
> > x 3 filter, and then flow analysis to find the directions (on a digital
> > elevation model, these would be similar to predicting drainage channel
> > networks. Landslip and avalanche studies often need slope length too,
> > which involves measuring patch characteristics in aspect and profile
> > curvature - that is extracting patches with interesting pattern
> > signatures, and checking whether the patch is "straight" in some sense,
> > and longer than a minimum accumulation threshold to feed mass movement.
> >
> > These are general observations in the case that we don't have a smoothed
> > surface. But here we have a model, and I'd guess that the underlying model
> > could be used, rather than its predictions.
> >
> > I couldn't see a package with a vector field plot, there was a suggestion
> > in:
> >
> > http://finzi.psych.upenn.edu/R/Rhelp02a/archive/35933.html
> >
> > but you'd still need the slope and aspect to get the length and direction
> > of the arrows (for display only). A classic reference is:
> >
> > Horn, B. K. P. (1981). Hill Shading and the Reflectance Map, Proceedings
> > of the IEEE, 69(1): 14-47
> >
> > and Horn's algorithm has stood the test of time, as has Zevenbergen and
> > Thorne:
> >
> > Zevenbergen, L. W., Thorne, C. R. 1987. Quantitative analysis of land
> > surface topography. Earth Surface Processes and Landforms, 12 (1), 4756.
> >
> > It could well be that the surface you are considering is something other
> > than elevation (temperature, etc.), but getting further would depend on
> > the specific characteristics of the study, and whether the surface is a
> > fitted trend surface or not. With a fitted trend surface model, it ought
> > to be possible to use the model. If thinking in terms of geomorphometrics
> > is unhelpful, please accept that geographers "see" things in those kinds
> > of ways!
> >
> > Hope this helps,
> >
> > Roger
> >
> > >
> > > Thanks.
> > >
> > > _______________________________________________
> > > R-sig-Geo mailing list
> > > R-sig-Geo at stat.math.ethz.ch
> > > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> > >
> >
> > --
> > Roger Bivand
> > Economic Geography Section, Department of Economics, Norwegian School of
> > Economics and Business Administration, Helleveien 30, N-5045 Bergen,
> > Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> > e-mail: Roger.Bivand at nhh.no
> >
> >
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From ggrothendieck at gmail.com  Wed Mar 14 17:30:03 2007
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Wed, 14 Mar 2007 12:30:03 -0400
Subject: [R-sig-Geo] Principal Directions with surf.ls
In-Reply-To: <Pine.LNX.4.44.0703141539110.11582-100000@reclus.nhh.no>
References: <971536df0703140735v60d12d86l1d76801d557f0484@mail.gmail.com>
	<Pine.LNX.4.44.0703141539110.11582-100000@reclus.nhh.no>
Message-ID: <971536df0703140930m4ac45a58taee9354b26322120@mail.gmail.com>

Thanks.  In my case the region of interest is no larger
than a city block so I fall into your simpler case.

On 3/14/07, Roger Bivand <Roger.Bivand at nhh.no> wrote:
> On Wed, 14 Mar 2007, Gabor Grothendieck wrote:
>
> > Thanks. I was hoping that either there were an existing
> > function or the components of the output of surf.ls were
> > sufficiently documented to allow one to do it oneself.
> >
> > surf.ls seems to do all the real work in a C function
> > and I don't relish having to go through that but
> > since its just a regression I guess I can ditch surf.ls
> > and use lm in which case I can get the coefficients
> > explicitly and figure it out from there.
>
> There is one extra step that is necessary. It has been known since the
> 1970's (D. Unwin, also Brian Ripley's 1981 book) that if the northings are
> in metres north of the equator, numerical problems cut in very fast when
> using trend surface, because the powers become very large numbers.
> Typically, for a small site, there will be no difference between y^2 and
> y^3, say, from the point of view of the computer.
>
> So the coordinates need to be scaled so that they do not explode, and both
> the functions in spatial and in gstat for trend surface do this, in
> surf.ls() by transforming both x and y coordinates to lie between +/-1.
> Other than that, lm() ought to be fine. For blocks, it may be sufficient
> just to go from m to km as the unit.
>
> Roger
>
> >
> > On 3/14/07, Roger Bivand <Roger.Bivand at nhh.no> wrote:
> > > On Wed, 14 Mar 2007, Gabor Grothendieck wrote:
> > >
> > > > Suppose we plot a quadratic surface as in:
> > > >
> > > > library(spatial)
> > > > example(surf.ls)
> > > >
> > > > How can we plot lines on the graph to show the
> > > > principal directions/axes of the elliptical contours
> > > > and how do we get them?
> > >
> > > In the example there are no closed ellipses, with an open, north-facing
> > > depression with flow from the west, south-west, south, south-east and
> > > east towards the north at the centre of the northern edge.
> > >
> > > The contour lines can be retrieved with contourLines() on the same object
> > > as contour() is used on. However, they are just a generalised
> > > visualisation of the surface represented by the matrix. The underlying
> > > question might then be: what is the aspect and slope of the surface, in
> > > this case a smoothed surface, what are the plan and especially profile
> > > curvatures, and what are their length attributes (ie. patches of similar
> > > aspect along a profile curvature.
> > >
> > > In GIS terms this would involve geomorphometrics, often computed using a 3
> > > x 3 filter, and then flow analysis to find the directions (on a digital
> > > elevation model, these would be similar to predicting drainage channel
> > > networks. Landslip and avalanche studies often need slope length too,
> > > which involves measuring patch characteristics in aspect and profile
> > > curvature - that is extracting patches with interesting pattern
> > > signatures, and checking whether the patch is "straight" in some sense,
> > > and longer than a minimum accumulation threshold to feed mass movement.
> > >
> > > These are general observations in the case that we don't have a smoothed
> > > surface. But here we have a model, and I'd guess that the underlying model
> > > could be used, rather than its predictions.
> > >
> > > I couldn't see a package with a vector field plot, there was a suggestion
> > > in:
> > >
> > > http://finzi.psych.upenn.edu/R/Rhelp02a/archive/35933.html
> > >
> > > but you'd still need the slope and aspect to get the length and direction
> > > of the arrows (for display only). A classic reference is:
> > >
> > > Horn, B. K. P. (1981). Hill Shading and the Reflectance Map, Proceedings
> > > of the IEEE, 69(1): 14-47
> > >
> > > and Horn's algorithm has stood the test of time, as has Zevenbergen and
> > > Thorne:
> > >
> > > Zevenbergen, L. W., Thorne, C. R. 1987. Quantitative analysis of land
> > > surface topography. Earth Surface Processes and Landforms, 12 (1), 4756.
> > >
> > > It could well be that the surface you are considering is something other
> > > than elevation (temperature, etc.), but getting further would depend on
> > > the specific characteristics of the study, and whether the surface is a
> > > fitted trend surface or not. With a fitted trend surface model, it ought
> > > to be possible to use the model. If thinking in terms of geomorphometrics
> > > is unhelpful, please accept that geographers "see" things in those kinds
> > > of ways!
> > >
> > > Hope this helps,
> > >
> > > Roger
> > >
> > > >
> > > > Thanks.
> > > >
> > > > _______________________________________________
> > > > R-sig-Geo mailing list
> > > > R-sig-Geo at stat.math.ethz.ch
> > > > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> > > >
> > >
> > > --
> > > Roger Bivand
> > > Economic Geography Section, Department of Economics, Norwegian School of
> > > Economics and Business Administration, Helleveien 30, N-5045 Bergen,
> > > Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> > > e-mail: Roger.Bivand at nhh.no
> > >
> > >
> >
>
> --
> Roger Bivand
> Economic Geography Section, Department of Economics, Norwegian School of
> Economics and Business Administration, Helleveien 30, N-5045 Bergen,
> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no
>
>



From adrian at maths.uwa.edu.au  Thu Mar 15 04:21:01 2007
From: adrian at maths.uwa.edu.au (Adrian Baddeley)
Date: Thu, 15 Mar 2007 11:21:01 +0800
Subject: [R-sig-Geo] (no subject)
Message-ID: <17912.48029.137927.960742@maths.uwa.edu.au>


On Tue, 13 Mar 2007, Michael Friendly wrote:

> I've read the documentation, but can't find an example of how 
> to specify a circular window for the ppp object that would contain the
> data and the window.

To create a circular window in spatstat, you can use the 
function disc(). See help(disc). 

For example suppose a point pattern with coordinates x, y (two vectors)
is observed inside a pot with centre (x0, y0) and radius R.
Then 
	   pot <- disc(R, c(x0,y0))
creates a window (owin object) representing the pot,
and
	   X <- ppp(x, y, window=pot)
creates the point pattern. 

Since spatstat always plots spatial objects isometrically, you can also 
use plot(disc(....)) just to draw a circle. 

> The data structure is something like a data frame for all the 
> germinating seeds, recording (X,Y) location and maybe some other
> measure like size after xx days:
> 
> PotID Treatment SeedType  X    Y  size

Currently, a point pattern can only have one mark variable
(e.g. you can attach the SeedType to each point, or attach the size to
each point, but not both).
This will change in spatstat version 2 which will be released soon.

> (Is there something better?) 

There is nothing better than spatstat!  %^]

regards
Adrian Baddeley



From Roger.Bivand at nhh.no  Thu Mar 15 09:45:11 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 15 Mar 2007 09:45:11 +0100 (CET)
Subject: [R-sig-Geo] (no subject)
In-Reply-To: <17912.48029.137927.960742@maths.uwa.edu.au>
Message-ID: <Pine.LNX.4.44.0703150939380.12259-100000@reclus.nhh.no>

On Thu, 15 Mar 2007, Adrian Baddeley wrote:

> 
> On Tue, 13 Mar 2007, Michael Friendly wrote:
> 
> > I've read the documentation, but can't find an example of how 
> > to specify a circular window for the ppp object that would contain the
> > data and the window.
> 
> To create a circular window in spatstat, you can use the 
> function disc(). See help(disc). 
> 
> For example suppose a point pattern with coordinates x, y (two vectors)
> is observed inside a pot with centre (x0, y0) and radius R.
> Then 
> 	   pot <- disc(R, c(x0,y0))
> creates a window (owin object) representing the pot,
> and
> 	   X <- ppp(x, y, window=pot)
> creates the point pattern. 
> 
> Since spatstat always plots spatial objects isometrically, you can also 
> use plot(disc(....)) just to draw a circle. 
> 
> > The data structure is something like a data frame for all the 
> > germinating seeds, recording (X,Y) location and maybe some other
> > measure like size after xx days:
> > 
> > PotID Treatment SeedType  X    Y  size
> 
> Currently, a point pattern can only have one mark variable
> (e.g. you can attach the SeedType to each point, or attach the size to
> each point, but not both).
> This will change in spatstat version 2 which will be released soon.
> 
> > (Is there something better?) 
> 
> There is nothing better than spatstat!  %^]

Great!

To get to the sp Polygon object:

res0 <- disc(1, c(0,0))$bdry
res <- Polygon(rbind(res0, res0[1,]))

should anyone need it.

Roger


> 
> regards
> Adrian Baddeley
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From Roger.Bivand at nhh.no  Thu Mar 15 09:50:08 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 15 Mar 2007 09:50:08 +0100 (CET)
Subject: [R-sig-Geo] circular window for spatial statistics (spatstat
 package)
In-Reply-To: <Pine.LNX.4.44.0703132108540.10818-100000@reclus.nhh.no>
Message-ID: <Pine.LNX.4.44.0703150946570.12259-100000@reclus.nhh.no>

For completeness, see the correct way of making circular windows in the
off-thread:

http://article.gmane.org/gmane.comp.lang.r.geo/1351
https://stat.ethz.ch/pipermail/r-sig-geo/2007-March/001865.html

reply by Adrian Baddeley, using disc() in the spatstat package.


On Tue, 13 Mar 2007, Roger Bivand wrote:

> On Tue, 13 Mar 2007, Michael Friendly wrote:
> 
> > Hi list,
> > 
> > A biology student I'm trying to help has done a study planting 20 seeds 
> > in circular pots under varying conditions and wants to analyze the 
> > degree of clustering
> > (and other measures) in the seeds that germinate (0-20) in relation to
> > the factors that differentiate pots (treatment, type of seed, ...)
> > 
> > The data structure is something like a data frame for all the 
> > germinating seeds, recording (X,Y) location and maybe some other
> > measure like size after xx days:
> > 
> > PotID Treatment SeedType  X    Y  size
> > 
> > Assume that the (X,Y) locations are referred to a circle of fixed radius, R.
> > I'm not very familiar with analysis of spatial point processes, but it 
> > seems that the spatstat package could handle this.  (Is there something
> > better?)  I've read the documentation, but can't find an example of how 
> > to specify a circular window for the ppp object that would contain the
> > data and the window.
> 
> Maybe March is a circular month? There was a thread on this recently:
> 
> http://article.gmane.org/gmane.comp.lang.r.geo/1320
> 
> refering to John Fox's original:
> 
> http://finzi.psych.upenn.edu/R/Rhelp02a/archive/74907.html
> 
> For a single pot, you'd need an owin object in the coordinate system of 
> the X,Y, best if the pot centre and radius were recorded. Then the 
> locations of the germinated seeds in each pot would become a ppp object 
> with a known owin (generated as a circumference sequence). Should the 
> clustering measure be at the seed observation or the pot plot level?
> 
> Hope this helps,
> 
> Roger 
> 
> > 
> > thanks,
> > -Michael
> > 
> > 
> 
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From Roger.Bivand at nhh.no  Thu Mar 15 09:51:55 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 15 Mar 2007 09:51:55 +0100 (CET)
Subject: [R-sig-Geo] (no subject)
In-Reply-To: <Pine.LNX.4.44.0703150939380.12259-100000@reclus.nhh.no>
Message-ID: <Pine.LNX.4.44.0703150950571.12259-100000@reclus.nhh.no>

On Thu, 15 Mar 2007, Roger Bivand wrote:

> On Thu, 15 Mar 2007, Adrian Baddeley wrote:
> 
> > 
> > On Tue, 13 Mar 2007, Michael Friendly wrote:
> > 
> > > I've read the documentation, but can't find an example of how 
> > > to specify a circular window for the ppp object that would contain the
> > > data and the window.
> > 
> > To create a circular window in spatstat, you can use the 
> > function disc(). See help(disc). 
> > 
> > For example suppose a point pattern with coordinates x, y (two vectors)
> > is observed inside a pot with centre (x0, y0) and radius R.
> > Then 
> > 	   pot <- disc(R, c(x0,y0))
> > creates a window (owin object) representing the pot,
> > and
> > 	   X <- ppp(x, y, window=pot)
> > creates the point pattern. 
> > 
> > Since spatstat always plots spatial objects isometrically, you can also 
> > use plot(disc(....)) just to draw a circle. 
> > 
> > > The data structure is something like a data frame for all the 
> > > germinating seeds, recording (X,Y) location and maybe some other
> > > measure like size after xx days:
> > > 
> > > PotID Treatment SeedType  X    Y  size
> > 
> > Currently, a point pattern can only have one mark variable
> > (e.g. you can attach the SeedType to each point, or attach the size to
> > each point, but not both).
> > This will change in spatstat version 2 which will be released soon.
> > 
> > > (Is there something better?) 
> > 
> > There is nothing better than spatstat!  %^]
> 
> Great!
> 
> To get to the sp Polygon object:

Should be:

res0 <- coordinates(disc(1, c(0,0))$bdry)
res <- Polygon(rbind(res0, res0[1,]))

to turn the list into a matrix, sorry.

Roger

> 
> res0 <- disc(1, c(0,0))$bdry
> res <- Polygon(rbind(res0, res0[1,]))
> 
> should anyone need it.
> 
> Roger
> 
> 
> > 
> > regards
> > Adrian Baddeley
> > 
> 
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From friendly at yorku.ca  Thu Mar 15 13:14:24 2007
From: friendly at yorku.ca (Michael Friendly)
Date: Thu, 15 Mar 2007 07:14:24 -0500
Subject: [R-sig-Geo] [circular window for spatstat]
In-Reply-To: <17912.48029.137927.960742@maths.uwa.edu.au>
References: <17912.48029.137927.960742@maths.uwa.edu.au>
Message-ID: <45F938A0.1000307@yorku.ca>

Thanks very much, Adrian.

-Michael

Adrian Baddeley wrote:

> On Tue, 13 Mar 2007, Michael Friendly wrote:
> 
> 
>>I've read the documentation, but can't find an example of how 
>>to specify a circular window for the ppp object that would contain the
>>data and the window.
> 
> 
> To create a circular window in spatstat, you can use the 
> function disc(). See help(disc). 
> 
> For example suppose a point pattern with coordinates x, y (two vectors)
> is observed inside a pot with centre (x0, y0) and radius R.
> Then 
> 	   pot <- disc(R, c(x0,y0))
> creates a window (owin object) representing the pot,
> and
> 	   X <- ppp(x, y, window=pot)
> creates the point pattern. 
> 
> Since spatstat always plots spatial objects isometrically, you can also 
> use plot(disc(....)) just to draw a circle. 
> 
> 
>>The data structure is something like a data frame for all the 
>>germinating seeds, recording (X,Y) location and maybe some other
>>measure like size after xx days:
>>
>>PotID Treatment SeedType  X    Y  size
> 
> 
> Currently, a point pattern can only have one mark variable
> (e.g. you can attach the SeedType to each point, or attach the size to
> each point, but not both).
> This will change in spatstat version 2 which will be released soon.
> 
> 
>>(Is there something better?) 
> 
> 
> There is nothing better than spatstat!  %^]
> 
> regards
> Adrian Baddeley
> 
> 
> 

-- 
Michael Friendly     Email: friendly AT yorku DOT ca
Professor, Psychology Dept.
York University      Voice: 416 736-5115 x66249 Fax: 416 736-5814
4700 Keele Street    http://www.math.yorku.ca/SCS/friendly.html
Toronto, ONT  M3J 1P3 CANADA



From tkeitt at gmail.com  Thu Mar 15 16:49:23 2007
From: tkeitt at gmail.com (Tim Keitt)
Date: Thu, 15 Mar 2007 10:49:23 -0500
Subject: [R-sig-Geo] polygons to arcs?
Message-ID: <6262c54c0703150849qe60ab14nfef1eb3bf73dfb5d@mail.gmail.com>

Is there an 'sp' function that takes a polygon as its argument and
returns a set of line objects corresponding to the arcs in the
polygon?

Or better yet, a function that given a set of polygons, returns the
hull? (ie the set of singleton arcs after applying the polys to arcs
function)

THK

-- 
Timothy H. Keitt, University of Texas at Austin
Contact info and schedule at http://www.keittlab.org/tkeitt/
Reprints at http://www.keittlab.org/tkeitt/papers/
ODF attachment? See http://www.openoffice.org/



From tkeitt at gmail.com  Thu Mar 15 17:53:52 2007
From: tkeitt at gmail.com (Tim Keitt)
Date: Thu, 15 Mar 2007 11:53:52 -0500
Subject: [R-sig-Geo] Fwd: [OSGeo-Announce] OSGeo Accepted for Google Summer
	of Code 2007
In-Reply-To: <45F9747A.7010502@pobox.com>
References: <45F9747A.7010502@pobox.com>
Message-ID: <6262c54c0703150953r8317894v77c089d4156e2615@mail.gmail.com>

---------- Forwarded message ----------
From: Frank Warmerdam <warmerdam at pobox.com>
Date: Mar 15, 2007 11:29 AM
Subject: [OSGeo-Announce] OSGeo Accepted for Google Summer of Code 2007
To: announce at lists.osgeo.org


OSGeo is pleased to announce that Google has accepted OSGeo as mentoring
organization for the Google Summer of Code 2007 program.  This program
provides funding for students to work on open source projects under
the support of experienced mentors.   The projects participating through
OSGeo are GDAL, GeoServer, GeoTools, GRASS, MapGuide, PostGIS, uDig,
OpenJUMP and MapServer.

Students interested in participating can find more information on
OSGeo project ideas at:

   http://wiki.osgeo.org/index.php/2007_SoC_Merged_Ideas

and more information about the program as a whole at:

   http://code.google.com/soc/


_______________________________________________
Announce mailing list
Announce at lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/announce


-- 
Timothy H. Keitt, University of Texas at Austin
Contact info and schedule at http://www.keittlab.org/tkeitt/
Reprints at http://www.keittlab.org/tkeitt/papers/
ODF attachment? See http://www.openoffice.org/



From Roger.Bivand at nhh.no  Thu Mar 15 20:03:36 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 15 Mar 2007 20:03:36 +0100 (CET)
Subject: [R-sig-Geo] polygons to arcs?
In-Reply-To: <6262c54c0703150849qe60ab14nfef1eb3bf73dfb5d@mail.gmail.com>
Message-ID: <Pine.LNX.4.44.0703151959300.12259-100000@reclus.nhh.no>

On Thu, 15 Mar 2007, Tim Keitt wrote:

> Is there an 'sp' function that takes a polygon as its argument and
> returns a set of line objects corresponding to the arcs in the
> polygon?

Edzer asked a similar question a couple of days ago - the state of play 
is not very encouraging:

https://stat.ethz.ch/pipermail/r-sig-geo/2007-March/001856.html

> 
> Or better yet, a function that given a set of polygons, returns the
> hull? (ie the set of singleton arcs after applying the polys to arcs
> function)

But if the problem is to take a union of contiguous polygons, 
unionSpatialPolygons() in maptools using the gpclib package can do it, but 
not from the arc topology.

Roger

> 
> THK
> 
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From tkeitt at gmail.com  Thu Mar 15 21:04:48 2007
From: tkeitt at gmail.com (Tim Keitt)
Date: Thu, 15 Mar 2007 15:04:48 -0500
Subject: [R-sig-Geo] polygons to arcs?
In-Reply-To: <Pine.LNX.4.44.0703151959300.12259-100000@reclus.nhh.no>
References: <6262c54c0703150849qe60ab14nfef1eb3bf73dfb5d@mail.gmail.com>
	<Pine.LNX.4.44.0703151959300.12259-100000@reclus.nhh.no>
Message-ID: <6262c54c0703151304p645d9f80s4569dedcfa84ec28@mail.gmail.com>

Thanks for the pointer to unionSpatialPolygons. I solved hull problem,
but in a one-off hackish way. I should have looked through maptools a
couple of hours ago...

THK

On 3/15/07, Roger Bivand <Roger.Bivand at nhh.no> wrote:
> On Thu, 15 Mar 2007, Tim Keitt wrote:
>
> > Is there an 'sp' function that takes a polygon as its argument and
> > returns a set of line objects corresponding to the arcs in the
> > polygon?
>
> Edzer asked a similar question a couple of days ago - the state of play
> is not very encouraging:
>
> https://stat.ethz.ch/pipermail/r-sig-geo/2007-March/001856.html
>
> >
> > Or better yet, a function that given a set of polygons, returns the
> > hull? (ie the set of singleton arcs after applying the polys to arcs
> > function)
>
> But if the problem is to take a union of contiguous polygons,
> unionSpatialPolygons() in maptools using the gpclib package can do it, but
> not from the arc topology.
>
> Roger
>
> >
> > THK
> >
> >
>
> --
> Roger Bivand
> Economic Geography Section, Department of Economics, Norwegian School of
> Economics and Business Administration, Helleveien 30, N-5045 Bergen,
> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no
>
>


-- 
Timothy H. Keitt, University of Texas at Austin
Contact info and schedule at http://www.keittlab.org/tkeitt/
Reprints at http://www.keittlab.org/tkeitt/papers/
ODF attachment? See http://www.openoffice.org/



From hpolesi at gmail.com  Fri Mar 16 12:08:42 2007
From: hpolesi at gmail.com (=?ISO-8859-1?Q?Herv=E9_Polesi?=)
Date: Fri, 16 Mar 2007 12:08:42 +0100
Subject: [R-sig-Geo] classInterval(style="fisher") vs. ArcView GIS natural
	breaks
Message-ID: <45FA7ABA.2020000@gmail.com>

Hi!

Working on a litle datebase (903 lines) I notice a difference between 
the result of classInterval(style="fisher") and the natural breaks 
proposed by ArcView GIS (3.2).
I read that ArcView works on a sample of data. Is it right ? May it 
cause a significative difference ?

Greetings from Strasbourg, France.

Herv? Polesi



From nikko at hailmail.net  Fri Mar 16 13:27:16 2007
From: nikko at hailmail.net (Nicholas Lewin-Koh)
Date: Fri, 16 Mar 2007 08:27:16 -0400
Subject: [R-sig-Geo] R-sig-Geo Digest, Vol 43, Issue 14
In-Reply-To: <mailman.15.1174042806.26780.r-sig-geo@stat.math.ethz.ch>
References: <mailman.15.1174042806.26780.r-sig-geo@stat.math.ethz.ch>
Message-ID: <1174048036.2508.1179791271@webmail.messagingengine.com>

Hi Tim,
I am not quite sure what you are getting at here. Do you want to
intersect
polygons and then select the set of lines that form the outer perimeter?
Do you wan the convex hull of a set of polygons. I guess I have been out
of the
GIS world to long. It seems to me that this would be something easy to
solve,
just tedious iteration of the polygon coordinates and some
triangulation.

Nicholas

> Date: Thu, 15 Mar 2007 10:49:23 -0500
> From: "Tim Keitt" <tkeitt at gmail.com>
> Subject: [R-sig-Geo] polygons to arcs?
> To: r-sig-geo at stat.math.ethz.ch
> Message-ID:
> 	<6262c54c0703150849qe60ab14nfef1eb3bf73dfb5d at mail.gmail.com>
> Content-Type: text/plain; charset=ISO-8859-1; format=flowed
> 
> Is there an 'sp' function that takes a polygon as its argument and
> returns a set of line objects corresponding to the arcs in the
> polygon?
> 
> Or better yet, a function that given a set of polygons, returns the
> hull? (ie the set of singleton arcs after applying the polys to arcs
> function)
> 
> THK
> 
> -- 
> Timothy H. Keitt, University of Texas at Austin
> Contact info and schedule at http://www.keittlab.org/tkeitt/
> Reprints at http://www.keittlab.org/tkeitt/papers/
> ODF attachment? See http://www.openoffice.org/
> 
> 
>



From tkeitt at gmail.com  Fri Mar 16 14:34:20 2007
From: tkeitt at gmail.com (Tim Keitt)
Date: Fri, 16 Mar 2007 08:34:20 -0500
Subject: [R-sig-Geo] R-sig-Geo Digest, Vol 43, Issue 14
In-Reply-To: <1174048036.2508.1179791271@webmail.messagingengine.com>
References: <mailman.15.1174042806.26780.r-sig-geo@stat.math.ethz.ch>
	<1174048036.2508.1179791271@webmail.messagingengine.com>
Message-ID: <6262c54c0703160634u6f47ab90g63feb1f0fb69515f@mail.gmail.com>

Hi Nic,

The convex hull would be fast and easy to compute (there's existing
code in R). I want the ordinary hull which is the set of arcs forming
the perimeters (inside and out). My crude and very slow solution was
to convert all the polygons (in this case hexagons on a lattice) into
their constituent arcs and then for each arc count how many times it
occurs in the set (requires slightly fuzzy matching of points). Arcs
that occur more than once are removed. The remaining arcs form the
hull. Runs in about 20 minutes with a  few hundred hexagons.
Sufficient for the moment.

THK

On 3/16/07, Nicholas Lewin-Koh <nikko at hailmail.net> wrote:
> Hi Tim,
> I am not quite sure what you are getting at here. Do you want to
> intersect
> polygons and then select the set of lines that form the outer perimeter?
> Do you wan the convex hull of a set of polygons. I guess I have been out
> of the
> GIS world to long. It seems to me that this would be something easy to
> solve,
> just tedious iteration of the polygon coordinates and some
> triangulation.
>
> Nicholas
>
> > Date: Thu, 15 Mar 2007 10:49:23 -0500
> > From: "Tim Keitt" <tkeitt at gmail.com>
> > Subject: [R-sig-Geo] polygons to arcs?
> > To: r-sig-geo at stat.math.ethz.ch
> > Message-ID:
> >       <6262c54c0703150849qe60ab14nfef1eb3bf73dfb5d at mail.gmail.com>
> > Content-Type: text/plain; charset=ISO-8859-1; format=flowed
> >
> > Is there an 'sp' function that takes a polygon as its argument and
> > returns a set of line objects corresponding to the arcs in the
> > polygon?
> >
> > Or better yet, a function that given a set of polygons, returns the
> > hull? (ie the set of singleton arcs after applying the polys to arcs
> > function)
> >
> > THK
> >
> > --
> > Timothy H. Keitt, University of Texas at Austin
> > Contact info and schedule at http://www.keittlab.org/tkeitt/
> > Reprints at http://www.keittlab.org/tkeitt/papers/
> > ODF attachment? See http://www.openoffice.org/
> >
> >
> >
>


-- 
Timothy H. Keitt, University of Texas at Austin
Contact info and schedule at http://www.keittlab.org/tkeitt/
Reprints at http://www.keittlab.org/tkeitt/papers/
ODF attachment? See http://www.openoffice.org/



From Roger.Bivand at nhh.no  Fri Mar 16 14:52:47 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 16 Mar 2007 14:52:47 +0100 (CET)
Subject: [R-sig-Geo] classInterval(style="fisher") vs. ArcView GIS
 natural breaks
In-Reply-To: <45FA7ABA.2020000@gmail.com>
Message-ID: <Pine.LNX.4.44.0703161358560.13076-100000@reclus.nhh.no>

On Fri, 16 Mar 2007, Herv? Polesi wrote:

> Hi!
> 
> Working on a litle datebase (903 lines) I notice a difference between 
> the result of classInterval(style="fisher") and the natural breaks 
> proposed by ArcView GIS (3.2).
> I read that ArcView works on a sample of data. Is it right ? May it 
> cause a significative difference ?

The classInt package is open source, but ArcView/ArcGIS isn't (unless you 
consider the new python scripts, but I don't think these include class 
intervals). Is it possible to check in the ESRI documentation? I recall 
being told that the symbology is built on the fly and probably stored in 
the project, and that a sample is used instead of the total. If anyone 
has some students who'd like to deconstruct the ESRI approach by testing 
on known distributions, that might be fun. We have the Fisher code (as 
implemented), so seeing why things might differ ought to be possible.

Of course, there are very many different classifications anyway, even for 
moderate n and k.

Best wishes,

Roger

> 
> Greetings from Strasbourg, France.
> 
> Herv? Polesi
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From nikko at hailmail.net  Fri Mar 16 15:52:59 2007
From: nikko at hailmail.net (Nicholas Lewin-Koh)
Date: Fri, 16 Mar 2007 10:52:59 -0400
Subject: [R-sig-Geo] R-sig-Geo Digest, Vol 43, Issue 14
In-Reply-To: <6262c54c0703160634u6f47ab90g63feb1f0fb69515f@mail.gmail.com>
References: <mailman.15.1174042806.26780.r-sig-geo@stat.math.ethz.ch>
	<1174048036.2508.1179791271@webmail.messagingengine.com>
	<6262c54c0703160634u6f47ab90g63feb1f0fb69515f@mail.gmail.com>
Message-ID: <1174056779.24035.1179814653@webmail.messagingengine.com>

Hi Tim,
You could compute the convex hull first, and then iterate from points
on the convex hull. That should be much faster already, especially since
hexagons are convex and the perimeter will be locally convex around all
the
points touching the convex hull. You could do a variation
of the "monotone pieces" algorithm that is used in computational
geometry.
But this is a simpler problem. Are there cases with interior holes?

I have been meaning to write something like this for hexbin for a while.
There
are many cases where it would be nice to find approximations to the
density contours
and a quick and dirty way is to threshold the hexagon counts, find the
hull and
smooth the perimeter.

Nicholas

On Fri, 16 Mar 2007 08:34:20 -0500, "Tim Keitt" <tkeitt at gmail.com> said:
> Hi Nic,
> 
> The convex hull would be fast and easy to compute (there's existing
> code in R). I want the ordinary hull which is the set of arcs forming
> the perimeters (inside and out). My crude and very slow solution was
> to convert all the polygons (in this case hexagons on a lattice) into
> their constituent arcs and then for each arc count how many times it
> occurs in the set (requires slightly fuzzy matching of points). Arcs
> that occur more than once are removed. The remaining arcs form the
> hull. Runs in about 20 minutes with a  few hundred hexagons.
> Sufficient for the moment.
> 
> THK
> 
> On 3/16/07, Nicholas Lewin-Koh <nikko at hailmail.net> wrote:
> > Hi Tim,
> > I am not quite sure what you are getting at here. Do you want to
> > intersect
> > polygons and then select the set of lines that form the outer perimeter?
> > Do you wan the convex hull of a set of polygons. I guess I have been out
> > of the
> > GIS world to long. It seems to me that this would be something easy to
> > solve,
> > just tedious iteration of the polygon coordinates and some
> > triangulation.
> >
> > Nicholas
> >
> > > Date: Thu, 15 Mar 2007 10:49:23 -0500
> > > From: "Tim Keitt" <tkeitt at gmail.com>
> > > Subject: [R-sig-Geo] polygons to arcs?
> > > To: r-sig-geo at stat.math.ethz.ch
> > > Message-ID:
> > >       <6262c54c0703150849qe60ab14nfef1eb3bf73dfb5d at mail.gmail.com>
> > > Content-Type: text/plain; charset=ISO-8859-1; format=flowed
> > >
> > > Is there an 'sp' function that takes a polygon as its argument and
> > > returns a set of line objects corresponding to the arcs in the
> > > polygon?
> > >
> > > Or better yet, a function that given a set of polygons, returns the
> > > hull? (ie the set of singleton arcs after applying the polys to arcs
> > > function)
> > >
> > > THK
> > >
> > > --
> > > Timothy H. Keitt, University of Texas at Austin
> > > Contact info and schedule at http://www.keittlab.org/tkeitt/
> > > Reprints at http://www.keittlab.org/tkeitt/papers/
> > > ODF attachment? See http://www.openoffice.org/
> > >
> > >
> > >
> >
> 
> 
> -- 
> Timothy H. Keitt, University of Texas at Austin
> Contact info and schedule at http://www.keittlab.org/tkeitt/
> Reprints at http://www.keittlab.org/tkeitt/papers/
> ODF attachment? See http://www.openoffice.org/



From White.Denis at epamail.epa.gov  Fri Mar 16 16:25:15 2007
From: White.Denis at epamail.epa.gov (White.Denis at epamail.epa.gov)
Date: Fri, 16 Mar 2007 08:25:15 -0700
Subject: [R-sig-Geo] classInterval(style="fisher") vs. ArcView GIS
 natural breaks
In-Reply-To: <45FA7ABA.2020000@gmail.com>
Message-ID: <OF1C35CBD3.A2774001-ON882572A0.0053BB31-882572A0.0054B5EC@epamail.epa.gov>

Just found out a little about this in ArcGIS (ArcMap), version 9.1.
Yes, apparently with large datasets, the "natural breaks" classification
(and maybe others like quantile) does sample.  However, it is possible
to change the sample size by clicking the "Sampling" button in the
Classification window.  With 40,000 cases it was really slow, however.

For R users, Roger Bivand's response is more relevant.

r-sig-geo-bounces at stat.math.ethz.ch wrote on 2007-03-16 04:08:42:

> Hi!
>
> Working on a litle datebase (903 lines) I notice a difference between
> the result of classInterval(style="fisher") and the natural breaks
> proposed by ArcView GIS (3.2).
> I read that ArcView works on a sample of data. Is it right ? May it
> cause a significative difference ?
>
> Greetings from Strasbourg, France.
>
> Herv? Polesi
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo



From tkeitt at gmail.com  Fri Mar 16 16:55:06 2007
From: tkeitt at gmail.com (Tim Keitt)
Date: Fri, 16 Mar 2007 10:55:06 -0500
Subject: [R-sig-Geo] R-sig-Geo Digest, Vol 43, Issue 14
In-Reply-To: <1174056779.24035.1179814653@webmail.messagingengine.com>
References: <mailman.15.1174042806.26780.r-sig-geo@stat.math.ethz.ch>
	<1174048036.2508.1179791271@webmail.messagingengine.com>
	<6262c54c0703160634u6f47ab90g63feb1f0fb69515f@mail.gmail.com>
	<1174056779.24035.1179814653@webmail.messagingengine.com>
Message-ID: <6262c54c0703160855p101e9248yb21cc2076ab5388f@mail.gmail.com>

Ya, there can be pretty arbitrary holes. The situation is a large
hexagonal lattice where some fraction of cells have q-values < 0.05.
Now draw lines around those cells following the hexagonal edges, but
omitting any interior arcs. I can send you an example solution. The
images are bit big for the list.

THK

On 3/16/07, Nicholas Lewin-Koh <nikko at hailmail.net> wrote:
> Hi Tim,
> You could compute the convex hull first, and then iterate from points
> on the convex hull. That should be much faster already, especially since
> hexagons are convex and the perimeter will be locally convex around all
> the
> points touching the convex hull. You could do a variation
> of the "monotone pieces" algorithm that is used in computational
> geometry.
> But this is a simpler problem. Are there cases with interior holes?
>
> I have been meaning to write something like this for hexbin for a while.
> There
> are many cases where it would be nice to find approximations to the
> density contours
> and a quick and dirty way is to threshold the hexagon counts, find the
> hull and
> smooth the perimeter.
>
> Nicholas
>
> On Fri, 16 Mar 2007 08:34:20 -0500, "Tim Keitt" <tkeitt at gmail.com> said:
> > Hi Nic,
> >
> > The convex hull would be fast and easy to compute (there's existing
> > code in R). I want the ordinary hull which is the set of arcs forming
> > the perimeters (inside and out). My crude and very slow solution was
> > to convert all the polygons (in this case hexagons on a lattice) into
> > their constituent arcs and then for each arc count how many times it
> > occurs in the set (requires slightly fuzzy matching of points). Arcs
> > that occur more than once are removed. The remaining arcs form the
> > hull. Runs in about 20 minutes with a  few hundred hexagons.
> > Sufficient for the moment.
> >
> > THK
> >
> > On 3/16/07, Nicholas Lewin-Koh <nikko at hailmail.net> wrote:
> > > Hi Tim,
> > > I am not quite sure what you are getting at here. Do you want to
> > > intersect
> > > polygons and then select the set of lines that form the outer perimeter?
> > > Do you wan the convex hull of a set of polygons. I guess I have been out
> > > of the
> > > GIS world to long. It seems to me that this would be something easy to
> > > solve,
> > > just tedious iteration of the polygon coordinates and some
> > > triangulation.
> > >
> > > Nicholas
> > >
> > > > Date: Thu, 15 Mar 2007 10:49:23 -0500
> > > > From: "Tim Keitt" <tkeitt at gmail.com>
> > > > Subject: [R-sig-Geo] polygons to arcs?
> > > > To: r-sig-geo at stat.math.ethz.ch
> > > > Message-ID:
> > > >       <6262c54c0703150849qe60ab14nfef1eb3bf73dfb5d at mail.gmail.com>
> > > > Content-Type: text/plain; charset=ISO-8859-1; format=flowed
> > > >
> > > > Is there an 'sp' function that takes a polygon as its argument and
> > > > returns a set of line objects corresponding to the arcs in the
> > > > polygon?
> > > >
> > > > Or better yet, a function that given a set of polygons, returns the
> > > > hull? (ie the set of singleton arcs after applying the polys to arcs
> > > > function)
> > > >
> > > > THK
> > > >
> > > > --
> > > > Timothy H. Keitt, University of Texas at Austin
> > > > Contact info and schedule at http://www.keittlab.org/tkeitt/
> > > > Reprints at http://www.keittlab.org/tkeitt/papers/
> > > > ODF attachment? See http://www.openoffice.org/
> > > >
> > > >
> > > >
> > >
> >
> >
> > --
> > Timothy H. Keitt, University of Texas at Austin
> > Contact info and schedule at http://www.keittlab.org/tkeitt/
> > Reprints at http://www.keittlab.org/tkeitt/papers/
> > ODF attachment? See http://www.openoffice.org/
>


-- 
Timothy H. Keitt, University of Texas at Austin
Contact info and schedule at http://www.keittlab.org/tkeitt/
Reprints at http://www.keittlab.org/tkeitt/papers/
ODF attachment? See http://www.openoffice.org/



From White.Denis at epamail.epa.gov  Fri Mar 16 17:06:21 2007
From: White.Denis at epamail.epa.gov (White.Denis at epamail.epa.gov)
Date: Fri, 16 Mar 2007 09:06:21 -0700
Subject: [R-sig-Geo]  agenda for R's Geo capabilities?
In-Reply-To: <1174056779.24035.1179814653@webmail.messagingengine.com>
Message-ID: <OFC926C48F.BD549B28-ON882572A0.00569301-882572A0.00587957@epamail.epa.gov>

The thread below and many others in R-sig-Geo raise questions about
future directions.  In reinventing GIS there are a whole list of
capabilities and functions that would be helpful.  Some that I have
noticed include,

Topological representation to enable
      Planar enforcement of boundary integrity of polygon tessellations
      "Dissolving" interior edges easily as in the thread below
Large problem computational geometry functions
      Identify many points inside of many polygons
      Intersections/overlays of two sets of many polygons
      Distances between all pairs of many polygons

Are there members of the R Geo community working on any of these?
Are these issues seen as an exclusive focus of commercial GIS?
Are there discussions about these issues at relevant conferences?

(I will be at AAG in San Francisco and would be happy to meet with
others if there is interest.)

r-sig-geo-bounces at stat.math.ethz.ch wrote on 2007-03-16 07:52:59:

> Hi Tim,
> You could compute the convex hull first, and then iterate from points
> on the convex hull. That should be much faster already, especially
since
> hexagons are convex and the perimeter will be locally convex around
all
> the
> points touching the convex hull. You could do a variation
> of the "monotone pieces" algorithm that is used in computational
> geometry.
> But this is a simpler problem. Are there cases with interior holes?
>
> I have been meaning to write something like this for hexbin for a
while.
> There
> are many cases where it would be nice to find approximations to the
> density contours
> and a quick and dirty way is to threshold the hexagon counts, find the
> hull and
> smooth the perimeter.
>
> Nicholas
>
> On Fri, 16 Mar 2007 08:34:20 -0500, "Tim Keitt" <tkeitt at gmail.com>
said:
> > Hi Nic,
> >
> > The convex hull would be fast and easy to compute (there's existing
> > code in R). I want the ordinary hull which is the set of arcs
forming
> > the perimeters (inside and out). My crude and very slow solution was
> > to convert all the polygons (in this case hexagons on a lattice)
into
> > their constituent arcs and then for each arc count how many times it
> > occurs in the set (requires slightly fuzzy matching of points). Arcs
> > that occur more than once are removed. The remaining arcs form the
> > hull. Runs in about 20 minutes with a  few hundred hexagons.
> > Sufficient for the moment.
> >
> > THK
> >
> > On 3/16/07, Nicholas Lewin-Koh <nikko at hailmail.net> wrote:
> > > Hi Tim,
> > > I am not quite sure what you are getting at here. Do you want to
> > > intersect
> > > polygons and then select the set of lines that form the outer
perimeter?
> > > Do you wan the convex hull of a set of polygons. I guess I have
been out
> > > of the
> > > GIS world to long. It seems to me that this would be something
easy to
> > > solve,
> > > just tedious iteration of the polygon coordinates and some
> > > triangulation.
> > >
> > > Nicholas
> > >
> > > > Date: Thu, 15 Mar 2007 10:49:23 -0500
> > > > From: "Tim Keitt" <tkeitt at gmail.com>
> > > > Subject: [R-sig-Geo] polygons to arcs?
> > > > To: r-sig-geo at stat.math.ethz.ch
> > > > Message-ID:
> > > >
<6262c54c0703150849qe60ab14nfef1eb3bf73dfb5d at mail.gmail.com>
> > > > Content-Type: text/plain; charset=ISO-8859-1; format=flowed
> > > >
> > > > Is there an 'sp' function that takes a polygon as its argument
and
> > > > returns a set of line objects corresponding to the arcs in the
> > > > polygon?
> > > >
> > > > Or better yet, a function that given a set of polygons, returns
the
> > > > hull? (ie the set of singleton arcs after applying the polys to
arcs
> > > > function)
> > > >
> > > > THK
> > > >
> > > > --
> > > > Timothy H. Keitt, University of Texas at Austin
> > > > Contact info and schedule at http://www.keittlab.org/tkeitt/
> > > > Reprints at http://www.keittlab.org/tkeitt/papers/
> > > > ODF attachment? See http://www.openoffice.org/
> > > >
> > > >
> > > >
> > >
> >
> >
> > --
> > Timothy H. Keitt, University of Texas at Austin
> > Contact info and schedule at http://www.keittlab.org/tkeitt/
> > Reprints at http://www.keittlab.org/tkeitt/papers/
> > ODF attachment? See http://www.openoffice.org/
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo



From nikko at hailmail.net  Fri Mar 16 17:23:11 2007
From: nikko at hailmail.net (Nicholas Lewin-Koh)
Date: Fri, 16 Mar 2007 12:23:11 -0400
Subject: [R-sig-Geo] R-sig-Geo Digest, Vol 43, Issue 14
In-Reply-To: <6262c54c0703160855p101e9248yb21cc2076ab5388f@mail.gmail.com>
References: <mailman.15.1174042806.26780.r-sig-geo@stat.math.ethz.ch>
	<1174048036.2508.1179791271@webmail.messagingengine.com>
	<6262c54c0703160634u6f47ab90g63feb1f0fb69515f@mail.gmail.com>
	<1174056779.24035.1179814653@webmail.messagingengine.com>
	<6262c54c0703160855p101e9248yb21cc2076ab5388f@mail.gmail.com>
Message-ID: <1174062191.4731.1179830711@webmail.messagingengine.com>

Hi Tim,
Now I think I get it. What about the following:
1) threshold based on your qvalues
2) find all disconnected sets 
3) For each disconnected set 
  a) find the convex hull of the hexagon centers, this should be
  equivalent to the
     the convex hull of the hexagons themselves (convexity of the
     hexagons and a regular lattice)
  b) iterate from each (center)point on the hull, using only points in
  the set and test for an exterior neighbor,
     you have to be careful here due to holes, just keep a binary matrix
     of each hexagons exterior faces.
  c) invert the polygon and find the boundaries of interior holes
4) put it all together saving just the vertices of the hexagons sides on
the exterior

So you have already reduced your constant by 1/6 using the centers. I
think this should be no worse
than the convex hull itself times some function of n representing the
fraction of exterior polygon
centers.

Now you already have something that works so this is just thinking about
if you have to do it again or
do some simulations.

Cheers
Nicholas
  

On Fri, 16 Mar 2007 10:55:06 -0500, "Tim Keitt" <tkeitt at gmail.com> said:
> Ya, there can be pretty arbitrary holes. The situation is a large
> hexagonal lattice where some fraction of cells have q-values < 0.05.
> Now draw lines around those cells following the hexagonal edges, but
> omitting any interior arcs. I can send you an example solution. The
> images are bit big for the list.
> 
> THK
> 
> On 3/16/07, Nicholas Lewin-Koh <nikko at hailmail.net> wrote:
> > Hi Tim,
> > You could compute the convex hull first, and then iterate from points
> > on the convex hull. That should be much faster already, especially since
> > hexagons are convex and the perimeter will be locally convex around all
> > the
> > points touching the convex hull. You could do a variation
> > of the "monotone pieces" algorithm that is used in computational
> > geometry.
> > But this is a simpler problem. Are there cases with interior holes?
> >
> > I have been meaning to write something like this for hexbin for a while.
> > There
> > are many cases where it would be nice to find approximations to the
> > density contours
> > and a quick and dirty way is to threshold the hexagon counts, find the
> > hull and
> > smooth the perimeter.
> >
> > Nicholas
> >
> > On Fri, 16 Mar 2007 08:34:20 -0500, "Tim Keitt" <tkeitt at gmail.com> said:
> > > Hi Nic,
> > >
> > > The convex hull would be fast and easy to compute (there's existing
> > > code in R). I want the ordinary hull which is the set of arcs forming
> > > the perimeters (inside and out). My crude and very slow solution was
> > > to convert all the polygons (in this case hexagons on a lattice) into
> > > their constituent arcs and then for each arc count how many times it
> > > occurs in the set (requires slightly fuzzy matching of points). Arcs
> > > that occur more than once are removed. The remaining arcs form the
> > > hull. Runs in about 20 minutes with a  few hundred hexagons.
> > > Sufficient for the moment.
> > >
> > > THK
> > >
> > > On 3/16/07, Nicholas Lewin-Koh <nikko at hailmail.net> wrote:
> > > > Hi Tim,
> > > > I am not quite sure what you are getting at here. Do you want to
> > > > intersect
> > > > polygons and then select the set of lines that form the outer perimeter?
> > > > Do you wan the convex hull of a set of polygons. I guess I have been out
> > > > of the
> > > > GIS world to long. It seems to me that this would be something easy to
> > > > solve,
> > > > just tedious iteration of the polygon coordinates and some
> > > > triangulation.
> > > >
> > > > Nicholas
> > > >
> > > > > Date: Thu, 15 Mar 2007 10:49:23 -0500
> > > > > From: "Tim Keitt" <tkeitt at gmail.com>
> > > > > Subject: [R-sig-Geo] polygons to arcs?
> > > > > To: r-sig-geo at stat.math.ethz.ch
> > > > > Message-ID:
> > > > >       <6262c54c0703150849qe60ab14nfef1eb3bf73dfb5d at mail.gmail.com>
> > > > > Content-Type: text/plain; charset=ISO-8859-1; format=flowed
> > > > >
> > > > > Is there an 'sp' function that takes a polygon as its argument and
> > > > > returns a set of line objects corresponding to the arcs in the
> > > > > polygon?
> > > > >
> > > > > Or better yet, a function that given a set of polygons, returns the
> > > > > hull? (ie the set of singleton arcs after applying the polys to arcs
> > > > > function)
> > > > >
> > > > > THK
> > > > >
> > > > > --
> > > > > Timothy H. Keitt, University of Texas at Austin
> > > > > Contact info and schedule at http://www.keittlab.org/tkeitt/
> > > > > Reprints at http://www.keittlab.org/tkeitt/papers/
> > > > > ODF attachment? See http://www.openoffice.org/
> > > > >
> > > > >
> > > > >
> > > >
> > >
> > >
> > > --
> > > Timothy H. Keitt, University of Texas at Austin
> > > Contact info and schedule at http://www.keittlab.org/tkeitt/
> > > Reprints at http://www.keittlab.org/tkeitt/papers/
> > > ODF attachment? See http://www.openoffice.org/
> >
> 
> 
> -- 
> Timothy H. Keitt, University of Texas at Austin
> Contact info and schedule at http://www.keittlab.org/tkeitt/
> Reprints at http://www.keittlab.org/tkeitt/papers/
> ODF attachment? See http://www.openoffice.org/



From Roger.Bivand at nhh.no  Fri Mar 16 19:00:41 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 16 Mar 2007 19:00:41 +0100 (CET)
Subject: [R-sig-Geo] agenda for R's Geo capabilities?
In-Reply-To: <OFC926C48F.BD549B28-ON882572A0.00569301-882572A0.00587957@epamail.epa.gov>
Message-ID: <Pine.LNX.4.44.0703161845520.22582-100000@reclus.nhh.no>

On Fri, 16 Mar 2007 White.Denis at epamail.epa.gov wrote:

> The thread below and many others in R-sig-Geo raise questions about
> future directions.  In reinventing GIS there are a whole list of
> capabilities and functions that would be helpful.  Some that I have
> noticed include,
> 
> Topological representation to enable
>       Planar enforcement of boundary integrity of polygon tessellations
>       "Dissolving" interior edges easily as in the thread below
> Large problem computational geometry functions
>       Identify many points inside of many polygons
>       Intersections/overlays of two sets of many polygons
>       Distances between all pairs of many polygons
> 
> Are there members of the R Geo community working on any of these?
> Are these issues seen as an exclusive focus of commercial GIS?
> Are there discussions about these issues at relevant conferences?

One possibility was mentioned in a question by Hisaji Ono last year, and 
which could be done, is to build rgdal against a GDAL/OGR with GEOS 
support, and use the OGR functions such as:

virtual OGRGeometry * 	Union (const OGRGeometry *) const

and other similar ones. This would also involve trying to make a faster 
conversion between the OGR and internal sp representations, and may 
precipitate a redefinition of polygons in sp to be fully OGR compatible.

The sp S4 classes would need much better integration with OGR for this to 
work adequately on larger data sets, but we could profile it after 
prototyping.

> 
> (I will be at AAG in San Francisco and would be happy to meet with
> others if there is interest.)

Thanks for taking this initiative! As one of the guilty parties, and also
at the AAG, count me in, at least for the prototyping - I think GEOS is a
realistic place to start because it is being used by others and maintained
actively.

Having tried things out, we may find that this is too much GIS, and that 
either using a GIS or a database interface like PostGIS or aRT/Terralib is 
a better idea. But at least we'd know.

Roger

> 
> r-sig-geo-bounces at stat.math.ethz.ch wrote on 2007-03-16 07:52:59:
> 
> > Hi Tim,
> > You could compute the convex hull first, and then iterate from points
> > on the convex hull. That should be much faster already, especially
> since
> > hexagons are convex and the perimeter will be locally convex around
> all
> > the
> > points touching the convex hull. You could do a variation
> > of the "monotone pieces" algorithm that is used in computational
> > geometry.
> > But this is a simpler problem. Are there cases with interior holes?
> >
> > I have been meaning to write something like this for hexbin for a
> while.
> > There
> > are many cases where it would be nice to find approximations to the
> > density contours
> > and a quick and dirty way is to threshold the hexagon counts, find the
> > hull and
> > smooth the perimeter.
> >
> > Nicholas
> >
> > On Fri, 16 Mar 2007 08:34:20 -0500, "Tim Keitt" <tkeitt at gmail.com>
> said:
> > > Hi Nic,
> > >
> > > The convex hull would be fast and easy to compute (there's existing
> > > code in R). I want the ordinary hull which is the set of arcs
> forming
> > > the perimeters (inside and out). My crude and very slow solution was
> > > to convert all the polygons (in this case hexagons on a lattice)
> into
> > > their constituent arcs and then for each arc count how many times it
> > > occurs in the set (requires slightly fuzzy matching of points). Arcs
> > > that occur more than once are removed. The remaining arcs form the
> > > hull. Runs in about 20 minutes with a  few hundred hexagons.
> > > Sufficient for the moment.
> > >
> > > THK
> > >
> > > On 3/16/07, Nicholas Lewin-Koh <nikko at hailmail.net> wrote:
> > > > Hi Tim,
> > > > I am not quite sure what you are getting at here. Do you want to
> > > > intersect
> > > > polygons and then select the set of lines that form the outer
> perimeter?
> > > > Do you wan the convex hull of a set of polygons. I guess I have
> been out
> > > > of the
> > > > GIS world to long. It seems to me that this would be something
> easy to
> > > > solve,
> > > > just tedious iteration of the polygon coordinates and some
> > > > triangulation.
> > > >
> > > > Nicholas
> > > >
> > > > > Date: Thu, 15 Mar 2007 10:49:23 -0500
> > > > > From: "Tim Keitt" <tkeitt at gmail.com>
> > > > > Subject: [R-sig-Geo] polygons to arcs?
> > > > > To: r-sig-geo at stat.math.ethz.ch
> > > > > Message-ID:
> > > > >
> <6262c54c0703150849qe60ab14nfef1eb3bf73dfb5d at mail.gmail.com>
> > > > > Content-Type: text/plain; charset=ISO-8859-1; format=flowed
> > > > >
> > > > > Is there an 'sp' function that takes a polygon as its argument
> and
> > > > > returns a set of line objects corresponding to the arcs in the
> > > > > polygon?
> > > > >
> > > > > Or better yet, a function that given a set of polygons, returns
> the
> > > > > hull? (ie the set of singleton arcs after applying the polys to
> arcs
> > > > > function)
> > > > >
> > > > > THK
> > > > >
> > > > > --
> > > > > Timothy H. Keitt, University of Texas at Austin
> > > > > Contact info and schedule at http://www.keittlab.org/tkeitt/
> > > > > Reprints at http://www.keittlab.org/tkeitt/papers/
> > > > > ODF attachment? See http://www.openoffice.org/
> > > > >
> > > > >
> > > > >
> > > >
> > >
> > >
> > > --
> > > Timothy H. Keitt, University of Texas at Austin
> > > Contact info and schedule at http://www.keittlab.org/tkeitt/
> > > Reprints at http://www.keittlab.org/tkeitt/papers/
> > > ODF attachment? See http://www.openoffice.org/
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at stat.math.ethz.ch
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From tkeitt at gmail.com  Fri Mar 16 19:11:19 2007
From: tkeitt at gmail.com (Tim Keitt)
Date: Fri, 16 Mar 2007 13:11:19 -0500
Subject: [R-sig-Geo] agenda for R's Geo capabilities?
In-Reply-To: <OFC926C48F.BD549B28-ON882572A0.00569301-882572A0.00587957@epamail.epa.gov>
References: <1174056779.24035.1179814653@webmail.messagingengine.com>
	<OFC926C48F.BD549B28-ON882572A0.00569301-882572A0.00587957@epamail.epa.gov>
Message-ID: <6262c54c0703161111q5dad8dedse43f2c8b8154886e@mail.gmail.com>

Denis,

I was just about to reply to Nicholas that my ideal solution would be
to build a graph data structure linking adjacent elements and find the
the hull that way -- I think you saw the solution before I did. (I'm
starting to grok that all of this is already well known in the vector
GIS world where topology has been thoroughly studied.)

I'd be happy to discuss with folks the idea of using the Boost Graph
Library to implement topological relationships for spatial objects.
We've already produced code that links the BGL to GDAL -- specify an
adjacency rule and then run eg cost path analysis on GDAL rasters
(look for this on sourceforge soon). It would also be possible to
implement something similar with vector objects.

My OSGeo summer of code idea is to link the BGL to postgis. I wasn't
originally thinking about topology per se, but it would achieve much
the same thing.

If people have ideas about how to fund these sorts of things, I'd be
happy to hear about it. The implementation end is rather far from my
core research. Its mostly been side projects.

THK


On 3/16/07, White.Denis at epamail.epa.gov <White.Denis at epamail.epa.gov> wrote:
> The thread below and many others in R-sig-Geo raise questions about
> future directions.  In reinventing GIS there are a whole list of
> capabilities and functions that would be helpful.  Some that I have
> noticed include,
>
> Topological representation to enable
>       Planar enforcement of boundary integrity of polygon tessellations
>       "Dissolving" interior edges easily as in the thread below
> Large problem computational geometry functions
>       Identify many points inside of many polygons
>       Intersections/overlays of two sets of many polygons
>       Distances between all pairs of many polygons
>
> Are there members of the R Geo community working on any of these?
> Are these issues seen as an exclusive focus of commercial GIS?
> Are there discussions about these issues at relevant conferences?
>
> (I will be at AAG in San Francisco and would be happy to meet with
> others if there is interest.)
>
> r-sig-geo-bounces at stat.math.ethz.ch wrote on 2007-03-16 07:52:59:
>
> > Hi Tim,
> > You could compute the convex hull first, and then iterate from points
> > on the convex hull. That should be much faster already, especially
> since
> > hexagons are convex and the perimeter will be locally convex around
> all
> > the
> > points touching the convex hull. You could do a variation
> > of the "monotone pieces" algorithm that is used in computational
> > geometry.
> > But this is a simpler problem. Are there cases with interior holes?
> >
> > I have been meaning to write something like this for hexbin for a
> while.
> > There
> > are many cases where it would be nice to find approximations to the
> > density contours
> > and a quick and dirty way is to threshold the hexagon counts, find the
> > hull and
> > smooth the perimeter.
> >
> > Nicholas
> >
> > On Fri, 16 Mar 2007 08:34:20 -0500, "Tim Keitt" <tkeitt at gmail.com>
> said:
> > > Hi Nic,
> > >
> > > The convex hull would be fast and easy to compute (there's existing
> > > code in R). I want the ordinary hull which is the set of arcs
> forming
> > > the perimeters (inside and out). My crude and very slow solution was
> > > to convert all the polygons (in this case hexagons on a lattice)
> into
> > > their constituent arcs and then for each arc count how many times it
> > > occurs in the set (requires slightly fuzzy matching of points). Arcs
> > > that occur more than once are removed. The remaining arcs form the
> > > hull. Runs in about 20 minutes with a  few hundred hexagons.
> > > Sufficient for the moment.
> > >
> > > THK
> > >
> > > On 3/16/07, Nicholas Lewin-Koh <nikko at hailmail.net> wrote:
> > > > Hi Tim,
> > > > I am not quite sure what you are getting at here. Do you want to
> > > > intersect
> > > > polygons and then select the set of lines that form the outer
> perimeter?
> > > > Do you wan the convex hull of a set of polygons. I guess I have
> been out
> > > > of the
> > > > GIS world to long. It seems to me that this would be something
> easy to
> > > > solve,
> > > > just tedious iteration of the polygon coordinates and some
> > > > triangulation.
> > > >
> > > > Nicholas
> > > >
> > > > > Date: Thu, 15 Mar 2007 10:49:23 -0500
> > > > > From: "Tim Keitt" <tkeitt at gmail.com>
> > > > > Subject: [R-sig-Geo] polygons to arcs?
> > > > > To: r-sig-geo at stat.math.ethz.ch
> > > > > Message-ID:
> > > > >
> <6262c54c0703150849qe60ab14nfef1eb3bf73dfb5d at mail.gmail.com>
> > > > > Content-Type: text/plain; charset=ISO-8859-1; format=flowed
> > > > >
> > > > > Is there an 'sp' function that takes a polygon as its argument
> and
> > > > > returns a set of line objects corresponding to the arcs in the
> > > > > polygon?
> > > > >
> > > > > Or better yet, a function that given a set of polygons, returns
> the
> > > > > hull? (ie the set of singleton arcs after applying the polys to
> arcs
> > > > > function)
> > > > >
> > > > > THK
> > > > >
> > > > > --
> > > > > Timothy H. Keitt, University of Texas at Austin
> > > > > Contact info and schedule at http://www.keittlab.org/tkeitt/
> > > > > Reprints at http://www.keittlab.org/tkeitt/papers/
> > > > > ODF attachment? See http://www.openoffice.org/
> > > > >
> > > > >
> > > > >
> > > >
> > >
> > >
> > > --
> > > Timothy H. Keitt, University of Texas at Austin
> > > Contact info and schedule at http://www.keittlab.org/tkeitt/
> > > Reprints at http://www.keittlab.org/tkeitt/papers/
> > > ODF attachment? See http://www.openoffice.org/
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at stat.math.ethz.ch
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


-- 
Timothy H. Keitt, University of Texas at Austin
Contact info and schedule at http://www.keittlab.org/tkeitt/
Reprints at http://www.keittlab.org/tkeitt/papers/
ODF attachment? See http://www.openoffice.org/



From elw at stderr.org  Fri Mar 16 19:40:24 2007
From: elw at stderr.org (elw at stderr.org)
Date: Fri, 16 Mar 2007 13:40:24 -0500 (CDT)
Subject: [R-sig-Geo] agenda for R's Geo capabilities?
In-Reply-To: <6262c54c0703161111q5dad8dedse43f2c8b8154886e@mail.gmail.com>
References: <1174056779.24035.1179814653@webmail.messagingengine.com>
	<OFC926C48F.BD549B28-ON882572A0.00569301-882572A0.00587957@epamail.epa.gov>
	<6262c54c0703161111q5dad8dedse43f2c8b8154886e@mail.gmail.com>
Message-ID: <Pine.LNX.4.64.0703161337520.22236@illuminati.stderr.org>



> My OSGeo summer of code idea is to link the BGL to postgis. I wasn't 
> originally thinking about topology per se, but it would achieve much the 
> same thing.


I've thought a bit about this project, too, as it butts up against some of 
my own work.

My experience with graph libraries has not been altogether positive.  ;) 
They are rather difficult to coerce into handling very large data sets.

I think it would be handy to have a layer to pump graph data through BGL 
into a postgis store.  It would be even better if that postgis store 
looked something similar to the store used as a backend by the 
Redland/Raptor xml graph serialization bits.  :-)  Just a suggestion for a 
place to start.... I know the redland/raptor bits are extremely 
scale-friendly for attributed graph data.

--elijah



From tkeitt at gmail.com  Fri Mar 16 19:54:30 2007
From: tkeitt at gmail.com (Tim Keitt)
Date: Fri, 16 Mar 2007 13:54:30 -0500
Subject: [R-sig-Geo] agenda for R's Geo capabilities?
In-Reply-To: <Pine.LNX.4.64.0703161337520.22236@illuminati.stderr.org>
References: <1174056779.24035.1179814653@webmail.messagingengine.com>
	<OFC926C48F.BD549B28-ON882572A0.00569301-882572A0.00587957@epamail.epa.gov>
	<6262c54c0703161111q5dad8dedse43f2c8b8154886e@mail.gmail.com>
	<Pine.LNX.4.64.0703161337520.22236@illuminati.stderr.org>
Message-ID: <6262c54c0703161154j1cb132f6k66bdb8f13c2e4cd3@mail.gmail.com>

On 3/16/07, elw at stderr.org <elw at stderr.org> wrote:
>
>
> > My OSGeo summer of code idea is to link the BGL to postgis. I wasn't
> > originally thinking about topology per se, but it would achieve much the
> > same thing.
>
>
> I've thought a bit about this project, too, as it butts up against some of
> my own work.
>
> My experience with graph libraries has not been altogether positive.  ;)
> They are rather difficult to coerce into handling very large data sets.

Our approach is not to store the vertex/edge information in the graph
library, but rather to model it with iterator interfaces. Generic
programming methods make this possible. Essentially, GDAL becomes the
data storage mechanism and the graph is implicit. The limits in this
case are likely the algorithmic complexity rather than data storage
(the step of building a graph data structure is entirely avoided). Of
course there may be better alternatives that are custom built for the
problem.

Vertex/edge iterators could also be backed by postgis or any other
data source with sufficient structure to specify adjacency. The
enormous value from my perspective is that effort coding algorithms
becomes reusable in many contexts.

THK

>
> I think it would be handy to have a layer to pump graph data through BGL
> into a postgis store.  It would be even better if that postgis store
> looked something similar to the store used as a backend by the
> Redland/Raptor xml graph serialization bits.  :-)  Just a suggestion for a
> place to start.... I know the redland/raptor bits are extremely
> scale-friendly for attributed graph data.

I've never heard of it, but like I say, this is pretty far from my core areas.

THK

>
> --elijah
>
>


-- 
Timothy H. Keitt, University of Texas at Austin
Contact info and schedule at http://www.keittlab.org/tkeitt/
Reprints at http://www.keittlab.org/tkeitt/papers/
ODF attachment? See http://www.openoffice.org/



From e.pebesma at geo.uu.nl  Fri Mar 16 21:50:07 2007
From: e.pebesma at geo.uu.nl (Edzer J. Pebesma)
Date: Fri, 16 Mar 2007 21:50:07 +0100
Subject: [R-sig-Geo] agenda for R's Geo capabilities?
In-Reply-To: <OFC926C48F.BD549B28-ON882572A0.00569301-882572A0.00587957@epamail.epa.gov>
References: <OFC926C48F.BD549B28-ON882572A0.00569301-882572A0.00587957@epamail.epa.gov>
Message-ID: <45FB02FF.4030701@geo.uu.nl>

Although I'm interested many of the issues below, and also feel the 
attraction of the develop-it-ourself, my personal agenda is a bit more 
modest. Once we start with GEOS support (an idea mentioned every 6 
months on this list), the next thing we need for dealing with huge or 
massive data sets is a clever indexing structure. After that, full 
topology. I find it hard to imagine where the resources should come from 
for all these things that are available in OSGeo next door -- we can't 
settle with proof of concepts, but want quality stuff. OTOH, one day a 
student may come in who just finished two of these projects.

My primary goal is to get sp stable, and adopted by more of the numerous 
packages for analyzing spatial data in R. And yes, I did introduce an 
instabillity this week -- try [ on a SpatialPolygonsDataFrame with NA 
values in the row index. There's a lot of code, much of which is little 
tested and/or not very clean. Another goals is to get a good and smooth 
system where R works as a back-end in interopable systems, possibly 
using PostGIS to transfer data. Finally: further proof that R is a 
increasingly wonderful system for analyzinig spatial data.
--
Edzer

White.Denis at epamail.epa.gov wrote:
> The thread below and many others in R-sig-Geo raise questions about
> future directions.  In reinventing GIS there are a whole list of
> capabilities and functions that would be helpful.  Some that I have
> noticed include,
>
> Topological representation to enable
>       Planar enforcement of boundary integrity of polygon tessellations
>       "Dissolving" interior edges easily as in the thread below
> Large problem computational geometry functions
>       Identify many points inside of many polygons
>       Intersections/overlays of two sets of many polygons
>       Distances between all pairs of many polygons
>
> Are there members of the R Geo community working on any of these?
> Are these issues seen as an exclusive focus of commercial GIS?
> Are there discussions about these issues at relevant conferences?
>
> (I will be at AAG in San Francisco and would be happy to meet with
> others if there is interest.)
>
> r-sig-geo-bounces at stat.math.ethz.ch wrote on 2007-03-16 07:52:59:
>
>   
>> Hi Tim,
>> You could compute the convex hull first, and then iterate from points
>> on the convex hull. That should be much faster already, especially
>>     
> since
>   
>> hexagons are convex and the perimeter will be locally convex around
>>     
> all
>   
>> the
>> points touching the convex hull. You could do a variation
>> of the "monotone pieces" algorithm that is used in computational
>> geometry.
>> But this is a simpler problem. Are there cases with interior holes?
>>
>> I have been meaning to write something like this for hexbin for a
>>     
> while.
>   
>> There
>> are many cases where it would be nice to find approximations to the
>> density contours
>> and a quick and dirty way is to threshold the hexagon counts, find the
>> hull and
>> smooth the perimeter.
>>
>> Nicholas
>>
>> On Fri, 16 Mar 2007 08:34:20 -0500, "Tim Keitt" <tkeitt at gmail.com>
>>     
> said:
>   
>>> Hi Nic,
>>>
>>> The convex hull would be fast and easy to compute (there's existing
>>> code in R). I want the ordinary hull which is the set of arcs
>>>       
> forming
>   
>>> the perimeters (inside and out). My crude and very slow solution was
>>> to convert all the polygons (in this case hexagons on a lattice)
>>>       
> into
>   
>>> their constituent arcs and then for each arc count how many times it
>>> occurs in the set (requires slightly fuzzy matching of points). Arcs
>>> that occur more than once are removed. The remaining arcs form the
>>> hull. Runs in about 20 minutes with a  few hundred hexagons.
>>> Sufficient for the moment.
>>>
>>> THK
>>>
>>> On 3/16/07, Nicholas Lewin-Koh <nikko at hailmail.net> wrote:
>>>       
>>>> Hi Tim,
>>>> I am not quite sure what you are getting at here. Do you want to
>>>> intersect
>>>> polygons and then select the set of lines that form the outer
>>>>         
> perimeter?
>   
>>>> Do you wan the convex hull of a set of polygons. I guess I have
>>>>         
> been out
>   
>>>> of the
>>>> GIS world to long. It seems to me that this would be something
>>>>         
> easy to
>   
>>>> solve,
>>>> just tedious iteration of the polygon coordinates and some
>>>> triangulation.
>>>>
>>>> Nicholas
>>>>
>>>>         
>>>>> Date: Thu, 15 Mar 2007 10:49:23 -0500
>>>>> From: "Tim Keitt" <tkeitt at gmail.com>
>>>>> Subject: [R-sig-Geo] polygons to arcs?
>>>>> To: r-sig-geo at stat.math.ethz.ch
>>>>> Message-ID:
>>>>>
>>>>>           
> <6262c54c0703150849qe60ab14nfef1eb3bf73dfb5d at mail.gmail.com>
>   
>>>>> Content-Type: text/plain; charset=ISO-8859-1; format=flowed
>>>>>
>>>>> Is there an 'sp' function that takes a polygon as its argument
>>>>>           
> and
>   
>>>>> returns a set of line objects corresponding to the arcs in the
>>>>> polygon?
>>>>>
>>>>> Or better yet, a function that given a set of polygons, returns
>>>>>           
> the
>   
>>>>> hull? (ie the set of singleton arcs after applying the polys to
>>>>>           
> arcs
>   
>>>>> function)
>>>>>
>>>>> THK
>>>>>
>>>>> --
>>>>> Timothy H. Keitt, University of Texas at Austin
>>>>> Contact info and schedule at http://www.keittlab.org/tkeitt/
>>>>> Reprints at http://www.keittlab.org/tkeitt/papers/
>>>>> ODF attachment? See http://www.openoffice.org/
>>>>>
>>>>>
>>>>>
>>>>>           
>>> --
>>> Timothy H. Keitt, University of Texas at Austin
>>> Contact info and schedule at http://www.keittlab.org/tkeitt/
>>> Reprints at http://www.keittlab.org/tkeitt/papers/
>>> ODF attachment? See http://www.openoffice.org/
>>>       
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>     
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>



From ggrothendieck at gmail.com  Fri Mar 16 22:00:16 2007
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Fri, 16 Mar 2007 17:00:16 -0400
Subject: [R-sig-Geo] agenda for R's Geo capabilities?
In-Reply-To: <45FB02FF.4030701@geo.uu.nl>
References: <OFC926C48F.BD549B28-ON882572A0.00569301-882572A0.00587957@epamail.epa.gov>
	<45FB02FF.4030701@geo.uu.nl>
Message-ID: <971536df0703161400m6d6a3cf9k28dfec1f70d82259@mail.gmail.com>

In my opinion the first item on the agenda should be to
get good documentation in place including many examples.

On 3/16/07, Edzer J. Pebesma <e.pebesma at geo.uu.nl> wrote:
> Although I'm interested many of the issues below, and also feel the
> attraction of the develop-it-ourself, my personal agenda is a bit more
> modest. Once we start with GEOS support (an idea mentioned every 6
> months on this list), the next thing we need for dealing with huge or
> massive data sets is a clever indexing structure. After that, full
> topology. I find it hard to imagine where the resources should come from
> for all these things that are available in OSGeo next door -- we can't
> settle with proof of concepts, but want quality stuff. OTOH, one day a
> student may come in who just finished two of these projects.
>
> My primary goal is to get sp stable, and adopted by more of the numerous
> packages for analyzing spatial data in R. And yes, I did introduce an
> instabillity this week -- try [ on a SpatialPolygonsDataFrame with NA
> values in the row index. There's a lot of code, much of which is little
> tested and/or not very clean. Another goals is to get a good and smooth
> system where R works as a back-end in interopable systems, possibly
> using PostGIS to transfer data. Finally: further proof that R is a
> increasingly wonderful system for analyzinig spatial data.
> --
> Edzer
>
> White.Denis at epamail.epa.gov wrote:
> > The thread below and many others in R-sig-Geo raise questions about
> > future directions.  In reinventing GIS there are a whole list of
> > capabilities and functions that would be helpful.  Some that I have
> > noticed include,
> >
> > Topological representation to enable
> >       Planar enforcement of boundary integrity of polygon tessellations
> >       "Dissolving" interior edges easily as in the thread below
> > Large problem computational geometry functions
> >       Identify many points inside of many polygons
> >       Intersections/overlays of two sets of many polygons
> >       Distances between all pairs of many polygons
> >
> > Are there members of the R Geo community working on any of these?
> > Are these issues seen as an exclusive focus of commercial GIS?
> > Are there discussions about these issues at relevant conferences?
> >
> > (I will be at AAG in San Francisco and would be happy to meet with
> > others if there is interest.)
> >
> > r-sig-geo-bounces at stat.math.ethz.ch wrote on 2007-03-16 07:52:59:
> >
> >
> >> Hi Tim,
> >> You could compute the convex hull first, and then iterate from points
> >> on the convex hull. That should be much faster already, especially
> >>
> > since
> >
> >> hexagons are convex and the perimeter will be locally convex around
> >>
> > all
> >
> >> the
> >> points touching the convex hull. You could do a variation
> >> of the "monotone pieces" algorithm that is used in computational
> >> geometry.
> >> But this is a simpler problem. Are there cases with interior holes?
> >>
> >> I have been meaning to write something like this for hexbin for a
> >>
> > while.
> >
> >> There
> >> are many cases where it would be nice to find approximations to the
> >> density contours
> >> and a quick and dirty way is to threshold the hexagon counts, find the
> >> hull and
> >> smooth the perimeter.
> >>
> >> Nicholas
> >>
> >> On Fri, 16 Mar 2007 08:34:20 -0500, "Tim Keitt" <tkeitt at gmail.com>
> >>
> > said:
> >
> >>> Hi Nic,
> >>>
> >>> The convex hull would be fast and easy to compute (there's existing
> >>> code in R). I want the ordinary hull which is the set of arcs
> >>>
> > forming
> >
> >>> the perimeters (inside and out). My crude and very slow solution was
> >>> to convert all the polygons (in this case hexagons on a lattice)
> >>>
> > into
> >
> >>> their constituent arcs and then for each arc count how many times it
> >>> occurs in the set (requires slightly fuzzy matching of points). Arcs
> >>> that occur more than once are removed. The remaining arcs form the
> >>> hull. Runs in about 20 minutes with a  few hundred hexagons.
> >>> Sufficient for the moment.
> >>>
> >>> THK
> >>>
> >>> On 3/16/07, Nicholas Lewin-Koh <nikko at hailmail.net> wrote:
> >>>
> >>>> Hi Tim,
> >>>> I am not quite sure what you are getting at here. Do you want to
> >>>> intersect
> >>>> polygons and then select the set of lines that form the outer
> >>>>
> > perimeter?
> >
> >>>> Do you wan the convex hull of a set of polygons. I guess I have
> >>>>
> > been out
> >
> >>>> of the
> >>>> GIS world to long. It seems to me that this would be something
> >>>>
> > easy to
> >
> >>>> solve,
> >>>> just tedious iteration of the polygon coordinates and some
> >>>> triangulation.
> >>>>
> >>>> Nicholas
> >>>>
> >>>>
> >>>>> Date: Thu, 15 Mar 2007 10:49:23 -0500
> >>>>> From: "Tim Keitt" <tkeitt at gmail.com>
> >>>>> Subject: [R-sig-Geo] polygons to arcs?
> >>>>> To: r-sig-geo at stat.math.ethz.ch
> >>>>> Message-ID:
> >>>>>
> >>>>>
> > <6262c54c0703150849qe60ab14nfef1eb3bf73dfb5d at mail.gmail.com>
> >
> >>>>> Content-Type: text/plain; charset=ISO-8859-1; format=flowed
> >>>>>
> >>>>> Is there an 'sp' function that takes a polygon as its argument
> >>>>>
> > and
> >
> >>>>> returns a set of line objects corresponding to the arcs in the
> >>>>> polygon?
> >>>>>
> >>>>> Or better yet, a function that given a set of polygons, returns
> >>>>>
> > the
> >
> >>>>> hull? (ie the set of singleton arcs after applying the polys to
> >>>>>
> > arcs
> >
> >>>>> function)
> >>>>>
> >>>>> THK
> >>>>>
> >>>>> --
> >>>>> Timothy H. Keitt, University of Texas at Austin
> >>>>> Contact info and schedule at http://www.keittlab.org/tkeitt/
> >>>>> Reprints at http://www.keittlab.org/tkeitt/papers/
> >>>>> ODF attachment? See http://www.openoffice.org/
> >>>>>
> >>>>>
> >>>>>
> >>>>>
> >>> --
> >>> Timothy H. Keitt, University of Texas at Austin
> >>> Contact info and schedule at http://www.keittlab.org/tkeitt/
> >>> Reprints at http://www.keittlab.org/tkeitt/papers/
> >>> ODF attachment? See http://www.openoffice.org/
> >>>
> >> _______________________________________________
> >> R-sig-Geo mailing list
> >> R-sig-Geo at stat.math.ethz.ch
> >> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >>
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at stat.math.ethz.ch
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>



From milton_ruser at yahoo.com.br  Sun Mar 18 06:20:32 2007
From: milton_ruser at yahoo.com.br (Milton Cezar Ribeiro)
Date: Sat, 17 Mar 2007 22:20:32 -0700 (PDT)
Subject: [R-sig-Geo] Shape to AscGrid
Message-ID: <20070318052032.79474.qmail@web56607.mail.re3.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20070317/23361da6/attachment.pl>

From Roger.Bivand at nhh.no  Sun Mar 18 13:50:58 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sun, 18 Mar 2007 13:50:58 +0100 (CET)
Subject: [R-sig-Geo] Shape to AscGrid
In-Reply-To: <20070318052032.79474.qmail@web56607.mail.re3.yahoo.com>
Message-ID: <Pine.LNX.4.44.0703181344580.18374-100000@reclus.nhh.no>

On Sat, 17 Mar 2007, Milton Cezar Ribeiro wrote:

> Dear helpers
> 
> I need convert a shape file to AscGrid format. How can I select a field,
> convert to AscGrid and save as ascii file?

This should work:

library(maptools)
xx <- readShapePoly(system.file("shapes/sids.shp", package="maptools")[1], 
  IDvar="FIPSNO", proj4string=CRS("+proj=longlat +ellps=clrk66"))
grd <- GE_SpatialGrid(xx, asp=1, maxPixels=100)$SG
# to make a SpatialGrid object, could use GridTopology() directly, here 
# asp=1 to be sure that cells are square
summary(grd)
poly_which <- overlay(xx, grd)
# copies out the polygon field values to the appropriate grid cells
summary(poly_which)
SGDF <- SpatialGridDataFrame(slot(grd, "grid"), data=poly_which, 
  proj4string=CRS(proj4string(grd))
image(SGDF, "BIR74")
plot(xx, add=TRUE)
writeAsciiGrid(SGDF, "BIR74.aai", "BIR74")

Of course, you could compute rates, etc, on the SpatialPolygonDataFrame 
before copying the values out to the grid cells, and you could drop data 
columns in the SpatialPolygonDataFrame first to avoid unecessary copying. 
But this runs pretty quickly anyway.

Hope this helps,

Roger


> 
> Kind regards,
> 
> miltinho
> 
> __________________________________________________
> 
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From tkeitt at gmail.com  Sun Mar 18 21:14:17 2007
From: tkeitt at gmail.com (Tim Keitt)
Date: Sun, 18 Mar 2007 15:14:17 -0500
Subject: [R-sig-Geo] agenda for R's Geo capabilities?
In-Reply-To: <45FB02FF.4030701@geo.uu.nl>
References: <OFC926C48F.BD549B28-ON882572A0.00569301-882572A0.00587957@epamail.epa.gov>
	<45FB02FF.4030701@geo.uu.nl>
Message-ID: <6262c54c0703181314r1843f34ct73d1330bc0e78e1@mail.gmail.com>

I agree GEOS support would be welcome. I'd be happy to help out if
anyone takes this on.

I've been thinking of a possibly quicker (devel time) solution lately
since I've been using PostGIS a lot. One could have a postgis package
that copies 'sp' object into postgis and then provides postgis
function equivalents that operate on the R proxy objects.

pgobj1 <- new('PostGISGeom', my.spatial.polygons)
pgobj2 <- somePostGISOp(pgobj1, ...)

res.spatial.polygons <- PGObj2SPObj(pgobj2)  # or 'as' generic

The pgobj? objects could be first class 'sp' members if it is possible
to subclass the 'sp' geometry classes -- may not be possible as I
don't think you can overload the S4 slot call.

THK

On 3/16/07, Edzer J. Pebesma <e.pebesma at geo.uu.nl> wrote:
> Although I'm interested many of the issues below, and also feel the
> attraction of the develop-it-ourself, my personal agenda is a bit more
> modest. Once we start with GEOS support (an idea mentioned every 6
> months on this list), the next thing we need for dealing with huge or
> massive data sets is a clever indexing structure. After that, full
> topology. I find it hard to imagine where the resources should come from
> for all these things that are available in OSGeo next door -- we can't
> settle with proof of concepts, but want quality stuff. OTOH, one day a
> student may come in who just finished two of these projects.
>
> My primary goal is to get sp stable, and adopted by more of the numerous
> packages for analyzing spatial data in R. And yes, I did introduce an
> instabillity this week -- try [ on a SpatialPolygonsDataFrame with NA
> values in the row index. There's a lot of code, much of which is little
> tested and/or not very clean. Another goals is to get a good and smooth
> system where R works as a back-end in interopable systems, possibly
> using PostGIS to transfer data. Finally: further proof that R is a
> increasingly wonderful system for analyzinig spatial data.
> --
> Edzer
>
> White.Denis at epamail.epa.gov wrote:
> > The thread below and many others in R-sig-Geo raise questions about
> > future directions.  In reinventing GIS there are a whole list of
> > capabilities and functions that would be helpful.  Some that I have
> > noticed include,
> >
> > Topological representation to enable
> >       Planar enforcement of boundary integrity of polygon tessellations
> >       "Dissolving" interior edges easily as in the thread below
> > Large problem computational geometry functions
> >       Identify many points inside of many polygons
> >       Intersections/overlays of two sets of many polygons
> >       Distances between all pairs of many polygons
> >
> > Are there members of the R Geo community working on any of these?
> > Are these issues seen as an exclusive focus of commercial GIS?
> > Are there discussions about these issues at relevant conferences?
> >
> > (I will be at AAG in San Francisco and would be happy to meet with
> > others if there is interest.)
> >
> > r-sig-geo-bounces at stat.math.ethz.ch wrote on 2007-03-16 07:52:59:
> >
> >
> >> Hi Tim,
> >> You could compute the convex hull first, and then iterate from points
> >> on the convex hull. That should be much faster already, especially
> >>
> > since
> >
> >> hexagons are convex and the perimeter will be locally convex around
> >>
> > all
> >
> >> the
> >> points touching the convex hull. You could do a variation
> >> of the "monotone pieces" algorithm that is used in computational
> >> geometry.
> >> But this is a simpler problem. Are there cases with interior holes?
> >>
> >> I have been meaning to write something like this for hexbin for a
> >>
> > while.
> >
> >> There
> >> are many cases where it would be nice to find approximations to the
> >> density contours
> >> and a quick and dirty way is to threshold the hexagon counts, find the
> >> hull and
> >> smooth the perimeter.
> >>
> >> Nicholas
> >>
> >> On Fri, 16 Mar 2007 08:34:20 -0500, "Tim Keitt" <tkeitt at gmail.com>
> >>
> > said:
> >
> >>> Hi Nic,
> >>>
> >>> The convex hull would be fast and easy to compute (there's existing
> >>> code in R). I want the ordinary hull which is the set of arcs
> >>>
> > forming
> >
> >>> the perimeters (inside and out). My crude and very slow solution was
> >>> to convert all the polygons (in this case hexagons on a lattice)
> >>>
> > into
> >
> >>> their constituent arcs and then for each arc count how many times it
> >>> occurs in the set (requires slightly fuzzy matching of points). Arcs
> >>> that occur more than once are removed. The remaining arcs form the
> >>> hull. Runs in about 20 minutes with a  few hundred hexagons.
> >>> Sufficient for the moment.
> >>>
> >>> THK
> >>>
> >>> On 3/16/07, Nicholas Lewin-Koh <nikko at hailmail.net> wrote:
> >>>
> >>>> Hi Tim,
> >>>> I am not quite sure what you are getting at here. Do you want to
> >>>> intersect
> >>>> polygons and then select the set of lines that form the outer
> >>>>
> > perimeter?
> >
> >>>> Do you wan the convex hull of a set of polygons. I guess I have
> >>>>
> > been out
> >
> >>>> of the
> >>>> GIS world to long. It seems to me that this would be something
> >>>>
> > easy to
> >
> >>>> solve,
> >>>> just tedious iteration of the polygon coordinates and some
> >>>> triangulation.
> >>>>
> >>>> Nicholas
> >>>>
> >>>>
> >>>>> Date: Thu, 15 Mar 2007 10:49:23 -0500
> >>>>> From: "Tim Keitt" <tkeitt at gmail.com>
> >>>>> Subject: [R-sig-Geo] polygons to arcs?
> >>>>> To: r-sig-geo at stat.math.ethz.ch
> >>>>> Message-ID:
> >>>>>
> >>>>>
> > <6262c54c0703150849qe60ab14nfef1eb3bf73dfb5d at mail.gmail.com>
> >
> >>>>> Content-Type: text/plain; charset=ISO-8859-1; format=flowed
> >>>>>
> >>>>> Is there an 'sp' function that takes a polygon as its argument
> >>>>>
> > and
> >
> >>>>> returns a set of line objects corresponding to the arcs in the
> >>>>> polygon?
> >>>>>
> >>>>> Or better yet, a function that given a set of polygons, returns
> >>>>>
> > the
> >
> >>>>> hull? (ie the set of singleton arcs after applying the polys to
> >>>>>
> > arcs
> >
> >>>>> function)
> >>>>>
> >>>>> THK
> >>>>>
> >>>>> --
> >>>>> Timothy H. Keitt, University of Texas at Austin
> >>>>> Contact info and schedule at http://www.keittlab.org/tkeitt/
> >>>>> Reprints at http://www.keittlab.org/tkeitt/papers/
> >>>>> ODF attachment? See http://www.openoffice.org/
> >>>>>
> >>>>>
> >>>>>
> >>>>>
> >>> --
> >>> Timothy H. Keitt, University of Texas at Austin
> >>> Contact info and schedule at http://www.keittlab.org/tkeitt/
> >>> Reprints at http://www.keittlab.org/tkeitt/papers/
> >>> ODF attachment? See http://www.openoffice.org/
> >>>
> >> _______________________________________________
> >> R-sig-Geo mailing list
> >> R-sig-Geo at stat.math.ethz.ch
> >> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >>
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at stat.math.ethz.ch
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


-- 
Timothy H. Keitt, University of Texas at Austin
Contact info and schedule at http://www.keittlab.org/tkeitt/
Reprints at http://www.keittlab.org/tkeitt/papers/
ODF attachment? See http://www.openoffice.org/



From Sebastien.ollier at u-psud.fr  Tue Mar 20 13:27:55 2007
From: Sebastien.ollier at u-psud.fr (Sebastien)
Date: Tue, 20 Mar 2007 13:27:55 +0100
Subject: [R-sig-Geo] intersection of two polygons
Message-ID: <45FFD34B.9060605@u-psud.fr>

Dear helpers,

I need to find the intersection of two polygons. I have two overlapping 
polygons and I want to find the polygon corresponding to the common 
part. Is there a fonction, like unionSpatialPolygons which can do that. 
I have converted my polygons to "owin" and use the function 
'intersect.owin' in the pachage spatstat but it returns a binary matrice 
of class "owin" or I would prefer a polygon.

Thanks for your help,

S?bastien Ollier

####    ####    ####
S?bastien Ollier
Ma?tre de Conf?rences
Universit? Paris-Sud 11
Facult? des Sciences d'Orsay
Unit? Ecologie, Syst?matique et Evolution
D?partement Biodiversit?, Syst?matique et Evolution
UMR - 8079 UPS-CNRS-ENGREF
B?t. 360, 91405 ORSAY CEDEX
FRANCE
Tel : 33 (0) 1 69 15 56 70
Fax : 33 (0) 1 69 15 46 97
http://www.ese.u-psud.fr/
####    ####    ####
-------------- next part --------------
A non-text attachment was scrubbed...
Name: Sebastien.ollier.vcf
Type: text/x-vcard
Size: 188 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20070320/75dc3ee2/attachment.vcf>

From Roger.Bivand at nhh.no  Tue Mar 20 14:24:17 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 20 Mar 2007 14:24:17 +0100 (CET)
Subject: [R-sig-Geo] is there package can caculate shortest path with
 shp file in R?
In-Reply-To: <200703201833038123896@163.com>
Message-ID: <Pine.LNX.4.44.0703201413290.20019-100000@reclus.nhh.no>

On Tue, 20 Mar 2007, StinJia wrote:

> hello,everyone!i want to build a webgis application on transport,using R
> as Spatial server,and is there any package can caculate shortest path
> with shp file in R?
> 

Not directly. How you develop this will depend on your shapefile. If you 
can get to a matrix of "distances", you can use allShortestPaths() and 
extractPath() in the e1071 package, see:

RSiteSearch("shortest path")

These use full matrices rather than sparse matrices, so for real-scale 
problems, it may not be all you need, but it is a start.

If the shapefile is a network, you'll need to find out how to get two 
pieces of information from it: which two nodes it links, and the 
"distance" it represents - these are two different kinds of information, 
and may take some work. There is a graph package in Bioconductor, but I'm 
not sure that it will help. There also seem to be functions in the sna 
package. However, none of them are directly relevant to arcs and nodes 
from shapefiles.

Roger

> StinJia
> 2007-03-20
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From Roger.Bivand at nhh.no  Tue Mar 20 14:37:07 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 20 Mar 2007 14:37:07 +0100 (CET)
Subject: [R-sig-Geo] intersection of two polygons
In-Reply-To: <45FFD34B.9060605@u-psud.fr>
Message-ID: <Pine.LNX.4.44.0703201427100.20019-100000@reclus.nhh.no>

On Tue, 20 Mar 2007, Sebastien wrote:

> Dear helpers,
> 
> I need to find the intersection of two polygons. I have two overlapping 
> polygons and I want to find the polygon corresponding to the common 
> part. Is there a fonction, like unionSpatialPolygons which can do that. 
> I have converted my polygons to "owin" and use the function 
> 'intersect.owin' in the pachage spatstat but it returns a binary matrice 
> of class "owin" or I would prefer a polygon.

No, there is not. I think that joinPolys() in the PBSmapping package can
do this, and you can get to the PBS PolySet representation using
SpatialPolygons2PolySet() in the maptools package, but then you'd need to
get back again to SpatialPolygons, which would involve coding. The 
alternative of using gpclib like unionSpatialPolygons() would also 
involve coding.

Roger

> 
> Thanks for your help,
> 
> S?bastien Ollier
> 
> ####    ####    ####
> S?bastien Ollier
> Ma?tre de Conf?rences
> Universit? Paris-Sud 11
> Facult? des Sciences d'Orsay
> Unit? Ecologie, Syst?matique et Evolution
> D?partement Biodiversit?, Syst?matique et Evolution
> UMR - 8079 UPS-CNRS-ENGREF
> B?t. 360, 91405 ORSAY CEDEX
> FRANCE
> Tel : 33 (0) 1 69 15 56 70
> Fax : 33 (0) 1 69 15 46 97
> http://www.ese.u-psud.fr/
> ####    ####    ####
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From dray at biomserv.univ-lyon1.fr  Tue Mar 20 14:49:56 2007
From: dray at biomserv.univ-lyon1.fr (=?ISO-8859-1?Q?St=E9phane_Dray?=)
Date: Tue, 20 Mar 2007 14:49:56 +0100
Subject: [R-sig-Geo] intersection of two polygons
In-Reply-To: <Pine.LNX.4.44.0703201427100.20019-100000@reclus.nhh.no>
References: <Pine.LNX.4.44.0703201427100.20019-100000@reclus.nhh.no>
Message-ID: <45FFE684.7080802@biomserv.univ-lyon1.fr>

I have a code that do the job for polylist objects at 
http://biomserv.univ-lyon1.fr/~dray/files/softwares/spatialRLQ/spatialrlq.R

The function uses gpclib and only returns area or binary matrices (1 
intersect, 0 not). It could be easily modify to return the intersection 
of two polygons (remove the loops over the polylists and return interAB)



Roger Bivand wrote:
> On Tue, 20 Mar 2007, Sebastien wrote:
>
>   
>> Dear helpers,
>>
>> I need to find the intersection of two polygons. I have two overlapping 
>> polygons and I want to find the polygon corresponding to the common 
>> part. Is there a fonction, like unionSpatialPolygons which can do that. 
>> I have converted my polygons to "owin" and use the function 
>> 'intersect.owin' in the pachage spatstat but it returns a binary matrice 
>> of class "owin" or I would prefer a polygon.
>>     
>
> No, there is not. I think that joinPolys() in the PBSmapping package can
> do this, and you can get to the PBS PolySet representation using
> SpatialPolygons2PolySet() in the maptools package, but then you'd need to
> get back again to SpatialPolygons, which would involve coding. The 
> alternative of using gpclib like unionSpatialPolygons() would also 
> involve coding.
>
> Roger
>
>   
>> Thanks for your help,
>>
>> S?bastien Ollier
>>
>> ####    ####    ####
>> S?bastien Ollier
>> Ma?tre de Conf?rences
>> Universit? Paris-Sud 11
>> Facult? des Sciences d'Orsay
>> Unit? Ecologie, Syst?matique et Evolution
>> D?partement Biodiversit?, Syst?matique et Evolution
>> UMR - 8079 UPS-CNRS-ENGREF
>> B?t. 360, 91405 ORSAY CEDEX
>> FRANCE
>> Tel : 33 (0) 1 69 15 56 70
>> Fax : 33 (0) 1 69 15 46 97
>> http://www.ese.u-psud.fr/
>> ####    ####    ####
>>
>>     
>
>   


-- 
St?phane DRAY (dray at biomserv.univ-lyon1.fr )
Laboratoire BBE-CNRS-UMR-5558, Univ. C. Bernard - Lyon I
43, Bd du 11 Novembre 1918, 69622 Villeurbanne Cedex, France
Tel: 33 4 72 43 27 57       Fax: 33 4 72 43 13 88
http://biomserv.univ-lyon1.fr/~dray/



From andrew.niccolai at yale.edu  Tue Mar 20 20:08:00 2007
From: andrew.niccolai at yale.edu (Andrew Niccolai)
Date: Tue, 20 Mar 2007 15:08:00 -0400
Subject: [R-sig-Geo] Distances between points bounded by a polygon
In-Reply-To: <Pine.LNX.4.44.0703201427100.20019-100000@reclus.nhh.no>
References: <45FFD34B.9060605@u-psud.fr>
	<Pine.LNX.4.44.0703201427100.20019-100000@reclus.nhh.no>
Message-ID: <000f01c76b23$141bebb0$0302a8c0@D3K86YB1>

Greetings spatial R users,

I have a question that is most likely straightforward but I am stuck on this
one!

I have a set of points that can be of the class "SpatialPoints" or of the
class "ppp" and they reside within a polygon of the class either
"SpatialPolygons" or "owin".  I also have a set of pixels of class
"SpatialGridDataFrame" associated with the polygon.  I would like to
calculate the distance between the points for every pixel in the
"SpatialGridDataFrame" that is bounded by the polygon/owin object.
Essentially the distmap function in spatstats package is what I am striving
for but it seems to produce a distance map that is bounded by a rectangular
"bounding box" of the extreme points.  I have tried to set the as.mask
function but it gives me an error:  
"
>V <- distmap(test7, as.mask(test8))
>Error in diff(w$yrange)/eps : non-numeric argument to binary operator
"

Any ideas or code that would enable me to "spread" that distance map
function across the entire polygon/owin or SpatialGridDF would be
tremendously appreciated.

Again, I would like to thank the the people that take the time to ask and
those that answer these types of questions on the list serve!!

Cheers
Andrew Niccolai
Doctoral Candidate
Yale University



From Roger.Bivand at nhh.no  Wed Mar 21 10:32:57 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 21 Mar 2007 10:32:57 +0100 (CET)
Subject: [R-sig-Geo] intersection of two polygons
In-Reply-To: <45FFE684.7080802@biomserv.univ-lyon1.fr>
Message-ID: <Pine.LNX.4.44.0703211030480.21600-100000@reclus.nhh.no>

On Tue, 20 Mar 2007, St?phane Dray wrote:

> I have a code that do the job for polylist objects at 
> http://biomserv.univ-lyon1.fr/~dray/files/softwares/spatialRLQ/spatialrlq.R
> 
> The function uses gpclib and only returns area or binary matrices (1 
> intersect, 0 not). It could be easily modify to return the intersection 
> of two polygons (remove the loops over the polylists and return interAB)
> 

Thanks, this will be useful, especially for users searching the archives! 
This also relates to the question of how much vector GIS functionality 
should be within R.

Roger

> 
> 
> Roger Bivand wrote:
> > On Tue, 20 Mar 2007, Sebastien wrote:
> >
> >   
> >> Dear helpers,
> >>
> >> I need to find the intersection of two polygons. I have two overlapping 
> >> polygons and I want to find the polygon corresponding to the common 
> >> part. Is there a fonction, like unionSpatialPolygons which can do that. 
> >> I have converted my polygons to "owin" and use the function 
> >> 'intersect.owin' in the pachage spatstat but it returns a binary matrice 
> >> of class "owin" or I would prefer a polygon.
> >>     
> >
> > No, there is not. I think that joinPolys() in the PBSmapping package can
> > do this, and you can get to the PBS PolySet representation using
> > SpatialPolygons2PolySet() in the maptools package, but then you'd need to
> > get back again to SpatialPolygons, which would involve coding. The 
> > alternative of using gpclib like unionSpatialPolygons() would also 
> > involve coding.
> >
> > Roger
> >
> >   
> >> Thanks for your help,
> >>
> >> S?bastien Ollier
> >>
> >> ####    ####    ####
> >> S?bastien Ollier
> >> Ma?tre de Conf?rences
> >> Universit? Paris-Sud 11
> >> Facult? des Sciences d'Orsay
> >> Unit? Ecologie, Syst?matique et Evolution
> >> D?partement Biodiversit?, Syst?matique et Evolution
> >> UMR - 8079 UPS-CNRS-ENGREF
> >> B?t. 360, 91405 ORSAY CEDEX
> >> FRANCE
> >> Tel : 33 (0) 1 69 15 56 70
> >> Fax : 33 (0) 1 69 15 46 97
> >> http://www.ese.u-psud.fr/
> >> ####    ####    ####
> >>
> >>     
> >
> >   
> 
> 
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From Roger.Bivand at nhh.no  Wed Mar 21 10:57:52 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 21 Mar 2007 10:57:52 +0100 (CET)
Subject: [R-sig-Geo] Distances between points bounded by a polygon
In-Reply-To: <000f01c76b23$141bebb0$0302a8c0@D3K86YB1>
Message-ID: <Pine.LNX.4.44.0703211054360.21600-100000@reclus.nhh.no>

On Tue, 20 Mar 2007, Andrew Niccolai wrote:

> Greetings spatial R users,
> 
> I have a question that is most likely straightforward but I am stuck on this
> one!
> 
> I have a set of points that can be of the class "SpatialPoints" or of the
> class "ppp" and they reside within a polygon of the class either
> "SpatialPolygons" or "owin".  I also have a set of pixels of class
> "SpatialGridDataFrame" associated with the polygon.  I would like to
> calculate the distance between the points for every pixel in the
> "SpatialGridDataFrame" that is bounded by the polygon/owin object.
> Essentially the distmap function in spatstats package is what I am striving
> for but it seems to produce a distance map that is bounded by a rectangular
> "bounding box" of the extreme points.  I have tried to set the as.mask
> function but it gives me an error:  
> "
> >V <- distmap(test7, as.mask(test8))
> >Error in diff(w$yrange)/eps : non-numeric argument to binary operator
> "
> 
> Any ideas or code that would enable me to "spread" that distance map
> function across the entire polygon/owin or SpatialGridDF would be
> tremendously appreciated.

In cases like these, it would be enormously helpful to have access to a 
toy data set, for example a set.seed() runtime generated set of points, 
convex hull generated polygon and grid (via overlay), and your code so far 
illustrating the problem. Otherwise it is very easy to answer what appears 
to be the question but isn't. The spatstat package is very rich, and I'd 
be surprised if there isn't a way of doing this directly with its 
functionality.

Roger


> 
> Again, I would like to thank the the people that take the time to ask and
> those that answer these types of questions on the list serve!!
> 
> Cheers
> Andrew Niccolai
> Doctoral Candidate
> Yale University
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From dray at biomserv.univ-lyon1.fr  Wed Mar 21 11:26:36 2007
From: dray at biomserv.univ-lyon1.fr (=?ISO-8859-1?Q?St=E9phane_Dray?=)
Date: Wed, 21 Mar 2007 11:26:36 +0100
Subject: [R-sig-Geo] intersection of two polygons
In-Reply-To: <Pine.LNX.4.44.0703211030480.21600-100000@reclus.nhh.no>
References: <Pine.LNX.4.44.0703211030480.21600-100000@reclus.nhh.no>
Message-ID: <4601085C.4030402@biomserv.univ-lyon1.fr>

I just checked the code and see that my function was not optimal (too 
much loops). I think that it can be easily improve and I can try to 
write a intersectSpatialPolygons.  There is a unionSpatialPolygons in 
maptools, I think that an intersect function could be also useful. For 
instance, one thing  that I would like to do in R (but I never succeed): 
I have a set of points from which I construct a Voronoi mosaic, I have 
also a polygon of my whole study area, I would like to cut the mosaic 
using the polygon. I now that there is an Arcview extension to do it but 
it would be nice to have also this functionality in R. An intersect 
function would be useful in this case.

Here, I have another related question. My function used polylist objects 
(it was written several years ago when there was no sp). I would like to 
know what will be the future of polylist. The main use of this class was 
its relationship to nb object. Now, poly2nb also accepts SpatialPolygons 
so what about polylist ?

Thanks,


 Roger Bivand wrote:
> On Tue, 20 Mar 2007, St?phane Dray wrote:
>
>   
>> I have a code that do the job for polylist objects at 
>> http://biomserv.univ-lyon1.fr/~dray/files/softwares/spatialRLQ/spatialrlq.R
>>
>> The function uses gpclib and only returns area or binary matrices (1 
>> intersect, 0 not). It could be easily modify to return the intersection 
>> of two polygons (remove the loops over the polylists and return interAB)
>>
>>     
>
> Thanks, this will be useful, especially for users searching the archives! 
> This also relates to the question of how much vector GIS functionality 
> should be within R.
>
> Roger
>
>   
>> Roger Bivand wrote:
>>     
>>> On Tue, 20 Mar 2007, Sebastien wrote:
>>>
>>>   
>>>       
>>>> Dear helpers,
>>>>
>>>> I need to find the intersection of two polygons. I have two overlapping 
>>>> polygons and I want to find the polygon corresponding to the common 
>>>> part. Is there a fonction, like unionSpatialPolygons which can do that. 
>>>> I have converted my polygons to "owin" and use the function 
>>>> 'intersect.owin' in the pachage spatstat but it returns a binary matrice 
>>>> of class "owin" or I would prefer a polygon.
>>>>     
>>>>         
>>> No, there is not. I think that joinPolys() in the PBSmapping package can
>>> do this, and you can get to the PBS PolySet representation using
>>> SpatialPolygons2PolySet() in the maptools package, but then you'd need to
>>> get back again to SpatialPolygons, which would involve coding. The 
>>> alternative of using gpclib like unionSpatialPolygons() would also 
>>> involve coding.
>>>
>>> Roger
>>>
>>>   
>>>       
>>>> Thanks for your help,
>>>>
>>>> S?bastien Ollier
>>>>
>>>> ####    ####    ####
>>>> S?bastien Ollier
>>>> Ma?tre de Conf?rences
>>>> Universit? Paris-Sud 11
>>>> Facult? des Sciences d'Orsay
>>>> Unit? Ecologie, Syst?matique et Evolution
>>>> D?partement Biodiversit?, Syst?matique et Evolution
>>>> UMR - 8079 UPS-CNRS-ENGREF
>>>> B?t. 360, 91405 ORSAY CEDEX
>>>> FRANCE
>>>> Tel : 33 (0) 1 69 15 56 70
>>>> Fax : 33 (0) 1 69 15 46 97
>>>> http://www.ese.u-psud.fr/
>>>> ####    ####    ####
>>>>
>>>>     
>>>>         
>>>   
>>>       
>>
>>     
>
>   


-- 
St?phane DRAY (dray at biomserv.univ-lyon1.fr )
Laboratoire BBE-CNRS-UMR-5558, Univ. C. Bernard - Lyon I
43, Bd du 11 Novembre 1918, 69622 Villeurbanne Cedex, France
Tel: 33 4 72 43 27 57       Fax: 33 4 72 43 13 88
http://biomserv.univ-lyon1.fr/~dray/



From Roger.Bivand at nhh.no  Wed Mar 21 11:30:36 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 21 Mar 2007 11:30:36 +0100 (CET)
Subject: [R-sig-Geo] intersection of two polygons
In-Reply-To: <4601085C.4030402@biomserv.univ-lyon1.fr>
Message-ID: <Pine.LNX.4.44.0703211126080.21600-100000@reclus.nhh.no>

On Wed, 21 Mar 2007, St?phane Dray wrote:

> I just checked the code and see that my function was not optimal (too 
> much loops). I think that it can be easily improve and I can try to 
> write a intersectSpatialPolygons.  There is a unionSpatialPolygons in 
> maptools, I think that an intersect function could be also useful. For 
> instance, one thing  that I would like to do in R (but I never succeed): 
> I have a set of points from which I construct a Voronoi mosaic, I have 
> also a polygon of my whole study area, I would like to cut the mosaic 
> using the polygon. I now that there is an Arcview extension to do it but 
> it would be nice to have also this functionality in R. An intersect 
> function would be useful in this case.

It would certainly be welcome, thanks!

> 
> Here, I have another related question. My function used polylist objects 
> (it was written several years ago when there was no sp). I would like to 
> know what will be the future of polylist. The main use of this class was 
> its relationship to nb object. Now, poly2nb also accepts SpatialPolygons 
> so what about polylist ?

There are users and code around using the Map, polylist, and other legacy 
S3 classes, so it seems best to leave the code there. You are right that 
it may be sensible to add "deprecated" warnings to many of these, because 
the S4 sp classes are the ones being developed actively. This is a bit 
like Doug Bates' description of progress with lme structures, the new ones 
are to be prefered, but it would not be right simply to remove the old 
ones.

Roger

> 
> Thanks,
> 
> 
>  Roger Bivand wrote:
> > On Tue, 20 Mar 2007, St?phane Dray wrote:
> >
> >   
> >> I have a code that do the job for polylist objects at 
> >> http://biomserv.univ-lyon1.fr/~dray/files/softwares/spatialRLQ/spatialrlq.R
> >>
> >> The function uses gpclib and only returns area or binary matrices (1 
> >> intersect, 0 not). It could be easily modify to return the intersection 
> >> of two polygons (remove the loops over the polylists and return interAB)
> >>
> >>     
> >
> > Thanks, this will be useful, especially for users searching the archives! 
> > This also relates to the question of how much vector GIS functionality 
> > should be within R.
> >
> > Roger
> >
> >   
> >> Roger Bivand wrote:
> >>     
> >>> On Tue, 20 Mar 2007, Sebastien wrote:
> >>>
> >>>   
> >>>       
> >>>> Dear helpers,
> >>>>
> >>>> I need to find the intersection of two polygons. I have two overlapping 
> >>>> polygons and I want to find the polygon corresponding to the common 
> >>>> part. Is there a fonction, like unionSpatialPolygons which can do that. 
> >>>> I have converted my polygons to "owin" and use the function 
> >>>> 'intersect.owin' in the pachage spatstat but it returns a binary matrice 
> >>>> of class "owin" or I would prefer a polygon.
> >>>>     
> >>>>         
> >>> No, there is not. I think that joinPolys() in the PBSmapping package can
> >>> do this, and you can get to the PBS PolySet representation using
> >>> SpatialPolygons2PolySet() in the maptools package, but then you'd need to
> >>> get back again to SpatialPolygons, which would involve coding. The 
> >>> alternative of using gpclib like unionSpatialPolygons() would also 
> >>> involve coding.
> >>>
> >>> Roger
> >>>
> >>>   
> >>>       
> >>>> Thanks for your help,
> >>>>
> >>>> S?bastien Ollier
> >>>>
> >>>> ####    ####    ####
> >>>> S?bastien Ollier
> >>>> Ma?tre de Conf?rences
> >>>> Universit? Paris-Sud 11
> >>>> Facult? des Sciences d'Orsay
> >>>> Unit? Ecologie, Syst?matique et Evolution
> >>>> D?partement Biodiversit?, Syst?matique et Evolution
> >>>> UMR - 8079 UPS-CNRS-ENGREF
> >>>> B?t. 360, 91405 ORSAY CEDEX
> >>>> FRANCE
> >>>> Tel : 33 (0) 1 69 15 56 70
> >>>> Fax : 33 (0) 1 69 15 46 97
> >>>> http://www.ese.u-psud.fr/
> >>>> ####    ####    ####
> >>>>
> >>>>     
> >>>>         
> >>>   
> >>>       
> >>
> >>     
> >
> >   
> 
> 
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From epistat at gmail.com  Wed Mar 21 15:45:51 2007
From: epistat at gmail.com (zhijie zhang)
Date: Wed, 21 Mar 2007 22:45:51 +0800
Subject: [R-sig-Geo] help on Polygon(sp)?
Message-ID: <2fc17e30703210745w3d90636bu675a0f3631d575be@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20070321/0e6f0256/attachment.pl>

From v.gomezrubio at imperial.ac.uk  Wed Mar 21 16:04:49 2007
From: v.gomezrubio at imperial.ac.uk (Virgilio =?ISO-8859-1?Q?G=F3mez-Rubio?=)
Date: Wed, 21 Mar 2007 15:04:49 +0000
Subject: [R-sig-Geo] help on Polygon(sp)?
In-Reply-To: <2fc17e30703210745w3d90636bu675a0f3631d575be@mail.gmail.com>
References: <2fc17e30703210745w3d90636bu675a0f3631d575be@mail.gmail.com>
Message-ID: <1174489489.9734.41.camel@fh-vrubio.sm.med.ic.ac.uk>

Hi,

El mi?, 21-03-2007 a las 22:45 +0800, zhijie zhang escribi?:
> Dear friends,
>   I have a .shp file of region boundary, and i want to use it as the polygon
> in the khat(splancs) function, but it goes wrong.
> # khat(pts,poly,s,newstyle=FALSE)
> 
> guichi<-readShapePoly("d:/d/guichi2.shp")  # read the shp data  of region
> boundary
> guichi2<-Polygon(coordinates(guichi), hole=as.logical(NA))  #generate the

I think that you could try as.points(coordinates(guichi)) here to get
the boundary in the appropriate format. As far as I know, khat does not
use sp objects. 

Best regards,

Virgilio



From epistat at gmail.com  Wed Mar 21 16:35:49 2007
From: epistat at gmail.com (zhijie zhang)
Date: Wed, 21 Mar 2007 23:35:49 +0800
Subject: [R-sig-Geo] help on Polygon(sp)?
In-Reply-To: <1174489489.9734.41.camel@fh-vrubio.sm.med.ic.ac.uk>
References: <2fc17e30703210745w3d90636bu675a0f3631d575be@mail.gmail.com>
	<1174489489.9734.41.camel@fh-vrubio.sm.med.ic.ac.uk>
Message-ID: <2fc17e30703210835m6e375810s39dc09d1ed683d8@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20070321/7ab9213d/attachment.pl>

From v.gomezrubio at imperial.ac.uk  Wed Mar 21 16:58:31 2007
From: v.gomezrubio at imperial.ac.uk (Virgilio =?ISO-8859-1?Q?G=F3mez-Rubio?=)
Date: Wed, 21 Mar 2007 15:58:31 +0000
Subject: [R-sig-Geo] help on Polygon(sp)?
In-Reply-To: <2fc17e30703210835m6e375810s39dc09d1ed683d8@mail.gmail.com>
References: <2fc17e30703210745w3d90636bu675a0f3631d575be@mail.gmail.com>
	<1174489489.9734.41.camel@fh-vrubio.sm.med.ic.ac.uk>
	<2fc17e30703210835m6e375810s39dc09d1ed683d8@mail.gmail.com>
Message-ID: <1174492711.9734.50.camel@fh-vrubio.sm.med.ic.ac.uk>

Hi,

> #errors occurs????????
> env.lab <- Kenv.label(case_pts,control_pts,splancs_poly, nsim=999, seq
> (0,23000,500))
> error:v error in erifyclass(X, "ppp") : argument 'X' is not of class
> 'ppp'
>  
> Q1: Now that khat(splancs) goes fine, why not  Kenv.label(splancs)?
> From the help, it didn't say that it needs the point data set to be
> the class of ppp(spatstat).

The problem is not in Kenv.label() but in rlabel(), which is called from
Kenv.label and that has versions in Splancs and Spatstat. So, if you
loaded Spatstat after Splancs, then you will be using the 'wrong' (non-
Splancs) version. My advice is to load Splancs only and do the analysis.

I think you could use Spatstat as well to get the envelopes of the K-
function (using envelope() ) but it might require a few more lines of
code.

Best,

Virgilio

P.S: Is it wise to use variable names with underscore in it?



From Roger.Bivand at nhh.no  Wed Mar 21 18:47:20 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 21 Mar 2007 18:47:20 +0100 (CET)
Subject: [R-sig-Geo] help on Polygon(sp)?
In-Reply-To: <1174492711.9734.50.camel@fh-vrubio.sm.med.ic.ac.uk>
Message-ID: <Pine.LNX.4.44.0703211839380.21600-100000@reclus.nhh.no>

On Wed, 21 Mar 2007, Virgilio G?mez-Rubio wrote:

> Hi,
> 
> > #errors occurs????????
> > env.lab <- Kenv.label(case_pts,control_pts,splancs_poly, nsim=999, seq
> > (0,23000,500))
> > error:v error in erifyclass(X, "ppp") : argument 'X' is not of class
> > 'ppp'
> >  
> > Q1: Now that khat(splancs) goes fine, why not  Kenv.label(splancs)?
> > From the help, it didn't say that it needs the point data set to be
> > the class of ppp(spatstat).
> 
> The problem is not in Kenv.label() but in rlabel(), which is called from
> Kenv.label and that has versions in Splancs and Spatstat. So, if you
> loaded Spatstat after Splancs, then you will be using the 'wrong' (non-
> Splancs) version. My advice is to load Splancs only and do the analysis.
> 

These things do happen, I think that neither splancs nor spatstat have 
namespaces, which restrict the visibility of functions, so here you need 
to be careful. The warning:

        The following object(s) are masked from package:splancs :

         rlabel 

should have been displayed.

> I think you could use Spatstat as well to get the envelopes of the K-
> function (using envelope() ) but it might require a few more lines of
> code.

And if you use spatstat, you can convert the SpatialPolygons to owin with 
functions in maptools:

as(guichi, "owin")

ought to do it.

Roger

> 
> Best,
> 
> Virgilio
> 
> P.S: Is it wise to use variable names with underscore in it?
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From mdsumner at utas.edu.au  Wed Mar 21 23:53:22 2007
From: mdsumner at utas.edu.au (Michael Sumner)
Date: Thu, 22 Mar 2007 09:53:22 +1100
Subject: [R-sig-Geo] using alpha transparency for lines in spplot
In-Reply-To: <Pine.LNX.4.44.0703211839380.21600-100000@reclus.nhh.no>
References: <Pine.LNX.4.44.0703211839380.21600-100000@reclus.nhh.no>
Message-ID: <4601B762.6050604@utas.edu.au>

Hello, I'm having trouble with using the alpha channel for transparency 
with lines with spplot and
sp.lines.

If I use transparency via the alpha argument to rgb to overplot lines on 
spplot.grid the transparent colour affects all of the colours in the 
plot.  Example follows.

I've put the pdfs as created below here for reference:

http://staff.acecrc.org.au/~mdsumner/Rutas/misc/

BTW, I know my usage of the panel plots is not right, but I'm learning, 
so any advice would be appreciated.

Cheers, Mike.

I'm using Windows XP, SP2 with

R version 2.4.1 (2006-12-18)
i386-pc-mingw32

locale:
LC_COLLATE=English_Australia.1252;LC_CTYPE=English_Australia.1252;LC_MONETARY=English_Australia.1252;LC_NUMERIC=C;LC_TIME=English_Australia.1252

attached base packages:
[1] "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods" 
[7] "base"    

other attached packages:
     sp
"0.9-9"


Example:
library(sp)

data(meuse.grid)
coordinates(meuse.grid) <- ~x+y
gridded(meuse.grid) <- TRUE

## create some lines

bb <- bbox(meuse.grid)
xy <- cbind(runif(10, bb[1,1], bb[1,2]), runif(10, bb[2,1], bb[2,2]))
ll <- SpatialLines(list(Lines(list(Line(xy)), "1")))


## this is fine, colour grid with black lines
pdf("test.pdf", version = "1.4")
pg <- function(...) {
    panel.gridplot(...)
    sp.lines(ll)
}
spplot(meuse.grid[1], panel = pg)
dev.off()

## in this the colour grid is "greyed" like the lines
pdf("testAlpha.pdf", version = "1.4")
pg <- function(...) {
    panel.gridplot(...)
    sp.lines(ll , col = rgb(190, 190, 190, 100, max = 255))
}
spplot(meuse.grid[1], panel = pg)
dev.off()

## try with blue lines - colour grid is "blued" . . .
pdf("testBlueAlpha.pdf", version = "1.4")
pg <- function(...) {
    panel.gridplot(...)
    sp.lines(ll , col = rgb(0, 0, 190, 100, max = 255))
}
spplot(meuse.grid[1], panel = pg)
dev.off()



From Elizabeth.Boakes at ioz.ac.uk  Thu Mar 22 18:55:55 2007
From: Elizabeth.Boakes at ioz.ac.uk (Elizabeth Boakes)
Date: Thu, 22 Mar 2007 17:55:55 -0000
Subject: [R-sig-Geo] creating a neighbour list
Message-ID: <41E1ED29E5E8E34BBDD8B82CFA1A9D0402A1B8A8@ZSL26.zsl.org>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20070322/6b4b15f4/attachment.pl>

From Roger.Bivand at nhh.no  Thu Mar 22 19:41:08 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 22 Mar 2007 19:41:08 +0100 (CET)
Subject: [R-sig-Geo] creating a neighbour list
In-Reply-To: <41E1ED29E5E8E34BBDD8B82CFA1A9D0402A1B8A8@ZSL26.zsl.org>
Message-ID: <Pine.LNX.4.44.0703221923520.22308-100000@reclus.nhh.no>

On Thu, 22 Mar 2007, Elizabeth Boakes wrote:

>  
> 
> I think there is an easy answer to my questions, I'm just not very
> familiar with R.  Ultimately I want to perform a Moran's I test on a
> grid of binary data.  I'm having problems simply making a neighbour list
> though.  I've used cell2nb to make a neighbour list.  
> 
> I have two questions.
> 
>  
> 
> Firstly, if I use type="queen", I am assuming that each cell has 8
> neighbouring cells?  Is this correct and is there anyway of setting it
> to include the next layer or two layers of neighbouring cells, so that
> each cell would have 24 neighbouring cells, or 48 neighbouring cells?
> 
>  
> 
> Secondly, once I have my neighbour list, I realise I have to convert it
> to a listw object in order to use it in moran.test.  Do I do this using
> nb2listw()?  I don't want to weight anything though so would it be
> possible for someone to tell me exactly what to type?!
> 

The reasons for the many choices you have to make is that there simply are 
many choices, and the researcher, not the software, has to take them.

So, yes, cell2nb() will give you the neighbour list for the four nearest 
neighbour for type="rook", eight nearest for type="queen". For a grid with 
a cell size of 1, you get the same neighbour list with dnearneigh(), with 
d1=0 and d2=1.01, as type="rook". So to get further out than cell2nb(), 
use dnearneigh() with the appropriate d2= for your grid.

Please read the help page of nb2listw() carefully, you need to understand 
the style= argument, and possibly also the glist= argument, where 
different researchers have different needs.

But finally, you say that you have binary data, probably 0/1, for which
Moran's I is inappropriate. Please consider using a join count test, which
suits this kind of data. joincount.test() or joincount.multi() ought to be
OK, and reading the underlying Hopkins paper for the example background
and the section of Upton and Fingleton will help; there is a short
discussion in Fortin and Dale pp.  118-120. The results of join count
statistics typically vary for styles "B" and "W", so you may want to take
that into account ("B" privileges cells within the grid, "W" cells on the
edge).

>  
> 
> Sorry for asking such basic questions but I've been struggling with this
> all day....
> 
>  

Hope this helps,

Roger

> 
> Thanks very much,
> 
>  
> 
> Elizabeth Boakes
> 
> Dr Elizabeth Boakes
> Postdoctoral Research Assistant
> Institute of Zoology
> Regent's Park
> London NW1 4RY
> tel: 020 7449 6621
> 
> http://www.zoo.cam.ac.uk/ioz 
> ZOOLOGICAL SOCIETY OF LONDON
> LIVING CONSERVATION
> Registered Charity no. 208728
> 
>  
> 
>  
> 
> 
> 
> The Zoological Society of London is incorporated by Royal Charter
> Principal Office England. Company Number RC000749
> Registered address: 
> Regent?s Park, London, England NW1 4RY
> Registered Charity in England and Wales no. 208728
> 
> _________________________________________________________________________
> This e-mail has been sent in confidence to the named address...{{dropped}}
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From kbennett at uvic.ca  Fri Mar 23 20:51:39 2007
From: kbennett at uvic.ca (Katrina Bennett)
Date: Fri, 23 Mar 2007 12:51:39 -0700
Subject: [R-sig-Geo] Query for overlapping points in R
Message-ID: <000901c76d84$b067c5d0$ca0f688e@pcic.uvic.ca>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20070323/c6b3da17/attachment.pl>

From Roger.Bivand at nhh.no  Sat Mar 24 18:14:41 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sat, 24 Mar 2007 18:14:41 +0100 (CET)
Subject: [R-sig-Geo] New release of spdep package depends on Matrix
Message-ID: <Pine.LNX.4.44.0703241756530.26366-100000@reclus.nhh.no>

Release 0.4-1 of the spdep package is now on CRAN, and Windows amd MacOS X 
binaries will follow shortly. Please note that spdep now depends on the 
Matrix package, with SparseM as a suggested package. 

This is because the Matrix package is becoming more central in R
generally, and SparseM is moving closer to Matrix too. Matrix classes and
methods are used for handling sparse matrices. The change means that
simply updating spdep will not be enough if users have not installed
Matrix - if Matrix is not among your installed packages, and you are
updating spdep, please install Matrix first. The SparseM code has been
retained, but users should load SparseM themselves.

If:

length(grep("Matrix", rownames(installed.packages()))) == 0

you need to:

install.packages("Matrix")

In addition, the majority of the included data sets are now also provided 
as shapefiles and GAL contiguity files, so that it is easier to see how to 
reproduce analyses with one's own data.

Please let me know on or off this list if there are updating problems.

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From Roger.Bivand at nhh.no  Sat Mar 24 18:27:58 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sat, 24 Mar 2007 18:27:58 +0100 (CET)
Subject: [R-sig-Geo] Query for overlapping points in R
In-Reply-To: <000901c76d84$b067c5d0$ca0f688e@pcic.uvic.ca>
Message-ID: <Pine.LNX.4.44.0703241819510.26366-100000@reclus.nhh.no>

On Fri, 23 Mar 2007, Katrina Bennett wrote:

> Hello, I am trying to query in a spatial data set where overlapping points
> exist between two data sets, and then average between these two data sets in
> R.
> 
> The problem is that my data sets have slightly difference spatial arrays
> - therefore when I go to subtract them, I get an error.
> 
> The data sets are set up as follows, columns of - Lat, Long, 10, 11, 12, 1,
> 2, 3, 4, 5, 6, 7, 8, 9 (which represent months in the year)
> 
> Here is the portion of my script that does this. I've played around with
> overlay and merge, but neither seems to do what I want to do - just extract
> and then calculate on the common data points between these two files.

Well, why not simply measure the distances between the points in the two
files, treating points within a small threshold as common? Use a small
threshold rather than equality to avoid numerical fuzz problems.
spDistsN1() in sp will do that iterated over points in one of the sets.
Using the two indices, you can build up your output. Please consider using
sp classes - messing around inside the deprecated Map class is not
necessarily robust.

By the way, what is the function clip() in your code below?

Roger

> 
> require(sp)
> 
> for (region in regions){
>           #Create an empty holder
>           monthly_variables = NULL
>           #Clip regions (have to examine maptools package)
> 
>           clip_variance <- clip(cbind(variances, io =
>             point.in.polygon(variances$Long, variances$Lat,
>             shape$shp$shp[[region]]$points$X, 
>             shape$shp$shp[[region]]$points$Y)))
> 
>           clip_normal <- clip(cbind(normals, io =
>             point.in.polygon(normals$Long, normals$Lat,
>             shape$shp$shp[[region]]$points$X, 
>             shape$shp$shp[[region]]$points$Y)))
> 
>           #HERE IS WHERE I WANT TO SELECT AND CALCULATE DIFFERENCES ONLY ON
> THE POINTS THAT MATCH in X, Y SPACE
>           # calculate differences, sd (in the time domain) for the 
> 
>             for (month in 1:12){
>              # generate anomalies
>               monthly_anom <- clip_variance[, 3:ncol(clip_variance)] -
>                 clip_normal[, 3:ncol(clip_normal)]
> 
>               monthly_variables <- rbind(monthly_variables, c(Lat = Lat,
>                 Long = Long, monthly_anom = monthly_anom))
>             }

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From patrick.giraudoux at univ-fcomte.fr  Sat Mar 24 20:07:33 2007
From: patrick.giraudoux at univ-fcomte.fr (Patrick Giraudoux)
Date: Sat, 24 Mar 2007 20:07:33 +0100
Subject: [R-sig-Geo] spTransform, gridded
Message-ID: <460576F5.7070002@univ-fcomte.fr>

Dear Listers,

I am trying to convert a Gtiff object  from a coordinate system to 
another... I have tried the following:

# read the Gtiff file (European Lambert azimuthal equal area)
fcE<-readGDAL("fclambert.tif")
proj4string(fcE) # CRS OK

# read a shapefile to get the projection system (Lambert II etendu - a 
French projection Lambert
# conformal conic based on NTF)
fccoms<-readOGR("U:/Documents and Settings/giraudoux/Mes documents/Map 
tools/Shapefiles checked prj","FC_communes")
proj4string(fccoms) # CRS OK

# transform
fcLIIe<-spTransform(fcE, CRS(proj4string(fccoms))) # looks OK

# try writing
writeGDAL(fcLIIe,"fcLIIe.tif")
Error: gridded(dataset) is not TRUE

# try to promote to a grid...
gridded(fcLIIe)<-TRUE
suggested tolerance minimum: 0.5Error in points2grid(points, tolerance) 
: dimension 1 : coordinate intervals are not constant

I  suspect that  pixel centers may have been distorted with the 
transformation but may naively I wonder if there is a way to turn this 
problem eg increasing the tolerance...

Any hint appreciated...

Patrick



From e.pebesma at geo.uu.nl  Sat Mar 24 20:25:04 2007
From: e.pebesma at geo.uu.nl (Edzer J. Pebesma)
Date: Sat, 24 Mar 2007 20:25:04 +0100
Subject: [R-sig-Geo] spTransform, gridded
In-Reply-To: <460576F5.7070002@univ-fcomte.fr>
References: <460576F5.7070002@univ-fcomte.fr>
Message-ID: <46057B10.4070804@geo.uu.nl>

Patrick,

the problem is that if you reproject points on a grid, the result is not 
on a grid anymore, so I think it is correct that spTransform does return 
a SpatialPointsDataFrame rather than a SpatialGridDataFrame. You would 
have to shift points to centers on the new grid. The creator functions 
SpatialPixels() or SpatialPixelsDataFrame have a tolerance, which may be 
used to define to which extent you allow points to be off the points on 
a true grid. I would use that instead of gridded(x)=TRUE.

Note that you do move points, then.
--
Edzer

Patrick Giraudoux wrote:

>Dear Listers,
>
>I am trying to convert a Gtiff object  from a coordinate system to 
>another... I have tried the following:
>
># read the Gtiff file (European Lambert azimuthal equal area)
>fcE<-readGDAL("fclambert.tif")
>proj4string(fcE) # CRS OK
>
># read a shapefile to get the projection system (Lambert II etendu - a 
>French projection Lambert
># conformal conic based on NTF)
>fccoms<-readOGR("U:/Documents and Settings/giraudoux/Mes documents/Map 
>tools/Shapefiles checked prj","FC_communes")
>proj4string(fccoms) # CRS OK
>
># transform
>fcLIIe<-spTransform(fcE, CRS(proj4string(fccoms))) # looks OK
>
># try writing
>writeGDAL(fcLIIe,"fcLIIe.tif")
>Error: gridded(dataset) is not TRUE
>
># try to promote to a grid...
>gridded(fcLIIe)<-TRUE
>suggested tolerance minimum: 0.5Error in points2grid(points, tolerance) 
>: dimension 1 : coordinate intervals are not constant
>
>I  suspect that  pixel centers may have been distorted with the 
>transformation but may naively I wonder if there is a way to turn this 
>problem eg increasing the tolerance...
>
>Any hint appreciated...
>
>Patrick
>
>_______________________________________________
>R-sig-Geo mailing list
>R-sig-Geo at stat.math.ethz.ch
>https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>  
>



From Roger.Bivand at nhh.no  Sat Mar 24 20:27:04 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sat, 24 Mar 2007 20:27:04 +0100 (CET)
Subject: [R-sig-Geo] spTransform, gridded
In-Reply-To: <460576F5.7070002@univ-fcomte.fr>
Message-ID: <Pine.LNX.4.44.0703242022260.26366-100000@reclus.nhh.no>

On Sat, 24 Mar 2007, Patrick Giraudoux wrote:

> Dear Listers,
> 
> I am trying to convert a Gtiff object  from a coordinate system to 
> another... I have tried the following:

This is warping, so in general the output will not be a regular grid. If 
you need a grid, try interpolating to an empty grid in the target 
projection (IDW in gstat ought to be OK if the resolutions are similar, 
with a small number of neighbours). My guess is that fcLIIe is a 
SpatialPoints* object, not on a regular grid.

You could use gdalwarp externally to do this, if you prefer.

Roger

> 
> # read the Gtiff file (European Lambert azimuthal equal area)
> fcE<-readGDAL("fclambert.tif")
> proj4string(fcE) # CRS OK
> 
> # read a shapefile to get the projection system (Lambert II etendu - a 
> French projection Lambert
> # conformal conic based on NTF)
> fccoms<-readOGR("U:/Documents and Settings/giraudoux/Mes documents/Map 
> tools/Shapefiles checked prj","FC_communes")
> proj4string(fccoms) # CRS OK
> 
> # transform
> fcLIIe<-spTransform(fcE, CRS(proj4string(fccoms))) # looks OK
> 
> # try writing
> writeGDAL(fcLIIe,"fcLIIe.tif")
> Error: gridded(dataset) is not TRUE
> 
> # try to promote to a grid...
> gridded(fcLIIe)<-TRUE
> suggested tolerance minimum: 0.5Error in points2grid(points, tolerance) 
> : dimension 1 : coordinate intervals are not constant
> 
> I  suspect that  pixel centers may have been distorted with the 
> transformation but may naively I wonder if there is a way to turn this 
> problem eg increasing the tolerance...
> 
> Any hint appreciated...
> 
> Patrick
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From nikko at hailmail.net  Sat Mar 24 21:01:11 2007
From: nikko at hailmail.net (Nicholas Lewin-Koh)
Date: Sat, 24 Mar 2007 16:01:11 -0400
Subject: [R-sig-Geo] R-sig-Geo Digest, Vol 43, Issue 21
In-Reply-To: <mailman.19.1174734006.3519.r-sig-geo@stat.math.ethz.ch>
References: <mailman.19.1174734006.3519.r-sig-geo@stat.math.ethz.ch>
Message-ID: <1174766471.10772.1181191713@webmail.messagingengine.com>

Hi Katrina,
If your data are really only points all you need to do if you have dat1
and dat2
as two datasets like you described is,
i1<-which(dat1$lat%in%dat2$lat & dat1$long%in%dat2$long)
i2<-which(dat2$lat%in%dat1$lat & dat2$long%in%dat1$long)
o1<-order(dat1$lat[i1],dat1$long[i1]
o2<-order(dat2$lat[i2],dat2$long[i2]
(dat1[i1,-c("lat","long")])[o1,]-(dat1[i2,-c("lat","long")])[o2,]

Mind you this is not elegant, and there is probably a faster ways,
but it will get you what you need.

Cheers
Nicholas

> Message: 1
> Date: Fri, 23 Mar 2007 12:51:39 -0700
> From: "Katrina Bennett" <kbennett at uvic.ca>
> Subject: [R-sig-Geo] Query for overlapping points in R
> To: <r-sig-geo at stat.math.ethz.ch>
> Message-ID: <000901c76d84$b067c5d0$ca0f688e at pcic.uvic.ca>
> Content-Type: text/plain
> 
> Hello, I am trying to query in a spatial data set where overlapping
> points
> exist between two data sets, and then average between these two data sets
> in
> R.
> 
>  
> 
> The problem is that my data sets have slightly difference spatial arrays
> -
> therefore when I go to subtract them, I get an error.
> 
>  
> 
> The data sets are set up as follows, columns of - Lat, Long, 10, 11, 12,
> 1,
> 2, 3, 4, 5, 6, 7, 8, 9 (which represent months in the year)
> 
>  
> 
> Here is the portion of my script that does this. I've played around with
> overlay and merge, but neither seems to do what I want to do - just
> extract
> and then calculate on the common data points between these two files.
> 
>  
> 
>  
> 
>  
> 
> require(sp)
> 
> for (region in regions){
> 
>           #Create an empty holder
> 
>           monthly_variables = NULL
> 
>           
> 
>           #Clip regions (have to examine maptools package)
> 
>           clip_variance <- clip(cbind(variances, io =
> point.in.polygon(variances$Long, variances$Lat,
> shape$shp$shp[[region]]$points$X, shape$shp$shp[[region]]$points$Y)))
> 
>           clip_normal <- clip(cbind(normals, io =
> point.in.polygon(normals$Long, normals$Lat,
> shape$shp$shp[[region]]$points$X, shape$shp$shp[[region]]$points$Y)))
> 
>           #HERE IS WHERE I WANT TO SELECT AND CALCULATE DIFFERENCES ONLY
>           ON
> THE POINTS THAT MATCH in X, Y SPACE
> 
>       
> 
>           # calculate differences, sd (in the time domain) for the 
> 
>             for (month in 1:12){
> 
>              # generate anomalies
> 
>               
> 
>               monthly_anom <- clip_variance[, 3:ncol(clip_variance)] -
> clip_normal[, 3:ncol(clip_normal)]
> 
>               
> 
>               monthly_variables <- rbind(monthly_variables, c(Lat = Lat,
> Long = Long, monthly_anom = monthly_anom))
> 
>         
> 
>             }
> 
> 
> 	[[alternative HTML version deleted]]
> 
> 
> 
> ------------------------------
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 
> 
> End of R-sig-Geo Digest, Vol 43, Issue 21
> *****************************************



From Karl.Sommer at dpi.vic.gov.au  Mon Mar 26 02:08:21 2007
From: Karl.Sommer at dpi.vic.gov.au (Karl.Sommer at dpi.vic.gov.au)
Date: Mon, 26 Mar 2007 10:08:21 +1000
Subject: [R-sig-Geo] function contourLines2SLDF
Message-ID: <OF3718C4CB.6AA691F4-ONCA2572A9.00836550-CA2572AA.0000C369@nre.vic.gov.au>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20070326/665bd3b9/attachment.pl>

From mdsumner at utas.edu.au  Mon Mar 26 02:43:09 2007
From: mdsumner at utas.edu.au (Michael Sumner)
Date: Mon, 26 Mar 2007 10:43:09 +1000
Subject: [R-sig-Geo] function contourLines2SLDF
In-Reply-To: <OF3718C4CB.6AA691F4-ONCA2572A9.00836550-CA2572AA.0000C369@nre.vic.gov.au>
References: <OF3718C4CB.6AA691F4-ONCA2572A9.00836550-CA2572AA.0000C369@nre.vic.gov.au>
Message-ID: <4607171D.1060305@utas.edu.au>

Karl.Sommer at dpi.vic.gov.au wrote:
> Hello list,
>
> I used to be able to apply the function contourLines2SLDF for the 
> following operation on a SpatialGridDataFrame object. 
>
>   
>> CL <- contourLines2SLDF(contourLines(as.image.SpatialGridDataFrame
>>     
> +       (as(ht.idw["var1.pred"],"SpatialGridDataFrame"))))
>
>   
Gee I'd never noticed that function. I just checked and it's now in the 
"maptools" package.

BTW, here's an example I used just the other day, in case that's helpful 
to see what's going on. It depends on how your lines need to be 
organized whether this will match your case.

Cheers, Mike.

"d" is a SpatialGridDataFrame
"tab" is a SpatialPolygonsDataFrame (I'm looping over each polygon using 
"kk", this is one iteration)

## contour it
l <- contourLines(as.image.SpatialGridDataFrame(d), levels = seq(0, 
2000, by = 10))

## create empty list to hold lines
ll <- vector("list", length(l))
## loop over list of contours to create Lines object
for (i in 1:length(l)) ll[[i]] <- Lines(list(Line(cbind(l[[i]]$x, 
l[[i]]$y))), as.character(i))

## make those lines  Spatial, and fill out SpatialLinesDataFrame
ll <- SpatialLines(ll, CRS(proj4string(d)))
nm <- as.character(tab[kk,][["MAP_NAME"]])
num <-as.character(tab[kk,][["MAP_NO"]])
nn <- length(l)
ll <- SpatialLinesDataFrame(ll, data.frame(level = unlist(lapply(l, 
function(x) x$level)),
                                MAP_NAME = rep(nm, nn),
                                MAP_NO = rep(num, nn)))



From thierry_schmitt at yahoo.com  Mon Mar 26 03:12:59 2007
From: thierry_schmitt at yahoo.com (Schmitt Thierry)
Date: Sun, 25 Mar 2007 18:12:59 -0700 (PDT)
Subject: [R-sig-Geo] hist2d with spatial data frame (slightly off-topic)
Message-ID: <902890.26827.qm@web35609.mail.mud.yahoo.com>

Hello,

still putting some efforts to be a better R/GRASS user!!! Hence this question is from a newbie.

I have several spatial dataset : grass raster imported in R ie a morphological classification and other raster data.
I have been testing hist2d to plot these variables. I am happy of the result. However I would like to be able to plot a legend for the color used to display the frequencies of occurences. Could any one help me on this one.
Also can anybody give me the parameters to use to display my own numbering along the axis.

Thank you

 
 _____
|______\   Thierry SCHMITT
      ||          G?ologie Marine et C?ti?re
        ||          Marine and Coastal Geology
        ||          www.cidco.ca



From Karl.Sommer at dpi.vic.gov.au  Mon Mar 26 03:29:40 2007
From: Karl.Sommer at dpi.vic.gov.au (Karl.Sommer at dpi.vic.gov.au)
Date: Mon, 26 Mar 2007 11:29:40 +1000
Subject: [R-sig-Geo] function contourLines2SLDF
In-Reply-To: <4607171D.1060305@utas.edu.au>
Message-ID: <OF51AB438F.90CE293E-ONCA2572AA.00076996-CA2572AA.00083572@nre.vic.gov.au>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20070326/6067bb87/attachment.pl>

From Roger.Bivand at nhh.no  Mon Mar 26 08:51:44 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 26 Mar 2007 08:51:44 +0200 (CEST)
Subject: [R-sig-Geo] reading a gps from R
In-Reply-To: <45D87659.7080509@univ-fcomte.fr>
Message-ID: <Pine.LNX.4.44.0703260839580.24212-100000@reclus.nhh.no>

Patrick:

A simplified version of your readGPS() interfacing gpsbabel is included in
maptools 0.6-9. It turned out that even using the NMEA interface to
different Garmin receivers seems to give different data in different
columns. In addition, my trials have shown that some data frame rows may
be corrupted, so at least the first time a given receiver is interfaced,
the data read will need to be looked at carefully. From there on, one can
write a wrapper with the general readGPS() function inside to check for
erroneous rows and select required columns, as sketched in the example for
my Garmin etrex Legend Cx. Under non-Windows OS, reading from USB or
serial may need special permissions too - see the gpsbabel website, and
Vista may also require special treatment (untried).

Thanks for a useful contribution!

Roger

On Sun, 18 Feb 2007, Patrick Giraudoux wrote:

> On the thread and in case it may help somebody, find below this function 
> that can read Garmin Etrex Summit from R (whatever the plateform - 
> tested on Windows XP and Ubuntu 6.10 Edgy eft) if gpsbabel is installed.
> 
> Packaged in pgirbric at http://perso.orange.fr/giraudoux/SiteGiraudoux.html.
> 
> readGPS<-function(type="w",wcom=4){
> 
>     if (!(type=="w" | type=="t")) stop("type must be 'w' (waypoints) or 
> 't' (tracks)")
> 
>     if (Sys.info()["sysname"]!="Windows") {# OK sous linux Ubuntu 6.10
>         gpsdata<-system(paste("gpsbabel -",type," -i garmin -f 
> /dev/ttyUSB0 -o tabsep -F -",sep=""), intern=TRUE)
>         if (any(grep("Can't init",gpsdata))) stop("Cannot read GPS: 
> check connexion")
>         }
>     else {# OK sous Windows
>         if (any(grep(wcom,0:9))){
>             gpsdata <- system(paste("gpsbabel -",type," -i garmin -f 
> com",wcom,": -o tabsep -F -",sep=""), intern=TRUE)
>             if (any(grep("Can't init",gpsdata))) stop("Cannot read GPS: 
> check connexion and com port number 'wcom'")
>             }
>         else stop("Windows com port number 'wcom' must be one of 0:9")
>     }
>     gpsdata<-read.table(textConnection(gpsdata), fill=TRUE)
>    
>    
>     if (type=="w"){
>         gpsdata<-gpsdata[,c(2,6,7,17)]
>         names(gpsdata)<-c("ident","long","lat","altitude")
>         
> gpsdata$altitude<-as.numeric(substr(as.character(gpsdata$altitude),1,nchar(as.character(gpsdata$altitude))-1))
>         attributes(gpsdata)$type<-"Waypoints"
>     }
>    
>     if (type=="t"){
>         gpsdata<-gpsdata[,c(3,4,14)]
>         names(gpsdata)<-c("long","lat","altitude")
>         ident<-1:length(gpsdata[,1])
>         gpsdata<-data.frame(ident=ident,gpsdata)
>         
> gpsdata$altitude<-as.numeric(substr(as.character(gpsdata$altitude),1,nchar(as.character(gpsdata$altitude))-1))
>         attributes(gpsdata)$type<-"Track"
>     }
>    
>     attributes(gpsdata)$sysTime<-Sys.time()
>     gpsdata
> }
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From patrick.giraudoux at univ-fcomte.fr  Mon Mar 26 09:06:56 2007
From: patrick.giraudoux at univ-fcomte.fr (Patrick Giraudoux)
Date: Mon, 26 Mar 2007 09:06:56 +0200
Subject: [R-sig-Geo] reading a gps from R
In-Reply-To: <Pine.LNX.4.44.0703260839580.24212-100000@reclus.nhh.no>
References: <Pine.LNX.4.44.0703260839580.24212-100000@reclus.nhh.no>
Message-ID: <46077110.9080108@univ-fcomte.fr>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20070326/414e98ba/attachment.pl>

From Roger.Bivand at nhh.no  Mon Mar 26 09:27:14 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 26 Mar 2007 09:27:14 +0200 (CEST)
Subject: [R-sig-Geo] function contourLines2SLDF
In-Reply-To: <OF51AB438F.90CE293E-ONCA2572AA.00076996-CA2572AA.00083572@nre.vic.gov.au>
Message-ID: <Pine.LNX.4.44.0703260922050.24212-100000@reclus.nhh.no>

On Mon, 26 Mar 2007 Karl.Sommer at dpi.vic.gov.au wrote:

> Thanks for the hint Michael
> 
> there must have been a change in spelling the function name.  The maptool 
> function is spelt  "ContourLines2SLDF" rather than "contourLines2SLDF"  as 
> it was spelt before.  Anyway I am happy it is still there and it works. 

Yes, that's right. The function was in sp, and got moved to maptools in a
tidying up round, because sp is supposed to contain class definitions and
methods, especially subsetting and visualisation methods. The maptools
package is supposed to contain (some of) the tools for getting data into
and out of sp class objects, as well as stand-alone functions for reading
and writing shapefiles and Arc ASCII grid files. I should have been more
careful to use the Deprecated/Defunct mechanisms here, I'll try harder in
future!

Roger

> 
> Cheers
> 
> Karl 
> 
> 
> 
> 
> Michael Sumner <mdsumner at utas.edu.au> 
> Sent by: r-sig-geo-bounces at stat.math.ethz.ch
> 26/03/2007 10:43
> 
> To
> Karl.Sommer at dpi.vic.gov.au, r-sig-geo at stat.math.ethz.ch
> cc
> 
> Subject
> Re: [R-sig-Geo] function contourLines2SLDF
> 
> 
> 
> 
> 
> 
> Karl.Sommer at dpi.vic.gov.au wrote:
> > Hello list,
> >
> > I used to be able to apply the function contourLines2SLDF for the 
> > following operation on a SpatialGridDataFrame object. 
> >
> > 
> >> CL <- contourLines2SLDF(contourLines(as.image.SpatialGridDataFrame
> >> 
> > +       (as(ht.idw["var1.pred"],"SpatialGridDataFrame"))))
> >
> > 
> Gee I'd never noticed that function. I just checked and it's now in the 
> "maptools" package.
> 
> BTW, here's an example I used just the other day, in case that's helpful 
> to see what's going on. It depends on how your lines need to be 
> organized whether this will match your case.
> 
> Cheers, Mike.
> 
> "d" is a SpatialGridDataFrame
> "tab" is a SpatialPolygonsDataFrame (I'm looping over each polygon using 
> "kk", this is one iteration)
> 
> ## contour it
> l <- contourLines(as.image.SpatialGridDataFrame(d), levels = seq(0, 
> 2000, by = 10))
> 
> ## create empty list to hold lines
> ll <- vector("list", length(l))
> ## loop over list of contours to create Lines object
> for (i in 1:length(l)) ll[[i]] <- Lines(list(Line(cbind(l[[i]]$x, 
> l[[i]]$y))), as.character(i))
> 
> ## make those lines  Spatial, and fill out SpatialLinesDataFrame
> ll <- SpatialLines(ll, CRS(proj4string(d)))
> nm <- as.character(tab[kk,][["MAP_NAME"]])
> num <-as.character(tab[kk,][["MAP_NO"]])
> nn <- length(l)
> ll <- SpatialLinesDataFrame(ll, data.frame(level = unlist(lapply(l, 
> function(x) x$level)),
>                                 MAP_NAME = rep(nm, nn),
>                                 MAP_NO = rep(num, nn)))
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From mdsumner at utas.edu.au  Mon Mar 26 10:14:07 2007
From: mdsumner at utas.edu.au (Michael Sumner)
Date: Mon, 26 Mar 2007 18:14:07 +1000
Subject: [R-sig-Geo] recommended workflow for non-Pacific grids
In-Reply-To: <Pine.LNX.4.44.0703260922050.24212-100000@reclus.nhh.no>
References: <Pine.LNX.4.44.0703260922050.24212-100000@reclus.nhh.no>
Message-ID: <460780CF.1020802@utas.edu.au>

Hello,
I have a fairly convoluted set of functions (using GridTopology, rgdal 
and some pretty ad-hoc conditionals . . .)
that allow me to easily read Pacific-centred regions from 
longlat-gridded datasets that
are Atlantic-centric. I basically revert to SpatialPixels and let it 
sort out the indexing after adding
360 to western-hemisphere coordinates.  I

I'd like to ask for suggestions as to the best way to approach this.

I've not found neat way to do it, and it seems the most efficient would 
be to read the two sections
as SGDF, then convert those with as.image.SpatialGridDataFrame, 
re-binding the western portion
to the eastern and resolving the grid topology and recreating the SGDF.

I've not actually tried this for multi- datasets, but it would involve a 
loop in the above
workflow for each band.

If there's nothing obvious that I'm missing I'll follow this post up 
with a real example and
go from there.

Cheers, Mike.



From andrew.niccolai at yale.edu  Mon Mar 26 21:02:34 2007
From: andrew.niccolai at yale.edu (Andrew Niccolai)
Date: Mon, 26 Mar 2007 15:02:34 -0400
Subject: [R-sig-Geo] PBSmapping to SpatialPolygonsDF
In-Reply-To: <Pine.LNX.4.44.0703260839580.24212-100000@reclus.nhh.no>
Message-ID: <200703261902.l2QJ2aPf009484@pantheon-po13.its.yale.edu>

Is there a pre-existing function or a clever way to pull a PBSmapping object
of class "Polyset", "data.frame" into a SpatialPolygonsDataFrame?

I found the SpatialPolygons2PolySet function and was hoping that there is a
way to go the other direction.

I have created a voronoi tessellation for a set of 627 points and then
clipped that by the convex hull of those points.  The object looks like
this:

> class(cb.tess)
[1] "PolySet"    "data.frame"
> names(cb.tess)
[1] "PID" "POS" "X"   "Y"  
> head(cb.tess)
  PID POS        X        Y
1   1   1 945062.2 860290.8
2   1   2 945073.5 860273.0
3   1   3 945062.7 860272.6
4   1   4 945062.5 860272.7
5   1   5 945055.9 860277.4
6   1   6 945057.8 860291.4
> tail(cb.tess)
  PID POS        X        Y
1 626   9 944972.3 859813.1
2 627   1 945009.7 859794.3
3 627   2 944993.8 859769.0
4 627   3 944985.3 859763.3
5 627   4 944990.9 859804.2
6 627   5 945008.2 859804.6

I would like to slip back into the world of SPDF if possible.

Thanks in advance for help, suggestions or code.

cheers

Andrew Niccolai
Doctoral Candidate
Yale School of Forestry
203-432-5144



From Roger.Bivand at nhh.no  Mon Mar 26 21:33:30 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 26 Mar 2007 21:33:30 +0200 (CEST)
Subject: [R-sig-Geo] PBSmapping to SpatialPolygonsDF
In-Reply-To: <200703261902.l2QJ2aPf009484@pantheon-po13.its.yale.edu>
Message-ID: <Pine.LNX.4.44.0703262126150.24212-100000@reclus.nhh.no>

On Mon, 26 Mar 2007, Andrew Niccolai wrote:

> Is there a pre-existing function or a clever way to pull a PBSmapping object
> of class "Polyset", "data.frame" into a SpatialPolygonsDataFrame?
> 
> I found the SpatialPolygons2PolySet function and was hoping that there is a
> way to go the other direction.
> 
> I have created a voronoi tessellation for a set of 627 points and then
> clipped that by the convex hull of those points.  The object looks like
> this:
> 
> > class(cb.tess)
> [1] "PolySet"    "data.frame"
> > names(cb.tess)
> [1] "PID" "POS" "X"   "Y"  
> > head(cb.tess)
>   PID POS        X        Y
> 1   1   1 945062.2 860290.8
> 2   1   2 945073.5 860273.0
> 3   1   3 945062.7 860272.6
> 4   1   4 945062.5 860272.7
> 5   1   5 945055.9 860277.4
> 6   1   6 945057.8 860291.4
> > tail(cb.tess)
>   PID POS        X        Y
> 1 626   9 944972.3 859813.1
> 2 627   1 945009.7 859794.3
> 3 627   2 944993.8 859769.0
> 4 627   3 944985.3 859763.3
> 5 627   4 944990.9 859804.2
> 6 627   5 945008.2 859804.6
> 
> I would like to slip back into the world of SPDF if possible.
> 
> Thanks in advance for help, suggestions or code.

Not yet a function, but if you could try this and polish it a bit, I think 
it's workable:

example(SpatialPolygons2PolySet)
# gives the input PolySet nor_coast_poly_PS
res0 <- split(nor_coast_poly_PS, nor_coast_poly_PS$PID)
res1 <- lapply(res0, function(x) split(x, x$SID))
outPolygons <- vector(mode="list", length=length(res0))
for (i in seq(along=outPolygons)) {
   outPolygons[[i]] <- Polygons(lapply(res1[[i]], function(x) 
   Polygon(cbind(x$X, x$Y))), ID=as.character(i))
}
outSP <- SpatialPolygons(outPolygons)
plot(outSP)

# get the projection/zone from attr(nor_coast_poly_PS, "projection") and
# attr(nor_coast_poly_PS, "zone") if UTM, use in constructing
# the SpatialPolygons object. Now the ID= in Polygons() is just the loop 
# index - should be the PID values if they are the key value for adding
# in a data frame.

Hope this helps,

Roger

> 
> cheers
> 
> Andrew Niccolai
> Doctoral Candidate
> Yale School of Forestry
> 203-432-5144
> 
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From andrew.niccolai at yale.edu  Mon Mar 26 22:21:56 2007
From: andrew.niccolai at yale.edu (Andrew Niccolai)
Date: Mon, 26 Mar 2007 16:21:56 -0400
Subject: [R-sig-Geo] PBSmapping to SpatialPolygonsDF
In-Reply-To: <Pine.LNX.4.44.0703262126150.24212-100000@reclus.nhh.no>
Message-ID: <200703262022.l2QKLwiC007763@pantheon-po13.its.yale.edu>

Roger!!! Thank you very much.  I needed to adjust your code only to account
for the fact that my tesselated object did not have a SID column and also I
needed to add a step to "repeat" the first set of XY cords for each polygon
to close the loop.  Other than that, it worked like a charm out of the gate.

Thank you.

Here are my changes to Roger's code in case others have data sets w/o closed
loops.

##--- convert from Polyset in PBSmapping to SPDF
## example(PolySet2SpatialPolygons ---written by R.Bivand)
res0 <- split(cb.tess, cb.tess$PID)
for(i in 1:length(res0)){
res0[[i]] <- rbind(res0[[i]],res0[[i]][1,])
}
outPolygons <- vector(mode="list", length=length(res0)) 
for (i in seq(along=outPolygons)) {
outPolygons[[i]] <- Polygons(lapply(res0[[i]], function(x)
Polygon(cbind(res0[[i]]$X, res0[[i]]$Y))), ID=as.character(i))
} 
outSP <- SpatialPolygons(outPolygons)
plot(outSP)

Andrew Niccolai
Doctoral Candidate
Yale School of Forestry
203-432-5144
 

-----Original Message-----
From: Roger Bivand [mailto:Roger.Bivand at nhh.no] 
Sent: Monday, March 26, 2007 3:34 PM
To: Andrew Niccolai
Cc: r-sig-geo at stat.math.ethz.ch
Subject: Re: PBSmapping to SpatialPolygonsDF

On Mon, 26 Mar 2007, Andrew Niccolai wrote:

> Is there a pre-existing function or a clever way to pull a PBSmapping
object
> of class "Polyset", "data.frame" into a SpatialPolygonsDataFrame?
> 
> I found the SpatialPolygons2PolySet function and was hoping that there is
a
> way to go the other direction.
> 
> I have created a voronoi tessellation for a set of 627 points and then
> clipped that by the convex hull of those points.  The object looks like
> this:
> 
> > class(cb.tess)
> [1] "PolySet"    "data.frame"
> > names(cb.tess)
> [1] "PID" "POS" "X"   "Y"  
> > head(cb.tess)
>   PID POS        X        Y
> 1   1   1 945062.2 860290.8
> 2   1   2 945073.5 860273.0
> 3   1   3 945062.7 860272.6
> 4   1   4 945062.5 860272.7
> 5   1   5 945055.9 860277.4
> 6   1   6 945057.8 860291.4
> > tail(cb.tess)
>   PID POS        X        Y
> 1 626   9 944972.3 859813.1
> 2 627   1 945009.7 859794.3
> 3 627   2 944993.8 859769.0
> 4 627   3 944985.3 859763.3
> 5 627   4 944990.9 859804.2
> 6 627   5 945008.2 859804.6
> 
> I would like to slip back into the world of SPDF if possible.
> 
> Thanks in advance for help, suggestions or code.

Not yet a function, but if you could try this and polish it a bit, I think 
it's workable:

example(SpatialPolygons2PolySet)
# gives the input PolySet nor_coast_poly_PS
res0 <- split(nor_coast_poly_PS, nor_coast_poly_PS$PID)
res1 <- lapply(res0, function(x) split(x, x$SID))
outPolygons <- vector(mode="list", length=length(res0))
for (i in seq(along=outPolygons)) {
   outPolygons[[i]] <- Polygons(lapply(res1[[i]], function(x) 
   Polygon(cbind(x$X, x$Y))), ID=as.character(i))
}
outSP <- SpatialPolygons(outPolygons)
plot(outSP)

# get the projection/zone from attr(nor_coast_poly_PS, "projection") and
# attr(nor_coast_poly_PS, "zone") if UTM, use in constructing
# the SpatialPolygons object. Now the ID= in Polygons() is just the loop 
# index - should be the PID values if they are the key value for adding
# in a data frame.

Hope this helps,

Roger

> 
> cheers
> 
> Andrew Niccolai
> Doctoral Candidate
> Yale School of Forestry
> 203-432-5144
> 
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From kbennett at uvic.ca  Mon Mar 26 22:28:21 2007
From: kbennett at uvic.ca (Katrina Bennett)
Date: Mon, 26 Mar 2007 13:28:21 -0700
Subject: [R-sig-Geo] Summary to Query for overlapping points in R
In-Reply-To: <1174766471.10772.1181191713@webmail.messagingengine.com>
References: <mailman.19.1174734006.3519.r-sig-geo@stat.math.ethz.ch>
	<1174766471.10772.1181191713@webmail.messagingengine.com>
Message-ID: <000801c76fe5$573232d0$ca0f688e@pcic.uvic.ca>


This is a summary of the responses and my solution to my initial posting of
Fri, 23 Mar 2007: Query for overlapping points in R?

Thanks very much for the responses and assistance with this problem. Roger,
the 'clip' function is included in the entire version of the code, appended
below.

Katrina Bennett

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Response 1: Roger Bivand (Roger.Bivand at nhh.no)

Well, why not simply measure the distances between the points in the two
files, treating points within a small threshold as common? Use a small
threshold rather than equality to avoid numerical fuzz problems.
spDistsN1() in sp will do that iterated over points in one of the sets.
Using the two indices, you can build up your output. Please consider using
sp classes - messing around inside the deprecated Map class is not
necessarily robust.

By the way, what is the function clip() in your code below?

Roger

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Response 2: Nicholas Lewin-Koh (nikko at hailmail.net)
Hi Katrina,
If your data are really only points all you need to do if you have dat1 and
dat2 as two datasets like you described is, i1<-which(dat1$lat%in%dat2$lat &
dat1$long%in%dat2$long) i2<-which(dat2$lat%in%dat1$lat &
at2$long%in%dat1$long)
o1<-order(dat1$lat[i1],dat1$long[i1]
o2<-order(dat2$lat[i2],dat2$long[i2]
(dat1[i1,-c("lat","long")])[o1,]-(dat1[i2,-c("lat","long")])[o2,]

Mind you this is not elegant, and there is probably a faster ways,
but it will get you what you need.

Cheers
Nicholas

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
My Updated Code:


#Import the libraries which we will need
require (sp)
require (shapefiles)

#This is a list of variabiles to process  #removed "prec", from sentence
below to run 1 more time...
vars = c("monavg_prec","monavg_temp", "monavg_tmin", "monavg_tmax")

#This is a list of climate drivers to process
datats = c("elnino", "lanina", "ensoneutral", "pdominus", "pdoplus")

#This is the list of normals for these drivers
normalbits = c("normals_enso", "normals_enso", "normals_enso",
"normals_pdo", "normals_pdo")

#This will define the regions
region = 8

# Uses internal data in x to return only the entries in x that are within
the poly
clip <- function(x) {
  moo <- NULL
  for (point in 1:nrow(x)) {
    if (x[point,]$io > 0) {
      moo <- rbind(moo, x[point,])
    }
  }
  return(moo)
}

shape <- read.shapefile("BCregions7g1") #open the shapefile for each region

#This loop runs over all the climate driver and variable combinations 
for (varname in vars){
  for (id in 1:5){
    variancefile <- paste(varname, "_", datats[id], ".csv", sep = "")
    normalfile <- paste(varname, "_", normalbits[id], ".csv", sep = "")
    
    #Import the data file(s)
    variances <- read.csv(variancefile, header = T)
    normals <- read.csv(normalfile, header = T)
    
    variance <- colnames(variances)
      for (i in 3:length(variance)){
          colnames(variances)[i] <- substr(variance[i],2,3)
    }
    
     normal <- colnames(normals)
      for (i in 3:length(normal)){
          colnames(normals)[i] <- substr(normal[i],2,3)
    }
    
    #region_variables = c()
   
    #Clip regions (have to examine maptools package)
    clip_variance <- clip(cbind(variances, io =
point.in.polygon(variances$Long, variances$Lat,
shape$shp$shp[[region]]$points$X, shape$shp$shp[[region]]$points$Y)))
    clip_normal <- clip(cbind(normals, io = point.in.polygon(normals$Long,
normals$Lat, shape$shp$shp[[region]]$points$X,
shape$shp$shp[[region]]$points$Y)))
          
      
    i1 <- which(clip_variance$Lat%in%clip_normal$Lat &
clip_variance$Long%in%clip_normal$Long)
    i2 <- which(clip_normal$Lat%in%clip_variance$Lat &
clip_normal$Long%in%clip_variance$Long)
    
    o1 <- order(clip_variance$Lat[i1], clip_variance$Long[i1])
    o2 <- order(clip_normal$Lat[i2], clip_normal$Long[i2])
                    
    # generate anomalies, retaining the order of the rows
    anomalies <- (clip_variance[i1,c(3:ncol(clip_variance))])[o1,] -
(clip_normal[i2,c(3:ncol(clip_normal))])[o2,]
        
    geo_anom <- cbind((clip_variance[i1,c("Lat", "Long")])[o1,], anomalies)
          
    # Generate output files for the complete data set
    outputfile <- paste(varname, "_", datats[id], "_", region, ".csv", sep =
"")
    write.csv(geo_anom, outputfile)
    }
}



From v.gomezrubio at imperial.ac.uk  Mon Mar 26 22:53:25 2007
From: v.gomezrubio at imperial.ac.uk (Virgilio =?ISO-8859-1?Q?G=F3mez-Rubio?=)
Date: Mon, 26 Mar 2007 21:53:25 +0100
Subject: [R-sig-Geo] PBSmapping to SpatialPolygonsDF
In-Reply-To: <200703262022.l2QKLwiC007763@pantheon-po13.its.yale.edu>
References: <200703262022.l2QKLwiC007763@pantheon-po13.its.yale.edu>
Message-ID: <1174942405.4658.14.camel@fh-vrubio.sm.med.ic.ac.uk>

Hi,

I am also interested in this convertion function. In fact, yesterday
night I wrote some code to convert from PolySet to SP, but Roger's code
is much better than mine... 

If nobody is already doing it, can I take Roger's code, add a few checks
and make a function to be included in, say, maptools? 

Best regards,

Virgilio

El lun, 26-03-2007 a las 16:21 -0400, Andrew Niccolai escribi?:
> Roger!!! Thank you very much.  I needed to adjust your code only to account
> for the fact that my tesselated object did not have a SID column and also I
> needed to add a step to "repeat" the first set of XY cords for each polygon
> to close the loop.  Other than that, it worked like a charm out of the gate.
> 
> Thank you.
> 
> Here are my changes to Roger's code in case others have data sets w/o closed
> loops.
> 
> ##--- convert from Polyset in PBSmapping to SPDF
> ## example(PolySet2SpatialPolygons ---written by R.Bivand)
> res0 <- split(cb.tess, cb.tess$PID)
> for(i in 1:length(res0)){
> res0[[i]] <- rbind(res0[[i]],res0[[i]][1,])
> }
> outPolygons <- vector(mode="list", length=length(res0)) 
> for (i in seq(along=outPolygons)) {
> outPolygons[[i]] <- Polygons(lapply(res0[[i]], function(x)
> Polygon(cbind(res0[[i]]$X, res0[[i]]$Y))), ID=as.character(i))
> } 
> outSP <- SpatialPolygons(outPolygons)
> plot(outSP)
> 
> Andrew Niccolai
> Doctoral Candidate
> Yale School of Forestry
> 203-432-5144
>  
> 
> -----Original Message-----
> From: Roger Bivand [mailto:Roger.Bivand at nhh.no] 
> Sent: Monday, March 26, 2007 3:34 PM
> To: Andrew Niccolai
> Cc: r-sig-geo at stat.math.ethz.ch
> Subject: Re: PBSmapping to SpatialPolygonsDF
> 
> On Mon, 26 Mar 2007, Andrew Niccolai wrote:
> 
> > Is there a pre-existing function or a clever way to pull a PBSmapping
> object
> > of class "Polyset", "data.frame" into a SpatialPolygonsDataFrame?
> > 
> > I found the SpatialPolygons2PolySet function and was hoping that there is
> a
> > way to go the other direction.
> > 
> > I have created a voronoi tessellation for a set of 627 points and then
> > clipped that by the convex hull of those points.  The object looks like
> > this:
> > 
> > > class(cb.tess)
> > [1] "PolySet"    "data.frame"
> > > names(cb.tess)
> > [1] "PID" "POS" "X"   "Y"  
> > > head(cb.tess)
> >   PID POS        X        Y
> > 1   1   1 945062.2 860290.8
> > 2   1   2 945073.5 860273.0
> > 3   1   3 945062.7 860272.6
> > 4   1   4 945062.5 860272.7
> > 5   1   5 945055.9 860277.4
> > 6   1   6 945057.8 860291.4
> > > tail(cb.tess)
> >   PID POS        X        Y
> > 1 626   9 944972.3 859813.1
> > 2 627   1 945009.7 859794.3
> > 3 627   2 944993.8 859769.0
> > 4 627   3 944985.3 859763.3
> > 5 627   4 944990.9 859804.2
> > 6 627   5 945008.2 859804.6
> > 
> > I would like to slip back into the world of SPDF if possible.
> > 
> > Thanks in advance for help, suggestions or code.
> 
> Not yet a function, but if you could try this and polish it a bit, I think 
> it's workable:
> 
> example(SpatialPolygons2PolySet)
> # gives the input PolySet nor_coast_poly_PS
> res0 <- split(nor_coast_poly_PS, nor_coast_poly_PS$PID)
> res1 <- lapply(res0, function(x) split(x, x$SID))
> outPolygons <- vector(mode="list", length=length(res0))
> for (i in seq(along=outPolygons)) {
>    outPolygons[[i]] <- Polygons(lapply(res1[[i]], function(x) 
>    Polygon(cbind(x$X, x$Y))), ID=as.character(i))
> }
> outSP <- SpatialPolygons(outPolygons)
> plot(outSP)
> 
> # get the projection/zone from attr(nor_coast_poly_PS, "projection") and
> # attr(nor_coast_poly_PS, "zone") if UTM, use in constructing
> # the SpatialPolygons object. Now the ID= in Polygons() is just the loop 
> # index - should be the PID values if they are the key value for adding
> # in a data frame.
> 
> Hope this helps,
> 
> Roger
> 
> > 
> > cheers
> > 
> > Andrew Niccolai
> > Doctoral Candidate
> > Yale School of Forestry
> > 203-432-5144
> > 
> > 
>



From Roger.Bivand at nhh.no  Tue Mar 27 08:13:35 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 27 Mar 2007 08:13:35 +0200 (CEST)
Subject: [R-sig-Geo] PBSmapping to SpatialPolygonsDF
In-Reply-To: <1174942405.4658.14.camel@fh-vrubio.sm.med.ic.ac.uk>
Message-ID: <Pine.LNX.4.44.0703270812350.25326-100000@reclus.nhh.no>

On Mon, 26 Mar 2007, Virgilio G?mez-Rubio wrote:

> Hi,
> 
> I am also interested in this convertion function. In fact, yesterday
> night I wrote some code to convert from PolySet to SP, but Roger's code
> is much better than mine... 
> 
> If nobody is already doing it, can I take Roger's code, add a few checks
> and make a function to be included in, say, maptools? 
> 

Yes, please do - I'm sure more users are interested too.

Roger

> Best regards,
> 
> Virgilio
> 
> El lun, 26-03-2007 a las 16:21 -0400, Andrew Niccolai escribi?:
> > Roger!!! Thank you very much.  I needed to adjust your code only to account
> > for the fact that my tesselated object did not have a SID column and also I
> > needed to add a step to "repeat" the first set of XY cords for each polygon
> > to close the loop.  Other than that, it worked like a charm out of the gate.
> > 
> > Thank you.
> > 
> > Here are my changes to Roger's code in case others have data sets w/o closed
> > loops.
> > 
> > ##--- convert from Polyset in PBSmapping to SPDF
> > ## example(PolySet2SpatialPolygons ---written by R.Bivand)
> > res0 <- split(cb.tess, cb.tess$PID)
> > for(i in 1:length(res0)){
> > res0[[i]] <- rbind(res0[[i]],res0[[i]][1,])
> > }
> > outPolygons <- vector(mode="list", length=length(res0)) 
> > for (i in seq(along=outPolygons)) {
> > outPolygons[[i]] <- Polygons(lapply(res0[[i]], function(x)
> > Polygon(cbind(res0[[i]]$X, res0[[i]]$Y))), ID=as.character(i))
> > } 
> > outSP <- SpatialPolygons(outPolygons)
> > plot(outSP)
> > 
> > Andrew Niccolai
> > Doctoral Candidate
> > Yale School of Forestry
> > 203-432-5144
> >  
> > 
> > -----Original Message-----
> > From: Roger Bivand [mailto:Roger.Bivand at nhh.no] 
> > Sent: Monday, March 26, 2007 3:34 PM
> > To: Andrew Niccolai
> > Cc: r-sig-geo at stat.math.ethz.ch
> > Subject: Re: PBSmapping to SpatialPolygonsDF
> > 
> > On Mon, 26 Mar 2007, Andrew Niccolai wrote:
> > 
> > > Is there a pre-existing function or a clever way to pull a PBSmapping
> > object
> > > of class "Polyset", "data.frame" into a SpatialPolygonsDataFrame?
> > > 
> > > I found the SpatialPolygons2PolySet function and was hoping that there is
> > a
> > > way to go the other direction.
> > > 
> > > I have created a voronoi tessellation for a set of 627 points and then
> > > clipped that by the convex hull of those points.  The object looks like
> > > this:
> > > 
> > > > class(cb.tess)
> > > [1] "PolySet"    "data.frame"
> > > > names(cb.tess)
> > > [1] "PID" "POS" "X"   "Y"  
> > > > head(cb.tess)
> > >   PID POS        X        Y
> > > 1   1   1 945062.2 860290.8
> > > 2   1   2 945073.5 860273.0
> > > 3   1   3 945062.7 860272.6
> > > 4   1   4 945062.5 860272.7
> > > 5   1   5 945055.9 860277.4
> > > 6   1   6 945057.8 860291.4
> > > > tail(cb.tess)
> > >   PID POS        X        Y
> > > 1 626   9 944972.3 859813.1
> > > 2 627   1 945009.7 859794.3
> > > 3 627   2 944993.8 859769.0
> > > 4 627   3 944985.3 859763.3
> > > 5 627   4 944990.9 859804.2
> > > 6 627   5 945008.2 859804.6
> > > 
> > > I would like to slip back into the world of SPDF if possible.
> > > 
> > > Thanks in advance for help, suggestions or code.
> > 
> > Not yet a function, but if you could try this and polish it a bit, I think 
> > it's workable:
> > 
> > example(SpatialPolygons2PolySet)
> > # gives the input PolySet nor_coast_poly_PS
> > res0 <- split(nor_coast_poly_PS, nor_coast_poly_PS$PID)
> > res1 <- lapply(res0, function(x) split(x, x$SID))
> > outPolygons <- vector(mode="list", length=length(res0))
> > for (i in seq(along=outPolygons)) {
> >    outPolygons[[i]] <- Polygons(lapply(res1[[i]], function(x) 
> >    Polygon(cbind(x$X, x$Y))), ID=as.character(i))
> > }
> > outSP <- SpatialPolygons(outPolygons)
> > plot(outSP)
> > 
> > # get the projection/zone from attr(nor_coast_poly_PS, "projection") and
> > # attr(nor_coast_poly_PS, "zone") if UTM, use in constructing
> > # the SpatialPolygons object. Now the ID= in Polygons() is just the loop 
> > # index - should be the PID values if they are the key value for adding
> > # in a data frame.
> > 
> > Hope this helps,
> > 
> > Roger
> > 
> > > 
> > > cheers
> > > 
> > > Andrew Niccolai
> > > Doctoral Candidate
> > > Yale School of Forestry
> > > 203-432-5144
> > > 
> > > 
> > 
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From raffaele.morelli at gmail.com  Tue Mar 27 11:36:05 2007
From: raffaele.morelli at gmail.com (Raffaele Morelli)
Date: Tue, 27 Mar 2007 11:36:05 +0200
Subject: [R-sig-Geo] spplot: main title layout
Message-ID: <f1357b430703270236s1d4c1d0ch8f514ef8b6d3f8a6@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20070327/477ec925/attachment.pl>

From e.pebesma at geo.uu.nl  Tue Mar 27 12:00:45 2007
From: e.pebesma at geo.uu.nl (Edzer J. Pebesma)
Date: Tue, 27 Mar 2007 12:00:45 +0200
Subject: [R-sig-Geo] spplot: main title layout
In-Reply-To: <f1357b430703270236s1d4c1d0ch8f514ef8b6d3f8a6@mail.gmail.com>
References: <f1357b430703270236s1d4c1d0ch8f514ef8b6d3f8a6@mail.gmail.com>
Message-ID: <4608EB4D.7010404@geo.uu.nl>

Raffaele, try

spplot(x, ..., main=list(label="title",cex=3))

I found this by

library(lattice)
?xyplot # search for argument main
--
Edzer

Raffaele Morelli wrote:
> Hi you all,
>
> probably this is a silly question (I mean I apologize for that in advance :)
> )
>
> I am using spplot in order to obtain png files (A4) and I am wondering how I
> can enlarge font size in the main title just like I do for legend using
> colorkey=list(..., .., cex=5).
>
> Can anyone help me?
>
> regards
> raffaele
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>



From raffaele.morelli at gmail.com  Tue Mar 27 12:13:09 2007
From: raffaele.morelli at gmail.com (Raffaele Morelli)
Date: Tue, 27 Mar 2007 12:13:09 +0200
Subject: [R-sig-Geo] spplot: main title layout
In-Reply-To: <4608EB4D.7010404@geo.uu.nl>
References: <f1357b430703270236s1d4c1d0ch8f514ef8b6d3f8a6@mail.gmail.com>
	<4608EB4D.7010404@geo.uu.nl>
Message-ID: <f1357b430703270313k7e8c5f1byc8cf51ae8ca583e0@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20070327/091bc6ea/attachment.pl>

From knussear at usgs.gov  Wed Mar 28 21:26:56 2007
From: knussear at usgs.gov (Ken Nussear)
Date: Wed, 28 Mar 2007 12:26:56 -0700
Subject: [R-sig-Geo] geoRglm question with covariates
Message-ID: <DE6E4774-4B69-4C18-92B7-D0AF79C47A20@usgs.gov>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20070328/74febe54/attachment.pl>

From dray at biomserv.univ-lyon1.fr  Thu Mar 29 13:23:33 2007
From: dray at biomserv.univ-lyon1.fr (=?ISO-8859-1?Q?St=E9phane_Dray?=)
Date: Thu, 29 Mar 2007 13:23:33 +0200
Subject: [R-sig-Geo] importing a  shapefile stored on a server
Message-ID: <460BA1B5.3020000@biomserv.univ-lyon1.fr>

Dear all,
I am just preparing a course on spatial analysis with R; The course is a 
rnw file. In the file, I want to import a shapefile within R. The 
shapefile is here : http://pbil.univ-lyon1.fr/R/donnees/francedep/

I have try :

> library(maptools)

Le chargement a n?cessit? le package : foreign

Le chargement a n?cessit? le package : sp

> library(shapefiles)

Attachement du package : 'shapefiles'

        The following object(s) are masked from package:foreign :

         read.dbf

        The following object(s) are masked from package:foreign :

         write.dbf

> read.shapefile("http://pbil.univ-lyon1.fr/R/donnees/francedep/dep_france_dom")Erreur dans get("read.dbf", "package:foreign")(dbf.name) :

        impossible d'ouvrir le fichier DBF

> read.shape("http://pbil.univ-lyon1.fr/R/donnees/francedep/dep_france_dom.shp")Erreur dans getinfo.shape(filen) : No such file

> readShapePoly("http://pbil.univ-lyon1.fr/R/donnees/francedep/dep_france_dom")

Erreur dans getinfo.shape(filen) : No such file


Is there a way to read directly this file ? One solution would be to use 
download.file and then read the shapefile but I wonder if it would be 
possible to read directly the data from the url.

Cheers.

-- 
St?phane DRAY (dray at biomserv.univ-lyon1.fr )
Laboratoire BBE-CNRS-UMR-5558, Univ. C. Bernard - Lyon I
43, Bd du 11 Novembre 1918, 69622 Villeurbanne Cedex, France
Tel: 33 4 72 43 27 57       Fax: 33 4 72 43 13 88
http://biomserv.univ-lyon1.fr/~dray/



From Roger.Bivand at nhh.no  Thu Mar 29 13:45:30 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 29 Mar 2007 13:45:30 +0200 (CEST)
Subject: [R-sig-Geo] importing a  shapefile stored on a server
In-Reply-To: <460BA1B5.3020000@biomserv.univ-lyon1.fr>
Message-ID: <Pine.LNX.4.44.0703291327450.32495-100000@reclus.nhh.no>

On Thu, 29 Mar 2007, St?phane Dray wrote:

> Dear all,
> I am just preparing a course on spatial analysis with R; The course is a 
> rnw file. In the file, I want to import a shapefile within R. The 
> shapefile is here : http://pbil.univ-lyon1.fr/R/donnees/francedep/
> 
> I have try :
> 
> > library(maptools)
> 
> Le chargement a n?cessit? le package : foreign
> 
> Le chargement a n?cessit? le package : sp
> 
> > library(shapefiles)
> 
> Attachement du package : 'shapefiles'
> 
>         The following object(s) are masked from package:foreign :
> 
>          read.dbf
> 
>         The following object(s) are masked from package:foreign :
> 
>          write.dbf
> 
> > read.shapefile("http://pbil.univ-lyon1.fr/R/donnees/francedep/dep_france_dom")Erreur dans get("read.dbf", "package:foreign")(dbf.name) :
> 
>         impossible d'ouvrir le fichier DBF
> 
> > read.shape("http://pbil.univ-lyon1.fr/R/donnees/francedep/dep_france_dom.shp")Erreur dans getinfo.shape(filen) : No such file
> 
> > readShapePoly("http://pbil.univ-lyon1.fr/R/donnees/francedep/dep_france_dom")
> 
> Erreur dans getinfo.shape(filen) : No such file
> 
> 
> Is there a way to read directly this file ? One solution would be to use 
> download.file and then read the shapefile but I wonder if it would be 
> possible to read directly the data from the url.

Almost certainly impossible. The shp and shx are binary files, not 
necessarily read sequentially. Even reading the bits in read.shp() etc. 
seems to be blocked. I think you'll find that the underlying code either 
rewinds or jumps about in the file(s). I tried seeing if readOGR() in 
rgdal would read a GML version:

http://spatial.nhh.no/misc/dep_france_dom.gml

but readOGR() wants a real file with a name. I don't think you have an 
option for shapefiles other than downloading, which does work, possibly to 
a temporary destfile.

Roger

> 
> Cheers.
> 
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From yong.li at unimelb.edu.au  Thu Mar 29 14:38:22 2007
From: yong.li at unimelb.edu.au (Yong Li)
Date: Thu, 29 Mar 2007 22:38:22 +1000 (EST)
Subject: [R-sig-Geo] can't find the function of GE_SpatialGrid
Message-ID: <2348.220.237.149.23.1175171902.squirrel@webmail.unimelb.edu.au>

Dear all,

The following is the code I try to build grid from polygons, but was
hammered by the error in the subject. Any idea helps me.

Yong

setwd("d:/Rcode/0_Zone")
library(maptools)

xx <- readShapePoly("Newshape.shp", IDvar="ID",
                    proj4string=CRS("+proj=tmerc
                                    +lat_0=0
                                    +lon_0=111
                                    +k    =1.000000
                                    +x_0  =500000
                                    +y_0  =0
                                    +ellps=krass
                                    +units =m
                                    +no_defs"))

plot(xx, col="red")

grd <- GE_SpatialGrid(xx, asp=1, maxPixels=100)$SG



From Roger.Bivand at nhh.no  Thu Mar 29 15:33:56 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 29 Mar 2007 15:33:56 +0200 (CEST)
Subject: [R-sig-Geo] can't find the function of GE_SpatialGrid
In-Reply-To: <2348.220.237.149.23.1175171902.squirrel@webmail.unimelb.edu.au>
Message-ID: <Pine.LNX.4.44.0703291530320.32495-100000@reclus.nhh.no>

On Thu, 29 Mar 2007, Yong Li wrote:

> Dear all,
> 
> The following is the code I try to build grid from polygons, but was
> hammered by the error in the subject. Any idea helps me.

sessionInfo() ?

What is the version of your maptools package - the function you are 
looking for has only been present since 0.6-7.

By the way, GE_SpatialGrid() will not accept an input object which is not 
in geographical coordinates, and yours is projected, but this is not the 
problem you state here.

Roger

> 
> Yong
> 
> setwd("d:/Rcode/0_Zone")
> library(maptools)
> 
> xx <- readShapePoly("Newshape.shp", IDvar="ID",
>                     proj4string=CRS("+proj=tmerc
>                                     +lat_0=0
>                                     +lon_0=111
>                                     +k    =1.000000
>                                     +x_0  =500000
>                                     +y_0  =0
>                                     +ellps=krass
>                                     +units =m
>                                     +no_defs"))
> 
> plot(xx, col="red")
> 
> grd <- GE_SpatialGrid(xx, asp=1, maxPixels=100)$SG
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From saburq at gmail.com  Sat Mar 31 06:28:31 2007
From: saburq at gmail.com (shoaib)
Date: Sat, 31 Mar 2007 14:28:31 +1000
Subject: [R-sig-Geo] what happened to sp?
Message-ID: <b8b84f110703302128o1e98a969yc7a6bce5ab68b570@mail.gmail.com>

hi all

Not sure if this should be asked on the grass mailing list or here.
apologies if its off-topic.

I am having a go at using R/Grass and when I try to install sp, rgdal
or maptools it complains these packages don't exist. i get the same
complaint if i try the sourceforge repo

rSpatial <- "http://r-spatial.sourceforge.net/R"
install.packages("sp", repos = rSpatial)

and as expected if i try to load spgrass6 library it complains that sp
is missing.

Whatever happed to sp? or am i doing something i shouldn't be? have
things changed over the last few months :)

thanks for any guidence

shoaib



From saburq at gmail.com  Sat Mar 31 07:54:23 2007
From: saburq at gmail.com (shoaib)
Date: Sat, 31 Mar 2007 15:54:23 +1000
Subject: [R-sig-Geo] what happened to sp?
In-Reply-To: <b8b84f110703302128o1e98a969yc7a6bce5ab68b570@mail.gmail.com>
References: <b8b84f110703302128o1e98a969yc7a6bce5ab68b570@mail.gmail.com>
Message-ID: <b8b84f110703302254y2c683c15ve3ad5d11ed91ea64@mail.gmail.com>

problem solved after I upgraded R to the latest version

thanks
shoab

On 3/31/07, shoaib <saburq at gmail.com> wrote:
> hi all
>
> Not sure if this should be asked on the grass mailing list or here.
> apologies if its off-topic.
>
> I am having a go at using R/Grass and when I try to install sp, rgdal
> or maptools it complains these packages don't exist. i get the same
> complaint if i try the sourceforge repo
>
> rSpatial <- "http://r-spatial.sourceforge.net/R"
> install.packages("sp", repos = rSpatial)
>
> and as expected if i try to load spgrass6 library it complains that sp
> is missing.
>
> Whatever happed to sp? or am i doing something i shouldn't be? have
> things changed over the last few months :)
>
> thanks for any guidence
>
> shoaib
>



From Roger.Bivand at nhh.no  Sat Mar 31 10:40:45 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sat, 31 Mar 2007 10:40:45 +0200 (CEST)
Subject: [R-sig-Geo] what happened to sp?
In-Reply-To: <b8b84f110703302254y2c683c15ve3ad5d11ed91ea64@mail.gmail.com>
Message-ID: <Pine.LNX.4.44.0703311034050.2501-100000@reclus.nhh.no>

On Sat, 31 Mar 2007, shoaib wrote:

> problem solved after I upgraded R to the latest version

Yes, all the packages are now on CRAN (spgrass6, the others are in rgdal
or maptools), there is no no need to use the off-CRAN
http://r-spatial.sourceforge.net/R repository.

You could also have stated which platform you are using, because if there 
had been a problem, it would have been platform dependent. 

The correct current install of spgrass6 is:

install.packages("spgrass6", dependencies=TRUE)

on Windows for cygwin, or on other platforms:

install.packages(c("sp", "maptools"), dependencies=TRUE)
install.packages("rgdal") # in case of problems
install.packages("spgrass6")

or just the packages that are not already installed.

Roger

> 
> thanks
> shoab
> 
> On 3/31/07, shoaib <saburq at gmail.com> wrote:
> > hi all
> >
> > Not sure if this should be asked on the grass mailing list or here.
> > apologies if its off-topic.
> >
> > I am having a go at using R/Grass and when I try to install sp, rgdal
> > or maptools it complains these packages don't exist. i get the same
> > complaint if i try the sourceforge repo
> >
> > rSpatial <- "http://r-spatial.sourceforge.net/R"
> > install.packages("sp", repos = rSpatial)
> >
> > and as expected if i try to load spgrass6 library it complains that sp
> > is missing.
> >
> > Whatever happed to sp? or am i doing something i shouldn't be? have
> > things changed over the last few months :)
> >
> > thanks for any guidence
> >
> > shoaib
> >
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



