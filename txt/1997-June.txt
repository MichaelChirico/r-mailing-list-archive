From Kurt.Hornik@ci.tuwien.ac.at  Mon Jun  2 06:19:11 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 2 Jun 1997 07:19:11 +0200
Subject: R-alpha: tapply bug
Message-ID: <199706020519.HAA01997@aragorn.ci.tuwien.ac.at>

There is a problem with tapply() in the case where INDEX is a factor
with at least one of its levels not occurring in it.

In this case,
	namelist[[i]] <- levels(index)
gets all levels but
	group <- group + ngroup * (codes(index) - 1)
only those occurring in index, which subsequently causes
	names(ans) <- namelist[[1]]
to fail.

For example,

R> f <- factor(c("a", "a", "b"), levels = letters[1:3])
R> f
[1] a a b
R> codes(f)
[1] 1 1 2
R> levels(f)
[1] "a" "b" "c"

which gives e.g.

R> tapply(rep(1, length(f)), f, sum)
Error: names attribute must be the same length as the vector

One solution is to replace

	namelist[[i]] <- levels(index)

by

	namelist[[i]] <- unique(levels(index)[index])

but perhaps there is something smarter ...

-k

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Mon Jun  2 08:31:42 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Mon, 2 Jun 97 09:31:42 +0200
Subject: R-alpha: plot(1); axis(1, at=10) >>> Seg.fault  -- and a patch
In-Reply-To: <199706020519.HAA01989@aragorn.ci.tuwien.ac.at> (message from
 Kurt Hornik on Mon, 2 Jun 1997 07:19:10 +0200)
Message-ID: <9706020731.AA00382@>

The patched version of  axis(..) which I "seemed" to post here  a while ago,
accidentally was the 0.49 original -- oh dear ! -- S_O_R_R_Y!

Here is the 'real' one:

M> This problem has been mentioned  by Arne Kovac <maak@stats.bris.ac.uk>
M> on May 9-10. 
M> The patch is really a replacement of 'axis' in  RHOME/src/library/base/funs/

M> It contains the fixes which where proposed Arne Kovac
M> and fixes all the errors he reported on May 9.

"axis" <-
function (which, at, labels = TRUE, ...) 
{
	if (which%%2 == 1) {
		axp <- par("xaxp")
		usr <- par("usr")[1:2]
		log <- par("xlog")
	} else {
		axp <- par("yaxp")
		usr <- par("usr")[3:4]
		log <- par("ylog")
	}
	ind <-
	  if (missing(at)) {
	    at <-
	      if (log) {
		if (usr[2] < usr[1] + 1) {
		  seq(axp[1], axp[2], length = axp[3] + 1)
		} else {
		  p1 <- ceiling(min(usr))
		  p2 <- floor(max(usr))
		  if (p2 - p1 < 2) {
		    at <- c(1, 2, 5) * 10^rep(p1:p2, rep(3, p2 - p1 + 1))
		    at[10^usr[1] <= at & at < 10^usr[2]]
		  }
		  else 10^seq(p1, p2, by = 1)
		}
	      } else seq(axp[1], axp[2], length = axp[3] + 1)
	    rep(TRUE, length(at))
	  } else {
	    at <- sort(at)
	    if (log) (10^usr[1] <= at & at <= 10^usr[2])
	    else     (	 usr[1] <= at & at <=	 usr[2])
	  }
	if(any(ind)) {
	  labels <-
	    if (is.logical(labels)) {
	      if (labels) {
		if (!log) 
		  at[abs(at/(max(at) - min(at))) < 0.001] <- 0
		format(at, trim = T)
	      }
	      else rep("", length(at))
	    } else format(labels, trim = T)
	  .Internal(axis(which, as.double(at[ind]), labels[ind], ...))
	} else warning("axis: Couldn't draw anything; maybe 'at' out of range.")
}

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Jun  2 10:57:16 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 2 Jun 1997 11:57:16 +0200
Subject: R-alpha: S doc -> R doc
Message-ID: <199706020957.LAA08243@aragorn.ci.tuwien.ac.at>

Attached is the current version of my sd2rd perl script.  It has passed
tests by Martin, Fritz and myself, and seems to work reasonably well (it
should get the arguments lists right, distinguish between VALUE and
VALUES, and know about REFERENCES and SEEALSO).

Any comments etc are most welcome.

-k

************************************************************************
#!/usr/bin/perl -w

$\ = "\n";

$parenLevel = 0;
$doprint = 1;
$needArg = 1;
$needVal = 0;
$output = "";

while (<>) {
    chop;
    &substitute;
    @word = split;

    if (/^[^.]/) { &output($_); }

    if (/^\.AG/) {
	if ($needArg) {
	    &section(0, "ARGUMENTS(");
	    $needArg = 0;
	}
	&section(1, "ARG($word[1] @@");
    }
    if (/^\.CS/) { &section(0, "USAGE("); }
    if (/^\.DN/) { $doprint = 0; }
    if (/^\.DT/) { &section(0, "DESCRIPTION("); }
    if (/^\.EX/) { &section(0, "EXAMPLES("); }
    if (/^\.FN/) { $fun = $word[1]; }
    if (/^\.(IP|PP)/) { output("PARA"); }
    if (/^\.RC/) {
	if ($needVal) {
	    $needVal = 0;	    
	    &section(0, "VALUES(\n$output\n@@");
	    $doprint = 1;
	}
	&section(1, "ARG($word[1] @@");
    }
    if (/^\.RT/) {
	$needVal = 1;
	$doprint = 0;
	$output = "";
    }
    if (/^\.SA/) { &section(0, "SEEALSO("); }
    if (/^\.SE/) { &paragraph("SIDE EFFECTS"); }
    if (/^\.SH/) {
	if ($word[1] =~ /REFERENCE/) {
	    &section(0, "REFERENCES(");
	} else {
	    &paragraph($word[1]);
	}
    }
    if (/^\.sp/) { output("BLANK"); }
    if (/^\.TL/) { &section(0, "TITLE($fun @@"); }
    if (/^\.WR/) { &section(0, ""); }

    if (/^\.AO/) {
	output("Arguments for function LANG($word[1]()) can also be");
	output("supplied to this function.");
    }
    if (/^\.GE/) {
	output("This is a generic function.");
	output("Functions with names beginning in LANG($fun.) will be");
	output("methods for this function.");
    }
    if (/^\.GR/) {
	output("Graphical parameters (see LANG(par())) may also be");
	output("supplied as arguments to this function.");
    }
    if (/^\.ME/) {
	output("This function is a method for the generic function");
	output("LANG($word[1]()) for class LANG($word[2]).");
	output("It can be invoked by calling LANG($word[1](x)) for an");
	output("object LANG(x) of the appropriate class, or directly by");
	output("calling LANG($word[1].$word[2](x)) regardless of the");
	output("class of the object.");
    }
    if (/^\.NA/) { output("Missing values (LANG(NA)s) are allowed."); }
    if (/^\.Tl/) {
	output("In addition, the high-level graphics control arguments");
	output("described under LANG(par()) and the arguments to");
	output("LANG(title()) may be supplied to this function.");
    }
}

sub substitute {
    s/\\fB/BOLD\(/g;
    s/\\fR/\)/g;
    s/\.\.\./DOTS/g;
}

sub section {
    local($level, $text) = @_;
    $n = $parenLevel - $level;
    print(")" x $n) if ($n > 0);
    if ($needVal) {
	print("VALUE(\n$output\n)");
	$needVal = 0;
    }
    print("$text") if $text;    
    $parenLevel = $level + 1;
    $doprint = 1;
}

sub paragraph {
    local($name) = @_;
    &output("PARA\nBOLD($name): ");
}
    
sub output {
    local($text) = @_;
    if ($doprint) {
	print($text);
    } elsif ($output) {
	$output .= "\n$text";
    } else {
	$output = $text;
    }
}
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Mon Jun  2 18:44:36 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Mon, 2 Jun 1997 10:44:36 -0700 (PDT)
Subject: R-alpha: S doc -> R doc
In-Reply-To: <199706020957.LAA08243@aragorn.ci.tuwien.ac.at>
Message-ID: <Pine.SUN.3.95.970602104156.955C-100000@zen>

On Mon, 2 Jun 1997, Kurt Hornik wrote:

> Attached is the current version of my sd2rd perl script.  It has passed
> tests by Martin, Fritz and myself, and seems to work reasonably well (it
> should get the arguments lists right, distinguish between VALUE and
> VALUES, and know about REFERENCES and SEEALSO).
> 
> Any comments etc are most welcome.


Very nice.  A more advanced feature (which I completely gave up on) would
be hyperlinking the SEE ALSO section (i.e. 

.SA
foo, bar
 should translate to
SEEALSO(
LANG(LINK(foo)), LANG(LINK(bar))
)



Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Tue Jun  3 07:40:52 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 3 Jun 1997 08:40:52 +0200
Subject: R-alpha: cov.mve
Message-ID: <199706030640.IAA11973@aragorn.ci.tuwien.ac.at>

Is there public domain code for cov.mve?
Thanks,
-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Jun  3 08:18:19 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 3 Jun 97 09:18:19 +0200
Subject: R-alpha:  cov.mve  &  lmsreg -- "minvol" and "progress" @ statlib
In-Reply-To: <199706030640.IAA11973@aragorn.ci.tuwien.ac.at> (message from
 Kurt Hornik on Tue, 3 Jun 1997 08:40:52 +0200)
Message-ID: <9706030718.AA00848@>

[CC to some relevant 'robustniks' and the author of the software;
   read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html  to learn more about R]

>>>>> "Kurt" == Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

    Kurt> Is there public domain code for cov.mve?  

"Yes", the biggest part of it,  aka "minvol"  is made freely available by
by its author, Peter Rousseeuw. It's in Statlib   general/minvol

The same is true for  'lmsreg'  which I am even more eager to see in R;
the basic program is called  "progress".

Note: There is an (fairly unknown)  Statlib mirror in Europe

	  ftp://unix.hensa.ac.uk/mirrors/statlib/

The 2 robust statistics contributions of  Rousseeuw  are thus

	  ftp://unix.hensa.ac.uk/mirrors/statlib/general/minvol
	  ftp://unix.hensa.ac.uk/mirrors/statlib/general/progress

Martin Maechler <maechler@stat.math.ethz.ch>		 <><
Seminar fuer Statistik, SOL G1
ETH (Federal Inst. Technology)	8092 Zurich	 SWITZERLAND
phone: x-41-1-632-3408		fax: ...-1086
http://www.stat.math.ethz.ch/~maechler/
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From rousse@uia.ua.ac.be  Tue Jun  3 08:34:46 1997
From: rousse@uia.ua.ac.be (Peter.Rousseeuw)
Date: Tue, 3 Jun 1997 09:34:46 +0200
Subject: R-alpha:  cov.mve  &  lmsreg -- "minvol" and "progress" @ statlib
Message-ID: <9706030734.AA22999@hwins.uia.ac.be>

Dear colleagues,

actually, more recent versions of PROGRESS and MINVOL than those in
Statlib can be fetched from our website

         http://win-www.uia.ac.be/u/statis

With friendly greetings,

Peter
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Tue Jun  3 13:54:00 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 3 Jun 1997 14:54:00 +0200
Subject: R-alpha: rd2sd v0.1
Message-ID: <199706031254.OAA13309@aragorn.ci.tuwien.ac.at>

Here is an updated version of the S doc -> R doc script.  New features
are automatic conversion of `xxx' to LANG(xxx) or LANG(LINK(xxx)) in
SEEALSO sections, respectively (thanks to Martin and Thomas for the
suggestions).

The keywords are saved as comments, and can easily be used as soon as
keywords are supported.

As usual, any feedback ...

-k

**********************************************************************
#!/usr/bin/perl -w

$VERSION = "0.1";

$\ = "\n";

$parenLevel = 0;
$doprint = 1;
$needArg = 1;
$needVal = 0;
$seealso = 0;
$output = "";

while (<>) {
    chop;
    &substitute;
    @word = split;

    if (/^[^.]/) { &output($_); }

    if (/^\.AG/) {
	if ($needArg) {
	    &section(0, "ARGUMENTS(");
	    $needArg = 0;
	}
	&section(1, "ARG($word[1] @@");
    }
    if (/^\.CS/) { &section(0, "USAGE("); }
    if (/^\.DN/) { $doprint = 0; }
    if (/^\.DT/) { &section(0, "DESCRIPTION("); }
    if (/^\.EX/) { &section(0, "EXAMPLES("); }
    if (/^\.FN/) { $fun = $word[1]; }
    if (/^\.(IP|PP)/) { &output("PARA"); }
    if (/^\.KW/) { 
	if ($parenLevel > 0) {
	    &section(0, "");
	    $parenLevel = 0;
	}
	&output("COMMENT(KEYWORD($word[1]))");
    }
    if (/^\.RC/) {
	if ($needVal) {
	    $needVal = 0;	    
	    &section(0, "VALUES(\n$output\n@@");
	    $doprint = 1;
	}
	&section(1, "ARG($word[1] @@");
    }
    if (/^\.RT/) {
	$needVal = 1;
	$doprint = 0;
	$output = "";
    }
    if (/^\.SA/) {
	&section(0, "SEEALSO(");
	$seealso = 1;
    }
    if (/^\.SE/) { &paragraph("SIDE EFFECTS"); }
    if (/^\.SH/) {
	if ($word[1] =~ /REFERENCE/) {
	    &section(0, "REFERENCES(");
	} else {
	    &paragraph($word[1]);
	}
    }
    if (/^\.sp/) { output("BLANK"); }
    if (/^\.TL/) { &section(0, "TITLE($fun @@"); }
    if (/^\.WR/) {
	&section(0, "");
	print("COMMENT(Converted by sd2rd version $VERSION.)");
    }

    if (/^\.AO/) {
	output("Arguments for function LANG($word[1]()) can also be");
	output("supplied to this function.");
    }
    if (/^\.GE/) {
	output("This is a generic function.");
	output("Functions with names beginning in LANG($fun.) will be");
	output("methods for this function.");
    }
    if (/^\.GR/) {
	output("Graphical parameters (see LANG(LINK(par)) may also be");
	output("supplied as arguments to this function.");
    }
    if (/^\.ME/) {
	output("This function is a method for the generic function");
	output("LANG($word[1]()) for class LANG($word[2]).");
	output("It can be invoked by calling LANG($word[1](x)) for an");
	output("object LANG(x) of the appropriate class, or directly by");
	output("calling LANG($word[1].$word[2](x)) regardless of the");
	output("class of the object.");
    }
    if (/^\.NA/) { output("Missing values (LANG(NA)s) are allowed."); }
    if (/^\.Tl/) {
	output("In addition, the high-level graphics control arguments");
	output("described under LANG(LINK(par)) and the arguments to");
	output("LANG(LINK(title)) may be supplied to this function.");
    }
}

sub substitute {
    s/\\fB/BOLD\(/g;
    s/\\fR/\)/g;
    s/\.\.\./DOTS/g;
    if ($seealso) {
	s/\`([^\']*)\'/LANG(LINK($1))/g;
    } else {
	s/\`([^\']*)\'/LANG($1)/g;
    }
}

sub section {
    local($level, $text) = @_;
    $n = $parenLevel - $level;
    print(")" x $n) if ($n > 0);
    if ($needVal) {
	print("VALUE(\n$output\n)");
	$needVal = 0;
    }
    print("$text") if $text;    
    $parenLevel = $level + 1;
    $doprint = 1;
    $seealso = 0;
}

sub paragraph {
    local($name) = @_;
    &output("PARA\nBOLD($name): ");
}
    
sub output {
    local($text) = @_;
    if ($doprint) {
	print($text);
    } elsif ($output) {
	$output .= "\n$text";
    } else {
	$output = $text;
    }
}
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Tue Jun  3 15:45:11 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 3 Jun 1997 16:45:11 +0200
Subject: R-alpha: unif_rand() again
Message-ID: <199706031445.QAA13652@aragorn.ci.tuwien.ac.at>

Just out of curiosity, here is a question that might be embarrasingly
stupid.  Hmm ...

What I need is to call runif() (more precisely, `runif(1, 0, 1)') from
inside a C function.  Is this possible using call_S?  If so, how?

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Tue Jun  3 16:14:09 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 03 Jun 1997 17:14:09 +0200
Subject: R-alpha: unif_rand() again
In-Reply-To: Kurt Hornik's message of Tue, 3 Jun 1997 16:45:11 +0200
References: <199706031445.QAA13652@aragorn.ci.tuwien.ac.at>
Message-ID: <x2yb8r4t31.fsf@bush.kubism.ku.dk>

Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

> 
> Just out of curiosity, here is a question that might be embarrasingly
> stupid.  Hmm ...
> 
> What I need is to call runif() (more precisely, `runif(1, 0, 1)') from
> inside a C function.  Is this possible using call_S?  If so, how?

Hmm ... Stupid counter-question: Did you study the zfun() function in
$RHOME/demos/dynload/zero.c ? Looks pretty straightforward to me,
except that I have no offhand guess what the 0L argument to call_S is
good for. Peeking at the source should cure that.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Tue Jun  3 16:17:29 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 3 Jun 1997 17:17:29 +0200
Subject: R-alpha: unif_rand() again
In-Reply-To: <x2yb8r4t31.fsf@bush.kubism.ku.dk>
References: <199706031445.QAA13652@aragorn.ci.tuwien.ac.at>
 <x2yb8r4t31.fsf@bush.kubism.ku.dk>
Message-ID: <199706031517.RAA13734@aragorn.ci.tuwien.ac.at>

>>>>> Peter Dalgaard BSA writes:

> Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:
>> 
>> Just out of curiosity, here is a question that might be embarrasingly
>> stupid.  Hmm ...
>> 
>> What I need is to call runif() (more precisely, `runif(1, 0, 1)') from
>> inside a C function.  Is this possible using call_S?  If so, how?

> Hmm ... Stupid counter-question: Did you study the zfun() function in
> $RHOME/demos/dynload/zero.c ? Looks pretty straightforward to me,
> except that I have no offhand guess what the 0L argument to call_S is
> good for. Peeking at the source should cure that.

I did.  I hoped that something like

static char *func = "runif";

double unif_rand() {
  void *in[3];
  char *modes[] = { "integer", "integer", "integer" };
  long lengths[] = { 1, 1, 1 };  
  void *out[1];
  double *result;

  in[0] = (void *)1L;
  in[1] = (void *)0L;
  in[2] = (void *)1L;  
  call_S((void *)func, 3L, in, modes, lengths, 0L, 1L, out);
  result = (double *)out[0];
  return(result[0]);
}

might work, but it does not ...

-k


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Andreas.Weingessel@ci.tuwien.ac.at  Tue Jun  3 16:24:11 1997
From: Andreas.Weingessel@ci.tuwien.ac.at (Andreas Weingessel)
Date: Tue, 3 Jun 1997 17:24:11 +0200
Subject: R-alpha: bug in sum
Message-ID: <199706031524.RAA22384@elendil.ci.tuwien.ac.at>


If the sum of a vector containing NAs is computed and na.rm is FALSE,
the result is not always NA. 

R> w <- c(1:3,NA)
R> sum(w)
[1] NA

BUT

R> w <- c(NA, 1:3)
R> sum(w)
[1] 0

It seems that this problem only occurs, if the first element is NA.

Andreas

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From luke@stat.umn.edu  Tue Jun  3 16:28:37 1997
From: luke@stat.umn.edu (Luke Tierney)
Date: Tue, 3 Jun 1997 10:28:37 -0500 (CDT)
Subject: R-alpha: unif_rand() again
In-Reply-To: <x2yb8r4t31.fsf@bush.kubism.ku.dk> from "Peter Dalgaard BSA" at Jun 3, 97 05:14:09 pm
Message-ID: <9706031528.AA15627@nokomis.stat.umn.edu>

Peter Dalgaard BSA wrote:
> 
> Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:
> 
> > 
> > Just out of curiosity, here is a question that might be embarrasingly
> > stupid.  Hmm ...
> > 
> > What I need is to call runif() (more precisely, `runif(1, 0, 1)') from
> > inside a C function.  Is this possible using call_S?  If so, how?
> 
> Hmm ... Stupid counter-question: Did you study the zfun() function in
> $RHOME/demos/dynload/zero.c ? Looks pretty straightforward to me,
> except that I have no offhand guess what the 0L argument to call_S is
> good for. Peeking at the source should cure that.
> 
> -- 
>    O__  ---- Peter Dalgaard             Blegdamsvej 3  
>   c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
>  (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
> ~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
> =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
> r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
> Send "info", "help", or "[un]subscribe"
> (in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
> =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
> 


This may not be an issue here but it is something to keep in mind for
call_S in S and R:

You need to be careful about making lots of call_S's that return large
amounts of data within a single call to .C. The reason is that the
call_S mechanism provides no way to mark the returned result as no
longer needed, so it cannot be reclaimed. Allocations made in the
process of executing the function called with call_S should be freed
just fine, but the result can't be. So if you produce lots of results,
you will consume lots of memory. For most uses of call_S this isn't an
issue, but if you were doing the loop of a long simulation is C and
it could become an issue.

-- 
Luke Tierney
University of Minnesota                      Phone:           612-625-7843
School of Statistics                         Fax:             612-624-8868
206 Church Street                            email:      luke@stat.umn.edu
Minneapolis, MN 55455 USA                    WWW:  http://www.stat.umn.edu
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Tue Jun  3 17:23:24 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 03 Jun 1997 18:23:24 +0200
Subject: R-alpha: unif_rand() again
In-Reply-To: Kurt Hornik's message of Tue, 3 Jun 1997 17:17:29 +0200
References: <199706031445.QAA13652@aragorn.ci.tuwien.ac.at>
 <x2yb8r4t31.fsf@bush.kubism.ku.dk>
 <199706031517.RAA13734@aragorn.ci.tuwien.ac.at>
Message-ID: <x2u3jf4pvm.fsf@bush.kubism.ku.dk>

Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

> >> What I need is to call runif() (more precisely, `runif(1, 0, 1)') from
> >> inside a C function.  Is this possible using call_S?  If so, how?
> 
> > Hmm ... Stupid counter-question: Did you study the zfun() function in
> > $RHOME/demos/dynload/zero.c ? Looks pretty straightforward to me,
> > except that I have no offhand guess what the 0L argument to call_S is
> > good for. Peeking at the source should cure that.
> 
> I did.  I hoped that something like
> 
> static char *func = "runif";
> 
> double unif_rand() {
...
>   return(result[0]);
> }
> 
> might work, but it does not ...

Aha. I see, call_R seems to want an SEXP parameter, not a character
pointer. So some way of converting "runif" into the relevant SEXPREC seems
to be needed. Something like mkChar() <um, no, that doesn't seem to be
the way to make a "SEXPsymbol"..> followed by findFun(). Or just pass
it as a parameter to .C

This looks like a bug in the S compatibility, doesn't it? Nothing in
the Splus examples indicate that the first argument should be a
string, but I seem to recall seeing something to that effect in the
blue book (?) 

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From luke@stat.umn.edu  Tue Jun  3 17:39:49 1997
From: luke@stat.umn.edu (Luke Tierney)
Date: Tue, 3 Jun 1997 11:39:49 -0500 (CDT)
Subject: R-alpha: unif_rand() again
In-Reply-To: <x2u3jf4pvm.fsf@bush.kubism.ku.dk> from "Peter Dalgaard BSA" at Jun 3, 97 06:23:24 pm
Message-ID: <9706031639.AA15847@nokomis.stat.umn.edu>

Peter Dalgaard BSA wrote:
> 
> Aha. I see, call_R seems to want an SEXP parameter, not a character
> pointer. So some way of converting "runif" into the relevant SEXPREC seems
> to be needed. Something like mkChar() <um, no, that doesn't seem to be
> the way to make a "SEXPsymbol"..> followed by findFun(). Or just pass
> it as a parameter to .C
> 
> This looks like a bug in the S compatibility, doesn't it? Nothing in
> the Splus examples indicate that the first argument should be a
> string, but I seem to recall seeing something to that effect in the
> blue book (?) 
> 

In the blue book the call looks like

	.C("zero_find", list(f), ...)

and is used as

	zero_find(void **ff, ...) {
	  func = ff[0];
	  ...
	  call_S(func, ...
	  ...
	}

In the R example the call looks like

	.C("zero_find", f, ...)

and is used as

	zero_find(void *f, ...) {
	  func = f;
	  ...
	  call_S(func, ...
	  ...
	}

In the blue book there is the extra wrapping in alist which gets
undone with a dereference in C -- I don't know if this is really
needed to or not.

-- 
Luke Tierney
University of Minnesota                      Phone:           612-625-7843
School of Statistics                         Fax:             612-624-8868
206 Church Street                            email:      luke@stat.umn.edu
Minneapolis, MN 55455 USA                    WWW:  http://www.stat.umn.edu
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Tue Jun  3 18:21:57 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 03 Jun 1997 19:21:57 +0200
Subject: R-alpha: unif_rand() again
In-Reply-To: Kurt Hornik's message of Tue, 3 Jun 1997 17:17:29 +0200
References: <199706031445.QAA13652@aragorn.ci.tuwien.ac.at>
 <x2yb8r4t31.fsf@bush.kubism.ku.dk>
 <199706031517.RAA13734@aragorn.ci.tuwien.ac.at>
Message-ID: <x2pvu34n62.fsf@bush.kubism.ku.dk>

Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

> I did.  I hoped that something like
> 
> static char *func = "runif";
> 
> double unif_rand() {
...
> 
> might work, but it does not ...

Here's a model that does (seem to) work:

> dyn.load("runif.so");.C("select_rand",runif); .C("unif_rand",3.3)
[[1]]
function (n, min = 0, max = 1) 
.Internal(runif(n, min, max))

[[1]]
[1] 0.126975

> .C("unif_rand",3.3) # the 3.3 is just an arbitrary double...
[[1]]
[1] 0.9233792

> .C("unif_rand",3.3)
[[1]]
[1] 0.03410953

> 

with

runif.c:

-------------------------

static void * func;

double select_rand(void * f)
{
        func = f;
}

static long one = 1L, zero = 0L;
unif_rand(double *x) {
  void *in[3];
  char *modes[] = { "integer", "integer", "integer" };
  long lengths[] = { 1, 1, 1 };  
  double result;
  double *values[1];

  in[0] = (void *)&one;
  in[1] = (void *)&zero;
  in[2] = (void *)&one;  
  call_S((void *)func, 3L, in, modes, lengths, 0L, 1L, values);
  x[0] = values[0][0];
}

--------------------------


-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From luke@stat.umn.edu  Tue Jun  3 19:15:43 1997
From: luke@stat.umn.edu (Luke Tierney)
Date: Tue, 3 Jun 1997 13:15:43 -0500 (CDT)
Subject: R-alpha: unif_rand() again
In-Reply-To: <x2pvu34n62.fsf@bush.kubism.ku.dk> from "Peter Dalgaard BSA" at Jun 3, 97 07:21:57 pm
Message-ID: <9706031815.AA15866@nokomis.stat.umn.edu>

Peter Dalgaard BSA wrote:

> Here's a model that does (seem to) work:
> 
> > dyn.load("runif.so");.C("select_rand",runif); .C("unif_rand",3.3)
> [[1]]
...
> with
> 
> double select_rand(void * f)
> {
>         func = f;
> }
> 

I'm not sure I see the point of the separate select_rand -- you can
just pass runif as an argument to unif_rand. The original example
needed to use the global variable because a C routine for finding a
zero of a C function was being used and the C function whose root was
to be found needed to get at the S/R function that it was fronting
for. The global variable is needed to pass this info (since you don't
have C closures). Here there isn't any need that I can see, but maybe
I've missed something (wouldn't be the first time :-)).

-- 
Luke Tierney
University of Minnesota                      Phone:           612-625-7843
School of Statistics                         Fax:             612-624-8868
206 Church Street                            email:      luke@stat.umn.edu
Minneapolis, MN 55455 USA                    WWW:  http://www.stat.umn.edu
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Tue Jun  3 23:29:16 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 04 Jun 1997 00:29:16 +0200
Subject: R-alpha: unif_rand() again
In-Reply-To: Luke Tierney's message of Tue, 3 Jun 1997 13:15:43 -0500 (CDT)
References: <9706031815.AA15866@nokomis.stat.umn.edu>
Message-ID: <x2soyzqq0z.fsf@bush.kubism.ku.dk>

Luke Tierney <luke@stat.umn.edu> writes:

> 
> Peter Dalgaard BSA wrote:
> 
> > Here's a model that does (seem to) work:
> > 
> > > dyn.load("runif.so");.C("select_rand",runif); .C("unif_rand",3.3)
> > [[1]]
> ...
> > with
> > 
> > double select_rand(void * f)
> > {
> >         func = f;
> > }
> > 
> 
> I'm not sure I see the point of the separate select_rand -- you can
> just pass runif as an argument to unif_rand.

Now what *did* I mean by that?.... Oh, yes. The original point
involved calling R from a C function. I'm .C-ing it in that bit of
code just for testing it. In practice, it might well get called from
another C function doing a simulation. So, since it appears to be
tricky to do the string-to-functionSEXP conversion in C, it might be
easier to explicitly initialize them from R with the "select_rand"
mechanism. Of course, one might also pass the R function directly to
the simulation routine, and have that one set things up.

Come to think of it, I'm not sure that we *want* the S semantics for
this. Consider

f<-function(a) a^2
Phi<-function(z)
{
	f<-function(z) exp(-z^2/2)/sqrt(2*pi)
	.C("integrate", f, -infty, zero)
}
where integrate() needs to call_S. It must be ensured that it passes
the inner 'f'. 

Hmm. That's not really an argument for having a call_S("f",...) rather
than call_S(f,...). It is no different from the work involved in any
other name lookup (including constructions like "x %myop% y" or
"'hello, world!'(5)"); it's just that it seems a bit silly to search
for a function by name when you already know full well what the
address of the function is. Inefficient, but hardly impossible.

Maybe one could set it up so that call_S did the string thing and
call_R the direct function pointer?

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Jun  9 07:02:18 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 9 Jun 1997 08:02:18 +0200
Subject: R-alpha: unif_rand() again
In-Reply-To: <x2u3jf4pvm.fsf@bush.kubism.ku.dk>
References: <199706031445.QAA13652@aragorn.ci.tuwien.ac.at>
 <x2yb8r4t31.fsf@bush.kubism.ku.dk>
 <199706031517.RAA13734@aragorn.ci.tuwien.ac.at>
 <x2u3jf4pvm.fsf@bush.kubism.ku.dk>
Message-ID: <199706090602.IAA32599@aragorn.ci.tuwien.ac.at>

>>>>> Peter Dalgaard BSA writes:

> Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:
>> >> What I need is to call runif() (more precisely, `runif(1, 0, 1)') from
>> >> inside a C function.  Is this possible using call_S?  If so, how?
>> 
>> > Hmm ... Stupid counter-question: Did you study the zfun() function in
>> > $RHOME/demos/dynload/zero.c ? Looks pretty straightforward to me,
>> > except that I have no offhand guess what the 0L argument to call_S is
>> > good for. Peeking at the source should cure that.
>> 
>> I did.  I hoped that something like
>> 
>> static char *func = "runif";
>> 
>> double unif_rand() {
> ...
>> return(result[0]);
>> }
>> 
>> might work, but it does not ...

> Aha. I see, call_R seems to want an SEXP parameter, not a character
> pointer. So some way of converting "runif" into the relevant SEXPREC
> seems to be needed. Something like mkChar() <um, no, that doesn't seem
> to be the way to make a "SEXPsymbol"..> followed by findFun(). Or just
> pass it as a parameter to .C

I see.

Thanks to all who helped.  I now have a working example of unif_rand(),
but I still hope for Ross to come up with something cleaner ...

Trying to map a function name to the function in call_R would be very
nice, in any case.

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Jun  9 14:21:51 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 9 Jun 1997 15:21:51 +0200
Subject: R-alpha: sd2rd v0.1-1
Message-ID: <199706091321.PAA01472@aragorn.ci.tuwien.ac.at>

Attached is another update.

New features/bugs:
*) now also attempts to get non-quoted object names within SEEALSO
sections to have a LANG(LINK(...)) around them
*) parentheses are now ALWAYS quoted, to prevent the rdoc2... scripts
from choking on unbalanced ones (e.g., "x in the range (0, 1]")
*) blank lines are mapped into PARA so that e.g. reference sections come
out better
*) comments are mapped into comments :-)

Please have a try.

-k

************************************************************************
#!/usr/bin/perl -w

$VERSION = "0.1-1";

$\ = "\n";

$parenLevel = 0;
$inSeeAlso = 0;
$doprint = 1;
$needArg = 1;
$needVal = 0;
$output = "";

while (<>) {
    chop;
    &substitute unless /^\./;
    @word = split;

    if (/^\s*$/) { &output("PARA"); }
    if (/^[^.]/) { &output($_); }

    if (/^\.AG/) {
	if ($needArg) {
	    &section(0, "ARGUMENTS(");
	    $needArg = 0;
	}
	&section(1, "ARG($word[1] @@");
    }
    if (/^\.CS/) { &section(0, "USAGE("); }
    if (/^\.DN/) { $doprint = 0; }
    if (/^\.DT/) { &section(0, "DESCRIPTION("); }
    if (/^\.EX/) { &section(0, "EXAMPLES("); }
    if (/^\.FN/) { $fun = $word[1]; }
    if (/^\.(IP|PP)/) { &output("PARA"); }
    if (/^\.KW/) { 
	if ($parenLevel > 0) {
	    &section(0, "");
	    $parenLevel = 0;
	}
	&output("COMMENT(KEYWORD($word[1]))");
    }
    if (/^\.RC/) {
	if ($needVal) {
	    $needVal = 0;	    
	    &section(0, "VALUES(\n$output\n@@");
	    $doprint = 1;
	}
	&section(1, "ARG($word[1] @@");
    }
    if (/^\.RT/) {
	$needVal = 1;
	$doprint = 0;
	$output = "";
    }
    if (/^\.SA/) {
	&section(0, "SEEALSO(");
	$inSeeAlso = 1;
    }
    if (/^\.SE/) { &paragraph("SIDE EFFECTS"); }
    if (/^\.SH/) {
	if ($word[1] =~ /REFERENCE/) {
	    &section(0, "REFERENCES(");
	} else {
	    &paragraph($word[1]);
	}
    }
    if (/^\.sp/) { output("BLANK"); }
    if (/^\.TL/) { &section(0, "TITLE($fun @@"); }
    if (/^\.WR/) {
	&section(0, "");
	print("COMMENT(Converted by sd2rd version $VERSION.)");
    }

    if (/^\.AO/) {
	output("Arguments for function LANG($word[1]()) can also be");
	output("supplied to this function.");
    }
    if (/^\.GE/) {
	output("This is a generic function.");
	output("Functions with names beginning in LANG($fun.) will be");
	output("methods for this function.");
    }
    if (/^\.GR/) {
	output("Graphical parameters (see LANG(LINK(par)) may also be");
	output("supplied as arguments to this function.");
    }
    if (/^\.ME/) {
	output("This function is a method for the generic function");
	output("LANG($word[1]()) for class LANG($word[2]).");
	output("It can be invoked by calling LANG($word[1](x)) for an");
	output("object LANG(x) of the appropriate class, or directly by");
	output("calling LANG($word[1].$word[2](x)) regardless of the");
	output("class of the object.");
    }
    if (/^\.NA/) { output("Missing values (LANG(NA)s) are allowed."); }
    if (/^\.Tl/) {
	output("In addition, the high-level graphics control arguments");
	output("described under LANG(LINK(par)) and the arguments to");
	output("LANG(LINK(title)) may be supplied to this function.");
    }
}



sub substitute {
    s/\(/\\\(/g;
    s/\)/\\\)/g;
    s/\.\.\./DOTS/g;    
    s/\\fB/BOLD\(/g;
    s/\\fR/\)/g;
    s/\\\.(.*)$/COMMENT($1)/g;
    if ($inSeeAlso) {
	s/\`?([\.\w]*\w+)\'?/LANG(LINK($1))/g;
    } else {
	s/\`([^\']*)\'/LANG($1)/g;
    }
}

sub section {
    local($level, $text) = @_;
    $n = $parenLevel - $level;
    print(")" x $n) if ($n > 0);
    if ($needVal) {
	print("VALUE(\n$output\n)");
	$needVal = 0;
    }
    print("$text") if $text;    
    $parenLevel = $level + 1;
    $doprint = 1;
    $inSeeAlso = 0;
}

sub paragraph {
    local($name) = @_;
    &output("PARA\nBOLD($name): ");
}
    
sub output {
    local($text) = @_;
    if ($doprint) {
	print($text);
    } elsif ($output) {
	$output .= "\n$text";
    } else {
	$output = $text;
    }
}
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Jun  9 18:40:29 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 9 Jun 1997 19:40:29 +0200
Subject: R-alpha: Re: R-beta: mlbench-0.1 --- machine learning benchmark problems
In-Reply-To: <199706091621.SAA16397@galadriel.ci.tuwien.ac.at>
References: <199706091621.SAA16397@galadriel.ci.tuwien.ac.at>
Message-ID: <199706091740.TAA03191@aragorn.ci.tuwien.ac.at>

>>>>> Friedrich Leisch writes:

> I've made a package from some benchmark datasets for use with R and
> uploaded it to CRAN.=20

> Here's the Index entry:

> mlbench-0.1.tar.gz:
> 	A collection of artificial and real-world machine learning
> 	benchmark problems, including, e.g., the boston housing
> 	data from the UCI repository.

> 	Written/packaged by Fritz Leisch <Friedrich.Leisch@ci.tuwien.ac.at>
> 	Original data sets from various sources.
> 	[1997/06/09]


> This (naturally) includes some data files ... hence you have to do
> some parts of the installation manually, see the INSTALL file for
> details (IMHO R has no clear concept for data: one flat directory is
> certainly not sufficient).

Just for the sake of completeness (for those who don't use our Debian
GNU/Linux packages).  We have ``meanwhile'' (before we agree on an
official R file standard) simply introduced a one-level hierarchy in
RHOME/data.  The data files that come with the base distribution are in
RHOME/data/base, the new ones in RHOME/data/mlbench etc.

This change requires nothing but changing RHOME/cmd/filename, e.g. as
below.

What would also be nice is to have `make libs' install the data as well
to RHOME/data/$LIBNAME.

-k

***********************************************************************
#!/bin/sh

for file in $HOME/lib/R/$1/$2 \
            $RHOME/$1/$2 \
            $RHOME/$1/[^.]*/$2;
do
    if [ -r $file ]
    then
	echo $file
	break
    fi
done

if [ ! -r $file ]
then
    echo
fi
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Mon Jun  9 22:13:42 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 09 Jun 1997 23:13:42 +0200
Subject: R-alpha: Transposition bug
Message-ID: <x2afkzlbsp.fsf@bush.kubism.ku.dk>

Shortest program to crash R?

> t(table(1))
Floating point exception (core dumped)

One-dimensional tables don't act like vectors, obviously. The crash
comes from an integer divide-by-zero (yup, that causes a SIGFPE) in

#0  0x8058e0b in do_transpose (call=0x4050c1e4, op=0x401c65fc, 
    args=0x4050c1bc, rho=0x4050e4e4) at array.c:545
545                             INTEGER(r)[i] = INTEGER(a)[(i / ncol)
+ (i % ncol) * nrow];


-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Tue Jun 10 18:46:19 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 10 Jun 1997 19:46:19 +0200
Subject: R-alpha: sd2rd 0.1-2
Message-ID: <199706101746.TAA09501@aragorn.ci.tuwien.ac.at>

Another update of the S doc -> R doc conversion script is attached
below.  Relative to the previously released version, there are two
changes.

* Quoting of parentheses does not happen in verbatim-like sections

* More importantly, the way words in the .SA (SEEALSO) section are
treated is now controlled by an optional argument, `-x'.

Without this option, only words enclosed in single accents are mapped to
LANG(LINK(...)).  With `-x', there are xtra substitutions---all words in
the section are mapped.

I introduced this optional argument because on the one hand, Thomas
pointed out that many S doc files do not quote the object names (e.g. in
survival4), whereas Martin said that the clean way was to quote them, as
there is no reason why non-object names should not appear within .SA.
So, the optional argument should make everyone happy.

I still have several suggestions on my TODO list, but I think the
current version should be rather stable and pretty much usable, so
perhaps one could include it in the R distribution's `etc' directory.

-k

*********************************************************************
#!/usr/bin/perl -w

$VERSION = "0.1-2";

$\ = "\n";

$parenLevel = 0;
$inVerbatim = 0;
$inSeeAlso = 0;
$doprint = 1;
$needArg = 1;
$needVal = 0;
$output = "";

$opt_x = 0;
use Getopt::Long;
GetOptions (("x")) || &usage();

while (<>) {
    chop;
    &substitute unless /^\./;
    @word = split;

    if (/^\s*$/) {
	if ($inVerbatim) {
	    &output("BLANK");
	} else {
	    &output("PARA");
	}
    }
    if (/^[^.]/) { &output($_); }

    if (/^\.AG/) {
	if ($needArg) {
	    &section(0, "ARGUMENTS(");
	    $needArg = 0;
	}
	&section(1, "ARG($word[1] @@");
    }
    if (/^\.CS/) {
	&section(0, "USAGE(");
	$inVerbatim = 1;
    }
    if (/^\.DN/) { $doprint = 0; }
    if (/^\.DT/) { &section(0, "DESCRIPTION("); }
    if (/^\.EX/) {
	&section(0, "EXAMPLES(");
	$inVerbatim = 1;	
    }
    if (/^\.FN/) { $fun = $word[1]; }
    if (/^\.(IP|PP)/) { &output("PARA"); }
    if (/^\.KW/) { 
	if ($parenLevel > 0) {
	    &section(0, "");
	    $parenLevel = 0;
	}
	&output("COMMENT(KEYWORD($word[1]))");
    }
    if (/^\.RC/) {
	if ($needVal) {
	    $needVal = 0;	    
	    &section(0, "VALUES(\n$output\n@@");
	    $doprint = 1;
	}
	&section(1, "ARG($word[1] @@");
    }
    if (/^\.RT/) {
	$needVal = 1;
	$doprint = 0;
	$output = "";
    }
    if (/^\.SA/) {
	&section(0, "SEEALSO(");
	$inSeeAlso = 1;
    }
    if (/^\.SE/) { &paragraph("SIDE EFFECTS"); }
    if (/^\.SH/) {
	if ($word[1] =~ /REFERENCE/) {
	    &section(0, "REFERENCES(");
	} else {
	    &paragraph($word[1]);
	}
    }
    if (/^\.sp/) { output("BLANK"); }
    if (/^\.TL/) { &section(0, "TITLE($fun @@"); }
    if (/^\.WR/) {
	&section(0, "");
	print("COMMENT(Converted by sd2rd version $VERSION.)");
    }

    if (/^\.AO/) {
	output("Arguments for function LANG($word[1]()) can also be");
	output("supplied to this function.");
    }
    if (/^\.GE/) {
	output("This is a generic function.");
	output("Functions with names beginning in LANG($fun.) will be");
	output("methods for this function.");
    }
    if (/^\.GR/) {
	output("Graphical parameters (see LANG(LINK(par)) may also be");
	output("supplied as arguments to this function.");
    }
    if (/^\.ME/) {
	output("This function is a method for the generic function");
	output("LANG($word[1]()) for class LANG($word[2]).");
	output("It can be invoked by calling LANG($word[1](x)) for an");
	output("object LANG(x) of the appropriate class, or directly by");
	output("calling LANG($word[1].$word[2](x)) regardless of the");
	output("class of the object.");
    }
    if (/^\.NA/) { output("Missing values (LANG(NA)s) are allowed."); }
    if (/^\.Tl/) {
	output("In addition, the high-level graphics control arguments");
	output("described under LANG(LINK(par)) and the arguments to");
	output("LANG(LINK(title)) may be supplied to this function.");
    }
}

sub substitute {
    if (!$inVerbatim) {
	s/\(/\\\(/g;
	s/\)/\\\)/g;
    }
    s/\.\.\./DOTS/g;    
    s/\\fB/BOLD\(/g;
    s/\\fR/\)/g;
    s/\\\.(.*)$/COMMENT($1)/g;
    if ($inSeeAlso) {
	if ($opt_x) {
	    s/\`?([\.\w]*\w+)\'?/LANG(LINK($1))/g;
	} else {
	    s/\`([^\']*)\'/LANG(LINK($1))/g;
	}
    } else {
	s/\`([^\']*)\'/LANG($1)/g;
    }
}

sub section {
    local($level, $text) = @_;
    $n = $parenLevel - $level;
    print(")" x $n) if ($n > 0);
    if ($needVal) {
	print("VALUE(\n$output\n)");
	$needVal = 0;
    }
    print("$text") if $text;    
    $parenLevel = $level + 1;
    $inVerbatim = 0;
    $inSeeAlso = 0;
    $doprint = 1;    
}

sub paragraph {
    local($name) = @_;
    &output("PARA\nBOLD($name): ");
}
    
sub output {
    local($text) = @_;
    if ($doprint) {
	print($text);
    } elsif ($output) {
	$output .= "\n$text";
    } else {
	$output = $text;
    }
}

sub usage {
    print("\nsd2rd version $VERSION\n\nusage:  sd2rd [-x] file\n");
    exit;
}
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Tue Jun 10 18:53:24 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 10 Jun 1997 19:53:24 +0200
Subject: R-alpha: problem saving boxplots to PostScript
Message-ID: <199706101753.TAA09525@aragorn.ci.tuwien.ac.at>

The title says it all---seems that the boxes disappear when saving a
boxplot to PostScript.

Is this a known problem?  (Andreas thinks so ...)

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Wed Jun 11 18:37:32 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 11 Jun 1997 19:37:32 +0200
Subject: R-alpha: write() && quoting && ...
Message-ID: <199706111737.TAA12848@aragorn.ci.tuwien.ac.at>

Has anyone had some time to look at the generic write() I posted some
time ago?  I'd appreciate some feedback/comments/suggestions on how to
consistently deal with quoting and name-type attributes ...

On a related matter, Martin indicated that it would be nice to have a
"matrix" class, etc.  Is there any reason for not doing so?  Should not
do any harm, and would make writing methods for generic functions nicer.

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ben@eno.Princeton.EDU  Wed Jun 11 19:15:55 1997
From: ben@eno.Princeton.EDU (Ben Bolker)
Date: Wed, 11 Jun 1997 14:15:55 -0400 (EDT)
Subject: R-alpha: PS bug fix and various minor graphics bugs
In-Reply-To: <199706111737.TAA12848@aragorn.ci.tuwien.ac.at>
Message-ID: <Pine.SUN.3.95.970611141002.11295A-100000@paca>


   I don't know if this bug has been fixed in a patch I missed, but ...

  line 154 of devPS.c, which currently reads

maxpointsize = 72.0 * ((pageheight>pagewidth)) ? pageheight : pagewidth;

   should read

maxpointsize = 72.0 * ((pageheight>pagewidth) ? pageheight : pagewidth);

  The misplaced parenthesis makes maxpointsize wrong.

  Other comments (things I may get around to fixing when I'm less busy):

   - on quick examination "mkh" appears to have no effect;
   - the components of mgp(x,y,z) appear to get rounded off to integers at
some point, which I don't like (but should at least appear in
documentation if there's a good reason for it); I like to be able to
fine-tune distances ...
   - when using arrows() on a log-scaled plot, you have to use log(x)
coordinates rather than x-coordinates.  This could be intentional (but is
not the way text() works, so I would say it should be made to work the way
text() works).

  
Benjamin Bolker          Dep't of Ecology and Evolutionary Biology,
ben@eno.princeton.edu    Princeton University
tel: (609) 258-6886,     fax: (609) 258-1334

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Thu Jun 12 00:02:03 1997
From: ihaka@stat.auckland.ac.nz (Ross &)
Date: Thu, 12 Jun 1997 11:02:03 +1200 (NZST)
Subject: R-alpha: PS bug fix and various minor graphics bugs
In-Reply-To: <Pine.SUN.3.95.970611141002.11295A-100000@paca>
References: <199706111737.TAA12848@aragorn.ci.tuwien.ac.at>
 <Pine.SUN.3.95.970611141002.11295A-100000@paca>
Message-ID: <199706112302.LAA24151@stat1.stat.auckland.ac.nz>

Ben Bolker writes:
 > 
 >    I don't know if this bug has been fixed in a patch I missed, but ...
 > 
 >   line 154 of devPS.c, which currently reads
 > 
 > maxpointsize = 72.0 * ((pageheight>pagewidth)) ? pageheight : pagewidth;
 > 
 >    should read
 > 
 > maxpointsize = 72.0 * ((pageheight>pagewidth) ? pageheight : pagewidth);
 > 
 >   The misplaced parenthesis makes maxpointsize wrong.

This is indeed an error.  I have made the change.

 >   Other comments (things I may get around to fixing when I'm less busy):
 > 
 >    - on quick examination "mkh" appears to have no effect;

This is deliberate.  You can use the cex parameter scales the size
of everything.  If you need "exact" mark sizes I can look at adding
it.

 >    - the components of mgp(x,y,z) appear to get rounded off to integers at
 > some point, which I don't like (but should at least appear in
 > documentation if there's a good reason for it); I like to be able to
 > fine-tune distances ...

This was a typo in the saving and restoring of graphical parameters.
The temporary saved value was typed "int" instead of double.

 >    - when using arrows() on a log-scaled plot, you have to use log(x)
 > coordinates rather than x-coordinates.  This could be intentional (but is
 > not the way text() works, so I would say it should be made to work the way
 > text() works).

Yes, this is because I ommited the transformation in both "segments"
and "arrows".  This is a bug.

All these things will be fixed in 0.50 which is "almost ready to
roll".  It is examination / final-grade time here so there may be a
small delay before the release.
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Thu Jun 12 01:11:33 1997
From: ihaka@stat.auckland.ac.nz (Ross &)
Date: Thu, 12 Jun 1997 12:11:33 +1200 (NZST)
Subject: R-alpha: X11/Postscript Hardcopy bug
Message-ID: <199706120011.MAA25233@stat1.stat.auckland.ac.nz>

A couple of people have come across this recently (piecharts and
boxplots trigger it I think.  Here is a fix (not a patch because
a new release is at hand).

In the C code in src/unix/psx11.c, replace the function psx11_Polygon
with the following code.
	Ross

- - - s n i p - - - h e r e - - -

void psx11_Polygon(int n, double *x, double *y, int bg, int fg)
{
        int i;
        if(bg != NA_INTEGER) {
                psx11_SetColor(bg);
                fprintf(psfp, "np\n");
                fprintf(psfp, "%.2f %.2f m\n",
                        xoffset + xscale * x[0],
                        yoffset + yscale * y[0]);
                for(i=1 ; i<n ; i++) {
                        fprintf(psfp, "%.2f %.2f l\n",
                                xoffset + xscale * x[i],
                                yoffset + yscale * y[i]);
                }
                fprintf(psfp, "cp f\n");
        }
        if(fg != NA_INTEGER) {
                psx11_SetColor(fg);
                fprintf(psfp, "np\n");
                fprintf(psfp, "%.2f %.2f m\n",
                        xoffset + xscale * x[0],
                        yoffset + yscale * y[0]);
                for(i=1 ; i<n ; i++) {
                        fprintf(psfp, "%.2f %.2f l\n",
                                xoffset + xscale * x[i],
                                yoffset + yscale * y[i]);
                }
                fprintf(psfp, "cp o\n");
        }
}
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Thu Jun 12 06:32:35 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Thu, 12 Jun 1997 07:32:35 +0200
Subject: R-alpha: X11/Postscript Hardcopy bug
In-Reply-To: <199706120011.MAA25233@stat1.stat.auckland.ac.nz>
References: <199706120011.MAA25233@stat1.stat.auckland.ac.nz>
Message-ID: <199706120532.HAA14730@aragorn.ci.tuwien.ac.at>

>>>>> Ross & writes:

> A couple of people have come across this recently (piecharts and
> boxplots trigger it I think.  Here is a fix (not a patch because
> a new release is at hand).

> In the C code in src/unix/psx11.c, replace the function psx11_Polygon
> with the following code.

Thanks, works great.

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Fri Jun 13 00:57:17 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Fri, 13 Jun 1997 11:57:17 +1200 (NZST)
Subject: R-alpha: ISO Latin1 and Readline
Message-ID: <199706122357.LAA03285@stat1.stat.auckland.ac.nz>

Does anyone have experience with using the readline library in
conjunction with ISO Latin1 characters?

In response to a prod from Martin Maechler I am trying to convert R so
that it will accept 8-bit characters (and render them correctly in text
and graphics).  This appears to work when I type such lines into a file
and source it, but readline seems to intercept any 8-bit characters
I type interactively  and refuses to let them through to R.

Is this cured if you have the right kind of keyboard?

Additional query: Should accented characters be allowed in variable names?

	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Fri Jun 13 06:03:39 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Fri, 13 Jun 1997 07:03:39 +0200
Subject: R-alpha: ISO Latin1 and Readline
In-Reply-To: <199706122357.LAA03285@stat1.stat.auckland.ac.nz>
References: <199706122357.LAA03285@stat1.stat.auckland.ac.nz>
Message-ID: <199706130503.HAA04192@aragorn.ci.tuwien.ac.at>

>>>>> Ross Ihaka writes:

> Does anyone have experience with using the readline library in
> conjunction with ISO Latin1 characters?

> In response to a prod from Martin Maechler I am trying to convert R so
> that it will accept 8-bit characters (and render them correctly in text
> and graphics).  This appears to work when I type such lines into a file
> and source it, but readline seems to intercept any 8-bit characters
> I type interactively  and refuses to let them through to R.

> Is this cured if you have the right kind of keyboard?

Hmm.

I have e.g.

hornik@aragorn:/var/tmp/hornik$ cat =E4=F6=FC.dat=20
1 2 3
4 5 6

R> x <- read.table("/var/tmp/hornik/=E4=F6=FC.dat")
R> x
  V1 V2 V3
1  1  2  3
2  4  5  6

I think the trick is that you need to have the readline init file
(INPUTRC, typically something like /etc/inputrc) specify

     # don't strip characters to 7 bits when reading
     set input-meta on
    =20
     # allow iso-latin1 characters to be inserted rather than converted t=
o
     # prefix-meta sequences
     set convert-meta off
    =20
     # display characters with the eighth bit set directly rather than
     # as meta-prefixed characters
     set output-meta on

(comments from the readline/info sample file, the settings are what we
use here ...).

> Additional query: Should accented characters be allowed in variable
> names?

Not sure.  Maybe yes so that e.g. if I had to impress someone in
Austrian I could use "Gr=F6=DFe" as a variable name ...

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Jun 13 13:43:50 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 13 Jun 1997 14:43:50 +0200
Subject: R-alpha: ISO Latin1 and Readline
In-Reply-To: <199706130503.HAA04192@aragorn.ci.tuwien.ac.at> (message from
 Kurt Hornik on Fri, 13 Jun 1997 07:03:39 +0200)
Message-ID: <199706131243.OAA08910@sophie.ethz.ch>

One thing which is important is
to use the environment variable 

	LC_CTYPE=iso_8859_1

(This makes Emacs  automatically call (standard-display-european 1)

Here, the readline library is not of much importance, because

	1) We use US-american keyboards 
	   which makes programming / latex / Splus much easier.

	2) In Emacs, we use a nice package 
		(require 'iso-transl)
	   and
	        (iso-transl-set-language "German")

	   which makes C-x 8 and more imporantly
           'Alt' (the one besides "Meta" on a SPARC keyboard)
           behave as a prefix for accented characters.
	
	  So, the German Umlauts are produced using 
		Alt-a (), ....Alt-U (), 
		and even the one we don't use in Switzerland, Alt-s ()
	  Also, Alt-m (=)  ,   Alt-< (=) ;  

	  And for all accents: 
		Alt-accent-letter  -->  accented letter.

	   Alt-'-e  -> 
	   Alt-^-i  -> 

	 and so on -- this is much more powerful than any language specific
	 keyboard.

and then, we use  S-mode / R-mode / latex-mode / shell-mode   from within
Emacs. 

------------

Back to R:
	
I think most important are

1) string constants
2) Comments

and then

3)  text(.) and mtext(.)  of these constants.

4) Variable names might come natural to some users, 
   especially the ones that come from non-Unix worlds.

------------------------------
Remark to '3)'   and postscript(.).

In newer versions of S-plus (>= 3.1 I think),
there is the 

       ps.options (setfont = ps.setfont.latin1)

command which allows for  ISO-latin1 text.
The big drawback is that the default plotting character is DIFFERENT
and worse.

If you want to see what I mean, execute the following and compare the 2
postscript files:

#### Deal with 'bug' :
#### if       		ps.options (setfont = ps.setfont.latin1)
#### has been called,
#### the default plotting character, the 'bullet' is drawn much too small.

pso <- ps.options (reset = T)
ps.options (setfont = ps.setfont.latin1)
postscript("latin1-ex.ps")
plot(1:10, main =" by Martin Mchler")
Txt <- paste("ps.options (reset = T)",
	     "ps.options (setfont = ps.setfont.latin1)",
	     "plot(1:10, main = \" by Martin Mchler\")",
	     "text(1,9,\"__all this text__\")",sep="\n")
text(1,9,Txt, adj=0)
dev.off()

pso <- ps.options (reset = T)
postscript("std-ex.ps")
plot(1:10, main =" by Martin Mchler")
text(1,9,"ps.options (reset = T)\nplot(1:10, main = \"....\")",adj=0)
dev.off()
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Fri Jun 13 14:55:38 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 13 Jun 1997 15:55:38 +0200
Subject: R-alpha: ISO Latin1 and Readline
In-Reply-To: Kurt Hornik's message of Fri, 13 Jun 1997 07:03:39 +0200
References: <199706122357.LAA03285@stat1.stat.auckland.ac.nz>
 <199706130503.HAA04192@aragorn.ci.tuwien.ac.at>
Message-ID: <x2d8pq8v51.fsf@bush.kubism.ku.dk>

Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

> I think the trick is that you need to have the readline init file
> (INPUTRC, typically something like /etc/inputrc) specify
> 
>      # don't strip characters to 7 bits when reading
>      set input-meta on
>      
>      # allow iso-latin1 characters to be inserted rather than converted to
>      # prefix-meta sequences
>      set convert-meta off
>      
>      # display characters with the eighth bit set directly rather than
>      # as meta-prefixed characters
>      set output-meta on

Exactly. One loses the Meta characters that way, unavoidable since
Meta works in xterms and other terminals by OR'ing characters with
0x128, so e.g. M-x == . No big deal, use ESC x instead. (Who uses
it anyway?)

> > Additional query: Should accented characters be allowed in variable
> > names?
> 
> Not sure.  Maybe yes so that e.g. if I had to impress someone in
> Austrian I could use "Gre" as a variable name ...

One less newbie error when teaching... Are there any arguments
*against* it?

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ben@eno.Princeton.EDU  Mon Jun 16 01:21:38 1997
From: ben@eno.Princeton.EDU (Ben Bolker)
Date: Sun, 15 Jun 1997 20:21:38 -0400 (EDT)
Subject: R-alpha: image(): minor bug in R code and helpfile (fixes)
Message-ID: <Pine.SUN.3.95.970615201153.20427A-100000@paca>


   I've noticed a few minor annoyances/mismatches with S in image().
 
  First, if you give it just a matrix argument (image(z)), it complains
rather than (as S does) using default x and y.

  This patch fixes it to work (mostly) like S (although in keeping with
what was in R already the default x,y coordinates are ((0,1),(0,1)) rather
than (1:nrow,1:ncol)). 

5,16d4
<        if(is.list(x)) {
<              z <- x$z
<              y <- x$y
<              x <- x$x
<               if(is.null(x) || is.null(y) || is.null(z))
<                stop("list must contain x, y, and z components with z a matrix")
<         }
<         else if(missing(y) && missing(z) && is.matrix(x)) {
<                 z <- x
<                 x <- seq(0,1,len=nrow(z))
<                 y <- seq(0,1,len=ncol(z))
<         }

  Second, the examples in the help file don't actually work(!) without the
following changes:

51c51
< image(z=volcano, x, y,
---
> image(volcano, x, y,
53c53
< contour(z=volcano, x, y, levels=seq(90, 200, by=5),
---
> contour(volcano, x, y, zc=seq(90, 200, by=5),

   (By the way, there is currently no help for contour().)

  A more general question: what are the ethics/legalities of adapting
S/S-PLUS function code to use in R?  

Benjamin Bolker          Dep't of Ecology and Evolutionary Biology,
ben@eno.princeton.edu    Princeton University
tel: (609) 258-6886,     fax: (609) 258-1334

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Wed Jun 18 18:42:56 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Wed, 18 Jun 1997 10:42:56 -0700 (PDT)
Subject: R-alpha: f77 on Solaris
In-Reply-To: <199706091321.PAA01472@aragorn.ci.tuwien.ac.at>
Message-ID: <Pine.SUN.3.95.970618103955.1332B-100000@zen>


The autoconfigure flags for f77 on Solaris 5.5.1 are wrong
They should be FFLAGS=" -pic" rather than FFLAGS=" -fpic"


Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Thu Jun 19 08:46:23 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Thu, 19 Jun 1997 09:46:23 +0200
Subject: R-alpha: f77 on Solaris
In-Reply-To: <Pine.SUN.3.95.970618103955.1332B-100000@zen> (message from
 Thomas Lumley on Wed, 18 Jun 1997 10:42:56 -0700 (PDT))
Message-ID: <199706190746.JAA07101@sophie.ethz.ch>

>>>>> "Thomas" == Thomas Lumley <thomas@biostat.washington.edu> writes:

    Thomas> The autoconfigure flags for f77 on Solaris 5.5.1 are wrong They
    Thomas> should be FFLAGS=" -pic" rather than FFLAGS=" -fpic"

am I right that you suggest patching configure.in (and hence 'configure')?

This may be THE solution, really.

-----

I've been using  f77 on Solaris 2.5.1 ( = SunOS 5.5.1)  for a while,
and in newer versions of R,
all was fine when I had
---------------------------------------
FPICFLAGS=-Kpic
---------------------------------------

in the RHOME/config.site  file.
		   -----

Martin Maechler <maechler@stat.math.ethz.ch>		 <><
Seminar fuer Statistik, SOL G1
ETH (Federal Inst. Technology)	8092 Zurich	 SWITZERLAND
phone: x-41-1-632-3408		fax: ...-1086
http://www.stat.math.ethz.ch/~maechler/
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Thu Jun 19 17:05:05 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 19 Jun 1997 18:05:05 +0200
Subject: R-alpha: f77 on Solaris
In-Reply-To: Martin Maechler's message of Thu, 19 Jun 1997 09:46:23 +0200
References: <199706190746.JAA07101@sophie.ethz.ch>
Message-ID: <x2k9jqpoi6.fsf@bush.kubism.ku.dk>

Martin Maechler <maechler@stat.math.ethz.ch> writes:

> 
> >>>>> "Thomas" == Thomas Lumley <thomas@biostat.washington.edu> writes:
> 
>     Thomas> The autoconfigure flags for f77 on Solaris 5.5.1 are wrong They
>     Thomas> should be FFLAGS=" -pic" rather than FFLAGS=" -fpic"
> 
> am I right that you suggest patching configure.in (and hence 'configure')?
> 
> This may be THE solution, really.
> 

Um, does it work on ALL f77's on Solaris (f2c/gcc, g77, Sun f77)?

(I'm at a conference in Norway at the moment, so it's awkward for me
to check) 

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Jun 20 12:46:09 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 20 Jun 1997 13:46:09 +0200
Subject: R-alpha: x11()-window resizing -- another problem   pty='s' only works 2nd time
Message-ID: <199706201146.NAA01301@sophie.ethz.ch>

Can you confirm this problem : 

###---------  RESHAPING  x11()  window has more problems: ----

x11()
plot(1:8)# as expected:   <<<<<<<< NO Problem, if you OMIT this plot !!
##-- now RESHAPE  the  x11() - window !
par(pty = 's') # should make SQUARE plotting region
plot(1:8) #-- oops, not yet...
plot(1:8) # now !
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Friedrich.Leisch@ci.tuwien.ac.at  Fri Jun 20 12:51:52 1997
From: Friedrich.Leisch@ci.tuwien.ac.at (Friedrich Leisch)
Date: Fri, 20 Jun 1997 13:51:52 +0200
Subject: R-alpha: x11()-window resizing -- another problem   pty='s' only works 2nd time
In-Reply-To: <199706201146.NAA01301@sophie.ethz.ch>
References: <199706201146.NAA01301@sophie.ethz.ch>
Message-ID: <199706201151.NAA02007@galadriel.ci.tuwien.ac.at>

>>>>> On Fri, 20 Jun 1997 13:46:09 +0200,
>>>>> Martin Maechler wrote:

> Can you confirm this problem :=20
> ###---------  RESHAPING  x11()  window has more problems: ----

> x11()
> plot(1:8)# as expected:   <<<<<<<< NO Problem, if you OMIT this plot !!
> ##-- now RESHAPE  the  x11() - window !
> par(pty =3D 's') # should make SQUARE plotting region
> plot(1:8) #-- oops, not yet...
> plot(1:8) # now !


Yes, same problem here on a Linux machine running 0.49 Beta.

Best,
Fritz

--=20
-------------------------------------------------------------------
                        Friedrich  Leisch                            =20
Institut f=FCr Statistik                      Tel: (+43 1) 58801 4541
Technische Universit=E4t Wien                 Fax: (+43 1)  504 14 98
Wiedner Hauptstra=DFe 8-10/1071      Friedrich.Leisch@ci.tuwien.ac.at
A-1040 Wien, Austria             http://www.ci.tuwien.ac.at/~leisch
     PGP public key http://www.ci.tuwien.ac.at/~leisch/pgp.key
-------------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Fri Jun 20 16:59:16 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Fri, 20 Jun 1997 08:59:16 -0700 (PDT)
Subject: R-alpha: x11()-window resizing -- another problem   pty='s' only works 2nd time
In-Reply-To: <199706201146.NAA01301@sophie.ethz.ch>
Message-ID: <Pine.SUN.3.95.970620085541.2114A-100000@zen>

On Fri, 20 Jun 1997, Martin Maechler wrote:

> Can you confirm this problem : 
> 
Yes. Also interesting to note that it's the second plot statement,
regardless of the order of the commands, ie:

	# reshape
	plot(1:8)
	par(pty="s")
	plot(1:8)
works immediately

Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ben@eno.Princeton.EDU  Mon Jun 23 17:40:55 1997
From: ben@eno.Princeton.EDU (Ben Bolker)
Date: Mon, 23 Jun 1997 12:40:55 -0400 (EDT)
Subject: R-alpha: comparing alpha and numeric
Message-ID: <Pine.SUN.3.95.970623123919.6004A-100000@paca>


Is this behavior correct? (R 0.49 on SunOS 4.1.4)

> "a">1
 TRUE
> "a"<1
 FALSE
> "a"==1
 FALSE
> "a">2
 TRUE
> "a"<2
 FALSE

 (I know, this is like the old joke: "Doctor, it hurts when I do this."
"Well, don't do that!"  But it might be useful to have this caught by an
error or warning message ...)

Benjamin Bolker          Dep't of Ecology and Evolutionary Biology,
ben@eno.princeton.edu    Princeton University
tel: (609) 258-6886,     fax: (609) 258-1334

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Mon Jun 23 17:46:57 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Mon, 23 Jun 1997 09:46:57 -0700 (PDT)
Subject: R-alpha: comparing alpha and numeric
In-Reply-To: <Pine.SUN.3.95.970623123919.6004A-100000@paca>
Message-ID: <Pine.SUN.3.95.970623094548.1180A-100000@zen>

On Mon, 23 Jun 1997, Ben Bolker wrote:

> 
> Is this behavior correct? (R 0.49 on SunOS 4.1.4)
> 
> > "a">1
>  TRUE
> > "a"<1
<etc> 

It gets worse
> "3">4
[1] FALSE
> "3"<4
[1] TRUE
> "3"==4
[1] FALSE
> "3"==3
[1] TRUE
all well and good, and perhaps even useful, but
> "23"<3 
[1] TRUE
Ouch.

Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ben@eno.Princeton.EDU  Mon Jun 23 17:47:50 1997
From: ben@eno.Princeton.EDU (Ben Bolker)
Date: Mon, 23 Jun 1997 12:47:50 -0400 (EDT)
Subject: R-alpha: various graphics Q.
Message-ID: <Pine.SUN.3.95.970623124059.6009A-100000@paca>


  "contour" can't return a list of contours (it would be nice)

  "arrows" has different options from S-PLUS (no "open" or "rel" options,
no "lwd" parameter or graphics parameter pass-through; "size" in S
corresponds to "length" in R).  [I know we needn't follow S-PLUS syntax
slavishly, but it would be nice at least to compile a more-or-less
comprehensive list of differences.]

   The xaxs option "i" (no extra space around xlim, ylim) isn't documented

   axis() first argument is called "side" (not "which" as in S: see
comment above)

In lines 5-8 I correct what I think is a bug -- since "cra" (character
size in rasters)  doesn't change with "cex", the legend line-spacing
doesn't change correctly for cex>1.
   The other changes, which should definitely be considered optional, adds
the capability I've always wanted in legends -- to be able to mix symbols
and lines in the same legend without having to have a symbol or a line for
every item in the legend, and to be able to put symbols and lines in the
same column (option "merge").  The spacing's not quite perfect, though.

3c3
< 	xjust=0, yjust=1, merge=FALSE, ...)
---
> 	xjust=0, yjust=1, ...)
5,8c5,8
< 	xchar <- xinch(par("cin")[1])*par("cex")
< 	ychar <- yinch(par("cin")[2])*1.2*par("cex")
< 	xbox <- xinch(par("cin")[2]*0.8)*par("cex")
< 	ybox <- yinch(par("cin")[2]*0.8)*par("cex")
---
> 	xchar <- xinch(par("cin")[1])
> 	ychar <- yinch(par("cin")[2]) * 1.2
> 	xbox <- xinch(par("cin")[2] * 0.8)
> 	ybox <- yinch(par("cin")[2] * 0.8)
50c50
< 		if (!merge) xt <- xt + xbox + xchar
---
> 		xt <- xt + xbox + xchar
52d51
< 	col _ rep(col,length.out=length(legend))
54,57c53,54
< 	    pch _ rep(pch,length.out=length(legend))
<                 ok _ (is.character(pch) | pch>0)
< 		points((xt + 0.25 * xchar)[ok], yt[ok], pch[ok], col=col[ok])
< 		if (!merge) xt <- xt + 1.5 * xchar
---
> 		points(xt + 0.25 * xchar, yt, pch, col=col)
> 		xt <- xt + 1.5 * xchar
60,66c57,58
< 	    lty _ rep(lty,length.out=length(legend))
<                 ok _ (lty>0)
< 	        if (merge) segments((xt-xchar)[ok], yt[ok], (xt + xchar)[ok],
< 			yt[ok], lty=lty[ok], col=col[ok])
< 		else segments(xt[ok], yt[ok], (xt + 2 * xchar)[ok],
< 			yt[ok], lty=lty[ok], col=col[ok])
< 		if (!merge) xt <- xt + 3 * xchar
---
> 		segments(xt, yt, xt + 2 * xchar, yt, lty=lty, col=col)
> 		xt <- xt + 3 * xchar
68d59
<         if (merge) xt <- xt + 3 * xchar



=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Mon Jun 23 18:05:04 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Mon, 23 Jun 1997 19:05:04 +0200
Subject: R-alpha: comparing alpha and numeric
In-Reply-To: <Pine.SUN.3.95.970623094548.1180A-100000@zen> (message from
 Thomas Lumley on Mon, 23 Jun 1997 09:46:57 -0700 (PDT))
Message-ID: <199706231705.TAA04361@sophie.ethz.ch>

The solution is :
 If one of them is  character(), both are coerced to and then compared..

which 'naturally' gives

> "23"<3   <-->  "23" < "3"   <-->  "AB" < "B"
[1] TRUE
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Mon Jun 23 22:52:00 1997
From: ihaka@stat.auckland.ac.nz (Ross &)
Date: Tue, 24 Jun 1997 09:52:00 +1200 (NZST)
Subject: R-alpha: Silence
Message-ID: <199706232152.JAA28442@stat1.stat.auckland.ac.nz>

I've been "out" (literally and figuratively) with a virus for the past
week or so.  One quick observation though

	"23" < 3

is a STRING comparison because of type coercion.  Thus returning
TRUE is correct.
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Jun 24 08:21:56 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 24 Jun 1997 09:21:56 +0200
Subject: R-alpha: funny behavior of  data(.)
Message-ID: <199706240721.JAA04748@sophie.ethz.ch>

This is wierd....

It looks like the problem appears when  data(..) is immediately followed 
by another statement USING ``;''
		     -----------	
 rm(list=ls())
 data(phones); summary(phones)
	Error: Object "phones" not found
 ls()
	character(0)

Or also

 ls()
	character(0)
 data(pigs); 1:10
			##-- nothing is printed, but here 'pigs' is sourced
 ls()
	[1] "pigs"


--------------
Could it be a parser bug of  `` expr1 ; expr2 '' ??




=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From jlindsey@luc.ac.be  Wed Jun 25 10:20:50 1997
From: jlindsey@luc.ac.be (Jim Lindsey)
Date: Wed, 25 Jun 1997 11:20:50 +0200 (MET DST)
Subject: R-alpha: lbeta, ctrl-C and crashes
Message-ID: <9706250920.AA11845@alpha.luc.ac.be>

1. lbeta and beta do not work properly: lbeta returns its first
argument and beta gives the lbeta result. 
In names.c lines 245-6, the codes for these should be 2 and 3 instead
of 1 and 2

2. crtl-C does not work (except the first time) on Red Hat elf Linux
(which has many many other problems as well) nor on the previous
version of Linux for Amiga. It worked on Slackware aout Linux and now
works on the most recent version of Linux for the Amiga. It also works
correctly on a Sun.

3. I suspect that my core dump problem may arise from repeated calls
to complex R functions with big data vectors from C code as occurs
with nlm interating to find the MLE.  Doing a gc() between uses of nlm
seems to reduce the problem.

Jim
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Wed Jun 25 10:30:03 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 25 Jun 1997 11:30:03 +0200
Subject: R-alpha: lbeta, .. etc
In-Reply-To: <9706250920.AA11845@alpha.luc.ac.be> (message from Jim Lindsey on
 Wed, 25 Jun 1997 11:20:50 +0200 (MET DST))
Message-ID: <199706250930.LAA05653@sophie.ethz.ch>

>>>>> "Jim" == Jim Lindsey <jlindsey@luc.ac.be> writes:

    Jim> 1. lbeta and beta do not work properly: lbeta returns its first
    Jim> argument and beta gives the lbeta result.  In names.c lines 245-6,
    Jim> the codes for these should be 2 and 3 instead of 1 and 2

    Jim> 2. crtl-C does not work (except the first time) on Red Hat elf
    Jim> Linux (which has many many other problems as well) nor on the
    Jim> previous version of Linux for Amiga. It worked on Slackware aout
    Jim> Linux and now works on the most recent version of Linux for the
    Jim> Amiga. It also works correctly on a Sun.

Both of these problems have been reported before, here.
However, Jim hasn't been subscribed, ``back then''.

Ross has found (about 6 weeks ago...) that problem '1.'
is simply a  "cut & paste" typo in  RHOME/main/names.c
(old code has been doubled by accident).

Here is the patch which just deletes about a dozen lines in  names.c

--- /usr/local/R-0.49-RR/src/main/names.c	Fri May 16 15:00:56 1997
+++ names.c	Wed May 14 09:23:14 1997
@@ -240,34 +240,6 @@
 
 #endif
 
-/* Mathematical Functions of Two Variables */
-
-{"lbeta",	do_math2,	1,	1,	2,	PP_FUNCALL,	0},
-{"beta",	do_math2,	2,	1,	2,	PP_FUNCALL,	0},
-{"lchoose",	do_math2,	4,	1,	2,	PP_FUNCALL,	0},
-{"choose",	do_math2,	5,	1,	2,	PP_FUNCALL,	0},
-
-{"dchisq",	do_math2,	6,	1,	2,	PP_FUNCALL,	0},
-{"pchisq",	do_math2,	7,	1,	2,	PP_FUNCALL,	0},
-{"qchisq",	do_math2,	8,	1,	2,	PP_FUNCALL,	0},
-
-{"dexp",	do_math2,	9,	11,	2,	PP_FUNCALL,	0},
-{"pexp",	do_math2,	10,	11,	2,	PP_FUNCALL,	0},
-{"qexp",	do_math2,	11,	11,	2,	PP_FUNCALL,	0},
-
-{"dgeom",	do_math2,	12,	1,	2,	PP_FUNCALL,	0},
-{"pgeom",	do_math2,	13,	1,	2,	PP_FUNCALL,	0},
-{"qgeom",	do_math2,	14,	1,	2,	PP_FUNCALL,	0},
-
-{"dpois",	do_math2,	15,	1,	2,	PP_FUNCALL,	0},
-{"ppois",	do_math2,	16,	1,	2,	PP_FUNCALL,	0},
-{"qpois",	do_math2,	17,	1,	2,	PP_FUNCALL,	0},
-
-{"dt",		do_math2,	18,	1,	2,	PP_FUNCALL,	0},
-{"pt",		do_math2,	19,	1,	2,	PP_FUNCALL,	0},
-{"qt",		do_math2,	20,	1,	2,	PP_FUNCALL,	0},
-
-
 /* Mathematical Functions of Three Variables */
 
 {"dbeta",	do_math3,	1,	1,	3,	PP_FUNCALL,	0},
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From jlindsey@luc.ac.be  Wed Jun 25 10:47:00 1997
From: jlindsey@luc.ac.be (Jim Lindsey)
Date: Wed, 25 Jun 1997 11:47:00 +0200 (MET DST)
Subject: R-alpha: lbeta
Message-ID: <9706250947.AA03921@alpha.luc.ac.be>

Why is the patch for lbeta not included in the two patches distributed
to ordinary human beings? Jim
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From colin@geology.gla.ac.uk  Wed Jun 25 12:20:47 1997
From: colin@geology.gla.ac.uk (Colin Farrow)
Date: Wed, 25 Jun 1997 12:20:47 +0100
Subject: R-alpha: R and Mac
Message-ID: <199706251120.MAA06822@alligin.gla.ac.uk>


A recent question asked


Is there anyone using R in the Mac? Answer yes.


but when will we see Rbeta on 68k or powermacs?


--------------------
                     \
Colin Farrow          \
                       \---------------------------------------
                        \                                       \
Department of Geology,   \ E-mail: colin@geology.gla.ac.uk       \
University of Glasgow,    \                                       \
Glasgow, G12 8QQ. Scotland \ Tel: +44 (0)41 339 8855 x5466         \
                            \ Fax: +44 (0)41 330 4817               \
`````````````````````````````````````````````````````````````````````````
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From jlindsey@luc.ac.be  Wed Jun 25 13:07:04 1997
From: jlindsey@luc.ac.be (Jim Lindsey)
Date: Wed, 25 Jun 1997 14:07:04 +0200 (MET DST)
Subject: R-alpha: R on 68K
Message-ID: <9706251207.AA26544@alpha.luc.ac.be>

R runs perfectly under 68K Linux on Mac, Amiga and Atari. Jim
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Wed Jun 25 16:39:33 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Wed, 25 Jun 1997 08:39:33 -0700 (PDT)
Subject: R-alpha: lbeta, ctrl-C and crashes
In-Reply-To: <9706250920.AA11845@alpha.luc.ac.be>
Message-ID: <Pine.SUN.3.95.970625083652.2283A-100000@zen>

On Wed, 25 Jun 1997, Jim Lindsey wrote:
> 
> 2. crtl-C does not work (except the first time) on Red Hat elf Linux
> (which has many many other problems as well) nor on the previous
> version of Linux for Amiga. It worked on Slackware aout Linux and now
> works on the most recent version of Linux for the Amiga. It also works
> correctly on a Sun.

It seems to work on Debian Linux (elf, 2.0.27) 

Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Wed Jun 25 19:18:45 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 25 Jun 1997 20:18:45 +0200
Subject: R-alpha: several bugs ...
Message-ID: <199706251818.UAA00252@aragorn.ci.tuwien.ac.at>

Perhaps I'd better not send any bug reports in order not to delay the
release of 0.50 ... but nevertheless.

R> x <- rnorm(20)
R> y <- rnorm(20)
R> z <- lm(y ~ x)

R> typeof(z)
[1] "list"

R> unlist(z)
[[1]]
[1] 0.07030757

[[2]]
[1] -0.1790483

[[3]]
NULL

[[4]]
NULL

and many more ending in

[[152]]
NULL

[[153]]
NULL

[[154]]
NULL

Hmm ...

*****************************************************************

Also, it seems that effects.lm, predict.default for lm objects,
update.lm and even formula.lm do not work.

E.g., predict.default does not take care of the one-arg case (and hence
dies when calling as.matrix on NULL), and in the 2-arg case tries to use
object$intercept and object$covmat which do not exist (in the lm case).

Hmm ... this is not meant as a `usual' passive bug report.  Is anybody
working on fixing these problems?  If not, I am willing to have a look,
but I can't promise that I'll get it done within very soon.

R&R, do we have a scheduled release date for the next version?

Best,
-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Thu Jun 26 06:36:34 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Thu, 26 Jun 1997 07:36:34 +0200
Subject: R-alpha: lbeta, ctrl-C and crashes
In-Reply-To: <Pine.SUN.3.95.970625083652.2283A-100000@zen>
References: <9706250920.AA11845@alpha.luc.ac.be>
 <Pine.SUN.3.95.970625083652.2283A-100000@zen>
Message-ID: <199706260536.HAA00517@aragorn.ci.tuwien.ac.at>

>>>>> Thomas Lumley writes:

> On Wed, 25 Jun 1997, Jim Lindsey wrote:
>> 
>> 2. crtl-C does not work (except the first time) on Red Hat elf Linux
>> (which has many many other problems as well) nor on the previous
>> version of Linux for Amiga. It worked on Slackware aout Linux and now
>> works on the most recent version of Linux for the Amiga. It also works
>> correctly on a Sun.

> It seems to work on Debian Linux (elf, 2.0.27)

Are we talking about `while (1) { print("whatever") } RET ... CTRL-C'
and then again and again?  As said, works perfectly under Debian 1.3
with a 2.0.27 kernel.

What are the other problems with Red Hat?

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Thu Jun 26 07:03:29 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Thu, 26 Jun 1997 08:03:29 +0200
Subject: R-alpha: lbeta, .. etc
In-Reply-To: <199706250930.LAA05653@sophie.ethz.ch>
References: <9706250920.AA11845@alpha.luc.ac.be>
 <199706250930.LAA05653@sophie.ethz.ch>
Message-ID: <199706260603.IAA00927@aragorn.ci.tuwien.ac.at>

>>>>> Martin Maechler writes:

>>>>> "Jim" == Jim Lindsey <jlindsey@luc.ac.be> writes:
Jim> 1. lbeta and beta do not work properly: lbeta returns its first
Jim> argument and beta gives the lbeta result.  In names.c lines 245-6,
Jim> the codes for these should be 2 and 3 instead of 1 and 2

Jim> 2. crtl-C does not work (except the first time) on Red Hat elf
Jim> Linux (which has many many other problems as well) nor on the
Jim> previous version of Linux for Amiga. It worked on Slackware aout
Jim> Linux and now works on the most recent version of Linux for the
Jim> Amiga. It also works correctly on a Sun.

> Both of these problems have been reported before, here.
> However, Jim hasn't been subscribed, ``back then''.

> Ross has found (about 6 weeks ago...) that problem '1.'
> is simply a  "cut & paste" typo in  RHOME/main/names.c
> (old code has been doubled by accident).

> Here is the patch which just deletes about a dozen lines in  names.c

> ...

Actually, I must have missed that patch, too.  I'll rebuild my Debian
packages right away ...

Re official versus non-official patches.  What I could do is put all
patches that were posted on r-devel and look reasonable into CRAN (e.g.,
src/patches).  However, R&R will probably not be too happy about the
existence of unofficial patches ...

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From jlindsey@luc.ac.be  Thu Jun 26 08:07:47 1997
From: jlindsey@luc.ac.be (Jim Lindsey)
Date: Thu, 26 Jun 1997 09:07:47 +0200 (MET DST)
Subject: R-alpha: R on 68K
In-Reply-To: <199706260608.IAA00936@aragorn.ci.tuwien.ac.at> from "Kurt Hornik" at Jun 26, 97 08:08:49 am
Message-ID: <9706260707.AA16200@alpha.luc.ac.be>


> 
> >>>>> Jim Lindsey writes:
> 
> > R runs perfectly under 68K Linux on Mac, Amiga and Atari. Jim
> 
> Just checking:  This means you can build from the sources and everything
> is fine, right?
> 
> -k
> 

Yes my son has R running on Amiga since last September and it is the
same basic Linux for the three, so I assume it works for the other two
as well.
  Jim
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Thu Jun 26 09:43:06 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 26 Jun 1997 10:43:06 +0200
Subject: R-alpha: lbeta, ctrl-C and crashes
In-Reply-To: Kurt Hornik's message of Thu, 26 Jun 1997 07:36:34 +0200
References: <9706250920.AA11845@alpha.luc.ac.be>
 <Pine.SUN.3.95.970625083652.2283A-100000@zen>
 <199706260536.HAA00517@aragorn.ci.tuwien.ac.at>
Message-ID: <x23eq5rbz9.fsf@bush.kubism.ku.dk>

Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

> Are we talking about `while (1) { print("whatever") } RET ... CTRL-C'
> and then again and again?  As said, works perfectly under Debian 1.3
> with a 2.0.27 kernel.

2nd time around, that command loops unstoppably here. 

Redhat 4.1/2.0.28
 
$ ldd R/bin/R.binary 
        libSM.so.6 => /usr/X11R6/lib/libSM.so.6.0
        libICE.so.6 => /usr/X11R6/lib/libICE.so.6.0
        libX11.so.6 => /usr/X11R6/lib/libX11.so.6.1
        libf2c.so.0 => /usr/lib/libf2c.so.0.20
        libdl.so.1 => /lib/libdl.so.1.7.14
        libreadline.so.2 => /usr/lib/libreadline.so.2.0
        libtermcap.so.2 => /lib/libtermcap.so.2.0.8
        libm.so.5 => /lib/libm.so.5.0.8
        libc.so.5 => /lib/libc.so.5.4.23

This is strange. What libs are used by Debian? And on Thomas' system?
-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Thu Jun 26 09:51:05 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Thu, 26 Jun 1997 10:51:05 +0200
Subject: R-alpha: lbeta, ctrl-C and crashes
In-Reply-To: <x23eq5rbz9.fsf@bush.kubism.ku.dk>
References: <9706250920.AA11845@alpha.luc.ac.be>
 <Pine.SUN.3.95.970625083652.2283A-100000@zen>
 <199706260536.HAA00517@aragorn.ci.tuwien.ac.at>
 <x23eq5rbz9.fsf@bush.kubism.ku.dk>
Message-ID: <199706260851.KAA01127@aragorn.ci.tuwien.ac.at>

>>>>> Peter Dalgaard BSA writes:

> Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:
>> Are we talking about `while (1) { print("whatever") } RET ... CTRL-C'
>> and then again and again?  As said, works perfectly under Debian 1.3
>> with a 2.0.27 kernel.

> 2nd time around, that command loops unstoppably here. 

> Redhat 4.1/2.0.28
 
> $ ldd R/bin/R.binary 
>         libSM.so.6 => /usr/X11R6/lib/libSM.so.6.0
>         libICE.so.6 => /usr/X11R6/lib/libICE.so.6.0
>         libX11.so.6 => /usr/X11R6/lib/libX11.so.6.1
>         libf2c.so.0 => /usr/lib/libf2c.so.0.20
>         libdl.so.1 => /lib/libdl.so.1.7.14
>         libreadline.so.2 => /usr/lib/libreadline.so.2.0
>         libtermcap.so.2 => /lib/libtermcap.so.2.0.8
>         libm.so.5 => /lib/libm.so.5.0.8
>         libc.so.5 => /lib/libc.so.5.4.23

> This is strange. What libs are used by Debian? And on Thomas' system?

Hmm.  I get

hornik@aragorn:~/Work/misc$ ldd /usr/local/lib/R/bin/R.binary 
        libSM.so.6 => /usr/X11R6/lib/libSM.so.6		(6.0)
        libICE.so.6 => /usr/X11R6/lib/libICE.so.6	(6.0)
        libX11.so.6 => /usr/X11R6/lib/libX11.so.6	(6.1)
        libdl.so.1 => /lib/libdl.so.1			(1.8.10)
        libreadline.so.2 => /lib/libreadline.so.2	(2.1)
        libm.so.5 => /lib/libm.so.5			(5.0.8)
        libc.so.5 => /lib/libc.so.5			(5.4.23)
        libncurses.so.3.0 => /lib/libncurses.so.3.0	(3.0)

(I added the full version numbers manually.)

The obvious difference is that Debian uses ncurses instead of termcap.

I checked  again a few minutes ago, because Fritz was not sure about the
whole thing either ...

Very interesting ...

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From schwarte@feat.mathematik.uni-essen.de  Thu Jun 26 15:34:59 1997
From: schwarte@feat.mathematik.uni-essen.de (Heiner Schwarte)
Date: Thu, 26 Jun 1997 15:34:59 +0100 (NFT)
Subject: R-alpha: Problem with gc()
Message-ID: <Pine.A32.3.93.970626153101.3426A-100000@feat.mathematik.uni-essen.de>


Could someone plese confirm the following ?
(AIX 4.1.4, 0.49+patch1+patch2a)

################################################################

schwarte@cauchy:[/home/schwarte]>/usr/local/R-0.49/bin/R

R : Copyright 1997, Robert Gentleman and Ross Ihaka
Version 0.49 Beta (April 23, 1997)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type "license()" for details.

> logical(10)
 [1] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
> gc()
Garbage collection ...
149210 cons cells free (74%)
1820k bytes of heap free (93%)
> logical(10)
 [1]  TRUE FALSE  TRUE FALSE  TRUE FALSE  TRUE FALSE  TRUE FALSE
> logical(10)
 [1]  TRUE FALSE  TRUE FALSE  TRUE FALSE  TRUE FALSE  TRUE FALSE

#################################################################


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Andreas.Weingessel@ci.tuwien.ac.at  Thu Jun 26 14:51:45 1997
From: Andreas.Weingessel@ci.tuwien.ac.at (Andreas Weingessel)
Date: Thu, 26 Jun 1997 15:51:45 +0200
Subject: R-alpha: Problem with gc()
In-Reply-To: <Pine.A32.3.93.970626153101.3426A-100000@feat.mathematik.uni-essen.de>
References: <Pine.A32.3.93.970626153101.3426A-100000@feat.mathematik.uni-essen.de>
Message-ID: <199706261351.PAA00804@elendil.ci.tuwien.ac.at>

>>>>> On Thu, 26 Jun 1997 15:34:59 +0100 (NFT),
>>>>> Heiner Schwarte wrote:

> Could someone plese confirm the following ?
> (AIX 4.1.4, 0.49+patch1+patch2a)

> ################################################################

> schwarte@cauchy:[/home/schwarte]>/usr/local/R-0.49/bin/R

> R : Copyright 1997, Robert Gentleman and Ross Ihaka
> Version 0.49 Beta (April 23, 1997)

> R is free software and comes with ABSOLUTELY NO WARRANTY.
> You are welcome to redistribute it under certain conditions.
> Type "license()" for details.

>> logical(10)
>  [1] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
>> gc()
> Garbage collection ...
> 149210 cons cells free (74%)
> 1820k bytes of heap free (93%)
>> logical(10)
>  [1]  TRUE FALSE  TRUE FALSE  TRUE FALSE  TRUE FALSE  TRUE FALSE
>> logical(10)
>  [1]  TRUE FALSE  TRUE FALSE  TRUE FALSE  TRUE FALSE  TRUE FALSE

> #################################################################


The same on a PC with Linux/Debian-1.3:


R : Copyright 1997, Robert Gentleman and Ross Ihaka
Version 0.49 Beta (April 23, 1997)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type "license()" for details.

R> logical(10)
 [1] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
R>  gc()
Garbage collection ...
142276 cons cells free (71%)
3945k bytes of heap free (96%)
R>  logical(10)
 [1]  TRUE  TRUE  TRUE FALSE FALSE  TRUE  TRUE FALSE  TRUE FALSE
R>  logical(10)
 [1]  TRUE  TRUE  TRUE FALSE  TRUE FALSE  TRUE FALSE  TRUE FALSE
R> 
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ben@eno.Princeton.EDU  Thu Jun 26 15:08:17 1997
From: ben@eno.Princeton.EDU (Ben Bolker)
Date: Thu, 26 Jun 1997 10:08:17 -0400 (EDT)
Subject: R-alpha: Problem with gc()
In-Reply-To: <199706261351.PAA00804@elendil.ci.tuwien.ac.at>
Message-ID: <Pine.SUN.3.95.970626100705.8890A-100000@paca>


  Same on SunOS 4.1.4.

> logical(10)
 [1] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
> gc()
Garbage collection ...
149941 cons cells free (74%)
1821k bytes of heap free (93%)
> logical(10)
 [1]  TRUE FALSE  TRUE FALSE  TRUE FALSE  TRUE FALSE  TRUE FALSE
> 

  Ben

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Thu Jun 26 17:15:27 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 26 Jun 1997 18:15:27 +0200
Subject: R-alpha: lbeta, ctrl-C and crashes
In-Reply-To: Kurt Hornik's message of Thu, 26 Jun 1997 10:51:05 +0200
References: <9706250920.AA11845@alpha.luc.ac.be>
 <Pine.SUN.3.95.970625083652.2283A-100000@zen>
 <199706260536.HAA00517@aragorn.ci.tuwien.ac.at>
 <x23eq5rbz9.fsf@bush.kubism.ku.dk>
 <199706260851.KAA01127@aragorn.ci.tuwien.ac.at>
Message-ID: <x2radppcgw.fsf@bush.kubism.ku.dk>

Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

> > $ ldd R/bin/R.binary 
> >         libSM.so.6 => /usr/X11R6/lib/libSM.so.6.0
> >         libICE.so.6 => /usr/X11R6/lib/libICE.so.6.0
> >         libX11.so.6 => /usr/X11R6/lib/libX11.so.6.1
> >         libf2c.so.0 => /usr/lib/libf2c.so.0.20
> >         libdl.so.1 => /lib/libdl.so.1.7.14
> >         libreadline.so.2 => /usr/lib/libreadline.so.2.0
> >         libtermcap.so.2 => /lib/libtermcap.so.2.0.8
> >         libm.so.5 => /lib/libm.so.5.0.8
> >         libc.so.5 => /lib/libc.so.5.4.23

> hornik@aragorn:~/Work/misc$ ldd /usr/local/lib/R/bin/R.binary 
>         libSM.so.6 => /usr/X11R6/lib/libSM.so.6		(6.0)
>         libICE.so.6 => /usr/X11R6/lib/libICE.so.6	(6.0)
>         libX11.so.6 => /usr/X11R6/lib/libX11.so.6	(6.1)
>         libdl.so.1 => /lib/libdl.so.1			(1.8.10)
>         libreadline.so.2 => /lib/libreadline.so.2	(2.1)
>         libm.so.5 => /lib/libm.so.5			(5.0.8)
>         libc.so.5 => /lib/libc.so.5			(5.4.23)
>         libncurses.so.3.0 => /lib/libncurses.so.3.0	(3.0)
> 
> (I added the full version numbers manually.)
> 
> The obvious difference is that Debian uses ncurses instead of termcap.
> 

Another obvious difference is libreadline2.*1*. I just tried compiling
without readline (edit src/include/Platform.h ; make clean ; make) and
the problem disappeared. However, RedHat still seems to be shipping
libreadline2.0 There are calls to signal() in libreadline, so it
could well be the culprit.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Thu Jun 26 17:28:31 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Thu, 26 Jun 1997 09:28:31 -0700 (PDT)
Subject: R-alpha: lbeta, ctrl-C and crashes
In-Reply-To: <x23eq5rbz9.fsf@bush.kubism.ku.dk>
Message-ID: <Pine.SUN.3.95.970626092741.2845B-100000@zen>

On 26 Jun 1997, Peter Dalgaard BSA wrote:

> This is strange. What libs are used by Debian? And on Thomas' system?
buffy% ldd /biostat/server2/r/linux/R-0.49/bin/R.binary 
        libSM.so.6 => /usr/X11R6/lib/libSM.so.6
        libICE.so.6 => /usr/X11R6/lib/libICE.so.6
        libX11.so.6 => /usr/X11R6/lib/libX11.so.6
        libdl.so.1 => /lib/libdl.so.1
        libreadline.so.2 => /lib/libreadline.so.2
        libm.so.5 => /lib/libm.so.5
        libc.so.5 => /lib/libc.so.5
        libncurses.so.3.0 => /lib/libncurses.so.3.0
buffy% uname -a
Linux buffy 2.0.27 #1 Fri Jan 10 23:46:22 MET 1997 i686 unknown




Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Thu Jun 26 18:23:02 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 26 Jun 1997 19:23:02 +0200
Subject: R-alpha: lbeta, ctrl-C and crashes
In-Reply-To: Peter Dalgaard BSA's message of 26 Jun 1997 18:15:27 +0200
References: <9706250920.AA11845@alpha.luc.ac.be>
 <Pine.SUN.3.95.970625083652.2283A-100000@zen>
 <199706260536.HAA00517@aragorn.ci.tuwien.ac.at>
 <x23eq5rbz9.fsf@bush.kubism.ku.dk>
 <199706260851.KAA01127@aragorn.ci.tuwien.ac.at>
 <x2radppcgw.fsf@bush.kubism.ku.dk>
Message-ID: <x2oh8tp9c9.fsf@bush.kubism.ku.dk>

Peter Dalgaard BSA <p.dalgaard@kubism.ku.dk> writes:

> Another obvious difference is libreadline2.*1*. I just tried compiling
> without readline (edit src/include/Platform.h ; make clean ; make) and
> the problem disappeared. However, RedHat still seems to be shipping
> libreadline2.0 There are calls to signal() in libreadline, so it
> could well be the culprit.

Affirmative. Problem vanished when relinking with a freshly compiled
libreadline.a v.2.1. But there's nothing in the ChangeLog relating to
signal handling bugs fixed since 2.0, so it might be a question of
simply recompiling the library. This would be preferable since it can
be done with the rpm command. Will check later, time to buy dinner
before the shop closes...

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Thu Jun 26 22:55:08 1997
From: ihaka@stat.auckland.ac.nz (Ross &)
Date: Fri, 27 Jun 1997 09:55:08 +1200 (NZST)
Subject: R-alpha: lbeta, .. etc
In-Reply-To: <199706260603.IAA00927@aragorn.ci.tuwien.ac.at>
References: <9706250920.AA11845@alpha.luc.ac.be>
 <199706250930.LAA05653@sophie.ethz.ch>
 <199706260603.IAA00927@aragorn.ci.tuwien.ac.at>
Message-ID: <199706262155.JAA18490@stat1.stat.auckland.ac.nz>

Kurt Hornik writes:
 > Actually, I must have missed that patch, too.  I'll rebuild my Debian
 > packages right away ...
 > 
 > Re official versus non-official patches.  What I could do is put all
 > patches that were posted on r-devel and look reasonable into CRAN (e.g.,
 > src/patches).  However, R&R will probably not be too happy about the
 > existence of unofficial patches ...

[ With great effort, raises self from death-bed ... ]

I have a heap of stuff "ready to go".  It has been for several weeks,
but various disasters have intervened.  I hope to have a new version
out on monday.  Luke Tierney is visiting for a bit after that and so
there will be other priorities ...


I would like to start a discussion on widening the group of people who
can commit changes to R and create new releases (although maybe new
releases are a one-man job).  At present, the "core group" (those who
can commit changes to the CVS tree) consists of Robert, Martin
Maechler and Myself.  I think it would be feasible to enlarge this
group to perhaps 6 or 7.

At the same time we could open up  the update process so that any
can choose to be on the "bleeding edge".  This is the mechanism which
is used in FreeBSD development, and I think it has proved a good
model.  The necessary software (cvsup) is also pretty readily available.

For those who want stability, there is a twice yearly "stable"
release, and for those who want to suffer, they can have it as
"up-to-date" as they can stand by grabbing the current cvs archive.

Any thoughts?
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Fri Jun 27 07:21:35 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Fri, 27 Jun 1997 08:21:35 +0200
Subject: R-alpha: lbeta, ctrl-C and crashes
In-Reply-To: <x2oh8tp9c9.fsf@bush.kubism.ku.dk>
References: <9706250920.AA11845@alpha.luc.ac.be>
 <Pine.SUN.3.95.970625083652.2283A-100000@zen>
 <199706260536.HAA00517@aragorn.ci.tuwien.ac.at>
 <x23eq5rbz9.fsf@bush.kubism.ku.dk>
 <199706260851.KAA01127@aragorn.ci.tuwien.ac.at>
 <x2radppcgw.fsf@bush.kubism.ku.dk>
 <x2oh8tp9c9.fsf@bush.kubism.ku.dk>
Message-ID: <199706270621.IAA01683@aragorn.ci.tuwien.ac.at>

>>>>> Peter Dalgaard BSA writes:

> Peter Dalgaard BSA <p.dalgaard@kubism.ku.dk> writes:
>> Another obvious difference is libreadline2.*1*. I just tried compiling
>> without readline (edit src/include/Platform.h ; make clean ; make) and
>> the problem disappeared. However, RedHat still seems to be shipping
>> libreadline2.0 There are calls to signal() in libreadline, so it
>> could well be the culprit.

> Affirmative. Problem vanished when relinking with a freshly compiled
> libreadline.a v.2.1. But there's nothing in the ChangeLog relating to
> signal handling bugs fixed since 2.0, so it might be a question of
> simply recompiling the library. This would be preferable since it can
> be done with the rpm command. Will check later, time to buy dinner
> before the shop closes...

I see.  That might also explain our confusion when we noticed that we
cannot reproduce the CTRL-C problem.  We just upgraded to Debian 1.3
which has libreadline 2.1.

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Fri Jun 27 07:33:35 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Fri, 27 Jun 1997 08:33:35 +0200
Subject: R-alpha: lbeta, .. etc
In-Reply-To: <199706262155.JAA18490@stat1.stat.auckland.ac.nz>
References: <9706250920.AA11845@alpha.luc.ac.be>
 <199706250930.LAA05653@sophie.ethz.ch>
 <199706260603.IAA00927@aragorn.ci.tuwien.ac.at>
 <199706262155.JAA18490@stat1.stat.auckland.ac.nz>
Message-ID: <199706270633.IAA01692@aragorn.ci.tuwien.ac.at>

>>>>> Ross & writes:

> Kurt Hornik writes:
>> Actually, I must have missed that patch, too.  I'll rebuild my Debian
>> packages right away ...
>> 
>> Re official versus non-official patches.  What I could do is put all
>> patches that were posted on r-devel and look reasonable into CRAN (e.g.,
>> src/patches).  However, R&R will probably not be too happy about the
>> existence of unofficial patches ...

> [ With great effort, raises self from death-bed ... ]

> I have a heap of stuff "ready to go".  It has been for several weeks,
> but various disasters have intervened.  I hope to have a new version
> out on monday.  

Oh boy, do I wish it was Monday already ...

> Luke Tierney is visiting for a bit after that and so there will be
> other priorities ...

(Or try to get Luke involved in the R development ...)

> I would like to start a discussion on widening the group of people who
> can commit changes to R and create new releases (although maybe new
> releases are a one-man job).  At present, the "core group" (those who
> can commit changes to the CVS tree) consists of Robert, Martin
> Maechler and Myself.  I think it would be feasible to enlarge this
> group to perhaps 6 or 7.

(I also treat all patches sent by R&R and Martin as `official', and
apply them asap.)

> At the same time we could open up the update process so that any can
> choose to be on the "bleeding edge".  This is the mechanism which is
> used in FreeBSD development, and I think it has proved a good model.
> The necessary software (cvsup) is also pretty readily available.

> For those who want stability, there is a twice yearly "stable"
> release, and for those who want to suffer, they can have it as
> "up-to-date" as they can stand by grabbing the current cvs archive.

> Any thoughts?

For e.g. Linux, libc, Octave, ... there are two versions, the ones with
even minors are stable releases changed only for bug fixes, the ones
with odd minors are `unstable' development versions which may change
very often.  So e.g., we could start with

	R-0.6		next stable release
	R-0.7		new development tree

I have no experience with situtations where several people can manage
the source tree.  It is perhaps easier to have one person in charge of
that.  On the other hand, obvious cleanups in the interpreted code or in
the documentation do not really require a central authority ...

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Fri Jun 27 11:32:27 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 27 Jun 1997 12:32:27 +0200
Subject: R-alpha: lbeta, ctrl-C and crashes
In-Reply-To: Peter Dalgaard BSA's message of 26 Jun 1997 19:23:02 +0200
References: <9706250920.AA11845@alpha.luc.ac.be>
 <Pine.SUN.3.95.970625083652.2283A-100000@zen>
 <199706260536.HAA00517@aragorn.ci.tuwien.ac.at>
 <x23eq5rbz9.fsf@bush.kubism.ku.dk>
 <199706260851.KAA01127@aragorn.ci.tuwien.ac.at>
 <x2radppcgw.fsf@bush.kubism.ku.dk> <x2oh8tp9c9.fsf@bush.kubism.ku.dk>
Message-ID: <x2en9oibes.fsf@bush.kubism.ku.dk>

Peter Dalgaard BSA <p.dalgaard@kubism.ku.dk> writes:

> > the problem disappeared. However, RedHat still seems to be shipping
> > libreadline2.0 There are calls to signal() in libreadline, so it
> > could well be the culprit.
> 
> Affirmative. Problem vanished when relinking with a freshly compiled
> libreadline.a v.2.1. But there's nothing in the ChangeLog relating to
> signal handling bugs fixed since 2.0, so it might be a question of
> simply recompiling the library.... 

Not so, I'm afraid. There definitely have been changes to signals.c
and recompile doesn't change a thing. Time to push RedHat to make an
upgraded .rpm, I think. They've got a contributed one in
.../contrib/i386 already, I see. 

Hmm. The silly thing installs as libreadline.so.3.0. I wonder what the
point of that is... Means that you have to recompile R to make it use
the new library, but it does seem to work now.

BTW, do we have place to keep these installation related problems, so
that we won't have to answer them over and over again? We had a
similar item with the f2c library setup earlier and C compiler options
on. A series of README.linux, README.hpux, etc. files might do it
(model xfree).

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Fri Jun 27 11:32:50 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Fri, 27 Jun 1997 12:32:50 +0200
Subject: R-alpha: lbeta, ctrl-C and crashes
In-Reply-To: <x2en9oibes.fsf@bush.kubism.ku.dk>
References: <9706250920.AA11845@alpha.luc.ac.be>
 <Pine.SUN.3.95.970625083652.2283A-100000@zen>
 <199706260536.HAA00517@aragorn.ci.tuwien.ac.at>
 <x23eq5rbz9.fsf@bush.kubism.ku.dk>
 <199706260851.KAA01127@aragorn.ci.tuwien.ac.at>
 <x2radppcgw.fsf@bush.kubism.ku.dk>
 <x2oh8tp9c9.fsf@bush.kubism.ku.dk>
 <x2en9oibes.fsf@bush.kubism.ku.dk>
Message-ID: <199706271032.MAA02229@aragorn.ci.tuwien.ac.at>

>>>>> Peter Dalgaard BSA writes:

> Peter Dalgaard BSA <p.dalgaard@kubism.ku.dk> writes:
>> > the problem disappeared. However, RedHat still seems to be shipping
>> > libreadline2.0 There are calls to signal() in libreadline, so it
>> > could well be the culprit.
>> 
>> Affirmative. Problem vanished when relinking with a freshly compiled
>> libreadline.a v.2.1. But there's nothing in the ChangeLog relating to
>> signal handling bugs fixed since 2.0, so it might be a question of
>> simply recompiling the library.... 

> Not so, I'm afraid. There definitely have been changes to signals.c
> and recompile doesn't change a thing. Time to push RedHat to make an
> upgraded .rpm, I think. They've got a contributed one in
> .../contrib/i386 already, I see. 

> Hmm. The silly thing installs as libreadline.so.3.0. I wonder what the
> point of that is... Means that you have to recompile R to make it use
> the new library, but it does seem to work now.

> BTW, do we have place to keep these installation related problems, so
> that we won't have to answer them over and over again? We had a
> similar item with the f2c library setup earlier and C compiler options
> on. A series of README.linux, README.hpux, etc. files might do it
> (model xfree).

Great idea!

I was already thinking about adding something to the FAQ, but a pointer
to the README.$platform files is better.

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Fri Jun 27 14:20:13 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 27 Jun 1997 15:20:13 +0200
Subject: R-alpha: lbeta, ctrl-C and crashes
In-Reply-To: Peter Dalgaard BSA's message of 27 Jun 1997 12:32:27 +0200
References: <9706250920.AA11845@alpha.luc.ac.be>
 <Pine.SUN.3.95.970625083652.2283A-100000@zen>
 <199706260536.HAA00517@aragorn.ci.tuwien.ac.at>
 <x23eq5rbz9.fsf@bush.kubism.ku.dk>
 <199706260851.KAA01127@aragorn.ci.tuwien.ac.at>
 <x2radppcgw.fsf@bush.kubism.ku.dk> <x2oh8tp9c9.fsf@bush.kubism.ku.dk>
 <x2en9oibes.fsf@bush.kubism.ku.dk>
Message-ID: <x2bu4si3n6.fsf@bush.kubism.ku.dk>

Peter Dalgaard BSA <p.dalgaard@kubism.ku.dk> writes:

> similar item with the f2c library setup earlier and C compiler options
> on. A series of README.linux, README.hpux, etc. files might do it
   / HP-UX

[Ugh. Victim of my "scatter/gather" writing style.]

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Friedrich.Leisch@ci.tuwien.ac.at  Fri Jun 27 15:29:58 1997
From: Friedrich.Leisch@ci.tuwien.ac.at (Friedrich Leisch)
Date: Fri, 27 Jun 1997 16:29:58 +0200
Subject: R-alpha: NA in data frame not detected
Message-ID: <199706271429.QAA05649@galadriel.ci.tuwien.ac.at>


NA's in a data frame are not handled properly, if the data frame was
read in using read.table (but I'm not sure if that is the reason of
the problems):

(I'm using Debian Linux 1.3)

If I read the file

***************
1 2
2 3
3 4
4 5
? 6
6 7
7 8
8 9
***************

into R using read.table I run into troubles:

R : Copyright 1997, Robert Gentleman and Ross Ihaka
Version 0.49 Beta (April 23, 1997)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type "license()" for details.

R> x<-read.table("xxx", na.strings=3D"?")
R> x
  V1 V2
1  1  2
2  2  3
3  3  4
4  4  5
5 NA  6
6  6  7
7  7  8
8  8  9
R> complete.cases(x)
[1] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE
R> x$V1
[1]  1  2  3  4 NA  6  7  8
R> x$V1[5]
[1] NA
R> is.na(x$V1[5])
[1] FALSE


but if I create the same dataframe in R I get the expected results:

R> z<-data.frame(V1=3Dc(1:4, NA, 6:8), y2=3D2:9)
R> z
     V1 y2
[1,]  1  2
[2,]  2  3
[3,]  3  4
[4,]  4  5
[5,] NA  6
[6,]  6  7
[7,]  7  8
[8,]  8  9
R> complete.cases(z)
[1]  TRUE  TRUE  TRUE  TRUE FALSE  TRUE  TRUE  TRUE
R> is.na(z$V1[5])
[1] TRUE




Can anybody confirm this?

--=20
-------------------------------------------------------------------
                        Friedrich  Leisch                            =20
Institut f=FCr Statistik                      Tel: (+43 1) 58801 4541
Technische Universit=E4t Wien                 Fax: (+43 1)  504 14 98
Wiedner Hauptstra=DFe 8-10/1071      Friedrich.Leisch@ci.tuwien.ac.at
A-1040 Wien, Austria             http://www.ci.tuwien.ac.at/~leisch
     PGP public key http://www.ci.tuwien.ac.at/~leisch/pgp.key
-------------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From schwarte@feat.mathematik.uni-essen.de  Fri Jun 27 20:46:40 1997
From: schwarte@feat.mathematik.uni-essen.de (Heiner Schwarte)
Date: Fri, 27 Jun 1997 20:46:40 +0100 (NFT)
Subject: R-alpha: Re: Problem with gc()
In-Reply-To: <Pine.A32.3.93.970626153101.3426A-100000@feat.mathematik.uni-essen.de>
Message-ID: <Pine.A32.3.93.970627203823.15230B-100000@feat.mathematik.uni-essen.de>

Yesterday I posted a problem with logical() after a gc().

This problem occurs because do_makevector() in the file
builtin.c does not properly initialize the memory if a 
vector of logicals is manufactured. Simply adding an 
initialization  loop solves the problem. ( Following 
line 333 one finds  the initialization for INTSXP and 
REALSXP. Add one for LGLSXP.)

Heiner

  

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Fri Jun 27 20:21:29 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Fri, 27 Jun 1997 12:21:29 -0700 (PDT)
Subject: R-alpha: NA in data frame not detected
In-Reply-To: <199706271429.QAA05649@galadriel.ci.tuwien.ac.at>
Message-ID: <Pine.SUN.3.95.970627101809.3355E-100000@zen>

On Fri, 27 Jun 1997, Friedrich Leisch wrote:

> 
> NA's in a data frame are not handled properly, if the data frame was
> read in using read.table (but I'm not sure if that is the reason of
> the problems):
> 

The problem is with the na.strings argument of read.table.  If you use
this argument anything with an NA ends up as a factor. In your example the
first column is a factor (though you can't tell by looking at it)
> is.factor(x[,1])
[1] TRUE
> levels(x[,1])
[1] "1"  "2"  "3"  "4"  "6"  "7"  "8"  "NA"
>

The reason is that read.table tries to handle na.strings twice.  The
scan() function gets the na.strings argument and so translates the "?"
into "NA".  The type.convert() function then also gets the na.strings
argument and thinks that NAs are indicated by "?" which is no longer
true. It then decides that the data are not numeric and returns a factor.

The solution seems to be to stop passing na.strings to type.convert(). We
need to keep na.strings in scan() to allow for missing character data.

A patch is at the end of this message. This may break something else,
of course ;-).

Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

*** read.table.rnew	Fri Jun 27 11:26:15 1997
--- read.table.orig	Fri Jun 27 11:21:20 1997
***************
*** 56,66 ****
          if (length(as.is) != cols) 
                  stop("as.is has the wrong length")
          for (i in 1:cols) {
!                 if (!as.is[i]) {
! 			 data[[i]]<-type.convert(data[[i]])
! #                        data[[i]] <- type.convert(data[[i]], 
! #                                na.strings = na.strings)
! 			}
          }
          #  now we determine row names
          if (missing(row.names)) {
--- 56,64 ----
          if (length(as.is) != cols) 
                  stop("as.is has the wrong length")
          for (i in 1:cols) {
!                 if (!as.is[i]) 
!                         data[[i]] <- type.convert(data[[i]], 
!                                 na.strings = na.strings)
          }
          #  now we determine row names
          if (missing(row.names)) {

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Jun  2 06:19:11 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 2 Jun 1997 07:19:11 +0200
Subject: R-alpha: tapply bug
Message-ID: <199706020519.HAA01997@aragorn.ci.tuwien.ac.at>

There is a problem with tapply() in the case where INDEX is a factor
with at least one of its levels not occurring in it.

In this case,
	namelist[[i]] <- levels(index)
gets all levels but
	group <- group + ngroup * (codes(index) - 1)
only those occurring in index, which subsequently causes
	names(ans) <- namelist[[1]]
to fail.

For example,

R> f <- factor(c("a", "a", "b"), levels = letters[1:3])
R> f
[1] a a b
R> codes(f)
[1] 1 1 2
R> levels(f)
[1] "a" "b" "c"

which gives e.g.

R> tapply(rep(1, length(f)), f, sum)
Error: names attribute must be the same length as the vector

One solution is to replace

	namelist[[i]] <- levels(index)

by

	namelist[[i]] <- unique(levels(index)[index])

but perhaps there is something smarter ...

-k

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Mon Jun  2 08:31:42 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Mon, 2 Jun 97 09:31:42 +0200
Subject: R-alpha: plot(1); axis(1, at=10) >>> Seg.fault  -- and a patch
In-Reply-To: <199706020519.HAA01989@aragorn.ci.tuwien.ac.at> (message from
 Kurt Hornik on Mon, 2 Jun 1997 07:19:10 +0200)
Message-ID: <9706020731.AA00382@>

The patched version of  axis(..) which I "seemed" to post here  a while ago,
accidentally was the 0.49 original -- oh dear ! -- S_O_R_R_Y!

Here is the 'real' one:

M> This problem has been mentioned  by Arne Kovac <maak@stats.bris.ac.uk>
M> on May 9-10. 
M> The patch is really a replacement of 'axis' in  RHOME/src/library/base/funs/

M> It contains the fixes which where proposed Arne Kovac
M> and fixes all the errors he reported on May 9.

"axis" <-
function (which, at, labels = TRUE, ...) 
{
	if (which%%2 == 1) {
		axp <- par("xaxp")
		usr <- par("usr")[1:2]
		log <- par("xlog")
	} else {
		axp <- par("yaxp")
		usr <- par("usr")[3:4]
		log <- par("ylog")
	}
	ind <-
	  if (missing(at)) {
	    at <-
	      if (log) {
		if (usr[2] < usr[1] + 1) {
		  seq(axp[1], axp[2], length = axp[3] + 1)
		} else {
		  p1 <- ceiling(min(usr))
		  p2 <- floor(max(usr))
		  if (p2 - p1 < 2) {
		    at <- c(1, 2, 5) * 10^rep(p1:p2, rep(3, p2 - p1 + 1))
		    at[10^usr[1] <= at & at < 10^usr[2]]
		  }
		  else 10^seq(p1, p2, by = 1)
		}
	      } else seq(axp[1], axp[2], length = axp[3] + 1)
	    rep(TRUE, length(at))
	  } else {
	    at <- sort(at)
	    if (log) (10^usr[1] <= at & at <= 10^usr[2])
	    else     (	 usr[1] <= at & at <=	 usr[2])
	  }
	if(any(ind)) {
	  labels <-
	    if (is.logical(labels)) {
	      if (labels) {
		if (!log) 
		  at[abs(at/(max(at) - min(at))) < 0.001] <- 0
		format(at, trim = T)
	      }
	      else rep("", length(at))
	    } else format(labels, trim = T)
	  .Internal(axis(which, as.double(at[ind]), labels[ind], ...))
	} else warning("axis: Couldn't draw anything; maybe 'at' out of range.")
}

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Jun  2 10:57:16 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 2 Jun 1997 11:57:16 +0200
Subject: R-alpha: S doc -> R doc
Message-ID: <199706020957.LAA08243@aragorn.ci.tuwien.ac.at>

Attached is the current version of my sd2rd perl script.  It has passed
tests by Martin, Fritz and myself, and seems to work reasonably well (it
should get the arguments lists right, distinguish between VALUE and
VALUES, and know about REFERENCES and SEEALSO).

Any comments etc are most welcome.

-k

************************************************************************
#!/usr/bin/perl -w

$\ = "\n";

$parenLevel = 0;
$doprint = 1;
$needArg = 1;
$needVal = 0;
$output = "";

while (<>) {
    chop;
    &substitute;
    @word = split;

    if (/^[^.]/) { &output($_); }

    if (/^\.AG/) {
	if ($needArg) {
	    &section(0, "ARGUMENTS(");
	    $needArg = 0;
	}
	&section(1, "ARG($word[1] @@");
    }
    if (/^\.CS/) { &section(0, "USAGE("); }
    if (/^\.DN/) { $doprint = 0; }
    if (/^\.DT/) { &section(0, "DESCRIPTION("); }
    if (/^\.EX/) { &section(0, "EXAMPLES("); }
    if (/^\.FN/) { $fun = $word[1]; }
    if (/^\.(IP|PP)/) { output("PARA"); }
    if (/^\.RC/) {
	if ($needVal) {
	    $needVal = 0;	    
	    &section(0, "VALUES(\n$output\n@@");
	    $doprint = 1;
	}
	&section(1, "ARG($word[1] @@");
    }
    if (/^\.RT/) {
	$needVal = 1;
	$doprint = 0;
	$output = "";
    }
    if (/^\.SA/) { &section(0, "SEEALSO("); }
    if (/^\.SE/) { &paragraph("SIDE EFFECTS"); }
    if (/^\.SH/) {
	if ($word[1] =~ /REFERENCE/) {
	    &section(0, "REFERENCES(");
	} else {
	    &paragraph($word[1]);
	}
    }
    if (/^\.sp/) { output("BLANK"); }
    if (/^\.TL/) { &section(0, "TITLE($fun @@"); }
    if (/^\.WR/) { &section(0, ""); }

    if (/^\.AO/) {
	output("Arguments for function LANG($word[1]()) can also be");
	output("supplied to this function.");
    }
    if (/^\.GE/) {
	output("This is a generic function.");
	output("Functions with names beginning in LANG($fun.) will be");
	output("methods for this function.");
    }
    if (/^\.GR/) {
	output("Graphical parameters (see LANG(par())) may also be");
	output("supplied as arguments to this function.");
    }
    if (/^\.ME/) {
	output("This function is a method for the generic function");
	output("LANG($word[1]()) for class LANG($word[2]).");
	output("It can be invoked by calling LANG($word[1](x)) for an");
	output("object LANG(x) of the appropriate class, or directly by");
	output("calling LANG($word[1].$word[2](x)) regardless of the");
	output("class of the object.");
    }
    if (/^\.NA/) { output("Missing values (LANG(NA)s) are allowed."); }
    if (/^\.Tl/) {
	output("In addition, the high-level graphics control arguments");
	output("described under LANG(par()) and the arguments to");
	output("LANG(title()) may be supplied to this function.");
    }
}

sub substitute {
    s/\\fB/BOLD\(/g;
    s/\\fR/\)/g;
    s/\.\.\./DOTS/g;
}

sub section {
    local($level, $text) = @_;
    $n = $parenLevel - $level;
    print(")" x $n) if ($n > 0);
    if ($needVal) {
	print("VALUE(\n$output\n)");
	$needVal = 0;
    }
    print("$text") if $text;    
    $parenLevel = $level + 1;
    $doprint = 1;
}

sub paragraph {
    local($name) = @_;
    &output("PARA\nBOLD($name): ");
}
    
sub output {
    local($text) = @_;
    if ($doprint) {
	print($text);
    } elsif ($output) {
	$output .= "\n$text";
    } else {
	$output = $text;
    }
}
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Mon Jun  2 18:44:36 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Mon, 2 Jun 1997 10:44:36 -0700 (PDT)
Subject: R-alpha: S doc -> R doc
In-Reply-To: <199706020957.LAA08243@aragorn.ci.tuwien.ac.at>
Message-ID: <Pine.SUN.3.95.970602104156.955C-100000@zen>

On Mon, 2 Jun 1997, Kurt Hornik wrote:

> Attached is the current version of my sd2rd perl script.  It has passed
> tests by Martin, Fritz and myself, and seems to work reasonably well (it
> should get the arguments lists right, distinguish between VALUE and
> VALUES, and know about REFERENCES and SEEALSO).
> 
> Any comments etc are most welcome.


Very nice.  A more advanced feature (which I completely gave up on) would
be hyperlinking the SEE ALSO section (i.e. 

.SA
foo, bar
 should translate to
SEEALSO(
LANG(LINK(foo)), LANG(LINK(bar))
)



Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Tue Jun  3 07:40:52 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 3 Jun 1997 08:40:52 +0200
Subject: R-alpha: cov.mve
Message-ID: <199706030640.IAA11973@aragorn.ci.tuwien.ac.at>

Is there public domain code for cov.mve?
Thanks,
-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Jun  3 08:18:19 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 3 Jun 97 09:18:19 +0200
Subject: R-alpha:  cov.mve  &  lmsreg -- "minvol" and "progress" @ statlib
In-Reply-To: <199706030640.IAA11973@aragorn.ci.tuwien.ac.at> (message from
 Kurt Hornik on Tue, 3 Jun 1997 08:40:52 +0200)
Message-ID: <9706030718.AA00848@>

[CC to some relevant 'robustniks' and the author of the software;
   read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html  to learn more about R]

>>>>> "Kurt" == Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

    Kurt> Is there public domain code for cov.mve?  

"Yes", the biggest part of it,  aka "minvol"  is made freely available by
by its author, Peter Rousseeuw. It's in Statlib   general/minvol

The same is true for  'lmsreg'  which I am even more eager to see in R;
the basic program is called  "progress".

Note: There is an (fairly unknown)  Statlib mirror in Europe

	  ftp://unix.hensa.ac.uk/mirrors/statlib/

The 2 robust statistics contributions of  Rousseeuw  are thus

	  ftp://unix.hensa.ac.uk/mirrors/statlib/general/minvol
	  ftp://unix.hensa.ac.uk/mirrors/statlib/general/progress

Martin Maechler <maechler@stat.math.ethz.ch>		 <><
Seminar fuer Statistik, SOL G1
ETH (Federal Inst. Technology)	8092 Zurich	 SWITZERLAND
phone: x-41-1-632-3408		fax: ...-1086
http://www.stat.math.ethz.ch/~maechler/
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From rousse@uia.ua.ac.be  Tue Jun  3 08:34:46 1997
From: rousse@uia.ua.ac.be (Peter.Rousseeuw)
Date: Tue, 3 Jun 1997 09:34:46 +0200
Subject: R-alpha:  cov.mve  &  lmsreg -- "minvol" and "progress" @ statlib
Message-ID: <9706030734.AA22999@hwins.uia.ac.be>

Dear colleagues,

actually, more recent versions of PROGRESS and MINVOL than those in
Statlib can be fetched from our website

         http://win-www.uia.ac.be/u/statis

With friendly greetings,

Peter
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Tue Jun  3 13:54:00 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 3 Jun 1997 14:54:00 +0200
Subject: R-alpha: rd2sd v0.1
Message-ID: <199706031254.OAA13309@aragorn.ci.tuwien.ac.at>

Here is an updated version of the S doc -> R doc script.  New features
are automatic conversion of `xxx' to LANG(xxx) or LANG(LINK(xxx)) in
SEEALSO sections, respectively (thanks to Martin and Thomas for the
suggestions).

The keywords are saved as comments, and can easily be used as soon as
keywords are supported.

As usual, any feedback ...

-k

**********************************************************************
#!/usr/bin/perl -w

$VERSION = "0.1";

$\ = "\n";

$parenLevel = 0;
$doprint = 1;
$needArg = 1;
$needVal = 0;
$seealso = 0;
$output = "";

while (<>) {
    chop;
    &substitute;
    @word = split;

    if (/^[^.]/) { &output($_); }

    if (/^\.AG/) {
	if ($needArg) {
	    &section(0, "ARGUMENTS(");
	    $needArg = 0;
	}
	&section(1, "ARG($word[1] @@");
    }
    if (/^\.CS/) { &section(0, "USAGE("); }
    if (/^\.DN/) { $doprint = 0; }
    if (/^\.DT/) { &section(0, "DESCRIPTION("); }
    if (/^\.EX/) { &section(0, "EXAMPLES("); }
    if (/^\.FN/) { $fun = $word[1]; }
    if (/^\.(IP|PP)/) { &output("PARA"); }
    if (/^\.KW/) { 
	if ($parenLevel > 0) {
	    &section(0, "");
	    $parenLevel = 0;
	}
	&output("COMMENT(KEYWORD($word[1]))");
    }
    if (/^\.RC/) {
	if ($needVal) {
	    $needVal = 0;	    
	    &section(0, "VALUES(\n$output\n@@");
	    $doprint = 1;
	}
	&section(1, "ARG($word[1] @@");
    }
    if (/^\.RT/) {
	$needVal = 1;
	$doprint = 0;
	$output = "";
    }
    if (/^\.SA/) {
	&section(0, "SEEALSO(");
	$seealso = 1;
    }
    if (/^\.SE/) { &paragraph("SIDE EFFECTS"); }
    if (/^\.SH/) {
	if ($word[1] =~ /REFERENCE/) {
	    &section(0, "REFERENCES(");
	} else {
	    &paragraph($word[1]);
	}
    }
    if (/^\.sp/) { output("BLANK"); }
    if (/^\.TL/) { &section(0, "TITLE($fun @@"); }
    if (/^\.WR/) {
	&section(0, "");
	print("COMMENT(Converted by sd2rd version $VERSION.)");
    }

    if (/^\.AO/) {
	output("Arguments for function LANG($word[1]()) can also be");
	output("supplied to this function.");
    }
    if (/^\.GE/) {
	output("This is a generic function.");
	output("Functions with names beginning in LANG($fun.) will be");
	output("methods for this function.");
    }
    if (/^\.GR/) {
	output("Graphical parameters (see LANG(LINK(par)) may also be");
	output("supplied as arguments to this function.");
    }
    if (/^\.ME/) {
	output("This function is a method for the generic function");
	output("LANG($word[1]()) for class LANG($word[2]).");
	output("It can be invoked by calling LANG($word[1](x)) for an");
	output("object LANG(x) of the appropriate class, or directly by");
	output("calling LANG($word[1].$word[2](x)) regardless of the");
	output("class of the object.");
    }
    if (/^\.NA/) { output("Missing values (LANG(NA)s) are allowed."); }
    if (/^\.Tl/) {
	output("In addition, the high-level graphics control arguments");
	output("described under LANG(LINK(par)) and the arguments to");
	output("LANG(LINK(title)) may be supplied to this function.");
    }
}

sub substitute {
    s/\\fB/BOLD\(/g;
    s/\\fR/\)/g;
    s/\.\.\./DOTS/g;
    if ($seealso) {
	s/\`([^\']*)\'/LANG(LINK($1))/g;
    } else {
	s/\`([^\']*)\'/LANG($1)/g;
    }
}

sub section {
    local($level, $text) = @_;
    $n = $parenLevel - $level;
    print(")" x $n) if ($n > 0);
    if ($needVal) {
	print("VALUE(\n$output\n)");
	$needVal = 0;
    }
    print("$text") if $text;    
    $parenLevel = $level + 1;
    $doprint = 1;
    $seealso = 0;
}

sub paragraph {
    local($name) = @_;
    &output("PARA\nBOLD($name): ");
}
    
sub output {
    local($text) = @_;
    if ($doprint) {
	print($text);
    } elsif ($output) {
	$output .= "\n$text";
    } else {
	$output = $text;
    }
}
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Tue Jun  3 15:45:11 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 3 Jun 1997 16:45:11 +0200
Subject: R-alpha: unif_rand() again
Message-ID: <199706031445.QAA13652@aragorn.ci.tuwien.ac.at>

Just out of curiosity, here is a question that might be embarrasingly
stupid.  Hmm ...

What I need is to call runif() (more precisely, `runif(1, 0, 1)') from
inside a C function.  Is this possible using call_S?  If so, how?

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Tue Jun  3 16:14:09 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 03 Jun 1997 17:14:09 +0200
Subject: R-alpha: unif_rand() again
In-Reply-To: Kurt Hornik's message of Tue, 3 Jun 1997 16:45:11 +0200
References: <199706031445.QAA13652@aragorn.ci.tuwien.ac.at>
Message-ID: <x2yb8r4t31.fsf@bush.kubism.ku.dk>

Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

> 
> Just out of curiosity, here is a question that might be embarrasingly
> stupid.  Hmm ...
> 
> What I need is to call runif() (more precisely, `runif(1, 0, 1)') from
> inside a C function.  Is this possible using call_S?  If so, how?

Hmm ... Stupid counter-question: Did you study the zfun() function in
$RHOME/demos/dynload/zero.c ? Looks pretty straightforward to me,
except that I have no offhand guess what the 0L argument to call_S is
good for. Peeking at the source should cure that.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Tue Jun  3 16:17:29 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 3 Jun 1997 17:17:29 +0200
Subject: R-alpha: unif_rand() again
In-Reply-To: <x2yb8r4t31.fsf@bush.kubism.ku.dk>
References: <199706031445.QAA13652@aragorn.ci.tuwien.ac.at>
 <x2yb8r4t31.fsf@bush.kubism.ku.dk>
Message-ID: <199706031517.RAA13734@aragorn.ci.tuwien.ac.at>

>>>>> Peter Dalgaard BSA writes:

> Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:
>> 
>> Just out of curiosity, here is a question that might be embarrasingly
>> stupid.  Hmm ...
>> 
>> What I need is to call runif() (more precisely, `runif(1, 0, 1)') from
>> inside a C function.  Is this possible using call_S?  If so, how?

> Hmm ... Stupid counter-question: Did you study the zfun() function in
> $RHOME/demos/dynload/zero.c ? Looks pretty straightforward to me,
> except that I have no offhand guess what the 0L argument to call_S is
> good for. Peeking at the source should cure that.

I did.  I hoped that something like

static char *func = "runif";

double unif_rand() {
  void *in[3];
  char *modes[] = { "integer", "integer", "integer" };
  long lengths[] = { 1, 1, 1 };  
  void *out[1];
  double *result;

  in[0] = (void *)1L;
  in[1] = (void *)0L;
  in[2] = (void *)1L;  
  call_S((void *)func, 3L, in, modes, lengths, 0L, 1L, out);
  result = (double *)out[0];
  return(result[0]);
}

might work, but it does not ...

-k


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Andreas.Weingessel@ci.tuwien.ac.at  Tue Jun  3 16:24:11 1997
From: Andreas.Weingessel@ci.tuwien.ac.at (Andreas Weingessel)
Date: Tue, 3 Jun 1997 17:24:11 +0200
Subject: R-alpha: bug in sum
Message-ID: <199706031524.RAA22384@elendil.ci.tuwien.ac.at>


If the sum of a vector containing NAs is computed and na.rm is FALSE,
the result is not always NA. 

R> w <- c(1:3,NA)
R> sum(w)
[1] NA

BUT

R> w <- c(NA, 1:3)
R> sum(w)
[1] 0

It seems that this problem only occurs, if the first element is NA.

Andreas

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From luke@stat.umn.edu  Tue Jun  3 16:28:37 1997
From: luke@stat.umn.edu (Luke Tierney)
Date: Tue, 3 Jun 1997 10:28:37 -0500 (CDT)
Subject: R-alpha: unif_rand() again
In-Reply-To: <x2yb8r4t31.fsf@bush.kubism.ku.dk> from "Peter Dalgaard BSA" at Jun 3, 97 05:14:09 pm
Message-ID: <9706031528.AA15627@nokomis.stat.umn.edu>

Peter Dalgaard BSA wrote:
> 
> Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:
> 
> > 
> > Just out of curiosity, here is a question that might be embarrasingly
> > stupid.  Hmm ...
> > 
> > What I need is to call runif() (more precisely, `runif(1, 0, 1)') from
> > inside a C function.  Is this possible using call_S?  If so, how?
> 
> Hmm ... Stupid counter-question: Did you study the zfun() function in
> $RHOME/demos/dynload/zero.c ? Looks pretty straightforward to me,
> except that I have no offhand guess what the 0L argument to call_S is
> good for. Peeking at the source should cure that.
> 
> -- 
>    O__  ---- Peter Dalgaard             Blegdamsvej 3  
>   c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
>  (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
> ~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
> =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
> r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
> Send "info", "help", or "[un]subscribe"
> (in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
> =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
> 


This may not be an issue here but it is something to keep in mind for
call_S in S and R:

You need to be careful about making lots of call_S's that return large
amounts of data within a single call to .C. The reason is that the
call_S mechanism provides no way to mark the returned result as no
longer needed, so it cannot be reclaimed. Allocations made in the
process of executing the function called with call_S should be freed
just fine, but the result can't be. So if you produce lots of results,
you will consume lots of memory. For most uses of call_S this isn't an
issue, but if you were doing the loop of a long simulation is C and
it could become an issue.

-- 
Luke Tierney
University of Minnesota                      Phone:           612-625-7843
School of Statistics                         Fax:             612-624-8868
206 Church Street                            email:      luke@stat.umn.edu
Minneapolis, MN 55455 USA                    WWW:  http://www.stat.umn.edu
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Tue Jun  3 17:23:24 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 03 Jun 1997 18:23:24 +0200
Subject: R-alpha: unif_rand() again
In-Reply-To: Kurt Hornik's message of Tue, 3 Jun 1997 17:17:29 +0200
References: <199706031445.QAA13652@aragorn.ci.tuwien.ac.at>
 <x2yb8r4t31.fsf@bush.kubism.ku.dk>
 <199706031517.RAA13734@aragorn.ci.tuwien.ac.at>
Message-ID: <x2u3jf4pvm.fsf@bush.kubism.ku.dk>

Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

> >> What I need is to call runif() (more precisely, `runif(1, 0, 1)') from
> >> inside a C function.  Is this possible using call_S?  If so, how?
> 
> > Hmm ... Stupid counter-question: Did you study the zfun() function in
> > $RHOME/demos/dynload/zero.c ? Looks pretty straightforward to me,
> > except that I have no offhand guess what the 0L argument to call_S is
> > good for. Peeking at the source should cure that.
> 
> I did.  I hoped that something like
> 
> static char *func = "runif";
> 
> double unif_rand() {
...
>   return(result[0]);
> }
> 
> might work, but it does not ...

Aha. I see, call_R seems to want an SEXP parameter, not a character
pointer. So some way of converting "runif" into the relevant SEXPREC seems
to be needed. Something like mkChar() <um, no, that doesn't seem to be
the way to make a "SEXPsymbol"..> followed by findFun(). Or just pass
it as a parameter to .C

This looks like a bug in the S compatibility, doesn't it? Nothing in
the Splus examples indicate that the first argument should be a
string, but I seem to recall seeing something to that effect in the
blue book (?) 

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From luke@stat.umn.edu  Tue Jun  3 17:39:49 1997
From: luke@stat.umn.edu (Luke Tierney)
Date: Tue, 3 Jun 1997 11:39:49 -0500 (CDT)
Subject: R-alpha: unif_rand() again
In-Reply-To: <x2u3jf4pvm.fsf@bush.kubism.ku.dk> from "Peter Dalgaard BSA" at Jun 3, 97 06:23:24 pm
Message-ID: <9706031639.AA15847@nokomis.stat.umn.edu>

Peter Dalgaard BSA wrote:
> 
> Aha. I see, call_R seems to want an SEXP parameter, not a character
> pointer. So some way of converting "runif" into the relevant SEXPREC seems
> to be needed. Something like mkChar() <um, no, that doesn't seem to be
> the way to make a "SEXPsymbol"..> followed by findFun(). Or just pass
> it as a parameter to .C
> 
> This looks like a bug in the S compatibility, doesn't it? Nothing in
> the Splus examples indicate that the first argument should be a
> string, but I seem to recall seeing something to that effect in the
> blue book (?) 
> 

In the blue book the call looks like

	.C("zero_find", list(f), ...)

and is used as

	zero_find(void **ff, ...) {
	  func = ff[0];
	  ...
	  call_S(func, ...
	  ...
	}

In the R example the call looks like

	.C("zero_find", f, ...)

and is used as

	zero_find(void *f, ...) {
	  func = f;
	  ...
	  call_S(func, ...
	  ...
	}

In the blue book there is the extra wrapping in alist which gets
undone with a dereference in C -- I don't know if this is really
needed to or not.

-- 
Luke Tierney
University of Minnesota                      Phone:           612-625-7843
School of Statistics                         Fax:             612-624-8868
206 Church Street                            email:      luke@stat.umn.edu
Minneapolis, MN 55455 USA                    WWW:  http://www.stat.umn.edu
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Tue Jun  3 18:21:57 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 03 Jun 1997 19:21:57 +0200
Subject: R-alpha: unif_rand() again
In-Reply-To: Kurt Hornik's message of Tue, 3 Jun 1997 17:17:29 +0200
References: <199706031445.QAA13652@aragorn.ci.tuwien.ac.at>
 <x2yb8r4t31.fsf@bush.kubism.ku.dk>
 <199706031517.RAA13734@aragorn.ci.tuwien.ac.at>
Message-ID: <x2pvu34n62.fsf@bush.kubism.ku.dk>

Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

> I did.  I hoped that something like
> 
> static char *func = "runif";
> 
> double unif_rand() {
...
> 
> might work, but it does not ...

Here's a model that does (seem to) work:

> dyn.load("runif.so");.C("select_rand",runif); .C("unif_rand",3.3)
[[1]]
function (n, min = 0, max = 1) 
.Internal(runif(n, min, max))

[[1]]
[1] 0.126975

> .C("unif_rand",3.3) # the 3.3 is just an arbitrary double...
[[1]]
[1] 0.9233792

> .C("unif_rand",3.3)
[[1]]
[1] 0.03410953

> 

with

runif.c:

-------------------------

static void * func;

double select_rand(void * f)
{
        func = f;
}

static long one = 1L, zero = 0L;
unif_rand(double *x) {
  void *in[3];
  char *modes[] = { "integer", "integer", "integer" };
  long lengths[] = { 1, 1, 1 };  
  double result;
  double *values[1];

  in[0] = (void *)&one;
  in[1] = (void *)&zero;
  in[2] = (void *)&one;  
  call_S((void *)func, 3L, in, modes, lengths, 0L, 1L, values);
  x[0] = values[0][0];
}

--------------------------


-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From luke@stat.umn.edu  Tue Jun  3 19:15:43 1997
From: luke@stat.umn.edu (Luke Tierney)
Date: Tue, 3 Jun 1997 13:15:43 -0500 (CDT)
Subject: R-alpha: unif_rand() again
In-Reply-To: <x2pvu34n62.fsf@bush.kubism.ku.dk> from "Peter Dalgaard BSA" at Jun 3, 97 07:21:57 pm
Message-ID: <9706031815.AA15866@nokomis.stat.umn.edu>

Peter Dalgaard BSA wrote:

> Here's a model that does (seem to) work:
> 
> > dyn.load("runif.so");.C("select_rand",runif); .C("unif_rand",3.3)
> [[1]]
...
> with
> 
> double select_rand(void * f)
> {
>         func = f;
> }
> 

I'm not sure I see the point of the separate select_rand -- you can
just pass runif as an argument to unif_rand. The original example
needed to use the global variable because a C routine for finding a
zero of a C function was being used and the C function whose root was
to be found needed to get at the S/R function that it was fronting
for. The global variable is needed to pass this info (since you don't
have C closures). Here there isn't any need that I can see, but maybe
I've missed something (wouldn't be the first time :-)).

-- 
Luke Tierney
University of Minnesota                      Phone:           612-625-7843
School of Statistics                         Fax:             612-624-8868
206 Church Street                            email:      luke@stat.umn.edu
Minneapolis, MN 55455 USA                    WWW:  http://www.stat.umn.edu
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Tue Jun  3 23:29:16 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 04 Jun 1997 00:29:16 +0200
Subject: R-alpha: unif_rand() again
In-Reply-To: Luke Tierney's message of Tue, 3 Jun 1997 13:15:43 -0500 (CDT)
References: <9706031815.AA15866@nokomis.stat.umn.edu>
Message-ID: <x2soyzqq0z.fsf@bush.kubism.ku.dk>

Luke Tierney <luke@stat.umn.edu> writes:

> 
> Peter Dalgaard BSA wrote:
> 
> > Here's a model that does (seem to) work:
> > 
> > > dyn.load("runif.so");.C("select_rand",runif); .C("unif_rand",3.3)
> > [[1]]
> ...
> > with
> > 
> > double select_rand(void * f)
> > {
> >         func = f;
> > }
> > 
> 
> I'm not sure I see the point of the separate select_rand -- you can
> just pass runif as an argument to unif_rand.

Now what *did* I mean by that?.... Oh, yes. The original point
involved calling R from a C function. I'm .C-ing it in that bit of
code just for testing it. In practice, it might well get called from
another C function doing a simulation. So, since it appears to be
tricky to do the string-to-functionSEXP conversion in C, it might be
easier to explicitly initialize them from R with the "select_rand"
mechanism. Of course, one might also pass the R function directly to
the simulation routine, and have that one set things up.

Come to think of it, I'm not sure that we *want* the S semantics for
this. Consider

f<-function(a) a^2
Phi<-function(z)
{
	f<-function(z) exp(-z^2/2)/sqrt(2*pi)
	.C("integrate", f, -infty, zero)
}
where integrate() needs to call_S. It must be ensured that it passes
the inner 'f'. 

Hmm. That's not really an argument for having a call_S("f",...) rather
than call_S(f,...). It is no different from the work involved in any
other name lookup (including constructions like "x %myop% y" or
"'hello, world!'(5)"); it's just that it seems a bit silly to search
for a function by name when you already know full well what the
address of the function is. Inefficient, but hardly impossible.

Maybe one could set it up so that call_S did the string thing and
call_R the direct function pointer?

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Jun  9 07:02:18 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 9 Jun 1997 08:02:18 +0200
Subject: R-alpha: unif_rand() again
In-Reply-To: <x2u3jf4pvm.fsf@bush.kubism.ku.dk>
References: <199706031445.QAA13652@aragorn.ci.tuwien.ac.at>
 <x2yb8r4t31.fsf@bush.kubism.ku.dk>
 <199706031517.RAA13734@aragorn.ci.tuwien.ac.at>
 <x2u3jf4pvm.fsf@bush.kubism.ku.dk>
Message-ID: <199706090602.IAA32599@aragorn.ci.tuwien.ac.at>

>>>>> Peter Dalgaard BSA writes:

> Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:
>> >> What I need is to call runif() (more precisely, `runif(1, 0, 1)') from
>> >> inside a C function.  Is this possible using call_S?  If so, how?
>> 
>> > Hmm ... Stupid counter-question: Did you study the zfun() function in
>> > $RHOME/demos/dynload/zero.c ? Looks pretty straightforward to me,
>> > except that I have no offhand guess what the 0L argument to call_S is
>> > good for. Peeking at the source should cure that.
>> 
>> I did.  I hoped that something like
>> 
>> static char *func = "runif";
>> 
>> double unif_rand() {
> ...
>> return(result[0]);
>> }
>> 
>> might work, but it does not ...

> Aha. I see, call_R seems to want an SEXP parameter, not a character
> pointer. So some way of converting "runif" into the relevant SEXPREC
> seems to be needed. Something like mkChar() <um, no, that doesn't seem
> to be the way to make a "SEXPsymbol"..> followed by findFun(). Or just
> pass it as a parameter to .C

I see.

Thanks to all who helped.  I now have a working example of unif_rand(),
but I still hope for Ross to come up with something cleaner ...

Trying to map a function name to the function in call_R would be very
nice, in any case.

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Jun  9 14:21:51 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 9 Jun 1997 15:21:51 +0200
Subject: R-alpha: sd2rd v0.1-1
Message-ID: <199706091321.PAA01472@aragorn.ci.tuwien.ac.at>

Attached is another update.

New features/bugs:
*) now also attempts to get non-quoted object names within SEEALSO
sections to have a LANG(LINK(...)) around them
*) parentheses are now ALWAYS quoted, to prevent the rdoc2... scripts
from choking on unbalanced ones (e.g., "x in the range (0, 1]")
*) blank lines are mapped into PARA so that e.g. reference sections come
out better
*) comments are mapped into comments :-)

Please have a try.

-k

************************************************************************
#!/usr/bin/perl -w

$VERSION = "0.1-1";

$\ = "\n";

$parenLevel = 0;
$inSeeAlso = 0;
$doprint = 1;
$needArg = 1;
$needVal = 0;
$output = "";

while (<>) {
    chop;
    &substitute unless /^\./;
    @word = split;

    if (/^\s*$/) { &output("PARA"); }
    if (/^[^.]/) { &output($_); }

    if (/^\.AG/) {
	if ($needArg) {
	    &section(0, "ARGUMENTS(");
	    $needArg = 0;
	}
	&section(1, "ARG($word[1] @@");
    }
    if (/^\.CS/) { &section(0, "USAGE("); }
    if (/^\.DN/) { $doprint = 0; }
    if (/^\.DT/) { &section(0, "DESCRIPTION("); }
    if (/^\.EX/) { &section(0, "EXAMPLES("); }
    if (/^\.FN/) { $fun = $word[1]; }
    if (/^\.(IP|PP)/) { &output("PARA"); }
    if (/^\.KW/) { 
	if ($parenLevel > 0) {
	    &section(0, "");
	    $parenLevel = 0;
	}
	&output("COMMENT(KEYWORD($word[1]))");
    }
    if (/^\.RC/) {
	if ($needVal) {
	    $needVal = 0;	    
	    &section(0, "VALUES(\n$output\n@@");
	    $doprint = 1;
	}
	&section(1, "ARG($word[1] @@");
    }
    if (/^\.RT/) {
	$needVal = 1;
	$doprint = 0;
	$output = "";
    }
    if (/^\.SA/) {
	&section(0, "SEEALSO(");
	$inSeeAlso = 1;
    }
    if (/^\.SE/) { &paragraph("SIDE EFFECTS"); }
    if (/^\.SH/) {
	if ($word[1] =~ /REFERENCE/) {
	    &section(0, "REFERENCES(");
	} else {
	    &paragraph($word[1]);
	}
    }
    if (/^\.sp/) { output("BLANK"); }
    if (/^\.TL/) { &section(0, "TITLE($fun @@"); }
    if (/^\.WR/) {
	&section(0, "");
	print("COMMENT(Converted by sd2rd version $VERSION.)");
    }

    if (/^\.AO/) {
	output("Arguments for function LANG($word[1]()) can also be");
	output("supplied to this function.");
    }
    if (/^\.GE/) {
	output("This is a generic function.");
	output("Functions with names beginning in LANG($fun.) will be");
	output("methods for this function.");
    }
    if (/^\.GR/) {
	output("Graphical parameters (see LANG(LINK(par)) may also be");
	output("supplied as arguments to this function.");
    }
    if (/^\.ME/) {
	output("This function is a method for the generic function");
	output("LANG($word[1]()) for class LANG($word[2]).");
	output("It can be invoked by calling LANG($word[1](x)) for an");
	output("object LANG(x) of the appropriate class, or directly by");
	output("calling LANG($word[1].$word[2](x)) regardless of the");
	output("class of the object.");
    }
    if (/^\.NA/) { output("Missing values (LANG(NA)s) are allowed."); }
    if (/^\.Tl/) {
	output("In addition, the high-level graphics control arguments");
	output("described under LANG(LINK(par)) and the arguments to");
	output("LANG(LINK(title)) may be supplied to this function.");
    }
}



sub substitute {
    s/\(/\\\(/g;
    s/\)/\\\)/g;
    s/\.\.\./DOTS/g;    
    s/\\fB/BOLD\(/g;
    s/\\fR/\)/g;
    s/\\\.(.*)$/COMMENT($1)/g;
    if ($inSeeAlso) {
	s/\`?([\.\w]*\w+)\'?/LANG(LINK($1))/g;
    } else {
	s/\`([^\']*)\'/LANG($1)/g;
    }
}

sub section {
    local($level, $text) = @_;
    $n = $parenLevel - $level;
    print(")" x $n) if ($n > 0);
    if ($needVal) {
	print("VALUE(\n$output\n)");
	$needVal = 0;
    }
    print("$text") if $text;    
    $parenLevel = $level + 1;
    $doprint = 1;
    $inSeeAlso = 0;
}

sub paragraph {
    local($name) = @_;
    &output("PARA\nBOLD($name): ");
}
    
sub output {
    local($text) = @_;
    if ($doprint) {
	print($text);
    } elsif ($output) {
	$output .= "\n$text";
    } else {
	$output = $text;
    }
}
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Jun  9 18:40:29 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 9 Jun 1997 19:40:29 +0200
Subject: R-alpha: Re: R-beta: mlbench-0.1 --- machine learning benchmark problems
In-Reply-To: <199706091621.SAA16397@galadriel.ci.tuwien.ac.at>
References: <199706091621.SAA16397@galadriel.ci.tuwien.ac.at>
Message-ID: <199706091740.TAA03191@aragorn.ci.tuwien.ac.at>

>>>>> Friedrich Leisch writes:

> I've made a package from some benchmark datasets for use with R and
> uploaded it to CRAN.=20

> Here's the Index entry:

> mlbench-0.1.tar.gz:
> 	A collection of artificial and real-world machine learning
> 	benchmark problems, including, e.g., the boston housing
> 	data from the UCI repository.

> 	Written/packaged by Fritz Leisch <Friedrich.Leisch@ci.tuwien.ac.at>
> 	Original data sets from various sources.
> 	[1997/06/09]


> This (naturally) includes some data files ... hence you have to do
> some parts of the installation manually, see the INSTALL file for
> details (IMHO R has no clear concept for data: one flat directory is
> certainly not sufficient).

Just for the sake of completeness (for those who don't use our Debian
GNU/Linux packages).  We have ``meanwhile'' (before we agree on an
official R file standard) simply introduced a one-level hierarchy in
RHOME/data.  The data files that come with the base distribution are in
RHOME/data/base, the new ones in RHOME/data/mlbench etc.

This change requires nothing but changing RHOME/cmd/filename, e.g. as
below.

What would also be nice is to have `make libs' install the data as well
to RHOME/data/$LIBNAME.

-k

***********************************************************************
#!/bin/sh

for file in $HOME/lib/R/$1/$2 \
            $RHOME/$1/$2 \
            $RHOME/$1/[^.]*/$2;
do
    if [ -r $file ]
    then
	echo $file
	break
    fi
done

if [ ! -r $file ]
then
    echo
fi
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Mon Jun  9 22:13:42 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 09 Jun 1997 23:13:42 +0200
Subject: R-alpha: Transposition bug
Message-ID: <x2afkzlbsp.fsf@bush.kubism.ku.dk>

Shortest program to crash R?

> t(table(1))
Floating point exception (core dumped)

One-dimensional tables don't act like vectors, obviously. The crash
comes from an integer divide-by-zero (yup, that causes a SIGFPE) in

#0  0x8058e0b in do_transpose (call=0x4050c1e4, op=0x401c65fc, 
    args=0x4050c1bc, rho=0x4050e4e4) at array.c:545
545                             INTEGER(r)[i] = INTEGER(a)[(i / ncol)
+ (i % ncol) * nrow];


-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Tue Jun 10 18:46:19 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 10 Jun 1997 19:46:19 +0200
Subject: R-alpha: sd2rd 0.1-2
Message-ID: <199706101746.TAA09501@aragorn.ci.tuwien.ac.at>

Another update of the S doc -> R doc conversion script is attached
below.  Relative to the previously released version, there are two
changes.

* Quoting of parentheses does not happen in verbatim-like sections

* More importantly, the way words in the .SA (SEEALSO) section are
treated is now controlled by an optional argument, `-x'.

Without this option, only words enclosed in single accents are mapped to
LANG(LINK(...)).  With `-x', there are xtra substitutions---all words in
the section are mapped.

I introduced this optional argument because on the one hand, Thomas
pointed out that many S doc files do not quote the object names (e.g. in
survival4), whereas Martin said that the clean way was to quote them, as
there is no reason why non-object names should not appear within .SA.
So, the optional argument should make everyone happy.

I still have several suggestions on my TODO list, but I think the
current version should be rather stable and pretty much usable, so
perhaps one could include it in the R distribution's `etc' directory.

-k

*********************************************************************
#!/usr/bin/perl -w

$VERSION = "0.1-2";

$\ = "\n";

$parenLevel = 0;
$inVerbatim = 0;
$inSeeAlso = 0;
$doprint = 1;
$needArg = 1;
$needVal = 0;
$output = "";

$opt_x = 0;
use Getopt::Long;
GetOptions (("x")) || &usage();

while (<>) {
    chop;
    &substitute unless /^\./;
    @word = split;

    if (/^\s*$/) {
	if ($inVerbatim) {
	    &output("BLANK");
	} else {
	    &output("PARA");
	}
    }
    if (/^[^.]/) { &output($_); }

    if (/^\.AG/) {
	if ($needArg) {
	    &section(0, "ARGUMENTS(");
	    $needArg = 0;
	}
	&section(1, "ARG($word[1] @@");
    }
    if (/^\.CS/) {
	&section(0, "USAGE(");
	$inVerbatim = 1;
    }
    if (/^\.DN/) { $doprint = 0; }
    if (/^\.DT/) { &section(0, "DESCRIPTION("); }
    if (/^\.EX/) {
	&section(0, "EXAMPLES(");
	$inVerbatim = 1;	
    }
    if (/^\.FN/) { $fun = $word[1]; }
    if (/^\.(IP|PP)/) { &output("PARA"); }
    if (/^\.KW/) { 
	if ($parenLevel > 0) {
	    &section(0, "");
	    $parenLevel = 0;
	}
	&output("COMMENT(KEYWORD($word[1]))");
    }
    if (/^\.RC/) {
	if ($needVal) {
	    $needVal = 0;	    
	    &section(0, "VALUES(\n$output\n@@");
	    $doprint = 1;
	}
	&section(1, "ARG($word[1] @@");
    }
    if (/^\.RT/) {
	$needVal = 1;
	$doprint = 0;
	$output = "";
    }
    if (/^\.SA/) {
	&section(0, "SEEALSO(");
	$inSeeAlso = 1;
    }
    if (/^\.SE/) { &paragraph("SIDE EFFECTS"); }
    if (/^\.SH/) {
	if ($word[1] =~ /REFERENCE/) {
	    &section(0, "REFERENCES(");
	} else {
	    &paragraph($word[1]);
	}
    }
    if (/^\.sp/) { output("BLANK"); }
    if (/^\.TL/) { &section(0, "TITLE($fun @@"); }
    if (/^\.WR/) {
	&section(0, "");
	print("COMMENT(Converted by sd2rd version $VERSION.)");
    }

    if (/^\.AO/) {
	output("Arguments for function LANG($word[1]()) can also be");
	output("supplied to this function.");
    }
    if (/^\.GE/) {
	output("This is a generic function.");
	output("Functions with names beginning in LANG($fun.) will be");
	output("methods for this function.");
    }
    if (/^\.GR/) {
	output("Graphical parameters (see LANG(LINK(par)) may also be");
	output("supplied as arguments to this function.");
    }
    if (/^\.ME/) {
	output("This function is a method for the generic function");
	output("LANG($word[1]()) for class LANG($word[2]).");
	output("It can be invoked by calling LANG($word[1](x)) for an");
	output("object LANG(x) of the appropriate class, or directly by");
	output("calling LANG($word[1].$word[2](x)) regardless of the");
	output("class of the object.");
    }
    if (/^\.NA/) { output("Missing values (LANG(NA)s) are allowed."); }
    if (/^\.Tl/) {
	output("In addition, the high-level graphics control arguments");
	output("described under LANG(LINK(par)) and the arguments to");
	output("LANG(LINK(title)) may be supplied to this function.");
    }
}

sub substitute {
    if (!$inVerbatim) {
	s/\(/\\\(/g;
	s/\)/\\\)/g;
    }
    s/\.\.\./DOTS/g;    
    s/\\fB/BOLD\(/g;
    s/\\fR/\)/g;
    s/\\\.(.*)$/COMMENT($1)/g;
    if ($inSeeAlso) {
	if ($opt_x) {
	    s/\`?([\.\w]*\w+)\'?/LANG(LINK($1))/g;
	} else {
	    s/\`([^\']*)\'/LANG(LINK($1))/g;
	}
    } else {
	s/\`([^\']*)\'/LANG($1)/g;
    }
}

sub section {
    local($level, $text) = @_;
    $n = $parenLevel - $level;
    print(")" x $n) if ($n > 0);
    if ($needVal) {
	print("VALUE(\n$output\n)");
	$needVal = 0;
    }
    print("$text") if $text;    
    $parenLevel = $level + 1;
    $inVerbatim = 0;
    $inSeeAlso = 0;
    $doprint = 1;    
}

sub paragraph {
    local($name) = @_;
    &output("PARA\nBOLD($name): ");
}
    
sub output {
    local($text) = @_;
    if ($doprint) {
	print($text);
    } elsif ($output) {
	$output .= "\n$text";
    } else {
	$output = $text;
    }
}

sub usage {
    print("\nsd2rd version $VERSION\n\nusage:  sd2rd [-x] file\n");
    exit;
}
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Tue Jun 10 18:53:24 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 10 Jun 1997 19:53:24 +0200
Subject: R-alpha: problem saving boxplots to PostScript
Message-ID: <199706101753.TAA09525@aragorn.ci.tuwien.ac.at>

The title says it all---seems that the boxes disappear when saving a
boxplot to PostScript.

Is this a known problem?  (Andreas thinks so ...)

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Wed Jun 11 18:37:32 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 11 Jun 1997 19:37:32 +0200
Subject: R-alpha: write() && quoting && ...
Message-ID: <199706111737.TAA12848@aragorn.ci.tuwien.ac.at>

Has anyone had some time to look at the generic write() I posted some
time ago?  I'd appreciate some feedback/comments/suggestions on how to
consistently deal with quoting and name-type attributes ...

On a related matter, Martin indicated that it would be nice to have a
"matrix" class, etc.  Is there any reason for not doing so?  Should not
do any harm, and would make writing methods for generic functions nicer.

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ben@eno.Princeton.EDU  Wed Jun 11 19:15:55 1997
From: ben@eno.Princeton.EDU (Ben Bolker)
Date: Wed, 11 Jun 1997 14:15:55 -0400 (EDT)
Subject: R-alpha: PS bug fix and various minor graphics bugs
In-Reply-To: <199706111737.TAA12848@aragorn.ci.tuwien.ac.at>
Message-ID: <Pine.SUN.3.95.970611141002.11295A-100000@paca>


   I don't know if this bug has been fixed in a patch I missed, but ...

  line 154 of devPS.c, which currently reads

maxpointsize = 72.0 * ((pageheight>pagewidth)) ? pageheight : pagewidth;

   should read

maxpointsize = 72.0 * ((pageheight>pagewidth) ? pageheight : pagewidth);

  The misplaced parenthesis makes maxpointsize wrong.

  Other comments (things I may get around to fixing when I'm less busy):

   - on quick examination "mkh" appears to have no effect;
   - the components of mgp(x,y,z) appear to get rounded off to integers at
some point, which I don't like (but should at least appear in
documentation if there's a good reason for it); I like to be able to
fine-tune distances ...
   - when using arrows() on a log-scaled plot, you have to use log(x)
coordinates rather than x-coordinates.  This could be intentional (but is
not the way text() works, so I would say it should be made to work the way
text() works).

  
Benjamin Bolker          Dep't of Ecology and Evolutionary Biology,
ben@eno.princeton.edu    Princeton University
tel: (609) 258-6886,     fax: (609) 258-1334

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Thu Jun 12 00:02:03 1997
From: ihaka@stat.auckland.ac.nz (Ross &)
Date: Thu, 12 Jun 1997 11:02:03 +1200 (NZST)
Subject: R-alpha: PS bug fix and various minor graphics bugs
In-Reply-To: <Pine.SUN.3.95.970611141002.11295A-100000@paca>
References: <199706111737.TAA12848@aragorn.ci.tuwien.ac.at>
 <Pine.SUN.3.95.970611141002.11295A-100000@paca>
Message-ID: <199706112302.LAA24151@stat1.stat.auckland.ac.nz>

Ben Bolker writes:
 > 
 >    I don't know if this bug has been fixed in a patch I missed, but ...
 > 
 >   line 154 of devPS.c, which currently reads
 > 
 > maxpointsize = 72.0 * ((pageheight>pagewidth)) ? pageheight : pagewidth;
 > 
 >    should read
 > 
 > maxpointsize = 72.0 * ((pageheight>pagewidth) ? pageheight : pagewidth);
 > 
 >   The misplaced parenthesis makes maxpointsize wrong.

This is indeed an error.  I have made the change.

 >   Other comments (things I may get around to fixing when I'm less busy):
 > 
 >    - on quick examination "mkh" appears to have no effect;

This is deliberate.  You can use the cex parameter scales the size
of everything.  If you need "exact" mark sizes I can look at adding
it.

 >    - the components of mgp(x,y,z) appear to get rounded off to integers at
 > some point, which I don't like (but should at least appear in
 > documentation if there's a good reason for it); I like to be able to
 > fine-tune distances ...

This was a typo in the saving and restoring of graphical parameters.
The temporary saved value was typed "int" instead of double.

 >    - when using arrows() on a log-scaled plot, you have to use log(x)
 > coordinates rather than x-coordinates.  This could be intentional (but is
 > not the way text() works, so I would say it should be made to work the way
 > text() works).

Yes, this is because I ommited the transformation in both "segments"
and "arrows".  This is a bug.

All these things will be fixed in 0.50 which is "almost ready to
roll".  It is examination / final-grade time here so there may be a
small delay before the release.
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Thu Jun 12 01:11:33 1997
From: ihaka@stat.auckland.ac.nz (Ross &)
Date: Thu, 12 Jun 1997 12:11:33 +1200 (NZST)
Subject: R-alpha: X11/Postscript Hardcopy bug
Message-ID: <199706120011.MAA25233@stat1.stat.auckland.ac.nz>

A couple of people have come across this recently (piecharts and
boxplots trigger it I think.  Here is a fix (not a patch because
a new release is at hand).

In the C code in src/unix/psx11.c, replace the function psx11_Polygon
with the following code.
	Ross

- - - s n i p - - - h e r e - - -

void psx11_Polygon(int n, double *x, double *y, int bg, int fg)
{
        int i;
        if(bg != NA_INTEGER) {
                psx11_SetColor(bg);
                fprintf(psfp, "np\n");
                fprintf(psfp, "%.2f %.2f m\n",
                        xoffset + xscale * x[0],
                        yoffset + yscale * y[0]);
                for(i=1 ; i<n ; i++) {
                        fprintf(psfp, "%.2f %.2f l\n",
                                xoffset + xscale * x[i],
                                yoffset + yscale * y[i]);
                }
                fprintf(psfp, "cp f\n");
        }
        if(fg != NA_INTEGER) {
                psx11_SetColor(fg);
                fprintf(psfp, "np\n");
                fprintf(psfp, "%.2f %.2f m\n",
                        xoffset + xscale * x[0],
                        yoffset + yscale * y[0]);
                for(i=1 ; i<n ; i++) {
                        fprintf(psfp, "%.2f %.2f l\n",
                                xoffset + xscale * x[i],
                                yoffset + yscale * y[i]);
                }
                fprintf(psfp, "cp o\n");
        }
}
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Thu Jun 12 06:32:35 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Thu, 12 Jun 1997 07:32:35 +0200
Subject: R-alpha: X11/Postscript Hardcopy bug
In-Reply-To: <199706120011.MAA25233@stat1.stat.auckland.ac.nz>
References: <199706120011.MAA25233@stat1.stat.auckland.ac.nz>
Message-ID: <199706120532.HAA14730@aragorn.ci.tuwien.ac.at>

>>>>> Ross & writes:

> A couple of people have come across this recently (piecharts and
> boxplots trigger it I think.  Here is a fix (not a patch because
> a new release is at hand).

> In the C code in src/unix/psx11.c, replace the function psx11_Polygon
> with the following code.

Thanks, works great.

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Fri Jun 13 00:57:17 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Fri, 13 Jun 1997 11:57:17 +1200 (NZST)
Subject: R-alpha: ISO Latin1 and Readline
Message-ID: <199706122357.LAA03285@stat1.stat.auckland.ac.nz>

Does anyone have experience with using the readline library in
conjunction with ISO Latin1 characters?

In response to a prod from Martin Maechler I am trying to convert R so
that it will accept 8-bit characters (and render them correctly in text
and graphics).  This appears to work when I type such lines into a file
and source it, but readline seems to intercept any 8-bit characters
I type interactively  and refuses to let them through to R.

Is this cured if you have the right kind of keyboard?

Additional query: Should accented characters be allowed in variable names?

	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Fri Jun 13 06:03:39 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Fri, 13 Jun 1997 07:03:39 +0200
Subject: R-alpha: ISO Latin1 and Readline
In-Reply-To: <199706122357.LAA03285@stat1.stat.auckland.ac.nz>
References: <199706122357.LAA03285@stat1.stat.auckland.ac.nz>
Message-ID: <199706130503.HAA04192@aragorn.ci.tuwien.ac.at>

>>>>> Ross Ihaka writes:

> Does anyone have experience with using the readline library in
> conjunction with ISO Latin1 characters?

> In response to a prod from Martin Maechler I am trying to convert R so
> that it will accept 8-bit characters (and render them correctly in text
> and graphics).  This appears to work when I type such lines into a file
> and source it, but readline seems to intercept any 8-bit characters
> I type interactively  and refuses to let them through to R.

> Is this cured if you have the right kind of keyboard?

Hmm.

I have e.g.

hornik@aragorn:/var/tmp/hornik$ cat =E4=F6=FC.dat=20
1 2 3
4 5 6

R> x <- read.table("/var/tmp/hornik/=E4=F6=FC.dat")
R> x
  V1 V2 V3
1  1  2  3
2  4  5  6

I think the trick is that you need to have the readline init file
(INPUTRC, typically something like /etc/inputrc) specify

     # don't strip characters to 7 bits when reading
     set input-meta on
    =20
     # allow iso-latin1 characters to be inserted rather than converted t=
o
     # prefix-meta sequences
     set convert-meta off
    =20
     # display characters with the eighth bit set directly rather than
     # as meta-prefixed characters
     set output-meta on

(comments from the readline/info sample file, the settings are what we
use here ...).

> Additional query: Should accented characters be allowed in variable
> names?

Not sure.  Maybe yes so that e.g. if I had to impress someone in
Austrian I could use "Gr=F6=DFe" as a variable name ...

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Jun 13 13:43:50 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 13 Jun 1997 14:43:50 +0200
Subject: R-alpha: ISO Latin1 and Readline
In-Reply-To: <199706130503.HAA04192@aragorn.ci.tuwien.ac.at> (message from
 Kurt Hornik on Fri, 13 Jun 1997 07:03:39 +0200)
Message-ID: <199706131243.OAA08910@sophie.ethz.ch>

One thing which is important is
to use the environment variable 

	LC_CTYPE=iso_8859_1

(This makes Emacs  automatically call (standard-display-european 1)

Here, the readline library is not of much importance, because

	1) We use US-american keyboards 
	   which makes programming / latex / Splus much easier.

	2) In Emacs, we use a nice package 
		(require 'iso-transl)
	   and
	        (iso-transl-set-language "German")

	   which makes C-x 8 and more imporantly
           'Alt' (the one besides "Meta" on a SPARC keyboard)
           behave as a prefix for accented characters.
	
	  So, the German Umlauts are produced using 
		Alt-a (), ....Alt-U (), 
		and even the one we don't use in Switzerland, Alt-s ()
	  Also, Alt-m (=)  ,   Alt-< (=) ;  

	  And for all accents: 
		Alt-accent-letter  -->  accented letter.

	   Alt-'-e  -> 
	   Alt-^-i  -> 

	 and so on -- this is much more powerful than any language specific
	 keyboard.

and then, we use  S-mode / R-mode / latex-mode / shell-mode   from within
Emacs. 

------------

Back to R:
	
I think most important are

1) string constants
2) Comments

and then

3)  text(.) and mtext(.)  of these constants.

4) Variable names might come natural to some users, 
   especially the ones that come from non-Unix worlds.

------------------------------
Remark to '3)'   and postscript(.).

In newer versions of S-plus (>= 3.1 I think),
there is the 

       ps.options (setfont = ps.setfont.latin1)

command which allows for  ISO-latin1 text.
The big drawback is that the default plotting character is DIFFERENT
and worse.

If you want to see what I mean, execute the following and compare the 2
postscript files:

#### Deal with 'bug' :
#### if       		ps.options (setfont = ps.setfont.latin1)
#### has been called,
#### the default plotting character, the 'bullet' is drawn much too small.

pso <- ps.options (reset = T)
ps.options (setfont = ps.setfont.latin1)
postscript("latin1-ex.ps")
plot(1:10, main =" by Martin Mchler")
Txt <- paste("ps.options (reset = T)",
	     "ps.options (setfont = ps.setfont.latin1)",
	     "plot(1:10, main = \" by Martin Mchler\")",
	     "text(1,9,\"__all this text__\")",sep="\n")
text(1,9,Txt, adj=0)
dev.off()

pso <- ps.options (reset = T)
postscript("std-ex.ps")
plot(1:10, main =" by Martin Mchler")
text(1,9,"ps.options (reset = T)\nplot(1:10, main = \"....\")",adj=0)
dev.off()
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Fri Jun 13 14:55:38 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 13 Jun 1997 15:55:38 +0200
Subject: R-alpha: ISO Latin1 and Readline
In-Reply-To: Kurt Hornik's message of Fri, 13 Jun 1997 07:03:39 +0200
References: <199706122357.LAA03285@stat1.stat.auckland.ac.nz>
 <199706130503.HAA04192@aragorn.ci.tuwien.ac.at>
Message-ID: <x2d8pq8v51.fsf@bush.kubism.ku.dk>

Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

> I think the trick is that you need to have the readline init file
> (INPUTRC, typically something like /etc/inputrc) specify
> 
>      # don't strip characters to 7 bits when reading
>      set input-meta on
>      
>      # allow iso-latin1 characters to be inserted rather than converted to
>      # prefix-meta sequences
>      set convert-meta off
>      
>      # display characters with the eighth bit set directly rather than
>      # as meta-prefixed characters
>      set output-meta on

Exactly. One loses the Meta characters that way, unavoidable since
Meta works in xterms and other terminals by OR'ing characters with
0x128, so e.g. M-x == . No big deal, use ESC x instead. (Who uses
it anyway?)

> > Additional query: Should accented characters be allowed in variable
> > names?
> 
> Not sure.  Maybe yes so that e.g. if I had to impress someone in
> Austrian I could use "Gre" as a variable name ...

One less newbie error when teaching... Are there any arguments
*against* it?

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ben@eno.Princeton.EDU  Mon Jun 16 01:21:38 1997
From: ben@eno.Princeton.EDU (Ben Bolker)
Date: Sun, 15 Jun 1997 20:21:38 -0400 (EDT)
Subject: R-alpha: image(): minor bug in R code and helpfile (fixes)
Message-ID: <Pine.SUN.3.95.970615201153.20427A-100000@paca>


   I've noticed a few minor annoyances/mismatches with S in image().
 
  First, if you give it just a matrix argument (image(z)), it complains
rather than (as S does) using default x and y.

  This patch fixes it to work (mostly) like S (although in keeping with
what was in R already the default x,y coordinates are ((0,1),(0,1)) rather
than (1:nrow,1:ncol)). 

5,16d4
<        if(is.list(x)) {
<              z <- x$z
<              y <- x$y
<              x <- x$x
<               if(is.null(x) || is.null(y) || is.null(z))
<                stop("list must contain x, y, and z components with z a matrix")
<         }
<         else if(missing(y) && missing(z) && is.matrix(x)) {
<                 z <- x
<                 x <- seq(0,1,len=nrow(z))
<                 y <- seq(0,1,len=ncol(z))
<         }

  Second, the examples in the help file don't actually work(!) without the
following changes:

51c51
< image(z=volcano, x, y,
---
> image(volcano, x, y,
53c53
< contour(z=volcano, x, y, levels=seq(90, 200, by=5),
---
> contour(volcano, x, y, zc=seq(90, 200, by=5),

   (By the way, there is currently no help for contour().)

  A more general question: what are the ethics/legalities of adapting
S/S-PLUS function code to use in R?  

Benjamin Bolker          Dep't of Ecology and Evolutionary Biology,
ben@eno.princeton.edu    Princeton University
tel: (609) 258-6886,     fax: (609) 258-1334

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Wed Jun 18 18:42:56 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Wed, 18 Jun 1997 10:42:56 -0700 (PDT)
Subject: R-alpha: f77 on Solaris
In-Reply-To: <199706091321.PAA01472@aragorn.ci.tuwien.ac.at>
Message-ID: <Pine.SUN.3.95.970618103955.1332B-100000@zen>


The autoconfigure flags for f77 on Solaris 5.5.1 are wrong
They should be FFLAGS=" -pic" rather than FFLAGS=" -fpic"


Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Thu Jun 19 08:46:23 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Thu, 19 Jun 1997 09:46:23 +0200
Subject: R-alpha: f77 on Solaris
In-Reply-To: <Pine.SUN.3.95.970618103955.1332B-100000@zen> (message from
 Thomas Lumley on Wed, 18 Jun 1997 10:42:56 -0700 (PDT))
Message-ID: <199706190746.JAA07101@sophie.ethz.ch>

>>>>> "Thomas" == Thomas Lumley <thomas@biostat.washington.edu> writes:

    Thomas> The autoconfigure flags for f77 on Solaris 5.5.1 are wrong They
    Thomas> should be FFLAGS=" -pic" rather than FFLAGS=" -fpic"

am I right that you suggest patching configure.in (and hence 'configure')?

This may be THE solution, really.

-----

I've been using  f77 on Solaris 2.5.1 ( = SunOS 5.5.1)  for a while,
and in newer versions of R,
all was fine when I had
---------------------------------------
FPICFLAGS=-Kpic
---------------------------------------

in the RHOME/config.site  file.
		   -----

Martin Maechler <maechler@stat.math.ethz.ch>		 <><
Seminar fuer Statistik, SOL G1
ETH (Federal Inst. Technology)	8092 Zurich	 SWITZERLAND
phone: x-41-1-632-3408		fax: ...-1086
http://www.stat.math.ethz.ch/~maechler/
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Thu Jun 19 17:05:05 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 19 Jun 1997 18:05:05 +0200
Subject: R-alpha: f77 on Solaris
In-Reply-To: Martin Maechler's message of Thu, 19 Jun 1997 09:46:23 +0200
References: <199706190746.JAA07101@sophie.ethz.ch>
Message-ID: <x2k9jqpoi6.fsf@bush.kubism.ku.dk>

Martin Maechler <maechler@stat.math.ethz.ch> writes:

> 
> >>>>> "Thomas" == Thomas Lumley <thomas@biostat.washington.edu> writes:
> 
>     Thomas> The autoconfigure flags for f77 on Solaris 5.5.1 are wrong They
>     Thomas> should be FFLAGS=" -pic" rather than FFLAGS=" -fpic"
> 
> am I right that you suggest patching configure.in (and hence 'configure')?
> 
> This may be THE solution, really.
> 

Um, does it work on ALL f77's on Solaris (f2c/gcc, g77, Sun f77)?

(I'm at a conference in Norway at the moment, so it's awkward for me
to check) 

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Jun 20 12:46:09 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 20 Jun 1997 13:46:09 +0200
Subject: R-alpha: x11()-window resizing -- another problem   pty='s' only works 2nd time
Message-ID: <199706201146.NAA01301@sophie.ethz.ch>

Can you confirm this problem : 

###---------  RESHAPING  x11()  window has more problems: ----

x11()
plot(1:8)# as expected:   <<<<<<<< NO Problem, if you OMIT this plot !!
##-- now RESHAPE  the  x11() - window !
par(pty = 's') # should make SQUARE plotting region
plot(1:8) #-- oops, not yet...
plot(1:8) # now !
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Friedrich.Leisch@ci.tuwien.ac.at  Fri Jun 20 12:51:52 1997
From: Friedrich.Leisch@ci.tuwien.ac.at (Friedrich Leisch)
Date: Fri, 20 Jun 1997 13:51:52 +0200
Subject: R-alpha: x11()-window resizing -- another problem   pty='s' only works 2nd time
In-Reply-To: <199706201146.NAA01301@sophie.ethz.ch>
References: <199706201146.NAA01301@sophie.ethz.ch>
Message-ID: <199706201151.NAA02007@galadriel.ci.tuwien.ac.at>

>>>>> On Fri, 20 Jun 1997 13:46:09 +0200,
>>>>> Martin Maechler wrote:

> Can you confirm this problem :=20
> ###---------  RESHAPING  x11()  window has more problems: ----

> x11()
> plot(1:8)# as expected:   <<<<<<<< NO Problem, if you OMIT this plot !!
> ##-- now RESHAPE  the  x11() - window !
> par(pty =3D 's') # should make SQUARE plotting region
> plot(1:8) #-- oops, not yet...
> plot(1:8) # now !


Yes, same problem here on a Linux machine running 0.49 Beta.

Best,
Fritz

--=20
-------------------------------------------------------------------
                        Friedrich  Leisch                            =20
Institut f=FCr Statistik                      Tel: (+43 1) 58801 4541
Technische Universit=E4t Wien                 Fax: (+43 1)  504 14 98
Wiedner Hauptstra=DFe 8-10/1071      Friedrich.Leisch@ci.tuwien.ac.at
A-1040 Wien, Austria             http://www.ci.tuwien.ac.at/~leisch
     PGP public key http://www.ci.tuwien.ac.at/~leisch/pgp.key
-------------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Fri Jun 20 16:59:16 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Fri, 20 Jun 1997 08:59:16 -0700 (PDT)
Subject: R-alpha: x11()-window resizing -- another problem   pty='s' only works 2nd time
In-Reply-To: <199706201146.NAA01301@sophie.ethz.ch>
Message-ID: <Pine.SUN.3.95.970620085541.2114A-100000@zen>

On Fri, 20 Jun 1997, Martin Maechler wrote:

> Can you confirm this problem : 
> 
Yes. Also interesting to note that it's the second plot statement,
regardless of the order of the commands, ie:

	# reshape
	plot(1:8)
	par(pty="s")
	plot(1:8)
works immediately

Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ben@eno.Princeton.EDU  Mon Jun 23 17:40:55 1997
From: ben@eno.Princeton.EDU (Ben Bolker)
Date: Mon, 23 Jun 1997 12:40:55 -0400 (EDT)
Subject: R-alpha: comparing alpha and numeric
Message-ID: <Pine.SUN.3.95.970623123919.6004A-100000@paca>


Is this behavior correct? (R 0.49 on SunOS 4.1.4)

> "a">1
 TRUE
> "a"<1
 FALSE
> "a"==1
 FALSE
> "a">2
 TRUE
> "a"<2
 FALSE

 (I know, this is like the old joke: "Doctor, it hurts when I do this."
"Well, don't do that!"  But it might be useful to have this caught by an
error or warning message ...)

Benjamin Bolker          Dep't of Ecology and Evolutionary Biology,
ben@eno.princeton.edu    Princeton University
tel: (609) 258-6886,     fax: (609) 258-1334

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Mon Jun 23 17:46:57 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Mon, 23 Jun 1997 09:46:57 -0700 (PDT)
Subject: R-alpha: comparing alpha and numeric
In-Reply-To: <Pine.SUN.3.95.970623123919.6004A-100000@paca>
Message-ID: <Pine.SUN.3.95.970623094548.1180A-100000@zen>

On Mon, 23 Jun 1997, Ben Bolker wrote:

> 
> Is this behavior correct? (R 0.49 on SunOS 4.1.4)
> 
> > "a">1
>  TRUE
> > "a"<1
<etc> 

It gets worse
> "3">4
[1] FALSE
> "3"<4
[1] TRUE
> "3"==4
[1] FALSE
> "3"==3
[1] TRUE
all well and good, and perhaps even useful, but
> "23"<3 
[1] TRUE
Ouch.

Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ben@eno.Princeton.EDU  Mon Jun 23 17:47:50 1997
From: ben@eno.Princeton.EDU (Ben Bolker)
Date: Mon, 23 Jun 1997 12:47:50 -0400 (EDT)
Subject: R-alpha: various graphics Q.
Message-ID: <Pine.SUN.3.95.970623124059.6009A-100000@paca>


  "contour" can't return a list of contours (it would be nice)

  "arrows" has different options from S-PLUS (no "open" or "rel" options,
no "lwd" parameter or graphics parameter pass-through; "size" in S
corresponds to "length" in R).  [I know we needn't follow S-PLUS syntax
slavishly, but it would be nice at least to compile a more-or-less
comprehensive list of differences.]

   The xaxs option "i" (no extra space around xlim, ylim) isn't documented

   axis() first argument is called "side" (not "which" as in S: see
comment above)

In lines 5-8 I correct what I think is a bug -- since "cra" (character
size in rasters)  doesn't change with "cex", the legend line-spacing
doesn't change correctly for cex>1.
   The other changes, which should definitely be considered optional, adds
the capability I've always wanted in legends -- to be able to mix symbols
and lines in the same legend without having to have a symbol or a line for
every item in the legend, and to be able to put symbols and lines in the
same column (option "merge").  The spacing's not quite perfect, though.

3c3
< 	xjust=0, yjust=1, merge=FALSE, ...)
---
> 	xjust=0, yjust=1, ...)
5,8c5,8
< 	xchar <- xinch(par("cin")[1])*par("cex")
< 	ychar <- yinch(par("cin")[2])*1.2*par("cex")
< 	xbox <- xinch(par("cin")[2]*0.8)*par("cex")
< 	ybox <- yinch(par("cin")[2]*0.8)*par("cex")
---
> 	xchar <- xinch(par("cin")[1])
> 	ychar <- yinch(par("cin")[2]) * 1.2
> 	xbox <- xinch(par("cin")[2] * 0.8)
> 	ybox <- yinch(par("cin")[2] * 0.8)
50c50
< 		if (!merge) xt <- xt + xbox + xchar
---
> 		xt <- xt + xbox + xchar
52d51
< 	col _ rep(col,length.out=length(legend))
54,57c53,54
< 	    pch _ rep(pch,length.out=length(legend))
<                 ok _ (is.character(pch) | pch>0)
< 		points((xt + 0.25 * xchar)[ok], yt[ok], pch[ok], col=col[ok])
< 		if (!merge) xt <- xt + 1.5 * xchar
---
> 		points(xt + 0.25 * xchar, yt, pch, col=col)
> 		xt <- xt + 1.5 * xchar
60,66c57,58
< 	    lty _ rep(lty,length.out=length(legend))
<                 ok _ (lty>0)
< 	        if (merge) segments((xt-xchar)[ok], yt[ok], (xt + xchar)[ok],
< 			yt[ok], lty=lty[ok], col=col[ok])
< 		else segments(xt[ok], yt[ok], (xt + 2 * xchar)[ok],
< 			yt[ok], lty=lty[ok], col=col[ok])
< 		if (!merge) xt <- xt + 3 * xchar
---
> 		segments(xt, yt, xt + 2 * xchar, yt, lty=lty, col=col)
> 		xt <- xt + 3 * xchar
68d59
<         if (merge) xt <- xt + 3 * xchar



=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Mon Jun 23 18:05:04 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Mon, 23 Jun 1997 19:05:04 +0200
Subject: R-alpha: comparing alpha and numeric
In-Reply-To: <Pine.SUN.3.95.970623094548.1180A-100000@zen> (message from
 Thomas Lumley on Mon, 23 Jun 1997 09:46:57 -0700 (PDT))
Message-ID: <199706231705.TAA04361@sophie.ethz.ch>

The solution is :
 If one of them is  character(), both are coerced to and then compared..

which 'naturally' gives

> "23"<3   <-->  "23" < "3"   <-->  "AB" < "B"
[1] TRUE
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Mon Jun 23 22:52:00 1997
From: ihaka@stat.auckland.ac.nz (Ross &)
Date: Tue, 24 Jun 1997 09:52:00 +1200 (NZST)
Subject: R-alpha: Silence
Message-ID: <199706232152.JAA28442@stat1.stat.auckland.ac.nz>

I've been "out" (literally and figuratively) with a virus for the past
week or so.  One quick observation though

	"23" < 3

is a STRING comparison because of type coercion.  Thus returning
TRUE is correct.
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Jun 24 08:21:56 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 24 Jun 1997 09:21:56 +0200
Subject: R-alpha: funny behavior of  data(.)
Message-ID: <199706240721.JAA04748@sophie.ethz.ch>

This is wierd....

It looks like the problem appears when  data(..) is immediately followed 
by another statement USING ``;''
		     -----------	
 rm(list=ls())
 data(phones); summary(phones)
	Error: Object "phones" not found
 ls()
	character(0)

Or also

 ls()
	character(0)
 data(pigs); 1:10
			##-- nothing is printed, but here 'pigs' is sourced
 ls()
	[1] "pigs"


--------------
Could it be a parser bug of  `` expr1 ; expr2 '' ??




=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From jlindsey@luc.ac.be  Wed Jun 25 10:20:50 1997
From: jlindsey@luc.ac.be (Jim Lindsey)
Date: Wed, 25 Jun 1997 11:20:50 +0200 (MET DST)
Subject: R-alpha: lbeta, ctrl-C and crashes
Message-ID: <9706250920.AA11845@alpha.luc.ac.be>

1. lbeta and beta do not work properly: lbeta returns its first
argument and beta gives the lbeta result. 
In names.c lines 245-6, the codes for these should be 2 and 3 instead
of 1 and 2

2. crtl-C does not work (except the first time) on Red Hat elf Linux
(which has many many other problems as well) nor on the previous
version of Linux for Amiga. It worked on Slackware aout Linux and now
works on the most recent version of Linux for the Amiga. It also works
correctly on a Sun.

3. I suspect that my core dump problem may arise from repeated calls
to complex R functions with big data vectors from C code as occurs
with nlm interating to find the MLE.  Doing a gc() between uses of nlm
seems to reduce the problem.

Jim
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Wed Jun 25 10:30:03 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 25 Jun 1997 11:30:03 +0200
Subject: R-alpha: lbeta, .. etc
In-Reply-To: <9706250920.AA11845@alpha.luc.ac.be> (message from Jim Lindsey on
 Wed, 25 Jun 1997 11:20:50 +0200 (MET DST))
Message-ID: <199706250930.LAA05653@sophie.ethz.ch>

>>>>> "Jim" == Jim Lindsey <jlindsey@luc.ac.be> writes:

    Jim> 1. lbeta and beta do not work properly: lbeta returns its first
    Jim> argument and beta gives the lbeta result.  In names.c lines 245-6,
    Jim> the codes for these should be 2 and 3 instead of 1 and 2

    Jim> 2. crtl-C does not work (except the first time) on Red Hat elf
    Jim> Linux (which has many many other problems as well) nor on the
    Jim> previous version of Linux for Amiga. It worked on Slackware aout
    Jim> Linux and now works on the most recent version of Linux for the
    Jim> Amiga. It also works correctly on a Sun.

Both of these problems have been reported before, here.
However, Jim hasn't been subscribed, ``back then''.

Ross has found (about 6 weeks ago...) that problem '1.'
is simply a  "cut & paste" typo in  RHOME/main/names.c
(old code has been doubled by accident).

Here is the patch which just deletes about a dozen lines in  names.c

--- /usr/local/R-0.49-RR/src/main/names.c	Fri May 16 15:00:56 1997
+++ names.c	Wed May 14 09:23:14 1997
@@ -240,34 +240,6 @@
 
 #endif
 
-/* Mathematical Functions of Two Variables */
-
-{"lbeta",	do_math2,	1,	1,	2,	PP_FUNCALL,	0},
-{"beta",	do_math2,	2,	1,	2,	PP_FUNCALL,	0},
-{"lchoose",	do_math2,	4,	1,	2,	PP_FUNCALL,	0},
-{"choose",	do_math2,	5,	1,	2,	PP_FUNCALL,	0},
-
-{"dchisq",	do_math2,	6,	1,	2,	PP_FUNCALL,	0},
-{"pchisq",	do_math2,	7,	1,	2,	PP_FUNCALL,	0},
-{"qchisq",	do_math2,	8,	1,	2,	PP_FUNCALL,	0},
-
-{"dexp",	do_math2,	9,	11,	2,	PP_FUNCALL,	0},
-{"pexp",	do_math2,	10,	11,	2,	PP_FUNCALL,	0},
-{"qexp",	do_math2,	11,	11,	2,	PP_FUNCALL,	0},
-
-{"dgeom",	do_math2,	12,	1,	2,	PP_FUNCALL,	0},
-{"pgeom",	do_math2,	13,	1,	2,	PP_FUNCALL,	0},
-{"qgeom",	do_math2,	14,	1,	2,	PP_FUNCALL,	0},
-
-{"dpois",	do_math2,	15,	1,	2,	PP_FUNCALL,	0},
-{"ppois",	do_math2,	16,	1,	2,	PP_FUNCALL,	0},
-{"qpois",	do_math2,	17,	1,	2,	PP_FUNCALL,	0},
-
-{"dt",		do_math2,	18,	1,	2,	PP_FUNCALL,	0},
-{"pt",		do_math2,	19,	1,	2,	PP_FUNCALL,	0},
-{"qt",		do_math2,	20,	1,	2,	PP_FUNCALL,	0},
-
-
 /* Mathematical Functions of Three Variables */
 
 {"dbeta",	do_math3,	1,	1,	3,	PP_FUNCALL,	0},
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From jlindsey@luc.ac.be  Wed Jun 25 10:47:00 1997
From: jlindsey@luc.ac.be (Jim Lindsey)
Date: Wed, 25 Jun 1997 11:47:00 +0200 (MET DST)
Subject: R-alpha: lbeta
Message-ID: <9706250947.AA03921@alpha.luc.ac.be>

Why is the patch for lbeta not included in the two patches distributed
to ordinary human beings? Jim
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From colin@geology.gla.ac.uk  Wed Jun 25 12:20:47 1997
From: colin@geology.gla.ac.uk (Colin Farrow)
Date: Wed, 25 Jun 1997 12:20:47 +0100
Subject: R-alpha: R and Mac
Message-ID: <199706251120.MAA06822@alligin.gla.ac.uk>


A recent question asked


Is there anyone using R in the Mac? Answer yes.


but when will we see Rbeta on 68k or powermacs?


--------------------
                     \
Colin Farrow          \
                       \---------------------------------------
                        \                                       \
Department of Geology,   \ E-mail: colin@geology.gla.ac.uk       \
University of Glasgow,    \                                       \
Glasgow, G12 8QQ. Scotland \ Tel: +44 (0)41 339 8855 x5466         \
                            \ Fax: +44 (0)41 330 4817               \
`````````````````````````````````````````````````````````````````````````
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From jlindsey@luc.ac.be  Wed Jun 25 13:07:04 1997
From: jlindsey@luc.ac.be (Jim Lindsey)
Date: Wed, 25 Jun 1997 14:07:04 +0200 (MET DST)
Subject: R-alpha: R on 68K
Message-ID: <9706251207.AA26544@alpha.luc.ac.be>

R runs perfectly under 68K Linux on Mac, Amiga and Atari. Jim
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Wed Jun 25 16:39:33 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Wed, 25 Jun 1997 08:39:33 -0700 (PDT)
Subject: R-alpha: lbeta, ctrl-C and crashes
In-Reply-To: <9706250920.AA11845@alpha.luc.ac.be>
Message-ID: <Pine.SUN.3.95.970625083652.2283A-100000@zen>

On Wed, 25 Jun 1997, Jim Lindsey wrote:
> 
> 2. crtl-C does not work (except the first time) on Red Hat elf Linux
> (which has many many other problems as well) nor on the previous
> version of Linux for Amiga. It worked on Slackware aout Linux and now
> works on the most recent version of Linux for the Amiga. It also works
> correctly on a Sun.

It seems to work on Debian Linux (elf, 2.0.27) 

Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Wed Jun 25 19:18:45 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 25 Jun 1997 20:18:45 +0200
Subject: R-alpha: several bugs ...
Message-ID: <199706251818.UAA00252@aragorn.ci.tuwien.ac.at>

Perhaps I'd better not send any bug reports in order not to delay the
release of 0.50 ... but nevertheless.

R> x <- rnorm(20)
R> y <- rnorm(20)
R> z <- lm(y ~ x)

R> typeof(z)
[1] "list"

R> unlist(z)
[[1]]
[1] 0.07030757

[[2]]
[1] -0.1790483

[[3]]
NULL

[[4]]
NULL

and many more ending in

[[152]]
NULL

[[153]]
NULL

[[154]]
NULL

Hmm ...

*****************************************************************

Also, it seems that effects.lm, predict.default for lm objects,
update.lm and even formula.lm do not work.

E.g., predict.default does not take care of the one-arg case (and hence
dies when calling as.matrix on NULL), and in the 2-arg case tries to use
object$intercept and object$covmat which do not exist (in the lm case).

Hmm ... this is not meant as a `usual' passive bug report.  Is anybody
working on fixing these problems?  If not, I am willing to have a look,
but I can't promise that I'll get it done within very soon.

R&R, do we have a scheduled release date for the next version?

Best,
-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Thu Jun 26 06:36:34 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Thu, 26 Jun 1997 07:36:34 +0200
Subject: R-alpha: lbeta, ctrl-C and crashes
In-Reply-To: <Pine.SUN.3.95.970625083652.2283A-100000@zen>
References: <9706250920.AA11845@alpha.luc.ac.be>
 <Pine.SUN.3.95.970625083652.2283A-100000@zen>
Message-ID: <199706260536.HAA00517@aragorn.ci.tuwien.ac.at>

>>>>> Thomas Lumley writes:

> On Wed, 25 Jun 1997, Jim Lindsey wrote:
>> 
>> 2. crtl-C does not work (except the first time) on Red Hat elf Linux
>> (which has many many other problems as well) nor on the previous
>> version of Linux for Amiga. It worked on Slackware aout Linux and now
>> works on the most recent version of Linux for the Amiga. It also works
>> correctly on a Sun.

> It seems to work on Debian Linux (elf, 2.0.27)

Are we talking about `while (1) { print("whatever") } RET ... CTRL-C'
and then again and again?  As said, works perfectly under Debian 1.3
with a 2.0.27 kernel.

What are the other problems with Red Hat?

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Thu Jun 26 07:03:29 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Thu, 26 Jun 1997 08:03:29 +0200
Subject: R-alpha: lbeta, .. etc
In-Reply-To: <199706250930.LAA05653@sophie.ethz.ch>
References: <9706250920.AA11845@alpha.luc.ac.be>
 <199706250930.LAA05653@sophie.ethz.ch>
Message-ID: <199706260603.IAA00927@aragorn.ci.tuwien.ac.at>

>>>>> Martin Maechler writes:

>>>>> "Jim" == Jim Lindsey <jlindsey@luc.ac.be> writes:
Jim> 1. lbeta and beta do not work properly: lbeta returns its first
Jim> argument and beta gives the lbeta result.  In names.c lines 245-6,
Jim> the codes for these should be 2 and 3 instead of 1 and 2

Jim> 2. crtl-C does not work (except the first time) on Red Hat elf
Jim> Linux (which has many many other problems as well) nor on the
Jim> previous version of Linux for Amiga. It worked on Slackware aout
Jim> Linux and now works on the most recent version of Linux for the
Jim> Amiga. It also works correctly on a Sun.

> Both of these problems have been reported before, here.
> However, Jim hasn't been subscribed, ``back then''.

> Ross has found (about 6 weeks ago...) that problem '1.'
> is simply a  "cut & paste" typo in  RHOME/main/names.c
> (old code has been doubled by accident).

> Here is the patch which just deletes about a dozen lines in  names.c

> ...

Actually, I must have missed that patch, too.  I'll rebuild my Debian
packages right away ...

Re official versus non-official patches.  What I could do is put all
patches that were posted on r-devel and look reasonable into CRAN (e.g.,
src/patches).  However, R&R will probably not be too happy about the
existence of unofficial patches ...

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From jlindsey@luc.ac.be  Thu Jun 26 08:07:47 1997
From: jlindsey@luc.ac.be (Jim Lindsey)
Date: Thu, 26 Jun 1997 09:07:47 +0200 (MET DST)
Subject: R-alpha: R on 68K
In-Reply-To: <199706260608.IAA00936@aragorn.ci.tuwien.ac.at> from "Kurt Hornik" at Jun 26, 97 08:08:49 am
Message-ID: <9706260707.AA16200@alpha.luc.ac.be>


> 
> >>>>> Jim Lindsey writes:
> 
> > R runs perfectly under 68K Linux on Mac, Amiga and Atari. Jim
> 
> Just checking:  This means you can build from the sources and everything
> is fine, right?
> 
> -k
> 

Yes my son has R running on Amiga since last September and it is the
same basic Linux for the three, so I assume it works for the other two
as well.
  Jim
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Thu Jun 26 09:43:06 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 26 Jun 1997 10:43:06 +0200
Subject: R-alpha: lbeta, ctrl-C and crashes
In-Reply-To: Kurt Hornik's message of Thu, 26 Jun 1997 07:36:34 +0200
References: <9706250920.AA11845@alpha.luc.ac.be>
 <Pine.SUN.3.95.970625083652.2283A-100000@zen>
 <199706260536.HAA00517@aragorn.ci.tuwien.ac.at>
Message-ID: <x23eq5rbz9.fsf@bush.kubism.ku.dk>

Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

> Are we talking about `while (1) { print("whatever") } RET ... CTRL-C'
> and then again and again?  As said, works perfectly under Debian 1.3
> with a 2.0.27 kernel.

2nd time around, that command loops unstoppably here. 

Redhat 4.1/2.0.28
 
$ ldd R/bin/R.binary 
        libSM.so.6 => /usr/X11R6/lib/libSM.so.6.0
        libICE.so.6 => /usr/X11R6/lib/libICE.so.6.0
        libX11.so.6 => /usr/X11R6/lib/libX11.so.6.1
        libf2c.so.0 => /usr/lib/libf2c.so.0.20
        libdl.so.1 => /lib/libdl.so.1.7.14
        libreadline.so.2 => /usr/lib/libreadline.so.2.0
        libtermcap.so.2 => /lib/libtermcap.so.2.0.8
        libm.so.5 => /lib/libm.so.5.0.8
        libc.so.5 => /lib/libc.so.5.4.23

This is strange. What libs are used by Debian? And on Thomas' system?
-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Thu Jun 26 09:51:05 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Thu, 26 Jun 1997 10:51:05 +0200
Subject: R-alpha: lbeta, ctrl-C and crashes
In-Reply-To: <x23eq5rbz9.fsf@bush.kubism.ku.dk>
References: <9706250920.AA11845@alpha.luc.ac.be>
 <Pine.SUN.3.95.970625083652.2283A-100000@zen>
 <199706260536.HAA00517@aragorn.ci.tuwien.ac.at>
 <x23eq5rbz9.fsf@bush.kubism.ku.dk>
Message-ID: <199706260851.KAA01127@aragorn.ci.tuwien.ac.at>

>>>>> Peter Dalgaard BSA writes:

> Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:
>> Are we talking about `while (1) { print("whatever") } RET ... CTRL-C'
>> and then again and again?  As said, works perfectly under Debian 1.3
>> with a 2.0.27 kernel.

> 2nd time around, that command loops unstoppably here. 

> Redhat 4.1/2.0.28
 
> $ ldd R/bin/R.binary 
>         libSM.so.6 => /usr/X11R6/lib/libSM.so.6.0
>         libICE.so.6 => /usr/X11R6/lib/libICE.so.6.0
>         libX11.so.6 => /usr/X11R6/lib/libX11.so.6.1
>         libf2c.so.0 => /usr/lib/libf2c.so.0.20
>         libdl.so.1 => /lib/libdl.so.1.7.14
>         libreadline.so.2 => /usr/lib/libreadline.so.2.0
>         libtermcap.so.2 => /lib/libtermcap.so.2.0.8
>         libm.so.5 => /lib/libm.so.5.0.8
>         libc.so.5 => /lib/libc.so.5.4.23

> This is strange. What libs are used by Debian? And on Thomas' system?

Hmm.  I get

hornik@aragorn:~/Work/misc$ ldd /usr/local/lib/R/bin/R.binary 
        libSM.so.6 => /usr/X11R6/lib/libSM.so.6		(6.0)
        libICE.so.6 => /usr/X11R6/lib/libICE.so.6	(6.0)
        libX11.so.6 => /usr/X11R6/lib/libX11.so.6	(6.1)
        libdl.so.1 => /lib/libdl.so.1			(1.8.10)
        libreadline.so.2 => /lib/libreadline.so.2	(2.1)
        libm.so.5 => /lib/libm.so.5			(5.0.8)
        libc.so.5 => /lib/libc.so.5			(5.4.23)
        libncurses.so.3.0 => /lib/libncurses.so.3.0	(3.0)

(I added the full version numbers manually.)

The obvious difference is that Debian uses ncurses instead of termcap.

I checked  again a few minutes ago, because Fritz was not sure about the
whole thing either ...

Very interesting ...

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From schwarte@feat.mathematik.uni-essen.de  Thu Jun 26 15:34:59 1997
From: schwarte@feat.mathematik.uni-essen.de (Heiner Schwarte)
Date: Thu, 26 Jun 1997 15:34:59 +0100 (NFT)
Subject: R-alpha: Problem with gc()
Message-ID: <Pine.A32.3.93.970626153101.3426A-100000@feat.mathematik.uni-essen.de>


Could someone plese confirm the following ?
(AIX 4.1.4, 0.49+patch1+patch2a)

################################################################

schwarte@cauchy:[/home/schwarte]>/usr/local/R-0.49/bin/R

R : Copyright 1997, Robert Gentleman and Ross Ihaka
Version 0.49 Beta (April 23, 1997)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type "license()" for details.

> logical(10)
 [1] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
> gc()
Garbage collection ...
149210 cons cells free (74%)
1820k bytes of heap free (93%)
> logical(10)
 [1]  TRUE FALSE  TRUE FALSE  TRUE FALSE  TRUE FALSE  TRUE FALSE
> logical(10)
 [1]  TRUE FALSE  TRUE FALSE  TRUE FALSE  TRUE FALSE  TRUE FALSE

#################################################################


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Andreas.Weingessel@ci.tuwien.ac.at  Thu Jun 26 14:51:45 1997
From: Andreas.Weingessel@ci.tuwien.ac.at (Andreas Weingessel)
Date: Thu, 26 Jun 1997 15:51:45 +0200
Subject: R-alpha: Problem with gc()
In-Reply-To: <Pine.A32.3.93.970626153101.3426A-100000@feat.mathematik.uni-essen.de>
References: <Pine.A32.3.93.970626153101.3426A-100000@feat.mathematik.uni-essen.de>
Message-ID: <199706261351.PAA00804@elendil.ci.tuwien.ac.at>

>>>>> On Thu, 26 Jun 1997 15:34:59 +0100 (NFT),
>>>>> Heiner Schwarte wrote:

> Could someone plese confirm the following ?
> (AIX 4.1.4, 0.49+patch1+patch2a)

> ################################################################

> schwarte@cauchy:[/home/schwarte]>/usr/local/R-0.49/bin/R

> R : Copyright 1997, Robert Gentleman and Ross Ihaka
> Version 0.49 Beta (April 23, 1997)

> R is free software and comes with ABSOLUTELY NO WARRANTY.
> You are welcome to redistribute it under certain conditions.
> Type "license()" for details.

>> logical(10)
>  [1] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
>> gc()
> Garbage collection ...
> 149210 cons cells free (74%)
> 1820k bytes of heap free (93%)
>> logical(10)
>  [1]  TRUE FALSE  TRUE FALSE  TRUE FALSE  TRUE FALSE  TRUE FALSE
>> logical(10)
>  [1]  TRUE FALSE  TRUE FALSE  TRUE FALSE  TRUE FALSE  TRUE FALSE

> #################################################################


The same on a PC with Linux/Debian-1.3:


R : Copyright 1997, Robert Gentleman and Ross Ihaka
Version 0.49 Beta (April 23, 1997)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type "license()" for details.

R> logical(10)
 [1] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
R>  gc()
Garbage collection ...
142276 cons cells free (71%)
3945k bytes of heap free (96%)
R>  logical(10)
 [1]  TRUE  TRUE  TRUE FALSE FALSE  TRUE  TRUE FALSE  TRUE FALSE
R>  logical(10)
 [1]  TRUE  TRUE  TRUE FALSE  TRUE FALSE  TRUE FALSE  TRUE FALSE
R> 
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ben@eno.Princeton.EDU  Thu Jun 26 15:08:17 1997
From: ben@eno.Princeton.EDU (Ben Bolker)
Date: Thu, 26 Jun 1997 10:08:17 -0400 (EDT)
Subject: R-alpha: Problem with gc()
In-Reply-To: <199706261351.PAA00804@elendil.ci.tuwien.ac.at>
Message-ID: <Pine.SUN.3.95.970626100705.8890A-100000@paca>


  Same on SunOS 4.1.4.

> logical(10)
 [1] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
> gc()
Garbage collection ...
149941 cons cells free (74%)
1821k bytes of heap free (93%)
> logical(10)
 [1]  TRUE FALSE  TRUE FALSE  TRUE FALSE  TRUE FALSE  TRUE FALSE
> 

  Ben

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Thu Jun 26 17:15:27 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 26 Jun 1997 18:15:27 +0200
Subject: R-alpha: lbeta, ctrl-C and crashes
In-Reply-To: Kurt Hornik's message of Thu, 26 Jun 1997 10:51:05 +0200
References: <9706250920.AA11845@alpha.luc.ac.be>
 <Pine.SUN.3.95.970625083652.2283A-100000@zen>
 <199706260536.HAA00517@aragorn.ci.tuwien.ac.at>
 <x23eq5rbz9.fsf@bush.kubism.ku.dk>
 <199706260851.KAA01127@aragorn.ci.tuwien.ac.at>
Message-ID: <x2radppcgw.fsf@bush.kubism.ku.dk>

Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

> > $ ldd R/bin/R.binary 
> >         libSM.so.6 => /usr/X11R6/lib/libSM.so.6.0
> >         libICE.so.6 => /usr/X11R6/lib/libICE.so.6.0
> >         libX11.so.6 => /usr/X11R6/lib/libX11.so.6.1
> >         libf2c.so.0 => /usr/lib/libf2c.so.0.20
> >         libdl.so.1 => /lib/libdl.so.1.7.14
> >         libreadline.so.2 => /usr/lib/libreadline.so.2.0
> >         libtermcap.so.2 => /lib/libtermcap.so.2.0.8
> >         libm.so.5 => /lib/libm.so.5.0.8
> >         libc.so.5 => /lib/libc.so.5.4.23

> hornik@aragorn:~/Work/misc$ ldd /usr/local/lib/R/bin/R.binary 
>         libSM.so.6 => /usr/X11R6/lib/libSM.so.6		(6.0)
>         libICE.so.6 => /usr/X11R6/lib/libICE.so.6	(6.0)
>         libX11.so.6 => /usr/X11R6/lib/libX11.so.6	(6.1)
>         libdl.so.1 => /lib/libdl.so.1			(1.8.10)
>         libreadline.so.2 => /lib/libreadline.so.2	(2.1)
>         libm.so.5 => /lib/libm.so.5			(5.0.8)
>         libc.so.5 => /lib/libc.so.5			(5.4.23)
>         libncurses.so.3.0 => /lib/libncurses.so.3.0	(3.0)
> 
> (I added the full version numbers manually.)
> 
> The obvious difference is that Debian uses ncurses instead of termcap.
> 

Another obvious difference is libreadline2.*1*. I just tried compiling
without readline (edit src/include/Platform.h ; make clean ; make) and
the problem disappeared. However, RedHat still seems to be shipping
libreadline2.0 There are calls to signal() in libreadline, so it
could well be the culprit.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Thu Jun 26 17:28:31 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Thu, 26 Jun 1997 09:28:31 -0700 (PDT)
Subject: R-alpha: lbeta, ctrl-C and crashes
In-Reply-To: <x23eq5rbz9.fsf@bush.kubism.ku.dk>
Message-ID: <Pine.SUN.3.95.970626092741.2845B-100000@zen>

On 26 Jun 1997, Peter Dalgaard BSA wrote:

> This is strange. What libs are used by Debian? And on Thomas' system?
buffy% ldd /biostat/server2/r/linux/R-0.49/bin/R.binary 
        libSM.so.6 => /usr/X11R6/lib/libSM.so.6
        libICE.so.6 => /usr/X11R6/lib/libICE.so.6
        libX11.so.6 => /usr/X11R6/lib/libX11.so.6
        libdl.so.1 => /lib/libdl.so.1
        libreadline.so.2 => /lib/libreadline.so.2
        libm.so.5 => /lib/libm.so.5
        libc.so.5 => /lib/libc.so.5
        libncurses.so.3.0 => /lib/libncurses.so.3.0
buffy% uname -a
Linux buffy 2.0.27 #1 Fri Jan 10 23:46:22 MET 1997 i686 unknown




Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Thu Jun 26 18:23:02 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 26 Jun 1997 19:23:02 +0200
Subject: R-alpha: lbeta, ctrl-C and crashes
In-Reply-To: Peter Dalgaard BSA's message of 26 Jun 1997 18:15:27 +0200
References: <9706250920.AA11845@alpha.luc.ac.be>
 <Pine.SUN.3.95.970625083652.2283A-100000@zen>
 <199706260536.HAA00517@aragorn.ci.tuwien.ac.at>
 <x23eq5rbz9.fsf@bush.kubism.ku.dk>
 <199706260851.KAA01127@aragorn.ci.tuwien.ac.at>
 <x2radppcgw.fsf@bush.kubism.ku.dk>
Message-ID: <x2oh8tp9c9.fsf@bush.kubism.ku.dk>

Peter Dalgaard BSA <p.dalgaard@kubism.ku.dk> writes:

> Another obvious difference is libreadline2.*1*. I just tried compiling
> without readline (edit src/include/Platform.h ; make clean ; make) and
> the problem disappeared. However, RedHat still seems to be shipping
> libreadline2.0 There are calls to signal() in libreadline, so it
> could well be the culprit.

Affirmative. Problem vanished when relinking with a freshly compiled
libreadline.a v.2.1. But there's nothing in the ChangeLog relating to
signal handling bugs fixed since 2.0, so it might be a question of
simply recompiling the library. This would be preferable since it can
be done with the rpm command. Will check later, time to buy dinner
before the shop closes...

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Thu Jun 26 22:55:08 1997
From: ihaka@stat.auckland.ac.nz (Ross &)
Date: Fri, 27 Jun 1997 09:55:08 +1200 (NZST)
Subject: R-alpha: lbeta, .. etc
In-Reply-To: <199706260603.IAA00927@aragorn.ci.tuwien.ac.at>
References: <9706250920.AA11845@alpha.luc.ac.be>
 <199706250930.LAA05653@sophie.ethz.ch>
 <199706260603.IAA00927@aragorn.ci.tuwien.ac.at>
Message-ID: <199706262155.JAA18490@stat1.stat.auckland.ac.nz>

Kurt Hornik writes:
 > Actually, I must have missed that patch, too.  I'll rebuild my Debian
 > packages right away ...
 > 
 > Re official versus non-official patches.  What I could do is put all
 > patches that were posted on r-devel and look reasonable into CRAN (e.g.,
 > src/patches).  However, R&R will probably not be too happy about the
 > existence of unofficial patches ...

[ With great effort, raises self from death-bed ... ]

I have a heap of stuff "ready to go".  It has been for several weeks,
but various disasters have intervened.  I hope to have a new version
out on monday.  Luke Tierney is visiting for a bit after that and so
there will be other priorities ...


I would like to start a discussion on widening the group of people who
can commit changes to R and create new releases (although maybe new
releases are a one-man job).  At present, the "core group" (those who
can commit changes to the CVS tree) consists of Robert, Martin
Maechler and Myself.  I think it would be feasible to enlarge this
group to perhaps 6 or 7.

At the same time we could open up  the update process so that any
can choose to be on the "bleeding edge".  This is the mechanism which
is used in FreeBSD development, and I think it has proved a good
model.  The necessary software (cvsup) is also pretty readily available.

For those who want stability, there is a twice yearly "stable"
release, and for those who want to suffer, they can have it as
"up-to-date" as they can stand by grabbing the current cvs archive.

Any thoughts?
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Fri Jun 27 07:21:35 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Fri, 27 Jun 1997 08:21:35 +0200
Subject: R-alpha: lbeta, ctrl-C and crashes
In-Reply-To: <x2oh8tp9c9.fsf@bush.kubism.ku.dk>
References: <9706250920.AA11845@alpha.luc.ac.be>
 <Pine.SUN.3.95.970625083652.2283A-100000@zen>
 <199706260536.HAA00517@aragorn.ci.tuwien.ac.at>
 <x23eq5rbz9.fsf@bush.kubism.ku.dk>
 <199706260851.KAA01127@aragorn.ci.tuwien.ac.at>
 <x2radppcgw.fsf@bush.kubism.ku.dk>
 <x2oh8tp9c9.fsf@bush.kubism.ku.dk>
Message-ID: <199706270621.IAA01683@aragorn.ci.tuwien.ac.at>

>>>>> Peter Dalgaard BSA writes:

> Peter Dalgaard BSA <p.dalgaard@kubism.ku.dk> writes:
>> Another obvious difference is libreadline2.*1*. I just tried compiling
>> without readline (edit src/include/Platform.h ; make clean ; make) and
>> the problem disappeared. However, RedHat still seems to be shipping
>> libreadline2.0 There are calls to signal() in libreadline, so it
>> could well be the culprit.

> Affirmative. Problem vanished when relinking with a freshly compiled
> libreadline.a v.2.1. But there's nothing in the ChangeLog relating to
> signal handling bugs fixed since 2.0, so it might be a question of
> simply recompiling the library. This would be preferable since it can
> be done with the rpm command. Will check later, time to buy dinner
> before the shop closes...

I see.  That might also explain our confusion when we noticed that we
cannot reproduce the CTRL-C problem.  We just upgraded to Debian 1.3
which has libreadline 2.1.

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Fri Jun 27 07:33:35 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Fri, 27 Jun 1997 08:33:35 +0200
Subject: R-alpha: lbeta, .. etc
In-Reply-To: <199706262155.JAA18490@stat1.stat.auckland.ac.nz>
References: <9706250920.AA11845@alpha.luc.ac.be>
 <199706250930.LAA05653@sophie.ethz.ch>
 <199706260603.IAA00927@aragorn.ci.tuwien.ac.at>
 <199706262155.JAA18490@stat1.stat.auckland.ac.nz>
Message-ID: <199706270633.IAA01692@aragorn.ci.tuwien.ac.at>

>>>>> Ross & writes:

> Kurt Hornik writes:
>> Actually, I must have missed that patch, too.  I'll rebuild my Debian
>> packages right away ...
>> 
>> Re official versus non-official patches.  What I could do is put all
>> patches that were posted on r-devel and look reasonable into CRAN (e.g.,
>> src/patches).  However, R&R will probably not be too happy about the
>> existence of unofficial patches ...

> [ With great effort, raises self from death-bed ... ]

> I have a heap of stuff "ready to go".  It has been for several weeks,
> but various disasters have intervened.  I hope to have a new version
> out on monday.  

Oh boy, do I wish it was Monday already ...

> Luke Tierney is visiting for a bit after that and so there will be
> other priorities ...

(Or try to get Luke involved in the R development ...)

> I would like to start a discussion on widening the group of people who
> can commit changes to R and create new releases (although maybe new
> releases are a one-man job).  At present, the "core group" (those who
> can commit changes to the CVS tree) consists of Robert, Martin
> Maechler and Myself.  I think it would be feasible to enlarge this
> group to perhaps 6 or 7.

(I also treat all patches sent by R&R and Martin as `official', and
apply them asap.)

> At the same time we could open up the update process so that any can
> choose to be on the "bleeding edge".  This is the mechanism which is
> used in FreeBSD development, and I think it has proved a good model.
> The necessary software (cvsup) is also pretty readily available.

> For those who want stability, there is a twice yearly "stable"
> release, and for those who want to suffer, they can have it as
> "up-to-date" as they can stand by grabbing the current cvs archive.

> Any thoughts?

For e.g. Linux, libc, Octave, ... there are two versions, the ones with
even minors are stable releases changed only for bug fixes, the ones
with odd minors are `unstable' development versions which may change
very often.  So e.g., we could start with

	R-0.6		next stable release
	R-0.7		new development tree

I have no experience with situtations where several people can manage
the source tree.  It is perhaps easier to have one person in charge of
that.  On the other hand, obvious cleanups in the interpreted code or in
the documentation do not really require a central authority ...

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Fri Jun 27 11:32:27 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 27 Jun 1997 12:32:27 +0200
Subject: R-alpha: lbeta, ctrl-C and crashes
In-Reply-To: Peter Dalgaard BSA's message of 26 Jun 1997 19:23:02 +0200
References: <9706250920.AA11845@alpha.luc.ac.be>
 <Pine.SUN.3.95.970625083652.2283A-100000@zen>
 <199706260536.HAA00517@aragorn.ci.tuwien.ac.at>
 <x23eq5rbz9.fsf@bush.kubism.ku.dk>
 <199706260851.KAA01127@aragorn.ci.tuwien.ac.at>
 <x2radppcgw.fsf@bush.kubism.ku.dk> <x2oh8tp9c9.fsf@bush.kubism.ku.dk>
Message-ID: <x2en9oibes.fsf@bush.kubism.ku.dk>

Peter Dalgaard BSA <p.dalgaard@kubism.ku.dk> writes:

> > the problem disappeared. However, RedHat still seems to be shipping
> > libreadline2.0 There are calls to signal() in libreadline, so it
> > could well be the culprit.
> 
> Affirmative. Problem vanished when relinking with a freshly compiled
> libreadline.a v.2.1. But there's nothing in the ChangeLog relating to
> signal handling bugs fixed since 2.0, so it might be a question of
> simply recompiling the library.... 

Not so, I'm afraid. There definitely have been changes to signals.c
and recompile doesn't change a thing. Time to push RedHat to make an
upgraded .rpm, I think. They've got a contributed one in
.../contrib/i386 already, I see. 

Hmm. The silly thing installs as libreadline.so.3.0. I wonder what the
point of that is... Means that you have to recompile R to make it use
the new library, but it does seem to work now.

BTW, do we have place to keep these installation related problems, so
that we won't have to answer them over and over again? We had a
similar item with the f2c library setup earlier and C compiler options
on. A series of README.linux, README.hpux, etc. files might do it
(model xfree).

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Fri Jun 27 11:32:50 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Fri, 27 Jun 1997 12:32:50 +0200
Subject: R-alpha: lbeta, ctrl-C and crashes
In-Reply-To: <x2en9oibes.fsf@bush.kubism.ku.dk>
References: <9706250920.AA11845@alpha.luc.ac.be>
 <Pine.SUN.3.95.970625083652.2283A-100000@zen>
 <199706260536.HAA00517@aragorn.ci.tuwien.ac.at>
 <x23eq5rbz9.fsf@bush.kubism.ku.dk>
 <199706260851.KAA01127@aragorn.ci.tuwien.ac.at>
 <x2radppcgw.fsf@bush.kubism.ku.dk>
 <x2oh8tp9c9.fsf@bush.kubism.ku.dk>
 <x2en9oibes.fsf@bush.kubism.ku.dk>
Message-ID: <199706271032.MAA02229@aragorn.ci.tuwien.ac.at>

>>>>> Peter Dalgaard BSA writes:

> Peter Dalgaard BSA <p.dalgaard@kubism.ku.dk> writes:
>> > the problem disappeared. However, RedHat still seems to be shipping
>> > libreadline2.0 There are calls to signal() in libreadline, so it
>> > could well be the culprit.
>> 
>> Affirmative. Problem vanished when relinking with a freshly compiled
>> libreadline.a v.2.1. But there's nothing in the ChangeLog relating to
>> signal handling bugs fixed since 2.0, so it might be a question of
>> simply recompiling the library.... 

> Not so, I'm afraid. There definitely have been changes to signals.c
> and recompile doesn't change a thing. Time to push RedHat to make an
> upgraded .rpm, I think. They've got a contributed one in
> .../contrib/i386 already, I see. 

> Hmm. The silly thing installs as libreadline.so.3.0. I wonder what the
> point of that is... Means that you have to recompile R to make it use
> the new library, but it does seem to work now.

> BTW, do we have place to keep these installation related problems, so
> that we won't have to answer them over and over again? We had a
> similar item with the f2c library setup earlier and C compiler options
> on. A series of README.linux, README.hpux, etc. files might do it
> (model xfree).

Great idea!

I was already thinking about adding something to the FAQ, but a pointer
to the README.$platform files is better.

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Fri Jun 27 14:20:13 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 27 Jun 1997 15:20:13 +0200
Subject: R-alpha: lbeta, ctrl-C and crashes
In-Reply-To: Peter Dalgaard BSA's message of 27 Jun 1997 12:32:27 +0200
References: <9706250920.AA11845@alpha.luc.ac.be>
 <Pine.SUN.3.95.970625083652.2283A-100000@zen>
 <199706260536.HAA00517@aragorn.ci.tuwien.ac.at>
 <x23eq5rbz9.fsf@bush.kubism.ku.dk>
 <199706260851.KAA01127@aragorn.ci.tuwien.ac.at>
 <x2radppcgw.fsf@bush.kubism.ku.dk> <x2oh8tp9c9.fsf@bush.kubism.ku.dk>
 <x2en9oibes.fsf@bush.kubism.ku.dk>
Message-ID: <x2bu4si3n6.fsf@bush.kubism.ku.dk>

Peter Dalgaard BSA <p.dalgaard@kubism.ku.dk> writes:

> similar item with the f2c library setup earlier and C compiler options
> on. A series of README.linux, README.hpux, etc. files might do it
   / HP-UX

[Ugh. Victim of my "scatter/gather" writing style.]

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Friedrich.Leisch@ci.tuwien.ac.at  Fri Jun 27 15:29:58 1997
From: Friedrich.Leisch@ci.tuwien.ac.at (Friedrich Leisch)
Date: Fri, 27 Jun 1997 16:29:58 +0200
Subject: R-alpha: NA in data frame not detected
Message-ID: <199706271429.QAA05649@galadriel.ci.tuwien.ac.at>


NA's in a data frame are not handled properly, if the data frame was
read in using read.table (but I'm not sure if that is the reason of
the problems):

(I'm using Debian Linux 1.3)

If I read the file

***************
1 2
2 3
3 4
4 5
? 6
6 7
7 8
8 9
***************

into R using read.table I run into troubles:

R : Copyright 1997, Robert Gentleman and Ross Ihaka
Version 0.49 Beta (April 23, 1997)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type "license()" for details.

R> x<-read.table("xxx", na.strings=3D"?")
R> x
  V1 V2
1  1  2
2  2  3
3  3  4
4  4  5
5 NA  6
6  6  7
7  7  8
8  8  9
R> complete.cases(x)
[1] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE
R> x$V1
[1]  1  2  3  4 NA  6  7  8
R> x$V1[5]
[1] NA
R> is.na(x$V1[5])
[1] FALSE


but if I create the same dataframe in R I get the expected results:

R> z<-data.frame(V1=3Dc(1:4, NA, 6:8), y2=3D2:9)
R> z
     V1 y2
[1,]  1  2
[2,]  2  3
[3,]  3  4
[4,]  4  5
[5,] NA  6
[6,]  6  7
[7,]  7  8
[8,]  8  9
R> complete.cases(z)
[1]  TRUE  TRUE  TRUE  TRUE FALSE  TRUE  TRUE  TRUE
R> is.na(z$V1[5])
[1] TRUE




Can anybody confirm this?

--=20
-------------------------------------------------------------------
                        Friedrich  Leisch                            =20
Institut f=FCr Statistik                      Tel: (+43 1) 58801 4541
Technische Universit=E4t Wien                 Fax: (+43 1)  504 14 98
Wiedner Hauptstra=DFe 8-10/1071      Friedrich.Leisch@ci.tuwien.ac.at
A-1040 Wien, Austria             http://www.ci.tuwien.ac.at/~leisch
     PGP public key http://www.ci.tuwien.ac.at/~leisch/pgp.key
-------------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From schwarte@feat.mathematik.uni-essen.de  Fri Jun 27 20:46:40 1997
From: schwarte@feat.mathematik.uni-essen.de (Heiner Schwarte)
Date: Fri, 27 Jun 1997 20:46:40 +0100 (NFT)
Subject: R-alpha: Re: Problem with gc()
In-Reply-To: <Pine.A32.3.93.970626153101.3426A-100000@feat.mathematik.uni-essen.de>
Message-ID: <Pine.A32.3.93.970627203823.15230B-100000@feat.mathematik.uni-essen.de>

Yesterday I posted a problem with logical() after a gc().

This problem occurs because do_makevector() in the file
builtin.c does not properly initialize the memory if a 
vector of logicals is manufactured. Simply adding an 
initialization  loop solves the problem. ( Following 
line 333 one finds  the initialization for INTSXP and 
REALSXP. Add one for LGLSXP.)

Heiner

  

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Fri Jun 27 20:21:29 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Fri, 27 Jun 1997 12:21:29 -0700 (PDT)
Subject: R-alpha: NA in data frame not detected
In-Reply-To: <199706271429.QAA05649@galadriel.ci.tuwien.ac.at>
Message-ID: <Pine.SUN.3.95.970627101809.3355E-100000@zen>

On Fri, 27 Jun 1997, Friedrich Leisch wrote:

> 
> NA's in a data frame are not handled properly, if the data frame was
> read in using read.table (but I'm not sure if that is the reason of
> the problems):
> 

The problem is with the na.strings argument of read.table.  If you use
this argument anything with an NA ends up as a factor. In your example the
first column is a factor (though you can't tell by looking at it)
> is.factor(x[,1])
[1] TRUE
> levels(x[,1])
[1] "1"  "2"  "3"  "4"  "6"  "7"  "8"  "NA"
>

The reason is that read.table tries to handle na.strings twice.  The
scan() function gets the na.strings argument and so translates the "?"
into "NA".  The type.convert() function then also gets the na.strings
argument and thinks that NAs are indicated by "?" which is no longer
true. It then decides that the data are not numeric and returns a factor.

The solution seems to be to stop passing na.strings to type.convert(). We
need to keep na.strings in scan() to allow for missing character data.

A patch is at the end of this message. This may break something else,
of course ;-).

Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

*** read.table.rnew	Fri Jun 27 11:26:15 1997
--- read.table.orig	Fri Jun 27 11:21:20 1997
***************
*** 56,66 ****
          if (length(as.is) != cols) 
                  stop("as.is has the wrong length")
          for (i in 1:cols) {
!                 if (!as.is[i]) {
! 			 data[[i]]<-type.convert(data[[i]])
! #                        data[[i]] <- type.convert(data[[i]], 
! #                                na.strings = na.strings)
! 			}
          }
          #  now we determine row names
          if (missing(row.names)) {
--- 56,64 ----
          if (length(as.is) != cols) 
                  stop("as.is has the wrong length")
          for (i in 1:cols) {
!                 if (!as.is[i]) 
!                         data[[i]] <- type.convert(data[[i]], 
!                                 na.strings = na.strings)
          }
          #  now we determine row names
          if (missing(row.names)) {

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Jun  2 06:19:11 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 2 Jun 1997 07:19:11 +0200
Subject: R-alpha: tapply bug
Message-ID: <199706020519.HAA01997@aragorn.ci.tuwien.ac.at>

There is a problem with tapply() in the case where INDEX is a factor
with at least one of its levels not occurring in it.

In this case,
	namelist[[i]] <- levels(index)
gets all levels but
	group <- group + ngroup * (codes(index) - 1)
only those occurring in index, which subsequently causes
	names(ans) <- namelist[[1]]
to fail.

For example,

R> f <- factor(c("a", "a", "b"), levels = letters[1:3])
R> f
[1] a a b
R> codes(f)
[1] 1 1 2
R> levels(f)
[1] "a" "b" "c"

which gives e.g.

R> tapply(rep(1, length(f)), f, sum)
Error: names attribute must be the same length as the vector

One solution is to replace

	namelist[[i]] <- levels(index)

by

	namelist[[i]] <- unique(levels(index)[index])

but perhaps there is something smarter ...

-k

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Mon Jun  2 08:31:42 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Mon, 2 Jun 97 09:31:42 +0200
Subject: R-alpha: plot(1); axis(1, at=10) >>> Seg.fault  -- and a patch
In-Reply-To: <199706020519.HAA01989@aragorn.ci.tuwien.ac.at> (message from
 Kurt Hornik on Mon, 2 Jun 1997 07:19:10 +0200)
Message-ID: <9706020731.AA00382@>

The patched version of  axis(..) which I "seemed" to post here  a while ago,
accidentally was the 0.49 original -- oh dear ! -- S_O_R_R_Y!

Here is the 'real' one:

M> This problem has been mentioned  by Arne Kovac <maak@stats.bris.ac.uk>
M> on May 9-10. 
M> The patch is really a replacement of 'axis' in  RHOME/src/library/base/funs/

M> It contains the fixes which where proposed Arne Kovac
M> and fixes all the errors he reported on May 9.

"axis" <-
function (which, at, labels = TRUE, ...) 
{
	if (which%%2 == 1) {
		axp <- par("xaxp")
		usr <- par("usr")[1:2]
		log <- par("xlog")
	} else {
		axp <- par("yaxp")
		usr <- par("usr")[3:4]
		log <- par("ylog")
	}
	ind <-
	  if (missing(at)) {
	    at <-
	      if (log) {
		if (usr[2] < usr[1] + 1) {
		  seq(axp[1], axp[2], length = axp[3] + 1)
		} else {
		  p1 <- ceiling(min(usr))
		  p2 <- floor(max(usr))
		  if (p2 - p1 < 2) {
		    at <- c(1, 2, 5) * 10^rep(p1:p2, rep(3, p2 - p1 + 1))
		    at[10^usr[1] <= at & at < 10^usr[2]]
		  }
		  else 10^seq(p1, p2, by = 1)
		}
	      } else seq(axp[1], axp[2], length = axp[3] + 1)
	    rep(TRUE, length(at))
	  } else {
	    at <- sort(at)
	    if (log) (10^usr[1] <= at & at <= 10^usr[2])
	    else     (	 usr[1] <= at & at <=	 usr[2])
	  }
	if(any(ind)) {
	  labels <-
	    if (is.logical(labels)) {
	      if (labels) {
		if (!log) 
		  at[abs(at/(max(at) - min(at))) < 0.001] <- 0
		format(at, trim = T)
	      }
	      else rep("", length(at))
	    } else format(labels, trim = T)
	  .Internal(axis(which, as.double(at[ind]), labels[ind], ...))
	} else warning("axis: Couldn't draw anything; maybe 'at' out of range.")
}

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Jun  2 10:57:16 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 2 Jun 1997 11:57:16 +0200
Subject: R-alpha: S doc -> R doc
Message-ID: <199706020957.LAA08243@aragorn.ci.tuwien.ac.at>

Attached is the current version of my sd2rd perl script.  It has passed
tests by Martin, Fritz and myself, and seems to work reasonably well (it
should get the arguments lists right, distinguish between VALUE and
VALUES, and know about REFERENCES and SEEALSO).

Any comments etc are most welcome.

-k

************************************************************************
#!/usr/bin/perl -w

$\ = "\n";

$parenLevel = 0;
$doprint = 1;
$needArg = 1;
$needVal = 0;
$output = "";

while (<>) {
    chop;
    &substitute;
    @word = split;

    if (/^[^.]/) { &output($_); }

    if (/^\.AG/) {
	if ($needArg) {
	    &section(0, "ARGUMENTS(");
	    $needArg = 0;
	}
	&section(1, "ARG($word[1] @@");
    }
    if (/^\.CS/) { &section(0, "USAGE("); }
    if (/^\.DN/) { $doprint = 0; }
    if (/^\.DT/) { &section(0, "DESCRIPTION("); }
    if (/^\.EX/) { &section(0, "EXAMPLES("); }
    if (/^\.FN/) { $fun = $word[1]; }
    if (/^\.(IP|PP)/) { output("PARA"); }
    if (/^\.RC/) {
	if ($needVal) {
	    $needVal = 0;	    
	    &section(0, "VALUES(\n$output\n@@");
	    $doprint = 1;
	}
	&section(1, "ARG($word[1] @@");
    }
    if (/^\.RT/) {
	$needVal = 1;
	$doprint = 0;
	$output = "";
    }
    if (/^\.SA/) { &section(0, "SEEALSO("); }
    if (/^\.SE/) { &paragraph("SIDE EFFECTS"); }
    if (/^\.SH/) {
	if ($word[1] =~ /REFERENCE/) {
	    &section(0, "REFERENCES(");
	} else {
	    &paragraph($word[1]);
	}
    }
    if (/^\.sp/) { output("BLANK"); }
    if (/^\.TL/) { &section(0, "TITLE($fun @@"); }
    if (/^\.WR/) { &section(0, ""); }

    if (/^\.AO/) {
	output("Arguments for function LANG($word[1]()) can also be");
	output("supplied to this function.");
    }
    if (/^\.GE/) {
	output("This is a generic function.");
	output("Functions with names beginning in LANG($fun.) will be");
	output("methods for this function.");
    }
    if (/^\.GR/) {
	output("Graphical parameters (see LANG(par())) may also be");
	output("supplied as arguments to this function.");
    }
    if (/^\.ME/) {
	output("This function is a method for the generic function");
	output("LANG($word[1]()) for class LANG($word[2]).");
	output("It can be invoked by calling LANG($word[1](x)) for an");
	output("object LANG(x) of the appropriate class, or directly by");
	output("calling LANG($word[1].$word[2](x)) regardless of the");
	output("class of the object.");
    }
    if (/^\.NA/) { output("Missing values (LANG(NA)s) are allowed."); }
    if (/^\.Tl/) {
	output("In addition, the high-level graphics control arguments");
	output("described under LANG(par()) and the arguments to");
	output("LANG(title()) may be supplied to this function.");
    }
}

sub substitute {
    s/\\fB/BOLD\(/g;
    s/\\fR/\)/g;
    s/\.\.\./DOTS/g;
}

sub section {
    local($level, $text) = @_;
    $n = $parenLevel - $level;
    print(")" x $n) if ($n > 0);
    if ($needVal) {
	print("VALUE(\n$output\n)");
	$needVal = 0;
    }
    print("$text") if $text;    
    $parenLevel = $level + 1;
    $doprint = 1;
}

sub paragraph {
    local($name) = @_;
    &output("PARA\nBOLD($name): ");
}
    
sub output {
    local($text) = @_;
    if ($doprint) {
	print($text);
    } elsif ($output) {
	$output .= "\n$text";
    } else {
	$output = $text;
    }
}
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Mon Jun  2 18:44:36 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Mon, 2 Jun 1997 10:44:36 -0700 (PDT)
Subject: R-alpha: S doc -> R doc
In-Reply-To: <199706020957.LAA08243@aragorn.ci.tuwien.ac.at>
Message-ID: <Pine.SUN.3.95.970602104156.955C-100000@zen>

On Mon, 2 Jun 1997, Kurt Hornik wrote:

> Attached is the current version of my sd2rd perl script.  It has passed
> tests by Martin, Fritz and myself, and seems to work reasonably well (it
> should get the arguments lists right, distinguish between VALUE and
> VALUES, and know about REFERENCES and SEEALSO).
> 
> Any comments etc are most welcome.


Very nice.  A more advanced feature (which I completely gave up on) would
be hyperlinking the SEE ALSO section (i.e. 

.SA
foo, bar
 should translate to
SEEALSO(
LANG(LINK(foo)), LANG(LINK(bar))
)



Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Tue Jun  3 07:40:52 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 3 Jun 1997 08:40:52 +0200
Subject: R-alpha: cov.mve
Message-ID: <199706030640.IAA11973@aragorn.ci.tuwien.ac.at>

Is there public domain code for cov.mve?
Thanks,
-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Jun  3 08:18:19 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 3 Jun 97 09:18:19 +0200
Subject: R-alpha:  cov.mve  &  lmsreg -- "minvol" and "progress" @ statlib
In-Reply-To: <199706030640.IAA11973@aragorn.ci.tuwien.ac.at> (message from
 Kurt Hornik on Tue, 3 Jun 1997 08:40:52 +0200)
Message-ID: <9706030718.AA00848@>

[CC to some relevant 'robustniks' and the author of the software;
   read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html  to learn more about R]

>>>>> "Kurt" == Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

    Kurt> Is there public domain code for cov.mve?  

"Yes", the biggest part of it,  aka "minvol"  is made freely available by
by its author, Peter Rousseeuw. It's in Statlib   general/minvol

The same is true for  'lmsreg'  which I am even more eager to see in R;
the basic program is called  "progress".

Note: There is an (fairly unknown)  Statlib mirror in Europe

	  ftp://unix.hensa.ac.uk/mirrors/statlib/

The 2 robust statistics contributions of  Rousseeuw  are thus

	  ftp://unix.hensa.ac.uk/mirrors/statlib/general/minvol
	  ftp://unix.hensa.ac.uk/mirrors/statlib/general/progress

Martin Maechler <maechler@stat.math.ethz.ch>		 <><
Seminar fuer Statistik, SOL G1
ETH (Federal Inst. Technology)	8092 Zurich	 SWITZERLAND
phone: x-41-1-632-3408		fax: ...-1086
http://www.stat.math.ethz.ch/~maechler/
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From rousse@uia.ua.ac.be  Tue Jun  3 08:34:46 1997
From: rousse@uia.ua.ac.be (Peter.Rousseeuw)
Date: Tue, 3 Jun 1997 09:34:46 +0200
Subject: R-alpha:  cov.mve  &  lmsreg -- "minvol" and "progress" @ statlib
Message-ID: <9706030734.AA22999@hwins.uia.ac.be>

Dear colleagues,

actually, more recent versions of PROGRESS and MINVOL than those in
Statlib can be fetched from our website

         http://win-www.uia.ac.be/u/statis

With friendly greetings,

Peter
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Tue Jun  3 13:54:00 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 3 Jun 1997 14:54:00 +0200
Subject: R-alpha: rd2sd v0.1
Message-ID: <199706031254.OAA13309@aragorn.ci.tuwien.ac.at>

Here is an updated version of the S doc -> R doc script.  New features
are automatic conversion of `xxx' to LANG(xxx) or LANG(LINK(xxx)) in
SEEALSO sections, respectively (thanks to Martin and Thomas for the
suggestions).

The keywords are saved as comments, and can easily be used as soon as
keywords are supported.

As usual, any feedback ...

-k

**********************************************************************
#!/usr/bin/perl -w

$VERSION = "0.1";

$\ = "\n";

$parenLevel = 0;
$doprint = 1;
$needArg = 1;
$needVal = 0;
$seealso = 0;
$output = "";

while (<>) {
    chop;
    &substitute;
    @word = split;

    if (/^[^.]/) { &output($_); }

    if (/^\.AG/) {
	if ($needArg) {
	    &section(0, "ARGUMENTS(");
	    $needArg = 0;
	}
	&section(1, "ARG($word[1] @@");
    }
    if (/^\.CS/) { &section(0, "USAGE("); }
    if (/^\.DN/) { $doprint = 0; }
    if (/^\.DT/) { &section(0, "DESCRIPTION("); }
    if (/^\.EX/) { &section(0, "EXAMPLES("); }
    if (/^\.FN/) { $fun = $word[1]; }
    if (/^\.(IP|PP)/) { &output("PARA"); }
    if (/^\.KW/) { 
	if ($parenLevel > 0) {
	    &section(0, "");
	    $parenLevel = 0;
	}
	&output("COMMENT(KEYWORD($word[1]))");
    }
    if (/^\.RC/) {
	if ($needVal) {
	    $needVal = 0;	    
	    &section(0, "VALUES(\n$output\n@@");
	    $doprint = 1;
	}
	&section(1, "ARG($word[1] @@");
    }
    if (/^\.RT/) {
	$needVal = 1;
	$doprint = 0;
	$output = "";
    }
    if (/^\.SA/) {
	&section(0, "SEEALSO(");
	$seealso = 1;
    }
    if (/^\.SE/) { &paragraph("SIDE EFFECTS"); }
    if (/^\.SH/) {
	if ($word[1] =~ /REFERENCE/) {
	    &section(0, "REFERENCES(");
	} else {
	    &paragraph($word[1]);
	}
    }
    if (/^\.sp/) { output("BLANK"); }
    if (/^\.TL/) { &section(0, "TITLE($fun @@"); }
    if (/^\.WR/) {
	&section(0, "");
	print("COMMENT(Converted by sd2rd version $VERSION.)");
    }

    if (/^\.AO/) {
	output("Arguments for function LANG($word[1]()) can also be");
	output("supplied to this function.");
    }
    if (/^\.GE/) {
	output("This is a generic function.");
	output("Functions with names beginning in LANG($fun.) will be");
	output("methods for this function.");
    }
    if (/^\.GR/) {
	output("Graphical parameters (see LANG(LINK(par)) may also be");
	output("supplied as arguments to this function.");
    }
    if (/^\.ME/) {
	output("This function is a method for the generic function");
	output("LANG($word[1]()) for class LANG($word[2]).");
	output("It can be invoked by calling LANG($word[1](x)) for an");
	output("object LANG(x) of the appropriate class, or directly by");
	output("calling LANG($word[1].$word[2](x)) regardless of the");
	output("class of the object.");
    }
    if (/^\.NA/) { output("Missing values (LANG(NA)s) are allowed."); }
    if (/^\.Tl/) {
	output("In addition, the high-level graphics control arguments");
	output("described under LANG(LINK(par)) and the arguments to");
	output("LANG(LINK(title)) may be supplied to this function.");
    }
}

sub substitute {
    s/\\fB/BOLD\(/g;
    s/\\fR/\)/g;
    s/\.\.\./DOTS/g;
    if ($seealso) {
	s/\`([^\']*)\'/LANG(LINK($1))/g;
    } else {
	s/\`([^\']*)\'/LANG($1)/g;
    }
}

sub section {
    local($level, $text) = @_;
    $n = $parenLevel - $level;
    print(")" x $n) if ($n > 0);
    if ($needVal) {
	print("VALUE(\n$output\n)");
	$needVal = 0;
    }
    print("$text") if $text;    
    $parenLevel = $level + 1;
    $doprint = 1;
    $seealso = 0;
}

sub paragraph {
    local($name) = @_;
    &output("PARA\nBOLD($name): ");
}
    
sub output {
    local($text) = @_;
    if ($doprint) {
	print($text);
    } elsif ($output) {
	$output .= "\n$text";
    } else {
	$output = $text;
    }
}
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Tue Jun  3 15:45:11 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 3 Jun 1997 16:45:11 +0200
Subject: R-alpha: unif_rand() again
Message-ID: <199706031445.QAA13652@aragorn.ci.tuwien.ac.at>

Just out of curiosity, here is a question that might be embarrasingly
stupid.  Hmm ...

What I need is to call runif() (more precisely, `runif(1, 0, 1)') from
inside a C function.  Is this possible using call_S?  If so, how?

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Tue Jun  3 16:14:09 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 03 Jun 1997 17:14:09 +0200
Subject: R-alpha: unif_rand() again
In-Reply-To: Kurt Hornik's message of Tue, 3 Jun 1997 16:45:11 +0200
References: <199706031445.QAA13652@aragorn.ci.tuwien.ac.at>
Message-ID: <x2yb8r4t31.fsf@bush.kubism.ku.dk>

Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

> 
> Just out of curiosity, here is a question that might be embarrasingly
> stupid.  Hmm ...
> 
> What I need is to call runif() (more precisely, `runif(1, 0, 1)') from
> inside a C function.  Is this possible using call_S?  If so, how?

Hmm ... Stupid counter-question: Did you study the zfun() function in
$RHOME/demos/dynload/zero.c ? Looks pretty straightforward to me,
except that I have no offhand guess what the 0L argument to call_S is
good for. Peeking at the source should cure that.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Tue Jun  3 16:17:29 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 3 Jun 1997 17:17:29 +0200
Subject: R-alpha: unif_rand() again
In-Reply-To: <x2yb8r4t31.fsf@bush.kubism.ku.dk>
References: <199706031445.QAA13652@aragorn.ci.tuwien.ac.at>
 <x2yb8r4t31.fsf@bush.kubism.ku.dk>
Message-ID: <199706031517.RAA13734@aragorn.ci.tuwien.ac.at>

>>>>> Peter Dalgaard BSA writes:

> Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:
>> 
>> Just out of curiosity, here is a question that might be embarrasingly
>> stupid.  Hmm ...
>> 
>> What I need is to call runif() (more precisely, `runif(1, 0, 1)') from
>> inside a C function.  Is this possible using call_S?  If so, how?

> Hmm ... Stupid counter-question: Did you study the zfun() function in
> $RHOME/demos/dynload/zero.c ? Looks pretty straightforward to me,
> except that I have no offhand guess what the 0L argument to call_S is
> good for. Peeking at the source should cure that.

I did.  I hoped that something like

static char *func = "runif";

double unif_rand() {
  void *in[3];
  char *modes[] = { "integer", "integer", "integer" };
  long lengths[] = { 1, 1, 1 };  
  void *out[1];
  double *result;

  in[0] = (void *)1L;
  in[1] = (void *)0L;
  in[2] = (void *)1L;  
  call_S((void *)func, 3L, in, modes, lengths, 0L, 1L, out);
  result = (double *)out[0];
  return(result[0]);
}

might work, but it does not ...

-k


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Andreas.Weingessel@ci.tuwien.ac.at  Tue Jun  3 16:24:11 1997
From: Andreas.Weingessel@ci.tuwien.ac.at (Andreas Weingessel)
Date: Tue, 3 Jun 1997 17:24:11 +0200
Subject: R-alpha: bug in sum
Message-ID: <199706031524.RAA22384@elendil.ci.tuwien.ac.at>


If the sum of a vector containing NAs is computed and na.rm is FALSE,
the result is not always NA. 

R> w <- c(1:3,NA)
R> sum(w)
[1] NA

BUT

R> w <- c(NA, 1:3)
R> sum(w)
[1] 0

It seems that this problem only occurs, if the first element is NA.

Andreas

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From luke@stat.umn.edu  Tue Jun  3 16:28:37 1997
From: luke@stat.umn.edu (Luke Tierney)
Date: Tue, 3 Jun 1997 10:28:37 -0500 (CDT)
Subject: R-alpha: unif_rand() again
In-Reply-To: <x2yb8r4t31.fsf@bush.kubism.ku.dk> from "Peter Dalgaard BSA" at Jun 3, 97 05:14:09 pm
Message-ID: <9706031528.AA15627@nokomis.stat.umn.edu>

Peter Dalgaard BSA wrote:
> 
> Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:
> 
> > 
> > Just out of curiosity, here is a question that might be embarrasingly
> > stupid.  Hmm ...
> > 
> > What I need is to call runif() (more precisely, `runif(1, 0, 1)') from
> > inside a C function.  Is this possible using call_S?  If so, how?
> 
> Hmm ... Stupid counter-question: Did you study the zfun() function in
> $RHOME/demos/dynload/zero.c ? Looks pretty straightforward to me,
> except that I have no offhand guess what the 0L argument to call_S is
> good for. Peeking at the source should cure that.
> 
> -- 
>    O__  ---- Peter Dalgaard             Blegdamsvej 3  
>   c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
>  (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
> ~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
> =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
> r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
> Send "info", "help", or "[un]subscribe"
> (in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
> =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
> 


This may not be an issue here but it is something to keep in mind for
call_S in S and R:

You need to be careful about making lots of call_S's that return large
amounts of data within a single call to .C. The reason is that the
call_S mechanism provides no way to mark the returned result as no
longer needed, so it cannot be reclaimed. Allocations made in the
process of executing the function called with call_S should be freed
just fine, but the result can't be. So if you produce lots of results,
you will consume lots of memory. For most uses of call_S this isn't an
issue, but if you were doing the loop of a long simulation is C and
it could become an issue.

-- 
Luke Tierney
University of Minnesota                      Phone:           612-625-7843
School of Statistics                         Fax:             612-624-8868
206 Church Street                            email:      luke@stat.umn.edu
Minneapolis, MN 55455 USA                    WWW:  http://www.stat.umn.edu
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Tue Jun  3 17:23:24 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 03 Jun 1997 18:23:24 +0200
Subject: R-alpha: unif_rand() again
In-Reply-To: Kurt Hornik's message of Tue, 3 Jun 1997 17:17:29 +0200
References: <199706031445.QAA13652@aragorn.ci.tuwien.ac.at>
 <x2yb8r4t31.fsf@bush.kubism.ku.dk>
 <199706031517.RAA13734@aragorn.ci.tuwien.ac.at>
Message-ID: <x2u3jf4pvm.fsf@bush.kubism.ku.dk>

Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

> >> What I need is to call runif() (more precisely, `runif(1, 0, 1)') from
> >> inside a C function.  Is this possible using call_S?  If so, how?
> 
> > Hmm ... Stupid counter-question: Did you study the zfun() function in
> > $RHOME/demos/dynload/zero.c ? Looks pretty straightforward to me,
> > except that I have no offhand guess what the 0L argument to call_S is
> > good for. Peeking at the source should cure that.
> 
> I did.  I hoped that something like
> 
> static char *func = "runif";
> 
> double unif_rand() {
...
>   return(result[0]);
> }
> 
> might work, but it does not ...

Aha. I see, call_R seems to want an SEXP parameter, not a character
pointer. So some way of converting "runif" into the relevant SEXPREC seems
to be needed. Something like mkChar() <um, no, that doesn't seem to be
the way to make a "SEXPsymbol"..> followed by findFun(). Or just pass
it as a parameter to .C

This looks like a bug in the S compatibility, doesn't it? Nothing in
the Splus examples indicate that the first argument should be a
string, but I seem to recall seeing something to that effect in the
blue book (?) 

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From luke@stat.umn.edu  Tue Jun  3 17:39:49 1997
From: luke@stat.umn.edu (Luke Tierney)
Date: Tue, 3 Jun 1997 11:39:49 -0500 (CDT)
Subject: R-alpha: unif_rand() again
In-Reply-To: <x2u3jf4pvm.fsf@bush.kubism.ku.dk> from "Peter Dalgaard BSA" at Jun 3, 97 06:23:24 pm
Message-ID: <9706031639.AA15847@nokomis.stat.umn.edu>

Peter Dalgaard BSA wrote:
> 
> Aha. I see, call_R seems to want an SEXP parameter, not a character
> pointer. So some way of converting "runif" into the relevant SEXPREC seems
> to be needed. Something like mkChar() <um, no, that doesn't seem to be
> the way to make a "SEXPsymbol"..> followed by findFun(). Or just pass
> it as a parameter to .C
> 
> This looks like a bug in the S compatibility, doesn't it? Nothing in
> the Splus examples indicate that the first argument should be a
> string, but I seem to recall seeing something to that effect in the
> blue book (?) 
> 

In the blue book the call looks like

	.C("zero_find", list(f), ...)

and is used as

	zero_find(void **ff, ...) {
	  func = ff[0];
	  ...
	  call_S(func, ...
	  ...
	}

In the R example the call looks like

	.C("zero_find", f, ...)

and is used as

	zero_find(void *f, ...) {
	  func = f;
	  ...
	  call_S(func, ...
	  ...
	}

In the blue book there is the extra wrapping in alist which gets
undone with a dereference in C -- I don't know if this is really
needed to or not.

-- 
Luke Tierney
University of Minnesota                      Phone:           612-625-7843
School of Statistics                         Fax:             612-624-8868
206 Church Street                            email:      luke@stat.umn.edu
Minneapolis, MN 55455 USA                    WWW:  http://www.stat.umn.edu
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Tue Jun  3 18:21:57 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 03 Jun 1997 19:21:57 +0200
Subject: R-alpha: unif_rand() again
In-Reply-To: Kurt Hornik's message of Tue, 3 Jun 1997 17:17:29 +0200
References: <199706031445.QAA13652@aragorn.ci.tuwien.ac.at>
 <x2yb8r4t31.fsf@bush.kubism.ku.dk>
 <199706031517.RAA13734@aragorn.ci.tuwien.ac.at>
Message-ID: <x2pvu34n62.fsf@bush.kubism.ku.dk>

Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

> I did.  I hoped that something like
> 
> static char *func = "runif";
> 
> double unif_rand() {
...
> 
> might work, but it does not ...

Here's a model that does (seem to) work:

> dyn.load("runif.so");.C("select_rand",runif); .C("unif_rand",3.3)
[[1]]
function (n, min = 0, max = 1) 
.Internal(runif(n, min, max))

[[1]]
[1] 0.126975

> .C("unif_rand",3.3) # the 3.3 is just an arbitrary double...
[[1]]
[1] 0.9233792

> .C("unif_rand",3.3)
[[1]]
[1] 0.03410953

> 

with

runif.c:

-------------------------

static void * func;

double select_rand(void * f)
{
        func = f;
}

static long one = 1L, zero = 0L;
unif_rand(double *x) {
  void *in[3];
  char *modes[] = { "integer", "integer", "integer" };
  long lengths[] = { 1, 1, 1 };  
  double result;
  double *values[1];

  in[0] = (void *)&one;
  in[1] = (void *)&zero;
  in[2] = (void *)&one;  
  call_S((void *)func, 3L, in, modes, lengths, 0L, 1L, values);
  x[0] = values[0][0];
}

--------------------------


-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From luke@stat.umn.edu  Tue Jun  3 19:15:43 1997
From: luke@stat.umn.edu (Luke Tierney)
Date: Tue, 3 Jun 1997 13:15:43 -0500 (CDT)
Subject: R-alpha: unif_rand() again
In-Reply-To: <x2pvu34n62.fsf@bush.kubism.ku.dk> from "Peter Dalgaard BSA" at Jun 3, 97 07:21:57 pm
Message-ID: <9706031815.AA15866@nokomis.stat.umn.edu>

Peter Dalgaard BSA wrote:

> Here's a model that does (seem to) work:
> 
> > dyn.load("runif.so");.C("select_rand",runif); .C("unif_rand",3.3)
> [[1]]
...
> with
> 
> double select_rand(void * f)
> {
>         func = f;
> }
> 

I'm not sure I see the point of the separate select_rand -- you can
just pass runif as an argument to unif_rand. The original example
needed to use the global variable because a C routine for finding a
zero of a C function was being used and the C function whose root was
to be found needed to get at the S/R function that it was fronting
for. The global variable is needed to pass this info (since you don't
have C closures). Here there isn't any need that I can see, but maybe
I've missed something (wouldn't be the first time :-)).

-- 
Luke Tierney
University of Minnesota                      Phone:           612-625-7843
School of Statistics                         Fax:             612-624-8868
206 Church Street                            email:      luke@stat.umn.edu
Minneapolis, MN 55455 USA                    WWW:  http://www.stat.umn.edu
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Tue Jun  3 23:29:16 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 04 Jun 1997 00:29:16 +0200
Subject: R-alpha: unif_rand() again
In-Reply-To: Luke Tierney's message of Tue, 3 Jun 1997 13:15:43 -0500 (CDT)
References: <9706031815.AA15866@nokomis.stat.umn.edu>
Message-ID: <x2soyzqq0z.fsf@bush.kubism.ku.dk>

Luke Tierney <luke@stat.umn.edu> writes:

> 
> Peter Dalgaard BSA wrote:
> 
> > Here's a model that does (seem to) work:
> > 
> > > dyn.load("runif.so");.C("select_rand",runif); .C("unif_rand",3.3)
> > [[1]]
> ...
> > with
> > 
> > double select_rand(void * f)
> > {
> >         func = f;
> > }
> > 
> 
> I'm not sure I see the point of the separate select_rand -- you can
> just pass runif as an argument to unif_rand.

Now what *did* I mean by that?.... Oh, yes. The original point
involved calling R from a C function. I'm .C-ing it in that bit of
code just for testing it. In practice, it might well get called from
another C function doing a simulation. So, since it appears to be
tricky to do the string-to-functionSEXP conversion in C, it might be
easier to explicitly initialize them from R with the "select_rand"
mechanism. Of course, one might also pass the R function directly to
the simulation routine, and have that one set things up.

Come to think of it, I'm not sure that we *want* the S semantics for
this. Consider

f<-function(a) a^2
Phi<-function(z)
{
	f<-function(z) exp(-z^2/2)/sqrt(2*pi)
	.C("integrate", f, -infty, zero)
}
where integrate() needs to call_S. It must be ensured that it passes
the inner 'f'. 

Hmm. That's not really an argument for having a call_S("f",...) rather
than call_S(f,...). It is no different from the work involved in any
other name lookup (including constructions like "x %myop% y" or
"'hello, world!'(5)"); it's just that it seems a bit silly to search
for a function by name when you already know full well what the
address of the function is. Inefficient, but hardly impossible.

Maybe one could set it up so that call_S did the string thing and
call_R the direct function pointer?

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Jun  9 07:02:18 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 9 Jun 1997 08:02:18 +0200
Subject: R-alpha: unif_rand() again
In-Reply-To: <x2u3jf4pvm.fsf@bush.kubism.ku.dk>
References: <199706031445.QAA13652@aragorn.ci.tuwien.ac.at>
 <x2yb8r4t31.fsf@bush.kubism.ku.dk>
 <199706031517.RAA13734@aragorn.ci.tuwien.ac.at>
 <x2u3jf4pvm.fsf@bush.kubism.ku.dk>
Message-ID: <199706090602.IAA32599@aragorn.ci.tuwien.ac.at>

>>>>> Peter Dalgaard BSA writes:

> Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:
>> >> What I need is to call runif() (more precisely, `runif(1, 0, 1)') from
>> >> inside a C function.  Is this possible using call_S?  If so, how?
>> 
>> > Hmm ... Stupid counter-question: Did you study the zfun() function in
>> > $RHOME/demos/dynload/zero.c ? Looks pretty straightforward to me,
>> > except that I have no offhand guess what the 0L argument to call_S is
>> > good for. Peeking at the source should cure that.
>> 
>> I did.  I hoped that something like
>> 
>> static char *func = "runif";
>> 
>> double unif_rand() {
> ...
>> return(result[0]);
>> }
>> 
>> might work, but it does not ...

> Aha. I see, call_R seems to want an SEXP parameter, not a character
> pointer. So some way of converting "runif" into the relevant SEXPREC
> seems to be needed. Something like mkChar() <um, no, that doesn't seem
> to be the way to make a "SEXPsymbol"..> followed by findFun(). Or just
> pass it as a parameter to .C

I see.

Thanks to all who helped.  I now have a working example of unif_rand(),
but I still hope for Ross to come up with something cleaner ...

Trying to map a function name to the function in call_R would be very
nice, in any case.

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Jun  9 14:21:51 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 9 Jun 1997 15:21:51 +0200
Subject: R-alpha: sd2rd v0.1-1
Message-ID: <199706091321.PAA01472@aragorn.ci.tuwien.ac.at>

Attached is another update.

New features/bugs:
*) now also attempts to get non-quoted object names within SEEALSO
sections to have a LANG(LINK(...)) around them
*) parentheses are now ALWAYS quoted, to prevent the rdoc2... scripts
from choking on unbalanced ones (e.g., "x in the range (0, 1]")
*) blank lines are mapped into PARA so that e.g. reference sections come
out better
*) comments are mapped into comments :-)

Please have a try.

-k

************************************************************************
#!/usr/bin/perl -w

$VERSION = "0.1-1";

$\ = "\n";

$parenLevel = 0;
$inSeeAlso = 0;
$doprint = 1;
$needArg = 1;
$needVal = 0;
$output = "";

while (<>) {
    chop;
    &substitute unless /^\./;
    @word = split;

    if (/^\s*$/) { &output("PARA"); }
    if (/^[^.]/) { &output($_); }

    if (/^\.AG/) {
	if ($needArg) {
	    &section(0, "ARGUMENTS(");
	    $needArg = 0;
	}
	&section(1, "ARG($word[1] @@");
    }
    if (/^\.CS/) { &section(0, "USAGE("); }
    if (/^\.DN/) { $doprint = 0; }
    if (/^\.DT/) { &section(0, "DESCRIPTION("); }
    if (/^\.EX/) { &section(0, "EXAMPLES("); }
    if (/^\.FN/) { $fun = $word[1]; }
    if (/^\.(IP|PP)/) { &output("PARA"); }
    if (/^\.KW/) { 
	if ($parenLevel > 0) {
	    &section(0, "");
	    $parenLevel = 0;
	}
	&output("COMMENT(KEYWORD($word[1]))");
    }
    if (/^\.RC/) {
	if ($needVal) {
	    $needVal = 0;	    
	    &section(0, "VALUES(\n$output\n@@");
	    $doprint = 1;
	}
	&section(1, "ARG($word[1] @@");
    }
    if (/^\.RT/) {
	$needVal = 1;
	$doprint = 0;
	$output = "";
    }
    if (/^\.SA/) {
	&section(0, "SEEALSO(");
	$inSeeAlso = 1;
    }
    if (/^\.SE/) { &paragraph("SIDE EFFECTS"); }
    if (/^\.SH/) {
	if ($word[1] =~ /REFERENCE/) {
	    &section(0, "REFERENCES(");
	} else {
	    &paragraph($word[1]);
	}
    }
    if (/^\.sp/) { output("BLANK"); }
    if (/^\.TL/) { &section(0, "TITLE($fun @@"); }
    if (/^\.WR/) {
	&section(0, "");
	print("COMMENT(Converted by sd2rd version $VERSION.)");
    }

    if (/^\.AO/) {
	output("Arguments for function LANG($word[1]()) can also be");
	output("supplied to this function.");
    }
    if (/^\.GE/) {
	output("This is a generic function.");
	output("Functions with names beginning in LANG($fun.) will be");
	output("methods for this function.");
    }
    if (/^\.GR/) {
	output("Graphical parameters (see LANG(LINK(par)) may also be");
	output("supplied as arguments to this function.");
    }
    if (/^\.ME/) {
	output("This function is a method for the generic function");
	output("LANG($word[1]()) for class LANG($word[2]).");
	output("It can be invoked by calling LANG($word[1](x)) for an");
	output("object LANG(x) of the appropriate class, or directly by");
	output("calling LANG($word[1].$word[2](x)) regardless of the");
	output("class of the object.");
    }
    if (/^\.NA/) { output("Missing values (LANG(NA)s) are allowed."); }
    if (/^\.Tl/) {
	output("In addition, the high-level graphics control arguments");
	output("described under LANG(LINK(par)) and the arguments to");
	output("LANG(LINK(title)) may be supplied to this function.");
    }
}



sub substitute {
    s/\(/\\\(/g;
    s/\)/\\\)/g;
    s/\.\.\./DOTS/g;    
    s/\\fB/BOLD\(/g;
    s/\\fR/\)/g;
    s/\\\.(.*)$/COMMENT($1)/g;
    if ($inSeeAlso) {
	s/\`?([\.\w]*\w+)\'?/LANG(LINK($1))/g;
    } else {
	s/\`([^\']*)\'/LANG($1)/g;
    }
}

sub section {
    local($level, $text) = @_;
    $n = $parenLevel - $level;
    print(")" x $n) if ($n > 0);
    if ($needVal) {
	print("VALUE(\n$output\n)");
	$needVal = 0;
    }
    print("$text") if $text;    
    $parenLevel = $level + 1;
    $doprint = 1;
    $inSeeAlso = 0;
}

sub paragraph {
    local($name) = @_;
    &output("PARA\nBOLD($name): ");
}
    
sub output {
    local($text) = @_;
    if ($doprint) {
	print($text);
    } elsif ($output) {
	$output .= "\n$text";
    } else {
	$output = $text;
    }
}
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Mon Jun  9 18:40:29 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Mon, 9 Jun 1997 19:40:29 +0200
Subject: R-alpha: Re: R-beta: mlbench-0.1 --- machine learning benchmark problems
In-Reply-To: <199706091621.SAA16397@galadriel.ci.tuwien.ac.at>
References: <199706091621.SAA16397@galadriel.ci.tuwien.ac.at>
Message-ID: <199706091740.TAA03191@aragorn.ci.tuwien.ac.at>

>>>>> Friedrich Leisch writes:

> I've made a package from some benchmark datasets for use with R and
> uploaded it to CRAN.=20

> Here's the Index entry:

> mlbench-0.1.tar.gz:
> 	A collection of artificial and real-world machine learning
> 	benchmark problems, including, e.g., the boston housing
> 	data from the UCI repository.

> 	Written/packaged by Fritz Leisch <Friedrich.Leisch@ci.tuwien.ac.at>
> 	Original data sets from various sources.
> 	[1997/06/09]


> This (naturally) includes some data files ... hence you have to do
> some parts of the installation manually, see the INSTALL file for
> details (IMHO R has no clear concept for data: one flat directory is
> certainly not sufficient).

Just for the sake of completeness (for those who don't use our Debian
GNU/Linux packages).  We have ``meanwhile'' (before we agree on an
official R file standard) simply introduced a one-level hierarchy in
RHOME/data.  The data files that come with the base distribution are in
RHOME/data/base, the new ones in RHOME/data/mlbench etc.

This change requires nothing but changing RHOME/cmd/filename, e.g. as
below.

What would also be nice is to have `make libs' install the data as well
to RHOME/data/$LIBNAME.

-k

***********************************************************************
#!/bin/sh

for file in $HOME/lib/R/$1/$2 \
            $RHOME/$1/$2 \
            $RHOME/$1/[^.]*/$2;
do
    if [ -r $file ]
    then
	echo $file
	break
    fi
done

if [ ! -r $file ]
then
    echo
fi
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Mon Jun  9 22:13:42 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 09 Jun 1997 23:13:42 +0200
Subject: R-alpha: Transposition bug
Message-ID: <x2afkzlbsp.fsf@bush.kubism.ku.dk>

Shortest program to crash R?

> t(table(1))
Floating point exception (core dumped)

One-dimensional tables don't act like vectors, obviously. The crash
comes from an integer divide-by-zero (yup, that causes a SIGFPE) in

#0  0x8058e0b in do_transpose (call=0x4050c1e4, op=0x401c65fc, 
    args=0x4050c1bc, rho=0x4050e4e4) at array.c:545
545                             INTEGER(r)[i] = INTEGER(a)[(i / ncol)
+ (i % ncol) * nrow];


-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Tue Jun 10 18:46:19 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 10 Jun 1997 19:46:19 +0200
Subject: R-alpha: sd2rd 0.1-2
Message-ID: <199706101746.TAA09501@aragorn.ci.tuwien.ac.at>

Another update of the S doc -> R doc conversion script is attached
below.  Relative to the previously released version, there are two
changes.

* Quoting of parentheses does not happen in verbatim-like sections

* More importantly, the way words in the .SA (SEEALSO) section are
treated is now controlled by an optional argument, `-x'.

Without this option, only words enclosed in single accents are mapped to
LANG(LINK(...)).  With `-x', there are xtra substitutions---all words in
the section are mapped.

I introduced this optional argument because on the one hand, Thomas
pointed out that many S doc files do not quote the object names (e.g. in
survival4), whereas Martin said that the clean way was to quote them, as
there is no reason why non-object names should not appear within .SA.
So, the optional argument should make everyone happy.

I still have several suggestions on my TODO list, but I think the
current version should be rather stable and pretty much usable, so
perhaps one could include it in the R distribution's `etc' directory.

-k

*********************************************************************
#!/usr/bin/perl -w

$VERSION = "0.1-2";

$\ = "\n";

$parenLevel = 0;
$inVerbatim = 0;
$inSeeAlso = 0;
$doprint = 1;
$needArg = 1;
$needVal = 0;
$output = "";

$opt_x = 0;
use Getopt::Long;
GetOptions (("x")) || &usage();

while (<>) {
    chop;
    &substitute unless /^\./;
    @word = split;

    if (/^\s*$/) {
	if ($inVerbatim) {
	    &output("BLANK");
	} else {
	    &output("PARA");
	}
    }
    if (/^[^.]/) { &output($_); }

    if (/^\.AG/) {
	if ($needArg) {
	    &section(0, "ARGUMENTS(");
	    $needArg = 0;
	}
	&section(1, "ARG($word[1] @@");
    }
    if (/^\.CS/) {
	&section(0, "USAGE(");
	$inVerbatim = 1;
    }
    if (/^\.DN/) { $doprint = 0; }
    if (/^\.DT/) { &section(0, "DESCRIPTION("); }
    if (/^\.EX/) {
	&section(0, "EXAMPLES(");
	$inVerbatim = 1;	
    }
    if (/^\.FN/) { $fun = $word[1]; }
    if (/^\.(IP|PP)/) { &output("PARA"); }
    if (/^\.KW/) { 
	if ($parenLevel > 0) {
	    &section(0, "");
	    $parenLevel = 0;
	}
	&output("COMMENT(KEYWORD($word[1]))");
    }
    if (/^\.RC/) {
	if ($needVal) {
	    $needVal = 0;	    
	    &section(0, "VALUES(\n$output\n@@");
	    $doprint = 1;
	}
	&section(1, "ARG($word[1] @@");
    }
    if (/^\.RT/) {
	$needVal = 1;
	$doprint = 0;
	$output = "";
    }
    if (/^\.SA/) {
	&section(0, "SEEALSO(");
	$inSeeAlso = 1;
    }
    if (/^\.SE/) { &paragraph("SIDE EFFECTS"); }
    if (/^\.SH/) {
	if ($word[1] =~ /REFERENCE/) {
	    &section(0, "REFERENCES(");
	} else {
	    &paragraph($word[1]);
	}
    }
    if (/^\.sp/) { output("BLANK"); }
    if (/^\.TL/) { &section(0, "TITLE($fun @@"); }
    if (/^\.WR/) {
	&section(0, "");
	print("COMMENT(Converted by sd2rd version $VERSION.)");
    }

    if (/^\.AO/) {
	output("Arguments for function LANG($word[1]()) can also be");
	output("supplied to this function.");
    }
    if (/^\.GE/) {
	output("This is a generic function.");
	output("Functions with names beginning in LANG($fun.) will be");
	output("methods for this function.");
    }
    if (/^\.GR/) {
	output("Graphical parameters (see LANG(LINK(par)) may also be");
	output("supplied as arguments to this function.");
    }
    if (/^\.ME/) {
	output("This function is a method for the generic function");
	output("LANG($word[1]()) for class LANG($word[2]).");
	output("It can be invoked by calling LANG($word[1](x)) for an");
	output("object LANG(x) of the appropriate class, or directly by");
	output("calling LANG($word[1].$word[2](x)) regardless of the");
	output("class of the object.");
    }
    if (/^\.NA/) { output("Missing values (LANG(NA)s) are allowed."); }
    if (/^\.Tl/) {
	output("In addition, the high-level graphics control arguments");
	output("described under LANG(LINK(par)) and the arguments to");
	output("LANG(LINK(title)) may be supplied to this function.");
    }
}

sub substitute {
    if (!$inVerbatim) {
	s/\(/\\\(/g;
	s/\)/\\\)/g;
    }
    s/\.\.\./DOTS/g;    
    s/\\fB/BOLD\(/g;
    s/\\fR/\)/g;
    s/\\\.(.*)$/COMMENT($1)/g;
    if ($inSeeAlso) {
	if ($opt_x) {
	    s/\`?([\.\w]*\w+)\'?/LANG(LINK($1))/g;
	} else {
	    s/\`([^\']*)\'/LANG(LINK($1))/g;
	}
    } else {
	s/\`([^\']*)\'/LANG($1)/g;
    }
}

sub section {
    local($level, $text) = @_;
    $n = $parenLevel - $level;
    print(")" x $n) if ($n > 0);
    if ($needVal) {
	print("VALUE(\n$output\n)");
	$needVal = 0;
    }
    print("$text") if $text;    
    $parenLevel = $level + 1;
    $inVerbatim = 0;
    $inSeeAlso = 0;
    $doprint = 1;    
}

sub paragraph {
    local($name) = @_;
    &output("PARA\nBOLD($name): ");
}
    
sub output {
    local($text) = @_;
    if ($doprint) {
	print($text);
    } elsif ($output) {
	$output .= "\n$text";
    } else {
	$output = $text;
    }
}

sub usage {
    print("\nsd2rd version $VERSION\n\nusage:  sd2rd [-x] file\n");
    exit;
}
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Tue Jun 10 18:53:24 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 10 Jun 1997 19:53:24 +0200
Subject: R-alpha: problem saving boxplots to PostScript
Message-ID: <199706101753.TAA09525@aragorn.ci.tuwien.ac.at>

The title says it all---seems that the boxes disappear when saving a
boxplot to PostScript.

Is this a known problem?  (Andreas thinks so ...)

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Wed Jun 11 18:37:32 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 11 Jun 1997 19:37:32 +0200
Subject: R-alpha: write() && quoting && ...
Message-ID: <199706111737.TAA12848@aragorn.ci.tuwien.ac.at>

Has anyone had some time to look at the generic write() I posted some
time ago?  I'd appreciate some feedback/comments/suggestions on how to
consistently deal with quoting and name-type attributes ...

On a related matter, Martin indicated that it would be nice to have a
"matrix" class, etc.  Is there any reason for not doing so?  Should not
do any harm, and would make writing methods for generic functions nicer.

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ben@eno.Princeton.EDU  Wed Jun 11 19:15:55 1997
From: ben@eno.Princeton.EDU (Ben Bolker)
Date: Wed, 11 Jun 1997 14:15:55 -0400 (EDT)
Subject: R-alpha: PS bug fix and various minor graphics bugs
In-Reply-To: <199706111737.TAA12848@aragorn.ci.tuwien.ac.at>
Message-ID: <Pine.SUN.3.95.970611141002.11295A-100000@paca>


   I don't know if this bug has been fixed in a patch I missed, but ...

  line 154 of devPS.c, which currently reads

maxpointsize = 72.0 * ((pageheight>pagewidth)) ? pageheight : pagewidth;

   should read

maxpointsize = 72.0 * ((pageheight>pagewidth) ? pageheight : pagewidth);

  The misplaced parenthesis makes maxpointsize wrong.

  Other comments (things I may get around to fixing when I'm less busy):

   - on quick examination "mkh" appears to have no effect;
   - the components of mgp(x,y,z) appear to get rounded off to integers at
some point, which I don't like (but should at least appear in
documentation if there's a good reason for it); I like to be able to
fine-tune distances ...
   - when using arrows() on a log-scaled plot, you have to use log(x)
coordinates rather than x-coordinates.  This could be intentional (but is
not the way text() works, so I would say it should be made to work the way
text() works).

  
Benjamin Bolker          Dep't of Ecology and Evolutionary Biology,
ben@eno.princeton.edu    Princeton University
tel: (609) 258-6886,     fax: (609) 258-1334

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Thu Jun 12 00:02:03 1997
From: ihaka@stat.auckland.ac.nz (Ross &)
Date: Thu, 12 Jun 1997 11:02:03 +1200 (NZST)
Subject: R-alpha: PS bug fix and various minor graphics bugs
In-Reply-To: <Pine.SUN.3.95.970611141002.11295A-100000@paca>
References: <199706111737.TAA12848@aragorn.ci.tuwien.ac.at>
 <Pine.SUN.3.95.970611141002.11295A-100000@paca>
Message-ID: <199706112302.LAA24151@stat1.stat.auckland.ac.nz>

Ben Bolker writes:
 > 
 >    I don't know if this bug has been fixed in a patch I missed, but ...
 > 
 >   line 154 of devPS.c, which currently reads
 > 
 > maxpointsize = 72.0 * ((pageheight>pagewidth)) ? pageheight : pagewidth;
 > 
 >    should read
 > 
 > maxpointsize = 72.0 * ((pageheight>pagewidth) ? pageheight : pagewidth);
 > 
 >   The misplaced parenthesis makes maxpointsize wrong.

This is indeed an error.  I have made the change.

 >   Other comments (things I may get around to fixing when I'm less busy):
 > 
 >    - on quick examination "mkh" appears to have no effect;

This is deliberate.  You can use the cex parameter scales the size
of everything.  If you need "exact" mark sizes I can look at adding
it.

 >    - the components of mgp(x,y,z) appear to get rounded off to integers at
 > some point, which I don't like (but should at least appear in
 > documentation if there's a good reason for it); I like to be able to
 > fine-tune distances ...

This was a typo in the saving and restoring of graphical parameters.
The temporary saved value was typed "int" instead of double.

 >    - when using arrows() on a log-scaled plot, you have to use log(x)
 > coordinates rather than x-coordinates.  This could be intentional (but is
 > not the way text() works, so I would say it should be made to work the way
 > text() works).

Yes, this is because I ommited the transformation in both "segments"
and "arrows".  This is a bug.

All these things will be fixed in 0.50 which is "almost ready to
roll".  It is examination / final-grade time here so there may be a
small delay before the release.
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Thu Jun 12 01:11:33 1997
From: ihaka@stat.auckland.ac.nz (Ross &)
Date: Thu, 12 Jun 1997 12:11:33 +1200 (NZST)
Subject: R-alpha: X11/Postscript Hardcopy bug
Message-ID: <199706120011.MAA25233@stat1.stat.auckland.ac.nz>

A couple of people have come across this recently (piecharts and
boxplots trigger it I think.  Here is a fix (not a patch because
a new release is at hand).

In the C code in src/unix/psx11.c, replace the function psx11_Polygon
with the following code.
	Ross

- - - s n i p - - - h e r e - - -

void psx11_Polygon(int n, double *x, double *y, int bg, int fg)
{
        int i;
        if(bg != NA_INTEGER) {
                psx11_SetColor(bg);
                fprintf(psfp, "np\n");
                fprintf(psfp, "%.2f %.2f m\n",
                        xoffset + xscale * x[0],
                        yoffset + yscale * y[0]);
                for(i=1 ; i<n ; i++) {
                        fprintf(psfp, "%.2f %.2f l\n",
                                xoffset + xscale * x[i],
                                yoffset + yscale * y[i]);
                }
                fprintf(psfp, "cp f\n");
        }
        if(fg != NA_INTEGER) {
                psx11_SetColor(fg);
                fprintf(psfp, "np\n");
                fprintf(psfp, "%.2f %.2f m\n",
                        xoffset + xscale * x[0],
                        yoffset + yscale * y[0]);
                for(i=1 ; i<n ; i++) {
                        fprintf(psfp, "%.2f %.2f l\n",
                                xoffset + xscale * x[i],
                                yoffset + yscale * y[i]);
                }
                fprintf(psfp, "cp o\n");
        }
}
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Thu Jun 12 06:32:35 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Thu, 12 Jun 1997 07:32:35 +0200
Subject: R-alpha: X11/Postscript Hardcopy bug
In-Reply-To: <199706120011.MAA25233@stat1.stat.auckland.ac.nz>
References: <199706120011.MAA25233@stat1.stat.auckland.ac.nz>
Message-ID: <199706120532.HAA14730@aragorn.ci.tuwien.ac.at>

>>>>> Ross & writes:

> A couple of people have come across this recently (piecharts and
> boxplots trigger it I think.  Here is a fix (not a patch because
> a new release is at hand).

> In the C code in src/unix/psx11.c, replace the function psx11_Polygon
> with the following code.

Thanks, works great.

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Fri Jun 13 00:57:17 1997
From: ihaka@stat.auckland.ac.nz (Ross Ihaka)
Date: Fri, 13 Jun 1997 11:57:17 +1200 (NZST)
Subject: R-alpha: ISO Latin1 and Readline
Message-ID: <199706122357.LAA03285@stat1.stat.auckland.ac.nz>

Does anyone have experience with using the readline library in
conjunction with ISO Latin1 characters?

In response to a prod from Martin Maechler I am trying to convert R so
that it will accept 8-bit characters (and render them correctly in text
and graphics).  This appears to work when I type such lines into a file
and source it, but readline seems to intercept any 8-bit characters
I type interactively  and refuses to let them through to R.

Is this cured if you have the right kind of keyboard?

Additional query: Should accented characters be allowed in variable names?

	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Fri Jun 13 06:03:39 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Fri, 13 Jun 1997 07:03:39 +0200
Subject: R-alpha: ISO Latin1 and Readline
In-Reply-To: <199706122357.LAA03285@stat1.stat.auckland.ac.nz>
References: <199706122357.LAA03285@stat1.stat.auckland.ac.nz>
Message-ID: <199706130503.HAA04192@aragorn.ci.tuwien.ac.at>

>>>>> Ross Ihaka writes:

> Does anyone have experience with using the readline library in
> conjunction with ISO Latin1 characters?

> In response to a prod from Martin Maechler I am trying to convert R so
> that it will accept 8-bit characters (and render them correctly in text
> and graphics).  This appears to work when I type such lines into a file
> and source it, but readline seems to intercept any 8-bit characters
> I type interactively  and refuses to let them through to R.

> Is this cured if you have the right kind of keyboard?

Hmm.

I have e.g.

hornik@aragorn:/var/tmp/hornik$ cat =E4=F6=FC.dat=20
1 2 3
4 5 6

R> x <- read.table("/var/tmp/hornik/=E4=F6=FC.dat")
R> x
  V1 V2 V3
1  1  2  3
2  4  5  6

I think the trick is that you need to have the readline init file
(INPUTRC, typically something like /etc/inputrc) specify

     # don't strip characters to 7 bits when reading
     set input-meta on
    =20
     # allow iso-latin1 characters to be inserted rather than converted t=
o
     # prefix-meta sequences
     set convert-meta off
    =20
     # display characters with the eighth bit set directly rather than
     # as meta-prefixed characters
     set output-meta on

(comments from the readline/info sample file, the settings are what we
use here ...).

> Additional query: Should accented characters be allowed in variable
> names?

Not sure.  Maybe yes so that e.g. if I had to impress someone in
Austrian I could use "Gr=F6=DFe" as a variable name ...

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Jun 13 13:43:50 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 13 Jun 1997 14:43:50 +0200
Subject: R-alpha: ISO Latin1 and Readline
In-Reply-To: <199706130503.HAA04192@aragorn.ci.tuwien.ac.at> (message from
 Kurt Hornik on Fri, 13 Jun 1997 07:03:39 +0200)
Message-ID: <199706131243.OAA08910@sophie.ethz.ch>

One thing which is important is
to use the environment variable 

	LC_CTYPE=iso_8859_1

(This makes Emacs  automatically call (standard-display-european 1)

Here, the readline library is not of much importance, because

	1) We use US-american keyboards 
	   which makes programming / latex / Splus much easier.

	2) In Emacs, we use a nice package 
		(require 'iso-transl)
	   and
	        (iso-transl-set-language "German")

	   which makes C-x 8 and more imporantly
           'Alt' (the one besides "Meta" on a SPARC keyboard)
           behave as a prefix for accented characters.
	
	  So, the German Umlauts are produced using 
		Alt-a (), ....Alt-U (), 
		and even the one we don't use in Switzerland, Alt-s ()
	  Also, Alt-m (=)  ,   Alt-< (=) ;  

	  And for all accents: 
		Alt-accent-letter  -->  accented letter.

	   Alt-'-e  -> 
	   Alt-^-i  -> 

	 and so on -- this is much more powerful than any language specific
	 keyboard.

and then, we use  S-mode / R-mode / latex-mode / shell-mode   from within
Emacs. 

------------

Back to R:
	
I think most important are

1) string constants
2) Comments

and then

3)  text(.) and mtext(.)  of these constants.

4) Variable names might come natural to some users, 
   especially the ones that come from non-Unix worlds.

------------------------------
Remark to '3)'   and postscript(.).

In newer versions of S-plus (>= 3.1 I think),
there is the 

       ps.options (setfont = ps.setfont.latin1)

command which allows for  ISO-latin1 text.
The big drawback is that the default plotting character is DIFFERENT
and worse.

If you want to see what I mean, execute the following and compare the 2
postscript files:

#### Deal with 'bug' :
#### if       		ps.options (setfont = ps.setfont.latin1)
#### has been called,
#### the default plotting character, the 'bullet' is drawn much too small.

pso <- ps.options (reset = T)
ps.options (setfont = ps.setfont.latin1)
postscript("latin1-ex.ps")
plot(1:10, main =" by Martin Mchler")
Txt <- paste("ps.options (reset = T)",
	     "ps.options (setfont = ps.setfont.latin1)",
	     "plot(1:10, main = \" by Martin Mchler\")",
	     "text(1,9,\"__all this text__\")",sep="\n")
text(1,9,Txt, adj=0)
dev.off()

pso <- ps.options (reset = T)
postscript("std-ex.ps")
plot(1:10, main =" by Martin Mchler")
text(1,9,"ps.options (reset = T)\nplot(1:10, main = \"....\")",adj=0)
dev.off()
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Fri Jun 13 14:55:38 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 13 Jun 1997 15:55:38 +0200
Subject: R-alpha: ISO Latin1 and Readline
In-Reply-To: Kurt Hornik's message of Fri, 13 Jun 1997 07:03:39 +0200
References: <199706122357.LAA03285@stat1.stat.auckland.ac.nz>
 <199706130503.HAA04192@aragorn.ci.tuwien.ac.at>
Message-ID: <x2d8pq8v51.fsf@bush.kubism.ku.dk>

Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

> I think the trick is that you need to have the readline init file
> (INPUTRC, typically something like /etc/inputrc) specify
> 
>      # don't strip characters to 7 bits when reading
>      set input-meta on
>      
>      # allow iso-latin1 characters to be inserted rather than converted to
>      # prefix-meta sequences
>      set convert-meta off
>      
>      # display characters with the eighth bit set directly rather than
>      # as meta-prefixed characters
>      set output-meta on

Exactly. One loses the Meta characters that way, unavoidable since
Meta works in xterms and other terminals by OR'ing characters with
0x128, so e.g. M-x == . No big deal, use ESC x instead. (Who uses
it anyway?)

> > Additional query: Should accented characters be allowed in variable
> > names?
> 
> Not sure.  Maybe yes so that e.g. if I had to impress someone in
> Austrian I could use "Gre" as a variable name ...

One less newbie error when teaching... Are there any arguments
*against* it?

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ben@eno.Princeton.EDU  Mon Jun 16 01:21:38 1997
From: ben@eno.Princeton.EDU (Ben Bolker)
Date: Sun, 15 Jun 1997 20:21:38 -0400 (EDT)
Subject: R-alpha: image(): minor bug in R code and helpfile (fixes)
Message-ID: <Pine.SUN.3.95.970615201153.20427A-100000@paca>


   I've noticed a few minor annoyances/mismatches with S in image().
 
  First, if you give it just a matrix argument (image(z)), it complains
rather than (as S does) using default x and y.

  This patch fixes it to work (mostly) like S (although in keeping with
what was in R already the default x,y coordinates are ((0,1),(0,1)) rather
than (1:nrow,1:ncol)). 

5,16d4
<        if(is.list(x)) {
<              z <- x$z
<              y <- x$y
<              x <- x$x
<               if(is.null(x) || is.null(y) || is.null(z))
<                stop("list must contain x, y, and z components with z a matrix")
<         }
<         else if(missing(y) && missing(z) && is.matrix(x)) {
<                 z <- x
<                 x <- seq(0,1,len=nrow(z))
<                 y <- seq(0,1,len=ncol(z))
<         }

  Second, the examples in the help file don't actually work(!) without the
following changes:

51c51
< image(z=volcano, x, y,
---
> image(volcano, x, y,
53c53
< contour(z=volcano, x, y, levels=seq(90, 200, by=5),
---
> contour(volcano, x, y, zc=seq(90, 200, by=5),

   (By the way, there is currently no help for contour().)

  A more general question: what are the ethics/legalities of adapting
S/S-PLUS function code to use in R?  

Benjamin Bolker          Dep't of Ecology and Evolutionary Biology,
ben@eno.princeton.edu    Princeton University
tel: (609) 258-6886,     fax: (609) 258-1334

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Wed Jun 18 18:42:56 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Wed, 18 Jun 1997 10:42:56 -0700 (PDT)
Subject: R-alpha: f77 on Solaris
In-Reply-To: <199706091321.PAA01472@aragorn.ci.tuwien.ac.at>
Message-ID: <Pine.SUN.3.95.970618103955.1332B-100000@zen>


The autoconfigure flags for f77 on Solaris 5.5.1 are wrong
They should be FFLAGS=" -pic" rather than FFLAGS=" -fpic"


Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Thu Jun 19 08:46:23 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Thu, 19 Jun 1997 09:46:23 +0200
Subject: R-alpha: f77 on Solaris
In-Reply-To: <Pine.SUN.3.95.970618103955.1332B-100000@zen> (message from
 Thomas Lumley on Wed, 18 Jun 1997 10:42:56 -0700 (PDT))
Message-ID: <199706190746.JAA07101@sophie.ethz.ch>

>>>>> "Thomas" == Thomas Lumley <thomas@biostat.washington.edu> writes:

    Thomas> The autoconfigure flags for f77 on Solaris 5.5.1 are wrong They
    Thomas> should be FFLAGS=" -pic" rather than FFLAGS=" -fpic"

am I right that you suggest patching configure.in (and hence 'configure')?

This may be THE solution, really.

-----

I've been using  f77 on Solaris 2.5.1 ( = SunOS 5.5.1)  for a while,
and in newer versions of R,
all was fine when I had
---------------------------------------
FPICFLAGS=-Kpic
---------------------------------------

in the RHOME/config.site  file.
		   -----

Martin Maechler <maechler@stat.math.ethz.ch>		 <><
Seminar fuer Statistik, SOL G1
ETH (Federal Inst. Technology)	8092 Zurich	 SWITZERLAND
phone: x-41-1-632-3408		fax: ...-1086
http://www.stat.math.ethz.ch/~maechler/
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Thu Jun 19 17:05:05 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 19 Jun 1997 18:05:05 +0200
Subject: R-alpha: f77 on Solaris
In-Reply-To: Martin Maechler's message of Thu, 19 Jun 1997 09:46:23 +0200
References: <199706190746.JAA07101@sophie.ethz.ch>
Message-ID: <x2k9jqpoi6.fsf@bush.kubism.ku.dk>

Martin Maechler <maechler@stat.math.ethz.ch> writes:

> 
> >>>>> "Thomas" == Thomas Lumley <thomas@biostat.washington.edu> writes:
> 
>     Thomas> The autoconfigure flags for f77 on Solaris 5.5.1 are wrong They
>     Thomas> should be FFLAGS=" -pic" rather than FFLAGS=" -fpic"
> 
> am I right that you suggest patching configure.in (and hence 'configure')?
> 
> This may be THE solution, really.
> 

Um, does it work on ALL f77's on Solaris (f2c/gcc, g77, Sun f77)?

(I'm at a conference in Norway at the moment, so it's awkward for me
to check) 

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Jun 20 12:46:09 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 20 Jun 1997 13:46:09 +0200
Subject: R-alpha: x11()-window resizing -- another problem   pty='s' only works 2nd time
Message-ID: <199706201146.NAA01301@sophie.ethz.ch>

Can you confirm this problem : 

###---------  RESHAPING  x11()  window has more problems: ----

x11()
plot(1:8)# as expected:   <<<<<<<< NO Problem, if you OMIT this plot !!
##-- now RESHAPE  the  x11() - window !
par(pty = 's') # should make SQUARE plotting region
plot(1:8) #-- oops, not yet...
plot(1:8) # now !
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Friedrich.Leisch@ci.tuwien.ac.at  Fri Jun 20 12:51:52 1997
From: Friedrich.Leisch@ci.tuwien.ac.at (Friedrich Leisch)
Date: Fri, 20 Jun 1997 13:51:52 +0200
Subject: R-alpha: x11()-window resizing -- another problem   pty='s' only works 2nd time
In-Reply-To: <199706201146.NAA01301@sophie.ethz.ch>
References: <199706201146.NAA01301@sophie.ethz.ch>
Message-ID: <199706201151.NAA02007@galadriel.ci.tuwien.ac.at>

>>>>> On Fri, 20 Jun 1997 13:46:09 +0200,
>>>>> Martin Maechler wrote:

> Can you confirm this problem :=20
> ###---------  RESHAPING  x11()  window has more problems: ----

> x11()
> plot(1:8)# as expected:   <<<<<<<< NO Problem, if you OMIT this plot !!
> ##-- now RESHAPE  the  x11() - window !
> par(pty =3D 's') # should make SQUARE plotting region
> plot(1:8) #-- oops, not yet...
> plot(1:8) # now !


Yes, same problem here on a Linux machine running 0.49 Beta.

Best,
Fritz

--=20
-------------------------------------------------------------------
                        Friedrich  Leisch                            =20
Institut f=FCr Statistik                      Tel: (+43 1) 58801 4541
Technische Universit=E4t Wien                 Fax: (+43 1)  504 14 98
Wiedner Hauptstra=DFe 8-10/1071      Friedrich.Leisch@ci.tuwien.ac.at
A-1040 Wien, Austria             http://www.ci.tuwien.ac.at/~leisch
     PGP public key http://www.ci.tuwien.ac.at/~leisch/pgp.key
-------------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Fri Jun 20 16:59:16 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Fri, 20 Jun 1997 08:59:16 -0700 (PDT)
Subject: R-alpha: x11()-window resizing -- another problem   pty='s' only works 2nd time
In-Reply-To: <199706201146.NAA01301@sophie.ethz.ch>
Message-ID: <Pine.SUN.3.95.970620085541.2114A-100000@zen>

On Fri, 20 Jun 1997, Martin Maechler wrote:

> Can you confirm this problem : 
> 
Yes. Also interesting to note that it's the second plot statement,
regardless of the order of the commands, ie:

	# reshape
	plot(1:8)
	par(pty="s")
	plot(1:8)
works immediately

Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ben@eno.Princeton.EDU  Mon Jun 23 17:40:55 1997
From: ben@eno.Princeton.EDU (Ben Bolker)
Date: Mon, 23 Jun 1997 12:40:55 -0400 (EDT)
Subject: R-alpha: comparing alpha and numeric
Message-ID: <Pine.SUN.3.95.970623123919.6004A-100000@paca>


Is this behavior correct? (R 0.49 on SunOS 4.1.4)

> "a">1
 TRUE
> "a"<1
 FALSE
> "a"==1
 FALSE
> "a">2
 TRUE
> "a"<2
 FALSE

 (I know, this is like the old joke: "Doctor, it hurts when I do this."
"Well, don't do that!"  But it might be useful to have this caught by an
error or warning message ...)

Benjamin Bolker          Dep't of Ecology and Evolutionary Biology,
ben@eno.princeton.edu    Princeton University
tel: (609) 258-6886,     fax: (609) 258-1334

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Mon Jun 23 17:46:57 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Mon, 23 Jun 1997 09:46:57 -0700 (PDT)
Subject: R-alpha: comparing alpha and numeric
In-Reply-To: <Pine.SUN.3.95.970623123919.6004A-100000@paca>
Message-ID: <Pine.SUN.3.95.970623094548.1180A-100000@zen>

On Mon, 23 Jun 1997, Ben Bolker wrote:

> 
> Is this behavior correct? (R 0.49 on SunOS 4.1.4)
> 
> > "a">1
>  TRUE
> > "a"<1
<etc> 

It gets worse
> "3">4
[1] FALSE
> "3"<4
[1] TRUE
> "3"==4
[1] FALSE
> "3"==3
[1] TRUE
all well and good, and perhaps even useful, but
> "23"<3 
[1] TRUE
Ouch.

Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ben@eno.Princeton.EDU  Mon Jun 23 17:47:50 1997
From: ben@eno.Princeton.EDU (Ben Bolker)
Date: Mon, 23 Jun 1997 12:47:50 -0400 (EDT)
Subject: R-alpha: various graphics Q.
Message-ID: <Pine.SUN.3.95.970623124059.6009A-100000@paca>


  "contour" can't return a list of contours (it would be nice)

  "arrows" has different options from S-PLUS (no "open" or "rel" options,
no "lwd" parameter or graphics parameter pass-through; "size" in S
corresponds to "length" in R).  [I know we needn't follow S-PLUS syntax
slavishly, but it would be nice at least to compile a more-or-less
comprehensive list of differences.]

   The xaxs option "i" (no extra space around xlim, ylim) isn't documented

   axis() first argument is called "side" (not "which" as in S: see
comment above)

In lines 5-8 I correct what I think is a bug -- since "cra" (character
size in rasters)  doesn't change with "cex", the legend line-spacing
doesn't change correctly for cex>1.
   The other changes, which should definitely be considered optional, adds
the capability I've always wanted in legends -- to be able to mix symbols
and lines in the same legend without having to have a symbol or a line for
every item in the legend, and to be able to put symbols and lines in the
same column (option "merge").  The spacing's not quite perfect, though.

3c3
< 	xjust=0, yjust=1, merge=FALSE, ...)
---
> 	xjust=0, yjust=1, ...)
5,8c5,8
< 	xchar <- xinch(par("cin")[1])*par("cex")
< 	ychar <- yinch(par("cin")[2])*1.2*par("cex")
< 	xbox <- xinch(par("cin")[2]*0.8)*par("cex")
< 	ybox <- yinch(par("cin")[2]*0.8)*par("cex")
---
> 	xchar <- xinch(par("cin")[1])
> 	ychar <- yinch(par("cin")[2]) * 1.2
> 	xbox <- xinch(par("cin")[2] * 0.8)
> 	ybox <- yinch(par("cin")[2] * 0.8)
50c50
< 		if (!merge) xt <- xt + xbox + xchar
---
> 		xt <- xt + xbox + xchar
52d51
< 	col _ rep(col,length.out=length(legend))
54,57c53,54
< 	    pch _ rep(pch,length.out=length(legend))
<                 ok _ (is.character(pch) | pch>0)
< 		points((xt + 0.25 * xchar)[ok], yt[ok], pch[ok], col=col[ok])
< 		if (!merge) xt <- xt + 1.5 * xchar
---
> 		points(xt + 0.25 * xchar, yt, pch, col=col)
> 		xt <- xt + 1.5 * xchar
60,66c57,58
< 	    lty _ rep(lty,length.out=length(legend))
<                 ok _ (lty>0)
< 	        if (merge) segments((xt-xchar)[ok], yt[ok], (xt + xchar)[ok],
< 			yt[ok], lty=lty[ok], col=col[ok])
< 		else segments(xt[ok], yt[ok], (xt + 2 * xchar)[ok],
< 			yt[ok], lty=lty[ok], col=col[ok])
< 		if (!merge) xt <- xt + 3 * xchar
---
> 		segments(xt, yt, xt + 2 * xchar, yt, lty=lty, col=col)
> 		xt <- xt + 3 * xchar
68d59
<         if (merge) xt <- xt + 3 * xchar



=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Mon Jun 23 18:05:04 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Mon, 23 Jun 1997 19:05:04 +0200
Subject: R-alpha: comparing alpha and numeric
In-Reply-To: <Pine.SUN.3.95.970623094548.1180A-100000@zen> (message from
 Thomas Lumley on Mon, 23 Jun 1997 09:46:57 -0700 (PDT))
Message-ID: <199706231705.TAA04361@sophie.ethz.ch>

The solution is :
 If one of them is  character(), both are coerced to and then compared..

which 'naturally' gives

> "23"<3   <-->  "23" < "3"   <-->  "AB" < "B"
[1] TRUE
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Mon Jun 23 22:52:00 1997
From: ihaka@stat.auckland.ac.nz (Ross &)
Date: Tue, 24 Jun 1997 09:52:00 +1200 (NZST)
Subject: R-alpha: Silence
Message-ID: <199706232152.JAA28442@stat1.stat.auckland.ac.nz>

I've been "out" (literally and figuratively) with a virus for the past
week or so.  One quick observation though

	"23" < 3

is a STRING comparison because of type coercion.  Thus returning
TRUE is correct.
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Jun 24 08:21:56 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 24 Jun 1997 09:21:56 +0200
Subject: R-alpha: funny behavior of  data(.)
Message-ID: <199706240721.JAA04748@sophie.ethz.ch>

This is wierd....

It looks like the problem appears when  data(..) is immediately followed 
by another statement USING ``;''
		     -----------	
 rm(list=ls())
 data(phones); summary(phones)
	Error: Object "phones" not found
 ls()
	character(0)

Or also

 ls()
	character(0)
 data(pigs); 1:10
			##-- nothing is printed, but here 'pigs' is sourced
 ls()
	[1] "pigs"


--------------
Could it be a parser bug of  `` expr1 ; expr2 '' ??




=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From jlindsey@luc.ac.be  Wed Jun 25 10:20:50 1997
From: jlindsey@luc.ac.be (Jim Lindsey)
Date: Wed, 25 Jun 1997 11:20:50 +0200 (MET DST)
Subject: R-alpha: lbeta, ctrl-C and crashes
Message-ID: <9706250920.AA11845@alpha.luc.ac.be>

1. lbeta and beta do not work properly: lbeta returns its first
argument and beta gives the lbeta result. 
In names.c lines 245-6, the codes for these should be 2 and 3 instead
of 1 and 2

2. crtl-C does not work (except the first time) on Red Hat elf Linux
(which has many many other problems as well) nor on the previous
version of Linux for Amiga. It worked on Slackware aout Linux and now
works on the most recent version of Linux for the Amiga. It also works
correctly on a Sun.

3. I suspect that my core dump problem may arise from repeated calls
to complex R functions with big data vectors from C code as occurs
with nlm interating to find the MLE.  Doing a gc() between uses of nlm
seems to reduce the problem.

Jim
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Martin Maechler <maechler@stat.math.ethz.ch>  Wed Jun 25 10:30:03 1997
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 25 Jun 1997 11:30:03 +0200
Subject: R-alpha: lbeta, .. etc
In-Reply-To: <9706250920.AA11845@alpha.luc.ac.be> (message from Jim Lindsey on
 Wed, 25 Jun 1997 11:20:50 +0200 (MET DST))
Message-ID: <199706250930.LAA05653@sophie.ethz.ch>

>>>>> "Jim" == Jim Lindsey <jlindsey@luc.ac.be> writes:

    Jim> 1. lbeta and beta do not work properly: lbeta returns its first
    Jim> argument and beta gives the lbeta result.  In names.c lines 245-6,
    Jim> the codes for these should be 2 and 3 instead of 1 and 2

    Jim> 2. crtl-C does not work (except the first time) on Red Hat elf
    Jim> Linux (which has many many other problems as well) nor on the
    Jim> previous version of Linux for Amiga. It worked on Slackware aout
    Jim> Linux and now works on the most recent version of Linux for the
    Jim> Amiga. It also works correctly on a Sun.

Both of these problems have been reported before, here.
However, Jim hasn't been subscribed, ``back then''.

Ross has found (about 6 weeks ago...) that problem '1.'
is simply a  "cut & paste" typo in  RHOME/main/names.c
(old code has been doubled by accident).

Here is the patch which just deletes about a dozen lines in  names.c

--- /usr/local/R-0.49-RR/src/main/names.c	Fri May 16 15:00:56 1997
+++ names.c	Wed May 14 09:23:14 1997
@@ -240,34 +240,6 @@
 
 #endif
 
-/* Mathematical Functions of Two Variables */
-
-{"lbeta",	do_math2,	1,	1,	2,	PP_FUNCALL,	0},
-{"beta",	do_math2,	2,	1,	2,	PP_FUNCALL,	0},
-{"lchoose",	do_math2,	4,	1,	2,	PP_FUNCALL,	0},
-{"choose",	do_math2,	5,	1,	2,	PP_FUNCALL,	0},
-
-{"dchisq",	do_math2,	6,	1,	2,	PP_FUNCALL,	0},
-{"pchisq",	do_math2,	7,	1,	2,	PP_FUNCALL,	0},
-{"qchisq",	do_math2,	8,	1,	2,	PP_FUNCALL,	0},
-
-{"dexp",	do_math2,	9,	11,	2,	PP_FUNCALL,	0},
-{"pexp",	do_math2,	10,	11,	2,	PP_FUNCALL,	0},
-{"qexp",	do_math2,	11,	11,	2,	PP_FUNCALL,	0},
-
-{"dgeom",	do_math2,	12,	1,	2,	PP_FUNCALL,	0},
-{"pgeom",	do_math2,	13,	1,	2,	PP_FUNCALL,	0},
-{"qgeom",	do_math2,	14,	1,	2,	PP_FUNCALL,	0},
-
-{"dpois",	do_math2,	15,	1,	2,	PP_FUNCALL,	0},
-{"ppois",	do_math2,	16,	1,	2,	PP_FUNCALL,	0},
-{"qpois",	do_math2,	17,	1,	2,	PP_FUNCALL,	0},
-
-{"dt",		do_math2,	18,	1,	2,	PP_FUNCALL,	0},
-{"pt",		do_math2,	19,	1,	2,	PP_FUNCALL,	0},
-{"qt",		do_math2,	20,	1,	2,	PP_FUNCALL,	0},
-
-
 /* Mathematical Functions of Three Variables */
 
 {"dbeta",	do_math3,	1,	1,	3,	PP_FUNCALL,	0},
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From jlindsey@luc.ac.be  Wed Jun 25 10:47:00 1997
From: jlindsey@luc.ac.be (Jim Lindsey)
Date: Wed, 25 Jun 1997 11:47:00 +0200 (MET DST)
Subject: R-alpha: lbeta
Message-ID: <9706250947.AA03921@alpha.luc.ac.be>

Why is the patch for lbeta not included in the two patches distributed
to ordinary human beings? Jim
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From colin@geology.gla.ac.uk  Wed Jun 25 12:20:47 1997
From: colin@geology.gla.ac.uk (Colin Farrow)
Date: Wed, 25 Jun 1997 12:20:47 +0100
Subject: R-alpha: R and Mac
Message-ID: <199706251120.MAA06822@alligin.gla.ac.uk>


A recent question asked


Is there anyone using R in the Mac? Answer yes.


but when will we see Rbeta on 68k or powermacs?


--------------------
                     \
Colin Farrow          \
                       \---------------------------------------
                        \                                       \
Department of Geology,   \ E-mail: colin@geology.gla.ac.uk       \
University of Glasgow,    \                                       \
Glasgow, G12 8QQ. Scotland \ Tel: +44 (0)41 339 8855 x5466         \
                            \ Fax: +44 (0)41 330 4817               \
`````````````````````````````````````````````````````````````````````````
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From jlindsey@luc.ac.be  Wed Jun 25 13:07:04 1997
From: jlindsey@luc.ac.be (Jim Lindsey)
Date: Wed, 25 Jun 1997 14:07:04 +0200 (MET DST)
Subject: R-alpha: R on 68K
Message-ID: <9706251207.AA26544@alpha.luc.ac.be>

R runs perfectly under 68K Linux on Mac, Amiga and Atari. Jim
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Wed Jun 25 16:39:33 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Wed, 25 Jun 1997 08:39:33 -0700 (PDT)
Subject: R-alpha: lbeta, ctrl-C and crashes
In-Reply-To: <9706250920.AA11845@alpha.luc.ac.be>
Message-ID: <Pine.SUN.3.95.970625083652.2283A-100000@zen>

On Wed, 25 Jun 1997, Jim Lindsey wrote:
> 
> 2. crtl-C does not work (except the first time) on Red Hat elf Linux
> (which has many many other problems as well) nor on the previous
> version of Linux for Amiga. It worked on Slackware aout Linux and now
> works on the most recent version of Linux for the Amiga. It also works
> correctly on a Sun.

It seems to work on Debian Linux (elf, 2.0.27) 

Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Wed Jun 25 19:18:45 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Wed, 25 Jun 1997 20:18:45 +0200
Subject: R-alpha: several bugs ...
Message-ID: <199706251818.UAA00252@aragorn.ci.tuwien.ac.at>

Perhaps I'd better not send any bug reports in order not to delay the
release of 0.50 ... but nevertheless.

R> x <- rnorm(20)
R> y <- rnorm(20)
R> z <- lm(y ~ x)

R> typeof(z)
[1] "list"

R> unlist(z)
[[1]]
[1] 0.07030757

[[2]]
[1] -0.1790483

[[3]]
NULL

[[4]]
NULL

and many more ending in

[[152]]
NULL

[[153]]
NULL

[[154]]
NULL

Hmm ...

*****************************************************************

Also, it seems that effects.lm, predict.default for lm objects,
update.lm and even formula.lm do not work.

E.g., predict.default does not take care of the one-arg case (and hence
dies when calling as.matrix on NULL), and in the 2-arg case tries to use
object$intercept and object$covmat which do not exist (in the lm case).

Hmm ... this is not meant as a `usual' passive bug report.  Is anybody
working on fixing these problems?  If not, I am willing to have a look,
but I can't promise that I'll get it done within very soon.

R&R, do we have a scheduled release date for the next version?

Best,
-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Thu Jun 26 06:36:34 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Thu, 26 Jun 1997 07:36:34 +0200
Subject: R-alpha: lbeta, ctrl-C and crashes
In-Reply-To: <Pine.SUN.3.95.970625083652.2283A-100000@zen>
References: <9706250920.AA11845@alpha.luc.ac.be>
 <Pine.SUN.3.95.970625083652.2283A-100000@zen>
Message-ID: <199706260536.HAA00517@aragorn.ci.tuwien.ac.at>

>>>>> Thomas Lumley writes:

> On Wed, 25 Jun 1997, Jim Lindsey wrote:
>> 
>> 2. crtl-C does not work (except the first time) on Red Hat elf Linux
>> (which has many many other problems as well) nor on the previous
>> version of Linux for Amiga. It worked on Slackware aout Linux and now
>> works on the most recent version of Linux for the Amiga. It also works
>> correctly on a Sun.

> It seems to work on Debian Linux (elf, 2.0.27)

Are we talking about `while (1) { print("whatever") } RET ... CTRL-C'
and then again and again?  As said, works perfectly under Debian 1.3
with a 2.0.27 kernel.

What are the other problems with Red Hat?

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Thu Jun 26 07:03:29 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Thu, 26 Jun 1997 08:03:29 +0200
Subject: R-alpha: lbeta, .. etc
In-Reply-To: <199706250930.LAA05653@sophie.ethz.ch>
References: <9706250920.AA11845@alpha.luc.ac.be>
 <199706250930.LAA05653@sophie.ethz.ch>
Message-ID: <199706260603.IAA00927@aragorn.ci.tuwien.ac.at>

>>>>> Martin Maechler writes:

>>>>> "Jim" == Jim Lindsey <jlindsey@luc.ac.be> writes:
Jim> 1. lbeta and beta do not work properly: lbeta returns its first
Jim> argument and beta gives the lbeta result.  In names.c lines 245-6,
Jim> the codes for these should be 2 and 3 instead of 1 and 2

Jim> 2. crtl-C does not work (except the first time) on Red Hat elf
Jim> Linux (which has many many other problems as well) nor on the
Jim> previous version of Linux for Amiga. It worked on Slackware aout
Jim> Linux and now works on the most recent version of Linux for the
Jim> Amiga. It also works correctly on a Sun.

> Both of these problems have been reported before, here.
> However, Jim hasn't been subscribed, ``back then''.

> Ross has found (about 6 weeks ago...) that problem '1.'
> is simply a  "cut & paste" typo in  RHOME/main/names.c
> (old code has been doubled by accident).

> Here is the patch which just deletes about a dozen lines in  names.c

> ...

Actually, I must have missed that patch, too.  I'll rebuild my Debian
packages right away ...

Re official versus non-official patches.  What I could do is put all
patches that were posted on r-devel and look reasonable into CRAN (e.g.,
src/patches).  However, R&R will probably not be too happy about the
existence of unofficial patches ...

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From jlindsey@luc.ac.be  Thu Jun 26 08:07:47 1997
From: jlindsey@luc.ac.be (Jim Lindsey)
Date: Thu, 26 Jun 1997 09:07:47 +0200 (MET DST)
Subject: R-alpha: R on 68K
In-Reply-To: <199706260608.IAA00936@aragorn.ci.tuwien.ac.at> from "Kurt Hornik" at Jun 26, 97 08:08:49 am
Message-ID: <9706260707.AA16200@alpha.luc.ac.be>


> 
> >>>>> Jim Lindsey writes:
> 
> > R runs perfectly under 68K Linux on Mac, Amiga and Atari. Jim
> 
> Just checking:  This means you can build from the sources and everything
> is fine, right?
> 
> -k
> 

Yes my son has R running on Amiga since last September and it is the
same basic Linux for the three, so I assume it works for the other two
as well.
  Jim
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Thu Jun 26 09:43:06 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 26 Jun 1997 10:43:06 +0200
Subject: R-alpha: lbeta, ctrl-C and crashes
In-Reply-To: Kurt Hornik's message of Thu, 26 Jun 1997 07:36:34 +0200
References: <9706250920.AA11845@alpha.luc.ac.be>
 <Pine.SUN.3.95.970625083652.2283A-100000@zen>
 <199706260536.HAA00517@aragorn.ci.tuwien.ac.at>
Message-ID: <x23eq5rbz9.fsf@bush.kubism.ku.dk>

Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

> Are we talking about `while (1) { print("whatever") } RET ... CTRL-C'
> and then again and again?  As said, works perfectly under Debian 1.3
> with a 2.0.27 kernel.

2nd time around, that command loops unstoppably here. 

Redhat 4.1/2.0.28
 
$ ldd R/bin/R.binary 
        libSM.so.6 => /usr/X11R6/lib/libSM.so.6.0
        libICE.so.6 => /usr/X11R6/lib/libICE.so.6.0
        libX11.so.6 => /usr/X11R6/lib/libX11.so.6.1
        libf2c.so.0 => /usr/lib/libf2c.so.0.20
        libdl.so.1 => /lib/libdl.so.1.7.14
        libreadline.so.2 => /usr/lib/libreadline.so.2.0
        libtermcap.so.2 => /lib/libtermcap.so.2.0.8
        libm.so.5 => /lib/libm.so.5.0.8
        libc.so.5 => /lib/libc.so.5.4.23

This is strange. What libs are used by Debian? And on Thomas' system?
-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Thu Jun 26 09:51:05 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Thu, 26 Jun 1997 10:51:05 +0200
Subject: R-alpha: lbeta, ctrl-C and crashes
In-Reply-To: <x23eq5rbz9.fsf@bush.kubism.ku.dk>
References: <9706250920.AA11845@alpha.luc.ac.be>
 <Pine.SUN.3.95.970625083652.2283A-100000@zen>
 <199706260536.HAA00517@aragorn.ci.tuwien.ac.at>
 <x23eq5rbz9.fsf@bush.kubism.ku.dk>
Message-ID: <199706260851.KAA01127@aragorn.ci.tuwien.ac.at>

>>>>> Peter Dalgaard BSA writes:

> Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:
>> Are we talking about `while (1) { print("whatever") } RET ... CTRL-C'
>> and then again and again?  As said, works perfectly under Debian 1.3
>> with a 2.0.27 kernel.

> 2nd time around, that command loops unstoppably here. 

> Redhat 4.1/2.0.28
 
> $ ldd R/bin/R.binary 
>         libSM.so.6 => /usr/X11R6/lib/libSM.so.6.0
>         libICE.so.6 => /usr/X11R6/lib/libICE.so.6.0
>         libX11.so.6 => /usr/X11R6/lib/libX11.so.6.1
>         libf2c.so.0 => /usr/lib/libf2c.so.0.20
>         libdl.so.1 => /lib/libdl.so.1.7.14
>         libreadline.so.2 => /usr/lib/libreadline.so.2.0
>         libtermcap.so.2 => /lib/libtermcap.so.2.0.8
>         libm.so.5 => /lib/libm.so.5.0.8
>         libc.so.5 => /lib/libc.so.5.4.23

> This is strange. What libs are used by Debian? And on Thomas' system?

Hmm.  I get

hornik@aragorn:~/Work/misc$ ldd /usr/local/lib/R/bin/R.binary 
        libSM.so.6 => /usr/X11R6/lib/libSM.so.6		(6.0)
        libICE.so.6 => /usr/X11R6/lib/libICE.so.6	(6.0)
        libX11.so.6 => /usr/X11R6/lib/libX11.so.6	(6.1)
        libdl.so.1 => /lib/libdl.so.1			(1.8.10)
        libreadline.so.2 => /lib/libreadline.so.2	(2.1)
        libm.so.5 => /lib/libm.so.5			(5.0.8)
        libc.so.5 => /lib/libc.so.5			(5.4.23)
        libncurses.so.3.0 => /lib/libncurses.so.3.0	(3.0)

(I added the full version numbers manually.)

The obvious difference is that Debian uses ncurses instead of termcap.

I checked  again a few minutes ago, because Fritz was not sure about the
whole thing either ...

Very interesting ...

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From schwarte@feat.mathematik.uni-essen.de  Thu Jun 26 15:34:59 1997
From: schwarte@feat.mathematik.uni-essen.de (Heiner Schwarte)
Date: Thu, 26 Jun 1997 15:34:59 +0100 (NFT)
Subject: R-alpha: Problem with gc()
Message-ID: <Pine.A32.3.93.970626153101.3426A-100000@feat.mathematik.uni-essen.de>


Could someone plese confirm the following ?
(AIX 4.1.4, 0.49+patch1+patch2a)

################################################################

schwarte@cauchy:[/home/schwarte]>/usr/local/R-0.49/bin/R

R : Copyright 1997, Robert Gentleman and Ross Ihaka
Version 0.49 Beta (April 23, 1997)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type "license()" for details.

> logical(10)
 [1] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
> gc()
Garbage collection ...
149210 cons cells free (74%)
1820k bytes of heap free (93%)
> logical(10)
 [1]  TRUE FALSE  TRUE FALSE  TRUE FALSE  TRUE FALSE  TRUE FALSE
> logical(10)
 [1]  TRUE FALSE  TRUE FALSE  TRUE FALSE  TRUE FALSE  TRUE FALSE

#################################################################


=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Andreas.Weingessel@ci.tuwien.ac.at  Thu Jun 26 14:51:45 1997
From: Andreas.Weingessel@ci.tuwien.ac.at (Andreas Weingessel)
Date: Thu, 26 Jun 1997 15:51:45 +0200
Subject: R-alpha: Problem with gc()
In-Reply-To: <Pine.A32.3.93.970626153101.3426A-100000@feat.mathematik.uni-essen.de>
References: <Pine.A32.3.93.970626153101.3426A-100000@feat.mathematik.uni-essen.de>
Message-ID: <199706261351.PAA00804@elendil.ci.tuwien.ac.at>

>>>>> On Thu, 26 Jun 1997 15:34:59 +0100 (NFT),
>>>>> Heiner Schwarte wrote:

> Could someone plese confirm the following ?
> (AIX 4.1.4, 0.49+patch1+patch2a)

> ################################################################

> schwarte@cauchy:[/home/schwarte]>/usr/local/R-0.49/bin/R

> R : Copyright 1997, Robert Gentleman and Ross Ihaka
> Version 0.49 Beta (April 23, 1997)

> R is free software and comes with ABSOLUTELY NO WARRANTY.
> You are welcome to redistribute it under certain conditions.
> Type "license()" for details.

>> logical(10)
>  [1] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
>> gc()
> Garbage collection ...
> 149210 cons cells free (74%)
> 1820k bytes of heap free (93%)
>> logical(10)
>  [1]  TRUE FALSE  TRUE FALSE  TRUE FALSE  TRUE FALSE  TRUE FALSE
>> logical(10)
>  [1]  TRUE FALSE  TRUE FALSE  TRUE FALSE  TRUE FALSE  TRUE FALSE

> #################################################################


The same on a PC with Linux/Debian-1.3:


R : Copyright 1997, Robert Gentleman and Ross Ihaka
Version 0.49 Beta (April 23, 1997)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type "license()" for details.

R> logical(10)
 [1] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
R>  gc()
Garbage collection ...
142276 cons cells free (71%)
3945k bytes of heap free (96%)
R>  logical(10)
 [1]  TRUE  TRUE  TRUE FALSE FALSE  TRUE  TRUE FALSE  TRUE FALSE
R>  logical(10)
 [1]  TRUE  TRUE  TRUE FALSE  TRUE FALSE  TRUE FALSE  TRUE FALSE
R> 
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ben@eno.Princeton.EDU  Thu Jun 26 15:08:17 1997
From: ben@eno.Princeton.EDU (Ben Bolker)
Date: Thu, 26 Jun 1997 10:08:17 -0400 (EDT)
Subject: R-alpha: Problem with gc()
In-Reply-To: <199706261351.PAA00804@elendil.ci.tuwien.ac.at>
Message-ID: <Pine.SUN.3.95.970626100705.8890A-100000@paca>


  Same on SunOS 4.1.4.

> logical(10)
 [1] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
> gc()
Garbage collection ...
149941 cons cells free (74%)
1821k bytes of heap free (93%)
> logical(10)
 [1]  TRUE FALSE  TRUE FALSE  TRUE FALSE  TRUE FALSE  TRUE FALSE
> 

  Ben

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Thu Jun 26 17:15:27 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 26 Jun 1997 18:15:27 +0200
Subject: R-alpha: lbeta, ctrl-C and crashes
In-Reply-To: Kurt Hornik's message of Thu, 26 Jun 1997 10:51:05 +0200
References: <9706250920.AA11845@alpha.luc.ac.be>
 <Pine.SUN.3.95.970625083652.2283A-100000@zen>
 <199706260536.HAA00517@aragorn.ci.tuwien.ac.at>
 <x23eq5rbz9.fsf@bush.kubism.ku.dk>
 <199706260851.KAA01127@aragorn.ci.tuwien.ac.at>
Message-ID: <x2radppcgw.fsf@bush.kubism.ku.dk>

Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

> > $ ldd R/bin/R.binary 
> >         libSM.so.6 => /usr/X11R6/lib/libSM.so.6.0
> >         libICE.so.6 => /usr/X11R6/lib/libICE.so.6.0
> >         libX11.so.6 => /usr/X11R6/lib/libX11.so.6.1
> >         libf2c.so.0 => /usr/lib/libf2c.so.0.20
> >         libdl.so.1 => /lib/libdl.so.1.7.14
> >         libreadline.so.2 => /usr/lib/libreadline.so.2.0
> >         libtermcap.so.2 => /lib/libtermcap.so.2.0.8
> >         libm.so.5 => /lib/libm.so.5.0.8
> >         libc.so.5 => /lib/libc.so.5.4.23

> hornik@aragorn:~/Work/misc$ ldd /usr/local/lib/R/bin/R.binary 
>         libSM.so.6 => /usr/X11R6/lib/libSM.so.6		(6.0)
>         libICE.so.6 => /usr/X11R6/lib/libICE.so.6	(6.0)
>         libX11.so.6 => /usr/X11R6/lib/libX11.so.6	(6.1)
>         libdl.so.1 => /lib/libdl.so.1			(1.8.10)
>         libreadline.so.2 => /lib/libreadline.so.2	(2.1)
>         libm.so.5 => /lib/libm.so.5			(5.0.8)
>         libc.so.5 => /lib/libc.so.5			(5.4.23)
>         libncurses.so.3.0 => /lib/libncurses.so.3.0	(3.0)
> 
> (I added the full version numbers manually.)
> 
> The obvious difference is that Debian uses ncurses instead of termcap.
> 

Another obvious difference is libreadline2.*1*. I just tried compiling
without readline (edit src/include/Platform.h ; make clean ; make) and
the problem disappeared. However, RedHat still seems to be shipping
libreadline2.0 There are calls to signal() in libreadline, so it
could well be the culprit.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Thu Jun 26 17:28:31 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Thu, 26 Jun 1997 09:28:31 -0700 (PDT)
Subject: R-alpha: lbeta, ctrl-C and crashes
In-Reply-To: <x23eq5rbz9.fsf@bush.kubism.ku.dk>
Message-ID: <Pine.SUN.3.95.970626092741.2845B-100000@zen>

On 26 Jun 1997, Peter Dalgaard BSA wrote:

> This is strange. What libs are used by Debian? And on Thomas' system?
buffy% ldd /biostat/server2/r/linux/R-0.49/bin/R.binary 
        libSM.so.6 => /usr/X11R6/lib/libSM.so.6
        libICE.so.6 => /usr/X11R6/lib/libICE.so.6
        libX11.so.6 => /usr/X11R6/lib/libX11.so.6
        libdl.so.1 => /lib/libdl.so.1
        libreadline.so.2 => /lib/libreadline.so.2
        libm.so.5 => /lib/libm.so.5
        libc.so.5 => /lib/libc.so.5
        libncurses.so.3.0 => /lib/libncurses.so.3.0
buffy% uname -a
Linux buffy 2.0.27 #1 Fri Jan 10 23:46:22 MET 1997 i686 unknown




Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Thu Jun 26 18:23:02 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 26 Jun 1997 19:23:02 +0200
Subject: R-alpha: lbeta, ctrl-C and crashes
In-Reply-To: Peter Dalgaard BSA's message of 26 Jun 1997 18:15:27 +0200
References: <9706250920.AA11845@alpha.luc.ac.be>
 <Pine.SUN.3.95.970625083652.2283A-100000@zen>
 <199706260536.HAA00517@aragorn.ci.tuwien.ac.at>
 <x23eq5rbz9.fsf@bush.kubism.ku.dk>
 <199706260851.KAA01127@aragorn.ci.tuwien.ac.at>
 <x2radppcgw.fsf@bush.kubism.ku.dk>
Message-ID: <x2oh8tp9c9.fsf@bush.kubism.ku.dk>

Peter Dalgaard BSA <p.dalgaard@kubism.ku.dk> writes:

> Another obvious difference is libreadline2.*1*. I just tried compiling
> without readline (edit src/include/Platform.h ; make clean ; make) and
> the problem disappeared. However, RedHat still seems to be shipping
> libreadline2.0 There are calls to signal() in libreadline, so it
> could well be the culprit.

Affirmative. Problem vanished when relinking with a freshly compiled
libreadline.a v.2.1. But there's nothing in the ChangeLog relating to
signal handling bugs fixed since 2.0, so it might be a question of
simply recompiling the library. This would be preferable since it can
be done with the rpm command. Will check later, time to buy dinner
before the shop closes...

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From ihaka@stat.auckland.ac.nz  Thu Jun 26 22:55:08 1997
From: ihaka@stat.auckland.ac.nz (Ross &)
Date: Fri, 27 Jun 1997 09:55:08 +1200 (NZST)
Subject: R-alpha: lbeta, .. etc
In-Reply-To: <199706260603.IAA00927@aragorn.ci.tuwien.ac.at>
References: <9706250920.AA11845@alpha.luc.ac.be>
 <199706250930.LAA05653@sophie.ethz.ch>
 <199706260603.IAA00927@aragorn.ci.tuwien.ac.at>
Message-ID: <199706262155.JAA18490@stat1.stat.auckland.ac.nz>

Kurt Hornik writes:
 > Actually, I must have missed that patch, too.  I'll rebuild my Debian
 > packages right away ...
 > 
 > Re official versus non-official patches.  What I could do is put all
 > patches that were posted on r-devel and look reasonable into CRAN (e.g.,
 > src/patches).  However, R&R will probably not be too happy about the
 > existence of unofficial patches ...

[ With great effort, raises self from death-bed ... ]

I have a heap of stuff "ready to go".  It has been for several weeks,
but various disasters have intervened.  I hope to have a new version
out on monday.  Luke Tierney is visiting for a bit after that and so
there will be other priorities ...


I would like to start a discussion on widening the group of people who
can commit changes to R and create new releases (although maybe new
releases are a one-man job).  At present, the "core group" (those who
can commit changes to the CVS tree) consists of Robert, Martin
Maechler and Myself.  I think it would be feasible to enlarge this
group to perhaps 6 or 7.

At the same time we could open up  the update process so that any
can choose to be on the "bleeding edge".  This is the mechanism which
is used in FreeBSD development, and I think it has proved a good
model.  The necessary software (cvsup) is also pretty readily available.

For those who want stability, there is a twice yearly "stable"
release, and for those who want to suffer, they can have it as
"up-to-date" as they can stand by grabbing the current cvs archive.

Any thoughts?
	Ross
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Fri Jun 27 07:21:35 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Fri, 27 Jun 1997 08:21:35 +0200
Subject: R-alpha: lbeta, ctrl-C and crashes
In-Reply-To: <x2oh8tp9c9.fsf@bush.kubism.ku.dk>
References: <9706250920.AA11845@alpha.luc.ac.be>
 <Pine.SUN.3.95.970625083652.2283A-100000@zen>
 <199706260536.HAA00517@aragorn.ci.tuwien.ac.at>
 <x23eq5rbz9.fsf@bush.kubism.ku.dk>
 <199706260851.KAA01127@aragorn.ci.tuwien.ac.at>
 <x2radppcgw.fsf@bush.kubism.ku.dk>
 <x2oh8tp9c9.fsf@bush.kubism.ku.dk>
Message-ID: <199706270621.IAA01683@aragorn.ci.tuwien.ac.at>

>>>>> Peter Dalgaard BSA writes:

> Peter Dalgaard BSA <p.dalgaard@kubism.ku.dk> writes:
>> Another obvious difference is libreadline2.*1*. I just tried compiling
>> without readline (edit src/include/Platform.h ; make clean ; make) and
>> the problem disappeared. However, RedHat still seems to be shipping
>> libreadline2.0 There are calls to signal() in libreadline, so it
>> could well be the culprit.

> Affirmative. Problem vanished when relinking with a freshly compiled
> libreadline.a v.2.1. But there's nothing in the ChangeLog relating to
> signal handling bugs fixed since 2.0, so it might be a question of
> simply recompiling the library. This would be preferable since it can
> be done with the rpm command. Will check later, time to buy dinner
> before the shop closes...

I see.  That might also explain our confusion when we noticed that we
cannot reproduce the CTRL-C problem.  We just upgraded to Debian 1.3
which has libreadline 2.1.

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Fri Jun 27 07:33:35 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Fri, 27 Jun 1997 08:33:35 +0200
Subject: R-alpha: lbeta, .. etc
In-Reply-To: <199706262155.JAA18490@stat1.stat.auckland.ac.nz>
References: <9706250920.AA11845@alpha.luc.ac.be>
 <199706250930.LAA05653@sophie.ethz.ch>
 <199706260603.IAA00927@aragorn.ci.tuwien.ac.at>
 <199706262155.JAA18490@stat1.stat.auckland.ac.nz>
Message-ID: <199706270633.IAA01692@aragorn.ci.tuwien.ac.at>

>>>>> Ross & writes:

> Kurt Hornik writes:
>> Actually, I must have missed that patch, too.  I'll rebuild my Debian
>> packages right away ...
>> 
>> Re official versus non-official patches.  What I could do is put all
>> patches that were posted on r-devel and look reasonable into CRAN (e.g.,
>> src/patches).  However, R&R will probably not be too happy about the
>> existence of unofficial patches ...

> [ With great effort, raises self from death-bed ... ]

> I have a heap of stuff "ready to go".  It has been for several weeks,
> but various disasters have intervened.  I hope to have a new version
> out on monday.  

Oh boy, do I wish it was Monday already ...

> Luke Tierney is visiting for a bit after that and so there will be
> other priorities ...

(Or try to get Luke involved in the R development ...)

> I would like to start a discussion on widening the group of people who
> can commit changes to R and create new releases (although maybe new
> releases are a one-man job).  At present, the "core group" (those who
> can commit changes to the CVS tree) consists of Robert, Martin
> Maechler and Myself.  I think it would be feasible to enlarge this
> group to perhaps 6 or 7.

(I also treat all patches sent by R&R and Martin as `official', and
apply them asap.)

> At the same time we could open up the update process so that any can
> choose to be on the "bleeding edge".  This is the mechanism which is
> used in FreeBSD development, and I think it has proved a good model.
> The necessary software (cvsup) is also pretty readily available.

> For those who want stability, there is a twice yearly "stable"
> release, and for those who want to suffer, they can have it as
> "up-to-date" as they can stand by grabbing the current cvs archive.

> Any thoughts?

For e.g. Linux, libc, Octave, ... there are two versions, the ones with
even minors are stable releases changed only for bug fixes, the ones
with odd minors are `unstable' development versions which may change
very often.  So e.g., we could start with

	R-0.6		next stable release
	R-0.7		new development tree

I have no experience with situtations where several people can manage
the source tree.  It is perhaps easier to have one person in charge of
that.  On the other hand, obvious cleanups in the interpreted code or in
the documentation do not really require a central authority ...

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Fri Jun 27 11:32:27 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 27 Jun 1997 12:32:27 +0200
Subject: R-alpha: lbeta, ctrl-C and crashes
In-Reply-To: Peter Dalgaard BSA's message of 26 Jun 1997 19:23:02 +0200
References: <9706250920.AA11845@alpha.luc.ac.be>
 <Pine.SUN.3.95.970625083652.2283A-100000@zen>
 <199706260536.HAA00517@aragorn.ci.tuwien.ac.at>
 <x23eq5rbz9.fsf@bush.kubism.ku.dk>
 <199706260851.KAA01127@aragorn.ci.tuwien.ac.at>
 <x2radppcgw.fsf@bush.kubism.ku.dk> <x2oh8tp9c9.fsf@bush.kubism.ku.dk>
Message-ID: <x2en9oibes.fsf@bush.kubism.ku.dk>

Peter Dalgaard BSA <p.dalgaard@kubism.ku.dk> writes:

> > the problem disappeared. However, RedHat still seems to be shipping
> > libreadline2.0 There are calls to signal() in libreadline, so it
> > could well be the culprit.
> 
> Affirmative. Problem vanished when relinking with a freshly compiled
> libreadline.a v.2.1. But there's nothing in the ChangeLog relating to
> signal handling bugs fixed since 2.0, so it might be a question of
> simply recompiling the library.... 

Not so, I'm afraid. There definitely have been changes to signals.c
and recompile doesn't change a thing. Time to push RedHat to make an
upgraded .rpm, I think. They've got a contributed one in
.../contrib/i386 already, I see. 

Hmm. The silly thing installs as libreadline.so.3.0. I wonder what the
point of that is... Means that you have to recompile R to make it use
the new library, but it does seem to work now.

BTW, do we have place to keep these installation related problems, so
that we won't have to answer them over and over again? We had a
similar item with the f2c library setup earlier and C compiler options
on. A series of README.linux, README.hpux, etc. files might do it
(model xfree).

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Kurt.Hornik@ci.tuwien.ac.at  Fri Jun 27 11:32:50 1997
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Fri, 27 Jun 1997 12:32:50 +0200
Subject: R-alpha: lbeta, ctrl-C and crashes
In-Reply-To: <x2en9oibes.fsf@bush.kubism.ku.dk>
References: <9706250920.AA11845@alpha.luc.ac.be>
 <Pine.SUN.3.95.970625083652.2283A-100000@zen>
 <199706260536.HAA00517@aragorn.ci.tuwien.ac.at>
 <x23eq5rbz9.fsf@bush.kubism.ku.dk>
 <199706260851.KAA01127@aragorn.ci.tuwien.ac.at>
 <x2radppcgw.fsf@bush.kubism.ku.dk>
 <x2oh8tp9c9.fsf@bush.kubism.ku.dk>
 <x2en9oibes.fsf@bush.kubism.ku.dk>
Message-ID: <199706271032.MAA02229@aragorn.ci.tuwien.ac.at>

>>>>> Peter Dalgaard BSA writes:

> Peter Dalgaard BSA <p.dalgaard@kubism.ku.dk> writes:
>> > the problem disappeared. However, RedHat still seems to be shipping
>> > libreadline2.0 There are calls to signal() in libreadline, so it
>> > could well be the culprit.
>> 
>> Affirmative. Problem vanished when relinking with a freshly compiled
>> libreadline.a v.2.1. But there's nothing in the ChangeLog relating to
>> signal handling bugs fixed since 2.0, so it might be a question of
>> simply recompiling the library.... 

> Not so, I'm afraid. There definitely have been changes to signals.c
> and recompile doesn't change a thing. Time to push RedHat to make an
> upgraded .rpm, I think. They've got a contributed one in
> .../contrib/i386 already, I see. 

> Hmm. The silly thing installs as libreadline.so.3.0. I wonder what the
> point of that is... Means that you have to recompile R to make it use
> the new library, but it does seem to work now.

> BTW, do we have place to keep these installation related problems, so
> that we won't have to answer them over and over again? We had a
> similar item with the f2c library setup earlier and C compiler options
> on. A series of README.linux, README.hpux, etc. files might do it
> (model xfree).

Great idea!

I was already thinking about adding something to the FAQ, but a pointer
to the README.$platform files is better.

-k
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From p.dalgaard@kubism.ku.dk  Fri Jun 27 14:20:13 1997
From: p.dalgaard@kubism.ku.dk (Peter Dalgaard BSA)
Date: 27 Jun 1997 15:20:13 +0200
Subject: R-alpha: lbeta, ctrl-C and crashes
In-Reply-To: Peter Dalgaard BSA's message of 27 Jun 1997 12:32:27 +0200
References: <9706250920.AA11845@alpha.luc.ac.be>
 <Pine.SUN.3.95.970625083652.2283A-100000@zen>
 <199706260536.HAA00517@aragorn.ci.tuwien.ac.at>
 <x23eq5rbz9.fsf@bush.kubism.ku.dk>
 <199706260851.KAA01127@aragorn.ci.tuwien.ac.at>
 <x2radppcgw.fsf@bush.kubism.ku.dk> <x2oh8tp9c9.fsf@bush.kubism.ku.dk>
 <x2en9oibes.fsf@bush.kubism.ku.dk>
Message-ID: <x2bu4si3n6.fsf@bush.kubism.ku.dk>

Peter Dalgaard BSA <p.dalgaard@kubism.ku.dk> writes:

> similar item with the f2c library setup earlier and C compiler options
> on. A series of README.linux, README.hpux, etc. files might do it
   / HP-UX

[Ugh. Victim of my "scatter/gather" writing style.]

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From Friedrich.Leisch@ci.tuwien.ac.at  Fri Jun 27 15:29:58 1997
From: Friedrich.Leisch@ci.tuwien.ac.at (Friedrich Leisch)
Date: Fri, 27 Jun 1997 16:29:58 +0200
Subject: R-alpha: NA in data frame not detected
Message-ID: <199706271429.QAA05649@galadriel.ci.tuwien.ac.at>


NA's in a data frame are not handled properly, if the data frame was
read in using read.table (but I'm not sure if that is the reason of
the problems):

(I'm using Debian Linux 1.3)

If I read the file

***************
1 2
2 3
3 4
4 5
? 6
6 7
7 8
8 9
***************

into R using read.table I run into troubles:

R : Copyright 1997, Robert Gentleman and Ross Ihaka
Version 0.49 Beta (April 23, 1997)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type "license()" for details.

R> x<-read.table("xxx", na.strings=3D"?")
R> x
  V1 V2
1  1  2
2  2  3
3  3  4
4  4  5
5 NA  6
6  6  7
7  7  8
8  8  9
R> complete.cases(x)
[1] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE
R> x$V1
[1]  1  2  3  4 NA  6  7  8
R> x$V1[5]
[1] NA
R> is.na(x$V1[5])
[1] FALSE


but if I create the same dataframe in R I get the expected results:

R> z<-data.frame(V1=3Dc(1:4, NA, 6:8), y2=3D2:9)
R> z
     V1 y2
[1,]  1  2
[2,]  2  3
[3,]  3  4
[4,]  4  5
[5,] NA  6
[6,]  6  7
[7,]  7  8
[8,]  8  9
R> complete.cases(z)
[1]  TRUE  TRUE  TRUE  TRUE FALSE  TRUE  TRUE  TRUE
R> is.na(z$V1[5])
[1] TRUE




Can anybody confirm this?

--=20
-------------------------------------------------------------------
                        Friedrich  Leisch                            =20
Institut f=FCr Statistik                      Tel: (+43 1) 58801 4541
Technische Universit=E4t Wien                 Fax: (+43 1)  504 14 98
Wiedner Hauptstra=DFe 8-10/1071      Friedrich.Leisch@ci.tuwien.ac.at
A-1040 Wien, Austria             http://www.ci.tuwien.ac.at/~leisch
     PGP public key http://www.ci.tuwien.ac.at/~leisch/pgp.key
-------------------------------------------------------------------

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From schwarte@feat.mathematik.uni-essen.de  Fri Jun 27 20:46:40 1997
From: schwarte@feat.mathematik.uni-essen.de (Heiner Schwarte)
Date: Fri, 27 Jun 1997 20:46:40 +0100 (NFT)
Subject: R-alpha: Re: Problem with gc()
In-Reply-To: <Pine.A32.3.93.970626153101.3426A-100000@feat.mathematik.uni-essen.de>
Message-ID: <Pine.A32.3.93.970627203823.15230B-100000@feat.mathematik.uni-essen.de>

Yesterday I posted a problem with logical() after a gc().

This problem occurs because do_makevector() in the file
builtin.c does not properly initialize the memory if a 
vector of logicals is manufactured. Simply adding an 
initialization  loop solves the problem. ( Following 
line 333 one finds  the initialization for INTSXP and 
REALSXP. Add one for LGLSXP.)

Heiner

  

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

From thomas@biostat.washington.edu  Fri Jun 27 20:21:29 1997
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Fri, 27 Jun 1997 12:21:29 -0700 (PDT)
Subject: R-alpha: NA in data frame not detected
In-Reply-To: <199706271429.QAA05649@galadriel.ci.tuwien.ac.at>
Message-ID: <Pine.SUN.3.95.970627101809.3355E-100000@zen>

On Fri, 27 Jun 1997, Friedrich Leisch wrote:

> 
> NA's in a data frame are not handled properly, if the data frame was
> read in using read.table (but I'm not sure if that is the reason of
> the problems):
> 

The problem is with the na.strings argument of read.table.  If you use
this argument anything with an NA ends up as a factor. In your example the
first column is a factor (though you can't tell by looking at it)
> is.factor(x[,1])
[1] TRUE
> levels(x[,1])
[1] "1"  "2"  "3"  "4"  "6"  "7"  "8"  "NA"
>

The reason is that read.table tries to handle na.strings twice.  The
scan() function gets the na.strings argument and so translates the "?"
into "NA".  The type.convert() function then also gets the na.strings
argument and thinks that NAs are indicated by "?" which is no longer
true. It then decides that the data are not numeric and returns a factor.

The solution seems to be to stop passing na.strings to type.convert(). We
need to keep na.strings in scan() to allow for missing character data.

A patch is at the end of this message. This may break something else,
of course ;-).

Thomas Lumley
------------------------------------------------------+------
Biostatistics		: "Never attribute to malice what  :
Uni of Washington	:  can be adequately explained by  :
Box 357232		:  incompetence" - Hanlon's Razor  :
Seattle WA 98195-7232	:				   :
------------------------------------------------------------

*** read.table.rnew	Fri Jun 27 11:26:15 1997
--- read.table.orig	Fri Jun 27 11:21:20 1997
***************
*** 56,66 ****
          if (length(as.is) != cols) 
                  stop("as.is has the wrong length")
          for (i in 1:cols) {
!                 if (!as.is[i]) {
! 			 data[[i]]<-type.convert(data[[i]])
! #                        data[[i]] <- type.convert(data[[i]], 
! #                                na.strings = na.strings)
! 			}
          }
          #  now we determine row names
          if (missing(row.names)) {
--- 56,64 ----
          if (length(as.is) != cols) 
                  stop("as.is has the wrong length")
          for (i in 1:cols) {
!                 if (!as.is[i]) 
!                         data[[i]] <- type.convert(data[[i]], 
!                                 na.strings = na.strings)
          }
          #  now we determine row names
          if (missing(row.names)) {

=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

