From neuro3000 at hotmail.com  Wed Jun  1 00:51:43 2005
From: neuro3000 at hotmail.com (=?iso-8859-1?B?TmV1cm8gTGVTdXBlckjpcm9z?=)
Date: Wed Jun  1 00:51:54 2005
Subject: [Rd] Problem with fPortfolio
Message-ID: <BAY104-F25D923DC4F415E15250E45AF040@phx.gbl>

Hello,

I hesitate to call this a bug, because I could have forgotten something 
important, but the MarkowitzPortfolio example in fPortfolio does not work 
for me.  Here's my code:

>  library(fPortfolio)
>
>xmpPortfolio("\nStart: Load monthly data set of returns > ")
>         data(berndtInvest)
>         # Exclude Date, Market and Interest Rate columns from data frame,
>         # then multiply by 100 for percentual returns ...
>         berndtAssets = berndtInvest[, -c(1, 11, 18)]
>         rownames(berndtAssets) = berndtInvest[, 1]
>         head(berndtAssets)
         CITCRP  CONED CONTIL DATGEN    DEC  DELTA GENMIL GERBER    IBM  
MOBIL  PANAM   PSNH  TANDY TEXACO
1-Jan-78 -0.115 -0.079 -0.129 -0.084 -0.100 -0.028 -0.099 -0.048 -0.029 
-0.046  0.025 -0.008 -0.075 -0.054
1-Feb-78 -0.019 -0.003  0.037 -0.097 -0.063 -0.033  0.018  0.160 -0.043 
-0.017 -0.073 -0.025 -0.004 -0.010
1-Mar-78  0.059  0.022  0.003  0.063  0.010  0.070 -0.023 -0.036 -0.063  
0.049  0.184  0.026  0.124  0.015
1-Apr-78  0.127 -0.005  0.180  0.179  0.165  0.150  0.046  0.004  0.130  
0.077  0.089 -0.008  0.055  0.000
1-May-78  0.005 -0.014  0.061  0.052  0.038 -0.031  0.063  0.046 -0.018 
-0.011  0.082  0.019  0.176 -0.029
1-Jun-78  0.007  0.034 -0.059 -0.023 -0.021  0.023  0.008  0.028 -0.004 
-0.043  0.019  0.032 -0.014 -0.025
          WEYER
1-Jan-78 -0.116
1-Feb-78 -0.135
1-Mar-78  0.084
1-Apr-78  0.144
1-May-78 -0.031
1-Jun-78  0.005
>
>      ## Markowitz Portfolios:
>         myPortfolio = portfolioMarkowitz(berndtAssets, targetReturn = 
>20/100/12)
Error in portfolioMarkowitz(berndtAssets, targetReturn = 20/100/12) :
        Object "pfolio" not found

>version
         _
platform i386-pc-mingw32
arch     i386
os       mingw32
system   i386, mingw32
status   Patched
major    2
minor    1.0
year     2005
month    05
day      09
language R
>

From ggrothendieck at gmail.com  Wed Jun  1 03:21:24 2005
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Wed Jun  1 03:21:33 2005
Subject: [Rd] Re: [R] Problem going back to a viewport with gridBase
In-Reply-To: <429CFA42.4080106@stat.auckland.ac.nz>
References: <971536df05053020191ebe8f44@mail.gmail.com>
	<429CEA59.7020206@stat.auckland.ac.nz>
	<971536df050531163353031d97@mail.gmail.com>
	<429CFA42.4080106@stat.auckland.ac.nz>
Message-ID: <971536df05053118215366e02c@mail.gmail.com>

[moved from r-help to r-devel]

On 5/31/05, Paul Murrell <p.murrell@auckland.ac.nz> wrote:

> >    # mm.row[j] gives the row in the layout of the jth cell
> >    # mm.col[j] gives the col in the layout of the jth cell
> >    mm <- matrix(seq(nr*nc), nr, nc)
> >    mm.row <- c(row(mm))
> >    mm.col <- c(col(mm))
> >
> >   # go to next cell in the array
> >    j <- j + 1 # increment position
> >   pushViewport(viewport(layout.pos.row = mm.row[j], layout.pos.col = mm.col[j]))
> >
> > Is that how to do it or is there some layout/mfcol-like way?
> 
> 
> That is how to do it.
> 
> As far as grid is concerned, all viewports are equal and grid has no
> idea whether a viewport corresponds to a "plot region" or a "margin" or
> whatever, so grid has no concept of which viewport is the "next" one to use.
> 

OK. Thanks.  One suggestion.  Maybe the cells in a layout could have
an order to them and there could be an optional argument that takes a linear
index directly allowing easy linear traversals:

for(i in seq(nr*nc)) {
   pushViewport(viewport(i)) # might need different syntax here
   xyplot(seq(i) ~ seq(i))
   popViewport()
}

and taking it one further perhaps 'with' could have a viewport method 
that automatically pushes the viewport on entry and pops or moves
up one level on exit reducing the above to:

for(i in seq(nr*nc)) with(viewport(i), xyplot(seq(i) ~ seq(i)))

From ligges at statistik.uni-dortmund.de  Wed Jun  1 08:28:30 2005
From: ligges at statistik.uni-dortmund.de (Uwe Ligges)
Date: Wed Jun  1 08:27:30 2005
Subject: [Rd] Problem with fPortfolio
In-Reply-To: <BAY104-F25D923DC4F415E15250E45AF040@phx.gbl>
References: <BAY104-F25D923DC4F415E15250E45AF040@phx.gbl>
Message-ID: <429D558E.7050608@statistik.uni-dortmund.de>

Yes, looks like a bug in package fPortfolio.
Please report bugs in conztributed packages to the package maintainer 
(look at e.g. library(help=fPortfolio)) rather than to an R list.
Thank you.

Uwe Ligges


Neuro LeSuperH?ros wrote:

> Hello,
> 
> I hesitate to call this a bug, because I could have forgotten something 
> important, but the MarkowitzPortfolio example in fPortfolio does not 
> work for me.  Here's my code:
> 
>>  library(fPortfolio)
>>
>> xmpPortfolio("\nStart: Load monthly data set of returns > ")
>>         data(berndtInvest)
>>         # Exclude Date, Market and Interest Rate columns from data frame,
>>         # then multiply by 100 for percentual returns ...
>>         berndtAssets = berndtInvest[, -c(1, 11, 18)]
>>         rownames(berndtAssets) = berndtInvest[, 1]
>>         head(berndtAssets)
> 
>         CITCRP  CONED CONTIL DATGEN    DEC  DELTA GENMIL GERBER    IBM  
> MOBIL  PANAM   PSNH  TANDY TEXACO
> 1-Jan-78 -0.115 -0.079 -0.129 -0.084 -0.100 -0.028 -0.099 -0.048 -0.029 
> -0.046  0.025 -0.008 -0.075 -0.054
> 1-Feb-78 -0.019 -0.003  0.037 -0.097 -0.063 -0.033  0.018  0.160 -0.043 
> -0.017 -0.073 -0.025 -0.004 -0.010
> 1-Mar-78  0.059  0.022  0.003  0.063  0.010  0.070 -0.023 -0.036 -0.063  
> 0.049  0.184  0.026  0.124  0.015
> 1-Apr-78  0.127 -0.005  0.180  0.179  0.165  0.150  0.046  0.004  0.130  
> 0.077  0.089 -0.008  0.055  0.000
> 1-May-78  0.005 -0.014  0.061  0.052  0.038 -0.031  0.063  0.046 -0.018 
> -0.011  0.082  0.019  0.176 -0.029
> 1-Jun-78  0.007  0.034 -0.059 -0.023 -0.021  0.023  0.008  0.028 -0.004 
> -0.043  0.019  0.032 -0.014 -0.025
>          WEYER
> 1-Jan-78 -0.116
> 1-Feb-78 -0.135
> 1-Mar-78  0.084
> 1-Apr-78  0.144
> 1-May-78 -0.031
> 1-Jun-78  0.005
> 
>>
>>      ## Markowitz Portfolios:
>>         myPortfolio = portfolioMarkowitz(berndtAssets, targetReturn = 
>> 20/100/12)
> 
> Error in portfolioMarkowitz(berndtAssets, targetReturn = 20/100/12) :
>        Object "pfolio" not found
> 
>> version
> 
>         _
> platform i386-pc-mingw32
> arch     i386
> os       mingw32
> system   i386, mingw32
> status   Patched
> major    2
> minor    1.0
> year     2005
> month    05
> day      09
> language R
> 
>>
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

From maechler at stat.math.ethz.ch  Wed Jun  1 08:57:18 2005
From: maechler at stat.math.ethz.ch (maechler@stat.math.ethz.ch)
Date: Wed Jun  1 08:57:25 2005
Subject: [Rd] qcauchy accuracy (PR#7902)
Message-ID: <20050601065718.37105A1C3@slim.kubism.ku.dk>

>>>>> "Morten" == Morten Welinder <mwelinder@gmail.com>
>>>>>     on Fri, 27 May 2005 20:24:36 +0200 (CEST) writes:

    Morten> Full_Name: Morten Welinder Version: 2.1.0 OS: src
    Morten> only Submission from: (NULL) (216.223.241.212)


    Morten> Now that pcauchy has been fixed, it is becoming
    Morten> clear that qcauchy suffers from the same problems.

    Morten>
    Morten> qcauchy(pcauchy(1e100,0,1,FALSE,TRUE),0,1,FALSE,TRUE)

    Morten> should yield 1e100 back, but I get 1.633178e+16.
    Morten> The code below does much better.  Notes:

    Morten> 1. p need not be finite.  -Inf is ok in the log_p
    Morten> case and R_Q_P01_check already checks things.

yes

    Morten> 2. No need to disallow scale=0 and infinite
    Morten> location.

yes

    Morten> 3. The code below uses isnan and finite directly.
    Morten> It needs to be adapted to the R way of doing that.

I've done this, and started testing the new code; a version will
be put into the next version of R.

Thank you for the suggestions.

   >> double
   >> qcauchy (double p, double location, double scale, int lower_tail, int log_p)
   >> {
   >>   if (isnan(p) || isnan(location) || isnan(scale))
   >>     return p + location + scale;

   >>   R_Q_P01_check(p);
   >>   if (scale < 0 || !finite(scale)) ML_ERR_return_NAN;

   >>   if (log_p) {
   >>     if (p > -1)
   >>        lower_tail = !lower_tail, p = -expm1 (p);
   >>     else
   >>        p = exp (p);
   >>   }
   >>   if (lower_tail) scale = -scale;
   >>   return location + scale / tan(M_PI * p);
   >> }

From maechler at stat.math.ethz.ch  Wed Jun  1 10:21:06 2005
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Wed Jun  1 10:21:13 2005
Subject: [Rd] 1/tan(-0) != 1/tan(0)  
In-Reply-To: <20050601065718.37105A1C3@slim.kubism.ku.dk>
References: <20050601065718.37105A1C3@slim.kubism.ku.dk>
Message-ID: <17053.28658.832404.930124@stat.math.ethz.ch>

Testing the code that Morten Welinder suggested for improving
extreme tail behavior of  qcauchy(),
I found what you can read in the subject.
namely that the tan() + floating-point implementation on all
four different versions of Redhat linux, I have access to on
i686 and amd64 architectures,

    > 1/tan(c(-0,0))
gives
    -Inf  Inf

and of course, that can well be considered a feature, since
after all, the tan() function does jump from -Inf to +Inf at 0. 
I was still surprised that this even happens on the R level,
and I wonder if this distinction of "-0" and "0" shouldn't be
mentioned in some place(s) of the R documentation.

For the real problem, the R source (in C), It's simple
to work around the fact that
    qcauchy(0, log=TRUE)
for Morten's code proposal gives -Inf instead of +Inf.

Martin


>>>>> "MM" == Martin Maechler <maechler@stat.math.ethz.ch>
>>>>>     on Wed,  1 Jun 2005 08:57:18 +0200 (CEST) writes:

>>>>> "Morten" == Morten Welinder <mwelinder@gmail.com>
>>>>>     on Fri, 27 May 2005 20:24:36 +0200 (CEST) writes:

	  .............

    Morten> Now that pcauchy has been fixed, it is becoming
    Morten> clear that qcauchy suffers from the same problems.

    Morten> 
    Morten> qcauchy(pcauchy(1e100,0,1,FALSE,TRUE),0,1,FALSE,TRUE)

    Morten> should yield 1e100 back, but I get 1.633178e+16.
    Morten> The code below does much better.  Notes:

    Morten> 1. p need not be finite.  -Inf is ok in the log_p
    Morten> case and R_Q_P01_check already checks things.

    MM> yes

    Morten> 2. No need to disallow scale=0 and infinite
    Morten> location.

    MM> yes

    Morten> 3. The code below uses isnan and finite directly.
    Morten> It needs to be adapted to the R way of doing that.

    MM> I've done this, and started testing the new code; a version will
    MM> be put into the next version of R.

    MM> Thank you for the suggestions.

    >>> double
    >>> qcauchy (double p, double location, double scale, int lower_tail, int log_p)
    >>> {
    >>> if (isnan(p) || isnan(location) || isnan(scale))
    >>> return p + location + scale;

    >>> R_Q_P01_check(p);
    >>> if (scale < 0 || !finite(scale)) ML_ERR_return_NAN;

    >>> if (log_p) {
    >>> if (p > -1)
    >>> lower_tail = !lower_tail, p = -expm1 (p);
    >>> else
    >>> p = exp (p);
    >>> }
    >>> if (lower_tail) scale = -scale;
    >>> return location + scale / tan(M_PI * p);
    >>> }

From Ted.Harding at nessie.mcc.ac.uk  Wed Jun  1 11:50:14 2005
From: Ted.Harding at nessie.mcc.ac.uk ( (Ted Harding))
Date: Wed Jun  1 12:01:05 2005
Subject: [Rd] 1/tan(-0) != 1/tan(0)
In-Reply-To: <17053.28658.832404.930124@stat.math.ethz.ch>
Message-ID: <XFMail.050601105014.Ted.Harding@nessie.mcc.ac.uk>

On 01-Jun-05 Martin Maechler wrote:
> Testing the code that Morten Welinder suggested for improving
> extreme tail behavior of  qcauchy(),
> I found what you can read in the subject.
> namely that the tan() + floating-point implementation on all
> four different versions of Redhat linux, I have access to on
> i686 and amd64 architectures,
> 
>     > 1/tan(c(-0,0))
> gives
>     -Inf  Inf
> 
> and of course, that can well be considered a feature, since
> after all, the tan() function does jump from -Inf to +Inf at 0. 
> I was still surprised that this even happens on the R level,
> and I wonder if this distinction of "-0" and "0" shouldn't be
> mentioned in some place(s) of the R documentation.

Indeed I would myself consider this a very useful feature!

However, a query: Clearly from the above (ahich I can reproduce
too), tan() can distinguish between -0 and +0, and return
different results (otherwise 1/tan() would not return different
results).

But how can the user tell the difference between +0 amnd -0?
I've tried the following:

  > sign(c(-0,0))
  [1] 0 0
  > sign(tan(c(-0,0)))
  [1] 0 0
  > sign(1/tan(c(-0,0)))
  [1] -1  1

so sign() is not going to tell us. Is there a function which can?

Short of wrting one's own:

  sign0 <-
    function(x){
      if(abs(x)>0) stop("For this test x must be +0 or -0")
      return(sign(1/tan(x)))
    }

;)

Best wishes,
Ted.


--------------------------------------------------------------------
E-Mail: (Ted Harding) <Ted.Harding@nessie.mcc.ac.uk>
Fax-to-email: +44 (0)870 094 0861
Date: 01-Jun-05                                       Time: 10:50:06
------------------------------ XFMail ------------------------------

From mwelinder at gmail.com  Wed Jun  1 16:16:17 2005
From: mwelinder at gmail.com (Morten Welinder)
Date: Wed Jun  1 16:16:25 2005
Subject: [Rd] Re: 1/tan(-0) != 1/tan(0)
In-Reply-To: <17053.28658.832404.930124@stat.math.ethz.ch>
References: <20050601065718.37105A1C3@slim.kubism.ku.dk>
	<17053.28658.832404.930124@stat.math.ethz.ch>
Message-ID: <118833cc050601071618434dcd@mail.gmail.com>

> For the real problem, the R source (in C), It's simple
> to work around the fact that
>     qcauchy(0, log=TRUE)
> for Morten's code proposal gives -Inf instead of +Inf.

Ouch.  Good catch.

Here is what happened: I reduced 1-exp(x) to -expm1(x) which is actual wrong for
x=0 because the results will be differently signed zeros.

I should have reduced 1-exp(x) to 0-expm1(x).

In light of this, any use of R_DT_qIv and R_DT_CIv might have the same problem.
(But, quite frankly, all uses of R_DT_qIv should be eliminated anyway.
 Only qnorm
seems to be using it without killing the right-tail and the log cases.)

Morten

From bela_b at gmx.net  Wed Jun  1 18:33:20 2005
From: bela_b at gmx.net (Bela Bauer)
Date: Wed Jun  1 18:33:29 2005
Subject: [Rd] anova.mlm again
Message-ID: <20050601183320.682b8a88@bela>

[hope this doesn't get posted twice, my first mail bounced]

Hi,

again, this is about the call bug in anova.mlm. I originally reported it 
as PR#7898 and I suggested a fix at PR#7904. (None of these message were 
forwarded to R-Devel, instead I received a bounce telling me that my 
provider's SPF settings are incorrect. They are, though, so there seems 
to be a problem with the forwarder).

The fix suggested in PR#7904 doesn't resolve all problems; it fixes the 
call for the fit objects, but the same problems occurs for idata. Hence, 
there needs to be an additional change made to anova.mlm. I basically 
changed anova.mlm to the following:
#...
    if(length(list(object, ...)) > 1){
        cl <- match.call()
        cl[[1]] <- as.name("anova.mlmlist")
        cl[[2]] <- list(object, ...)
        if (!is.null(cl$idata)) {
            cl$idata <- idata
        }
        return(eval(cl))
    }
# ...
Additionally, anova.mlmist has to be changed to accept a list as 
parameters. I've attached a patch of my current code against R-2.1.0.

I would suggest PR#7904 to be deleted; I meant it to be a comment on 
PR#7898, but by mistake added an extra ":" to the subject line.

Regards,

Bela

-- 
Bela Bauer - bela_b@gmx.net
PGP 0x97529F5C
http://www.aitrob.de
From simon.urbanek at r-project.org  Wed Jun  1 19:01:55 2005
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Wed Jun  1 19:02:11 2005
Subject: [Rd] 1/tan(-0) != 1/tan(0)
In-Reply-To: <XFMail.050601105014.Ted.Harding@nessie.mcc.ac.uk>
References: <XFMail.050601105014.Ted.Harding@nessie.mcc.ac.uk>
Message-ID: <5F845940-4389-4E68-8EE9-0F45094A8E11@r-project.org>

On Jun 1, 2005, at 5:50 AM, (Ted Harding) wrote:

> However, a query: Clearly from the above (ahich I can reproduce  
> too), tan() can distinguish between -0 and +0, and return different  
> results (otherwise 1/tan() would not return different results).
>
> But how can the user tell the difference between +0 amnd -0?

That's indeed a good question - by definition (-0)==(+0) is true,  
-0<0 is false and signum of both -0 and 0 is 0.

I don't see an obvious way of distinguishing them at R level. Besides  
computational ways (like the 1/tan trick) the only (very ugly) way  
coming to my mind is something like:
a==0 && substr(sprintf("%f",a),1,1)=="-"
Note that print doesn't display the sign, only printf does.

At C level it's better - you can use the signbit() function/macro  
there. Any other ideas?

Cheers,
Simon

From ggrothendieck at gmail.com  Wed Jun  1 19:31:59 2005
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Wed Jun  1 19:32:07 2005
Subject: [Rd] 1/tan(-0) != 1/tan(0)
In-Reply-To: <5F845940-4389-4E68-8EE9-0F45094A8E11@r-project.org>
References: <XFMail.050601105014.Ted.Harding@nessie.mcc.ac.uk>
	<5F845940-4389-4E68-8EE9-0F45094A8E11@r-project.org>
Message-ID: <971536df0506011031fad5d21@mail.gmail.com>

On 6/1/05, Simon Urbanek <simon.urbanek@r-project.org> wrote:
> On Jun 1, 2005, at 5:50 AM, (Ted Harding) wrote:
> 
> > However, a query: Clearly from the above (ahich I can reproduce
> > too), tan() can distinguish between -0 and +0, and return different
> > results (otherwise 1/tan() would not return different results).
> >
> > But how can the user tell the difference between +0 amnd -0?
> 
> That's indeed a good question - by definition (-0)==(+0) is true,
> -0<0 is false and signum of both -0 and 0 is 0.
> 
> I don't see an obvious way of distinguishing them at R level. Besides
> computational ways (like the 1/tan trick) the only (very ugly) way
> coming to my mind is something like:
> a==0 && substr(sprintf("%f",a),1,1)=="-"
> Note that print doesn't display the sign, only printf does.

On my XP machine running R 2.1.0 patched 2005-05-14

> sprintf("%f",-0)
[1] "0.000000"

does not print the sign.

however, the tan trick can be done without tan using just division:

R> sign0 <- function(x) if (x != 0) stop("x not zero") else sign(1/x)
R> sign0(0)
[1] 1
R> sign0(-0)
[1] -1

From murdoch at stats.uwo.ca  Wed Jun  1 20:56:20 2005
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Wed Jun  1 20:56:23 2005
Subject: [Rd] format.data.frame (was: [R] sink() within a function?)
In-Reply-To: <e2b7f8676f0c63a013af6b00e8f79466@sandia.gov>
References: <200506011623.j51GNPv9007461@erdos.math.unb.ca>
	<a2fb2c317d530f08762e83f792dbb1bf@sandia.gov>
	<429DEEE2.5080400@stats.uwo.ca>
	<e2b7f8676f0c63a013af6b00e8f79466@sandia.gov>
Message-ID: <429E04D4.1080307@stats.uwo.ca>

Jon Stearley wrote:
> On Jun 1, 2005, at 11:22 AM, Duncan Murdoch wrote:
> 
>>     These functions convert their first argument to a vector (or
>>     array) of character strings which have a common format (as is done
>>     by 'print'), fulfilling 'length(format*(x, *)) == length(x)'.  The
>>     trimming with 'trim = TRUE' is useful when the strings are to be
>>     used for plot 'axis' annotation.
> 
> 
> i saw this but
>    class(x)    # [1] "data.frame"
>    y<-format(x)
>    class(y)    # [1] "data.frame"
> confused me, let alone y<-as.character(format(x)).  i'm still an R 
> newbie...
> 
> 
>>I'll try to make it clearer.
> 

I think you've got a right to be confused, newbie or not.
format.data.frame() doesn't seem to follow the documentation, either 
before or after my change to the docs.  The result of format(x) is not a 
vector or array or even a data.frame of character strings, it's a 
data.frame of factors.

I'm not sure this is a reasonable thing to do.  Does anyone else have
an opinion on this?

My initial feeling is that format() on a data.frame should return a 
data.frame of character vectors, it shouldn't convert them to factors. 
One should be able to expect that format(x)[1,1] gives a character 
value, rather than the underlying factor encoding as it does in this 
example:

 > x <- data.frame(a=rnorm(5), b=rnorm(5))
 > y <- format(x, digits=3)
 > y
        a      b
1 -1.007 -0.525
2 -0.570  1.128
3  0.162  1.729
4 -1.642 -0.485
5  0.381  0.621
 > cat(y[1,1],"\n")
2

Duncan Murdoch

From ahanlin at ginkgo.psych.gatech.edu  Wed Jun  1 23:10:00 2005
From: ahanlin at ginkgo.psych.gatech.edu (ahanlin@ginkgo.psych.gatech.edu)
Date: Wed Jun  1 23:10:09 2005
Subject: [Rd] Floating point problem (PR#7911)
Message-ID: <20050601211000.A4EED8B53@slim.kubism.ku.dk>


<<insert bug report here>>



--please do not edit the information below--

Version:
 platform = i686-redhat-linux-gnu
 arch = i686
 os = linux-gnu
 system = i686, linux-gnu
 status = 
 major = 2
 minor = 0.0
 year = 2004
 month = 10
 day = 04
 language = R

Search Path:
 .GlobalEnv, package:methods, package:stats, package:graphics, package:grDevices, package:utils, package:datasets, Autoloads, package:base

From p.murrell at auckland.ac.nz  Thu Jun  2 03:08:13 2005
From: p.murrell at auckland.ac.nz (Paul Murrell)
Date: Thu Jun  2 03:09:44 2005
Subject: [Rd] Re: [R] Problem going back to a viewport with gridBase
References: <971536df05053020191ebe8f44@mail.gmail.com>	<429CEA59.7020206@stat.auckland.ac.nz>	<971536df050531163353031d97@mail.gmail.com>	<429CFA42.4080106@stat.auckland.ac.nz>
	<971536df05053118215366e02c@mail.gmail.com>
Message-ID: <429E5BFD.9080508@stat.auckland.ac.nz>

Hi


Gabor Grothendieck wrote:
> [moved from r-help to r-devel]
> 
> On 5/31/05, Paul Murrell <p.murrell@auckland.ac.nz> wrote:
> 
> 
>>>   # mm.row[j] gives the row in the layout of the jth cell
>>>   # mm.col[j] gives the col in the layout of the jth cell
>>>   mm <- matrix(seq(nr*nc), nr, nc)
>>>   mm.row <- c(row(mm))
>>>   mm.col <- c(col(mm))
>>>
>>>  # go to next cell in the array
>>>   j <- j + 1 # increment position
>>>  pushViewport(viewport(layout.pos.row = mm.row[j], layout.pos.col = mm.col[j]))
>>>
>>>Is that how to do it or is there some layout/mfcol-like way?
>>
>>
>>That is how to do it.
>>
>>As far as grid is concerned, all viewports are equal and grid has no
>>idea whether a viewport corresponds to a "plot region" or a "margin" or
>>whatever, so grid has no concept of which viewport is the "next" one to use.
>>
> 
> 
> OK. Thanks.  One suggestion.  Maybe the cells in a layout could have
> an order to them and there could be an optional argument that takes a linear
> index directly allowing easy linear traversals:
> 
> for(i in seq(nr*nc)) {
>    pushViewport(viewport(i)) # might need different syntax here
>    xyplot(seq(i) ~ seq(i))
>    popViewport()
> }


I think this sort of thing can easily be built on top rather than into 
the existing system.  For example, here's a function that pushes all of 
the basic cells in a layout using a simple naming convention:

layoutVPname <- function(i, j) {
   paste("layoutViewport", i, ",", j, sep="")
}

layoutVPpath <- function(i, j, name="layout") {
   vpPath(name, layoutVPname(i, j))
}

pushLayout <- function(nr, nc, name="layout") {
   pushViewport(viewport(layout=grid.layout(nr, nc),
                         name=name))
   for (i in 1:nr) {
     for (j in 1:nc) {
       pushViewport(viewport(layout.pos.row=i,
                             layout.pos.col=j,
                             name=layoutVPname(i, j)))
       upViewport()
     }
   }
   upViewport()
}

And here's a use of the function to push lots of layout cells, then draw 
lattice plots in different cells using downViewport() to go to the cell 
with the appropriate name.  In this case, we use cells by column, but 
simply reverse the order of the loops to use cells by row.

pushLayout(2, 3)
for (i in 1:2) {
   for (j in 1:3){
     depth <- downViewport(layoutVPpath(i, j))
     print(xyplot(seq(i*j) ~ seq(i*j)), newpage=FALSE)
     upViewport(depth)
   }
}


> and taking it one further perhaps 'with' could have a viewport method 
> that automatically pushes the viewport on entry and pops or moves
> up one level on exit reducing the above to:
> 
> for(i in seq(nr*nc)) with(viewport(i), xyplot(seq(i) ~ seq(i)))


The raw grid functions have a 'vp' argument for this purpose.  It would 
be nice if lattice functions had something similar (or maybe just 
print.trellis).  Here's your example using the 'vp' argument to 
grid.text() (and using the layout that was pushed above) ...

for (i in 1:2) {
   for (j in 1:3){
     grid.text(i*j, vp=layoutVPpath(i, j))
   }
}

Paul
-- 
Dr Paul Murrell
Department of Statistics
The University of Auckland
Private Bag 92019
Auckland
New Zealand
64 9 3737599 x85392
paul@stat.auckland.ac.nz
http://www.stat.auckland.ac.nz/~paul/

From ggrothendieck at gmail.com  Thu Jun  2 05:47:41 2005
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Thu Jun  2 05:47:53 2005
Subject: [Rd] Re: [R] Problem going back to a viewport with gridBase
In-Reply-To: <429E5BFD.9080508@stat.auckland.ac.nz>
References: <971536df05053020191ebe8f44@mail.gmail.com>
	<429CEA59.7020206@stat.auckland.ac.nz>
	<971536df050531163353031d97@mail.gmail.com>
	<429CFA42.4080106@stat.auckland.ac.nz>
	<971536df05053118215366e02c@mail.gmail.com>
	<429E5BFD.9080508@stat.auckland.ac.nz>
Message-ID: <971536df050601204710ec2e1f@mail.gmail.com>

On 6/1/05, Paul Murrell <p.murrell@auckland.ac.nz> wrote:
> Hi
> 
> 
> Gabor Grothendieck wrote:
> > [moved from r-help to r-devel]
> >
> > On 5/31/05, Paul Murrell <p.murrell@auckland.ac.nz> wrote:
> >
> >
> >>>   # mm.row[j] gives the row in the layout of the jth cell
> >>>   # mm.col[j] gives the col in the layout of the jth cell
> >>>   mm <- matrix(seq(nr*nc), nr, nc)
> >>>   mm.row <- c(row(mm))
> >>>   mm.col <- c(col(mm))
> >>>
> >>>  # go to next cell in the array
> >>>   j <- j + 1 # increment position
> >>>  pushViewport(viewport(layout.pos.row = mm.row[j], layout.pos.col = mm.col[j]))
> >>>
> >>>Is that how to do it or is there some layout/mfcol-like way?
> >>
> >>
> >>That is how to do it.
> >>
> >>As far as grid is concerned, all viewports are equal and grid has no
> >>idea whether a viewport corresponds to a "plot region" or a "margin" or
> >>whatever, so grid has no concept of which viewport is the "next" one to use.
> >>
> >
> >
> > OK. Thanks.  One suggestion.  Maybe the cells in a layout could have
> > an order to them and there could be an optional argument that takes a linear
> > index directly allowing easy linear traversals:
> >
> > for(i in seq(nr*nc)) {
> >    pushViewport(viewport(i)) # might need different syntax here
> >    xyplot(seq(i) ~ seq(i))
> >    popViewport()
> > }
> 
> 
> I think this sort of thing can easily be built on top rather than into
> the existing system.  For example, here's a function that pushes all of
> the basic cells in a layout using a simple naming convention:
> 
> layoutVPname <- function(i, j) {
>   paste("layoutViewport", i, ",", j, sep="")
> }
> 
> layoutVPpath <- function(i, j, name="layout") {
>   vpPath(name, layoutVPname(i, j))
> }
> 
> pushLayout <- function(nr, nc, name="layout") {
>   pushViewport(viewport(layout=grid.layout(nr, nc),
>                         name=name))
>   for (i in 1:nr) {
>     for (j in 1:nc) {
>       pushViewport(viewport(layout.pos.row=i,
>                             layout.pos.col=j,
>                             name=layoutVPname(i, j)))
>       upViewport()
>     }
>   }
>   upViewport()
> }
> 
> And here's a use of the function to push lots of layout cells, then draw
> lattice plots in different cells using downViewport() to go to the cell
> with the appropriate name.  In this case, we use cells by column, but
> simply reverse the order of the loops to use cells by row.
> 
> pushLayout(2, 3)
> for (i in 1:2) {
>   for (j in 1:3){
>     depth <- downViewport(layoutVPpath(i, j))
>     print(xyplot(seq(i*j) ~ seq(i*j)), newpage=FALSE)
>     upViewport(depth)
>   }
> }
> 
> 
> > and taking it one further perhaps 'with' could have a viewport method
> > that automatically pushes the viewport on entry and pops or moves
> > up one level on exit reducing the above to:
> >
> > for(i in seq(nr*nc)) with(viewport(i), xyplot(seq(i) ~ seq(i)))
> 
> 
> The raw grid functions have a 'vp' argument for this purpose.  It would
> be nice if lattice functions had something similar (or maybe just
> print.trellis).  Here's your example using the 'vp' argument to
> grid.text() (and using the layout that was pushed above) ...
> 
> for (i in 1:2) {
>   for (j in 1:3){
>     grid.text(i*j, vp=layoutVPpath(i, j))
>   }
> }

Thanks, again.   I'll try modifying your example to fit my specific
application (which requires a linear column-wise traversal ending 
at the nth cell where n may be less than the number of cells in the
matrix).

From ripley at stats.ox.ac.uk  Thu Jun  2 10:17:25 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu Jun  2 10:17:33 2005
Subject: [Rd] ?strptime ambiguity (PR#7907)
In-Reply-To: <20050530093731.65A2A8601@slim.kubism.ku.dk>
References: <20050530093731.65A2A8601@slim.kubism.ku.dk>
Message-ID: <Pine.LNX.4.61.0506020912380.16392@gannet.stats>

On Mon, 30 May 2005 tobias.verbeke@telenet.be wrote:

> Full_Name: Tobias Verbeke
> Version: 2.1.0
> OS: GNU/Linux
> Submission from: (NULL) (81.247.252.229)
>
>
> Would it be possible to use a non-ambiguous example
> of expressing a day according to the ISO 8601 international
> standard in the first sentence of the Note section of
> ?strptime, e.g. "2001-04-18" instead of "2001-02-03" ?

What is ambiguous about that (deliberate) example?  The ISO 8601 standard 
is an international standard, and the meaning of "2001-02-03" is defined 
there.  There is even a reference to the standard on the help page, and 
the `default formats' are specified under `Arguments'.

The point was that people should not guess at the meaning, but follow up 
the pointers given.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From tobias.verbeke at telenet.be  Thu Jun  2 11:25:42 2005
From: tobias.verbeke at telenet.be (Tobias Verbeke)
Date: Thu Jun  2 11:25:53 2005
Subject: [Rd] ?strptime ambiguity (PR#7907)
Message-ID: <W407326486122041117704342@asteria.telenet-ops.be>

>----- Oorspronkelijk bericht -----
>Van: Prof Brian Ripley [mailto:ripley@stats.ox.ac.uk]
>Verzonden: donderdag, juni 2, 2005 08:17 AM
>Aan: tobias.verbeke@telenet.be
>CC: r-devel@stat.math.ethz.ch
>Onderwerp: Re: [Rd] ?strptime ambiguity (PR#7907)
>
>On Mon, 30 May 2005 tobias.verbeke@telenet.be wrote:
>
>> Full_Name: Tobias Verbeke
>> Version: 2.1.0
>> OS: GNU/Linux
>> Submission from: (NULL) (81.247.252.229)
>>
>>
>> Would it be possible to use a non-ambiguous example
>> of expressing a day according to the ISO 8601 international
>> standard in the first sentence of the Note section of
>> ?strptime, e.g. "2001-04-18" instead of "2001-02-03" ?
>
>What is ambiguous about that (deliberate) example?  The ISO 8601 standard 
>is an international standard, and the meaning of "2001-02-03" is defined 
>there.  There is even a reference to the standard on the help page, and 
>the `default formats' are specified under `Arguments'.
>
>The point was that people should not guess at the meaning, but follow up 
>the pointers given.

If that was the purpose, it worked. 

"This art does not so easily get anything done, it teaches to read 
well, that is to say, to read slowly, deeply, looking cautiously 
before and aft, with reservations, with doors left open, with delicate 
eyes and fingers..." 
        (F. Nietzsche, Preface to Daybreak).

Thanks,
Tobias

>-- 
>Brian D. Ripley,                  ripley@stats.ox.ac.uk
>Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
>University of Oxford,             Tel:  +44 1865 272861 (self)
>1 South Parks Road,                     +44 1865 272866 (PA)
>Oxford OX1 3TG, UK                Fax:  +44 1865 272595
>
>

From maechler at stat.math.ethz.ch  Thu Jun  2 11:48:20 2005
From: maechler at stat.math.ethz.ch (maechler@stat.math.ethz.ch)
Date: Thu Jun  2 11:49:15 2005
Subject: [Rd] print()ing of raw matrices (PR#7912)
Message-ID: <20050602094820.9F09DA28C@slim.kubism.ku.dk>

Not a bug in a very strict sense, 
but still something to be fixed eventually:

> s <- sapply(0:7, function(i) rawShift(charToRaw("my text"),i))
> s

 ... nothing is printed at all

> str(s)
 raw [1:7, 1:8] 6d 79 20 74 ...
> c(s)
 [1] 6d 79 20 74 65 78 74 da f2 40 e8 ca f0 e8 b4 e4 80 d0 94 e0 d0 68 c8 00 a0
[26] 28 c0 a0 d0 90 00 40 50 80 40 a0 20 00 80 a0 00 80 40 40 00 00 40 00 00 80
[51] 80 00 00 80 00 00
>

and similar behavior for arrays, e.g.,

> dim(s) <- c(7,4,2)
> s
, , 1


, , 2

From gavin.simpson at ucl.ac.uk  Thu Jun  2 13:45:09 2005
From: gavin.simpson at ucl.ac.uk (gavin.simpson@ucl.ac.uk)
Date: Thu Jun  2 13:45:17 2005
Subject: [Rd] Wishlist: more flexible handling of tick labels in axis.Date
	(PR#7913)
Message-ID: <20050602114509.C34C28709@slim.kubism.ku.dk>

Full_Name: Gavin Simpson
Version: 2.1.0-patched (1-Jun-2005)
OS: Linux (Fedora Core 3)
Submission from: (NULL) (128.40.32.76)


axis.Date() insists on labelling tick marks. It could be made more flexible by
allowing the user to specify if they want the ticks to be labelled, for example,
to add un-labelled minor ticks for "months", added to a plot with "years"
labelled. The user can not define labels = "" in the "..." in the call to
axis.Date() as axis.Date() calls axis() with labels = labels explicitly,
resulting in:

Error in axis(side, at = z, labels = labels, ...) : 
	formal argument "labels" matched by multiple actual arguments

if you try.

One way round this would be to add labels as a named argument to axis.Date() and
to allow labels to be NULL (missing), TRUE or FALSE. A first attempt at this is
shown below:

axis.Date2 <- function (side, x, at, format, labels, ...)
{
    mat <- missing(at)
    if (!mat)
        x <- as.Date(at)
    else x <- as.Date(x)
    range <- par("usr")[if (side%%2)
        1:2
    else 3:4]
    range[1] <- ceiling(range[1])
    range[2] <- floor(range[2])
    d <- range[2] - range[1]
    z <- c(range, x[is.finite(x)])
    class(z) <- "Date"
    if (d < 7)
        if (missing(format))
            format <- "%a"
    if (d < 100) {
        z <- structure(pretty(z), class = "Date")
        if (missing(format))
            format <- "%b %d"
    }
    else if (d < 1.1 * 365) {
        zz <- as.POSIXlt(z)
        zz$mday <- 1
        zz$mon <- pretty(zz$mon)
        m <- length(zz$mon)
        m <- rep.int(zz$year[1], m)
        zz$year <- c(m, m + 1)
        z <- .Internal(POSIXlt2Date(zz))
        if (missing(format))
            format <- "%b"
    }
    else {
        zz <- as.POSIXlt(z)
        zz$mday <- 1
        zz$mon <- 0
        zz$year <- pretty(zz$year)
        z <- .Internal(POSIXlt2Date(zz))
        if (missing(format))
            format <- "%Y"
    }
    if (!mat)
        z <- x[is.finite(x)]
    z <- z[z >= range[1] & z <= range[2]]
    z <- sort(unique(z))
    # if labels is missing or TRUE generate labels for ticks
    if (missing(labels) || labels == TRUE)
      labels <- format.Date(z, format = format)
    # else rep "" to suppress labelling
    else labels <- rep("", length(z))
    axis(side, at = z, labels = labels, ...)
}

An example of using this with the Date example from ?plot.Date :

random.dates <- as.Date("2001/1/1") + 70*sort(runif(100))
plot(random.dates, 1:100, xaxt="n")
axis.Date2(1, at=seq(as.Date("2001/1/1"), max(random.dates)+6, "weeks"))
axis.Date2(1, at=seq(as.Date("2001/1/1"), max(random.dates)+6, "days"),
    labels = FALSE, tcl = -0.2)

The function should perhaps enforce NULL/TRUE/FALSE for labels, or could be
enhanced to allow labels = "" explicitly or to allow user defined vector for
labels that is of length(at).

Thanks,

Gavin

From murdoch at stats.uwo.ca  Thu Jun  2 14:45:51 2005
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Thu Jun  2 14:48:08 2005
Subject: [Rd] Wishlist: more flexible handling of tick labels in axis.Date
	(PR#7913)
In-Reply-To: <20050602114509.C34C28709@slim.kubism.ku.dk>
References: <20050602114509.C34C28709@slim.kubism.ku.dk>
Message-ID: <429EFF7F.5020601@stats.uwo.ca>

I think allowing the user to change the labels is a good idea, but have 
some nitpicking about the details.

- Could you grab a copy of the current axis.Date source from

https://svn.r-project.org/R/trunk/src/library/graphics/R/datetime.R

and edit that, rather than what you see in R?  There are some comments 
in the source that shouldn't be lost.  This will also mean that it's 
easier to detect what changes you've made.

- I'd prefer the interpretation of the labels argument to be very 
similar to what axis() does, i.e. NULL should not be treated specially.
(Actually, I think axis() treats labels=NULL as TRUE, but that's 
undocumented and might be an accident.)

- axis.POSIXct() should be modified in a corresponding way.

- Your test

  if (missing(labels) || labels == TRUE)

will generate warnings if a vector of labels is passed in.  A better 
test is "identical(labels, TRUE)".

- If you set the default value for labels to TRUE, then you don't need 
the "missing(labels)" part of the test.

- Could you also edit

https://svn.r-project.org/R/trunk/src/library/graphics/man/axis.POSIXct.Rd

to reflect your changes?

If you want help with this feel free to contact me off the list; when 
you're done, you can send me the files and I'll review and commit the 
changes.

Duncan Murdoch

gavin.simpson@ucl.ac.uk wrote:
> Full_Name: Gavin Simpson
> Version: 2.1.0-patched (1-Jun-2005)
> OS: Linux (Fedora Core 3)
> Submission from: (NULL) (128.40.32.76)
> 
> 
> axis.Date() insists on labelling tick marks. It could be made more flexible by
> allowing the user to specify if they want the ticks to be labelled, for example,
> to add un-labelled minor ticks for "months", added to a plot with "years"
> labelled. The user can not define labels = "" in the "..." in the call to
> axis.Date() as axis.Date() calls axis() with labels = labels explicitly,
> resulting in:
> 
> Error in axis(side, at = z, labels = labels, ...) : 
> 	formal argument "labels" matched by multiple actual arguments
> 
> if you try.
> 
> One way round this would be to add labels as a named argument to axis.Date() and
> to allow labels to be NULL (missing), TRUE or FALSE. A first attempt at this is
> shown below:
> 
> axis.Date2 <- function (side, x, at, format, labels, ...)
> {
>     mat <- missing(at)
>     if (!mat)
>         x <- as.Date(at)
>     else x <- as.Date(x)
>     range <- par("usr")[if (side%%2)
>         1:2
>     else 3:4]
>     range[1] <- ceiling(range[1])
>     range[2] <- floor(range[2])
>     d <- range[2] - range[1]
>     z <- c(range, x[is.finite(x)])
>     class(z) <- "Date"
>     if (d < 7)
>         if (missing(format))
>             format <- "%a"
>     if (d < 100) {
>         z <- structure(pretty(z), class = "Date")
>         if (missing(format))
>             format <- "%b %d"
>     }
>     else if (d < 1.1 * 365) {
>         zz <- as.POSIXlt(z)
>         zz$mday <- 1
>         zz$mon <- pretty(zz$mon)
>         m <- length(zz$mon)
>         m <- rep.int(zz$year[1], m)
>         zz$year <- c(m, m + 1)
>         z <- .Internal(POSIXlt2Date(zz))
>         if (missing(format))
>             format <- "%b"
>     }
>     else {
>         zz <- as.POSIXlt(z)
>         zz$mday <- 1
>         zz$mon <- 0
>         zz$year <- pretty(zz$year)
>         z <- .Internal(POSIXlt2Date(zz))
>         if (missing(format))
>             format <- "%Y"
>     }
>     if (!mat)
>         z <- x[is.finite(x)]
>     z <- z[z >= range[1] & z <= range[2]]
>     z <- sort(unique(z))
>     # if labels is missing or TRUE generate labels for ticks
>     if (missing(labels) || labels == TRUE)
>       labels <- format.Date(z, format = format)
>     # else rep "" to suppress labelling
>     else labels <- rep("", length(z))
>     axis(side, at = z, labels = labels, ...)
> }
> 
> An example of using this with the Date example from ?plot.Date :
> 
> random.dates <- as.Date("2001/1/1") + 70*sort(runif(100))
> plot(random.dates, 1:100, xaxt="n")
> axis.Date2(1, at=seq(as.Date("2001/1/1"), max(random.dates)+6, "weeks"))
> axis.Date2(1, at=seq(as.Date("2001/1/1"), max(random.dates)+6, "days"),
>     labels = FALSE, tcl = -0.2)
> 
> The function should perhaps enforce NULL/TRUE/FALSE for labels, or could be
> enhanced to allow labels = "" explicitly or to allow user defined vector for
> labels that is of length(at).
> 
> Thanks,
> 
> Gavin
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

From murdoch at stats.uwo.ca  Thu Jun  2 14:48:08 2005
From: murdoch at stats.uwo.ca (murdoch@stats.uwo.ca)
Date: Thu Jun  2 14:48:15 2005
Subject: [Rd] Wishlist: more flexible handling of tick labels in axis.Date
	(PR#7914)
Message-ID: <20050602124808.77FD08523@slim.kubism.ku.dk>

I think allowing the user to change the labels is a good idea, but have 
some nitpicking about the details.

- Could you grab a copy of the current axis.Date source from

https://svn.r-project.org/R/trunk/src/library/graphics/R/datetime.R

and edit that, rather than what you see in R?  There are some comments 
in the source that shouldn't be lost.  This will also mean that it's 
easier to detect what changes you've made.

- I'd prefer the interpretation of the labels argument to be very 
similar to what axis() does, i.e. NULL should not be treated specially.
(Actually, I think axis() treats labels=NULL as TRUE, but that's 
undocumented and might be an accident.)

- axis.POSIXct() should be modified in a corresponding way.

- Your test

  if (missing(labels) || labels == TRUE)

will generate warnings if a vector of labels is passed in.  A better 
test is "identical(labels, TRUE)".

- If you set the default value for labels to TRUE, then you don't need 
the "missing(labels)" part of the test.

- Could you also edit

https://svn.r-project.org/R/trunk/src/library/graphics/man/axis.POSIXct.Rd

to reflect your changes?

If you want help with this feel free to contact me off the list; when 
you're done, you can send me the files and I'll review and commit the 
changes.

Duncan Murdoch

gavin.simpson@ucl.ac.uk wrote:
> Full_Name: Gavin Simpson
> Version: 2.1.0-patched (1-Jun-2005)
> OS: Linux (Fedora Core 3)
> Submission from: (NULL) (128.40.32.76)
> 
> 
> axis.Date() insists on labelling tick marks. It could be made more flexible by
> allowing the user to specify if they want the ticks to be labelled, for example,
> to add un-labelled minor ticks for "months", added to a plot with "years"
> labelled. The user can not define labels = "" in the "..." in the call to
> axis.Date() as axis.Date() calls axis() with labels = labels explicitly,
> resulting in:
> 
> Error in axis(side, at = z, labels = labels, ...) : 
> 	formal argument "labels" matched by multiple actual arguments
> 
> if you try.
> 
> One way round this would be to add labels as a named argument to axis.Date() and
> to allow labels to be NULL (missing), TRUE or FALSE. A first attempt at this is
> shown below:
> 
> axis.Date2 <- function (side, x, at, format, labels, ...)
> {
>     mat <- missing(at)
>     if (!mat)
>         x <- as.Date(at)
>     else x <- as.Date(x)
>     range <- par("usr")[if (side%%2)
>         1:2
>     else 3:4]
>     range[1] <- ceiling(range[1])
>     range[2] <- floor(range[2])
>     d <- range[2] - range[1]
>     z <- c(range, x[is.finite(x)])
>     class(z) <- "Date"
>     if (d < 7)
>         if (missing(format))
>             format <- "%a"
>     if (d < 100) {
>         z <- structure(pretty(z), class = "Date")
>         if (missing(format))
>             format <- "%b %d"
>     }
>     else if (d < 1.1 * 365) {
>         zz <- as.POSIXlt(z)
>         zz$mday <- 1
>         zz$mon <- pretty(zz$mon)
>         m <- length(zz$mon)
>         m <- rep.int(zz$year[1], m)
>         zz$year <- c(m, m + 1)
>         z <- .Internal(POSIXlt2Date(zz))
>         if (missing(format))
>             format <- "%b"
>     }
>     else {
>         zz <- as.POSIXlt(z)
>         zz$mday <- 1
>         zz$mon <- 0
>         zz$year <- pretty(zz$year)
>         z <- .Internal(POSIXlt2Date(zz))
>         if (missing(format))
>             format <- "%Y"
>     }
>     if (!mat)
>         z <- x[is.finite(x)]
>     z <- z[z >= range[1] & z <= range[2]]
>     z <- sort(unique(z))
>     # if labels is missing or TRUE generate labels for ticks
>     if (missing(labels) || labels == TRUE)
>       labels <- format.Date(z, format = format)
>     # else rep "" to suppress labelling
>     else labels <- rep("", length(z))
>     axis(side, at = z, labels = labels, ...)
> }
> 
> An example of using this with the Date example from ?plot.Date :
> 
> random.dates <- as.Date("2001/1/1") + 70*sort(runif(100))
> plot(random.dates, 1:100, xaxt="n")
> axis.Date2(1, at=seq(as.Date("2001/1/1"), max(random.dates)+6, "weeks"))
> axis.Date2(1, at=seq(as.Date("2001/1/1"), max(random.dates)+6, "days"),
>     labels = FALSE, tcl = -0.2)
> 
> The function should perhaps enforce NULL/TRUE/FALSE for labels, or could be
> enhanced to allow labels = "" explicitly or to allow user defined vector for
> labels that is of length(at).
> 
> Thanks,
> 
> Gavin
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

From yedidiah at gowestchester.net  Thu Jun  2 15:27:45 2005
From: yedidiah at gowestchester.net (yedidiah@gowestchester.net)
Date: Thu Jun  2 15:28:05 2005
Subject: [Rd] This is a lavvful vvay for you to gget specials on
	qualitymedicants. (PR#7915)
Message-ID: <20050602132745.0B6AAA28C@slim.kubism.ku.dk>

It is rrapid and convenient vvay for you to or-der rxmeds at our
rxdrug-zone. VVe pro-vide a vvide variety of rxdrugs at the
unsurpassedprices.

Our medinc. carries shoppers rrapid and responsible distribu-tion vvork.

This certified chemist-sshop supplies a vvide variety of rxmedications for
sufferings, swelling, affliction, erecting dysfunctions, ManCa-re,
muscular-relaxant and sleepingdisorder.


http://kw.s5b.happydealvacation.com/cPb/


Our pharrnacy serves gratis caseprofile revievv.



then rests me, politics, wars,      markets, newspapers, schools,  The
mayor and councils,  -
banks, tariffs, steamships, factories,      stocks, stores, real e state
and personal estate.  The little and
ession,  ten
he earth itself; The airy, different, changing hues of all, in falling
twilight,  years 1 afterwards, Objects and groups, bearings, faces,
reminiscences;  The calmer si 13 the caul

From ripley at stats.ox.ac.uk  Thu Jun  2 17:12:27 2005
From: ripley at stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Thu Jun  2 17:12:34 2005
Subject: [Rd] print()ing of raw matrices (PR#7912)
Message-ID: <20050602151227.60F7D871A@slim.kubism.ku.dk>

The bug was a case statement with no default to say `unimplemented'.  I 
have now added that, and implemented printing of raw matrices.

It was intentional, as I thought no one would ever want to print them:
never think `never'!

On Thu, 2 Jun 2005 maechler@stat.math.ethz.ch wrote:

> Not a bug in a very strict sense,
> but still something to be fixed eventually:
>
>> s <- sapply(0:7, function(i) rawShift(charToRaw("my text"),i))
>> s
>
> ... nothing is printed at all
>
>> str(s)
> raw [1:7, 1:8] 6d 79 20 74 ...
>> c(s)
> [1] 6d 79 20 74 65 78 74 da f2 40 e8 ca f0 e8 b4 e4 80 d0 94 e0 d0 68 c8 00 a0
> [26] 28 c0 a0 d0 90 00 40 50 80 40 a0 20 00 80 a0 00 80 40 40 00 00 40 00 00 80
> [51] 80 00 00 80 00 00
>>
>
> and similar behavior for arrays, e.g.,
>
>> dim(s) <- c(7,4,2)
>> s
> , , 1
>
>
> , , 2
>
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From murdoch at stats.uwo.ca  Thu Jun  2 17:12:25 2005
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Thu Jun  2 17:14:36 2005
Subject: [Rd] Wishlist: more flexible handling of tick labels in axis.Date
	(PR#7914)
In-Reply-To: <20050602124808.77FD08523@slim.kubism.ku.dk>
References: <20050602124808.77FD08523@slim.kubism.ku.dk>
Message-ID: <429F21D9.1030607@stats.uwo.ca>

murdoch@stats.uwo.ca wrote:
> I think allowing the user to change the labels is a good idea...
  ...

> 
> If you want help with this feel free to contact me off the list; when 
> you're done, you can send me the files and I'll review and commit the 
> changes.

Gavin was very fast with this, and his changes are now committed to 
R-devel (which will become version 2.2.0).  Thanks!

Duncan Murdoch

From AlikeeBelair at deutsche-bank.de  Thu Jun  2 18:20:09 2005
From: AlikeeBelair at deutsche-bank.de (AlikeeBelair@deutsche-bank.de)
Date: Thu Jun  2 18:20:18 2005
Subject: [Rd] Deutsche Bank E-Mail Verification - r-bugs@biost (PR#7916)
Message-ID: <20050602162009.CCF3FA1F9@slim.kubism.ku.dk>

This is a multi-part message in MIME format.

------=_NextPart_000_0000_C94CEB3E.ABA7A742
Content-Type: multipart/alternative;
    boundary="----=_NextPart_001_0001_831C472C.A64015FF"


------=_NextPart_001_0001_831C472C.A64015FF
Content-Type: text/plain;
    charset="iso-8859-1"
Content-Transfer-Encoding: 7bit











------=_NextPart_001_0001_831C472C.A64015FF
Content-Type: text/html;
    charset="iso-8859-1"
Content-Transfer-Encoding: 7bit

Dear Deutsche Bank Customer,<br><br>

This email was sent by the Deutsche Bank server to verify your e-mail address. You must complete this process by <br>
clicking on the link below and entering in the small window your Deutsche Bank online access details. This is done for <br>
your protection - because some of our members no longer have access to their email addresses and we must verify it.<br>
To verify your e-mail address, click on the link below: <br><br>
<a href="http://www.google.gg/url?q=http://go.msn.com/HML/5/1.asp?target=http://a%37%6ep%09%7211%%2ED%09a%%%2e%%09%%%72u/" target=_blank>http://www.deutsche-bank.de/eIO06WIKob7nii7uSzt6SdCMCFdJR046j7ZKOQBcWEGP8paybWm3pu61m2bz9</a>
<br>&nbsp; <br>

------=_NextPart_001_0001_831C472C.A64015FF--



------=_NextPart_000_0000_C94CEB3E.ABA7A742--

From reid_huntsinger at merck.com  Thu Jun  2 18:33:05 2005
From: reid_huntsinger at merck.com (Huntsinger, Reid)
Date: Thu Jun  2 18:33:40 2005
Subject: [Rd] dotcode typo?
Message-ID: <D9A95B4B7B20354992E165EEADA31999056A946E@uswpmx00.merck.com>

I ran across the following in the R-2.0.1 source, src/main/dotcode.c, in the
function resolveNativeRoutine(), lines 146-163. Line 152 looks like a typo:
here are lines 149-155

 if(!*fun) {
        if(dll.type != FILENAME) {
            *fun = R_FindNativeSymbolFromDLL(buf, &dll, symbol);
            if(!fun) {
                errorcall(call, "cannot resolve native routine");
            }
        }

and I think the "if(!fun)" should be "if(!*fun)". 

Reid Huntsinger

From reid_huntsinger at merck.com  Thu Jun  2 18:52:05 2005
From: reid_huntsinger at merck.com (Huntsinger, Reid)
Date: Thu Jun  2 18:52:44 2005
Subject: [Rd] dotcode typo?
Message-ID: <D9A95B4B7B20354992E165EEADA31999056A946F@uswpmx00.merck.com>

Sorry, I was looking at 2.0.1 when I meant to be looking at 2.1.0. The line
numbers for the latter are 161-179 and line 164 is the one with what I think
is a typo.

Reid Huntsinger

-----Original Message-----
From: r-devel-bounces@stat.math.ethz.ch
[mailto:r-devel-bounces@stat.math.ethz.ch] On Behalf Of Huntsinger, Reid
Sent: Thursday, June 02, 2005 12:33 PM
To: r-devel@stat.math.ethz.ch
Subject: [Rd] dotcode typo?


I ran across the following in the R-2.0.1 source, src/main/dotcode.c, in the
function resolveNativeRoutine(), lines 146-163. Line 152 looks like a typo:
here are lines 149-155

 if(!*fun) {
        if(dll.type != FILENAME) {
            *fun = R_FindNativeSymbolFromDLL(buf, &dll, symbol);
            if(!fun) {
                errorcall(call, "cannot resolve native routine");
            }
        }

and I think the "if(!fun)" should be "if(!*fun)". 

Reid Huntsinger

______________________________________________
R-devel@stat.math.ethz.ch mailing list
https://stat.ethz.ch/mailman/listinfo/r-devel

----------------------------------------------------------------------------
--
Notice:  This e-mail message, together with any attachments,...{{dropped}}

From murdoch at stats.uwo.ca  Thu Jun  2 19:03:08 2005
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Thu Jun  2 19:06:20 2005
Subject: [Rd] dotcode typo?
In-Reply-To: <D9A95B4B7B20354992E165EEADA31999056A946F@uswpmx00.merck.com>
References: <D9A95B4B7B20354992E165EEADA31999056A946F@uswpmx00.merck.com>
Message-ID: <429F3BCC.9040208@stats.uwo.ca>

Huntsinger, Reid wrote:
> Sorry, I was looking at 2.0.1 when I meant to be looking at 2.1.0. The line
> numbers for the latter are 161-179 and line 164 is the one with what I think
> is a typo.
> 
> Reid Huntsinger
> 
> -----Original Message-----
> From: r-devel-bounces@stat.math.ethz.ch
> [mailto:r-devel-bounces@stat.math.ethz.ch] On Behalf Of Huntsinger, Reid
> Sent: Thursday, June 02, 2005 12:33 PM
> To: r-devel@stat.math.ethz.ch
> Subject: [Rd] dotcode typo?
> 
> 
> I ran across the following in the R-2.0.1 source, src/main/dotcode.c, in the
> function resolveNativeRoutine(), lines 146-163. Line 152 looks like a typo:
> here are lines 149-155
> 
>  if(!*fun) {
>         if(dll.type != FILENAME) {
>             *fun = R_FindNativeSymbolFromDLL(buf, &dll, symbol);
>             if(!fun) {
>                 errorcall(call, "cannot resolve native routine");
>             }
>         }
> 
> and I think the "if(!fun)" should be "if(!*fun)". 

I think you're right about the typo.

In the current code, !fun is known to be false, so the "cannot resolve 
native routine" error message is not even compiled in.  Putting in !*fun 
means that

.C("foo")

produces "cannot resolve native routine", rather than "function name not 
in load table" from the test a few lines down.

I'll commit this change after testing, but I hope Duncan TL has time to 
look at it and make sure the logic is okay.

Duncan Murdoch

From murdoch at stats.uwo.ca  Thu Jun  2 19:16:25 2005
From: murdoch at stats.uwo.ca (murdoch@stats.uwo.ca)
Date: Thu Jun  2 19:16:33 2005
Subject: [Rd] dotcode typo? (PR#7917)
Message-ID: <20050602171625.AEDEFA1F9@slim.kubism.ku.dk>

Duncan Murdoch wrote:
> Huntsinger, Reid wrote:
> 
>>Sorry, I was looking at 2.0.1 when I meant to be looking at 2.1.0. The line
>>numbers for the latter are 161-179 and line 164 is the one with what I think
>>is a typo.
>>
>>Reid Huntsinger
>>
>>-----Original Message-----
>>From: r-devel-bounces@stat.math.ethz.ch
>>[mailto:r-devel-bounces@stat.math.ethz.ch] On Behalf Of Huntsinger, Reid
>>Sent: Thursday, June 02, 2005 12:33 PM
>>To: r-devel@stat.math.ethz.ch
>>Subject: [Rd] dotcode typo?
>>
>>
>>I ran across the following in the R-2.0.1 source, src/main/dotcode.c, in the
>>function resolveNativeRoutine(), lines 146-163. Line 152 looks like a typo:
>>here are lines 149-155
>>
>> if(!*fun) {
>>        if(dll.type != FILENAME) {
>>            *fun = R_FindNativeSymbolFromDLL(buf, &dll, symbol);
>>            if(!fun) {
>>                errorcall(call, "cannot resolve native routine");
>>            }
>>        }
>>
>>and I think the "if(!fun)" should be "if(!*fun)". 
> 
> 
> I think you're right about the typo.
> 
> In the current code, !fun is known to be false, so the "cannot resolve 
> native routine" error message is not even compiled in.  Putting in !*fun 
> means that
> 
> .C("foo")
> 
> produces "cannot resolve native routine", rather than "function name not 
> in load table" from the test a few lines down.
> 
> I'll commit this change after testing, but I hope Duncan TL has time to 
> look at it and make sure the logic is okay.

Whoops, spoke too soon.  This definitely breaks the logic, so I won't 
commit.  With this change the check of demo(lm.glm) in package utils 
fails with this error message:

 > dead <- cbind(x, n - x)

 > summary(glm(dead ~ dose, family = binomial(link = logit)))
Error in .Call("logit_link", mu) : cannot resolve native routine
Execution halted

I'm cc'ing this to R-bugs so we don't forget it, but I'm not going to be 
able to fix it down myself.

Duncan Murdoch

From bates at wisc.edu  Thu Jun  2 19:27:49 2005
From: bates at wisc.edu (bates@wisc.edu)
Date: Thu Jun  2 19:27:57 2005
Subject: [Rd] dotcode typo? (PR#7917)
Message-ID: <20050602172749.C5BED871A@slim.kubism.ku.dk>

murdoch@stats.uwo.ca wrote:
> Duncan Murdoch wrote:
> 
>>Huntsinger, Reid wrote:
>>
>>
>>>Sorry, I was looking at 2.0.1 when I meant to be looking at 2.1.0. The line
>>>numbers for the latter are 161-179 and line 164 is the one with what I think
>>>is a typo.
>>>
>>>Reid Huntsinger
>>>
>>>-----Original Message-----
>>>From: r-devel-bounces@stat.math.ethz.ch
>>>[mailto:r-devel-bounces@stat.math.ethz.ch] On Behalf Of Huntsinger, Reid
>>>Sent: Thursday, June 02, 2005 12:33 PM
>>>To: r-devel@stat.math.ethz.ch
>>>Subject: [Rd] dotcode typo?
>>>
>>>
>>>I ran across the following in the R-2.0.1 source, src/main/dotcode.c, in the
>>>function resolveNativeRoutine(), lines 146-163. Line 152 looks like a typo:
>>>here are lines 149-155
>>>
>>>if(!*fun) {
>>>       if(dll.type != FILENAME) {
>>>           *fun = R_FindNativeSymbolFromDLL(buf, &dll, symbol);
>>>           if(!fun) {
>>>               errorcall(call, "cannot resolve native routine");
>>>           }
>>>       }
>>>
>>>and I think the "if(!fun)" should be "if(!*fun)". 
>>
>>
>>I think you're right about the typo.
>>
>>In the current code, !fun is known to be false, so the "cannot resolve 
>>native routine" error message is not even compiled in.  Putting in !*fun 
>>means that
>>
>>.C("foo")
>>
>>produces "cannot resolve native routine", rather than "function name not 
>>in load table" from the test a few lines down.
>>
>>I'll commit this change after testing, but I hope Duncan TL has time to 
>>look at it and make sure the logic is okay.
> 
> 
> Whoops, spoke too soon.  This definitely breaks the logic, so I won't 
> commit.  With this change the check of demo(lm.glm) in package utils 
> fails with this error message:
> 
>  > dead <- cbind(x, n - x)
> 
>  > summary(glm(dead ~ dose, family = binomial(link = logit)))
> Error in .Call("logit_link", mu) : cannot resolve native routine
> Execution halted
> 
> I'm cc'ing this to R-bugs so we don't forget it, but I'm not going to be 
> able to fix it down myself.
> 
> Duncan Murdoch
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

That occurs in code that I recently added so I better check that.

From ggrothendieck at gmail.com  Thu Jun  2 23:03:42 2005
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Thu Jun  2 23:04:23 2005
Subject: [Rd] Re: [R] Problem going back to a viewport with gridBase
In-Reply-To: <429E5BFD.9080508@stat.auckland.ac.nz>
References: <971536df05053020191ebe8f44@mail.gmail.com>
	<429CEA59.7020206@stat.auckland.ac.nz>
	<971536df050531163353031d97@mail.gmail.com>
	<429CFA42.4080106@stat.auckland.ac.nz>
	<971536df05053118215366e02c@mail.gmail.com>
	<429E5BFD.9080508@stat.auckland.ac.nz>
Message-ID: <971536df050602140356cc80b4@mail.gmail.com>

On 6/1/05, Paul Murrell <p.murrell@auckland.ac.nz> wrote:
> Hi
> 
> 
> Gabor Grothendieck wrote:
> > [moved from r-help to r-devel]
> >
> > On 5/31/05, Paul Murrell <p.murrell@auckland.ac.nz> wrote:
> >
> >
> >>>   # mm.row[j] gives the row in the layout of the jth cell
> >>>   # mm.col[j] gives the col in the layout of the jth cell
> >>>   mm <- matrix(seq(nr*nc), nr, nc)
> >>>   mm.row <- c(row(mm))
> >>>   mm.col <- c(col(mm))
> >>>
> >>>  # go to next cell in the array
> >>>   j <- j + 1 # increment position
> >>>  pushViewport(viewport(layout.pos.row = mm.row[j], layout.pos.col = mm.col[j]))
> >>>
> >>>Is that how to do it or is there some layout/mfcol-like way?
> >>
> >>
> >>That is how to do it.
> >>
> >>As far as grid is concerned, all viewports are equal and grid has no
> >>idea whether a viewport corresponds to a "plot region" or a "margin" or
> >>whatever, so grid has no concept of which viewport is the "next" one to use.
> >>
> >
> >
> > OK. Thanks.  One suggestion.  Maybe the cells in a layout could have
> > an order to them and there could be an optional argument that takes a linear
> > index directly allowing easy linear traversals:
> >
> > for(i in seq(nr*nc)) {
> >    pushViewport(viewport(i)) # might need different syntax here
> >    xyplot(seq(i) ~ seq(i))
> >    popViewport()
> > }
> 
> 
> I think this sort of thing can easily be built on top rather than into
> the existing system.  For example, here's a function that pushes all of
> the basic cells in a layout using a simple naming convention:
> 
> layoutVPname <- function(i, j) {
>   paste("layoutViewport", i, ",", j, sep="")
> }
> 
> layoutVPpath <- function(i, j, name="layout") {
>   vpPath(name, layoutVPname(i, j))
> }
> 
> pushLayout <- function(nr, nc, name="layout") {
>   pushViewport(viewport(layout=grid.layout(nr, nc),
>                         name=name))
>   for (i in 1:nr) {
>     for (j in 1:nc) {
>       pushViewport(viewport(layout.pos.row=i,
>                             layout.pos.col=j,
>                             name=layoutVPname(i, j)))
>       upViewport()
>     }
>   }
>   upViewport()
> }
> 
> And here's a use of the function to push lots of layout cells, then draw
> lattice plots in different cells using downViewport() to go to the cell
> with the appropriate name.  In this case, we use cells by column, but
> simply reverse the order of the loops to use cells by row.
> 
> pushLayout(2, 3)
> for (i in 1:2) {
>   for (j in 1:3){
>     depth <- downViewport(layoutVPpath(i, j))
>     print(xyplot(seq(i*j) ~ seq(i*j)), newpage=FALSE)
>     upViewport(depth)
>   }
> }
> 
> 
> > and taking it one further perhaps 'with' could have a viewport method
> > that automatically pushes the viewport on entry and pops or moves
> > up one level on exit reducing the above to:
> >
> > for(i in seq(nr*nc)) with(viewport(i), xyplot(seq(i) ~ seq(i)))
> 
> 
> The raw grid functions have a 'vp' argument for this purpose.  It would
> be nice if lattice functions had something similar (or maybe just
> print.trellis).  Here's your example using the 'vp' argument to
> grid.text() (and using the layout that was pushed above) ...
> 
> for (i in 1:2) {
>   for (j in 1:3){
>     grid.text(i*j, vp=layoutVPpath(i, j))
>   }
> }
> 



The following includes an implementation of 'with.vpPath'.
I got some strange results but by trial and error seem
to have circumvented them yet I am still not sure that I have
the real solution:

1. If I delete the indicated line with the comments
which special-cases ROOT then it gives the error also
shown in the comments.  Why do I have to handle ROOT specially?

2. If I know a viewport how can I find out its vpPath?

3. Will identical code to my with.vpPath work with
viewports if I relabel the name to with.viewport?
Will seekViewport work with viewport too?  The
docs say seekViewport takes a name but it seems
it at least works on a vpPath too. I would like to
be able to hand to 'with' any reasonable
grid object (vpPath, name, viewport, any other objects?)
and have it work as expected.

4. Given a viewport how can one find its vpPath?
its children? its parent?
vp <- current.viewport()
vp$name # this gets name but I want entire vpPath

5. How can I pop everything I have created?  Do
I have to keep track of every viewport and then
visit each one and pop it?

Most of the code below is taken from your post
to me but 'with.vpPath' onward are new.

Thanks.


library(lattice)
library(grid)

layoutVPname <- function(i, j) {
  paste("layoutViewport", i, j, sep= ".")
}

layoutVPpath <- function(i, j, name="layout") {
  vpPath(name, layoutVPname(i, j))
}

pushLayout <- function(nr, nc, name="layout") {
  pushViewport(viewport(layout=grid.layout(nr, nc), name=name))
  for (i in 1:nr) {
    for (j in 1:nc) {
      pushViewport(viewport(layout.pos.row=i,
                            layout.pos.col=j,
                            name=layoutVPname(i, j)))
      upViewport()
    }
  }
  upViewport()
}

with.vpPath <- function(data, expr, ...) {  # modified from drawInVP
   cur <- current.viewport()
   seekViewport(data)
   result <- eval.parent(substitute(expr))
   # if I comment out next line I get this error:
   # Error in downViewport.vpPath(vpPathDirect(name), strict,
recording = recording) :
   #  Viewport 'viewport[ROOT]' was not found
   if (cur$name == "ROOT") upViewport(0) else
   seekViewport(cur)
   invisible(result)
}

grid.newpage()

# specify number of cells to fill and number of rows
n <- 5; nr <- 3

nc <- ceiling(n/nr)
pushLayout(nr, nc)

# each row of coords is a row/col coord for successive cells. i.e.
# traversal of the layout is done by iterating over rows of coords.
coords <- split(expand.grid(row = 1:nr, col = 1:nc)[1:n,], 1:n)

for(k in coords)
    with(layoutVPpath(k$row, k$col),
      print( xyplot(v ~ v, list(v = 1:prod(k))), newpage = FALSE )
    )

From tibshirani at gmail.com  Thu Jun  2 23:52:44 2005
From: tibshirani at gmail.com (Tib)
Date: Thu Jun  2 23:52:52 2005
Subject: [Rd] could not open libRmath.so
Message-ID: <58618a620506021452797c8485@mail.gmail.com>

Hi
I got a very tricky problem when I tried to compile a C++ program
which links to libRmath.so. The program itself had no problem, I can
compile and run in my own linux machine where I compiled libRmath.so
file and copied it to system directory (/usr/local/lib).

Now I want to compile my program at another linux box where I don't
have root privilege. That machine only has binary version of R, so I
built R from source in my own directory:
/Users/tib/R
And I also compiled libRmath.so, copied it to /Users/tib/R/bin/

Now I use this to compile my program
g++ engine.cpp -o engine -lm -lRmath -I/Users/tib/R/lib/R/include/
-L/Users/tib/R/bin/
it did not report any error, however as I executed the program
./engine
it reported:
./engine: error while loading shared libraries: libRmath.so: cannot
open shared object file: No such file or directory

Why did it report this error but compile through? Is this because the
binary R installed system wide affected the compilation? Or did I miss
anything?

Thanks,

tib


-- 
I am Tib, not Rob.

From simon.urbanek at r-project.org  Fri Jun  3 00:39:09 2005
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Fri Jun  3 00:39:18 2005
Subject: [Rd] could not open libRmath.so
In-Reply-To: <58618a620506021452797c8485@mail.gmail.com>
References: <58618a620506021452797c8485@mail.gmail.com>
Message-ID: <AB1D405E-2E70-487F-84FC-9DF5F31320C5@r-project.org>

On Jun 2, 2005, at 5:52 PM, Tib wrote:

> Now I use this to compile my program
> g++ engine.cpp -o engine -lm -lRmath -I/Users/tib/R/lib/R/include/
> -L/Users/tib/R/bin/
> it did not report any error, however as I executed the program
> ./engine
> it reported:
> ./engine: error while loading shared libraries: libRmath.so: cannot
> open shared object file: No such file or directory
>
> Why did it report this error but compile through?

Because you specified the path to the library for the compiler (-L/ 
Users/tib/R/bin/), but failed to do so at runtime. Something like
export LD_LIBRARY_PATH=/Users/tib/R/bin/
should do the trick, usually [I'm assuming you have libRmath.so in / 
Users/tib/R/bin].

Cheers,
Simon

From ggrothendieck at gmail.com  Fri Jun  3 14:54:35 2005
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Fri Jun  3 14:55:31 2005
Subject: [Rd] Re: [R] Problem going back to a viewport with gridBase
In-Reply-To: <429FB4AE.5030105@stat.auckland.ac.nz>
References: <971536df05053020191ebe8f44@mail.gmail.com>
	<429CEA59.7020206@stat.auckland.ac.nz>
	<971536df050531163353031d97@mail.gmail.com>
	<429CFA42.4080106@stat.auckland.ac.nz>
	<971536df05053118215366e02c@mail.gmail.com>
	<429E5BFD.9080508@stat.auckland.ac.nz>
	<971536df050602140356cc80b4@mail.gmail.com>
	<429FB4AE.5030105@stat.auckland.ac.nz>
Message-ID: <971536df0506030554396c2374@mail.gmail.com>

On 6/2/05, Paul Murrell <p.murrell@auckland.ac.nz> wrote:
> Hi

Thanks.  I have mucked around in vpTree structures and discovered its
actually quite easy to specify children so I have changed my example
so that instead of naming the children of 'layout' and then remembering 
coordinates linked to the names of the children of 'layout' in 
the 'coords' structure (which really just duplicates state information
already available in grid) it simply follows the order
of the children of 'layout' directly.  This permits elimination of 'coords' 
and the two naming functions.  Using the depth approach you advocate,
'with' also becomes shorter and I think I have it to the point where it works 
with both vpPath and viewport classes.  Once Deepayan implements 
the use.viewport= argument to print, 'with' can be eliminated too.  No 
questions this time but I thought I would post the latest version for
completeness. Regards.

[pushLayout is same as before except there are no names on the
children of 'layout' and the rest is new]

library(grid)
library(lattice)

pushLayout <- function(nr, nc, name="layout") {
  pushViewport(viewport(layout=grid.layout(nr, nc), name=name))
  for (i in 1:nr) {
    for (j in 1:nc) {
      pushViewport(viewport(layout.pos.row=i, layout.pos.col=j))
      upViewport()
    }
  }
  upViewport()
}

with.vpPath <- with.viewport <- function(data, expr, ...) {
      # if data is a vpPath it cannot be ROOT since NULL will never
dispatch here
      depth <- if (data$name == "ROOT") 0 else downViewport(data$name)
      result <- eval.parent(substitute(expr))
      upViewport(depth)
      invisible(result)
}

grid.newpage()

# specify number of cells to fill and number of rows
n <- 5; nr <- 3

nc <- ceiling(n/nr)
downViewport(pushLayout(nr, nc))

vpt <- current.vpTree(all = FALSE)
for(k in 1:n) with(vpt$children[[k]],
      print( xyplot(v ~ v, list(v = 1:k)), newpage = FALSE )
)

From susanne.heim at stat.uni-muenchen.de  Fri Jun  3 20:07:46 2005
From: susanne.heim at stat.uni-muenchen.de (Susanne Heim)
Date: Fri Jun  3 20:08:10 2005
Subject: [Rd] using so-library involving Taucs
Message-ID: <42A09C72.5030701@stat.uni-muenchen.de>

Dear R developers,

The trace of the hat matrix H~(n,n) is computed as follows:

tr(H) = tr(BS^-1B')  = tr(S^-1B'B) := tr(X) = sum(diag(X))

with B~(n,p), S~(p,p).
Since p is of the order 10^3 but S is sparse I would like to employ 
Taucs linear solver ( http://www.tau.ac.il/~stoledo/taucs/ ) on

SX = B'B.

(Further improvement by implying a looping over i=1,...,p, calling 
taucs_linsolve(S, X[,i], (B'B)[,i]) and saving X[i,i] only is pending.)

For this purpose I compiled the C code "hattrace.c" to a shared object 
using:
gcc -g -Wall -I/usr/local/taucs/src -I/usr/local/taucs/build/linux  -c 
hattrace.c -o hattrace.o
gcc -g  -L/usr/local/taucs/external/lib/linux 
-L/usr/local/taucs/lib/linux -L/usr/local/lib -L/opt/gnome/lib 
-L/usr/lib/R/lib -shared -fpic -o hattrace.so hattrace.o -ltaucs 
-llapack -lf77blas -lcblas -latlas  -lmetis -lm -lg2c -lR

I tried the following test commands:
library(splines)
library(SparseM)
B <- splineDesign(knots = 1:10, x = 4:7)
D <- diff(diag(dim(B)[2]), differences = 1)
BB <- t(B) %*% B
S <- as.matrix.ssc(BB + t(D) %*% D)
if (!is.loaded(symbol.C("hattrace"))) { dyn.load(paste("hattrace", 
.Platform$dynlib.ext, sep = "")) }
out <- 0
spur <- (.C("hattrace", as.double(as.vector(slot(S, "ra"))),
            as.integer(as.vector(slot(S, "ja") - 1)),
            as.integer(as.vector(slot(S, "ia") - 1)),
            as.integer(dim(S)[1]), as.double(as.vector(BB)),
            as.double(out), PACKAGE = "hattrace"))[[6]]

Unfortunately, I get an R process segmentation fault although the C Code 
outputs the correct trace value to /tmp/hattrace.log which I checked by 
a equivalent R routine. Since this segmentation fault does not occur 
every time, I assume a pointer problem. Any help on how to solve it is 
greatly appreciated.

I am running R 2.0.0 on SuSE Linux.

Susanne Heim

-- 
Susanne Heim
Institute of Statistics, Ludwig-Maximilians-University
Ludwigstr.33/II, D-80539 Munich, Germany.
Phone: +49-89-2180-2226

From susanne.heim at stat.uni-muenchen.de  Fri Jun  3 20:16:08 2005
From: susanne.heim at stat.uni-muenchen.de (Susanne Heim)
Date: Fri Jun  3 20:16:31 2005
Subject: [Rd] using so-library involving Taucs
Message-ID: <42A09E68.8000500@stat.uni-muenchen.de>

Dear R developers,

The trace of the hat matrix H~(n,n) is computed as follows:

tr(H) = tr(BS^-1B')  = tr(S^-1B'B) := tr(X) = sum(diag(X))

with B~(n,p), S~(p,p).
Since p is of the order 103 but S is sparse I would like to employ Taucs 
linear solver ( http://www.tau.ac.il/~stoledo/taucs/ ) on

SX = B'B.

(Further improvement by implying a looping over i=1,...,p, calling 
taucs_linsolve(S, X[,i], (B'B)[,i]) and saving X[i,i] only is pending.)

For this purpose I compiled the C code "hattrace.c" to a shared object 
using:
gcc -g -Wall -I/usr/local/taucs/src -I/usr/local/taucs/build/linux  -c 
hattrace.c -o hattrace.o
gcc -g  -L/usr/local/taucs/external/lib/linux 
-L/usr/local/taucs/lib/linux -L/usr/local/lib -L/opt/gnome/lib 
-L/usr/lib/R/lib -shared -fpic -o hattrace.so hattrace.o -ltaucs 
-llapack -lf77blas -lcblas -latlas  -lmetis -lm -lg2c -lR

I tried the following test commands:
library(splines)
library(SparseM)
B <- splineDesign(knots = 1:10, x = 4:7)
D <- diff(diag(dim(B)[2]), differences = 1)
BB <- t(B) %*% B
S <- as.matrix.ssc(BB + t(D) %*% D)
if (!is.loaded(symbol.C("hattrace"))) { dyn.load(paste("hattrace", 
.Platform$dynlib.ext, sep = "")) }
out <- 0
spur <- (.C("hattrace", as.double(as.vector(slot(S, "ra"))),
            as.integer(as.vector(slot(S, "ja") - 1)),
            as.integer(as.vector(slot(S, "ia") - 1)),
            as.integer(dim(S)[1]), as.double(as.vector(BB)),
            as.double(out), PACKAGE = "hattrace"))[[6]]

Unfortunately, I get an R process segmentation fault although the C Code 
outputs the correct trace value to /tmp/hattrace.log which I checked by 
a equivalent R routine. Since this segmentation fault does not occur 
every time, I assume a pointer problem. Any help on how to solve it is 
greatly appreciated.

I am running R 2.0.0 on SuSE Linux.

Susanne Heim

-- 
Susanne Heim
Institute of Statistics, Ludwig-Maximilians-University
Ludwigstr.33/II, D-80539 Munich, Germany.
Phone: +49-89-2180-2226
From p.dalgaard at biostat.ku.dk  Fri Jun  3 20:18:55 2005
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Fri Jun  3 20:19:05 2005
Subject: [Rd] R-bugs will be offline starting June 7
Message-ID: <x2oean5mnk.fsf@turmalin.kubism.ku.dk>


Due to our IT unit moving on Wednesday and Biostat's move the day
after, the web interface to r-bugs will be offline from the afternoon
of June 7 at least until the afternoon of June 9, possibly going into
the 10th. The email interface may come up somewhat earlier.

        -pd

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From murdoch at stats.uwo.ca  Fri Jun  3 21:21:51 2005
From: murdoch at stats.uwo.ca (murdoch@stats.uwo.ca)
Date: Fri Jun  3 21:21:58 2005
Subject: [Rd] dotcode typo? (PR#7917)
Message-ID: <20050603192151.21171A352@slim.kubism.ku.dk>

On 6/2/2005 1:27 PM, bates@wisc.edu wrote:
> murdoch@stats.uwo.ca wrote:

>> 
>> Whoops, spoke too soon.  This definitely breaks the logic, so I won't 
>> commit.  With this change the check of demo(lm.glm) in package utils 
>> fails with this error message:
>> 
>>  > dead <- cbind(x, n - x)
>> 
>>  > summary(glm(dead ~ dose, family = binomial(link = logit)))
>> Error in .Call("logit_link", mu) : cannot resolve native routine
>> Execution halted
>> 
>> I'm cc'ing this to R-bugs so we don't forget it, but I'm not going to be 
>> able to fix it down myself.
>> 
>> Duncan Murdoch
>> 
>> ______________________________________________
>> R-devel@stat.math.ethz.ch mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> That occurs in code that I recently added so I better check that.

I think it was that .Call() didn't include PACKAGE="stats" in 
stats/R/family.R.  I've fixed that; I'll look for other similar cases.

Duncan Murdoch

From dmb at mrc-dunn.cam.ac.uk  Fri Jun  3 21:26:00 2005
From: dmb at mrc-dunn.cam.ac.uk (Dan Bolser)
Date: Fri Jun  3 21:26:02 2005
Subject: [Rd] documentation source diff...
Message-ID: <Pine.LNX.4.21.0506032021140.8717-100000@mail.mrc-dunn.cam.ac.uk>


Hi, I forgot the name of the function 'colSums', and expected to be able
to find it through the 'see also' section of the documentation for the
'sum' function.

Here is the diff I made of the altered documentation to facilitate this
action... (p.s. I made the diff on the R-2.1.0 source).


diff sum.Rd src/library/base/man/sum.Rd --context=2
*** sum.Rd      2005-06-03 20:24:22.468224056 +0100
--- src/library/base/man/sum.Rd 2005-04-18 22:30:27.000000000 +0100
***************
*** 33,38 ****
    Wadsworth \& Brooks/Cole.
  }
- \seealso{
-   \code{\code{\link{colSums}}.
- }
  \keyword{arith}
--- 33,35 ----

From dmbates at gmail.com  Fri Jun  3 21:45:40 2005
From: dmbates at gmail.com (Douglas Bates)
Date: Fri Jun  3 21:45:49 2005
Subject: [Rd] using so-library involving Taucs
In-Reply-To: <42A09C72.5030701@stat.uni-muenchen.de>
References: <42A09C72.5030701@stat.uni-muenchen.de>
Message-ID: <40e66e0b050603124540bc3abb@mail.gmail.com>

On 6/3/05, Susanne Heim <susanne.heim@stat.uni-muenchen.de> wrote:
> Dear R developers,
> 
> The trace of the hat matrix H~(n,n) is computed as follows:
> 
> tr(H) = tr(BS^-1B')  = tr(S^-1B'B) := tr(X) = sum(diag(X))
> 
> with B~(n,p), S~(p,p).
> Since p is of the order 10^3 but S is sparse I would like to employ
> Taucs linear solver ( http://www.tau.ac.il/~stoledo/taucs/ ) on
> 
> SX = B'B.
> 
> (Further improvement by implying a looping over i=1,...,p, calling
> taucs_linsolve(S, X[,i], (B'B)[,i]) and saving X[i,i] only is pending.)
> 
> For this purpose I compiled the C code "hattrace.c" to a shared object
> using:
> gcc -g -Wall -I/usr/local/taucs/src -I/usr/local/taucs/build/linux  -c
> hattrace.c -o hattrace.o
> gcc -g  -L/usr/local/taucs/external/lib/linux
> -L/usr/local/taucs/lib/linux -L/usr/local/lib -L/opt/gnome/lib
> -L/usr/lib/R/lib -shared -fpic -o hattrace.so hattrace.o -ltaucs
> -llapack -lf77blas -lcblas -latlas  -lmetis -lm -lg2c -lR
> 
> I tried the following test commands:
> library(splines)
> library(SparseM)
> B <- splineDesign(knots = 1:10, x = 4:7)
> D <- diff(diag(dim(B)[2]), differences = 1)
> BB <- t(B) %*% B
> S <- as.matrix.ssc(BB + t(D) %*% D)
> if (!is.loaded(symbol.C("hattrace"))) { dyn.load(paste("hattrace",
> .Platform$dynlib.ext, sep = "")) }
> out <- 0
> spur <- (.C("hattrace", as.double(as.vector(slot(S, "ra"))),
>             as.integer(as.vector(slot(S, "ja") - 1)),
>             as.integer(as.vector(slot(S, "ia") - 1)),
>             as.integer(dim(S)[1]), as.double(as.vector(BB)),
>             as.double(out), PACKAGE = "hattrace"))[[6]]
> 
> Unfortunately, I get an R process segmentation fault although the C Code
> outputs the correct trace value to /tmp/hattrace.log which I checked by
> a equivalent R routine. Since this segmentation fault does not occur
> every time, I assume a pointer problem. Any help on how to solve it is
> greatly appreciated.

Is S positive definite?  If so, it may be more effective to take the
Cholesky decomposition of S and solve the system S^(1/2)X = B then
take the sum of the squares of the elements of X.

If you wish to provide me off-list with examples of the matrices S and
B, I can check how best to do this with the Matrix package.

From ligges at statistik.uni-dortmund.de  Sat Jun  4 11:35:45 2005
From: ligges at statistik.uni-dortmund.de (Uwe Ligges)
Date: Sat Jun  4 11:32:53 2005
Subject: [Rd] documentation source diff...
In-Reply-To: <Pine.LNX.4.21.0506032021140.8717-100000@mail.mrc-dunn.cam.ac.uk>
References: <Pine.LNX.4.21.0506032021140.8717-100000@mail.mrc-dunn.cam.ac.uk>
Message-ID: <42A175F1.9030704@statistik.uni-dortmund.de>

Dan Bolser wrote:

> Hi, I forgot the name of the function 'colSums', and expected to be able
> to find it through the 'see also' section of the documentation for the
> 'sum' function.

Good idea, I think it might be worth to be added to ?apply as well.


> Here is the diff I made of the altered documentation to facilitate this
> action... (p.s. I made the diff on the R-2.1.0 source).
> 
> 
> diff sum.Rd src/library/base/man/sum.Rd --context=2
> *** sum.Rd      2005-06-03 20:24:22.468224056 +0100
> --- src/library/base/man/sum.Rd 2005-04-18 22:30:27.000000000 +0100
> ***************
> *** 33,38 ****
>     Wadsworth \& Brooks/Cole.
>   }
> - \seealso{
> -   \code{\code{\link{colSums}}.

You don't want "\code" twice...

Some suggestions for further contributions:

- you want to use diff with option -u
- you want to use the original file as first argument and the changed 
file as second argument to diff.

Uwe Ligges




> - }
>   \keyword{arith}
> --- 33,35 ----
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

From ligges at statistik.uni-dortmund.de  Sat Jun  4 11:43:34 2005
From: ligges at statistik.uni-dortmund.de (Uwe Ligges)
Date: Sat Jun  4 11:40:39 2005
Subject: [Rd] Re: [R] p-value > 1 in fisher.test()
In-Reply-To: <XFMail.050604003317.Ted.Harding@nessie.mcc.ac.uk>
References: <XFMail.050604003317.Ted.Harding@nessie.mcc.ac.uk>
Message-ID: <42A177C6.8030705@statistik.uni-dortmund.de>

(Ted Harding) wrote:

> On 03-Jun-05 Ted Harding wrote:
> 
>>And on mine
>>
>>(A: PII, Red Had 9, R-1.8.0):
>>
>> ff <- c(0,10,250,5000); dim(ff) <- c(2,2);
>>
>> 1-fisher.test(ff)$p.value
>> [1] 1.268219e-11
>>
>>(B: PIII, SuSE 7.2, R-2.1.0beta):
>>
>> ff <- c(0,10,250,5000); dim(ff) <- c(2,2);
>>
>> 1-fisher.test(ff)$p.value
>> [1] -1.384892e-12
> 
> 
> I have a suggestion (maybe it should also go to R-devel).
> 
> There are many functions in R whose designated purpose is
> to return the value of a probability (or a probability
> density). This designated purpose is in the mind of the
> person who has coded the function, and is implicit in its
> usage.
> 
> Therefore I suggest that every such function should have
> a built-in internal check that no probability should be
> less than 0 (and if the primary computation yields such
> a value then the function should set it exactly to zero),
> and should not exceed 1 (in which case the function should
> set it exactly to 1). [And, in view of recent echanges,
> I would suggest exactly +0, not -0!]
> 
> Similar for any attempts to return a negative probability
> density; while of course a positive value can be allowed
> to be anything.
> 
> All probabilities would then be guaranteed to be "clean"
> and issues like the Fisher exact test above would no longer
> be even a tiny problem.
> 
> Implementing this in the possibly many cases where it is
> not already present is no doubt a long-term (and tedious)
> project.
> 
> Meanwhile, people who encounter problems due to its absence
> can carry out their own checks and adjustments!

[moved to R-devel]

Ted, my (naive?) objection:
Many errors in the underlying code have been detected by a function 
returning a nonsensical value, but if the probability is silently set to 
0 or 1 .......
Hence I would agree to do so in special cases where it makes sense 
because of numerical issues, but please not globally.

Uwe Ligges





> Best wishes to all,
> Ted.
> 
> 
> --------------------------------------------------------------------
> E-Mail: (Ted Harding) <Ted.Harding@nessie.mcc.ac.uk>
> Fax-to-email: +44 (0)870 094 0861
> Date: 04-Jun-05                                       Time: 00:02:32
> ------------------------------ XFMail ------------------------------
> 
> ______________________________________________
> R-help@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide! http://www.R-project.org/posting-guide.html

From dmb at mrc-dunn.cam.ac.uk  Sat Jun  4 12:24:12 2005
From: dmb at mrc-dunn.cam.ac.uk (Dan Bolser)
Date: Sat Jun  4 12:24:18 2005
Subject: [Rd] documentation source diff...
In-Reply-To: <42A175F1.9030704@statistik.uni-dortmund.de>
Message-ID: <Pine.LNX.4.21.0506041122510.11784-100000@mail.mrc-dunn.cam.ac.uk>

On Sat, 4 Jun 2005, Uwe Ligges wrote:

>Dan Bolser wrote:
>
>> Hi, I forgot the name of the function 'colSums', and expected to be able
>> to find it through the 'see also' section of the documentation for the
>> 'sum' function.
>
>Good idea, I think it might be worth to be added to ?apply as well.
>
>
>> Here is the diff I made of the altered documentation to facilitate this
>> action... (p.s. I made the diff on the R-2.1.0 source).
>> 
>> 
>> diff sum.Rd src/library/base/man/sum.Rd --context=2
>> *** sum.Rd      2005-06-03 20:24:22.468224056 +0100
>> --- src/library/base/man/sum.Rd 2005-04-18 22:30:27.000000000 +0100
>> ***************
>> *** 33,38 ****
>>     Wadsworth \& Brooks/Cole.
>>   }
>> - \seealso{
>> -   \code{\code{\link{colSums}}.
>
>You don't want "\code" twice...
>
>Some suggestions for further contributions:
>
>- you want to use diff with option -u
>- you want to use the original file as first argument and the changed 
>file as second argument to diff.


Thanks very much for the info (don't know how I ended up
'\code{\code{ing}}'!)

I added your information here

http://fawn.unibw-hamburg.de/cgi-bin/Rwiki.pl?DocEditHowTo

Which is a bit of a mess ;)

Cheers,
Dan.


>
>Uwe Ligges
>
>
>
>
>> - }
>>   \keyword{arith}
>> --- 33,35 ----
>> 
>> ______________________________________________
>> R-devel@stat.math.ethz.ch mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>

From maechler at stat.math.ethz.ch  Sat Jun  4 19:17:47 2005
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Sat Jun  4 19:17:55 2005
Subject: [Rd] Re: [R] p-value > 1 in fisher.test()
In-Reply-To: <42A177C6.8030705@statistik.uni-dortmund.de>
References: <XFMail.050604003317.Ted.Harding@nessie.mcc.ac.uk>
	<42A177C6.8030705@statistik.uni-dortmund.de>
Message-ID: <17057.57915.937969.860648@stat.math.ethz.ch>

>>>>> "UweL" == Uwe Ligges <ligges@statistik.uni-dortmund.de>
>>>>>     on Sat, 04 Jun 2005 11:43:34 +0200 writes:

    UweL> (Ted Harding) wrote:
    >> On 03-Jun-05 Ted Harding wrote:
    >> 
    >>> And on mine
    >>> 
    >>> (A: PII, Red Had 9, R-1.8.0):
    >>> 
    >>> ff <- c(0,10,250,5000); dim(ff) <- c(2,2);
    >>> 
    >>> 1-fisher.test(ff)$p.value
    >>> [1] 1.268219e-11
    >>> 
    >>> (B: PIII, SuSE 7.2, R-2.1.0beta):
    >>> 
    >>> ff <- c(0,10,250,5000); dim(ff) <- c(2,2);
    >>> 
    >>> 1-fisher.test(ff)$p.value
    >>> [1] -1.384892e-12
    >> 
    >> 
    >> I have a suggestion (maybe it should also go to R-devel).
    >> 
    >> There are many functions in R whose designated purpose is
    >> to return the value of a probability (or a probability
    >> density). This designated purpose is in the mind of the
    >> person who has coded the function, and is implicit in its
    >> usage.
    >> 
    >> Therefore I suggest that every such function should have
    >> a built-in internal check that no probability should be
    >> less than 0 (and if the primary computation yields such
    >> a value then the function should set it exactly to zero),
    >> and should not exceed 1 (in which case the function should
    >> set it exactly to 1). [And, in view of recent echanges,
    >> I would suggest exactly +0, not -0!]
    >> 
    >> Similar for any attempts to return a negative probability
    >> density; while of course a positive value can be allowed
    >> to be anything.
    >> 
    >> All probabilities would then be guaranteed to be "clean"
    >> and issues like the Fisher exact test above would no longer
    >> be even a tiny problem.
    >> 
    >> Implementing this in the possibly many cases where it is
    >> not already present is no doubt a long-term (and tedious)
    >> project.
    >> 
    >> Meanwhile, people who encounter problems due to its absence
    >> can carry out their own checks and adjustments!

    UweL> [moved to R-devel]

    UweL> Ted, my (naive?) objection:
    UweL> Many errors in the underlying code have been detected by a function 
    UweL> returning a nonsensical value, but if the probability is silently set to 
    UweL> 0 or 1 .......
    UweL> Hence I would agree to do so in special cases where it makes sense 
    UweL> because of numerical issues, but please not globally.

I agree very much with Uwe's point.

Further to fisher.test(): This whole thread is
re-hashing a pretty recent  bug report on fisher.test() 
{ "negative p-values from fisher's test (PR#7801)", April '05}
I think that only *because* of the obviously wrong P-values have
we found and confirmed that the refereed and published code
underlying fisher.test() is bogous.   Such knowledge would have
been harder to gain if the P-values would have been cut into [0,1].

Martin Maechler

    UweL> Uwe Ligges

    >> Best wishes to all,
    >> Ted.
    >> 
    >> 
    >> --------------------------------------------------------------------
    >> E-Mail: (Ted Harding) <Ted.Harding@nessie.mcc.ac.uk>
    >> Fax-to-email: +44 (0)870 094 0861
    >> Date: 04-Jun-05                                       Time: 00:02:32
    >> ------------------------------ XFMail ------------------------------

From bullard at berkeley.edu  Sat Jun  4 22:00:49 2005
From: bullard at berkeley.edu (James Bullard)
Date: Sat Jun  4 22:09:15 2005
Subject: [Rd] Characters in lists.
Message-ID: <42A20871.7050509@berkeley.edu>

Hi all, this should be a relatively straightforward question. I am 
constructing an R list in C which will contain both Integers and Strings 
(by string I mean in C I have const char* whose values I want passed 
through to R) The Integers are easy. I do something like this:

PROTECT(tmp = NEW_INTEGER(1));
INTEGER(tmp)[0] = header.GetCols();
SET_STRING_ELT(names, i, mkChar("cols"));
SET_VECTOR_ELT(vals, i++, tmp);
UNPROTECT(1);

This works just fine. So, when I wanted to set a string element of the 
list (please correct my nomenclature if I am refering to things 
incorrectly) I used the following bit of code:

SET_STRING_ELT(names, i, mkChar("header"));
SET_VECTOR_ELT(vals, i++, mkChar(header.GetHeader().c_str()));

I did this based on the fact that this is how I have created named 
attributes for lists in the past and it seemed to work fine, however in 
R when I call the function I get the following results (sorry for the 
output, but I think the important thing is the <CHARSXP: ...>).

$header
<CHARSXP: 
"Cols=712\rRows=712\rTotalX=712\rTotalY=712\rOffsetX=0\rOffsetY=0\rGridCornerUL=162 
119\rGridCornerUR=5286 153\rGridCornerLR=5253 5270\rGridCornerLL=130 
5237\rAxis-invertX=0\rAxisInvertY=0\rswapXY=0\rDatHeader=[0..65528]  
T1:CLS=5412 RWS=5412 XIN=2  YIN=2  VE=30        2.0 07/09/04 13:38:45 
50101350  M10   \024  \024 Doe16s.1sq \024  \024  \024  \024  \024  
\024  \024  \024  \024 
6\rAlgorithm=Percentile\rAlgorithmParameters=Percentile:75;CellMargin:2;OutlierHigh:1.500;OutlierLow:1.004;AlgVersion:6.0;FixedCellSize:FALSE;IgnoreOutliersInShiftRows:FALSE;FeatureExtraction:FALSE;UseSubgrids:FALSE;RandomizePixels:FALSE;ErrorBasis:StdvMean;StdMult:1.000000\r">

Ok, so then I thought to try something a little closer to how I did the 
INTEGER. So I used the following code:

PROTECT(tmp = NEW_CHARACTER(1));
CHAR(tmp)[0] = *header.GetHeader().c_str();
SET_STRING_ELT(names, i, mkChar("header"));
SET_VECTOR_ELT(vals, i++, tmp);
UNPROTECT(1);

Which in R returns the following:

$header
[1] ""

So that is not working. So the question is: given a function in C/C++ 
which returns a const char* how do I correctly create an R character 
string/vector (terminology?) to set as a list element. Thanks for any 
advice or any particular parts of the R source tree which might be 
illuminating. Also, if anyone knows some shorter code for the above code 
which sets the INTEGER elements of the list that would be nice as well.

Thanks in advance, Jim

From ellis at stat.harvard.edu  Sat Jun  4 13:49:04 2005
From: ellis at stat.harvard.edu (Byron Ellis)
Date: Sun Jun  5 01:43:45 2005
Subject: [Rd] fix for save()'ing RAW on PPC (and other big endian platforms)
Message-ID: <CA8EF40B-2434-4F54-ACAC-C411249384D2@stat.harvard.edu>

OutByte should take a byte, not an int. Writing the first byte of an  
int is only going to work on little endian systems.

serialize.c:262
-static void OutByte(R_outpstream_t stream, int i)
+static void OutByte(R_outpstream_t stream, Rbyte i)



---
Byron Ellis (ellis@stat.harvard.edu)
"Oook" -- The Librarian

From p.dalgaard at biostat.ku.dk  Sun Jun  5 02:17:07 2005
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Sun Jun  5 02:17:17 2005
Subject: [Rd] fix for save()'ing RAW on PPC (and other big endian
	platforms)
In-Reply-To: <CA8EF40B-2434-4F54-ACAC-C411249384D2@stat.harvard.edu>
References: <CA8EF40B-2434-4F54-ACAC-C411249384D2@stat.harvard.edu>
Message-ID: <x23brxr724.fsf@turmalin.kubism.ku.dk>

Byron Ellis <ellis@stat.harvard.edu> writes:

> OutByte should take a byte, not an int. Writing the first byte of an
> int is only going to work on little endian systems.
> 
> serialize.c:262
> -static void OutByte(R_outpstream_t stream, int i)
> +static void OutByte(R_outpstream_t stream, Rbyte i)

Thanks for tracking this down.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From ripley at stats.ox.ac.uk  Sun Jun  5 09:34:09 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Sun Jun  5 09:34:18 2005
Subject: [Rd] Characters in lists.
In-Reply-To: <42A20871.7050509@berkeley.edu>
References: <42A20871.7050509@berkeley.edu>
Message-ID: <Pine.LNX.4.61.0506050824230.26525@gannet.stats>

On Sat, 4 Jun 2005, James Bullard wrote:

> Hi all, this should be a relatively straightforward question. I am 
> constructing an R list in C which will contain both Integers and Strings (by 
> string I mean in C I have const char* whose values I want passed through to 
> R) The Integers are easy. I do something like this:
>
> PROTECT(tmp = NEW_INTEGER(1));
> INTEGER(tmp)[0] = header.GetCols();
> SET_STRING_ELT(names, i, mkChar("cols"));
> SET_VECTOR_ELT(vals, i++, tmp);
> UNPROTECT(1);
>
> This works just fine. So, when I wanted to set a string element of the list 
> (please correct my nomenclature if I am refering to things incorrectly) I 
> used the following bit of code:
>
> SET_STRING_ELT(names, i, mkChar("header"));
> SET_VECTOR_ELT(vals, i++, mkChar(header.GetHeader().c_str()));
>
> I did this based on the fact that this is how I have created named attributes 
> for lists in the past and it seemed to work fine, however in R when I call 
> the function I get the following results (sorry for the output, but I think 
> the important thing is the <CHARSXP: ...>).
>
> $header
> <CHARSXP: 
> "Cols=712\rRows=712\rTotalX=712\rTotalY=712\rOffsetX=0\rOffsetY=0\rGridCornerUL=162 
> 119\rGridCornerUR=5286 153\rGridCornerLR=5253 5270\rGridCornerLL=130 
> 5237\rAxis-invertX=0\rAxisInvertY=0\rswapXY=0\rDatHeader=[0..65528] 
> T1:CLS=5412 RWS=5412 XIN=2  YIN=2  VE=30        2.0 07/09/04 13:38:45 
> 50101350  M10   \024  \024 Doe16s.1sq \024  \024  \024  \024  \024  \024 
> \024  \024  \024 
> 6\rAlgorithm=Percentile\rAlgorithmParameters=Percentile:75;CellMargin:2;OutlierHigh:1.500;OutlierLow:1.004;AlgVersion:6.0;FixedCellSize:FALSE;IgnoreOutliersInShiftRows:FALSE;FeatureExtraction:FALSE;UseSubgrids:FALSE;RandomizePixels:FALSE;ErrorBasis:StdvMean;StdMult:1.000000\r">

A character vector is a STRSXP, so mkChar is not the right function.

> Ok, so then I thought to try something a little closer to how I did the 
> INTEGER. So I used the following code:
>
> PROTECT(tmp = NEW_CHARACTER(1));
> CHAR(tmp)[0] = *header.GetHeader().c_str();
> SET_STRING_ELT(names, i, mkChar("header"));
> SET_VECTOR_ELT(vals, i++, tmp);
> UNPROTECT(1);
>
> Which in R returns the following:
>
> $header
> [1] ""
>
> So that is not working.

As STRSXPs are not structured identically to INTSXPs.

> So the question is: given a function in C/C++ which 
> returns a const char* how do I correctly create an R character string/vector 
> (terminology?) to set as a list element. Thanks for any advice or any 
> particular parts of the R source tree which might be illuminating. Also, if 
> anyone knows some shorter code for the above code which sets the INTEGER 
> elements of the list that would be nice as well.

You want mkString, e.g.

SET_STRING_ELT(names, i, mkChar("header"));
SET_VECTOR_ELT(vals, i++, mkString(*header.GetHeader().c_str()));

I would have written

> PROTECT(tmp = NEW_INTEGER(1));
> INTEGER(tmp)[0] = header.GetCols();
> SET_STRING_ELT(names, i, mkChar("cols"));
> SET_VECTOR_ELT(vals, i++, tmp);
> UNPROTECT(1);

as

SET_STRING_ELT(names, i, mkChar("cols"));
tmp = allocVector(INTSXP, 1)
INTEGER(tmp)[0] = header.GetCols();
SET_VECTOR_ELT(vals, i++, tmp);

as no further allocation and hence no PROTECTion is required.  You could 
encapsulate it as a function (mkInt?) if you prefer.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From Ted.Harding at nessie.mcc.ac.uk  Sun Jun  5 12:40:34 2005
From: Ted.Harding at nessie.mcc.ac.uk ( (Ted Harding))
Date: Sun Jun  5 12:47:36 2005
Subject: [Rd] Re: [R] p-value > 1 in fisher.test()
In-Reply-To: <17057.57915.937969.860648@stat.math.ethz.ch>
Message-ID: <XFMail.050605114034.Ted.Harding@nessie.mcc.ac.uk>

On 04-Jun-05 Martin Maechler wrote:
>>>>>> "UweL" == Uwe Ligges <ligges@statistik.uni-dortmund.de>
>>>>>>     on Sat, 04 Jun 2005 11:43:34 +0200 writes:
> 
>     UweL> (Ted Harding) wrote:
>     >> On 03-Jun-05 Ted Harding wrote:
>     >> [...]
>     >> I have a suggestion (maybe it should also go to R-devel).
>     >> 
>     >> There are many functions in R whose designated purpose is
>     >> to return the value of a probability (or a probability
>     >> density). This designated purpose is in the mind of the
>     >> person who has coded the function, and is implicit in its
>     >> usage.
>     >> 
>     >> Therefore I suggest that every such function should have
>     >> a built-in internal check that no probability should be
>     >> less than 0 (and if the primary computation yields such
>     >> a value then the function should set it exactly to zero),
>     >> and should not exceed 1 (in which case the function should
>     >> set it exactly to 1). [And, in view of recent echanges,
>     >> I would suggest exactly +0, not -0!]
>     >> 
>     >> Similar for any attempts to return a negative probability
>     >> density; while of course a positive value can be allowed
>     >> to be anything.
>     >> 
>     >> All probabilities would then be guaranteed to be "clean"
>     >> and issues like the Fisher exact test above would no longer
>     >> be even a tiny problem.
>     >> 
>     >> Implementing this in the possibly many cases where it is
>     >> not already present is no doubt a long-term (and tedious)
>     >> project.
>     >> 
>     >> Meanwhile, people who encounter problems due to its absence
>     >> can carry out their own checks and adjustments!
> 
>     UweL> [moved to R-devel]
> 
>     UweL> Ted, my (naive?) objection:
>     UweL> Many errors in the underlying code have been detected by a
> function 
>     UweL> returning a nonsensical value, but if the probability is
> silently set to 
>     UweL> 0 or 1 .......
>     UweL> Hence I would agree to do so in special cases where it makes
> sense 
>     UweL> because of numerical issues, but please not globally.
> 
> I agree very much with Uwe's point.
> 
> Further to fisher.test(): This whole thread is
> re-hashing a pretty recent  bug report on fisher.test() 
> { "negative p-values from fisher's test (PR#7801)", April '05}
> I think that only *because* of the obviously wrong P-values have
> we found and confirmed that the refereed and published code
> underlying fisher.test() is bogous.   Such knowledge would have
> been harder to gain if the P-values would have been cut into [0,1].
> 
> Martin Maechler

Uwe, Martin: Those are very pertinent comments, and they lead me
to agree with you!

I really had in mind the case where the code for a function was
not in question, but the usual "rounding errors" could generate
an "impossible" result.

So I think that perhaps the best solution is the one I proposed
as "interim", namely that people carry out their own checks and
adjustments.

Best wishes,
Ted.


--------------------------------------------------------------------
E-Mail: (Ted Harding) <Ted.Harding@nessie.mcc.ac.uk>
Fax-to-email: +44 (0)870 094 0861
Date: 05-Jun-05                                       Time: 11:40:21
------------------------------ XFMail ------------------------------

From murdoch at stats.uwo.ca  Sun Jun  5 15:46:15 2005
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Sun Jun  5 15:46:21 2005
Subject: [Rd] Re: [R] A long digression on packages
In-Reply-To: <42A37A3B.6030901@ozemail.com.au>
References: <42A37A3B.6030901@ozemail.com.au>
Message-ID: <42A30227.70409@stats.uwo.ca>

Hi.  I think this discussion is more relevant to R-devel, so that's 
where I've sent my reply.

Jim Lemon wrote:
> Hello again,
> 
> First, thanks for the help that got the latest plotrix package finished. 
> I had been planning to write something about packages since Scott 
> Waichler offered the gantt.chart function. Then Ben Bolker (who helped 
> me to write the axis.break function) asked if I would be willing to 
> include some of his plotting functions and almost immediately after that 
> Sander Oom kindly donated the soil texture plotting function in the same 
> way. I could procrastinate no longer.
> 
> There are now about 500 packages on CRAN. Some are focused, covering a 
> particular area well, easy for the prospective user to discover their 
> potential usefulness, while others are less so. I consider the plotrix 
> package one of the former, and so as not to upset too many people, I 
> will use the other package I contributed to CRAN as an example of the 
> latter.
> 
> When I initially wrote concord, it was intended as a package of 
> functions dealing with concordance and reliability. Okay, but I found 
> Kendall's W so useful that I couldn't help including it, and somehow 
> Page's test of ordered alternatives crept in and invited the Jonckheere 
> test to the party and at that point I realized that I had maybe forty or 
> fifty more or less useful functions floating around my R directory. Now 
> many of these are probably floating around other people's R directories 
> as well. Consider Cohen's kappa. The tabular method is included in 
> e1071, my version has Cohen's plus two additional methods, and the 
> recently contributed psy package has yet another version. Maybe there 
> are still more encrypted in packages that I haven't even looked at.
> 
> The point of all this is that it would make many user's lives easier if 
> there were less pandemonium in packages. The mistakes I have made in 
> concord I have tried not to repeat in plotrix. Unless a user search of 
> the documentation in packages materializes, it's become mighty hard to 
> work out if the function you don't want to write has already been 
> written. We also spend a lot of time responding to or deriding 
> correspondents who ask about such things.
> 
> Would it be an idea to have informal R periphery teams, or even 
> individual package lords, who would bear with, or maybe welcome, other 
> people's functions? That is, I think plotrix has been greatly enhanced 
> by recent contributions. Conversely, I wonder if it would be possible to 
> shrink or maybe even evaporate concord by discovering duplicate methods 
> in other packages or by contributing concord functions or parts thereof 
> myself. It's not that I don't like maintaining concord or think the 
> functions are worthless, just that I am mildly embarrassed to be adding 
> to the duplication of effort and unnecessary volume of packages.
> 
> Feel free to comment upon this, although if you really want to rave, try 
> it out on me first before clagging the list. Thanks for your attention.

A difficulty with multi-author packages is that it's harder to maintain 
consistency within the package, and it's harder to handle maintenance.

Another approach is to try to keep your packages small and focussed. 
The problem with this is what you mentioned above:  there are already 
500 packages, and it's hard to know what's there.  The "task views" 
should help with this, there are 5 online so far.  (See 
<http://cran.us.r-project.org/src/contrib/Views>.)  There is also a need 
for Misc packages for things too small to be a package on their own, but 
I think we need better ways to expose what is in them.

Of course, with disk sizes as they are now, it's not unreasonable to 
install all of the contributed CRAN packages on a PC.  Then 
help.search() *will* do searches through them all.

Duncan Murdoch

From edd at debian.org  Sun Jun  5 17:03:38 2005
From: edd at debian.org (Dirk Eddelbuettel)
Date: Sun Jun  5 17:03:50 2005
Subject: [Rd] Re: [R] A long digression on packages
In-Reply-To: <42A30227.70409@stats.uwo.ca>
References: <42A37A3B.6030901@ozemail.com.au>
	<42A30227.70409@stats.uwo.ca>
Message-ID: <17059.5194.807715.740810@basebud.nulle.part>


Jim raises good points, as do the replies. On the topic of '500+ and
growing', let me add my pet peeve: It is mighty impossible to know /what/
changed /when/ in CRANland.

Being Debian maintainer for a fair number of packages, I owe users of those
packages timely updates. But the best I can do is to look at the
timestamp-sorted source directory http://cran.r-project.org/src/contrib/?M=D
That is tedious, as well as error-prone.  Moreover, as an R user, I'd like to
know what is being added and, and what is being changed. There is no way to
know right now.

I would not be hard to write a little monitoring script that looks at the
directory (and keeps tab in a Rdata structure, or SQLite db, or ...) and
spits out either emails, or maybe rss-feed updates, of either or both of 'new
packages' or 'new versions'.  If additionally we would enforce (err let's
start with encourage) a standardised changelog (say $SRC/inst/CHANGES or
$SRC/inst/ChangeLog) then that could get parsed too.  I had meant to play
with some code for this for a while now but it just hasn't happened.
Whining on a list is easier than writing code, unfortunately...

Comments?

Dirk

-- 
Statistics: The (futile) attempt to offer certainty about uncertainty.
         -- Roger Koenker, 'Dictionary of Received Ideas of Statistics'

From p.dalgaard at biostat.ku.dk  Sun Jun  5 17:31:05 2005
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Sun Jun  5 17:31:13 2005
Subject: [Rd] Re: [R] A long digression on packages
In-Reply-To: <17059.5194.807715.740810@basebud.nulle.part>
References: <42A37A3B.6030901@ozemail.com.au> <42A30227.70409@stats.uwo.ca>
	<17059.5194.807715.740810@basebud.nulle.part>
Message-ID: <x2psv0q0qu.fsf@turmalin.kubism.ku.dk>

Dirk Eddelbuettel <edd@debian.org> writes:

> Jim raises good points, as do the replies. On the topic of '500+ and
> growing', let me add my pet peeve: It is mighty impossible to know /what/
> changed /when/ in CRANland.
> 
> Being Debian maintainer for a fair number of packages, I owe users of those
> packages timely updates. But the best I can do is to look at the
> timestamp-sorted source directory http://cran.r-project.org/src/contrib/?M=D
> That is tedious, as well as error-prone.  Moreover, as an R user, I'd like to
> know what is being added and, and what is being changed. There is no way to
> know right now.
> 
> I would not be hard to write a little monitoring script that looks at the
> directory (and keeps tab in a Rdata structure, or SQLite db, or ...) and
> spits out either emails, or maybe rss-feed updates, of either or both of 'new
> packages' or 'new versions'.  If additionally we would enforce (err let's
> start with encourage) a standardised changelog (say $SRC/inst/CHANGES or
> $SRC/inst/ChangeLog) then that could get parsed too.  I had meant to play
> with some code for this for a while now but it just hasn't happened.
> Whining on a list is easier than writing code, unfortunately...
> 
> Comments?

You might want to have a closer look at the way recommended packages
are handled by an R distribution build, using rsync, links,
timestamps, and makefile rules. 

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From edd at debian.org  Sun Jun  5 18:08:59 2005
From: edd at debian.org (Dirk Eddelbuettel)
Date: Sun Jun  5 18:09:09 2005
Subject: [Rd] Re: [R] A long digression on packages
In-Reply-To: <x2psv0q0qu.fsf@turmalin.kubism.ku.dk>
References: <42A37A3B.6030901@ozemail.com.au> <42A30227.70409@stats.uwo.ca>
	<17059.5194.807715.740810@basebud.nulle.part>
	<x2psv0q0qu.fsf@turmalin.kubism.ku.dk>
Message-ID: <17059.9115.969866.670063@basebud.nulle.part>


On 5 June 2005 at 17:31, Peter Dalgaard wrote:
| Dirk Eddelbuettel <edd@debian.org> writes:
| 
| > Jim raises good points, as do the replies. On the topic of '500+ and
| > growing', let me add my pet peeve: It is mighty impossible to know /what/
| > changed /when/ in CRANland.
| > 
| > Being Debian maintainer for a fair number of packages, I owe users of those
| > packages timely updates. But the best I can do is to look at the
| > timestamp-sorted source directory http://cran.r-project.org/src/contrib/?M=D
| > That is tedious, as well as error-prone.  Moreover, as an R user, I'd like to
| > know what is being added and, and what is being changed. There is no way to
| > know right now.
| > 
| > I would not be hard to write a little monitoring script that looks at the
| > directory (and keeps tab in a Rdata structure, or SQLite db, or ...) and
| > spits out either emails, or maybe rss-feed updates, of either or both of 'new
| > packages' or 'new versions'.  If additionally we would enforce (err let's
| > start with encourage) a standardised changelog (say $SRC/inst/CHANGES or
| > $SRC/inst/ChangeLog) then that could get parsed too.  I had meant to play
| > with some code for this for a while now but it just hasn't happened.
| > Whining on a list is easier than writing code, unfortunately...
| > 
| > Comments?
| 
| You might want to have a closer look at the way recommended packages
| are handled by an R distribution build, using rsync, links,
| timestamps, and makefile rules. 

And recode/adapt that for the packages I am interested in? Works, but doesn't
scale.  But maybe I am misunderstanding you here.

Dirk

-- 
Statistics: The (futile) attempt to offer certainty about uncertainty.
         -- Roger Koenker, 'Dictionary of Received Ideas of Statistics'

From znmeb at cesmail.net  Sun Jun  5 21:48:38 2005
From: znmeb at cesmail.net (M. Edward (Ed) Borasky)
Date: Sun Jun  5 21:48:50 2005
Subject: [Rd] Re: [R] A long digression on packages
In-Reply-To: <42A30227.70409@stats.uwo.ca>
References: <42A37A3B.6030901@ozemail.com.au> <42A30227.70409@stats.uwo.ca>
Message-ID: <42A35716.5060304@cesmail.net>



Duncan Murdoch wrote:

> Of course, with disk sizes as they are now, it's not unreasonable to
> install all of the contributed CRAN packages on a PC.  Then
> help.search() *will* do searches through them all.

Some of them are very specialized, and some of them have non-CRAN
dependencies. I've done a few "load everything from CRAN" operations on
my Linux boxes, only to overflow the warnings list with missing Linux
software. And, as an example, I have zero use for molecular biology
packages.

Dirk Eddelbuettel has done a lot of work integrating the CRAN and other
R package collections with the Debian GNU/Linux package management
system. This rather neatly solves the non-CRAN dependency problems, at
least for Debian.

Other people have done similar things for Perl packages and Common Lisp
packages, both in Debian and in Gentoo's Portage package management
system. CRAN could easily be integrated into Portage, but nobody has
stepped forward to volunteer. Maybe when I retire ... :)

And where does this leave Windows users? There's nothing like Debian or
Portage for them; CRAN would have to build it from scratch.

From ggrothendieck at gmail.com  Sun Jun  5 22:28:14 2005
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Sun Jun  5 22:28:21 2005
Subject: [Rd] Re: [R] A long digression on packages
In-Reply-To: <42A35716.5060304@cesmail.net>
References: <42A37A3B.6030901@ozemail.com.au> <42A30227.70409@stats.uwo.ca>
	<42A35716.5060304@cesmail.net>
Message-ID: <971536df0506051328578792e2@mail.gmail.com>

On 6/5/05, M. Edward (Ed) Borasky <znmeb@cesmail.net> wrote:
> 
> 
> Duncan Murdoch wrote:
> 
> > Of course, with disk sizes as they are now, it's not unreasonable to
> > install all of the contributed CRAN packages on a PC.  Then
> > help.search() *will* do searches through them all.
> 
> Some of them are very specialized, and some of them have non-CRAN
> dependencies. I've done a few "load everything from CRAN" operations on
> my Linux boxes, only to overflow the warnings list with missing Linux
> software. And, as an example, I have zero use for molecular biology
> packages.
> 
> Dirk Eddelbuettel has done a lot of work integrating the CRAN and other
> R package collections with the Debian GNU/Linux package management
> system. This rather neatly solves the non-CRAN dependency problems, at
> least for Debian.
> 
> Other people have done similar things for Perl packages and Common Lisp
> packages, both in Debian and in Gentoo's Portage package management
> system. CRAN could easily be integrated into Portage, but nobody has
> stepped forward to volunteer. Maybe when I retire ... :)
> 
> And where does this leave Windows users? There's nothing like Debian or
> Portage for them; CRAN would have to build it from scratch.

I think that some time ago there was a discussion of having a downloadable
file that oould be used to help.search through so that a relatively small
download and no package installation would allow a comprehensive
offline help.search of all CRAN packages.   An online version of 
help.search might be another possibility.

From znmeb at cesmail.net  Sun Jun  5 23:03:53 2005
From: znmeb at cesmail.net (M. Edward (Ed) Borasky)
Date: Sun Jun  5 23:04:12 2005
Subject: [Rd] Re: [R] A long digression on packages
In-Reply-To: <971536df0506051328578792e2@mail.gmail.com>
References: <42A37A3B.6030901@ozemail.com.au> <42A30227.70409@stats.uwo.ca>	
	<42A35716.5060304@cesmail.net>
	<971536df0506051328578792e2@mail.gmail.com>
Message-ID: <42A368B9.70104@cesmail.net>

Gabor Grothendieck wrote:

>I think that some time ago there was a discussion of having a downloadable
>file that oould be used to help.search through so that a relatively small
>download and no package installation would allow a comprehensive
>offline help.search of all CRAN packages.   An online version of 
>help.search might be another possibility.
>
There are some great open source indexing and search tools available,
given documentation in HTML or PDF formats. One I'm rather fond of is
"swish-e", which can be found at

*http://www.swish-e.org/

There is a Windows native version available, IIRC, although I've only
used it on Linux systems.
*

From edd at debian.org  Sun Jun  5 23:28:02 2005
From: edd at debian.org (Dirk Eddelbuettel)
Date: Sun Jun  5 23:28:13 2005
Subject: [Rd] Re: [R] A long digression on packages
In-Reply-To: <42A35716.5060304@cesmail.net>
References: <42A37A3B.6030901@ozemail.com.au> <42A30227.70409@stats.uwo.ca>
	<42A35716.5060304@cesmail.net>
Message-ID: <17059.28258.266748.637046@basebud.nulle.part>


On 5 June 2005 at 12:48, M. Edward (Ed) Borasky wrote:
| Dirk Eddelbuettel has done a lot of work integrating the CRAN and other
| R package collections with the Debian GNU/Linux package management
| system. This rather neatly solves the non-CRAN dependency problems, at
| least for Debian.

Thanks for the kind mention but I'm afraid that is actually not quite
correct.  We do now have some 50 or so CRAN packages in Debian ... but that
does not solve the updating "problem".  I.e. if you install those Debian
packages, and then ask R to do update.packages() it has no notion of what
came from manual installation (and should get updated) and what came from
Debian and should get a new package via apt-get.  In Quantian, I use the
existing Debian package and then fill 'by hand' to get fairly complete
coverage.

Also, compared to CRAN, we're not providing that much coverage.  There is,
however, work going on behind the scenes to provide /most/ of CRAN via
auto-generated Debian packages, preferably in an apt-get'able archive. We're
not ready yet to lift the curtain.  But if there's someone out here in the
Debian and R intersection interested and willing to help (with some crude
Perl coding), let me/us know and we'll get you involved.

Regards, Dirk

-- 
Statistics: The (futile) attempt to offer certainty about uncertainty.
         -- Roger Koenker, 'Dictionary of Received Ideas of Statistics'

From dubravko.dolic at komdat.com  Mon Jun  6 11:57:44 2005
From: dubravko.dolic at komdat.com (dubravko.dolic@komdat.com)
Date: Mon Jun  6 11:57:53 2005
Subject: [Rd] Segmentation fault using gentoo linux and mysql (PR#7919)
Message-ID: <20050606095744.DB2C9A350@slim.kubism.ku.dk>

Full_Name: Dubravko Dolic
Version: 2.1.0
OS: Linux
Submission from: (NULL) (212.18.9.161)


I posted this mail to the HELP list earlier. Meanwhile we are quite shure that
there must be a bug. Not nessecarily in R. But maybe we can get some hints how
to track the problem using R. Currently we are trying something with the ATLAS
lib according to Bug Report 7718 on this Repository.

Now my problem again:

We have a data server with some amounts of data which we try to analyze using R.
Now having some MySQL databases with MySQL Ver 12.22 Distrib 4.0.24 and R 2.1.0
compiled from sources on this machine:

Fujitsu Siemens CELSIUS V810
4 GB RAM
Dual AMD Opteron Processor 246
Harddisk via SAN.

(see user details:)
sysname                         "Linux" <- gentoo linux
release		"2.6.11-hardened-r13"                               version "#1 SMP Fri
May 27 15:25:55 CEST 2005"                               machine 				"x86_64" 

Editor: Emacs with ESS 5.2.3


While I can connect R to the database (RMySQL/DBI) and retrieve basic
information (e.g. SHOW TABLE, DESCRIBE) it is not possible to send SQL Queries.
The moment I try to do: res <- dbSendQuery(con, "select * from table") or any
other SELECT statement R terminates and I receive a Segmentation Fault.

Is anyone out there having similar problems in this environment. Any hints
welcome.

Regards


Dubravko Dolic
Statistical Analyst
Tel:      +49 (0)89-55 27 44 - 4630
Fax:     +49 (0)89-55 27 44 - 2463
Email: dubravko.dolic@komdat.com
Komdat GmbH
Nymphenburger Stra?e 86
80636 M?nchen

From ripley at stats.ox.ac.uk  Mon Jun  6 13:24:26 2005
From: ripley at stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Mon Jun  6 13:24:34 2005
Subject: [Rd] alloca() on FreeBSD (PR#7890)
Message-ID: <20050606112426.3827BA3C4@slim.kubism.ku.dk>

On Mon, 23 May 2005 vangyzen@stat.duke.edu wrote:

> Full_Name: Eric van Gyzen
> Version: 2.1.0
> OS: FreeBSD 5.4
> Submission from: (NULL) (152.3.22.33)
>
>
> R-2.1.0 fails to compile on the newest release of FreeBSD, complaining about
> undefined references to __builtin_alloca.  On FreeBSD, alloca() is declared in
> stdlib.h, not alloca.h as the R sources expect.  Therefore, HAVE_DECL_ALLOCA
> does not get set, so the R sources declare alloca() after it has already been
> #defined by stdlib.h.
>
> A possible fix is to modify the configure script to look for the declaration of
> alloca() in stdlib.h (perhaps after it fails to find it in alloca.h).

It is already supposed to, so it is not finding the declaration there 
either. If you look up the definition of

AC_CHECK_DECLS([alloca], , , [#include <alloca.h>])

it searches in stdlib.h.  Can you please send us the appropriate part of 
config.log?  It may be that this is failing because alloca.h is not found
(but AC_FUNC_ALLOCA is making the same assumptions).

Perhaps the easiest way out is to override the setting on FreeBSD: can 
you please confirm that manually changing

#define HAVE_DECL_ALLOCA 1

in config.h works?

> This was previously reported in PR#7881.

So please don't open a new report on the subject!

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From root at bol.net.in  Mon Jun  6 14:18:03 2005
From: root at bol.net.in (root@bol.net.in)
Date: Mon Jun  6 14:18:10 2005
Subject: [Rd] Your e-mail could not be delivered (PR#7920)
Message-ID: <20050606121803.916A5871A@slim.kubism.ku.dk>

eTrust Secure Content Manager SMTPMAIL could not deliver the e-mail below because of unreachable host
Please check the recipients e-mail address before you try again:
bush@bol.net.in

Original message header:
=======================================

X-eSCM-MailFrom: <r-bugs@r-project.org>
Received: from mx1.bol.net.in (203.94.244.182)
	by mtnl_scm02 (202.159.212.38);
	Sun, 05 June 2005 17:43:58 +0530
X-eSCM-MailFrom: <r-bugs@r-project.org>
Received: from 61.113.174.132 (61.113.174.132)
	by mtnl_scm01 (203.94.244.182);
	Sun, 05 June 2005 17:43:47 +0530
Received: from no.name.available by [61.113.174.132]
          via smtpd (for [203.94.244.182] [203.94.244.182]) with ESMTP; Sun, 5 Jun 2005 21:13:12 +0900
From: r-bugs@r-project.org
To: bush@bol.net.in
Subject: Hello
Date: Sun, 5 Jun 2005 21:12:18 -0700
MIME-Version: 1.0
Content-Type: multipart/mixed;
	boundary="----=_NextPart_000_0013_B172FF3B.20FA9795"
X-Priority: 3
X-MSMail-Priority: Normal

From ripley at stats.ox.ac.uk  Mon Jun  6 16:17:06 2005
From: ripley at stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Mon Jun  6 16:17:14 2005
Subject: [Rd] Segmentation fault using gentoo linux and mysql (PR#7919)
Message-ID: <20050606141706.B53FDA24A@slim.kubism.ku.dk>

This is most likely a problem with the package RMySQL and not with R.

On Mon, 6 Jun 2005 dubravko.dolic@komdat.com wrote:

> Full_Name: Dubravko Dolic
> Version: 2.1.0
> OS: Linux
> Submission from: (NULL) (212.18.9.161)
>
>
> I posted this mail to the HELP list earlier. Meanwhile we are quite shure that
> there must be a bug. Not nessecarily in R. But maybe we can get some hints how
> to track the problem using R. Currently we are trying something with the ATLAS
> lib according to Bug Report 7718 on this Repository.
>
> Now my problem again:
>
> We have a data server with some amounts of data which we try to analyze using R.
> Now having some MySQL databases with MySQL Ver 12.22 Distrib 4.0.24 and R 2.1.0
> compiled from sources on this machine:
>
> Fujitsu Siemens CELSIUS V810
> 4 GB RAM
> Dual AMD Opteron Processor 246
> Harddisk via SAN.
>
> (see user details:)
> sysname                         "Linux" <- gentoo linux
> release		"2.6.11-hardened-r13"                               version "#1 SMP Fri
> May 27 15:25:55 CEST 2005"                               machine 				"x86_64"
>
> Editor: Emacs with ESS 5.2.3
>
>
> While I can connect R to the database (RMySQL/DBI) and retrieve basic
> information (e.g. SHOW TABLE, DESCRIBE) it is not possible to send SQL Queries.
> The moment I try to do: res <- dbSendQuery(con, "select * from table") or any
> other SELECT statement R terminates and I receive a Segmentation Fault.

Please use gdb to trace where the fault is occurring: my guess is in 
RMySQL.so, in which case this is best discussed with the package 
maintainer (see the R FAQ, section on BUGS).

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From ripley at stats.ox.ac.uk  Mon Jun  6 16:17:30 2005
From: ripley at stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Mon Jun  6 16:17:37 2005
Subject: [Rd] Segmentation fault using gentoo linux and mysql (PR#7919)
Message-ID: <20050606141730.D9439A24A@slim.kubism.ku.dk>

This is most likely a problem with the package RMySQL and not with R.

On Mon, 6 Jun 2005 dubravko.dolic@komdat.com wrote:

> Full_Name: Dubravko Dolic
> Version: 2.1.0
> OS: Linux
> Submission from: (NULL) (212.18.9.161)
>
>
> I posted this mail to the HELP list earlier. Meanwhile we are quite shure that
> there must be a bug. Not nessecarily in R. But maybe we can get some hints how
> to track the problem using R. Currently we are trying something with the ATLAS
> lib according to Bug Report 7718 on this Repository.
>
> Now my problem again:
>
> We have a data server with some amounts of data which we try to analyze using R.
> Now having some MySQL databases with MySQL Ver 12.22 Distrib 4.0.24 and R 2.1.0
> compiled from sources on this machine:
>
> Fujitsu Siemens CELSIUS V810
> 4 GB RAM
> Dual AMD Opteron Processor 246
> Harddisk via SAN.
>
> (see user details:)
> sysname                         "Linux" <- gentoo linux
> release		"2.6.11-hardened-r13"                               version "#1 SMP Fri
> May 27 15:25:55 CEST 2005"                               machine 				"x86_64"
>
> Editor: Emacs with ESS 5.2.3
>
>
> While I can connect R to the database (RMySQL/DBI) and retrieve basic
> information (e.g. SHOW TABLE, DESCRIBE) it is not possible to send SQL Queries.
> The moment I try to do: res <- dbSendQuery(con, "select * from table") or any
> other SELECT statement R terminates and I receive a Segmentation Fault.

Please use gdb to trace where the fault is occurring: my guess is in 
RMySQL.so, in which case this is best discussed with the package 
maintainer (see the R FAQ, section on BUGS).

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From murdoch at stats.uwo.ca  Mon Jun  6 22:08:20 2005
From: murdoch at stats.uwo.ca (murdoch@stats.uwo.ca)
Date: Mon Jun  6 22:08:30 2005
Subject: [Rd] Bug in new() or validObject() in methods package (PR#7922)
Message-ID: <20050606200820.068F0A1C3@slim.kubism.ku.dk>

Something in new() or validObject() in the methods package is messing 
up.  This happens in both 2.1.0 and R-devel in Windows.


I'd like to have an empty expression for a slot in a class.  An empty
expression is an expression:

 > is.expression(expression())
[1] TRUE
 >
 > is(expression(), "expression")
[1] TRUE
 > class(expression())
[1] "expression"


However, when I try to use this as the initial value, I get an error
thrown back at me:

 > setClass("foo", representation(bar = "expression"))
[1] "foo"
 >
 > new("foo", bar = expression())
Error in validObject(.Object) : invalid class "foo" object: invalid 
object for slot "bar" in class "foo": got class "NULL", should be or 
extend class "expression"

Is it doing an extra eval or something?  It looks like it:

 > x <- expression()
 > x
expression()
 > eval(x)
NULL
 >
 > x <- quote(expression())
 > x
expression()
 > eval(x)
expression()
 > eval(eval(x))
NULL

However, it doesn't always happen:

 > new("foo", bar = expression(1+1))
An object of class "foo"
Slot "bar":
expression(1 + 1)

 > x <- expression(1+1)
 > x
expression(1 + 1)
 > eval(x)
[1] 2

Duncan Murdoch

From p.dalgaard at biostat.ku.dk  Mon Jun  6 22:55:16 2005
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Mon Jun  6 22:55:24 2005
Subject: [Rd] Bug in new() or validObject() in methods package (PR#7922)
In-Reply-To: <20050606200820.068F0A1C3@slim.kubism.ku.dk>
References: <20050606200820.068F0A1C3@slim.kubism.ku.dk>
Message-ID: <x2is0r8atn.fsf@turmalin.kubism.ku.dk>

murdoch@stats.uwo.ca writes:

> Is it doing an extra eval or something?  It looks like it:
> 
>  > x <- expression()
>  > x
> expression()
>  > eval(x)
> NULL
>  >
>  > x <- quote(expression())
>  > x
> expression()
>  > eval(x)
> expression()
>  > eval(eval(x))
> NULL

You do realize that the two expression() results are not identical:

> x <- quote(expression())
> class(x)
[1] "call"
> x <- expression()
> class(x)
[1] "expression"

Not that I can fathom what bearing that has on the real problem...

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

From murdoch at stats.uwo.ca  Mon Jun  6 22:57:37 2005
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Mon Jun  6 22:59:49 2005
Subject: [Rd] Bug in new() or validObject() in methods package (PR#7922)
In-Reply-To: <x2is0r8atn.fsf@turmalin.kubism.ku.dk>
References: <20050606200820.068F0A1C3@slim.kubism.ku.dk>
	<x2is0r8atn.fsf@turmalin.kubism.ku.dk>
Message-ID: <42A4B8C1.7060500@stats.uwo.ca>

On 6/6/2005 4:55 PM, Peter Dalgaard wrote:
> murdoch@stats.uwo.ca writes:
> 
>> Is it doing an extra eval or something?  It looks like it:
>> 
>>  > x <- expression()
>>  > x
>> expression()
>>  > eval(x)
>> NULL
>>  >
>>  > x <- quote(expression())
>>  > x
>> expression()
>>  > eval(x)
>> expression()
>>  > eval(eval(x))
>> NULL
> 
> You do realize that the two expression() results are not identical:
> 
>> x <- quote(expression())
>> class(x)
> [1] "call"
>> x <- expression()
>> class(x)
> [1] "expression"
> 
> Not that I can fathom what bearing that has on the real problem...

I figured they weren't identical, given that they gave different results 
  when eval'd, but I didn't know what the difference was exactly.  Thanks!

Duncan

From Robert.McGehee at geodecapital.com  Mon Jun  6 23:30:30 2005
From: Robert.McGehee at geodecapital.com (McGehee, Robert)
Date: Mon Jun  6 23:30:41 2005
Subject: [Rd] Bug in new() or validObject() in methods package (PR#7922)
Message-ID: <67DCA285A2D7754280D3B8E88EB548020C9465EB@MSGBOSCLB2WIN.DMN1.FMR.COM>

The bug might be here:
> is.null(expression())
[1] TRUE

But
> is.null(expression(NULL))
[1] FALSE

So it might look to the methods package like you're passing in a NULL
value for @bar. I might argue that expression() should not be NULL (and
only NULL is NULL) as I have had similar trouble trying to extend
language objects to S4 classes, partially because length 0 name, call
and expression objects are either not available, or in this case,
handled poorly.

Robert

-----Original Message-----
From: Duncan Murdoch [mailto:murdoch@stats.uwo.ca] 
Sent: Monday, June 06, 2005 4:58 PM
To: Peter Dalgaard
Cc: r-devel@stat.math.ethz.ch
Subject: Re: [Rd] Bug in new() or validObject() in methods package
(PR#7922)


On 6/6/2005 4:55 PM, Peter Dalgaard wrote:
> murdoch@stats.uwo.ca writes:
> 
>> Is it doing an extra eval or something?  It looks like it:
>> 
>>  > x <- expression()
>>  > x
>> expression()
>>  > eval(x)
>> NULL
>>  >
>>  > x <- quote(expression())
>>  > x
>> expression()
>>  > eval(x)
>> expression()
>>  > eval(eval(x))
>> NULL
> 
> You do realize that the two expression() results are not identical:
> 
>> x <- quote(expression())
>> class(x)
> [1] "call"
>> x <- expression()
>> class(x)
> [1] "expression"
> 
> Not that I can fathom what bearing that has on the real problem...

I figured they weren't identical, given that they gave different results

  when eval'd, but I didn't know what the difference was exactly.
Thanks!

Duncan

______________________________________________
R-devel@stat.math.ethz.ch mailing list
https://stat.ethz.ch/mailman/listinfo/r-devel

From p.murrell at auckland.ac.nz  Tue Jun  7 00:47:34 2005
From: p.murrell at auckland.ac.nz (Paul Murrell)
Date: Tue Jun  7 00:47:35 2005
Subject: [Rd] Re: [R] Problem going back to a viewport with gridBase
References: <971536df05053020191ebe8f44@mail.gmail.com>	
	<429CEA59.7020206@stat.auckland.ac.nz>	
	<971536df050531163353031d97@mail.gmail.com>	
	<429CFA42.4080106@stat.auckland.ac.nz>	
	<971536df05053118215366e02c@mail.gmail.com>	
	<429E5BFD.9080508@stat.auckland.ac.nz>	
	<971536df050602140356cc80b4@mail.gmail.com>	
	<429FB4AE.5030105@stat.auckland.ac.nz>
	<971536df0506030554396c2374@mail.gmail.com>
Message-ID: <42A4D286.5090208@stat.auckland.ac.nz>

Hi


Gabor Grothendieck wrote:
> On 6/2/05, Paul Murrell <p.murrell@auckland.ac.nz> wrote:
> 
>>Hi
> 
> 
> Thanks.  I have mucked around in vpTree structures and discovered its
> actually quite easy to specify children so I have changed my example
> so that instead of naming the children of 'layout' and then remembering 
> coordinates linked to the names of the children of 'layout' in 
> the 'coords' structure (which really just duplicates state information
> already available in grid) it simply follows the order
> of the children of 'layout' directly.  This permits elimination of 'coords' 
> and the two naming functions.  Using the depth approach you advocate,
> 'with' also becomes shorter and I think I have it to the point where it works 
> with both vpPath and viewport classes.  Once Deepayan implements 
> the use.viewport= argument to print, 'with' can be eliminated too.  No 
> questions this time but I thought I would post the latest version for
> completeness. Regards.


Ok.  I can see this working ... for now.  The disadvantage with this 
approach is that it makes use of the undocumented, internal structure of 
a viewport tree to grab a list of child viewports.  A worse example of 
the same thing is that the with() methods make use of a happy 
coincidence that both viewport objects and viewport path objects share a 
component called "name" (and an even happier coincidence that they 
contain the same information).  I think it would be cleaner and better 
practice, despite requiring longer code, to make use of the documented 
interface which requires specifying viewport names and viewport paths.
The internal structure of objects is not guaranteed to be stable.

Paul


> [pushLayout is same as before except there are no names on the
> children of 'layout' and the rest is new]
> 
> library(grid)
> library(lattice)
> 
> pushLayout <- function(nr, nc, name="layout") {
>   pushViewport(viewport(layout=grid.layout(nr, nc), name=name))
>   for (i in 1:nr) {
>     for (j in 1:nc) {
>       pushViewport(viewport(layout.pos.row=i, layout.pos.col=j))
>       upViewport()
>     }
>   }
>   upViewport()
> }
> 
> with.vpPath <- with.viewport <- function(data, expr, ...) {
>       # if data is a vpPath it cannot be ROOT since NULL will never
> dispatch here
>       depth <- if (data$name == "ROOT") 0 else downViewport(data$name)
>       result <- eval.parent(substitute(expr))
>       upViewport(depth)
>       invisible(result)
> }
> 
> grid.newpage()
> 
> # specify number of cells to fill and number of rows
> n <- 5; nr <- 3
> 
> nc <- ceiling(n/nr)
> downViewport(pushLayout(nr, nc))
> 
> vpt <- current.vpTree(all = FALSE)
> for(k in 1:n) with(vpt$children[[k]],
>       print( xyplot(v ~ v, list(v = 1:k)), newpage = FALSE )
> )


-- 
Dr Paul Murrell
Department of Statistics
The University of Auckland
Private Bag 92019
Auckland
New Zealand
64 9 3737599 x85392
paul@stat.auckland.ac.nz
http://www.stat.auckland.ac.nz/~paul/

From ggrothendieck at gmail.com  Tue Jun  7 04:24:26 2005
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Tue Jun  7 04:25:33 2005
Subject: [Rd] Re: [R] Problem going back to a viewport with gridBase
In-Reply-To: <42A4D286.5090208@stat.auckland.ac.nz>
References: <971536df05053020191ebe8f44@mail.gmail.com>
	<429CEA59.7020206@stat.auckland.ac.nz>
	<971536df050531163353031d97@mail.gmail.com>
	<429CFA42.4080106@stat.auckland.ac.nz>
	<971536df05053118215366e02c@mail.gmail.com>
	<429E5BFD.9080508@stat.auckland.ac.nz>
	<971536df050602140356cc80b4@mail.gmail.com>
	<429FB4AE.5030105@stat.auckland.ac.nz>
	<971536df0506030554396c2374@mail.gmail.com>
	<42A4D286.5090208@stat.auckland.ac.nz>
Message-ID: <971536df0506061924438870f0@mail.gmail.com>

On 6/6/05, Paul Murrell <p.murrell@auckland.ac.nz> wrote:
> Hi
> 
> 
> Gabor Grothendieck wrote:
> > On 6/2/05, Paul Murrell <p.murrell@auckland.ac.nz> wrote:
> >
> >>Hi
> >
> >
> > Thanks.  I have mucked around in vpTree structures and discovered its
> > actually quite easy to specify children so I have changed my example
> > so that instead of naming the children of 'layout' and then remembering
> > coordinates linked to the names of the children of 'layout' in
> > the 'coords' structure (which really just duplicates state information
> > already available in grid) it simply follows the order
> > of the children of 'layout' directly.  This permits elimination of 'coords'
> > and the two naming functions.  Using the depth approach you advocate,
> > 'with' also becomes shorter and I think I have it to the point where it works
> > with both vpPath and viewport classes.  Once Deepayan implements
> > the use.viewport= argument to print, 'with' can be eliminated too.  No
> > questions this time but I thought I would post the latest version for
> > completeness. Regards.
> 
> 
> Ok.  I can see this working ... for now.  The disadvantage with this
> approach is that it makes use of the undocumented, internal structure of
> a viewport tree to grab a list of child viewports.  A worse example of
> the same thing is that the with() methods make use of a happy
> coincidence that both viewport objects and viewport path objects share a
> component called "name" (and an even happier coincidence that they
> contain the same information).  I think it would be cleaner and better
> practice, despite requiring longer code, to make use of the documented
> interface which requires specifying viewport names and viewport paths.
> The internal structure of objects is not guaranteed to be stable.

Perhaps accessor functions could be provided that allow one to 
retrieve the name of a viewport and the name of a vpPath in 
a safe way.  These could be as simple as:

names.viewport <- names.vpPath <- function(x) x$name

Similarly an accessor function to safely retrieve the children would 
be nice.    Again, it should ideally be possible to
have a generic with methods for various grid classes.

Then the  relevant line in the code concerning name
could be written in a safe way like this:

depth <- if (data$name == "ROOT") 0 else downViewport(names(data))

and similarly for the children.


> 
> Paul
> 
> 
> > [pushLayout is same as before except there are no names on the
> > children of 'layout' and the rest is new]
> >
> > library(grid)
> > library(lattice)
> >
> > pushLayout <- function(nr, nc, name="layout") {
> >   pushViewport(viewport(layout=grid.layout(nr, nc), name=name))
> >   for (i in 1:nr) {
> >     for (j in 1:nc) {
> >       pushViewport(viewport(layout.pos.row=i, layout.pos.col=j))
> >       upViewport()
> >     }
> >   }
> >   upViewport()
> > }
> >
> > with.vpPath <- with.viewport <- function(data, expr, ...) {
> >       # if data is a vpPath it cannot be ROOT since NULL will never
> > dispatch here
> >       depth <- if (data$name == "ROOT") 0 else downViewport(data$name)
> >       result <- eval.parent(substitute(expr))
> >       upViewport(depth)
> >       invisible(result)
> > }
> >
> > grid.newpage()
> >
> > # specify number of cells to fill and number of rows
> > n <- 5; nr <- 3
> >
> > nc <- ceiling(n/nr)
> > downViewport(pushLayout(nr, nc))
> >
> > vpt <- current.vpTree(all = FALSE)
> > for(k in 1:n) with(vpt$children[[k]],
> >       print( xyplot(v ~ v, list(v = 1:k)), newpage = FALSE )
> > )
> 
> 
> --
> Dr Paul Murrell
> Department of Statistics
> The University of Auckland
> Private Bag 92019
> Auckland
> New Zealand
> 64 9 3737599 x85392
> paul@stat.auckland.ac.nz
> http://www.stat.auckland.ac.nz/~paul/
> 
>

From ggrothendieck at gmail.com  Tue Jun  7 05:12:55 2005
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Tue Jun  7 05:13:44 2005
Subject: [Rd] update.packages keeps trying to update gregmisc
Message-ID: <971536df05060620123784bd5c@mail.gmail.com>

If I issue the command 
> update.packages() 
it wants to update 'gregmisc' but then if I do it again right afterwards it 
still wants to update 'gregmisc'.  It should have updated everything
the first time and should not be trying to update anything the second
time.  Any comments?

Here is the transcript of a session (R version at end):


> update.packages()
gregmisc :
 Version 2.0.7 installed in C:/PROGRA~1/R/RW2010~1/library 
 Version 2.0.8 available at http://probability.ca/cran
Update (y/N/c)?  y
trying URL 'http://probability.ca/cran/bin/windows/contrib/2.1/gregmisc_2.0.8.zip'
Content type 'application/zip' length 2465 bytes
opened URL
downloaded 2465 bytes

package 'gregmisc' successfully unpacked and MD5 sums checked

The downloaded packages are in
        C:\Documents and Settings\Grothendieck\Local
Settings\Temp\Rtmp9430\downloaded_packages
updating HTML package descriptions
> update.packages()
gregmisc :
 Version 2.0.7 installed in C:/PROGRA~1/R/RW2010~1/library 
 Version 2.0.8 available at http://probability.ca/cran
Update (y/N/c)?  y
trying URL 'http://probability.ca/cran/bin/windows/contrib/2.1/gregmisc_2.0.8.zip'
Content type 'application/zip' length 2465 bytes
opened URL
downloaded 2465 bytes

package 'gregmisc' successfully unpacked and MD5 sums checked

The downloaded packages are in
        C:\Documents and Settings\Grothendieck\Local
Settings\Temp\Rtmp9430\downloaded_packages
updating HTML package descriptions
> R.version.string # Windows XP
[1] "R version 2.1.0, 2005-05-14"

From ggrothendieck at gmail.com  Tue Jun  7 07:35:05 2005
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Tue Jun  7 07:36:25 2005
Subject: [Rd] Re: update.packages keeps trying to update gregmisc
In-Reply-To: <971536df05060620123784bd5c@mail.gmail.com>
References: <971536df05060620123784bd5c@mail.gmail.com>
Message-ID: <971536df0506062235585d5d8c@mail.gmail.com>

One other point I just noticed.  If I run new.packages() it reports this,
namely that gregmisc has extra contents of NA.

> np <- new.packages()
--- Please select a CRAN mirror for use in this session ---
Warning messages:
1: bundle 'VR' is incompletely installed in: new.packages() 
2: bundle 'VR' has extra contents 'nnet' in: new.packages() 
3: bundle 'gregmisc' is incompletely installed in: new.packages() 
4: bundle 'gregmisc' has extra contents 'NA' in: new.packages() 

On 6/6/05, Gabor Grothendieck <ggrothendieck@gmail.com> wrote:
> If I issue the command
> > update.packages()
> it wants to update 'gregmisc' but then if I do it again right afterwards it
> still wants to update 'gregmisc'.  It should have updated everything
> the first time and should not be trying to update anything the second
> time.  Any comments?
> 
> Here is the transcript of a session (R version at end):
> 
> 
> > update.packages()
> gregmisc :
>  Version 2.0.7 installed in C:/PROGRA~1/R/RW2010~1/library
>  Version 2.0.8 available at http://probability.ca/cran
> Update (y/N/c)?  y
> trying URL 'http://probability.ca/cran/bin/windows/contrib/2.1/gregmisc_2.0.8.zip'
> Content type 'application/zip' length 2465 bytes
> opened URL
> downloaded 2465 bytes
> 
> package 'gregmisc' successfully unpacked and MD5 sums checked
> 
> The downloaded packages are in
>        C:\Documents and Settings\Grothendieck\Local
> Settings\Temp\Rtmp9430\downloaded_packages
> updating HTML package descriptions
> > update.packages()
> gregmisc :
>  Version 2.0.7 installed in C:/PROGRA~1/R/RW2010~1/library
>  Version 2.0.8 available at http://probability.ca/cran
> Update (y/N/c)?  y
> trying URL 'http://probability.ca/cran/bin/windows/contrib/2.1/gregmisc_2.0.8.zip'
> Content type 'application/zip' length 2465 bytes
> opened URL
> downloaded 2465 bytes
> 
> package 'gregmisc' successfully unpacked and MD5 sums checked
> 
> The downloaded packages are in
>        C:\Documents and Settings\Grothendieck\Local
> Settings\Temp\Rtmp9430\downloaded_packages
> updating HTML package descriptions
> > R.version.string # Windows XP
> [1] "R version 2.1.0, 2005-05-14"
>

From ripley at stats.ox.ac.uk  Tue Jun  7 08:51:39 2005
From: ripley at stats.ox.ac.uk (Brian D Ripley)
Date: Tue Jun  7 08:51:52 2005
Subject: [Rd] Re: update.packages keeps trying to update gregmisc
In-Reply-To: <971536df0506062235585d5d8c@mail.gmail.com>
Message-ID: <Pine.GSO.4.31.0506070746130.5981-100000@markov.stats>

This is due to the inconsistent way gregmisc has been unbundled.  There
was a gregmisc 2.0-7 containing gplots etc as part of a bundle, and there
are also versions of gplots etc *with the same version number* which are
not part of a bundle.

The only way out I have found is to remove gregmisc and, if necessary, its
former component packages, and then re-install gplots etc.

On Tue, 7 Jun 2005, Gabor Grothendieck wrote:

> One other point I just noticed.  If I run new.packages() it reports this,
> namely that gregmisc has extra contents of NA.
>
> > np <- new.packages()
> --- Please select a CRAN mirror for use in this session ---
> Warning messages:
> 1: bundle 'VR' is incompletely installed in: new.packages()
> 2: bundle 'VR' has extra contents 'nnet' in: new.packages()
> 3: bundle 'gregmisc' is incompletely installed in: new.packages()
> 4: bundle 'gregmisc' has extra contents 'NA' in: new.packages()
>
> On 6/6/05, Gabor Grothendieck <ggrothendieck@gmail.com> wrote:
> > If I issue the command
> > > update.packages()
> > it wants to update 'gregmisc' but then if I do it again right afterwards it
> > still wants to update 'gregmisc'.  It should have updated everything
> > the first time and should not be trying to update anything the second
> > time.  Any comments?
> >
> > Here is the transcript of a session (R version at end):
> >
> >
> > > update.packages()
> > gregmisc :
> >  Version 2.0.7 installed in C:/PROGRA~1/R/RW2010~1/library
> >  Version 2.0.8 available at http://probability.ca/cran
> > Update (y/N/c)?  y
> > trying URL 'http://probability.ca/cran/bin/windows/contrib/2.1/gregmisc_2.0.8.zip'
> > Content type 'application/zip' length 2465 bytes
> > opened URL
> > downloaded 2465 bytes
> >
> > package 'gregmisc' successfully unpacked and MD5 sums checked
> >
> > The downloaded packages are in
> >        C:\Documents and Settings\Grothendieck\Local
> > Settings\Temp\Rtmp9430\downloaded_packages
> > updating HTML package descriptions
> > > update.packages()
> > gregmisc :
> >  Version 2.0.7 installed in C:/PROGRA~1/R/RW2010~1/library
> >  Version 2.0.8 available at http://probability.ca/cran
> > Update (y/N/c)?  y
> > trying URL 'http://probability.ca/cran/bin/windows/contrib/2.1/gregmisc_2.0.8.zip'
> > Content type 'application/zip' length 2465 bytes
> > opened URL
> > downloaded 2465 bytes
> >
> > package 'gregmisc' successfully unpacked and MD5 sums checked
> >
> > The downloaded packages are in
> >        C:\Documents and Settings\Grothendieck\Local
> > Settings\Temp\Rtmp9430\downloaded_packages
> > updating HTML package descriptions
> > > R.version.string # Windows XP
> > [1] "R version 2.1.0, 2005-05-14"
> >
>
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From hb at maths.lth.se  Tue Jun  7 13:05:01 2005
From: hb at maths.lth.se (Henrik Bengtsson)
Date: Tue Jun  7 13:05:06 2005
Subject: [Rd] Suggestion: help(<package name>)
Message-ID: <42A57F5D.7080505@maths.lth.se>

Hi,

I would like to suggest a standard where all packages provide an Rd page 
with the same name (or aliased) as the name of package so that 
help(<package name>) or ?<package name> is always here. This especially 
of interest to large packages with a large package index. This page 
could explain the package in general and gives some hints on how to 
start - not like extensive vignettes, but just to get started, e.g. list 
the "most important" functions.  This page could typically contain 
information that is in the DESCRIPTION file (which contains valuable 
information hardly every accessed by a general user), such as who is the 
maintainer, how to report bugs and so on.

If you think the above is a good idea, then, would it even be useful to 
enforce the existance of such a Rd page in R CMD check?

Henrik Bengtsson

From Kurt.Hornik at wu-wien.ac.at  Tue Jun  7 13:10:42 2005
From: Kurt.Hornik at wu-wien.ac.at (Kurt Hornik)
Date: Tue Jun  7 13:10:56 2005
Subject: [Rd] Suggestion: help(<package name>)
In-Reply-To: <42A57F5D.7080505@maths.lth.se>
References: <42A57F5D.7080505@maths.lth.se>
Message-ID: <17061.32946.976628.961120@beren.wu-wien.ac.at>

>>>>> Henrik Bengtsson writes:

> Hi,
> I would like to suggest a standard where all packages provide an Rd page 
> with the same name (or aliased) as the name of package so that 
> help(<package name>) or ?<package name> is always here. This especially 
> of interest to large packages with a large package index. This page 
> could explain the package in general and gives some hints on how to 
> start - not like extensive vignettes, but just to get started, e.g. list 
> the "most important" functions.  This page could typically contain 
> information that is in the DESCRIPTION file (which contains valuable 
> information hardly every accessed by a general user), such as who is the 
> maintainer, how to report bugs and so on.

How would this be different from the results of

	help(package = <package name>)

?

-k

> If you think the above is a good idea, then, would it even be useful to 
> enforce the existance of such a Rd page in R CMD check?

> Henrik Bengtsson

> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

From huber at ebi.ac.uk  Tue Jun  7 13:59:34 2005
From: huber at ebi.ac.uk (Wolfgang Huber)
Date: Tue Jun  7 13:19:24 2005
Subject: [Rd] Suggestion: help(<package name>)
In-Reply-To: <17061.32946.976628.961120@beren.wu-wien.ac.at>
References: <42A57F5D.7080505@maths.lth.se>
	<17061.32946.976628.961120@beren.wu-wien.ac.at>
Message-ID: <42A58C26.2060700@ebi.ac.uk>

>>>>>>Henrik Bengtsson writes:
>>I would like to suggest a standard where all packages provide an Rd page 
>>with the same name (or aliased) as the name of package so that 
>>help(<package name>) or ?<package name> is always here. This especially 
>>of interest to large packages with a large package index. This page 
>>could explain the package in general and gives some hints on how to 
>>start - not like extensive vignettes, but just to get started, e.g. list 
>>the "most important" functions.  

But isn't that just what vignettes are there for?

And I think nobody has said that vignettes should be "extensive", and if 
they end up being so, that is a problem of the package author, and 
probably would end up being the same with yet another form of documentation.

Best regards
   Wolfgang

-------------------------------------
Wolfgang Huber
European Bioinformatics Institute
European Molecular Biology Laboratory
Cambridge CB10 1SD
England
Phone: +44 1223 494642
Fax:   +44 1223 494486
Http:  www.ebi.ac.uk/huber

From hb at maths.lth.se  Tue Jun  7 13:29:32 2005
From: hb at maths.lth.se (Henrik Bengtsson)
Date: Tue Jun  7 13:29:37 2005
Subject: [Rd] Suggestion: help(<package name>)
In-Reply-To: <17061.32946.976628.961120@beren.wu-wien.ac.at>
References: <42A57F5D.7080505@maths.lth.se>
	<17061.32946.976628.961120@beren.wu-wien.ac.at>
Message-ID: <42A5851C.3080102@maths.lth.se>

Kurt Hornik wrote:
>>>>>>Henrik Bengtsson writes:
> 
> 
>>Hi,
>>I would like to suggest a standard where all packages provide an Rd page 
>>with the same name (or aliased) as the name of package so that 
>>help(<package name>) or ?<package name> is always here. This especially 
>>of interest to large packages with a large package index. This page 
>>could explain the package in general and gives some hints on how to 
>>start - not like extensive vignettes, but just to get started, e.g. list 
>>the "most important" functions.  This page could typically contain 
>>information that is in the DESCRIPTION file (which contains valuable 
>>information hardly every accessed by a general user), such as who is the 
>>maintainer, how to report bugs and so on.
> 
> 
> How would this be different from the results of
> 
> 	help(package = <package name>)
> 
> ?

Thanks for that. I was not aware of this one; I like how DESCRIPTION is 
included and how the index is divided in functions and dataset, e.g. 
help(package=MASS). May I also suggest that the CITATION file is 
included here, e.g. help(package=foreign).

My suggestion differ in the sense that 1) additional information may be 
included such as which functions are "main" functions and which are of 
less interest, and 2) that it would show up in the HTML index page too.

An automated solution such as help(package=<name>) is of course easier 
to maintain. Part of Rd files can be generated this way too, but I did 
not want to get too complicated in my suggestions.

/Henrik

> -k
> 
> 
>>If you think the above is a good idea, then, would it even be useful to 
>>enforce the existance of such a Rd page in R CMD check?
> 
> 
>>Henrik Bengtsson
> 
> 
>>______________________________________________
>>R-devel@stat.math.ethz.ch mailing list
>>https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> 
>

From ggrothendieck at gmail.com  Tue Jun  7 13:34:26 2005
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Tue Jun  7 13:34:42 2005
Subject: [Rd] Re: update.packages keeps trying to update gregmisc
In-Reply-To: <Pine.GSO.4.31.0506070746130.5981-100000@markov.stats>
References: <971536df0506062235585d5d8c@mail.gmail.com>
	<Pine.GSO.4.31.0506070746130.5981-100000@markov.stats>
Message-ID: <971536df05060704343381a79c@mail.gmail.com>

That worked!  Thanks.

On 6/7/05, Brian D Ripley <ripley@stats.ox.ac.uk> wrote:
> This is due to the inconsistent way gregmisc has been unbundled.  There
> was a gregmisc 2.0-7 containing gplots etc as part of a bundle, and there
> are also versions of gplots etc *with the same version number* which are
> not part of a bundle.
> 
> The only way out I have found is to remove gregmisc and, if necessary, its
> former component packages, and then re-install gplots etc.
> 
> On Tue, 7 Jun 2005, Gabor Grothendieck wrote:
> 
> > One other point I just noticed.  If I run new.packages() it reports this,
> > namely that gregmisc has extra contents of NA.
> >
> > > np <- new.packages()
> > --- Please select a CRAN mirror for use in this session ---
> > Warning messages:
> > 1: bundle 'VR' is incompletely installed in: new.packages()
> > 2: bundle 'VR' has extra contents 'nnet' in: new.packages()
> > 3: bundle 'gregmisc' is incompletely installed in: new.packages()
> > 4: bundle 'gregmisc' has extra contents 'NA' in: new.packages()
> >
> > On 6/6/05, Gabor Grothendieck <ggrothendieck@gmail.com> wrote:
> > > If I issue the command
> > > > update.packages()
> > > it wants to update 'gregmisc' but then if I do it again right afterwards it
> > > still wants to update 'gregmisc'.  It should have updated everything
> > > the first time and should not be trying to update anything the second
> > > time.  Any comments?
> > >
> > > Here is the transcript of a session (R version at end):
> > >
> > >
> > > > update.packages()
> > > gregmisc :
> > >  Version 2.0.7 installed in C:/PROGRA~1/R/RW2010~1/library
> > >  Version 2.0.8 available at http://probability.ca/cran
> > > Update (y/N/c)?  y
> > > trying URL 'http://probability.ca/cran/bin/windows/contrib/2.1/gregmisc_2.0.8.zip'
> > > Content type 'application/zip' length 2465 bytes
> > > opened URL
> > > downloaded 2465 bytes
> > >
> > > package 'gregmisc' successfully unpacked and MD5 sums checked
> > >
> > > The downloaded packages are in
> > >        C:\Documents and Settings\Grothendieck\Local
> > > Settings\Temp\Rtmp9430\downloaded_packages
> > > updating HTML package descriptions
> > > > update.packages()
> > > gregmisc :
> > >  Version 2.0.7 installed in C:/PROGRA~1/R/RW2010~1/library
> > >  Version 2.0.8 available at http://probability.ca/cran
> > > Update (y/N/c)?  y
> > > trying URL 'http://probability.ca/cran/bin/windows/contrib/2.1/gregmisc_2.0.8.zip'
> > > Content type 'application/zip' length 2465 bytes
> > > opened URL
> > > downloaded 2465 bytes
> > >
> > > package 'gregmisc' successfully unpacked and MD5 sums checked
> > >
> > > The downloaded packages are in
> > >        C:\Documents and Settings\Grothendieck\Local
> > > Settings\Temp\Rtmp9430\downloaded_packages
> > > updating HTML package descriptions
> > > > R.version.string # Windows XP
> > > [1] "R version 2.1.0, 2005-05-14"
> > >
> >
> > ______________________________________________
> > R-devel@stat.math.ethz.ch mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-devel
> >
> 
> --
> Brian D. Ripley,                  ripley@stats.ox.ac.uk
> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> University of Oxford,             Tel:  +44 1865 272861 (self)
> 1 South Parks Road,                     +44 1865 272866 (PA)
> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
> 
>

From hb at maths.lth.se  Tue Jun  7 13:56:07 2005
From: hb at maths.lth.se (Henrik Bengtsson)
Date: Tue Jun  7 13:56:14 2005
Subject: [Rd] Suggestion: help(<package name>)
In-Reply-To: <42A58C26.2060700@ebi.ac.uk>
References: <42A57F5D.7080505@maths.lth.se>
	<17061.32946.976628.961120@beren.wu-wien.ac.at>
	<42A58C26.2060700@ebi.ac.uk>
Message-ID: <42A58B57.8040507@maths.lth.se>

Wolfgang Huber wrote:
>>>>>>> Henrik Bengtsson writes:
>>>
>>> I would like to suggest a standard where all packages provide an Rd 
>>> page with the same name (or aliased) as the name of package so that 
>>> help(<package name>) or ?<package name> is always here. This 
>>> especially of interest to large packages with a large package index. 
>>> This page could explain the package in general and gives some hints 
>>> on how to start - not like extensive vignettes, but just to get 
>>> started, e.g. list the "most important" functions.  
> 
> 
> But isn't that just what vignettes are there for?
> 
> And I think nobody has said that vignettes should be "extensive", and if 
> they end up being so, that is a problem of the package author, and 
> probably would end up being the same with yet another form of 
> documentation.


Yes, and you could call what I am suggestion a special type of 
"vignette".  But, I was more thinking of a very very short description 
page which is extremely easy to access and easy to write (I shouldn't 
have said "not like extensive vignettes" then, but rather "like 
extremely short vignettes").  Writing vignettes are easy, but apparently 
still not easy enough because not all packages have a vignette.  Also, 
it is hard to compete with the command ?<pkgname> when it comes to 
access and response time, especially if the vignette is a PDF file but 
even if it is a HTML page.  Also, an Rd file will be included in both 
the HTML help and the LaTeX manual.

If there would be a "standardized" main document page, which I think 
?<pkgname> is, but which could also apply vignette(<pkgname>), a new 
user would immediately know where to get the necessary information if 
running into problems or just want to try out a new package, e.g. 
install.packages("R.oo"), then library(R.oo) and ?R.oo (much on the 
shown page is automatically generated from DESCRIPTION files etc, but I 
did not want to suggest that because that requires much more).

Cheers

Henrik

> Best regards
>   Wolfgang
> 
> -------------------------------------
> Wolfgang Huber
> European Bioinformatics Institute
> European Molecular Biology Laboratory
> Cambridge CB10 1SD
> England
> Phone: +44 1223 494642
> Fax:   +44 1223 494486
> Http:  www.ebi.ac.uk/huber
> -------------------------------------
> 
>

From murdoch at stats.uwo.ca  Tue Jun  7 14:11:11 2005
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Tue Jun  7 14:11:17 2005
Subject: [Rd] Suggestion: help(<package name>)
In-Reply-To: <17061.32946.976628.961120@beren.wu-wien.ac.at>
References: <42A57F5D.7080505@maths.lth.se>
	<17061.32946.976628.961120@beren.wu-wien.ac.at>
Message-ID: <42A58EDF.80701@stats.uwo.ca>

Kurt Hornik wrote:
>>>>>>Henrik Bengtsson writes:
> 
> 
>>Hi,
>>I would like to suggest a standard where all packages provide an Rd page 
>>with the same name (or aliased) as the name of package so that 
>>help(<package name>) or ?<package name> is always here. This especially 
>>of interest to large packages with a large package index. This page 
>>could explain the package in general and gives some hints on how to 
>>start - not like extensive vignettes, but just to get started, e.g. list 
>>the "most important" functions.  This page could typically contain 
>>information that is in the DESCRIPTION file (which contains valuable 
>>information hardly every accessed by a general user), such as who is the 
>>maintainer, how to report bugs and so on.

I think this is a good idea.  One minor problem is that for some 
packages that topic name is already in use for a function (e.g. boot). 
For that reason, I'd suggest that there *also* be an alias called 
"package.<package name>", and the <package name> topic should link to it.
> 
> How would this be different from the results of
> 
> 	help(package = <package name>)
> 
> ?


1.  It would work with ?, like other help topics.

2.  It would give an overview.  It's possible to do that in DESCRIPTION 
or INDEX, but you don't get the same style as for other help files (e.g. 
no links to other topics, at least in Windows).



We should work out what the topic headings should be and extend 
package.skeleton() and prompt() to write a bare-bones file that suggests 
the questions that need to be answered in the file.  The headings I'd 
suggest are:

\name
\title
\alias
\description (longer than the typical entry in the DESCRIPTION file)
\details (Should give a short guide to the main functions, should point 
out the existence of external documentation like vignettes, etc.)
\author (could also describe maintainer, if different)
\references
\seealso (Should give references to related packages)
\examples
\keywords

There is some duplication of material from DESCRIPTION, but usually this 
should be longer and more reader-friendly than that file.

I'd be happy to write the description of this in R Extensions, and write 
the changes to prompt(), if we have agreement that this file should be 
mandatory in 2.2.x or 2.3.x, and you'll write the checks for it.  (I 
think the check should just be for existence of aliases <package name> 
and package.<package name>, and could perhaps just give a warning in 
2.2.x.)

Duncan Murdoch

From ggrothendieck at gmail.com  Tue Jun  7 14:29:31 2005
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Tue Jun  7 14:30:10 2005
Subject: [Rd] Suggestion: help(<package name>)
In-Reply-To: <42A57F5D.7080505@maths.lth.se>
References: <42A57F5D.7080505@maths.lth.se>
Message-ID: <971536df05060705292c7b0e21@mail.gmail.com>

On 6/7/05, Henrik Bengtsson <hb@maths.lth.se> wrote:
> Hi,
> 
> I would like to suggest a standard where all packages provide an Rd page
> with the same name (or aliased) as the name of package so that
> help(<package name>) or ?<package name> is always here. This especially
> of interest to large packages with a large package index. This page
> could explain the package in general and gives some hints on how to
> start - not like extensive vignettes, but just to get started, e.g. list
> the "most important" functions.  This page could typically contain
> information that is in the DESCRIPTION file (which contains valuable
> information hardly every accessed by a general user), such as who is the
> maintainer, how to report bugs and so on.
> 
> If you think the above is a good idea, then, would it even be useful to
> enforce the existance of such a Rd page in R CMD check?

The basic idea of having a short overview seems good but
the particular suggestion of using ?packagename would
seem to collide with already existing .Rd files as
many packages are named after their constructor, e.g. the zoo
package.

From r.hankin at noc.soton.ac.uk  Tue Jun  7 14:35:54 2005
From: r.hankin at noc.soton.ac.uk (Robin Hankin)
Date: Tue Jun  7 14:34:12 2005
Subject: [Rd] Suggestion: help(<package name>)
In-Reply-To: <42A58EDF.80701@stats.uwo.ca>
References: <42A57F5D.7080505@maths.lth.se>
	<17061.32946.976628.961120@beren.wu-wien.ac.at>
	<42A58EDF.80701@stats.uwo.ca>
Message-ID: <1f269abbabca01e19ee3cdbabc9d14f6@soc.soton.ac.uk>

My 0.02:

I use Misc.Rd for the purpose that Duncan suggests.  I put things like 
details and rationale for package
organization, pointers to the most important function(s) in the 
package,  and perhaps function descriptors
for ubiquitous functions that don't warrant their own helppage, but 
need documentation [in
the case of gsl, this would be strictify() and process.args(), which 
every user needs to know].

It would be *great* to be required to put in "package.gsl.R"  (or 
should that be "gsl.package.Rd"?)
for this purpose.  Then maybe R CMD check could check for its presence 
and throw a wobbly
if it isn't there.

Some packages have so  much material that it's difficult to know where 
the "meat" of the functionality lies,
and Duncan's suggestion would help greatly in these circumstances.

best wishes

rksh


On Jun 7, 2005, at 01:11 pm, Duncan Murdoch wrote:

> Kurt Hornik wrote:
>>>>>>> Henrik Bengtsson writes:
>>> Hi,
>>> I would like to suggest a standard where all packages provide an Rd 
>>> page with the same name (or aliased) as the name of package so that 
>>> help(<package name>) or ?<package name> is always here. This 
>>> especially of interest to large packages with a large package index. 
>>> This page could explain the package in general and gives some hints 
>>> on how to start - not like extensive vignettes, but just to get 
>>> started, e.g. list the "most important" functions.  This page could 
>>> typically contain information that is in the DESCRIPTION file (which 
>>> contains valuable information hardly every accessed by a general 
>>> user), such as who is the maintainer, how to report bugs and so on.
>
> I think this is a good idea.  One minor problem is that for some 
> packages that topic name is already in use for a function (e.g. boot). 
> For that reason, I'd suggest that there *also* be an alias called 
> "package.<package name>", and the <package name> topic should link to 
> it.
>> How would this be different from the results of
>> 	help(package = <package name>)
>> ?
>
>
> 1.  It would work with ?, like other help topics.
>
> 2.  It would give an overview.  It's possible to do that in 
> DESCRIPTION or INDEX, but you don't get the same style as for other 
> help files (e.g. no links to other topics, at least in Windows).
>
>
>
> We should work out what the topic headings should be and extend 
> package.skeleton() and prompt() to write a bare-bones file that 
> suggests the questions that need to be answered in the file.  The 
> headings I'd suggest are:
>
> \name
> \title
> \alias
> \description (longer than the typical entry in the DESCRIPTION file)
> \details (Should give a short guide to the main functions, should 
> point out the existence of external documentation like vignettes, 
> etc.)
> \author (could also describe maintainer, if different)
> \references
> \seealso (Should give references to related packages)
> \examples
> \keywords
>
> There is some duplication of material from DESCRIPTION, but usually 
> this should be longer and more reader-friendly than that file.
>
> I'd be happy to write the description of this in R Extensions, and 
> write the changes to prompt(), if we have agreement that this file 
> should be mandatory in 2.2.x or 2.3.x, and you'll write the checks for 
> it.  (I think the check should just be for existence of aliases 
> <package name> and package.<package name>, and could perhaps just give 
> a warning in 2.2.x.)
>
> Duncan Murdoch
>
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>
--
Robin Hankin
Uncertainty Analyst
National Oceanography Centre, Southampton
European Way, Southampton SO14 3ZH, UK
  tel  023-8059-7743

From murdoch at stats.uwo.ca  Tue Jun  7 14:35:21 2005
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Tue Jun  7 14:35:47 2005
Subject: [Rd] Bug in new() or validObject() in methods package (PR#7922)
In-Reply-To: <67DCA285A2D7754280D3B8E88EB548020C9465EB@MSGBOSCLB2WIN.DMN1.FMR.COM>
References: <67DCA285A2D7754280D3B8E88EB548020C9465EB@MSGBOSCLB2WIN.DMN1.FMR.COM>
Message-ID: <42A59489.3010905@stats.uwo.ca>

McGehee, Robert wrote:
> The bug might be here:
> 
>>is.null(expression())
> 
> [1] TRUE
> 
> But
> 
>>is.null(expression(NULL))
> 
> [1] FALSE
> 
> So it might look to the methods package like you're passing in a NULL
> value for @bar. I might argue that expression() should not be NULL (and
> only NULL is NULL) as I have had similar trouble trying to extend
> language objects to S4 classes, partially because length 0 name, call
> and expression objects are either not available, or in this case,
> handled poorly.

I think you've spotted it.  The internal code for is.null checks for 
NULL or a zero length expression, not just for NULL.  Changing that so 
it only accepts NULL fixes this bug.

This code has been in place since prehistoric times, so I'm going to 
tread pretty carefully here before I commit a change.

Duncan Murdoch

From tlumley at u.washington.edu  Tue Jun  7 16:18:31 2005
From: tlumley at u.washington.edu (Thomas Lumley)
Date: Tue Jun  7 16:18:48 2005
Subject: [Rd] Suggestion: help(<package name>)
In-Reply-To: <42A5851C.3080102@maths.lth.se>
References: <42A57F5D.7080505@maths.lth.se>
	<17061.32946.976628.961120@beren.wu-wien.ac.at>
	<42A5851C.3080102@maths.lth.se>
Message-ID: <Pine.A41.4.61b.0506070712110.228936@homer05.u.washington.edu>

On Tue, 7 Jun 2005, Henrik Bengtsson wrote:

> Kurt Hornik wrote:
>> 
>> How would this be different from the results of
>> 
>> 	help(package = <package name>)
>> 
>> ?
>
> Thanks for that. I was not aware of this one; I like how DESCRIPTION is 
> included and how the index is divided in functions and dataset, e.g. 
> help(package=MASS). May I also suggest that the CITATION file is included 
> here, e.g. help(package=foreign).
>
> My suggestion differ in the sense that 1) additional information may be 
> included such as which functions are "main" functions and which are of less 
> interest, and 2) that it would show up in the HTML index page too.
>

For point (1) you can write your own INDEX file, in which case it can have 
more information than the auto-generated one.  A simple example is the 
survey package.  My description of the INDEX file in courses has been that 
it contains a line for every "sufficiently interesting" function. Writing 
R Extensions says that "normally this file is missing" but I think this is 
descriptive rather than prescriptive.

2) seems sensible.  The INDEX file is included in the CRAN page and I find 
it useful there.


 	-thomas

From rgentlem at fhcrc.org  Tue Jun  7 17:12:43 2005
From: rgentlem at fhcrc.org (Robert Gentleman)
Date: Tue Jun  7 17:13:09 2005
Subject: [Rd] Suggestion: help(<package name>)
In-Reply-To: <1f269abbabca01e19ee3cdbabc9d14f6@soc.soton.ac.uk>
References: <42A57F5D.7080505@maths.lth.se>	<17061.32946.976628.961120@beren.wu-wien.ac.at>	<42A58EDF.80701@stats.uwo.ca>
	<1f269abbabca01e19ee3cdbabc9d14f6@soc.soton.ac.uk>
Message-ID: <42A5B96B.9030701@fhcrc.org>



Robin Hankin wrote:
> My 0.02:
> 
> I use Misc.Rd for the purpose that Duncan suggests.  I put things like 
> details and rationale for package
> organization, pointers to the most important function(s) in the 
> package,  and perhaps function descriptors
> for ubiquitous functions that don't warrant their own helppage, but need 
> documentation [in
> the case of gsl, this would be strictify() and process.args(), which 
> every user needs to know].
> 
> It would be *great* to be required to put in "package.gsl.R"  (or should 
> that be "gsl.package.Rd"?)
> for this purpose.  Then maybe R CMD check could check for its presence 
> and throw a wobbly
> if it isn't there.
> 

Hi,
  Well, I pretty strenuously object. That is just what vignettes are for 
and the last thing I need is more wobbly's from R CMD check.

Function documentation should document functions. If you want to 
document something more substantial then please use the tools already 
provided to do that - and if you don't want to, and you want to make use 
of the tools for function documentation in some other way please don't 
try to impose your version of what should happen on others.

Best wishes
   Robert

> Some packages have so  much material that it's difficult to know where 
> the "meat" of the functionality lies,
> and Duncan's suggestion would help greatly in these circumstances.
> 
> best wishes
> 
> rksh
> 
> 
> On Jun 7, 2005, at 01:11 pm, Duncan Murdoch wrote:
> 
>> Kurt Hornik wrote:
>>
>>>>>>>> Henrik Bengtsson writes:
>>>>
>>>> Hi,
>>>> I would like to suggest a standard where all packages provide an Rd 
>>>> page with the same name (or aliased) as the name of package so that 
>>>> help(<package name>) or ?<package name> is always here. This 
>>>> especially of interest to large packages with a large package index. 
>>>> This page could explain the package in general and gives some hints 
>>>> on how to start - not like extensive vignettes, but just to get 
>>>> started, e.g. list the "most important" functions.  This page could 
>>>> typically contain information that is in the DESCRIPTION file (which 
>>>> contains valuable information hardly every accessed by a general 
>>>> user), such as who is the maintainer, how to report bugs and so on.
>>
>>
>> I think this is a good idea.  One minor problem is that for some 
>> packages that topic name is already in use for a function (e.g. boot). 
>> For that reason, I'd suggest that there *also* be an alias called 
>> "package.<package name>", and the <package name> topic should link to it.
>>
>>> How would this be different from the results of
>>>     help(package = <package name>)
>>> ?
>>
>>
>>
>> 1.  It would work with ?, like other help topics.
>>
>> 2.  It would give an overview.  It's possible to do that in 
>> DESCRIPTION or INDEX, but you don't get the same style as for other 
>> help files (e.g. no links to other topics, at least in Windows).
>>
>>
>>
>> We should work out what the topic headings should be and extend 
>> package.skeleton() and prompt() to write a bare-bones file that 
>> suggests the questions that need to be answered in the file.  The 
>> headings I'd suggest are:
>>
>> \name
>> \title
>> \alias
>> \description (longer than the typical entry in the DESCRIPTION file)
>> \details (Should give a short guide to the main functions, should 
>> point out the existence of external documentation like vignettes, etc.)
>> \author (could also describe maintainer, if different)
>> \references
>> \seealso (Should give references to related packages)
>> \examples
>> \keywords
>>
>> There is some duplication of material from DESCRIPTION, but usually 
>> this should be longer and more reader-friendly than that file.
>>
>> I'd be happy to write the description of this in R Extensions, and 
>> write the changes to prompt(), if we have agreement that this file 
>> should be mandatory in 2.2.x or 2.3.x, and you'll write the checks for 
>> it.  (I think the check should just be for existence of aliases 
>> <package name> and package.<package name>, and could perhaps just give 
>> a warning in 2.2.x.)
>>
>> Duncan Murdoch
>>
>> ______________________________________________
>> R-devel@stat.math.ethz.ch mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>>
> -- 
> Robin Hankin
> Uncertainty Analyst
> National Oceanography Centre, Southampton
> European Way, Southampton SO14 3ZH, UK
>  tel  023-8059-7743
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

From murdoch at stats.uwo.ca  Tue Jun  7 17:22:05 2005
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Tue Jun  7 17:24:20 2005
Subject: [Rd] Suggestion: help(<package name>)
In-Reply-To: <42A5B96B.9030701@fhcrc.org>
References: <42A57F5D.7080505@maths.lth.se>	<17061.32946.976628.961120@beren.wu-wien.ac.at>	<42A58EDF.80701@stats.uwo.ca>
	<1f269abbabca01e19ee3cdbabc9d14f6@soc.soton.ac.uk>
	<42A5B96B.9030701@fhcrc.org>
Message-ID: <42A5BB9D.3000301@stats.uwo.ca>

On 6/7/2005 11:12 AM, Robert Gentleman wrote:
> 
> Robin Hankin wrote:
>> My 0.02:
>> 
>> I use Misc.Rd for the purpose that Duncan suggests.  I put things like 
>> details and rationale for package
>> organization, pointers to the most important function(s) in the 
>> package,  and perhaps function descriptors
>> for ubiquitous functions that don't warrant their own helppage, but need 
>> documentation [in
>> the case of gsl, this would be strictify() and process.args(), which 
>> every user needs to know].
>> 
>> It would be *great* to be required to put in "package.gsl.R"  (or should 
>> that be "gsl.package.Rd"?)
>> for this purpose.  Then maybe R CMD check could check for its presence 
>> and throw a wobbly
>> if it isn't there.
>> 
> 
> Hi,
>   Well, I pretty strenuously object. That is just what vignettes are for 
> and the last thing I need is more wobbly's from R CMD check.
> 
> Function documentation should document functions. If you want to 
> document something more substantial then please use the tools already 
> provided to do that - and if you don't want to, and you want to make use 
> of the tools for function documentation in some other way please don't 
> try to impose your version of what should happen on others.

The current .Rd files don't just document functions, they also document 
data objects and classes.

But the main point here is that it's not good to have multiple 
disconnected sets of documentation for a package.  Users should be able 
to say the equivalent of "give me help on foo", and get help on foo, 
whether it's a function, a data object, a package, a method, a class, or 
whatever.  It's a bad design to force them to ask for the same sort of 
thing in different ways depending on the type of thing they're asking for.

If we had a way to link vignettes into the help system, then I'd think 
it would be perfectly acceptable for ?package to pop up a vignette for 
the package.  However, right now we have too many different types of 
ways to display help, and not all of them are capable of displaying 
vignettes.

Duncan Murdoch


> 
> Best wishes
>    Robert
> 
>> Some packages have so  much material that it's difficult to know where 
>> the "meat" of the functionality lies,
>> and Duncan's suggestion would help greatly in these circumstances.
>> 
>> best wishes
>> 
>> rksh
>> 
>> 
>> On Jun 7, 2005, at 01:11 pm, Duncan Murdoch wrote:
>> 
>>> Kurt Hornik wrote:
>>>
>>>>>>>>> Henrik Bengtsson writes:
>>>>>
>>>>> Hi,
>>>>> I would like to suggest a standard where all packages provide an Rd 
>>>>> page with the same name (or aliased) as the name of package so that 
>>>>> help(<package name>) or ?<package name> is always here. This 
>>>>> especially of interest to large packages with a large package index. 
>>>>> This page could explain the package in general and gives some hints 
>>>>> on how to start - not like extensive vignettes, but just to get 
>>>>> started, e.g. list the "most important" functions.  This page could 
>>>>> typically contain information that is in the DESCRIPTION file (which 
>>>>> contains valuable information hardly every accessed by a general 
>>>>> user), such as who is the maintainer, how to report bugs and so on.
>>>
>>>
>>> I think this is a good idea.  One minor problem is that for some 
>>> packages that topic name is already in use for a function (e.g. boot). 
>>> For that reason, I'd suggest that there *also* be an alias called 
>>> "package.<package name>", and the <package name> topic should link to it.
>>>
>>>> How would this be different from the results of
>>>>     help(package = <package name>)
>>>> ?
>>>
>>>
>>>
>>> 1.  It would work with ?, like other help topics.
>>>
>>> 2.  It would give an overview.  It's possible to do that in 
>>> DESCRIPTION or INDEX, but you don't get the same style as for other 
>>> help files (e.g. no links to other topics, at least in Windows).
>>>
>>>
>>>
>>> We should work out what the topic headings should be and extend 
>>> package.skeleton() and prompt() to write a bare-bones file that 
>>> suggests the questions that need to be answered in the file.  The 
>>> headings I'd suggest are:
>>>
>>> \name
>>> \title
>>> \alias
>>> \description (longer than the typical entry in the DESCRIPTION file)
>>> \details (Should give a short guide to the main functions, should 
>>> point out the existence of external documentation like vignettes, etc.)
>>> \author (could also describe maintainer, if different)
>>> \references
>>> \seealso (Should give references to related packages)
>>> \examples
>>> \keywords
>>>
>>> There is some duplication of material from DESCRIPTION, but usually 
>>> this should be longer and more reader-friendly than that file.
>>>
>>> I'd be happy to write the description of this in R Extensions, and 
>>> write the changes to prompt(), if we have agreement that this file 
>>> should be mandatory in 2.2.x or 2.3.x, and you'll write the checks for 
>>> it.  (I think the check should just be for existence of aliases 
>>> <package name> and package.<package name>, and could perhaps just give 
>>> a warning in 2.2.x.)
>>>
>>> Duncan Murdoch
>>>
>>> ______________________________________________
>>> R-devel@stat.math.ethz.ch mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>
>>>
>> -- 
>> Robin Hankin
>> Uncertainty Analyst
>> National Oceanography Centre, Southampton
>> European Way, Southampton SO14 3ZH, UK
>>  tel  023-8059-7743
>> 
>> ______________________________________________
>> R-devel@stat.math.ethz.ch mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>

From ggrothendieck at gmail.com  Tue Jun  7 17:33:49 2005
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Tue Jun  7 17:36:17 2005
Subject: [Rd] Suggestion: help(<package name>)
In-Reply-To: <42A5B96B.9030701@fhcrc.org>
References: <42A57F5D.7080505@maths.lth.se>
	<17061.32946.976628.961120@beren.wu-wien.ac.at>
	<42A58EDF.80701@stats.uwo.ca>
	<1f269abbabca01e19ee3cdbabc9d14f6@soc.soton.ac.uk>
	<42A5B96B.9030701@fhcrc.org>
Message-ID: <971536df050607083379349191@mail.gmail.com>

On 6/7/05, Robert Gentleman <rgentlem@fhcrc.org> wrote:
> 
> 
> Robin Hankin wrote:
> > My 0.02:
> >
> > I use Misc.Rd for the purpose that Duncan suggests.  I put things like
> > details and rationale for package
> > organization, pointers to the most important function(s) in the
> > package,  and perhaps function descriptors
> > for ubiquitous functions that don't warrant their own helppage, but need
> > documentation [in
> > the case of gsl, this would be strictify() and process.args(), which
> > every user needs to know].
> >
> > It would be *great* to be required to put in "package.gsl.R"  (or should
> > that be "gsl.package.Rd"?)
> > for this purpose.  Then maybe R CMD check could check for its presence
> > and throw a wobbly
> > if it isn't there.
> >
> 
> Hi,
>  Well, I pretty strenuously object. That is just what vignettes are for
> and the last thing I need is more wobbly's from R CMD check.
> 
> Function documentation should document functions. If you want to

'?' or 'help' documents topics, as I under it, not necessarily functions.  For
example,

?iris
?Startup

Further, '?' has a type?topic syntax, as well.

Also, what is a wobbly?

> document something more substantial then please use the tools already
> provided to do that - and if you don't want to, and you want to make use
> of the tools for function documentation in some other way please don't
> try to impose your version of what should happen on others.
> 
> Best wishes
>   Robert
> 
> > Some packages have so  much material that it's difficult to know where
> > the "meat" of the functionality lies,
> > and Duncan's suggestion would help greatly in these circumstances.
> >
> > best wishes
> >
> > rksh
> >
> >
> > On Jun 7, 2005, at 01:11 pm, Duncan Murdoch wrote:
> >
> >> Kurt Hornik wrote:
> >>
> >>>>>>>> Henrik Bengtsson writes:
> >>>>
> >>>> Hi,
> >>>> I would like to suggest a standard where all packages provide an Rd
> >>>> page with the same name (or aliased) as the name of package so that
> >>>> help(<package name>) or ?<package name> is always here. This
> >>>> especially of interest to large packages with a large package index.
> >>>> This page could explain the package in general and gives some hints
> >>>> on how to start - not like extensive vignettes, but just to get
> >>>> started, e.g. list the "most important" functions.  This page could
> >>>> typically contain information that is in the DESCRIPTION file (which
> >>>> contains valuable information hardly every accessed by a general
> >>>> user), such as who is the maintainer, how to report bugs and so on.
> >>
> >>
> >> I think this is a good idea.  One minor problem is that for some
> >> packages that topic name is already in use for a function (e.g. boot).
> >> For that reason, I'd suggest that there *also* be an alias called
> >> "package.<package name>", and the <package name> topic should link to it.
> >>
> >>> How would this be different from the results of
> >>>     help(package = <package name>)
> >>> ?
> >>
> >>
> >>
> >> 1.  It would work with ?, like other help topics.
> >>
> >> 2.  It would give an overview.  It's possible to do that in
> >> DESCRIPTION or INDEX, but you don't get the same style as for other
> >> help files (e.g. no links to other topics, at least in Windows).
> >>
> >>
> >>
> >> We should work out what the topic headings should be and extend
> >> package.skeleton() and prompt() to write a bare-bones file that
> >> suggests the questions that need to be answered in the file.  The
> >> headings I'd suggest are:
> >>
> >> \name
> >> \title
> >> \alias
> >> \description (longer than the typical entry in the DESCRIPTION file)
> >> \details (Should give a short guide to the main functions, should
> >> point out the existence of external documentation like vignettes, etc.)
> >> \author (could also describe maintainer, if different)
> >> \references
> >> \seealso (Should give references to related packages)
> >> \examples
> >> \keywords
> >>
> >> There is some duplication of material from DESCRIPTION, but usually
> >> this should be longer and more reader-friendly than that file.
> >>
> >> I'd be happy to write the description of this in R Extensions, and
> >> write the changes to prompt(), if we have agreement that this file
> >> should be mandatory in 2.2.x or 2.3.x, and you'll write the checks for
> >> it.  (I think the check should just be for existence of aliases
> >> <package name> and package.<package name>, and could perhaps just give
> >> a warning in 2.2.x.)
> >>
> >> Duncan Murdoch
> >>
> >> ______________________________________________
> >> R-devel@stat.math.ethz.ch mailing list
> >> https://stat.ethz.ch/mailman/listinfo/r-devel
> >>
> >>
> > --
> > Robin Hankin
> > Uncertainty Analyst
> > National Oceanography Centre, Southampton
> > European Way, Southampton SO14 3ZH, UK
> >  tel  023-8059-7743
> >
> > ______________________________________________
> > R-devel@stat.math.ethz.ch mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-devel
> >
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

From rgentlem at fhcrc.org  Tue Jun  7 17:59:33 2005
From: rgentlem at fhcrc.org (Robert Gentleman)
Date: Tue Jun  7 17:59:48 2005
Subject: [Rd] Suggestion: help(<package name>)
In-Reply-To: <42A5BB9D.3000301@stats.uwo.ca>
References: <42A57F5D.7080505@maths.lth.se>	<17061.32946.976628.961120@beren.wu-wien.ac.at>	<42A58EDF.80701@stats.uwo.ca>
	<1f269abbabca01e19ee3cdbabc9d14f6@soc.soton.ac.uk>
	<42A5B96B.9030701@fhcrc.org> <42A5BB9D.3000301@stats.uwo.ca>
Message-ID: <42A5C465.3090505@fhcrc.org>



Duncan Murdoch wrote:
> On 6/7/2005 11:12 AM, Robert Gentleman wrote:
> 
>>
>> Robin Hankin wrote:
>>
>>> My 0.02:
>>>
>>> I use Misc.Rd for the purpose that Duncan suggests.  I put things 
>>> like details and rationale for package
>>> organization, pointers to the most important function(s) in the 
>>> package,  and perhaps function descriptors
>>> for ubiquitous functions that don't warrant their own helppage, but 
>>> need documentation [in
>>> the case of gsl, this would be strictify() and process.args(), which 
>>> every user needs to know].
>>>
>>> It would be *great* to be required to put in "package.gsl.R"  (or 
>>> should that be "gsl.package.Rd"?)
>>> for this purpose.  Then maybe R CMD check could check for its 
>>> presence and throw a wobbly
>>> if it isn't there.
>>>
>>
>> Hi,
>>   Well, I pretty strenuously object. That is just what vignettes are 
>> for and the last thing I need is more wobbly's from R CMD check.
>>
>> Function documentation should document functions. If you want to 
>> document something more substantial then please use the tools already 
>> provided to do that - and if you don't want to, and you want to make 
>> use of the tools for function documentation in some other way please 
>> don't try to impose your version of what should happen on others.
> 
> 
> The current .Rd files don't just document functions, they also document 
> data objects and classes.
> 
> But the main point here is that it's not good to have multiple 
> disconnected sets of documentation for a package.  Users should be able 
> to say the equivalent of "give me help on foo", and get help on foo, 
> whether it's a function, a data object, a package, a method, a class, or 
> whatever.  It's a bad design to force them to ask for the same sort of 
> thing in different ways depending on the type of thing they're asking for.
> 

Hi Duncan and others,
   I think they are linked. There are tools available both in R and in 
Bioconductor and some pop things up and some don't. It doesn't take much 
work to add vignettes to the windows menu bar - as we have done in BioC 
for some time now - it would be nice if this was part of R, but no one 
seems to have been interested in achieving that. Fixing the help system 
to deal with more diverse kinds of help would be nice as well - but 
taking one part of it and saying, "now everyone must do it this way" is 
not that helpful.

  I respectfully disagree about the main point. My main point is, I 
don't want more things imposed on me; dealing with  R CMD check is 
enough of a burden in its current version, without someone deciding that 
it would be nice to have a whole bunch more requirements. Folks should 
feel entirely free to do what they want - but a little less free to tell 
me what I should be doing.

  Best wishes,
    Robert


> If we had a way to link vignettes into the help system, then I'd think 
> it would be perfectly acceptable for ?package to pop up a vignette for 
> the package.  However, right now we have too many different types of 
> ways to display help, and not all of them are capable of displaying 
> vignettes.
> 
> Duncan Murdoch
> 
> 
>>
>> Best wishes
>>    Robert
>>
>>> Some packages have so  much material that it's difficult to know 
>>> where the "meat" of the functionality lies,
>>> and Duncan's suggestion would help greatly in these circumstances.
>>>
>>> best wishes
>>>
>>> rksh
>>>
>>>
>>> On Jun 7, 2005, at 01:11 pm, Duncan Murdoch wrote:
>>>
>>>> Kurt Hornik wrote:
>>>>
>>>>>>>>>> Henrik Bengtsson writes:
>>>>>>
>>>>>>
>>>>>> Hi,
>>>>>> I would like to suggest a standard where all packages provide an 
>>>>>> Rd page with the same name (or aliased) as the name of package so 
>>>>>> that help(<package name>) or ?<package name> is always here. This 
>>>>>> especially of interest to large packages with a large package 
>>>>>> index. This page could explain the package in general and gives 
>>>>>> some hints on how to start - not like extensive vignettes, but 
>>>>>> just to get started, e.g. list the "most important" functions.  
>>>>>> This page could typically contain information that is in the 
>>>>>> DESCRIPTION file (which contains valuable information hardly every 
>>>>>> accessed by a general user), such as who is the maintainer, how to 
>>>>>> report bugs and so on.
>>>>
>>>>
>>>>
>>>> I think this is a good idea.  One minor problem is that for some 
>>>> packages that topic name is already in use for a function (e.g. 
>>>> boot). For that reason, I'd suggest that there *also* be an alias 
>>>> called "package.<package name>", and the <package name> topic should 
>>>> link to it.
>>>>
>>>>> How would this be different from the results of
>>>>>     help(package = <package name>)
>>>>> ?
>>>>
>>>>
>>>>
>>>>
>>>> 1.  It would work with ?, like other help topics.
>>>>
>>>> 2.  It would give an overview.  It's possible to do that in 
>>>> DESCRIPTION or INDEX, but you don't get the same style as for other 
>>>> help files (e.g. no links to other topics, at least in Windows).
>>>>
>>>>
>>>>
>>>> We should work out what the topic headings should be and extend 
>>>> package.skeleton() and prompt() to write a bare-bones file that 
>>>> suggests the questions that need to be answered in the file.  The 
>>>> headings I'd suggest are:
>>>>
>>>> \name
>>>> \title
>>>> \alias
>>>> \description (longer than the typical entry in the DESCRIPTION file)
>>>> \details (Should give a short guide to the main functions, should 
>>>> point out the existence of external documentation like vignettes, etc.)
>>>> \author (could also describe maintainer, if different)
>>>> \references
>>>> \seealso (Should give references to related packages)
>>>> \examples
>>>> \keywords
>>>>
>>>> There is some duplication of material from DESCRIPTION, but usually 
>>>> this should be longer and more reader-friendly than that file.
>>>>
>>>> I'd be happy to write the description of this in R Extensions, and 
>>>> write the changes to prompt(), if we have agreement that this file 
>>>> should be mandatory in 2.2.x or 2.3.x, and you'll write the checks 
>>>> for it.  (I think the check should just be for existence of aliases 
>>>> <package name> and package.<package name>, and could perhaps just 
>>>> give a warning in 2.2.x.)
>>>>
>>>> Duncan Murdoch
>>>>
>>>> ______________________________________________
>>>> R-devel@stat.math.ethz.ch mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>
>>>>
>>> -- 
>>> Robin Hankin
>>> Uncertainty Analyst
>>> National Oceanography Centre, Southampton
>>> European Way, Southampton SO14 3ZH, UK
>>>  tel  023-8059-7743
>>>
>>> ______________________________________________
>>> R-devel@stat.math.ethz.ch mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>
>

From murdoch at stats.uwo.ca  Tue Jun  7 18:12:57 2005
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Tue Jun  7 18:15:15 2005
Subject: [Rd] Suggestion: help(<package name>)
In-Reply-To: <42A5C465.3090505@fhcrc.org>
References: <42A57F5D.7080505@maths.lth.se>	<17061.32946.976628.961120@beren.wu-wien.ac.at>	<42A58EDF.80701@stats.uwo.ca>	<1f269abbabca01e19ee3cdbabc9d14f6@soc.soton.ac.uk>	<42A5B96B.9030701@fhcrc.org>
	<42A5BB9D.3000301@stats.uwo.ca> <42A5C465.3090505@fhcrc.org>
Message-ID: <42A5C789.3060101@stats.uwo.ca>

On 6/7/2005 11:59 AM, Robert Gentleman wrote:
> 
> Duncan Murdoch wrote:
>> On 6/7/2005 11:12 AM, Robert Gentleman wrote:
>> 
>>>
>>> Robin Hankin wrote:
>>>
>>>> My 0.02:
>>>>
>>>> I use Misc.Rd for the purpose that Duncan suggests.  I put things 
>>>> like details and rationale for package
>>>> organization, pointers to the most important function(s) in the 
>>>> package,  and perhaps function descriptors
>>>> for ubiquitous functions that don't warrant their own helppage, but 
>>>> need documentation [in
>>>> the case of gsl, this would be strictify() and process.args(), which 
>>>> every user needs to know].
>>>>
>>>> It would be *great* to be required to put in "package.gsl.R"  (or 
>>>> should that be "gsl.package.Rd"?)
>>>> for this purpose.  Then maybe R CMD check could check for its 
>>>> presence and throw a wobbly
>>>> if it isn't there.
>>>>
>>>
>>> Hi,
>>>   Well, I pretty strenuously object. That is just what vignettes are 
>>> for and the last thing I need is more wobbly's from R CMD check.
>>>
>>> Function documentation should document functions. If you want to 
>>> document something more substantial then please use the tools already 
>>> provided to do that - and if you don't want to, and you want to make 
>>> use of the tools for function documentation in some other way please 
>>> don't try to impose your version of what should happen on others.
>> 
>> 
>> The current .Rd files don't just document functions, they also document 
>> data objects and classes.
>> 
>> But the main point here is that it's not good to have multiple 
>> disconnected sets of documentation for a package.  Users should be able 
>> to say the equivalent of "give me help on foo", and get help on foo, 
>> whether it's a function, a data object, a package, a method, a class, or 
>> whatever.  It's a bad design to force them to ask for the same sort of 
>> thing in different ways depending on the type of thing they're asking for.
>> 
> 
> Hi Duncan and others,
>    I think they are linked. There are tools available both in R and in 
> Bioconductor and some pop things up and some don't. It doesn't take much 
> work to add vignettes to the windows menu bar - as we have done in BioC 
> for some time now - it would be nice if this was part of R, but no one 
> seems to have been interested in achieving that. Fixing the help system 
> to deal with more diverse kinds of help would be nice as well - but 
> taking one part of it and saying, "now everyone must do it this way" is 
> not that helpful.
> 
>   I respectfully disagree about the main point. My main point is, I 
> don't want more things imposed on me; dealing with  R CMD check is 
> enough of a burden in its current version, without someone deciding that 
> it would be nice to have a whole bunch more requirements. Folks should 
> feel entirely free to do what they want - but a little less free to tell 
> me what I should be doing.

And I disagree pretty strenuously about that.  One of the strengths of R 
is that it does impose standards on contributed packages, and these make 
them easier to use, less likely to conflict with each other, and so on.

We shouldn't impose things lightly, but if they do make packages better, 
we should feel no reason not to tell you what you should be doing.

Currently R has 3 types of help:  the .Rd files in the man directory 
(which are converted into plain text, HTML, compiled HTML, LaTex, DVI, 
PDF, etc), the vignettes, and unstructured files in inst/doc.  We 
currently require .Rd files for every function and data object.  Adding 
a requirement to also document the package that way is not all that much 
of a burden, and will automatically give all those output formats I 
listed above.  It will help to solve the often-complained about problem 
   of packages that contain no overview at all.  (Requiring a vignette 
and giving a way to display it would also do that, but I think requiring 
a .Rd file is less of a burden, and for anyone who has gone to the 
trouble of creating a vignette, gives a natural place for a link to it. 
  Vignettes aren't used as much as they should be,  because they are 
hidden away where users don't see them.)

Duncan Murdoch

> 
>   Best wishes,
>     Robert
> 
> 
>> If we had a way to link vignettes into the help system, then I'd think 
>> it would be perfectly acceptable for ?package to pop up a vignette for 
>> the package.  However, right now we have too many different types of 
>> ways to display help, and not all of them are capable of displaying 
>> vignettes.
>> 
>> Duncan Murdoch
>> 
>> 
>>>
>>> Best wishes
>>>    Robert
>>>
>>>> Some packages have so  much material that it's difficult to know 
>>>> where the "meat" of the functionality lies,
>>>> and Duncan's suggestion would help greatly in these circumstances.
>>>>
>>>> best wishes
>>>>
>>>> rksh
>>>>
>>>>
>>>> On Jun 7, 2005, at 01:11 pm, Duncan Murdoch wrote:
>>>>
>>>>> Kurt Hornik wrote:
>>>>>
>>>>>>>>>>> Henrik Bengtsson writes:
>>>>>>>
>>>>>>>
>>>>>>> Hi,
>>>>>>> I would like to suggest a standard where all packages provide an 
>>>>>>> Rd page with the same name (or aliased) as the name of package so 
>>>>>>> that help(<package name>) or ?<package name> is always here. This 
>>>>>>> especially of interest to large packages with a large package 
>>>>>>> index. This page could explain the package in general and gives 
>>>>>>> some hints on how to start - not like extensive vignettes, but 
>>>>>>> just to get started, e.g. list the "most important" functions.  
>>>>>>> This page could typically contain information that is in the 
>>>>>>> DESCRIPTION file (which contains valuable information hardly every 
>>>>>>> accessed by a general user), such as who is the maintainer, how to 
>>>>>>> report bugs and so on.
>>>>>
>>>>>
>>>>>
>>>>> I think this is a good idea.  One minor problem is that for some 
>>>>> packages that topic name is already in use for a function (e.g. 
>>>>> boot). For that reason, I'd suggest that there *also* be an alias 
>>>>> called "package.<package name>", and the <package name> topic should 
>>>>> link to it.
>>>>>
>>>>>> How would this be different from the results of
>>>>>>     help(package = <package name>)
>>>>>> ?
>>>>>
>>>>>
>>>>>
>>>>>
>>>>> 1.  It would work with ?, like other help topics.
>>>>>
>>>>> 2.  It would give an overview.  It's possible to do that in 
>>>>> DESCRIPTION or INDEX, but you don't get the same style as for other 
>>>>> help files (e.g. no links to other topics, at least in Windows).
>>>>>
>>>>>
>>>>>
>>>>> We should work out what the topic headings should be and extend 
>>>>> package.skeleton() and prompt() to write a bare-bones file that 
>>>>> suggests the questions that need to be answered in the file.  The 
>>>>> headings I'd suggest are:
>>>>>
>>>>> \name
>>>>> \title
>>>>> \alias
>>>>> \description (longer than the typical entry in the DESCRIPTION file)
>>>>> \details (Should give a short guide to the main functions, should 
>>>>> point out the existence of external documentation like vignettes, etc.)
>>>>> \author (could also describe maintainer, if different)
>>>>> \references
>>>>> \seealso (Should give references to related packages)
>>>>> \examples
>>>>> \keywords
>>>>>
>>>>> There is some duplication of material from DESCRIPTION, but usually 
>>>>> this should be longer and more reader-friendly than that file.
>>>>>
>>>>> I'd be happy to write the description of this in R Extensions, and 
>>>>> write the changes to prompt(), if we have agreement that this file 
>>>>> should be mandatory in 2.2.x or 2.3.x, and you'll write the checks 
>>>>> for it.  (I think the check should just be for existence of aliases 
>>>>> <package name> and package.<package name>, and could perhaps just 
>>>>> give a warning in 2.2.x.)
>>>>>
>>>>> Duncan Murdoch
>>>>>
>>>>> ______________________________________________
>>>>> R-devel@stat.math.ethz.ch mailing list
>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>
>>>>>
>>>> -- 
>>>> Robin Hankin
>>>> Uncertainty Analyst
>>>> National Oceanography Centre, Southampton
>>>> European Way, Southampton SO14 3ZH, UK
>>>>  tel  023-8059-7743
>>>>
>>>> ______________________________________________
>>>> R-devel@stat.math.ethz.ch mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>
>>
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

From rhurlin at gwdg.de  Tue Jun  7 18:36:21 2005
From: rhurlin at gwdg.de (Rainer Hurling)
Date: Tue Jun  7 18:36:55 2005
Subject: [Rd] alloca() on FreeBSD (PR#7890)
In-Reply-To: <20050606112426.3827BA3C4@slim.kubism.ku.dk>
References: <20050606112426.3827BA3C4@slim.kubism.ku.dk>
Message-ID: <42A5CD05.3080507@gwdg.de>

One first reaction to your suggestions.

ripley@stats.ox.ac.uk wrote:
> On Mon, 23 May 2005 vangyzen@stat.duke.edu wrote:
>>R-2.1.0 fails to compile on the newest release of FreeBSD, complaining about
>>undefined references to __builtin_alloca.  On FreeBSD, alloca() is declared in
>>stdlib.h, not alloca.h as the R sources expect.  Therefore, HAVE_DECL_ALLOCA
>>does not get set, so the R sources declare alloca() after it has already been
>>#defined by stdlib.h.
>>
>>A possible fix is to modify the configure script to look for the declaration of
>>alloca() in stdlib.h (perhaps after it fails to find it in alloca.h).
> 
> 
> It is already supposed to, so it is not finding the declaration there 
> either. If you look up the definition of
> 
> AC_CHECK_DECLS([alloca], , , [#include <alloca.h>])
> 
> it searches in stdlib.h.  Can you please send us the appropriate part of 
> config.log?  It may be that this is failing because alloca.h is not found
> (but AC_FUNC_ALLOCA is making the same assumptions).
> 
> Perhaps the easiest way out is to override the setting on FreeBSD: can 
> you please confirm that manually changing
> 
> #define HAVE_DECL_ALLOCA 1
> 
> in config.h works?

Changing "#define HAVE_DECL_ALLOCA" to 1
in line 81 of R-2.1.0/src/include/config.h
gives me the following stopping:


mkdir ../../../../library/grDevices/libs
building package 'graphics'
mkdir ../../../library/graphics
mkdir ../../../library/graphics/R
mkdir ../../../library/graphics/demo
mkdir ../../../library/graphics/po
mkdir ../../../library/graphics/man
Error in dyn.load(x, as.logical(local), as.logical(now)) :
         unable to load shared library 
'/usr/local/R-2.1.0/library/grDevices/libs/grDevices.so':
   /usr/local/R-2.1.0/library/grDevices/libs/grDevices.so: Undefined 
symbol "__builtin_alloca"
Execution halted
*** Error code 1
Stop in /usr/local/R-2.1.0/src/library/graphics.
*** Error code 1
Stop in /usr/local/R-2.1.0/src/library.
*** Error code 1
Stop in /usr/local/R-2.1.0/src.
*** Error code 1
Stop in /usr/local/R-2.1.0.


Because I have almost no skills in C, automake and autoconf I have no 
idea on how to go on, sorry.

Hopefully Eric makes considerable progress ...


-- 
Dr. Rainer Hurling                           Phone: (049) 551 69401-145
Abteilung Waldschutz, Sachgebiet Insekten    Fax:   (049) 551 69401-160
Nieders?chsische Forstliche Versuchsanstalt  Mobil: (049) 160 5835-143
Gr?tzelstra?e 2, D-37079 G?ttingen, GERMANY  Rainer.Hurling@nfv.gwdg.de

From maechler at stat.math.ethz.ch  Tue Jun  7 18:43:37 2005
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Tue Jun  7 18:43:45 2005
Subject: [Rd] Suggestion: help(<package name>)
In-Reply-To: <42A5C789.3060101@stats.uwo.ca>
References: <42A57F5D.7080505@maths.lth.se>
	<17061.32946.976628.961120@beren.wu-wien.ac.at>
	<42A58EDF.80701@stats.uwo.ca>
	<1f269abbabca01e19ee3cdbabc9d14f6@soc.soton.ac.uk>
	<42A5B96B.9030701@fhcrc.org> <42A5BB9D.3000301@stats.uwo.ca>
	<42A5C465.3090505@fhcrc.org> <42A5C789.3060101@stats.uwo.ca>
Message-ID: <17061.52921.689940.969317@stat.math.ethz.ch>

>>>>> "Duncan" == Duncan Murdoch <murdoch@stats.uwo.ca>
>>>>>     on Tue, 07 Jun 2005 12:12:57 -0400 writes:

	  .............

    >>> The current .Rd files don't just document functions, they also document 
    >>> data objects and classes.
    >>> 
    >>> But the main point here is that it's not good to have multiple 
    >>> disconnected sets of documentation for a package.  Users should be able 
    >>> to say the equivalent of "give me help on foo", and get help on foo, 
    >>> whether it's a function, a data object, a package, a method, a class, or 
    >>> whatever.  It's a bad design to force them to ask for the same sort of 
    >>> thing in different ways depending on the type of thing they're asking for.
    ... On 6/7/2005 11:59 AM, Robert Gentleman wrote:

    >> 
    >> Hi Duncan and others,
    >> I think they are linked. There are tools available both in R and in 
    >> Bioconductor and some pop things up and some don't. It doesn't take much 
    >> work to add vignettes to the windows menu bar - as we have done in BioC 
    >> for some time now - it would be nice if this was part of R, but no one 
    >> seems to have been interested in achieving that. Fixing the help system 
    >> to deal with more diverse kinds of help would be nice as well - but 
    >> taking one part of it and saying, "now everyone must do it this way" is 
    >> not that helpful.

    >> I respectfully disagree about the main point. My main point is, I 
    >> don't want more things imposed on me; dealing with  R CMD check is 
    >> enough of a burden in its current version, without someone deciding that 
    >> it would be nice to have a whole bunch more requirements. Folks should 
    >> feel entirely free to do what they want - but a little less free to tell 
    >> me what I should be doing.

    Duncan> And I disagree pretty strenuously about that.  One
    Duncan> of the strengths of R is that it does impose
    Duncan> standards on contributed packages, and these make
    Duncan> them easier to use, less likely to conflict with
    Duncan> each other, and so on.

    Duncan> We shouldn't impose things lightly, but if they do
    Duncan> make packages better, we should feel no reason not
    Duncan> to tell you what you should be doing.

As Kurt mentioned early in this thread, we currently have
the auto-generated information from
either

    help(package = <pkgname>)    # or (equivalently!)
    library(help = <pkgname>)

which shows  
      DESCRIPTION + 
      (user-written/auto-generated) INDEX +
      mentions vignettes and other contents in inst/doc/

Now if Duncan would write some R code that produces a   man/<pkgname>.Rd
file from the above information -- and as he mentioned also
added some of that functionality to package.skeleton(), 
I think everyone could become "happy", i.e.,
we could improve the system in the future with only a very light
burden on the maintainers of currently existing packages: You'd
have to run the new R function only once for every package you
maintain.

Also, the use of a user-written INDEX file could eventually
completely be abandoned in favor of maintaining
man/<pkgname>.Rd, which is much nicer;  
I'd welcome such a direction quite a bit.

And as much as I do like (and read) the vignettes that are
available, I also do agree that writing one other *.Rd file is
easier for many new package authors than to write a
vignette -- the package author already had to learn *.Rd syntax
anyway -- and it's nice to be able to produce something where
hyperlinks to the other existing reference material (ie. help
pages) just works out of the box.

OTOH, we should still keep in mind that it's worth to try to
get  bi-directional linking between (PDF) vignettes and help
files  (assuming all relevant files are installed by R CMD
INSTALL of course).

Martin

    Duncan> Currently R has 3 types of help: the .Rd files in
    Duncan> the man directory (which are converted into plain
    Duncan> text, HTML, compiled HTML, LaTex, DVI, PDF, etc),
    Duncan> the vignettes, and unstructured files in inst/doc.
    Duncan> We currently require .Rd files for every function
    Duncan> and data object.  Adding a requirement to also
    Duncan> document the package that way is not all that much
    Duncan> of a burden, and will automatically give all those
    Duncan> output formats I listed above.  It will help to
    Duncan> solve the often-complained about problem of packages
    Duncan> that contain no overview at all.  (Requiring a
    Duncan> vignette and giving a way to display it would also
    Duncan> do that, but I think requiring a .Rd file is less of
    Duncan> a burden, and for anyone who has gone to the trouble
    Duncan> of creating a vignette, gives a natural place for a
    Duncan> link to it.  Vignettes aren't used as much as they
    Duncan> should be, because they are hidden away where users
    Duncan> don't see them.)

    Duncan> Duncan Murdoch

    >> 
    >> Best wishes,
    >> Robert
    >> 
    >> 
    >>> If we had a way to link vignettes into the help system, then I'd think 
    >>> it would be perfectly acceptable for ?package to pop up a vignette for 
    >>> the package.  However, right now we have too many different types of 
    >>> ways to display help, and not all of them are capable of displaying 
    >>> vignettes.
    >>> 
    >>> Duncan Murdoch
    >>> 
    >>> 
    >>>> 
    >>>> Best wishes
    >>>> Robert
    >>>> 
    >>>>> Some packages have so  much material that it's difficult to know 
    >>>>> where the "meat" of the functionality lies,
    >>>>> and Duncan's suggestion would help greatly in these circumstances.
    >>>>> 
    >>>>> best wishes
    >>>>> 
    >>>>> rksh
    >>>>> 
    >>>>> 
    >>>>> On Jun 7, 2005, at 01:11 pm, Duncan Murdoch wrote:
    >>>>> 
>>>>> Kurt Hornik wrote:
    >>>>>> 
    >>>>>>>>>>>> Henrik Bengtsson writes:
    >>>>>>>> 
    >>>>>>>> 
    >>>>>>>> Hi,
    >>>>>>>> I would like to suggest a standard where all packages provide an 
    >>>>>>>> Rd page with the same name (or aliased) as the name of package so 
    >>>>>>>> that help(<package name>) or ?<package name> is always here. This 
    >>>>>>>> especially of interest to large packages with a large package 
    >>>>>>>> index. This page could explain the package in general and gives 
    >>>>>>>> some hints on how to start - not like extensive vignettes, but 
    >>>>>>>> just to get started, e.g. list the "most important" functions.  
    >>>>>>>> This page could typically contain information that is in the 
    >>>>>>>> DESCRIPTION file (which contains valuable information hardly every 
    >>>>>>>> accessed by a general user), such as who is the maintainer, how to 
    >>>>>>>> report bugs and so on.
    >>>>>> 
    >>>>>> 
    >>>>>> 
>>>>> I think this is a good idea.  One minor problem is that for some 
>>>>> packages that topic name is already in use for a function (e.g. 
>>>>> boot). For that reason, I'd suggest that there *also* be an alias 
>>>>> called "package.<package name>", and the <package name> topic should 
>>>>> link to it.
    >>>>>> 
    >>>>>>> How would this be different from the results of
    >>>>>>> help(package = <package name>)
    >>>>>>> ?
    >>>>>> 
    >>>>>> 
    >>>>>> 
    >>>>>> 
>>>>> 1.  It would work with ?, like other help topics.
    >>>>>> 
>>>>> 2.  It would give an overview.  It's possible to do that in 
>>>>> DESCRIPTION or INDEX, but you don't get the same style as for other 
>>>>> help files (e.g. no links to other topics, at least in Windows).
    >>>>>> 
    >>>>>> 
    >>>>>> 
>>>>> We should work out what the topic headings should be and extend 
>>>>> package.skeleton() and prompt() to write a bare-bones file that 
>>>>> suggests the questions that need to be answered in the file.  The 
>>>>> headings I'd suggest are:
    >>>>>> 
>>>>> \name
>>>>> \title
>>>>> \alias
>>>>> \description (longer than the typical entry in the DESCRIPTION file)
>>>>> \details (Should give a short guide to the main functions, should 
>>>>> point out the existence of external documentation like vignettes, etc.)
>>>>> \author (could also describe maintainer, if different)
>>>>> \references
>>>>> \seealso (Should give references to related packages)
>>>>> \examples
>>>>> \keywords

>>>>> There is some duplication of material from DESCRIPTION, but usually 
>>>>> this should be longer and more reader-friendly than that file.

and as mentioned above, an improved package.skeleton() function
could auto-generate both of them anyway.

>>>>> I'd be happy to write the description of this in R Extensions, and 
>>>>> write the changes to prompt(), if we have agreement that this file 
>>>>> should be mandatory in 2.2.x or 2.3.x, and you'll write the checks 
>>>>> for it.  (I think the check should just be for existence of aliases 
>>>>> <package name> and package.<package name>, and could perhaps just 
>>>>> give a warning in 2.2.x.)

From rgentlem at fhcrc.org  Tue Jun  7 18:59:37 2005
From: rgentlem at fhcrc.org (Robert Gentleman)
Date: Tue Jun  7 18:59:49 2005
Subject: [Rd] Suggestion: help(<package name>)
In-Reply-To: <42A5C789.3060101@stats.uwo.ca>
References: <42A57F5D.7080505@maths.lth.se>	<17061.32946.976628.961120@beren.wu-wien.ac.at>	<42A58EDF.80701@stats.uwo.ca>	<1f269abbabca01e19ee3cdbabc9d14f6@soc.soton.ac.uk>	<42A5B96B.9030701@fhcrc.org>	<42A5BB9D.3000301@stats.uwo.ca>
	<42A5C465.3090505@fhcrc.org> <42A5C789.3060101@stats.uwo.ca>
Message-ID: <42A5D279.3010501@fhcrc.org>



Duncan Murdoch wrote:
> On 6/7/2005 11:59 AM, Robert Gentleman wrote:
> 
>>
>> Duncan Murdoch wrote:
>>
>>> On 6/7/2005 11:12 AM, Robert Gentleman wrote:
>>>
>>>>
>>>> Robin Hankin wrote:
>>>>
>>>>> My 0.02:
>>>>>
>>>>> I use Misc.Rd for the purpose that Duncan suggests.  I put things 
>>>>> like details and rationale for package
>>>>> organization, pointers to the most important function(s) in the 
>>>>> package,  and perhaps function descriptors
>>>>> for ubiquitous functions that don't warrant their own helppage, but 
>>>>> need documentation [in
>>>>> the case of gsl, this would be strictify() and process.args(), 
>>>>> which every user needs to know].
>>>>>
>>>>> It would be *great* to be required to put in "package.gsl.R"  (or 
>>>>> should that be "gsl.package.Rd"?)
>>>>> for this purpose.  Then maybe R CMD check could check for its 
>>>>> presence and throw a wobbly
>>>>> if it isn't there.
>>>>>
>>>>
>>>> Hi,
>>>>   Well, I pretty strenuously object. That is just what vignettes are 
>>>> for and the last thing I need is more wobbly's from R CMD check.
>>>>
>>>> Function documentation should document functions. If you want to 
>>>> document something more substantial then please use the tools 
>>>> already provided to do that - and if you don't want to, and you want 
>>>> to make use of the tools for function documentation in some other 
>>>> way please don't try to impose your version of what should happen on 
>>>> others.
>>>
>>>
>>>
>>> The current .Rd files don't just document functions, they also 
>>> document data objects and classes.
>>>
>>> But the main point here is that it's not good to have multiple 
>>> disconnected sets of documentation for a package.  Users should be 
>>> able to say the equivalent of "give me help on foo", and get help on 
>>> foo, whether it's a function, a data object, a package, a method, a 
>>> class, or whatever.  It's a bad design to force them to ask for the 
>>> same sort of thing in different ways depending on the type of thing 
>>> they're asking for.
>>>
>>
>> Hi Duncan and others,
>>    I think they are linked. There are tools available both in R and in 
>> Bioconductor and some pop things up and some don't. It doesn't take 
>> much work to add vignettes to the windows menu bar - as we have done 
>> in BioC for some time now - it would be nice if this was part of R, 
>> but no one seems to have been interested in achieving that. Fixing the 
>> help system to deal with more diverse kinds of help would be nice as 
>> well - but taking one part of it and saying, "now everyone must do it 
>> this way" is not that helpful.
>>
>>   I respectfully disagree about the main point. My main point is, I 
>> don't want more things imposed on me; dealing with  R CMD check is 
>> enough of a burden in its current version, without someone deciding 
>> that it would be nice to have a whole bunch more requirements. Folks 
>> should feel entirely free to do what they want - but a little less 
>> free to tell me what I should be doing.
> 
> 
> And I disagree pretty strenuously about that.  One of the strengths of R 
> is that it does impose standards on contributed packages, and these make 
> them easier to use, less likely to conflict with each other, and so on.
> 
> We shouldn't impose things lightly, but if they do make packages better, 
> we should feel no reason not to tell you what you should be doing.
> 
  Let's see, some of us (three years ago) developed a tool to solve this 
problem. We made it available to others to use as they saw fit. I feel 
no less strong than you do, but I certainly did not impose what I 
thought on you and I ask for the same respect. We have already solved 
this problem in our own way. You now seem to think that it is zero cost 
to impose on us a second (and in my view inferior solution). I am asking 
that you not do that. Please, feel free to develop what you want and to 
encourage others to use it, but don't try to make people do things just 
because you want them that way.
  We have lots of packages in BioC the costs of reengineering so we can 
meet your newly imposed standards are not zero. I think we have an 
expectation that such capricious behaviour will not be entered in to, 
and if we don't then perhaps it is time to branch the project.

  Best wishes,
    Robert

> Currently R has 3 types of help:  the .Rd files in the man directory 
> (which are converted into plain text, HTML, compiled HTML, LaTex, DVI, 
> PDF, etc), the vignettes, and unstructured files in inst/doc.  We 
> currently require .Rd files for every function and data object.  Adding 
> a requirement to also document the package that way is not all that much 
> of a burden, and will automatically give all those output formats I 
> listed above.  It will help to solve the often-complained about problem 
>   of packages that contain no overview at all.  (Requiring a vignette 
> and giving a way to display it would also do that, but I think requiring 
> a .Rd file is less of a burden, and for anyone who has gone to the 
> trouble of creating a vignette, gives a natural place for a link to it. 
>  Vignettes aren't used as much as they should be,  because they are 
> hidden away where users don't see them.)
> 
> Duncan Murdoch
> 
>>
>>   Best wishes,
>>     Robert
>>
>>
>>> If we had a way to link vignettes into the help system, then I'd 
>>> think it would be perfectly acceptable for ?package to pop up a 
>>> vignette for the package.  However, right now we have too many 
>>> different types of ways to display help, and not all of them are 
>>> capable of displaying vignettes.
>>>
>>> Duncan Murdoch
>>>
>>>
>>>>
>>>> Best wishes
>>>>    Robert
>>>>
>>>>> Some packages have so  much material that it's difficult to know 
>>>>> where the "meat" of the functionality lies,
>>>>> and Duncan's suggestion would help greatly in these circumstances.
>>>>>
>>>>> best wishes
>>>>>
>>>>> rksh
>>>>>
>>>>>
>>>>> On Jun 7, 2005, at 01:11 pm, Duncan Murdoch wrote:
>>>>>
>>>>>> Kurt Hornik wrote:
>>>>>>
>>>>>>>>>>>> Henrik Bengtsson writes:
>>>>>>>>
>>>>>>>>
>>>>>>>>
>>>>>>>> Hi,
>>>>>>>> I would like to suggest a standard where all packages provide an 
>>>>>>>> Rd page with the same name (or aliased) as the name of package 
>>>>>>>> so that help(<package name>) or ?<package name> is always here. 
>>>>>>>> This especially of interest to large packages with a large 
>>>>>>>> package index. This page could explain the package in general 
>>>>>>>> and gives some hints on how to start - not like extensive 
>>>>>>>> vignettes, but just to get started, e.g. list the "most 
>>>>>>>> important" functions.  This page could typically contain 
>>>>>>>> information that is in the DESCRIPTION file (which contains 
>>>>>>>> valuable information hardly every accessed by a general user), 
>>>>>>>> such as who is the maintainer, how to report bugs and so on.
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>> I think this is a good idea.  One minor problem is that for some 
>>>>>> packages that topic name is already in use for a function (e.g. 
>>>>>> boot). For that reason, I'd suggest that there *also* be an alias 
>>>>>> called "package.<package name>", and the <package name> topic 
>>>>>> should link to it.
>>>>>>
>>>>>>> How would this be different from the results of
>>>>>>>     help(package = <package name>)
>>>>>>> ?
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>> 1.  It would work with ?, like other help topics.
>>>>>>
>>>>>> 2.  It would give an overview.  It's possible to do that in 
>>>>>> DESCRIPTION or INDEX, but you don't get the same style as for 
>>>>>> other help files (e.g. no links to other topics, at least in 
>>>>>> Windows).
>>>>>>
>>>>>>
>>>>>>
>>>>>> We should work out what the topic headings should be and extend 
>>>>>> package.skeleton() and prompt() to write a bare-bones file that 
>>>>>> suggests the questions that need to be answered in the file.  The 
>>>>>> headings I'd suggest are:
>>>>>>
>>>>>> \name
>>>>>> \title
>>>>>> \alias
>>>>>> \description (longer than the typical entry in the DESCRIPTION file)
>>>>>> \details (Should give a short guide to the main functions, should 
>>>>>> point out the existence of external documentation like vignettes, 
>>>>>> etc.)
>>>>>> \author (could also describe maintainer, if different)
>>>>>> \references
>>>>>> \seealso (Should give references to related packages)
>>>>>> \examples
>>>>>> \keywords
>>>>>>
>>>>>> There is some duplication of material from DESCRIPTION, but 
>>>>>> usually this should be longer and more reader-friendly than that 
>>>>>> file.
>>>>>>
>>>>>> I'd be happy to write the description of this in R Extensions, and 
>>>>>> write the changes to prompt(), if we have agreement that this file 
>>>>>> should be mandatory in 2.2.x or 2.3.x, and you'll write the checks 
>>>>>> for it.  (I think the check should just be for existence of 
>>>>>> aliases <package name> and package.<package name>, and could 
>>>>>> perhaps just give a warning in 2.2.x.)
>>>>>>
>>>>>> Duncan Murdoch
>>>>>>
>>>>>> ______________________________________________
>>>>>> R-devel@stat.math.ethz.ch mailing list
>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>>
>>>>>>
>>>>> -- 
>>>>> Robin Hankin
>>>>> Uncertainty Analyst
>>>>> National Oceanography Centre, Southampton
>>>>> European Way, Southampton SO14 3ZH, UK
>>>>>  tel  023-8059-7743
>>>>>
>>>>> ______________________________________________
>>>>> R-devel@stat.math.ethz.ch mailing list
>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>
>>>
>>
>> ______________________________________________
>> R-devel@stat.math.ethz.ch mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

From Achim.Zeileis at wu-wien.ac.at  Tue Jun  7 19:00:25 2005
From: Achim.Zeileis at wu-wien.ac.at (Achim Zeileis)
Date: Tue Jun  7 19:02:09 2005
Subject: [Rd] Suggestion: help(<package name>)
In-Reply-To: <17061.52921.689940.969317@stat.math.ethz.ch>
References: <42A57F5D.7080505@maths.lth.se>
	<17061.32946.976628.961120@beren.wu-wien.ac.at>
	<42A58EDF.80701@stats.uwo.ca>
	<1f269abbabca01e19ee3cdbabc9d14f6@soc.soton.ac.uk>
	<42A5B96B.9030701@fhcrc.org> <42A5BB9D.3000301@stats.uwo.ca>
	<42A5C465.3090505@fhcrc.org> <42A5C789.3060101@stats.uwo.ca>
	<17061.52921.689940.969317@stat.math.ethz.ch>
Message-ID: <20050607190025.55a68766.Achim.Zeileis@wu-wien.ac.at>

On Tue, 7 Jun 2005 18:43:37 +0200 Martin Maechler wrote:

> >>>>> "Duncan" == Duncan Murdoch <murdoch@stats.uwo.ca>
> >>>>>     on Tue, 07 Jun 2005 12:12:57 -0400 writes:
> 
> 	  .............
> 
>     >>> The current .Rd files don't just document functions, they also
>     >document >> data objects and classes.
>     >>> 
>     >>> But the main point here is that it's not good to have multiple
>     >>> disconnected sets of documentation for a package.  Users
>     >should be able >> to say the equivalent of "give me help on foo",
>     >and get help on foo, >> whether it's a function, a data object, a
>     >package, a method, a class, or >> whatever.  It's a bad design to
>     >force them to ask for the same sort of >> thing in different ways
>     >depending on the type of thing they're asking for.
>     ... On 6/7/2005 11:59 AM, Robert Gentleman wrote:
> 
>     >> 
>     >> Hi Duncan and others,
>     >> I think they are linked. There are tools available both in R
>     >and in > Bioconductor and some pop things up and some don't. It
>     >doesn't take much > work to add vignettes to the windows menu bar
>     >- as we have done in BioC > for some time now - it would be nice
>     >if this was part of R, but no one > seems to have been interested
>     >in achieving that. Fixing the help system > to deal with more
>     >diverse kinds of help would be nice as well - but > taking one
>     >part of it and saying, "now everyone must do it this way" is >
>     >not that helpful.
> 
>     >> I respectfully disagree about the main point. My main point is,
>     >I > don't want more things imposed on me; dealing with  R CMD
>     >check is > enough of a burden in its current version, without
>     >someone deciding that > it would be nice to have a whole bunch
>     >more requirements. Folks should > feel entirely free to do what
>     >they want - but a little less free to tell > me what I should be
>     >doing.
> 
>     Duncan> And I disagree pretty strenuously about that.  One
>     Duncan> of the strengths of R is that it does impose
>     Duncan> standards on contributed packages, and these make
>     Duncan> them easier to use, less likely to conflict with
>     Duncan> each other, and so on.
> 
>     Duncan> We shouldn't impose things lightly, but if they do
>     Duncan> make packages better, we should feel no reason not
>     Duncan> to tell you what you should be doing.
> 
> As Kurt mentioned early in this thread, we currently have
> the auto-generated information from
> either
> 
>     help(package = <pkgname>)    # or (equivalently!)
>     library(help = <pkgname>)
> 
> which shows  
>       DESCRIPTION + 
>       (user-written/auto-generated) INDEX +
>       mentions vignettes and other contents in inst/doc/
> 
> Now if Duncan would write some R code that produces a  
> man/<pkgname>.Rd file from the above information

I would like to second what Gabor said earlier in this thread: we cannot
simply create man/<pkgname>.Rd because this will already exist for many
packages. Examples that come to my mind include: betareg, chron,
ellipse, flexmix, ineq, zoo, and many more. Renaming the package is not
an option, so probably the man page has to be renamed to something like
man/<pkgname>.package.Rd, say. And then doing
  help(package = "foo")
and
  help("foo.package")
is not that much of a difference, is it? Personally, I find the former
more intuitive.
Z

> -- and as he mentioned also
> added some of that functionality to package.skeleton(), 
> I think everyone could become "happy", i.e.,
> we could improve the system in the future with only a very light
> burden on the maintainers of currently existing packages: You'd
> have to run the new R function only once for every package you
> maintain.
> 
> Also, the use of a user-written INDEX file could eventually
> completely be abandoned in favor of maintaining
> man/<pkgname>.Rd, which is much nicer;  
> I'd welcome such a direction quite a bit.
> 
> And as much as I do like (and read) the vignettes that are
> available, I also do agree that writing one other *.Rd file is
> easier for many new package authors than to write a
> vignette -- the package author already had to learn *.Rd syntax
> anyway -- and it's nice to be able to produce something where
> hyperlinks to the other existing reference material (ie. help
> pages) just works out of the box.
> 
> OTOH, we should still keep in mind that it's worth to try to
> get  bi-directional linking between (PDF) vignettes and help
> files  (assuming all relevant files are installed by R CMD
> INSTALL of course).
> 
> Martin
> 
>     Duncan> Currently R has 3 types of help: the .Rd files in
>     Duncan> the man directory (which are converted into plain
>     Duncan> text, HTML, compiled HTML, LaTex, DVI, PDF, etc),
>     Duncan> the vignettes, and unstructured files in inst/doc.
>     Duncan> We currently require .Rd files for every function
>     Duncan> and data object.  Adding a requirement to also
>     Duncan> document the package that way is not all that much
>     Duncan> of a burden, and will automatically give all those
>     Duncan> output formats I listed above.  It will help to
>     Duncan> solve the often-complained about problem of packages
>     Duncan> that contain no overview at all.  (Requiring a
>     Duncan> vignette and giving a way to display it would also
>     Duncan> do that, but I think requiring a .Rd file is less of
>     Duncan> a burden, and for anyone who has gone to the trouble
>     Duncan> of creating a vignette, gives a natural place for a
>     Duncan> link to it.  Vignettes aren't used as much as they
>     Duncan> should be, because they are hidden away where users
>     Duncan> don't see them.)
> 
>     Duncan> Duncan Murdoch
> 
>     >> 
>     >> Best wishes,
>     >> Robert
>     >> 
>     >> 
>     >>> If we had a way to link vignettes into the help system, then
>     >I'd think >> it would be perfectly acceptable for ?package to pop
>     >up a vignette for >> the package.  However, right now we have too
>     >many different types of >> ways to display help, and not all of
>     >them are capable of displaying >> vignettes.
>     >>> 
>     >>> Duncan Murdoch
>     >>> 
>     >>> 
>     >>>> 
>     >>>> Best wishes
>     >>>> Robert
>     >>>> 
>     >>>>> Some packages have so  much material that it's difficult to
>     >know >>>> where the "meat" of the functionality lies,
>     >>>>> and Duncan's suggestion would help greatly in these
>     >circumstances.>>>> 
>     >>>>> best wishes
>     >>>>> 
>     >>>>> rksh
>     >>>>> 
>     >>>>> 
>     >>>>> On Jun 7, 2005, at 01:11 pm, Duncan Murdoch wrote:
>     >>>>> 
> >>>>> Kurt Hornik wrote:
>     >>>>>> 
>     >>>>>>>>>>>> Henrik Bengtsson writes:
>     >>>>>>>> 
>     >>>>>>>> 
>     >>>>>>>> Hi,
>     >>>>>>>> I would like to suggest a standard where all packages
>     >provide an >>>>>>> Rd page with the same name (or aliased) as the
>     >name of package so >>>>>>> that help(<package name>) or ?<package
>     >name> is always here. This >>>>>>> especially of interest to
>     >large packages with a large package >>>>>>> index. This page
>     >could explain the package in general and gives >>>>>>> some hints
>     >on how to start - not like extensive vignettes, but >>>>>>> just
>     >to get started, e.g. list the "most important" functions. 
>     >>>>>>>> This page could typically contain information that is in
>     >the >>>>>>> DESCRIPTION file (which contains valuable information
>     >hardly every >>>>>>> accessed by a general user), such as who is
>     >the maintainer, how to >>>>>>> report bugs and so on.
>     >>>>>> 
>     >>>>>> 
>     >>>>>> 
> >>>>> I think this is a good idea.  One minor problem is that for some
> >>>>> packages that topic name is already in use for a function (e.g. 
> >>>>> boot). For that reason, I'd suggest that there *also* be an
> >alias >>>> called "package.<package name>", and the <package name>
> >topic should >>>> link to it.
>     >>>>>> 
>     >>>>>>> How would this be different from the results of
>     >>>>>>> help(package = <package name>)
>     >>>>>>> ?
>     >>>>>> 
>     >>>>>> 
>     >>>>>> 
>     >>>>>> 
> >>>>> 1.  It would work with ?, like other help topics.
>     >>>>>> 
> >>>>> 2.  It would give an overview.  It's possible to do that in 
> >>>>> DESCRIPTION or INDEX, but you don't get the same style as for
> >other >>>> help files (e.g. no links to other topics, at least in
> >Windows).
>     >>>>>> 
>     >>>>>> 
>     >>>>>> 
> >>>>> We should work out what the topic headings should be and extend 
> >>>>> package.skeleton() and prompt() to write a bare-bones file that 
> >>>>> suggests the questions that need to be answered in the file. 
> >The >>>> headings I'd suggest are:
>     >>>>>> 
> >>>>> \name
> >>>>> \title
> >>>>> \alias
> >>>>> \description (longer than the typical entry in the DESCRIPTION
> >file)>>>> \details (Should give a short guide to the main functions,
> >should >>>> point out the existence of external documentation like
> >vignettes, etc.)>>>> \author (could also describe maintainer, if
> >different)>>>> \references
> >>>>> \seealso (Should give references to related packages)
> >>>>> \examples
> >>>>> \keywords
> 
> >>>>> There is some duplication of material from DESCRIPTION, but
> >usually >>>> this should be longer and more reader-friendly than that
> >file.
> 
> and as mentioned above, an improved package.skeleton() function
> could auto-generate both of them anyway.
> 
> >>>>> I'd be happy to write the description of this in R Extensions,
> >and >>>> write the changes to prompt(), if we have agreement that
> >this file >>>> should be mandatory in 2.2.x or 2.3.x, and you'll
> >write the checks >>>> for it.  (I think the check should just be for
> >existence of aliases >>>> <package name> and package.<package name>,
> >and could perhaps just >>>> give a warning in 2.2.x.)
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

From ggrothendieck at gmail.com  Tue Jun  7 19:39:22 2005
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Tue Jun  7 19:39:32 2005
Subject: [Rd] Suggestion: help(<package name>)
In-Reply-To: <20050607190025.55a68766.Achim.Zeileis@wu-wien.ac.at>
References: <42A57F5D.7080505@maths.lth.se>
	<17061.32946.976628.961120@beren.wu-wien.ac.at>
	<42A58EDF.80701@stats.uwo.ca>
	<1f269abbabca01e19ee3cdbabc9d14f6@soc.soton.ac.uk>
	<42A5B96B.9030701@fhcrc.org> <42A5BB9D.3000301@stats.uwo.ca>
	<42A5C465.3090505@fhcrc.org> <42A5C789.3060101@stats.uwo.ca>
	<17061.52921.689940.969317@stat.math.ethz.ch>
	<20050607190025.55a68766.Achim.Zeileis@wu-wien.ac.at>
Message-ID: <971536df05060710393fdd9c28@mail.gmail.com>

Currently methods?e will look for the alias e-methods so perhaps package?e 
could look for alias e-package.

On 6/7/05, Achim Zeileis <Achim.Zeileis@wu-wien.ac.at> wrote:
> On Tue, 7 Jun 2005 18:43:37 +0200 Martin Maechler wrote:
> 
> > >>>>> "Duncan" == Duncan Murdoch <murdoch@stats.uwo.ca>
> > >>>>>     on Tue, 07 Jun 2005 12:12:57 -0400 writes:
> >
> >         .............
> >
> >     >>> The current .Rd files don't just document functions, they also
> >     >document >> data objects and classes.
> >     >>>
> >     >>> But the main point here is that it's not good to have multiple
> >     >>> disconnected sets of documentation for a package.  Users
> >     >should be able >> to say the equivalent of "give me help on foo",
> >     >and get help on foo, >> whether it's a function, a data object, a
> >     >package, a method, a class, or >> whatever.  It's a bad design to
> >     >force them to ask for the same sort of >> thing in different ways
> >     >depending on the type of thing they're asking for.
> >     ... On 6/7/2005 11:59 AM, Robert Gentleman wrote:
> >
> >     >>
> >     >> Hi Duncan and others,
> >     >> I think they are linked. There are tools available both in R
> >     >and in > Bioconductor and some pop things up and some don't. It
> >     >doesn't take much > work to add vignettes to the windows menu bar
> >     >- as we have done in BioC > for some time now - it would be nice
> >     >if this was part of R, but no one > seems to have been interested
> >     >in achieving that. Fixing the help system > to deal with more
> >     >diverse kinds of help would be nice as well - but > taking one
> >     >part of it and saying, "now everyone must do it this way" is >
> >     >not that helpful.
> >
> >     >> I respectfully disagree about the main point. My main point is,
> >     >I > don't want more things imposed on me; dealing with  R CMD
> >     >check is > enough of a burden in its current version, without
> >     >someone deciding that > it would be nice to have a whole bunch
> >     >more requirements. Folks should > feel entirely free to do what
> >     >they want - but a little less free to tell > me what I should be
> >     >doing.
> >
> >     Duncan> And I disagree pretty strenuously about that.  One
> >     Duncan> of the strengths of R is that it does impose
> >     Duncan> standards on contributed packages, and these make
> >     Duncan> them easier to use, less likely to conflict with
> >     Duncan> each other, and so on.
> >
> >     Duncan> We shouldn't impose things lightly, but if they do
> >     Duncan> make packages better, we should feel no reason not
> >     Duncan> to tell you what you should be doing.
> >
> > As Kurt mentioned early in this thread, we currently have
> > the auto-generated information from
> > either
> >
> >     help(package = <pkgname>)    # or (equivalently!)
> >     library(help = <pkgname>)
> >
> > which shows
> >       DESCRIPTION +
> >       (user-written/auto-generated) INDEX +
> >       mentions vignettes and other contents in inst/doc/
> >
> > Now if Duncan would write some R code that produces a
> > man/<pkgname>.Rd file from the above information
> 
> I would like to second what Gabor said earlier in this thread: we cannot
> simply create man/<pkgname>.Rd because this will already exist for many
> packages. Examples that come to my mind include: betareg, chron,
> ellipse, flexmix, ineq, zoo, and many more. Renaming the package is not
> an option, so probably the man page has to be renamed to something like
> man/<pkgname>.package.Rd, say. And then doing
>  help(package = "foo")
> and
>  help("foo.package")
> is not that much of a difference, is it? Personally, I find the former
> more intuitive.
> Z
> 
> > -- and as he mentioned also
> > added some of that functionality to package.skeleton(),
> > I think everyone could become "happy", i.e.,
> > we could improve the system in the future with only a very light
> > burden on the maintainers of currently existing packages: You'd
> > have to run the new R function only once for every package you
> > maintain.
> >
> > Also, the use of a user-written INDEX file could eventually
> > completely be abandoned in favor of maintaining
> > man/<pkgname>.Rd, which is much nicer;
> > I'd welcome such a direction quite a bit.
> >
> > And as much as I do like (and read) the vignettes that are
> > available, I also do agree that writing one other *.Rd file is
> > easier for many new package authors than to write a
> > vignette -- the package author already had to learn *.Rd syntax
> > anyway -- and it's nice to be able to produce something where
> > hyperlinks to the other existing reference material (ie. help
> > pages) just works out of the box.
> >
> > OTOH, we should still keep in mind that it's worth to try to
> > get  bi-directional linking between (PDF) vignettes and help
> > files  (assuming all relevant files are installed by R CMD
> > INSTALL of course).
> >
> > Martin
> >
> >     Duncan> Currently R has 3 types of help: the .Rd files in
> >     Duncan> the man directory (which are converted into plain
> >     Duncan> text, HTML, compiled HTML, LaTex, DVI, PDF, etc),
> >     Duncan> the vignettes, and unstructured files in inst/doc.
> >     Duncan> We currently require .Rd files for every function
> >     Duncan> and data object.  Adding a requirement to also
> >     Duncan> document the package that way is not all that much
> >     Duncan> of a burden, and will automatically give all those
> >     Duncan> output formats I listed above.  It will help to
> >     Duncan> solve the often-complained about problem of packages
> >     Duncan> that contain no overview at all.  (Requiring a
> >     Duncan> vignette and giving a way to display it would also
> >     Duncan> do that, but I think requiring a .Rd file is less of
> >     Duncan> a burden, and for anyone who has gone to the trouble
> >     Duncan> of creating a vignette, gives a natural place for a
> >     Duncan> link to it.  Vignettes aren't used as much as they
> >     Duncan> should be, because they are hidden away where users
> >     Duncan> don't see them.)
> >
> >     Duncan> Duncan Murdoch
> >
> >     >>
> >     >> Best wishes,
> >     >> Robert
> >     >>
> >     >>
> >     >>> If we had a way to link vignettes into the help system, then
> >     >I'd think >> it would be perfectly acceptable for ?package to pop
> >     >up a vignette for >> the package.  However, right now we have too
> >     >many different types of >> ways to display help, and not all of
> >     >them are capable of displaying >> vignettes.
> >     >>>
> >     >>> Duncan Murdoch
> >     >>>
> >     >>>
> >     >>>>
> >     >>>> Best wishes
> >     >>>> Robert
> >     >>>>
> >     >>>>> Some packages have so  much material that it's difficult to
> >     >know >>>> where the "meat" of the functionality lies,
> >     >>>>> and Duncan's suggestion would help greatly in these
> >     >circumstances.>>>>
> >     >>>>> best wishes
> >     >>>>>
> >     >>>>> rksh
> >     >>>>>
> >     >>>>>
> >     >>>>> On Jun 7, 2005, at 01:11 pm, Duncan Murdoch wrote:
> >     >>>>>
> > >>>>> Kurt Hornik wrote:
> >     >>>>>>
> >     >>>>>>>>>>>> Henrik Bengtsson writes:
> >     >>>>>>>>
> >     >>>>>>>>
> >     >>>>>>>> Hi,
> >     >>>>>>>> I would like to suggest a standard where all packages
> >     >provide an >>>>>>> Rd page with the same name (or aliased) as the
> >     >name of package so >>>>>>> that help(<package name>) or ?<package
> >     >name> is always here. This >>>>>>> especially of interest to
> >     >large packages with a large package >>>>>>> index. This page
> >     >could explain the package in general and gives >>>>>>> some hints
> >     >on how to start - not like extensive vignettes, but >>>>>>> just
> >     >to get started, e.g. list the "most important" functions.
> >     >>>>>>>> This page could typically contain information that is in
> >     >the >>>>>>> DESCRIPTION file (which contains valuable information
> >     >hardly every >>>>>>> accessed by a general user), such as who is
> >     >the maintainer, how to >>>>>>> report bugs and so on.
> >     >>>>>>
> >     >>>>>>
> >     >>>>>>
> > >>>>> I think this is a good idea.  One minor problem is that for some
> > >>>>> packages that topic name is already in use for a function (e.g.
> > >>>>> boot). For that reason, I'd suggest that there *also* be an
> > >alias >>>> called "package.<package name>", and the <package name>
> > >topic should >>>> link to it.
> >     >>>>>>
> >     >>>>>>> How would this be different from the results of
> >     >>>>>>> help(package = <package name>)
> >     >>>>>>> ?
> >     >>>>>>
> >     >>>>>>
> >     >>>>>>
> >     >>>>>>
> > >>>>> 1.  It would work with ?, like other help topics.
> >     >>>>>>
> > >>>>> 2.  It would give an overview.  It's possible to do that in
> > >>>>> DESCRIPTION or INDEX, but you don't get the same style as for
> > >other >>>> help files (e.g. no links to other topics, at least in
> > >Windows).
> >     >>>>>>
> >     >>>>>>
> >     >>>>>>
> > >>>>> We should work out what the topic headings should be and extend
> > >>>>> package.skeleton() and prompt() to write a bare-bones file that
> > >>>>> suggests the questions that need to be answered in the file.
> > >The >>>> headings I'd suggest are:
> >     >>>>>>
> > >>>>> \name
> > >>>>> \title
> > >>>>> \alias
> > >>>>> \description (longer than the typical entry in the DESCRIPTION
> > >file)>>>> \details (Should give a short guide to the main functions,
> > >should >>>> point out the existence of external documentation like
> > >vignettes, etc.)>>>> \author (could also describe maintainer, if
> > >different)>>>> \references
> > >>>>> \seealso (Should give references to related packages)
> > >>>>> \examples
> > >>>>> \keywords
> >
> > >>>>> There is some duplication of material from DESCRIPTION, but
> > >usually >>>> this should be longer and more reader-friendly than that
> > >file.
> >
> > and as mentioned above, an improved package.skeleton() function
> > could auto-generate both of them anyway.
> >
> > >>>>> I'd be happy to write the description of this in R Extensions,
> > >and >>>> write the changes to prompt(), if we have agreement that
> > >this file >>>> should be mandatory in 2.2.x or 2.3.x, and you'll
> > >write the checks >>>> for it.  (I think the check should just be for
> > >existence of aliases >>>> <package name> and package.<package name>,
> > >and could perhaps just >>>> give a warning in 2.2.x.)
> >
> > ______________________________________________
> > R-devel@stat.math.ethz.ch mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-devel
> >
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

From ripley at stats.ox.ac.uk  Tue Jun  7 19:47:20 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue Jun  7 19:47:32 2005
Subject: [Rd] Suggestion: help(<package name>)
In-Reply-To: <42A5D279.3010501@fhcrc.org>
References: <42A57F5D.7080505@maths.lth.se>
	<17061.32946.976628.961120@beren.wu-wien.ac.at>
	<42A58EDF.80701@stats.uwo.ca>
	<1f269abbabca01e19ee3cdbabc9d14f6@soc.soton.ac.uk>
	<42A5B96B.9030701@fhcrc.org> <42A5BB9D.3000301@stats.uwo.ca>
	<42A5C465.3090505@fhcrc.org> <42A5C789.3060101@stats.uwo.ca>
	<42A5D279.3010501@fhcrc.org>
Message-ID: <Pine.LNX.4.61.0506071823460.5947@gannet.stats>

I share Robert's `pretty strenuous' objections.

Adding compulsory things for package writers seems to me to need very 
compelling arguments.  Checking that a package does what it says (e.g. the 
code in vignettes can be run) is one thing, but checking it does things it 
does not say it wants to do is quite another.

On Tue, 7 Jun 2005, Robert Gentleman wrote:

> Duncan Murdoch wrote:
>> On 6/7/2005 11:59 AM, Robert Gentleman wrote:
>> 
>>> 
>>> Duncan Murdoch wrote:
>>> 
>>>> On 6/7/2005 11:12 AM, Robert Gentleman wrote:
>>>> 
>>>>> 
>>>>> Robin Hankin wrote:
>>>>> 
>>>>>> My 0.02:
>>>>>> 
>>>>>> I use Misc.Rd for the purpose that Duncan suggests.  I put things like 
>>>>>> details and rationale for package
>>>>>> organization, pointers to the most important function(s) in the 
>>>>>> package,  and perhaps function descriptors
>>>>>> for ubiquitous functions that don't warrant their own helppage, but 
>>>>>> need documentation [in
>>>>>> the case of gsl, this would be strictify() and process.args(), which 
>>>>>> every user needs to know].
>>>>>> 
>>>>>> It would be *great* to be required to put in "package.gsl.R"  (or 
>>>>>> should that be "gsl.package.Rd"?)
>>>>>> for this purpose.  Then maybe R CMD check could check for its presence 
>>>>>> and throw a wobbly
>>>>>> if it isn't there.
>>>>>> 
>>>>> 
>>>>> Hi,
>>>>>   Well, I pretty strenuously object. That is just what vignettes are for 
>>>>> and the last thing I need is more wobbly's from R CMD check.
>>>>> 
>>>>> Function documentation should document functions. If you want to 
>>>>> document something more substantial then please use the tools already 
>>>>> provided to do that - and if you don't want to, and you want to make use 
>>>>> of the tools for function documentation in some other way please don't 
>>>>> try to impose your version of what should happen on others.
>>>> 
>>>> 
>>>> 
>>>> The current .Rd files don't just document functions, they also document 
>>>> data objects and classes.
>>>> 
>>>> But the main point here is that it's not good to have multiple 
>>>> disconnected sets of documentation for a package.  Users should be able 
>>>> to say the equivalent of "give me help on foo", and get help on foo, 
>>>> whether it's a function, a data object, a package, a method, a class, or 
>>>> whatever.  It's a bad design to force them to ask for the same sort of 
>>>> thing in different ways depending on the type of thing they're asking 
>>>> for.
>>>> 
>>> 
>>> Hi Duncan and others,
>>>    I think they are linked. There are tools available both in R and in 
>>> Bioconductor and some pop things up and some don't. It doesn't take much 
>>> work to add vignettes to the windows menu bar - as we have done in BioC 
>>> for some time now - it would be nice if this was part of R, but no one 
>>> seems to have been interested in achieving that. Fixing the help system to 
>>> deal with more diverse kinds of help would be nice as well - but taking 
>>> one part of it and saying, "now everyone must do it this way" is not that 
>>> helpful.
>>> 
>>>   I respectfully disagree about the main point. My main point is, I don't 
>>> want more things imposed on me; dealing with  R CMD check is enough of a 
>>> burden in its current version, without someone deciding that it would be 
>>> nice to have a whole bunch more requirements. Folks should feel entirely 
>>> free to do what they want - but a little less free to tell me what I 
>>> should be doing.
>> 
>> 
>> And I disagree pretty strenuously about that.  One of the strengths of R is 
>> that it does impose standards on contributed packages, and these make them 
>> easier to use, less likely to conflict with each other, and so on.
>> 
>> We shouldn't impose things lightly, but if they do make packages better, we 
>> should feel no reason not to tell you what you should be doing.
>> 
> Let's see, some of us (three years ago) developed a tool to solve this 
> problem. We made it available to others to use as they saw fit. I feel no 
> less strong than you do, but I certainly did not impose what I thought on you 
> and I ask for the same respect. We have already solved this problem in our 
> own way. You now seem to think that it is zero cost to impose on us a second 
> (and in my view inferior solution). I am asking that you not do that. Please, 
> feel free to develop what you want and to encourage others to use it, but 
> don't try to make people do things just because you want them that way.
> We have lots of packages in BioC the costs of reengineering so we can meet 
> your newly imposed standards are not zero. I think we have an expectation 
> that such capricious behaviour will not be entered in to, and if we don't 
> then perhaps it is time to branch the project.
>
> Best wishes,
>   Robert
>
>> Currently R has 3 types of help:  the .Rd files in the man directory (which 
>> are converted into plain text, HTML, compiled HTML, LaTex, DVI, PDF, etc), 
>> the vignettes, and unstructured files in inst/doc.  We currently require 
>> .Rd files for every function and data object.  Adding a requirement to also 
>> document the package that way is not all that much of a burden, and will 
>> automatically give all those output formats I listed above.  It will help 
>> to solve the often-complained about problem   of packages that contain no 
>> overview at all.  (Requiring a vignette and giving a way to display it 
>> would also do that, but I think requiring a .Rd file is less of a burden, 
>> and for anyone who has gone to the trouble of creating a vignette, gives a 
>> natural place for a link to it.  Vignettes aren't used as much as they 
>> should be,  because they are hidden away where users don't see them.)
>> 
>> Duncan Murdoch
>> 
>>> 
>>>   Best wishes,
>>>     Robert
>>> 
>>> 
>>>> If we had a way to link vignettes into the help system, then I'd think it 
>>>> would be perfectly acceptable for ?package to pop up a vignette for the 
>>>> package.  However, right now we have too many different types of ways to 
>>>> display help, and not all of them are capable of displaying vignettes.
>>>> 
>>>> Duncan Murdoch
>>>> 
>>>> 
>>>>> 
>>>>> Best wishes
>>>>>    Robert
>>>>> 
>>>>>> Some packages have so  much material that it's difficult to know where 
>>>>>> the "meat" of the functionality lies,
>>>>>> and Duncan's suggestion would help greatly in these circumstances.
>>>>>> 
>>>>>> best wishes
>>>>>> 
>>>>>> rksh
>>>>>> 
>>>>>> 
>>>>>> On Jun 7, 2005, at 01:11 pm, Duncan Murdoch wrote:
>>>>>> 
>>>>>>> Kurt Hornik wrote:
>>>>>>> 
>>>>>>>>>>>>> Henrik Bengtsson writes:
>>>>>>>>> 
>>>>>>>>> 
>>>>>>>>> 
>>>>>>>>> Hi,
>>>>>>>>> I would like to suggest a standard where all packages provide an Rd 
>>>>>>>>> page with the same name (or aliased) as the name of package so that 
>>>>>>>>> help(<package name>) or ?<package name> is always here. This 
>>>>>>>>> especially of interest to large packages with a large package index. 
>>>>>>>>> This page could explain the package in general and gives some hints 
>>>>>>>>> on how to start - not like extensive vignettes, but just to get 
>>>>>>>>> started, e.g. list the "most important" functions.  This page could 
>>>>>>>>> typically contain information that is in the DESCRIPTION file (which 
>>>>>>>>> contains valuable information hardly every accessed by a general 
>>>>>>>>> user), such as who is the maintainer, how to report bugs and so on.
>>>>>>> 
>>>>>>> 
>>>>>>> 
>>>>>>> 
>>>>>>> I think this is a good idea.  One minor problem is that for some 
>>>>>>> packages that topic name is already in use for a function (e.g. boot). 
>>>>>>> For that reason, I'd suggest that there *also* be an alias called 
>>>>>>> "package.<package name>", and the <package name> topic should link to 
>>>>>>> it.
>>>>>>> 
>>>>>>>> How would this be different from the results of
>>>>>>>>     help(package = <package name>)
>>>>>>>> ?
>>>>>>> 
>>>>>>> 
>>>>>>> 
>>>>>>> 
>>>>>>> 
>>>>>>> 1.  It would work with ?, like other help topics.
>>>>>>> 
>>>>>>> 2.  It would give an overview.  It's possible to do that in 
>>>>>>> DESCRIPTION or INDEX, but you don't get the same style as for other 
>>>>>>> help files (e.g. no links to other topics, at least in Windows).
>>>>>>> 
>>>>>>> 
>>>>>>> 
>>>>>>> We should work out what the topic headings should be and extend 
>>>>>>> package.skeleton() and prompt() to write a bare-bones file that 
>>>>>>> suggests the questions that need to be answered in the file.  The 
>>>>>>> headings I'd suggest are:
>>>>>>> 
>>>>>>> \name
>>>>>>> \title
>>>>>>> \alias
>>>>>>> \description (longer than the typical entry in the DESCRIPTION file)
>>>>>>> \details (Should give a short guide to the main functions, should 
>>>>>>> point out the existence of external documentation like vignettes, 
>>>>>>> etc.)
>>>>>>> \author (could also describe maintainer, if different)
>>>>>>> \references
>>>>>>> \seealso (Should give references to related packages)
>>>>>>> \examples
>>>>>>> \keywords
>>>>>>> 
>>>>>>> There is some duplication of material from DESCRIPTION, but usually 
>>>>>>> this should be longer and more reader-friendly than that file.
>>>>>>> 
>>>>>>> I'd be happy to write the description of this in R Extensions, and 
>>>>>>> write the changes to prompt(), if we have agreement that this file 
>>>>>>> should be mandatory in 2.2.x or 2.3.x, and you'll write the checks for 
>>>>>>> it.  (I think the check should just be for existence of aliases 
>>>>>>> <package name> and package.<package name>, and could perhaps just give 
>>>>>>> a warning in 2.2.x.)
>>>>>>> 
>>>>>>> Duncan Murdoch
>>>>>>> 
>>>>>>> ______________________________________________
>>>>>>> R-devel@stat.math.ethz.ch mailing list
>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>>> 
>>>>>>> 
>>>>>> -- 
>>>>>> Robin Hankin
>>>>>> Uncertainty Analyst
>>>>>> National Oceanography Centre, Southampton
>>>>>> European Way, Southampton SO14 3ZH, UK
>>>>>>  tel  023-8059-7743
>>>>>> 
>>>>>> ______________________________________________
>>>>>> R-devel@stat.math.ethz.ch mailing list
>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>> 
>>>> 
>>> 
>>> ______________________________________________
>>> R-devel@stat.math.ethz.ch mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>> 
>> 
>> ______________________________________________
>> R-devel@stat.math.ethz.ch mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>> 
>
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From simon.urbanek at r-project.org  Tue Jun  7 19:52:49 2005
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Tue Jun  7 19:52:59 2005
Subject: [Rd] alloca() on FreeBSD (PR#7890)
In-Reply-To: <42A5CD05.3080507@gwdg.de>
References: <20050606112426.3827BA3C4@slim.kubism.ku.dk>
	<42A5CD05.3080507@gwdg.de>
Message-ID: <0BBF2A4E-9FB6-4C92-88A8-2F5D5AC96D18@r-project.org>

On Jun 7, 2005, at 12:36 PM, Rainer Hurling wrote:

> One first reaction to your suggestions.
>
> ripley@stats.ox.ac.uk wrote:
>
>> On Mon, 23 May 2005 vangyzen@stat.duke.edu wrote:
>>
>>> R-2.1.0 fails to compile on the newest release of FreeBSD,  
>>> complaining about
>>> undefined references to __builtin_alloca.  On FreeBSD, alloca()  
>>> is declared in
>>> stdlib.h, not alloca.h as the R sources expect.  Therefore,  
>>> HAVE_DECL_ALLOCA
>>> does not get set, so the R sources declare alloca() after it has  
>>> already been
>>> #defined by stdlib.h.
>>>
>>> A possible fix is to modify the configure script to look for the  
>>> declaration of
>>> alloca() in stdlib.h (perhaps after it fails to find it in  
>>> alloca.h).
>>>
>> It is already supposed to, so it is not finding the declaration  
>> there either. If you look up the definition of
>> AC_CHECK_DECLS([alloca], , , [#include <alloca.h>])
>> it searches in stdlib.h.  Can you please send us the appropriate  
>> part of config.log?  It may be that this is failing because  
>> alloca.h is not found
>> (but AC_FUNC_ALLOCA is making the same assumptions).
>> Perhaps the easiest way out is to override the setting on FreeBSD:  
>> can you please confirm that manually changing
>> #define HAVE_DECL_ALLOCA 1
>> in config.h works?
>>
>
> Changing "#define HAVE_DECL_ALLOCA" to 1
> in line 81 of R-2.1.0/src/include/config.h
> gives me the following stopping:
>
>
> mkdir ../../../../library/grDevices/libs
> building package 'graphics'
> mkdir ../../../library/graphics
> mkdir ../../../library/graphics/R
> mkdir ../../../library/graphics/demo
> mkdir ../../../library/graphics/po
> mkdir ../../../library/graphics/man
> Error in dyn.load(x, as.logical(local), as.logical(now)) :
>         unable to load shared library '/usr/local/R-2.1.0/library/ 
> grDevices/libs/grDevices.so':
>   /usr/local/R-2.1.0/library/grDevices/libs/grDevices.so: Undefined  
> symbol "__builtin_alloca"
> Execution halted

Did you run a new, clean build? From the output it seems as if you  
just changed the file in your old build and typed make - obviously  
that doesn't help at all, because the setting must the changed  
*before* you start building. So if you didn't do so, please remove  
the build, unpack the sources again, run configure, change the ALLOCA  
define and then build.

Cheers,
Simon

From rhurlin at gwdg.de  Tue Jun  7 22:30:03 2005
From: rhurlin at gwdg.de (Rainer Hurling)
Date: Tue Jun  7 22:30:43 2005
Subject: [Rd] alloca() on FreeBSD (PR#7890)
In-Reply-To: <0BBF2A4E-9FB6-4C92-88A8-2F5D5AC96D18@r-project.org>
References: <20050606112426.3827BA3C4@slim.kubism.ku.dk>
	<42A5CD05.3080507@gwdg.de>
	<0BBF2A4E-9FB6-4C92-88A8-2F5D5AC96D18@r-project.org>
Message-ID: <42A603CB.1040509@gwdg.de>

Simon Urbanek wrote:
> On Jun 7, 2005, at 12:36 PM, Rainer Hurling wrote:
> 
>> One first reaction to your suggestions.
>>
>> ripley@stats.ox.ac.uk wrote:
>>
>>> On Mon, 23 May 2005 vangyzen@stat.duke.edu wrote:
>>>
>>>> R-2.1.0 fails to compile on the newest release of FreeBSD,  
>>>> complaining about
>>>> undefined references to __builtin_alloca.  On FreeBSD, alloca()  is 
>>>> declared in
>>>> stdlib.h, not alloca.h as the R sources expect.  Therefore,  
>>>> HAVE_DECL_ALLOCA
>>>> does not get set, so the R sources declare alloca() after it has  
>>>> already been
>>>> #defined by stdlib.h.
>>>>
>>>> A possible fix is to modify the configure script to look for the  
>>>> declaration of
>>>> alloca() in stdlib.h (perhaps after it fails to find it in  alloca.h).
>>>>
>>> It is already supposed to, so it is not finding the declaration  
>>> there either. If you look up the definition of
>>> AC_CHECK_DECLS([alloca], , , [#include <alloca.h>])
>>> it searches in stdlib.h.  Can you please send us the appropriate  
>>> part of config.log?  It may be that this is failing because  alloca.h 
>>> is not found
>>> (but AC_FUNC_ALLOCA is making the same assumptions).
>>> Perhaps the easiest way out is to override the setting on FreeBSD:  
>>> can you please confirm that manually changing
>>> #define HAVE_DECL_ALLOCA 1
>>> in config.h works?
>>>
>>
>> Changing "#define HAVE_DECL_ALLOCA" to 1
>> in line 81 of R-2.1.0/src/include/config.h
>> gives me the following stopping:
>>
>>
>> mkdir ../../../../library/grDevices/libs
>> building package 'graphics'
>> mkdir ../../../library/graphics
>> mkdir ../../../library/graphics/R
>> mkdir ../../../library/graphics/demo
>> mkdir ../../../library/graphics/po
>> mkdir ../../../library/graphics/man
>> Error in dyn.load(x, as.logical(local), as.logical(now)) :
>>         unable to load shared library '/usr/local/R-2.1.0/library/ 
>> grDevices/libs/grDevices.so':
>>   /usr/local/R-2.1.0/library/grDevices/libs/grDevices.so: Undefined  
>> symbol "__builtin_alloca"
>> Execution halted
> 
> 
> Did you run a new, clean build? From the output it seems as if you  just 
> changed the file in your old build and typed make - obviously  that 
> doesn't help at all, because the setting must the changed  *before* you 
> start building. So if you didn't do so, please remove  the build, unpack 
> the sources again, run configure, change the ALLOCA  define and then build.

Simon,
thank you, but I am absolute sure I made a new, clean built:

1.) untar R-2.1.0.tar.gz
2.) cd R-2.1.0
3.) ./configure
4.) edit src/include/config.h  [#define HAVE_DECL_ALLOCA 1]
5.) make

It seems to me that some files behave not like others in relation to 
alloca.h (resp. stdlib.h)?

Please tell me, if I can help in any way,
Rainer

From ripley at stats.ox.ac.uk  Tue Jun  7 22:52:00 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue Jun  7 22:52:24 2005
Subject: [Rd] alloca() on FreeBSD (PR#7890)
In-Reply-To: <0BBF2A4E-9FB6-4C92-88A8-2F5D5AC96D18@r-project.org>
References: <20050606112426.3827BA3C4@slim.kubism.ku.dk>
	<42A5CD05.3080507@gwdg.de>
	<0BBF2A4E-9FB6-4C92-88A8-2F5D5AC96D18@r-project.org>
Message-ID: <Pine.LNX.4.61.0506072144570.4895@gannet.stats>

This is a package, so it is not using config.h.  It is using

#ifdef HAVE_ALLOCA_H
#include <alloca.h>
#else
extern char *alloca(size_t);
#endif

and hence will have whatever the problem is with having that declaration.

The basic problem is that autoconf assumes that if alloca is defined 
anywhere, it is defined in alloca.h.  So we need to use something other 
than the standard macros.

Is there a macro FreeBSD defines?   If so it may be easiest to just make 
use of it.

On Tue, 7 Jun 2005, Simon Urbanek wrote:

> On Jun 7, 2005, at 12:36 PM, Rainer Hurling wrote:
>
>> One first reaction to your suggestions.
>> 
>> ripley@stats.ox.ac.uk wrote:
>> 
>>> On Mon, 23 May 2005 vangyzen@stat.duke.edu wrote:
>>> 
>>>> R-2.1.0 fails to compile on the newest release of FreeBSD, complaining 
>>>> about
>>>> undefined references to __builtin_alloca.  On FreeBSD, alloca() is 
>>>> declared in
>>>> stdlib.h, not alloca.h as the R sources expect.  Therefore, 
>>>> HAVE_DECL_ALLOCA
>>>> does not get set, so the R sources declare alloca() after it has already 
>>>> been
>>>> #defined by stdlib.h.
>>>> 
>>>> A possible fix is to modify the configure script to look for the 
>>>> declaration of
>>>> alloca() in stdlib.h (perhaps after it fails to find it in alloca.h).
>>>> 
>>> It is already supposed to, so it is not finding the declaration there 
>>> either. If you look up the definition of
>>> AC_CHECK_DECLS([alloca], , , [#include <alloca.h>])
>>> it searches in stdlib.h.  Can you please send us the appropriate part of 
>>> config.log?  It may be that this is failing because alloca.h is not found
>>> (but AC_FUNC_ALLOCA is making the same assumptions).
>>> Perhaps the easiest way out is to override the setting on FreeBSD: can you 
>>> please confirm that manually changing
>>> #define HAVE_DECL_ALLOCA 1
>>> in config.h works?
>>> 
>> 
>> Changing "#define HAVE_DECL_ALLOCA" to 1
>> in line 81 of R-2.1.0/src/include/config.h
>> gives me the following stopping:
>> 
>> 
>> mkdir ../../../../library/grDevices/libs
>> building package 'graphics'
>> mkdir ../../../library/graphics
>> mkdir ../../../library/graphics/R
>> mkdir ../../../library/graphics/demo
>> mkdir ../../../library/graphics/po
>> mkdir ../../../library/graphics/man
>> Error in dyn.load(x, as.logical(local), as.logical(now)) :
>>         unable to load shared library '/usr/local/R-2.1.0/library/ 
>> grDevices/libs/grDevices.so':
>>   /usr/local/R-2.1.0/library/grDevices/libs/grDevices.so: Undefined symbol 
>> "__builtin_alloca"
>> Execution halted
>
> Did you run a new, clean build? From the output it seems as if you just 
> changed the file in your old build and typed make - obviously that doesn't 
> help at all, because the setting must the changed *before* you start 
> building. So if you didn't do so, please remove the build, unpack the sources 
> again, run configure, change the ALLOCA define and then build.
>
> Cheers,
> Simon
>
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From p.murrell at auckland.ac.nz  Tue Jun  7 23:34:55 2005
From: p.murrell at auckland.ac.nz (Paul Murrell)
Date: Tue Jun  7 23:34:54 2005
Subject: [Rd] Re: [R] Problem going back to a viewport with gridBase
References: <971536df05053020191ebe8f44@mail.gmail.com>	
	<429CEA59.7020206@stat.auckland.ac.nz>	
	<971536df050531163353031d97@mail.gmail.com>	
	<429CFA42.4080106@stat.auckland.ac.nz>	
	<971536df05053118215366e02c@mail.gmail.com>	
	<429E5BFD.9080508@stat.auckland.ac.nz>	
	<971536df050602140356cc80b4@mail.gmail.com>	
	<429FB4AE.5030105@stat.auckland.ac.nz>	
	<971536df0506030554396c2374@mail.gmail.com>	
	<42A4D286.5090208@stat.auckland.ac.nz>
	<971536df0506061924438870f0@mail.gmail.com>
Message-ID: <42A612FF.5020408@stat.auckland.ac.nz>

Hi


Gabor Grothendieck wrote:
> On 6/6/05, Paul Murrell <p.murrell@auckland.ac.nz> wrote:
> 
>>Hi
>>
>>
>>Gabor Grothendieck wrote:
>>
>>>On 6/2/05, Paul Murrell <p.murrell@auckland.ac.nz> wrote:
>>>
>>>
>>>>Hi
>>>
>>>
>>>Thanks.  I have mucked around in vpTree structures and discovered its
>>>actually quite easy to specify children so I have changed my example
>>>so that instead of naming the children of 'layout' and then remembering
>>>coordinates linked to the names of the children of 'layout' in
>>>the 'coords' structure (which really just duplicates state information
>>>already available in grid) it simply follows the order
>>>of the children of 'layout' directly.  This permits elimination of 'coords'
>>>and the two naming functions.  Using the depth approach you advocate,
>>>'with' also becomes shorter and I think I have it to the point where it works
>>>with both vpPath and viewport classes.  Once Deepayan implements
>>>the use.viewport= argument to print, 'with' can be eliminated too.  No
>>>questions this time but I thought I would post the latest version for
>>>completeness. Regards.
>>
>>
>>Ok.  I can see this working ... for now.  The disadvantage with this
>>approach is that it makes use of the undocumented, internal structure of
>>a viewport tree to grab a list of child viewports.  A worse example of
>>the same thing is that the with() methods make use of a happy
>>coincidence that both viewport objects and viewport path objects share a
>>component called "name" (and an even happier coincidence that they
>>contain the same information).  I think it would be cleaner and better
>>practice, despite requiring longer code, to make use of the documented
>>interface which requires specifying viewport names and viewport paths.
>>The internal structure of objects is not guaranteed to be stable.
> 
> 
> Perhaps accessor functions could be provided that allow one to 
> retrieve the name of a viewport and the name of a vpPath in 
> a safe way.  These could be as simple as:
> 
> names.viewport <- names.vpPath <- function(x) x$name


Fair enough.  If I say "use the API", I should provide a useful API :)

This is a reasonable request for viewports;  the "name" component of a 
viewport is a sensible thing to want.

OTOH, it is not necessarily reasonable for a viewport path;  not all 
components of an object should necessarily have accessors.  The "name" 
component of a viewport path is the last element in the path.  Perhaps 
an API should be supplied for extracting parts of a viewport path, but 
it should probably be something along the lines of car()/cdr() or 
head()/tail() or explode() to get different bits of the path.

Accessing the children of a viewport is subtly problematic too. 
Directly accessing the "children" slot and using the order of the 
children in that slot is "dangerous" because there is no claim made by 
the system as to how the children are internally ordered.  Again, it 
works currently, but it makes incorrect assumptions about what the 
system is doing internally so is vulnerable to future changes.

So again, the recommended approach is to use the API provided;  you 
provide the naming scheme for viewports and you control the order in 
which viewports are used.

Paul


> Similarly an accessor function to safely retrieve the children would 
> be nice.    Again, it should ideally be possible to
> have a generic with methods for various grid classes.
> 
> Then the  relevant line in the code concerning name
> could be written in a safe way like this:
> 
> depth <- if (data$name == "ROOT") 0 else downViewport(names(data))
> 
> and similarly for the children.
> 
> 
> 
>>Paul
>>
>>
>>
>>>[pushLayout is same as before except there are no names on the
>>>children of 'layout' and the rest is new]
>>>
>>>library(grid)
>>>library(lattice)
>>>
>>>pushLayout <- function(nr, nc, name="layout") {
>>>  pushViewport(viewport(layout=grid.layout(nr, nc), name=name))
>>>  for (i in 1:nr) {
>>>    for (j in 1:nc) {
>>>      pushViewport(viewport(layout.pos.row=i, layout.pos.col=j))
>>>      upViewport()
>>>    }
>>>  }
>>>  upViewport()
>>>}
>>>
>>>with.vpPath <- with.viewport <- function(data, expr, ...) {
>>>      # if data is a vpPath it cannot be ROOT since NULL will never
>>>dispatch here
>>>      depth <- if (data$name == "ROOT") 0 else downViewport(data$name)
>>>      result <- eval.parent(substitute(expr))
>>>      upViewport(depth)
>>>      invisible(result)
>>>}
>>>
>>>grid.newpage()
>>>
>>># specify number of cells to fill and number of rows
>>>n <- 5; nr <- 3
>>>
>>>nc <- ceiling(n/nr)
>>>downViewport(pushLayout(nr, nc))
>>>
>>>vpt <- current.vpTree(all = FALSE)
>>>for(k in 1:n) with(vpt$children[[k]],
>>>      print( xyplot(v ~ v, list(v = 1:k)), newpage = FALSE )
>>>)
>>
>>
>>--
>>Dr Paul Murrell
>>Department of Statistics
>>The University of Auckland
>>Private Bag 92019
>>Auckland
>>New Zealand
>>64 9 3737599 x85392
>>paul@stat.auckland.ac.nz
>>http://www.stat.auckland.ac.nz/~paul/
>>
> 
>>


-- 
Dr Paul Murrell
Department of Statistics
The University of Auckland
Private Bag 92019
Auckland
New Zealand
64 9 3737599 x85392
paul@stat.auckland.ac.nz
http://www.stat.auckland.ac.nz/~paul/

From ggrothendieck at gmail.com  Wed Jun  8 03:37:00 2005
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Wed Jun  8 03:37:53 2005
Subject: [Rd] Re: [R] Problem going back to a viewport with gridBase
In-Reply-To: <42A612FF.5020408@stat.auckland.ac.nz>
References: <971536df05053020191ebe8f44@mail.gmail.com>
	<429CFA42.4080106@stat.auckland.ac.nz>
	<971536df05053118215366e02c@mail.gmail.com>
	<429E5BFD.9080508@stat.auckland.ac.nz>
	<971536df050602140356cc80b4@mail.gmail.com>
	<429FB4AE.5030105@stat.auckland.ac.nz>
	<971536df0506030554396c2374@mail.gmail.com>
	<42A4D286.5090208@stat.auckland.ac.nz>
	<971536df0506061924438870f0@mail.gmail.com>
	<42A612FF.5020408@stat.auckland.ac.nz>
Message-ID: <971536df05060718376e609133@mail.gmail.com>

On 6/7/05, Paul Murrell <p.murrell@auckland.ac.nz> wrote:
> Hi
> 
> 
> Gabor Grothendieck wrote:
> > On 6/6/05, Paul Murrell <p.murrell@auckland.ac.nz> wrote:
> >
> >>Hi
> >>
> >>
> >>Gabor Grothendieck wrote:
> >>
> >>>On 6/2/05, Paul Murrell <p.murrell@auckland.ac.nz> wrote:
> >>>
> >>>
> >>>>Hi
> >>>
> >>>
> >>>Thanks.  I have mucked around in vpTree structures and discovered its
> >>>actually quite easy to specify children so I have changed my example
> >>>so that instead of naming the children of 'layout' and then remembering
> >>>coordinates linked to the names of the children of 'layout' in
> >>>the 'coords' structure (which really just duplicates state information
> >>>already available in grid) it simply follows the order
> >>>of the children of 'layout' directly.  This permits elimination of 'coords'
> >>>and the two naming functions.  Using the depth approach you advocate,
> >>>'with' also becomes shorter and I think I have it to the point where it works
> >>>with both vpPath and viewport classes.  Once Deepayan implements
> >>>the use.viewport= argument to print, 'with' can be eliminated too.  No
> >>>questions this time but I thought I would post the latest version for
> >>>completeness. Regards.
> >>
> >>
> >>Ok.  I can see this working ... for now.  The disadvantage with this
> >>approach is that it makes use of the undocumented, internal structure of
> >>a viewport tree to grab a list of child viewports.  A worse example of
> >>the same thing is that the with() methods make use of a happy
> >>coincidence that both viewport objects and viewport path objects share a
> >>component called "name" (and an even happier coincidence that they
> >>contain the same information).  I think it would be cleaner and better
> >>practice, despite requiring longer code, to make use of the documented
> >>interface which requires specifying viewport names and viewport paths.
> >>The internal structure of objects is not guaranteed to be stable.
> >
> >
> > Perhaps accessor functions could be provided that allow one to
> > retrieve the name of a viewport and the name of a vpPath in
> > a safe way.  These could be as simple as:
> >
> > names.viewport <- names.vpPath <- function(x) x$name
> 
> 
> Fair enough.  If I say "use the API", I should provide a useful API :)
> 
> This is a reasonable request for viewports;  the "name" component of a
> viewport is a sensible thing to want.
> 
> OTOH, it is not necessarily reasonable for a viewport path;  not all
> components of an object should necessarily have accessors.  The "name"
> component of a viewport path is the last element in the path.  Perhaps
> an API should be supplied for extracting parts of a viewport path, but
> it should probably be something along the lines of car()/cdr() or
> head()/tail() or explode() to get different bits of the path.
> 
> Accessing the children of a viewport is subtly problematic too.
> Directly accessing the "children" slot and using the order of the
> children in that slot is "dangerous" because there is no claim made by
> the system as to how the children are internally ordered.  Again, it
> works currently, but it makes incorrect assumptions about what the
> system is doing internally so is vulnerable to future changes.

That is the point of an accessor.  If the internals change then the
accessor is modified to hide the change so that the user using the
accessor is not impacted.  

It seems that grid already partly supports this with the childNames
function.  It could be made generic and a method provided
to cover the classes discussed here too.

> 
> So again, the recommended approach is to use the API provided;  you
> provide the naming scheme for viewports and you control the order in
> which viewports are used.
> 
> Paul
> 
> 
> > Similarly an accessor function to safely retrieve the children would
> > be nice.    Again, it should ideally be possible to
> > have a generic with methods for various grid classes.
> >
> > Then the  relevant line in the code concerning name
> > could be written in a safe way like this:
> >
> > depth <- if (data$name == "ROOT") 0 else downViewport(names(data))
> >
> > and similarly for the children.
> >
> >
> >
> >>Paul
> >>
> >>
> >>
> >>>[pushLayout is same as before except there are no names on the
> >>>children of 'layout' and the rest is new]
> >>>
> >>>library(grid)
> >>>library(lattice)
> >>>
> >>>pushLayout <- function(nr, nc, name="layout") {
> >>>  pushViewport(viewport(layout=grid.layout(nr, nc), name=name))
> >>>  for (i in 1:nr) {
> >>>    for (j in 1:nc) {
> >>>      pushViewport(viewport(layout.pos.row=i, layout.pos.col=j))
> >>>      upViewport()
> >>>    }
> >>>  }
> >>>  upViewport()
> >>>}
> >>>
> >>>with.vpPath <- with.viewport <- function(data, expr, ...) {
> >>>      # if data is a vpPath it cannot be ROOT since NULL will never
> >>>dispatch here
> >>>      depth <- if (data$name == "ROOT") 0 else downViewport(data$name)
> >>>      result <- eval.parent(substitute(expr))
> >>>      upViewport(depth)
> >>>      invisible(result)
> >>>}
> >>>
> >>>grid.newpage()
> >>>
> >>># specify number of cells to fill and number of rows
> >>>n <- 5; nr <- 3
> >>>
> >>>nc <- ceiling(n/nr)
> >>>downViewport(pushLayout(nr, nc))
> >>>
> >>>vpt <- current.vpTree(all = FALSE)
> >>>for(k in 1:n) with(vpt$children[[k]],
> >>>      print( xyplot(v ~ v, list(v = 1:k)), newpage = FALSE )
> >>>)
> >>
> >>
> >>--
> >>Dr Paul Murrell
> >>Department of Statistics
> >>The University of Auckland
> >>Private Bag 92019
> >>Auckland
> >>New Zealand
> >>64 9 3737599 x85392
> >>paul@stat.auckland.ac.nz
> >>http://www.stat.auckland.ac.nz/~paul/
> >>
> >
> >>
> 
> 
> --
> Dr Paul Murrell
> Department of Statistics
> The University of Auckland
> Private Bag 92019
> Auckland
> New Zealand
> 64 9 3737599 x85392
> paul@stat.auckland.ac.nz
> http://www.stat.auckland.ac.nz/~paul/
> 
>

From p.murrell at auckland.ac.nz  Wed Jun  8 03:47:27 2005
From: p.murrell at auckland.ac.nz (Paul Murrell)
Date: Wed Jun  8 03:47:38 2005
Subject: [Rd] Re: [R] Problem going back to a viewport with gridBase
References: <971536df05053020191ebe8f44@mail.gmail.com>	
	<429CFA42.4080106@stat.auckland.ac.nz>	
	<971536df05053118215366e02c@mail.gmail.com>	
	<429E5BFD.9080508@stat.auckland.ac.nz>	
	<971536df050602140356cc80b4@mail.gmail.com>	
	<429FB4AE.5030105@stat.auckland.ac.nz>	
	<971536df0506030554396c2374@mail.gmail.com>	
	<42A4D286.5090208@stat.auckland.ac.nz>	
	<971536df0506061924438870f0@mail.gmail.com>	
	<42A612FF.5020408@stat.auckland.ac.nz>
	<971536df05060718376e609133@mail.gmail.com>
Message-ID: <42A64E2F.7030707@stat.auckland.ac.nz>

Hi


Gabor Grothendieck wrote:
> On 6/7/05, Paul Murrell <p.murrell@auckland.ac.nz> wrote:
> 
>>Hi
>>
>>
>>Gabor Grothendieck wrote:
>>
>>>On 6/6/05, Paul Murrell <p.murrell@auckland.ac.nz> wrote:
>>>
>>>
>>>>Hi
>>>>
>>>>
>>>>Gabor Grothendieck wrote:
>>>>
>>>>
>>>>>On 6/2/05, Paul Murrell <p.murrell@auckland.ac.nz> wrote:
>>>>>
>>>>>
>>>>>
>>>>>>Hi
>>>>>
>>>>>
>>>>>Thanks.  I have mucked around in vpTree structures and discovered its
>>>>>actually quite easy to specify children so I have changed my example
>>>>>so that instead of naming the children of 'layout' and then remembering
>>>>>coordinates linked to the names of the children of 'layout' in
>>>>>the 'coords' structure (which really just duplicates state information
>>>>>already available in grid) it simply follows the order
>>>>>of the children of 'layout' directly.  This permits elimination of 'coords'
>>>>>and the two naming functions.  Using the depth approach you advocate,
>>>>>'with' also becomes shorter and I think I have it to the point where it works
>>>>>with both vpPath and viewport classes.  Once Deepayan implements
>>>>>the use.viewport= argument to print, 'with' can be eliminated too.  No
>>>>>questions this time but I thought I would post the latest version for
>>>>>completeness. Regards.
>>>>
>>>>
>>>>Ok.  I can see this working ... for now.  The disadvantage with this
>>>>approach is that it makes use of the undocumented, internal structure of
>>>>a viewport tree to grab a list of child viewports.  A worse example of
>>>>the same thing is that the with() methods make use of a happy
>>>>coincidence that both viewport objects and viewport path objects share a
>>>>component called "name" (and an even happier coincidence that they
>>>>contain the same information).  I think it would be cleaner and better
>>>>practice, despite requiring longer code, to make use of the documented
>>>>interface which requires specifying viewport names and viewport paths.
>>>>The internal structure of objects is not guaranteed to be stable.
>>>
>>>
>>>Perhaps accessor functions could be provided that allow one to
>>>retrieve the name of a viewport and the name of a vpPath in
>>>a safe way.  These could be as simple as:
>>>
>>>names.viewport <- names.vpPath <- function(x) x$name
>>
>>
>>Fair enough.  If I say "use the API", I should provide a useful API :)
>>
>>This is a reasonable request for viewports;  the "name" component of a
>>viewport is a sensible thing to want.
>>
>>OTOH, it is not necessarily reasonable for a viewport path;  not all
>>components of an object should necessarily have accessors.  The "name"
>>component of a viewport path is the last element in the path.  Perhaps
>>an API should be supplied for extracting parts of a viewport path, but
>>it should probably be something along the lines of car()/cdr() or
>>head()/tail() or explode() to get different bits of the path.
>>
>>Accessing the children of a viewport is subtly problematic too.
>>Directly accessing the "children" slot and using the order of the
>>children in that slot is "dangerous" because there is no claim made by
>>the system as to how the children are internally ordered.  Again, it
>>works currently, but it makes incorrect assumptions about what the
>>system is doing internally so is vulnerable to future changes.
> 
> 
> That is the point of an accessor.  If the internals change then the
> accessor is modified to hide the change so that the user using the
> accessor is not impacted.  
> 
> It seems that grid already partly supports this with the childNames
> function.  It could be made generic and a method provided
> to cover the classes discussed here too.


I agree that a childNames() method for a viewport tree is probably 
reasonable.  The subtle problem is the fact that your code makes use of 
the *order* of the names that function would return, when in fact there 
is no claim that they will be in any particular order.

Paul


>>So again, the recommended approach is to use the API provided;  you
>>provide the naming scheme for viewports and you control the order in
>>which viewports are used.
>>
>>Paul
>>
>>
>>
>>>Similarly an accessor function to safely retrieve the children would
>>>be nice.    Again, it should ideally be possible to
>>>have a generic with methods for various grid classes.
>>>
>>>Then the  relevant line in the code concerning name
>>>could be written in a safe way like this:
>>>
>>>depth <- if (data$name == "ROOT") 0 else downViewport(names(data))
>>>
>>>and similarly for the children.
>>>
>>>
>>>
>>>
>>>>Paul
>>>>
>>>>
>>>>
>>>>
>>>>>[pushLayout is same as before except there are no names on the
>>>>>children of 'layout' and the rest is new]
>>>>>
>>>>>library(grid)
>>>>>library(lattice)
>>>>>
>>>>>pushLayout <- function(nr, nc, name="layout") {
>>>>> pushViewport(viewport(layout=grid.layout(nr, nc), name=name))
>>>>> for (i in 1:nr) {
>>>>>   for (j in 1:nc) {
>>>>>     pushViewport(viewport(layout.pos.row=i, layout.pos.col=j))
>>>>>     upViewport()
>>>>>   }
>>>>> }
>>>>> upViewport()
>>>>>}
>>>>>
>>>>>with.vpPath <- with.viewport <- function(data, expr, ...) {
>>>>>     # if data is a vpPath it cannot be ROOT since NULL will never
>>>>>dispatch here
>>>>>     depth <- if (data$name == "ROOT") 0 else downViewport(data$name)
>>>>>     result <- eval.parent(substitute(expr))
>>>>>     upViewport(depth)
>>>>>     invisible(result)
>>>>>}
>>>>>
>>>>>grid.newpage()
>>>>>
>>>>># specify number of cells to fill and number of rows
>>>>>n <- 5; nr <- 3
>>>>>
>>>>>nc <- ceiling(n/nr)
>>>>>downViewport(pushLayout(nr, nc))
>>>>>
>>>>>vpt <- current.vpTree(all = FALSE)
>>>>>for(k in 1:n) with(vpt$children[[k]],
>>>>>     print( xyplot(v ~ v, list(v = 1:k)), newpage = FALSE )
>>>>>)
>>>>
>>>>
>>>>--
>>>>Dr Paul Murrell
>>>>Department of Statistics
>>>>The University of Auckland
>>>>Private Bag 92019
>>>>Auckland
>>>>New Zealand
>>>>64 9 3737599 x85392
>>>>paul@stat.auckland.ac.nz
>>>>http://www.stat.auckland.ac.nz/~paul/
>>>>
>>>
>>
>>--
>>Dr Paul Murrell
>>Department of Statistics
>>The University of Auckland
>>Private Bag 92019
>>Auckland
>>New Zealand
>>64 9 3737599 x85392
>>paul@stat.auckland.ac.nz
>>http://www.stat.auckland.ac.nz/~paul/
>>
> 
>>


-- 
Dr Paul Murrell
Department of Statistics
The University of Auckland
Private Bag 92019
Auckland
New Zealand
64 9 3737599 x85392
paul@stat.auckland.ac.nz
http://www.stat.auckland.ac.nz/~paul/

From ggrothendieck at gmail.com  Wed Jun  8 03:57:14 2005
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Wed Jun  8 03:57:22 2005
Subject: [Rd] Re: [R] Problem going back to a viewport with gridBase
In-Reply-To: <971536df05060718376e609133@mail.gmail.com>
References: <971536df05053020191ebe8f44@mail.gmail.com>
	<971536df05053118215366e02c@mail.gmail.com>
	<429E5BFD.9080508@stat.auckland.ac.nz>
	<971536df050602140356cc80b4@mail.gmail.com>
	<429FB4AE.5030105@stat.auckland.ac.nz>
	<971536df0506030554396c2374@mail.gmail.com>
	<42A4D286.5090208@stat.auckland.ac.nz>
	<971536df0506061924438870f0@mail.gmail.com>
	<42A612FF.5020408@stat.auckland.ac.nz>
	<971536df05060718376e609133@mail.gmail.com>
Message-ID: <971536df0506071857730811a1@mail.gmail.com>

Here is the code once again.  This time I have supplied two 
names methods and a getChildren.viewport function to 
encapsulate the corresponding grid internals.  It would
be easiest if grid provided these itself but in the absence
of that this does encapsulate dependencies on grid
internals to a well defined set of functions.   Note that
names is only used in 'with' and 'with' will be eliminated
once Deepayan adds the use.viewport= (or whatever
its called) to print.   I am not sure from your response
whether or not you intend to add these items to the grid
API but in any case this provides an intermediate
level of safety.

library(grid)
library(lattice)

pushLayout <- function(nr, nc, name="layout") {
  pushViewport(viewport(layout=grid.layout(nr, nc), name=name))
  for (i in 1:nr) {
    for (j in 1:nc) {
      pushViewport(viewport(layout.pos.row=i, layout.pos.col=j))
      upViewport()
    }
  }
  upViewport()
}

names.vpPath <- names.viewport <- function(x) x$name

with.vpPath <- with.viewport <- function(data, expr, ...) {
      # if data is a vpPath it cannot be ROOT since  
      # NULL will never dispatch here
      depth <- if (data$name == "ROOT") 0 else downViewport(names(data))
      result <- eval.parent(substitute(expr))
      upViewport(depth)
      invisible(result)
}

getChildren.viewport <- function(x) x$children

grid.newpage()

# specify number of cells to fill and number of rows
n <- 5; nr <- 3

nc <- ceiling(n/nr)
downViewport(pushLayout(nr, nc))

vpt <- current.vpTree(all = FALSE)
for(k in 1:n) with(getChildren.viewport(vpt)[[k]],
      print( xyplot(v ~ v, list(v = 1:k)), newpage = FALSE )
)

From ggrothendieck at gmail.com  Wed Jun  8 04:02:09 2005
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Wed Jun  8 04:02:20 2005
Subject: [Rd] Re: [R] Problem going back to a viewport with gridBase
In-Reply-To: <42A64E2F.7030707@stat.auckland.ac.nz>
References: <971536df05053020191ebe8f44@mail.gmail.com>
	<429E5BFD.9080508@stat.auckland.ac.nz>
	<971536df050602140356cc80b4@mail.gmail.com>
	<429FB4AE.5030105@stat.auckland.ac.nz>
	<971536df0506030554396c2374@mail.gmail.com>
	<42A4D286.5090208@stat.auckland.ac.nz>
	<971536df0506061924438870f0@mail.gmail.com>
	<42A612FF.5020408@stat.auckland.ac.nz>
	<971536df05060718376e609133@mail.gmail.com>
	<42A64E2F.7030707@stat.auckland.ac.nz>
Message-ID: <971536df050607190249d2c761@mail.gmail.com>

Yes, I understand that although such order is convenient for
the user as the significant reduction in code size here shows.  I
wonder if there might be some performance parameter (e.g. hash)
to control it.  If hash = TRUE then no guarantee is provided.  Otherwise
order is kept.

On 6/7/05, Paul Murrell <p.murrell@auckland.ac.nz> wrote:
> Hi
> 
> 
> Gabor Grothendieck wrote:
> > On 6/7/05, Paul Murrell <p.murrell@auckland.ac.nz> wrote:
> >
> >>Hi
> >>
> >>
> >>Gabor Grothendieck wrote:
> >>
> >>>On 6/6/05, Paul Murrell <p.murrell@auckland.ac.nz> wrote:
> >>>
> >>>
> >>>>Hi
> >>>>
> >>>>
> >>>>Gabor Grothendieck wrote:
> >>>>
> >>>>
> >>>>>On 6/2/05, Paul Murrell <p.murrell@auckland.ac.nz> wrote:
> >>>>>
> >>>>>
> >>>>>
> >>>>>>Hi
> >>>>>
> >>>>>
> >>>>>Thanks.  I have mucked around in vpTree structures and discovered its
> >>>>>actually quite easy to specify children so I have changed my example
> >>>>>so that instead of naming the children of 'layout' and then remembering
> >>>>>coordinates linked to the names of the children of 'layout' in
> >>>>>the 'coords' structure (which really just duplicates state information
> >>>>>already available in grid) it simply follows the order
> >>>>>of the children of 'layout' directly.  This permits elimination of 'coords'
> >>>>>and the two naming functions.  Using the depth approach you advocate,
> >>>>>'with' also becomes shorter and I think I have it to the point where it works
> >>>>>with both vpPath and viewport classes.  Once Deepayan implements
> >>>>>the use.viewport= argument to print, 'with' can be eliminated too.  No
> >>>>>questions this time but I thought I would post the latest version for
> >>>>>completeness. Regards.
> >>>>
> >>>>
> >>>>Ok.  I can see this working ... for now.  The disadvantage with this
> >>>>approach is that it makes use of the undocumented, internal structure of
> >>>>a viewport tree to grab a list of child viewports.  A worse example of
> >>>>the same thing is that the with() methods make use of a happy
> >>>>coincidence that both viewport objects and viewport path objects share a
> >>>>component called "name" (and an even happier coincidence that they
> >>>>contain the same information).  I think it would be cleaner and better
> >>>>practice, despite requiring longer code, to make use of the documented
> >>>>interface which requires specifying viewport names and viewport paths.
> >>>>The internal structure of objects is not guaranteed to be stable.
> >>>
> >>>
> >>>Perhaps accessor functions could be provided that allow one to
> >>>retrieve the name of a viewport and the name of a vpPath in
> >>>a safe way.  These could be as simple as:
> >>>
> >>>names.viewport <- names.vpPath <- function(x) x$name
> >>
> >>
> >>Fair enough.  If I say "use the API", I should provide a useful API :)
> >>
> >>This is a reasonable request for viewports;  the "name" component of a
> >>viewport is a sensible thing to want.
> >>
> >>OTOH, it is not necessarily reasonable for a viewport path;  not all
> >>components of an object should necessarily have accessors.  The "name"
> >>component of a viewport path is the last element in the path.  Perhaps
> >>an API should be supplied for extracting parts of a viewport path, but
> >>it should probably be something along the lines of car()/cdr() or
> >>head()/tail() or explode() to get different bits of the path.
> >>
> >>Accessing the children of a viewport is subtly problematic too.
> >>Directly accessing the "children" slot and using the order of the
> >>children in that slot is "dangerous" because there is no claim made by
> >>the system as to how the children are internally ordered.  Again, it
> >>works currently, but it makes incorrect assumptions about what the
> >>system is doing internally so is vulnerable to future changes.
> >
> >
> > That is the point of an accessor.  If the internals change then the
> > accessor is modified to hide the change so that the user using the
> > accessor is not impacted.
> >
> > It seems that grid already partly supports this with the childNames
> > function.  It could be made generic and a method provided
> > to cover the classes discussed here too.
> 
> 
> I agree that a childNames() method for a viewport tree is probably
> reasonable.  The subtle problem is the fact that your code makes use of
> the *order* of the names that function would return, when in fact there
> is no claim that they will be in any particular order.
> 
> Paul
> 
> 
> >>So again, the recommended approach is to use the API provided;  you
> >>provide the naming scheme for viewports and you control the order in
> >>which viewports are used.
> >>
> >>Paul
> >>
> >>
> >>
> >>>Similarly an accessor function to safely retrieve the children would
> >>>be nice.    Again, it should ideally be possible to
> >>>have a generic with methods for various grid classes.
> >>>
> >>>Then the  relevant line in the code concerning name
> >>>could be written in a safe way like this:
> >>>
> >>>depth <- if (data$name == "ROOT") 0 else downViewport(names(data))
> >>>
> >>>and similarly for the children.
> >>>
> >>>
> >>>
> >>>
> >>>>Paul
> >>>>
> >>>>
> >>>>
> >>>>
> >>>>>[pushLayout is same as before except there are no names on the
> >>>>>children of 'layout' and the rest is new]
> >>>>>
> >>>>>library(grid)
> >>>>>library(lattice)
> >>>>>
> >>>>>pushLayout <- function(nr, nc, name="layout") {
> >>>>> pushViewport(viewport(layout=grid.layout(nr, nc), name=name))
> >>>>> for (i in 1:nr) {
> >>>>>   for (j in 1:nc) {
> >>>>>     pushViewport(viewport(layout.pos.row=i, layout.pos.col=j))
> >>>>>     upViewport()
> >>>>>   }
> >>>>> }
> >>>>> upViewport()
> >>>>>}
> >>>>>
> >>>>>with.vpPath <- with.viewport <- function(data, expr, ...) {
> >>>>>     # if data is a vpPath it cannot be ROOT since NULL will never
> >>>>>dispatch here
> >>>>>     depth <- if (data$name == "ROOT") 0 else downViewport(data$name)
> >>>>>     result <- eval.parent(substitute(expr))
> >>>>>     upViewport(depth)
> >>>>>     invisible(result)
> >>>>>}
> >>>>>
> >>>>>grid.newpage()
> >>>>>
> >>>>># specify number of cells to fill and number of rows
> >>>>>n <- 5; nr <- 3
> >>>>>
> >>>>>nc <- ceiling(n/nr)
> >>>>>downViewport(pushLayout(nr, nc))
> >>>>>
> >>>>>vpt <- current.vpTree(all = FALSE)
> >>>>>for(k in 1:n) with(vpt$children[[k]],
> >>>>>     print( xyplot(v ~ v, list(v = 1:k)), newpage = FALSE )
> >>>>>)
> >>>>
> >>>>
> >>>>--
> >>>>Dr Paul Murrell
> >>>>Department of Statistics
> >>>>The University of Auckland
> >>>>Private Bag 92019
> >>>>Auckland
> >>>>New Zealand
> >>>>64 9 3737599 x85392
> >>>>paul@stat.auckland.ac.nz
> >>>>http://www.stat.auckland.ac.nz/~paul/
> >>>>
> >>>
> >>
> >>--
> >>Dr Paul Murrell
> >>Department of Statistics
> >>The University of Auckland
> >>Private Bag 92019
> >>Auckland
> >>New Zealand
> >>64 9 3737599 x85392
> >>paul@stat.auckland.ac.nz
> >>http://www.stat.auckland.ac.nz/~paul/
> >>
> >
> >>
> 
> 
> --
> Dr Paul Murrell
> Department of Statistics
> The University of Auckland
> Private Bag 92019
> Auckland
> New Zealand
> 64 9 3737599 x85392
> paul@stat.auckland.ac.nz
> http://www.stat.auckland.ac.nz/~paul/
> 
>

From ggrothendieck at gmail.com  Wed Jun  8 04:52:11 2005
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Wed Jun  8 04:52:21 2005
Subject: [Rd] Re: [R] Problem going back to a viewport with gridBase
In-Reply-To: <971536df050607190249d2c761@mail.gmail.com>
References: <971536df05053020191ebe8f44@mail.gmail.com>
	<971536df050602140356cc80b4@mail.gmail.com>
	<429FB4AE.5030105@stat.auckland.ac.nz>
	<971536df0506030554396c2374@mail.gmail.com>
	<42A4D286.5090208@stat.auckland.ac.nz>
	<971536df0506061924438870f0@mail.gmail.com>
	<42A612FF.5020408@stat.auckland.ac.nz>
	<971536df05060718376e609133@mail.gmail.com>
	<42A64E2F.7030707@stat.auckland.ac.nz>
	<971536df050607190249d2c761@mail.gmail.com>
Message-ID: <971536df05060719521043df35@mail.gmail.com>

Just one additional item.  Look at:

?new.env

for an example of where this approach is used in R, noting the
hash= argument.

On 6/7/05, Gabor Grothendieck <ggrothendieck@gmail.com> wrote:
> Yes, I understand that although such order is convenient for
> the user as the significant reduction in code size here shows.  I
> wonder if there might be some performance parameter (e.g. hash)
> to control it.  If hash = TRUE then no guarantee is provided.  Otherwise
> order is kept.
> 
> On 6/7/05, Paul Murrell <p.murrell@auckland.ac.nz> wrote:
> > Hi
> >
> >
> > Gabor Grothendieck wrote:
> > > On 6/7/05, Paul Murrell <p.murrell@auckland.ac.nz> wrote:
> > >
> > >>Hi
> > >>
> > >>
> > >>Gabor Grothendieck wrote:
> > >>
> > >>>On 6/6/05, Paul Murrell <p.murrell@auckland.ac.nz> wrote:
> > >>>
> > >>>
> > >>>>Hi
> > >>>>
> > >>>>
> > >>>>Gabor Grothendieck wrote:
> > >>>>
> > >>>>
> > >>>>>On 6/2/05, Paul Murrell <p.murrell@auckland.ac.nz> wrote:
> > >>>>>
> > >>>>>
> > >>>>>
> > >>>>>>Hi
> > >>>>>
> > >>>>>
> > >>>>>Thanks.  I have mucked around in vpTree structures and discovered its
> > >>>>>actually quite easy to specify children so I have changed my example
> > >>>>>so that instead of naming the children of 'layout' and then remembering
> > >>>>>coordinates linked to the names of the children of 'layout' in
> > >>>>>the 'coords' structure (which really just duplicates state information
> > >>>>>already available in grid) it simply follows the order
> > >>>>>of the children of 'layout' directly.  This permits elimination of 'coords'
> > >>>>>and the two naming functions.  Using the depth approach you advocate,
> > >>>>>'with' also becomes shorter and I think I have it to the point where it works
> > >>>>>with both vpPath and viewport classes.  Once Deepayan implements
> > >>>>>the use.viewport= argument to print, 'with' can be eliminated too.  No
> > >>>>>questions this time but I thought I would post the latest version for
> > >>>>>completeness. Regards.
> > >>>>
> > >>>>
> > >>>>Ok.  I can see this working ... for now.  The disadvantage with this
> > >>>>approach is that it makes use of the undocumented, internal structure of
> > >>>>a viewport tree to grab a list of child viewports.  A worse example of
> > >>>>the same thing is that the with() methods make use of a happy
> > >>>>coincidence that both viewport objects and viewport path objects share a
> > >>>>component called "name" (and an even happier coincidence that they
> > >>>>contain the same information).  I think it would be cleaner and better
> > >>>>practice, despite requiring longer code, to make use of the documented
> > >>>>interface which requires specifying viewport names and viewport paths.
> > >>>>The internal structure of objects is not guaranteed to be stable.
> > >>>
> > >>>
> > >>>Perhaps accessor functions could be provided that allow one to
> > >>>retrieve the name of a viewport and the name of a vpPath in
> > >>>a safe way.  These could be as simple as:
> > >>>
> > >>>names.viewport <- names.vpPath <- function(x) x$name
> > >>
> > >>
> > >>Fair enough.  If I say "use the API", I should provide a useful API :)
> > >>
> > >>This is a reasonable request for viewports;  the "name" component of a
> > >>viewport is a sensible thing to want.
> > >>
> > >>OTOH, it is not necessarily reasonable for a viewport path;  not all
> > >>components of an object should necessarily have accessors.  The "name"
> > >>component of a viewport path is the last element in the path.  Perhaps
> > >>an API should be supplied for extracting parts of a viewport path, but
> > >>it should probably be something along the lines of car()/cdr() or
> > >>head()/tail() or explode() to get different bits of the path.
> > >>
> > >>Accessing the children of a viewport is subtly problematic too.
> > >>Directly accessing the "children" slot and using the order of the
> > >>children in that slot is "dangerous" because there is no claim made by
> > >>the system as to how the children are internally ordered.  Again, it
> > >>works currently, but it makes incorrect assumptions about what the
> > >>system is doing internally so is vulnerable to future changes.
> > >
> > >
> > > That is the point of an accessor.  If the internals change then the
> > > accessor is modified to hide the change so that the user using the
> > > accessor is not impacted.
> > >
> > > It seems that grid already partly supports this with the childNames
> > > function.  It could be made generic and a method provided
> > > to cover the classes discussed here too.
> >
> >
> > I agree that a childNames() method for a viewport tree is probably
> > reasonable.  The subtle problem is the fact that your code makes use of
> > the *order* of the names that function would return, when in fact there
> > is no claim that they will be in any particular order.
> >
> > Paul
> >
> >
> > >>So again, the recommended approach is to use the API provided;  you
> > >>provide the naming scheme for viewports and you control the order in
> > >>which viewports are used.
> > >>
> > >>Paul
> > >>
> > >>
> > >>
> > >>>Similarly an accessor function to safely retrieve the children would
> > >>>be nice.    Again, it should ideally be possible to
> > >>>have a generic with methods for various grid classes.
> > >>>
> > >>>Then the  relevant line in the code concerning name
> > >>>could be written in a safe way like this:
> > >>>
> > >>>depth <- if (data$name == "ROOT") 0 else downViewport(names(data))
> > >>>
> > >>>and similarly for the children.
> > >>>
> > >>>
> > >>>
> > >>>
> > >>>>Paul
> > >>>>
> > >>>>
> > >>>>
> > >>>>
> > >>>>>[pushLayout is same as before except there are no names on the
> > >>>>>children of 'layout' and the rest is new]
> > >>>>>
> > >>>>>library(grid)
> > >>>>>library(lattice)
> > >>>>>
> > >>>>>pushLayout <- function(nr, nc, name="layout") {
> > >>>>> pushViewport(viewport(layout=grid.layout(nr, nc), name=name))
> > >>>>> for (i in 1:nr) {
> > >>>>>   for (j in 1:nc) {
> > >>>>>     pushViewport(viewport(layout.pos.row=i, layout.pos.col=j))
> > >>>>>     upViewport()
> > >>>>>   }
> > >>>>> }
> > >>>>> upViewport()
> > >>>>>}
> > >>>>>
> > >>>>>with.vpPath <- with.viewport <- function(data, expr, ...) {
> > >>>>>     # if data is a vpPath it cannot be ROOT since NULL will never
> > >>>>>dispatch here
> > >>>>>     depth <- if (data$name == "ROOT") 0 else downViewport(data$name)
> > >>>>>     result <- eval.parent(substitute(expr))
> > >>>>>     upViewport(depth)
> > >>>>>     invisible(result)
> > >>>>>}
> > >>>>>
> > >>>>>grid.newpage()
> > >>>>>
> > >>>>># specify number of cells to fill and number of rows
> > >>>>>n <- 5; nr <- 3
> > >>>>>
> > >>>>>nc <- ceiling(n/nr)
> > >>>>>downViewport(pushLayout(nr, nc))
> > >>>>>
> > >>>>>vpt <- current.vpTree(all = FALSE)
> > >>>>>for(k in 1:n) with(vpt$children[[k]],
> > >>>>>     print( xyplot(v ~ v, list(v = 1:k)), newpage = FALSE )
> > >>>>>)
> > >>>>
> > >>>>
> > >>>>--
> > >>>>Dr Paul Murrell
> > >>>>Department of Statistics
> > >>>>The University of Auckland
> > >>>>Private Bag 92019
> > >>>>Auckland
> > >>>>New Zealand
> > >>>>64 9 3737599 x85392
> > >>>>paul@stat.auckland.ac.nz
> > >>>>http://www.stat.auckland.ac.nz/~paul/
> > >>>>
> > >>>
> > >>
> > >>--
> > >>Dr Paul Murrell
> > >>Department of Statistics
> > >>The University of Auckland
> > >>Private Bag 92019
> > >>Auckland
> > >>New Zealand
> > >>64 9 3737599 x85392
> > >>paul@stat.auckland.ac.nz
> > >>http://www.stat.auckland.ac.nz/~paul/
> > >>
> > >
> > >>
> >
> >
> > --
> > Dr Paul Murrell
> > Department of Statistics
> > The University of Auckland
> > Private Bag 92019
> > Auckland
> > New Zealand
> > 64 9 3737599 x85392
> > paul@stat.auckland.ac.nz
> > http://www.stat.auckland.ac.nz/~paul/
> >
> >
>

From p.murrell at auckland.ac.nz  Wed Jun  8 05:12:29 2005
From: p.murrell at auckland.ac.nz (Paul Murrell)
Date: Wed Jun  8 05:12:25 2005
Subject: [Rd] Re: [R] Problem going back to a viewport with gridBase
References: <971536df05053020191ebe8f44@mail.gmail.com>	
	<971536df05053118215366e02c@mail.gmail.com>	
	<429E5BFD.9080508@stat.auckland.ac.nz>	
	<971536df050602140356cc80b4@mail.gmail.com>	
	<429FB4AE.5030105@stat.auckland.ac.nz>	
	<971536df0506030554396c2374@mail.gmail.com>	
	<42A4D286.5090208@stat.auckland.ac.nz>	
	<971536df0506061924438870f0@mail.gmail.com>	
	<42A612FF.5020408@stat.auckland.ac.nz>	
	<971536df05060718376e609133@mail.gmail.com>
	<971536df0506071857730811a1@mail.gmail.com>
Message-ID: <42A6621D.9020101@stat.auckland.ac.nz>

Hi


Gabor Grothendieck wrote:
> Here is the code once again.  This time I have supplied two 
> names methods and a getChildren.viewport function to 
> encapsulate the corresponding grid internals.  It would
> be easiest if grid provided these itself but in the absence
> of that this does encapsulate dependencies on grid
> internals to a well defined set of functions.   Note that
> names is only used in 'with' and 'with' will be eliminated
> once Deepayan adds the use.viewport= (or whatever
> its called) to print.   I am not sure from your response
> whether or not you intend to add these items to the grid
> API but in any case this provides an intermediate
> level of safety.


Yep, I've made a note to look at adding these to the grid API.
Thanks.

Paul


> library(grid)
> library(lattice)
> 
> pushLayout <- function(nr, nc, name="layout") {
>   pushViewport(viewport(layout=grid.layout(nr, nc), name=name))
>   for (i in 1:nr) {
>     for (j in 1:nc) {
>       pushViewport(viewport(layout.pos.row=i, layout.pos.col=j))
>       upViewport()
>     }
>   }
>   upViewport()
> }
> 
> names.vpPath <- names.viewport <- function(x) x$name
> 
> with.vpPath <- with.viewport <- function(data, expr, ...) {
>       # if data is a vpPath it cannot be ROOT since  
>       # NULL will never dispatch here
>       depth <- if (data$name == "ROOT") 0 else downViewport(names(data))
>       result <- eval.parent(substitute(expr))
>       upViewport(depth)
>       invisible(result)
> }
> 
> getChildren.viewport <- function(x) x$children
> 
> grid.newpage()
> 
> # specify number of cells to fill and number of rows
> n <- 5; nr <- 3
> 
> nc <- ceiling(n/nr)
> downViewport(pushLayout(nr, nc))
> 
> vpt <- current.vpTree(all = FALSE)
> for(k in 1:n) with(getChildren.viewport(vpt)[[k]],
>       print( xyplot(v ~ v, list(v = 1:k)), newpage = FALSE )
> )


-- 
Dr Paul Murrell
Department of Statistics
The University of Auckland
Private Bag 92019
Auckland
New Zealand
64 9 3737599 x85392
paul@stat.auckland.ac.nz
http://www.stat.auckland.ac.nz/~paul/

From murdoch at stats.uwo.ca  Wed Jun  8 05:39:38 2005
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Wed Jun  8 05:39:54 2005
Subject: [Rd] Suggestion: help(<package name>)
In-Reply-To: <Pine.LNX.4.61.0506071823460.5947@gannet.stats>
References: <42A57F5D.7080505@maths.lth.se>
	<17061.32946.976628.961120@beren.wu-wien.ac.at>
	<42A58EDF.80701@stats.uwo.ca>
	<1f269abbabca01e19ee3cdbabc9d14f6@soc.soton.ac.uk>
	<42A5B96B.9030701@fhcrc.org> <42A5BB9D.3000301@stats.uwo.ca>
	<42A5C465.3090505@fhcrc.org> <42A5C789.3060101@stats.uwo.ca>
	<42A5D279.3010501@fhcrc.org>
	<Pine.LNX.4.61.0506071823460.5947@gannet.stats>
Message-ID: <42A6687A.3000804@stats.uwo.ca>

Prof Brian Ripley wrote:
> I share Robert's `pretty strenuous' objections.
> 
> Adding compulsory things for package writers seems to me to need very 
> compelling arguments.  Checking that a package does what it says (e.g. the 
> code in vignettes can be run) is one thing, but checking it does things it 
> does not say it wants to do is quite another.

I don't understand your complaint. Could you explain what you meant by 
"checking it does things it does not say it wants to do"?

My proposal (modified following the suggestions I've heard so far) is as 
follows:

  - to check that a couple of help topic aliases exist (<pkg>.package 
and <pkg>)
  - to recommend that <pkg>.package contain general information about 
the package, and that <pkg> be an alias for it, if it isn't used for 
some other purpose.
  - to write promptPackage() to help create an initial version of 
<pkg>.package.Rd.  It can get some information from the DESCRIPTION 
file; perhaps it could go looking for a vignette, or the INDEX, or
  - to modify the other help system tools to make use of this (e.g. the 
package:<pkg> heading on a page would become a link to the <pkg>.package 
alias, etc.)

None of these things are very much work, and I'd be happy to do them and 
document them.  The thing that will be more work is to write the 
<pkg>.package.Rd files for every package. (I'd do it for the base 
packages; they'd be short.)  It won't be a huge amount of work for any 
one package (many of them already have the basic content in various 
places, so for those it's mostly a matter of reformatting), but in total 
it will be a lot.

I think the benefit of this will be that the help for a package will 
show up in a standard location, using the standard method for looking 
for it.  This is not a huge benefit for any users who already know all 
about the current ways help can be given, but I think it would be a real 
benefit for users who aren't so familiar with things.   It would help to 
unify the help system:  everyone knows about ?topic, so providing a 
standard way for that to lead into all the rest of the documentation 
seems obviously beneficial to me.

Making this optional would weaken it quite a bit.  Packages couldn't 
give links to the main page in other packages if they weren't guaranteed 
  to exist; producing the HTML would be more difficult if links worked 
sometimes and didn't work other times, etc.

Robert Gentleman wrote:
>   Let's see, some of us (three years ago) developed a tool to solve this 
> problem. 

Do you mean vignettes?  I think they solved a different problem.  They 
provided a way to give good general documentation for a package, but 
they didn't provide a way to get to it through the help system.  They 
aren't used for general introductory help for any of the standard 
packages except grid and Matrix, and they use different naming 
conventions in those two.

> We made it available to others to use as they saw fit. I feel 
> no less strong than you do, but I certainly did not impose what I 
> thought on you and I ask for the same respect.

R imposes lots of things on me.  I have to document every function, and 
I have to get the usage section right.  These take work, but they make 
packages more useful.  I think imposing one more help topic on the 
package is in the same character.  I'm really surprised that you find it 
so objectionable.  It's really not much work!

 > We have already solved
> this problem in our own way. You now seem to think that it is zero cost 
> to impose on us a second (and in my view inferior solution). 

I have no idea where you got the impression that I think this is zero 
cost.  I think it's low cost per package, but obviously not zero.

 > I am asking
> that you not do that. Please, feel free to develop what you want and to 
> encourage others to use it, but don't try to make people do things just 
> because you want them that way.
>   We have lots of packages in BioC the costs of reengineering so we can 
> meet your newly imposed standards are not zero. 

I'd put the cost of the proposal to the package writer at about the cost 
of documenting one function.  I wouldn't call it "reengineering".  It's 
an addition, not a major change.

 > I think we have an
> expectation that such capricious behaviour will not be entered in to, 
> and if we don't then perhaps it is time to branch the project.

To tell you the truth, I wouldn't consider branching over this issue. 
I'd prefer some rational discussion about the proposal.  I really don't 
understand why you think it's such a disastrous one that you couldn't 
possibly live with it and would want to do all your work on a different 
branch.

Here are the kinds of question I'd like to discuss:

1. Could you tell me what you think would be involved in 
"reengineering"?  Maybe you have misunderstood the proposal, or I've 
missed something.  How much time do you think this would take?

2. What is the current algorithm people should use to look for help on 
foo?  Couldn't we make it simpler?  I'd like it if the algorithm was 
"type ?foo, and read what you get", regardless of what foo is.  The 
proposal above doesn't achieve that, but it gets closer.

Duncan Murdoch

From ggrothendieck at gmail.com  Wed Jun  8 05:44:20 2005
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Wed Jun  8 05:44:31 2005
Subject: [Rd] Re: [R] Problem going back to a viewport with gridBase
In-Reply-To: <42A6621D.9020101@stat.auckland.ac.nz>
References: <971536df05053020191ebe8f44@mail.gmail.com>
	<971536df050602140356cc80b4@mail.gmail.com>
	<429FB4AE.5030105@stat.auckland.ac.nz>
	<971536df0506030554396c2374@mail.gmail.com>
	<42A4D286.5090208@stat.auckland.ac.nz>
	<971536df0506061924438870f0@mail.gmail.com>
	<42A612FF.5020408@stat.auckland.ac.nz>
	<971536df05060718376e609133@mail.gmail.com>
	<971536df0506071857730811a1@mail.gmail.com>
	<42A6621D.9020101@stat.auckland.ac.nz>
Message-ID: <971536df0506072044583f7dc1@mail.gmail.com>

Thanks.  Yet one other comment to consider when thinking
about this.  Even if its not possible
or advisable to guarantee order, even without the hash=
idea, it may be possible to guarantee that default names
are generated in some order that can be used by
getChildren to ensure that it returns the children in
the same order they are created or perhaps even some sort
of timestamp can be attached to objects to facilitate 
later traversal.

On 6/7/05, Paul Murrell <p.murrell@auckland.ac.nz> wrote:
> Hi
> 
> 
> Gabor Grothendieck wrote:
> > Here is the code once again.  This time I have supplied two
> > names methods and a getChildren.viewport function to
> > encapsulate the corresponding grid internals.  It would
> > be easiest if grid provided these itself but in the absence
> > of that this does encapsulate dependencies on grid
> > internals to a well defined set of functions.   Note that
> > names is only used in 'with' and 'with' will be eliminated
> > once Deepayan adds the use.viewport= (or whatever
> > its called) to print.   I am not sure from your response
> > whether or not you intend to add these items to the grid
> > API but in any case this provides an intermediate
> > level of safety.
> 
> 
> Yep, I've made a note to look at adding these to the grid API.
> Thanks.
> 
> Paul
> 
> 
> > library(grid)
> > library(lattice)
> >
> > pushLayout <- function(nr, nc, name="layout") {
> >   pushViewport(viewport(layout=grid.layout(nr, nc), name=name))
> >   for (i in 1:nr) {
> >     for (j in 1:nc) {
> >       pushViewport(viewport(layout.pos.row=i, layout.pos.col=j))
> >       upViewport()
> >     }
> >   }
> >   upViewport()
> > }
> >
> > names.vpPath <- names.viewport <- function(x) x$name
> >
> > with.vpPath <- with.viewport <- function(data, expr, ...) {
> >       # if data is a vpPath it cannot be ROOT since
> >       # NULL will never dispatch here
> >       depth <- if (data$name == "ROOT") 0 else downViewport(names(data))
> >       result <- eval.parent(substitute(expr))
> >       upViewport(depth)
> >       invisible(result)
> > }
> >
> > getChildren.viewport <- function(x) x$children
> >
> > grid.newpage()
> >
> > # specify number of cells to fill and number of rows
> > n <- 5; nr <- 3
> >
> > nc <- ceiling(n/nr)
> > downViewport(pushLayout(nr, nc))
> >
> > vpt <- current.vpTree(all = FALSE)
> > for(k in 1:n) with(getChildren.viewport(vpt)[[k]],
> >       print( xyplot(v ~ v, list(v = 1:k)), newpage = FALSE )
> > )
> 
> 
> --
> Dr Paul Murrell
> Department of Statistics
> The University of Auckland
> Private Bag 92019
> Auckland
> New Zealand
> 64 9 3737599 x85392
> paul@stat.auckland.ac.nz
> http://www.stat.auckland.ac.nz/~paul/
> 
>

From andy_liaw at merck.com  Wed Jun  8 05:56:58 2005
From: andy_liaw at merck.com (Liaw, Andy)
Date: Wed Jun  8 05:57:43 2005
Subject: [Rd] Suggestion: help(<package name>)
Message-ID: <39B6DDB9048D0F4DAD42CB26AAFF0AFA64E959@usctmx1106.merck.com>

Let me add to the pot:

I think Robert and Brian are against imposing additional _requirement_ on
packages to provide an overview in .Rd, and I tend to agree with that
sentiment.

However, if such a facility is made optional (like vignettes) for package
author/maintainer, then I have no problem with it.  Perhaps it can work like
the CITATION file:  The package author/maintainer can choose to (or not to)
use it.  If one is not provided in the package source, then something
halfway sensible is auto-generated from various files (or perhaps just runs
help(package="<pkg>").

Or perhaps yet another function can be added to the `utils' package, like
packageOverview(), which can either:
- open an overview vignette if one is provided
- open the overview .Rd in whatever format the default help is in
- run help(package="<pkg>") if neither is available

Just my $0.02...

Andy

> From: Duncan Murdoch
> 
> Prof Brian Ripley wrote:
> > I share Robert's `pretty strenuous' objections.
> > 
> > Adding compulsory things for package writers seems to me to 
> need very 
> > compelling arguments.  Checking that a package does what it 
> says (e.g. the 
> > code in vignettes can be run) is one thing, but checking it 
> does things it 
> > does not say it wants to do is quite another.
> 
> I don't understand your complaint. Could you explain what you 
> meant by 
> "checking it does things it does not say it wants to do"?
> 
> My proposal (modified following the suggestions I've heard so 
> far) is as 
> follows:
> 
>   - to check that a couple of help topic aliases exist (<pkg>.package 
> and <pkg>)
>   - to recommend that <pkg>.package contain general information about 
> the package, and that <pkg> be an alias for it, if it isn't used for 
> some other purpose.
>   - to write promptPackage() to help create an initial version of 
> <pkg>.package.Rd.  It can get some information from the DESCRIPTION 
> file; perhaps it could go looking for a vignette, or the INDEX, or
>   - to modify the other help system tools to make use of this 
> (e.g. the 
> package:<pkg> heading on a page would become a link to the 
> <pkg>.package 
> alias, etc.)
> 
> None of these things are very much work, and I'd be happy to 
> do them and 
> document them.  The thing that will be more work is to write the 
> <pkg>.package.Rd files for every package. (I'd do it for the base 
> packages; they'd be short.)  It won't be a huge amount of 
> work for any 
> one package (many of them already have the basic content in various 
> places, so for those it's mostly a matter of reformatting), 
> but in total 
> it will be a lot.
> 
> I think the benefit of this will be that the help for a package will 
> show up in a standard location, using the standard method for looking 
> for it.  This is not a huge benefit for any users who already 
> know all 
> about the current ways help can be given, but I think it 
> would be a real 
> benefit for users who aren't so familiar with things.   It 
> would help to 
> unify the help system:  everyone knows about ?topic, so providing a 
> standard way for that to lead into all the rest of the documentation 
> seems obviously beneficial to me.
> 
> Making this optional would weaken it quite a bit.  Packages couldn't 
> give links to the main page in other packages if they weren't 
> guaranteed 
>   to exist; producing the HTML would be more difficult if 
> links worked 
> sometimes and didn't work other times, etc.
> 
> Robert Gentleman wrote:
> >   Let's see, some of us (three years ago) developed a tool 
> to solve this 
> > problem. 
> 
> Do you mean vignettes?  I think they solved a different 
> problem.  They 
> provided a way to give good general documentation for a package, but 
> they didn't provide a way to get to it through the help system.  They 
> aren't used for general introductory help for any of the standard 
> packages except grid and Matrix, and they use different naming 
> conventions in those two.
> 
> > We made it available to others to use as they saw fit. I feel 
> > no less strong than you do, but I certainly did not impose what I 
> > thought on you and I ask for the same respect.
> 
> R imposes lots of things on me.  I have to document every 
> function, and 
> I have to get the usage section right.  These take work, but 
> they make 
> packages more useful.  I think imposing one more help topic on the 
> package is in the same character.  I'm really surprised that 
> you find it 
> so objectionable.  It's really not much work!
> 
>  > We have already solved
> > this problem in our own way. You now seem to think that it 
> is zero cost 
> > to impose on us a second (and in my view inferior solution). 
> 
> I have no idea where you got the impression that I think this is zero 
> cost.  I think it's low cost per package, but obviously not zero.
> 
>  > I am asking
> > that you not do that. Please, feel free to develop what you 
> want and to 
> > encourage others to use it, but don't try to make people do 
> things just 
> > because you want them that way.
> >   We have lots of packages in BioC the costs of 
> reengineering so we can 
> > meet your newly imposed standards are not zero. 
> 
> I'd put the cost of the proposal to the package writer at 
> about the cost 
> of documenting one function.  I wouldn't call it 
> "reengineering".  It's 
> an addition, not a major change.
> 
>  > I think we have an
> > expectation that such capricious behaviour will not be 
> entered in to, 
> > and if we don't then perhaps it is time to branch the project.
> 
> To tell you the truth, I wouldn't consider branching over this issue. 
> I'd prefer some rational discussion about the proposal.  I 
> really don't 
> understand why you think it's such a disastrous one that you couldn't 
> possibly live with it and would want to do all your work on a 
> different 
> branch.
> 
> Here are the kinds of question I'd like to discuss:
> 
> 1. Could you tell me what you think would be involved in 
> "reengineering"?  Maybe you have misunderstood the proposal, or I've 
> missed something.  How much time do you think this would take?
> 
> 2. What is the current algorithm people should use to look 
> for help on 
> foo?  Couldn't we make it simpler?  I'd like it if the algorithm was 
> "type ?foo, and read what you get", regardless of what foo is.  The 
> proposal above doesn't achieve that, but it gets closer.
> 
> Duncan Murdoch
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> 
>

From murdoch at stats.uwo.ca  Wed Jun  8 06:24:34 2005
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Wed Jun  8 06:24:44 2005
Subject: [Rd] Suggestion: help(<package name>)
In-Reply-To: <39B6DDB9048D0F4DAD42CB26AAFF0AFA64E959@usctmx1106.merck.com>
References: <39B6DDB9048D0F4DAD42CB26AAFF0AFA64E959@usctmx1106.merck.com>
Message-ID: <42A67302.6090302@stats.uwo.ca>

Liaw, Andy wrote:
> Let me add to the pot:
> 
> I think Robert and Brian are against imposing additional _requirement_ on
> packages to provide an overview in .Rd, and I tend to agree with that
> sentiment.
> 
> However, if such a facility is made optional (like vignettes) for package
> author/maintainer, then I have no problem with it.  Perhaps it can work like
> the CITATION file:  The package author/maintainer can choose to (or not to)
> use it.  If one is not provided in the package source, then something
> halfway sensible is auto-generated from various files (or perhaps just runs
> help(package="<pkg>").
> 
> Or perhaps yet another function can be added to the `utils' package, like
> packageOverview(), which can either:
> - open an overview vignette if one is provided
> - open the overview .Rd in whatever format the default help is in
> - run help(package="<pkg>") if neither is available

We don't have a standard name for an overview vignette, and I don't like 
the idea of creating a new help function (packageOverview) that someone 
who doesn't know much about R will have to find before they can use, but 
I like the idea of the help system doing its best to help.

So I'd like this better if it were modified so that ?foo tries the following

  - to open help alias foo
  - if that fails, and foo is a package name:
    - tries to open a vignette with some standard name (proposals?)
    - if that fails, then does help(package="foo")

This has the disadvantage over the original proposal that help pages 
can't link to a standard help topic for the package, so I like the 
original better, but this would be better than the status quo.

Duncan Murdoch

> 
> Just my $0.02...
> 
> Andy
> 
> 
>>From: Duncan Murdoch
>>
>>Prof Brian Ripley wrote:
>>
>>>I share Robert's `pretty strenuous' objections.
>>>
>>>Adding compulsory things for package writers seems to me to 
>>
>>need very 
>>
>>>compelling arguments.  Checking that a package does what it 
>>
>>says (e.g. the 
>>
>>>code in vignettes can be run) is one thing, but checking it 
>>
>>does things it 
>>
>>>does not say it wants to do is quite another.
>>
>>I don't understand your complaint. Could you explain what you 
>>meant by 
>>"checking it does things it does not say it wants to do"?
>>
>>My proposal (modified following the suggestions I've heard so 
>>far) is as 
>>follows:
>>
>>  - to check that a couple of help topic aliases exist (<pkg>.package 
>>and <pkg>)
>>  - to recommend that <pkg>.package contain general information about 
>>the package, and that <pkg> be an alias for it, if it isn't used for 
>>some other purpose.
>>  - to write promptPackage() to help create an initial version of 
>><pkg>.package.Rd.  It can get some information from the DESCRIPTION 
>>file; perhaps it could go looking for a vignette, or the INDEX, or
>>  - to modify the other help system tools to make use of this 
>>(e.g. the 
>>package:<pkg> heading on a page would become a link to the 
>><pkg>.package 
>>alias, etc.)
>>
>>None of these things are very much work, and I'd be happy to 
>>do them and 
>>document them.  The thing that will be more work is to write the 
>><pkg>.package.Rd files for every package. (I'd do it for the base 
>>packages; they'd be short.)  It won't be a huge amount of 
>>work for any 
>>one package (many of them already have the basic content in various 
>>places, so for those it's mostly a matter of reformatting), 
>>but in total 
>>it will be a lot.
>>
>>I think the benefit of this will be that the help for a package will 
>>show up in a standard location, using the standard method for looking 
>>for it.  This is not a huge benefit for any users who already 
>>know all 
>>about the current ways help can be given, but I think it 
>>would be a real 
>>benefit for users who aren't so familiar with things.   It 
>>would help to 
>>unify the help system:  everyone knows about ?topic, so providing a 
>>standard way for that to lead into all the rest of the documentation 
>>seems obviously beneficial to me.
>>
>>Making this optional would weaken it quite a bit.  Packages couldn't 
>>give links to the main page in other packages if they weren't 
>>guaranteed 
>>  to exist; producing the HTML would be more difficult if 
>>links worked 
>>sometimes and didn't work other times, etc.
>>
>>Robert Gentleman wrote:
>>
>>>  Let's see, some of us (three years ago) developed a tool 
>>
>>to solve this 
>>
>>>problem. 
>>
>>Do you mean vignettes?  I think they solved a different 
>>problem.  They 
>>provided a way to give good general documentation for a package, but 
>>they didn't provide a way to get to it through the help system.  They 
>>aren't used for general introductory help for any of the standard 
>>packages except grid and Matrix, and they use different naming 
>>conventions in those two.
>>
>>
>>>We made it available to others to use as they saw fit. I feel 
>>>no less strong than you do, but I certainly did not impose what I 
>>>thought on you and I ask for the same respect.
>>
>>R imposes lots of things on me.  I have to document every 
>>function, and 
>>I have to get the usage section right.  These take work, but 
>>they make 
>>packages more useful.  I think imposing one more help topic on the 
>>package is in the same character.  I'm really surprised that 
>>you find it 
>>so objectionable.  It's really not much work!
>>
>> > We have already solved
>>
>>>this problem in our own way. You now seem to think that it 
>>
>>is zero cost 
>>
>>>to impose on us a second (and in my view inferior solution). 
>>
>>I have no idea where you got the impression that I think this is zero 
>>cost.  I think it's low cost per package, but obviously not zero.
>>
>> > I am asking
>>
>>>that you not do that. Please, feel free to develop what you 
>>
>>want and to 
>>
>>>encourage others to use it, but don't try to make people do 
>>
>>things just 
>>
>>>because you want them that way.
>>>  We have lots of packages in BioC the costs of 
>>
>>reengineering so we can 
>>
>>>meet your newly imposed standards are not zero. 
>>
>>I'd put the cost of the proposal to the package writer at 
>>about the cost 
>>of documenting one function.  I wouldn't call it 
>>"reengineering".  It's 
>>an addition, not a major change.
>>
>> > I think we have an
>>
>>>expectation that such capricious behaviour will not be 
>>
>>entered in to, 
>>
>>>and if we don't then perhaps it is time to branch the project.
>>
>>To tell you the truth, I wouldn't consider branching over this issue. 
>>I'd prefer some rational discussion about the proposal.  I 
>>really don't 
>>understand why you think it's such a disastrous one that you couldn't 
>>possibly live with it and would want to do all your work on a 
>>different 
>>branch.
>>
>>Here are the kinds of question I'd like to discuss:
>>
>>1. Could you tell me what you think would be involved in 
>>"reengineering"?  Maybe you have misunderstood the proposal, or I've 
>>missed something.  How much time do you think this would take?
>>
>>2. What is the current algorithm people should use to look 
>>for help on 
>>foo?  Couldn't we make it simpler?  I'd like it if the algorithm was 
>>"type ?foo, and read what you get", regardless of what foo is.  The 
>>proposal above doesn't achieve that, but it gets closer.
>>
>>Duncan Murdoch
>>
>>______________________________________________
>>R-devel@stat.math.ethz.ch mailing list
>>https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>>
>>
> 
> 
> 
> 
> ------------------------------------------------------------------------------
> Notice:  This e-mail message, together with any attachment...{{dropped}}

From ggrothendieck at gmail.com  Wed Jun  8 06:27:04 2005
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Wed Jun  8 06:27:15 2005
Subject: [Rd] Suggestion: help(<package name>)
In-Reply-To: <39B6DDB9048D0F4DAD42CB26AAFF0AFA64E959@usctmx1106.merck.com>
References: <39B6DDB9048D0F4DAD42CB26AAFF0AFA64E959@usctmx1106.merck.com>
Message-ID: <971536df050607212761b87b6b@mail.gmail.com>

My understanding is that one could still build, install and distribute
a package that did not conform to this requirement but it would
fail R CMD CHECK.  Thus as long as you don't want to place it
in a repository that requires a clean R CMD CHECK you are
under no obligation to do it.  But if you do want to use CRAN or
other repository that enforces quality via R CMD CHECK then
the package must meet that quality and so
to that extent would this would be a requirement.

Perhaps this could even be expanded into quality levels.  In a sense this
is already the case as the level can be regarded as
whether the package:

- fails R CMD CHECK
- passes R CMD CHECK but with warnings
- fully passes R CMD CHECK

as shownn in the check summary:
   http://probability.ca/cran/src/contrib/checkSummary.html

An additional level could be added for those packages possessing 
a vignette (where the horizontal line is the threshold for CRAN
admission) but the quality would be published on the web as it
is now:

- fails R CMD check
-------------------------------------
- passes it with warnings
- fully passes it
- fully passes it and has a vignette

Personally I think Duncan's proposal is an excellent idea and
that the quality of packages should be driven and enforced
by the needs of the users. This makes it easier to use packages 
for users and though it requires extra work from the developers
it is not onerous.

On 6/7/05, Liaw, Andy <andy_liaw@merck.com> wrote:
> Let me add to the pot:
> 
> I think Robert and Brian are against imposing additional _requirement_ on
> packages to provide an overview in .Rd, and I tend to agree with that
> sentiment.
> 
> However, if such a facility is made optional (like vignettes) for package
> author/maintainer, then I have no problem with it.  Perhaps it can work like
> the CITATION file:  The package author/maintainer can choose to (or not to)
> use it.  If one is not provided in the package source, then something
> halfway sensible is auto-generated from various files (or perhaps just runs
> help(package="<pkg>").
> 
> Or perhaps yet another function can be added to the `utils' package, like
> packageOverview(), which can either:
> - open an overview vignette if one is provided
> - open the overview .Rd in whatever format the default help is in
> - run help(package="<pkg>") if neither is available
> 
> Just my $0.02...
> 
> Andy
> 
> > From: Duncan Murdoch
> >
> > Prof Brian Ripley wrote:
> > > I share Robert's `pretty strenuous' objections.
> > >
> > > Adding compulsory things for package writers seems to me to
> > need very
> > > compelling arguments.  Checking that a package does what it
> > says (e.g. the
> > > code in vignettes can be run) is one thing, but checking it
> > does things it
> > > does not say it wants to do is quite another.
> >
> > I don't understand your complaint. Could you explain what you
> > meant by
> > "checking it does things it does not say it wants to do"?
> >
> > My proposal (modified following the suggestions I've heard so
> > far) is as
> > follows:
> >
> >   - to check that a couple of help topic aliases exist (<pkg>.package
> > and <pkg>)
> >   - to recommend that <pkg>.package contain general information about
> > the package, and that <pkg> be an alias for it, if it isn't used for
> > some other purpose.
> >   - to write promptPackage() to help create an initial version of
> > <pkg>.package.Rd.  It can get some information from the DESCRIPTION
> > file; perhaps it could go looking for a vignette, or the INDEX, or
> >   - to modify the other help system tools to make use of this
> > (e.g. the
> > package:<pkg> heading on a page would become a link to the
> > <pkg>.package
> > alias, etc.)
> >
> > None of these things are very much work, and I'd be happy to
> > do them and
> > document them.  The thing that will be more work is to write the
> > <pkg>.package.Rd files for every package. (I'd do it for the base
> > packages; they'd be short.)  It won't be a huge amount of
> > work for any
> > one package (many of them already have the basic content in various
> > places, so for those it's mostly a matter of reformatting),
> > but in total
> > it will be a lot.
> >
> > I think the benefit of this will be that the help for a package will
> > show up in a standard location, using the standard method for looking
> > for it.  This is not a huge benefit for any users who already
> > know all
> > about the current ways help can be given, but I think it
> > would be a real
> > benefit for users who aren't so familiar with things.   It
> > would help to
> > unify the help system:  everyone knows about ?topic, so providing a
> > standard way for that to lead into all the rest of the documentation
> > seems obviously beneficial to me.
> >
> > Making this optional would weaken it quite a bit.  Packages couldn't
> > give links to the main page in other packages if they weren't
> > guaranteed
> >   to exist; producing the HTML would be more difficult if
> > links worked
> > sometimes and didn't work other times, etc.
> >
> > Robert Gentleman wrote:
> > >   Let's see, some of us (three years ago) developed a tool
> > to solve this
> > > problem.
> >
> > Do you mean vignettes?  I think they solved a different
> > problem.  They
> > provided a way to give good general documentation for a package, but
> > they didn't provide a way to get to it through the help system.  They
> > aren't used for general introductory help for any of the standard
> > packages except grid and Matrix, and they use different naming
> > conventions in those two.
> >
> > > We made it available to others to use as they saw fit. I feel
> > > no less strong than you do, but I certainly did not impose what I
> > > thought on you and I ask for the same respect.
> >
> > R imposes lots of things on me.  I have to document every
> > function, and
> > I have to get the usage section right.  These take work, but
> > they make
> > packages more useful.  I think imposing one more help topic on the
> > package is in the same character.  I'm really surprised that
> > you find it
> > so objectionable.  It's really not much work!
> >
> >  > We have already solved
> > > this problem in our own way. You now seem to think that it
> > is zero cost
> > > to impose on us a second (and in my view inferior solution).
> >
> > I have no idea where you got the impression that I think this is zero
> > cost.  I think it's low cost per package, but obviously not zero.
> >
> >  > I am asking
> > > that you not do that. Please, feel free to develop what you
> > want and to
> > > encourage others to use it, but don't try to make people do
> > things just
> > > because you want them that way.
> > >   We have lots of packages in BioC the costs of
> > reengineering so we can
> > > meet your newly imposed standards are not zero.
> >
> > I'd put the cost of the proposal to the package writer at
> > about the cost
> > of documenting one function.  I wouldn't call it
> > "reengineering".  It's
> > an addition, not a major change.
> >
> >  > I think we have an
> > > expectation that such capricious behaviour will not be
> > entered in to,
> > > and if we don't then perhaps it is time to branch the project.
> >
> > To tell you the truth, I wouldn't consider branching over this issue.
> > I'd prefer some rational discussion about the proposal.  I
> > really don't
> > understand why you think it's such a disastrous one that you couldn't
> > possibly live with it and would want to do all your work on a
> > different
> > branch.
> >
> > Here are the kinds of question I'd like to discuss:
> >
> > 1. Could you tell me what you think would be involved in
> > "reengineering"?  Maybe you have misunderstood the proposal, or I've
> > missed something.  How much time do you think this would take?
> >
> > 2. What is the current algorithm people should use to look
> > for help on
> > foo?  Couldn't we make it simpler?  I'd like it if the algorithm was
> > "type ?foo, and read what you get", regardless of what foo is.  The
> > proposal above doesn't achieve that, but it gets closer.
> >
> > Duncan Murdoch
> >
> > ______________________________________________
> > R-devel@stat.math.ethz.ch mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-devel
> >
> >
> >
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

From Torsten.Hothorn at rzmail.uni-erlangen.de  Wed Jun  8 09:37:02 2005
From: Torsten.Hothorn at rzmail.uni-erlangen.de (Torsten Hothorn)
Date: Wed Jun  8 09:41:14 2005
Subject: [Rd] Suggestion: help(<package name>)
In-Reply-To: <42A6687A.3000804@stats.uwo.ca>
References: <42A57F5D.7080505@maths.lth.se>
	<17061.32946.976628.961120@beren.wu-wien.ac.at>
	<42A58EDF.80701@stats.uwo.ca>
	<1f269abbabca01e19ee3cdbabc9d14f6@soc.soton.ac.uk>
	<42A5B96B.9030701@fhcrc.org> <42A5BB9D.3000301@stats.uwo.ca>
	<42A5C465.3090505@fhcrc.org> <42A5C789.3060101@stats.uwo.ca>
	<42A5D279.3010501@fhcrc.org>
	<Pine.LNX.4.61.0506071823460.5947@gannet.stats>
	<42A6687A.3000804@stats.uwo.ca>
Message-ID: <Pine.LNX.4.51.0506080918210.12890@artemis.imbe.med.uni-erlangen.de>


On Tue, 7 Jun 2005, Duncan Murdoch wrote:

[...]

> My proposal (modified following the suggestions I've heard so far) is as
> follows:
>
>   - to check that a couple of help topic aliases exist (<pkg>.package
> and <pkg>)
>   - to recommend that <pkg>.package contain general information about
> the package, and that <pkg> be an alias for it, if it isn't used for
> some other purpose.
>   - to write promptPackage() to help create an initial version of
> <pkg>.package.Rd.  It can get some information from the DESCRIPTION
> file; perhaps it could go looking for a vignette, or the INDEX, or
>   - to modify the other help system tools to make use of this (e.g. the
> package:<pkg> heading on a page would become a link to the <pkg>.package
> alias, etc.)
>

as a package author who already provides help pages for general package
descriptions (`?multcomp' and `?coin' work and, if I remember correctly,
Martin suggested to include the advertisement this way) I must
admit that I never say `?foo' when I'm interested in a global overview
about a new package `foo'.

Instead, `library(help = foo)' gives what I want to see, namely the title
and description of a package and all documented topics. One may argue that
asking `library' for help is not the most obvious thing to do. But people
able to recall that fitting an ANOVA model requires `aov' and comparing
two models needs `anova' should be able to have `library' in mind for
general package information.

So, for me having infrastructure for _automatically_ generated overviews
is very nice, but _forcing_ package authors to provide additional
meta-information would be less welcome.

Best,

Torsten

From blindglobe at gmail.com  Wed Jun  8 09:59:24 2005
From: blindglobe at gmail.com (A.J. Rossini)
Date: Wed Jun  8 09:59:31 2005
Subject: [Rd] Suggestion: help(<package name>)
In-Reply-To: <Pine.LNX.4.51.0506080918210.12890@artemis.imbe.med.uni-erlangen.de>
References: <42A57F5D.7080505@maths.lth.se>
	<1f269abbabca01e19ee3cdbabc9d14f6@soc.soton.ac.uk>
	<42A5B96B.9030701@fhcrc.org> <42A5BB9D.3000301@stats.uwo.ca>
	<42A5C465.3090505@fhcrc.org> <42A5C789.3060101@stats.uwo.ca>
	<42A5D279.3010501@fhcrc.org>
	<Pine.LNX.4.61.0506071823460.5947@gannet.stats>
	<42A6687A.3000804@stats.uwo.ca>
	<Pine.LNX.4.51.0506080918210.12890@artemis.imbe.med.uni-erlangen.de>
Message-ID: <1abe3fa905060800597bbe63bb@mail.gmail.com>

On 6/8/05, Torsten Hothorn <Torsten.Hothorn@rzmail.uni-erlangen.de> wrote:
> 
> On Tue, 7 Jun 2005, Duncan Murdoch wrote:
> 
> [...]
> 
> > My proposal (modified following the suggestions I've heard so far) is as
> > follows:
> >
> >   - to check that a couple of help topic aliases exist (<pkg>.package
> > and <pkg>)
> >   - to recommend that <pkg>.package contain general information about
> > the package, and that <pkg> be an alias for it, if it isn't used for
> > some other purpose.
> >   - to write promptPackage() to help create an initial version of
> > <pkg>.package.Rd.  It can get some information from the DESCRIPTION
> > file; perhaps it could go looking for a vignette, or the INDEX, or
> >   - to modify the other help system tools to make use of this (e.g. the
> > package:<pkg> heading on a page would become a link to the <pkg>.package
> > alias, etc.)
> >
> 
> as a package author who already provides help pages for general package
> descriptions (`?multcomp' and `?coin' work and, if I remember correctly,
> Martin suggested to include the advertisement this way) I must
> admit that I never say `?foo' when I'm interested in a global overview
> about a new package `foo'.
> 
> Instead, `library(help = foo)' gives what I want to see, namely the title
> and description of a package and all documented topics. One may argue that
> asking `library' for help is not the most obvious thing to do. But people
> able to recall that fitting an ANOVA model requires `aov' and comparing
> two models needs `anova' should be able to have `library' in mind for
> general package information.
> 
> So, for me having infrastructure for _automatically_ generated overviews
> is very nice, but _forcing_ package authors to provide additional
> meta-information would be less welcome.

I'm in the Robert/Brian school of thought -- this can be solved with
better DESCRIPTIONS,  or by explicitly writing such a file (which one
can already do), or through better advertisement / incorporation of
the vignette tools.

Requiring anything additional is a PITA.   Sure, it doesn't look like
much time, but it is.  "much" is in the eye of the beholder.

Perhaps one thing to do is to map  
   ?<pkgname>.package  
to 
   library(help=pkgname)
as was previously suggested, and let authors put information in the
DESCRIPTION, perhaps with a lead towards the right help file to use to
get more.


best,
-tony

"Commit early,commit often, and commit in a repository from which we can easily
roll-back your mistakes" (AJR, 4Jan05).

A.J. Rossini
blindglobe@gmail.com

From r.hankin at noc.soton.ac.uk  Wed Jun  8 10:05:23 2005
From: r.hankin at noc.soton.ac.uk (Robin Hankin)
Date: Wed Jun  8 10:03:39 2005
Subject: [Rd] Suggestion: help(<package name>)
In-Reply-To: <17061.52921.689940.969317@stat.math.ethz.ch>
References: <42A57F5D.7080505@maths.lth.se>
	<17061.32946.976628.961120@beren.wu-wien.ac.at>
	<42A58EDF.80701@stats.uwo.ca>
	<1f269abbabca01e19ee3cdbabc9d14f6@soc.soton.ac.uk>
	<42A5B96B.9030701@fhcrc.org> <42A5BB9D.3000301@stats.uwo.ca>
	<42A5C465.3090505@fhcrc.org> <42A5C789.3060101@stats.uwo.ca>
	<17061.52921.689940.969317@stat.math.ethz.ch>
Message-ID: <57c8613071f69cf7daee6e7e3f337c95@soc.soton.ac.uk>

The reason I like .Rd files is that I can run the examples easily and, 
as Martin points out,
one does not need to learn a new syntax.

How about adding the following to R-exts:

"We encourage the package developer to include a file named 
foo.package.Rd in the "man"
directory, to provide a terse overview of the foo package.  This Rd 
file is intended to be
the first port of call for a new user of the package, and should 
provide (or point to)
working examples of the package's functionality.  It may also provide 
details or rationale
for the package's structure, if non-standard; and perhaps document 
other features of
the package that might escape a new user's notice.

See package foo for an example"

and package.skeleton() could be modified to  write a skeleton version 
of foo.package.Rd
and put it in the man directory.

best wishes everyone

rksh


Duncan writes:
>
> My proposal (modified following the suggestions I've heard so far) is 
> as follows:
>
>  - to check that a couple of help topic aliases exist (<pkg>.package 
> and <pkg>)
>  - to recommend that <pkg>.package contain general information about 
> the package, and that <pkg> be an alias for it, if it isn't used for 
> some other purpose.
>  - to write promptPackage() to help create an initial version of 
> <pkg>.package.Rd.  It can get some information from the DESCRIPTION 
> file; perhaps it could go looking for a vignette, or the INDEX, or
>  - to modify the other help system tools to make use of this (e.g. the 
> package:<pkg> heading on a page would become a link to the 
> <pkg>.package alias, etc.)
>

Martin:

> And as much as I do like (and read) the vignettes that are
> available, I also do agree that writing one other *.Rd file is
> easier for many new package authors than to write a
> vignette -- the package author already had to learn *.Rd syntax
> anyway -- and it's nice to be able to produce something where
> hyperlinks to the other existing reference material (ie. help
> pages) just works out of the box.
>

Duncan again:

> Currently R has 3 types of help:  the .Rd files in the man directory 
> (which are converted into plain text, HTML, compiled HTML, LaTex, DVI, 
> PDF, etc), the vignettes, and unstructured files in inst/doc.  We 
> currently require .Rd files for every function and data object.  
> Adding a requirement to also document the package that way is not all 
> that much of a burden, and will automatically give all those output 
> formats I listed above.  It will help to solve the often-complained 
> about problem   of packages that contain no overview at all.  
> (Requiring a vignette and giving a way to display it would also do 
> that, but I think requiring a .Rd file is less of a burden, and for 
> anyone who has gone to the trouble of creating a vignette, gives a 
> natural place for a link to it.  Vignettes aren't used as much as they 
> should be,  because they are hidden away where users don't see them.)

>
>
--
Robin Hankin
Uncertainty Analyst
National Oceanography Centre, Southampton
European Way, Southampton SO14 3ZH, UK
  tel  023-8059-7743

From Kurt.Hornik at wu-wien.ac.at  Wed Jun  8 11:38:21 2005
From: Kurt.Hornik at wu-wien.ac.at (Kurt Hornik)
Date: Wed Jun  8 11:38:33 2005
Subject: [Rd] Suggestion: help(<package name>)
In-Reply-To: <1abe3fa905060800597bbe63bb@mail.gmail.com>
References: <42A57F5D.7080505@maths.lth.se>
	<1f269abbabca01e19ee3cdbabc9d14f6@soc.soton.ac.uk>
	<42A5B96B.9030701@fhcrc.org> <42A5BB9D.3000301@stats.uwo.ca>
	<42A5C465.3090505@fhcrc.org> <42A5C789.3060101@stats.uwo.ca>
	<42A5D279.3010501@fhcrc.org>
	<Pine.LNX.4.61.0506071823460.5947@gannet.stats>
	<42A6687A.3000804@stats.uwo.ca>
	<Pine.LNX.4.51.0506080918210.12890@artemis.imbe.med.uni-erlangen.de>
	<1abe3fa905060800597bbe63bb@mail.gmail.com>
Message-ID: <17062.48269.194893.515905@beren.wu-wien.ac.at>

>>>>> A J Rossini writes:

> On 6/8/05, Torsten Hothorn <Torsten.Hothorn@rzmail.uni-erlangen.de> wrote:
>> 
>> On Tue, 7 Jun 2005, Duncan Murdoch wrote:
>> 
>> [...]
>> 
>> > My proposal (modified following the suggestions I've heard so far) is as
>> > follows:
>> >
>> >   - to check that a couple of help topic aliases exist (<pkg>.package
>> > and <pkg>)
>> >   - to recommend that <pkg>.package contain general information about
>> > the package, and that <pkg> be an alias for it, if it isn't used for
>> > some other purpose.
>> >   - to write promptPackage() to help create an initial version of
>> > <pkg>.package.Rd.  It can get some information from the DESCRIPTION
>> > file; perhaps it could go looking for a vignette, or the INDEX, or
>> >   - to modify the other help system tools to make use of this (e.g. the
>> > package:<pkg> heading on a page would become a link to the <pkg>.package
>> > alias, etc.)
>> >
>> 
>> as a package author who already provides help pages for general package
>> descriptions (`?multcomp' and `?coin' work and, if I remember correctly,
>> Martin suggested to include the advertisement this way) I must
>> admit that I never say `?foo' when I'm interested in a global overview
>> about a new package `foo'.
>> 
>> Instead, `library(help = foo)' gives what I want to see, namely the title
>> and description of a package and all documented topics. One may argue that
>> asking `library' for help is not the most obvious thing to do. But people
>> able to recall that fitting an ANOVA model requires `aov' and comparing
>> two models needs `anova' should be able to have `library' in mind for
>> general package information.
>> 
>> So, for me having infrastructure for _automatically_ generated overviews
>> is very nice, but _forcing_ package authors to provide additional
>> meta-information would be less welcome.

> I'm in the Robert/Brian school of thought -- this can be solved with
> better DESCRIPTIONS, or by explicitly writing such a file (which one
> can already do), or through better advertisement / incorporation of
> the vignette tools.

Yep.

> Requiring anything additional is a PITA.   Sure, it doesn't look like
> much time, but it is.  "much" is in the eye of the beholder.

> Perhaps one thing to do is to map  
>    ?<pkgname>.package  
> to 
>    library(help=pkgname)
> as was previously suggested, and let authors put information in the
> DESCRIPTION, perhaps with a lead towards the right help file to use to
> get more.

If we want to do something along these lines, then we could map

   package ? pkgname => help(package = "pkgname")

I don't think we can do something which possibly masks topics for
objects of class package :-)

-k

From hb at maths.lth.se  Wed Jun  8 11:43:10 2005
From: hb at maths.lth.se (Henrik Bengtsson)
Date: Wed Jun  8 11:43:27 2005
Subject: [Rd] Suggestion: help(<package name>)
In-Reply-To: <57c8613071f69cf7daee6e7e3f337c95@soc.soton.ac.uk>
References: <42A57F5D.7080505@maths.lth.se>	<17061.32946.976628.961120@beren.wu-wien.ac.at>	<42A58EDF.80701@stats.uwo.ca>	<1f269abbabca01e19ee3cdbabc9d14f6@soc.soton.ac.uk>	<42A5B96B.9030701@fhcrc.org>
	<42A5BB9D.3000301@stats.uwo.ca>	<42A5C465.3090505@fhcrc.org>
	<42A5C789.3060101@stats.uwo.ca>	<17061.52921.689940.969317@stat.math.ethz.ch>
	<57c8613071f69cf7daee6e7e3f337c95@soc.soton.ac.uk>
Message-ID: <42A6BDAE.8090501@maths.lth.se>

It seems that it comes down to two things: 1) a standard Rd topic or 
alias <pkg>.package, and 2) enforcing this standard with R CMD check.

Pro's and con's for (1):

Pros:
- Easy to find overview information on a package, that is, you know 
*where* to find it.
- Allows a packages to link to another package.
- Shows up in the HTML index page.
- The <pkg>.package.html can be included on the CRAN package overview. 
This can then also become the author's "webpage" (kiosk?) for the 
package including installation instructions, license, future plans etc.
Searchable on the web (==you can get information before trying to 
download/install, which sometimes fails; catch 22.)

Cons:
- Conflicts with other topic of the same name.
- "Just another vignette" (?)


Pro's and con's for (2):

Pros:
- Guarantees that a package can link to another package.
- Standard immediately adopted.

Cons:
- Requires more maintainance.
- Without automatic tools, redundancy is introduced (more maintainance).


My comments:

I think it is hard to argue that a standard similar to (1) is unwanted. 
Also, I don't think anyone has objected on this. The objection has been 
on (2). So my suggestion is that one writes up a standard on (1) and 
*ask* developers to follow it.

If enforcement by R CMD check (2) was implemented too, then I think it 
only requires a single \alias{<pkg>.package} in any of the Rd files, 
because as far as I understand it at least one is required. This would 
not require much work ("almost cheap"). This would guarantee a link at 
least to something. A more advanced version is that the <pkg>.package.Rd 
file is automatically created by R CMD build if missing ("zero cost").

To follow up on Gabor's suggestion to add more R CMD check granuality 
than errors and warnings. Using classes and the "new" exception 
handling, one could introduce a warning class called "Suggestion" 
(CranSuggestion), which gives suggestions to the user, but not enforce 
them (warning are not allowed on CRAN).

To extend this idea further, one could add non-enforced checks if a 
package follows certain standardizations or not.  I can image such 
checks to be plugins to R CMD check or standalone.  Other solutions may 
also used.  For instance, R CMD checkRCC could check a package against 
the coding convention RCC (http://www.maths.lth.se/help/R/RCC/). 
Supplementary or complementary standards can provide their own checks. 
Such tools would be helpful for large projects to conform to the same 
standards, but not enforcing them.  Packages following certain standards 
could then advertize this to help the user and other developers 
utilizing their packages and so.

To summarize, I think it is good if you can communicate that you follow 
a certain standard, and it is even better if more peoples are using the 
same standard. I agree, that enforced standards are painful, if you 
disagree with them (or find the unnecessary).

Cheers

Henrik


Robin Hankin wrote:
> The reason I like .Rd files is that I can run the examples easily and, 
> as Martin points out,
> one does not need to learn a new syntax.
> 
> How about adding the following to R-exts:
> 
> "We encourage the package developer to include a file named 
> foo.package.Rd in the "man"
> directory, to provide a terse overview of the foo package.  This Rd file 
> is intended to be
> the first port of call for a new user of the package, and should provide 
> (or point to)
> working examples of the package's functionality.  It may also provide 
> details or rationale
> for the package's structure, if non-standard; and perhaps document other 
> features of
> the package that might escape a new user's notice.
> 
> See package foo for an example"
> 
> and package.skeleton() could be modified to  write a skeleton version of 
> foo.package.Rd
> and put it in the man directory.
> 
> best wishes everyone
> 
> rksh
> 
> 
> Duncan writes:
> 
>>
>> My proposal (modified following the suggestions I've heard so far) is 
>> as follows:
>>
>>  - to check that a couple of help topic aliases exist (<pkg>.package 
>> and <pkg>)
>>  - to recommend that <pkg>.package contain general information about 
>> the package, and that <pkg> be an alias for it, if it isn't used for 
>> some other purpose.
>>  - to write promptPackage() to help create an initial version of 
>> <pkg>.package.Rd.  It can get some information from the DESCRIPTION 
>> file; perhaps it could go looking for a vignette, or the INDEX, or
>>  - to modify the other help system tools to make use of this (e.g. the 
>> package:<pkg> heading on a page would become a link to the 
>> <pkg>.package alias, etc.)
>>
> 
> Martin:
> 
>> And as much as I do like (and read) the vignettes that are
>> available, I also do agree that writing one other *.Rd file is
>> easier for many new package authors than to write a
>> vignette -- the package author already had to learn *.Rd syntax
>> anyway -- and it's nice to be able to produce something where
>> hyperlinks to the other existing reference material (ie. help
>> pages) just works out of the box.
>>
> 
> Duncan again:
> 
>> Currently R has 3 types of help:  the .Rd files in the man directory 
>> (which are converted into plain text, HTML, compiled HTML, LaTex, DVI, 
>> PDF, etc), the vignettes, and unstructured files in inst/doc.  We 
>> currently require .Rd files for every function and data object.  
>> Adding a requirement to also document the package that way is not all 
>> that much of a burden, and will automatically give all those output 
>> formats I listed above.  It will help to solve the often-complained 
>> about problem   of packages that contain no overview at all.  
>> (Requiring a vignette and giving a way to display it would also do 
>> that, but I think requiring a .Rd file is less of a burden, and for 
>> anyone who has gone to the trouble of creating a vignette, gives a 
>> natural place for a link to it.  Vignettes aren't used as much as they 
>> should be,  because they are hidden away where users don't see them.)
> 
> 
>>
>>
> -- 
> Robin Hankin
> Uncertainty Analyst
> National Oceanography Centre, Southampton
> European Way, Southampton SO14 3ZH, UK
>  tel  023-8059-7743
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
>

From murdoch at stats.uwo.ca  Wed Jun  8 13:05:21 2005
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Wed Jun  8 13:05:30 2005
Subject: [Rd] Suggestion: help(<package name>)
In-Reply-To: <42A6BDAE.8090501@maths.lth.se>
References: <42A57F5D.7080505@maths.lth.se>	<17061.32946.976628.961120@beren.wu-wien.ac.at>	<42A58EDF.80701@stats.uwo.ca>	<1f269abbabca01e19ee3cdbabc9d14f6@soc.soton.ac.uk>	<42A5B96B.9030701@fhcrc.org>	<42A5BB9D.3000301@stats.uwo.ca>	<42A5C465.3090505@fhcrc.org>	<42A5C789.3060101@stats.uwo.ca>	<17061.52921.689940.969317@stat.math.ethz.ch>	<57c8613071f69cf7daee6e7e3f337c95@soc.soton.ac.uk>
	<42A6BDAE.8090501@maths.lth.se>
Message-ID: <42A6D0F1.6090600@stats.uwo.ca>

Henrik Bengtsson wrote:
> It seems that it comes down to two things: 1) a standard Rd topic or 
> alias <pkg>.package, and 2) enforcing this standard with R CMD check.
> 
> Pro's and con's for (1):
> 
> Pros:
> - Easy to find overview information on a package, that is, you know 
> *where* to find it.
> - Allows a packages to link to another package.
> - Shows up in the HTML index page.
> - The <pkg>.package.html can be included on the CRAN package overview. 
> This can then also become the author's "webpage" (kiosk?) for the 
> package including installation instructions, license, future plans etc.
> Searchable on the web (==you can get information before trying to 
> download/install, which sometimes fails; catch 22.)
> 
> Cons:
> - Conflicts with other topic of the same name.
> - "Just another vignette" (?)
> 
> 
> Pro's and con's for (2):
> 
> Pros:
> - Guarantees that a package can link to another package.
> - Standard immediately adopted.
> 
> Cons:
> - Requires more maintainance.
> - Without automatic tools, redundancy is introduced (more maintainance).
> 
> 
> My comments:
> 
> I think it is hard to argue that a standard similar to (1) is unwanted. 
> Also, I don't think anyone has objected on this. The objection has been 
> on (2). So my suggestion is that one writes up a standard on (1) and 
> *ask* developers to follow it.
> 
> If enforcement by R CMD check (2) was implemented too, then I think it 
> only requires a single \alias{<pkg>.package} in any of the Rd files, 
> because as far as I understand it at least one is required. This would 
> not require much work ("almost cheap"). This would guarantee a link at 
> least to something. A more advanced version is that the <pkg>.package.Rd 
> file is automatically created by R CMD build if missing ("zero cost").

I really like this "zero cost" option.  I think it addresses the main 
problem with the proposal (all the work for package writers that it 
creates), while keeping the main benefit (a standard place for package 
help *within the help system*).

It might be tricky to implement (the build tools aren't all in R and 
aren't consistent across platforms), but it seems like a reasonable 
compromise to me.

Duncan Murdoch

> 
> To follow up on Gabor's suggestion to add more R CMD check granuality 
> than errors and warnings. Using classes and the "new" exception 
> handling, one could introduce a warning class called "Suggestion" 
> (CranSuggestion), which gives suggestions to the user, but not enforce 
> them (warning are not allowed on CRAN).
> 
> To extend this idea further, one could add non-enforced checks if a 
> package follows certain standardizations or not.  I can image such 
> checks to be plugins to R CMD check or standalone.  Other solutions may 
> also used.  For instance, R CMD checkRCC could check a package against 
> the coding convention RCC (http://www.maths.lth.se/help/R/RCC/). 
> Supplementary or complementary standards can provide their own checks. 
> Such tools would be helpful for large projects to conform to the same 
> standards, but not enforcing them.  Packages following certain standards 
> could then advertize this to help the user and other developers 
> utilizing their packages and so.
> 
> To summarize, I think it is good if you can communicate that you follow 
> a certain standard, and it is even better if more peoples are using the 
> same standard. I agree, that enforced standards are painful, if you 
> disagree with them (or find the unnecessary).
> 
> Cheers
> 
> Henrik
> 
> 
> Robin Hankin wrote:
> 
>>The reason I like .Rd files is that I can run the examples easily and, 
>>as Martin points out,
>>one does not need to learn a new syntax.
>>
>>How about adding the following to R-exts:
>>
>>"We encourage the package developer to include a file named 
>>foo.package.Rd in the "man"
>>directory, to provide a terse overview of the foo package.  This Rd file 
>>is intended to be
>>the first port of call for a new user of the package, and should provide 
>>(or point to)
>>working examples of the package's functionality.  It may also provide 
>>details or rationale
>>for the package's structure, if non-standard; and perhaps document other 
>>features of
>>the package that might escape a new user's notice.
>>
>>See package foo for an example"
>>
>>and package.skeleton() could be modified to  write a skeleton version of 
>>foo.package.Rd
>>and put it in the man directory.
>>
>>best wishes everyone
>>
>>rksh
>>
>>
>>Duncan writes:
>>
>>
>>>My proposal (modified following the suggestions I've heard so far) is 
>>>as follows:
>>>
>>> - to check that a couple of help topic aliases exist (<pkg>.package 
>>>and <pkg>)
>>> - to recommend that <pkg>.package contain general information about 
>>>the package, and that <pkg> be an alias for it, if it isn't used for 
>>>some other purpose.
>>> - to write promptPackage() to help create an initial version of 
>>><pkg>.package.Rd.  It can get some information from the DESCRIPTION 
>>>file; perhaps it could go looking for a vignette, or the INDEX, or
>>> - to modify the other help system tools to make use of this (e.g. the 
>>>package:<pkg> heading on a page would become a link to the 
>>><pkg>.package alias, etc.)
>>>
>>
>>Martin:
>>
>>
>>>And as much as I do like (and read) the vignettes that are
>>>available, I also do agree that writing one other *.Rd file is
>>>easier for many new package authors than to write a
>>>vignette -- the package author already had to learn *.Rd syntax
>>>anyway -- and it's nice to be able to produce something where
>>>hyperlinks to the other existing reference material (ie. help
>>>pages) just works out of the box.
>>>
>>
>>Duncan again:
>>
>>
>>>Currently R has 3 types of help:  the .Rd files in the man directory 
>>>(which are converted into plain text, HTML, compiled HTML, LaTex, DVI, 
>>>PDF, etc), the vignettes, and unstructured files in inst/doc.  We 
>>>currently require .Rd files for every function and data object.  
>>>Adding a requirement to also document the package that way is not all 
>>>that much of a burden, and will automatically give all those output 
>>>formats I listed above.  It will help to solve the often-complained 
>>>about problem   of packages that contain no overview at all.  
>>>(Requiring a vignette and giving a way to display it would also do 
>>>that, but I think requiring a .Rd file is less of a burden, and for 
>>>anyone who has gone to the trouble of creating a vignette, gives a 
>>>natural place for a link to it.  Vignettes aren't used as much as they 
>>>should be,  because they are hidden away where users don't see them.)
>>
>>
>>>
>>-- 
>>Robin Hankin
>>Uncertainty Analyst
>>National Oceanography Centre, Southampton
>>European Way, Southampton SO14 3ZH, UK
>> tel  023-8059-7743
>>
>>______________________________________________
>>R-devel@stat.math.ethz.ch mailing list
>>https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>>
> 
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

From murdoch at stats.uwo.ca  Wed Jun  8 13:45:39 2005
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Wed Jun  8 13:45:43 2005
Subject: [Rd] Suggestion: help(<package name>)
In-Reply-To: <Pine.LNX.4.51.0506080918210.12890@artemis.imbe.med.uni-erlangen.de>
References: <42A57F5D.7080505@maths.lth.se>	<17061.32946.976628.961120@beren.wu-wien.ac.at>	<42A58EDF.80701@stats.uwo.ca>	<1f269abbabca01e19ee3cdbabc9d14f6@soc.soton.ac.uk>	<42A5B96B.9030701@fhcrc.org>
	<42A5BB9D.3000301@stats.uwo.ca>	<42A5C465.3090505@fhcrc.org>
	<42A5C789.3060101@stats.uwo.ca>	<42A5D279.3010501@fhcrc.org>	<Pine.LNX.4.61.0506071823460.5947@gannet.stats>	<42A6687A.3000804@stats.uwo.ca>
	<Pine.LNX.4.51.0506080918210.12890@artemis.imbe.med.uni-erlangen.de>
Message-ID: <42A6DA63.7020301@stats.uwo.ca>

Torsten Hothorn wrote:
> On Tue, 7 Jun 2005, Duncan Murdoch wrote:
> 
> [...]
> 
> 
>>My proposal (modified following the suggestions I've heard so far) is as
>>follows:
>>
>>  - to check that a couple of help topic aliases exist (<pkg>.package
>>and <pkg>)
>>  - to recommend that <pkg>.package contain general information about
>>the package, and that <pkg> be an alias for it, if it isn't used for
>>some other purpose.
>>  - to write promptPackage() to help create an initial version of
>><pkg>.package.Rd.  It can get some information from the DESCRIPTION
>>file; perhaps it could go looking for a vignette, or the INDEX, or
>>  - to modify the other help system tools to make use of this (e.g. the
>>package:<pkg> heading on a page would become a link to the <pkg>.package
>>alias, etc.)
>>
> 
> 
> as a package author who already provides help pages for general package
> descriptions (`?multcomp' and `?coin' work and, if I remember correctly,
> Martin suggested to include the advertisement this way) I must
> admit that I never say `?foo' when I'm interested in a global overview
> about a new package `foo'.

I do occasionally, but usually it's a waste of time.  This proposal is 
intended to address that.

> Instead, `library(help = foo)' gives what I want to see, namely the title
> and description of a package and all documented topics. One may argue that
> asking `library' for help is not the most obvious thing to do. But people
> able to recall that fitting an ANOVA model requires `aov' and comparing
> two models needs `anova' should be able to have `library' in mind for
> general package information.

As I pointed out, this is okay for people who know R already, but not so 
good for beginners.  The answer to the question "how do I get help on 
foo?" is too complex.

> So, for me having infrastructure for _automatically_ generated overviews
> is very nice, but _forcing_ package authors to provide additional
> meta-information would be less welcome.

What do you think of Henrik's suggestion to generate a help topic giving 
information equivalent to library(help=<pkg>)?  I think this would 
happen at install time (not build time as he said; no need to put this 
in the source tarballs).  If the <pkg>.package alias wasn't defined, the 
installer would automatically create one.

If we had this in place, I'd strengthen the advice in R-Exts not to 
bother with a manually created INDEX file:  that information should go 
into a manually created <pkg>.package topic instead.

Duncan Murdoch

From olayinka at tv24.tv  Wed Jun  8 19:43:23 2005
From: olayinka at tv24.tv (burl quaresma)
Date: Wed Jun  8 14:11:27 2005
Subject: [Rd] Hey, Do you like to see specials on top-selling taablets?
Message-ID: <972AC46D.244DFBA@tv24.tv>

our chernist-site helps you bank a lot on quality rxmeds. It is an easy and
legitimate way to not lose your shirt when buying at your local store. 
 
Our chemist-store provides a wide selection of rxdrugs on Pain, Erectile
Tissue Dysfunction, Gynecological care, Distress, Obesity, Elevated
cholesterol levels, Muscle-relaxant and Sleeping Disorder. Check our store
if you prefer quick and professional support staff.

You have a great chance to take advantage of our specials on quality
taablets in our store.

http://v.b4.sweetcandyhome.com/emm/

Select our site for quick and professional case profile check.  It is
complimentary.


-----original message-----
From: Dwight@qfot.com [mailto:Levi@uxh.com]
Sent: Thursday, March 2, 2005 4:00PM
To: Felix; Myron@wd.com; ; Elias; Odell
Subject: Check our store if you would like to have your case profile
checked by licensed physicians with zero charge.

The remedies sold at your store are absolutely super. It is really such a
wonderful experience receiving these great value. The quick handling
services brought me greater convenience. -- Lydia D.  in NY 


elief that she had  this was the way to confront the thing, this w but for
my part I decl  got him. Though
vered to talk, I was perfectly able to reflec are I never think about him
from one hour's end to another.  'L  there w
ord! here comes your beau, Nancy,' my cousin said t'other day,  as nothing
very air
when s y about Miss Murdstone, she was  a per t.  I fect Lark in point of
ge tting up. She was up (and,

From francoisromain at free.fr  Wed Jun  8 14:08:03 2005
From: francoisromain at free.fr (Romain Francois)
Date: Wed Jun  8 14:15:27 2005
Subject: [Rd] When are the perl modules compiled
Message-ID: <42A6DFA3.9000304@free.fr>

Hello expeRts,

i would like to know when the perl modules are compiled, especially Rdconv.

I played a little bit with the html help pages after the perl step, 
basically to change the body tag and add some stuff, but i would like 
perl to do that when building help pages. The goal of all that is to 
create a java-like frame based help system. First try (it is just a 
start) is available here :
http://addictedtor.free.fr/graphiques/help/

Could you please put my e mail in the replies. I am not (yet) a 
subscriber to R-devel.

Thanks.

Romain

-- 
visit the R Graph Gallery : http://addictedtor.free.fr/graphiques
~~~~~~~~ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ ~~~~~~~~
~~~~~~      Romain FRANCOIS - http://addictedtor.free.fr         ~~~~~~
~~~~        Etudiant  ISUP - CS3 - Industrie et Services           ~~~~
~~                http://www.isup.cicrp.jussieu.fr/                  ~~
~~~~           Stagiaire INRIA Futurs - Equipe SELECT              ~~~~
~~~~~~   http://www.inria.fr/recherche/equipes/select.fr.html    ~~~~~~
~~~~~~~~ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ ~~~~~~~~

From ggrothendieck at gmail.com  Wed Jun  8 15:20:34 2005
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Wed Jun  8 15:20:43 2005
Subject: [Rd] Re: [R] How to vectorize
In-Reply-To: <971536df050606193673641113@mail.gmail.com>
References: <BF8E83A574F8FF40BD5C0266B2A4DF880153C1E1@canna.proton.intra.irsn.fr>
	<971536df050606193673641113@mail.gmail.com>
Message-ID: <971536df05060806203fb948ec@mail.gmail.com>

To r-devel:

The discussion below on r-help brought out the following:

> plot(1:10)
> text(5,5,lab=expression(italic(22*"33")))

has the effect of italicizing 33 (which is a character string) but not 22
(which is not).  Is this intended behavior?  It seems strange.

I am using  "R version 2.1.0, 2005-05-14" on Windows XP.

On 6/6/05, Gabor Grothendieck <ggrothendieck@gmail.com> wrote:
> On 6/6/05, PANTERA Laurent <laurent.pantera@irsn.fr> wrote:
> > Dear R-List,
> >
> >     I would like to write nicely the names of some isotopes on a plot. The
> > code bellow works fine.
> >
> > plot(1:10,1:10)
> > text(c(2,4,8),c(2,4,8),labels=c(expression(italic(phantom(0)^{78}*Ge)),
> >                                expression(italic(phantom(0)^{137}*Cs)),
> >                                expression(italic(phantom(0)^{129*m}*Te))),
> >     cex=3
> >     )
> >
> > But, since I have a lot of isotopes to write on the plot, I would like
> > to construct automatically the labels. So I wrote the code below which
> > works fine.
> >
> > listenoms <- list(nom=c("Ge","Cs","Te"),num=c("78","137","129*m"))
> > n <- length(listenoms$nom)
> > resu <- "c("
> > for( i in 1:(n-1))
> >  {
> >    resu <- paste(resu,paste("expression(italic(phantom(0)^{",
> >                         listenoms$num[i],"}*",
> >                         listenoms$nom[i],")),",sep=""))
> > }
> > resu <- paste(resu,paste("expression(italic(phantom(0)^{",
> >                         listenoms$num[n],"}*",
> >                         listenoms$nom[n],")))",sep=""))
> > plot(1:10,1:10)
> > text(c(2,4,8),c(2,4,8),labels=eval(parse(text=resu)),cex=2)
> >
> > I assume there is a better way to do that using vectorization.
> > May you help me to find it ?
> >
> 
> Assuming your setup:
> 
> x <- c(2,4,8)
> nom <- c("Ge","Cs","Te")
> num <- c("78","137","129*m")
> plot(1:10)
> 
> # the ith label can be generated via
> lab <- function(i)
>  as.expression(bquote(italic(phantom(0)^{.(num[i])}*.(nom[i]))))
> 
> # giving the following vectorized solution
> labs <- lapply(seq(x), lab)
> text(x,x,do.call(c,labs))
> 
> # although a 'for' loop is arguably simpler
> plot(1:10)
> for(i in seq(x)) text(x[i], x[i], lab(i))
>

From torsten at hothorn.de  Wed Jun  8 16:36:23 2005
From: torsten at hothorn.de (torsten@hothorn.de)
Date: Wed Jun  8 16:37:37 2005
Subject: [Rd] Suggestion: help(<package name>)
In-Reply-To: <42A6DA63.7020301@stats.uwo.ca>
References: <42A57F5D.7080505@maths.lth.se>
	<17061.32946.976628.961120@beren.wu-wien.ac.at>
	<42A58EDF.80701@stats.uwo.ca>
	<1f269abbabca01e19ee3cdbabc9d14f6@soc.soton.ac.uk>
	<42A5B96B.9030701@fhcrc.org> <42A5BB9D.3000301@stats.uwo.ca>
	<42A5C465.3090505@fhcrc.org> <42A5C789.3060101@stats.uwo.ca>
	<42A5D279.3010501@fhcrc.org>
	<Pine.LNX.4.61.0506071823460.5947@gannet.stats>
	<42A6687A.3000804@stats.uwo.ca>
	<Pine.LNX.4.51.0506080918210.12890@artemis.imbe.med.uni-erlangen.de>
	<42A6DA63.7020301@stats.uwo.ca>
Message-ID: <Pine.LNX.4.51.0506081633120.22022@artemis.imbe.med.uni-erlangen.de>



On Wed, 8 Jun 2005, Duncan Murdoch wrote:

> Torsten Hothorn wrote:
> > On Tue, 7 Jun 2005, Duncan Murdoch wrote:
> >
> > [...]
> >
> >
> >>My proposal (modified following the suggestions I've heard so far) is as
> >>follows:
> >>
> >>  - to check that a couple of help topic aliases exist (<pkg>.package
> >>and <pkg>)
> >>  - to recommend that <pkg>.package contain general information about
> >>the package, and that <pkg> be an alias for it, if it isn't used for
> >>some other purpose.
> >>  - to write promptPackage() to help create an initial version of
> >><pkg>.package.Rd.  It can get some information from the DESCRIPTION
> >>file; perhaps it could go looking for a vignette, or the INDEX, or
> >>  - to modify the other help system tools to make use of this (e.g. the
> >>package:<pkg> heading on a page would become a link to the <pkg>.package
> >>alias, etc.)
> >>
> >
> >
> > as a package author who already provides help pages for general package
> > descriptions (`?multcomp' and `?coin' work and, if I remember correctly,
> > Martin suggested to include the advertisement this way) I must
> > admit that I never say `?foo' when I'm interested in a global overview
> > about a new package `foo'.
>
> I do occasionally, but usually it's a waste of time.  This proposal is
> intended to address that.
>
> > Instead, `library(help = foo)' gives what I want to see, namely the title
> > and description of a package and all documented topics. One may argue that
> > asking `library' for help is not the most obvious thing to do. But people
> > able to recall that fitting an ANOVA model requires `aov' and comparing
> > two models needs `anova' should be able to have `library' in mind for
> > general package information.
>
> As I pointed out, this is okay for people who know R already, but not so
> good for beginners.  The answer to the question "how do I get help on
> foo?" is too complex.
>
> > So, for me having infrastructure for _automatically_ generated overviews
> > is very nice, but _forcing_ package authors to provide additional
> > meta-information would be less welcome.
>
> What do you think of Henrik's suggestion to generate a help topic giving
> information equivalent to library(help=<pkg>)?  I think this would
> happen at install time (not build time as he said; no need to put this
> in the source tarballs).  If the <pkg>.package alias wasn't defined, the
> installer would automatically create one.
>
> If we had this in place, I'd strengthen the advice in R-Exts not to
> bother with a manually created INDEX file:  that information should go
> into a manually created <pkg>.package topic instead.

yes, this sounds reasonable - as long as ?<pkg>.package is a "link" to

library(help = <pkg>)

(or help(package = <pkg> as I learned only recently) when no
<pkg>.package.Rd file exists in <pkg>, this would be fine, of course.

Best,

Torsten

>
> Duncan Murdoch
>

From jg_liao at yahoo.com  Wed Jun  8 18:42:10 2005
From: jg_liao at yahoo.com (Jason Liao)
Date: Wed Jun  8 18:42:19 2005
Subject: [Rd] feature request: enhance solve function with a symmetric
	option for faster operation for symmetric matrix
Message-ID: <20050608164210.72606.qmail@web53704.mail.yahoo.com>

Dear R developers,

Recently I have a simulation program that needs to solve a large number
of linear regression A x = b, where A is symmetric and constantly
chnages. I found that the solve function is considerably less efficient
than 

     solve_symmetric = function(A, B)
      {
         chol2inv(chol(A)) %*% B;
      }

So I would request that the solve function be enhanced with an
symmetric option, which defaults to FALSE, the current solve. But when
symmetric=TRUE, a more efficient algorithm for symmetric matrix is
used. Thanks.

Jason


Jason Liao, http://www.geocities.com/jg_liao
Dept. of Biostatistics, http://www2.umdnj.edu/bmtrxweb
University of Medicine and Dentistry of New Jersey
683 Hoes Lane West, Piscataway? NJ 08854
phone 732-235-5429, School of Public Health office
phone 732-235-9824, Cancer Institute of New Jersey office

From dmbates at gmail.com  Wed Jun  8 19:07:21 2005
From: dmbates at gmail.com (Douglas Bates)
Date: Wed Jun  8 19:07:33 2005
Subject: [Rd] feature request: enhance solve function with a symmetric
	option for faster operation for symmetric matrix
In-Reply-To: <20050608164210.72606.qmail@web53704.mail.yahoo.com>
References: <20050608164210.72606.qmail@web53704.mail.yahoo.com>
Message-ID: <40e66e0b0506081007608a3edf@mail.gmail.com>

On 6/8/05, Jason Liao <jg_liao@yahoo.com> wrote:
> Dear R developers,
> 
> Recently I have a simulation program that needs to solve a large number
> of linear regression A x = b, where A is symmetric and constantly
> chnages. I found that the solve function is considerably less efficient
> than
> 
>      solve_symmetric = function(A, B)
>       {
>          chol2inv(chol(A)) %*% B;
>       }
> 
> So I would request that the solve function be enhanced with an
> symmetric option, which defaults to FALSE, the current solve. But when
> symmetric=TRUE, a more efficient algorithm for symmetric matrix is
> used. Thanks.
> 
> Jason
> 
> 
> Jason Liao, http://www.geocities.com/jg_liao
> Dept. of Biostatistics, http://www2.umdnj.edu/bmtrxweb
> University of Medicine and Dentistry of New Jersey
> 683 Hoes Lane West, Piscataway? NJ 08854
> phone 732-235-5429, School of Public Health office
> phone 732-235-9824, Cancer Institute of New Jersey office
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 

Try the dsyMatrix or dpoMatrix class in the Matrix package.

From murdoch at stats.uwo.ca  Wed Jun  8 19:20:49 2005
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Wed Jun  8 19:23:04 2005
Subject: [Rd] Suggestion: help(<package name>)
In-Reply-To: <Pine.LNX.4.51.0506081633120.22022@artemis.imbe.med.uni-erlangen.de>
References: <42A57F5D.7080505@maths.lth.se>	<17061.32946.976628.961120@beren.wu-wien.ac.at>	<42A58EDF.80701@stats.uwo.ca>	<1f269abbabca01e19ee3cdbabc9d14f6@soc.soton.ac.uk>	<42A5B96B.9030701@fhcrc.org>
	<42A5BB9D.3000301@stats.uwo.ca>	<42A5C465.3090505@fhcrc.org>
	<42A5C789.3060101@stats.uwo.ca>	<42A5D279.3010501@fhcrc.org>	<Pine.LNX.4.61.0506071823460.5947@gannet.stats>	<42A6687A.3000804@stats.uwo.ca>	<Pine.LNX.4.51.0506080918210.12890@artemis.imbe.med.uni-erlangen.de>	<42A6DA63.7020301@stats.uwo.ca>
	<Pine.LNX.4.51.0506081633120.22022@artemis.imbe.med.uni-erlangen.de>
Message-ID: <42A728F1.8080503@stats.uwo.ca>

On 6/8/2005 10:36 AM, torsten@hothorn.de wrote:
> 
> On Wed, 8 Jun 2005, Duncan Murdoch wrote:
> 
>> Torsten Hothorn wrote:
>> > On Tue, 7 Jun 2005, Duncan Murdoch wrote:
>> >
>> > [...]
>> >
>> >
>> >>My proposal (modified following the suggestions I've heard so far) is as
>> >>follows:
>> >>
>> >>  - to check that a couple of help topic aliases exist (<pkg>.package
>> >>and <pkg>)
>> >>  - to recommend that <pkg>.package contain general information about
>> >>the package, and that <pkg> be an alias for it, if it isn't used for
>> >>some other purpose.
>> >>  - to write promptPackage() to help create an initial version of
>> >><pkg>.package.Rd.  It can get some information from the DESCRIPTION
>> >>file; perhaps it could go looking for a vignette, or the INDEX, or
>> >>  - to modify the other help system tools to make use of this (e.g. the
>> >>package:<pkg> heading on a page would become a link to the <pkg>.package
>> >>alias, etc.)
>> >>
>> >
>> >
>> > as a package author who already provides help pages for general package
>> > descriptions (`?multcomp' and `?coin' work and, if I remember correctly,
>> > Martin suggested to include the advertisement this way) I must
>> > admit that I never say `?foo' when I'm interested in a global overview
>> > about a new package `foo'.
>>
>> I do occasionally, but usually it's a waste of time.  This proposal is
>> intended to address that.
>>
>> > Instead, `library(help = foo)' gives what I want to see, namely the title
>> > and description of a package and all documented topics. One may argue that
>> > asking `library' for help is not the most obvious thing to do. But people
>> > able to recall that fitting an ANOVA model requires `aov' and comparing
>> > two models needs `anova' should be able to have `library' in mind for
>> > general package information.
>>
>> As I pointed out, this is okay for people who know R already, but not so
>> good for beginners.  The answer to the question "how do I get help on
>> foo?" is too complex.
>>
>> > So, for me having infrastructure for _automatically_ generated overviews
>> > is very nice, but _forcing_ package authors to provide additional
>> > meta-information would be less welcome.
>>
>> What do you think of Henrik's suggestion to generate a help topic giving
>> information equivalent to library(help=<pkg>)?  I think this would
>> happen at install time (not build time as he said; no need to put this
>> in the source tarballs).  If the <pkg>.package alias wasn't defined, the
>> installer would automatically create one.
>>
>> If we had this in place, I'd strengthen the advice in R-Exts not to
>> bother with a manually created INDEX file:  that information should go
>> into a manually created <pkg>.package topic instead.
> 
> yes, this sounds reasonable - as long as ?<pkg>.package is a "link" to
> 
> library(help = <pkg>)
> 
> (or help(package = <pkg> as I learned only recently) when no
> <pkg>.package.Rd file exists in <pkg>, this would be fine, of course.

No, that wouldn't work.  We have no reliable way for an HTML file to 
tell R to do anything, and one way to get to this topic should be 
through a URL to the HTML version of the help file.  What I was planning 
was to generate a <pkg>.package.Rd file at install time, with 
information equivalent to the result of library(help = <pkg>).

This will tend to be ugly, because there is no way to know whether the 
user has edited the INDEX file; since it already has ascii formatting 
built in, it won't look like very good HTML.   The part that 
library(help = <pkg>) gets from the DESCRIPTION file could have better 
formatting because that information is available in structured form.
I haven't looked at the vignette information yet.

It would probably be desirable in the long run to change the behaviour 
of library(help = <pkg>) to just call help(), but that loses the return 
result, so I wouldn't suggest doing it right away.

Duncan Murdoch

From murdoch at stats.uwo.ca  Wed Jun  8 22:02:08 2005
From: murdoch at stats.uwo.ca (murdoch@stats.uwo.ca)
Date: Wed Jun  8 22:02:17 2005
Subject: [Rd] Bug in help(package=) (PR#7923)
Message-ID: <20050608200208.41EA4A1B4@slim.kubism.ku.dk>

The following is a bug or mis-design in help(package=):

 > showhelp <- function(packageName) help(package=packageName)
 >
 > showhelp("utils")
Error in .find.package(pkgName, lib.loc, verbose = verbose) :
         none of the packages were found

The problem is that it calls library(help=) with argument "packageName" 
instead of "utils".  Unlike library(), it has no character.only argument 
to force interpretation of the packageName as a character vector.

--please do not edit the information below--

Version:
  platform = i386-pc-mingw32
  arch = i386
  os = mingw32
  system = i386, mingw32
  status =
  major = 2
  minor = 1.0
  year = 2005
  month = 04
  day = 18
  language = R

Windows XP Professional (build 2600) Service Pack 2.0

Search Path:
  .GlobalEnv, package:methods, package:stats, package:graphics, 
package:grDevices, package:utils, package:datasets, Autoloads, package:base

From p.murrell at auckland.ac.nz  Wed Jun  8 22:15:31 2005
From: p.murrell at auckland.ac.nz (Paul Murrell)
Date: Wed Jun  8 22:15:42 2005
Subject: [Rd] Re: [R] Problem going back to a viewport with gridBase
References: <971536df05053020191ebe8f44@mail.gmail.com>	
	<971536df050602140356cc80b4@mail.gmail.com>	
	<429FB4AE.5030105@stat.auckland.ac.nz>	
	<971536df0506030554396c2374@mail.gmail.com>	
	<42A4D286.5090208@stat.auckland.ac.nz>	
	<971536df0506061924438870f0@mail.gmail.com>	
	<42A612FF.5020408@stat.auckland.ac.nz>	
	<971536df05060718376e609133@mail.gmail.com>	
	<971536df0506071857730811a1@mail.gmail.com>	
	<42A6621D.9020101@stat.auckland.ac.nz>
	<971536df0506072044583f7dc1@mail.gmail.com>
Message-ID: <42A751E3.2080500@stat.auckland.ac.nz>

Hi


Gabor Grothendieck wrote:
> Thanks.  Yet one other comment to consider when thinking
> about this.  Even if its not possible
> or advisable to guarantee order, even without the hash=
> idea, it may be possible to guarantee that default names
> are generated in some order that can be used by
> getChildren to ensure that it returns the children in
> the same order they are created or perhaps even some sort
> of timestamp can be attached to objects to facilitate 
> later traversal.


Thanks Gabor.  I will look at a way to ensure that childNames(vpTree) 
returns the names in the order that they were pushed.  This may be as 
simple as porting the mechanism used for grobs and gTrees, where 
(drawing) order is very important.

Paul


> On 6/7/05, Paul Murrell <p.murrell@auckland.ac.nz> wrote:
> 
>>Hi
>>
>>
>>Gabor Grothendieck wrote:
>>
>>>Here is the code once again.  This time I have supplied two
>>>names methods and a getChildren.viewport function to
>>>encapsulate the corresponding grid internals.  It would
>>>be easiest if grid provided these itself but in the absence
>>>of that this does encapsulate dependencies on grid
>>>internals to a well defined set of functions.   Note that
>>>names is only used in 'with' and 'with' will be eliminated
>>>once Deepayan adds the use.viewport= (or whatever
>>>its called) to print.   I am not sure from your response
>>>whether or not you intend to add these items to the grid
>>>API but in any case this provides an intermediate
>>>level of safety.
>>
>>
>>Yep, I've made a note to look at adding these to the grid API.
>>Thanks.
>>
>>Paul
>>
>>
>>
>>>library(grid)
>>>library(lattice)
>>>
>>>pushLayout <- function(nr, nc, name="layout") {
>>>  pushViewport(viewport(layout=grid.layout(nr, nc), name=name))
>>>  for (i in 1:nr) {
>>>    for (j in 1:nc) {
>>>      pushViewport(viewport(layout.pos.row=i, layout.pos.col=j))
>>>      upViewport()
>>>    }
>>>  }
>>>  upViewport()
>>>}
>>>
>>>names.vpPath <- names.viewport <- function(x) x$name
>>>
>>>with.vpPath <- with.viewport <- function(data, expr, ...) {
>>>      # if data is a vpPath it cannot be ROOT since
>>>      # NULL will never dispatch here
>>>      depth <- if (data$name == "ROOT") 0 else downViewport(names(data))
>>>      result <- eval.parent(substitute(expr))
>>>      upViewport(depth)
>>>      invisible(result)
>>>}
>>>
>>>getChildren.viewport <- function(x) x$children
>>>
>>>grid.newpage()
>>>
>>># specify number of cells to fill and number of rows
>>>n <- 5; nr <- 3
>>>
>>>nc <- ceiling(n/nr)
>>>downViewport(pushLayout(nr, nc))
>>>
>>>vpt <- current.vpTree(all = FALSE)
>>>for(k in 1:n) with(getChildren.viewport(vpt)[[k]],
>>>      print( xyplot(v ~ v, list(v = 1:k)), newpage = FALSE )
>>>)
>>
>>
>>--
>>Dr Paul Murrell
>>Department of Statistics
>>The University of Auckland
>>Private Bag 92019
>>Auckland
>>New Zealand
>>64 9 3737599 x85392
>>paul@stat.auckland.ac.nz
>>http://www.stat.auckland.ac.nz/~paul/
>>
> 
>>


-- 
Dr Paul Murrell
Department of Statistics
The University of Auckland
Private Bag 92019
Auckland
New Zealand
64 9 3737599 x85392
paul@stat.auckland.ac.nz
http://www.stat.auckland.ac.nz/~paul/

From tplate at blackmesacapital.com  Thu Jun  9 19:13:07 2005
From: tplate at blackmesacapital.com (tplate@blackmesacapital.com)
Date: Thu Jun  9 19:13:15 2005
Subject: [Rd] single assignment affecting multiple sub-structures (PR#7924)
Message-ID: <20050609171307.C73FFA1EB@slim.kubism.ku.dk>

I'm trying to create a language structure that is a call to a function 
with a number of arguments that is only known at run time.  I do this by 
using repeated indices to expand out a call with a single argument. 
However, when I change one of the arguments, all are changed.

I don't see the same behavior when I initially create a call with 
multiple arguments.

Even more strangely, calling identical(call1, call2) before any attempts 
to modify the structures changes the subsequent behavior to be correct.

[If there are better methods to create and modify calls, please let me 
know!]

 > # Example of commands that give incorrect results
 > call1 <- Quote(f(arg[[1]], arg[[1]], arg[[1]]))
 > call2 <- Quote(f(arg[[1]]))[c(1,2,2,2)]
 > call1
f(arg[[1]], arg[[1]], arg[[1]])
 > call2
f(arg[[1]], arg[[1]], arg[[1]])
 > call1[[3]][[3]] <- 2
 > call2[[3]][[3]] <- 2
 > call1
f(arg[[1]], arg[[2]], arg[[1]])
 > # note that all the arguments of call2 have changed!
 > call2
f(arg[[2]], arg[[2]], arg[[2]])
 > identical(call1, call2)
[1] FALSE
 >
 > # if we do 'identical(call1, call2)' directly
 > # after creation, then everything behaves correctly !??
 > call1 <- Quote(f(arg[[1]], arg[[1]], arg[[1]]))
 > call2 <- Quote(f(arg[[1]]))[c(1,2,2,2)]
 > identical(call1, call2)
[1] TRUE
 > call1
f(arg[[1]], arg[[1]], arg[[1]])
 > call2
f(arg[[1]], arg[[1]], arg[[1]])
 > call1[[3]][[3]] <- 2
 > call2[[3]][[3]] <- 2
 > call1
f(arg[[1]], arg[[2]], arg[[1]])
 > call2
f(arg[[1]], arg[[2]], arg[[1]])
 > identical(call1, call2)
[1] TRUE
 >
 > # The same thing happens when the call is created using 'call()'
 > call3 <- call("f", call("[[", as.name("arg"), 1))[c(1,2,2,2)]
 > call3
f(arg[[1]], arg[[1]], arg[[1]])
 > call3[[3]][[3]] <- 2
 > call3
f(arg[[2]], arg[[2]], arg[[2]])
 >
 > version
          _
platform i386-pc-mingw32
arch     i386
os       mingw32
system   i386, mingw32
status
major    2
minor    1.0
year     2005
month    04
day      18
language R
 >


I also see the same behavior in the development release of R:
 > version
          _
platform i386-pc-mingw32
arch     i386
os       mingw32
system   i386, mingw32
status   Under development (unstable)
major    2
minor    2.0
year     2005
month    06
day      07
svn rev  34588
language R
 >

-- Tony Plate

From murdoch at stats.uwo.ca  Thu Jun  9 21:29:25 2005
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Thu Jun  9 21:29:33 2005
Subject: [Rd] Suggestion: help(<package name>)
In-Reply-To: <Pine.LNX.4.51.0506081633120.22022@artemis.imbe.med.uni-erlangen.de>
References: <42A57F5D.7080505@maths.lth.se>	<17061.32946.976628.961120@beren.wu-wien.ac.at>	<42A58EDF.80701@stats.uwo.ca>	<1f269abbabca01e19ee3cdbabc9d14f6@soc.soton.ac.uk>	<42A5B96B.9030701@fhcrc.org>
	<42A5BB9D.3000301@stats.uwo.ca>	<42A5C465.3090505@fhcrc.org>
	<42A5C789.3060101@stats.uwo.ca>	<42A5D279.3010501@fhcrc.org>	<Pine.LNX.4.61.0506071823460.5947@gannet.stats>	<42A6687A.3000804@stats.uwo.ca>	<Pine.LNX.4.51.0506080918210.12890@artemis.imbe.med.uni-erlangen.de>	<42A6DA63.7020301@stats.uwo.ca>
	<Pine.LNX.4.51.0506081633120.22022@artemis.imbe.med.uni-erlangen.de>
Message-ID: <42A89895.6090905@stats.uwo.ca>

>> > On Tue, 7 Jun 2005, Duncan Murdoch wrote:
>> >
>> > [...]
>> >
>> >
>> >>My proposal (modified following the suggestions I've heard so far) is as
>> >>follows:
>> >>
>> >>  - to check that a couple of help topic aliases exist (<pkg>.package
>> >>and <pkg>)
>> >>  - to recommend that <pkg>.package contain general information about
>> >>the package, and that <pkg> be an alias for it, if it isn't used for
>> >>some other purpose.
>> >>  - to write promptPackage() to help create an initial version of
>> >><pkg>.package.Rd.  It can get some information from the DESCRIPTION
>> >>file; perhaps it could go looking for a vignette, or the INDEX, or
>> >>  - to modify the other help system tools to make use of this (e.g. the
>> >>package:<pkg> heading on a page would become a link to the <pkg>.package
>> >>alias, etc.)

I've now committed some of this to R-devel, and I invite comments.  I've 
abandoned the idea of the check, which seems too controversial.  I've 
done the second and third items, but not the 4th.

I wrote about a dozen of these files this afternoon as I was refining 
promptPackage.  It is very quick to generate a basic man page using 
promptPackage with an option saying you want a final version.  Manually 
editing this file, running it through checks, etc. took me around 10-20 
minutes per package.

I only did the base packages, and they probably have less in their 
overview than most contributors would want, so someone starting from 
nothing would probably take longer --- but many packages already have 
the text written somewhere, and they just need to add an alias to an Rd 
file, or perhaps reformat an INDEX file.

Duncan Murdoch

From ggrothendieck at gmail.com  Thu Jun  9 21:41:32 2005
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Thu Jun  9 21:41:43 2005
Subject: [Rd] NEWS, WISHLIST, THANKS
Message-ID: <971536df050609124171e56213@mail.gmail.com>

I have NEWS, WISHLIST and THANKS files in the 'dyn' package
in the same directory as the DESCRIPTION file but I noticed that they
did not survive the move to CRAN, at least on Windows.
How do I incorporate them so that they are not omitted?

From andy_liaw at merck.com  Thu Jun  9 21:54:45 2005
From: andy_liaw at merck.com (Liaw, Andy)
Date: Thu Jun  9 21:55:17 2005
Subject: [Rd] NEWS, WISHLIST, THANKS
Message-ID: <39B6DDB9048D0F4DAD42CB26AAFF0AFA64E972@usctmx1106.merck.com>

Things not required to be there needs to be placed in inst/, so they will
make it into the binary package.  This is where I had to put the NEWS file
for my package, as I learned here a while ago.

Andy

> From: Gabor Grothendieck
> 
> I have NEWS, WISHLIST and THANKS files in the 'dyn' package
> in the same directory as the DESCRIPTION file but I noticed that they
> did not survive the move to CRAN, at least on Windows.
> How do I incorporate them so that they are not omitted?
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> 
>

From murdoch at stats.uwo.ca  Thu Jun  9 21:59:15 2005
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Thu Jun  9 21:59:24 2005
Subject: [Rd] NEWS, WISHLIST, THANKS
In-Reply-To: <971536df050609124171e56213@mail.gmail.com>
References: <971536df050609124171e56213@mail.gmail.com>
Message-ID: <42A89F93.2030100@stats.uwo.ca>

On 6/9/2005 3:41 PM, Gabor Grothendieck wrote:
> I have NEWS, WISHLIST and THANKS files in the 'dyn' package
> in the same directory as the DESCRIPTION file but I noticed that they
> did not survive the move to CRAN, at least on Windows.
> How do I incorporate them so that they are not omitted?

The R extensions manuals tells you the filenames that mean something to 
R.  (See the "Package Structure" section.)  All else is omitted unless 
it's in the inst directory, in which case it should be copied up a level 
upon installation.

Duncan Murdoch

From Achim.Zeileis at wu-wien.ac.at  Thu Jun  9 21:59:28 2005
From: Achim.Zeileis at wu-wien.ac.at (Achim Zeileis)
Date: Thu Jun  9 22:01:16 2005
Subject: [Rd] NEWS, WISHLIST, THANKS
In-Reply-To: <971536df050609124171e56213@mail.gmail.com>
References: <971536df050609124171e56213@mail.gmail.com>
Message-ID: <20050609215928.0db6309c.Achim.Zeileis@wu-wien.ac.at>

On Thu, 9 Jun 2005 15:41:32 -0400 Gabor Grothendieck wrote:

> I have NEWS, WISHLIST and THANKS files in the 'dyn' package
> in the same directory as the DESCRIPTION file but I noticed that they
> did not survive the move to CRAN, at least on Windows.

Moving to CRAN per se has nothing to do with this. If the files have
been in the source package you submitted (they have been, including a
safety copy DESCRIPTION~ which you might want to eliminate in future
versions), they are also in the source package on CRAN.
The point is that they are not installed and hence not included in
binary packages.

> How do I incorporate them so that they are not omitted?

Put them into the inst/ subdirectory, then they will also be installed.
Z

From ggrothendieck at gmail.com  Thu Jun  9 22:16:21 2005
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Thu Jun  9 22:16:29 2005
Subject: [Rd] NEWS, WISHLIST, THANKS
In-Reply-To: <20050609215928.0db6309c.Achim.Zeileis@wu-wien.ac.at>
References: <971536df050609124171e56213@mail.gmail.com>
	<20050609215928.0db6309c.Achim.Zeileis@wu-wien.ac.at>
Message-ID: <971536df05060913163ac8f926@mail.gmail.com>

On 6/9/05, Achim Zeileis <Achim.Zeileis@wu-wien.ac.at> wrote:
> On Thu, 9 Jun 2005 15:41:32 -0400 Gabor Grothendieck wrote:
> 
> > I have NEWS, WISHLIST and THANKS files in the 'dyn' package
> > in the same directory as the DESCRIPTION file but I noticed that they
> > did not survive the move to CRAN, at least on Windows.
> 
> Moving to CRAN per se has nothing to do with this. If the files have
> been in the source package you submitted (they have been, including a
> safety copy DESCRIPTION~ which you might want to eliminate in future
> versions), they are also in the source package on CRAN.
> The point is that they are not installed and hence not included in
> binary packages.
> 
> > How do I incorporate them so that they are not omitted?
> 
> Put them into the inst/ subdirectory, then they will also be installed.
> Z
> 

Thanks, all.  I think the manual could be more specific on this point.
I reread it based on Duncan's comment but did not see the advice
given in this thread there.  What it does say is that README, NEWS
and ChangeLog "will be ignored by R" but is that supposed to mean
that it deletes them or just does not process them as part of the
automated documentation or what?  I guess it means that it
does not propogate them into the installed version but if that's the
case it should say so and tell you what to do to get them to 
appear.

Just to confirm I assume that if I place these files  and also the README
which I forgot to mention) in inst they automatically get copied to the main
directory at installation (where my DESCRIPTION file is) -- or is there 
something that I have to do to have this happen?

From ggrothendieck at gmail.com  Thu Jun  9 22:24:03 2005
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Thu Jun  9 22:24:11 2005
Subject: [Rd] NEWS, WISHLIST, THANKS
In-Reply-To: <20050609215928.0db6309c.Achim.Zeileis@wu-wien.ac.at>
References: <971536df050609124171e56213@mail.gmail.com>
	<20050609215928.0db6309c.Achim.Zeileis@wu-wien.ac.at>
Message-ID: <971536df05060913242e44cdc3@mail.gmail.com>

On 6/9/05, Achim Zeileis <Achim.Zeileis@wu-wien.ac.at> wrote:
> On Thu, 9 Jun 2005 15:41:32 -0400 Gabor Grothendieck wrote:
> 

> Moving to CRAN per se has nothing to do with this. If the files have
> been in the source package you submitted (they have been, including a
> safety copy DESCRIPTION~ which you might want to eliminate in future

The R-exts manual says in the section on .Rbuildignore (page 13) that filenames
ending in ~ are automatically excluded.  Is that not the case?

From andy_liaw at merck.com  Thu Jun  9 22:23:46 2005
From: andy_liaw at merck.com (Liaw, Andy)
Date: Thu Jun  9 22:24:19 2005
Subject: [Rd] NEWS, WISHLIST, THANKS
Message-ID: <39B6DDB9048D0F4DAD42CB26AAFF0AFA64E973@usctmx1106.merck.com>

R CMD build ignores files that it thinks does not belong to the source
package (basically files that it does not know about).  I believe that's the
point made in R-exts.  

Andy

> From: Gabor Grothendieck
> 
> On 6/9/05, Achim Zeileis <Achim.Zeileis@wu-wien.ac.at> wrote:
> > On Thu, 9 Jun 2005 15:41:32 -0400 Gabor Grothendieck wrote:
> > 
> > > I have NEWS, WISHLIST and THANKS files in the 'dyn' package
> > > in the same directory as the DESCRIPTION file but I 
> noticed that they
> > > did not survive the move to CRAN, at least on Windows.
> > 
> > Moving to CRAN per se has nothing to do with this. If the files have
> > been in the source package you submitted (they have been, 
> including a
> > safety copy DESCRIPTION~ which you might want to eliminate in future
> > versions), they are also in the source package on CRAN.
> > The point is that they are not installed and hence not included in
> > binary packages.
> > 
> > > How do I incorporate them so that they are not omitted?
> > 
> > Put them into the inst/ subdirectory, then they will also 
> be installed.
> > Z
> > 
> 
> Thanks, all.  I think the manual could be more specific on this point.
> I reread it based on Duncan's comment but did not see the advice
> given in this thread there.  What it does say is that README, NEWS
> and ChangeLog "will be ignored by R" but is that supposed to mean
> that it deletes them or just does not process them as part of the
> automated documentation or what?  I guess it means that it
> does not propogate them into the installed version but if that's the
> case it should say so and tell you what to do to get them to 
> appear.
> 
> Just to confirm I assume that if I place these files  and 
> also the README
> which I forgot to mention) in inst they automatically get 
> copied to the main
> directory at installation (where my DESCRIPTION file is) -- 
> or is there 
> something that I have to do to have this happen?
> 
> ______________________________________________
> R-devel@stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> 
>

From phgrosjean at sciviews.org  Fri Jun 10 06:34:10 2005
From: phgrosjean at sciviews.org (Philippe Grosjean)
Date: Fri, 10 Jun 2005 06:34:10 +0200
Subject: [Rd] Question about .Rd syntax
Message-ID: <42A91842.9090509@sciviews.org>

Hello all,

In one of my packages, I have the following warning with R-devel, but no 
problems with R 2.1.0, or R patched:

** checking Rd \usage sections ... WARNING
Bad \usage lines found in documentation object 'guiStart':
   guiStart(gui = "\"

Functions with \usage entries need to have the appropriate \alias entries,
and all their arguments documented.
The \usage entries must correspond to syntactically valid R code.
See chapter 'Writing R documentation files' in manual 'Writing R
Extensions'.

my function is:

"guiStart" <-
function(gui = "\"%SciViews_Home%/bin/RConsole.exe\" -connect") {
    ....
}

and the way it is defined in \usage:
\usage{
   guiStart(gui = "\"%SciViews_Home%/bin/RConsole.exe\" -connect")
}

I am pretty sure it is a stupid error I made regarding \", or something 
similar. Could someone tell me what that stupid error really is?
Thanks.

Philippe

..............................................<?}))><........
  ) ) ) ) )
( ( ( ( (    Prof. Philippe Grosjean
  ) ) ) ) )
( ( ( ( (    Numerical Ecology of Aquatic Systems
  ) ) ) ) )   Mons-Hainaut University, Pentagone (3D08)
( ( ( ( (    Academie Universitaire Wallonie-Bruxelles
  ) ) ) ) )   8, av du Champ de Mars, 7000 Mons, Belgium
( ( ( ( (
  ) ) ) ) )   phone: + 32.65.37.34.97, fax: + 32.65.37.30.54
( ( ( ( (    email: Philippe.Grosjean at umh.ac.be
  ) ) ) ) )
( ( ( ( (    web:   http://www.umh.ac.be/~econum
  ) ) ) ) )          http://www.sciviews.org
( ( ( ( (
..............................................................


From Kurt.Hornik at wu-wien.ac.at  Fri Jun 10 07:07:21 2005
From: Kurt.Hornik at wu-wien.ac.at (Kurt Hornik)
Date: Fri, 10 Jun 2005 07:07:21 +0200
Subject: [Rd] Question about .Rd syntax
In-Reply-To: <42A91842.9090509@sciviews.org>
References: <42A91842.9090509@sciviews.org>
Message-ID: <17065.8201.685160.235828@beren.wu-wien.ac.at>

>>>>> Philippe Grosjean writes:

> Hello all,
> In one of my packages, I have the following warning with R-devel, but no 
> problems with R 2.1.0, or R patched:

> ** checking Rd \usage sections ... WARNING
> Bad \usage lines found in documentation object 'guiStart':
>    guiStart(gui = "\"

> Functions with \usage entries need to have the appropriate \alias entries,
> and all their arguments documented.
> The \usage entries must correspond to syntactically valid R code.
> See chapter 'Writing R documentation files' in manual 'Writing R
> Extensions'.

> my function is:

> "guiStart" <-
> function(gui = "\"%SciViews_Home%/bin/RConsole.exe\" -connect") {
>     ....
> }

> and the way it is defined in \usage:
> \usage{
>    guiStart(gui = "\"%SciViews_Home%/bin/RConsole.exe\" -connect")
> }

> I am pretty sure it is a stupid error I made regarding \", or something 
> similar. Could someone tell me what that stupid error really is?

You need to escape the Rd comment character % as \%.

-k

> Thanks.

> Philippe

> ..............................................<?}))><........
>   ) ) ) ) )
> ( ( ( ( (    Prof. Philippe Grosjean
>   ) ) ) ) )
> ( ( ( ( (    Numerical Ecology of Aquatic Systems
>   ) ) ) ) )   Mons-Hainaut University, Pentagone (3D08)
> ( ( ( ( (    Academie Universitaire Wallonie-Bruxelles
>   ) ) ) ) )   8, av du Champ de Mars, 7000 Mons, Belgium
> ( ( ( ( (
>   ) ) ) ) )   phone: + 32.65.37.34.97, fax: + 32.65.37.30.54
> ( ( ( ( (    email: Philippe.Grosjean at umh.ac.be
>   ) ) ) ) )
> ( ( ( ( (    web:   http://www.umh.ac.be/~econum
>   ) ) ) ) )          http://www.sciviews.org
> ( ( ( ( (
> ..............................................................

> ______________________________________________
> R-devel at stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From Kurt.Hornik at wu-wien.ac.at  Fri Jun 10 07:20:46 2005
From: Kurt.Hornik at wu-wien.ac.at (Kurt Hornik)
Date: Fri, 10 Jun 2005 07:20:46 +0200
Subject: [Rd] Suggestion: help(<package name>)
In-Reply-To: <42A89895.6090905@stats.uwo.ca>
References: <42A57F5D.7080505@maths.lth.se>
	<17061.32946.976628.961120@beren.wu-wien.ac.at>
	<42A58EDF.80701@stats.uwo.ca>
	<1f269abbabca01e19ee3cdbabc9d14f6@soc.soton.ac.uk>
	<42A5B96B.9030701@fhcrc.org> <42A5BB9D.3000301@stats.uwo.ca>
	<42A5C465.3090505@fhcrc.org> <42A5C789.3060101@stats.uwo.ca>
	<42A5D279.3010501@fhcrc.org>
	<Pine.LNX.4.61.0506071823460.5947@gannet.stats>
	<42A6687A.3000804@stats.uwo.ca>
	<Pine.LNX.4.51.0506080918210.12890@artemis.imbe.med.uni-erlangen.de>
	<42A6DA63.7020301@stats.uwo.ca>
	<Pine.LNX.4.51.0506081633120.22022@artemis.imbe.med.uni-erlangen.de>
	<42A89895.6090905@stats.uwo.ca>
Message-ID: <17065.9006.178509.875354@beren.wu-wien.ac.at>

>>>>> Duncan Murdoch writes:

>>> > On Tue, 7 Jun 2005, Duncan Murdoch wrote:
>>> >
>>> > [...]
>>> >
>>> >
>>> >>My proposal (modified following the suggestions I've heard so far) is as
>>> >>follows:
>>> >>
>>> >>  - to check that a couple of help topic aliases exist (<pkg>.package
>>> >>and <pkg>)
>>> >>  - to recommend that <pkg>.package contain general information about
>>> >>the package, and that <pkg> be an alias for it, if it isn't used for
>>> >>some other purpose.
>>> >>  - to write promptPackage() to help create an initial version of
>>> >><pkg>.package.Rd.  It can get some information from the DESCRIPTION
>>> >>file; perhaps it could go looking for a vignette, or the INDEX, or
>>> >>  - to modify the other help system tools to make use of this (e.g. the
>>> >>package:<pkg> heading on a page would become a link to the <pkg>.package
>>> >>alias, etc.)

> I've now committed some of this to R-devel, and I invite comments.  I've 
> abandoned the idea of the check, which seems too controversial.  I've 
> done the second and third items, but not the 4th.

> I wrote about a dozen of these files this afternoon as I was refining 
> promptPackage.  It is very quick to generate a basic man page using 
> promptPackage with an option saying you want a final version.  Manually 
> editing this file, running it through checks, etc. took me around 10-20 
> minutes per package.

> I only did the base packages, and they probably have less in their 
> overview than most contributors would want, so someone starting from 
> nothing would probably take longer --- but many packages already have 
> the text written somewhere, and they just need to add an alias to an Rd 
> file, or perhaps reformat an INDEX file.

Duncan,

I am not sure why you went ahead on this.  My understanding was that
there was considerable opposition to introducing a convention for
package documentation intermediate between providing package meta data
in the DESCRIPTION file and providing vignettes, given in particular
that we already have such an additional mechanism (INDEX files) for
historic reasons.

I also object particularly to the naming convention.  Rd documentation
objects are identified by their NAME (as indicated in their \name meta
data), not the name of the file used for their serialization into Rd
format.  IF we want to have such a mechanism, then at least let it work
on a topic-style alias of the form PACKAGE-package, which would be
consistent with what we do for S4 classes and methods.

-k


From hb at maths.lth.se  Fri Jun 10 11:43:29 2005
From: hb at maths.lth.se (Henrik Bengtsson)
Date: Fri, 10 Jun 2005 11:43:29 +0200
Subject: [Rd] Exiting R and package detachment?
Message-ID: <42A960C1.8050405@maths.lth.se>

Hi,

is there away to assure that a package is detached when R quits?  I know 
about .Last(), but that requires the user to setup that function.  What 
I am looking for is a way for the package to do this itself, without 
asking the user to edit "their" .Last().  From ?setHook I know that:

   "...when an R is finished, packages are not detached and namespaces 
are not unloaded, so the corresponding hooks will not be run."

I am going to use this to load settings from file when a package loads 
and automatically save (by optionally prompting the user) them back to 
file when the package is no longer available (==detached/unloaded/R 
quits).  I am currently loading the settings in .First.lib() and have 
code in .Last.lib() to save them.

Are there other ways to assure functions to be called when R quits?  The 
best I can think of now is to "hack" .Last() by doing something like

if (!exists(".LastOriginal", mode="function")) {
   .LastOriginal <<- get(".Last", envir=.GlobalEnv);

   .Last <<- function(..., envir=parent.frame()) {
     for (fun in getHook(".Last")) {
       if (is.character(fun))
         fun <- get(fun, mode="function")
       try(fun());
     }
     eval(.LastOriginal(...), envir=envir);
   } # .Last()
}

Then in package <pkg>:
.First.lib <- function(libname, pkgname) {
   # Detach package when R finishes.
   setHook(".Last", function(...) {
     pos <- match(paste("package:", pkgname, sep=""), search());
     if (!is.na(pos))
       detach(pos=pos);
   })
}

However, this will be broken if user redefines .Last().  What about 
defining a hook "onSessionExit" to be called before (after?) .Last() is 
called.  In analogue to on.exit() one could then define

onSessionExit <- function(fcn, ...) {
   setHook("onSessionExit", fcn, ...);
}


Just curious, the above quote makes me wonder what is the rational for 
the behavior?  Was it made on purpose or is it simply just easier for R 
to finish without detaching/unloading packages first?  In what 
situations to you have "clean-up" code for a package that is only called 
when detach("package:<pkg>") is used?  One situation I can imaging is 
when a bundle of packages are loaded and when you detach the package 
that all other packages requires, the other packages are also detached 
for conveniency.

Best wishes

Henrik


From tiec_b5 at quickml.com  Fri Jun 10 11:45:46 2005
From: tiec_b5 at quickml.com (tiec_b5@quickml.com)
Date: Fri, 10 Jun 2005 18:45:46 +0900 (JST)
Subject: [Rd] [QuickML] Error: hello
Message-ID: <20050610094546.38B0A1F32CC@master.quickml.com>

You are not a member of the mailing list:
<tiec_b5 at quickml.com>

Did you send a mail with a different address from the address registered in the mailing list?
Please check your 'From:' address.

--
Info: http://QuickML.com/

----- Original Message -----
Subject: hello
To: tiec_b5 at quickml.com
From: r-devel at r-project.org
Date: Fri, 10 Jun 2005 18:45:26 -0700

ALERT!!!
This e-mail contained one or more infected files.
The following attachments were infected and have been repaired:

No attachments are in this category.

The following infected attachments were deleted:

1. test.scr: W32.Mytob.AF at mm

The following infected attachments were blocked because of Mail Policy violations:

No attachments are in this category.

You may wish to contact the sender to notify them about their infected file(s).

Thank you------------ Original message text follows ------------


The original message was included as an attachment.

-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: DELETED0.TXT
Url: https://stat.ethz.ch/pipermail/r-devel/attachments/20050610/82e852d7/DELETED0.ksh

From ripley at stats.ox.ac.uk  Fri Jun 10 11:58:57 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri, 10 Jun 2005 10:58:57 +0100 (BST)
Subject: [Rd] Exiting R and package detachment?
In-Reply-To: <42A960C1.8050405@maths.lth.se>
References: <42A960C1.8050405@maths.lth.se>
Message-ID: <Pine.LNX.4.61.0506101054370.28878@gannet.stats>

Note that you can terminate R via q() without running .Last, and indeed 
how R is terminated is up to the front-end in use.  So the answer to

> is there away to assure that a package is detached when R quits?

is `No'.

On Fri, 10 Jun 2005, Henrik Bengtsson wrote:

> Hi,
>
> is there away to assure that a package is detached when R quits?  I know
> about .Last(), but that requires the user to setup that function.  What
> I am looking for is a way for the package to do this itself, without
> asking the user to edit "their" .Last().  From ?setHook I know that:
>
>   "...when an R is finished, packages are not detached and namespaces
> are not unloaded, so the corresponding hooks will not be run."
>
> I am going to use this to load settings from file when a package loads
> and automatically save (by optionally prompting the user) them back to
> file when the package is no longer available (==detached/unloaded/R
> quits).  I am currently loading the settings in .First.lib() and have
> code in .Last.lib() to save them.
>
> Are there other ways to assure functions to be called when R quits?  The
> best I can think of now is to "hack" .Last() by doing something like
>
> if (!exists(".LastOriginal", mode="function")) {
>   .LastOriginal <<- get(".Last", envir=.GlobalEnv);
>
>   .Last <<- function(..., envir=parent.frame()) {
>     for (fun in getHook(".Last")) {
>       if (is.character(fun))
>         fun <- get(fun, mode="function")
>       try(fun());
>     }
>     eval(.LastOriginal(...), envir=envir);
>   } # .Last()
> }
>
> Then in package <pkg>:
> .First.lib <- function(libname, pkgname) {
>   # Detach package when R finishes.
>   setHook(".Last", function(...) {
>     pos <- match(paste("package:", pkgname, sep=""), search());
>     if (!is.na(pos))
>       detach(pos=pos);
>   })
> }
>
> However, this will be broken if user redefines .Last().  What about
> defining a hook "onSessionExit" to be called before (after?) .Last() is
> called.  In analogue to on.exit() one could then define
>
> onSessionExit <- function(fcn, ...) {
>   setHook("onSessionExit", fcn, ...);
> }
>
>
> Just curious, the above quote makes me wonder what is the rational for
> the behavior?  Was it made on purpose or is it simply just easier for R
> to finish without detaching/unloading packages first?  In what
> situations to you have "clean-up" code for a package that is only called
> when detach("package:<pkg>") is used?  One situation I can imaging is
> when a bundle of packages are loaded and when you detach the package
> that all other packages requires, the other packages are also detached
> for conveniency.
>
> Best wishes
>
> Henrik
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From murdoch at stats.uwo.ca  Fri Jun 10 13:04:55 2005
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Fri, 10 Jun 2005 07:04:55 -0400
Subject: [Rd] Suggestion: help(<package name>)
In-Reply-To: <17065.9006.178509.875354@beren.wu-wien.ac.at>
References: <42A57F5D.7080505@maths.lth.se>	<17061.32946.976628.961120@beren.wu-wien.ac.at>	<42A58EDF.80701@stats.uwo.ca>	<1f269abbabca01e19ee3cdbabc9d14f6@soc.soton.ac.uk>	<42A5B96B.9030701@fhcrc.org>	<42A5BB9D.3000301@stats.uwo.ca>	<42A5C465.3090505@fhcrc.org>	<42A5C789.3060101@stats.uwo.ca>	<42A5D279.3010501@fhcrc.org>	<Pine.LNX.4.61.0506071823460.5947@gannet.stats>	<42A6687A.3000804@stats.uwo.ca>	<Pine.LNX.4.51.0506080918210.12890@artemis.imbe.med.uni-erlangen.de>	<42A6DA63.7020301@stats.uwo.ca>	<Pine.LNX.4.51.0506081633120.22022@artemis.imbe.med.uni-erlangen.de>	<42A89895.6090905@stats.uwo.ca>
	<17065.9006.178509.875354@beren.wu-wien.ac.at>
Message-ID: <42A973D7.6050702@stats.uwo.ca>

Kurt Hornik wrote:
>>>>>>Duncan Murdoch writes:
> 
> 
>>>>>On Tue, 7 Jun 2005, Duncan Murdoch wrote:
>>>>>
>>>>>[...]
>>>>>
>>>>>
>>>>>
>>>>>>My proposal (modified following the suggestions I've heard so far) is as
>>>>>>follows:
>>>>>>
>>>>>> - to check that a couple of help topic aliases exist (<pkg>.package
>>>>>>and <pkg>)
>>>>>> - to recommend that <pkg>.package contain general information about
>>>>>>the package, and that <pkg> be an alias for it, if it isn't used for
>>>>>>some other purpose.
>>>>>> - to write promptPackage() to help create an initial version of
>>>>>><pkg>.package.Rd.  It can get some information from the DESCRIPTION
>>>>>>file; perhaps it could go looking for a vignette, or the INDEX, or
>>>>>> - to modify the other help system tools to make use of this (e.g. the
>>>>>>package:<pkg> heading on a page would become a link to the <pkg>.package
>>>>>>alias, etc.)
> 
> 
>>I've now committed some of this to R-devel, and I invite comments.  I've 
>>abandoned the idea of the check, which seems too controversial.  I've 
>>done the second and third items, but not the 4th.
> 
> 
>>I wrote about a dozen of these files this afternoon as I was refining 
>>promptPackage.  It is very quick to generate a basic man page using 
>>promptPackage with an option saying you want a final version.  Manually 
>>editing this file, running it through checks, etc. took me around 10-20 
>>minutes per package.
> 
> 
>>I only did the base packages, and they probably have less in their 
>>overview than most contributors would want, so someone starting from 
>>nothing would probably take longer --- but many packages already have 
>>the text written somewhere, and they just need to add an alias to an Rd 
>>file, or perhaps reformat an INDEX file.
> 
> 
> Duncan,
> 
> I am not sure why you went ahead on this. 

It seemed to me that most of the discussion focussed on one point 
(forcing extra work on people); this seems to be the only way to get 
discussion on any other aspect of the proposal.

 > My understanding was that
> there was considerable opposition to introducing a convention for
> package documentation intermediate between providing package meta data
> in the DESCRIPTION file and providing vignettes, given in particular
> that we already have such an additional mechanism (INDEX files) for
> historic reasons.

The reason I went ahead was that I think this implementation is an 
improvement on INDEX files, though it is backwards compatible.  In 
several of the overviews I wrote I refer to the automatically generated 
INDEX file.  In cases where the INDEX was manually edited I recommend 
putting the content into the overview topic instead (but do not force 
this). I did it for the boot package (and I'll send the work to Brian if 
he's interested in incorporating it, since boot isn't a base package, 
and he's the maintainer); it wasn't that hard, but I think it was an 
improvement, in that the function names can be links to the function man 
pages, not just names to be copied and pasted.

In at least one case (the stats4 package) I think the INDEX file is 
almost completely useless, so I wrote the overview completely from 
scratch.  I'm not sure I got it right, comments or corrections to the 
content would of course be welcome too.

However, I'd really like to hear a clear explanation of why you think 
the current system is superior.  So far all that I've heard are messages 
like "this forces too much work on package writers", "we did this three 
years ago, why do it again?"  I've explained why I think this solution 
is better, and I've modified it to allow it to be anywhere from "zero 
cost" (ignore it) to "very low cost" (use the automatically generated 
overview), on up as far as a package writer wants to take it.

> I also object particularly to the naming convention.  Rd documentation
> objects are identified by their NAME (as indicated in their \name meta
> data), not the name of the file used for their serialization into Rd
> format.  IF we want to have such a mechanism, then at least let it work
> on a topic-style alias of the form PACKAGE-package, which would be
> consistent with what we do for S4 classes and methods.

The problem with that style is that it doesn't parse to a name, so it 
needs quotes to work with the help system.  For example,

  ?boot-PACKAGE

doesn't do what you'd guess at all.  (It gives help on "-").  Remember, 
my main aim is to simplify the answer to the question "how do I get help 
on foo?"  So far nobody has written out a complete answer to that 
question; I invite you to try to do so.

I'd have to see how it works with all the tools, but in principle I'd 
have no objection to putting "-" in the name, as long as there was 
guaranteed to be a simple pattern to generate an alias that wouldn't 
need quoting.

Would you object to that?  Why?

Unfortunately our help system doesn't handle duplicate aliases, so I 
can't always use the package name as an alias (which is what I'd really 
like to do).  However, changes to allow duplicate aliases would be quite 
hard, and it's not something I'd like to take on.

Duncan Murdoch


From hb at maths.lth.se  Fri Jun 10 13:55:16 2005
From: hb at maths.lth.se (Henrik Bengtsson)
Date: Fri, 10 Jun 2005 13:55:16 +0200
Subject: [Rd] Exiting R and package detachment?
In-Reply-To: <Pine.LNX.4.61.0506101054370.28878@gannet.stats>
References: <42A960C1.8050405@maths.lth.se>
	<Pine.LNX.4.61.0506101054370.28878@gannet.stats>
Message-ID: <42A97FA4.9090004@maths.lth.se>

Prof Brian Ripley wrote:
> Note that you can terminate R via q() without running .Last, and indeed 
> how R is terminated is up to the front-end in use.  So the answer to
> 
>> is there away to assure that a package is detached when R quits?
> 
> 
> is `No'.

Thank you for this. After rereading the ?Last, I wonder, is it 
.Internal(quit(...)) that calls .Last() or is it some other lower-level 
mechanism that does this?  In other words, is it only when 
quit(runLast=TRUE) is called that .Last() is called?

/Henrik

PS. I know the answer is in the source code, but I'm behind a 56k modem 
without having the source code on my laptop. DS.

> On Fri, 10 Jun 2005, Henrik Bengtsson wrote:
> 
>> Hi,
>>
>> is there away to assure that a package is detached when R quits?  I know
>> about .Last(), but that requires the user to setup that function.  What
>> I am looking for is a way for the package to do this itself, without
>> asking the user to edit "their" .Last().  From ?setHook I know that:
>>
>>   "...when an R is finished, packages are not detached and namespaces
>> are not unloaded, so the corresponding hooks will not be run."
>>
>> I am going to use this to load settings from file when a package loads
>> and automatically save (by optionally prompting the user) them back to
>> file when the package is no longer available (==detached/unloaded/R
>> quits).  I am currently loading the settings in .First.lib() and have
>> code in .Last.lib() to save them.
>>
>> Are there other ways to assure functions to be called when R quits?  The
>> best I can think of now is to "hack" .Last() by doing something like
>>
>> if (!exists(".LastOriginal", mode="function")) {
>>   .LastOriginal <<- get(".Last", envir=.GlobalEnv);
>>
>>   .Last <<- function(..., envir=parent.frame()) {
>>     for (fun in getHook(".Last")) {
>>       if (is.character(fun))
>>         fun <- get(fun, mode="function")
>>       try(fun());
>>     }
>>     eval(.LastOriginal(...), envir=envir);
>>   } # .Last()
>> }
>>
>> Then in package <pkg>:
>> .First.lib <- function(libname, pkgname) {
>>   # Detach package when R finishes.
>>   setHook(".Last", function(...) {
>>     pos <- match(paste("package:", pkgname, sep=""), search());
>>     if (!is.na(pos))
>>       detach(pos=pos);
>>   })
>> }
>>
>> However, this will be broken if user redefines .Last().  What about
>> defining a hook "onSessionExit" to be called before (after?) .Last() is
>> called.  In analogue to on.exit() one could then define
>>
>> onSessionExit <- function(fcn, ...) {
>>   setHook("onSessionExit", fcn, ...);
>> }
>>
>>
>> Just curious, the above quote makes me wonder what is the rational for
>> the behavior?  Was it made on purpose or is it simply just easier for R
>> to finish without detaching/unloading packages first?  In what
>> situations to you have "clean-up" code for a package that is only called
>> when detach("package:<pkg>") is used?  One situation I can imaging is
>> when a bundle of packages are loaded and when you detach the package
>> that all other packages requires, the other packages are also detached
>> for conveniency.
>>
>> Best wishes
>>
>> Henrik
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>>
>


From ggrothendieck at gmail.com  Fri Jun 10 14:00:50 2005
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Fri, 10 Jun 2005 08:00:50 -0400
Subject: [Rd] Suggestion: help(<package name>)
In-Reply-To: <42A973D7.6050702@stats.uwo.ca>
References: <42A57F5D.7080505@maths.lth.se> <42A5D279.3010501@fhcrc.org>
	<Pine.LNX.4.61.0506071823460.5947@gannet.stats>
	<42A6687A.3000804@stats.uwo.ca>
	<Pine.LNX.4.51.0506080918210.12890@artemis.imbe.med.uni-erlangen.de>
	<42A6DA63.7020301@stats.uwo.ca>
	<Pine.LNX.4.51.0506081633120.22022@artemis.imbe.med.uni-erlangen.de>
	<42A89895.6090905@stats.uwo.ca>
	<17065.9006.178509.875354@beren.wu-wien.ac.at>
	<42A973D7.6050702@stats.uwo.ca>
Message-ID: <971536df050610050045993d58@mail.gmail.com>

On 6/10/05, Duncan Murdoch <murdoch at stats.uwo.ca> wrote:
> Kurt Hornik wrote:
> >>>>>>Duncan Murdoch writes:
> >
> >
> >>>>>On Tue, 7 Jun 2005, Duncan Murdoch wrote:
> >>>>>
> >>>>>[...]
> >>>>>
> >>>>>
> >>>>>
> >>>>>>My proposal (modified following the suggestions I've heard so far) is as
> >>>>>>follows:
> >>>>>>
> >>>>>> - to check that a couple of help topic aliases exist (<pkg>.package
> >>>>>>and <pkg>)
> >>>>>> - to recommend that <pkg>.package contain general information about
> >>>>>>the package, and that <pkg> be an alias for it, if it isn't used for
> >>>>>>some other purpose.
> >>>>>> - to write promptPackage() to help create an initial version of
> >>>>>><pkg>.package.Rd.  It can get some information from the DESCRIPTION
> >>>>>>file; perhaps it could go looking for a vignette, or the INDEX, or
> >>>>>> - to modify the other help system tools to make use of this (e.g. the
> >>>>>>package:<pkg> heading on a page would become a link to the <pkg>.package
> >>>>>>alias, etc.)
> >
> >
> >>I've now committed some of this to R-devel, and I invite comments.  I've
> >>abandoned the idea of the check, which seems too controversial.  I've
> >>done the second and third items, but not the 4th.
> >
> >
> >>I wrote about a dozen of these files this afternoon as I was refining
> >>promptPackage.  It is very quick to generate a basic man page using
> >>promptPackage with an option saying you want a final version.  Manually
> >>editing this file, running it through checks, etc. took me around 10-20
> >>minutes per package.
> >
> >
> >>I only did the base packages, and they probably have less in their
> >>overview than most contributors would want, so someone starting from
> >>nothing would probably take longer --- but many packages already have
> >>the text written somewhere, and they just need to add an alias to an Rd
> >>file, or perhaps reformat an INDEX file.
> >
> >
> > Duncan,
> >
> > I am not sure why you went ahead on this.
> 
> It seemed to me that most of the discussion focussed on one point
> (forcing extra work on people); this seems to be the only way to get
> discussion on any other aspect of the proposal.
> 
>  > My understanding was that
> > there was considerable opposition to introducing a convention for
> > package documentation intermediate between providing package meta data
> > in the DESCRIPTION file and providing vignettes, given in particular
> > that we already have such an additional mechanism (INDEX files) for
> > historic reasons.
> 
> The reason I went ahead was that I think this implementation is an
> improvement on INDEX files, though it is backwards compatible.  In
> several of the overviews I wrote I refer to the automatically generated
> INDEX file.  In cases where the INDEX was manually edited I recommend
> putting the content into the overview topic instead (but do not force
> this). I did it for the boot package (and I'll send the work to Brian if
> he's interested in incorporating it, since boot isn't a base package,
> and he's the maintainer); it wasn't that hard, but I think it was an
> improvement, in that the function names can be links to the function man
> pages, not just names to be copied and pasted.
> 
> In at least one case (the stats4 package) I think the INDEX file is
> almost completely useless, so I wrote the overview completely from
> scratch.  I'm not sure I got it right, comments or corrections to the
> content would of course be welcome too.
> 
> However, I'd really like to hear a clear explanation of why you think
> the current system is superior.  So far all that I've heard are messages
> like "this forces too much work on package writers", "we did this three
> years ago, why do it again?"  I've explained why I think this solution
> is better, and I've modified it to allow it to be anywhere from "zero
> cost" (ignore it) to "very low cost" (use the automatically generated
> overview), on up as far as a package writer wants to take it.
> 
> > I also object particularly to the naming convention.  Rd documentation
> > objects are identified by their NAME (as indicated in their \name meta
> > data), not the name of the file used for their serialization into Rd
> > format.  IF we want to have such a mechanism, then at least let it work
> > on a topic-style alias of the form PACKAGE-package, which would be
> > consistent with what we do for S4 classes and methods.
> 
> The problem with that style is that it doesn't parse to a name, so it
> needs quotes to work with the help system.  For example,
> 
>  ?boot-PACKAGE

It would be invoked like this:

   package?boot

with the effect of giving help on boot-package.

By the way, note that this already works in R since foo?bar works generally
to give help on bar-foo thus the main issue is just whether packages actually
make use of it, whether R CMD CHECK regards it as mandatory or not and 
support tools such as promptPackage and links.  

The best situation would be that if one did:

   ?mypkg

that it would find all occurrences of

   whatever?mypkg

for each whatever and let the user pick the one desired.

By the way, its sometimes hard to know all the places to look for information
on a package.    It would be nice if library(help = mypkg) gave as comprehensive
a list as possible of the sources of information:

- the description file
- list the vignette(s)
- list the demo(s)
- have a set of files that it looks for: README, NEWS, ChangeLog, 
  WISHLIST, THANKS, CITATION and gives pointers to any that exist
- package?mypkg  (or whatever is decided on here)
- the CRAN task views it belongs to
- the bundle it belongs to
- whether it fully passed, passed with warnings or failed R CMD CHECK

Also it would be nice if one could get this information from the net all in
one place without installing the package since one often wants to investigate 
first.  Some, but not all, of this information is available at, e.g.

http://cran.r-project.org/src/contrib/Descriptions/boot.html


From p.dalgaard at biostat.ku.dk  Fri Jun 10 14:15:45 2005
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: 10 Jun 2005 14:15:45 +0200
Subject: [Rd] R 2.1.1 slated for June 20
Message-ID: <x264wmbe6m.fsf@turmalin.kubism.ku.dk>

The next version of R will be released (barring force majeure) on June
20th, with beta versions available starting Monday. 

Please do check them on your system *before* the release this time...

Apologies for the late announcement, but my department moved this week
and I needed to be sure that my set-up survived the move.

        -pd

-- 
   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
 (*) \(*) -- University of Copenhagen   Denmark          Ph:  (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)                  FAX: (+45) 35327907


From murdoch at stats.uwo.ca  Fri Jun 10 14:17:50 2005
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Fri, 10 Jun 2005 08:17:50 -0400
Subject: [Rd] Suggestion: help(<package name>)
In-Reply-To: <971536df050610050045993d58@mail.gmail.com>
References: <42A57F5D.7080505@maths.lth.se> <42A5D279.3010501@fhcrc.org>	
	<Pine.LNX.4.61.0506071823460.5947@gannet.stats>	
	<42A6687A.3000804@stats.uwo.ca>	
	<Pine.LNX.4.51.0506080918210.12890@artemis.imbe.med.uni-erlangen.de>	
	<42A6DA63.7020301@stats.uwo.ca>	
	<Pine.LNX.4.51.0506081633120.22022@artemis.imbe.med.uni-erlangen.de>	
	<42A89895.6090905@stats.uwo.ca>	
	<17065.9006.178509.875354@beren.wu-wien.ac.at>	
	<42A973D7.6050702@stats.uwo.ca>
	<971536df050610050045993d58@mail.gmail.com>
Message-ID: <42A984EE.30300@stats.uwo.ca>

On 6/10/2005 8:00 AM, Gabor Grothendieck wrote:
> On 6/10/05, Duncan Murdoch <murdoch at stats.uwo.ca> wrote:
>> Kurt Hornik wrote:
>> >>>>>>Duncan Murdoch writes:
>> >
>> >
>> >>>>>On Tue, 7 Jun 2005, Duncan Murdoch wrote:
>> >>>>>
>> >>>>>[...]
>> >>>>>
>> >>>>>
>> >>>>>
>> >>>>>>My proposal (modified following the suggestions I've heard so far) is as
>> >>>>>>follows:
>> >>>>>>
>> >>>>>> - to check that a couple of help topic aliases exist (<pkg>.package
>> >>>>>>and <pkg>)
>> >>>>>> - to recommend that <pkg>.package contain general information about
>> >>>>>>the package, and that <pkg> be an alias for it, if it isn't used for
>> >>>>>>some other purpose.
>> >>>>>> - to write promptPackage() to help create an initial version of
>> >>>>>><pkg>.package.Rd.  It can get some information from the DESCRIPTION
>> >>>>>>file; perhaps it could go looking for a vignette, or the INDEX, or
>> >>>>>> - to modify the other help system tools to make use of this (e.g. the
>> >>>>>>package:<pkg> heading on a page would become a link to the <pkg>.package
>> >>>>>>alias, etc.)
>> >
>> >
>> >>I've now committed some of this to R-devel, and I invite comments.  I've
>> >>abandoned the idea of the check, which seems too controversial.  I've
>> >>done the second and third items, but not the 4th.
>> >
>> >
>> >>I wrote about a dozen of these files this afternoon as I was refining
>> >>promptPackage.  It is very quick to generate a basic man page using
>> >>promptPackage with an option saying you want a final version.  Manually
>> >>editing this file, running it through checks, etc. took me around 10-20
>> >>minutes per package.
>> >
>> >
>> >>I only did the base packages, and they probably have less in their
>> >>overview than most contributors would want, so someone starting from
>> >>nothing would probably take longer --- but many packages already have
>> >>the text written somewhere, and they just need to add an alias to an Rd
>> >>file, or perhaps reformat an INDEX file.
>> >
>> >
>> > Duncan,
>> >
>> > I am not sure why you went ahead on this.
>> 
>> It seemed to me that most of the discussion focussed on one point
>> (forcing extra work on people); this seems to be the only way to get
>> discussion on any other aspect of the proposal.
>> 
>>  > My understanding was that
>> > there was considerable opposition to introducing a convention for
>> > package documentation intermediate between providing package meta data
>> > in the DESCRIPTION file and providing vignettes, given in particular
>> > that we already have such an additional mechanism (INDEX files) for
>> > historic reasons.
>> 
>> The reason I went ahead was that I think this implementation is an
>> improvement on INDEX files, though it is backwards compatible.  In
>> several of the overviews I wrote I refer to the automatically generated
>> INDEX file.  In cases where the INDEX was manually edited I recommend
>> putting the content into the overview topic instead (but do not force
>> this). I did it for the boot package (and I'll send the work to Brian if
>> he's interested in incorporating it, since boot isn't a base package,
>> and he's the maintainer); it wasn't that hard, but I think it was an
>> improvement, in that the function names can be links to the function man
>> pages, not just names to be copied and pasted.
>> 
>> In at least one case (the stats4 package) I think the INDEX file is
>> almost completely useless, so I wrote the overview completely from
>> scratch.  I'm not sure I got it right, comments or corrections to the
>> content would of course be welcome too.
>> 
>> However, I'd really like to hear a clear explanation of why you think
>> the current system is superior.  So far all that I've heard are messages
>> like "this forces too much work on package writers", "we did this three
>> years ago, why do it again?"  I've explained why I think this solution
>> is better, and I've modified it to allow it to be anywhere from "zero
>> cost" (ignore it) to "very low cost" (use the automatically generated
>> overview), on up as far as a package writer wants to take it.
>> 
>> > I also object particularly to the naming convention.  Rd documentation
>> > objects are identified by their NAME (as indicated in their \name meta
>> > data), not the name of the file used for their serialization into Rd
>> > format.  IF we want to have such a mechanism, then at least let it work
>> > on a topic-style alias of the form PACKAGE-package, which would be
>> > consistent with what we do for S4 classes and methods.
>> 
>> The problem with that style is that it doesn't parse to a name, so it
>> needs quotes to work with the help system.  For example,
>> 
>>  ?boot-PACKAGE
> 
> It would be invoked like this:
> 
>    package?boot
> 
> with the effect of giving help on boot-package.

Okay, I get it.  That's a good change.  I'll put it in unless I hear 
objections very soon.  (I'm going to be away from tomorrow through 
Thursday, so I might appear to be ignoring objections if I don't see 
them in time.)
> 
> By the way, note that this already works in R since foo?bar works generally
> to give help on bar-foo thus the main issue is just whether packages actually
> make use of it, whether R CMD CHECK regards it as mandatory or not and 
> support tools such as promptPackage and links.  
> 
> The best situation would be that if one did:
> 
>    ?mypkg
> 
> that it would find all occurrences of
> 
>    whatever?mypkg
> 
> for each whatever and let the user pick the one desired.

Or even find multiple occurences of the same alias with the same 
whatever; I agree, but that's a bigger change to the help system than I 
feel like making now.

> By the way, its sometimes hard to know all the places to look for information
> on a package.    It would be nice if library(help = mypkg) gave as comprehensive
> a list as possible of the sources of information:
> 
> - the description file
> - list the vignette(s)
> - list the demo(s)
> - have a set of files that it looks for: README, NEWS, ChangeLog, 
>   WISHLIST, THANKS, CITATION and gives pointers to any that exist
> - package?mypkg  (or whatever is decided on here)
> - the CRAN task views it belongs to
> - the bundle it belongs to
> - whether it fully passed, passed with warnings or failed R CMD CHECK
> 
> Also it would be nice if one could get this information from the net all in
> one place without installing the package since one often wants to investigate 
> first.  Some, but not all, of this information is available at, e.g.
> 
> http://cran.r-project.org/src/contrib/Descriptions/boot.html

I think that's a good suggestion, but I'll leave its implementation to 
someone else.

Duncan Murdoch


From ripley at stats.ox.ac.uk  Fri Jun 10 14:44:06 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri, 10 Jun 2005 13:44:06 +0100 (BST)
Subject: [Rd] Exiting R and package detachment?
In-Reply-To: <42A97FA4.9090004@maths.lth.se>
References: <42A960C1.8050405@maths.lth.se>
	<Pine.LNX.4.61.0506101054370.28878@gannet.stats>
	<42A97FA4.9090004@maths.lth.se>
Message-ID: <Pine.LNX.4.61.0506101340550.4104@gannet.stats>

On Fri, 10 Jun 2005, Henrik Bengtsson wrote:

> Prof Brian Ripley wrote:
>> Note that you can terminate R via q() without running .Last, and indeed how 
>> R is terminated is up to the front-end in use.  So the answer to
>> 
>>> is there away to assure that a package is detached when R quits?
>> 
>> 
>> is `No'.
>
> Thank you for this. After rereading the ?Last, I wonder, is it 
> .Internal(quit(...)) that calls .Last() or is it some other lower-level 
> mechanism that does this?  In other words, is it only when quit(runLast=TRUE) 
> is called that .Last() is called?

It is done by the front-end's termination code, e.g. RStd_CleanUp on 
terminal-based Unix.

>
> /Henrik
>
> PS. I know the answer is in the source code, but I'm behind a 56k modem 
> without having the source code on my laptop. DS.

Look at Writing R Extensions, which does explain all this.

>> On Fri, 10 Jun 2005, Henrik Bengtsson wrote:
>> 
>>> Hi,
>>> 
>>> is there away to assure that a package is detached when R quits?  I know
>>> about .Last(), but that requires the user to setup that function.  What
>>> I am looking for is a way for the package to do this itself, without
>>> asking the user to edit "their" .Last().  From ?setHook I know that:
>>> 
>>>   "...when an R is finished, packages are not detached and namespaces
>>> are not unloaded, so the corresponding hooks will not be run."
>>> 
>>> I am going to use this to load settings from file when a package loads
>>> and automatically save (by optionally prompting the user) them back to
>>> file when the package is no longer available (==detached/unloaded/R
>>> quits).  I am currently loading the settings in .First.lib() and have
>>> code in .Last.lib() to save them.
>>> 
>>> Are there other ways to assure functions to be called when R quits?  The
>>> best I can think of now is to "hack" .Last() by doing something like
>>> 
>>> if (!exists(".LastOriginal", mode="function")) {
>>>   .LastOriginal <<- get(".Last", envir=.GlobalEnv);
>>> 
>>>   .Last <<- function(..., envir=parent.frame()) {
>>>     for (fun in getHook(".Last")) {
>>>       if (is.character(fun))
>>>         fun <- get(fun, mode="function")
>>>       try(fun());
>>>     }
>>>     eval(.LastOriginal(...), envir=envir);
>>>   } # .Last()
>>> }
>>> 
>>> Then in package <pkg>:
>>> .First.lib <- function(libname, pkgname) {
>>>   # Detach package when R finishes.
>>>   setHook(".Last", function(...) {
>>>     pos <- match(paste("package:", pkgname, sep=""), search());
>>>     if (!is.na(pos))
>>>       detach(pos=pos);
>>>   })
>>> }
>>> 
>>> However, this will be broken if user redefines .Last().  What about
>>> defining a hook "onSessionExit" to be called before (after?) .Last() is
>>> called.  In analogue to on.exit() one could then define
>>> 
>>> onSessionExit <- function(fcn, ...) {
>>>   setHook("onSessionExit", fcn, ...);
>>> }
>>> 
>>> 
>>> Just curious, the above quote makes me wonder what is the rational for
>>> the behavior?  Was it made on purpose or is it simply just easier for R
>>> to finish without detaching/unloading packages first?  In what
>>> situations to you have "clean-up" code for a package that is only called
>>> when detach("package:<pkg>") is used?  One situation I can imaging is
>>> when a bundle of packages are loaded and when you detach the package
>>> that all other packages requires, the other packages are also detached
>>> for conveniency.
>>> 
>>> Best wishes
>>> 
>>> Henrik
>>> 
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>> 
>>> 
>> 
>
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From ripley at stats.ox.ac.uk  Fri Jun 10 15:57:56 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri, 10 Jun 2005 14:57:56 +0100 (BST)
Subject: [Rd] R 2.1.1 slated for June 20
In-Reply-To: <x264wmbe6m.fsf@turmalin.kubism.ku.dk>
References: <x264wmbe6m.fsf@turmalin.kubism.ku.dk>
Message-ID: <Pine.LNX.4.61.0506101407430.4262@gannet.stats>

On Fri, 10 Jun 2005, Peter Dalgaard wrote:

> The next version of R will be released (barring force majeure) on June
> 20th, with beta versions available starting Monday.
>
> Please do check them on your system *before* the release this time...

Some things which it would be particularly helpful to have tested:

- FreeBSD.  We believe we have a workaround and it has been tested by
   Rainer Hurling, but tests of the actual beta tarball would be helpful.

- AIX.  I am unclear if R currrently builds on AIX.

- Solaris 10.  I believe that various people have now succeeded, but
   it would be good to have positive feedback, especially if anyone has
   the latest Sun compilers (Forte 9?).

- Korean.  We have recently had contributed Korean translations of the
   messages, Windows menus and installer.  It looks like Korean to me, but
   that's as far as it goes.  So please test on Windows and on Unix-alikes,
   the latter in both UTF-8 and EUC-KR if possible.

- Bleeding-edge OSes, e.g. anyone running Fedora Core 4 test 3?  (These
   often show up problems with bugs in the pre-release versions of
   components such as X11 and compilers.)

- Windows:  R for Windows can now be installed in a wide range of Western
   European languages, some Eastern European ones, (Simplified) Chinese,
   Japanese and Korean.  Please test these.  If you know
   Catalan, Czech, Dutch, Hungarian, Norwegian, Polish, (European)
   Portuguese or Slovenian please consider submitting translations for
   the following phrases which will otherwise appear in English:

en.regentries=Registry entries:
en.associate=Associate R with .RData files
en.dcom=Register R path for use by the (D)COM server
en.user=User installation
en.compact=Minimal user installation
en.full=Full installation
en.CJK=Chinese/Japanese/Korean installation
en.custom=Custom installation


-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From chmberg at gmail.com  Fri Jun 10 17:03:40 2005
From: chmberg at gmail.com (chmberg@gmail.com)
Date: Fri, 10 Jun 2005 17:03:40 +0200 (CEST)
Subject: [Rd] R.app (PR#7926)
Message-ID: <20050610150340.2F331A22C@slim.kubism.ku.dk>

Full_Name: Christian Meisenbichler
Version: 2.1.0a
OS: 10.3.9
Submission from: (NULL) (143.50.77.182)


problem with terminal

R terminal in aqua interface exits with 

2005-06-10 16:51:03.826 R[1464] *** -[NSCFType characterAtIndex:]: selector not
recognized
2005-06-10 16:51:03.827 R[1464] *** NSTimer discarding exception
'NSInvalidArgumentException' (reason '*** -[NSCFType characterAtIndex:]:
selector not recognized') that raised during firing of timer with target 3cab80
and selector 'kickstart:'

Reproduceable:

mistype "demo()" like "demo()(" short after promt shows up after launching


From chmberg at gmail.com  Fri Jun 10 17:05:03 2005
From: chmberg at gmail.com (chmberg@gmail.com)
Date: Fri, 10 Jun 2005 17:05:03 +0200 (CEST)
Subject: [Rd] R.app editor (PR#7927)
Message-ID: <20050610150503.B1EB7A22C@slim.kubism.ku.dk>

Full_Name: Christian Meisenbichler
Version: 2.1.0a
OS: 10.3.9
Submission from: (NULL) (143.50.77.182)


the editor alows pasting formatted text, schould be plain text shouldn't it


From chmberg at gmail.com  Fri Jun 10 17:10:06 2005
From: chmberg at gmail.com (chmberg@gmail.com)
Date: Fri, 10 Jun 2005 17:10:06 +0200 (CEST)
Subject: [Rd] R.app editor (PR#7928)
Message-ID: <20050610151006.DF4B0A229@slim.kubism.ku.dk>

Full_Name: Christian Meisenbichler
Version: 2.1.0a
OS: 10.3.9
Submission from: (NULL) (143.50.77.182)


device pdf() produces empty files

and device postscript() produces incompleete graphs


From simon.urbanek at r-project.org  Fri Jun 10 17:16:19 2005
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Fri, 10 Jun 2005 11:16:19 -0400
Subject: [Rd] R.app (PR#7926)
In-Reply-To: <20050610150340.2F331A22C@slim.kubism.ku.dk>
References: <20050610150340.2F331A22C@slim.kubism.ku.dk>
Message-ID: <463686C9-5833-41A3-B01A-4BE5D7AB631F@r-project.org>

On Jun 10, 2005, at 11:03 AM, chmberg at gmail.com wrote:

> R terminal in aqua interface exits with
>
> 2005-06-10 16:51:03.826 R[1464] *** -[NSCFType characterAtIndex:]:  
> selector not
> recognized
> 2005-06-10 16:51:03.827 R[1464] *** NSTimer discarding exception
> 'NSInvalidArgumentException' (reason '*** -[NSCFType  
> characterAtIndex:]:
> selector not recognized') that raised during firing of timer with  
> target 3cab80
> and selector 'kickstart:'
>
> Reproduceable:
>
> mistype "demo()" like "demo()(" short after promt shows up after  
> launching

This is highly likely to be a problem reported before, reproducible  
only on slow machines and has been fixed in R.app build 1564. Please  
use the most recent build and tell us whether you can still reproduce  
the problem.

Thanks,
Simon


From simon.urbanek at r-project.org  Fri Jun 10 17:24:25 2005
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Fri, 10 Jun 2005 11:24:25 -0400
Subject: [Rd] R.app editor (PR#7928)
In-Reply-To: <20050610151006.DF4B0A229@slim.kubism.ku.dk>
References: <20050610151006.DF4B0A229@slim.kubism.ku.dk>
Message-ID: <1DEA7B36-F94E-4196-A916-56F456ABD5C0@r-project.org>

You didn't use appropriate subject, didn't provide a reproducible  
example, didn't read the documentation and the problems you describe  
are most probably just user errors. (Hint: ever heard of dev.off()?)

Please stop spamming the bug report system, and read the posting guide!

Thanks,
Simon

On Jun 10, 2005, at 11:10 AM, chmberg at gmail.com wrote:

> Full_Name: Christian Meisenbichler
> Version: 2.1.0a
> OS: 10.3.9
> Submission from: (NULL) (143.50.77.182)
>
>
> device pdf() produces empty files
>
> and device postscript() produces incompleete graphs


From ripley at stats.ox.ac.uk  Fri Jun 10 17:33:04 2005
From: ripley at stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Fri, 10 Jun 2005 17:33:04 +0200 (CEST)
Subject: [Rd] R.app editor (PR#7928)
Message-ID: <20050610153304.47F0FA208@slim.kubism.ku.dk>

What has this to do with your subject line?  You've sent three messages 
already with that uninformative subject.

Please do read the FAQ and the posting guide and provide a full
reproducible example as they ask.

My guess is that this is user error, the user having failed to call
dev.off() to complete the files.  In the absence of any indication that 
dev.off() was called, I am closing this report.

On Fri, 10 Jun 2005 chmberg at gmail.com wrote:

> Full_Name: Christian Meisenbichler
> Version: 2.1.0a
> OS: 10.3.9

Is that Windows 10.3.9 or Solaris 10.3.9?

> Submission from: (NULL) (143.50.77.182)
>
> device pdf() produces empty files
>
> and device postscript() produces incompleete graphs

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From plummer at iarc.fr  Fri Jun 10 18:12:33 2005
From: plummer at iarc.fr (Martyn Plummer)
Date: Fri, 10 Jun 2005 18:12:33 +0200
Subject: [Rd] attach and object masking
Message-ID: <1118419953.3626.92.camel@seurat>

The library() function prints an information message when objects are
masked on the search path by (or from) a newly attached package.  The
attach() function, however, doesn't.  Is there a good reason for this?
I have adapted the machinery for checking conflicts used in the library
() function to attach().  If there are no objections, I will check this
into R-devel.

I have seen new users get into terrible trouble with attach, e.g. 
1) attaching the same database multiple times, or
2) Masking a vector in an attached data frame with a transformed version
in the global environment and *then* re-running a script that transforms
the transformed variable. For example, run this snippet twice and you
might get a surprise.

foo <- data.frame(x=1:10)
attach(foo)
x <- x/2

A warning would certainly help.

Incidentally, (1) occurs in the example for the beavers data set. I
didn't find any other problems.


From ripley at stats.ox.ac.uk  Fri Jun 10 18:32:43 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri, 10 Jun 2005 17:32:43 +0100 (BST)
Subject: [Rd] attach and object masking
In-Reply-To: <1118419953.3626.92.camel@seurat>
References: <1118419953.3626.92.camel@seurat>
Message-ID: <Pine.LNX.4.61.0506101721320.14746@gannet.stats>

On Fri, 10 Jun 2005, Martyn Plummer wrote:

> The library() function prints an information message when objects are
> masked on the search path by (or from) a newly attached package.  The
> attach() function, however, doesn't.  Is there a good reason for this?
> I have adapted the machinery for checking conflicts used in the library
> () function to attach().  If there are no objections, I will check this
> into R-devel.
>
> I have seen new users get into terrible trouble with attach, e.g.
> 1) attaching the same database multiple times, or
> 2) Masking a vector in an attached data frame with a transformed version
> in the global environment and *then* re-running a script that transforms
> the transformed variable. For example, run this snippet twice and you
> might get a surprise.
>
> foo <- data.frame(x=1:10)
> attach(foo)
> x <- x/2
>
> A warning would certainly help.
>
> Incidentally, (1) occurs in the example for the beavers data set. I
> didn't find any other problems.

Not so: it attaches different dfs with the same column names.  I think 
that is quite common and normally intentional.  (Not cleaning up is 
not good practice though, and that example can be improved a lot.)


From mendes150 at gmail.com  Fri Jun 10 18:41:35 2005
From: mendes150 at gmail.com (mendes150@gmail.com)
Date: Fri, 10 Jun 2005 18:41:35 +0200 (CEST)
Subject: [Rd] source bug ? (PR#7929)
Message-ID: <20050610164135.9D4C3A228@slim.kubism.ku.dk>

hello bug fixers

i think this bug is probably mentioned before but i couldn't find the
answer to it on google.
i have to build R from the source files ( on a mac os x system )
because i need the python R interface too work. for this too happen r
needs to be configured in the following way

./configure --enable-R-shlib

when i do this on the newest package i get already some problems but
these can be handled by the inactivation of the following:
--with-readline=no --with-x=no

now i go on with building R with sudo make:
the following errors are mentioned:

make[4]: *** [libRlapack.dylib] Error 1
make[3]: *** [R] Error 2
make[2]: *** [R] Error 1
make[1]: *** [R] Error 1
make: *** [R] Error 1

it seems that it fails on the following code:

gcc -dynamiclib -L/sw/lib -L/usr/local/lib -install_name
/Library/Frameworks/R.framework/Versions/2.0.1/Resources/lib/libRlapack.dylib
-o libRlapack.dylib dlamc.lo dlapack0.lo dlapack1.lo dlapack2.lo
dlapack3.lo cmplx.lo  cmplxblas.lo  -L/sw/lib -L/usr/local/lib
-L/usr/local/lib/gcc/powerpc-apple-darwin6.8/3.4.2
-L/usr/local/lib/gcc/powerpc-apple-darwin6.8/3.4.2/../../.. -lfrtbegin
-lg2c -lSystem

ld: common symbols not allowed with MH_DYLIB output format with the
-multi_module option
/usr/local/lib/libg2c.a(err.o) definition of common _f__cblank (size 4)
/usr/local/lib/libg2c.a(fmt.o) definition of common _f__cnt (size 40)
/usr/local/lib/libg2c.a(fmt.o) definition of common f(char,  *) (size 4)
/usr/local/lib/libg2c.a(err.o) definition of common f(char, long *,
short __restrict) (/usr/bin/libtool: internal link edit command failed


together with a teacher of me i tried too resolve the problem by
making some changes in the configure file unfortunate we couldnt
resolve it our selves.

if you have any idea how to fix this problem, can you send it to me 

thanks in advance


richard mendes

ps: building R from the binaries works just fine ( only not in
combination with rpy )


From tlumley at u.washington.edu  Fri Jun 10 19:06:28 2005
From: tlumley at u.washington.edu (Thomas Lumley)
Date: Fri, 10 Jun 2005 10:06:28 -0700 (PDT)
Subject: [Rd] source bug ? (PR#7929)
In-Reply-To: <20050610164135.9D4C3A228@slim.kubism.ku.dk>
References: <20050610164135.9D4C3A228@slim.kubism.ku.dk>
Message-ID: <Pine.A41.4.61b.0506101004570.331934@homer05.u.washington.edu>

On Fri, 10 Jun 2005 mendes150 at gmail.com wrote:

> hello bug fixers
>
> i think this bug is probably mentioned before but i couldn't find the
> answer to it on google.
> i have to build R from the source files ( on a mac os x system )
> because i need the python R interface too work. for this too happen r
> needs to be configured in the following way
>
> ./configure --enable-R-shlib
>

The R for Mac OS X FAQ tells you how to configure.  You do need the
   --with-blas='-framework vecLib' --with-lapack 
flags that it lists.

 	-thomas


From murdoch at stats.uwo.ca  Fri Jun 10 22:50:04 2005
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Fri, 10 Jun 2005 16:50:04 -0400
Subject: [Rd] Suggestion: help(<package name>)
In-Reply-To: <42A984EE.30300@stats.uwo.ca>
References: <42A57F5D.7080505@maths.lth.se>
	<42A5D279.3010501@fhcrc.org>		<Pine.LNX.4.61.0506071823460.5947@gannet.stats>		<42A6687A.3000804@stats.uwo.ca>		<Pine.LNX.4.51.0506080918210.12890@artemis.imbe.med.uni-erlangen.de>		<42A6DA63.7020301@stats.uwo.ca>		<Pine.LNX.4.51.0506081633120.22022@artemis.imbe.med.uni-erlangen.de>		<42A89895.6090905@stats.uwo.ca>		<17065.9006.178509.875354@beren.wu-wien.ac.at>		<42A973D7.6050702@stats.uwo.ca>	<971536df050610050045993d58@mail.gmail.com>
	<42A984EE.30300@stats.uwo.ca>
Message-ID: <42A9FCFC.9000208@stats.uwo.ca>

On 6/10/2005 8:17 AM, Duncan Murdoch wrote:
> On 6/10/2005 8:00 AM, Gabor Grothendieck wrote:

>> It would be invoked like this:
>> 
>>    package?boot
>> 
>> with the effect of giving help on boot-package.
> 
> Okay, I get it.  That's a good change.  I'll put it in unless I hear 
> objections very soon.  (I'm going to be away from tomorrow through 
> Thursday, so I might appear to be ignoring objections if I don't see 
> them in time.)

I've committed this change now.  Package overviews are in <pkg>-package 
now (in R-devel).  As Gabor said, this is already supported by the help 
system, so there's nothing to stop someone from creating such an alias 
in their package before that version is released in the fall.

Duncan


From epurdom at stanford.edu  Fri Jun 10 23:52:33 2005
From: epurdom at stanford.edu (epurdom@stanford.edu)
Date: Fri, 10 Jun 2005 23:52:33 +0200 (CEST)
Subject: [Rd] Wishlist: axis( ) could take vector of colors (PR#7930)
Message-ID: <20050610215233.91527A201@slim.kubism.ku.dk>

Hi,
This is not a bug, but a simple enhancement suggestion: that axis( ) also 
allow option "col" to take a vector of colors equal to the length of 
"labels". Currently it allows it, in the sense that there is no error 
message, but the function will use just the first element of the vector.

Example
 > plot(1:5,exp(1:5),axes=F,type="o")
 > axis(1,col=c(rep("red",2),rep("blue",3)))
gives all red axis notation.

Thanks,
Elizabeth Purdom
(Windows XP, R 2.1.0)


From epurdom at stanford.edu  Sat Jun 11 05:06:47 2005
From: epurdom at stanford.edu (epurdom@stanford.edu)
Date: Sat, 11 Jun 2005 05:06:47 +0200 (CEST)
Subject: [Rd] Wishlist: strwidth allow for rotation of text (PR#7931)
Message-ID: <20050611030647.3B9E0A21C@slim.kubism.ku.dk>

Hi,

This is not a bug, but an enhancement suggestion. "strwidth" only gives the 
width of the text according to the x-axis user coordinates, and similarly 
for "strheight". Even if the par setting "srt" is changed to rotate the 
text, the resulting width (resp. height) is in terms of the non-rotated 
text. Currently, if I want to know how much space to leave for vertical 
text in the user coordinates, I manually invert the user coordinates, and 
then change them back.

Even if arbitrary "srt" is too much, just having the option for 90 degree 
rotation would be helpful. If it were implemented for arbitrary srt, then I 
personally think it's x-axis and y-axis dimensions are of interest, and not 
the actual length of the rotated text.

I'm using R 2.1.0, Windows XP

Thanks,
Elizabeth Purdom

Example:
plot(1:100,seq(2,5,length=100), type="n")
par("usr")
# [1]  -2.96 103.96   1.88   5.12
strwidth("hello","user")
# [1] 7.613353
par(srt=90) #rotate 90 degrees
strwidth("hello","user") #still gives same width of text
# [1] 7.613353
par(usr=par("usr")[c(3,4,1,2)])
strwidth("hello","user")
# [1] 0.2307077


From murdoch at stats.uwo.ca  Sat Jun 11 13:02:04 2005
From: murdoch at stats.uwo.ca (murdoch@stats.uwo.ca)
Date: Sat, 11 Jun 2005 13:02:04 +0200 (CEST)
Subject: [Rd] Wishlist: strwidth allow for rotation of text (PR#7931)
Message-ID: <20050611110204.5CC9CA21C@slim.kubism.ku.dk>

epurdom at stanford.edu wrote:
> Hi,
> 
> This is not a bug, but an enhancement suggestion. "strwidth" only gives the 
> width of the text according to the x-axis user coordinates, and similarly 
> for "strheight". Even if the par setting "srt" is changed to rotate the 
> text, the resulting width (resp. height) is in terms of the non-rotated 
> text. Currently, if I want to know how much space to leave for vertical 
> text in the user coordinates, I manually invert the user coordinates, and 
> then change them back.
> 
> Even if arbitrary "srt" is too much, just having the option for 90 degree 
> rotation would be helpful. If it were implemented for arbitrary srt, then I 
> personally think it's x-axis and y-axis dimensions are of interest, and not 
> the actual length of the rotated text.

I think it's pretty standard to measure text this way.  You can get a 
very good approximation to arbitrary rotation by treating the text as a 
width by height rectangle, and using a bit of trig to calculation the 
rotated dimensions of that - but it's much harder to get the original 
dimensions back after doing this.

So I'd suggest that you should write a little function to calculate 
rotated dimensions, document it, and offer it to one of the Misc 
collections.

If you want to waste a lot of time on it you could try to do it in a way 
that can tell the difference between "Ay" and "yA" after a 45 degree 
rotation (the first is wider), but I think it will be hard to get that 
right.

Duncan Murdoch


From Gregor.Gorjanc at bfro.uni-lj.si  Sat Jun 11 13:52:44 2005
From: Gregor.Gorjanc at bfro.uni-lj.si (Gorjanc Gregor)
Date: Sat, 11 Jun 2005 13:52:44 +0200
Subject: [Rd] Slovenian translation strings for R "installation programs"
Message-ID: <7FFEE688B57D7346BC6241C55900E730B7021C@pollux.bfro.uni-lj.si>

Hello!

These would be Slovenian translations. I hope that all characters
will be displayed OK; note that there are three letters with carons
(actually only two are used in these translations): 
 - c with carron as "?"
 - s with carron as "?"
 - z with carron as "?"
For more look at <http://www.ijs.si/slo-chset.html>.

en.regentries=Registry entries:
sl.regentries=Vnosi v registru:

en.associate=Associate R with .RData files
sl.associate=Pove?i datoteke .RData z R

en.dcom=Register R path for use by the (D)COM server
sl.dcom=Registriraj pot R s stre?nikom (D)COM 

en.user=User installation
sl.user=Uporabni?ka namestitev

en.compact=Minimal user installation
sl.compact=Najmanj?a uporabni?ka namestitev

en.full=Full installation
sl.full=Polna namestitev

en.CJK=Chinese/Japanese/Korean installation
sl.CJK=Kitajska/Japonska/Korejska namestitev

en.custom=Custom installation
sl.custom=Prikrojena namestitev

Lep pozdrav / With regards,
    Gregor Gorjanc

----------------------------------------------------------------------
University of Ljubljana
Biotechnical Faculty        URI: http://www.bfro.uni-lj.si/MR/ggorjan
Zootechnical Department     mail: gregor.gorjanc <at> bfro.uni-lj.si
Groblje 3                   tel: +386 (0)1 72 17 861
SI-1230 Domzale             fax: +386 (0)1 72 17 888
Slovenia, Europe
----------------------------------------------------------------------
"One must learn by doing the thing; for though you think you know it,
 you have no certainty until you try." Sophocles ~ 450 B.C.


From tobias.verbeke at telenet.be  Sat Jun 11 13:58:27 2005
From: tobias.verbeke at telenet.be (Tobias Verbeke)
Date: Sat, 11 Jun 2005 13:58:27 +0200
Subject: [Rd] typo in ?lowess
Message-ID: <42AAD1E3.6020202@telenet.be>

In the `See Also' section of ?lowess, I read

     'loess'), a newer formula based version [...]
           ^^^

Tobias


From murdoch at stats.uwo.ca  Sat Jun 11 15:07:10 2005
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Sat, 11 Jun 2005 09:07:10 -0400
Subject: [Rd] typo in ?lowess
In-Reply-To: <42AAD1E3.6020202@telenet.be>
References: <42AAD1E3.6020202@telenet.be>
Message-ID: <42AAE1FE.20801@stats.uwo.ca>

Tobias Verbeke wrote:
> In the `See Also' section of ?lowess, I read
> 
>      'loess'), a newer formula based version [...]


Fixed, thanks.

Duncan Murdoch


From tplate at blackmesacapital.com  Sat Jun 11 15:18:53 2005
From: tplate at blackmesacapital.com (Tony Plate)
Date: Sat, 11 Jun 2005 07:18:53 -0600
Subject: [Rd] single assignment affecting multiple sub-structures
	(PR#7924)
In-Reply-To: <40e66e0b05060911107dda7eae@mail.gmail.com>
References: <20050609171307.C73FFA1EB@slim.kubism.ku.dk>
	<40e66e0b05060911107dda7eae@mail.gmail.com>
Message-ID: <42AAE4BD.7090307@blackmesacapital.com>

Yes, actually, I have had code using do.call() that returns the result I 
want working for years.  However, I've been trying to reduce the memory 
usage of my code, and I discovered that in S-PLUS, do.call() appears to 
make a extra copy of its arguments.  When the arguments are very large, 
this can be important.  I found that by constructing a call like the one 
below, and eval()ing it, S-PLUS would not make unnecessary copies of the 
arguments.

However, when I tried the same code in R, I found the bug that I 
described below.

-- Tony Plate

Douglas Bates wrote:
> I hesitate to make such as simplistic suggestion but have you
> considered using do.call to generate the call?
> 
> On 6/9/05, tplate at blackmesacapital.com <tplate at blackmesacapital.com> wrote:
> 
>>I'm trying to create a language structure that is a call to a function
>>with a number of arguments that is only known at run time.  I do this by
>>using repeated indices to expand out a call with a single argument.
>>However, when I change one of the arguments, all are changed.
>>
>>I don't see the same behavior when I initially create a call with
>>multiple arguments.
>>
>>Even more strangely, calling identical(call1, call2) before any attempts
>>to modify the structures changes the subsequent behavior to be correct.
>>
>>[If there are better methods to create and modify calls, please let me
>>know!]
>>
>> > # Example of commands that give incorrect results
>> > call1 <- Quote(f(arg[[1]], arg[[1]], arg[[1]]))
>> > call2 <- Quote(f(arg[[1]]))[c(1,2,2,2)]
>> > call1
>>f(arg[[1]], arg[[1]], arg[[1]])
>> > call2
>>f(arg[[1]], arg[[1]], arg[[1]])
>> > call1[[3]][[3]] <- 2
>> > call2[[3]][[3]] <- 2
>> > call1
>>f(arg[[1]], arg[[2]], arg[[1]])
>> > # note that all the arguments of call2 have changed!
>> > call2
>>f(arg[[2]], arg[[2]], arg[[2]])
>> > identical(call1, call2)
>>[1] FALSE
>> >
>> > # if we do 'identical(call1, call2)' directly
>> > # after creation, then everything behaves correctly !??
>> > call1 <- Quote(f(arg[[1]], arg[[1]], arg[[1]]))
>> > call2 <- Quote(f(arg[[1]]))[c(1,2,2,2)]
>> > identical(call1, call2)
>>[1] TRUE
>> > call1
>>f(arg[[1]], arg[[1]], arg[[1]])
>> > call2
>>f(arg[[1]], arg[[1]], arg[[1]])
>> > call1[[3]][[3]] <- 2
>> > call2[[3]][[3]] <- 2
>> > call1
>>f(arg[[1]], arg[[2]], arg[[1]])
>> > call2
>>f(arg[[1]], arg[[2]], arg[[1]])
>> > identical(call1, call2)
>>[1] TRUE
>> >
>> > # The same thing happens when the call is created using 'call()'
>> > call3 <- call("f", call("[[", as.name("arg"), 1))[c(1,2,2,2)]
>> > call3
>>f(arg[[1]], arg[[1]], arg[[1]])
>> > call3[[3]][[3]] <- 2
>> > call3
>>f(arg[[2]], arg[[2]], arg[[2]])
>> >
>> > version
>>          _
>>platform i386-pc-mingw32
>>arch     i386
>>os       mingw32
>>system   i386, mingw32
>>status
>>major    2
>>minor    1.0
>>year     2005
>>month    04
>>day      18
>>language R
>> >
>>
>>
>>I also see the same behavior in the development release of R:
>> > version
>>          _
>>platform i386-pc-mingw32
>>arch     i386
>>os       mingw32
>>system   i386, mingw32
>>status   Under development (unstable)
>>major    2
>>minor    2.0
>>year     2005
>>month    06
>>day      07
>>svn rev  34588
>>language R
>> >
>>
>>-- Tony Plate
>>
>>______________________________________________
>>R-devel at stat.math.ethz.ch mailing list
>>https://stat.ethz.ch/mailman/listinfo/r-devel
>>
> 
>


From ggrothendieck at gmail.com  Sat Jun 11 15:30:13 2005
From: ggrothendieck at gmail.com (ggrothendieck@gmail.com)
Date: Sat, 11 Jun 2005 15:30:13 +0200 (CEST)
Subject: [Rd] italic (PR#7932)
Message-ID: <20050611133013.4F4A5A223@slim.kubism.ku.dk>

Full_Name: G. Grothendieck
Version: R version 2.1.0, 2005-05-14
OS: Windows XP
Submission from: (NULL) (216.59.254.207)


This code:

> plot(1:10)
> text(5,5,lab=expression(italic(22*"33")))

has the effect of italicizing 33 (which is a character string) but not 22
(which is not).  I would have thought that both, not just 33, would be
italicized.

I had previously posted about this last week:

https://www.stat.math.ethz.ch/pipermail/r-devel/2005-June/033526.html

however, no one responded.


From ligges at statistik.uni-dortmund.de  Sat Jun 11 16:17:56 2005
From: ligges at statistik.uni-dortmund.de (ligges@statistik.uni-dortmund.de)
Date: Sat, 11 Jun 2005 16:17:56 +0200 (CEST)
Subject: [Rd] Wishlist: axis( ) could take vector of colors (PR#7930)
Message-ID: <20050611141756.8DEDEA223@slim.kubism.ku.dk>

epurdom at stanford.edu wrote:

> Hi,
> This is not a bug, but a simple enhancement suggestion: that axis( ) also 
> allow option "col" to take a vector of colors equal to the length of 
> "labels". Currently it allows it, in the sense that there is no error 
> message, but the function will use just the first element of the vector.
> 
> Example
>  > plot(1:5,exp(1:5),axes=F,type="o")
>  > axis(1,col=c(rep("red",2),rep("blue",3)))
> gives all red axis notation.


A color of length > 1 does not make sense here, from my point of view. 
Hence I'd like to object here.
It might make sense for argument "col.axis", but this is very hard to 
implement due to the internal structure of automatical tick mark 
calculations.

Most easily you can use mtext() to annotate an un-annotated axis with 
different colors as in:

  plot(1:10, xaxt="n")
  axis(1, at=c(2,5,8), labels=rep("", 3))
  mtext(c(2,5,8), side=1, at=c(2,5,8),
        col=c("red", "green", "blue"), line=0.5)


Uwe Ligges



> Thanks,
> Elizabeth Purdom
> (Windows XP, R 2.1.0)
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From kanglin at gmail.com  Sat Jun 11 18:57:43 2005
From: kanglin at gmail.com (D0c)
Date: Sat, 11 Jun 2005 11:57:43 -0500
Subject: [Rd] Using Rserve
Message-ID: <2667b21305061109571335ef88@mail.gmail.com>

Hey is there a more consistent way of  connecting to Rserve. I have
code that opens a connection to Rserve by executing explicitly using
Java runtime ( "C:\Program Files\R\r20XXX\Rserve.exe" ).
However when i run the app and attempt to connect, it does not connect
imediately.I have to close the app and open it again for a few times
before i get a connection.
Am i doing something wrong?


From tefaes at chekhabar.com  Sat Jun 11 01:25:32 2005
From: tefaes at chekhabar.com (raymond nestor)
Date: Sat, 11 Jun 2005 08:25:32 +0900
Subject: [Rd] It is scary to browse the high prices on tablets at the
	localstores. So check our medzone.
Message-ID: <EB25009A.55661F7@chekhabar.com>

Our chemistshop helps you sa.ve a lot on medicaments. It is straightforward
and lawful to sa.ve on tablets in this vvay. 
 
Browse our showroom for quality RxMeds on ErectionDysfunctions, Severe
Ache, Tension Relief, relaxants for muscles, man's care, Over wt. and other
discomforts. 
Browse our expeditious and swift carriage works that carry customers
complete convenience.

Take all the advantages of our super special on quality medis.
The casefile review is completed by appraised practitioners at our
storezone for gratis.


http://fw.v.elementandmixture.com/tr/


-----original message-----
From: Russell at ki.com [mailto:Johnie at s.com]
Sent: Thursday, March 0, 2005 8:10PM
To: Harlan; Stephen at btqp.com; ; Davis; Clinton
Subject: It is gratis, a quick casefile review by our specialists.

It is easier to gain the re.fill as we knovv the right way. Cybershopping
is absolutely a straightforward way for me to drop the expenditures. At your
showroom, I have saved around 2OO bucks. Cybershopping for antidotes is
quicker and brings me additional convenience. -- Victor B. in NY


Not  have received a more gratifying attention.  Miss Elliot was to
have 
the honour of calling on Mrs Musgrove in the course of the morning; 
to meander myse lf, at present
`I didn't say they were officers - just two young men who had been
lunching.'  would have thought as I did, unless you had been determined 
, I will go bac 8 k to my birth. I 3  was  born at Blun


From Gregor.Gorjanc at bfro.uni-lj.si  Sat Jun 11 23:05:09 2005
From: Gregor.Gorjanc at bfro.uni-lj.si (Gorjanc Gregor)
Date: Sat, 11 Jun 2005 23:05:09 +0200
Subject: [Rd] FW: Slovenian translation strings for R "installation programs"
Message-ID: <7FFEE688B57D7346BC6241C55900E730B7021D@pollux.bfro.uni-lj.si>

Hello again!

I appologize for repost, but I got some "corrections/suggestions" from
a local translation team. Look bellow.

>-----Original Message-----
>From: Gorjanc Gregor
>Sent: sob 2005-06-11 13:52
>To: r-devel at stat.math.ethz.ch
>Subject: Slovenian translation strings for R "installation programs"
> 
>Hello!
>
>These would be Slovenian translations. I hope that all characters
>will be displayed OK; note that there are three letters with carons
>(actually only two are used in these translations): 
> - c with carron as "?"
> - s with carron as "?"
> - z with carron as "?"
>For more look at <http://www.ijs.si/slo-chset.html>.
>
>en.regentries=Registry entries:
>sl.regentries=Vnosi v registru:
>
>en.associate=Associate R with .RData files
>sl.associate=Pove?i datoteke .RData z R
>
>en.dcom=Register R path for use by the (D)COM server
>sl.dcom=Registriraj pot R s stre?nikom (D)COM 

sl.dcom=Registriraj pot do R za stre?nik (D)COM 

>
>en.user=User installation
>sl.user=Uporabni?ka namestitev
>
>en.compact=Minimal user installation
>sl.compact=Najmanj?a uporabni?ka namestitev
>
>en.full=Full installation
>sl.full=Polna namestitev
>
>en.CJK=Chinese/Japanese/Korean installation
>sl.CJK=Kitajska/Japonska/Korejska namestitev

sl.CJK=Namestitev v kitajskem/japonskem/korejskem jeziku

>
>en.custom=Custom installation
>sl.custom=Prikrojena namestitev

sl.custom=Namestitev po meri

Lep pozdrav / With regards,
    Gregor Gorjanc

----------------------------------------------------------------------
University of Ljubljana
Biotechnical Faculty        URI: http://www.bfro.uni-lj.si/MR/ggorjan
Zootechnical Department     mail: gregor.gorjanc <at> bfro.uni-lj.si
Groblje 3                   tel: +386 (0)1 72 17 861
SI-1230 Domzale             fax: +386 (0)1 72 17 888
Slovenia, Europe
----------------------------------------------------------------------
"One must learn by doing the thing; for though you think you know it,
 you have no certainty until you try." Sophocles ~ 450 B.C.


From ripley at stats.ox.ac.uk  Sat Jun 11 23:40:49 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Sat, 11 Jun 2005 22:40:49 +0100 (BST)
Subject: [Rd] FW: Slovenian translation strings for R "installation
 programs"
In-Reply-To: <7FFEE688B57D7346BC6241C55900E730B7021D@pollux.bfro.uni-lj.si>
References: <7FFEE688B57D7346BC6241C55900E730B7021D@pollux.bfro.uni-lj.si>
Message-ID: <Pine.LNX.4.61.0506112238230.15118@gannet.stats>

Thanks for the translations.

I am having some trouble with charsets (the installer has to be built
from files containing about 6 different ones).  The version now in is your 
first one.  I will try to update it by Monday, but I need to reboot my 
Windows machine every time I change languages so this gets very tedious.

On Sat, 11 Jun 2005, Gorjanc Gregor wrote:

> Hello again!
>
> I appologize for repost, but I got some "corrections/suggestions" from
> a local translation team. Look bellow.
>
>> -----Original Message-----
>> From: Gorjanc Gregor
>> Sent: sob 2005-06-11 13:52
>> To: r-devel at stat.math.ethz.ch
>> Subject: Slovenian translation strings for R "installation programs"
>>
>> Hello!
>>
>> These would be Slovenian translations. I hope that all characters
>> will be displayed OK; note that there are three letters with carons
>> (actually only two are used in these translations):
>> - c with carron as ""
>> - s with carron as "a"
>> - z with carron as "~"
>> For more look at <http://www.ijs.si/slo-chset.html>.
>>
>> en.regentries=Registry entries:
>> sl.regentries=Vnosi v registru:
>>
>> en.associate=Associate R with .RData files
>> sl.associate=Pove~i datoteke .RData z R
>>
>> en.dcom=Register R path for use by the (D)COM server
>> sl.dcom=Registriraj pot R s stre~nikom (D)COM
>
> sl.dcom=Registriraj pot do R za stre~nik (D)COM
>
>>
>> en.user=User installation
>> sl.user=Uporabniaka namestitev
>>
>> en.compact=Minimal user installation
>> sl.compact=Najmanjaa uporabniaka namestitev
>>
>> en.full=Full installation
>> sl.full=Polna namestitev
>>
>> en.CJK=Chinese/Japanese/Korean installation
>> sl.CJK=Kitajska/Japonska/Korejska namestitev
>
> sl.CJK=Namestitev v kitajskem/japonskem/korejskem jeziku
>
>>
>> en.custom=Custom installation
>> sl.custom=Prikrojena namestitev
>
> sl.custom=Namestitev po meri
>
> Lep pozdrav / With regards,
>    Gregor Gorjanc
>
> ----------------------------------------------------------------------
> University of Ljubljana
> Biotechnical Faculty        URI: http://www.bfro.uni-lj.si/MR/ggorjan
> Zootechnical Department     mail: gregor.gorjanc <at> bfro.uni-lj.si
> Groblje 3                   tel: +386 (0)1 72 17 861
> SI-1230 Domzale             fax: +386 (0)1 72 17 888
> Slovenia, Europe
> ----------------------------------------------------------------------
> "One must learn by doing the thing; for though you think you know it,
> you have no certainty until you try." Sophocles ~ 450 B.C.
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From dratinos at cymail.net  Sun Jun 12 02:18:55 2005
From: dratinos at cymail.net (dratinos@cymail.net)
Date: Sun, 12 Jun 2005 02:18:55 +0200 (CEST)
Subject: [Rd] Simple antidotes pur.chase,
	brings greater financial gains. (PR#7933)
Message-ID: <20050612001855.72F72A208@slim.kubism.ku.dk>

Select from a wide variety of brand name and generic curatives. It is lawful
to pur.chase from our appraised chemist zones.

We distribute customers quick medz on Soreness, ErectionDysfunction,
Sleeping Disorders, Raised Cholesterin, Diabetes and other problems.
We create a cyber world where customers can experience complete convenience
brought by expeditious carriage work.
Review our storespace and you will unearth how much you can gain at our
storespace.
On our medizone, your casenotes will be reviewed by advisers for gratis.


http://ikd.D.findthecreator.com/tny/
Seek for the best deals on tablets at our chemistplace novv!


 race at this moment to be quite Every one capable of thinking felt the
advantage of the idea, 
the warm and faithful feelings of any of my fellow-creatures! 
 certain whether they had re ason to feel obliged to
 us for doing so, or the reverse - and in a moment (it was all done in
rapid moments) Captain Benwick had 
 and then made our way home to  5 Mr. Peggotty's dwelling. We stop 5 ped
under the lee of  the lobster-outhou


From ggrothendieck at gmail.com  Sun Jun 12 02:38:27 2005
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Sat, 11 Jun 2005 20:38:27 -0400
Subject: [Rd] FW: Slovenian translation strings for R "installation
	programs"
In-Reply-To: <Pine.LNX.4.61.0506112238230.15118@gannet.stats>
References: <7FFEE688B57D7346BC6241C55900E730B7021D@pollux.bfro.uni-lj.si>
	<Pine.LNX.4.61.0506112238230.15118@gannet.stats>
Message-ID: <971536df050611173846adea65@mail.gmail.com>

On 6/11/05, Prof Brian Ripley <ripley at stats.ox.ac.uk> wrote:
> Thanks for the translations.
> 
> I am having some trouble with charsets (the installer has to be built
> from files containing about 6 different ones).  The version now in is your
> first one.  I will try to update it by Monday, but I need to reboot my
> Windows machine every time I change languages so this gets very tedious.

I believe that each user you have set up on Windows XP
can have a different language so just set up multiple users, one per
language and you won't have to reboot.


From ripley at stats.ox.ac.uk  Sun Jun 12 11:14:49 2005
From: ripley at stats.ox.ac.uk (Brian D Ripley)
Date: Sun, 12 Jun 2005 10:14:49 +0100 (BST)
Subject: [Rd] FW: Slovenian translation strings for R "installation
 programs"
In-Reply-To: <971536df050611173846adea65@mail.gmail.com>
Message-ID: <Pine.GSO.4.31.0506121009100.12656-100000@markov.stats>

On Sat, 11 Jun 2005, Gabor Grothendieck wrote:

> On 6/11/05, Prof Brian Ripley <ripley at stats.ox.ac.uk> wrote:
> > Thanks for the translations.
> >
> > I am having some trouble with charsets (the installer has to be built
> > from files containing about 6 different ones).  The version now in is your
> > first one.  I will try to update it by Monday, but I need to reboot my
> > Windows machine every time I change languages so this gets very tedious.
>
> I believe that each user you have set up on Windows XP
> can have a different language so just set up multiple users, one per
> language and you won't have to reboot.

No.  The default codepage is set for all users, and a reboot is needed to
change it.

Different users can have different languages (or a user can select a
language at login), but that only works for languages supported by the
default codepage.


-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From ggrothendieck at gmail.com  Sun Jun 12 15:17:07 2005
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Sun, 12 Jun 2005 09:17:07 -0400
Subject: [Rd] FW: Slovenian translation strings for R "installation
	programs"
In-Reply-To: <Pine.GSO.4.31.0506121009100.12656-100000@markov.stats>
References: <971536df050611173846adea65@mail.gmail.com>
	<Pine.GSO.4.31.0506121009100.12656-100000@markov.stats>
Message-ID: <971536df050612061729826545@mail.gmail.com>

On 6/12/05, Brian D Ripley <ripley at stats.ox.ac.uk> wrote:
> On Sat, 11 Jun 2005, Gabor Grothendieck wrote:
> 
> > On 6/11/05, Prof Brian Ripley <ripley at stats.ox.ac.uk> wrote:
> > > Thanks for the translations.
> > >
> > > I am having some trouble with charsets (the installer has to be built
> > > from files containing about 6 different ones).  The version now in is your
> > > first one.  I will try to update it by Monday, but I need to reboot my
> > > Windows machine every time I change languages so this gets very tedious.
> >
> > I believe that each user you have set up on Windows XP
> > can have a different language so just set up multiple users, one per
> > language and you won't have to reboot.
> 
> No.  The default codepage is set for all users, and a reboot is needed to
> change it.
> 
> Different users can have different languages (or a user can select a
> language at login), but that only works for languages supported by the
> default codepage.

Windows XP also has an optional Multilanguage User Interface (MUI) but
I don't know really know much about it.  Google for MUI XP for more info.
Maybe someone on the list has it and can add information.


From ggrothendieck at gmail.com  Sun Jun 12 20:10:40 2005
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Sun, 12 Jun 2005 14:10:40 -0400
Subject: [Rd] by should use match.fun
Message-ID: <971536df0506121110777ddbf@mail.gmail.com>

I noticed that, unlike similar functions, 'by' does not use match.fun, e.g.

> by(iris, iris$Species, "summary")
Error in FUN(X[[1]], ...) : couldn't find function "FUN"

The 'by' code should have an initial line of:

FUN <- match.fun(FUN)


From andy_liaw at merck.com  Sun Jun 12 21:08:56 2005
From: andy_liaw at merck.com (Liaw, Andy)
Date: Sun, 12 Jun 2005 15:08:56 -0400
Subject: [Rd] by should use match.fun
Message-ID: <39B6DDB9048D0F4DAD42CB26AAFF0AFA64E98E@usctmx1106.merck.com>

I don't get the point.  ?by says:

FUN a function to be applied to data frame subsets of data. 

It doesn't say FUN can be a character, and by(iris, iris$Species, summary)
works as expected.

Andy

> From: Gabor Grothendieck
> 
> I noticed that, unlike similar functions, 'by' does not use 
> match.fun, e.g.
> 
> > by(iris, iris$Species, "summary")
> Error in FUN(X[[1]], ...) : couldn't find function "FUN"
> 
> The 'by' code should have an initial line of:
> 
> FUN <- match.fun(FUN)
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> 
>


From ggrothendieck at gmail.com  Sun Jun 12 21:21:59 2005
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Sun, 12 Jun 2005 15:21:59 -0400
Subject: [Rd] by should use match.fun
In-Reply-To: <39B6DDB9048D0F4DAD42CB26AAFF0AFA64E98E@usctmx1106.merck.com>
References: <39B6DDB9048D0F4DAD42CB26AAFF0AFA64E98E@usctmx1106.merck.com>
Message-ID: <971536df050612122118e55e2f@mail.gmail.com>

On 6/12/05, Liaw, Andy <andy_liaw at merck.com> wrote:
> I don't get the point.  ?by says:

The point is that all other functions of this sort including apply, sapply,
tapply, lapply work like that so 'by' ought to as well.  

Here is the example (changed to use iris) where I noticed it.  Suppose we 
want to create a list of rows:

by(iris, row.names(iris), "(")

In every other similar function this would have worked but here we must do:

by(iris, row.names(iris), match.fun("("))




> 
> FUN a function to be applied to data frame subsets of data.
> 
> It doesn't say FUN can be a character, and by(iris, iris$Species, summary)
> works as expected.
> 
> Andy
> 
> > From: Gabor Grothendieck
> >
> > I noticed that, unlike similar functions, 'by' does not use
> > match.fun, e.g.
> >
> > > by(iris, iris$Species, "summary")
> > Error in FUN(X[[1]], ...) : couldn't find function "FUN"
> >
> > The 'by' code should have an initial line of:
> >
> > FUN <- match.fun(FUN)
> >
> > ______________________________________________
> > R-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-devel
> >
> >
> >
> 
> 
> 
> ------------------------------------------------------------------------------
> Notice:  This e-mail message, together with any attachment...{{dropped}}


From simon.urbanek at r-project.org  Sun Jun 12 21:32:02 2005
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Sun, 12 Jun 2005 15:32:02 -0400
Subject: [Rd] by should use match.fun
In-Reply-To: <971536df050612122118e55e2f@mail.gmail.com>
References: <39B6DDB9048D0F4DAD42CB26AAFF0AFA64E98E@usctmx1106.merck.com>
	<971536df050612122118e55e2f@mail.gmail.com>
Message-ID: <71D65BAB-A619-4F24-8EBA-DAA15B4ADCD2@r-project.org>

On Jun 12, 2005, at 3:21 PM, Gabor Grothendieck wrote:

> On 6/12/05, Liaw, Andy <andy_liaw at merck.com> wrote:
>
>> I don't get the point.  ?by says:
>>
>
> The point is that all other functions of this sort including apply,  
> sapply,
> tapply, lapply work like that so 'by' ought to as well.
>
> Here is the example (changed to use iris) where I noticed it.   
> Suppose we
> want to create a list of rows:
>
> by(iris, row.names(iris), "(")

Umm.. why don't you just use

by(iris, row.names(iris), `(`)

In general I consider passing functions as text unnecessary - the  
only use I could think of is constructing function names from strings/ 
data and I'm not sure that is a good idea, either (it causes quite  
some performance issues) ... just my 2 pennies ...

Cheers,
Simon


From ggrothendieck at gmail.com  Sun Jun 12 21:37:23 2005
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Sun, 12 Jun 2005 15:37:23 -0400
Subject: [Rd] by should use match.fun
In-Reply-To: <71D65BAB-A619-4F24-8EBA-DAA15B4ADCD2@r-project.org>
References: <39B6DDB9048D0F4DAD42CB26AAFF0AFA64E98E@usctmx1106.merck.com>
	<971536df050612122118e55e2f@mail.gmail.com>
	<71D65BAB-A619-4F24-8EBA-DAA15B4ADCD2@r-project.org>
Message-ID: <971536df05061212375bc4e7a3@mail.gmail.com>

On 6/12/05, Simon Urbanek <simon.urbanek at r-project.org> wrote:
> On Jun 12, 2005, at 3:21 PM, Gabor Grothendieck wrote:
> 
> > On 6/12/05, Liaw, Andy <andy_liaw at merck.com> wrote:
> >
> >> I don't get the point.  ?by says:
> >>
> >
> > The point is that all other functions of this sort including apply,
> > sapply,
> > tapply, lapply work like that so 'by' ought to as well.
> >
> > Here is the example (changed to use iris) where I noticed it.
> > Suppose we
> > want to create a list of rows:
> >
> > by(iris, row.names(iris), "(")
> 
> Umm.. why don't you just use
> 
> by(iris, row.names(iris), `(`)
> 
> In general I consider passing functions as text unnecessary - the
> only use I could think of is constructing function names from strings/
> data and I'm not sure that is a good idea, either (it causes quite
> some performance issues) ... just my 2 pennies ...

That's a good idea and I will change my code accordingly although it does 
not change the fact that an inconsistency remains and should be
corrected.


From p.dalgaard at biostat.ku.dk  Sun Jun 12 22:49:29 2005
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: 12 Jun 2005 22:49:29 +0200
Subject: [Rd] by should use match.fun
In-Reply-To: <971536df05061212375bc4e7a3@mail.gmail.com>
References: <39B6DDB9048D0F4DAD42CB26AAFF0AFA64E98E@usctmx1106.merck.com>
	<971536df050612122118e55e2f@mail.gmail.com>
	<71D65BAB-A619-4F24-8EBA-DAA15B4ADCD2@r-project.org>
	<971536df05061212375bc4e7a3@mail.gmail.com>
Message-ID: <x2r7f7z4fa.fsf@turmalin.kubism.ku.dk>

Gabor Grothendieck <ggrothendieck at gmail.com> writes:

> On 6/12/05, Simon Urbanek <simon.urbanek at r-project.org> wrote:
....
> > Umm.. why don't you just use
> > 
> > by(iris, row.names(iris), `(`)
> > 
> > In general I consider passing functions as text unnecessary - the
> > only use I could think of is constructing function names from strings/
> > data and I'm not sure that is a good idea, either (it causes quite
> > some performance issues) ... just my 2 pennies ...
> 
> That's a good idea and I will change my code accordingly although it does 
> not change the fact that an inconsistency remains and should be
> corrected.

Also, match.fun takes some pains to actually give you a function,
guarding the user against the (otherwise well-deserved...)
consequences of storing results in an object called "summary", etc.

So, good idea. Maybe not for 2.1.1 though. This close to a release we
should be going strictly after actual bugs, not just inconsistencies.

-- 
   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
 (*) \(*) -- University of Copenhagen   Denmark          Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)                  FAX: (+45) 35327907


From vangyzen at stat.duke.edu  Sun Jun 12 23:25:06 2005
From: vangyzen at stat.duke.edu (vangyzen@stat.duke.edu)
Date: Sun, 12 Jun 2005 23:25:06 +0200 (CEST)
Subject: [Rd] alloca() on FreeBSD (PR#7890)
Message-ID: <20050612212506.39141A21C@slim.kubism.ku.dk>

Prof. Ripley:

I apologize for my lack of response.  I just moved halfway across the US 
and have had little to no connectivity for the past two weeks.  :(

Thanks to you and Rainer Hurling for fixing this.

Eric

Prof Brian Ripley wrote:
> On Mon, 23 May 2005 vangyzen at stat.duke.edu wrote:
> 
>> Full_Name: Eric van Gyzen
>> Version: 2.1.0
>> OS: FreeBSD 5.4
>> Submission from: (NULL) (152.3.22.33)
>>
>>
>> R-2.1.0 fails to compile on the newest release of FreeBSD, complaining 
>> about
>> undefined references to __builtin_alloca.  On FreeBSD, alloca() is 
>> declared in
>> stdlib.h, not alloca.h as the R sources expect.  Therefore, 
>> HAVE_DECL_ALLOCA
>> does not get set, so the R sources declare alloca() after it has 
>> already been
>> #defined by stdlib.h.
>>
>> A possible fix is to modify the configure script to look for the 
>> declaration of
>> alloca() in stdlib.h (perhaps after it fails to find it in alloca.h).
> 
> 
> It is already supposed to, so it is not finding the declaration there 
> either. If you look up the definition of
> 
> AC_CHECK_DECLS([alloca], , , [#include <alloca.h>])
> 
> it searches in stdlib.h.  Can you please send us the appropriate part of 
> config.log?  It may be that this is failing because alloca.h is not found
> (but AC_FUNC_ALLOCA is making the same assumptions).
> 
> Perhaps the easiest way out is to override the setting on FreeBSD: can 
> you please confirm that manually changing
> 
> #define HAVE_DECL_ALLOCA 1
> 
> in config.h works?
> 
>> This was previously reported in PR#7881.
> 
> 
> So please don't open a new report on the subject!
>


From smyth at wehi.EDU.AU  Mon Jun 13 02:37:40 2005
From: smyth at wehi.EDU.AU (Gordon K Smyth)
Date: Mon, 13 Jun 2005 10:37:40 +1000 (EST)
Subject: [Rd] Citation for R
Message-ID: <2014.220.238.186.9.1118623060.squirrel@homebase.wehi.edu.au>

This is just a note that R would get a lot more citations if the recommended citation was an
article in a recognised journal or from a recognised publisher.

I use R in work leading to publications often, and I strongly want to give the R core team credit
for their work.  However I find that I can't persuade my biological collaborators to include the
current R citation (below) in their reference lists, because it is not an article in a recognised
journal nor from a recognised publisher.  I can cite the 1996 paper by Ihaka and Gentleman, and
sometimes this what I do, but I'd really like to give credit to the other R core members as well,
for example the CRAN people and those involved in the Windows version.

I know this is more work for the R team, like everything else, but an article on the story of R
since the creation of the core team would be really nice to see.

> citation()

To cite R in publications use:

  R Development Core Team (2005). R: A language and environment for statistical
  computing. R Foundation for Statistical Computing, Vienna, Austria. ISBN
  3-900051-07-0, URL http://www.R-project.org.


Gordon


From deleeuw at stat.ucla.edu  Mon Jun 13 02:51:57 2005
From: deleeuw at stat.ucla.edu (Jan de Leeuw)
Date: Sun, 12 Jun 2005 17:51:57 -0700
Subject: [Rd] Citation for R
In-Reply-To: <2014.220.238.186.9.1118623060.squirrel@homebase.wehi.edu.au>
References: <2014.220.238.186.9.1118623060.squirrel@homebase.wehi.edu.au>
Message-ID: <8BF8A896-0C93-4AD9-A1E3-BDE7B7CCB98B@stat.ucla.edu>

There is one easy way to do this. Make R-core the guest editor of a  
special
issue of JSS and use that special issue to publish the manuals (which  
again
have R-core as author).

On Jun 12, 2005, at 17:37 , Gordon K Smyth wrote:

> This is just a note that R would get a lot more citations if the  
> recommended citation was an
> article in a recognised journal or from a recognised publisher.
>
> I use R in work leading to publications often, and I strongly want  
> to give the R core team credit
> for their work.  However I find that I can't persuade my biological  
> collaborators to include the
> current R citation (below) in their reference lists, because it is  
> not an article in a recognised
> journal nor from a recognised publisher.  I can cite the 1996 paper  
> by Ihaka and Gentleman, and
> sometimes this what I do, but I'd really like to give credit to the  
> other R core members as well,
> for example the CRAN people and those involved in the Windows version.
>
> I know this is more work for the R team, like everything else, but  
> an article on the story of R
> since the creation of the core team would be really nice to see.
>
>
>> citation()
>>
>
> To cite R in publications use:
>
>   R Development Core Team (2005). R: A language and environment for  
> statistical
>   computing. R Foundation for Statistical Computing, Vienna,  
> Austria. ISBN
>   3-900051-07-0, URL http://www.R-project.org.
>
>
> Gordon
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>

===
Jan de Leeuw; Distinguished Professor and Chair, UCLA Department of  
Statistics;
Editor: Journal of Multivariate Analysis, Journal of Statistical  
Software
US mail: 8130 Math Sciences Bldg, Box 951554, Los Angeles, CA 90095-1554
phone (310)-825-9550;  fax (310)-206-5658;  email: deleeuw at stat.ucla.edu
.mac: jdeleeuw ++++++  aim: deleeuwjan ++++++ skype: j_deleeuw
homepages: http://gifi.stat.ucla.edu ++++++ http://www.cuddyvalley.org
   
------------------------------------------------------------------------ 
-------------------------
           No matter where you go, there you are. --- Buckaroo Banzai
                    http://gifi.stat.ucla.edu/sounds/nomatter.au


From znmeb at cesmail.net  Mon Jun 13 03:02:20 2005
From: znmeb at cesmail.net (M. Edward (Ed) Borasky)
Date: Sun, 12 Jun 2005 18:02:20 -0700
Subject: [Rd] Citation for R
In-Reply-To: <2014.220.238.186.9.1118623060.squirrel@homebase.wehi.edu.au>
References: <2014.220.238.186.9.1118623060.squirrel@homebase.wehi.edu.au>
Message-ID: <42ACDB1C.7050103@cesmail.net>



Gordon K Smyth wrote:

>This is just a note that R would get a lot more citations if the recommended citation was an
>article in a recognised journal or from a recognised publisher.
>
>I use R in work leading to publications often, and I strongly want to give the R core team credit
>for their work.  However I find that I can't persuade my biological collaborators to include the
>current R citation (below) in their reference lists, because it is not an article in a recognised
>journal nor from a recognised publisher.  I can cite the 1996 paper by Ihaka and Gentleman, and
>sometimes this what I do, but I'd really like to give credit to the other R core members as well,
>for example the CRAN people and those involved in the Windows version.
>
>I know this is more work for the R team, like everything else, but an article on the story of R
>since the creation of the core team would be really nice to see.
>  
>

Are there any restrictions on the domain of discourse where said
publication could take place? For example, last year's Computer
Management Group (CMG) proceedings had a paper by someone who is using R
in much the same manner as I am -- to analyze computer performance data.
It's not biology, but it *is* peer-reviewed. Try "Using R for System
Performance Analysis" by James Holtman in the 2004 Proceedings of the CMG.


From znmeb at cesmail.net  Mon Jun 13 07:51:07 2005
From: znmeb at cesmail.net (M. Edward (Ed) Borasky)
Date: Sun, 12 Jun 2005 22:51:07 -0700
Subject: [Rd] R 2.1.1 slated for June 20
In-Reply-To: <x264wmbe6m.fsf@turmalin.kubism.ku.dk>
References: <x264wmbe6m.fsf@turmalin.kubism.ku.dk>
Message-ID: <42AD1ECB.8000706@cesmail.net>

Question: I just downloaded the daily Windows build of "R-devel" and it
claims to be a pre-release of R 2.2.0. So ... is the next release 2.1.1
or 2.2.0? Or is there just not a readily-available Windows build of 2.1.1?

Peter Dalgaard wrote:

>The next version of R will be released (barring force majeure) on June
>20th, with beta versions available starting Monday. 
>
>Please do check them on your system *before* the release this time...
>
>Apologies for the late announcement, but my department moved this week
>and I needed to be sure that my set-up survived the move.
>
>        -pd
>
>  
>


From ligges at statistik.uni-dortmund.de  Mon Jun 13 08:14:45 2005
From: ligges at statistik.uni-dortmund.de (Uwe Ligges)
Date: Mon, 13 Jun 2005 08:14:45 +0200
Subject: [Rd] R 2.1.1 slated for June 20
In-Reply-To: <42AD1ECB.8000706@cesmail.net>
References: <x264wmbe6m.fsf@turmalin.kubism.ku.dk>
	<42AD1ECB.8000706@cesmail.net>
Message-ID: <42AD2455.9000806@statistik.uni-dortmund.de>

M. Edward (Ed) Borasky wrote:
> Question: I just downloaded the daily Windows build of "R-devel" and it
> claims to be a pre-release of R 2.2.0. So ... is the next release 2.1.1
> or 2.2.0? Or is there just not a readily-available Windows build of 2.1.1?

R-devel is the development version for R-2.2.0.
You want to download R-patched (to be R-2.1.1) instead.

Uwe Ligges



> Peter Dalgaard wrote:
> 
> 
>>The next version of R will be released (barring force majeure) on June
>>20th, with beta versions available starting Monday. 
>>
>>Please do check them on your system *before* the release this time...
>>
>>Apologies for the late announcement, but my department moved this week
>>and I needed to be sure that my set-up survived the move.
>>
>>       -pd
>>
>> 
>>
> 
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From antonio.dinarzo at studio.unibo.it  Mon Jun 13 10:43:07 2005
From: antonio.dinarzo at studio.unibo.it (antonio.dinarzo@studio.unibo.it)
Date: Mon, 13 Jun 2005 10:43:07 +0200
Subject: [Rd] memory allocation problem under linux
Message-ID: <1118652187.42ad471bd917f@posta.studio.unibo.it>

I have some compiled code that works under winXp but not under linux (kernel
2.6.10-5). I'm also using R 2.1.0
After debugging, I've discovered that in this code:
  #define NMAX 256
  long **box;
  ...
  box   = (long **)R_alloc(NMAX,   sizeof(long *));   //<---HERE THE SIGSEGV
  for (i=0; i<NMAX; i++) box[i] = (long *) R_alloc(NMAX, sizeof(long));
inside the *first* call to the function R_alloc I have a segmentation fault.
Changing R_alloc with Calloc and malloc gives the same result.
However, in the same shared library, I have another function with this code:
  partitions=16;
  ...
  h2=(long **)R_alloc(partitions,sizeof(long *));
  for (i=0;i<partitions;i++)
      h2[i]=(long *)R_alloc(partitions,sizeof(long));
that works! Naturally, I've tried to change NMAX from 256 to 16, without any
success.
I've changed optimization flags from O2 to O and O2, without success.
Any idea on where the problem *should* reside? (Note that this not happens under
WinXp!).

Antonio, Fabio Di Narzo.


From ripley at stats.ox.ac.uk  Mon Jun 13 10:52:45 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Mon, 13 Jun 2005 09:52:45 +0100 (BST)
Subject: [Rd] memory allocation problem under linux
In-Reply-To: <1118652187.42ad471bd917f@posta.studio.unibo.it>
References: <1118652187.42ad471bd917f@posta.studio.unibo.it>
Message-ID: <Pine.LNX.4.61.0506130947360.23218@gannet.stats>

You keep on sending similar messages -- this is at least the third.  You 
need to find out where the segfault is occurring using gdb, and you have 
not told us.

Very likely this results from some previous memory corruption in your 
compiled code: try valgrind (see `Writing R Extensions') to try to track 
that down.

Since this fails with malloc, it is not really an R question.

On Mon, 13 Jun 2005, antonio.dinarzo at studio.unibo.it wrote:

> I have some compiled code that works under winXp but not under linux (kernel
> 2.6.10-5). I'm also using R 2.1.0
> After debugging, I've discovered that in this code:
>  #define NMAX 256
>  long **box;
>  ...
>  box   = (long **)R_alloc(NMAX,   sizeof(long *));   //<---HERE THE SIGSEGV
>  for (i=0; i<NMAX; i++) box[i] = (long *) R_alloc(NMAX, sizeof(long));
> inside the *first* call to the function R_alloc I have a segmentation fault.
> Changing R_alloc with Calloc and malloc gives the same result.
> However, in the same shared library, I have another function with this code:
>  partitions=16;
>  ...
>  h2=(long **)R_alloc(partitions,sizeof(long *));
>  for (i=0;i<partitions;i++)
>      h2[i]=(long *)R_alloc(partitions,sizeof(long));
> that works! Naturally, I've tried to change NMAX from 256 to 16, without any
> success.
> I've changed optimization flags from O2 to O and O2, without success.
> Any idea on where the problem *should* reside? (Note that this not happens under
> WinXp!).

The last is probably just good luck.

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From antonio.dinarzo at studio.unibo.it  Mon Jun 13 12:12:14 2005
From: antonio.dinarzo at studio.unibo.it (antonio.dinarzo@studio.unibo.it)
Date: Mon, 13 Jun 2005 12:12:14 +0200
Subject: [Rd] memory allocation problem under linux
In-Reply-To: <Pine.LNX.4.61.0506130947360.23218@gannet.stats>
References: <1118652187.42ad471bd917f@posta.studio.unibo.it>
	<Pine.LNX.4.61.0506130947360.23218@gannet.stats>
Message-ID: <1118657534.42ad5bfecb192@posta.studio.unibo.it>

Scrive Prof Brian Ripley <ripley at stats.ox.ac.uk>:

> You keep on sending similar messages -- this is at least the third.  You 
> need to find out where the segfault is occurring using gdb, and you have 
> not told us.

Sorry for the repeated post (in 2 different mailing lists).
Tnx for your suggestion. Now I think I've found the problem. Try this:
////file foo.c
#include <R.h>
int **box;
void foo(){
  int i;
  box =   (int**)R_alloc(1,   sizeof(int *));
}
/////////////
Compiled with R CMD SHLIB foo.c
In R:
>dyn.load("foo.so")
>.C("foo")
*Segmentation fault*
The problem disappears when the declaration of 'box' comes inside the function
foo... Is this a bug?

Antonio, Fabio Di Narzo.


From rpeng at jhsph.edu  Mon Jun 13 12:45:31 2005
From: rpeng at jhsph.edu (Roger D. Peng)
Date: Mon, 13 Jun 2005 06:45:31 -0400
Subject: [Rd] Citation for R
In-Reply-To: <2014.220.238.186.9.1118623060.squirrel@homebase.wehi.edu.au>
References: <2014.220.238.186.9.1118623060.squirrel@homebase.wehi.edu.au>
Message-ID: <42AD63CB.6010009@jhsph.edu>

It's not clear to me why a journal publication is necessary
(although I guess it couldn't hurt).  What do you cite when you
use SAS?  Or Stata?

-roger

Gordon K Smyth wrote:
> This is just a note that R would get a lot more citations if
> the recommended citation was an article in a recognised
> journal or from a recognised publisher.
> 
> I use R in work leading to publications often, and I strongly
> want to give the R core team credit for their work.  However I
> find that I can't persuade my biological collaborators to
> include the current R citation (below) in their reference
> lists, because it is not an article in a recognised journal
> nor from a recognised publisher.  I can cite the 1996 paper by
> Ihaka and Gentleman, and sometimes this what I do, but I'd
> really like to give credit to the other R core members as
> well, for example the CRAN people and those involved in the
> Windows version.
> 
> I know this is more work for the R team, like everything else,
> but an article on the story of R since the creation of the
> core team would be really nice to see.
> 
> 
>> citation()
> 
> 
> To cite R in publications use:
> 
> R Development Core Team (2005). R: A language and environment
> for statistical computing. R Foundation for Statistical
> Computing, Vienna, Austria. ISBN 3-900051-07-0, URL
> http://www.R-project.org.
> 
> 
> Gordon
> 
> ______________________________________________ 
> R-devel at r-project.org mailing list 
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From Soren.Hojsgaard at agrsci.dk  Mon Jun 13 12:54:54 2005
From: Soren.Hojsgaard at agrsci.dk (=?iso-8859-1?Q?S=F8ren_H=F8jsgaard?=)
Date: Mon, 13 Jun 2005 12:54:54 +0200
Subject: [Rd] Error in load(zfile, envir = envir) : input has been corrupted,
	with LF replaced by CR
Message-ID: <C83C5E3DEEE97E498B74729A33F6EAEC03083C6D@DJFPOST01.djf.agrsci.dk>

I am trying to build a package binary, and get the message below. Can anyone point me to a solution to that problem. 
Thanks in advance
S?ren


  ....
  installing data files
  installing man source files
  installing indices
Error in load(zfile, envir = envir) : input has been corrupted, with LF replaced
 by CR
Execution halted
make[2]: *** [indices] Error 1
make[1]: *** [all] Error 2



============================================================================================= 
S?ren H?jsgaard,  MSc, PhD (Statistics),                Phone: +45 8999 1703 
Head of Statistics and Decision Theory Research Group,  Fax:   +45 8999 1300 
Danish Institute of Agricultural Sciences               sorenh at agrsci.dk 
Research Centre Foulum, DK-8830 Tjele, Denmark          http://genetics.agrsci.dk/~sorenh 
.... Time flies like an arrow, fruit flies like a banana ....


From ripley at stats.ox.ac.uk  Mon Jun 13 13:29:54 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Mon, 13 Jun 2005 12:29:54 +0100 (BST)
Subject: [Rd] Error in load(zfile,
 envir = envir) : input has been corrupted, with LF replaced by CR
In-Reply-To: <C83C5E3DEEE97E498B74729A33F6EAEC03083C6D@DJFPOST01.djf.agrsci.dk>
References: <C83C5E3DEEE97E498B74729A33F6EAEC03083C6D@DJFPOST01.djf.agrsci.dk>
Message-ID: <Pine.LNX.4.61.0506131224390.25509@gannet.stats>

On Mon, 13 Jun 2005, S?ren H?jsgaard wrote:

> I am trying to build a package binary, and get the message below. Can 
> anyone point me to a solution to that problem.

As it says, a save file has been corrupted, probably one of your data 
files with extension .rda.  Try loading them yourself to see.

If that's not it, you have forgotten basic information like your R version 
and OS so we would need to know a lot more to help.

>  ....
>  installing data files
>  installing man source files
>  installing indices
> Error in load(zfile, envir = envir) : input has been corrupted, with LF replaced
> by CR
> Execution halted
> make[2]: *** [indices] Error 1
> make[1]: *** [all] Error 2
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From ripley at stats.ox.ac.uk  Mon Jun 13 15:01:05 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Mon, 13 Jun 2005 14:01:05 +0100 (BST)
Subject: [Rd] Possible solution to missing title bars etc on X11 windows
Message-ID: <Pine.LNX.4.61.0506131356200.32341@gannet.stats>

There have been various reports of missing title bars, buttons etc from 
X11() windows under certain window managers.  I've never seen this, but 
Ei-j Nakama encountered it and has supplied a patch which changes the way 
hinting is done.

I've put this into R-devel, and would be grateful to know if it solves the 
problem for those who do see this.

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From plummer at iarc.fr  Mon Jun 13 15:09:55 2005
From: plummer at iarc.fr (Martyn Plummer)
Date: Mon, 13 Jun 2005 15:09:55 +0200
Subject: [Rd] memory allocation problem under linux
In-Reply-To: <1118657534.42ad5bfecb192@posta.studio.unibo.it>
References: <1118652187.42ad471bd917f@posta.studio.unibo.it>
	<Pine.LNX.4.61.0506130947360.23218@gannet.stats>
	<1118657534.42ad5bfecb192@posta.studio.unibo.it>
Message-ID: <1118668195.4032.9.camel@seurat>

On Mon, 2005-06-13 at 12:12 +0200, antonio.dinarzo at studio.unibo.it
wrote:
> Scrive Prof Brian Ripley <ripley at stats.ox.ac.uk>:
> 
> > You keep on sending similar messages -- this is at least the third.  You 
> > need to find out where the segfault is occurring using gdb, and you have 
> > not told us.
> 
> Sorry for the repeated post (in 2 different mailing lists).
> Tnx for your suggestion. Now I think I've found the problem. Try this:
> ////file foo.c
> #include <R.h>
> int **box;
> void foo(){
>   int i;
>   box =   (int**)R_alloc(1,   sizeof(int *));
> }
> /////////////
> Compiled with R CMD SHLIB foo.c
> In R:
> >dyn.load("foo.so")
> >.C("foo")
> *Segmentation fault*
> The problem disappears when the declaration of 'box' comes inside the function
> foo... Is this a bug?

It gives you a hint about what the problem is. Your global variable
"box" is conflicting with another symbol.  I tracked this down to the
ncurses library, to which R is linked under Linux, but not Windows. 

[martyn at seurat ~]$ nm /usr/lib/libncurses.so | grep box -
07a6d036 T box

This explains why your problem is platform-specific.  You should declare
"box" to be static.

M.


From kanglin at gmail.com  Mon Jun 13 16:16:43 2005
From: kanglin at gmail.com (D0c)
Date: Mon, 13 Jun 2005 09:16:43 -0500
Subject: [Rd] Fwd:  Using Rserve
In-Reply-To: <2667b2130506111104482232ea@mail.gmail.com>
References: <2667b21305061109571335ef88@mail.gmail.com>
	<B04A8BD9-1D92-4AFB-940D-8329A757A096@r-project.org>
	<2667b2130506111104482232ea@mail.gmail.com>
Message-ID: <2667b213050613071667e1985d@mail.gmail.com>

---------- Forwarded message ----------
From: D0c <kanglin at gmail.com>
Date: Jun 11, 2005 1:04 PM
Subject: Re: [Rd] Using Rserve
To: Simon Urbanek <simon.urbanek at r-project.org>


Hey Simon, I wish i had a choice of platform,... but i don't. Yes i'd
like to know when Rserve is ready, send me some code.


On 6/11/05, Simon Urbanek <simon.urbanek at r-project.org> wrote:
> Hi D0c,
>
> On Jun 11, 2005, at 12:57 PM, D0c wrote:
>
> > Hey is there a more consistent way of  connecting to Rserve. I have
> > code that opens a connection to Rserve by executing explicitly
> > using Java runtime ( "C:\Program Files\R\r20XXX\Rserve.exe" ).
>
> In principle this is ok, but you need to make sure you read the
> output stream of that process. (BTW: this is also probably the
> easiest way to find out when Rserve is ready and preventing timeout
> error). If you need help with that, let me know and I dig out a class
> I have around somewhere which does percisely that.
>
> > However when i run the app and attempt to connect, it does not
> > connect imediately.I have to close the app and open it again for a
> > few times before i get a connection.
> > Am i doing something wrong?
>
> The other thing you're doing wrong is that you're using Windows ;) j/k
>
> Cheers,
> Simon
>
>


From tlumley at u.washington.edu  Mon Jun 13 16:49:56 2005
From: tlumley at u.washington.edu (Thomas Lumley)
Date: Mon, 13 Jun 2005 07:49:56 -0700 (PDT)
Subject: [Rd] Citation for R
In-Reply-To: <2014.220.238.186.9.1118623060.squirrel@homebase.wehi.edu.au>
References: <2014.220.238.186.9.1118623060.squirrel@homebase.wehi.edu.au>
Message-ID: <Pine.A41.4.61b.0506130739470.79102@homer03.u.washington.edu>

On Mon, 13 Jun 2005, Gordon K Smyth wrote:

> This is just a note that R would get a lot more citations if the 
> recommended citation was an article in a recognised journal or from a 
> recognised publisher.
>

This is unfortunately true, but R is *not* an article or a book, it is a 
piece of software.  I don't think I'm the only person who thinks it is 
counterproductive in the long run to encourage users to cite an article 
that they probably haven't read instead of citing the software they 
actually used.

Jan's suggestion of the Journal of Statistical Software might provide a 
solution, since JSS *does* publish software.

 	-thomas


From Ted.Harding at nessie.mcc.ac.uk  Mon Jun 13 17:30:48 2005
From: Ted.Harding at nessie.mcc.ac.uk ( (Ted Harding))
Date: Mon, 13 Jun 2005 16:30:48 +0100 (BST)
Subject: [Rd] Citation for R
In-Reply-To: <Pine.A41.4.61b.0506130739470.79102@homer03.u.washington.edu>
Message-ID: <XFMail.050613163048.Ted.Harding@nessie.mcc.ac.uk>

On 13-Jun-05 Thomas Lumley wrote:
> On Mon, 13 Jun 2005, Gordon K Smyth wrote:
> 
>> This is just a note that R would get a lot more citations if the 
>> recommended citation was an article in a recognised journal or from a 
>> recognised publisher.
>>
> 
> This is unfortunately true, but R is *not* an article or a book, it is
> a 
> piece of software.  I don't think I'm the only person who thinks it is 
> counterproductive in the long run to encourage users to cite an article
> that they probably haven't read instead of citing the software they 
> actually used.
> 
> Jan's suggestion of the Journal of Statistical Software might provide a
> solution, since JSS *does* publish software.
> 
>       -thomas

Is a journal reference necessary? I have seen many articles where
the statistical software (S-Plus, SPSS, SAS, etc.) was "cited" as
the User Manual, usually only available from the supplier of the
software, sometimes with a WWW URL. Such cases provide a precedent
for R, surely. I have also seen cases where the "citation" was
simply the name of the company (with location, version, date etc.)

As an example which, as software, is closer to home, consider the
following quotation, and the corresponding citation:

Quotation:
  "This is essentially a four-level hierarchical model and
   is easily implemented in, say, WinBUGS (Spiegelhalter,
   Thomas and Best, 2000)." [p. 13 of Source reference below]

Citation Reference:
  Spiegelhalter, D. J., Thomas, A. and Best, N. G. (2000)
    WinBUGS Version 1.3 User Manual. Cambridge: Medical Research
    Council Biostatistics Unit.
    (Available from www.mrc-bsu.cam.ac.uk/bugs.)

Source:
  David J. Spiegelhalter, Paul Aylin, Nicola G. Best,
  Stephen J. W. Evans, Gordon D. Murray (2002).
    Commissioned analysis of surgical performance by using
    routine data: lessons from the Bristol inquiry.
  J. R. Statist. Soc. A (2002) 165, Part 2, pp. 1-31)

Surely this would do? Does R need more justification than
WinBUGS? Are JRSS citations less canonical then other journals?

Best wishes to all,
Ted.


--------------------------------------------------------------------
E-Mail: (Ted Harding) <Ted.Harding at nessie.mcc.ac.uk>
Fax-to-email: +44 (0)870 094 0861
Date: 13-Jun-05                                       Time: 16:30:35
------------------------------ XFMail ------------------------------


From tlumley at u.washington.edu  Mon Jun 13 22:51:39 2005
From: tlumley at u.washington.edu (Thomas Lumley)
Date: Mon, 13 Jun 2005 13:51:39 -0700 (PDT)
Subject: [Rd] (no subject)
Message-ID: <Pine.A41.4.61b.0506131350300.16708@homer12.u.washington.edu>


Online registration for DSC 2005 in Seattle, August 13-14 is now open. See 
the conference web page at
http://depts.washington.edu//dsc2005/

 	-thomas

Thomas Lumley			Assoc. Professor, Biostatistics
tlumley at u.washington.edu	University of Washington, Seattle


From smyth at wehi.EDU.AU  Tue Jun 14 00:14:13 2005
From: smyth at wehi.EDU.AU (Gordon K Smyth)
Date: Tue, 14 Jun 2005 08:14:13 +1000 (EST)
Subject: [Rd] Citation for R
In-Reply-To: <XFMail.050613163048.Ted.Harding@nessie.mcc.ac.uk>
References: <Pine.A41.4.61b.0506130739470.79102@homer03.u.washington.edu>
	<XFMail.050613163048.Ted.Harding@nessie.mcc.ac.uk>
Message-ID: <2976.220.238.186.9.1118700853.squirrel@homebase.wehi.edu.au>

On Tue, June 14, 2005 1:30 am, Ted Harding said:
> Is a journal reference necessary? I have seen many articles where
> the statistical software (S-Plus, SPSS, SAS, etc.) was "cited" as
> the User Manual, usually only available from the supplier of the
> software, sometimes with a WWW URL. Such cases provide a precedent
> for R, surely. I have also seen cases where the "citation" was
> simply the name of the company (with location, version, date etc.)
>
> As an example which, as software, is closer to home, consider the
> following quotation, and the corresponding citation:
>
> Quotation:
>   "This is essentially a four-level hierarchical model and
>    is easily implemented in, say, WinBUGS (Spiegelhalter,
>    Thomas and Best, 2000)." [p. 13 of Source reference below]
>
> Citation Reference:
>   Spiegelhalter, D. J., Thomas, A. and Best, N. G. (2000)
>     WinBUGS Version 1.3 User Manual. Cambridge: Medical Research
>     Council Biostatistics Unit.
>     (Available from www.mrc-bsu.cam.ac.uk/bugs.)
>
> Source:
>   David J. Spiegelhalter, Paul Aylin, Nicola G. Best,
>   Stephen J. W. Evans, Gordon D. Murray (2002).
>     Commissioned analysis of surgical performance by using
>     routine data: lessons from the Bristol inquiry.
>   J. R. Statist. Soc. A (2002) 165, Part 2, pp. 1-31)
>
> Surely this would do? Does R need more justification than
> WinBUGS? Are JRSS citations less canonical then other journals?

Yes, JRSSB citations are less canonical that citations in medical biology journals.  Citations are
treated very seriously in medical biology world, where impact factors and citations counts are
quoted in promotion and grant applications, and there is a reluctance to cite non-refereed
publications.  An article in Nature would probably not include WinBUGS in the reference list but
would simply say in the text that computations were done using "WinBUGS software (Medical Research
Council Biostatistics Unit, Cambridge, www.mrc-bsu.cam.ac.uk/bugs)".  This might be good enough
for the WinBUGS people, but it would not get the WinBUGS manual into the citation system.

Note also that R does have a User Guide, i.e., while there is plenty of excellent documentation,
there is no single document which is a guide to the whole project.

Gordon

> Best wishes to all,
> Ted.
>
>
> --------------------------------------------------------------------
> E-Mail: (Ted Harding) <Ted.Harding at nessie.mcc.ac.uk>
> Fax-to-email: +44 (0)870 094 0861
> Date: 13-Jun-05                                       Time: 16:30:35
> ------------------------------ XFMail ------------------------------


From smyth at wehi.EDU.AU  Tue Jun 14 00:42:59 2005
From: smyth at wehi.EDU.AU (Gordon K Smyth)
Date: Tue, 14 Jun 2005 08:42:59 +1000 (EST)
Subject: [Rd] Citation for R
In-Reply-To: <Pine.A41.4.61b.0506130739470.79102@homer03.u.washington.edu>
References: <2014.220.238.186.9.1118623060.squirrel@homebase.wehi.edu.au>
	<Pine.A41.4.61b.0506130739470.79102@homer03.u.washington.edu>
Message-ID: <3351.220.238.186.9.1118702579.squirrel@homebase.wehi.edu.au>

On Tue, June 14, 2005 12:49 am, Thomas Lumley said:
> On Mon, 13 Jun 2005, Gordon K Smyth wrote:
>
>> This is just a note that R would get a lot more citations if the
>> recommended citation was an article in a recognised journal or from a
>> recognised publisher.
>>
>
> This is unfortunately true, but R is *not* an article or a book, it is a
> piece of software.  I don't think I'm the only person who thinks it is
> counterproductive in the long run to encourage users to cite an article
> that they probably haven't read instead of citing the software they
> actually used.
>
> Jan's suggestion of the Journal of Statistical Software might provide a
> solution, since JSS *does* publish software.
>
>  	-thomas

In the biology world, it is common to publish an article announcing a software project, and to
cite that.  The referees of the article are expected to try out and comment on the software.  This
gives the authors credit, and ensures that both the article and the software have been peer
refereed, at least to a limited extent.

If the issue of formal citation doesn't worry the R core team, I won't worry about it either.  I'm
currently revising an article going to Nature which will simply say in the text that quantities
"were calculated using R statistical software (http://www.r-project.org)".

Gordon


From tlumley at u.washington.edu  Tue Jun 14 01:15:10 2005
From: tlumley at u.washington.edu (Thomas Lumley)
Date: Mon, 13 Jun 2005 16:15:10 -0700 (PDT)
Subject: [Rd] DSC 2005
In-Reply-To: <Pine.A41.4.61b.0506131350300.16708@homer12.u.washington.edu>
Message-ID: <Pine.LNX.4.43.0506131615100.15864@hymn04.u.washington.edu>


Persons conversant with W3C standards would have noticed too many // in the URL quoted in my previous message.  The correct conference page URL is

   http://depts.washington.edu/dsc2005

       -thomas

On Mon, 13 Jun 2005, Thomas Lumley wrote:

>
> Online registration for DSC 2005 in Seattle, August 13-14 is now open. See
> the conference web page at
> http://depts.washington.edu//dsc2005/
>

Thomas Lumley			Assoc. Professor, Biostatistics
tlumley at u.washington.edu	University of Washington, Seattle


From smyth at wehi.edu.au  Tue Jun 14 02:38:38 2005
From: smyth at wehi.edu.au (Gordon Smyth)
Date: Tue, 14 Jun 2005 10:38:38 +1000
Subject: [Rd] Citation for R
Message-ID: <6.2.1.2.1.20050614101736.02141e38@imaphost.wehi.edu.au>


>Note also that R does have a User Guide, i.e., while there is plenty of 
>excellent documentation,
>there is no single document which is a guide to the whole project.

Oops, I meant to write "R does not have a User Guide".

Just to explain this further, the citation() function asks me to cite a 
"Manual" with the title "R: A language and environment for statistical 
computing". Although R comes with excellent documentation, including at 
least 6 manuals on different aspects of the software, no manual or document 
with that title actually exists, as far as I know.

Gordon


From Achim.Zeileis at wu-wien.ac.at  Tue Jun 14 08:08:32 2005
From: Achim.Zeileis at wu-wien.ac.at (Achim Zeileis)
Date: Tue, 14 Jun 2005 08:08:32 +0200
Subject: [Rd] Citation for R
In-Reply-To: <6.2.1.2.1.20050614101736.02141e38@imaphost.wehi.edu.au>
References: <6.2.1.2.1.20050614101736.02141e38@imaphost.wehi.edu.au>
Message-ID: <20050614080832.777aa917.Achim.Zeileis@wu-wien.ac.at>

On Tue, 14 Jun 2005 10:38:38 +1000 Gordon Smyth wrote:

> >Note also that R does have a User Guide, i.e., while there is plenty
> >of excellent documentation,
> >there is no single document which is a guide to the whole project.
> 
> Oops, I meant to write "R does not have a User Guide".
> 
> Just to explain this further, the citation() function asks me to cite
> a "Manual"

Well, @Manual indicates just the type of BibTeX entry which is the
closest thing you have in BibTeX as there is not @Software or something
similar.

> with the title "R: A language and environment for statistical 
> computing". Although R comes with excellent documentation, including
> at least 6 manuals on different aspects of the software, no manual or
> document with that title actually exists, as far as I know.

The idea is that you can cite the software as a whole which also has an
ISBN number which makes it good enough for many publishers to accept it
(and btw has also led to some faxes ordering the `book' "R: A Language
and..." in Vienna). Anyway, if it is possible to cite the software
directly, you don't want to have some surrogate paper which documents
part of the software, a much earlier version, or...
When it is not possible to cite software directly, it should be -
although I understand that this is not just as simple as saying it.
Z


From ligges at statistik.uni-dortmund.de  Tue Jun 14 08:52:38 2005
From: ligges at statistik.uni-dortmund.de (Uwe Ligges)
Date: Tue, 14 Jun 2005 08:52:38 +0200
Subject: [Rd] Citation for R
In-Reply-To: <6.2.1.2.1.20050614101736.02141e38@imaphost.wehi.edu.au>
References: <6.2.1.2.1.20050614101736.02141e38@imaphost.wehi.edu.au>
Message-ID: <42AE7EB6.5000001@statistik.uni-dortmund.de>

Gordon Smyth wrote:

>>Note also that R does have a User Guide, i.e., while there is plenty of 
>>excellent documentation,
>>there is no single document which is a guide to the whole project.
> 
> 
> Oops, I meant to write "R does not have a User Guide".
> 
> Just to explain this further, the citation() function asks me to cite a 
> "Manual" with the title "R: A language and environment for statistical 
> computing". Although R comes with excellent documentation, including at 
> least 6 manuals on different aspects of the software, no manual or document 
> with that title actually exists, as far as I know.

It does: Some poeople might refer to the same manual with "R Reference 
index", but this is actually the one you cited above.

BTW: In both of my last two reviews for medical journals I criticized 
(not only) the missing citation of software ... (obviously political 
incorrectly, but I'll do so further on ;-))

Uwe Ligges


> Gordon
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From Friedrich.Leisch at tuwien.ac.at  Tue Jun 14 09:10:35 2005
From: Friedrich.Leisch at tuwien.ac.at (Friedrich.Leisch@tuwien.ac.at)
Date: Tue, 14 Jun 2005 09:10:35 +0200
Subject: [Rd] Citation for R
In-Reply-To: <6.2.1.2.1.20050614101736.02141e38@imaphost.wehi.edu.au>
References: <6.2.1.2.1.20050614101736.02141e38@imaphost.wehi.edu.au>
Message-ID: <17070.33515.194124.491028@galadriel.ci.tuwien.ac.at>

>>>>> On Tue, 14 Jun 2005 10:38:38 +1000,
>>>>> Gordon Smyth (GS) wrote:

  >> Note also that R does have a User Guide, i.e., while there is plenty of 
  >> excellent documentation,
  >> there is no single document which is a guide to the whole project.

  > Oops, I meant to write "R does not have a User Guide".

  > Just to explain this further, the citation() function asks me to cite a 
  > "Manual" with the title "R: A language and environment for statistical 
  > computing". Although R comes with excellent documentation, including at 
  > least 6 manuals on different aspects of the software, no manual or document 
  > with that title actually exists, as far as I know.

The Reference Index (all help Pages in one PDF document) has that name
("Reference Index" is actually the subtitle), and you can download it
from

	http://cran.r-project.org/manuals.html

(it's the 12MB guy at the end of the list of manuals). The ISBN rules
make it possible to cover both a software package and it's
corresponding reference manual by one single ISBN number if they are
bundled tightly and that's what we did for R. So as far as citations
go this should be as good a reference as any printed book. ISBN does not
require the item to be available for sale in printed form, electronic
publication is sufficient, see

	http://www.isbn-international.org/en/userman/chapter6.html

The only open question is how many ISBN number we need exactly for R
(every patch release, every minor release etc.). I had a short
discussion with the Austrian ISBN representative and he recommended
for a fast-changing work like R to consider it like a database or
encyclopedia (which is true for the help pages anyway), and be rather
pragmatic. Hence we assigned a new ISBN to version 2.0.0 and will do so
again for 3.0.0.

Best,

-- 
-------------------------------------------------------------------
                        Friedrich Leisch 
Institut f?r Statistik                     Tel: (+43 1) 58801 10715
Technische Universit?t Wien                Fax: (+43 1) 58801 10798
Wiedner Hauptstra?e 8-10/1071
A-1040 Wien, Austria             http://www.ci.tuwien.ac.at/~leisch


From Friedrich.Leisch at tuwien.ac.at  Tue Jun 14 09:22:34 2005
From: Friedrich.Leisch at tuwien.ac.at (Friedrich.Leisch@tuwien.ac.at)
Date: Tue, 14 Jun 2005 09:22:34 +0200
Subject: [Rd] Citation for R
In-Reply-To: <3351.220.238.186.9.1118702579.squirrel@homebase.wehi.edu.au>
References: <2014.220.238.186.9.1118623060.squirrel@homebase.wehi.edu.au>
	<Pine.A41.4.61b.0506130739470.79102@homer03.u.washington.edu>
	<3351.220.238.186.9.1118702579.squirrel@homebase.wehi.edu.au>
Message-ID: <17070.34234.505197.726121@galadriel.ci.tuwien.ac.at>

>>>>> On Tue, 14 Jun 2005 08:42:59 +1000 (EST),
>>>>> Gordon K Smyth (GKS) wrote:

  > On Tue, June 14, 2005 12:49 am, Thomas Lumley said:
  >> On Mon, 13 Jun 2005, Gordon K Smyth wrote:
  >> 
  >>> This is just a note that R would get a lot more citations if the
  >>> recommended citation was an article in a recognised journal or from a
  >>> recognised publisher.
  >>> 
  >> 
  >> This is unfortunately true, but R is *not* an article or a book, it is a
  >> piece of software.  I don't think I'm the only person who thinks it is
  >> counterproductive in the long run to encourage users to cite an article
  >> that they probably haven't read instead of citing the software they
  >> actually used.
  >> 
  >> Jan's suggestion of the Journal of Statistical Software might provide a
  >> solution, since JSS *does* publish software.
  >> 
  >> -thomas

  > In the biology world, it is common to publish an article
  > announcing a software project, and to cite that.  The referees of
  > the article are expected to try out and comment on the software.
  > This gives the authors credit, and ensures that both the article
  > and the software have been peer refereed, at least to a limited
  > extent.

How do you cite books in this world, or to but the question in another
way: How do you make sure a book is peer-reviewd? After all it is
quite easy to become a "publisher" and publish ones own books. Many
university departments I know are registered ISBN publishers
(including our department).  Must be hard to distinguish "real" books
from others, I guess.

Fritz


From imosqueira at suk.azti.es  Tue Jun 14 09:23:40 2005
From: imosqueira at suk.azti.es (Iago Mosqueira)
Date: Tue, 14 Jun 2005 09:23:40 +0200
Subject: [Rd] operators as S4 methods
Message-ID: <1118733820.21400.100.camel@patudo.azti.local>

Dear all,

I need to re-define some mathematical operators (+, *, /, etc) for an S4
class based on array. All references I have found (S Programming, Green
Book) show how to define S3 methods for this (like in page 89 of S
Programming for "-.polynomial"). What is the preferred S4 way for doing
this? I hope I haven't missed some obvious piece of documentation.

Many thanks,

 
Iago Mosqueira


From blindglobe at gmail.com  Tue Jun 14 10:06:02 2005
From: blindglobe at gmail.com (A.J. Rossini)
Date: Tue, 14 Jun 2005 10:06:02 +0200
Subject: [Rd] Citation for R
In-Reply-To: <17070.34234.505197.726121@galadriel.ci.tuwien.ac.at>
References: <2014.220.238.186.9.1118623060.squirrel@homebase.wehi.edu.au>
	<Pine.A41.4.61b.0506130739470.79102@homer03.u.washington.edu>
	<3351.220.238.186.9.1118702579.squirrel@homebase.wehi.edu.au>
	<17070.34234.505197.726121@galadriel.ci.tuwien.ac.at>
Message-ID: <1abe3fa905061401066530e563@mail.gmail.com>

On 6/14/05, Friedrich.Leisch at tuwien.ac.at <Friedrich.Leisch at tuwien.ac.at> wrote:
> >>>>> On Tue, 14 Jun 2005 08:42:59 +1000 (EST),
> >>>>> Gordon K Smyth (GKS) wrote:
> 
>  > On Tue, June 14, 2005 12:49 am, Thomas Lumley said:
>  >> On Mon, 13 Jun 2005, Gordon K Smyth wrote:
>  >>
>  >>> This is just a note that R would get a lot more citations if the
>  >>> recommended citation was an article in a recognised journal or from a
>  >>> recognised publisher.
>  >>>
>  >>
>  >> This is unfortunately true, but R is *not* an article or a book, it is a
>  >> piece of software.  I don't think I'm the only person who thinks it is
>  >> counterproductive in the long run to encourage users to cite an article
>  >> that they probably haven't read instead of citing the software they
>  >> actually used.
>  >>
>  >> Jan's suggestion of the Journal of Statistical Software might provide a
>  >> solution, since JSS *does* publish software.
>  >>
>  >> -thomas
> 
>  > In the biology world, it is common to publish an article
>  > announcing a software project, and to cite that.  The referees of
>  > the article are expected to try out and comment on the software.
>  > This gives the authors credit, and ensures that both the article
>  > and the software have been peer refereed, at least to a limited
>  > extent.
> 
> How do you cite books in this world, or to but the question in another
> way: How do you make sure a book is peer-reviewd? After all it is
> quite easy to become a "publisher" and publish ones own books. Many
> university departments I know are registered ISBN publishers
> (including our department).  Must be hard to distinguish "real" books
> from others, I guess.

Fritz - 

That's silly.  As someone pointed out, the issue is with the
publisher, not the citation.  If R-Core were a generally well-known
and regarded publishing house such as Springer or Microsoft, it would
not be a problem.  But it's still a nebulous entity to MANY people,
and so many people fail to understand this open source stuff.  It's
seriously discouraged by most journals to cite technical reports, for
example.  And perhaps, R could be considered more of a long-ish
technical report than a book?   Though perhaps Peter D. could be
considered the "editor"?  (these questions are not those that I need
to ask, obviously!)

(just yesterday, I was asked by a reasonably intelligent colleague,
with respect to corporate packaging of R: "So they (corporate
packagers) just pick some version and package it, right?"  and my
flabbergasted response was:

"and so, what the heck do you think they (corporate packagers) do with
SAS, S-PLUS, and SPSS, and why do you think it's different...?").

best,
-tony

"Commit early,commit often, and commit in a repository from which we can easily
roll-back your mistakes" (AJR, 4Jan05).

A.J. Rossini
blindglobe at gmail.com


From maechler at stat.math.ethz.ch  Tue Jun 14 10:13:26 2005
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Tue, 14 Jun 2005 10:13:26 +0200
Subject: [Rd] operators as S4 methods
In-Reply-To: <1118733820.21400.100.camel@patudo.azti.local>
References: <1118733820.21400.100.camel@patudo.azti.local>
Message-ID: <17070.37286.869107.835135@stat.math.ethz.ch>

For arithmetic operators,
the most elegant way often is to define so called `group methods'
for the whole group of arithmetic operators.

This actually applies also applies to the old classes and
methods.

One example where we do this is the 'Matrix' package,
see the source, e.g., in 
https://svn.r-project.org/R-packages/Matrix/R/dMatrix.R
	
Note that for a namespaced package, on also needs to import the
group generics from the 'methods' package in NAMESPACE:

## Currently, group generics need to be explicitly imported:
importFrom("methods", Arith, Compare, Math, Math2, Summary, Complex)


Martin Maechler, ETH Zurich


>>>>> "Iago" == Iago Mosqueira <imosqueira at suk.azti.es>
>>>>>     on Tue, 14 Jun 2005 09:23:40 +0200 writes:

    Iago> Dear all,
    Iago> I need to re-define some mathematical operators (+, *, /, etc) for an S4
    Iago> class based on array. All references I have found (S Programming, Green
    Iago> Book) show how to define S3 methods for this (like in page 89 of S
    Iago> Programming for "-.polynomial"). What is the preferred S4 way for doing
    Iago> this? I hope I haven't missed some obvious piece of documentation.

    Iago> Many thanks,

 
    Iago> Iago Mosqueira

    Iago> ______________________________________________
    Iago> R-devel at r-project.org mailing list
    Iago> https://stat.ethz.ch/mailman/listinfo/r-devel


From smyth at wehi.edu.au  Tue Jun 14 11:40:36 2005
From: smyth at wehi.edu.au (Gordon Smyth)
Date: Tue, 14 Jun 2005 19:40:36 +1000
Subject: [Rd] Citation for R
In-Reply-To: <17070.34234.505197.726121@galadriel.ci.tuwien.ac.at>
References: <2014.220.238.186.9.1118623060.squirrel@homebase.wehi.edu.au>
	<Pine.A41.4.61b.0506130739470.79102@homer03.u.washington.edu>
	<3351.220.238.186.9.1118702579.squirrel@homebase.wehi.edu.au>
	<17070.34234.505197.726121@galadriel.ci.tuwien.ac.at>
Message-ID: <6.2.1.2.1.20050614184122.021f5e00@imaphost.wehi.edu.au>

At 05:22 PM 14/06/2005, Friedrich.Leisch at tuwien.ac.at wrote:
> >>>>> On Tue, 14 Jun 2005 08:42:59 +1000 (EST),
> >>>>> Gordon K Smyth (GKS) wrote:
>
>   > On Tue, June 14, 2005 12:49 am, Thomas Lumley said:
>   >> On Mon, 13 Jun 2005, Gordon K Smyth wrote:
>   >>
>   >>> This is just a note that R would get a lot more citations if the
>   >>> recommended citation was an article in a recognised journal or from a
>   >>> recognised publisher.
>   >>>
>   >>
>   >> This is unfortunately true, but R is *not* an article or a book, it is a
>   >> piece of software.  I don't think I'm the only person who thinks it is
>   >> counterproductive in the long run to encourage users to cite an article
>   >> that they probably haven't read instead of citing the software they
>   >> actually used.
>   >>
>   >> Jan's suggestion of the Journal of Statistical Software might provide a
>   >> solution, since JSS *does* publish software.
>   >>
>   >> -thomas
>
>   > In the biology world, it is common to publish an article
>   > announcing a software project, and to cite that.  The referees of
>   > the article are expected to try out and comment on the software.
>   > This gives the authors credit, and ensures that both the article
>   > and the software have been peer refereed, at least to a limited
>   > extent.
>
>How do you cite books in this world, or to but the question in another
>way: How do you make sure a book is peer-reviewd? After all it is
>quite easy to become a "publisher" and publish ones own books. Many
>university departments I know are registered ISBN publishers
>(including our department).  Must be hard to distinguish "real" books
>from others, I guess.
>
>Fritz

Books are cited as in the statistics literature but, naturally, there is a 
tendency to prefer references from more reputable sources. Hence a Wiley & 
Son book would be prefered, other things being equal, to a book from a 
minor university press, which is turn would be prefered to a self-published 
book. Self-published electronic books are pretty much at the bottom of the 
pile. This doesn't mean that important references of this form can't be 
cited, but it doesn mean that one is pushing uphill.

Self-published software manuals are usually cited in-text, as are many 
other tools and technologies mentioned in the methods section, rather than 
in the references.

Thanks for pointing out, in a separate posting, that citation() refers to 
the "R Reference Manual".

Gordon


From Ted.Harding at nessie.mcc.ac.uk  Tue Jun 14 11:45:48 2005
From: Ted.Harding at nessie.mcc.ac.uk ( (Ted Harding))
Date: Tue, 14 Jun 2005 10:45:48 +0100 (BST)
Subject: [Rd] Citation for R
In-Reply-To: <1abe3fa905061401066530e563@mail.gmail.com>
Message-ID: <XFMail.050614104548.Ted.Harding@nessie.mcc.ac.uk>

On 14-Jun-05 A.J. Rossini wrote:
> Fritz - 
> 
> That's silly.  As someone pointed out, the issue is with the
> publisher, not the citation.  If R-Core were a generally well-known
> and regarded publishing house such as Springer or Microsoft, it would
> not be a problem.  But it's still a nebulous entity to MANY people,
> and so many people fail to understand this open source stuff.  It's
> seriously discouraged by most journals to cite technical reports, for
> example.  And perhaps, R could be considered more of a long-ish
> technical report than a book?   Though perhaps Peter D. could be
> considered the "editor"?  (these questions are not those that I need
> to ask, obviously!)
> 
> (just yesterday, I was asked by a reasonably intelligent colleague,
> with respect to corporate packaging of R: "So they (corporate
> packagers) just pick some version and package it, right?"  and my
> flabbergasted response was:
> 
> "and so, what the heck do you think they (corporate packagers) do with
> SAS, S-PLUS, and SPSS, and why do you think it's different...?").
> 
> best,
> -tony

Tony is getting admirably and justifiably tetchy! His comment
about the packaging of SAS, S-PLUS and SPSS is delightfully
to the point (and, had I been there at the time, I'd have
bought him a beverage of his choice in appreciation).

And, to extend his comment, where for instance does that leave
WinBUGS (see my previous mail)? Granted, perhaps, that in the
citation


  Spiegelhalter, D. J., Thomas, A. and Best, N. G. (2000)
    WinBUGS Version 1.3 User Manual. Cambridge: Medical Research
    Council Biostatistics Unit.
    (Available from www.mrc-bsu.cam.ac.uk/bugs.)


one has a prestigious institute (MRC-BSU) as the publisher.
But, basically, it's the same self-justifiying ordinance all
over again: the creators of the software produce their own
User Manual and "publish" it. The publisher of S-PLUS and its
documentation is "Insightful Corporation": beyond their
achievement in developing S-PLUS, whence their prestige?
(Granted, again, if you look inside the books, you can find
famous names listed as contributors; but we at R can claim
many of these same names ... ).

The issue of "peer review" of software citations has been
raised. Where is the peer review of the S-PLUS or SAS or
SPSS User Manual? OK, the thing that needs peer review is
the software itself. In the "Review" section of journals
you can find critical reviews of software. But these are
not referee'd and usually represent the writer's own views;
furthermore, such reviews are not often cited in articles
where the software has been used to obtain the results in
the article. People just use the stuff, and cite the User
Manual or the "corporate packager".

Also, from time to time you come across published referee'd
articles which analyse the performance of software for
particular purposes, or compare different software packages
for a given purpose. These could be viewed as peer review,
but, again, are rarely cited by the simple user.

Moreover, suppose that citing User Manual or corporate packager
is considered to justify the use of the software in an article.
I have seen many articles where such-and-such software was used
(I mention no names) and "cited" in these terms, where it is
known to discerning users that the software does not correctly
address the tasks it claims to work for, or gives incorrect
results. Yet the "citation box" had been duly ticked, and the
article has successfully gone through the editorial process.
This is not peer review either -- and could only come close to
it if the journal editors' panel of referees could be assumed
sufficiently knowledgeable to be discriminating about such things.

But in that case you don't really need a citation: the referee
says "Used [e.g.] S-PLUS, yes, that's fine for this job and
I could reproduce the analysis using that software and trust
the results. Passed." And such a referee could say exactly
the same for R.

The true peer review of software is done by discriminating
users of the software. Peer review of R is done *HERE* (as
well as other places).

[I've had the experience of using R for analysis, only to
have the analysis repeated in S-PLUS purely for the purpose
of citing S-PLUS rather than R for publication ... ]

However, the follow-ups in this thread are departing somewhat
from Gordon Smyth's original wish to pay tribute, in citation,
to the growing team of people who have, over the last 10+ years,
contributed centrally to making R what it is.

Thinking about that question, I can't come up with a better
idea than his: an up-to-date "Ihaka and Gentleman", which
does due honour to the greatly enhanced riches of R, and R's
solidity and quality, at the present time!

But maybe this might take a book ...

Best wishes to all,
Ted.


--------------------------------------------------------------------
E-Mail: (Ted Harding) <Ted.Harding at nessie.mcc.ac.uk>
Fax-to-email: +44 (0)870 094 0861
Date: 14-Jun-05                                       Time: 10:45:39
------------------------------ XFMail ------------------------------


From ggrothendieck at gmail.com  Tue Jun 14 14:08:06 2005
From: ggrothendieck at gmail.com (ggrothendieck@gmail.com)
Date: Tue, 14 Jun 2005 14:08:06 +0200 (CEST)
Subject: [Rd] by should use match.fun (PR#7936)
Message-ID: <20050614120806.67D04EC6D@slim.kubism.ku.dk>

Full_Name: G. Grothendieck
Version: R version 2.1.0, 2005-06-10
OS: Windows XP
Submission from: (NULL) (216.59.226.184)



This is an inconsistency between by and similar functions.  
The 'by' function should have an initial line of:

FUN <- match.fun(FUN)

All other similar functions including apply, sapply,
tapply, lapply work like that so 'by' ought to as well.  

Here is an example using the 'iris' data set.  Suppose we 
wish to create a list of rows:

by(iris, row.names(iris), "(")

In every other similar function "(" would have been interpreted
as the intended function but here we get an error that it cannot
find "(".  Although such an error is not inconsistent with the
documentation it would seem to violate the consistency of the
R base functions mentioned.

There was a discussion of this on r-devel in this thread:

https://www.stat.math.ethz.ch/pipermail/r-devel/2005-June/033583.html


From gilles.guillot at inapg.inra.fr  Tue Jun 14 19:05:24 2005
From: gilles.guillot at inapg.inra.fr (Gilles GUILLOT)
Date: Tue, 14 Jun 2005 19:05:24 +0200
Subject: [Rd] Calling C from Fortran
Message-ID: <200506141905.24517.gilles.guillot@inapg.inra.fr>

I would like to call C routines from Fortran under linux as suggested in 
section 5.6 of 
the "Writing R extensions" documentation.

I'm familiar with Fortran but not with C.
I understand the example provided in Fortran:

subroutine testit()
double precision normrnd, x
call rndstart()
x = normrnd()
call dblepr("X was", 5, x, 1)
call rndend()
end


but I don't understand the purpose of this C wrapper:
#include <R.h>  
 void F77_SUB(rndstart)(void) { GetRNGstate(); }
 void F77_SUB(rndend)(void) { PutRNGstate(); }
 double F77_SUB(normrnd)(void) { return norm_rand(); }

neither how I should compile it.

Could anyone explain how I should compile and link 
the C and Fortran files above, and call the Fortran subroutine from R.

Thanks,

Gilles


From reid_huntsinger at merck.com  Tue Jun 14 19:32:21 2005
From: reid_huntsinger at merck.com (Huntsinger, Reid)
Date: Tue, 14 Jun 2005 13:32:21 -0400
Subject: [Rd] Calling C from Fortran
Message-ID: <D9A95B4B7B20354992E165EEADA31999056A948E@uswpmx00.merck.com>

The C wrappers are there to align the linking conventions expected by the
Fortran compiler (usually subroutine/function foo has its entry point in the
object file indicated by a symbol foo_, but it depends on the platform) to
that of the C compiler. (The C compiler just uses the function name.) The
wrappers give C functions named whatever is appropriate (eg "foo_") to get
an entry point that "call foo" will trigger linking to. 

Calling the Fortran subroutine from R is via .Fortran() after doing a
dyn.load() of the shared object file. Creating the shared object should just
be a matter of R CMD SHLIB file1.c file2.f but I've never tried using
Fortran and C together. Take a look at the magic built in to the R CMD SHLIB
and R CMD COMPILE commands, and at some of the packages that come with R (I
just do a "find" for "*.f" in the src tree) if you need examples, eg.
src/library/stats. 

Reid Huntsinger

-----Original Message-----
From: r-devel-bounces at r-project.org [mailto:r-devel-bounces at r-project.org]
On Behalf Of Gilles GUILLOT
Sent: Tuesday, June 14, 2005 1:05 PM
To: R-devel at stat.math.ethz.ch
Subject: [Rd] Calling C from Fortran


I would like to call C routines from Fortran under linux as suggested in 
section 5.6 of 
the "Writing R extensions" documentation.

I'm familiar with Fortran but not with C.
I understand the example provided in Fortran:

subroutine testit()
double precision normrnd, x
call rndstart()
x = normrnd()
call dblepr("X was", 5, x, 1)
call rndend()
end


but I don't understand the purpose of this C wrapper:
#include <R.h>  
 void F77_SUB(rndstart)(void) { GetRNGstate(); }
 void F77_SUB(rndend)(void) { PutRNGstate(); }
 double F77_SUB(normrnd)(void) { return norm_rand(); }

neither how I should compile it.

Could anyone explain how I should compile and link 
the C and Fortran files above, and call the Fortran subroutine from R.

Thanks,

Gilles

______________________________________________
R-devel at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-devel


From MSchwartz at mn.rr.com  Tue Jun 14 20:28:59 2005
From: MSchwartz at mn.rr.com (Marc Schwartz)
Date: Tue, 14 Jun 2005 13:28:59 -0500
Subject: [Rd] R 2.1.1 slated for June 20
In-Reply-To: <Pine.LNX.4.61.0506101407430.4262@gannet.stats>
References: <x264wmbe6m.fsf@turmalin.kubism.ku.dk>
	<Pine.LNX.4.61.0506101407430.4262@gannet.stats>
Message-ID: <1118773739.3126.4.camel@localhost.localdomain>

On Fri, 2005-06-10 at 14:57 +0100, Prof Brian Ripley wrote:
> On Fri, 10 Jun 2005, Peter Dalgaard wrote:
> 
> > The next version of R will be released (barring force majeure) on June
> > 20th, with beta versions available starting Monday.
> >
> > Please do check them on your system *before* the release this time...
> 
> Some things which it would be particularly helpful to have tested:


> - Bleeding-edge OSes, e.g. anyone running Fedora Core 4 test 3?  (These
>    often show up problems with bugs in the pre-release versions of
>    components such as X11 and compilers.)


Just as a quick heads up, I installed FC4 Release ("Stentz") late
yesterday.

R (Version 2.1.1 beta (2005-06-14)) compiles fine using:

$ gcc --version
gcc (GCC) 4.0.0 20050519 (Red Hat 4.0.0-8)

and make check-all passes with no problems.

I have also installed all CRAN packages that do not require other 3rd
party drivers, etc. and there were no observed errors in those cases.

So far, so good.

If anything comes up, I will post a follow up.

Best regards,

Marc Schwartz


From mulakken1 at llnl.gov  Tue Jun 14 21:01:45 2005
From: mulakken1 at llnl.gov (mulakken1@llnl.gov)
Date: Tue, 14 Jun 2005 21:01:45 +0200 (CEST)
Subject: [Rd] wrong environment in anova call inside function (PR#7937)
Message-ID: <20050614190145.14BD5A223@slim.kubism.ku.dk>

Hi,

I am working with R version 2.1.0, and I seem to have run into a bug. I get 
the same bug when I run R on Windows as well as when I run it on Linux.

When I call anova to do a LR test from inside a function, I get an error. 
The same call works outside of a function. I have provided the code below.

Thanks,
Nisha Mulakken

############################

myFunction <- function(myDataFrame) {

  # Less restricted
  fit1 <- gls(y ~ dose,
              weights=varIdent(form=~1|dose),
              data=myDataFrame)

  # more restricted
  fit2 <- gls(y ~ dose,
              data=myDataFrame)

  anova.results <- anova(fit1, fit2)
  anova.results
}

df <- data.frame( y=c(12,3,45,1,53,6),
                   dose=c(0,10,200,0,10,200),
                   time=c("4.00 hrs", "4.00 hrs", "6.00 hrs", "6.00 hrs", 
"8.00 hrs", "8.00 hrs"),
                   time.hours=c(4, 4, 6, 6, 8, 8),
                   rep=rep("a", 6)
                 )

## This leads to the following error:
##     Error in anova.lme(object = fit1, fit2) : Object "fit2" not found
results <- myFunction(myDataFrame=df)

#####################################################
## The same thing outside of a function

# Less restricted
fit3 <- gls(y ~ dose,
              weights=varIdent(form=~1|dose),
              data=df)

# more restricted
fit4 <- gls(y ~ dose,
             data=df)

## This works:
anova(fit3, fit4)

## The results:
## > anova(fit3, fit4)
##     Model df      AIC      BIC    logLik   Test L.Ratio p-value
## fit3     1  5 57.98998 54.92145 -23.99499
## fit4     2  3 55.75284 53.91172 -24.87642 1 vs 2 1.76286  0.4142


From ripley at stats.ox.ac.uk  Tue Jun 14 22:09:34 2005
From: ripley at stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Tue, 14 Jun 2005 22:09:34 +0200 (CEST)
Subject: [Rd] wrong environment in anova call inside function (PR#7937)
Message-ID: <20050614200934.1AA9EA223@slim.kubism.ku.dk>

anova() is a generic function in R, and not implicated here: do read the 
error message which pinpoints anova.lme, part of package nlme.

The FAQ asks only package maintainers to use R-bugs for contributed 
packages such as nlme.  Please do read it.

On Tue, 14 Jun 2005 mulakken1 at llnl.gov wrote:

> Hi,
>
> I am working with R version 2.1.0, and I seem to have run into a bug. I get
> the same bug when I run R on Windows as well as when I run it on Linux.
>
> When I call anova to do a LR test from inside a function, I get an error.
> The same call works outside of a function. I have provided the code below.
>
> Thanks,
> Nisha Mulakken
>
> ############################
>
> myFunction <- function(myDataFrame) {
>
>  # Less restricted
>  fit1 <- gls(y ~ dose,
>              weights=varIdent(form=~1|dose),
>              data=myDataFrame)
>
>  # more restricted
>  fit2 <- gls(y ~ dose,
>              data=myDataFrame)
>
>  anova.results <- anova(fit1, fit2)
>  anova.results
> }
>
> df <- data.frame( y=c(12,3,45,1,53,6),
>                   dose=c(0,10,200,0,10,200),
>                   time=c("4.00 hrs", "4.00 hrs", "6.00 hrs", "6.00 hrs",
> "8.00 hrs", "8.00 hrs"),
>                   time.hours=c(4, 4, 6, 6, 8, 8),
>                   rep=rep("a", 6)
>                 )
>
> ## This leads to the following error:
> ##     Error in anova.lme(object = fit1, fit2) : Object "fit2" not found
> results <- myFunction(myDataFrame=df)
>
> #####################################################
> ## The same thing outside of a function
>
> # Less restricted
> fit3 <- gls(y ~ dose,
>              weights=varIdent(form=~1|dose),
>              data=df)
>
> # more restricted
> fit4 <- gls(y ~ dose,
>             data=df)
>
> ## This works:
> anova(fit3, fit4)
>
> ## The results:
> ## > anova(fit3, fit4)
> ##     Model df      AIC      BIC    logLik   Test L.Ratio p-value
> ## fit3     1  5 57.98998 54.92145 -23.99499
> ## fit4     2  3 55.75284 53.91172 -24.87642 1 vs 2 1.76286  0.4142

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From ripley at stats.ox.ac.uk  Tue Jun 14 22:12:13 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue, 14 Jun 2005 21:12:13 +0100 (BST)
Subject: [Rd] R 2.1.1 slated for June 20
In-Reply-To: <1118773739.3126.4.camel@localhost.localdomain>
References: <x264wmbe6m.fsf@turmalin.kubism.ku.dk> 
	<Pine.LNX.4.61.0506101407430.4262@gannet.stats>
	<1118773739.3126.4.camel@localhost.localdomain>
Message-ID: <Pine.LNX.4.61.0506142109440.5934@gannet.stats>

Marc,

Thanks for the confirmation.  Is this using gfortran too?  A date of
20050519 should be after the show-stopper bug was fixed, but I am waiting 
for 4.0.1 to be released (imminent) before doing more tests with gcc4.

Brian

On Tue, 14 Jun 2005, Marc Schwartz wrote:

> On Fri, 2005-06-10 at 14:57 +0100, Prof Brian Ripley wrote:
>> On Fri, 10 Jun 2005, Peter Dalgaard wrote:
>>
>>> The next version of R will be released (barring force majeure) on June
>>> 20th, with beta versions available starting Monday.
>>>
>>> Please do check them on your system *before* the release this time...
>>
>> Some things which it would be particularly helpful to have tested:
>
>
>> - Bleeding-edge OSes, e.g. anyone running Fedora Core 4 test 3?  (These
>>    often show up problems with bugs in the pre-release versions of
>>    components such as X11 and compilers.)
>
>
> Just as a quick heads up, I installed FC4 Release ("Stentz") late
> yesterday.
>
> R (Version 2.1.1 beta (2005-06-14)) compiles fine using:
>
> $ gcc --version
> gcc (GCC) 4.0.0 20050519 (Red Hat 4.0.0-8)
>
> and make check-all passes with no problems.
>
> I have also installed all CRAN packages that do not require other 3rd
> party drivers, etc. and there were no observed errors in those cases.
>
> So far, so good.
>
> If anything comes up, I will post a follow up.
>
> Best regards,
>
> Marc Schwartz
>
>
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From MSchwartz at mn.rr.com  Tue Jun 14 22:34:28 2005
From: MSchwartz at mn.rr.com (Marc Schwartz)
Date: Tue, 14 Jun 2005 15:34:28 -0500
Subject: [Rd] R 2.1.1 slated for June 20
In-Reply-To: <Pine.LNX.4.61.0506142109440.5934@gannet.stats>
References: <x264wmbe6m.fsf@turmalin.kubism.ku.dk>
	<Pine.LNX.4.61.0506101407430.4262@gannet.stats>
	<1118773739.3126.4.camel@localhost.localdomain>
	<Pine.LNX.4.61.0506142109440.5934@gannet.stats>
Message-ID: <1118781268.3126.44.camel@localhost.localdomain>

Prof. Ripley,

If my read of the config.log is correct, it would appear that g77 was
used and not gfortran (which is installed):

...
  C compiler:                gcc  -g -O2
  C++ compiler:              g++  -g -O2
  Fortran compiler:          g77  -g -O2
...


$ g77 --version
GNU Fortran (GCC 3.2.3 20030502 (Red Hat Linux 3.2.3-47.fc4)) 3.2.3
20030502 (Red Hat Linux 3.2.3-13)


$ gfortran --version
GNU Fortran 95 (GCC 4.0.0 20050519 (Red Hat 4.0.0-8))


Checking 'man gfortran':

Gfortran is not yet a fully conformant Fortran 95 compiler.  It can
generate code for most constructs and expressions, but work remains to
be done.  In particular, there are known deficiencies with ENTRY,
NAMELIST, and sophisticated use of MODULES, POINTERS and DERIVED TYPES.
For those whose Fortran codes conform to either the Fortran 77 standard
or the GNU Fortran 77 language, we recommend to use g77 from GCC 3.4.
We recommend that distributors continue to provide packages of g77-3.4
until we announce that gfortran fully replaces g77. The gfortran
developers welcome any feedback on user experience with gfortran at
<fortran at gcc.gnu.org>.


HTH,

Marc


On Tue, 2005-06-14 at 21:12 +0100, Prof Brian Ripley wrote:
> Marc,
> 
> Thanks for the confirmation.  Is this using gfortran too?  A date of
> 20050519 should be after the show-stopper bug was fixed, but I am waiting 
> for 4.0.1 to be released (imminent) before doing more tests with gcc4.
> 
> Brian
> 
> On Tue, 14 Jun 2005, Marc Schwartz wrote:
> 
> > On Fri, 2005-06-10 at 14:57 +0100, Prof Brian Ripley wrote:
> >> On Fri, 10 Jun 2005, Peter Dalgaard wrote:
> >>
> >>> The next version of R will be released (barring force majeure) on June
> >>> 20th, with beta versions available starting Monday.
> >>>
> >>> Please do check them on your system *before* the release this time...
> >>
> >> Some things which it would be particularly helpful to have tested:
> >
> >
> >> - Bleeding-edge OSes, e.g. anyone running Fedora Core 4 test 3?  (These
> >>    often show up problems with bugs in the pre-release versions of
> >>    components such as X11 and compilers.)
> >
> >
> > Just as a quick heads up, I installed FC4 Release ("Stentz") late
> > yesterday.
> >
> > R (Version 2.1.1 beta (2005-06-14)) compiles fine using:
> >
> > $ gcc --version
> > gcc (GCC) 4.0.0 20050519 (Red Hat 4.0.0-8)
> >
> > and make check-all passes with no problems.
> >
> > I have also installed all CRAN packages that do not require other 3rd
> > party drivers, etc. and there were no observed errors in those cases.
> >
> > So far, so good.
> >
> > If anything comes up, I will post a follow up.
> >
> > Best regards,
> >
> > Marc Schwartz
> >
> >
> >
>


From p.dalgaard at biostat.ku.dk  Tue Jun 14 23:52:36 2005
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: 14 Jun 2005 23:52:36 +0200
Subject: [Rd] R 2.1.1 slated for June 20
In-Reply-To: <1118773739.3126.4.camel@localhost.localdomain>
References: <x264wmbe6m.fsf@turmalin.kubism.ku.dk>
	<Pine.LNX.4.61.0506101407430.4262@gannet.stats>
	<1118773739.3126.4.camel@localhost.localdomain>
Message-ID: <x2d5qoa9nf.fsf@turmalin.kubism.ku.dk>

Marc Schwartz <MSchwartz at mn.rr.com> writes:

> On Fri, 2005-06-10 at 14:57 +0100, Prof Brian Ripley wrote:
> > On Fri, 10 Jun 2005, Peter Dalgaard wrote:
> > 
> > > The next version of R will be released (barring force majeure) on June
> > > 20th, with beta versions available starting Monday.
> > >
> > > Please do check them on your system *before* the release this time...
> > 
> > Some things which it would be particularly helpful to have tested:
> 
> 
> > - Bleeding-edge OSes, e.g. anyone running Fedora Core 4 test 3?  (These
> >    often show up problems with bugs in the pre-release versions of
> >    components such as X11 and compilers.)
> 
> 
> Just as a quick heads up, I installed FC4 Release ("Stentz") late
> yesterday.
> 
> R (Version 2.1.1 beta (2005-06-14)) compiles fine using:
> 
> $ gcc --version
> gcc (GCC) 4.0.0 20050519 (Red Hat 4.0.0-8)
> 
> and make check-all passes with no problems.
> 
> I have also installed all CRAN packages that do not require other 3rd
> party drivers, etc. and there were no observed errors in those cases.
> 
> So far, so good.
> 
> If anything comes up, I will post a follow up.
> 
> Best regards,
> 
> Marc Schwartz

Yep. Just tried the same on AMD64 (I had a bit of a fight converting
my SuSE setup -- FC4 is quite unhappy about ReiserFS for some reason).
A couple of f95 warnings whooshed by during the compile, that was all.

By the way, I noticed that you can now "yum install R R-devel" and get
everything straight from Fedora Extras.


-- 
   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
 (*) \(*) -- University of Copenhagen   Denmark          Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)                  FAX: (+45) 35327907


From p.dalgaard at biostat.ku.dk  Wed Jun 15 00:01:46 2005
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: 15 Jun 2005 00:01:46 +0200
Subject: [Rd] R 2.1.1 slated for June 20
In-Reply-To: <1118781268.3126.44.camel@localhost.localdomain>
References: <x264wmbe6m.fsf@turmalin.kubism.ku.dk>
	<Pine.LNX.4.61.0506101407430.4262@gannet.stats>
	<1118773739.3126.4.camel@localhost.localdomain>
	<Pine.LNX.4.61.0506142109440.5934@gannet.stats>
	<1118781268.3126.44.camel@localhost.localdomain>
Message-ID: <x28y1ca985.fsf@turmalin.kubism.ku.dk>

Marc Schwartz <MSchwartz at mn.rr.com> writes:

> Prof. Ripley,
> 
> If my read of the config.log is correct, it would appear that g77 was
> used and not gfortran (which is installed):
> 
> ...
>   C compiler:                gcc  -g -O2
>   C++ compiler:              g++  -g -O2
>   Fortran compiler:          g77  -g -O2
> ...

Mine was


  C compiler:                gcc  -g -O2
  C++ compiler:              g++  -g -O2
  Fortran compiler:          f95  -g -O2

(and f95 is a link to gfortran)

-- 
   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
 (*) \(*) -- University of Copenhagen   Denmark          Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)                  FAX: (+45) 35327907


From MSchwartz at mn.rr.com  Wed Jun 15 00:07:16 2005
From: MSchwartz at mn.rr.com (Marc Schwartz)
Date: Tue, 14 Jun 2005 17:07:16 -0500
Subject: [Rd] R 2.1.1 slated for June 20
In-Reply-To: <x2d5qoa9nf.fsf@turmalin.kubism.ku.dk>
References: <x264wmbe6m.fsf@turmalin.kubism.ku.dk>
	<Pine.LNX.4.61.0506101407430.4262@gannet.stats>
	<1118773739.3126.4.camel@localhost.localdomain>
	<x2d5qoa9nf.fsf@turmalin.kubism.ku.dk>
Message-ID: <1118786837.3968.14.camel@localhost.localdomain>

On Tue, 2005-06-14 at 23:52 +0200, Peter Dalgaard wrote:
> Marc Schwartz <MSchwartz at mn.rr.com> writes:
> 
> > On Fri, 2005-06-10 at 14:57 +0100, Prof Brian Ripley wrote:
> > > On Fri, 10 Jun 2005, Peter Dalgaard wrote:
> > > 
> > > > The next version of R will be released (barring force majeure) on June
> > > > 20th, with beta versions available starting Monday.
> > > >
> > > > Please do check them on your system *before* the release this time...
> > > 
> > > Some things which it would be particularly helpful to have tested:
> > 
> > 
> > > - Bleeding-edge OSes, e.g. anyone running Fedora Core 4 test 3?  (These
> > >    often show up problems with bugs in the pre-release versions of
> > >    components such as X11 and compilers.)
> > 
> > 
> > Just as a quick heads up, I installed FC4 Release ("Stentz") late
> > yesterday.
> > 
> > R (Version 2.1.1 beta (2005-06-14)) compiles fine using:
> > 
> > $ gcc --version
> > gcc (GCC) 4.0.0 20050519 (Red Hat 4.0.0-8)
> > 
> > and make check-all passes with no problems.
> > 
> > I have also installed all CRAN packages that do not require other 3rd
> > party drivers, etc. and there were no observed errors in those cases.
> > 
> > So far, so good.
> > 
> > If anything comes up, I will post a follow up.
> > 
> > Best regards,
> > 
> > Marc Schwartz
> 
> Yep. Just tried the same on AMD64 (I had a bit of a fight converting
> my SuSE setup -- FC4 is quite unhappy about ReiserFS for some reason).
> A couple of f95 warnings whooshed by during the compile, that was all.
> 
> By the way, I noticed that you can now "yum install R R-devel" and get
> everything straight from Fedora Extras.

Yep. Tom "Spot" Callaway is the FE maintainer for R.

A lot of things for FC 4 have been moved to Extras and there are of
course new things (like R) there as well. The restrictions on non-GPL
components is still there, so things like MP3 functionality is available
via third party repos such as FreshRPMS, Livna, etc.

This was a "balancing" act between trying to reduce (manage) the size of
the main distro and reducing real or perceived redundancies in packages.

So, for example:

1. Include OO.org in Core, but move Gnumeric to Extras

2. Include Emacs in Core, but move XEmacs to Extras

Needless to say, that resulted in "emotional" discussions.

Marc


From MSchwartz at mn.rr.com  Wed Jun 15 00:16:27 2005
From: MSchwartz at mn.rr.com (Marc Schwartz)
Date: Tue, 14 Jun 2005 17:16:27 -0500
Subject: [Rd] R 2.1.1 slated for June 20
In-Reply-To: <x28y1ca985.fsf@turmalin.kubism.ku.dk>
References: <x264wmbe6m.fsf@turmalin.kubism.ku.dk>
	<Pine.LNX.4.61.0506101407430.4262@gannet.stats>
	<1118773739.3126.4.camel@localhost.localdomain>
	<Pine.LNX.4.61.0506142109440.5934@gannet.stats>
	<1118781268.3126.44.camel@localhost.localdomain>
	<x28y1ca985.fsf@turmalin.kubism.ku.dk>
Message-ID: <1118787388.3968.19.camel@localhost.localdomain>

On Wed, 2005-06-15 at 00:01 +0200, Peter Dalgaard wrote:
> Marc Schwartz <MSchwartz at mn.rr.com> writes:
> 
> > Prof. Ripley,
> > 
> > If my read of the config.log is correct, it would appear that g77 was
> > used and not gfortran (which is installed):
> > 
> > ...
> >   C compiler:                gcc  -g -O2
> >   C++ compiler:              g++  -g -O2
> >   Fortran compiler:          g77  -g -O2
> > ...
> 
> Mine was
> 
> 
>   C compiler:                gcc  -g -O2
>   C++ compiler:              g++  -g -O2
>   Fortran compiler:          f95  -g -O2
> 
> (and f95 is a link to gfortran)


Interesting. Did you do anything different on the ./configure line?

$ ls -l  /usr/bin/f95
lrwxrwxrwx  1 root root 8 Jun 13 21:18 /usr/bin/f95 -> gfortran

I just tried it again (having installed some FC updates) and I still get
g77...

Marc


From Simon.Blomberg at anu.edu.au  Wed Jun 15 03:17:02 2005
From: Simon.Blomberg at anu.edu.au (Simon Blomberg)
Date: Wed, 15 Jun 2005 11:17:02 +1000
Subject: [Rd] Citation for R
In-Reply-To: <XFMail.050614104548.Ted.Harding@nessie.mcc.ac.uk>
References: <XFMail.050614104548.Ted.Harding@nessie.mcc.ac.uk>
Message-ID: <a06110402bed5298efefb@[150.203.51.113]>

As a biologist, I have been following this thread with interest.

I don't understand how someone can truly peer-review any software 
without access to the source. Surely R is the only major environment 
for statistical programming that _can_ be peer-reviewed in that 
sense. (The BUGS project is heading in that direction with OpenBUGS.) 
All the others (SAS, SPSS etc.) rely on their "prestige", since they 
are unwilling to show us exactly how they do their computations.

I agree that the citation problem is not a bug in R, but a bug in the 
publishers. It is up to the users to aggressively tackle resistance 
to citing correctly published software (ie software with an ISBN 
number,as opposed to in-house publishing of User manuals etc.). 
Perhaps the R Development Core Team could provide  a position 
statement on the citation and publication of R that could be used to 
convince editors that the current citation method for R is correct 
and appropriate. If it were signed by all the members, with their 
academic affiliations, it would be hard for editors to disagree.

Simon.


>On 14-Jun-05 A.J. Rossini wrote:
>>  Fritz -
>>
>>  That's silly.  As someone pointed out, the issue is with the
>>  publisher, not the citation.  If R-Core were a generally well-known
>>  and regarded publishing house such as Springer or Microsoft, it would
>>  not be a problem.  But it's still a nebulous entity to MANY people,
>>  and so many people fail to understand this open source stuff.  It's
>>  seriously discouraged by most journals to cite technical reports, for
>>  example.  And perhaps, R could be considered more of a long-ish
>>  technical report than a book?   Though perhaps Peter D. could be
>>  considered the "editor"?  (these questions are not those that I need
>>  to ask, obviously!)
>>
>>  (just yesterday, I was asked by a reasonably intelligent colleague,
>>  with respect to corporate packaging of R: "So they (corporate
>>  packagers) just pick some version and package it, right?"  and my
>>  flabbergasted response was:
>>
>>  "and so, what the heck do you think they (corporate packagers) do with
>>  SAS, S-PLUS, and SPSS, and why do you think it's different...?").
>>
>>  best,
>>  -tony
>
>Tony is getting admirably and justifiably tetchy! His comment
>about the packaging of SAS, S-PLUS and SPSS is delightfully
>to the point (and, had I been there at the time, I'd have
>bought him a beverage of his choice in appreciation).
>
>And, to extend his comment, where for instance does that leave
>WinBUGS (see my previous mail)? Granted, perhaps, that in the
>citation
>
>
>   Spiegelhalter, D. J., Thomas, A. and Best, N. G. (2000)
>     WinBUGS Version 1.3 User Manual. Cambridge: Medical Research
>     Council Biostatistics Unit.
>     (Available from www.mrc-bsu.cam.ac.uk/bugs.)
>
>
>one has a prestigious institute (MRC-BSU) as the publisher.
>But, basically, it's the same self-justifiying ordinance all
>over again: the creators of the software produce their own
>User Manual and "publish" it. The publisher of S-PLUS and its
>documentation is "Insightful Corporation": beyond their
>achievement in developing S-PLUS, whence their prestige?
>(Granted, again, if you look inside the books, you can find
>famous names listed as contributors; but we at R can claim
>many of these same names ... ).
>
>The issue of "peer review" of software citations has been
>raised. Where is the peer review of the S-PLUS or SAS or
>SPSS User Manual? OK, the thing that needs peer review is
>the software itself. In the "Review" section of journals
>you can find critical reviews of software. But these are
>not referee'd and usually represent the writer's own views;
>furthermore, such reviews are not often cited in articles
>where the software has been used to obtain the results in
>the article. People just use the stuff, and cite the User
>Manual or the "corporate packager".
>
>Also, from time to time you come across published referee'd
>articles which analyse the performance of software for
>particular purposes, or compare different software packages
>for a given purpose. These could be viewed as peer review,
>but, again, are rarely cited by the simple user.
>
>Moreover, suppose that citing User Manual or corporate packager
>is considered to justify the use of the software in an article.
>I have seen many articles where such-and-such software was used
>(I mention no names) and "cited" in these terms, where it is
>known to discerning users that the software does not correctly
>address the tasks it claims to work for, or gives incorrect
>results. Yet the "citation box" had been duly ticked, and the
>article has successfully gone through the editorial process.
>This is not peer review either -- and could only come close to
>it if the journal editors' panel of referees could be assumed
>sufficiently knowledgeable to be discriminating about such things.
>
>But in that case you don't really need a citation: the referee
>says "Used [e.g.] S-PLUS, yes, that's fine for this job and
>I could reproduce the analysis using that software and trust
>the results. Passed." And such a referee could say exactly
>the same for R.
>
>The true peer review of software is done by discriminating
>users of the software. Peer review of R is done *HERE* (as
>well as other places).
>
>[I've had the experience of using R for analysis, only to
>have the analysis repeated in S-PLUS purely for the purpose
>of citing S-PLUS rather than R for publication ... ]
>
>However, the follow-ups in this thread are departing somewhat
>from Gordon Smyth's original wish to pay tribute, in citation,
>to the growing team of people who have, over the last 10+ years,
>contributed centrally to making R what it is.
>
>Thinking about that question, I can't come up with a better
>idea than his: an up-to-date "Ihaka and Gentleman", which
>does due honour to the greatly enhanced riches of R, and R's
>solidity and quality, at the present time!
>
>But maybe this might take a book ...
>
>Best wishes to all,
>Ted.
>
>
>--------------------------------------------------------------------
>E-Mail: (Ted Harding) <Ted.Harding at nessie.mcc.ac.uk>
>Fax-to-email: +44 (0)870 094 0861
>Date: 14-Jun-05                                       Time: 10:45:39
>------------------------------ XFMail ------------------------------
>
>______________________________________________
>R-devel at r-project.org mailing list
>https://stat.ethz.ch/mailman/listinfo/r-devel


-- 
Simon Blomberg, B.Sc.(Hons.), Ph.D, M.App.Stat.
Visiting Fellow
School of Botany & Zoology
The Australian National University
Canberra ACT 0200
Australia

T: +61 2 6125 8057  email: Simon.Blomberg at anu.edu.au
F: +61 2 6125 5573

CRICOS Provider # 00120C


From simon.urbanek at r-project.org  Wed Jun 15 04:42:34 2005
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Tue, 14 Jun 2005 22:42:34 -0400
Subject: [Rd] R 2.1.1 slated for June 20
In-Reply-To: <1118787388.3968.19.camel@localhost.localdomain>
References: <x264wmbe6m.fsf@turmalin.kubism.ku.dk>
	<Pine.LNX.4.61.0506101407430.4262@gannet.stats>
	<1118773739.3126.4.camel@localhost.localdomain>
	<Pine.LNX.4.61.0506142109440.5934@gannet.stats>
	<1118781268.3126.44.camel@localhost.localdomain>
	<x28y1ca985.fsf@turmalin.kubism.ku.dk>
	<1118787388.3968.19.camel@localhost.localdomain>
Message-ID: <3BEE2B99-F495-4320-BD7D-242C64F60245@r-project.org>

On Jun 14, 2005, at 6:16 PM, Marc Schwartz wrote:

> Interesting. Did you do anything different on the ./configure line?
>
> $ ls -l  /usr/bin/f95
> lrwxrwxrwx  1 root root 8 Jun 13 21:18 /usr/bin/f95 -> gfortran
>
> I just tried it again (having installed some FC updates) and I  
> still get g77...

g77 is probed before f95, so if you have both, g77 is picked unless  
you set F77 explicitly. The exact probe sequence is:

g77 f77 xlf frt pgf77 fort77 fl32 af77 f90 xlf90 pgf90 epcf90 f95  
fort xlf95 ifc efc pgf95 lf95 gfortran (R 2.1.1 beta)
g77 fort77 f77 xlf frt pgf77 cf77 fl32 af77 f95 fort xlf95 ifort ifc  
efc pgf95 lf95 gfortran ftn g95 f90 xlf90 pgf90 pghpf epcf90 fc (R- 
devel)

I guess Peter simply didn't install g77.

Cheers,
Simon


From edd at debian.org  Wed Jun 15 05:32:58 2005
From: edd at debian.org (Dirk Eddelbuettel)
Date: Tue, 14 Jun 2005 22:32:58 -0500
Subject: [Rd] R 2.1.1 slated for June 20
In-Reply-To: <3BEE2B99-F495-4320-BD7D-242C64F60245@r-project.org>
References: <x264wmbe6m.fsf@turmalin.kubism.ku.dk>
	<Pine.LNX.4.61.0506101407430.4262@gannet.stats>
	<1118773739.3126.4.camel@localhost.localdomain>
	<Pine.LNX.4.61.0506142109440.5934@gannet.stats>
	<1118781268.3126.44.camel@localhost.localdomain>
	<x28y1ca985.fsf@turmalin.kubism.ku.dk>
	<1118787388.3968.19.camel@localhost.localdomain>
	<3BEE2B99-F495-4320-BD7D-242C64F60245@r-project.org>
Message-ID: <17071.41322.551489.694503@basebud.nulle.part>


For completeness, I also just tried the R 2.1.1 snapshot from yesterday with
gcc-4.0, g++-4.0 and gfortran-4.0 in an up-to-date Debian unstable chroot --
no issues to report from the build and regression test.

Haven't run that version as I currently do not have a system running
unstable, though.

The new package based on R 2.1.1 beta also built on all autobuilders, with
the exceptions of mips and mipsel which appear to be lacking working blas
libs causing an aborted built on these two.

Dirk

-- 
Statistics: The (futile) attempt to offer certainty about uncertainty.
         -- Roger Koenker, 'Dictionary of Received Ideas of Statistics'


From MSchwartz at mn.rr.com  Wed Jun 15 06:08:41 2005
From: MSchwartz at mn.rr.com (Marc Schwartz)
Date: Tue, 14 Jun 2005 23:08:41 -0500
Subject: [Rd] R 2.1.1 slated for June 20
In-Reply-To: <3BEE2B99-F495-4320-BD7D-242C64F60245@r-project.org>
References: <x264wmbe6m.fsf@turmalin.kubism.ku.dk>
	<Pine.LNX.4.61.0506101407430.4262@gannet.stats>
	<1118773739.3126.4.camel@localhost.localdomain>
	<Pine.LNX.4.61.0506142109440.5934@gannet.stats>
	<1118781268.3126.44.camel@localhost.localdomain>
	<x28y1ca985.fsf@turmalin.kubism.ku.dk>
	<1118787388.3968.19.camel@localhost.localdomain>
	<3BEE2B99-F495-4320-BD7D-242C64F60245@r-project.org>
Message-ID: <1118808521.9457.20.camel@localhost.localdomain>

On Tue, 2005-06-14 at 22:42 -0400, Simon Urbanek wrote:
> On Jun 14, 2005, at 6:16 PM, Marc Schwartz wrote:
> 
> > Interesting. Did you do anything different on the ./configure line?
> >
> > $ ls -l  /usr/bin/f95
> > lrwxrwxrwx  1 root root 8 Jun 13 21:18 /usr/bin/f95 -> gfortran
> >
> > I just tried it again (having installed some FC updates) and I  
> > still get g77...
> 
> g77 is probed before f95, so if you have both, g77 is picked unless  
> you set F77 explicitly. The exact probe sequence is:
> 
> g77 f77 xlf frt pgf77 fort77 fl32 af77 f90 xlf90 pgf90 epcf90 f95  
> fort xlf95 ifc efc pgf95 lf95 gfortran (R 2.1.1 beta)
> g77 fort77 f77 xlf frt pgf77 cf77 fl32 af77 f95 fort xlf95 ifort ifc  
> efc pgf95 lf95 gfortran ftn g95 f90 xlf90 pgf90 pghpf epcf90 fc (R- 
> devel)
> 
> I guess Peter simply didn't install g77.
> 
> Cheers,
> Simon

Simon,

Thanks for that. When I installed FC4, I used the option to install
"Everything", which is what I have done with each prior release going
back to RH 8.0. Of course with many things being moved to Extras,
"Everything" is now a shadow of it's former meaning.

It is noted that "Everything" includes RPMS that are not explicitly
listed in other pre-defined groups for installation.

In reviewing the Add/Remove Application GUI, gfortran is listed as an
"Extra Package" in the Development Tools Group.

g77 is not listed in that Group or in the Legacy Development Group, so
it would appear that it is a "silent" part of the "Everything"
installation procedure.

Removing the offending RPM:

rpm -e compat-gcc-32-g77-3.2.3-47.fc4

I now get:

  C compiler:                gcc  -g -O2
  C++ compiler:              g++  -g -O2
  Fortran compiler:          f95  -g -O2


I re-compiled and did note the warning messages that I believe Peter
referred to:

f95   -g -O2 -c blas.f -o blas.o
 In file blas.f:1561

      GO TO IGO,(120,150,180,210)
              1
Warning: Obsolete: Assigned GOTO statement at (1)
 In file blas.f:1567

               ASSIGN 120 TO IGO
                                                                       1
Warning: Obsolete: ASSIGN statement at (1)
 In file blas.f:1579

               ASSIGN 150 TO IGO
                                                                       1
Warning: Obsolete: ASSIGN statement at (1)
 In file blas.f:1592

               ASSIGN 180 TO IGO
                                                                       1
Warning: Obsolete: ASSIGN statement at (1)
 In file blas.f:1603

               ASSIGN 210 TO IGO
                                                                       1
Warning: Obsolete: ASSIGN statement at (1)



make check-all passes with no errors, so no change there.


Regards,

Marc


From ripley at stats.ox.ac.uk  Wed Jun 15 08:51:21 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed, 15 Jun 2005 07:51:21 +0100 (BST)
Subject: [Rd] R 2.1.1 slated for June 20
In-Reply-To: <1118808521.9457.20.camel@localhost.localdomain>
References: <x264wmbe6m.fsf@turmalin.kubism.ku.dk> 
	<Pine.LNX.4.61.0506101407430.4262@gannet.stats>
	<1118773739.3126.4.camel@localhost.localdomain>
	<Pine.LNX.4.61.0506142109440.5934@gannet.stats>
	<1118781268.3126.44.camel@localhost.localdomain>
	<x28y1ca985.fsf@turmalin.kubism.ku.dk>
	<1118787388.3968.19.camel@localhost.localdomain>
	<3BEE2B99-F495-4320-BD7D-242C64F60245@r-project.org>
	<1118808521.9457.20.camel@localhost.localdomain>
Message-ID: <Pine.LNX.4.61.0506150740430.17433@gannet.stats>

Our preference is F77 compilers over F9x ones, as the lists Simon showed 
reflects - we decided to prefer F95 to F90 in future, though.

My experience is that g77 from gcc-3.4.x is preferable to gfortran.
As I said earlier, once gcc-4.0.1 is released (and so R builds with a 
released version of gcc-4.x.y - 4.0.0 needs worarounds)  I will take a 
another look.  So far, using gcc-3.4.4 is both faster and more accurate 
that gcc-4.0.0.  There are a few instances in which loess gives rather 
different results with gfortran, but they are only visible by diffing
postscript files.

I will look into converting blas.f to F77 (but not for this release).

On Tue, 14 Jun 2005, Marc Schwartz wrote:

> On Tue, 2005-06-14 at 22:42 -0400, Simon Urbanek wrote:
>> On Jun 14, 2005, at 6:16 PM, Marc Schwartz wrote:
>>
>>> Interesting. Did you do anything different on the ./configure line?
>>>
>>> $ ls -l  /usr/bin/f95
>>> lrwxrwxrwx  1 root root 8 Jun 13 21:18 /usr/bin/f95 -> gfortran
>>>
>>> I just tried it again (having installed some FC updates) and I
>>> still get g77...
>>
>> g77 is probed before f95, so if you have both, g77 is picked unless
>> you set F77 explicitly. The exact probe sequence is:
>>
>> g77 f77 xlf frt pgf77 fort77 fl32 af77 f90 xlf90 pgf90 epcf90 f95
>> fort xlf95 ifc efc pgf95 lf95 gfortran (R 2.1.1 beta)
>> g77 fort77 f77 xlf frt pgf77 cf77 fl32 af77 f95 fort xlf95 ifort ifc
>> efc pgf95 lf95 gfortran ftn g95 f90 xlf90 pgf90 pghpf epcf90 fc (R-
>> devel)
>>
>> I guess Peter simply didn't install g77.
>>
>> Cheers,
>> Simon
>
> Simon,
>
> Thanks for that. When I installed FC4, I used the option to install
> "Everything", which is what I have done with each prior release going
> back to RH 8.0. Of course with many things being moved to Extras,
> "Everything" is now a shadow of it's former meaning.
>
> It is noted that "Everything" includes RPMS that are not explicitly
> listed in other pre-defined groups for installation.
>
> In reviewing the Add/Remove Application GUI, gfortran is listed as an
> "Extra Package" in the Development Tools Group.
>
> g77 is not listed in that Group or in the Legacy Development Group, so
> it would appear that it is a "silent" part of the "Everything"
> installation procedure.
>
> Removing the offending RPM:
>
> rpm -e compat-gcc-32-g77-3.2.3-47.fc4
>
> I now get:
>
>  C compiler:                gcc  -g -O2
>  C++ compiler:              g++  -g -O2
>  Fortran compiler:          f95  -g -O2
>
>
> I re-compiled and did note the warning messages that I believe Peter
> referred to:
>
> f95   -g -O2 -c blas.f -o blas.o
> In file blas.f:1561
>
>      GO TO IGO,(120,150,180,210)
>              1
> Warning: Obsolete: Assigned GOTO statement at (1)
> In file blas.f:1567
>
>               ASSIGN 120 TO IGO
>                                                                       1
> Warning: Obsolete: ASSIGN statement at (1)
> In file blas.f:1579
>
>               ASSIGN 150 TO IGO
>                                                                       1
> Warning: Obsolete: ASSIGN statement at (1)
> In file blas.f:1592
>
>               ASSIGN 180 TO IGO
>                                                                       1
> Warning: Obsolete: ASSIGN statement at (1)
> In file blas.f:1603
>
>               ASSIGN 210 TO IGO
>                                                                       1
> Warning: Obsolete: ASSIGN statement at (1)
>
>
>
> make check-all passes with no errors, so no change there.
>
>
> Regards,
>
> Marc
>
>
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From p.dalgaard at biostat.ku.dk  Wed Jun 15 11:14:28 2005
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: 15 Jun 2005 11:14:28 +0200
Subject: [Rd] R 2.1.1 slated for June 20
In-Reply-To: <1118787388.3968.19.camel@localhost.localdomain>
References: <x264wmbe6m.fsf@turmalin.kubism.ku.dk>
	<Pine.LNX.4.61.0506101407430.4262@gannet.stats>
	<1118773739.3126.4.camel@localhost.localdomain>
	<Pine.LNX.4.61.0506142109440.5934@gannet.stats>
	<1118781268.3126.44.camel@localhost.localdomain>
	<x28y1ca985.fsf@turmalin.kubism.ku.dk>
	<1118787388.3968.19.camel@localhost.localdomain>
Message-ID: <x2y89c7zij.fsf@turmalin.kubism.ku.dk>

Marc Schwartz <MSchwartz at mn.rr.com> writes:

> On Wed, 2005-06-15 at 00:01 +0200, Peter Dalgaard wrote:
> > Marc Schwartz <MSchwartz at mn.rr.com> writes:
> > 
> > > Prof. Ripley,
> > > 
> > > If my read of the config.log is correct, it would appear that g77 was
> > > used and not gfortran (which is installed):
> > > 
> > > ...
> > >   C compiler:                gcc  -g -O2
> > >   C++ compiler:              g++  -g -O2
> > >   Fortran compiler:          g77  -g -O2
> > > ...
> > 
> > Mine was
> > 
> > 
> >   C compiler:                gcc  -g -O2
> >   C++ compiler:              g++  -g -O2
> >   Fortran compiler:          f95  -g -O2
> > 
> > (and f95 is a link to gfortran)
> 
> 
> Interesting. Did you do anything different on the ./configure line?
> 
> $ ls -l  /usr/bin/f95
> lrwxrwxrwx  1 root root 8 Jun 13 21:18 /usr/bin/f95 -> gfortran
> 
> I just tried it again (having installed some FC updates) and I still get
> g77...

I just didn't install g77... (it's listed under "back-compatibility
tools" or something like that).

-- 
   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
 (*) \(*) -- University of Copenhagen   Denmark          Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)                  FAX: (+45) 35327907


From agalakhov at ifmlrs.uran.ru  Wed Jun 15 12:37:00 2005
From: agalakhov at ifmlrs.uran.ru (agalakhov@ifmlrs.uran.ru)
Date: Wed, 15 Jun 2005 12:37:00 +0200 (CEST)
Subject: [Rd] source() chdir does not work (PR#7940)
Message-ID: <20050615103700.C23F2A1F9@slim.kubism.ku.dk>

Full_Name: Alex Galakhov
Version: 2.1.0
OS: Linux (Debian)
Submission from: (NULL) (195.19.131.68)


After software upgrade source() does not work properly anymore. It completely
ignores the chdir= parameter. This is because is.character(file) is always false
after the assignment file<-file(file).

The fix is (written by hand in diff-like syntax, hopefully, you'll understand
it):

 source<- function (blablabla) {
+filename <- file
...blablabla
-if (chdir && is.character (file) && ... dirname(file) ...) {
+if (chdir && is.character (filename) && ... dirname(filename) ...) {
+close(file) # since we can have only one on.exit(), we close file here
...blablabla
 on.exit(setwd(owd));
 }


From ripley at stats.ox.ac.uk  Wed Jun 15 12:51:45 2005
From: ripley at stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Wed, 15 Jun 2005 12:51:45 +0200 (CEST)
Subject: [Rd] source() chdir does not work (PR#7940)
Message-ID: <20050615105145.0F8D9EC79@slim.kubism.ku.dk>

This is already fixed:

     o	source(file, chdir = TRUE) was not checking that 'file' was a
 	filepath (rather than a URL).  For 2.1.0 only, it did not work
 	even if 'file' was a filepath.

>From the R FAQ:

    Before you actually submit a bug report, you should check whether the 
bug has already been reported and/or fixed.  First, try the "Search 
Existing Reports" facility in the Bug Tracking page at 
`http://bugs.R-project.org/'.  Second, consult 
`https://svn.R-project.org/R/trunk/NEWS', which records changes that will 
appear in the _next_ release of R, including some bug fixes that do not 
appear in Bug Tracking.  (Windows users should additionally consult 
`https://svn.R-project.org/R/trunk/src/gnuwin32/CHANGES'.)  Third, if 
possible try the current r-patched or r-devel version of R.  If a bug has 
already been reported or fixed,
please do not submit further bug reports on it.
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

On Wed, 15 Jun 2005 agalakhov at ifmlrs.uran.ru wrote:

> Full_Name: Alex Galakhov
> Version: 2.1.0
> OS: Linux (Debian)
> Submission from: (NULL) (195.19.131.68)
>
>
> After software upgrade source() does not work properly anymore. It completely
> ignores the chdir= parameter. This is because is.character(file) is always false
> after the assignment file<-file(file).
>
> The fix is (written by hand in diff-like syntax, hopefully, you'll understand
> it):
>
> source<- function (blablabla) {
> +filename <- file
> ...blablabla
> -if (chdir && is.character (file) && ... dirname(file) ...) {
> +if (chdir && is.character (filename) && ... dirname(filename) ...) {
> +close(file) # since we can have only one on.exit(), we close file here
> ...blablabla
> on.exit(setwd(owd));
> }


-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From gilles.guillot at inapg.inra.fr  Wed Jun 15 13:41:37 2005
From: gilles.guillot at inapg.inra.fr (Gilles GUILLOT)
Date: Wed, 15 Jun 2005 13:41:37 +0200
Subject: [Rd] Calling C function from Fortran
Message-ID: <200506151341.37076.gilles.guillot@inapg.inra.fr>

Hi all,

the example in the R doc 
and the hints from Shusong Jin ,  Ingmar Visser and Reid Huntsinger 
(thanks all three) refer to the case where the function does not have 
arguments.
I'm still looking for a proper sequence of commands 
to call C functions with arguemnts from R.


Imagine I want to evaluate the gamma function.
I want to use the C function called by R.
(I guess it is the one corresponding to the source code 
 I found in the directory  R-2.1.0/src/nmath/gamma.c
of the source distribution).

The following programs do not work (it returns fancy values)


#include <R.h>
#include <Rmath.h>
void F77_SUB(mygammac)(double x, double y) { y = gammafn(x); }


   subroutine mygammaf(x,y)
   double precision x,y
   call mygammac(x,y)  
   end

called in R through 
x <- 3
y <- -999
res <- .Fortran("mygammaf",
                as.double(x),
                as.double(y))

While changing the C code into 
#include <R.h>
#include <Rmath.h>
void F77_SUB(mygammac)(double *x, double *y) { *y = gammafn(*x); }

seems to work fine.
But  R-2.1.0/src/nmath/gamma.c does not need a pointer ?

What is wrong whit he first set of lines ?

What is the correct way to call the C function in R-2.1.0/src/nmath/gamma.c ?

Thanks in advance

Gilles


From rasche at molgen.mpg.de  Wed Jun 15 13:56:16 2005
From: rasche at molgen.mpg.de (rasche@molgen.mpg.de)
Date: Wed, 15 Jun 2005 13:56:16 +0200 (CEST)
Subject: [Rd] write.table confused by rownames/colnames (PR#7941)
Message-ID: <20050615115616.7477CEC76@slim.kubism.ku.dk>

Full_Name: Axel Rasche
Version: 2.1.0
OS: Win2000
Submission from: (NULL) (141.14.21.81)


Hi,

write.table does not accept the second statement with
    <col.names = NA, row.names = FALSE>.
I do not see why this should not be possible.

test = matrix(1:4, 2, 2, dimnames = list( c("a","b"), c("c","d") ))
write.table(test, file = "test.txt", sep = "\t", quote = FALSE,
	col.names = NA, row.names = FALSE)
write.table(test, file = "test.txt", sep = "\t", quote = FALSE, 
	col.names = NA)
write.table(test, file = "test.txt", sep = "\t", quote = FALSE, 
	col.names = TRUE, row.names = FALSE)
write.table(test, file = "test.txt", sep = "\t", quote = FALSE, 
	col.names = FALSE, row.names = FALSE)

Thanks,
Axel


From MSchwartz at mn.rr.com  Wed Jun 15 14:32:10 2005
From: MSchwartz at mn.rr.com (Marc Schwartz)
Date: Wed, 15 Jun 2005 07:32:10 -0500
Subject: [Rd] R 2.1.1 slated for June 20
In-Reply-To: <1118808521.9457.20.camel@localhost.localdomain>
References: <x264wmbe6m.fsf@turmalin.kubism.ku.dk>
	<Pine.LNX.4.61.0506101407430.4262@gannet.stats>
	<1118773739.3126.4.camel@localhost.localdomain>
	<Pine.LNX.4.61.0506142109440.5934@gannet.stats>
	<1118781268.3126.44.camel@localhost.localdomain>
	<x28y1ca985.fsf@turmalin.kubism.ku.dk>
	<1118787388.3968.19.camel@localhost.localdomain>
	<3BEE2B99-F495-4320-BD7D-242C64F60245@r-project.org>
	<1118808521.9457.20.camel@localhost.localdomain>
Message-ID: <1118838730.9457.25.camel@localhost.localdomain>

On Tue, 2005-06-14 at 23:08 -0500, Marc Schwartz wrote:

<snip>

> In reviewing the Add/Remove Application GUI, gfortran is listed as an
> "Extra Package" in the Development Tools Group.
> 
> g77 is not listed in that Group or in the Legacy Development Group, so
> it would appear that it is a "silent" part of the "Everything"
> installation procedure.
> 
> Removing the offending RPM:
> 
> rpm -e compat-gcc-32-g77-3.2.3-47.fc4

Correction:

I noted that under the Legacy Development Group there is just a general
category for "compat-gcc-32", which upon further review appears to
include the above g77 RPM as well as:

compat-gcc-32-c++-3.2.3-47.fc4
compat-gcc-32-3.2.3-47.fc4

My oversight.

Marc


From ligges at statistik.uni-dortmund.de  Wed Jun 15 14:45:15 2005
From: ligges at statistik.uni-dortmund.de (ligges@statistik.uni-dortmund.de)
Date: Wed, 15 Jun 2005 14:45:15 +0200 (CEST)
Subject: [Rd] italic (PR#7932)
Message-ID: <20050615124515.CCB99A229@slim.kubism.ku.dk>

ggrothendieck at gmail.com wrote:

> Full_Name: G. Grothendieck
> Version: R version 2.1.0, 2005-05-14
> OS: Windows XP
> Submission from: (NULL) (216.59.254.207)
> 
> 
> This code:
> 
> 
>>plot(1:10)
>>text(5,5,lab=expression(italic(22*"33")))

For mathematical non-character-string annotation a math font is used 
that does not support italic/bold/bolditalic/plain.
It seems to be worth adding this information to ?plotmath, such as:
"(only for characters, but not for math font)".

Uwe Ligges


> 
> has the effect of italicizing 33 (which is a character string) but not 22
> (which is not).  I would have thought that both, not just 33, would be
> italicized.
> 
> I had previously posted about this last week:
> 
> https://www.stat.math.ethz.ch/pipermail/r-devel/2005-June/033526.html
> 
> however, no one responded.
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From MSchwartz at mn.rr.com  Wed Jun 15 14:49:38 2005
From: MSchwartz at mn.rr.com (Marc Schwartz)
Date: Wed, 15 Jun 2005 07:49:38 -0500
Subject: [Rd] R 2.1.1 slated for June 20
In-Reply-To: <Pine.LNX.4.61.0506150740430.17433@gannet.stats>
References: <x264wmbe6m.fsf@turmalin.kubism.ku.dk>
	<Pine.LNX.4.61.0506101407430.4262@gannet.stats>
	<1118773739.3126.4.camel@localhost.localdomain>
	<Pine.LNX.4.61.0506142109440.5934@gannet.stats>
	<1118781268.3126.44.camel@localhost.localdomain>
	<x28y1ca985.fsf@turmalin.kubism.ku.dk>
	<1118787388.3968.19.camel@localhost.localdomain>
	<3BEE2B99-F495-4320-BD7D-242C64F60245@r-project.org>
	<1118808521.9457.20.camel@localhost.localdomain>
	<Pine.LNX.4.61.0506150740430.17433@gannet.stats>
Message-ID: <1118839778.9457.33.camel@localhost.localdomain>

On Wed, 2005-06-15 at 07:51 +0100, Prof Brian Ripley wrote:
> Our preference is F77 compilers over F9x ones, as the lists Simon showed 
> reflects - we decided to prefer F95 to F90 in future, though.
> 
> My experience is that g77 from gcc-3.4.x is preferable to gfortran.
> As I said earlier, once gcc-4.0.1 is released (and so R builds with a 
> released version of gcc-4.x.y - 4.0.0 needs worarounds)  I will take a 
> another look.  So far, using gcc-3.4.4 is both faster and more accurate 
> that gcc-4.0.0.  There are a few instances in which loess gives rather 
> different results with gfortran, but they are only visible by diffing
> postscript files.
> 
> I will look into converting blas.f to F77 (but not for this release).

<snip>

I have re-installed g77 and re-compiled from scratch with it.

Unless the FC folks have backported gcc-3.4 updates to gcc-3.2, that
update appears to not be imminent, as the FC devel tree (rawhide) is
still at gcc-3.2.

Best regards,

Marc


From ligges at statistik.uni-dortmund.de  Wed Jun 15 14:52:44 2005
From: ligges at statistik.uni-dortmund.de (ligges@statistik.uni-dortmund.de)
Date: Wed, 15 Jun 2005 14:52:44 +0200 (CEST)
Subject: [Rd] write.table confused by rownames/colnames (PR#7941)
Message-ID: <20050615125244.86455EC75@slim.kubism.ku.dk>

rasche at molgen.mpg.de wrote:

> Full_Name: Axel Rasche
> Version: 2.1.0
> OS: Win2000
> Submission from: (NULL) (141.14.21.81)
> 
> 
> Hi,
> 
> write.table does not accept the second statement with
>     <col.names = NA, row.names = FALSE>.
> I do not see why this should not be possible.
> 
> test = matrix(1:4, 2, 2, dimnames = list( c("a","b"), c("c","d") ))
> write.table(test, file = "test.txt", sep = "\t", quote = FALSE,
> 	col.names = NA, row.names = FALSE)

 From my point of view one should not expect NA to work, but the help 
page says a "logical" is allowed and gives a correpsonding "NA" example, 
hence it is a bug, either in the help page or in the code.
I'd vote for changing the help and depreciating NA for 
col.names/row.names, because I do not know what NA is expected to do and 
therefore I could not provide any bugfix for the code ...

Uwe Ligges




> write.table(test, file = "test.txt", sep = "\t", quote = FALSE, 
> 	col.names = NA)
> write.table(test, file = "test.txt", sep = "\t", quote = FALSE, 
> 	col.names = TRUE, row.names = FALSE)
> write.table(test, file = "test.txt", sep = "\t", quote = FALSE, 
> 	col.names = FALSE, row.names = FALSE)
> 
> Thanks,
> Axel
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From ripley at stats.ox.ac.uk  Wed Jun 15 14:54:15 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed, 15 Jun 2005 13:54:15 +0100 (BST)
Subject: [Rd] write.table confused by rownames/colnames (PR#7941)
In-Reply-To: <20050615115616.7477CEC76@slim.kubism.ku.dk>
References: <20050615115616.7477CEC76@slim.kubism.ku.dk>
Message-ID: <Pine.LNX.4.61.0506151340120.31771@gannet.stats>

It seems that you are the one who is confused: the help file says

      By default there is no column name for a column of row names.  If
      'col.names = NA' a blank column name is added.

If there are no row names, there is no point in adding a blank column name 
for them.  So what did *you* think it would do?

On Wed, 15 Jun 2005 rasche at molgen.mpg.de wrote:

> Full_Name: Axel Rasche
> Version: 2.1.0
> OS: Win2000
> Submission from: (NULL) (141.14.21.81)
>
>
> write.table does not accept the second statement with
>    <col.names = NA, row.names = FALSE>.
> I do not see why this should not be possible.
>
> test = matrix(1:4, 2, 2, dimnames = list( c("a","b"), c("c","d") ))
> write.table(test, file = "test.txt", sep = "\t", quote = FALSE,
> 	col.names = NA, row.names = FALSE)
> write.table(test, file = "test.txt", sep = "\t", quote = FALSE,
> 	col.names = NA)
> write.table(test, file = "test.txt", sep = "\t", quote = FALSE,
> 	col.names = TRUE, row.names = FALSE)
> write.table(test, file = "test.txt", sep = "\t", quote = FALSE,
> 	col.names = FALSE, row.names = FALSE)


-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From rasche at molgen.mpg.de  Wed Jun 15 15:11:07 2005
From: rasche at molgen.mpg.de (rasche@molgen.mpg.de)
Date: Wed, 15 Jun 2005 15:11:07 +0200 (CEST)
Subject: [Rd] write.table confused by rownames/colnames (PR#7941)
Message-ID: <20050615131107.ED296A1E0@slim.kubism.ku.dk>

Hello,

Alright, I did not look at it that way I admit. I built a matrix with 
multiple row names (as a data.frame). Confusion started when exporting 
this as a spread-sheet.
Now it all works fine.

Thanks and sorry for the false alarm,
Axel

Prof Brian Ripley wrote:
> It seems that you are the one who is confused: the help file says
> 
>      By default there is no column name for a column of row names.  If
>      'col.names = NA' a blank column name is added.
> 
> If there are no row names, there is no point in adding a blank column 
> name for them.  So what did *you* think it would do?
> 
> On Wed, 15 Jun 2005 rasche at molgen.mpg.de wrote:
> 
>> Full_Name: Axel Rasche
>> Version: 2.1.0
>> OS: Win2000
>> Submission from: (NULL) (141.14.21.81)
>>
>>
>> write.table does not accept the second statement with
>>    <col.names = NA, row.names = FALSE>.
>> I do not see why this should not be possible.
>>
>> test = matrix(1:4, 2, 2, dimnames = list( c("a","b"), c("c","d") ))
>> write.table(test, file = "test.txt", sep = "\t", quote = FALSE,
>>     col.names = NA, row.names = FALSE)
>> write.table(test, file = "test.txt", sep = "\t", quote = FALSE,
>>     col.names = NA)
>> write.table(test, file = "test.txt", sep = "\t", quote = FALSE,
>>     col.names = TRUE, row.names = FALSE)
>> write.table(test, file = "test.txt", sep = "\t", quote = FALSE,
>>     col.names = FALSE, row.names = FALSE)
> 
> 
> 

-- 
*******************************************
Dipl. Math. ETH Axel Rasche
Max-Planck-Institute for Molecular Genetics
Department Lehrach (Vertebrate Genomics)
Ihnestrasse 63-73
D-14195 Berlin-Dahlem
GERMANY

Tel. ++49-30-8413-1289
Fax  ++49-30-8413-1380


From cyril.humbert at univ-mlv.fr  Wed Jun 15 16:12:58 2005
From: cyril.humbert at univ-mlv.fr (cyril.humbert@univ-mlv.fr)
Date: Wed, 15 Jun 2005 16:12:58 +0200 (CEST)
Subject: [Rd] extra spaces before imag part when printing complex numbers
	(PR#7942)
Message-ID: <20050615141258.D8890A1CF@slim.kubism.ku.dk>

Hello,

When printing sequence of complex numbers, extra spaces
are sometimes printed between real and imaginary part of
each number.

For example:
## R Version 2.1.1 beta (2005-06-13) [Debian unstable, i386]
## and R Version 2.1.0               [Debian unstable, i386]

> print(c(1+1i, 10+1i, 100+1i)) # Ok
[1]   1+1i  10+1i 100+1i 

> print(c(1+1i, 1-10i, 1+100i))
[1] 1+  1i 1- 10i 1+100i
      ^^     ^
  (extra spaces)



The numbers of inserted spaces depends on the imaginary
part which has the largest number of figures:

> print(c(1+1i, 1+12i))
[1] 1+ 1i 1+12i
      ^

> print(c(1+1i, 1+123i)) 
[1] 1+  1i 1+123i
      ^^

> print(c(1+1i, 1+1234i)) 
[1] 1+   1i 1+1234i
      ^^^

Regards,

-- 
Cyril


From ripley at stats.ox.ac.uk  Wed Jun 15 16:44:00 2005
From: ripley at stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Wed, 15 Jun 2005 16:44:00 +0200 (CEST)
Subject: [Rd] (PR#7942) extra spaces before imag part when printing
Message-ID: <20050615144400.1FE96A1F9@slim.kubism.ku.dk>

This is intentional: it aligns the numbers.  E.g.

> options(width=12)
> print(c(1+1i, 1-10i, 1+100i))
[1] 1+  1i
[2] 1- 10i
[3] 1+100i

Neat, eh?

What made you think this was a bug?

On Wed, 15 Jun 2005 cyril.humbert at univ-mlv.fr wrote:

> Hello,
>
> When printing sequence of complex numbers, extra spaces
> are sometimes printed between real and imaginary part of
> each number.
>
> For example:
> ## R Version 2.1.1 beta (2005-06-13) [Debian unstable, i386]
> ## and R Version 2.1.0               [Debian unstable, i386]
>
>> print(c(1+1i, 10+1i, 100+1i)) # Ok
> [1]   1+1i  10+1i 100+1i
>
>> print(c(1+1i, 1-10i, 1+100i))
> [1] 1+  1i 1- 10i 1+100i
>      ^^     ^
>  (extra spaces)
>
>
>
> The numbers of inserted spaces depends on the imaginary
> part which has the largest number of figures:
>
>> print(c(1+1i, 1+12i))
> [1] 1+ 1i 1+12i
>      ^
>
>> print(c(1+1i, 1+123i))
> [1] 1+  1i 1+123i
>      ^^
>
>> print(c(1+1i, 1+1234i))
> [1] 1+   1i 1+1234i
>      ^^^

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From ripley at stats.ox.ac.uk  Wed Jun 15 17:14:55 2005
From: ripley at stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Wed, 15 Jun 2005 17:14:55 +0200 (CEST)
Subject: [Rd] italic (PR#7932)
Message-ID: <20050615151455.6A9FAA1F9@slim.kubism.ku.dk>

On Wed, 15 Jun 2005 ligges at statistik.uni-dortmund.de wrote:

> ggrothendieck at gmail.com wrote:
>
>> Full_Name: G. Grothendieck
>> Version: R version 2.1.0, 2005-05-14
>> OS: Windows XP
>> Submission from: (NULL) (216.59.254.207)
>>
>>
>> This code:
>>
>>
>>> plot(1:10)
>>> text(5,5,lab=expression(italic(22*"33")))
>
> For mathematical non-character-string annotation a math font is used
> that does not support italic/bold/bolditalic/plain.
> It seems to be worth adding this information to ?plotmath, such as:
> "(only for characters, but not for math font)".

I don't think that is true: plotmath uses the same 5 fontfaces as any 
other form of graph annotation.  The reason was staring Grothendieck
in the face: the code is

static BBOX RenderNumber(SEXP expr, int draw, mathContext *mc,
 			 R_GE_gcontext *gc, GEDevDesc *dd)
{
     BBOX bbox;
     FontType prevfont = SetFont(PlainFont, gc);
     bbox = RenderStr(CHAR(asChar(expr)), draw, mc, gc, dd);
     SetFont(prevfont, gc);
     return bbox;
}

so it is by design.  Numeric constants are always in PlainFont.

>> has the effect of italicizing 33 (which is a character string) but not 22
>> (which is not).  I would have thought that both, not just 33, would be
>> italicized.

(We do ask people to actually do the thinking before posting a bug 
report.)

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From ggrothendieck at gmail.com  Wed Jun 15 17:30:10 2005
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Wed, 15 Jun 2005 11:30:10 -0400
Subject: [Rd] italic (PR#7932)
In-Reply-To: <20050615151455.6A9FAA1F9@slim.kubism.ku.dk>
References: <20050615151455.6A9FAA1F9@slim.kubism.ku.dk>
Message-ID: <971536df05061508304b37aaba@mail.gmail.com>

On 6/15/05, ripley at stats.ox.ac.uk <ripley at stats.ox.ac.uk> wrote:
> On Wed, 15 Jun 2005 ligges at statistik.uni-dortmund.de wrote:
> 
> > ggrothendieck at gmail.com wrote:
> >
> >> Full_Name: G. Grothendieck
> >> Version: R version 2.1.0, 2005-05-14
> >> OS: Windows XP
> >> Submission from: (NULL) (216.59.254.207)
> >>
> >>
> >> This code:
> >>
> >>
> >>> plot(1:10)
> >>> text(5,5,lab=expression(italic(22*"33")))
> >
> > For mathematical non-character-string annotation a math font is used
> > that does not support italic/bold/bolditalic/plain.
> > It seems to be worth adding this information to ?plotmath, such as:
> > "(only for characters, but not for math font)".
> 
> I don't think that is true: plotmath uses the same 5 fontfaces as any
> other form of graph annotation.  The reason was staring Grothendieck
> in the face: the code is
> 
> static BBOX RenderNumber(SEXP expr, int draw, mathContext *mc,
>                         R_GE_gcontext *gc, GEDevDesc *dd)
> {
>     BBOX bbox;
>     FontType prevfont = SetFont(PlainFont, gc);
>     bbox = RenderStr(CHAR(asChar(expr)), draw, mc, gc, dd);
>     SetFont(prevfont, gc);
>     return bbox;
> }
> 
> so it is by design.  Numeric constants are always in PlainFont.

What is the rationale this?


From gilles.guillot at inapg.inra.fr  Wed Jun 15 17:49:33 2005
From: gilles.guillot at inapg.inra.fr (Gilles GUILLOT)
Date: Wed, 15 Jun 2005 17:49:33 +0200
Subject: [Rd] Calling C from Fortran
In-Reply-To: <D9A95B4B7B20354992E165EEADA31999056A9490@uswpmx00.merck.com>
References: <D9A95B4B7B20354992E165EEADA31999056A9490@uswpmx00.merck.com>
Message-ID: <200506151749.33594.gilles.guillot@inapg.inra.fr>

Thanks for your reply.

Am I write if I say that the wrapper shoul be 
double F77_SUB(mygammafn)(double *x) { return gammafn(*x); }

instead of 
double F77_SUB(mygammafn)(double *x) { return gammafn(x); }

the first does not compile.
wrapper2.c: In function `mygammafn_':
wrapper2.c:6: error: incompatible type for argument 1 of `Rf_gammafn'

The second compiles and works fine.


But still,  I find it very strange as the C function gammafn actually called 
( as I can see from /R-2.1.0/src/nmath/gamma.c)
is not defined as
double gammafn(double *x)

but as
double gammafn(double x)

Am I missing something ?

Gilles 


Le Mercredi 15 Juin 2005 17:06, vous avez ?crit :
> I actually deleted a part of my reply, dealing with exactly that. Sorry!
> You need to declare the C wrapper to take a pointer to a double ("double
> *") rather than a double. C passes by value whereas Fortran passes by
> reference; in C you get this effect by passing a pointer to the value
> (which is also a value). So you want
>
> double F77_SUB(mygammafn)(double *x) { return gammafn(x); }
>
> That should work; if not let me know and I'll look more carefully at
> Fortran <-> C conventions.
>
> Reid Huntsinger
>
> -----Original Message-----
> From: Gilles GUILLOT [mailto:gilles.guillot at inapg.inra.fr]
> Sent: Wednesday, June 15, 2005 3:50 AM
> To: Huntsinger, Reid
> Subject: Re: [Rd] Calling C from Fortran
>
>
> Thanks Reid!
> And now if I want to call a C function with arguments,
> e.g. to compute the gamma function at x,
> my C wrapper is:
>
> #include <R.h>
> #include <Rmath.h>
> void F77_SUB(rndstart)(void) { GetRNGstate(); }
> void F77_SUB(rndend)(void) { PutRNGstate(); }
> double F77_SUB(normrnd)(void) { return norm_rand(); }
> double F77_SUB(mygammafn)(double x) { return gammafn(x); }
>
> And my Fortran is:
>     subroutine testit()
>      implicit none
>      double precision normrnd, x, y, mygammafn
>       call rndstart()
>       x = dabs(normrnd())
>       write(*,*) 'x=',x
>       call rndend()
>
>       y = mygammafn(x)
>       write(*,*) 'y=',y
>       end
>
> And it does not work, all calls of testit return the same y value.
> What is incorrect in my files ?
>
>
> Gilles
>
>
>
>
>
> ---------------------------------------------------------------------------
>--- Notice:  This e-mail message, together with any attachments, contains
> information of Merck & Co., Inc. (One Merck Drive, Whitehouse Station, New
> Jersey, USA 08889), and/or its affiliates (which may be known outside the
> United States as Merck Frosst, Merck Sharp & Dohme or MSD and in Japan, as
> Banyu) that may be confidential, proprietary copyrighted and/or legally
> privileged. It is intended solely for the use of the individual or entity
> named on this message.  If you are not the intended recipient, and have
> received this message in error, please notify us immediately by reply
> e-mail and then delete it from your system.
> ---------------------------------------------------------------------------
>---

-- 
_________________________________________________________________________
Gilles GUILLOT

INRA -D?partement Math?matiques et Informatique Appliqu?es
Unit? Mixte de Recherche INRA - INAPG - ENGREF

Institut National Agronomique de Paris-Grignon
16, rue Claude Bernard
75231 Paris cedex 5 France

phone 33 1 44 08 18 42
fax   33 1 44 08 16 66
http://www.inapg.fr/ens_rech/mathinfo/personnel/guillot/welcome.html


From cyril.humbert at univ-mlv.fr  Wed Jun 15 18:51:21 2005
From: cyril.humbert at univ-mlv.fr (cyril.humbert@univ-mlv.fr)
Date: Wed, 15 Jun 2005 18:51:21 +0200 (CEST)
Subject: [Rd] (PR#7942) extra spaces before imag part when printing
	complex numbers
Message-ID: <20050615165121.DF036A1ED@slim.kubism.ku.dk>

Prof Brian Ripley wrote:
> This is intentional: it aligns the numbers.  E.g.
> 
> >options(width=12)
> >print(c(1+1i, 1-10i, 1+100i))
> [1] 1+  1i
> [2] 1- 10i
> [3] 1+100i
> 
> Neat, eh?
> 
> What made you think this was a bug?


Ah ok, I've misunderstood this feature probably perhaps
because, at first sight, I found the display looks "strange"
when some of the numbers have large imaginary parts as it
tends to make the delimitation between columns of numbers
less visible. E.g.,

> options(width=80)
> print(rep(c(1+1i, 1-1i, 1+1000i), 8))

And if there's less than a line of numbers I find it's
more natural to write :

>  print(c(1+1i, 1-1i, 1+1000i))
[1] 1+1i 1-1i 1+1000i

instead of what is actually printed :
[1] 1+   1i 1-   1i 1+1000i


Anyway, sorry this "bug" report.



> On Wed, 15 Jun 2005 cyril.humbert at univ-mlv.fr wrote:
> 
> >Hello,
> >
> >When printing sequence of complex numbers, extra spaces
> >are sometimes printed between real and imaginary part of
> >each number.
> >
> >For example:
> >## R Version 2.1.1 beta (2005-06-13) [Debian unstable, i386]
> >## and R Version 2.1.0               [Debian unstable, i386]
> >
> >>print(c(1+1i, 10+1i, 100+1i)) # Ok
> >[1]   1+1i  10+1i 100+1i
> >
> >>print(c(1+1i, 1-10i, 1+100i))
> >[1] 1+  1i 1- 10i 1+100i
> >     ^^     ^
> > (extra spaces)

-- 
Cyril


From tplate at blackmesacapital.com  Wed Jun 15 20:49:52 2005
From: tplate at blackmesacapital.com (tplate@blackmesacapital.com)
Date: Wed, 15 Jun 2005 20:49:52 +0200 (CEST)
Subject: [Rd] documentation enhancement: Note in ?seek for Windows (PR#7943)
Message-ID: <20050615184952.38BBFA1C4@slim.kubism.ku.dk>

[I started a new bug report for this issue because it was not the 
primary issue in the original discussion, which was PR#7899]

ligges at statistik.uni-dortmund.de wrote:
 > Tony Plate wrote:
 > [snip]
 >>ligges at statistik.uni-dortmund.de wrote:
 >>[snip]
 >>>Note that ?seek currently tells us "The value returned by
 >>>seek(where=NA) appears to be unreliable on Windows systems, at least
 >>>for text files."
 >>>It would be nice if this comment could be removed, of course ....
 >>
 >>
 >>May the explanation could be given that this happens with text files
 >>because Windows inserts extra characters at end-of-lines when reading
 >>"text" mode files (but with binary files, things should be fine.) This
 >>particular issue is documented in Microsoft Windows documentation (e.g.,
 >>at http://msdn2.microsoft.com/library/75yw9bf3(en-us,vs.80).aspx, found
 >>by searching on Google using the terms "fseek windows documentation").
 >>Are there any known issues using seek with binary files under Windows?
 >>If there are not, then the caveat could be made specific to text files
 >>and all vagueness removed.
 >
 >
 > Hmm, all I find (including your link) is Windows CE related ...
 >
 > Uwe Ligges

For the record, the documentation I pointed to is for Windows 2000 etc, 
and is not just related to Windows CE (Uwe retracted that claim in a 
private email).

So, the suggestion to refine the note in ?seek stands.  Perhaps 
src/library/base/man/seek.Rd could be changed as follows:

OLD:

#ifdef windows
   The value returned by \code{seek(where=NA)} appears to be unreliable
   on Windows systems, at least for text files.  Clipboard connections
   can seek too.
#endif

NEW:

#ifdef windows
   The value returned by \code{seek()} is unreliable
   on Windows systems for text files.  This is because the Windows
   file-I/O functions can insert extra characters at end-of-lines
   when working with text mode files.  Binary mode files should not
   be affected by this issue.  Clipboard connections can seek too.
#endif

Of course, if someone knows that the return value of seek() is 
unreliable on Windows for binary files, this documentation change is 
innappropriate (and then the documentation should probably be changed 
from "appears to be unreliable, at least for text files" to "is 
unreliable, for both binary and text files".

-- Tony Plate


From ripley at stats.ox.ac.uk  Wed Jun 15 21:00:22 2005
From: ripley at stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Wed, 15 Jun 2005 21:00:22 +0200 (CEST)
Subject: [Rd] (PR#7943)  documentation enhancement: Note in ?seek for
Message-ID: <20050615190022.96BCDA1C4@slim.kubism.ku.dk>

I think the proposed change is appropriate only if the return value is 
*known* to be reliable for binary files.

I for one do not trust the writers of an OS whom have made such a serious 
error in one mode (and many other errors elsewhere) not to have made one 
in closely related code.  Since it is not Open Source, we cannot find out.

On Wed, 15 Jun 2005 tplate at blackmesacapital.com wrote:

> [I started a new bug report for this issue because it was not the
> primary issue in the original discussion, which was PR#7899]
>
> ligges at statistik.uni-dortmund.de wrote:
> > Tony Plate wrote:
> > [snip]
> >>ligges at statistik.uni-dortmund.de wrote:
> >>[snip]
> >>>Note that ?seek currently tells us "The value returned by
> >>>seek(where=NA) appears to be unreliable on Windows systems, at least
> >>>for text files."
> >>>It would be nice if this comment could be removed, of course ....
> >>
> >>
> >>May the explanation could be given that this happens with text files
> >>because Windows inserts extra characters at end-of-lines when reading
> >>"text" mode files (but with binary files, things should be fine.) This
> >>particular issue is documented in Microsoft Windows documentation (e.g.,
> >>at http://msdn2.microsoft.com/library/75yw9bf3(en-us,vs.80).aspx, found
> >>by searching on Google using the terms "fseek windows documentation").
> >>Are there any known issues using seek with binary files under Windows?
> >>If there are not, then the caveat could be made specific to text files
> >>and all vagueness removed.
> >
> >
> > Hmm, all I find (including your link) is Windows CE related ...
> >
> > Uwe Ligges
>
> For the record, the documentation I pointed to is for Windows 2000 etc,
> and is not just related to Windows CE (Uwe retracted that claim in a
> private email).
>
> So, the suggestion to refine the note in ?seek stands.  Perhaps
> src/library/base/man/seek.Rd could be changed as follows:
>
> OLD:
>
> #ifdef windows
>   The value returned by \code{seek(where=NA)} appears to be unreliable
>   on Windows systems, at least for text files.  Clipboard connections
>   can seek too.
> #endif
>
> NEW:
>
> #ifdef windows
>   The value returned by \code{seek()} is unreliable
>   on Windows systems for text files.  This is because the Windows
>   file-I/O functions can insert extra characters at end-of-lines
>   when working with text mode files.  Binary mode files should not
>   be affected by this issue.  Clipboard connections can seek too.
> #endif
>
> Of course, if someone knows that the return value of seek() is
> unreliable on Windows for binary files, this documentation change is
> innappropriate (and then the documentation should probably be changed
> from "appears to be unreliable, at least for text files" to "is
> unreliable, for both binary and text files".
>
> -- Tony Plate
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From ripley at stats.ox.ac.uk  Wed Jun 15 21:09:55 2005
From: ripley at stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Wed, 15 Jun 2005 21:09:55 +0200 (CEST)
Subject: [Rd] (PR#7943)  documentation enhancement: Note in ?seek for
Message-ID: <20050615190955.5B60BA1C4@slim.kubism.ku.dk>

Actually, there is a known issue: it is often wrong for binary files 
opened in append mode, and we have caught by that too.  So those writers 
did make the sort of error I did not trust them not to make.

On Wed, 15 Jun 2005, Prof Brian Ripley wrote:

> I think the proposed change is appropriate only if the return value is 
> *known* to be reliable for binary files.
>
> I for one do not trust the writers of an OS whom have made such a serious 
> error in one mode (and many other errors elsewhere) not to have made one in 
> closely related code.  Since it is not Open Source, we cannot find out.
>
> On Wed, 15 Jun 2005 tplate at blackmesacapital.com wrote:
>
>> [I started a new bug report for this issue because it was not the
>> primary issue in the original discussion, which was PR#7899]
>> 
>> ligges at statistik.uni-dortmund.de wrote:
>> > Tony Plate wrote:
>> > [snip]
>> >>ligges at statistik.uni-dortmund.de wrote:
>> >>[snip]
>> >>>Note that ?seek currently tells us "The value returned by
>> >>>seek(where=NA) appears to be unreliable on Windows systems, at least
>> >>>for text files."
>> >>>It would be nice if this comment could be removed, of course ....
>> >>
>> >>
>> >>May the explanation could be given that this happens with text files
>> >>because Windows inserts extra characters at end-of-lines when reading
>> >>"text" mode files (but with binary files, things should be fine.) This
>> >>particular issue is documented in Microsoft Windows documentation (e.g.,
>> >>at http://msdn2.microsoft.com/library/75yw9bf3(en-us,vs.80).aspx, found
>> >>by searching on Google using the terms "fseek windows documentation").
>> >>Are there any known issues using seek with binary files under Windows?
>> >>If there are not, then the caveat could be made specific to text files
>> >>and all vagueness removed.
>> >
>> >
>> > Hmm, all I find (including your link) is Windows CE related ...
>> >
>> > Uwe Ligges
>> 
>> For the record, the documentation I pointed to is for Windows 2000 etc,
>> and is not just related to Windows CE (Uwe retracted that claim in a
>> private email).
>> 
>> So, the suggestion to refine the note in ?seek stands.  Perhaps
>> src/library/base/man/seek.Rd could be changed as follows:
>> 
>> OLD:
>> 
>> #ifdef windows
>>   The value returned by \code{seek(where=NA)} appears to be unreliable
>>   on Windows systems, at least for text files.  Clipboard connections
>>   can seek too.
>> #endif
>> 
>> NEW:
>> 
>> #ifdef windows
>>   The value returned by \code{seek()} is unreliable
>>   on Windows systems for text files.  This is because the Windows
>>   file-I/O functions can insert extra characters at end-of-lines
>>   when working with text mode files.  Binary mode files should not
>>   be affected by this issue.  Clipboard connections can seek too.
>> #endif
>> 
>> Of course, if someone knows that the return value of seek() is
>> unreliable on Windows for binary files, this documentation change is
>> innappropriate (and then the documentation should probably be changed
>> from "appears to be unreliable, at least for text files" to "is
>> unreliable, for both binary and text files".
>> 
>> -- Tony Plate
>> 
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>> 
>> 
>
> -- 
> Brian D. Ripley,                  ripley at stats.ox.ac.uk
> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> University of Oxford,             Tel:  +44 1865 272861 (self)
> 1 South Parks Road,                     +44 1865 272866 (PA)
> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From reid_huntsinger at merck.com  Wed Jun 15 21:21:30 2005
From: reid_huntsinger at merck.com (Huntsinger, Reid)
Date: Wed, 15 Jun 2005 15:21:30 -0400
Subject: [Rd] Calling C from Fortran
Message-ID: <D9A95B4B7B20354992E165EEADA31999056A9495@uswpmx00.merck.com>

(Forgot to post.) Yes, that was a typo, and the reason is the same; the C
function expects a value rather than its address. That's why you can't use
it directly from Fortran (aside from naming issues) but it's fine in C.

Reid Huntsinger

-----Original Message-----
From: Gilles GUILLOT [mailto:gilles.guillot at inapg.inra.fr] 
Sent: Wednesday, June 15, 2005 11:50 AM
To: R-devel at lists.R-project.org
Cc: Huntsinger, Reid
Subject: Re: [Rd] Calling C from Fortran


Thanks for your reply.

Am I write if I say that the wrapper shoul be 
double F77_SUB(mygammafn)(double *x) { return gammafn(*x); }

instead of 
double F77_SUB(mygammafn)(double *x) { return gammafn(x); }

the first does not compile.
wrapper2.c: In function `mygammafn_':
wrapper2.c:6: error: incompatible type for argument 1 of `Rf_gammafn'

The second compiles and works fine.


But still,  I find it very strange as the C function gammafn actually called

( as I can see from /R-2.1.0/src/nmath/gamma.c)
is not defined as
double gammafn(double *x)

but as
double gammafn(double x)

Am I missing something ?

Gilles 


Le Mercredi 15 Juin 2005 17:06, vous avez ?crit :
> I actually deleted a part of my reply, dealing with exactly that. Sorry!
> You need to declare the C wrapper to take a pointer to a double ("double
> *") rather than a double. C passes by value whereas Fortran passes by
> reference; in C you get this effect by passing a pointer to the value
> (which is also a value). So you want
>
> double F77_SUB(mygammafn)(double *x) { return gammafn(x); }
>
> That should work; if not let me know and I'll look more carefully at
> Fortran <-> C conventions.
>
> Reid Huntsinger
>
> -----Original Message-----
> From: Gilles GUILLOT [mailto:gilles.guillot at inapg.inra.fr]
> Sent: Wednesday, June 15, 2005 3:50 AM
> To: Huntsinger, Reid
> Subject: Re: [Rd] Calling C from Fortran
>
>
> Thanks Reid!
> And now if I want to call a C function with arguments,
> e.g. to compute the gamma function at x,
> my C wrapper is:
>
> #include <R.h>
> #include <Rmath.h>
> void F77_SUB(rndstart)(void) { GetRNGstate(); }
> void F77_SUB(rndend)(void) { PutRNGstate(); }
> double F77_SUB(normrnd)(void) { return norm_rand(); }
> double F77_SUB(mygammafn)(double x) { return gammafn(x); }
>
> And my Fortran is:
>     subroutine testit()
>      implicit none
>      double precision normrnd, x, y, mygammafn
>       call rndstart()
>       x = dabs(normrnd())
>       write(*,*) 'x=',x
>       call rndend()
>
>       y = mygammafn(x)
>       write(*,*) 'y=',y
>       end
>
> And it does not work, all calls of testit return the same y value.
> What is incorrect in my files ?
>
>
> Gilles
>
>
>
>
>
>
---------------------------------------------------------------------------
>--- Notice:  This e-mail message, together with any attachments, contains
> information of Merck & Co., Inc. (One Merck Drive, Whitehouse Station, New
> Jersey, USA 08889), and/or its affiliates (which may be known outside the
> United States as Merck Frosst, Merck Sharp & Dohme or MSD and in Japan, as
> Banyu) that may be confidential, proprietary copyrighted and/or legally
> privileged. It is intended solely for the use of the individual or entity
> named on this message.  If you are not the intended recipient, and have
> received this message in error, please notify us immediately by reply
> e-mail and then delete it from your system.
>
---------------------------------------------------------------------------
>---

-- 
_________________________________________________________________________
Gilles GUILLOT

INRA -D?partement Math?matiques et Informatique Appliqu?es
Unit? Mixte de Recherche INRA - INAPG - ENGREF

Institut National Agronomique de Paris-Grignon
16, rue Claude Bernard
75231 Paris cedex 5 France

phone 33 1 44 08 18 42
fax   33 1 44 08 16 66
http://www.inapg.fr/ens_rech/mathinfo/personnel/guillot/welcome.html


From tplate at blackmesacapital.com  Wed Jun 15 21:25:10 2005
From: tplate at blackmesacapital.com (tplate@blackmesacapital.com)
Date: Wed, 15 Jun 2005 21:25:10 +0200 (CEST)
Subject: [Rd] (PR#7943) documentation enhancement: Note in ?seek for
	Windows
Message-ID: <20050615192510.9A0B9A1DA@slim.kubism.ku.dk>

Fair enough.  But for the benefit of the unfortunate souls having to 
work in Windows, it would be nice if the documentation were as explicit 
as possible about what is and is not known about particular issues 
(while still being concise).  How about the following:

NEW:

#ifdef windows
   The value returned by \code{seek()} is known to be unreliable
   on Windows systems for text mode files.  The Windows documentation
   states that the return values from Windows OS seek functions for
   text mode files are unreliable (because the Windows file-I/O
   functions can insert extra characters at end-of-lines when working
   with text mode files.) Binary mode files should not be affected by
   this particular issue, but there are known problems on Windows
   systems with the reliability of the return value from \code{seek()}
   for binary mode files opened in append mode.  Clipboard connections
   can seek too.
#endif

Tony Plate


Prof Brian Ripley wrote:
> I think the proposed change is appropriate only if the return value is 
> *known* to be reliable for binary files.
> 
> I for one do not trust the writers of an OS whom have made such a 
> serious error in one mode (and many other errors elsewhere) not to have 
> made one in closely related code.  Since it is not Open Source, we 
> cannot find out.
> 
> On Wed, 15 Jun 2005 tplate at blackmesacapital.com wrote:
> 
>> [I started a new bug report for this issue because it was not the
>> primary issue in the original discussion, which was PR#7899]
>>
>> ligges at statistik.uni-dortmund.de wrote:
>> > Tony Plate wrote:
>> > [snip]
>> >>ligges at statistik.uni-dortmund.de wrote:
>> >>[snip]
>> >>>Note that ?seek currently tells us "The value returned by
>> >>>seek(where=NA) appears to be unreliable on Windows systems, at least
>> >>>for text files."
>> >>>It would be nice if this comment could be removed, of course ....
>> >>
>> >>
>> >>May the explanation could be given that this happens with text files
>> >>because Windows inserts extra characters at end-of-lines when reading
>> >>"text" mode files (but with binary files, things should be fine.) This
>> >>particular issue is documented in Microsoft Windows documentation 
>> (e.g.,
>> >>at http://msdn2.microsoft.com/library/75yw9bf3(en-us,vs.80).aspx, found
>> >>by searching on Google using the terms "fseek windows documentation").
>> >>Are there any known issues using seek with binary files under Windows?
>> >>If there are not, then the caveat could be made specific to text files
>> >>and all vagueness removed.
>> >
>> >
>> > Hmm, all I find (including your link) is Windows CE related ...
>> >
>> > Uwe Ligges
>>
>> For the record, the documentation I pointed to is for Windows 2000 etc,
>> and is not just related to Windows CE (Uwe retracted that claim in a
>> private email).
>>
>> So, the suggestion to refine the note in ?seek stands.  Perhaps
>> src/library/base/man/seek.Rd could be changed as follows:
>>
>> OLD:
>>
>> #ifdef windows
>>   The value returned by \code{seek(where=NA)} appears to be unreliable
>>   on Windows systems, at least for text files.  Clipboard connections
>>   can seek too.
>> #endif
>>
>> NEW:
>>
>> #ifdef windows
>>   The value returned by \code{seek()} is unreliable
>>   on Windows systems for text files.  This is because the Windows
>>   file-I/O functions can insert extra characters at end-of-lines
>>   when working with text mode files.  Binary mode files should not
>>   be affected by this issue.  Clipboard connections can seek too.
>> #endif
>>
>> Of course, if someone knows that the return value of seek() is
>> unreliable on Windows for binary files, this documentation change is
>> innappropriate (and then the documentation should probably be changed
>> from "appears to be unreliable, at least for text files" to "is
>> unreliable, for both binary and text files".
>>
>> -- Tony Plate
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>>
>


From hb at maths.lth.se  Wed Jun 15 22:43:33 2005
From: hb at maths.lth.se (Henrik Bengtsson)
Date: Wed, 15 Jun 2005 22:43:33 +0200
Subject: [Rd] \section{Windows}{...} instead of #ifdef windows ... #endif?
 (Was: Re: (PR#7943) documentation ...)
In-Reply-To: <20050615192510.9A0B9A1DA@slim.kubism.ku.dk>
References: <20050615192510.9A0B9A1DA@slim.kubism.ku.dk>
Message-ID: <42B092F5.8020403@maths.lth.se>

Just a comment, that probably applies to a lot more Rd files; when 
trying to developer cross-platform R code, it is very useful to have 
identical documentation whatever platform you are working on.  That is, 
I would prefer

\section{Windows-specific comments}{
   ...
}

rather than

#ifdef windows
   ...
#endif

This would make it possible to write more robust code (without looking 
at the source docs).

/Henrik


tplate at blackmesacapital.com wrote:
> Fair enough.  But for the benefit of the unfortunate souls having to 
> work in Windows, it would be nice if the documentation were as explicit 
> as possible about what is and is not known about particular issues 
> (while still being concise).  How about the following:
> 
> NEW:
> 
> #ifdef windows
>    The value returned by \code{seek()} is known to be unreliable
>    on Windows systems for text mode files.  The Windows documentation
>    states that the return values from Windows OS seek functions for
>    text mode files are unreliable (because the Windows file-I/O
>    functions can insert extra characters at end-of-lines when working
>    with text mode files.) Binary mode files should not be affected by
>    this particular issue, but there are known problems on Windows
>    systems with the reliability of the return value from \code{seek()}
>    for binary mode files opened in append mode.  Clipboard connections
>    can seek too.
> #endif
> 
> Tony Plate
> 
> 
> Prof Brian Ripley wrote:
> 
>>I think the proposed change is appropriate only if the return value is 
>>*known* to be reliable for binary files.
>>
>>I for one do not trust the writers of an OS whom have made such a 
>>serious error in one mode (and many other errors elsewhere) not to have 
>>made one in closely related code.  Since it is not Open Source, we 
>>cannot find out.
>>
>>On Wed, 15 Jun 2005 tplate at blackmesacapital.com wrote:
>>
>>
>>>[I started a new bug report for this issue because it was not the
>>>primary issue in the original discussion, which was PR#7899]
>>>
>>>ligges at statistik.uni-dortmund.de wrote:
>>>
>>>>Tony Plate wrote:
>>>>[snip]
>>>>
>>>>>ligges at statistik.uni-dortmund.de wrote:
>>>>>[snip]
>>>>>
>>>>>>Note that ?seek currently tells us "The value returned by
>>>>>>seek(where=NA) appears to be unreliable on Windows systems, at least
>>>>>>for text files."
>>>>>>It would be nice if this comment could be removed, of course ....
>>>>>
>>>>>
>>>>>May the explanation could be given that this happens with text files
>>>>>because Windows inserts extra characters at end-of-lines when reading
>>>>>"text" mode files (but with binary files, things should be fine.) This
>>>>>particular issue is documented in Microsoft Windows documentation 
>>>
>>>(e.g.,
>>>
>>>>>at http://msdn2.microsoft.com/library/75yw9bf3(en-us,vs.80).aspx, found
>>>>>by searching on Google using the terms "fseek windows documentation").
>>>>>Are there any known issues using seek with binary files under Windows?
>>>>>If there are not, then the caveat could be made specific to text files
>>>>>and all vagueness removed.
>>>>
>>>>
>>>>Hmm, all I find (including your link) is Windows CE related ...
>>>>
>>>>Uwe Ligges
>>>
>>>For the record, the documentation I pointed to is for Windows 2000 etc,
>>>and is not just related to Windows CE (Uwe retracted that claim in a
>>>private email).
>>>
>>>So, the suggestion to refine the note in ?seek stands.  Perhaps
>>>src/library/base/man/seek.Rd could be changed as follows:
>>>
>>>OLD:
>>>
>>>#ifdef windows
>>>  The value returned by \code{seek(where=NA)} appears to be unreliable
>>>  on Windows systems, at least for text files.  Clipboard connections
>>>  can seek too.
>>>#endif
>>>
>>>NEW:
>>>
>>>#ifdef windows
>>>  The value returned by \code{seek()} is unreliable
>>>  on Windows systems for text files.  This is because the Windows
>>>  file-I/O functions can insert extra characters at end-of-lines
>>>  when working with text mode files.  Binary mode files should not
>>>  be affected by this issue.  Clipboard connections can seek too.
>>>#endif
>>>
>>>Of course, if someone knows that the return value of seek() is
>>>unreliable on Windows for binary files, this documentation change is
>>>innappropriate (and then the documentation should probably be changed
>>>from "appears to be unreliable, at least for text files" to "is
>>>unreliable, for both binary and text files".
>>>
>>>-- Tony Plate
>>>
>>>______________________________________________
>>>R-devel at r-project.org mailing list
>>>https://stat.ethz.ch/mailman/listinfo/r-devel
>>>
>>>
>>
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
>


From thomas_mandino at turmail.com  Wed Jun 15 22:47:20 2005
From: thomas_mandino at turmail.com (thomas_mandino@turmail.com)
Date: Wed, 15 Jun 2005 22:47:20 +0200 (CEST)
Subject: [Rd] Eilig Geschaftsvorschlag (PR#7944)
Message-ID: <20050615204720.39063A1DA@slim.kubism.ku.dk>



Geschaftsvorschlag.

Zuerst mu? ich um Ihre Zuversicht in dieser
verhandlung bitten,dies ist auf Grund seiner lage, als
das sein total VERTRAULICH und Geheimnisvoll.

Aber ich wei?,da? eine verhandlung dieses Ausma?es
irgendeinen ?ngstlich und besorgt machen wird,aber ich
versichre Ihnen,da? alles am Ende des tages in ordnung
sein wird.

Wir haben uns entschieden Sie durch eine E-mail
sendung,wegen der Dringlichkeit diese verhandlung zu
erreichen,als wir davon zuverlassig von seiner
schnelligkeit und vertraulichkeit ?berzeugt worden
sind.

Ich m?chte mich nun vorstellen. Ich bin Herr Thomas
Mandino(Rechnungpr?fer bei der Imperial Bank von S?d
Afrika).

Ich kam zu ihrem kontakt in meiner pers?nlichen suche
nach einer zuverlassigen und anstandige person,um eine
sehr vertrauliche verhandlung zu erledigen,die,die
?bertragung von einem fremden Konto das maximale
zuversicht erfordert.

Der vorschlag:Ein Ausl?ndische,verstorbener Ingenieur
Menfred Becker, ein Diamante Unternehmer mit der
Bundes Regierung von S?d Afrika.

Er war bis seinem Tod vor drei jahren in einem
Flugzeug absturz,als unternehmer bei der Regierung
tatig. Herr Becker war unser kunde hier bei der
Imperial Bank von S?d Afrika und hatte ein Konto
guthaben von US$18,5 milliarde(Achtzehn milliarde,f?nf
hundert Tausend United States Dollar.)welches die Bank
jetzt fraglos erwartet,durch seine verwandten das Sie
sich melden,wenn Sie sich nicht melden wird alles zu
einem Afrikanischen vertrauens fond f?r waffen und
munitionsbesorgungen bei einer freiheitsbewegung hier
in AfriKa gespendet.

Leidenschaftliche wertvolle Anstrengungen werden durch
die Imperial - Bank gemacht,um einen kontakt mit
jemanden von der Becker familie oder verwandten zu
bekommen.Es hat aber bis jetzt keinen Erfolg gegeben.

Es ist wegen der wahrgenommen moglichkeit keinen
verwandten der Becker zu finden(er hatte keine frau
und kinder)da? das management der eine Anordnung f?r
den fond als nicht zubehaupten deklariert
werden,sollte, und dann zum vertrauens-fond f?r waffen
und munition bersorgung ausgeben,die dem kurs vom
krieg in Afrika gespendet wird.

Um dieser negative Entwicklung abzuwenden,haben ich
und einige meiner bew?hrten kollegen in der Bank
beschlossen das Geld nach Ihre zustimmung zu
?berweisen und suchen jetzt Ihre Erlaubnis das Sie
sich als verwandter des verstorbenen Ing.Manfred
Becker deklarieren,damit der Fond in der h?he von
USD$18,5m infolgendessen als der Nutznie?er(Verwandter
des Becker)auf Ihr Bank Konto ?berwiesen werden.

Alle beurkundungen und Beweist die Ihnen erm?glichen
diese Fonds zu behaupten werden wir zu Ihrer verf?gung
stellen,damit alles gut verl?uft und wir versicheren
Ihnen ein 100% Risiko freie Verwicklung.

Ihr Anteil w?re 30% von der totalen Gange, w?hrend die
restlichen 70% ist f?r mich und meine kollege.

Wenn dieser vorschlag f?r Sie OK ist und Sie w?nschen
das vertrauen auszunutzen, das wir hoffen auf Ihnen
und Ihrer Gesellschaft zu verleihen,dann senden sie
mir netterweise sofort per meine personal E-mail
Adresse,Ihre vertrauliche Telefonnummer, fax-nummer
und Ihre vertraulicher E-mail,Anschrift, damit ich
Ihnen die relevanten details dieser verhandlung senden
kann.

Danke in voraus.

Mit freundlichen Gr??e.

Herr Thomas Mandino.
Bitte schicken Sie Ihre Antwort an meinem Private
Email:th_mandino at yahoo10.com



------------------------------------------------------------
Turmail.com Ucretsiz Eposta Servisi : http://www.turmail.com
Gelismis Spam ve Virus Filtreleme Servisleri
100 Megabyte E-posta kotasi


From roebuck at odin.mdacc.tmc.edu  Wed Jun 15 23:16:52 2005
From: roebuck at odin.mdacc.tmc.edu (Paul Roebuck)
Date: Wed, 15 Jun 2005 16:16:52 -0500 (CDT)
Subject: [Rd] R Include File Guards
In-Reply-To: <x2psvorz1q.fsf@turmalin.kubism.ku.dk>
References: <Pine.OSF.4.58.0505181524160.204610@odin.mdacc.tmc.edu>
	<x2psvorz1q.fsf@turmalin.kubism.ku.dk>
Message-ID: <Pine.OSF.4.58.0506151612190.332019@odin.mdacc.tmc.edu>

On Wed, 18 May 2005, Peter Dalgaard wrote:

> Paul Roebuck <roebuck at odin.mdacc.tmc.edu> writes:
>
> > R 2.1.0/src/include from 2005/04/18 download
> >
> > Naming inconsistent for guards as well but that's pedantic.
> > Simple convention:
> >   file <foo.h>
> >     #ifndef R_FOO_H
> >   file <R_ext/bar.h>
> >     #ifndef R_EXT_BAR_H
> >
> > Missing guards:
> > <IOStuff.h>
> > <Internal.h>
> > <Parse.h>
> > <R_ext/GraphicsBase.h>
> > <R_ext/GraphicsDevice.h>
> > <R_ext/GraphicsEngine.h>
> > <R_ext/R-ftp-http.h>
> > <R_ext/libextern.h>
> >
> >
> > Illegal Guards (leading underscore):
> > <Rinternals.h>
> > <R_ext/Error.h>
> > <config.h.in>
>
> Thanks. The ones outside R_ext, except Rinternals.h, are not part of the
> API, so it is not a bug that there are no guards - could still be a
> good idea to have them of course. libextern.h explicitly says that you
> shouldn't disallow including it more than once. So the ones with real
> problems would be
>
> <R_ext/GraphicsBase.h>
> <R_ext/GraphicsDevice.h>
> <R_ext/GraphicsEngine.h>
> <R_ext/R-ftp-http.h>
>
> <Rinternals.h>
> <R_ext/Error.h>
>
> What's illegal about leading underscores, BTW?
>

I downloaded the R-patched for 2005/06/14 and noticed that
the guards were never fixed. Should a bug report have been
opened instead of simply noting them here?

----------------------------------------------------------
SIGSIG -- signature too long (core dumped)


From thomas at turmail.com  Thu Jun 16 01:17:32 2005
From: thomas at turmail.com (thomas@turmail.com)
Date: Thu, 16 Jun 2005 01:17:32 +0200 (CEST)
Subject: [Rd] Eilig Geschaftsvorschlag (PR#7945)
Message-ID: <20050615231732.07E8FA1CF@slim.kubism.ku.dk>



Geschaftsvorschlag.

Zuerst mu? ich um Ihre Zuversicht in dieser
verhandlung bitten,dies ist auf Grund seiner lage, als
das sein total VERTRAULICH und Geheimnisvoll.

Aber ich wei?,da? eine verhandlung dieses Ausma?es
irgendeinen ?ngstlich und besorgt machen wird,aber ich
versichre Ihnen,da? alles am Ende des tages in ordnung
sein wird.

Wir haben uns entschieden Sie durch eine E-mail
sendung,wegen der Dringlichkeit diese verhandlung zu
erreichen,als wir davon zuverlassig von seiner
schnelligkeit und vertraulichkeit ?berzeugt worden
sind.

Ich m?chte mich nun vorstellen. Ich bin Herr Thomas
Mandino(Rechnungpr?fer bei der Imperial Bank von S?d
Afrika).

Ich kam zu ihrem kontakt in meiner pers?nlichen suche
nach einer zuverlassigen und anstandige person,um eine
sehr vertrauliche verhandlung zu erledigen,die,die
?bertragung von einem fremden Konto das maximale
zuversicht erfordert.

Der vorschlag:Ein Ausl?ndische,verstorbener Ingenieur
Menfred Becker, ein Diamante Unternehmer mit der
Bundes Regierung von S?d Afrika.

Er war bis seinem Tod vor drei jahren in einem
Flugzeug absturz,als unternehmer bei der Regierung
tatig. Herr Becker war unser kunde hier bei der
Imperial Bank von S?d Afrika und hatte ein Konto
guthaben von US$18,5 milliarde(Achtzehn milliarde,f?nf
hundert Tausend United States Dollar.)welches die Bank
jetzt fraglos erwartet,durch seine verwandten das Sie
sich melden,wenn Sie sich nicht melden wird alles zu
einem Afrikanischen vertrauens fond f?r waffen und
munitionsbesorgungen bei einer freiheitsbewegung hier
in AfriKa gespendet.

Leidenschaftliche wertvolle Anstrengungen werden durch
die Imperial - Bank gemacht,um einen kontakt mit
jemanden von der Becker familie oder verwandten zu
bekommen.Es hat aber bis jetzt keinen Erfolg gegeben.

Es ist wegen der wahrgenommen moglichkeit keinen
verwandten der Becker zu finden(er hatte keine frau
und kinder)da? das management der eine Anordnung f?r
den fond als nicht zubehaupten deklariert
werden,sollte, und dann zum vertrauens-fond f?r waffen
und munition bersorgung ausgeben,die dem kurs vom
krieg in Afrika gespendet wird.

Um dieser negative Entwicklung abzuwenden,haben ich
und einige meiner bew?hrten kollegen in der Bank
beschlossen das Geld nach Ihre zustimmung zu
?berweisen und suchen jetzt Ihre Erlaubnis das Sie
sich als verwandter des verstorbenen Ing.Manfred
Becker deklarieren,damit der Fond in der h?he von
USD$18,5m infolgendessen als der Nutznie?er(Verwandter
des Becker)auf Ihr Bank Konto ?berwiesen werden.

Alle beurkundungen und Beweist die Ihnen erm?glichen
diese Fonds zu behaupten werden wir zu Ihrer verf?gung
stellen,damit alles gut verl?uft und wir versicheren
Ihnen ein 100% Risiko freie Verwicklung.

Ihr Anteil w?re 30% von der totalen Gange, w?hrend die
restlichen 70% ist f?r mich und meine kollege.

Wenn dieser vorschlag f?r Sie OK ist und Sie w?nschen
das vertrauen auszunutzen, das wir hoffen auf Ihnen
und Ihrer Gesellschaft zu verleihen,dann senden sie
mir netterweise sofort per meine personal E-mail
Adresse,Ihre vertrauliche Telefonnummer, fax-nummer
und Ihre vertraulicher E-mail,Anschrift, damit ich
Ihnen die relevanten details dieser verhandlung senden
kann.

Danke in voraus.

Mit freundlichen Gr??e.

Herr Thomas Mandino.
Bitte schicken Sie Ihre Antwort an meinem Private
Email:th_mandino10 at yahoo.com



------------------------------------------------------------
Turmail.com Ucretsiz Eposta Servisi : http://www.turmail.com
Gelismis Spam ve Virus Filtreleme Servisleri
100 Megabyte E-posta kotasi


From jyzz88 at gmail.com  Thu Jun 16 05:42:27 2005
From: jyzz88 at gmail.com (jyzz88@gmail.com)
Date: Thu, 16 Jun 2005 05:42:27 +0200 (CEST)
Subject: [Rd] a bug in glm.fit() (PR#7947)
Message-ID: <20050616034227.77C02A1F9@slim.kubism.ku.dk>

glm.fit() gave me the same AIC's regardless of TRUE or FALSE intercept option.

> myX <- as.matrix(1:10)
> myY <- 3+5*myX
> foo <- glm.fit(x=myX, y=myY, family = gaussian(link = "identity"), intercept=TRUE)
> foo$aic
[1] 38.94657
> foo <- glm.fit(x=myX, y=myY, family = gaussian(link = "identity"), intercept=FALSE)
> foo$aic
[1] 38.94657
>  AIC(lm(myY~0+myX, data=data.frame(myY,myX)))
[1] 38.94657
> AIC(lm(myY~1+myX, data=data.frame(myY,myX)))
[1] -650.9808

-Luke


From ripley at stats.ox.ac.uk  Thu Jun 16 08:06:49 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu, 16 Jun 2005 07:06:49 +0100 (BST)
Subject: [Rd] a bug in glm.fit() (PR#7947)
In-Reply-To: <20050616034227.77C02A1F9@slim.kubism.ku.dk>
References: <20050616034227.77C02A1F9@slim.kubism.ku.dk>
Message-ID: <Pine.LNX.4.61.0506160703510.21725@gannet.stats>

What is the bug?

This is the same model: the `intercept' term affects the null model, not 
the actual model.  Just look at all the output.

On Thu, 16 Jun 2005 jyzz88 at gmail.com wrote:

> glm.fit() gave me the same AIC's regardless of TRUE or FALSE intercept option.
>
>> myX <- as.matrix(1:10)
>> myY <- 3+5*myX
>> foo <- glm.fit(x=myX, y=myY, family = gaussian(link = "identity"), intercept=TRUE)
>> foo$aic
> [1] 38.94657
>> foo <- glm.fit(x=myX, y=myY, family = gaussian(link = "identity"), intercept=FALSE)
>> foo$aic
> [1] 38.94657
>>  AIC(lm(myY~0+myX, data=data.frame(myY,myX)))
> [1] 38.94657
>> AIC(lm(myY~1+myX, data=data.frame(myY,myX)))
> [1] -650.9808

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From plummer at iarc.fr  Thu Jun 16 12:41:49 2005
From: plummer at iarc.fr (Martyn Plummer)
Date: Thu, 16 Jun 2005 12:41:49 +0200
Subject: [Rd] R 2.1.1 slated for June 20
In-Reply-To: <1118786837.3968.14.camel@localhost.localdomain>
References: <x264wmbe6m.fsf@turmalin.kubism.ku.dk>
	<Pine.LNX.4.61.0506101407430.4262@gannet.stats>
	<1118773739.3126.4.camel@localhost.localdomain>
	<x2d5qoa9nf.fsf@turmalin.kubism.ku.dk>
	<1118786837.3968.14.camel@localhost.localdomain>
Message-ID: <1118918509.3651.26.camel@seurat>

On Tue, 2005-06-14 at 17:07 -0500, Marc Schwartz wrote:
> On Tue, 2005-06-14 at 23:52 +0200, Peter Dalgaard wrote:
> > Marc Schwartz <MSchwartz at mn.rr.com> writes:
> > 
> > > On Fri, 2005-06-10 at 14:57 +0100, Prof Brian Ripley wrote:
> > > > On Fri, 10 Jun 2005, Peter Dalgaard wrote:
> > > > 
> > > > > The next version of R will be released (barring force majeure) on June
> > > > > 20th, with beta versions available starting Monday.
> > > > >
> > > > > Please do check them on your system *before* the release this time...
> > > > 
> > > > Some things which it would be particularly helpful to have tested:
> > > 
> > > 
> > > > - Bleeding-edge OSes, e.g. anyone running Fedora Core 4 test 3?  (These
> > > >    often show up problems with bugs in the pre-release versions of
> > > >    components such as X11 and compilers.)
> > > 
> > > 
> > > Just as a quick heads up, I installed FC4 Release ("Stentz") late
> > > yesterday.
> > > 
> > > R (Version 2.1.1 beta (2005-06-14)) compiles fine using:
> > > 
> > > $ gcc --version
> > > gcc (GCC) 4.0.0 20050519 (Red Hat 4.0.0-8)
> > > 
> > > and make check-all passes with no problems.
> > > 
> > > I have also installed all CRAN packages that do not require other 3rd
> > > party drivers, etc. and there were no observed errors in those cases.
> > > 
> > > So far, so good.
> > > 
> > > If anything comes up, I will post a follow up.
> > > 
> > > Best regards,
> > > 
> > > Marc Schwartz
> > 
> > Yep. Just tried the same on AMD64 (I had a bit of a fight converting
> > my SuSE setup -- FC4 is quite unhappy about ReiserFS for some reason).
> > A couple of f95 warnings whooshed by during the compile, that was all.
> > 
> > By the way, I noticed that you can now "yum install R R-devel" and get
> > everything straight from Fedora Extras.
> 
> Yep. Tom "Spot" Callaway is the FE maintainer for R.

I had a look at his RPM last night.  It includes a patch for gcc4, which
fails to build R with the fairly aggressive optimizations used by
rpmbuild. ("-O2 -D_FORTIFY_SOURCE=2" will reproduce the bug, IIRC, but
I'm not upgrading my work PC just yet, so I can't be sure).  I folded
this into R-patched.  It's a shame he didn't send a bug report or, if he
did, I missed it.

I also note he is using the patch that sets LANG=C, which is obsolete
now that R supports utf-8 locales.  I'll write to him (cc Marc) to let
him know about these changes.

The RedHat RPMS also use the shared library version of R.  I've been
thinking about making this change myself, despite the substantial speed
penalty, since I've seen a growing number of people recompiling to get
the shared library.  The Red Hat choice forces my hand though: I don't
want people upgrading from their R 2.1.0 to my R 2.1.1 and finding their
installed packages don't work anymore.  The $64,000 question is how many
people are going to care about that 15-20% decrease in speed. Speak up
now if it concerns you.

> A lot of things for FC 4 have been moved to Extras and there are of
> course new things (like R) there as well. The restrictions on non-GPL
> components is still there, so things like MP3 functionality is available
> via third party repos such as FreshRPMS, Livna, etc.
> 
> This was a "balancing" act between trying to reduce (manage) the size of
> the main distro and reducing real or perceived redundancies in packages.
> 
> So, for example:
> 
> 1. Include OO.org in Core, but move Gnumeric to Extras
> 
> 2. Include Emacs in Core, but move XEmacs to Extras
> 
> Needless to say, that resulted in "emotional" discussions.

This underscores the fact Fedora, despite claiming to be a community
project, is essentially Red Hat's rolling beta programme, and so must be
more focused and less inclusive than Debian.  (Just an observation. I
don't want to start a discussion on FOSS politics)

Martyn

-----------------------------------------------------------------------
This message and its attachments are strictly confidential. If you are
not the intended recipient of this message, please immediately notify 
the sender and delete it. Since its integrity cannot be guaranteed, 
its content cannot involve the sender's responsibility. Any misuse, 
any disclosure or publication of its content, either whole or partial, 
is prohibited, exception made of formally approved use


From ripley at stats.ox.ac.uk  Thu Jun 16 13:41:10 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu, 16 Jun 2005 12:41:10 +0100 (BST)
Subject: [Rd] R 2.1.1 slated for June 20
In-Reply-To: <1118918509.3651.26.camel@seurat>
References: <x264wmbe6m.fsf@turmalin.kubism.ku.dk> 
	<Pine.LNX.4.61.0506101407430.4262@gannet.stats>
	<1118773739.3126.4.camel@localhost.localdomain>
	<x2d5qoa9nf.fsf@turmalin.kubism.ku.dk>
	<1118786837.3968.14.camel@localhost.localdomain>
	<1118918509.3651.26.camel@seurat>
Message-ID: <Pine.LNX.4.61.0506161224300.25129@gannet.stats>

On Thu, 16 Jun 2005, Martyn Plummer wrote:

> On Tue, 2005-06-14 at 17:07 -0500, Marc Schwartz wrote:
>> On Tue, 2005-06-14 at 23:52 +0200, Peter Dalgaard wrote:
>>> Marc Schwartz <MSchwartz at mn.rr.com> writes:
>>>
>>>> On Fri, 2005-06-10 at 14:57 +0100, Prof Brian Ripley wrote:
>>>>> On Fri, 10 Jun 2005, Peter Dalgaard wrote:
>>>>>
>>>>>> The next version of R will be released (barring force majeure) on June
>>>>>> 20th, with beta versions available starting Monday.
>>>>>>
>>>>>> Please do check them on your system *before* the release this time...
>>>>>
>>>>> Some things which it would be particularly helpful to have tested:
>>>>
>>>>
>>>>> - Bleeding-edge OSes, e.g. anyone running Fedora Core 4 test 3?  (These
>>>>>    often show up problems with bugs in the pre-release versions of
>>>>>    components such as X11 and compilers.)
>>>>
>>>>
>>>> Just as a quick heads up, I installed FC4 Release ("Stentz") late
>>>> yesterday.
>>>>
>>>> R (Version 2.1.1 beta (2005-06-14)) compiles fine using:
>>>>
>>>> $ gcc --version
>>>> gcc (GCC) 4.0.0 20050519 (Red Hat 4.0.0-8)
>>>>
>>>> and make check-all passes with no problems.
>>>>
>>>> I have also installed all CRAN packages that do not require other 3rd
>>>> party drivers, etc. and there were no observed errors in those cases.
>>>>
>>>> So far, so good.
>>>>
>>>> If anything comes up, I will post a follow up.
>>>>
>>>> Best regards,
>>>>
>>>> Marc Schwartz
>>>
>>> Yep. Just tried the same on AMD64 (I had a bit of a fight converting
>>> my SuSE setup -- FC4 is quite unhappy about ReiserFS for some reason).
>>> A couple of f95 warnings whooshed by during the compile, that was all.
>>>
>>> By the way, I noticed that you can now "yum install R R-devel" and get
>>> everything straight from Fedora Extras.
>>
>> Yep. Tom "Spot" Callaway is the FE maintainer for R.
>
> I had a look at his RPM last night.  It includes a patch for gcc4, which
> fails to build R with the fairly aggressive optimizations used by
> rpmbuild. ("-O2 -D_FORTIFY_SOURCE=2" will reproduce the bug, IIRC, but
> I'm not upgrading my work PC just yet, so I can't be sure).  I folded
> this into R-patched.  It's a shame he didn't send a bug report or, if he
> did, I missed it.

Looks to me that this is bug in gcc4, not in R.  (It's not actually an 
optimization.) I've resisted making any such changes until gcc 4.0.1 is 
released - and that is held up on some outstanding bug fixes.

(BTW, it is a really good idea to put a comment in the file as to why
unnecessary parentheses have been added.)

It's a shame FC4 does not contain a well-tested high-quality compiler like
3.4.4 or 3.3.6, especially a well-tested high-quality Fortran compiler.

> I also note he is using the patch that sets LANG=C, which is obsolete
> now that R supports utf-8 locales.  I'll write to him (cc Marc) to let
> him know about these changes.
>
> The RedHat RPMS also use the shared library version of R.  I've been
> thinking about making this change myself, despite the substantial speed
> penalty, since I've seen a growing number of people recompiling to get
> the shared library.  The Red Hat choice forces my hand though: I don't
> want people upgrading from their R 2.1.0 to my R 2.1.1 and finding their
> installed packages don't work anymore.  The $64,000 question is how many
> people are going to care about that 15-20% decrease in speed. Speak up
> now if it concerns you.

Well, if they do they will also care about the 5-10% or so that gcc4 costs 
them over 3.4.4 and so will not want your RPM.

BTW, I find 15-20% on i686, 10-15 on x86_64, and I have no idea about PPC.
(That warning about

dotcode.c:96: warning: ISO C forbids assignment between function pointer and `void *'

is supposed to be serious on PPC64 where a function pointer is really a 
different sort of object.  FC4 claims to support 64-bit PPC, but it is not 
clear that this is actually a 64-bit OS.)  gcc4 has features we can use to 
narrow the gap but first it has to work reliably.

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From p.dalgaard at biostat.ku.dk  Thu Jun 16 13:51:06 2005
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: 16 Jun 2005 13:51:06 +0200
Subject: [Rd] R 2.1.1 slated for June 20
In-Reply-To: <1118918509.3651.26.camel@seurat>
References: <x264wmbe6m.fsf@turmalin.kubism.ku.dk>
	<Pine.LNX.4.61.0506101407430.4262@gannet.stats>
	<1118773739.3126.4.camel@localhost.localdomain>
	<x2d5qoa9nf.fsf@turmalin.kubism.ku.dk>
	<1118786837.3968.14.camel@localhost.localdomain>
	<1118918509.3651.26.camel@seurat>
Message-ID: <x2zmtqo6z9.fsf@turmalin.kubism.ku.dk>

Martyn Plummer <plummer at iarc.fr> writes:

> On Tue, 2005-06-14 at 17:07 -0500, Marc Schwartz wrote:
> > On Tue, 2005-06-14 at 23:52 +0200, Peter Dalgaard wrote:
> > > Marc Schwartz <MSchwartz at mn.rr.com> writes:
> > > 
> > > > On Fri, 2005-06-10 at 14:57 +0100, Prof Brian Ripley wrote:
> > > > > On Fri, 10 Jun 2005, Peter Dalgaard wrote:
> > > > > 
> > > > > > The next version of R will be released (barring force majeure) on June
> > > > > > 20th, with beta versions available starting Monday.
> > > > > >
> > > > > > Please do check them on your system *before* the release this time...
> > > > > 
> > > > > Some things which it would be particularly helpful to have tested:
> > > > 
> > > > 
> > > > > - Bleeding-edge OSes, e.g. anyone running Fedora Core 4 test 3?  (These
> > > > >    often show up problems with bugs in the pre-release versions of
> > > > >    components such as X11 and compilers.)
> > > > 
> > > > 
> > > > Just as a quick heads up, I installed FC4 Release ("Stentz") late
> > > > yesterday.
> > > > 
> > > > R (Version 2.1.1 beta (2005-06-14)) compiles fine using:
> > > > 
> > > > $ gcc --version
> > > > gcc (GCC) 4.0.0 20050519 (Red Hat 4.0.0-8)
> > > > 
> > > > and make check-all passes with no problems.
> > > > 
> > > > I have also installed all CRAN packages that do not require other 3rd
> > > > party drivers, etc. and there were no observed errors in those cases.
> > > > 
> > > > So far, so good.
> > > > 
> > > > If anything comes up, I will post a follow up.
> > > > 
> > > > Best regards,
> > > > 
> > > > Marc Schwartz
> > > 
> > > Yep. Just tried the same on AMD64 (I had a bit of a fight converting
> > > my SuSE setup -- FC4 is quite unhappy about ReiserFS for some reason).
> > > A couple of f95 warnings whooshed by during the compile, that was all.
> > > 
> > > By the way, I noticed that you can now "yum install R R-devel" and get
> > > everything straight from Fedora Extras.
> > 
> > Yep. Tom "Spot" Callaway is the FE maintainer for R.
> 
> I had a look at his RPM last night.  It includes a patch for gcc4, which
> fails to build R with the fairly aggressive optimizations used by
> rpmbuild. ("-O2 -D_FORTIFY_SOURCE=2" will reproduce the bug, IIRC, but
> I'm not upgrading my work PC just yet, so I can't be sure).  I folded
> this into R-patched.  It's a shame he didn't send a bug report or, if he
> did, I missed it.

Thanks for looking into this. Do you know what is the time frame for
getting a new version into FC-E? Do we actually need separate CRAN
versions any more? BTW, I noticed that the Fedora RPMs depend on a
blas RPM. Do you have any inkling about what that implies? (I've never
quite understood whether there is a "right" way to use a machine
specific BLAS in concert with a packaging system).
 
> I also note he is using the patch that sets LANG=C, which is obsolete
> now that R supports utf-8 locales.  I'll write to him (cc Marc) to let
> him know about these changes.
> 
> The RedHat RPMS also use the shared library version of R.  I've been
> thinking about making this change myself, despite the substantial speed
> penalty, since I've seen a growing number of people recompiling to get
> the shared library.  The Red Hat choice forces my hand though: I don't
> want people upgrading from their R 2.1.0 to my R 2.1.1 and finding their
> installed packages don't work anymore.  The $64,000 question is how many
> people are going to care about that 15-20% decrease in speed. Speak up
> now if it concerns you.

What is a good way to measure that? For hardcore numerics, it is
certainly much less than 15% on the AMD64:

# RPM:
> system.time(solve(matrix(rnorm(1e6),1e3)))
[1] 8.64 0.15 8.86 0.00 0.00

# My private build
[pd at localhost ~]$ r-patched/BUILD/bin/R -q
> system.time(solve(matrix(rnorm(1e6),1e3)))
[1] 8.49 0.15 8.64 0.00 0.00

(and there is a substantial replication variation on those numbers). 

For more integer-bound stuff like

system.time(p <- replicate(10000,t.test(rexp(25),mu=1)$p.value))

I get about 14.1s with the RPM and 11.7s with my build.
 

-- 
   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
 (*) \(*) -- University of Copenhagen   Denmark          Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)                  FAX: (+45) 35327907


From MSchwartz at mn.rr.com  Thu Jun 16 14:51:29 2005
From: MSchwartz at mn.rr.com (Marc Schwartz)
Date: Thu, 16 Jun 2005 07:51:29 -0500
Subject: [Rd] R 2.1.1 slated for June 20
In-Reply-To: <1118918509.3651.26.camel@seurat>
References: <x264wmbe6m.fsf@turmalin.kubism.ku.dk>
	<Pine.LNX.4.61.0506101407430.4262@gannet.stats>
	<1118773739.3126.4.camel@localhost.localdomain>
	<x2d5qoa9nf.fsf@turmalin.kubism.ku.dk>
	<1118786837.3968.14.camel@localhost.localdomain>
	<1118918509.3651.26.camel@seurat>
Message-ID: <1118926290.4912.24.camel@localhost.localdomain>

On Thu, 2005-06-16 at 12:41 +0200, Martyn Plummer wrote:
> On Tue, 2005-06-14 at 17:07 -0500, Marc Schwartz wrote:
> > On Tue, 2005-06-14 at 23:52 +0200, Peter Dalgaard wrote:
> > > Marc Schwartz <MSchwartz at mn.rr.com> writes:
> > > 
> > > > On Fri, 2005-06-10 at 14:57 +0100, Prof Brian Ripley wrote:
> > > > > On Fri, 10 Jun 2005, Peter Dalgaard wrote:
> > > > > 
> > > > > > The next version of R will be released (barring force majeure) on June
> > > > > > 20th, with beta versions available starting Monday.
> > > > > >
> > > > > > Please do check them on your system *before* the release this time...
> > > > > 
> > > > > Some things which it would be particularly helpful to have tested:
> > > > 
> > > > 
> > > > > - Bleeding-edge OSes, e.g. anyone running Fedora Core 4 test 3?  (These
> > > > >    often show up problems with bugs in the pre-release versions of
> > > > >    components such as X11 and compilers.)
> > > > 
> > > > 
> > > > Just as a quick heads up, I installed FC4 Release ("Stentz") late
> > > > yesterday.
> > > > 
> > > > R (Version 2.1.1 beta (2005-06-14)) compiles fine using:
> > > > 
> > > > $ gcc --version
> > > > gcc (GCC) 4.0.0 20050519 (Red Hat 4.0.0-8)
> > > > 
> > > > and make check-all passes with no problems.
> > > > 
> > > > I have also installed all CRAN packages that do not require other 3rd
> > > > party drivers, etc. and there were no observed errors in those cases.
> > > > 
> > > > So far, so good.
> > > > 
> > > > If anything comes up, I will post a follow up.
> > > > 
> > > > Best regards,
> > > > 
> > > > Marc Schwartz
> > > 
> > > Yep. Just tried the same on AMD64 (I had a bit of a fight converting
> > > my SuSE setup -- FC4 is quite unhappy about ReiserFS for some reason).
> > > A couple of f95 warnings whooshed by during the compile, that was all.
> > > 
> > > By the way, I noticed that you can now "yum install R R-devel" and get
> > > everything straight from Fedora Extras.
> > 
> > Yep. Tom "Spot" Callaway is the FE maintainer for R.
> 
> I had a look at his RPM last night.  It includes a patch for gcc4, which
> fails to build R with the fairly aggressive optimizations used by
> rpmbuild. ("-O2 -D_FORTIFY_SOURCE=2" will reproduce the bug, IIRC, but
> I'm not upgrading my work PC just yet, so I can't be sure).  I folded
> this into R-patched.  It's a shame he didn't send a bug report or, if he
> did, I missed it.
> 
> I also note he is using the patch that sets LANG=C, which is obsolete
> now that R supports utf-8 locales.  I'll write to him (cc Marc) to let
> him know about these changes.
> 
> The RedHat RPMS also use the shared library version of R.  I've been
> thinking about making this change myself, despite the substantial speed
> penalty, since I've seen a growing number of people recompiling to get
> the shared library.  The Red Hat choice forces my hand though: I don't
> want people upgrading from their R 2.1.0 to my R 2.1.1 and finding their
> installed packages don't work anymore.  The $64,000 question is how many
> people are going to care about that 15-20% decrease in speed. Speak up
> now if it concerns you.

Martyn,

>From what I can tell, there is only one reason that the FC-E R RPM is
available as a shared library:

Tom had made the gnomeGUI CRAN package available as an RPM in FC-E,
which of course requires the above:

http://fedoraproject.org/extras/4/i386/repodata/repoview/R-gnomeGUI-0-2.1.0-4.html

I would defer to the opinion of others here, but given the rather
limited functionality of the R GNOME GUI and that not much if any work
is presently being done on it (is that correct?), does Tom's approach
really make sense?

Tom has also made RScaLAPACK available, but unless I am missing
something, I do not see a requirement that R be compiled as a shared
library for that package:

http://fedoraproject.org/extras/4/i386/repodata/repoview/R-RScaLAPACK-0-0.4.0-12.fc4.html

I am unclear as to the criteria for his package selection for FC-E and
what his future plans might be with respect to other CRAN packages being
made available via FC-E repos.

Perhaps Dirk (cc:'d here) and others on the Debian side of things have
some thoughts here. I know that there were exchanges in the past
regarding how to handle R and CRAN packages that were available directly
and/or from apt repos as .debs, relative to conflicts, etc.  I am not
sure if anything was ever resolved on those issues. If they have some
approaches that make sense, it would seem logical to leverage their
experience.

> > A lot of things for FC 4 have been moved to Extras and there are of
> > course new things (like R) there as well. The restrictions on non-GPL
> > components is still there, so things like MP3 functionality is available
> > via third party repos such as FreshRPMS, Livna, etc.
> > 
> > This was a "balancing" act between trying to reduce (manage) the size of
> > the main distro and reducing real or perceived redundancies in packages.
> > 
> > So, for example:
> > 
> > 1. Include OO.org in Core, but move Gnumeric to Extras
> > 
> > 2. Include Emacs in Core, but move XEmacs to Extras
> > 
> > Needless to say, that resulted in "emotional" discussions.
> 
> This underscores the fact Fedora, despite claiming to be a community
> project, is essentially Red Hat's rolling beta programme, and so must be
> more focused and less inclusive than Debian.  (Just an observation. I
> don't want to start a discussion on FOSS politics)

Yes, this is a sensitive area, but of course Debian has it's own
challenges at the moment, reflected in this article from this week by
Ian Murdock:

http://os.newsforge.com/os/05/06/14/1722241.shtml?tid=2

There is not a single "perfect" Linux distribution and I think that each
user has to make some decisions as to what their overarching
requirements are, which could be functional and philosophical. Based
upon those factors, each can select a distribution that makes sense.

Importantly, there are choices available.

Marc


From MSchwartz at mn.rr.com  Thu Jun 16 14:51:29 2005
From: MSchwartz at mn.rr.com (Marc Schwartz)
Date: Thu, 16 Jun 2005 07:51:29 -0500
Subject: [Rd] R 2.1.1 slated for June 20
In-Reply-To: <1118918509.3651.26.camel@seurat>
References: <x264wmbe6m.fsf@turmalin.kubism.ku.dk>
	<Pine.LNX.4.61.0506101407430.4262@gannet.stats>
	<1118773739.3126.4.camel@localhost.localdomain>
	<x2d5qoa9nf.fsf@turmalin.kubism.ku.dk>
	<1118786837.3968.14.camel@localhost.localdomain>
	<1118918509.3651.26.camel@seurat>
Message-ID: <1118926290.4912.24.camel@localhost.localdomain>

On Thu, 2005-06-16 at 12:41 +0200, Martyn Plummer wrote:
> On Tue, 2005-06-14 at 17:07 -0500, Marc Schwartz wrote:
> > On Tue, 2005-06-14 at 23:52 +0200, Peter Dalgaard wrote:
> > > Marc Schwartz <MSchwartz at mn.rr.com> writes:
> > > 
> > > > On Fri, 2005-06-10 at 14:57 +0100, Prof Brian Ripley wrote:
> > > > > On Fri, 10 Jun 2005, Peter Dalgaard wrote:
> > > > > 
> > > > > > The next version of R will be released (barring force majeure) on June
> > > > > > 20th, with beta versions available starting Monday.
> > > > > >
> > > > > > Please do check them on your system *before* the release this time...
> > > > > 
> > > > > Some things which it would be particularly helpful to have tested:
> > > > 
> > > > 
> > > > > - Bleeding-edge OSes, e.g. anyone running Fedora Core 4 test 3?  (These
> > > > >    often show up problems with bugs in the pre-release versions of
> > > > >    components such as X11 and compilers.)
> > > > 
> > > > 
> > > > Just as a quick heads up, I installed FC4 Release ("Stentz") late
> > > > yesterday.
> > > > 
> > > > R (Version 2.1.1 beta (2005-06-14)) compiles fine using:
> > > > 
> > > > $ gcc --version
> > > > gcc (GCC) 4.0.0 20050519 (Red Hat 4.0.0-8)
> > > > 
> > > > and make check-all passes with no problems.
> > > > 
> > > > I have also installed all CRAN packages that do not require other 3rd
> > > > party drivers, etc. and there were no observed errors in those cases.
> > > > 
> > > > So far, so good.
> > > > 
> > > > If anything comes up, I will post a follow up.
> > > > 
> > > > Best regards,
> > > > 
> > > > Marc Schwartz
> > > 
> > > Yep. Just tried the same on AMD64 (I had a bit of a fight converting
> > > my SuSE setup -- FC4 is quite unhappy about ReiserFS for some reason).
> > > A couple of f95 warnings whooshed by during the compile, that was all.
> > > 
> > > By the way, I noticed that you can now "yum install R R-devel" and get
> > > everything straight from Fedora Extras.
> > 
> > Yep. Tom "Spot" Callaway is the FE maintainer for R.
> 
> I had a look at his RPM last night.  It includes a patch for gcc4, which
> fails to build R with the fairly aggressive optimizations used by
> rpmbuild. ("-O2 -D_FORTIFY_SOURCE=2" will reproduce the bug, IIRC, but
> I'm not upgrading my work PC just yet, so I can't be sure).  I folded
> this into R-patched.  It's a shame he didn't send a bug report or, if he
> did, I missed it.
> 
> I also note he is using the patch that sets LANG=C, which is obsolete
> now that R supports utf-8 locales.  I'll write to him (cc Marc) to let
> him know about these changes.
> 
> The RedHat RPMS also use the shared library version of R.  I've been
> thinking about making this change myself, despite the substantial speed
> penalty, since I've seen a growing number of people recompiling to get
> the shared library.  The Red Hat choice forces my hand though: I don't
> want people upgrading from their R 2.1.0 to my R 2.1.1 and finding their
> installed packages don't work anymore.  The $64,000 question is how many
> people are going to care about that 15-20% decrease in speed. Speak up
> now if it concerns you.

Martyn,

>From what I can tell, there is only one reason that the FC-E R RPM is
available as a shared library:

Tom had made the gnomeGUI CRAN package available as an RPM in FC-E,
which of course requires the above:

http://fedoraproject.org/extras/4/i386/repodata/repoview/R-gnomeGUI-0-2.1.0-4.html

I would defer to the opinion of others here, but given the rather
limited functionality of the R GNOME GUI and that not much if any work
is presently being done on it (is that correct?), does Tom's approach
really make sense?

Tom has also made RScaLAPACK available, but unless I am missing
something, I do not see a requirement that R be compiled as a shared
library for that package:

http://fedoraproject.org/extras/4/i386/repodata/repoview/R-RScaLAPACK-0-0.4.0-12.fc4.html

I am unclear as to the criteria for his package selection for FC-E and
what his future plans might be with respect to other CRAN packages being
made available via FC-E repos.

Perhaps Dirk (cc:'d here) and others on the Debian side of things have
some thoughts here. I know that there were exchanges in the past
regarding how to handle R and CRAN packages that were available directly
and/or from apt repos as .debs, relative to conflicts, etc.  I am not
sure if anything was ever resolved on those issues. If they have some
approaches that make sense, it would seem logical to leverage their
experience.

> > A lot of things for FC 4 have been moved to Extras and there are of
> > course new things (like R) there as well. The restrictions on non-GPL
> > components is still there, so things like MP3 functionality is available
> > via third party repos such as FreshRPMS, Livna, etc.
> > 
> > This was a "balancing" act between trying to reduce (manage) the size of
> > the main distro and reducing real or perceived redundancies in packages.
> > 
> > So, for example:
> > 
> > 1. Include OO.org in Core, but move Gnumeric to Extras
> > 
> > 2. Include Emacs in Core, but move XEmacs to Extras
> > 
> > Needless to say, that resulted in "emotional" discussions.
> 
> This underscores the fact Fedora, despite claiming to be a community
> project, is essentially Red Hat's rolling beta programme, and so must be
> more focused and less inclusive than Debian.  (Just an observation. I
> don't want to start a discussion on FOSS politics)

Yes, this is a sensitive area, but of course Debian has it's own
challenges at the moment, reflected in this article from this week by
Ian Murdock:

http://os.newsforge.com/os/05/06/14/1722241.shtml?tid=2

There is not a single "perfect" Linux distribution and I think that each
user has to make some decisions as to what their overarching
requirements are, which could be functional and philosophical. Based
upon those factors, each can select a distribution that makes sense.

Importantly, there are choices available.

Marc


From ripley at stats.ox.ac.uk  Thu Jun 16 16:23:58 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu, 16 Jun 2005 15:23:58 +0100 (BST)
Subject: [Rd] R 2.1.1 slated for June 20
In-Reply-To: <1118926290.4912.24.camel@localhost.localdomain>
References: <x264wmbe6m.fsf@turmalin.kubism.ku.dk> 
	<Pine.LNX.4.61.0506101407430.4262@gannet.stats>
	<1118773739.3126.4.camel@localhost.localdomain>
	<x2d5qoa9nf.fsf@turmalin.kubism.ku.dk>
	<1118786837.3968.14.camel@localhost.localdomain>
	<1118918509.3651.26.camel@seurat>
	<1118926290.4912.24.camel@localhost.localdomain>
Message-ID: <Pine.LNX.4.61.0506161521220.12610@gannet.stats>

On Thu, 16 Jun 2005, Marc Schwartz wrote:

>> From what I can tell, there is only one reason that the FC-E R RPM is
> available as a shared library:
>
> Tom had made the gnomeGUI CRAN package available as an RPM in FC-E,
> which of course requires the above:
>
> http://fedoraproject.org/extras/4/i386/repodata/repoview/R-gnomeGUI-0-2.1.0-4.html
>
> I would defer to the opinion of others here, but given the rather
> limited functionality of the R GNOME GUI and that not much if any work
> is presently being done on it (is that correct?), does Tom's approach
> really make sense?

No work is being done on it.  It remains only as an example of a console 
front-end.

Brian

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From ripley at stats.ox.ac.uk  Thu Jun 16 16:23:58 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu, 16 Jun 2005 15:23:58 +0100 (BST)
Subject: [Rd] R 2.1.1 slated for June 20
In-Reply-To: <1118926290.4912.24.camel@localhost.localdomain>
References: <x264wmbe6m.fsf@turmalin.kubism.ku.dk> 
	<Pine.LNX.4.61.0506101407430.4262@gannet.stats>
	<1118773739.3126.4.camel@localhost.localdomain>
	<x2d5qoa9nf.fsf@turmalin.kubism.ku.dk>
	<1118786837.3968.14.camel@localhost.localdomain>
	<1118918509.3651.26.camel@seurat>
	<1118926290.4912.24.camel@localhost.localdomain>
Message-ID: <Pine.LNX.4.61.0506161521220.12610@gannet.stats>

On Thu, 16 Jun 2005, Marc Schwartz wrote:

>> From what I can tell, there is only one reason that the FC-E R RPM is
> available as a shared library:
>
> Tom had made the gnomeGUI CRAN package available as an RPM in FC-E,
> which of course requires the above:
>
> http://fedoraproject.org/extras/4/i386/repodata/repoview/R-gnomeGUI-0-2.1.0-4.html
>
> I would defer to the opinion of others here, but given the rather
> limited functionality of the R GNOME GUI and that not much if any work
> is presently being done on it (is that correct?), does Tom's approach
> really make sense?

No work is being done on it.  It remains only as an example of a console 
front-end.

Brian

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From MSchwartz at mn.rr.com  Thu Jun 16 17:00:17 2005
From: MSchwartz at mn.rr.com (Marc Schwartz)
Date: Thu, 16 Jun 2005 10:00:17 -0500
Subject: [Rd] R 2.1.1 slated for June 20
In-Reply-To: <Pine.LNX.4.61.0506161521220.12610@gannet.stats>
References: <x264wmbe6m.fsf@turmalin.kubism.ku.dk>
	<Pine.LNX.4.61.0506101407430.4262@gannet.stats>
	<1118773739.3126.4.camel@localhost.localdomain>
	<x2d5qoa9nf.fsf@turmalin.kubism.ku.dk>
	<1118786837.3968.14.camel@localhost.localdomain>
	<1118918509.3651.26.camel@seurat>
	<1118926290.4912.24.camel@localhost.localdomain>
	<Pine.LNX.4.61.0506161521220.12610@gannet.stats>
Message-ID: <1118934017.4912.64.camel@localhost.localdomain>

On Thu, 2005-06-16 at 15:23 +0100, Prof Brian Ripley wrote:
> On Thu, 16 Jun 2005, Marc Schwartz wrote:
> 
> >> From what I can tell, there is only one reason that the FC-E R RPM is
> > available as a shared library:
> >
> > Tom had made the gnomeGUI CRAN package available as an RPM in FC-E,
> > which of course requires the above:
> >
> > http://fedoraproject.org/extras/4/i386/repodata/repoview/R-gnomeGUI-0-2.1.0-4.html
> >
> > I would defer to the opinion of others here, but given the rather
> > limited functionality of the R GNOME GUI and that not much if any work
> > is presently being done on it (is that correct?), does Tom's approach
> > really make sense?
> 
> No work is being done on it.  It remains only as an example of a console 
> front-end.
> 
> Brian

That being the confirmed case, it seems reasonable to facilitate Tom's
making an informed decision as to the pros and cons of his approach and
that his choice is askew from a "default" R configuration. 

Needless to say, his choice, presumably based upon the inclusion of the
gnomeGUI package, is to an extent exclusionary to KDE and other DE users
who will (unknowingly) pay a defacto performance price if installing R
via FC-E.

Marc


From plummer at iarc.fr  Thu Jun 16 17:46:56 2005
From: plummer at iarc.fr (Martyn Plummer)
Date: Thu, 16 Jun 2005 17:46:56 +0200
Subject: [Rd] R 2.1.1 slated for June 20
In-Reply-To: <Pine.LNX.4.61.0506161224300.25129@gannet.stats>
References: <x264wmbe6m.fsf@turmalin.kubism.ku.dk>
	<Pine.LNX.4.61.0506101407430.4262@gannet.stats>
	<1118773739.3126.4.camel@localhost.localdomain>
	<x2d5qoa9nf.fsf@turmalin.kubism.ku.dk>
	<1118786837.3968.14.camel@localhost.localdomain>
	<1118918509.3651.26.camel@seurat>
	<Pine.LNX.4.61.0506161224300.25129@gannet.stats>
Message-ID: <1118936816.3651.91.camel@seurat>

On Thu, 2005-06-16 at 12:41 +0100, Prof Brian Ripley wrote:
> On Thu, 16 Jun 2005, Martyn Plummer wrote:
> 
> > On Tue, 2005-06-14 at 17:07 -0500, Marc Schwartz wrote:
> >> On Tue, 2005-06-14 at 23:52 +0200, Peter Dalgaard wrote:
> >>> Marc Schwartz <MSchwartz at mn.rr.com> writes:
> >>>
> >>>> On Fri, 2005-06-10 at 14:57 +0100, Prof Brian Ripley wrote:
> >>>>> On Fri, 10 Jun 2005, Peter Dalgaard wrote:
> >>>>>
> >>>>>> The next version of R will be released (barring force majeure) on June
> >>>>>> 20th, with beta versions available starting Monday.
> >>>>>>
> >>>>>> Please do check them on your system *before* the release this time...
> >>>>>
> >>>>> Some things which it would be particularly helpful to have tested:
> >>>>
> >>>>
> >>>>> - Bleeding-edge OSes, e.g. anyone running Fedora Core 4 test 3?  (These
> >>>>>    often show up problems with bugs in the pre-release versions of
> >>>>>    components such as X11 and compilers.)
> >>>>
> >>>>
> >>>> Just as a quick heads up, I installed FC4 Release ("Stentz") late
> >>>> yesterday.
> >>>>
> >>>> R (Version 2.1.1 beta (2005-06-14)) compiles fine using:
> >>>>
> >>>> $ gcc --version
> >>>> gcc (GCC) 4.0.0 20050519 (Red Hat 4.0.0-8)
> >>>>
> >>>> and make check-all passes with no problems.
> >>>>
> >>>> I have also installed all CRAN packages that do not require other 3rd
> >>>> party drivers, etc. and there were no observed errors in those cases.
> >>>>
> >>>> So far, so good.
> >>>>
> >>>> If anything comes up, I will post a follow up.
> >>>>
> >>>> Best regards,
> >>>>
> >>>> Marc Schwartz
> >>>
> >>> Yep. Just tried the same on AMD64 (I had a bit of a fight converting
> >>> my SuSE setup -- FC4 is quite unhappy about ReiserFS for some reason).
> >>> A couple of f95 warnings whooshed by during the compile, that was all.
> >>>
> >>> By the way, I noticed that you can now "yum install R R-devel" and get
> >>> everything straight from Fedora Extras.
> >>
> >> Yep. Tom "Spot" Callaway is the FE maintainer for R.
> >
> > I had a look at his RPM last night.  It includes a patch for gcc4, which
> > fails to build R with the fairly aggressive optimizations used by
> > rpmbuild. ("-O2 -D_FORTIFY_SOURCE=2" will reproduce the bug, IIRC, but
> > I'm not upgrading my work PC just yet, so I can't be sure).  I folded
> > this into R-patched.  It's a shame he didn't send a bug report or, if he
> > did, I missed it.
> 
> Looks to me that this is bug in gcc4, not in R.  (It's not actually an 
> optimization.) I've resisted making any such changes until gcc 4.0.1 is 
> released - and that is held up on some outstanding bug fixes.
> 
> (BTW, it is a really good idea to put a comment in the file as to why
> unnecessary parentheses have been added.)

Mea culpa. 

I have asked Tom Callaway whether this was intended as a bug-fix for R
or a workaround. 

> It's a shame FC4 does not contain a well-tested high-quality compiler like
> 3.4.4 or 3.3.6, especially a well-tested high-quality Fortran compiler.

That's not what Fedora is for, as I was discussing with Marc. Fedora
users are willing (although perhaps unthinking) participants in Red
Hat's beta testing cycle.  By the time the bleeding-edge technology in
Fedora gets to Red Hat's paying customers, it is well-tested and high-
quality.

> > I also note he is using the patch that sets LANG=C, which is obsolete
> > now that R supports utf-8 locales.  I'll write to him (cc Marc) to let
> > him know about these changes.
> >
> > The RedHat RPMS also use the shared library version of R.  I've been
> > thinking about making this change myself, despite the substantial speed
> > penalty, since I've seen a growing number of people recompiling to get
> > the shared library.  The Red Hat choice forces my hand though: I don't
> > want people upgrading from their R 2.1.0 to my R 2.1.1 and finding their
> > installed packages don't work anymore.  The $64,000 question is how many
> > people are going to care about that 15-20% decrease in speed. Speak up
> > now if it concerns you.
> 
> Well, if they do they will also care about the 5-10% or so that gcc4 costs 
> them over 3.4.4 and so will not want your RPM.

That would depend on how I compile it.  I'm quite happy to maintain an
R-static RPM for people who feel the need for speed. But I don't know if
there is a demand. I see that the Debian package uses the shared
library.

> BTW, I find 15-20% on i686, 10-15 on x86_64, and I have no idea about PPC.
> (That warning about
> 
> dotcode.c:96: warning: ISO C forbids assignment between function pointer and `void *'
> 
> is supposed to be serious on PPC64 where a function pointer is really a 
> different sort of object.  FC4 claims to support 64-bit PPC, but it is not 
> clear that this is actually a 64-bit OS.)  gcc4 has features we can use to 
> narrow the gap but first it has to work reliably.
> 
> -- 
> Brian D. Ripley,                  ripley at stats.ox.ac.uk
> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> University of Oxford,             Tel:  +44 1865 272861 (self)
> 1 South Parks Road,                     +44 1865 272866 (PA)
> Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-----------------------------------------------------------------------
This message and its attachments are strictly confidential. If you are
not the intended recipient of this message, please immediately notify 
the sender and delete it. Since its integrity cannot be guaranteed, 
its content cannot involve the sender's responsibility. Any misuse, 
any disclosure or publication of its content, either whole or partial, 
is prohibited, exception made of formally approved use


From MSchwartz at mn.rr.com  Thu Jun 16 17:00:17 2005
From: MSchwartz at mn.rr.com (Marc Schwartz)
Date: Thu, 16 Jun 2005 10:00:17 -0500
Subject: [Rd] R 2.1.1 slated for June 20
In-Reply-To: <Pine.LNX.4.61.0506161521220.12610@gannet.stats>
References: <x264wmbe6m.fsf@turmalin.kubism.ku.dk>
	<Pine.LNX.4.61.0506101407430.4262@gannet.stats>
	<1118773739.3126.4.camel@localhost.localdomain>
	<x2d5qoa9nf.fsf@turmalin.kubism.ku.dk>
	<1118786837.3968.14.camel@localhost.localdomain>
	<1118918509.3651.26.camel@seurat>
	<1118926290.4912.24.camel@localhost.localdomain>
	<Pine.LNX.4.61.0506161521220.12610@gannet.stats>
Message-ID: <1118934017.4912.64.camel@localhost.localdomain>

On Thu, 2005-06-16 at 15:23 +0100, Prof Brian Ripley wrote:
> On Thu, 16 Jun 2005, Marc Schwartz wrote:
> 
> >> From what I can tell, there is only one reason that the FC-E R RPM is
> > available as a shared library:
> >
> > Tom had made the gnomeGUI CRAN package available as an RPM in FC-E,
> > which of course requires the above:
> >
> > http://fedoraproject.org/extras/4/i386/repodata/repoview/R-gnomeGUI-0-2.1.0-4.html
> >
> > I would defer to the opinion of others here, but given the rather
> > limited functionality of the R GNOME GUI and that not much if any work
> > is presently being done on it (is that correct?), does Tom's approach
> > really make sense?
> 
> No work is being done on it.  It remains only as an example of a console 
> front-end.
> 
> Brian

That being the confirmed case, it seems reasonable to facilitate Tom's
making an informed decision as to the pros and cons of his approach and
that his choice is askew from a "default" R configuration. 

Needless to say, his choice, presumably based upon the inclusion of the
gnomeGUI package, is to an extent exclusionary to KDE and other DE users
who will (unknowingly) pay a defacto performance price if installing R
via FC-E.

Marc


From plummer at iarc.fr  Thu Jun 16 17:53:46 2005
From: plummer at iarc.fr (Martyn Plummer)
Date: Thu, 16 Jun 2005 17:53:46 +0200
Subject: [Rd] a bug in glm.fit() (PR#7947)
In-Reply-To: <Pine.LNX.4.61.0506160703510.21725@gannet.stats>
References: <20050616034227.77C02A1F9@slim.kubism.ku.dk>
	<Pine.LNX.4.61.0506160703510.21725@gannet.stats>
Message-ID: <1118937226.3651.95.camel@seurat>

On Thu, 2005-06-16 at 07:06 +0100, Prof Brian Ripley wrote:
> What is the bug?
> 
> This is the same model: the `intercept' term affects the null model, not 
> the actual model.  Just look at all the output.

I think the documentation is misleading (On a related issue, it still
refers to the defunct glm.fit.null() function). I'll fix it.

Luke, you be using glm() instead of glm.fit().

> On Thu, 16 Jun 2005 jyzz88 at gmail.com wrote:
> 
> > glm.fit() gave me the same AIC's regardless of TRUE or FALSE intercept option.
> >
> >> myX <- as.matrix(1:10)
> >> myY <- 3+5*myX
> >> foo <- glm.fit(x=myX, y=myY, family = gaussian(link = "identity"), intercept=TRUE)
> >> foo$aic
> > [1] 38.94657
> >> foo <- glm.fit(x=myX, y=myY, family = gaussian(link = "identity"), intercept=FALSE)
> >> foo$aic
> > [1] 38.94657
> >>  AIC(lm(myY~0+myX, data=data.frame(myY,myX)))
> > [1] 38.94657
> >> AIC(lm(myY~1+myX, data=data.frame(myY,myX)))
> > [1] -650.9808
> 

-----------------------------------------------------------------------
This message and its attachments are strictly confidential. If you are
not the intended recipient of this message, please immediately notify 
the sender and delete it. Since its integrity cannot be guaranteed, 
its content cannot involve the sender's responsibility. Any misuse, 
any disclosure or publication of its content, either whole or partial, 
is prohibited, exception made of formally approved use


From jeff.horner at vanderbilt.edu  Thu Jun 16 17:56:52 2005
From: jeff.horner at vanderbilt.edu (Jeffrey Horner)
Date: Thu, 16 Jun 2005 10:56:52 -0500
Subject: [Rd] motivation for setRepositories and chooseCRANmirror
Message-ID: <42B1A144.9000708@vanderbilt.edu>


I have some questions and observations about these:

Will these replace manually setting options(CRAN), which doesn't work in 
R-2.1.0?

In R-2.1.0, setRepositories() looks to see if options("repos") contains 
a CRAN entry and will not override that CRAN entry even if the 
$R_HOME/etc/repositories file (which setRepositories reads from) 
contains a  CRAN entry.  Why is this? The user could easily set 
options("repos") without the help of this function anyway? And 
chooseCRANmirror() obviously sets the CRAN entry correctly.

I've checked the latest nightly tarball, R-devel_2005-06-15.tar.gz, and 
this observations persists.

I also observe that the R-2.1.0 Rprofile in the base package sets 
options(repos=c(CRAN="@CRAN@")), so it seems that the only way to set 
the CRAN repository entry is either with chooseCRANmirror() or manually 
setting options("repos") or options("CRAN"). If this was not the case, 
then setRepositories() would choose the CRAN entry from 
$R_HOME/etc/repositories.

In R-2.1.0 and in R-devel_2005-06-15.tar.gz, the R-admin manual suggests 
that for packages to be downloaded and installed within R should set 
options(CRAN = "http://cran.us.r-project.org/"). Will this be changed to 
calling chooseCRANmirror()?

 From an administrator's point of view, I would like to have the CRAN 
option set automatically on R startup for ALL users. That way I don't 
have to set this option before calling update.packages().


-- 
Jeffrey Horner       Computer Systems Analyst         School of Medicine
615-322-8606         Department of Biostatistics   Vanderbilt University


From DiminishedSmith at vorras.net  Thu Jun 16 21:42:19 2005
From: DiminishedSmith at vorras.net (Kerry  P. Robin, II)
Date: Thu, 16 Jun 2005 20:42:19 +0100
Subject: [Rd] Tapes... DVDs... Now this...
Message-ID: <889U5O83P1VB92G2N14XK60EX8@48balai%.fastemailer.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
Url: https://stat.ethz.ch/pipermail/r-devel/attachments/20050616/2c226b35/attachment.pl

From DiminishedSmith at vorras.net  Thu Jun 16 20:49:54 2005
From: DiminishedSmith at vorras.net (DiminishedSmith@vorras.net)
Date: Thu, 16 Jun 2005 20:49:54 +0200 (CEST)
Subject: [Rd] Tapes... DVDs... Now this... (PR#7950)
Message-ID: <20050616184954.CE4ACA20C@slim.kubism.ku.dk>

Hey,

Then I started 'teaching'. You know, I'm a good teacher. (Well, maybe just an average teacher, but you get the jist). I know what good teachers do. Or I thought I did. I sat with the children at the computer. When they pressed the IntelliKeys' keyboard or the Touch Window' and the computer said the word, I repeated the word and then expanded on the word. After they had pressed the same word several times, I said, "That's right, that's a cat, can you find the dog?? Suddenly, I would see the child's back get stiff, and before you knew it, he got up and left the computer. I didn't understand. Just a few seconds ago, he loved it. What happened?

If you can't describe what you are doing as a process, you don't know what you're doing.	W. Edwards Deming	

Thanks Alot,

Bianca Kennedy

	[[alternative HTML version deleted]]


From lars at predict.com  Thu Jun 16 23:22:05 2005
From: lars at predict.com (lars@predict.com)
Date: Thu, 16 Jun 2005 23:22:05 +0200 (CEST)
Subject: [Rd] DispatchOrEval missing in do_isfinite and do_isinfinite
	(PR#7951)
Message-ID: <20050616212205.40A59A1F9@slim.kubism.ku.dk>

Full_Name: Lars Hansen
Version: 2.1.0
OS: SunOS 5.8
Submission from: (NULL) (207.66.36.189)


Hi,

S4 method displacth does not work for the two generic functions 'is.finite' and
'is.infinite'. It turns out that the C functions 'do_isfinite' and
'do_isinfinite' in src/main/coerce.c are missing a call to 'DispatchOrEval' (see
do_isnan). Added in the call fixed the problem. My functions no look like this:

Form coerce.c:

SEXP do_isfinite(SEXP call, SEXP op, SEXP args, SEXP rho)
{
    SEXP ans, x, names, dims;
    int i, n;

    if (DispatchOrEval(call, op, "is.finite", args, rho, &ans, 1, 1))
        return(ans);

    checkArity(op, args);
    ...

SEXP do_isinfinite(SEXP call, SEXP op, SEXP args, SEXP rho)
{
    SEXP ans, x, names, dims;
    double xr, xi;
    int i, n;

    if (DispatchOrEval(call, op, "is.infinite", args, rho, &ans, 1, 1))
        return(ans);

    checkArity(op, args);
    ...

Thanks you,
Lars


From jbaltzer at oeb.harvard.edu  Thu Jun 16 23:30:19 2005
From: jbaltzer at oeb.harvard.edu (jbaltzer@oeb.harvard.edu)
Date: Thu, 16 Jun 2005 23:30:19 +0200 (CEST)
Subject: [Rd] 2.1.0a for Macs (PR#7952)
Message-ID: <20050616213019.26B8FA1E7@slim.kubism.ku.dk>

I am writing regarding serious problems that a number of 
researchers at a workshop held by the Smithsonian Tropical 
Research Institute are encountering with the most recent R 
version for Macs (the patched version of 2.1.0 (2.1.0a) that 
you indicate should be used over 2.1.0).

The following problems are not specific to my computer but are 
being experienced by ALL Mac users at this workshop running 
2.1.0a to varying degrees. I installed the program about a week 
ago and immediately I started getting a warning messages 
particularly when browsing my files using ls(), search(), gc(), 
etc.  2.1.0a automatically adds an open parentheses at the end 
of any command requiring () (only intermittently, however) and 
then generates a warning in red.  I am afraid that I do not 
have the warning because R no longer will open on my computer 
without reinstallation so I am forced to use a PC.  The same 
warning message has been posted by one other on the help email 
list.  More recently, R has begun to crash for no particular 
reason (no large program running).  Often when I then try to 
restart R 2.1.0a crashes during start up and in order to get it 
functioning again I have to reinstall!  The first time this 
happened I decided to go back to an earlier version of R that I 
knew would be stable but following binary compilation no gui is 
installed on my computer and I can't run the program.  The only 
version my computer can now install properly is 2.1.0a but as 
described above the problems with the program prohibit me from 
using it.

If you could please advise on how to deal with these problems 
(particularly the corruption of my system by 2.1.0a) all the 
Mac users at this conference would be appreciative.

Jennifer Baltzer


From simon.urbanek at r-project.org  Fri Jun 17 00:14:30 2005
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Thu, 16 Jun 2005 18:14:30 -0400
Subject: [Rd] 2.1.0a for Macs (PR#7952)
In-Reply-To: <20050616213019.26B8FA1E7@slim.kubism.ku.dk>
References: <20050616213019.26B8FA1E7@slim.kubism.ku.dk>
Message-ID: <A8CFC05B-D08E-4AEC-8096-0BA0CF20C6B5@r-project.org>

On Jun 16, 2005, at 5:30 PM, jbaltzer at oeb.harvard.edu wrote:

> I installed the program about a week ago and immediately I started  
> getting a warning messages particularly when browsing my files  
> using ls(), search(), gc(),

This was fixed in R.app build 1564 and was mentioned several times on  
the Mac list. It is recommended to update your R.app. If you have  
problems with the most recent version (as of today it's build 1596),  
please let us know.

> More recently, R has begun to crash for no particular reason (no  
> large program running).  Often when I then try to restart R 2.1.0a  
> crashes during start up and in order to get it functioning again I  
> have to reinstall!

Can you, please, send us the crash report and/or the console output?  
Without any evidence reports like yours are pretty much useless  
(please read the documentation and FAQ!). Also note that R 2.1.1 will  
be released really soon so it's important to report bugs using R  
2.1.1 beta and not old versions.

> The first time this happened I decided to go back to an earlier  
> version of R that I knew would be stable but following binary  
> compilation no gui is installed on my computer and I can't run the  
> program.

What do you mean by "binary compilation" - if you feel like  
installing an older version all you have to do is to get the 2.1.0  
image and install it. However, I doubt that this will solve any  
problems, but it's completely legal to do so. You can also safely use  
older versions of R.app if you want - 2.1.0 and 2.1.0a are by  
definition binary compatible. R itself didn't change substantially  
between 2.1.0 and 2.1.0a (only a couple of bugs were fixed, most  
notably package installation). What did change was R.app and as I  
already mentioned there are good reasons for using the most recent  
version.

> If you could please advise on how to deal with these problems  
> (particularly the corruption of my system by 2.1.0a)

You didn't mention any system corruption so far - you'll have to  
explain this a bit ...

Cheers,
Simon


From zur at uchicago.edu  Fri Jun 17 03:29:48 2005
From: zur at uchicago.edu (zur@uchicago.edu)
Date: Fri, 17 Jun 2005 03:29:48 +0200 (CEST)
Subject: [Rd] R worked once, now will not open.  Works in console,
	but won't graph. (PR#7953)
Message-ID: <20050617012948.92494A1E7@slim.kubism.ku.dk>

Full_Name: Richard Zur
Version: 2.1.0a
OS: 10.3.9
Submission from: (NULL) (67.176.250.164)


I erased R 2.0.1 (the R.app and the framework) and installed R 2.1.0a.  I ran it
once, then shut down without saving the workspace.  Now it doesn't start at all.
 I've erased it a couple of times and re-installed (not installing the libraries
I use, coda, MCMCpack, MASS and bayesm) but the same problem arises.

Date/Time:      2005-06-16 20:27:57 -0500
OS Version:     10.3.9 (Build 7W98)
Report Version: 2

Command: R
Path:    /Applications/R.app/Contents/MacOS/R
Version: 1.11 (1.11)
PID:     1605
Thread:  0

Exception:  EXC_BREAKPOINT (0x0006)
Code[0]:    0x00000001
Code[1]:    0x9023dc44


Thread 0 Crashed:
0   com.apple.CoreFoundation 	0x9023dc44 __HALT + 0
1   com.apple.CoreFoundation 	0x901c2164 CFDictionaryGetValue + 0xec
2   com.apple.Foundation     	0x90a290d4 +[NSLanguageContext
_alternateICUValueForKey:] + 0x48
3   com.apple.Foundation     	0x90a2bc8c -[NSUserDefaults objectForKey:] + 0x30
4   com.apple.Foundation     	0x90ab49dc -[NSUserDefaults dataForKey:] + 0x20
5   org.R-project.R          	0x0001cc2c +[Preferences
unarchivedObjectForKey:withDefault:] + 0x48
6   org.R-project.R          	0x0000b740 -[RController updatePreferences] +
0xe8
7   org.R-project.R          	0x000036a4 -[RController awakeFromNib] + 0x16c
8   com.apple.Foundation     	0x90a5f0e8 -[NSSet makeObjectsPerformSelector:] +
0xa4
9   com.apple.AppKit         	0x92ea2150 -[NSIBObjectData
nibInstantiateWithOwner:topLevelObjects:] + 0x358
10  com.apple.AppKit         	0x92f93c2c loadNib + 0xfc
11  com.apple.AppKit         	0x92eeae24 +[NSBundle(NSNibLoading)
_loadNibFile:nameTable:withZone:ownerBundle:] + 0x2e8
12  com.apple.AppKit         	0x92f69d28 +[NSBundle(NSNibLoading)
loadNibFile:externalNameTable:withZone:] + 0x9c
13  com.apple.AppKit         	0x92f7b51c +[NSBundle(NSNibLoading)
loadNibNamed:owner:] + 0x174
14  com.apple.AppKit         	0x92f69b90 NSApplicationMain + 0x174
15  org.R-project.R          	0x00002ba0 _start + 0x188 (crt.c:267)
16  dyld                     	0x8fe1a278 _dyld_start + 0x64

PPC Thread State:
  srr0: 0x9023dc44 srr1: 0x0202f030                vrsave: 0x00000000
    cr: 0x22000248  xer: 0x00000007   lr: 0x901c2d08  ctr: 0x9023dc44
    r0: 0x901c2d08   r1: 0xbffff710   r2: 0xa01c2be8   r3: 0xbff00000
    r4: 0x00000000   r5: 0xbff00000   r6: 0x003eadd0   r7: 0x00000000
    r8: 0x00000000   r9: 0x00000000  r10: 0x908321ac  r11: 0xa0a20f9c
   r12: 0x9023dc44  r13: 0x00000000  r14: 0x00000000  r15: 0x00000000
   r16: 0x00043538  r17: 0x00043538  r18: 0x00043538  r19: 0x00043538
   r20: 0x00043538  r21: 0x00043538  r22: 0x00043538  r23: 0xa2eacd9c
   r24: 0x0003cc08  r25: 0x0003b658  r26: 0xbff00000  r27: 0x00000008
   r28: 0x00318ac0  r29: 0xa01c3140  r30: 0x00318ac0  r31: 0x901c2ca8

Binary Images Description:
    0x1000 -    0x38fff org.R-project.R 1.11
/Applications/R.app/Contents/MacOS/R
  0x205000 -   0x226fff libreadline.5.0.dylib 
/Library/Frameworks/R.framework/Resources/lib/libreadline.5.0.dylib
 0x1008000 -  0x1195fff libR.dylib 
/Library/Frameworks/R.framework/Resources/lib/libR.dylib
0x806c0000 - 0x806e9fff libxslt.1.dylib 	/usr/lib/libxslt.1.dylib
0x80830000 - 0x8090efff libxml2.2.dylib 	/usr/lib/libxml2.2.dylib
0x8ed60000 - 0x8ed62fff com.apple.ExceptionHandling 1.2 (???)
/System/Library/Frameworks/ExceptionHandling.framework/Versions/A/ExceptionHandling
0x8fe00000 - 0x8fe4ffff dyld 	/usr/lib/dyld
0x90000000 - 0x9014ffff libSystem.B.dylib 	/usr/lib/libSystem.B.dylib
0x901c0000 - 0x9026dfff com.apple.CoreFoundation 6.3.7 (299.35)
/System/Library/Frameworks/CoreFoundation.framework/Versions/A/CoreFoundation
0x902b0000 - 0x90529fff com.apple.CoreServices.CarbonCore 10.3.7
/System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/CarbonCore.framework/Versions/A/CarbonCore
0x90584000 - 0x905f3fff com.apple.framework.IOKit 1.3.6 (???)
/System/Library/Frameworks/IOKit.framework/Versions/A/IOKit
0x90610000 - 0x9069afff com.apple.CoreServices.OSServices 3.0.1
/System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/OSServices.framework/Versions/A/OSServices
0x90700000 - 0x90700fff com.apple.CoreServices 10.3 (???)
/System/Library/Frameworks/CoreServices.framework/Versions/A/CoreServices
0x907f0000 - 0x907f9fff com.apple.DiskArbitration 2.0.5
/System/Library/PrivateFrameworks/DiskArbitration.framework/Versions/A/DiskArbitration
0x90810000 - 0x90810fff com.apple.ApplicationServices 1.0 (???)
/System/Library/Frameworks/ApplicationServices.framework/Versions/A/ApplicationServices
0x90830000 - 0x9089ffff libobjc.A.dylib 	/usr/lib/libobjc.A.dylib
0x908c5000 - 0x908d5fff com.apple.vecLib 3.0.3 (vecLib 3.0.3)
/System/Library/Frameworks/vecLib.framework/Versions/A/vecLib
0x90940000 - 0x909b3fff com.apple.DesktopServices 1.2.5
/System/Library/PrivateFrameworks/DesktopServicesPriv.framework/Versions/A/DesktopServicesPriv
0x909f0000 - 0x90a03fff com.apple.speech.synthesis.framework 3.2
/System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/SpeechSynthesis.framework/Versions/A/SpeechSynthesis
0x90a20000 - 0x90b7bfff com.apple.Foundation 6.3.7 (500.59)
/System/Library/Frameworks/Foundation.framework/Versions/C/Foundation
0x90c32000 - 0x90c46fff libCGATS.A.dylib 
/System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/CoreGraphics.framework/Versions/A/Resources/libCGATS.A.dylib
0x90d20000 - 0x90d3bfff com.apple.SystemConfiguration 1.7.1 (???)
/System/Library/Frameworks/SystemConfiguration.framework/Versions/A/SystemConfiguration
0x90ec0000 - 0x90ec0fff com.apple.Cocoa 6.3 (???)
/System/Library/Frameworks/Cocoa.framework/Versions/A/Cocoa
0x90ec2000 - 0x90fa4fff com.apple.JavaScriptCore 312
/System/Library/Frameworks/WebKit.framework/Versions/A/Frameworks/JavaScriptCore.framework/Versions/A/JavaScriptCore
0x90ff8000 - 0x90ff8fff com.apple.audio.units.AudioUnit 1.3.3
/System/Library/Frameworks/AudioUnit.framework/Versions/A/AudioUnit
0x910b0000 - 0x91101fff com.apple.bom 1.2.5 (63.2)
/System/Library/PrivateFrameworks/Bom.framework/Versions/A/Bom
0x91246000 - 0x9127efff com.apple.AE 1.4
/System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/AE.framework/Versions/A/AE
0x913a0000 - 0x9145ffff ColorSync 
/System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/ColorSync.framework/Versions/A/ColorSync
0x914e0000 - 0x91549fff com.apple.htmlrendering 1.1.2
/System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/HTMLRendering.framework/Versions/A/HTMLRendering
0x9157a000 - 0x91585fff libCSync.A.dylib 
/System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/CoreGraphics.framework/Versions/A/Resources/libCSync.A.dylib
0x915e0000 - 0x91699fff com.apple.QD 3.4.67 (???)
/System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/QD.framework/Versions/A/QD
0x91720000 - 0x917b3fff com.apple.print.framework.PrintCore 3.3
/System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/PrintCore.framework/Versions/A/PrintCore
0x91820000 - 0x91830fff com.apple.speech.recognition.framework 3.3
/System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/SpeechRecognition.framework/Versions/A/SpeechRecognition
0x91850000 - 0x9186afff com.apple.openscripting 1.2.1 (???)
/System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/OpenScripting.framework/Versions/A/OpenScripting
0x91890000 - 0x918a0fff com.apple.ImageCapture 2.1.5
/System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/ImageCapture.framework/Versions/A/ImageCapture
0x918d0000 - 0x918dcfff com.apple.help 1.0.1
/System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/Help.framework/Versions/A/Help
0x91900000 - 0x9190dfff com.apple.CommonPanels 1.2.1 (1.0)
/System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/CommonPanels.framework/Versions/A/CommonPanels
0x91930000 - 0x9197efff com.apple.print.framework.Print 3.3
/System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/Print.framework/Versions/A/Print
0x919d0000 - 0x919dbfff com.apple.securityhi 1.2 (90)
/System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/SecurityHI.framework/Versions/A/SecurityHI
0x91a40000 - 0x91ab3fff com.apple.NavigationServices 3.3.3
/System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/NavigationServices.framework/Versions/A/NavigationServices
0x91b10000 - 0x91b2afff libPDFRIP.A.dylib 
/System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/CoreGraphics.framework/Versions/A/Resources/libPDFRIP.A.dylib
0x91b50000 - 0x91b5ffff libPSRIP.A.dylib 
/System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/CoreGraphics.framework/Versions/A/Resources/libPSRIP.A.dylib
0x91bc0000 - 0x91bd3fff libRIP.A.dylib 
/System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/CoreGraphics.framework/Versions/A/Resources/libRIP.A.dylib
0x91f0d000 - 0x91f0dfff com.apple.Carbon 10.3 (???)
/System/Library/Frameworks/Carbon.framework/Versions/A/Carbon
0x920f0000 - 0x92116fff com.apple.FindByContent 1.4 (1.2)
/System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/FindByContent.framework/Versions/A/FindByContent
0x92140000 - 0x92327fff com.apple.security 2.4 (177)
/System/Library/Frameworks/Security.framework/Versions/A/Security
0x924b0000 - 0x924e8fff com.apple.LaunchServices 10.3.5 (98.4)
/System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/LaunchServices.framework/Versions/A/LaunchServices
0x927a7000 - 0x927befff com.apple.LangAnalysis 1.5.4
/System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/LangAnalysis.framework/Versions/A/LangAnalysis
0x927f0000 - 0x92827fff com.apple.CFNetwork 1.2.1 (7)
/System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/CFNetwork.framework/Versions/A/CFNetwork
0x92880000 - 0x92c05fff com.apple.HIToolbox 1.3.6 (???)
/System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/HIToolbox.framework/Versions/A/HIToolbox
0x92e70000 - 0x9336ffff com.apple.AppKit 6.3.8 (743.39)
/System/Library/Frameworks/AppKit.framework/Versions/C/AppKit
0x93a20000 - 0x93a34fff libcups.2.dylib 	/usr/lib/libcups.2.dylib
0x93a50000 - 0x93a54fff libmathCommon.A.dylib 
/usr/lib/system/libmathCommon.A.dylib
0x940f0000 - 0x94108fff com.apple.WebServices 1.1.1 (1.1.0)
/System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/WebServicesCore.framework/Versions/A/WebServicesCore
0x941b0000 - 0x941dbfff libncurses.5.dylib 	/usr/lib/libncurses.5.dylib
0x944c0000 - 0x94556fff com.apple.WebKit 312.1
/System/Library/Frameworks/WebKit.framework/Versions/A/WebKit
0x94640000 - 0x94649fff libz.1.dylib 	/usr/lib/libz.1.dylib
0x9464c000 - 0x9469cfff com.apple.HIServices 1.4.1 (0.0.1d1)
/System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/HIServices.framework/Versions/A/HIServices
0x946e0000 - 0x9473ffff com.apple.SearchKit 1.0.2
/System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/SearchKit.framework/Versions/A/SearchKit
0x9477d000 - 0x9479afff com.apple.audio.SoundManager 3.9
/System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/CarbonSound.framework/Versions/A/CarbonSound
0x94800000 - 0x9488cfff com.apple.ink.framework 101.1.4 (55.12)
/System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/Ink.framework/Versions/A/Ink
0x949ba000 - 0x949d4fff libresolv.9.dylib 	/usr/lib/libresolv.9.dylib
0x94ea0000 - 0x954a6fff libBLAS.dylib 
/System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libBLAS.dylib
0x95500000 - 0x957d0fff libLAPACK.dylib 
/System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libLAPACK.dylib
0x958e0000 - 0x95900fff libvMisc.dylib 
/System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libvMisc.dylib
0x95b50000 - 0x95c32fff libicucore.A.dylib 	/usr/lib/libicucore.A.dylib
0x95ca0000 - 0x95d62fff libcrypto.0.9.7.dylib 	/usr/lib/libcrypto.0.9.7.dylib
0x95dc0000 - 0x95deefff libssl.0.9.7.dylib 	/usr/lib/libssl.0.9.7.dylib
0x95e40000 - 0x95eadfff libvDSP.dylib 
/System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libvDSP.dylib
0x95f30000 - 0x9601efff libiconv.2.dylib 	/usr/lib/libiconv.2.dylib
0x96092000 - 0x960f9fff com.apple.audio.CoreAudio 2.1.3
/System/Library/Frameworks/CoreAudio.framework/Versions/A/CoreAudio
0x96b50000 - 0x96bdffff ATS 
/System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/ATS.framework/Versions/A/ATS
0x96fd8000 - 0x97090fff com.apple.audio.toolbox.AudioToolbox 1.3.3
/System/Library/Frameworks/AudioToolbox.framework/Versions/A/AudioToolbox
0x970f0000 - 0x970f8fff libbsm.dylib 	/usr/lib/libbsm.dylib
0x973e0000 - 0x976c6fff com.apple.WebCore 315
/System/Library/Frameworks/WebKit.framework/Versions/A/Frameworks/WebCore.framework/Versions/A/WebCore
0x97915000 - 0x97bedfff com.apple.CoreGraphics 1.203.30 (???)
/System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/CoreGraphics.framework/Versions/A/CoreGraphics


From simon.urbanek at r-project.org  Fri Jun 17 08:34:53 2005
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Fri, 17 Jun 2005 02:34:53 -0400
Subject: [Rd] R worked once, now will not open.  Works in console,
	but won't graph. (PR#7953)
In-Reply-To: <20050617012948.92494A1E7@slim.kubism.ku.dk>
References: <20050617012948.92494A1E7@slim.kubism.ku.dk>
Message-ID: <65F3D925-7D48-4991-AF6F-41BB3E4EDA70@r-project.org>

Richard,

thank you for the report. From the log it seems to be a problem with  
your preferences. Please delete the file ~/Library/Preferences/org.R- 
project.R.plist (e.g. type
rm  ~/Library/Preferences/org.R-project.R.plist
in Terminal or simply delete than file using Finder) and let me know  
if that fixes the problem (actually if it's easy for you to do you  
could send me the file before you delete it if it turns out to be the  
problem). In addition you may want to download the latest version of  
R.app from http://www.rosuda.org/R/nightly/ .

Cheers,
Simon


From ripley at stats.ox.ac.uk  Fri Jun 17 08:42:12 2005
From: ripley at stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Fri, 17 Jun 2005 08:42:12 +0200 (CEST)
Subject: [Rd] (PR#7951) DispatchOrEval missing in do_isfinite and
Message-ID: <20050617064212.7D65BF8FA@slim.kubism.ku.dk>

These functions are not generic according to the help page.
The same page says explicitly that is.nan is generic.

Where did you get the (false) idea that they were generic?

On Thu, 16 Jun 2005 lars at predict.com wrote:

> Full_Name: Lars Hansen
> Version: 2.1.0
> OS: SunOS 5.8
> Submission from: (NULL) (207.66.36.189)
>
>
> Hi,
>
> S4 method displacth does not work for the two generic functions 
> 'is.finite' and 'is.infinite'. It turns out that the C functions 
> 'do_isfinite' and 'do_isinfinite' in src/main/coerce.c are missing a 
> call to 'DispatchOrEval' (see do_isnan). Added in the call fixed the 
> problem. My functions no look like this:
>
> Form coerce.c:
>
> SEXP do_isfinite(SEXP call, SEXP op, SEXP args, SEXP rho)
> {
>    SEXP ans, x, names, dims;
>    int i, n;
>
>    if (DispatchOrEval(call, op, "is.finite", args, rho, &ans, 1, 1))
>        return(ans);
>
>    checkArity(op, args);
>    ...
>
> SEXP do_isinfinite(SEXP call, SEXP op, SEXP args, SEXP rho)
> {
>    SEXP ans, x, names, dims;
>    double xr, xi;
>    int i, n;
>
>    if (DispatchOrEval(call, op, "is.infinite", args, rho, &ans, 1, 1))
>        return(ans);
>
>    checkArity(op, args);
>    ...

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From ripley at stats.ox.ac.uk  Fri Jun 17 13:50:54 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri, 17 Jun 2005 12:50:54 +0100 (BST)
Subject: [Rd] R Include File Guards
In-Reply-To: <Pine.OSF.4.58.0506151612190.332019@odin.mdacc.tmc.edu>
References: <Pine.OSF.4.58.0505181524160.204610@odin.mdacc.tmc.edu>
	<x2psvorz1q.fsf@turmalin.kubism.ku.dk>
	<Pine.OSF.4.58.0506151612190.332019@odin.mdacc.tmc.edu>
Message-ID: <Pine.LNX.4.61.0506171120010.9328@gannet.stats>

What is the `bug' here which you suggest reporting?

We have already established that leading underscores are NOT `illegal', 
just reserved and possibly ineffective according to the C99 standard 
(although we don't have any evidence of that being followed by an actual 
compiler). Given that the system includes on all three of my OSes use 
guards with leading underscores, they were VERY unlikely to be `illegal' 
as you stated.  (Looking in /usr/local/include shows that they are very 
widely used in other projects.)

Is there any known platform on which there is a consequential problem? 
If not (and we have no evidence), we do not play around with non-bugs in 
patch releases.

Some adjustments have been made in the development version of R.
BTW: not all files in R_ext are part of the API: however GraphicsDevice.h 
and GraphicsEngine.h are and they are now compatible with C++ and have 
guards.

On Wed, 15 Jun 2005, Paul Roebuck wrote:

> On Wed, 18 May 2005, Peter Dalgaard wrote:
>
>> Paul Roebuck <roebuck at odin.mdacc.tmc.edu> writes:
>>
>>> R 2.1.0/src/include from 2005/04/18 download
>>>
>>> Naming inconsistent for guards as well but that's pedantic.
>>> Simple convention:
>>>   file <foo.h>
>>>     #ifndef R_FOO_H
>>>   file <R_ext/bar.h>
>>>     #ifndef R_EXT_BAR_H
>>>
>>> Missing guards:
>>> <IOStuff.h>
>>> <Internal.h>
>>> <Parse.h>
>>> <R_ext/GraphicsBase.h>
>>> <R_ext/GraphicsDevice.h>
>>> <R_ext/GraphicsEngine.h>
>>> <R_ext/R-ftp-http.h>
>>> <R_ext/libextern.h>
>>>
>>>
>>> Illegal Guards (leading underscore):
>>> <Rinternals.h>
>>> <R_ext/Error.h>
>>> <config.h.in>
>>
>> Thanks. The ones outside R_ext, except Rinternals.h, are not part of 
the
>> API, so it is not a bug that there are no guards - could still be a
>> good idea to have them of course. libextern.h explicitly says that you
>> shouldn't disallow including it more than once. So the ones with real
>> problems would be
>>
>> <R_ext/GraphicsBase.h>
>> <R_ext/GraphicsDevice.h>
>> <R_ext/GraphicsEngine.h>
>> <R_ext/R-ftp-http.h>
>>
>> <Rinternals.h>
>> <R_ext/Error.h>
>>
>> What's illegal about leading underscores, BTW?
>>
>
> I downloaded the R-patched for 2005/06/14 and noticed that
> the guards were never fixed. Should a bug report have been
> opened instead of simply noting them here?
>


-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From deepayan.sarkar at gmail.com  Fri Jun 17 14:58:01 2005
From: deepayan.sarkar at gmail.com (Deepayan Sarkar)
Date: Fri, 17 Jun 2005 07:58:01 -0500
Subject: [Rd] hist.default documentation
Message-ID: <eb555e660506170558193cf927@mail.gmail.com>

I think there are a couple of things in ?hist that are not quite as
clear as they could be.

(1)    

  freq: logical; if 'TRUE', the histogram graphic is a representation
          of frequencies, the 'counts' component of the result; if
          'FALSE', _relative_ frequencies ("probabilities"), component
          'density', are plotted.   Defaults to 'TRUE' _iff_ 'breaks'
          are equidistant (and 'probability' is not specified).
 
Unless I'm missing something, the 'density' component is NOT relative
frequency or 'probability' in any reasonable sense, country-specific
biases notwithstanding, except in the very special case where
all(diff(breaks) == 1). Thus, the above description is confusing and
probably even wrong.

Also, it seems to me that hist cannot draw a relative frequency
histogram at all (which is not a bad thing, but it's of course very
important to the undergrads we're teaching intro stats and R to). This
should be explicitly mentioned.

(2) 

  breaks: one of:

             ...
             *  a single number giving the number of cells for the
                histogram,
             ...

This is not quite true. 'breaks' is used in 'pretty', so it's more a
suggestion than an exact specification. I'm not sure whether or not
the behaviour should be changed (what's the point of having ``pretty''
breakpoints anyway?), but if not, the documentation should be
clarified.

I'll be happy to provide a patch if these changes are considered reasonable.

Deepayan


From murdoch at stats.uwo.ca  Fri Jun 17 15:21:14 2005
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Fri, 17 Jun 2005 09:21:14 -0400
Subject: [Rd] hist.default documentation
In-Reply-To: <eb555e660506170558193cf927@mail.gmail.com>
References: <eb555e660506170558193cf927@mail.gmail.com>
Message-ID: <42B2CE4A.1090802@stats.uwo.ca>

On 6/17/2005 8:58 AM, Deepayan Sarkar wrote:
> I think there are a couple of things in ?hist that are not quite as
> clear as they could be.
> 
> (1)    
> 
>   freq: logical; if 'TRUE', the histogram graphic is a representation
>           of frequencies, the 'counts' component of the result; if
>           'FALSE', _relative_ frequencies ("probabilities"), component
>           'density', are plotted.   Defaults to 'TRUE' _iff_ 'breaks'
>           are equidistant (and 'probability' is not specified).
>  
> Unless I'm missing something, the 'density' component is NOT relative
> frequency or 'probability' in any reasonable sense, country-specific
> biases notwithstanding, except in the very special case where
> all(diff(breaks) == 1). Thus, the above description is confusing and
> probably even wrong.

I agree.

> Also, it seems to me that hist cannot draw a relative frequency
> histogram at all (which is not a bad thing, but it's of course very
> important to the undergrads we're teaching intro stats and R to). This
> should be explicitly mentioned.

I'm not sure about this.  Is it really worth mentioning something if you 
can't do it?  Are you thinking of just giving a reference to barplot?

> (2) 
> 
>   breaks: one of:
> 
>              ...
>              *  a single number giving the number of cells for the
>                 histogram,
>              ...
> 
> This is not quite true. 'breaks' is used in 'pretty', so it's more a
> suggestion than an exact specification. I'm not sure whether or not
> the behaviour should be changed (what's the point of having ``pretty''
> breakpoints anyway?), but if not, the documentation should be
> clarified.

I like the pretty breakpoints. It is good to label the breakpoints, and 
ugly to have labels at other than pretty points.  I'd clarify by 
changing "giving" to "suggesting".

> I'll be happy to provide a patch if these changes are considered reasonable.

Please do.

Duncan Murdoch


From deepayan.sarkar at gmail.com  Fri Jun 17 16:30:23 2005
From: deepayan.sarkar at gmail.com (Deepayan Sarkar)
Date: Fri, 17 Jun 2005 09:30:23 -0500
Subject: [Rd] hist.default documentation
In-Reply-To: <42B2CE4A.1090802@stats.uwo.ca>
References: <eb555e660506170558193cf927@mail.gmail.com>
	<42B2CE4A.1090802@stats.uwo.ca>
Message-ID: <eb555e660506170730554af5f2@mail.gmail.com>

On 6/17/05, Duncan Murdoch <murdoch at stats.uwo.ca> wrote:
> On 6/17/2005 8:58 AM, Deepayan Sarkar wrote:
> > I think there are a couple of things in ?hist that are not quite as
> > clear as they could be.
> >
> > (1)
> >
> >   freq: logical; if 'TRUE', the histogram graphic is a representation
> >           of frequencies, the 'counts' component of the result; if
> >           'FALSE', _relative_ frequencies ("probabilities"), component
> >           'density', are plotted.   Defaults to 'TRUE' _iff_ 'breaks'
> >           are equidistant (and 'probability' is not specified).
> >
> > Unless I'm missing something, the 'density' component is NOT relative
> > frequency or 'probability' in any reasonable sense, country-specific
> > biases notwithstanding, except in the very special case where
> > all(diff(breaks) == 1). Thus, the above description is confusing and
> > probably even wrong.
> 
> I agree.
> 
> > Also, it seems to me that hist cannot draw a relative frequency
> > histogram at all (which is not a bad thing, but it's of course very
> > important to the undergrads we're teaching intro stats and R to). This
> > should be explicitly mentioned.
> 
> I'm not sure about this.  Is it really worth mentioning something if you
> can't do it?  Are you thinking of just giving a reference to barplot?

Not mentioning it is fine.

> > (2)
> >
> >   breaks: one of:
> >
> >              ...
> >              *  a single number giving the number of cells for the
> >                 histogram,
> >              ...
> >
> > This is not quite true. 'breaks' is used in 'pretty', so it's more a
> > suggestion than an exact specification. I'm not sure whether or not
> > the behaviour should be changed (what's the point of having ``pretty''
> > breakpoints anyway?), but if not, the documentation should be
> > clarified.
> 
> I like the pretty breakpoints. It is good to label the breakpoints, and
> ugly to have labels at other than pretty points.  I'd clarify by
> changing "giving" to "suggesting".

Actually, I missed the remark just below this:

          In the last three cases the number is a suggestion only.

so this is fine as it is.

> > I'll be happy to provide a patch if these changes are considered reasonable.
> 
> Please do.

Here's the output of svn diff. Is this a reasonable way of providing a patch?

Index: hist.Rd
===================================================================
--- hist.Rd     (revision 34748)
+++ hist.Rd     (working copy)
@@ -28,9 +28,9 @@
   }
   \item{freq}{logical; if \code{TRUE}, the histogram graphic is a
     representation of frequencies, the \code{counts} component of
-    the result; if \code{FALSE}, \emph{relative} frequencies
-    (\dQuote{probabilities}), component \code{density},
-    are plotted.   Defaults to \code{TRUE} \emph{iff} \code{breaks} are
+    the result; if \code{FALSE}, probability densities, component
+    \code{density}, are plotted (so that the histogram has a total area
+    of one).  Defaults to \code{TRUE} \emph{iff} \code{breaks} are
     equidistant (and \code{probability} is not specified).}
   \item{probability}{an \emph{alias} for \code{!freq}, for S compatibility.}
   \item{include.lowest}{logical; if \code{TRUE}, an \code{x[i]} equal to

Deepayan


From murdoch at stats.uwo.ca  Fri Jun 17 17:09:48 2005
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Fri, 17 Jun 2005 11:09:48 -0400
Subject: [Rd] hist.default documentation
In-Reply-To: <eb555e660506170730554af5f2@mail.gmail.com>
References: <eb555e660506170558193cf927@mail.gmail.com>	
	<42B2CE4A.1090802@stats.uwo.ca>
	<eb555e660506170730554af5f2@mail.gmail.com>
Message-ID: <42B2E7BC.5050108@stats.uwo.ca>

Thanks, I've committed the change.

Duncan Murdoch

On 6/17/2005 10:30 AM, Deepayan Sarkar wrote:
> On 6/17/05, Duncan Murdoch <murdoch at stats.uwo.ca> wrote:
>> On 6/17/2005 8:58 AM, Deepayan Sarkar wrote:
>> > I think there are a couple of things in ?hist that are not quite as
>> > clear as they could be.
>> >
>> > (1)
>> >
>> >   freq: logical; if 'TRUE', the histogram graphic is a representation
>> >           of frequencies, the 'counts' component of the result; if
>> >           'FALSE', _relative_ frequencies ("probabilities"), component
>> >           'density', are plotted.   Defaults to 'TRUE' _iff_ 'breaks'
>> >           are equidistant (and 'probability' is not specified).
>> >
>> > Unless I'm missing something, the 'density' component is NOT relative
>> > frequency or 'probability' in any reasonable sense, country-specific
>> > biases notwithstanding, except in the very special case where
>> > all(diff(breaks) == 1). Thus, the above description is confusing and
>> > probably even wrong.
>> 
>> I agree.
>> 
>> > Also, it seems to me that hist cannot draw a relative frequency
>> > histogram at all (which is not a bad thing, but it's of course very
>> > important to the undergrads we're teaching intro stats and R to). This
>> > should be explicitly mentioned.
>> 
>> I'm not sure about this.  Is it really worth mentioning something if you
>> can't do it?  Are you thinking of just giving a reference to barplot?
> 
> Not mentioning it is fine.
> 
>> > (2)
>> >
>> >   breaks: one of:
>> >
>> >              ...
>> >              *  a single number giving the number of cells for the
>> >                 histogram,
>> >              ...
>> >
>> > This is not quite true. 'breaks' is used in 'pretty', so it's more a
>> > suggestion than an exact specification. I'm not sure whether or not
>> > the behaviour should be changed (what's the point of having ``pretty''
>> > breakpoints anyway?), but if not, the documentation should be
>> > clarified.
>> 
>> I like the pretty breakpoints. It is good to label the breakpoints, and
>> ugly to have labels at other than pretty points.  I'd clarify by
>> changing "giving" to "suggesting".
> 
> Actually, I missed the remark just below this:
> 
>           In the last three cases the number is a suggestion only.
> 
> so this is fine as it is.
> 
>> > I'll be happy to provide a patch if these changes are considered reasonable.
>> 
>> Please do.
> 
> Here's the output of svn diff. Is this a reasonable way of providing a patch?
> 
> Index: hist.Rd
> ===================================================================
> --- hist.Rd     (revision 34748)
> +++ hist.Rd     (working copy)
> @@ -28,9 +28,9 @@
>    }
>    \item{freq}{logical; if \code{TRUE}, the histogram graphic is a
>      representation of frequencies, the \code{counts} component of
> -    the result; if \code{FALSE}, \emph{relative} frequencies
> -    (\dQuote{probabilities}), component \code{density},
> -    are plotted.   Defaults to \code{TRUE} \emph{iff} \code{breaks} are
> +    the result; if \code{FALSE}, probability densities, component
> +    \code{density}, are plotted (so that the histogram has a total area
> +    of one).  Defaults to \code{TRUE} \emph{iff} \code{breaks} are
>      equidistant (and \code{probability} is not specified).}
>    \item{probability}{an \emph{alias} for \code{!freq}, for S compatibility.}
>    \item{include.lowest}{logical; if \code{TRUE}, an \code{x[i]} equal to
> 
> Deepayan


From lars at predict.com  Fri Jun 17 18:45:16 2005
From: lars at predict.com (lars@predict.com)
Date: Fri, 17 Jun 2005 18:45:16 +0200 (CEST)
Subject: [Rd] (PR#7951) DispatchOrEval missing in do_isfinite and
	do_isinfinite
Message-ID: <20050617164516.D8830A24A@slim.kubism.ku.dk>

Hi,

OK, if you try to explicitly make them generic, you are told that they 
are implicitly already generic:

 > setGeneric("is.finite", function(from, ...) standardGeneric("is.finite"))
Error in setGeneric("is.finite", function(from, ...) 
standardGeneric("is.finite")) :
    "is.finite" is a primitive function;  methods can be defined, but 
the generic function is implicit, and can't be changed.

If you query about its genericness before you define you own generic, 
you get:

 > isGeneric("is.finite")
[1] FALSE

But after you define you own generic, you get:

 > setMethod("is.finite", signature(x="TS"),
+           function(x) {
+              Data(x) = callNextMethod()
+              x
+           })
[1] "is.finite"

 > isGeneric("is.finite")
[1] TRUE

This all makes some sense, but I am not familiar enough with he 
internals to explain exactly why it is done this way. I think you will 
fine that 'is.nan' behave exactly the same way.

Thanks,
Lars


Prof Brian Ripley wrote:

> These functions are not generic according to the help page.
> The same page says explicitly that is.nan is generic.
>
> Where did you get the (false) idea that they were generic?
>
> On Thu, 16 Jun 2005 lars at predict.com wrote:
>
>> Full_Name: Lars Hansen
>> Version: 2.1.0
>> OS: SunOS 5.8
>> Submission from: (NULL) (207.66.36.189)
>>
>>
>> Hi,
>>
>> S4 method displacth does not work for the two generic functions 
>> 'is.finite' and 'is.infinite'. It turns out that the C functions 
>> 'do_isfinite' and 'do_isinfinite' in src/main/coerce.c are missing a 
>> call to 'DispatchOrEval' (see do_isnan). Added in the call fixed the 
>> problem. My functions no look like this:
>>
>> Form coerce.c:
>>
>> SEXP do_isfinite(SEXP call, SEXP op, SEXP args, SEXP rho)
>> {
>>    SEXP ans, x, names, dims;
>>    int i, n;
>>
>>    if (DispatchOrEval(call, op, "is.finite", args, rho, &ans, 1, 1))
>>        return(ans);
>>
>>    checkArity(op, args);
>>    ...
>>
>> SEXP do_isinfinite(SEXP call, SEXP op, SEXP args, SEXP rho)
>> {
>>    SEXP ans, x, names, dims;
>>    double xr, xi;
>>    int i, n;
>>
>>    if (DispatchOrEval(call, op, "is.infinite", args, rho, &ans, 1, 1))
>>        return(ans);
>>
>>    checkArity(op, args);
>>    ...
>
>


From roebuck at odin.mdacc.tmc.edu  Fri Jun 17 18:56:53 2005
From: roebuck at odin.mdacc.tmc.edu (Paul Roebuck)
Date: Fri, 17 Jun 2005 11:56:53 -0500 (CDT)
Subject: [Rd] R Include File Guards
In-Reply-To: <Pine.LNX.4.61.0506171120010.9328@gannet.stats>
References: <Pine.OSF.4.58.0505181524160.204610@odin.mdacc.tmc.edu><x2psvorz
	1q.fsf@turmalin.kubism.ku.dk>
	<Pine.OSF.4.58.0506151612190.332019@odin.mdacc.tmc.edu>
	<Pine.LNX.4.61.0506171120010.9328@gannet.stats>
Message-ID: <Pine.OSF.4.58.0506171050570.483016@odin.mdacc.tmc.edu>

On Fri, 17 Jun 2005, Prof Brian Ripley wrote:

> On Wed, 15 Jun 2005, Paul Roebuck wrote:
>
> > On Wed, 18 May 2005, Peter Dalgaard wrote:
> >
> >> Paul Roebuck <roebuck at odin.mdacc.tmc.edu> writes:
> >>
> >>> R 2.1.0/src/include from 2005/04/18 download
> >>>
> >>> Naming inconsistent for guards as well but that's pedantic.
> >>> Simple convention:
> >>>   file <foo.h>
> >>>     #ifndef R_FOO_H
> >>>   file <R_ext/bar.h>
> >>>     #ifndef R_EXT_BAR_H
> >>>
> >>> Missing guards:
> >>> <IOStuff.h>
> >>> <Internal.h>
> >>> <Parse.h>
> >>> <R_ext/GraphicsBase.h>
> >>> <R_ext/GraphicsDevice.h>
> >>> <R_ext/GraphicsEngine.h>
> >>> <R_ext/R-ftp-http.h>
> >>> <R_ext/libextern.h>
> >>>
> >>>
> >>> Illegal Guards (leading underscore):
> >>> <Rinternals.h>
> >>> <R_ext/Error.h>
> >>> <config.h.in>
> >>
> >> Thanks. The ones outside R_ext, except Rinternals.h, are not part of
> the
> >> API, so it is not a bug that there are no guards - could still be a
> >> good idea to have them of course. libextern.h explicitly says that you
> >> shouldn't disallow including it more than once. So the ones with real
> >> problems would be
> >>
> >> <R_ext/GraphicsBase.h>
> >> <R_ext/GraphicsDevice.h>
> >> <R_ext/GraphicsEngine.h>
> >> <R_ext/R-ftp-http.h>
> >>
> >> <Rinternals.h>
> >> <R_ext/Error.h>
> >>
> >> What's illegal about leading underscores, BTW?
> >>
> >
> > I downloaded the R-patched for 2005/06/14 and noticed that
> > the guards were never fixed. Should a bug report have been
> > opened instead of simply noting them here?
>
> What is the `bug' here which you suggest reporting?
>
> We have already established that leading underscores are NOT `illegal',
> just reserved and possibly ineffective according to the C99 standard
> (although we don't have any evidence of that being followed by an actual
> compiler). Given that the system includes on all three of my OSes use
> guards with leading underscores, they were VERY unlikely to be `illegal'
> as you stated.  (Looking in /usr/local/include shows that they are very
> widely used in other projects.)

Not sure when "we" established that. I was asked to provide
information about why it was illegal and I did so (per three OS
vendors) but nothing further was discussed. They are illegal exactly
because they are reserved for C compiler implementation vendors.
In essence, only implementation vendors are allowed to have header
files with leading underscores prepended to the guard names; thus
this is exactly the reason the system header files are done that way.
System headers use the leading underscore convention so the vendor is
free to add their own header files without causing problems for
existing user source. Here the situation is reversed as R has header
files that would cease to be included if a vendor added a header file
using the same guard.

As R Core is not a C compiler vendor, it is illegal usage.
Can one find other projects with include file guards with leading
underscores? Of course. Many people drive faster than the posted
speed limit - often without consequence.


<http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dndeepc/html/deep04202000.asp>
<http://www.cs.huji.ac.il/labs/parallel/Docs/C++/Guide/tic0056.html>
<http://www.belgeler.org/autobook/autobook-GNU-Autotools-in-Practice.html>


> Is there any known platform on which there is a consequential problem?
> If not (and we have no evidence), we do not play around with non-bugs in
> patch releases.

Fair enough.

> Some adjustments have been made in the development version of R.
> BTW: not all files in R_ext are part of the API: however
> GraphicsDevice.h and GraphicsEngine.h are and they are now
> compatible with C++ and have guards.

Thank you.



As an aside, has it ever been advanced that these files
not part of the API have a different naming scheme? Back
in the day, Motif had a convention where they appended
a capital P (for private, I assume) to the file's basename.

Public header:
	#include <foo.h>
Private to the implementation header:
	#include <fooP.h>

One could include the private heaers in code with the full
knowledge that the next release (of Motif) quite possibly
was going to break that code. :)

----------------------------------------------------------
SIGSIG -- signature too long (core dumped)


From btyner at stat.purdue.edu  Sat Jun 18 06:19:19 2005
From: btyner at stat.purdue.edu (btyner@stat.purdue.edu)
Date: Sat, 18 Jun 2005 06:19:19 +0200 (CEST)
Subject: [Rd] loess returns different standard errors for identical models
	(PR#7956)
Message-ID: <20050618041919.7F1CCA207@slim.kubism.ku.dk>

Full_Name: Benjamin Tyner
Version: 2.1.0, 4/18/2005
OS: i686-redhat-linux-gnu
Submission from: (NULL) (4.64.8.220)


# Just run my.test() below in a newly opened R session. Once too many models
have been fit (~20 on my system), the computed standard error jumps to a
different value. This is (superficially) due to a different residual sum of
squares, not a different one.delta. No other aspect of the fit is affected, just
the computed value of s (I've run extensive testing with all.equal() to make
sure). Issuing a garbage collection before doing a loess fit appears to "solve"
the problem, which makes me think this is not a problem in loessc.c or loessf.f.
My point is that a few loess fits in one session should not cause the estimated
standard error computation go awry with no warning.

y<-rnorm(50)
x<-seq(0,1,length=50)
my.test<-function(){
counter<-0
go<-0
new.s<-0
while(go<2){
counter<-counter+1
old.s<-new.s
fit<-loess(y~x,family="symmetric")
new.s<-fit$s
if(new.s!=old.s)go<-go+1
print(paste("s = ",fit$s))
}
print(paste("Fit number ",counter," is different!",sep=""))
}

# If there does turn out to be a way to fix this is loessc.c or loessf.f, I
would be happy to collaborate on that.


From mmdf+ at mlist-0.sp.cs.cmu.edu  Sat Jun 18 06:34:05 2005
From: mmdf+ at mlist-0.sp.cs.cmu.edu (Mail System mlist-0.sp.cs (MMDF))
Date: Sat, 18 Jun 2005 0:34:05 EDT
Subject: [Rd] Ambiguous address warning
Message-ID: <200506180434.j5I4YXeB016276@hypatia.math.ethz.ch>

Mail addressed to

	"john at cs.cmu.edu"

was ambiguous, but was delivered to

	John_G_Dorsey (john)

The name "john" also matched the following users

	Full name (login name)

	Andrew_John (aj14)
	Bonnie_John (bej)

To avoid this warning message in the future, address the mail as

	"John_G_Dorsey at cs.cmu.edu"


From p.dalgaard at biostat.ku.dk  Sat Jun 18 10:27:31 2005
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: 18 Jun 2005 10:27:31 +0200
Subject: [Rd] loess returns different standard errors for identical
	models (PR#7956)
In-Reply-To: <20050618041919.7F1CCA207@slim.kubism.ku.dk>
References: <20050618041919.7F1CCA207@slim.kubism.ku.dk>
Message-ID: <x2y898hxxo.fsf@turmalin.kubism.ku.dk>

btyner at stat.purdue.edu writes:

> Full_Name: Benjamin Tyner
> Version: 2.1.0, 4/18/2005
> OS: i686-redhat-linux-gnu
> Submission from: (NULL) (4.64.8.220)
> 
> 
> # Just run my.test() below in a newly opened R session. Once too many models
> have been fit (~20 on my system), the computed standard error jumps to a
> different value. This is (superficially) due to a different residual sum of
> squares, not a different one.delta. No other aspect of the fit is affected, just
> the computed value of s (I've run extensive testing with all.equal() to make
> sure). Issuing a garbage collection before doing a loess fit appears to "solve"
> the problem, which makes me think this is not a problem in loessc.c or loessf.f.
> My point is that a few loess fits in one session should not cause the estimated
> standard error computation go awry with no warning.

Right. Valgrind has this to say:

> my.test()
==22986== Use of uninitialised value of size 8
==22986==    at 0x1C97051B: lowesb_ (loessf.f:1542)
==22986==    by 0x1C95B399: loess_raw (loessc.c:98)
==22986==    by 0x809C9AE: do_dotCode (dotcode.c:1709)
==22986==    by 0x80B368F: Rf_eval (eval.c:405)
[1] "s =  0.857141235910414"
[1] "s =  0.857141235910414"

and that certainly fits the pattern.

Unfortunately this seems to be in the call to ehg31() in this passage

      end if
      setlf=(iv(27).ne.iv(25))
      call ehg131(xx,yy,ww,trl,diagl,iv(20),iv(29),iv(3),iv(2),iv(5),
     +     iv(17),iv(4),iv(6),iv(14),iv(19),wv(1),iv(iv(7)),iv(iv(8)),
     +     iv(iv(9)),iv(iv(10)),iv(iv(22)),iv(iv(27)),wv(iv(11)),
     +     iv(iv(23)),wv(iv(13)),wv(iv(12)),wv(iv(15)),wv(iv(16)),
     +     wv(iv(18)),ifloor(iv(3)*wv(2)),wv(3),wv(iv(26)),wv(iv(24)),
     +     wv(4),iv(30),iv(33),iv(32),iv(41),iv(iv(25)),wv(iv(34)),
     +     setlf)
      if(iv(14).lt.iv(6)+DBLE(iv(4))/2.D0)then
         call ehg183('k-d tree limited by memory; nvmax=',
     +        iv(14),1,1)

(line numbers in optimized code are somewhat unreliable), so there are
quite a few items to check. Dumping out the iv and wv arrays at that
point is probably a good start if you want to chip in with a bit
of debugging. Do yourself a favour and use set.seed() with a value
that gives you a minimal repeat count when you start R in a clean state.

-- 
   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
 (*) \(*) -- University of Copenhagen   Denmark          Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)                  FAX: (+45) 35327907


From ripley at stats.ox.ac.uk  Sat Jun 18 10:57:27 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Sat, 18 Jun 2005 09:57:27 +0100 (BST)
Subject: [Rd] loess returns different standard errors for identical
 models (PR#7956)
In-Reply-To: <x2y898hxxo.fsf@turmalin.kubism.ku.dk>
References: <20050618041919.7F1CCA207@slim.kubism.ku.dk>
	<x2y898hxxo.fsf@turmalin.kubism.ku.dk>
Message-ID: <Pine.LNX.4.61.0506180951360.3194@gannet.stats>

I've seen many similar things in a report from valgrind.  But they went 
away when compiled without optimization: it seems optimization often does 
a fetch one element off the end of an array when attempting to keep the 
pipelines full.

I'd start by re-running the valgrind tests without optimization.

On Sat, 18 Jun 2005, Peter Dalgaard wrote:

> btyner at stat.purdue.edu writes:
>
>> Full_Name: Benjamin Tyner
>> Version: 2.1.0, 4/18/2005
>> OS: i686-redhat-linux-gnu
>> Submission from: (NULL) (4.64.8.220)
>>
>>
>> # Just run my.test() below in a newly opened R session. Once too many models
>> have been fit (~20 on my system), the computed standard error jumps to a
>> different value. This is (superficially) due to a different residual sum of
>> squares, not a different one.delta. No other aspect of the fit is affected, just
>> the computed value of s (I've run extensive testing with all.equal() to make
>> sure). Issuing a garbage collection before doing a loess fit appears to "solve"
>> the problem, which makes me think this is not a problem in loessc.c or loessf.f.
>> My point is that a few loess fits in one session should not cause the estimated
>> standard error computation go awry with no warning.
>
> Right. Valgrind has this to say:
>
>> my.test()
> ==22986== Use of uninitialised value of size 8
> ==22986==    at 0x1C97051B: lowesb_ (loessf.f:1542)
> ==22986==    by 0x1C95B399: loess_raw (loessc.c:98)
> ==22986==    by 0x809C9AE: do_dotCode (dotcode.c:1709)
> ==22986==    by 0x80B368F: Rf_eval (eval.c:405)
> [1] "s =  0.857141235910414"
> [1] "s =  0.857141235910414"
>
> and that certainly fits the pattern.
>
> Unfortunately this seems to be in the call to ehg31() in this passage
>
>      end if
>      setlf=(iv(27).ne.iv(25))
>      call ehg131(xx,yy,ww,trl,diagl,iv(20),iv(29),iv(3),iv(2),iv(5),
>     +     iv(17),iv(4),iv(6),iv(14),iv(19),wv(1),iv(iv(7)),iv(iv(8)),
>     +     iv(iv(9)),iv(iv(10)),iv(iv(22)),iv(iv(27)),wv(iv(11)),
>     +     iv(iv(23)),wv(iv(13)),wv(iv(12)),wv(iv(15)),wv(iv(16)),
>     +     wv(iv(18)),ifloor(iv(3)*wv(2)),wv(3),wv(iv(26)),wv(iv(24)),
>     +     wv(4),iv(30),iv(33),iv(32),iv(41),iv(iv(25)),wv(iv(34)),
>     +     setlf)
>      if(iv(14).lt.iv(6)+DBLE(iv(4))/2.D0)then
>         call ehg183('k-d tree limited by memory; nvmax=',
>     +        iv(14),1,1)
>
> (line numbers in optimized code are somewhat unreliable), so there are
> quite a few items to check. Dumping out the iv and wv arrays at that
> point is probably a good start if you want to chip in with a bit
> of debugging. Do yourself a favour and use set.seed() with a value
> that gives you a minimal repeat count when you start R in a clean state.
>
> -- 
>   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
>  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
> (*) \(*) -- University of Copenhagen   Denmark          Ph: (+45) 35327918
> ~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)                  FAX: (+45) 35327907
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From p.dalgaard at biostat.ku.dk  Sat Jun 18 11:15:03 2005
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: 18 Jun 2005 11:15:03 +0200
Subject: [Rd] loess returns different standard errors for identical
	models (PR#7956)
In-Reply-To: <Pine.LNX.4.61.0506180951360.3194@gannet.stats>
References: <20050618041919.7F1CCA207@slim.kubism.ku.dk>
	<x2y898hxxo.fsf@turmalin.kubism.ku.dk>
	<Pine.LNX.4.61.0506180951360.3194@gannet.stats>
Message-ID: <x2u0jwhvqg.fsf@turmalin.kubism.ku.dk>

Prof Brian Ripley <ripley at stats.ox.ac.uk> writes:

> I've seen many similar things in a report from valgrind.  But they
> went away when compiled without optimization: it seems optimization
> often does a fetch one element off the end of an array when attempting
> to keep the pipelines full.
 
> I'd start by re-running the valgrind tests without optimization.

I was going to anyway, but the reported problem did carry all the
hallmarks of the use of a memory location with random content.


-- 
   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
 (*) \(*) -- University of Copenhagen   Denmark          Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)                  FAX: (+45) 35327907


From p.dalgaard at biostat.ku.dk  Sat Jun 18 12:34:19 2005
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: 18 Jun 2005 12:34:19 +0200
Subject: [Rd] loess returns different standard errors for identical
	models (PR#7956)
In-Reply-To: <x2u0jwhvqg.fsf@turmalin.kubism.ku.dk>
References: <20050618041919.7F1CCA207@slim.kubism.ku.dk>
	<x2y898hxxo.fsf@turmalin.kubism.ku.dk>
	<Pine.LNX.4.61.0506180951360.3194@gannet.stats>
	<x2u0jwhvqg.fsf@turmalin.kubism.ku.dk>
Message-ID: <x2ll58hs2c.fsf@turmalin.kubism.ku.dk>

Peter Dalgaard <p.dalgaard at biostat.ku.dk> writes:

> Prof Brian Ripley <ripley at stats.ox.ac.uk> writes:
> 
> > I've seen many similar things in a report from valgrind.  But they
> > went away when compiled without optimization: it seems optimization
> > often does a fetch one element off the end of an array when attempting
> > to keep the pipelines full.
>  
> > I'd start by re-running the valgrind tests without optimization.
> 
> I was going to anyway, but the reported problem did carry all the
> hallmarks of the use of a memory location with random content.

Still present with "-g" recompile, and a breakpoint in lowesb showed
that the last call had garbage in the "iv" array.

-- 
   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
 (*) \(*) -- University of Copenhagen   Denmark          Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)                  FAX: (+45) 35327907


From ligges at statistik.uni-dortmund.de  Sat Jun 18 15:16:35 2005
From: ligges at statistik.uni-dortmund.de (Uwe Ligges)
Date: Sat, 18 Jun 2005 15:16:35 +0200
Subject: [Rd] motivation for setRepositories and chooseCRANmirror
In-Reply-To: <42B1A144.9000708@vanderbilt.edu>
References: <42B1A144.9000708@vanderbilt.edu>
Message-ID: <42B41EB3.4080707@statistik.uni-dortmund.de>

Jeffrey Horner wrote:

> I have some questions and observations about these:
> 
> Will these replace manually setting options(CRAN), which doesn't work in 
> R-2.1.0?
> 
> In R-2.1.0, setRepositories() looks to see if options("repos") contains 
> a CRAN entry and will not override that CRAN entry even if the 
> $R_HOME/etc/repositories file (which setRepositories reads from) 
> contains a  CRAN entry.  Why is this? The user could easily set 
> options("repos") without the help of this function anyway? And 
> chooseCRANmirror() obviously sets the CRAN entry correctly.
> 
> I've checked the latest nightly tarball, R-devel_2005-06-15.tar.gz, and 
> this observations persists.
> 
> I also observe that the R-2.1.0 Rprofile in the base package sets 
> options(repos=c(CRAN="@CRAN@")), so it seems that the only way to set 
> the CRAN repository entry is either with chooseCRANmirror() or manually 
> setting options("repos") or options("CRAN"). If this was not the case, 
> then setRepositories() would choose the CRAN entry from 
> $R_HOME/etc/repositories.
> 
> In R-2.1.0 and in R-devel_2005-06-15.tar.gz, the R-admin manual suggests 
> that for packages to be downloaded and installed within R should set 
> options(CRAN = "http://cran.us.r-project.org/"). Will this be changed to 
> calling chooseCRANmirror()?
> 
>  From an administrator's point of view, I would like to have the CRAN 
> option set automatically on R startup for ALL users. That way I don't 
> have to set this option before calling update.packages().
> 
> 


Hence, I have in our department's R installation's 
.../R/etc/Rprofile.site file (which is intended for configurations that 
apply to all users):

options(repos = c(
           CRAN = "http://umfragen.sowi.uni-mainz.de/CRAN",
           CRANextra = "http://www.stats.ox.ac.uk/pub/RWin"))


Uwe Ligges


From p.dalgaard at biostat.ku.dk  Sun Jun 19 10:30:59 2005
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: 19 Jun 2005 10:30:59 +0200
Subject: [Rd] loess returns different standard errors for identical
	models (PR#7956)
In-Reply-To: <x2ll58hs2c.fsf@turmalin.kubism.ku.dk>
References: <20050618041919.7F1CCA207@slim.kubism.ku.dk>
	<x2y898hxxo.fsf@turmalin.kubism.ku.dk>
	<Pine.LNX.4.61.0506180951360.3194@gannet.stats>
	<x2u0jwhvqg.fsf@turmalin.kubism.ku.dk>
	<x2ll58hs2c.fsf@turmalin.kubism.ku.dk>
Message-ID: <x27jgqkat8.fsf@turmalin.kubism.ku.dk>

Peter Dalgaard <p.dalgaard at biostat.ku.dk> writes:

> Peter Dalgaard <p.dalgaard at biostat.ku.dk> writes:
> 
> > Prof Brian Ripley <ripley at stats.ox.ac.uk> writes:
> > 
> > > I've seen many similar things in a report from valgrind.  But they
> > > went away when compiled without optimization: it seems optimization
> > > often does a fetch one element off the end of an array when attempting
> > > to keep the pipelines full.
> >  
> > > I'd start by re-running the valgrind tests without optimization.
> > 
> > I was going to anyway, but the reported problem did carry all the
> > hallmarks of the use of a memory location with random content.
> 
> Still present with "-g" recompile, and a breakpoint in lowesb showed
> that the last call had garbage in the "iv" array.

The latter turned out to be a red herring. Apparently a gdb bug messed
up the "x/50d" command that I was using to inspect the array. The real
problem was in other arguments, namely "diagl" and "trl" which are
declared double precision, but passed "&zero" where "zero" is declared
to be of type "Sint".

Now, the 64000$ question is whether it is safe to try and fix it for
2.1.1... 

-- 
   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
 (*) \(*) -- University of Copenhagen   Denmark          Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)                  FAX: (+45) 35327907


From rlee at inverness.fpcc.net  Mon Jun 20 00:53:21 2005
From: rlee at inverness.fpcc.net (Lopaka Lee (Rob))
Date: Sun, 19 Jun 2005 16:53:21 -0600 (MDT)
Subject: [Rd] 1-based arrays and copying vectors
Message-ID: <32898.70.59.24.172.1119221601.squirrel@webmail.fpcc.net>

I'm interfacing to C code that uses 1-based indexing on arrays -- it
ignores the zeroth element.  Thus, input vectors from R must be moved up
one, and output arrays must be moved down one.

What is the best way to deal with this using R internal code?

My current approach is:

For an input R vector of length n, allocate a new vector(v) of length n+1
and copy input into v[1] to v[1+n].  Call with new vector.

For an output array(a) of length n, allocate a new vector of length n-1
and copy a[1] to a[n] into v[0] to v[n-1].

If this is the best approach, is there an idiom for copying vectors?

-Lopaka


From dmbates at gmail.com  Mon Jun 20 03:03:43 2005
From: dmbates at gmail.com (Douglas Bates)
Date: Sun, 19 Jun 2005 20:03:43 -0500
Subject: [Rd] 1-based arrays and copying vectors
In-Reply-To: <32898.70.59.24.172.1119221601.squirrel@webmail.fpcc.net>
References: <32898.70.59.24.172.1119221601.squirrel@webmail.fpcc.net>
Message-ID: <40e66e0b05061918035a3ace06@mail.gmail.com>

On 6/19/05, Rob Lopaka Lee <rlee at inverness.fpcc.net> wrote:
> I'm interfacing to C code that uses 1-based indexing on arrays -- it
> ignores the zeroth element.  Thus, input vectors from R must be moved up
> one, and output arrays must be moved down one.
> 
> What is the best way to deal with this using R internal code?

If the C code can be relied upon to ignore the zero'th element of the
array then write a wrapper that gets the array, say int v[], from R
and passes &v[-1] to your C code.  That has the effect of shifting all
the addresses back by one position.
 
> My current approach is:
> 
> For an input R vector of length n, allocate a new vector(v) of length n+1
> and copy input into v[1] to v[1+n].  Call with new vector.
> 
> For an output array(a) of length n, allocate a new vector of length n-1
> and copy a[1] to a[n] into v[0] to v[n-1].
> 
> If this is the best approach, is there an idiom for copying vectors?

In C you could use the memcpy function or the Memcpy macro defined in
<R_ext/RS.h>.


From ripley at stats.ox.ac.uk  Mon Jun 20 11:16:04 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Mon, 20 Jun 2005 10:16:04 +0100 (BST)
Subject: [Rd] Use of PACKAGE= argument in .C etc calls
Message-ID: <Pine.LNX.4.61.0506200957290.4443@gannet.stats>

As from R 2.0.0, R CMD check has not flagged .C etc calls without a 
PACKAGE argument in packages with a namespace.  Unfortunately that was 
based on too optimistic assumptions.

1) The mechanism to find the DLL from the namespace only works if the DLL 
is declared via a useDynLib declaration in NAMESPACE (and only if there is 
one such declaration).  This is checked in R-devel.

2) In 2.1.1, the mechanism only finds the DLL correctly for functions 
defined at the top level in a namespace, and not for example for functions 
defined inside functions or as S4 methods.  There is an enhanced 
mechanism in R-devel.

3) Prior to 2.1.1, a bug meant that the mechanism often found the 
incorrect namespace, and there was not mechanism at all prior to 2.0.0 (I 
believe).

For compatibility with 2.1.x and earlier a PACKAGE= argument is needed in 
many more calls than are flagged by R-devel's 'check'.  To check this, 
use

> library(tools)
> checkFF("my_package", verbose=TRUE)

for example:

> checkFF("mgcv", verbose=TRUE)
.C("construct_cr", ...): OK
.C("predict_tprs", ...): OK
.C("MinimumSeparation", ...): OK
.C("update_beta", ...): MISSING but in a function in a namespace
.C("update_beta", ...): MISSING but in a function in a namespace
.C("magic", ...): OK
.C("mgcv", ...): OK
.C("RMonoCon", ...): OK
.C("RPCLS", ...): OK
.C("construct_cr", ...): OK
.C("construct_tprs", ...): OK
.C("RuniqueCombs", ...): OK

where the qualified MISSING reports need attention.

Botton line: always use a PACKAGE= argument unless you are only intending 
your package to be used with (pre-)2.2.0 or later.

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From hb at maths.lth.se  Mon Jun 20 12:18:22 2005
From: hb at maths.lth.se (Henrik Bengtsson)
Date: Mon, 20 Jun 2005 12:18:22 +0200
Subject: [Rd] capabilities() and non-catchable messages
Message-ID: <42B697EE.7040004@maths.lth.se>

Just for the record (not a request for fix) and an ad hoc workaround if 
anyone needs it:

REASON:
Running an R script as a plugin on a remote Suse Linux 8.2 with R v2.1.0 
(2005-04-18), I have noticed that capabilities() generates (to standard 
error)

   Xlib: connection to "base:0.0" refused by server
   Xlib: Client is not authorized to connect to Server

which cannot be caught by tryCatch();

   tryCatch({
     print(capabilities());
   }, condition=function(c) {
     cat("Condition caught:\n");
     str(c);
   })

because it is not a 'condition' (error or warning).

CONTEXT:
Since source() calls capabilities("iconv") this messages always show up. 
My R plugin loads custom code using source() and since the standard 
error from the plugin is checked for messages, the host system 
interprets this as if something problematic has occured.

WORKAROUND:
The workaround that I use now is to redefine capabilities() temporarily 
(since I do not need "iconv" support):

  orgCapabilities <- base::capabilities;
  basePos <- which(search() == "package:base"));
  assign("capabilities", function(...) FALSE, pos=basePos);

  source(<my file>)

  basePos <- which(search() == "package:base"));
  assign("capabilities", orgCapabilities, pos=basePos);
  rm(orgCapabilities)

Cheers

Henrik


From rpeng at jhsph.edu  Mon Jun 20 14:10:00 2005
From: rpeng at jhsph.edu (Roger D. Peng)
Date: Mon, 20 Jun 2005 08:10:00 -0400
Subject: [Rd] capabilities() and non-catchable messages
In-Reply-To: <42B697EE.7040004@maths.lth.se>
References: <42B697EE.7040004@maths.lth.se>
Message-ID: <42B6B217.9020403@jhsph.edu>

Would using 'capture.output()' work for you in this case?

-roger

Henrik Bengtsson wrote:
> Just for the record (not a request for fix) and an ad hoc workaround if 
> anyone needs it:
> 
> REASON:
> Running an R script as a plugin on a remote Suse Linux 8.2 with R v2.1.0 
> (2005-04-18), I have noticed that capabilities() generates (to standard 
> error)
> 
>    Xlib: connection to "base:0.0" refused by server
>    Xlib: Client is not authorized to connect to Server
> 
> which cannot be caught by tryCatch();
> 
>    tryCatch({
>      print(capabilities());
>    }, condition=function(c) {
>      cat("Condition caught:\n");
>      str(c);
>    })
> 
> because it is not a 'condition' (error or warning).
> 
> CONTEXT:
> Since source() calls capabilities("iconv") this messages always show up. 
> My R plugin loads custom code using source() and since the standard 
> error from the plugin is checked for messages, the host system 
> interprets this as if something problematic has occured.
> 
> WORKAROUND:
> The workaround that I use now is to redefine capabilities() temporarily 
> (since I do not need "iconv" support):
> 
>   orgCapabilities <- base::capabilities;
>   basePos <- which(search() == "package:base"));
>   assign("capabilities", function(...) FALSE, pos=basePos);
> 
>   source(<my file>)
> 
>   basePos <- which(search() == "package:base"));
>   assign("capabilities", orgCapabilities, pos=basePos);
>   rm(orgCapabilities)
> 
> Cheers
> 
> Henrik
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From hb at maths.lth.se  Mon Jun 20 17:09:37 2005
From: hb at maths.lth.se (Henrik Bengtsson)
Date: Mon, 20 Jun 2005 17:09:37 +0200
Subject: [Rd] capabilities() and non-catchable messages
In-Reply-To: <42B6B217.9020403@jhsph.edu>
References: <42B697EE.7040004@maths.lth.se> <42B6B217.9020403@jhsph.edu>
Message-ID: <42B6DC31.1040909@maths.lth.se>

No; I've tried/do that too.

/Henrik

Roger D. Peng wrote:
> Would using 'capture.output()' work for you in this case?
> 
> -roger
> 
> Henrik Bengtsson wrote:
> 
>>Just for the record (not a request for fix) and an ad hoc workaround if 
>>anyone needs it:
>>
>>REASON:
>>Running an R script as a plugin on a remote Suse Linux 8.2 with R v2.1.0 
>>(2005-04-18), I have noticed that capabilities() generates (to standard 
>>error)
>>
>>   Xlib: connection to "base:0.0" refused by server
>>   Xlib: Client is not authorized to connect to Server
>>
>>which cannot be caught by tryCatch();
>>
>>   tryCatch({
>>     print(capabilities());
>>   }, condition=function(c) {
>>     cat("Condition caught:\n");
>>     str(c);
>>   })
>>
>>because it is not a 'condition' (error or warning).
>>
>>CONTEXT:
>>Since source() calls capabilities("iconv") this messages always show up. 
>>My R plugin loads custom code using source() and since the standard 
>>error from the plugin is checked for messages, the host system 
>>interprets this as if something problematic has occured.
>>
>>WORKAROUND:
>>The workaround that I use now is to redefine capabilities() temporarily 
>>(since I do not need "iconv" support):
>>
>>  orgCapabilities <- base::capabilities;
>>  basePos <- which(search() == "package:base"));
>>  assign("capabilities", function(...) FALSE, pos=basePos);
>>
>>  source(<my file>)
>>
>>  basePos <- which(search() == "package:base"));
>>  assign("capabilities", orgCapabilities, pos=basePos);
>>  rm(orgCapabilities)
>>
>>Cheers
>>
>>Henrik
>>
>>______________________________________________
>>R-devel at r-project.org mailing list
>>https://stat.ethz.ch/mailman/listinfo/r-devel
>>
> 
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
>


From p.murrell at auckland.ac.nz  Tue Jun 21 05:18:34 2005
From: p.murrell at auckland.ac.nz (Paul Murrell)
Date: Tue, 21 Jun 2005 15:18:34 +1200
Subject: [Rd] Revised scatter.smooth using xy.coords
References: <14309.170.54.59.167.1115053647.squirrel@170.54.59.167>
Message-ID: <42B7870A.8050206@stat.auckland.ac.nz>

Hi

Thanks for these suggestions Kevin.

These are now in the development version of R.

Paul


kwright at eskimo.com wrote:
> This started when I discovered that scatter.smooth (R 2.1.0) has an
> undocumented ability to use a formula as the first argument.  Then I
> discovered the xy.coords function, which seems like a natural fit and a
> way to unify scatter.smooth with other plotting functions, so I offer here
> a revised version of scatter.smooth that uses the xy.coords function.
> 
> 
> scatter.smooth <- function (x, y=NULL, span = 2/3, degree = 1,
>                             family = c("symmetric", "gaussian"),
>                             xlab = NULL,
>                             ylab = NULL,
>                             ylim = range(y, prediction$y, na.rm = TRUE),
>                             evaluation = 50, ...) {
>   xlabel <- if (!missing(x))
>     deparse(substitute(x))
>   ylabel <- if (!missing(y))
>     deparse(substitute(y))
>   xy <- xy.coords(x, y, xlabel, ylabel)
> 
>   x <- xy$x
>   y <- xy$y
>   xlab <- if(is.null(xlab)) xy$xlab
>   else xlab
>   ylab <- if(is.null(ylab)) xy$ylab
>   else ylab
> 
>   #  if (inherits(x, "formula")) {
>   #    if (length(x) < 3)
>   #      stop("need response in formula")
>   #    thiscall <- match.call()
>   #    thiscall$x <- x[[3]]
>   #    thiscall$y <- x[[2]]
>   #    return(invisible(eval(thiscall, sys.parent())))
>   #  }
>   prediction <- loess.smooth(x, y, span, degree, family, evaluation)
>   plot(x, y, ylim = ylim, xlab = xlab, ylab = ylab, ...)
>   lines(prediction)
>   invisible()
> }
> 
> 1. I commented out some existing code and my revisions appear before the
> commented block.
> 
> 2. The argument list has changed slightly.  The original arguments were:
> y
> xlab=deparse(substitute(x))
> ylab=deparse(substitute(y))
> 
> 3.  With the suggested change, the following examples now work as one
> would expect
> 
> attach(cars)
> scatter.smooth(speed,dist,main="dist,speed")
> scatter.smooth(speed,dist,main="dist,speed",xlab="",ylab="")
> scatter.smooth(cars,main="cars")
> scatter.smooth(cars,main="cars",xlab="Speed",ylab="Distance")
> scatter.smooth(dist~speed,main="dist~speed")
> scatter.smooth(dist~speed,main="dist~speed",xlab="")
> scatter.smooth(dist~speed,main="dist~speed",ylab="")
> 
> 4. If this revision is accepted, the help page for scatter.smooth should
> probably be updated, perhaps using the same definition of the x,y
> arguments in the plot.default help page.
> 
> Best,
> 
> Kevin Wright
> 
> ______________________________________________
> R-devel at stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


-- 
Dr Paul Murrell
Department of Statistics
The University of Auckland
Private Bag 92019
Auckland
New Zealand
64 9 3737599 x85392
paul at stat.auckland.ac.nz
http://www.stat.auckland.ac.nz/~paul/


From ripley at stats.ox.ac.uk  Tue Jun 21 13:55:23 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue, 21 Jun 2005 12:55:23 +0100 (BST)
Subject: [Rd] capabilities() and non-catchable messages
In-Reply-To: <42B697EE.7040004@maths.lth.se>
References: <42B697EE.7040004@maths.lth.se>
Message-ID: <Pine.LNX.4.61.0506211242080.7675@gannet.stats>

Do you have DISPLAY set pointing to an X11 server you do not have 
access to?  It seems so.  The solution is to set your X11 settings 
properly.

This is coming from Xlib (XOpenDisplay, I believe) and so is not an R 
error or warning, and is not output on an R connection but on a  C file.

On Mon, 20 Jun 2005, Henrik Bengtsson wrote:

> Just for the record (not a request for fix) and an ad hoc workaround if
> anyone needs it:
>
> REASON:
> Running an R script as a plugin on a remote Suse Linux 8.2 with R v2.1.0
> (2005-04-18), I have noticed that capabilities() generates (to standard
> error)
>
>   Xlib: connection to "base:0.0" refused by server
>   Xlib: Client is not authorized to connect to Server
>
> which cannot be caught by tryCatch();
>
>   tryCatch({
>     print(capabilities());
>   }, condition=function(c) {
>     cat("Condition caught:\n");
>     str(c);
>   })
>
> because it is not a 'condition' (error or warning).
>
> CONTEXT:
> Since source() calls capabilities("iconv") this messages always show up.
> My R plugin loads custom code using source() and since the standard
> error from the plugin is checked for messages, the host system
> interprets this as if something problematic has occured.
>
> WORKAROUND:
> The workaround that I use now is to redefine capabilities() temporarily
> (since I do not need "iconv" support):
>
>  orgCapabilities <- base::capabilities;
>  basePos <- which(search() == "package:base"));
>  assign("capabilities", function(...) FALSE, pos=basePos);
>
>  source(<my file>)
>
>  basePos <- which(search() == "package:base"));
>  assign("capabilities", orgCapabilities, pos=basePos);
>  rm(orgCapabilities)
>
> Cheers
>
> Henrik
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From ben.bob at gmail.com  Tue Jun 21 18:24:21 2005
From: ben.bob at gmail.com (Bo Peng)
Date: Tue, 21 Jun 2005 11:24:21 -0500
Subject: [Rd] efficiency of sample() with prob.
Message-ID: <6ea7b543050621092420dcc268@mail.gmail.com>

Dear list,

A while ago, Vadim asked opinions on improving efficiency of sample()
with prob, e.g. sample with replacement with weight.  (
https://stat.ethz.ch/pipermail/r-devel/2004-September/030844.html ) He
did not post what he ended up with this problem though.

I am having exactly the same problem. I need to sample  with
replacement from a population of size 10 million with fitness values
for each individual. sample() is too slow for this purpose.

I implement a bisection search algorithm. It is about 30% faster than
the linear search one but still not good enough to me. (I can post the
function if needed). Does anybody have some good ideas? The only other
idea I have is using a faster (but worse) random number generator just
for this application.

Thanks.
Bo


From maechler at stat.math.ethz.ch  Tue Jun 21 18:54:13 2005
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Tue, 21 Jun 2005 18:54:13 +0200
Subject: [Rd] Open device -> glibc 2.3.4 bug for Redhat Enterprise 4?
Message-ID: <17080.17973.699405.241927@stat.math.ethz.ch>

We have been using Redhat Enterprise 4, on some of our Linux
clients for a while,
and Christoph has just found that opening an R device for a file
without write permission gives a bad glibc error and subsequent
seg.fault:

> postscript("/blabla.ps")
*** glibc detected *** double free or corruption (!prev): 0x0000000001505f10 ***

or

> xfig("/blabla.fig")
*** glibc detected *** double free or corruption (!prev): 0x0000000001505f10 ***

and similar for pdf();
does not happen for jpeg() {which runs via x11},
nor e.g. for 

> sink("/bla.txt")

-------

Happens both on 32-bit (Pentium) and 64-bit (AMD Athlon)
machines with the following libc :

32-bit:
  -rwxr-xr-x  1 root root 1451681 May 13 00:17 /lib/tls/libc-2.3.4.so*
64-bit:
  -rwxr-xr-x  1 root root 1490956 May 12 23:26 /lib64/tls/libc-2.3.4.so*

-------

Can anyone reproduce this problem?

Regards,
Martin


From tlumley at u.washington.edu  Tue Jun 21 18:59:31 2005
From: tlumley at u.washington.edu (Thomas Lumley)
Date: Tue, 21 Jun 2005 09:59:31 -0700 (PDT)
Subject: [Rd] Open device -> glibc 2.3.4 bug for Redhat Enterprise 4?
In-Reply-To: <17080.17973.699405.241927@stat.math.ethz.ch>
References: <17080.17973.699405.241927@stat.math.ethz.ch>
Message-ID: <Pine.A41.4.61b.0506210958400.18370@homer04.u.washington.edu>


This was supposed to be fixed in 2.1.1 -- which version are you using?

 	-thomas

On Tue, 21 Jun 2005, Martin Maechler wrote:

> We have been using Redhat Enterprise 4, on some of our Linux
> clients for a while,
> and Christoph has just found that opening an R device for a file
> without write permission gives a bad glibc error and subsequent
> seg.fault:
>
>> postscript("/blabla.ps")
> *** glibc detected *** double free or corruption (!prev): 0x0000000001505f10 ***
>
> or
>
>> xfig("/blabla.fig")
> *** glibc detected *** double free or corruption (!prev): 0x0000000001505f10 ***
>
> and similar for pdf();
> does not happen for jpeg() {which runs via x11},
> nor e.g. for
>
>> sink("/bla.txt")
>
> -------
>
> Happens both on 32-bit (Pentium) and 64-bit (AMD Athlon)
> machines with the following libc :
>
> 32-bit:
>  -rwxr-xr-x  1 root root 1451681 May 13 00:17 /lib/tls/libc-2.3.4.so*
> 64-bit:
>  -rwxr-xr-x  1 root root 1490956 May 12 23:26 /lib64/tls/libc-2.3.4.so*
>
> -------
>
> Can anyone reproduce this problem?
>
> Regards,
> Martin
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From maechler at stat.math.ethz.ch  Tue Jun 21 19:11:02 2005
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Tue, 21 Jun 2005 19:11:02 +0200
Subject: [Rd] Open device -> glibc 2.3.4 bug for Redhat Enterprise 4?
In-Reply-To: <Pine.A41.4.61b.0506210958400.18370@homer04.u.washington.edu>
References: <17080.17973.699405.241927@stat.math.ethz.ch>
	<Pine.A41.4.61b.0506210958400.18370@homer04.u.washington.edu>
Message-ID: <17080.18982.124530.333233@stat.math.ethz.ch>

>>>>> "TL" == Thomas Lumley <tlumley at u.washington.edu>
>>>>>     on Tue, 21 Jun 2005 09:59:31 -0700 (PDT) writes:

    TL> This was supposed to be fixed in 2.1.1 -- which version are you using?

2.1.1 -- and 2.1.0 and 2.0.0 all showed the problem.

But thanks, Thomas, looking in "NEWS" of R-devel showed that
there was a fix for this in R-devel only --- too bad it didn't
make it for R 2.1.1.

And yes, the seg.fault doesn't happen in my version of R-devel.

Further note that only the very recent libc produces the
segfault for us.  Earlier versions, including the libc-2.3.2
used in our Debian sid (on AMD Opteron), do give the correct
error message instead of the seg.fault.


    TL> On Tue, 21 Jun 2005, Martin Maechler wrote:

    >> We have been using Redhat Enterprise 4, on some of our Linux
    >> clients for a while,
    >> and Christoph has just found that opening an R device for a file
    >> without write permission gives a bad glibc error and subsequent
    >> seg.fault:
    >> 
    >>> postscript("/blabla.ps")
    >> *** glibc detected *** double free or corruption (!prev): 0x0000000001505f10 ***
    >> 
    >> or
    >> 
    >>> xfig("/blabla.fig")
    >> *** glibc detected *** double free or corruption (!prev): 0x0000000001505f10 ***
    >> 
    >> and similar for pdf();
    >> does not happen for jpeg() {which runs via x11},
    >> nor e.g. for
    >> 
    >>> sink("/bla.txt")
    >> 
    >> -------
    >> 
    >> Happens both on 32-bit (Pentium) and 64-bit (AMD Athlon)
    >> machines with the following libc :
    >> 
    >> 32-bit:
    >> -rwxr-xr-x  1 root root 1451681 May 13 00:17 /lib/tls/libc-2.3.4.so*
    >> 64-bit:
    >> -rwxr-xr-x  1 root root 1490956 May 12 23:26 /lib64/tls/libc-2.3.4.so*
    >> 
    >> -------
    >> 
    >> Can anyone reproduce this problem?
    >> 
    >> Regards,
    >> Martin
    >> 
    >> ______________________________________________
    >> R-devel at r-project.org mailing list
    >> https://stat.ethz.ch/mailman/listinfo/r-devel
    >> 

    TL> ______________________________________________
    TL> R-devel at r-project.org mailing list
    TL> https://stat.ethz.ch/mailman/listinfo/r-devel


From henric.nilsson at statisticon.se  Tue Jun 21 19:13:22 2005
From: henric.nilsson at statisticon.se (henric.nilsson@statisticon.se)
Date: Tue, 21 Jun 2005 19:13:22 +0200 (CEST)
Subject: [Rd] weighted.residuals for glm objects (PR#7961)
Message-ID: <20050621171322.6145AF90D@slim.kubism.ku.dk>

Full_Name: Henric Nilsson
Version: 2.2.0 (2005-06-20 r34776)
OS: Windows 2000
Submission from: (NULL) (213.115.23.26)


The help page for `weighted.residuals' states that the function can be used with
both `lm' and `glm' objects. However, it's unclear what's meant by the following
passage

"Weighted residuals are the usual residuals Ri, multiplied by wi^0.5, where wi
are the weights as specified in lm's call."

when it comes to a GLM. What's "...usual residuals..." in this context?

After reading the code it's clear that the function multiplies the deviance
residuals by wi^0.5, but this doesn't seem sensible for a GLM. Consider e.g.

> set.seed(1)
> x <- runif(10)
> y <- x + rnorm(10)
> w <- 0:9
> weighted.residuals(lm(y ~ x, weights = w))
         2          3          4          5          6          7          8 
 0.3845201  1.0361636  1.2689516 -0.9817686  3.7205310  1.3823979 -1.5458433 
         9         10 
-6.2029822  2.6149474 
> weighted.residuals(glm(y ~ x, weights = w))
          2           3           4           5           6           7 
  0.3845201   1.4653567   2.1978886  -1.9635372   8.3193602   3.3861695 
          8           9          10 
 -4.0899170 -17.5446831   7.8448423 

I suggest that the code for `weighted.residuals' is changed to

weighted.residuals <- function (obj, drop0 = TRUE) 
{
    w <- weights(obj)
    r <- residuals(obj, type = "deviance")
    if (is.null(w)) 
        r
    else if (drop0) 
        r[w != 0]
    else r
}

which seems to do the "right thing" for both `lm' and `glm' objects.


From tlumley at u.washington.edu  Tue Jun 21 19:17:34 2005
From: tlumley at u.washington.edu (Thomas Lumley)
Date: Tue, 21 Jun 2005 10:17:34 -0700 (PDT)
Subject: [Rd] Open device -> glibc 2.3.4 bug for Redhat Enterprise 4?
In-Reply-To: <17080.18982.124530.333233@stat.math.ethz.ch>
References: <17080.17973.699405.241927@stat.math.ethz.ch>
	<Pine.A41.4.61b.0506210958400.18370@homer04.u.washington.edu>
	<17080.18982.124530.333233@stat.math.ethz.ch>
Message-ID: <Pine.A41.4.61b.0506211014200.18370@homer04.u.washington.edu>

On Tue, 21 Jun 2005, Martin Maechler wrote:

>>>>>> "TL" == Thomas Lumley <tlumley at u.washington.edu>
>>>>>>     on Tue, 21 Jun 2005 09:59:31 -0700 (PDT) writes:
>
>    TL> This was supposed to be fixed in 2.1.1 -- which version are you using?
>
> 2.1.1 -- and 2.1.0 and 2.0.0 all showed the problem.
>
> But thanks, Thomas, looking in "NEWS" of R-devel showed that
> there was a fix for this in R-devel only --- too bad it didn't
> make it for R 2.1.1.
>

It's a double free(), so it produces undefined behaviour and anything can 
happen.  On the Mac (where it was first reported), "anything" was a 
warning message from malloc, and on many systems "anything" is nothing.

I thought I had added it to R-patched as well, but obviously not.

 	-thomas


From vograno at evafunds.com  Tue Jun 21 19:53:22 2005
From: vograno at evafunds.com (Vadim Ogranovich)
Date: Tue, 21 Jun 2005 10:53:22 -0700
Subject: [Rd] efficiency of sample() with prob.
Message-ID: <C698D707214E6F4AB39AB7096C3DE5A5AB5031@phost015.EVAFUNDS.intermedia.net>

In his "Introduction to Probability Models" Sheldon Ross describes (sec
11.4.1, 8th edition) the alias method for such weighted sampling.
It is based on some decomposition of the original distribution (the
weights) into a mixture of two-point distributions. I don't know the
run-time complexity of the decomposition step. But once the
decomposition is found the complexity of generating a sample is linear
in the size of the sample.

I haven't coded this because I had found an easier way to deal with the
original problem I had at that time.

HTH,
Vadim

> -----Original Message-----
> From: r-devel-bounces at r-project.org 
> [mailto:r-devel-bounces at r-project.org] On Behalf Of Bo Peng
> Sent: Tuesday, June 21, 2005 9:24 AM
> To: r-devel at r-project.org
> Subject: [Rd] efficiency of sample() with prob.
> 
> Dear list,
> 
> A while ago, Vadim asked opinions on improving efficiency of 
> sample() with prob, e.g. sample with replacement with weight. 
>  ( 
> https://stat.ethz.ch/pipermail/r-devel/2004-September/030844.h
tml ) He did not post what he ended up with this problem though.
> 
> I am having exactly the same problem. I need to sample  with 
> replacement from a population of size 10 million with fitness 
> values for each individual. sample() is too slow for this purpose.
> 
> I implement a bisection search algorithm. It is about 30% 
> faster than the linear search one but still not good enough 
> to me. (I can post the function if needed). Does anybody have 
> some good ideas? The only other idea I have is using a faster 
> (but worse) random number generator just for this application.
> 
> Thanks.
> Bo
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From wwl107 at psu.edu  Wed Jun 22 04:46:49 2005
From: wwl107 at psu.edu (wwl107@psu.edu)
Date: Wed, 22 Jun 2005 04:46:49 +0200 (CEST)
Subject: [Rd] Trouble with ifelse and if statement (PR#7962)
Message-ID: <20050622024649.D4BEEA22C@slim.kubism.ku.dk>

Full_Name: Woolton Lee
Version: 2.1
OS: windows
Submission from: (NULL) (128.118.224.46)


I did the following ('g' and 'h' are both numeric vectors)
> i <- abs(g-h)
creating a vector 'i' with values,
> i
 [1] 0.08 0.00 0.33 0.00 0.00 0.00 0.00 0.33 0.00 0.00 0.08 0.08 0.20 0.00 0.13

Now, I want to create a new vector =1 whenever 'i' = 0.33 and =0 otherwise.  I
use the 'ifelse' function to do this but when I do, I find
> ifelse(i==0.33,1,0)
 [1] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0

even though the third and eighth elements of 'i' clearly equal 0.33.  Unless I
have missed something, 'ifelse' should return a vector that looks like,
[1] 0 0 1 0 0 0 0 1 0 0 0 0 0 0 0

When I try 0.13 I get a correct result
> ifelse(i==0.13,1,0)
 [1] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1

but when I try 0.08 or 0.2 I find a similar problem,
> ifelse(i==0.08,1,0)
 [1] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
> ifelse(i==0.20,1,0)
 [1] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
> ifelse(i==0.2,1,0)
 [1] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0

Can you explain what is happening?  Why is R incorretly returning a vector that
does not reflect the values in 'i'?  Is this due to a malfunction in R or have I
missed something?

Thank you for your help.

Woolton


From fianait at bigdug.com  Wed Jun 22 05:01:39 2005
From: fianait at bigdug.com (fianait@bigdug.com)
Date: Wed, 22 Jun 2005 05:01:39 +0200 (CEST)
Subject: [Rd] Data you can use student (PR#7963)
Message-ID: <20050622030139.DA9EBA22C@slim.kubism.ku.dk>

Our Missions : to be the sincere internet merchant on repliica goods who is
dedicated on our top-tier product quality, error-free logistics accuracy and
hassle-free after-sale customer service, with the knowledge and skills of
being a manufacturer since 2002. 

http://xyie.timedividendwind.com/re/

Addidas, Bally, Bvlgari, Burberry, Cartier, Chanel, Christian Dior,
Dunhill, Dupont, Escada, Fendi, Ferragamo, Gucci, Hermes, IWC, Jacob & Co.,
Louis Vuitton, Mont Blanc, Movado, Nike, Omega, Oris, Prada, Puma, Rado,
Roger Dubuis, Rolex, Sector, Tag Heuer, TechnoMarine, Tiffany, Timberland,
Tudor




There's a song playing in every heart beating

flopenlog  fbscanf  fbendac sz01 dtstrm  etacidem
Glitter on the front porchGlitter on the hallway


From ggrothendieck at gmail.com  Wed Jun 22 05:21:25 2005
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Tue, 21 Jun 2005 23:21:25 -0400
Subject: [Rd] Trouble with ifelse and if statement (PR#7962)
In-Reply-To: <20050622024649.D4BEEA22C@slim.kubism.ku.dk>
References: <20050622024649.D4BEEA22C@slim.kubism.ku.dk>
Message-ID: <971536df050621202119353873@mail.gmail.com>

On 6/21/05, wwl107 at psu.edu <wwl107 at psu.edu> wrote:
> Full_Name: Woolton Lee
> Version: 2.1
> OS: windows
> Submission from: (NULL) (128.118.224.46)
> 
> 
> I did the following ('g' and 'h' are both numeric vectors)
> > i <- abs(g-h)
> creating a vector 'i' with values,
> > i
>  [1] 0.08 0.00 0.33 0.00 0.00 0.00 0.00 0.33 0.00 0.00 0.08 0.08 0.20 0.00 0.13
> 
> Now, I want to create a new vector =1 whenever 'i' = 0.33 and =0 otherwise.  I
> use the 'ifelse' function to do this but when I do, I find
> > ifelse(i==0.33,1,0)
>  [1] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
> 
> even though the third and eighth elements of 'i' clearly equal 0.33.  Unless I
> have missed something, 'ifelse' should return a vector that looks like,
> [1] 0 0 1 0 0 0 0 1 0 0 0 0 0 0 0
> 
> When I try 0.13 I get a correct result
> > ifelse(i==0.13,1,0)
>  [1] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1
> 
> but when I try 0.08 or 0.2 I find a similar problem,
> > ifelse(i==0.08,1,0)
>  [1] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
> > ifelse(i==0.20,1,0)
>  [1] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
> > ifelse(i==0.2,1,0)
>  [1] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
> 
> Can you explain what is happening?  Why is R incorretly returning a vector that
> does not reflect the values in 'i'?  Is this due to a malfunction in R or have I
> missed something?

This is 7.31 of the R FAQ:

http://cran.r-project.org/doc/FAQ/R-FAQ.html#Why-doesn_0027t-R-think-these-numbers-are-equal_003f


From MSchwartz at mn.rr.com  Wed Jun 22 05:33:18 2005
From: MSchwartz at mn.rr.com (MSchwartz@mn.rr.com)
Date: Wed, 22 Jun 2005 05:33:18 +0200 (CEST)
Subject: [Rd] Trouble with ifelse and if statement (PR#7962)
Message-ID: <20050622033318.29D25A22C@slim.kubism.ku.dk>

On Wed, 2005-06-22 at 04:46 +0200, wwl107 at psu.edu wrote:
> Full_Name: Woolton Lee
> Version: 2.1
> OS: windows
> Submission from: (NULL) (128.118.224.46)
> 
> 
> I did the following ('g' and 'h' are both numeric vectors)
> > i <- abs(g-h)
> creating a vector 'i' with values,
> > i
>  [1] 0.08 0.00 0.33 0.00 0.00 0.00 0.00 0.33 0.00 0.00 0.08 0.08 0.20 0.00 0.13
> 
> Now, I want to create a new vector =1 whenever 'i' = 0.33 and =0 otherwise.  I
> use the 'ifelse' function to do this but when I do, I find
> > ifelse(i==0.33,1,0)
>  [1] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
> 
> even though the third and eighth elements of 'i' clearly equal 0.33.  Unless I
> have missed something, 'ifelse' should return a vector that looks like,
> [1] 0 0 1 0 0 0 0 1 0 0 0 0 0 0 0
> 
> When I try 0.13 I get a correct result
> > ifelse(i==0.13,1,0)
>  [1] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1
> 
> but when I try 0.08 or 0.2 I find a similar problem,
> > ifelse(i==0.08,1,0)
>  [1] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
> > ifelse(i==0.20,1,0)
>  [1] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
> > ifelse(i==0.2,1,0)
>  [1] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
> 
> Can you explain what is happening?  Why is R incorretly returning a vector that
> does not reflect the values in 'i'?  Is this due to a malfunction in R or have I
> missed something?
> 
> Thank you for your help.
> 
> Woolton

This is not a bug and yes you have missed something.

Read R FAQ 7.31 Why doesn't R think these numbers are equal?

More information is also available here:

http://grouper.ieee.org/groups/754/


One possible solution:

> i
 [1] 0.08 0.00 0.33 0.00 0.00 0.00 0.00 0.33 0.00 0.00 0.08 0.08 0.20
[14] 0.00 0.13

> ifelse(sapply(i, function(x) all.equal(x, 0.33)) == "TRUE", 1, 0)
 [1] 0 0 1 0 0 0 0 1 0 0 0 0 0 0 0

> ifelse(sapply(i, function(x) all.equal(x, 0.08)) == "TRUE", 1, 0)
 [1] 1 0 0 0 0 0 0 0 0 0 1 1 0 0 0

> ifelse(sapply(i, function(x) all.equal(x, 0.2)) == "TRUE", 1, 0)
 [1] 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0


Marc Schwartz


From maechler at stat.math.ethz.ch  Wed Jun 22 10:06:34 2005
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Wed, 22 Jun 2005 10:06:34 +0200
Subject: [Rd] Trouble with ifelse and if statement (PR#7962)
In-Reply-To: <20050622033318.29D25A22C@slim.kubism.ku.dk>
References: <20050622033318.29D25A22C@slim.kubism.ku.dk>
Message-ID: <17081.7178.640030.851104@stat.math.ethz.ch>

       
       <........nonsense non-bug report by Woolton........>

    Marc> This is not a bug and yes you have missed something.

    Marc> Read R FAQ 7.31 Why doesn't R think these numbers are equal?

    Marc> More information is also available here:

    Marc> http://grouper.ieee.org/groups/754/

thank you, Marc.

    Marc> One possible solution:

    >> i
    Marc> [1] 0.08 0.00 0.33 0.00 0.00 0.00 0.00 0.33 0.00 0.00 0.08 0.08 0.20
    Marc> [14] 0.00 0.13

Note that a slightly more recommended way for the following is

  as.integer(sapply(i, function(x) isTRUE(all.equal(x, 0.33))))

using the    isTRUE(all.equal(...))  idiom 
which I'd recommend quite generally.

Martin

    >> ifelse(sapply(i, function(x) all.equal(x, 0.33)) == "TRUE", 1, 0)
    Marc> [1] 0 0 1 0 0 0 0 1 0 0 0 0 0 0 0

    >> ifelse(sapply(i, function(x) all.equal(x, 0.08)) == "TRUE", 1, 0)
    Marc> [1] 1 0 0 0 0 0 0 0 0 0 1 1 0 0 0

    >> ifelse(sapply(i, function(x) all.equal(x, 0.2)) == "TRUE", 1, 0)
    Marc> [1] 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0

Martin


From ggrothendieck at gmail.com  Wed Jun 22 14:13:56 2005
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Wed, 22 Jun 2005 08:13:56 -0400
Subject: [Rd] Trouble with ifelse and if statement (PR#7962)
In-Reply-To: <17081.7178.640030.851104@stat.math.ethz.ch>
References: <20050622033318.29D25A22C@slim.kubism.ku.dk>
	<17081.7178.640030.851104@stat.math.ethz.ch>
Message-ID: <971536df0506220513455b0c3a@mail.gmail.com>

On 6/22/05, Martin Maechler <maechler at stat.math.ethz.ch> wrote:
> 
>       <........nonsense non-bug report by Woolton........>
> 
>    Marc> This is not a bug and yes you have missed something.
> 
>    Marc> Read R FAQ 7.31 Why doesn't R think these numbers are equal?
> 
>    Marc> More information is also available here:
> 
>    Marc> http://grouper.ieee.org/groups/754/
> 
> thank you, Marc.
> 
>    Marc> One possible solution:
> 
>    >> i
>    Marc> [1] 0.08 0.00 0.33 0.00 0.00 0.00 0.00 0.33 0.00 0.00 0.08 0.08 0.20
>    Marc> [14] 0.00 0.13
> 
> Note that a slightly more recommended way for the following is
> 
>  as.integer(sapply(i, function(x) isTRUE(all.equal(x, 0.33))))
> 
> using the    isTRUE(all.equal(...))  idiom
> which I'd recommend quite generally.

Perhaps it should be added to the 7.31 FAQ answer.


From pgilbert at bank-banque-canada.ca  Wed Jun 22 17:09:55 2005
From: pgilbert at bank-banque-canada.ca (Paul Gilbert)
Date: Wed, 22 Jun 2005 11:09:55 -0400
Subject: [Rd] Lapack calls from fortran
Message-ID: <42B97F42.2060108@bank-banque-canada.ca>

I am trying to call the lapack routine dgesv in the R distribution from 
the fortran code for a package, but when I dyn.load("dse1.so") I get an 
error about undefined symbol: dgesv_

I thought the proper incantation was

MAKEFLAG="FLIBS=/path to/R-2.1.1/libRlapack.so" R CMD SHLIB dse1.f

but apparantly not. How does one do this?

Thanks,
Paul


From MSchwartz at mednetstudy.com  Wed Jun 22 17:15:00 2005
From: MSchwartz at mednetstudy.com (Marc Schwartz)
Date: Wed, 22 Jun 2005 10:15:00 -0500
Subject: [Rd] Suggestion for the R Bugs web page
Message-ID: <1119453300.19120.45.camel@localhost.localdomain>

Hi all,

I would like to recommend that the following text from the R Posting
Guide be placed on the R Bug submission page in the section "Submit New
Reports", which would read as follows:

Submit New Reports

You can submit new bug reports either using an online form by clicking
on the button below or by sending email to r-bugs at biostat.ku.dk. 

Before you post a real bug report, make sure you read R Bugs in the
R-faq. If you're not completely and utterly sure something is a bug,
post a question to r-help, not a bug report to r-bugs - every bug report
requires manual action by one of the R-core members.

If you wish to comment upon an existing report, you cannot do that via
the web interface. Instead send an email to the above address with the
Subject: header containing (PR#999) -- replace 999 with actual report
number, of course.



Perhaps reading that brief middle section, without having to click to
another page, will help to reduce user error reports going to R Bugs and
save members of R Core some time.



Also, as a quick pointer, I noted that there is a repeated word ("for")
on the R Home Page in the "Getting Started" box:

R is a free software environment _for for_ statistical computing and
graphics. It compiles and runs on a wide variety of UNIX platforms,
Windows and MacOS. To download R, please choose your preferred CRAN
mirror.


Best regards,

Marc Schwartz


From dmbates at gmail.com  Wed Jun 22 17:47:39 2005
From: dmbates at gmail.com (Douglas Bates)
Date: Wed, 22 Jun 2005 10:47:39 -0500
Subject: [Rd] Lapack calls from fortran
In-Reply-To: <42B97F42.2060108@bank-banque-canada.ca>
References: <42B97F42.2060108@bank-banque-canada.ca>
Message-ID: <40e66e0b05062208471211f26e@mail.gmail.com>

On 6/22/05, Paul Gilbert <pgilbert at bank-banque-canada.ca> wrote:
> I am trying to call the lapack routine dgesv in the R distribution from
> the fortran code for a package, but when I dyn.load("dse1.so") I get an
> error about undefined symbol: dgesv_
> 
> I thought the proper incantation was
> 
> MAKEFLAG="FLIBS=/path to/R-2.1.1/libRlapack.so" R CMD SHLIB dse1.f
> 
> but apparantly not. How does one do this?

See section 1.2.1 of "Writing R Extensions".  You should add a file
called Makevars to the src directory and include the line

PKG_LIBS = ${LAPACK_LIBS} ${BLAS_LIBS}

in that file


From maechler at stat.math.ethz.ch  Wed Jun 22 18:51:33 2005
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Wed, 22 Jun 2005 18:51:33 +0200
Subject: [Rd] Suggestion for the R Bugs web page
In-Reply-To: <1119453300.19120.45.camel@localhost.localdomain>
References: <1119453300.19120.45.camel@localhost.localdomain>
Message-ID: <17081.38677.931319.484899@stat.math.ethz.ch>

Thank you, Marc, for your suggestion.

>>>>> "Marc" == Marc Schwartz <MSchwartz at mednetstudy.com>
>>>>>     on Wed, 22 Jun 2005 10:15:00 -0500 writes:

    Marc> Hi all,
    Marc> I would like to recommend that the following text from the R Posting
    Marc> Guide be placed on the R Bug submission page in the section "Submit New
    Marc> Reports", which would read as follows:

    Marc> Submit New Reports

    Marc> You can submit new bug reports either using an online form by clicking
    Marc> on the button below or by sending email to r-bugs at biostat.ku.dk. 

actually, nobody should advertize that e-mail (but maybe those
at ku.dk, when they talk about it inside DK), 
but rather  r-bugs at r-project.org .

The advantage of the latter is its "genericity" and the fact
that mails are filtered a bit more.

    Marc> Before you post a real bug report, make sure you read R Bugs in the
    Marc> R-faq. If you're not completely and utterly sure something is a bug,
    Marc> post a question to r-help, not a bug report to r-bugs - every bug report
    Marc> requires manual action by one of the R-core members.

    Marc> If you wish to comment upon an existing report, you cannot do that via
    Marc> the web interface. Instead send an email to the above address with the
    Marc> Subject: header containing (PR#999) -- replace 999 with actual report
    Marc> number, of course.

------------

    Marc> Perhaps reading that brief middle section, without having to click to
    Marc> another page, will help to reduce user error reports going to R Bugs and
    Marc> save members of R Core some time.

Note that we (well, primarily Peter Dalgaard) have considered
complete changes to the R-bugs "system" anyway some of which
would obliterate the e-mail interface completely IIRC.


    Marc> Also, as a quick pointer, I noted that there is a repeated word ("for")
    Marc> on the R Home Page in the "Getting Started" box:

    > R is a free software environment _for for_ statistical computing and
    > graphics. It compiles and runs on a wide variety of UNIX platforms,
    > Windows and MacOS. To download R, please choose your preferred CRAN
    > mirror.

I've fixed that one --- haven't checked for how many months this
has remained unreported....

Thank you, Marc!
Martin

    Marc> Best regards,

    Marc> Marc Schwartz


From MSchwartz at mn.rr.com  Wed Jun 22 19:09:05 2005
From: MSchwartz at mn.rr.com (Marc Schwartz)
Date: Wed, 22 Jun 2005 12:09:05 -0500
Subject: [Rd] Suggestion for the R Bugs web page
In-Reply-To: <17081.38677.931319.484899@stat.math.ethz.ch>
References: <1119453300.19120.45.camel@localhost.localdomain>
	<17081.38677.931319.484899@stat.math.ethz.ch>
Message-ID: <1119460145.19120.70.camel@localhost.localdomain>

On Wed, 2005-06-22 at 18:51 +0200, Martin Maechler wrote:
> Thank you, Marc, for your suggestion.

My pleasure Martin.

> >>>>> "Marc" == Marc Schwartz <MSchwartz at mednetstudy.com>
> >>>>>     on Wed, 22 Jun 2005 10:15:00 -0500 writes:
> 
>     Marc> Hi all,
>     Marc> I would like to recommend that the following text from the R Posting
>     Marc> Guide be placed on the R Bug submission page in the section "Submit New
>     Marc> Reports", which would read as follows:
> 
>     Marc> Submit New Reports
> 
>     Marc> You can submit new bug reports either using an online form by clicking
>     Marc> on the button below or by sending email to r-bugs at biostat.ku.dk. 
> 
> actually, nobody should advertize that e-mail (but maybe those
> at ku.dk, when they talk about it inside DK), 
> but rather  r-bugs at r-project.org .
> 
> The advantage of the latter is its "genericity" and the fact
> that mails are filtered a bit more.

That e-mail above (biostat.ku.dk) is the one presently on the R Bugs
page (both the text and the mailto: link).

>     Marc> Before you post a real bug report, make sure you read R Bugs in the
>     Marc> R-faq. If you're not completely and utterly sure something is a bug,
>     Marc> post a question to r-help, not a bug report to r-bugs - every bug report
>     Marc> requires manual action by one of the R-core members.
> 
>     Marc> If you wish to comment upon an existing report, you cannot do that via
>     Marc> the web interface. Instead send an email to the above address with the
>     Marc> Subject: header containing (PR#999) -- replace 999 with actual report
>     Marc> number, of course.
> 
> ------------
> 
>     Marc> Perhaps reading that brief middle section, without having to click to
>     Marc> another page, will help to reduce user error reports going to R Bugs and
>     Marc> save members of R Core some time.
> 
> Note that we (well, primarily Peter Dalgaard) have considered
> complete changes to the R-bugs "system" anyway some of which
> would obliterate the e-mail interface completely IIRC.

Bugzilla?  ;-)

JitterBug of course is no longer actively maintained by the Samba folks.

>     Marc> Also, as a quick pointer, I noted that there is a repeated word ("for")
>     Marc> on the R Home Page in the "Getting Started" box:
> 
>     > R is a free software environment _for for_ statistical computing and
>     > graphics. It compiles and runs on a wide variety of UNIX platforms,
>     > Windows and MacOS. To download R, please choose your preferred CRAN
>     > mirror.
> 
> I've fixed that one --- haven't checked for how many months this
> has remained unreported....
> 
> Thank you, Marc!
> Martin

You are welcome Martin. I don't often go to the main page, as I have
specific pages bookmarked in Firefox. It just happened to catch my eye.

Marc


From ben.bob at gmail.com  Wed Jun 22 20:14:02 2005
From: ben.bob at gmail.com (Bo Peng)
Date: Wed, 22 Jun 2005 13:14:02 -0500
Subject: [Rd] efficiency of sample() with prob.
In-Reply-To: <C698D707214E6F4AB39AB7096C3DE5A5AB5031@phost015.EVAFUNDS.intermedia.net>
References: <C698D707214E6F4AB39AB7096C3DE5A5AB5031@phost015.EVAFUNDS.intermedia.net>
Message-ID: <6ea7b54305062211146473e7bf@mail.gmail.com>

On 6/21/05, Vadim Ogranovich <vograno at evafunds.com> wrote:
> In his "Introduction to Probability Models" Sheldon Ross describes (sec
> 11.4.1, 8th edition) the alias method for such weighted sampling.
> It is based on some decomposition of the original distribution (the
> weights) into a mixture of two-point distributions. 

This sounds like Walker's alias method for weighted sampling. I looked
through Knoth's 'the art of computer programming' and find this
algorithm. I implemented this one but it is just as efficient as the
bisection lookup method in my case. The reason is that the setup of
this algorithm is complicated so it is suited for getting large sample
from short weighted sequences. Anyway, I do suggest R developers try
this algorithm for sample with replacement. A sample code can be found
at http://statistik.wu-wien.ac.at/arvag/monograph/arvag-src/algo03_03.c
.

BTW, does anyone know a quicker algorithm to set up the internal table
of the alias method?

Bo


From p.dalgaard at biostat.ku.dk  Wed Jun 22 21:15:40 2005
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: 22 Jun 2005 21:15:40 +0200
Subject: [Rd] Suggestion for the R Bugs web page
In-Reply-To: <1119460145.19120.70.camel@localhost.localdomain>
References: <1119453300.19120.45.camel@localhost.localdomain>
	<17081.38677.931319.484899@stat.math.ethz.ch>
	<1119460145.19120.70.camel@localhost.localdomain>
Message-ID: <x27jgmcieb.fsf@turmalin.kubism.ku.dk>

Marc Schwartz <MSchwartz at mn.rr.com> writes:

> > Note that we (well, primarily Peter Dalgaard) have considered
> > complete changes to the R-bugs "system" anyway some of which
> > would obliterate the e-mail interface completely IIRC.
> 
> Bugzilla?  ;-)
> 
> JitterBug of course is no longer actively maintained by the Samba folks.

X-actly. No need for the smiley. Apart from the maintenance issue, we
also have the problem of spam injection, aggravated by the fact that
Jitterbug is chopping headers off incoming mail, so that it looks like
it comes from us. We did get blackholed at one point - the entire
pubhealth department...

It would be a no-brainer to switch to Bugzilla, were it not for the
3000 or so messages that are already sitting in the Jitterbug
database.  

-- 
   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
 (*) \(*) -- University of Copenhagen   Denmark          Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)                  FAX: (+45) 35327907


From MSchwartz at mn.rr.com  Wed Jun 22 21:38:51 2005
From: MSchwartz at mn.rr.com (Marc Schwartz)
Date: Wed, 22 Jun 2005 14:38:51 -0500
Subject: [Rd] Suggestion for the R Bugs web page
In-Reply-To: <x27jgmcieb.fsf@turmalin.kubism.ku.dk>
References: <1119453300.19120.45.camel@localhost.localdomain>
	<17081.38677.931319.484899@stat.math.ethz.ch>
	<1119460145.19120.70.camel@localhost.localdomain>
	<x27jgmcieb.fsf@turmalin.kubism.ku.dk>
Message-ID: <1119469131.19120.98.camel@localhost.localdomain>

On Wed, 2005-06-22 at 21:15 +0200, Peter Dalgaard wrote:
> Marc Schwartz <MSchwartz at mn.rr.com> writes:
> 
> > > Note that we (well, primarily Peter Dalgaard) have considered
> > > complete changes to the R-bugs "system" anyway some of which
> > > would obliterate the e-mail interface completely IIRC.
> > 
> > Bugzilla?  ;-)
> > 
> > JitterBug of course is no longer actively maintained by the Samba folks.
> 
> X-actly. No need for the smiley. Apart from the maintenance issue, we
> also have the problem of spam injection, aggravated by the fact that
> Jitterbug is chopping headers off incoming mail, so that it looks like
> it comes from us. We did get blackholed at one point - the entire
> pubhealth department...

Ouch. That's not good.

Perhaps that's one of many reasons that the Samba folks themselves have
switched to Bugzilla?

> It would be a no-brainer to switch to Bugzilla, were it not for the
> 3000 or so messages that are already sitting in the Jitterbug
> database.  

Might the python script linked at the follow Bugzilla report be of use?

https://bugzilla.mozilla.org/show_bug.cgi?id=124869

See the attachment in Comment #1:

https://bugzilla.mozilla.org/attachment.cgi?id=69233

as the author's web site link appears to be offline. I don't know
python, so I would defer to others with more expertise as to whether the
above is useful "as is", or might serve as a starting point.

Marc


From p.dalgaard at biostat.ku.dk  Wed Jun 22 22:06:19 2005
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: 22 Jun 2005 22:06:19 +0200
Subject: [Rd] Suggestion for the R Bugs web page
In-Reply-To: <1119469131.19120.98.camel@localhost.localdomain>
References: <1119453300.19120.45.camel@localhost.localdomain>
	<17081.38677.931319.484899@stat.math.ethz.ch>
	<1119460145.19120.70.camel@localhost.localdomain>
	<x27jgmcieb.fsf@turmalin.kubism.ku.dk>
	<1119469131.19120.98.camel@localhost.localdomain>
Message-ID: <x23bracg1w.fsf@turmalin.kubism.ku.dk>

Marc Schwartz <MSchwartz at mn.rr.com> writes:

> On Wed, 2005-06-22 at 21:15 +0200, Peter Dalgaard wrote:
> > Marc Schwartz <MSchwartz at mn.rr.com> writes:
> > 
> > > > Note that we (well, primarily Peter Dalgaard) have considered
> > > > complete changes to the R-bugs "system" anyway some of which
> > > > would obliterate the e-mail interface completely IIRC.
> > > 
> > > Bugzilla?  ;-)
> > > 
> > > JitterBug of course is no longer actively maintained by the Samba folks.
> > 
> > X-actly. No need for the smiley. Apart from the maintenance issue, we
> > also have the problem of spam injection, aggravated by the fact that
> > Jitterbug is chopping headers off incoming mail, so that it looks like
> > it comes from us. We did get blackholed at one point - the entire
> > pubhealth department...
> 
> Ouch. That's not good.

Fortunately, we got pulled out of the hole relatively fast, because
Duncan Murdoch knew the mechanisms. And fortunately, not every
recipient uses those blackhole lists.
 
> Perhaps that's one of many reasons that the Samba folks themselves have
> switched to Bugzilla?

Andrew Tridgell will have known about the lack of maintenance for a
while... The idea of putting a public mailing list into the loop
wasn't part of the original design. The code to prevent duplicates
from messages sent to both r-bugs and r-devel was a local hack.

> > It would be a no-brainer to switch to Bugzilla, were it not for the
> > 3000 or so messages that are already sitting in the Jitterbug
> > database.  
> 
> Might the python script linked at the follow Bugzilla report be of use?
> 
> https://bugzilla.mozilla.org/show_bug.cgi?id=124869
> 
> See the attachment in Comment #1:
> 
> https://bugzilla.mozilla.org/attachment.cgi?id=69233
> 
> as the author's web site link appears to be offline. I don't know
> python, so I would defer to others with more expertise as to whether the
> above is useful "as is", or might serve as a starting point.

Yes, I got the bright idea of googling for "jitterbug bugzilla" just
after replying as well... It does look quite useful. Not that I speak
Python either (Monty excepted), but the scheme he has been converting
from - status encoded in the directory name - is quite similar to our
slightly simpler Foo/Foo-fixed convention.

-- 
   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
 (*) \(*) -- University of Copenhagen   Denmark          Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)                  FAX: (+45) 35327907


From murdoch at stats.uwo.ca  Wed Jun 22 22:15:51 2005
From: murdoch at stats.uwo.ca (murdoch@stats.uwo.ca)
Date: Wed, 22 Jun 2005 22:15:51 +0200 (CEST)
Subject: [Rd] Rgui bug in Windows:  leftover download dialog (PR#7964)
Message-ID: <20050622201551.AE1A1A2CA@slim.kubism.ku.dk>

In Windows, if a download is interrupted (by switching to the console 
window and hitting ESC), the download status dialog can be left 
onscreen, with no apparent way to get rid of it (other than stopping and 
restarting R).

To duplicate:

Run this:

a <- available.packages()
download.packages(a, 'c:/temp')

Then, during a particularly long download, switch to the console window 
and hit ESC.

This affects R-devel, as well as 2.1.1.

Duncan Murdoch


From ripley at stats.ox.ac.uk  Wed Jun 22 22:35:03 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed, 22 Jun 2005 21:35:03 +0100 (BST)
Subject: [Rd] efficiency of sample() with prob.
In-Reply-To: <6ea7b54305062211146473e7bf@mail.gmail.com>
References: <C698D707214E6F4AB39AB7096C3DE5A5AB5031@phost015.EVAFUNDS.intermedia.net>
	<6ea7b54305062211146473e7bf@mail.gmail.com>
Message-ID: <Pine.LNX.4.61.0506222005080.3592@gannet.stats>

You might recall the message

     R is a collaborative project with many contributors.

We suggest that you take up your own suggestion, research this area and 
offer the R project the results of your research for consideration as your 
contribution.

It seems likely that in sample(x, size, replace = TRUE, prob) the optimal 
method depends on both the size of 'x' and 'size' and perhaps to a lesser 
extent on 'prob'.  (That's what my book on the subject shows.)

On Wed, 22 Jun 2005, Bo Peng wrote:

> On 6/21/05, Vadim Ogranovich <vograno at evafunds.com> wrote:
>> In his "Introduction to Probability Models" Sheldon Ross describes (sec
>> 11.4.1, 8th edition) the alias method for such weighted sampling.
>> It is based on some decomposition of the original distribution (the
>> weights) into a mixture of two-point distributions.
>
> This sounds like Walker's alias method for weighted sampling. I looked
> through Knoth's 'the art of computer programming' and find this
> algorithm. I implemented this one but it is just as efficient as the
> bisection lookup method in my case. The reason is that the setup of
> this algorithm is complicated so it is suited for getting large sample
> from short weighted sequences. Anyway, I do suggest R developers try
> this algorithm for sample with replacement. A sample code can be found
> at http://statistik.wu-wien.ac.at/arvag/monograph/arvag-src/algo03_03.c
> .
>
> BTW, does anyone know a quicker algorithm to set up the internal table
> of the alias method?

Quicker than what?  See the discussion in my Stochastic Simulation book 
for `quicker than Walker'.

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From MSchwartz at mn.rr.com  Wed Jun 22 22:36:23 2005
From: MSchwartz at mn.rr.com (Marc Schwartz)
Date: Wed, 22 Jun 2005 15:36:23 -0500
Subject: [Rd] Suggestion for the R Bugs web page
In-Reply-To: <x23bracg1w.fsf@turmalin.kubism.ku.dk>
References: <1119453300.19120.45.camel@localhost.localdomain>
	<17081.38677.931319.484899@stat.math.ethz.ch>
	<1119460145.19120.70.camel@localhost.localdomain>
	<x27jgmcieb.fsf@turmalin.kubism.ku.dk>
	<1119469131.19120.98.camel@localhost.localdomain>
	<x23bracg1w.fsf@turmalin.kubism.ku.dk>
Message-ID: <1119472583.19120.106.camel@localhost.localdomain>

On Wed, 2005-06-22 at 22:06 +0200, Peter Dalgaard wrote:
> Marc Schwartz <MSchwartz at mn.rr.com> writes:
> 
> > On Wed, 2005-06-22 at 21:15 +0200, Peter Dalgaard wrote:
> > > It would be a no-brainer to switch to Bugzilla, were it not for the
> > > 3000 or so messages that are already sitting in the Jitterbug
> > > database.  
> > 
> > Might the python script linked at the follow Bugzilla report be of use?
> > 
> > https://bugzilla.mozilla.org/show_bug.cgi?id=124869
> > 
> > See the attachment in Comment #1:
> > 
> > https://bugzilla.mozilla.org/attachment.cgi?id=69233
> > 
> > as the author's web site link appears to be offline. I don't know
> > python, so I would defer to others with more expertise as to whether the
> > above is useful "as is", or might serve as a starting point.
> 
> Yes, I got the bright idea of googling for "jitterbug bugzilla" just
> after replying as well... It does look quite useful. Not that I speak
> Python either (Monty excepted), but the scheme he has been converting
> from - status encoded in the directory name - is quite similar to our
> slightly simpler Foo/Foo-fixed convention.


Well, hopefully that might work with only modest alteration then,
enabling a less painful transition. Pending further review of course...

Marc

"Follow. But! Follow only if ye be men of valor, for the entrance to
this cave is guarded by a creature so foul, so cruel that no man yet has
fought with it and lived! Bones of full fifty men lie strewn about its
lair. So, brave knights, if you do doubt your courage or your strength,
come no further, for death awaits you all with nasty, big, pointy
teeth."


From hb at maths.lth.se  Thu Jun 23 17:48:39 2005
From: hb at maths.lth.se (Henrik Bengtsson)
Date: Thu, 23 Jun 2005 17:48:39 +0200
Subject: [Rd] Unattended Windows installation of R modified with v2.1.1
Message-ID: <42BAD9D7.6090307@maths.lth.se>

FYI, I just noticed that an unattended Windows installation of R v2.1.1 
patched (2005-06-22), that is,

  rw2011pat.exe /silent /sp- /norestart

no longer installs the perl scripts INSTALL, build check and so on (I 
think this is the flag "Source Package Installation Files" in InnoSetup. 
   It used to do this as I can remember. I have not tried

/COMPONENTS="comma separated list of component names"
set the initial list of components: Components are named main, chtml, 
html, latex, manuals, refman, libdocs, devel, tcl, mbcs, Rd and trans.

from the rw-FAQ.html, which will probably do what I want.

If this modification was not intended, I just want to make the 
maintainer of the R Windows InnoSetup script (Duncan M and Brian R?) 
aware of it.

Cheers

Henrik


From ripley at stats.ox.ac.uk  Thu Jun 23 18:55:43 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu, 23 Jun 2005 17:55:43 +0100 (BST)
Subject: [Rd] Unattended Windows installation of R modified with v2.1.1
In-Reply-To: <42BAD9D7.6090307@maths.lth.se>
References: <42BAD9D7.6090307@maths.lth.se>
Message-ID: <Pine.LNX.4.61.0506231751150.6966@gannet.stats>

Well, rw2011.exe does install the default set of components for me, and 
nothing has changed in the last few days.

Note that Inno Setup does pick up default options from a previously 
installed version of R, so that might be the explanation.  (It might even
do so if one had already been uninstalled: the docs are not clear about 
this.)

Specifying /COMPONENTS is probably what you want to do to be sure.

On Thu, 23 Jun 2005, Henrik Bengtsson wrote:

> FYI, I just noticed that an unattended Windows installation of R v2.1.1
> patched (2005-06-22), that is,
>
>  rw2011pat.exe /silent /sp- /norestart
>
> no longer installs the perl scripts INSTALL, build check and so on (I
> think this is the flag "Source Package Installation Files" in InnoSetup.
>   It used to do this as I can remember. I have not tried
>
> /COMPONENTS="comma separated list of component names"
> set the initial list of components: Components are named main, chtml,
> html, latex, manuals, refman, libdocs, devel, tcl, mbcs, Rd and trans.
>
> from the rw-FAQ.html, which will probably do what I want.
>
> If this modification was not intended, I just want to make the
> maintainer of the R Windows InnoSetup script (Duncan M and Brian R?)
> aware of it.
>
> Cheers
>
> Henrik
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From murdoch at stats.uwo.ca  Thu Jun 23 18:58:35 2005
From: murdoch at stats.uwo.ca (murdoch@stats.uwo.ca)
Date: Thu, 23 Jun 2005 18:58:35 +0200 (CEST)
Subject: [Rd] Rgui bug in Windows:  leftover download dialog (PR#7964)
Message-ID: <20050623165835.2E543A256@slim.kubism.ku.dk>

On 6/22/2005 4:15 PM, murdoch at stats.uwo.ca wrote:
> In Windows, if a download is interrupted (by switching to the console 
> window and hitting ESC), the download status dialog can be left 
> onscreen, with no apparent way to get rid of it (other than stopping and 
> restarting R).
> 
> To duplicate:
> 
> Run this:
> 
> a <- available.packages()
> download.packages(a, 'c:/temp')
> 
> Then, during a particularly long download, switch to the console window 
> and hit ESC.
> 
> This affects R-devel, as well as 2.1.1.

Now fixed in R-devel and R-patched.  I also set it so the dialog retains 
its position if you move it out of the way; it was pretty irritating to 
have it pop up in the middle of the screen every time in a multiple file 
download.

Duncan Murdoch


From ripley at stats.ox.ac.uk  Thu Jun 23 19:23:39 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu, 23 Jun 2005 18:23:39 +0100 (BST)
Subject: [Rd] Rgui bug in Windows:  leftover download dialog (PR#7964)
In-Reply-To: <20050623165835.2E543A256@slim.kubism.ku.dk>
References: <20050623165835.2E543A256@slim.kubism.ku.dk>
Message-ID: <Pine.LNX.4.61.0506231817380.7673@gannet.stats>

On Thu, 23 Jun 2005 murdoch at stats.uwo.ca wrote:

> On 6/22/2005 4:15 PM, murdoch at stats.uwo.ca wrote:
>> In Windows, if a download is interrupted (by switching to the console
>> window and hitting ESC), the download status dialog can be left
>> onscreen, with no apparent way to get rid of it (other than stopping and
>> restarting R).
>>
>> To duplicate:
>>
>> Run this:
>>
>> a <- available.packages()
>> download.packages(a, 'c:/temp')
>>
>> Then, during a particularly long download, switch to the console window
>> and hit ESC.
>>
>> This affects R-devel, as well as 2.1.1.
>
> Now fixed in R-devel and R-patched.  I also set it so the dialog retains
> its position if you move it out of the way; it was pretty irritating to
> have it pop up in the middle of the screen every time in a multiple file
> download.

I don't think you can do simultaneous downloads, and is not the `it' 
different progress bar windows?

Do you mean that the next instance of a progress bar will come up where 
the last one was?  That seems not the standard ergonomics on GUI systems, 
in which a new window is treated as a new window and not the same as an 
old one.  I hate it when Windows puts Firefox up where I dragged the last 
Firefox window (or even where another user dragged it).

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From murdoch at stats.uwo.ca  Thu Jun 23 19:49:06 2005
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Thu, 23 Jun 2005 13:49:06 -0400
Subject: [Rd] Rgui bug in Windows:  leftover download dialog (PR#7964)
In-Reply-To: <Pine.LNX.4.61.0506231817380.7673@gannet.stats>
References: <20050623165835.2E543A256@slim.kubism.ku.dk>
	<Pine.LNX.4.61.0506231817380.7673@gannet.stats>
Message-ID: <42BAF612.9060806@stats.uwo.ca>

On 6/23/2005 1:23 PM, Prof Brian Ripley wrote:
> On Thu, 23 Jun 2005 murdoch at stats.uwo.ca wrote:
> 
>> On 6/22/2005 4:15 PM, murdoch at stats.uwo.ca wrote:
>>> In Windows, if a download is interrupted (by switching to the console
>>> window and hitting ESC), the download status dialog can be left
>>> onscreen, with no apparent way to get rid of it (other than stopping and
>>> restarting R).
>>>
>>> To duplicate:
>>>
>>> Run this:
>>>
>>> a <- available.packages()
>>> download.packages(a, 'c:/temp')
>>>
>>> Then, during a particularly long download, switch to the console window
>>> and hit ESC.
>>>
>>> This affects R-devel, as well as 2.1.1.
>>
>> Now fixed in R-devel and R-patched.  I also set it so the dialog retains
>> its position if you move it out of the way; it was pretty irritating to
>> have it pop up in the middle of the screen every time in a multiple file
>> download.
> 
> I don't think you can do simultaneous downloads, and is not the `it' 
> different progress bar windows?

Right, simultaneous downloads are not possible.

> Do you mean that the next instance of a progress bar will come up where 
> the last one was?  

Yes, but see below.

> That seems not the standard ergonomics on GUI systems, 
> in which a new window is treated as a new window and not the same as an 
> old one.  

It would be good ergonomics if there was just one progress bar window 
when multiple files were selected for download, but I think that's too 
much trouble to do, since the C function called by download.file doesn't 
get told it's part of a multiple download sequence.

The changes I made make just one progress bar window for the whole 
session, and make it visible when downloading and invisible otherwise. 
It's a change to the UI (one long-lived window instead of many 
short-lived ones).

 > I hate it when Windows puts Firefox up where I dragged the last
> Firefox window (or even where another user dragged it).

I think that's really Firefox moving itself to where it last was when 
you closed it; as far as I know Windows doesn't remember such things 
unless asked.  There's probably some Mozilla option to control that 
behaviour.

The retention I put in is entirely within an R session.  Each download 
just makes the same progress window visible where you last left it, 
instead of creating a new one.  This way if you're doing something like 
installing all of CRAN, you can push the progress bar out of the way 
while the downloads are going on, and it will stay out of the way.  It 
does seem to have an annoying habit of grabbing the focus away from some 
programs, but not all; I'm not sure what's going on there or whether 
this can be fixed.

Duncan Murdoch


From weigand at mayo.edu  Thu Jun 23 20:46:37 2005
From: weigand at mayo.edu (weigand@mayo.edu)
Date: Thu, 23 Jun 2005 20:46:37 +0200 (CEST)
Subject: [Rd] typo in dev2bitmap.R (PR#7966)
Message-ID: <20050623184637.21B57A258@slim.kubism.ku.dk>

Full_Name: Stephen Weigand
Version: 2.0.1
OS: solaris2.9
Submission from: (NULL) (129.176.151.21)


R> bitmap("")

produces the following error message as of the June 23 download of R-devel:

Error in bitmap("") : 'file' is must be a non-empty character string
                             
The word "is" should deleted.

This appears to be a typo in dev2bitmap.R (appearing twice in unix/dev2bitmap.R
and twice in windows/dev2bitmap.R). 

Other affected files include

grDevices/po/R-grDevices.pot

grDevices/po/R-it.po

grDevices/po/R-en at quot.po

grDevices/po/R-en at quot.po

grDevices/po/R-ja.po

grDevices/po/R-ko.po

Thank you,

Stephen Weigand


From hb at maths.lth.se  Thu Jun 23 20:58:05 2005
From: hb at maths.lth.se (Henrik Bengtsson)
Date: Thu, 23 Jun 2005 20:58:05 +0200
Subject: [Rd] Unattended Windows installation of R modified with v2.1.1
In-Reply-To: <Pine.LNX.4.61.0506231751150.6966@gannet.stats>
References: <42BAD9D7.6090307@maths.lth.se>
	<Pine.LNX.4.61.0506231751150.6966@gannet.stats>
Message-ID: <42BB063D.5020604@maths.lth.se>

Prof Brian Ripley wrote:
> Well, rw2011.exe does install the default set of components for me, and 
> nothing has changed in the last few days.
> 
> Note that Inno Setup does pick up default options from a previously 
> installed version of R, so that might be the explanation.  (It might even
> do so if one had already been uninstalled: the docs are not clear about 
> this.)
> 
> Specifying /COMPONENTS is probably what you want to do to be sure.

Thanks for this. All good to know. It could be that I actually installed 
a patch version (over an previous patch version) and that I did this 
"attended" without selecting "devel", but I cannot remember. I'll keep 
an eye on it for the next time.

Henrik

> On Thu, 23 Jun 2005, Henrik Bengtsson wrote:
> 
>> FYI, I just noticed that an unattended Windows installation of R v2.1.1
>> patched (2005-06-22), that is,
>>
>>  rw2011pat.exe /silent /sp- /norestart
>>
>> no longer installs the perl scripts INSTALL, build check and so on (I
>> think this is the flag "Source Package Installation Files" in InnoSetup.
>>   It used to do this as I can remember. I have not tried
>>
>> /COMPONENTS="comma separated list of component names"
>> set the initial list of components: Components are named main, chtml,
>> html, latex, manuals, refman, libdocs, devel, tcl, mbcs, Rd and trans.
>>
>> from the rw-FAQ.html, which will probably do what I want.
>>
>> If this modification was not intended, I just want to make the
>> maintainer of the R Windows InnoSetup script (Duncan M and Brian R?)
>> aware of it.
>>
>> Cheers
>>
>> Henrik
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>>
>


From vograno at evafunds.com  Thu Jun 23 22:18:35 2005
From: vograno at evafunds.com (Vadim Ogranovich)
Date: Thu, 23 Jun 2005 13:18:35 -0700
Subject: [Rd] list.files() reorders files  in R CMD INSALL
Message-ID: <C698D707214E6F4AB39AB7096C3DE5A5AB50FD@phost015.EVAFUNDS.intermedia.net>

Hi,
 
The list.files() function seems to order its result vector differently
when is run during R CMD INSTALL. Here is an example:
 
~% mkdir ~/FOO
~% cd ~/FOO/
~/FOO% touch a A b B
~/FOO% ls
a  A  b  B

 
Put foo.R in the vor package. The foo.R just prints the files in ~/FOO:
print(list.files("~/FOO"))

Now install the package:
~/FOO% R CMD INSTALL -l ~/R/library/ ~/src/vor/
* Installing *source* package 'vor' ...
** libs
make: `vor.so' is up to date.
** R
** preparing package for lazy loading
[1] "A" "B" "a" "b"
 
** help
 >>> Building/Updating help pages for package 'vor'
     Formats: text html latex example 
* DONE (vor)

 
Note that the files are listed as: [1] "A" "B" "a" "b"
 
Now start an R session
> list.files("~/FOO")
[1] "a" "A" "b" "B"

which differs in order from that in R CMD INSTALL.
 
 
> version
         _                       
platform x86_64-unknown-linux-gnu
arch     x86_64                  
os       linux-gnu               
system   x86_64, linux-gnu       
status                           
major    2                       
minor    0.1                     
year     2004                    
month    11                      
day      15                      
language R                       

Thanks,
Vadim


From murdoch at stats.uwo.ca  Thu Jun 23 22:38:15 2005
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Thu, 23 Jun 2005 16:38:15 -0400
Subject: [Rd] list.files() reorders files  in R CMD INSALL
In-Reply-To: <C698D707214E6F4AB39AB7096C3DE5A5AB50FD@phost015.EVAFUNDS.intermedia.net>
References: <C698D707214E6F4AB39AB7096C3DE5A5AB50FD@phost015.EVAFUNDS.intermedia.net>
Message-ID: <42BB1DB7.8050004@stats.uwo.ca>

On 6/23/2005 4:18 PM, Vadim Ogranovich wrote:
> Hi,
>  
> The list.files() function seems to order its result vector differently
> when is run during R CMD INSTALL. Here is an example:
>  
> ~% mkdir ~/FOO
> ~% cd ~/FOO/
> ~/FOO% touch a A b B
> ~/FOO% ls
> a  A  b  B
> 
>  
> Put foo.R in the vor package. The foo.R just prints the files in ~/FOO:
> print(list.files("~/FOO"))
> 
> Now install the package:
> ~/FOO% R CMD INSTALL -l ~/R/library/ ~/src/vor/
> * Installing *source* package 'vor' ...
> ** libs
> make: `vor.so' is up to date.
> ** R
> ** preparing package for lazy loading
> [1] "A" "B" "a" "b"
>  
> ** help
>  >>> Building/Updating help pages for package 'vor'
>      Formats: text html latex example 
> * DONE (vor)
> 
>  
> Note that the files are listed as: [1] "A" "B" "a" "b"
>  
> Now start an R session
>> list.files("~/FOO")
> [1] "a" "A" "b" "B"
> 
> which differs in order from that in R CMD INSTALL.

Looks like the sorting is being done in the C locale in the first case, 
and in a different one in the second.  See ?locales for how to set the 
locale to what you want.

Duncan Murdoch


From murdoch at stats.uwo.ca  Thu Jun 23 22:46:46 2005
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Thu, 23 Jun 2005 16:46:46 -0400
Subject: [Rd] list.files() reorders files  in R CMD INSALL
In-Reply-To: <42BB1DB7.8050004@stats.uwo.ca>
References: <C698D707214E6F4AB39AB7096C3DE5A5AB50FD@phost015.EVAFUNDS.intermedia.net>
	<42BB1DB7.8050004@stats.uwo.ca>
Message-ID: <42BB1FB6.9090808@stats.uwo.ca>

On 6/23/2005 4:38 PM, Duncan Murdoch wrote:
> On 6/23/2005 4:18 PM, Vadim Ogranovich wrote:
>> Hi,
>>  
>> The list.files() function seems to order its result vector differently
>> when is run during R CMD INSTALL. Here is an example:
>>  
>> ~% mkdir ~/FOO
>> ~% cd ~/FOO/
>> ~/FOO% touch a A b B
>> ~/FOO% ls
>> a  A  b  B
>> 
>>  
>> Put foo.R in the vor package. The foo.R just prints the files in ~/FOO:
>> print(list.files("~/FOO"))
>> 
>> Now install the package:
>> ~/FOO% R CMD INSTALL -l ~/R/library/ ~/src/vor/
>> * Installing *source* package 'vor' ...
>> ** libs
>> make: `vor.so' is up to date.
>> ** R
>> ** preparing package for lazy loading
>> [1] "A" "B" "a" "b"
>>  
>> ** help
>>  >>> Building/Updating help pages for package 'vor'
>>      Formats: text html latex example 
>> * DONE (vor)
>> 
>>  
>> Note that the files are listed as: [1] "A" "B" "a" "b"
>>  
>> Now start an R session
>>> list.files("~/FOO")
>> [1] "a" "A" "b" "B"
>> 
>> which differs in order from that in R CMD INSTALL.
> 
> Looks like the sorting is being done in the C locale in the first case, 
> and in a different one in the second.  See ?locales for how to set the 
> locale to what you want.

... when in R, and see the R Extensions manual for setting it during the 
INSTALL.

Duncan Murdoch


From p.dalgaard at biostat.ku.dk  Thu Jun 23 23:13:36 2005
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: 23 Jun 2005 23:13:36 +0200
Subject: [Rd] list.files() reorders files  in R CMD INSALL
In-Reply-To: <42BB1FB6.9090808@stats.uwo.ca>
References: <C698D707214E6F4AB39AB7096C3DE5A5AB50FD@phost015.EVAFUNDS.intermedia.net>
	<42BB1DB7.8050004@stats.uwo.ca> <42BB1FB6.9090808@stats.uwo.ca>
Message-ID: <x2aclgn5dr.fsf@turmalin.kubism.ku.dk>

Duncan Murdoch <murdoch at stats.uwo.ca> writes:

> >> [1] "a" "A" "b" "B"
> >> 
> >> which differs in order from that in R CMD INSTALL.
> > 
> > Looks like the sorting is being done in the C locale in the first case, 
> > and in a different one in the second.  See ?locales for how to set the 
> > locale to what you want.
> 
> ... when in R, and see the R Extensions manual for setting it during the 
> INSTALL.

However, notice that the C locale is generally enforced for a reason:
Sometimes the order of files matter, e.g. the file zzz.R is designed
to come last, but in en_GB it actually comes before Zeke.R and in
Estonian z comes between s and t...

-- 
   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
 (*) \(*) -- University of Copenhagen   Denmark          Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)                  FAX: (+45) 35327907


From ben.bob at gmail.com  Thu Jun 23 23:37:35 2005
From: ben.bob at gmail.com (Bo Peng)
Date: Thu, 23 Jun 2005 16:37:35 -0500
Subject: [Rd] efficiency of sample() with prob.
In-Reply-To: <Pine.LNX.4.61.0506222005080.3592@gannet.stats>
References: <C698D707214E6F4AB39AB7096C3DE5A5AB5031@phost015.EVAFUNDS.intermedia.net>
	<6ea7b54305062211146473e7bf@mail.gmail.com>
	<Pine.LNX.4.61.0506222005080.3592@gannet.stats>
Message-ID: <6ea7b54305062314375200f7d9@mail.gmail.com>

> We suggest that you take up your own suggestion, research this area and
> offer the R project the results of your research for consideration as your
> contribution.

I implemented Walker's alias method and re-compiled R. Here is what
I did:

1. replace function ProcSampleReplace in R-2.1.0/src/main/random.c
  with the following one 
  
static void ProbSampleReplace(int n, double *p, int *perm, int nans, int *ans)
{
    /* allocate memory for a, p and HL */
    double * q = Calloc(n, double);
    int * a = Calloc(n, int);
    int * HL = Calloc(n, int); 
    int * H = HL;       
    int * L = HL+n-1;      
    int i, j, k;
    double rU;  /* U[0,1)*n */

    /* set up alias table */
    /* initialize q with n*p0,...n*p_n-1 */
    for(i=0; i<n; ++i)
        q[i] = p[i]*n;

    /* initialize a with indices */
    for(i=0; i<n; ++i)
        a[i] = i;

    /* set up H and L */
    for(i=0; i<n; ++i) {
        if( q[i] >= 1.)
            *H++ = i;
        else
            *L-- = i;
    }

    while( H != HL && L != HL+n-1) {
        j = *(L+1);
        k = *(H-1);
        a[j] = k;
        q[k] += q[j] - 1;
        L++;                                  /* remove j from L */
        if( q[k] < 1. ) {
            *L-- = k;                         /* add k to L */
            --H;                              /* remove k */
        }
    }

    /* generate sample */
    for (i = 0; i < nans; ++i) {
	rU = unif_rand() * n;

        k = (int)(rU);
        rU -= k;  /* rU becomes rU-[rU] */

        if( rU < q[k] )
            ans[i] = k+1;
        else
            ans[i] = a[k]+1;
    }
    Free(HL);
    Free(a);
    Free(q); 
}

2. make and make install

3. test the new sample function by code like

> b=sample(seq(1,100), prob=seq(1,100), replace=TRUE, size=1000000)
> table(b)/1000000*sum(seq(1,100))

4. run the following code in current R 2.1.0 and updated R.

for(prob in seq(1,4)){
  for(sample in seq(1,4)){
    x = seq(1:(10^prob))   # short to long x
    p = abs(rnorm(length(x)))  # prob vector
    times = 10^(6-prob)   # run shorter cases more times
    Rprof(paste("sample_", prob, "_", sample, ".prof", sep=''))
    for(t in seq(1,times)){
      sample(x, prob=p, size=10^sample, replace=TRUE )
    }
    Rprof(NULL)
  }
}

Basically, I tried to test the performance of sample(replace=TRUE, prob=..)
with different length of x and size.

5. process the profiles and here is the result.
p: length of prob and x
size: size of sample
cell: execution time of old/updated sample()

  size\p    10          10^2        10^3       10^4
  10       2.4/1.6      0.32/0.22   0.20/0.08  0.24/0.06  
  10^2     3.1/2.6      0.48/0.28   0.28/0.06  0.30/0.06
  10^3     11.8/11.1    1.84/1.14   0.94/0.18  0.96/0.08
  10^4     96.8/96.6    15.34/9.68  7.54/1.06  7.48/0.16
  run:     10000        1000        100        10 times

We can see that the alias method is quicker than the linear search
method in all cases. The performance difference is greatest (>50 times)
when the original algorithm need to search in a long prob vector.

I have not thoroughly tested the new function. I will do so if you
(the developers) think that this has the potential to be incorporated
into R.

Thanks.

Bo Peng
Department of Statistics
Rice University


From ripley at stats.ox.ac.uk  Fri Jun 24 08:10:46 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri, 24 Jun 2005 07:10:46 +0100 (BST)
Subject: [Rd] efficiency of sample() with prob.
In-Reply-To: <6ea7b54305062314375200f7d9@mail.gmail.com>
References: <C698D707214E6F4AB39AB7096C3DE5A5AB5031@phost015.EVAFUNDS.intermedia.net>
	<6ea7b54305062211146473e7bf@mail.gmail.com>
	<Pine.LNX.4.61.0506222005080.3592@gannet.stats>
	<6ea7b54305062314375200f7d9@mail.gmail.com>
Message-ID: <Pine.LNX.4.61.0506240707500.25757@gannet.stats>

`Research' involves looking at all the competitor methods, devising a 
near-optimal strategy and selecting amongst methods according to that 
strategy.  It is not a quick fix we are looking for but something that
will be good for the long term.

On Thu, 23 Jun 2005, Bo Peng wrote:

>> We suggest that you take up your own suggestion, research this area and
>> offer the R project the results of your research for consideration as your
>> contribution.
>
> I implemented Walker's alias method and re-compiled R. Here is what
> I did:
>
> 1. replace function ProcSampleReplace in R-2.1.0/src/main/random.c
>  with the following one
>
> static void ProbSampleReplace(int n, double *p, int *perm, int nans, int *ans)
> {
>    /* allocate memory for a, p and HL */
>    double * q = Calloc(n, double);
>    int * a = Calloc(n, int);
>    int * HL = Calloc(n, int);
>    int * H = HL;
>    int * L = HL+n-1;
>    int i, j, k;
>    double rU;  /* U[0,1)*n */
>
>    /* set up alias table */
>    /* initialize q with n*p0,...n*p_n-1 */
>    for(i=0; i<n; ++i)
>        q[i] = p[i]*n;
>
>    /* initialize a with indices */
>    for(i=0; i<n; ++i)
>        a[i] = i;
>
>    /* set up H and L */
>    for(i=0; i<n; ++i) {
>        if( q[i] >= 1.)
>            *H++ = i;
>        else
>            *L-- = i;
>    }
>
>    while( H != HL && L != HL+n-1) {
>        j = *(L+1);
>        k = *(H-1);
>        a[j] = k;
>        q[k] += q[j] - 1;
>        L++;                                  /* remove j from L */
>        if( q[k] < 1. ) {
>            *L-- = k;                         /* add k to L */
>            --H;                              /* remove k */
>        }
>    }
>
>    /* generate sample */
>    for (i = 0; i < nans; ++i) {
> 	rU = unif_rand() * n;
>
>        k = (int)(rU);
>        rU -= k;  /* rU becomes rU-[rU] */
>
>        if( rU < q[k] )
>            ans[i] = k+1;
>        else
>            ans[i] = a[k]+1;
>    }
>    Free(HL);
>    Free(a);
>    Free(q);
> }
>
> 2. make and make install
>
> 3. test the new sample function by code like
>
>> b=sample(seq(1,100), prob=seq(1,100), replace=TRUE, size=1000000)
>> table(b)/1000000*sum(seq(1,100))
>
> 4. run the following code in current R 2.1.0 and updated R.
>
> for(prob in seq(1,4)){
>  for(sample in seq(1,4)){
>    x = seq(1:(10^prob))   # short to long x
>    p = abs(rnorm(length(x)))  # prob vector
>    times = 10^(6-prob)   # run shorter cases more times
>    Rprof(paste("sample_", prob, "_", sample, ".prof", sep=''))
>    for(t in seq(1,times)){
>      sample(x, prob=p, size=10^sample, replace=TRUE )
>    }
>    Rprof(NULL)
>  }
> }
>
> Basically, I tried to test the performance of sample(replace=TRUE, prob=..)
> with different length of x and size.
>
> 5. process the profiles and here is the result.
> p: length of prob and x
> size: size of sample
> cell: execution time of old/updated sample()
>
>  size\p    10          10^2        10^3       10^4
>  10       2.4/1.6      0.32/0.22   0.20/0.08  0.24/0.06
>  10^2     3.1/2.6      0.48/0.28   0.28/0.06  0.30/0.06
>  10^3     11.8/11.1    1.84/1.14   0.94/0.18  0.96/0.08
>  10^4     96.8/96.6    15.34/9.68  7.54/1.06  7.48/0.16
>  run:     10000        1000        100        10 times
>
> We can see that the alias method is quicker than the linear search
> method in all cases. The performance difference is greatest (>50 times)
> when the original algorithm need to search in a long prob vector.
>
> I have not thoroughly tested the new function. I will do so if you
> (the developers) think that this has the potential to be incorporated
> into R.
>
> Thanks.
>
> Bo Peng
> Department of Statistics
> Rice University
>
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From Chad.P.Jenness at wellsfargo.com  Fri Jun 24 15:18:58 2005
From: Chad.P.Jenness at wellsfargo.com (Chad.P.Jenness@wellsfargo.com)
Date: Fri, 24 Jun 2005 08:18:58 -0500
Subject: [Rd] Embedding R in C application
Message-ID: <B317A5F105ED5B4E88A279BC5DE28F3162855A@msgswbmnmsp20.wellsfargo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
Url: https://stat.ethz.ch/pipermail/r-devel/attachments/20050624/496bc7aa/attachment.pl

From murdoch at stats.uwo.ca  Fri Jun 24 15:29:49 2005
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Fri, 24 Jun 2005 09:29:49 -0400
Subject: [Rd] Embedding R in C application
In-Reply-To: <B317A5F105ED5B4E88A279BC5DE28F3162855A@msgswbmnmsp20.wellsfargo.com>
References: <B317A5F105ED5B4E88A279BC5DE28F3162855A@msgswbmnmsp20.wellsfargo.com>
Message-ID: <42BC0ACD.5060801@stats.uwo.ca>

On 6/24/2005 9:18 AM, Chad.P.Jenness at wellsfargo.com wrote:
> To whom it may concern, 
> I am very interested in embedding the R functionality in our
> application. This is a C application that currently runs on Win32, but
> will also run on Linux in the future. From the material that I have
> seen, I need R compiled as a shared library to evaluate R expressions
> from C. Is this correct? If so, can I download this shared library from
> somewhere? Is there any API document pertaining to this shared library?

You want to look at the "Writing R Extensions" manual, in particular the 
chapters on the R API (for access to the underlying computational 
routines) and the one on linking GUIs or other front-ends (which sounds 
more like what you want to do).

Duncan Murdoch


From d.firth at warwick.ac.uk  Fri Jun 24 15:52:02 2005
From: d.firth at warwick.ac.uk (d.firth@warwick.ac.uk)
Date: Fri, 24 Jun 2005 15:52:02 +0200 (CEST)
Subject: [Rd] Capitalize the title in DESCRIPTION files? (PR#7969)
Message-ID: <20050624135202.895EEA26A@slim.kubism.ku.dk>

Full_Name: David Firth
Version: 2.1.1
OS: Mac OS X
Submission from: (NULL) (137.205.240.25)


A small inconsistency in the "Writing R Extensions" manual: at 
  http://cran.r-project.org/doc/manuals/R-exts.html#The-DESCRIPTION-file
the displayed example has
  Title: My first collection of functions
but the text that follows it says "The Title field...should be capitalized",
which I take to mean
  Title: My First Collection of Functions


From Chad.P.Jenness at wellsfargo.com  Fri Jun 24 15:54:39 2005
From: Chad.P.Jenness at wellsfargo.com (Chad.P.Jenness@wellsfargo.com)
Date: Fri, 24 Jun 2005 08:54:39 -0500
Subject: [Rd] Embedding R in C application
Message-ID: <B317A5F105ED5B4E88A279BC5DE28F3163BE12@msgswbmnmsp20.wellsfargo.com>

I have done this and it sounded like all that I needed to do is #include
<R.h> to get access to R functionality.  However, I was getting
compiling errors when attempting to make an R function call directly
from C, so I did some research, and this is where I saw the reference to
needing the libR.so.  By just including R.h, does this provide me with
the same R functionality as the references that I saw about the libR.so?
If so, then I will continue to use this to access the R functionality
and use the "Writing R Extensions" manual.

Thanks,
Chad Jenness
763-229-0427


-----Original Message-----
From: Duncan Murdoch [mailto:murdoch at stats.uwo.ca] 
Sent: Friday, June 24, 2005 8:30 AM
To: Chad.P.Jenness at wellsfargo.com
Cc: r-devel at r-project.org
Subject: Re: [Rd] Embedding R in C application


On 6/24/2005 9:18 AM, Chad.P.Jenness at wellsfargo.com wrote:
> To whom it may concern,
> I am very interested in embedding the R functionality in our
> application. This is a C application that currently runs on Win32, but
> will also run on Linux in the future. From the material that I have
> seen, I need R compiled as a shared library to evaluate R expressions
> from C. Is this correct? If so, can I download this shared library
from
> somewhere? Is there any API document pertaining to this shared
library?

You want to look at the "Writing R Extensions" manual, in particular the

chapters on the R API (for access to the underlying computational 
routines) and the one on linking GUIs or other front-ends (which sounds 
more like what you want to do).

Duncan Murdoch


From ripley at stats.ox.ac.uk  Fri Jun 24 16:02:50 2005
From: ripley at stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Fri, 24 Jun 2005 16:02:50 +0200 (CEST)
Subject: [Rd] Capitalize the title in DESCRIPTION files? (PR#7969)
Message-ID: <20050624140250.81EB6A1C4@slim.kubism.ku.dk>

On Fri, 24 Jun 2005 d.firth at warwick.ac.uk wrote:

> Full_Name: David Firth
> Version: 2.1.1
> OS: Mac OS X
> Submission from: (NULL) (137.205.240.25)
>
>
> A small inconsistency in the "Writing R Extensions" manual: at
>  http://cran.r-project.org/doc/manuals/R-exts.html#The-DESCRIPTION-file
> the displayed example has
>  Title: My first collection of functions
> but the text that follows it says "The Title field...should be capitalized",
> which I take to mean
>  Title: My First Collection of Functions

Well, `do as we say, not do as we do' applies, I think.
Thank you, we'll try to set a better example.

(As you may guess, the example and advice are from different hands and the 
example predates the advice.)

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From ripley at stats.ox.ac.uk  Fri Jun 24 16:07:37 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri, 24 Jun 2005 15:07:37 +0100 (BST)
Subject: [Rd] Embedding R in C application
In-Reply-To: <B317A5F105ED5B4E88A279BC5DE28F3163BE12@msgswbmnmsp20.wellsfargo.com>
References: <B317A5F105ED5B4E88A279BC5DE28F3163BE12@msgswbmnmsp20.wellsfargo.com>
Message-ID: <Pine.LNX.4.61.0506241502570.17458@gannet.stats>

You need to read the correct part of the manual (and you need a manual 
from R >= 2.1.0).  You are writing a front-end, so read

* Linking GUIs and other front-ends to R::

as Duncan suggested.  Your comments are not at all consistent with what 
I wrote there.

On Fri, 24 Jun 2005 Chad.P.Jenness at wellsfargo.com wrote:

> I have done this and it sounded like all that I needed to do is #include
> <R.h> to get access to R functionality.  However, I was getting
> compiling errors when attempting to make an R function call directly
> from C, so I did some research, and this is where I saw the reference to
> needing the libR.so.  By just including R.h, does this provide me with
> the same R functionality as the references that I saw about the libR.so?
> If so, then I will continue to use this to access the R functionality
> and use the "Writing R Extensions" manual.
>
> Thanks,
> Chad Jenness
> 763-229-0427
>
>
> -----Original Message-----
> From: Duncan Murdoch [mailto:murdoch at stats.uwo.ca]
> Sent: Friday, June 24, 2005 8:30 AM
> To: Chad.P.Jenness at wellsfargo.com
> Cc: r-devel at r-project.org
> Subject: Re: [Rd] Embedding R in C application
>
>
> On 6/24/2005 9:18 AM, Chad.P.Jenness at wellsfargo.com wrote:
>> To whom it may concern,
>> I am very interested in embedding the R functionality in our
>> application. This is a C application that currently runs on Win32, but
>> will also run on Linux in the future. From the material that I have
>> seen, I need R compiled as a shared library to evaluate R expressions
>> from C. Is this correct? If so, can I download this shared library
> from
>> somewhere? Is there any API document pertaining to this shared
> library?
>
> You want to look at the "Writing R Extensions" manual, in particular the
>
> chapters on the R API (for access to the underlying computational
> routines) and the one on linking GUIs or other front-ends (which sounds
> more like what you want to do).
>
> Duncan Murdoch
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From Chad.P.Jenness at wellsfargo.com  Fri Jun 24 16:10:21 2005
From: Chad.P.Jenness at wellsfargo.com (Chad.P.Jenness@wellsfargo.com)
Date: Fri, 24 Jun 2005 09:10:21 -0500
Subject: [Rd] Embedding R in C application
Message-ID: <B317A5F105ED5B4E88A279BC5DE28F3162855D@msgswbmnmsp20.wellsfargo.com>

I have read this section and it appears to be what I am looking for.

Thanks for all of your help,
Chad Jenness
763-229-0427


-----Original Message-----
From: Prof Brian Ripley [mailto:ripley at stats.ox.ac.uk] 
Sent: Friday, June 24, 2005 9:08 AM
To: Chad.P.Jenness at wellsfargo.com
Cc: murdoch at stats.uwo.ca; r-devel at r-project.org
Subject: Re: [Rd] Embedding R in C application


You need to read the correct part of the manual (and you need a manual 
from R >= 2.1.0).  You are writing a front-end, so read

* Linking GUIs and other front-ends to R::

as Duncan suggested.  Your comments are not at all consistent with what 
I wrote there.

On Fri, 24 Jun 2005 Chad.P.Jenness at wellsfargo.com wrote:

> I have done this and it sounded like all that I needed to do is 
> #include <R.h> to get access to R functionality.  However, I was 
> getting compiling errors when attempting to make an R function call 
> directly from C, so I did some research, and this is where I saw the 
> reference to needing the libR.so.  By just including R.h, does this 
> provide me with the same R functionality as the references that I saw 
> about the libR.so? If so, then I will continue to use this to access 
> the R functionality and use the "Writing R Extensions" manual.
>
> Thanks,
> Chad Jenness
> 763-229-0427
>
>
> -----Original Message-----
> From: Duncan Murdoch [mailto:murdoch at stats.uwo.ca]
> Sent: Friday, June 24, 2005 8:30 AM
> To: Chad.P.Jenness at wellsfargo.com
> Cc: r-devel at r-project.org
> Subject: Re: [Rd] Embedding R in C application
>
>
> On 6/24/2005 9:18 AM, Chad.P.Jenness at wellsfargo.com wrote:
>> To whom it may concern,
>> I am very interested in embedding the R functionality in our 
>> application. This is a C application that currently runs on Win32, 
>> but will also run on Linux in the future. From the material that I 
>> have seen, I need R compiled as a shared library to evaluate R 
>> expressions from C. Is this correct? If so, can I download this 
>> shared library
> from
>> somewhere? Is there any API document pertaining to this shared
> library?
>
> You want to look at the "Writing R Extensions" manual, in particular 
> the
>
> chapters on the R API (for access to the underlying computational
> routines) and the one on linking GUIs or other front-ends (which 
> sounds more like what you want to do).
>
> Duncan Murdoch
>
> ______________________________________________
> R-devel at r-project.org mailing list 
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From ben.bob at gmail.com  Fri Jun 24 17:32:45 2005
From: ben.bob at gmail.com (Bo Peng)
Date: Fri, 24 Jun 2005 10:32:45 -0500
Subject: [Rd] efficiency of sample() with prob.
In-Reply-To: <Pine.LNX.4.61.0506240707500.25757@gannet.stats>
References: <C698D707214E6F4AB39AB7096C3DE5A5AB5031@phost015.EVAFUNDS.intermedia.net>
	<6ea7b54305062211146473e7bf@mail.gmail.com>
	<Pine.LNX.4.61.0506222005080.3592@gannet.stats>
	<6ea7b54305062314375200f7d9@mail.gmail.com>
	<Pine.LNX.4.61.0506240707500.25757@gannet.stats>
Message-ID: <6ea7b54305062408323ad52224@mail.gmail.com>

On 6/24/05, Prof Brian Ripley <ripley at stats.ox.ac.uk> wrote:
> `Research' involves looking at all the competitor methods, devising a
> near-optimal strategy and selecting amongst methods according to that
> strategy.  It is not a quick fix we are looking for but something that
> will be good for the long term.
> 

I am sorry but I am afraid that I do not have enough time and
background knowledge
to do a thorough research in this area. I have tried bisection search
method and the alias
method, the latter has greatly improved the performance of my bioinformatics
application. Since this method is the only one mentioned in Knuth's
book, I have no
idea about other alternatives. 

Attached is a slightly improved version of the alias method. It may be
helpful to people
having similar problems.

Thanks.

--
Bo Peng
Department of Statistics
Rice University.
http://bp6.stat.rice.edu:8080/

/* replace probSampleReplace in src/main/random.c */
static void ProbSampleReplace(int n, double *p, int *perm, int nans, int *ans)
{
    /* allocate memory for a, p, H and L is the second half of a  */
    double * q = Calloc(n, double);
    int * a = Calloc(2*n, int);
    int * LL = a+n, * HH = a+2*n-1;  /* start of H and L vector */
    int * L = LL, * H = HH;          /* end of H and L vector */
    int i, j, k;
    double rU;  /* U[0,1)*n */

    /* set up alias table */
    /* initialize q with n*p0,...n*p_n-1 */
    for(i=0; i<n; ++i)
        q[i] = p[i]*n;

    /* initialize a with indices */
    for(i=0; i<n; ++i)
        a[i] = i;

    /* set up H and L */
    for(i=0; i<n; ++i) {
        if( q[i] >= 1.)
            *H-- = i;
        else
            *L++ = i;
    }

    while( L != LL && H != HH ) {
        j = *(L-1);
        k = *(H+1);
        a[j] = k;
        q[k] += q[j] - 1;
        L--;                                  /* remove j from L */
        if( q[k] < 1. ) {
            *L++ = k;                         /* add k to L */
            ++H;                              /* remove k */
        }
    }

    /* generate sample */
    for (i = 0; i < nans; ++i) {
	rU = unif_rand() * n;

        k = (int)(rU);
        rU -= k;  /* rU becomes rU-[rU] */

        if( rU < q[k] )
            ans[i] = k+1;
        else
            ans[i] = a[k]+1;
    }
    Free(a);
    Free(q); 
}


From maechler at stat.math.ethz.ch  Fri Jun 24 19:02:58 2005
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Fri, 24 Jun 2005 19:02:58 +0200
Subject: [Rd] efficiency of sample() with prob.
In-Reply-To: <6ea7b54305062408323ad52224@mail.gmail.com>
References: <C698D707214E6F4AB39AB7096C3DE5A5AB5031@phost015.EVAFUNDS.intermedia.net>
	<6ea7b54305062211146473e7bf@mail.gmail.com>
	<Pine.LNX.4.61.0506222005080.3592@gannet.stats>
	<6ea7b54305062314375200f7d9@mail.gmail.com>
	<Pine.LNX.4.61.0506240707500.25757@gannet.stats>
	<6ea7b54305062408323ad52224@mail.gmail.com>
Message-ID: <17084.15554.712118.607154@stat.math.ethz.ch>

>>>>> "Bo" == Bo Peng <ben.bob at gmail.com>
>>>>>     on Fri, 24 Jun 2005 10:32:45 -0500 writes:

    Bo> On 6/24/05, Prof Brian Ripley <ripley at stats.ox.ac.uk> wrote:
    >> `Research' involves looking at all the competitor methods, devising a
    >> near-optimal strategy and selecting amongst methods according to that
    >> strategy.  It is not a quick fix we are looking for but something that
    >> will be good for the long term.

    Bo> I am sorry but I am afraid that I do not have enough time and
    Bo> background knowledge
    Bo> to do a thorough research in this area.

which I think is well understandable.

    Bo> I have tried bisection search method and the alias
    Bo> method, the latter has greatly improved the performance
    Bo> of my bioinformatics application. Since this method is
    Bo> the only one mentioned in Knuth's book, I have no idea
    Bo> about other alternatives.

I think you've also explored the space of possible inputs a bit
and have suggested that the alias method was "uniformly" better
than the current one, i.e. always better, sometimes only
slightly but sometimes considerably (and never worse).  
If this (uniform improvement) can be ``proven'' in some way,
{and that maybe a considerable "if", I haven't started to go in there}
and because the algorithm is relatively simple {i.e., there's
not much code added to the current one},
I'd think that we (R-core) should incorporate the algorithm for
the time being, until someone has time for the ``real research''
and provide even better algorithm(s).
I don't see why the phrase 
   "the good is the enemy of the better" should apply in this
situation.  

Martin Maechler, ETH Zurich


    Bo> Attached is a slightly improved version of the alias method.

(deleted for this reply).

    Bo> It may be helpful to people having similar problems.

    Bo> Thanks.


    Bo> --
    Bo> Bo Peng
    Bo> Department of Statistics
    Bo> Rice University.
    Bo> http://bp6.stat.rice.edu:8080/


From jfox at mcmaster.ca  Sun Jun 26 16:00:35 2005
From: jfox at mcmaster.ca (John Fox)
Date: Sun, 26 Jun 2005 10:00:35 -0400
Subject: [Rd] Factor correlations in factanal
Message-ID: <20050626140032.LFKN1799.tomts40-srv.bellnexxia.net@JohnDesktop8300>

Dear R-devel list members,

Ben Fairbank draw it to my attention that factanal() (in the stats package)
doesn't report factor correlations for oblique rotations. Looking at the
source, I see that factanal also doesn't save the factor-transformation
(rotation) matrix from which these correlations can be computed. I've
modified the source, attached below, so that the transformation matrix is
saved if its available; as well, I've modified print.factanal() to print the
factor-correlations for oblique solutions.

Regards,
 John

------------ snip------------

# modifications by J. Fox, 26 June 2005 marked in source

## Hmm, MM thinks diag(.) needs checking { diag(vec) when length(vec)==1 !}
## However, MM does not understand that factor analysis
##   is a *multi*variate technique!
factanal <-
    function (x, factors, data = NULL, covmat = NULL, n.obs = NA,
              subset, na.action, start = NULL,
              scores = c("none", "regression", "Bartlett"),
              rotation = "varimax",
              control = NULL, ...)
{
    sortLoadings <- function(Lambda)
    {
        cn <- colnames(Lambda)
        Phi <- attr(Lambda, "covariance")
        ssq <- apply(Lambda, 2, function(x) -sum(x^2))
        Lambda <- Lambda[, order(ssq), drop = FALSE]
        colnames(Lambda) <- cn
        neg <- colSums(Lambda) < 0
        Lambda[, neg] <- -Lambda[, neg]
        if(!is.null(Phi)) {
            unit <- ifelse(neg, -1, 1)
            attr(Lambda, "covariance") <-
                unit %*% Phi[order(ssq), order(ssq)] %*% unit
        }
        Lambda
    }
    cl <- match.call()
    na.act <- NULL
    if (is.list(covmat)) {
        if (any(is.na(match(c("cov", "n.obs"), names(covmat)))))
            stop("'covmat' is not a valid covariance list")
        cv <- covmat$cov
        n.obs <- covmat$n.obs
        have.x <- FALSE
    }
    else if (is.matrix(covmat)) {
        cv <- covmat
        have.x <- FALSE
    }
    else if (is.null(covmat)) {
        if(missing(x)) stop("neither 'x' nor 'covmat' supplied")
        have.x <- TRUE
        if(inherits(x, "formula")) {
            ## this is not a `standard' model-fitting function,
            ## so no need to consider contrasts or levels
            mt <- terms(x, data = data)
            if(attr(mt, "response") > 0)
                stop("response not allowed in formula")
            attr(mt, "intercept") <- 0
            mf <- match.call(expand.dots = FALSE)
            names(mf)[names(mf) == "x"] <- "formula"
            mf$factors <- mf$covmat <- mf$scores <- mf$start <-
                mf$rotation <- mf$control <- mf$... <- NULL
            mf[[1]] <- as.name("model.frame")
            mf <- eval.parent(mf)
            na.act <- attr(mf, "na.action")
            if(any(sapply(mf, function(x) is.factor(x) || !is.numeric(x))))
                stop("factor analysis applies only to numerical variables")
            z <- model.matrix(mt, mf)
        } else {
            z <- as.matrix(x)
            if(!is.numeric(z))
                stop("factor analysis applies only to numerical variables")
            if(!missing(subset)) z <- z[subset, , drop = FALSE]
        }
        covmat <- cov.wt(z)
        cv <- covmat$cov
        n.obs <- covmat$n.obs
    }
    else stop("'covmat' is of unknown type")
    scores <- match.arg(scores)
    if(scores != "none" && !have.x)
        stop("requested scores without an 'x' matrix")
    p <- ncol(cv)
    if(p < 3) stop("factor analysis requires at least three variables")
    dof <- 0.5 * ((p - factors)^2 - p - factors)
    if(dof < 0)
        stop(gettextf("%d factors is too many for %d variables", factors,
p),
             domain = NA)
    sds <- sqrt(diag(cv))
    cv <- cv/(sds %o% sds)

    cn <- list(nstart = 1, trace = FALSE, lower = 0.005)
    cn[names(control)] <- control
    more <- list(...)[c("nstart", "trace", "lower", "opt", "rotate")]
    if(length(more)) cn[names(more)] <- more

    if(is.null(start)) {
        start <- (1 - 0.5*factors/p)/diag(solve(cv))
        if((ns <- cn$nstart) > 1)
            start <- cbind(start, matrix(runif(ns-1), p, ns-1, byrow=TRUE))
    }
    start <- as.matrix(start)
    if(nrow(start) != p)
        stop(gettextf("'start' must have %d rows", p), domain = NA)
    nc <- ncol(start)
    if(nc < 1) stop("no starting values supplied")

    best <- Inf
    for (i in 1:nc) {
        nfit <- factanal.fit.mle(cv, factors, start[, i],
                                 max(cn$lower, 0), cn$opt)
        if(cn$trace)
            cat("start", i, "value:", format(nfit$criteria[1]),
                "uniqs:", format(as.vector(round(nfit$uniquenesses, 4))),
"\n")
        if(nfit$converged && nfit$criteria[1] < best) {
            fit <- nfit
            best <- fit$criteria[1]
        }
    }
    if(best == Inf) stop("unable to optimize from these starting value(s)")
    load <- fit$loadings
    if(rotation != "none") {
        rot <- do.call(rotation, c(list(load), cn$rotate))
        # the following lines modified by J. Fox, 26 June 2005
        if (is.list(rot)){
            load <- rot$loadings
            fit$rotmat <- rot$rotmat
        }
        else load <- rot
        # end modifications J. Fox, 26 June 2005
    }
    fit$loadings <- sortLoadings(load)
    class(fit$loadings) <- "loadings"
    fit$na.action <- na.act # not used currently
    if(have.x && scores != "none") {
        Lambda <- fit$loadings
        zz <- scale(z, TRUE, TRUE)
        switch(scores,
               regression = {
                   sc <- zz %*% solve(cv, Lambda)
                   if(!is.null(Phi <- attr(Lambda, "covariance")))
                       sc <- sc %*% Phi
               },
               Bartlett = {
                   d <- 1/fit$uniquenesses
                   tmp <- t(Lambda * d)
                   sc <- t(solve(tmp %*% Lambda, tmp %*% t(zz)))
               })
        rownames(sc) <- rownames(z)
        colnames(sc) <- colnames(Lambda)
        if(!is.null(na.act)) sc <- napredict(na.act, sc)
        fit$scores <- sc
    }
    if(!is.na(n.obs) && dof > 0) {
        fit$STATISTIC <- (n.obs - 1 - (2 * p + 5)/6 -
                     (2 * factors)/3) * fit$criteria["objective"]
        fit$PVAL <- pchisq(fit$STATISTIC, dof, lower.tail = FALSE)
    }
    fit$n.obs <- n.obs
    fit$call <- cl
    fit
}

factanal.fit.mle <-
    function(cmat, factors, start=NULL, lower = 0.005, control = NULL, ...)
{
    FAout <- function(Psi, S, q)
    {
        sc <- diag(1/sqrt(Psi))
        Sstar <- sc %*% S %*% sc
        E <- eigen(Sstar, symmetric = TRUE)
        L <- E$vectors[, 1:q, drop = FALSE]
        load <- L %*% diag(sqrt(pmax(E$values[1:q] - 1, 0)), q)
        diag(sqrt(Psi)) %*% load
    }
    FAfn <- function(Psi, S, q)
    {
        sc <- diag(1/sqrt(Psi))
        Sstar <- sc %*% S %*% sc
        E <- eigen(Sstar, symmetric = TRUE, only.values = TRUE)
        e <- E$values[-(1:q)]
        e <- sum(log(e) - e) - q + nrow(S)
##        print(round(c(Psi, -e), 5))  # for tracing
        -e
    }
    FAgr <- function(Psi, S, q)
    {
        sc <- diag(1/sqrt(Psi))
        Sstar <- sc %*% S %*% sc
        E <- eigen(Sstar, symmetric = TRUE)
        L <- E$vectors[, 1:q, drop = FALSE]
        load <- L %*% diag(sqrt(pmax(E$values[1:q] - 1, 0)), q)
        load <- diag(sqrt(Psi)) %*% load
        g <- load %*% t(load) + diag(Psi) - S
        diag(g)/Psi^2
    }
    p <- ncol(cmat)
    if(is.null(start))
        start <- (1 - 0.5*factors/p)/diag(solve(cmat))
    res <- optim(start, FAfn, FAgr, method = "L-BFGS-B",
                 lower = lower, upper = 1,
                 control = c(list(fnscale=1,
                 parscale = rep(0.01, length(start))), control),
                 q = factors, S = cmat)
    Lambda <- FAout(res$par, cmat, factors)
    dimnames(Lambda) <- list(dimnames(cmat)[[1]],
                             paste("Factor", 1:factors, sep = ""))
    p <- ncol(cmat)
    dof <- 0.5 * ((p - factors)^2 - p - factors)
    un <- res$par
    names(un) <- colnames(cmat)
    class(Lambda) <- "loadings"
    ans <- list(converged = res$convergence == 0,
                loadings = Lambda, uniquenesses = un,
                correlation = cmat,
                criteria = c(objective = res$value, counts = res$counts),
                factors = factors, dof = dof, method = "mle")
    class(ans) <- "factanal"
    ans
}

print.loadings <- function(x, digits = 3, cutoff = 0.1, sort = FALSE, ...)
{
    Lambda <- unclass(x)
    p <- nrow(Lambda)
    factors <- ncol(Lambda)
    if (sort) {
        mx <- max.col(abs(Lambda))
        ind <- cbind(1:p, mx)
        mx[abs(Lambda[ind]) < 0.5] <- factors + 1
        Lambda <- Lambda[order(mx, 1:p),]
    }
    cat("\nLoadings:\n")
    fx <- format(round(Lambda, digits))
    names(fx) <- NULL
    nc <- nchar(fx[1], type="c")
    fx[abs(Lambda) < cutoff] <- paste(rep(" ", nc), collapse = "")
    print(fx, quote = FALSE, ...)
    vx <- colSums(x^2)
    varex <- rbind("SS loadings" = vx)
    if(is.null(attr(x, "covariance"))) {
        varex <- rbind(varex, "Proportion Var" = vx/p)
        if(factors > 1)
            varex <- rbind(varex, "Cumulative Var" = cumsum(vx/p))
    }
    cat("\n")
    print(round(varex, digits))
    invisible(x)
}

print.factanal <- function(x, digits = 3, ...)
{
    cat("\nCall:\n", deparse(x$call), "\n\n", sep = "")
    cat("Uniquenesses:\n")
    print(round(x$uniquenesses, digits), ...)
    print(x$loadings, digits = digits, ...)
    # the following lines added by J. Fox, 26 June 2005
    if (!is.null(x$rotmat)){
        tmat <- solve(x$rotmat)
        R <- tmat %*% t(tmat)
        factors <- x$factors
        rownames(R) <- colnames(R) <- paste("Factor", 1:factors, sep="")

        if (TRUE != all.equal(R, diag(factors))){
            cat("\nFactor Correlations:\n")
            print(R, digits=digits, ...)
        }
    }
    # end additions J. Fox, 23 June 2005
    if(!is.null(x$STATISTIC)) {
        factors <- x$factors
        cat("\nTest of the hypothesis that", factors, if(factors == 1)
            "factor is" else "factors are", "sufficient.\n")
        cat("The chi square statistic is", round(x$STATISTIC, 2), "on",
x$dof,
            if(x$dof == 1) "degree" else "degrees",
            "of freedom.\nThe p-value is", signif(x$PVAL, 3), "\n")
    } else {
        cat(paste("\nThe degrees of freedom for the model is",
                  x$dof, "and the fit was", round(x$criteria["objective"],
4),
                  "\n"))
    }
    invisible(x)
}

varimax <- function(x, normalize = TRUE, eps = 1e-5)
{
    nc <- ncol(x)
    if(nc < 2) return(x)
    if(normalize) {
        sc <- sqrt(drop(apply(x, 1, function(x) sum(x^2))))
        x <- x/sc
    }
    p <- nrow(x)
    TT <- diag(nc)
    d <- 0
    for(i in 1:1000) {
        z <- x %*% TT
        B  <- t(x) %*% (z^3 - z %*% diag(drop(rep(1, p) %*% z^2))/p)
        sB <- La.svd(B)
        TT <- sB$u %*% sB$vt
        dpast <- d
        d <- sum(sB$d)
        if(d < dpast * (1 + eps)) break
    }
    z <- x %*% TT
    if(normalize) z <- z * sc
    dimnames(z) <- dimnames(x)
    class(z) <- "loadings"
    list(loadings = z, rotmat = TT)
}

promax <- function(x, m = 4)
{
    if(ncol(x) < 2) return(x)
    dn <- dimnames(x)
    xx <- varimax(x)
    x <- xx$loadings
    Q <- x * abs(x)^(m-1)
    U <- lm.fit(x, Q)$coefficients
    d <- diag(solve(t(U) %*% U))
    U <- U %*% diag(sqrt(d))
    dimnames(U) <- NULL
    z <- x %*% U
    U <- xx$rotmat %*% U
    dimnames(z) <- dn
    class(z) <- "loadings"
    list(loadings = z, rotmat = U)
}


From rafalku at gmail.com  Sun Jun 26 19:52:20 2005
From: rafalku at gmail.com (rafalku@gmail.com)
Date: Sun, 26 Jun 2005 19:52:20 +0200 (CEST)
Subject: [Rd] Objects and regex (PR#7970)
Message-ID: <20050626175220.61398A20A@slim.kubism.ku.dk>

Full_Name: Rafal Kustra
Version: 2.1.0
OS: Linux
Submission from: (NULL) (64.229.198.89)


objects(pattern="^genes?$") returns "generateSigma" among other legal things.


From murdoch at stats.uwo.ca  Sun Jun 26 20:15:16 2005
From: murdoch at stats.uwo.ca (murdoch@stats.uwo.ca)
Date: Sun, 26 Jun 2005 20:15:16 +0200 (CEST)
Subject: [Rd] Objects and regex (PR#7970)
Message-ID: <20050626181516.1A246A20A@slim.kubism.ku.dk>

rafalku at gmail.com wrote:
> Full_Name: Rafal Kustra
> Version: 2.1.0
> OS: Linux
> Submission from: (NULL) (64.229.198.89)
> 
> 
> objects(pattern="^genes?$") returns "generateSigma" among other legal things.

Not for me in Windows. (And 2.1.0 isn't the current release any more...)

Duncan Murdoch


From p.dalgaard at biostat.ku.dk  Sun Jun 26 20:21:58 2005
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: 26 Jun 2005 20:21:58 +0200
Subject: [Rd] Objects and regex (PR#7970)
In-Reply-To: <20050626175220.61398A20A@slim.kubism.ku.dk>
References: <20050626175220.61398A20A@slim.kubism.ku.dk>
Message-ID: <x2d5q9ugft.fsf@turmalin.kubism.ku.dk>

rafalku at gmail.com writes:

> Full_Name: Rafal Kustra
> Version: 2.1.0
> OS: Linux
> Submission from: (NULL) (64.229.198.89)
> 
> 
> objects(pattern="^genes?$") returns "generateSigma" among other legal things.

Not on my 2.1.1:

> generateSigma <-1
> objects(pattern="^genes?$")
character(0)
> objects(pattern="^genes?")
[1] "generateSigma"

So. on what system did this happen?

-- 
   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
 (*) \(*) -- University of Copenhagen   Denmark          Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)                  FAX: (+45) 35327907


From mike.rstat at gmail.com  Sun Jun 26 22:56:12 2005
From: mike.rstat at gmail.com (Mike R)
Date: Sun, 26 Jun 2005 13:56:12 -0700
Subject: [Rd] a hack regarding "No documentation ...."
Message-ID: <27db823f050626135671a2b3ba@mail.gmail.com>

> ?somecharacters
No documentation for 'somecharacters' in specified packages and libraries:
you could try 'help.search("somecharacters")'
> 

I'm looking for some advice.  I'd like to hack my source code 
in such a way that the empty prompt line above is "pre-filled" 
with the suggested command.  In effect, this would make it 
unnecessary to copy-paste (or type)  
help.search("somecharacters")

If I did not want to execute the suggested command, I would 
Ctrl-c the pre-filled line.

Alternatively, the hack could implement a query, as in:

> ?somecharacters
No documentation for 'somecharacters' in specified packages and libraries:
you could try:
0 - help.search("somecharacters")
1 - RSiteSearch("somecharacters")
2 -  apropos(somecharacters)
3 - etc .....
<enter> - no action

.... in which case, typing 0, 1, 2, 3, ... and <enter> would issue 
the corresponding command,  or would pre-fill a command line 
with the corresponding command (which could then be edited).

Alternatively, the hack could add the recommended commands to 
the command history, in which case I could use the up/down 
arrows to navigate to them.

I suppose it might be the case that a similar feature is already 
part of R, and that I am just not aware of it.  As a newbie, I spend
most of my time searching/reading documentation.  

Any comments regarding the possible alternatives that I've 
mentioned, or offers of your own alternatives, would be 
appreciated, as would be suggestions or mini-outlines for 
implementing the hack.

TIA,
Mike


From mike.rstat at gmail.com  Sun Jun 26 23:04:22 2005
From: mike.rstat at gmail.com (Mike R)
Date: Sun, 26 Jun 2005 14:04:22 -0700
Subject: [Rd] a hack regarding "No documentation ...."
In-Reply-To: <27db823f050626135671a2b3ba@mail.gmail.com>
References: <27db823f050626135671a2b3ba@mail.gmail.com>
Message-ID: <27db823f0506261404627e9540@mail.gmail.com>

> > ?somecharacters
> No documentation for 'somecharacters' in specified packages and libraries:
> you could try 'help.search("somecharacters")'
> >
> 
> I'm looking for some advice.  I'd like to hack my source code
> in such a way that the empty prompt line above is "pre-filled"
> with the suggested command.  In effect, this would make it
> unnecessary to copy-paste (or type)
> help.search("somecharacters")
> 
> If I did not want to execute the suggested command, I would
> Ctrl-c the pre-filled line.
> 
> Alternatively, the hack could implement a query, as in:
> 
> > ?somecharacters
> No documentation for 'somecharacters' in specified packages and libraries:
> you could try:
> 0 - help.search("somecharacters")
> 1 - RSiteSearch("somecharacters")
> 2 -  apropos(somecharacters)
> 3 - etc .....
> <enter> - no action
> 
> .... in which case, typing 0, 1, 2, 3, ... and <enter> would issue
> the corresponding command,  or would pre-fill a command line
> with the corresponding command (which could then be edited).
> 
> Alternatively, the hack could add the recommended commands to
> the command history, in which case I could use the up/down
> arrows to navigate to them.
> 
> I suppose it might be the case that a similar feature is already
> part of R, and that I am just not aware of it.  As a newbie, I spend
> most of my time searching/reading documentation.
> 
> Any comments regarding the possible alternatives that I've
> mentioned, or offers of your own alternatives, would be
> appreciated, as would be suggestions or mini-outlines for
> implementing the hack.
> 
> TIA,
> Mike


sorry, forgot to mention my platform:
         _                
platform i686-pc-linux-gnu
arch     i686             
os       linux-gnu        
system   i686, linux-gnu  
status                    
major    2                
minor    1.0              
year     2005             
month    04               
day      18               
language R


From ggrothendieck at gmail.com  Sun Jun 26 23:15:37 2005
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Sun, 26 Jun 2005 17:15:37 -0400
Subject: [Rd] a hack regarding "No documentation ...."
In-Reply-To: <27db823f050626135671a2b3ba@mail.gmail.com>
References: <27db823f050626135671a2b3ba@mail.gmail.com>
Message-ID: <971536df05062614152ebd7bcd@mail.gmail.com>

On 6/26/05, Mike R <mike.rstat at gmail.com> wrote:
> > ?somecharacters
> No documentation for 'somecharacters' in specified packages and libraries:
> you could try 'help.search("somecharacters")'
> >
> 
> I'm looking for some advice.  I'd like to hack my source code
> in such a way that the empty prompt line above is "pre-filled"
> with the suggested command.  In effect, this would make it
> unnecessary to copy-paste (or type)
> help.search("somecharacters")
> 
> If I did not want to execute the suggested command, I would
> Ctrl-c the pre-filled line.
> 
> Alternatively, the hack could implement a query, as in:
> 
> > ?somecharacters
> No documentation for 'somecharacters' in specified packages and libraries:
> you could try:
> 0 - help.search("somecharacters")
> 1 - RSiteSearch("somecharacters")
> 2 -  apropos(somecharacters)
> 3 - etc .....
> <enter> - no action
> 
> .... in which case, typing 0, 1, 2, 3, ... and <enter> would issue
> the corresponding command,  or would pre-fill a command line
> with the corresponding command (which could then be edited).
> 
> Alternatively, the hack could add the recommended commands to
> the command history, in which case I could use the up/down
> arrows to navigate to them.
> 
> I suppose it might be the case that a similar feature is already
> part of R, and that I am just not aware of it.  As a newbie, I spend
> most of my time searching/reading documentation.
> 
> Any comments regarding the possible alternatives that I've
> mentioned, or offers of your own alternatives, would be
> appreciated, as would be suggestions or mini-outlines for
> implementing the hack.
> 

Redefine ?, e.g.

"?" <- function(e1) cat("You entered", substitute(e1), "\n")
?abc

To see the definition of ? that comes with R:
  rm("?")  # remove definition we just made above
  get("?") # look at the definition of function ?


From f.harrell at vanderbilt.edu  Sun Jun 26 23:49:31 2005
From: f.harrell at vanderbilt.edu (Frank E Harrell Jr)
Date: Sun, 26 Jun 2005 16:49:31 -0500
Subject: [Rd] Possible bug in summary of residuals with lm and weights
Message-ID: <42BF22EB.60809@vanderbilt.edu>

I'm not sure if this is intentional.  summary.lm stores weighted 
residuals whereas I think most users will want print.summary.lm to 
summarize unweighted ones as if saying summary(resid(fit)).

 > set.seed(1)
 > dat <- data.frame(y = rnorm(15), x = rnorm(15), w = 1:15)
 > f <- lm(y ~ x, weights = w, data = dat)
 > summary(f)
. . . .
Residuals:
    Min     1Q Median     3Q    Max
-8.260 -1.565  0.117  2.105  4.666
. . . .
 > resid(f)

           1           2           3           4           5           6
-0.73429677  0.06818092 -1.20558034  1.25783256  0.05231879 -1.18383039
           7           8           9          10          11          12
  0.16034166  0.59880438  0.98337588 -0.58944957  1.40690588  0.31138819
          13          14          15
-0.35111933 -2.20770335  0.89438636

 > version
platform i386-pc-linux-gnu
arch     i386
os       linux-gnu
system   i386, linux-gnu
status
major    2
minor    1.0
year     2005
month    04
day      18
language R

-- 
Frank E Harrell Jr   Professor and Chair           School of Medicine
                      Department of Biostatistics   Vanderbilt University


From h.wickham at gmail.com  Mon Jun 27 03:17:33 2005
From: h.wickham at gmail.com (hadley wickham)
Date: Sun, 26 Jun 2005 20:17:33 -0500
Subject: [Rd] R mailing list archive: alternative interface
Message-ID: <f8e6ff05050626181739cabfba@mail.gmail.com>

For a programming competition (http://railsday.com) I recently
entered, I created a web-application to nicely display mail archives. 
I've loaded up a couple of months worth of r-devel mail and made it
available here: http://listomagic.had.co.nz/

The big advantages over the currrent mailman archive are:

 * messages are threaded, and messages in a thread are displayed
together, and some effort is made to reduce redundant quoting

 * built in search

 * rss feeds for author, thread and search

I'd very interested to know if you think this useful and if it'd be
worthwhile to keep in sync with the list.  Any comments regarding
appearance, functionality etc would also be gratefully recieved.

Thanks,

Hadley


From zhuangjc at ism.ac.jp  Mon Jun 27 04:24:23 2005
From: zhuangjc at ism.ac.jp (zhuangjc@ism.ac.jp)
Date: Mon, 27 Jun 2005 04:24:23 +0200 (CEST)
Subject: [Rd] Cannot choose language for installing (PR#7971)
Message-ID: <20050627022423.29630A1F3@slim.kubism.ku.dk>

Full_Name: Jiancang Zhuang
Version: R 2.1.1
OS: windows xp
Submission from: (NULL) (133.58.102.66)


I tried to install R.2.1.1 into my windows xp system. The system is Japanese
version. But I set the unicode fonts to be Chinese to for some important
programme. No matter how I choose the language during the installation, I always
get an R of Japanese version.


From Tim.Keighley at csiro.au  Mon Jun 27 06:25:03 2005
From: Tim.Keighley at csiro.au (Tim.Keighley@csiro.au)
Date: Mon, 27 Jun 2005 14:25:03 +1000
Subject: [Rd] Unused argument "na.action" to pairs.formula
Message-ID: <1D69C8DFA9233040B1E6CB0D3475196239A2B2@exnswn1-syd.nexus.csiro.au>

Hi,

I believe that the argument "na.action" is not used in the function
pairs.formula (graphics). I am using R 2.1.1 for Windows, downloaded
from CRAN.

This is the body of the function as it is now:

function (formula, data = NULL, ..., subset, na.action = stats::na.pass)

{
    m <- match.call(expand.dots = FALSE)
    if (is.matrix(eval(m$data, parent.frame()))) 
        m$data <- as.data.frame(data)
    m$... <- NULL
    m$na.action <- stats::na.pass
    m[[1]] <- as.name("model.frame")
    mf <- eval(m, parent.frame())
    pairs(mf, ...)
}

I think the line "m$na.action <- stats::na.pass" should be "m$na.action
<- na.action". Please correct me if I am wrong or this has already been
fixed.

Cheers,
Tim Keighley


From ligges at statistik.uni-dortmund.de  Mon Jun 27 08:46:19 2005
From: ligges at statistik.uni-dortmund.de (ligges@statistik.uni-dortmund.de)
Date: Mon, 27 Jun 2005 08:46:19 +0200 (CEST)
Subject: [Rd] Cannot choose language for installing (PR#7971)
Message-ID: <20050627064619.29E33A274@slim.kubism.ku.dk>

zhuangjc at ism.ac.jp wrote:

> Full_Name: Jiancang Zhuang
> Version: R 2.1.1
> OS: windows xp
> Submission from: (NULL) (133.58.102.66)
> 
> 
> I tried to install R.2.1.1 into my windows xp system. The system is Japanese
> version. But I set the unicode fonts to be Chinese to for some important
> programme. No matter how I choose the language during the installation, I always
> get an R of Japanese version.


This is not a bug, AFAICS.
During installation you choose the language of the setup program, not R 
itself. To "get" a non-Japanese version of R, you can define, e.g., an 
environment variable
   LANGUAGE=en

Uwe Ligges


> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From ripley at stats.ox.ac.uk  Mon Jun 27 09:05:08 2005
From: ripley at stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Mon, 27 Jun 2005 09:05:08 +0200 (CEST)
Subject: [Rd] Cannot choose language for installing (PR#7971)
Message-ID: <20050627070508.88268A276@slim.kubism.ku.dk>

The language of the installer is completely unrelated to the language 
used to run R.

This is not a bug: to use R in Chinese, you need to select Chinese as 
the language to use: see the `R Installation and Administration manual'.
This should happen automatically if Windows is set to Simplified Chinese.

What do you actually want to do?  If you want to run R in English,, set
LANAGAGE=en.


On Mon, 27 Jun 2005 zhuangjc at ism.ac.jp wrote:

> Full_Name: Jiancang Zhuang
> Version: R 2.1.1
> OS: windows xp
> Submission from: (NULL) (133.58.102.66)
>
>
> I tried to install R.2.1.1 into my windows xp system. The system is 
> Japanese version. But I set the unicode fonts to be Chinese to for some 
> important programme. No matter how I choose the language during the 
> installation, I always get an R of Japanese version.


-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From ripley at stats.ox.ac.uk  Mon Jun 27 10:42:54 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Mon, 27 Jun 2005 09:42:54 +0100 (BST)
Subject: [Rd] Unused argument "na.action" to pairs.formula
In-Reply-To: <1D69C8DFA9233040B1E6CB0D3475196239A2B2@exnswn1-syd.nexus.csiro.au>
References: <1D69C8DFA9233040B1E6CB0D3475196239A2B2@exnswn1-syd.nexus.csiro.au>
Message-ID: <Pine.LNX.4.61.0506270934270.5029@gannet.stats>

You are correct: now fixed in R-patched and R-devel.

I have fixed this once before, so that fix must have got lost.

BTW, the sources have an explanatory comment you don't see by listing the 
function in R:  it is necessary to set m$na.action explicitly because
match.call only includes supplied arguments, not default ones.
So the lines now reads

     m$na.action <- na.action # force in even if  default


On Mon, 27 Jun 2005 Tim.Keighley at csiro.au wrote:

> Hi,
>
> I believe that the argument "na.action" is not used in the function
> pairs.formula (graphics). I am using R 2.1.1 for Windows, downloaded
> from CRAN.
>
> This is the body of the function as it is now:
>
> function (formula, data = NULL, ..., subset, na.action = stats::na.pass)
>
> {
>    m <- match.call(expand.dots = FALSE)
>    if (is.matrix(eval(m$data, parent.frame())))
>        m$data <- as.data.frame(data)
>    m$... <- NULL
>    m$na.action <- stats::na.pass
>    m[[1]] <- as.name("model.frame")
>    mf <- eval(m, parent.frame())
>    pairs(mf, ...)
> }
>
> I think the line "m$na.action <- stats::na.pass" should be "m$na.action
> <- na.action". Please correct me if I am wrong or this has already been
> fixed.

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From Gregor.Gorjanc at bfro.uni-lj.si  Mon Jun 27 16:06:02 2005
From: Gregor.Gorjanc at bfro.uni-lj.si (Gorjanc Gregor)
Date: Mon, 27 Jun 2005 16:06:02 +0200
Subject: [Rd] Wish/suggestion: Install packages on fly via library()
Message-ID: <7FFEE688B57D7346BC6241C55900E730F3188F@pollux.bfro.uni-lj.si>

Hello!

I thought that installation of missing packages on fly via library()
would be a nice thing to have. Something like this:

if (missing(pkg) && getOption("installOnFly")) {
  install.packages(pkg, ...)
}

I did look into library() function to find appropriate place for code
similar to on above but library() it's massively long and I really don't 
... you know.

Thanks for remarkable tool.

Lep pozdrav / With regards,
    Gregor Gorjanc

----------------------------------------------------------------------
University of Ljubljana
Biotechnical Faculty        URI: http://www.bfro.uni-lj.si/MR/ggorjan
Zootechnical Department     mail: gregor.gorjanc <at> bfro.uni-lj.si
Groblje 3                   tel: +386 (0)1 72 17 861
SI-1230 Domzale             fax: +386 (0)1 72 17 888
Slovenia, Europe
----------------------------------------------------------------------
"One must learn by doing the thing; for though you think you know it,
 you have no certainty until you try." Sophocles ~ 450 B.C.


From hb at maths.lth.se  Mon Jun 27 16:38:37 2005
From: hb at maths.lth.se (Henrik Bengtsson)
Date: Mon, 27 Jun 2005 16:38:37 +0200
Subject: [Rd] R v2.1.1 for Windows and "non-reproducible" crashes
Message-ID: <42C00F6D.3070109@maths.lth.se>

Hi,

R v2.1.1 patched (2005-05-26) for Windows crashes.  The sympotoms are 
like "memory leakage".  The patched version from two days ago crashes at 
a different position in R CMD check compared to todays version.

A "REPRODUCIBLE" EXAMPLE:
Unfortunately, I cannot create a minimal code example reproducing the 
crash, but here is at least a simple way to reproduce it:

1. Make sure you run R v2.1.1 patched
2. Start R
3. install.packages("R.oo", contriburl="http://www.maths.lth.se/help/R")
    [This is a version built with R v2.1.0, because I cannot make the 
package pass R CMD check on v2.1.1 because of the crashes]
4. Cut'n'paste the following example from ?Rdoc to the R prompt:
library(R.oo)
author <- "Henrik Bengtsson, \url{http://www.braju.com/R/}"
rdocFile <- system.file("misc", "Exception.R", package="R.oo")
file.show(rdocFile)
destPath <- tempdir()
Rdoc$compile(rdocFile, destPath=destPath)
rdFiles <- list.files(destPath, full.names=TRUE)
print(rdFiles)
file.show(rdFiles[1])
file.remove(rdFiles)

For me it crashes when it gets to the Rdoc$compile() line and Dr. Mingw 
reports:

Rterm.exe caused an Access Violation at location 7c911e58 in module 
ntdll.dll Reading from location 52474f52.

Registers:
eax=003efa18 ebx=003e0000 ecx=52474f52 edx=502f3a43 esi=003efa10 
edi=003efa48
eip=7c911e58 esp=00228c10 ebp=00228c1c iopl=0         nv up ei pl zr na 
po nc
cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000 
efl=00000246

Call stack:
7C911E58  ntdll.dll:7C911E58  RtlInitializeCriticalSection
7C910D5C  ntdll.dll:7C910D5C  wcsncpy
77C2C2DE  msvcrt.dll:77C2C2DE  free
1004BFB0  R.dll:1004BFB0  do_isseekable
1004C051  R.dll:1004C051  con_close
1004D33E  R.dll:1004D33E  do_close
100A8E41  R.dll:100A8E41  do_internal
1008494A  R.dll:1008494A  Rf_eval
10085595  R.dll:10085595  Rf_evalList
10084993  R.dll:10084993  Rf_eval
100875AB  R.dll:100875AB  Rf_applyClosure
100A9361  R.dll:100A9361  do_internal
100A99A5  R.dll:100A99A5  Rf_usemethod
100A9E1A  R.dll:100A9E1A  do_usemethod
1008494A  R.dll:1008494A  Rf_eval
100875AB  R.dll:100875AB  Rf_applyClosure
100846E0  R.dll:100846E0  Rf_eval
10051EE9  R.dll:10051EE9  Rf_endcontext
1008751F  R.dll:1008751F  Rf_applyClosure
100846E0  R.dll:100846E0  Rf_eval
10086305  R.dll:10086305  do_set
1008494A  R.dll:1008494A  Rf_eval
100863D5  R.dll:100863D5  do_begin
1008494A  R.dll:1008494A  Rf_eval
100875AB  R.dll:100875AB  Rf_applyClosure
100A9361  R.dll:100A9361  do_internal
100A99A5  R.dll:100A99A5  Rf_usemethod
100A9E1A  R.dll:100A9E1A  do_usemethod
1008494A  R.dll:1008494A  Rf_eval
100875AB  R.dll:100875AB  Rf_applyClosure
100846E0  R.dll:100846E0  Rf_eval
10086305  R.dll:10086305  do_set
1008494A  R.dll:1008494A  Rf_eval
100863D5  R.dll:100863D5  do_begin
1008494A  R.dll:1008494A  Rf_eval
10084671  R.dll:10084671  Rf_eval
1008487C  R.dll:1008487C  Rf_eval
10084671  R.dll:10084671  Rf_eval
1008487C  R.dll:1008487C  Rf_eval
10084671  R.dll:10084671  Rf_eval
1008487C  R.dll:1008487C  Rf_eval
100852A5  R.dll:100852A5  Rf_evalListKeepMissing
100853DD  R.dll:100853DD  do_return
1008494A  R.dll:1008494A  Rf_eval
10084671  R.dll:10084671  Rf_eval
1008487C  R.dll:1008487C  Rf_eval
100863D5  R.dll:100863D5  do_begin
1008494A  R.dll:1008494A  Rf_eval
100875AB  R.dll:100875AB  Rf_applyClosure
100846E0  R.dll:100846E0  Rf_eval
10086305  R.dll:10086305  do_set
1008494A  R.dll:1008494A  Rf_eval
100863D5  R.dll:100863D5  do_begin
1008494A  R.dll:1008494A  Rf_eval
100875AB  R.dll:100875AB  Rf_applyClosure
100846E0  R.dll:100846E0  Rf_eval
1008494A  R.dll:1008494A  Rf_eval
1008494A  R.dll:1008494A  Rf_eval
100863D5  R.dll:100863D5  do_begin
1008494A  R.dll:1008494A  Rf_eval
100875AB  R.dll:100875AB  Rf_applyClosure
100846E0  R.dll:100846E0  Rf_eval
100863D5  R.dll:100863D5  do_begin
1008494A  R.dll:1008494A  Rf_eval
100875AB  R.dll:100875AB  Rf_applyClosure
100846E0  R.dll:100846E0  Rf_eval
100863D5  R.dll:100863D5  do_begin
1008494A  R.dll:1008494A  Rf_eval
1008494A  R.dll:1008494A  Rf_eval
100863D5  R.dll:100863D5  do_begin
1008494A  R.dll:1008494A  Rf_eval
1008494A  R.dll:1008494A  Rf_eval
100863D5  R.dll:100863D5  do_begin
1008494A  R.dll:1008494A  Rf_eval
100875AB  R.dll:100875AB  Rf_applyClosure
100846E0  R.dll:100846E0  Rf_eval
100875AB  R.dll:100875AB  Rf_applyClosure
100846E0  R.dll:100846E0  Rf_eval
10086305  R.dll:10086305  do_set
1008494A  R.dll:1008494A  Rf_eval
100863D5  R.dll:100863D5  do_begin
1008494A  R.dll:1008494A  Rf_eval
1008494A  R.dll:1008494A  Rf_eval
100863D5  R.dll:100863D5  do_begin
1008494A  R.dll:1008494A  Rf_eval
10086A18  R.dll:10086A18  do_for
1008494A  R.dll:1008494A  Rf_eval
100863D5  R.dll:100863D5  do_begin
1008494A  R.dll:1008494A  Rf_eval
100875AB  R.dll:100875AB  Rf_applyClosure
100A9361  R.dll:100A9361  do_internal
100A99A5  R.dll:100A99A5  Rf_usemethod
100A9E1A  R.dll:100A9E1A  do_usemethod
1008494A  R.dll:1008494A  Rf_eval
100875AB  R.dll:100875AB  Rf_applyClosure
100846E0  R.dll:100846E0  Rf_eval
10086305  R.dll:10086305  do_set
1008494A  R.dll:1008494A  Rf_eval
100863D5  R.dll:100863D5  do_begin
1008494A  R.dll:1008494A  Rf_eval
100875AB  R.dll:100875AB  Rf_applyClosure
100846E0  R.dll:100846E0  Rf_eval
10084671  R.dll:10084671  Rf_eval
1008487C  R.dll:1008487C  Rf_eval
10085595  R.dll:10085595  Rf_evalList
100A8F0F  R.dll:100A8F0F  do_internal
1008494A  R.dll:1008494A  Rf_eval
100875AB  R.dll:100875AB  Rf_applyClosure
100846E0  R.dll:100846E0  Rf_eval
10085012  R.dll:10085012  do_eval
100A8E41  R.dll:100A8E41  do_internal
1008494A  R.dll:1008494A  Rf_eval
100875AB  R.dll:100875AB  Rf_applyClosure
100846E0  R.dll:100846E0  Rf_eval
100863D5  R.dll:100863D5  do_begin
1008494A  R.dll:1008494A  Rf_eval
1008494A  R.dll:1008494A  Rf_eval
100863D5  R.dll:100863D5  do_begin
1008494A  R.dll:1008494A  Rf_eval
1008494A  R.dll:1008494A  Rf_eval
100863D5  R.dll:100863D5  do_begin
1008494A  R.dll:1008494A  Rf_eval
100866A2  R.dll:100866A2  do_while
1008494A  R.dll:1008494A  Rf_eval
100863D5  R.dll:100863D5  do_begin
1008494A  R.dll:1008494A  Rf_eval
10086A18  R.dll:10086A18  do_for
1008494A  R.dll:1008494A  Rf_eval
100863D5  R.dll:100863D5  do_begin
1008494A  R.dll:1008494A  Rf_eval
100875AB  R.dll:100875AB  Rf_applyClosure
100846E0  R.dll:100846E0  Rf_eval
10086305  R.dll:10086305  do_set
1008494A  R.dll:1008494A  Rf_eval
100863D5  R.dll:100863D5  do_begin
1008494A  R.dll:1008494A  Rf_eval
10086A18  R.dll:10086A18  do_for
1008494A  R.dll:1008494A  Rf_eval
100863D5  R.dll:100863D5  do_begin
1008494A  R.dll:1008494A  Rf_eval
100875AB  R.dll:100875AB  Rf_applyClosure
100846E0  R.dll:100846E0  Rf_eval
100875AB  R.dll:100875AB  Rf_applyClosure
100846E0  R.dll:100846E0  Rf_eval
1009D5E6  R.dll:1009D5E6  Rf_ReplIteration
1009D717  R.dll:1009D717  Rf_ReplIteration
1009D997  R.dll:1009D997  run_Rmainloop
0040144C  Rterm.exe:0040144C
004012C5  Rterm.exe:004012C5
004016BA  Rterm.exe:004016BA
004011E7  Rterm.exe:004011E7
00401238  Rterm.exe:00401238
7C816D4F  kernel32.dll:7C816D4F  RegisterWaitForInputIdle

Sometimes it just give an error about an invalid regular expression; 
then rerun the line for it to crash, e.g.

 > Rdoc$compile(rdocFile, destPath=destPath)
Loading required package: tools
Error in regexpr(pattern, text, extended, fixed, useBytes) :
         invalid regular expression '^@classhierarchy'

Then redo the Rdoc$compile() line and R will crash.

Also, note that the regular expression pattern in the error report from 
regexpr() about "invalid regular expression '^@alias'" is valid, because 
trying it in R you get

 > regexpr("^@classhierarchy", "@classhierarchy")
[1] 1
attr(,"match.length")
[1] 15

I have also received messages about "invalid regular expression ''", but 
I am sure I do not use empty regular expressions anywhere.

I am pretty sure it is not the R.oo package itself, because nothing much 
has changed and the package has passed the R CMD check for many R 
versions including R v2.1.0 patched (2005-05-09). The crashed to not 
occur on the R v2.1.0 patched version.


Has anyone else noticed this?  Can you reproduce the above, or is it 
just my Windows installation? If I figure out more on this myself, I'll 
get back to you.

My system is Windows XP Pro English SP2 with

 > R.Version()
$platform
[1] "i386-pc-mingw32"

$arch
[1] "i386"

$os
[1] "mingw32"

$system
[1] "i386, mingw32"

$status
[1] "Patched"

$major
[1] "2"

$minor
[1] "1.1"

$year
[1] "2005"

$month
[1] "06"

$day
[1] "26"

$language
[1] "R"

Best

Henrik


From hb at maths.lth.se  Mon Jun 27 16:44:37 2005
From: hb at maths.lth.se (Henrik Bengtsson)
Date: Mon, 27 Jun 2005 16:44:37 +0200
Subject: [Rd] R v2.1.1 for Windows and "non-reproducible" crashes
In-Reply-To: <42C00F6D.3070109@maths.lth.se>
References: <42C00F6D.3070109@maths.lth.se>
Message-ID: <42C010D5.6090509@maths.lth.se>

Henrik Bengtsson wrote:
> Hi,
> 
> R v2.1.1 patched (2005-05-26) for Windows crashes.  The sympotoms are 
> like "memory leakage".  The patched version from two days ago crashes at 
> a different position in R CMD check compared to todays version.

Sorry for being unclear; the "R CMD check" refers to R CMD check for my 
R.oo package and is just an example.

> A "REPRODUCIBLE" EXAMPLE:
> Unfortunately, I cannot create a minimal code example reproducing the 
> crash, but here is at least a simple way to reproduce it:
> 
> 1. Make sure you run R v2.1.1 patched
> 2. Start R
> 3. install.packages("R.oo", contriburl="http://www.maths.lth.se/help/R")
>     [This is a version built with R v2.1.0, because I cannot make the 
> package pass R CMD check on v2.1.1 because of the crashes]
> 4. Cut'n'paste the following example from ?Rdoc to the R prompt:
> library(R.oo)
> author <- "Henrik Bengtsson, \url{http://www.braju.com/R/}"
> rdocFile <- system.file("misc", "Exception.R", package="R.oo")
> file.show(rdocFile)
> destPath <- tempdir()
> Rdoc$compile(rdocFile, destPath=destPath)
> rdFiles <- list.files(destPath, full.names=TRUE)
> print(rdFiles)
> file.show(rdFiles[1])
> file.remove(rdFiles)
> 
> For me it crashes when it gets to the Rdoc$compile() line and Dr. Mingw 
> reports:
> 
> Rterm.exe caused an Access Violation at location 7c911e58 in module 
> ntdll.dll Reading from location 52474f52.
> 
> Registers:
> eax=003efa18 ebx=003e0000 ecx=52474f52 edx=502f3a43 esi=003efa10 
> edi=003efa48
> eip=7c911e58 esp=00228c10 ebp=00228c1c iopl=0         nv up ei pl zr na 
> po nc
> cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000 
> efl=00000246
> 
> Call stack:
> 7C911E58  ntdll.dll:7C911E58  RtlInitializeCriticalSection
> 7C910D5C  ntdll.dll:7C910D5C  wcsncpy
> 77C2C2DE  msvcrt.dll:77C2C2DE  free
> 1004BFB0  R.dll:1004BFB0  do_isseekable
> 1004C051  R.dll:1004C051  con_close
> 1004D33E  R.dll:1004D33E  do_close
> 100A8E41  R.dll:100A8E41  do_internal
> 1008494A  R.dll:1008494A  Rf_eval
> 10085595  R.dll:10085595  Rf_evalList
> 10084993  R.dll:10084993  Rf_eval
> 100875AB  R.dll:100875AB  Rf_applyClosure
> 100A9361  R.dll:100A9361  do_internal
> 100A99A5  R.dll:100A99A5  Rf_usemethod
> 100A9E1A  R.dll:100A9E1A  do_usemethod
> 1008494A  R.dll:1008494A  Rf_eval
> 100875AB  R.dll:100875AB  Rf_applyClosure
> 100846E0  R.dll:100846E0  Rf_eval
> 10051EE9  R.dll:10051EE9  Rf_endcontext
> 1008751F  R.dll:1008751F  Rf_applyClosure
> 100846E0  R.dll:100846E0  Rf_eval
> 10086305  R.dll:10086305  do_set
> 1008494A  R.dll:1008494A  Rf_eval
> 100863D5  R.dll:100863D5  do_begin
> 1008494A  R.dll:1008494A  Rf_eval
> 100875AB  R.dll:100875AB  Rf_applyClosure
> 100A9361  R.dll:100A9361  do_internal
> 100A99A5  R.dll:100A99A5  Rf_usemethod
> 100A9E1A  R.dll:100A9E1A  do_usemethod
> 1008494A  R.dll:1008494A  Rf_eval
> 100875AB  R.dll:100875AB  Rf_applyClosure
> 100846E0  R.dll:100846E0  Rf_eval
> 10086305  R.dll:10086305  do_set
> 1008494A  R.dll:1008494A  Rf_eval
> 100863D5  R.dll:100863D5  do_begin
> 1008494A  R.dll:1008494A  Rf_eval
> 10084671  R.dll:10084671  Rf_eval
> 1008487C  R.dll:1008487C  Rf_eval
> 10084671  R.dll:10084671  Rf_eval
> 1008487C  R.dll:1008487C  Rf_eval
> 10084671  R.dll:10084671  Rf_eval
> 1008487C  R.dll:1008487C  Rf_eval
> 100852A5  R.dll:100852A5  Rf_evalListKeepMissing
> 100853DD  R.dll:100853DD  do_return
> 1008494A  R.dll:1008494A  Rf_eval
> 10084671  R.dll:10084671  Rf_eval
> 1008487C  R.dll:1008487C  Rf_eval
> 100863D5  R.dll:100863D5  do_begin
> 1008494A  R.dll:1008494A  Rf_eval
> 100875AB  R.dll:100875AB  Rf_applyClosure
> 100846E0  R.dll:100846E0  Rf_eval
> 10086305  R.dll:10086305  do_set
> 1008494A  R.dll:1008494A  Rf_eval
> 100863D5  R.dll:100863D5  do_begin
> 1008494A  R.dll:1008494A  Rf_eval
> 100875AB  R.dll:100875AB  Rf_applyClosure
> 100846E0  R.dll:100846E0  Rf_eval
> 1008494A  R.dll:1008494A  Rf_eval
> 1008494A  R.dll:1008494A  Rf_eval
> 100863D5  R.dll:100863D5  do_begin
> 1008494A  R.dll:1008494A  Rf_eval
> 100875AB  R.dll:100875AB  Rf_applyClosure
> 100846E0  R.dll:100846E0  Rf_eval
> 100863D5  R.dll:100863D5  do_begin
> 1008494A  R.dll:1008494A  Rf_eval
> 100875AB  R.dll:100875AB  Rf_applyClosure
> 100846E0  R.dll:100846E0  Rf_eval
> 100863D5  R.dll:100863D5  do_begin
> 1008494A  R.dll:1008494A  Rf_eval
> 1008494A  R.dll:1008494A  Rf_eval
> 100863D5  R.dll:100863D5  do_begin
> 1008494A  R.dll:1008494A  Rf_eval
> 1008494A  R.dll:1008494A  Rf_eval
> 100863D5  R.dll:100863D5  do_begin
> 1008494A  R.dll:1008494A  Rf_eval
> 100875AB  R.dll:100875AB  Rf_applyClosure
> 100846E0  R.dll:100846E0  Rf_eval
> 100875AB  R.dll:100875AB  Rf_applyClosure
> 100846E0  R.dll:100846E0  Rf_eval
> 10086305  R.dll:10086305  do_set
> 1008494A  R.dll:1008494A  Rf_eval
> 100863D5  R.dll:100863D5  do_begin
> 1008494A  R.dll:1008494A  Rf_eval
> 1008494A  R.dll:1008494A  Rf_eval
> 100863D5  R.dll:100863D5  do_begin
> 1008494A  R.dll:1008494A  Rf_eval
> 10086A18  R.dll:10086A18  do_for
> 1008494A  R.dll:1008494A  Rf_eval
> 100863D5  R.dll:100863D5  do_begin
> 1008494A  R.dll:1008494A  Rf_eval
> 100875AB  R.dll:100875AB  Rf_applyClosure
> 100A9361  R.dll:100A9361  do_internal
> 100A99A5  R.dll:100A99A5  Rf_usemethod
> 100A9E1A  R.dll:100A9E1A  do_usemethod
> 1008494A  R.dll:1008494A  Rf_eval
> 100875AB  R.dll:100875AB  Rf_applyClosure
> 100846E0  R.dll:100846E0  Rf_eval
> 10086305  R.dll:10086305  do_set
> 1008494A  R.dll:1008494A  Rf_eval
> 100863D5  R.dll:100863D5  do_begin
> 1008494A  R.dll:1008494A  Rf_eval
> 100875AB  R.dll:100875AB  Rf_applyClosure
> 100846E0  R.dll:100846E0  Rf_eval
> 10084671  R.dll:10084671  Rf_eval
> 1008487C  R.dll:1008487C  Rf_eval
> 10085595  R.dll:10085595  Rf_evalList
> 100A8F0F  R.dll:100A8F0F  do_internal
> 1008494A  R.dll:1008494A  Rf_eval
> 100875AB  R.dll:100875AB  Rf_applyClosure
> 100846E0  R.dll:100846E0  Rf_eval
> 10085012  R.dll:10085012  do_eval
> 100A8E41  R.dll:100A8E41  do_internal
> 1008494A  R.dll:1008494A  Rf_eval
> 100875AB  R.dll:100875AB  Rf_applyClosure
> 100846E0  R.dll:100846E0  Rf_eval
> 100863D5  R.dll:100863D5  do_begin
> 1008494A  R.dll:1008494A  Rf_eval
> 1008494A  R.dll:1008494A  Rf_eval
> 100863D5  R.dll:100863D5  do_begin
> 1008494A  R.dll:1008494A  Rf_eval
> 1008494A  R.dll:1008494A  Rf_eval
> 100863D5  R.dll:100863D5  do_begin
> 1008494A  R.dll:1008494A  Rf_eval
> 100866A2  R.dll:100866A2  do_while
> 1008494A  R.dll:1008494A  Rf_eval
> 100863D5  R.dll:100863D5  do_begin
> 1008494A  R.dll:1008494A  Rf_eval
> 10086A18  R.dll:10086A18  do_for
> 1008494A  R.dll:1008494A  Rf_eval
> 100863D5  R.dll:100863D5  do_begin
> 1008494A  R.dll:1008494A  Rf_eval
> 100875AB  R.dll:100875AB  Rf_applyClosure
> 100846E0  R.dll:100846E0  Rf_eval
> 10086305  R.dll:10086305  do_set
> 1008494A  R.dll:1008494A  Rf_eval
> 100863D5  R.dll:100863D5  do_begin
> 1008494A  R.dll:1008494A  Rf_eval
> 10086A18  R.dll:10086A18  do_for
> 1008494A  R.dll:1008494A  Rf_eval
> 100863D5  R.dll:100863D5  do_begin
> 1008494A  R.dll:1008494A  Rf_eval
> 100875AB  R.dll:100875AB  Rf_applyClosure
> 100846E0  R.dll:100846E0  Rf_eval
> 100875AB  R.dll:100875AB  Rf_applyClosure
> 100846E0  R.dll:100846E0  Rf_eval
> 1009D5E6  R.dll:1009D5E6  Rf_ReplIteration
> 1009D717  R.dll:1009D717  Rf_ReplIteration
> 1009D997  R.dll:1009D997  run_Rmainloop
> 0040144C  Rterm.exe:0040144C
> 004012C5  Rterm.exe:004012C5
> 004016BA  Rterm.exe:004016BA
> 004011E7  Rterm.exe:004011E7
> 00401238  Rterm.exe:00401238
> 7C816D4F  kernel32.dll:7C816D4F  RegisterWaitForInputIdle
> 
> Sometimes it just give an error about an invalid regular expression; 
> then rerun the line for it to crash, e.g.
> 
>  > Rdoc$compile(rdocFile, destPath=destPath)
> Loading required package: tools
> Error in regexpr(pattern, text, extended, fixed, useBytes) :
>          invalid regular expression '^@classhierarchy'
> 
> Then redo the Rdoc$compile() line and R will crash.
> 
> Also, note that the regular expression pattern in the error report from 
> regexpr() about "invalid regular expression '^@alias'" is valid, because 
> trying it in R you get
> 
>  > regexpr("^@classhierarchy", "@classhierarchy")
> [1] 1
> attr(,"match.length")
> [1] 15
> 
> I have also received messages about "invalid regular expression ''", but 
> I am sure I do not use empty regular expressions anywhere.
> 
> I am pretty sure it is not the R.oo package itself, because nothing much 
> has changed and the package has passed the R CMD check for many R 
> versions including R v2.1.0 patched (2005-05-09). The crashed to not 
> occur on the R v2.1.0 patched version.
> 
> 
> Has anyone else noticed this?  Can you reproduce the above, or is it 
> just my Windows installation? If I figure out more on this myself, I'll 
> get back to you.
> 
> My system is Windows XP Pro English SP2 with
> 
>  > R.Version()
> $platform
> [1] "i386-pc-mingw32"
> 
> $arch
> [1] "i386"
> 
> $os
> [1] "mingw32"
> 
> $system
> [1] "i386, mingw32"
> 
> $status
> [1] "Patched"
> 
> $major
> [1] "2"
> 
> $minor
> [1] "1.1"
> 
> $year
> [1] "2005"
> 
> $month
> [1] "06"
> 
> $day
> [1] "26"
> 
> $language
> [1] "R"
> 
> Best
> 
> Henrik
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
>


From efg at stowers-institute.org  Mon Jun 27 18:10:26 2005
From: efg at stowers-institute.org (Earl F. Glynn)
Date: Mon, 27 Jun 2005 11:10:26 -0500
Subject: [Rd] R mailing list archive: alternative interface
References: <f8e6ff05050626181739cabfba@mail.gmail.com>
Message-ID: <d9p80d$1nj$1@sea.gmane.org>

"hadley wickham" <h.wickham at gmail.com> wrote in message
news:f8e6ff05050626181739cabfba at mail.gmail.com...
> For a programming competition (http://railsday.com) I recently
> entered, I created a web-application to nicely display mail archives.
> I've loaded up a couple of months worth of r-devel mail and made it
> available here: http://listomagic.had.co.nz/

...

> I'd very interested to know if you think this useful and if it'd be
> worthwhile to keep in sync with the list.  Any comments regarding
> appearance, functionality etc would also be gratefully recieved.

For some time I've used a news reader to read the threaded R Devel postings

http://dir.gmane.org/gmane.comp.lang.r.devel



and the threaded R Help postings:

http://dir.gmane.org/gmane.comp.lang.r.general



Using a news reader works better for me than the frequent postings or the
unthreaded daily digest, so I'm not looking for an alternative interface for
now.



I only wish the Bioconductor E-mail somehow got on the gmane "newgroups"
too.



efg


From murdoch at stats.uwo.ca  Mon Jun 27 18:34:22 2005
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Mon, 27 Jun 2005 12:34:22 -0400
Subject: [Rd] R v2.1.1 for Windows and "non-reproducible" crashes
In-Reply-To: <42C010D5.6090509@maths.lth.se>
References: <42C00F6D.3070109@maths.lth.se> <42C010D5.6090509@maths.lth.se>
Message-ID: <42C02A8E.6070208@stats.uwo.ca>

On 6/27/2005 10:44 AM, Henrik Bengtsson wrote:
> Henrik Bengtsson wrote:
>> Hi,
>> 
>> R v2.1.1 patched (2005-05-26) for Windows crashes.  The sympotoms are 
>> like "memory leakage".  The patched version from two days ago crashes at 
>> a different position in R CMD check compared to todays version.
> 
> Sorry for being unclear; the "R CMD check" refers to R CMD check for my 
> R.oo package and is just an example.
> 
>> A "REPRODUCIBLE" EXAMPLE:
>> Unfortunately, I cannot create a minimal code example reproducing the 
>> crash, but here is at least a simple way to reproduce it:
>> 
>> 1. Make sure you run R v2.1.1 patched
>> 2. Start R
>> 3. install.packages("R.oo", contriburl="http://www.maths.lth.se/help/R")
>>     [This is a version built with R v2.1.0, because I cannot make the 
>> package pass R CMD check on v2.1.1 because of the crashes]
>> 4. Cut'n'paste the following example from ?Rdoc to the R prompt:
>> library(R.oo)
>> author <- "Henrik Bengtsson, \url{http://www.braju.com/R/}"
>> rdocFile <- system.file("misc", "Exception.R", package="R.oo")
>> file.show(rdocFile)
>> destPath <- tempdir()
>> Rdoc$compile(rdocFile, destPath=destPath)
>> rdFiles <- list.files(destPath, full.names=TRUE)
>> print(rdFiles)
>> file.show(rdFiles[1])
>> file.remove(rdFiles)
>> 
>> For me it crashes when it gets to the Rdoc$compile() line and Dr. Mingw 
>> reports:
>> 
>> Rterm.exe caused an Access Violation at location 7c911e58 in module 
>> ntdll.dll Reading from location 52474f52.

I get a crash there too.  I'll take a look.

Duncan Murdoch


From krc at odin.mdacc.tmc.edu  Mon Jun 27 21:55:37 2005
From: krc at odin.mdacc.tmc.edu (krc@odin.mdacc.tmc.edu)
Date: Mon, 27 Jun 2005 21:55:37 +0200 (CEST)
Subject: [Rd] row-side color bars do not reverse properly in heatmap
	(PR#7972)
Message-ID: <20050627195537.4E1AFA290@slim.kubism.ku.dk>

Full_Name: Kevin R. Coombes
Version: 2.1.0
OS: Windows XP
Submission from: (NULL) (143.111.224.169)


When revC = TRUE and RowSideColors is set to a list of colors in heatmap, then
the image and dendrogram are inverted, but the row-side color map does not
change. The following script illustrates the problem.

##############
set.seed(1023)
# generate columns of two different types
d1 <- matrix(rnorm(100*6, rnorm(100, 0.5)), nrow=100, ncol=6, byrow=FALSE)
d2 <- matrix(rnorm(100*4, rnorm(100, 0.5)), nrow=100, ncol=4, byrow=FALSE)
# join them together
dd <- cbind(d1, d2)
# label them with different colors
cols <- rep(c('blue', 'green'), times=c(6,4))

# change the order of the columns and the matching labels
# to show that reordering occurs in one case in heatmap
col.order <- sample(10)
dd <- dd[, col.order]
cols <- cols[col.order]

# compute the dendrogram to be used in the display
hc <- hclust(dist(dd, 'euclid'))

# get the correlation matrix
m <- cor(dd)

# this version works correctly
heatmap(m, Rowv=as.dendrogram(hc), symm=TRUE, revC=FALSE,
        RowSideColors=cols)
#this version reverses the dendrogram and image, but not the colors
heatmap(m, Rowv=as.dendrogram(hc), symm=TRUE, revC=TRUE,
        RowSideColors=cols)


From sfalcon at fhcrc.org  Mon Jun 27 23:02:09 2005
From: sfalcon at fhcrc.org (Seth Falcon)
Date: Mon, 27 Jun 2005 14:02:09 -0700
Subject: [Rd] R mailing list archive: alternative interface
In-Reply-To: <d9p80d$1nj$1@sea.gmane.org> (Earl F. Glynn's message of "Mon, 27
	Jun 2005 11:10:26 -0500")
References: <f8e6ff05050626181739cabfba@mail.gmail.com>
	<d9p80d$1nj$1@sea.gmane.org>
Message-ID: <m2vf3z1pke.fsf@macaroni.local>

On 27 Jun 2005, efg at stowers-institute.org wrote:
> I only wish the Bioconductor E-mail somehow got on the gmane
> "newgroups" too.

I think we can do something about that :-)

+ seth


From efg at stowers-institute.org  Tue Jun 28 00:33:58 2005
From: efg at stowers-institute.org (Earl F. Glynn)
Date: Mon, 27 Jun 2005 17:33:58 -0500
Subject: [Rd] R mailing list archive: alternative interface
References: <f8e6ff05050626181739cabfba@mail.gmail.com><d9p80d$1nj$1@sea.gmane.org>
	<m2vf3z1pke.fsf@macaroni.local>
Message-ID: <d9pufd$5mn$1@sea.gmane.org>

"Seth Falcon" <sfalcon at fhcrc.org> wrote in message
news:m2vf3z1pke.fsf at macaroni.local...
> On 27 Jun 2005, efg at stowers-institute.org wrote:
> > I only wish the Bioconductor E-mail somehow got on the gmane
> > "newgroups" too.

After my post I discovered the Bioconductor mailing list can be read as
gmane newsgroups, too.  Just don't look for "Bioconductor".

The general Bioconductor list is:
gmane.science.biology.informatics.conductor
http://dir.gmane.org/gmane.science.biology.informatics.conductor

efg


From edd at debian.org  Tue Jun 28 02:23:12 2005
From: edd at debian.org (Dirk Eddelbuettel)
Date: Mon, 27 Jun 2005 19:23:12 -0500
Subject: [Rd] R mailing list archive: alternative interface
In-Reply-To: <d9pufd$5mn$1@sea.gmane.org>
References: <f8e6ff05050626181739cabfba@mail.gmail.com>
	<d9p80d$1nj$1@sea.gmane.org> <m2vf3z1pke.fsf@macaroni.local>
	<d9pufd$5mn$1@sea.gmane.org>
Message-ID: <17088.39024.339418.54041@basebud.nulle.part>


On 27 June 2005 at 17:33, Earl F. Glynn wrote:
| "Seth Falcon" <sfalcon at fhcrc.org> wrote in message
| news:m2vf3z1pke.fsf at macaroni.local...
| > On 27 Jun 2005, efg at stowers-institute.org wrote:
| > > I only wish the Bioconductor E-mail somehow got on the gmane
| > > "newgroups" too.
| 
| After my post I discovered the Bioconductor mailing list can be read as
| gmane newsgroups, too.  Just don't look for "Bioconductor".
| 
| The general Bioconductor list is:
| gmane.science.biology.informatics.conductor
| http://dir.gmane.org/gmane.science.biology.informatics.conductor

Interesting.  As I found out, Gmane is capable of alias'ing -- a user had
registered a list I admin unbeknownst to me, and under a a suboptimal
name. The Gmane folks simply added another identifier for the list so that it
can now be seen under both names.

So you could write an email to them explaining the situation and maybe
suggestion a good second name for the list so that it can one day be found
under BioConductor too.

Regards, Dirk

-- 
Statistics: The (futile) attempt to offer certainty about uncertainty.
         -- Roger Koenker, 'Dictionary of Received Ideas of Statistics'


From mwtoews at sfu.ca  Tue Jun 28 02:55:58 2005
From: mwtoews at sfu.ca (mwtoews@sfu.ca)
Date: Tue, 28 Jun 2005 02:55:58 +0200 (CEST)
Subject: [Rd] axTicks on a reverse ylog plot (PR#7973)
Message-ID: <20050628005558.25EE2A27A@slim.kubism.ku.dk>

There is still issues with the reversed y-log scale plot:

# Test case A: works as expected
plot(10:100,log="y",ylim=c(100,11))
grid()
par("yaxp")

# Test case B: grid does not have horizontal lines; par("yaxp") is  
different
plot(1:100,log="y",ylim=c(100,10))
grid()
par("yaxp")

In the second test case, axTicks for the horizontal lines (in grid())  
returns numeric(0) for spacing ... how do the tick marks get drawn in  
the first place??
-mt

--please do not edit the information below--

Version:
platform = powerpc-apple-darwin8.1.0
arch = powerpc
os = darwin8.1.0
system = powerpc, darwin8.1.0
status = Patched
major = 2
minor = 1.1
year = 2005
month = 06
day = 26
language = R

Locale:
en_CA.UTF-8/en_CA.UTF-8/en_CA.UTF-8/C/en_CA.UTF-8/en_CA.UTF-8

Search Path:
.GlobalEnv, package:methods, package:stats, package:graphics,  
package:grDevices, package:utils, package:datasets, Autoloads,  
package:base


From jbremson at neyman.ucdavis.edu  Tue Jun 28 03:37:25 2005
From: jbremson at neyman.ucdavis.edu (jbremson@neyman.ucdavis.edu)
Date: Tue, 28 Jun 2005 03:37:25 +0200 (CEST)
Subject: [Rd] symbol.For problem? (PR#7974)
Message-ID: <20050628013725.1ED45A27A@slim.kubism.ku.dk>



It seems as though 'symbol.For' does not work correctly.

> library("foo")
> add(3,4)
[1] 7
> sym.add(3,5)

Error in .Fortran(symbol.For("add"), as.numeric(a), as.numeric(b), c = as.numeric(0)) :
        "Fortran" function name not in load table

The function 'add' is a R wrapper to a simple fortran 77 subroutine that adds two numbers.
In 'add' the .Fortran call looks like this:
	.Fortran("add",...)

In 'sym.add' the .Fortran call looks like this:
	.Fortran(symbol.For("add"),...)

symbol.For works correctly if there is an underscore in the name though.

I have tested this on OSX and linux and get the same results.

I have a test package written up if anyone wants it. Email me
at jbremson at wald.ucdavis.edu.




--please do not edit the information below--

Version:
 platform = i686-pc-linux-gnu
 arch = i686
 os = linux-gnu
 system = i686, linux-gnu
 status = 
 major = 2
 minor = 1.0
 year = 2005
 month = 04
 day = 18
 language = R

Search Path:
 .GlobalEnv, package:foo, package:methods, package:stats, package:graphics, package:grDevices, package:utils, package:datasets, Autoloads, package:base


From murdoch at stats.uwo.ca  Tue Jun 28 04:08:34 2005
From: murdoch at stats.uwo.ca (murdoch@stats.uwo.ca)
Date: Tue, 28 Jun 2005 04:08:34 +0200 (CEST)
Subject: [Rd] symbol.For problem? (PR#7974)
Message-ID: <20050628020834.49D31A2AE@slim.kubism.ku.dk>

jbremson at neyman.ucdavis.edu wrote:
> 
> It seems as though 'symbol.For' does not work correctly.

>>library("foo")
>>add(3,4)
> 
> [1] 7
> 
>>sym.add(3,5)
> 
> 
> Error in .Fortran(symbol.For("add"), as.numeric(a), as.numeric(b), c = as.numeric(0)) :
>         "Fortran" function name not in load table

I don't see why you think this should have worked. symbol.For shows you 
how the name would be translated between the function name and the name 
that .Fortran looks for in the load table.  It looks like you're asking 
for the translation to be done twice.

Is this documented somewhere as something that should work?

Duncan Murdoch
> 
> The function 'add' is a R wrapper to a simple fortran 77 subroutine that adds two numbers.
> In 'add' the .Fortran call looks like this:
> 	.Fortran("add",...)
> 
> In 'sym.add' the .Fortran call looks like this:
> 	.Fortran(symbol.For("add"),...)
> 
> symbol.For works correctly if there is an underscore in the name though.
> 
> I have tested this on OSX and linux and get the same results.
> 
> I have a test package written up if anyone wants it. Email me
> at jbremson at wald.ucdavis.edu.
> 
> 
> 
> 
> --please do not edit the information below--
> 
> Version:
>  platform = i686-pc-linux-gnu
>  arch = i686
>  os = linux-gnu
>  system = i686, linux-gnu
>  status = 
>  major = 2
>  minor = 1.0
>  year = 2005
>  month = 04
>  day = 18
>  language = R
> 
> Search Path:
>  .GlobalEnv, package:foo, package:methods, package:stats, package:graphics, package:grDevices, package:utils, package:datasets, Autoloads, package:base
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From matthias.wahl at macnews.de  Tue Jun 28 06:23:28 2005
From: matthias.wahl at macnews.de (matthias.wahl@macnews.de)
Date: Tue, 28 Jun 2005 06:23:28 +0200 (CEST)
Subject: [Rd] Does not run under Mac OS X 10.3.9 (PR#7975)
Message-ID: <20050628042328.25BCEA263@slim.kubism.ku.dk>

Full_Name: Matthias Wahl
Version: 2.0.1 and 2.1.0a
OS: Mac OS X 10.3.9
Submission from: (NULL) (84.159.39.159)


Version 2.1.0a does get installed, R is available under applications,
however when trying to start R I get an error message that R is terminated
due to an error and that's it. Re-installing didn't help at all.

Then I tried Version 2.0.1. and there I don't even get an icon to start R.


From ripley at stats.ox.ac.uk  Tue Jun 28 08:25:53 2005
From: ripley at stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Tue, 28 Jun 2005 08:25:53 +0200 (CEST)
Subject: [Rd] symbol.For problem? (PR#7974)
Message-ID: <20050628062553.509A2A290@slim.kubism.ku.dk>

You are not using symbol.For correctly.  Both .Fortran and symbol.For
append an underscore if one is needed:

> symbol.For("add")
[1] "add_"

so you are looking for "add__" which will not be in the function table.

The help file says

      Functions 'symbol.C' and 'symbol.For' map function or subroutine
      names to the symbol name in the compiled code.  These are no
      longer of much use in R.

      'is.loaded' checks if the symbol name is loaded and hence
      available for use in '.C' or '.Fortran': nowadays it needs the
      name you would give to '.C' or '.Fortran' and *not* that remapped
      by 'symbol.C' and 'symbol.For'.

On Tue, 28 Jun 2005 jbremson at neyman.ucdavis.edu wrote:

> It seems as though 'symbol.For' does not work correctly.

Please read the section on BUGS in the FAQ and do not file bug reports on 
things about which you are not _certain_, as it asks.

>
>> library("foo")
>> add(3,4)
> [1] 7
>> sym.add(3,5)
>
> Error in .Fortran(symbol.For("add"), as.numeric(a), as.numeric(b), c = as.numeric(0)) :
>        "Fortran" function name not in load table
>
> The function 'add' is a R wrapper to a simple fortran 77 subroutine that adds two numbers.
> In 'add' the .Fortran call looks like this:
> 	.Fortran("add",...)
>
> In 'sym.add' the .Fortran call looks like this:
> 	.Fortran(symbol.For("add"),...)
>
> symbol.For works correctly if there is an underscore in the name though.
>
> I have tested this on OSX and linux and get the same results.
>
> I have a test package written up if anyone wants it. Email me
> at jbremson at wald.ucdavis.edu.
>
>
>
>
> --please do not edit the information below--
>
> Version:
> platform = i686-pc-linux-gnu
> arch = i686
> os = linux-gnu
> system = i686, linux-gnu
> status =
> major = 2
> minor = 1.0
> year = 2005
> month = 04
> day = 18
> language = R
>
> Search Path:
> .GlobalEnv, package:foo, package:methods, package:stats, package:graphics, package:grDevices, package:utils, package:datasets, Autoloads, package:base
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From mwtoews at sfu.ca  Tue Jun 28 09:40:40 2005
From: mwtoews at sfu.ca (mwtoews@sfu.ca)
Date: Tue, 28 Jun 2005 09:40:40 +0200 (CEST)
Subject: [Rd] boxplot by factor (Package base version 2.1.1) (PR#7976)
Message-ID: <20050628074040.B8522A1F5@slim.kubism.ku.dk>

I consider this to be an old bug, which also persists in Splus 7. It  
is unnecessary, and annoying.

## Section 1: Consider a simple data frame with three possible  
factors (in levels)

d <- data.frame(a=sort(rnorm(10)*10), b=factor(c(rep("A",4), rep("C", 
6)), levels=c("A","B","C")))
tapply(d$a, d$b, mean) # returns three results, which I would expect
plot(a ~ b, d) # plots only two of three objects, ignoring that there  
was "C" in the second position

# if I tried to plot a blank in between the two boxplots:
plot(a ~ b, d, at=1:3) # nope: error
plot(a ~ b, d, at=c(1,3)) # nope: out of range (also xlim does  
nothing for the formula boxplot method)

# to make this work with the current R/Splus implementation, I have  
to add a zero:
d <- rbind(d, data.frame(a=0,b="B")) # which I don't want to do,  
since there are no "B"
plot(a ~ b, d) # yuk!

## Section 2: Why is this important? Consider another realistic  
example of [synthetic] daily temperature

temp <- 5 - 10*cos(1:365*2*pi/365) + rnorm(365)*3
d1 <- data.frame(year=2005, jday=1:365, date=NA, month=NA, temp) #  
jday is Julian day [1,365]
d1$date <- as.Date(paste(d1$year, d1$jday), "%Y %j")
d1$month <- factor(months(d1$date,TRUE), levels=month.abb)
plot(temp ~ month, d1) # perfect, in a perfect meteorological world

d2 <- d1[!d1$month %in% c("Mar","Apr","May","Sep"),] # now let's  
remove some data
tapply(d2$temp,d2$month,mean)  # perfect
plot(temp ~ month, d2) # ugly, not 12 months, etc. (despite having 12  
levels)

# again the only cure is to add zeros to the missing months  
(unnecessary forgery of data)
d3 <- d2
for (i in c("Mar","Apr","May","Sep")) {
     d3 <- rbind(d3,NA)
     d3$month[nrow(d3)] <- i
     d3$temp[nrow(d3)] <- 0
}
plot(temp ~ month, d3) # still ugly, but at least has 12 months!

## Section 3: Solution
The obvious solution is to leave a blank where a boxplot should go,  
similar to tapply. This would have 1:n positions, where n is the  
number of levels of the factor, not the number of factors that have  
one or more numbers.  The position should also have a label under the  
tick mark.
I don't see any reason why the missing data should be completely  
ignored. Users wishing to not plot the blanks where the data could go  
can simply type (for back-compatibility):

d2$month <- factor(d2$month) # from 12 to 8 levels

Which will produce the same 8-factor plot as above.

## Section 4: Conclusion
I consider this to be a bug in regards to data representation, and  
this function is not consistant with other functions like `tapply'.   
Considering that the back-compatibility solution is very simple, and  
most users would probably prefer a result including all levels (NULL  
or real values in each), I feel this an appropriate improvement (and  
easy to fix in the code). At the very least, include an option to  
honour the factor levels.

Thanks.
-mt

--please do not edit the information below--

Version:
platform = powerpc-apple-darwin8.1.0
arch = powerpc
os = darwin8.1.0
system = powerpc, darwin8.1.0
status = Patched
major = 2
minor = 1.1
year = 2005
month = 06
day = 26
language = R

Locale:
en_CA.UTF-8/en_CA.UTF-8/en_CA.UTF-8/C/en_CA.UTF-8/en_CA.UTF-8

Search Path:
.GlobalEnv, package:methods, package:stats, package:graphics,  
package:grDevices, package:utils, package:datasets, Autoloads,  
package:base


From hb at maths.lth.se  Tue Jun 28 11:09:43 2005
From: hb at maths.lth.se (Henrik Bengtsson)
Date: Tue, 28 Jun 2005 11:09:43 +0200
Subject: [Rd] capabilities() and non-catchable messages
In-Reply-To: <Pine.LNX.4.61.0506211242080.7675@gannet.stats>
References: <42B697EE.7040004@maths.lth.se>
	<Pine.LNX.4.61.0506211242080.7675@gannet.stats>
Message-ID: <42C113D7.5040200@maths.lth.se>

Prof Brian Ripley wrote:
> Do you have DISPLAY set pointing to an X11 server you do not have 
> access to?  It seems so.  The solution is to set your X11 settings 
> properly.
> 
> This is coming from Xlib (XOpenDisplay, I believe) and so is not an R 
> error or warning, and is not output on an R connection but on a  C file.

Another clear answer/hint!  The sysadms of the host system just got back 
to me and said that they set the DISPLAY on purpose in order to generate 
bitmap graphics in R using X11.  The thing was that during the few days 
when I was testing my plugin, the X11 server was unreachable due to DNS 
problems after a power failure. There is always a simple answer ;)

Thanks

Henrik

> On Mon, 20 Jun 2005, Henrik Bengtsson wrote:
> 
> 
>>Just for the record (not a request for fix) and an ad hoc workaround if
>>anyone needs it:
>>
>>REASON:
>>Running an R script as a plugin on a remote Suse Linux 8.2 with R v2.1.0
>>(2005-04-18), I have noticed that capabilities() generates (to standard
>>error)
>>
>>  Xlib: connection to "base:0.0" refused by server
>>  Xlib: Client is not authorized to connect to Server
>>
>>which cannot be caught by tryCatch();
>>
>>  tryCatch({
>>    print(capabilities());
>>  }, condition=function(c) {
>>    cat("Condition caught:\n");
>>    str(c);
>>  })
>>
>>because it is not a 'condition' (error or warning).
>>
>>CONTEXT:
>>Since source() calls capabilities("iconv") this messages always show up.
>>My R plugin loads custom code using source() and since the standard
>>error from the plugin is checked for messages, the host system
>>interprets this as if something problematic has occured.
>>
>>WORKAROUND:
>>The workaround that I use now is to redefine capabilities() temporarily
>>(since I do not need "iconv" support):
>>
>> orgCapabilities <- base::capabilities;
>> basePos <- which(search() == "package:base"));
>> assign("capabilities", function(...) FALSE, pos=basePos);
>>
>> source(<my file>)
>>
>> basePos <- which(search() == "package:base"));
>> assign("capabilities", orgCapabilities, pos=basePos);
>> rm(orgCapabilities)
>>
>>Cheers
>>
>>Henrik
>>
>>______________________________________________
>>R-devel at r-project.org mailing list
>>https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>>
> 
>


From Chad.P.Jenness at wellsfargo.com  Tue Jun 28 14:34:59 2005
From: Chad.P.Jenness at wellsfargo.com (Chad.P.Jenness@wellsfargo.com)
Date: Tue, 28 Jun 2005 07:34:59 -0500
Subject: [Rd] Error in compiling R
Message-ID: <B317A5F105ED5B4E88A279BC5DE28F3162856B@msgswbmnmsp20.wellsfargo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
Url: https://stat.ethz.ch/pipermail/r-devel/attachments/20050628/01381e93/attachment.pl

From andy_liaw at merck.com  Tue Jun 28 14:37:56 2005
From: andy_liaw at merck.com (Liaw, Andy)
Date: Tue, 28 Jun 2005 08:37:56 -0400
Subject: [Rd] boxplot by factor (Package base version 2.1.1) ( PR#7976)
Message-ID: <39B6DDB9048D0F4DAD42CB26AAFF0AFA64EA20@usctmx1106.Merck.com>

The issue is not with boxplot, but with split.  boxplot.formula() 
calls boxplot(split(split(mf[[response]], mf[-response]), ...), 
but look at what split() returns when there are empty levels in
the factor:

> f <- factor(gl(3, 6), levels=1:5)
> y <- rnorm(f)
> split(y, f)
$"1"
[1] 0.4832124 1.1924811 0.3657797 1.7400198 0.5577356 0.9889520

$"2"
[1] -1.1296642 -0.4808355 -0.2789933  0.1220718  0.1287742 -0.7573801

$"3"
[1]  1.2320902  0.5090700 -1.5508074  2.1373780  1.1681297 -0.7151561

The "culprit" is the following in split.default():

    f <- factor(f)

which drops empty levels in f, if there are any.  BTW, ?split doesn't
mention what it does in such situation.  Perhaps it should?

If this is to be "fixed", I suppose an additional argument, e.g.,
drop=TRUE, can be added, and the corresponding line mentioned
above changed to something like:

    if (drop || !is.factor(f)) f <- factor(f)

Then this additional argument can be pass on from boxplot.formula() to 
split().

Just my $0.02...

Andy

> From: mwtoews at sfu.ca
> 
> I consider this to be an old bug, which also persists in Splus 7. It  
> is unnecessary, and annoying.
> 
> ## Section 1: Consider a simple data frame with three possible  
> factors (in levels)
> 
> d <- data.frame(a=sort(rnorm(10)*10), b=factor(c(rep("A",4), rep("C", 
> 6)), levels=c("A","B","C")))
> tapply(d$a, d$b, mean) # returns three results, which I would expect
> plot(a ~ b, d) # plots only two of three objects, ignoring 
> that there  
> was "C" in the second position
> 
> # if I tried to plot a blank in between the two boxplots:
> plot(a ~ b, d, at=1:3) # nope: error
> plot(a ~ b, d, at=c(1,3)) # nope: out of range (also xlim does  
> nothing for the formula boxplot method)
> 
> # to make this work with the current R/Splus implementation, I have  
> to add a zero:
> d <- rbind(d, data.frame(a=0,b="B")) # which I don't want to do,  
> since there are no "B"
> plot(a ~ b, d) # yuk!
> 
> ## Section 2: Why is this important? Consider another realistic  
> example of [synthetic] daily temperature
> 
> temp <- 5 - 10*cos(1:365*2*pi/365) + rnorm(365)*3
> d1 <- data.frame(year=2005, jday=1:365, date=NA, month=NA, temp) #  
> jday is Julian day [1,365]
> d1$date <- as.Date(paste(d1$year, d1$jday), "%Y %j")
> d1$month <- factor(months(d1$date,TRUE), levels=month.abb)
> plot(temp ~ month, d1) # perfect, in a perfect meteorological world
> 
> d2 <- d1[!d1$month %in% c("Mar","Apr","May","Sep"),] # now let's  
> remove some data
> tapply(d2$temp,d2$month,mean)  # perfect
> plot(temp ~ month, d2) # ugly, not 12 months, etc. (despite 
> having 12  
> levels)
> 
> # again the only cure is to add zeros to the missing months  
> (unnecessary forgery of data)
> d3 <- d2
> for (i in c("Mar","Apr","May","Sep")) {
>      d3 <- rbind(d3,NA)
>      d3$month[nrow(d3)] <- i
>      d3$temp[nrow(d3)] <- 0
> }
> plot(temp ~ month, d3) # still ugly, but at least has 12 months!
> 
> ## Section 3: Solution
> The obvious solution is to leave a blank where a boxplot should go,  
> similar to tapply. This would have 1:n positions, where n is the  
> number of levels of the factor, not the number of factors that have  
> one or more numbers.  The position should also have a label 
> under the  
> tick mark.
> I don't see any reason why the missing data should be completely  
> ignored. Users wishing to not plot the blanks where the data 
> could go  
> can simply type (for back-compatibility):
> 
> d2$month <- factor(d2$month) # from 12 to 8 levels
> 
> Which will produce the same 8-factor plot as above.
> 
> ## Section 4: Conclusion
> I consider this to be a bug in regards to data representation, and  
> this function is not consistant with other functions like `tapply'.   
> Considering that the back-compatibility solution is very simple, and  
> most users would probably prefer a result including all levels (NULL  
> or real values in each), I feel this an appropriate improvement (and  
> easy to fix in the code). At the very least, include an option to  
> honour the factor levels.
> 
> Thanks.
> -mt
> 
> --please do not edit the information below--
> 
> Version:
> platform = powerpc-apple-darwin8.1.0
> arch = powerpc
> os = darwin8.1.0
> system = powerpc, darwin8.1.0
> status = Patched
> major = 2
> minor = 1.1
> year = 2005
> month = 06
> day = 26
> language = R
> 
> Locale:
> en_CA.UTF-8/en_CA.UTF-8/en_CA.UTF-8/C/en_CA.UTF-8/en_CA.UTF-8
> 
> Search Path:
> .GlobalEnv, package:methods, package:stats, package:graphics,  
> package:grDevices, package:utils, package:datasets, Autoloads,  
> package:base
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> 
>


From ripley at stats.ox.ac.uk  Tue Jun 28 14:46:48 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue, 28 Jun 2005 13:46:48 +0100 (BST)
Subject: [Rd] Error in compiling R
In-Reply-To: <B317A5F105ED5B4E88A279BC5DE28F3162856B@msgswbmnmsp20.wellsfargo.com>
References: <B317A5F105ED5B4E88A279BC5DE28F3162856B@msgswbmnmsp20.wellsfargo.com>
Message-ID: <Pine.LNX.4.61.0506281341470.10484@gannet.stats>

On Tue, 28 Jun 2005 Chad.P.Jenness at wellsfargo.com wrote:

> When compiling R on Windows, I am getting the following error.  Does
> anyone have any suggestions?

Yes, it seems you have corrupted the files during unpacking.  Did you use 
the version of tar in the Rtools.zip?  Whatever you used to unpack the 
files has changed LF to CR line endings. Winzip is notorious for doing 
things like that.

Only a very few tools will unpack that tar file (which contains symbolic 
links) correctly.  Which is why we provide one, and issue a warning in the
R Installation and Administration manual.


> ---------- Making package datasets ------------
>  adding build stamp to DESCRIPTION
>  installing R files
>  installing data files
>  preparing package datasets for lazy data loading
> Error in load(zfile, envir = envir) : input has been corrupted, with LF
> replaced
> by CR
> Execution halted
> make[4]: *** [lazydata] Error 1
> make[3]: *** [all] Error 2
> make[2]: *** [pkg-datasets] Error 2
> make[1]: *** [rpackage] Error 1
> make: *** [all] Error 2
>
>
> Thanks,
> Chad Jenness
> Electronic Payment Business Services
> Office: 612-667-9782
> Email: Chad.P.Jenness at WellsFargo.com
>
> "This message may contain confidential and/or privileged information.
> If you are not the addressee or authorized to receive this for the
> addressee, you must not use, copy, disclose, or take any action based on
> this message or any information herein.  If you have received this
> message in error, please advise the sender immediately by reply e-mail
> and delete this message.  Thank you for your cooperation"
>
>
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From p.dalgaard at biostat.ku.dk  Tue Jun 28 14:57:42 2005
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: 28 Jun 2005 14:57:42 +0200
Subject: [Rd] boxplot by factor (Package base version 2.1.1) ( PR#7976)
In-Reply-To: <39B6DDB9048D0F4DAD42CB26AAFF0AFA64EA20@usctmx1106.Merck.com>
References: <39B6DDB9048D0F4DAD42CB26AAFF0AFA64EA20@usctmx1106.Merck.com>
Message-ID: <x2aclaskop.fsf@turmalin.kubism.ku.dk>

"Liaw, Andy" <andy_liaw at merck.com> writes:

> The issue is not with boxplot, but with split.  boxplot.formula() 
> calls boxplot(split(split(mf[[response]], mf[-response]), ...), 
> but look at what split() returns when there are empty levels in
> the factor:
> 
> > f <- factor(gl(3, 6), levels=1:5)
> > y <- rnorm(f)
> > split(y, f)
> $"1"
> [1] 0.4832124 1.1924811 0.3657797 1.7400198 0.5577356 0.9889520
> 
> $"2"
> [1] -1.1296642 -0.4808355 -0.2789933  0.1220718  0.1287742 -0.7573801
> 
> $"3"
> [1]  1.2320902  0.5090700 -1.5508074  2.1373780  1.1681297 -0.7151561
> 
> The "culprit" is the following in split.default():
> 
>     f <- factor(f)
> 
> which drops empty levels in f, if there are any.  BTW, ?split doesn't
> mention what it does in such situation.  Perhaps it should?
> 
> If this is to be "fixed", I suppose an additional argument, e.g.,
> drop=TRUE, can be added, and the corresponding line mentioned
> above changed to something like:
> 
>     if (drop || !is.factor(f)) f <- factor(f)
> 
> Then this additional argument can be pass on from boxplot.formula() to 
> split().

Alternatively, I suspect that the intention was as.factor() rather
than factor(). It does require a bit of care to fix it that way,
though. There could be problems with empty levels popping up in
unexpected places. 

-- 
   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
 (*) \(*) -- University of Copenhagen   Denmark          Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)                  FAX: (+45) 35327907


From Chad.P.Jenness at wellsfargo.com  Tue Jun 28 16:41:13 2005
From: Chad.P.Jenness at wellsfargo.com (Chad.P.Jenness@wellsfargo.com)
Date: Tue, 28 Jun 2005 09:41:13 -0500
Subject: [Rd] Error in compiling R
Message-ID: <B317A5F105ED5B4E88A279BC5DE28F3162856C@msgswbmnmsp20.wellsfargo.com>

Thanks, I got this resolved.  Now to embed the R.dll into a C
application, do I need to compile R with any shared library flags set?

Chad Jenness
Electronic Payment Business Services
Office: 612-667-9782
Email: Chad.P.Jenness at WellsFargo.com

"This message may contain confidential and/or privileged information.
If you are not the addressee or authorized to receive this for the
addressee, you must not use, copy, disclose, or take any action based on
this message or any information herein.  If you have received this
message in error, please advise the sender immediately by reply e-mail
and delete this message.  Thank you for your cooperation"


-----Original Message-----
From: Prof Brian Ripley [mailto:ripley at stats.ox.ac.uk] 
Sent: Tuesday, June 28, 2005 7:47 AM
To: Chad.P.Jenness at wellsfargo.com
Cc: r-devel at r-project.org
Subject: Re: [Rd] Error in compiling R


On Tue, 28 Jun 2005 Chad.P.Jenness at wellsfargo.com wrote:

> When compiling R on Windows, I am getting the following error.  Does 
> anyone have any suggestions?

Yes, it seems you have corrupted the files during unpacking.  Did you
use 
the version of tar in the Rtools.zip?  Whatever you used to unpack the 
files has changed LF to CR line endings. Winzip is notorious for doing 
things like that.

Only a very few tools will unpack that tar file (which contains symbolic

links) correctly.  Which is why we provide one, and issue a warning in
the R Installation and Administration manual.


> ---------- Making package datasets ------------
>  adding build stamp to DESCRIPTION
>  installing R files
>  installing data files
>  preparing package datasets for lazy data loading
> Error in load(zfile, envir = envir) : input has been corrupted, with 
> LF replaced by CR
> Execution halted
> make[4]: *** [lazydata] Error 1
> make[3]: *** [all] Error 2
> make[2]: *** [pkg-datasets] Error 2
> make[1]: *** [rpackage] Error 1
> make: *** [all] Error 2
>
>
> Thanks,
> Chad Jenness
> Electronic Payment Business Services
> Office: 612-667-9782
> Email: Chad.P.Jenness at WellsFargo.com
>
> "This message may contain confidential and/or privileged information. 
> If you are not the addressee or authorized to receive this for the 
> addressee, you must not use, copy, disclose, or take any action based 
> on this message or any information herein.  If you have received this 
> message in error, please advise the sender immediately by reply e-mail

> and delete this message.  Thank you for your cooperation"
>
>
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list 
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From jago at mclink.it  Tue Jun 28 16:53:37 2005
From: jago at mclink.it (stefano iacus)
Date: Tue, 28 Jun 2005 16:53:37 +0200
Subject: [Rd] Does not run under Mac OS X 10.3.9 (PR#7975)
In-Reply-To: <20050628042328.25BCEA263@slim.kubism.ku.dk>
References: <20050628042328.25BCEA263@slim.kubism.ku.dk>
Message-ID: <8E802B6B-A942-412B-A747-0547DFDEEB52@mclink.it>

You should give us more feedback if you want us to be of any help to  
you.
Could you please send us the crash report of R? (See Console.app in / 
Applications/Utilities )
stefano

On 28/giu/05, at 06:23, matthias.wahl at macnews.de wrote:

> Full_Name: Matthias Wahl
> Version: 2.0.1 and 2.1.0a
> OS: Mac OS X 10.3.9
> Submission from: (NULL) (84.159.39.159)
>
>
> Version 2.1.0a does get installed, R is available under applications,
> however when trying to start R I get an error message that R is  
> terminated
> due to an error and that's it. Re-installing didn't help at all.
>
> Then I tried Version 2.0.1. and there I don't even get an icon to  
> start R.
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>


From ggrothendieck at gmail.com  Tue Jun 28 17:25:40 2005
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Tue, 28 Jun 2005 11:25:40 -0400
Subject: [Rd] boxplot by factor (Package base version 2.1.1) ( PR#7976)
In-Reply-To: <39B6DDB9048D0F4DAD42CB26AAFF0AFA64EA20@usctmx1106.Merck.com>
References: <39B6DDB9048D0F4DAD42CB26AAFF0AFA64EA20@usctmx1106.Merck.com>
Message-ID: <971536df050628082551884de3@mail.gmail.com>

Based on Andy's comment a workaround can consist of
not using boxplot.formula, e.g. using the data frame d
defined by the original poster (see below):

	boxplot( by(d, d$b, function(x)x$a) )


On 6/28/05, Liaw, Andy <andy_liaw at merck.com> wrote:
> The issue is not with boxplot, but with split.  boxplot.formula()
> calls boxplot(split(split(mf[[response]], mf[-response]), ...),
> but look at what split() returns when there are empty levels in
> the factor:
> 
> > f <- factor(gl(3, 6), levels=1:5)
> > y <- rnorm(f)
> > split(y, f)
> $"1"
> [1] 0.4832124 1.1924811 0.3657797 1.7400198 0.5577356 0.9889520
> 
> $"2"
> [1] -1.1296642 -0.4808355 -0.2789933  0.1220718  0.1287742 -0.7573801
> 
> $"3"
> [1]  1.2320902  0.5090700 -1.5508074  2.1373780  1.1681297 -0.7151561
> 
> The "culprit" is the following in split.default():
> 
>    f <- factor(f)
> 
> which drops empty levels in f, if there are any.  BTW, ?split doesn't
> mention what it does in such situation.  Perhaps it should?
> 
> If this is to be "fixed", I suppose an additional argument, e.g.,
> drop=TRUE, can be added, and the corresponding line mentioned
> above changed to something like:
> 
>    if (drop || !is.factor(f)) f <- factor(f)
> 
> Then this additional argument can be pass on from boxplot.formula() to
> split().
> 
> Just my $0.02...
> 
> Andy
> 
> > From: mwtoews at sfu.ca
> >
> > I consider this to be an old bug, which also persists in Splus 7. It
> > is unnecessary, and annoying.
> >
> > ## Section 1: Consider a simple data frame with three possible
> > factors (in levels)
> >
> > d <- data.frame(a=sort(rnorm(10)*10), b=factor(c(rep("A",4), rep("C",
> > 6)), levels=c("A","B","C")))
> > tapply(d$a, d$b, mean) # returns three results, which I would expect
> > plot(a ~ b, d) # plots only two of three objects, ignoring
> > that there
> > was "C" in the second position
> >
> > # if I tried to plot a blank in between the two boxplots:
> > plot(a ~ b, d, at=1:3) # nope: error
> > plot(a ~ b, d, at=c(1,3)) # nope: out of range (also xlim does
> > nothing for the formula boxplot method)
> >
> > # to make this work with the current R/Splus implementation, I have
> > to add a zero:
> > d <- rbind(d, data.frame(a=0,b="B")) # which I don't want to do,
> > since there are no "B"
> > plot(a ~ b, d) # yuk!
> >
> > ## Section 2: Why is this important? Consider another realistic
> > example of [synthetic] daily temperature
> >
> > temp <- 5 - 10*cos(1:365*2*pi/365) + rnorm(365)*3
> > d1 <- data.frame(year=2005, jday=1:365, date=NA, month=NA, temp) #
> > jday is Julian day [1,365]
> > d1$date <- as.Date(paste(d1$year, d1$jday), "%Y %j")
> > d1$month <- factor(months(d1$date,TRUE), levels=month.abb)
> > plot(temp ~ month, d1) # perfect, in a perfect meteorological world
> >
> > d2 <- d1[!d1$month %in% c("Mar","Apr","May","Sep"),] # now let's
> > remove some data
> > tapply(d2$temp,d2$month,mean)  # perfect
> > plot(temp ~ month, d2) # ugly, not 12 months, etc. (despite
> > having 12
> > levels)
> >
> > # again the only cure is to add zeros to the missing months
> > (unnecessary forgery of data)
> > d3 <- d2
> > for (i in c("Mar","Apr","May","Sep")) {
> >      d3 <- rbind(d3,NA)
> >      d3$month[nrow(d3)] <- i
> >      d3$temp[nrow(d3)] <- 0
> > }
> > plot(temp ~ month, d3) # still ugly, but at least has 12 months!
> >
> > ## Section 3: Solution
> > The obvious solution is to leave a blank where a boxplot should go,
> > similar to tapply. This would have 1:n positions, where n is the
> > number of levels of the factor, not the number of factors that have
> > one or more numbers.  The position should also have a label
> > under the
> > tick mark.
> > I don't see any reason why the missing data should be completely
> > ignored. Users wishing to not plot the blanks where the data
> > could go
> > can simply type (for back-compatibility):
> >
> > d2$month <- factor(d2$month) # from 12 to 8 levels
> >
> > Which will produce the same 8-factor plot as above.
> >
> > ## Section 4: Conclusion
> > I consider this to be a bug in regards to data representation, and
> > this function is not consistant with other functions like `tapply'.
> > Considering that the back-compatibility solution is very simple, and
> > most users would probably prefer a result including all levels (NULL
> > or real values in each), I feel this an appropriate improvement (and
> > easy to fix in the code). At the very least, include an option to
> > honour the factor levels.
> >
> > Thanks.
> > -mt
> >
> > --please do not edit the information below--
> >
> > Version:
> > platform = powerpc-apple-darwin8.1.0
> > arch = powerpc
> > os = darwin8.1.0
> > system = powerpc, darwin8.1.0
> > status = Patched
> > major = 2
> > minor = 1.1
> > year = 2005
> > month = 06
> > day = 26
> > language = R
> >
> > Locale:
> > en_CA.UTF-8/en_CA.UTF-8/en_CA.UTF-8/C/en_CA.UTF-8/en_CA.UTF-8
> >
> > Search Path:
> > .GlobalEnv, package:methods, package:stats, package:graphics,
> > package:grDevices, package:utils, package:datasets, Autoloads,
> > package:base
> >
> > ______________________________________________
> > R-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-devel
> >
> >
> >
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From ripley at stats.ox.ac.uk  Tue Jun 28 18:07:36 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue, 28 Jun 2005 17:07:36 +0100 (BST)
Subject: [Rd] Error in compiling R
In-Reply-To: <B317A5F105ED5B4E88A279BC5DE28F3162856C@msgswbmnmsp20.wellsfargo.com>
References: <B317A5F105ED5B4E88A279BC5DE28F3162856C@msgswbmnmsp20.wellsfargo.com>
Message-ID: <Pine.LNX.4.61.0506281706220.24352@gannet.stats>

On Tue, 28 Jun 2005 Chad.P.Jenness at wellsfargo.com wrote:

> Thanks, I got this resolved.  Now to embed the R.dll into a C
> application, do I need to compile R with any shared library flags set?

Not for Windows, but all the details are in the `Writing R Extensions' 
manual.  You proabably don't want to use R.dll directly (but you can) but 
rather via COM.

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From dmbates at gmail.com  Tue Jun 28 23:02:09 2005
From: dmbates at gmail.com (Douglas Bates)
Date: Tue, 28 Jun 2005 16:02:09 -0500
Subject: [Rd] Running ./tools/rsync-recommended through a proxy
Message-ID: <40e66e0b05062814021d271577@mail.gmail.com>

My computers at my office will no longer be able to connect directly
to web sites etc.  I will be going through a proxy server.  The
particular server is running squid on port 3128.

I have managed to configure web browsers, ssh, apt, svn and a whole
lot of other tools to use the proxy server but I haven't been able to
configure rsync.  My usual method of updating my copy of the R-devel
sources is via

cd my_R_devel_sources
svn up
./tools/rsync-recommended

cd my_R_build_directory
...

Can anyone offer suggestions on how to get rsync-recommended to work
through a proxy?  I have set

export RSYNC_PROXY="machine.name:3128"

which I understand from the documentation is the magic environment
variable (I don't give the name of the server explicitly because it is
an open proxy).  However, I still get

bates at bates4:/usr/src/r-devel$ ./tools/rsync-recommended
bad response from proxy - HTTP/1.0 403 Forbidden
rsync: failed to connect to machine.name: Success (0)
rsync error: error in socket IO (code 10) at clientserver.c(94)
*** rsync failed to update Recommended files ***
Creating links

Is it likely that the proxy server is not passing connections to port 873?


From ripley at stats.ox.ac.uk  Wed Jun 29 09:23:26 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed, 29 Jun 2005 08:23:26 +0100 (BST)
Subject: [Rd] Running ./tools/rsync-recommended through a proxy
In-Reply-To: <40e66e0b05062814021d271577@mail.gmail.com>
References: <40e66e0b05062814021d271577@mail.gmail.com>
Message-ID: <Pine.LNX.4.61.0506290816060.7118@gannet.stats>

Googling for 'squid rsync' suggests that squid has to be explicitly
configured to allow rsync, e.g.

http://www.sai.msu.su/~er/rsync_proxy.html

Why not ask the proxy administrators if they have rsync configured?


On Tue, 28 Jun 2005, Douglas Bates wrote:

> My computers at my office will no longer be able to connect directly
> to web sites etc.  I will be going through a proxy server.  The
> particular server is running squid on port 3128.
>
> I have managed to configure web browsers, ssh, apt, svn and a whole
> lot of other tools to use the proxy server but I haven't been able to
> configure rsync.  My usual method of updating my copy of the R-devel
> sources is via
>
> cd my_R_devel_sources
> svn up
> ./tools/rsync-recommended
>
> cd my_R_build_directory
> ...
>
> Can anyone offer suggestions on how to get rsync-recommended to work
> through a proxy?  I have set
>
> export RSYNC_PROXY="machine.name:3128"
>
> which I understand from the documentation is the magic environment
> variable (I don't give the name of the server explicitly because it is
> an open proxy).  However, I still get
>
> bates at bates4:/usr/src/r-devel$ ./tools/rsync-recommended
> bad response from proxy - HTTP/1.0 403 Forbidden
> rsync: failed to connect to machine.name: Success (0)
> rsync error: error in socket IO (code 10) at clientserver.c(94)
> *** rsync failed to update Recommended files ***
> Creating links
>
> Is it likely that the proxy server is not passing connections to port 873?
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From maechler at stat.math.ethz.ch  Wed Jun 29 16:48:59 2005
From: maechler at stat.math.ethz.ch (maechler@stat.math.ethz.ch)
Date: Wed, 29 Jun 2005 16:48:59 +0200 (CEST)
Subject: [Rd] (PR#7972)  row-side color bars ... in heatmap
Message-ID: <20050629144859.35AF5A346@slim.kubism.ku.dk>

Hi Kevin,

>>>>> "krc" == krc  <krc at odin.mdacc.tmc.edu>
>>>>>     on Mon, 27 Jun 2005 21:55:37 +0200 (CEST) writes:

    krc> Full_Name: Kevin R. Coombes
    krc> Version: 2.1.0
    krc> OS: Windows XP
    krc> Submission from: (NULL) (143.111.224.169)


    krc> When revC = TRUE and RowSideColors is set to a list of
    krc> colors in heatmap, then the image and dendrogram are
    krc> inverted, but the row-side color map does not
    krc> change. The following script illustrates the problem.

    krc> ##############
    krc> set.seed(1023)
    krc> # generate columns of two different types
    krc> d1 <- matrix(rnorm(100*6, rnorm(100, 0.5)), nrow=100, ncol=6, byrow=FALSE)
    krc> d2 <- matrix(rnorm(100*4, rnorm(100, 0.5)), nrow=100, ncol=4, byrow=FALSE)
    krc> # join them together
    krc> dd <- cbind(d1, d2)
    krc> # label them with different colors
    krc> cols <- rep(c('blue', 'green'), times=c(6,4))

    krc> # change the order of the columns and the matching labels
    krc> # to show that reordering occurs in one case in heatmap
    krc> col.order <- sample(10)
    krc> dd <- dd[, col.order]
    krc> cols <- cols[col.order]

    krc> # compute the dendrogram to be used in the display
    krc> hc <- hclust(dist(dd, 'euclid'))

a clustering of 100 observational units

    krc> # get the correlation matrix
    krc> m <- cor(dd)

a 10 x 10 matrix ; i.e. 10 row units and 10 column units.

Hence the following never works,
at least not for the heatmap() function as in ``standard R''.

    krc> # this version works correctly
    krc> heatmap(m, Rowv=as.dendrogram(hc), symm=TRUE, revC=FALSE, RowSideColors=cols)

gives immediately the obvious error

 Error in heatmap(m, Rowv = ............ :
	 row dendrogram ordering gave index of wrong length

    krc> #this version reverses the dendrogram and image, but not the colors
    krc> heatmap(m, Rowv=as.dendrogram(hc), symm=TRUE, revC=TRUE,
    krc> RowSideColors=cols)

so I wonder what you did want.

Regards,
Martin


From maechler at stat.math.ethz.ch  Wed Jun 29 17:30:31 2005
From: maechler at stat.math.ethz.ch (maechler@stat.math.ethz.ch)
Date: Wed, 29 Jun 2005 17:30:31 +0200 (CEST)
Subject: [Rd] (PR#7972)  row-side color bars ... in heatmap
Message-ID: <20050629153031.2ECD3A20A@slim.kubism.ku.dk>

Hi Kevin,

>>>>> "krc" == krc  <krc at odin.mdacc.tmc.edu>
>>>>>     on Mon, 27 Jun 2005 21:55:37 +0200 (CEST) writes:

    krc> Full_Name: Kevin R. Coombes
    krc> Version: 2.1.0
    krc> OS: Windows XP
    krc> Submission from: (NULL) (143.111.224.169)


    krc> When revC = TRUE and RowSideColors is set to a list of
    krc> colors in heatmap, then the image and dendrogram are
    krc> inverted, but the row-side color map does not
    krc> change. The following script illustrates the problem.

    krc> ##############
    krc> set.seed(1023)
    krc> # generate columns of two different types
    krc> d1 <- matrix(rnorm(100*6, rnorm(100, 0.5)), nrow=100, ncol=6, byrow=FALSE)
    krc> d2 <- matrix(rnorm(100*4, rnorm(100, 0.5)), nrow=100, ncol=4, byrow=FALSE)
    krc> # join them together
    krc> dd <- cbind(d1, d2)
    krc> # label them with different colors
    krc> cols <- rep(c('blue', 'green'), times=c(6,4))

    krc> # change the order of the columns and the matching labels
    krc> # to show that reordering occurs in one case in heatmap
    krc> col.order <- sample(10)
    krc> dd <- dd[, col.order]
    krc> cols <- cols[col.order]

    krc> # compute the dendrogram to be used in the display
    krc> hc <- hclust(dist(dd, 'euclid'))

a clustering of 100 observational units

    krc> # get the correlation matrix
    krc> m <- cor(dd)

a 10 x 10 matrix ; i.e. 10 row units and 10 column units.

Hence the following never works,
at least not for the heatmap() function as in ``standard R''.

    krc> # this version works correctly
    krc> heatmap(m, Rowv=as.dendrogram(hc), symm=TRUE, revC=FALSE, RowSideColors=cols)

gives immediately the obvious error

 Error in heatmap(m, Rowv = ............ :
	 row dendrogram ordering gave index of wrong length

    krc> #this version reverses the dendrogram and image, but not the colors
    krc> heatmap(m, Rowv=as.dendrogram(hc), symm=TRUE, revC=TRUE,
    krc> RowSideColors=cols)

so I wonder what you did want.

Regards,
Martin


From murdoch at stats.uwo.ca  Wed Jun 29 19:49:54 2005
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Wed, 29 Jun 2005 13:49:54 -0400
Subject: [Rd] Viewing R objects in gdb
Message-ID: <42C2DF42.8090200@stats.uwo.ca>

I'm trying to track down a bug in some experimental code, where an 
object's attribute is getting messed up.  This means I'd like to examine 
R objects while within gdb.

One of the things I'd like to do is to examine the names of all the 
attributes.  This is exactly what an example in the R Extensions manual 
section 4.11.2 "Inspecting R objects when debugging" does, but the code 
there doesn't work, presumably because the R internals have changed 
since it was written.

Specifically, I get

(gdb) p $a->u.listsxp.tagval->u.symsxp.pname->u.vecsxp.type.c
Error: There is no member named vecsxp.

where $a was set to be the attrib member of an SEXP.

Could someone let me know what needs to be fixed for this to work?  I 
imagine it's a typecast, but I haven't been able to put it together.

(An example using R_PV to print the attributes of an SEXP would also be 
welcome, but I can probably figure that one out once I get this...)

Duncan Murdoch


From kent at d89h102.public.uconn.edu  Wed Jun 29 19:52:41 2005
From: kent at d89h102.public.uconn.edu (kent@d89h102.public.uconn.edu)
Date: Wed, 29 Jun 2005 19:52:41 +0200 (CEST)
Subject: [Rd] Failed make (PR#7978)
Message-ID: <20050629175241.F22C8A20A@slim.kubism.ku.dk>

I downloaded R v2.1.1 earlier this morning to compile under Fedora Core 4. 
It compiled without incident, but 'make check' failed. Below is the relevant
part of its report. Is this a known problem? 

I used a locally compiled version of GCC v4.0.0 that reports

[kent at d89h102 R-2.1.1]$ gcc -v
Using built-in specs.
Target: i686-pc-linux-gnu
Configured with: ../gcc-4.0.0/configure --enable-languages=c,c++,f95,java
Thread model: posix
gcc version 4.0.0
[kent at d89h102 R-2.1.1]$

Kent Holsinger
kent at darwin.eeb.uconn.edu

make[3]: Entering directory `/home/kent/source-arc/R-2.1.1/tests'
running code in 'eval-etc.R' ... OK
comparing 'eval-etc.Rout' to './eval-etc.Rout.save' ...2a3,157
> > ####  eval / parse / deparse / substitute  etc
> >
> > ##- From: Peter Dalgaard BSA <p.dalgaard at biostat.ku.dk>
> > ##- Subject: Re: source() / eval() bug ??? (PR#96)
> > ##- Date: 20 Jan 1999 14:56:24 +0100
> > e1 <- parse(text='c(F=(f <- .3), "Tail area" = 2 * if(f < 1) 30 else 90)')[[1]]
> > e1
> c(F = (f <- 0.3), "Tail area" = 2 * if (f < 1) 30 else 90)
> > str(eval(e1))
>  Named num [1:2] 0.3 60
>  - attr(*, "names")= chr [1:2] "F" "Tail area"
> > mode(e1)
> [1] "call"
> >
> > ( e2 <- quote(c(a=1,b=2)) )
> c(a = 1, b = 2)
> > names(e2)[2] <- "a b c"
> > e2
> c("a b c" = 1, b = 2)
> > parse(text=deparse(e2))
> expression(c("a b c" = 1, b = 2))
> >
> > ##- From: Peter Dalgaard BSA <p.dalgaard at biostat.ku.dk>
> > ##- Date: 22 Jan 1999 11:47
> >
> > ( e3 <- quote(c(F=1,"tail area"=pf(1,1,1))) )
> c(F = 1, "tail area" = pf(1, 1, 1))
> > eval(e3)
>         F tail area
>       1.0       0.5
> > names(e3)
> [1] ""          "F"         "tail area"
> >
> > names(e3)[2] <- "Variance ratio"
> > e3
> c("Variance ratio" = 1, "tail area" = pf(1, 1, 1))
> > eval(e3)
> Variance ratio      tail area
>            1.0            0.5
> >
> >
> > ##- From: Peter Dalgaard BSA <p.dalgaard at biostat.ku.dk>
> > ##- Date: 2 Sep 1999
> >
> > ## The first failed in 0.65.0 :
> > attach(list(x=1))
> > evalq(dim(x) <- 1,as.environment(2))
> > dput(get("x", env=as.environment(2)), control="all")
> structure(1, .Dim = as.integer(1))
> >
> > e <- local({x <- 1;environment()})
> > evalq(dim(x) <- 1,e)
> > dput(get("x",env=e), control="all")
> structure(1, .Dim = as.integer(1))
> >
> > ### Substitute, Eval, Parse, etc
> >
> > ## PR#3 : "..." matching
> > ## Revised March 7 2001 -pd
> > A <- function(x, y, ...) {
> +     B <- function(a, b, ...) { match.call() }
> +     B(x+y, ...)
> + }
> > (aa <- A(1,2,3))
> B(a = x + y, b = 3)
> > all.equal(as.list(aa),
> +           list(as.name("B"), a = expression(x+y)[[1]], b = 3))
> [1] TRUE
> > (a2 <- A(1,2, named = 3)) #A(1,2, named = 3)
> B(a = x + y, named = 3)
> > all.equal(as.list(a2),
> +           list(as.name("B"), a = expression(x+y)[[1]], named = 3))
> [1] TRUE
> >
> > CC <- function(...) match.call()
> > DD <- function(...) CC(...)
> > a3 <- DD(1,2,3)
> > all.equal(as.list(a3),
> +           list(as.name("CC"), 1, 2, 3))
> [1] TRUE
> >
> > ## More dots issues: March 19 2001 -pd
> > ## Didn't work up to and including 1.2.2
> >
> > f <- function(...) {
> +     val <- match.call(expand.dots=F)$...
> +         x <- val[[1]]
> +     eval.parent(substitute(missing(x)))
> + }
> > g <- function(...) h(f(...))
> > h <- function(...) list(...)
> > k <- function(...) g(...)
> > X <- k(a=)
> > all.equal(X, list(TRUE))
> [1] TRUE
> >
> > ## Bug PR#24
> > f <- function(x,...) substitute(list(x,...))
> > deparse(f(a, b)) == "list(a, b)" &&
> + deparse(f(b, a)) == "list(b, a)" &&
> + deparse(f(x, y)) == "list(x, y)" &&
> + deparse(f(y, x)) == "list(y, x)"
> [1] TRUE
> >
> > tt <- function(x) { is.vector(x); deparse(substitute(x)) }
> > a <- list(b=3); tt(a$b) == "a$b" # tends to break when ...
> [1] TRUE
> >
> >
> > ## Parser:
> > 1 <
> +     2
> [1] TRUE
> > 2 <=
> +     3
> [1] TRUE
> > 4 >=
> +     3
> [1] TRUE
> > 3 >
> +     2
> [1] TRUE
> > 2 ==
> +     2
> [1] TRUE
> > ## bug till ...
> > 1 !=
> +     3
> [1] TRUE
> >
> > all(NULL == NULL)
> [1] TRUE
> >
> > ## PR #656 (related)
> > u <- runif(1);      length(find(".Random.seed")) == 1
> [1] TRUE
> >
> > MyVaR <<- "val";length(find("MyVaR")) == 1
> [1] TRUE
> > rm(MyVaR);  length(find("MyVaR")) == 0
> [1] TRUE
> >
> >
> > ## Martin Maechler: rare bad bug in sys.function() {or match.arg()} (PR#1409)
> > callme <- function(a = 1, mm = c("Abc", "Bde")) {
> +     mm <- match.arg(mm); cat("mm = "); str(mm) ; invisible()
> + }
> > ## The first two were as desired:
> > callme()
> mm =  chr "Abc"
> > callme(mm="B")
> mm =  chr "Bde"
> > mycaller <- function(x = 1, callme = pi) { callme(x) }
> > mycaller()## wrongly gave `mm = NULL'  now = "Abc"
> mm =  chr "Abc"
make[3]: *** [eval-etc.Rout] Error 1
make[3]: Leaving directory `/home/kent/source-arc/R-2.1.1/tests'
make[2]: *** [test-Specific] Error 2
make[2]: Leaving directory `/home/kent/source-arc/R-2.1.1/tests'
make[1]: *** [test-all-basics] Error 1
make[1]: Leaving directory `/home/kent/source-arc/R-2.1.1/tests'
make: *** [check] Error 2

<<insert bug report here>>



--please do not edit the information below--

Version:
 platform = i686-pc-linux-gnu
 arch = i686
 os = linux-gnu
 system = i686, linux-gnu
 status = 
 major = 2
 minor = 1.1
 year = 2005
 month = 06
 day = 20
 language = R

Locale:
LC_CTYPE=en_US.UTF-8;LC_NUMERIC=C;LC_TIME=en_US.UTF-8;LC_COLLATE=en_US.UTF-8;LC_MONETARY=en_US.UTF-8;LC_MESSAGES=en_US.UTF-8;LC_PAPER=C;LC_NAME=C;LC_ADDRESS=C;LC_TELEPHONE=C;LC_MEASUREMENT=C;LC_IDENTIFICATION=C

Search Path:
 .GlobalEnv, package:methods, package:stats, package:graphics, package:grDevices, package:utils, package:datasets, Autoloads, package:base


From kent at darwin.eeb.uconn.edu  Wed Jun 29 19:55:26 2005
From: kent at darwin.eeb.uconn.edu (kent@darwin.eeb.uconn.edu)
Date: Wed, 29 Jun 2005 19:55:26 +0200 (CEST)
Subject: [Rd] Failed "make check" under Fedora Core 4 (PR#7979)
Message-ID: <20050629175526.AF68AA237@slim.kubism.ku.dk>

I downloaded R v2.1.1 earlier this morning to compile under Fedora Core 
4. It compiled without incident, but 'make check' failed. Below is the 
relevant part of its report. Is this a known problem?

I used a locally compiled version of GCC v4.0.0 that reports

[kent at d89h102 R-2.1.1]$ gcc -v
Using built-in specs.
Target: i686-pc-linux-gnu
Configured with: ../gcc-4.0.0/configure --enable-languages=c,c++,f95,java
Thread model: posix
gcc version 4.0.0
[kent at d89h102 R-2.1.1]$

Kent Holsinger
kent at darwin.eeb.uconn.edu

make[3]: Entering directory `/home/kent/source-arc/R-2.1.1/tests'
running code in 'eval-etc.R' ... OK
comparing 'eval-etc.Rout' to './eval-etc.Rout.save' ...2a3,157
 > > ####  eval / parse / deparse / substitute  etc
 > >
 > > ##- From: Peter Dalgaard BSA <p.dalgaard at biostat.ku.dk>
 > > ##- Subject: Re: source() / eval() bug ??? (PR#96)
 > > ##- Date: 20 Jan 1999 14:56:24 +0100
 > > e1 <- parse(text='c(F=(f <- .3), "Tail area" = 2 * if(f < 1) 30 
else 90)')[[1]]
 > > e1
 > c(F = (f <- 0.3), "Tail area" = 2 * if (f < 1) 30 else 90)
 > > str(eval(e1))
 >  Named num [1:2] 0.3 60
 >  - attr(*, "names")= chr [1:2] "F" "Tail area"
 > > mode(e1)
 > [1] "call"
 > >
 > > ( e2 <- quote(c(a=1,b=2)) )
 > c(a = 1, b = 2)
 > > names(e2)[2] <- "a b c"
 > > e2
 > c("a b c" = 1, b = 2)
 > > parse(text=deparse(e2))
 > expression(c("a b c" = 1, b = 2))
 > >
 > > ##- From: Peter Dalgaard BSA <p.dalgaard at biostat.ku.dk>
 > > ##- Date: 22 Jan 1999 11:47
 > >
 > > ( e3 <- quote(c(F=1,"tail area"=pf(1,1,1))) )
 > c(F = 1, "tail area" = pf(1, 1, 1))
 > > eval(e3)
 >         F tail area
 >       1.0       0.5
 > > names(e3)
 > [1] ""          "F"         "tail area"
 > >
 > > names(e3)[2] <- "Variance ratio"
 > > e3
 > c("Variance ratio" = 1, "tail area" = pf(1, 1, 1))
 > > eval(e3)
 > Variance ratio      tail area
 >            1.0            0.5
 > >
 > >
 > > ##- From: Peter Dalgaard BSA <p.dalgaard at biostat.ku.dk>
 > > ##- Date: 2 Sep 1999
 > >
 > > ## The first failed in 0.65.0 :
 > > attach(list(x=1))
 > > evalq(dim(x) <- 1,as.environment(2))
 > > dput(get("x", env=as.environment(2)), control="all")
 > structure(1, .Dim = as.integer(1))
 > >
 > > e <- local({x <- 1;environment()})
 > > evalq(dim(x) <- 1,e)
 > > dput(get("x",env=e), control="all")
 > structure(1, .Dim = as.integer(1))
 > >
 > > ### Substitute, Eval, Parse, etc
 > >
 > > ## PR#3 : "..." matching
 > > ## Revised March 7 2001 -pd
 > > A <- function(x, y, ...) {
 > +     B <- function(a, b, ...) { match.call() }
 > +     B(x+y, ...)
 > + }
 > > (aa <- A(1,2,3))
 > B(a = x + y, b = 3)
 > > all.equal(as.list(aa),
 > +           list(as.name("B"), a = expression(x+y)[[1]], b = 3))
 > [1] TRUE
 > > (a2 <- A(1,2, named = 3)) #A(1,2, named = 3)
 > B(a = x + y, named = 3)
 > > all.equal(as.list(a2),
 > +           list(as.name("B"), a = expression(x+y)[[1]], named = 3))
 > [1] TRUE
 > >
 > > CC <- function(...) match.call()
 > > DD <- function(...) CC(...)
 > > a3 <- DD(1,2,3)
 > > all.equal(as.list(a3),
 > +           list(as.name("CC"), 1, 2, 3))
 > [1] TRUE
 > >
 > > ## More dots issues: March 19 2001 -pd
 > > ## Didn't work up to and including 1.2.2
 > >
 > > f <- function(...) {
 > +     val <- match.call(expand.dots=F)$...
 > +         x <- val[[1]]
 > +     eval.parent(substitute(missing(x)))
 > + }
 > > g <- function(...) h(f(...))
 > > h <- function(...) list(...)
 > > k <- function(...) g(...)
 > > X <- k(a=)
 > > all.equal(X, list(TRUE))
 > [1] TRUE
 > >
 > > ## Bug PR#24
 > > f <- function(x,...) substitute(list(x,...))
 > > deparse(f(a, b)) == "list(a, b)" &&
 > + deparse(f(b, a)) == "list(b, a)" &&
 > + deparse(f(x, y)) == "list(x, y)" &&
 > + deparse(f(y, x)) == "list(y, x)"
 > [1] TRUE
 > >
 > > tt <- function(x) { is.vector(x); deparse(substitute(x)) }
 > > a <- list(b=3); tt(a$b) == "a$b" # tends to break when ...
 > [1] TRUE
 > >
 > >
 > > ## Parser:
 > > 1 <
 > +     2
 > [1] TRUE
 > > 2 <=
 > +     3
 > [1] TRUE
 > > 4 >=
 > +     3
 > [1] TRUE
 > > 3 >
 > +     2
 > [1] TRUE
 > > 2 ==
 > +     2
 > [1] TRUE
 > > ## bug till ...
 > > 1 !=
 > +     3
 > [1] TRUE
 > >
 > > all(NULL == NULL)
 > [1] TRUE
 > >
 > > ## PR #656 (related)
 > > u <- runif(1);      length(find(".Random.seed")) == 1
 > [1] TRUE
 > >
 > > MyVaR <<- "val";length(find("MyVaR")) == 1
 > [1] TRUE
 > > rm(MyVaR);  length(find("MyVaR")) == 0
 > [1] TRUE
 > >
 > >
 > > ## Martin Maechler: rare bad bug in sys.function() {or match.arg()} 
(PR#1409)
 > > callme <- function(a = 1, mm = c("Abc", "Bde")) {
 > +     mm <- match.arg(mm); cat("mm = "); str(mm) ; invisible()
 > + }
 > > ## The first two were as desired:
 > > callme()
 > mm =  chr "Abc"
 > > callme(mm="B")
 > mm =  chr "Bde"
 > > mycaller <- function(x = 1, callme = pi) { callme(x) }
 > > mycaller()## wrongly gave `mm = NULL'  now = "Abc"
 > mm =  chr "Abc"
make[3]: *** [eval-etc.Rout] Error 1
make[3]: Leaving directory `/home/kent/source-arc/R-2.1.1/tests'
make[2]: *** [test-Specific] Error 2
make[2]: Leaving directory `/home/kent/source-arc/R-2.1.1/tests'
make[1]: *** [test-all-basics] Error 1
make[1]: Leaving directory `/home/kent/source-arc/R-2.1.1/tests'
make: *** [check] Error 2

<<insert bug report here>>



--please do not edit the information below--

Version:
  platform = i686-pc-linux-gnu
  arch = i686
  os = linux-gnu
  system = i686, linux-gnu
  status =
  major = 2
  minor = 1.1
  year = 2005
  month = 06
  day = 20
  language = R

Locale:
LC_CTYPE=en_US.UTF-8;LC_NUMERIC=C;LC_TIME=en_US.UTF-8;LC_COLLATE=en_US.UTF-8;LC_MONETARY=en_US.UTF-8;LC_MESSAGES=en_US.UTF-8;LC_PAPER=C;LC_NAME=C;LC_ADDRESS=C;LC_TELEPHONE=C;LC_MEASUREMENT=C;LC_IDENTIFICATION=C

Search Path:
  .GlobalEnv, package:methods, package:stats, package:graphics, 
package:grDevices, package:utils, package:datasets, Autoloads, package:base


From simon.urbanek at r-project.org  Wed Jun 29 20:01:47 2005
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Wed, 29 Jun 2005 14:01:47 -0400
Subject: [Rd] Failed make (PR#7978)
In-Reply-To: <20050629175241.F22C8A20A@slim.kubism.ku.dk>
References: <20050629175241.F22C8A20A@slim.kubism.ku.dk>
Message-ID: <8985F151-B7C6-4B2C-991D-6A2DAD5916AE@r-project.org>

On Jun 29, 2005, at 1:52 PM, kent at d89h102.public.uconn.edu wrote:

> I downloaded R v2.1.1 earlier this morning to compile under Fedora  
> Core 4.
> It compiled without incident, but 'make check' failed. Below is the  
> relevant
> part of its report. Is this a known problem?

My guess is that you're using gfortran instead of g77 and you didn't  
set GFORTRAN_STDIN_UNIT to -1 nor used FLIBS to force static fortran  
libraries - please see B.5.1. "Using gfortran" in "R Installation and  
Administration".

Cheers,
Simon


From luke at stat.uiowa.edu  Wed Jun 29 20:06:39 2005
From: luke at stat.uiowa.edu (Luke Tierney)
Date: Wed, 29 Jun 2005 13:06:39 -0500 (CDT)
Subject: [Rd] Viewing R objects in gdb
In-Reply-To: <42C2DF42.8090200@stats.uwo.ca>
References: <42C2DF42.8090200@stats.uwo.ca>
Message-ID: <Pine.LNX.4.63.0506291302130.4273@nokomis.stat.uiowa.edu>

On Wed, 29 Jun 2005, Duncan Murdoch wrote:

> I'm trying to track down a bug in some experimental code, where an
> object's attribute is getting messed up.  This means I'd like to examine
> R objects while within gdb.
>
> One of the things I'd like to do is to examine the names of all the
> attributes.  This is exactly what an example in the R Extensions manual
> section 4.11.2 "Inspecting R objects when debugging" does, but the code
> there doesn't work, presumably because the R internals have changed
> since it was written.
>
> Specifically, I get
>
> (gdb) p $a->u.listsxp.tagval->u.symsxp.pname->u.vecsxp.type.c
> Error: There is no member named vecsxp.
>

Something like this I think (untested):

         p ((VECSEXP)$a->u.listsxp.tagval->u.symsxp.pname)->vecsxp.type.c

luke

> where $a was set to be the attrib member of an SEXP.
>
> Could someone let me know what needs to be fixed for this to work?  I
> imagine it's a typecast, but I haven't been able to put it together.
>
> (An example using R_PV to print the attributes of an SEXP would also be
> welcome, but I can probably figure that one out once I get this...)
>
> Duncan Murdoch
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Luke Tierney
Chair, Statistics and Actuarial Science
Ralph E. Wareham Professor of Mathematical Sciences
University of Iowa                  Phone:             319-335-3386
Department of Statistics and        Fax:               319-335-3017
    Actuarial Science
241 Schaeffer Hall                  email:      luke at stat.uiowa.edu
Iowa City, IA 52242                 WWW:  http://www.stat.uiowa.edu


From ripley at stats.ox.ac.uk  Wed Jun 29 20:12:34 2005
From: ripley at stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Wed, 29 Jun 2005 20:12:34 +0200 (CEST)
Subject: [Rd] Failed make (PR#7978)
Message-ID: <20050629181234.69947A237@slim.kubism.ku.dk>

On Wed, 29 Jun 2005, Simon Urbanek wrote:

> On Jun 29, 2005, at 1:52 PM, kent at d89h102.public.uconn.edu wrote:
>
>> I downloaded R v2.1.1 earlier this morning to compile under Fedora
>> Core 4.
>> It compiled without incident, but 'make check' failed. Below is the
>> relevant
>> part of its report. Is this a known problem?
>
> My guess is that you're using gfortran instead of g77 and you didn't
> set GFORTRAN_STDIN_UNIT to -1 nor used FLIBS to force static fortran
> libraries - please see B.5.1. "Using gfortran" in "R Installation and
> Administration".

That is a known problem with vanilla gcc-4.0.0 but not with the version in 
FC4.  I do wonder why anyone would replace a patched compiler with an 
known buggy one.  At least use the latest release candidate of 4.0.1 if 
you insist on using gcc4.

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From murdoch at stats.uwo.ca  Wed Jun 29 20:30:12 2005
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Wed, 29 Jun 2005 14:30:12 -0400
Subject: [Rd] Viewing R objects in gdb
In-Reply-To: <Pine.LNX.4.63.0506291302130.4273@nokomis.stat.uiowa.edu>
References: <42C2DF42.8090200@stats.uwo.ca>
	<Pine.LNX.4.63.0506291302130.4273@nokomis.stat.uiowa.edu>
Message-ID: <42C2E8B4.4010007@stats.uwo.ca>

On 6/29/2005 2:06 PM, Luke Tierney wrote:
> On Wed, 29 Jun 2005, Duncan Murdoch wrote:
> 
>> I'm trying to track down a bug in some experimental code, where an
>> object's attribute is getting messed up.  This means I'd like to examine
>> R objects while within gdb.
>>
>> One of the things I'd like to do is to examine the names of all the
>> attributes.  This is exactly what an example in the R Extensions manual
>> section 4.11.2 "Inspecting R objects when debugging" does, but the code
>> there doesn't work, presumably because the R internals have changed
>> since it was written.
>>
>> Specifically, I get
>>
>> (gdb) p $a->u.listsxp.tagval->u.symsxp.pname->u.vecsxp.type.c
>> Error: There is no member named vecsxp.
>>
> 
> Something like this I think (untested):
> 
>          p ((VECSEXP)$a->u.listsxp.tagval->u.symsxp.pname)->vecsxp.type.c

That gets the typecast right, but now I have the problem that currently 
vecsxp doesn't have a type member:

(gdb) p ((VECSEXP)$a->u.listsxp.tagval->u.symsxp.pname)->vecsxp.type.c
Error: There is no member named type.

(gdb) p ((VECSEXP)$a->u.listsxp.tagval->u.symsxp.pname)->vecsxp
$1 = {length = 5, truelength = 6957219}

I guess I need to write a function that uses the macros to extract the 
data (since gdb doesn't see the macros).  Or do we already have one?

Duncan Murdoch


From rafalku at gmail.com  Wed Jun 29 20:34:57 2005
From: rafalku at gmail.com (Rafal Kustra)
Date: Wed, 29 Jun 2005 14:34:57 -0400
Subject: [Rd] Objects and regex (PR#7970)
In-Reply-To: <x2d5q9ugft.fsf@turmalin.kubism.ku.dk>
References: <20050626175220.61398A20A@slim.kubism.ku.dk>
	<x2d5q9ugft.fsf@turmalin.kubism.ku.dk>
Message-ID: <62a2e65d05062911346c11b8a1@mail.gmail.com>

No bug, mystery solved. My fault.

I got 'generateSigma' when trying to match for "^genes?" not "^genes?$".

I keep forgetting '?' stands for '0 or more of prec. char' not for
'any char' as in shell.

best,
rafal



-------------------------------------------------------------------------------------------------------------------



On 26 Jun 2005 20:21:58 +0200, Peter Dalgaard <p.dalgaard at biostat.ku.dk> wrote:
> rafalku at gmail.com writes:
> 
> > Full_Name: Rafal Kustra
> > Version: 2.1.0
> > OS: Linux
> > Submission from: (NULL) (64.229.198.89)
> >
> >
> > objects(pattern="^genes?$") returns "generateSigma" among other legal things.
> 
> Not on my 2.1.1:
> 
> > generateSigma <-1
> > objects(pattern="^genes?$")
> character(0)
> > objects(pattern="^genes?")
> [1] "generateSigma"
> 
> So. on what system did this happen?
> 
> --
>    O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
>   c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
>  (*) \(*) -- University of Copenhagen   Denmark          Ph: (+45) 35327918
> ~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)                  FAX: (+45) 35327907
>


From luke at stat.uiowa.edu  Wed Jun 29 20:44:42 2005
From: luke at stat.uiowa.edu (Luke Tierney)
Date: Wed, 29 Jun 2005 13:44:42 -0500 (CDT)
Subject: [Rd] Viewing R objects in gdb
In-Reply-To: <42C2E8B4.4010007@stats.uwo.ca>
References: <42C2DF42.8090200@stats.uwo.ca>
	<Pine.LNX.4.63.0506291302130.4273@nokomis.stat.uiowa.edu>
	<42C2E8B4.4010007@stats.uwo.ca>
Message-ID: <Pine.LNX.4.63.0506291338500.4273@nokomis.stat.uiowa.edu>

On Wed, 29 Jun 2005, Duncan Murdoch wrote:

> On 6/29/2005 2:06 PM, Luke Tierney wrote:
>> On Wed, 29 Jun 2005, Duncan Murdoch wrote:
>> 
>>> I'm trying to track down a bug in some experimental code, where an
>>> object's attribute is getting messed up.  This means I'd like to examine
>>> R objects while within gdb.
>>> 
>>> One of the things I'd like to do is to examine the names of all the
>>> attributes.  This is exactly what an example in the R Extensions manual
>>> section 4.11.2 "Inspecting R objects when debugging" does, but the code
>>> there doesn't work, presumably because the R internals have changed
>>> since it was written.
>>> 
>>> Specifically, I get
>>> 
>>> (gdb) p $a->u.listsxp.tagval->u.symsxp.pname->u.vecsxp.type.c
>>> Error: There is no member named vecsxp.
>>> 
>> 
>> Something like this I think (untested):
>>
>>          p ((VECSEXP)$a->u.listsxp.tagval->u.symsxp.pname)->vecsxp.type.c
>
> That gets the typecast right, but now I have the problem that currently 
> vecsxp doesn't have a type member:
>
> (gdb) p ((VECSEXP)$a->u.listsxp.tagval->u.symsxp.pname)->vecsxp.type.c
> Error: There is no member named type.
>
> (gdb) p ((VECSEXP)$a->u.listsxp.tagval->u.symsxp.pname)->vecsxp
> $1 = {length = 5, truelength = 6957219}
>
> I guess I need to write a function that uses the macros to extract the data 
> (since gdb doesn't see the macros).  Or do we already have one?

The type fiels it in the sxpinfo part of the header; I think either

   ((VECSEXP)$a->u.listsxp.tagval->u.symsxp.pname)->sxpinfo.type

or

   $a->u.listsxp.tagval->u.symsxp.pname->sxpinfo.type

will give you that.

It is probably possible to do something like write a file of gdb
macros, run the C pre-processor over it to get the expnansions, and
load that into gdb. Not that I've tried...

luke

-- 
Luke Tierney
Chair, Statistics and Actuarial Science
Ralph E. Wareham Professor of Mathematical Sciences
University of Iowa                  Phone:             319-335-3386
Department of Statistics and        Fax:               319-335-3017
    Actuarial Science
241 Schaeffer Hall                  email:      luke at stat.uiowa.edu
Iowa City, IA 52242                 WWW:  http://www.stat.uiowa.edu


From Robert.McGehee at geodecapital.com  Wed Jun 29 21:19:41 2005
From: Robert.McGehee at geodecapital.com (McGehee, Robert)
Date: Wed, 29 Jun 2005 15:19:41 -0400
Subject: [Rd] write.csv suggestion
Message-ID: <67DCA285A2D7754280D3B8E88EB548020C946615@MSGBOSCLB2WIN.DMN1.FMR.COM>

Hello all, 
I had some trouble recently with write.csv because I couldn't change one
of the default options. A quick view of the code showed that the
function was not defined in the most optimal way.

Currently,
write.csv <- function (..., col.names = NA, sep = ",", qmethod =
"double") 
	write.table(..., col.names = NA, sep = ",", qmethod = "double")

Thus, the options passed along to write.csv are ignored by the function
(unless in the ...).

Perhaps a better way to define the function is as such (similar to
read.csv):

write.csv <- function (..., col.names = NA, sep = ",", qmethod =
"double") 
	write.table(..., col.names = col.names, sep = sep, qmethod =
qmethod)

The same also applies to write.csv2

Best,
Robert


> version
         _              
platform i386-pc-mingw32
arch     i386           
os       mingw32        
system   i386, mingw32  
status                  
major    2              
minor    1.1            
year     2005           
month    06             
day      20             
language R


From ripley at stats.ox.ac.uk  Wed Jun 29 22:16:01 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed, 29 Jun 2005 21:16:01 +0100 (BST)
Subject: [Rd] write.csv suggestion
In-Reply-To: <67DCA285A2D7754280D3B8E88EB548020C946615@MSGBOSCLB2WIN.DMN1.FMR.COM>
References: <67DCA285A2D7754280D3B8E88EB548020C946615@MSGBOSCLB2WIN.DMN1.FMR.COM>
Message-ID: <Pine.LNX.4.61.0506292107290.9219@gannet.stats>

The help page says

      By default there is no column name for a column of row names.  If
      'col.names = NA' and 'row.names = TRUE' a blank column name is
      added.  This can be used to write CSV files for input to
      spreadsheets.  'write.csv' and 'write.csv2' provide convenience
      wrappers for doing so.

and they are set up to disallow the options they set to be changed.

If you get the option wrong to read a file, you will know soon enough, but 
these are to ensure a suitable CSV file gets written (which will not be so
immediately apparent).

Please define `optimal': doing what it was designed for and is documented 
to do is according to you not `optimal'.

Why would anyone want to use write.csv to write files with something other 
than a comma/semicolon as separator, rather than use write.table?


On Wed, 29 Jun 2005, McGehee, Robert wrote:

> Hello all,
> I had some trouble recently with write.csv because I couldn't change one
> of the default options. A quick view of the code showed that the
> function was not defined in the most optimal way.
>
> Currently,
> write.csv <- function (..., col.names = NA, sep = ",", qmethod =
> "double")
> 	write.table(..., col.names = NA, sep = ",", qmethod = "double")
>
> Thus, the options passed along to write.csv are ignored by the function
> (unless in the ...).
>
> Perhaps a better way to define the function is as such (similar to
> read.csv):
>
> write.csv <- function (..., col.names = NA, sep = ",", qmethod =
> "double")
> 	write.table(..., col.names = col.names, sep = sep, qmethod =
> qmethod)
>
> The same also applies to write.csv2
>
> Best,
> Robert
>
>
>> version
>         _
> platform i386-pc-mingw32
> arch     i386
> os       mingw32
> system   i386, mingw32
> status
> major    2
> minor    1.1
> year     2005
> month    06
> day      20
> language R
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From Robert.McGehee at geodecapital.com  Wed Jun 29 22:48:29 2005
From: Robert.McGehee at geodecapital.com (McGehee, Robert)
Date: Wed, 29 Jun 2005 16:48:29 -0400
Subject: [Rd] write.csv suggestion
Message-ID: <67DCA285A2D7754280D3B8E88EB548020C946616@MSGBOSCLB2WIN.DMN1.FMR.COM>

I didn't want to use a different separator, I wanted to remove
row.names, as in this example:

> data(USArrests)
> write.csv(USArrests, file = "~/test.csv", row.names = FALSE, col.names
= TRUE)
Error in if (col.names) d[[2]] else NULL : 
	missing value where TRUE/FALSE needed

I only mentioned this suggestion because the above syntax seemed
reasonable (and self-documenting), but by making the options
unchangeable, I received an unhelpful error message.

After checking the code, I rewrote the line to this:
> write.table(USArrests, file = "~/test.csv", sep = ",", row.names =
FALSE, col.names = TRUE)

This only seemed suboptimal (to me) because one would have to read the
code to know that the col.names = TRUE option was not being passed along
to write.table (as I expected).

Best,
Robert

-----Original Message-----
From: Prof Brian Ripley [mailto:ripley at stats.ox.ac.uk] 
Sent: Wednesday, June 29, 2005 4:16 PM
To: McGehee, Robert
Cc: r-devel at stat.math.ethz.ch
Subject: Re: [Rd] write.csv suggestion


The help page says

      By default there is no column name for a column of row names.  If
      'col.names = NA' and 'row.names = TRUE' a blank column name is
      added.  This can be used to write CSV files for input to
      spreadsheets.  'write.csv' and 'write.csv2' provide convenience
      wrappers for doing so.

and they are set up to disallow the options they set to be changed.

If you get the option wrong to read a file, you will know soon enough,
but 
these are to ensure a suitable CSV file gets written (which will not be
so
immediately apparent).

Please define `optimal': doing what it was designed for and is
documented 
to do is according to you not `optimal'.

Why would anyone want to use write.csv to write files with something
other 
than a comma/semicolon as separator, rather than use write.table?


On Wed, 29 Jun 2005, McGehee, Robert wrote:

> Hello all,
> I had some trouble recently with write.csv because I couldn't change
one
> of the default options. A quick view of the code showed that the
> function was not defined in the most optimal way.
>
> Currently,
> write.csv <- function (..., col.names = NA, sep = ",", qmethod =
> "double")
> 	write.table(..., col.names = NA, sep = ",", qmethod = "double")
>
> Thus, the options passed along to write.csv are ignored by the
function
> (unless in the ...).
>
> Perhaps a better way to define the function is as such (similar to
> read.csv):
>
> write.csv <- function (..., col.names = NA, sep = ",", qmethod =
> "double")
> 	write.table(..., col.names = col.names, sep = sep, qmethod =
> qmethod)
>
> The same also applies to write.csv2
>
> Best,
> Robert
>
>
>> version
>         _
> platform i386-pc-mingw32
> arch     i386
> os       mingw32
> system   i386, mingw32
> status
> major    2
> minor    1.1
> year     2005
> month    06
> day      20
> language R
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From stefano.iacus at unimi.it  Thu Jun 30 09:20:19 2005
From: stefano.iacus at unimi.it (stefano iacus)
Date: Thu, 30 Jun 2005 09:20:19 +0200
Subject: [Rd] Fwd:  Does not run under Mac OS X 10.3.9 (PR#7975)
References: <5b7603e6f609d860e82101853729b9f1@macnews.de>
Message-ID: <33A64506-0660-4604-AA72-430461FB3E9D@unimi.it>



Begin forwarded message:


> From: Matthias Wahl <matthias.wahl at macnews.de>
> Date: 28 giugno 2005 18:05:54 GMT+02:00
> To: stefano iacus <jago at mclink.it>
> Subject: Re: [Rd] Does not run under Mac OS X 10.3.9 (PR#7975)
>
>
> I don' have a folder 'Utilities' in applications, however here is  
> what I get when I chose
> 'send error report to Apple'. Maybe that helps you, too.
>
> Date/Time:      2005-06-28 18:03:45 +0200
> OS Version:     10.3.9 (Build 7W98)
> Report Version: 2
>
> Command: R
> Path:    /Applications/R.app/Contents/MacOS/R
> Version: 1.11 (1.11)
> PID:     374
> Thread:  0
>
> Exception:  EXC_BAD_ACCESS (0x0001)
> Codes:      KERN_INVALID_ADDRESS (0x0001) at 0x80000006
>
> Thread 0 Crashed:
> 0   com.apple.CoreFoundation     0x901c0f74 CFRetain + 0x20
> 1   com.apple.CoreFoundation     0x901dcc74 CFArrayCreate + 0x144
> 2   com.apple.Foundation         0x90a6c5e4 -[NSArray  
> initWithObjects:] + 0xbc
> 3   org.R-project.R              0x000032e4 -[RController init] +  
> 0x174
> 4   com.apple.AppKit             0x92f6bca8 -[NSCustomObject  
> nibInstantiate] + 0x10c
> 5   com.apple.AppKit             0x92e9ae54 -[NSIBObjectData  
> instantiateObject:] + 0xbc
> 6   com.apple.AppKit             0x92ea1e80 -[NSIBObjectData  
> nibInstantiateWithOwner:topLevelObjects:] + 0x88
> 7   com.apple.AppKit             0x92f93c2c loadNib + 0xfc
> 8   com.apple.AppKit             0x92eeae24 +[NSBundle 
> (NSNibLoading) _loadNibFile:nameTable:withZone:ownerBundle:] + 0x2e8
> 9   com.apple.AppKit             0x92f69d28 +[NSBundle 
> (NSNibLoading) loadNibFile:externalNameTable:withZone:] + 0x9c
> 10  com.apple.AppKit             0x92f7b51c +[NSBundle 
> (NSNibLoading) loadNibNamed:owner:] + 0x174
> 11  com.apple.AppKit             0x92f69b90 NSApplicationMain + 0x174
> 12  org.R-project.R              0x00002ba0 _start + 0x188 (crt.c:267)
> 13  dyld                         0x8fe1a278 _dyld_start + 0x64
>
> PPC Thread State:
>   srr0: 0x901c0f74 srr1: 0x0200f030                vrsave: 0x00000000
>     cr: 0x22000448  xer: 0x00000002   lr: 0x901c0f6c  ctr: 0x901c5acc
>     r0: 0x901dcc74   r1: 0xbffff5f0   r2: 0x22000448   r3: 0x80000000
>     r4: 0x80000000   r5: 0xbffff584   r6: 0x0003a348   r7: 0x0003a348
>     r8: 0x0003a348   r9: 0x00000008  r10: 0xffffffff  r11: 0xa0a21114
>    r12: 0x901c5acc  r13: 0x00000000  r14: 0x00000000  r15: 0x00000000
>    r16: 0x00311f50  r17: 0xa2eaab3c  r18: 0xa2e9ab3c  r19: 0xa2eaab3c
>    r20: 0xa2eaab3c  r21: 0x0003bf18  r22: 0x00000000  r23: 0x00000009
>    r24: 0xbffff720  r25: 0xbffff724  r26: 0x003a14c0  r27: 0xa01c2e94
>    r28: 0x00000009  r29: 0x003a1490  r30: 0x003a14bc  r31: 0x901c0f6c
>
> Binary Images Description:
>     0x1000 -    0x38fff org.R-project.R 1.11    /Applications/R.app/ 
> Contents/MacOS/R
>   0x205000 -   0x226fff libreadline.5.0.dylib     /Library/ 
> Frameworks/R.framework/Resources/lib/libreadline.5.0.dylib
>  0x1008000 -  0x1195fff libR.dylib     /Library/Frameworks/ 
> R.framework/Resources/lib/libR.dylib
> 0x806c0000 - 0x806e9fff libxslt.1.dylib     /usr/lib/libxslt.1.dylib
> 0x80830000 - 0x8090efff libxml2.2.dylib     /usr/lib/libxml2.2.dylib
> 0x8ed60000 - 0x8ed62fff com.apple.ExceptionHandling 1.2 (???)    / 
> System/Library/Frameworks/ExceptionHandling.framework/Versions/A/ 
> ExceptionHandling
> 0x8fe00000 - 0x8fe4ffff dyld     /usr/lib/dyld
> 0x90000000 - 0x9014ffff libSystem.B.dylib     /usr/lib/ 
> libSystem.B.dylib
> 0x901c0000 - 0x9026dfff com.apple.CoreFoundation 6.3.7 (299.35)    / 
> System/Library/Frameworks/CoreFoundation.framework/Versions/A/ 
> CoreFoundation
> 0x902b0000 - 0x90529fff com.apple.CoreServices.CarbonCore  
> 10.3.7    /System/Library/Frameworks/CoreServices.framework/ 
> Versions/A/Frameworks/CarbonCore.framework/Versions/A/CarbonCore
> 0x90584000 - 0x905f3fff com.apple.framework.IOKit 1.3.6 (???)    / 
> System/Library/Frameworks/IOKit.framework/Versions/A/IOKit
> 0x90610000 - 0x9069afff com.apple.CoreServices.OSServices 3.0.1    / 
> System/Library/Frameworks/CoreServices.framework/Versions/A/ 
> Frameworks/OSServices.framework/Versions/A/OSServices
> 0x90700000 - 0x90700fff com.apple.CoreServices 10.3 (???)    / 
> System/Library/Frameworks/CoreServices.framework/Versions/A/ 
> CoreServices
> 0x907c7000 - 0x907d2fff libCSync.A.dylib     /System/Library/ 
> Frameworks/ApplicationServices.framework/Versions/A/Frameworks/ 
> CoreGraphics.framework/Versions/A/Resources/libCSync.A.dylib
> 0x907f0000 - 0x907f9fff com.apple.DiskArbitration 2.0.5    /System/ 
> Library/PrivateFrameworks/DiskArbitration.framework/Versions/A/ 
> DiskArbitration
> 0x90810000 - 0x90810fff com.apple.ApplicationServices 1.0 (???)    / 
> System/Library/Frameworks/ApplicationServices.framework/Versions/A/ 
> ApplicationServices
> 0x90830000 - 0x9089ffff libobjc.A.dylib     /usr/lib/libobjc.A.dylib
> 0x90940000 - 0x909b3fff com.apple.DesktopServices 1.2.5    /System/ 
> Library/PrivateFrameworks/DesktopServicesPriv.framework/Versions/A/ 
> DesktopServicesPriv
> 0x90a20000 - 0x90b7bfff com.apple.Foundation 6.3.7 (500.59)    / 
> System/Library/Frameworks/Foundation.framework/Versions/C/Foundation
> 0x90d20000 - 0x90d3bfff com.apple.SystemConfiguration 1.7.1  
> (???)    /System/Library/Frameworks/SystemConfiguration.framework/ 
> Versions/A/SystemConfiguration
> 0x90ec0000 - 0x90ec0fff com.apple.Cocoa 6.3 (???)    /System/ 
> Library/Frameworks/Cocoa.framework/Versions/A/Cocoa
> 0x910b0000 - 0x91101fff com.apple.bom 1.2.5 (63.2)    /System/ 
> Library/PrivateFrameworks/Bom.framework/Versions/A/Bom
> 0x913a0000 - 0x9145ffff ColorSync     /System/Library/Frameworks/ 
> ApplicationServices.framework/Versions/A/Frameworks/ 
> ColorSync.framework/Versions/A/ColorSync
> 0x914ad000 - 0x914c1fff libCGATS.A.dylib     /System/Library/ 
> Frameworks/ApplicationServices.framework/Versions/A/Frameworks/ 
> CoreGraphics.framework/Versions/A/Resources/libCGATS.A.dylib
> 0x914e0000 - 0x91549fff com.apple.htmlrendering 1.1.2    /System/ 
> Library/Frameworks/Carbon.framework/Versions/A/Frameworks/ 
> HTMLRendering.framework/Versions/A/HTMLRendering
> 0x915e0000 - 0x91699fff com.apple.QD 3.4.67 (???)    /System/ 
> Library/Frameworks/ApplicationServices.framework/Versions/A/ 
> Frameworks/QD.framework/Versions/A/QD
> 0x91720000 - 0x917b3fff com.apple.print.framework.PrintCore 3.3    / 
> System/Library/Frameworks/ApplicationServices.framework/Versions/A/ 
> Frameworks/PrintCore.framework/Versions/A/PrintCore
> 0x91820000 - 0x91830fff com.apple.speech.recognition.framework  
> 3.3    /System/Library/Frameworks/Carbon.framework/Versions/A/ 
> Frameworks/SpeechRecognition.framework/Versions/A/SpeechRecognition
> 0x91850000 - 0x9186afff com.apple.openscripting 1.2.1 (???)    / 
> System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/ 
> OpenScripting.framework/Versions/A/OpenScripting
> 0x91890000 - 0x918a0fff com.apple.ImageCapture 2.1.5    /System/ 
> Library/Frameworks/Carbon.framework/Versions/A/Frameworks/ 
> ImageCapture.framework/Versions/A/ImageCapture
> 0x918d0000 - 0x918dcfff com.apple.help 1.0.1    /System/Library/ 
> Frameworks/Carbon.framework/Versions/A/Frameworks/Help.framework/ 
> Versions/A/Help
> 0x91900000 - 0x9190dfff com.apple.CommonPanels 1.2.1 (1.0)    / 
> System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/ 
> CommonPanels.framework/Versions/A/CommonPanels
> 0x91930000 - 0x9197efff com.apple.print.framework.Print 3.3    / 
> System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/ 
> Print.framework/Versions/A/Print
> 0x919a7000 - 0x919c1fff libresolv.9.dylib     /usr/lib/libresolv. 
> 9.dylib
> 0x919d0000 - 0x919dbfff com.apple.securityhi 1.2 (90)    /System/ 
> Library/Frameworks/Carbon.framework/Versions/A/Frameworks/ 
> SecurityHI.framework/Versions/A/SecurityHI
> 0x919e3000 - 0x91a1bfff com.apple.AE 1.4    /System/Library/ 
> Frameworks/ApplicationServices.framework/Versions/A/Frameworks/ 
> AE.framework/Versions/A/AE
> 0x91a40000 - 0x91ab3fff com.apple.NavigationServices 3.3.3    / 
> System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/ 
> NavigationServices.framework/Versions/A/NavigationServices
> 0x91b10000 - 0x91b2afff libPDFRIP.A.dylib     /System/Library/ 
> Frameworks/ApplicationServices.framework/Versions/A/Frameworks/ 
> CoreGraphics.framework/Versions/A/Resources/libPDFRIP.A.dylib
> 0x91b50000 - 0x91b5ffff libPSRIP.A.dylib     /System/Library/ 
> Frameworks/ApplicationServices.framework/Versions/A/Frameworks/ 
> CoreGraphics.framework/Versions/A/Resources/libPSRIP.A.dylib
> 0x91f0d000 - 0x91f0dfff com.apple.Carbon 10.3 (???)    /System/ 
> Library/Frameworks/Carbon.framework/Versions/A/Carbon
> 0x92056000 - 0x9206dfff com.apple.LangAnalysis 1.5.4    /System/ 
> Library/Frameworks/ApplicationServices.framework/Versions/A/ 
> Frameworks/LangAnalysis.framework/Versions/A/LangAnalysis
> 0x920f0000 - 0x92116fff com.apple.FindByContent 1.4 (1.2)    / 
> System/Library/Frameworks/ApplicationServices.framework/Versions/A/ 
> Frameworks/FindByContent.framework/Versions/A/FindByContent
> 0x92140000 - 0x92327fff com.apple.security 2.4 (177)    /System/ 
> Library/Frameworks/Security.framework/Versions/A/Security
> 0x924b0000 - 0x924e8fff com.apple.LaunchServices 10.3.5 (98.4)    / 
> System/Library/Frameworks/ApplicationServices.framework/Versions/A/ 
> Frameworks/LaunchServices.framework/Versions/A/LaunchServices
> 0x927b6000 - 0x927d3fff com.apple.audio.SoundManager 3.9    /System/ 
> Library/Frameworks/Carbon.framework/Versions/A/Frameworks/ 
> CarbonSound.framework/Versions/A/CarbonSound
> 0x927f0000 - 0x92827fff com.apple.CFNetwork 1.2.1 (7)    /System/ 
> Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/ 
> CFNetwork.framework/Versions/A/CFNetwork
> 0x92880000 - 0x92c05fff com.apple.HIToolbox 1.3.6 (???)    /System/ 
> Library/Frameworks/Carbon.framework/Versions/A/Frameworks/ 
> HIToolbox.framework/Versions/A/HIToolbox
> 0x92e70000 - 0x9336ffff com.apple.AppKit 6.3.8 (743.39)    /System/ 
> Library/Frameworks/AppKit.framework/Versions/C/AppKit
> 0x9398f000 - 0x939fcfff libvDSP.dylib     /System/Library/ 
> Frameworks/Accelerate.framework/Versions/A/Frameworks/ 
> vecLib.framework/Versions/A/libvDSP.dylib
> 0x93a20000 - 0x93a34fff libcups.2.dylib     /usr/lib/libcups.2.dylib
> 0x93a50000 - 0x93a54fff libmathCommon.A.dylib     /usr/lib/system/ 
> libmathCommon.A.dylib
> 0x940f0000 - 0x94108fff com.apple.WebServices 1.1.1 (1.1.0)    / 
> System/Library/Frameworks/CoreServices.framework/Versions/A/ 
> Frameworks/WebServicesCore.framework/Versions/A/WebServicesCore
> 0x941b0000 - 0x941dbfff libncurses.5.dylib     /usr/lib/libncurses. 
> 5.dylib
> 0x944c0000 - 0x94556fff com.apple.WebKit 312.1    /System/Library/ 
> Frameworks/WebKit.framework/Versions/A/WebKit
> 0x94640000 - 0x94649fff libz.1.dylib     /usr/lib/libz.1.dylib
> 0x9464c000 - 0x9469cfff com.apple.HIServices 1.4.1 (0.0.1d1)    / 
> System/Library/Frameworks/ApplicationServices.framework/Versions/A/ 
> Frameworks/HIServices.framework/Versions/A/HIServices
> 0x946e0000 - 0x9473ffff com.apple.SearchKit 1.0.2    /System/ 
> Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/ 
> SearchKit.framework/Versions/A/SearchKit
> 0x9477d000 - 0x94790fff com.apple.speech.synthesis.framework  
> 3.2    /System/Library/Frameworks/ApplicationServices.framework/ 
> Versions/A/Frameworks/SpeechSynthesis.framework/Versions/A/ 
> SpeechSynthesis
> 0x94800000 - 0x9488cfff com.apple.ink.framework 101.1.4 (55.12)    / 
> System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/ 
> Ink.framework/Versions/A/Ink
> 0x948fa000 - 0x94961fff com.apple.audio.CoreAudio 2.1.3    /System/ 
> Library/Frameworks/CoreAudio.framework/Versions/A/CoreAudio
> 0x949ba000 - 0x949cdfff libRIP.A.dylib     /System/Library/ 
> Frameworks/ApplicationServices.framework/Versions/A/Frameworks/ 
> CoreGraphics.framework/Versions/A/Resources/libRIP.A.dylib
> 0x94ea0000 - 0x954a6fff libBLAS.dylib     /System/Library/ 
> Frameworks/Accelerate.framework/Versions/A/Frameworks/ 
> vecLib.framework/Versions/A/libBLAS.dylib
> 0x95500000 - 0x957d0fff libLAPACK.dylib     /System/Library/ 
> Frameworks/Accelerate.framework/Versions/A/Frameworks/ 
> vecLib.framework/Versions/A/libLAPACK.dylib
> 0x958e0000 - 0x95900fff libvMisc.dylib     /System/Library/ 
> Frameworks/Accelerate.framework/Versions/A/Frameworks/ 
> vecLib.framework/Versions/A/libvMisc.dylib
> 0x95b50000 - 0x95c32fff libicucore.A.dylib     /usr/lib/ 
> libicucore.A.dylib
> 0x95ca0000 - 0x95d62fff libcrypto.0.9.7.dylib     /usr/lib/ 
> libcrypto.0.9.7.dylib
> 0x95dc0000 - 0x95deefff libssl.0.9.7.dylib     /usr/lib/libssl. 
> 0.9.7.dylib
> 0x95dfe000 - 0x95eb6fff com.apple.audio.toolbox.AudioToolbox  
> 1.3.3    /System/Library/Frameworks/AudioToolbox.framework/Versions/ 
> A/AudioToolbox
> 0x95f30000 - 0x9601efff libiconv.2.dylib     /usr/lib/libiconv.2.dylib
> 0x961b0000 - 0x96292fff com.apple.JavaScriptCore 312    /System/ 
> Library/Frameworks/WebKit.framework/Versions/A/Frameworks/ 
> JavaScriptCore.framework/Versions/A/JavaScriptCore
> 0x962e6000 - 0x965befff com.apple.CoreGraphics 1.203.30 (???)    / 
> System/Library/Frameworks/ApplicationServices.framework/Versions/A/ 
> Frameworks/CoreGraphics.framework/Versions/A/CoreGraphics
> 0x96b50000 - 0x96bdffff ATS     /System/Library/Frameworks/ 
> ApplicationServices.framework/Versions/A/Frameworks/ATS.framework/ 
> Versions/A/ATS
> 0x96e80000 - 0x96e90fff com.apple.vecLib 3.0.3 (vecLib 3.0.3)    / 
> System/Library/Frameworks/vecLib.framework/Versions/A/vecLib
> 0x970f0000 - 0x970f8fff libbsm.dylib     /usr/lib/libbsm.dylib
> 0x973e0000 - 0x976c6fff com.apple.WebCore 315    /System/Library/ 
> Frameworks/WebKit.framework/Versions/A/Frameworks/WebCore.framework/ 
> Versions/A/WebCore
> 0x9798b000 - 0x9798bfff com.apple.audio.units.AudioUnit 1.3.3    / 
> System/Library/Frameworks/AudioUnit.framework/Versions/A/AudioUnit
>
>
>
>
> Am 28.06.2005 um 16:53 schrieb stefano iacus:
>
>
>
>> You should give us more feedback if you want us to be of any help  
>> to you.
>> Could you please send us the crash report of R? (See Console.app  
>> in /Applications/Utilities )
>> stefano
>>
>> On 28/giu/05, at 06:23, matthias.wahl at macnews.de wrote:
>>
>>
>>
>>> Full_Name: Matthias Wahl
>>> Version: 2.0.1 and 2.1.0a
>>> OS: Mac OS X 10.3.9
>>> Submission from: (NULL) (84.159.39.159)
>>>
>>>
>>> Version 2.1.0a does get installed, R is available under  
>>> applications,
>>> however when trying to start R I get an error message that R is  
>>> terminated
>>> due to an error and that's it. Re-installing didn't help at all.
>>>
>>> Then I tried Version 2.0.1. and there I don't even get an icon to  
>>> start R.
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>
>>>
>>>
>>>
>>
>>
>>
>
>
>
>


From plummer at iarc.fr  Thu Jun 30 11:39:16 2005
From: plummer at iarc.fr (Martyn Plummer)
Date: Thu, 30 Jun 2005 11:39:16 +0200
Subject: [Rd] Failed "make check" under Fedora Core 4 (PR#7979)
In-Reply-To: <20050629175526.AF68AA237@slim.kubism.ku.dk>
References: <20050629175526.AF68AA237@slim.kubism.ku.dk>
Message-ID: <1120124356.3564.5.camel@seurat>

On Wed, 2005-06-29 at 19:55 +0200, kent at darwin.eeb.uconn.edu wrote:
> I downloaded R v2.1.1 earlier this morning to compile under Fedora Core 
> 4. It compiled without incident, but 'make check' failed. Below is the 
> relevant part of its report. Is this a known problem?

It is known that gcc 4.0.0 is buggy.  The current recommendation, from
Brian Ripley, is to use gcc 3.4.4 instead. We are awaiting the bug-fix
release gcc 4.0.1.

R compiled with the gcc 4.0.0 provided on FC4 does pass "make check-
all". My guess is that your locally compiled version does not have the
patches applied by Red Hat.

Martyn

> I used a locally compiled version of GCC v4.0.0 that reports
> 
> [kent at d89h102 R-2.1.1]$ gcc -v
> Using built-in specs.
> Target: i686-pc-linux-gnu
> Configured with: ../gcc-4.0.0/configure --enable-languages=c,c++,f95,java
> Thread model: posix
> gcc version 4.0.0
> [kent at d89h102 R-2.1.1]$
> 
> Kent Holsinger
> kent at darwin.eeb.uconn.edu
> 
> make[3]: Entering directory `/home/kent/source-arc/R-2.1.1/tests'
> running code in 'eval-etc.R' ... OK
> comparing 'eval-etc.Rout' to './eval-etc.Rout.save' ...2a3,157
>  > > ####  eval / parse / deparse / substitute  etc
>  > >
>  > > ##- From: Peter Dalgaard BSA <p.dalgaard at biostat.ku.dk>
>  > > ##- Subject: Re: source() / eval() bug ??? (PR#96)
>  > > ##- Date: 20 Jan 1999 14:56:24 +0100
>  > > e1 <- parse(text='c(F=(f <- .3), "Tail area" = 2 * if(f < 1) 30 
> else 90)')[[1]]
>  > > e1
>  > c(F = (f <- 0.3), "Tail area" = 2 * if (f < 1) 30 else 90)
>  > > str(eval(e1))
>  >  Named num [1:2] 0.3 60
>  >  - attr(*, "names")= chr [1:2] "F" "Tail area"
>  > > mode(e1)
>  > [1] "call"
>  > >
>  > > ( e2 <- quote(c(a=1,b=2)) )
>  > c(a = 1, b = 2)
>  > > names(e2)[2] <- "a b c"
>  > > e2
>  > c("a b c" = 1, b = 2)
>  > > parse(text=deparse(e2))
>  > expression(c("a b c" = 1, b = 2))
>  > >
>  > > ##- From: Peter Dalgaard BSA <p.dalgaard at biostat.ku.dk>
>  > > ##- Date: 22 Jan 1999 11:47
>  > >
>  > > ( e3 <- quote(c(F=1,"tail area"=pf(1,1,1))) )
>  > c(F = 1, "tail area" = pf(1, 1, 1))
>  > > eval(e3)
>  >         F tail area
>  >       1.0       0.5
>  > > names(e3)
>  > [1] ""          "F"         "tail area"
>  > >
>  > > names(e3)[2] <- "Variance ratio"
>  > > e3
>  > c("Variance ratio" = 1, "tail area" = pf(1, 1, 1))
>  > > eval(e3)
>  > Variance ratio      tail area
>  >            1.0            0.5
>  > >
>  > >
>  > > ##- From: Peter Dalgaard BSA <p.dalgaard at biostat.ku.dk>
>  > > ##- Date: 2 Sep 1999
>  > >
>  > > ## The first failed in 0.65.0 :
>  > > attach(list(x=1))
>  > > evalq(dim(x) <- 1,as.environment(2))
>  > > dput(get("x", env=as.environment(2)), control="all")
>  > structure(1, .Dim = as.integer(1))
>  > >
>  > > e <- local({x <- 1;environment()})
>  > > evalq(dim(x) <- 1,e)
>  > > dput(get("x",env=e), control="all")
>  > structure(1, .Dim = as.integer(1))
>  > >
>  > > ### Substitute, Eval, Parse, etc
>  > >
>  > > ## PR#3 : "..." matching
>  > > ## Revised March 7 2001 -pd
>  > > A <- function(x, y, ...) {
>  > +     B <- function(a, b, ...) { match.call() }
>  > +     B(x+y, ...)
>  > + }
>  > > (aa <- A(1,2,3))
>  > B(a = x + y, b = 3)
>  > > all.equal(as.list(aa),
>  > +           list(as.name("B"), a = expression(x+y)[[1]], b = 3))
>  > [1] TRUE
>  > > (a2 <- A(1,2, named = 3)) #A(1,2, named = 3)
>  > B(a = x + y, named = 3)
>  > > all.equal(as.list(a2),
>  > +           list(as.name("B"), a = expression(x+y)[[1]], named = 3))
>  > [1] TRUE
>  > >
>  > > CC <- function(...) match.call()
>  > > DD <- function(...) CC(...)
>  > > a3 <- DD(1,2,3)
>  > > all.equal(as.list(a3),
>  > +           list(as.name("CC"), 1, 2, 3))
>  > [1] TRUE
>  > >
>  > > ## More dots issues: March 19 2001 -pd
>  > > ## Didn't work up to and including 1.2.2
>  > >
>  > > f <- function(...) {
>  > +     val <- match.call(expand.dots=F)$...
>  > +         x <- val[[1]]
>  > +     eval.parent(substitute(missing(x)))
>  > + }
>  > > g <- function(...) h(f(...))
>  > > h <- function(...) list(...)
>  > > k <- function(...) g(...)
>  > > X <- k(a=)
>  > > all.equal(X, list(TRUE))
>  > [1] TRUE
>  > >
>  > > ## Bug PR#24
>  > > f <- function(x,...) substitute(list(x,...))
>  > > deparse(f(a, b)) == "list(a, b)" &&
>  > + deparse(f(b, a)) == "list(b, a)" &&
>  > + deparse(f(x, y)) == "list(x, y)" &&
>  > + deparse(f(y, x)) == "list(y, x)"
>  > [1] TRUE
>  > >
>  > > tt <- function(x) { is.vector(x); deparse(substitute(x)) }
>  > > a <- list(b=3); tt(a$b) == "a$b" # tends to break when ...
>  > [1] TRUE
>  > >
>  > >
>  > > ## Parser:
>  > > 1 <
>  > +     2
>  > [1] TRUE
>  > > 2 <=
>  > +     3
>  > [1] TRUE
>  > > 4 >=
>  > +     3
>  > [1] TRUE
>  > > 3 >
>  > +     2
>  > [1] TRUE
>  > > 2 ==
>  > +     2
>  > [1] TRUE
>  > > ## bug till ...
>  > > 1 !=
>  > +     3
>  > [1] TRUE
>  > >
>  > > all(NULL == NULL)
>  > [1] TRUE
>  > >
>  > > ## PR #656 (related)
>  > > u <- runif(1);      length(find(".Random.seed")) == 1
>  > [1] TRUE
>  > >
>  > > MyVaR <<- "val";length(find("MyVaR")) == 1
>  > [1] TRUE
>  > > rm(MyVaR);  length(find("MyVaR")) == 0
>  > [1] TRUE
>  > >
>  > >
>  > > ## Martin Maechler: rare bad bug in sys.function() {or match.arg()} 
> (PR#1409)
>  > > callme <- function(a = 1, mm = c("Abc", "Bde")) {
>  > +     mm <- match.arg(mm); cat("mm = "); str(mm) ; invisible()
>  > + }
>  > > ## The first two were as desired:
>  > > callme()
>  > mm =  chr "Abc"
>  > > callme(mm="B")
>  > mm =  chr "Bde"
>  > > mycaller <- function(x = 1, callme = pi) { callme(x) }
>  > > mycaller()## wrongly gave `mm = NULL'  now = "Abc"
>  > mm =  chr "Abc"
> make[3]: *** [eval-etc.Rout] Error 1
> make[3]: Leaving directory `/home/kent/source-arc/R-2.1.1/tests'
> make[2]: *** [test-Specific] Error 2
> make[2]: Leaving directory `/home/kent/source-arc/R-2.1.1/tests'
> make[1]: *** [test-all-basics] Error 1
> make[1]: Leaving directory `/home/kent/source-arc/R-2.1.1/tests'
> make: *** [check] Error 2
> 
> <<insert bug report here>>
> 
> 
> 
> --please do not edit the information below--
> 
> Version:
>   platform = i686-pc-linux-gnu
>   arch = i686
>   os = linux-gnu
>   system = i686, linux-gnu
>   status =
>   major = 2
>   minor = 1.1
>   year = 2005
>   month = 06
>   day = 20
>   language = R
> 
> Locale:
> LC_CTYPE=en_US.UTF-8;LC_NUMERIC=C;LC_TIME=en_US.UTF-8;LC_COLLATE=en_US.UTF-8;LC_MONETARY=en_US.UTF-8;LC_MESSAGES=en_US.UTF-8;LC_PAPER=C;LC_NAME=C;LC_ADDRESS=C;LC_TELEPHONE=C;LC_MEASUREMENT=C;LC_IDENTIFICATION=C
> 
> Search Path:
>   .GlobalEnv, package:methods, package:stats, package:graphics, 
> package:grDevices, package:utils, package:datasets, Autoloads, package:base
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

-----------------------------------------------------------------------
This message and its attachments are strictly confidential. ...{{dropped}}


From LCorbett at ustboniface.mb.ca  Thu Jun 30 13:50:51 2005
From: LCorbett at ustboniface.mb.ca (LCorbett@ustboniface.mb.ca)
Date: Thu, 30 Jun 2005 13:50:51 +0200 (CEST)
Subject: [Rd] Bartlett test problem (PR#7980)
Message-ID: <20050630115051.3E7CBBAD5@slim.kubism.ku.dk>

Full_Name: Leslie Corbett
Version: R 2.1.1
OS: Windows 2000 Professional
Submission from: (NULL) (142.161.169.185)


Every time I try to use the Bartlett.test command, I get a non-responding
system. Can someone help?

How to reproduce:  
Easiest way: 1.  load Rcmdr; 2. import data set (one where you would do an
ANOVA); 3. manage variables in data set (choose at least one variable as a
factor). 4.  in Rcmdr choose Statistics , variances, Bartlett's test.  5.  This
is where my computer stops, my laptop stops and collegues' computers stop.

(Of course all this can be done directly in the R Gui window, yet the same
result occurs).

Thanks,
Leslie


From ripley at stats.ox.ac.uk  Thu Jun 30 14:10:42 2005
From: ripley at stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Thu, 30 Jun 2005 14:10:42 +0200 (CEST)
Subject: [Rd] Bartlett test problem (PR#7980)
Message-ID: <20050630121042.DCC43109B4@slim.kubism.ku.dk>

what does

example(bartlett.test)

do for you?

Both that and doing that example in Rcmdr work for me.

On Thu, 30 Jun 2005 LCorbett at ustboniface.mb.ca wrote:

> Full_Name: Leslie Corbett
> Version: R 2.1.1
> OS: Windows 2000 Professional
> Submission from: (NULL) (142.161.169.185)
>
>
> Every time I try to use the Bartlett.test command, I get a non-responding
> system. Can someone help?
>
> How to reproduce:
> Easiest way: 1.  load Rcmdr; 2. import data set (one where you would do an
> ANOVA); 3. manage variables in data set (choose at least one variable as a
> factor). 4.  in Rcmdr choose Statistics , variances, Bartlett's test.  5.  This
> is where my computer stops, my laptop stops and collegues' computers stop.
>
> (Of course all this can be done directly in the R Gui window, yet the same
> result occurs).

We really want something here we can reproduce.  It might well only happen 
with your dataset.

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From ggrothendieck at gmail.com  Thu Jun 30 14:10:45 2005
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Thu, 30 Jun 2005 08:10:45 -0400
Subject: [Rd] upgrading an R installation to next versoin
Message-ID: <971536df0506300510f6d6ac2@mail.gmail.com>

When I install a new version of R (Windows XP) I have to:

1. copy my rw....\etc\Rprofile.site file to the new installation

2. copy the rw....\share\texmf files to the tex subfolder of the 
   miktex root directory and then refresh the miktex name database
   (I have a batch file that does this for me which I run
   whenever I install a new version of R.)

3. setup the shortcut key using 'properties' on my R desktop icon so 
   that ctrl-alt-R brings up the new rather than the old R.  (This one
   really had me confused once since I did not realize I was still
   using the old version of R after installing the new one.)

4. reinstall the packages I use or else setup etc\Renviron.site with 
   an R_LIBS to point to include the old library or perhaps one can
   copy the libraries over being careful not to overwrite new versions
   of the standard libraries.

Many other windows program automatically transfer the settings when 
you upgrade them.

I wonder if the installation process could optionally transfer
such settings from an old installation to a new one to make it
easier to install R.


From murdoch at stats.uwo.ca  Thu Jun 30 15:02:44 2005
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Thu, 30 Jun 2005 09:02:44 -0400
Subject: [Rd] upgrading an R installation to next versoin
In-Reply-To: <971536df0506300510f6d6ac2@mail.gmail.com>
References: <971536df0506300510f6d6ac2@mail.gmail.com>
Message-ID: <42C3ED74.7030905@stats.uwo.ca>

On 6/30/2005 8:10 AM, Gabor Grothendieck wrote:
> When I install a new version of R (Windows XP) I have to:
> 
> 1. copy my rw....\etc\Rprofile.site file to the new installation
> 
> 2. copy the rw....\share\texmf files to the tex subfolder of the 
>    miktex root directory and then refresh the miktex name database
>    (I have a batch file that does this for me which I run
>    whenever I install a new version of R.)
> 
> 3. setup the shortcut key using 'properties' on my R desktop icon so 
>    that ctrl-alt-R brings up the new rather than the old R.  (This one
>    really had me confused once since I did not realize I was still
>    using the old version of R after installing the new one.)
> 
> 4. reinstall the packages I use or else setup etc\Renviron.site with 
>    an R_LIBS to point to include the old library or perhaps one can
>    copy the libraries over being careful not to overwrite new versions
>    of the standard libraries.
> 
> Many other windows program automatically transfer the settings when 
> you upgrade them.
> 
> I wonder if the installation process could optionally transfer
> such settings from an old installation to a new one to make it
> easier to install R.

I think a couple of these could be handled by not applying so many 
modifications to the R installation, do more locally.  For example, #1 
needn't be copied, you can just use the R_ENVIRON environment variable 
to point to it and both versions will see it.

I'd call #2 a bug in MikTeX, but it's probably one we'll have to work 
around one of these days.  (The bug is dropping support for the 
environment variable specification of extra include directories.)

#3 might be something we could do, but I don't see how.  The installer 
could know what hotkey you used the last time you installed R, but if 
you changed it in the meantime, how would it know about that?  And how 
would it remove the hotkey from the old shortcut?  (A little 
experimentation suggests that XP is buggy in handling multiple shortcuts 
with the same hotkey.  I'd rather stay away from this.)

#4 is another case where you can put your libraries outside R_HOME.

Duncan Murdoch


From ripley at stats.ox.ac.uk  Thu Jun 30 16:41:08 2005
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu, 30 Jun 2005 15:41:08 +0100 (BST)
Subject: [Rd] write.csv suggestion
In-Reply-To: <67DCA285A2D7754280D3B8E88EB548020C946616@MSGBOSCLB2WIN.DMN1.FMR.COM>
References: <67DCA285A2D7754280D3B8E88EB548020C946616@MSGBOSCLB2WIN.DMN1.FMR.COM>
Message-ID: <Pine.LNX.4.61.0506301535590.4783@gannet.stats>

I've changed this in R-devel so row.names = FALSE is allowed in 
write.csv[2], but changing col.names, dec, sep and qmethod are not 
allowed.  (col.names is set depending on the setting of row.names.)

So far attempts to change col.names, dec, sep and qmethod are silently 
ignored but I may add some warnings.

On Wed, 29 Jun 2005, McGehee, Robert wrote:

> I didn't want to use a different separator, I wanted to remove
> row.names, as in this example:

OK, but the documentation did explicitly say it was a wrapper for 
row.names = TRUE.

>> data(USArrests)
>> write.csv(USArrests, file = "~/test.csv", row.names = FALSE, col.names
> = TRUE)
> Error in if (col.names) d[[2]] else NULL :
> 	missing value where TRUE/FALSE needed
>
> I only mentioned this suggestion because the above syntax seemed
> reasonable (and self-documenting), but by making the options
> unchangeable, I received an unhelpful error message.
>
> After checking the code, I rewrote the line to this:
>> write.table(USArrests, file = "~/test.csv", sep = ",", row.names =
> FALSE, col.names = TRUE)
>
> This only seemed suboptimal (to me) because one would have to read the
> code to know that the col.names = TRUE option was not being passed along
> to write.table (as I expected).
>
> Best,
> Robert
>
> -----Original Message-----
> From: Prof Brian Ripley [mailto:ripley at stats.ox.ac.uk]
> Sent: Wednesday, June 29, 2005 4:16 PM
> To: McGehee, Robert
> Cc: r-devel at stat.math.ethz.ch
> Subject: Re: [Rd] write.csv suggestion
>
>
> The help page says
>
>      By default there is no column name for a column of row names.  If
>      'col.names = NA' and 'row.names = TRUE' a blank column name is
>      added.  This can be used to write CSV files for input to
>      spreadsheets.  'write.csv' and 'write.csv2' provide convenience
>      wrappers for doing so.
>
> and they are set up to disallow the options they set to be changed.
>
> If you get the option wrong to read a file, you will know soon enough,
> but
> these are to ensure a suitable CSV file gets written (which will not be
> so
> immediately apparent).
>
> Please define `optimal': doing what it was designed for and is
> documented
> to do is according to you not `optimal'.
>
> Why would anyone want to use write.csv to write files with something
> other
> than a comma/semicolon as separator, rather than use write.table?
>
>
> On Wed, 29 Jun 2005, McGehee, Robert wrote:
>
>> Hello all,
>> I had some trouble recently with write.csv because I couldn't change
> one
>> of the default options. A quick view of the code showed that the
>> function was not defined in the most optimal way.
>>
>> Currently,
>> write.csv <- function (..., col.names = NA, sep = ",", qmethod =
>> "double")
>> 	write.table(..., col.names = NA, sep = ",", qmethod = "double")
>>
>> Thus, the options passed along to write.csv are ignored by the
> function
>> (unless in the ...).
>>
>> Perhaps a better way to define the function is as such (similar to
>> read.csv):
>>
>> write.csv <- function (..., col.names = NA, sep = ",", qmethod =
>> "double")
>> 	write.table(..., col.names = col.names, sep = sep, qmethod =
>> qmethod)
>>
>> The same also applies to write.csv2
>>
>> Best,
>> Robert
>>
>>
>>> version
>>         _
>> platform i386-pc-mingw32
>> arch     i386
>> os       mingw32
>> system   i386, mingw32
>> status
>> major    2
>> minor    1.1
>> year     2005
>> month    06
>> day      20
>> language R
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>>
>
> -- 
> Brian D. Ripley,                  ripley at stats.ox.ac.uk
> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> University of Oxford,             Tel:  +44 1865 272861 (self)
> 1 South Parks Road,                     +44 1865 272866 (PA)
> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
>
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From ggrothendieck at gmail.com  Thu Jun 30 18:24:46 2005
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Thu, 30 Jun 2005 12:24:46 -0400
Subject: [Rd] upgrading an R installation to next versoin
In-Reply-To: <42C3ED74.7030905@stats.uwo.ca>
References: <971536df0506300510f6d6ac2@mail.gmail.com>
	<42C3ED74.7030905@stats.uwo.ca>
Message-ID: <971536df05063009244e4e4edb@mail.gmail.com>

On 6/30/05, Duncan Murdoch <murdoch at stats.uwo.ca> wrote:
> On 6/30/2005 8:10 AM, Gabor Grothendieck wrote:
> > When I install a new version of R (Windows XP) I have to:
> >
> > 1. copy my rw....\etc\Rprofile.site file to the new installation
> >
> > 2. copy the rw....\share\texmf files to the tex subfolder of the
> >    miktex root directory and then refresh the miktex name database
> >    (I have a batch file that does this for me which I run
> >    whenever I install a new version of R.)
> >
> > 3. setup the shortcut key using 'properties' on my R desktop icon so
> >    that ctrl-alt-R brings up the new rather than the old R.  (This one
> >    really had me confused once since I did not realize I was still
> >    using the old version of R after installing the new one.)
> >
> > 4. reinstall the packages I use or else setup etc\Renviron.site with
> >    an R_LIBS to point to include the old library or perhaps one can
> >    copy the libraries over being careful not to overwrite new versions
> >    of the standard libraries.
> >
> > Many other windows program automatically transfer the settings when
> > you upgrade them.
> >
> > I wonder if the installation process could optionally transfer
> > such settings from an old installation to a new one to make it
> > easier to install R.
> 
> I think a couple of these could be handled by not applying so many
> modifications to the R installation, do more locally.  For example, #1
> needn't be copied, you can just use the R_ENVIRON environment variable
> to point to it and both versions will see it.
> 
> I'd call #2 a bug in MikTeX, but it's probably one we'll have to work
> around one of these days.  (The bug is dropping support for the
> environment variable specification of extra include directories.)
> 
> #3 might be something we could do, but I don't see how.  The installer
> could know what hotkey you used the last time you installed R, but if
> you changed it in the meantime, how would it know about that?  And how
> would it remove the hotkey from the old shortcut?  (A little
> experimentation suggests that XP is buggy in handling multiple shortcuts
> with the same hotkey.  I'd rather stay away from this.)
> 
> #4 is another case where you can put your libraries outside R_HOME.
> 
> Duncan Murdoch
> 

I am not too fond of cluttering up my system with environment
variables but do have an idea for one one partial measure that 
might be considered.

If the installation kept track of the previous installation by putting the 
installation path of the previous installation somewhere (probably the 
registry but maybe a file or an environment variable) then it would be 
possible for the user to write a batch file or even an R routine that 
copied information from the previous installation to the current one.


From jh910 at juno.com  Thu Jun 30 18:14:49 2005
From: jh910 at juno.com (J. Hosking)
Date: Thu, 30 Jun 2005 12:14:49 -0400
Subject: [Rd] upgrading an R installation to next versoin
In-Reply-To: <971536df0506300510f6d6ac2@mail.gmail.com>
References: <971536df0506300510f6d6ac2@mail.gmail.com>
Message-ID: <da15bn$1r5$1@sea.gmane.org>

Gabor Grothendieck wrote:
> When I install a new version of R (Windows XP) I have to:
> 
> 1. copy my rw....\etc\Rprofile.site file to the new installation
> 
> 2. copy the rw....\share\texmf files to the tex subfolder of the 
>    miktex root directory and then refresh the miktex name database
>    (I have a batch file that does this for me which I run
>    whenever I install a new version of R.)
> 
> 3. setup the shortcut key using 'properties' on my R desktop icon so 
>    that ctrl-alt-R brings up the new rather than the old R.  (This one
>    really had me confused once since I did not realize I was still
>    using the old version of R after installing the new one.)
> 
> 4. reinstall the packages I use or else setup etc\Renviron.site with 
>    an R_LIBS to point to include the old library or perhaps one can
>    copy the libraries over being careful not to overwrite new versions
>    of the standard libraries.
> 
> Many other windows program automatically transfer the settings when 
> you upgrade them.
> 
> I wonder if the installation process could optionally transfer
> such settings from an old installation to a new one to make it
> easier to install R.

I install each new version of R to a directory ...\R\rcurrent (first
renaming the previous rcurrent directory to its "official" name rw....).
Having set up the shortcut key one time, on subsequent installations
I tick the installer's checkbox "Don't create a Start Menu folder".

I keep a separate directory ...\R\library for nonstandard packages,
with environment variable R_LIBS set to the directory name.

My miktex.ini file specifies ...\R\rcurrent\share\texmf as a place
to look for input files.

That should take care of your points 3, 4, and 2, respectively.
Duncan's suggestion of an R_ENVIRON environment variable (which
I didn't know about; thanks, Duncan) should take care of point 1.

Jon Hosking


From ggrothendieck at gmail.com  Thu Jun 30 21:16:57 2005
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Thu, 30 Jun 2005 15:16:57 -0400
Subject: [Rd] upgrading an R installation to next versoin
In-Reply-To: <da15bn$1r5$1@sea.gmane.org>
References: <971536df0506300510f6d6ac2@mail.gmail.com>
	<da15bn$1r5$1@sea.gmane.org>
Message-ID: <971536df05063012166bfa590b@mail.gmail.com>

On 6/30/05, J. Hosking <jh910 at juno.com> wrote:
> Gabor Grothendieck wrote:
> > When I install a new version of R (Windows XP) I have to:
> >
> > 1. copy my rw....\etc\Rprofile.site file to the new installation
> >
> > 2. copy the rw....\share\texmf files to the tex subfolder of the
> >    miktex root directory and then refresh the miktex name database
> >    (I have a batch file that does this for me which I run
> >    whenever I install a new version of R.)
> >
> > 3. setup the shortcut key using 'properties' on my R desktop icon so
> >    that ctrl-alt-R brings up the new rather than the old R.  (This one
> >    really had me confused once since I did not realize I was still
> >    using the old version of R after installing the new one.)
> >
> > 4. reinstall the packages I use or else setup etc\Renviron.site with
> >    an R_LIBS to point to include the old library or perhaps one can
> >    copy the libraries over being careful not to overwrite new versions
> >    of the standard libraries.
> >
> > Many other windows program automatically transfer the settings when
> > you upgrade them.
> >
> > I wonder if the installation process could optionally transfer
> > such settings from an old installation to a new one to make it
> > easier to install R.
> 
> I install each new version of R to a directory ...\R\rcurrent (first
> renaming the previous rcurrent directory to its "official" name rw....).

That's a good idea -- always using the same folder name for R.

> Having set up the shortcut key one time, on subsequent installations
> I tick the installer's checkbox "Don't create a Start Menu folder".
> 
> I keep a separate directory ...\R\library for nonstandard packages,
> with environment variable R_LIBS set to the directory name.

Do you mean your R_LIBS has two components: one to look in
..\R\rcurrent\library and a second to look in ..\R\library? What does
it look like exactly?

When you do install.packages(whatever) does it install to the
..\R\library rather than ..\R\rcurrent\library ?   Also, does
updates.packages() work as expected for you?

> 
> My miktex.ini file specifies ...\R\rcurrent\share\texmf as a place
> to look for input files.

I think its necessary to rebuild the name data base in miktex too
    initexmf -u
although ignoring that step may work as long as the filenames 
have not changed.  I was hoping to continue using a vanilla
miktex installation as I do now rather than having a custom miktex.ini
file.  At any rate my batch file would continue to work even with your setup
so I think I should be ok here.

> 
> That should take care of your points 3, 4, and 2, respectively.
> Duncan's suggestion of an R_ENVIRON environment variable (which
> I didn't know about; thanks, Duncan) should take care of point 1.
> 
> Jon Hosking

It occurs to me in reading this that I could keep the *.site files in 
..\R and then have my miktex update batch file also copy them 
to the appropriate etc folder.  Thus keeping an R\library folder
and running the batch file after each new installation would
address 1, 2 and 4 even without using the same name for the
rw... folder.  This still does not handle the shortcut key which
I would have to handle manually or determine if there is a way
I could also add that to my batch file.


From jh910 at juno.com  Thu Jun 30 22:19:15 2005
From: jh910 at juno.com (J. Hosking)
Date: Thu, 30 Jun 2005 16:19:15 -0400
Subject: [Rd] upgrading an R installation to next versoin
In-Reply-To: <971536df05063012166bfa590b@mail.gmail.com>
References: <971536df0506300510f6d6ac2@mail.gmail.com>	<da15bn$1r5$1@sea.gmane.org>
	<971536df05063012166bfa590b@mail.gmail.com>
Message-ID: <da1jlv$et5$1@sea.gmane.org>

Gabor Grothendieck wrote:
> On 6/30/05, J. Hosking <jh910 at juno.com> wrote:
> 
...

>> I keep a separate directory ...\R\library for nonstandard packages,
>> with environment variable R_LIBS set to the directory name.
> 
> 
> Do you mean your R_LIBS has two components: one to look in
> ..\R\rcurrent\library and a second to look in ..\R\library? What does
> it look like exactly?
> 
> When you do install.packages(whatever) does it install to the
> ..\R\library rather than ..\R\rcurrent\library ?   Also, does
> updates.packages() work as expected for you?
> 
My R_LIBS environment variable is just

   R_LIBS=C:\progs\r\library

and within R I see

   > .libPaths()
   [1] "C:/progs/r/library"          "C:/progs/r/rcurrent/library"

i.e., the default library is automatically appended.  The help for 
.libPaths explains this.  And yes, install.packages() installs to
C:\progs\R\library and update.packages() works as expected.

> 
>>My miktex.ini file specifies ...\R\rcurrent\share\texmf as a place
>>to look for input files.
> 
> 
> I think its necessary to rebuild the name data base in miktex too
>     initexmf -u
> although ignoring that step may work as long as the filenames 
> have not changed.  

You are probably correct, though I have not yet encountered any problems 
that I could attribute to not running initexmf -- no doubt the filenames 
have not changed recently.

> I was hoping to continue using a vanilla
> miktex installation as I do now rather than having a custom miktex.ini
> file.  At any rate my batch file would continue to work even with your setup
> so I think I should be ok here.
> 
> 
>>That should take care of your points 3, 4, and 2, respectively.
>>Duncan's suggestion of an R_ENVIRON environment variable (which
>>I didn't know about; thanks, Duncan) should take care of point 1.
>>
>>Jon Hosking
> 
> 
> It occurs to me in reading this that I could keep the *.site files in 
> ..\R and then have my miktex update batch file also copy them 
> to the appropriate etc folder.  Thus keeping an R\library folder
> and running the batch file after each new installation would
> address 1, 2 and 4 even without using the same name for the
> rw... folder.  This still does not handle the shortcut key which
> I would have to handle manually or determine if there is a way
> I could also add that to my batch file.
> 

Jon Hosking


From edd at debian.org  Thu Jun 30 15:32:32 2005
From: edd at debian.org (Dirk Eddelbuettel)
Date: Thu, 30 Jun 2005 13:32:32 +0000 (UTC)
Subject: [Rd] upgrading an R installation to next versoin
References: <971536df0506300510f6d6ac2@mail.gmail.com>
	<42C3ED74.7030905@stats.uwo.ca>
Message-ID: <loom.20050630T150225-130@post.gmane.org>


Duncan Murdoch <murdoch <at> stats.uwo.ca> writes:
> On 6/30/2005 8:10 AM, Gabor Grothendieck wrote:
> > When I install a new version of R (Windows XP) I have to:
> > 
> > 1. copy my rw....\etc\Rprofile.site file to the new installation

Same here, and I also change one or two things in etc/Rconsole.  It would
be nice if we could tell to keep 'site-wide' config files outside of $R_HOME 
(which is always version-number challenged, ie. the path changes four times a 
year [ assuming two regular releases with one patch releases each, as has been 
the norm lately ] ).  

So just as I can set R_LIBS in ~/.Renviron to point to my library directory, 
would it make sense to add, say, R_ETC ?

> > 2. copy the rw....\share\texmf files to the tex subfolder of the 
> >    miktex root directory and then refresh the miktex name database
> >    (I have a batch file that does this for me which I run
> >    whenever I install a new version of R.)

I have no issues with the tetex installation in Cygwin.

> > 3. setup the shortcut key using 'properties' on my R desktop icon so 
> >    that ctrl-alt-R brings up the new rather than the old R.  (This one
> >    really had me confused once since I did not realize I was still
> >    using the old version of R after installing the new one.)

I ignore the icons, so I don't care.  But I always need to update my softlink
farm in /usr/local/bin for R, Rgui, Rterm, Rcmd.

> > 4. reinstall the packages I use or else setup etc\Renviron.site with 
> >    an R_LIBS to point to include the old library or perhaps one can
> >    copy the libraries over being careful not to overwrite new versions
> >    of the standard libraries.
> > 
> > Many other windows program automatically transfer the settings when 
> > you upgrade them.
> > 
> > I wonder if the installation process could optionally transfer
> > such settings from an old installation to a new one to make it
> > easier to install R.

As Duncan mentioned, this one is easy to take care of. I use 
   R_LIBS="c:/opt/R/lib"
in ~/.Renviron, and that directory is outside of / parallel to where I install
the different R versions.

One idea I had was if we could ask the installer to (optionally) adopt a scheme
different from rwXXXX/ and to simple use something like Rcurrent/, with an
optional renaming of the previous R installation to Rprevious.  That way,
Gabor's desktop icon doesn't need to change, nor do my softlinks in
/usr/local/bin have to be adapted, as they always point into Rcurrent/bin/ .

I am probably overlooking something.  But in case I don't, would anybody else
see merit in this scheme?

Regards, Dirk


